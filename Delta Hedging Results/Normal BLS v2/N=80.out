WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 19:07:08.413806: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 19:07:08.443431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:07:08.444052: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:07:08.446262: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:07:08.448249: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:07:08.449348: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:07:08.451821: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:07:08.453700: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:07:08.458988: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:07:08.461156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:07:08.461620: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 19:07:08.468590: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399880000 Hz
2019-12-18 19:07:08.468803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c040c3d270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:07:08.468821: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 19:07:08.470000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 19:07:08.470031: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:07:08.470044: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 19:07:08.470055: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 19:07:08.470065: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 19:07:08.470076: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 19:07:08.470087: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 19:07:08.470098: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 19:07:08.472154: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 19:07:08.472186: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 19:07:08.569747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 19:07:08.569779: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 19:07:08.569790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 19:07:08.572789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 19:07:08.575019: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c041276510 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 19:07:08.575036: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:232: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:237: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:311: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:317: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:487: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:492: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:494: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:330: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:340: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:342: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:195: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 19:08:19.675076: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.4148e+02,   Y0: 2.1444e+00,  elapsed time  71
INFO   step:     1,    loss: 1.0811e+01,   Y0: 2.1494e+00,  elapsed time 110
INFO   step:     2,    loss: 9.7379e+00,   Y0: 2.1503e+00,  elapsed time 110
INFO   step:     3,    loss: 9.5953e+00,   Y0: 2.1500e+00,  elapsed time 110
INFO   step:     4,    loss: 9.5433e+00,   Y0: 2.1485e+00,  elapsed time 111
INFO   step:     5,    loss: 9.5789e+00,   Y0: 2.1465e+00,  elapsed time 111
INFO   step:     6,    loss: 9.6135e+00,   Y0: 2.1460e+00,  elapsed time 111
INFO   step:     7,    loss: 9.6036e+00,   Y0: 2.1471e+00,  elapsed time 112
INFO   step:     8,    loss: 9.5764e+00,   Y0: 2.1493e+00,  elapsed time 112
INFO   step:     9,    loss: 9.5568e+00,   Y0: 2.1507e+00,  elapsed time 112
INFO   step:    10,    loss: 9.5531e+00,   Y0: 2.1527e+00,  elapsed time 112
INFO   step:    11,    loss: 9.5510e+00,   Y0: 2.1547e+00,  elapsed time 113
INFO   step:    12,    loss: 9.5491e+00,   Y0: 2.1549e+00,  elapsed time 113
INFO   step:    13,    loss: 9.5470e+00,   Y0: 2.1558e+00,  elapsed time 113
INFO   step:    14,    loss: 9.5417e+00,   Y0: 2.1558e+00,  elapsed time 114
INFO   step:    15,    loss: 9.5355e+00,   Y0: 2.1566e+00,  elapsed time 114
INFO   step:    16,    loss: 9.5268e+00,   Y0: 2.1573e+00,  elapsed time 114
INFO   step:    17,    loss: 9.5173e+00,   Y0: 2.1588e+00,  elapsed time 114
INFO   step:    18,    loss: 9.5070e+00,   Y0: 2.1597e+00,  elapsed time 115
INFO   step:    19,    loss: 9.4947e+00,   Y0: 2.1612e+00,  elapsed time 115
INFO   step:    20,    loss: 9.4838e+00,   Y0: 2.1618e+00,  elapsed time 115
INFO   step:    21,    loss: 9.4734e+00,   Y0: 2.1627e+00,  elapsed time 116
INFO   step:    22,    loss: 9.4633e+00,   Y0: 2.1628e+00,  elapsed time 116
INFO   step:    23,    loss: 9.4543e+00,   Y0: 2.1629e+00,  elapsed time 116
INFO   step:    24,    loss: 9.4458e+00,   Y0: 2.1636e+00,  elapsed time 116
INFO   step:    25,    loss: 9.4381e+00,   Y0: 2.1639e+00,  elapsed time 117
INFO   step:    26,    loss: 9.4308e+00,   Y0: 2.1638e+00,  elapsed time 117
INFO   step:    27,    loss: 9.4245e+00,   Y0: 2.1623e+00,  elapsed time 117
INFO   step:    28,    loss: 9.4187e+00,   Y0: 2.1598e+00,  elapsed time 118
INFO   step:    29,    loss: 9.4137e+00,   Y0: 2.1576e+00,  elapsed time 118
INFO   step:    30,    loss: 9.4091e+00,   Y0: 2.1557e+00,  elapsed time 118
INFO   step:    31,    loss: 9.4049e+00,   Y0: 2.1537e+00,  elapsed time 118
INFO   step:    32,    loss: 9.4012e+00,   Y0: 2.1513e+00,  elapsed time 119
INFO   step:    33,    loss: 9.3980e+00,   Y0: 2.1489e+00,  elapsed time 119
INFO   step:    34,    loss: 9.3948e+00,   Y0: 2.1471e+00,  elapsed time 119
INFO   step:    35,    loss: 9.3922e+00,   Y0: 2.1456e+00,  elapsed time 120
INFO   step:    36,    loss: 9.3895e+00,   Y0: 2.1446e+00,  elapsed time 120
INFO   step:    37,    loss: 9.3871e+00,   Y0: 2.1443e+00,  elapsed time 120
INFO   step:    38,    loss: 9.3849e+00,   Y0: 2.1441e+00,  elapsed time 120
INFO   step:    39,    loss: 9.3828e+00,   Y0: 2.1446e+00,  elapsed time 121
INFO   step:    40,    loss: 9.3809e+00,   Y0: 2.1453e+00,  elapsed time 121
INFO   step:    41,    loss: 9.3791e+00,   Y0: 2.1466e+00,  elapsed time 121
INFO   step:    42,    loss: 9.3775e+00,   Y0: 2.1479e+00,  elapsed time 121
INFO   step:    43,    loss: 9.3760e+00,   Y0: 2.1495e+00,  elapsed time 122
INFO   step:    44,    loss: 9.3747e+00,   Y0: 2.1506e+00,  elapsed time 122
INFO   step:    45,    loss: 9.3735e+00,   Y0: 2.1522e+00,  elapsed time 122
INFO   step:    46,    loss: 9.3725e+00,   Y0: 2.1538e+00,  elapsed time 123
INFO   step:    47,    loss: 9.3716e+00,   Y0: 2.1545e+00,  elapsed time 123
INFO   step:    48,    loss: 9.3707e+00,   Y0: 2.1558e+00,  elapsed time 123
INFO   step:    49,    loss: 9.3699e+00,   Y0: 2.1567e+00,  elapsed time 123
INFO   step:    50,    loss: 9.3691e+00,   Y0: 2.1574e+00,  elapsed time 124
INFO   step:    51,    loss: 9.3683e+00,   Y0: 2.1586e+00,  elapsed time 124
INFO   step:    52,    loss: 9.3678e+00,   Y0: 2.1594e+00,  elapsed time 124
INFO   step:    53,    loss: 9.3672e+00,   Y0: 2.1596e+00,  elapsed time 125
INFO   step:    54,    loss: 9.3668e+00,   Y0: 2.1601e+00,  elapsed time 125
INFO   step:    55,    loss: 9.3663e+00,   Y0: 2.1604e+00,  elapsed time 125
INFO   step:    56,    loss: 9.3658e+00,   Y0: 2.1607e+00,  elapsed time 125
INFO   step:    57,    loss: 9.3654e+00,   Y0: 2.1606e+00,  elapsed time 126
INFO   step:    58,    loss: 9.3651e+00,   Y0: 2.1601e+00,  elapsed time 126
INFO   step:    59,    loss: 9.3648e+00,   Y0: 2.1598e+00,  elapsed time 126
INFO   step:    60,    loss: 9.3645e+00,   Y0: 2.1594e+00,  elapsed time 127
INFO   step:    61,    loss: 9.3643e+00,   Y0: 2.1588e+00,  elapsed time 127
INFO   step:    62,    loss: 9.3641e+00,   Y0: 2.1578e+00,  elapsed time 127
INFO   step:    63,    loss: 9.3639e+00,   Y0: 2.1571e+00,  elapsed time 127
INFO   step:    64,    loss: 9.3638e+00,   Y0: 2.1561e+00,  elapsed time 128
INFO   step:    65,    loss: 9.3637e+00,   Y0: 2.1549e+00,  elapsed time 128
INFO   step:    66,    loss: 9.3636e+00,   Y0: 2.1532e+00,  elapsed time 128
INFO   step:    67,    loss: 9.3636e+00,   Y0: 2.1517e+00,  elapsed time 129
INFO   step:    68,    loss: 9.3636e+00,   Y0: 2.1497e+00,  elapsed time 129
INFO   step:    69,    loss: 9.3636e+00,   Y0: 2.1479e+00,  elapsed time 129
INFO   step:    70,    loss: 9.3636e+00,   Y0: 2.1463e+00,  elapsed time 129
INFO   step:    71,    loss: 9.3637e+00,   Y0: 2.1449e+00,  elapsed time 130
INFO   step:    72,    loss: 9.3636e+00,   Y0: 2.1447e+00,  elapsed time 130
INFO   step:    73,    loss: 9.3635e+00,   Y0: 2.1442e+00,  elapsed time 130
INFO   step:    74,    loss: 9.3634e+00,   Y0: 2.1440e+00,  elapsed time 131
INFO   step:    75,    loss: 9.3632e+00,   Y0: 2.1446e+00,  elapsed time 131
INFO   step:    76,    loss: 9.3631e+00,   Y0: 2.1449e+00,  elapsed time 131
INFO   step:    77,    loss: 9.3629e+00,   Y0: 2.1457e+00,  elapsed time 131
INFO   step:    78,    loss: 9.3627e+00,   Y0: 2.1469e+00,  elapsed time 132
INFO   step:    79,    loss: 9.3625e+00,   Y0: 2.1479e+00,  elapsed time 132
INFO   step:    80,    loss: 9.3624e+00,   Y0: 2.1487e+00,  elapsed time 132
INFO   step:    81,    loss: 9.3622e+00,   Y0: 2.1491e+00,  elapsed time 132
INFO   step:    82,    loss: 9.3622e+00,   Y0: 2.1489e+00,  elapsed time 133
INFO   step:    83,    loss: 9.3621e+00,   Y0: 2.1490e+00,  elapsed time 133
INFO   step:    84,    loss: 9.3620e+00,   Y0: 2.1496e+00,  elapsed time 133
INFO   step:    85,    loss: 9.3619e+00,   Y0: 2.1502e+00,  elapsed time 134
INFO   step:    86,    loss: 9.3618e+00,   Y0: 2.1504e+00,  elapsed time 134
INFO   step:    87,    loss: 9.3617e+00,   Y0: 2.1510e+00,  elapsed time 134
INFO   step:    88,    loss: 9.3615e+00,   Y0: 2.1526e+00,  elapsed time 134
INFO   step:    89,    loss: 9.3613e+00,   Y0: 2.1532e+00,  elapsed time 135
INFO   step:    90,    loss: 9.3613e+00,   Y0: 2.1531e+00,  elapsed time 135
INFO   step:    91,    loss: 9.3612e+00,   Y0: 2.1529e+00,  elapsed time 135
INFO   step:    92,    loss: 9.3612e+00,   Y0: 2.1523e+00,  elapsed time 136
INFO   step:    93,    loss: 9.3613e+00,   Y0: 2.1510e+00,  elapsed time 136
INFO   step:    94,    loss: 9.3614e+00,   Y0: 2.1498e+00,  elapsed time 136
INFO   step:    95,    loss: 9.3614e+00,   Y0: 2.1492e+00,  elapsed time 136
INFO   step:    96,    loss: 9.3614e+00,   Y0: 2.1486e+00,  elapsed time 137
INFO   step:    97,    loss: 9.3613e+00,   Y0: 2.1486e+00,  elapsed time 137
INFO   step:    98,    loss: 9.3612e+00,   Y0: 2.1489e+00,  elapsed time 137
INFO   step:    99,    loss: 9.3612e+00,   Y0: 2.1493e+00,  elapsed time 137
INFO   step:   100,    loss: 9.3611e+00,   Y0: 2.1493e+00,  elapsed time 138
INFO   step:   101,    loss: 9.3611e+00,   Y0: 2.1492e+00,  elapsed time 138
INFO   step:   102,    loss: 9.3610e+00,   Y0: 2.1494e+00,  elapsed time 138
INFO   step:   103,    loss: 9.3609e+00,   Y0: 2.1498e+00,  elapsed time 139
INFO   step:   104,    loss: 9.3609e+00,   Y0: 2.1498e+00,  elapsed time 139
INFO   step:   105,    loss: 9.3607e+00,   Y0: 2.1506e+00,  elapsed time 139
INFO   step:   106,    loss: 9.3607e+00,   Y0: 2.1509e+00,  elapsed time 139
INFO   step:   107,    loss: 9.3606e+00,   Y0: 2.1513e+00,  elapsed time 140
INFO   step:   108,    loss: 9.3605e+00,   Y0: 2.1514e+00,  elapsed time 140
INFO   step:   109,    loss: 9.3605e+00,   Y0: 2.1516e+00,  elapsed time 140
INFO   step:   110,    loss: 9.3603e+00,   Y0: 2.1525e+00,  elapsed time 141
INFO   step:   111,    loss: 9.3602e+00,   Y0: 2.1533e+00,  elapsed time 141
INFO   step:   112,    loss: 9.3601e+00,   Y0: 2.1538e+00,  elapsed time 141
INFO   step:   113,    loss: 9.3600e+00,   Y0: 2.1547e+00,  elapsed time 141
INFO   step:   114,    loss: 9.3599e+00,   Y0: 2.1547e+00,  elapsed time 142
INFO   step:   115,    loss: 9.3599e+00,   Y0: 2.1546e+00,  elapsed time 142
INFO   step:   116,    loss: 9.3599e+00,   Y0: 2.1545e+00,  elapsed time 142
INFO   step:   117,    loss: 9.3598e+00,   Y0: 2.1552e+00,  elapsed time 142
INFO   step:   118,    loss: 9.3597e+00,   Y0: 2.1556e+00,  elapsed time 143
INFO   step:   119,    loss: 9.3596e+00,   Y0: 2.1561e+00,  elapsed time 143
INFO   step:   120,    loss: 9.3595e+00,   Y0: 2.1565e+00,  elapsed time 143
INFO   step:   121,    loss: 9.3595e+00,   Y0: 2.1563e+00,  elapsed time 144
INFO   step:   122,    loss: 9.3594e+00,   Y0: 2.1563e+00,  elapsed time 144
INFO   step:   123,    loss: 9.3594e+00,   Y0: 2.1561e+00,  elapsed time 144
INFO   step:   124,    loss: 9.3594e+00,   Y0: 2.1552e+00,  elapsed time 144
INFO   step:   125,    loss: 9.3594e+00,   Y0: 2.1550e+00,  elapsed time 145
INFO   step:   126,    loss: 9.3593e+00,   Y0: 2.1554e+00,  elapsed time 145
INFO   step:   127,    loss: 9.3593e+00,   Y0: 2.1556e+00,  elapsed time 145
INFO   step:   128,    loss: 9.3592e+00,   Y0: 2.1555e+00,  elapsed time 146
INFO   step:   129,    loss: 9.3592e+00,   Y0: 2.1558e+00,  elapsed time 146
INFO   step:   130,    loss: 9.3591e+00,   Y0: 2.1562e+00,  elapsed time 146
INFO   step:   131,    loss: 9.3590e+00,   Y0: 2.1565e+00,  elapsed time 146
INFO   step:   132,    loss: 9.3590e+00,   Y0: 2.1563e+00,  elapsed time 147
INFO   step:   133,    loss: 9.3590e+00,   Y0: 2.1563e+00,  elapsed time 147
INFO   step:   134,    loss: 9.3590e+00,   Y0: 2.1554e+00,  elapsed time 147
INFO   step:   135,    loss: 9.3590e+00,   Y0: 2.1547e+00,  elapsed time 147
INFO   step:   136,    loss: 9.3590e+00,   Y0: 2.1542e+00,  elapsed time 148
INFO   step:   137,    loss: 9.3590e+00,   Y0: 2.1540e+00,  elapsed time 148
INFO   step:   138,    loss: 9.3590e+00,   Y0: 2.1536e+00,  elapsed time 148
INFO   step:   139,    loss: 9.3590e+00,   Y0: 2.1535e+00,  elapsed time 149
INFO   step:   140,    loss: 9.3589e+00,   Y0: 2.1542e+00,  elapsed time 149
INFO   step:   141,    loss: 9.3588e+00,   Y0: 2.1549e+00,  elapsed time 149
INFO   step:   142,    loss: 9.3587e+00,   Y0: 2.1554e+00,  elapsed time 149
INFO   step:   143,    loss: 9.3585e+00,   Y0: 2.1564e+00,  elapsed time 150
INFO   step:   144,    loss: 9.3583e+00,   Y0: 2.1584e+00,  elapsed time 150
INFO   step:   145,    loss: 9.3581e+00,   Y0: 2.1610e+00,  elapsed time 150
INFO   step:   146,    loss: 9.3579e+00,   Y0: 2.1633e+00,  elapsed time 151
INFO   step:   147,    loss: 9.3577e+00,   Y0: 2.1656e+00,  elapsed time 151
INFO   step:   148,    loss: 9.3575e+00,   Y0: 2.1672e+00,  elapsed time 151
INFO   step:   149,    loss: 9.3575e+00,   Y0: 2.1677e+00,  elapsed time 151
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_40:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_41:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_42:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_43:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_44:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_45:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_46:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_47:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_48:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_49:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_50:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_51:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_52:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_53:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_54:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_55:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_56:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_57:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_58:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_59:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_60:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_61:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_62:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_63:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_64:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_65:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_66:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_67:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_68:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_69:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_70:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_71:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_72:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_73:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_74:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_75:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_76:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_77:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_78:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_79:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  80
# of dimensions:  1
Loss out:  9.95302197129443
Output_Z_Vals:  [[[ 3.30265892e+00]
  [ 3.30265892e+00]
  [ 3.30265892e+00]
  ...
  [ 3.30265892e+00]
  [ 3.30265892e+00]
  [ 3.30265892e+00]]

 [[-4.07024579e-03]
  [-1.33649181e-02]
  [-1.22273444e-02]
  ...
  [-1.27159393e-02]
  [-1.38065185e-02]
  [-1.32305386e-02]]

 [[ 2.73640592e-02]
  [ 2.39502496e-03]
  [-2.02272121e-02]
  ...
  [-6.62098241e-04]
  [ 1.43862375e-02]
  [-1.93069957e-02]]

 ...

 [[-4.11473944e-03]
  [-3.76499029e-03]
  [ 1.24776897e-04]
  ...
  [-3.68140730e-03]
  [-4.13743235e-03]
  [-3.65629863e-03]]

 [[ 9.40462021e-03]
  [ 1.16702577e-02]
  [-1.53637128e-02]
  ...
  [ 1.18339010e-02]
  [ 1.45704044e-02]
  [ 1.22417359e-02]]

 [[-1.96632731e-02]
  [-5.29249793e-03]
  [-2.75059786e-02]
  ...
  [-5.25213162e-03]
  [-4.75003642e-03]
  [-4.86128724e-03]]]
Z_Vals dimensionality:  (80, 200, 1)
X_test:  [[[100.         100.51397385 100.61429635 ... 100.0533841  100.27725184
   100.0946922 ]]

 [[100.          99.547608    99.6733637  ... 103.53261549 103.88602125
   104.37051511]]

 [[100.          99.21691265  98.87067966 ...  95.93505285  95.94646739
    95.97146622]]

 ...

 [[100.          99.35785196  99.57624852 ... 104.79064349 103.86871497
   103.70432125]]

 [[100.          99.86984941 100.20242429 ... 102.42736922 102.34067379
   102.59716072]]

 [[100.          99.50831655  98.95144886 ... 103.31003007 103.701148
   104.55431856]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.07024579e-03]
 [ 2.73640592e-02]
 [ 1.72106513e-02]
 [-7.51513487e-03]
 [-1.68347305e-02]
 [-1.36807538e-03]
 [-9.97829415e-03]
 [-1.47491342e-02]
 [-2.58482547e-03]
 [ 1.74070355e-03]
 [ 5.53917056e-03]
 [ 1.88569780e-03]
 [-2.52602144e-03]
 [ 5.71684923e-03]
 [-4.80072792e-04]
 [ 1.44909654e-02]
 [ 6.15061372e-02]
 [-1.22809533e-02]
 [ 1.90053141e-02]
 [ 8.45313109e-04]
 [-5.69284683e-03]
 [ 4.92111450e-03]
 [ 1.49720528e-02]
 [ 1.78350087e-02]
 [-5.87442182e-03]
 [ 4.60679572e-03]
 [ 9.40996670e-03]
 [ 8.24192467e-03]
 [ 1.63118685e-02]
 [ 2.70503589e-03]
 [-6.44144116e-03]
 [ 9.95998462e-03]
 [ 1.25646228e-02]
 [ 6.04788609e-03]
 [ 5.36517019e-03]
 [ 9.56938424e-03]
 [-2.62979762e-02]
 [ 3.11943945e-03]
 [-3.79158948e-02]
 [-1.46375570e-02]
 [ 7.02101624e-03]
 [-7.47421894e-04]
 [-1.77735201e-03]
 [-2.88098301e-03]
 [ 2.16103876e-02]
 [ 1.54241054e-02]
 [ 1.07761279e-02]
 [ 4.36851682e-03]
 [ 8.65729135e-03]
 [-1.99945819e-03]
 [ 1.75494967e-03]
 [-1.28832229e-02]
 [ 2.12275268e-03]
 [ 7.75333646e-04]
 [-3.50537460e-03]
 [-3.54638644e-03]
 [ 9.95506936e-03]
 [ 1.31161127e-05]
 [ 6.89418239e-03]
 [-4.01989115e-03]
 [-1.48808431e-03]
 [ 7.01335151e-03]
 [-8.55505331e-03]
 [ 7.50924804e-03]
 [ 2.52419448e-02]
 [ 5.49537954e-03]
 [ 1.35217362e-02]
 [ 2.67352973e-03]
 [ 3.06039292e-03]
 [ 1.99371834e-02]
 [ 5.29110904e-04]
 [-1.58486472e-02]
 [-1.33620275e-04]
 [ 1.40055494e-03]
 [-3.78106655e-04]
 [-1.06949503e-02]
 [-4.11473944e-03]
 [ 9.40462021e-03]
 [-1.96632731e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.34644689]
curr_Stock_Price:  100.5139738450634
curr_Factors:  [100.51397385]
mat_Sqrt:  [[0.15]]
grads:  [-0.02713497]
Stock Position:  -0.02713497191942033
Bond Position:  [16.07389074]


portfolio before change:  [13.34472929]
curr_Stock_Price:  100.61429635270461
curr_Factors:  [100.61429635]
mat_Sqrt:  [[0.15]]
grads:  [0.18242706]
Stock Position:  0.1824270614156045
Bond Position:  [-5.01004113]


portfolio before change:  [13.31733499]
curr_Stock_Price:  100.46584709707169
curr_Factors:  [100.4658471]
mat_Sqrt:  [[0.15]]
grads:  [0.11473768]
Stock Position:  0.11473767553418904
Bond Position:  [1.79011722]


portfolio before change:  [13.26645274]
curr_Stock_Price:  100.0214060306543
curr_Factors:  [100.02140603]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501009]
Stock Position:  -0.05010089914938672
Bond Position:  [18.27761512]


portfolio before change:  [13.22148648]
curr_Stock_Price:  100.94172171580975
curr_Factors:  [100.94172172]
mat_Sqrt:  [[0.15]]
grads:  [-0.11223154]
Stock Position:  -0.11223153653884654
Bond Position:  [24.55033101]


portfolio before change:  [13.23019102]
curr_Stock_Price:  100.87783505909586
curr_Factors:  [100.87783506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0091205]
Stock Position:  -0.009120502539696266
Bond Position:  [14.15024757]


portfolio before change:  [13.23121673]
curr_Stock_Price:  100.86234372927726
curr_Factors:  [100.86234373]
mat_Sqrt:  [[0.15]]
grads:  [-0.06652196]
Stock Position:  -0.06652196101611176
Bond Position:  [19.94077763]


portfolio before change:  [13.26108305]
curr_Stock_Price:  100.43211007555679
curr_Factors:  [100.43211008]
mat_Sqrt:  [[0.15]]
grads:  [-0.09832756]
Stock Position:  -0.09832756151853145
Bond Position:  [23.13632754]


portfolio before change:  [13.2893385]
curr_Stock_Price:  100.15945635764024
curr_Factors:  [100.15945636]
mat_Sqrt:  [[0.15]]
grads:  [-0.01723217]
Stock Position:  -0.017232169788098245
Bond Position:  [15.01530325]


portfolio before change:  [13.28284692]
curr_Stock_Price:  100.5906304333611
curr_Factors:  [100.59063043]
mat_Sqrt:  [[0.15]]
grads:  [0.01160469]
Stock Position:  0.011604690348909995
Bond Position:  [12.1155238]


portfolio before change:  [13.28237391]
curr_Stock_Price:  100.48461685663038
curr_Factors:  [100.48461686]
mat_Sqrt:  [[0.15]]
grads:  [0.0369278]
Stock Position:  0.03692780375120658
Bond Position:  [9.57169769]


portfolio before change:  [13.29046714]
curr_Stock_Price:  100.68757995523745
curr_Factors:  [100.68757996]
mat_Sqrt:  [[0.15]]
grads:  [0.01257132]
Stock Position:  0.012571318693315505
Bond Position:  [12.02469148]


portfolio before change:  [13.28734438]
curr_Stock_Price:  100.37939261772195
curr_Factors:  [100.37939262]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684014]
Stock Position:  -0.016840142934257514
Bond Position:  [14.9777477]


portfolio before change:  [13.27595694]
curr_Stock_Price:  101.11119056199347
curr_Factors:  [101.11119056]
mat_Sqrt:  [[0.15]]
grads:  [0.03811233]
Stock Position:  0.03811232818363042
Bond Position:  [9.42237406]


portfolio before change:  [13.27598682]
curr_Stock_Price:  101.09652255448356
curr_Factors:  [101.09652255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320049]
Stock Position:  -0.0032004852827206024
Bond Position:  [13.59954476]


portfolio before change:  [13.27864047]
curr_Stock_Price:  100.53296921912025
curr_Factors:  [100.53296922]
mat_Sqrt:  [[0.15]]
grads:  [0.09660644]
Stock Position:  0.09660643581559045
Bond Position:  [3.56650863]


portfolio before change:  [13.34791318]
curr_Stock_Price:  101.24772279933232
curr_Factors:  [101.2477228]
mat_Sqrt:  [[0.15]]
grads:  [0.41004091]
Stock Position:  0.41004091493864225
Bond Position:  [-28.16779572]


portfolio before change:  [13.70693694]
curr_Stock_Price:  102.12759670645214
curr_Factors:  [102.12759671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08187302]
Stock Position:  -0.08187302205782086
Bond Position:  [22.06843191]


portfolio before change:  [13.74701162]
curr_Stock_Price:  101.65497015527835
curr_Factors:  [101.65497016]
mat_Sqrt:  [[0.15]]
grads:  [0.12670209]
Stock Position:  0.12670209397216328
Bond Position:  [0.86711404]


portfolio before change:  [13.85179993]
curr_Stock_Price:  102.48158722559498
curr_Factors:  [102.48158723]
mat_Sqrt:  [[0.15]]
grads:  [0.00563542]
Stock Position:  0.005635420724064968
Bond Position:  [13.27427307]


portfolio before change:  [13.85252541]
curr_Stock_Price:  102.46309916230832
curr_Factors:  [102.46309916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03795231]
Stock Position:  -0.03795231217978466
Bond Position:  [17.74123694]


portfolio before change:  [13.87582281]
curr_Stock_Price:  101.8784565457555
curr_Factors:  [101.87845655]
mat_Sqrt:  [[0.15]]
grads:  [0.03280743]
Stock Position:  0.03280742997072693
Bond Position:  [10.53345248]


portfolio before change:  [13.82119326]
curr_Stock_Price:  100.19323125199776
curr_Factors:  [100.19323125]
mat_Sqrt:  [[0.15]]
grads:  [0.09981369]
Stock Position:  0.09981368529234666
Bond Position:  [3.82053761]


portfolio before change:  [13.72698133]
curr_Stock_Price:  99.24696099250922
curr_Factors:  [99.24696099]
mat_Sqrt:  [[0.15]]
grads:  [0.11890006]
Stock Position:  0.11890005799194822
Bond Position:  [1.92651191]


portfolio before change:  [13.71739931]
curr_Stock_Price:  99.16535941394237
curr_Factors:  [99.16535941]
mat_Sqrt:  [[0.15]]
grads:  [-0.03916281]
Stock Position:  -0.039162812133594654
Bond Position:  [17.60099365]


portfolio before change:  [13.74505025]
curr_Stock_Price:  98.4873987890527
curr_Factors:  [98.48739879]
mat_Sqrt:  [[0.15]]
grads:  [0.03071197]
Stock Position:  0.030711971448764176
Bond Position:  [10.72030807]


portfolio before change:  [13.76164865]
curr_Stock_Price:  99.00603580321113
curr_Factors:  [99.0060358]
mat_Sqrt:  [[0.15]]
grads:  [0.06273311]
Stock Position:  0.06273311131732773
Bond Position:  [7.55069199]


portfolio before change:  [13.79532954]
curr_Stock_Price:  99.53540464523233
curr_Factors:  [99.53540465]
mat_Sqrt:  [[0.15]]
grads:  [0.05494616]
Stock Position:  0.054946164446535536
Bond Position:  [8.32624083]


portfolio before change:  [13.78813319]
curr_Stock_Price:  99.39496254671268
curr_Factors:  [99.39496255]
mat_Sqrt:  [[0.15]]
grads:  [0.10874579]
Stock Position:  0.1087457900189287
Bond Position:  [2.97934947]


portfolio before change:  [13.74426513]
curr_Stock_Price:  98.9898500256337
curr_Factors:  [98.98985003]
mat_Sqrt:  [[0.15]]
grads:  [0.01803357]
Stock Position:  0.01803357258142157
Bond Position:  [11.95912448]


portfolio before change:  [13.7393608]
curr_Stock_Price:  98.67644561876257
curr_Factors:  [98.67644562]
mat_Sqrt:  [[0.15]]
grads:  [-0.04294294]
Stock Position:  -0.04294294107698932
Bond Position:  [17.97681759]


portfolio before change:  [13.698776]
curr_Stock_Price:  99.64769687348834
curr_Factors:  [99.64769687]
mat_Sqrt:  [[0.15]]
grads:  [0.0663999]
Stock Position:  0.06639989747070231
Bond Position:  [7.08217914]


portfolio before change:  [13.78498799]
curr_Stock_Price:  100.9394058538866
curr_Factors:  [100.93940585]
mat_Sqrt:  [[0.15]]
grads:  [0.08376415]
Stock Position:  0.08376415215692957
Bond Position:  [5.32988424]


portfolio before change:  [13.8569018]
curr_Stock_Price:  101.79395620418228
curr_Factors:  [101.7939562]
mat_Sqrt:  [[0.15]]
grads:  [0.04031924]
Stock Position:  0.040319240612864106
Bond Position:  [9.75264679]


portfolio before change:  [13.83087428]
curr_Stock_Price:  101.13330170597631
curr_Factors:  [101.13330171]
mat_Sqrt:  [[0.15]]
grads:  [0.0357678]
Stock Position:  0.03576780129035736
Bond Position:  [10.21355844]


portfolio before change:  [13.83052829]
curr_Stock_Price:  101.10578101096631
curr_Factors:  [101.10578101]
mat_Sqrt:  [[0.15]]
grads:  [0.06379589]
Stock Position:  0.06379589490187597
Bond Position:  [7.38039451]


portfolio before change:  [13.79618203]
curr_Stock_Price:  100.5601730387627
curr_Factors:  [100.56017304]
mat_Sqrt:  [[0.15]]
grads:  [-0.17531984]
Stock Position:  -0.1753198412957729
Bond Position:  [31.42637561]


portfolio before change:  [13.88050129]
curr_Stock_Price:  100.09043126712062
curr_Factors:  [100.09043127]
mat_Sqrt:  [[0.15]]
grads:  [0.02079626]
Stock Position:  0.020796263004843864
Bond Position:  [11.79899436]


portfolio before change:  [13.85682198]
curr_Stock_Price:  98.9163370334792
curr_Factors:  [98.91633703]
mat_Sqrt:  [[0.15]]
grads:  [-0.25277263]
Stock Position:  -0.2527726319352906
Bond Position:  [38.86016483]


portfolio before change:  [13.84966502]
curr_Stock_Price:  98.95425962909545
curr_Factors:  [98.95425963]
mat_Sqrt:  [[0.15]]
grads:  [-0.09758371]
Stock Position:  -0.0975837134761148
Bond Position:  [23.50598914]


portfolio before change:  [13.739239]
curr_Stock_Price:  100.10091813806154
curr_Factors:  [100.10091814]
mat_Sqrt:  [[0.15]]
grads:  [0.04680677]
Stock Position:  0.04680677495673125
Bond Position:  [9.05383785]


portfolio before change:  [13.74492189]
curr_Stock_Price:  100.2102402535975
curr_Factors:  [100.21024025]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498281]
Stock Position:  -0.004982812629759706
Bond Position:  [14.24425074]


portfolio before change:  [13.74581913]
curr_Stock_Price:  100.20884667825264
curr_Factors:  [100.20884668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01184901]
Stock Position:  -0.011849013384796105
Bond Position:  [14.9331951]


portfolio before change:  [13.7506636]
curr_Stock_Price:  99.87876715789993
curr_Factors:  [99.87876716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01920655]
Stock Position:  -0.01920655336912189
Bond Position:  [15.66899047]


portfolio before change:  [13.75335924]
curr_Stock_Price:  99.78940709679118
curr_Factors:  [99.7894071]
mat_Sqrt:  [[0.15]]
grads:  [0.14406925]
Stock Position:  0.14406925062418333
Bond Position:  [-0.62322586]


portfolio before change:  [13.72769825]
curr_Stock_Price:  99.61156175321806
curr_Factors:  [99.61156175]
mat_Sqrt:  [[0.15]]
grads:  [0.10282737]
Stock Position:  0.10282736906577271
Bond Position:  [3.48490342]


portfolio before change:  [13.73204847]
curr_Stock_Price:  99.65174963107503
curr_Factors:  [99.65174963]
mat_Sqrt:  [[0.15]]
grads:  [0.07184085]
Stock Position:  0.07184085284681947
Bond Position:  [6.57298179]


portfolio before change:  [13.7360932]
curr_Stock_Price:  99.7023323012145
curr_Factors:  [99.7023323]
mat_Sqrt:  [[0.15]]
grads:  [0.02912345]
Stock Position:  0.02912344548735397
Bond Position:  [10.83241776]


portfolio before change:  [13.74638776]
curr_Stock_Price:  100.03256508556484
curr_Factors:  [100.03256509]
mat_Sqrt:  [[0.15]]
grads:  [0.05771528]
Stock Position:  0.057715275691664
Bond Position:  [7.97298069]


portfolio before change:  [13.75352328]
curr_Stock_Price:  100.14756398321792
curr_Factors:  [100.14756398]
mat_Sqrt:  [[0.15]]
grads:  [-0.01332972]
Stock Position:  -0.01332972125998093
Bond Position:  [15.08846239]


portfolio before change:  [13.75201515]
curr_Stock_Price:  100.33145318566227
curr_Factors:  [100.33145319]
mat_Sqrt:  [[0.15]]
grads:  [0.01169966]
Stock Position:  0.0116996644463972
Bond Position:  [12.57817081]


portfolio before change:  [13.75725825]
curr_Stock_Price:  100.71239939882365
curr_Factors:  [100.7123994]
mat_Sqrt:  [[0.15]]
grads:  [-0.08588815]
Stock Position:  -0.08588815251457027
Bond Position:  [22.40726017]


portfolio before change:  [13.80070902]
curr_Stock_Price:  100.2228059990139
curr_Factors:  [100.222806]
mat_Sqrt:  [[0.15]]
grads:  [0.01415168]
Stock Position:  0.014151684561607732
Bond Position:  [12.38238749]


portfolio before change:  [13.81596449]
curr_Stock_Price:  101.24611455985482
curr_Factors:  [101.24611456]
mat_Sqrt:  [[0.15]]
grads:  [0.00516889]
Stock Position:  0.0051688909751065075
Bond Position:  [13.29263436]


portfolio before change:  [13.81842687]
curr_Stock_Price:  101.561766337559
curr_Factors:  [101.56176634]
mat_Sqrt:  [[0.15]]
grads:  [-0.02336916]
Stock Position:  -0.02336916399716696
Bond Position:  [16.19184044]


portfolio before change:  [13.82543985]
curr_Stock_Price:  101.30497665431182
curr_Factors:  [101.30497665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02364258]
Stock Position:  -0.023642576273653574
Bond Position:  [16.22055049]


portfolio before change:  [13.82859231]
curr_Stock_Price:  101.21451946326732
curr_Factors:  [101.21451946]
mat_Sqrt:  [[0.15]]
grads:  [0.06636713]
Stock Position:  0.0663671290408872
Bond Position:  [7.11127524]


portfolio before change:  [13.8016702]
curr_Stock_Price:  100.80216800612085
curr_Factors:  [100.80216801]
mat_Sqrt:  [[0.15]]
grads:  [8.74407517e-05]
Stock Position:  8.744075166570073e-05
Bond Position:  [13.79285598]


portfolio before change:  [13.80257264]
curr_Stock_Price:  101.26380638313051
curr_Factors:  [101.26380638]
mat_Sqrt:  [[0.15]]
grads:  [0.04596122]
Stock Position:  0.04596121596123729
Bond Position:  [9.14836497]


portfolio before change:  [13.77046783]
curr_Stock_Price:  100.5528460569178
curr_Factors:  [100.55284606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679927]
Stock Position:  -0.026799274319461455
Bond Position:  [16.46521114]


portfolio before change:  [13.75330505]
curr_Stock_Price:  101.23166615825726
curr_Factors:  [101.23166616]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992056]
Stock Position:  -0.009920562060190536
Bond Position:  [14.75758008]


portfolio before change:  [13.75614453]
curr_Stock_Price:  101.03842142821694
curr_Factors:  [101.03842143]
mat_Sqrt:  [[0.15]]
grads:  [0.04675568]
Stock Position:  0.04675567673219203
Bond Position:  [9.03202476]


portfolio before change:  [13.73249807]
curr_Stock_Price:  100.52060241504816
curr_Factors:  [100.52060242]
mat_Sqrt:  [[0.15]]
grads:  [-0.05703369]
Stock Position:  -0.057033688761906925
Bond Position:  [19.46555882]


portfolio before change:  [13.7115148]
curr_Stock_Price:  100.90984434732422
curr_Factors:  [100.90984435]
mat_Sqrt:  [[0.15]]
grads:  [0.05006165]
Stock Position:  0.05006165358227357
Bond Position:  [8.65980113]


portfolio before change:  [13.70845678]
curr_Stock_Price:  100.83794747959114
curr_Factors:  [100.83794748]
mat_Sqrt:  [[0.15]]
grads:  [0.16827963]
Stock Position:  0.16827963210245783
Bond Position:  [-3.26051592]


portfolio before change:  [13.77258248]
curr_Stock_Price:  101.22022482989087
curr_Factors:  [101.22022483]
mat_Sqrt:  [[0.15]]
grads:  [0.03663586]
Stock Position:  0.036635863600285284
Bond Position:  [10.06429213]


portfolio before change:  [13.79560512]
curr_Stock_Price:  101.83147292243295
curr_Factors:  [101.83147292]
mat_Sqrt:  [[0.15]]
grads:  [0.09014491]
Stock Position:  0.09014490833309782
Bond Position:  [4.61601633]


portfolio before change:  [13.75613076]
curr_Stock_Price:  101.39037344387427
curr_Factors:  [101.39037344]
mat_Sqrt:  [[0.15]]
grads:  [0.01782353]
Stock Position:  0.017823531524888664
Bond Position:  [11.94899624]


portfolio before change:  [13.75670835]
curr_Stock_Price:  101.38087807963896
curr_Factors:  [101.38087808]
mat_Sqrt:  [[0.15]]
grads:  [0.02040262]
Stock Position:  0.020402619435704625
Bond Position:  [11.68827288]


portfolio before change:  [13.75112573]
curr_Stock_Price:  101.07144890295066
curr_Factors:  [101.0714489]
mat_Sqrt:  [[0.15]]
grads:  [0.13291456]
Stock Position:  0.13291455589666284
Bond Position:  [0.31725898]


portfolio before change:  [13.81845843]
curr_Stock_Price:  101.577886040165
curr_Factors:  [101.57788604]
mat_Sqrt:  [[0.15]]
grads:  [0.00352741]
Stock Position:  0.0035274060273142336
Bond Position:  [13.46015198]


portfolio before change:  [13.8182235]
curr_Stock_Price:  101.27278740058445
curr_Factors:  [101.2727874]
mat_Sqrt:  [[0.15]]
grads:  [-0.10565765]
Stock Position:  -0.1056576481858891
Bond Position:  [24.51846805]


portfolio before change:  [13.78645045]
curr_Stock_Price:  101.5880084093222
curr_Factors:  [101.58800841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008908]
Stock Position:  -0.0008908018331159803
Bond Position:  [13.87694523]


portfolio before change:  [13.78755429]
curr_Stock_Price:  101.32251315960855
curr_Factors:  [101.32251316]
mat_Sqrt:  [[0.15]]
grads:  [0.00933703]
Stock Position:  0.009337032962322649
Bond Position:  [12.84150264]


portfolio before change:  [13.78115292]
curr_Stock_Price:  100.55096322857196
curr_Factors:  [100.55096323]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252071]
Stock Position:  -0.0025207110322393706
Bond Position:  [14.03461284]


portfolio before change:  [13.78112404]
curr_Stock_Price:  100.9104108774355
curr_Factors:  [100.91041088]
mat_Sqrt:  [[0.15]]
grads:  [-0.07129967]
Stock Position:  -0.07129966897931236
Bond Position:  [20.97600294]


portfolio before change:  [13.83734759]
curr_Stock_Price:  100.14024595642537
curr_Factors:  [100.14024596]
mat_Sqrt:  [[0.15]]
grads:  [-0.0274316]
Stock Position:  -0.02743159628439005
Bond Position:  [16.58435439]


portfolio before change:  [13.8407669]
curr_Stock_Price:  100.05338410266451
curr_Factors:  [100.0533841]
mat_Sqrt:  [[0.15]]
grads:  [0.06269747]
Stock Position:  0.06269746806741798
Bond Position:  [7.56767305]


portfolio before change:  [13.85527584]
curr_Stock_Price:  100.27725183563294
curr_Factors:  [100.27725184]
mat_Sqrt:  [[0.15]]
grads:  [-0.13108849]
Stock Position:  -0.1310884870172635
Bond Position:  [27.00046906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.88089489]
Stock Price:  100.09469219714082
PL:  [13.78620269]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33649181e-02]
 [ 2.39502496e-03]
 [ 5.89219633e-03]
 [-9.08892429e-03]
 [ 1.49460299e-02]
 [-1.38873476e-02]
 [-1.33797865e-02]
 [ 3.84538370e-02]
 [-2.10450047e-02]
 [-1.36001169e-02]
 [-1.39625768e-02]
 [-5.71141577e-03]
 [ 3.16811849e-03]
 [-6.42658701e-03]
 [ 5.03600510e-03]
 [ 2.40429875e-03]
 [-3.71258843e-02]
 [-1.01746305e-02]
 [ 2.33510439e-02]
 [-4.37875736e-03]
 [-2.67400354e-02]
 [ 5.85355775e-03]
 [ 1.36612096e-02]
 [ 1.58178452e-02]
 [ 5.84262366e-03]
 [ 4.41600763e-03]
 [ 5.44714070e-04]
 [ 9.67169190e-03]
 [ 1.61048043e-02]
 [ 3.71918029e-02]
 [-6.85304245e-03]
 [ 1.86004565e-02]
 [ 1.15320565e-02]
 [-1.40677037e-02]
 [ 2.71275180e-03]
 [ 1.83623369e-02]
 [ 5.38891669e-03]
 [ 2.82542314e-04]
 [-4.62720133e-02]
 [-1.18389491e-02]
 [ 7.19313990e-03]
 [-1.99419204e-04]
 [-1.51068339e-03]
 [-4.34750678e-03]
 [ 2.23718949e-02]
 [ 1.54321700e-02]
 [ 1.07592140e-02]
 [ 4.38095839e-03]
 [ 7.07051050e-03]
 [-2.04364385e-03]
 [-5.02312078e-03]
 [-2.57372798e-03]
 [ 1.82433694e-03]
 [ 8.13356322e-03]
 [-9.44881343e-03]
 [-4.55572939e-03]
 [-2.89006626e-04]
 [ 9.66463260e-03]
 [ 7.59456105e-03]
 [-3.93834685e-03]
 [-1.68867758e-03]
 [ 5.22925387e-04]
 [-6.20493366e-03]
 [ 4.27646830e-03]
 [ 1.98088811e-02]
 [ 4.97028514e-03]
 [ 8.28602675e-03]
 [-8.62525911e-04]
 [ 2.68517024e-03]
 [ 2.10056301e-02]
 [ 3.39381665e-04]
 [-1.59778097e-02]
 [-6.11558757e-04]
 [ 1.37843222e-03]
 [ 1.81260617e-03]
 [-1.60400880e-02]
 [-3.76499029e-03]
 [ 1.16702577e-02]
 [-5.29249793e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.93073156]
curr_Stock_Price:  99.54760800290973
curr_Factors:  [99.547608]
mat_Sqrt:  [[0.15]]
grads:  [-0.08909945]
Stock Position:  -0.08909945374325731
Bond Position:  [0.93890593]


portfolio before change:  [-7.94187764]
curr_Stock_Price:  99.67336370053766
curr_Factors:  [99.6733637]
mat_Sqrt:  [[0.15]]
grads:  [0.01596683]
Stock Position:  0.015966833037168705
Bond Position:  [-9.5333456]


portfolio before change:  [-7.94382322]
curr_Stock_Price:  99.5888305568901
curr_Factors:  [99.58883056]
mat_Sqrt:  [[0.15]]
grads:  [0.03928131]
Stock Position:  0.039281308893012276
Bond Position:  [-11.85580284]


portfolio before change:  [-7.93455338]
curr_Stock_Price:  99.84368091286021
curr_Factors:  [99.84368091]
mat_Sqrt:  [[0.15]]
grads:  [-0.06059283]
Stock Position:  -0.060592828626368826
Bond Position:  [-1.88474233]


portfolio before change:  [-7.91898655]
curr_Stock_Price:  99.58482804478764
curr_Factors:  [99.58482804]
mat_Sqrt:  [[0.15]]
grads:  [0.0996402]
Stock Position:  0.09964019926797489
Bond Position:  [-17.84163866]


portfolio before change:  [-7.99439268]
curr_Stock_Price:  98.83923547490713
curr_Factors:  [98.83923547]
mat_Sqrt:  [[0.15]]
grads:  [-0.09258232]
Stock Position:  -0.09258231708230914
Bond Position:  [1.15637276]


portfolio before change:  [-7.97258118]
curr_Stock_Price:  98.60442577932146
curr_Factors:  [98.60442578]
mat_Sqrt:  [[0.15]]
grads:  [-0.08919858]
Stock Position:  -0.08919857690330156
Bond Position:  [0.82279328]


portfolio before change:  [-7.94723323]
curr_Stock_Price:  98.32082796443979
curr_Factors:  [98.32082796]
mat_Sqrt:  [[0.15]]
grads:  [0.25635891]
Stock Position:  0.25635891358060475
Bond Position:  [-33.15265387]


portfolio before change:  [-8.31161337]
curr_Stock_Price:  96.90754364776849
curr_Factors:  [96.90754365]
mat_Sqrt:  [[0.15]]
grads:  [-0.14030003]
Stock Position:  -0.14030003119715445
Bond Position:  [5.28451803]


portfolio before change:  [-8.26632906]
curr_Stock_Price:  96.58713021690366
curr_Factors:  [96.58713022]
mat_Sqrt:  [[0.15]]
grads:  [-0.09066745]
Stock Position:  -0.09066744609618456
Bond Position:  [0.49097936]


portfolio before change:  [-8.21237031]
curr_Stock_Price:  95.99234052458992
curr_Factors:  [95.99234052]
mat_Sqrt:  [[0.15]]
grads:  [-0.09308385]
Stock Position:  -0.09308384556656217
Bond Position:  [0.72296589]


portfolio before change:  [-8.30468628]
curr_Stock_Price:  96.98457660466886
curr_Factors:  [96.9845766]
mat_Sqrt:  [[0.15]]
grads:  [-0.03807611]
Stock Position:  -0.03807610514948791
Bond Position:  [-4.61189134]


portfolio before change:  [-8.30429457]
curr_Stock_Price:  96.96671878092963
curr_Factors:  [96.96671878]
mat_Sqrt:  [[0.15]]
grads:  [0.02112079]
Stock Position:  0.021120789902400423
Bond Position:  [-10.35230827]


portfolio before change:  [-8.3026826]
curr_Stock_Price:  97.07367553924668
curr_Factors:  [97.07367554]
mat_Sqrt:  [[0.15]]
grads:  [-0.04284391]
Stock Position:  -0.04284391342369887
Bond Position:  [-4.14366645]


portfolio before change:  [-8.29700108]
curr_Stock_Price:  96.9350209012533
curr_Factors:  [96.9350209]
mat_Sqrt:  [[0.15]]
grads:  [0.03357337]
Stock Position:  0.03357336732516446
Bond Position:  [-11.55143614]


portfolio before change:  [-8.2871015]
curr_Stock_Price:  97.25138985511778
curr_Factors:  [97.25138986]
mat_Sqrt:  [[0.15]]
grads:  [0.01602866]
Stock Position:  0.016028658325759282
Bond Position:  [-9.8459108]


portfolio before change:  [-8.29529163]
curr_Stock_Price:  96.778814906974
curr_Factors:  [96.77881491]
mat_Sqrt:  [[0.15]]
grads:  [-0.2475059]
Stock Position:  -0.2475058956040729
Bond Position:  [15.65803563]


portfolio before change:  [-8.23998872]
curr_Stock_Price:  96.55932822891585
curr_Factors:  [96.55932823]
mat_Sqrt:  [[0.15]]
grads:  [-0.06783087]
Stock Position:  -0.06783086988741664
Bond Position:  [-1.69028549]


portfolio before change:  [-8.2321028]
curr_Stock_Price:  96.44151214004347
curr_Factors:  [96.44151214]
mat_Sqrt:  [[0.15]]
grads:  [0.15567363]
Stock Position:  0.15567362575005528
Bond Position:  [-23.24550267]


portfolio before change:  [-8.23379796]
curr_Stock_Price:  96.43995588382595
curr_Factors:  [96.43995588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02919172]
Stock Position:  -0.029191715713855412
Bond Position:  [-5.41855018]


portfolio before change:  [-8.21920047]
curr_Stock_Price:  95.92829834875312
curr_Factors:  [95.92829835]
mat_Sqrt:  [[0.15]]
grads:  [-0.1782669]
Stock Position:  -0.1782669023464909
Bond Position:  [8.88164013]


portfolio before change:  [-8.35295921]
curr_Stock_Price:  96.68174086512307
curr_Factors:  [96.68174087]
mat_Sqrt:  [[0.15]]
grads:  [0.03902372]
Stock Position:  0.039023718358750244
Bond Position:  [-12.12584024]


portfolio before change:  [-8.3561113]
curr_Stock_Price:  96.62038840458499
curr_Factors:  [96.6203884]
mat_Sqrt:  [[0.15]]
grads:  [0.09107473]
Stock Position:  0.09107473063925049
Bond Position:  [-17.15578715]


portfolio before change:  [-8.34751892]
curr_Stock_Price:  96.72650618032309
curr_Factors:  [96.72650618]
mat_Sqrt:  [[0.15]]
grads:  [0.1054523]
Stock Position:  0.10545230124428746
Bond Position:  [-18.54755159]


portfolio before change:  [-8.33405043]
curr_Stock_Price:  96.86522052397413
curr_Factors:  [96.86522052]
mat_Sqrt:  [[0.15]]
grads:  [0.03895082]
Stock Position:  0.03895082437371681
Bond Position:  [-12.10703063]


portfolio before change:  [-8.32746972]
curr_Stock_Price:  97.05359714298275
curr_Factors:  [97.05359714]
mat_Sqrt:  [[0.15]]
grads:  [0.02944005]
Stock Position:  0.02944005087327783
Bond Position:  [-11.18473256]


portfolio before change:  [-8.32093027]
curr_Stock_Price:  97.29947048055459
curr_Factors:  [97.29947048]
mat_Sqrt:  [[0.15]]
grads:  [0.00363143]
Stock Position:  0.0036314271321532393
Bond Position:  [-8.6742662]


portfolio before change:  [-8.32091032]
curr_Stock_Price:  97.45425963830976
curr_Factors:  [97.45425964]
mat_Sqrt:  [[0.15]]
grads:  [0.06447795]
Stock Position:  0.06447794600014971
Bond Position:  [-14.60456081]


portfolio before change:  [-8.32160947]
curr_Stock_Price:  97.4575734154797
curr_Factors:  [97.45757342]
mat_Sqrt:  [[0.15]]
grads:  [0.10736536]
Stock Position:  0.10736536223242568
Bond Position:  [-18.78517714]


portfolio before change:  [-8.36659017]
curr_Stock_Price:  97.04955919487715
curr_Factors:  [97.04955919]
mat_Sqrt:  [[0.15]]
grads:  [0.24794535]
Stock Position:  0.24794535251664826
Bond Position:  [-32.42957734]


portfolio before change:  [-8.45213462]
curr_Stock_Price:  96.71272071742598
curr_Factors:  [96.71272072]
mat_Sqrt:  [[0.15]]
grads:  [-0.04568695]
Stock Position:  -0.04568694966750431
Bond Position:  [-4.03362542]


portfolio before change:  [-8.47338767]
curr_Stock_Price:  97.17239119041214
curr_Factors:  [97.17239119]
mat_Sqrt:  [[0.15]]
grads:  [0.12400304]
Stock Position:  0.12400304311724379
Bond Position:  [-20.52305989]


portfolio before change:  [-8.39070549]
curr_Stock_Price:  97.84951099311924
curr_Factors:  [97.84951099]
mat_Sqrt:  [[0.15]]
grads:  [0.07688038]
Stock Position:  0.07688037658178078
Bond Position:  [-15.91341274]


portfolio before change:  [-8.30520137]
curr_Stock_Price:  98.97461911906896
curr_Factors:  [98.97461912]
mat_Sqrt:  [[0.15]]
grads:  [-0.09378469]
Stock Position:  -0.09378469155762621
Bond Position:  [0.97710276]


portfolio before change:  [-8.32206123]
curr_Stock_Price:  99.15504227748534
curr_Factors:  [99.15504228]
mat_Sqrt:  [[0.15]]
grads:  [0.01808501]
Stock Position:  0.018085012033036762
Bond Position:  [-10.11528136]


portfolio before change:  [-8.33375427]
curr_Stock_Price:  98.54344112749627
curr_Factors:  [98.54344113]
mat_Sqrt:  [[0.15]]
grads:  [0.12241558]
Stock Position:  0.12241557923979773
Bond Position:  [-20.39700669]


portfolio before change:  [-8.36599743]
curr_Stock_Price:  98.29046427401686
curr_Factors:  [98.29046427]
mat_Sqrt:  [[0.15]]
grads:  [0.03592611]
Stock Position:  0.03592611127242436
Bond Position:  [-11.89719158]


portfolio before change:  [-8.37225813]
curr_Stock_Price:  98.13689625229362
curr_Factors:  [98.13689625]
mat_Sqrt:  [[0.15]]
grads:  [0.00188362]
Stock Position:  0.001883615427927509
Bond Position:  [-8.5571103]


portfolio before change:  [-8.37080235]
curr_Stock_Price:  99.19370232023098
curr_Factors:  [99.19370232]
mat_Sqrt:  [[0.15]]
grads:  [-0.30848009]
Stock Position:  -0.30848008881998884
Bond Position:  [22.22847975]


portfolio before change:  [-8.48043059]
curr_Stock_Price:  99.55358801028049
curr_Factors:  [99.55358801]
mat_Sqrt:  [[0.15]]
grads:  [-0.07892633]
Stock Position:  -0.07892632760894856
Bond Position:  [-0.62303149]


portfolio before change:  [-8.4542988]
curr_Stock_Price:  99.22200371123259
curr_Factors:  [99.22200371]
mat_Sqrt:  [[0.15]]
grads:  [0.04795427]
Stock Position:  0.04795426603184126
Bond Position:  [-13.21241717]


portfolio before change:  [-8.44032093]
curr_Stock_Price:  99.53070767007168
curr_Factors:  [99.53070767]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132946]
Stock Position:  -0.0013294613598051573
Bond Position:  [-8.3079987]


portfolio before change:  [-8.44123167]
curr_Stock_Price:  99.82516326272419
curr_Factors:  [99.82516326]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007122]
Stock Position:  -0.010071222573213735
Bond Position:  [-7.43587023]


portfolio before change:  [-8.44875682]
curr_Stock_Price:  100.5262098910799
curr_Factors:  [100.52620989]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898338]
Stock Position:  -0.028983378545809516
Bond Position:  [-5.53516763]


portfolio before change:  [-8.43156315]
curr_Stock_Price:  99.921048201309
curr_Factors:  [99.9210482]
mat_Sqrt:  [[0.15]]
grads:  [0.14914597]
Stock Position:  0.1491459662218166
Bond Position:  [-23.33438443]


portfolio before change:  [-8.45282828]
curr_Stock_Price:  99.78824753403379
curr_Factors:  [99.78824753]
mat_Sqrt:  [[0.15]]
grads:  [0.10288113]
Stock Position:  0.10288113325996737
Bond Position:  [-18.71915627]


portfolio before change:  [-8.47888188]
curr_Stock_Price:  99.54637986777888
curr_Factors:  [99.54637987]
mat_Sqrt:  [[0.15]]
grads:  [0.07172809]
Stock Position:  0.0717280934109204
Bond Position:  [-15.61915391]


portfolio before change:  [-8.46997827]
curr_Stock_Price:  99.6841200045532
curr_Factors:  [99.68412]
mat_Sqrt:  [[0.15]]
grads:  [0.02920639]
Stock Position:  0.02920638927208646
Bond Position:  [-11.38139148]


portfolio before change:  [-8.47062553]
curr_Stock_Price:  99.68631467169449
curr_Factors:  [99.68631467]
mat_Sqrt:  [[0.15]]
grads:  [0.04713674]
Stock Position:  0.04713673667872376
Bond Position:  [-13.1695131]


portfolio before change:  [-8.50343239]
curr_Stock_Price:  99.00778358094875
curr_Factors:  [99.00778358]
mat_Sqrt:  [[0.15]]
grads:  [-0.01362429]
Stock Position:  -0.013624292319578053
Bond Position:  [-7.15452141]


portfolio before change:  [-8.51101409]
curr_Stock_Price:  99.53144556521626
curr_Factors:  [99.53144557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348747]
Stock Position:  -0.03348747188250574
Bond Position:  [-5.1779576]


portfolio before change:  [-8.50138114]
curr_Stock_Price:  99.23412305870383
curr_Factors:  [99.23412306]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715819]
Stock Position:  -0.01715818656661271
Bond Position:  [-6.79870355]


portfolio before change:  [-8.50654507]
curr_Stock_Price:  99.51031746895592
curr_Factors:  [99.51031747]
mat_Sqrt:  [[0.15]]
grads:  [0.01216225]
Stock Position:  0.012162246275722315
Bond Position:  [-9.71681406]


portfolio before change:  [-8.51396033]
curr_Stock_Price:  98.95055731647511
curr_Factors:  [98.95055732]
mat_Sqrt:  [[0.15]]
grads:  [0.05422375]
Stock Position:  0.05422375482244111
Bond Position:  [-13.87943109]


portfolio before change:  [-8.59916272]
curr_Stock_Price:  97.39524446611445
curr_Factors:  [97.39524447]
mat_Sqrt:  [[0.15]]
grads:  [-0.06299209]
Stock Position:  -0.06299208954348082
Bond Position:  [-2.46403276]


portfolio before change:  [-8.64170248]
curr_Stock_Price:  98.06811868889679
curr_Factors:  [98.06811869]
mat_Sqrt:  [[0.15]]
grads:  [-0.03037153]
Stock Position:  -0.03037152923676466
Bond Position:  [-5.66322375]


portfolio before change:  [-8.64462786]
curr_Stock_Price:  98.15278388216979
curr_Factors:  [98.15278388]
mat_Sqrt:  [[0.15]]
grads:  [-0.00192671]
Stock Position:  -0.0019267108394885382
Bond Position:  [-8.45551583]


portfolio before change:  [-8.64613767]
curr_Stock_Price:  98.66211183135225
curr_Factors:  [98.66211183]
mat_Sqrt:  [[0.15]]
grads:  [0.06443088]
Stock Position:  0.06443088399595753
Bond Position:  [-15.00302475]


portfolio before change:  [-8.64989605]
curr_Stock_Price:  98.61833382058666
curr_Factors:  [98.61833382]
mat_Sqrt:  [[0.15]]
grads:  [0.05063041]
Stock Position:  0.05063040701934579
Bond Position:  [-13.64298243]


portfolio before change:  [-8.64936033]
curr_Stock_Price:  98.6457566285014
curr_Factors:  [98.64575663]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625565]
Stock Position:  -0.026255645692815684
Bond Position:  [-6.0593523]


portfolio before change:  [-8.65750165]
curr_Stock_Price:  98.94141103632792
curr_Factors:  [98.94141104]
mat_Sqrt:  [[0.15]]
grads:  [-0.01125785]
Stock Position:  -0.011257850523037656
Bond Position:  [-7.54363403]


portfolio before change:  [-8.65024014]
curr_Stock_Price:  98.25451243615377
curr_Factors:  [98.25451244]
mat_Sqrt:  [[0.15]]
grads:  [0.00348617]
Stock Position:  0.003486169246410068
Bond Position:  [-8.992772]


portfolio before change:  [-8.64910266]
curr_Stock_Price:  98.74202462757722
curr_Factors:  [98.74202463]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136622]
Stock Position:  -0.04136622442315176
Bond Position:  [-4.56451791]


portfolio before change:  [-8.65725898]
curr_Stock_Price:  98.93230143707751
curr_Factors:  [98.93230144]
mat_Sqrt:  [[0.15]]
grads:  [0.02850979]
Stock Position:  0.028509788694394758
Bond Position:  [-11.47779799]


portfolio before change:  [-8.6487283]
curr_Stock_Price:  99.2566834103853
curr_Factors:  [99.25668341]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-21.75648721]


portfolio before change:  [-8.70633513]
curr_Stock_Price:  98.83076077491712
curr_Factors:  [98.83076077]
mat_Sqrt:  [[0.15]]
grads:  [0.03313523]
Stock Position:  0.03313523424018544
Bond Position:  [-11.98111554]


portfolio before change:  [-8.69237089]
curr_Stock_Price:  99.27479228779053
curr_Factors:  [99.27479229]
mat_Sqrt:  [[0.15]]
grads:  [0.05524018]
Stock Position:  0.055240178334514146
Bond Position:  [-14.17632812]


portfolio before change:  [-8.62521961]
curr_Stock_Price:  100.50645613250494
curr_Factors:  [100.50645613]
mat_Sqrt:  [[0.15]]
grads:  [-0.00575017]
Stock Position:  -0.005750172737475634
Bond Position:  [-8.04729012]


portfolio before change:  [-8.626046]
curr_Stock_Price:  100.5627027900348
curr_Factors:  [100.56270279]
mat_Sqrt:  [[0.15]]
grads:  [0.01790113]
Stock Position:  0.017901134907041205
Bond Position:  [-10.42623251]


portfolio before change:  [-8.63024859]
curr_Stock_Price:  100.36433972131596
curr_Factors:  [100.36433972]
mat_Sqrt:  [[0.15]]
grads:  [0.14003753]
Stock Position:  0.14003753413854506
Bond Position:  [-22.68502324]


portfolio before change:  [-8.5935774]
curr_Stock_Price:  100.63633144610536
curr_Factors:  [100.63633145]
mat_Sqrt:  [[0.15]]
grads:  [0.00226254]
Stock Position:  0.0022625444301682673
Bond Position:  [-8.82127157]


portfolio before change:  [-8.59474962]
curr_Stock_Price:  100.36191819342405
curr_Factors:  [100.36191819]
mat_Sqrt:  [[0.15]]
grads:  [-0.10651873]
Stock Position:  -0.10651873158735235
Bond Position:  [2.09567461]


portfolio before change:  [-8.6545378]
curr_Stock_Price:  100.92444051636696
curr_Factors:  [100.92444052]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407706]
Stock Position:  -0.004077058380851199
Bond Position:  [-8.24306296]


portfolio before change:  [-8.65551053]
curr_Stock_Price:  101.03665948764586
curr_Factors:  [101.03665949]
mat_Sqrt:  [[0.15]]
grads:  [0.00918955]
Stock Position:  0.009189548144915037
Bond Position:  [-9.58399177]


portfolio before change:  [-8.64663813]
curr_Stock_Price:  102.06733167930079
curr_Factors:  [102.06733168]
mat_Sqrt:  [[0.15]]
grads:  [0.01208404]
Stock Position:  0.012084041113901064
Bond Position:  [-9.88002397]


portfolio before change:  [-8.63652468]
curr_Stock_Price:  102.95536013902583
curr_Factors:  [102.95536014]
mat_Sqrt:  [[0.15]]
grads:  [-0.10693392]
Stock Position:  -0.10693391971307228
Bond Position:  [2.37289553]


portfolio before change:  [-8.60713883]
curr_Stock_Price:  102.68194327031986
curr_Factors:  [102.68194327]
mat_Sqrt:  [[0.15]]
grads:  [-0.02509994]
Stock Position:  -0.02509993524251043
Bond Position:  [-6.02982871]


portfolio before change:  [-8.62886753]
curr_Stock_Price:  103.53261549078957
curr_Factors:  [103.53261549]
mat_Sqrt:  [[0.15]]
grads:  [0.07780172]
Stock Position:  0.07780171806582344
Bond Position:  [-16.68388289]


portfolio before change:  [-8.60241473]
curr_Stock_Price:  103.88602124718346
curr_Factors:  [103.88602125]
mat_Sqrt:  [[0.15]]
grads:  [-0.03528332]
Stock Position:  -0.03528331954138229
Bond Position:  [-4.93697104]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.61981785]
Stock Price:  104.37051510549469
PL:  [-12.99033296]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.22273444e-02]
 [-2.02272121e-02]
 [ 2.73545257e-02]
 [-9.91000423e-03]
 [ 1.34493375e-02]
 [-1.33195279e-02]
 [ 6.37683120e-04]
 [-5.98622181e-04]
 [ 1.26537783e-03]
 [-3.39439843e-03]
 [-8.32834061e-03]
 [ 1.42589862e-02]
 [-4.10410991e-03]
 [ 8.01167202e-03]
 [-1.25394967e-03]
 [ 1.31397609e-02]
 [ 3.66147325e-02]
 [-1.47322814e-02]
 [ 1.76648454e-02]
 [ 1.98610291e-03]
 [-3.84693346e-03]
 [ 4.19394214e-03]
 [ 1.49808952e-02]
 [ 1.73472823e-02]
 [-5.65499016e-03]
 [ 4.85035030e-03]
 [ 1.32159532e-03]
 [ 5.92118735e-03]
 [ 2.06003472e-02]
 [ 6.04199135e-04]
 [-7.69904511e-03]
 [ 9.86494618e-03]
 [ 1.22044258e-02]
 [ 4.70053673e-03]
 [ 5.30923468e-03]
 [ 1.23704584e-02]
 [-1.97434671e-02]
 [ 3.20061261e-03]
 [-5.46229248e-02]
 [ 6.67270577e-03]
 [ 7.04053218e-03]
 [ 6.40847403e-03]
 [-2.57791944e-03]
 [ 2.17785210e-03]
 [-1.42953948e-02]
 [ 1.90810940e-02]
 [ 9.85189409e-03]
 [ 5.32918430e-03]
 [-8.09642609e-03]
 [-8.94466435e-05]
 [-3.57380822e-03]
 [-1.09010838e-03]
 [ 2.70699682e-04]
 [ 8.12289368e-03]
 [-1.05253766e-02]
 [-4.98636167e-03]
 [-1.34117091e-03]
 [ 1.20317830e-02]
 [ 7.99716872e-03]
 [-3.07321867e-03]
 [-5.13547995e-03]
 [-1.28278545e-03]
 [-4.19335905e-03]
 [-9.29974355e-04]
 [ 1.95514282e-02]
 [ 4.03389038e-03]
 [ 1.48763576e-02]
 [-9.33335058e-04]
 [ 3.04068436e-03]
 [ 2.32578089e-02]
 [ 3.62546230e-03]
 [-1.54314197e-02]
 [-5.87347154e-03]
 [ 2.41319543e-03]
 [ 1.11663753e-02]
 [ 7.02280624e-03]
 [ 1.24776897e-04]
 [-1.53637128e-02]
 [-2.75059786e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.21189125]
curr_Stock_Price:  99.21691265132712
curr_Factors:  [99.21691265]
mat_Sqrt:  [[0.15]]
grads:  [-0.08151563]
Stock Position:  -0.08151562913933708
Bond Position:  [-7.12416219]


portfolio before change:  [-15.18411312]
curr_Stock_Price:  98.8706796569244
curr_Factors:  [98.87067966]
mat_Sqrt:  [[0.15]]
grads:  [-0.13484808]
Stock Position:  -0.13484808048169378
Bond Position:  [-1.85159175]


portfolio before change:  [-15.21132493]
curr_Stock_Price:  99.07161747838492
curr_Factors:  [99.07161748]
mat_Sqrt:  [[0.15]]
grads:  [0.1823635]
Stock Position:  0.1823635047267452
Bond Position:  [-33.27837231]


portfolio before change:  [-15.18702907]
curr_Stock_Price:  99.21625071965931
curr_Factors:  [99.21625072]
mat_Sqrt:  [[0.15]]
grads:  [-0.06606669]
Stock Position:  -0.06606669486629413
Bond Position:  [-8.6321393]


portfolio before change:  [-15.19964203]
curr_Stock_Price:  99.39899688908145
curr_Factors:  [99.39899689]
mat_Sqrt:  [[0.15]]
grads:  [0.08966225]
Stock Position:  0.08966224985446174
Bond Position:  [-24.11197972]


portfolio before change:  [-15.20899685]
curr_Stock_Price:  99.31147091520019
curr_Factors:  [99.31147092]
mat_Sqrt:  [[0.15]]
grads:  [-0.08879685]
Stock Position:  -0.0887968523580107
Bond Position:  [-6.39045083]


portfolio before change:  [-15.23257298]
curr_Stock_Price:  99.57247927599464
curr_Factors:  [99.57247928]
mat_Sqrt:  [[0.15]]
grads:  [0.00425122]
Stock Position:  0.0042512208002245975
Bond Position:  [-15.65587758]


portfolio before change:  [-15.23359163]
curr_Stock_Price:  99.56304239875875
curr_Factors:  [99.5630424]
mat_Sqrt:  [[0.15]]
grads:  [-0.00399081]
Stock Position:  -0.003990814541251937
Bond Position:  [-14.83625399]


portfolio before change:  [-15.23780524]
curr_Stock_Price:  100.38651279312316
curr_Factors:  [100.38651279]
mat_Sqrt:  [[0.15]]
grads:  [0.00843585]
Stock Position:  0.008435852181780576
Bond Position:  [-16.08465102]


portfolio before change:  [-15.23056309]
curr_Stock_Price:  101.36418162575029
curr_Factors:  [101.36418163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02262932]
Stock Position:  -0.022629322865104773
Bond Position:  [-12.9367603]


portfolio before change:  [-15.22780097]
curr_Stock_Price:  101.20639107080684
curr_Factors:  [101.20639107]
mat_Sqrt:  [[0.15]]
grads:  [-0.05552227]
Stock Position:  -0.05552227072777209
Bond Position:  [-9.60859233]


portfolio before change:  [-15.24863239]
curr_Stock_Price:  101.57076492945806
curr_Factors:  [101.57076493]
mat_Sqrt:  [[0.15]]
grads:  [0.09505991]
Stock Position:  0.09505990808976661
Bond Position:  [-24.90393997]


portfolio before change:  [-15.20457265]
curr_Stock_Price:  102.0506337336111
curr_Factors:  [102.05063373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02736073]
Stock Position:  -0.027360732754424234
Bond Position:  [-12.41239253]


portfolio before change:  [-15.16129293]
curr_Stock_Price:  100.4404605619474
curr_Factors:  [100.44046056]
mat_Sqrt:  [[0.15]]
grads:  [0.05341115]
Stock Position:  0.053411146810805415
Bond Position:  [-20.52593312]


portfolio before change:  [-15.18082655]
curr_Stock_Price:  100.09875830742473
curr_Factors:  [100.09875831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00835966]
Stock Position:  -0.008359664499870644
Bond Position:  [-14.34403451]


portfolio before change:  [-15.18103741]
curr_Stock_Price:  100.01673700009341
curr_Factors:  [100.016737]
mat_Sqrt:  [[0.15]]
grads:  [0.08759841]
Stock Position:  0.08759840614594296
Bond Position:  [-23.94234416]


portfolio before change:  [-15.16180478]
curr_Stock_Price:  100.25337457287085
curr_Factors:  [100.25337457]
mat_Sqrt:  [[0.15]]
grads:  [0.24409822]
Stock Position:  0.24409821671067108
Bond Position:  [-39.63347473]


portfolio before change:  [-15.08654715]
curr_Stock_Price:  100.57183163549176
curr_Factors:  [100.57183164]
mat_Sqrt:  [[0.15]]
grads:  [-0.09821521]
Stock Position:  -0.09821520955821998
Bond Position:  [-5.20886363]


portfolio before change:  [-15.13731108]
curr_Stock_Price:  101.08538104477503
curr_Factors:  [101.08538104]
mat_Sqrt:  [[0.15]]
grads:  [0.11776564]
Stock Position:  0.11776563591995036
Bond Position:  [-27.04169526]


portfolio before change:  [-15.16709278]
curr_Stock_Price:  100.84684331442772
curr_Factors:  [100.84684331]
mat_Sqrt:  [[0.15]]
grads:  [0.01324069]
Stock Position:  0.013240686084719778
Bond Position:  [-16.50237418]


portfolio before change:  [-15.18181084]
curr_Stock_Price:  99.81316395645246
curr_Factors:  [99.81316396]
mat_Sqrt:  [[0.15]]
grads:  [-0.02564622]
Stock Position:  -0.025646223051268194
Bond Position:  [-12.62198017]


portfolio before change:  [-15.20085388]
curr_Stock_Price:  100.52493133459157
curr_Factors:  [100.52493133]
mat_Sqrt:  [[0.15]]
grads:  [0.02795961]
Stock Position:  0.027959614294499835
Bond Position:  [-18.01149219]


portfolio before change:  [-15.21043964]
curr_Stock_Price:  100.2223519672075
curr_Factors:  [100.22235197]
mat_Sqrt:  [[0.15]]
grads:  [0.09987263]
Stock Position:  0.09987263484654998
Bond Position:  [-25.21991]


portfolio before change:  [-15.23286505]
curr_Stock_Price:  100.01359487960062
curr_Factors:  [100.01359488]
mat_Sqrt:  [[0.15]]
grads:  [0.11564855]
Stock Position:  0.11564854882405158
Bond Position:  [-26.79929216]


portfolio before change:  [-15.2606305]
curr_Stock_Price:  99.78799376476489
curr_Factors:  [99.78799376]
mat_Sqrt:  [[0.15]]
grads:  [-0.03769993]
Stock Position:  -0.037699934379498645
Bond Position:  [-11.49862968]


portfolio before change:  [-15.27738361]
curr_Stock_Price:  100.2133107726589
curr_Factors:  [100.21331077]
mat_Sqrt:  [[0.15]]
grads:  [0.03233567]
Stock Position:  0.03233566864360038
Bond Position:  [-18.51784802]


portfolio before change:  [-15.28253103]
curr_Stock_Price:  100.08991703019791
curr_Factors:  [100.08991703]
mat_Sqrt:  [[0.15]]
grads:  [0.00881064]
Stock Position:  0.008810635482421881
Bond Position:  [-16.1643868]


portfolio before change:  [-15.28221153]
curr_Stock_Price:  100.24084864619813
curr_Factors:  [100.24084865]
mat_Sqrt:  [[0.15]]
grads:  [0.03947458]
Stock Position:  0.03947458232685205
Bond Position:  [-19.23917716]


portfolio before change:  [-15.30036321]
curr_Stock_Price:  99.81147900025975
curr_Factors:  [99.811479]
mat_Sqrt:  [[0.15]]
grads:  [0.13733565]
Stock Position:  0.13733564827028086
Bond Position:  [-29.00803738]


portfolio before change:  [-15.29270714]
curr_Stock_Price:  99.88042778588824
curr_Factors:  [99.88042779]
mat_Sqrt:  [[0.15]]
grads:  [0.00402799]
Stock Position:  0.004027994230082349
Bond Position:  [-15.69502493]


portfolio before change:  [-15.29328441]
curr_Stock_Price:  99.98065034326194
curr_Factors:  [99.98065034]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132697]
Stock Position:  -0.05132696739384319
Bond Position:  [-10.16158083]


portfolio before change:  [-15.27840135]
curr_Stock_Price:  99.67831068791749
curr_Factors:  [99.67831069]
mat_Sqrt:  [[0.15]]
grads:  [0.06576631]
Stock Position:  0.06576630789676145
Bond Position:  [-21.83387582]


portfolio before change:  [-15.25416474]
curr_Stock_Price:  100.06758707889387
curr_Factors:  [100.06758708]
mat_Sqrt:  [[0.15]]
grads:  [0.08136284]
Stock Position:  0.08136283892745738
Bond Position:  [-23.39594771]


portfolio before change:  [-15.22152787]
curr_Stock_Price:  100.48668708178194
curr_Factors:  [100.48668708]
mat_Sqrt:  [[0.15]]
grads:  [0.03133691]
Stock Position:  0.03133691154581636
Bond Position:  [-18.37047029]


portfolio before change:  [-15.21220516]
curr_Stock_Price:  100.82082659244814
curr_Factors:  [100.82082659]
mat_Sqrt:  [[0.15]]
grads:  [0.0353949]
Stock Position:  0.03539489785622823
Bond Position:  [-18.78074802]


portfolio before change:  [-15.23255695]
curr_Stock_Price:  100.27899834873206
curr_Factors:  [100.27899835]
mat_Sqrt:  [[0.15]]
grads:  [0.08246972]
Stock Position:  0.08246972247071563
Bond Position:  [-23.50253811]


portfolio before change:  [-15.24126398]
curr_Stock_Price:  100.19123182261562
curr_Factors:  [100.19123182]
mat_Sqrt:  [[0.15]]
grads:  [-0.13162311]
Stock Position:  -0.13162311381391925
Bond Position:  [-2.05378207]


portfolio before change:  [-15.16972696]
curr_Stock_Price:  99.64675761614677
curr_Factors:  [99.64675762]
mat_Sqrt:  [[0.15]]
grads:  [0.02133742]
Stock Position:  0.021337417407936553
Bond Position:  [-17.29593142]


portfolio before change:  [-15.15171571]
curr_Stock_Price:  100.5415368826523
curr_Factors:  [100.54153688]
mat_Sqrt:  [[0.15]]
grads:  [-0.36415283]
Stock Position:  -0.36415283195807624
Bond Position:  [21.46076968]


portfolio before change:  [-15.03361597]
curr_Stock_Price:  100.22090667828884
curr_Factors:  [100.22090668]
mat_Sqrt:  [[0.15]]
grads:  [0.04448471]
Stock Position:  0.04448470510106137
Bond Position:  [-19.49191345]


portfolio before change:  [-15.04264019]
curr_Stock_Price:  100.0454321402363
curr_Factors:  [100.04543214]
mat_Sqrt:  [[0.15]]
grads:  [0.04693688]
Stock Position:  0.046936881189219674
Bond Position:  [-19.73846075]


portfolio before change:  [-15.08238706]
curr_Stock_Price:  99.22490084893722
curr_Factors:  [99.22490085]
mat_Sqrt:  [[0.15]]
grads:  [0.04272316]
Stock Position:  0.0427231601745078
Bond Position:  [-19.32158839]


portfolio before change:  [-15.1139552]
curr_Stock_Price:  98.51426751511075
curr_Factors:  [98.51426752]
mat_Sqrt:  [[0.15]]
grads:  [-0.01718613]
Stock Position:  -0.017186129617027066
Bond Position:  [-13.42087623]


portfolio before change:  [-15.10746607]
curr_Stock_Price:  98.08787943562207
curr_Factors:  [98.08787944]
mat_Sqrt:  [[0.15]]
grads:  [0.01451901]
Stock Position:  0.014519014022487288
Bond Position:  [-16.53160537]


portfolio before change:  [-15.11628843]
curr_Stock_Price:  97.55140341622625
curr_Factors:  [97.55140342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09530263]
Stock Position:  -0.0953026320012982
Bond Position:  [-5.81938293]


portfolio before change:  [-15.05707369]
curr_Stock_Price:  96.92625318472433
curr_Factors:  [96.92625318]
mat_Sqrt:  [[0.15]]
grads:  [0.12720729]
Stock Position:  0.12720729355117683
Bond Position:  [-27.38680003]


portfolio before change:  [-15.04430953]
curr_Stock_Price:  97.04005081270554
curr_Factors:  [97.04005081]
mat_Sqrt:  [[0.15]]
grads:  [0.06567929]
Stock Position:  0.06567929391156417
Bond Position:  [-21.41783155]


portfolio before change:  [-15.07680425]
curr_Stock_Price:  96.56568422196446
curr_Factors:  [96.56568422]
mat_Sqrt:  [[0.15]]
grads:  [0.0355279]
Stock Position:  0.03552789536134172
Bond Position:  [-18.50757977]


portfolio before change:  [-15.08099403]
curr_Stock_Price:  96.48031398814888
curr_Factors:  [96.48031399]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397617]
Stock Position:  -0.05397617392234601
Bond Position:  [-9.87335583]


portfolio before change:  [-15.06137401]
curr_Stock_Price:  96.10538690644299
curr_Factors:  [96.10538691]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059631]
Stock Position:  -0.0005963109568887973
Bond Position:  [-15.00406531]


portfolio before change:  [-15.06248579]
curr_Stock_Price:  96.39717541580092
curr_Factors:  [96.39717542]
mat_Sqrt:  [[0.15]]
grads:  [-0.02382539]
Stock Position:  -0.023825388109368167
Bond Position:  [-12.76578567]


portfolio before change:  [-15.06321955]
curr_Stock_Price:  96.39448407431351
curr_Factors:  [96.39448407]
mat_Sqrt:  [[0.15]]
grads:  [-0.00726739]
Stock Position:  -0.007267389179084217
Bond Position:  [-14.36268332]


portfolio before change:  [-15.06538447]
curr_Stock_Price:  96.56885536471269
curr_Factors:  [96.56885536]
mat_Sqrt:  [[0.15]]
grads:  [0.00180466]
Stock Position:  0.0018046645470852873
Bond Position:  [-15.23965886]


portfolio before change:  [-15.06645378]
curr_Stock_Price:  96.50413232096543
curr_Factors:  [96.50413232]
mat_Sqrt:  [[0.15]]
grads:  [0.05415262]
Stock Position:  0.05415262455180608
Bond Position:  [-20.29240583]


portfolio before change:  [-15.0639136]
curr_Stock_Price:  96.57446123509746
curr_Factors:  [96.57446124]
mat_Sqrt:  [[0.15]]
grads:  [-0.07016918]
Stock Position:  -0.07016917715460191
Bond Position:  [-8.28736312]


portfolio before change:  [-15.03332716]
curr_Stock_Price:  96.13118372647787
curr_Factors:  [96.13118373]
mat_Sqrt:  [[0.15]]
grads:  [-0.03324241]
Stock Position:  -0.0332424111120531
Bond Position:  [-11.83769483]


portfolio before change:  [-15.0521624]
curr_Stock_Price:  96.67552938291996
curr_Factors:  [96.67552938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00894114]
Stock Position:  -0.008941139391215236
Bond Position:  [-14.18777302]


portfolio before change:  [-15.06215818]
curr_Stock_Price:  97.69430501460873
curr_Factors:  [97.69430501]
mat_Sqrt:  [[0.15]]
grads:  [0.08021189]
Stock Position:  0.08021188675109936
Bond Position:  [-22.89840271]


portfolio before change:  [-15.11410257]
curr_Stock_Price:  97.06455806656194
curr_Factors:  [97.06455807]
mat_Sqrt:  [[0.15]]
grads:  [0.05331446]
Stock Position:  0.05331445815754245
Bond Position:  [-20.28904689]


portfolio before change:  [-15.1490159]
curr_Stock_Price:  96.43348665225264
curr_Factors:  [96.43348665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048812]
Stock Position:  -0.02048812443895537
Bond Position:  [-13.17327463]


portfolio before change:  [-15.14962617]
curr_Stock_Price:  96.42308589045426
curr_Factors:  [96.42308589]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423653]
Stock Position:  -0.03423653302531392
Bond Position:  [-11.848434]


portfolio before change:  [-15.16277357]
curr_Stock_Price:  96.78547214376087
curr_Factors:  [96.78547214]
mat_Sqrt:  [[0.15]]
grads:  [-0.0085519]
Stock Position:  -0.008551903020909135
Bond Position:  [-14.33507359]


portfolio before change:  [-15.16640529]
curr_Stock_Price:  97.10537166350701
curr_Factors:  [97.10537166]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795573]
Stock Position:  -0.027955726989100812
Bond Position:  [-12.45175403]


portfolio before change:  [-15.17697576]
curr_Stock_Price:  97.45564734041605
curr_Factors:  [97.45564734]
mat_Sqrt:  [[0.15]]
grads:  [-0.00619983]
Stock Position:  -0.006199829036059956
Bond Position:  [-14.5727674]


portfolio before change:  [-15.17991725]
curr_Stock_Price:  97.7831835225238
curr_Factors:  [97.78318352]
mat_Sqrt:  [[0.15]]
grads:  [0.13034285]
Stock Position:  0.13034285464427237
Bond Position:  [-27.92525653]


portfolio before change:  [-15.2279583]
curr_Stock_Price:  97.42799974076047
curr_Factors:  [97.42799974]
mat_Sqrt:  [[0.15]]
grads:  [0.0268926]
Stock Position:  0.026892602527377765
Bond Position:  [-17.84805077]


portfolio before change:  [-15.24132231]
curr_Stock_Price:  96.97254098854867
curr_Factors:  [96.97254099]
mat_Sqrt:  [[0.15]]
grads:  [0.09917572]
Stock Position:  0.0991757172737158
Bond Position:  [-24.85864362]


portfolio before change:  [-15.1713169]
curr_Stock_Price:  97.69407970292498
curr_Factors:  [97.6940797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622223]
Stock Position:  -0.006222233721560024
Bond Position:  [-14.56344151]


portfolio before change:  [-15.17288506]
curr_Stock_Price:  97.79981573626736
curr_Factors:  [97.79981574]
mat_Sqrt:  [[0.15]]
grads:  [0.02027123]
Stock Position:  0.020271229045756303
Bond Position:  [-17.15540753]


portfolio before change:  [-15.18487059]
curr_Stock_Price:  97.26145276438432
curr_Factors:  [97.26145276]
mat_Sqrt:  [[0.15]]
grads:  [0.15505206]
Stock Position:  0.1550520596655197
Bond Position:  [-30.26545917]


portfolio before change:  [-15.13335623]
curr_Stock_Price:  97.60589196105109
curr_Factors:  [97.60589196]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [-17.49246611]


portfolio before change:  [-15.15818046]
curr_Stock_Price:  96.62404813875521
curr_Factors:  [96.62404814]
mat_Sqrt:  [[0.15]]
grads:  [-0.10287613]
Stock Position:  -0.10287613101304723
Bond Position:  [-5.21787223]


portfolio before change:  [-15.10992784]
curr_Stock_Price:  96.15184185892876
curr_Factors:  [96.15184186]
mat_Sqrt:  [[0.15]]
grads:  [-0.03915648]
Stock Position:  -0.03915647694403374
Bond Position:  [-11.34496046]


portfolio before change:  [-15.0859069]
curr_Stock_Price:  95.52027289744612
curr_Factors:  [95.5202729]
mat_Sqrt:  [[0.15]]
grads:  [0.01608797]
Stock Position:  0.01608796951835934
Bond Position:  [-16.62263414]


portfolio before change:  [-15.08973427]
curr_Stock_Price:  95.3469498405534
curr_Factors:  [95.34694984]
mat_Sqrt:  [[0.15]]
grads:  [0.0744425]
Stock Position:  0.07444250215642562
Bond Position:  [-22.18759978]


portfolio before change:  [-15.09628957]
curr_Stock_Price:  95.27751998012849
curr_Factors:  [95.27751998]
mat_Sqrt:  [[0.15]]
grads:  [0.04681871]
Stock Position:  0.04681870823739085
Bond Position:  [-19.55705998]


portfolio before change:  [-15.09502257]
curr_Stock_Price:  95.33068989564754
curr_Factors:  [95.3306899]
mat_Sqrt:  [[0.15]]
grads:  [0.00083185]
Stock Position:  0.0008318459786748588
Bond Position:  [-15.17432302]


portfolio before change:  [-15.09546826]
curr_Stock_Price:  95.93505285413018
curr_Factors:  [95.93505285]
mat_Sqrt:  [[0.15]]
grads:  [-0.10242475]
Stock Position:  -0.10242475229793684
Bond Position:  [-5.26934424]


portfolio before change:  [-15.09696674]
curr_Stock_Price:  95.94646738981204
curr_Factors:  [95.94646739]
mat_Sqrt:  [[0.15]]
grads:  [-0.18337319]
Stock Position:  -0.18337319098157304
Bond Position:  [2.49704315]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.10139478]
Stock Price:  95.97146621868052
PL:  [-15.10139478]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.90697290e-03]
 [ 2.27262673e-02]
 [ 3.31284250e-03]
 [-1.09713551e-02]
 [ 1.22817607e-02]
 [-1.16733647e-02]
 [ 2.67870424e-04]
 [-2.47851703e-02]
 [ 1.00679386e-02]
 [ 1.66446314e-03]
 [-8.63274853e-03]
 [ 1.47526669e-02]
 [-2.72840039e-03]
 [ 6.07788816e-03]
 [ 2.61358916e-04]
 [ 1.31986363e-02]
 [ 2.56285664e-02]
 [-1.50281098e-02]
 [ 2.24545075e-02]
 [ 1.62825117e-03]
 [-4.15906671e-03]
 [ 4.93701096e-03]
 [ 1.87844389e-02]
 [ 1.87387591e-02]
 [-4.00450928e-03]
 [ 4.68904733e-03]
 [ 8.26611759e-03]
 [ 8.38791854e-03]
 [ 1.58251850e-02]
 [ 3.24714551e-02]
 [-6.69933532e-03]
 [ 1.92583639e-02]
 [ 1.19534211e-02]
 [-2.03146753e-02]
 [-1.08893990e-02]
 [-3.19428882e-03]
 [ 9.34106575e-03]
 [-3.68578439e-03]
 [ 1.64983917e-02]
 [-6.71755659e-03]
 [ 7.07958861e-03]
 [ 3.31077546e-02]
 [-2.88651889e-03]
 [ 1.10685682e-03]
 [ 1.40369810e-02]
 [ 1.51495795e-02]
 [ 1.07270235e-02]
 [ 3.90034854e-03]
 [ 1.00324210e-02]
 [-2.28431772e-03]
 [-6.89360201e-03]
 [-2.19102982e-03]
 [ 1.76418401e-03]
 [ 6.33399733e-03]
 [-4.32820722e-03]
 [-3.81452022e-03]
 [ 8.89922137e-03]
 [ 8.29453897e-04]
 [ 7.13258003e-03]
 [-3.97247801e-03]
 [-3.41965604e-03]
 [-3.01553557e-04]
 [-4.62799897e-03]
 [ 1.78012683e-04]
 [ 1.90645766e-02]
 [ 3.79880722e-03]
 [ 1.11143281e-02]
 [-5.88282345e-04]
 [ 2.97803319e-03]
 [ 2.31030659e-02]
 [ 3.27311333e-03]
 [-1.54757433e-02]
 [-5.34720397e-03]
 [ 1.84750756e-03]
 [ 9.73051851e-03]
 [ 2.04094864e-03]
 [-1.60814791e-03]
 [-1.06901866e-02]
 [-2.56533978e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.91707321]
curr_Stock_Price:  101.17574183334577
curr_Factors:  [101.17574183]
mat_Sqrt:  [[0.15]]
grads:  [-0.05271315]
Stock Position:  -0.05271315265843721
Bond Position:  [33.25036554]


portfolio before change:  [27.95628663]
curr_Stock_Price:  100.4712647929233
curr_Factors:  [100.47126479]
mat_Sqrt:  [[0.15]]
grads:  [0.15150845]
Stock Position:  0.15150844858062926
Bond Position:  [12.73404117]


portfolio before change:  [27.8985421]
curr_Stock_Price:  100.08488088164239
curr_Factors:  [100.08488088]
mat_Sqrt:  [[0.15]]
grads:  [0.02208562]
Stock Position:  0.02208561666642894
Bond Position:  [25.68810579]


portfolio before change:  [27.90812567]
curr_Stock_Price:  100.4461120118704
curr_Factors:  [100.44611201]
mat_Sqrt:  [[0.15]]
grads:  [-0.07314237]
Stock Position:  -0.07314236742790838
Bond Position:  [35.25499211]


portfolio before change:  [27.95156757]
curr_Stock_Price:  99.88230209663693
curr_Factors:  [99.8823021]
mat_Sqrt:  [[0.15]]
grads:  [0.0818784]
Stock Position:  0.08187840496632194
Bond Position:  [19.77336399]


portfolio before change:  [27.91947072]
curr_Stock_Price:  99.47520177182544
curr_Factors:  [99.47520177]
mat_Sqrt:  [[0.15]]
grads:  [-0.07782243]
Stock Position:  -0.0778224310038435
Bond Position:  [35.66087275]


portfolio before change:  [27.86263313]
curr_Stock_Price:  100.23419204590728
curr_Factors:  [100.23419205]
mat_Sqrt:  [[0.15]]
grads:  [0.0017858]
Stock Position:  0.0017858028257045657
Bond Position:  [27.68363462]


portfolio before change:  [27.86534873]
curr_Stock_Price:  100.78594331023373
curr_Factors:  [100.78594331]
mat_Sqrt:  [[0.15]]
grads:  [-0.16523447]
Stock Position:  -0.16523446868975233
Bond Position:  [44.51866052]


portfolio before change:  [27.82251305]
curr_Stock_Price:  101.0620247861538
curr_Factors:  [101.06202479]
mat_Sqrt:  [[0.15]]
grads:  [0.06711959]
Stock Position:  0.06711959035626193
Bond Position:  [21.03927135]


portfolio before change:  [27.79771674]
curr_Stock_Price:  100.67299808674272
curr_Factors:  [100.67299809]
mat_Sqrt:  [[0.15]]
grads:  [0.01109642]
Stock Position:  0.011096420914614737
Bond Position:  [26.68060677]


portfolio before change:  [27.80602877]
curr_Stock_Price:  101.27179009909717
curr_Factors:  [101.2717901]
mat_Sqrt:  [[0.15]]
grads:  [-0.05755166]
Stock Position:  -0.05755165684320369
Bond Position:  [33.63438809]


portfolio before change:  [27.78799104]
curr_Stock_Price:  101.62173563660264
curr_Factors:  [101.62173564]
mat_Sqrt:  [[0.15]]
grads:  [0.09835111]
Stock Position:  0.09835111235879575
Bond Position:  [17.7933803]


portfolio before change:  [27.68163647]
curr_Stock_Price:  100.52905159757368
curr_Factors:  [100.5290516]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818934]
Stock Position:  -0.018189335901214524
Bond Position:  [29.51019316]


portfolio before change:  [27.67636781]
curr_Stock_Price:  100.92011112300847
curr_Factors:  [100.92011112]
mat_Sqrt:  [[0.15]]
grads:  [0.04051925]
Stock Position:  0.04051925439680281
Bond Position:  [23.58716015]


portfolio before change:  [27.63087243]
curr_Stock_Price:  99.76091863930816
curr_Factors:  [99.76091864]
mat_Sqrt:  [[0.15]]
grads:  [0.00174239]
Stock Position:  0.001742392774468996
Bond Position:  [27.45704973]


portfolio before change:  [27.63307855]
curr_Stock_Price:  100.04213915976908
curr_Factors:  [100.04213916]
mat_Sqrt:  [[0.15]]
grads:  [0.08799091]
Stock Position:  0.08799090865164406
Bond Position:  [18.83027982]


portfolio before change:  [27.58644233]
curr_Stock_Price:  99.49875175656344
curr_Factors:  [99.49875176]
mat_Sqrt:  [[0.15]]
grads:  [0.17085711]
Stock Position:  0.1708571091158987
Bond Position:  [10.58637324]


portfolio before change:  [27.62164637]
curr_Stock_Price:  99.70092286819035
curr_Factors:  [99.70092287]
mat_Sqrt:  [[0.15]]
grads:  [-0.1001874]
Stock Position:  -0.10018739882431633
Bond Position:  [37.61042249]


portfolio before change:  [27.67295506]
curr_Stock_Price:  99.21225900156767
curr_Factors:  [99.212259]
mat_Sqrt:  [[0.15]]
grads:  [0.14969672]
Stock Position:  0.14969671654975936
Bond Position:  [12.82120564]


portfolio before change:  [27.68806834]
curr_Stock_Price:  99.30786523320204
curr_Factors:  [99.30786523]
mat_Sqrt:  [[0.15]]
grads:  [0.01085501]
Stock Position:  0.010855007789837594
Bond Position:  [26.61008069]


portfolio before change:  [27.6981151]
curr_Stock_Price:  100.08018859315736
curr_Factors:  [100.08018859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02772711]
Stock Position:  -0.027727111371854473
Bond Position:  [30.47304964]


portfolio before change:  [27.72008257]
curr_Stock_Price:  99.35660660132362
curr_Factors:  [99.3566066]
mat_Sqrt:  [[0.15]]
grads:  [0.03291341]
Stock Position:  0.03291340643016891
Bond Position:  [24.44991819]


portfolio before change:  [27.71542431]
curr_Stock_Price:  99.16864593745414
curr_Factors:  [99.16864594]
mat_Sqrt:  [[0.15]]
grads:  [0.12522959]
Stock Position:  0.12522959277979442
Bond Position:  [15.29657516]


portfolio before change:  [27.64904232]
curr_Stock_Price:  98.6309291538615
curr_Factors:  [98.63092915]
mat_Sqrt:  [[0.15]]
grads:  [0.12492506]
Stock Position:  0.12492506043895185
Bond Position:  [15.32756753]


portfolio before change:  [27.61668656]
curr_Stock_Price:  98.364259187586
curr_Factors:  [98.36425919]
mat_Sqrt:  [[0.15]]
grads:  [-0.02669673]
Stock Position:  -0.026696728558938405
Bond Position:  [30.24269049]


portfolio before change:  [27.6108888]
curr_Stock_Price:  98.65223425742387
curr_Factors:  [98.65223426]
mat_Sqrt:  [[0.15]]
grads:  [0.03126032]
Stock Position:  0.031260315562198805
Bond Position:  [24.52698882]


portfolio before change:  [27.60461106]
curr_Stock_Price:  98.40237355431286
curr_Factors:  [98.40237355]
mat_Sqrt:  [[0.15]]
grads:  [0.05510745]
Stock Position:  0.0551074505763399
Bond Position:  [22.18190712]


portfolio before change:  [27.62313528]
curr_Stock_Price:  98.71336248342429
curr_Factors:  [98.71336248]
mat_Sqrt:  [[0.15]]
grads:  [0.05591946]
Stock Position:  0.05591945691428276
Bond Position:  [22.10313766]


portfolio before change:  [27.6046997]
curr_Stock_Price:  98.35897660010062
curr_Factors:  [98.3589766]
mat_Sqrt:  [[0.15]]
grads:  [0.10550123]
Stock Position:  0.1055012332650449
Bond Position:  [17.22770637]


portfolio before change:  [27.49150652]
curr_Stock_Price:  97.2758617875966
curr_Factors:  [97.27586179]
mat_Sqrt:  [[0.15]]
grads:  [0.21647637]
Stock Position:  0.21647636706213513
Bond Position:  [6.43358135]


portfolio before change:  [27.58702969]
curr_Stock_Price:  97.71526802857913
curr_Factors:  [97.71526803]
mat_Sqrt:  [[0.15]]
grads:  [-0.04466224]
Stock Position:  -0.04466223549160743
Bond Position:  [31.95121201]


portfolio before change:  [27.62009299]
curr_Stock_Price:  97.01968518001996
curr_Factors:  [97.01968518]
mat_Sqrt:  [[0.15]]
grads:  [0.12838909]
Stock Position:  0.12838909246803845
Bond Position:  [15.16382366]


portfolio before change:  [27.64148901]
curr_Stock_Price:  97.17895299278003
curr_Factors:  [97.17895299]
mat_Sqrt:  [[0.15]]
grads:  [0.07968947]
Stock Position:  0.07968947387103364
Bond Position:  [19.89734938]


portfolio before change:  [27.67344459]
curr_Stock_Price:  97.56434839871477
curr_Factors:  [97.5643484]
mat_Sqrt:  [[0.15]]
grads:  [-0.13543117]
Stock Position:  -0.1354311685171289
Bond Position:  [40.8866983]


portfolio before change:  [27.77767608]
curr_Stock_Price:  96.81359068699713
curr_Factors:  [96.81359069]
mat_Sqrt:  [[0.15]]
grads:  [-0.07259599]
Stock Position:  -0.07259599322320706
Bond Position:  [34.80595486]


portfolio before change:  [27.77757674]
curr_Stock_Price:  96.84492551336547
curr_Factors:  [96.84492551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02129526]
Stock Position:  -0.021295258780047663
Bond Position:  [29.83991449]


portfolio before change:  [27.78743998]
curr_Stock_Price:  96.46934018019286
curr_Factors:  [96.46934018]
mat_Sqrt:  [[0.15]]
grads:  [0.06227377]
Stock Position:  0.06227377163890542
Bond Position:  [21.77993032]


portfolio before change:  [27.75387728]
curr_Stock_Price:  95.90852638366073
curr_Factors:  [95.90852638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0245719]
Stock Position:  -0.024571895907976798
Bond Position:  [30.11053161]


portfolio before change:  [27.74955822]
curr_Stock_Price:  96.1608891239075
curr_Factors:  [96.16088912]
mat_Sqrt:  [[0.15]]
grads:  [0.10998928]
Stock Position:  0.10998927816031559
Bond Position:  [17.17289143]


portfolio before change:  [27.79320371]
curr_Stock_Price:  96.54794644654052
curr_Factors:  [96.54794645]
mat_Sqrt:  [[0.15]]
grads:  [-0.04478371]
Stock Position:  -0.044783710613966216
Bond Position:  [32.116979]


portfolio before change:  [27.76149878]
curr_Stock_Price:  97.30072684738435
curr_Factors:  [97.30072685]
mat_Sqrt:  [[0.15]]
grads:  [0.04719726]
Stock Position:  0.0471972573890266
Bond Position:  [23.16917134]


portfolio before change:  [27.75295611]
curr_Stock_Price:  97.08904520823539
curr_Factors:  [97.08904521]
mat_Sqrt:  [[0.15]]
grads:  [0.22071836]
Stock Position:  0.2207183638794203
Bond Position:  [6.3236209]


portfolio before change:  [27.9744772]
curr_Stock_Price:  98.09089137555335
curr_Factors:  [98.09089138]
mat_Sqrt:  [[0.15]]
grads:  [-0.01924346]
Stock Position:  -0.019243459288555656
Bond Position:  [29.86208527]


portfolio before change:  [27.97045297]
curr_Stock_Price:  98.39700412435337
curr_Factors:  [98.39700412]
mat_Sqrt:  [[0.15]]
grads:  [0.00737905]
Stock Position:  0.007379045468018947
Bond Position:  [27.244377]


portfolio before change:  [27.97838346]
curr_Stock_Price:  99.24097025693993
curr_Factors:  [99.24097026]
mat_Sqrt:  [[0.15]]
grads:  [0.09357987]
Stock Position:  0.09357987318998853
Bond Position:  [18.69142605]


portfolio before change:  [27.99005257]
curr_Stock_Price:  99.35318311773032
curr_Factors:  [99.35318312]
mat_Sqrt:  [[0.15]]
grads:  [0.1009972]
Stock Position:  0.10099719686972346
Bond Position:  [17.95565958]


portfolio before change:  [27.99043322]
curr_Stock_Price:  99.34584018718057
curr_Factors:  [99.34584019]
mat_Sqrt:  [[0.15]]
grads:  [0.07151349]
Stock Position:  0.07151348970913456
Bond Position:  [20.8858655]


portfolio before change:  [28.06624204]
curr_Stock_Price:  100.38764943934576
curr_Factors:  [100.38764944]
mat_Sqrt:  [[0.15]]
grads:  [0.02600232]
Stock Position:  0.026002323630194564
Bond Position:  [25.4559299]


portfolio before change:  [28.07746837]
curr_Stock_Price:  100.75820403671729
curr_Factors:  [100.75820404]
mat_Sqrt:  [[0.15]]
grads:  [0.06688281]
Stock Position:  0.0668828064601922
Bond Position:  [21.33847691]


portfolio before change:  [27.9964606]
curr_Stock_Price:  99.52707352108497
curr_Factors:  [99.52707352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01522878]
Stock Position:  -0.015228784793289376
Bond Position:  [29.51213699]


portfolio before change:  [28.00338138]
curr_Stock_Price:  99.19374325042703
curr_Factors:  [99.19374325]
mat_Sqrt:  [[0.15]]
grads:  [-0.04595735]
Stock Position:  -0.04595734673257401
Bond Position:  [32.56206264]


portfolio before change:  [28.00703045]
curr_Stock_Price:  99.15862653281894
curr_Factors:  [99.15862653]
mat_Sqrt:  [[0.15]]
grads:  [-0.01460687]
Stock Position:  -0.014606865492680863
Bond Position:  [29.45542717]


portfolio before change:  [28.00533951]
curr_Stock_Price:  99.40042753082783
curr_Factors:  [99.40042753]
mat_Sqrt:  [[0.15]]
grads:  [0.01176123]
Stock Position:  0.011761226722387294
Bond Position:  [26.83626855]


portfolio before change:  [28.00521657]
curr_Stock_Price:  99.24736016409953
curr_Factors:  [99.24736016]
mat_Sqrt:  [[0.15]]
grads:  [0.04222665]
Stock Position:  0.04222664885608596
Bond Position:  [23.81433315]


portfolio before change:  [28.04329582]
curr_Stock_Price:  100.11389362934254
curr_Factors:  [100.11389363]
mat_Sqrt:  [[0.15]]
grads:  [-0.02885471]
Stock Position:  -0.02885471481808178
Bond Position:  [30.93205367]


portfolio before change:  [28.02790915]
curr_Stock_Price:  100.71414161245048
curr_Factors:  [100.71414161]
mat_Sqrt:  [[0.15]]
grads:  [-0.02543013]
Stock Position:  -0.02543013480790756
Bond Position:  [30.58908335]


portfolio before change:  [28.02917332]
curr_Stock_Price:  100.73961180867973
curr_Factors:  [100.73961181]
mat_Sqrt:  [[0.15]]
grads:  [0.05932814]
Stock Position:  0.059328142488456644
Bond Position:  [22.05247927]


portfolio before change:  [28.02585691]
curr_Stock_Price:  100.66048025964672
curr_Factors:  [100.66048026]
mat_Sqrt:  [[0.15]]
grads:  [0.00552969]
Stock Position:  0.005529692646427884
Bond Position:  [27.46923539]


portfolio before change:  [28.02377332]
curr_Stock_Price:  99.97319472062287
curr_Factors:  [99.97319472]
mat_Sqrt:  [[0.15]]
grads:  [0.04755053]
Stock Position:  0.04755053352117158
Bond Position:  [23.26999457]


portfolio before change:  [27.97671839]
curr_Stock_Price:  98.95303060573717
curr_Factors:  [98.95303061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02648319]
Stock Position:  -0.026483186721177766
Bond Position:  [30.59730997]


portfolio before change:  [27.99727439]
curr_Stock_Price:  98.24905155239989
curr_Factors:  [98.24905155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02279771]
Stock Position:  -0.022797706963642896
Bond Position:  [30.23712747]


portfolio before change:  [28.00999076]
curr_Stock_Price:  97.77415748186256
curr_Factors:  [97.77415748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00201036]
Stock Position:  -0.002010357045664294
Bond Position:  [28.20655173]


portfolio before change:  [28.01258641]
curr_Stock_Price:  97.35996186624524
curr_Factors:  [97.35996187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03085333]
Stock Position:  -0.030853326437538863
Bond Position:  [31.01646509]


portfolio before change:  [27.99959358]
curr_Stock_Price:  97.84391035329517
curr_Factors:  [97.84391035]
mat_Sqrt:  [[0.15]]
grads:  [0.00118675]
Stock Position:  0.0011867512200057734
Bond Position:  [27.8834772]


portfolio before change:  [28.00036671]
curr_Stock_Price:  97.02686086075728
curr_Factors:  [97.02686086]
mat_Sqrt:  [[0.15]]
grads:  [0.12709718]
Stock Position:  0.1270971773412667
Bond Position:  [15.66852657]


portfolio before change:  [28.07807344]
curr_Stock_Price:  97.63055178711836
curr_Factors:  [97.63055179]
mat_Sqrt:  [[0.15]]
grads:  [0.02532538]
Stock Position:  0.02532538148665328
Bond Position:  [25.60554247]


portfolio before change:  [28.08872198]
curr_Stock_Price:  97.98782743368767
curr_Factors:  [97.98782743]
mat_Sqrt:  [[0.15]]
grads:  [0.07409552]
Stock Position:  0.07409552067199157
Bond Position:  [20.82826289]


portfolio before change:  [28.11293008]
curr_Stock_Price:  98.29697285823241
curr_Factors:  [98.29697286]
mat_Sqrt:  [[0.15]]
grads:  [-0.00392188]
Stock Position:  -0.003921882300890233
Bond Position:  [28.49843924]


portfolio before change:  [28.11646861]
curr_Stock_Price:  97.84889186979768
curr_Factors:  [97.84889187]
mat_Sqrt:  [[0.15]]
grads:  [0.01985355]
Stock Position:  0.019853554627772056
Bond Position:  [26.17382029]


portfolio before change:  [28.11056873]
curr_Stock_Price:  97.469323172686
curr_Factors:  [97.46932317]
mat_Sqrt:  [[0.15]]
grads:  [0.15402044]
Stock Position:  0.15402043927621725
Bond Position:  [13.09830076]


portfolio before change:  [27.91791256]
curr_Stock_Price:  96.21315973960306
curr_Factors:  [96.21315974]
mat_Sqrt:  [[0.15]]
grads:  [0.02182076]
Stock Position:  0.02182075554885788
Bond Position:  [25.81846872]


portfolio before change:  [27.93468766]
curr_Stock_Price:  96.90797486830125
curr_Factors:  [96.90797487]
mat_Sqrt:  [[0.15]]
grads:  [-0.10317162]
Stock Position:  -0.10317162224824286
Bond Position:  [37.93284063]


portfolio before change:  [27.88091656]
curr_Stock_Price:  97.45213582653531
curr_Factors:  [97.45213583]
mat_Sqrt:  [[0.15]]
grads:  [-0.03564803]
Stock Position:  -0.035648026439578956
Bond Position:  [31.35489288]


portfolio before change:  [27.91364813]
curr_Stock_Price:  96.5889232465929
curr_Factors:  [96.58892325]
mat_Sqrt:  [[0.15]]
grads:  [0.01231672]
Stock Position:  0.012316717058806109
Bond Position:  [26.72398969]


portfolio before change:  [27.91783935]
curr_Stock_Price:  96.79359742853865
curr_Factors:  [96.79359743]
mat_Sqrt:  [[0.15]]
grads:  [0.06487012]
Stock Position:  0.06487012343208769
Bond Position:  [21.63882673]


portfolio before change:  [27.92665016]
curr_Stock_Price:  96.908570890309
curr_Factors:  [96.90857089]
mat_Sqrt:  [[0.15]]
grads:  [0.01360632]
Stock Position:  0.01360632423916228
Bond Position:  [26.60808072]


portfolio before change:  [27.92974643]
curr_Stock_Price:  97.0139057456484
curr_Factors:  [97.01390575]
mat_Sqrt:  [[0.15]]
grads:  [-0.01072099]
Stock Position:  -0.010720986089079947
Bond Position:  [28.96983117]


portfolio before change:  [27.93469242]
curr_Stock_Price:  96.72145964284496
curr_Factors:  [96.72145964]
mat_Sqrt:  [[0.15]]
grads:  [-0.07126791]
Stock Position:  -0.07126791088446587
Bond Position:  [34.82782878]


portfolio before change:  [27.96235147]
curr_Stock_Price:  96.36390389971478
curr_Factors:  [96.3639039]
mat_Sqrt:  [[0.15]]
grads:  [-0.17102265]
Stock Position:  -0.17102265202578193
Bond Position:  [44.44276188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.83093678]
Stock Price:  97.1485511758282
PL:  [27.83093678]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37493655e-02]
 [ 8.04128968e-03]
 [ 2.33113455e-02]
 [-9.98606803e-03]
 [ 1.09290592e-02]
 [-1.35909966e-02]
 [-7.46704317e-04]
 [-3.20822228e-03]
 [-2.08442204e-02]
 [-1.24351760e-02]
 [ 1.39533391e-02]
 [-7.25427798e-03]
 [ 1.61543786e-03]
 [-5.56386212e-03]
 [ 3.33912508e-03]
 [ 2.18652075e-03]
 [-2.78949003e-02]
 [-1.00275095e-02]
 [ 2.38126930e-02]
 [-2.65264209e-03]
 [-1.13541441e-02]
 [ 5.42525315e-03]
 [ 1.75251696e-02]
 [ 2.03933762e-02]
 [ 6.36456282e-03]
 [ 4.42528222e-03]
 [ 6.35898642e-04]
 [ 1.48924912e-02]
 [-1.23584500e-02]
 [ 6.65687616e-02]
 [-6.25049465e-03]
 [ 2.97257385e-02]
 [ 1.36343094e-02]
 [-1.91156680e-02]
 [-1.89113684e-02]
 [-6.05911576e-02]
 [ 1.24472846e-02]
 [-5.02788289e-03]
 [ 5.85832037e-02]
 [ 1.69501446e-03]
 [ 6.70367388e-03]
 [ 3.58408289e-02]
 [-3.37280725e-03]
 [ 2.61448785e-02]
 [-6.00076662e-02]
 [ 2.44628337e-02]
 [ 9.35204963e-03]
 [ 5.34441242e-03]
 [-8.01770774e-03]
 [-5.18281816e-04]
 [-5.17401966e-03]
 [ 2.53799129e-04]
 [ 7.93727270e-04]
 [ 6.71795260e-03]
 [-9.61242384e-03]
 [-4.49540300e-03]
 [-6.03317628e-04]
 [ 1.20262409e-02]
 [ 8.27009869e-03]
 [-3.44843578e-03]
 [-5.10082799e-03]
 [-4.45876499e-04]
 [-5.92858618e-03]
 [ 2.31332811e-03]
 [ 1.98946248e-02]
 [ 5.42019768e-03]
 [ 7.54934660e-03]
 [-3.38453864e-04]
 [ 2.63119198e-03]
 [ 2.17577738e-02]
 [ 9.72550879e-04]
 [-1.59905116e-02]
 [-5.35079394e-05]
 [ 1.22853517e-03]
 [ 4.32837587e-03]
 [-1.37867452e-02]
 [-3.71724361e-03]
 [ 1.48358408e-02]
 [-5.87238930e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.5312019]
curr_Stock_Price:  99.88367947663076
curr_Factors:  [99.88367948]
mat_Sqrt:  [[0.15]]
grads:  [-0.09166244]
Stock Position:  -0.09166243643840287
Bond Position:  [8.62437952]


portfolio before change:  [-0.529821]
curr_Stock_Price:  99.8744952044685
curr_Factors:  [99.8744952]
mat_Sqrt:  [[0.15]]
grads:  [0.0536086]
Stock Position:  0.05360859785817798
Bond Position:  [-5.88395265]


portfolio before change:  [-0.56945944]
curr_Stock_Price:  99.141950726688
curr_Factors:  [99.14195073]
mat_Sqrt:  [[0.15]]
grads:  [0.15540897]
Stock Position:  0.15540896966772078
Bond Position:  [-15.97700786]


portfolio before change:  [-0.56099673]
curr_Stock_Price:  99.20283077751532
curr_Factors:  [99.20283078]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657379]
Stock Position:  -0.06657378689876094
Bond Position:  [6.04331138]


portfolio before change:  [-0.54606366]
curr_Stock_Price:  98.98419594863677
curr_Factors:  [98.98419595]
mat_Sqrt:  [[0.15]]
grads:  [0.07286039]
Stock Position:  0.07286039461048621
Bond Position:  [-7.75809124]


portfolio before change:  [-0.54860852]
curr_Stock_Price:  98.95592325877313
curr_Factors:  [98.95592326]
mat_Sqrt:  [[0.15]]
grads:  [-0.09060664]
Stock Position:  -0.09060664379779557
Bond Position:  [8.41745557]


portfolio before change:  [-0.58789089]
curr_Stock_Price:  99.39527823277612
curr_Factors:  [99.39527823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00497803]
Stock Position:  -0.004978028781847839
Bond Position:  [-0.09309834]


portfolio before change:  [-0.58956472]
curr_Stock_Price:  99.73035264179589
curr_Factors:  [99.73035264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02138815]
Stock Position:  -0.021388148505901036
Bond Position:  [1.54348287]


portfolio before change:  [-0.55395528]
curr_Stock_Price:  98.06994861724378
curr_Factors:  [98.06994862]
mat_Sqrt:  [[0.15]]
grads:  [-0.13896147]
Stock Position:  -0.1389614691516265
Bond Position:  [13.07398886]


portfolio before change:  [-0.67630222]
curr_Stock_Price:  98.95626689780327
curr_Factors:  [98.9562669]
mat_Sqrt:  [[0.15]]
grads:  [-0.08290117]
Stock Position:  -0.08290117347775973
Bond Position:  [7.52728843]


portfolio before change:  [-0.75962415]
curr_Stock_Price:  99.96701733549159
curr_Factors:  [99.96701734]
mat_Sqrt:  [[0.15]]
grads:  [0.09302226]
Stock Position:  0.09302226088150252
Bond Position:  [-10.05878212]


portfolio before change:  [-0.89396054]
curr_Stock_Price:  98.52964418053182
curr_Factors:  [98.52964418]
mat_Sqrt:  [[0.15]]
grads:  [-0.04836185]
Stock Position:  -0.048361853169167544
Bond Position:  [3.87111564]


portfolio before change:  [-0.88855133]
curr_Stock_Price:  98.42279838411076
curr_Factors:  [98.42279838]
mat_Sqrt:  [[0.15]]
grads:  [0.01076959]
Stock Position:  0.010769585700333331
Bond Position:  [-1.94852409]


portfolio before change:  [-0.89737287]
curr_Stock_Price:  97.61499043584533
curr_Factors:  [97.61499044]
mat_Sqrt:  [[0.15]]
grads:  [-0.03709241]
Stock Position:  -0.03709241416247622
Bond Position:  [2.72340278]


portfolio before change:  [-0.88012047]
curr_Stock_Price:  97.15446005558854
curr_Factors:  [97.15446006]
mat_Sqrt:  [[0.15]]
grads:  [0.02226083]
Stock Position:  0.022260833836613945
Bond Position:  [-3.04285977]


portfolio before change:  [-0.88018478]
curr_Stock_Price:  97.16011486840101
curr_Factors:  [97.16011487]
mat_Sqrt:  [[0.15]]
grads:  [0.0145768]
Stock Position:  0.014576804988449394
Bond Position:  [-2.29646882]


portfolio before change:  [-0.8774469]
curr_Stock_Price:  97.35778570150474
curr_Factors:  [97.3577857]
mat_Sqrt:  [[0.15]]
grads:  [-0.185966]
Stock Position:  -0.18596600223575183
Bond Position:  [17.22779129]


portfolio before change:  [-0.71183677]
curr_Stock_Price:  96.47303602461909
curr_Factors:  [96.47303602]
mat_Sqrt:  [[0.15]]
grads:  [-0.06685006]
Stock Position:  -0.06685006307227014
Bond Position:  [5.73739177]


portfolio before change:  [-0.73635803]
curr_Stock_Price:  96.84521012359959
curr_Factors:  [96.84521012]
mat_Sqrt:  [[0.15]]
grads:  [0.15875129]
Stock Position:  0.15875128658627924
Bond Position:  [-16.11065974]


portfolio before change:  [-0.63498793]
curr_Stock_Price:  97.49009969007201
curr_Factors:  [97.49009969]
mat_Sqrt:  [[0.15]]
grads:  [-0.01768428]
Stock Position:  -0.01768428061205365
Bond Position:  [1.08905435]


portfolio before change:  [-0.64140064]
curr_Stock_Price:  97.8565705256714
curr_Factors:  [97.85657053]
mat_Sqrt:  [[0.15]]
grads:  [-0.07569429]
Stock Position:  -0.07569429423265533
Bond Position:  [6.7657834]


portfolio before change:  [-0.69756574]
curr_Stock_Price:  98.6041562262762
curr_Factors:  [98.60415623]
mat_Sqrt:  [[0.15]]
grads:  [0.03616835]
Stock Position:  0.03616835432677093
Bond Position:  [-4.2639158]


portfolio before change:  [-0.68846285]
curr_Stock_Price:  98.8632057199058
curr_Factors:  [98.86320572]
mat_Sqrt:  [[0.15]]
grads:  [0.11683446]
Stock Position:  0.11683446409986041
Bond Position:  [-12.2390925]


portfolio before change:  [-0.7873242]
curr_Stock_Price:  98.02358712542363
curr_Factors:  [98.02358713]
mat_Sqrt:  [[0.15]]
grads:  [0.13595584]
Stock Position:  0.13595584103394426
Bond Position:  [-14.11420343]


portfolio before change:  [-0.95649549]
curr_Stock_Price:  96.78576521599497
curr_Factors:  [96.78576522]
mat_Sqrt:  [[0.15]]
grads:  [0.04243042]
Stock Position:  0.04243041877175221
Bond Position:  [-5.06315603]


portfolio before change:  [-0.95352534]
curr_Stock_Price:  96.86322373983988
curr_Factors:  [96.86322374]
mat_Sqrt:  [[0.15]]
grads:  [0.02950188]
Stock Position:  0.02950188149514545
Bond Position:  [-3.81117269]


portfolio before change:  [-0.9368751]
curr_Stock_Price:  97.43567714689065
curr_Factors:  [97.43567715]
mat_Sqrt:  [[0.15]]
grads:  [0.00423932]
Stock Position:  0.004239324280900225
Bond Position:  [-1.34993653]


portfolio before change:  [-0.94166952]
curr_Stock_Price:  96.32464019347493
curr_Factors:  [96.32464019]
mat_Sqrt:  [[0.15]]
grads:  [0.09928327]
Stock Position:  0.09928327444610424
Bond Position:  [-10.50509521]


portfolio before change:  [-0.95940321]
curr_Stock_Price:  96.15263632270694
curr_Factors:  [96.15263632]
mat_Sqrt:  [[0.15]]
grads:  [-0.08238967]
Stock Position:  -0.08238966681954048
Bond Position:  [6.96258046]


portfolio before change:  [-0.92077629]
curr_Stock_Price:  95.6890860709098
curr_Factors:  [95.68908607]
mat_Sqrt:  [[0.15]]
grads:  [0.44379174]
Stock Position:  0.44379174373784636
Bond Position:  [-43.38680265]


portfolio before change:  [-1.07583272]
curr_Stock_Price:  95.34580642696378
curr_Factors:  [95.34580643]
mat_Sqrt:  [[0.15]]
grads:  [-0.04166996]
Stock Position:  -0.041669964328706954
Bond Position:  [2.89722363]


portfolio before change:  [-1.05298671]
curr_Stock_Price:  94.80189129893685
curr_Factors:  [94.8018913]
mat_Sqrt:  [[0.15]]
grads:  [0.19817159]
Stock Position:  0.19817159010639795
Bond Position:  [-19.84002826]


portfolio before change:  [-0.99213765]
curr_Stock_Price:  95.11520109950497
curr_Factors:  [95.1152011]
mat_Sqrt:  [[0.15]]
grads:  [0.0908954]
Stock Position:  0.090895395907147
Bond Position:  [-9.63767151]


portfolio before change:  [-1.03659241]
curr_Stock_Price:  94.6327521533199
curr_Factors:  [94.63275215]
mat_Sqrt:  [[0.15]]
grads:  [-0.12743779]
Stock Position:  -0.12743778686633897
Bond Position:  [11.02319609]


portfolio before change:  [-1.02965381]
curr_Stock_Price:  94.58371151249062
curr_Factors:  [94.58371151]
mat_Sqrt:  [[0.15]]
grads:  [-0.12607579]
Stock Position:  -0.12607578949996737
Bond Position:  [10.89506229]


portfolio before change:  [-1.05594652]
curr_Stock_Price:  94.79765953258786
curr_Factors:  [94.79765953]
mat_Sqrt:  [[0.15]]
grads:  [-0.40394105]
Stock Position:  -0.4039410505608129
Bond Position:  [37.23671967]


portfolio before change:  [-1.40040651]
curr_Stock_Price:  95.65616935065732
curr_Factors:  [95.65616935]
mat_Sqrt:  [[0.15]]
grads:  [0.0829819]
Stock Position:  0.08298189727941982
Bond Position:  [-9.33813692]


portfolio before change:  [-1.42336994]
curr_Stock_Price:  95.38647461528159
curr_Factors:  [95.38647462]
mat_Sqrt:  [[0.15]]
grads:  [-0.03351922]
Stock Position:  -0.03351921925608196
Bond Position:  [1.77391022]


portfolio before change:  [-1.39694961]
curr_Stock_Price:  94.60156812686958
curr_Factors:  [94.60156813]
mat_Sqrt:  [[0.15]]
grads:  [0.39055469]
Stock Position:  0.390554691322993
Bond Position:  [-38.34403585]


portfolio before change:  [-0.84627383]
curr_Stock_Price:  96.01768824468124
curr_Factors:  [96.01768824]
mat_Sqrt:  [[0.15]]
grads:  [0.0113001]
Stock Position:  0.01130009642618025
Bond Position:  [-1.93128297]


portfolio before change:  [-0.85286725]
curr_Stock_Price:  95.4448873171097
curr_Factors:  [95.44488732]
mat_Sqrt:  [[0.15]]
grads:  [0.04469116]
Stock Position:  0.04469115921131423
Bond Position:  [-5.1184099]


portfolio before change:  [-0.84818757]
curr_Stock_Price:  95.55675710522311
curr_Factors:  [95.55675711]
mat_Sqrt:  [[0.15]]
grads:  [0.23893886]
Stock Position:  0.2389388591249643
Bond Position:  [-23.68041009]


portfolio before change:  [-0.85504357]
curr_Stock_Price:  95.53425794082625
curr_Factors:  [95.53425794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248538]
Stock Position:  -0.02248538166625693
Bond Position:  [1.29308069]


portfolio before change:  [-0.83522425]
curr_Stock_Price:  94.65642110526751
curr_Factors:  [94.65642111]
mat_Sqrt:  [[0.15]]
grads:  [0.17429919]
Stock Position:  0.17429919017506326
Bond Position:  [-17.33376179]


portfolio before change:  [-0.77110943]
curr_Stock_Price:  95.0304802775978
curr_Factors:  [95.03048028]
mat_Sqrt:  [[0.15]]
grads:  [-0.40005111]
Stock Position:  -0.40005110796423626
Bond Position:  [37.24593949]


portfolio before change:  [-0.67848491]
curr_Stock_Price:  94.80476767957492
curr_Factors:  [94.80476768]
mat_Sqrt:  [[0.15]]
grads:  [0.16308556]
Stock Position:  0.1630855582884165
Bond Position:  [-16.13977338]


portfolio before change:  [-0.51445321]
curr_Stock_Price:  95.81675474181297
curr_Factors:  [95.81675474]
mat_Sqrt:  [[0.15]]
grads:  [0.062347]
Stock Position:  0.062346997508789054
Bond Position:  [-6.48834017]


portfolio before change:  [-0.49078872]
curr_Stock_Price:  96.2028202036221
curr_Factors:  [96.2028202]
mat_Sqrt:  [[0.15]]
grads:  [0.03562942]
Stock Position:  0.03562941612296242
Bond Position:  [-3.91843903]


portfolio before change:  [-0.4758334]
curr_Stock_Price:  96.62944032322191
curr_Factors:  [96.62944032]
mat_Sqrt:  [[0.15]]
grads:  [-0.05345138]
Stock Position:  -0.05345138495880228
Bond Position:  [4.68914401]


portfolio before change:  [-0.52500501]
curr_Stock_Price:  97.5548547909644
curr_Factors:  [97.55485479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345521]
Stock Position:  -0.003455212103798042
Bond Position:  [-0.18793229]


portfolio before change:  [-0.52525616]
curr_Stock_Price:  97.62414380749213
curr_Factors:  [97.62414381]
mat_Sqrt:  [[0.15]]
grads:  [-0.03449346]
Stock Position:  -0.03449346439516186
Bond Position:  [2.84213877]


portfolio before change:  [-0.50287553]
curr_Stock_Price:  96.98045694232
curr_Factors:  [96.98045694]
mat_Sqrt:  [[0.15]]
grads:  [0.00169199]
Stock Position:  0.0016919941959661969
Bond Position:  [-0.6669659]


portfolio before change:  [-0.50200798]
curr_Stock_Price:  97.51783169878559
curr_Factors:  [97.5178317]
mat_Sqrt:  [[0.15]]
grads:  [0.00529152]
Stock Position:  0.005291515131050481
Bond Position:  [-1.01802506]


portfolio before change:  [-0.50376504]
curr_Stock_Price:  97.1978040804993
curr_Factors:  [97.19780408]
mat_Sqrt:  [[0.15]]
grads:  [0.04478635]
Stock Position:  0.044786350654702746
Bond Position:  [-4.85689998]


portfolio before change:  [-0.50187387]
curr_Stock_Price:  97.24680869082283
curr_Factors:  [97.24680869]
mat_Sqrt:  [[0.15]]
grads:  [-0.06408283]
Stock Position:  -0.06408282562394164
Bond Position:  [5.72997641]


portfolio before change:  [-0.57226522]
curr_Stock_Price:  98.35084054868521
curr_Factors:  [98.35084055]
mat_Sqrt:  [[0.15]]
grads:  [-0.02996935]
Stock Position:  -0.029969353360481676
Bond Position:  [2.37524588]


portfolio before change:  [-0.55295573]
curr_Stock_Price:  97.7114865022062
curr_Factors:  [97.7114865]
mat_Sqrt:  [[0.15]]
grads:  [-0.00402212]
Stock Position:  -0.004022117516801569
Bond Position:  [-0.15994865]


portfolio before change:  [-0.55293386]
curr_Stock_Price:  97.70356224018961
curr_Factors:  [97.70356224]
mat_Sqrt:  [[0.15]]
grads:  [0.08017494]
Stock Position:  0.08017493942151299
Bond Position:  [-8.38631104]


portfolio before change:  [-0.56484969]
curr_Stock_Price:  97.56147708889841
curr_Factors:  [97.56147709]
mat_Sqrt:  [[0.15]]
grads:  [0.05513399]
Stock Position:  0.05513399124259157
Bond Position:  [-5.94380331]


portfolio before change:  [-0.57970059]
curr_Stock_Price:  97.29885494637205
curr_Factors:  [97.29885495]
mat_Sqrt:  [[0.15]]
grads:  [-0.02298957]
Stock Position:  -0.022989571868329686
Bond Position:  [1.65715843]


portfolio before change:  [-0.5786206]
curr_Stock_Price:  97.25638259316517
curr_Factors:  [97.25638259]
mat_Sqrt:  [[0.15]]
grads:  [-0.03400552]
Stock Position:  -0.034005519929639294
Bond Position:  [2.72863326]


portfolio before change:  [-0.59225446]
curr_Stock_Price:  97.66232888576528
curr_Factors:  [97.66232889]
mat_Sqrt:  [[0.15]]
grads:  [-0.00297251]
Stock Position:  -0.002972509990201809
Bond Position:  [-0.30195222]


portfolio before change:  [-0.59426589]
curr_Stock_Price:  98.33265629974896
curr_Factors:  [98.3326563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03952391]
Stock Position:  -0.039523907836567486
Bond Position:  [3.29222495]


portfolio before change:  [-0.60382978]
curr_Stock_Price:  98.5798398592423
curr_Factors:  [98.57983986]
mat_Sqrt:  [[0.15]]
grads:  [0.01542219]
Stock Position:  0.015422187392532738
Bond Position:  [-2.12414655]


portfolio before change:  [-0.59908108]
curr_Stock_Price:  98.89636187250306
curr_Factors:  [98.89636187]
mat_Sqrt:  [[0.15]]
grads:  [0.13263083]
Stock Position:  0.13263083231180567
Bond Position:  [-13.71578787]


portfolio before change:  [-0.51748092]
curr_Stock_Price:  99.51806823089471
curr_Factors:  [99.51806823]
mat_Sqrt:  [[0.15]]
grads:  [0.03613465]
Stock Position:  0.036134651197994895
Bond Position:  [-4.1135316]


portfolio before change:  [-0.50448576]
curr_Stock_Price:  99.8848147244852
curr_Factors:  [99.88481472]
mat_Sqrt:  [[0.15]]
grads:  [0.05032898]
Stock Position:  0.05032897733976703
Bond Position:  [-5.53158634]


portfolio before change:  [-0.52916059]
curr_Stock_Price:  99.40141345171241
curr_Factors:  [99.40141345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00225636]
Stock Position:  -0.002256359095675744
Bond Position:  [-0.30487531]


portfolio before change:  [-0.52681433]
curr_Stock_Price:  98.3531245583638
curr_Factors:  [98.35312456]
mat_Sqrt:  [[0.15]]
grads:  [0.01754128]
Stock Position:  0.01754127988891673
Bond Position:  [-2.25205401]


portfolio before change:  [-0.51075809]
curr_Stock_Price:  99.27648932390872
curr_Factors:  [99.27648932]
mat_Sqrt:  [[0.15]]
grads:  [0.14505183]
Stock Position:  0.14505182530326144
Bond Position:  [-14.91099407]


portfolio before change:  [-0.40679517]
curr_Stock_Price:  99.99964383626136
curr_Factors:  [99.99964384]
mat_Sqrt:  [[0.15]]
grads:  [0.00648367]
Stock Position:  0.006483672524697889
Bond Position:  [-1.05516011]


portfolio before change:  [-0.40598948]
curr_Stock_Price:  100.13408022626815
curr_Factors:  [100.13408023]
mat_Sqrt:  [[0.15]]
grads:  [-0.10660341]
Stock Position:  -0.10660341035282968
Bond Position:  [10.26864497]


portfolio before change:  [-0.57219862]
curr_Stock_Price:  101.69923605832895
curr_Factors:  [101.69923606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00035672]
Stock Position:  -0.00035671959571506595
Bond Position:  [-0.53592051]


portfolio before change:  [-0.57251727]
curr_Stock_Price:  102.49861041085437
curr_Factors:  [102.49861041]
mat_Sqrt:  [[0.15]]
grads:  [0.00819023]
Stock Position:  0.00819023443947778
Bond Position:  [-1.41200492]


portfolio before change:  [-0.5719893]
curr_Stock_Price:  102.57384816821657
curr_Factors:  [102.57384817]
mat_Sqrt:  [[0.15]]
grads:  [0.02885584]
Stock Position:  0.028855839122119087
Bond Position:  [-3.53184377]


portfolio before change:  [-0.58913442]
curr_Stock_Price:  101.98733361050115
curr_Factors:  [101.98733361]
mat_Sqrt:  [[0.15]]
grads:  [-0.09191163]
Stock Position:  -0.09191163469824416
Bond Position:  [8.78468813]


portfolio before change:  [-0.661851]
curr_Stock_Price:  102.78446487870835
curr_Factors:  [102.78446488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478162]
Stock Position:  -0.024781624092190774
Bond Position:  [1.88531497]


portfolio before change:  [-0.65067119]
curr_Stock_Price:  102.33808668756753
curr_Factors:  [102.33808669]
mat_Sqrt:  [[0.15]]
grads:  [0.09890561]
Stock Position:  0.0989056052659937
Bond Position:  [-10.77248159]


portfolio before change:  [-0.67531777]
curr_Stock_Price:  102.09570120941727
curr_Factors:  [102.09570121]
mat_Sqrt:  [[0.15]]
grads:  [-0.03914926]
Stock Position:  -0.03914926202666756
Bond Position:  [3.32165359]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.6378693]
Stock Price:  101.1444480959958
PL:  [-1.7823174]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.21892165e-02]
 [ 1.61631409e-03]
 [ 1.77287839e-02]
 [-1.22892731e-02]
 [ 1.15878952e-02]
 [-1.35301956e-02]
 [ 2.45618348e-03]
 [-4.54374667e-03]
 [-7.08142478e-03]
 [-5.81234514e-03]
 [ 1.48111275e-02]
 [-5.71909441e-03]
 [-1.33018847e-03]
 [ 6.52968340e-03]
 [-2.69224547e-03]
 [ 4.71485181e-03]
 [-2.25165958e-02]
 [-1.08130950e-02]
 [ 2.48646193e-02]
 [-2.69083478e-03]
 [-1.02837664e-02]
 [ 5.46566938e-03]
 [ 1.76080211e-02]
 [ 1.77167461e-02]
 [-6.07589963e-03]
 [ 4.56604335e-03]
 [ 2.00862658e-03]
 [ 8.48005468e-03]
 [ 1.94738667e-02]
 [ 4.46227358e-04]
 [-7.63632943e-03]
 [ 8.73551752e-03]
 [ 1.21529831e-02]
 [ 5.93792351e-03]
 [ 6.53235674e-03]
 [ 1.52255032e-02]
 [-2.70430237e-02]
 [-3.19134525e-04]
 [-3.95404245e-02]
 [-9.71888720e-03]
 [ 4.19716935e-03]
 [ 1.06730142e-02]
 [-8.64816831e-03]
 [ 1.46112537e-04]
 [ 8.64069130e-03]
 [ 1.21314508e-02]
 [ 1.05687089e-02]
 [-1.24944899e-03]
 [ 1.59877646e-02]
 [-1.18063287e-03]
 [ 2.17203210e-02]
 [-6.98427491e-03]
 [-1.83042650e-03]
 [-2.75319987e-02]
 [-9.70278789e-03]
 [-2.83567749e-03]
 [ 8.88017310e-03]
 [-1.55231954e-02]
 [ 4.78231715e-03]
 [-3.91113023e-03]
 [-2.59343090e-03]
 [ 8.28105624e-03]
 [-1.27049972e-02]
 [ 4.98308935e-03]
 [ 2.54914966e-02]
 [ 6.06900917e-03]
 [ 1.35827188e-02]
 [ 6.45850188e-03]
 [ 4.21704069e-03]
 [ 1.37230427e-02]
 [ 9.61915090e-04]
 [-1.53493876e-02]
 [-1.14796665e-02]
 [ 9.56597284e-04]
 [ 1.68429945e-03]
 [-2.00639435e-02]
 [-4.68583427e-03]
 [ 1.51460564e-02]
 [ 1.34287991e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.45229856]
curr_Stock_Price:  99.20599384367347
curr_Factors:  [99.20599384]
mat_Sqrt:  [[0.15]]
grads:  [-0.08126144]
Stock Position:  -0.08126144342913767
Bond Position:  [-7.39067631]


portfolio before change:  [-15.48872946]
curr_Stock_Price:  99.64862650831456
curr_Factors:  [99.64862651]
mat_Sqrt:  [[0.15]]
grads:  [0.01077543]
Stock Position:  0.01077542725106433
Bond Position:  [-16.56248599]


portfolio before change:  [-15.49417788]
curr_Stock_Price:  99.2390623226503
curr_Factors:  [99.23906232]
mat_Sqrt:  [[0.15]]
grads:  [0.11819189]
Stock Position:  0.11819189266418575
Bond Position:  [-27.22343048]


portfolio before change:  [-15.55153624]
curr_Stock_Price:  98.76815993086954
curr_Factors:  [98.76815993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08192849]
Stock Position:  -0.08192848702545302
Bond Position:  [-7.45961033]


portfolio before change:  [-15.58486322]
curr_Stock_Price:  99.16925039069241
curr_Factors:  [99.16925039]
mat_Sqrt:  [[0.15]]
grads:  [0.07725263]
Stock Position:  0.07725263460538828
Bond Position:  [-23.24594908]


portfolio before change:  [-15.57878493]
curr_Stock_Price:  99.26673837598418
curr_Factors:  [99.26673838]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902013]
Stock Position:  -0.09020130429375874
Bond Position:  [-6.62479566]


portfolio before change:  [-15.62895596]
curr_Stock_Price:  99.81835970865335
curr_Factors:  [99.81835971]
mat_Sqrt:  [[0.15]]
grads:  [0.01637456]
Stock Position:  0.016374556520566234
Bond Position:  [-17.26343733]


portfolio before change:  [-15.63007568]
curr_Stock_Price:  99.81587248245489
curr_Factors:  [99.81587248]
mat_Sqrt:  [[0.15]]
grads:  [-0.03029164]
Stock Position:  -0.030291644490817532
Bond Position:  [-12.60648876]


portfolio before change:  [-15.63481849]
curr_Stock_Price:  99.94643247881251
curr_Factors:  [99.94643248]
mat_Sqrt:  [[0.15]]
grads:  [-0.0472095]
Stock Position:  -0.04720949852516531
Bond Position:  [-10.91639753]


portfolio before change:  [-15.6220334]
curr_Stock_Price:  99.66116390600659
curr_Factors:  [99.66116391]
mat_Sqrt:  [[0.15]]
grads:  [-0.03874897]
Stock Position:  -0.038748967624851645
Bond Position:  [-11.76026619]


portfolio before change:  [-15.62813271]
curr_Stock_Price:  99.79960033650545
curr_Factors:  [99.79960034]
mat_Sqrt:  [[0.15]]
grads:  [0.09874085]
Stock Position:  0.09874085025034574
Bond Position:  [-25.4824301]


portfolio before change:  [-15.66011407]
curr_Stock_Price:  99.49183855219607
curr_Factors:  [99.49183855]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381273]
Stock Position:  -0.03812729609501668
Bond Position:  [-11.86675928]


portfolio before change:  [-15.67123929]
curr_Stock_Price:  99.764176980867
curr_Factors:  [99.76417698]
mat_Sqrt:  [[0.15]]
grads:  [-0.00886792]
Stock Position:  -0.008867923145029674
Bond Position:  [-14.78653824]


portfolio before change:  [-15.66872673]
curr_Stock_Price:  99.37662875231887
curr_Factors:  [99.37662875]
mat_Sqrt:  [[0.15]]
grads:  [0.04353122]
Stock Position:  0.04353122265127944
Bond Position:  [-19.99471289]


portfolio before change:  [-15.68877059]
curr_Stock_Price:  98.94488919207262
curr_Factors:  [98.94488919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179483]
Stock Position:  -0.017948303139018035
Bond Position:  [-13.91287773]


portfolio before change:  [-15.67185206]
curr_Stock_Price:  97.95381402277488
curr_Factors:  [97.95381402]
mat_Sqrt:  [[0.15]]
grads:  [0.03143235]
Stock Position:  0.0314323453803884
Bond Position:  [-18.75077017]


portfolio before change:  [-15.67999063]
curr_Stock_Price:  97.73217555200243
curr_Factors:  [97.73217555]
mat_Sqrt:  [[0.15]]
grads:  [-0.15011064]
Stock Position:  -0.15011063834374816
Bond Position:  [-1.00935137]


portfolio before change:  [-15.56021093]
curr_Stock_Price:  96.93381248726733
curr_Factors:  [96.93381249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0720873]
Stock Position:  -0.07208729972078973
Bond Position:  [-8.57251414]


portfolio before change:  [-15.62758419]
curr_Stock_Price:  97.86098630300175
curr_Factors:  [97.8609863]
mat_Sqrt:  [[0.15]]
grads:  [0.16576413]
Stock Position:  0.16576412862698528
Bond Position:  [-31.84942531]


portfolio before change:  [-15.69490621]
curr_Stock_Price:  97.46686380366913
curr_Factors:  [97.4668638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179389]
Stock Position:  -0.01793889855411428
Bond Position:  [-13.94645803]


portfolio before change:  [-15.70517526]
curr_Stock_Price:  97.99071807585034
curr_Factors:  [97.99071808]
mat_Sqrt:  [[0.15]]
grads:  [-0.06855844]
Stock Position:  -0.06855844263522923
Bond Position:  [-8.98708424]


portfolio before change:  [-15.72468746]
curr_Stock_Price:  98.26713179488769
curr_Factors:  [98.26713179]
mat_Sqrt:  [[0.15]]
grads:  [0.0364378]
Stock Position:  0.03643779587033643
Bond Position:  [-19.30532515]


portfolio before change:  [-15.70344221]
curr_Stock_Price:  98.88330163132278
curr_Factors:  [98.88330163]
mat_Sqrt:  [[0.15]]
grads:  [0.11738681]
Stock Position:  0.11738680708743454
Bond Position:  [-27.31103727]


portfolio before change:  [-15.63536733]
curr_Stock_Price:  99.47776263360794
curr_Factors:  [99.47776263]
mat_Sqrt:  [[0.15]]
grads:  [0.11811164]
Stock Position:  0.11811164091638435
Bond Position:  [-27.38484911]


portfolio before change:  [-15.63645618]
curr_Stock_Price:  99.48303527104561
curr_Factors:  [99.48303527]
mat_Sqrt:  [[0.15]]
grads:  [-0.040506]
Stock Position:  -0.040505997503317306
Bond Position:  [-11.6067966]


portfolio before change:  [-15.65037527]
curr_Stock_Price:  99.80875611693227
curr_Factors:  [99.80875612]
mat_Sqrt:  [[0.15]]
grads:  [0.03044029]
Stock Position:  0.030440289033045586
Bond Position:  [-18.68858265]


portfolio before change:  [-15.64655364]
curr_Stock_Price:  99.97267393439559
curr_Factors:  [99.97267393]
mat_Sqrt:  [[0.15]]
grads:  [0.01339084]
Stock Position:  0.01339084388246355
Bond Position:  [-16.98527211]


portfolio before change:  [-15.64978266]
curr_Stock_Price:  99.81081637502942
curr_Factors:  [99.81081638]
mat_Sqrt:  [[0.15]]
grads:  [0.0565337]
Stock Position:  0.05653369789234793
Bond Position:  [-21.2924572]


portfolio before change:  [-15.65406869]
curr_Stock_Price:  99.75854298457472
curr_Factors:  [99.75854298]
mat_Sqrt:  [[0.15]]
grads:  [0.12982578]
Stock Position:  0.1298257781281499
Bond Position:  [-28.60529916]


portfolio before change:  [-15.63356907]
curr_Stock_Price:  99.93021540836288
curr_Factors:  [99.93021541]
mat_Sqrt:  [[0.15]]
grads:  [0.00297485]
Stock Position:  0.002974849050454767
Bond Position:  [-15.93084638]


portfolio before change:  [-15.63445856]
curr_Stock_Price:  99.96592065843114
curr_Factors:  [99.96592066]
mat_Sqrt:  [[0.15]]
grads:  [-0.05090886]
Stock Position:  -0.05090886288916144
Bond Position:  [-10.54530721]


portfolio before change:  [-15.63421639]
curr_Stock_Price:  99.94821707222052
curr_Factors:  [99.94821707]
mat_Sqrt:  [[0.15]]
grads:  [0.05823678]
Stock Position:  0.058236783450949445
Bond Position:  [-21.45487907]


portfolio before change:  [-15.63580488]
curr_Stock_Price:  99.9439669428496
curr_Factors:  [99.94396694]
mat_Sqrt:  [[0.15]]
grads:  [0.08101989]
Stock Position:  0.08101988719660662
Bond Position:  [-23.73325381]


portfolio before change:  [-15.48625538]
curr_Stock_Price:  101.80811269022895
curr_Factors:  [101.80811269]
mat_Sqrt:  [[0.15]]
grads:  [0.03958616]
Stock Position:  0.03958615670456777
Bond Position:  [-19.51644728]


portfolio before change:  [-15.47741131]
curr_Stock_Price:  102.06233999970476
curr_Factors:  [102.06234]
mat_Sqrt:  [[0.15]]
grads:  [0.04354904]
Stock Position:  0.04354904490386966
Bond Position:  [-19.92212874]


portfolio before change:  [-15.48175949]
curr_Stock_Price:  101.99108677159668
curr_Factors:  [101.99108677]
mat_Sqrt:  [[0.15]]
grads:  [0.10150335]
Stock Position:  0.10150335452898869
Bond Position:  [-25.83419693]


portfolio before change:  [-15.50493376]
curr_Stock_Price:  101.77868412622419
curr_Factors:  [101.77868413]
mat_Sqrt:  [[0.15]]
grads:  [-0.18028682]
Stock Position:  -0.18028682493975606
Bond Position:  [2.84442205]


portfolio before change:  [-15.5294185]
curr_Stock_Price:  101.91548016769855
curr_Factors:  [101.91548017]
mat_Sqrt:  [[0.15]]
grads:  [-0.00212756]
Stock Position:  -0.0021275634991389505
Bond Position:  [-15.31258685]


portfolio before change:  [-15.5300686]
curr_Stock_Price:  101.77119720757241
curr_Factors:  [101.77119721]
mat_Sqrt:  [[0.15]]
grads:  [-0.26360283]
Stock Position:  -0.2636028302775203
Bond Position:  [11.29710703]


portfolio before change:  [-15.54372081]
curr_Stock_Price:  101.8256666765055
curr_Factors:  [101.82566668]
mat_Sqrt:  [[0.15]]
grads:  [-0.06479258]
Stock Position:  -0.06479258130459102
Bond Position:  [-8.94617303]


portfolio before change:  [-15.54820647]
curr_Stock_Price:  101.88626774692962
curr_Factors:  [101.88626775]
mat_Sqrt:  [[0.15]]
grads:  [0.02798113]
Stock Position:  0.027981128976407133
Bond Position:  [-18.39909926]


portfolio before change:  [-15.53497114]
curr_Stock_Price:  102.40037512520959
curr_Factors:  [102.40037513]
mat_Sqrt:  [[0.15]]
grads:  [0.07115343]
Stock Position:  0.07115342824450195
Bond Position:  [-22.82110888]


portfolio before change:  [-15.49103603]
curr_Stock_Price:  103.03789145841797
curr_Factors:  [103.03789146]
mat_Sqrt:  [[0.15]]
grads:  [-0.05765446]
Stock Position:  -0.05765445537754354
Bond Position:  [-9.55044252]


portfolio before change:  [-15.47518011]
curr_Stock_Price:  102.75252156210951
curr_Factors:  [102.75252156]
mat_Sqrt:  [[0.15]]
grads:  [0.00097408]
Stock Position:  0.0009740835814386953
Bond Position:  [-15.57526965]


portfolio before change:  [-15.47623447]
curr_Stock_Price:  102.66949133007499
curr_Factors:  [102.66949133]
mat_Sqrt:  [[0.15]]
grads:  [0.05760461]
Stock Position:  0.05760460866142264
Bond Position:  [-21.39047034]


portfolio before change:  [-15.47687339]
curr_Stock_Price:  102.68160887903733
curr_Factors:  [102.68160888]
mat_Sqrt:  [[0.15]]
grads:  [0.08087634]
Stock Position:  0.08087633898367944
Bond Position:  [-23.781386]


portfolio before change:  [-15.49018991]
curr_Stock_Price:  102.5353344512229
curr_Factors:  [102.53533445]
mat_Sqrt:  [[0.15]]
grads:  [0.07045806]
Stock Position:  0.0704580592704511
Bond Position:  [-22.71463058]


portfolio before change:  [-15.46708441]
curr_Stock_Price:  102.88341680643643
curr_Factors:  [102.88341681]
mat_Sqrt:  [[0.15]]
grads:  [-0.00832966]
Stock Position:  -0.008329659917658253
Bond Position:  [-14.61010054]


portfolio before change:  [-15.46046056]
curr_Stock_Price:  101.97857622098742
curr_Factors:  [101.97857622]
mat_Sqrt:  [[0.15]]
grads:  [0.1065851]
Stock Position:  0.10658509761226283
Bond Position:  [-26.32985706]


portfolio before change:  [-15.44411995]
curr_Stock_Price:  102.14732658949107
curr_Factors:  [102.14732659]
mat_Sqrt:  [[0.15]]
grads:  [-0.00787089]
Stock Position:  -0.007870885817752528
Bond Position:  [-14.64013001]


portfolio before change:  [-15.45251044]
curr_Stock_Price:  103.09708669865242
curr_Factors:  [103.0970867]
mat_Sqrt:  [[0.15]]
grads:  [0.14480214]
Stock Position:  0.1448021401890479
Bond Position:  [-30.38118924]


portfolio before change:  [-15.51757269]
curr_Stock_Price:  102.6608820807613
curr_Factors:  [102.66088208]
mat_Sqrt:  [[0.15]]
grads:  [-0.04656183]
Stock Position:  -0.046561832702949196
Bond Position:  [-10.73749387]


portfolio before change:  [-15.55724531]
curr_Stock_Price:  103.49851040474493
curr_Factors:  [103.4985104]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220284]
Stock Position:  -0.012202843353233695
Bond Position:  [-14.2942692]


portfolio before change:  [-15.56720062]
curr_Stock_Price:  104.24111485402268
curr_Factors:  [104.24111485]
mat_Sqrt:  [[0.15]]
grads:  [-0.18354666]
Stock Position:  -0.1835466582993194
Bond Position:  [3.56590767]


portfolio before change:  [-15.67944034]
curr_Stock_Price:  104.8538342593136
curr_Factors:  [104.85383426]
mat_Sqrt:  [[0.15]]
grads:  [-0.06468525]
Stock Position:  -0.06468525262237858
Bond Position:  [-8.89694358]


portfolio before change:  [-15.62734036]
curr_Stock_Price:  104.03979933984697
curr_Factors:  [104.03979934]
mat_Sqrt:  [[0.15]]
grads:  [-0.01890452]
Stock Position:  -0.018904516577825378
Bond Position:  [-13.66051825]


portfolio before change:  [-15.6248711]
curr_Stock_Price:  103.86401716845992
curr_Factors:  [103.86401717]
mat_Sqrt:  [[0.15]]
grads:  [0.05920115]
Stock Position:  0.05920115399710915
Bond Position:  [-21.77374077]


portfolio before change:  [-15.64524949]
curr_Stock_Price:  103.54278194449672
curr_Factors:  [103.54278194]
mat_Sqrt:  [[0.15]]
grads:  [-0.10348797]
Stock Position:  -0.10348796942252547
Bond Position:  [-4.92981724]


portfolio before change:  [-15.61911278]
curr_Stock_Price:  103.28724656552298
curr_Factors:  [103.28724657]
mat_Sqrt:  [[0.15]]
grads:  [0.03188211]
Stock Position:  0.03188211433430063
Bond Position:  [-18.91212858]


portfolio before change:  [-15.64896775]
curr_Stock_Price:  102.38790436518113
curr_Factors:  [102.38790437]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260742]
Stock Position:  -0.02607420154604172
Bond Position:  [-12.9792849]


portfolio before change:  [-15.65147411]
curr_Stock_Price:  102.45291591666036
curr_Factors:  [102.45291592]
mat_Sqrt:  [[0.15]]
grads:  [-0.01728954]
Stock Position:  -0.01728953930288071
Bond Position:  [-13.88011039]


portfolio before change:  [-15.64093129]
curr_Stock_Price:  101.79295859692668
curr_Factors:  [101.7929586]
mat_Sqrt:  [[0.15]]
grads:  [0.05520704]
Stock Position:  0.05520704158513826
Bond Position:  [-21.26061938]


portfolio before change:  [-15.65860385]
curr_Stock_Price:  101.49691415987637
curr_Factors:  [101.49691416]
mat_Sqrt:  [[0.15]]
grads:  [-0.08469998]
Stock Position:  -0.08469998139652633
Bond Position:  [-7.06181711]


portfolio before change:  [-15.6970221]
curr_Stock_Price:  101.94528342333518
curr_Factors:  [101.94528342]
mat_Sqrt:  [[0.15]]
grads:  [0.0332206]
Stock Position:  0.033220595646378054
Bond Position:  [-19.08370514]


portfolio before change:  [-15.71180349]
curr_Stock_Price:  101.53624127454258
curr_Factors:  [101.53624127]
mat_Sqrt:  [[0.15]]
grads:  [0.16994331]
Stock Position:  0.16994331095280404
Bond Position:  [-32.96720852]


portfolio before change:  [-15.62098158]
curr_Stock_Price:  102.08279074056749
curr_Factors:  [102.08279074]
mat_Sqrt:  [[0.15]]
grads:  [0.04046006]
Stock Position:  0.04046006112998819
Bond Position:  [-19.75125753]


portfolio before change:  [-15.63165272]
curr_Stock_Price:  101.84955711678533
curr_Factors:  [101.84955712]
mat_Sqrt:  [[0.15]]
grads:  [0.09055146]
Stock Position:  0.09055145876747772
Bond Position:  [-24.85427869]


portfolio before change:  [-15.57803427]
curr_Stock_Price:  102.45884487521535
curr_Factors:  [102.45884488]
mat_Sqrt:  [[0.15]]
grads:  [0.04305668]
Stock Position:  0.04305667923048591
Bond Position:  [-19.98957188]


portfolio before change:  [-15.5836308]
curr_Stock_Price:  102.35788143809754
curr_Factors:  [102.35788144]
mat_Sqrt:  [[0.15]]
grads:  [0.0281136]
Stock Position:  0.02811360460556179
Bond Position:  [-18.46127981]


portfolio before change:  [-15.55989465]
curr_Stock_Price:  103.24321859745427
curr_Factors:  [103.2432186]
mat_Sqrt:  [[0.15]]
grads:  [0.09148695]
Stock Position:  0.09148695131733925
Bond Position:  [-25.00530196]


portfolio before change:  [-15.53011938]
curr_Stock_Price:  103.58576085790467
curr_Factors:  [103.58576086]
mat_Sqrt:  [[0.15]]
grads:  [0.00641277]
Stock Position:  0.006412767266430845
Bond Position:  [-16.19439076]


portfolio before change:  [-15.53159998]
curr_Stock_Price:  103.51271650259181
curr_Factors:  [103.5127165]
mat_Sqrt:  [[0.15]]
grads:  [-0.10232925]
Stock Position:  -0.10232925060126037
Bond Position:  [-4.93922127]


portfolio before change:  [-15.61814346]
curr_Stock_Price:  104.35543515382595
curr_Factors:  [104.35543515]
mat_Sqrt:  [[0.15]]
grads:  [-0.07653111]
Stock Position:  -0.0765311099109621
Bond Position:  [-7.63170618]


portfolio before change:  [-15.61264829]
curr_Stock_Price:  104.27739940729245
curr_Factors:  [104.27739941]
mat_Sqrt:  [[0.15]]
grads:  [0.00637732]
Stock Position:  0.006377315225948468
Bond Position:  [-16.27765814]


portfolio before change:  [-15.61334247]
curr_Stock_Price:  104.32808072026633
curr_Factors:  [104.32808072]
mat_Sqrt:  [[0.15]]
grads:  [0.01122866]
Stock Position:  0.011228663000684749
Bond Position:  [-16.78480733]


portfolio before change:  [-15.61134122]
curr_Stock_Price:  104.59973658676108
curr_Factors:  [104.59973659]
mat_Sqrt:  [[0.15]]
grads:  [-0.13375962]
Stock Position:  -0.1337596232987189
Bond Position:  [-1.62011986]


portfolio before change:  [-15.77033177]
curr_Stock_Price:  105.78760842240148
curr_Factors:  [105.78760842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0312389]
Stock Position:  -0.03123889511582596
Bond Position:  [-12.46564377]


portfolio before change:  [-15.78046912]
curr_Stock_Price:  106.0871779609173
curr_Factors:  [106.08717796]
mat_Sqrt:  [[0.15]]
grads:  [0.10097371]
Stock Position:  0.10097370945582827
Bond Position:  [-26.492485]


portfolio before change:  [-15.84422982]
curr_Stock_Price:  105.47211816690918
curr_Factors:  [105.47211817]
mat_Sqrt:  [[0.15]]
grads:  [0.08952533]
Stock Position:  0.08952532720037606
Bond Position:  [-25.28665571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.88376595]
Stock Price:  105.04815253661141
PL:  [-20.93191848]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.73014333e-03]
 [ 2.72955913e-02]
 [ 2.96217914e-03]
 [-9.40854994e-03]
 [-1.07525914e-02]
 [-6.05105067e-03]
 [ 6.64073491e-04]
 [-7.49425447e-04]
 [-1.45446191e-02]
 [-7.77671982e-03]
 [ 1.35422120e-02]
 [-8.59516850e-04]
 [-3.08687167e-03]
 [ 5.55136558e-03]
 [-8.86476075e-04]
 [ 1.60678394e-02]
 [ 9.73911899e-02]
 [-1.18743044e-02]
 [ 1.86004785e-02]
 [ 1.97239994e-03]
 [-3.86647597e-03]
 [ 4.49224268e-03]
 [ 1.05712661e-02]
 [ 2.08503911e-02]
 [-7.90038754e-04]
 [ 7.70832423e-03]
 [-3.82399261e-03]
 [ 1.82066318e-02]
 [ 2.46283121e-02]
 [-8.12668915e-03]
 [-1.27278930e-03]
 [ 1.39347164e-02]
 [ 1.39953006e-02]
 [-2.01799180e-03]
 [ 5.95805290e-03]
 [ 1.43386053e-02]
 [-2.64882749e-02]
 [-9.01226436e-04]
 [-3.93076876e-02]
 [-1.04289272e-02]
 [ 4.20914588e-03]
 [ 2.35688970e-03]
 [-2.81421981e-03]
 [-4.24362923e-03]
 [ 1.84819182e-02]
 [ 1.40844455e-02]
 [ 1.06221395e-02]
 [ 1.69102982e-03]
 [ 1.47374723e-02]
 [-1.17955117e-03]
 [ 1.66007221e-02]
 [-1.61525459e-02]
 [ 1.36851815e-03]
 [-9.15494508e-03]
 [-3.19761275e-03]
 [-3.02012372e-03]
 [ 9.86550818e-03]
 [-9.69368919e-03]
 [ 5.12295856e-03]
 [-3.68486721e-03]
 [-4.80515040e-03]
 [ 5.76253275e-03]
 [-1.98938164e-02]
 [ 1.78224411e-03]
 [ 1.77042630e-02]
 [ 1.54584773e-02]
 [ 6.13808460e-03]
 [ 1.03781858e-02]
 [ 7.12300795e-03]
 [ 1.10324679e-02]
 [ 1.88266732e-03]
 [-1.53631699e-02]
 [-2.85325817e-03]
 [ 1.01951345e-03]
 [ 3.00950822e-03]
 [-1.69420419e-02]
 [-3.64613758e-03]
 [ 1.13343369e-02]
 [-5.68173323e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.06639887]
curr_Stock_Price:  100.45583668714401
curr_Factors:  [100.45583669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02486762]
Stock Position:  -0.024867622218722463
Bond Position:  [14.56449666]


portfolio before change:  [12.06342117]
curr_Stock_Price:  100.6121847704092
curr_Factors:  [100.61218477]
mat_Sqrt:  [[0.15]]
grads:  [0.18197061]
Stock Position:  0.18197060833936887
Bond Position:  [-6.2450393]


portfolio before change:  [11.93118279]
curr_Stock_Price:  99.88762789290067
curr_Factors:  [99.88762789]
mat_Sqrt:  [[0.15]]
grads:  [0.01974786]
Stock Position:  0.019747860910518646
Bond Position:  [9.9586158]


portfolio before change:  [11.941449]
curr_Stock_Price:  100.37597329397963
curr_Factors:  [100.37597329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06272367]
Stock Position:  -0.06272366626045854
Bond Position:  [18.23739805]


portfolio before change:  [11.91639652]
curr_Stock_Price:  100.79355655118425
curr_Factors:  [100.79355655]
mat_Sqrt:  [[0.15]]
grads:  [-0.07168394]
Stock Position:  -0.07168394281224294
Bond Position:  [19.14167606]


portfolio before change:  [11.97475264]
curr_Stock_Price:  99.99617110678767
curr_Factors:  [99.99617111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04034034]
Stock Position:  -0.04034033776673301
Bond Position:  [16.00863196]


portfolio before change:  [11.99270415]
curr_Stock_Price:  99.57597293852592
curr_Factors:  [99.57597294]
mat_Sqrt:  [[0.15]]
grads:  [0.00442716]
Stock Position:  0.00442715660416262
Bond Position:  [11.55186572]


portfolio before change:  [11.99341203]
curr_Stock_Price:  99.57278010298957
curr_Factors:  [99.5727801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00499617]
Stock Position:  -0.00499616964371207
Bond Position:  [12.49089453]


portfolio before change:  [11.99582433]
curr_Stock_Price:  99.24621117976272
curr_Factors:  [99.24621118]
mat_Sqrt:  [[0.15]]
grads:  [-0.09696413]
Stock Position:  -0.0969641273045698
Bond Position:  [21.61914658]


portfolio before change:  [11.9743341]
curr_Stock_Price:  99.48177729918633
curr_Factors:  [99.4817773]
mat_Sqrt:  [[0.15]]
grads:  [-0.0518448]
Stock Position:  -0.051844798812034035
Bond Position:  [17.13194683]


portfolio before change:  [11.97964881]
curr_Stock_Price:  99.3999190767968
curr_Factors:  [99.39991908]
mat_Sqrt:  [[0.15]]
grads:  [0.09028141]
Stock Position:  0.09028141321857476
Bond Position:  [3.00568364]


portfolio before change:  [12.0732964]
curr_Stock_Price:  100.43512367597444
curr_Factors:  [100.43512368]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573011]
Stock Position:  -0.005730112335330084
Bond Position:  [12.64880094]


portfolio before change:  [12.07202977]
curr_Stock_Price:  100.79414066683749
curr_Factors:  [100.79414067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02057914]
Stock Position:  -0.020579144439413673
Bond Position:  [14.14628695]


portfolio before change:  [12.06378431]
curr_Stock_Price:  101.2377754987405
curr_Factors:  [101.2377755]
mat_Sqrt:  [[0.15]]
grads:  [0.0370091]
Stock Position:  0.03700910385524171
Bond Position:  [8.31706497]


portfolio before change:  [12.05654822]
curr_Stock_Price:  101.028207332122
curr_Factors:  [101.02820733]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590984]
Stock Position:  -0.0059098404997355355
Bond Position:  [12.65360881]


portfolio before change:  [12.05682876]
curr_Stock_Price:  101.11455944863987
curr_Factors:  [101.11455945]
mat_Sqrt:  [[0.15]]
grads:  [0.10711893]
Stock Position:  0.10711892946223464
Bond Position:  [1.2255454]


portfolio before change:  [12.20582832]
curr_Stock_Price:  102.50481751406328
curr_Factors:  [102.50481751]
mat_Sqrt:  [[0.15]]
grads:  [0.6492746]
Stock Position:  0.6492745991149061
Bond Position:  [-54.34794598]


portfolio before change:  [12.0744802]
curr_Stock_Price:  102.30774949016177
curr_Factors:  [102.30774949]
mat_Sqrt:  [[0.15]]
grads:  [-0.07916203]
Stock Position:  -0.07916202932809255
Bond Position:  [20.17336927]


portfolio before change:  [12.14066255]
curr_Stock_Price:  101.48764078341175
curr_Factors:  [101.48764078]
mat_Sqrt:  [[0.15]]
grads:  [0.12400319]
Stock Position:  0.12400319019739882
Bond Position:  [-0.44412867]


portfolio before change:  [12.06323779]
curr_Stock_Price:  100.86348746303126
curr_Factors:  [100.86348746]
mat_Sqrt:  [[0.15]]
grads:  [0.01314933]
Stock Position:  0.01314933294446235
Bond Position:  [10.73695021]


portfolio before change:  [12.06535311]
curr_Stock_Price:  100.97332179109391
curr_Factors:  [100.97332179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02577651]
Stock Position:  -0.025776506481459786
Bond Position:  [14.6680926]


portfolio before change:  [12.06110927]
curr_Stock_Price:  101.17352866606082
curr_Factors:  [101.17352867]
mat_Sqrt:  [[0.15]]
grads:  [0.02994828]
Stock Position:  0.02994828452271939
Bond Position:  [9.03113564]


portfolio before change:  [12.08457184]
curr_Stock_Price:  101.93811716001936
curr_Factors:  [101.93811716]
mat_Sqrt:  [[0.15]]
grads:  [0.07047511]
Stock Position:  0.0704751075159665
Bond Position:  [4.90047208]


portfolio before change:  [12.04943673]
curr_Stock_Price:  101.43522467875475
curr_Factors:  [101.43522468]
mat_Sqrt:  [[0.15]]
grads:  [0.13900261]
Stock Position:  0.13900260701107806
Bond Position:  [-2.05032394]


portfolio before change:  [12.10129173]
curr_Stock_Price:  101.80919715778991
curr_Factors:  [101.80919716]
mat_Sqrt:  [[0.15]]
grads:  [-0.00526693]
Stock Position:  -0.005266925029548166
Bond Position:  [12.63751314]


portfolio before change:  [12.10231771]
curr_Stock_Price:  101.76436816265652
curr_Factors:  [101.76436816]
mat_Sqrt:  [[0.15]]
grads:  [0.05138883]
Stock Position:  0.05138882819997941
Bond Position:  [6.87276608]


portfolio before change:  [12.09322278]
curr_Stock_Price:  101.57902643806742
curr_Factors:  [101.57902644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02549328]
Stock Position:  -0.025493284067666194
Bond Position:  [14.68280575]


portfolio before change:  [12.06951895]
curr_Stock_Price:  102.54483107566236
curr_Factors:  [102.54483108]
mat_Sqrt:  [[0.15]]
grads:  [0.12137755]
Stock Position:  0.12137754539170367
Bond Position:  [-0.37712094]


portfolio before change:  [12.04646171]
curr_Stock_Price:  102.3550623064437
curr_Factors:  [102.35506231]
mat_Sqrt:  [[0.15]]
grads:  [0.16418875]
Stock Position:  0.1641887474098149
Bond Position:  [-4.75908776]


portfolio before change:  [12.05223647]
curr_Stock_Price:  102.39204543215459
curr_Factors:  [102.39204543]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417793]
Stock Position:  -0.054177927644131534
Bond Position:  [17.5996253]


portfolio before change:  [12.05035675]
curr_Stock_Price:  102.44704451483257
curr_Factors:  [102.44704451]
mat_Sqrt:  [[0.15]]
grads:  [-0.00848526]
Stock Position:  -0.0084852619682436
Bond Position:  [12.91964676]


portfolio before change:  [12.04971072]
curr_Stock_Price:  102.61834525428834
curr_Factors:  [102.61834525]
mat_Sqrt:  [[0.15]]
grads:  [0.09289811]
Stock Position:  0.09289810957930231
Bond Position:  [2.51666044]


portfolio before change:  [12.07339511]
curr_Stock_Price:  102.87160227444967
curr_Factors:  [102.87160227]
mat_Sqrt:  [[0.15]]
grads:  [0.093302]
Stock Position:  0.0933020040053363
Bond Position:  [2.47526847]


portfolio before change:  [12.0679173]
curr_Stock_Price:  102.81123358104385
curr_Factors:  [102.81123358]
mat_Sqrt:  [[0.15]]
grads:  [-0.01345328]
Stock Position:  -0.01345327865571527
Bond Position:  [13.45106548]


portfolio before change:  [12.07512998]
curr_Stock_Price:  102.33759745235582
curr_Factors:  [102.33759745]
mat_Sqrt:  [[0.15]]
grads:  [0.03972035]
Stock Position:  0.03972035267108295
Bond Position:  [8.01024452]


portfolio before change:  [12.06541042]
curr_Stock_Price:  102.08029312653636
curr_Factors:  [102.08029313]
mat_Sqrt:  [[0.15]]
grads:  [0.0955907]
Stock Position:  0.09559070210471274
Bond Position:  [2.30748353]


portfolio before change:  [12.04372483]
curr_Stock_Price:  101.8519256203379
curr_Factors:  [101.85192562]
mat_Sqrt:  [[0.15]]
grads:  [-0.1765885]
Stock Position:  -0.1765884995788711
Bond Position:  [30.02960355]


portfolio before change:  [12.01329863]
curr_Stock_Price:  102.03485431016117
curr_Factors:  [102.03485431]
mat_Sqrt:  [[0.15]]
grads:  [-0.00600818]
Stock Position:  -0.006008176239323884
Bond Position:  [12.62634202]


portfolio before change:  [12.01553461]
curr_Stock_Price:  101.794049026882
curr_Factors:  [101.79404903]
mat_Sqrt:  [[0.15]]
grads:  [-0.26205125]
Stock Position:  -0.26205125040869903
Bond Position:  [38.69079244]


portfolio before change:  [11.99112424]
curr_Stock_Price:  101.89642828602047
curr_Factors:  [101.89642829]
mat_Sqrt:  [[0.15]]
grads:  [-0.06952618]
Stock Position:  -0.06952618144281833
Bond Position:  [19.0755938]


portfolio before change:  [11.99697515]
curr_Stock_Price:  101.8294225967919
curr_Factors:  [101.8294226]
mat_Sqrt:  [[0.15]]
grads:  [0.02806097]
Stock Position:  0.028060972501639116
Bond Position:  [9.13954253]


portfolio before change:  [11.96175959]
curr_Stock_Price:  100.55409949326574
curr_Factors:  [100.55409949]
mat_Sqrt:  [[0.15]]
grads:  [0.0157126]
Stock Position:  0.015712598009769964
Bond Position:  [10.38179344]


portfolio before change:  [11.96317946]
curr_Stock_Price:  100.60316780859962
curr_Factors:  [100.60316781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876147]
Stock Position:  -0.018761465421779994
Bond Position:  [13.85064231]


portfolio before change:  [11.96654836]
curr_Stock_Price:  100.46974510685499
curr_Factors:  [100.46974511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02829086]
Stock Position:  -0.028290861559689927
Bond Position:  [14.80892401]


portfolio before change:  [11.9508013]
curr_Stock_Price:  101.05907495925132
curr_Factors:  [101.05907496]
mat_Sqrt:  [[0.15]]
grads:  [0.12321279]
Stock Position:  0.1232127880396442
Bond Position:  [-0.50096909]


portfolio before change:  [11.94725164]
curr_Stock_Price:  101.03051994800984
curr_Factors:  [101.03051995]
mat_Sqrt:  [[0.15]]
grads:  [0.0938963]
Stock Position:  0.0938963033512911
Bond Position:  [2.46085929]


portfolio before change:  [12.03580246]
curr_Stock_Price:  101.97195223535789
curr_Factors:  [101.97195224]
mat_Sqrt:  [[0.15]]
grads:  [0.07081426]
Stock Position:  0.07081426344773674
Bond Position:  [4.81473377]


portfolio before change:  [12.01337109]
curr_Stock_Price:  101.65093920679747
curr_Factors:  [101.65093921]
mat_Sqrt:  [[0.15]]
grads:  [0.01127353]
Stock Position:  0.011273532113004019
Bond Position:  [10.86740596]


portfolio before change:  [12.01475956]
curr_Stock_Price:  101.71385039967726
curr_Factors:  [101.7138504]
mat_Sqrt:  [[0.15]]
grads:  [0.09824982]
Stock Position:  0.09824981549607958
Bond Position:  [2.02139252]


portfolio before change:  [12.06181051]
curr_Stock_Price:  102.19145551917747
curr_Factors:  [102.19145552]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786367]
Stock Position:  -0.007863674493457259
Bond Position:  [12.86541085]


portfolio before change:  [12.06504024]
curr_Stock_Price:  101.88299685089059
curr_Factors:  [101.88299685]
mat_Sqrt:  [[0.15]]
grads:  [0.11067148]
Stock Position:  0.11067148064637605
Bond Position:  [0.78949813]


portfolio before change:  [12.04026854]
curr_Stock_Price:  101.65872006056188
curr_Factors:  [101.65872006]
mat_Sqrt:  [[0.15]]
grads:  [-0.10768364]
Stock Position:  -0.10768363952734712
Bond Position:  [22.98724951]


portfolio before change:  [12.04143341]
curr_Stock_Price:  101.66124489505434
curr_Factors:  [101.6612449]
mat_Sqrt:  [[0.15]]
grads:  [0.00912345]
Stock Position:  0.009123454330107863
Bond Position:  [11.11393168]


portfolio before change:  [12.04845146]
curr_Stock_Price:  102.35433893934564
curr_Factors:  [102.35433894]
mat_Sqrt:  [[0.15]]
grads:  [-0.06103297]
Stock Position:  -0.061032967212876585
Bond Position:  [18.29544048]


portfolio before change:  [12.07218098]
curr_Stock_Price:  101.984276372088
curr_Factors:  [101.98427637]
mat_Sqrt:  [[0.15]]
grads:  [-0.02131742]
Stock Position:  -0.02131741834714736
Bond Position:  [14.24622247]


portfolio before change:  [12.04556962]
curr_Stock_Price:  103.27438441987267
curr_Factors:  [103.27438442]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013416]
Stock Position:  -0.020134158118153073
Bond Position:  [14.12491241]


portfolio before change:  [12.04211931]
curr_Stock_Price:  103.48959839684937
curr_Factors:  [103.4895984]
mat_Sqrt:  [[0.15]]
grads:  [0.06577005]
Stock Position:  0.0657700545389821
Bond Position:  [5.23560278]


portfolio before change:  [11.9909076]
curr_Stock_Price:  102.70597517844647
curr_Factors:  [102.70597518]
mat_Sqrt:  [[0.15]]
grads:  [-0.06462459]
Stock Position:  -0.06462459462069625
Bond Position:  [18.62823961]


portfolio before change:  [11.97183365]
curr_Stock_Price:  103.01914155970998
curr_Factors:  [103.01914156]
mat_Sqrt:  [[0.15]]
grads:  [0.03415306]
Stock Position:  0.03415305707004748
Bond Position:  [8.45341503]


portfolio before change:  [11.98357055]
curr_Stock_Price:  103.34732709002417
curr_Factors:  [103.34732709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456578]
Stock Position:  -0.024565781381948957
Bond Position:  [14.52237839]


portfolio before change:  [11.96486499]
curr_Stock_Price:  104.14572343219051
curr_Factors:  [104.14572343]
mat_Sqrt:  [[0.15]]
grads:  [-0.03203434]
Stock Position:  -0.03203433597619832
Bond Position:  [15.30110409]


portfolio before change:  [11.97972205]
curr_Stock_Price:  103.71179176306298
curr_Factors:  [103.71179176]
mat_Sqrt:  [[0.15]]
grads:  [0.03841688]
Stock Position:  0.03841688498162205
Bond Position:  [7.99543808]


portfolio before change:  [11.99190784]
curr_Stock_Price:  104.01598224893984
curr_Factors:  [104.01598225]
mat_Sqrt:  [[0.15]]
grads:  [-0.13262544]
Stock Position:  -0.1326254428334615
Bond Position:  [25.78707354]


portfolio before change:  [12.07726821]
curr_Stock_Price:  103.38451496544924
curr_Factors:  [103.38451497]
mat_Sqrt:  [[0.15]]
grads:  [0.01188163]
Stock Position:  0.01188162739236941
Bond Position:  [10.84889192]


portfolio before change:  [12.08393391]
curr_Stock_Price:  103.88845518310107
curr_Factors:  [103.88845518]
mat_Sqrt:  [[0.15]]
grads:  [0.11802842]
Stock Position:  0.11802842017215989
Bond Position:  [-0.17785633]


portfolio before change:  [12.1790958]
curr_Stock_Price:  104.69481187484473
curr_Factors:  [104.69481187]
mat_Sqrt:  [[0.15]]
grads:  [0.10305652]
Stock Position:  0.10305651529727412
Bond Position:  [1.38961332]


portfolio before change:  [12.13933245]
curr_Stock_Price:  104.30812885283375
curr_Factors:  [104.30812885]
mat_Sqrt:  [[0.15]]
grads:  [0.04092056]
Stock Position:  0.04092056396807483
Bond Position:  [7.87098499]


portfolio before change:  [12.12815756]
curr_Stock_Price:  104.02301920646752
curr_Factors:  [104.02301921]
mat_Sqrt:  [[0.15]]
grads:  [0.06918791]
Stock Position:  0.06918790536438164
Bond Position:  [4.93102275]


portfolio before change:  [12.17679755]
curr_Stock_Price:  104.72157767008042
curr_Factors:  [104.72157767]
mat_Sqrt:  [[0.15]]
grads:  [0.04748672]
Stock Position:  0.047486719674637884
Bond Position:  [7.20391335]


portfolio before change:  [12.18620279]
curr_Stock_Price:  104.91015630060845
curr_Factors:  [104.9101563]
mat_Sqrt:  [[0.15]]
grads:  [0.07354979]
Stock Position:  0.07354978594920387
Bond Position:  [4.47008325]


portfolio before change:  [12.14648542]
curr_Stock_Price:  104.36635105995897
curr_Factors:  [104.36635106]
mat_Sqrt:  [[0.15]]
grads:  [0.01255112]
Stock Position:  0.012551115463479045
Bond Position:  [10.8365713]


portfolio before change:  [12.13528808]
curr_Stock_Price:  103.42024835061203
curr_Factors:  [103.42024835]
mat_Sqrt:  [[0.15]]
grads:  [-0.10242113]
Stock Position:  -0.10242113289298452
Bond Position:  [22.72770708]


portfolio before change:  [12.13702771]
curr_Stock_Price:  103.4171327884354
curr_Factors:  [103.41713279]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902172]
Stock Position:  -0.01902172112023611
Bond Position:  [14.10419957]


portfolio before change:  [12.12896185]
curr_Stock_Price:  103.88751088436983
curr_Factors:  [103.88751088]
mat_Sqrt:  [[0.15]]
grads:  [0.00679676]
Stock Position:  0.006796756321253397
Bond Position:  [11.42286375]


portfolio before change:  [12.12823221]
curr_Stock_Price:  103.67511764129507
curr_Factors:  [103.67511764]
mat_Sqrt:  [[0.15]]
grads:  [0.02006339]
Stock Position:  0.02006338810502407
Bond Position:  [10.04815809]


portfolio before change:  [12.12143399]
curr_Stock_Price:  103.30497821515887
curr_Factors:  [103.30497822]
mat_Sqrt:  [[0.15]]
grads:  [-0.11294695]
Stock Position:  -0.11294694590492316
Bond Position:  [23.78941578]


portfolio before change:  [12.0519467]
curr_Stock_Price:  103.93336332127465
curr_Factors:  [103.93336332]
mat_Sqrt:  [[0.15]]
grads:  [-0.02430758]
Stock Position:  -0.024307583877071454
Bond Position:  [14.57831565]


portfolio before change:  [12.05127635]
curr_Stock_Price:  103.99842638110721
curr_Factors:  [103.99842638]
mat_Sqrt:  [[0.15]]
grads:  [0.07556225]
Stock Position:  0.07556224592856493
Bond Position:  [4.19292168]


portfolio before change:  [12.05565444]
curr_Stock_Price:  104.0528983597349
curr_Factors:  [104.05289836]
mat_Sqrt:  [[0.15]]
grads:  [-0.03787822]
Stock Position:  -0.03787822150887177
Bond Position:  [15.99699317]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.033128]
Stock Price:  104.67400140766328
PL:  [7.35912659]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.36323209e-02]
 [ 7.30942120e-03]
 [ 5.91668909e-03]
 [-5.96128470e-03]
 [ 1.20886001e-02]
 [-1.35496750e-02]
 [ 1.99846793e-03]
 [-5.52533291e-03]
 [-9.80207842e-03]
 [ 1.57503664e-03]
 [ 1.05336959e-02]
 [-1.76106437e-03]
 [-1.20982257e-03]
 [ 6.17009949e-03]
 [ 1.18190463e-04]
 [ 1.11139258e-02]
 [ 2.26016926e-02]
 [-1.51945355e-02]
 [ 2.15079067e-02]
 [ 1.67985752e-03]
 [-4.34707896e-03]
 [ 5.41698617e-03]
 [ 1.65307547e-02]
 [ 2.08875121e-02]
 [ 3.33577428e-03]
 [ 4.43202842e-03]
 [ 3.24371497e-04]
 [ 1.19109219e-02]
 [-1.35594252e-02]
 [ 7.94501460e-02]
 [-6.05399693e-03]
 [ 3.01457410e-02]
 [ 1.42507148e-02]
 [-1.91913967e-02]
 [-1.74099612e-02]
 [-5.29511277e-02]
 [ 1.61688100e-02]
 [-7.35857556e-03]
 [ 4.60489176e-02]
 [ 2.39684344e-02]
 [ 6.70956122e-03]
 [ 3.57587220e-02]
 [-3.37005530e-03]
 [ 1.01849465e-02]
 [-2.73529662e-02]
 [ 2.36800637e-02]
 [ 9.01995612e-03]
 [ 5.39017825e-03]
 [-8.87234667e-03]
 [-8.94253224e-05]
 [-3.12118616e-03]
 [-2.61930108e-03]
 [-4.50533043e-04]
 [ 4.56519980e-03]
 [-1.23766313e-02]
 [-5.27011046e-03]
 [-4.51045244e-03]
 [ 1.35643635e-02]
 [ 6.74356795e-03]
 [-2.62006126e-03]
 [-5.13455545e-03]
 [-3.70646641e-03]
 [ 1.51166206e-03]
 [-8.27749146e-03]
 [ 1.64268929e-02]
 [ 1.10688397e-02]
 [ 2.05776008e-02]
 [-4.88174455e-03]
 [ 8.35865958e-03]
 [ 2.87122703e-02]
 [ 3.10570065e-03]
 [-1.52634957e-02]
 [-5.79066633e-03]
 [ 2.07222411e-03]
 [ 9.86867445e-03]
 [ 3.19672418e-03]
 [-1.45844879e-03]
 [-1.57945829e-02]
 [-2.66773797e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.20924541]
curr_Stock_Price:  99.62579437616321
curr_Factors:  [99.62579438]
mat_Sqrt:  [[0.15]]
grads:  [-0.09088214]
Stock Position:  -0.0908821390977326
Bond Position:  [2.84495989]


portfolio before change:  [-6.22863978]
curr_Stock_Price:  99.84115230055792
curr_Factors:  [99.8411523]
mat_Sqrt:  [[0.15]]
grads:  [0.04872947]
Stock Position:  0.04872947465554895
Bond Position:  [-11.09384668]


portfolio before change:  [-6.21256013]
curr_Stock_Price:  100.18535959349245
curr_Factors:  [100.18535959]
mat_Sqrt:  [[0.15]]
grads:  [0.03944459]
Stock Position:  0.03944459394151674
Bond Position:  [-10.16433096]


portfolio before change:  [-6.21329566]
curr_Stock_Price:  100.1828184192291
curr_Factors:  [100.18281842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0397419]
Stock Position:  -0.03974189798510298
Bond Position:  [-2.23184031]


portfolio before change:  [-6.17561004]
curr_Stock_Price:  99.23104934997815
curr_Factors:  [99.23104935]
mat_Sqrt:  [[0.15]]
grads:  [0.08059067]
Stock Position:  0.08059066723224706
Bond Position:  [-14.17270652]


portfolio before change:  [-6.17599376]
curr_Stock_Price:  99.23727969226788
curr_Factors:  [99.23727969]
mat_Sqrt:  [[0.15]]
grads:  [-0.09033117]
Stock Position:  -0.09033116699950898
Bond Position:  [2.78822553]


portfolio before change:  [-6.22237127]
curr_Stock_Price:  99.75262539780415
curr_Factors:  [99.7526254]
mat_Sqrt:  [[0.15]]
grads:  [0.01332312]
Stock Position:  0.013323119554932532
Bond Position:  [-7.55138742]


portfolio before change:  [-6.22109486]
curr_Stock_Price:  99.88385448895576
curr_Factors:  [99.88385449]
mat_Sqrt:  [[0.15]]
grads:  [-0.03683555]
Stock Position:  -0.0368355527480633
Bond Position:  [-2.54181787]


portfolio before change:  [-6.21504133]
curr_Stock_Price:  99.715202188932
curr_Factors:  [99.71520219]
mat_Sqrt:  [[0.15]]
grads:  [-0.06534719]
Stock Position:  -0.0653471894871628
Bond Position:  [0.30106688]


portfolio before change:  [-6.26706556]
curr_Stock_Price:  100.51161057542068
curr_Factors:  [100.51161058]
mat_Sqrt:  [[0.15]]
grads:  [0.01050024]
Stock Position:  0.01050024426139877
Bond Position:  [-7.32246202]


portfolio before change:  [-6.2707861]
curr_Stock_Price:  100.20086812135088
curr_Factors:  [100.20086812]
mat_Sqrt:  [[0.15]]
grads:  [0.07022464]
Stock Position:  0.07022463947397102
Bond Position:  [-13.30735594]


portfolio before change:  [-6.26586477]
curr_Stock_Price:  100.28279192160674
curr_Factors:  [100.28279192]
mat_Sqrt:  [[0.15]]
grads:  [-0.01174043]
Stock Position:  -0.011740429160865934
Bond Position:  [-5.08850175]


portfolio before change:  [-6.2588926]
curr_Stock_Price:  99.66184267913094
curr_Factors:  [99.66184268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00806548]
Stock Position:  -0.008065483777426458
Bond Position:  [-5.45507162]


portfolio before change:  [-6.25656536]
curr_Stock_Price:  99.33102649603036
curr_Factors:  [99.3310265]
mat_Sqrt:  [[0.15]]
grads:  [0.041134]
Stock Position:  0.04113399658429655
Bond Position:  [-10.34244746]


portfolio before change:  [-6.25062418]
curr_Stock_Price:  99.49117620763238
curr_Factors:  [99.49117621]
mat_Sqrt:  [[0.15]]
grads:  [0.00078794]
Stock Position:  0.0007879364179552244
Bond Position:  [-6.3290169]


portfolio before change:  [-6.25121287]
curr_Stock_Price:  99.24609564496916
curr_Factors:  [99.24609564]
mat_Sqrt:  [[0.15]]
grads:  [0.07409284]
Stock Position:  0.07409283879424944
Bond Position:  [-13.60463783]


portfolio before change:  [-6.24440174]
curr_Stock_Price:  99.34949888553349
curr_Factors:  [99.34949889]
mat_Sqrt:  [[0.15]]
grads:  [0.15067795]
Stock Position:  0.15067795076590226
Bond Position:  [-21.21418065]


portfolio before change:  [-6.22662043]
curr_Stock_Price:  99.47630736325851
curr_Factors:  [99.47630736]
mat_Sqrt:  [[0.15]]
grads:  [-0.1012969]
Stock Position:  -0.10129690353560421
Bond Position:  [3.85002148]


portfolio before change:  [-6.22188403]
curr_Stock_Price:  99.43192529552668
curr_Factors:  [99.4319253]
mat_Sqrt:  [[0.15]]
grads:  [0.14338604]
Stock Position:  0.14338604435086771
Bond Position:  [-20.47903448]


portfolio before change:  [-6.23690286]
curr_Stock_Price:  99.33610807136517
curr_Factors:  [99.33610807]
mat_Sqrt:  [[0.15]]
grads:  [0.01119905]
Stock Position:  0.011199050165067087
Bond Position:  [-7.34937292]


portfolio before change:  [-6.23944661]
curr_Stock_Price:  99.14998580304156
curr_Factors:  [99.1499858]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898053]
Stock Position:  -0.02898052639937279
Bond Position:  [-3.36602782]


portfolio before change:  [-6.22583639]
curr_Stock_Price:  98.67309319308372
curr_Factors:  [98.67309319]
mat_Sqrt:  [[0.15]]
grads:  [0.03611324]
Stock Position:  0.036113241162811824
Bond Position:  [-9.7892416]


portfolio before change:  [-6.22829313]
curr_Stock_Price:  98.6220068718439
curr_Factors:  [98.62200687]
mat_Sqrt:  [[0.15]]
grads:  [0.11020503]
Stock Position:  0.11020503139717072
Bond Position:  [-17.09693449]


portfolio before change:  [-6.3186343]
curr_Stock_Price:  97.81194785985205
curr_Factors:  [97.81194786]
mat_Sqrt:  [[0.15]]
grads:  [0.13925008]
Stock Position:  0.13925008037391853
Bond Position:  [-19.9389559]


portfolio before change:  [-6.39857175]
curr_Stock_Price:  97.24684065267843
curr_Factors:  [97.24684065]
mat_Sqrt:  [[0.15]]
grads:  [0.0222385]
Stock Position:  0.022238495194081474
Bond Position:  [-8.56119515]


portfolio before change:  [-6.41071737]
curr_Stock_Price:  96.7247491543866
curr_Factors:  [96.72474915]
mat_Sqrt:  [[0.15]]
grads:  [0.02954686]
Stock Position:  0.029546856106042175
Bond Position:  [-9.26862961]


portfolio before change:  [-6.42051691]
curr_Stock_Price:  96.41269445482625
curr_Factors:  [96.41269445]
mat_Sqrt:  [[0.15]]
grads:  [0.00216248]
Stock Position:  0.0021624766440472266
Bond Position:  [-6.62900711]


portfolio before change:  [-6.41995239]
curr_Stock_Price:  96.86534315981304
curr_Factors:  [96.86534316]
mat_Sqrt:  [[0.15]]
grads:  [0.07940615]
Stock Position:  0.07940614610739487
Bond Position:  [-14.11165599]


portfolio before change:  [-6.48188412]
curr_Stock_Price:  96.09651454842223
curr_Factors:  [96.09651455]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039617]
Stock Position:  -0.09039616812592513
Bond Position:  [2.20487257]


portfolio before change:  [-6.39680774]
curr_Stock_Price:  95.15688873135757
curr_Factors:  [95.15688873]
mat_Sqrt:  [[0.15]]
grads:  [0.52966764]
Stock Position:  0.52966763988454
Bond Position:  [-56.79833241]


portfolio before change:  [-6.51452684]
curr_Stock_Price:  94.94134016625446
curr_Factors:  [94.94134017]
mat_Sqrt:  [[0.15]]
grads:  [-0.04035998]
Stock Position:  -0.040359979507560505
Bond Position:  [-2.6826963]


portfolio before change:  [-6.50560405]
curr_Stock_Price:  94.71610545704601
curr_Factors:  [94.71610546]
mat_Sqrt:  [[0.15]]
grads:  [0.20097161]
Stock Position:  0.20097160665478736
Bond Position:  [-25.54085194]


portfolio before change:  [-6.57909021]
curr_Stock_Price:  94.35839418357118
curr_Factors:  [94.35839418]
mat_Sqrt:  [[0.15]]
grads:  [0.09500477]
Stock Position:  0.0950047655091718
Bond Position:  [-15.54358732]


portfolio before change:  [-6.52547282]
curr_Stock_Price:  94.93298527392587
curr_Factors:  [94.93298527]
mat_Sqrt:  [[0.15]]
grads:  [-0.12794264]
Stock Position:  -0.1279426449468488
Bond Position:  [5.62050441]


portfolio before change:  [-6.53383119]
curr_Stock_Price:  95.00105999082463
curr_Factors:  [95.00105999]
mat_Sqrt:  [[0.15]]
grads:  [-0.11606641]
Stock Position:  -0.11606640789180982
Bond Position:  [4.49260059]


portfolio before change:  [-6.54082664]
curr_Stock_Price:  95.06375038789503
curr_Factors:  [95.06375039]
mat_Sqrt:  [[0.15]]
grads:  [-0.35300752]
Stock Position:  -0.35300751823212656
Bond Position:  [27.01739196]


portfolio before change:  [-6.40434853]
curr_Stock_Price:  94.68191865149176
curr_Factors:  [94.68191865]
mat_Sqrt:  [[0.15]]
grads:  [0.10779207]
Stock Position:  0.10779206649712561
Bond Position:  [-16.6103082]


portfolio before change:  [-6.42481026]
curr_Stock_Price:  94.50172404006545
curr_Factors:  [94.50172404]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905717]
Stock Position:  -0.049057170381038295
Bond Position:  [-1.78882308]


portfolio before change:  [-6.4526032]
curr_Stock_Price:  95.06598687154805
curr_Factors:  [95.06598687]
mat_Sqrt:  [[0.15]]
grads:  [0.30699278]
Stock Position:  0.3069927837820029
Bond Position:  [-35.63717515]


portfolio before change:  [-6.59366162]
curr_Stock_Price:  94.61375792239858
curr_Factors:  [94.61375792]
mat_Sqrt:  [[0.15]]
grads:  [0.15978956]
Stock Position:  0.15978956253274493
Bond Position:  [-21.7119526]


portfolio before change:  [-6.45967522]
curr_Stock_Price:  95.46076839861429
curr_Factors:  [95.4607684]
mat_Sqrt:  [[0.15]]
grads:  [0.04473041]
Stock Position:  0.04473040812218443
Bond Position:  [-10.72967435]


portfolio before change:  [-6.46226921]
curr_Stock_Price:  95.41776943074468
curr_Factors:  [95.41776943]
mat_Sqrt:  [[0.15]]
grads:  [0.23839148]
Stock Position:  0.23839147975439678
Bond Position:  [-29.20905246]


portfolio before change:  [-6.26377367]
curr_Stock_Price:  96.25807280964021
curr_Factors:  [96.25807281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246704]
Stock Position:  -0.022467035366250516
Bond Position:  [-4.10114014]


portfolio before change:  [-6.27176819]
curr_Stock_Price:  96.6024971975604
curr_Factors:  [96.6024972]
mat_Sqrt:  [[0.15]]
grads:  [0.06789964]
Stock Position:  0.06789964364744185
Bond Position:  [-12.83104332]


portfolio before change:  [-6.25761967]
curr_Stock_Price:  96.82268219485117
curr_Factors:  [96.82268219]
mat_Sqrt:  [[0.15]]
grads:  [-0.18235311]
Stock Position:  -0.18235310792741957
Bond Position:  [11.39829734]


portfolio before change:  [-5.9452027]
curr_Stock_Price:  95.11333617481264
curr_Factors:  [95.11333617]
mat_Sqrt:  [[0.15]]
grads:  [0.15786709]
Stock Position:  0.15786709125913978
Bond Position:  [-20.96046842]


portfolio before change:  [-5.95636452]
curr_Stock_Price:  95.05093078940168
curr_Factors:  [95.05093079]
mat_Sqrt:  [[0.15]]
grads:  [0.06013304]
Stock Position:  0.06013304082878954
Bond Position:  [-11.67206603]


portfolio before change:  [-5.95340455]
curr_Stock_Price:  95.1122864592604
curr_Factors:  [95.11228646]
mat_Sqrt:  [[0.15]]
grads:  [0.03593452]
Stock Position:  0.03593452164653139
Bond Position:  [-9.37121906]


portfolio before change:  [-5.94066228]
curr_Stock_Price:  95.48318299803474
curr_Factors:  [95.483183]
mat_Sqrt:  [[0.15]]
grads:  [-0.05914898]
Stock Position:  -0.059148977800653146
Bond Position:  [-0.29292961]


portfolio before change:  [-5.97747719]
curr_Stock_Price:  96.10528335315054
curr_Factors:  [96.10528335]
mat_Sqrt:  [[0.15]]
grads:  [-0.00059617]
Stock Position:  -0.0005961688161228249
Bond Position:  [-5.92018221]


portfolio before change:  [-5.97775298]
curr_Stock_Price:  95.94723175659561
curr_Factors:  [95.94723176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02080791]
Stock Position:  -0.020807907739952905
Bond Position:  [-3.98129184]


portfolio before change:  [-5.97030006]
curr_Stock_Price:  95.57709532349551
curr_Factors:  [95.57709532]
mat_Sqrt:  [[0.15]]
grads:  [-0.01746201]
Stock Position:  -0.017462007175412103
Bond Position:  [-4.30133213]


portfolio before change:  [-5.96908644]
curr_Stock_Price:  95.49219913389499
curr_Factors:  [95.49219913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00300355]
Stock Position:  -0.003003553620823003
Bond Position:  [-5.6822705]


portfolio before change:  [-5.96707321]
curr_Stock_Price:  94.70367036483523
curr_Factors:  [94.70367036]
mat_Sqrt:  [[0.15]]
grads:  [0.03043467]
Stock Position:  0.03043466533787133
Bond Position:  [-8.84934772]


portfolio before change:  [-5.93552031]
curr_Stock_Price:  95.75858579697609
curr_Factors:  [95.7585858]
mat_Sqrt:  [[0.15]]
grads:  [-0.08251088]
Stock Position:  -0.08251087511745406
Bond Position:  [1.9656044]


portfolio before change:  [-5.87387732]
curr_Stock_Price:  95.01298552542112
curr_Factors:  [95.01298553]
mat_Sqrt:  [[0.15]]
grads:  [-0.03513407]
Stock Position:  -0.03513406973218526
Bond Position:  [-2.53568447]


portfolio before change:  [-5.85692268]
curr_Stock_Price:  94.52590486813052
curr_Factors:  [94.52590487]
mat_Sqrt:  [[0.15]]
grads:  [-0.03006968]
Stock Position:  -0.030069682952574818
Bond Position:  [-3.01455869]


portfolio before change:  [-5.8754073]
curr_Stock_Price:  95.13436476604622
curr_Factors:  [95.13436477]
mat_Sqrt:  [[0.15]]
grads:  [0.09042909]
Stock Position:  0.09042909008687094
Bond Position:  [-14.47832134]


portfolio before change:  [-5.85257601]
curr_Stock_Price:  95.3968490079413
curr_Factors:  [95.39684901]
mat_Sqrt:  [[0.15]]
grads:  [0.04495712]
Stock Position:  0.044957119691408774
Bond Position:  [-10.14134357]


portfolio before change:  [-5.85510009]
curr_Stock_Price:  95.35480396589405
curr_Factors:  [95.35480397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01746708]
Stock Position:  -0.017467075076657776
Bond Position:  [-4.18953057]


portfolio before change:  [-5.84663591]
curr_Stock_Price:  94.855233577984
curr_Factors:  [94.85523358]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423037]
Stock Position:  -0.0342303696749413
Bond Position:  [-2.5997062]


portfolio before change:  [-5.81894812]
curr_Stock_Price:  94.04162068884217
curr_Factors:  [94.04162069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02470978]
Stock Position:  -0.02470977606054697
Bond Position:  [-3.49520074]


portfolio before change:  [-5.81229817]
curr_Stock_Price:  93.76365723762504
curr_Factors:  [93.76365724]
mat_Sqrt:  [[0.15]]
grads:  [0.01007775]
Stock Position:  0.010077747092496609
Bond Position:  [-6.75722459]


portfolio before change:  [-5.82278578]
curr_Stock_Price:  92.76489431410597
curr_Factors:  [92.76489431]
mat_Sqrt:  [[0.15]]
grads:  [-0.05518328]
Stock Position:  -0.055183276384087494
Bond Position:  [-0.70371498]


portfolio before change:  [-5.82141687]
curr_Stock_Price:  92.73929065552322
curr_Factors:  [92.73929066]
mat_Sqrt:  [[0.15]]
grads:  [0.10951262]
Stock Position:  0.10951261961498619
Bond Position:  [-15.97753954]


portfolio before change:  [-5.8487238]
curr_Stock_Price:  92.49905993283048
curr_Factors:  [92.49905993]
mat_Sqrt:  [[0.15]]
grads:  [0.07379226]
Stock Position:  0.0737922643483338
Bond Position:  [-12.67443888]


portfolio before change:  [-5.82166578]
curr_Stock_Price:  92.8764733616755
curr_Factors:  [92.87647336]
mat_Sqrt:  [[0.15]]
grads:  [0.13718401]
Stock Position:  0.137184005546786
Bond Position:  [-18.56283242]


portfolio before change:  [-5.64414423]
curr_Stock_Price:  94.17897041291569
curr_Factors:  [94.17897041]
mat_Sqrt:  [[0.15]]
grads:  [-0.03254496]
Stock Position:  -0.03254496365030338
Bond Position:  [-2.57909307]


portfolio before change:  [-5.64410722]
curr_Stock_Price:  94.17288002744067
curr_Factors:  [94.17288003]
mat_Sqrt:  [[0.15]]
grads:  [0.0557244]
Stock Position:  0.0557243971960486
Bond Position:  [-10.89183419]


portfolio before change:  [-5.64016438]
curr_Stock_Price:  94.25585276234042
curr_Factors:  [94.25585276]
mat_Sqrt:  [[0.15]]
grads:  [0.19141514]
Stock Position:  0.1914151354088838
Bond Position:  [-23.6821612]


portfolio before change:  [-5.45366098]
curr_Stock_Price:  95.23792545699196
curr_Factors:  [95.23792546]
mat_Sqrt:  [[0.15]]
grads:  [0.02070467]
Stock Position:  0.020704671029053056
Bond Position:  [-7.4255309]


portfolio before change:  [-5.45325151]
curr_Stock_Price:  95.28011793067313
curr_Factors:  [95.28011793]
mat_Sqrt:  [[0.15]]
grads:  [-0.10175664]
Stock Position:  -0.10175663790948618
Bond Position:  [4.24213295]


portfolio before change:  [-5.46385693]
curr_Stock_Price:  95.38694697726739
curr_Factors:  [95.38694698]
mat_Sqrt:  [[0.15]]
grads:  [-0.03860444]
Stock Position:  -0.038604442232902686
Bond Position:  [-1.78149705]


portfolio before change:  [-5.4941894]
curr_Stock_Price:  96.16978759975635
curr_Factors:  [96.1697876]
mat_Sqrt:  [[0.15]]
grads:  [0.01381483]
Stock Position:  0.01381482741151491
Bond Position:  [-6.82275842]


portfolio before change:  [-5.48767154]
curr_Stock_Price:  96.6724579173493
curr_Factors:  [96.67245792]
mat_Sqrt:  [[0.15]]
grads:  [0.06579116]
Stock Position:  0.06579116299355067
Bond Position:  [-11.84786497]


portfolio before change:  [-5.50283053]
curr_Stock_Price:  96.45330270512902
curr_Factors:  [96.45330271]
mat_Sqrt:  [[0.15]]
grads:  [0.02131149]
Stock Position:  0.021311494507922787
Bond Position:  [-7.55839456]


portfolio before change:  [-5.51203032]
curr_Stock_Price:  96.04378782027929
curr_Factors:  [96.04378782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00972299]
Stock Position:  -0.009722991949146133
Bond Position:  [-4.57819734]


portfolio before change:  [-5.5105543]
curr_Stock_Price:  95.86255103462504
curr_Factors:  [95.86255103]
mat_Sqrt:  [[0.15]]
grads:  [-0.10529722]
Stock Position:  -0.10529721948022197
Bond Position:  [4.58350578]


portfolio before change:  [-5.53876357]
curr_Stock_Price:  96.1331731214169
curr_Factors:  [96.13317312]
mat_Sqrt:  [[0.15]]
grads:  [-0.1778492]
Stock Position:  -0.1778491978550675
Bond Position:  [11.55844415]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.52476559]
Stock Price:  96.05852807473727
PL:  [-5.52476559]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.55419552e-03]
 [ 1.20188650e-02]
 [ 6.87045545e-03]
 [-9.25085485e-03]
 [-1.52860110e-03]
 [-2.12861606e-03]
 [-7.36542282e-03]
 [-2.08955843e-02]
 [ 7.96405149e-03]
 [-4.84305345e-03]
 [-6.95860446e-03]
 [ 1.27355847e-03]
 [-2.14179504e-03]
 [ 7.85528545e-03]
 [-9.20715411e-04]
 [ 1.37999898e-02]
 [ 3.99272661e-02]
 [-1.47277047e-02]
 [ 2.06486689e-02]
 [ 1.81915917e-03]
 [-3.70278554e-03]
 [ 5.40677983e-03]
 [ 1.63453881e-02]
 [ 2.01670517e-02]
 [-4.17958153e-03]
 [ 4.52408031e-03]
 [ 7.66876868e-03]
 [ 8.76909777e-03]
 [ 1.61364007e-02]
 [ 2.98918544e-02]
 [-6.53062462e-03]
 [ 1.22945834e-02]
 [ 1.14893565e-02]
 [-2.03086081e-02]
 [-7.81281264e-03]
 [ 1.81748400e-02]
 [ 5.49382611e-03]
 [-5.63214723e-04]
 [-3.19020702e-02]
 [-1.70817993e-02]
 [ 7.14086871e-03]
 [ 2.67957500e-02]
 [-2.24059264e-03]
 [-2.16957299e-03]
 [ 1.46599285e-02]
 [ 1.53447700e-02]
 [ 1.07336117e-02]
 [ 4.00956209e-03]
 [ 7.97512237e-03]
 [-2.30122483e-03]
 [-6.49234397e-03]
 [-3.63018408e-03]
 [ 1.42423833e-03]
 [ 8.00785776e-03]
 [-6.97763456e-03]
 [-4.06705743e-03]
 [ 5.19881652e-03]
 [ 5.34279472e-03]
 [ 7.11736411e-03]
 [-4.03562439e-03]
 [-2.34606740e-04]
 [ 5.27574723e-03]
 [-6.31717037e-03]
 [ 1.49103880e-03]
 [ 1.98088811e-02]
 [ 5.22713389e-03]
 [ 8.06009522e-03]
 [-1.16448128e-03]
 [ 2.82343519e-03]
 [ 2.02288854e-02]
 [ 1.72880483e-03]
 [-1.59245957e-02]
 [-6.42169459e-03]
 [ 9.96731999e-04]
 [ 8.00295525e-03]
 [ 1.12084034e-03]
 [-1.60307840e-03]
 [-8.65346437e-03]
 [-2.52863858e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.41134757]
curr_Stock_Price:  100.42608559965247
curr_Factors:  [100.4260856]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369464]
Stock Position:  -0.023694636822513684
Bond Position:  [13.79090719]


portfolio before change:  [11.42098549]
curr_Stock_Price:  100.05570797065785
curr_Factors:  [100.05570797]
mat_Sqrt:  [[0.15]]
grads:  [0.08012577]
Stock Position:  0.08012576668360706
Bond Position:  [3.40394518]


portfolio before change:  [11.37837504]
curr_Stock_Price:  99.521258077409
curr_Factors:  [99.52125808]
mat_Sqrt:  [[0.15]]
grads:  [0.04580304]
Stock Position:  0.04580303634594318
Bond Position:  [6.81999924]


portfolio before change:  [11.41758837]
curr_Stock_Price:  100.36808118097343
curr_Factors:  [100.36808118]
mat_Sqrt:  [[0.15]]
grads:  [-0.06167237]
Stock Position:  -0.06167236566647259
Bond Position:  [17.60752537]


portfolio before change:  [11.40630676]
curr_Stock_Price:  100.56885369075971
curr_Factors:  [100.56885369]
mat_Sqrt:  [[0.15]]
grads:  [-0.01019067]
Stock Position:  -0.010190674021773004
Bond Position:  [12.43117116]


portfolio before change:  [11.40756337]
curr_Stock_Price:  100.52178719117843
curr_Factors:  [100.52178719]
mat_Sqrt:  [[0.15]]
grads:  [-0.01419077]
Stock Position:  -0.014190773714348917
Bond Position:  [12.83404531]


portfolio before change:  [11.4054308]
curr_Stock_Price:  100.72859253867392
curr_Factors:  [100.72859254]
mat_Sqrt:  [[0.15]]
grads:  [-0.04910282]
Stock Position:  -0.049102818776033265
Bond Position:  [16.35148862]


portfolio before change:  [11.4120032]
curr_Stock_Price:  100.61555623468387
curr_Factors:  [100.61555623]
mat_Sqrt:  [[0.15]]
grads:  [-0.1393039]
Stock Position:  -0.1393038955680915
Bond Position:  [25.42814213]


portfolio before change:  [11.37819732]
curr_Stock_Price:  100.86964234123153
curr_Factors:  [100.86964234]
mat_Sqrt:  [[0.15]]
grads:  [0.05309368]
Stock Position:  0.053093676606981215
Bond Position:  [6.02265715]


portfolio before change:  [11.41549114]
curr_Stock_Price:  101.56496787635942
curr_Factors:  [101.56496788]
mat_Sqrt:  [[0.15]]
grads:  [-0.03228702]
Stock Position:  -0.03228702300842873
Bond Position:  [14.69472159]


portfolio before change:  [11.43035654]
curr_Stock_Price:  101.13300000878884
curr_Factors:  [101.13300001]
mat_Sqrt:  [[0.15]]
grads:  [-0.0463907]
Stock Position:  -0.046390696409277205
Bond Position:  [16.12198684]


portfolio before change:  [11.45394667]
curr_Stock_Price:  100.64621120281133
curr_Factors:  [100.6462112]
mat_Sqrt:  [[0.15]]
grads:  [0.00849039]
Stock Position:  0.00849038977866089
Bond Position:  [10.59942111]


portfolio before change:  [11.44978329]
curr_Stock_Price:  100.07781946230696
curr_Factors:  [100.07781946]
mat_Sqrt:  [[0.15]]
grads:  [-0.01427863]
Stock Position:  -0.014278633631014925
Bond Position:  [12.87875781]


portfolio before change:  [11.44486432]
curr_Stock_Price:  100.47869192098779
curr_Factors:  [100.47869192]
mat_Sqrt:  [[0.15]]
grads:  [0.05236857]
Stock Position:  0.052368569636787383
Bond Position:  [6.18293895]


portfolio before change:  [11.42146347]
curr_Stock_Price:  100.02446337248917
curr_Factors:  [100.02446337]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061381]
Stock Position:  -0.00613810273923846
Bond Position:  [12.0354239]


portfolio before change:  [11.42054502]
curr_Stock_Price:  100.29664663217422
curr_Factors:  [100.29664663]
mat_Sqrt:  [[0.15]]
grads:  [0.09199993]
Stock Position:  0.09199993224331972
Bond Position:  [2.19326032]


portfolio before change:  [11.42987541]
curr_Stock_Price:  100.39657394485921
curr_Factors:  [100.39657394]
mat_Sqrt:  [[0.15]]
grads:  [0.26618177]
Stock Position:  0.2661817737362659
Bond Position:  [-15.29386272]


portfolio before change:  [11.3612756]
curr_Stock_Price:  100.14244719831315
curr_Factors:  [100.1424472]
mat_Sqrt:  [[0.15]]
grads:  [-0.0981847]
Stock Position:  -0.09818469793224857
Bond Position:  [21.19373153]


portfolio before change:  [11.41248193]
curr_Stock_Price:  99.63440794610827
curr_Factors:  [99.63440795]
mat_Sqrt:  [[0.15]]
grads:  [0.13765779]
Stock Position:  0.13765779280360377
Bond Position:  [-2.30297075]


portfolio before change:  [11.3817692]
curr_Stock_Price:  99.41234429905498
curr_Factors:  [99.4123443]
mat_Sqrt:  [[0.15]]
grads:  [0.01212773]
Stock Position:  0.012127727824919356
Bond Position:  [10.17612335]


portfolio before change:  [11.38427731]
curr_Stock_Price:  99.5667075489908
curr_Factors:  [99.56670755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02468524]
Stock Position:  -0.024685236949141195
Bond Position:  [13.84210507]


portfolio before change:  [11.40510061]
curr_Stock_Price:  98.75820221402351
curr_Factors:  [98.75820221]
mat_Sqrt:  [[0.15]]
grads:  [0.0360452]
Stock Position:  0.036045198896917645
Bond Position:  [7.84534157]


portfolio before change:  [11.39906113]
curr_Stock_Price:  98.57704553935096
curr_Factors:  [98.57704554]
mat_Sqrt:  [[0.15]]
grads:  [0.10896925]
Stock Position:  0.1089692538203699
Bond Position:  [0.65719403]


portfolio before change:  [11.34784481]
curr_Stock_Price:  98.10666155962306
curr_Factors:  [98.10666156]
mat_Sqrt:  [[0.15]]
grads:  [0.13444701]
Stock Position:  0.13444701106038812
Bond Position:  [-1.8423026]


portfolio before change:  [11.3859461]
curr_Stock_Price:  98.39091060678625
curr_Factors:  [98.39091061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786388]
Stock Position:  -0.02786387687548874
Bond Position:  [14.12749832]


portfolio before change:  [11.39071924]
curr_Stock_Price:  98.25129807782155
curr_Factors:  [98.25129808]
mat_Sqrt:  [[0.15]]
grads:  [0.03016054]
Stock Position:  0.0301605353667004
Bond Position:  [8.42740749]


portfolio before change:  [11.39313108]
curr_Stock_Price:  98.3138005088325
curr_Factors:  [98.31380051]
mat_Sqrt:  [[0.15]]
grads:  [0.05112512]
Stock Position:  0.05112512452213389
Bond Position:  [6.36682579]


portfolio before change:  [11.39484334]
curr_Stock_Price:  98.3395084480233
curr_Factors:  [98.33950845]
mat_Sqrt:  [[0.15]]
grads:  [0.05846065]
Stock Position:  0.0584606517770388
Bond Position:  [5.64585158]


portfolio before change:  [11.33768312]
curr_Stock_Price:  97.35571688673232
curr_Factors:  [97.35571689]
mat_Sqrt:  [[0.15]]
grads:  [0.107576]
Stock Position:  0.10757600460533419
Bond Position:  [0.86454407]


portfolio before change:  [11.3424507]
curr_Stock_Price:  97.39953282502454
curr_Factors:  [97.39953283]
mat_Sqrt:  [[0.15]]
grads:  [0.19927903]
Stock Position:  0.19927902950096518
Bond Position:  [-8.06723367]


portfolio before change:  [11.45039915]
curr_Stock_Price:  97.94375803181293
curr_Factors:  [97.94375803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0435375]
Stock Position:  -0.04353749747959783
Bond Position:  [15.71462527]


portfolio before change:  [11.42435047]
curr_Stock_Price:  98.56462227147553
curr_Factors:  [98.56462227]
mat_Sqrt:  [[0.15]]
grads:  [0.08196389]
Stock Position:  0.08196388911264799
Bond Position:  [3.3456107]


portfolio before change:  [11.39413244]
curr_Stock_Price:  98.19339608912992
curr_Factors:  [98.19339609]
mat_Sqrt:  [[0.15]]
grads:  [0.07659571]
Stock Position:  0.07659571010114652
Bond Position:  [3.87293954]


portfolio before change:  [11.37200687]
curr_Stock_Price:  97.9013740243627
curr_Factors:  [97.90137402]
mat_Sqrt:  [[0.15]]
grads:  [-0.13539072]
Stock Position:  -0.13539072084143772
Bond Position:  [24.62694447]


portfolio before change:  [11.41998668]
curr_Stock_Price:  97.55836248602908
curr_Factors:  [97.55836249]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208542]
Stock Position:  -0.052085417575192666
Bond Position:  [16.50135473]


portfolio before change:  [11.38605383]
curr_Stock_Price:  98.22964856249801
curr_Factors:  [98.22964856]
mat_Sqrt:  [[0.15]]
grads:  [0.1211656]
Stock Position:  0.12116559984470947
Bond Position:  [-0.51600046]


portfolio before change:  [11.38951417]
curr_Stock_Price:  98.25847349711928
curr_Factors:  [98.2584735]
mat_Sqrt:  [[0.15]]
grads:  [0.03662551]
Stock Position:  0.03662550738401268
Bond Position:  [7.79074772]


portfolio before change:  [11.35677019]
curr_Stock_Price:  97.35115718516923
curr_Factors:  [97.35115719]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375476]
Stock Position:  -0.0037547648207280054
Bond Position:  [11.72230089]


portfolio before change:  [11.35651699]
curr_Stock_Price:  97.61372104996107
curr_Factors:  [97.61372105]
mat_Sqrt:  [[0.15]]
grads:  [-0.21268047]
Stock Position:  -0.21268046831638143
Bond Position:  [32.1170489]


portfolio before change:  [11.17479456]
curr_Stock_Price:  98.47759825416696
curr_Factors:  [98.47759825]
mat_Sqrt:  [[0.15]]
grads:  [-0.11387866]
Stock Position:  -0.11387866176646717
Bond Position:  [22.38929166]


portfolio before change:  [11.22310592]
curr_Stock_Price:  98.06565112356171
curr_Factors:  [98.06565112]
mat_Sqrt:  [[0.15]]
grads:  [0.04760579]
Stock Position:  0.04760579139597827
Bond Position:  [6.55461299]


portfolio before change:  [11.22298167]
curr_Stock_Price:  98.05443545147055
curr_Factors:  [98.05443545]
mat_Sqrt:  [[0.15]]
grads:  [0.17863833]
Stock Position:  0.1786383334363003
Bond Position:  [-6.29329927]


portfolio before change:  [11.38009902]
curr_Stock_Price:  98.93616500573287
curr_Factors:  [98.93616501]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493728]
Stock Position:  -0.01493728423747897
Bond Position:  [12.85793664]


portfolio before change:  [11.37129991]
curr_Stock_Price:  99.57903696329217
curr_Factors:  [99.57903696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01446382]
Stock Position:  -0.014463819966115095
Bond Position:  [12.81159317]


portfolio before change:  [11.37648444]
curr_Stock_Price:  99.27595065546363
curr_Factors:  [99.27595066]
mat_Sqrt:  [[0.15]]
grads:  [0.09773286]
Stock Position:  0.09773285685365113
Bond Position:  [1.67396217]


portfolio before change:  [11.4019964]
curr_Stock_Price:  99.5359177588391
curr_Factors:  [99.53591776]
mat_Sqrt:  [[0.15]]
grads:  [0.10229847]
Stock Position:  0.10229846636121706
Bond Position:  [1.21962466]


portfolio before change:  [11.38682665]
curr_Stock_Price:  99.3868835491677
curr_Factors:  [99.38688355]
mat_Sqrt:  [[0.15]]
grads:  [0.07155741]
Stock Position:  0.07155741147758408
Bond Position:  [4.27495853]


portfolio before change:  [11.4472662]
curr_Stock_Price:  100.22777975955056
curr_Factors:  [100.22777976]
mat_Sqrt:  [[0.15]]
grads:  [0.02673041]
Stock Position:  0.026730413917366615
Bond Position:  [8.76813616]


portfolio before change:  [11.43756731]
curr_Stock_Price:  99.84443675504671
curr_Factors:  [99.84443676]
mat_Sqrt:  [[0.15]]
grads:  [0.05316748]
Stock Position:  0.053167482493581796
Bond Position:  [6.12908997]


portfolio before change:  [11.41303737]
curr_Stock_Price:  99.37586048443923
curr_Factors:  [99.37586048]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153415]
Stock Position:  -0.015341498881448834
Bond Position:  [12.93761202]


portfolio before change:  [11.4154346]
curr_Stock_Price:  99.27231110394872
curr_Factors:  [99.2723111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04328229]
Stock Position:  -0.04328229314006611
Bond Position:  [15.71216787]


portfolio before change:  [11.40904897]
curr_Stock_Price:  99.44253473382365
curr_Factors:  [99.44253473]
mat_Sqrt:  [[0.15]]
grads:  [-0.02420123]
Stock Position:  -0.024201227190724026
Bond Position:  [13.81568035]


portfolio before change:  [11.42596115]
curr_Stock_Price:  98.77940029409997
curr_Factors:  [98.77940029]
mat_Sqrt:  [[0.15]]
grads:  [0.00949492]
Stock Position:  0.009494922187833653
Bond Position:  [10.48805843]


portfolio before change:  [11.42843103]
curr_Stock_Price:  98.97048758000273
curr_Factors:  [98.97048758]
mat_Sqrt:  [[0.15]]
grads:  [0.05338572]
Stock Position:  0.05338571842597141
Bond Position:  [6.14482045]


portfolio before change:  [11.4332407]
curr_Stock_Price:  99.05338628356868
curr_Factors:  [99.05338628]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651756]
Stock Position:  -0.046517563705878694
Bond Position:  [16.04096291]


portfolio before change:  [11.38025434]
curr_Stock_Price:  100.21400059578995
curr_Factors:  [100.2140006]
mat_Sqrt:  [[0.15]]
grads:  [-0.02711372]
Stock Position:  -0.027113716182268575
Bond Position:  [14.09742831]


portfolio before change:  [11.38864062]
curr_Stock_Price:  99.93719739310497
curr_Factors:  [99.93719739]
mat_Sqrt:  [[0.15]]
grads:  [0.03465878]
Stock Position:  0.034658776806676755
Bond Position:  [7.9249396]


portfolio before change:  [11.37542716]
curr_Stock_Price:  99.5416617503201
curr_Factors:  [99.54166175]
mat_Sqrt:  [[0.15]]
grads:  [0.03561863]
Stock Position:  0.035618631465409535
Bond Position:  [7.8298894]


portfolio before change:  [11.39249381]
curr_Stock_Price:  100.00707167739124
curr_Factors:  [100.00707168]
mat_Sqrt:  [[0.15]]
grads:  [0.04744909]
Stock Position:  0.047449094046444096
Bond Position:  [6.64724886]


portfolio before change:  [11.39719215]
curr_Stock_Price:  100.09733409668898
curr_Factors:  [100.0973341]
mat_Sqrt:  [[0.15]]
grads:  [-0.02690416]
Stock Position:  -0.026904162588265116
Bond Position:  [14.0902271]


portfolio before change:  [11.40128488]
curr_Stock_Price:  99.97794472018857
curr_Factors:  [99.97794472]
mat_Sqrt:  [[0.15]]
grads:  [-0.00156404]
Stock Position:  -0.0015640449365363247
Bond Position:  [11.55765488]


portfolio before change:  [11.40156869]
curr_Stock_Price:  100.2583537930736
curr_Factors:  [100.25835379]
mat_Sqrt:  [[0.15]]
grads:  [0.03517165]
Stock Position:  0.03517164816981521
Bond Position:  [7.87531714]


portfolio before change:  [11.35457683]
curr_Stock_Price:  98.9082868727821
curr_Factors:  [98.90828687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04211447]
Stock Position:  -0.042114469148601424
Bond Position:  [15.52004683]


portfolio before change:  [11.38099509]
curr_Stock_Price:  98.30402356523427
curr_Factors:  [98.30402357]
mat_Sqrt:  [[0.15]]
grads:  [0.00994026]
Stock Position:  0.009940258646999208
Bond Position:  [10.40382767]


portfolio before change:  [11.39206743]
curr_Stock_Price:  99.35249492349612
curr_Factors:  [99.35249492]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-1.72834427]


portfolio before change:  [11.35180174]
curr_Stock_Price:  99.04840655088829
curr_Factors:  [99.04840655]
mat_Sqrt:  [[0.15]]
grads:  [0.03484756]
Stock Position:  0.034847559290104906
Bond Position:  [7.90020652]


portfolio before change:  [11.36670403]
curr_Stock_Price:  99.46187931746876
curr_Factors:  [99.46187932]
mat_Sqrt:  [[0.15]]
grads:  [0.05373397]
Stock Position:  0.053733968151100875
Bond Position:  [6.02222258]


portfolio before change:  [11.38593735]
curr_Stock_Price:  99.81281040402274
curr_Factors:  [99.8128104]
mat_Sqrt:  [[0.15]]
grads:  [-0.00776321]
Stock Position:  -0.007763208541198445
Bond Position:  [12.16080501]


portfolio before change:  [11.38828968]
curr_Stock_Price:  99.60770813166728
curr_Factors:  [99.60770813]
mat_Sqrt:  [[0.15]]
grads:  [0.0188229]
Stock Position:  0.018822901241903806
Bond Position:  [9.51338362]


portfolio before change:  [11.40708121]
curr_Stock_Price:  100.57445210232765
curr_Factors:  [100.5744521]
mat_Sqrt:  [[0.15]]
grads:  [0.13485924]
Stock Position:  0.13485923591129437
Bond Position:  [-2.15631255]


portfolio before change:  [11.25876045]
curr_Stock_Price:  99.47563237624581
curr_Factors:  [99.47563238]
mat_Sqrt:  [[0.15]]
grads:  [0.01152537]
Stock Position:  0.01152536551430502
Bond Position:  [10.11226742]


portfolio before change:  [11.25431821]
curr_Stock_Price:  99.03536279624436
curr_Factors:  [99.0353628]
mat_Sqrt:  [[0.15]]
grads:  [-0.10616397]
Stock Position:  -0.10616397101451482
Bond Position:  [21.7683056]


portfolio before change:  [11.28948108]
curr_Stock_Price:  98.71696569250157
curr_Factors:  [98.71696569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428113]
Stock Position:  -0.042811297265857425
Bond Position:  [15.51568244]


portfolio before change:  [11.30792108]
curr_Stock_Price:  98.30889009603544
curr_Factors:  [98.3088901]
mat_Sqrt:  [[0.15]]
grads:  [0.00664488]
Stock Position:  0.006644879990218091
Bond Position:  [10.65467031]


portfolio before change:  [11.30596995]
curr_Stock_Price:  97.91504266726626
curr_Factors:  [97.91504267]
mat_Sqrt:  [[0.15]]
grads:  [0.05335303]
Stock Position:  0.05335303498916371
Bond Position:  [6.08190525]


portfolio before change:  [11.27930298]
curr_Stock_Price:  97.40809667395955
curr_Factors:  [97.40809667]
mat_Sqrt:  [[0.15]]
grads:  [0.00747227]
Stock Position:  0.007472268957520132
Bond Position:  [10.55144348]


portfolio before change:  [11.27654386]
curr_Stock_Price:  96.95059163599838
curr_Factors:  [96.95059164]
mat_Sqrt:  [[0.15]]
grads:  [-0.01068719]
Stock Position:  -0.01068718932005198
Bond Position:  [12.31267319]


portfolio before change:  [11.27609953]
curr_Stock_Price:  97.06417564419773
curr_Factors:  [97.06417564]
mat_Sqrt:  [[0.15]]
grads:  [-0.05768976]
Stock Position:  -0.057689762453857825
Bond Position:  [16.87570877]


portfolio before change:  [11.312782]
curr_Stock_Price:  96.44660162860069
curr_Factors:  [96.44660163]
mat_Sqrt:  [[0.15]]
grads:  [-0.16857591]
Stock Position:  -0.16857590504047698
Bond Position:  [27.57135515]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.27629161]
Stock Price:  96.67328675366748
PL:  [11.27629161]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.08907444e-03]
 [ 1.15299126e-02]
 [ 1.28918318e-02]
 [-9.20149946e-03]
 [ 1.29463132e-02]
 [-9.89042551e-03]
 [ 2.48291643e-03]
 [-9.23648519e-03]
 [-7.55992509e-03]
 [-8.12563833e-03]
 [ 1.16433415e-02]
 [-4.28730640e-03]
 [-3.90957718e-04]
 [ 4.98390148e-03]
 [-2.20000332e-03]
 [ 1.31315736e-02]
 [ 2.26438451e-02]
 [-1.39909025e-02]
 [ 2.50360216e-02]
 [ 1.43433758e-03]
 [-3.82059905e-03]
 [ 4.18017539e-03]
 [ 1.53833166e-02]
 [ 1.94948002e-02]
 [-2.90457069e-03]
 [ 6.36799692e-03]
 [-4.95948991e-03]
 [ 6.25226496e-03]
 [ 3.07735473e-02]
 [ 1.66294422e-03]
 [-7.39192427e-03]
 [ 1.00010058e-02]
 [ 1.19159839e-02]
 [-1.02446875e-02]
 [-1.91215367e-03]
 [ 1.83429386e-02]
 [ 4.86642749e-03]
 [ 1.26083211e-03]
 [-5.46352217e-02]
 [-1.22362220e-02]
 [ 7.17561293e-03]
 [ 9.64359347e-03]
 [-2.56252368e-03]
 [ 1.06713584e-03]
 [-7.15185181e-04]
 [ 1.47305906e-02]
 [ 1.06697532e-02]
 [ 4.78122440e-03]
 [ 8.05503081e-03]
 [-2.17216054e-03]
 [-5.31136645e-03]
 [-3.67310857e-03]
 [ 1.92807424e-03]
 [ 8.61877354e-03]
 [-8.21574285e-03]
 [-4.48665846e-03]
 [ 2.83015745e-03]
 [ 6.94656614e-03]
 [ 7.81352362e-03]
 [-3.92078469e-03]
 [-2.05600571e-03]
 [-3.70222071e-04]
 [-5.41913732e-03]
 [ 2.40286633e-03]
 [ 1.99912379e-02]
 [ 4.76276132e-03]
 [ 8.81442862e-03]
 [-2.38173654e-04]
 [ 2.81713172e-03]
 [ 2.19397897e-02]
 [ 2.08806259e-03]
 [-1.59222774e-02]
 [-5.80474522e-03]
 [ 1.09135594e-03]
 [ 9.09007185e-03]
 [ 3.56068571e-03]
 [-1.60831673e-03]
 [-1.81520976e-03]
 [-2.31702184e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.44962919]
curr_Stock_Price:  100.2007345188184
curr_Factors:  [100.20073452]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392716]
Stock Position:  -0.03392716290844045
Bond Position:  [9.84915583]


portfolio before change:  [6.45592088]
curr_Stock_Price:  100.03343198367222
curr_Factors:  [100.03343198]
mat_Sqrt:  [[0.15]]
grads:  [0.07686608]
Stock Position:  0.07686608404604915
Bond Position:  [-1.23325731]


portfolio before change:  [6.48107655]
curr_Stock_Price:  100.36170090043018
curr_Factors:  [100.3617009]
mat_Sqrt:  [[0.15]]
grads:  [0.08594555]
Stock Position:  0.08594554522795891
Bond Position:  [-2.14456456]


portfolio before change:  [6.43258319]
curr_Stock_Price:  99.79902703056281
curr_Factors:  [99.79902703]
mat_Sqrt:  [[0.15]]
grads:  [-0.06134333]
Stock Position:  -0.06134332974294766
Bond Position:  [12.55458782]


portfolio before change:  [6.46171558]
curr_Stock_Price:  99.33691166741187
curr_Factors:  [99.33691167]
mat_Sqrt:  [[0.15]]
grads:  [0.08630875]
Stock Position:  0.08630875494169739
Bond Position:  [-2.11192959]


portfolio before change:  [6.48767101]
curr_Stock_Price:  99.63916876575405
curr_Factors:  [99.63916877]
mat_Sqrt:  [[0.15]]
grads:  [-0.06593617]
Stock Position:  -0.0659361700905902
Bond Position:  [13.05749619]


portfolio before change:  [6.47639704]
curr_Stock_Price:  99.82252920786651
curr_Factors:  [99.82252921]
mat_Sqrt:  [[0.15]]
grads:  [0.01655278]
Stock Position:  0.01655277623149176
Bond Position:  [4.82405705]


portfolio before change:  [6.4823309]
curr_Stock_Price:  100.16279488492779
curr_Factors:  [100.16279488]
mat_Sqrt:  [[0.15]]
grads:  [-0.06157657]
Stock Position:  -0.06157656796562794
Bond Position:  [12.65001204]


portfolio before change:  [6.49887702]
curr_Stock_Price:  99.90692691717439
curr_Factors:  [99.90692692]
mat_Sqrt:  [[0.15]]
grads:  [-0.0503995]
Stock Position:  -0.050399500577755184
Bond Position:  [11.53413624]


portfolio before change:  [6.52263114]
curr_Stock_Price:  99.44991407654703
curr_Factors:  [99.44991408]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417092]
Stock Position:  -0.05417092221756781
Bond Position:  [11.9099247]


portfolio before change:  [6.48634133]
curr_Stock_Price:  100.13356886897402
curr_Factors:  [100.13356887]
mat_Sqrt:  [[0.15]]
grads:  [0.07762228]
Stock Position:  0.07762227647383939
Bond Position:  [-1.28625424]


portfolio before change:  [6.45782413]
curr_Stock_Price:  99.76722034603632
curr_Factors:  [99.76722035]
mat_Sqrt:  [[0.15]]
grads:  [-0.02858204]
Stock Position:  -0.02858204265591574
Bond Position:  [9.30937508]


portfolio before change:  [6.48065953]
curr_Stock_Price:  98.98863529188398
curr_Factors:  [98.98863529]
mat_Sqrt:  [[0.15]]
grads:  [-0.00260638]
Stock Position:  -0.002606384786031357
Bond Position:  [6.73866201]


portfolio before change:  [6.48072776]
curr_Stock_Price:  99.12405311858758
curr_Factors:  [99.12405312]
mat_Sqrt:  [[0.15]]
grads:  [0.03322601]
Stock Position:  0.03322600985254661
Bond Position:  [3.187231]


portfolio before change:  [6.52105172]
curr_Stock_Price:  100.33168383642935
curr_Factors:  [100.33168384]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466669]
Stock Position:  -0.014666688821302402
Bond Position:  [7.99258531]


portfolio before change:  [6.52622231]
curr_Stock_Price:  100.01320451946297
curr_Factors:  [100.01320452]
mat_Sqrt:  [[0.15]]
grads:  [0.08754382]
Stock Position:  0.08754382387748667
Bond Position:  [-2.22931605]


portfolio before change:  [6.46813774]
curr_Stock_Price:  99.35130475083467
curr_Factors:  [99.35130475]
mat_Sqrt:  [[0.15]]
grads:  [0.15095897]
Stock Position:  0.1509589673469103
Bond Position:  [-8.52983263]


portfolio before change:  [6.38817425]
curr_Stock_Price:  98.82513293285243
curr_Factors:  [98.82513293]
mat_Sqrt:  [[0.15]]
grads:  [-0.09327268]
Stock Position:  -0.0932726830783948
Bond Position:  [15.60585955]


portfolio before change:  [6.40131661]
curr_Stock_Price:  98.69468782223593
curr_Factors:  [98.69468782]
mat_Sqrt:  [[0.15]]
grads:  [0.16690681]
Stock Position:  0.1669068108086234
Bond Position:  [-10.07149898]


portfolio before change:  [6.48908484]
curr_Stock_Price:  99.22431098654693
curr_Factors:  [99.22431099]
mat_Sqrt:  [[0.15]]
grads:  [0.00956225]
Stock Position:  0.00956225050747712
Bond Position:  [5.54027712]


portfolio before change:  [6.49197655]
curr_Stock_Price:  99.49050709808023
curr_Factors:  [99.4905071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02547066]
Stock Position:  -0.0254706603067675
Bond Position:  [9.02606546]


portfolio before change:  [6.47920409]
curr_Stock_Price:  100.01411376639923
curr_Factors:  [100.01411377]
mat_Sqrt:  [[0.15]]
grads:  [0.02786784]
Stock Position:  0.027867835939056076
Bond Position:  [3.69202717]


portfolio before change:  [6.49226998]
curr_Stock_Price:  100.47468545131936
curr_Factors:  [100.47468545]
mat_Sqrt:  [[0.15]]
grads:  [0.10255544]
Stock Position:  0.10255544429423304
Bond Position:  [-3.81195602]


portfolio before change:  [6.53329773]
curr_Stock_Price:  100.87706294388012
curr_Factors:  [100.87706294]
mat_Sqrt:  [[0.15]]
grads:  [0.12996533]
Stock Position:  0.1299653344900235
Bond Position:  [-6.5772235]


portfolio before change:  [6.51969403]
curr_Stock_Price:  100.7755542341594
curr_Factors:  [100.77555423]
mat_Sqrt:  [[0.15]]
grads:  [-0.0193638]
Stock Position:  -0.019363804608946343
Bond Position:  [8.47109217]


portfolio before change:  [6.52120509]
curr_Stock_Price:  100.72486143208847
curr_Factors:  [100.72486143]
mat_Sqrt:  [[0.15]]
grads:  [0.04245331]
Stock Position:  0.04245331280403906
Bond Position:  [2.24510104]


portfolio before change:  [6.51700342]
curr_Stock_Price:  100.62258442601589
curr_Factors:  [100.62258443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03306327]
Stock Position:  -0.03306326605464101
Bond Position:  [9.8439147]


portfolio before change:  [6.51005998]
curr_Stock_Price:  100.85119784715788
curr_Factors:  [100.85119785]
mat_Sqrt:  [[0.15]]
grads:  [0.04168177]
Stock Position:  0.041681766406801365
Bond Position:  [2.30640391]


portfolio before change:  [6.49440832]
curr_Stock_Price:  100.4722358010588
curr_Factors:  [100.4722358]
mat_Sqrt:  [[0.15]]
grads:  [0.20515698]
Stock Position:  0.2051569818433495
Bond Position:  [-14.11817233]


portfolio before change:  [6.29768591]
curr_Stock_Price:  99.51764972829264
curr_Factors:  [99.51764973]
mat_Sqrt:  [[0.15]]
grads:  [0.01108629]
Stock Position:  0.011086294832290677
Bond Position:  [5.19440391]


portfolio before change:  [6.30234386]
curr_Stock_Price:  99.90851856554423
curr_Factors:  [99.90851857]
mat_Sqrt:  [[0.15]]
grads:  [-0.0492795]
Stock Position:  -0.04927949512672286
Bond Position:  [11.22578521]


portfolio before change:  [6.31966848]
curr_Stock_Price:  99.57119801432977
curr_Factors:  [99.57119801]
mat_Sqrt:  [[0.15]]
grads:  [0.06667337]
Stock Position:  0.0666733719613402
Bond Position:  [-0.31907904]


portfolio before change:  [6.32537817]
curr_Stock_Price:  99.65713386320178
curr_Factors:  [99.65713386]
mat_Sqrt:  [[0.15]]
grads:  [0.07943989]
Stock Position:  0.07943989282568313
Bond Position:  [-1.59137386]


portfolio before change:  [6.2984174]
curr_Stock_Price:  99.31900014464922
curr_Factors:  [99.31900014]
mat_Sqrt:  [[0.15]]
grads:  [-0.06829792]
Stock Position:  -0.06829791681446781
Bond Position:  [13.08169821]


portfolio before change:  [6.34953851]
curr_Stock_Price:  98.58246992260594
curr_Factors:  [98.58246992]
mat_Sqrt:  [[0.15]]
grads:  [-0.01274769]
Stock Position:  -0.01274769115851234
Bond Position:  [7.60623739]


portfolio before change:  [6.35092529]
curr_Stock_Price:  98.51097645782691
curr_Factors:  [98.51097646]
mat_Sqrt:  [[0.15]]
grads:  [0.12228626]
Stock Position:  0.12228625760289005
Bond Position:  [-5.69561335]


portfolio before change:  [6.34458207]
curr_Stock_Price:  98.4620156173299
curr_Factors:  [98.46201562]
mat_Sqrt:  [[0.15]]
grads:  [0.03244285]
Stock Position:  0.03244284990398109
Bond Position:  [3.15019367]


portfolio before change:  [6.34543886]
curr_Stock_Price:  98.48235581848724
curr_Factors:  [98.48235582]
mat_Sqrt:  [[0.15]]
grads:  [0.00840555]
Stock Position:  0.008405547416790865
Bond Position:  [5.51764074]


portfolio before change:  [6.3543014]
curr_Stock_Price:  99.49569600289631
curr_Factors:  [99.495696]
mat_Sqrt:  [[0.15]]
grads:  [-0.36423481]
Stock Position:  -0.3642348114827934
Bond Position:  [42.59409747]


portfolio before change:  [6.3587244]
curr_Stock_Price:  99.49086179239725
curr_Factors:  [99.49086179]
mat_Sqrt:  [[0.15]]
grads:  [-0.08157481]
Stock Position:  -0.08157481351391013
Bond Position:  [14.4746729]


portfolio before change:  [6.41396369]
curr_Stock_Price:  98.82479107701964
curr_Factors:  [98.82479108]
mat_Sqrt:  [[0.15]]
grads:  [0.04783742]
Stock Position:  0.047837419531578294
Bond Position:  [1.6864407]


portfolio before change:  [6.42755599]
curr_Stock_Price:  99.10672302596748
curr_Factors:  [99.10672303]
mat_Sqrt:  [[0.15]]
grads:  [0.06429062]
Stock Position:  0.0642906231151691
Bond Position:  [0.05592301]


portfolio before change:  [6.39070811]
curr_Stock_Price:  98.53352312877173
curr_Factors:  [98.53352313]
mat_Sqrt:  [[0.15]]
grads:  [-0.01708349]
Stock Position:  -0.01708349118287082
Bond Position:  [8.07400468]


portfolio before change:  [6.39333267]
curr_Stock_Price:  98.40943138966713
curr_Factors:  [98.40943139]
mat_Sqrt:  [[0.15]]
grads:  [0.00711424]
Stock Position:  0.0071142389315472536
Bond Position:  [5.69322446]


portfolio before change:  [6.39300489]
curr_Stock_Price:  98.31333957682172
curr_Factors:  [98.31333958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0047679]
Stock Position:  -0.004767901208965117
Bond Position:  [6.86175318]


portfolio before change:  [6.39000177]
curr_Stock_Price:  99.03315196083956
curr_Factors:  [99.03315196]
mat_Sqrt:  [[0.15]]
grads:  [0.09820394]
Stock Position:  0.09820393710848602
Bond Position:  [-3.33544366]


portfolio before change:  [6.38546329]
curr_Stock_Price:  98.98906001085975
curr_Factors:  [98.98906001]
mat_Sqrt:  [[0.15]]
grads:  [0.07113169]
Stock Position:  0.07113168823057527
Bond Position:  [-0.65579566]


portfolio before change:  [6.39318562]
curr_Stock_Price:  99.09820000280833
curr_Factors:  [99.0982]
mat_Sqrt:  [[0.15]]
grads:  [0.03187483]
Stock Position:  0.03187482935951727
Bond Position:  [3.2344474]


portfolio before change:  [6.4182036]
curr_Stock_Price:  99.87674001801655
curr_Factors:  [99.87674002]
mat_Sqrt:  [[0.15]]
grads:  [0.05370021]
Stock Position:  0.053700205419243446
Bond Position:  [1.05480215]


portfolio before change:  [6.41610017]
curr_Stock_Price:  99.83634233916185
curr_Factors:  [99.83634234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01448107]
Stock Position:  -0.014481070253698804
Bond Position:  [7.86183726]


portfolio before change:  [6.42163272]
curr_Stock_Price:  99.48822071528764
curr_Factors:  [99.48822072]
mat_Sqrt:  [[0.15]]
grads:  [-0.03540911]
Stock Position:  -0.035409109667322906
Bond Position:  [9.94442204]


portfolio before change:  [6.42357213]
curr_Stock_Price:  99.45100263445369
curr_Factors:  [99.45100263]
mat_Sqrt:  [[0.15]]
grads:  [-0.02448739]
Stock Position:  -0.024487390468784325
Bond Position:  [8.85886766]


portfolio before change:  [6.41803271]
curr_Stock_Price:  99.69982918243967
curr_Factors:  [99.69982918]
mat_Sqrt:  [[0.15]]
grads:  [0.01285383]
Stock Position:  0.012853828271195269
Bond Position:  [5.13650823]


portfolio before change:  [6.40773391]
curr_Stock_Price:  98.87362852258669
curr_Factors:  [98.87362852]
mat_Sqrt:  [[0.15]]
grads:  [0.05745849]
Stock Position:  0.05745849023503193
Bond Position:  [0.72660449]


portfolio before change:  [6.37245215]
curr_Stock_Price:  98.25879894366211
curr_Factors:  [98.25879894]
mat_Sqrt:  [[0.15]]
grads:  [-0.05477162]
Stock Position:  -0.0547716189848022
Bond Position:  [11.75424564]


portfolio before change:  [6.36590091]
curr_Stock_Price:  98.39182217293255
curr_Factors:  [98.39182217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02991106]
Stock Position:  -0.029911056415719412
Bond Position:  [9.30890426]


portfolio before change:  [6.33646858]
curr_Stock_Price:  99.39526914774859
curr_Factors:  [99.39526915]
mat_Sqrt:  [[0.15]]
grads:  [0.01886772]
Stock Position:  0.018867716344157116
Bond Position:  [4.46110683]


portfolio before change:  [6.33357302]
curr_Stock_Price:  99.2270249673361
curr_Factors:  [99.22702497]
mat_Sqrt:  [[0.15]]
grads:  [0.04631044]
Stock Position:  0.04631044093267606
Bond Position:  [1.73832574]


portfolio before change:  [6.2945526]
curr_Stock_Price:  98.38209526015476
curr_Factors:  [98.38209526]
mat_Sqrt:  [[0.15]]
grads:  [0.05209016]
Stock Position:  0.052090157486587324
Bond Position:  [1.16981377]


portfolio before change:  [6.29924137]
curr_Stock_Price:  98.47070424386833
curr_Factors:  [98.47070424]
mat_Sqrt:  [[0.15]]
grads:  [-0.02613856]
Stock Position:  -0.026138564588463586
Bond Position:  [8.87312424]


portfolio before change:  [6.29125205]
curr_Stock_Price:  98.79757432926579
curr_Factors:  [98.79757433]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137067]
Stock Position:  -0.013706704734623102
Bond Position:  [7.64544123]


portfolio before change:  [6.30645159]
curr_Stock_Price:  97.7235240043271
curr_Factors:  [97.723524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00246815]
Stock Position:  -0.00246814714331397
Bond Position:  [6.54764763]


portfolio before change:  [6.3066144]
curr_Stock_Price:  97.82337092121989
curr_Factors:  [97.82337092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03612758]
Stock Position:  -0.0361275821145194
Bond Position:  [9.84073626]


portfolio before change:  [6.27895888]
curr_Stock_Price:  98.60589164247747
curr_Factors:  [98.60589164]
mat_Sqrt:  [[0.15]]
grads:  [0.01601911]
Stock Position:  0.01601910886561967
Bond Position:  [4.69938037]


portfolio before change:  [6.28187103]
curr_Stock_Price:  98.76934811596958
curr_Factors:  [98.76934812]
mat_Sqrt:  [[0.15]]
grads:  [0.13327492]
Stock Position:  0.13327491937585836
Bond Position:  [-6.88160588]


portfolio before change:  [6.26592266]
curr_Stock_Price:  98.65291017669864
curr_Factors:  [98.65291018]
mat_Sqrt:  [[0.15]]
grads:  [0.03175174]
Stock Position:  0.031751742161348
Bond Position:  [3.13352089]


portfolio before change:  [6.2779105]
curr_Stock_Price:  99.024291215829
curr_Factors:  [99.02429122]
mat_Sqrt:  [[0.15]]
grads:  [0.05876286]
Stock Position:  0.05876285744177383
Bond Position:  [0.4589602]


portfolio before change:  [6.27222556]
curr_Stock_Price:  98.92705927301402
curr_Factors:  [98.92705927]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158782]
Stock Position:  -0.0015878243608244038
Bond Position:  [6.42930436]


portfolio before change:  [6.27237745]
curr_Stock_Price:  99.0844817331153
curr_Factors:  [99.08448173]
mat_Sqrt:  [[0.15]]
grads:  [0.01878088]
Stock Position:  0.018780878136749345
Bond Position:  [4.41148387]


portfolio before change:  [6.27166719]
curr_Stock_Price:  99.03198256187815
curr_Factors:  [99.03198256]
mat_Sqrt:  [[0.15]]
grads:  [0.14626526]
Stock Position:  0.1462652647874759
Bond Position:  [-8.21327196]


portfolio before change:  [6.28177892]
curr_Stock_Price:  99.10462503586207
curr_Factors:  [99.10462504]
mat_Sqrt:  [[0.15]]
grads:  [0.01392042]
Stock Position:  0.01392041723485328
Bond Position:  [4.90220119]


portfolio before change:  [6.28088833]
curr_Stock_Price:  99.01863718718333
curr_Factors:  [99.01863719]
mat_Sqrt:  [[0.15]]
grads:  [-0.10614852]
Stock Position:  -0.10614851613009442
Bond Position:  [16.79156974]


portfolio before change:  [6.38202125]
curr_Stock_Price:  98.07577506154821
curr_Factors:  [98.07577506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0386983]
Stock Position:  -0.038698301482596134
Bond Position:  [10.17738716]


portfolio before change:  [6.38284243]
curr_Stock_Price:  98.07099248631367
curr_Factors:  [98.07099249]
mat_Sqrt:  [[0.15]]
grads:  [0.00727571]
Stock Position:  0.0072757062792161075
Bond Position:  [5.6693067]


portfolio before change:  [6.37812384]
curr_Stock_Price:  97.37374911403555
curr_Factors:  [97.37374911]
mat_Sqrt:  [[0.15]]
grads:  [0.06060048]
Stock Position:  0.060600479020748055
Bond Position:  [0.477228]


portfolio before change:  [6.31368606]
curr_Stock_Price:  96.30993567490272
curr_Factors:  [96.30993567]
mat_Sqrt:  [[0.15]]
grads:  [0.0237379]
Stock Position:  0.02373790473112676
Bond Position:  [4.02748999]


portfolio before change:  [6.33778455]
curr_Stock_Price:  97.31452123830972
curr_Factors:  [97.31452124]
mat_Sqrt:  [[0.15]]
grads:  [-0.01072211]
Stock Position:  -0.010722111523634899
Bond Position:  [7.38120169]


portfolio before change:  [6.32859259]
curr_Stock_Price:  98.21483782111214
curr_Factors:  [98.21483782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0121014]
Stock Position:  -0.012101398414944429
Bond Position:  [7.51712947]


portfolio before change:  [6.33567433]
curr_Stock_Price:  97.66846217918196
curr_Factors:  [97.66846218]
mat_Sqrt:  [[0.15]]
grads:  [-0.15446812]
Stock Position:  -0.15446812294647422
Bond Position:  [21.42233836]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.45470625]
Stock Price:  96.90653814554165
PL:  [6.45470625]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.35989840e-03]
 [ 3.60983793e-02]
 [ 1.70005210e-02]
 [-2.80530199e-02]
 [-2.66508231e-02]
 [-1.37726121e-03]
 [-7.35236900e-03]
 [-1.62222247e-02]
 [ 1.06811079e-03]
 [-7.14849690e-03]
 [ 1.35588430e-02]
 [-2.67220824e-03]
 [-1.14890849e-03]
 [ 8.91167717e-03]
 [-4.26007228e-04]
 [ 8.65358803e-03]
 [ 3.04604518e-02]
 [-1.51272529e-02]
 [ 2.49942991e-02]
 [-1.36847532e-03]
 [-3.99526071e-03]
 [ 4.72466179e-03]
 [ 1.66870879e-02]
 [ 1.73501491e-02]
 [-6.07233976e-03]
 [ 4.59734424e-03]
 [ 4.18892416e-03]
 [ 8.38922456e-03]
 [ 1.56403036e-02]
 [ 1.70990116e-02]
 [-6.40481170e-03]
 [ 1.00599810e-02]
 [ 1.14626514e-02]
 [-1.98120624e-02]
 [-9.29905322e-03]
 [ 1.15164473e-02]
 [ 5.18175927e-03]
 [ 1.76230257e-03]
 [-3.24262401e-02]
 [-1.78745797e-02]
 [ 7.14427915e-03]
 [ 2.73923171e-02]
 [-3.01294891e-03]
 [ 5.57438796e-03]
 [-1.47986802e-02]
 [ 1.80289156e-02]
 [ 9.86149363e-03]
 [ 5.32206817e-03]
 [-8.33206792e-03]
 [-2.87892836e-04]
 [-4.66888147e-03]
 [ 1.22904866e-03]
 [ 4.92204885e-04]
 [ 8.11666940e-03]
 [-9.95309800e-03]
 [-4.77219293e-03]
 [-8.90739621e-04]
 [ 1.23823650e-02]
 [ 8.00236716e-03]
 [-3.37357260e-03]
 [-4.96851167e-03]
 [-9.06551111e-04]
 [-5.08299113e-03]
 [-1.74388699e-03]
 [ 1.90807821e-02]
 [ 5.25529943e-03]
 [ 1.87481719e-02]
 [-2.23347220e-03]
 [ 5.29305015e-03]
 [ 2.60024810e-02]
 [ 3.28613466e-03]
 [-1.54847990e-02]
 [-5.51395856e-03]
 [ 9.64543909e-04]
 [ 6.90887140e-03]
 [ 3.50162907e-05]
 [-1.51951552e-03]
 [-7.46246542e-03]
 [-2.28998500e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.24412289]
curr_Stock_Price:  100.73641625264422
curr_Factors:  [100.73641625]
mat_Sqrt:  [[0.15]]
grads:  [-0.03573266]
Stock Position:  -0.035732656010927934
Bond Position:  [21.8437026]


portfolio before change:  [18.24022652]
curr_Stock_Price:  100.88366665792188
curr_Factors:  [100.88366666]
mat_Sqrt:  [[0.15]]
grads:  [0.24065586]
Stock Position:  0.24065586203125472
Bond Position:  [-6.03801924]


portfolio before change:  [18.44023746]
curr_Stock_Price:  101.7163425021973
curr_Factors:  [101.7163425]
mat_Sqrt:  [[0.15]]
grads:  [0.11333681]
Stock Position:  0.11333680645204176
Bond Position:  [6.91203203]


portfolio before change:  [18.39631736]
curr_Stock_Price:  101.32501230929941
curr_Factors:  [101.32501231]
mat_Sqrt:  [[0.15]]
grads:  [-0.18702013]
Stock Position:  -0.18702013274896165
Bond Position:  [37.34613461]


portfolio before change:  [18.42125915]
curr_Stock_Price:  101.20412913037354
curr_Factors:  [101.20412913]
mat_Sqrt:  [[0.15]]
grads:  [-0.17767215]
Stock Position:  -0.17767215389320729
Bond Position:  [36.40241476]


portfolio before change:  [18.48244347]
curr_Stock_Price:  100.87256847063239
curr_Factors:  [100.87256847]
mat_Sqrt:  [[0.15]]
grads:  [-0.00918174]
Stock Position:  -0.00918174141867095
Bond Position:  [19.40862931]


portfolio before change:  [18.48074124]
curr_Stock_Price:  101.19007977782519
curr_Factors:  [101.19007978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04901579]
Stock Position:  -0.04901579332307904
Bond Position:  [23.44065328]


portfolio before change:  [18.51718474]
curr_Stock_Price:  100.47646467961708
curr_Factors:  [100.47646468]
mat_Sqrt:  [[0.15]]
grads:  [-0.10814816]
Stock Position:  -0.10814816458092183
Bond Position:  [29.38352998]


portfolio before change:  [18.53021807]
curr_Stock_Price:  100.372932644973
curr_Factors:  [100.37293264]
mat_Sqrt:  [[0.15]]
grads:  [0.00712074]
Stock Position:  0.007120738592367079
Bond Position:  [17.81548865]


portfolio before change:  [18.5253944]
curr_Stock_Price:  99.53914658818533
curr_Factors:  [99.53914659]
mat_Sqrt:  [[0.15]]
grads:  [-0.04765665]
Stock Position:  -0.04765664598737942
Bond Position:  [23.26909627]


portfolio before change:  [18.53629915]
curr_Stock_Price:  99.34084487438238
curr_Factors:  [99.34084487]
mat_Sqrt:  [[0.15]]
grads:  [0.09039229]
Stock Position:  0.09039228648973668
Bond Position:  [9.55665304]


portfolio before change:  [18.60141367]
curr_Stock_Price:  100.05459174100687
curr_Factors:  [100.05459174]
mat_Sqrt:  [[0.15]]
grads:  [-0.01781472]
Stock Position:  -0.017814721585977227
Bond Position:  [20.38385837]


portfolio before change:  [18.61060702]
curr_Stock_Price:  99.61005393172626
curr_Factors:  [99.61005393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00765939]
Stock Position:  -0.007659389935856439
Bond Position:  [19.37355927]


portfolio before change:  [18.61021378]
curr_Stock_Price:  99.81948697486803
curr_Factors:  [99.81948697]
mat_Sqrt:  [[0.15]]
grads:  [0.05941118]
Stock Position:  0.05941118113810068
Bond Position:  [12.67982016]


portfolio before change:  [18.61663138]
curr_Stock_Price:  99.91416765492895
curr_Factors:  [99.91416765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00284005]
Stock Position:  -0.002840048185374401
Bond Position:  [18.90039243]


portfolio before change:  [18.62102577]
curr_Stock_Price:  98.78282136993948
curr_Factors:  [98.78282137]
mat_Sqrt:  [[0.15]]
grads:  [0.05769059]
Stock Position:  0.05769058687013918
Bond Position:  [12.92218684]


portfolio before change:  [18.6787758]
curr_Stock_Price:  99.76985178945843
curr_Factors:  [99.76985179]
mat_Sqrt:  [[0.15]]
grads:  [0.20306968]
Stock Position:  0.20306967889008246
Bond Position:  [-1.58145597]


portfolio before change:  [18.58670258]
curr_Stock_Price:  99.31693152935205
curr_Factors:  [99.31693153]
mat_Sqrt:  [[0.15]]
grads:  [-0.10084835]
Stock Position:  -0.10084835252753332
Bond Position:  [28.60265151]


portfolio before change:  [18.66806766]
curr_Stock_Price:  98.52785218250916
curr_Factors:  [98.52785218]
mat_Sqrt:  [[0.15]]
grads:  [0.16662866]
Stock Position:  0.16662866098451326
Bond Position:  [2.25050358]


portfolio before change:  [18.61978465]
curr_Stock_Price:  98.23724392083896
curr_Factors:  [98.23724392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912317]
Stock Position:  -0.009123168812976782
Bond Position:  [19.51601961]


portfolio before change:  [18.61060135]
curr_Stock_Price:  99.37753789448574
curr_Factors:  [99.37753789]
mat_Sqrt:  [[0.15]]
grads:  [-0.02663507]
Stock Position:  -0.026635071411100393
Bond Position:  [21.25752917]


portfolio before change:  [18.6072088]
curr_Stock_Price:  99.55479245877616
curr_Factors:  [99.55479246]
mat_Sqrt:  [[0.15]]
grads:  [0.03149775]
Stock Position:  0.031497745298739194
Bond Position:  [15.4714573]


portfolio before change:  [18.61486806]
curr_Stock_Price:  99.7672607348283
curr_Factors:  [99.76726073]
mat_Sqrt:  [[0.15]]
grads:  [0.11124725]
Stock Position:  0.11124725291139263
Bond Position:  [7.51603438]


portfolio before change:  [18.68126857]
curr_Stock_Price:  100.35991123956912
curr_Factors:  [100.35991124]
mat_Sqrt:  [[0.15]]
grads:  [0.11566766]
Stock Position:  0.11566766087545938
Bond Position:  [7.07287239]


portfolio before change:  [18.57930678]
curr_Stock_Price:  99.47458284500621
curr_Factors:  [99.47458285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048227]
Stock Position:  -0.04048226504441077
Bond Position:  [22.6062632]


portfolio before change:  [18.59382751]
curr_Stock_Price:  99.15079177498167
curr_Factors:  [99.15079177]
mat_Sqrt:  [[0.15]]
grads:  [0.03064896]
Stock Position:  0.030648961589302602
Bond Position:  [15.5549587]


portfolio before change:  [18.60821636]
curr_Stock_Price:  99.58854342399583
curr_Factors:  [99.58854342]
mat_Sqrt:  [[0.15]]
grads:  [0.02792616]
Stock Position:  0.027926161095689524
Bond Position:  [15.82709065]


portfolio before change:  [18.60988632]
curr_Stock_Price:  99.61291989432307
curr_Factors:  [99.61291989]
mat_Sqrt:  [[0.15]]
grads:  [0.05592816]
Stock Position:  0.05592816371592517
Bond Position:  [13.03871863]


portfolio before change:  [18.57390362]
curr_Stock_Price:  98.95497502666657
curr_Factors:  [98.95497503]
mat_Sqrt:  [[0.15]]
grads:  [0.10426869]
Stock Position:  0.10426869054672472
Bond Position:  [8.25599795]


portfolio before change:  [18.47590016]
curr_Stock_Price:  98.0101135454036
curr_Factors:  [98.01011355]
mat_Sqrt:  [[0.15]]
grads:  [0.11399341]
Stock Position:  0.11399341039357656
Bond Position:  [7.30339307]


portfolio before change:  [18.51815059]
curr_Stock_Price:  98.37674836574072
curr_Factors:  [98.37674837]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269874]
Stock Position:  -0.04269874463967056
Bond Position:  [22.71871425]


portfolio before change:  [18.48405224]
curr_Stock_Price:  99.20858352536631
curr_Factors:  [99.20858353]
mat_Sqrt:  [[0.15]]
grads:  [0.06706654]
Stock Position:  0.06706654031859018
Bond Position:  [11.83047577]


portfolio before change:  [18.43967255]
curr_Stock_Price:  98.53583190367931
curr_Factors:  [98.5358319]
mat_Sqrt:  [[0.15]]
grads:  [0.07641768]
Stock Position:  0.07641767611948415
Bond Position:  [10.90979326]


portfolio before change:  [18.40829527]
curr_Stock_Price:  98.11630644624113
curr_Factors:  [98.11630645]
mat_Sqrt:  [[0.15]]
grads:  [-0.13208042]
Stock Position:  -0.1320804161769252
Bond Position:  [31.36753786]


portfolio before change:  [18.52393014]
curr_Stock_Price:  97.2556615429736
curr_Factors:  [97.25566154]
mat_Sqrt:  [[0.15]]
grads:  [-0.06199369]
Stock Position:  -0.0619936881351988
Bond Position:  [24.55316729]


portfolio before change:  [18.51964656]
curr_Stock_Price:  97.34951302013864
curr_Factors:  [97.34951302]
mat_Sqrt:  [[0.15]]
grads:  [0.07677632]
Stock Position:  0.07677631565937489
Bond Position:  [11.04550962]


portfolio before change:  [18.56599619]
curr_Stock_Price:  97.94421804256064
curr_Factors:  [97.94421804]
mat_Sqrt:  [[0.15]]
grads:  [0.03454506]
Stock Position:  0.03454506178112864
Bond Position:  [15.18250712]


portfolio before change:  [18.59165244]
curr_Stock_Price:  98.65943807741526
curr_Factors:  [98.65943808]
mat_Sqrt:  [[0.15]]
grads:  [0.01174868]
Stock Position:  0.011748683813007343
Bond Position:  [17.4325339]


portfolio before change:  [18.59206966]
curr_Stock_Price:  98.60221063534082
curr_Factors:  [98.60221064]
mat_Sqrt:  [[0.15]]
grads:  [-0.21617493]
Stock Position:  -0.21617493429149937
Bond Position:  [39.90739607]


portfolio before change:  [18.64663433]
curr_Stock_Price:  98.36133913900386
curr_Factors:  [98.36133914]
mat_Sqrt:  [[0.15]]
grads:  [-0.11916386]
Stock Position:  -0.11916386470209153
Bond Position:  [30.36775164]


portfolio before change:  [18.67510993]
curr_Stock_Price:  98.13830544350438
curr_Factors:  [98.13830544]
mat_Sqrt:  [[0.15]]
grads:  [0.04762853]
Stock Position:  0.047628527696448104
Bond Position:  [14.00092693]


portfolio before change:  [18.66764652]
curr_Stock_Price:  97.96323181805333
curr_Factors:  [97.96323182]
mat_Sqrt:  [[0.15]]
grads:  [0.18261545]
Stock Position:  0.18261544756213846
Bond Position:  [0.7780471]


portfolio before change:  [18.63334381]
curr_Stock_Price:  97.77512429184536
curr_Factors:  [97.77512429]
mat_Sqrt:  [[0.15]]
grads:  [-0.02008633]
Stock Position:  -0.020086326055425666
Bond Position:  [20.59728684]


portfolio before change:  [18.64689264]
curr_Stock_Price:  97.16468617457643
curr_Factors:  [97.16468617]
mat_Sqrt:  [[0.15]]
grads:  [0.03716259]
Stock Position:  0.03716258642022091
Bond Position:  [15.03600159]


portfolio before change:  [18.66115445]
curr_Stock_Price:  97.52316590246765
curr_Factors:  [97.5231659]
mat_Sqrt:  [[0.15]]
grads:  [-0.09865787]
Stock Position:  -0.09865786809401966
Bond Position:  [28.28258209]


portfolio before change:  [18.68089203]
curr_Stock_Price:  97.34102264348603
curr_Factors:  [97.34102264]
mat_Sqrt:  [[0.15]]
grads:  [0.12019277]
Stock Position:  0.12019277075087847
Bond Position:  [6.98120482]


portfolio before change:  [18.64791365]
curr_Stock_Price:  97.06301323259791
curr_Factors:  [97.06301323]
mat_Sqrt:  [[0.15]]
grads:  [0.06574329]
Stock Position:  0.06574329087276094
Bond Position:  [12.26667174]


portfolio before change:  [18.6271322]
curr_Stock_Price:  96.73525140797607
curr_Factors:  [96.73525141]
mat_Sqrt:  [[0.15]]
grads:  [0.03548045]
Stock Position:  0.03548045447715489
Bond Position:  [15.19492152]


portfolio before change:  [18.6031979]
curr_Stock_Price:  96.03390720292329
curr_Factors:  [96.0339072]
mat_Sqrt:  [[0.15]]
grads:  [-0.05554712]
Stock Position:  -0.05554711948351961
Bond Position:  [23.93760482]


portfolio before change:  [18.56146751]
curr_Stock_Price:  96.8121031330556
curr_Factors:  [96.81210313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00191929]
Stock Position:  -0.001919285572618176
Bond Position:  [18.74727758]


portfolio before change:  [18.56176301]
curr_Stock_Price:  97.26864564880843
curr_Factors:  [97.26864565]
mat_Sqrt:  [[0.15]]
grads:  [-0.03112588]
Stock Position:  -0.03112587646732524
Bond Position:  [21.58933486]


portfolio before change:  [18.55794991]
curr_Stock_Price:  97.43450368300157
curr_Factors:  [97.43450368]
mat_Sqrt:  [[0.15]]
grads:  [0.00819366]
Stock Position:  0.00819365770991219
Bond Position:  [17.75960494]


portfolio before change:  [18.55452677]
curr_Stock_Price:  96.8812527390225
curr_Factors:  [96.88125274]
mat_Sqrt:  [[0.15]]
grads:  [0.00328137]
Stock Position:  0.0032813658969707794
Bond Position:  [18.23662394]


portfolio before change:  [18.55315278]
curr_Stock_Price:  96.11516454238561
curr_Factors:  [96.11516454]
mat_Sqrt:  [[0.15]]
grads:  [0.05411113]
Stock Position:  0.05411112931783261
Bond Position:  [13.35225269]


portfolio before change:  [18.59510067]
curr_Stock_Price:  96.8749591630045
curr_Factors:  [96.87495916]
mat_Sqrt:  [[0.15]]
grads:  [-0.06635399]
Stock Position:  -0.06635398664603975
Bond Position:  [25.02314042]


portfolio before change:  [18.58576618]
curr_Stock_Price:  97.03920672335683
curr_Factors:  [97.03920672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03181462]
Stock Position:  -0.03181461953500802
Bond Position:  [21.67303163]


portfolio before change:  [18.57857109]
curr_Stock_Price:  97.3079416942082
curr_Factors:  [97.30794169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00593826]
Stock Position:  -0.0059382641418819085
Bond Position:  [19.15641135]


portfolio before change:  [18.58095148]
curr_Stock_Price:  97.10871166267852
curr_Factors:  [97.10871166]
mat_Sqrt:  [[0.15]]
grads:  [0.0825491]
Stock Position:  0.0825491000325839
Bond Position:  [10.56471473]


portfolio before change:  [18.57875584]
curr_Stock_Price:  97.07411455841367
curr_Factors:  [97.07411456]
mat_Sqrt:  [[0.15]]
grads:  [0.05334911]
Stock Position:  0.05334911440455382
Bond Position:  [13.3999378]


portfolio before change:  [18.58233204]
curr_Stock_Price:  97.12544964494862
curr_Factors:  [97.12544964]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249048]
Stock Position:  -0.022490484007540494
Bond Position:  [20.76673042]


portfolio before change:  [18.57858046]
curr_Stock_Price:  97.34996900236993
curr_Factors:  [97.349969]
mat_Sqrt:  [[0.15]]
grads:  [-0.03312341]
Stock Position:  -0.033123411160498065
Bond Position:  [21.80314351]


portfolio before change:  [18.58453283]
curr_Stock_Price:  97.21140739118185
curr_Factors:  [97.21140739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604367]
Stock Position:  -0.006043674071926729
Bond Position:  [19.17204689]


portfolio before change:  [18.58322259]
curr_Stock_Price:  97.62647339166892
curr_Factors:  [97.62647339]
mat_Sqrt:  [[0.15]]
grads:  [-0.03388661]
Stock Position:  -0.03388660753305713
Bond Position:  [21.89145258]


portfolio before change:  [18.60069316]
curr_Stock_Price:  97.15129151515342
curr_Factors:  [97.15129152]
mat_Sqrt:  [[0.15]]
grads:  [-0.01162591]
Stock Position:  -0.011625913251140414
Bond Position:  [19.73016564]


portfolio before change:  [18.60258746]
curr_Stock_Price:  97.09442430229643
curr_Factors:  [97.0944243]
mat_Sqrt:  [[0.15]]
grads:  [0.12720521]
Stock Position:  0.12720521427181963
Bond Position:  [6.25167041]


portfolio before change:  [18.51276149]
curr_Stock_Price:  96.38520245950666
curr_Factors:  [96.38520246]
mat_Sqrt:  [[0.15]]
grads:  [0.03503533]
Stock Position:  0.03503532951406572
Bond Position:  [15.13587416]


portfolio before change:  [18.5030127]
curr_Stock_Price:  96.07994451871646
curr_Factors:  [96.07994452]
mat_Sqrt:  [[0.15]]
grads:  [0.12498781]
Stock Position:  0.12498781240438772
Bond Position:  [6.49419062]


portfolio before change:  [18.56049749]
curr_Stock_Price:  96.5366201821355
curr_Factors:  [96.53662018]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488981]
Stock Position:  -0.014889814685767675
Bond Position:  [19.99790987]


portfolio before change:  [18.56348913]
curr_Stock_Price:  96.41964569097318
curr_Factors:  [96.41964569]
mat_Sqrt:  [[0.15]]
grads:  [0.035287]
Stock Position:  0.035287001026594926
Bond Position:  [15.16112899]


portfolio before change:  [18.54097901]
curr_Stock_Price:  95.75487636050518
curr_Factors:  [95.75487636]
mat_Sqrt:  [[0.15]]
grads:  [0.17334987]
Stock Position:  0.17334987335715651
Bond Position:  [1.94188332]


portfolio before change:  [18.63369294]
curr_Stock_Price:  96.28901326125661
curr_Factors:  [96.28901326]
mat_Sqrt:  [[0.15]]
grads:  [0.02190756]
Stock Position:  0.02190756437295256
Bond Position:  [16.52423519]


portfolio before change:  [18.64955651]
curr_Stock_Price:  96.9659834076763
curr_Factors:  [96.96598341]
mat_Sqrt:  [[0.15]]
grads:  [-0.10323199]
Stock Position:  -0.10323199351014989
Bond Position:  [28.65954828]


portfolio before change:  [18.63704932]
curr_Stock_Price:  97.10449154332171
curr_Factors:  [97.10449154]
mat_Sqrt:  [[0.15]]
grads:  [-0.03675972]
Stock Position:  -0.03675972371009688
Bond Position:  [22.2065836]


portfolio before change:  [18.58979809]
curr_Stock_Price:  98.42765645236415
curr_Factors:  [98.42765645]
mat_Sqrt:  [[0.15]]
grads:  [0.00643029]
Stock Position:  0.006430292726311301
Bond Position:  [17.95687945]


portfolio before change:  [18.5893753]
curr_Stock_Price:  98.18736608858774
curr_Factors:  [98.18736609]
mat_Sqrt:  [[0.15]]
grads:  [0.04605914]
Stock Position:  0.04605914264009577
Bond Position:  [14.0669494]


portfolio before change:  [18.58834926]
curr_Stock_Price:  98.14600086261707
curr_Factors:  [98.14600086]
mat_Sqrt:  [[0.15]]
grads:  [0.00023344]
Stock Position:  0.00023344193782238895
Bond Position:  [18.56543787]


portfolio before change:  [18.58938345]
curr_Stock_Price:  97.60542896490816
curr_Factors:  [97.60542896]
mat_Sqrt:  [[0.15]]
grads:  [-0.0101301]
Stock Position:  -0.010130103455612705
Bond Position:  [19.57813654]


portfolio before change:  [18.59405992]
curr_Stock_Price:  97.26458313362079
curr_Factors:  [97.26458313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974977]
Stock Position:  -0.049749769493940686
Bond Position:  [23.43295051]


portfolio before change:  [18.59307769]
curr_Stock_Price:  97.3137660530659
curr_Factors:  [97.31376605]
mat_Sqrt:  [[0.15]]
grads:  [-0.15266567]
Stock Position:  -0.15266566684748467
Bond Position:  [33.44954868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.58032979]
Stock Price:  97.4109625072832
PL:  [18.58032979]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.62456629e-02]
 [-2.53145637e-02]
 [ 4.69294442e-02]
 [-1.17796281e-02]
 [ 9.78565767e-03]
 [-1.73838231e-02]
 [-1.36566175e-02]
 [ 8.12471751e-02]
 [-2.13776047e-02]
 [-1.33946132e-02]
 [-1.47818600e-02]
 [-1.42475134e-03]
 [-1.80146743e-03]
 [-9.25286165e-03]
 [ 2.17511806e-03]
 [ 2.35413593e-03]
 [-2.57287042e-02]
 [-1.29045096e-02]
 [ 2.13603252e-02]
 [ 2.19191403e-03]
 [-3.93960421e-03]
 [ 4.57227835e-03]
 [ 1.49682962e-02]
 [ 1.72679068e-02]
 [-5.65924104e-03]
 [ 4.53066807e-03]
 [-2.33412529e-03]
 [ 5.34829297e-03]
 [ 2.46787199e-02]
 [ 4.84658242e-03]
 [-5.64872837e-03]
 [ 1.34565291e-02]
 [ 1.31556440e-02]
 [ 3.89005169e-03]
 [ 6.02937972e-03]
 [ 1.75379417e-02]
 [-2.77571721e-02]
 [ 2.36775049e-03]
 [-4.10453473e-02]
 [-1.12266765e-02]
 [ 4.03866072e-03]
 [ 1.00433555e-02]
 [-8.21951696e-03]
 [ 5.47680761e-04]
 [ 7.93250637e-03]
 [ 1.18373615e-02]
 [ 1.05744795e-02]
 [-1.61547771e-03]
 [ 1.19443953e-02]
 [-1.17118823e-03]
 [ 2.17710582e-02]
 [ 4.47807247e-03]
 [-2.41985515e-03]
 [-1.91822072e-02]
 [-3.47668551e-03]
 [-2.94481716e-03]
 [ 1.06721300e-02]
 [-6.98426276e-03]
 [ 5.70805057e-03]
 [-3.88830787e-03]
 [-3.28287947e-03]
 [ 8.23264999e-03]
 [-1.46863586e-02]
 [ 4.46719463e-03]
 [ 2.48748520e-02]
 [ 6.53162769e-03]
 [ 1.39795284e-02]
 [ 9.27741077e-03]
 [ 6.08647750e-03]
 [ 1.17479193e-02]
 [ 1.06520897e-03]
 [-1.52612089e-02]
 [-1.58862142e-02]
 [ 9.32546968e-04]
 [ 4.36446305e-05]
 [-1.98389793e-02]
 [-4.21883892e-03]
 [ 1.18253575e-02]
 [ 8.33234247e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-30.76273617]
curr_Stock_Price:  98.51062514296818
curr_Factors:  [98.51062514]
mat_Sqrt:  [[0.15]]
grads:  [-0.10830442]
Stock Position:  -0.1083044192423688
Bond Position:  [-20.09360012]


portfolio before change:  [-30.75462672]
curr_Stock_Price:  98.42415277846126
curr_Factors:  [98.42415278]
mat_Sqrt:  [[0.15]]
grads:  [-0.16876376]
Stock Position:  -0.1687637578092667
Bond Position:  [-14.14419684]


portfolio before change:  [-30.76828529]
curr_Stock_Price:  98.49984754290384
curr_Factors:  [98.49984754]
mat_Sqrt:  [[0.15]]
grads:  [0.31286296]
Stock Position:  0.31286296131654595
Bond Position:  [-61.58523928]


portfolio before change:  [-30.94716375]
curr_Stock_Price:  97.9404036802619
curr_Factors:  [97.94040368]
mat_Sqrt:  [[0.15]]
grads:  [-0.07853085]
Stock Position:  -0.07853085420233809
Bond Position:  [-23.25582019]


portfolio before change:  [-30.89361959]
curr_Stock_Price:  97.24007125876221
curr_Factors:  [97.24007126]
mat_Sqrt:  [[0.15]]
grads:  [0.06523772]
Stock Position:  0.06523771776946959
Bond Position:  [-37.23733991]


portfolio before change:  [-30.88143604]
curr_Stock_Price:  97.46250318633712
curr_Factors:  [97.46250319]
mat_Sqrt:  [[0.15]]
grads:  [-0.11589215]
Stock Position:  -0.11589215391645902
Bond Position:  [-19.58629662]


portfolio before change:  [-30.85952474]
curr_Stock_Price:  97.26287381397354
curr_Factors:  [97.26287381]
mat_Sqrt:  [[0.15]]
grads:  [-0.09104412]
Stock Position:  -0.0910441169624875
Bond Position:  [-22.00431228]


portfolio before change:  [-30.83367306]
curr_Stock_Price:  96.96382107041251
curr_Factors:  [96.96382107]
mat_Sqrt:  [[0.15]]
grads:  [0.54164783]
Stock Position:  0.5416478338891105
Bond Position:  [-83.35391671]


portfolio before change:  [-31.31670617]
curr_Stock_Price:  96.08165503499156
curr_Factors:  [96.08165503]
mat_Sqrt:  [[0.15]]
grads:  [-0.14251736]
Stock Position:  -0.14251736455359998
Bond Position:  [-17.62340191]


portfolio before change:  [-31.33823414]
curr_Stock_Price:  96.22498123243102
curr_Factors:  [96.22498123]
mat_Sqrt:  [[0.15]]
grads:  [-0.08929742]
Stock Position:  -0.08929742117810363
Bond Position:  [-22.74559146]


portfolio before change:  [-31.31309973]
curr_Stock_Price:  95.92759244240193
curr_Factors:  [95.92759244]
mat_Sqrt:  [[0.15]]
grads:  [-0.09854573]
Stock Position:  -0.09854573303759742
Bond Position:  [-21.85984481]


portfolio before change:  [-31.26108421]
curr_Stock_Price:  95.38589672133936
curr_Factors:  [95.38589672]
mat_Sqrt:  [[0.15]]
grads:  [-0.00949834]
Stock Position:  -0.009498342282796106
Bond Position:  [-30.35507631]


portfolio before change:  [-31.26287147]
curr_Stock_Price:  95.37431702290638
curr_Factors:  [95.37431702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01200978]
Stock Position:  -0.012009782896721343
Bond Position:  [-30.11744663]


portfolio before change:  [-31.27864473]
curr_Stock_Price:  96.53094549807194
curr_Factors:  [96.5309455]
mat_Sqrt:  [[0.15]]
grads:  [-0.06168574]
Stock Position:  -0.06168574431602573
Bond Position:  [-25.32406151]


portfolio before change:  [-31.32870618]
curr_Stock_Price:  97.31684266069239
curr_Factors:  [97.31684266]
mat_Sqrt:  [[0.15]]
grads:  [0.01450079]
Stock Position:  0.014500787095453188
Bond Position:  [-32.739877]


portfolio before change:  [-31.33200648]
curr_Stock_Price:  97.23036564291762
curr_Factors:  [97.23036564]
mat_Sqrt:  [[0.15]]
grads:  [0.01569424]
Stock Position:  0.015694239513496522
Bond Position:  [-32.85796312]


portfolio before change:  [-31.32969385]
curr_Stock_Price:  97.50857706158534
curr_Factors:  [97.50857706]
mat_Sqrt:  [[0.15]]
grads:  [-0.17152469]
Stock Position:  -0.17152469438439544
Bond Position:  [-14.60456497]


portfolio before change:  [-31.45134315]
curr_Stock_Price:  98.21247856726113
curr_Factors:  [98.21247857]
mat_Sqrt:  [[0.15]]
grads:  [-0.08603006]
Stock Position:  -0.08603006431423796
Bond Position:  [-23.0021173]


portfolio before change:  [-31.56068187]
curr_Stock_Price:  99.46670342354949
curr_Factors:  [99.46670342]
mat_Sqrt:  [[0.15]]
grads:  [0.14240217]
Stock Position:  0.14240216812697687
Bond Position:  [-45.7249561]


portfolio before change:  [-31.53975652]
curr_Stock_Price:  99.63371812050093
curr_Factors:  [99.63371812]
mat_Sqrt:  [[0.15]]
grads:  [0.01461276]
Stock Position:  0.0146127602061573
Bond Position:  [-32.99568015]


portfolio before change:  [-31.53803814]
curr_Stock_Price:  99.89244219193318
curr_Factors:  [99.89244219]
mat_Sqrt:  [[0.15]]
grads:  [-0.02626403]
Stock Position:  -0.026264028046058988
Bond Position:  [-28.91446024]


portfolio before change:  [-31.53499623]
curr_Stock_Price:  99.70781270162662
curr_Factors:  [99.7078127]
mat_Sqrt:  [[0.15]]
grads:  [0.03048186]
Stock Position:  0.03048185567244109
Bond Position:  [-34.57427539]


portfolio before change:  [-31.52273784]
curr_Stock_Price:  100.18085969343409
curr_Factors:  [100.18085969]
mat_Sqrt:  [[0.15]]
grads:  [0.09978864]
Stock Position:  0.0997886413380051
Bond Position:  [-41.51964972]


portfolio before change:  [-31.51383079]
curr_Stock_Price:  100.29612440623517
curr_Factors:  [100.29612441]
mat_Sqrt:  [[0.15]]
grads:  [0.11511938]
Stock Position:  0.11511937863335986
Bond Position:  [-43.05985832]


portfolio before change:  [-31.57516726]
curr_Stock_Price:  99.78669551998037
curr_Factors:  [99.78669552]
mat_Sqrt:  [[0.15]]
grads:  [-0.03772827]
Stock Position:  -0.0377282736314002
Bond Position:  [-27.8103875]


portfolio before change:  [-31.57394249]
curr_Stock_Price:  99.70816116605698
curr_Factors:  [99.70816117]
mat_Sqrt:  [[0.15]]
grads:  [0.03020445]
Stock Position:  0.030204453821114082
Bond Position:  [-34.58557304]


portfolio before change:  [-31.55856724]
curr_Stock_Price:  100.28876826671622
curr_Factors:  [100.28876827]
mat_Sqrt:  [[0.15]]
grads:  [-0.01556084]
Stock Position:  -0.0155608352520855
Bond Position:  [-29.99799024]


portfolio before change:  [-31.56210533]
curr_Stock_Price:  100.39564950109668
curr_Factors:  [100.3956495]
mat_Sqrt:  [[0.15]]
grads:  [0.03565529]
Stock Position:  0.03565528643917998
Bond Position:  [-35.14174097]


portfolio before change:  [-31.57602199]
curr_Stock_Price:  100.06693996070874
curr_Factors:  [100.06693996]
mat_Sqrt:  [[0.15]]
grads:  [0.1645248]
Stock Position:  0.16452479930006603
Bond Position:  [-48.03951521]


portfolio before change:  [-31.44361224]
curr_Stock_Price:  100.88999103972472
curr_Factors:  [100.88999104]
mat_Sqrt:  [[0.15]]
grads:  [0.03231055]
Stock Position:  0.032310549434322475
Bond Position:  [-34.70342329]


portfolio before change:  [-31.43928207]
curr_Stock_Price:  101.0911392716149
curr_Factors:  [101.09113927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765819]
Stock Position:  -0.03765818915905872
Bond Position:  [-27.63237282]


portfolio before change:  [-31.46715782]
curr_Stock_Price:  101.78550810699124
curr_Factors:  [101.78550811]
mat_Sqrt:  [[0.15]]
grads:  [0.08971019]
Stock Position:  0.08971019390055726
Bond Position:  [-40.59835549]


portfolio before change:  [-31.45253153]
curr_Stock_Price:  101.97683270334997
curr_Factors:  [101.9768327]
mat_Sqrt:  [[0.15]]
grads:  [0.08770429]
Stock Position:  0.08770429343185435
Bond Position:  [-40.39633759]


portfolio before change:  [-31.44673138]
curr_Stock_Price:  102.07175389560115
curr_Factors:  [102.0717539]
mat_Sqrt:  [[0.15]]
grads:  [0.02593368]
Stock Position:  0.02593367793369423
Bond Position:  [-34.09382737]


portfolio before change:  [-31.44282989]
curr_Stock_Price:  102.30436349406251
curr_Factors:  [102.30436349]
mat_Sqrt:  [[0.15]]
grads:  [0.04019586]
Stock Position:  0.040195864815265464
Bond Position:  [-35.55504225]


portfolio before change:  [-31.46768562]
curr_Stock_Price:  101.74128392662294
curr_Factors:  [101.74128393]
mat_Sqrt:  [[0.15]]
grads:  [0.11691961]
Stock Position:  0.11691961114635155
Bond Position:  [-43.36323697]


portfolio before change:  [-31.48677662]
curr_Stock_Price:  101.60118158695664
curr_Factors:  [101.60118159]
mat_Sqrt:  [[0.15]]
grads:  [-0.18504781]
Stock Position:  -0.18504781390516825
Bond Position:  [-12.68570007]


portfolio before change:  [-31.44376462]
curr_Stock_Price:  101.3644596347661
curr_Factors:  [101.36445963]
mat_Sqrt:  [[0.15]]
grads:  [0.015785]
Stock Position:  0.015785003293712314
Bond Position:  [-33.04380295]


portfolio before change:  [-31.44174203]
curr_Stock_Price:  101.62343288317486
curr_Factors:  [101.62343288]
mat_Sqrt:  [[0.15]]
grads:  [-0.27363565]
Stock Position:  -0.2736356485822398
Bond Position:  [-3.63394806]


portfolio before change:  [-31.53842517]
curr_Stock_Price:  101.9759308753805
curr_Factors:  [101.97593088]
mat_Sqrt:  [[0.15]]
grads:  [-0.07484451]
Stock Position:  -0.07484450970815364
Bond Position:  [-23.90608662]


portfolio before change:  [-31.57920212]
curr_Stock_Price:  102.50078924661287
curr_Factors:  [102.50078925]
mat_Sqrt:  [[0.15]]
grads:  [0.0269244]
Stock Position:  0.026924404811632816
Bond Position:  [-34.33897486]


portfolio before change:  [-31.56985014]
curr_Stock_Price:  102.92784542799834
curr_Factors:  [102.92784543]
mat_Sqrt:  [[0.15]]
grads:  [0.0669557]
Stock Position:  0.06695570344171031
Bond Position:  [-38.46145643]


portfolio before change:  [-31.57599254]
curr_Stock_Price:  102.87201026578686
curr_Factors:  [102.87201027]
mat_Sqrt:  [[0.15]]
grads:  [-0.05479678]
Stock Position:  -0.054796779729761894
Bond Position:  [-25.93893765]


portfolio before change:  [-31.57575709]
curr_Stock_Price:  102.83812722676257
curr_Factors:  [102.83812723]
mat_Sqrt:  [[0.15]]
grads:  [0.00365121]
Stock Position:  0.00365120507382995
Bond Position:  [-31.95124018]


portfolio before change:  [-31.57782272]
curr_Stock_Price:  102.81933325122864
curr_Factors:  [102.81933325]
mat_Sqrt:  [[0.15]]
grads:  [0.05288338]
Stock Position:  0.05288337582936888
Bond Position:  [-37.01525617]


portfolio before change:  [-31.53891572]
curr_Stock_Price:  103.59879417293526
curr_Factors:  [103.59879417]
mat_Sqrt:  [[0.15]]
grads:  [0.07891574]
Stock Position:  0.07891574354094548
Bond Position:  [-39.7144916]


portfolio before change:  [-31.53664512]
curr_Stock_Price:  103.6590208573824
curr_Factors:  [103.65902086]
mat_Sqrt:  [[0.15]]
grads:  [0.07049653]
Stock Position:  0.0704965300504128
Bond Position:  [-38.8442464]


portfolio before change:  [-31.57828802]
curr_Stock_Price:  103.10275161678169
curr_Factors:  [103.10275162]
mat_Sqrt:  [[0.15]]
grads:  [-0.01076985]
Stock Position:  -0.010769851414116785
Bond Position:  [-30.4678867]


portfolio before change:  [-31.58155718]
curr_Stock_Price:  103.22948186125137
curr_Factors:  [103.22948186]
mat_Sqrt:  [[0.15]]
grads:  [0.0796293]
Stock Position:  0.07962930166786611
Bond Position:  [-39.80164874]


portfolio before change:  [-31.62908026]
curr_Stock_Price:  102.66391877651783
curr_Factors:  [102.66391878]
mat_Sqrt:  [[0.15]]
grads:  [-0.00780792]
Stock Position:  -0.00780792155444262
Bond Position:  [-30.82748843]


portfolio before change:  [-31.63364375]
curr_Stock_Price:  103.00161565093143
curr_Factors:  [103.00161565]
mat_Sqrt:  [[0.15]]
grads:  [0.14514039]
Stock Position:  0.14514038800407594
Bond Position:  [-46.58333821]


portfolio before change:  [-31.51299689]
curr_Stock_Price:  103.85291837955822
curr_Factors:  [103.85291838]
mat_Sqrt:  [[0.15]]
grads:  [0.02985382]
Stock Position:  0.02985381645670893
Bond Position:  [-34.61340285]


portfolio before change:  [-31.51583393]
curr_Stock_Price:  103.83035405012367
curr_Factors:  [103.83035405]
mat_Sqrt:  [[0.15]]
grads:  [-0.01613237]
Stock Position:  -0.016132367668364764
Bond Position:  [-29.84080448]


portfolio before change:  [-31.51322152]
curr_Stock_Price:  103.55280577291592
curr_Factors:  [103.55280577]
mat_Sqrt:  [[0.15]]
grads:  [-0.12788138]
Stock Position:  -0.12788138113003722
Bond Position:  [-18.2707457]


portfolio before change:  [-31.49954085]
curr_Stock_Price:  103.43689657232952
curr_Factors:  [103.43689657]
mat_Sqrt:  [[0.15]]
grads:  [-0.0231779]
Stock Position:  -0.023177903375637476
Bond Position:  [-29.10209046]


portfolio before change:  [-31.50458476]
curr_Stock_Price:  103.57603648494883
curr_Factors:  [103.57603648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01963211]
Stock Position:  -0.01963211441580092
Bond Position:  [-29.47116816]


portfolio before change:  [-31.4851065]
curr_Stock_Price:  102.49004704720024
curr_Factors:  [102.49004705]
mat_Sqrt:  [[0.15]]
grads:  [0.07114753]
Stock Position:  0.07114753339828152
Bond Position:  [-38.77702054]


portfolio before change:  [-31.51721994]
curr_Stock_Price:  102.0727479721184
curr_Factors:  [102.07274797]
mat_Sqrt:  [[0.15]]
grads:  [-0.04656175]
Stock Position:  -0.046561751737882254
Bond Position:  [-26.76453399]


portfolio before change:  [-31.54151673]
curr_Stock_Price:  102.55863942682777
curr_Factors:  [102.55863943]
mat_Sqrt:  [[0.15]]
grads:  [0.03805367]
Stock Position:  0.03805367045208243
Bond Position:  [-35.4442494]


portfolio before change:  [-31.54417869]
curr_Stock_Price:  102.54690269572347
curr_Factors:  [102.5469027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02592205]
Stock Position:  -0.025922052439472234
Bond Position:  [-28.8859525]


portfolio before change:  [-31.55830198]
curr_Stock_Price:  103.0220912601767
curr_Factors:  [103.02209126]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188586]
Stock Position:  -0.021885863156295197
Bond Position:  [-29.30357459]


portfolio before change:  [-31.54435744]
curr_Stock_Price:  102.3012573116191
curr_Factors:  [102.30125731]
mat_Sqrt:  [[0.15]]
grads:  [0.05488433]
Stock Position:  0.0548843332711451
Bond Position:  [-37.15909374]


portfolio before change:  [-31.5702273]
curr_Stock_Price:  101.87222141528976
curr_Factors:  [101.87222142]
mat_Sqrt:  [[0.15]]
grads:  [-0.09790906]
Stock Position:  -0.09790905756403706
Bond Position:  [-21.59601411]


portfolio before change:  [-31.59792737]
curr_Stock_Price:  102.14135145157013
curr_Factors:  [102.14135145]
mat_Sqrt:  [[0.15]]
grads:  [0.0297813]
Stock Position:  0.029781297535769448
Bond Position:  [-34.63982934]


portfolio before change:  [-31.5948396]
curr_Stock_Price:  102.3177315226856
curr_Factors:  [102.31773152]
mat_Sqrt:  [[0.15]]
grads:  [0.16583235]
Stock Position:  0.16583234657527562
Bond Position:  [-48.56242911]


portfolio before change:  [-31.6043397]
curr_Stock_Price:  102.27874725210037
curr_Factors:  [102.27874725]
mat_Sqrt:  [[0.15]]
grads:  [0.04354418]
Stock Position:  0.043544184567694
Bond Position:  [-36.05798434]


portfolio before change:  [-31.57445943]
curr_Stock_Price:  103.016709382963
curr_Factors:  [103.01670938]
mat_Sqrt:  [[0.15]]
grads:  [0.09319686]
Stock Position:  0.09319685608100681
Bond Position:  [-41.17529287]


portfolio before change:  [-31.52376823]
curr_Stock_Price:  103.58823874419576
curr_Factors:  [103.58823874]
mat_Sqrt:  [[0.15]]
grads:  [0.06184941]
Stock Position:  0.061849405125798604
Bond Position:  [-37.93063917]


portfolio before change:  [-31.53398917]
curr_Stock_Price:  103.46131433887486
curr_Factors:  [103.46131434]
mat_Sqrt:  [[0.15]]
grads:  [0.04057652]
Stock Position:  0.04057651666433669
Bond Position:  [-35.73208891]


portfolio before change:  [-31.51982355]
curr_Stock_Price:  103.86546280557502
curr_Factors:  [103.86546281]
mat_Sqrt:  [[0.15]]
grads:  [0.07831946]
Stock Position:  0.0783194617325997
Bond Position:  [-39.65451069]


portfolio before change:  [-31.53698304]
curr_Stock_Price:  103.67801258069426
curr_Factors:  [103.67801258]
mat_Sqrt:  [[0.15]]
grads:  [0.00710139]
Stock Position:  0.0071013931417080135
Bond Position:  [-32.27324137]


portfolio before change:  [-31.53519272]
curr_Stock_Price:  104.21416964084685
curr_Factors:  [104.21416964]
mat_Sqrt:  [[0.15]]
grads:  [-0.10174139]
Stock Position:  -0.1017413927726359
Bond Position:  [-20.93229795]


portfolio before change:  [-31.59846246]
curr_Stock_Price:  104.82317873656326
curr_Factors:  [104.82317874]
mat_Sqrt:  [[0.15]]
grads:  [-0.10590809]
Stock Position:  -0.10590809457223738
Bond Position:  [-20.49683933]


portfolio before change:  [-31.55772551]
curr_Stock_Price:  104.42643808775647
curr_Factors:  [104.42643809]
mat_Sqrt:  [[0.15]]
grads:  [0.00621698]
Stock Position:  0.00621697978722353
Bond Position:  [-32.20694256]


portfolio before change:  [-31.55664191]
curr_Stock_Price:  104.92452437733066
curr_Factors:  [104.92452438]
mat_Sqrt:  [[0.15]]
grads:  [0.00029096]
Stock Position:  0.0002909642036191008
Bond Position:  [-31.58717119]


portfolio before change:  [-31.55874025]
curr_Stock_Price:  104.49808810083604
curr_Factors:  [104.4980881]
mat_Sqrt:  [[0.15]]
grads:  [-0.13225986]
Stock Position:  -0.1322598618565232
Bond Position:  [-17.73783755]


portfolio before change:  [-31.62024647]
curr_Stock_Price:  104.95474644620097
curr_Factors:  [104.95474645]
mat_Sqrt:  [[0.15]]
grads:  [-0.02812559]
Stock Position:  -0.028125592795403664
Bond Position:  [-28.66833201]


portfolio before change:  [-31.61704174]
curr_Stock_Price:  104.77709507255264
curr_Factors:  [104.77709507]
mat_Sqrt:  [[0.15]]
grads:  [0.07883572]
Stock Position:  0.07883571666821958
Bond Position:  [-39.87721912]


portfolio before change:  [-31.5877478]
curr_Stock_Price:  105.18029243646987
curr_Factors:  [105.18029244]
mat_Sqrt:  [[0.15]]
grads:  [0.05554895]
Stock Position:  0.05554894977729186
Bond Position:  [-37.43040258]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.52694168]
Stock Price:  106.31704811763625
PL:  [-37.8439898]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38029760e-02]
 [-9.44685533e-03]
 [ 4.63094311e-03]
 [-2.73852178e-02]
 [-1.92405386e-02]
 [-1.33461907e-03]
 [ 1.07438306e-03]
 [-4.40228762e-02]
 [ 1.75339033e-02]
 [-7.53415979e-03]
 [-1.15894183e-02]
 [ 2.03247313e-02]
 [-5.16568755e-03]
 [ 6.54868633e-03]
 [ 1.44173481e-02]
 [ 7.77330065e-03]
 [ 8.76564000e-02]
 [-7.54994085e-03]
 [ 2.74707042e-02]
 [-6.62659707e-04]
 [-1.27300500e-02]
 [ 9.17716797e-03]
 [-8.78298776e-03]
 [ 7.11523890e-02]
 [ 1.24386871e-02]
 [ 3.69793544e-03]
 [ 9.16953122e-02]
 [ 3.87119708e-02]
 [-3.41042446e-04]
 [-7.16960568e-03]
 [ 1.03116092e-02]
 [ 1.69473005e-02]
 [ 1.77583045e-02]
 [-1.28555629e-02]
 [ 3.35828210e-03]
 [-4.22433808e-02]
 [-8.47356887e-03]
 [-1.77841936e-02]
 [ 2.83744862e-02]
 [-8.43382570e-02]
 [ 2.90352239e-03]
 [-1.65932568e-02]
 [-2.94277562e-02]
 [ 3.94786443e-02]
 [-1.69942514e-02]
 [ 1.18935006e-02]
 [ 1.04067909e-02]
 [-3.55525612e-03]
 [ 1.50317968e-02]
 [-1.52016386e-03]
 [ 1.84420398e-02]
 [ 3.20735604e-02]
 [-9.82919207e-03]
 [-7.99635773e-02]
 [-2.89801427e-02]
 [-1.85222308e-03]
 [-8.35345909e-03]
 [-1.36546670e-02]
 [-7.66439939e-04]
 [-2.86703869e-03]
 [-7.46266197e-03]
 [-3.05928340e-03]
 [-1.68860039e-02]
 [-4.24881899e-04]
 [-1.36952380e-02]
 [ 3.41104151e-02]
 [-6.34713956e-03]
 [ 2.28748923e-02]
 [ 9.68539586e-03]
 [ 1.19404494e-02]
 [ 1.10359756e-02]
 [-1.41202576e-02]
 [-7.63908176e-02]
 [ 2.75105416e-04]
 [-1.51033170e-02]
 [-3.16591235e-02]
 [-6.61099275e-03]
 [ 2.55456700e-02]
 [ 1.09218514e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.11060164]
curr_Stock_Price:  99.67569252490857
curr_Factors:  [99.67569252]
mat_Sqrt:  [[0.15]]
grads:  [-0.09201984]
Stock Position:  -0.09201983989241393
Bond Position:  [4.06153963]


portfolio before change:  [-5.07551753]
curr_Stock_Price:  99.29718445231391
curr_Factors:  [99.29718445]
mat_Sqrt:  [[0.15]]
grads:  [-0.06297904]
Stock Position:  -0.06297903552497346
Bond Position:  [1.17812338]


portfolio before change:  [-5.10345343]
curr_Stock_Price:  99.74192829771566
curr_Factors:  [99.7419283]
mat_Sqrt:  [[0.15]]
grads:  [0.03087295]
Stock Position:  0.03087295409116548
Bond Position:  [-8.18278141]


portfolio before change:  [-5.05644666]
curr_Stock_Price:  101.28108160839173
curr_Factors:  [101.28108161]
mat_Sqrt:  [[0.15]]
grads:  [-0.18256812]
Stock Position:  -0.182568118646831
Bond Position:  [13.43424986]


portfolio before change:  [-5.0043505]
curr_Stock_Price:  101.00032888557628
curr_Factors:  [101.00032889]
mat_Sqrt:  [[0.15]]
grads:  [-0.12827026]
Stock Position:  -0.12827025734859915
Bond Position:  [7.95098768]


portfolio before change:  [-5.12494398]
curr_Stock_Price:  101.94435468796746
curr_Factors:  [101.94435469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00889746]
Stock Position:  -0.008897460479773979
Bond Position:  [-4.21789811]


portfolio before change:  [-5.12266495]
curr_Stock_Price:  101.65858112991378
curr_Factors:  [101.65858113]
mat_Sqrt:  [[0.15]]
grads:  [0.00716255]
Stock Position:  0.007162553738432066
Bond Position:  [-5.8508]


portfolio before change:  [-5.12059385]
curr_Stock_Price:  101.99879240709598
curr_Factors:  [101.99879241]
mat_Sqrt:  [[0.15]]
grads:  [-0.29348584]
Stock Position:  -0.293485841352029
Bond Position:  [24.81460755]


portfolio before change:  [-5.36754573]
curr_Stock_Price:  102.84552096093495
curr_Factors:  [102.84552096]
mat_Sqrt:  [[0.15]]
grads:  [0.11689269]
Stock Position:  0.11689268852938756
Bond Position:  [-17.38943518]


portfolio before change:  [-5.39384023]
curr_Stock_Price:  102.62987337585758
curr_Factors:  [102.62987338]
mat_Sqrt:  [[0.15]]
grads:  [-0.05022773]
Stock Position:  -0.05022773191902805
Bond Position:  [-0.23897447]


portfolio before change:  [-5.40080472]
curr_Stock_Price:  102.76823425685303
curr_Factors:  [102.76823426]
mat_Sqrt:  [[0.15]]
grads:  [-0.07726279]
Stock Position:  -0.07726278844584482
Bond Position:  [2.53935562]


portfolio before change:  [-5.42254458]
curr_Stock_Price:  103.05166397772982
curr_Factors:  [103.05166398]
mat_Sqrt:  [[0.15]]
grads:  [0.13549821]
Stock Position:  0.13549820882127278
Bond Position:  [-19.38586047]


portfolio before change:  [-5.36599205]
curr_Stock_Price:  103.47797357390063
curr_Factors:  [103.47797357]
mat_Sqrt:  [[0.15]]
grads:  [-0.03443792]
Stock Position:  -0.034437917031828136
Bond Position:  [-1.80242618]


portfolio before change:  [-5.37188674]
curr_Stock_Price:  103.64587110635593
curr_Factors:  [103.64587111]
mat_Sqrt:  [[0.15]]
grads:  [0.04365791]
Stock Position:  0.04365790889965361
Bond Position:  [-9.89684874]


portfolio before change:  [-5.37525849]
curr_Stock_Price:  103.5828087111454
curr_Factors:  [103.58280871]
mat_Sqrt:  [[0.15]]
grads:  [0.09611565]
Stock Position:  0.09611565430772115
Bond Position:  [-15.33118792]


portfolio before change:  [-5.33564462]
curr_Stock_Price:  104.00492624038061
curr_Factors:  [104.00492624]
mat_Sqrt:  [[0.15]]
grads:  [0.051822]
Stock Position:  0.05182200435271672
Bond Position:  [-10.72538836]


portfolio before change:  [-5.310548]
curr_Stock_Price:  104.50214689441455
curr_Factors:  [104.50214689]
mat_Sqrt:  [[0.15]]
grads:  [0.584376]
Stock Position:  0.5843760000075062
Bond Position:  [-66.3790946]


portfolio before change:  [-5.10379197]
curr_Stock_Price:  104.86305298874213
curr_Factors:  [104.86305299]
mat_Sqrt:  [[0.15]]
grads:  [-0.05033294]
Stock Position:  -0.05033293897183217
Bond Position:  [0.17427368]


portfolio before change:  [-5.14714165]
curr_Stock_Price:  105.72452820063445
curr_Factors:  [105.7245282]
mat_Sqrt:  [[0.15]]
grads:  [0.18313803]
Stock Position:  0.18313802787656022
Bond Position:  [-24.50932325]


portfolio before change:  [-5.05051888]
curr_Stock_Price:  106.26048819958001
curr_Factors:  [106.2604882]
mat_Sqrt:  [[0.15]]
grads:  [-0.00441773]
Stock Position:  -0.004417731378566824
Bond Position:  [-4.58108858]


portfolio before change:  [-5.05024853]
curr_Stock_Price:  106.13448044730585
curr_Factors:  [106.13448045]
mat_Sqrt:  [[0.15]]
grads:  [-0.084867]
Stock Position:  -0.08486700001034296
Bond Position:  [3.95706642]


portfolio before change:  [-5.07559263]
curr_Stock_Price:  106.4360278139574
curr_Factors:  [106.43602781]
mat_Sqrt:  [[0.15]]
grads:  [0.06118112]
Stock Position:  0.06118111980012528
Bond Position:  [-11.587468]


portfolio before change:  [-5.09900533]
curr_Stock_Price:  106.06518689892891
curr_Factors:  [106.0651869]
mat_Sqrt:  [[0.15]]
grads:  [-0.05855325]
Stock Position:  -0.058553251743255985
Bond Position:  [1.11145626]


portfolio before change:  [-5.08438463]
curr_Stock_Price:  105.81667410293525
curr_Factors:  [105.8166741]
mat_Sqrt:  [[0.15]]
grads:  [0.47434926]
Stock Position:  0.47434926029677105
Bond Position:  [-55.27844572]


portfolio before change:  [-4.57647783]
curr_Stock_Price:  106.89470215151795
curr_Factors:  [106.89470215]
mat_Sqrt:  [[0.15]]
grads:  [0.08292458]
Stock Position:  0.08292458046981292
Bond Position:  [-13.44067617]


portfolio before change:  [-4.57656682]
curr_Stock_Price:  106.90375953219434
curr_Factors:  [106.90375953]
mat_Sqrt:  [[0.15]]
grads:  [0.0246529]
Stock Position:  0.024652902966414442
Bond Position:  [-7.21205483]


portfolio before change:  [-4.60411692]
curr_Stock_Price:  105.80452491162602
curr_Factors:  [105.80452491]
mat_Sqrt:  [[0.15]]
grads:  [0.61130208]
Stock Position:  0.6113020812794462
Bond Position:  [-69.2826432]


portfolio before change:  [-4.55326853]
curr_Stock_Price:  105.89478910162532
curr_Factors:  [105.8947891]
mat_Sqrt:  [[0.15]]
grads:  [0.25807981]
Stock Position:  0.25807980527352303
Bond Position:  [-31.88257508]


portfolio before change:  [-4.78728813]
curr_Stock_Price:  104.99573821040148
curr_Factors:  [104.99573821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227362]
Stock Position:  -0.0022736163041727395
Bond Position:  [-4.54856811]


portfolio before change:  [-4.79106519]
curr_Stock_Price:  106.53195180080783
curr_Factors:  [106.5319518]
mat_Sqrt:  [[0.15]]
grads:  [-0.04779737]
Stock Position:  -0.0477973711937163
Bond Position:  [0.30088206]


portfolio before change:  [-4.79806624]
curr_Stock_Price:  106.67881881719038
curr_Factors:  [106.67881882]
mat_Sqrt:  [[0.15]]
grads:  [0.06874406]
Stock Position:  0.0687440614880693
Bond Position:  [-12.13160152]


portfolio before change:  [-4.8073634]
curr_Stock_Price:  106.5546057569584
curr_Factors:  [106.55460576]
mat_Sqrt:  [[0.15]]
grads:  [0.112982]
Stock Position:  0.11298200350620682
Bond Position:  [-16.84611624]


portfolio before change:  [-4.83382203]
curr_Stock_Price:  106.32974054260968
curr_Factors:  [106.32974054]
mat_Sqrt:  [[0.15]]
grads:  [0.1183887]
Stock Position:  0.1183886966326035
Bond Position:  [-17.42206143]


portfolio before change:  [-4.8176078]
curr_Stock_Price:  106.47589596547829
curr_Factors:  [106.47589597]
mat_Sqrt:  [[0.15]]
grads:  [-0.08570375]
Stock Position:  -0.08570375294994982
Bond Position:  [4.30777609]


portfolio before change:  [-4.86790405]
curr_Stock_Price:  107.06589927120588
curr_Factors:  [107.06589927]
mat_Sqrt:  [[0.15]]
grads:  [0.02238855]
Stock Position:  0.022388547359089232
Bond Position:  [-7.26495401]


portfolio before change:  [-4.85138337]
curr_Stock_Price:  107.82408843470057
curr_Factors:  [107.82408843]
mat_Sqrt:  [[0.15]]
grads:  [-0.28162254]
Stock Position:  -0.2816225385718533
Bond Position:  [25.51431013]


portfolio before change:  [-4.64957101]
curr_Stock_Price:  107.11314509961403
curr_Factors:  [107.1131451]
mat_Sqrt:  [[0.15]]
grads:  [-0.05649046]
Stock Position:  -0.05649045912028281
Bond Position:  [1.40129974]


portfolio before change:  [-4.61612476]
curr_Stock_Price:  106.52262651417253
curr_Factors:  [106.52262651]
mat_Sqrt:  [[0.15]]
grads:  [-0.11856129]
Stock Position:  -0.11856129060500473
Bond Position:  [8.01333532]


portfolio before change:  [-4.68216387]
curr_Stock_Price:  107.0838549087663
curr_Factors:  [107.08385491]
mat_Sqrt:  [[0.15]]
grads:  [0.18916324]
Stock Position:  0.1891632411139829
Bond Position:  [-24.93849294]


portfolio before change:  [-4.62915587]
curr_Stock_Price:  107.37231851393669
curr_Factors:  [107.37231851]
mat_Sqrt:  [[0.15]]
grads:  [-0.56225505]
Stock Position:  -0.562255046422957
Bond Position:  [55.74147206]


portfolio before change:  [-5.42901661]
curr_Stock_Price:  108.80110906140044
curr_Factors:  [108.80110906]
mat_Sqrt:  [[0.15]]
grads:  [0.01935682]
Stock Position:  0.0193568159466617
Bond Position:  [-7.53505965]


portfolio before change:  [-5.4209361]
curr_Stock_Price:  109.24288982199067
curr_Factors:  [109.24288982]
mat_Sqrt:  [[0.15]]
grads:  [-0.11062171]
Stock Position:  -0.11062171211649426
Bond Position:  [6.66369941]


portfolio before change:  [-5.50506903]
curr_Stock_Price:  110.00720111181401
curr_Factors:  [110.00720111]
mat_Sqrt:  [[0.15]]
grads:  [-0.19618504]
Stock Position:  -0.19618504123624478
Bond Position:  [16.07669826]


portfolio before change:  [-5.39403204]
curr_Stock_Price:  109.44634201886035
curr_Factors:  [109.44634202]
mat_Sqrt:  [[0.15]]
grads:  [0.26319096]
Stock Position:  0.26319096222904576
Bond Position:  [-34.19932011]


portfolio before change:  [-5.74622103]
curr_Stock_Price:  108.11631358291055
curr_Factors:  [108.11631358]
mat_Sqrt:  [[0.15]]
grads:  [-0.11329501]
Stock Position:  -0.11329500904024882
Bond Position:  [6.5028177]


portfolio before change:  [-5.65875319]
curr_Stock_Price:  107.3478649452577
curr_Factors:  [107.34786495]
mat_Sqrt:  [[0.15]]
grads:  [0.07929]
Stock Position:  0.07929000389785405
Bond Position:  [-14.17036582]


portfolio before change:  [-5.67558034]
curr_Stock_Price:  107.14681227106533
curr_Factors:  [107.14681227]
mat_Sqrt:  [[0.15]]
grads:  [0.06937861]
Stock Position:  0.06937860607648728
Bond Position:  [-13.10927682]


portfolio before change:  [-5.69127386]
curr_Stock_Price:  106.93242100318575
curr_Factors:  [106.932421]
mat_Sqrt:  [[0.15]]
grads:  [-0.02370171]
Stock Position:  -0.02370170749804371
Bond Position:  [-3.15679289]


portfolio before change:  [-5.68682721]
curr_Stock_Price:  106.73648786593506
curr_Factors:  [106.73648787]
mat_Sqrt:  [[0.15]]
grads:  [0.10021198]
Stock Position:  0.10021197899635695
Bond Position:  [-16.38310189]


portfolio before change:  [-5.7150035]
curr_Stock_Price:  106.46553907455338
curr_Factors:  [106.46553907]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013443]
Stock Position:  -0.010134425708889686
Bond Position:  [-4.63603641]


portfolio before change:  [-5.72179299]
curr_Stock_Price:  107.10688977443364
curr_Factors:  [107.10688977]
mat_Sqrt:  [[0.15]]
grads:  [0.12294693]
Stock Position:  0.12294693224390105
Bond Position:  [-18.89025651]


portfolio before change:  [-5.58981565]
curr_Stock_Price:  108.18994252893486
curr_Factors:  [108.18994253]
mat_Sqrt:  [[0.15]]
grads:  [0.21382374]
Stock Position:  0.21382373621496426
Bond Position:  [-28.72339338]


portfolio before change:  [-5.62702035]
curr_Stock_Price:  108.02434147627028
curr_Factors:  [108.02434148]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552795]
Stock Position:  -0.06552794716286736
Bond Position:  [1.45159299]


portfolio before change:  [-5.65017195]
curr_Stock_Price:  108.37903479908944
curr_Factors:  [108.3790348]
mat_Sqrt:  [[0.15]]
grads:  [-0.53309052]
Stock Position:  -0.5330905153557616
Bond Position:  [52.12566356]


portfolio before change:  [-5.89410624]
curr_Stock_Price:  108.8427313743528
curr_Factors:  [108.84273137]
mat_Sqrt:  [[0.15]]
grads:  [-0.19320095]
Stock Position:  -0.19320095128968073
Bond Position:  [15.134413]


portfolio before change:  [-5.75547156]
curr_Stock_Price:  108.13006018864857
curr_Factors:  [108.13006019]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234815]
Stock Position:  -0.012348153844083795
Bond Position:  [-4.42026494]


portfolio before change:  [-5.76123431]
curr_Stock_Price:  108.57437521506719
curr_Factors:  [108.57437522]
mat_Sqrt:  [[0.15]]
grads:  [-0.05568973]
Stock Position:  -0.05568972725407684
Bond Position:  [0.28524304]


portfolio before change:  [-5.75635913]
curr_Stock_Price:  108.48715365761801
curr_Factors:  [108.48715366]
mat_Sqrt:  [[0.15]]
grads:  [-0.09103111]
Stock Position:  -0.09103111344817816
Bond Position:  [4.11934726]


portfolio before change:  [-5.69756869]
curr_Stock_Price:  107.84415401563611
curr_Factors:  [107.84415402]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051096]
Stock Position:  -0.005109599590044431
Bond Position:  [-5.14652825]


portfolio before change:  [-5.70215018]
curr_Stock_Price:  108.6778441056545
curr_Factors:  [108.67784411]
mat_Sqrt:  [[0.15]]
grads:  [-0.01911359]
Stock Position:  -0.01911359129809641
Bond Position:  [-3.62492629]


portfolio before change:  [-5.67404664]
curr_Stock_Price:  107.19564687987251
curr_Factors:  [107.19564688]
mat_Sqrt:  [[0.15]]
grads:  [-0.04975108]
Stock Position:  -0.04975107981007259
Bond Position:  [-0.34094745]


portfolio before change:  [-5.67165137]
curr_Stock_Price:  107.1470734512553
curr_Factors:  [107.14707345]
mat_Sqrt:  [[0.15]]
grads:  [-0.02039522]
Stock Position:  -0.020395222649050276
Bond Position:  [-3.48636295]


portfolio before change:  [-5.68577633]
curr_Stock_Price:  107.82895180087594
curr_Factors:  [107.8289518]
mat_Sqrt:  [[0.15]]
grads:  [-0.11257336]
Stock Position:  -0.11257335961228
Bond Position:  [6.45289104]


portfolio before change:  [-5.74442642]
curr_Stock_Price:  108.35352887274621
curr_Factors:  [108.35352887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00283255]
Stock Position:  -0.002832545994746571
Bond Position:  [-5.43751006]


portfolio before change:  [-5.74768932]
curr_Stock_Price:  109.38547794384807
curr_Factors:  [109.38547794]
mat_Sqrt:  [[0.15]]
grads:  [-0.09130159]
Stock Position:  -0.09130158679461943
Bond Position:  [4.23937839]


portfolio before change:  [-5.74875383]
curr_Stock_Price:  109.40003935715345
curr_Factors:  [109.40003936]
mat_Sqrt:  [[0.15]]
grads:  [0.22740277]
Stock Position:  0.22740276730006787
Bond Position:  [-30.62662552]


portfolio before change:  [-5.77929814]
curr_Stock_Price:  109.27413901798626
curr_Factors:  [109.27413902]
mat_Sqrt:  [[0.15]]
grads:  [-0.04231426]
Stock Position:  -0.042314263754626276
Bond Position:  [-1.1554434]


portfolio before change:  [-5.76955097]
curr_Stock_Price:  109.04208044071709
curr_Factors:  [109.04208044]
mat_Sqrt:  [[0.15]]
grads:  [0.15249928]
Stock Position:  0.15249928195026055
Bond Position:  [-22.39838993]


portfolio before change:  [-5.67716082]
curr_Stock_Price:  109.6571003347909
curr_Factors:  [109.65710033]
mat_Sqrt:  [[0.15]]
grads:  [0.06456931]
Stock Position:  0.06456930574872817
Bond Position:  [-12.75764365]


portfolio before change:  [-5.67110651]
curr_Stock_Price:  109.76321394203164
curr_Factors:  [109.76321394]
mat_Sqrt:  [[0.15]]
grads:  [0.079603]
Stock Position:  0.0796029961406222
Bond Position:  [-14.40858721]


portfolio before change:  [-5.59795747]
curr_Stock_Price:  110.69345042302972
curr_Factors:  [110.69345042]
mat_Sqrt:  [[0.15]]
grads:  [0.07357317]
Stock Position:  0.07357317054802695
Bond Position:  [-13.74202557]


portfolio before change:  [-5.60479933]
curr_Stock_Price:  110.61213052692412
curr_Factors:  [110.61213053]
mat_Sqrt:  [[0.15]]
grads:  [-0.09413505]
Stock Position:  -0.09413505036039232
Bond Position:  [4.80767915]


portfolio before change:  [-5.66412912]
curr_Stock_Price:  111.2455850984066
curr_Factors:  [111.2455851]
mat_Sqrt:  [[0.15]]
grads:  [-0.50927212]
Stock Position:  -0.5092721173905032
Bond Position:  [50.99014555]


portfolio before change:  [-5.58789739]
curr_Stock_Price:  111.10215539588762
curr_Factors:  [111.1021554]
mat_Sqrt:  [[0.15]]
grads:  [0.00183404]
Stock Position:  0.0018340361096086562
Bond Position:  [-5.79166275]


portfolio before change:  [-5.59026468]
curr_Stock_Price:  110.0087725721645
curr_Factors:  [110.00877257]
mat_Sqrt:  [[0.15]]
grads:  [-0.10068878]
Stock Position:  -0.10068877984933845
Bond Position:  [5.4863844]


portfolio before change:  [-5.57282118]
curr_Stock_Price:  109.83893645577277
curr_Factors:  [109.83893646]
mat_Sqrt:  [[0.15]]
grads:  [-0.21106082]
Stock Position:  -0.21106082341000432
Bond Position:  [17.60987519]


portfolio before change:  [-5.67462045]
curr_Stock_Price:  110.32647325588101
curr_Factors:  [110.32647326]
mat_Sqrt:  [[0.15]]
grads:  [-0.04407328]
Stock Position:  -0.04407328497808046
Bond Position:  [-0.81217035]


portfolio before change:  [-5.7040069]
curr_Stock_Price:  110.99208484064
curr_Factors:  [110.99208484]
mat_Sqrt:  [[0.15]]
grads:  [0.17030447]
Stock Position:  0.17030446675380553
Bond Position:  [-24.60645472]


portfolio before change:  [-5.71150521]
curr_Stock_Price:  110.95708658133702
curr_Factors:  [110.95708658]
mat_Sqrt:  [[0.15]]
grads:  [0.72812343]
Stock Position:  0.7281234272436645
Bond Position:  [-86.50195937]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.89510722]
Stock Price:  110.71235407717968
PL:  [-16.6074613]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33082890e-02]
 [ 2.18441249e-02]
 [ 2.14321081e-02]
 [-1.65206727e-02]
 [-4.77053018e-02]
 [-1.29895608e-03]
 [ 1.12858340e-02]
 [-6.08305466e-02]
 [ 1.79428005e-02]
 [-9.26270558e-03]
 [-1.41985622e-02]
 [ 2.30745148e-02]
 [-5.27169932e-03]
 [ 8.27881241e-03]
 [ 1.30784804e-02]
 [ 9.29782102e-03]
 [ 9.65318926e-02]
 [-1.04561168e-02]
 [ 2.44750971e-02]
 [-4.76207972e-04]
 [-7.99706294e-03]
 [ 7.53375858e-03]
 [-4.58513120e-03]
 [ 5.90887555e-02]
 [ 8.66650661e-03]
 [ 5.25518104e-03]
 [ 8.30557577e-02]
 [ 3.18804291e-02]
 [ 9.64252126e-04]
 [-9.32389821e-03]
 [ 4.45829870e-03]
 [ 1.50917464e-02]
 [ 1.42965664e-02]
 [-5.71144970e-03]
 [ 4.78757499e-03]
 [ 8.91152994e-03]
 [-2.31335154e-02]
 [-8.62444662e-03]
 [-1.82012152e-02]
 [-1.47144883e-02]
 [ 3.71019415e-03]
 [ 1.07309199e-02]
 [-8.32577658e-03]
 [ 1.40122370e-03]
 [ 7.65602308e-03]
 [ 1.19615755e-02]
 [ 1.05675632e-02]
 [-2.65435539e-03]
 [ 1.40753990e-02]
 [-1.48789868e-03]
 [ 1.93217298e-02]
 [ 1.66593193e-02]
 [-6.02302494e-03]
 [-4.38013899e-02]
 [-1.12073997e-02]
 [-2.58305278e-03]
 [ 3.62819410e-03]
 [-1.61812844e-02]
 [ 2.71613800e-03]
 [-3.20402396e-03]
 [-5.25276745e-03]
 [ 5.42734224e-03]
 [-1.96490074e-02]
 [ 6.90901809e-04]
 [ 1.20263526e-02]
 [ 1.48402423e-02]
 [ 6.76989284e-03]
 [ 1.32067890e-02]
 [ 7.53826467e-03]
 [ 1.12893867e-02]
 [ 5.04359055e-03]
 [-1.48552538e-02]
 [-3.42079140e-02]
 [ 6.65145236e-04]
 [-6.56572974e-03]
 [-2.58676875e-02]
 [-5.80821876e-03]
 [ 1.98076487e-02]
 [ 4.91652781e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.29529847]
curr_Stock_Price:  99.53105012110566
curr_Factors:  [99.53105012]
mat_Sqrt:  [[0.15]]
grads:  [-0.08872193]
Stock Position:  -0.08872192640486154
Bond Position:  [0.53528803]


portfolio before change:  [-8.37626893]
curr_Stock_Price:  100.44405913031221
curr_Factors:  [100.44405913]
mat_Sqrt:  [[0.15]]
grads:  [0.1456275]
Stock Position:  0.1456274992958926
Bond Position:  [-23.00368608]


portfolio before change:  [-8.33944325]
curr_Stock_Price:  100.70680800163512
curr_Factors:  [100.706808]
mat_Sqrt:  [[0.15]]
grads:  [0.14288072]
Stock Position:  0.14288072038276803
Bond Position:  [-22.72850452]


portfolio before change:  [-8.34339107]
curr_Stock_Price:  100.68912021303123
curr_Factors:  [100.68912021]
mat_Sqrt:  [[0.15]]
grads:  [-0.11013782]
Stock Position:  -0.11013781832701071
Bond Position:  [2.74628896]


portfolio before change:  [-8.48806469]
curr_Stock_Price:  102.00424767885968
curr_Factors:  [102.00424768]
mat_Sqrt:  [[0.15]]
grads:  [-0.31803535]
Stock Position:  -0.3180353456481929
Bond Position:  [23.95289148]


portfolio before change:  [-8.41853299]
curr_Stock_Price:  101.79032619323355
curr_Factors:  [101.79032619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865971]
Stock Position:  -0.008659707226993345
Bond Position:  [-7.53705857]


portfolio before change:  [-8.42277953]
curr_Stock_Price:  102.22630622274839
curr_Factors:  [102.22630622]
mat_Sqrt:  [[0.15]]
grads:  [0.07523889]
Stock Position:  0.07523889366489284
Bond Position:  [-16.11417372]


portfolio before change:  [-8.36093353]
curr_Stock_Price:  103.06168762174939
curr_Factors:  [103.06168762]
mat_Sqrt:  [[0.15]]
grads:  [-0.40553698]
Stock Position:  -0.40553697746076445
Bond Position:  [33.43439176]


portfolio before change:  [-8.4485648]
curr_Stock_Price:  103.28292758466246
curr_Factors:  [103.28292758]
mat_Sqrt:  [[0.15]]
grads:  [0.11961867]
Stock Position:  0.11961867029943568
Bond Position:  [-20.80313126]


portfolio before change:  [-8.39455963]
curr_Stock_Price:  103.74527521212792
curr_Factors:  [103.74527521]
mat_Sqrt:  [[0.15]]
grads:  [-0.06175137]
Stock Position:  -0.061751370519802534
Bond Position:  [-1.9881467]


portfolio before change:  [-8.40681161]
curr_Stock_Price:  103.94167116783747
curr_Factors:  [103.94167117]
mat_Sqrt:  [[0.15]]
grads:  [-0.09465708]
Stock Position:  -0.09465708148316458
Bond Position:  [1.43200363]


portfolio before change:  [-8.38853369]
curr_Stock_Price:  103.7495206060515
curr_Factors:  [103.74952061]
mat_Sqrt:  [[0.15]]
grads:  [0.1538301]
Stock Position:  0.15383009859671753
Bond Position:  [-24.34833268]


portfolio before change:  [-8.41841239]
curr_Stock_Price:  103.56518162919274
curr_Factors:  [103.56518163]
mat_Sqrt:  [[0.15]]
grads:  [-0.03514466]
Stock Position:  -0.035144662130122926
Bond Position:  [-4.77864908]


portfolio before change:  [-8.44151362]
curr_Stock_Price:  104.21400129799405
curr_Factors:  [104.2140013]
mat_Sqrt:  [[0.15]]
grads:  [0.05519208]
Stock Position:  0.05519208276519943
Bond Position:  [-14.1933014]


portfolio before change:  [-8.48821454]
curr_Stock_Price:  103.38392188471147
curr_Factors:  [103.38392188]
mat_Sqrt:  [[0.15]]
grads:  [0.08718987]
Stock Position:  0.08718986958814148
Bond Position:  [-17.50224521]


portfolio before change:  [-8.49755462]
curr_Stock_Price:  103.28934484166963
curr_Factors:  [103.28934484]
mat_Sqrt:  [[0.15]]
grads:  [0.06198547]
Stock Position:  0.061985473495746034
Bond Position:  [-14.89999357]


portfolio before change:  [-8.5026164]
curr_Stock_Price:  103.2227082526949
curr_Factors:  [103.22270825]
mat_Sqrt:  [[0.15]]
grads:  [0.64354595]
Stock Position:  0.6435459503468992
Bond Position:  [-74.93117228]


portfolio before change:  [-8.69178903]
curr_Stock_Price:  102.93603209766866
curr_Factors:  [102.9360321]
mat_Sqrt:  [[0.15]]
grads:  [-0.06970745]
Stock Position:  -0.06970744557927035
Bond Position:  [-1.51638117]


portfolio before change:  [-8.73006166]
curr_Stock_Price:  103.48371908754031
curr_Factors:  [103.48371909]
mat_Sqrt:  [[0.15]]
grads:  [0.16316731]
Stock Position:  0.1631673140145094
Bond Position:  [-25.61522215]


portfolio before change:  [-8.65584325]
curr_Stock_Price:  103.94839191605168
curr_Factors:  [103.94839192]
mat_Sqrt:  [[0.15]]
grads:  [-0.00317472]
Stock Position:  -0.0031747198155561884
Bond Position:  [-8.32583623]


portfolio before change:  [-8.65673034]
curr_Stock_Price:  104.06390157779315
curr_Factors:  [104.06390158]
mat_Sqrt:  [[0.15]]
grads:  [-0.05331375]
Stock Position:  -0.053313752933532715
Bond Position:  [-3.1086932]


portfolio before change:  [-8.69107588]
curr_Stock_Price:  104.704472524735
curr_Factors:  [104.70447252]
mat_Sqrt:  [[0.15]]
grads:  [0.05022506]
Stock Position:  0.050225057200502896
Bond Position:  [-13.949864]


portfolio before change:  [-8.6858539]
curr_Stock_Price:  104.82580389192387
curr_Factors:  [104.82580389]
mat_Sqrt:  [[0.15]]
grads:  [-0.03056754]
Stock Position:  -0.030567541345539243
Bond Position:  [-5.4815868]


portfolio before change:  [-8.68287848]
curr_Stock_Price:  104.71725645002559
curr_Factors:  [104.71725645]
mat_Sqrt:  [[0.15]]
grads:  [0.39392504]
Stock Position:  0.39392503686008273
Bond Position:  [-49.93362759]


portfolio before change:  [-8.38879887]
curr_Stock_Price:  105.47171612928511
curr_Factors:  [105.47171613]
mat_Sqrt:  [[0.15]]
grads:  [0.05777671]
Stock Position:  0.05777671074701588
Bond Position:  [-14.48260771]


portfolio before change:  [-8.38862801]
curr_Stock_Price:  105.4903405087129
curr_Factors:  [105.49034051]
mat_Sqrt:  [[0.15]]
grads:  [0.03503454]
Stock Position:  0.035034540289199854
Bond Position:  [-12.08443359]


portfolio before change:  [-8.39631977]
curr_Stock_Price:  105.29235122273792
curr_Factors:  [105.29235122]
mat_Sqrt:  [[0.15]]
grads:  [0.55370505]
Stock Position:  0.5537050512471424
Bond Position:  [-66.6972265]


portfolio before change:  [-8.69205108]
curr_Stock_Price:  104.76578460546119
curr_Factors:  [104.76578461]
mat_Sqrt:  [[0.15]]
grads:  [0.21253619]
Stock Position:  0.21253619370225324
Bond Position:  [-30.95857217]


portfolio before change:  [-8.67405106]
curr_Stock_Price:  104.8595803517014
curr_Factors:  [104.85958035]
mat_Sqrt:  [[0.15]]
grads:  [0.00642835]
Stock Position:  0.006428347504777328
Bond Position:  [-9.34812488]


portfolio before change:  [-8.6790254]
curr_Stock_Price:  104.17665715331378
curr_Factors:  [104.17665715]
mat_Sqrt:  [[0.15]]
grads:  [-0.06215932]
Stock Position:  -0.06215932138984699
Bond Position:  [-2.20347509]


portfolio before change:  [-8.69255489]
curr_Stock_Price:  104.39209972318235
curr_Factors:  [104.39209972]
mat_Sqrt:  [[0.15]]
grads:  [0.02972199]
Stock Position:  0.029721991341212763
Bond Position:  [-11.79529597]


portfolio before change:  [-8.70107845]
curr_Stock_Price:  104.13012753688416
curr_Factors:  [104.13012754]
mat_Sqrt:  [[0.15]]
grads:  [0.10061164]
Stock Position:  0.10061164250824149
Bond Position:  [-19.17778162]


portfolio before change:  [-8.79659901]
curr_Stock_Price:  103.1926424251384
curr_Factors:  [103.19264243]
mat_Sqrt:  [[0.15]]
grads:  [0.09531044]
Stock Position:  0.09531044271857271
Bond Position:  [-18.63193545]


portfolio before change:  [-8.75350236]
curr_Stock_Price:  103.65703206595099
curr_Factors:  [103.65703207]
mat_Sqrt:  [[0.15]]
grads:  [-0.03807633]
Stock Position:  -0.03807633136659542
Bond Position:  [-4.80662286]


portfolio before change:  [-8.73645518]
curr_Stock_Price:  103.2014313021175
curr_Factors:  [103.2014313]
mat_Sqrt:  [[0.15]]
grads:  [0.03191717]
Stock Position:  0.03191716659055552
Bond Position:  [-12.03035246]


portfolio before change:  [-8.75412005]
curr_Stock_Price:  102.67152998458675
curr_Factors:  [102.67152998]
mat_Sqrt:  [[0.15]]
grads:  [0.0594102]
Stock Position:  0.05941019960242794
Bond Position:  [-14.85385614]


portfolio before change:  [-8.77742753]
curr_Stock_Price:  102.29484248261383
curr_Factors:  [102.29484248]
mat_Sqrt:  [[0.15]]
grads:  [-0.15422344]
Stock Position:  -0.15422343610848702
Bond Position:  [6.99883458]


portfolio before change:  [-8.9865679]
curr_Stock_Price:  103.65376572729589
curr_Factors:  [103.65376573]
mat_Sqrt:  [[0.15]]
grads:  [-0.05749631]
Stock Position:  -0.05749631081636247
Bond Position:  [-3.02685877]


portfolio before change:  [-8.96811522]
curr_Stock_Price:  103.32953860308253
curr_Factors:  [103.3295386]
mat_Sqrt:  [[0.15]]
grads:  [-0.12134143]
Stock Position:  -0.12134143472900911
Bond Position:  [3.57003925]


portfolio before change:  [-8.90752921]
curr_Stock_Price:  102.83207557924129
curr_Factors:  [102.83207558]
mat_Sqrt:  [[0.15]]
grads:  [-0.09809659]
Stock Position:  -0.09809658860180077
Bond Position:  [1.17994661]


portfolio before change:  [-8.9656091]
curr_Stock_Price:  103.42489575727251
curr_Factors:  [103.42489576]
mat_Sqrt:  [[0.15]]
grads:  [0.02473463]
Stock Position:  0.024734627684158197
Bond Position:  [-11.52378539]


portfolio before change:  [-8.98829789]
curr_Stock_Price:  102.5367266813231
curr_Factors:  [102.53672668]
mat_Sqrt:  [[0.15]]
grads:  [0.07153947]
Stock Position:  0.07153946632537575
Bond Position:  [-16.32372059]


portfolio before change:  [-8.96220562]
curr_Stock_Price:  102.9157137538366
curr_Factors:  [102.91571375]
mat_Sqrt:  [[0.15]]
grads:  [-0.05550518]
Stock Position:  -0.055505177219157
Bond Position:  [-3.24985069]


portfolio before change:  [-8.96820184]
curr_Stock_Price:  103.02008413026041
curr_Factors:  [103.02008413]
mat_Sqrt:  [[0.15]]
grads:  [0.00934149]
Stock Position:  0.009341491330204378
Bond Position:  [-9.93056306]


portfolio before change:  [-8.97015135]
curr_Stock_Price:  102.87783320805791
curr_Factors:  [102.87783321]
mat_Sqrt:  [[0.15]]
grads:  [0.05104015]
Stock Position:  0.05104015388767394
Bond Position:  [-14.22105179]


portfolio before change:  [-8.95401467]
curr_Stock_Price:  103.21140431111077
curr_Factors:  [103.21140431]
mat_Sqrt:  [[0.15]]
grads:  [0.07974384]
Stock Position:  0.07974383662388905
Bond Position:  [-17.18448804]


portfolio before change:  [-8.89601568]
curr_Stock_Price:  103.95218962772589
curr_Factors:  [103.95218963]
mat_Sqrt:  [[0.15]]
grads:  [0.07045042]
Stock Position:  0.07045042157556974
Bond Position:  [-16.21949126]


portfolio before change:  [-8.84142505]
curr_Stock_Price:  104.7414591805657
curr_Factors:  [104.74145918]
mat_Sqrt:  [[0.15]]
grads:  [-0.0176957]
Stock Position:  -0.01769570256688382
Bond Position:  [-6.98795134]


portfolio before change:  [-8.85794098]
curr_Stock_Price:  105.65010737390865
curr_Factors:  [105.65010737]
mat_Sqrt:  [[0.15]]
grads:  [0.09383599]
Stock Position:  0.0938359935850163
Bond Position:  [-18.77172378]


portfolio before change:  [-8.82608368]
curr_Stock_Price:  106.00211058625086
curr_Factors:  [106.00211059]
mat_Sqrt:  [[0.15]]
grads:  [-0.00991932]
Stock Position:  -0.009919324502197695
Bond Position:  [-7.77461435]


portfolio before change:  [-8.8286196]
curr_Stock_Price:  106.20877757671354
curr_Factors:  [106.20877758]
mat_Sqrt:  [[0.15]]
grads:  [0.12881153]
Stock Position:  0.12881153179422475
Bond Position:  [-22.50953493]


portfolio before change:  [-8.88688425]
curr_Stock_Price:  105.76737489613595
curr_Factors:  [105.7673749]
mat_Sqrt:  [[0.15]]
grads:  [0.11106213]
Stock Position:  0.11106212879365882
Bond Position:  [-20.63363406]


portfolio before change:  [-8.87800781]
curr_Stock_Price:  105.85891001573698
curr_Factors:  [105.85891002]
mat_Sqrt:  [[0.15]]
grads:  [-0.0401535]
Stock Position:  -0.04015349961556263
Bond Position:  [-4.6274021]


portfolio before change:  [-8.86489344]
curr_Stock_Price:  105.52510133610255
curr_Factors:  [105.52510134]
mat_Sqrt:  [[0.15]]
grads:  [-0.29200927]
Stock Position:  -0.29200926591684934
Bond Position:  [21.94941393]


portfolio before change:  [-8.76749513]
curr_Stock_Price:  105.19625412133264
curr_Factors:  [105.19625412]
mat_Sqrt:  [[0.15]]
grads:  [-0.074716]
Stock Position:  -0.07471599775140209
Bond Position:  [-0.90765204]


portfolio before change:  [-8.76745716]
curr_Stock_Price:  105.19498672771373
curr_Factors:  [105.19498673]
mat_Sqrt:  [[0.15]]
grads:  [-0.01722035]
Stock Position:  -0.017220351890869734
Bond Position:  [-6.95596247]


portfolio before change:  [-8.7702331]
curr_Stock_Price:  105.33094086471753
curr_Factors:  [105.33094086]
mat_Sqrt:  [[0.15]]
grads:  [0.02418796]
Stock Position:  0.024187960670251984
Bond Position:  [-11.31797376]


portfolio before change:  [-8.76084173]
curr_Stock_Price:  105.74845318475423
curr_Factors:  [105.74845318]
mat_Sqrt:  [[0.15]]
grads:  [-0.10787523]
Stock Position:  -0.10787522947079693
Bond Position:  [2.64679693]


portfolio before change:  [-8.68713114]
curr_Stock_Price:  105.06669192602334
curr_Factors:  [105.06669193]
mat_Sqrt:  [[0.15]]
grads:  [0.01810759]
Stock Position:  0.018107586666624455
Bond Position:  [-10.58963537]


portfolio before change:  [-8.68270498]
curr_Stock_Price:  105.34768107571988
curr_Factors:  [105.34768108]
mat_Sqrt:  [[0.15]]
grads:  [-0.02136016]
Stock Position:  -0.021360159711262816
Bond Position:  [-6.43246169]


portfolio before change:  [-8.66372399]
curr_Stock_Price:  104.44024239262504
curr_Factors:  [104.44024239]
mat_Sqrt:  [[0.15]]
grads:  [-0.03501845]
Stock Position:  -0.035018449663075824
Bond Position:  [-5.00638862]


portfolio before change:  [-8.64424234]
curr_Stock_Price:  103.8749817141949
curr_Factors:  [103.87498171]
mat_Sqrt:  [[0.15]]
grads:  [0.03618228]
Stock Position:  0.03618228160283055
Bond Position:  [-12.40267618]


portfolio before change:  [-8.62807347]
curr_Stock_Price:  104.34327915881686
curr_Factors:  [104.34327916]
mat_Sqrt:  [[0.15]]
grads:  [-0.13099338]
Stock Position:  -0.13099338279970685
Bond Position:  [5.04020564]


portfolio before change:  [-8.67798414]
curr_Stock_Price:  104.7267007606245
curr_Factors:  [104.72670076]
mat_Sqrt:  [[0.15]]
grads:  [0.00460601]
Stock Position:  0.004606012059309335
Bond Position:  [-9.16035658]


portfolio before change:  [-8.67808733]
curr_Stock_Price:  104.82860007116265
curr_Factors:  [104.82860007]
mat_Sqrt:  [[0.15]]
grads:  [0.08017568]
Stock Position:  0.0801756841047951
Bond Position:  [-17.08279205]


portfolio before change:  [-8.70238571]
curr_Stock_Price:  104.53885295475875
curr_Factors:  [104.53885295]
mat_Sqrt:  [[0.15]]
grads:  [0.09893495]
Stock Position:  0.09893494896450701
Bond Position:  [-19.04493179]


portfolio before change:  [-8.74270169]
curr_Stock_Price:  104.14338460069057
curr_Factors:  [104.1433846]
mat_Sqrt:  [[0.15]]
grads:  [0.04513262]
Stock Position:  0.04513261894625645
Bond Position:  [-13.44296539]


portfolio before change:  [-8.69855069]
curr_Stock_Price:  105.14025147032392
curr_Factors:  [105.14025147]
mat_Sqrt:  [[0.15]]
grads:  [0.08804526]
Stock Position:  0.08804525969908018
Bond Position:  [-17.95565144]


portfolio before change:  [-8.67653541]
curr_Stock_Price:  105.40304293507388
curr_Factors:  [105.40304294]
mat_Sqrt:  [[0.15]]
grads:  [0.0502551]
Stock Position:  0.05025509783303276
Bond Position:  [-13.97357565]


portfolio before change:  [-8.63316848]
curr_Stock_Price:  106.28335789336248
curr_Factors:  [106.28335789]
mat_Sqrt:  [[0.15]]
grads:  [0.07526258]
Stock Position:  0.07526257786108645
Bond Position:  [-16.63232797]


portfolio before change:  [-8.64434583]
curr_Stock_Price:  106.14865883830802
curr_Factors:  [106.14865884]
mat_Sqrt:  [[0.15]]
grads:  [0.03362394]
Stock Position:  0.03362393698640601
Bond Position:  [-12.21348164]


portfolio before change:  [-8.63656191]
curr_Stock_Price:  106.40286108647258
curr_Factors:  [106.40286109]
mat_Sqrt:  [[0.15]]
grads:  [-0.09903503]
Stock Position:  -0.09903502501930476
Bond Position:  [1.9010481]


portfolio before change:  [-8.67260261]
curr_Stock_Price:  106.76797954288405
curr_Factors:  [106.76797954]
mat_Sqrt:  [[0.15]]
grads:  [-0.22805276]
Stock Position:  -0.22805276007929606
Bond Position:  [15.67612981]


portfolio before change:  [-8.6207244]
curr_Stock_Price:  106.54479252289795
curr_Factors:  [106.54479252]
mat_Sqrt:  [[0.15]]
grads:  [0.0044343]
Stock Position:  0.004434301574070748
Bond Position:  [-9.09317615]


portfolio before change:  [-8.61863996]
curr_Stock_Price:  107.14303529697266
curr_Factors:  [107.1430353]
mat_Sqrt:  [[0.15]]
grads:  [-0.04377153]
Stock Position:  -0.04377153161862945
Bond Position:  [-3.9288252]


portfolio before change:  [-8.62234705]
curr_Stock_Price:  107.22211717428274
curr_Factors:  [107.22211717]
mat_Sqrt:  [[0.15]]
grads:  [-0.17245125]
Stock Position:  -0.17245125019444973
Bond Position:  [9.8682411]


portfolio before change:  [-8.71954561]
curr_Stock_Price:  107.78932293293147
curr_Factors:  [107.78932293]
mat_Sqrt:  [[0.15]]
grads:  [-0.03872146]
Stock Position:  -0.03872145838385511
Bond Position:  [-4.54578583]


portfolio before change:  [-8.72536679]
curr_Stock_Price:  107.93232023685621
curr_Factors:  [107.93232024]
mat_Sqrt:  [[0.15]]
grads:  [0.13205099]
Stock Position:  0.13205099151238117
Bond Position:  [-22.9779367]


portfolio before change:  [-8.78146056]
curr_Stock_Price:  107.51840735805912
curr_Factors:  [107.51840736]
mat_Sqrt:  [[0.15]]
grads:  [0.32776852]
Stock Position:  0.3277685203918144
Bond Position:  [-44.02260986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.92731067]
Stock Price:  107.08182301314837
PL:  [-16.00913368]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.23754774e-03]
 [ 1.17154169e-02]
 [ 2.76863862e-03]
 [-1.07036528e-02]
 [ 6.62140351e-04]
 [-1.45747109e-03]
 [-8.22324763e-03]
 [-3.17542595e-02]
 [ 1.34910518e-02]
 [-7.03163393e-03]
 [-1.05155092e-02]
 [ 1.69014440e-02]
 [-3.37003698e-03]
 [ 6.95171161e-03]
 [-1.99291069e-03]
 [ 1.60983200e-02]
 [ 7.74736424e-02]
 [-1.29873161e-02]
 [ 2.24223204e-02]
 [ 9.96145896e-04]
 [-5.12492068e-03]
 [ 5.85781180e-03]
 [ 4.19169915e-03]
 [ 3.92869793e-02]
 [ 2.78206730e-03]
 [ 8.23045891e-03]
 [ 1.65017146e-02]
 [ 1.88715624e-02]
 [ 2.16068978e-02]
 [-7.55483970e-03]
 [ 2.15070291e-03]
 [ 1.47878227e-02]
 [ 1.45573329e-02]
 [-8.65959778e-03]
 [ 4.17470480e-03]
 [-1.99627107e-02]
 [-9.45248787e-03]
 [-1.43855587e-02]
 [ 1.36051393e-02]
 [-4.95052929e-02]
 [ 3.33744370e-03]
 [ 1.41613876e-03]
 [-1.55186372e-02]
 [ 1.27315325e-02]
 [-6.09241648e-03]
 [ 1.16743936e-02]
 [ 1.04150227e-02]
 [-3.58686455e-03]
 [ 1.54725182e-02]
 [-1.56414085e-03]
 [ 1.77732789e-02]
 [ 3.16302068e-02]
 [-1.02117529e-02]
 [-7.21697543e-02]
 [-2.39934990e-02]
 [-1.92957687e-03]
 [-7.65610144e-03]
 [-1.46072163e-02]
 [-3.45618382e-03]
 [-2.61848718e-03]
 [-8.53031465e-03]
 [-1.39117899e-02]
 [-1.43988103e-02]
 [-1.08601781e-03]
 [-1.89291566e-02]
 [ 3.95726535e-02]
 [-7.84023946e-03]
 [ 2.36212760e-02]
 [ 9.87965997e-03]
 [ 1.21824411e-02]
 [ 1.14995120e-02]
 [-1.39932143e-02]
 [-8.07291164e-02]
 [ 2.62684199e-04]
 [-2.07439128e-02]
 [-3.62933842e-02]
 [-6.60852792e-03]
 [ 2.74200872e-02]
 [ 1.34605634e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.13898247]
curr_Stock_Price:  100.1412076305459
curr_Factors:  [100.14120763]
mat_Sqrt:  [[0.15]]
grads:  [-0.04825032]
Stock Position:  -0.04825031829587607
Bond Position:  [9.97082761]


portfolio before change:  [5.14439809]
curr_Stock_Price:  100.04188330104616
curr_Factors:  [100.0418833]
mat_Sqrt:  [[0.15]]
grads:  [0.07810278]
Stock Position:  0.0781027795301182
Bond Position:  [-2.66915106]


portfolio before change:  [5.14186911]
curr_Stock_Price:  100.01163908114418
curr_Factors:  [100.01163908]
mat_Sqrt:  [[0.15]]
grads:  [0.01845759]
Stock Position:  0.01845759082101918
Bond Position:  [3.2958952]


portfolio before change:  [5.14987894]
curr_Stock_Price:  100.43443699015633
curr_Factors:  [100.43443699]
mat_Sqrt:  [[0.15]]
grads:  [-0.07135769]
Stock Position:  -0.07135768504800519
Bond Position:  [12.31664786]


portfolio before change:  [5.14463149]
curr_Stock_Price:  100.51876234440545
curr_Factors:  [100.51876234]
mat_Sqrt:  [[0.15]]
grads:  [0.00441427]
Stock Position:  0.004414269004417472
Bond Position:  [4.70091463]


portfolio before change:  [5.1462841]
curr_Stock_Price:  100.82658108142881
curr_Factors:  [100.82658108]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971647]
Stock Position:  -0.009716473946443448
Bond Position:  [6.12596295]


portfolio before change:  [5.14357369]
curr_Stock_Price:  101.1449374330214
curr_Factors:  [101.14493743]
mat_Sqrt:  [[0.15]]
grads:  [-0.05482165]
Stock Position:  -0.05482165084430402
Bond Position:  [10.68850613]


portfolio before change:  [5.13996545]
curr_Stock_Price:  101.2229410470967
curr_Factors:  [101.22294105]
mat_Sqrt:  [[0.15]]
grads:  [-0.21169506]
Stock Position:  -0.21169506353977297
Bond Position:  [26.56836239]


portfolio before change:  [5.10942761]
curr_Stock_Price:  101.37503916438556
curr_Factors:  [101.37503916]
mat_Sqrt:  [[0.15]]
grads:  [0.08994035]
Stock Position:  0.08994034550955626
Bond Position:  [-4.00827844]


portfolio before change:  [5.1928722]
curr_Stock_Price:  102.30560179850765
curr_Factors:  [102.3056018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04687756]
Stock Position:  -0.04687755950190315
Bond Position:  [9.98870914]


portfolio before change:  [5.1972889]
curr_Stock_Price:  102.22470214915583
curr_Factors:  [102.22470215]
mat_Sqrt:  [[0.15]]
grads:  [-0.07010339]
Stock Position:  -0.07010339472603667
Bond Position:  [12.36358754]


portfolio before change:  [5.22477897]
curr_Stock_Price:  101.84358895478856
curr_Factors:  [101.84358895]
mat_Sqrt:  [[0.15]]
grads:  [0.11267629]
Stock Position:  0.11267629301286627
Bond Position:  [-6.2505791]


portfolio before change:  [5.13650643]
curr_Stock_Price:  101.06363900229285
curr_Factors:  [101.063639]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246691]
Stock Position:  -0.022466913218812716
Bond Position:  [7.40709444]


portfolio before change:  [5.14514854]
curr_Stock_Price:  100.69958591602504
curr_Factors:  [100.69958592]
mat_Sqrt:  [[0.15]]
grads:  [0.04634474]
Stock Position:  0.046344744094506674
Bond Position:  [0.478252]


portfolio before change:  [5.1443567]
curr_Stock_Price:  100.6818550246896
curr_Factors:  [100.68185502]
mat_Sqrt:  [[0.15]]
grads:  [-0.01328607]
Stock Position:  -0.013286071290792591
Bond Position:  [6.482023]


portfolio before change:  [5.14079885]
curr_Stock_Price:  100.9801361327739
curr_Factors:  [100.98013613]
mat_Sqrt:  [[0.15]]
grads:  [0.10732213]
Stock Position:  0.10732213356352
Bond Position:  [-5.69660481]


portfolio before change:  [5.21520783]
curr_Stock_Price:  101.67677736454037
curr_Factors:  [101.67677736]
mat_Sqrt:  [[0.15]]
grads:  [0.51649095]
Stock Position:  0.5164909491271468
Bond Position:  [-47.29992742]


portfolio before change:  [5.28346935]
curr_Stock_Price:  101.81466527847704
curr_Factors:  [101.81466528]
mat_Sqrt:  [[0.15]]
grads:  [-0.08658211]
Stock Position:  -0.086582107361279
Bond Position:  [14.09879763]


portfolio before change:  [5.22717471]
curr_Stock_Price:  102.47503079142027
curr_Factors:  [102.47503079]
mat_Sqrt:  [[0.15]]
grads:  [0.14948214]
Stock Position:  0.1494821357851139
Bond Position:  [-10.09101176]


portfolio before change:  [5.19222168]
curr_Stock_Price:  102.24542260970125
curr_Factors:  [102.24542261]
mat_Sqrt:  [[0.15]]
grads:  [0.00664097]
Stock Position:  0.006640972641708401
Bond Position:  [4.51321263]


portfolio before change:  [5.19132913]
curr_Stock_Price:  102.06854522489873
curr_Factors:  [102.06854522]
mat_Sqrt:  [[0.15]]
grads:  [-0.03416614]
Stock Position:  -0.034166137899281614
Bond Position:  [8.67861712]


portfolio before change:  [5.16285583]
curr_Stock_Price:  102.9177993229328
curr_Factors:  [102.91779932]
mat_Sqrt:  [[0.15]]
grads:  [0.03905208]
Stock Position:  0.03905207867947317
Bond Position:  [1.14370183]


portfolio before change:  [5.17082269]
curr_Stock_Price:  103.11997500847002
curr_Factors:  [103.11997501]
mat_Sqrt:  [[0.15]]
grads:  [0.02794466]
Stock Position:  0.027944661004026088
Bond Position:  [2.28916995]


portfolio before change:  [5.16517142]
curr_Stock_Price:  102.91262418134572
curr_Factors:  [102.91262418]
mat_Sqrt:  [[0.15]]
grads:  [0.2619132]
Stock Position:  0.26191319548818975
Bond Position:  [-21.78900283]


portfolio before change:  [5.17608409]
curr_Stock_Price:  102.95948902044303
curr_Factors:  [102.95948902]
mat_Sqrt:  [[0.15]]
grads:  [0.01854712]
Stock Position:  0.018547115303304343
Bond Position:  [3.26648257]


portfolio before change:  [5.17193671]
curr_Stock_Price:  102.72486859390312
curr_Factors:  [102.72486859]
mat_Sqrt:  [[0.15]]
grads:  [0.05486973]
Stock Position:  0.054869726083913765
Bond Position:  [-0.46454869]


portfolio before change:  [5.17163732]
curr_Stock_Price:  102.71994123923525
curr_Factors:  [102.71994124]
mat_Sqrt:  [[0.15]]
grads:  [0.11001143]
Stock Position:  0.11001143060524228
Bond Position:  [-6.12873037]


portfolio before change:  [5.16329594]
curr_Stock_Price:  102.647600372903
curr_Factors:  [102.64760037]
mat_Sqrt:  [[0.15]]
grads:  [0.12581042]
Stock Position:  0.12581041594083184
Bond Position:  [-7.75084136]


portfolio before change:  [5.1665438]
curr_Stock_Price:  102.67726652066088
curr_Factors:  [102.67726652]
mat_Sqrt:  [[0.15]]
grads:  [0.14404599]
Stock Position:  0.1440459856393987
Bond Position:  [-9.62370425]


portfolio before change:  [5.28711469]
curr_Stock_Price:  103.51847277146578
curr_Factors:  [103.51847277]
mat_Sqrt:  [[0.15]]
grads:  [-0.0503656]
Stock Position:  -0.050365597971775956
Bond Position:  [10.50088447]


portfolio before change:  [5.2850703]
curr_Stock_Price:  103.57209504225445
curr_Factors:  [103.57209504]
mat_Sqrt:  [[0.15]]
grads:  [0.01433802]
Stock Position:  0.014338019418937028
Bond Position:  [3.80005159]


portfolio before change:  [5.28761514]
curr_Stock_Price:  103.7330190709682
curr_Factors:  [103.73301907]
mat_Sqrt:  [[0.15]]
grads:  [0.09858548]
Stock Position:  0.09858548486407068
Bond Position:  [-4.93895484]


portfolio before change:  [5.26142834]
curr_Stock_Price:  103.47052496450887
curr_Factors:  [103.47052496]
mat_Sqrt:  [[0.15]]
grads:  [0.09704889]
Stock Position:  0.09704888586534662
Bond Position:  [-4.78027083]


portfolio before change:  [5.3722483]
curr_Stock_Price:  104.61550195936636
curr_Factors:  [104.61550196]
mat_Sqrt:  [[0.15]]
grads:  [-0.05773065]
Stock Position:  -0.05773065186469476
Bond Position:  [11.41176942]


portfolio before change:  [5.3589339]
curr_Stock_Price:  104.85848650725855
curr_Factors:  [104.85848651]
mat_Sqrt:  [[0.15]]
grads:  [0.02783137]
Stock Position:  0.027831365331079008
Bond Position:  [2.44057906]


portfolio before change:  [5.38924628]
curr_Stock_Price:  105.94215003603438
curr_Factors:  [105.94215004]
mat_Sqrt:  [[0.15]]
grads:  [-0.13308474]
Stock Position:  -0.13308473806795806
Bond Position:  [19.48852957]


portfolio before change:  [5.49077688]
curr_Stock_Price:  105.1884006921044
curr_Factors:  [105.18840069]
mat_Sqrt:  [[0.15]]
grads:  [-0.06301659]
Stock Position:  -0.06301658582346713
Bond Position:  [12.11939076]


portfolio before change:  [5.50206931]
curr_Stock_Price:  105.02122345957864
curr_Factors:  [105.02122346]
mat_Sqrt:  [[0.15]]
grads:  [-0.09590372]
Stock Position:  -0.09590372475001598
Bond Position:  [15.57399582]


portfolio before change:  [5.41940294]
curr_Stock_Price:  105.89334573611475
curr_Factors:  [105.89334574]
mat_Sqrt:  [[0.15]]
grads:  [0.09070093]
Stock Position:  0.09070092876628882
Bond Position:  [-4.18522187]


portfolio before change:  [5.34758473]
curr_Stock_Price:  105.10441638062873
curr_Factors:  [105.10441638]
mat_Sqrt:  [[0.15]]
grads:  [-0.33003529]
Stock Position:  -0.3300352861029119
Bond Position:  [40.03575086]


portfolio before change:  [5.20726467]
curr_Stock_Price:  105.53716517361936
curr_Factors:  [105.53716517]
mat_Sqrt:  [[0.15]]
grads:  [0.02224962]
Stock Position:  0.022249624643482024
Bond Position:  [2.85910236]


portfolio before change:  [5.20400553]
curr_Stock_Price:  105.38265273617856
curr_Factors:  [105.38265274]
mat_Sqrt:  [[0.15]]
grads:  [0.00944093]
Stock Position:  0.009440925097096894
Bond Position:  [4.20909579]


portfolio before change:  [5.20440294]
curr_Stock_Price:  105.39688222331519
curr_Factors:  [105.39688222]
mat_Sqrt:  [[0.15]]
grads:  [-0.10345758]
Stock Position:  -0.10345758165165508
Bond Position:  [16.10850949]


portfolio before change:  [5.25048123]
curr_Stock_Price:  104.96123051436783
curr_Factors:  [104.96123051]
mat_Sqrt:  [[0.15]]
grads:  [0.08487688]
Stock Position:  0.08487688349957487
Bond Position:  [-3.65830091]


portfolio before change:  [5.32032508]
curr_Stock_Price:  105.78680870905002
curr_Factors:  [105.78680871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04061611]
Stock Position:  -0.04061610984136014
Bond Position:  [9.61697372]


portfolio before change:  [5.31233621]
curr_Stock_Price:  105.99830001038941
curr_Factors:  [105.99830001]
mat_Sqrt:  [[0.15]]
grads:  [0.07782929]
Stock Position:  0.07782929084272346
Bond Position:  [-2.93743631]


portfolio before change:  [5.39463603]
curr_Stock_Price:  107.05809916006352
curr_Factors:  [107.05809916]
mat_Sqrt:  [[0.15]]
grads:  [0.06943348]
Stock Position:  0.06943348454986907
Bond Position:  [-2.03878085]


portfolio before change:  [5.39134859]
curr_Stock_Price:  107.01258785751259
curr_Factors:  [107.01258786]
mat_Sqrt:  [[0.15]]
grads:  [-0.02391243]
Stock Position:  -0.023912430341802324
Bond Position:  [7.95027964]


portfolio before change:  [5.3864767]
curr_Stock_Price:  107.23710707865337
curr_Factors:  [107.23710708]
mat_Sqrt:  [[0.15]]
grads:  [0.10315012]
Stock Position:  0.10315012159037093
Bond Position:  [-5.67504394]


portfolio before change:  [5.37168909]
curr_Stock_Price:  107.09718571863702
curr_Factors:  [107.09718572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01042761]
Stock Position:  -0.010427605689781693
Bond Position:  [6.48845631]


portfolio before change:  [5.36487383]
curr_Stock_Price:  107.78965572138652
curr_Factors:  [107.78965572]
mat_Sqrt:  [[0.15]]
grads:  [0.11848853]
Stock Position:  0.11848852618323226
Bond Position:  [-7.40696362]


portfolio before change:  [5.40358407]
curr_Stock_Price:  108.12026319012048
curr_Factors:  [108.12026319]
mat_Sqrt:  [[0.15]]
grads:  [0.21086805]
Stock Position:  0.21086804541662424
Bond Position:  [-17.3955245]


portfolio before change:  [5.43364924]
curr_Stock_Price:  108.26799740690635
curr_Factors:  [108.26799741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06807835]
Stock Position:  -0.06807835276060971
Bond Position:  [12.80435616]


portfolio before change:  [5.46876471]
curr_Stock_Price:  107.76394334710281
curr_Factors:  [107.76394335]
mat_Sqrt:  [[0.15]]
grads:  [-0.4811317]
Stock Position:  -0.4811316951214114
Bond Position:  [57.31741344]


portfolio before change:  [5.43372516]
curr_Stock_Price:  107.84421658947716
curr_Factors:  [107.84421659]
mat_Sqrt:  [[0.15]]
grads:  [-0.15995666]
Stock Position:  -0.15995666023693905
Bond Position:  [22.68412587]


portfolio before change:  [5.42736598]
curr_Stock_Price:  107.89283591754648
curr_Factors:  [107.89283592]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286385]
Stock Position:  -0.01286384578002316
Bond Position:  [6.81528278]


portfolio before change:  [5.4214531]
curr_Stock_Price:  108.38560045048298
curr_Factors:  [108.38560045]
mat_Sqrt:  [[0.15]]
grads:  [-0.05104068]
Stock Position:  -0.05104067624682583
Bond Position:  [10.95352744]


portfolio before change:  [5.38270615]
curr_Stock_Price:  109.15815214314273
curr_Factors:  [109.15815214]
mat_Sqrt:  [[0.15]]
grads:  [-0.09738144]
Stock Position:  -0.09738144182491522
Bond Position:  [16.0126844]


portfolio before change:  [5.28691668]
curr_Stock_Price:  110.15208175455358
curr_Factors:  [110.15208175]
mat_Sqrt:  [[0.15]]
grads:  [-0.02304123]
Stock Position:  -0.023041225476392632
Bond Position:  [7.82495563]


portfolio before change:  [5.26477919]
curr_Stock_Price:  111.13408523022721
curr_Factors:  [111.13408523]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745658]
Stock Position:  -0.01745658121300947
Bond Position:  [7.20480037]


portfolio before change:  [5.25654538]
curr_Stock_Price:  111.63155541460334
curr_Factors:  [111.63155541]
mat_Sqrt:  [[0.15]]
grads:  [-0.05686876]
Stock Position:  -0.056868764330815585
Bond Position:  [11.60489399]


portfolio before change:  [5.26561562]
curr_Stock_Price:  111.48481553854602
curr_Factors:  [111.48481554]
mat_Sqrt:  [[0.15]]
grads:  [-0.09274527]
Stock Position:  -0.09274526632627295
Bond Position:  [15.60530453]


portfolio before change:  [5.32669951]
curr_Stock_Price:  110.83671211374336
curr_Factors:  [110.83671211]
mat_Sqrt:  [[0.15]]
grads:  [-0.09599207]
Stock Position:  -0.09599206862344419
Bond Position:  [15.96614478]


portfolio before change:  [5.35977575]
curr_Stock_Price:  110.50253524492904
curr_Factors:  [110.50253524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00724012]
Stock Position:  -0.007240118717752476
Bond Position:  [6.15982722]


portfolio before change:  [5.36062173]
curr_Stock_Price:  110.43886490265186
curr_Factors:  [110.4388649]
mat_Sqrt:  [[0.15]]
grads:  [-0.12619438]
Stock Position:  -0.12619437738049033
Bond Position:  [19.29738553]


portfolio before change:  [5.31903472]
curr_Stock_Price:  110.77796987994672
curr_Factors:  [110.77796988]
mat_Sqrt:  [[0.15]]
grads:  [0.26381769]
Stock Position:  0.26381769020737045
Bond Position:  [-23.90615342]


portfolio before change:  [5.12162665]
curr_Stock_Price:  110.03535901239768
curr_Factors:  [110.03535901]
mat_Sqrt:  [[0.15]]
grads:  [-0.05226826]
Stock Position:  -0.05226826308611378
Bond Position:  [10.87298374]


portfolio before change:  [5.1511569]
curr_Stock_Price:  109.48338614653659
curr_Factors:  [109.48338615]
mat_Sqrt:  [[0.15]]
grads:  [0.15747517]
Stock Position:  0.1574751735904423
Bond Position:  [-12.08975834]


portfolio before change:  [5.24357412]
curr_Stock_Price:  110.07505308617222
curr_Factors:  [110.07505309]
mat_Sqrt:  [[0.15]]
grads:  [0.0658644]
Stock Position:  0.06586439983088155
Bond Position:  [-2.00645319]


portfolio before change:  [5.30809979]
curr_Stock_Price:  111.05663159618794
curr_Factors:  [111.0566316]
mat_Sqrt:  [[0.15]]
grads:  [0.08121627]
Stock Position:  0.08121627368735335
Bond Position:  [-3.711506]


portfolio before change:  [5.30710844]
curr_Stock_Price:  111.04728159966325
curr_Factors:  [111.0472816]
mat_Sqrt:  [[0.15]]
grads:  [0.07666341]
Stock Position:  0.07666341311997747
Bond Position:  [-3.20615518]


portfolio before change:  [5.3317738]
curr_Stock_Price:  111.37163124863604
curr_Factors:  [111.37163125]
mat_Sqrt:  [[0.15]]
grads:  [-0.0932881]
Stock Position:  -0.09328809533851229
Bond Position:  [15.72142115]


portfolio before change:  [5.30155594]
curr_Stock_Price:  111.70608423808828
curr_Factors:  [111.70608424]
mat_Sqrt:  [[0.15]]
grads:  [-0.53819411]
Stock Position:  -0.5381941094011484
Bond Position:  [65.42111246]


portfolio before change:  [5.55256563]
curr_Stock_Price:  111.24728928141752
curr_Factors:  [111.24728928]
mat_Sqrt:  [[0.15]]
grads:  [0.00175123]
Stock Position:  0.0017512279943051152
Bond Position:  [5.35774626]


portfolio before change:  [5.55439849]
curr_Stock_Price:  112.10268513133575
curr_Factors:  [112.10268513]
mat_Sqrt:  [[0.15]]
grads:  [-0.13829275]
Stock Position:  -0.13829275189055412
Bond Position:  [21.05738731]


portfolio before change:  [5.57919546]
curr_Stock_Price:  111.93289426652885
curr_Factors:  [111.93289427]
mat_Sqrt:  [[0.15]]
grads:  [-0.24195589]
Stock Position:  -0.2419558943751779
Bond Position:  [32.66201901]


portfolio before change:  [5.64342809]
curr_Stock_Price:  111.67585906587819
curr_Factors:  [111.67585907]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405685]
Stock Position:  -0.04405685279703167
Bond Position:  [10.56351497]


portfolio before change:  [5.6023005]
curr_Stock_Price:  112.62435678014886
curr_Factors:  [112.62435678]
mat_Sqrt:  [[0.15]]
grads:  [0.18280058]
Stock Position:  0.18280058106212274
Bond Position:  [-14.98549736]


portfolio before change:  [5.56231939]
curr_Stock_Price:  112.4107661445876
curr_Factors:  [112.41076614]
mat_Sqrt:  [[0.15]]
grads:  [0.89737089]
Stock Position:  0.8973708935958324
Bond Position:  [-95.31183028]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.91464813]
Stock Price:  112.8100279485828
PL:  [-6.89537982]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.36743058e-03]
 [ 6.25829879e-03]
 [ 2.76918183e-02]
 [-1.02209792e-02]
 [ 1.24486364e-02]
 [-1.79887229e-03]
 [ 1.15122264e-04]
 [-8.29468733e-03]
 [-1.43894209e-02]
 [-1.13477674e-02]
 [ 1.35696528e-02]
 [-7.60573453e-03]
 [-3.96841873e-04]
 [ 6.15900091e-03]
 [-3.82158591e-03]
 [ 5.45974733e-03]
 [-4.22438393e-03]
 [-1.39675268e-02]
 [ 2.49885151e-02]
 [ 2.59609790e-03]
 [-3.87502996e-03]
 [ 4.41325777e-03]
 [ 1.52220136e-02]
 [ 1.71947303e-02]
 [-3.89534627e-03]
 [ 6.12598311e-03]
 [-4.58806385e-03]
 [ 6.06262829e-03]
 [ 3.43349105e-02]
 [ 5.20922050e-03]
 [-7.64682080e-03]
 [ 7.81633610e-03]
 [ 1.26361853e-02]
 [ 9.23372423e-03]
 [ 5.26261324e-03]
 [ 1.24465658e-02]
 [-2.76922824e-02]
 [ 2.82836269e-03]
 [-5.56460211e-02]
 [ 1.33101792e-02]
 [ 6.97448919e-03]
 [-3.16640017e-03]
 [-2.39822647e-03]
 [-4.46768341e-03]
 [ 2.31990702e-02]
 [ 1.47005750e-02]
 [ 1.08787888e-02]
 [ 3.99437182e-03]
 [ 9.31897161e-03]
 [-1.43362300e-03]
 [ 1.25980244e-02]
 [-1.59737798e-02]
 [-8.20468575e-04]
 [-2.18557906e-02]
 [-4.52060835e-03]
 [-2.82952730e-03]
 [ 9.06056149e-03]
 [-1.43470970e-02]
 [ 4.00562468e-03]
 [-3.43185921e-03]
 [-4.36168593e-03]
 [ 5.71993905e-03]
 [-1.92768799e-02]
 [ 2.60920961e-03]
 [ 1.77832453e-02]
 [ 1.22420372e-02]
 [ 9.01694154e-03]
 [ 1.27660746e-02]
 [ 7.31109707e-03]
 [ 1.12217751e-02]
 [ 5.84865996e-03]
 [-1.49361427e-02]
 [-3.43190802e-02]
 [ 6.33696119e-04]
 [-6.57878494e-03]
 [-2.53113427e-02]
 [-5.04078661e-03]
 [ 1.39843788e-02]
 [ 1.89291083e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.0631766]
curr_Stock_Price:  100.1377646834285
curr_Factors:  [100.13776468]
mat_Sqrt:  [[0.15]]
grads:  [-0.0491162]
Stock Position:  -0.04911620385590699
Bond Position:  [9.98156346]


portfolio before change:  [5.08049839]
curr_Stock_Price:  99.79779700592418
curr_Factors:  [99.79779701]
mat_Sqrt:  [[0.15]]
grads:  [0.04172199]
Stock Position:  0.04172199196141668
Bond Position:  [0.9167355]


portfolio before change:  [5.05001323]
curr_Stock_Price:  99.06575009660841
curr_Factors:  [99.0657501]
mat_Sqrt:  [[0.15]]
grads:  [0.18461212]
Stock Position:  0.18461212186893072
Bond Position:  [-13.2387251]


portfolio before change:  [5.06684122]
curr_Stock_Price:  99.16138538720207
curr_Factors:  [99.16138539]
mat_Sqrt:  [[0.15]]
grads:  [-0.06813986]
Stock Position:  -0.06813986125174906
Bond Position:  [11.82368426]


portfolio before change:  [5.05980539]
curr_Stock_Price:  99.27548644639558
curr_Factors:  [99.27548645]
mat_Sqrt:  [[0.15]]
grads:  [0.08299091]
Stock Position:  0.08299090955669165
Bond Position:  [-3.17915753]


portfolio before change:  [5.17208894]
curr_Stock_Price:  100.63084272772498
curr_Factors:  [100.63084273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199248]
Stock Position:  -0.011992481923210058
Bond Position:  [6.3789025]


portfolio before change:  [5.17709108]
curr_Stock_Price:  100.24698142775001
curr_Factors:  [100.24698143]
mat_Sqrt:  [[0.15]]
grads:  [0.00076748]
Stock Position:  0.0007674817598254599
Bond Position:  [5.10015335]


portfolio before change:  [5.17727852]
curr_Stock_Price:  100.07585678162441
curr_Factors:  [100.07585678]
mat_Sqrt:  [[0.15]]
grads:  [-0.05529792]
Stock Position:  -0.05529791553035012
Bond Position:  [10.71126479]


portfolio before change:  [5.22280912]
curr_Stock_Price:  99.2645942904667
curr_Factors:  [99.26459429]
mat_Sqrt:  [[0.15]]
grads:  [-0.09592947]
Stock Position:  -0.0959294729880437
Bond Position:  [14.74520933]


portfolio before change:  [5.23421434]
curr_Stock_Price:  99.15530961739739
curr_Factors:  [99.15530962]
mat_Sqrt:  [[0.15]]
grads:  [-0.07565178]
Stock Position:  -0.07565178293368105
Bond Position:  [12.7354903]


portfolio before change:  [5.22387907]
curr_Stock_Price:  99.3024478023177
curr_Factors:  [99.3024478]
mat_Sqrt:  [[0.15]]
grads:  [0.09046435]
Stock Position:  0.09046435193977871
Bond Position:  [-3.75945252]


portfolio before change:  [5.20166868]
curr_Stock_Price:  99.05952987896674
curr_Factors:  [99.05952988]
mat_Sqrt:  [[0.15]]
grads:  [-0.0507049]
Stock Position:  -0.05070489689330007
Bond Position:  [10.22447193]


portfolio before change:  [5.20567862]
curr_Stock_Price:  98.99304931144327
curr_Factors:  [98.99304931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00264561]
Stock Position:  -0.002645612486895851
Bond Position:  [5.46757587]


portfolio before change:  [5.20513138]
curr_Stock_Price:  99.32907028335066
curr_Factors:  [99.32907028]
mat_Sqrt:  [[0.15]]
grads:  [0.04106001]
Stock Position:  0.04106000607244059
Bond Position:  [1.12667915]


portfolio before change:  [5.17980243]
curr_Stock_Price:  98.71047893837245
curr_Factors:  [98.71047894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02547724]
Stock Position:  -0.025477239371588974
Bond Position:  [7.69467293]


portfolio before change:  [5.19496982]
curr_Stock_Price:  98.13402479640476
curr_Factors:  [98.1340248]
mat_Sqrt:  [[0.15]]
grads:  [0.03639832]
Stock Position:  0.03639831551720115
Bond Position:  [1.62305663]


portfolio before change:  [5.20298606]
curr_Stock_Price:  98.35147408664437
curr_Factors:  [98.35147409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02816256]
Stock Position:  -0.028162559536699754
Bond Position:  [7.9728153]


portfolio before change:  [5.19051661]
curr_Stock_Price:  98.81193511175596
curr_Factors:  [98.81193511]
mat_Sqrt:  [[0.15]]
grads:  [-0.09311685]
Stock Position:  -0.09311684564784618
Bond Position:  [14.39157232]


portfolio before change:  [5.22063866]
curr_Stock_Price:  98.49810846069245
curr_Factors:  [98.49810846]
mat_Sqrt:  [[0.15]]
grads:  [0.1665901]
Stock Position:  0.16659010089209603
Bond Position:  [-11.18817117]


portfolio before change:  [5.46832959]
curr_Stock_Price:  99.98913471606814
curr_Factors:  [99.98913472]
mat_Sqrt:  [[0.15]]
grads:  [0.01730732]
Stock Position:  0.017307319361610587
Bond Position:  [3.7377857]


portfolio before change:  [5.45932399]
curr_Stock_Price:  99.45530179302341
curr_Factors:  [99.45530179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02583353]
Stock Position:  -0.02583353307948107
Bond Position:  [8.02860582]


portfolio before change:  [5.4498326]
curr_Stock_Price:  99.8421323134781
curr_Factors:  [99.84213231]
mat_Sqrt:  [[0.15]]
grads:  [0.02942172]
Stock Position:  0.029421718484744643
Bond Position:  [2.51230549]


portfolio before change:  [5.47269582]
curr_Stock_Price:  100.61388198656506
curr_Factors:  [100.61388199]
mat_Sqrt:  [[0.15]]
grads:  [0.10148009]
Stock Position:  0.10148009072345145
Bond Position:  [-4.73761005]


portfolio before change:  [5.43393456]
curr_Stock_Price:  100.23484058626397
curr_Factors:  [100.23484059]
mat_Sqrt:  [[0.15]]
grads:  [0.11463154]
Stock Position:  0.11463153546843415
Bond Position:  [-6.05613913]


portfolio before change:  [5.46096597]
curr_Stock_Price:  100.47395399164961
curr_Factors:  [100.47395399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596898]
Stock Position:  -0.025968975144475753
Bond Position:  [8.07017159]


portfolio before change:  [5.45738421]
curr_Stock_Price:  100.63130205496536
curr_Factors:  [100.63130205]
mat_Sqrt:  [[0.15]]
grads:  [0.04083989]
Stock Position:  0.04083988742895148
Bond Position:  [1.34761316]


portfolio before change:  [5.45535615]
curr_Stock_Price:  100.57958079996313
curr_Factors:  [100.5795808]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058709]
Stock Position:  -0.030587092343879997
Bond Position:  [8.53179307]


portfolio before change:  [5.44906725]
curr_Stock_Price:  100.80262107882524
curr_Factors:  [100.80262108]
mat_Sqrt:  [[0.15]]
grads:  [0.04041752]
Stock Position:  0.04041752191463753
Bond Position:  [1.3748751]


portfolio before change:  [5.46655561]
curr_Stock_Price:  101.23318750052694
curr_Factors:  [101.2331875]
mat_Sqrt:  [[0.15]]
grads:  [0.2288994]
Stock Position:  0.22889940333661227
Bond Position:  [-17.70566061]


portfolio before change:  [5.37728082]
curr_Stock_Price:  100.84800454999551
curr_Factors:  [100.84800455]
mat_Sqrt:  [[0.15]]
grads:  [0.03472814]
Stock Position:  0.034728136688720115
Bond Position:  [1.87501753]


portfolio before change:  [5.36237248]
curr_Stock_Price:  100.41534284134161
curr_Factors:  [100.41534284]
mat_Sqrt:  [[0.15]]
grads:  [-0.05097881]
Stock Position:  -0.05097880531764775
Bond Position:  [10.48142669]


portfolio before change:  [5.36900525]
curr_Stock_Price:  100.29808512595112
curr_Factors:  [100.29808513]
mat_Sqrt:  [[0.15]]
grads:  [0.05210891]
Stock Position:  0.05210890731701056
Bond Position:  [0.14258162]


portfolio before change:  [5.41650011]
curr_Stock_Price:  101.20936794283449
curr_Factors:  [101.20936794]
mat_Sqrt:  [[0.15]]
grads:  [0.08424124]
Stock Position:  0.08424123519663912
Bond Position:  [-3.10950206]


portfolio before change:  [5.39830819]
curr_Stock_Price:  100.99572469501771
curr_Factors:  [100.9957247]
mat_Sqrt:  [[0.15]]
grads:  [0.06155816]
Stock Position:  0.061558161536258336
Bond Position:  [-0.81880295]


portfolio before change:  [5.38947041]
curr_Stock_Price:  100.85298809661809
curr_Factors:  [100.8529881]
mat_Sqrt:  [[0.15]]
grads:  [0.03508409]
Stock Position:  0.035084088282876805
Bond Position:  [1.85113527]


portfolio before change:  [5.37215583]
curr_Stock_Price:  100.35617385658576
curr_Factors:  [100.35617386]
mat_Sqrt:  [[0.15]]
grads:  [0.08297711]
Stock Position:  0.0829771050174077
Bond Position:  [-2.95510894]


portfolio before change:  [5.42837079]
curr_Stock_Price:  101.03587527216399
curr_Factors:  [101.03587527]
mat_Sqrt:  [[0.15]]
grads:  [-0.18461522]
Stock Position:  -0.18461521590154442
Bond Position:  [24.08113072]


portfolio before change:  [5.39413057]
curr_Stock_Price:  101.22949604102153
curr_Factors:  [101.22949604]
mat_Sqrt:  [[0.15]]
grads:  [0.01885575]
Stock Position:  0.018855751279842504
Bond Position:  [3.48537237]


portfolio before change:  [5.37903665]
curr_Stock_Price:  100.41744868801021
curr_Factors:  [100.41744869]
mat_Sqrt:  [[0.15]]
grads:  [-0.37097347]
Stock Position:  -0.370973474293009
Bond Position:  [42.63124647]


portfolio before change:  [5.37244231]
curr_Stock_Price:  100.44240700409891
curr_Factors:  [100.442407]
mat_Sqrt:  [[0.15]]
grads:  [0.08873453]
Stock Position:  0.08873452800048458
Bond Position:  [-3.54026727]


portfolio before change:  [5.35365713]
curr_Stock_Price:  100.23319979504282
curr_Factors:  [100.2331998]
mat_Sqrt:  [[0.15]]
grads:  [0.04649659]
Stock Position:  0.046496594574441205
Bond Position:  [0.69315468]


portfolio before change:  [5.33324945]
curr_Stock_Price:  99.79336097280375
curr_Factors:  [99.79336097]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110933]
Stock Position:  -0.021109334450615524
Bond Position:  [7.43982088]


portfolio before change:  [5.31992755]
curr_Stock_Price:  100.44647994790198
curr_Factors:  [100.44647995]
mat_Sqrt:  [[0.15]]
grads:  [-0.01598818]
Stock Position:  -0.015988176494007886
Bond Position:  [6.9258836]


portfolio before change:  [5.31804127]
curr_Stock_Price:  100.59153437549136
curr_Factors:  [100.59153438]
mat_Sqrt:  [[0.15]]
grads:  [-0.02978456]
Stock Position:  -0.029784556052912664
Bond Position:  [8.31411547]


portfolio before change:  [5.33227358]
curr_Stock_Price:  100.13113931404295
curr_Factors:  [100.13113931]
mat_Sqrt:  [[0.15]]
grads:  [0.15466047]
Stock Position:  0.15466046814684362
Bond Position:  [-10.1540553]


portfolio before change:  [5.40452241]
curr_Stock_Price:  100.60238756799622
curr_Factors:  [100.60238757]
mat_Sqrt:  [[0.15]]
grads:  [0.09800383]
Stock Position:  0.09800383303774224
Bond Position:  [-4.45489718]


portfolio before change:  [5.36906478]
curr_Stock_Price:  100.24343032686492
curr_Factors:  [100.24343033]
mat_Sqrt:  [[0.15]]
grads:  [0.07252526]
Stock Position:  0.07252525899116598
Bond Position:  [-1.90111596]


portfolio before change:  [5.36942356]
curr_Stock_Price:  100.25001567202669
curr_Factors:  [100.25001567]
mat_Sqrt:  [[0.15]]
grads:  [0.02662915]
Stock Position:  0.02662914548472191
Bond Position:  [2.69985131]


portfolio before change:  [5.37151194]
curr_Stock_Price:  100.32210324166337
curr_Factors:  [100.32210324]
mat_Sqrt:  [[0.15]]
grads:  [0.06212648]
Stock Position:  0.06212647741384707
Bond Position:  [-0.86114694]


portfolio before change:  [5.41531068]
curr_Stock_Price:  101.02796264856227
curr_Factors:  [101.02796265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955749]
Stock Position:  -0.00955748664051405
Bond Position:  [6.38088408]


portfolio before change:  [5.41170265]
curr_Stock_Price:  101.44719839816673
curr_Factors:  [101.4471984]
mat_Sqrt:  [[0.15]]
grads:  [0.08398683]
Stock Position:  0.08398682931456083
Bond Position:  [-3.10852588]


portfolio before change:  [5.43131799]
curr_Stock_Price:  101.68306423368776
curr_Factors:  [101.68306423]
mat_Sqrt:  [[0.15]]
grads:  [-0.10649187]
Stock Position:  -0.10649186520858392
Bond Position:  [16.25973716]


portfolio before change:  [5.2995551]
curr_Stock_Price:  102.92991211542152
curr_Factors:  [102.92991212]
mat_Sqrt:  [[0.15]]
grads:  [-0.00546979]
Stock Position:  -0.005469790499718074
Bond Position:  [5.86256015]


portfolio before change:  [5.29519981]
curr_Stock_Price:  103.79314636440272
curr_Factors:  [103.79314636]
mat_Sqrt:  [[0.15]]
grads:  [-0.14570527]
Stock Position:  -0.14570527040872247
Bond Position:  [20.41840827]


portfolio before change:  [5.31376737]
curr_Stock_Price:  103.67447275166279
curr_Factors:  [103.67447275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03013739]
Stock Position:  -0.030137388989491063
Bond Position:  [8.43824528]


portfolio before change:  [5.30243723]
curr_Stock_Price:  104.06792256194348
curr_Factors:  [104.06792256]
mat_Sqrt:  [[0.15]]
grads:  [-0.01886352]
Stock Position:  -0.01886351531860472
Bond Position:  [7.26552408]


portfolio before change:  [5.3077275]
curr_Stock_Price:  103.81154594291998
curr_Factors:  [103.81154594]
mat_Sqrt:  [[0.15]]
grads:  [0.06040374]
Stock Position:  0.06040374329041385
Bond Position:  [-0.96287847]


portfolio before change:  [5.28264334]
curr_Stock_Price:  103.39726731053567
curr_Factors:  [103.39726731]
mat_Sqrt:  [[0.15]]
grads:  [-0.09564731]
Stock Position:  -0.09564731343942867
Bond Position:  [15.17231417]


portfolio before change:  [5.22176738]
curr_Stock_Price:  104.04364463821511
curr_Factors:  [104.04364464]
mat_Sqrt:  [[0.15]]
grads:  [0.02670416]
Stock Position:  0.02670416450013418
Bond Position:  [2.44336878]


portfolio before change:  [5.22755391]
curr_Stock_Price:  104.25461580891931
curr_Factors:  [104.25461581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02287906]
Stock Position:  -0.02287906139708557
Bond Position:  [7.61280166]


portfolio before change:  [5.23801017]
curr_Stock_Price:  103.81838948803598
curr_Factors:  [103.81838949]
mat_Sqrt:  [[0.15]]
grads:  [-0.02907791]
Stock Position:  -0.029077906178242113
Bond Position:  [8.25683156]


portfolio before change:  [5.24102289]
curr_Stock_Price:  103.73252881733177
curr_Factors:  [103.73252882]
mat_Sqrt:  [[0.15]]
grads:  [0.03813293]
Stock Position:  0.03813292698534949
Bond Position:  [1.28539794]


portfolio before change:  [5.22308452]
curr_Stock_Price:  103.26000520125373
curr_Factors:  [103.2600052]
mat_Sqrt:  [[0.15]]
grads:  [-0.12851253]
Stock Position:  -0.12851253286780626
Bond Position:  [18.49328933]


portfolio before change:  [5.25714699]
curr_Stock_Price:  103.00394762988105
curr_Factors:  [103.00394763]
mat_Sqrt:  [[0.15]]
grads:  [0.01739473]
Stock Position:  0.01739473071384549
Bond Position:  [3.46542106]


portfolio before change:  [5.272456]
curr_Stock_Price:  103.87159017983116
curr_Factors:  [103.87159018]
mat_Sqrt:  [[0.15]]
grads:  [0.11855497]
Stock Position:  0.11855496839087167
Bond Position:  [-7.04203709]


portfolio before change:  [5.27341801]
curr_Stock_Price:  103.88341723366774
curr_Factors:  [103.88341723]
mat_Sqrt:  [[0.15]]
grads:  [0.08161358]
Stock Position:  0.08161358126170119
Bond Position:  [-3.2048797]


portfolio before change:  [5.26583372]
curr_Stock_Price:  103.79294235193983
curr_Factors:  [103.79294235]
mat_Sqrt:  [[0.15]]
grads:  [0.06011294]
Stock Position:  0.060112943582803634
Bond Position:  [-0.97346557]


portfolio before change:  [5.33629962]
curr_Stock_Price:  104.96617958039826
curr_Factors:  [104.96617958]
mat_Sqrt:  [[0.15]]
grads:  [0.08510716]
Stock Position:  0.0851071640011378
Bond Position:  [-3.59707424]


portfolio before change:  [5.34152723]
curr_Stock_Price:  105.03024504126553
curr_Factors:  [105.03024504]
mat_Sqrt:  [[0.15]]
grads:  [0.04874065]
Stock Position:  0.04874064713432458
Bond Position:  [0.22228511]


portfolio before change:  [5.38500494]
curr_Stock_Price:  105.92198164671419
curr_Factors:  [105.92198165]
mat_Sqrt:  [[0.15]]
grads:  [0.07481183]
Stock Position:  0.07481183390938144
Bond Position:  [-2.53921276]


portfolio before change:  [5.44558115]
curr_Stock_Price:  106.73381737732856
curr_Factors:  [106.73381738]
mat_Sqrt:  [[0.15]]
grads:  [0.03899107]
Stock Position:  0.03899106638313191
Bond Position:  [1.28391579]


portfolio before change:  [5.41614888]
curr_Stock_Price:  105.97691280628531
curr_Factors:  [105.97691281]
mat_Sqrt:  [[0.15]]
grads:  [-0.09957428]
Stock Position:  -0.09957428447509033
Bond Position:  [15.96872415]


portfolio before change:  [5.33720208]
curr_Stock_Price:  106.77977953960578
curr_Factors:  [106.77977954]
mat_Sqrt:  [[0.15]]
grads:  [-0.22879387]
Stock Position:  -0.22879386767647292
Bond Position:  [29.76776083]


portfolio before change:  [5.30875303]
curr_Stock_Price:  106.9122550980524
curr_Factors:  [106.9122551]
mat_Sqrt:  [[0.15]]
grads:  [0.00422464]
Stock Position:  0.004224640796492676
Bond Position:  [4.85708715]


portfolio before change:  [5.31005008]
curr_Stock_Price:  107.14741742134665
curr_Factors:  [107.14741742]
mat_Sqrt:  [[0.15]]
grads:  [-0.04385857]
Stock Position:  -0.0438585662756203
Bond Position:  [10.00938219]


portfolio before change:  [5.31842465]
curr_Stock_Price:  106.97073672166435
curr_Factors:  [106.97073672]
mat_Sqrt:  [[0.15]]
grads:  [-0.16874228]
Stock Position:  -0.16874228486429427
Bond Position:  [23.36891118]


portfolio before change:  [5.41270856]
curr_Stock_Price:  106.42064750433676
curr_Factors:  [106.4206475]
mat_Sqrt:  [[0.15]]
grads:  [-0.03360524]
Stock Position:  -0.03360524404160842
Bond Position:  [8.98900039]


portfolio before change:  [5.43955895]
curr_Stock_Price:  105.63837196431301
curr_Factors:  [105.63837196]
mat_Sqrt:  [[0.15]]
grads:  [0.09322919]
Stock Position:  0.09322919194895435
Bond Position:  [-4.4090211]


portfolio before change:  [5.45314626]
curr_Stock_Price:  105.78706870519896
curr_Factors:  [105.78706871]
mat_Sqrt:  [[0.15]]
grads:  [0.12619406]
Stock Position:  0.12619405528829214
Bond Position:  [-7.89655294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.46526809]
Stock Price:  105.8870368568805
PL:  [-0.42176876]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.11083909e-02]
 [ 7.19085629e-03]
 [ 4.69928535e-03]
 [-8.58861352e-03]
 [-4.44881139e-03]
 [-1.12945410e-03]
 [-5.02254924e-03]
 [-3.06650577e-02]
 [ 1.34829122e-02]
 [-9.30481251e-04]
 [-9.14904065e-03]
 [ 1.52781620e-02]
 [-4.06915851e-03]
 [ 3.08102972e-03]
 [ 3.57764826e-03]
 [ 1.61005288e-02]
 [ 3.96017273e-02]
 [-1.45398490e-02]
 [ 1.76642638e-02]
 [ 1.34865507e-03]
 [-3.82541540e-03]
 [ 4.35116363e-03]
 [ 1.53070059e-02]
 [ 1.87711528e-02]
 [-4.66770229e-03]
 [ 6.71435617e-03]
 [-8.76083113e-03]
 [ 1.14193180e-02]
 [ 3.21097874e-02]
 [ 4.75191250e-03]
 [-7.19507868e-03]
 [ 1.16344518e-02]
 [ 1.29563284e-02]
 [ 7.51264288e-03]
 [ 6.08611857e-03]
 [ 8.68654822e-03]
 [-2.79637012e-02]
 [ 8.76175768e-04]
 [-4.57120901e-02]
 [ 1.47198552e-02]
 [ 6.89849119e-03]
 [-2.00326163e-03]
 [-1.70216931e-03]
 [-2.57066701e-03]
 [ 2.14289361e-02]
 [ 1.49825821e-02]
 [ 1.06918704e-02]
 [ 4.70468123e-03]
 [ 5.21348471e-03]
 [-2.21907005e-03]
 [-7.07107847e-03]
 [ 1.51461086e-03]
 [ 1.58438857e-03]
 [ 8.18397283e-03]
 [-7.64265348e-03]
 [-4.44201883e-03]
 [-4.88496743e-04]
 [ 1.20447349e-02]
 [ 8.23757352e-03]
 [-3.30293133e-03]
 [-5.13475594e-03]
 [-1.91967178e-03]
 [-1.78694470e-03]
 [-4.40330117e-03]
 [ 1.82066922e-02]
 [ 6.30203218e-03]
 [ 2.02612230e-02]
 [-3.64219906e-03]
 [ 6.28174415e-03]
 [ 2.44144823e-02]
 [ 3.62546230e-03]
 [-1.54734086e-02]
 [-5.87902558e-03]
 [ 2.57298425e-03]
 [ 1.08201746e-02]
 [ 6.13648181e-03]
 [-3.90541503e-04]
 [-1.54226096e-02]
 [-2.96125353e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.67961662]
curr_Stock_Price:  100.02950827376056
curr_Factors:  [100.02950827]
mat_Sqrt:  [[0.15]]
grads:  [-0.07405594]
Stock Position:  -0.07405593948436827
Bond Position:  [10.08739583]


portfolio before change:  [2.694596]
curr_Stock_Price:  99.83575064942349
curr_Factors:  [99.83575065]
mat_Sqrt:  [[0.15]]
grads:  [0.04793904]
Stock Position:  0.04793904196098778
Bond Position:  [-2.09143423]


portfolio before change:  [2.68951298]
curr_Stock_Price:  99.732446371787
curr_Factors:  [99.73244637]
mat_Sqrt:  [[0.15]]
grads:  [0.03132857]
Stock Position:  0.031328569000302134
Bond Position:  [-0.43496185]


portfolio before change:  [2.68660237]
curr_Stock_Price:  99.64040832787464
curr_Factors:  [99.64040833]
mat_Sqrt:  [[0.15]]
grads:  [-0.05725742]
Stock Position:  -0.05725742349621213
Bond Position:  [8.39175543]


portfolio before change:  [2.62989328]
curr_Stock_Price:  100.63999205728102
curr_Factors:  [100.63999206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02965874]
Stock Position:  -0.029658742588166757
Bond Position:  [5.6147489]


portfolio before change:  [2.6178393]
curr_Stock_Price:  101.05824688866801
curr_Factors:  [101.05824689]
mat_Sqrt:  [[0.15]]
grads:  [-0.00752969]
Stock Position:  -0.00752969400278683
Bond Position:  [3.37877698]


portfolio before change:  [2.62149606]
curr_Stock_Price:  100.60064899020166
curr_Factors:  [100.60064899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348366]
Stock Position:  -0.03348366156803519
Bond Position:  [5.98997414]


portfolio before change:  [2.60334017]
curr_Stock_Price:  101.15406134201098
curr_Factors:  [101.15406134]
mat_Sqrt:  [[0.15]]
grads:  [-0.20443372]
Stock Position:  -0.2044337182036685
Bond Position:  [23.28264104]


portfolio before change:  [2.55977222]
curr_Stock_Price:  101.37429486949718
curr_Factors:  [101.37429487]
mat_Sqrt:  [[0.15]]
grads:  [0.08988608]
Stock Position:  0.0898860816399381
Bond Position:  [-6.55236592]


portfolio before change:  [2.52818245]
curr_Stock_Price:  101.0274087385665
curr_Factors:  [101.02740874]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620321]
Stock Position:  -0.006203208337980925
Bond Position:  [3.15487652]


portfolio before change:  [2.52524274]
curr_Stock_Price:  101.533098395058
curr_Factors:  [101.5330984]
mat_Sqrt:  [[0.15]]
grads:  [-0.0609936]
Stock Position:  -0.060993604331754825
Bond Position:  [8.71811237]


portfolio before change:  [2.5170721]
curr_Stock_Price:  101.67599107439854
curr_Factors:  [101.67599107]
mat_Sqrt:  [[0.15]]
grads:  [0.10185441]
Stock Position:  0.10185441334274013
Bond Position:  [-7.83907632]


portfolio before change:  [2.54995463]
curr_Stock_Price:  102.00363996837369
curr_Factors:  [102.00363997]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712772]
Stock Position:  -0.027127723398777833
Bond Position:  [5.31708116]


portfolio before change:  [2.55020811]
curr_Stock_Price:  102.00654626054045
curr_Factors:  [102.00654626]
mat_Sqrt:  [[0.15]]
grads:  [0.0205402]
Stock Position:  0.020540198161503723
Bond Position:  [0.45497344]


portfolio before change:  [2.54729639]
curr_Stock_Price:  101.86340451907134
curr_Factors:  [101.86340452]
mat_Sqrt:  [[0.15]]
grads:  [0.02385099]
Stock Position:  0.02385098843274704
Bond Position:  [0.11775351]


portfolio before change:  [2.52605475]
curr_Stock_Price:  100.97249793734048
curr_Factors:  [100.97249794]
mat_Sqrt:  [[0.15]]
grads:  [0.10733686]
Stock Position:  0.10733685851477359
Bond Position:  [-8.31201598]


portfolio before change:  [2.46233911]
curr_Stock_Price:  100.3837335177227
curr_Factors:  [100.38373352]
mat_Sqrt:  [[0.15]]
grads:  [0.26401152]
Stock Position:  0.264011515489637
Bond Position:  [-24.04012251]


portfolio before change:  [2.58489122]
curr_Stock_Price:  100.85361707872906
curr_Factors:  [100.85361708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09693233]
Stock Position:  -0.09693232695690215
Bond Position:  [12.36086701]


portfolio before change:  [2.56334023]
curr_Stock_Price:  101.08391762430233
curr_Factors:  [101.08391762]
mat_Sqrt:  [[0.15]]
grads:  [0.11776176]
Stock Position:  0.11776175837587453
Bond Position:  [-9.34047965]


portfolio before change:  [2.63065735]
curr_Stock_Price:  101.66051328260949
curr_Factors:  [101.66051328]
mat_Sqrt:  [[0.15]]
grads:  [0.00899103]
Stock Position:  0.008991033779084535
Bond Position:  [1.71662425]


portfolio before change:  [2.62639803]
curr_Stock_Price:  101.17484953711013
curr_Factors:  [101.17484954]
mat_Sqrt:  [[0.15]]
grads:  [-0.02550277]
Stock Position:  -0.025502769321820874
Bond Position:  [5.20663688]


portfolio before change:  [2.63525231]
curr_Stock_Price:  100.84042074651019
curr_Factors:  [100.84042075]
mat_Sqrt:  [[0.15]]
grads:  [0.02900776]
Stock Position:  0.029007757511879742
Bond Position:  [-0.28990216]


portfolio before change:  [2.62777688]
curr_Stock_Price:  100.58334066708363
curr_Factors:  [100.58334067]
mat_Sqrt:  [[0.15]]
grads:  [0.10204671]
Stock Position:  0.10204670618510718
Bond Position:  [-7.63642174]


portfolio before change:  [2.63614947]
curr_Stock_Price:  100.67006451538575
curr_Factors:  [100.67006452]
mat_Sqrt:  [[0.15]]
grads:  [0.12514102]
Stock Position:  0.12514101837290503
Bond Position:  [-9.96180492]


portfolio before change:  [2.5666285]
curr_Stock_Price:  100.11949890638232
curr_Factors:  [100.11949891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03111802]
Stock Position:  -0.031118015298582657
Bond Position:  [5.68214859]


portfolio before change:  [2.54215535]
curr_Stock_Price:  100.91737406825027
curr_Factors:  [100.91737407]
mat_Sqrt:  [[0.15]]
grads:  [0.04476237]
Stock Position:  0.044762374489818346
Bond Position:  [-1.97514594]


portfolio before change:  [2.55526735]
curr_Stock_Price:  101.21305652147937
curr_Factors:  [101.21305652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05840554]
Stock Position:  -0.05840554089455288
Bond Position:  [8.46667066]


portfolio before change:  [2.53908189]
curr_Stock_Price:  101.49923897694995
curr_Factors:  [101.49923898]
mat_Sqrt:  [[0.15]]
grads:  [0.07612879]
Stock Position:  0.07612878638418251
Bond Position:  [-5.18793199]


portfolio before change:  [2.48854302]
curr_Stock_Price:  100.83963812323792
curr_Factors:  [100.83963812]
mat_Sqrt:  [[0.15]]
grads:  [0.21406525]
Stock Position:  0.21406524928502046
Bond Position:  [-19.09771925]


portfolio before change:  [2.4526448]
curr_Stock_Price:  100.67751664704089
curr_Factors:  [100.67751665]
mat_Sqrt:  [[0.15]]
grads:  [0.03167942]
Stock Position:  0.031679416667486665
Bond Position:  [-0.7367602]


portfolio before change:  [2.44933896]
curr_Stock_Price:  100.57461712407287
curr_Factors:  [100.57461712]
mat_Sqrt:  [[0.15]]
grads:  [-0.04796719]
Stock Position:  -0.04796719122697398
Bond Position:  [7.27362085]


portfolio before change:  [2.42655732]
curr_Stock_Price:  101.05903676206106
curr_Factors:  [101.05903676]
mat_Sqrt:  [[0.15]]
grads:  [0.07756301]
Stock Position:  0.0775630120300733
Bond Position:  [-5.41188596]


portfolio before change:  [2.47955172]
curr_Stock_Price:  101.74664092028934
curr_Factors:  [101.74664092]
mat_Sqrt:  [[0.15]]
grads:  [0.08637552]
Stock Position:  0.08637552259075837
Bond Position:  [-6.30886756]


portfolio before change:  [2.4663038]
curr_Stock_Price:  101.5978302494705
curr_Factors:  [101.59783025]
mat_Sqrt:  [[0.15]]
grads:  [0.05008429]
Stock Position:  0.05008428588976109
Bond Position:  [-2.62215097]


portfolio before change:  [2.50015874]
curr_Stock_Price:  102.27706177969084
curr_Factors:  [102.27706178]
mat_Sqrt:  [[0.15]]
grads:  [0.04057412]
Stock Position:  0.04057412381552813
Bond Position:  [-1.64964343]


portfolio before change:  [2.51711766]
curr_Stock_Price:  102.69757671071973
curr_Factors:  [102.69757671]
mat_Sqrt:  [[0.15]]
grads:  [0.05791032]
Stock Position:  0.05791032145928118
Bond Position:  [-3.43013202]


portfolio before change:  [2.44150397]
curr_Stock_Price:  101.3955756754546
curr_Factors:  [101.39557568]
mat_Sqrt:  [[0.15]]
grads:  [-0.18642467]
Stock Position:  -0.18642467470723834
Bond Position:  [21.34414118]


portfolio before change:  [2.39161358]
curr_Stock_Price:  101.67034853388922
curr_Factors:  [101.67034853]
mat_Sqrt:  [[0.15]]
grads:  [0.00584117]
Stock Position:  0.00584117178606391
Bond Position:  [1.79773961]


portfolio before change:  [2.38987558]
curr_Stock_Price:  101.35356986693085
curr_Factors:  [101.35356987]
mat_Sqrt:  [[0.15]]
grads:  [-0.30474727]
Stock Position:  -0.304747267565897
Bond Position:  [33.27709906]


portfolio before change:  [2.62591441]
curr_Stock_Price:  100.5858552264643
curr_Factors:  [100.58585523]
mat_Sqrt:  [[0.15]]
grads:  [0.09813237]
Stock Position:  0.09813236815732276
Bond Position:  [-7.24481377]


portfolio before change:  [2.62090191]
curr_Stock_Price:  100.53939065846124
curr_Factors:  [100.53939066]
mat_Sqrt:  [[0.15]]
grads:  [0.04598994]
Stock Position:  0.0459899412702915
Bond Position:  [-2.00289876]


portfolio before change:  [2.59920873]
curr_Stock_Price:  100.07041851144348
curr_Factors:  [100.07041851]
mat_Sqrt:  [[0.15]]
grads:  [-0.01335508]
Stock Position:  -0.013355077513213683
Bond Position:  [3.93565692]


portfolio before change:  [2.59801321]
curr_Stock_Price:  100.17835524362893
curr_Factors:  [100.17835524]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113478]
Stock Position:  -0.01134779538128019
Bond Position:  [3.73481669]


portfolio before change:  [2.60312994]
curr_Stock_Price:  99.74802528895407
curr_Factors:  [99.74802529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713778]
Stock Position:  -0.017137780051730417
Bond Position:  [4.31258966]


portfolio before change:  [2.60316936]
curr_Stock_Price:  99.76145293093721
curr_Factors:  [99.76145293]
mat_Sqrt:  [[0.15]]
grads:  [0.14285957]
Stock Position:  0.14285957399012517
Bond Position:  [-11.6487093]


portfolio before change:  [2.52503313]
curr_Stock_Price:  99.21960495312169
curr_Factors:  [99.21960495]
mat_Sqrt:  [[0.15]]
grads:  [0.09988388]
Stock Position:  0.09988388039503372
Bond Position:  [-7.38540603]


portfolio before change:  [2.51530631]
curr_Stock_Price:  99.12684511848111
curr_Factors:  [99.12684512]
mat_Sqrt:  [[0.15]]
grads:  [0.07127914]
Stock Position:  0.07127913632692352
Bond Position:  [-4.5503696]


portfolio before change:  [2.52096664]
curr_Stock_Price:  99.21024592434928
curr_Factors:  [99.21024592]
mat_Sqrt:  [[0.15]]
grads:  [0.03136454]
Stock Position:  0.03136454155950598
Bond Position:  [-0.59071724]


portfolio before change:  [2.52676498]
curr_Stock_Price:  99.39629222907756
curr_Factors:  [99.39629223]
mat_Sqrt:  [[0.15]]
grads:  [0.03475656]
Stock Position:  0.03475656470071687
Bond Position:  [-0.92790868]


portfolio before change:  [2.53750581]
curr_Stock_Price:  99.70699127739653
curr_Factors:  [99.70699128]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147938]
Stock Position:  -0.014793800357544469
Bond Position:  [4.01255114]


portfolio before change:  [2.55101462]
curr_Stock_Price:  98.81080416088332
curr_Factors:  [98.81080416]
mat_Sqrt:  [[0.15]]
grads:  [-0.04714052]
Stock Position:  -0.04714052311199135
Bond Position:  [7.20900762]


portfolio before change:  [2.57430394]
curr_Stock_Price:  98.32632197178621
curr_Factors:  [98.32632197]
mat_Sqrt:  [[0.15]]
grads:  [0.01009741]
Stock Position:  0.010097405740072604
Bond Position:  [1.58146317]


portfolio before change:  [2.58193189]
curr_Stock_Price:  99.07196957760915
curr_Factors:  [99.07196958]
mat_Sqrt:  [[0.15]]
grads:  [0.01056259]
Stock Position:  0.010562590487506764
Bond Position:  [1.53547525]


portfolio before change:  [2.58066101]
curr_Stock_Price:  98.94256500808918
curr_Factors:  [98.94256501]
mat_Sqrt:  [[0.15]]
grads:  [0.05455982]
Stock Position:  0.054559818884512
Bond Position:  [-2.81762741]


portfolio before change:  [2.56507638]
curr_Stock_Price:  98.66014976072363
curr_Factors:  [98.66014976]
mat_Sqrt:  [[0.15]]
grads:  [-0.05095102]
Stock Position:  -0.05095102322490868
Bond Position:  [7.59191196]


portfolio before change:  [2.56650515]
curr_Stock_Price:  98.64142089723417
curr_Factors:  [98.6414209]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961346]
Stock Position:  -0.029613458851619943
Bond Position:  [5.4876188]


portfolio before change:  [2.58961271]
curr_Stock_Price:  97.87269675344203
curr_Factors:  [97.87269675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325664]
Stock Position:  -0.0032566449528839605
Bond Position:  [2.90834934]


portfolio before change:  [2.5904459]
curr_Stock_Price:  97.67267085894423
curr_Factors:  [97.67267086]
mat_Sqrt:  [[0.15]]
grads:  [0.08029823]
Stock Position:  0.08029823273809895
Bond Position:  [-5.25249695]


portfolio before change:  [2.59794809]
curr_Stock_Price:  97.77018823098854
curr_Factors:  [97.77018823]
mat_Sqrt:  [[0.15]]
grads:  [0.05491716]
Stock Position:  0.05491715678997888
Bond Position:  [-2.77131267]


portfolio before change:  [2.55338178]
curr_Stock_Price:  96.96182352950083
curr_Factors:  [96.96182353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02201954]
Stock Position:  -0.022019542189396935
Bond Position:  [4.68843675]


portfolio before change:  [2.5661383]
curr_Stock_Price:  96.39580446393548
curr_Factors:  [96.39580446]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423171]
Stock Position:  -0.034231706240488914
Bond Position:  [5.86593116]


portfolio before change:  [2.57784767]
curr_Stock_Price:  96.06445254249317
curr_Factors:  [96.06445254]
mat_Sqrt:  [[0.15]]
grads:  [-0.01279781]
Stock Position:  -0.012797811871218633
Bond Position:  [3.80726246]


portfolio before change:  [2.58280339]
curr_Stock_Price:  95.69581517105605
curr_Factors:  [95.69581517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01191296]
Stock Position:  -0.011912964655203528
Bond Position:  [3.72282425]


portfolio before change:  [2.58696671]
curr_Stock_Price:  95.36586863250702
curr_Factors:  [95.36586863]
mat_Sqrt:  [[0.15]]
grads:  [-0.02935534]
Stock Position:  -0.02935534113485599
Bond Position:  [5.38646432]


portfolio before change:  [2.58762773]
curr_Stock_Price:  95.35481935340668
curr_Factors:  [95.35481935]
mat_Sqrt:  [[0.15]]
grads:  [0.12137795]
Stock Position:  0.12137794804530182
Bond Position:  [-8.98634458]


portfolio before change:  [2.6050287]
curr_Stock_Price:  95.50280863766993
curr_Factors:  [95.50280864]
mat_Sqrt:  [[0.15]]
grads:  [0.04201355]
Stock Position:  0.04201354786534991
Bond Position:  [-1.40738312]


portfolio before change:  [2.60572339]
curr_Stock_Price:  95.52143718594074
curr_Factors:  [95.52143719]
mat_Sqrt:  [[0.15]]
grads:  [0.13507482]
Stock Position:  0.1350748200727011
Bond Position:  [-10.29681755]


portfolio before change:  [2.57280375]
curr_Stock_Price:  95.2824876314801
curr_Factors:  [95.28248763]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428133]
Stock Position:  -0.024281327069060044
Bond Position:  [4.886389]


portfolio before change:  [2.56262794]
curr_Stock_Price:  95.71414516520746
curr_Factors:  [95.71414517]
mat_Sqrt:  [[0.15]]
grads:  [0.04187829]
Stock Position:  0.04187829436513925
Bond Position:  [-1.4457172]


portfolio before change:  [2.59034693]
curr_Stock_Price:  96.37819678069508
curr_Factors:  [96.37819678]
mat_Sqrt:  [[0.15]]
grads:  [0.16276322]
Stock Position:  0.1627632152552012
Bond Position:  [-13.09647826]


portfolio before change:  [2.79343402]
curr_Stock_Price:  97.63097149797653
curr_Factors:  [97.6309715]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [0.43371797]


portfolio before change:  [2.775625]
curr_Stock_Price:  96.89301929580031
curr_Factors:  [96.8930193]
mat_Sqrt:  [[0.15]]
grads:  [-0.10315606]
Stock Position:  -0.10315605752632173
Bond Position:  [12.77072688]


portfolio before change:  [2.8475878]
curr_Stock_Price:  96.20314610913961
curr_Factors:  [96.20314611]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391935]
Stock Position:  -0.03919350389717989
Bond Position:  [6.61812618]


portfolio before change:  [2.88771242]
curr_Stock_Price:  95.18994301749532
curr_Factors:  [95.18994302]
mat_Sqrt:  [[0.15]]
grads:  [0.01715323]
Stock Position:  0.01715322835428803
Bond Position:  [1.25489759]


portfolio before change:  [2.8967595]
curr_Stock_Price:  95.71279727840599
curr_Factors:  [95.71279728]
mat_Sqrt:  [[0.15]]
grads:  [0.0721345]
Stock Position:  0.07213449734403427
Bond Position:  [-4.00743503]


portfolio before change:  [2.87872178]
curr_Stock_Price:  95.46621286370217
curr_Factors:  [95.46621286]
mat_Sqrt:  [[0.15]]
grads:  [0.04090988]
Stock Position:  0.04090987874225745
Bond Position:  [-1.02678941]


portfolio before change:  [2.88197956]
curr_Stock_Price:  95.5474146176418
curr_Factors:  [95.54741462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00260361]
Stock Position:  -0.0026036100230394646
Bond Position:  [3.13074776]


portfolio before change:  [2.88119178]
curr_Stock_Price:  95.92514239577604
curr_Factors:  [95.9251424]
mat_Sqrt:  [[0.15]]
grads:  [-0.1028174]
Stock Position:  -0.10281739715261735
Bond Position:  [12.74396524]


portfolio before change:  [2.92859945]
curr_Stock_Price:  95.47180326187834
curr_Factors:  [95.47180326]
mat_Sqrt:  [[0.15]]
grads:  [-0.1974169]
Stock Position:  -0.1974169022140381
Bond Position:  [21.7763471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.92336119]
Stock Price:  95.50523161724622
PL:  [2.92336119]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.26880359e-02]
 [-2.24518773e-02]
 [ 6.35582128e-02]
 [-1.19840075e-02]
 [ 1.09594969e-02]
 [-1.81940892e-02]
 [-1.36875373e-02]
 [ 8.02278554e-02]
 [-2.08001561e-02]
 [-1.27423123e-02]
 [ 1.02960628e-02]
 [-6.78687232e-03]
 [ 4.74904437e-03]
 [-3.68412830e-03]
 [-2.24753576e-03]
 [ 1.04813197e-02]
 [ 3.54947793e-02]
 [-1.46833070e-02]
 [ 1.98331320e-02]
 [ 2.02413369e-03]
 [-3.99135414e-03]
 [ 4.76071975e-03]
 [ 6.98634035e-03]
 [ 3.25046787e-02]
 [ 3.38686087e-03]
 [ 6.62395088e-03]
 [ 8.30283960e-02]
 [ 3.41781842e-02]
 [ 3.63231308e-03]
 [-8.94497561e-03]
 [ 7.47794824e-03]
 [ 1.63567106e-02]
 [ 1.63794768e-02]
 [-9.74182226e-03]
 [ 4.03852114e-03]
 [-4.26895082e-03]
 [-9.89094941e-03]
 [-1.27729279e-02]
 [-2.15045768e-03]
 [-4.95415272e-02]
 [ 3.41859404e-03]
 [ 3.34659335e-03]
 [-1.26188109e-02]
 [ 7.76246437e-03]
 [ 6.16228293e-03]
 [ 1.20672100e-02]
 [ 1.05655210e-02]
 [-7.98329606e-04]
 [ 1.50650371e-02]
 [-1.18945925e-03]
 [ 1.37643259e-02]
 [-1.46476523e-02]
 [ 1.22653119e-03]
 [-5.30487103e-06]
 [-3.71259806e-03]
 [-3.59726587e-03]
 [ 1.00045145e-02]
 [ 1.02879669e-04]
 [ 6.80358439e-03]
 [-3.99765480e-03]
 [-6.90464202e-04]
 [ 4.94772916e-03]
 [-8.45367522e-03]
 [ 7.68100287e-03]
 [ 2.50574680e-02]
 [ 5.56469378e-03]
 [ 1.15342027e-02]
 [ 1.33936796e-03]
 [ 2.69463637e-03]
 [ 2.18984686e-02]
 [ 6.74121322e-04]
 [-1.59493218e-02]
 [-3.10006511e-03]
 [ 1.28955493e-03]
 [-6.18822062e-05]
 [-3.76973921e-03]
 [-4.24804251e-03]
 [ 1.45085432e-02]
 [-7.95466295e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.28836483]
curr_Stock_Price:  99.34969322994503
curr_Factors:  [99.34969323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08458691]
Stock Position:  -0.08458690567999685
Bond Position:  [-3.8846817]


portfolio before change:  [-12.23157264]
curr_Stock_Price:  98.67541640100055
curr_Factors:  [98.6754164]
mat_Sqrt:  [[0.15]]
grads:  [-0.14967918]
Stock Position:  -0.1496791822613638
Bond Position:  [2.538083]


portfolio before change:  [-12.1165913]
curr_Stock_Price:  97.90829100449253
curr_Factors:  [97.908291]
mat_Sqrt:  [[0.15]]
grads:  [0.42372142]
Stock Position:  0.4237214189525211
Bond Position:  [-53.60243129]


portfolio before change:  [-12.24645469]
curr_Stock_Price:  97.60971479724955
curr_Factors:  [97.6097148]
mat_Sqrt:  [[0.15]]
grads:  [-0.07989338]
Stock Position:  -0.07989338338212329
Bond Position:  [-4.44808433]


portfolio before change:  [-12.25156268]
curr_Stock_Price:  97.67017003666422
curr_Factors:  [97.67017004]
mat_Sqrt:  [[0.15]]
grads:  [0.07306331]
Stock Position:  0.07306331255258972
Bond Position:  [-19.38766884]


portfolio before change:  [-12.29125748]
curr_Stock_Price:  97.14346205682462
curr_Factors:  [97.14346206]
mat_Sqrt:  [[0.15]]
grads:  [-0.12129393]
Stock Position:  -0.12129392790989432
Bond Position:  [-0.50834539]


portfolio before change:  [-12.29209998]
curr_Stock_Price:  97.1501460379238
curr_Factors:  [97.15014604]
mat_Sqrt:  [[0.15]]
grads:  [-0.09125025]
Stock Position:  -0.09125024891325115
Bond Position:  [-3.42712497]


portfolio before change:  [-12.27911066]
curr_Stock_Price:  97.00545031169077
curr_Factors:  [97.00545031]
mat_Sqrt:  [[0.15]]
grads:  [0.53485237]
Stock Position:  0.5348523695262454
Bond Position:  [-64.16270561]


portfolio before change:  [-11.57732932]
curr_Stock_Price:  98.3250511532021
curr_Factors:  [98.32505115]
mat_Sqrt:  [[0.15]]
grads:  [-0.13866771]
Stock Position:  -0.1386677070107902
Bond Position:  [2.05718007]


portfolio before change:  [-11.61441445]
curr_Stock_Price:  98.59341723599569
curr_Factors:  [98.59341724]
mat_Sqrt:  [[0.15]]
grads:  [-0.08494875]
Stock Position:  -0.08494874881050092
Bond Position:  [-3.23902701]


portfolio before change:  [-11.59585593]
curr_Stock_Price:  98.37256689554884
curr_Factors:  [98.3725669]
mat_Sqrt:  [[0.15]]
grads:  [0.06864042]
Stock Position:  0.06864041871435524
Bond Position:  [-18.34819011]


portfolio before change:  [-11.61201016]
curr_Stock_Price:  98.15392858370994
curr_Factors:  [98.15392858]
mat_Sqrt:  [[0.15]]
grads:  [-0.04524582]
Stock Position:  -0.04524581547529987
Bond Position:  [-7.17095561]


portfolio before change:  [-11.59486154]
curr_Stock_Price:  97.76501272243561
curr_Factors:  [97.76501272]
mat_Sqrt:  [[0.15]]
grads:  [0.0316603]
Stock Position:  0.03166029580265213
Bond Position:  [-14.69013076]


portfolio before change:  [-11.58845963]
curr_Stock_Price:  97.99621944403891
curr_Factors:  [97.99621944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456086]
Stock Position:  -0.02456085534889101
Bond Position:  [-9.18158866]


portfolio before change:  [-11.59250747]
curr_Stock_Price:  98.13766297596055
curr_Factors:  [98.13766298]
mat_Sqrt:  [[0.15]]
grads:  [-0.01498357]
Stock Position:  -0.014983571730614216
Bond Position:  [-10.12205476]


portfolio before change:  [-11.60762415]
curr_Stock_Price:  99.10432396036092
curr_Factors:  [99.10432396]
mat_Sqrt:  [[0.15]]
grads:  [0.06987546]
Stock Position:  0.0698754648685515
Bond Position:  [-18.53258486]


portfolio before change:  [-11.53383486]
curr_Stock_Price:  100.17691235620958
curr_Factors:  [100.17691236]
mat_Sqrt:  [[0.15]]
grads:  [0.23663186]
Stock Position:  0.23663186220520116
Bond Position:  [-35.23888418]


portfolio before change:  [-11.481371]
curr_Stock_Price:  100.40793097084358
curr_Factors:  [100.40793097]
mat_Sqrt:  [[0.15]]
grads:  [-0.09788871]
Stock Position:  -0.09788871342638955
Bond Position:  [-1.65256782]


portfolio before change:  [-11.45010348]
curr_Stock_Price:  100.08745676753806
curr_Factors:  [100.08745677]
mat_Sqrt:  [[0.15]]
grads:  [0.13222088]
Stock Position:  0.13222087985438755
Bond Position:  [-24.68375507]


portfolio before change:  [-11.35734726]
curr_Stock_Price:  100.80064968982651
curr_Factors:  [100.80064969]
mat_Sqrt:  [[0.15]]
grads:  [0.01349422]
Stock Position:  0.013494224596524348
Bond Position:  [-12.71757387]


portfolio before change:  [-11.35760915]
curr_Stock_Price:  100.84014740571406
curr_Factors:  [100.84014741]
mat_Sqrt:  [[0.15]]
grads:  [-0.02660903]
Stock Position:  -0.026609027625163328
Bond Position:  [-8.67435088]


portfolio before change:  [-11.38137908]
curr_Stock_Price:  101.71307554905827
curr_Factors:  [101.71307555]
mat_Sqrt:  [[0.15]]
grads:  [0.03173813]
Stock Position:  0.03173813167989466
Bond Position:  [-14.60956206]


portfolio before change:  [-11.35406568]
curr_Stock_Price:  102.60243233407527
curr_Factors:  [102.60243233]
mat_Sqrt:  [[0.15]]
grads:  [0.0465756]
Stock Position:  0.046575602352793295
Bond Position:  [-16.13283577]


portfolio before change:  [-11.36744655]
curr_Stock_Price:  102.33678817545797
curr_Factors:  [102.33678818]
mat_Sqrt:  [[0.15]]
grads:  [0.21669786]
Stock Position:  0.21669785807056502
Bond Position:  [-33.54360935]


portfolio before change:  [-11.1653851]
curr_Stock_Price:  103.27892018923639
curr_Factors:  [103.27892019]
mat_Sqrt:  [[0.15]]
grads:  [0.02257907]
Stock Position:  0.022579072451748967
Bond Position:  [-13.49732733]


portfolio before change:  [-11.14434802]
curr_Stock_Price:  104.24798970174882
curr_Factors:  [104.2479897]
mat_Sqrt:  [[0.15]]
grads:  [0.04415967]
Stock Position:  0.04415967253328302
Bond Position:  [-15.74790511]


portfolio before change:  [-11.09928527]
curr_Stock_Price:  105.29072915846918
curr_Factors:  [105.29072916]
mat_Sqrt:  [[0.15]]
grads:  [0.55352264]
Stock Position:  0.5535226403064265
Bond Position:  [-69.38008767]


portfolio before change:  [-11.1839984]
curr_Stock_Price:  105.14551966725239
curr_Factors:  [105.14551967]
mat_Sqrt:  [[0.15]]
grads:  [0.22785456]
Stock Position:  0.2278545615324702
Bond Position:  [-35.14188468]


portfolio before change:  [-11.31476178]
curr_Stock_Price:  104.58126963573316
curr_Factors:  [104.58126964]
mat_Sqrt:  [[0.15]]
grads:  [0.02421542]
Stock Position:  0.024215420547193806
Bond Position:  [-13.8472412]


portfolio before change:  [-11.31130248]
curr_Stock_Price:  104.7598655009495
curr_Factors:  [104.7598655]
mat_Sqrt:  [[0.15]]
grads:  [-0.05963317]
Stock Position:  -0.05963317073590669
Bond Position:  [-5.06413954]


portfolio before change:  [-11.35860712]
curr_Stock_Price:  105.54781827851134
curr_Factors:  [105.54781828]
mat_Sqrt:  [[0.15]]
grads:  [0.04985299]
Stock Position:  0.049852988239129016
Bond Position:  [-16.62048127]


portfolio before change:  [-11.34792455]
curr_Stock_Price:  105.78293737206837
curr_Factors:  [105.78293737]
mat_Sqrt:  [[0.15]]
grads:  [0.10904474]
Stock Position:  0.10904473716462161
Bond Position:  [-22.88299715]


portfolio before change:  [-11.42264622]
curr_Stock_Price:  105.11081468586666
curr_Factors:  [105.11081469]
mat_Sqrt:  [[0.15]]
grads:  [0.10919651]
Stock Position:  0.10919651223335855
Bond Position:  [-22.90038058]


portfolio before change:  [-11.42576784]
curr_Stock_Price:  105.0953352908892
curr_Factors:  [105.09533529]
mat_Sqrt:  [[0.15]]
grads:  [-0.06494548]
Stock Position:  -0.06494548175700016
Bond Position:  [-4.60030065]


portfolio before change:  [-11.43458656]
curr_Stock_Price:  105.22669471924516
curr_Factors:  [105.22669472]
mat_Sqrt:  [[0.15]]
grads:  [0.02692347]
Stock Position:  0.026923474289418284
Bond Position:  [-14.26765477]


portfolio before change:  [-11.46521399]
curr_Stock_Price:  104.12224333062582
curr_Factors:  [104.12224333]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845967]
Stock Position:  -0.02845967212699231
Bond Position:  [-8.50192908]


portfolio before change:  [-11.47155277]
curr_Stock_Price:  104.32630037937668
curr_Factors:  [104.32630038]
mat_Sqrt:  [[0.15]]
grads:  [-0.06593966]
Stock Position:  -0.06593966270046182
Bond Position:  [-4.59231172]


portfolio before change:  [-11.48709275]
curr_Stock_Price:  104.55761706248956
curr_Factors:  [104.55761706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08515285]
Stock Position:  -0.08515285291672242
Bond Position:  [-2.58371336]


portfolio before change:  [-11.49285057]
curr_Stock_Price:  104.62333813616695
curr_Factors:  [104.62333814]
mat_Sqrt:  [[0.15]]
grads:  [-0.01433638]
Stock Position:  -0.014336384563682799
Bond Position:  [-9.99293016]


portfolio before change:  [-11.50040589]
curr_Stock_Price:  105.1067755203443
curr_Factors:  [105.10677552]
mat_Sqrt:  [[0.15]]
grads:  [-0.33027685]
Stock Position:  -0.3302768480518447
Bond Position:  [23.21392864]


portfolio before change:  [-11.43949822]
curr_Stock_Price:  104.92675454843342
curr_Factors:  [104.92675455]
mat_Sqrt:  [[0.15]]
grads:  [0.02279063]
Stock Position:  0.022790626948019137
Bond Position:  [-13.83084474]


portfolio before change:  [-11.43940288]
curr_Stock_Price:  104.9688680343106
curr_Factors:  [104.96886803]
mat_Sqrt:  [[0.15]]
grads:  [0.02231062]
Stock Position:  0.02231062233085085
Bond Position:  [-13.78132365]


portfolio before change:  [-11.45207399]
curr_Stock_Price:  104.43953487195537
curr_Factors:  [104.43953487]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412541]
Stock Position:  -0.08412540581255912
Bond Position:  [-2.66605574]


portfolio before change:  [-11.42520697]
curr_Stock_Price:  104.11818543215493
curr_Factors:  [104.11818543]
mat_Sqrt:  [[0.15]]
grads:  [0.05174976]
Stock Position:  0.05174976245053933
Bond Position:  [-16.81329834]


portfolio before change:  [-11.47409003]
curr_Stock_Price:  103.1938875127483
curr_Factors:  [103.19388751]
mat_Sqrt:  [[0.15]]
grads:  [0.04108189]
Stock Position:  0.04108188621112629
Bond Position:  [-15.71348958]


portfolio before change:  [-11.48788678]
curr_Stock_Price:  102.88195882323696
curr_Factors:  [102.88195882]
mat_Sqrt:  [[0.15]]
grads:  [0.08044807]
Stock Position:  0.08044806653953636
Bond Position:  [-19.76454145]


portfolio before change:  [-11.46467066]
curr_Stock_Price:  103.18589946228045
curr_Factors:  [103.18589946]
mat_Sqrt:  [[0.15]]
grads:  [0.07043681]
Stock Position:  0.07043680689307458
Bond Position:  [-18.73275594]


portfolio before change:  [-11.50583895]
curr_Stock_Price:  102.6180507197223
curr_Factors:  [102.61805072]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053222]
Stock Position:  -0.005322197371296715
Bond Position:  [-10.95968543]


portfolio before change:  [-11.50496439]
curr_Stock_Price:  102.32502113351885
curr_Factors:  [102.32502113]
mat_Sqrt:  [[0.15]]
grads:  [0.10043358]
Stock Position:  0.10043358050239587
Bond Position:  [-21.78183264]


portfolio before change:  [-11.56033646]
curr_Stock_Price:  101.7872461404566
curr_Factors:  [101.78724614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00792973]
Stock Position:  -0.007929728325577434
Bond Position:  [-10.75319126]


portfolio before change:  [-11.55931901]
curr_Stock_Price:  101.57418085039713
curr_Factors:  [101.57418085]
mat_Sqrt:  [[0.15]]
grads:  [0.09176217]
Stock Position:  0.09176217234721255
Bond Position:  [-20.8799865]


portfolio before change:  [-11.53594498]
curr_Stock_Price:  101.84312687914976
curr_Factors:  [101.84312688]
mat_Sqrt:  [[0.15]]
grads:  [-0.09765102]
Stock Position:  -0.09765101543736894
Bond Position:  [-1.59086022]


portfolio before change:  [-11.52789222]
curr_Stock_Price:  101.75964396058647
curr_Factors:  [101.75964396]
mat_Sqrt:  [[0.15]]
grads:  [0.00817687]
Stock Position:  0.00817687461185292
Bond Position:  [-12.35996807]


portfolio before change:  [-11.53215144]
curr_Stock_Price:  101.33323423293957
curr_Factors:  [101.33323423]
mat_Sqrt:  [[0.15]]
grads:  [-3.53658069e-05]
Stock Position:  -3.536580689150286e-05
Bond Position:  [-11.52856771]


portfolio before change:  [-11.53285969]
curr_Stock_Price:  100.98514541280063
curr_Factors:  [100.98514541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02475065]
Stock Position:  -0.024750653766027524
Bond Position:  [-9.03341132]


portfolio before change:  [-11.53816141]
curr_Stock_Price:  101.17653903028798
curr_Factors:  [101.17653903]
mat_Sqrt:  [[0.15]]
grads:  [-0.02398177]
Stock Position:  -0.023981772440592755
Bond Position:  [-9.11176867]


portfolio before change:  [-11.54087514]
curr_Stock_Price:  101.26594991619639
curr_Factors:  [101.26594992]
mat_Sqrt:  [[0.15]]
grads:  [0.06669676]
Stock Position:  0.06669676338682404
Bond Position:  [-18.29498624]


portfolio before change:  [-11.57399049]
curr_Stock_Price:  100.78658818577921
curr_Factors:  [100.78658819]
mat_Sqrt:  [[0.15]]
grads:  [0.00068586]
Stock Position:  0.0006858644607331729
Bond Position:  [-11.64311643]


portfolio before change:  [-11.57425215]
curr_Stock_Price:  101.46610972186578
curr_Factors:  [101.46610972]
mat_Sqrt:  [[0.15]]
grads:  [0.04535723]
Stock Position:  0.04535722923922521
Bond Position:  [-16.17647375]


portfolio before change:  [-11.58741298]
curr_Stock_Price:  101.19824137857066
curr_Factors:  [101.19824138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665103]
Stock Position:  -0.02665103201937328
Bond Position:  [-8.89037541]


portfolio before change:  [-11.56794995]
curr_Stock_Price:  100.44710006188438
curr_Factors:  [100.44710006]
mat_Sqrt:  [[0.15]]
grads:  [-0.00460309]
Stock Position:  -0.004603094681142426
Bond Position:  [-11.10558244]


portfolio before change:  [-11.56676904]
curr_Stock_Price:  100.03975869853907
curr_Factors:  [100.0397587]
mat_Sqrt:  [[0.15]]
grads:  [0.03298486]
Stock Position:  0.03298486108224342
Bond Position:  [-14.86656659]


portfolio before change:  [-11.55396194]
curr_Stock_Price:  100.45620114009431
curr_Factors:  [100.45620114]
mat_Sqrt:  [[0.15]]
grads:  [-0.05635783]
Stock Position:  -0.05635783480572851
Bond Position:  [-5.89246795]


portfolio before change:  [-11.54894812]
curr_Stock_Price:  100.36070231159076
curr_Factors:  [100.36070231]
mat_Sqrt:  [[0.15]]
grads:  [0.05120669]
Stock Position:  0.051206685775938475
Bond Position:  [-16.68808707]


portfolio before change:  [-11.53718724]
curr_Stock_Price:  100.6107461608626
curr_Factors:  [100.61074616]
mat_Sqrt:  [[0.15]]
grads:  [0.16704979]
Stock Position:  0.16704978658915523
Bond Position:  [-28.34419091]


portfolio before change:  [-11.53958437]
curr_Stock_Price:  100.60700138265592
curr_Factors:  [100.60700138]
mat_Sqrt:  [[0.15]]
grads:  [0.03709796]
Stock Position:  0.03709795855195361
Bond Position:  [-15.27189874]


portfolio before change:  [-11.51522817]
curr_Stock_Price:  101.28926863295038
curr_Factors:  [101.28926863]
mat_Sqrt:  [[0.15]]
grads:  [0.07689468]
Stock Position:  0.07689468449610255
Bond Position:  [-19.30383453]


portfolio before change:  [-11.53376391]
curr_Stock_Price:  101.06390572904793
curr_Factors:  [101.06390573]
mat_Sqrt:  [[0.15]]
grads:  [0.00892912]
Stock Position:  0.00892911975304577
Bond Position:  [-12.43617563]


portfolio before change:  [-11.53915319]
curr_Stock_Price:  100.54739423012653
curr_Factors:  [100.54739423]
mat_Sqrt:  [[0.15]]
grads:  [0.01796424]
Stock Position:  0.01796424246075149
Bond Position:  [-13.34541096]


portfolio before change:  [-11.5489786]
curr_Stock_Price:  100.04688318896059
curr_Factors:  [100.04688319]
mat_Sqrt:  [[0.15]]
grads:  [0.14598979]
Stock Position:  0.1459897904974551
Bond Position:  [-26.15480212]


portfolio before change:  [-11.52963185]
curr_Stock_Price:  100.19060203862662
curr_Factors:  [100.19060204]
mat_Sqrt:  [[0.15]]
grads:  [0.00449414]
Stock Position:  0.004494142149162794
Bond Position:  [-11.97990265]


portfolio before change:  [-11.52747903]
curr_Stock_Price:  100.83623947872812
curr_Factors:  [100.83623948]
mat_Sqrt:  [[0.15]]
grads:  [-0.10632881]
Stock Position:  -0.1063288119636871
Bond Position:  [-0.80568148]


portfolio before change:  [-11.44564562]
curr_Stock_Price:  100.06613997631456
curr_Factors:  [100.06613998]
mat_Sqrt:  [[0.15]]
grads:  [-0.0206671]
Stock Position:  -0.020667100760388184
Bond Position:  [-9.37756862]


portfolio before change:  [-11.45054072]
curr_Stock_Price:  100.27463493495142
curr_Factors:  [100.27463493]
mat_Sqrt:  [[0.15]]
grads:  [0.00859703]
Stock Position:  0.008597032890233808
Bond Position:  [-12.31260505]


portfolio before change:  [-11.45284258]
curr_Stock_Price:  100.09639873717512
curr_Factors:  [100.09639874]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041255]
Stock Position:  -0.00041254804141326273
Bond Position:  [-11.41154801]


portfolio before change:  [-11.45346772]
curr_Stock_Price:  99.88283868616782
curr_Factors:  [99.88283869]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513159]
Stock Position:  -0.025131594711546367
Bond Position:  [-8.9432527]


portfolio before change:  [-11.46804612]
curr_Stock_Price:  100.44067940215635
curr_Factors:  [100.4406794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02832028]
Stock Position:  -0.028320283411287644
Bond Position:  [-8.62353762]


portfolio before change:  [-11.47862153]
curr_Stock_Price:  100.7950690430857
curr_Factors:  [100.79506904]
mat_Sqrt:  [[0.15]]
grads:  [0.09672362]
Stock Position:  0.09672362115786523
Bond Position:  [-21.2278856]


portfolio before change:  [-11.39353657]
curr_Stock_Price:  101.68845723468131
curr_Factors:  [101.68845723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05303109]
Stock Position:  -0.05303108636195943
Bond Position:  [-6.00088721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.42739877]
Stock Price:  102.31991954511912
PL:  [-13.74731831]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.36057104e-02]
 [ 1.44912232e-02]
 [ 7.35964090e-03]
 [-9.28038620e-03]
 [ 1.42468215e-02]
 [-1.11523367e-02]
 [-2.36922693e-03]
 [-2.74316408e-02]
 [ 1.24691529e-02]
 [-5.32515076e-03]
 [-6.77432473e-03]
 [ 9.17616419e-03]
 [-3.10933212e-03]
 [ 5.63441861e-03]
 [ 2.97733768e-03]
 [ 1.11567661e-02]
 [ 9.71468244e-02]
 [-1.15018559e-02]
 [ 2.38145930e-02]
 [-1.60705781e-04]
 [-6.47919867e-03]
 [ 6.00796698e-03]
 [ 3.57739142e-03]
 [ 4.98277751e-02]
 [ 4.31294947e-03]
 [ 7.09828482e-03]
 [ 1.65240726e-02]
 [ 1.90537153e-02]
 [ 2.34465440e-02]
 [-7.60646119e-03]
 [-5.81291029e-04]
 [ 1.34135822e-02]
 [ 1.26724106e-02]
 [ 4.14640967e-03]
 [ 6.14112250e-03]
 [ 9.49477165e-03]
 [-2.43865164e-02]
 [-3.82251051e-03]
 [-2.09899903e-02]
 [-1.44259583e-02]
 [ 4.15290124e-03]
 [ 1.03418401e-02]
 [-1.03552599e-02]
 [ 5.97004678e-03]
 [ 4.17231345e-03]
 [ 1.16820039e-02]
 [ 1.05652432e-02]
 [-2.09186394e-03]
 [ 1.24931313e-02]
 [-1.35443967e-03]
 [ 2.10822969e-02]
 [ 7.95063138e-03]
 [-3.33863991e-03]
 [-2.26166630e-02]
 [-3.25582036e-03]
 [-3.07644772e-03]
 [ 1.05662891e-02]
 [-9.31895398e-03]
 [ 4.86990234e-03]
 [-3.82942356e-03]
 [-2.70964482e-03]
 [ 8.08907021e-03]
 [-1.26205736e-02]
 [ 4.20724112e-03]
 [ 2.56423166e-02]
 [ 5.37500129e-03]
 [ 1.31240780e-02]
 [-6.82272197e-04]
 [ 2.85758831e-03]
 [ 2.18362629e-02]
 [ 6.09522049e-04]
 [-1.59705303e-02]
 [-3.89696963e-04]
 [ 1.33626740e-03]
 [ 3.70028580e-03]
 [-1.53805727e-02]
 [-3.63697374e-03]
 [ 1.55435585e-02]
 [-4.83489394e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.2208744]
curr_Stock_Price:  99.91783724068662
curr_Factors:  [99.91783724]
mat_Sqrt:  [[0.15]]
grads:  [-0.09070474]
Stock Position:  -0.09070473624342065
Bond Position:  [9.28389547]


portfolio before change:  [0.19496483]
curr_Stock_Price:  100.20988184236401
curr_Factors:  [100.20988184]
mat_Sqrt:  [[0.15]]
grads:  [0.09660815]
Stock Position:  0.09660815489041695
Bond Position:  [-9.48612696]


portfolio before change:  [0.12597539]
curr_Stock_Price:  99.5019029326621
curr_Factors:  [99.50190293]
mat_Sqrt:  [[0.15]]
grads:  [0.04906427]
Stock Position:  0.04906427269774761
Bond Position:  [-4.75601311]


portfolio before change:  [0.14107195]
curr_Stock_Price:  99.81565083179095
curr_Factors:  [99.81565083]
mat_Sqrt:  [[0.15]]
grads:  [-0.06186924]
Stock Position:  -0.061869241344480026
Bond Position:  [6.31659054]


portfolio before change:  [0.1611551]
curr_Stock_Price:  99.49742549557881
curr_Factors:  [99.4974255]
mat_Sqrt:  [[0.15]]
grads:  [0.09497881]
Stock Position:  0.09497881025777298
Bond Position:  [-9.28899199]


portfolio before change:  [0.16301475]
curr_Stock_Price:  99.52311781757805
curr_Factors:  [99.52311782]
mat_Sqrt:  [[0.15]]
grads:  [-0.07434891]
Stock Position:  -0.07434891107095383
Bond Position:  [7.56245019]


portfolio before change:  [0.09497263]
curr_Stock_Price:  100.44464833470515
curr_Factors:  [100.44464833]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579485]
Stock Position:  -0.015794846170802276
Bond Position:  [1.6814804]


portfolio before change:  [0.08708313]
curr_Stock_Price:  100.95080065005243
curr_Factors:  [100.95080065]
mat_Sqrt:  [[0.15]]
grads:  [-0.18287761]
Stock Position:  -0.18287760558339872
Bond Position:  [18.54872383]


portfolio before change:  [0.02774753]
curr_Stock_Price:  101.28159526490454
curr_Factors:  [101.28159526]
mat_Sqrt:  [[0.15]]
grads:  [0.08312769]
Stock Position:  0.08312768609540537
Bond Position:  [-8.39155713]


portfolio before change:  [0.05633371]
curr_Stock_Price:  101.63178744951709
curr_Factors:  [101.63178745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03550101]
Stock Position:  -0.035501005038094544
Bond Position:  [3.66436431]


portfolio before change:  [0.07462072]
curr_Stock_Price:  101.12312622024317
curr_Factors:  [101.12312622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04516216]
Stock Position:  -0.04516216487654262
Bond Position:  [4.64156002]


portfolio before change:  [0.0723299]
curr_Stock_Price:  101.18027415223844
curr_Factors:  [101.18027415]
mat_Sqrt:  [[0.15]]
grads:  [0.06117443]
Stock Position:  0.061174427965570495
Bond Position:  [-6.11731549]


portfolio before change:  [0.04936204]
curr_Stock_Price:  100.81107537704139
curr_Factors:  [100.81107538]
mat_Sqrt:  [[0.15]]
grads:  [-0.02072888]
Stock Position:  -0.02072888081456419
Bond Position:  [2.1390628]


portfolio before change:  [0.04196763]
curr_Stock_Price:  101.17424497553216
curr_Factors:  [101.17424498]
mat_Sqrt:  [[0.15]]
grads:  [0.03756279]
Stock Position:  0.03756279073616055
Bond Position:  [-3.75841936]


portfolio before change:  [0.06119888]
curr_Stock_Price:  101.69247473539721
curr_Factors:  [101.69247474]
mat_Sqrt:  [[0.15]]
grads:  [0.01984892]
Stock Position:  0.01984891784250215
Bond Position:  [-1.9572867]


portfolio before change:  [0.07279944]
curr_Stock_Price:  102.28308086745582
curr_Factors:  [102.28308087]
mat_Sqrt:  [[0.15]]
grads:  [0.07437844]
Stock Position:  0.0743784403895167
Bond Position:  [-7.53485659]


portfolio before change:  [0.10400547]
curr_Stock_Price:  102.70897001259773
curr_Factors:  [102.70897001]
mat_Sqrt:  [[0.15]]
grads:  [0.6476455]
Stock Position:  0.6476454961103947
Bond Position:  [-66.41499637]


portfolio before change:  [-0.05313186]
curr_Stock_Price:  102.47275086985138
curr_Factors:  [102.47275087]
mat_Sqrt:  [[0.15]]
grads:  [-0.07667904]
Stock Position:  -0.07667903943738515
Bond Position:  [7.80438024]


portfolio before change:  [-0.09227872]
curr_Stock_Price:  102.98964107341314
curr_Factors:  [102.98964107]
mat_Sqrt:  [[0.15]]
grads:  [0.15876395]
Stock Position:  0.15876395337660143
Bond Position:  [-16.44332129]


portfolio before change:  [-0.01861776]
curr_Stock_Price:  103.4600797497426
curr_Factors:  [103.46007975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00107137]
Stock Position:  -0.0010713718727548178
Bond Position:  [0.09222646]


portfolio before change:  [-0.01812915]
curr_Stock_Price:  103.00939944932215
curr_Factors:  [103.00939945]
mat_Sqrt:  [[0.15]]
grads:  [-0.04319466]
Stock Position:  -0.043194657775681725
Bond Position:  [4.43132661]


portfolio before change:  [-0.02134107]
curr_Stock_Price:  103.09017087349389
curr_Factors:  [103.09017087]
mat_Sqrt:  [[0.15]]
grads:  [0.04005311]
Stock Position:  0.04005311317497
Bond Position:  [-4.15042335]


portfolio before change:  [-0.01585012]
curr_Stock_Price:  103.23373933250855
curr_Factors:  [103.23373933]
mat_Sqrt:  [[0.15]]
grads:  [0.02384928]
Stock Position:  0.023849276113837074
Bond Position:  [-2.47790007]


portfolio before change:  [-0.00075293]
curr_Stock_Price:  103.87325821843811
curr_Factors:  [103.87325822]
mat_Sqrt:  [[0.15]]
grads:  [0.33218517]
Stock Position:  0.3321851674139994
Bond Position:  [-34.5059086]


portfolio before change:  [-0.03785878]
curr_Stock_Price:  103.7680483451613
curr_Factors:  [103.76804835]
mat_Sqrt:  [[0.15]]
grads:  [0.028753]
Stock Position:  0.02875299646873431
Bond Position:  [-3.0215011]


portfolio before change:  [-0.03662675]
curr_Stock_Price:  103.81746505467565
curr_Factors:  [103.81746505]
mat_Sqrt:  [[0.15]]
grads:  [0.0473219]
Stock Position:  0.047321898787621205
Bond Position:  [-4.94946632]


portfolio before change:  [-0.08882897]
curr_Stock_Price:  102.72087189203447
curr_Factors:  [102.72087189]
mat_Sqrt:  [[0.15]]
grads:  [0.11016048]
Stock Position:  0.11016048384908791
Bond Position:  [-11.40460992]


portfolio before change:  [-0.09449738]
curr_Stock_Price:  102.67588657469443
curr_Factors:  [102.67588657]
mat_Sqrt:  [[0.15]]
grads:  [0.12702477]
Stock Position:  0.12702476854183295
Bond Position:  [-13.13687811]


portfolio before change:  [-0.12006293]
curr_Stock_Price:  102.48108628616264
curr_Factors:  [102.48108629]
mat_Sqrt:  [[0.15]]
grads:  [0.15631029]
Stock Position:  0.15631029365648488
Bond Position:  [-16.13891162]


portfolio before change:  [-0.14440458]
curr_Stock_Price:  102.33181307821334
curr_Factors:  [102.33181308]
mat_Sqrt:  [[0.15]]
grads:  [-0.05070974]
Stock Position:  -0.05070974127918818
Bond Position:  [5.04481519]


portfolio before change:  [-0.15965937]
curr_Stock_Price:  102.6388567042858
curr_Factors:  [102.6388567]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387527]
Stock Position:  -0.0038752735295874653
Bond Position:  [0.23809427]


portfolio before change:  [-0.15582504]
curr_Stock_Price:  101.65326209799655
curr_Factors:  [101.6532621]
mat_Sqrt:  [[0.15]]
grads:  [0.08942388]
Stock Position:  0.08942388151049771
Bond Position:  [-9.24605431]


portfolio before change:  [-0.18387733]
curr_Stock_Price:  101.34602435948622
curr_Factors:  [101.34602436]
mat_Sqrt:  [[0.15]]
grads:  [0.08448274]
Stock Position:  0.08448273747166635
Bond Position:  [-8.7458669]


portfolio before change:  [-0.12590055]
curr_Stock_Price:  102.0387505964241
curr_Factors:  [102.0387506]
mat_Sqrt:  [[0.15]]
grads:  [0.02764273]
Stock Position:  0.02764273111734645
Bond Position:  [-2.9465303]


portfolio before change:  [-0.12022876]
curr_Stock_Price:  102.25059487647317
curr_Factors:  [102.25059488]
mat_Sqrt:  [[0.15]]
grads:  [0.04094082]
Stock Position:  0.04094081669843178
Bond Position:  [-4.30645162]


portfolio before change:  [-0.10602896]
curr_Stock_Price:  102.60400655668344
curr_Factors:  [102.60400656]
mat_Sqrt:  [[0.15]]
grads:  [0.06329848]
Stock Position:  0.06329847765877805
Bond Position:  [-6.60070638]


portfolio before change:  [-0.13648255]
curr_Stock_Price:  102.12941326475607
curr_Factors:  [102.12941326]
mat_Sqrt:  [[0.15]]
grads:  [-0.16257678]
Stock Position:  -0.16257677569062162
Bond Position:  [16.46738816]


portfolio before change:  [-0.21747843]
curr_Stock_Price:  102.63394489080201
curr_Factors:  [102.63394489]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254834]
Stock Position:  -0.02548340338483034
Bond Position:  [2.39798379]


portfolio before change:  [-0.22932613]
curr_Stock_Price:  103.10474448480883
curr_Factors:  [103.10474448]
mat_Sqrt:  [[0.15]]
grads:  [-0.13993327]
Stock Position:  -0.13993326853915145
Bond Position:  [14.19845777]


portfolio before change:  [-0.17603694]
curr_Stock_Price:  102.73026768826031
curr_Factors:  [102.73026769]
mat_Sqrt:  [[0.15]]
grads:  [-0.09617306]
Stock Position:  -0.09617305517209743
Bond Position:  [9.70384677]


portfolio before change:  [-0.11446761]
curr_Stock_Price:  102.09638099778645
curr_Factors:  [102.096381]
mat_Sqrt:  [[0.15]]
grads:  [0.02768601]
Stock Position:  0.027686008238653276
Bond Position:  [-2.94110885]


portfolio before change:  [-0.09489308]
curr_Stock_Price:  102.81003933430148
curr_Factors:  [102.81003933]
mat_Sqrt:  [[0.15]]
grads:  [0.0689456]
Stock Position:  0.06894560085969395
Bond Position:  [-7.18319302]


portfolio before change:  [-0.0380358]
curr_Stock_Price:  103.64121985052144
curr_Factors:  [103.64121985]
mat_Sqrt:  [[0.15]]
grads:  [-0.06903507]
Stock Position:  -0.06903506606131084
Bond Position:  [7.11684265]


portfolio before change:  [-0.0504222]
curr_Stock_Price:  103.82708505574315
curr_Factors:  [103.82708506]
mat_Sqrt:  [[0.15]]
grads:  [0.03980031]
Stock Position:  0.039800311897712416
Bond Position:  [-4.18277257]


portfolio before change:  [-0.0591272]
curr_Stock_Price:  103.6149369296901
curr_Factors:  [103.61493693]
mat_Sqrt:  [[0.15]]
grads:  [0.02781542]
Stock Position:  0.027815423021933898
Bond Position:  [-2.9412205]


portfolio before change:  [-0.04628296]
curr_Stock_Price:  104.08331267505527
curr_Factors:  [104.08331268]
mat_Sqrt:  [[0.15]]
grads:  [0.07788003]
Stock Position:  0.07788002614174949
Bond Position:  [-8.15229407]


portfolio before change:  [-0.04934539]
curr_Stock_Price:  104.05053279618967
curr_Factors:  [104.0505328]
mat_Sqrt:  [[0.15]]
grads:  [0.07043495]
Stock Position:  0.07043495453416632
Bond Position:  [-7.37813994]


portfolio before change:  [-0.08597161]
curr_Stock_Price:  103.53707938976694
curr_Factors:  [103.53707939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01394576]
Stock Position:  -0.013945759582489163
Bond Position:  [1.35793161]


portfolio before change:  [-0.09028964]
curr_Stock_Price:  103.85279587458808
curr_Factors:  [103.85279587]
mat_Sqrt:  [[0.15]]
grads:  [0.08328754]
Stock Position:  0.08328754211390536
Bond Position:  [-8.73993375]


portfolio before change:  [-0.06367734]
curr_Stock_Price:  104.17887781570455
curr_Factors:  [104.17887782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0090296]
Stock Position:  -0.009029597775165052
Bond Position:  [0.87701602]


portfolio before change:  [-0.06478194]
curr_Stock_Price:  104.30727900873151
curr_Factors:  [104.30727901]
mat_Sqrt:  [[0.15]]
grads:  [0.14054865]
Stock Position:  0.1405486460681387
Bond Position:  [-14.72502878]


portfolio before change:  [-0.05285592]
curr_Stock_Price:  104.39868049435054
curr_Factors:  [104.39868049]
mat_Sqrt:  [[0.15]]
grads:  [0.05300421]
Stock Position:  0.05300420921619354
Bond Position:  [-5.58642543]


portfolio before change:  [-0.05591137]
curr_Stock_Price:  104.34762256908596
curr_Factors:  [104.34762257]
mat_Sqrt:  [[0.15]]
grads:  [-0.0222576]
Stock Position:  -0.022257599388243954
Bond Position:  [2.26661621]


portfolio before change:  [-0.04476493]
curr_Stock_Price:  103.85319470205789
curr_Factors:  [103.8531947]
mat_Sqrt:  [[0.15]]
grads:  [-0.15077775]
Stock Position:  -0.15077775316152145
Bond Position:  [15.61398643]


portfolio before change:  [0.02655825]
curr_Stock_Price:  103.38663203626722
curr_Factors:  [103.38663204]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170547]
Stock Position:  -0.02170546907437791
Bond Position:  [2.27061359]


portfolio before change:  [0.03403362]
curr_Stock_Price:  103.04876989746099
curr_Factors:  [103.0487699]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050965]
Stock Position:  -0.020509651487002983
Bond Position:  [2.14752798]


portfolio before change:  [0.03158664]
curr_Stock_Price:  103.17462299466524
curr_Factors:  [103.17462299]
mat_Sqrt:  [[0.15]]
grads:  [0.07044193]
Stock Position:  0.07044192703026056
Bond Position:  [-7.23623262]


portfolio before change:  [-0.00804742]
curr_Stock_Price:  102.61839482119
curr_Factors:  [102.61839482]
mat_Sqrt:  [[0.15]]
grads:  [-0.06212636]
Stock Position:  -0.06212635983713755
Bond Position:  [6.3672599]


portfolio before change:  [-0.04492011]
curr_Stock_Price:  103.21831182623633
curr_Factors:  [103.21831183]
mat_Sqrt:  [[0.15]]
grads:  [0.03246602]
Stock Position:  0.03246601557459605
Bond Position:  [-3.39600743]


portfolio before change:  [-0.05794739]
curr_Stock_Price:  102.82359083820708
curr_Factors:  [102.82359084]
mat_Sqrt:  [[0.15]]
grads:  [-0.02552949]
Stock Position:  -0.025529490369572746
Bond Position:  [2.56708648]


portfolio before change:  [-0.0514803]
curr_Stock_Price:  102.57655720848948
curr_Factors:  [102.57655721]
mat_Sqrt:  [[0.15]]
grads:  [-0.0180643]
Stock Position:  -0.018064298769392063
Bond Position:  [1.80149328]


portfolio before change:  [-0.04974229]
curr_Stock_Price:  102.48657785099735
curr_Factors:  [102.48657785]
mat_Sqrt:  [[0.15]]
grads:  [0.05392713]
Stock Position:  0.053927134707728794
Bond Position:  [-5.57654978]


portfolio before change:  [-0.10432293]
curr_Stock_Price:  101.48092272533914
curr_Factors:  [101.48092273]
mat_Sqrt:  [[0.15]]
grads:  [-0.08413716]
Stock Position:  -0.08413715700722099
Bond Position:  [8.4339934]


portfolio before change:  [-0.16811312]
curr_Stock_Price:  102.24535702664741
curr_Factors:  [102.24535703]
mat_Sqrt:  [[0.15]]
grads:  [0.02804827]
Stock Position:  0.028048274164131096
Bond Position:  [-3.03591892]


portfolio before change:  [-0.17947053]
curr_Stock_Price:  101.84719856783535
curr_Factors:  [101.84719857]
mat_Sqrt:  [[0.15]]
grads:  [0.17094878]
Stock Position:  0.17094877763996302
Bond Position:  [-17.59012463]


portfolio before change:  [-0.21355167]
curr_Stock_Price:  101.6542651603247
curr_Factors:  [101.65426516]
mat_Sqrt:  [[0.15]]
grads:  [0.03583334]
Stock Position:  0.035833341965342436
Bond Position:  [-3.85616372]


portfolio before change:  [-0.21133021]
curr_Stock_Price:  101.7229855573885
curr_Factors:  [101.72298556]
mat_Sqrt:  [[0.15]]
grads:  [0.08749385]
Stock Position:  0.08749385314604509
Bond Position:  [-9.11146617]


portfolio before change:  [-0.3134859]
curr_Stock_Price:  100.56191879527768
curr_Factors:  [100.5619188]
mat_Sqrt:  [[0.15]]
grads:  [-0.00454848]
Stock Position:  -0.004548481310308033
Bond Position:  [0.14391811]


portfolio before change:  [-0.3122122]
curr_Stock_Price:  100.28386956536477
curr_Factors:  [100.28386957]
mat_Sqrt:  [[0.15]]
grads:  [0.01905059]
Stock Position:  0.019050588729446302
Bond Position:  [-2.22267896]


portfolio before change:  [-0.31578267]
curr_Stock_Price:  100.10374128717018
curr_Factors:  [100.10374129]
mat_Sqrt:  [[0.15]]
grads:  [0.14557509]
Stock Position:  0.14557508599055335
Bond Position:  [-14.88839342]


portfolio before change:  [-0.29803782]
curr_Stock_Price:  100.23202836912924
curr_Factors:  [100.23202837]
mat_Sqrt:  [[0.15]]
grads:  [0.00406348]
Stock Position:  0.004063480328482308
Bond Position:  [-0.7053287]


portfolio before change:  [-0.2970265]
curr_Stock_Price:  100.4917589608473
curr_Factors:  [100.49175896]
mat_Sqrt:  [[0.15]]
grads:  [-0.1064702]
Stock Position:  -0.10647020201124748
Bond Position:  [10.40235138]


portfolio before change:  [-0.37524026]
curr_Stock_Price:  101.23247255128074
curr_Factors:  [101.23247255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00259798]
Stock Position:  -0.002597979753666396
Bond Position:  [-0.11224034]


portfolio before change:  [-0.37656491]
curr_Stock_Price:  101.73964970420022
curr_Factors:  [101.7396497]
mat_Sqrt:  [[0.15]]
grads:  [0.00890845]
Stock Position:  0.00890844935966221
Bond Position:  [-1.28290743]


portfolio before change:  [-0.37033992]
curr_Stock_Price:  102.44742384113181
curr_Factors:  [102.44742384]
mat_Sqrt:  [[0.15]]
grads:  [0.02466857]
Stock Position:  0.024668571996470247
Bond Position:  [-2.89757157]


portfolio before change:  [-0.36531993]
curr_Stock_Price:  102.6582628938699
curr_Factors:  [102.65826289]
mat_Sqrt:  [[0.15]]
grads:  [-0.10253715]
Stock Position:  -0.10253715129675925
Bond Position:  [10.16096591]


portfolio before change:  [-0.39529807]
curr_Stock_Price:  102.95682026922795
curr_Factors:  [102.95682027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424649]
Stock Position:  -0.024246491611512266
Bond Position:  [2.10104361]


portfolio before change:  [-0.37257657]
curr_Stock_Price:  102.02513143031517
curr_Factors:  [102.02513143]
mat_Sqrt:  [[0.15]]
grads:  [0.10362372]
Stock Position:  0.10362372364504449
Bond Position:  [-10.94480059]


portfolio before change:  [-0.34248224]
curr_Stock_Price:  102.32215219178231
curr_Factors:  [102.32215219]
mat_Sqrt:  [[0.15]]
grads:  [-0.03223263]
Stock Position:  -0.03223262624322854
Bond Position:  [2.95562945]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.3281045]
Stock Price:  101.88182177790375
PL:  [-2.20992628]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32403861e-02]
 [-1.92321343e-02]
 [ 5.10364240e-02]
 [-1.20810804e-02]
 [ 1.09735444e-02]
 [-1.47585967e-02]
 [-1.09613051e-02]
 [ 3.19674568e-02]
 [-2.09301939e-02]
 [-1.37291039e-02]
 [-1.48092295e-02]
 [-4.25704183e-03]
 [ 4.57580236e-03]
 [-4.34072289e-04]
 [-1.94879603e-03]
 [ 3.86231625e-03]
 [ 1.56218504e-02]
 [-1.38261260e-02]
 [ 2.49757198e-02]
 [-1.96022876e-03]
 [-9.61010050e-03]
 [ 5.50660947e-03]
 [ 1.30291024e-02]
 [ 1.91316849e-02]
 [-4.42955598e-03]
 [ 4.49873473e-03]
 [ 8.22905056e-03]
 [ 7.90319983e-03]
 [ 1.65847428e-02]
 [ 2.81356842e-03]
 [-7.15074539e-03]
 [ 1.00155784e-02]
 [ 1.17093063e-02]
 [-1.18960795e-02]
 [ 2.49949205e-03]
 [ 1.73905494e-02]
 [-2.49901668e-02]
 [ 3.07608229e-03]
 [-5.17972529e-02]
 [-3.69776655e-03]
 [ 5.69025709e-03]
 [ 2.56579779e-03]
 [-1.83862531e-03]
 [-3.57011996e-03]
 [ 2.20665446e-02]
 [ 1.43463093e-02]
 [ 1.08148909e-02]
 [ 3.25256463e-03]
 [ 1.00380079e-02]
 [-1.83438382e-03]
 [ 3.04110433e-03]
 [-1.10214348e-02]
 [ 2.13887967e-03]
 [ 4.76400135e-03]
 [-4.00151062e-03]
 [-3.86636217e-03]
 [ 1.01846741e-02]
 [-5.04983044e-03]
 [ 6.48253594e-03]
 [-3.94433382e-03]
 [-4.56385899e-03]
 [ 4.58636356e-03]
 [-1.99062000e-02]
 [ 1.71520840e-03]
 [ 1.88859582e-02]
 [ 1.39340104e-02]
 [ 1.50152561e-02]
 [ 6.30779133e-03]
 [ 3.07375893e-03]
 [ 1.99240293e-02]
 [ 4.59976500e-04]
 [-1.59429915e-02]
 [-6.53126540e-04]
 [ 1.37453180e-03]
 [ 1.34350279e-03]
 [-1.34778968e-02]
 [-4.23232916e-03]
 [ 1.59508840e-02]
 [-6.92393675e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.73244372]
curr_Stock_Price:  99.51119587966224
curr_Factors:  [99.51119588]
mat_Sqrt:  [[0.15]]
grads:  [-0.08826924]
Stock Position:  -0.08826924054704996
Bond Position:  [0.05133397]


portfolio before change:  [-8.68361206]
curr_Stock_Price:  98.95801959627525
curr_Factors:  [98.9580196]
mat_Sqrt:  [[0.15]]
grads:  [-0.12821423]
Stock Position:  -0.1282142285374871
Bond Position:  [4.00421408]


portfolio before change:  [-8.60588515]
curr_Stock_Price:  98.35374467794853
curr_Factors:  [98.35374468]
mat_Sqrt:  [[0.15]]
grads:  [0.34024283]
Stock Position:  0.3402428264916353
Bond Position:  [-42.07004123]


portfolio before change:  [-8.91510581]
curr_Stock_Price:  97.45264939641717
curr_Factors:  [97.4526494]
mat_Sqrt:  [[0.15]]
grads:  [-0.08054054]
Stock Position:  -0.08054053604664424
Bond Position:  [-1.06621719]


portfolio before change:  [-9.00210649]
curr_Stock_Price:  98.53203179615099
curr_Factors:  [98.5320318]
mat_Sqrt:  [[0.15]]
grads:  [0.07315696]
Stock Position:  0.07315696243159453
Bond Position:  [-16.21041064]


portfolio before change:  [-9.00574231]
curr_Stock_Price:  98.49618235405966
curr_Factors:  [98.49618235]
mat_Sqrt:  [[0.15]]
grads:  [-0.09839064]
Stock Position:  -0.09839064477157015
Bond Position:  [0.68536058]


portfolio before change:  [-9.03424451]
curr_Stock_Price:  98.78630172539704
curr_Factors:  [98.78630173]
mat_Sqrt:  [[0.15]]
grads:  [-0.07307537]
Stock Position:  -0.07307536709280381
Bond Position:  [-1.81539924]


portfolio before change:  [-9.0133472]
curr_Stock_Price:  98.49877979183151
curr_Factors:  [98.49877979]
mat_Sqrt:  [[0.15]]
grads:  [0.21311638]
Stock Position:  0.21311637880813344
Bond Position:  [-30.00505047]


portfolio before change:  [-9.21268757]
curr_Stock_Price:  97.57222032550577
curr_Factors:  [97.57222033]
mat_Sqrt:  [[0.15]]
grads:  [-0.13953463]
Stock Position:  -0.13953462585501436
Bond Position:  [4.40201568]


portfolio before change:  [-9.16320874]
curr_Stock_Price:  97.21959316796166
curr_Factors:  [97.21959317]
mat_Sqrt:  [[0.15]]
grads:  [-0.09152736]
Stock Position:  -0.0915273594326615
Bond Position:  [-0.26495609]


portfolio before change:  [-9.04477391]
curr_Stock_Price:  95.92542942004489
curr_Factors:  [95.92542942]
mat_Sqrt:  [[0.15]]
grads:  [-0.0987282]
Stock Position:  -0.09872819689308544
Bond Position:  [0.42577077]


portfolio before change:  [-9.09576501]
curr_Stock_Price:  96.44217856858278
curr_Factors:  [96.44217857]
mat_Sqrt:  [[0.15]]
grads:  [-0.02838028]
Stock Position:  -0.028380278851639497
Bond Position:  [-6.35870909]


portfolio before change:  [-9.1347288]
curr_Stock_Price:  97.8010926446417
curr_Factors:  [97.80109264]
mat_Sqrt:  [[0.15]]
grads:  [0.03050535]
Stock Position:  0.030505349068065426
Bond Position:  [-12.11818527]


portfolio before change:  [-9.11763951]
curr_Stock_Price:  98.38612787872157
curr_Factors:  [98.38612788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00289382]
Stock Position:  -0.0028938152581705137
Bond Position:  [-8.83292823]


portfolio before change:  [-9.11719061]
curr_Stock_Price:  98.04022575359176
curr_Factors:  [98.04022575]
mat_Sqrt:  [[0.15]]
grads:  [-0.01299197]
Stock Position:  -0.012991973557006561
Bond Position:  [-7.84345459]


portfolio before change:  [-9.11387856]
curr_Stock_Price:  97.74756215451093
curr_Factors:  [97.74756215]
mat_Sqrt:  [[0.15]]
grads:  [0.02574877]
Stock Position:  0.02574877498207133
Bond Position:  [-11.63075854]


portfolio before change:  [-9.07965325]
curr_Stock_Price:  99.1049958562424
curr_Factors:  [99.10499586]
mat_Sqrt:  [[0.15]]
grads:  [0.10414567]
Stock Position:  0.1041456692761004
Bond Position:  [-19.40100937]


portfolio before change:  [-9.11982839]
curr_Stock_Price:  98.73088009746132
curr_Factors:  [98.7308801]
mat_Sqrt:  [[0.15]]
grads:  [-0.09217417]
Stock Position:  -0.09217417334917861
Bond Position:  [-0.01939113]


portfolio before change:  [-9.09230911]
curr_Stock_Price:  98.43230960125568
curr_Factors:  [98.4323096]
mat_Sqrt:  [[0.15]]
grads:  [0.1665048]
Stock Position:  0.16650479851748115
Bond Position:  [-25.48176099]


portfolio before change:  [-9.17377832]
curr_Stock_Price:  97.95258439863291
curr_Factors:  [97.9525844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01306819]
Stock Position:  -0.013068191754715758
Bond Position:  [-7.89371516]


portfolio before change:  [-9.17587336]
curr_Stock_Price:  98.07514680214179
curr_Factors:  [98.0751468]
mat_Sqrt:  [[0.15]]
grads:  [-0.06406734]
Stock Position:  -0.0640673366808387
Bond Position:  [-2.89245991]


portfolio before change:  [-9.16879296]
curr_Stock_Price:  97.96181004381265
curr_Factors:  [97.96181004]
mat_Sqrt:  [[0.15]]
grads:  [0.03671073]
Stock Position:  0.03671072982137049
Bond Position:  [-12.7650425]


portfolio before change:  [-9.17734431]
curr_Stock_Price:  97.75060457402421
curr_Factors:  [97.75060457]
mat_Sqrt:  [[0.15]]
grads:  [0.08686068]
Stock Position:  0.08686068292503699
Bond Position:  [-17.66802858]


portfolio before change:  [-9.11451065]
curr_Stock_Price:  98.4867022070159
curr_Factors:  [98.48670221]
mat_Sqrt:  [[0.15]]
grads:  [0.12754457]
Stock Position:  0.1275445659762705
Bond Position:  [-21.67595434]


portfolio before change:  [-9.12322958]
curr_Stock_Price:  98.42896446195743
curr_Factors:  [98.42896446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02953037]
Stock Position:  -0.02953037323230861
Bond Position:  [-6.21658552]


portfolio before change:  [-9.11623517]
curr_Stock_Price:  98.17895234372496
curr_Factors:  [98.17895234]
mat_Sqrt:  [[0.15]]
grads:  [0.02999156]
Stock Position:  0.02999156489661492
Bond Position:  [-12.06077559]


portfolio before change:  [-9.08871709]
curr_Stock_Price:  99.12161414109156
curr_Factors:  [99.12161414]
mat_Sqrt:  [[0.15]]
grads:  [0.05486034]
Stock Position:  0.054860337094329234
Bond Position:  [-14.52656226]


portfolio before change:  [-9.07670325]
curr_Stock_Price:  99.35715373067225
curr_Factors:  [99.35715373]
mat_Sqrt:  [[0.15]]
grads:  [0.052688]
Stock Position:  0.052687998860805586
Bond Position:  [-14.31163285]


portfolio before change:  [-9.07253011]
curr_Stock_Price:  99.45333587846947
curr_Factors:  [99.45333588]
mat_Sqrt:  [[0.15]]
grads:  [0.11056495]
Stock Position:  0.11056495225730412
Bond Position:  [-20.06858344]


portfolio before change:  [-9.09663061]
curr_Stock_Price:  99.24670460246512
curr_Factors:  [99.2467046]
mat_Sqrt:  [[0.15]]
grads:  [0.01875712]
Stock Position:  0.01875712278572729
Bond Position:  [-10.95821324]


portfolio before change:  [-9.08822142]
curr_Stock_Price:  99.73153916451388
curr_Factors:  [99.73153916]
mat_Sqrt:  [[0.15]]
grads:  [-0.04767164]
Stock Position:  -0.04767163594252031
Bond Position:  [-4.33385579]


portfolio before change:  [-9.07657715]
curr_Stock_Price:  99.4815971106153
curr_Factors:  [99.48159711]
mat_Sqrt:  [[0.15]]
grads:  [0.06677052]
Stock Position:  0.06677052263014627
Bond Position:  [-15.71901538]


portfolio before change:  [-9.0838677]
curr_Stock_Price:  99.3871230503202
curr_Factors:  [99.38712305]
mat_Sqrt:  [[0.15]]
grads:  [0.07806204]
Stock Position:  0.07806204170747562
Bond Position:  [-16.84222945]


portfolio before change:  [-9.10185062]
curr_Stock_Price:  99.1702411423149
curr_Factors:  [99.17024114]
mat_Sqrt:  [[0.15]]
grads:  [-0.0793072]
Stock Position:  -0.07930719694865562
Bond Position:  [-1.23693677]


portfolio before change:  [-9.09909888]
curr_Stock_Price:  99.13456917490734
curr_Factors:  [99.13456917]
mat_Sqrt:  [[0.15]]
grads:  [0.01666328]
Stock Position:  0.0166632803103899
Bond Position:  [-10.751006]


portfolio before change:  [-9.09176407]
curr_Stock_Price:  99.61507325745592
curr_Factors:  [99.61507326]
mat_Sqrt:  [[0.15]]
grads:  [0.115937]
Stock Position:  0.11593699590833433
Bond Position:  [-20.64083641]


portfolio before change:  [-8.99307061]
curr_Stock_Price:  100.47746880843768
curr_Factors:  [100.47746881]
mat_Sqrt:  [[0.15]]
grads:  [-0.16660111]
Stock Position:  -0.1666011118232387
Bond Position:  [7.7465874]


portfolio before change:  [-9.09920308]
curr_Stock_Price:  101.11742037146979
curr_Factors:  [101.11742037]
mat_Sqrt:  [[0.15]]
grads:  [0.02050722]
Stock Position:  0.020507215233504454
Bond Position:  [-11.17283978]


portfolio before change:  [-9.10518779]
curr_Stock_Price:  100.85963860984963
curr_Factors:  [100.85963861]
mat_Sqrt:  [[0.15]]
grads:  [-0.34531502]
Stock Position:  -0.3453150192952494
Bond Position:  [25.72316026]


portfolio before change:  [-9.24950014]
curr_Stock_Price:  101.28220956245893
curr_Factors:  [101.28220956]
mat_Sqrt:  [[0.15]]
grads:  [-0.02465178]
Stock Position:  -0.024651776985224312
Bond Position:  [-6.75271369]


portfolio before change:  [-9.24703331]
curr_Stock_Price:  101.1650219995568
curr_Factors:  [101.165022]
mat_Sqrt:  [[0.15]]
grads:  [0.03793505]
Stock Position:  0.03793504725613922
Bond Position:  [-13.0847332]


portfolio before change:  [-9.27014868]
curr_Stock_Price:  100.57723988148105
curr_Factors:  [100.57723988]
mat_Sqrt:  [[0.15]]
grads:  [0.01710532]
Stock Position:  0.017105318580362523
Bond Position:  [-10.99055441]


portfolio before change:  [-9.27671202]
curr_Stock_Price:  100.2336969564212
curr_Factors:  [100.23369696]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122575]
Stock Position:  -0.012257502095287118
Bond Position:  [-8.04809727]


portfolio before change:  [-9.27643335]
curr_Stock_Price:  100.16992427851146
curr_Factors:  [100.16992428]
mat_Sqrt:  [[0.15]]
grads:  [-0.0238008]
Stock Position:  -0.023800799716501043
Bond Position:  [-6.89230904]


portfolio before change:  [-9.28786141]
curr_Stock_Price:  100.63197952710883
curr_Factors:  [100.63197953]
mat_Sqrt:  [[0.15]]
grads:  [0.1471103]
Stock Position:  0.14711029728479
Bond Position:  [-24.09186184]


portfolio before change:  [-9.25750634]
curr_Stock_Price:  100.84855757067177
curr_Factors:  [100.84855757]
mat_Sqrt:  [[0.15]]
grads:  [0.09564206]
Stock Position:  0.09564206214372245
Bond Position:  [-18.90287035]


portfolio before change:  [-9.25481816]
curr_Stock_Price:  100.88901722812763
curr_Factors:  [100.88901723]
mat_Sqrt:  [[0.15]]
grads:  [0.07209927]
Stock Position:  0.072099272549261
Bond Position:  [-16.52884291]


portfolio before change:  [-9.24232658]
curr_Stock_Price:  101.07660122535961
curr_Factors:  [101.07660123]
mat_Sqrt:  [[0.15]]
grads:  [0.02168376]
Stock Position:  0.02168376419025672
Bond Position:  [-11.43404777]


portfolio before change:  [-9.24987123]
curr_Stock_Price:  100.76161906008267
curr_Factors:  [100.76161906]
mat_Sqrt:  [[0.15]]
grads:  [0.06692005]
Stock Position:  0.06692005237905002
Bond Position:  [-15.99284405]


portfolio before change:  [-9.27625731]
curr_Stock_Price:  100.38226345083292
curr_Factors:  [100.38226345]
mat_Sqrt:  [[0.15]]
grads:  [-0.01222923]
Stock Position:  -0.012229225437731089
Bond Position:  [-8.04865998]


portfolio before change:  [-9.27769322]
curr_Stock_Price:  100.45854399597819
curr_Factors:  [100.458544]
mat_Sqrt:  [[0.15]]
grads:  [0.02027403]
Stock Position:  0.020274028881346953
Bond Position:  [-11.31439264]


portfolio before change:  [-9.27795768]
curr_Stock_Price:  100.48038036910195
curr_Factors:  [100.48038037]
mat_Sqrt:  [[0.15]]
grads:  [-0.07347623]
Stock Position:  -0.07347623230348593
Bond Position:  [-1.89503791]


portfolio before change:  [-9.27912721]
curr_Stock_Price:  100.49468551846873
curr_Factors:  [100.49468552]
mat_Sqrt:  [[0.15]]
grads:  [0.0142592]
Stock Position:  0.014259197774508283
Bond Position:  [-10.71210081]


portfolio before change:  [-9.29316856]
curr_Stock_Price:  99.55691717227872
curr_Factors:  [99.55691717]
mat_Sqrt:  [[0.15]]
grads:  [0.03176001]
Stock Position:  0.03176000901075773
Bond Position:  [-12.45509715]


portfolio before change:  [-9.26016145]
curr_Stock_Price:  100.62069465275826
curr_Factors:  [100.62069465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02667674]
Stock Position:  -0.026676737439621664
Bond Position:  [-6.5759296]


portfolio before change:  [-9.25937386]
curr_Stock_Price:  100.5757641701102
curr_Factors:  [100.57576417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02577575]
Stock Position:  -0.025775747827430334
Bond Position:  [-6.66695832]


portfolio before change:  [-9.28241081]
curr_Stock_Price:  101.4533431848053
curr_Factors:  [101.45334318]
mat_Sqrt:  [[0.15]]
grads:  [0.06789783]
Stock Position:  0.06789782723154789
Bond Position:  [-16.17087238]


portfolio before change:  [-9.27206198]
curr_Stock_Price:  101.6206466864553
curr_Factors:  [101.62064669]
mat_Sqrt:  [[0.15]]
grads:  [-0.03366554]
Stock Position:  -0.03366553627454756
Bond Position:  [-5.85094841]


portfolio before change:  [-9.28348434]
curr_Stock_Price:  101.94907347721154
curr_Factors:  [101.94907348]
mat_Sqrt:  [[0.15]]
grads:  [0.04321691]
Stock Position:  0.043216906256060963
Bond Position:  [-13.68940789]


portfolio before change:  [-9.27537206]
curr_Stock_Price:  102.15658236769268
curr_Factors:  [102.15658237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02629556]
Stock Position:  -0.026295558808899066
Bond Position:  [-6.58910764]


portfolio before change:  [-9.32340612]
curr_Stock_Price:  103.96761926895005
curr_Factors:  [103.96761927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03042573]
Stock Position:  -0.03042572658891282
Bond Position:  [-6.16011576]


portfolio before change:  [-9.33342998]
curr_Stock_Price:  104.28441833687661
curr_Factors:  [104.28441834]
mat_Sqrt:  [[0.15]]
grads:  [0.03057576]
Stock Position:  0.03057575709504505
Bond Position:  [-12.52200502]


portfolio before change:  [-9.34741269]
curr_Stock_Price:  103.85270176009597
curr_Factors:  [103.85270176]
mat_Sqrt:  [[0.15]]
grads:  [-0.132708]
Stock Position:  -0.13270800001470084
Bond Position:  [4.43467166]


portfolio before change:  [-9.28909738]
curr_Stock_Price:  103.41536462048157
curr_Factors:  [103.41536462]
mat_Sqrt:  [[0.15]]
grads:  [0.01143472]
Stock Position:  0.011434722680037285
Bond Position:  [-10.47162339]


portfolio before change:  [-9.28724447]
curr_Stock_Price:  103.63464441151937
curr_Factors:  [103.63464441]
mat_Sqrt:  [[0.15]]
grads:  [0.12590639]
Stock Position:  0.1259063876918996
Bond Position:  [-22.33550819]


portfolio before change:  [-9.20357837]
curr_Stock_Price:  104.31024252754956
curr_Factors:  [104.31024253]
mat_Sqrt:  [[0.15]]
grads:  [0.0928934]
Stock Position:  0.09289340264201748
Bond Position:  [-18.89331173]


portfolio before change:  [-9.34739263]
curr_Stock_Price:  102.77479013635667
curr_Factors:  [102.77479014]
mat_Sqrt:  [[0.15]]
grads:  [0.10010171]
Stock Position:  0.1001017074519941
Bond Position:  [-19.63532461]


portfolio before change:  [-9.38658894]
curr_Stock_Price:  102.39548528178727
curr_Factors:  [102.39548528]
mat_Sqrt:  [[0.15]]
grads:  [0.04205194]
Stock Position:  0.04205194223085601
Bond Position:  [-13.69251797]


portfolio before change:  [-9.42928128]
curr_Stock_Price:  101.40060781959242
curr_Factors:  [101.40060782]
mat_Sqrt:  [[0.15]]
grads:  [0.02049173]
Stock Position:  0.02049172617388404
Bond Position:  [-11.50715477]


portfolio before change:  [-9.43169739]
curr_Stock_Price:  101.3177993251159
curr_Factors:  [101.31779933]
mat_Sqrt:  [[0.15]]
grads:  [0.13282686]
Stock Position:  0.13282686200013866
Bond Position:  [-22.88942274]


portfolio before change:  [-9.45049207]
curr_Stock_Price:  101.18707244214106
curr_Factors:  [101.18707244]
mat_Sqrt:  [[0.15]]
grads:  [0.00306651]
Stock Position:  0.0030665100002646734
Bond Position:  [-9.76078323]


portfolio before change:  [-9.45186972]
curr_Stock_Price:  100.9367588789713
curr_Factors:  [100.93675888]
mat_Sqrt:  [[0.15]]
grads:  [-0.10628661]
Stock Position:  -0.1062866097430025
Bond Position:  [1.27635618]


portfolio before change:  [-9.4443466]
curr_Stock_Price:  100.86672797151532
curr_Factors:  [100.86672797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00435418]
Stock Position:  -0.004354176933259006
Bond Position:  [-9.00515502]


portfolio before change:  [-9.44550374]
curr_Stock_Price:  101.00321771900322
curr_Factors:  [101.00321772]
mat_Sqrt:  [[0.15]]
grads:  [0.00916355]
Stock Position:  0.009163545363253705
Bond Position:  [-10.37105131]


portfolio before change:  [-9.43962594]
curr_Stock_Price:  101.71538867829874
curr_Factors:  [101.71538868]
mat_Sqrt:  [[0.15]]
grads:  [0.00895669]
Stock Position:  0.008956685284717537
Bond Position:  [-10.35065866]


portfolio before change:  [-9.43942044]
curr_Stock_Price:  101.81056208767447
curr_Factors:  [101.81056209]
mat_Sqrt:  [[0.15]]
grads:  [-0.08985265]
Stock Position:  -0.08985264511523962
Bond Position:  [-0.29147213]


portfolio before change:  [-9.42390303]
curr_Stock_Price:  101.63766091499674
curr_Factors:  [101.63766091]
mat_Sqrt:  [[0.15]]
grads:  [-0.02821553]
Stock Position:  -0.028215527745655382
Bond Position:  [-6.55614279]


portfolio before change:  [-9.43007901]
curr_Stock_Price:  101.84202383522367
curr_Factors:  [101.84202384]
mat_Sqrt:  [[0.15]]
grads:  [0.10633923]
Stock Position:  0.10633922654450004
Bond Position:  [-20.25988105]


portfolio before change:  [-9.42816846]
curr_Stock_Price:  101.871898307067
curr_Factors:  [101.87189831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04615958]
Stock Position:  -0.046159578301352144
Bond Position:  [-4.72580459]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.40799575]
Stock Price:  101.42847826095458
PL:  [-10.83647401]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-8.07799550e-03]
 [ 3.10956466e-02]
 [ 1.89434683e-02]
 [-1.72718089e-02]
 [ 1.33172786e-02]
 [-1.35594467e-02]
 [-4.36657351e-03]
 [-8.40793680e-03]
 [-1.31895941e-03]
 [ 1.29542066e-03]
 [ 6.36845030e-03]
 [-2.09087272e-03]
 [-2.58923549e-03]
 [ 7.06126741e-03]
 [-2.39829661e-03]
 [ 1.14874782e-02]
 [ 2.41494888e-03]
 [-1.51754377e-02]
 [ 2.12691700e-02]
 [ 2.48527145e-03]
 [-3.99226968e-03]
 [ 4.28439852e-03]
 [ 1.49839542e-02]
 [ 1.72439629e-02]
 [-3.68170893e-03]
 [ 6.71197078e-03]
 [ 4.80648807e-03]
 [ 1.38655686e-02]
 [ 2.94941668e-02]
 [-4.18366905e-03]
 [-1.06356783e-04]
 [ 1.41888905e-02]
 [ 1.42207817e-02]
 [-5.57113402e-03]
 [ 4.60139602e-03]
 [-4.17903907e-03]
 [-9.86692073e-03]
 [-9.75082646e-03]
 [-1.75453835e-02]
 [-2.63286088e-02]
 [ 3.59506317e-03]
 [ 9.23383185e-03]
 [-8.49172641e-03]
 [-7.05215454e-04]
 [ 8.37718240e-03]
 [ 1.35626534e-02]
 [ 1.06461425e-02]
 [-9.92633210e-05]
 [ 1.52732937e-02]
 [-1.17881332e-03]
 [ 1.79235827e-02]
 [-1.34402471e-02]
 [-4.36456671e-04]
 [-1.24902982e-02]
 [-1.93822809e-03]
 [-3.13617897e-03]
 [ 9.98872295e-03]
 [-1.45086735e-02]
 [ 5.03789284e-03]
 [-3.48275482e-03]
 [-3.34712573e-03]
 [ 7.09542303e-03]
 [-1.95038020e-02]
 [ 1.66717303e-03]
 [ 1.87881660e-02]
 [ 1.07762263e-02]
 [ 1.37449054e-02]
 [ 8.88539492e-03]
 [ 4.69017979e-03]
 [ 1.46841679e-02]
 [ 5.74829198e-04]
 [-1.59745782e-02]
 [-6.09151875e-04]
 [ 1.40307577e-03]
 [ 4.18290555e-03]
 [-1.70324836e-02]
 [-3.42205375e-03]
 [ 1.31319632e-02]
 [-4.61318534e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.56656074]
curr_Stock_Price:  101.20524022590077
curr_Factors:  [101.20524023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0538533]
Stock Position:  -0.053853303330035
Bond Position:  [34.01679724]


portfolio before change:  [28.59431349]
curr_Stock_Price:  100.72938016253693
curr_Factors:  [100.72938016]
mat_Sqrt:  [[0.15]]
grads:  [0.20730431]
Stock Position:  0.20730431064101656
Bond Position:  [7.71267878]


portfolio before change:  [28.70764178]
curr_Stock_Price:  101.27373079059082
curr_Factors:  [101.27373079]
mat_Sqrt:  [[0.15]]
grads:  [0.12628979]
Stock Position:  0.12628978854938686
Bond Position:  [15.91780373]


portfolio before change:  [28.6393721]
curr_Stock_Price:  100.72527337541787
curr_Factors:  [100.72527338]
mat_Sqrt:  [[0.15]]
grads:  [-0.11514539]
Stock Position:  -0.11514539236120987
Bond Position:  [40.23742323]


portfolio before change:  [28.70498512]
curr_Stock_Price:  100.17728703667329
curr_Factors:  [100.17728704]
mat_Sqrt:  [[0.15]]
grads:  [0.08878186]
Stock Position:  0.08878185722075063
Bond Position:  [19.81105953]


portfolio before change:  [28.61825864]
curr_Stock_Price:  99.18649093617937
curr_Factors:  [99.18649094]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039631]
Stock Position:  -0.09039631151189682
Bond Position:  [37.58435157]


portfolio before change:  [28.62188992]
curr_Stock_Price:  99.17230688479259
curr_Factors:  [99.17230688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02911049]
Stock Position:  -0.029110490062296986
Bond Position:  [31.50884437]


portfolio before change:  [28.59723942]
curr_Stock_Price:  100.08674921039862
curr_Factors:  [100.08674921]
mat_Sqrt:  [[0.15]]
grads:  [-0.05605291]
Stock Position:  -0.056052912029772965
Bond Position:  [34.20739317]


portfolio before change:  [28.59120551]
curr_Stock_Price:  100.23253880496789
curr_Factors:  [100.2325388]
mat_Sqrt:  [[0.15]]
grads:  [-0.00879306]
Stock Position:  -0.008793062762803075
Bond Position:  [29.47255652]


portfolio before change:  [28.59133872]
curr_Stock_Price:  100.42688411286011
curr_Factors:  [100.42688411]
mat_Sqrt:  [[0.15]]
grads:  [0.00863614]
Stock Position:  0.008636137756366838
Bond Position:  [27.72403831]


portfolio before change:  [28.59313268]
curr_Stock_Price:  100.43396546673901
curr_Factors:  [100.43396547]
mat_Sqrt:  [[0.15]]
grads:  [0.04245634]
Stock Position:  0.04245633531098029
Bond Position:  [24.32907456]


portfolio before change:  [28.58472804]
curr_Stock_Price:  100.20018990035076
curr_Factors:  [100.2001899]
mat_Sqrt:  [[0.15]]
grads:  [-0.01393915]
Stock Position:  -0.013939151487444186
Bond Position:  [29.98143366]


portfolio before change:  [28.58345239]
curr_Stock_Price:  100.4261393317676
curr_Factors:  [100.42613933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726157]
Stock Position:  -0.017261569953747197
Bond Position:  [30.31696522]


portfolio before change:  [28.58108946]
curr_Stock_Price:  100.67280313864542
curr_Factors:  [100.67280314]
mat_Sqrt:  [[0.15]]
grads:  [0.04707512]
Stock Position:  0.04707511604710512
Bond Position:  [23.84190557]


portfolio before change:  [28.57211998]
curr_Stock_Price:  100.45061263113482
curr_Factors:  [100.45061263]
mat_Sqrt:  [[0.15]]
grads:  [-0.01598864]
Stock Position:  -0.015988644076764327
Bond Position:  [30.17818907]


portfolio before change:  [28.59117501]
curr_Stock_Price:  99.37679841056176
curr_Factors:  [99.37679841]
mat_Sqrt:  [[0.15]]
grads:  [0.07658319]
Stock Position:  0.07658318812266886
Bond Position:  [20.98058296]


portfolio before change:  [28.53450101]
curr_Stock_Price:  98.61964363479377
curr_Factors:  [98.61964363]
mat_Sqrt:  [[0.15]]
grads:  [0.01609966]
Stock Position:  0.016099659215071255
Bond Position:  [26.94675836]


portfolio before change:  [28.54924891]
curr_Stock_Price:  99.43106946183704
curr_Factors:  [99.43106946]
mat_Sqrt:  [[0.15]]
grads:  [-0.10116958]
Stock Position:  -0.1011695849466548
Bond Position:  [38.60864894]


portfolio before change:  [28.54588373]
curr_Stock_Price:  99.48818448971471
curr_Factors:  [99.48818449]
mat_Sqrt:  [[0.15]]
grads:  [0.14179447]
Stock Position:  0.14179446692322276
Bond Position:  [14.43900964]


portfolio before change:  [28.60036704]
curr_Stock_Price:  99.86606136718423
curr_Factors:  [99.86606137]
mat_Sqrt:  [[0.15]]
grads:  [0.01656848]
Stock Position:  0.016568476318266717
Bond Position:  [26.94573857]


portfolio before change:  [28.60323478]
curr_Stock_Price:  99.93749659931333
curr_Factors:  [99.9374966]
mat_Sqrt:  [[0.15]]
grads:  [-0.02661513]
Stock Position:  -0.026615131192440022
Bond Position:  [31.26308436]


portfolio before change:  [28.60519636]
curr_Stock_Price:  99.93721200844556
curr_Factors:  [99.93721201]
mat_Sqrt:  [[0.15]]
grads:  [0.02856266]
Stock Position:  0.02856265678971945
Bond Position:  [25.75072407]


portfolio before change:  [28.61523793]
curr_Stock_Price:  100.23242610190617
curr_Factors:  [100.2324261]
mat_Sqrt:  [[0.15]]
grads:  [0.09989303]
Stock Position:  0.09989302808707343
Bond Position:  [18.60271737]


portfolio before change:  [28.60950928]
curr_Stock_Price:  100.163438786636
curr_Factors:  [100.16343879]
mat_Sqrt:  [[0.15]]
grads:  [0.11495975]
Stock Position:  0.11495975238586915
Bond Position:  [17.09474516]


portfolio before change:  [28.65275534]
curr_Stock_Price:  100.530329015632
curr_Factors:  [100.53032902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02454473]
Stock Position:  -0.024544726179438852
Bond Position:  [31.12024474]


portfolio before change:  [28.64525701]
curr_Stock_Price:  100.9150719671453
curr_Factors:  [100.91507197]
mat_Sqrt:  [[0.15]]
grads:  [0.04474647]
Stock Position:  0.044746471862840274
Bond Position:  [24.12966358]


portfolio before change:  [28.70510273]
curr_Stock_Price:  102.21880760141595
curr_Factors:  [102.2188076]
mat_Sqrt:  [[0.15]]
grads:  [0.03204325]
Stock Position:  0.03204325379163068
Bond Position:  [25.42967954]


portfolio before change:  [28.69179611]
curr_Stock_Price:  101.75393529269988
curr_Factors:  [101.75393529]
mat_Sqrt:  [[0.15]]
grads:  [0.09243712]
Stock Position:  0.0924371240504111
Bond Position:  [19.28595498]


portfolio before change:  [28.70060275]
curr_Stock_Price:  101.83616659692159
curr_Factors:  [101.8361666]
mat_Sqrt:  [[0.15]]
grads:  [0.19662778]
Stock Position:  0.1966277789289695
Bond Position:  [8.6767835]


portfolio before change:  [28.72068067]
curr_Stock_Price:  101.93551982666808
curr_Factors:  [101.93551983]
mat_Sqrt:  [[0.15]]
grads:  [-0.02789113]
Stock Position:  -0.027891127003062954
Bond Position:  [31.5637772]


portfolio before change:  [28.69883004]
curr_Stock_Price:  102.78967777795934
curr_Factors:  [102.78967778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00070905]
Stock Position:  -0.0007090452171515035
Bond Position:  [28.77171257]


portfolio before change:  [28.70051433]
curr_Stock_Price:  102.95045056032728
curr_Factors:  [102.95045056]
mat_Sqrt:  [[0.15]]
grads:  [0.0945926]
Stock Position:  0.09459260305465123
Bond Position:  [18.96216323]


portfolio before change:  [28.71696986]
curr_Stock_Price:  103.11188342283921
curr_Factors:  [103.11188342]
mat_Sqrt:  [[0.15]]
grads:  [0.09480521]
Stock Position:  0.09480521149963615
Bond Position:  [18.94142594]


portfolio before change:  [28.76594321]
curr_Stock_Price:  103.61596407479138
curr_Factors:  [103.61596407]
mat_Sqrt:  [[0.15]]
grads:  [-0.03714089]
Stock Position:  -0.03714089346854385
Bond Position:  [32.61433269]


portfolio before change:  [28.76468167]
curr_Stock_Price:  103.70481493287959
curr_Factors:  [103.70481493]
mat_Sqrt:  [[0.15]]
grads:  [0.03067597]
Stock Position:  0.030675973499228945
Bond Position:  [25.58343551]


portfolio before change:  [28.77876586]
curr_Stock_Price:  104.11181683038684
curr_Factors:  [104.11181683]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786026]
Stock Position:  -0.027860260480344276
Bond Position:  [31.6793482]


portfolio before change:  [28.77345406]
curr_Stock_Price:  104.37354541634971
curr_Factors:  [104.37354542]
mat_Sqrt:  [[0.15]]
grads:  [-0.06577947]
Stock Position:  -0.06577947151030758
Bond Position:  [35.63909071]


portfolio before change:  [28.80688534]
curr_Stock_Price:  103.8991759971462
curr_Factors:  [103.899176]
mat_Sqrt:  [[0.15]]
grads:  [-0.06500551]
Stock Position:  -0.06500550972518673
Bond Position:  [35.56090424]


portfolio before change:  [28.84270105]
curr_Stock_Price:  103.38240307164368
curr_Factors:  [103.38240307]
mat_Sqrt:  [[0.15]]
grads:  [-0.11696922]
Stock Position:  -0.11696922329617321
Bond Position:  [40.93526044]


portfolio before change:  [28.78163475]
curr_Stock_Price:  103.92634819261879
curr_Factors:  [103.92634819]
mat_Sqrt:  [[0.15]]
grads:  [-0.17552406]
Stock Position:  -0.1755240584967294
Bond Position:  [47.02320917]


portfolio before change:  [28.81676742]
curr_Stock_Price:  103.74293384429404
curr_Factors:  [103.74293384]
mat_Sqrt:  [[0.15]]
grads:  [0.02396709]
Stock Position:  0.023967087831518945
Bond Position:  [26.33035141]


portfolio before change:  [28.80653539]
curr_Stock_Price:  103.2473487361421
curr_Factors:  [103.24734874]
mat_Sqrt:  [[0.15]]
grads:  [0.06155888]
Stock Position:  0.061558878982453775
Bond Position:  [22.45074434]


portfolio before change:  [28.79164103]
curr_Stock_Price:  102.98260102425982
curr_Factors:  [102.98260102]
mat_Sqrt:  [[0.15]]
grads:  [-0.05661151]
Stock Position:  -0.056611509423190105
Bond Position:  [34.62164152]


portfolio before change:  [28.81714471]
curr_Stock_Price:  102.57032161233963
curr_Factors:  [102.57032161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00470144]
Stock Position:  -0.004701436358498156
Bond Position:  [29.29937255]


portfolio before change:  [28.81824761]
curr_Stock_Price:  102.72524608833722
curr_Factors:  [102.72524609]
mat_Sqrt:  [[0.15]]
grads:  [0.05584788]
Stock Position:  0.0558478826849789
Bond Position:  [23.08126012]


portfolio before change:  [28.74529268]
curr_Stock_Price:  101.39309977987307
curr_Factors:  [101.39309978]
mat_Sqrt:  [[0.15]]
grads:  [0.09041769]
Stock Position:  0.09041768904269976
Bond Position:  [19.57756292]


portfolio before change:  [28.77597085]
curr_Stock_Price:  101.71886045165132
curr_Factors:  [101.71886045]
mat_Sqrt:  [[0.15]]
grads:  [0.07097428]
Stock Position:  0.07097428332066533
Bond Position:  [21.55654763]


portfolio before change:  [28.81341362]
curr_Stock_Price:  102.22743127909573
curr_Factors:  [102.22743128]
mat_Sqrt:  [[0.15]]
grads:  [-0.00066176]
Stock Position:  -0.0006617554732271159
Bond Position:  [28.88106319]


portfolio before change:  [28.81549122]
curr_Stock_Price:  101.81569160571962
curr_Factors:  [101.81569161]
mat_Sqrt:  [[0.15]]
grads:  [0.10182196]
Stock Position:  0.10182195794480954
Bond Position:  [18.44841815]


portfolio before change:  [28.8579703]
curr_Stock_Price:  102.22155712531843
curr_Factors:  [102.22155713]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785876]
Stock Position:  -0.00785875544272945
Bond Position:  [29.66130452]


portfolio before change:  [28.86135297]
curr_Stock_Price:  102.02702486213808
curr_Factors:  [102.02702486]
mat_Sqrt:  [[0.15]]
grads:  [0.11949055]
Stock Position:  0.11949055110918323
Bond Position:  [16.67008754]


portfolio before change:  [28.85724011]
curr_Stock_Price:  101.9838852182356
curr_Factors:  [101.98388522]
mat_Sqrt:  [[0.15]]
grads:  [-0.08960165]
Stock Position:  -0.08960164742786202
Bond Position:  [37.99516423]


portfolio before change:  [28.7942208]
curr_Stock_Price:  102.71371646463714
curr_Factors:  [102.71371646]
mat_Sqrt:  [[0.15]]
grads:  [-0.00290971]
Stock Position:  -0.0029097111418229394
Bond Position:  [29.09308804]


portfolio before change:  [28.79599513]
curr_Stock_Price:  102.72885236363152
curr_Factors:  [102.72885236]
mat_Sqrt:  [[0.15]]
grads:  [-0.08326865]
Stock Position:  -0.08326865441723057
Bond Position:  [37.35008844]


portfolio before change:  [28.82005551]
curr_Stock_Price:  102.46793872941495
curr_Factors:  [102.46793873]
mat_Sqrt:  [[0.15]]
grads:  [-0.01292152]
Stock Position:  -0.012921520631025274
Bond Position:  [30.1440971]


portfolio before change:  [28.81752599]
curr_Stock_Price:  102.80950713594243
curr_Factors:  [102.80950714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090786]
Stock Position:  -0.020907859808890154
Bond Position:  [30.96705275]


portfolio before change:  [28.80640013]
curr_Stock_Price:  103.43421785931427
curr_Factors:  [103.43421786]
mat_Sqrt:  [[0.15]]
grads:  [0.06659149]
Stock Position:  0.06659148633355526
Bond Position:  [21.91856182]


portfolio before change:  [28.80664074]
curr_Stock_Price:  103.41725861447095
curr_Factors:  [103.41725861]
mat_Sqrt:  [[0.15]]
grads:  [-0.09672449]
Stock Position:  -0.09672448988926922
Bond Position:  [38.80962233]


portfolio before change:  [28.84109821]
curr_Stock_Price:  103.0860933312055
curr_Factors:  [103.08609333]
mat_Sqrt:  [[0.15]]
grads:  [0.03358595]
Stock Position:  0.03358595225728174
Bond Position:  [25.3788536]


portfolio before change:  [28.87581165]
curr_Stock_Price:  104.07243453997005
curr_Factors:  [104.07243454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321837]
Stock Position:  -0.023218365439660594
Bond Position:  [31.29220347]


portfolio before change:  [28.90105366]
curr_Stock_Price:  103.06951328083035
curr_Factors:  [103.06951328]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231417]
Stock Position:  -0.02231417154729289
Bond Position:  [31.20096446]


portfolio before change:  [28.90315215]
curr_Stock_Price:  103.06286437617895
curr_Factors:  [103.06286438]
mat_Sqrt:  [[0.15]]
grads:  [0.04730282]
Stock Position:  0.04730282018328783
Bond Position:  [24.02798801]


portfolio before change:  [28.92408865]
curr_Stock_Price:  103.47372150119452
curr_Factors:  [103.4737215]
mat_Sqrt:  [[0.15]]
grads:  [-0.13002535]
Stock Position:  -0.13002534697441898
Bond Position:  [42.37829519]


portfolio before change:  [28.93145094]
curr_Stock_Price:  103.43747036998626
curr_Factors:  [103.43747037]
mat_Sqrt:  [[0.15]]
grads:  [0.01111449]
Stock Position:  0.011114486890919276
Bond Position:  [27.78179653]


portfolio before change:  [28.93561389]
curr_Stock_Price:  103.65579170640912
curr_Factors:  [103.65579171]
mat_Sqrt:  [[0.15]]
grads:  [0.12525444]
Stock Position:  0.1252544402105883
Bond Position:  [15.95226572]


portfolio before change:  [28.91880639]
curr_Stock_Price:  103.5136447318912
curr_Factors:  [103.51364473]
mat_Sqrt:  [[0.15]]
grads:  [0.07184151]
Stock Position:  0.07184150863344096
Bond Position:  [21.48222999]


portfolio before change:  [28.88717717]
curr_Stock_Price:  103.05469136955791
curr_Factors:  [103.05469137]
mat_Sqrt:  [[0.15]]
grads:  [0.0916327]
Stock Position:  0.09163270299681082
Bond Position:  [19.44399725]


portfolio before change:  [28.92309471]
curr_Stock_Price:  103.43340162909205
curr_Factors:  [103.43340163]
mat_Sqrt:  [[0.15]]
grads:  [0.05923597]
Stock Position:  0.05923596614973943
Bond Position:  [22.79611723]


portfolio before change:  [28.87782356]
curr_Stock_Price:  102.64509771004309
curr_Factors:  [102.64509771]
mat_Sqrt:  [[0.15]]
grads:  [0.03126787]
Stock Position:  0.03126786524114874
Bond Position:  [25.66833048]


portfolio before change:  [28.89052678]
curr_Stock_Price:  103.00005944525432
curr_Factors:  [103.00005945]
mat_Sqrt:  [[0.15]]
grads:  [0.09789445]
Stock Position:  0.09789445277767261
Bond Position:  [18.80739232]


portfolio before change:  [28.77815372]
curr_Stock_Price:  101.84015143389298
curr_Factors:  [101.84015143]
mat_Sqrt:  [[0.15]]
grads:  [0.00383219]
Stock Position:  0.003832194656528719
Bond Position:  [28.38788243]


portfolio before change:  [28.77448528]
curr_Stock_Price:  100.41988448387059
curr_Factors:  [100.41988448]
mat_Sqrt:  [[0.15]]
grads:  [-0.10649719]
Stock Position:  -0.10649718770695529
Bond Position:  [39.46892056]


portfolio before change:  [28.72286248]
curr_Stock_Price:  100.927782222466
curr_Factors:  [100.92778222]
mat_Sqrt:  [[0.15]]
grads:  [-0.00406101]
Stock Position:  -0.00406101249760126
Bond Position:  [29.13273147]


portfolio before change:  [28.72338313]
curr_Stock_Price:  101.24795069107672
curr_Factors:  [101.24795069]
mat_Sqrt:  [[0.15]]
grads:  [0.00935384]
Stock Position:  0.009353838469642866
Bond Position:  [27.77632615]


portfolio before change:  [28.73904618]
curr_Stock_Price:  102.73685590157095
curr_Factors:  [102.7368559]
mat_Sqrt:  [[0.15]]
grads:  [0.02788604]
Stock Position:  0.027886036977551213
Bond Position:  [25.87412242]


portfolio before change:  [28.75748629]
curr_Stock_Price:  103.34013009036802
curr_Factors:  [103.34013009]
mat_Sqrt:  [[0.15]]
grads:  [-0.11354989]
Stock Position:  -0.11354989056963266
Bond Position:  [40.49174675]


portfolio before change:  [28.75114134]
curr_Stock_Price:  103.4182962669752
curr_Factors:  [103.41829627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281369]
Stock Position:  -0.022813691658440834
Bond Position:  [31.11049446]


portfolio before change:  [28.76346607]
curr_Stock_Price:  102.96329491062859
curr_Factors:  [102.96329491]
mat_Sqrt:  [[0.15]]
grads:  [0.08754642]
Stock Position:  0.08754642106179371
Bond Position:  [19.7493981]


portfolio before change:  [28.81171157]
curr_Stock_Price:  103.50028003631998
curr_Factors:  [103.50028004]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075457]
Stock Position:  -0.03075456893808054
Bond Position:  [31.99481807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.78918463]
Stock Price:  104.29777700115439
PL:  [24.49140763]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.15299313e-03]
 [-7.50138718e-03]
 [ 3.02101810e-03]
 [-1.20395325e-02]
 [-1.73810152e-02]
 [-1.58667678e-03]
 [-6.04031567e-03]
 [-1.09955814e-02]
 [-1.22287279e-02]
 [-5.83320058e-04]
 [ 7.17996526e-03]
 [-9.54755498e-04]
 [-2.34971966e-03]
 [ 9.70211056e-03]
 [-2.07750787e-03]
 [ 1.58203730e-02]
 [ 9.54577110e-02]
 [-1.23906738e-02]
 [ 2.31401357e-02]
 [ 9.49748900e-04]
 [-5.86535998e-03]
 [ 5.03112947e-03]
 [ 1.51737920e-02]
 [ 1.82657313e-02]
 [-2.92316333e-03]
 [ 6.67873324e-03]
 [-6.18287817e-03]
 [ 7.12499335e-03]
 [ 3.28523662e-02]
 [ 9.00280349e-04]
 [-5.60572796e-03]
 [ 1.19764823e-02]
 [ 1.26710860e-02]
 [ 8.16235250e-03]
 [ 5.96537867e-03]
 [ 9.61727220e-03]
 [-2.61514536e-02]
 [-1.36206116e-03]
 [-5.13472556e-02]
 [ 1.40571154e-02]
 [ 4.89220283e-03]
 [ 1.00212765e-02]
 [-3.88513449e-03]
 [-4.61656129e-03]
 [ 2.18413683e-02]
 [ 1.44912839e-02]
 [ 1.08353718e-02]
 [ 4.23162147e-03]
 [ 5.22617161e-03]
 [-2.17950884e-03]
 [-7.19889317e-03]
 [-2.89607751e-05]
 [ 1.55764513e-03]
 [ 5.39164378e-03]
 [-4.58040527e-03]
 [-4.00451202e-03]
 [ 9.61833232e-03]
 [ 4.18456359e-03]
 [ 7.08688119e-03]
 [-4.02955966e-03]
 [-1.43497025e-04]
 [ 3.02127151e-03]
 [-6.58075854e-03]
 [ 3.42509212e-03]
 [ 1.98088811e-02]
 [ 5.43033947e-03]
 [ 7.92192161e-03]
 [-2.84190371e-04]
 [ 2.82541516e-03]
 [ 2.18205710e-02]
 [ 2.13763148e-03]
 [-1.58932664e-02]
 [-5.69609712e-03]
 [ 1.11288245e-03]
 [ 9.00194166e-03]
 [ 1.17412298e-03]
 [-1.57236589e-03]
 [-1.08844937e-02]
 [-2.47151665e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.66069406]
curr_Stock_Price:  100.52824630762092
curr_Factors:  [100.52824631]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768662]
Stock Position:  -0.027686620886053816
Bond Position:  [16.4439815]


portfolio before change:  [13.69409471]
curr_Stock_Price:  99.35898584931289
curr_Factors:  [99.35898585]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000925]
Stock Position:  -0.05000924788391029
Bond Position:  [18.66296286]


portfolio before change:  [13.6689893]
curr_Stock_Price:  99.88432629885673
curr_Factors:  [99.8843263]
mat_Sqrt:  [[0.15]]
grads:  [0.02014012]
Stock Position:  0.02014012064070379
Bond Position:  [11.65730692]


portfolio before change:  [13.68197057]
curr_Stock_Price:  100.49269731173246
curr_Factors:  [100.49269731]
mat_Sqrt:  [[0.15]]
grads:  [-0.08026355]
Stock Position:  -0.08026355022846524
Bond Position:  [21.74787123]


portfolio before change:  [13.64622142]
curr_Stock_Price:  100.95502959287727
curr_Factors:  [100.95502959]
mat_Sqrt:  [[0.15]]
grads:  [-0.11587343]
Stock Position:  -0.11587343437671686
Bond Position:  [25.34422742]


portfolio before change:  [13.671273]
curr_Stock_Price:  100.75250252262106
curr_Factors:  [100.75250252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057785]
Stock Position:  -0.010577845198236622
Bond Position:  [14.73701737]


portfolio before change:  [13.67321246]
curr_Stock_Price:  100.65622887755767
curr_Factors:  [100.65622888]
mat_Sqrt:  [[0.15]]
grads:  [-0.04026877]
Stock Position:  -0.04026877116193289
Bond Position:  [17.7265151]


portfolio before change:  [13.68937388]
curr_Stock_Price:  100.28240364027059
curr_Factors:  [100.28240364]
mat_Sqrt:  [[0.15]]
grads:  [-0.07330388]
Stock Position:  -0.07330387625085982
Bond Position:  [21.04046279]


portfolio before change:  [13.74778284]
curr_Stock_Price:  99.50353771418753
curr_Factors:  [99.50353771]
mat_Sqrt:  [[0.15]]
grads:  [-0.08152485]
Stock Position:  -0.08152485247722707
Bond Position:  [21.85979408]


portfolio before change:  [13.69293921]
curr_Stock_Price:  100.19301958457022
curr_Factors:  [100.19301958]
mat_Sqrt:  [[0.15]]
grads:  [-0.0038888]
Stock Position:  -0.0038888003888085574
Bond Position:  [14.08256987]


portfolio before change:  [13.69307517]
curr_Stock_Price:  100.38439912723587
curr_Factors:  [100.38439913]
mat_Sqrt:  [[0.15]]
grads:  [0.04786644]
Stock Position:  0.047866435070004376
Bond Position:  [8.88803184]


portfolio before change:  [13.69534705]
curr_Stock_Price:  100.42025642987127
curr_Factors:  [100.42025643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636504]
Stock Position:  -0.006365036650417741
Bond Position:  [14.33452566]


portfolio before change:  [13.6978077]
curr_Stock_Price:  100.17442549750558
curr_Factors:  [100.1744255]
mat_Sqrt:  [[0.15]]
grads:  [-0.0156648]
Stock Position:  -0.01566479776553212
Bond Position:  [15.26701982]


portfolio before change:  [13.70019766]
curr_Stock_Price:  100.08277211495961
curr_Factors:  [100.08277211]
mat_Sqrt:  [[0.15]]
grads:  [0.06468074]
Stock Position:  0.06468073705592105
Bond Position:  [7.22677019]


portfolio before change:  [13.73734168]
curr_Stock_Price:  100.65005594451335
curr_Factors:  [100.65005594]
mat_Sqrt:  [[0.15]]
grads:  [-0.01385005]
Stock Position:  -0.01385005247107681
Bond Position:  [15.13135023]


portfolio before change:  [13.73007667]
curr_Stock_Price:  101.24288733800093
curr_Factors:  [101.24288734]
mat_Sqrt:  [[0.15]]
grads:  [0.10546915]
Stock Position:  0.1054691533666529
Bond Position:  [3.05207506]


portfolio before change:  [13.81612406]
curr_Stock_Price:  102.05693222804199
curr_Factors:  [102.05693223]
mat_Sqrt:  [[0.15]]
grads:  [0.63638474]
Stock Position:  0.6363847401407748
Bond Position:  [-51.13135024]


portfolio before change:  [13.82696455]
curr_Stock_Price:  102.07898853529942
curr_Factors:  [102.07898854]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260449]
Stock Position:  -0.08260449229040316
Bond Position:  [22.25914757]


portfolio before change:  [13.78193964]
curr_Stock_Price:  102.64089683188337
curr_Factors:  [102.64089683]
mat_Sqrt:  [[0.15]]
grads:  [0.15426757]
Stock Position:  0.1542675715379914
Bond Position:  [-2.05222226]


portfolio before change:  [13.73267886]
curr_Stock_Price:  102.32240794234508
curr_Factors:  [102.32240794]
mat_Sqrt:  [[0.15]]
grads:  [0.00633166]
Stock Position:  0.006331659334475355
Bond Position:  [13.08480823]


portfolio before change:  [13.73514634]
curr_Stock_Price:  102.5829488027115
curr_Factors:  [102.5829488]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391024]
Stock Position:  -0.039102399868685224
Bond Position:  [17.74638583]


portfolio before change:  [13.75936728]
curr_Stock_Price:  101.99189159954128
curr_Factors:  [101.9918916]
mat_Sqrt:  [[0.15]]
grads:  [0.03354086]
Stock Position:  0.03354086314355797
Bond Position:  [10.3384712]


portfolio before change:  [13.70566019]
curr_Stock_Price:  100.37138264542386
curr_Factors:  [100.37138265]
mat_Sqrt:  [[0.15]]
grads:  [0.10115861]
Stock Position:  0.1011586133898728
Bond Position:  [3.55223029]


portfolio before change:  [13.72784927]
curr_Stock_Price:  100.5885373157313
curr_Factors:  [100.58853732]
mat_Sqrt:  [[0.15]]
grads:  [0.12177154]
Stock Position:  0.12177154207925502
Bond Position:  [1.47902797]


portfolio before change:  [13.74865971]
curr_Stock_Price:  100.75867552878314
curr_Factors:  [100.75867553]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948776]
Stock Position:  -0.019487755543120506
Bond Position:  [15.71222015]


portfolio before change:  [13.74721905]
curr_Stock_Price:  100.88299501487796
curr_Factors:  [100.88299501]
mat_Sqrt:  [[0.15]]
grads:  [0.04452489]
Stock Position:  0.04452488828191334
Bond Position:  [9.25541496]


portfolio before change:  [13.74226825]
curr_Stock_Price:  100.75881106799997
curr_Factors:  [100.75881107]
mat_Sqrt:  [[0.15]]
grads:  [-0.04121919]
Stock Position:  -0.041219187832018805
Bond Position:  [17.89546461]


portfolio before change:  [13.73344135]
curr_Stock_Price:  101.00009183718193
curr_Factors:  [101.00009184]
mat_Sqrt:  [[0.15]]
grads:  [0.04749996]
Stock Position:  0.04749995568421166
Bond Position:  [8.93594147]


portfolio before change:  [13.73216127]
curr_Stock_Price:  100.96138438987519
curr_Factors:  [100.96138439]
mat_Sqrt:  [[0.15]]
grads:  [0.21901577]
Stock Position:  0.21901577433730235
Bond Position:  [-8.37997451]


portfolio before change:  [13.81607076]
curr_Stock_Price:  101.34689663395758
curr_Factors:  [101.34689663]
mat_Sqrt:  [[0.15]]
grads:  [0.00600187]
Stock Position:  0.006001868994394768
Bond Position:  [13.20779997]


portfolio before change:  [13.81573242]
curr_Stock_Price:  101.15298028676322
curr_Factors:  [101.15298029]
mat_Sqrt:  [[0.15]]
grads:  [-0.03737152]
Stock Position:  -0.037371519735360126
Bond Position:  [17.59597302]


portfolio before change:  [13.81685585]
curr_Stock_Price:  101.1523475539443
curr_Factors:  [101.15234755]
mat_Sqrt:  [[0.15]]
grads:  [0.07984322]
Stock Position:  0.07984321516103514
Bond Position:  [5.7405272]


portfolio before change:  [13.83227944]
curr_Stock_Price:  101.34102738285974
curr_Factors:  [101.34102738]
mat_Sqrt:  [[0.15]]
grads:  [0.08447391]
Stock Position:  0.08447390670284394
Bond Position:  [5.27160695]


portfolio before change:  [13.8385229]
curr_Stock_Price:  101.41103677237119
curr_Factors:  [101.41103677]
mat_Sqrt:  [[0.15]]
grads:  [0.05441568]
Stock Position:  0.05441568332478351
Bond Position:  [8.32017203]


portfolio before change:  [13.85136945]
curr_Stock_Price:  101.63756199510736
curr_Factors:  [101.637562]
mat_Sqrt:  [[0.15]]
grads:  [0.03976919]
Stock Position:  0.03976919113081404
Bond Position:  [9.80932582]


portfolio before change:  [13.8310934]
curr_Stock_Price:  101.1123022712842
curr_Factors:  [101.11230227]
mat_Sqrt:  [[0.15]]
grads:  [0.06411515]
Stock Position:  0.06411514801772766
Bond Position:  [7.34826317]


portfolio before change:  [13.88182489]
curr_Stock_Price:  101.89639492898098
curr_Factors:  [101.89639493]
mat_Sqrt:  [[0.15]]
grads:  [-0.17434302]
Stock Position:  -0.17434302419738096
Bond Position:  [31.64675054]


portfolio before change:  [13.84318682]
curr_Stock_Price:  102.12936129334874
curr_Factors:  [102.12936129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00908041]
Stock Position:  -0.009080407758046402
Bond Position:  [14.77056306]


portfolio before change:  [13.85526883]
curr_Stock_Price:  100.90047099026316
curr_Factors:  [100.90047099]
mat_Sqrt:  [[0.15]]
grads:  [-0.34231504]
Stock Position:  -0.34231503727110346
Bond Position:  [48.39501732]


portfolio before change:  [13.88725914]
curr_Stock_Price:  100.81585440668842
curr_Factors:  [100.81585441]
mat_Sqrt:  [[0.15]]
grads:  [0.0937141]
Stock Position:  0.09371410236415903
Bond Position:  [4.43939184]


portfolio before change:  [13.94533954]
curr_Stock_Price:  101.43265509127204
curr_Factors:  [101.43265509]
mat_Sqrt:  [[0.15]]
grads:  [0.03261469]
Stock Position:  0.03261468551304922
Bond Position:  [10.63714539]


portfolio before change:  [13.96451928]
curr_Stock_Price:  102.00034117785111
curr_Factors:  [102.00034118]
mat_Sqrt:  [[0.15]]
grads:  [0.06680851]
Stock Position:  0.06680851018581276
Bond Position:  [7.15002845]


portfolio before change:  [13.90309564]
curr_Stock_Price:  101.0742536387137
curr_Factors:  [101.07425364]
mat_Sqrt:  [[0.15]]
grads:  [-0.0259009]
Stock Position:  -0.025900896604222515
Bond Position:  [16.52100944]


portfolio before change:  [13.9048273]
curr_Stock_Price:  101.04726373900196
curr_Factors:  [101.04726374]
mat_Sqrt:  [[0.15]]
grads:  [-0.03077708]
Stock Position:  -0.03077707528851009
Bond Position:  [17.01476655]


portfolio before change:  [13.91784627]
curr_Stock_Price:  100.65880848344719
curr_Factors:  [100.65880848]
mat_Sqrt:  [[0.15]]
grads:  [0.14560912]
Stock Position:  0.1456091217069627
Bond Position:  [-0.73899442]


portfolio before change:  [13.93076076]
curr_Stock_Price:  100.74781852211221
curr_Factors:  [100.74781852]
mat_Sqrt:  [[0.15]]
grads:  [0.09660856]
Stock Position:  0.0966085590775215
Bond Position:  [4.19765918]


portfolio before change:  [13.86178017]
curr_Stock_Price:  100.03108132707361
curr_Factors:  [100.03108133]
mat_Sqrt:  [[0.15]]
grads:  [0.07223581]
Stock Position:  0.07223581218260026
Bond Position:  [6.63595377]


portfolio before change:  [13.85292289]
curr_Stock_Price:  99.90272334266628
curr_Factors:  [99.90272334]
mat_Sqrt:  [[0.15]]
grads:  [0.02821081]
Stock Position:  0.02821080982620662
Bond Position:  [11.03458616]


portfolio before change:  [13.83937705]
curr_Stock_Price:  99.39811105277379
curr_Factors:  [99.39811105]
mat_Sqrt:  [[0.15]]
grads:  [0.03484114]
Stock Position:  0.03484114403836599
Bond Position:  [10.37623315]


portfolio before change:  [13.83053388]
curr_Stock_Price:  99.12568287830472
curr_Factors:  [99.12568288]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453006]
Stock Position:  -0.01453005892880667
Bond Position:  [15.27083589]


portfolio before change:  [13.83297953]
curr_Stock_Price:  99.02305470394631
curr_Factors:  [99.0230547]
mat_Sqrt:  [[0.15]]
grads:  [-0.04799262]
Stock Position:  -0.0479926211086369
Bond Position:  [18.58535547]


portfolio before change:  [13.84852496]
curr_Stock_Price:  98.72334596961569
curr_Factors:  [98.72334597]
mat_Sqrt:  [[0.15]]
grads:  [-0.00019307]
Stock Position:  -0.00019307183398613084
Bond Position:  [13.86758565]


portfolio before change:  [13.84933383]
curr_Stock_Price:  99.02311352474938
curr_Factors:  [99.02311352]
mat_Sqrt:  [[0.15]]
grads:  [0.0103843]
Stock Position:  0.010384300893124643
Bond Position:  [12.82104803]


portfolio before change:  [13.85439327]
curr_Stock_Price:  99.43316455479074
curr_Factors:  [99.43316455]
mat_Sqrt:  [[0.15]]
grads:  [0.03594429]
Stock Position:  0.035944291850232964
Bond Position:  [10.28033858]


portfolio before change:  [13.8649554]
curr_Stock_Price:  99.7091357545136
curr_Factors:  [99.70913575]
mat_Sqrt:  [[0.15]]
grads:  [-0.03053604]
Stock Position:  -0.030536035136162418
Bond Position:  [16.90967707]


portfolio before change:  [13.84788557]
curr_Stock_Price:  100.30275289204756
curr_Factors:  [100.30275289]
mat_Sqrt:  [[0.15]]
grads:  [-0.02669675]
Stock Position:  -0.02669674678528168
Bond Position:  [16.52564277]


portfolio before change:  [13.83030685]
curr_Stock_Price:  100.9999016789279
curr_Factors:  [100.99990168]
mat_Sqrt:  [[0.15]]
grads:  [0.06412222]
Stock Position:  0.06412221548374707
Bond Position:  [7.35396939]


portfolio before change:  [13.75828221]
curr_Stock_Price:  99.86949352418485
curr_Factors:  [99.86949352]
mat_Sqrt:  [[0.15]]
grads:  [0.02789709]
Stock Position:  0.027897090605266534
Bond Position:  [10.9722139]


portfolio before change:  [13.76519469]
curr_Stock_Price:  100.09269564677251
curr_Factors:  [100.09269565]
mat_Sqrt:  [[0.15]]
grads:  [0.04724587]
Stock Position:  0.04724587463084142
Bond Position:  [9.03622774]


portfolio before change:  [13.75604102]
curr_Stock_Price:  99.88699618221835
curr_Factors:  [99.88699618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02686373]
Stock Position:  -0.02686373108029811
Bond Position:  [16.43937842]


portfolio before change:  [13.7631226]
curr_Stock_Price:  99.66163312510653
curr_Factors:  [99.66163313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00095665]
Stock Position:  -0.0009566468311380967
Bond Position:  [13.85846359]


portfolio before change:  [13.76424726]
curr_Stock_Price:  99.39144010066609
curr_Factors:  [99.3914401]
mat_Sqrt:  [[0.15]]
grads:  [0.02014181]
Stock Position:  0.020141810067749
Bond Position:  [11.76232376]


portfolio before change:  [13.76246945]
curr_Stock_Price:  99.26667568846155
curr_Factors:  [99.26667569]
mat_Sqrt:  [[0.15]]
grads:  [-0.04387172]
Stock Position:  -0.04387172361054125
Bond Position:  [18.11746961]


portfolio before change:  [13.78386417]
curr_Stock_Price:  98.80482146898164
curr_Factors:  [98.80482147]
mat_Sqrt:  [[0.15]]
grads:  [0.02283395]
Stock Position:  0.02283394747676858
Bond Position:  [11.52776007]


portfolio before change:  [13.79469091]
curr_Stock_Price:  99.24741820972245
curr_Factors:  [99.24741821]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [0.68815556]


portfolio before change:  [13.8405046]
curr_Stock_Price:  99.59401036416024
curr_Factors:  [99.59401036]
mat_Sqrt:  [[0.15]]
grads:  [0.03620226]
Stock Position:  0.03620226310455005
Bond Position:  [10.23497604]


portfolio before change:  [13.84050303]
curr_Stock_Price:  99.57629668322762
curr_Factors:  [99.57629668]
mat_Sqrt:  [[0.15]]
grads:  [0.05281281]
Stock Position:  0.05281281075306171
Bond Position:  [8.58159892]


portfolio before change:  [13.80237762]
curr_Stock_Price:  98.84424353934547
curr_Factors:  [98.84424354]
mat_Sqrt:  [[0.15]]
grads:  [-0.0018946]
Stock Position:  -0.0018946024728368003
Bond Position:  [13.98964817]


portfolio before change:  [13.80309477]
curr_Stock_Price:  98.92723093269916
curr_Factors:  [98.92723093]
mat_Sqrt:  [[0.15]]
grads:  [0.0188361]
Stock Position:  0.01883610108022109
Bond Position:  [11.93969145]


portfolio before change:  [13.80883073]
curr_Stock_Price:  99.19213216044291
curr_Factors:  [99.19213216]
mat_Sqrt:  [[0.15]]
grads:  [0.14547047]
Stock Position:  0.14547047349145745
Bond Position:  [-0.6206957]


portfolio before change:  [13.78938698]
curr_Stock_Price:  99.05873773307333
curr_Factors:  [99.05873773]
mat_Sqrt:  [[0.15]]
grads:  [0.01425088]
Stock Position:  0.014250876545784849
Bond Position:  [12.37771314]


portfolio before change:  [13.78660631]
curr_Stock_Price:  98.80932815798938
curr_Factors:  [98.80932816]
mat_Sqrt:  [[0.15]]
grads:  [-0.10595511]
Stock Position:  -0.1059551093104962
Bond Position:  [24.25595948]


portfolio before change:  [13.8746617]
curr_Stock_Price:  97.99257339115829
curr_Factors:  [97.99257339]
mat_Sqrt:  [[0.15]]
grads:  [-0.03797398]
Stock Position:  -0.037973980807880156
Bond Position:  [17.5958298]


portfolio before change:  [13.87467008]
curr_Stock_Price:  98.02131383802775
curr_Factors:  [98.02131384]
mat_Sqrt:  [[0.15]]
grads:  [0.00741922]
Stock Position:  0.007419216328896458
Bond Position:  [13.14742875]


portfolio before change:  [13.87166578]
curr_Stock_Price:  97.50562019855698
curr_Factors:  [97.5056202]
mat_Sqrt:  [[0.15]]
grads:  [0.06001294]
Stock Position:  0.060012944396593715
Bond Position:  [8.02006641]


portfolio before change:  [13.86429911]
curr_Stock_Price:  97.37451612199995
curr_Factors:  [97.37451612]
mat_Sqrt:  [[0.15]]
grads:  [0.00782749]
Stock Position:  0.007827486560671577
Bond Position:  [13.10210139]


portfolio before change:  [13.85900578]
curr_Stock_Price:  96.59364786607424
curr_Factors:  [96.59364787]
mat_Sqrt:  [[0.15]]
grads:  [-0.01048244]
Stock Position:  -0.01048243924974895
Bond Position:  [14.87154282]


portfolio before change:  [13.85893823]
curr_Stock_Price:  96.68876389669109
curr_Factors:  [96.6887639]
mat_Sqrt:  [[0.15]]
grads:  [-0.07256329]
Stock Position:  -0.07256329158619663
Bond Position:  [20.8749932]


portfolio before change:  [13.86847535]
curr_Stock_Price:  96.57531275026211
curr_Factors:  [96.57531275]
mat_Sqrt:  [[0.15]]
grads:  [-0.16476778]
Stock Position:  -0.16476777689544847
Bond Position:  [29.78097493]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.89288262]
Stock Price:  96.43847833914903
PL:  [13.89288262]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.80652378e-03]
 [ 9.97144722e-03]
 [ 1.75417447e-02]
 [-1.70268149e-02]
 [-1.66795604e-02]
 [-1.68888881e-03]
 [-7.99649057e-03]
 [-3.34054234e-02]
 [ 1.61325975e-02]
 [-6.15903274e-03]
 [-9.08827120e-03]
 [ 1.86750570e-02]
 [-4.29149400e-03]
 [ 5.38766045e-03]
 [-1.47483231e-03]
 [ 1.54883010e-02]
 [ 4.90681159e-02]
 [-1.46891970e-02]
 [ 1.87574221e-02]
 [ 2.49039122e-03]
 [-3.93191506e-03]
 [ 4.26959805e-03]
 [ 1.53290628e-02]
 [ 1.90798018e-02]
 [-3.25713425e-03]
 [ 6.74855918e-03]
 [ 3.69323076e-04]
 [ 1.18279965e-02]
 [ 2.69562155e-02]
 [-5.77430363e-04]
 [-5.67818108e-03]
 [ 9.99275521e-03]
 [ 1.28290566e-02]
 [ 7.61588310e-03]
 [ 5.86040673e-03]
 [ 1.32114638e-02]
 [-2.54265542e-02]
 [ 3.11833497e-03]
 [-4.01769200e-02]
 [-1.28673287e-02]
 [ 4.16590255e-03]
 [ 8.22158488e-03]
 [-3.89482085e-03]
 [-4.67822769e-03]
 [ 2.36596424e-02]
 [ 1.50359417e-02]
 [ 1.05761197e-02]
 [ 5.10149722e-03]
 [-3.53160955e-04]
 [-5.26311245e-04]
 [-5.17037922e-03]
 [ 1.60096768e-03]
 [ 7.27266749e-04]
 [ 7.27227968e-03]
 [-9.89066232e-03]
 [-4.97987733e-03]
 [-1.42695584e-03]
 [ 1.23314062e-02]
 [ 7.94865860e-03]
 [-3.25622935e-03]
 [-5.13496643e-03]
 [-2.24370740e-03]
 [-1.91956534e-03]
 [-3.12848399e-03]
 [ 1.87507128e-02]
 [ 6.79030255e-03]
 [ 2.02699044e-02]
 [-3.38070735e-03]
 [ 5.70427233e-03]
 [ 2.56868734e-02]
 [ 3.27384744e-03]
 [-1.54136374e-02]
 [-5.87450641e-03]
 [ 1.84783051e-03]
 [ 9.72133537e-03]
 [ 1.61981721e-03]
 [-1.61095782e-03]
 [-1.06950159e-02]
 [-2.29926134e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.8069007]
curr_Stock_Price:  100.12612515708112
curr_Factors:  [100.12612516]
mat_Sqrt:  [[0.15]]
grads:  [-0.05204349]
Stock Position:  -0.05204349185834693
Bond Position:  [10.01781388]


portfolio before change:  [4.81604607]
curr_Stock_Price:  99.96243048146991
curr_Factors:  [99.96243048]
mat_Sqrt:  [[0.15]]
grads:  [0.06647631]
Stock Position:  0.06647631482421368
Bond Position:  [-1.82908793]


portfolio before change:  [4.84992636]
curr_Stock_Price:  100.47380979878578
curr_Factors:  [100.4738098]
mat_Sqrt:  [[0.15]]
grads:  [0.11694496]
Stock Position:  0.11694496473382893
Bond Position:  [-6.89997978]


portfolio before change:  [4.8775235]
curr_Stock_Price:  100.71348149421017
curr_Factors:  [100.71348149]
mat_Sqrt:  [[0.15]]
grads:  [-0.1135121]
Stock Position:  -0.1135120990542924
Bond Position:  [16.30972219]


portfolio before change:  [4.85306394]
curr_Stock_Price:  100.93794166490564
curr_Factors:  [100.93794166]
mat_Sqrt:  [[0.15]]
grads:  [-0.11119707]
Stock Position:  -0.11119706957278616
Bond Position:  [16.07706726]


portfolio before change:  [4.88120546]
curr_Stock_Price:  100.69390045693412
curr_Factors:  [100.69390046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01125926]
Stock Position:  -0.011259258760958676
Bond Position:  [6.01494414]


portfolio before change:  [4.87639327]
curr_Stock_Price:  101.15468862991214
curr_Factors:  [101.15468863]
mat_Sqrt:  [[0.15]]
grads:  [-0.05330994]
Stock Position:  -0.053309937122498555
Bond Position:  [10.26894336]


portfolio before change:  [4.86783008]
curr_Stock_Price:  101.32735850065724
curr_Factors:  [101.3273585]
mat_Sqrt:  [[0.15]]
grads:  [-0.22270282]
Stock Position:  -0.22270282247944775
Bond Position:  [27.43371881]


portfolio before change:  [4.80513299]
curr_Stock_Price:  101.61658587904657
curr_Factors:  [101.61658588]
mat_Sqrt:  [[0.15]]
grads:  [0.10755065]
Stock Position:  0.10755064975341011
Bond Position:  [-6.12379685]


portfolio before change:  [4.81881562]
curr_Stock_Price:  101.74736502620453
curr_Factors:  [101.74736503]
mat_Sqrt:  [[0.15]]
grads:  [-0.04106022]
Stock Position:  -0.04106021825888598
Bond Position:  [8.99658464]


portfolio before change:  [4.82943864]
curr_Stock_Price:  101.50234146377895
curr_Factors:  [101.50234146]
mat_Sqrt:  [[0.15]]
grads:  [-0.06058847]
Stock Position:  -0.060588474666880825
Bond Position:  [10.97931069]


portfolio before change:  [4.78476758]
curr_Stock_Price:  102.25095405889974
curr_Factors:  [102.25095406]
mat_Sqrt:  [[0.15]]
grads:  [0.12450038]
Stock Position:  0.12450037986963143
Bond Position:  [-7.94551504]


portfolio before change:  [4.79069845]
curr_Stock_Price:  102.30258023988809
curr_Factors:  [102.30258024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02860996]
Stock Position:  -0.02860996002507123
Bond Position:  [7.71757118]


portfolio before change:  [4.81806216]
curr_Stock_Price:  101.36299997298323
curr_Factors:  [101.36299997]
mat_Sqrt:  [[0.15]]
grads:  [0.03591774]
Stock Position:  0.03591773635098171
Bond Position:  [1.17733266]


portfolio before change:  [4.80136195]
curr_Stock_Price:  100.89599401438254
curr_Factors:  [100.89599401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00983222]
Stock Position:  -0.00983221543157109
Bond Position:  [5.7933931]


portfolio before change:  [4.80343477]
curr_Stock_Price:  100.72200269205663
curr_Factors:  [100.72200269]
mat_Sqrt:  [[0.15]]
grads:  [0.10325534]
Stock Position:  0.10325533999647146
Bond Position:  [-5.59664986]


portfolio before change:  [4.80671124]
curr_Stock_Price:  100.75712217870537
curr_Factors:  [100.75712218]
mat_Sqrt:  [[0.15]]
grads:  [0.32712077]
Stock Position:  0.32712077284383306
Bond Position:  [-28.15303643]


portfolio before change:  [4.68318907]
curr_Stock_Price:  100.3848970877228
curr_Factors:  [100.38489709]
mat_Sqrt:  [[0.15]]
grads:  [-0.09792798]
Stock Position:  -0.09792797988502269
Bond Position:  [14.51367925]


portfolio before change:  [4.67060525]
curr_Stock_Price:  100.52266108078224
curr_Factors:  [100.52266108]
mat_Sqrt:  [[0.15]]
grads:  [0.12504948]
Stock Position:  0.12504948088061793
Bond Position:  [-7.89970134]


portfolio before change:  [4.64510746]
curr_Stock_Price:  100.3227079154853
curr_Factors:  [100.32270792]
mat_Sqrt:  [[0.15]]
grads:  [0.01660261]
Stock Position:  0.01660260811034201
Bond Position:  [2.97948886]


portfolio before change:  [4.65476656]
curr_Stock_Price:  100.8932730891577
curr_Factors:  [100.89327309]
mat_Sqrt:  [[0.15]]
grads:  [-0.02621277]
Stock Position:  -0.02621276709510935
Bond Position:  [7.29945843]


portfolio before change:  [4.66089854]
curr_Stock_Price:  100.67674671175739
curr_Factors:  [100.67674671]
mat_Sqrt:  [[0.15]]
grads:  [0.02846399]
Stock Position:  0.028463987030505827
Bond Position:  [1.79523693]


portfolio before change:  [4.65812083]
curr_Stock_Price:  100.57521772950048
curr_Factors:  [100.57521773]
mat_Sqrt:  [[0.15]]
grads:  [0.10219375]
Stock Position:  0.10219375183982948
Bond Position:  [-5.62003801]


portfolio before change:  [4.67399234]
curr_Stock_Price:  100.73396303514171
curr_Factors:  [100.73396304]
mat_Sqrt:  [[0.15]]
grads:  [0.12719868]
Stock Position:  0.12719867891270395
Bond Position:  [-8.13923468]


portfolio before change:  [4.66183268]
curr_Stock_Price:  100.64236657830659
curr_Factors:  [100.64236658]
mat_Sqrt:  [[0.15]]
grads:  [-0.02171423]
Stock Position:  -0.02171422835589361
Bond Position:  [6.84720401]


portfolio before change:  [4.65557231]
curr_Stock_Price:  100.95038278117504
curr_Factors:  [100.95038278]
mat_Sqrt:  [[0.15]]
grads:  [0.04499039]
Stock Position:  0.04499039455702121
Bond Position:  [0.11377475]


portfolio before change:  [4.69784771]
curr_Stock_Price:  101.889878693935
curr_Factors:  [101.88987869]
mat_Sqrt:  [[0.15]]
grads:  [0.00246215]
Stock Position:  0.0024621538429521242
Bond Position:  [4.44697915]


portfolio before change:  [4.6972686]
curr_Stock_Price:  101.54178936313913
curr_Factors:  [101.54178936]
mat_Sqrt:  [[0.15]]
grads:  [0.07885331]
Stock Position:  0.07885330975923907
Bond Position:  [-3.30963757]


portfolio before change:  [4.74161583]
curr_Stock_Price:  102.10681423440955
curr_Factors:  [102.10681423]
mat_Sqrt:  [[0.15]]
grads:  [0.1797081]
Stock Position:  0.17970810300576162
Bond Position:  [-13.60780606]


portfolio before change:  [4.63494829]
curr_Stock_Price:  101.51798700654642
curr_Factors:  [101.51798701]
mat_Sqrt:  [[0.15]]
grads:  [-0.00384954]
Stock Position:  -0.003849535750046924
Bond Position:  [5.02574541]


portfolio before change:  [4.63708337]
curr_Stock_Price:  101.04495371501895
curr_Factors:  [101.04495372]
mat_Sqrt:  [[0.15]]
grads:  [-0.03785454]
Stock Position:  -0.03785454055813033
Bond Position:  [8.46209366]


portfolio before change:  [4.64822101]
curr_Stock_Price:  100.76470342982498
curr_Factors:  [100.76470343]
mat_Sqrt:  [[0.15]]
grads:  [0.06661837]
Stock Position:  0.06661836803601594
Bond Position:  [-2.06455909]


portfolio before change:  [4.70317762]
curr_Stock_Price:  101.5915871951652
curr_Factors:  [101.5915872]
mat_Sqrt:  [[0.15]]
grads:  [0.08552704]
Stock Position:  0.08552704368818077
Bond Position:  [-3.9856505]


portfolio before change:  [4.70092385]
curr_Stock_Price:  101.56814837394892
curr_Factors:  [101.56814837]
mat_Sqrt:  [[0.15]]
grads:  [0.05077255]
Stock Position:  0.05077255403218862
Bond Position:  [-0.45595045]


portfolio before change:  [4.70050614]
curr_Stock_Price:  101.5604825470217
curr_Factors:  [101.56048255]
mat_Sqrt:  [[0.15]]
grads:  [0.03906938]
Stock Position:  0.03906937818832314
Bond Position:  [0.73260124]


portfolio before change:  [4.72528993]
curr_Stock_Price:  102.19366377631319
curr_Factors:  [102.19366378]
mat_Sqrt:  [[0.15]]
grads:  [0.08807643]
Stock Position:  0.08807642526089086
Bond Position:  [-4.27556266]


portfolio before change:  [4.70726975]
curr_Stock_Price:  101.99210080533757
curr_Factors:  [101.99210081]
mat_Sqrt:  [[0.15]]
grads:  [-0.16951036]
Stock Position:  -0.16951036104654724
Bond Position:  [21.99598758]


portfolio before change:  [4.86378578]
curr_Stock_Price:  101.07686924614
curr_Factors:  [101.07686925]
mat_Sqrt:  [[0.15]]
grads:  [0.0207889]
Stock Position:  0.020788899823783593
Bond Position:  [2.76250887]


portfolio before change:  [4.87709353]
curr_Stock_Price:  101.70870142292935
curr_Factors:  [101.70870142]
mat_Sqrt:  [[0.15]]
grads:  [-0.26784613]
Stock Position:  -0.2678461336235163
Bond Position:  [32.11937597]


portfolio before change:  [4.75278391]
curr_Stock_Price:  102.18030483790213
curr_Factors:  [102.18030484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08578219]
Stock Position:  -0.08578219138380132
Bond Position:  [13.51803437]


portfolio before change:  [4.76612153]
curr_Stock_Price:  102.03467184027842
curr_Factors:  [102.03467184]
mat_Sqrt:  [[0.15]]
grads:  [0.02777268]
Stock Position:  0.02777268364829867
Bond Position:  [1.93234486]


portfolio before change:  [4.7448287]
curr_Stock_Price:  101.26364064723096
curr_Factors:  [101.26364065]
mat_Sqrt:  [[0.15]]
grads:  [0.05481057]
Stock Position:  0.05481056589683009
Bond Position:  [-0.80548875]


portfolio before change:  [4.73517901]
curr_Stock_Price:  101.08850389211655
curr_Factors:  [101.08850389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596547]
Stock Position:  -0.025965472313782226
Bond Position:  [7.35998976]


portfolio before change:  [4.73811359]
curr_Stock_Price:  100.99320158035009
curr_Factors:  [100.99320158]
mat_Sqrt:  [[0.15]]
grads:  [-0.03118818]
Stock Position:  -0.03118818462896568
Bond Position:  [7.88790821]


portfolio before change:  [4.76132788]
curr_Stock_Price:  100.26467946697795
curr_Factors:  [100.26467947]
mat_Sqrt:  [[0.15]]
grads:  [0.15773095]
Stock Position:  0.15773094922976685
Bond Position:  [-11.05351518]


portfolio before change:  [4.60202392]
curr_Stock_Price:  99.25908673407794
curr_Factors:  [99.25908673]
mat_Sqrt:  [[0.15]]
grads:  [0.10023961]
Stock Position:  0.10023961162812646
Bond Position:  [-5.34766838]


portfolio before change:  [4.53881095]
curr_Stock_Price:  98.63180251523718
curr_Factors:  [98.63180252]
mat_Sqrt:  [[0.15]]
grads:  [0.07050746]
Stock Position:  0.0705074647798549
Bond Position:  [-2.41546739]


portfolio before change:  [4.53503383]
curr_Stock_Price:  98.58037318424843
curr_Factors:  [98.58037318]
mat_Sqrt:  [[0.15]]
grads:  [0.03400998]
Stock Position:  0.034009981477811715
Bond Position:  [1.18231716]


portfolio before change:  [4.53571554]
curr_Stock_Price:  98.59824491103589
curr_Factors:  [98.59824491]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235441]
Stock Position:  -0.0023544063693818388
Bond Position:  [4.76785588]


portfolio before change:  [4.53840916]
curr_Stock_Price:  97.5807408918401
curr_Factors:  [97.58074089]
mat_Sqrt:  [[0.15]]
grads:  [-0.00350874]
Stock Position:  -0.0035087416364492606
Bond Position:  [4.88079477]


portfolio before change:  [4.53857092]
curr_Stock_Price:  97.62158180014399
curr_Factors:  [97.6215818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03446919]
Stock Position:  -0.034469194831998944
Bond Position:  [7.90350825]


portfolio before change:  [4.53226097]
curr_Stock_Price:  97.81897374170305
curr_Factors:  [97.81897374]
mat_Sqrt:  [[0.15]]
grads:  [0.01067312]
Stock Position:  0.010673117851782016
Bond Position:  [3.48822753]


portfolio before change:  [4.52771311]
curr_Stock_Price:  97.37244306057575
curr_Factors:  [97.37244306]
mat_Sqrt:  [[0.15]]
grads:  [0.00484844]
Stock Position:  0.004848444991941001
Bond Position:  [4.05560818]


portfolio before change:  [4.52657829]
curr_Stock_Price:  97.08610204499062
curr_Factors:  [97.08610204]
mat_Sqrt:  [[0.15]]
grads:  [0.04848186]
Stock Position:  0.048481864500818005
Bond Position:  [-0.18033696]


portfolio before change:  [4.51882949]
curr_Stock_Price:  96.92650568470675
curr_Factors:  [96.92650568]
mat_Sqrt:  [[0.15]]
grads:  [-0.06593775]
Stock Position:  -0.06593774878515649
Bond Position:  [10.90994507]


portfolio before change:  [4.57026818]
curr_Stock_Price:  96.15673720992142
curr_Factors:  [96.15673721]
mat_Sqrt:  [[0.15]]
grads:  [-0.03319918]
Stock Position:  -0.03319918222187542
Bond Position:  [7.76259322]


portfolio before change:  [4.56903473]
curr_Stock_Price:  96.20850445723177
curr_Factors:  [96.20850446]
mat_Sqrt:  [[0.15]]
grads:  [-0.00951304]
Stock Position:  -0.009513038932728287
Bond Position:  [5.48426998]


portfolio before change:  [4.56000406]
curr_Stock_Price:  97.19383050176378
curr_Factors:  [97.1938305]
mat_Sqrt:  [[0.15]]
grads:  [0.08220937]
Stock Position:  0.08220937472566418
Bond Position:  [-3.43023997]


portfolio before change:  [4.54183098]
curr_Stock_Price:  96.97538000105578
curr_Factors:  [96.97538]
mat_Sqrt:  [[0.15]]
grads:  [0.05299106]
Stock Position:  0.052991057362132554
Bond Position:  [-0.59699694]


portfolio before change:  [4.53537201]
curr_Stock_Price:  96.85419621167986
curr_Factors:  [96.85419621]
mat_Sqrt:  [[0.15]]
grads:  [-0.0217082]
Stock Position:  -0.021708195690702144
Bond Position:  [6.63790186]


portfolio before change:  [4.54556557]
curr_Stock_Price:  96.40373610567765
curr_Factors:  [96.40373611]
mat_Sqrt:  [[0.15]]
grads:  [-0.03423311]
Stock Position:  -0.03423310955156474
Bond Position:  [7.84576523]


portfolio before change:  [4.57022879]
curr_Stock_Price:  95.69761151896803
curr_Factors:  [95.69761152]
mat_Sqrt:  [[0.15]]
grads:  [-0.01495805]
Stock Position:  -0.014958049326210804
Bond Position:  [6.00167838]


portfolio before change:  [4.56946879]
curr_Stock_Price:  95.77349767282863
curr_Factors:  [95.77349767]
mat_Sqrt:  [[0.15]]
grads:  [-0.0127971]
Stock Position:  -0.01279710226878214
Bond Position:  [5.79509204]


portfolio before change:  [4.56409493]
curr_Stock_Price:  96.2217292095041
curr_Factors:  [96.22172921]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085656]
Stock Position:  -0.020856559963252582
Bond Position:  [6.5709492]


portfolio before change:  [4.5642904]
curr_Stock_Price:  96.23204895344503
curr_Factors:  [96.23204895]
mat_Sqrt:  [[0.15]]
grads:  [0.12500475]
Stock Position:  0.1250047518086282
Bond Position:  [-7.465173]


portfolio before change:  [4.42121197]
curr_Stock_Price:  95.09119759666069
curr_Factors:  [95.0911976]
mat_Sqrt:  [[0.15]]
grads:  [0.04526868]
Stock Position:  0.045268683666259184
Bond Position:  [0.11655862]


portfolio before change:  [4.43741012]
curr_Stock_Price:  95.44885912909506
curr_Factors:  [95.44885913]
mat_Sqrt:  [[0.15]]
grads:  [0.1351327]
Stock Position:  0.13513269632107622
Bond Position:  [-8.46085157]


portfolio before change:  [4.44585735]
curr_Stock_Price:  95.51528313021831
curr_Factors:  [95.51528313]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253805]
Stock Position:  -0.02253804896976179
Bond Position:  [6.59858548]


portfolio before change:  [4.43250066]
curr_Stock_Price:  96.12621065221644
curr_Factors:  [96.12621065]
mat_Sqrt:  [[0.15]]
grads:  [0.03802848]
Stock Position:  0.03802848220997696
Bond Position:  [0.77696677]


portfolio before change:  [4.42318939]
curr_Stock_Price:  95.8800837099807
curr_Factors:  [95.88008371]
mat_Sqrt:  [[0.15]]
grads:  [0.17124582]
Stock Position:  0.17124582285260076
Bond Position:  [-11.99587444]


portfolio before change:  [4.48020982]
curr_Stock_Price:  96.21743615041932
curr_Factors:  [96.21743615]
mat_Sqrt:  [[0.15]]
grads:  [0.02182565]
Stock Position:  0.02182564958918994
Bond Position:  [2.38020178]


portfolio before change:  [4.48637729]
curr_Stock_Price:  96.4931986778525
curr_Factors:  [96.49319868]
mat_Sqrt:  [[0.15]]
grads:  [-0.10275758]
Stock Position:  -0.10275758281604938
Bond Position:  [14.40178514]


portfolio before change:  [4.52137213]
curr_Stock_Price:  96.16140126612122
curr_Factors:  [96.16140127]
mat_Sqrt:  [[0.15]]
grads:  [-0.03916338]
Stock Position:  -0.039163376094119066
Bond Position:  [8.28737725]


portfolio before change:  [4.50517049]
curr_Stock_Price:  96.58832087769804
curr_Factors:  [96.58832088]
mat_Sqrt:  [[0.15]]
grads:  [0.01231887]
Stock Position:  0.012318870097051232
Bond Position:  [3.31531151]


portfolio before change:  [4.50800567]
curr_Stock_Price:  96.80164950368781
curr_Factors:  [96.8016495]
mat_Sqrt:  [[0.15]]
grads:  [0.0648089]
Stock Position:  0.0648089024506635
Bond Position:  [-1.76560299]


portfolio before change:  [4.52681788]
curr_Stock_Price:  97.09362429846794
curr_Factors:  [97.0936243]
mat_Sqrt:  [[0.15]]
grads:  [0.01079878]
Stock Position:  0.010798781386912409
Bond Position:  [3.47832506]


portfolio before change:  [4.52655339]
curr_Stock_Price:  97.04899923762522
curr_Factors:  [97.04899924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073972]
Stock Position:  -0.01073971882731606
Bond Position:  [5.56883235]


portfolio before change:  [4.53042786]
curr_Stock_Price:  96.72064703323692
curr_Factors:  [96.72064703]
mat_Sqrt:  [[0.15]]
grads:  [-0.07130011]
Stock Position:  -0.07130010586173725
Bond Position:  [11.42662024]


portfolio before change:  [4.48017565]
curr_Stock_Price:  97.4354622979494
curr_Factors:  [97.4354623]
mat_Sqrt:  [[0.15]]
grads:  [-0.15328409]
Stock Position:  -0.153284089555442
Bond Position:  [19.41548177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.32533209]
Stock Price:  98.45355267994647
PL:  [4.32533209]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.89928718e-03]
 [ 3.13647571e-03]
 [ 2.64352359e-03]
 [-1.18435100e-02]
 [ 1.23839741e-02]
 [-1.19320712e-02]
 [-2.01576504e-04]
 [-8.68364947e-03]
 [-1.23575761e-03]
 [-1.86197744e-03]
 [ 1.44952637e-02]
 [-3.66334976e-03]
 [-1.18721681e-03]
 [ 6.60284510e-03]
 [ 4.59954884e-04]
 [ 1.02023491e-02]
 [-1.03823471e-03]
 [-1.32349215e-02]
 [ 2.49731769e-02]
 [-8.40364952e-04]
 [-8.22802139e-03]
 [ 5.42380993e-03]
 [ 1.70633433e-02]
 [ 1.96233835e-02]
 [-1.18639960e-03]
 [ 4.42027307e-03]
 [ 5.26264064e-03]
 [ 8.76544386e-03]
 [ 4.23633229e-03]
 [ 4.30950943e-02]
 [-6.96862578e-03]
 [ 2.14374364e-02]
 [ 1.26556416e-02]
 [-1.98080721e-02]
 [-1.31205710e-02]
 [-2.14138535e-02]
 [ 7.64795166e-03]
 [-9.98832853e-04]
 [ 9.90156274e-03]
 [-1.41842884e-02]
 [ 6.96911813e-03]
 [ 3.55790323e-02]
 [-3.37456352e-03]
 [ 1.85496275e-02]
 [-5.80725402e-02]
 [ 2.25234757e-02]
 [ 9.61659255e-03]
 [ 5.38545212e-03]
 [-9.60159592e-03]
 [ 2.82183660e-04]
 [ 4.19770316e-04]
 [-4.15642769e-03]
 [-1.56172456e-03]
 [ 7.92438491e-04]
 [-1.91282551e-02]
 [-5.62346007e-03]
 [-5.08413861e-03]
 [ 1.42992886e-02]
 [ 6.25064616e-03]
 [-2.43055681e-03]
 [-5.11971810e-03]
 [-1.70047781e-03]
 [-3.18829530e-03]
 [-2.98111258e-03]
 [ 1.80865901e-02]
 [ 6.36928477e-03]
 [ 1.79919681e-02]
 [-3.45980568e-03]
 [ 6.33364077e-03]
 [ 2.67854456e-02]
 [ 3.09967938e-03]
 [-1.51684670e-02]
 [-5.72331517e-03]
 [ 2.60222903e-03]
 [ 1.07730376e-02]
 [ 5.16891334e-03]
 [ 1.73525629e-03]
 [-2.35495584e-02]
 [-3.27594599e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.56964214]
curr_Stock_Price:  100.20618526091934
curr_Factors:  [100.20618526]
mat_Sqrt:  [[0.15]]
grads:  [-0.03266191]
Stock Position:  -0.03266191455199187
Bond Position:  [9.842568]


portfolio before change:  [6.58689098]
curr_Stock_Price:  99.69691725618382
curr_Factors:  [99.69691726]
mat_Sqrt:  [[0.15]]
grads:  [0.02090984]
Stock Position:  0.0209098380460643
Bond Position:  [4.50224459]


portfolio before change:  [6.59179782]
curr_Stock_Price:  99.9181258044803
curr_Factors:  [99.9181258]
mat_Sqrt:  [[0.15]]
grads:  [0.01762349]
Stock Position:  0.017623490611018283
Bond Position:  [4.83089167]


portfolio before change:  [6.57378454]
curr_Stock_Price:  98.87887526381972
curr_Factors:  [98.87887526]
mat_Sqrt:  [[0.15]]
grads:  [-0.07895673]
Stock Position:  -0.07895673313878727
Bond Position:  [14.3809375]


portfolio before change:  [6.54399839]
curr_Stock_Price:  99.26750556790599
curr_Factors:  [99.26750557]
mat_Sqrt:  [[0.15]]
grads:  [0.08255983]
Stock Position:  0.0825598273330226
Bond Position:  [-1.65150973]


portfolio before change:  [6.55907829]
curr_Stock_Price:  99.45140997276485
curr_Factors:  [99.45140997]
mat_Sqrt:  [[0.15]]
grads:  [-0.07954714]
Stock Position:  -0.07954714110832406
Bond Position:  [14.47015363]


portfolio before change:  [6.49458793]
curr_Stock_Price:  100.27349815615956
curr_Factors:  [100.27349816]
mat_Sqrt:  [[0.15]]
grads:  [-0.00134384]
Stock Position:  -0.001343843358912744
Bond Position:  [6.62933981]


portfolio before change:  [6.49521761]
curr_Stock_Price:  100.11326748395143
curr_Factors:  [100.11326748]
mat_Sqrt:  [[0.15]]
grads:  [-0.057891]
Stock Position:  -0.057890996456867634
Bond Position:  [12.29087442]


portfolio before change:  [6.48880299]
curr_Stock_Price:  100.23734230785706
curr_Factors:  [100.23734231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00823838]
Stock Position:  -0.008238384088780129
Bond Position:  [7.31459672]


portfolio before change:  [6.49101692]
curr_Stock_Price:  100.0241023190318
curr_Factors:  [100.02410232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01241318]
Stock Position:  -0.012413182952640128
Bond Position:  [7.73263441]


portfolio before change:  [6.492912]
curr_Stock_Price:  99.91037086664257
curr_Factors:  [99.91037087]
mat_Sqrt:  [[0.15]]
grads:  [0.09663509]
Stock Position:  0.0966350916643151
Bond Position:  [-3.16193585]


portfolio before change:  [6.48598663]
curr_Stock_Price:  99.84075078582968
curr_Factors:  [99.84075079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02442233]
Stock Position:  -0.024422331718333322
Bond Position:  [8.92433056]


portfolio before change:  [6.49138315]
curr_Stock_Price:  99.64262341083692
curr_Factors:  [99.64262341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00791478]
Stock Position:  -0.00791477871339586
Bond Position:  [7.28003246]


portfolio before change:  [6.49387198]
curr_Stock_Price:  99.38565981895938
curr_Factors:  [99.38565982]
mat_Sqrt:  [[0.15]]
grads:  [0.04401897]
Stock Position:  0.04401896730810657
Bond Position:  [2.11901786]


portfolio before change:  [6.50713233]
curr_Stock_Price:  99.68389297670579
curr_Factors:  [99.68389298]
mat_Sqrt:  [[0.15]]
grads:  [0.00306637]
Stock Position:  0.003066365890503885
Bond Position:  [6.20146504]


portfolio before change:  [6.50559229]
curr_Stock_Price:  99.05525232709084
curr_Factors:  [99.05525233]
mat_Sqrt:  [[0.15]]
grads:  [0.06801566]
Stock Position:  0.06801566067912053
Bond Position:  [-0.23171614]


portfolio before change:  [6.46646293]
curr_Stock_Price:  98.48016596271763
curr_Factors:  [98.48016596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692156]
Stock Position:  -0.006921564764403634
Bond Position:  [7.14809978]


portfolio before change:  [6.46748141]
curr_Stock_Price:  98.39756827833355
curr_Factors:  [98.39756828]
mat_Sqrt:  [[0.15]]
grads:  [-0.08823281]
Stock Position:  -0.08823280988643774
Bond Position:  [15.14937534]


portfolio before change:  [6.46651674]
curr_Stock_Price:  98.4192328988132
curr_Factors:  [98.4192329]
mat_Sqrt:  [[0.15]]
grads:  [0.16648785]
Stock Position:  0.16648784573471215
Bond Position:  [-9.91908932]


portfolio before change:  [6.46636699]
curr_Stock_Price:  98.42205720944602
curr_Factors:  [98.42205721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00560243]
Stock Position:  -0.005602433016097974
Bond Position:  [7.01776998]


portfolio before change:  [6.46777875]
curr_Stock_Price:  98.24835904344377
curr_Factors:  [98.24835904]
mat_Sqrt:  [[0.15]]
grads:  [-0.05485348]
Stock Position:  -0.054853475919760246
Bond Position:  [11.85704275]


portfolio before change:  [6.44834298]
curr_Stock_Price:  98.61619103650978
curr_Factors:  [98.61619104]
mat_Sqrt:  [[0.15]]
grads:  [0.03615873]
Stock Position:  0.03615873283484377
Bond Position:  [2.88250647]


portfolio before change:  [6.45340446]
curr_Stock_Price:  98.75118811742733
curr_Factors:  [98.75118812]
mat_Sqrt:  [[0.15]]
grads:  [0.11375562]
Stock Position:  0.11375562204437492
Bond Position:  [-4.78009837]


portfolio before change:  [6.40248805]
curr_Stock_Price:  98.30621984232916
curr_Factors:  [98.30621984]
mat_Sqrt:  [[0.15]]
grads:  [0.13082256]
Stock Position:  0.130822556421367
Bond Position:  [-6.45818294]


portfolio before change:  [6.35355391]
curr_Stock_Price:  97.93525559906176
curr_Factors:  [97.9352556]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790933]
Stock Position:  -0.00790933069550601
Bond Position:  [7.12815624]


portfolio before change:  [6.35451241]
curr_Stock_Price:  97.87039949059286
curr_Factors:  [97.87039949]
mat_Sqrt:  [[0.15]]
grads:  [0.02946849]
Stock Position:  0.0294684871615637
Bond Position:  [3.4704198]


portfolio before change:  [6.35887146]
curr_Stock_Price:  98.0109614283577
curr_Factors:  [98.01096143]
mat_Sqrt:  [[0.15]]
grads:  [0.03508427]
Stock Position:  0.03508427090471206
Bond Position:  [2.92022834]


portfolio before change:  [6.37070655]
curr_Stock_Price:  98.34309213760305
curr_Factors:  [98.34309214]
mat_Sqrt:  [[0.15]]
grads:  [0.05843629]
Stock Position:  0.05843629239426547
Bond Position:  [0.62390086]


portfolio before change:  [6.28390236]
curr_Stock_Price:  96.85697485411684
curr_Factors:  [96.85697485]
mat_Sqrt:  [[0.15]]
grads:  [0.02824222]
Stock Position:  0.028242215261113184
Bond Position:  [3.54844682]


portfolio before change:  [6.28157017]
curr_Stock_Price:  96.76654399903623
curr_Factors:  [96.766544]
mat_Sqrt:  [[0.15]]
grads:  [0.28730063]
Stock Position:  0.287300628893728
Bond Position:  [-21.51951877]


portfolio before change:  [6.34825383]
curr_Stock_Price:  97.00332964455727
curr_Factors:  [97.00332964]
mat_Sqrt:  [[0.15]]
grads:  [-0.04645751]
Stock Position:  -0.046457505205810164
Bond Position:  [10.85478652]


portfolio before change:  [6.37166979]
curr_Stock_Price:  96.51390355842018
curr_Factors:  [96.51390356]
mat_Sqrt:  [[0.15]]
grads:  [0.14291624]
Stock Position:  0.14291624269195063
Bond Position:  [-7.42173468]


portfolio before change:  [6.34303439]
curr_Stock_Price:  96.31678446602872
curr_Factors:  [96.31678447]
mat_Sqrt:  [[0.15]]
grads:  [0.08437094]
Stock Position:  0.08437094421843756
Bond Position:  [-1.78330366]


portfolio before change:  [6.36485406]
curr_Stock_Price:  96.57672138694132
curr_Factors:  [96.57672139]
mat_Sqrt:  [[0.15]]
grads:  [-0.13205381]
Stock Position:  -0.13205381413978984
Bond Position:  [19.11817847]


portfolio before change:  [6.41666957]
curr_Stock_Price:  96.19338836084157
curr_Factors:  [96.19338836]
mat_Sqrt:  [[0.15]]
grads:  [-0.08747047]
Stock Position:  -0.0874704736131649
Bond Position:  [14.83075081]


portfolio before change:  [6.41791283]
curr_Stock_Price:  96.18977213573797
curr_Factors:  [96.18977214]
mat_Sqrt:  [[0.15]]
grads:  [-0.14275902]
Stock Position:  -0.14275902301941654
Bond Position:  [20.14987073]


portfolio before change:  [6.30761254]
curr_Stock_Price:  96.97122678738613
curr_Factors:  [96.97122679]
mat_Sqrt:  [[0.15]]
grads:  [0.05098634]
Stock Position:  0.05098634437972864
Bond Position:  [1.36340417]


portfolio before change:  [6.31529262]
curr_Stock_Price:  97.12018559753209
curr_Factors:  [97.1201856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00665889]
Stock Position:  -0.0066588856883976425
Bond Position:  [6.96200483]


portfolio before change:  [6.320488]
curr_Stock_Price:  96.40531397603661
curr_Factors:  [96.40531398]
mat_Sqrt:  [[0.15]]
grads:  [0.06601042]
Stock Position:  0.06601041828790878
Bond Position:  [-0.0432671]


portfolio before change:  [6.37687371]
curr_Stock_Price:  97.25954900498866
curr_Factors:  [97.259549]
mat_Sqrt:  [[0.15]]
grads:  [-0.09456192]
Stock Position:  -0.09456192240705456
Bond Position:  [15.57392364]


portfolio before change:  [6.45735466]
curr_Stock_Price:  96.41875020511597
curr_Factors:  [96.41875021]
mat_Sqrt:  [[0.15]]
grads:  [0.04646079]
Stock Position:  0.04646078754826036
Bond Position:  [1.97766359]


portfolio before change:  [6.39683983]
curr_Stock_Price:  95.11359711649921
curr_Factors:  [95.11359712]
mat_Sqrt:  [[0.15]]
grads:  [0.23719355]
Stock Position:  0.23719354871093318
Bond Position:  [-16.1634918]


portfolio before change:  [6.38604005]
curr_Stock_Price:  95.072324782786
curr_Factors:  [95.07232478]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249709]
Stock Position:  -0.022497090135736447
Bond Position:  [8.52489071]


portfolio before change:  [6.37509431]
curr_Stock_Price:  95.58254889172095
curr_Factors:  [95.58254889]
mat_Sqrt:  [[0.15]]
grads:  [0.12366418]
Stock Position:  0.12366418320101691
Bond Position:  [-5.44504352]


portfolio before change:  [6.3196168]
curr_Stock_Price:  95.13668662581782
curr_Factors:  [95.13668663]
mat_Sqrt:  [[0.15]]
grads:  [-0.38715027]
Stock Position:  -0.3871502682897953
Bond Position:  [43.15181055]


portfolio before change:  [6.15484144]
curr_Stock_Price:  95.56926394943739
curr_Factors:  [95.56926395]
mat_Sqrt:  [[0.15]]
grads:  [0.1501565]
Stock Position:  0.15015650480481713
Bond Position:  [-8.1955052]


portfolio before change:  [6.28309438]
curr_Stock_Price:  96.4268037278777
curr_Factors:  [96.42680373]
mat_Sqrt:  [[0.15]]
grads:  [0.06411062]
Stock Position:  0.06411061697194682
Bond Position:  [0.1011125]


portfolio before change:  [6.20604612]
curr_Stock_Price:  95.2249032647172
curr_Factors:  [95.22490326]
mat_Sqrt:  [[0.15]]
grads:  [0.03590301]
Stock Position:  0.03590301413053822
Bond Position:  [2.78718507]


portfolio before change:  [6.20987088]
curr_Stock_Price:  95.32658156689985
curr_Factors:  [95.32658157]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401064]
Stock Position:  -0.06401063947011008
Bond Position:  [12.31178633]


portfolio before change:  [6.27632456]
curr_Stock_Price:  94.30043713077963
curr_Factors:  [94.30043713]
mat_Sqrt:  [[0.15]]
grads:  [0.00188122]
Stock Position:  0.0018812244028365835
Bond Position:  [6.09892427]


portfolio before change:  [6.27662653]
curr_Stock_Price:  94.25832888393059
curr_Factors:  [94.25832888]
mat_Sqrt:  [[0.15]]
grads:  [0.00279847]
Stock Position:  0.002798468773352441
Bond Position:  [6.01284754]


portfolio before change:  [6.27784214]
curr_Stock_Price:  94.55841808687775
curr_Factors:  [94.55841809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02770952]
Stock Position:  -0.02770951794844888
Bond Position:  [8.89801032]


portfolio before change:  [6.29848784]
curr_Stock_Price:  93.83341240140814
curr_Factors:  [93.8334124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0104115]
Stock Position:  -0.010411497099467842
Bond Position:  [7.27543414]


portfolio before change:  [6.30430479]
curr_Stock_Price:  93.31838344828354
curr_Factors:  [93.31838345]
mat_Sqrt:  [[0.15]]
grads:  [0.00528292]
Stock Position:  0.005282923272616723
Bond Position:  [5.81131093]


portfolio before change:  [6.30834411]
curr_Stock_Price:  94.01422942644427
curr_Factors:  [94.01422943]
mat_Sqrt:  [[0.15]]
grads:  [-0.1275217]
Stock Position:  -0.12752170040263403
Bond Position:  [18.29719851]


portfolio before change:  [6.35969624]
curr_Stock_Price:  93.62050417196589
curr_Factors:  [93.62050417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03748973]
Stock Position:  -0.0374897338292545
Bond Position:  [9.86950402]


portfolio before change:  [6.3361976]
curr_Stock_Price:  94.26376015311754
curr_Factors:  [94.26376015]
mat_Sqrt:  [[0.15]]
grads:  [-0.03389426]
Stock Position:  -0.03389425742402123
Bond Position:  [9.53119776]


portfolio before change:  [6.34889272]
curr_Stock_Price:  93.90678530774036
curr_Factors:  [93.90678531]
mat_Sqrt:  [[0.15]]
grads:  [0.09532859]
Stock Position:  0.09532859074645479
Bond Position:  [-2.60310879]


portfolio before change:  [6.39694136]
curr_Stock_Price:  94.41252383400509
curr_Factors:  [94.41252383]
mat_Sqrt:  [[0.15]]
grads:  [0.04167097]
Stock Position:  0.041670974400255946
Bond Position:  [2.4626795]


portfolio before change:  [6.41369818]
curr_Stock_Price:  94.81095222654544
curr_Factors:  [94.81095223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01620371]
Stock Position:  -0.0162037120852989
Bond Position:  [7.94998756]


portfolio before change:  [6.40189075]
curr_Stock_Price:  95.570304338355
curr_Factors:  [95.57030434]
mat_Sqrt:  [[0.15]]
grads:  [-0.03413145]
Stock Position:  -0.03413145398062413
Bond Position:  [9.66384419]


portfolio before change:  [6.37715905]
curr_Stock_Price:  96.31260223521626
curr_Factors:  [96.31260224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01133652]
Stock Position:  -0.011336518759794054
Bond Position:  [7.46900867]


portfolio before change:  [6.37531262]
curr_Stock_Price:  96.51665587252825
curr_Factors:  [96.51665587]
mat_Sqrt:  [[0.15]]
grads:  [-0.0212553]
Stock Position:  -0.021255302020348883
Bond Position:  [8.42680329]


portfolio before change:  [6.38000509]
curr_Stock_Price:  96.32066840107896
curr_Factors:  [96.3206684]
mat_Sqrt:  [[0.15]]
grads:  [-0.01987408]
Stock Position:  -0.019874083890525477
Bond Position:  [8.29429013]


portfolio before change:  [6.40356775]
curr_Stock_Price:  95.16115551492861
curr_Factors:  [95.16115551]
mat_Sqrt:  [[0.15]]
grads:  [0.12057727]
Stock Position:  0.12057726742738638
Bond Position:  [-5.07070434]


portfolio before change:  [6.43761044]
curr_Stock_Price:  95.44611482129132
curr_Factors:  [95.44611482]
mat_Sqrt:  [[0.15]]
grads:  [0.0424619]
Stock Position:  0.04246189849980245
Bond Position:  [2.3847872]


portfolio before change:  [6.47360498]
curr_Stock_Price:  96.290294786765
curr_Factors:  [96.29029479]
mat_Sqrt:  [[0.15]]
grads:  [0.11994645]
Stock Position:  0.11994645433214694
Bond Position:  [-5.07607447]


portfolio before change:  [6.37188142]
curr_Stock_Price:  95.44486508096387
curr_Factors:  [95.44486508]
mat_Sqrt:  [[0.15]]
grads:  [-0.02306537]
Stock Position:  -0.02306537120634258
Bond Position:  [8.57335266]


portfolio before change:  [6.36706037]
curr_Stock_Price:  95.67711339563215
curr_Factors:  [95.6771134]
mat_Sqrt:  [[0.15]]
grads:  [0.04222427]
Stock Position:  0.042224271791380476
Bond Position:  [2.32716393]


portfolio before change:  [6.35951502]
curr_Stock_Price:  95.49497169659318
curr_Factors:  [95.4949717]
mat_Sqrt:  [[0.15]]
grads:  [0.17856964]
Stock Position:  0.1785696374473837
Bond Position:  [-10.69298745]


portfolio before change:  [6.30668254]
curr_Stock_Price:  95.20284953449266
curr_Factors:  [95.20284953]
mat_Sqrt:  [[0.15]]
grads:  [0.02066453]
Stock Position:  0.02066452919358105
Bond Position:  [4.33936048]


portfolio before change:  [6.29268444]
curr_Stock_Price:  94.51232726539821
curr_Factors:  [94.51232727]
mat_Sqrt:  [[0.15]]
grads:  [-0.10112311]
Stock Position:  -0.10112311358927861
Bond Position:  [15.85006525]


portfolio before change:  [6.26814373]
curr_Stock_Price:  94.76480543365636
curr_Factors:  [94.76480543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03815543]
Stock Position:  -0.03815543448615985
Bond Position:  [9.88393605]


portfolio before change:  [6.25533743]
curr_Stock_Price:  95.11663105201171
curr_Factors:  [95.11663105]
mat_Sqrt:  [[0.15]]
grads:  [0.01734819]
Stock Position:  0.017348193524586872
Bond Position:  [4.60523571]


portfolio before change:  [6.26683182]
curr_Stock_Price:  95.76260928455613
curr_Factors:  [95.76260928]
mat_Sqrt:  [[0.15]]
grads:  [0.07182025]
Stock Position:  0.07182025064441465
Bond Position:  [-0.61086278]


portfolio before change:  [6.26415782]
curr_Stock_Price:  95.72590899971078
curr_Factors:  [95.725909]
mat_Sqrt:  [[0.15]]
grads:  [0.03445942]
Stock Position:  0.03445942228208938
Bond Position:  [2.9654983]


portfolio before change:  [6.22503242]
curr_Stock_Price:  94.58512536336015
curr_Factors:  [94.58512536]
mat_Sqrt:  [[0.15]]
grads:  [0.01156838]
Stock Position:  0.011568375238910807
Bond Position:  [5.1308362]


portfolio before change:  [6.22590316]
curr_Stock_Price:  94.63267252355509
curr_Factors:  [94.63267252]
mat_Sqrt:  [[0.15]]
grads:  [-0.15699706]
Stock Position:  -0.15699705603448957
Bond Position:  [21.08295415]


portfolio before change:  [6.20680442]
curr_Stock_Price:  94.76271613991904
curr_Factors:  [94.76271614]
mat_Sqrt:  [[0.15]]
grads:  [-0.2183964]
Stock Position:  -0.21839639949099737
Bond Position:  [26.90264043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.60544786]
Stock Price:  92.94509471157744
PL:  [6.60544786]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.28966089e-02]
 [ 6.90606546e-03]
 [ 5.49074208e-03]
 [-1.08420877e-02]
 [ 1.25657849e-02]
 [-1.52423725e-02]
 [-7.75295657e-03]
 [-5.55684225e-04]
 [-1.44939588e-02]
 [-1.25188908e-02]
 [ 1.15980720e-02]
 [-6.32533697e-03]
 [ 2.22700249e-03]
 [ 3.47495511e-03]
 [ 7.10629999e-04]
 [ 3.07342883e-03]
 [-1.74272874e-02]
 [-1.34066019e-02]
 [ 2.48825047e-02]
 [-1.77167659e-03]
 [-8.98229079e-03]
 [ 5.35791644e-03]
 [ 1.60800344e-02]
 [ 1.91053987e-02]
 [-5.35023482e-03]
 [ 4.64076714e-03]
 [ 9.39425693e-03]
 [ 7.91236507e-03]
 [ 1.58167161e-02]
 [ 1.33402926e-03]
 [-6.44363433e-03]
 [ 1.06569709e-02]
 [ 1.16399154e-02]
 [ 2.98016216e-03]
 [ 5.51727179e-03]
 [ 1.36129382e-02]
 [-2.79719686e-02]
 [-3.63145302e-04]
 [-4.03637734e-02]
 [-1.42771843e-02]
 [ 4.02705207e-03]
 [ 1.02502729e-02]
 [-4.37162075e-03]
 [-3.67400042e-03]
 [ 1.11603328e-02]
 [ 1.23713060e-02]
 [ 1.07291827e-02]
 [ 1.50522152e-03]
 [ 1.48027130e-02]
 [-1.19303901e-03]
 [ 1.90225131e-02]
 [-1.53245562e-02]
 [ 1.24245300e-03]
 [-6.95618250e-03]
 [-2.47357287e-03]
 [-3.31720823e-03]
 [ 1.02878598e-02]
 [-6.59784565e-03]
 [ 6.40843019e-03]
 [-3.92255656e-03]
 [-2.03871231e-03]
 [ 7.16001539e-03]
 [-1.83103412e-02]
 [ 4.39465520e-03]
 [ 2.55658029e-02]
 [ 6.22688075e-03]
 [ 1.49049381e-02]
 [ 6.16680899e-03]
 [ 3.76897004e-03]
 [ 1.60473369e-02]
 [ 6.05678623e-04]
 [-1.54717121e-02]
 [-1.74166649e-03]
 [ 1.19107844e-03]
 [ 3.33811482e-03]
 [-2.01046363e-02]
 [-3.95157206e-03]
 [ 1.16081943e-02]
 [-5.76337296e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.91997025]
curr_Stock_Price:  99.04849930173663
curr_Factors:  [99.0484993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08597739]
Stock Position:  -0.08597739259456387
Bond Position:  [-10.40403854]


portfolio before change:  [-18.98719082]
curr_Stock_Price:  99.82277597770539
curr_Factors:  [99.82277598]
mat_Sqrt:  [[0.15]]
grads:  [0.04604044]
Stock Position:  0.046040436428728015
Bond Position:  [-23.58307499]


portfolio before change:  [-18.99732213]
curr_Stock_Price:  99.6347384326679
curr_Factors:  [99.63473843]
mat_Sqrt:  [[0.15]]
grads:  [0.03660495]
Stock Position:  0.03660494717445395
Bond Position:  [-22.64444647]


portfolio before change:  [-19.02005996]
curr_Stock_Price:  99.05223522780891
curr_Factors:  [99.05223523]
mat_Sqrt:  [[0.15]]
grads:  [-0.07228058]
Stock Position:  -0.07228058476822691
Bond Position:  [-11.86050647]


portfolio before change:  [-19.03798309]
curr_Stock_Price:  99.28994536724528
curr_Factors:  [99.28994537]
mat_Sqrt:  [[0.15]]
grads:  [0.0837719]
Stock Position:  0.08377189923844888
Bond Position:  [-27.35569039]


portfolio before change:  [-19.12214528]
curr_Stock_Price:  98.30569631078711
curr_Factors:  [98.30569631]
mat_Sqrt:  [[0.15]]
grads:  [-0.10161582]
Stock Position:  -0.10161581688725996
Bond Position:  [-9.13273165]


portfolio before change:  [-19.19063587]
curr_Stock_Price:  98.9740939140673
curr_Factors:  [98.97409391]
mat_Sqrt:  [[0.15]]
grads:  [-0.05168638]
Stock Position:  -0.051686377124104725
Bond Position:  [-14.07502352]


portfolio before change:  [-19.2142149]
curr_Stock_Price:  99.41326802096498
curr_Factors:  [99.41326802]
mat_Sqrt:  [[0.15]]
grads:  [-0.00370456]
Stock Position:  -0.0037045615031098406
Bond Position:  [-18.84593234]


portfolio before change:  [-19.21479617]
curr_Stock_Price:  99.2522118515338
curr_Factors:  [99.25221185]
mat_Sqrt:  [[0.15]]
grads:  [-0.09662639]
Stock Position:  -0.09662639224710409
Bond Position:  [-9.62441301]


portfolio before change:  [-19.18061611]
curr_Stock_Price:  98.89225223156222
curr_Factors:  [98.89225223]
mat_Sqrt:  [[0.15]]
grads:  [-0.08345927]
Stock Position:  -0.08345927176786415
Bond Position:  [-10.92714076]


portfolio before change:  [-19.16807576]
curr_Stock_Price:  98.73381182271152
curr_Factors:  [98.73381182]
mat_Sqrt:  [[0.15]]
grads:  [0.07732048]
Stock Position:  0.07732048006432218
Bond Position:  [-26.80222149]


portfolio before change:  [-19.12414713]
curr_Stock_Price:  99.32361445244045
curr_Factors:  [99.32361445]
mat_Sqrt:  [[0.15]]
grads:  [-0.04216891]
Stock Position:  -0.04216891310700732
Bond Position:  [-14.93577826]


portfolio before change:  [-19.08150525]
curr_Stock_Price:  98.29026104354134
curr_Factors:  [98.29026104]
mat_Sqrt:  [[0.15]]
grads:  [0.01484668]
Stock Position:  0.014846683238769275
Bond Position:  [-20.54078962]


portfolio before change:  [-19.07427921]
curr_Stock_Price:  98.86344478764384
curr_Factors:  [98.86344479]
mat_Sqrt:  [[0.15]]
grads:  [0.02316637]
Stock Position:  0.023166367406188777
Bond Position:  [-21.3645861]


portfolio before change:  [-19.10625112]
curr_Stock_Price:  97.54098544305792
curr_Factors:  [97.54098544]
mat_Sqrt:  [[0.15]]
grads:  [0.00473753]
Stock Position:  0.004737533327122101
Bond Position:  [-19.56835479]


portfolio before change:  [-19.10751753]
curr_Stock_Price:  97.53183526021712
curr_Factors:  [97.53183526]
mat_Sqrt:  [[0.15]]
grads:  [0.02048953]
Stock Position:  0.020489525557546424
Bond Position:  [-21.10589856]


portfolio before change:  [-19.10120998]
curr_Stock_Price:  97.9040603594871
curr_Factors:  [97.90406036]
mat_Sqrt:  [[0.15]]
grads:  [-0.11618192]
Stock Position:  -0.11618191580842296
Bond Position:  [-7.72652868]


portfolio before change:  [-19.17020301]
curr_Stock_Price:  98.49374000585317
curr_Factors:  [98.49374001]
mat_Sqrt:  [[0.15]]
grads:  [-0.08937735]
Stock Position:  -0.08937734593729213
Bond Position:  [-10.36709394]


portfolio before change:  [-19.12251752]
curr_Stock_Price:  97.95296032892419
curr_Factors:  [97.95296033]
mat_Sqrt:  [[0.15]]
grads:  [0.16588336]
Stock Position:  0.16588336477911952
Bond Position:  [-35.37128417]


portfolio before change:  [-19.10531069]
curr_Stock_Price:  98.0700160746341
curr_Factors:  [98.07001607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01181118]
Stock Position:  -0.01181117726232852
Bond Position:  [-17.94698835]


portfolio before change:  [-19.10742234]
curr_Stock_Price:  98.15382849734384
curr_Factors:  [98.1538285]
mat_Sqrt:  [[0.15]]
grads:  [-0.05988194]
Stock Position:  -0.059881938590102976
Bond Position:  [-13.22978081]


portfolio before change:  [-19.15813524]
curr_Stock_Price:  98.9869013275831
curr_Factors:  [98.98690133]
mat_Sqrt:  [[0.15]]
grads:  [0.03571944]
Stock Position:  0.03571944294986379
Bond Position:  [-22.69389222]


portfolio before change:  [-19.17619093]
curr_Stock_Price:  98.52112503415186
curr_Factors:  [98.52112503]
mat_Sqrt:  [[0.15]]
grads:  [0.10720023]
Stock Position:  0.10720022965389825
Bond Position:  [-29.73767815]


portfolio before change:  [-19.18070539]
curr_Stock_Price:  98.49635077280614
curr_Factors:  [98.49635077]
mat_Sqrt:  [[0.15]]
grads:  [0.12736932]
Stock Position:  0.12736932499622194
Bond Position:  [-31.72611911]


portfolio before change:  [-19.1717378]
curr_Stock_Price:  98.58232550231855
curr_Factors:  [98.5823255]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566823]
Stock Position:  -0.03566823210538139
Bond Position:  [-15.65548053]


portfolio before change:  [-19.1860783]
curr_Stock_Price:  98.9569446347246
curr_Factors:  [98.95694463]
mat_Sqrt:  [[0.15]]
grads:  [0.03093845]
Stock Position:  0.03093844758260653
Bond Position:  [-22.24765254]


portfolio before change:  [-19.20005978]
curr_Stock_Price:  98.54997641089061
curr_Factors:  [98.54997641]
mat_Sqrt:  [[0.15]]
grads:  [0.06262838]
Stock Position:  0.06262837950451264
Bond Position:  [-25.37208511]


portfolio before change:  [-19.15710484]
curr_Stock_Price:  99.26116760603824
curr_Factors:  [99.26116761]
mat_Sqrt:  [[0.15]]
grads:  [0.0527491]
Stock Position:  0.05274910045391888
Bond Position:  [-24.39304214]


portfolio before change:  [-19.15715923]
curr_Stock_Price:  99.28903944571326
curr_Factors:  [99.28903945]
mat_Sqrt:  [[0.15]]
grads:  [0.10544477]
Stock Position:  0.10544477396056115
Bond Position:  [-29.62666956]


portfolio before change:  [-19.12210893]
curr_Stock_Price:  99.63900486500464
curr_Factors:  [99.63900487]
mat_Sqrt:  [[0.15]]
grads:  [0.00889353]
Stock Position:  0.00889352837319749
Bond Position:  [-20.00825125]


portfolio before change:  [-19.12789667]
curr_Stock_Price:  99.12883848760809
curr_Factors:  [99.12883849]
mat_Sqrt:  [[0.15]]
grads:  [-0.04295756]
Stock Position:  -0.04295756219396354
Bond Position:  [-14.86956342]


portfolio before change:  [-19.1152547]
curr_Stock_Price:  98.8129140881335
curr_Factors:  [98.81291409]
mat_Sqrt:  [[0.15]]
grads:  [0.07104647]
Stock Position:  0.07104647247989385
Bond Position:  [-26.13556368]


portfolio before change:  [-19.08415097]
curr_Stock_Price:  99.27370057705211
curr_Factors:  [99.27370058]
mat_Sqrt:  [[0.15]]
grads:  [0.07759944]
Stock Position:  0.07759943568212334
Bond Position:  [-26.78773411]


portfolio before change:  [-18.99972463]
curr_Stock_Price:  100.38325275731084
curr_Factors:  [100.38325276]
mat_Sqrt:  [[0.15]]
grads:  [0.01986775]
Stock Position:  0.01986774775435733
Bond Position:  [-20.99411378]


portfolio before change:  [-18.99519448]
curr_Stock_Price:  100.67731350228925
curr_Factors:  [100.6773135]
mat_Sqrt:  [[0.15]]
grads:  [0.03678181]
Stock Position:  0.03678181191618421
Bond Position:  [-22.69828849]


portfolio before change:  [-18.96819397]
curr_Stock_Price:  101.44995634086615
curr_Factors:  [101.44995634]
mat_Sqrt:  [[0.15]]
grads:  [0.09075292]
Stock Position:  0.09075292104653711
Bond Position:  [-28.17507384]


portfolio before change:  [-18.97389584]
curr_Stock_Price:  101.40653206217428
curr_Factors:  [101.40653206]
mat_Sqrt:  [[0.15]]
grads:  [-0.18647979]
Stock Position:  -0.1864797903819702
Bond Position:  [-0.063627]


portfolio before change:  [-19.07049146]
curr_Stock_Price:  101.92450580202936
curr_Factors:  [101.9245058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00242097]
Stock Position:  -0.002420968677596059
Bond Position:  [-18.82373542]


portfolio before change:  [-19.0711011]
curr_Stock_Price:  101.69035479266051
curr_Factors:  [101.69035479]
mat_Sqrt:  [[0.15]]
grads:  [-0.26909182]
Stock Position:  -0.2690918227216194
Bond Position:  [8.29294182]


portfolio before change:  [-19.33628888]
curr_Stock_Price:  102.67777276260408
curr_Factors:  [102.67777276]
mat_Sqrt:  [[0.15]]
grads:  [-0.09518123]
Stock Position:  -0.09518122886653203
Bond Position:  [-9.56329229]


portfolio before change:  [-19.32320654]
curr_Stock_Price:  102.53404625662473
curr_Factors:  [102.53404626]
mat_Sqrt:  [[0.15]]
grads:  [0.02684701]
Stock Position:  0.026847013778765732
Bond Position:  [-22.07593949]


portfolio before change:  [-19.3363981]
curr_Stock_Price:  102.09408041659711
curr_Factors:  [102.09408042]
mat_Sqrt:  [[0.15]]
grads:  [0.06833515]
Stock Position:  0.06833515244738345
Bond Position:  [-26.31301265]


portfolio before change:  [-19.37651528]
curr_Stock_Price:  101.53108217241059
curr_Factors:  [101.53108217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02914414]
Stock Position:  -0.029144138340041547
Bond Position:  [-16.41747938]


portfolio before change:  [-19.38759288]
curr_Stock_Price:  101.87597060909225
curr_Factors:  [101.87597061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449334]
Stock Position:  -0.024493336100975222
Bond Position:  [-16.89231049]


portfolio before change:  [-19.39502676]
curr_Stock_Price:  102.13637080675481
curr_Factors:  [102.13637081]
mat_Sqrt:  [[0.15]]
grads:  [0.07440222]
Stock Position:  0.07440221842751697
Bond Position:  [-26.99419933]


portfolio before change:  [-19.39042209]
curr_Stock_Price:  102.22093618588384
curr_Factors:  [102.22093619]
mat_Sqrt:  [[0.15]]
grads:  [0.08247537]
Stock Position:  0.08247537313305968
Bond Position:  [-27.82113195]


portfolio before change:  [-19.47565493]
curr_Stock_Price:  101.20858600397335
curr_Factors:  [101.208586]
mat_Sqrt:  [[0.15]]
grads:  [0.07152788]
Stock Position:  0.07152788472220302
Bond Position:  [-26.714891]


portfolio before change:  [-19.44222912]
curr_Stock_Price:  101.69924140886307
curr_Factors:  [101.69924141]
mat_Sqrt:  [[0.15]]
grads:  [0.01003481]
Stock Position:  0.010034810143489238
Bond Position:  [-20.4627617]


portfolio before change:  [-19.44323705]
curr_Stock_Price:  101.72625041063219
curr_Factors:  [101.72625041]
mat_Sqrt:  [[0.15]]
grads:  [0.09868475]
Stock Position:  0.09868475344721138
Bond Position:  [-29.48206699]


portfolio before change:  [-19.45347229]
curr_Stock_Price:  101.6412063485523
curr_Factors:  [101.64120635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795359]
Stock Position:  -0.00795359340245378
Bond Position:  [-18.64505946]


portfolio before change:  [-19.45865791]
curr_Stock_Price:  102.14667221127304
curr_Factors:  [102.14667221]
mat_Sqrt:  [[0.15]]
grads:  [0.12681675]
Stock Position:  0.1268167537941321
Bond Position:  [-32.41256729]


portfolio before change:  [-19.50918587]
curr_Stock_Price:  101.76421396480421
curr_Factors:  [101.76421396]
mat_Sqrt:  [[0.15]]
grads:  [-0.10216371]
Stock Position:  -0.10216370784618362
Bond Position:  [-9.11257645]


portfolio before change:  [-19.50816126]
curr_Stock_Price:  101.74860990970427
curr_Factors:  [101.74860991]
mat_Sqrt:  [[0.15]]
grads:  [0.00828302]
Stock Position:  0.008283020017998783
Bond Position:  [-20.35094703]


portfolio before change:  [-19.50644848]
curr_Stock_Price:  102.10895586703214
curr_Factors:  [102.10895587]
mat_Sqrt:  [[0.15]]
grads:  [-0.04637455]
Stock Position:  -0.04637454996844324
Bond Position:  [-14.7711916]


portfolio before change:  [-19.51448489]
curr_Stock_Price:  102.26234140659068
curr_Factors:  [102.26234141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01649049]
Stock Position:  -0.016490485771668215
Bond Position:  [-17.82812921]


portfolio before change:  [-19.51164128]
curr_Stock_Price:  102.0223298389889
curr_Factors:  [102.02232984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02211472]
Stock Position:  -0.022114721520164513
Bond Position:  [-17.25544587]


portfolio before change:  [-19.50244976]
curr_Stock_Price:  101.55793225880929
curr_Factors:  [101.55793226]
mat_Sqrt:  [[0.15]]
grads:  [0.06858573]
Stock Position:  0.06858573194349146
Bond Position:  [-26.46787487]


portfolio before change:  [-19.47498905]
curr_Stock_Price:  101.98243740847609
curr_Factors:  [101.98243741]
mat_Sqrt:  [[0.15]]
grads:  [-0.04398564]
Stock Position:  -0.043985637658403604
Bond Position:  [-14.98922651]


portfolio before change:  [-19.47702386]
curr_Stock_Price:  102.00739909756234
curr_Factors:  [102.0073991]
mat_Sqrt:  [[0.15]]
grads:  [0.04272287]
Stock Position:  0.042722867946548934
Bond Position:  [-23.83507251]


portfolio before change:  [-19.46565827]
curr_Stock_Price:  102.30829967825149
curr_Factors:  [102.30829968]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615038]
Stock Position:  -0.026150377075393368
Bond Position:  [-16.79025765]


portfolio before change:  [-19.4544623]
curr_Stock_Price:  101.84003128483722
curr_Factors:  [101.84003128]
mat_Sqrt:  [[0.15]]
grads:  [-0.01359142]
Stock Position:  -0.013591415415261984
Bond Position:  [-18.07031213]


portfolio before change:  [-19.47178435]
curr_Stock_Price:  103.03141711409127
curr_Factors:  [103.03141711]
mat_Sqrt:  [[0.15]]
grads:  [0.04773344]
Stock Position:  0.04773343590213233
Bond Position:  [-24.38982789]


portfolio before change:  [-19.48751515]
curr_Stock_Price:  102.73379788486656
curr_Factors:  [102.73379788]
mat_Sqrt:  [[0.15]]
grads:  [-0.12206894]
Stock Position:  -0.12206894110953682
Bond Position:  [-6.94690922]


portfolio before change:  [-19.4191399]
curr_Stock_Price:  102.17010464130081
curr_Factors:  [102.17010464]
mat_Sqrt:  [[0.15]]
grads:  [0.0292977]
Stock Position:  0.02929770130510525
Bond Position:  [-22.41248911]


portfolio before change:  [-19.43339042]
curr_Stock_Price:  101.73151435808691
curr_Factors:  [101.73151436]
mat_Sqrt:  [[0.15]]
grads:  [0.17043869]
Stock Position:  0.17043868611943666
Bond Position:  [-36.77237606]


portfolio before change:  [-19.3644202]
curr_Stock_Price:  102.14966217434792
curr_Factors:  [102.14966217]
mat_Sqrt:  [[0.15]]
grads:  [0.04151254]
Stock Position:  0.041512538307816434
Bond Position:  [-23.60491196]


portfolio before change:  [-19.33868294]
curr_Stock_Price:  102.80518964704179
curr_Factors:  [102.80518965]
mat_Sqrt:  [[0.15]]
grads:  [0.09936625]
Stock Position:  0.09936625370236334
Bond Position:  [-29.5540495]


portfolio before change:  [-19.38713033]
curr_Stock_Price:  102.33621548295928
curr_Factors:  [102.33621548]
mat_Sqrt:  [[0.15]]
grads:  [0.04111206]
Stock Position:  0.0411120599396182
Bond Position:  [-23.59438296]


portfolio before change:  [-19.39762959]
curr_Stock_Price:  102.1167041170523
curr_Factors:  [102.11670412]
mat_Sqrt:  [[0.15]]
grads:  [0.02512647]
Stock Position:  0.02512646695885934
Bond Position:  [-21.96346158]


portfolio before change:  [-19.3851485]
curr_Stock_Price:  102.66806893453803
curr_Factors:  [102.66806893]
mat_Sqrt:  [[0.15]]
grads:  [0.10698225]
Stock Position:  0.10698224616489817
Bond Position:  [-30.36880912]


portfolio before change:  [-19.45668651]
curr_Stock_Price:  102.01712077483572
curr_Factors:  [102.01712077]
mat_Sqrt:  [[0.15]]
grads:  [0.00403786]
Stock Position:  0.004037857485589833
Bond Position:  [-19.8686171]


portfolio before change:  [-19.45567924]
curr_Stock_Price:  102.5741216144113
curr_Factors:  [102.57412161]
mat_Sqrt:  [[0.15]]
grads:  [-0.10314475]
Stock Position:  -0.10314474752340505
Bond Position:  [-8.87569737]


portfolio before change:  [-19.43456274]
curr_Stock_Price:  102.36401633714543
curr_Factors:  [102.36401634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01161111]
Stock Position:  -0.011611109946730175
Bond Position:  [-18.24600289]


portfolio before change:  [-19.44040222]
curr_Stock_Price:  102.76872090699769
curr_Factors:  [102.76872091]
mat_Sqrt:  [[0.15]]
grads:  [0.00794052]
Stock Position:  0.00794052291222013
Bond Position:  [-20.2564396]


portfolio before change:  [-19.43579629]
curr_Stock_Price:  103.50821864875697
curr_Factors:  [103.50821865]
mat_Sqrt:  [[0.15]]
grads:  [0.0222541]
Stock Position:  0.022254098826323742
Bond Position:  [-21.73927841]


portfolio before change:  [-19.4124551]
curr_Stock_Price:  104.61812333365239
curr_Factors:  [104.61812333]
mat_Sqrt:  [[0.15]]
grads:  [-0.13403091]
Stock Position:  -0.1340309085400483
Bond Position:  [-5.39039298]


portfolio before change:  [-19.3940232]
curr_Stock_Price:  104.47808986633972
curr_Factors:  [104.47808987]
mat_Sqrt:  [[0.15]]
grads:  [-0.02634381]
Stock Position:  -0.026343813726924112
Bond Position:  [-16.64167186]


portfolio before change:  [-19.39386796]
curr_Stock_Price:  104.43271398672164
curr_Factors:  [104.43271399]
mat_Sqrt:  [[0.15]]
grads:  [0.07738796]
Stock Position:  0.07738796177561479
Bond Position:  [-27.47570284]


portfolio before change:  [-19.40287844]
curr_Stock_Price:  104.33847207376054
curr_Factors:  [104.33847207]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842249]
Stock Position:  -0.03842248637684853
Bond Position:  [-15.39393492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.4131845]
Stock Price:  104.58166068515905
PL:  [-23.99484519]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.29377862e-03]
 [ 1.81844355e-02]
 [ 1.56563798e-02]
 [-1.07557529e-02]
 [-3.66385383e-02]
 [-1.31803032e-03]
 [ 1.29450105e-02]
 [-6.52707064e-02]
 [ 1.80756306e-02]
 [-9.96284123e-03]
 [-1.42608113e-02]
 [ 2.40068773e-02]
 [-7.19755509e-03]
 [ 1.34856639e-02]
 [ 3.33933553e-02]
 [ 2.96512907e-04]
 [ 1.88858753e-02]
 [-3.90879672e-03]
 [ 3.06752000e-02]
 [-1.20166895e-04]
 [-2.11489716e-02]
 [ 1.16396050e-02]
 [-1.49375067e-02]
 [ 1.07787710e-01]
 [ 1.96536478e-02]
 [ 6.71255736e-04]
 [ 1.55255352e-01]
 [ 6.39166727e-02]
 [-9.40669827e-03]
 [-8.45132413e-03]
 [ 1.69362180e-02]
 [ 1.94427348e-02]
 [ 2.15204047e-02]
 [-1.72351052e-02]
 [ 2.64510191e-03]
 [-4.77378086e-02]
 [-8.24102743e-03]
 [-2.00761870e-02]
 [ 4.09874339e-02]
 [-1.16526230e-01]
 [ 2.71106052e-03]
 [-2.17510914e-02]
 [-3.34272364e-02]
 [ 5.72082025e-02]
 [-3.60398550e-02]
 [ 1.23685363e-02]
 [ 9.98893349e-03]
 [-5.21640452e-03]
 [ 1.84504889e-02]
 [-1.72757784e-03]
 [ 1.56698250e-02]
 [ 4.25708116e-02]
 [-1.31501261e-02]
 [-1.00827283e-01]
 [-3.44087055e-02]
 [-1.16323158e-03]
 [-1.59834527e-02]
 [-1.64128915e-02]
 [-2.52911190e-03]
 [-2.83355601e-03]
 [-7.88804510e-03]
 [-6.92477608e-03]
 [-1.63458226e-02]
 [-4.68992805e-04]
 [-6.18015235e-03]
 [ 2.73938520e-02]
 [-5.08092894e-04]
 [ 1.60551467e-02]
 [ 8.19041170e-03]
 [ 1.12829422e-02]
 [ 5.72525486e-03]
 [-1.48546970e-02]
 [-3.23218118e-02]
 [ 7.38826379e-04]
 [-1.23891594e-03]
 [-2.27682832e-02]
 [-4.90392086e-03]
 [ 1.73081640e-02]
 [ 4.03666481e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.99302172]
curr_Stock_Price:  100.72501175205363
curr_Factors:  [100.72501175]
mat_Sqrt:  [[0.15]]
grads:  [-0.03529186]
Stock Position:  -0.03529185744933318
Bond Position:  [21.54779448]


portfolio before change:  [18.00826711]
curr_Stock_Price:  100.33119268613054
curr_Factors:  [100.33119269]
mat_Sqrt:  [[0.15]]
grads:  [0.12122957]
Stock Position:  0.12122956995044563
Bond Position:  [5.84515977]


portfolio before change:  [18.020425]
curr_Stock_Price:  100.42846730730803
curr_Factors:  [100.42846731]
mat_Sqrt:  [[0.15]]
grads:  [0.10437587]
Stock Position:  0.10437586503410923
Bond Position:  [7.53811685]


portfolio before change:  [18.0217564]
curr_Stock_Price:  100.43670917795575
curr_Factors:  [100.43670918]
mat_Sqrt:  [[0.15]]
grads:  [-0.07170502]
Stock Position:  -0.07170501917969162
Bond Position:  [25.22357256]


portfolio before change:  [17.94281219]
curr_Stock_Price:  101.55965338701502
curr_Factors:  [101.55965339]
mat_Sqrt:  [[0.15]]
grads:  [-0.24425692]
Stock Position:  -0.24425692214242106
Bond Position:  [42.74946054]


portfolio before change:  [17.8690184]
curr_Stock_Price:  101.87270784407173
curr_Factors:  [101.87270784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00878687]
Stock Position:  -0.008786868798559484
Bond Position:  [18.76416051]


portfolio before change:  [17.86627363]
curr_Stock_Price:  102.31855130015934
curr_Factors:  [102.3185513]
mat_Sqrt:  [[0.15]]
grads:  [0.08630007]
Stock Position:  0.08630006979684217
Bond Position:  [9.03617551]


portfolio before change:  [17.95520331]
curr_Stock_Price:  103.34247755212138
curr_Factors:  [103.34247755]
mat_Sqrt:  [[0.15]]
grads:  [-0.43513804]
Stock Position:  -0.4351380428078635
Bond Position:  [62.92344673]


portfolio before change:  [17.92321926]
curr_Stock_Price:  103.42501892151218
curr_Factors:  [103.42501892]
mat_Sqrt:  [[0.15]]
grads:  [0.1205042]
Stock Position:  0.12050420420066835
Bond Position:  [5.46006966]


portfolio before change:  [18.01659485]
curr_Stock_Price:  104.19706109750075
curr_Factors:  [104.1970611]
mat_Sqrt:  [[0.15]]
grads:  [-0.06641894]
Stock Position:  -0.06641894152307012
Bond Position:  [24.93725336]


portfolio before change:  [18.033379]
curr_Stock_Price:  103.96782641609825
curr_Factors:  [103.96782642]
mat_Sqrt:  [[0.15]]
grads:  [-0.09507208]
Stock Position:  -0.09507207560771817
Bond Position:  [27.91781606]


portfolio before change:  [18.0377403]
curr_Stock_Price:  103.94030649176555
curr_Factors:  [103.94030649]
mat_Sqrt:  [[0.15]]
grads:  [0.16004585]
Stock Position:  0.16004584853984577
Bond Position:  [1.40252575]


portfolio before change:  [18.18534035]
curr_Stock_Price:  104.86199481847271
curr_Factors:  [104.86199482]
mat_Sqrt:  [[0.15]]
grads:  [-0.0479837]
Stock Position:  -0.04798370058566079
Bond Position:  [23.21700691]


portfolio before change:  [18.13414526]
curr_Stock_Price:  105.95916309170767
curr_Factors:  [105.95916309]
mat_Sqrt:  [[0.15]]
grads:  [0.08990443]
Stock Position:  0.08990442567765032
Bond Position:  [8.60794756]


portfolio before change:  [18.17814499]
curr_Stock_Price:  106.4425843632101
curr_Factors:  [106.44258436]
mat_Sqrt:  [[0.15]]
grads:  [0.22262237]
Stock Position:  0.222622368563124
Bond Position:  [-5.51835526]


portfolio before change:  [18.26251705]
curr_Stock_Price:  106.82312549107459
curr_Factors:  [106.82312549]
mat_Sqrt:  [[0.15]]
grads:  [0.00197675]
Stock Position:  0.0019767527108115884
Bond Position:  [18.05135415]


portfolio before change:  [18.26526151]
curr_Stock_Price:  107.64073747722344
curr_Factors:  [107.64073748]
mat_Sqrt:  [[0.15]]
grads:  [0.12590584]
Stock Position:  0.125905835611667
Bond Position:  [4.71266451]


portfolio before change:  [18.25335947]
curr_Stock_Price:  107.54386675712429
curr_Factors:  [107.54386676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02605864]
Stock Position:  -0.02605864479914877
Bond Position:  [21.0558069]


portfolio before change:  [18.23962075]
curr_Stock_Price:  108.12159269426364
curr_Factors:  [108.12159269]
mat_Sqrt:  [[0.15]]
grads:  [0.20450133]
Stock Position:  0.20450133313599397
Bond Position:  [-3.8713891]


portfolio before change:  [18.23114001]
curr_Stock_Price:  108.08130558400921
curr_Factors:  [108.08130558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00080111]
Stock Position:  -0.0008011126343587154
Bond Position:  [18.31772531]


portfolio before change:  [18.23148163]
curr_Stock_Price:  109.08400228773564
curr_Factors:  [109.08400229]
mat_Sqrt:  [[0.15]]
grads:  [-0.14099314]
Stock Position:  -0.14099314391679676
Bond Position:  [33.61157806]


portfolio before change:  [18.24112022]
curr_Stock_Price:  109.030540072851
curr_Factors:  [109.03054007]
mat_Sqrt:  [[0.15]]
grads:  [0.07759737]
Stock Position:  0.07759736645471015
Bond Position:  [9.78063745]


portfolio before change:  [18.24987616]
curr_Stock_Price:  109.1355001590726
curr_Factors:  [109.13550016]
mat_Sqrt:  [[0.15]]
grads:  [-0.09958338]
Stock Position:  -0.09958337821789122
Bond Position:  [29.11795795]


portfolio before change:  [18.24971148]
curr_Stock_Price:  109.15542923904458
curr_Factors:  [109.15542924]
mat_Sqrt:  [[0.15]]
grads:  [0.71858473]
Stock Position:  0.7185847320087299
Bond Position:  [-60.18771338]


portfolio before change:  [18.57720626]
curr_Stock_Price:  109.61641402372412
curr_Factors:  [109.61641402]
mat_Sqrt:  [[0.15]]
grads:  [0.13102432]
Stock Position:  0.13102431898855926
Bond Position:  [4.21479026]


portfolio before change:  [18.59105844]
curr_Stock_Price:  109.72012561705063
curr_Factors:  [109.72012562]
mat_Sqrt:  [[0.15]]
grads:  [0.00447504]
Stock Position:  0.0044750382428123715
Bond Position:  [18.10005668]


portfolio before change:  [18.59152917]
curr_Stock_Price:  109.57251783539094
curr_Factors:  [109.57251784]
mat_Sqrt:  [[0.15]]
grads:  [1.03503568]
Stock Position:  1.0350356823996785
Bond Position:  [-94.8199366]


portfolio before change:  [18.92001294]
curr_Stock_Price:  109.89560833317864
curr_Factors:  [109.89560833]
mat_Sqrt:  [[0.15]]
grads:  [0.42611115]
Stock Position:  0.4261111512944983
Bond Position:  [-27.90773125]


portfolio before change:  [18.62058494]
curr_Stock_Price:  109.19700256239638
curr_Factors:  [109.19700256]
mat_Sqrt:  [[0.15]]
grads:  [-0.06271132]
Stock Position:  -0.06271132183319965
Bond Position:  [25.46847331]


portfolio before change:  [18.61905583]
curr_Stock_Price:  109.24676926555908
curr_Factors:  [109.24676927]
mat_Sqrt:  [[0.15]]
grads:  [-0.05634216]
Stock Position:  -0.05634216086954791
Bond Position:  [24.77425488]


portfolio before change:  [18.638023]
curr_Stock_Price:  108.9376095445414
curr_Factors:  [108.93760954]
mat_Sqrt:  [[0.15]]
grads:  [0.11290812]
Stock Position:  0.11290812031780117
Bond Position:  [6.33808227]


portfolio before change:  [18.73750118]
curr_Stock_Price:  109.81515523355293
curr_Factors:  [109.81515523]
mat_Sqrt:  [[0.15]]
grads:  [0.12961823]
Stock Position:  0.1296182321772846
Bond Position:  [4.50345489]


portfolio before change:  [18.71436055]
curr_Stock_Price:  109.63445456555547
curr_Factors:  [109.63445457]
mat_Sqrt:  [[0.15]]
grads:  [0.14346936]
Stock Position:  0.14346936475578326
Bond Position:  [2.985175]


portfolio before change:  [18.72983367]
curr_Stock_Price:  109.74100372770106
curr_Factors:  [109.74100373]
mat_Sqrt:  [[0.15]]
grads:  [-0.1149007]
Stock Position:  -0.11490070124422955
Bond Position:  [31.33915195]


portfolio before change:  [18.81760428]
curr_Stock_Price:  108.99416887235593
curr_Factors:  [108.99416887]
mat_Sqrt:  [[0.15]]
grads:  [0.01763401]
Stock Position:  0.017634012724065805
Bond Position:  [16.89559972]


portfolio before change:  [18.80619559]
curr_Stock_Price:  108.28731380092998
curr_Factors:  [108.2873138]
mat_Sqrt:  [[0.15]]
grads:  [-0.31825206]
Stock Position:  -0.31825205724853656
Bond Position:  [53.26885598]


portfolio before change:  [19.03769491]
curr_Stock_Price:  107.57036662524435
curr_Factors:  [107.57036663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05494018]
Stock Position:  -0.05494018283630181
Bond Position:  [24.94763052]


portfolio before change:  [19.04118886]
curr_Stock_Price:  107.53515242043899
curr_Factors:  [107.53515242]
mat_Sqrt:  [[0.15]]
grads:  [-0.13384125]
Stock Position:  -0.13384124646423926
Bond Position:  [33.4338277]


portfolio before change:  [18.96760587]
curr_Stock_Price:  108.10054374271738
curr_Factors:  [108.10054374]
mat_Sqrt:  [[0.15]]
grads:  [0.27324956]
Stock Position:  0.27324955966451236
Bond Position:  [-10.57082011]


portfolio before change:  [19.34060493]
curr_Stock_Price:  109.46801074791459
curr_Factors:  [109.46801075]
mat_Sqrt:  [[0.15]]
grads:  [-0.77684153]
Stock Position:  -0.7768415319381353
Bond Position:  [104.37990209]


portfolio before change:  [18.74057792]
curr_Stock_Price:  110.2488018471976
curr_Factors:  [110.24880185]
mat_Sqrt:  [[0.15]]
grads:  [0.01807374]
Stock Position:  0.018073736817527133
Bond Position:  [16.74797009]


portfolio before change:  [18.74342571]
curr_Stock_Price:  110.34844965952861
curr_Factors:  [110.34844966]
mat_Sqrt:  [[0.15]]
grads:  [-0.14500728]
Stock Position:  -0.1450072762001344
Bond Position:  [34.74475383]


portfolio before change:  [18.60207407]
curr_Stock_Price:  111.33821554632874
curr_Factors:  [111.33821555]
mat_Sqrt:  [[0.15]]
grads:  [-0.22284824]
Stock Position:  -0.22284824265201666
Bond Position:  [43.41359974]


portfolio before change:  [18.36386135]
curr_Stock_Price:  112.41933759811755
curr_Factors:  [112.4193376]
mat_Sqrt:  [[0.15]]
grads:  [0.38138802]
Stock Position:  0.3813880164719629
Bond Position:  [-24.51152683]


portfolio before change:  [18.30235505]
curr_Stock_Price:  112.2620849219932
curr_Factors:  [112.26208492]
mat_Sqrt:  [[0.15]]
grads:  [-0.2402657]
Stock Position:  -0.24026569992213828
Bond Position:  [45.27508346]


portfolio before change:  [18.49178561]
curr_Stock_Price:  111.48544150151214
curr_Factors:  [111.4854415]
mat_Sqrt:  [[0.15]]
grads:  [0.08245691]
Stock Position:  0.08245690855513146
Bond Position:  [9.29904075]


portfolio before change:  [18.50593802]
curr_Stock_Price:  111.6500269403555
curr_Factors:  [111.65002694]
mat_Sqrt:  [[0.15]]
grads:  [0.06659289]
Stock Position:  0.06659288992280565
Bond Position:  [11.07084007]


portfolio before change:  [18.47303257]
curr_Stock_Price:  111.14550769463152
curr_Factors:  [111.14550769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03477603]
Stock Position:  -0.03477603012274729
Bond Position:  [22.3382321]


portfolio before change:  [18.49271045]
curr_Stock_Price:  110.61980959758039
curr_Factors:  [110.6198096]
mat_Sqrt:  [[0.15]]
grads:  [0.12300326]
Stock Position:  0.12300325966665643
Bond Position:  [4.88611329]


portfolio before change:  [18.34846737]
curr_Stock_Price:  109.44464991415964
curr_Factors:  [109.44464991]
mat_Sqrt:  [[0.15]]
grads:  [-0.01151719]
Stock Position:  -0.011517185622540456
Bond Position:  [19.60896172]


portfolio before change:  [18.34402064]
curr_Stock_Price:  109.9371596793607
curr_Factors:  [109.93715968]
mat_Sqrt:  [[0.15]]
grads:  [0.1044655]
Stock Position:  0.10446550013122591
Bond Position:  [6.85938027]


portfolio before change:  [18.33427186]
curr_Stock_Price:  109.83973513226582
curr_Factors:  [109.83973513]
mat_Sqrt:  [[0.15]]
grads:  [0.28380541]
Stock Position:  0.2838054108376845
Bond Position:  [-12.83883929]


portfolio before change:  [18.41853573]
curr_Stock_Price:  110.13946977983731
curr_Factors:  [110.13946978]
mat_Sqrt:  [[0.15]]
grads:  [-0.08766751]
Stock Position:  -0.08766750703846005
Bond Position:  [28.07418847]


portfolio before change:  [18.43027254]
curr_Stock_Price:  110.02560629995497
curr_Factors:  [110.0256063]
mat_Sqrt:  [[0.15]]
grads:  [-0.67218189]
Stock Position:  -0.6721818851677661
Bond Position:  [92.387492]


portfolio before change:  [18.50048983]
curr_Stock_Price:  109.92973510046609
curr_Factors:  [109.9297351]
mat_Sqrt:  [[0.15]]
grads:  [-0.22939137]
Stock Position:  -0.22939137009337035
Bond Position:  [43.71742238]


portfolio before change:  [18.43135723]
curr_Stock_Price:  110.24302072232696
curr_Factors:  [110.24302072]
mat_Sqrt:  [[0.15]]
grads:  [-0.00775488]
Stock Position:  -0.007754877181818896
Bond Position:  [19.28627832]


portfolio before change:  [18.42948557]
curr_Stock_Price:  110.63981500914616
curr_Factors:  [110.63981501]
mat_Sqrt:  [[0.15]]
grads:  [-0.10655635]
Stock Position:  -0.1065563511708346
Bond Position:  [30.21886055]


portfolio before change:  [18.4537194]
curr_Stock_Price:  110.43011295495265
curr_Factors:  [110.43011295]
mat_Sqrt:  [[0.15]]
grads:  [-0.10941928]
Stock Position:  -0.10941927650201992
Bond Position:  [30.53690246]


portfolio before change:  [18.57308992]
curr_Stock_Price:  109.35661010094258
curr_Factors:  [109.3566101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01686075]
Stock Position:  -0.016860745968642617
Bond Position:  [20.41692394]


portfolio before change:  [18.58023158]
curr_Stock_Price:  109.00872742744315
curr_Factors:  [109.00872743]
mat_Sqrt:  [[0.15]]
grads:  [-0.01889037]
Stock Position:  -0.018890373391798138
Bond Position:  [20.63944714]


portfolio before change:  [18.58238466]
curr_Stock_Price:  108.96303874145136
curr_Factors:  [108.96303874]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258697]
Stock Position:  -0.05258696733948266
Bond Position:  [24.31242042]


portfolio before change:  [18.59977159]
curr_Stock_Price:  108.66130311741183
curr_Factors:  [108.66130312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04616517]
Stock Position:  -0.04616517384599992
Bond Position:  [23.61613954]


portfolio before change:  [18.60951633]
curr_Stock_Price:  108.48219240398574
curr_Factors:  [108.4821924]
mat_Sqrt:  [[0.15]]
grads:  [-0.10897215]
Stock Position:  -0.10897215093898646
Bond Position:  [30.43105417]


portfolio before change:  [18.60981448]
curr_Stock_Price:  108.49691031194375
curr_Factors:  [108.49691031]
mat_Sqrt:  [[0.15]]
grads:  [-0.00312662]
Stock Position:  -0.0031266187013578952
Bond Position:  [18.94904295]


portfolio before change:  [18.61269373]
curr_Stock_Price:  107.95482494470518
curr_Factors:  [107.95482494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04120102]
Stock Position:  -0.04120101565854371
Bond Position:  [23.06054216]


portfolio before change:  [18.6243998]
curr_Stock_Price:  107.70568686881373
curr_Factors:  [107.70568687]
mat_Sqrt:  [[0.15]]
grads:  [0.18262568]
Stock Position:  0.1826256800521471
Bond Position:  [-1.04542451]


portfolio before change:  [18.47415308]
curr_Stock_Price:  106.88334150247749
curr_Factors:  [106.8833415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00338729]
Stock Position:  -0.0033872859588283608
Bond Position:  [18.83619752]


portfolio before change:  [18.47742391]
curr_Stock_Price:  106.26528633800548
curr_Factors:  [106.26528634]
mat_Sqrt:  [[0.15]]
grads:  [0.10703431]
Stock Position:  0.10703431132701334
Bond Position:  [7.10339217]


portfolio before change:  [18.50012838]
curr_Stock_Price:  106.47326172514735
curr_Factors:  [106.47326173]
mat_Sqrt:  [[0.15]]
grads:  [0.05460274]
Stock Position:  0.05460274469830848
Bond Position:  [12.68639606]


portfolio before change:  [18.48867123]
curr_Stock_Price:  106.24891262993216
curr_Factors:  [106.24891263]
mat_Sqrt:  [[0.15]]
grads:  [0.07521961]
Stock Position:  0.07521961434508324
Bond Position:  [10.496669]


portfolio before change:  [18.51871605]
curr_Stock_Price:  106.63961857987363
curr_Factors:  [106.63961858]
mat_Sqrt:  [[0.15]]
grads:  [0.03816837]
Stock Position:  0.03816836574693758
Bond Position:  [14.44845608]


portfolio before change:  [18.51069436]
curr_Stock_Price:  106.40579304826983
curr_Factors:  [106.40579305]
mat_Sqrt:  [[0.15]]
grads:  [-0.09903131]
Stock Position:  -0.09903131309417976
Bond Position:  [29.04819977]


portfolio before change:  [18.49646868]
curr_Stock_Price:  106.56777469466297
curr_Factors:  [106.56777469]
mat_Sqrt:  [[0.15]]
grads:  [-0.21547875]
Stock Position:  -0.2154787452293546
Bond Position:  [41.45955905]


portfolio before change:  [18.67902494]
curr_Stock_Price:  105.73258812745877
curr_Factors:  [105.73258813]
mat_Sqrt:  [[0.15]]
grads:  [0.00492551]
Stock Position:  0.0049255091945933594
Bond Position:  [18.1582381]


portfolio before change:  [18.6783002]
curr_Stock_Price:  105.35503027123153
curr_Factors:  [105.35503027]
mat_Sqrt:  [[0.15]]
grads:  [-0.00825944]
Stock Position:  -0.008259439575561666
Bond Position:  [19.5484737]


portfolio before change:  [18.6756678]
curr_Stock_Price:  105.8216733079511
curr_Factors:  [105.82167331]
mat_Sqrt:  [[0.15]]
grads:  [-0.15178855]
Stock Position:  -0.15178855469466063
Bond Position:  [34.73818665]


portfolio before change:  [18.6239721]
curr_Stock_Price:  106.17655453940061
curr_Factors:  [106.17655454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03269281]
Stock Position:  -0.03269280570746667
Bond Position:  [22.09518157]


portfolio before change:  [18.60096627]
curr_Stock_Price:  106.92249305562427
curr_Factors:  [106.92249306]
mat_Sqrt:  [[0.15]]
grads:  [0.11538776]
Stock Position:  0.1153877601228427
Bond Position:  [6.26341929]


portfolio before change:  [18.61198498]
curr_Stock_Price:  107.01459327480991
curr_Factors:  [107.01459327]
mat_Sqrt:  [[0.15]]
grads:  [0.26911099]
Stock Position:  0.26911098728885346
Bond Position:  [-10.18681787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.49975762]
Stock Price:  106.59992918597891
PL:  [11.89982844]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.90298171e-03]
 [ 4.83635447e-02]
 [ 2.04099660e-02]
 [-9.17753994e-03]
 [ 8.58477083e-03]
 [-1.17781416e-03]
 [-3.66868754e-03]
 [-1.69758902e-02]
 [ 9.38978988e-03]
 [ 1.61037256e-03]
 [ 1.44605655e-02]
 [-5.69170767e-03]
 [-1.79028597e-03]
 [ 8.30720330e-03]
 [-7.51898252e-04]
 [ 1.35587583e-02]
 [ 4.13377870e-02]
 [-1.46894198e-02]
 [ 1.88123768e-02]
 [ 2.09690341e-03]
 [-3.98615679e-03]
 [ 4.14141909e-03]
 [ 1.50456433e-02]
 [ 1.74261434e-02]
 [-5.12743674e-03]
 [ 4.52246398e-03]
 [ 1.10519126e-02]
 [ 8.33533467e-03]
 [ 1.56075355e-02]
 [ 2.90085200e-03]
 [-6.85940750e-03]
 [ 1.00087156e-02]
 [ 1.15901124e-02]
 [-1.50104617e-02]
 [-7.79964988e-04]
 [ 1.85187590e-02]
 [ 3.78552762e-03]
 [ 2.90809529e-03]
 [-5.69574212e-02]
 [ 1.23844272e-02]
 [ 7.10770744e-03]
 [-1.20571036e-03]
 [-3.59890393e-03]
 [-3.51723749e-03]
 [ 2.32390692e-02]
 [ 1.37335259e-02]
 [ 1.06607077e-02]
 [ 2.07500976e-03]
 [ 1.44530176e-02]
 [-1.87019255e-03]
 [ 2.36841881e-03]
 [-1.33621739e-02]
 [ 1.34444867e-03]
 [-4.34895633e-03]
 [-1.86221930e-03]
 [-3.34755850e-03]
 [ 1.06604214e-02]
 [-6.03743607e-03]
 [ 5.67934086e-03]
 [-3.76464578e-03]
 [-2.75341801e-03]
 [ 8.24275539e-03]
 [-1.67034972e-02]
 [ 2.86636323e-03]
 [ 2.55906826e-02]
 [ 5.78178216e-03]
 [ 1.51815389e-02]
 [ 6.82610050e-03]
 [ 4.11964037e-03]
 [ 1.89362627e-02]
 [ 5.22468274e-04]
 [-1.54417797e-02]
 [-2.18505040e-03]
 [ 1.08724300e-03]
 [ 4.00487060e-03]
 [-1.68686228e-02]
 [-3.48635776e-03]
 [ 1.27217512e-02]
 [-5.30513003e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.71123298]
curr_Stock_Price:  100.48512373113124
curr_Factors:  [100.48512373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02601988]
Stock Position:  -0.026019878047301454
Bond Position:  [15.32584364]


portfolio before change:  [12.69197847]
curr_Stock_Price:  101.26192979834059
curr_Factors:  [101.2619298]
mat_Sqrt:  [[0.15]]
grads:  [0.32242363]
Stock Position:  0.32242363136991775
Bond Position:  [-19.95726065]


portfolio before change:  [12.58682253]
curr_Stock_Price:  100.93965633693709
curr_Factors:  [100.93965634]
mat_Sqrt:  [[0.15]]
grads:  [0.13606644]
Stock Position:  0.13606643996615728
Bond Position:  [-1.14767716]


portfolio before change:  [12.50847935]
curr_Stock_Price:  100.36441201417648
curr_Factors:  [100.36441201]
mat_Sqrt:  [[0.15]]
grads:  [-0.0611836]
Stock Position:  -0.06118359957429736
Bond Position:  [18.64913534]


portfolio before change:  [12.51100943]
curr_Stock_Price:  100.3421107581459
curr_Factors:  [100.34211076]
mat_Sqrt:  [[0.15]]
grads:  [0.05723181]
Stock Position:  0.057231805543463805
Bond Position:  [6.76824926]


portfolio before change:  [12.56437207]
curr_Stock_Price:  101.2671140751042
curr_Factors:  [101.26711408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785209]
Stock Position:  -0.007852094433046138
Bond Position:  [13.35953101]


portfolio before change:  [12.57101564]
curr_Stock_Price:  100.52736524767185
curr_Factors:  [100.52736525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445792]
Stock Position:  -0.024457916900923797
Bond Position:  [15.02970559]


portfolio before change:  [12.572648]
curr_Stock_Price:  100.4990317746364
curr_Factors:  [100.49903177]
mat_Sqrt:  [[0.15]]
grads:  [-0.1131726]
Stock Position:  -0.113172601534188
Bond Position:  [23.94638488]


portfolio before change:  [12.51744725]
curr_Stock_Price:  101.00001390066284
curr_Factors:  [101.0000139]
mat_Sqrt:  [[0.15]]
grads:  [0.0625986]
Stock Position:  0.06259859920364319
Bond Position:  [6.19498786]


portfolio before change:  [12.48831615]
curr_Stock_Price:  100.52846511224936
curr_Factors:  [100.52846511]
mat_Sqrt:  [[0.15]]
grads:  [0.01073582]
Stock Position:  0.01073581703693198
Bond Position:  [11.40906095]


portfolio before change:  [12.47929651]
curr_Stock_Price:  99.62189846246011
curr_Factors:  [99.62189846]
mat_Sqrt:  [[0.15]]
grads:  [0.09640377]
Stock Position:  0.09640377003249898
Bond Position:  [2.87536992]


portfolio before change:  [12.46829068]
curr_Stock_Price:  99.50587038827567
curr_Factors:  [99.50587039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03794472]
Stock Position:  -0.037944717773474725
Bond Position:  [16.24401285]


portfolio before change:  [12.45245976]
curr_Stock_Price:  99.94983754588242
curr_Factors:  [99.94983755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01193524]
Stock Position:  -0.011935239805266375
Bond Position:  [13.64538504]


portfolio before change:  [12.44827014]
curr_Stock_Price:  100.37232393908198
curr_Factors:  [100.37232394]
mat_Sqrt:  [[0.15]]
grads:  [0.05538136]
Stock Position:  0.055381355329416834
Bond Position:  [6.8895148]


portfolio before change:  [12.42735132]
curr_Stock_Price:  99.98682540673457
curr_Factors:  [99.98682541]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501266]
Stock Position:  -0.00501265501469339
Bond Position:  [12.92855078]


portfolio before change:  [12.42710403]
curr_Stock_Price:  100.19736281169124
curr_Factors:  [100.19736281]
mat_Sqrt:  [[0.15]]
grads:  [0.09039172]
Stock Position:  0.09039172232835116
Bond Position:  [3.37009183]


portfolio before change:  [12.45035074]
curr_Stock_Price:  100.45220999928057
curr_Factors:  [100.45221]
mat_Sqrt:  [[0.15]]
grads:  [0.27558525]
Stock Position:  0.2755852464271861
Bond Position:  [-15.23279631]


portfolio before change:  [12.45597557]
curr_Stock_Price:  100.4760752360692
curr_Factors:  [100.47607524]
mat_Sqrt:  [[0.15]]
grads:  [-0.09792947]
Stock Position:  -0.09792946557614421
Bond Position:  [22.29554392]


portfolio before change:  [12.45519124]
curr_Stock_Price:  100.49831411958924
curr_Factors:  [100.49831412]
mat_Sqrt:  [[0.15]]
grads:  [0.12541585]
Stock Position:  0.1254158456511499
Bond Position:  [-0.14888981]


portfolio before change:  [12.48201424]
curr_Stock_Price:  100.71226082705039
curr_Factors:  [100.71226083]
mat_Sqrt:  [[0.15]]
grads:  [0.01397936]
Stock Position:  0.01397935606048332
Bond Position:  [11.07412169]


portfolio before change:  [12.48455213]
curr_Stock_Price:  100.84429323030318
curr_Factors:  [100.84429323]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657438]
Stock Position:  -0.026574378601253903
Bond Position:  [15.16442655]


portfolio before change:  [12.50427957]
curr_Stock_Price:  100.13761119153803
curr_Factors:  [100.13761119]
mat_Sqrt:  [[0.15]]
grads:  [0.02760946]
Stock Position:  0.027609460613117587
Bond Position:  [9.73953414]


portfolio before change:  [12.5095982]
curr_Stock_Price:  100.30820097203052
curr_Factors:  [100.30820097]
mat_Sqrt:  [[0.15]]
grads:  [0.10030429]
Stock Position:  0.10030428892869253
Bond Position:  [2.44825543]


portfolio before change:  [12.46872896]
curr_Stock_Price:  99.89922288434968
curr_Factors:  [99.89922288]
mat_Sqrt:  [[0.15]]
grads:  [0.11617429]
Stock Position:  0.11617428940647027
Bond Position:  [0.86300773]


portfolio before change:  [12.47640075]
curr_Stock_Price:  99.96479544542098
curr_Factors:  [99.96479545]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418291]
Stock Position:  -0.03418291157816872
Bond Position:  [15.89348851]


portfolio before change:  [12.4869641]
curr_Stock_Price:  99.68483158005694
curr_Factors:  [99.68483158]
mat_Sqrt:  [[0.15]]
grads:  [0.03014976]
Stock Position:  0.03014975984481881
Bond Position:  [9.48149037]


portfolio before change:  [12.45974201]
curr_Stock_Price:  98.7622799928543
curr_Factors:  [98.76227999]
mat_Sqrt:  [[0.15]]
grads:  [0.07367942]
Stock Position:  0.07367941709981463
Bond Position:  [5.18299478]


portfolio before change:  [12.46026163]
curr_Stock_Price:  98.76493583527872
curr_Factors:  [98.76493584]
mat_Sqrt:  [[0.15]]
grads:  [0.0555689]
Stock Position:  0.055568897807312286
Bond Position:  [6.97200301]


portfolio before change:  [12.47712761]
curr_Stock_Price:  99.06060872723695
curr_Factors:  [99.06060873]
mat_Sqrt:  [[0.15]]
grads:  [0.10405024]
Stock Position:  0.10405023686858732
Bond Position:  [2.16984781]


portfolio before change:  [12.49166853]
curr_Stock_Price:  99.19905433473689
curr_Factors:  [99.19905433]
mat_Sqrt:  [[0.15]]
grads:  [0.01933901]
Stock Position:  0.019339013330148792
Bond Position:  [10.5732567]


portfolio before change:  [12.49801426]
curr_Stock_Price:  99.49301344544457
curr_Factors:  [99.49301345]
mat_Sqrt:  [[0.15]]
grads:  [-0.04572938]
Stock Position:  -0.045729383304566405
Bond Position:  [17.04776841]


portfolio before change:  [12.49767223]
curr_Stock_Price:  99.52379348569332
curr_Factors:  [99.52379349]
mat_Sqrt:  [[0.15]]
grads:  [0.06672477]
Stock Position:  0.06672477079182679
Bond Position:  [5.85696992]


portfolio before change:  [12.46199842]
curr_Stock_Price:  98.98366609288851
curr_Factors:  [98.98366609]
mat_Sqrt:  [[0.15]]
grads:  [0.07726742]
Stock Position:  0.07726741572188521
Bond Position:  [4.81378635]


portfolio before change:  [12.45503836]
curr_Stock_Price:  98.8896945666346
curr_Factors:  [98.88969457]
mat_Sqrt:  [[0.15]]
grads:  [-0.10006974]
Stock Position:  -0.10006974438366699
Bond Position:  [22.35090481]


portfolio before change:  [12.47132114]
curr_Stock_Price:  98.74094027803956
curr_Factors:  [98.74094028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00519977]
Stock Position:  -0.005199766588428447
Bond Position:  [12.98475098]


portfolio before change:  [12.47179843]
curr_Stock_Price:  98.8052273439933
curr_Factors:  [98.80522734]
mat_Sqrt:  [[0.15]]
grads:  [0.12345839]
Stock Position:  0.12345839354784713
Bond Position:  [0.27346379]


portfolio before change:  [12.47574022]
curr_Stock_Price:  98.83701693975003
curr_Factors:  [98.83701694]
mat_Sqrt:  [[0.15]]
grads:  [0.02523685]
Stock Position:  0.02523685077786045
Bond Position:  [9.98140517]


portfolio before change:  [12.4901899]
curr_Stock_Price:  99.38485960652903
curr_Factors:  [99.38485961]
mat_Sqrt:  [[0.15]]
grads:  [0.0193873]
Stock Position:  0.019387301961125772
Bond Position:  [10.56338561]


portfolio before change:  [12.50460096]
curr_Stock_Price:  100.09412976526838
curr_Factors:  [100.09412977]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971614]
Stock Position:  -0.37971614128129016
Bond Position:  [50.51195768]


portfolio before change:  [12.38917744]
curr_Stock_Price:  100.4064173085133
curr_Factors:  [100.40641731]
mat_Sqrt:  [[0.15]]
grads:  [0.08256285]
Stock Position:  0.08256284827560294
Bond Position:  [4.09933764]


portfolio before change:  [12.34386128]
curr_Stock_Price:  99.85444531800546
curr_Factors:  [99.85444532]
mat_Sqrt:  [[0.15]]
grads:  [0.04738472]
Stock Position:  0.04738471626237946
Bond Position:  [7.61228672]


portfolio before change:  [12.35879087]
curr_Stock_Price:  100.15947643104646
curr_Factors:  [100.15947643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00803807]
Stock Position:  -0.008038069060675609
Bond Position:  [13.16387966]


portfolio before change:  [12.3538176]
curr_Stock_Price:  100.88055057180274
curr_Factors:  [100.88055057]
mat_Sqrt:  [[0.15]]
grads:  [-0.02399269]
Stock Position:  -0.023992692833405185
Bond Position:  [14.77421366]


portfolio before change:  [12.37228458]
curr_Stock_Price:  100.14934615692904
curr_Factors:  [100.14934616]
mat_Sqrt:  [[0.15]]
grads:  [-0.02344825]
Stock Position:  -0.023448249953473214
Bond Position:  [14.72061148]


portfolio before change:  [12.36636312]
curr_Stock_Price:  100.44111708917914
curr_Factors:  [100.44111709]
mat_Sqrt:  [[0.15]]
grads:  [0.15492713]
Stock Position:  0.15492712807621659
Bond Position:  [-3.19469069]


portfolio before change:  [12.49525613]
curr_Stock_Price:  101.27436486196238
curr_Factors:  [101.27436486]
mat_Sqrt:  [[0.15]]
grads:  [0.09155684]
Stock Position:  0.09155683950854625
Bond Position:  [3.22289536]


portfolio before change:  [12.52209308]
curr_Stock_Price:  101.5652825889626
curr_Factors:  [101.56528259]
mat_Sqrt:  [[0.15]]
grads:  [0.07107138]
Stock Position:  0.07107138449760671
Bond Position:  [5.30370783]


portfolio before change:  [12.52141808]
curr_Stock_Price:  101.55112086001375
curr_Factors:  [101.55112086]
mat_Sqrt:  [[0.15]]
grads:  [0.0138334]
Stock Position:  0.013833398409652647
Bond Position:  [11.11662096]


portfolio before change:  [12.52361609]
curr_Stock_Price:  101.65978535226213
curr_Factors:  [101.65978535]
mat_Sqrt:  [[0.15]]
grads:  [0.09635345]
Stock Position:  0.09635345096575544
Bond Position:  [2.72834494]


portfolio before change:  [12.39578741]
curr_Stock_Price:  100.331351296345
curr_Factors:  [100.3313513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01246795]
Stock Position:  -0.012467950364911584
Bond Position:  [13.64671372]


portfolio before change:  [12.39591284]
curr_Stock_Price:  100.389702478118
curr_Factors:  [100.38970248]
mat_Sqrt:  [[0.15]]
grads:  [0.01578946]
Stock Position:  0.015789458735252136
Bond Position:  [10.81081377]


portfolio before change:  [12.42190353]
curr_Stock_Price:  101.9929869348811
curr_Factors:  [101.99298693]
mat_Sqrt:  [[0.15]]
grads:  [-0.08908116]
Stock Position:  -0.08908115914081768
Bond Position:  [21.50755703]


portfolio before change:  [12.45131384]
curr_Stock_Price:  101.67792540443368
curr_Factors:  [101.6779254]
mat_Sqrt:  [[0.15]]
grads:  [0.00896299]
Stock Position:  0.00896299110026673
Bond Position:  [11.5399755]


portfolio before change:  [12.45329049]
curr_Stock_Price:  101.81798804219711
curr_Factors:  [101.81798804]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899304]
Stock Position:  -0.02899304218583606
Bond Position:  [15.40530371]


portfolio before change:  [12.43456297]
curr_Stock_Price:  102.49712964757343
curr_Factors:  [102.49712965]
mat_Sqrt:  [[0.15]]
grads:  [-0.0124148]
Stock Position:  -0.01241479531038459
Bond Position:  [13.70704385]


portfolio before change:  [12.44330528]
curr_Stock_Price:  101.86195257867747
curr_Factors:  [101.86195258]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231706]
Stock Position:  -0.022317056689789054
Bond Position:  [14.71656425]


portfolio before change:  [12.43123884]
curr_Stock_Price:  102.44385052431791
curr_Factors:  [102.44385052]
mat_Sqrt:  [[0.15]]
grads:  [0.07106948]
Stock Position:  0.07106947583210349
Bond Position:  [5.15060808]


portfolio before change:  [12.38946007]
curr_Stock_Price:  101.85146260651838
curr_Factors:  [101.85146261]
mat_Sqrt:  [[0.15]]
grads:  [-0.04024957]
Stock Position:  -0.04024957381634553
Bond Position:  [16.48893803]


portfolio before change:  [12.3611176]
curr_Stock_Price:  102.58123567005039
curr_Factors:  [102.58123567]
mat_Sqrt:  [[0.15]]
grads:  [0.03786227]
Stock Position:  0.03786227240546276
Bond Position:  [8.47715892]


portfolio before change:  [12.3797096]
curr_Stock_Price:  103.05828457318046
curr_Factors:  [103.05828457]
mat_Sqrt:  [[0.15]]
grads:  [-0.02509764]
Stock Position:  -0.025097638533943405
Bond Position:  [14.96622917]


portfolio before change:  [12.391721]
curr_Stock_Price:  102.616968771592
curr_Factors:  [102.61696877]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835612]
Stock Position:  -0.018356120087735704
Bond Position:  [14.2753704]


portfolio before change:  [12.3986479]
curr_Stock_Price:  102.28821412434998
curr_Factors:  [102.28821412]
mat_Sqrt:  [[0.15]]
grads:  [0.0549517]
Stock Position:  0.054951702598680194
Bond Position:  [6.77773638]


portfolio before change:  [12.40058452]
curr_Stock_Price:  102.3157473558879
curr_Factors:  [102.31574736]
mat_Sqrt:  [[0.15]]
grads:  [-0.11135665]
Stock Position:  -0.11135664814205494
Bond Position:  [23.7941232]


portfolio before change:  [12.33861413]
curr_Stock_Price:  102.88560621443543
curr_Factors:  [102.88560621]
mat_Sqrt:  [[0.15]]
grads:  [0.01910909]
Stock Position:  0.01910908817331441
Bond Position:  [10.37256401]


portfolio before change:  [12.31792761]
curr_Stock_Price:  101.76913100309375
curr_Factors:  [101.769131]
mat_Sqrt:  [[0.15]]
grads:  [0.17060455]
Stock Position:  0.17060455086182794
Bond Position:  [-5.04434928]


portfolio before change:  [12.35036768]
curr_Stock_Price:  101.96112677598991
curr_Factors:  [101.96112678]
mat_Sqrt:  [[0.15]]
grads:  [0.03854521]
Stock Position:  0.038545214403320656
Bond Position:  [8.42025419]


portfolio before change:  [12.37843685]
curr_Stock_Price:  102.67568738974278
curr_Factors:  [102.67568739]
mat_Sqrt:  [[0.15]]
grads:  [0.10121026]
Stock Position:  0.10121025939375436
Bond Position:  [1.9866039]


portfolio before change:  [12.37586693]
curr_Stock_Price:  102.64906867518819
curr_Factors:  [102.64906868]
mat_Sqrt:  [[0.15]]
grads:  [0.04550734]
Stock Position:  0.04550733667424011
Bond Position:  [7.70458121]


portfolio before change:  [12.36040665]
curr_Stock_Price:  102.29875515172553
curr_Factors:  [102.29875515]
mat_Sqrt:  [[0.15]]
grads:  [0.02746427]
Stock Position:  0.027464269119211147
Bond Position:  [9.55084611]


portfolio before change:  [12.35182327]
curr_Stock_Price:  101.96449078072241
curr_Factors:  [101.96449078]
mat_Sqrt:  [[0.15]]
grads:  [0.12624175]
Stock Position:  0.12624175114245292
Bond Position:  [-0.5203526]


portfolio before change:  [12.29817454]
curr_Stock_Price:  101.53978024680322
curr_Factors:  [101.53978025]
mat_Sqrt:  [[0.15]]
grads:  [0.00348312]
Stock Position:  0.0034831218296975503
Bond Position:  [11.94449912]


portfolio before change:  [12.30339742]
curr_Stock_Price:  102.82492580859841
curr_Factors:  [102.82492581]
mat_Sqrt:  [[0.15]]
grads:  [-0.1029452]
Stock Position:  -0.10294519790136997
Bond Position:  [22.88872975]


portfolio before change:  [12.3006475]
curr_Stock_Price:  102.86553482707536
curr_Factors:  [102.86553483]
mat_Sqrt:  [[0.15]]
grads:  [-0.014567]
Stock Position:  -0.014567002664506886
Bond Position:  [13.79909002]


portfolio before change:  [12.29273686]
curr_Stock_Price:  103.46779400465732
curr_Factors:  [103.467794]
mat_Sqrt:  [[0.15]]
grads:  [0.00724829]
Stock Position:  0.0072482866879975145
Bond Position:  [11.54277263]


portfolio before change:  [12.28933854]
curr_Stock_Price:  102.8994163069979
curr_Factors:  [102.89941631]
mat_Sqrt:  [[0.15]]
grads:  [0.02669914]
Stock Position:  0.026699137360551725
Bond Position:  [9.54201289]


portfolio before change:  [12.30000121]
curr_Stock_Price:  103.2764425027106
curr_Factors:  [103.2764425]
mat_Sqrt:  [[0.15]]
grads:  [-0.11245749]
Stock Position:  -0.11245748537196415
Bond Position:  [23.91421024]


portfolio before change:  [12.30107078]
curr_Stock_Price:  103.28022276661515
curr_Factors:  [103.28022277]
mat_Sqrt:  [[0.15]]
grads:  [-0.02324239]
Stock Position:  -0.023242385037515856
Bond Position:  [14.70154948]


portfolio before change:  [12.30564229]
curr_Stock_Price:  103.1230686125057
curr_Factors:  [103.12306861]
mat_Sqrt:  [[0.15]]
grads:  [0.08481167]
Stock Position:  0.08481167490011626
Bond Position:  [3.55960212]


portfolio before change:  [12.37103139]
curr_Stock_Price:  103.89143701578946
curr_Factors:  [103.89143702]
mat_Sqrt:  [[0.15]]
grads:  [-0.03536753]
Stock Position:  -0.035367533538114976
Bond Position:  [16.04541527]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.33105894]
Stock Price:  105.04999443945421
PL:  [7.2810645]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.02938095e-03]
 [-2.00029897e-02]
 [ 2.80943644e-02]
 [-1.20659858e-02]
 [ 1.09909529e-02]
 [-1.47359990e-02]
 [-1.32014210e-02]
 [ 1.67567682e-02]
 [-1.91421702e-02]
 [-1.29157139e-02]
 [ 1.08868602e-02]
 [-6.95462243e-03]
 [ 9.99446949e-04]
 [-3.97531734e-03]
 [-1.88678459e-03]
 [ 4.29722116e-03]
 [-2.17357064e-02]
 [-1.24470091e-02]
 [ 2.48953977e-02]
 [-1.38845018e-03]
 [-6.01420581e-03]
 [ 5.44936936e-03]
 [ 1.82072599e-02]
 [ 1.78347508e-02]
 [-6.09975030e-03]
 [ 4.52178477e-03]
 [ 1.55717102e-04]
 [ 7.03373268e-03]
 [ 2.89371622e-02]
 [-2.44861341e-03]
 [-2.92088952e-03]
 [ 1.34919752e-02]
 [ 1.27822666e-02]
 [ 9.00518415e-03]
 [ 5.59779100e-03]
 [ 1.21421677e-02]
 [-2.77166970e-02]
 [-1.29868966e-03]
 [-3.95613542e-02]
 [-1.16335987e-02]
 [ 4.20322355e-03]
 [ 1.02142404e-02]
 [-4.33238531e-03]
 [-4.13708068e-03]
 [ 1.39411610e-02]
 [ 1.38806217e-02]
 [ 1.06613058e-02]
 [ 1.39920037e-04]
 [ 1.56220178e-02]
 [-1.19760594e-03]
 [ 2.19082555e-02]
 [ 2.68752308e-04]
 [-7.65963790e-04]
 [-1.28207405e-02]
 [-1.61997260e-03]
 [-3.13266392e-03]
 [ 9.28454063e-03]
 [-1.83317588e-02]
 [ 4.52971640e-03]
 [-3.45498203e-03]
 [-4.48126457e-03]
 [ 5.71558180e-03]
 [-1.96381387e-02]
 [ 2.95016967e-03]
 [ 2.38110674e-02]
 [ 7.33470977e-03]
 [ 1.42976784e-02]
 [ 9.68164317e-03]
 [ 6.59224663e-03]
 [ 1.35925405e-02]
 [ 1.48327245e-03]
 [-1.52591842e-02]
 [-6.83164941e-03]
 [ 8.47966009e-04]
 [ 2.14085884e-03]
 [-2.12236798e-02]
 [-4.32085382e-03]
 [ 1.26608342e-02]
 [ 2.70083518e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.55473522]
curr_Stock_Price:  100.29634412060425
curr_Factors:  [100.29634412]
mat_Sqrt:  [[0.15]]
grads:  [-0.02019587]
Stock Position:  -0.02019587302804937
Bond Position:  [10.58030745]


portfolio before change:  [8.58379158]
curr_Stock_Price:  98.89036009805717
curr_Factors:  [98.8903601]
mat_Sqrt:  [[0.15]]
grads:  [-0.13335326]
Stock Position:  -0.1333532645516404
Bond Position:  [21.77114393]


portfolio before change:  [8.5626973]
curr_Stock_Price:  99.05874759570206
curr_Factors:  [99.0587476]
mat_Sqrt:  [[0.15]]
grads:  [0.18729576]
Stock Position:  0.18729576240502113
Bond Position:  [-9.99058636]


portfolio before change:  [8.44166036]
curr_Stock_Price:  98.41584726230062
curr_Factors:  [98.41584726]
mat_Sqrt:  [[0.15]]
grads:  [-0.08043991]
Stock Position:  -0.0804399052388141
Bond Position:  [16.35822179]


portfolio before change:  [8.44757053]
curr_Stock_Price:  98.3550845007738
curr_Factors:  [98.3550845]
mat_Sqrt:  [[0.15]]
grads:  [0.07327302]
Stock Position:  0.07327301956162725
Bond Position:  [1.2407965]


portfolio before change:  [8.45863872]
curr_Stock_Price:  98.50508015914089
curr_Factors:  [98.50508016]
mat_Sqrt:  [[0.15]]
grads:  [-0.09823999]
Stock Position:  -0.09823999356192863
Bond Position:  [18.13577716]


portfolio before change:  [8.44502619]
curr_Stock_Price:  98.65518246857677
curr_Factors:  [98.65518247]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800947]
Stock Position:  -0.0880094731847036
Bond Position:  [17.12761682]


portfolio before change:  [8.42432872]
curr_Stock_Price:  98.90251923255778
curr_Factors:  [98.90251923]
mat_Sqrt:  [[0.15]]
grads:  [0.11171179]
Stock Position:  0.11171178777950211
Bond Position:  [-2.62424852]


portfolio before change:  [8.38963985]
curr_Stock_Price:  98.59346634712918
curr_Factors:  [98.59346635]
mat_Sqrt:  [[0.15]]
grads:  [-0.12761447]
Stock Position:  -0.12761446813869787
Bond Position:  [20.97159262]


portfolio before change:  [8.42055468]
curr_Stock_Price:  98.36148585931335
curr_Factors:  [98.36148586]
mat_Sqrt:  [[0.15]]
grads:  [-0.08610476]
Stock Position:  -0.08610475953936676
Bond Position:  [16.88994677]


portfolio before change:  [8.4065421]
curr_Stock_Price:  98.53648474902225
curr_Factors:  [98.53648475]
mat_Sqrt:  [[0.15]]
grads:  [0.07257907]
Stock Position:  0.07257906786212096
Bond Position:  [1.25485588]


portfolio before change:  [8.39173491]
curr_Stock_Price:  98.33138957087753
curr_Factors:  [98.33138957]
mat_Sqrt:  [[0.15]]
grads:  [-0.04636415]
Stock Position:  -0.04636414953191376
Bond Position:  [12.95078616]


portfolio before change:  [8.38192868]
curr_Stock_Price:  98.56035281579403
curr_Factors:  [98.56035282]
mat_Sqrt:  [[0.15]]
grads:  [0.00666298]
Stock Position:  0.006662979661747436
Bond Position:  [7.72522305]


portfolio before change:  [8.37841994]
curr_Stock_Price:  97.96128556503834
curr_Factors:  [97.96128557]
mat_Sqrt:  [[0.15]]
grads:  [-0.02650212]
Stock Position:  -0.02650211562823357
Bond Position:  [10.97460126]


portfolio before change:  [8.37754982]
curr_Stock_Price:  98.02000004369332
curr_Factors:  [98.02000004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01257856]
Stock Position:  -0.012578563918323946
Bond Position:  [9.61050066]


portfolio before change:  [8.38025391]
curr_Stock_Price:  97.85277764880128
curr_Factors:  [97.85277765]
mat_Sqrt:  [[0.15]]
grads:  [0.02864814]
Stock Position:  0.02864814105243185
Bond Position:  [5.57695374]


portfolio before change:  [8.37870473]
curr_Stock_Price:  97.78653414137077
curr_Factors:  [97.78653414]
mat_Sqrt:  [[0.15]]
grads:  [-0.14490471]
Stock Position:  -0.14490470928379384
Bond Position:  [22.54843403]


portfolio before change:  [8.35552918]
curr_Stock_Price:  97.95619643990187
curr_Factors:  [97.95619644]
mat_Sqrt:  [[0.15]]
grads:  [-0.08298006]
Stock Position:  -0.08298006051876165
Bond Position:  [16.48394029]


portfolio before change:  [8.35132635]
curr_Stock_Price:  98.01926109442638
curr_Factors:  [98.01926109]
mat_Sqrt:  [[0.15]]
grads:  [0.16596932]
Stock Position:  0.16596931783035063
Bond Position:  [-7.91686354]


portfolio before change:  [8.38563501]
curr_Stock_Price:  98.22895934134625
curr_Factors:  [98.22895934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00925633]
Stock Position:  -0.009256334551704487
Bond Position:  [9.29487512]


portfolio before change:  [8.38333059]
curr_Stock_Price:  98.54067720877502
curr_Factors:  [98.54067721]
mat_Sqrt:  [[0.15]]
grads:  [-0.04009471]
Stock Position:  -0.040094705385236566
Bond Position:  [12.33429001]


portfolio before change:  [8.38961943]
curr_Stock_Price:  98.40305505143597
curr_Factors:  [98.40305505]
mat_Sqrt:  [[0.15]]
grads:  [0.03632913]
Stock Position:  0.03632912905380941
Bond Position:  [4.81472214]


portfolio before change:  [8.41264765]
curr_Stock_Price:  99.02864913470694
curr_Factors:  [99.02864913]
mat_Sqrt:  [[0.15]]
grads:  [0.12138173]
Stock Position:  0.12138173285068679
Bond Position:  [-3.60762139]


portfolio before change:  [8.43982892]
curr_Stock_Price:  99.25443894585906
curr_Factors:  [99.25443895]
mat_Sqrt:  [[0.15]]
grads:  [0.11889834]
Stock Position:  0.11889833882268912
Bond Position:  [-3.36135899]


portfolio before change:  [8.47353179]
curr_Stock_Price:  99.53966546941123
curr_Factors:  [99.53966547]
mat_Sqrt:  [[0.15]]
grads:  [-0.040665]
Stock Position:  -0.04066500201270976
Bond Position:  [12.52131249]


portfolio before change:  [8.47641123]
curr_Stock_Price:  99.488101962603
curr_Factors:  [99.48810196]
mat_Sqrt:  [[0.15]]
grads:  [0.03014523]
Stock Position:  0.030145231822716532
Bond Position:  [5.47731933]


portfolio before change:  [8.49713579]
curr_Stock_Price:  100.16423606941258
curr_Factors:  [100.16423607]
mat_Sqrt:  [[0.15]]
grads:  [0.00103811]
Stock Position:  0.0010381140121609503
Bond Position:  [8.39315389]


portfolio before change:  [8.49851609]
curr_Stock_Price:  100.98853346762306
curr_Factors:  [100.98853347]
mat_Sqrt:  [[0.15]]
grads:  [0.04689155]
Stock Position:  0.046891551193414496
Bond Position:  [3.76300711]


portfolio before change:  [8.54128344]
curr_Stock_Price:  101.89556568102049
curr_Factors:  [101.89556568]
mat_Sqrt:  [[0.15]]
grads:  [0.19291441]
Stock Position:  0.19291441470965792
Bond Position:  [-11.11583998]


portfolio before change:  [8.50954261]
curr_Stock_Price:  101.73463387905606
curr_Factors:  [101.73463388]
mat_Sqrt:  [[0.15]]
grads:  [-0.01632409]
Stock Position:  -0.016324089375803624
Bond Position:  [10.17026787]


portfolio before change:  [8.50831116]
curr_Stock_Price:  101.84901184774483
curr_Factors:  [101.84901185]
mat_Sqrt:  [[0.15]]
grads:  [-0.0194726]
Stock Position:  -0.019472596815941167
Bond Position:  [10.4915759]


portfolio before change:  [8.50807807]
curr_Stock_Price:  101.894657209715
curr_Factors:  [101.89465721]
mat_Sqrt:  [[0.15]]
grads:  [0.0899465]
Stock Position:  0.089946501526861
Bond Position:  [-0.65698987]


portfolio before change:  [8.47618117]
curr_Stock_Price:  101.54049299756203
curr_Factors:  [101.540493]
mat_Sqrt:  [[0.15]]
grads:  [0.08521511]
Stock Position:  0.08521511077260949
Bond Position:  [-0.17660319]


portfolio before change:  [8.43987264]
curr_Stock_Price:  101.11454163221738
curr_Factors:  [101.11454163]
mat_Sqrt:  [[0.15]]
grads:  [0.06003456]
Stock Position:  0.06003456096899116
Bond Position:  [2.36950553]


portfolio before change:  [8.41043728]
curr_Stock_Price:  100.62176783111319
curr_Factors:  [100.62176783]
mat_Sqrt:  [[0.15]]
grads:  [0.03731861]
Stock Position:  0.03731860665900845
Bond Position:  [4.65537311]


portfolio before change:  [8.40715867]
curr_Stock_Price:  100.52611637888084
curr_Factors:  [100.52611638]
mat_Sqrt:  [[0.15]]
grads:  [0.08094778]
Stock Position:  0.08094778488251297
Bond Position:  [0.26979223]


portfolio before change:  [8.45105851]
curr_Stock_Price:  101.06823093195337
curr_Factors:  [101.06823093]
mat_Sqrt:  [[0.15]]
grads:  [-0.18477798]
Stock Position:  -0.18477797978221955
Bond Position:  [27.12624204]


portfolio before change:  [8.25908182]
curr_Stock_Price:  102.11636520360396
curr_Factors:  [102.1163652]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865793]
Stock Position:  -0.008657931077621495
Bond Position:  [9.14319827]


portfolio before change:  [8.26265952]
curr_Stock_Price:  101.76914218137166
curr_Factors:  [101.76914218]
mat_Sqrt:  [[0.15]]
grads:  [-0.26374236]
Stock Position:  -0.26374236128114853
Bond Position:  [35.10349338]


portfolio before change:  [8.19961899]
curr_Stock_Price:  102.01648418974013
curr_Factors:  [102.01648419]
mat_Sqrt:  [[0.15]]
grads:  [-0.07755732]
Stock Position:  -0.07755732497301425
Bond Position:  [16.11174461]


portfolio before change:  [8.2129539]
curr_Stock_Price:  101.85753218110105
curr_Factors:  [101.85753218]
mat_Sqrt:  [[0.15]]
grads:  [0.02802149]
Stock Position:  0.0280214903593876
Bond Position:  [5.35875404]


portfolio before change:  [8.21950395]
curr_Stock_Price:  102.07933060957211
curr_Factors:  [102.07933061]
mat_Sqrt:  [[0.15]]
grads:  [0.06809494]
Stock Position:  0.06809493630038213
Bond Position:  [1.26841844]


portfolio before change:  [8.18033245]
curr_Stock_Price:  101.50291801867627
curr_Factors:  [101.50291802]
mat_Sqrt:  [[0.15]]
grads:  [-0.02888257]
Stock Position:  -0.028882568712026078
Bond Position:  [11.11199746]


portfolio before change:  [8.17642991]
curr_Stock_Price:  101.66208201817288
curr_Factors:  [101.66208202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758054]
Stock Position:  -0.02758053785369579
Bond Position:  [10.98032481]


portfolio before change:  [8.18026301]
curr_Stock_Price:  101.54798685874769
curr_Factors:  [101.54798686]
mat_Sqrt:  [[0.15]]
grads:  [0.09294107]
Stock Position:  0.09294107318723549
Bond Position:  [-1.25771587]


portfolio before change:  [8.14525389]
curr_Stock_Price:  101.17215183708672
curr_Factors:  [101.17215184]
mat_Sqrt:  [[0.15]]
grads:  [0.09253748]
Stock Position:  0.09253747786625559
Bond Position:  [-1.21696188]


portfolio before change:  [8.18097358]
curr_Stock_Price:  101.55897631728114
curr_Factors:  [101.55897632]
mat_Sqrt:  [[0.15]]
grads:  [0.07107537]
Stock Position:  0.07107537170247895
Bond Position:  [0.96263159]


portfolio before change:  [8.21968873]
curr_Stock_Price:  102.10283530021673
curr_Factors:  [102.1028353]
mat_Sqrt:  [[0.15]]
grads:  [0.0009328]
Stock Position:  0.0009328002446959098
Bond Position:  [8.12444718]


portfolio before change:  [8.220317]
curr_Stock_Price:  102.23199099784327
curr_Factors:  [102.231991]
mat_Sqrt:  [[0.15]]
grads:  [0.10414679]
Stock Position:  0.10414678565837823
Bond Position:  [-2.42681625]


portfolio before change:  [8.30582438]
curr_Stock_Price:  103.05447493471824
curr_Factors:  [103.05447493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00798404]
Stock Position:  -0.007984039575488306
Bond Position:  [9.12861538]


portfolio before change:  [8.30887813]
curr_Stock_Price:  102.74345450060612
curr_Factors:  [102.7434545]
mat_Sqrt:  [[0.15]]
grads:  [0.14605504]
Stock Position:  0.14605503644574616
Bond Position:  [-6.69732086]


portfolio before change:  [8.39859075]
curr_Stock_Price:  103.36055891953573
curr_Factors:  [103.36055892]
mat_Sqrt:  [[0.15]]
grads:  [0.00179168]
Stock Position:  0.0017916820534871643
Bond Position:  [8.21340149]


portfolio before change:  [8.39827754]
curr_Stock_Price:  102.89922635463334
curr_Factors:  [102.89922635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00510643]
Stock Position:  -0.0051064252678548125
Bond Position:  [8.92372475]


portfolio before change:  [8.39949753]
curr_Stock_Price:  102.76953867119448
curr_Factors:  [102.76953867]
mat_Sqrt:  [[0.15]]
grads:  [-0.0854716]
Stock Position:  -0.08547160315171813
Bond Position:  [17.18337476]


portfolio before change:  [8.41590299]
curr_Stock_Price:  102.5901636605943
curr_Factors:  [102.59016366]
mat_Sqrt:  [[0.15]]
grads:  [-0.01079982]
Stock Position:  -0.010799817329132697
Bond Position:  [9.52385802]


portfolio before change:  [8.41397732]
curr_Stock_Price:  102.82358722808056
curr_Factors:  [102.82358723]
mat_Sqrt:  [[0.15]]
grads:  [-0.02088443]
Stock Position:  -0.02088442611688246
Bond Position:  [10.56138893]


portfolio before change:  [8.3957167]
curr_Stock_Price:  103.72956028340336
curr_Factors:  [103.72956028]
mat_Sqrt:  [[0.15]]
grads:  [0.06189694]
Stock Position:  0.06189693755285387
Bond Position:  [1.97517459]


portfolio before change:  [8.40578796]
curr_Stock_Price:  103.89027589431511
curr_Factors:  [103.89027589]
mat_Sqrt:  [[0.15]]
grads:  [-0.12221173]
Stock Position:  -0.12221172553260272
Bond Position:  [21.10239784]


portfolio before change:  [8.45650702]
curr_Stock_Price:  103.48605834416017
curr_Factors:  [103.48605834]
mat_Sqrt:  [[0.15]]
grads:  [0.03019811]
Stock Position:  0.030198109356072318
Bond Position:  [5.33142372]


portfolio before change:  [8.47754978]
curr_Stock_Price:  104.17184748025629
curr_Factors:  [104.17184748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303321]
Stock Position:  -0.023033213515327552
Bond Position:  [10.87696219]


portfolio before change:  [8.48433787]
curr_Stock_Price:  103.90665394205688
curr_Factors:  [103.90665394]
mat_Sqrt:  [[0.15]]
grads:  [-0.0298751]
Stock Position:  -0.02987509714064508
Bond Position:  [11.58855925]


portfolio before change:  [8.49020081]
curr_Stock_Price:  103.73465017485626
curr_Factors:  [103.73465017]
mat_Sqrt:  [[0.15]]
grads:  [0.03810388]
Stock Position:  0.03810387867288322
Bond Position:  [4.53750829]


portfolio before change:  [8.48536288]
curr_Stock_Price:  103.60024036975805
curr_Factors:  [103.60024037]
mat_Sqrt:  [[0.15]]
grads:  [-0.13092092]
Stock Position:  -0.1309209245656866
Bond Position:  [22.04880213]


portfolio before change:  [8.58535083]
curr_Stock_Price:  102.84703870833648
curr_Factors:  [102.84703871]
mat_Sqrt:  [[0.15]]
grads:  [0.0196678]
Stock Position:  0.019667797831508023
Bond Position:  [6.56257607]


portfolio before change:  [8.58030444]
curr_Stock_Price:  102.56960219453973
curr_Factors:  [102.56960219]
mat_Sqrt:  [[0.15]]
grads:  [0.15874045]
Stock Position:  0.1587404496591557
Bond Position:  [-7.70164033]


portfolio before change:  [8.58268578]
curr_Stock_Price:  102.58763606487693
curr_Factors:  [102.58763606]
mat_Sqrt:  [[0.15]]
grads:  [0.04889807]
Stock Position:  0.048898065140407516
Bond Position:  [3.56634887]


portfolio before change:  [8.6013711]
curr_Stock_Price:  102.96520560402232
curr_Factors:  [102.9652056]
mat_Sqrt:  [[0.15]]
grads:  [0.09531786]
Stock Position:  0.09531785611023114
Bond Position:  [-1.21305155]


portfolio before change:  [8.67590014]
curr_Stock_Price:  103.74790111360875
curr_Factors:  [103.74790111]
mat_Sqrt:  [[0.15]]
grads:  [0.06454429]
Stock Position:  0.0645442878026965
Bond Position:  [1.97956575]


portfolio before change:  [8.68264999]
curr_Stock_Price:  103.85056130071064
curr_Factors:  [103.8505613]
mat_Sqrt:  [[0.15]]
grads:  [0.04394831]
Stock Position:  0.04394831087167303
Bond Position:  [4.11859324]


portfolio before change:  [8.65774001]
curr_Stock_Price:  103.27790198412036
curr_Factors:  [103.27790198]
mat_Sqrt:  [[0.15]]
grads:  [0.09061694]
Stock Position:  0.09061693689700673
Bond Position:  [-0.70098712]


portfolio before change:  [8.72585279]
curr_Stock_Price:  104.03004174239123
curr_Factors:  [104.03004174]
mat_Sqrt:  [[0.15]]
grads:  [0.00988848]
Stock Position:  0.009888482979346703
Bond Position:  [7.6971535]


portfolio before change:  [8.72838861]
curr_Stock_Price:  104.23783218202809
curr_Factors:  [104.23783218]
mat_Sqrt:  [[0.15]]
grads:  [-0.10172789]
Stock Position:  -0.10172789473989848
Bond Position:  [19.33228383]


portfolio before change:  [8.76782341]
curr_Stock_Price:  103.8620602246234
curr_Factors:  [103.86206022]
mat_Sqrt:  [[0.15]]
grads:  [-0.04554433]
Stock Position:  -0.04554432941336492
Bond Position:  [13.49815129]


portfolio before change:  [8.71909106]
curr_Stock_Price:  104.95058232731515
curr_Factors:  [104.95058233]
mat_Sqrt:  [[0.15]]
grads:  [0.00565311]
Stock Position:  0.005653106728611119
Bond Position:  [8.12579422]


portfolio before change:  [8.71480816]
curr_Stock_Price:  104.10312263806159
curr_Factors:  [104.10312264]
mat_Sqrt:  [[0.15]]
grads:  [0.01427239]
Stock Position:  0.014272392240949658
Bond Position:  [7.22900756]


portfolio before change:  [8.72982685]
curr_Stock_Price:  105.12375522273265
curr_Factors:  [105.12375522]
mat_Sqrt:  [[0.15]]
grads:  [-0.1414912]
Stock Position:  -0.1414911988167421
Bond Position:  [23.603913]


portfolio before change:  [8.72947273]
curr_Stock_Price:  105.13668473055945
curr_Factors:  [105.13668473]
mat_Sqrt:  [[0.15]]
grads:  [-0.02880569]
Stock Position:  -0.028805692138455623
Bond Position:  [11.75800771]


portfolio before change:  [8.73048575]
curr_Stock_Price:  105.12702981028556
curr_Factors:  [105.12702981]
mat_Sqrt:  [[0.15]]
grads:  [0.08440556]
Stock Position:  0.08440556148538936
Bond Position:  [-0.14282023]


portfolio before change:  [8.69600673]
curr_Stock_Price:  104.71864333686771
curr_Factors:  [104.71864334]
mat_Sqrt:  [[0.15]]
grads:  [0.00180056]
Stock Position:  0.0018005567843331373
Bond Position:  [8.50745487]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.69820338]
Stock Price:  105.6433085357986
PL:  [3.05489484]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37201656e-02]
 [-1.36964984e-02]
 [ 6.03591709e-02]
 [-1.17157358e-02]
 [ 1.09975989e-02]
 [-1.75978718e-02]
 [-1.36215121e-02]
 [ 6.94616084e-02]
 [-2.09879536e-02]
 [-1.37580166e-02]
 [-9.65490932e-03]
 [-4.61925795e-03]
 [-8.29336538e-04]
 [-5.93372364e-03]
 [-2.58953013e-03]
 [ 4.78259298e-03]
 [-1.36338035e-02]
 [-1.36103252e-02]
 [ 2.50137505e-02]
 [ 5.73392871e-05]
 [-7.81537338e-03]
 [ 5.53163210e-03]
 [ 1.49515673e-02]
 [ 1.97373865e-02]
 [ 9.47733502e-04]
 [ 4.43809206e-03]
 [ 2.93746811e-04]
 [ 8.91073905e-03]
 [ 1.60096228e-02]
 [ 2.30461181e-02]
 [-6.53883364e-03]
 [ 1.68263100e-02]
 [ 1.19705210e-02]
 [-1.98140720e-02]
 [-1.75892717e-04]
 [ 1.85598700e-02]
 [ 4.80170017e-03]
 [ 2.86150641e-03]
 [-4.16604695e-02]
 [-1.61959483e-02]
 [ 7.16425760e-03]
 [ 2.70221877e-02]
 [-3.04425936e-03]
 [ 3.70400170e-03]
 [-1.03559564e-02]
 [ 1.71919478e-02]
 [ 9.87277556e-03]
 [ 5.31998136e-03]
 [-6.62574732e-03]
 [-5.39595808e-04]
 [-4.35636355e-03]
 [-7.50667099e-04]
 [ 4.08647403e-04]
 [ 5.92018858e-03]
 [-7.97990584e-03]
 [-4.42027349e-03]
 [ 1.57131242e-03]
 [ 7.31434142e-03]
 [ 7.30832767e-03]
 [-4.02833944e-03]
 [-3.21699296e-04]
 [ 2.61669431e-03]
 [-6.88201976e-03]
 [ 6.19549933e-03]
 [ 2.13878476e-02]
 [ 5.44692415e-03]
 [ 8.28427741e-03]
 [-4.98867821e-04]
 [ 3.02005364e-03]
 [ 2.25926115e-02]
 [ 3.57568047e-03]
 [-1.56039646e-02]
 [-5.52577468e-03]
 [ 9.64129256e-04]
 [ 5.98563148e-03]
 [-5.44811339e-04]
 [-1.50458064e-03]
 [ 3.33989308e-03]
 [-2.30131891e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.64371842]
curr_Stock_Price:  99.65147945307979
curr_Factors:  [99.65147945]
mat_Sqrt:  [[0.15]]
grads:  [-0.09146777]
Stock Position:  -0.09146777069237433
Bond Position:  [3.47118025]


portfolio before change:  [-5.59874695]
curr_Stock_Price:  99.162186674103
curr_Factors:  [99.16218667]
mat_Sqrt:  [[0.15]]
grads:  [-0.09130999]
Stock Position:  -0.09130998919970065
Bond Position:  [3.45575125]


portfolio before change:  [-5.49442916]
curr_Stock_Price:  98.022094629773
curr_Factors:  [98.02209463]
mat_Sqrt:  [[0.15]]
grads:  [0.40239447]
Stock Position:  0.40239447291646396
Bond Position:  [-44.93797827]


portfolio before change:  [-5.14357333]
curr_Stock_Price:  98.90099473733976
curr_Factors:  [98.90099474]
mat_Sqrt:  [[0.15]]
grads:  [-0.07810491]
Stock Position:  -0.07810490504826206
Bond Position:  [2.58107947]


portfolio before change:  [-5.09549757]
curr_Stock_Price:  98.28753212969956
curr_Factors:  [98.28753213]
mat_Sqrt:  [[0.15]]
grads:  [0.07331733]
Stock Position:  0.07331732616884067
Bond Position:  [-12.30167662]


portfolio before change:  [-5.16293465]
curr_Stock_Price:  97.3782218032177
curr_Factors:  [97.3782218]
mat_Sqrt:  [[0.15]]
grads:  [-0.11731915]
Stock Position:  -0.11731914542743065
Bond Position:  [6.26139512]


portfolio before change:  [-5.16999713]
curr_Stock_Price:  97.44175647257629
curr_Factors:  [97.44175647]
mat_Sqrt:  [[0.15]]
grads:  [-0.09081008]
Stock Position:  -0.09081008096804676
Bond Position:  [3.67869666]


portfolio before change:  [-5.17007503]
curr_Stock_Price:  97.44514623264526
curr_Factors:  [97.44514623]
mat_Sqrt:  [[0.15]]
grads:  [0.46307739]
Stock Position:  0.4630773894978798
Bond Position:  [-50.29471897]


portfolio before change:  [-5.26922181]
curr_Stock_Price:  97.23783043176596
curr_Factors:  [97.23783043]
mat_Sqrt:  [[0.15]]
grads:  [-0.13991969]
Stock Position:  -0.13991969098457088
Bond Position:  [8.33626538]


portfolio before change:  [-5.25796763]
curr_Stock_Price:  97.16112113358115
curr_Factors:  [97.16112113]
mat_Sqrt:  [[0.15]]
grads:  [-0.09172011]
Stock Position:  -0.0917201104448368
Bond Position:  [3.65366113]


portfolio before change:  [-5.18176339]
curr_Stock_Price:  96.33277620967041
curr_Factors:  [96.33277621]
mat_Sqrt:  [[0.15]]
grads:  [-0.06436606]
Stock Position:  -0.06436606211723139
Bond Position:  [1.01879807]


portfolio before change:  [-5.19743645]
curr_Stock_Price:  96.57726439891378
curr_Factors:  [96.5772644]
mat_Sqrt:  [[0.15]]
grads:  [-0.03079505]
Stock Position:  -0.030795052982537634
Bond Position:  [-2.22333448]


portfolio before change:  [-5.18207525]
curr_Stock_Price:  96.07393144468614
curr_Factors:  [96.07393144]
mat_Sqrt:  [[0.15]]
grads:  [-0.00552891]
Stock Position:  -0.005528910254496214
Bond Position:  [-4.6508911]


portfolio before change:  [-5.18962661]
curr_Stock_Price:  97.38715087908027
curr_Factors:  [97.38715088]
mat_Sqrt:  [[0.15]]
grads:  [-0.03955816]
Stock Position:  -0.039558157568566024
Bond Position:  [-1.33717035]


portfolio before change:  [-5.22384137]
curr_Stock_Price:  98.24996125081579
curr_Factors:  [98.24996125]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726353]
Stock Position:  -0.017263534173426534
Bond Position:  [-3.52769981]


portfolio before change:  [-5.21923224]
curr_Stock_Price:  97.97020248193577
curr_Factors:  [97.97020248]
mat_Sqrt:  [[0.15]]
grads:  [0.03188395]
Stock Position:  0.031883953223482885
Bond Position:  [-8.34290959]


portfolio before change:  [-5.21865304]
curr_Stock_Price:  98.00472287825937
curr_Factors:  [98.00472288]
mat_Sqrt:  [[0.15]]
grads:  [-0.09089202]
Stock Position:  -0.09089202342997246
Bond Position:  [3.68919453]


portfolio before change:  [-5.27324294]
curr_Stock_Price:  98.60786146756854
curr_Factors:  [98.60786147]
mat_Sqrt:  [[0.15]]
grads:  [-0.0907355]
Stock Position:  -0.09073550108827266
Bond Position:  [3.67399078]


portfolio before change:  [-5.27323352]
curr_Stock_Price:  98.61028840474826
curr_Factors:  [98.6102884]
mat_Sqrt:  [[0.15]]
grads:  [0.16675834]
Stock Position:  0.16675833652251584
Bond Position:  [-21.71732118]


portfolio before change:  [-5.25839849]
curr_Stock_Price:  98.70738945558108
curr_Factors:  [98.70738946]
mat_Sqrt:  [[0.15]]
grads:  [0.00038226]
Stock Position:  0.00038226191402181435
Bond Position:  [-5.29613056]


portfolio before change:  [-5.25888521]
curr_Stock_Price:  98.30007510290076
curr_Factors:  [98.3000751]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210249]
Stock Position:  -0.05210248922640201
Bond Position:  [-0.1372066]


portfolio before change:  [-5.23236089]
curr_Stock_Price:  97.79083084657056
curr_Factors:  [97.79083085]
mat_Sqrt:  [[0.15]]
grads:  [0.03687755]
Stock Position:  0.036877547319149315
Bond Position:  [-8.83864688]


portfolio before change:  [-5.21422205]
curr_Stock_Price:  98.29767779115365
curr_Factors:  [98.29767779]
mat_Sqrt:  [[0.15]]
grads:  [0.09967712]
Stock Position:  0.09967711509652465
Bond Position:  [-15.01225099]


portfolio before change:  [-5.21847997]
curr_Stock_Price:  98.2643739967806
curr_Factors:  [98.264374]
mat_Sqrt:  [[0.15]]
grads:  [0.13158258]
Stock Position:  0.13158257683728566
Bond Position:  [-18.14835951]


portfolio before change:  [-5.30566923]
curr_Stock_Price:  97.6103744322706
curr_Factors:  [97.61037443]
mat_Sqrt:  [[0.15]]
grads:  [0.00631822]
Stock Position:  0.006318223343932129
Bond Position:  [-5.92239337]


portfolio before change:  [-5.31242136]
curr_Stock_Price:  96.60028467898978
curr_Factors:  [96.60028468]
mat_Sqrt:  [[0.15]]
grads:  [0.02958728]
Stock Position:  0.02958728042891068
Bond Position:  [-8.17056107]


portfolio before change:  [-5.32226903]
curr_Stock_Price:  96.28471004289476
curr_Factors:  [96.28471004]
mat_Sqrt:  [[0.15]]
grads:  [0.00195831]
Stock Position:  0.0019583120739811305
Bond Position:  [-5.51082454]


portfolio before change:  [-5.31886158]
curr_Stock_Price:  98.20058911552725
curr_Factors:  [98.20058912]
mat_Sqrt:  [[0.15]]
grads:  [0.05940493]
Stock Position:  0.059404926977113345
Bond Position:  [-11.1524604]


portfolio before change:  [-5.34546993]
curr_Stock_Price:  97.76440808229727
curr_Factors:  [97.76440808]
mat_Sqrt:  [[0.15]]
grads:  [0.10673082]
Stock Position:  0.10673081888892544
Bond Position:  [-15.77994527]


portfolio before change:  [-5.35037082]
curr_Stock_Price:  97.72773065063066
curr_Factors:  [97.72773065]
mat_Sqrt:  [[0.15]]
grads:  [0.15364079]
Stock Position:  0.153640787021765
Bond Position:  [-20.36533627]


portfolio before change:  [-5.32085202]
curr_Stock_Price:  97.9281440808403
curr_Factors:  [97.92814408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04359222]
Stock Position:  -0.04359222426992847
Bond Position:  [-1.0519464]


portfolio before change:  [-5.30592387]
curr_Stock_Price:  97.58418596240804
curr_Factors:  [97.58418596]
mat_Sqrt:  [[0.15]]
grads:  [0.1121754]
Stock Position:  0.11217540000264338
Bond Position:  [-16.25246896]


portfolio before change:  [-5.35475195]
curr_Stock_Price:  97.15795816314704
curr_Factors:  [97.15795816]
mat_Sqrt:  [[0.15]]
grads:  [0.07980347]
Stock Position:  0.079803473245084
Bond Position:  [-13.10829447]


portfolio before change:  [-5.27916114]
curr_Stock_Price:  98.11543660796045
curr_Factors:  [98.11543661]
mat_Sqrt:  [[0.15]]
grads:  [-0.13209381]
Stock Position:  -0.1320938130841605
Bond Position:  [7.681281]


portfolio before change:  [-5.37247486]
curr_Stock_Price:  98.82549115617405
curr_Factors:  [98.82549116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00117262]
Stock Position:  -0.001172618111685483
Bond Position:  [-5.2565903]


portfolio before change:  [-5.37286032]
curr_Stock_Price:  98.87403018324632
curr_Factors:  [98.87403018]
mat_Sqrt:  [[0.15]]
grads:  [0.12373247]
Stock Position:  0.12373246674454698
Bond Position:  [-17.60678798]


portfolio before change:  [-5.42055667]
curr_Stock_Price:  98.49744437327651
curr_Factors:  [98.49744437]
mat_Sqrt:  [[0.15]]
grads:  [0.03201133]
Stock Position:  0.03201133443610144
Bond Position:  [-8.57359131]


portfolio before change:  [-5.39402046]
curr_Stock_Price:  99.34314742633259
curr_Factors:  [99.34314743]
mat_Sqrt:  [[0.15]]
grads:  [0.01907671]
Stock Position:  0.019076709425351036
Bond Position:  [-7.28916081]


portfolio before change:  [-5.39977341]
curr_Stock_Price:  99.06545972048359
curr_Factors:  [99.06545972]
mat_Sqrt:  [[0.15]]
grads:  [-0.27773646]
Stock Position:  -0.27773646306577854
Bond Position:  [22.11431698]


portfolio before change:  [-5.27120075]
curr_Stock_Price:  98.60750591607659
curr_Factors:  [98.60750592]
mat_Sqrt:  [[0.15]]
grads:  [-0.10797299]
Stock Position:  -0.10797298843390785
Bond Position:  [5.37574634]


portfolio before change:  [-5.26653936]
curr_Stock_Price:  98.56744592625192
curr_Factors:  [98.56744593]
mat_Sqrt:  [[0.15]]
grads:  [0.04776172]
Stock Position:  0.04776171730653089
Bond Position:  [-9.97428985]


portfolio before change:  [-5.29331719]
curr_Stock_Price:  98.01984379006623
curr_Factors:  [98.01984379]
mat_Sqrt:  [[0.15]]
grads:  [0.18014792]
Stock Position:  0.18014791808051914
Bond Position:  [-22.95138798]


portfolio before change:  [-5.35292495]
curr_Stock_Price:  97.69692443390683
curr_Factors:  [97.69692443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029506]
Stock Position:  -0.020295062383026165
Bond Position:  [-3.37015977]


portfolio before change:  [-5.35050086]
curr_Stock_Price:  97.56710295152224
curr_Factors:  [97.56710295]
mat_Sqrt:  [[0.15]]
grads:  [0.02469334]
Stock Position:  0.024693344653124092
Bond Position:  [-7.75975896]


portfolio before change:  [-5.34591562]
curr_Stock_Price:  97.77243097348988
curr_Factors:  [97.77243097]
mat_Sqrt:  [[0.15]]
grads:  [-0.06903971]
Stock Position:  -0.06903970942401669
Bond Position:  [1.4042646]


portfolio before change:  [-5.33882204]
curr_Stock_Price:  97.6709559195396
curr_Factors:  [97.67095592]
mat_Sqrt:  [[0.15]]
grads:  [0.11461299]
Stock Position:  0.11461298555077104
Bond Position:  [-16.5331819]


portfolio before change:  [-5.40644049]
curr_Stock_Price:  97.08999997927174
curr_Factors:  [97.08999998]
mat_Sqrt:  [[0.15]]
grads:  [0.0658185]
Stock Position:  0.06581850375484424
Bond Position:  [-11.79675902]


portfolio before change:  [-5.42725397]
curr_Stock_Price:  96.78497701129625
curr_Factors:  [96.78497701]
mat_Sqrt:  [[0.15]]
grads:  [0.03546654]
Stock Position:  0.03546654243058665
Bond Position:  [-8.85988246]


portfolio before change:  [-5.40091658]
curr_Stock_Price:  97.54318865379011
curr_Factors:  [97.54318865]
mat_Sqrt:  [[0.15]]
grads:  [-0.04417165]
Stock Position:  -0.04417164882747195
Bond Position:  [-1.09227311]


portfolio before change:  [-5.40453539]
curr_Stock_Price:  97.62356902926157
curr_Factors:  [97.62356903]
mat_Sqrt:  [[0.15]]
grads:  [-0.00359731]
Stock Position:  -0.0035973053869925702
Bond Position:  [-5.0533536]


portfolio before change:  [-5.40278328]
curr_Stock_Price:  97.0487067310989
curr_Factors:  [97.04870673]
mat_Sqrt:  [[0.15]]
grads:  [-0.02904242]
Stock Position:  -0.029042423639095174
Bond Position:  [-2.58425362]


portfolio before change:  [-5.38824297]
curr_Stock_Price:  96.54248784574997
curr_Factors:  [96.54248785]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500445]
Stock Position:  -0.005004447323493262
Bond Position:  [-4.90510118]


portfolio before change:  [-5.38967037]
curr_Stock_Price:  96.7664515007536
curr_Factors:  [96.7664515]
mat_Sqrt:  [[0.15]]
grads:  [0.00272432]
Stock Position:  0.00272431601721316
Bond Position:  [-5.65329276]


portfolio before change:  [-5.38795976]
curr_Stock_Price:  97.5240521652538
curr_Factors:  [97.52405217]
mat_Sqrt:  [[0.15]]
grads:  [0.03946792]
Stock Position:  0.03946792385422316
Bond Position:  [-9.23703163]


portfolio before change:  [-5.35301951]
curr_Stock_Price:  98.42396232518698
curr_Factors:  [98.42396233]
mat_Sqrt:  [[0.15]]
grads:  [-0.05319937]
Stock Position:  -0.053199372241258466
Bond Position:  [-0.1169265]


portfolio before change:  [-5.37089994]
curr_Stock_Price:  98.75992724662528
curr_Factors:  [98.75992725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02946849]
Stock Position:  -0.029468489918257734
Bond Position:  [-2.46059402]


portfolio before change:  [-5.37826226]
curr_Stock_Price:  99.0045452140823
curr_Factors:  [99.00454521]
mat_Sqrt:  [[0.15]]
grads:  [0.01047542]
Stock Position:  0.010475416164162569
Bond Position:  [-6.41537607]


portfolio before change:  [-5.37706956]
curr_Stock_Price:  99.15667904863473
curr_Factors:  [99.15667905]
mat_Sqrt:  [[0.15]]
grads:  [0.04876228]
Stock Position:  0.04876227614221628
Bond Position:  [-10.21217493]


portfolio before change:  [-5.35697274]
curr_Stock_Price:  99.58190751532256
curr_Factors:  [99.58190752]
mat_Sqrt:  [[0.15]]
grads:  [0.04872218]
Stock Position:  0.048722184470949274
Bond Position:  [-10.20882081]


portfolio before change:  [-5.34480815]
curr_Stock_Price:  99.84467605912472
curr_Factors:  [99.84467606]
mat_Sqrt:  [[0.15]]
grads:  [-0.0268556]
Stock Position:  -0.02685559623500248
Bond Position:  [-2.66341984]


portfolio before change:  [-5.35113663]
curr_Stock_Price:  100.07412563203607
curr_Factors:  [100.07412563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00214466]
Stock Position:  -0.0021446619765590784
Bond Position:  [-5.13651145]


portfolio before change:  [-5.34968531]
curr_Stock_Price:  99.24772042972509
curr_Factors:  [99.24772043]
mat_Sqrt:  [[0.15]]
grads:  [0.01744463]
Stock Position:  0.01744462871206962
Bond Position:  [-7.08102494]


portfolio before change:  [-5.34462147]
curr_Stock_Price:  99.56337176005651
curr_Factors:  [99.56337176]
mat_Sqrt:  [[0.15]]
grads:  [-0.04588013]
Stock Position:  -0.04588013174463712
Bond Position:  [-0.77664085]


portfolio before change:  [-5.330042]
curr_Stock_Price:  99.24454079845889
curr_Factors:  [99.2445408]
mat_Sqrt:  [[0.15]]
grads:  [0.04130333]
Stock Position:  0.04130332886520904
Bond Position:  [-9.42917191]


portfolio before change:  [-5.30972025]
curr_Stock_Price:  99.75082189718131
curr_Factors:  [99.7508219]
mat_Sqrt:  [[0.15]]
grads:  [0.14258565]
Stock Position:  0.1425856507701139
Bond Position:  [-19.5327561]


portfolio before change:  [-5.3155929]
curr_Stock_Price:  99.71819719585379
curr_Factors:  [99.7181972]
mat_Sqrt:  [[0.15]]
grads:  [0.03631283]
Stock Position:  0.0363128276633632
Bond Position:  [-8.93664261]


portfolio before change:  [-5.33220014]
curr_Stock_Price:  99.27624086176445
curr_Factors:  [99.27624086]
mat_Sqrt:  [[0.15]]
grads:  [0.05522852]
Stock Position:  0.05522851607831865
Bond Position:  [-10.8150796]


portfolio before change:  [-5.37807234]
curr_Stock_Price:  98.45789110571219
curr_Factors:  [98.45789111]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332579]
Stock Position:  -0.003325785472867637
Bond Position:  [-5.05062252]


portfolio before change:  [-5.37624999]
curr_Stock_Price:  97.81502558039571
curr_Factors:  [97.81502558]
mat_Sqrt:  [[0.15]]
grads:  [0.02013369]
Stock Position:  0.02013369093987863
Bond Position:  [-7.34562748]


portfolio before change:  [-5.36986356]
curr_Stock_Price:  98.15502996274765
curr_Factors:  [98.15502996]
mat_Sqrt:  [[0.15]]
grads:  [0.15061741]
Stock Position:  0.15061740990089595
Bond Position:  [-20.15371994]


portfolio before change:  [-5.4305975]
curr_Stock_Price:  97.7601600033185
curr_Factors:  [97.76016]
mat_Sqrt:  [[0.15]]
grads:  [0.02383787]
Stock Position:  0.02383786979339287
Bond Position:  [-7.76099146]


portfolio before change:  [-5.43830139]
curr_Stock_Price:  97.45733026675454
curr_Factors:  [97.45733027]
mat_Sqrt:  [[0.15]]
grads:  [-0.10402643]
Stock Position:  -0.10402643065368401
Bond Position:  [4.69983682]


portfolio before change:  [-5.47750882]
curr_Stock_Price:  97.83705281326888
curr_Factors:  [97.83705281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0368385]
Stock Position:  -0.03683849789794793
Bond Position:  [-1.87333876]


portfolio before change:  [-5.49943922]
curr_Stock_Price:  98.42918642311871
curr_Factors:  [98.42918642]
mat_Sqrt:  [[0.15]]
grads:  [0.00642753]
Stock Position:  0.006427528372430059
Bond Position:  [-6.13209561]


portfolio before change:  [-5.49989975]
curr_Stock_Price:  98.41716552407982
curr_Factors:  [98.41716552]
mat_Sqrt:  [[0.15]]
grads:  [0.03990421]
Stock Position:  0.03990420989056543
Bond Position:  [-9.42715898]


portfolio before change:  [-5.48370468]
curr_Stock_Price:  98.83777995640519
curr_Factors:  [98.83777996]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363208]
Stock Position:  -0.0036320755926100754
Bond Position:  [-5.1247184]


portfolio before change:  [-5.48520924]
curr_Stock_Price:  99.1638324793561
curr_Factors:  [99.16383248]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003054]
Stock Position:  -0.010030537615394748
Bond Position:  [-4.49054268]


portfolio before change:  [-5.48269939]
curr_Stock_Price:  98.88563028259041
curr_Factors:  [98.88563028]
mat_Sqrt:  [[0.15]]
grads:  [0.02226595]
Stock Position:  0.022265953873959153
Bond Position:  [-7.68448227]


portfolio before change:  [-5.51486803]
curr_Stock_Price:  97.46245545470781
curr_Factors:  [97.46245545]
mat_Sqrt:  [[0.15]]
grads:  [-0.15342126]
Stock Position:  -0.15342126043622595
Bond Position:  [9.43794474]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.55113992]
Stock Price:  97.70272059399409
PL:  [-5.55113992]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.21346575e-02]
 [-6.05618949e-03]
 [ 2.59351283e-03]
 [-8.58633993e-03]
 [ 1.31931428e-02]
 [-4.14477395e-03]
 [-3.20660587e-03]
 [-1.62967573e-02]
 [-4.90241939e-03]
 [ 1.78465207e-03]
 [ 8.83468199e-03]
 [ 3.27742807e-03]
 [-2.41103003e-03]
 [ 7.96137037e-03]
 [-1.39053936e-03]
 [ 1.34312075e-02]
 [ 3.53020791e-02]
 [-1.47325696e-02]
 [ 2.10944170e-02]
 [ 1.73888702e-03]
 [-3.78380232e-03]
 [ 4.85958403e-03]
 [ 1.89649442e-02]
 [ 1.78448343e-02]
 [-6.08651842e-03]
 [ 4.65665184e-03]
 [ 8.50417314e-03]
 [ 9.07098858e-03]
 [ 1.57063215e-02]
 [ 2.81967172e-03]
 [-6.43905534e-03]
 [ 1.00536110e-02]
 [ 1.15961043e-02]
 [-4.95602339e-03]
 [ 5.51542949e-03]
 [ 1.60003751e-02]
 [-1.90554377e-02]
 [-4.92857945e-03]
 [-1.13074079e-02]
 [-4.44747485e-02]
 [ 3.52618181e-03]
 [ 8.28287355e-03]
 [-1.24792987e-02]
 [ 1.15767501e-02]
 [-1.75362653e-03]
 [ 1.16019583e-02]
 [ 1.05674107e-02]
 [-2.50856635e-03]
 [ 1.24186371e-02]
 [-1.27631476e-03]
 [ 2.10466706e-02]
 [ 4.87730498e-03]
 [-1.08204173e-03]
 [-1.20157090e-02]
 [-1.65844124e-03]
 [-3.14619309e-03]
 [ 9.11210703e-03]
 [-1.69212832e-02]
 [ 4.28830743e-03]
 [-3.69581188e-03]
 [-3.25143828e-03]
 [ 5.14268599e-03]
 [-1.98187523e-02]
 [ 1.09859991e-03]
 [ 2.01426593e-02]
 [ 7.19399046e-03]
 [ 1.24810646e-02]
 [ 9.47225154e-03]
 [ 6.33985122e-03]
 [ 1.61049025e-02]
 [ 8.40453487e-04]
 [-1.53352657e-02]
 [-4.90737292e-03]
 [ 1.24491375e-03]
 [ 3.91059312e-03]
 [-1.49120848e-02]
 [-3.63024661e-03]
 [ 1.42367259e-02]
 [-4.35998333e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.99721548]
curr_Stock_Price:  99.18124483382186
curr_Factors:  [99.18124483]
mat_Sqrt:  [[0.15]]
grads:  [-0.08089772]
Stock Position:  -0.08089771698052584
Bond Position:  [-7.97367921]


portfolio before change:  [-16.01580666]
curr_Stock_Price:  99.40489522923704
curr_Factors:  [99.40489523]
mat_Sqrt:  [[0.15]]
grads:  [-0.0403746]
Stock Position:  -0.040374596609616564
Bond Position:  [-12.00237411]


portfolio before change:  [-16.03769984]
curr_Stock_Price:  99.92856626920103
curr_Factors:  [99.92856627]
mat_Sqrt:  [[0.15]]
grads:  [0.01729009]
Stock Position:  0.017290085529155903
Bond Position:  [-17.7654733]


portfolio before change:  [-16.04510819]
curr_Stock_Price:  99.56431288311701
curr_Factors:  [99.56431288]
mat_Sqrt:  [[0.15]]
grads:  [-0.05724227]
Stock Position:  -0.057242266187535244
Bond Position:  [-10.34582129]


portfolio before change:  [-16.0812802]
curr_Stock_Price:  100.18492739399544
curr_Factors:  [100.18492739]
mat_Sqrt:  [[0.15]]
grads:  [0.08795429]
Stock Position:  0.08795428540984368
Bond Position:  [-24.8929739]


portfolio before change:  [-16.07864478]
curr_Stock_Price:  100.23258032532321
curr_Factors:  [100.23258033]
mat_Sqrt:  [[0.15]]
grads:  [-0.02763183]
Stock Position:  -0.02763182631590484
Bond Position:  [-13.30903553]


portfolio before change:  [-16.08693693]
curr_Stock_Price:  100.50256979611726
curr_Factors:  [100.5025698]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137737]
Stock Position:  -0.021377372435066926
Bond Position:  [-13.93845606]


portfolio before change:  [-16.08729802]
curr_Stock_Price:  100.4787088490728
curr_Factors:  [100.47870885]
mat_Sqrt:  [[0.15]]
grads:  [-0.10864505]
Stock Position:  -0.10864504867889291
Bond Position:  [-5.17078381]


portfolio before change:  [-16.04117207]
curr_Stock_Price:  100.05117778222552
curr_Factors:  [100.05117778]
mat_Sqrt:  [[0.15]]
grads:  [-0.0326828]
Stock Position:  -0.03268279595240175
Bond Position:  [-12.77121984]


portfolio before change:  [-16.06131833]
curr_Stock_Price:  100.64317204050299
curr_Factors:  [100.64317204]
mat_Sqrt:  [[0.15]]
grads:  [0.01189768]
Stock Position:  0.011897680448812384
Bond Position:  [-17.25873863]


portfolio before change:  [-16.06654346]
curr_Stock_Price:  100.29466473061373
curr_Factors:  [100.29466473]
mat_Sqrt:  [[0.15]]
grads:  [0.05889788]
Stock Position:  0.05889787995155429
Bond Position:  [-21.97368658]


portfolio before change:  [-16.0392354]
curr_Stock_Price:  100.78163394169967
curr_Factors:  [100.78163394]
mat_Sqrt:  [[0.15]]
grads:  [0.02184952]
Stock Position:  0.021849520485298785
Bond Position:  [-18.24126578]


portfolio before change:  [-16.05178584]
curr_Stock_Price:  100.25941081367988
curr_Factors:  [100.25941081]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607353]
Stock Position:  -0.01607353356457409
Bond Position:  [-14.44026284]


portfolio before change:  [-16.05579615]
curr_Stock_Price:  100.45275765723798
curr_Factors:  [100.45275766]
mat_Sqrt:  [[0.15]]
grads:  [0.0530758]
Stock Position:  0.05307580244485885
Bond Position:  [-21.38740688]


portfolio before change:  [-16.0743054]
curr_Stock_Price:  100.12921112250645
curr_Factors:  [100.12921112]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927026]
Stock Position:  -0.009270262369668892
Bond Position:  [-15.14608134]


portfolio before change:  [-16.0753751]
curr_Stock_Price:  100.14248348882977
curr_Factors:  [100.14248349]
mat_Sqrt:  [[0.15]]
grads:  [0.08954138]
Stock Position:  0.08954138314247904
Bond Position:  [-25.04227158]


portfolio before change:  [-16.07628008]
curr_Stock_Price:  100.14985669253484
curr_Factors:  [100.14985669]
mat_Sqrt:  [[0.15]]
grads:  [0.23534719]
Stock Position:  0.2353471939101241
Bond Position:  [-39.64626783]


portfolio before change:  [-16.09075008]
curr_Stock_Price:  100.09890207290171
curr_Factors:  [100.09890207]
mat_Sqrt:  [[0.15]]
grads:  [-0.09821713]
Stock Position:  -0.09821713082699185
Bond Position:  [-6.25932312]


portfolio before change:  [-16.03520307]
curr_Stock_Price:  99.52936572070902
curr_Factors:  [99.52936572]
mat_Sqrt:  [[0.15]]
grads:  [0.14062945]
Stock Position:  0.14062944636722
Bond Position:  [-30.03196267]


portfolio before change:  [-16.05971476]
curr_Stock_Price:  99.36841340226219
curr_Factors:  [99.3684134]
mat_Sqrt:  [[0.15]]
grads:  [0.01159258]
Stock Position:  0.0115925801180477
Bond Position:  [-17.21165106]


portfolio before change:  [-16.05909925]
curr_Stock_Price:  99.51430680636405
curr_Factors:  [99.51430681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02522535]
Stock Position:  -0.025225348808378154
Bond Position:  [-13.54881615]


portfolio before change:  [-16.05775505]
curr_Stock_Price:  99.42744885505591
curr_Factors:  [99.42744886]
mat_Sqrt:  [[0.15]]
grads:  [0.03239723]
Stock Position:  0.03239722689926473
Bond Position:  [-19.27892867]


portfolio before change:  [-16.0659261]
curr_Stock_Price:  99.21242812601194
curr_Factors:  [99.21242813]
mat_Sqrt:  [[0.15]]
grads:  [0.12643296]
Stock Position:  0.12643296118288794
Bond Position:  [-28.60964717]


portfolio before change:  [-16.09937204]
curr_Stock_Price:  98.96203626902896
curr_Factors:  [98.96203627]
mat_Sqrt:  [[0.15]]
grads:  [0.11896556]
Stock Position:  0.11896556172042178
Bond Position:  [-27.87244627]


portfolio before change:  [-16.03613372]
curr_Stock_Price:  99.5082481480153
curr_Factors:  [99.50824815]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057679]
Stock Position:  -0.040576789434983156
Bond Position:  [-11.99840849]


portfolio before change:  [-16.01163614]
curr_Stock_Price:  98.88603263956698
curr_Factors:  [98.88603264]
mat_Sqrt:  [[0.15]]
grads:  [0.03104435]
Stock Position:  0.031044345607865658
Bond Position:  [-19.08148831]


portfolio before change:  [-16.02680038]
curr_Stock_Price:  98.43597928716453
curr_Factors:  [98.43597929]
mat_Sqrt:  [[0.15]]
grads:  [0.05669449]
Stock Position:  0.056694487629487256
Bond Position:  [-21.60757779]


portfolio before change:  [-16.05040689]
curr_Stock_Price:  98.04341913116647
curr_Factors:  [98.04341913]
mat_Sqrt:  [[0.15]]
grads:  [0.06047326]
Stock Position:  0.06047325717825222
Bond Position:  [-21.97941179]


portfolio before change:  [-16.00952585]
curr_Stock_Price:  98.74215437178877
curr_Factors:  [98.74215437]
mat_Sqrt:  [[0.15]]
grads:  [0.10470881]
Stock Position:  0.10470881007856453
Bond Position:  [-26.34869934]


portfolio before change:  [-15.96835023]
curr_Stock_Price:  99.1511215322895
curr_Factors:  [99.15112153]
mat_Sqrt:  [[0.15]]
grads:  [0.01879781]
Stock Position:  0.01879781145987652
Bond Position:  [-17.83217432]


portfolio before change:  [-15.97875459]
curr_Stock_Price:  98.65692512473169
curr_Factors:  [98.65692512]
mat_Sqrt:  [[0.15]]
grads:  [-0.04292704]
Stock Position:  -0.042927035575524276
Bond Position:  [-11.74370525]


portfolio before change:  [-16.00485097]
curr_Stock_Price:  99.24775043892593
curr_Factors:  [99.24775044]
mat_Sqrt:  [[0.15]]
grads:  [0.06702407]
Stock Position:  0.06702407320397803
Bond Position:  [-22.65683946]


portfolio before change:  [-16.02183368]
curr_Stock_Price:  99.01549635225604
curr_Factors:  [99.01549635]
mat_Sqrt:  [[0.15]]
grads:  [0.07730736]
Stock Position:  0.07730736226202539
Bond Position:  [-23.67646053]


portfolio before change:  [-15.96302058]
curr_Stock_Price:  99.79540816324452
curr_Factors:  [99.79540816]
mat_Sqrt:  [[0.15]]
grads:  [-0.03304016]
Stock Position:  -0.033040155922113845
Bond Position:  [-12.66576474]


portfolio before change:  [-16.01314098]
curr_Stock_Price:  101.28840247819787
curr_Factors:  [101.28840248]
mat_Sqrt:  [[0.15]]
grads:  [0.03676953]
Stock Position:  0.03676952992297335
Bond Position:  [-19.73746793]


portfolio before change:  [-15.991403]
curr_Stock_Price:  101.91314826240617
curr_Factors:  [101.91314826]
mat_Sqrt:  [[0.15]]
grads:  [0.10666917]
Stock Position:  0.10666916716219887
Bond Position:  [-26.86239365]


portfolio before change:  [-15.89493478]
curr_Stock_Price:  102.83325644936654
curr_Factors:  [102.83325645]
mat_Sqrt:  [[0.15]]
grads:  [-0.12703625]
Stock Position:  -0.12703625141226926
Bond Position:  [-2.83138336]


portfolio before change:  [-15.89860762]
curr_Stock_Price:  102.86077510188836
curr_Factors:  [102.8607751]
mat_Sqrt:  [[0.15]]
grads:  [-0.0328572]
Stock Position:  -0.03285719630883947
Bond Position:  [-12.51889094]


portfolio before change:  [-15.93305066]
curr_Stock_Price:  103.88522605973061
curr_Factors:  [103.88522606]
mat_Sqrt:  [[0.15]]
grads:  [-0.07538272]
Stock Position:  -0.07538271960015495
Bond Position:  [-8.10189979]


portfolio before change:  [-16.00154565]
curr_Stock_Price:  104.78713841878015
curr_Factors:  [104.78713842]
mat_Sqrt:  [[0.15]]
grads:  [-0.29649832]
Stock Position:  -0.29649832325146147
Bond Position:  [15.06766519]


portfolio before change:  [-15.802052]
curr_Stock_Price:  104.11748239644656
curr_Factors:  [104.1174824]
mat_Sqrt:  [[0.15]]
grads:  [0.02350788]
Stock Position:  0.023507878714547938
Bond Position:  [-18.24963315]


portfolio before change:  [-15.81379526]
curr_Stock_Price:  103.66645838128831
curr_Factors:  [103.66645838]
mat_Sqrt:  [[0.15]]
grads:  [0.05521916]
Stock Position:  0.05521915697910742
Bond Position:  [-21.5381697]


portfolio before change:  [-15.77508274]
curr_Stock_Price:  104.39190768434621
curr_Factors:  [104.39190768]
mat_Sqrt:  [[0.15]]
grads:  [-0.08319532]
Stock Position:  -0.08319532454345432
Bond Position:  [-7.0901641]


portfolio before change:  [-15.80678089]
curr_Stock_Price:  104.76758986832186
curr_Factors:  [104.76758987]
mat_Sqrt:  [[0.15]]
grads:  [0.07717833]
Stock Position:  0.07717833389391227
Bond Position:  [-23.89256892]


portfolio before change:  [-15.80046437]
curr_Stock_Price:  104.86878207778807
curr_Factors:  [104.86878208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01169084]
Stock Position:  -0.011690843541755416
Bond Position:  [-14.57445985]


portfolio before change:  [-15.80375666]
curr_Stock_Price:  105.07247644845019
curr_Factors:  [105.07247645]
mat_Sqrt:  [[0.15]]
grads:  [0.07734639]
Stock Position:  0.07734638840624232
Bond Position:  [-23.93073324]


portfolio before change:  [-15.79828275]
curr_Stock_Price:  105.1625858411623
curr_Factors:  [105.16258584]
mat_Sqrt:  [[0.15]]
grads:  [0.0704494]
Stock Position:  0.07044940460031193
Bond Position:  [-23.2069243]


portfolio before change:  [-15.85139259]
curr_Stock_Price:  104.42930267159016
curr_Factors:  [104.42930267]
mat_Sqrt:  [[0.15]]
grads:  [-0.01672378]
Stock Position:  -0.0167237756715566
Bond Position:  [-14.10494035]


portfolio before change:  [-15.84121766]
curr_Stock_Price:  103.76817721355023
curr_Factors:  [103.76817721]
mat_Sqrt:  [[0.15]]
grads:  [0.08279091]
Stock Position:  0.08279091376659563
Bond Position:  [-24.43227987]


portfolio before change:  [-15.85787935]
curr_Stock_Price:  103.58537184249626
curr_Factors:  [103.58537184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00850877]
Stock Position:  -0.008508765034451322
Bond Position:  [-14.97649576]


portfolio before change:  [-15.86550927]
curr_Stock_Price:  104.37207402780447
curr_Factors:  [104.37207403]
mat_Sqrt:  [[0.15]]
grads:  [0.14031114]
Stock Position:  0.14031113747878785
Bond Position:  [-30.5100737]


portfolio before change:  [-15.9314557]
curr_Stock_Price:  103.91566345687204
curr_Factors:  [103.91566346]
mat_Sqrt:  [[0.15]]
grads:  [0.03251537]
Stock Position:  0.03251536650602245
Bond Position:  [-19.31031158]


portfolio before change:  [-15.95992637]
curr_Stock_Price:  103.07717572591639
curr_Factors:  [103.07717573]
mat_Sqrt:  [[0.15]]
grads:  [-0.00721361]
Stock Position:  -0.007213611561933054
Bond Position:  [-15.21636766]


portfolio before change:  [-15.95794322]
curr_Stock_Price:  102.67041770816653
curr_Factors:  [102.67041771]
mat_Sqrt:  [[0.15]]
grads:  [-0.08010473]
Stock Position:  -0.08010472635352979
Bond Position:  [-7.73355751]


portfolio before change:  [-15.95081441]
curr_Stock_Price:  102.57538991113499
curr_Factors:  [102.57538991]
mat_Sqrt:  [[0.15]]
grads:  [-0.01105627]
Stock Position:  -0.011056274933212507
Bond Position:  [-14.8167127]


portfolio before change:  [-15.95388545]
curr_Stock_Price:  102.76939403871553
curr_Factors:  [102.76939404]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097462]
Stock Position:  -0.02097462059118254
Bond Position:  [-13.7983364]


portfolio before change:  [-15.9762187]
curr_Stock_Price:  103.79305146058095
curr_Factors:  [103.79305146]
mat_Sqrt:  [[0.15]]
grads:  [0.06074738]
Stock Position:  0.060747380181499146
Bond Position:  [-22.28137465]


portfolio before change:  [-15.98230642]
curr_Stock_Price:  103.7157625605078
curr_Factors:  [103.71576256]
mat_Sqrt:  [[0.15]]
grads:  [-0.11280855]
Stock Position:  -0.11280855433531393
Bond Position:  [-4.28228119]


portfolio before change:  [-15.98256332]
curr_Stock_Price:  103.71566724060108
curr_Factors:  [103.71566724]
mat_Sqrt:  [[0.15]]
grads:  [0.02858872]
Stock Position:  0.028588716231639565
Bond Position:  [-18.9476611]


portfolio before change:  [-15.99541159]
curr_Stock_Price:  103.3076738932629
curr_Factors:  [103.30767389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02463875]
Stock Position:  -0.024638745859726204
Bond Position:  [-13.45004007]


portfolio before change:  [-15.98864404]
curr_Stock_Price:  102.998883606341
curr_Factors:  [102.99888361]
mat_Sqrt:  [[0.15]]
grads:  [-0.02167626]
Stock Position:  -0.021676255199143936
Bond Position:  [-13.75601396]


portfolio before change:  [-16.01149839]
curr_Stock_Price:  104.01356869482507
curr_Factors:  [104.01356869]
mat_Sqrt:  [[0.15]]
grads:  [0.03428457]
Stock Position:  0.0342845732388989
Bond Position:  [-19.57755921]


portfolio before change:  [-16.02106091]
curr_Stock_Price:  103.77034308310478
curr_Factors:  [103.77034308]
mat_Sqrt:  [[0.15]]
grads:  [-0.13212502]
Stock Position:  -0.1321250151493034
Bond Position:  [-2.31040276]


portfolio before change:  [-16.01455505]
curr_Stock_Price:  103.72000991628316
curr_Factors:  [103.72000992]
mat_Sqrt:  [[0.15]]
grads:  [0.007324]
Stock Position:  0.00732399942110218
Bond Position:  [-16.77420034]


portfolio before change:  [-16.01821904]
curr_Stock_Price:  103.36288602885978
curr_Factors:  [103.36288603]
mat_Sqrt:  [[0.15]]
grads:  [0.1342844]
Stock Position:  0.13428439509302492
Bond Position:  [-29.89824167]


portfolio before change:  [-16.13083096]
curr_Stock_Price:  102.53819437874775
curr_Factors:  [102.53819438]
mat_Sqrt:  [[0.15]]
grads:  [0.04795994]
Stock Position:  0.04795993640314378
Bond Position:  [-21.04855624]


portfolio before change:  [-16.09787941]
curr_Stock_Price:  103.25268923378445
curr_Factors:  [103.25268923]
mat_Sqrt:  [[0.15]]
grads:  [0.0832071]
Stock Position:  0.08320709711230811
Bond Position:  [-24.68923595]


portfolio before change:  [-16.06509902]
curr_Stock_Price:  103.66519630514115
curr_Factors:  [103.66519631]
mat_Sqrt:  [[0.15]]
grads:  [0.06314834]
Stock Position:  0.06314834362089036
Bond Position:  [-22.61138446]


portfolio before change:  [-16.07119085]
curr_Stock_Price:  103.59110774126734
curr_Factors:  [103.59110774]
mat_Sqrt:  [[0.15]]
grads:  [0.04226567]
Stock Position:  0.04226567479079958
Bond Position:  [-20.44953892]


portfolio before change:  [-16.11207439]
curr_Stock_Price:  102.65404922496896
curr_Factors:  [102.65404922]
mat_Sqrt:  [[0.15]]
grads:  [0.10736602]
Stock Position:  0.10736601684448052
Bond Position:  [-27.13363077]


portfolio before change:  [-16.05072118]
curr_Stock_Price:  103.2412845007188
curr_Factors:  [103.2412845]
mat_Sqrt:  [[0.15]]
grads:  [0.00560302]
Stock Position:  0.00560302324565484
Bond Position:  [-16.6291845]


portfolio before change:  [-16.04970883]
curr_Stock_Price:  103.60746300593722
curr_Factors:  [103.60746301]
mat_Sqrt:  [[0.15]]
grads:  [-0.1022351]
Stock Position:  -0.10223510439336246
Bond Position:  [-5.45738904]


portfolio before change:  [-16.05519648]
curr_Stock_Price:  103.65780327714897
curr_Factors:  [103.65780328]
mat_Sqrt:  [[0.15]]
grads:  [-0.03271582]
Stock Position:  -0.03271581944685761
Bond Position:  [-12.6639465]


portfolio before change:  [-16.01419997]
curr_Stock_Price:  102.38050002779136
curr_Factors:  [102.38050003]
mat_Sqrt:  [[0.15]]
grads:  [0.00829943]
Stock Position:  0.008299425028369221
Bond Position:  [-16.86389926]


portfolio before change:  [-16.01023285]
curr_Stock_Price:  102.98549933095236
curr_Factors:  [102.98549933]
mat_Sqrt:  [[0.15]]
grads:  [0.02607062]
Stock Position:  0.026070620792243
Bond Position:  [-18.69512875]


portfolio before change:  [-16.02583759]
curr_Stock_Price:  102.43176302430528
curr_Factors:  [102.43176302]
mat_Sqrt:  [[0.15]]
grads:  [-0.0994139]
Stock Position:  -0.09941389878731506
Bond Position:  [-5.84269666]


portfolio before change:  [-16.07983674]
curr_Stock_Price:  102.97126476255944
curr_Factors:  [102.97126476]
mat_Sqrt:  [[0.15]]
grads:  [-0.02420164]
Stock Position:  -0.024201644058294905
Bond Position:  [-13.58776284]


portfolio before change:  [-16.07023914]
curr_Stock_Price:  102.5396057499057
curr_Factors:  [102.53960575]
mat_Sqrt:  [[0.15]]
grads:  [0.09491151]
Stock Position:  0.09491150612092716
Bond Position:  [-25.80242756]


portfolio before change:  [-16.00548422]
curr_Stock_Price:  103.23886363906452
curr_Factors:  [103.23886364]
mat_Sqrt:  [[0.15]]
grads:  [-0.02906656]
Stock Position:  -0.029066555505955823
Bond Position:  [-13.00468606]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.99911524]
Stock Price:  102.9917823352107
PL:  [-18.99089757]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.66413506e-03]
 [ 3.53816056e-02]
 [ 1.92432054e-02]
 [-1.86103686e-02]
 [ 1.49443878e-02]
 [-6.06380299e-03]
 [-6.29013288e-03]
 [-2.90112834e-02]
 [ 1.27253785e-02]
 [-4.01537603e-03]
 [-8.78494828e-03]
 [ 1.44850270e-02]
 [-4.38593090e-03]
 [ 3.23978818e-03]
 [ 1.00830763e-02]
 [ 1.11527246e-02]
 [ 9.55452411e-02]
 [-1.17857423e-02]
 [ 2.23053777e-02]
 [ 5.38300415e-04]
 [-6.02987331e-03]
 [ 5.27114385e-03]
 [ 1.21768422e-02]
 [ 4.09257916e-02]
 [ 5.13410461e-03]
 [ 7.17460582e-03]
 [ 5.64649066e-02]
 [ 2.36629759e-02]
 [ 8.44277856e-03]
 [-8.65828850e-03]
 [ 5.03729575e-03]
 [ 1.55419459e-02]
 [ 1.65278913e-02]
 [-1.07558331e-02]
 [ 4.24477527e-03]
 [-5.85251558e-03]
 [-9.28995988e-03]
 [-1.81450568e-02]
 [ 1.30365078e-02]
 [-6.97757569e-02]
 [ 3.06421059e-03]
 [-7.26361092e-03]
 [-2.12751499e-02]
 [ 2.70414298e-02]
 [-1.39511588e-02]
 [ 1.17558540e-02]
 [ 1.04555568e-02]
 [-3.27059242e-03]
 [ 1.58492937e-02]
 [-1.63913328e-03]
 [ 1.78573457e-02]
 [ 3.09042034e-02]
 [-1.07443334e-02]
 [-8.93837811e-02]
 [-3.05999720e-02]
 [-1.48966050e-03]
 [-1.23290902e-02]
 [-1.59017392e-02]
 [-3.89600939e-03]
 [-2.77090887e-03]
 [-8.22622696e-03]
 [-9.25189258e-03]
 [-1.53760352e-02]
 [-1.04992626e-03]
 [-1.76183388e-02]
 [ 3.42214132e-02]
 [-6.34294459e-03]
 [ 2.45826881e-02]
 [ 9.60554692e-03]
 [ 1.19485106e-02]
 [ 1.10132630e-02]
 [-1.41139680e-02]
 [-6.60562663e-02]
 [ 3.97698926e-04]
 [-1.71828716e-02]
 [-3.20135925e-02]
 [-6.61353572e-03]
 [ 2.31388606e-02]
 [ 7.96450266e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.19718431]
curr_Stock_Price:  100.96137415196063
curr_Factors:  [100.96137415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04442757]
Stock Position:  -0.044427567081376
Bond Position:  [27.68265253]


portfolio before change:  [23.20334899]
curr_Stock_Price:  100.86156103978801
curr_Factors:  [100.86156104]
mat_Sqrt:  [[0.15]]
grads:  [0.23587737]
Stock Position:  0.23587737083949317
Bond Position:  [-0.58761085]


portfolio before change:  [23.12150253]
curr_Stock_Price:  100.51472944598996
curr_Factors:  [100.51472945]
mat_Sqrt:  [[0.15]]
grads:  [0.12828804]
Stock Position:  0.12828803629042732
Bond Position:  [10.22666528]


portfolio before change:  [23.15741715]
curr_Stock_Price:  100.78970000328904
curr_Factors:  [100.7897]
mat_Sqrt:  [[0.15]]
grads:  [-0.12406912]
Stock Position:  -0.12406912371805019
Bond Position:  [35.66230691]


portfolio before change:  [23.30916095]
curr_Stock_Price:  99.5846069711432
curr_Factors:  [99.58460697]
mat_Sqrt:  [[0.15]]
grads:  [0.09962925]
Stock Position:  0.09962925216352204
Bond Position:  [13.38762103]


portfolio before change:  [23.35086167]
curr_Stock_Price:  99.99476729203768
curr_Factors:  [99.99476729]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042535]
Stock Position:  -0.04042535325080722
Bond Position:  [27.39318546]


portfolio before change:  [23.32528248]
curr_Stock_Price:  100.66987131199096
curr_Factors:  [100.66987131]
mat_Sqrt:  [[0.15]]
grads:  [-0.04193422]
Stock Position:  -0.04193421917128979
Bond Position:  [27.54679493]


portfolio before change:  [23.31108567]
curr_Stock_Price:  101.049478806897
curr_Factors:  [101.04947881]
mat_Sqrt:  [[0.15]]
grads:  [-0.19340856]
Stock Position:  -0.19340855625440395
Bond Position:  [42.85491947]


portfolio before change:  [23.26433938]
curr_Stock_Price:  101.3050249002307
curr_Factors:  [101.3050249]
mat_Sqrt:  [[0.15]]
grads:  [0.08483586]
Stock Position:  0.08483585673641571
Bond Position:  [14.6700408]


portfolio before change:  [23.27757661]
curr_Stock_Price:  101.45025026268885
curr_Factors:  [101.45025026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676917]
Stock Position:  -0.02676917350116925
Bond Position:  [25.99331596]


portfolio before change:  [23.28191638]
curr_Stock_Price:  101.34882218458559
curr_Factors:  [101.34882218]
mat_Sqrt:  [[0.15]]
grads:  [-0.05856632]
Stock Position:  -0.05856632188554268
Bond Position:  [29.21754413]


portfolio before change:  [23.26937735]
curr_Stock_Price:  101.59410280314403
curr_Factors:  [101.5941028]
mat_Sqrt:  [[0.15]]
grads:  [0.09656685]
Stock Position:  0.09656684636487164
Bond Position:  [13.45875524]


portfolio before change:  [23.35089553]
curr_Stock_Price:  102.42955497563692
curr_Factors:  [102.42955498]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923954]
Stock Position:  -0.029239539315233286
Bond Position:  [26.34588853]


portfolio before change:  [23.34874818]
curr_Stock_Price:  102.55931159781694
curr_Factors:  [102.5593116]
mat_Sqrt:  [[0.15]]
grads:  [0.02159859]
Stock Position:  0.021598587865130633
Bond Position:  [21.13361188]


portfolio before change:  [23.35826892]
curr_Stock_Price:  102.93895901137851
curr_Factors:  [102.93895901]
mat_Sqrt:  [[0.15]]
grads:  [0.06722051]
Stock Position:  0.06722050868683098
Bond Position:  [16.43865973]


portfolio before change:  [23.31535496]
curr_Stock_Price:  102.28526855377942
curr_Factors:  [102.28526855]
mat_Sqrt:  [[0.15]]
grads:  [0.0743515]
Stock Position:  0.07435149723654975
Bond Position:  [15.7102921]


portfolio before change:  [23.30085133]
curr_Stock_Price:  102.0769936274968
curr_Factors:  [102.07699363]
mat_Sqrt:  [[0.15]]
grads:  [0.63696827]
Stock Position:  0.6369682741164265
Bond Position:  [-41.71895512]


portfolio before change:  [23.47021917]
curr_Stock_Price:  102.346984076239
curr_Factors:  [102.34698408]
mat_Sqrt:  [[0.15]]
grads:  [-0.07857162]
Stock Position:  -0.07857161559470978
Bond Position:  [31.51178706]


portfolio before change:  [23.46425104]
curr_Stock_Price:  102.44800877821734
curr_Factors:  [102.44800878]
mat_Sqrt:  [[0.15]]
grads:  [0.14870252]
Stock Position:  0.14870251804217552
Bond Position:  [8.22997417]


portfolio before change:  [23.51416303]
curr_Stock_Price:  102.78019953629453
curr_Factors:  [102.78019954]
mat_Sqrt:  [[0.15]]
grads:  [0.00358867]
Stock Position:  0.003588669435429652
Bond Position:  [23.14531887]


portfolio before change:  [23.51531195]
curr_Stock_Price:  102.69724074289101
curr_Factors:  [102.69724074]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019916]
Stock Position:  -0.040199155377494786
Bond Position:  [27.64365429]


portfolio before change:  [23.53524635]
curr_Stock_Price:  102.24433026497263
curr_Factors:  [102.24433026]
mat_Sqrt:  [[0.15]]
grads:  [0.03514096]
Stock Position:  0.03514095902850172
Bond Position:  [19.94228253]


portfolio before change:  [23.51530667]
curr_Stock_Price:  101.64144072022937
curr_Factors:  [101.64144072]
mat_Sqrt:  [[0.15]]
grads:  [0.08117895]
Stock Position:  0.0811789483022152
Bond Position:  [15.2641614]


portfolio before change:  [23.63157836]
curr_Stock_Price:  103.06197712341138
curr_Factors:  [103.06197712]
mat_Sqrt:  [[0.15]]
grads:  [0.27283861]
Stock Position:  0.2728386107312742
Bond Position:  [-4.4877083]


portfolio before change:  [23.92520099]
curr_Stock_Price:  104.13918213834012
curr_Factors:  [104.13918214]
mat_Sqrt:  [[0.15]]
grads:  [0.03422736]
Stock Position:  0.034227364033896535
Bond Position:  [20.36079129]


portfolio before change:  [23.91309105]
curr_Stock_Price:  103.74819302857748
curr_Factors:  [103.74819303]
mat_Sqrt:  [[0.15]]
grads:  [0.04783071]
Stock Position:  0.0478307054752476
Bond Position:  [18.95074178]


portfolio before change:  [23.92171714]
curr_Stock_Price:  103.90377580656605
curr_Factors:  [103.90377581]
mat_Sqrt:  [[0.15]]
grads:  [0.37643271]
Stock Position:  0.3764327105657505
Bond Position:  [-15.19106282]


portfolio before change:  [23.73404339]
curr_Stock_Price:  103.40773953614678
curr_Factors:  [103.40773954]
mat_Sqrt:  [[0.15]]
grads:  [0.15775317]
Stock Position:  0.1577531726042204
Bond Position:  [7.42114441]


portfolio before change:  [23.84047649]
curr_Stock_Price:  104.0794804666181
curr_Factors:  [104.07948047]
mat_Sqrt:  [[0.15]]
grads:  [0.05628519]
Stock Position:  0.0562851903794234
Bond Position:  [17.98234312]


portfolio before change:  [23.90342294]
curr_Stock_Price:  105.17786035301222
curr_Factors:  [105.17786035]
mat_Sqrt:  [[0.15]]
grads:  [-0.05772192]
Stock Position:  -0.05772192330027568
Bond Position:  [29.97449133]


portfolio before change:  [23.93786078]
curr_Stock_Price:  104.6137008161184
curr_Factors:  [104.61370082]
mat_Sqrt:  [[0.15]]
grads:  [0.03358197]
Stock Position:  0.03358197169187867
Bond Position:  [20.42472644]


portfolio before change:  [23.94265206]
curr_Stock_Price:  104.71836094869538
curr_Factors:  [104.71836095]
mat_Sqrt:  [[0.15]]
grads:  [0.10361297]
Stock Position:  0.10361297268927684
Bond Position:  [13.09247139]


portfolio before change:  [23.99772799]
curr_Stock_Price:  105.24201759971997
curr_Factors:  [105.2420176]
mat_Sqrt:  [[0.15]]
grads:  [0.11018594]
Stock Position:  0.11018594187847278
Bond Position:  [12.40153715]


portfolio before change:  [24.03187917]
curr_Stock_Price:  105.5449242835
curr_Factors:  [105.54492428]
mat_Sqrt:  [[0.15]]
grads:  [-0.07170555]
Stock Position:  -0.07170555424476517
Bond Position:  [31.60003646]


portfolio before change:  [24.09666053]
curr_Stock_Price:  104.6690326125732
curr_Factors:  [104.66903261]
mat_Sqrt:  [[0.15]]
grads:  [0.0282985]
Stock Position:  0.028298501826662534
Bond Position:  [21.13468372]


portfolio before change:  [24.0877048]
curr_Stock_Price:  104.3058793842689
curr_Factors:  [104.30587938]
mat_Sqrt:  [[0.15]]
grads:  [-0.03901677]
Stock Position:  -0.039016770556516034
Bond Position:  [28.15738336]


portfolio before change:  [24.0425633]
curr_Stock_Price:  105.50796220746571
curr_Factors:  [105.50796221]
mat_Sqrt:  [[0.15]]
grads:  [-0.06193307]
Stock Position:  -0.06193306588670438
Bond Position:  [30.57699487]


portfolio before change:  [23.97175995]
curr_Stock_Price:  106.68204377235244
curr_Factors:  [106.68204377]
mat_Sqrt:  [[0.15]]
grads:  [-0.12096705]
Stock Position:  -0.12096704501890529
Bond Position:  [36.87677154]


portfolio before change:  [24.07501588]
curr_Stock_Price:  105.84751019031856
curr_Factors:  [105.84751019]
mat_Sqrt:  [[0.15]]
grads:  [0.08691005]
Stock Position:  0.08691005177811856
Bond Position:  [14.87580329]


portfolio before change:  [24.12606442]
curr_Stock_Price:  106.42418429906445
curr_Factors:  [106.4241843]
mat_Sqrt:  [[0.15]]
grads:  [-0.46517171]
Stock Position:  -0.4651717124927959
Bond Position:  [73.63158448]


portfolio before change:  [23.58723776]
curr_Stock_Price:  107.59241695614324
curr_Factors:  [107.59241696]
mat_Sqrt:  [[0.15]]
grads:  [0.02042807]
Stock Position:  0.020428070586472
Bond Position:  [21.38933227]


portfolio before change:  [23.58143917]
curr_Stock_Price:  107.24312003955478
curr_Factors:  [107.24312004]
mat_Sqrt:  [[0.15]]
grads:  [-0.04842407]
Stock Position:  -0.0484240728104119
Bond Position:  [28.77458782]


portfolio before change:  [23.58061234]
curr_Stock_Price:  107.29733467302644
curr_Factors:  [107.29733467]
mat_Sqrt:  [[0.15]]
grads:  [-0.14183433]
Stock Position:  -0.14183433266002726
Bond Position:  [38.7990582]


portfolio before change:  [23.57403616]
curr_Stock_Price:  107.36079744162645
curr_Factors:  [107.36079744]
mat_Sqrt:  [[0.15]]
grads:  [0.1802762]
Stock Position:  0.18027619866827144
Bond Position:  [4.21943971]


portfolio before change:  [23.59108501]
curr_Stock_Price:  107.45390529109227
curr_Factors:  [107.45390529]
mat_Sqrt:  [[0.15]]
grads:  [-0.09300773]
Stock Position:  -0.09300772554605842
Bond Position:  [33.58512834]


portfolio before change:  [23.68190039]
curr_Stock_Price:  106.50004639895876
curr_Factors:  [106.5000464]
mat_Sqrt:  [[0.15]]
grads:  [0.07837236]
Stock Position:  0.07837236030252634
Bond Position:  [15.33524039]


portfolio before change:  [23.6923592]
curr_Stock_Price:  106.62126667500769
curr_Factors:  [106.62126668]
mat_Sqrt:  [[0.15]]
grads:  [0.06970371]
Stock Position:  0.06970371179849916
Bond Position:  [16.26046115]


portfolio before change:  [23.66473956]
curr_Stock_Price:  106.21044285229469
curr_Factors:  [106.21044285]
mat_Sqrt:  [[0.15]]
grads:  [-0.02180395]
Stock Position:  -0.02180394949862047
Bond Position:  [25.98054669]


portfolio before change:  [23.63464635]
curr_Stock_Price:  107.6650895714125
curr_Factors:  [107.66508957]
mat_Sqrt:  [[0.15]]
grads:  [0.10566196]
Stock Position:  0.1056619580511412
Bond Position:  [12.25854218]


portfolio before change:  [23.68921781]
curr_Stock_Price:  108.17431045922916
curr_Factors:  [108.17431046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01092756]
Stock Position:  -0.010927555169167007
Bond Position:  [24.87129856]


portfolio before change:  [23.69591353]
curr_Stock_Price:  107.70382846941514
curr_Factors:  [107.70382847]
mat_Sqrt:  [[0.15]]
grads:  [0.11904897]
Stock Position:  0.11904897115279665
Bond Position:  [10.87388357]


portfolio before change:  [23.7325856]
curr_Stock_Price:  108.00616140731782
curr_Factors:  [108.00616141]
mat_Sqrt:  [[0.15]]
grads:  [0.20602802]
Stock Position:  0.2060280226029406
Bond Position:  [1.48028973]


portfolio before change:  [23.85650932]
curr_Stock_Price:  108.60720199986125
curr_Factors:  [108.607202]
mat_Sqrt:  [[0.15]]
grads:  [-0.07162889]
Stock Position:  -0.07162888933237992
Bond Position:  [31.63592258]


portfolio before change:  [23.82157778]
curr_Stock_Price:  109.12248083538525
curr_Factors:  [109.12248084]
mat_Sqrt:  [[0.15]]
grads:  [-0.59589187]
Stock Position:  -0.5958918741278119
Bond Position:  [88.8467774]


portfolio before change:  [23.8005531]
curr_Stock_Price:  109.16708250803437
curr_Factors:  [109.16708251]
mat_Sqrt:  [[0.15]]
grads:  [-0.20399981]
Stock Position:  -0.20399981341443146
Bond Position:  [46.07061757]


portfolio before change:  [23.78816031]
curr_Stock_Price:  109.24194679077125
curr_Factors:  [109.24194679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00993107]
Stock Position:  -0.009931069994569521
Bond Position:  [24.87304973]


portfolio before change:  [23.78565677]
curr_Stock_Price:  109.65057883177546
curr_Factors:  [109.65057883]
mat_Sqrt:  [[0.15]]
grads:  [-0.08219393]
Stock Position:  -0.08219393463203407
Bond Position:  [32.79826928]


portfolio before change:  [23.75322914]
curr_Stock_Price:  110.07004506779582
curr_Factors:  [110.07004507]
mat_Sqrt:  [[0.15]]
grads:  [-0.10601159]
Stock Position:  -0.10601159471034521
Bond Position:  [35.42193015]


portfolio before change:  [23.7067384]
curr_Stock_Price:  110.52947293677528
curr_Factors:  [110.52947294]
mat_Sqrt:  [[0.15]]
grads:  [-0.0259734]
Stock Position:  -0.025973395915827736
Bond Position:  [26.57756416]


portfolio before change:  [23.73181853]
curr_Stock_Price:  109.62782031526163
curr_Factors:  [109.62782032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847273]
Stock Position:  -0.018472725812959855
Bond Position:  [25.7569432]


portfolio before change:  [23.71975295]
curr_Stock_Price:  110.3681246983156
curr_Factors:  [110.3681247]
mat_Sqrt:  [[0.15]]
grads:  [-0.05484151]
Stock Position:  -0.054841513051411515
Bond Position:  [29.7725079]


portfolio before change:  [23.76497775]
curr_Stock_Price:  109.57741053925288
curr_Factors:  [109.57741054]
mat_Sqrt:  [[0.15]]
grads:  [-0.06167928]
Stock Position:  -0.06167928385955225
Bond Position:  [30.52363396]


portfolio before change:  [23.76210264]
curr_Stock_Price:  109.65495523275811
curr_Factors:  [109.65495523]
mat_Sqrt:  [[0.15]]
grads:  [-0.1025069]
Stock Position:  -0.10250690115110461
Bond Position:  [35.0024923]


portfolio before change:  [23.68943313]
curr_Stock_Price:  110.38522054307427
curr_Factors:  [110.38522054]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699951]
Stock Position:  -0.006999508412172962
Bond Position:  [24.46207541]


portfolio before change:  [23.69239071]
curr_Stock_Price:  110.181112382328
curr_Factors:  [110.18111238]
mat_Sqrt:  [[0.15]]
grads:  [-0.11745559]
Stock Position:  -0.11745559226566299
Bond Position:  [36.63377852]


portfolio before change:  [23.78313293]
curr_Stock_Price:  109.4280402653612
curr_Factors:  [109.42804027]
mat_Sqrt:  [[0.15]]
grads:  [0.22814275]
Stock Position:  0.22814275447420593
Bond Position:  [-1.1820816]


portfolio before change:  [23.74745966]
curr_Stock_Price:  109.27200031687705
curr_Factors:  [109.27200032]
mat_Sqrt:  [[0.15]]
grads:  [-0.0422863]
Stock Position:  -0.04228629729346196
Bond Position:  [28.36816795]


portfolio before change:  [23.71625665]
curr_Stock_Price:  110.05182917979961
curr_Factors:  [110.05182918]
mat_Sqrt:  [[0.15]]
grads:  [0.16388459]
Stock Position:  0.1638845875178706
Bond Position:  [5.68045802]


portfolio before change:  [23.6237676]
curr_Stock_Price:  109.48530799996395
curr_Factors:  [109.485308]
mat_Sqrt:  [[0.15]]
grads:  [0.06403698]
Stock Position:  0.06403697946194478
Bond Position:  [16.61265918]


portfolio before change:  [23.64536128]
curr_Stock_Price:  109.80629995060495
curr_Factors:  [109.80629995]
mat_Sqrt:  [[0.15]]
grads:  [0.07965674]
Stock Position:  0.07965673724272207
Bond Position:  [14.8985497]


portfolio before change:  [23.71557896]
curr_Stock_Price:  110.67611324420096
curr_Factors:  [110.67611324]
mat_Sqrt:  [[0.15]]
grads:  [0.07342175]
Stock Position:  0.07342175345526568
Bond Position:  [15.58954466]


portfolio before change:  [23.71461631]
curr_Stock_Price:  110.6497310913682
curr_Factors:  [110.64973109]
mat_Sqrt:  [[0.15]]
grads:  [-0.09409312]
Stock Position:  -0.09409312020026073
Bond Position:  [34.12599476]


portfolio before change:  [23.7639023]
curr_Stock_Price:  110.14859933911976
curr_Factors:  [110.14859934]
mat_Sqrt:  [[0.15]]
grads:  [-0.44037511]
Stock Position:  -0.4403751084019143
Bond Position:  [72.27060368]


portfolio before change:  [23.97930168]
curr_Stock_Price:  109.66972957270488
curr_Factors:  [109.66972957]
mat_Sqrt:  [[0.15]]
grads:  [0.00265133]
Stock Position:  0.0026513261745497335
Bond Position:  [23.68853146]


portfolio before change:  [23.9836774]
curr_Stock_Price:  110.7616886674656
curr_Factors:  [110.76168867]
mat_Sqrt:  [[0.15]]
grads:  [-0.11455248]
Stock Position:  -0.11455247753004334
Bond Position:  [36.67170325]


portfolio before change:  [24.07332579]
curr_Stock_Price:  109.9991007596538
curr_Factors:  [109.99910076]
mat_Sqrt:  [[0.15]]
grads:  [-0.21342395]
Stock Position:  -0.21342395007333728
Bond Position:  [47.54976838]


portfolio before change:  [24.08484901]
curr_Stock_Price:  109.9590336907478
curr_Factors:  [109.95903369]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409024]
Stock Position:  -0.044090238147334725
Bond Position:  [28.932969]


portfolio before change:  [24.09984414]
curr_Stock_Price:  109.6599479084468
curr_Factors:  [109.65994791]
mat_Sqrt:  [[0.15]]
grads:  [0.15425907]
Stock Position:  0.15425907078714923
Bond Position:  [7.18380248]


portfolio before change:  [24.0391673]
curr_Stock_Price:  109.26369345420913
curr_Factors:  [109.26369345]
mat_Sqrt:  [[0.15]]
grads:  [0.53096684]
Stock Position:  0.5309668436677781
Bond Position:  [-33.97623114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.71187635]
Stock Price:  108.65128729376688
PL:  [15.06058906]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-9.24207730e-03]
 [ 3.88914635e-02]
 [ 2.07554302e-02]
 [-1.01313563e-02]
 [-1.63554879e-02]
 [-1.88317674e-03]
 [ 1.32925534e-03]
 [-2.04550917e-02]
 [ 3.30372341e-03]
 [ 1.46042180e-03]
 [ 2.47993409e-04]
 [ 4.66509971e-04]
 [-2.77378038e-03]
 [ 9.64534610e-03]
 [ 6.57984535e-04]
 [ 1.57904074e-02]
 [ 5.73915883e-02]
 [-1.46590487e-02]
 [ 1.95679467e-02]
 [ 1.83269371e-03]
 [-4.43759109e-03]
 [ 4.53955153e-03]
 [ 1.52781946e-02]
 [ 1.74211961e-02]
 [-5.62543185e-03]
 [ 4.55190338e-03]
 [ 1.97467936e-03]
 [ 8.24310292e-03]
 [ 1.55709077e-02]
 [ 1.38521705e-02]
 [-6.43395318e-03]
 [ 7.60275756e-03]
 [ 1.20237513e-02]
 [ 1.03801895e-03]
 [ 7.61027371e-03]
 [ 1.27333039e-02]
 [-2.78257884e-02]
 [ 2.72396747e-03]
 [-4.05217556e-02]
 [ 6.81289500e-04]
 [ 6.46444717e-03]
 [ 7.28230228e-03]
 [-4.40162954e-03]
 [-4.08409158e-03]
 [ 1.05513322e-02]
 [ 1.29345562e-02]
 [ 1.06634698e-02]
 [ 3.09998745e-04]
 [ 1.54162245e-02]
 [-1.30327289e-03]
 [ 1.00899054e-02]
 [-1.61249124e-02]
 [ 1.91453985e-03]
 [-3.01185978e-03]
 [-3.43149278e-03]
 [-3.29803018e-03]
 [ 1.06661510e-02]
 [-1.25940244e-02]
 [ 5.85353515e-03]
 [-3.68355200e-03]
 [-4.86191125e-03]
 [ 4.11823116e-03]
 [-1.96342526e-02]
 [ 8.41649391e-04]
 [ 1.84578452e-02]
 [ 1.22843655e-02]
 [ 8.37246040e-03]
 [ 9.66710763e-03]
 [ 6.60758618e-03]
 [ 1.11999508e-02]
 [ 2.35773947e-03]
 [-1.52620966e-02]
 [-1.07149578e-02]
 [ 9.95303254e-04]
 [ 7.59823271e-04]
 [-1.91046711e-02]
 [-4.11491195e-03]
 [ 1.14463244e-02]
 [-4.79769999e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.98736014]
curr_Stock_Price:  101.40602387536566
curr_Factors:  [101.40602388]
mat_Sqrt:  [[0.15]]
grads:  [-0.06161385]
Stock Position:  -0.06161384866675034
Bond Position:  [39.23537555]


portfolio before change:  [33.01668946]
curr_Stock_Price:  100.9698066122738
curr_Factors:  [100.96980661]
mat_Sqrt:  [[0.15]]
grads:  [0.25927642]
Stock Position:  0.2592764231319033
Bond Position:  [6.83759915]


portfolio before change:  [32.98889497]
curr_Stock_Price:  100.86095810481453
curr_Factors:  [100.8609581]
mat_Sqrt:  [[0.15]]
grads:  [0.13836953]
Stock Position:  0.13836953490252143
Bond Position:  [19.0328111]


portfolio before change:  [32.92761347]
curr_Stock_Price:  100.4094780262026
curr_Factors:  [100.40947803]
mat_Sqrt:  [[0.15]]
grads:  [-0.06754238]
Stock Position:  -0.0675423753826562
Bond Position:  [39.70950812]


portfolio before change:  [32.89493492]
curr_Stock_Price:  100.93004703047035
curr_Factors:  [100.93004703]
mat_Sqrt:  [[0.15]]
grads:  [-0.10903659]
Stock Position:  -0.1090365858280989
Bond Position:  [43.90000266]


portfolio before change:  [32.93557325]
curr_Stock_Price:  100.58250776622154
curr_Factors:  [100.58250777]
mat_Sqrt:  [[0.15]]
grads:  [-0.01255451]
Stock Position:  -0.012554511570732726
Bond Position:  [34.19833751]


portfolio before change:  [32.94319935]
curr_Stock_Price:  100.14532382625535
curr_Factors:  [100.14532383]
mat_Sqrt:  [[0.15]]
grads:  [0.0088617]
Stock Position:  0.008861702292283306
Bond Position:  [32.0557413]


portfolio before change:  [32.94925391]
curr_Stock_Price:  100.60246129232519
curr_Factors:  [100.60246129]
mat_Sqrt:  [[0.15]]
grads:  [-0.13636728]
Stock Position:  -0.1363672778914919
Bond Position:  [46.6681377]


portfolio before change:  [32.96693751]
curr_Stock_Price:  100.49417463643164
curr_Factors:  [100.49417464]
mat_Sqrt:  [[0.15]]
grads:  [0.02202482]
Stock Position:  0.02202482273896513
Bond Position:  [30.75357113]


portfolio before change:  [32.97353527]
curr_Stock_Price:  100.70646248900154
curr_Factors:  [100.70646249]
mat_Sqrt:  [[0.15]]
grads:  [0.00973615]
Stock Position:  0.009736145304232632
Bond Position:  [31.99304252]


portfolio before change:  [32.97604688]
curr_Stock_Price:  100.75904727915307
curr_Factors:  [100.75904728]
mat_Sqrt:  [[0.15]]
grads:  [0.00165329]
Stock Position:  0.0016532893903294678
Bond Position:  [32.80946301]


portfolio before change:  [32.97782081]
curr_Stock_Price:  100.59167036968697
curr_Factors:  [100.59167037]
mat_Sqrt:  [[0.15]]
grads:  [0.00311007]
Stock Position:  0.003110066470046434
Bond Position:  [32.66497403]


portfolio before change:  [32.97977205]
curr_Stock_Price:  100.56261004655704
curr_Factors:  [100.56261005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01849187]
Stock Position:  -0.018491869189862776
Bond Position:  [34.83936268]


portfolio before change:  [32.99060219]
curr_Stock_Price:  100.09469584882436
curr_Factors:  [100.09469585]
mat_Sqrt:  [[0.15]]
grads:  [0.06430231]
Stock Position:  0.06430230732452939
Bond Position:  [26.5542823]


portfolio before change:  [33.06486601]
curr_Stock_Price:  101.22380188896985
curr_Factors:  [101.22380189]
mat_Sqrt:  [[0.15]]
grads:  [0.00438656]
Stock Position:  0.004386563567798154
Bond Position:  [32.62084137]


portfolio before change:  [33.06701878]
curr_Stock_Price:  101.24976937421881
curr_Factors:  [101.24976937]
mat_Sqrt:  [[0.15]]
grads:  [0.10526938]
Stock Position:  0.10526938284805067
Bond Position:  [22.40851805]


portfolio before change:  [33.05111946]
curr_Stock_Price:  101.08543008354862
curr_Factors:  [101.08543008]
mat_Sqrt:  [[0.15]]
grads:  [0.38261059]
Stock Position:  0.3826105887467586
Bond Position:  [-5.62523645]


portfolio before change:  [32.92502732]
curr_Stock_Price:  100.7567916277158
curr_Factors:  [100.75679163]
mat_Sqrt:  [[0.15]]
grads:  [-0.09772699]
Stock Position:  -0.09772699150842358
Bond Position:  [42.77168544]


portfolio before change:  [32.97552948]
curr_Stock_Price:  100.267378822967
curr_Factors:  [100.26737882]
mat_Sqrt:  [[0.15]]
grads:  [0.13045298]
Stock Position:  0.13045297767151454
Bond Position:  [19.89535135]


portfolio before change:  [33.07667401]
curr_Stock_Price:  101.03317995286426
curr_Factors:  [101.03317995]
mat_Sqrt:  [[0.15]]
grads:  [0.01221796]
Stock Position:  0.012217958069507266
Bond Position:  [31.84225486]


portfolio before change:  [33.08548011]
curr_Stock_Price:  101.59103841598025
curr_Factors:  [101.59103842]
mat_Sqrt:  [[0.15]]
grads:  [-0.02958394]
Stock Position:  -0.02958394056889425
Bond Position:  [36.09094335]


portfolio before change:  [33.09576752]
curr_Stock_Price:  101.31955134521355
curr_Factors:  [101.31955135]
mat_Sqrt:  [[0.15]]
grads:  [0.03026368]
Stock Position:  0.03026367684540677
Bond Position:  [30.02946536]


portfolio before change:  [33.07050714]
curr_Stock_Price:  100.42285667259094
curr_Factors:  [100.42285667]
mat_Sqrt:  [[0.15]]
grads:  [0.10185463]
Stock Position:  0.10185463041763561
Bond Position:  [22.84197419]


portfolio before change:  [33.01933109]
curr_Stock_Price:  99.9063978922942
curr_Factors:  [99.90639789]
mat_Sqrt:  [[0.15]]
grads:  [0.11614131]
Stock Position:  0.1161413076188629
Bond Position:  [21.4160714]


portfolio before change:  [33.00798923]
curr_Stock_Price:  99.79721703395042
curr_Factors:  [99.79721703]
mat_Sqrt:  [[0.15]]
grads:  [-0.03750288]
Stock Position:  -0.03750287899624322
Bond Position:  [36.75067218]


portfolio before change:  [33.01136143]
curr_Stock_Price:  99.76854696861874
curr_Factors:  [99.76854697]
mat_Sqrt:  [[0.15]]
grads:  [0.03034602]
Stock Position:  0.030346022542216824
Bond Position:  [29.98378285]


portfolio before change:  [33.01961141]
curr_Stock_Price:  99.9786548440515
curr_Factors:  [99.97865484]
mat_Sqrt:  [[0.15]]
grads:  [0.01316453]
Stock Position:  0.013164529083927746
Bond Position:  [31.7034395]


portfolio before change:  [33.01576592]
curr_Stock_Price:  99.53602468907913
curr_Factors:  [99.53602469]
mat_Sqrt:  [[0.15]]
grads:  [0.05495402]
Stock Position:  0.05495401945070142
Bond Position:  [27.54586128]


portfolio before change:  [32.99785034]
curr_Stock_Price:  99.17868500268902
curr_Factors:  [99.178685]
mat_Sqrt:  [[0.15]]
grads:  [0.10380605]
Stock Position:  0.10380605157039194
Bond Position:  [22.70250265]


portfolio before change:  [32.89388457]
curr_Stock_Price:  98.16347715115066
curr_Factors:  [98.16347715]
mat_Sqrt:  [[0.15]]
grads:  [0.0923478]
Stock Position:  0.0923478033547325
Bond Position:  [23.82870309]


portfolio before change:  [32.98063874]
curr_Stock_Price:  99.08677819785414
curr_Factors:  [99.0867782]
mat_Sqrt:  [[0.15]]
grads:  [-0.04289302]
Stock Position:  -0.04289302117458645
Bond Position:  [37.23077001]


portfolio before change:  [32.92343686]
curr_Stock_Price:  100.4746233449188
curr_Factors:  [100.47462334]
mat_Sqrt:  [[0.15]]
grads:  [0.05068505]
Stock Position:  0.05068505042621136
Bond Position:  [27.83087551]


portfolio before change:  [32.89028591]
curr_Stock_Price:  99.78624607944717
curr_Factors:  [99.78624608]
mat_Sqrt:  [[0.15]]
grads:  [0.08015834]
Stock Position:  0.08015834201290042
Bond Position:  [24.89158587]


portfolio before change:  [32.93034792]
curr_Stock_Price:  100.26662333425418
curr_Factors:  [100.26662333]
mat_Sqrt:  [[0.15]]
grads:  [0.00692013]
Stock Position:  0.006920126361714615
Bond Position:  [32.23649022]


portfolio before change:  [32.92980678]
curr_Stock_Price:  99.89726772675928
curr_Factors:  [99.89726773]
mat_Sqrt:  [[0.15]]
grads:  [0.05073516]
Stock Position:  0.05073515807474655
Bond Position:  [27.86150311]


portfolio before change:  [33.00660455]
curr_Stock_Price:  101.37664369746197
curr_Factors:  [101.3766437]
mat_Sqrt:  [[0.15]]
grads:  [0.08488869]
Stock Position:  0.0848886924232036
Bond Position:  [24.40087383]


portfolio before change:  [32.99422164]
curr_Stock_Price:  101.21280546756977
curr_Factors:  [101.21280547]
mat_Sqrt:  [[0.15]]
grads:  [-0.18550526]
Stock Position:  -0.1855052563272467
Bond Position:  [51.76972906]


portfolio before change:  [33.11404046]
curr_Stock_Price:  100.58434292618134
curr_Factors:  [100.58434293]
mat_Sqrt:  [[0.15]]
grads:  [0.01815978]
Stock Position:  0.018159783127700512
Bond Position:  [31.2874506]


portfolio before change:  [33.13579923]
curr_Stock_Price:  101.67484294386854
curr_Factors:  [101.67484294]
mat_Sqrt:  [[0.15]]
grads:  [-0.27014504]
Stock Position:  -0.27014503743454
Bond Position:  [60.60275348]


portfolio before change:  [33.28362379]
curr_Stock_Price:  101.14165983684023
curr_Factors:  [101.14165984]
mat_Sqrt:  [[0.15]]
grads:  [0.00454193]
Stock Position:  0.004541929997719357
Bond Position:  [32.82424545]


portfolio before change:  [33.28452135]
curr_Stock_Price:  100.88757934109911
curr_Factors:  [100.88757934]
mat_Sqrt:  [[0.15]]
grads:  [0.04309631]
Stock Position:  0.043096314463740654
Bond Position:  [28.93663851]


portfolio before change:  [33.29602007]
curr_Stock_Price:  101.11242746646023
curr_Factors:  [101.11242747]
mat_Sqrt:  [[0.15]]
grads:  [0.04854868]
Stock Position:  0.04854868183725435
Bond Position:  [28.387145]


portfolio before change:  [33.31916525]
curr_Stock_Price:  101.55262321199078
curr_Factors:  [101.55262321]
mat_Sqrt:  [[0.15]]
grads:  [-0.0293442]
Stock Position:  -0.029344196959348916
Bond Position:  [36.29914543]


portfolio before change:  [33.31655012]
curr_Stock_Price:  101.71905810468024
curr_Factors:  [101.7190581]
mat_Sqrt:  [[0.15]]
grads:  [-0.02722728]
Stock Position:  -0.027227277212983868
Bond Position:  [36.08608311]


portfolio before change:  [33.30393488]
curr_Stock_Price:  102.26522672387155
curr_Factors:  [102.26522672]
mat_Sqrt:  [[0.15]]
grads:  [0.07034221]
Stock Position:  0.07034221451264407
Bond Position:  [26.11037237]


portfolio before change:  [33.27492024]
curr_Stock_Price:  101.82954819770536
curr_Factors:  [101.8295482]
mat_Sqrt:  [[0.15]]
grads:  [0.08623037]
Stock Position:  0.08623037475268105
Bond Position:  [24.49412014]


portfolio before change:  [33.25115208]
curr_Stock_Price:  101.53615861782048
curr_Factors:  [101.53615862]
mat_Sqrt:  [[0.15]]
grads:  [0.0710898]
Stock Position:  0.07108979842670815
Bond Position:  [26.03296703]


portfolio before change:  [33.28782377]
curr_Stock_Price:  102.02912072675151
curr_Factors:  [102.02912073]
mat_Sqrt:  [[0.15]]
grads:  [0.00206666]
Stock Position:  0.002066658300835276
Bond Position:  [33.07696444]


portfolio before change:  [33.2895062]
curr_Stock_Price:  101.84285783430923
curr_Factors:  [101.84285783]
mat_Sqrt:  [[0.15]]
grads:  [0.10277483]
Stock Position:  0.10277482999029974
Bond Position:  [22.8226238]


portfolio before change:  [33.23101618]
curr_Stock_Price:  101.25986997135226
curr_Factors:  [101.25986997]
mat_Sqrt:  [[0.15]]
grads:  [-0.00868849]
Stock Position:  -0.008688485905408081
Bond Position:  [34.11081113]


portfolio before change:  [33.23400338]
curr_Stock_Price:  101.1614400923755
curr_Factors:  [101.16144009]
mat_Sqrt:  [[0.15]]
grads:  [0.06726604]
Stock Position:  0.06726603612336203
Bond Position:  [26.42927429]


portfolio before change:  [33.23648957]
curr_Stock_Price:  101.17384327374549
curr_Factors:  [101.17384327]
mat_Sqrt:  [[0.15]]
grads:  [-0.10749942]
Stock Position:  -0.10749941605763587
Bond Position:  [44.11261864]


portfolio before change:  [33.22752921]
curr_Stock_Price:  101.28284376792193
curr_Factors:  [101.28284377]
mat_Sqrt:  [[0.15]]
grads:  [0.0127636]
Stock Position:  0.012763598983629831
Bond Position:  [31.93479561]


portfolio before change:  [33.23445097]
curr_Stock_Price:  101.66876735715576
curr_Factors:  [101.66876736]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007907]
Stock Position:  -0.020079065185655276
Bond Position:  [35.27586478]


portfolio before change:  [33.23212417]
curr_Stock_Price:  101.89445554974137
curr_Factors:  [101.89445555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02287662]
Stock Position:  -0.022876618532516563
Bond Position:  [35.56312476]


portfolio before change:  [33.22910327]
curr_Stock_Price:  102.12367066826859
curr_Factors:  [102.12367067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02198687]
Stock Position:  -0.021986867896512486
Bond Position:  [35.47448293]


portfolio before change:  [33.2237837]
curr_Stock_Price:  102.46645681004465
curr_Factors:  [102.46645681]
mat_Sqrt:  [[0.15]]
grads:  [0.07110767]
Stock Position:  0.07110767333126707
Bond Position:  [25.93763236]


portfolio before change:  [33.2738857]
curr_Stock_Price:  103.14825166342838
curr_Factors:  [103.14825166]
mat_Sqrt:  [[0.15]]
grads:  [-0.08396016]
Stock Position:  -0.0839601624484245
Bond Position:  [41.93422966]


portfolio before change:  [33.33562447]
curr_Stock_Price:  102.4441344246989
curr_Factors:  [102.44413442]
mat_Sqrt:  [[0.15]]
grads:  [0.03902357]
Stock Position:  0.03902356768321651
Bond Position:  [29.33788885]


portfolio before change:  [33.37288989]
curr_Stock_Price:  103.35209215144096
curr_Factors:  [103.35209215]
mat_Sqrt:  [[0.15]]
grads:  [-0.02455701]
Stock Position:  -0.024557013357016547
Bond Position:  [35.9109086]


portfolio before change:  [33.35471964]
curr_Stock_Price:  104.18341283418428
curr_Factors:  [104.18341283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03241274]
Stock Position:  -0.03241274164222167
Bond Position:  [36.73158968]


portfolio before change:  [33.34643762]
curr_Stock_Price:  104.50976031539513
curr_Factors:  [104.50976032]
mat_Sqrt:  [[0.15]]
grads:  [0.02745487]
Stock Position:  0.027454874430815162
Bond Position:  [30.47713527]


portfolio before change:  [33.32327126]
curr_Stock_Price:  103.59658043280099
curr_Factors:  [103.59658043]
mat_Sqrt:  [[0.15]]
grads:  [-0.13089502]
Stock Position:  -0.1308950173033043
Bond Position:  [46.88354745]


portfolio before change:  [33.2424132]
curr_Stock_Price:  104.23669936899834
curr_Factors:  [104.23669937]
mat_Sqrt:  [[0.15]]
grads:  [0.005611]
Stock Position:  0.005610995942057364
Bond Position:  [32.6575415]


portfolio before change:  [33.24159569]
curr_Stock_Price:  103.72722272653023
curr_Factors:  [103.72722273]
mat_Sqrt:  [[0.15]]
grads:  [0.1230523]
Stock Position:  0.12305230164401394
Bond Position:  [20.47772219]


portfolio before change:  [33.26340962]
curr_Stock_Price:  103.89409518209615
curr_Factors:  [103.89409518]
mat_Sqrt:  [[0.15]]
grads:  [0.08189577]
Stock Position:  0.0818957701401659
Bond Position:  [24.75492268]


portfolio before change:  [33.2649043]
curr_Stock_Price:  103.89345348909883
curr_Factors:  [103.89345349]
mat_Sqrt:  [[0.15]]
grads:  [0.0558164]
Stock Position:  0.055816402656024444
Bond Position:  [27.46594547]


portfolio before change:  [33.25817631]
curr_Stock_Price:  103.74215991584144
curr_Factors:  [103.74215992]
mat_Sqrt:  [[0.15]]
grads:  [0.06444738]
Stock Position:  0.06444738422757985
Bond Position:  [26.57226547]


portfolio before change:  [33.26844567]
curr_Stock_Price:  103.87573456750931
curr_Factors:  [103.87573457]
mat_Sqrt:  [[0.15]]
grads:  [0.04405057]
Stock Position:  0.044050574516734345
Bond Position:  [28.69265988]


portfolio before change:  [33.28767153]
curr_Stock_Price:  104.27147325290284
curr_Factors:  [104.27147325]
mat_Sqrt:  [[0.15]]
grads:  [0.07466634]
Stock Position:  0.07466633845813277
Bond Position:  [25.50210242]


portfolio before change:  [33.32290716]
curr_Stock_Price:  104.72203367638906
curr_Factors:  [104.72203368]
mat_Sqrt:  [[0.15]]
grads:  [0.01571826]
Stock Position:  0.015718263111808066
Bond Position:  [31.67685868]


portfolio before change:  [33.31674122]
curr_Stock_Price:  104.2037955195324
curr_Factors:  [104.20379552]
mat_Sqrt:  [[0.15]]
grads:  [-0.10174731]
Stock Position:  -0.1017473105744498
Bond Position:  [43.91919717]


portfolio before change:  [33.31231635]
curr_Stock_Price:  104.27426331400811
curr_Factors:  [104.27426331]
mat_Sqrt:  [[0.15]]
grads:  [-0.07143305]
Stock Position:  -0.0714330519551454
Bond Position:  [40.76094522]


portfolio before change:  [33.33177383]
curr_Stock_Price:  104.03754032587993
curr_Factors:  [104.03754033]
mat_Sqrt:  [[0.15]]
grads:  [0.00663536]
Stock Position:  0.006635355024279395
Bond Position:  [32.64144782]


portfolio before change:  [33.33808441]
curr_Stock_Price:  104.68112559950067
curr_Factors:  [104.6811256]
mat_Sqrt:  [[0.15]]
grads:  [0.00506549]
Stock Position:  0.0050654884760233864
Bond Position:  [32.80782337]


portfolio before change:  [33.3375271]
curr_Stock_Price:  104.16629616003772
curr_Factors:  [104.16629616]
mat_Sqrt:  [[0.15]]
grads:  [-0.12736447]
Stock Position:  -0.12736447403926054
Bond Position:  [46.60461262]


portfolio before change:  [33.26362621]
curr_Stock_Price:  104.76939809662976
curr_Factors:  [104.7693981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02743275]
Stock Position:  -0.02743274636550787
Bond Position:  [36.13773854]


portfolio before change:  [33.28216294]
curr_Stock_Price:  104.17601800657226
curr_Factors:  [104.17601801]
mat_Sqrt:  [[0.15]]
grads:  [0.07630883]
Stock Position:  0.07630882916217159
Bond Position:  [25.33261298]


portfolio before change:  [33.24542919]
curr_Stock_Price:  103.67388618800273
curr_Factors:  [103.67388619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03198467]
Stock Position:  -0.03198466657438562
Bond Position:  [36.56140387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.26262427]
Stock Price:  103.2077276437197
PL:  [30.05489663]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39843481e-02]
 [ 8.13083051e-03]
 [ 2.07746509e-02]
 [-7.00078181e-03]
 [-2.37532614e-03]
 [-9.52130722e-03]
 [-9.98605302e-03]
 [-3.08455406e-02]
 [ 5.74942408e-03]
 [-3.45004071e-03]
 [-1.65951410e-03]
 [-1.66550420e-03]
 [-3.31629195e-03]
 [ 6.68599426e-03]
 [ 2.72008004e-03]
 [ 1.11508967e-02]
 [ 9.72973429e-02]
 [-1.13471186e-02]
 [ 2.29180805e-02]
 [ 8.84820209e-04]
 [-4.60389669e-03]
 [ 4.37513578e-03]
 [ 1.40328222e-02]
 [ 2.36430262e-02]
 [-1.45745824e-03]
 [ 7.08646394e-03]
 [-8.37697668e-03]
 [ 1.06197497e-02]
 [ 3.37299857e-02]
 [ 1.20406236e-03]
 [-6.78302895e-03]
 [ 1.29826203e-02]
 [ 1.16023493e-02]
 [-1.89631271e-02]
 [-4.28271439e-03]
 [ 1.80304212e-02]
 [ 5.50412489e-03]
 [-6.36056491e-04]
 [-2.26708567e-02]
 [-1.46411720e-02]
 [ 6.99969375e-03]
 [ 3.54184518e-02]
 [-3.37018141e-03]
 [ 1.90659215e-02]
 [-5.99168086e-02]
 [ 2.28330851e-02]
 [ 9.03813824e-03]
 [ 5.42467078e-03]
 [-1.62576875e-02]
 [ 3.92081848e-04]
 [ 1.73055252e-03]
 [-4.70170055e-03]
 [-2.24463771e-03]
 [-8.38841359e-04]
 [-2.39883014e-02]
 [-5.77259169e-03]
 [-7.35272268e-03]
 [ 1.46357773e-02]
 [ 5.34309906e-03]
 [-2.10861620e-03]
 [-5.17076961e-03]
 [-4.16074122e-03]
 [ 1.83434740e-03]
 [-6.99313933e-03]
 [ 1.71832393e-02]
 [ 1.07207963e-02]
 [ 2.06240909e-02]
 [-7.31216197e-03]
 [ 1.14913734e-02]
 [ 3.24422022e-02]
 [ 3.21930016e-03]
 [-1.49663138e-02]
 [-5.93872793e-03]
 [ 3.54780510e-03]
 [ 1.27759678e-02]
 [ 2.04073471e-02]
 [ 7.57274641e-03]
 [-4.18560659e-02]
 [-2.29383826e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.9429639]
curr_Stock_Price:  99.72872423832018
curr_Factors:  [99.72872424]
mat_Sqrt:  [[0.15]]
grads:  [-0.09322899]
Stock Position:  -0.09322898740607426
Bond Position:  [5.35464408]


portfolio before change:  [-3.95659961]
curr_Stock_Price:  99.87857455960315
curr_Factors:  [99.87857456]
mat_Sqrt:  [[0.15]]
grads:  [0.05420554]
Stock Position:  0.05420553675535988
Bond Position:  [-9.37057136]


portfolio before change:  [-3.90417201]
curr_Stock_Price:  100.85657955959014
curr_Factors:  [100.85657956]
mat_Sqrt:  [[0.15]]
grads:  [0.13849767]
Stock Position:  0.1384976725374204
Bond Position:  [-17.87257354]


portfolio before change:  [-4.01184831]
curr_Stock_Price:  100.08718591434297
curr_Factors:  [100.08718591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04667188]
Stock Position:  -0.046671878709686435
Bond Position:  [0.6594087]


portfolio before change:  [-4.03525012]
curr_Stock_Price:  100.58948050535801
curr_Factors:  [100.58948051]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583551]
Stock Position:  -0.015835507612178695
Bond Position:  [-2.44236464]


portfolio before change:  [-4.02089166]
curr_Stock_Price:  99.67311452157655
curr_Factors:  [99.67311452]
mat_Sqrt:  [[0.15]]
grads:  [-0.06347538]
Stock Position:  -0.06347538148346553
Bond Position:  [2.30589731]


portfolio before change:  [-4.09626879]
curr_Stock_Price:  100.86288696714027
curr_Factors:  [100.86288697]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657369]
Stock Position:  -0.06657368680485573
Bond Position:  [2.61854545]


portfolio before change:  [-4.11624952]
curr_Stock_Price:  101.16547484145944
curr_Factors:  [101.16547484]
mat_Sqrt:  [[0.15]]
grads:  [-0.20563694]
Stock Position:  -0.20563693707467856
Bond Position:  [16.68710887]


portfolio before change:  [-4.01272918]
curr_Stock_Price:  100.66713364015503
curr_Factors:  [100.66713364]
mat_Sqrt:  [[0.15]]
grads:  [0.03832949]
Stock Position:  0.038329493856701695
Bond Position:  [-7.87124946]


portfolio before change:  [-3.98620805]
curr_Stock_Price:  101.37189374837614
curr_Factors:  [101.37189375]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300027]
Stock Position:  -0.02300027141144679
Bond Position:  [-1.65462698]


portfolio before change:  [-3.97445355]
curr_Stock_Price:  100.8563379812002
curr_Factors:  [100.85633798]
mat_Sqrt:  [[0.15]]
grads:  [-0.01106343]
Stock Position:  -0.011063427320298691
Bond Position:  [-2.85863678]


portfolio before change:  [-3.96855162]
curr_Stock_Price:  100.30672540818718
curr_Factors:  [100.30672541]
mat_Sqrt:  [[0.15]]
grads:  [-0.01110336]
Stock Position:  -0.011103361320429241
Bond Position:  [-2.85480981]


portfolio before change:  [-3.97633198]
curr_Stock_Price:  100.99137634414927
curr_Factors:  [100.99137634]
mat_Sqrt:  [[0.15]]
grads:  [-0.02210861]
Stock Position:  -0.022108613020344718
Bond Position:  [-1.74355272]


portfolio before change:  [-3.97142603]
curr_Stock_Price:  100.76454504368506
curr_Factors:  [100.76454504]
mat_Sqrt:  [[0.15]]
grads:  [0.0445733]
Stock Position:  0.044573295068304514
Bond Position:  [-8.46283383]


portfolio before change:  [-3.9338591]
curr_Stock_Price:  101.61922433254281
curr_Factors:  [101.61922433]
mat_Sqrt:  [[0.15]]
grads:  [0.01813387]
Stock Position:  0.018133866921089536
Bond Position:  [-5.77660859]


portfolio before change:  [-3.92212425]
curr_Stock_Price:  102.2862580310445
curr_Factors:  [102.28625803]
mat_Sqrt:  [[0.15]]
grads:  [0.07433931]
Stock Position:  0.07433931101175967
Bond Position:  [-11.5260142]


portfolio before change:  [-3.90076863]
curr_Stock_Price:  102.58322097259574
curr_Factors:  [102.58322097]
mat_Sqrt:  [[0.15]]
grads:  [0.64864895]
Stock Position:  0.6486489525478732
Bond Position:  [-70.44126746]


portfolio before change:  [-3.93236185]
curr_Stock_Price:  102.54130229666676
curr_Factors:  [102.5413023]
mat_Sqrt:  [[0.15]]
grads:  [-0.07564746]
Stock Position:  -0.07564745715548976
Bond Position:  [3.82462692]


portfolio before change:  [-3.93577537]
curr_Stock_Price:  102.58958639375561
curr_Factors:  [102.58958639]
mat_Sqrt:  [[0.15]]
grads:  [0.1527872]
Stock Position:  0.15278720337807908
Bond Position:  [-19.61015137]


portfolio before change:  [-3.96136204]
curr_Stock_Price:  102.43014243663737
curr_Factors:  [102.43014244]
mat_Sqrt:  [[0.15]]
grads:  [0.0058988]
Stock Position:  0.005898801391433076
Bond Position:  [-4.56557711]


portfolio before change:  [-3.96591558]
curr_Stock_Price:  101.70657550294752
curr_Factors:  [101.7065755]
mat_Sqrt:  [[0.15]]
grads:  [-0.03069264]
Stock Position:  -0.030692644615777746
Bond Position:  [-0.8442718]


portfolio before change:  [-3.9408602]
curr_Stock_Price:  100.88852460282025
curr_Factors:  [100.8885246]
mat_Sqrt:  [[0.15]]
grads:  [0.02916757]
Stock Position:  0.029167571847373872
Bond Position:  [-6.88353349]


portfolio before change:  [-3.93110163]
curr_Stock_Price:  101.23784427636734
curr_Factors:  [101.23784428]
mat_Sqrt:  [[0.15]]
grads:  [0.09355215]
Stock Position:  0.09355214812873648
Bond Position:  [-13.40211943]


portfolio before change:  [-3.89172575]
curr_Stock_Price:  101.66769584814021
curr_Factors:  [101.66769585]
mat_Sqrt:  [[0.15]]
grads:  [0.15762017]
Stock Position:  0.1576201747194186
Bond Position:  [-19.91660573]


portfolio before change:  [-3.92170174]
curr_Stock_Price:  101.48541481820095
curr_Factors:  [101.48541482]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971639]
Stock Position:  -0.009716388238236087
Bond Position:  [-2.93563005]


portfolio before change:  [-3.91985522]
curr_Stock_Price:  101.2764886107599
curr_Factors:  [101.27648861]
mat_Sqrt:  [[0.15]]
grads:  [0.04724309]
Stock Position:  0.04724309290811065
Bond Position:  [-8.70446978]


portfolio before change:  [-3.93964757]
curr_Stock_Price:  100.86905742470749
curr_Factors:  [100.86905742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05584651]
Stock Position:  -0.05584651120638949
Bond Position:  [1.69353737]


portfolio before change:  [-3.97008602]
curr_Stock_Price:  101.41599031386214
curr_Factors:  [101.41599031]
mat_Sqrt:  [[0.15]]
grads:  [0.07079833]
Stock Position:  0.07079833115596021
Bond Position:  [-11.15016888]


portfolio before change:  [-3.97301536]
curr_Stock_Price:  101.3844580375978
curr_Factors:  [101.38445804]
mat_Sqrt:  [[0.15]]
grads:  [0.22486657]
Stock Position:  0.22486657128065327
Bond Position:  [-26.77099082]


portfolio before change:  [-4.2376759]
curr_Stock_Price:  100.21493201754177
curr_Factors:  [100.21493202]
mat_Sqrt:  [[0.15]]
grads:  [0.00802708]
Stock Position:  0.008027082388682555
Bond Position:  [-5.04210942]


portfolio before change:  [-4.24433887]
curr_Stock_Price:  99.42413112307432
curr_Factors:  [99.42413112]
mat_Sqrt:  [[0.15]]
grads:  [-0.04522019]
Stock Position:  -0.04522019303023501
Bond Position:  [0.25163953]


portfolio before change:  [-4.20073866]
curr_Stock_Price:  98.46030337486064
curr_Factors:  [98.46030337]
mat_Sqrt:  [[0.15]]
grads:  [0.0865508]
Stock Position:  0.08655080169133682
Bond Position:  [-12.72255685]


portfolio before change:  [-4.1506102]
curr_Stock_Price:  99.04867049090304
curr_Factors:  [99.04867049]
mat_Sqrt:  [[0.15]]
grads:  [0.077349]
Stock Position:  0.07734899535228007
Bond Position:  [-11.81192535]


portfolio before change:  [-4.2066847]
curr_Stock_Price:  98.33326065545992
curr_Factors:  [98.33326066]
mat_Sqrt:  [[0.15]]
grads:  [-0.12642085]
Stock Position:  -0.12642084740036724
Bond Position:  [8.22468944]


portfolio before change:  [-4.18872801]
curr_Stock_Price:  98.19528788372435
curr_Factors:  [98.19528788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02855143]
Stock Position:  -0.02855142929339206
Bond Position:  [-1.38511219]


portfolio before change:  [-4.18289482]
curr_Stock_Price:  97.987951094262
curr_Factors:  [97.98795109]
mat_Sqrt:  [[0.15]]
grads:  [0.12020281]
Stock Position:  0.12020280821469712
Bond Position:  [-15.96132171]


portfolio before change:  [-4.23731634]
curr_Stock_Price:  97.54350300455177
curr_Factors:  [97.543503]
mat_Sqrt:  [[0.15]]
grads:  [0.03669417]
Stock Position:  0.03669416596194531
Bond Position:  [-7.81659383]


portfolio before change:  [-4.2464951]
curr_Stock_Price:  97.3066749251152
curr_Factors:  [97.30667493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00424038]
Stock Position:  -0.00424037660393202
Bond Position:  [-3.83387815]


portfolio before change:  [-4.24699373]
curr_Stock_Price:  97.36775580027951
curr_Factors:  [97.3677558]
mat_Sqrt:  [[0.15]]
grads:  [-0.15113904]
Stock Position:  -0.15113904457536428
Bond Position:  [10.46907585]


portfolio before change:  [-4.23540499]
curr_Stock_Price:  97.29540914456737
curr_Factors:  [97.29540914]
mat_Sqrt:  [[0.15]]
grads:  [-0.09760781]
Stock Position:  -0.09760781350319608
Bond Position:  [5.26138716]


portfolio before change:  [-4.17499022]
curr_Stock_Price:  96.67982394737055
curr_Factors:  [96.67982395]
mat_Sqrt:  [[0.15]]
grads:  [0.04666463]
Stock Position:  0.046664625018268506
Bond Position:  [-8.68651795]


portfolio before change:  [-4.20782405]
curr_Stock_Price:  95.98784556164965
curr_Factors:  [95.98784556]
mat_Sqrt:  [[0.15]]
grads:  [0.23612301]
Stock Position:  0.23612301186580556
Bond Position:  [-26.87276325]


portfolio before change:  [-4.15352873]
curr_Stock_Price:  96.22490390394972
curr_Factors:  [96.2249039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246788]
Stock Position:  -0.022467876087712457
Bond Position:  [-1.99155951]


portfolio before change:  [-4.1378064]
curr_Stock_Price:  95.51959452387106
curr_Factors:  [95.51959452]
mat_Sqrt:  [[0.15]]
grads:  [0.12710614]
Stock Position:  0.1271061432650083
Bond Position:  [-16.27893366]


portfolio before change:  [-4.20035946]
curr_Stock_Price:  95.0354668559707
curr_Factors:  [95.03546686]
mat_Sqrt:  [[0.15]]
grads:  [-0.39944539]
Stock Position:  -0.3994453904229503
Bond Position:  [33.7611197]


portfolio before change:  [-4.36272051]
curr_Stock_Price:  95.44721571393491
curr_Factors:  [95.44721571]
mat_Sqrt:  [[0.15]]
grads:  [0.15222057]
Stock Position:  0.15222056741257114
Bond Position:  [-18.89174984]


portfolio before change:  [-4.41784156]
curr_Stock_Price:  95.09285965100759
curr_Factors:  [95.09285965]
mat_Sqrt:  [[0.15]]
grads:  [0.06025425]
Stock Position:  0.060254254957630635
Bond Position:  [-10.14759097]


portfolio before change:  [-4.46682867]
curr_Stock_Price:  94.29037917018842
curr_Factors:  [94.29037917]
mat_Sqrt:  [[0.15]]
grads:  [0.03616447]
Stock Position:  0.036164471847571746
Bond Position:  [-7.87679043]


portfolio before change:  [-4.48408513]
curr_Stock_Price:  93.82682630413453
curr_Factors:  [93.8268263]
mat_Sqrt:  [[0.15]]
grads:  [-0.10838458]
Stock Position:  -0.1083845832907944
Bond Position:  [5.68529634]


portfolio before change:  [-4.47721074]
curr_Stock_Price:  93.7666789646021
curr_Factors:  [93.76667896]
mat_Sqrt:  [[0.15]]
grads:  [0.00261388]
Stock Position:  0.002613878988619166
Bond Position:  [-4.7223055]


portfolio before change:  [-4.47784711]
curr_Stock_Price:  93.63613904902384
curr_Factors:  [93.63613905]
mat_Sqrt:  [[0.15]]
grads:  [0.01153702]
Stock Position:  0.01153701682591923
Bond Position:  [-5.55812882]


portfolio before change:  [-4.49237714]
curr_Stock_Price:  92.4068236052764
curr_Factors:  [92.40682361]
mat_Sqrt:  [[0.15]]
grads:  [-0.03134467]
Stock Position:  -0.03134467032746059
Bond Position:  [-1.59591572]


portfolio before change:  [-4.50523843]
curr_Stock_Price:  92.81395963379262
curr_Factors:  [92.81395963]
mat_Sqrt:  [[0.15]]
grads:  [-0.01496425]
Stock Position:  -0.014964251431136373
Bond Position:  [-3.116347]


portfolio before change:  [-4.50447338]
curr_Stock_Price:  92.74981831029726
curr_Factors:  [92.74981831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00559228]
Stock Position:  -0.005592275725608067
Bond Position:  [-3.98579083]


portfolio before change:  [-4.50526272]
curr_Stock_Price:  92.8464183515822
curr_Factors:  [92.84641835]
mat_Sqrt:  [[0.15]]
grads:  [-0.15992201]
Stock Position:  -0.15992200948725552
Bond Position:  [10.34292308]


portfolio before change:  [-4.53442372]
curr_Stock_Price:  93.03280581303846
curr_Factors:  [93.03280581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03848394]
Stock Position:  -0.03848394457440857
Bond Position:  [-0.95415438]


portfolio before change:  [-4.54196192]
curr_Stock_Price:  93.22713533463832
curr_Factors:  [93.22713533]
mat_Sqrt:  [[0.15]]
grads:  [-0.04901815]
Stock Position:  -0.049018151174949724
Bond Position:  [0.02785989]


portfolio before change:  [-4.54772459]
curr_Stock_Price:  93.34473265394595
curr_Factors:  [93.34473265]
mat_Sqrt:  [[0.15]]
grads:  [0.09757185]
Stock Position:  0.09757184867110846
Bond Position:  [-13.65554271]


portfolio before change:  [-4.55300091]
curr_Stock_Price:  93.29940371795166
curr_Factors:  [93.29940372]
mat_Sqrt:  [[0.15]]
grads:  [0.03562066]
Stock Position:  0.0356206604202461
Bond Position:  [-7.87638729]


portfolio before change:  [-4.55738791]
curr_Stock_Price:  93.19006513387517
curr_Factors:  [93.19006513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01405744]
Stock Position:  -0.014057441343077284
Bond Position:  [-3.24737404]


portfolio before change:  [-4.55646439]
curr_Stock_Price:  93.10993022568356
curr_Factors:  [93.10993023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0344718]
Stock Position:  -0.034471797380357924
Bond Position:  [-1.34679774]


portfolio before change:  [-4.57093729]
curr_Stock_Price:  93.52733575030413
curr_Factors:  [93.52733575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02773827]
Stock Position:  -0.027738274825740376
Bond Position:  [-1.97665034]


portfolio before change:  [-4.57237309]
curr_Stock_Price:  93.57464439799418
curr_Factors:  [93.5746444]
mat_Sqrt:  [[0.15]]
grads:  [0.01222898]
Stock Position:  0.012228982662331848
Bond Position:  [-5.71669579]


portfolio before change:  [-4.57208823]
curr_Stock_Price:  93.6271562731793
curr_Factors:  [93.62715627]
mat_Sqrt:  [[0.15]]
grads:  [-0.04662093]
Stock Position:  -0.04662092884791031
Bond Position:  [-0.20710324]


portfolio before change:  [-4.5757074]
curr_Stock_Price:  93.70450829485443
curr_Factors:  [93.70450829]
mat_Sqrt:  [[0.15]]
grads:  [0.11455493]
Stock Position:  0.11455492889780083
Bond Position:  [-15.31002068]


portfolio before change:  [-4.6921053]
curr_Stock_Price:  92.69677343109976
curr_Factors:  [92.69677343]
mat_Sqrt:  [[0.15]]
grads:  [0.07147198]
Stock Position:  0.07147197550870388
Bond Position:  [-11.31732682]


portfolio before change:  [-4.70774769]
curr_Stock_Price:  92.48780994470181
curr_Factors:  [92.48780994]
mat_Sqrt:  [[0.15]]
grads:  [0.13749394]
Stock Position:  0.13749393917456143
Bond Position:  [-17.424261]


portfolio before change:  [-4.77380838]
curr_Stock_Price:  92.01526807093616
curr_Factors:  [92.01526807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04874775]
Stock Position:  -0.04874774646448041
Bond Position:  [-0.28827142]


portfolio before change:  [-4.73930464]
curr_Stock_Price:  91.30709663788943
curr_Factors:  [91.30709664]
mat_Sqrt:  [[0.15]]
grads:  [0.07660916]
Stock Position:  0.07660915600482247
Bond Position:  [-11.73426425]


portfolio before change:  [-4.70168047]
curr_Stock_Price:  91.80778850397495
curr_Factors:  [91.8077885]
mat_Sqrt:  [[0.15]]
grads:  [0.21628135]
Stock Position:  0.2162813480402957
Bond Position:  [-24.55799273]


portfolio before change:  [-4.60917385]
curr_Stock_Price:  92.24259965167013
curr_Factors:  [92.24259965]
mat_Sqrt:  [[0.15]]
grads:  [0.021462]
Stock Position:  0.021462001051006176
Bond Position:  [-6.58888462]


portfolio before change:  [-4.60684847]
curr_Stock_Price:  92.37013676504002
curr_Factors:  [92.37013677]
mat_Sqrt:  [[0.15]]
grads:  [-0.09977543]
Stock Position:  -0.09977542537151617
Bond Position:  [4.60942122]


portfolio before change:  [-4.62432079]
curr_Stock_Price:  92.54814071197944
curr_Factors:  [92.54814071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03959152]
Stock Position:  -0.03959151954898511
Bond Position:  [-0.96019927]


portfolio before change:  [-4.6322232]
curr_Stock_Price:  92.74622339172753
curr_Factors:  [92.74622339]
mat_Sqrt:  [[0.15]]
grads:  [0.02365203]
Stock Position:  0.023652033970226707
Bond Position:  [-6.82586002]


portfolio before change:  [-4.64341482]
curr_Stock_Price:  92.29108326431783
curr_Factors:  [92.29108326]
mat_Sqrt:  [[0.15]]
grads:  [0.08517312]
Stock Position:  0.0851731187686221
Bond Position:  [-12.50413421]


portfolio before change:  [-4.63840491]
curr_Stock_Price:  92.35907931594718
curr_Factors:  [92.35907932]
mat_Sqrt:  [[0.15]]
grads:  [0.13604898]
Stock Position:  0.1360489806063994
Bond Position:  [-17.2037635]


portfolio before change:  [-4.73396245]
curr_Stock_Price:  91.66460686189856
curr_Factors:  [91.66460686]
mat_Sqrt:  [[0.15]]
grads:  [0.05048498]
Stock Position:  0.05048497604049559
Bond Position:  [-9.36164793]


portfolio before change:  [-4.73532573]
curr_Stock_Price:  91.64919321127238
curr_Factors:  [91.64919321]
mat_Sqrt:  [[0.15]]
grads:  [-0.27904044]
Stock Position:  -0.27904043961230923
Bond Position:  [20.83850543]


portfolio before change:  [-4.76269663]
curr_Stock_Price:  91.75195016696631
curr_Factors:  [91.75195017]
mat_Sqrt:  [[0.15]]
grads:  [-0.15292255]
Stock Position:  -0.15292255098309393
Bond Position:  [9.26824565]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.89461864]
Stock Price:  92.6184103158434
PL:  [-4.89461864]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.79565081e-03]
 [ 7.51475902e-03]
 [ 2.01495171e-02]
 [-7.34133227e-03]
 [-3.96810456e-03]
 [-1.83028841e-03]
 [-1.53694037e-03]
 [-4.18372085e-02]
 [ 6.87984505e-03]
 [ 2.34452253e-04]
 [ 3.61261340e-04]
 [ 1.08206443e-02]
 [-3.10885885e-03]
 [ 9.10796565e-03]
 [-1.37354010e-03]
 [ 1.13405747e-02]
 [ 2.42580384e-02]
 [-1.50937237e-02]
 [ 1.94708951e-02]
 [ 2.66111079e-03]
 [-4.02751644e-03]
 [ 4.14480271e-03]
 [ 1.88265133e-02]
 [ 1.85341293e-02]
 [-6.10235323e-03]
 [ 4.70858517e-03]
 [-4.40963361e-03]
 [ 5.38143260e-03]
 [ 3.11846015e-02]
 [ 4.21421012e-03]
 [-8.12904274e-03]
 [ 9.01434774e-03]
 [ 1.19111969e-02]
 [ 6.76550050e-03]
 [ 5.61274243e-03]
 [ 1.72420790e-02]
 [-2.34594142e-02]
 [ 1.55381486e-03]
 [-5.20124795e-02]
 [ 1.41922856e-02]
 [ 5.98574146e-03]
 [ 6.41172029e-03]
 [-3.80124526e-03]
 [-4.61648104e-03]
 [ 2.36500695e-02]
 [ 1.50795612e-02]
 [ 1.08529708e-02]
 [ 3.65934455e-03]
 [ 1.17402620e-02]
 [-1.18012718e-03]
 [ 2.18508493e-02]
 [-4.05617786e-03]
 [ 5.69305908e-04]
 [-9.16110263e-03]
 [-3.31595458e-03]
 [-3.32644216e-03]
 [ 1.04381213e-02]
 [-5.66706151e-03]
 [ 6.41247098e-03]
 [-3.97162222e-03]
 [-1.82425459e-03]
 [ 7.78582948e-03]
 [-8.81473964e-03]
 [ 7.87118560e-03]
 [ 2.53136233e-02]
 [ 5.56049553e-03]
 [ 1.27330812e-02]
 [ 3.34536978e-03]
 [ 3.68377367e-03]
 [ 1.94858149e-02]
 [ 4.81279113e-04]
 [-1.54910771e-02]
 [-1.72740009e-03]
 [ 1.22910684e-03]
 [ 1.23183305e-03]
 [-1.47534755e-02]
 [-4.20347766e-03]
 [ 1.56090640e-02]
 [-1.08557169e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.00282198]
curr_Stock_Price:  100.18044145100649
curr_Factors:  [100.18044145]
mat_Sqrt:  [[0.15]]
grads:  [-0.03863767]
Stock Position:  -0.038637672086975244
Bond Position:  [9.87356103]


portfolio before change:  [6.01618699]
curr_Stock_Price:  99.8505072044563
curr_Factors:  [99.8505072]
mat_Sqrt:  [[0.15]]
grads:  [0.05009839]
Stock Position:  0.05009839347531892
Bond Position:  [1.01383699]


portfolio before change:  [6.05061879]
curr_Stock_Price:  100.53652598323616
curr_Factors:  [100.53652598]
mat_Sqrt:  [[0.15]]
grads:  [0.13433011]
Stock Position:  0.1343301138390432
Bond Position:  [-7.45446419]


portfolio before change:  [6.01443007]
curr_Stock_Price:  100.2705930149583
curr_Factors:  [100.27059301]
mat_Sqrt:  [[0.15]]
grads:  [-0.04894222]
Stock Position:  -0.04894221513632685
Bond Position:  [10.921895]


portfolio before change:  [5.99760663]
curr_Stock_Price:  100.62828170249816
curr_Factors:  [100.6282817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02645403]
Stock Position:  -0.02645403040544874
Bond Position:  [8.65963026]


portfolio before change:  [5.99855662]
curr_Stock_Price:  100.6128306645584
curr_Factors:  [100.61283066]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220192]
Stock Position:  -0.012201922733708057
Bond Position:  [7.2262266]


portfolio before change:  [5.9880196]
curr_Stock_Price:  101.51339962360497
curr_Factors:  [101.51339962]
mat_Sqrt:  [[0.15]]
grads:  [-0.01024627]
Stock Position:  -0.010246269121886194
Bond Position:  [7.02815321]


portfolio before change:  [5.98490163]
curr_Stock_Price:  101.86057362238537
curr_Factors:  [101.86057362]
mat_Sqrt:  [[0.15]]
grads:  [-0.27891472]
Stock Position:  -0.2789147231036112
Bond Position:  [34.39531532]


portfolio before change:  [6.29108872]
curr_Stock_Price:  100.77050095183438
curr_Factors:  [100.77050095]
mat_Sqrt:  [[0.15]]
grads:  [0.04586563]
Stock Position:  0.04586563364687622
Bond Position:  [1.66918585]


portfolio before change:  [6.29580398]
curr_Stock_Price:  100.87103224322887
curr_Factors:  [100.87103224]
mat_Sqrt:  [[0.15]]
grads:  [0.00156302]
Stock Position:  0.0015630150215233118
Bond Position:  [6.13814105]


portfolio before change:  [6.29600357]
curr_Stock_Price:  100.75327015033407
curr_Factors:  [100.75327015]
mat_Sqrt:  [[0.15]]
grads:  [0.00240841]
Stock Position:  0.0024084089346024878
Bond Position:  [6.05334849]


portfolio before change:  [6.29767797]
curr_Stock_Price:  101.29140913042853
curr_Factors:  [101.29140913]
mat_Sqrt:  [[0.15]]
grads:  [0.07213763]
Stock Position:  0.07213762891622474
Bond Position:  [-1.00924411]


portfolio before change:  [6.26293855]
curr_Stock_Price:  100.81071220329085
curr_Factors:  [100.8107122]
mat_Sqrt:  [[0.15]]
grads:  [-0.02072573]
Stock Position:  -0.02072572569895857
Bond Position:  [8.35231372]


portfolio before change:  [6.27596103]
curr_Stock_Price:  100.2075760115068
curr_Factors:  [100.20757601]
mat_Sqrt:  [[0.15]]
grads:  [0.06071977]
Stock Position:  0.06071977100428504
Bond Position:  [0.19137996]


portfolio before change:  [6.27098456]
curr_Stock_Price:  100.12542111943982
curr_Factors:  [100.12542112]
mat_Sqrt:  [[0.15]]
grads:  [-0.00915693]
Stock Position:  -0.009156933972614169
Bond Position:  [7.18782643]


portfolio before change:  [6.27875957]
curr_Stock_Price:  99.32539812756853
curr_Factors:  [99.32539813]
mat_Sqrt:  [[0.15]]
grads:  [0.07560383]
Stock Position:  0.07560383118517464
Bond Position:  [-1.23062106]


portfolio before change:  [6.28597526]
curr_Stock_Price:  99.42185627406512
curr_Factors:  [99.42185627]
mat_Sqrt:  [[0.15]]
grads:  [0.16172026]
Stock Position:  0.16172025631346407
Bond Position:  [-9.79255282]


portfolio before change:  [6.26293062]
curr_Stock_Price:  99.28314395580622
curr_Factors:  [99.28314396]
mat_Sqrt:  [[0.15]]
grads:  [-0.10062482]
Stock Position:  -0.10062482436102332
Bond Position:  [16.25327954]


portfolio before change:  [6.15828215]
curr_Stock_Price:  100.33322606001789
curr_Factors:  [100.33322606]
mat_Sqrt:  [[0.15]]
grads:  [0.12980597]
Stock Position:  0.12980596708773204
Bond Position:  [-6.86556929]


portfolio before change:  [6.1348009]
curr_Stock_Price:  100.15563683824206
curr_Factors:  [100.15563684]
mat_Sqrt:  [[0.15]]
grads:  [0.01774074]
Stock Position:  0.01774073862805468
Bond Position:  [4.35796592]


portfolio before change:  [6.13173825]
curr_Stock_Price:  99.96764959739586
curr_Factors:  [99.9676496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685011]
Stock Position:  -0.026850109591118505
Bond Position:  [8.81588059]


portfolio before change:  [6.12886922]
curr_Stock_Price:  100.0950246472651
curr_Factors:  [100.09502465]
mat_Sqrt:  [[0.15]]
grads:  [0.02763202]
Stock Position:  0.027632018050742068
Bond Position:  [3.36304169]


portfolio before change:  [6.10713103]
curr_Stock_Price:  99.30071451640724
curr_Factors:  [99.30071452]
mat_Sqrt:  [[0.15]]
grads:  [0.12551009]
Stock Position:  0.12551008881353512
Bond Position:  [-6.35611047]


portfolio before change:  [6.03209615]
curr_Stock_Price:  98.70604033777919
curr_Factors:  [98.70604034]
mat_Sqrt:  [[0.15]]
grads:  [0.12356086]
Stock Position:  0.12356086209398111
Bond Position:  [-6.16410729]


portfolio before change:  [6.13765946]
curr_Stock_Price:  99.5635009744091
curr_Factors:  [99.56350097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04068235]
Stock Position:  -0.040682354889194375
Bond Position:  [10.18813714]


portfolio before change:  [6.1195805]
curr_Stock_Price:  100.0235463917416
curr_Factors:  [100.02354639]
mat_Sqrt:  [[0.15]]
grads:  [0.03139057]
Stock Position:  0.031390567780002036
Bond Position:  [2.97978459]


portfolio before change:  [6.1365725]
curr_Stock_Price:  100.55892218658204
curr_Factors:  [100.55892219]
mat_Sqrt:  [[0.15]]
grads:  [-0.02939756]
Stock Position:  -0.02939755741274419
Bond Position:  [9.09275918]


portfolio before change:  [6.13756408]
curr_Stock_Price:  100.54452393023293
curr_Factors:  [100.54452393]
mat_Sqrt:  [[0.15]]
grads:  [0.03587622]
Stock Position:  0.035876217322059326
Bond Position:  [2.53040689]


portfolio before change:  [6.14052908]
curr_Stock_Price:  100.62276064898555
curr_Factors:  [100.62276065]
mat_Sqrt:  [[0.15]]
grads:  [0.20789734]
Stock Position:  0.20789734345663174
Bond Position:  [-14.77867555]


portfolio before change:  [6.21038339]
curr_Stock_Price:  100.96320754333892
curr_Factors:  [100.96320754]
mat_Sqrt:  [[0.15]]
grads:  [0.02809473]
Stock Position:  0.028094734130617686
Bond Position:  [3.37384891]


portfolio before change:  [6.19042546]
curr_Stock_Price:  100.24532204605671
curr_Factors:  [100.24532205]
mat_Sqrt:  [[0.15]]
grads:  [-0.05419362]
Stock Position:  -0.054193618242917206
Bond Position:  [11.62308217]


portfolio before change:  [6.21023369]
curr_Stock_Price:  99.89321847734722
curr_Factors:  [99.89321848]
mat_Sqrt:  [[0.15]]
grads:  [0.06009565]
Stock Position:  0.060095651616678264
Bond Position:  [0.20708563]


portfolio before change:  [6.19571431]
curr_Stock_Price:  99.6513986737682
curr_Factors:  [99.65139867]
mat_Sqrt:  [[0.15]]
grads:  [0.07940798]
Stock Position:  0.0794079791748535
Bond Position:  [-1.71740188]


portfolio before change:  [6.2717942]
curr_Stock_Price:  100.61083919184803
curr_Factors:  [100.61083919]
mat_Sqrt:  [[0.15]]
grads:  [0.04510334]
Stock Position:  0.04510333669225081
Bond Position:  [1.73390965]


portfolio before change:  [6.30653233]
curr_Stock_Price:  101.37862607316934
curr_Factors:  [101.37862607]
mat_Sqrt:  [[0.15]]
grads:  [0.03741828]
Stock Position:  0.037418282893294685
Bond Position:  [2.51311822]


portfolio before change:  [6.31787184]
curr_Stock_Price:  101.6774756874112
curr_Factors:  [101.67747569]
mat_Sqrt:  [[0.15]]
grads:  [0.11494719]
Stock Position:  0.11494719321194252
Bond Position:  [-5.3696686]


portfolio before change:  [6.38355495]
curr_Stock_Price:  102.251815232402
curr_Factors:  [102.25181523]
mat_Sqrt:  [[0.15]]
grads:  [-0.15639609]
Stock Position:  -0.1563960948259688
Bond Position:  [22.37533954]


portfolio before change:  [6.49762674]
curr_Stock_Price:  101.53137978294312
curr_Factors:  [101.53137978]
mat_Sqrt:  [[0.15]]
grads:  [0.01035877]
Stock Position:  0.010358765749747385
Bond Position:  [5.44588696]


portfolio before change:  [6.49080641]
curr_Stock_Price:  100.8401091227371
curr_Factors:  [100.84010912]
mat_Sqrt:  [[0.15]]
grads:  [-0.34674986]
Stock Position:  -0.34674986364390054
Bond Position:  [41.45710049]


portfolio before change:  [6.54280154]
curr_Stock_Price:  100.69763182535132
curr_Factors:  [100.69763183]
mat_Sqrt:  [[0.15]]
grads:  [0.09461524]
Stock Position:  0.09461523700862
Bond Position:  [-2.98472876]


portfolio before change:  [6.57681829]
curr_Stock_Price:  101.05913073012739
curr_Factors:  [101.05913073]
mat_Sqrt:  [[0.15]]
grads:  [0.03990494]
Stock Position:  0.039904943088004054
Bond Position:  [2.54405943]


portfolio before change:  [6.57474723]
curr_Stock_Price:  101.00324608201134
curr_Factors:  [101.00324608]
mat_Sqrt:  [[0.15]]
grads:  [0.0427448]
Stock Position:  0.04274480194415473
Bond Position:  [2.25738348]


portfolio before change:  [6.57260456]
curr_Stock_Price:  100.94981841456791
curr_Factors:  [100.94981841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02534164]
Stock Position:  -0.025341635092458282
Bond Position:  [9.13083802]


portfolio before change:  [6.57070405]
curr_Stock_Price:  101.04733409917483
curr_Factors:  [101.0473341]
mat_Sqrt:  [[0.15]]
grads:  [-0.03077654]
Stock Position:  -0.03077654024283327
Bond Position:  [9.6805914]


portfolio before change:  [6.59457338]
curr_Stock_Price:  100.29142481272619
curr_Factors:  [100.29142481]
mat_Sqrt:  [[0.15]]
grads:  [0.15766713]
Stock Position:  0.15766713012935304
Bond Position:  [-9.21808775]


portfolio before change:  [6.60150456]
curr_Stock_Price:  100.33903986520176
curr_Factors:  [100.33903987]
mat_Sqrt:  [[0.15]]
grads:  [0.10053041]
Stock Position:  0.10053040789538917
Bond Position:  [-3.48562005]


portfolio before change:  [6.57969431]
curr_Stock_Price:  100.12425514115608
curr_Factors:  [100.12425514]
mat_Sqrt:  [[0.15]]
grads:  [0.07235314]
Stock Position:  0.07235313834441977
Bond Position:  [-0.66460978]


portfolio before change:  [6.62414501]
curr_Stock_Price:  100.73918693788853
curr_Factors:  [100.73918694]
mat_Sqrt:  [[0.15]]
grads:  [0.02439563]
Stock Position:  0.024395630312107515
Bond Position:  [4.16654905]


portfolio before change:  [6.63348666]
curr_Stock_Price:  101.11143516210068
curr_Factors:  [101.11143516]
mat_Sqrt:  [[0.15]]
grads:  [0.07826841]
Stock Position:  0.07826841308958166
Bond Position:  [-1.28034492]


portfolio before change:  [6.7160989]
curr_Stock_Price:  102.16795668475244
curr_Factors:  [102.16795668]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786751]
Stock Position:  -0.007867514552955734
Bond Position:  [7.51990678]


portfolio before change:  [6.71119132]
curr_Stock_Price:  102.8514744338826
curr_Factors:  [102.85147443]
mat_Sqrt:  [[0.15]]
grads:  [0.14567233]
Stock Position:  0.14567232873191652
Bond Position:  [-8.27142247]


portfolio before change:  [6.72377081]
curr_Stock_Price:  102.94137806616106
curr_Factors:  [102.94137807]
mat_Sqrt:  [[0.15]]
grads:  [-0.02704119]
Stock Position:  -0.027041185748165105
Bond Position:  [9.50742774]


portfolio before change:  [6.74583299]
curr_Stock_Price:  102.14748012360157
curr_Factors:  [102.14748012]
mat_Sqrt:  [[0.15]]
grads:  [0.00379537]
Stock Position:  0.0037953727167837213
Bond Position:  [6.35814523]


portfolio before change:  [6.7470181]
curr_Stock_Price:  102.35502612552776
curr_Factors:  [102.35502613]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107402]
Stock Position:  -0.06107401756605379
Bond Position:  [12.99825076]


portfolio before change:  [6.77324943]
curr_Stock_Price:  101.93882759821798
curr_Factors:  [101.9388276]
mat_Sqrt:  [[0.15]]
grads:  [-0.02210636]
Stock Position:  -0.022106363881062095
Bond Position:  [9.02674625]


portfolio before change:  [6.77304635]
curr_Stock_Price:  101.97353580284508
curr_Factors:  [101.9735358]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217628]
Stock Position:  -0.02217628105522984
Bond Position:  [9.03444014]


portfolio before change:  [6.7798279]
curr_Stock_Price:  101.6931966024064
curr_Factors:  [101.6931966]
mat_Sqrt:  [[0.15]]
grads:  [0.06958748]
Stock Position:  0.06958747531074211
Bond Position:  [-0.29674491]


portfolio before change:  [6.78479911]
curr_Stock_Price:  101.7649013892001
curr_Factors:  [101.76490139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03778041]
Stock Position:  -0.03778041005878731
Bond Position:  [10.62951881]


portfolio before change:  [6.77642196]
curr_Stock_Price:  102.00421876131684
curr_Factors:  [102.00421876]
mat_Sqrt:  [[0.15]]
grads:  [0.04274981]
Stock Position:  0.04274980650173204
Bond Position:  [2.41576135]


portfolio before change:  [6.77495921]
curr_Stock_Price:  101.96647020860847
curr_Factors:  [101.96647021]
mat_Sqrt:  [[0.15]]
grads:  [-0.02647748]
Stock Position:  -0.02647748144326884
Bond Position:  [9.47477453]


portfolio before change:  [6.7851729]
curr_Stock_Price:  101.60308620239724
curr_Factors:  [101.6030862]
mat_Sqrt:  [[0.15]]
grads:  [-0.0121617]
Stock Position:  -0.012161697285736411
Bond Position:  [8.02083887]


portfolio before change:  [6.78714847]
curr_Stock_Price:  101.48186517064386
curr_Factors:  [101.48186517]
mat_Sqrt:  [[0.15]]
grads:  [0.05190553]
Stock Position:  0.05190552983844862
Bond Position:  [1.51967849]


portfolio before change:  [6.74591134]
curr_Stock_Price:  100.68557030970166
curr_Factors:  [100.68557031]
mat_Sqrt:  [[0.15]]
grads:  [-0.05876493]
Stock Position:  -0.05876493095119407
Bond Position:  [12.66269193]


portfolio before change:  [6.75072732]
curr_Stock_Price:  100.61708497505599
curr_Factors:  [100.61708498]
mat_Sqrt:  [[0.15]]
grads:  [0.05247457]
Stock Position:  0.05247457066485035
Bond Position:  [1.47088899]


portfolio before change:  [6.76704133]
curr_Stock_Price:  100.92622652866551
curr_Factors:  [100.92622653]
mat_Sqrt:  [[0.15]]
grads:  [0.16875749]
Stock Position:  0.16875748845043276
Bond Position:  [-10.26501518]


portfolio before change:  [6.75588393]
curr_Stock_Price:  100.86391337848266
curr_Factors:  [100.86391338]
mat_Sqrt:  [[0.15]]
grads:  [0.03706997]
Stock Position:  0.03706997018193935
Bond Position:  [3.01686167]


portfolio before change:  [6.78396425]
curr_Stock_Price:  101.61632189557619
curr_Factors:  [101.6163219]
mat_Sqrt:  [[0.15]]
grads:  [0.08488721]
Stock Position:  0.08488720794345439
Bond Position:  [-1.84196159]


portfolio before change:  [6.7790613]
curr_Stock_Price:  101.55991968307244
curr_Factors:  [101.55991968]
mat_Sqrt:  [[0.15]]
grads:  [0.02230247]
Stock Position:  0.02230246519221604
Bond Position:  [4.51402473]


portfolio before change:  [6.79078278]
curr_Stock_Price:  102.07283811278057
curr_Factors:  [102.07283811]
mat_Sqrt:  [[0.15]]
grads:  [0.02455849]
Stock Position:  0.02455849111117351
Bond Position:  [4.28402789]


portfolio before change:  [6.78507895]
curr_Stock_Price:  101.8296803454543
curr_Factors:  [101.82968035]
mat_Sqrt:  [[0.15]]
grads:  [0.12990543]
Stock Position:  0.12990543252177494
Bond Position:  [-6.44314972]


portfolio before change:  [6.7163221]
curr_Stock_Price:  101.30349646062018
curr_Factors:  [101.30349646]
mat_Sqrt:  [[0.15]]
grads:  [0.00320853]
Stock Position:  0.003208527418774125
Bond Position:  [6.39128705]


portfolio before change:  [6.72031907]
curr_Stock_Price:  102.42472751518866
curr_Factors:  [102.42472752]
mat_Sqrt:  [[0.15]]
grads:  [-0.10327385]
Stock Position:  -0.10327384754947015
Bond Position:  [17.29811476]


portfolio before change:  [6.72838032]
curr_Stock_Price:  102.3571393835141
curr_Factors:  [102.35713938]
mat_Sqrt:  [[0.15]]
grads:  [-0.011516]
Stock Position:  -0.01151600058969671
Bond Position:  [7.9071252]


portfolio before change:  [6.72729283]
curr_Stock_Price:  102.49448789569193
curr_Factors:  [102.4944879]
mat_Sqrt:  [[0.15]]
grads:  [0.00819405]
Stock Position:  0.008194045618873064
Bond Position:  [5.88744832]


portfolio before change:  [6.72055686]
curr_Stock_Price:  101.62752381987339
curr_Factors:  [101.62752382]
mat_Sqrt:  [[0.15]]
grads:  [0.00821222]
Stock Position:  0.008212220335718796
Bond Position:  [5.88596924]


portfolio before change:  [6.7268996]
curr_Stock_Price:  102.35508018925692
curr_Factors:  [102.35508019]
mat_Sqrt:  [[0.15]]
grads:  [-0.0983565]
Stock Position:  -0.09835650366626486
Bond Position:  [16.79418742]


portfolio before change:  [6.7874581]
curr_Stock_Price:  101.75004814741364
curr_Factors:  [101.75004815]
mat_Sqrt:  [[0.15]]
grads:  [-0.02802318]
Stock Position:  -0.028023184393047795
Bond Position:  [9.63881846]


portfolio before change:  [6.78117704]
curr_Stock_Price:  101.99568436240742
curr_Factors:  [101.99568436]
mat_Sqrt:  [[0.15]]
grads:  [0.10406043]
Stock Position:  0.10406042643852499
Bond Position:  [-3.83253737]


portfolio before change:  [6.70426511]
curr_Stock_Price:  101.25887794682077
curr_Factors:  [101.25887795]
mat_Sqrt:  [[0.15]]
grads:  [-0.07237145]
Stock Position:  -0.0723714459851176
Bond Position:  [14.03251652]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.81398258]
Stock Price:  99.75496424219313
PL:  [6.81398258]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38914183e-02]
 [ 5.72706331e-03]
 [ 1.08020373e-02]
 [-8.76443855e-03]
 [ 1.39791919e-02]
 [-1.35597400e-02]
 [ 6.79349803e-04]
 [-1.50713911e-02]
 [ 8.23014940e-03]
 [ 1.67966668e-03]
 [ 1.48484054e-02]
 [-7.24964085e-03]
 [ 3.96236145e-04]
 [ 6.64478850e-03]
 [-1.70291782e-03]
 [ 1.30041718e-02]
 [ 2.51351797e-02]
 [-1.31314310e-02]
 [ 2.49663220e-02]
 [-4.90422847e-04]
 [-4.82047073e-03]
 [ 5.44824423e-03]
 [ 1.32905444e-02]
 [ 2.04134727e-02]
 [-1.38220272e-03]
 [ 4.41689069e-03]
 [ 7.39462565e-03]
 [ 9.25982974e-03]
 [ 1.61709023e-02]
 [ 2.90203827e-02]
 [-6.88128741e-03]
 [ 2.21893564e-02]
 [ 1.23699314e-02]
 [-1.97759614e-02]
 [-1.49487067e-02]
 [-3.88790519e-02]
 [ 1.42843484e-02]
 [-7.38773771e-03]
 [ 6.40085686e-02]
 [ 1.84459970e-02]
 [ 6.66029290e-03]
 [ 3.51993763e-02]
 [-3.37174612e-03]
 [ 1.87462741e-02]
 [-3.77978735e-02]
 [ 2.14771112e-02]
 [ 9.26905179e-03]
 [ 5.39916568e-03]
 [-1.13488885e-02]
 [ 2.12896344e-04]
 [ 1.72871688e-04]
 [-4.35489777e-03]
 [-1.32533733e-04]
 [ 8.07737185e-03]
 [-1.39284659e-02]
 [-5.33225677e-03]
 [-4.21495812e-03]
 [ 1.34918480e-02]
 [ 6.21413482e-03]
 [-2.42320316e-03]
 [-5.13891526e-03]
 [-2.69332538e-03]
 [-1.06070775e-03]
 [-4.75502809e-03]
 [ 1.81887427e-02]
 [ 6.70521105e-03]
 [ 1.96108401e-02]
 [-3.41586585e-03]
 [ 6.07158097e-03]
 [ 2.36518663e-02]
 [ 3.15391050e-03]
 [-1.52668359e-02]
 [-5.76092483e-03]
 [ 2.64610422e-03]
 [ 1.08277997e-02]
 [ 4.69837367e-03]
 [-1.56345945e-03]
 [-8.14057360e-03]
 [-2.28977660e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.28804681]
curr_Stock_Price:  99.84930513145468
curr_Factors:  [99.84930513]
mat_Sqrt:  [[0.15]]
grads:  [-0.09260946]
Stock Position:  -0.0926094551353827
Bond Position:  [7.95894293]


portfolio before change:  [-1.28118346]
curr_Stock_Price:  99.78056584139733
curr_Factors:  [99.78056584]
mat_Sqrt:  [[0.15]]
grads:  [0.03818042]
Stock Position:  0.03818042208745587
Bond Position:  [-5.09084758]


portfolio before change:  [-1.29651899]
curr_Stock_Price:  99.38724010662654
curr_Factors:  [99.38724011]
mat_Sqrt:  [[0.15]]
grads:  [0.07201358]
Stock Position:  0.07201358197753652
Bond Position:  [-8.45375015]


portfolio before change:  [-1.2948061]
curr_Stock_Price:  99.41836294833884
curr_Factors:  [99.41836295]
mat_Sqrt:  [[0.15]]
grads:  [-0.05842959]
Stock Position:  -0.05842959034470494
Bond Position:  [4.51416812]


portfolio before change:  [-1.31221473]
curr_Stock_Price:  99.72113388112554
curr_Factors:  [99.72113388]
mat_Sqrt:  [[0.15]]
grads:  [0.09319461]
Stock Position:  0.09319461260518777
Bond Position:  [-10.60568717]


portfolio before change:  [-1.36289998]
curr_Stock_Price:  99.1843821403714
curr_Factors:  [99.18438214]
mat_Sqrt:  [[0.15]]
grads:  [-0.09039827]
Stock Position:  -0.09039826693260163
Bond Position:  [7.60319627]


portfolio before change:  [-1.45421131]
curr_Stock_Price:  100.19973947439179
curr_Factors:  [100.19973947]
mat_Sqrt:  [[0.15]]
grads:  [0.004529]
Stock Position:  0.004528998687661177
Bond Position:  [-1.9080158]


portfolio before change:  [-1.45323421]
curr_Stock_Price:  100.44181319700176
curr_Factors:  [100.4418132]
mat_Sqrt:  [[0.15]]
grads:  [-0.10047594]
Stock Position:  -0.10047594061459292
Bond Position:  [8.63875145]


portfolio before change:  [-1.49812563]
curr_Stock_Price:  100.8939747153569
curr_Factors:  [100.89397472]
mat_Sqrt:  [[0.15]]
grads:  [0.05486766]
Stock Position:  0.05486766269461797
Bond Position:  [-7.0339422]


portfolio before change:  [-1.51680644]
curr_Stock_Price:  100.56151704841271
curr_Factors:  [100.56151705]
mat_Sqrt:  [[0.15]]
grads:  [0.01119778]
Stock Position:  0.011197777897552035
Bond Position:  [-2.64287197]


portfolio before change:  [-1.52522956]
curr_Stock_Price:  99.82405510360212
curr_Factors:  [99.8240551]
mat_Sqrt:  [[0.15]]
grads:  [0.09898937]
Stock Position:  0.09898936932690791
Bond Position:  [-11.40674981]


portfolio before change:  [-1.59435209]
curr_Stock_Price:  99.13297491843043
curr_Factors:  [99.13297492]
mat_Sqrt:  [[0.15]]
grads:  [-0.04833094]
Stock Position:  -0.048330938968384946
Bond Position:  [3.19683767]


portfolio before change:  [-1.57298712]
curr_Stock_Price:  98.69505337490665
curr_Factors:  [98.69505337]
mat_Sqrt:  [[0.15]]
grads:  [0.00264157]
Stock Position:  0.002641574297459169
Bond Position:  [-1.83369744]


portfolio before change:  [-1.57126377]
curr_Stock_Price:  99.39083730467817
curr_Factors:  [99.3908373]
mat_Sqrt:  [[0.15]]
grads:  [0.04429859]
Stock Position:  0.044298589981225184
Bond Position:  [-5.97413772]


portfolio before change:  [-1.53584306]
curr_Stock_Price:  100.19885623538971
curr_Factors:  [100.19885624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01135279]
Stock Position:  -0.011352785488244477
Bond Position:  [-0.39830694]


portfolio before change:  [-1.53313625]
curr_Stock_Price:  99.9582362180733
curr_Factors:  [99.95823622]
mat_Sqrt:  [[0.15]]
grads:  [0.08669448]
Stock Position:  0.08669447892788149
Bond Position:  [-10.19896346]


portfolio before change:  [-1.57600837]
curr_Stock_Price:  99.47106957456747
curr_Factors:  [99.47106957]
mat_Sqrt:  [[0.15]]
grads:  [0.16756786]
Stock Position:  0.16756786488555014
Bond Position:  [-18.24416311]


portfolio before change:  [-1.76674743]
curr_Stock_Price:  98.33959507942518
curr_Factors:  [98.33959508]
mat_Sqrt:  [[0.15]]
grads:  [-0.08754287]
Stock Position:  -0.08754287306357604
Bond Position:  [6.84218326]


portfolio before change:  [-1.77020557]
curr_Stock_Price:  98.38398234401076
curr_Factors:  [98.38398234]
mat_Sqrt:  [[0.15]]
grads:  [0.16644215]
Stock Position:  0.16644214652264588
Bond Position:  [-18.14544677]


portfolio before change:  [-1.7469441]
curr_Stock_Price:  98.53055335468373
curr_Factors:  [98.53055335]
mat_Sqrt:  [[0.15]]
grads:  [-0.00326949]
Stock Position:  -0.003269485645292257
Bond Position:  [-1.42479987]


portfolio before change:  [-1.7478264]
curr_Stock_Price:  98.77317556899077
curr_Factors:  [98.77317557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213647]
Stock Position:  -0.03213647154192808
Bond Position:  [1.42639494]


portfolio before change:  [-1.73614439]
curr_Stock_Price:  98.41243728986021
curr_Factors:  [98.41243729]
mat_Sqrt:  [[0.15]]
grads:  [0.03632163]
Stock Position:  0.03632162821835745
Bond Position:  [-5.31064435]


portfolio before change:  [-1.75738508]
curr_Stock_Price:  97.83678134943835
curr_Factors:  [97.83678135]
mat_Sqrt:  [[0.15]]
grads:  [0.08860363]
Stock Position:  0.08860362908628147
Bond Position:  [-10.42607897]


portfolio before change:  [-1.74213866]
curr_Stock_Price:  98.01621050849049
curr_Factors:  [98.01621051]
mat_Sqrt:  [[0.15]]
grads:  [0.13608982]
Stock Position:  0.1360898180009785
Bond Position:  [-15.0811469]


portfolio before change:  [-1.75004193]
curr_Stock_Price:  97.96506289868177
curr_Factors:  [97.9650629]
mat_Sqrt:  [[0.15]]
grads:  [-0.00921468]
Stock Position:  -0.009214684804831747
Bond Position:  [-0.84732475]


portfolio before change:  [-1.7469734]
curr_Stock_Price:  97.62631208922166
curr_Factors:  [97.62631209]
mat_Sqrt:  [[0.15]]
grads:  [0.02944594]
Stock Position:  0.02944593790868136
Bond Position:  [-4.62167173]


portfolio before change:  [-1.72813012]
curr_Stock_Price:  98.27605022515257
curr_Factors:  [98.27605023]
mat_Sqrt:  [[0.15]]
grads:  [0.0492975]
Stock Position:  0.04929750434619799
Bond Position:  [-6.57289413]


portfolio before change:  [-1.74913957]
curr_Stock_Price:  97.85820696261145
curr_Factors:  [97.85820696]
mat_Sqrt:  [[0.15]]
grads:  [0.0617322]
Stock Position:  0.061732198280084125
Bond Position:  [-7.7901418]


portfolio before change:  [-1.78751226]
curr_Stock_Price:  97.24449489658853
curr_Factors:  [97.2444949]
mat_Sqrt:  [[0.15]]
grads:  [0.10780602]
Stock Position:  0.1078060150348228
Bond Position:  [-12.27105374]


portfolio before change:  [-1.76706106]
curr_Stock_Price:  97.44131286493105
curr_Factors:  [97.44131286]
mat_Sqrt:  [[0.15]]
grads:  [0.19346922]
Stock Position:  0.19346921772502626
Bond Position:  [-20.61895564]


portfolio before change:  [-1.89557058]
curr_Stock_Price:  96.78373646281639
curr_Factors:  [96.78373646]
mat_Sqrt:  [[0.15]]
grads:  [-0.04587525]
Stock Position:  -0.045875249374804014
Bond Position:  [2.54440746]


portfolio before change:  [-1.87511023]
curr_Stock_Price:  96.34120335773981
curr_Factors:  [96.34120336]
mat_Sqrt:  [[0.15]]
grads:  [0.14792904]
Stock Position:  0.14792904258593098
Bond Position:  [-16.12677221]


portfolio before change:  [-1.82783875]
curr_Stock_Price:  96.66757225594706
curr_Factors:  [96.66757226]
mat_Sqrt:  [[0.15]]
grads:  [0.08246621]
Stock Position:  0.08246620913964502
Bond Position:  [-9.79964698]


portfolio before change:  [-1.84110577]
curr_Stock_Price:  96.51412126506801
curr_Factors:  [96.51412127]
mat_Sqrt:  [[0.15]]
grads:  [-0.13183974]
Stock Position:  -0.13183974264001286
Bond Position:  [10.88329114]


portfolio before change:  [-1.73114324]
curr_Stock_Price:  95.68521867307759
curr_Factors:  [95.68521867]
mat_Sqrt:  [[0.15]]
grads:  [-0.09965804]
Stock Position:  -0.0996580448889301
Bond Position:  [7.80465858]


portfolio before change:  [-1.71835027]
curr_Stock_Price:  95.56174484775312
curr_Factors:  [95.56174485]
mat_Sqrt:  [[0.15]]
grads:  [-0.25919368]
Stock Position:  -0.2591936794657033
Bond Position:  [23.05064999]


portfolio before change:  [-1.61673204]
curr_Stock_Price:  95.17524807992052
curr_Factors:  [95.17524808]
mat_Sqrt:  [[0.15]]
grads:  [0.09522899]
Stock Position:  0.09522898944737368
Bond Position:  [-10.68017474]


portfolio before change:  [-1.68259279]
curr_Stock_Price:  94.4906538407506
curr_Factors:  [94.49065384]
mat_Sqrt:  [[0.15]]
grads:  [-0.04925158]
Stock Position:  -0.04925158473997354
Bond Position:  [2.97122165]


portfolio before change:  [-1.67796924]
curr_Stock_Price:  94.40054820922307
curr_Factors:  [94.40054821]
mat_Sqrt:  [[0.15]]
grads:  [0.42672379]
Stock Position:  0.42672379079356637
Bond Position:  [-41.96092902]


portfolio before change:  [-1.44107265]
curr_Stock_Price:  94.9618462440807
curr_Factors:  [94.96184624]
mat_Sqrt:  [[0.15]]
grads:  [0.12297331]
Stock Position:  0.12297331301940356
Bond Position:  [-13.1188455]


portfolio before change:  [-1.3968818]
curr_Stock_Price:  95.32786717805573
curr_Factors:  [95.32786718]
mat_Sqrt:  [[0.15]]
grads:  [0.04440195]
Stock Position:  0.04440195264774217
Bond Position:  [-5.62962524]


portfolio before change:  [-1.36169393]
curr_Stock_Price:  96.12827650642046
curr_Factors:  [96.12827651]
mat_Sqrt:  [[0.15]]
grads:  [0.23466251]
Stock Position:  0.23466250841386993
Bond Position:  [-23.91939642]


portfolio before change:  [-1.43708889]
curr_Stock_Price:  95.81335633886746
curr_Factors:  [95.81335634]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247831]
Stock Position:  -0.022478307449958834
Bond Position:  [0.71663319]


portfolio before change:  [-1.43131695]
curr_Stock_Price:  95.55857076766937
curr_Factors:  [95.55857077]
mat_Sqrt:  [[0.15]]
grads:  [0.12497516]
Stock Position:  0.12497516047255071
Bond Position:  [-13.37376467]


portfolio before change:  [-1.34581261]
curr_Stock_Price:  96.24942986587074
curr_Factors:  [96.24942987]
mat_Sqrt:  [[0.15]]
grads:  [-0.25198582]
Stock Position:  -0.2519858230439965
Bond Position:  [22.90767919]


portfolio before change:  [-1.27692718]
curr_Stock_Price:  95.98174155001045
curr_Factors:  [95.98174155]
mat_Sqrt:  [[0.15]]
grads:  [0.14318074]
Stock Position:  0.14318074158813685
Bond Position:  [-15.01966411]


portfolio before change:  [-1.32889325]
curr_Stock_Price:  95.625357649808
curr_Factors:  [95.62535765]
mat_Sqrt:  [[0.15]]
grads:  [0.06179368]
Stock Position:  0.06179367860430367
Bond Position:  [-7.23793586]


portfolio before change:  [-1.37428377]
curr_Stock_Price:  94.89812897966529
curr_Factors:  [94.89812898]
mat_Sqrt:  [[0.15]]
grads:  [0.03599444]
Stock Position:  0.03599443783919918
Bond Position:  [-4.79008857]


portfolio before change:  [-1.37266706]
curr_Stock_Price:  94.9513620933188
curr_Factors:  [94.95136209]
mat_Sqrt:  [[0.15]]
grads:  [-0.07565926]
Stock Position:  -0.07565925672170831
Bond Position:  [5.81128242]


portfolio before change:  [-1.34851601]
curr_Stock_Price:  94.63695469802293
curr_Factors:  [94.6369547]
mat_Sqrt:  [[0.15]]
grads:  [0.00141931]
Stock Position:  0.0014193089616118264
Bond Position:  [-1.48283509]


portfolio before change:  [-1.34897974]
curr_Stock_Price:  94.37552441457946
curr_Factors:  [94.37552441]
mat_Sqrt:  [[0.15]]
grads:  [0.00115248]
Stock Position:  0.0011524779219033768
Bond Position:  [-1.45774545]


portfolio before change:  [-1.34901166]
curr_Stock_Price:  94.42688894412322
curr_Factors:  [94.42688894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02903265]
Stock Position:  -0.02903265177228933
Bond Position:  [1.39245133]


portfolio before change:  [-1.39363548]
curr_Stock_Price:  95.96690851298688
curr_Factors:  [95.96690851]
mat_Sqrt:  [[0.15]]
grads:  [-0.00088356]
Stock Position:  -0.0008835582168187326
Bond Position:  [-1.30884313]


portfolio before change:  [-1.39383448]
curr_Stock_Price:  96.09954614753886
curr_Factors:  [96.09954615]
mat_Sqrt:  [[0.15]]
grads:  [0.05384915]
Stock Position:  0.05384914569161861
Bond Position:  [-6.56871294]


portfolio before change:  [-1.43653659]
curr_Stock_Price:  95.31417520601887
curr_Factors:  [95.31417521]
mat_Sqrt:  [[0.15]]
grads:  [-0.09285644]
Stock Position:  -0.09285643949626944
Bond Position:  [7.41399835]


portfolio before change:  [-1.38536466]
curr_Stock_Price:  94.76807912437717
curr_Factors:  [94.76807912]
mat_Sqrt:  [[0.15]]
grads:  [-0.03554838]
Stock Position:  -0.03554837848730801
Bond Position:  [1.98348688]


portfolio before change:  [-1.38143173]
curr_Stock_Price:  94.66093039101945
curr_Factors:  [94.66093039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02809972]
Stock Position:  -0.028099720797094496
Bond Position:  [1.27851399]


portfolio before change:  [-1.3980588]
curr_Stock_Price:  95.25549071157883
curr_Factors:  [95.25549071]
mat_Sqrt:  [[0.15]]
grads:  [0.08994565]
Stock Position:  0.08994565364125887
Bond Position:  [-9.96587617]


portfolio before change:  [-1.47954252]
curr_Stock_Price:  94.356494143932
curr_Factors:  [94.35649414]
mat_Sqrt:  [[0.15]]
grads:  [0.04142757]
Stock Position:  0.04142756544094243
Bond Position:  [-5.38850235]


portfolio before change:  [-1.46208408]
curr_Stock_Price:  94.78604449305158
curr_Factors:  [94.78604449]
mat_Sqrt:  [[0.15]]
grads:  [-0.01615469]
Stock Position:  -0.01615468772578965
Bond Position:  [0.06915487]


portfolio before change:  [-1.45980312]
curr_Stock_Price:  94.64511696878047
curr_Factors:  [94.64511697]
mat_Sqrt:  [[0.15]]
grads:  [-0.03425944]
Stock Position:  -0.03425943509257375
Bond Position:  [1.78268512]


portfolio before change:  [-1.47831107]
curr_Stock_Price:  95.1885985806699
curr_Factors:  [95.18859858]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179555]
Stock Position:  -0.017955502565820496
Bond Position:  [0.23084805]


portfolio before change:  [-1.47976583]
curr_Stock_Price:  95.27042209183172
curr_Factors:  [95.27042209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00707138]
Stock Position:  -0.0070713849774607885
Bond Position:  [-0.80607199]


portfolio before change:  [-1.47882134]
curr_Stock_Price:  95.12973343521028
curr_Factors:  [95.12973344]
mat_Sqrt:  [[0.15]]
grads:  [-0.03170019]
Stock Position:  -0.03170018727297305
Bond Position:  [1.53680902]


portfolio before change:  [-1.48494304]
curr_Stock_Price:  95.32587583455833
curr_Factors:  [95.32587583]
mat_Sqrt:  [[0.15]]
grads:  [0.12125828]
Stock Position:  0.12125828443263015
Bond Position:  [-13.04399521]


portfolio before change:  [-1.5055169]
curr_Stock_Price:  95.16292957940395
curr_Factors:  [95.16292958]
mat_Sqrt:  [[0.15]]
grads:  [0.04470141]
Stock Position:  0.044701406985523974
Bond Position:  [-5.75943374]


portfolio before change:  [-1.47848237]
curr_Stock_Price:  95.77576283395317
curr_Factors:  [95.77576283]
mat_Sqrt:  [[0.15]]
grads:  [0.13073893]
Stock Position:  0.1307389340262775
Bond Position:  [-14.00010351]


portfolio before change:  [-1.51750439]
curr_Stock_Price:  95.48398293948104
curr_Factors:  [95.48398294]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277244]
Stock Position:  -0.02277243897004913
Bond Position:  [0.65689878]


portfolio before change:  [-1.52611978]
curr_Stock_Price:  95.86411091692517
curr_Factors:  [95.86411092]
mat_Sqrt:  [[0.15]]
grads:  [0.04047721]
Stock Position:  0.040477206450663376
Bond Position:  [-5.40643119]


portfolio before change:  [-1.49132371]
curr_Stock_Price:  96.73210516976727
curr_Factors:  [96.73210517]
mat_Sqrt:  [[0.15]]
grads:  [0.15767911]
Stock Position:  0.15767910877797733
Bond Position:  [-16.74395584]


portfolio before change:  [-1.68368882]
curr_Stock_Price:  95.51876379700474
curr_Factors:  [95.5187638]
mat_Sqrt:  [[0.15]]
grads:  [0.02102607]
Stock Position:  0.02102607002972888
Bond Position:  [-3.69207304]


portfolio before change:  [-1.68836993]
curr_Stock_Price:  95.30710527880129
curr_Factors:  [95.30710528]
mat_Sqrt:  [[0.15]]
grads:  [-0.10177891]
Stock Position:  -0.10177890588193016
Bond Position:  [8.01188297]


portfolio before change:  [-1.66803359]
curr_Stock_Price:  95.11221637331393
curr_Factors:  [95.11221637]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840617]
Stock Position:  -0.038406165537335155
Bond Position:  [1.98486193]


portfolio before change:  [-1.66385487]
curr_Stock_Price:  95.00664299051569
curr_Factors:  [95.00664299]
mat_Sqrt:  [[0.15]]
grads:  [0.01764069]
Stock Position:  0.01764069476908294
Bond Position:  [-3.33983806]


portfolio before change:  [-1.65174871]
curr_Stock_Price:  95.70473943707333
curr_Factors:  [95.70473944]
mat_Sqrt:  [[0.15]]
grads:  [0.07218533]
Stock Position:  0.07218533147501073
Bond Position:  [-8.56022705]


portfolio before change:  [-1.63982688]
curr_Stock_Price:  95.87730718985993
curr_Factors:  [95.87730719]
mat_Sqrt:  [[0.15]]
grads:  [0.03132249]
Stock Position:  0.031322491145293736
Bond Position:  [-4.64294298]


portfolio before change:  [-1.61902605]
curr_Stock_Price:  96.55065787606244
curr_Factors:  [96.55065788]
mat_Sqrt:  [[0.15]]
grads:  [-0.01042306]
Stock Position:  -0.01042306299188631
Bond Position:  [-0.61267246]


portfolio before change:  [-1.62531632]
curr_Stock_Price:  97.1504789545206
curr_Factors:  [97.15047895]
mat_Sqrt:  [[0.15]]
grads:  [-0.05427049]
Stock Position:  -0.05427049065741009
Bond Position:  [3.64708784]


portfolio before change:  [-1.63380166]
curr_Stock_Price:  97.31103197672537
curr_Factors:  [97.31103198]
mat_Sqrt:  [[0.15]]
grads:  [-0.15265177]
Stock Position:  -0.15265177311645073
Bond Position:  [13.22089992]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.51831532]
Stock Price:  96.55991061257278
PL:  [-1.51831532]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40550885e-02]
 [-2.18192240e-02]
 [ 4.49729238e-02]
 [-1.17797805e-02]
 [ 1.09266807e-02]
 [-1.58400107e-02]
 [-1.30204351e-02]
 [ 2.41175303e-02]
 [-1.88567575e-02]
 [-1.28287271e-02]
 [ 1.04843702e-02]
 [-7.73953518e-03]
 [-1.04522290e-03]
 [ 5.66071240e-03]
 [-2.69783609e-03]
 [ 6.65865868e-03]
 [-5.82795979e-03]
 [-1.43892173e-02]
 [ 2.12250737e-02]
 [-7.13813131e-04]
 [-3.81552136e-03]
 [ 5.44542893e-03]
 [ 1.67084262e-02]
 [ 1.78451558e-02]
 [-5.69343579e-03]
 [ 4.44265248e-03]
 [ 8.31811197e-03]
 [ 8.88935668e-03]
 [ 1.56797109e-02]
 [ 2.73458621e-03]
 [-6.45076245e-03]
 [ 1.01000499e-02]
 [ 1.19338759e-02]
 [ 7.43051913e-03]
 [ 5.47833221e-03]
 [ 1.03393473e-02]
 [-2.80456524e-02]
 [-1.68677139e-03]
 [-2.48898437e-02]
 [-1.27142066e-02]
 [ 3.97104215e-03]
 [ 1.06586172e-02]
 [-6.82973813e-03]
 [-2.34509779e-03]
 [ 1.38091194e-02]
 [ 1.35644406e-02]
 [ 1.07469341e-02]
 [ 4.19010219e-03]
 [ 1.01270961e-02]
 [-1.45597697e-03]
 [ 1.18756424e-02]
 [-1.65386702e-02]
 [ 2.08990127e-03]
 [ 1.60354601e-03]
 [-3.49968781e-03]
 [-3.52866472e-03]
 [ 1.03449709e-02]
 [-4.42817861e-03]
 [ 6.03767337e-03]
 [-3.95957080e-03]
 [-1.96151401e-03]
 [ 8.37714722e-03]
 [-1.67730744e-02]
 [ 1.86505754e-03]
 [ 1.66296491e-02]
 [ 1.67603933e-02]
 [ 4.37919692e-03]
 [ 1.47228974e-02]
 [ 7.92479392e-03]
 [ 1.11501651e-02]
 [ 4.95770062e-03]
 [-1.49364672e-02]
 [-3.13943180e-02]
 [ 6.30197736e-04]
 [-4.87157844e-03]
 [-2.63753317e-02]
 [-5.68357479e-03]
 [ 1.65246526e-02]
 [ 2.62697888e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.2557874]
curr_Stock_Price:  98.85157537220653
curr_Factors:  [98.85157537]
mat_Sqrt:  [[0.15]]
grads:  [-0.09370059]
Stock Position:  -0.0937005902105785
Bond Position:  [-13.99333644]


portfolio before change:  [-23.24535893]
curr_Stock_Price:  98.73094563118333
curr_Factors:  [98.73094563]
mat_Sqrt:  [[0.15]]
grads:  [-0.14546149]
Stock Position:  -0.14546149337416775
Bond Position:  [-8.88380814]


portfolio before change:  [-23.2224227]
curr_Stock_Price:  98.56944935676962
curr_Factors:  [98.56944936]
mat_Sqrt:  [[0.15]]
grads:  [0.29981949]
Stock Position:  0.29981949170238215
Bond Position:  [-52.7754649]


portfolio before change:  [-23.12964161]
curr_Stock_Price:  98.88990771016209
curr_Factors:  [98.88990771]
mat_Sqrt:  [[0.15]]
grads:  [-0.07853187]
Stock Position:  -0.0785318700563481
Bond Position:  [-15.36363223]


portfolio before change:  [-23.13990506]
curr_Stock_Price:  99.008371658363
curr_Factors:  [99.00837166]
mat_Sqrt:  [[0.15]]
grads:  [0.07284454]
Stock Position:  0.07284453811784364
Bond Position:  [-30.35212416]


portfolio before change:  [-23.21012991]
curr_Stock_Price:  98.07037711342124
curr_Factors:  [98.07037711]
mat_Sqrt:  [[0.15]]
grads:  [-0.10560007]
Stock Position:  -0.10560007158955845
Bond Position:  [-12.85389106]


portfolio before change:  [-23.27380747]
curr_Stock_Price:  98.66577599645184
curr_Factors:  [98.665776]
mat_Sqrt:  [[0.15]]
grads:  [-0.0868029]
Stock Position:  -0.08680290083972272
Bond Position:  [-14.7093319]


portfolio before change:  [-23.27836588]
curr_Stock_Price:  98.70769919553496
curr_Factors:  [98.7076992]
mat_Sqrt:  [[0.15]]
grads:  [0.16078354]
Stock Position:  0.1607835350114496
Bond Position:  [-39.14893869]


portfolio before change:  [-23.29258991]
curr_Stock_Price:  98.63445074434462
curr_Factors:  [98.63445074]
mat_Sqrt:  [[0.15]]
grads:  [-0.12571172]
Stock Position:  -0.12571171670077766
Bond Position:  [-10.89308378]


portfolio before change:  [-23.27358221]
curr_Stock_Price:  98.47783417366784
curr_Factors:  [98.47783417]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552485]
Stock Position:  -0.08552484706006702
Bond Position:  [-14.85128051]


portfolio before change:  [-23.26997583]
curr_Stock_Price:  98.42481315040943
curr_Factors:  [98.42481315]
mat_Sqrt:  [[0.15]]
grads:  [0.0698958]
Stock Position:  0.06989580159559836
Bond Position:  [-30.14945704]


portfolio before change:  [-23.24209292]
curr_Stock_Price:  98.85069439612137
curr_Factors:  [98.8506944]
mat_Sqrt:  [[0.15]]
grads:  [-0.0515969]
Stock Position:  -0.0515969011942436
Bond Position:  [-18.14170341]


portfolio before change:  [-23.277859]
curr_Stock_Price:  99.52190112547778
curr_Factors:  [99.52190113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696815]
Stock Position:  -0.006968152678177969
Bond Position:  [-22.5843752]


portfolio before change:  [-23.2773149]
curr_Stock_Price:  99.24124295921172
curr_Factors:  [99.24124296]
mat_Sqrt:  [[0.15]]
grads:  [0.03773808]
Stock Position:  0.03773808267657607
Bond Position:  [-27.02248913]


portfolio before change:  [-23.3149359]
curr_Stock_Price:  98.2891002624991
curr_Factors:  [98.28910026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798557]
Stock Position:  -0.017985573930078432
Bond Position:  [-21.54715002]


portfolio before change:  [-23.31871023]
curr_Stock_Price:  98.42407452374609
curr_Factors:  [98.42407452]
mat_Sqrt:  [[0.15]]
grads:  [0.04439106]
Stock Position:  0.0443910578774662
Bond Position:  [-27.68785901]


portfolio before change:  [-23.32653879]
curr_Stock_Price:  98.28670399224949
curr_Factors:  [98.28670399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03885307]
Stock Position:  -0.038853065250205
Bond Position:  [-19.50779907]


portfolio before change:  [-23.35378502]
curr_Stock_Price:  98.95658538824286
curr_Factors:  [98.95658539]
mat_Sqrt:  [[0.15]]
grads:  [-0.09592812]
Stock Position:  -0.09592811519307456
Bond Position:  [-13.86106629]


portfolio before change:  [-23.40664349]
curr_Stock_Price:  99.4985759578035
curr_Factors:  [99.49857596]
mat_Sqrt:  [[0.15]]
grads:  [0.14150049]
Stock Position:  0.14150049139995177
Bond Position:  [-37.48574088]


portfolio before change:  [-23.55616682]
curr_Stock_Price:  98.45843543260892
curr_Factors:  [98.45843543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00475875]
Stock Position:  -0.004758754208572302
Bond Position:  [-23.08762733]


portfolio before change:  [-23.56253685]
curr_Stock_Price:  99.49379128959002
curr_Factors:  [99.49379129]
mat_Sqrt:  [[0.15]]
grads:  [-0.02543681]
Stock Position:  -0.025436809054026923
Bond Position:  [-21.03173228]


portfolio before change:  [-23.53694234]
curr_Stock_Price:  98.43591361753899
curr_Factors:  [98.43591362]
mat_Sqrt:  [[0.15]]
grads:  [0.03630286]
Stock Position:  0.03630285955538263
Bond Position:  [-27.11044749]


portfolio before change:  [-23.53031661]
curr_Stock_Price:  98.6651017164254
curr_Factors:  [98.66510172]
mat_Sqrt:  [[0.15]]
grads:  [0.11138951]
Stock Position:  0.11138950791636432
Bond Position:  [-34.52057374]


portfolio before change:  [-23.50043755]
curr_Stock_Price:  98.95271103659697
curr_Factors:  [98.95271104]
mat_Sqrt:  [[0.15]]
grads:  [0.11896771]
Stock Position:  0.11896770557612416
Bond Position:  [-35.27261455]


portfolio before change:  [-23.50865785]
curr_Stock_Price:  98.90214527652664
curr_Factors:  [98.90214528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03795624]
Stock Position:  -0.03795623861471392
Bond Position:  [-19.75470443]


portfolio before change:  [-23.47636685]
curr_Stock_Price:  98.01887262949533
curr_Factors:  [98.01887263]
mat_Sqrt:  [[0.15]]
grads:  [0.02961768]
Stock Position:  0.02961768321717242
Bond Position:  [-26.37945877]


portfolio before change:  [-23.46642887]
curr_Stock_Price:  98.41008312108984
curr_Factors:  [98.41008312]
mat_Sqrt:  [[0.15]]
grads:  [0.05545408]
Stock Position:  0.05545407982992588
Bond Position:  [-28.92366948]


portfolio before change:  [-23.478691]
curr_Stock_Price:  98.22156057494976
curr_Factors:  [98.22156057]
mat_Sqrt:  [[0.15]]
grads:  [0.05926238]
Stock Position:  0.05926237785391745
Bond Position:  [-29.29953424]


portfolio before change:  [-23.4445869]
curr_Stock_Price:  98.82793830580185
curr_Factors:  [98.82793831]
mat_Sqrt:  [[0.15]]
grads:  [0.10453141]
Stock Position:  0.10453140631623277
Bond Position:  [-33.77521027]


portfolio before change:  [-23.43874294]
curr_Stock_Price:  98.90403954376453
curr_Factors:  [98.90403954]
mat_Sqrt:  [[0.15]]
grads:  [0.01823057]
Stock Position:  0.018230574704422207
Bond Position:  [-25.24182042]


portfolio before change:  [-23.4427757]
curr_Stock_Price:  98.76937063278417
curr_Factors:  [98.76937063]
mat_Sqrt:  [[0.15]]
grads:  [-0.04300508]
Stock Position:  -0.0430050829778758
Bond Position:  [-19.19519072]


portfolio before change:  [-23.4522688]
curr_Stock_Price:  98.96221688148411
curr_Factors:  [98.96221688]
mat_Sqrt:  [[0.15]]
grads:  [0.06733367]
Stock Position:  0.06733366579648604
Bond Position:  [-30.11575764]


portfolio before change:  [-23.40591644]
curr_Stock_Price:  99.67856962529852
curr_Factors:  [99.67856963]
mat_Sqrt:  [[0.15]]
grads:  [0.07955917]
Stock Position:  0.07955917283112054
Bond Position:  [-31.33626099]


portfolio before change:  [-23.33052341]
curr_Stock_Price:  100.65082220093235
curr_Factors:  [100.6508222]
mat_Sqrt:  [[0.15]]
grads:  [0.04953679]
Stock Position:  0.049536794177553425
Bond Position:  [-28.31644247]


portfolio before change:  [-23.30260645]
curr_Stock_Price:  101.25010989143951
curr_Factors:  [101.25010989]
mat_Sqrt:  [[0.15]]
grads:  [0.03652221]
Stock Position:  0.03652221470962288
Bond Position:  [-27.0004847]


portfolio before change:  [-23.30695976]
curr_Stock_Price:  101.17712068558711
curr_Factors:  [101.17712069]
mat_Sqrt:  [[0.15]]
grads:  [0.06892898]
Stock Position:  0.0689289820251008
Bond Position:  [-30.28099569]


portfolio before change:  [-23.28630836]
curr_Stock_Price:  101.50418228087733
curr_Factors:  [101.50418228]
mat_Sqrt:  [[0.15]]
grads:  [-0.18697102]
Stock Position:  -0.18697101598664925
Bond Position:  [-4.30796827]


portfolio before change:  [-23.41591853]
curr_Stock_Price:  102.19595215970139
curr_Factors:  [102.19595216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01124514]
Stock Position:  -0.011245142591043984
Bond Position:  [-22.26671048]


portfolio before change:  [-23.42421373]
curr_Stock_Price:  102.80986023828925
curr_Factors:  [102.80986024]
mat_Sqrt:  [[0.15]]
grads:  [-0.16593229]
Stock Position:  -0.16593229153817077
Bond Position:  [-6.36473803]


portfolio before change:  [-23.31118278]
curr_Stock_Price:  102.12627565944827
curr_Factors:  [102.12627566]
mat_Sqrt:  [[0.15]]
grads:  [-0.08476138]
Stock Position:  -0.08476137728055483
Bond Position:  [-14.654819]


portfolio before change:  [-23.36042952]
curr_Stock_Price:  102.69647379043997
curr_Factors:  [102.69647379]
mat_Sqrt:  [[0.15]]
grads:  [0.02647361]
Stock Position:  0.026473614310050762
Bond Position:  [-26.07917635]


portfolio before change:  [-23.3707958]
curr_Stock_Price:  102.36647409025177
curr_Factors:  [102.36647409]
mat_Sqrt:  [[0.15]]
grads:  [0.07105745]
Stock Position:  0.0710574477449179
Bond Position:  [-30.64469618]


portfolio before change:  [-23.37191535]
curr_Stock_Price:  102.37767356962964
curr_Factors:  [102.37767357]
mat_Sqrt:  [[0.15]]
grads:  [-0.04553159]
Stock Position:  -0.045531587561308436
Bond Position:  [-18.71049734]


portfolio before change:  [-23.36439308]
curr_Stock_Price:  102.18677953671585
curr_Factors:  [102.18677954]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563399]
Stock Position:  -0.015633985274342198
Bond Position:  [-21.76680647]


portfolio before change:  [-23.35620346]
curr_Stock_Price:  101.57592498303897
curr_Factors:  [101.57592498]
mat_Sqrt:  [[0.15]]
grads:  [0.0920608]
Stock Position:  0.09206079623500156
Bond Position:  [-32.70736399]


portfolio before change:  [-23.37519309]
curr_Stock_Price:  101.39185789034094
curr_Factors:  [101.39185789]
mat_Sqrt:  [[0.15]]
grads:  [0.0904296]
Stock Position:  0.09042960381102516
Bond Position:  [-32.54401863]


portfolio before change:  [-23.40094883]
curr_Stock_Price:  101.12953591254592
curr_Factors:  [101.12953591]
mat_Sqrt:  [[0.15]]
grads:  [0.07164623]
Stock Position:  0.07164622701505012
Bond Position:  [-30.64649852]


portfolio before change:  [-23.48640634]
curr_Stock_Price:  99.96350037773045
curr_Factors:  [99.96350038]
mat_Sqrt:  [[0.15]]
grads:  [0.02793401]
Stock Position:  0.027934014570408037
Bond Position:  [-26.27878822]


portfolio before change:  [-23.46423299]
curr_Stock_Price:  100.81607484759465
curr_Factors:  [100.81607485]
mat_Sqrt:  [[0.15]]
grads:  [0.06751397]
Stock Position:  0.06751397389174274
Bond Position:  [-30.27072684]


portfolio before change:  [-23.45450463]
curr_Stock_Price:  100.98819245343716
curr_Factors:  [100.98819245]
mat_Sqrt:  [[0.15]]
grads:  [-0.00970651]
Stock Position:  -0.009706513106704274
Bond Position:  [-22.47426141]


portfolio before change:  [-23.45960124]
curr_Stock_Price:  101.36854819840045
curr_Factors:  [101.3685482]
mat_Sqrt:  [[0.15]]
grads:  [0.07917095]
Stock Position:  0.07917094907262111
Bond Position:  [-31.48504541]


portfolio before change:  [-23.47168366]
curr_Stock_Price:  101.24079249152258
curr_Factors:  [101.24079249]
mat_Sqrt:  [[0.15]]
grads:  [-0.1102578]
Stock Position:  -0.11025780145173944
Bond Position:  [-12.30909646]


portfolio before change:  [-23.46369007]
curr_Stock_Price:  101.161315701106
curr_Factors:  [101.1613157]
mat_Sqrt:  [[0.15]]
grads:  [0.01393268]
Stock Position:  0.013932675159552734
Bond Position:  [-24.87313782]


portfolio before change:  [-23.46535099]
curr_Stock_Price:  101.1536856205163
curr_Factors:  [101.15368562]
mat_Sqrt:  [[0.15]]
grads:  [0.01069031]
Stock Position:  0.010690306717075309
Bond Position:  [-24.54671492]


portfolio before change:  [-23.46405614]
curr_Stock_Price:  101.41832489903268
curr_Factors:  [101.4183249]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333125]
Stock Position:  -0.023331252097377957
Bond Position:  [-21.09783963]


portfolio before change:  [-23.46377398]
curr_Stock_Price:  101.34971252215304
curr_Factors:  [101.34971252]
mat_Sqrt:  [[0.15]]
grads:  [-0.02352443]
Stock Position:  -0.023524431493167547
Bond Position:  [-21.07957961]


portfolio before change:  [-23.47119916]
curr_Stock_Price:  101.60934330286406
curr_Factors:  [101.6093433]
mat_Sqrt:  [[0.15]]
grads:  [0.06896647]
Stock Position:  0.06896647287650993
Bond Position:  [-30.47883718]


portfolio before change:  [-23.48500014]
curr_Stock_Price:  101.43685378263902
curr_Factors:  [101.43685378]
mat_Sqrt:  [[0.15]]
grads:  [-0.02952119]
Stock Position:  -0.02952119073332651
Bond Position:  [-20.49046343]


portfolio before change:  [-23.51173852]
curr_Stock_Price:  102.29920672138496
curr_Factors:  [102.29920672]
mat_Sqrt:  [[0.15]]
grads:  [0.04025116]
Stock Position:  0.040251155784569684
Bond Position:  [-27.62939983]


portfolio before change:  [-23.52347897]
curr_Stock_Price:  102.0504297253722
curr_Factors:  [102.05042973]
mat_Sqrt:  [[0.15]]
grads:  [-0.02639714]
Stock Position:  -0.026397138678536446
Bond Position:  [-20.82963963]


portfolio before change:  [-23.51697546]
curr_Stock_Price:  101.75473821270101
curr_Factors:  [101.75473821]
mat_Sqrt:  [[0.15]]
grads:  [-0.01307676]
Stock Position:  -0.013076760076985525
Bond Position:  [-22.18635316]


portfolio before change:  [-23.5196513]
curr_Stock_Price:  101.85332139329171
curr_Factors:  [101.85332139]
mat_Sqrt:  [[0.15]]
grads:  [0.05584765]
Stock Position:  0.0558476481181769
Bond Position:  [-29.20791975]


portfolio before change:  [-23.49467728]
curr_Stock_Price:  102.33319069238675
curr_Factors:  [102.33319069]
mat_Sqrt:  [[0.15]]
grads:  [-0.1118205]
Stock Position:  -0.11182049626698189
Bond Position:  [-12.05172911]


portfolio before change:  [-23.6087286]
curr_Stock_Price:  103.34640444261409
curr_Factors:  [103.34640444]
mat_Sqrt:  [[0.15]]
grads:  [0.01243372]
Stock Position:  0.012433716944962928
Bond Position:  [-24.89370854]


portfolio before change:  [-23.60150682]
curr_Stock_Price:  104.05236210760182
curr_Factors:  [104.05236211]
mat_Sqrt:  [[0.15]]
grads:  [0.11086433]
Stock Position:  0.11086432761587382
Bond Position:  [-35.13720199]


portfolio before change:  [-23.4960673]
curr_Stock_Price:  105.02323947594085
curr_Factors:  [105.02323948]
mat_Sqrt:  [[0.15]]
grads:  [0.11173596]
Stock Position:  0.11173595564402108
Bond Position:  [-35.23093933]


portfolio before change:  [-23.50845304]
curr_Stock_Price:  104.93209843126158
curr_Factors:  [104.93209843]
mat_Sqrt:  [[0.15]]
grads:  [0.02919465]
Stock Position:  0.029194646158405883
Bond Position:  [-26.57190852]


portfolio before change:  [-23.48655432]
curr_Stock_Price:  105.73907892588241
curr_Factors:  [105.73907893]
mat_Sqrt:  [[0.15]]
grads:  [0.09815265]
Stock Position:  0.09815264907560446
Bond Position:  [-33.86512503]


portfolio before change:  [-23.45939345]
curr_Stock_Price:  106.03736440527531
curr_Factors:  [106.03736441]
mat_Sqrt:  [[0.15]]
grads:  [0.05283196]
Stock Position:  0.0528319594776588
Bond Position:  [-29.06155519]


portfolio before change:  [-23.48752703]
curr_Stock_Price:  105.53923458227602
curr_Factors:  [105.53923458]
mat_Sqrt:  [[0.15]]
grads:  [0.07433443]
Stock Position:  0.07433443417453847
Bond Position:  [-31.33272631]


portfolio before change:  [-23.44757543]
curr_Stock_Price:  106.10303727350207
curr_Factors:  [106.10303727]
mat_Sqrt:  [[0.15]]
grads:  [0.03305134]
Stock Position:  0.03305133748173618
Bond Position:  [-26.95442272]


portfolio before change:  [-23.4534852]
curr_Stock_Price:  105.97520372054983
curr_Factors:  [105.97520372]
mat_Sqrt:  [[0.15]]
grads:  [-0.09957645]
Stock Position:  -0.09957644821347471
Bond Position:  [-12.90085082]


portfolio before change:  [-23.50349424]
curr_Stock_Price:  106.4693236373906
curr_Factors:  [106.46932364]
mat_Sqrt:  [[0.15]]
grads:  [-0.20929545]
Stock Position:  -0.20929545313061326
Bond Position:  [-1.2199489]


portfolio before change:  [-23.60482926]
curr_Stock_Price:  106.9531314489664
curr_Factors:  [106.95313145]
mat_Sqrt:  [[0.15]]
grads:  [0.00420132]
Stock Position:  0.00420131823768902
Bond Position:  [-24.0541734]


portfolio before change:  [-23.60792397]
curr_Stock_Price:  106.57437433913509
curr_Factors:  [106.57437434]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247719]
Stock Position:  -0.03247718960879301
Bond Position:  [-20.14668781]


portfolio before change:  [-23.63766952]
curr_Stock_Price:  107.45149260403225
curr_Factors:  [107.4514926]
mat_Sqrt:  [[0.15]]
grads:  [-0.17583554]
Stock Position:  -0.17583554482702357
Bond Position:  [-4.74387777]


portfolio before change:  [-23.65828105]
curr_Stock_Price:  107.5670268842997
curr_Factors:  [107.56702688]
mat_Sqrt:  [[0.15]]
grads:  [-0.0378905]
Stock Position:  -0.037890498604440916
Bond Position:  [-19.58251277]


portfolio before change:  [-23.62361368]
curr_Stock_Price:  106.61978891981167
curr_Factors:  [106.61978892]
mat_Sqrt:  [[0.15]]
grads:  [0.11016435]
Stock Position:  0.1101643506832607
Bond Position:  [-35.3693135]


portfolio before change:  [-23.6712549]
curr_Stock_Price:  106.20739985169801
curr_Factors:  [106.20739985]
mat_Sqrt:  [[0.15]]
grads:  [0.17513193]
Stock Position:  0.17513192534735073
Bond Position:  [-42.27156133]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.61951977]
Stock Price:  106.51789257549699
PL:  [-30.13741235]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.01778301e-03]
 [ 4.30651968e-02]
 [ 2.08756545e-02]
 [-2.22695704e-02]
 [ 3.84978743e-03]
 [-1.87345657e-03]
 [-8.77679194e-03]
 [-2.40299456e-02]
 [-1.29051166e-02]
 [-1.20547010e-02]
 [ 1.26525033e-02]
 [-7.92302187e-03]
 [ 4.42996303e-04]
 [ 6.57481729e-03]
 [-2.15507698e-03]
 [ 1.28804872e-02]
 [ 3.45094052e-02]
 [-1.46968080e-02]
 [ 1.92869603e-02]
 [ 2.13060945e-03]
 [-4.16621925e-03]
 [ 4.43254071e-03]
 [ 1.54521689e-02]
 [ 1.71985235e-02]
 [-2.77690421e-03]
 [ 6.98475110e-03]
 [-6.91957290e-03]
 [ 8.51409778e-03]
 [ 2.58482803e-02]
 [-6.58529801e-03]
 [-1.78075113e-03]
 [ 1.34627291e-02]
 [ 1.28835878e-02]
 [ 7.42886324e-03]
 [ 5.52677327e-03]
 [ 1.25308300e-02]
 [-1.71225720e-02]
 [ 2.57496678e-03]
 [-5.69587372e-02]
 [ 1.37955929e-02]
 [ 5.43106446e-03]
 [ 5.37215626e-03]
 [-3.46803669e-03]
 [-4.63052226e-03]
 [ 1.97588871e-02]
 [ 1.45386534e-02]
 [ 1.08144143e-02]
 [ 2.95304613e-03]
 [ 1.42786783e-02]
 [-1.19398910e-03]
 [ 1.59530844e-02]
 [-1.31993782e-02]
 [ 1.74210620e-03]
 [ 1.38235726e-03]
 [-3.71529364e-03]
 [-3.57380948e-03]
 [ 1.00448984e-02]
 [-4.23973147e-03]
 [ 6.80683695e-03]
 [-3.99829012e-03]
 [-5.49106242e-04]
 [ 7.03610606e-03]
 [-8.71576510e-03]
 [ 7.12202382e-03]
 [ 2.54899711e-02]
 [ 5.44629460e-03]
 [ 1.33946954e-02]
 [ 6.11701972e-03]
 [ 4.53322045e-03]
 [ 1.48946093e-02]
 [ 9.63638805e-04]
 [-1.52387055e-02]
 [-2.06776237e-02]
 [ 7.03469881e-04]
 [-3.43955554e-03]
 [-2.46570106e-02]
 [-4.54002383e-03]
 [ 1.15763859e-02]
 [-4.70795782e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.84528113]
curr_Stock_Price:  100.30954012077613
curr_Factors:  [100.30954012]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011855]
Stock Position:  -0.020118553414621616
Bond Position:  [10.86336397]


portfolio before change:  [8.83008685]
curr_Stock_Price:  101.09852639952636
curr_Factors:  [101.0985264]
mat_Sqrt:  [[0.15]]
grads:  [0.28710131]
Stock Position:  0.2871013120749274
Bond Position:  [-20.19543273]


portfolio before change:  [8.75275542]
curr_Stock_Price:  100.83357051291159
curr_Factors:  [100.83357051]
mat_Sqrt:  [[0.15]]
grads:  [0.13917103]
Stock Position:  0.13917102970779982
Bond Position:  [-5.28035642]


portfolio before change:  [8.77083098]
curr_Stock_Price:  100.96582216810246
curr_Factors:  [100.96582217]
mat_Sqrt:  [[0.15]]
grads:  [-0.1484638]
Stock Position:  -0.14846380238915713
Bond Position:  [23.76060085]


portfolio before change:  [8.84902334]
curr_Stock_Price:  100.44914893179188
curr_Factors:  [100.44914893]
mat_Sqrt:  [[0.15]]
grads:  [0.02566525]
Stock Position:  0.025665249517765797
Bond Position:  [6.27097087]


portfolio before change:  [8.85298101]
curr_Stock_Price:  100.58808070664428
curr_Factors:  [100.58808071]
mat_Sqrt:  [[0.15]]
grads:  [-0.01248971]
Stock Position:  -0.01248971049002275
Bond Position:  [10.10929701]


portfolio before change:  [8.8510449]
curr_Stock_Price:  100.79368614012087
curr_Factors:  [100.79368614]
mat_Sqrt:  [[0.15]]
grads:  [-0.05851195]
Stock Position:  -0.05851194629139631
Bond Position:  [14.74867965]


portfolio before change:  [8.85517249]
curr_Stock_Price:  100.73889788391735
curr_Factors:  [100.73889788]
mat_Sqrt:  [[0.15]]
grads:  [-0.16019964]
Stock Position:  -0.16019963737661355
Bond Position:  [24.9935074]


portfolio before change:  [9.06475207]
curr_Stock_Price:  99.44040909330229
curr_Factors:  [99.44040909]
mat_Sqrt:  [[0.15]]
grads:  [-0.08603411]
Stock Position:  -0.08603411046794142
Bond Position:  [17.62001921]


portfolio before change:  [9.09650989]
curr_Stock_Price:  99.08407905962311
curr_Factors:  [99.08407906]
mat_Sqrt:  [[0.15]]
grads:  [-0.08036467]
Stock Position:  -0.08036467336415741
Bond Position:  [17.05936954]


portfolio before change:  [9.10221424]
curr_Stock_Price:  99.02636580126749
curr_Factors:  [99.0263658]
mat_Sqrt:  [[0.15]]
grads:  [0.08435002]
Stock Position:  0.08435002232526913
Bond Position:  [0.74933808]


portfolio before change:  [9.09953851]
curr_Stock_Price:  98.99408872700353
curr_Factors:  [98.99408873]
mat_Sqrt:  [[0.15]]
grads:  [-0.05282015]
Stock Position:  -0.05282014582574021
Bond Position:  [14.32842071]


portfolio before change:  [9.11678069]
curr_Stock_Price:  98.68461155351523
curr_Factors:  [98.68461155]
mat_Sqrt:  [[0.15]]
grads:  [0.00295331]
Stock Position:  0.002953308686930098
Bond Position:  [8.82533457]


portfolio before change:  [9.11939249]
curr_Stock_Price:  99.3822000715091
curr_Factors:  [99.38220007]
mat_Sqrt:  [[0.15]]
grads:  [0.04383212]
Stock Position:  0.043832115256182275
Bond Position:  [4.76326044]


portfolio before change:  [9.1046002]
curr_Stock_Price:  99.03793199427024
curr_Factors:  [99.03793199]
mat_Sqrt:  [[0.15]]
grads:  [-0.01436718]
Stock Position:  -0.014367179878859784
Bond Position:  [10.52749598]


portfolio before change:  [9.09280271]
curr_Stock_Price:  99.90487168992108
curr_Factors:  [99.90487169]
mat_Sqrt:  [[0.15]]
grads:  [0.08586991]
Stock Position:  0.08586991474582965
Bond Position:  [0.5139799]


portfolio before change:  [9.10223873]
curr_Stock_Price:  100.01438498924325
curr_Factors:  [100.01438499]
mat_Sqrt:  [[0.15]]
grads:  [0.2300627]
Stock Position:  0.2300627011982053
Bond Position:  [-13.90734084]


portfolio before change:  [9.21138455]
curr_Stock_Price:  100.49258094822544
curr_Factors:  [100.49258095]
mat_Sqrt:  [[0.15]]
grads:  [-0.09797872]
Stock Position:  -0.09797871980820531
Bond Position:  [19.05751898]


portfolio before change:  [9.22336462]
curr_Stock_Price:  100.38246588913945
curr_Factors:  [100.38246589]
mat_Sqrt:  [[0.15]]
grads:  [0.12857974]
Stock Position:  0.12857973503550202
Bond Position:  [-3.68378625]


portfolio before change:  [9.26027518]
curr_Stock_Price:  100.67132019164319
curr_Factors:  [100.67132019]
mat_Sqrt:  [[0.15]]
grads:  [0.01420406]
Stock Position:  0.014204062994894243
Bond Position:  [7.83033341]


portfolio before change:  [9.25245504]
curr_Stock_Price:  100.08630747569464
curr_Factors:  [100.08630748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0277748]
Stock Position:  -0.02777479502892817
Bond Position:  [12.03233171]


portfolio before change:  [9.26038418]
curr_Stock_Price:  99.82790426361652
curr_Factors:  [99.82790426]
mat_Sqrt:  [[0.15]]
grads:  [0.02955027]
Stock Position:  0.029550271406955625
Bond Position:  [6.31044251]


portfolio before change:  [9.26694444]
curr_Stock_Price:  100.03656051461616
curr_Factors:  [100.03656051]
mat_Sqrt:  [[0.15]]
grads:  [0.10301446]
Stock Position:  0.10301445964045797
Bond Position:  [-1.03826779]


portfolio before change:  [9.28673855]
curr_Stock_Price:  100.22933935609836
curr_Factors:  [100.22933936]
mat_Sqrt:  [[0.15]]
grads:  [0.11465682]
Stock Position:  0.11465682330174462
Bond Position:  [-2.2052391]


portfolio before change:  [9.36572738]
curr_Stock_Price:  100.91945664455963
curr_Factors:  [100.91945664]
mat_Sqrt:  [[0.15]]
grads:  [-0.01851269]
Stock Position:  -0.01851269475461904
Bond Position:  [11.23401847]


portfolio before change:  [9.36163713]
curr_Stock_Price:  101.17832737464582
curr_Factors:  [101.17832737]
mat_Sqrt:  [[0.15]]
grads:  [0.04656501]
Stock Position:  0.046565007346081266
Bond Position:  [4.65026758]


portfolio before change:  [9.36990076]
curr_Stock_Price:  101.34954976904461
curr_Factors:  [101.34954977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04613049]
Stock Position:  -0.046130485991447104
Bond Position:  [14.04520474]


portfolio before change:  [9.37878339]
curr_Stock_Price:  101.17602503725962
curr_Factors:  [101.17602504]
mat_Sqrt:  [[0.15]]
grads:  [0.05676065]
Stock Position:  0.05676065188036061
Bond Position:  [3.63596625]


portfolio before change:  [9.43854914]
curr_Stock_Price:  102.22496465949956
curr_Factors:  [102.22496466]
mat_Sqrt:  [[0.15]]
grads:  [0.17232187]
Stock Position:  0.17232186855987291
Bond Position:  [-8.17704778]


portfolio before change:  [9.43607659]
curr_Stock_Price:  102.2135820958935
curr_Factors:  [102.2135821]
mat_Sqrt:  [[0.15]]
grads:  [-0.04390199]
Stock Position:  -0.04390198674255682
Bond Position:  [13.92345592]


portfolio before change:  [9.43478939]
curr_Stock_Price:  102.26272455408177
curr_Factors:  [102.26272455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187167]
Stock Position:  -0.011871674181719756
Bond Position:  [10.64881913]


portfolio before change:  [9.44089366]
curr_Stock_Price:  101.80459988514045
curr_Factors:  [101.80459989]
mat_Sqrt:  [[0.15]]
grads:  [0.08975153]
Stock Position:  0.08975152756857484
Bond Position:  [0.30377531]


portfolio before change:  [9.42713893]
curr_Stock_Price:  101.65113481833188
curr_Factors:  [101.65113482]
mat_Sqrt:  [[0.15]]
grads:  [0.08589059]
Stock Position:  0.08589058523655753
Bond Position:  [0.69626347]


portfolio before change:  [9.42467292]
curr_Stock_Price:  101.62191714958534
curr_Factors:  [101.62191715]
mat_Sqrt:  [[0.15]]
grads:  [0.04952575]
Stock Position:  0.0495257549442744
Bond Position:  [4.39177076]


portfolio before change:  [9.40900976]
curr_Stock_Price:  101.30011176879282
curr_Factors:  [101.30011177]
mat_Sqrt:  [[0.15]]
grads:  [0.03684516]
Stock Position:  0.036845155153515934
Bond Position:  [5.67659143]


portfolio before change:  [9.37773332]
curr_Stock_Price:  100.44162072216675
curr_Factors:  [100.44162072]
mat_Sqrt:  [[0.15]]
grads:  [0.08353887]
Stock Position:  0.08353886676632338
Bond Position:  [0.98695415]


portfolio before change:  [9.34591913]
curr_Stock_Price:  100.06005128093038
curr_Factors:  [100.06005128]
mat_Sqrt:  [[0.15]]
grads:  [-0.11415048]
Stock Position:  -0.11415047991017917
Bond Position:  [20.76782201]


portfolio before change:  [9.30413988]
curr_Stock_Price:  100.43742402128694
curr_Factors:  [100.43742402]
mat_Sqrt:  [[0.15]]
grads:  [0.01716645]
Stock Position:  0.017166445198825594
Bond Position:  [7.57998635]


portfolio before change:  [9.299993]
curr_Stock_Price:  100.16825668787148
curr_Factors:  [100.16825669]
mat_Sqrt:  [[0.15]]
grads:  [-0.37972491]
Stock Position:  -0.37972491485307613
Bond Position:  [47.33637574]


portfolio before change:  [9.04417382]
curr_Stock_Price:  100.84974421968323
curr_Factors:  [100.84974422]
mat_Sqrt:  [[0.15]]
grads:  [0.09197062]
Stock Position:  0.09197061906323986
Bond Position:  [-0.23103959]


portfolio before change:  [9.08117503]
curr_Stock_Price:  101.2522167824327
curr_Factors:  [101.25221678]
mat_Sqrt:  [[0.15]]
grads:  [0.0362071]
Stock Position:  0.036207096420440496
Bond Position:  [5.41512625]


portfolio before change:  [9.06832971]
curr_Stock_Price:  100.88809536801297
curr_Factors:  [100.88809537]
mat_Sqrt:  [[0.15]]
grads:  [0.03581438]
Stock Position:  0.035814375081318975
Bond Position:  [5.45508562]


portfolio before change:  [9.06679597]
curr_Stock_Price:  100.83575057545879
curr_Factors:  [100.83575058]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312024]
Stock Position:  -0.02312024458236526
Bond Position:  [11.39814318]


portfolio before change:  [9.07110823]
curr_Stock_Price:  100.68004879452292
curr_Factors:  [100.68004879]
mat_Sqrt:  [[0.15]]
grads:  [-0.03087015]
Stock Position:  -0.03087014841879655
Bond Position:  [12.17911628]


portfolio before change:  [9.06486564]
curr_Stock_Price:  100.90692867549356
curr_Factors:  [100.90692868]
mat_Sqrt:  [[0.15]]
grads:  [0.13172591]
Stock Position:  0.13172591402761474
Bond Position:  [-4.22719177]


portfolio before change:  [9.03930663]
curr_Stock_Price:  100.71490265740003
curr_Factors:  [100.71490266]
mat_Sqrt:  [[0.15]]
grads:  [0.09692436]
Stock Position:  0.096924356008032
Bond Position:  [-0.72242045]


portfolio before change:  [9.05629425]
curr_Stock_Price:  100.89063534400653
curr_Factors:  [100.89063534]
mat_Sqrt:  [[0.15]]
grads:  [0.0720961]
Stock Position:  0.07209609559328649
Bond Position:  [1.78247336]


portfolio before change:  [9.08684186]
curr_Stock_Price:  101.31279684320293
curr_Factors:  [101.31279684]
mat_Sqrt:  [[0.15]]
grads:  [0.01968697]
Stock Position:  0.01968697422504037
Bond Position:  [7.09229944]


portfolio before change:  [9.09346395]
curr_Stock_Price:  101.62664944503518
curr_Factors:  [101.62664945]
mat_Sqrt:  [[0.15]]
grads:  [0.09519119]
Stock Position:  0.09519118879916916
Bond Position:  [-0.58049763]


portfolio before change:  [9.09112375]
curr_Stock_Price:  101.60244640041856
curr_Factors:  [101.6024464]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795993]
Stock Position:  -0.00795992735520646
Bond Position:  [9.89987184]


portfolio before change:  [9.09007062]
curr_Stock_Price:  101.81248452458605
curr_Factors:  [101.81248452]
mat_Sqrt:  [[0.15]]
grads:  [0.1063539]
Stock Position:  0.10635389569335178
Bond Position:  [-1.73808374]


portfolio before change:  [9.11117757]
curr_Stock_Price:  102.01196552265863
curr_Factors:  [102.01196552]
mat_Sqrt:  [[0.15]]
grads:  [-0.08799585]
Stock Position:  -0.08799585479356385
Bond Position:  [18.08780767]


portfolio before change:  [9.16595236]
curr_Stock_Price:  101.40234284049258
curr_Factors:  [101.40234284]
mat_Sqrt:  [[0.15]]
grads:  [0.01161404]
Stock Position:  0.011614041334540897
Bond Position:  [7.98826136]


portfolio before change:  [9.16385042]
curr_Stock_Price:  101.17837040269174
curr_Factors:  [101.1783704]
mat_Sqrt:  [[0.15]]
grads:  [0.00921572]
Stock Position:  0.009215715037608312
Bond Position:  [8.23141939]


portfolio before change:  [9.16253365]
curr_Stock_Price:  100.97966109733824
curr_Factors:  [100.9796611]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476862]
Stock Position:  -0.0247686242534725
Bond Position:  [11.66366093]


portfolio before change:  [9.15691965]
curr_Stock_Price:  101.23575123668074
curr_Factors:  [101.23575124]
mat_Sqrt:  [[0.15]]
grads:  [-0.0238254]
Stock Position:  -0.023825396506382795
Bond Position:  [11.56890156]


portfolio before change:  [9.15592244]
curr_Stock_Price:  101.30795530779605
curr_Factors:  [101.30795531]
mat_Sqrt:  [[0.15]]
grads:  [0.06696599]
Stock Position:  0.06696598947753875
Bond Position:  [2.37173497]


portfolio before change:  [9.16075942]
curr_Stock_Price:  101.37797208078334
curr_Factors:  [101.37797208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02826488]
Stock Position:  -0.02826487647264104
Bond Position:  [12.02619528]


portfolio before change:  [9.15922517]
curr_Stock_Price:  101.45884681877571
curr_Factors:  [101.45884682]
mat_Sqrt:  [[0.15]]
grads:  [0.04537891]
Stock Position:  0.04537891299915268
Bond Position:  [4.55513298]


portfolio before change:  [9.13441286]
curr_Stock_Price:  100.90579228967333
curr_Factors:  [100.90579229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665527]
Stock Position:  -0.02665526745299714
Bond Position:  [11.82408374]


portfolio before change:  [9.15099463]
curr_Stock_Price:  100.31143512793146
curr_Factors:  [100.31143513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00366071]
Stock Position:  -0.003660708279223032
Bond Position:  [9.51820553]


portfolio before change:  [9.14888927]
curr_Stock_Price:  101.0490721844932
curr_Factors:  [101.04907218]
mat_Sqrt:  [[0.15]]
grads:  [0.04690737]
Stock Position:  0.046907373764720546
Bond Position:  [4.40894267]


portfolio before change:  [9.12916464]
curr_Stock_Price:  100.62269590995429
curr_Factors:  [100.62269591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0581051]
Stock Position:  -0.058105100663019514
Bond Position:  [14.97585652]


portfolio before change:  [9.10338535]
curr_Stock_Price:  101.08247163199168
curr_Factors:  [101.08247163]
mat_Sqrt:  [[0.15]]
grads:  [0.04748016]
Stock Position:  0.047480158771671145
Bond Position:  [4.30397355]


portfolio before change:  [9.12305682]
curr_Stock_Price:  101.49111529103378
curr_Factors:  [101.49111529]
mat_Sqrt:  [[0.15]]
grads:  [0.16993314]
Stock Position:  0.1699331404731616
Bond Position:  [-8.12364713]


portfolio before change:  [9.10575716]
curr_Stock_Price:  101.39230042742629
curr_Factors:  [101.39230043]
mat_Sqrt:  [[0.15]]
grads:  [0.03630863]
Stock Position:  0.03630863069963897
Bond Position:  [5.42434156]


portfolio before change:  [9.12078337]
curr_Stock_Price:  101.79680980855031
curr_Factors:  [101.79680981]
mat_Sqrt:  [[0.15]]
grads:  [0.08929797]
Stock Position:  0.08929796925134445
Bond Position:  [0.03053498]


portfolio before change:  [9.16708395]
curr_Stock_Price:  102.31528378293264
curr_Factors:  [102.31528378]
mat_Sqrt:  [[0.15]]
grads:  [0.04078013]
Stock Position:  0.04078013146053484
Bond Position:  [4.99465323]


portfolio before change:  [9.1769604]
curr_Stock_Price:  102.54981648019516
curr_Factors:  [102.54981648]
mat_Sqrt:  [[0.15]]
grads:  [0.03022147]
Stock Position:  0.030221469678028932
Bond Position:  [6.07775423]


portfolio before change:  [9.18939838]
curr_Stock_Price:  102.94880787467663
curr_Factors:  [102.94880787]
mat_Sqrt:  [[0.15]]
grads:  [0.0992974]
Stock Position:  0.09929739554003056
Bond Position:  [-1.03315012]


portfolio before change:  [9.25282298]
curr_Stock_Price:  103.58819194464854
curr_Factors:  [103.58819194]
mat_Sqrt:  [[0.15]]
grads:  [0.00642426]
Stock Position:  0.006424258699431982
Bond Position:  [8.58734564]


portfolio before change:  [9.2590707]
curr_Stock_Price:  104.47716524535085
curr_Factors:  [104.47716525]
mat_Sqrt:  [[0.15]]
grads:  [-0.10159137]
Stock Position:  -0.10159136986291556
Bond Position:  [19.87304904]


portfolio before change:  [9.17349189]
curr_Stock_Price:  105.33177440008784
curr_Factors:  [105.3317744]
mat_Sqrt:  [[0.15]]
grads:  [-0.13785082]
Stock Position:  -0.13785082464394774
Bond Position:  [23.69356385]


portfolio before change:  [9.06948665]
curr_Stock_Price:  106.09699384736685
curr_Factors:  [106.09699385]
mat_Sqrt:  [[0.15]]
grads:  [0.0046898]
Stock Position:  0.004689799208002091
Bond Position:  [8.57191305]


portfolio before change:  [9.07000696]
curr_Stock_Price:  106.09369973127195
curr_Factors:  [106.09369973]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293037]
Stock Position:  -0.02293037029259677
Bond Position:  [11.50277478]


portfolio before change:  [9.05739461]
curr_Stock_Price:  106.67508138559998
curr_Factors:  [106.67508139]
mat_Sqrt:  [[0.15]]
grads:  [-0.16438007]
Stock Position:  -0.16438007062004328
Bond Position:  [26.59265202]


portfolio before change:  [9.24768585]
curr_Stock_Price:  105.52756308038788
curr_Factors:  [105.52756308]
mat_Sqrt:  [[0.15]]
grads:  [-0.03026683]
Stock Position:  -0.030266825565479473
Bond Position:  [12.44167019]


portfolio before change:  [9.28312781]
curr_Stock_Price:  104.38227172507997
curr_Factors:  [104.38227173]
mat_Sqrt:  [[0.15]]
grads:  [0.07717591]
Stock Position:  0.07717590590469048
Bond Position:  [1.22733143]


portfolio before change:  [9.22272092]
curr_Stock_Price:  103.5985608373504
curr_Factors:  [103.59856084]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138639]
Stock Position:  -0.03138638548550176
Bond Position:  [12.47430529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20156766]
Stock Price:  104.29736459886124
PL:  [4.90420307]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.44307440e-03]
 [ 8.99951427e-03]
 [ 1.13068765e-02]
 [-9.67637838e-03]
 [ 1.09748432e-02]
 [-1.48233965e-02]
 [-1.35076365e-02]
 [ 6.39051733e-02]
 [-2.08811424e-02]
 [-1.32074594e-02]
 [ 8.12211465e-03]
 [-7.08280508e-03]
 [ 4.34428469e-03]
 [-6.33578821e-03]
 [ 6.66677627e-03]
 [ 3.11041838e-03]
 [-3.54989586e-02]
 [-1.19137510e-02]
 [ 2.46310136e-02]
 [-4.54552747e-03]
 [-2.25346587e-02]
 [ 6.14347591e-03]
 [ 1.44475287e-02]
 [ 1.17405425e-02]
 [ 1.18036575e-02]
 [ 4.45992024e-03]
 [ 3.96063185e-05]
 [ 2.45420272e-02]
 [-3.20724447e-02]
 [ 1.15853557e-01]
 [-5.59498847e-03]
 [ 3.44425681e-02]
 [ 1.51440531e-02]
 [-1.88564645e-02]
 [-1.98052604e-02]
 [-6.87808921e-02]
 [ 1.81768370e-02]
 [-8.63772127e-03]
 [ 4.94992196e-02]
 [ 9.43032693e-03]
 [ 6.93657408e-03]
 [ 3.57337188e-02]
 [-3.37444759e-03]
 [ 2.57334400e-02]
 [-6.57688193e-02]
 [ 2.62154310e-02]
 [ 8.82745840e-03]
 [ 5.40890452e-03]
 [-1.06581112e-02]
 [-1.93115860e-05]
 [-2.27913892e-03]
 [-2.03028624e-03]
 [-1.02396152e-03]
 [ 3.23084816e-03]
 [-1.65805365e-02]
 [-5.20500154e-03]
 [-2.70438586e-03]
 [ 1.37464404e-02]
 [ 6.28295961e-03]
 [-2.35495665e-03]
 [-5.15337408e-03]
 [-3.56136500e-03]
 [ 3.94746788e-04]
 [-5.10471718e-03]
 [ 1.78943460e-02]
 [ 7.02000998e-03]
 [ 2.03484525e-02]
 [-4.23415164e-03]
 [ 8.12576929e-03]
 [ 2.90003702e-02]
 [ 3.09584244e-03]
 [-1.50612504e-02]
 [-5.98467077e-03]
 [ 3.42822774e-03]
 [ 1.23029307e-02]
 [ 1.55689552e-02]
 [ 3.47026354e-03]
 [-3.11656988e-02]
 [-2.83409896e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.76232719]
curr_Stock_Price:  100.57828022692999
curr_Factors:  [100.57828023]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296205]
Stock Position:  -0.029620495980995174
Bond Position:  [17.74150574]


portfolio before change:  [14.78298944]
curr_Stock_Price:  99.91815057607941
curr_Factors:  [99.91815058]
mat_Sqrt:  [[0.15]]
grads:  [0.05999676]
Stock Position:  0.05999676180206796
Bond Position:  [8.78822396]


portfolio before change:  [14.750986]
curr_Stock_Price:  99.375576053446
curr_Factors:  [99.37557605]
mat_Sqrt:  [[0.15]]
grads:  [0.07537918]
Stock Position:  0.07537917655823355
Bond Position:  [7.26013691]


portfolio before change:  [14.74253699]
curr_Stock_Price:  99.25746934467931
curr_Factors:  [99.25746934]
mat_Sqrt:  [[0.15]]
grads:  [-0.06450919]
Stock Position:  -0.06450918916972909
Bond Position:  [21.14555586]


portfolio before change:  [14.79150764]
curr_Stock_Price:  98.51883014313303
curr_Factors:  [98.51883014]
mat_Sqrt:  [[0.15]]
grads:  [0.07316562]
Stock Position:  0.07316562120175385
Bond Position:  [7.58331624]


portfolio before change:  [14.78845777]
curr_Stock_Price:  98.470667521821
curr_Factors:  [98.47066752]
mat_Sqrt:  [[0.15]]
grads:  [-0.09882264]
Stock Position:  -0.09882264348422576
Bond Position:  [24.51958944]


portfolio before change:  [14.79649663]
curr_Stock_Price:  98.40482900670985
curr_Factors:  [98.40482901]
mat_Sqrt:  [[0.15]]
grads:  [-0.09005091]
Stock Position:  -0.09005090991217615
Bond Position:  [23.65794102]


portfolio before change:  [14.86841767]
curr_Stock_Price:  97.62257845496845
curr_Factors:  [97.62257845]
mat_Sqrt:  [[0.15]]
grads:  [0.42603449]
Stock Position:  0.42603448890756623
Bond Position:  [-26.72216765]


portfolio before change:  [14.96627632]
curr_Stock_Price:  97.85619532092673
curr_Factors:  [97.85619532]
mat_Sqrt:  [[0.15]]
grads:  [-0.13920762]
Stock Position:  -0.1392076157675392
Bond Position:  [28.58860396]


portfolio before change:  [14.95204459]
curr_Stock_Price:  97.97126499032082
curr_Factors:  [97.97126499]
mat_Sqrt:  [[0.15]]
grads:  [-0.08804973]
Stock Position:  -0.08804972928703717
Bond Position:  [23.57838795]


portfolio before change:  [14.95726126]
curr_Stock_Price:  97.92875519424996
curr_Factors:  [97.92875519]
mat_Sqrt:  [[0.15]]
grads:  [0.05414743]
Stock Position:  0.054147431010740196
Bond Position:  [9.65467075]


portfolio before change:  [14.98425838]
curr_Stock_Price:  98.41619628005598
curr_Factors:  [98.41619628]
mat_Sqrt:  [[0.15]]
grads:  [-0.0472187]
Stock Position:  -0.047218700514030924
Bond Position:  [19.63134328]


portfolio before change:  [15.04553553]
curr_Stock_Price:  97.14445111688126
curr_Factors:  [97.14445112]
mat_Sqrt:  [[0.15]]
grads:  [0.0289619]
Stock Position:  0.028961897962302294
Bond Position:  [12.23204785]


portfolio before change:  [15.04553588]
curr_Stock_Price:  97.1180653154876
curr_Factors:  [97.11806532]
mat_Sqrt:  [[0.15]]
grads:  [-0.04223859]
Stock Position:  -0.04223858809047145
Bond Position:  [19.14766583]


portfolio before change:  [15.06337188]
curr_Stock_Price:  96.72413089067665
curr_Factors:  [96.72413089]
mat_Sqrt:  [[0.15]]
grads:  [0.04444518]
Stock Position:  0.04444517511295941
Bond Position:  [10.76445094]


portfolio before change:  [15.10063227]
curr_Stock_Price:  97.54733829499764
curr_Factors:  [97.54733829]
mat_Sqrt:  [[0.15]]
grads:  [0.02073612]
Stock Position:  0.020736122501508598
Bond Position:  [13.07787872]


portfolio before change:  [15.08751577]
curr_Stock_Price:  96.87537597293134
curr_Factors:  [96.87537597]
mat_Sqrt:  [[0.15]]
grads:  [-0.23665972]
Stock Position:  -0.2366597237235428
Bond Position:  [38.01401549]


portfolio before change:  [14.91437713]
curr_Stock_Price:  97.61700870103753
curr_Factors:  [97.6170087]
mat_Sqrt:  [[0.15]]
grads:  [-0.07942501]
Stock Position:  -0.07942500695365748
Bond Position:  [22.66760872]


portfolio before change:  [14.93580137]
curr_Stock_Price:  97.36510475926326
curr_Factors:  [97.36510476]
mat_Sqrt:  [[0.15]]
grads:  [0.16420676]
Stock Position:  0.1642067573270122
Bond Position:  [-1.05220676]


portfolio before change:  [14.7662998]
curr_Stock_Price:  96.33326049893579
curr_Factors:  [96.3332605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03030352]
Stock Position:  -0.030303516458634272
Bond Position:  [17.68553635]


portfolio before change:  [14.76370554]
curr_Stock_Price:  96.45534684759542
curr_Factors:  [96.45534685]
mat_Sqrt:  [[0.15]]
grads:  [-0.15023106]
Stock Position:  -0.15023105773085432
Bond Position:  [29.25429432]


portfolio before change:  [14.86225548]
curr_Stock_Price:  95.81152865824271
curr_Factors:  [95.81152866]
mat_Sqrt:  [[0.15]]
grads:  [0.04095651]
Stock Position:  0.040956506041800456
Bond Position:  [10.93815002]


portfolio before change:  [14.87744969]
curr_Stock_Price:  96.16582065011742
curr_Factors:  [96.16582065]
mat_Sqrt:  [[0.15]]
grads:  [0.09631686]
Stock Position:  0.09631685815733869
Bond Position:  [5.61505999]


portfolio before change:  [14.87381051]
curr_Stock_Price:  96.12439347610146
curr_Factors:  [96.12439348]
mat_Sqrt:  [[0.15]]
grads:  [0.07827028]
Stock Position:  0.07827028301941946
Bond Position:  [7.35012703]


portfolio before change:  [14.86122797]
curr_Stock_Price:  95.95776652712881
curr_Factors:  [95.95776653]
mat_Sqrt:  [[0.15]]
grads:  [0.07869105]
Stock Position:  0.07869104971808259
Bond Position:  [7.31021059]


portfolio before change:  [14.87698758]
curr_Stock_Price:  96.15223216513962
curr_Factors:  [96.15223217]
mat_Sqrt:  [[0.15]]
grads:  [0.0297328]
Stock Position:  0.029732801626217456
Bond Position:  [12.01811233]


portfolio before change:  [14.84897053]
curr_Stock_Price:  95.18467452549474
curr_Factors:  [95.18467453]
mat_Sqrt:  [[0.15]]
grads:  [0.00026404]
Stock Position:  0.00026404212351875217
Bond Position:  [14.82383777]


portfolio before change:  [14.849736]
curr_Stock_Price:  94.57471177379837
curr_Factors:  [94.57471177]
mat_Sqrt:  [[0.15]]
grads:  [0.16361351]
Stock Position:  0.16361351479421185
Bond Position:  [-0.62396501]


portfolio before change:  [14.79624351]
curr_Stock_Price:  94.24800596909532
curr_Factors:  [94.24800597]
mat_Sqrt:  [[0.15]]
grads:  [-0.2138163]
Stock Position:  -0.21381629787880774
Bond Position:  [34.94800323]


portfolio before change:  [14.92567686]
curr_Stock_Price:  93.65287348713173
curr_Factors:  [93.65287349]
mat_Sqrt:  [[0.15]]
grads:  [0.77235705]
Stock Position:  0.7723570472101199
Bond Position:  [-57.40777997]


portfolio before change:  [15.18751277]
curr_Stock_Price:  93.99652803651321
curr_Factors:  [93.99652804]
mat_Sqrt:  [[0.15]]
grads:  [-0.03729992]
Stock Position:  -0.03729992315916314
Bond Position:  [18.69357604]


portfolio before change:  [15.19457652]
curr_Stock_Price:  93.83847509561113
curr_Factors:  [93.8384751]
mat_Sqrt:  [[0.15]]
grads:  [0.22961712]
Stock Position:  0.2296171206606255
Bond Position:  [-6.35234394]


portfolio before change:  [15.06171362]
curr_Stock_Price:  93.26157619794718
curr_Factors:  [93.2615762]
mat_Sqrt:  [[0.15]]
grads:  [0.10096035]
Stock Position:  0.10096035390851409
Bond Position:  [5.64599188]


portfolio before change:  [15.09675051]
curr_Stock_Price:  93.60511700328448
curr_Factors:  [93.605117]
mat_Sqrt:  [[0.15]]
grads:  [-0.12570976]
Stock Position:  -0.12570976329497505
Bond Position:  [26.86382761]


portfolio before change:  [15.00664659]
curr_Stock_Price:  94.33523499452981
curr_Factors:  [94.33523499]
mat_Sqrt:  [[0.15]]
grads:  [-0.13203507]
Stock Position:  -0.13203506913808669
Bond Position:  [27.46220586]


portfolio before change:  [14.98496796]
curr_Stock_Price:  94.51242328256532
curr_Factors:  [94.51242328]
mat_Sqrt:  [[0.15]]
grads:  [-0.45853928]
Stock Position:  -0.4585392807219485
Bond Position:  [58.32262655]


portfolio before change:  [15.15153226]
curr_Stock_Price:  94.15712325860171
curr_Factors:  [94.15712326]
mat_Sqrt:  [[0.15]]
grads:  [0.12117891]
Stock Position:  0.12117891366382648
Bond Position:  [3.74167435]


portfolio before change:  [15.13468308]
curr_Stock_Price:  94.01614954822695
curr_Factors:  [94.01614955]
mat_Sqrt:  [[0.15]]
grads:  [-0.05758481]
Stock Position:  -0.05758480848951808
Bond Position:  [20.54858505]


portfolio before change:  [15.08287437]
curr_Stock_Price:  94.9381467277632
curr_Factors:  [94.93814673]
mat_Sqrt:  [[0.15]]
grads:  [0.3299948]
Stock Position:  0.32999479736862225
Bond Position:  [-16.24622012]


portfolio before change:  [15.27720665]
curr_Stock_Price:  95.53011876691342
curr_Factors:  [95.53011877]
mat_Sqrt:  [[0.15]]
grads:  [0.06286885]
Stock Position:  0.06286884616718519
Bond Position:  [9.27133831]


portfolio before change:  [15.31618327]
curr_Stock_Price:  96.14086874369931
curr_Factors:  [96.14086874]
mat_Sqrt:  [[0.15]]
grads:  [0.04624383]
Stock Position:  0.04624382718461692
Bond Position:  [10.87026155]


portfolio before change:  [15.28146656]
curr_Stock_Price:  95.37544503797562
curr_Factors:  [95.37544504]
mat_Sqrt:  [[0.15]]
grads:  [0.23822479]
Stock Position:  0.2382247923156683
Bond Position:  [-7.43932902]


portfolio before change:  [15.21605445]
curr_Stock_Price:  95.10281541427857
curr_Factors:  [95.10281541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249632]
Stock Position:  -0.022496317299619425
Bond Position:  [17.35551757]


portfolio before change:  [15.22605282]
curr_Stock_Price:  94.70658991012624
curr_Factors:  [94.70658991]
mat_Sqrt:  [[0.15]]
grads:  [0.17155627]
Stock Position:  0.1715562665515005
Bond Position:  [-1.02145616]


portfolio before change:  [15.22730971]
curr_Stock_Price:  94.7142884400103
curr_Factors:  [94.71428844]
mat_Sqrt:  [[0.15]]
grads:  [-0.4384588]
Stock Position:  -0.4384587951830161
Bond Position:  [56.75562251]


portfolio before change:  [15.49410587]
curr_Stock_Price:  94.11389262109451
curr_Factors:  [94.11389262]
mat_Sqrt:  [[0.15]]
grads:  [0.17476954]
Stock Position:  0.1747695401908855
Bond Position:  [-0.95413586]


portfolio before change:  [15.58023016]
curr_Stock_Price:  94.60702156945524
curr_Factors:  [94.60702157]
mat_Sqrt:  [[0.15]]
grads:  [0.05884972]
Stock Position:  0.05884972267228722
Bond Position:  [10.01263318]


portfolio before change:  [15.58433073]
curr_Stock_Price:  94.66606628125473
curr_Factors:  [94.66606628]
mat_Sqrt:  [[0.15]]
grads:  [0.03605936]
Stock Position:  0.036059363488190346
Bond Position:  [12.17073264]


portfolio before change:  [15.60072805]
curr_Stock_Price:  95.09970193157054
curr_Factors:  [95.09970193]
mat_Sqrt:  [[0.15]]
grads:  [-0.07105407]
Stock Position:  -0.0710540746332979
Bond Position:  [22.35794937]


portfolio before change:  [15.55487095]
curr_Stock_Price:  95.76475199318566
curr_Factors:  [95.76475199]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012874]
Stock Position:  -0.00012874390669658113
Bond Position:  [15.56720008]


portfolio before change:  [15.55587294]
curr_Stock_Price:  95.53942186898095
curr_Factors:  [95.53942187]
mat_Sqrt:  [[0.15]]
grads:  [-0.01519426]
Stock Position:  -0.015194259461024397
Bond Position:  [17.00752371]


portfolio before change:  [15.55043246]
curr_Stock_Price:  95.96744443497782
curr_Factors:  [95.96744443]
mat_Sqrt:  [[0.15]]
grads:  [-0.01353524]
Stock Position:  -0.013535241580412243
Bond Position:  [16.849375]


portfolio before change:  [15.5695045]
curr_Stock_Price:  94.63618509127124
curr_Factors:  [94.63618509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682641]
Stock Position:  -0.006826410122198636
Bond Position:  [16.21552991]


portfolio before change:  [15.57367752]
curr_Stock_Price:  94.17334636247762
curr_Factors:  [94.17334636]
mat_Sqrt:  [[0.15]]
grads:  [0.02153899]
Stock Position:  0.021538987736620375
Bond Position:  [13.54527897]


portfolio before change:  [15.58428279]
curr_Stock_Price:  94.62641575733157
curr_Factors:  [94.62641576]
mat_Sqrt:  [[0.15]]
grads:  [-0.11053691]
Stock Position:  -0.11053690999852595
Bond Position:  [26.04399439]


portfolio before change:  [15.51481864]
curr_Stock_Price:  95.26956697865094
curr_Factors:  [95.26956698]
mat_Sqrt:  [[0.15]]
grads:  [-0.03470001]
Stock Position:  -0.03470001026284473
Bond Position:  [18.82067359]


portfolio before change:  [15.51316288]
curr_Stock_Price:  95.35118327626434
curr_Factors:  [95.35118328]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802924]
Stock Position:  -0.01802923906482188
Bond Position:  [17.23227216]


portfolio before change:  [15.52363226]
curr_Stock_Price:  94.8302333580257
curr_Factors:  [94.83023336]
mat_Sqrt:  [[0.15]]
grads:  [0.09164294]
Stock Position:  0.09164293577654478
Bond Position:  [6.83311128]


portfolio before change:  [15.4916927]
curr_Stock_Price:  94.47705120090747
curr_Factors:  [94.4770512]
mat_Sqrt:  [[0.15]]
grads:  [0.0418864]
Stock Position:  0.04188639742154134
Bond Position:  [11.53438938]


portfolio before change:  [15.4956721]
curr_Stock_Price:  94.55484448063885
curr_Factors:  [94.55484448]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569971]
Stock Position:  -0.015699711026649334
Bond Position:  [16.98015583]


portfolio before change:  [15.50625613]
curr_Stock_Price:  93.9482895816386
curr_Factors:  [93.94828958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03435583]
Stock Position:  -0.0343558271821938
Bond Position:  [18.73392733]


portfolio before change:  [15.49857695]
curr_Stock_Price:  94.20589012667895
curr_Factors:  [94.20589013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02374243]
Stock Position:  -0.023742433343760527
Bond Position:  [17.73525402]


portfolio before change:  [15.49465205]
curr_Stock_Price:  94.41789002964788
curr_Factors:  [94.41789003]
mat_Sqrt:  [[0.15]]
grads:  [0.00263165]
Stock Position:  0.0026316452514739525
Bond Position:  [15.24617766]


portfolio before change:  [15.49686046]
curr_Stock_Price:  94.89496635505017
curr_Factors:  [94.89496636]
mat_Sqrt:  [[0.15]]
grads:  [-0.03403145]
Stock Position:  -0.03403144787102247
Bond Position:  [18.72627356]


portfolio before change:  [15.49952158]
curr_Stock_Price:  94.85116310313599
curr_Factors:  [94.8511631]
mat_Sqrt:  [[0.15]]
grads:  [0.11929564]
Stock Position:  0.1192956398516149
Bond Position:  [4.18419138]


portfolio before change:  [15.50531741]
curr_Stock_Price:  94.89755465100163
curr_Factors:  [94.89755465]
mat_Sqrt:  [[0.15]]
grads:  [0.04680007]
Stock Position:  0.04680006650638611
Bond Position:  [11.06410554]


portfolio before change:  [15.5010777]
curr_Stock_Price:  94.79218658419991
curr_Factors:  [94.79218658]
mat_Sqrt:  [[0.15]]
grads:  [0.13565635]
Stock Position:  0.13565634968079957
Bond Position:  [2.64191569]


portfolio before change:  [15.49626554]
curr_Stock_Price:  94.75549619146842
curr_Factors:  [94.75549619]
mat_Sqrt:  [[0.15]]
grads:  [-0.02822768]
Stock Position:  -0.028227677582147507
Bond Position:  [18.17099314]


portfolio before change:  [15.50783336]
curr_Stock_Price:  94.38592633507628
curr_Factors:  [94.38592634]
mat_Sqrt:  [[0.15]]
grads:  [0.0541718]
Stock Position:  0.054171795291001607
Bond Position:  [10.39477828]


portfolio before change:  [15.49078616]
curr_Stock_Price:  94.05924534801565
curr_Factors:  [94.05924535]
mat_Sqrt:  [[0.15]]
grads:  [0.1933358]
Stock Position:  0.19333580109497128
Bond Position:  [-2.69423339]


portfolio before change:  [15.47599527]
curr_Stock_Price:  93.98361270939114
curr_Factors:  [93.98361271]
mat_Sqrt:  [[0.15]]
grads:  [0.02063895]
Stock Position:  0.020638949620984386
Bond Position:  [13.53627222]


portfolio before change:  [15.46715717]
curr_Stock_Price:  93.51439574319393
curr_Factors:  [93.51439574]
mat_Sqrt:  [[0.15]]
grads:  [-0.10040834]
Stock Position:  -0.10040833597855055
Bond Position:  [24.85678204]


portfolio before change:  [15.52201547]
curr_Stock_Price:  92.98351648254496
curr_Factors:  [92.98351648]
mat_Sqrt:  [[0.15]]
grads:  [-0.03989781]
Stock Position:  -0.039897805114063184
Bond Position:  [19.23185369]


portfolio before change:  [15.52072516]
curr_Stock_Price:  93.04598464730113
curr_Factors:  [93.04598465]
mat_Sqrt:  [[0.15]]
grads:  [0.02285485]
Stock Position:  0.022854851629576456
Bond Position:  [13.39417298]


portfolio before change:  [15.52745737]
curr_Stock_Price:  93.30391896225545
curr_Factors:  [93.30391896]
mat_Sqrt:  [[0.15]]
grads:  [0.08201954]
Stock Position:  0.08201953788057623
Bond Position:  [7.87471305]


portfolio before change:  [15.54059531]
curr_Stock_Price:  93.458098725882
curr_Factors:  [93.45809873]
mat_Sqrt:  [[0.15]]
grads:  [0.10379303]
Stock Position:  0.10379303481270254
Bond Position:  [5.84029561]


portfolio before change:  [15.56784231]
curr_Stock_Price:  93.7170946385566
curr_Factors:  [93.71709464]
mat_Sqrt:  [[0.15]]
grads:  [0.02313509]
Stock Position:  0.023135090253311234
Bond Position:  [13.39968886]


portfolio before change:  [15.56185858]
curr_Stock_Price:  93.42225080454708
curr_Factors:  [93.4222508]
mat_Sqrt:  [[0.15]]
grads:  [-0.20777133]
Stock Position:  -0.2077713253045599
Bond Position:  [34.97232344]


portfolio before change:  [15.5771667]
curr_Stock_Price:  93.3590934678993
curr_Factors:  [93.35909347]
mat_Sqrt:  [[0.15]]
grads:  [-0.18893993]
Stock Position:  -0.18893993081587523
Bond Position:  [33.21642736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.5694885]
Stock Price:  93.41071987020837
PL:  [15.5694885]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.32539937e-03]
 [ 4.76841457e-02]
 [ 2.13825140e-02]
 [-8.78891623e-03]
 [ 3.87687608e-03]
 [-1.29255052e-03]
 [-6.06418810e-03]
 [-1.02002305e-02]
 [ 2.67552547e-03]
 [ 1.19362332e-03]
 [-2.27357730e-03]
 [ 8.02966596e-03]
 [-2.46836017e-03]
 [ 7.60991662e-03]
 [-1.16688239e-03]
 [ 1.60665251e-02]
 [ 4.93923481e-02]
 [-1.36548853e-02]
 [ 1.96012903e-02]
 [ 2.65487702e-03]
 [-4.17841763e-03]
 [ 5.06480509e-03]
 [ 1.83742901e-02]
 [ 1.87998264e-02]
 [-4.40037675e-03]
 [ 4.46062698e-03]
 [ 1.09516721e-02]
 [ 8.18549092e-03]
 [ 1.58888726e-02]
 [ 2.87872199e-03]
 [-6.44353134e-03]
 [ 1.00470891e-02]
 [ 1.15235751e-02]
 [-1.69565900e-02]
 [ 7.93344075e-03]
 [ 1.90463283e-02]
 [-2.63600437e-02]
 [ 3.20157128e-03]
 [-5.33520071e-02]
 [ 1.00014420e-02]
 [ 6.95306038e-03]
 [-2.24049562e-03]
 [-1.95087683e-03]
 [-1.09477812e-03]
 [ 1.81752775e-02]
 [ 1.51671470e-02]
 [ 1.07721577e-02]
 [ 4.18902540e-03]
 [ 2.15374299e-03]
 [-1.95156670e-03]
 [-2.36900942e-03]
 [-6.57128103e-03]
 [ 2.12845837e-03]
 [ 1.37570432e-03]
 [-4.11240121e-03]
 [-4.36271558e-03]
 [ 4.13439800e-03]
 [ 7.10234692e-03]
 [ 7.30625962e-03]
 [-4.03026652e-03]
 [-4.21116046e-04]
 [ 4.82773698e-03]
 [-7.43706671e-03]
 [ 7.18976281e-03]
 [ 1.98088811e-02]
 [ 4.76427481e-03]
 [ 8.14822705e-03]
 [-3.60135640e-04]
 [ 2.86056963e-03]
 [ 2.11329030e-02]
 [ 9.42556827e-04]
 [-1.59914397e-02]
 [-3.87061439e-03]
 [ 1.27648570e-03]
 [ 2.37088543e-03]
 [-1.54357409e-04]
 [-1.47831459e-03]
 [-2.09711634e-03]
 [-2.31157210e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.70844843]
curr_Stock_Price:  101.07543062172076
curr_Factors:  [101.07543062]
mat_Sqrt:  [[0.15]]
grads:  [-0.048836]
Stock Position:  -0.04883599578997916
Bond Position:  [30.64456773]


portfolio before change:  [25.70227916]
curr_Stock_Price:  101.24097683209924
curr_Factors:  [101.24097683]
mat_Sqrt:  [[0.15]]
grads:  [0.3178943]
Stock Position:  0.3178943047517135
Bond Position:  [-6.48165079]


portfolio before change:  [25.5356563]
curr_Stock_Price:  100.71810575098445
curr_Factors:  [100.71810575]
mat_Sqrt:  [[0.15]]
grads:  [0.14255009]
Stock Position:  0.14255009301520272
Bond Position:  [11.17828096]


portfolio before change:  [25.48316339]
curr_Stock_Price:  100.34496269440896
curr_Factors:  [100.34496269]
mat_Sqrt:  [[0.15]]
grads:  [-0.05859277]
Stock Position:  -0.05859277486003912
Bond Position:  [31.3626532]


portfolio before change:  [25.47905372]
curr_Stock_Price:  100.44855735647013
curr_Factors:  [100.44855736]
mat_Sqrt:  [[0.15]]
grads:  [0.02584584]
Stock Position:  0.025845840515431193
Bond Position:  [22.88287632]


portfolio before change:  [25.51444804]
curr_Stock_Price:  101.76266053731791
curr_Factors:  [101.76266054]
mat_Sqrt:  [[0.15]]
grads:  [-0.008617]
Stock Position:  -0.008617003442245376
Bond Position:  [26.39133724]


portfolio before change:  [25.52041434]
curr_Stock_Price:  101.26169865152137
curr_Factors:  [101.26169865]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042792]
Stock Position:  -0.04042792068467115
Bond Position:  [29.61421427]


portfolio before change:  [25.56404247]
curr_Stock_Price:  100.22832420253259
curr_Factors:  [100.2283242]
mat_Sqrt:  [[0.15]]
grads:  [-0.06800154]
Stock Position:  -0.06800153666520119
Bond Position:  [32.37972253]


portfolio before change:  [25.54999264]
curr_Stock_Price:  100.46469575481268
curr_Factors:  [100.46469575]
mat_Sqrt:  [[0.15]]
grads:  [0.01783684]
Stock Position:  0.017836836441046507
Bond Position:  [23.75802029]


portfolio before change:  [25.55057516]
curr_Stock_Price:  100.4141035366957
curr_Factors:  [100.41410354]
mat_Sqrt:  [[0.15]]
grads:  [0.00795749]
Stock Position:  0.007957488790332989
Bond Position:  [24.75153105]


portfolio before change:  [25.55589048]
curr_Stock_Price:  100.88765772170004
curr_Factors:  [100.88765772]
mat_Sqrt:  [[0.15]]
grads:  [-0.01515718]
Stock Position:  -0.01515718200606364
Bond Position:  [27.08506307]


portfolio before change:  [25.5543225]
curr_Stock_Price:  101.10279309693799
curr_Factors:  [101.1027931]
mat_Sqrt:  [[0.15]]
grads:  [0.05353111]
Stock Position:  0.05353110636726521
Bond Position:  [20.14217813]


portfolio before change:  [25.51457441]
curr_Stock_Price:  100.33675218164537
curr_Factors:  [100.33675218]
mat_Sqrt:  [[0.15]]
grads:  [-0.01645573]
Stock Position:  -0.016455734484330267
Bond Position:  [27.16568936]


portfolio before change:  [25.5129495]
curr_Stock_Price:  100.53867650588286
curr_Factors:  [100.53867651]
mat_Sqrt:  [[0.15]]
grads:  [0.05073278]
Stock Position:  0.050732777434409536
Bond Position:  [20.4123432]


portfolio before change:  [25.5359856]
curr_Stock_Price:  100.96759614129
curr_Factors:  [100.96759614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00777922]
Stock Position:  -0.007779215933682547
Bond Position:  [26.32143433]


portfolio before change:  [25.53651211]
curr_Stock_Price:  101.11139365988971
curr_Factors:  [101.11139366]
mat_Sqrt:  [[0.15]]
grads:  [0.10711017]
Stock Position:  0.10711016705757309
Bond Position:  [14.70645384]


portfolio before change:  [25.50085503]
curr_Stock_Price:  100.76991107204972
curr_Factors:  [100.76991107]
mat_Sqrt:  [[0.15]]
grads:  [0.32928232]
Stock Position:  0.3292823209723163
Bond Position:  [-7.68089517]


portfolio before change:  [25.74177943]
curr_Stock_Price:  101.50303415024834
curr_Factors:  [101.50303415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09103257]
Stock Position:  -0.09103256854279224
Bond Position:  [34.98186134]


portfolio before change:  [25.85851016]
curr_Stock_Price:  100.24475593358781
curr_Factors:  [100.24475593]
mat_Sqrt:  [[0.15]]
grads:  [0.13067527]
Stock Position:  0.13067526868203583
Bond Position:  [12.75899975]


portfolio before change:  [25.84845915]
curr_Stock_Price:  100.16173738935773
curr_Factors:  [100.16173739]
mat_Sqrt:  [[0.15]]
grads:  [0.01769918]
Stock Position:  0.01769918012783929
Bond Position:  [24.07567852]


portfolio before change:  [25.83398753]
curr_Stock_Price:  99.25907405458445
curr_Factors:  [99.25907405]
mat_Sqrt:  [[0.15]]
grads:  [-0.02785612]
Stock Position:  -0.027856117556899273
Bond Position:  [28.59895997]


portfolio before change:  [25.83615837]
curr_Stock_Price:  99.24531235702743
curr_Factors:  [99.24531236]
mat_Sqrt:  [[0.15]]
grads:  [0.03376537]
Stock Position:  0.03376536729451393
Bond Position:  [22.48510395]


portfolio before change:  [25.84276424]
curr_Stock_Price:  99.39933120647638
curr_Factors:  [99.39933121]
mat_Sqrt:  [[0.15]]
grads:  [0.12249527]
Stock Position:  0.12249526710427575
Bond Position:  [13.66681661]


portfolio before change:  [25.74674705]
curr_Stock_Price:  98.60851383863213
curr_Factors:  [98.60851384]
mat_Sqrt:  [[0.15]]
grads:  [0.12533218]
Stock Position:  0.1253321760553348
Bond Position:  [13.38792744]


portfolio before change:  [25.72452379]
curr_Stock_Price:  98.42452247831065
curr_Factors:  [98.42452248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02933584]
Stock Position:  -0.029335844989871598
Bond Position:  [28.61189032]


portfolio before change:  [25.73670706]
curr_Stock_Price:  98.07017855363428
curr_Factors:  [98.07017855]
mat_Sqrt:  [[0.15]]
grads:  [0.02973751]
Stock Position:  0.02973751317298369
Bond Position:  [22.82034384]


portfolio before change:  [25.75833298]
curr_Stock_Price:  98.74944174019049
curr_Factors:  [98.74944174]
mat_Sqrt:  [[0.15]]
grads:  [0.07301115]
Stock Position:  0.07301114757966122
Bond Position:  [18.54852291]


portfolio before change:  [25.77162775]
curr_Stock_Price:  98.9156554700734
curr_Factors:  [98.91565547]
mat_Sqrt:  [[0.15]]
grads:  [0.05456994]
Stock Position:  0.05456993945299469
Bond Position:  [20.37380642]


portfolio before change:  [25.79411902]
curr_Stock_Price:  99.30447518769012
curr_Factors:  [99.30447519]
mat_Sqrt:  [[0.15]]
grads:  [0.10592582]
Stock Position:  0.1059258175823738
Bond Position:  [15.2752113]


portfolio before change:  [25.78252287]
curr_Stock_Price:  99.18598769803903
curr_Factors:  [99.1859877]
mat_Sqrt:  [[0.15]]
grads:  [0.01919148]
Stock Position:  0.01919147995304629
Bond Position:  [23.87899698]


portfolio before change:  [25.77864034]
curr_Stock_Price:  98.9059148192405
curr_Factors:  [98.90591482]
mat_Sqrt:  [[0.15]]
grads:  [-0.04295688]
Stock Position:  -0.04295687559580038
Bond Position:  [30.02732942]


portfolio before change:  [25.76411034]
curr_Stock_Price:  99.28785067499801
curr_Factors:  [99.28785067]
mat_Sqrt:  [[0.15]]
grads:  [0.06698059]
Stock Position:  0.06698059412517238
Bond Position:  [19.11375111]


portfolio before change:  [25.72700289]
curr_Stock_Price:  98.71601197068695
curr_Factors:  [98.71601197]
mat_Sqrt:  [[0.15]]
grads:  [0.07682383]
Stock Position:  0.07682383375796363
Bond Position:  [18.14326039]


portfolio before change:  [25.7278077]
curr_Stock_Price:  98.7117271782729
curr_Factors:  [98.71172718]
mat_Sqrt:  [[0.15]]
grads:  [-0.11304393]
Stock Position:  -0.11304393346822937
Bond Position:  [36.88656962]


portfolio before change:  [25.61456548]
curr_Stock_Price:  99.73387586394853
curr_Factors:  [99.73387586]
mat_Sqrt:  [[0.15]]
grads:  [0.05288961]
Stock Position:  0.05288960501262488
Bond Position:  [20.33968018]


portfolio before change:  [25.59760808]
curr_Stock_Price:  99.38922088196286
curr_Factors:  [99.38922088]
mat_Sqrt:  [[0.15]]
grads:  [0.12697552]
Stock Position:  0.12697552219381233
Bond Position:  [12.97760986]


portfolio before change:  [25.74822771]
curr_Stock_Price:  100.56904275227987
curr_Factors:  [100.56904275]
mat_Sqrt:  [[0.15]]
grads:  [-0.17573362]
Stock Position:  -0.1757336248172033
Bond Position:  [43.42159013]


portfolio before change:  [25.6757378]
curr_Stock_Price:  100.9969849627336
curr_Factors:  [100.99698496]
mat_Sqrt:  [[0.15]]
grads:  [0.02134381]
Stock Position:  0.021343808509007384
Bond Position:  [23.5200775]


portfolio before change:  [25.67079304]
curr_Stock_Price:  100.69643802791538
curr_Factors:  [100.69643803]
mat_Sqrt:  [[0.15]]
grads:  [-0.35568005]
Stock Position:  -0.3556800473224625
Bond Position:  [61.48650688]


portfolio before change:  [25.5798752]
curr_Stock_Price:  100.96285968868425
curr_Factors:  [100.96285969]
mat_Sqrt:  [[0.15]]
grads:  [0.06667628]
Stock Position:  0.06667628012307351
Bond Position:  [18.84804728]


portfolio before change:  [25.5381576]
curr_Stock_Price:  100.3195179591316
curr_Factors:  [100.31951796]
mat_Sqrt:  [[0.15]]
grads:  [0.04635374]
Stock Position:  0.04635373585608009
Bond Position:  [20.88797317]


portfolio before change:  [25.52647335]
curr_Stock_Price:  100.03928612888073
curr_Factors:  [100.03928613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01493664]
Stock Position:  -0.014936637449158205
Bond Position:  [27.0207239]


portfolio before change:  [25.53922683]
curr_Stock_Price:  99.29851501528088
curr_Factors:  [99.29851502]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300585]
Stock Position:  -0.013005845528162033
Bond Position:  [26.83068797]


portfolio before change:  [25.54314482]
curr_Stock_Price:  99.126206003144
curr_Factors:  [99.126206]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729852]
Stock Position:  -0.0072985207762191
Bond Position:  [26.2666195]


portfolio before change:  [25.54222002]
curr_Stock_Price:  99.47785507412861
curr_Factors:  [99.47785507]
mat_Sqrt:  [[0.15]]
grads:  [0.12116852]
Stock Position:  0.1211685169285536
Bond Position:  [13.48863585]


portfolio before change:  [25.52994956]
curr_Stock_Price:  99.36962955046378
curr_Factors:  [99.36962955]
mat_Sqrt:  [[0.15]]
grads:  [0.10111431]
Stock Position:  0.10111431336734067
Bond Position:  [15.4822577]


portfolio before change:  [25.55694267]
curr_Stock_Price:  99.62701589481883
curr_Factors:  [99.62701589]
mat_Sqrt:  [[0.15]]
grads:  [0.07181438]
Stock Position:  0.07181438451225476
Bond Position:  [18.40228985]


portfolio before change:  [25.58237047]
curr_Stock_Price:  99.96507660151646
curr_Factors:  [99.9650766]
mat_Sqrt:  [[0.15]]
grads:  [0.02792684]
Stock Position:  0.027926836015784887
Bond Position:  [22.79066217]


portfolio before change:  [25.55566043]
curr_Stock_Price:  98.95764051322497
curr_Factors:  [98.95764051]
mat_Sqrt:  [[0.15]]
grads:  [0.01435829]
Stock Position:  0.014358286592595025
Bond Position:  [24.13479827]


portfolio before change:  [25.55674162]
curr_Stock_Price:  98.92788197402551
curr_Factors:  [98.92788197]
mat_Sqrt:  [[0.15]]
grads:  [-0.01301044]
Stock Position:  -0.013010444661467894
Bond Position:  [26.84383736]


portfolio before change:  [25.54583962]
curr_Stock_Price:  99.8947815968433
curr_Factors:  [99.8947816]
mat_Sqrt:  [[0.15]]
grads:  [-0.0157934]
Stock Position:  -0.01579339611991741
Bond Position:  [27.12351748]


portfolio before change:  [25.54678559]
curr_Stock_Price:  99.94222546150081
curr_Factors:  [99.94222546]
mat_Sqrt:  [[0.15]]
grads:  [-0.04380854]
Stock Position:  -0.04380854017292197
Bond Position:  [29.92510859]


portfolio before change:  [25.53215019]
curr_Stock_Price:  100.31899634246741
curr_Factors:  [100.31899634]
mat_Sqrt:  [[0.15]]
grads:  [0.01418972]
Stock Position:  0.014189722486992584
Bond Position:  [24.10865147]


portfolio before change:  [25.53338157]
curr_Stock_Price:  100.29958400255845
curr_Factors:  [100.299584]
mat_Sqrt:  [[0.15]]
grads:  [0.00917136]
Stock Position:  0.009171362159793145
Bond Position:  [24.61349776]


portfolio before change:  [25.5362873]
curr_Stock_Price:  100.4486712357899
curr_Factors:  [100.44867124]
mat_Sqrt:  [[0.15]]
grads:  [-0.02741601]
Stock Position:  -0.027416008067366906
Bond Position:  [28.29018888]


portfolio before change:  [25.56071807]
curr_Stock_Price:  99.62205257700319
curr_Factors:  [99.62205258]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908477]
Stock Position:  -0.02908477050134332
Bond Position:  [28.45820261]


portfolio before change:  [25.56071608]
curr_Stock_Price:  99.68327650452588
curr_Factors:  [99.6832765]
mat_Sqrt:  [[0.15]]
grads:  [0.02756265]
Stock Position:  0.027562653310388603
Bond Position:  [22.81318049]


portfolio before change:  [25.54874517]
curr_Stock_Price:  99.19722812586332
curr_Factors:  [99.19722813]
mat_Sqrt:  [[0.15]]
grads:  [0.04734898]
Stock Position:  0.047348979435047435
Bond Position:  [20.85185765]


portfolio before change:  [25.56848064]
curr_Stock_Price:  99.58651185000834
curr_Factors:  [99.58651185]
mat_Sqrt:  [[0.15]]
grads:  [0.0487084]
Stock Position:  0.04870839748012866
Bond Position:  [20.71778123]


portfolio before change:  [25.58560575]
curr_Stock_Price:  99.91151154999191
curr_Factors:  [99.91151155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02686844]
Stock Position:  -0.026868443465556596
Bond Position:  [28.27007255]


portfolio before change:  [25.58005358]
curr_Stock_Price:  100.18391680244697
curr_Factors:  [100.1839168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00280744]
Stock Position:  -0.002807440309183391
Bond Position:  [25.86131395]


portfolio before change:  [25.58221914]
curr_Stock_Price:  99.98830336246661
curr_Factors:  [99.98830336]
mat_Sqrt:  [[0.15]]
grads:  [0.03218491]
Stock Position:  0.03218491322989769
Bond Position:  [22.36410427]


portfolio before change:  [25.57977735]
curr_Stock_Price:  99.8690055189858
curr_Factors:  [99.86900552]
mat_Sqrt:  [[0.15]]
grads:  [-0.04958044]
Stock Position:  -0.04958044473349748
Bond Position:  [30.53132706]


portfolio before change:  [25.58883462]
curr_Stock_Price:  99.72481545444526
curr_Factors:  [99.72481545]
mat_Sqrt:  [[0.15]]
grads:  [0.04793175]
Stock Position:  0.04793175203693487
Bond Position:  [20.8088495]


portfolio before change:  [25.57444949]
curr_Stock_Price:  99.3975641862666
curr_Factors:  [99.39756419]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [12.44808598]


portfolio before change:  [25.47708004]
curr_Stock_Price:  98.6543560180235
curr_Factors:  [98.65435602]
mat_Sqrt:  [[0.15]]
grads:  [0.03176183]
Stock Position:  0.031761832037870384
Bond Position:  [22.34363695]


portfolio before change:  [25.50180702]
curr_Stock_Price:  99.38890002765302
curr_Factors:  [99.38890003]
mat_Sqrt:  [[0.15]]
grads:  [0.05432151]
Stock Position:  0.05432151368906665
Bond Position:  [20.10285153]


portfolio before change:  [25.50550114]
curr_Stock_Price:  99.43377450021332
curr_Factors:  [99.4337745]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024009]
Stock Position:  -0.002400904268855545
Bond Position:  [25.74423211]


portfolio before change:  [25.50642708]
curr_Stock_Price:  99.71830339163182
curr_Factors:  [99.71830339]
mat_Sqrt:  [[0.15]]
grads:  [0.01907046]
Stock Position:  0.019070464209229098
Bond Position:  [23.60475274]


portfolio before change:  [25.51956608]
curr_Stock_Price:  100.32991193086674
curr_Factors:  [100.32991193]
mat_Sqrt:  [[0.15]]
grads:  [0.14088602]
Stock Position:  0.14088601991264788
Bond Position:  [11.38448411]


portfolio before change:  [25.47645143]
curr_Stock_Price:  100.01883633918605
curr_Factors:  [100.01883634]
mat_Sqrt:  [[0.15]]
grads:  [0.00628371]
Stock Position:  0.006283712182181669
Bond Position:  [24.84796185]


portfolio before change:  [25.47862402]
curr_Stock_Price:  100.11743096534268
curr_Factors:  [100.11743097]
mat_Sqrt:  [[0.15]]
grads:  [-0.1066096]
Stock Position:  -0.10660959825416534
Bond Position:  [36.15210311]


portfolio before change:  [25.50922351]
curr_Stock_Price:  99.85160204536255
curr_Factors:  [99.85160205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0258041]
Stock Position:  -0.025804095916199823
Bond Position:  [28.08580382]


portfolio before change:  [25.5029544]
curr_Stock_Price:  100.16258073936515
curr_Factors:  [100.16258074]
mat_Sqrt:  [[0.15]]
grads:  [0.0085099]
Stock Position:  0.008509904699939752
Bond Position:  [24.65058038]


portfolio before change:  [25.49729841]
curr_Stock_Price:  99.31689547621826
curr_Factors:  [99.31689548]
mat_Sqrt:  [[0.15]]
grads:  [0.0158059]
Stock Position:  0.015805902876485107
Bond Position:  [23.92750521]


portfolio before change:  [25.48385802]
curr_Stock_Price:  98.3719382959346
curr_Factors:  [98.3719383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00102905]
Stock Position:  -0.0010290493937490572
Bond Position:  [25.58508761]


portfolio before change:  [25.48570266]
curr_Stock_Price:  98.13335475474737
curr_Factors:  [98.13335475]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985543]
Stock Position:  -0.009855430627759086
Bond Position:  [26.45284913]


portfolio before change:  [25.48702046]
curr_Stock_Price:  98.16740185187975
curr_Factors:  [98.16740185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01398078]
Stock Position:  -0.01398077559209662
Bond Position:  [26.85947688]


portfolio before change:  [25.49667435]
curr_Stock_Price:  97.59696696416108
curr_Factors:  [97.59696696]
mat_Sqrt:  [[0.15]]
grads:  [-0.15410481]
Stock Position:  -0.1541048063583458
Bond Position:  [40.53683605]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.49444817]
Stock Price:  97.6278538451316
PL:  [25.49444817]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33439686e-02]
 [ 2.10091335e-03]
 [ 5.48443315e-02]
 [-1.18807942e-02]
 [ 8.54459231e-03]
 [-2.05407032e-02]
 [-1.39117137e-02]
 [ 9.96709651e-02]
 [-2.11866652e-02]
 [-1.36405922e-02]
 [ 9.69935489e-03]
 [-7.84218925e-03]
 [-3.30000223e-04]
 [ 5.60566030e-03]
 [-2.55774903e-03]
 [ 8.08457931e-03]
 [ 2.48893416e-02]
 [-1.51576096e-02]
 [ 2.10236675e-02]
 [ 2.38587414e-03]
 [-4.27786189e-03]
 [ 4.54035506e-03]
 [ 1.50493710e-02]
 [ 2.04776206e-02]
 [-2.75025863e-03]
 [ 4.51751340e-03]
 [-5.43075847e-03]
 [ 6.38571459e-03]
 [ 3.25614035e-02]
 [ 2.94573375e-03]
 [-8.23505745e-03]
 [ 9.30101643e-03]
 [ 1.23311926e-02]
 [-6.03040544e-03]
 [ 6.22348476e-03]
 [ 1.75877784e-02]
 [-2.36093866e-02]
 [ 2.61544240e-03]
 [-5.69559873e-02]
 [-1.16838921e-02]
 [ 7.10504862e-03]
 [-9.71272439e-04]
 [-1.92973517e-03]
 [-8.65388975e-04]
 [ 8.09384617e-03]
 [ 1.46550947e-02]
 [ 1.07991512e-02]
 [ 4.46129395e-03]
 [ 7.88199671e-03]
 [-2.30282769e-03]
 [-3.21076211e-03]
 [-1.08043952e-02]
 [ 2.13204155e-03]
 [ 2.29089459e-03]
 [-4.02259879e-03]
 [-3.68456767e-03]
 [ 1.01600042e-02]
 [-6.46149805e-03]
 [ 6.35458786e-03]
 [-3.93365662e-03]
 [-2.13572012e-03]
 [ 6.75913315e-03]
 [-1.09591725e-02]
 [ 7.62861501e-03]
 [ 2.40004174e-02]
 [ 5.46621039e-03]
 [ 7.46823909e-03]
 [-1.09454883e-03]
 [ 2.78979435e-03]
 [ 1.99466425e-02]
 [ 3.77655760e-04]
 [-1.59662162e-02]
 [-2.56095395e-03]
 [ 1.23997106e-03]
 [ 4.26762755e-04]
 [-2.75459827e-03]
 [-2.93639877e-03]
 [ 6.99966683e-03]
 [-2.18939393e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.06559981]
curr_Stock_Price:  99.54148256338122
curr_Factors:  [99.54148256]
mat_Sqrt:  [[0.15]]
grads:  [-0.08895979]
Stock Position:  -0.08895979089815056
Bond Position:  [0.78958966]


portfolio before change:  [-8.07645143]
curr_Stock_Price:  99.6640207008164
curr_Factors:  [99.6640207]
mat_Sqrt:  [[0.15]]
grads:  [0.01400609]
Stock Position:  0.01400608897312376
Bond Position:  [-9.47235457]


portfolio before change:  [-8.09729263]
curr_Stock_Price:  98.2182810924735
curr_Factors:  [98.21828109]
mat_Sqrt:  [[0.15]]
grads:  [0.36562888]
Stock Position:  0.36562887698129665
Bond Position:  [-44.00873244]


portfolio before change:  [-8.2614924]
curr_Stock_Price:  97.7767154674447
curr_Factors:  [97.77671547]
mat_Sqrt:  [[0.15]]
grads:  [-0.07920529]
Stock Position:  -0.07920529467435734
Bond Position:  [-0.51705884]


portfolio before change:  [-8.18492647]
curr_Stock_Price:  96.8096305013275
curr_Factors:  [96.8096305]
mat_Sqrt:  [[0.15]]
grads:  [0.05696395]
Stock Position:  0.05696394873132157
Bond Position:  [-13.6995853]


portfolio before change:  [-8.21939968]
curr_Stock_Price:  96.21948612727446
curr_Factors:  [96.21948613]
mat_Sqrt:  [[0.15]]
grads:  [-0.13693802]
Stock Position:  -0.13693802105371575
Bond Position:  [4.95670634]


portfolio before change:  [-8.23461248]
curr_Stock_Price:  96.33284110460417
curr_Factors:  [96.3328411]
mat_Sqrt:  [[0.15]]
grads:  [-0.09274476]
Stock Position:  -0.09274475777502042
Bond Position:  [0.69975354]


portfolio before change:  [-8.22330473]
curr_Stock_Price:  96.2113893915558
curr_Factors:  [96.21138939]
mat_Sqrt:  [[0.15]]
grads:  [0.6644731]
Stock Position:  0.6644731005083948
Bond Position:  [-72.15318495]


portfolio before change:  [-8.16006888]
curr_Stock_Price:  96.31334320401189
curr_Factors:  [96.3133432]
mat_Sqrt:  [[0.15]]
grads:  [-0.14124443]
Stock Position:  -0.14124443478653134
Bond Position:  [5.44365484]


portfolio before change:  [-8.20847415]
curr_Stock_Price:  96.65845775826537
curr_Factors:  [96.65845776]
mat_Sqrt:  [[0.15]]
grads:  [-0.09093728]
Stock Position:  -0.09093728120052237
Bond Position:  [0.5813832]


portfolio before change:  [-8.34925887]
curr_Stock_Price:  98.20700914899348
curr_Factors:  [98.20700915]
mat_Sqrt:  [[0.15]]
grads:  [0.06466237]
Stock Position:  0.06466236590583561
Bond Position:  [-14.69955643]


portfolio before change:  [-8.29820515]
curr_Stock_Price:  99.01076061760067
curr_Factors:  [99.01076062]
mat_Sqrt:  [[0.15]]
grads:  [-0.05228126]
Stock Position:  -0.05228126168740495
Bond Position:  [-3.12179766]


portfolio before change:  [-8.29536188]
curr_Stock_Price:  98.95264443874908
curr_Factors:  [98.95264444]
mat_Sqrt:  [[0.15]]
grads:  [-0.0022]
Stock Position:  -0.0022000014846995423
Bond Position:  [-8.07766591]


portfolio before change:  [-8.29648032]
curr_Stock_Price:  99.23153958677818
curr_Factors:  [99.23153959]
mat_Sqrt:  [[0.15]]
grads:  [0.03737107]
Stock Position:  0.03737106864965771
Bond Position:  [-12.004869]


portfolio before change:  [-8.30707248]
curr_Stock_Price:  98.96818528324566
curr_Factors:  [98.96818528]
mat_Sqrt:  [[0.15]]
grads:  [-0.01705166]
Stock Position:  -0.01705166017470407
Bond Position:  [-6.61950061]


portfolio before change:  [-8.30261875]
curr_Stock_Price:  98.68273130866707
curr_Factors:  [98.68273131]
mat_Sqrt:  [[0.15]]
grads:  [0.0538972]
Stock Position:  0.05389719539587681
Bond Position:  [-13.6213412]


portfolio before change:  [-8.26172429]
curr_Stock_Price:  99.4572764655021
curr_Factors:  [99.45727647]
mat_Sqrt:  [[0.15]]
grads:  [0.16592894]
Stock Position:  0.1659289440657119
Bond Position:  [-24.76456516]


portfolio before change:  [-8.23673983]
curr_Stock_Price:  99.61717800684443
curr_Factors:  [99.61717801]
mat_Sqrt:  [[0.15]]
grads:  [-0.10105073]
Stock Position:  -0.10105073050495475
Bond Position:  [1.82964877]


portfolio before change:  [-8.22943674]
curr_Stock_Price:  99.54603810329007
curr_Factors:  [99.5460381]
mat_Sqrt:  [[0.15]]
grads:  [0.14015778]
Stock Position:  0.14015778323439293
Bond Position:  [-22.18158877]


portfolio before change:  [-8.19700317]
curr_Stock_Price:  99.78733728362769
curr_Factors:  [99.78733728]
mat_Sqrt:  [[0.15]]
grads:  [0.01590583]
Stock Position:  0.01590582758274114
Bond Position:  [-9.78420335]


portfolio before change:  [-8.19013194]
curr_Stock_Price:  100.25777908478032
curr_Factors:  [100.25777908]
mat_Sqrt:  [[0.15]]
grads:  [-0.02851908]
Stock Position:  -0.028519079298123386
Bond Position:  [-5.33087239]


portfolio before change:  [-8.2208279]
curr_Stock_Price:  101.32242682098567
curr_Factors:  [101.32242682]
mat_Sqrt:  [[0.15]]
grads:  [0.03026903]
Stock Position:  0.03026903370753251
Bond Position:  [-11.28775985]


portfolio before change:  [-8.23351398]
curr_Stock_Price:  100.92662399083828
curr_Factors:  [100.92662399]
mat_Sqrt:  [[0.15]]
grads:  [0.10032914]
Stock Position:  0.10032914012919948
Bond Position:  [-18.35939538]


portfolio before change:  [-8.20682348]
curr_Stock_Price:  101.20409070750296
curr_Factors:  [101.20409071]
mat_Sqrt:  [[0.15]]
grads:  [0.13651747]
Stock Position:  0.13651747069297693
Bond Position:  [-22.02294997]


portfolio before change:  [-8.24393834]
curr_Stock_Price:  100.94230452302126
curr_Factors:  [100.94230452]
mat_Sqrt:  [[0.15]]
grads:  [-0.01833506]
Stock Position:  -0.018335057500559974
Bond Position:  [-6.39315539]


portfolio before change:  [-8.21802466]
curr_Stock_Price:  99.50717010840198
curr_Factors:  [99.50717011]
mat_Sqrt:  [[0.15]]
grads:  [0.03011676]
Stock Position:  0.03011675597767816
Bond Position:  [-11.21485782]


portfolio before change:  [-8.18348967]
curr_Stock_Price:  100.67714779485406
curr_Factors:  [100.67714779]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620506]
Stock Position:  -0.036205056454409794
Bond Position:  [-4.53846785]


portfolio before change:  [-8.19131247]
curr_Stock_Price:  100.88538190775637
curr_Factors:  [100.88538191]
mat_Sqrt:  [[0.15]]
grads:  [0.04257143]
Stock Position:  0.042571430577861204
Bond Position:  [-12.4861475]


portfolio before change:  [-8.19088815]
curr_Stock_Price:  100.91368087066398
curr_Factors:  [100.91368087]
mat_Sqrt:  [[0.15]]
grads:  [0.21707602]
Stock Position:  0.21707602313621918
Bond Position:  [-30.09682867]


portfolio before change:  [-8.29574973]
curr_Stock_Price:  100.43928267678493
curr_Factors:  [100.43928268]
mat_Sqrt:  [[0.15]]
grads:  [0.01963822]
Stock Position:  0.01963822497610443
Bond Position:  [-10.26819896]


portfolio before change:  [-8.3009346]
curr_Stock_Price:  100.20794360332434
curr_Factors:  [100.2079436]
mat_Sqrt:  [[0.15]]
grads:  [-0.05490038]
Stock Position:  -0.054900382969085906
Bond Position:  [-2.79948012]


portfolio before change:  [-8.28104918]
curr_Stock_Price:  99.84254728596501
curr_Factors:  [99.84254729]
mat_Sqrt:  [[0.15]]
grads:  [0.06200678]
Stock Position:  0.06200677619728733
Bond Position:  [-14.47196366]


portfolio before change:  [-8.24911069]
curr_Stock_Price:  100.37221534269038
curr_Factors:  [100.37221534]
mat_Sqrt:  [[0.15]]
grads:  [0.08220795]
Stock Position:  0.0822079503605792
Bond Position:  [-16.50050479]


portfolio before change:  [-8.30551634]
curr_Stock_Price:  99.69862678141287
curr_Factors:  [99.69862678]
mat_Sqrt:  [[0.15]]
grads:  [-0.0402027]
Stock Position:  -0.04020270291179979
Bond Position:  [-4.29736207]


portfolio before change:  [-8.32701992]
curr_Stock_Price:  100.22682466700205
curr_Factors:  [100.22682467]
mat_Sqrt:  [[0.15]]
grads:  [0.0414899]
Stock Position:  0.04148989840488805
Bond Position:  [-12.48542069]


portfolio before change:  [-8.354071]
curr_Stock_Price:  99.59364110589405
curr_Factors:  [99.59364111]
mat_Sqrt:  [[0.15]]
grads:  [0.11725186]
Stock Position:  0.11725185580909112
Bond Position:  [-20.03161025]


portfolio before change:  [-8.26105173]
curr_Stock_Price:  100.39764793823157
curr_Factors:  [100.39764794]
mat_Sqrt:  [[0.15]]
grads:  [-0.15739591]
Stock Position:  -0.15739591034521785
Bond Position:  [7.54112747]


portfolio before change:  [-8.26278093]
curr_Stock_Price:  100.41162888759288
curr_Factors:  [100.41162889]
mat_Sqrt:  [[0.15]]
grads:  [0.01743628]
Stock Position:  0.01743628263625637
Bond Position:  [-10.01358648]


portfolio before change:  [-8.2703511]
curr_Stock_Price:  100.01336213190416
curr_Factors:  [100.01336213]
mat_Sqrt:  [[0.15]]
grads:  [-0.37970658]
Stock Position:  -0.3797065817231091
Bond Position:  [29.70538077]


portfolio before change:  [-8.10321127]
curr_Stock_Price:  99.57807027620551
curr_Factors:  [99.57807028]
mat_Sqrt:  [[0.15]]
grads:  [-0.07789261]
Stock Position:  -0.0778926141409306
Bond Position:  [-0.34681506]


portfolio before change:  [-8.12534934]
curr_Stock_Price:  99.86200465391539
curr_Factors:  [99.86200465]
mat_Sqrt:  [[0.15]]
grads:  [0.04736699]
Stock Position:  0.04736699076849081
Bond Position:  [-12.85551199]


portfolio before change:  [-8.13960318]
curr_Stock_Price:  99.57804432073333
curr_Factors:  [99.57804432]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647515]
Stock Position:  -0.006475149595919563
Bond Position:  [-7.49482044]


portfolio before change:  [-8.13843284]
curr_Stock_Price:  99.32495706704849
curr_Factors:  [99.32495707]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128649]
Stock Position:  -0.012864901134642115
Bond Position:  [-6.86062709]


portfolio before change:  [-8.13513065]
curr_Stock_Price:  99.0349438177403
curr_Factors:  [99.03494382]
mat_Sqrt:  [[0.15]]
grads:  [-0.00576926]
Stock Position:  -0.0057692598340486866
Bond Position:  [-7.56377233]


portfolio before change:  [-8.13476017]
curr_Stock_Price:  98.88878480309091
curr_Factors:  [98.8887848]
mat_Sqrt:  [[0.15]]
grads:  [0.05395897]
Stock Position:  0.053958974484661235
Bond Position:  [-13.47069759]


portfolio before change:  [-8.13144423]
curr_Stock_Price:  98.96584123919719
curr_Factors:  [98.96584124]
mat_Sqrt:  [[0.15]]
grads:  [0.09770063]
Stock Position:  0.09770063149696312
Bond Position:  [-17.80046942]


portfolio before change:  [-8.04851023]
curr_Stock_Price:  99.8260871005364
curr_Factors:  [99.8260871]
mat_Sqrt:  [[0.15]]
grads:  [0.07199434]
Stock Position:  0.07199434113555453
Bond Position:  [-15.2354236]


portfolio before change:  [-8.06814964]
curr_Stock_Price:  99.5665226858358
curr_Factors:  [99.56652269]
mat_Sqrt:  [[0.15]]
grads:  [0.02974196]
Stock Position:  0.029741959654570986
Bond Position:  [-11.02945314]


portfolio before change:  [-8.06145255]
curr_Stock_Price:  99.81487418585608
curr_Factors:  [99.81487419]
mat_Sqrt:  [[0.15]]
grads:  [0.05254664]
Stock Position:  0.05254664474280265
Bond Position:  [-13.30638928]


portfolio before change:  [-8.08363385]
curr_Stock_Price:  99.40857557867166
curr_Factors:  [99.40857558]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535218]
Stock Position:  -0.015352184627152935
Bond Position:  [-6.55749504]


portfolio before change:  [-8.09010242]
curr_Stock_Price:  99.80322391378786
curr_Factors:  [99.80322391]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140508]
Stock Position:  -0.02140508074470147
Bond Position:  [-5.95380635]


portfolio before change:  [-8.10436402]
curr_Stock_Price:  100.4521109832721
curr_Factors:  [100.45211098]
mat_Sqrt:  [[0.15]]
grads:  [-0.0720293]
Stock Position:  -0.07202930152793366
Bond Position:  [-0.86886863]


portfolio before change:  [-8.12557842]
curr_Stock_Price:  100.74588161548913
curr_Factors:  [100.74588162]
mat_Sqrt:  [[0.15]]
grads:  [0.01421361]
Stock Position:  0.01421361032862686
Bond Position:  [-9.55754113]


portfolio before change:  [-8.12586978]
curr_Stock_Price:  100.76741087542332
curr_Factors:  [100.76741088]
mat_Sqrt:  [[0.15]]
grads:  [0.01527263]
Stock Position:  0.015272630585786255
Bond Position:  [-9.66485322]


portfolio before change:  [-8.12921422]
curr_Stock_Price:  100.58798079439819
curr_Factors:  [100.58798079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681733]
Stock Position:  -0.02681732524465445
Bond Position:  [-5.43171363]


portfolio before change:  [-8.14068384]
curr_Stock_Price:  101.00301568128891
curr_Factors:  [101.00301568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456378]
Stock Position:  -0.024563784440432085
Bond Position:  [-5.65966754]


portfolio before change:  [-8.15146901]
curr_Stock_Price:  101.42768278495056
curr_Factors:  [101.42768278]
mat_Sqrt:  [[0.15]]
grads:  [0.06773336]
Stock Position:  0.06773336145998907
Bond Position:  [-15.02150691]


portfolio before change:  [-8.11699089]
curr_Stock_Price:  101.95057125032045
curr_Factors:  [101.95057125]
mat_Sqrt:  [[0.15]]
grads:  [-0.04307665]
Stock Position:  -0.04307665364399062
Bond Position:  [-3.72530145]


portfolio before change:  [-8.12149715]
curr_Stock_Price:  102.0497762052936
curr_Factors:  [102.04977621]
mat_Sqrt:  [[0.15]]
grads:  [0.04236392]
Stock Position:  0.042363919091146396
Bond Position:  [-12.44472561]


portfolio before change:  [-8.11459897]
curr_Stock_Price:  102.23096807178133
curr_Factors:  [102.23096807]
mat_Sqrt:  [[0.15]]
grads:  [-0.02622438]
Stock Position:  -0.026224377442528563
Bond Position:  [-5.43365548]


portfolio before change:  [-8.10749723]
curr_Stock_Price:  101.94721102212102
curr_Factors:  [101.94721102]
mat_Sqrt:  [[0.15]]
grads:  [-0.01423813]
Stock Position:  -0.014238134106084564
Bond Position:  [-6.65595917]


portfolio before change:  [-8.09327955]
curr_Stock_Price:  100.91942908351074
curr_Factors:  [100.91942908]
mat_Sqrt:  [[0.15]]
grads:  [0.04506089]
Stock Position:  0.04506088763765866
Bond Position:  [-12.6407986]


portfolio before change:  [-8.08294891]
curr_Stock_Price:  101.16622200827833
curr_Factors:  [101.16622201]
mat_Sqrt:  [[0.15]]
grads:  [-0.07306115]
Stock Position:  -0.07306115013107364
Bond Position:  [-0.69162838]


portfolio before change:  [-8.06037297]
curr_Stock_Price:  100.85662971102283
curr_Factors:  [100.85662971]
mat_Sqrt:  [[0.15]]
grads:  [0.05085743]
Stock Position:  0.05085743339034256
Bond Position:  [-13.1896823]


portfolio before change:  [-8.09280628]
curr_Stock_Price:  100.23510933536721
curr_Factors:  [100.23510934]
mat_Sqrt:  [[0.15]]
grads:  [0.16000278]
Stock Position:  0.1600027824721331
Bond Position:  [-24.13070268]


portfolio before change:  [-8.15391489]
curr_Stock_Price:  99.86261337967122
curr_Factors:  [99.86261338]
mat_Sqrt:  [[0.15]]
grads:  [0.0364414]
Stock Position:  0.03644140258094119
Bond Position:  [-11.79304858]


portfolio before change:  [-8.15139543]
curr_Stock_Price:  99.95197738883691
curr_Factors:  [99.95197739]
mat_Sqrt:  [[0.15]]
grads:  [0.04978826]
Stock Position:  0.04978826059865654
Bond Position:  [-13.12783052]


portfolio before change:  [-8.1285066]
curr_Stock_Price:  100.42818076726206
curr_Factors:  [100.42818077]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729699]
Stock Position:  -0.007296992189570511
Bond Position:  [-7.39568295]


portfolio before change:  [-8.12871582]
curr_Stock_Price:  100.39350545941936
curr_Factors:  [100.39350546]
mat_Sqrt:  [[0.15]]
grads:  [0.01859863]
Stock Position:  0.01859862896875784
Bond Position:  [-9.99589738]


portfolio before change:  [-8.12002652]
curr_Stock_Price:  100.89429887064455
curr_Factors:  [100.89429887]
mat_Sqrt:  [[0.15]]
grads:  [0.13297762]
Stock Position:  0.13297761637963587
Bond Position:  [-21.53670989]


portfolio before change:  [-8.10705367]
curr_Stock_Price:  101.00197816008146
curr_Factors:  [101.00197816]
mat_Sqrt:  [[0.15]]
grads:  [0.00251771]
Stock Position:  0.0025177050658114495
Bond Position:  [-8.36134686]


portfolio before change:  [-8.10868443]
curr_Stock_Price:  100.56183129330715
curr_Factors:  [100.56183129]
mat_Sqrt:  [[0.15]]
grads:  [-0.10644144]
Stock Position:  -0.10644144122535423
Bond Position:  [2.59526183]


portfolio before change:  [-8.07173703]
curr_Stock_Price:  100.21624042846561
curr_Factors:  [100.21624043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01707303]
Stock Position:  -0.017073026313209998
Bond Position:  [-6.36074252]


portfolio before change:  [-8.06597468]
curr_Stock_Price:  99.85544256212613
curr_Factors:  [99.85544256]
mat_Sqrt:  [[0.15]]
grads:  [0.00826647]
Stock Position:  0.008266473730028132
Bond Position:  [-8.89142707]


portfolio before change:  [-8.06612597]
curr_Stock_Price:  99.9043679809627
curr_Factors:  [99.90436798]
mat_Sqrt:  [[0.15]]
grads:  [0.00284509]
Stock Position:  0.0028450850304412995
Bond Position:  [-8.35036239]


portfolio before change:  [-8.06716765]
curr_Stock_Price:  99.72167691205618
curr_Factors:  [99.72167691]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836399]
Stock Position:  -0.0183639884536032
Bond Position:  [-6.23587993]


portfolio before change:  [-8.06365165]
curr_Stock_Price:  99.5089912007081
curr_Factors:  [99.5089912]
mat_Sqrt:  [[0.15]]
grads:  [-0.01957599]
Stock Position:  -0.01957599178717885
Bond Position:  [-6.11566445]


portfolio before change:  [-8.06608015]
curr_Stock_Price:  99.61352041070046
curr_Factors:  [99.61352041]
mat_Sqrt:  [[0.15]]
grads:  [0.04666445]
Stock Position:  0.04666444551893515
Bond Position:  [-12.71448985]


portfolio before change:  [-8.04733606]
curr_Stock_Price:  100.03222835266097
curr_Factors:  [100.03222835]
mat_Sqrt:  [[0.15]]
grads:  [-0.1459596]
Stock Position:  -0.1459595956203346
Bond Position:  [6.55332754]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.99893589]
Stock Price:  99.70343477431257
PL:  [-7.99893589]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40015180e-02]
 [ 1.36595138e-02]
 [ 4.24198246e-02]
 [-1.22321548e-02]
 [ 1.27035912e-02]
 [-1.35476428e-02]
 [-7.18732444e-03]
 [ 3.43645053e-02]
 [-1.72682238e-02]
 [-3.37432180e-03]
 [ 1.44383471e-02]
 [-3.47049273e-03]
 [-2.66117509e-03]
 [ 8.77185101e-03]
 [-3.42673531e-04]
 [ 1.29692128e-02]
 [ 3.53847364e-02]
 [-1.47415572e-02]
 [ 1.82581436e-02]
 [ 2.42397471e-03]
 [-4.36266092e-03]
 [ 4.42566762e-03]
 [ 1.60462775e-02]
 [ 1.77102153e-02]
 [-5.86071128e-03]
 [ 4.59783404e-03]
 [-2.97625555e-03]
 [ 7.13800032e-03]
 [ 3.27862690e-02]
 [ 4.94553596e-04]
 [-7.24857421e-03]
 [ 7.80907081e-03]
 [ 1.22451056e-02]
 [ 5.09689181e-03]
 [ 5.34318806e-03]
 [ 1.42349592e-02]
 [-1.50046589e-02]
 [-6.97310721e-03]
 [-3.16505689e-02]
 [-1.42807546e-02]
 [ 3.88394962e-03]
 [ 9.68776324e-03]
 [-9.79783886e-03]
 [ 2.45436604e-03]
 [ 5.27067998e-03]
 [ 1.19315569e-02]
 [ 1.05722679e-02]
 [-2.34593208e-03]
 [ 1.28542393e-02]
 [-1.35078734e-03]
 [ 2.11113620e-02]
 [ 2.96283234e-03]
 [-1.64064895e-03]
 [-1.47870514e-02]
 [-2.43328468e-03]
 [-3.04604201e-03]
 [ 1.07898194e-02]
 [-1.39281978e-02]
 [ 4.27539126e-03]
 [-3.65905647e-03]
 [-4.58209783e-03]
 [ 6.65348384e-03]
 [-1.90915844e-02]
 [ 1.23806923e-03]
 [ 1.81624386e-02]
 [ 1.46049058e-02]
 [ 6.97904489e-03]
 [ 1.12093378e-02]
 [ 7.55155965e-03]
 [ 1.11762709e-02]
 [ 2.73057593e-03]
 [-1.53233703e-02]
 [-2.30275442e-03]
 [ 1.24185835e-03]
 [ 4.08607987e-03]
 [-1.51020099e-02]
 [-3.72130960e-03]
 [ 1.31155998e-02]
 [-4.76131732e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.5145013]
curr_Stock_Price:  99.79360208194865
curr_Factors:  [99.79360208]
mat_Sqrt:  [[0.15]]
grads:  [-0.09334345]
Stock Position:  -0.09334345336153604
Bond Position:  [6.80057814]


portfolio before change:  [-2.54741855]
curr_Stock_Price:  100.15080224365049
curr_Factors:  [100.15080224]
mat_Sqrt:  [[0.15]]
grads:  [0.09106343]
Stock Position:  0.09106342537937948
Bond Position:  [-11.66749366]


portfolio before change:  [-2.6838804]
curr_Stock_Price:  98.66027403252454
curr_Factors:  [98.66027403]
mat_Sqrt:  [[0.15]]
grads:  [0.28279883]
Stock Position:  0.2827988304203384
Bond Position:  [-30.5848905]


portfolio before change:  [-2.68076892]
curr_Stock_Price:  98.67803611275389
curr_Factors:  [98.67803611]
mat_Sqrt:  [[0.15]]
grads:  [-0.0815477]
Stock Position:  -0.08154769835062584
Bond Position:  [5.36619781]


portfolio before change:  [-2.73172032]
curr_Stock_Price:  99.30695395821591
curr_Factors:  [99.30695396]
mat_Sqrt:  [[0.15]]
grads:  [0.08469061]
Stock Position:  0.08469060777744476
Bond Position:  [-11.14208661]


portfolio before change:  [-2.75463085]
curr_Stock_Price:  99.04465654171223
curr_Factors:  [99.04465654]
mat_Sqrt:  [[0.15]]
grads:  [-0.09031762]
Stock Position:  -0.0903176185860749
Bond Position:  [6.19084666]


portfolio before change:  [-2.75086108]
curr_Stock_Price:  99.0072016941099
curr_Factors:  [99.00720169]
mat_Sqrt:  [[0.15]]
grads:  [-0.0479155]
Stock Position:  -0.04791549623586599
Bond Position:  [1.99311812]


portfolio before change:  [-2.72322418]
curr_Stock_Price:  98.43301751107727
curr_Factors:  [98.43301751]
mat_Sqrt:  [[0.15]]
grads:  [0.2290967]
Stock Position:  0.2290967019883635
Bond Position:  [-25.27390386]


portfolio before change:  [-2.62641846]
curr_Stock_Price:  98.8624666841038
curr_Factors:  [98.86246668]
mat_Sqrt:  [[0.15]]
grads:  [-0.11512149]
Stock Position:  -0.1151214921897754
Bond Position:  [8.75477622]


portfolio before change:  [-2.74334985]
curr_Stock_Price:  99.88294144802835
curr_Factors:  [99.88294145]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249548]
Stock Position:  -0.02249547865853055
Bond Position:  [-0.49643527]


portfolio before change:  [-2.73740277]
curr_Stock_Price:  99.61719415470591
curr_Factors:  [99.61719415]
mat_Sqrt:  [[0.15]]
grads:  [0.09625565]
Stock Position:  0.0962556474655128
Bond Position:  [-12.32612029]


portfolio before change:  [-2.71408294]
curr_Stock_Price:  99.86746757051283
curr_Factors:  [99.86746757]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313662]
Stock Position:  -0.02313661816670923
Bond Position:  [-0.40348748]


portfolio before change:  [-2.72826479]
curr_Stock_Price:  100.47933857465166
curr_Factors:  [100.47933857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774117]
Stock Position:  -0.017741167265032342
Bond Position:  [-0.94564403]


portfolio before change:  [-2.72475509]
curr_Stock_Price:  100.27817901868437
curr_Factors:  [100.27817902]
mat_Sqrt:  [[0.15]]
grads:  [0.05847901]
Stock Position:  0.058479006714782976
Bond Position:  [-8.58892339]


portfolio before change:  [-2.74766543]
curr_Stock_Price:  99.89558831824638
curr_Factors:  [99.89558832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00228449]
Stock Position:  -0.002284490206252409
Bond Position:  [-2.51945494]


portfolio before change:  [-2.74793157]
curr_Stock_Price:  99.94315290998132
curr_Factors:  [99.94315291]
mat_Sqrt:  [[0.15]]
grads:  [0.08646142]
Stock Position:  0.0864614185780545
Bond Position:  [-11.38915834]


portfolio before change:  [-2.7297681]
curr_Stock_Price:  100.16146201135538
curr_Factors:  [100.16146201]
mat_Sqrt:  [[0.15]]
grads:  [0.23589824]
Stock Position:  0.2358982424936011
Bond Position:  [-26.35768095]


portfolio before change:  [-2.6297567]
curr_Stock_Price:  100.59240544661634
curr_Factors:  [100.59240545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09827705]
Stock Position:  -0.0982770479861213
Bond Position:  [7.25616795]


portfolio before change:  [-2.70337844]
curr_Stock_Price:  101.34614457752124
curr_Factors:  [101.34614458]
mat_Sqrt:  [[0.15]]
grads:  [0.12172096]
Stock Position:  0.12172095701901138
Bond Position:  [-15.03932814]


portfolio before change:  [-2.82142852]
curr_Stock_Price:  100.38402515632266
curr_Factors:  [100.38402516]
mat_Sqrt:  [[0.15]]
grads:  [0.01615983]
Stock Position:  0.016159831370223848
Bond Position:  [-4.44361744]


portfolio before change:  [-2.82232326]
curr_Stock_Price:  100.34584348902834
curr_Factors:  [100.34584349]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908441]
Stock Position:  -0.029084406165030326
Bond Position:  [0.096176]


portfolio before change:  [-2.8074008]
curr_Stock_Price:  99.83297562047662
curr_Factors:  [99.83297562]
mat_Sqrt:  [[0.15]]
grads:  [0.02950445]
Stock Position:  0.029504450809594622
Bond Position:  [-5.75291791]


portfolio before change:  [-2.80557623]
curr_Stock_Price:  99.9070027726818
curr_Factors:  [99.90700277]
mat_Sqrt:  [[0.15]]
grads:  [0.10697518]
Stock Position:  0.1069751836590018
Bond Position:  [-13.4931462]


portfolio before change:  [-2.8513244]
curr_Stock_Price:  99.48723423346684
curr_Factors:  [99.48723423]
mat_Sqrt:  [[0.15]]
grads:  [0.1180681]
Stock Position:  0.11806810224754039
Bond Position:  [-14.59759334]


portfolio before change:  [-2.82632985]
curr_Stock_Price:  99.70665783198685
curr_Factors:  [99.70665783]
mat_Sqrt:  [[0.15]]
grads:  [-0.03907141]
Stock Position:  -0.03907140851079233
Bond Position:  [1.06934971]


portfolio before change:  [-2.83212727]
curr_Stock_Price:  99.85674866777352
curr_Factors:  [99.85674867]
mat_Sqrt:  [[0.15]]
grads:  [0.03065223]
Stock Position:  0.030652226946671943
Bond Position:  [-5.89295899]


portfolio before change:  [-2.81605934]
curr_Stock_Price:  100.3929659941147
curr_Factors:  [100.39296599]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198417]
Stock Position:  -0.019841703670974986
Bond Position:  [-0.82409186]


portfolio before change:  [-2.82818994]
curr_Stock_Price:  101.00173919942038
curr_Factors:  [101.0017392]
mat_Sqrt:  [[0.15]]
grads:  [0.04758667]
Stock Position:  0.04758666882993164
Bond Position:  [-7.63452626]


portfolio before change:  [-2.83110315]
curr_Stock_Price:  100.95054771663591
curr_Factors:  [100.95054772]
mat_Sqrt:  [[0.15]]
grads:  [0.21857513]
Stock Position:  0.21857512655535216
Bond Position:  [-24.89638189]


portfolio before change:  [-3.02337509]
curr_Stock_Price:  100.07800620270572
curr_Factors:  [100.0780062]
mat_Sqrt:  [[0.15]]
grads:  [0.00329702]
Stock Position:  0.0032970239761373477
Bond Position:  [-3.35333468]


portfolio before change:  [-3.02200953]
curr_Stock_Price:  100.55575578550037
curr_Factors:  [100.55575579]
mat_Sqrt:  [[0.15]]
grads:  [-0.04832383]
Stock Position:  -0.04832382804266002
Bond Position:  [1.83722952]


portfolio before change:  [-3.0212918]
curr_Stock_Price:  100.54327952359228
curr_Factors:  [100.54327952]
mat_Sqrt:  [[0.15]]
grads:  [0.05206047]
Stock Position:  0.05206047209214434
Bond Position:  [-8.2556224]


portfolio before change:  [-3.04148334]
curr_Stock_Price:  100.16534306914055
curr_Factors:  [100.16534307]
mat_Sqrt:  [[0.15]]
grads:  [0.08163404]
Stock Position:  0.08163403735134624
Bond Position:  [-11.2183847]


portfolio before change:  [-3.01400656]
curr_Stock_Price:  100.51051719413294
curr_Factors:  [100.51051719]
mat_Sqrt:  [[0.15]]
grads:  [0.03397928]
Stock Position:  0.03397927870120901
Bond Position:  [-6.42928143]


portfolio before change:  [-2.99401763]
curr_Stock_Price:  101.11061129352706
curr_Factors:  [101.11061129]
mat_Sqrt:  [[0.15]]
grads:  [0.03562125]
Stock Position:  0.03562125375541799
Bond Position:  [-6.59570438]


portfolio before change:  [-2.95951724]
curr_Stock_Price:  102.09071810994294
curr_Factors:  [102.09071811]
mat_Sqrt:  [[0.15]]
grads:  [0.09489973]
Stock Position:  0.09489972775144422
Bond Position:  [-12.6478986]


portfolio before change:  [-2.83908777]
curr_Stock_Price:  103.36806624354757
curr_Factors:  [103.36806624]
mat_Sqrt:  [[0.15]]
grads:  [-0.10003106]
Stock Position:  -0.10003105921890984
Bond Position:  [7.50092938]


portfolio before change:  [-2.831208]
curr_Stock_Price:  103.29397976775894
curr_Factors:  [103.29397977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04648738]
Stock Position:  -0.04648738141657343
Bond Position:  [1.97065863]


portfolio before change:  [-2.78745635]
curr_Stock_Price:  102.35547820537029
curr_Factors:  [102.35547821]
mat_Sqrt:  [[0.15]]
grads:  [-0.21100379]
Stock Position:  -0.21100379276165715
Bond Position:  [18.80993776]


portfolio before change:  [-2.85455189]
curr_Stock_Price:  102.67903254470872
curr_Factors:  [102.67903254]
mat_Sqrt:  [[0.15]]
grads:  [-0.09520503]
Stock Position:  -0.09520503088196422
Bond Position:  [6.92100858]


portfolio before change:  [-2.87943249]
curr_Stock_Price:  102.9449132359881
curr_Factors:  [102.94491324]
mat_Sqrt:  [[0.15]]
grads:  [0.025893]
Stock Position:  0.025892997479129057
Bond Position:  [-5.54498487]


portfolio before change:  [-2.87658704]
curr_Stock_Price:  103.06819080918633
curr_Factors:  [103.06819081]
mat_Sqrt:  [[0.15]]
grads:  [0.06458509]
Stock Position:  0.0645850882817624
Bond Position:  [-9.53325524]


portfolio before change:  [-2.85289743]
curr_Stock_Price:  103.44421346412665
curr_Factors:  [103.44421346]
mat_Sqrt:  [[0.15]]
grads:  [-0.06531893]
Stock Position:  -0.06531892570537916
Bond Position:  [3.90396747]


portfolio before change:  [-2.83961432]
curr_Stock_Price:  103.24459131177939
curr_Factors:  [103.24459131]
mat_Sqrt:  [[0.15]]
grads:  [0.01636244]
Stock Position:  0.01636244027413863
Bond Position:  [-4.52894778]


portfolio before change:  [-2.83764024]
curr_Stock_Price:  103.38253809580546
curr_Factors:  [103.3825381]
mat_Sqrt:  [[0.15]]
grads:  [0.03513787]
Stock Position:  0.035137866542543514
Bond Position:  [-6.47028207]


portfolio before change:  [-2.84076832]
curr_Stock_Price:  103.30502415305247
curr_Factors:  [103.30502415]
mat_Sqrt:  [[0.15]]
grads:  [0.07954371]
Stock Position:  0.07954371279211642
Bond Position:  [-11.05803349]


portfolio before change:  [-2.83068944]
curr_Stock_Price:  103.44042169536178
curr_Factors:  [103.4404217]
mat_Sqrt:  [[0.15]]
grads:  [0.07048179]
Stock Position:  0.07048178583268991
Bond Position:  [-10.12135509]


portfolio before change:  [-2.78616745]
curr_Stock_Price:  104.08107795647837
curr_Factors:  [104.08107796]
mat_Sqrt:  [[0.15]]
grads:  [-0.01563955]
Stock Position:  -0.01563954722683956
Bond Position:  [-1.15838652]


portfolio before change:  [-2.78908474]
curr_Stock_Price:  104.26298157353442
curr_Factors:  [104.26298157]
mat_Sqrt:  [[0.15]]
grads:  [0.08569493]
Stock Position:  0.08569492889194298
Bond Position:  [-11.72389353]


portfolio before change:  [-2.79961738]
curr_Stock_Price:  104.14862396073471
curr_Factors:  [104.14862396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00900525]
Stock Position:  -0.009005248922047782
Bond Position:  [-1.86173309]


portfolio before change:  [-2.80068643]
curr_Stock_Price:  104.25441709145868
curr_Factors:  [104.25441709]
mat_Sqrt:  [[0.15]]
grads:  [0.14074241]
Stock Position:  0.1407424134221963
Bond Position:  [-17.4737047]


portfolio before change:  [-2.89180309]
curr_Stock_Price:  103.61477680151152
curr_Factors:  [103.6147768]
mat_Sqrt:  [[0.15]]
grads:  [0.01975222]
Stock Position:  0.019752215567386777
Bond Position:  [-4.9384245]


portfolio before change:  [-2.89651866]
curr_Stock_Price:  103.39166715039136
curr_Factors:  [103.39166715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01093766]
Stock Position:  -0.010937659668878488
Bond Position:  [-1.76565579]


portfolio before change:  [-2.89247246]
curr_Stock_Price:  103.0116442636473
curr_Factors:  [103.01164426]
mat_Sqrt:  [[0.15]]
grads:  [-0.09858034]
Stock Position:  -0.09858034268727073
Bond Position:  [7.26245073]


portfolio before change:  [-2.89307756]
curr_Stock_Price:  103.0223869899471
curr_Factors:  [103.02238699]
mat_Sqrt:  [[0.15]]
grads:  [-0.0162219]
Stock Position:  -0.016221897838438658
Bond Position:  [-1.22185893]


portfolio before change:  [-2.89555765]
curr_Stock_Price:  103.17056466879544
curr_Factors:  [103.17056467]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030695]
Stock Position:  -0.0203069467652155
Bond Position:  [-0.80047849]


portfolio before change:  [-2.89364988]
curr_Stock_Price:  103.07415426614205
curr_Factors:  [103.07415427]
mat_Sqrt:  [[0.15]]
grads:  [0.07193213]
Stock Position:  0.07193212939452907
Bond Position:  [-10.30799329]


portfolio before change:  [-2.87507189]
curr_Stock_Price:  103.34138203396681
curr_Factors:  [103.34138203]
mat_Sqrt:  [[0.15]]
grads:  [-0.09285465]
Stock Position:  -0.092854651754248
Bond Position:  [6.72065615]


portfolio before change:  [-2.91079746]
curr_Stock_Price:  103.73065299540407
curr_Factors:  [103.730653]
mat_Sqrt:  [[0.15]]
grads:  [0.02850261]
Stock Position:  0.028502608376746678
Bond Position:  [-5.86739164]


portfolio before change:  [-2.91942458]
curr_Stock_Price:  103.44084093066526
curr_Factors:  [103.44084093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439371]
Stock Position:  -0.024393709793663097
Bond Position:  [-0.39611873]


portfolio before change:  [-2.93262782]
curr_Stock_Price:  103.98108188380535
curr_Factors:  [103.98108188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054732]
Stock Position:  -0.030547318854021212
Bond Position:  [0.24371544]


portfolio before change:  [-2.91113611]
curr_Stock_Price:  103.27802570425952
curr_Factors:  [103.2780257]
mat_Sqrt:  [[0.15]]
grads:  [0.04435656]
Stock Position:  0.044356558925293055
Bond Position:  [-7.49219394]


portfolio before change:  [-2.92014447]
curr_Stock_Price:  103.085493050621
curr_Factors:  [103.08549305]
mat_Sqrt:  [[0.15]]
grads:  [-0.12727723]
Stock Position:  -0.12727722960209512
Bond Position:  [10.2002915]


portfolio before change:  [-2.99047983]
curr_Stock_Price:  103.64311752591584
curr_Factors:  [103.64311753]
mat_Sqrt:  [[0.15]]
grads:  [0.00825379]
Stock Position:  0.00825379484609041
Bond Position:  [-3.84592886]


portfolio before change:  [-2.98950274]
curr_Stock_Price:  103.79062137108819
curr_Factors:  [103.79062137]
mat_Sqrt:  [[0.15]]
grads:  [0.12108292]
Stock Position:  0.12108292414234487
Bond Position:  [-15.55677467]


portfolio before change:  [-2.90706535]
curr_Stock_Price:  104.47948581957127
curr_Factors:  [104.47948582]
mat_Sqrt:  [[0.15]]
grads:  [0.09736604]
Stock Position:  0.09736603847495796
Bond Position:  [-13.07981898]


portfolio before change:  [-2.94378366]
curr_Stock_Price:  104.11076594265616
curr_Factors:  [104.11076594]
mat_Sqrt:  [[0.15]]
grads:  [0.04652697]
Stock Position:  0.04652696591299915
Bond Position:  [-7.78774171]


portfolio before change:  [-2.93307886]
curr_Stock_Price:  104.35130486692701
curr_Factors:  [104.35130487]
mat_Sqrt:  [[0.15]]
grads:  [0.07472892]
Stock Position:  0.07472891883361017
Bond Position:  [-10.73113905]


portfolio before change:  [-2.85352389]
curr_Stock_Price:  105.42486091101804
curr_Factors:  [105.42486091]
mat_Sqrt:  [[0.15]]
grads:  [0.05034373]
Stock Position:  0.050343730975713444
Bond Position:  [-8.16100473]


portfolio before change:  [-2.84125138]
curr_Stock_Price:  105.6787672017274
curr_Factors:  [105.6787672]
mat_Sqrt:  [[0.15]]
grads:  [0.07450847]
Stock Position:  0.07450847296338178
Bond Position:  [-10.71521495]


portfolio before change:  [-2.89845042]
curr_Stock_Price:  104.92007067010742
curr_Factors:  [104.92007067]
mat_Sqrt:  [[0.15]]
grads:  [0.01820384]
Stock Position:  0.018203839505159313
Bond Position:  [-4.80839855]


portfolio before change:  [-2.92119264]
curr_Stock_Price:  103.68727100586531
curr_Factors:  [103.68727101]
mat_Sqrt:  [[0.15]]
grads:  [-0.1021558]
Stock Position:  -0.10215580204142495
Bond Position:  [7.67106369]


portfolio before change:  [-2.86876]
curr_Stock_Price:  103.17870287867629
curr_Factors:  [103.17870288]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153517]
Stock Position:  -0.015351696104230483
Bond Position:  [-1.28479191]


portfolio before change:  [-2.85692479]
curr_Stock_Price:  102.40253335921874
curr_Factors:  [102.40253336]
mat_Sqrt:  [[0.15]]
grads:  [0.00827906]
Stock Position:  0.00827905567242095
Bond Position:  [-3.70472106]


portfolio before change:  [-2.85365651]
curr_Stock_Price:  102.82526562833287
curr_Factors:  [102.82526563]
mat_Sqrt:  [[0.15]]
grads:  [0.02724053]
Stock Position:  0.027240532492266746
Bond Position:  [-5.6546715]


portfolio before change:  [-2.86222785]
curr_Stock_Price:  102.5235861200507
curr_Factors:  [102.52358612]
mat_Sqrt:  [[0.15]]
grads:  [-0.10068007]
Stock Position:  -0.10068006602512863
Bond Position:  [7.45985357]


portfolio before change:  [-2.8871479]
curr_Stock_Price:  102.77573440457489
curr_Factors:  [102.7757344]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480873]
Stock Position:  -0.02480873064375529
Bond Position:  [-0.33741239]


portfolio before change:  [-2.89198025]
curr_Stock_Price:  102.96966826781947
curr_Factors:  [102.96966827]
mat_Sqrt:  [[0.15]]
grads:  [0.08743733]
Stock Position:  0.08743733230744918
Bond Position:  [-11.89537335]


portfolio before change:  [-2.94793662]
curr_Stock_Price:  102.33821153677943
curr_Factors:  [102.33821154]
mat_Sqrt:  [[0.15]]
grads:  [-0.03174212]
Stock Position:  -0.031742115497346374
Bond Position:  [0.30049471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.96211557]
Stock Price:  102.78549529525128
PL:  [-5.74761087]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38960517e-02]
 [-1.66186275e-02]
 [ 1.88794362e-02]
 [-1.02035657e-02]
 [ 1.09880983e-02]
 [-1.51007243e-02]
 [-8.28662529e-03]
 [ 1.42112710e-03]
 [-1.83694935e-02]
 [-1.30748382e-02]
 [ 8.75807636e-04]
 [-6.99645271e-03]
 [ 4.80500812e-03]
 [-6.06834646e-03]
 [ 4.21914644e-03]
 [ 1.12418627e-03]
 [-5.45669533e-02]
 [-6.66635364e-03]
 [ 2.04730031e-02]
 [-8.61342998e-03]
 [-4.39068230e-02]
 [ 6.78139321e-03]
 [ 1.85456854e-02]
 [-3.70278134e-03]
 [ 3.17216759e-02]
 [ 3.29643063e-03]
 [-7.02117380e-03]
 [ 3.77191013e-02]
 [-3.52704424e-02]
 [ 1.70548191e-01]
 [-4.10965526e-03]
 [ 4.70679477e-02]
 [ 1.68706532e-02]
 [-1.82595893e-02]
 [-3.02518814e-02]
 [-1.73339957e-01]
 [ 3.21215219e-02]
 [-1.71707549e-02]
 [ 1.33387913e-01]
 [ 4.88002061e-02]
 [ 6.20844937e-03]
 [ 3.39129083e-02]
 [-4.99896694e-03]
 [ 4.68298908e-02]
 [-1.08127942e-01]
 [ 2.77480154e-02]
 [ 8.52130012e-03]
 [ 5.46962032e-03]
 [-1.92585647e-02]
 [ 3.76274367e-04]
 [ 1.73111873e-03]
 [-5.13212422e-03]
 [-1.75731027e-03]
 [ 9.93351291e-05]
 [-2.37623523e-02]
 [-5.81467454e-03]
 [-6.53499062e-03]
 [ 1.51286566e-02]
 [ 4.58692004e-03]
 [-1.86170340e-03]
 [-5.20444232e-03]
 [-6.42787514e-03]
 [ 5.93936590e-03]
 [-1.13314357e-02]
 [ 1.44694033e-02]
 [ 1.40870115e-02]
 [ 2.07993057e-02]
 [-9.54202312e-03]
 [ 1.31032619e-02]
 [ 3.57851194e-02]
 [ 3.66457349e-03]
 [-1.46698662e-02]
 [-6.51450705e-03]
 [ 4.61804162e-03]
 [ 1.31272445e-02]
 [ 3.24588766e-02]
 [ 1.09614689e-02]
 [-5.01313740e-02]
 [-1.90551388e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.3127331]
curr_Stock_Price:  99.84818393094976
curr_Factors:  [99.84818393]
mat_Sqrt:  [[0.15]]
grads:  [-0.09264034]
Stock Position:  -0.09264034438827769
Bond Position:  [7.93723705]


portfolio before change:  [-1.24008647]
curr_Stock_Price:  99.06935983223542
curr_Factors:  [99.06935983]
mat_Sqrt:  [[0.15]]
grads:  [-0.11079085]
Stock Position:  -0.11079085022996644
Bond Position:  [9.73589213]


portfolio before change:  [-1.25606183]
curr_Stock_Price:  99.21904612050784
curr_Factors:  [99.21904612]
mat_Sqrt:  [[0.15]]
grads:  [0.12586291]
Stock Position:  0.1258629079437952
Bond Position:  [-13.7440595]


portfolio before change:  [-1.26379153]
curr_Stock_Price:  99.16445764705269
curr_Factors:  [99.16445765]
mat_Sqrt:  [[0.15]]
grads:  [-0.06802377]
Stock Position:  -0.0680237714448638
Bond Position:  [5.48174887]


portfolio before change:  [-1.21036606]
curr_Stock_Price:  98.38410027492259
curr_Factors:  [98.38410027]
mat_Sqrt:  [[0.15]]
grads:  [0.07325399]
Stock Position:  0.07325398854187536
Bond Position:  [-8.41739381]


portfolio before change:  [-1.21254991]
curr_Stock_Price:  98.36147009733679
curr_Factors:  [98.3614701]
mat_Sqrt:  [[0.15]]
grads:  [-0.1006715]
Stock Position:  -0.1006714954132241
Bond Position:  [8.68964638]


portfolio before change:  [-1.27053588]
curr_Stock_Price:  98.94285702787131
curr_Factors:  [98.94285703]
mat_Sqrt:  [[0.15]]
grads:  [-0.05524417]
Stock Position:  -0.055244168586199155
Bond Position:  [4.19547999]


portfolio before change:  [-1.29228224]
curr_Stock_Price:  99.34124442789077
curr_Factors:  [99.34124443]
mat_Sqrt:  [[0.15]]
grads:  [0.00947418]
Stock Position:  0.009474180652543584
Bond Position:  [-2.23345913]


portfolio before change:  [-1.29845522]
curr_Stock_Price:  98.70442037655762
curr_Factors:  [98.70442038]
mat_Sqrt:  [[0.15]]
grads:  [-0.12246329]
Stock Position:  -0.12246328980299516
Bond Position:  [10.78921282]


portfolio before change:  [-1.22971953]
curr_Stock_Price:  98.14865101200792
curr_Factors:  [98.14865101]
mat_Sqrt:  [[0.15]]
grads:  [-0.08716559]
Stock Position:  -0.08716558783470589
Bond Position:  [7.32546533]


portfolio before change:  [-1.14352294]
curr_Stock_Price:  97.16502053351955
curr_Factors:  [97.16502053]
mat_Sqrt:  [[0.15]]
grads:  [0.00583872]
Stock Position:  0.005838717571432807
Bond Position:  [-1.71084206]


portfolio before change:  [-1.14188526]
curr_Stock_Price:  97.46382165449751
curr_Factors:  [97.46382165]
mat_Sqrt:  [[0.15]]
grads:  [-0.04664302]
Stock Position:  -0.046643018095505924
Bond Position:  [3.40412154]


portfolio before change:  [-1.15517732]
curr_Stock_Price:  97.7533575369516
curr_Factors:  [97.75335754]
mat_Sqrt:  [[0.15]]
grads:  [0.03203339]
Stock Position:  0.03203338747227623
Bond Position:  [-4.2865485]


portfolio before change:  [-1.17006221]
curr_Stock_Price:  97.29705326706492
curr_Factors:  [97.29705327]
mat_Sqrt:  [[0.15]]
grads:  [-0.04045564]
Stock Position:  -0.04045564305969494
Bond Position:  [2.76615265]


portfolio before change:  [-1.15951662]
curr_Stock_Price:  97.04065640353747
curr_Factors:  [97.0406564]
mat_Sqrt:  [[0.15]]
grads:  [0.02812764]
Stock Position:  0.028127642924750357
Bond Position:  [-3.88904155]


portfolio before change:  [-1.1689233]
curr_Stock_Price:  96.71486987269432
curr_Factors:  [96.71486987]
mat_Sqrt:  [[0.15]]
grads:  [0.00749458]
Stock Position:  0.007494575166350076
Bond Position:  [-1.89376016]


portfolio before change:  [-1.17632051]
curr_Stock_Price:  95.74365508037926
curr_Factors:  [95.74365508]
mat_Sqrt:  [[0.15]]
grads:  [-0.36377969]
Stock Position:  -0.36377968868779814
Bond Position:  [33.65327653]


portfolio before change:  [-0.82973599]
curr_Stock_Price:  94.79670522877842
curr_Factors:  [94.79670523]
mat_Sqrt:  [[0.15]]
grads:  [-0.04444236]
Stock Position:  -0.044442357623752815
Bond Position:  [3.38325309]


portfolio before change:  [-0.79397358]
curr_Stock_Price:  93.99677128389526
curr_Factors:  [93.99677128]
mat_Sqrt:  [[0.15]]
grads:  [0.13648669]
Stock Position:  0.13648668765837282
Bond Position:  [-13.62328154]


portfolio before change:  [-0.83916811]
curr_Stock_Price:  93.67188207185815
curr_Factors:  [93.67188207]
mat_Sqrt:  [[0.15]]
grads:  [-0.05742287]
Stock Position:  -0.05742286650013474
Bond Position:  [4.53973987]


portfolio before change:  [-0.84491085]
curr_Stock_Price:  93.77683122781612
curr_Factors:  [93.77683123]
mat_Sqrt:  [[0.15]]
grads:  [-0.29271215]
Stock Position:  -0.2927121536482868
Bond Position:  [26.60470738]


portfolio before change:  [-0.80544243]
curr_Stock_Price:  93.64767506015477
curr_Factors:  [93.64767506]
mat_Sqrt:  [[0.15]]
grads:  [0.04520929]
Stock Position:  0.04520928805608712
Bond Position:  [-5.03918714]


portfolio before change:  [-0.79902036]
curr_Stock_Price:  93.79669367612955
curr_Factors:  [93.79669368]
mat_Sqrt:  [[0.15]]
grads:  [0.1236379]
Stock Position:  0.12363790234080406
Bond Position:  [-12.39584681]


portfolio before change:  [-0.84549054]
curr_Stock_Price:  93.42710302825272
curr_Factors:  [93.42710303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02468521]
Stock Position:  -0.0246852089339449
Bond Position:  [1.46077702]


portfolio before change:  [-0.83965621]
curr_Stock_Price:  93.1944527631194
curr_Factors:  [93.19445276]
mat_Sqrt:  [[0.15]]
grads:  [0.21147784]
Stock Position:  0.21147783908710305
Bond Position:  [-20.5482177]


portfolio before change:  [-0.86646973]
curr_Stock_Price:  93.07373463987857
curr_Factors:  [93.07373464]
mat_Sqrt:  [[0.15]]
grads:  [0.0219762]
Stock Position:  0.021976204176998214
Bond Position:  [-2.91187712]


portfolio before change:  [-0.88442802]
curr_Stock_Price:  92.26484631910208
curr_Factors:  [92.26484632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04680783]
Stock Position:  -0.046807825360207826
Bond Position:  [3.4342888]


portfolio before change:  [-0.86514158]
curr_Stock_Price:  91.85739751087091
curr_Factors:  [91.85739751]
mat_Sqrt:  [[0.15]]
grads:  [0.25146068]
Stock Position:  0.25146067552521784
Bond Position:  [-23.96366481]


portfolio before change:  [-0.94584172]
curr_Stock_Price:  91.54242829938569
curr_Factors:  [91.5424283]
mat_Sqrt:  [[0.15]]
grads:  [-0.23513628]
Stock Position:  -0.2351362824774433
Bond Position:  [20.57910456]


portfolio before change:  [-0.90945526]
curr_Stock_Price:  91.39315218194889
curr_Factors:  [91.39315218]
mat_Sqrt:  [[0.15]]
grads:  [1.13698794]
Stock Position:  1.1369879419974203
Bond Position:  [-104.82236727]


portfolio before change:  [-1.43219808]
curr_Stock_Price:  90.93915332827397
curr_Factors:  [90.93915333]
mat_Sqrt:  [[0.15]]
grads:  [-0.0273977]
Stock Position:  -0.027397701764165575
Bond Position:  [1.05932572]


portfolio before change:  [-1.4269029]
curr_Stock_Price:  90.74829909312922
curr_Factors:  [90.74829909]
mat_Sqrt:  [[0.15]]
grads:  [0.31378632]
Stock Position:  0.3137863178947811
Bond Position:  [-29.90247753]


portfolio before change:  [-1.3053279]
curr_Stock_Price:  91.14170045699062
curr_Factors:  [91.14170046]
mat_Sqrt:  [[0.15]]
grads:  [0.11247102]
Stock Position:  0.11247102161853098
Bond Position:  [-11.55612806]


portfolio before change:  [-1.29513461]
curr_Stock_Price:  91.23875279469071
curr_Factors:  [91.23875279]
mat_Sqrt:  [[0.15]]
grads:  [-0.1217306]
Stock Position:  -0.12173059507487155
Bond Position:  [9.81141306]


portfolio before change:  [-1.31796899]
curr_Stock_Price:  91.43137167935042
curr_Factors:  [91.43137168]
mat_Sqrt:  [[0.15]]
grads:  [-0.20167921]
Stock Position:  -0.20167920963090935
Bond Position:  [17.12183779]


portfolio before change:  [-1.20384053]
curr_Stock_Price:  90.87078684679157
curr_Factors:  [90.87078685]
mat_Sqrt:  [[0.15]]
grads:  [-1.15559971]
Stock Position:  -1.155599714898376
Bond Position:  [103.80641484]


portfolio before change:  [-0.78519868]
curr_Stock_Price:  90.5141289674546
curr_Factors:  [90.51412897]
mat_Sqrt:  [[0.15]]
grads:  [0.21414348]
Stock Position:  0.21414347934256941
Bond Position:  [-20.16820919]


portfolio before change:  [-0.73018038]
curr_Stock_Price:  90.77693808174628
curr_Factors:  [90.77693808]
mat_Sqrt:  [[0.15]]
grads:  [-0.1144717]
Stock Position:  -0.11447169939352293
Bond Position:  [9.66120999]


portfolio before change:  [-0.78100315]
curr_Stock_Price:  91.22618991082614
curr_Factors:  [91.22618991]
mat_Sqrt:  [[0.15]]
grads:  [0.88925275]
Stock Position:  0.8892527525105589
Bond Position:  [-81.90414363]


portfolio before change:  [-0.52440264]
curr_Stock_Price:  91.5205040800922
curr_Factors:  [91.52050408]
mat_Sqrt:  [[0.15]]
grads:  [0.32533471]
Stock Position:  0.3253347073778315
Bond Position:  [-30.29919905]


portfolio before change:  [-0.36530927]
curr_Stock_Price:  92.01533948802695
curr_Factors:  [92.01533949]
mat_Sqrt:  [[0.15]]
grads:  [0.04138966]
Stock Position:  0.041389662495678325
Bond Position:  [-4.17379311]


portfolio before change:  [-0.35406788]
curr_Stock_Price:  92.29324110990986
curr_Factors:  [92.29324111]
mat_Sqrt:  [[0.15]]
grads:  [0.22608606]
Stock Position:  0.22608605517626013
Bond Position:  [-21.22028268]


portfolio before change:  [-0.28290569]
curr_Stock_Price:  92.61386459809967
curr_Factors:  [92.6138646]
mat_Sqrt:  [[0.15]]
grads:  [-0.03332645]
Stock Position:  -0.03332644629979474
Bond Position:  [2.80358529]


portfolio before change:  [-0.2795026]
curr_Stock_Price:  92.51700887408315
curr_Factors:  [92.51700887]
mat_Sqrt:  [[0.15]]
grads:  [0.31219927]
Stock Position:  0.31219927173227646
Bond Position:  [-29.1632454]


portfolio before change:  [-0.3211415]
curr_Stock_Price:  92.38947450455574
curr_Factors:  [92.3894745]
mat_Sqrt:  [[0.15]]
grads:  [-0.72085295]
Stock Position:  -0.7208529491753362
Bond Position:  [66.27808367]


portfolio before change:  [-1.12455059]
curr_Stock_Price:  93.5097468161807
curr_Factors:  [93.50974682]
mat_Sqrt:  [[0.15]]
grads:  [0.18498677]
Stock Position:  0.18498676914483225
Bond Position:  [-18.42261654]


portfolio before change:  [-1.05332436]
curr_Stock_Price:  93.90100550312617
curr_Factors:  [93.9010055]
mat_Sqrt:  [[0.15]]
grads:  [0.05680867]
Stock Position:  0.05680866743849013
Bond Position:  [-6.38771535]


portfolio before change:  [-1.09245059]
curr_Stock_Price:  93.21929638346684
curr_Factors:  [93.21929638]
mat_Sqrt:  [[0.15]]
grads:  [0.03646414]
Stock Position:  0.03646413545368938
Bond Position:  [-4.49161164]


portfolio before change:  [-1.09584909]
curr_Stock_Price:  93.13379408555518
curr_Factors:  [93.13379409]
mat_Sqrt:  [[0.15]]
grads:  [-0.12839043]
Stock Position:  -0.12839043123936672
Bond Position:  [10.86163889]


portfolio before change:  [-1.18628369]
curr_Stock_Price:  93.84345340617921
curr_Factors:  [93.84345341]
mat_Sqrt:  [[0.15]]
grads:  [0.0025085]
Stock Position:  0.002508495782784215
Bond Position:  [-1.42168959]


portfolio before change:  [-1.18689327]
curr_Stock_Price:  93.63587028814621
curr_Factors:  [93.63587029]
mat_Sqrt:  [[0.15]]
grads:  [0.01154079]
Stock Position:  0.011540791525716637
Bond Position:  [-2.26752532]


portfolio before change:  [-1.18425743]
curr_Stock_Price:  93.87654368591699
curr_Factors:  [93.87654369]
mat_Sqrt:  [[0.15]]
grads:  [-0.03421416]
Stock Position:  -0.034214161441241564
Bond Position:  [2.02764979]


portfolio before change:  [-1.17266548]
curr_Stock_Price:  93.54144205243192
curr_Factors:  [93.54144205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0117154]
Stock Position:  -0.011715401815062946
Bond Position:  [-0.0767899]


portfolio before change:  [-1.16722692]
curr_Stock_Price:  93.07680968729079
curr_Factors:  [93.07680969]
mat_Sqrt:  [[0.15]]
grads:  [0.00066223]
Stock Position:  0.0006622341940509929
Bond Position:  [-1.22886557]


portfolio before change:  [-1.16742035]
curr_Stock_Price:  92.90071122759555
curr_Factors:  [92.90071123]
mat_Sqrt:  [[0.15]]
grads:  [-0.15841568]
Stock Position:  -0.15841568196408723
Bond Position:  [13.54950918]


portfolio before change:  [-1.16122763]
curr_Stock_Price:  92.86696557791895
curr_Factors:  [92.86696558]
mat_Sqrt:  [[0.15]]
grads:  [-0.0387645]
Stock Position:  -0.03876449690406899
Bond Position:  [2.43871357]


portfolio before change:  [-1.18952179]
curr_Stock_Price:  93.60079631516557
curr_Factors:  [93.60079632]
mat_Sqrt:  [[0.15]]
grads:  [-0.0435666]
Stock Position:  -0.04356660412762694
Bond Position:  [2.88834705]


portfolio before change:  [-1.14231796]
curr_Stock_Price:  92.52145346095203
curr_Factors:  [92.52145346]
mat_Sqrt:  [[0.15]]
grads:  [0.10085771]
Stock Position:  0.10085771087888938
Bond Position:  [-10.47381996]


portfolio before change:  [-1.15706744]
curr_Stock_Price:  92.38170360647433
curr_Factors:  [92.38170361]
mat_Sqrt:  [[0.15]]
grads:  [0.03057947]
Stock Position:  0.03057946691980423
Bond Position:  [-3.98205069]


portfolio before change:  [-1.1756445]
curr_Stock_Price:  91.78234153201937
curr_Factors:  [91.78234153]
mat_Sqrt:  [[0.15]]
grads:  [-0.01241136]
Stock Position:  -0.012411355988185173
Bond Position:  [-0.03650119]


portfolio before change:  [-1.17198255]
curr_Stock_Price:  91.4871089343286
curr_Factors:  [91.48710893]
mat_Sqrt:  [[0.15]]
grads:  [-0.03469628]
Stock Position:  -0.03469628214981456
Bond Position:  [2.00228]


portfolio before change:  [-1.15359336]
curr_Stock_Price:  90.9607113401263
curr_Factors:  [90.96071134]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428525]
Stock Position:  -0.0428525009569499
Bond Position:  [2.74430061]


portfolio before change:  [-1.16239599]
curr_Stock_Price:  91.17013102693168
curr_Factors:  [91.17013103]
mat_Sqrt:  [[0.15]]
grads:  [0.03959577]
Stock Position:  0.039595772675521904
Bond Position:  [-4.77234778]


portfolio before change:  [-1.18073138]
curr_Stock_Price:  90.71459992469649
curr_Factors:  [90.71459992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0755429]
Stock Position:  -0.07554290483443116
Bond Position:  [5.67211301]


portfolio before change:  [-1.15689239]
curr_Stock_Price:  90.4037239215704
curr_Factors:  [90.40372392]
mat_Sqrt:  [[0.15]]
grads:  [0.09646269]
Stock Position:  0.09646268885774702
Bond Position:  [-9.87747868]


portfolio before change:  [-1.11943341]
curr_Stock_Price:  90.7984500442005
curr_Factors:  [90.79845004]
mat_Sqrt:  [[0.15]]
grads:  [0.09391341]
Stock Position:  0.09391341023698958
Bond Position:  [-9.64662549]


portfolio before change:  [-1.09894909]
curr_Stock_Price:  91.02298929328217
curr_Factors:  [91.02298929]
mat_Sqrt:  [[0.15]]
grads:  [0.13866204]
Stock Position:  0.1386620377367307
Bond Position:  [-13.72038227]


portfolio before change:  [-1.23748091]
curr_Stock_Price:  90.03011286268541
curr_Factors:  [90.03011286]
mat_Sqrt:  [[0.15]]
grads:  [-0.06361349]
Stock Position:  -0.06361348749903127
Bond Position:  [4.48964855]


portfolio before change:  [-1.21553707]
curr_Stock_Price:  89.68956818839413
curr_Factors:  [89.68956819]
mat_Sqrt:  [[0.15]]
grads:  [0.08735508]
Stock Position:  0.08735507904498371
Bond Position:  [-9.05037638]


portfolio before change:  [-1.22189068]
curr_Stock_Price:  89.62331043274322
curr_Factors:  [89.62331043]
mat_Sqrt:  [[0.15]]
grads:  [0.23856746]
Stock Position:  0.23856746246337474
Bond Position:  [-22.60309643]


portfolio before change:  [-1.35100857]
curr_Stock_Price:  89.0880105063031
curr_Factors:  [89.08801051]
mat_Sqrt:  [[0.15]]
grads:  [0.02443049]
Stock Position:  0.024430489961874795
Bond Position:  [-3.52747231]


portfolio before change:  [-1.35833637]
curr_Stock_Price:  88.79709009868539
curr_Factors:  [88.7970901]
mat_Sqrt:  [[0.15]]
grads:  [-0.09779911]
Stock Position:  -0.09779910779154562
Bond Position:  [7.32593982]


portfolio before change:  [-1.45678213]
curr_Stock_Price:  89.80838406919932
curr_Factors:  [89.80838407]
mat_Sqrt:  [[0.15]]
grads:  [-0.04343005]
Stock Position:  -0.04343004697120757
Bond Position:  [2.44360021]


portfolio before change:  [-1.46770093]
curr_Stock_Price:  90.06331194211741
curr_Factors:  [90.06331194]
mat_Sqrt:  [[0.15]]
grads:  [0.03078694]
Stock Position:  0.03078694413420036
Bond Position:  [-4.24047508]


portfolio before change:  [-1.47170169]
curr_Stock_Price:  89.94197078742431
curr_Factors:  [89.94197079]
mat_Sqrt:  [[0.15]]
grads:  [0.08751496]
Stock Position:  0.08751496334875977
Bond Position:  [-9.34296997]


portfolio before change:  [-1.43487856]
curr_Stock_Price:  90.36940724848381
curr_Factors:  [90.36940725]
mat_Sqrt:  [[0.15]]
grads:  [0.21639251]
Stock Position:  0.2163925106535584
Bond Position:  [-20.99014148]


portfolio before change:  [-1.52278885]
curr_Stock_Price:  89.96921608940366
curr_Factors:  [89.96921609]
mat_Sqrt:  [[0.15]]
grads:  [0.07307646]
Stock Position:  0.07307645966330285
Bond Position:  [-8.09742064]


portfolio before change:  [-1.50082609]
curr_Stock_Price:  90.27668676677006
curr_Factors:  [90.27668677]
mat_Sqrt:  [[0.15]]
grads:  [-0.33420916]
Stock Position:  -0.3342091600489073
Bond Position:  [28.67046957]


portfolio before change:  [-1.60601228]
curr_Stock_Price:  90.59678018277526
curr_Factors:  [90.59678018]
mat_Sqrt:  [[0.15]]
grads:  [-0.12703426]
Stock Position:  -0.12703425834118554
Bond Position:  [9.9028825]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.61220857]
Stock Price:  90.65042897594336
PL:  [-1.61220857]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40351990e-02]
 [-5.57902831e-03]
 [ 3.81113562e-02]
 [-1.18416510e-02]
 [ 1.10510786e-02]
 [-1.64900911e-02]
 [-1.35789444e-02]
 [ 3.50114487e-02]
 [-2.08824927e-02]
 [-1.38140352e-02]
 [-4.06039087e-03]
 [-3.67528890e-03]
 [-9.57796723e-04]
 [-1.55648523e-02]
 [ 1.42470107e-02]
 [-5.04824874e-03]
 [-6.69482815e-02]
 [-3.41939575e-03]
 [ 1.99055309e-02]
 [-7.61961369e-03]
 [-2.52058824e-02]
 [ 5.87321545e-03]
 [ 1.38571097e-02]
 [ 2.09389577e-02]
 [-5.95559375e-03]
 [ 4.54440395e-03]
 [ 1.05451384e-02]
 [ 8.15587504e-03]
 [ 1.59470774e-02]
 [ 1.02655319e-02]
 [-6.74723905e-03]
 [ 1.67272324e-02]
 [ 1.16702351e-02]
 [-2.03356623e-02]
 [-2.97537368e-03]
 [ 1.83142020e-02]
 [ 5.31128489e-03]
 [-5.64586916e-04]
 [-3.33520113e-02]
 [-1.39432173e-02]
 [ 7.12068958e-03]
 [ 3.09007872e-02]
 [-3.04564580e-03]
 [ 3.44469751e-03]
 [-1.90943220e-02]
 [ 1.74330982e-02]
 [ 1.02962279e-02]
 [ 5.25709766e-03]
 [ 4.89106118e-04]
 [-2.05375677e-03]
 [-3.23634114e-03]
 [-4.36623744e-03]
 [ 1.73983118e-03]
 [ 5.15819378e-03]
 [-4.58714141e-03]
 [-4.37450522e-03]
 [ 5.09634814e-04]
 [ 9.98357250e-03]
 [ 7.47471541e-03]
 [-3.81730386e-03]
 [-5.13763049e-03]
 [-1.58191449e-03]
 [-3.42744544e-03]
 [-2.55871185e-03]
 [ 1.86093865e-02]
 [ 5.64131147e-03]
 [ 1.91266138e-02]
 [-2.83033690e-03]
 [ 5.19385876e-03]
 [ 2.36078480e-02]
 [ 3.57844265e-03]
 [-1.57803438e-02]
 [-5.61608735e-03]
 [ 1.06261645e-03]
 [ 7.58281300e-03]
 [ 1.57121678e-05]
 [-1.48104770e-03]
 [-1.73533339e-03]
 [-2.38892298e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.61559599]
curr_Stock_Price:  99.74359261780754
curr_Factors:  [99.74359262]
mat_Sqrt:  [[0.15]]
grads:  [-0.09356799]
Stock Position:  -0.09356799331278157
Bond Position:  [5.71721182]


portfolio before change:  [-3.58496571]
curr_Stock_Price:  99.4200531375326
curr_Factors:  [99.42005314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719352]
Stock Position:  -0.03719352205106769
Bond Position:  [0.11281623]


portfolio before change:  [-3.56240048]
curr_Stock_Price:  98.81354471048586
curr_Factors:  [98.81354471]
mat_Sqrt:  [[0.15]]
grads:  [0.25407571]
Stock Position:  0.2540757078507798
Bond Position:  [-28.66852179]


portfolio before change:  [-3.75517162]
curr_Stock_Price:  98.06188171357415
curr_Factors:  [98.06188171]
mat_Sqrt:  [[0.15]]
grads:  [-0.07894434]
Stock Position:  -0.07894433974844342
Bond Position:  [3.98625888]


portfolio before change:  [-3.72982313]
curr_Stock_Price:  97.74394448765196
curr_Factors:  [97.74394449]
mat_Sqrt:  [[0.15]]
grads:  [0.07367386]
Stock Position:  0.07367385731288914
Bond Position:  [-10.93099655]


portfolio before change:  [-3.72531495]
curr_Stock_Price:  97.81440887230492
curr_Factors:  [97.81440887]
mat_Sqrt:  [[0.15]]
grads:  [-0.10993394]
Stock Position:  -0.10993394098790271
Bond Position:  [7.0278085]


portfolio before change:  [-3.72348538]
curr_Stock_Price:  97.80176199190674
curr_Factors:  [97.80176199]
mat_Sqrt:  [[0.15]]
grads:  [-0.0905263]
Stock Position:  -0.09052629572805417
Bond Position:  [5.13014585]


portfolio before change:  [-3.77870324]
curr_Stock_Price:  98.4152688191356
curr_Factors:  [98.41526882]
mat_Sqrt:  [[0.15]]
grads:  [0.23340966]
Stock Position:  0.2334096581389254
Bond Position:  [-26.74977749]


portfolio before change:  [-3.91269304]
curr_Stock_Price:  97.84837757275781
curr_Factors:  [97.84837757]
mat_Sqrt:  [[0.15]]
grads:  [-0.13921662]
Stock Position:  -0.13921661825914536
Bond Position:  [9.70942719]


portfolio before change:  [-3.80063678]
curr_Stock_Price:  97.04783089860376
curr_Factors:  [97.0478309]
mat_Sqrt:  [[0.15]]
grads:  [-0.09209357]
Stock Position:  -0.0920935677341686
Bond Position:  [5.1368442]


portfolio before change:  [-3.77518164]
curr_Stock_Price:  96.7749119393391
curr_Factors:  [96.77491194]
mat_Sqrt:  [[0.15]]
grads:  [-0.02706927]
Stock Position:  -0.027069272455372495
Bond Position:  [-1.15555518]


portfolio before change:  [-3.76037405]
curr_Stock_Price:  96.22521810365467
curr_Factors:  [96.2252181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02450193]
Stock Position:  -0.024501925978862027
Bond Position:  [-1.40267088]


portfolio before change:  [-3.75448973]
curr_Stock_Price:  95.98148237392313
curr_Factors:  [95.98148237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00638531]
Stock Position:  -0.006385311487596794
Bond Position:  [-3.14161807]


portfolio before change:  [-3.75045499]
curr_Stock_Price:  95.31885275766226
curr_Factors:  [95.31885276]
mat_Sqrt:  [[0.15]]
grads:  [-0.10376568]
Stock Position:  -0.10376568223725063
Bond Position:  [6.1403708]


portfolio before change:  [-3.72438821]
curr_Stock_Price:  95.07134320658842
curr_Factors:  [95.07134321]
mat_Sqrt:  [[0.15]]
grads:  [0.09498007]
Stock Position:  0.09498007121225022
Bond Position:  [-12.75427115]


portfolio before change:  [-3.78516356]
curr_Stock_Price:  94.43986134027834
curr_Factors:  [94.43986134]
mat_Sqrt:  [[0.15]]
grads:  [-0.03365499]
Stock Position:  -0.03365499162648069
Bond Position:  [-0.60679082]


portfolio before change:  [-3.7770183]
curr_Stock_Price:  94.19671193100957
curr_Factors:  [94.19671193]
mat_Sqrt:  [[0.15]]
grads:  [-0.44632188]
Stock Position:  -0.44632187652530947
Bond Position:  [38.26503493]


portfolio before change:  [-3.24770193]
curr_Stock_Price:  93.01611838400945
curr_Factors:  [93.01611838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02279597]
Stock Position:  -0.022795971674930707
Bond Position:  [-1.12730913]


portfolio before change:  [-3.25925188]
curr_Stock_Price:  93.51969364557985
curr_Factors:  [93.51969365]
mat_Sqrt:  [[0.15]]
grads:  [0.13270354]
Stock Position:  0.13270353911088348
Bond Position:  [-15.6696462]


portfolio before change:  [-3.15375242]
curr_Stock_Price:  94.32207494688065
curr_Factors:  [94.32207495]
mat_Sqrt:  [[0.15]]
grads:  [-0.05079742]
Stock Position:  -0.05079742458897198
Bond Position:  [1.63756607]


portfolio before change:  [-3.24500897]
curr_Stock_Price:  96.12056959260865
curr_Factors:  [96.12056959]
mat_Sqrt:  [[0.15]]
grads:  [-0.16803922]
Stock Position:  -0.16803921603559294
Bond Position:  [12.90701619]


portfolio before change:  [-3.32879819]
curr_Stock_Price:  96.6239993346985
curr_Factors:  [96.62399933]
mat_Sqrt:  [[0.15]]
grads:  [0.03915477]
Stock Position:  0.0391547696521189
Bond Position:  [-7.11208863]


portfolio before change:  [-3.2746379]
curr_Stock_Price:  98.0185883282264
curr_Factors:  [98.01858833]
mat_Sqrt:  [[0.15]]
grads:  [0.09238073]
Stock Position:  0.09238073106227383
Bond Position:  [-12.32966675]


portfolio before change:  [-3.30230298]
curr_Stock_Price:  97.72746218940203
curr_Factors:  [97.72746219]
mat_Sqrt:  [[0.15]]
grads:  [0.13959305]
Stock Position:  0.13959305139895825
Bond Position:  [-16.94437763]


portfolio before change:  [-3.08634517]
curr_Stock_Price:  99.28210160739107
curr_Factors:  [99.28210161]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970396]
Stock Position:  -0.03970395832999478
Bond Position:  [0.85554725]


portfolio before change:  [-3.09046159]
curr_Stock_Price:  99.38712616119571
curr_Factors:  [99.38712616]
mat_Sqrt:  [[0.15]]
grads:  [0.03029603]
Stock Position:  0.030296026310224974
Bond Position:  [-6.10149658]


portfolio before change:  [-3.11173966]
curr_Stock_Price:  98.69737509054582
curr_Factors:  [98.69737509]
mat_Sqrt:  [[0.15]]
grads:  [0.07030092]
Stock Position:  0.07030092245127274
Bond Position:  [-10.05025618]


portfolio before change:  [-3.09438869]
curr_Stock_Price:  98.95312042149648
curr_Factors:  [98.95312042]
mat_Sqrt:  [[0.15]]
grads:  [0.0543725]
Stock Position:  0.05437250023871352
Bond Position:  [-8.47471725]


portfolio before change:  [-3.14858871]
curr_Stock_Price:  97.96603447881853
curr_Factors:  [97.96603448]
mat_Sqrt:  [[0.15]]
grads:  [0.10631385]
Stock Position:  0.10631384942092685
Bond Position:  [-13.56373495]


portfolio before change:  [-3.11043454]
curr_Stock_Price:  98.33289099456255
curr_Factors:  [98.33289099]
mat_Sqrt:  [[0.15]]
grads:  [0.06843688]
Stock Position:  0.06843687961522325
Bond Position:  [-9.84003076]


portfolio before change:  [-3.15682962]
curr_Stock_Price:  97.66395253402801
curr_Factors:  [97.66395253]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498159]
Stock Position:  -0.04498159369333823
Bond Position:  [1.23625061]


portfolio before change:  [-3.15419876]
curr_Stock_Price:  97.60718273087744
curr_Factors:  [97.60718273]
mat_Sqrt:  [[0.15]]
grads:  [0.11151488]
Stock Position:  0.11151488270436205
Bond Position:  [-14.03885229]


portfolio before change:  [-3.16405776]
curr_Stock_Price:  97.52664150865954
curr_Factors:  [97.52664151]
mat_Sqrt:  [[0.15]]
grads:  [0.07780157]
Stock Position:  0.07780156747371238
Bond Position:  [-10.75178334]


portfolio before change:  [-3.1586129]
curr_Stock_Price:  97.60526283959092
curr_Factors:  [97.60526284]
mat_Sqrt:  [[0.15]]
grads:  [-0.13557108]
Stock Position:  -0.13557108223388858
Bond Position:  [10.07383821]


portfolio before change:  [-3.26995207]
curr_Stock_Price:  98.43116758162442
curr_Factors:  [98.43116758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983582]
Stock Position:  -0.0198358245045392
Bond Position:  [-1.3174887]


portfolio before change:  [-3.27066352]
curr_Stock_Price:  98.46288309619058
curr_Factors:  [98.4628831]
mat_Sqrt:  [[0.15]]
grads:  [0.12209468]
Stock Position:  0.12209467973333032
Bond Position:  [-15.29245769]


portfolio before change:  [-3.33177164]
curr_Stock_Price:  97.97021364235712
curr_Factors:  [97.97021364]
mat_Sqrt:  [[0.15]]
grads:  [0.03540857]
Stock Position:  0.035408565912267875
Bond Position:  [-6.80075641]


portfolio before change:  [-3.33995584]
curr_Stock_Price:  97.7510820246857
curr_Factors:  [97.75108202]
mat_Sqrt:  [[0.15]]
grads:  [-0.00376391]
Stock Position:  -0.003763912771386167
Bond Position:  [-2.97202929]


portfolio before change:  [-3.34230675]
curr_Stock_Price:  98.32632207546372
curr_Factors:  [98.32632208]
mat_Sqrt:  [[0.15]]
grads:  [-0.22234674]
Stock Position:  -0.22234674206613667
Bond Position:  [18.52023062]


portfolio before change:  [-3.09974859]
curr_Stock_Price:  97.24062768353885
curr_Factors:  [97.24062768]
mat_Sqrt:  [[0.15]]
grads:  [-0.09295478]
Stock Position:  -0.09295478185467117
Bond Position:  [5.93923274]


portfolio before change:  [-3.13610733]
curr_Stock_Price:  97.63576553927213
curr_Factors:  [97.63576554]
mat_Sqrt:  [[0.15]]
grads:  [0.04747126]
Stock Position:  0.047471263843868926
Bond Position:  [-7.77100052]


portfolio before change:  [-3.14652215]
curr_Stock_Price:  97.42660489970453
curr_Factors:  [97.4266049]
mat_Sqrt:  [[0.15]]
grads:  [0.20600525]
Stock Position:  0.2060052482451998
Bond Position:  [-23.21691408]


portfolio before change:  [-3.09299935]
curr_Stock_Price:  97.69346170794135
curr_Factors:  [97.69346171]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030431]
Stock Position:  -0.020304305324389243
Bond Position:  [-1.10940148]


portfolio before change:  [-3.09246292]
curr_Stock_Price:  97.66362721832367
curr_Factors:  [97.66362722]
mat_Sqrt:  [[0.15]]
grads:  [0.02296465]
Stock Position:  0.022964650034848634
Bond Position:  [-5.33527394]


portfolio before change:  [-3.10155681]
curr_Stock_Price:  97.28215306804277
curr_Factors:  [97.28215307]
mat_Sqrt:  [[0.15]]
grads:  [-0.12729548]
Stock Position:  -0.12729548002347585
Bond Position:  [9.28202156]


portfolio before change:  [-3.13836859]
curr_Stock_Price:  97.57589429456553
curr_Factors:  [97.57589429]
mat_Sqrt:  [[0.15]]
grads:  [0.11622065]
Stock Position:  0.11622065439361415
Bond Position:  [-14.47870288]


portfolio before change:  [-3.08640716]
curr_Stock_Price:  98.0307737365039
curr_Factors:  [98.03077374]
mat_Sqrt:  [[0.15]]
grads:  [0.06864152]
Stock Position:  0.06864151903621339
Bond Position:  [-9.81538838]


portfolio before change:  [-3.06967963]
curr_Stock_Price:  98.28340511776805
curr_Factors:  [98.28340512]
mat_Sqrt:  [[0.15]]
grads:  [0.03504732]
Stock Position:  0.03504731772129259
Bond Position:  [-6.51424936]


portfolio before change:  [-3.05482056]
curr_Stock_Price:  98.71899428508748
curr_Factors:  [98.71899429]
mat_Sqrt:  [[0.15]]
grads:  [0.00326071]
Stock Position:  0.0032607074538894046
Bond Position:  [-3.37671432]


portfolio before change:  [-3.05406133]
curr_Stock_Price:  99.01655924920843
curr_Factors:  [99.01655925]
mat_Sqrt:  [[0.15]]
grads:  [-0.01369171]
Stock Position:  -0.013691711782302116
Bond Position:  [-1.69835514]


portfolio before change:  [-3.06488575]
curr_Stock_Price:  99.79938812422817
curr_Factors:  [99.79938812]
mat_Sqrt:  [[0.15]]
grads:  [-0.02157561]
Stock Position:  -0.02157560760979558
Bond Position:  [-0.91165331]


portfolio before change:  [-3.06008259]
curr_Stock_Price:  99.57412734255898
curr_Factors:  [99.57412734]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910825]
Stock Position:  -0.029108249630983674
Bond Position:  [-0.16165404]


portfolio before change:  [-3.05374161]
curr_Stock_Price:  99.35593874966165
curr_Factors:  [99.35593875]
mat_Sqrt:  [[0.15]]
grads:  [0.01159887]
Stock Position:  0.011598874541144914
Bond Position:  [-4.20615868]


portfolio before change:  [-3.05257488]
curr_Stock_Price:  99.47919402454521
curr_Factors:  [99.47919402]
mat_Sqrt:  [[0.15]]
grads:  [0.03438796]
Stock Position:  0.03438795854340378
Bond Position:  [-6.47346128]


portfolio before change:  [-3.04546927]
curr_Stock_Price:  99.69759072323876
curr_Factors:  [99.69759072]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058094]
Stock Position:  -0.03058094271554638
Bond Position:  [0.00337704]


portfolio before change:  [-3.03908585]
curr_Stock_Price:  99.4888591700796
curr_Factors:  [99.48885917]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916337]
Stock Position:  -0.0291633681246406
Bond Position:  [-0.13765563]


portfolio before change:  [-3.01375086]
curr_Stock_Price:  98.61983763403786
curr_Factors:  [98.61983763]
mat_Sqrt:  [[0.15]]
grads:  [0.00339757]
Stock Position:  0.0033975654274545747
Bond Position:  [-3.34881821]


portfolio before change:  [-3.01410212]
curr_Stock_Price:  98.57805505905493
curr_Factors:  [98.57805506]
mat_Sqrt:  [[0.15]]
grads:  [0.06655715]
Stock Position:  0.06655715002221738
Bond Position:  [-9.57517652]


portfolio before change:  [-2.99866175]
curr_Stock_Price:  98.81903349578204
curr_Factors:  [98.8190335]
mat_Sqrt:  [[0.15]]
grads:  [0.04983144]
Stock Position:  0.04983143607382324
Bond Position:  [-7.9229561]


portfolio before change:  [-3.03233327]
curr_Stock_Price:  98.15326269676929
curr_Factors:  [98.1532627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02544869]
Stock Position:  -0.025448692396289812
Bond Position:  [-0.53446108]


portfolio before change:  [-3.00887982]
curr_Stock_Price:  97.23035243924673
curr_Factors:  [97.23035244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03425087]
Stock Position:  -0.03425086994604307
Bond Position:  [0.32134434]


portfolio before change:  [-2.98202333]
curr_Stock_Price:  96.44682788153176
curr_Factors:  [96.44682788]
mat_Sqrt:  [[0.15]]
grads:  [-0.0105461]
Stock Position:  -0.010546096615059846
Bond Position:  [-1.96488577]


portfolio before change:  [-2.98435987]
curr_Stock_Price:  96.65673799661718
curr_Factors:  [96.656738]
mat_Sqrt:  [[0.15]]
grads:  [-0.02284964]
Stock Position:  -0.02284963629217273
Bond Position:  [-0.77578857]


portfolio before change:  [-2.98320906]
curr_Stock_Price:  96.60425113244357
curr_Factors:  [96.60425113]
mat_Sqrt:  [[0.15]]
grads:  [-0.01705808]
Stock Position:  -0.017058078991258437
Bond Position:  [-1.33532611]


portfolio before change:  [-2.97305614]
curr_Stock_Price:  96.00416127356023
curr_Factors:  [96.00416127]
mat_Sqrt:  [[0.15]]
grads:  [0.12406258]
Stock Position:  0.12406257669850214
Bond Position:  [-14.88357976]


portfolio before change:  [-2.96708433]
curr_Stock_Price:  96.05979500116702
curr_Factors:  [96.059795]
mat_Sqrt:  [[0.15]]
grads:  [0.03760874]
Stock Position:  0.03760874315459173
Bond Position:  [-6.57977248]


portfolio before change:  [-2.97146791]
curr_Stock_Price:  95.95417225845944
curr_Factors:  [95.95417226]
mat_Sqrt:  [[0.15]]
grads:  [0.12751076]
Stock Position:  0.12751075880459004
Bond Position:  [-15.20665723]


portfolio before change:  [-2.96590467]
curr_Stock_Price:  96.00525567817508
curr_Factors:  [96.00525568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01886891]
Stock Position:  -0.018868912681732037
Bond Position:  [-1.15438989]


portfolio before change:  [-2.97513145]
curr_Stock_Price:  96.4904255113586
curr_Factors:  [96.49042551]
mat_Sqrt:  [[0.15]]
grads:  [0.03462573]
Stock Position:  0.03462572503661134
Bond Position:  [-6.31618239]


portfolio before change:  [-2.96511044]
curr_Stock_Price:  96.79123614518643
curr_Factors:  [96.79123615]
mat_Sqrt:  [[0.15]]
grads:  [0.15738565]
Stock Position:  0.1573856532525847
Bond Position:  [-18.19866237]


portfolio before change:  [-2.8767318]
curr_Stock_Price:  97.36000519335512
curr_Factors:  [97.36000519]
mat_Sqrt:  [[0.15]]
grads:  [0.02385628]
Stock Position:  0.023856284355623217
Bond Position:  [-5.19937977]


portfolio before change:  [-2.86006998]
curr_Stock_Price:  98.07205225406892
curr_Factors:  [98.07205225]
mat_Sqrt:  [[0.15]]
grads:  [-0.10520229]
Stock Position:  -0.10520229205427742
Bond Position:  [7.45733471]


portfolio before change:  [-2.84462562]
curr_Stock_Price:  97.92967644332768
curr_Factors:  [97.92967644]
mat_Sqrt:  [[0.15]]
grads:  [-0.03744058]
Stock Position:  -0.037440582326120936
Bond Position:  [0.82191849]


portfolio before change:  [-2.85234844]
curr_Stock_Price:  98.13731719050317
curr_Factors:  [98.13731719]
mat_Sqrt:  [[0.15]]
grads:  [0.00708411]
Stock Position:  0.007084109649241727
Bond Position:  [-3.54756395]


portfolio before change:  [-2.85340396]
curr_Stock_Price:  98.01961835704913
curr_Factors:  [98.01961836]
mat_Sqrt:  [[0.15]]
grads:  [0.05055209]
Stock Position:  0.0505520866906139
Bond Position:  [-7.8085002]


portfolio before change:  [-2.84633882]
curr_Stock_Price:  98.16903217041988
curr_Factors:  [98.16903217]
mat_Sqrt:  [[0.15]]
grads:  [0.00010475]
Stock Position:  0.00010474778551273697
Bond Position:  [-2.85662181]


portfolio before change:  [-2.84652477]
curr_Stock_Price:  98.09833428707259
curr_Factors:  [98.09833429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00987365]
Stock Position:  -0.009873651315351964
Bond Position:  [-1.87793603]


portfolio before change:  [-2.84792517]
curr_Stock_Price:  98.2282784900132
curr_Factors:  [98.22827849]
mat_Sqrt:  [[0.15]]
grads:  [-0.01156889]
Stock Position:  -0.011568889291866693
Bond Position:  [-1.71153309]


portfolio before change:  [-2.85391843]
curr_Stock_Price:  98.73708136441427
curr_Factors:  [98.73708136]
mat_Sqrt:  [[0.15]]
grads:  [-0.15926153]
Stock Position:  -0.1592615316733964
Bond Position:  [12.87110038]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.77869024]
Stock Price:  98.26977630964416
PL:  [-2.77869024]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.05042029e-03]
 [ 9.14347075e-03]
 [ 3.10812539e-03]
 [-1.08713000e-02]
 [ 1.25840852e-02]
 [-5.39247152e-03]
 [ 2.68104886e-04]
 [-1.02362469e-02]
 [ 1.16371348e-02]
 [-5.38101053e-03]
 [-8.59125977e-03]
 [ 3.27444688e-03]
 [-2.55772372e-03]
 [ 9.79862665e-03]
 [-1.52022392e-03]
 [ 1.52252568e-02]
 [ 4.74481363e-02]
 [-1.46152232e-02]
 [ 1.88675610e-02]
 [ 2.04531218e-03]
 [-4.24190043e-03]
 [ 4.51981231e-03]
 [ 1.54205452e-02]
 [ 1.91256523e-02]
 [-4.16442842e-03]
 [ 4.54911976e-03]
 [ 9.62427061e-03]
 [ 9.05398680e-03]
 [ 1.59084528e-02]
 [ 1.88877689e-03]
 [-6.41981000e-03]
 [ 1.01001157e-02]
 [ 1.18717272e-02]
 [-8.82566286e-03]
 [ 2.06652188e-03]
 [ 1.52418384e-02]
 [-6.30324537e-03]
 [ 2.50830664e-03]
 [-4.24871895e-02]
 [-1.26003707e-02]
 [ 6.63806171e-03]
 [ 9.89233616e-04]
 [-1.50229365e-03]
 [-1.53034342e-03]
 [-1.10719707e-02]
 [ 1.64458185e-02]
 [ 1.00745975e-02]
 [ 5.28227091e-03]
 [-1.34590104e-03]
 [-5.55080872e-04]
 [-6.25186023e-03]
 [ 1.68127426e-03]
 [ 7.84191129e-04]
 [ 7.74476169e-03]
 [-1.05216001e-02]
 [-4.88615976e-03]
 [-1.22730183e-03]
 [ 1.22667795e-02]
 [ 7.20376701e-03]
 [-3.29636510e-03]
 [-3.87180223e-03]
 [ 6.94812946e-04]
 [-4.83737752e-03]
 [-1.40059655e-03]
 [ 1.88631175e-02]
 [ 5.96155900e-03]
 [ 1.96395798e-02]
 [-2.79288187e-03]
 [ 5.01821510e-03]
 [ 2.31629764e-02]
 [ 3.55774305e-03]
 [-1.58834692e-02]
 [-6.44990194e-03]
 [ 1.07463337e-03]
 [ 6.16735252e-03]
 [-2.60340573e-04]
 [-1.43803898e-03]
 [ 5.00680674e-03]
 [-2.39837071e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.27115618]
curr_Stock_Price:  100.51055429561906
curr_Factors:  [100.5105543]
mat_Sqrt:  [[0.15]]
grads:  [-0.0270028]
Stock Position:  -0.02700280195157352
Bond Position:  [15.98522277]


portfolio before change:  [13.28797475]
curr_Stock_Price:  99.9247090318155
curr_Factors:  [99.92470903]
mat_Sqrt:  [[0.15]]
grads:  [0.06095647]
Stock Position:  0.06095647165940857
Bond Position:  [7.19691706]


portfolio before change:  [13.28566504]
curr_Stock_Price:  99.87943850106826
curr_Factors:  [99.8794385]
mat_Sqrt:  [[0.15]]
grads:  [0.02072084]
Stock Position:  0.02072083596069923
Bond Position:  [11.21607958]


portfolio before change:  [13.26912094]
curr_Stock_Price:  99.04717817387022
curr_Factors:  [99.04717817]
mat_Sqrt:  [[0.15]]
grads:  [-0.07247533]
Stock Position:  -0.07247533355356253
Bond Position:  [20.44759822]


portfolio before change:  [13.19725166]
curr_Stock_Price:  100.05644976889856
curr_Factors:  [100.05644977]
mat_Sqrt:  [[0.15]]
grads:  [0.0838939]
Stock Position:  0.08389390124747016
Bond Position:  [4.80312574]


portfolio before change:  [13.19868086]
curr_Stock_Price:  100.06990712928459
curr_Factors:  [100.06990713]
mat_Sqrt:  [[0.15]]
grads:  [-0.03594981]
Stock Position:  -0.035949810120400126
Bond Position:  [16.79617502]


portfolio before change:  [13.19382534]
curr_Stock_Price:  100.23417241473257
curr_Factors:  [100.23417241]
mat_Sqrt:  [[0.15]]
grads:  [0.00178737]
Stock Position:  0.0017873659066260674
Bond Position:  [13.0146702]


portfolio before change:  [13.19463271]
curr_Stock_Price:  100.2307731172078
curr_Factors:  [100.23077312]
mat_Sqrt:  [[0.15]]
grads:  [-0.06824165]
Stock Position:  -0.06824164598895553
Bond Position:  [20.03454565]


portfolio before change:  [13.12936696]
curr_Stock_Price:  101.20551434056132
curr_Factors:  [101.20551434]
mat_Sqrt:  [[0.15]]
grads:  [0.0775809]
Stock Position:  0.07758089889642504
Bond Position:  [5.27775219]


portfolio before change:  [13.16336814]
curr_Stock_Price:  101.63952971737106
curr_Factors:  [101.63952972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0358734]
Stock Position:  -0.035873403552117135
Bond Position:  [16.809524]


portfolio before change:  [13.17836412]
curr_Stock_Price:  101.25079160860857
curr_Factors:  [101.25079161]
mat_Sqrt:  [[0.15]]
grads:  [-0.05727507]
Stock Position:  -0.05727506515928897
Bond Position:  [18.97750981]


portfolio before change:  [13.20643283]
curr_Stock_Price:  100.78143247083415
curr_Factors:  [100.78143247]
mat_Sqrt:  [[0.15]]
grads:  [0.02182965]
Stock Position:  0.021829645864180985
Bond Position:  [11.00640985]


portfolio before change:  [13.19885613]
curr_Stock_Price:  100.40283641552062
curr_Factors:  [100.40283642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01705149]
Stock Position:  -0.017051491475722144
Bond Position:  [14.91087424]


portfolio before change:  [13.20624196]
curr_Stock_Price:  100.02434357899014
curr_Factors:  [100.02434358]
mat_Sqrt:  [[0.15]]
grads:  [0.06532418]
Stock Position:  0.06532417768253165
Bond Position:  [6.67223397]


portfolio before change:  [13.21539811]
curr_Stock_Price:  100.15812443423548
curr_Factors:  [100.15812443]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013483]
Stock Position:  -0.010134826121775617
Bond Position:  [14.23048329]


portfolio before change:  [13.21109868]
curr_Stock_Price:  100.67010762096837
curr_Factors:  [100.67010762]
mat_Sqrt:  [[0.15]]
grads:  [0.10150171]
Stock Position:  0.10150171181943297
Bond Position:  [2.99291043]


portfolio before change:  [13.21363213]
curr_Stock_Price:  100.69322431401768
curr_Factors:  [100.69322431]
mat_Sqrt:  [[0.15]]
grads:  [0.31632091]
Stock Position:  0.3163209087656179
Bond Position:  [-18.63774009]


portfolio before change:  [13.24383571]
curr_Stock_Price:  100.79239092980966
curr_Factors:  [100.79239093]
mat_Sqrt:  [[0.15]]
grads:  [-0.09743482]
Stock Position:  -0.09743482139057914
Bond Position:  [23.06452432]


portfolio before change:  [13.27594763]
curr_Stock_Price:  100.47761292120063
curr_Factors:  [100.47761292]
mat_Sqrt:  [[0.15]]
grads:  [0.12578374]
Stock Position:  0.12578373979823446
Bond Position:  [0.63749771]


portfolio before change:  [13.31338456]
curr_Stock_Price:  100.77492548754863
curr_Factors:  [100.77492549]
mat_Sqrt:  [[0.15]]
grads:  [0.01363541]
Stock Position:  0.01363541455551107
Bond Position:  [11.93927667]


portfolio before change:  [13.30639374]
curr_Stock_Price:  100.20750261520989
curr_Factors:  [100.20750262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02827934]
Stock Position:  -0.028279336198893355
Bond Position:  [16.1401954]


portfolio before change:  [13.27795213]
curr_Stock_Price:  101.24891341767302
curr_Factors:  [101.24891342]
mat_Sqrt:  [[0.15]]
grads:  [0.03013208]
Stock Position:  0.030132082052519295
Bond Position:  [10.22711156]


portfolio before change:  [13.25581531]
curr_Stock_Price:  100.49304041320296
curr_Factors:  [100.49304041]
mat_Sqrt:  [[0.15]]
grads:  [0.10280363]
Stock Position:  0.10280363482289455
Bond Position:  [2.92476549]


portfolio before change:  [13.28239118]
curr_Stock_Price:  100.74977320997671
curr_Factors:  [100.74977321]
mat_Sqrt:  [[0.15]]
grads:  [0.12750435]
Stock Position:  0.12750434862815843
Bond Position:  [0.43635698]


portfolio before change:  [13.22812166]
curr_Stock_Price:  100.32393049104147
curr_Factors:  [100.32393049]
mat_Sqrt:  [[0.15]]
grads:  [-0.02776286]
Stock Position:  -0.02776285616550135
Bond Position:  [16.01340051]


portfolio before change:  [13.24476132]
curr_Stock_Price:  99.7606313265358
curr_Factors:  [99.76063133]
mat_Sqrt:  [[0.15]]
grads:  [0.03032747]
Stock Position:  0.03032746507872626
Bond Position:  [10.21927426]


portfolio before change:  [13.20957736]
curr_Stock_Price:  98.57943532195617
curr_Factors:  [98.57943532]
mat_Sqrt:  [[0.15]]
grads:  [0.0641618]
Stock Position:  0.06416180409721617
Bond Position:  [6.88454295]


portfolio before change:  [13.1766858]
curr_Stock_Price:  98.06009418263505
curr_Factors:  [98.06009418]
mat_Sqrt:  [[0.15]]
grads:  [0.06035991]
Stock Position:  0.060359911992389784
Bond Position:  [7.25778714]


portfolio before change:  [13.17897761]
curr_Stock_Price:  98.09054789454895
curr_Factors:  [98.09054789]
mat_Sqrt:  [[0.15]]
grads:  [0.10605635]
Stock Position:  0.10605635192252541
Bond Position:  [2.77585194]


portfolio before change:  [13.32166746]
curr_Stock_Price:  99.43432742201995
curr_Factors:  [99.43432742]
mat_Sqrt:  [[0.15]]
grads:  [0.01259185]
Stock Position:  0.012591845923404302
Bond Position:  [12.06960573]


portfolio before change:  [13.31065015]
curr_Stock_Price:  98.4994624076642
curr_Factors:  [98.49946241]
mat_Sqrt:  [[0.15]]
grads:  [-0.04279873]
Stock Position:  -0.042798733316725644
Bond Position:  [17.52630238]


portfolio before change:  [13.29195761]
curr_Stock_Price:  98.96181187610452
curr_Factors:  [98.96181188]
mat_Sqrt:  [[0.15]]
grads:  [0.0673341]
Stock Position:  0.06733410492758712
Bond Position:  [6.62845259]


portfolio before change:  [13.33562057]
curr_Stock_Price:  99.60411143482784
curr_Factors:  [99.60411143]
mat_Sqrt:  [[0.15]]
grads:  [0.07914485]
Stock Position:  0.07914484777357793
Bond Position:  [5.45246833]


portfolio before change:  [13.32351313]
curr_Stock_Price:  99.44682726935437
curr_Factors:  [99.44682727]
mat_Sqrt:  [[0.15]]
grads:  [-0.05883775]
Stock Position:  -0.05883775237034289
Bond Position:  [19.17474092]


portfolio before change:  [13.34541278]
curr_Stock_Price:  99.09499207881396
curr_Factors:  [99.09499208]
mat_Sqrt:  [[0.15]]
grads:  [0.01377681]
Stock Position:  0.013776812566136607
Bond Position:  [11.98019965]


portfolio before change:  [13.35654341]
curr_Stock_Price:  99.84856581309796
curr_Factors:  [99.84856581]
mat_Sqrt:  [[0.15]]
grads:  [0.10161226]
Stock Position:  0.10161225591885588
Bond Position:  [3.21070538]


portfolio before change:  [13.32320783]
curr_Stock_Price:  99.51852440548791
curr_Factors:  [99.51852441]
mat_Sqrt:  [[0.15]]
grads:  [-0.04202164]
Stock Position:  -0.04202163578369347
Bond Position:  [17.50513902]


portfolio before change:  [13.28141531]
curr_Stock_Price:  100.53910877361767
curr_Factors:  [100.53910877]
mat_Sqrt:  [[0.15]]
grads:  [0.01672204]
Stock Position:  0.016722044294993542
Bond Position:  [11.60019588]


portfolio before change:  [13.29843701]
curr_Stock_Price:  101.51367019468044
curr_Factors:  [101.51367019]
mat_Sqrt:  [[0.15]]
grads:  [-0.28324793]
Stock Position:  -0.2832479299985464
Bond Position:  [42.05197395]


portfolio before change:  [13.13135418]
curr_Stock_Price:  102.11283135299071
curr_Factors:  [102.11283135]
mat_Sqrt:  [[0.15]]
grads:  [-0.08400247]
Stock Position:  -0.08400247154905777
Bond Position:  [21.70908439]


portfolio before change:  [13.24086165]
curr_Stock_Price:  100.82536195953607
curr_Factors:  [100.82536196]
mat_Sqrt:  [[0.15]]
grads:  [0.04425374]
Stock Position:  0.04425374473415871
Bond Position:  [8.77896182]


portfolio before change:  [13.22270184]
curr_Stock_Price:  100.40260658827506
curr_Factors:  [100.40260659]
mat_Sqrt:  [[0.15]]
grads:  [0.00659489]
Stock Position:  0.0065948907735700665
Bond Position:  [12.56055762]


portfolio before change:  [13.21974241]
curr_Stock_Price:  99.83482037303251
curr_Factors:  [99.83482037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01001529]
Stock Position:  -0.010015291021577395
Bond Position:  [14.21961719]


portfolio before change:  [13.22589022]
curr_Stock_Price:  99.30971772042534
curr_Factors:  [99.30971772]
mat_Sqrt:  [[0.15]]
grads:  [-0.01020229]
Stock Position:  -0.010202289455688612
Bond Position:  [14.23907671]


portfolio before change:  [13.2428739]
curr_Stock_Price:  97.73225801818246
curr_Factors:  [97.73225802]
mat_Sqrt:  [[0.15]]
grads:  [-0.07381314]
Stock Position:  -0.07381313780553185
Bond Position:  [20.45679852]


portfolio before change:  [13.22696712]
curr_Stock_Price:  97.96508062343757
curr_Factors:  [97.96508062]
mat_Sqrt:  [[0.15]]
grads:  [0.10963879]
Stock Position:  0.10963878989089042
Bond Position:  [2.48619423]


portfolio before change:  [13.18409624]
curr_Stock_Price:  97.57264410476039
curr_Factors:  [97.5726441]
mat_Sqrt:  [[0.15]]
grads:  [0.06716398]
Stock Position:  0.06716398319624699
Bond Position:  [6.63072882]


portfolio before change:  [13.19196041]
curr_Stock_Price:  97.6835627285108
curr_Factors:  [97.68356273]
mat_Sqrt:  [[0.15]]
grads:  [0.03521514]
Stock Position:  0.03521513942069376
Bond Position:  [9.75202013]


portfolio before change:  [13.21976872]
curr_Stock_Price:  98.45592337417182
curr_Factors:  [98.45592337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00897267]
Stock Position:  -0.008972673629744245
Bond Position:  [14.10318159]


portfolio before change:  [13.22767071]
curr_Stock_Price:  97.67349136889501
curr_Factors:  [97.67349137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00370054]
Stock Position:  -0.003700539146385933
Bond Position:  [13.58911528]


portfolio before change:  [13.22589564]
curr_Stock_Price:  98.38268938439529
curr_Factors:  [98.38268938]
mat_Sqrt:  [[0.15]]
grads:  [-0.04167907]
Stock Position:  -0.04167906821643507
Bond Position:  [17.32639446]


portfolio before change:  [13.24594659]
curr_Stock_Price:  97.92759228067955
curr_Factors:  [97.92759228]
mat_Sqrt:  [[0.15]]
grads:  [0.0112085]
Stock Position:  0.011208495044582578
Bond Position:  [12.14832566]


portfolio before change:  [13.24187927]
curr_Stock_Price:  97.49697049478722
curr_Factors:  [97.49697049]
mat_Sqrt:  [[0.15]]
grads:  [0.00522794]
Stock Position:  0.0052279408609331125
Bond Position:  [12.73217087]


portfolio before change:  [13.23883707]
curr_Stock_Price:  96.7628411728425
curr_Factors:  [96.76284117]
mat_Sqrt:  [[0.15]]
grads:  [0.05163174]
Stock Position:  0.051631744579022254
Bond Position:  [8.24280277]


portfolio before change:  [13.22972231]
curr_Stock_Price:  96.57632898436655
curr_Factors:  [96.57632898]
mat_Sqrt:  [[0.15]]
grads:  [-0.070144]
Stock Position:  -0.07014400047769513
Bond Position:  [20.00397238]


portfolio before change:  [13.23449868]
curr_Stock_Price:  96.5260597263099
curr_Factors:  [96.52605973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0325744]
Stock Position:  -0.032574398421405255
Bond Position:  [16.37877701]


portfolio before change:  [13.22544571]
curr_Stock_Price:  96.83540327904673
curr_Factors:  [96.83540328]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818201]
Stock Position:  -0.008182012225085928
Bond Position:  [14.01775416]


portfolio before change:  [13.22250595]
curr_Stock_Price:  97.301779486909
curr_Factors:  [97.30177949]
mat_Sqrt:  [[0.15]]
grads:  [0.08177853]
Stock Position:  0.08177853000898061
Bond Position:  [5.26530946]


portfolio before change:  [13.13484323]
curr_Stock_Price:  96.22580251396519
curr_Factors:  [96.22580251]
mat_Sqrt:  [[0.15]]
grads:  [0.04802511]
Stock Position:  0.04802511339597228
Bond Position:  [8.51358815]


portfolio before change:  [13.16999241]
curr_Stock_Price:  96.94661419365926
curr_Factors:  [96.94661419]
mat_Sqrt:  [[0.15]]
grads:  [-0.02197577]
Stock Position:  -0.021975767317308888
Bond Position:  [15.30046864]


portfolio before change:  [13.14643931]
curr_Stock_Price:  98.06190672195778
curr_Factors:  [98.06190672]
mat_Sqrt:  [[0.15]]
grads:  [-0.02581201]
Stock Position:  -0.02581201483821999
Bond Position:  [15.6776147]


portfolio before change:  [13.14006532]
curr_Stock_Price:  98.34680750179062
curr_Factors:  [98.3468075]
mat_Sqrt:  [[0.15]]
grads:  [0.00463209]
Stock Position:  0.004632086306961009
Bond Position:  [12.68451442]


portfolio before change:  [13.13685507]
curr_Stock_Price:  97.48260529486373
curr_Factors:  [97.48260529]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224918]
Stock Position:  -0.0322491834944771
Bond Position:  [16.2805895]


portfolio before change:  [13.14406043]
curr_Stock_Price:  97.29073097769334
curr_Factors:  [97.29073098]
mat_Sqrt:  [[0.15]]
grads:  [-0.00933731]
Stock Position:  -0.009337310352542953
Bond Position:  [14.05249418]


portfolio before change:  [13.1531143]
curr_Stock_Price:  96.4151512172451
curr_Factors:  [96.41515122]
mat_Sqrt:  [[0.15]]
grads:  [0.12575412]
Stock Position:  0.12575411671868733
Bond Position:  [1.02851212]


portfolio before change:  [13.07454148]
curr_Stock_Price:  95.78982691808389
curr_Factors:  [95.78982692]
mat_Sqrt:  [[0.15]]
grads:  [0.03974373]
Stock Position:  0.03974372663363545
Bond Position:  [9.26749678]


portfolio before change:  [13.07414091]
curr_Stock_Price:  95.76517392125459
curr_Factors:  [95.76517392]
mat_Sqrt:  [[0.15]]
grads:  [0.13093053]
Stock Position:  0.1309305318955759
Bond Position:  [0.53555575]


portfolio before change:  [13.10997426]
curr_Stock_Price:  96.03860038008038
curr_Factors:  [96.03860038]
mat_Sqrt:  [[0.15]]
grads:  [-0.01861921]
Stock Position:  -0.018619212456107887
Bond Position:  [14.89813736]


portfolio before change:  [13.10015918]
curr_Stock_Price:  96.61575922743971
curr_Factors:  [96.61575923]
mat_Sqrt:  [[0.15]]
grads:  [0.03345477]
Stock Position:  0.033454767315490144
Bond Position:  [9.86790143]


portfolio before change:  [13.12663931]
curr_Stock_Price:  97.3888438613834
curr_Factors:  [97.38884386]
mat_Sqrt:  [[0.15]]
grads:  [0.15441984]
Stock Position:  0.15441984243867363
Bond Position:  [-1.91213062]


portfolio before change:  [13.18840744]
curr_Stock_Price:  97.78961906545078
curr_Factors:  [97.78961907]
mat_Sqrt:  [[0.15]]
grads:  [0.02371829]
Stock Position:  0.02371828699876479
Bond Position:  [10.86900519]


portfolio before change:  [13.211596]
curr_Stock_Price:  98.73864320788158
curr_Factors:  [98.73864321]
mat_Sqrt:  [[0.15]]
grads:  [-0.10588979]
Stock Position:  -0.10588979463464844
Bond Position:  [23.66701065]


portfolio before change:  [13.22593998]
curr_Stock_Price:  98.6171513410542
curr_Factors:  [98.61715134]
mat_Sqrt:  [[0.15]]
grads:  [-0.04299935]
Stock Position:  -0.042999346288936764
Bond Position:  [17.46641302]


portfolio before change:  [13.20734308]
curr_Stock_Price:  99.07503250370398
curr_Factors:  [99.0750325]
mat_Sqrt:  [[0.15]]
grads:  [0.00716422]
Stock Position:  0.0071642224818564
Bond Position:  [12.4975475]


portfolio before change:  [13.20308704]
curr_Stock_Price:  98.37193416932622
curr_Factors:  [98.37193417]
mat_Sqrt:  [[0.15]]
grads:  [0.04111568]
Stock Position:  0.04111568347875074
Bond Position:  [9.15845774]


portfolio before change:  [13.20885855]
curr_Stock_Price:  98.4983843869365
curr_Factors:  [98.49838439]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017356]
Stock Position:  -0.0017356038210386792
Bond Position:  [13.37981273]


portfolio before change:  [13.20943267]
curr_Stock_Price:  98.64942416422788
curr_Factors:  [98.64942416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958693]
Stock Position:  -0.009586926518281089
Bond Position:  [14.15517745]


portfolio before change:  [13.2042532]
curr_Stock_Price:  99.281973025248
curr_Factors:  [99.28197303]
mat_Sqrt:  [[0.15]]
grads:  [0.03337871]
Stock Position:  0.0333787116083462
Bond Position:  [9.89034885]


portfolio before change:  [13.19254463]
curr_Stock_Price:  98.91267371234737
curr_Factors:  [98.91267371]
mat_Sqrt:  [[0.15]]
grads:  [-0.15989138]
Stock Position:  -0.1598913806499062
Bond Position:  [29.00782859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.25531098]
Stock Price:  98.53145676847727
PL:  [13.25531098]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.20528363e-03]
 [-1.92755298e-02]
 [ 4.58339711e-02]
 [-1.18364730e-02]
 [ 1.10057889e-02]
 [-1.52523703e-02]
 [-1.35247171e-02]
 [ 9.04623032e-03]
 [-1.76666131e-02]
 [-1.25286334e-02]
 [ 1.29786409e-02]
 [-6.17334365e-03]
 [-3.01632851e-03]
 [ 6.47993932e-03]
 [-1.59214676e-03]
 [ 1.46983509e-02]
 [ 9.08050216e-02]
 [-1.30262492e-02]
 [ 1.92674733e-02]
 [ 1.40898874e-03]
 [-4.83493806e-03]
 [ 4.99332183e-03]
 [ 7.40357318e-03]
 [ 4.22028610e-02]
 [ 3.16613475e-03]
 [ 7.58115475e-03]
 [ 3.04279682e-02]
 [ 2.42142641e-02]
 [ 1.15353697e-02]
 [-9.07416752e-03]
 [ 4.33935930e-03]
 [ 1.53958850e-02]
 [ 1.55678928e-02]
 [-9.18657727e-03]
 [ 4.21966005e-03]
 [-7.52138549e-03]
 [-9.47604429e-03]
 [-1.68704346e-02]
 [ 4.09963755e-03]
 [-3.48790080e-02]
 [ 3.52954661e-03]
 [ 4.78122060e-03]
 [-1.25543266e-02]
 [ 1.08076713e-02]
 [-2.48174552e-03]
 [ 1.16190214e-02]
 [ 1.05655154e-02]
 [-2.18249772e-03]
 [ 1.26969727e-02]
 [-1.34494256e-03]
 [ 2.16601968e-02]
 [-6.34751953e-03]
 [-8.88338510e-04]
 [-1.97316891e-02]
 [-7.86173942e-03]
 [-2.76008364e-03]
 [ 1.06691210e-02]
 [-1.31283884e-02]
 [ 5.06963816e-03]
 [-3.62082860e-03]
 [-4.57826723e-03]
 [ 4.03301665e-03]
 [-1.95783412e-02]
 [ 1.25463092e-03]
 [ 1.91154448e-02]
 [ 9.40994939e-03]
 [ 8.40827070e-03]
 [ 1.13858871e-02]
 [ 7.04553588e-03]
 [ 1.13305165e-02]
 [ 9.84391562e-04]
 [-1.53710859e-02]
 [-4.03523242e-03]
 [ 1.08839656e-03]
 [ 3.84357790e-03]
 [-1.52789524e-02]
 [-3.40220086e-03]
 [ 1.25365723e-02]
 [-4.75945726e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.74378856]
curr_Stock_Price:  100.16867668389986
curr_Factors:  [100.16867668]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136856]
Stock Position:  -0.04136855752789117
Bond Position:  [9.88762222]


portfolio before change:  [5.79464726]
curr_Stock_Price:  98.95421068913502
curr_Factors:  [98.95421069]
mat_Sqrt:  [[0.15]]
grads:  [-0.12850353]
Stock Position:  -0.12850353176147972
Bond Position:  [18.51061282]


portfolio before change:  [5.84918361]
curr_Stock_Price:  98.53881821261278
curr_Factors:  [98.53881821]
mat_Sqrt:  [[0.15]]
grads:  [0.30555981]
Stock Position:  0.3055598075916678
Bond Position:  [-24.26031872]


portfolio before change:  [5.95194729]
curr_Stock_Price:  98.88009345366447
curr_Factors:  [98.88009345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07890982]
Stock Position:  -0.07890982025325134
Bond Position:  [13.75455769]


portfolio before change:  [6.00613485]
curr_Stock_Price:  98.20428568562369
curr_Factors:  [98.20428569]
mat_Sqrt:  [[0.15]]
grads:  [0.07337193]
Stock Position:  0.07337192628784378
Bond Position:  [-1.19930276]


portfolio before change:  [6.01321175]
curr_Stock_Price:  98.30175970773756
curr_Factors:  [98.30175971]
mat_Sqrt:  [[0.15]]
grads:  [-0.10168247]
Stock Position:  -0.10168246860708093
Bond Position:  [16.00877734]


portfolio before change:  [6.01842053]
curr_Stock_Price:  98.26037398515544
curr_Factors:  [98.26037399]
mat_Sqrt:  [[0.15]]
grads:  [-0.09016478]
Stock Position:  -0.09016478095236509
Bond Position:  [14.87804562]


portfolio before change:  [5.94305093]
curr_Stock_Price:  99.10659691509251
curr_Factors:  [99.10659692]
mat_Sqrt:  [[0.15]]
grads:  [0.0603082]
Stock Position:  0.06030820216241489
Bond Position:  [-0.03388975]


portfolio before change:  [5.92488126]
curr_Stock_Price:  98.80535185381972
curr_Factors:  [98.80535185]
mat_Sqrt:  [[0.15]]
grads:  [-0.11777742]
Stock Position:  -0.11777742087384267
Bond Position:  [17.56192077]


portfolio before change:  [5.9172788]
curr_Stock_Price:  98.87922103639038
curr_Factors:  [98.87922104]
mat_Sqrt:  [[0.15]]
grads:  [-0.08352422]
Stock Position:  -0.08352422288247441
Bond Position:  [14.17608889]


portfolio before change:  [5.89838407]
curr_Stock_Price:  99.11604761173349
curr_Factors:  [99.11604761]
mat_Sqrt:  [[0.15]]
grads:  [0.08652427]
Stock Position:  0.0865242728446452
Bond Position:  [-2.67755987]


portfolio before change:  [5.91888873]
curr_Stock_Price:  99.35496337872037
curr_Factors:  [99.35496338]
mat_Sqrt:  [[0.15]]
grads:  [-0.04115562]
Stock Position:  -0.041155624360439326
Bond Position:  [10.00790428]


portfolio before change:  [5.86243096]
curr_Stock_Price:  100.74197409111969
curr_Factors:  [100.74197409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010886]
Stock Position:  -0.02010885674175347
Bond Position:  [7.88823688]


portfolio before change:  [5.86145715]
curr_Stock_Price:  100.81491867821134
curr_Factors:  [100.81491868]
mat_Sqrt:  [[0.15]]
grads:  [0.0431996]
Stock Position:  0.04319959549686242
Bond Position:  [1.50629345]


portfolio before change:  [5.86256918]
curr_Stock_Price:  100.83848097652579
curr_Factors:  [100.83848098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061431]
Stock Position:  -0.010614311728059898
Bond Position:  [6.93290025]


portfolio before change:  [5.85597482]
curr_Stock_Price:  101.50057624452232
curr_Factors:  [101.50057624]
mat_Sqrt:  [[0.15]]
grads:  [0.09798901]
Stock Position:  0.09798900579636931
Bond Position:  [-4.08996574]


portfolio before change:  [5.89560239]
curr_Stock_Price:  101.90759340680285
curr_Factors:  [101.90759341]
mat_Sqrt:  [[0.15]]
grads:  [0.60536681]
Stock Position:  0.605366810609742
Bond Position:  [-55.79587241]


portfolio before change:  [5.82541802]
curr_Stock_Price:  101.79741720343554
curr_Factors:  [101.7974172]
mat_Sqrt:  [[0.15]]
grads:  [-0.08684166]
Stock Position:  -0.08684166153011526
Bond Position:  [14.66567487]


portfolio before change:  [5.83079648]
curr_Stock_Price:  101.74603832171394
curr_Factors:  [101.74603832]
mat_Sqrt:  [[0.15]]
grads:  [0.12844982]
Stock Position:  0.12844982188667614
Bond Position:  [-7.23846402]


portfolio before change:  [5.80649927]
curr_Stock_Price:  101.56040318435207
curr_Factors:  [101.56040318]
mat_Sqrt:  [[0.15]]
grads:  [0.00939326]
Stock Position:  0.009393258261541311
Bond Position:  [4.85251617]


portfolio before change:  [5.80968331]
curr_Stock_Price:  101.86708630853278
curr_Factors:  [101.86708631]
mat_Sqrt:  [[0.15]]
grads:  [-0.03223292]
Stock Position:  -0.032232920421513225
Bond Position:  [9.093157]


portfolio before change:  [5.80748535]
curr_Stock_Price:  101.95290861828255
curr_Factors:  [101.95290862]
mat_Sqrt:  [[0.15]]
grads:  [0.03328881]
Stock Position:  0.03328881220624372
Bond Position:  [2.41359412]


portfolio before change:  [5.82668592]
curr_Stock_Price:  102.52516452829197
curr_Factors:  [102.52516453]
mat_Sqrt:  [[0.15]]
grads:  [0.04935715]
Stock Position:  0.049357154539538775
Bond Position:  [0.76633553]


portfolio before change:  [5.85897382]
curr_Stock_Price:  103.17836267844999
curr_Factors:  [103.17836268]
mat_Sqrt:  [[0.15]]
grads:  [0.28135241]
Stock Position:  0.28135240697463654
Bond Position:  [-23.17050687]


portfolio before change:  [5.85301767]
curr_Stock_Price:  103.16234024166147
curr_Factors:  [103.16234024]
mat_Sqrt:  [[0.15]]
grads:  [0.02110756]
Stock Position:  0.02110756497561375
Bond Position:  [3.67551187]


portfolio before change:  [5.85782462]
curr_Stock_Price:  103.3791927912557
curr_Factors:  [103.37919279]
mat_Sqrt:  [[0.15]]
grads:  [0.05054103]
Stock Position:  0.05054103169291842
Bond Position:  [0.63293357]


portfolio before change:  [5.84838351]
curr_Stock_Price:  103.19160914681
curr_Factors:  [103.19160915]
mat_Sqrt:  [[0.15]]
grads:  [0.20285312]
Stock Position:  0.20285312100676656
Bond Position:  [-15.08435646]


portfolio before change:  [5.90976494]
curr_Stock_Price:  103.49884734978995
curr_Factors:  [103.49884735]
mat_Sqrt:  [[0.15]]
grads:  [0.16142843]
Stock Position:  0.1614284271224882
Bond Position:  [-10.7978912]


portfolio before change:  [5.94984248]
curr_Stock_Price:  103.75129627074807
curr_Factors:  [103.75129627]
mat_Sqrt:  [[0.15]]
grads:  [0.07690246]
Stock Position:  0.07690246474254435
Bond Position:  [-2.02888792]


portfolio before change:  [6.01279147]
curr_Stock_Price:  104.57150142521485
curr_Factors:  [104.57150143]
mat_Sqrt:  [[0.15]]
grads:  [-0.06049445]
Stock Position:  -0.06049445013907769
Bond Position:  [12.33878695]


portfolio before change:  [6.0271693]
curr_Stock_Price:  104.3465777283645
curr_Factors:  [104.34657773]
mat_Sqrt:  [[0.15]]
grads:  [0.02892906]
Stock Position:  0.028929062014051387
Bond Position:  [3.00852069]


portfolio before change:  [6.03259174]
curr_Stock_Price:  104.52751693639043
curr_Factors:  [104.52751694]
mat_Sqrt:  [[0.15]]
grads:  [0.10263923]
Stock Position:  0.10263923355358709
Bond Position:  [-4.69603248]


portfolio before change:  [6.0185274]
curr_Stock_Price:  104.39334959081826
curr_Factors:  [104.39334959]
mat_Sqrt:  [[0.15]]
grads:  [0.10378595]
Stock Position:  0.10378595225776752
Bond Position:  [-4.8160358]


portfolio before change:  [6.06553233]
curr_Stock_Price:  104.84915249082628
curr_Factors:  [104.84915249]
mat_Sqrt:  [[0.15]]
grads:  [-0.06124385]
Stock Position:  -0.06124384848523867
Bond Position:  [12.48689794]


portfolio before change:  [6.07318522]
curr_Stock_Price:  104.73693821328706
curr_Factors:  [104.73693821]
mat_Sqrt:  [[0.15]]
grads:  [0.02813107]
Stock Position:  0.028131066977140837
Bond Position:  [3.12682339]


portfolio before change:  [6.06669866]
curr_Stock_Price:  104.49940773898433
curr_Factors:  [104.49940774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014257]
Stock Position:  -0.05014256992489741
Bond Position:  [11.30656752]


portfolio before change:  [6.0351799]
curr_Stock_Price:  105.14208421079432
curr_Factors:  [105.14208421]
mat_Sqrt:  [[0.15]]
grads:  [-0.06317363]
Stock Position:  -0.06317362861018495
Bond Position:  [12.67738688]


portfolio before change:  [5.97425957]
curr_Stock_Price:  106.11895840609152
curr_Factors:  [106.11895841]
mat_Sqrt:  [[0.15]]
grads:  [-0.11246956]
Stock Position:  -0.11246956412661546
Bond Position:  [17.90941257]


portfolio before change:  [6.08692855]
curr_Stock_Price:  105.12713805274181
curr_Factors:  [105.12713805]
mat_Sqrt:  [[0.15]]
grads:  [0.02733092]
Stock Position:  0.027330917029679224
Bond Position:  [3.21370746]


portfolio before change:  [6.06539618]
curr_Stock_Price:  104.33194961511887
curr_Factors:  [104.33194962]
mat_Sqrt:  [[0.15]]
grads:  [-0.23252672]
Stock Position:  -0.23252671998050822
Bond Position:  [30.32536221]


portfolio before change:  [6.12304617]
curr_Stock_Price:  104.09217246813164
curr_Factors:  [104.09217247]
mat_Sqrt:  [[0.15]]
grads:  [0.02353031]
Stock Position:  0.02353031071192992
Bond Position:  [3.67372501]


portfolio before change:  [6.13533977]
curr_Stock_Price:  104.60487253646309
curr_Factors:  [104.60487254]
mat_Sqrt:  [[0.15]]
grads:  [0.0318748]
Stock Position:  0.03187480399413354
Bond Position:  [2.80107997]


portfolio before change:  [6.12956617]
curr_Stock_Price:  104.41824607925331
curr_Factors:  [104.41824608]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369551]
Stock Position:  -0.08369551097518974
Bond Position:  [14.86890463]


portfolio before change:  [6.11226023]
curr_Stock_Price:  104.63612239758875
curr_Factors:  [104.6361224]
mat_Sqrt:  [[0.15]]
grads:  [0.07205114]
Stock Position:  0.07205114208948356
Bond Position:  [-1.42689189]


portfolio before change:  [6.14003462]
curr_Stock_Price:  105.02284176518705
curr_Factors:  [105.02284177]
mat_Sqrt:  [[0.15]]
grads:  [-0.01654497]
Stock Position:  -0.016544970134928668
Bond Position:  [7.8776344]


portfolio before change:  [6.14739932]
curr_Stock_Price:  104.6074688496299
curr_Factors:  [104.60746885]
mat_Sqrt:  [[0.15]]
grads:  [0.07746014]
Stock Position:  0.07746014239022608
Bond Position:  [-1.95551011]


portfolio before change:  [6.14251763]
curr_Stock_Price:  104.54602471409211
curr_Factors:  [104.54602471]
mat_Sqrt:  [[0.15]]
grads:  [0.07043677]
Stock Position:  0.07043676929479037
Bond Position:  [-1.2213666]


portfolio before change:  [6.08504345]
curr_Stock_Price:  103.7311401114862
curr_Factors:  [103.73114011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01454998]
Stock Position:  -0.014549984800744521
Bond Position:  [7.59432996]


portfolio before change:  [6.08037904]
curr_Stock_Price:  104.08434106436849
curr_Factors:  [104.08434106]
mat_Sqrt:  [[0.15]]
grads:  [0.08464648]
Stock Position:  0.08464648473386324
Bond Position:  [-2.72999455]


portfolio before change:  [6.08155158]
curr_Stock_Price:  104.10020902840076
curr_Factors:  [104.10020903]
mat_Sqrt:  [[0.15]]
grads:  [-0.00896628]
Stock Position:  -0.008966283703325839
Bond Position:  [7.01494359]


portfolio before change:  [6.08993921]
curr_Stock_Price:  103.21364531437453
curr_Factors:  [103.21364531]
mat_Sqrt:  [[0.15]]
grads:  [0.14440131]
Stock Position:  0.1444013118596389
Bond Position:  [-8.81424658]


portfolio before change:  [6.01837672]
curr_Stock_Price:  102.72187982900503
curr_Factors:  [102.72187983]
mat_Sqrt:  [[0.15]]
grads:  [-0.0423168]
Stock Position:  -0.04231679687184547
Bond Position:  [10.36523764]


portfolio before change:  [6.00860437]
curr_Stock_Price:  102.9681223494643
curr_Factors:  [102.96812235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00592226]
Stock Position:  -0.005922256731477973
Bond Position:  [6.61840803]


portfolio before change:  [6.00515471]
curr_Stock_Price:  103.62046172672717
curr_Factors:  [103.62046173]
mat_Sqrt:  [[0.15]]
grads:  [-0.13154459]
Stock Position:  -0.13154459381156133
Bond Position:  [19.63586626]


portfolio before change:  [5.89925387]
curr_Stock_Price:  104.43484806183294
curr_Factors:  [104.43484806]
mat_Sqrt:  [[0.15]]
grads:  [-0.0524116]
Stock Position:  -0.05241159613900132
Bond Position:  [11.37285095]


portfolio before change:  [5.90255266]
curr_Stock_Price:  104.3854704386362
curr_Factors:  [104.38547044]
mat_Sqrt:  [[0.15]]
grads:  [-0.01840056]
Stock Position:  -0.01840055759766628
Bond Position:  [7.82330352]


portfolio before change:  [5.92617236]
curr_Stock_Price:  103.12840380372566
curr_Factors:  [103.1284038]
mat_Sqrt:  [[0.15]]
grads:  [0.07112747]
Stock Position:  0.07112747315615628
Bond Position:  [-1.40909041]


portfolio before change:  [5.93299792]
curr_Stock_Price:  103.22560436342211
curr_Factors:  [103.22560436]
mat_Sqrt:  [[0.15]]
grads:  [-0.08752259]
Stock Position:  -0.08752258901526887
Bond Position:  [14.96757006]


portfolio before change:  [5.94833058]
curr_Stock_Price:  103.06110787652479
curr_Factors:  [103.06110788]
mat_Sqrt:  [[0.15]]
grads:  [0.03379759]
Stock Position:  0.033797587756717595
Bond Position:  [2.46511374]


portfolio before change:  [5.96596106]
curr_Stock_Price:  103.57819821886687
curr_Factors:  [103.57819822]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413886]
Stock Position:  -0.02413885733602793
Bond Position:  [8.46622041]


portfolio before change:  [5.95683332]
curr_Stock_Price:  103.97825440534672
curr_Factors:  [103.97825441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03052178]
Stock Position:  -0.03052178150380902
Bond Position:  [9.13043488]


portfolio before change:  [5.94025214]
curr_Stock_Price:  104.54020873445222
curr_Factors:  [104.54020873]
mat_Sqrt:  [[0.15]]
grads:  [0.02688678]
Stock Position:  0.026886777681547024
Bond Position:  [3.12950279]


portfolio before change:  [5.93769312]
curr_Stock_Price:  104.4377562507745
curr_Factors:  [104.43775625]
mat_Sqrt:  [[0.15]]
grads:  [-0.13052227]
Stock Position:  -0.13052227451473314
Bond Position:  [19.56914661]


portfolio before change:  [6.04382606]
curr_Stock_Price:  103.63398671079939
curr_Factors:  [103.63398671]
mat_Sqrt:  [[0.15]]
grads:  [0.00836421]
Stock Position:  0.008364206163532279
Bond Position:  [5.17701003]


portfolio before change:  [6.04374005]
curr_Stock_Price:  103.58501850481699
curr_Factors:  [103.5850185]
mat_Sqrt:  [[0.15]]
grads:  [0.1274363]
Stock Position:  0.12743629896665468
Bond Position:  [-7.15675133]


portfolio before change:  [5.99027448]
curr_Stock_Price:  103.16898115315895
curr_Factors:  [103.16898115]
mat_Sqrt:  [[0.15]]
grads:  [0.062733]
Stock Position:  0.06273299594656938
Bond Position:  [-0.4818248]


portfolio before change:  [6.03534233]
curr_Stock_Price:  103.88786863355477
curr_Factors:  [103.88786863]
mat_Sqrt:  [[0.15]]
grads:  [0.05605514]
Stock Position:  0.056055137995146304
Bond Position:  [0.21189352]


portfolio before change:  [6.06524244]
curr_Stock_Price:  104.42103770321765
curr_Factors:  [104.4210377]
mat_Sqrt:  [[0.15]]
grads:  [0.07590591]
Stock Position:  0.07590591384640803
Bond Position:  [-1.86093185]


portfolio before change:  [6.07828843]
curr_Stock_Price:  104.59444058943542
curr_Factors:  [104.59444059]
mat_Sqrt:  [[0.15]]
grads:  [0.04697024]
Stock Position:  0.046970239179945215
Bond Position:  [1.16546254]


portfolio before change:  [6.05864747]
curr_Stock_Price:  104.17473217771992
curr_Factors:  [104.17473218]
mat_Sqrt:  [[0.15]]
grads:  [0.07553678]
Stock Position:  0.07553677683151377
Bond Position:  [-1.81037602]


portfolio before change:  [6.01587329]
curr_Stock_Price:  103.6099605109675
curr_Factors:  [103.60996051]
mat_Sqrt:  [[0.15]]
grads:  [0.00656261]
Stock Position:  0.006562610414017316
Bond Position:  [5.33592148]


portfolio before change:  [6.01461325]
curr_Stock_Price:  103.36713867095162
curr_Factors:  [103.36713867]
mat_Sqrt:  [[0.15]]
grads:  [-0.10247391]
Stock Position:  -0.10247390608002734
Bond Position:  [16.60704771]


portfolio before change:  [5.99535225]
curr_Stock_Price:  103.5652278308679
curr_Factors:  [103.56522783]
mat_Sqrt:  [[0.15]]
grads:  [-0.02690155]
Stock Position:  -0.02690154947976451
Bond Position:  [8.78141735]


portfolio before change:  [5.99871454]
curr_Stock_Price:  103.4606454812115
curr_Factors:  [103.46064548]
mat_Sqrt:  [[0.15]]
grads:  [0.00725598]
Stock Position:  0.007255977051595411
Bond Position:  [5.24800647]


portfolio before change:  [5.99603889]
curr_Stock_Price:  103.04668968938539
curr_Factors:  [103.04668969]
mat_Sqrt:  [[0.15]]
grads:  [0.02562385]
Stock Position:  0.02562385263367787
Bond Position:  [3.3555857]


portfolio before change:  [5.98503672]
curr_Stock_Price:  102.60913254227837
curr_Factors:  [102.60913254]
mat_Sqrt:  [[0.15]]
grads:  [-0.10185968]
Stock Position:  -0.10185968294239288
Bond Position:  [16.43677043]


portfolio before change:  [5.89549223]
curr_Stock_Price:  103.49831483346733
curr_Factors:  [103.49831483]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268134]
Stock Position:  -0.022681339066658014
Bond Position:  [8.2429726]


portfolio before change:  [5.90288261]
curr_Stock_Price:  103.195194074067
curr_Factors:  [103.19519407]
mat_Sqrt:  [[0.15]]
grads:  [0.08357715]
Stock Position:  0.08357714864925882
Bond Position:  [-2.72187746]


portfolio before change:  [5.94088824]
curr_Stock_Price:  103.6519666985317
curr_Factors:  [103.6519667]
mat_Sqrt:  [[0.15]]
grads:  [-0.03172972]
Stock Position:  -0.03172971507245908
Bond Position:  [9.22973561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.96874521]
Stock Price:  102.79220214151556
PL:  [3.17654306]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.17368550e-03]
 [ 4.53775766e-02]
 [ 1.90124923e-02]
 [-2.53961245e-02]
 [-5.54999430e-02]
 [-1.87673767e-03]
 [ 1.03415889e-02]
 [-5.85464610e-02]
 [ 1.79932154e-02]
 [-8.00795372e-03]
 [-1.11598813e-02]
 [ 2.25819770e-02]
 [-5.82517259e-03]
 [ 1.08953384e-02]
 [ 2.45682450e-02]
 [ 8.06986687e-03]
 [ 9.61441966e-02]
 [-1.04070036e-02]
 [ 2.10456986e-02]
 [ 1.49261764e-04]
 [-7.34931457e-03]
 [ 6.16293631e-03]
 [-2.96795459e-04]
 [ 5.68035758e-02]
 [ 6.44098214e-03]
 [ 6.95073271e-03]
 [ 6.90960728e-02]
 [ 2.26134544e-02]
 [ 2.01192685e-02]
 [-7.29690824e-03]
 [ 2.68851670e-03]
 [ 1.41613211e-02]
 [ 1.44702358e-02]
 [-4.19749229e-03]
 [ 4.90475568e-03]
 [ 3.45455604e-03]
 [-1.36874342e-02]
 [-6.34109694e-03]
 [-1.59146265e-02]
 [-1.70962037e-02]
 [ 3.79579113e-03]
 [ 1.07343806e-02]
 [-9.97214962e-03]
 [ 9.34184952e-03]
 [-2.44440362e-05]
 [ 1.16092608e-02]
 [ 1.05559565e-02]
 [-3.13911868e-03]
 [ 1.53544160e-02]
 [-1.61351828e-03]
 [ 1.76431415e-02]
 [ 2.46533098e-02]
 [-6.74835968e-03]
 [-4.53977800e-02]
 [-7.04690595e-03]
 [-2.92867562e-03]
 [ 1.00199324e-02]
 [-1.74162479e-02]
 [ 3.08436261e-03]
 [-3.26614171e-03]
 [-5.20200254e-03]
 [ 5.92475832e-03]
 [-1.99203152e-02]
 [ 9.22779497e-04]
 [ 2.01255448e-02]
 [ 1.07157897e-02]
 [ 1.52246664e-02]
 [ 6.74212294e-03]
 [ 5.07936742e-03]
 [ 1.30333373e-02]
 [ 8.24581101e-04]
 [-1.52902324e-02]
 [-2.24762332e-03]
 [ 1.32463608e-03]
 [ 1.29005871e-03]
 [-1.22858904e-02]
 [-4.31500289e-03]
 [ 1.53168190e-02]
 [-1.78712260e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.73927687]
curr_Stock_Price:  100.53181537801777
curr_Factors:  [100.53181538]
mat_Sqrt:  [[0.15]]
grads:  [-0.02782457]
Stock Position:  -0.027824570030311708
Bond Position:  [16.53653141]


portfolio before change:  [13.72255764]
curr_Stock_Price:  101.16984121868128
curr_Factors:  [101.16984122]
mat_Sqrt:  [[0.15]]
grads:  [0.30251718]
Stock Position:  0.302517177539993
Bond Position:  [-16.88305717]


portfolio before change:  [13.74817403]
curr_Stock_Price:  101.25800682646945
curr_Factors:  [101.25800683]
mat_Sqrt:  [[0.15]]
grads:  [0.12674995]
Stock Position:  0.12674994859581692
Bond Position:  [0.91372687]


portfolio before change:  [13.73457057]
curr_Stock_Price:  101.15023107355985
curr_Factors:  [101.15023107]
mat_Sqrt:  [[0.15]]
grads:  [-0.1693075]
Stock Position:  -0.1693074964781316
Bond Position:  [30.86006296]


portfolio before change:  [13.53889092]
curr_Stock_Price:  102.31738827951268
curr_Factors:  [102.31738828]
mat_Sqrt:  [[0.15]]
grads:  [-0.36999962]
Stock Position:  -0.3699996202140478
Bond Position:  [51.39628572]


portfolio before change:  [13.46226497]
curr_Stock_Price:  102.53316774394365
curr_Factors:  [102.53316774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01251158]
Stock Position:  -0.01251158449720285
Bond Position:  [14.74511736]


portfolio before change:  [13.46768271]
curr_Stock_Price:  102.17380911216637
curr_Factors:  [102.17380911]
mat_Sqrt:  [[0.15]]
grads:  [0.06894393]
Stock Position:  0.06894392592391321
Bond Position:  [6.42341918]


portfolio before change:  [13.51933958]
curr_Stock_Price:  102.9172450202708
curr_Factors:  [102.91724502]
mat_Sqrt:  [[0.15]]
grads:  [-0.39030974]
Stock Position:  -0.39030974021757614
Bond Position:  [53.68894275]


portfolio before change:  [13.35891642]
curr_Stock_Price:  103.33685746735908
curr_Factors:  [103.33685747]
mat_Sqrt:  [[0.15]]
grads:  [0.11995477]
Stock Position:  0.11995476918115751
Bond Position:  [0.96316753]


portfolio before change:  [13.31084444]
curr_Stock_Price:  102.93560471934056
curr_Factors:  [102.93560472]
mat_Sqrt:  [[0.15]]
grads:  [-0.05338636]
Stock Position:  -0.05338635816175291
Bond Position:  [18.8062015]


portfolio before change:  [13.33256132]
curr_Stock_Price:  102.55083492714112
curr_Factors:  [102.55083493]
mat_Sqrt:  [[0.15]]
grads:  [-0.07439921]
Stock Position:  -0.07439920895571259
Bond Position:  [20.96226231]


portfolio before change:  [13.25218865]
curr_Stock_Price:  103.6487344293182
curr_Factors:  [103.64873443]
mat_Sqrt:  [[0.15]]
grads:  [0.15054651]
Stock Position:  0.1505465135979972
Bond Position:  [-2.35176696]


portfolio before change:  [13.29557058]
curr_Stock_Price:  103.93787383452317
curr_Factors:  [103.93787383]
mat_Sqrt:  [[0.15]]
grads:  [-0.03883448]
Stock Position:  -0.038834483914688404
Bond Position:  [17.33194427]


portfolio before change:  [13.25256394]
curr_Stock_Price:  105.07320306785745
curr_Factors:  [105.07320307]
mat_Sqrt:  [[0.15]]
grads:  [0.07263559]
Stock Position:  0.07263558910415029
Bond Position:  [5.62050994]


portfolio before change:  [13.25418682]
curr_Stock_Price:  105.09070949185605
curr_Factors:  [105.09070949]
mat_Sqrt:  [[0.15]]
grads:  [0.1637883]
Stock Position:  0.16378830004517186
Bond Position:  [-3.95844184]


portfolio before change:  [13.05779196]
curr_Stock_Price:  103.89314258195638
curr_Factors:  [103.89314258]
mat_Sqrt:  [[0.15]]
grads:  [0.05379911]
Stock Position:  0.053799112458978754
Bond Position:  [7.4684331]


portfolio before change:  [13.04098488]
curr_Stock_Price:  103.57206146746978
curr_Factors:  [103.57206147]
mat_Sqrt:  [[0.15]]
grads:  [0.64096131]
Stock Position:  0.6409613109425559
Bond Position:  [-53.34469942]


portfolio before change:  [12.64392659]
curr_Stock_Price:  102.95779016445604
curr_Factors:  [102.95779016]
mat_Sqrt:  [[0.15]]
grads:  [-0.06938002]
Stock Position:  -0.06938002371179237
Bond Position:  [19.78714051]


portfolio before change:  [12.70072675]
curr_Stock_Price:  102.15693394944826
curr_Factors:  [102.15693395]
mat_Sqrt:  [[0.15]]
grads:  [0.14030466]
Stock Position:  0.14030465740436693
Bond Position:  [-1.63236687]


portfolio before change:  [12.84116221]
curr_Stock_Price:  103.15859343694929
curr_Factors:  [103.15859344]
mat_Sqrt:  [[0.15]]
grads:  [0.00099508]
Stock Position:  0.0009950784278706278
Bond Position:  [12.73851132]


portfolio before change:  [12.84241145]
curr_Stock_Price:  103.61389294098034
curr_Factors:  [103.61389294]
mat_Sqrt:  [[0.15]]
grads:  [-0.04899543]
Stock Position:  -0.04899543048086318
Bond Position:  [17.91901874]


portfolio before change:  [12.86086445]
curr_Stock_Price:  103.26012483826474
curr_Factors:  [103.26012484]
mat_Sqrt:  [[0.15]]
grads:  [0.04108624]
Stock Position:  0.041086242074539404
Bond Position:  [8.61829396]


portfolio before change:  [12.88979696]
curr_Stock_Price:  103.95120425610428
curr_Factors:  [103.95120426]
mat_Sqrt:  [[0.15]]
grads:  [-0.00197864]
Stock Position:  -0.001978636390078034
Bond Position:  [13.0954786]


portfolio before change:  [12.88951179]
curr_Stock_Price:  104.50899689630035
curr_Factors:  [104.5089969]
mat_Sqrt:  [[0.15]]
grads:  [0.37869051]
Stock Position:  0.3786905053448777
Bond Position:  [-26.68705306]


portfolio before change:  [12.93449122]
curr_Stock_Price:  104.63217776551784
curr_Factors:  [104.63217777]
mat_Sqrt:  [[0.15]]
grads:  [0.04293988]
Stock Position:  0.04293988096130824
Bond Position:  [8.44159796]


portfolio before change:  [12.90578586]
curr_Stock_Price:  103.95138931244402
curr_Factors:  [103.95138931]
mat_Sqrt:  [[0.15]]
grads:  [0.04633822]
Stock Position:  0.046338218046258484
Bond Position:  [8.08886372]


portfolio before change:  [12.93335195]
curr_Stock_Price:  104.53536773838935
curr_Factors:  [104.53536774]
mat_Sqrt:  [[0.15]]
grads:  [0.46064049]
Stock Position:  0.4606404855457288
Bond Position:  [-35.2198706]


portfolio before change:  [12.33182246]
curr_Stock_Price:  103.23429194644548
curr_Factors:  [103.23429195]
mat_Sqrt:  [[0.15]]
grads:  [0.15075636]
Stock Position:  0.15075636286593447
Bond Position:  [-3.23140392]


portfolio before change:  [12.27156151]
curr_Stock_Price:  102.83590760506819
curr_Factors:  [102.83590761]
mat_Sqrt:  [[0.15]]
grads:  [0.13412846]
Stock Position:  0.1341284568510807
Bond Position:  [-1.52166008]


portfolio before change:  [12.33641285]
curr_Stock_Price:  103.32011839875985
curr_Factors:  [103.3201184]
mat_Sqrt:  [[0.15]]
grads:  [-0.04864605]
Stock Position:  -0.0486460549569998
Bond Position:  [17.36252901]


portfolio before change:  [12.31607928]
curr_Stock_Price:  103.76041651453025
curr_Factors:  [103.76041651]
mat_Sqrt:  [[0.15]]
grads:  [0.01792344]
Stock Position:  0.017923444675600742
Bond Position:  [10.45633519]


portfolio before change:  [12.30156979]
curr_Stock_Price:  102.91442824216301
curr_Factors:  [102.91442824]
mat_Sqrt:  [[0.15]]
grads:  [0.09440881]
Stock Position:  0.0944088071863329
Bond Position:  [2.58554138]


portfolio before change:  [12.34546937]
curr_Stock_Price:  103.3777110170213
curr_Factors:  [103.37771102]
mat_Sqrt:  [[0.15]]
grads:  [0.09646824]
Stock Position:  0.09646823847634432
Bond Position:  [2.37280369]


portfolio before change:  [12.33027251]
curr_Stock_Price:  103.21864140319235
curr_Factors:  [103.2186414]
mat_Sqrt:  [[0.15]]
grads:  [-0.02798328]
Stock Position:  -0.02798328190020887
Bond Position:  [15.21866885]


portfolio before change:  [12.34057121]
curr_Stock_Price:  102.88460259815841
curr_Factors:  [102.8846026]
mat_Sqrt:  [[0.15]]
grads:  [0.03269837]
Stock Position:  0.032698371171826064
Bond Position:  [8.97641228]


portfolio before change:  [12.3523149]
curr_Stock_Price:  103.22659677960402
curr_Factors:  [103.22659678]
mat_Sqrt:  [[0.15]]
grads:  [0.02303037]
Stock Position:  0.023030373589068866
Bond Position:  [9.97496782]


portfolio before change:  [12.36020163]
curr_Stock_Price:  103.5419746974811
curr_Factors:  [103.5419747]
mat_Sqrt:  [[0.15]]
grads:  [-0.09124956]
Stock Position:  -0.09124956106082857
Bond Position:  [21.80836137]


portfolio before change:  [12.39675913]
curr_Stock_Price:  103.15628038199495
curr_Factors:  [103.15628038]
mat_Sqrt:  [[0.15]]
grads:  [-0.04227398]
Stock Position:  -0.04227397959783373
Bond Position:  [16.75758563]


portfolio before change:  [12.38269049]
curr_Stock_Price:  103.51385310294641
curr_Factors:  [103.5138531]
mat_Sqrt:  [[0.15]]
grads:  [-0.10609751]
Stock Position:  -0.1060975103034736
Bond Position:  [23.36525259]


portfolio before change:  [12.40883164]
curr_Stock_Price:  103.2812295943312
curr_Factors:  [103.28122959]
mat_Sqrt:  [[0.15]]
grads:  [-0.11397469]
Stock Position:  -0.1139746910474637
Bond Position:  [24.18027788]


portfolio before change:  [12.42091834]
curr_Stock_Price:  103.1884424533932
curr_Factors:  [103.18844245]
mat_Sqrt:  [[0.15]]
grads:  [0.02530527]
Stock Position:  0.025305274224373647
Bond Position:  [9.80970651]


portfolio before change:  [12.40524583]
curr_Stock_Price:  102.54487565247165
curr_Factors:  [102.54487565]
mat_Sqrt:  [[0.15]]
grads:  [0.07156254]
Stock Position:  0.07156253766590849
Bond Position:  [5.06687431]


portfolio before change:  [12.47433008]
curr_Stock_Price:  103.50581919854392
curr_Factors:  [103.5058192]
mat_Sqrt:  [[0.15]]
grads:  [-0.066481]
Stock Position:  -0.06648099745348049
Bond Position:  [19.35550018]


portfolio before change:  [12.41777077]
curr_Stock_Price:  104.37477534827192
curr_Factors:  [104.37477535]
mat_Sqrt:  [[0.15]]
grads:  [0.062279]
Stock Position:  0.062278996821048115
Bond Position:  [5.91741446]


portfolio before change:  [12.42612081]
curr_Stock_Price:  104.50291150076146
curr_Factors:  [104.5029115]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016296]
Stock Position:  -0.00016296024153284833
Bond Position:  [12.44315063]


portfolio before change:  [12.42683814]
curr_Stock_Price:  104.87346692851351
curr_Factors:  [104.87346693]
mat_Sqrt:  [[0.15]]
grads:  [0.07739507]
Stock Position:  0.07739507175206486
Bond Position:  [4.31014865]


portfolio before change:  [12.47246021]
curr_Stock_Price:  105.4594560566941
curr_Factors:  [105.45945606]
mat_Sqrt:  [[0.15]]
grads:  [0.07037304]
Stock Position:  0.07037304361308355
Bond Position:  [5.05095731]


portfolio before change:  [12.50215922]
curr_Stock_Price:  105.87699264339098
curr_Factors:  [105.87699264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02092746]
Stock Position:  -0.020927457875466352
Bond Position:  [14.71789553]


portfolio before change:  [12.47742287]
curr_Stock_Price:  107.1029537378473
curr_Factors:  [107.10295374]
mat_Sqrt:  [[0.15]]
grads:  [0.10236277]
Stock Position:  0.10236277337292775
Bond Position:  [1.51406749]


portfolio before change:  [12.54952414]
curr_Stock_Price:  107.80639934326724
curr_Factors:  [107.80639934]
mat_Sqrt:  [[0.15]]
grads:  [-0.01075679]
Stock Position:  -0.010756788530955621
Bond Position:  [13.70917478]


portfolio before change:  [12.54913193]
curr_Stock_Price:  107.92251845833968
curr_Factors:  [107.92251846]
mat_Sqrt:  [[0.15]]
grads:  [0.11762094]
Stock Position:  0.1176209433251346
Bond Position:  [-0.1448165]


portfolio before change:  [12.44340822]
curr_Stock_Price:  107.02374441002553
curr_Factors:  [107.02374441]
mat_Sqrt:  [[0.15]]
grads:  [0.1643554]
Stock Position:  0.16435539871704735
Bond Position:  [-5.14652196]


portfolio before change:  [12.31875553]
curr_Stock_Price:  106.26726771072138
curr_Factors:  [106.26726771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498906]
Stock Position:  -0.0449890645391599
Bond Position:  [17.09962049]


portfolio before change:  [12.34754559]
curr_Stock_Price:  105.65108904697024
curr_Factors:  [105.65108905]
mat_Sqrt:  [[0.15]]
grads:  [-0.30265187]
Stock Position:  -0.30265186678468625
Bond Position:  [44.32304492]


portfolio before change:  [12.77453722]
curr_Stock_Price:  104.24940808910658
curr_Factors:  [104.24940809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04697937]
Stock Position:  -0.04697937298411983
Bond Position:  [17.67210905]


portfolio before change:  [12.80423877]
curr_Stock_Price:  103.64069393453896
curr_Factors:  [103.64069393]
mat_Sqrt:  [[0.15]]
grads:  [-0.0195245]
Stock Position:  -0.019524504128536086
Bond Position:  [14.82777193]


portfolio before change:  [12.80947076]
curr_Stock_Price:  103.42019036609389
curr_Factors:  [103.42019037]
mat_Sqrt:  [[0.15]]
grads:  [0.06679955]
Stock Position:  0.06679954911954883
Bond Position:  [5.90104868]


portfolio before change:  [12.91338853]
curr_Stock_Price:  104.97033474744568
curr_Factors:  [104.97033475]
mat_Sqrt:  [[0.15]]
grads:  [-0.11610832]
Stock Position:  -0.11610831907439885
Bond Position:  [25.10131765]


portfolio before change:  [12.93343718]
curr_Stock_Price:  104.81117503103457
curr_Factors:  [104.81117503]
mat_Sqrt:  [[0.15]]
grads:  [0.02056242]
Stock Position:  0.02056241739166831
Bond Position:  [10.77826605]


portfolio before change:  [12.93486401]
curr_Stock_Price:  104.84780305974957
curr_Factors:  [104.84780306]
mat_Sqrt:  [[0.15]]
grads:  [-0.02177428]
Stock Position:  -0.021774278049316014
Bond Position:  [15.21784922]


portfolio before change:  [12.94549951]
curr_Stock_Price:  104.40304142981581
curr_Factors:  [104.40304143]
mat_Sqrt:  [[0.15]]
grads:  [-0.03468002]
Stock Position:  -0.03468001691809234
Bond Position:  [16.56619876]


portfolio before change:  [12.97324654]
curr_Stock_Price:  103.6328110544833
curr_Factors:  [103.63281105]
mat_Sqrt:  [[0.15]]
grads:  [0.03949839]
Stock Position:  0.039498388818269566
Bond Position:  [8.87991747]


portfolio before change:  [12.98726563]
curr_Stock_Price:  103.97368768354764
curr_Factors:  [103.97368768]
mat_Sqrt:  [[0.15]]
grads:  [-0.1328021]
Stock Position:  -0.1328021012385376
Bond Position:  [26.79518982]


portfolio before change:  [12.98903331]
curr_Stock_Price:  103.97298791258122
curr_Factors:  [103.97298791]
mat_Sqrt:  [[0.15]]
grads:  [0.00615186]
Stock Position:  0.006151863310853252
Bond Position:  [12.3494057]


portfolio before change:  [12.98607468]
curr_Stock_Price:  103.36658699699251
curr_Factors:  [103.366587]
mat_Sqrt:  [[0.15]]
grads:  [0.1341703]
Stock Position:  0.13417029837923117
Bond Position:  [-0.88265114]


portfolio before change:  [13.00370472]
curr_Stock_Price:  103.49839869434173
curr_Factors:  [103.49839869]
mat_Sqrt:  [[0.15]]
grads:  [0.0714386]
Stock Position:  0.07143859769357648
Bond Position:  [5.60992426]


portfolio before change:  [12.94329376]
curr_Stock_Price:  102.64785581251599
curr_Factors:  [102.64785581]
mat_Sqrt:  [[0.15]]
grads:  [0.10149778]
Stock Position:  0.10149777604677435
Bond Position:  [2.52476468]


portfolio before change:  [12.93878471]
curr_Stock_Price:  102.6018759656608
curr_Factors:  [102.60187597]
mat_Sqrt:  [[0.15]]
grads:  [0.04494749]
Stock Position:  0.044947486288326455
Bond Position:  [8.3270883]


portfolio before change:  [12.951828]
curr_Stock_Price:  102.88048612192675
curr_Factors:  [102.88048612]
mat_Sqrt:  [[0.15]]
grads:  [0.03386245]
Stock Position:  0.03386244946590728
Bond Position:  [9.46804274]


portfolio before change:  [12.97090984]
curr_Stock_Price:  103.42652069707037
curr_Factors:  [103.4265207]
mat_Sqrt:  [[0.15]]
grads:  [0.08688892]
Stock Position:  0.08688891504485606
Bond Position:  [3.98429167]


portfolio before change:  [12.9497097]
curr_Stock_Price:  103.17966331577014
curr_Factors:  [103.17966332]
mat_Sqrt:  [[0.15]]
grads:  [0.00549721]
Stock Position:  0.005497207337300704
Bond Position:  [12.38250969]


portfolio before change:  [12.95449623]
curr_Stock_Price:  103.90959912857251
curr_Factors:  [103.90959913]
mat_Sqrt:  [[0.15]]
grads:  [-0.10193488]
Stock Position:  -0.10193488254653196
Bond Position:  [23.54650902]


portfolio before change:  [13.08684712]
curr_Stock_Price:  102.62565020911126
curr_Factors:  [102.62565021]
mat_Sqrt:  [[0.15]]
grads:  [-0.01498416]
Stock Position:  -0.014984155457435899
Bond Position:  [14.62460582]


portfolio before change:  [13.09990834]
curr_Stock_Price:  101.81498382878759
curr_Factors:  [101.81498383]
mat_Sqrt:  [[0.15]]
grads:  [0.00883091]
Stock Position:  0.008830907233277905
Bond Position:  [12.20078966]


portfolio before change:  [13.09942004]
curr_Stock_Price:  101.67333738803084
curr_Factors:  [101.67333739]
mat_Sqrt:  [[0.15]]
grads:  [0.00860039]
Stock Position:  0.008600391400841456
Bond Position:  [12.22498955]


portfolio before change:  [13.09753562]
curr_Stock_Price:  101.36538531209808
curr_Factors:  [101.36538531]
mat_Sqrt:  [[0.15]]
grads:  [-0.08190594]
Stock Position:  -0.08190593569848417
Bond Position:  [21.39996235]


portfolio before change:  [13.10294954]
curr_Stock_Price:  101.31561627305354
curr_Factors:  [101.31561627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02876669]
Stock Position:  -0.02876668595810157
Bond Position:  [16.01746406]


portfolio before change:  [13.11391828]
curr_Stock_Price:  100.96911756087934
curr_Factors:  [100.96911756]
mat_Sqrt:  [[0.15]]
grads:  [0.10211213]
Stock Position:  0.10211212656360477
Bond Position:  [2.80374697]


portfolio before change:  [13.06354582]
curr_Stock_Price:  100.47409598138846
curr_Factors:  [100.47409598]
mat_Sqrt:  [[0.15]]
grads:  [-0.11914151]
Stock Position:  -0.11914150694048507
Bond Position:  [25.03418102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.0703186]
Stock Price:  100.43038244604621
PL:  [12.63993615]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.28121530e-02]
 [-2.42649236e-02]
 [ 5.27145565e-02]
 [-1.05795702e-02]
 [ 1.46794930e-02]
 [-6.55753230e-03]
 [ 3.98445913e-04]
 [-2.39492488e-03]
 [-1.08771892e-02]
 [-1.19390377e-02]
 [ 1.35358289e-02]
 [-7.57646061e-03]
 [ 5.27288124e-05]
 [ 8.07219558e-03]
 [-2.60890381e-03]
 [ 8.08416951e-03]
 [-3.37337879e-02]
 [-1.00323890e-02]
 [ 2.39691720e-02]
 [-3.24755769e-03]
 [-8.82189186e-03]
 [ 5.59961686e-03]
 [ 1.26737611e-02]
 [ 2.08747156e-02]
 [ 1.44090406e-04]
 [ 4.47433142e-03]
 [ 3.26720528e-03]
 [ 9.54857550e-03]
 [ 1.61121115e-02]
 [ 1.59548924e-02]
 [-6.93827684e-03]
 [ 1.64779389e-02]
 [ 1.15275440e-02]
 [-2.02704335e-02]
 [-6.14147607e-03]
 [ 1.81159217e-02]
 [ 4.97027710e-03]
 [-5.53412830e-04]
 [-3.47580782e-02]
 [-1.55690551e-02]
 [ 7.14524988e-03]
 [ 2.54570920e-02]
 [-2.86935844e-03]
 [ 3.37383670e-03]
 [-1.24194547e-02]
 [ 1.62561742e-02]
 [ 1.01243255e-02]
 [ 5.26537847e-03]
 [ 3.95291104e-03]
 [-2.25873113e-03]
 [-4.05898580e-03]
 [-1.54592286e-03]
 [ 1.42875876e-03]
 [ 2.83296180e-03]
 [-7.32286485e-03]
 [-4.41254239e-03]
 [ 1.58618946e-03]
 [ 9.71398216e-03]
 [ 7.84953417e-03]
 [-3.94103560e-03]
 [-1.47749553e-04]
 [ 5.30265621e-03]
 [-8.43361146e-03]
 [ 5.03028213e-03]
 [ 1.98195994e-02]
 [ 4.13353903e-03]
 [ 1.12118923e-02]
 [-1.77550288e-03]
 [ 4.97446237e-03]
 [ 2.36041804e-02]
 [ 3.31220499e-03]
 [-1.53821814e-02]
 [-5.77113277e-03]
 [ 2.51812331e-03]
 [ 1.10191122e-02]
 [ 6.00740437e-03]
 [-1.78346629e-05]
 [-2.18779828e-02]
 [-3.05748600e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.59600764]
curr_Stock_Price:  99.06321301959217
curr_Factors:  [99.06321302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08541435]
Stock Position:  -0.08541435357842123
Bond Position:  [-10.13458734]


portfolio before change:  [-18.54992529]
curr_Stock_Price:  98.51628175744442
curr_Factors:  [98.51628176]
mat_Sqrt:  [[0.15]]
grads:  [-0.16176616]
Stock Position:  -0.16176615727407445
Bond Position:  [-2.61332496]


portfolio before change:  [-18.51413846]
curr_Stock_Price:  98.29404631518148
curr_Factors:  [98.29404632]
mat_Sqrt:  [[0.15]]
grads:  [0.35143038]
Stock Position:  0.35143037660733495
Bond Position:  [-53.05765217]


portfolio before change:  [-18.23487905]
curr_Stock_Price:  99.09811915111393
curr_Factors:  [99.09811915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07053047]
Stock Position:  -0.07053046799954173
Bond Position:  [-11.24544232]


portfolio before change:  [-18.26751164]
curr_Stock_Price:  99.55082750616583
curr_Factors:  [99.55082751]
mat_Sqrt:  [[0.15]]
grads:  [0.09786329]
Stock Position:  0.09786328688552948
Bond Position:  [-28.00988283]


portfolio before change:  [-18.2311359]
curr_Stock_Price:  99.94041605693849
curr_Factors:  [99.94041606]
mat_Sqrt:  [[0.15]]
grads:  [-0.04371688]
Stock Position:  -0.04371688196711926
Bond Position:  [-13.86205252]


portfolio before change:  [-18.21453269]
curr_Stock_Price:  99.54080810025586
curr_Factors:  [99.5408081]
mat_Sqrt:  [[0.15]]
grads:  [0.00265631]
Stock Position:  0.002656306089551831
Bond Position:  [-18.47894354]


portfolio before change:  [-18.21532251]
curr_Stock_Price:  99.67827342559421
curr_Factors:  [99.67827343]
mat_Sqrt:  [[0.15]]
grads:  [-0.01596617]
Stock Position:  -0.0159661658551373
Bond Position:  [-16.62384266]


portfolio before change:  [-18.21546943]
curr_Stock_Price:  99.62239925452516
curr_Factors:  [99.62239925]
mat_Sqrt:  [[0.15]]
grads:  [-0.07251459]
Stock Position:  -0.07251459469672235
Bond Position:  [-10.99139153]


portfolio before change:  [-18.17847058]
curr_Stock_Price:  99.10269921298494
curr_Factors:  [99.10269921]
mat_Sqrt:  [[0.15]]
grads:  [-0.07959358]
Stock Position:  -0.07959358477054329
Bond Position:  [-10.29053149]


portfolio before change:  [-18.20457518]
curr_Stock_Price:  99.42259207172117
curr_Factors:  [99.42259207]
mat_Sqrt:  [[0.15]]
grads:  [0.09023886]
Stock Position:  0.09023885946394816
Bond Position:  [-27.17635649]


portfolio before change:  [-18.26761715]
curr_Stock_Price:  98.74280289724868
curr_Factors:  [98.7428029]
mat_Sqrt:  [[0.15]]
grads:  [-0.05050974]
Stock Position:  -0.05050973736938954
Bond Position:  [-13.28014411]


portfolio before change:  [-18.26990983]
curr_Stock_Price:  98.77176060455056
curr_Factors:  [98.7717606]
mat_Sqrt:  [[0.15]]
grads:  [0.00035153]
Stock Position:  0.00035152541568799167
Bond Position:  [-18.30463062]


portfolio before change:  [-18.27075376]
curr_Stock_Price:  99.62559391615375
curr_Factors:  [99.62559392]
mat_Sqrt:  [[0.15]]
grads:  [0.05381464]
Stock Position:  0.053814637199086315
Bond Position:  [-23.63206896]


portfolio before change:  [-18.30808585]
curr_Stock_Price:  98.95932477846222
curr_Factors:  [98.95932478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01739269]
Stock Position:  -0.017392692033453516
Bond Position:  [-16.58691679]


portfolio before change:  [-18.3043106]
curr_Stock_Price:  98.68265922327117
curr_Factors:  [98.68265922]
mat_Sqrt:  [[0.15]]
grads:  [0.05389446]
Stock Position:  0.05389446337510727
Bond Position:  [-23.62275957]


portfolio before change:  [-18.39754332]
curr_Stock_Price:  96.98014212948898
curr_Factors:  [96.98014213]
mat_Sqrt:  [[0.15]]
grads:  [-0.22489192]
Stock Position:  -0.22489191927750604
Bond Position:  [3.41250698]


portfolio before change:  [-18.28392962]
curr_Stock_Price:  96.47589809247782
curr_Factors:  [96.47589809]
mat_Sqrt:  [[0.15]]
grads:  [-0.06688259]
Stock Position:  -0.06688259365465736
Bond Position:  [-11.83137133]


portfolio before change:  [-18.31546302]
curr_Stock_Price:  96.93631556765428
curr_Factors:  [96.93631557]
mat_Sqrt:  [[0.15]]
grads:  [0.15979448]
Stock Position:  0.15979448005294905
Bond Position:  [-33.80535116]


portfolio before change:  [-18.28691999]
curr_Stock_Price:  97.1281615576564
curr_Factors:  [97.12816156]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165038]
Stock Position:  -0.021650384630253375
Bond Position:  [-16.18405793]


portfolio before change:  [-18.31057283]
curr_Stock_Price:  98.17393086114733
curr_Factors:  [98.17393086]
mat_Sqrt:  [[0.15]]
grads:  [-0.05881261]
Stock Position:  -0.05881261242896314
Bond Position:  [-12.53670748]


portfolio before change:  [-18.26746592]
curr_Stock_Price:  97.42765419220892
curr_Factors:  [97.42765419]
mat_Sqrt:  [[0.15]]
grads:  [0.03733078]
Stock Position:  0.03733077905602113
Bond Position:  [-21.90451615]


portfolio before change:  [-18.27737308]
curr_Stock_Price:  97.1989398412053
curr_Factors:  [97.19893984]
mat_Sqrt:  [[0.15]]
grads:  [0.08449174]
Stock Position:  0.0844917404343396
Bond Position:  [-26.48988067]


portfolio before change:  [-18.22640299]
curr_Stock_Price:  97.82179075057209
curr_Factors:  [97.82179075]
mat_Sqrt:  [[0.15]]
grads:  [0.13916477]
Stock Position:  0.13916477098716992
Bond Position:  [-31.8397501]


portfolio before change:  [-18.24078941]
curr_Stock_Price:  97.73271380551698
curr_Factors:  [97.73271381]
mat_Sqrt:  [[0.15]]
grads:  [0.0009606]
Stock Position:  0.0009606027061913094
Bond Position:  [-18.33467172]


portfolio before change:  [-18.24157362]
curr_Stock_Price:  98.1092961701817
curr_Factors:  [98.10929617]
mat_Sqrt:  [[0.15]]
grads:  [0.02982888]
Stock Position:  0.029828876155738367
Bond Position:  [-21.16806366]


portfolio before change:  [-18.25323073]
curr_Stock_Price:  97.7628510736722
curr_Factors:  [97.76285107]
mat_Sqrt:  [[0.15]]
grads:  [0.02178137]
Stock Position:  0.021781368507355743
Bond Position:  [-20.38263942]


portfolio before change:  [-18.25859612]
curr_Stock_Price:  97.57501009169509
curr_Factors:  [97.57501009]
mat_Sqrt:  [[0.15]]
grads:  [0.06365717]
Stock Position:  0.06365716996789682
Bond Position:  [-24.46994512]


portfolio before change:  [-18.26910072]
curr_Stock_Price:  97.43401757200894
curr_Factors:  [97.43401757]
mat_Sqrt:  [[0.15]]
grads:  [0.10741408]
Stock Position:  0.10741407642704487
Bond Position:  [-28.73488573]


portfolio before change:  [-18.20321101]
curr_Stock_Price:  98.06415568668261
curr_Factors:  [98.06415569]
mat_Sqrt:  [[0.15]]
grads:  [0.10636595]
Stock Position:  0.10636594918486869
Bond Position:  [-28.63389801]


portfolio before change:  [-18.26933579]
curr_Stock_Price:  97.45930879307008
curr_Factors:  [97.45930879]
mat_Sqrt:  [[0.15]]
grads:  [-0.04625518]
Stock Position:  -0.04625517894628127
Bond Position:  [-13.76133803]


portfolio before change:  [-18.27971231]
curr_Stock_Price:  97.66504590530936
curr_Factors:  [97.66504591]
mat_Sqrt:  [[0.15]]
grads:  [0.10985293]
Stock Position:  0.10985292625615024
Bond Position:  [-29.0085034]


portfolio before change:  [-18.25726915]
curr_Stock_Price:  97.8858524770235
curr_Factors:  [97.88585248]
mat_Sqrt:  [[0.15]]
grads:  [0.07685029]
Stock Position:  0.07685029327068629
Bond Position:  [-25.77982562]


portfolio before change:  [-18.29021645]
curr_Stock_Price:  97.47809859484424
curr_Factors:  [97.47809859]
mat_Sqrt:  [[0.15]]
grads:  [-0.13513622]
Stock Position:  -0.1351362230071598
Bond Position:  [-5.11739438]


portfolio before change:  [-18.34213378]
curr_Stock_Price:  97.85991689977465
curr_Factors:  [97.8599169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04094317]
Stock Position:  -0.04094317381306114
Bond Position:  [-14.33543819]


portfolio before change:  [-18.35413056]
curr_Stock_Price:  98.13104369212158
curr_Factors:  [98.13104369]
mat_Sqrt:  [[0.15]]
grads:  [0.12077281]
Stock Position:  0.12077281151899845
Bond Position:  [-30.20569261]


portfolio before change:  [-18.38370804]
curr_Stock_Price:  97.901773885562
curr_Factors:  [97.90177389]
mat_Sqrt:  [[0.15]]
grads:  [0.03313518]
Stock Position:  0.033135180678246015
Bond Position:  [-21.627701]


portfolio before change:  [-18.38678624]
curr_Stock_Price:  97.84967121709587
curr_Factors:  [97.84967122]
mat_Sqrt:  [[0.15]]
grads:  [-0.00368942]
Stock Position:  -0.0036894188669168385
Bond Position:  [-18.02577782]


portfolio before change:  [-18.38799135]
curr_Stock_Price:  97.87093787174874
curr_Factors:  [97.87093787]
mat_Sqrt:  [[0.15]]
grads:  [-0.23172052]
Stock Position:  -0.23172052125693965
Bond Position:  [4.29071339]


portfolio before change:  [-18.41048214]
curr_Stock_Price:  97.96915520549929
curr_Factors:  [97.96915521]
mat_Sqrt:  [[0.15]]
grads:  [-0.1037937]
Stock Position:  -0.1037937006626592
Bond Position:  [-8.24190097]


portfolio before change:  [-18.43070043]
curr_Stock_Price:  98.15898517523262
curr_Factors:  [98.15898518]
mat_Sqrt:  [[0.15]]
grads:  [0.047635]
Stock Position:  0.04763499917115982
Bond Position:  [-23.10650361]


portfolio before change:  [-18.42931753]
curr_Stock_Price:  98.21833456631576
curr_Factors:  [98.21833457]
mat_Sqrt:  [[0.15]]
grads:  [0.16971395]
Stock Position:  0.16971394689817518
Bond Position:  [-35.09833874]


portfolio before change:  [-18.44671846]
curr_Stock_Price:  98.12872955987272
curr_Factors:  [98.12872956]
mat_Sqrt:  [[0.15]]
grads:  [-0.01912906]
Stock Position:  -0.019129056271332545
Bond Position:  [-16.56960847]


portfolio before change:  [-18.4393617]
curr_Stock_Price:  97.69000468285533
curr_Factors:  [97.69000468]
mat_Sqrt:  [[0.15]]
grads:  [0.02249224]
Stock Position:  0.02249224467513271
Bond Position:  [-20.63662919]


portfolio before change:  [-18.44140162]
curr_Stock_Price:  97.65665559314866
curr_Factors:  [97.65665559]
mat_Sqrt:  [[0.15]]
grads:  [-0.08279636]
Stock Position:  -0.08279636442170157
Bond Position:  [-10.35578558]


portfolio before change:  [-18.47377504]
curr_Stock_Price:  98.03983854170741
curr_Factors:  [98.03983854]
mat_Sqrt:  [[0.15]]
grads:  [0.10837449]
Stock Position:  0.10837449448261148
Bond Position:  [-29.09879298]


portfolio before change:  [-18.51387017]
curr_Stock_Price:  97.68665214762714
curr_Factors:  [97.68665215]
mat_Sqrt:  [[0.15]]
grads:  [0.0674955]
Stock Position:  0.06749550315590526
Bond Position:  [-25.1072799]


portfolio before change:  [-18.48847948]
curr_Stock_Price:  98.08608522868283
curr_Factors:  [98.08608523]
mat_Sqrt:  [[0.15]]
grads:  [0.03510252]
Stock Position:  0.035102523154761464
Bond Position:  [-21.93154856]


portfolio before change:  [-18.45020236]
curr_Stock_Price:  99.21557344550091
curr_Factors:  [99.21557345]
mat_Sqrt:  [[0.15]]
grads:  [0.02635274]
Stock Position:  0.026352740268859982
Bond Position:  [-21.0648046]


portfolio before change:  [-18.44145078]
curr_Stock_Price:  99.59762748420964
curr_Factors:  [99.59762748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01505821]
Stock Position:  -0.015058207544725852
Bond Position:  [-16.94168904]


portfolio before change:  [-18.44369021]
curr_Stock_Price:  99.6760256737702
curr_Factors:  [99.67602567]
mat_Sqrt:  [[0.15]]
grads:  [-0.02705991]
Stock Position:  -0.027059905332498687
Bond Position:  [-15.74646639]


portfolio before change:  [-18.42722989]
curr_Stock_Price:  99.03136348434982
curr_Factors:  [99.03136348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01030615]
Stock Position:  -0.010306152397788523
Bond Position:  [-17.40659757]


portfolio before change:  [-18.42580618]
curr_Stock_Price:  98.7876584035635
curr_Factors:  [98.7876584]
mat_Sqrt:  [[0.15]]
grads:  [0.00952506]
Stock Position:  0.009525058371590499
Bond Position:  [-19.36676439]


portfolio before change:  [-18.41629212]
curr_Stock_Price:  99.9135853609204
curr_Factors:  [99.91358536]
mat_Sqrt:  [[0.15]]
grads:  [0.01888641]
Stock Position:  0.01888641203028247
Bond Position:  [-20.30330126]


portfolio before change:  [-18.43740725]
curr_Stock_Price:  98.86276959555067
curr_Factors:  [98.8627696]
mat_Sqrt:  [[0.15]]
grads:  [-0.0488191]
Stock Position:  -0.04881909902985037
Bond Position:  [-13.61101591]


portfolio before change:  [-18.43529417]
curr_Stock_Price:  98.80205969316883
curr_Factors:  [98.80205969]
mat_Sqrt:  [[0.15]]
grads:  [-0.02941695]
Stock Position:  -0.02941694925510561
Bond Position:  [-15.52883899]


portfolio before change:  [-18.44238567]
curr_Stock_Price:  99.01013429645451
curr_Factors:  [99.0101343]
mat_Sqrt:  [[0.15]]
grads:  [0.0105746]
Stock Position:  0.010574596377501574
Bond Position:  [-19.48937788]


portfolio before change:  [-18.44742152]
curr_Stock_Price:  98.6491057298097
curr_Factors:  [98.64910573]
mat_Sqrt:  [[0.15]]
grads:  [0.06475988]
Stock Position:  0.06475988106648727
Bond Position:  [-24.83592588]


portfolio before change:  [-18.46878142]
curr_Stock_Price:  98.34324350703415
curr_Factors:  [98.34324351]
mat_Sqrt:  [[0.15]]
grads:  [0.05233023]
Stock Position:  0.052330227798001616
Bond Position:  [-23.61510575]


portfolio before change:  [-18.4531148]
curr_Stock_Price:  98.67082881942605
curr_Factors:  [98.67082882]
mat_Sqrt:  [[0.15]]
grads:  [-0.02627357]
Stock Position:  -0.026273570655095127
Bond Position:  [-15.8606798]


portfolio before change:  [-18.48001543]
curr_Stock_Price:  99.65696481211441
curr_Factors:  [99.65696481]
mat_Sqrt:  [[0.15]]
grads:  [-0.000985]
Stock Position:  -0.0009849970204304135
Bond Position:  [-18.38185362]


portfolio before change:  [-18.48176948]
curr_Stock_Price:  100.27132915012747
curr_Factors:  [100.27132915]
mat_Sqrt:  [[0.15]]
grads:  [0.03535104]
Stock Position:  0.03535104142960384
Bond Position:  [-22.02646539]


portfolio before change:  [-18.47706133]
curr_Stock_Price:  100.44345547060564
curr_Factors:  [100.44345547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05622408]
Stock Position:  -0.056224076411127935
Bond Position:  [-12.82972082]


portfolio before change:  [-18.39924608]
curr_Stock_Price:  99.04517300194107
curr_Factors:  [99.045173]
mat_Sqrt:  [[0.15]]
grads:  [0.03353521]
Stock Position:  0.03353521417668498
Bond Position:  [-21.72074717]


portfolio before change:  [-18.42997216]
curr_Stock_Price:  98.16942221382186
curr_Factors:  [98.16942221]
mat_Sqrt:  [[0.15]]
grads:  [0.13213066]
Stock Position:  0.13213066266290988
Bond Position:  [-31.40116297]


portfolio before change:  [-18.44784833]
curr_Stock_Price:  98.04898429190406
curr_Factors:  [98.04898429]
mat_Sqrt:  [[0.15]]
grads:  [0.02755693]
Stock Position:  0.02755692687118394
Bond Position:  [-21.14977702]


portfolio before change:  [-18.4530826]
curr_Stock_Price:  97.90701051036046
curr_Factors:  [97.90701051]
mat_Sqrt:  [[0.15]]
grads:  [0.07474595]
Stock Position:  0.07474594856389384
Bond Position:  [-25.77123497]


portfolio before change:  [-18.52664969]
curr_Stock_Price:  96.94433175110326
curr_Factors:  [96.94433175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01183669]
Stock Position:  -0.011836685854392367
Bond Position:  [-17.37915009]


portfolio before change:  [-18.52421625]
curr_Stock_Price:  96.6469797818354
curr_Factors:  [96.64697978]
mat_Sqrt:  [[0.15]]
grads:  [0.03316308]
Stock Position:  0.033163082441137116
Bond Position:  [-21.72932801]


portfolio before change:  [-18.52062701]
curr_Stock_Price:  96.79616286116108
curr_Factors:  [96.79616286]
mat_Sqrt:  [[0.15]]
grads:  [0.1573612]
Stock Position:  0.15736120291983516
Bond Position:  [-33.75258763]


portfolio before change:  [-18.5786441]
curr_Stock_Price:  96.44088160025225
curr_Factors:  [96.4408816]
mat_Sqrt:  [[0.15]]
grads:  [0.02208137]
Stock Position:  0.02208136661229508
Bond Position:  [-20.70819056]


portfolio before change:  [-18.58439517]
curr_Stock_Price:  96.23904786160178
curr_Factors:  [96.23904786]
mat_Sqrt:  [[0.15]]
grads:  [-0.10254788]
Stock Position:  -0.102547876277044
Bond Position:  [-8.71528519]


portfolio before change:  [-18.47905532]
curr_Stock_Price:  95.20650999506209
curr_Factors:  [95.20651]
mat_Sqrt:  [[0.15]]
grads:  [-0.03847422]
Stock Position:  -0.038474218486166736
Bond Position:  [-14.81605926]


portfolio before change:  [-18.48407339]
curr_Stock_Price:  95.31286795494572
curr_Factors:  [95.31286795]
mat_Sqrt:  [[0.15]]
grads:  [0.01678749]
Stock Position:  0.016787488760001558
Bond Position:  [-20.08413709]


portfolio before change:  [-18.48214407]
curr_Stock_Price:  95.5025701196974
curr_Factors:  [95.50257012]
mat_Sqrt:  [[0.15]]
grads:  [0.07346075]
Stock Position:  0.07346074769812384
Bond Position:  [-25.49783428]


portfolio before change:  [-18.48438988]
curr_Stock_Price:  95.49369263678607
curr_Factors:  [95.49369264]
mat_Sqrt:  [[0.15]]
grads:  [0.04004936]
Stock Position:  0.040049362486198975
Bond Position:  [-22.30885139]


portfolio before change:  [-18.48991033]
curr_Stock_Price:  95.39066728167722
curr_Factors:  [95.39066728]
mat_Sqrt:  [[0.15]]
grads:  [-0.0001189]
Stock Position:  -0.00011889775239018695
Bond Position:  [-18.47856859]


portfolio before change:  [-18.49100576]
curr_Stock_Price:  94.89012888827529
curr_Factors:  [94.89012889]
mat_Sqrt:  [[0.15]]
grads:  [-0.14585322]
Stock Position:  -0.1458532189203412
Bond Position:  [-4.65097502]


portfolio before change:  [-18.54450905]
curr_Stock_Price:  95.25496550829757
curr_Factors:  [95.25496551]
mat_Sqrt:  [[0.15]]
grads:  [-0.2038324]
Stock Position:  -0.20383240028177846
Bond Position:  [0.87153921]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.62530986]
Stock Price:  95.65164083066199
PL:  [-18.62530986]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33641634e-02]
 [ 1.22958844e-02]
 [ 8.79214065e-03]
 [-9.40316373e-03]
 [-7.75997665e-04]
 [-2.72119376e-03]
 [-1.13867736e-03]
 [-2.53630138e-02]
 [ 3.85701579e-03]
 [-5.70866426e-05]
 [-8.65504101e-03]
 [ 3.71084989e-03]
 [-2.92511629e-03]
 [ 5.91715958e-03]
 [ 2.89838764e-03]
 [ 1.60827802e-02]
 [ 6.35915157e-02]
 [-1.33751671e-02]
 [ 1.83985507e-02]
 [ 1.85839375e-03]
 [-3.88145531e-03]
 [ 4.42490686e-03]
 [ 1.51050841e-02]
 [ 2.01071105e-02]
 [-2.53138382e-03]
 [ 6.83866205e-03]
 [-1.00010259e-02]
 [ 8.71309811e-03]
 [ 2.47270619e-02]
 [ 5.01020276e-03]
 [-7.08807657e-03]
 [ 1.13847296e-02]
 [ 1.28697942e-02]
 [ 6.42274284e-03]
 [ 5.55607292e-03]
 [ 1.19035334e-02]
 [-2.71565939e-02]
 [ 1.90213169e-03]
 [-5.30946774e-02]
 [ 1.37679683e-02]
 [ 4.30992936e-03]
 [ 8.40769354e-03]
 [-4.35666993e-03]
 [-1.61295260e-03]
 [ 1.11481142e-02]
 [ 1.26762560e-02]
 [ 1.05898316e-02]
 [-9.22984475e-04]
 [ 1.27825040e-02]
 [-1.17420084e-03]
 [ 1.72995566e-02]
 [-6.11236740e-03]
 [-3.45533864e-04]
 [-3.39478980e-03]
 [-2.99438920e-03]
 [-3.24263155e-03]
 [ 1.06771414e-02]
 [-1.20431372e-02]
 [ 5.04750185e-03]
 [-3.76747601e-03]
 [-3.80285609e-03]
 [ 7.24925022e-03]
 [-1.84334745e-02]
 [ 3.25047506e-03]
 [ 2.53739341e-02]
 [ 6.97174896e-03]
 [ 1.47412470e-02]
 [ 7.24363077e-03]
 [ 4.21794174e-03]
 [ 1.95792627e-02]
 [ 5.37675999e-04]
 [-1.58147510e-02]
 [-3.89286784e-05]
 [ 1.36548118e-03]
 [ 1.52007836e-03]
 [-1.14233826e-02]
 [-4.27102175e-03]
 [ 1.59537206e-02]
 [-1.02239370e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.71898193]
curr_Stock_Price:  99.94046026397815
curr_Factors:  [99.94046026]
mat_Sqrt:  [[0.15]]
grads:  [-0.08909442]
Stock Position:  -0.08909442257980847
Bond Position:  [9.62311953]


portfolio before change:  [0.70820214]
curr_Stock_Price:  100.06820401557329
curr_Factors:  [100.06820402]
mat_Sqrt:  [[0.15]]
grads:  [0.08197256]
Stock Position:  0.08197256256347207
Bond Position:  [-7.49464498]


portfolio before change:  [0.72331262]
curr_Stock_Price:  100.25825433863803
curr_Factors:  [100.25825434]
mat_Sqrt:  [[0.15]]
grads:  [0.05861427]
Stock Position:  0.05861427099697771
Bond Position:  [-5.15325187]


portfolio before change:  [0.72987474]
curr_Stock_Price:  100.37570373204069
curr_Factors:  [100.37570373]
mat_Sqrt:  [[0.15]]
grads:  [-0.06268776]
Stock Position:  -0.0626877581802894
Bond Position:  [7.02220258]


portfolio before change:  [0.71935482]
curr_Stock_Price:  100.55051974422845
curr_Factors:  [100.55051974]
mat_Sqrt:  [[0.15]]
grads:  [-0.00517332]
Stock Position:  -0.0051733177678000425
Bond Position:  [1.23953461]


portfolio before change:  [0.7200581]
curr_Stock_Price:  100.42955129294259
curr_Factors:  [100.42955129]
mat_Sqrt:  [[0.15]]
grads:  [-0.01814129]
Stock Position:  -0.01814129176464034
Bond Position:  [2.54197989]


portfolio before change:  [0.72162458]
curr_Stock_Price:  100.35196025123388
curr_Factors:  [100.35196025]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759118]
Stock Position:  -0.007591182383565309
Bond Position:  [1.48341461]


portfolio before change:  [0.7181496]
curr_Stock_Price:  100.82193908122794
curr_Factors:  [100.82193908]
mat_Sqrt:  [[0.15]]
grads:  [-0.16908676]
Stock Position:  -0.16908675889376484
Bond Position:  [17.76580451]


portfolio before change:  [0.76966391]
curr_Stock_Price:  100.52384412534805
curr_Factors:  [100.52384413]
mat_Sqrt:  [[0.15]]
grads:  [0.02571344]
Stock Position:  0.02571343861147206
Bond Position:  [-1.81514979]


portfolio before change:  [0.77948416]
curr_Stock_Price:  100.9101673789521
curr_Factors:  [100.91016738]
mat_Sqrt:  [[0.15]]
grads:  [-0.00038058]
Stock Position:  -0.000380577617350511
Bond Position:  [0.81788831]


portfolio before change:  [0.77939336]
curr_Stock_Price:  101.28307288077188
curr_Factors:  [101.28307288]
mat_Sqrt:  [[0.15]]
grads:  [-0.05770027]
Stock Position:  -0.0577002734108727
Bond Position:  [6.62345436]


portfolio before change:  [0.80705041]
curr_Stock_Price:  100.81092485450392
curr_Factors:  [100.81092485]
mat_Sqrt:  [[0.15]]
grads:  [0.024739]
Stock Position:  0.02473899928244011
Bond Position:  [-1.68691099]


portfolio before change:  [0.80357052]
curr_Stock_Price:  100.67452276473894
curr_Factors:  [100.67452276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01950078]
Stock Position:  -0.019500775253726704
Bond Position:  [2.76680176]


portfolio before change:  [0.79797488]
curr_Stock_Price:  100.97033528641863
curr_Factors:  [100.97033529]
mat_Sqrt:  [[0.15]]
grads:  [0.03944773]
Stock Position:  0.039447730511823244
Bond Position:  [-3.1850757]


portfolio before change:  [0.82537579]
curr_Stock_Price:  101.66999485147281
curr_Factors:  [101.66999485]
mat_Sqrt:  [[0.15]]
grads:  [0.01932258]
Stock Position:  0.019322584277970206
Bond Position:  [-1.13915126]


portfolio before change:  [0.8152675]
curr_Stock_Price:  101.15054613283483
curr_Factors:  [101.15054613]
mat_Sqrt:  [[0.15]]
grads:  [0.10721853]
Stock Position:  0.10721853493632881
Bond Position:  [-10.02994587]


portfolio before change:  [0.83387899]
curr_Stock_Price:  101.32997768146835
curr_Factors:  [101.32997768]
mat_Sqrt:  [[0.15]]
grads:  [0.42394344]
Stock Position:  0.4239434381478354
Bond Position:  [-42.12430013]


portfolio before change:  [0.96388219]
curr_Stock_Price:  101.64284029256982
curr_Factors:  [101.64284029]
mat_Sqrt:  [[0.15]]
grads:  [-0.08916778]
Stock Position:  -0.08916778091007628
Bond Position:  [10.02714871]


portfolio before change:  [0.98578984]
curr_Stock_Price:  101.40417860698373
curr_Factors:  [101.40417861]
mat_Sqrt:  [[0.15]]
grads:  [0.122657]
Stock Position:  0.12265700464432513
Bond Position:  [-11.45214297]


portfolio before change:  [0.93573959]
curr_Stock_Price:  101.00196370866652
curr_Factors:  [101.00196371]
mat_Sqrt:  [[0.15]]
grads:  [0.01238929]
Stock Position:  0.012389291671629854
Bond Position:  [-0.3156032]


portfolio before change:  [0.93513799]
curr_Stock_Price:  100.95499823884589
curr_Factors:  [100.95499824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02587637]
Stock Position:  -0.025876368739742635
Bond Position:  [3.54748675]


portfolio before change:  [0.93406912]
curr_Stock_Price:  101.00487362810343
curr_Factors:  [101.00487363]
mat_Sqrt:  [[0.15]]
grads:  [0.02949938]
Stock Position:  0.029499379061865803
Bond Position:  [-2.04551193]


portfolio before change:  [0.9233727]
curr_Stock_Price:  100.6466093191679
curr_Factors:  [100.64660932]
mat_Sqrt:  [[0.15]]
grads:  [0.10070056]
Stock Position:  0.10070056079541466
Bond Position:  [-9.2117973]


portfolio before change:  [0.96714964]
curr_Stock_Price:  101.08705073741241
curr_Factors:  [101.08705074]
mat_Sqrt:  [[0.15]]
grads:  [0.1340474]
Stock Position:  0.13404740352728312
Bond Position:  [-12.58330704]


portfolio before change:  [0.97728627]
curr_Stock_Price:  101.16853766260415
curr_Factors:  [101.16853766]
mat_Sqrt:  [[0.15]]
grads:  [-0.01687589]
Stock Position:  -0.01687589213552063
Bond Position:  [2.6845956]


portfolio before change:  [0.97966815]
curr_Stock_Price:  101.03733944469286
curr_Factors:  [101.03733944]
mat_Sqrt:  [[0.15]]
grads:  [0.04559108]
Stock Position:  0.04559108033063103
Bond Position:  [-3.62673331]


portfolio before change:  [0.98326113]
curr_Stock_Price:  101.12112035940322
curr_Factors:  [101.12112036]
mat_Sqrt:  [[0.15]]
grads:  [-0.06667351]
Stock Position:  -0.06667350621295572
Bond Position:  [7.72536078]


portfolio before change:  [0.97840287]
curr_Stock_Price:  101.20122887616299
curr_Factors:  [101.20122888]
mat_Sqrt:  [[0.15]]
grads:  [0.05808732]
Stock Position:  0.05808732072374902
Bond Position:  [-4.90010537]


portfolio before change:  [0.9124215]
curr_Stock_Price:  100.07060180011855
curr_Factors:  [100.0706018]
mat_Sqrt:  [[0.15]]
grads:  [0.16484708]
Stock Position:  0.16484707926774955
Bond Position:  [-15.58392492]


portfolio before change:  [1.02275563]
curr_Stock_Price:  100.74582244773464
curr_Factors:  [100.74582245]
mat_Sqrt:  [[0.15]]
grads:  [0.03340135]
Stock Position:  0.03340135175544234
Bond Position:  [-2.34229102]


portfolio before change:  [1.01815086]
curr_Stock_Price:  100.61234370555245
curr_Factors:  [100.61234371]
mat_Sqrt:  [[0.15]]
grads:  [-0.04725384]
Stock Position:  -0.04725384377107301
Bond Position:  [5.77247083]


portfolio before change:  [1.00062299]
curr_Stock_Price:  100.9909089845263
curr_Factors:  [100.99090898]
mat_Sqrt:  [[0.15]]
grads:  [0.0758982]
Stock Position:  0.07589819739818512
Bond Position:  [-6.66440496]


portfolio before change:  [1.04917319]
curr_Stock_Price:  101.63607236933866
curr_Factors:  [101.63607237]
mat_Sqrt:  [[0.15]]
grads:  [0.08579863]
Stock Position:  0.08579862814846329
Bond Position:  [-7.67106239]


portfolio before change:  [1.05809942]
curr_Stock_Price:  101.7456974781764
curr_Factors:  [101.74569748]
mat_Sqrt:  [[0.15]]
grads:  [0.04281829]
Stock Position:  0.04281828559854738
Bond Position:  [-3.29847692]


portfolio before change:  [1.04010902]
curr_Stock_Price:  101.33035547592213
curr_Factors:  [101.33035548]
mat_Sqrt:  [[0.15]]
grads:  [0.03704049]
Stock Position:  0.03704048614351652
Bond Position:  [-2.71321661]


portfolio before change:  [1.01154986]
curr_Stock_Price:  100.5639081950999
curr_Factors:  [100.5639082]
mat_Sqrt:  [[0.15]]
grads:  [0.07935689]
Stock Position:  0.07935688922604461
Bond Position:  [-6.96888906]


portfolio before change:  [1.02055498]
curr_Stock_Price:  100.68287315198083
curr_Factors:  [100.68287315]
mat_Sqrt:  [[0.15]]
grads:  [-0.18104396]
Stock Position:  -0.18104395908480586
Bond Position:  [19.24858095]


portfolio before change:  [0.8810734]
curr_Stock_Price:  101.45994772689384
curr_Factors:  [101.45994773]
mat_Sqrt:  [[0.15]]
grads:  [0.01268088]
Stock Position:  0.012680877901038452
Bond Position:  [-0.40552781]


portfolio before change:  [0.8717638]
curr_Stock_Price:  100.72780171423588
curr_Factors:  [100.72780171]
mat_Sqrt:  [[0.15]]
grads:  [-0.35396452]
Stock Position:  -0.3539645160452654
Bond Position:  [36.52583138]


portfolio before change:  [0.8305373]
curr_Stock_Price:  100.85072202661728
curr_Factors:  [100.85072203]
mat_Sqrt:  [[0.15]]
grads:  [0.09178646]
Stock Position:  0.09178645531703641
Bond Position:  [-8.42619299]


portfolio before change:  [0.90540421]
curr_Stock_Price:  101.67212384729284
curr_Factors:  [101.67212385]
mat_Sqrt:  [[0.15]]
grads:  [0.02873286]
Stock Position:  0.028732862389280293
Bond Position:  [-2.01592693]


portfolio before change:  [0.89573028]
curr_Stock_Price:  101.33982388794622
curr_Factors:  [101.33982389]
mat_Sqrt:  [[0.15]]
grads:  [0.05605129]
Stock Position:  0.056051290234420244
Bond Position:  [-4.7844976]


portfolio before change:  [0.90554997]
curr_Stock_Price:  101.52035010970958
curr_Factors:  [101.52035011]
mat_Sqrt:  [[0.15]]
grads:  [-0.02904447]
Stock Position:  -0.029044466193843915
Bond Position:  [3.85415435]


portfolio before change:  [0.88146129]
curr_Stock_Price:  102.35801650795894
curr_Factors:  [102.35801651]
mat_Sqrt:  [[0.15]]
grads:  [-0.01075302]
Stock Position:  -0.010753017361574456
Bond Position:  [1.98211882]


portfolio before change:  [0.88394074]
curr_Stock_Price:  102.13895608397024
curr_Factors:  [102.13895608]
mat_Sqrt:  [[0.15]]
grads:  [0.07432076]
Stock Position:  0.07432076127870668
Bond Position:  [-6.70710424]


portfolio before change:  [0.87386564]
curr_Stock_Price:  102.00903429047841
curr_Factors:  [102.00903429]
mat_Sqrt:  [[0.15]]
grads:  [0.08450837]
Stock Position:  0.0845083735941912
Bond Position:  [-7.74675194]


portfolio before change:  [0.89903634]
curr_Stock_Price:  102.31261235667093
curr_Factors:  [102.31261236]
mat_Sqrt:  [[0.15]]
grads:  [0.07059888]
Stock Position:  0.07059887759630366
Bond Position:  [-6.32411925]


portfolio before change:  [0.92512819]
curr_Stock_Price:  102.68778999562178
curr_Factors:  [102.68779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00615323]
Stock Position:  -0.006153229831263253
Bond Position:  [1.55698977]


portfolio before change:  [0.92511184]
curr_Stock_Price:  102.70626295210154
curr_Factors:  [102.70626295]
mat_Sqrt:  [[0.15]]
grads:  [0.08521669]
Stock Position:  0.08521669324154278
Bond Position:  [-7.82717626]


portfolio before change:  [0.89935285]
curr_Stock_Price:  102.40972739552437
curr_Factors:  [102.4097274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782801]
Stock Position:  -0.00782800561827578
Bond Position:  [1.70101677]


portfolio before change:  [0.90298681]
curr_Stock_Price:  101.95908328304992
curr_Factors:  [101.95908328]
mat_Sqrt:  [[0.15]]
grads:  [0.11533038]
Stock Position:  0.11533037720868225
Bond Position:  [-10.85599273]


portfolio before change:  [0.99287987]
curr_Stock_Price:  102.74440614170786
curr_Factors:  [102.74440614]
mat_Sqrt:  [[0.15]]
grads:  [-0.04074912]
Stock Position:  -0.04074911597673876
Bond Position:  [5.17962359]


portfolio before change:  [0.99654008]
curr_Stock_Price:  102.6625276465924
curr_Factors:  [102.66252765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230356]
Stock Position:  -0.0023035590941014334
Bond Position:  [1.23302928]


portfolio before change:  [0.99880789]
curr_Stock_Price:  101.71150255121633
curr_Factors:  [101.71150255]
mat_Sqrt:  [[0.15]]
grads:  [-0.02263193]
Stock Position:  -0.02263193201406134
Bond Position:  [3.3007357]


portfolio before change:  [0.99107443]
curr_Stock_Price:  102.06232367955454
curr_Factors:  [102.06232368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01996259]
Stock Position:  -0.019962594676086236
Bond Position:  [3.02850323]


portfolio before change:  [0.9848603]
curr_Stock_Price:  102.38309483758883
curr_Factors:  [102.38309484]
mat_Sqrt:  [[0.15]]
grads:  [-0.02161754]
Stock Position:  -0.021617543692340063
Bond Position:  [3.19813132]


portfolio before change:  [0.98232071]
curr_Stock_Price:  102.50981966137596
curr_Factors:  [102.50981966]
mat_Sqrt:  [[0.15]]
grads:  [0.07118094]
Stock Position:  0.07118094288547308
Bond Position:  [-6.31442491]


portfolio before change:  [1.02169394]
curr_Stock_Price:  103.06850712808253
curr_Factors:  [103.06850713]
mat_Sqrt:  [[0.15]]
grads:  [-0.08028758]
Stock Position:  -0.08028758151330705
Bond Position:  [9.29681511]


portfolio before change:  [1.02147026]
curr_Stock_Price:  103.07853046540002
curr_Factors:  [103.07853047]
mat_Sqrt:  [[0.15]]
grads:  [0.03365001]
Stock Position:  0.03365001236354608
Bond Position:  [-2.44712356]


portfolio before change:  [1.02029099]
curr_Stock_Price:  103.04803049757827
curr_Factors:  [103.0480305]
mat_Sqrt:  [[0.15]]
grads:  [-0.02511651]
Stock Position:  -0.02511650670429311
Bond Position:  [3.60849754]


portfolio before change:  [1.01152807]
curr_Stock_Price:  103.40590102953493
curr_Factors:  [103.40590103]
mat_Sqrt:  [[0.15]]
grads:  [-0.02535237]
Stock Position:  -0.025352373914317
Bond Position:  [3.63311314]


portfolio before change:  [1.02235063]
curr_Stock_Price:  102.98797248214191
curr_Factors:  [102.98797248]
mat_Sqrt:  [[0.15]]
grads:  [0.04832833]
Stock Position:  0.048328334795544554
Bond Position:  [-3.95488659]


portfolio before change:  [1.01204759]
curr_Stock_Price:  102.77989890223456
curr_Factors:  [102.7798989]
mat_Sqrt:  [[0.15]]
grads:  [-0.12288983]
Stock Position:  -0.12288982978376417
Bond Position:  [13.64265187]


portfolio before change:  [1.02163283]
curr_Stock_Price:  102.70883896494269
curr_Factors:  [102.70883896]
mat_Sqrt:  [[0.15]]
grads:  [0.02166983]
Stock Position:  0.02166983372140907
Bond Position:  [-1.20405064]


portfolio before change:  [1.0096069]
curr_Stock_Price:  102.15735014449433
curr_Factors:  [102.15735014]
mat_Sqrt:  [[0.15]]
grads:  [0.16915956]
Stock Position:  0.1691595608379969
Bond Position:  [-16.27128559]


portfolio before change:  [1.05980462]
curr_Stock_Price:  102.46010989526094
curr_Factors:  [102.4601099]
mat_Sqrt:  [[0.15]]
grads:  [0.04647833]
Stock Position:  0.04647832637669801
Bond Position:  [-3.70236981]


portfolio before change:  [1.04716374]
curr_Stock_Price:  102.19311514007211
curr_Factors:  [102.19311514]
mat_Sqrt:  [[0.15]]
grads:  [0.09827498]
Stock Position:  0.09827498025150926
Bond Position:  [-8.99586263]


portfolio before change:  [1.11154817]
curr_Stock_Price:  102.85398204227097
curr_Factors:  [102.85398204]
mat_Sqrt:  [[0.15]]
grads:  [0.04829087]
Stock Position:  0.048290871817016336
Bond Position:  [-3.8553603]


portfolio before change:  [1.08737648]
curr_Stock_Price:  102.35842841536054
curr_Factors:  [102.35842842]
mat_Sqrt:  [[0.15]]
grads:  [0.02811961]
Stock Position:  0.028119611608011935
Bond Position:  [-1.79090277]


portfolio before change:  [1.0709729]
curr_Stock_Price:  101.77905896542504
curr_Factors:  [101.77905897]
mat_Sqrt:  [[0.15]]
grads:  [0.13052842]
Stock Position:  0.13052841811371407
Bond Position:  [-12.21408666]


portfolio before change:  [1.05036411]
curr_Stock_Price:  101.62702015596034
curr_Factors:  [101.62702016]
mat_Sqrt:  [[0.15]]
grads:  [0.00358451]
Stock Position:  0.0035845066595709624
Bond Position:  [0.68608138]


portfolio before change:  [1.049547]
curr_Stock_Price:  101.38709930159173
curr_Factors:  [101.3870993]
mat_Sqrt:  [[0.15]]
grads:  [-0.10543167]
Stock Position:  -0.10543167300042268
Bond Position:  [11.7389585]


portfolio before change:  [1.01523748]
curr_Stock_Price:  101.71947784639244
curr_Factors:  [101.71947785]
mat_Sqrt:  [[0.15]]
grads:  [-0.00025952]
Stock Position:  -0.00025952452277689064
Bond Position:  [1.04163618]


portfolio before change:  [1.01534645]
curr_Stock_Price:  101.55043690981961
curr_Factors:  [101.55043691]
mat_Sqrt:  [[0.15]]
grads:  [0.00910321]
Stock Position:  0.009103207877077158
Bond Position:  [0.09091172]


portfolio before change:  [1.01811848]
curr_Stock_Price:  101.85432324644616
curr_Factors:  [101.85432325]
mat_Sqrt:  [[0.15]]
grads:  [0.01013386]
Stock Position:  0.010133855749037923
Bond Position:  [-0.01405854]


portfolio before change:  [1.0100071]
curr_Stock_Price:  101.05398602774454
curr_Factors:  [101.05398603]
mat_Sqrt:  [[0.15]]
grads:  [-0.07615588]
Stock Position:  -0.07615588379290573
Bond Position:  [8.70586271]


portfolio before change:  [0.97757931]
curr_Stock_Price:  101.48693902234574
curr_Factors:  [101.48693902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02847348]
Stock Position:  -0.02847347834663039
Bond Position:  [3.86726547]


portfolio before change:  [0.98716381]
curr_Stock_Price:  101.15881647937753
curr_Factors:  [101.15881648]
mat_Sqrt:  [[0.15]]
grads:  [0.10635814]
Stock Position:  0.10635813746541316
Bond Position:  [-9.7718995]


portfolio before change:  [1.00483951]
curr_Stock_Price:  101.33074933070598
curr_Factors:  [101.33074933]
mat_Sqrt:  [[0.15]]
grads:  [-0.06815958]
Stock Position:  -0.06815957998980693
Bond Position:  [7.91150082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.99520171]
Stock Price:  101.47940468062014
PL:  [-0.48420297]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37653246e-02]
 [-2.08636796e-02]
 [ 9.38218642e-03]
 [-1.22216132e-02]
 [ 1.09624509e-02]
 [-1.38717363e-02]
 [-7.91554952e-03]
 [ 1.93928680e-02]
 [-1.95395592e-02]
 [-1.26162059e-02]
 [ 1.47533252e-02]
 [-9.62961004e-04]
 [ 5.10774337e-04]
 [-3.52836692e-03]
 [-7.65201298e-04]
 [ 5.54752126e-03]
 [-2.92090617e-02]
 [-1.16999342e-02]
 [ 2.48230703e-02]
 [-2.76221683e-03]
 [-1.75268993e-02]
 [ 5.55344867e-03]
 [ 1.28215386e-02]
 [ 1.89299416e-02]
 [ 1.80901358e-03]
 [ 4.41445368e-03]
 [ 4.75843452e-04]
 [ 1.16247585e-02]
 [-1.10845296e-03]
 [ 3.61766737e-02]
 [-7.04407143e-03]
 [ 1.61061635e-02]
 [ 1.14717935e-02]
 [-2.02363729e-02]
 [-1.21267963e-02]
 [-1.40423058e-02]
 [ 7.92405766e-03]
 [-1.34002202e-03]
 [ 1.99586938e-02]
 [ 9.86901662e-03]
 [ 6.67365281e-03]
 [ 3.58041285e-02]
 [-3.37236188e-03]
 [ 1.61259380e-02]
 [-6.48840520e-02]
 [ 2.50351388e-02]
 [ 9.16782512e-03]
 [ 5.39191030e-03]
 [-1.08867908e-02]
 [ 1.16656824e-04]
 [-1.78361472e-03]
 [-2.82348606e-03]
 [-5.81311907e-04]
 [ 6.62203614e-03]
 [-1.11077123e-02]
 [-4.97161760e-03]
 [-1.36998021e-03]
 [ 1.24715243e-02]
 [ 7.48638817e-03]
 [-3.09462310e-03]
 [-5.14595222e-03]
 [-8.49497306e-04]
 [-5.13432486e-03]
 [ 1.01465992e-03]
 [ 1.91464181e-02]
 [ 3.93091261e-03]
 [ 1.57375892e-02]
 [-1.97222574e-03]
 [ 4.53296237e-03]
 [ 2.42943013e-02]
 [ 3.21169365e-03]
 [-1.53594246e-02]
 [-5.81974183e-03]
 [ 2.07396587e-03]
 [ 1.03754998e-02]
 [ 3.96392154e-03]
 [-1.11692545e-03]
 [-2.11215373e-02]
 [-3.02449062e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.35299393]
curr_Stock_Price:  99.66468356353091
curr_Factors:  [99.66468356]
mat_Sqrt:  [[0.15]]
grads:  [-0.09176883]
Stock Position:  -0.09176883049781875
Bond Position:  [3.79311752]


portfolio before change:  [-5.27476547]
curr_Stock_Price:  98.81481565156348
curr_Factors:  [98.81481565]
mat_Sqrt:  [[0.15]]
grads:  [-0.1390912]
Stock Position:  -0.13909119701382303
Bond Position:  [8.46950552]


portfolio before change:  [-5.35867325]
curr_Stock_Price:  99.42187875998714
curr_Factors:  [99.42187876]
mat_Sqrt:  [[0.15]]
grads:  [0.06254791]
Stock Position:  0.06254790944464655
Bond Position:  [-11.57730392]


portfolio before change:  [-5.40696301]
curr_Stock_Price:  98.66140318330957
curr_Factors:  [98.66140318]
mat_Sqrt:  [[0.15]]
grads:  [-0.08147742]
Stock Position:  -0.08147742135510959
Bond Position:  [2.63171371]


portfolio before change:  [-5.40544492]
curr_Stock_Price:  98.64478994001988
curr_Factors:  [98.64478994]
mat_Sqrt:  [[0.15]]
grads:  [0.07308301]
Stock Position:  0.07308300602249945
Bond Position:  [-12.61470269]


portfolio before change:  [-5.39157346]
curr_Stock_Price:  98.84538237677614
curr_Factors:  [98.84538238]
mat_Sqrt:  [[0.15]]
grads:  [-0.09247824]
Stock Position:  -0.09247824217915489
Bond Position:  [3.74947375]


portfolio before change:  [-5.40236202]
curr_Stock_Price:  98.96457696584287
curr_Factors:  [98.96457697]
mat_Sqrt:  [[0.15]]
grads:  [-0.05277033]
Stock Position:  -0.05277033014444215
Bond Position:  [-0.17996862]


portfolio before change:  [-5.39541664]
curr_Stock_Price:  98.83274859458295
curr_Factors:  [98.83274859]
mat_Sqrt:  [[0.15]]
grads:  [0.12928579]
Stock Position:  0.12928578665165852
Bond Position:  [-18.17308629]


portfolio before change:  [-5.43486583]
curr_Stock_Price:  98.5364024950906
curr_Factors:  [98.5364025]
mat_Sqrt:  [[0.15]]
grads:  [-0.13026373]
Stock Position:  -0.13026372819610338
Bond Position:  [7.40085332]


portfolio before change:  [-5.46380208]
curr_Stock_Price:  98.76208941298889
curr_Factors:  [98.76208941]
mat_Sqrt:  [[0.15]]
grads:  [-0.08410804]
Stock Position:  -0.08410803959273797
Bond Position:  [2.84288364]


portfolio before change:  [-5.54221076]
curr_Stock_Price:  99.6964396225999
curr_Factors:  [99.69643962]
mat_Sqrt:  [[0.15]]
grads:  [0.0983555]
Stock Position:  0.09835550114912674
Bond Position:  [-15.34790404]


portfolio before change:  [-5.47210466]
curr_Stock_Price:  100.41897550789449
curr_Factors:  [100.41897551]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641974]
Stock Position:  -0.006419740023400021
Bond Position:  [-4.82744094]


portfolio before change:  [-5.46117505]
curr_Stock_Price:  98.6694763156613
curr_Factors:  [98.66947632]
mat_Sqrt:  [[0.15]]
grads:  [0.00340516]
Stock Position:  0.0034051622434153514
Bond Position:  [-5.79716063]


portfolio before change:  [-5.4637663]
curr_Stock_Price:  98.01490609976754
curr_Factors:  [98.0149061]
mat_Sqrt:  [[0.15]]
grads:  [-0.02352245]
Stock Position:  -0.02352244611528911
Bond Position:  [-3.15821596]


portfolio before change:  [-5.45870576]
curr_Stock_Price:  97.79137738976183
curr_Factors:  [97.79137739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00510134]
Stock Position:  -0.005101341984426177
Bond Position:  [-4.9598385]


portfolio before change:  [-5.46087204]
curr_Stock_Price:  98.15525973279682
curr_Factors:  [98.15525973]
mat_Sqrt:  [[0.15]]
grads:  [0.03698348]
Stock Position:  0.03698347509371272
Bond Position:  [-9.09099465]


portfolio before change:  [-5.49431687]
curr_Stock_Price:  97.2663054447418
curr_Factors:  [97.26630544]
mat_Sqrt:  [[0.15]]
grads:  [-0.19472708]
Stock Position:  -0.19472707813246426
Bond Position:  [13.44606659]


portfolio before change:  [-5.53224009]
curr_Stock_Price:  97.46537191726836
curr_Factors:  [97.46537192]
mat_Sqrt:  [[0.15]]
grads:  [-0.07799956]
Stock Position:  -0.07799956113815815
Bond Position:  [2.07001614]


portfolio before change:  [-5.54630293]
curr_Stock_Price:  97.64732446676392
curr_Factors:  [97.64732447]
mat_Sqrt:  [[0.15]]
grads:  [0.16548714]
Stock Position:  0.1654871350415092
Bond Position:  [-21.7056789]


portfolio before change:  [-5.58471024]
curr_Stock_Price:  97.42343598651715
curr_Factors:  [97.42343599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01841478]
Stock Position:  -0.01841477889023294
Bond Position:  [-3.79067921]


portfolio before change:  [-5.5786773]
curr_Stock_Price:  97.08295579452742
curr_Factors:  [97.08295579]
mat_Sqrt:  [[0.15]]
grads:  [-0.116846]
Stock Position:  -0.11684599553217793
Bond Position:  [5.76507732]


portfolio before change:  [-5.64473053]
curr_Stock_Price:  97.65134120917385
curr_Factors:  [97.65134121]
mat_Sqrt:  [[0.15]]
grads:  [0.03702299]
Stock Position:  0.03702299115306164
Bond Position:  [-9.26007527]


portfolio before change:  [-5.64423084]
curr_Stock_Price:  97.68047093684902
curr_Factors:  [97.68047094]
mat_Sqrt:  [[0.15]]
grads:  [0.08547692]
Stock Position:  0.08547692401948503
Bond Position:  [-13.99365703]


portfolio before change:  [-5.68715554]
curr_Stock_Price:  97.18852438735435
curr_Factors:  [97.18852439]
mat_Sqrt:  [[0.15]]
grads:  [0.12619961]
Stock Position:  0.12619961046363426
Bond Position:  [-17.95230946]


portfolio before change:  [-5.65158676]
curr_Stock_Price:  97.47926092503315
curr_Factors:  [97.47926093]
mat_Sqrt:  [[0.15]]
grads:  [0.01206009]
Stock Position:  0.012060090525542421
Bond Position:  [-6.82719547]


portfolio before change:  [-5.65236097]
curr_Stock_Price:  97.45044753461025
curr_Factors:  [97.45044753]
mat_Sqrt:  [[0.15]]
grads:  [0.02942969]
Stock Position:  0.029429691210602363
Bond Position:  [-8.52029754]


portfolio before change:  [-5.6654938]
curr_Stock_Price:  97.02229838413986
curr_Factors:  [97.02229838]
mat_Sqrt:  [[0.15]]
grads:  [0.00317229]
Stock Position:  0.0031722896786081506
Bond Position:  [-5.97327663]


portfolio before change:  [-5.66619476]
curr_Stock_Price:  96.91902125836036
curr_Factors:  [96.91902126]
mat_Sqrt:  [[0.15]]
grads:  [0.07749839]
Stock Position:  0.0774983898256048
Bond Position:  [-13.17726286]


portfolio before change:  [-5.68544945]
curr_Stock_Price:  96.68119594966423
curr_Factors:  [96.68119595]
mat_Sqrt:  [[0.15]]
grads:  [-0.00738969]
Stock Position:  -0.007389686382230134
Bond Position:  [-4.97100573]


portfolio before change:  [-5.68884187]
curr_Stock_Price:  97.09822644959836
curr_Factors:  [97.09822645]
mat_Sqrt:  [[0.15]]
grads:  [0.24117782]
Stock Position:  0.24117782452446318
Bond Position:  [-29.10678089]


portfolio before change:  [-5.66779871]
curr_Stock_Price:  97.19302118083289
curr_Factors:  [97.19302118]
mat_Sqrt:  [[0.15]]
grads:  [-0.04696048]
Stock Position:  -0.04696047620979755
Bond Position:  [-1.10356815]


portfolio before change:  [-5.69408652]
curr_Stock_Price:  97.75133819829401
curr_Factors:  [97.7513382]
mat_Sqrt:  [[0.15]]
grads:  [0.10737442]
Stock Position:  0.10737442357867273
Bond Position:  [-16.19008011]


portfolio before change:  [-5.63244528]
curr_Stock_Price:  98.3348398277673
curr_Factors:  [98.33483983]
mat_Sqrt:  [[0.15]]
grads:  [0.07647862]
Stock Position:  0.0764786236331584
Bond Position:  [-13.15295849]


portfolio before change:  [-5.70386804]
curr_Stock_Price:  97.41169725552281
curr_Factors:  [97.41169726]
mat_Sqrt:  [[0.15]]
grads:  [-0.13490915]
Stock Position:  -0.13490915261383835
Bond Position:  [7.43786149]


portfolio before change:  [-5.57630959]
curr_Stock_Price:  96.46962945028861
curr_Factors:  [96.46962945]
mat_Sqrt:  [[0.15]]
grads:  [-0.08084531]
Stock Position:  -0.0808453087361632
Bond Position:  [2.22280739]


portfolio before change:  [-5.57497533]
curr_Stock_Price:  96.4548440220552
curr_Factors:  [96.45484402]
mat_Sqrt:  [[0.15]]
grads:  [-0.09361537]
Stock Position:  -0.09361537176829483
Bond Position:  [3.45468075]


portfolio before change:  [-5.61084362]
curr_Stock_Price:  96.8402958965239
curr_Factors:  [96.8402959]
mat_Sqrt:  [[0.15]]
grads:  [0.05282705]
Stock Position:  0.05282705109528036
Bond Position:  [-10.72663088]


portfolio before change:  [-5.60571615]
curr_Stock_Price:  96.95004853807309
curr_Factors:  [96.95004854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893348]
Stock Position:  -0.0089334801150546
Bond Position:  [-4.73961482]


portfolio before change:  [-5.59781708]
curr_Stock_Price:  96.03267845861394
curr_Factors:  [96.03267846]
mat_Sqrt:  [[0.15]]
grads:  [0.13305796]
Stock Position:  0.13305795891833866
Bond Position:  [-18.37572926]


portfolio before change:  [-5.6695144]
curr_Stock_Price:  95.50246743335606
curr_Factors:  [95.50246743]
mat_Sqrt:  [[0.15]]
grads:  [0.06579344]
Stock Position:  0.06579344412756714
Bond Position:  [-11.95295065]


portfolio before change:  [-5.67937794]
curr_Stock_Price:  95.36390551678438
curr_Factors:  [95.36390552]
mat_Sqrt:  [[0.15]]
grads:  [0.04449102]
Stock Position:  0.04449101871948692
Bond Position:  [-9.92221525]


portfolio before change:  [-5.67418194]
curr_Stock_Price:  95.49463205310909
curr_Factors:  [95.49463205]
mat_Sqrt:  [[0.15]]
grads:  [0.23869419]
Stock Position:  0.2386941901494588
Bond Position:  [-28.46819581]


portfolio before change:  [-5.63854203]
curr_Stock_Price:  95.65139848044963
curr_Factors:  [95.65139848]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248241]
Stock Position:  -0.02248241254310761
Bond Position:  [-3.48806783]


portfolio before change:  [-5.64385642]
curr_Stock_Price:  95.87808174053745
curr_Factors:  [95.87808174]
mat_Sqrt:  [[0.15]]
grads:  [0.10750625]
Stock Position:  0.10750625329137814
Bond Position:  [-15.95134977]


portfolio before change:  [-5.76474807]
curr_Stock_Price:  94.76284750384234
curr_Factors:  [94.7628475]
mat_Sqrt:  [[0.15]]
grads:  [-0.43256035]
Stock Position:  -0.43256034647691394
Bond Position:  [35.22590208]


portfolio before change:  [-5.68309246]
curr_Stock_Price:  94.57916463614838
curr_Factors:  [94.57916464]
mat_Sqrt:  [[0.15]]
grads:  [0.16690093]
Stock Position:  0.16690092525554304
Bond Position:  [-21.46844254]


portfolio before change:  [-5.54878399]
curr_Stock_Price:  95.39192397755727
curr_Factors:  [95.39192398]
mat_Sqrt:  [[0.15]]
grads:  [0.06111883]
Stock Position:  0.061118834162067204
Bond Position:  [-11.37902717]


portfolio before change:  [-5.56910884]
curr_Stock_Price:  95.07101413435646
curr_Factors:  [95.07101413]
mat_Sqrt:  [[0.15]]
grads:  [0.03594607]
Stock Position:  0.03594606866592779
Bond Position:  [-8.98653804]


portfolio before change:  [-5.57040452]
curr_Stock_Price:  95.05059449638077
curr_Factors:  [95.0505945]
mat_Sqrt:  [[0.15]]
grads:  [-0.07257861]
Stock Position:  -0.07257860562651557
Bond Position:  [1.32823509]


portfolio before change:  [-5.57422481]
curr_Stock_Price:  95.10437487009315
curr_Factors:  [95.10437487]
mat_Sqrt:  [[0.15]]
grads:  [0.00077771]
Stock Position:  0.0007777121594363869
Bond Position:  [-5.64818864]


portfolio before change:  [-5.57442241]
curr_Stock_Price:  95.3042110799052
curr_Factors:  [95.30421108]
mat_Sqrt:  [[0.15]]
grads:  [-0.01189076]
Stock Position:  -0.01189076482400774
Bond Position:  [-4.44118245]


portfolio before change:  [-5.57633578]
curr_Stock_Price:  95.44177882093406
curr_Factors:  [95.44177882]
mat_Sqrt:  [[0.15]]
grads:  [-0.01882324]
Stock Position:  -0.018823240417820023
Bond Position:  [-3.77981223]


portfolio before change:  [-5.5738463]
curr_Stock_Price:  95.29697244301212
curr_Factors:  [95.29697244]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387541]
Stock Position:  -0.003875412711120215
Bond Position:  [-5.2045312]


portfolio before change:  [-5.57504033]
curr_Stock_Price:  95.52113829897476
curr_Factors:  [95.5211383]
mat_Sqrt:  [[0.15]]
grads:  [0.04414691]
Stock Position:  0.044146907588149036
Bond Position:  [-9.7920032]


portfolio before change:  [-5.541866]
curr_Stock_Price:  96.28645468253248
curr_Factors:  [96.28645468]
mat_Sqrt:  [[0.15]]
grads:  [-0.07405142]
Stock Position:  -0.07405141554760915
Bond Position:  [1.58828227]


portfolio before change:  [-5.53457134]
curr_Stock_Price:  96.18928720935652
curr_Factors:  [96.18928721]
mat_Sqrt:  [[0.15]]
grads:  [-0.03314412]
Stock Position:  -0.03314411730855459
Bond Position:  [-2.34646232]


portfolio before change:  [-5.54750001]
curr_Stock_Price:  96.57493673318774
curr_Factors:  [96.57493673]
mat_Sqrt:  [[0.15]]
grads:  [-0.0091332]
Stock Position:  -0.009133201411739194
Bond Position:  [-4.66546166]


portfolio before change:  [-5.55130651]
curr_Stock_Price:  96.95978481724075
curr_Factors:  [96.95978482]
mat_Sqrt:  [[0.15]]
grads:  [0.0831435]
Stock Position:  0.0831434951020966
Bond Position:  [-13.6128819]


portfolio before change:  [-5.58993783]
curr_Stock_Price:  96.50538372476161
curr_Factors:  [96.50538372]
mat_Sqrt:  [[0.15]]
grads:  [0.04990925]
Stock Position:  0.049909254440268926
Bond Position:  [-10.40644958]


portfolio before change:  [-5.5917208]
curr_Stock_Price:  96.48269170116865
curr_Factors:  [96.4826917]
mat_Sqrt:  [[0.15]]
grads:  [-0.02063082]
Stock Position:  -0.020630820663174627
Bond Position:  [-3.60120369]


portfolio before change:  [-5.6027669]
curr_Stock_Price:  97.00719908841988
curr_Factors:  [97.00719909]
mat_Sqrt:  [[0.15]]
grads:  [-0.03430635]
Stock Position:  -0.03430634811236919
Bond Position:  [-2.27480416]


portfolio before change:  [-5.61213059]
curr_Stock_Price:  97.2759980559729
curr_Factors:  [97.27599806]
mat_Sqrt:  [[0.15]]
grads:  [-0.00566332]
Stock Position:  -0.005663315375988871
Bond Position:  [-5.06122593]


portfolio before change:  [-5.61460207]
curr_Stock_Price:  97.6565421081791
curr_Factors:  [97.65654211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422883]
Stock Position:  -0.034228832392607926
Bond Position:  [-2.27193266]


portfolio before change:  [-5.63119266]
curr_Stock_Price:  98.13708993496975
curr_Factors:  [98.13708993]
mat_Sqrt:  [[0.15]]
grads:  [0.0067644]
Stock Position:  0.006764399457524472
Bond Position:  [-6.29503114]


portfolio before change:  [-5.63792591]
curr_Stock_Price:  97.19986007311289
curr_Factors:  [97.19986007]
mat_Sqrt:  [[0.15]]
grads:  [0.12764279]
Stock Position:  0.12764278765509723
Bond Position:  [-18.04478701]


portfolio before change:  [-5.59860792]
curr_Stock_Price:  97.51672731207894
curr_Factors:  [97.51672731]
mat_Sqrt:  [[0.15]]
grads:  [0.02620608]
Stock Position:  0.02620608407859881
Bond Position:  [-8.15413948]


portfolio before change:  [-5.61832076]
curr_Stock_Price:  96.78395130631571
curr_Factors:  [96.78395131]
mat_Sqrt:  [[0.15]]
grads:  [0.10491726]
Stock Position:  0.10491726144259919
Bond Position:  [-15.77262789]


portfolio before change:  [-5.62085453]
curr_Stock_Price:  96.76919733979355
curr_Factors:  [96.76919734]
mat_Sqrt:  [[0.15]]
grads:  [-0.01314817]
Stock Position:  -0.013148171623337975
Bond Position:  [-4.34851651]


portfolio before change:  [-5.6231198]
curr_Stock_Price:  96.92081361513888
curr_Factors:  [96.92081362]
mat_Sqrt:  [[0.15]]
grads:  [0.03021975]
Stock Position:  0.03021974914348729
Bond Position:  [-8.55204247]


portfolio before change:  [-5.63869889]
curr_Stock_Price:  96.42297456991226
curr_Factors:  [96.42297457]
mat_Sqrt:  [[0.15]]
grads:  [0.16196201]
Stock Position:  0.1619620086090099
Bond Position:  [-21.25555752]


portfolio before change:  [-5.73195782]
curr_Stock_Price:  95.85536973062567
curr_Factors:  [95.85536973]
mat_Sqrt:  [[0.15]]
grads:  [0.02141129]
Stock Position:  0.021411290974569893
Bond Position:  [-7.78434503]


portfolio before change:  [-5.72816611]
curr_Stock_Price:  96.05518237065957
curr_Factors:  [96.05518237]
mat_Sqrt:  [[0.15]]
grads:  [-0.10239616]
Stock Position:  -0.10239616401297644
Bond Position:  [4.1075161]


portfolio before change:  [-5.68698605]
curr_Stock_Price:  95.65552550688295
curr_Factors:  [95.65552551]
mat_Sqrt:  [[0.15]]
grads:  [-0.03879828]
Stock Position:  -0.03879827889538672
Bond Position:  [-1.9757163]


portfolio before change:  [-5.70693598]
curr_Stock_Price:  96.1665389137988
curr_Factors:  [96.16653891]
mat_Sqrt:  [[0.15]]
grads:  [0.01382644]
Stock Position:  0.013826439141756502
Bond Position:  [-7.03657678]


portfolio before change:  [-5.70715223]
curr_Stock_Price:  96.1827071765425
curr_Factors:  [96.18270718]
mat_Sqrt:  [[0.15]]
grads:  [0.06917]
Stock Position:  0.06916999850086779
Bond Position:  [-12.36010994]


portfolio before change:  [-5.71011115]
curr_Stock_Price:  96.15109822025865
curr_Factors:  [96.15109822]
mat_Sqrt:  [[0.15]]
grads:  [0.02642614]
Stock Position:  0.026426143604232587
Bond Position:  [-8.25101388]


portfolio before change:  [-5.71850693]
curr_Stock_Price:  95.8529060548072
curr_Factors:  [95.85290605]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744617]
Stock Position:  -0.007446169661020959
Bond Position:  [-5.00476993]


portfolio before change:  [-5.71251827]
curr_Stock_Price:  95.00663676408927
curr_Factors:  [95.00663676]
mat_Sqrt:  [[0.15]]
grads:  [-0.14081025]
Stock Position:  -0.1408102486601286
Bond Position:  [7.66538988]


portfolio before change:  [-5.75747529]
curr_Stock_Price:  95.32931302258129
curr_Factors:  [95.32931302]
mat_Sqrt:  [[0.15]]
grads:  [-0.20163271]
Stock Position:  -0.20163270799410277
Bond Position:  [13.46403224]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.64752319]
Stock Price:  94.78817775256395
PL:  [-5.64752319]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.07525226e-02]
 [ 1.51046388e-02]
 [ 1.02642888e-02]
 [-1.81883535e-02]
 [-1.81412078e-02]
 [-1.21522427e-03]
 [-9.39522165e-03]
 [-9.31837558e-03]
 [-1.08868258e-02]
 [-6.18414280e-03]
 [ 1.34640297e-02]
 [-5.55623019e-03]
 [-2.58746105e-03]
 [ 8.67299318e-03]
 [ 1.42150627e-04]
 [ 1.14199425e-02]
 [-2.56862704e-03]
 [-1.41405400e-02]
 [ 2.50312133e-02]
 [ 1.78070680e-03]
 [-4.45945847e-03]
 [ 4.98156396e-03]
 [ 1.83924116e-02]
 [ 1.76383648e-02]
 [-4.80106625e-03]
 [ 4.76429622e-03]
 [ 1.78966929e-05]
 [ 6.60141981e-03]
 [ 2.89079009e-02]
 [ 1.17589679e-03]
 [-7.65026118e-03]
 [ 8.03661444e-03]
 [ 1.25109566e-02]
 [ 8.59966567e-03]
 [ 5.32100296e-03]
 [ 1.09667677e-02]
 [-9.48404339e-03]
 [ 3.19468619e-03]
 [-5.69579863e-02]
 [ 1.40586944e-02]
 [ 5.93245190e-03]
 [ 8.87048047e-03]
 [-4.32095366e-03]
 [-4.37702771e-03]
 [ 1.75356753e-02]
 [ 1.34647272e-02]
 [ 1.08558681e-02]
 [ 2.99662111e-03]
 [ 1.22359305e-02]
 [-1.86217812e-03]
 [ 1.32038160e-03]
 [-7.13836360e-03]
 [ 1.87962509e-03]
 [ 5.90106969e-03]
 [-8.31410251e-03]
 [-4.39392267e-03]
 [ 4.30717554e-03]
 [ 5.53480864e-03]
 [ 7.33930675e-03]
 [-4.02762950e-03]
 [-5.22311027e-04]
 [ 5.70408651e-03]
 [-1.20497805e-02]
 [ 6.31172224e-03]
 [ 2.55253514e-02]
 [ 6.31159739e-03]
 [ 1.37877284e-02]
 [ 9.27546225e-03]
 [ 5.65660203e-03]
 [ 1.58416796e-02]
 [ 9.04265281e-04]
 [-1.53582192e-02]
 [-2.04865312e-03]
 [ 1.26672117e-03]
 [ 3.78728741e-03]
 [-1.51992694e-02]
 [-3.78718466e-03]
 [ 1.15016178e-02]
 [-4.82031553e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.90060872]
curr_Stock_Price:  100.03954528186287
curr_Factors:  [100.03954528]
mat_Sqrt:  [[0.15]]
grads:  [-0.07168348]
Stock Position:  -0.07168348406001775
Bond Position:  [10.07179187]


portfolio before change:  [2.88714058]
curr_Stock_Price:  100.23621039059807
curr_Factors:  [100.23621039]
mat_Sqrt:  [[0.15]]
grads:  [0.10069759]
Stock Position:  0.10069759206923316
Bond Position:  [-7.20640444]


portfolio before change:  [2.89266797]
curr_Stock_Price:  100.29557434305993
curr_Factors:  [100.29557434]
mat_Sqrt:  [[0.15]]
grads:  [0.06842859]
Stock Position:  0.06842859205739889
Bond Position:  [-3.97041697]


portfolio before change:  [2.92484221]
curr_Stock_Price:  100.76938786866587
curr_Factors:  [100.76938787]
mat_Sqrt:  [[0.15]]
grads:  [-0.12125569]
Stock Position:  -0.12125569022555842
Bond Position:  [15.14370389]


portfolio before change:  [2.90103309]
curr_Stock_Price:  100.9735484166485
curr_Factors:  [100.97354842]
mat_Sqrt:  [[0.15]]
grads:  [-0.12094139]
Stock Position:  -0.12094138502806033
Bond Position:  [15.11291389]


portfolio before change:  [2.84693242]
curr_Stock_Price:  101.4286883884541
curr_Factors:  [101.42868839]
mat_Sqrt:  [[0.15]]
grads:  [-0.0081015]
Stock Position:  -0.008101495160041989
Bond Position:  [3.66865645]


portfolio before change:  [2.85011864]
curr_Stock_Price:  101.06370336472429
curr_Factors:  [101.06370336]
mat_Sqrt:  [[0.15]]
grads:  [-0.06263481]
Stock Position:  -0.06263481098349442
Bond Position:  [9.1802246]


portfolio before change:  [2.9067719]
curr_Stock_Price:  100.16836297560985
curr_Factors:  [100.16836298]
mat_Sqrt:  [[0.15]]
grads:  [-0.0621225]
Stock Position:  -0.062122503886469
Bond Position:  [9.12948142]


portfolio before change:  [2.94130127]
curr_Stock_Price:  99.62172119684584
curr_Factors:  [99.6217212]
mat_Sqrt:  [[0.15]]
grads:  [-0.07257884]
Stock Position:  -0.07257883840760466
Bond Position:  [10.17173007]


portfolio before change:  [2.94153855]
curr_Stock_Price:  99.62721136096742
curr_Factors:  [99.62721136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04122762]
Stock Position:  -0.04122761865733208
Bond Position:  [7.04893123]


portfolio before change:  [2.95770368]
curr_Stock_Price:  99.24580291415828
curr_Factors:  [99.24580291]
mat_Sqrt:  [[0.15]]
grads:  [0.0897602]
Stock Position:  0.089760197678971
Bond Position:  [-5.9506192]


portfolio before change:  [2.98608792]
curr_Stock_Price:  99.5661694144643
curr_Factors:  [99.56616941]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704153]
Stock Position:  -0.03704153461633598
Bond Position:  [6.67417163]


portfolio before change:  [2.95469907]
curr_Stock_Price:  100.42482712990623
curr_Factors:  [100.42482713]
mat_Sqrt:  [[0.15]]
grads:  [-0.01724974]
Stock Position:  -0.0172497403026005
Bond Position:  [4.68700126]


portfolio before change:  [2.96638492]
curr_Stock_Price:  99.76435870449082
curr_Factors:  [99.7643587]
mat_Sqrt:  [[0.15]]
grads:  [0.05781995]
Stock Position:  0.05781995456457722
Bond Position:  [-2.80198576]


portfolio before change:  [2.95119559]
curr_Stock_Price:  99.50468705070186
curr_Factors:  [99.50468705]
mat_Sqrt:  [[0.15]]
grads:  [0.00094767]
Stock Position:  0.0009476708468609402
Bond Position:  [2.8568979]


portfolio before change:  [2.95123056]
curr_Stock_Price:  99.35316823665347
curr_Factors:  [99.35316824]
mat_Sqrt:  [[0.15]]
grads:  [0.07613295]
Stock Position:  0.07613294984763225
Bond Position:  [-4.61281921]


portfolio before change:  [2.87977192]
curr_Stock_Price:  98.41835182722723
curr_Factors:  [98.41835183]
mat_Sqrt:  [[0.15]]
grads:  [-0.01712418]
Stock Position:  -0.01712418025862759
Bond Position:  [4.56510552]


portfolio before change:  [2.87209418]
curr_Stock_Price:  98.88337056318417
curr_Factors:  [98.88337056]
mat_Sqrt:  [[0.15]]
grads:  [-0.09427027]
Stock Position:  -0.09427026647554125
Bond Position:  [12.19385588]


portfolio before change:  [2.89689653]
curr_Stock_Price:  98.62835690002913
curr_Factors:  [98.6283569]
mat_Sqrt:  [[0.15]]
grads:  [0.16687476]
Stock Position:  0.16687475501332963
Bond Position:  [-13.56168636]


portfolio before change:  [3.02336489]
curr_Stock_Price:  99.39130030076618
curr_Factors:  [99.3913003]
mat_Sqrt:  [[0.15]]
grads:  [0.01187138]
Stock Position:  0.011871378689121331
Bond Position:  [1.84345313]


portfolio before change:  [3.01879574]
curr_Stock_Price:  98.99670695544391
curr_Factors:  [98.99670696]
mat_Sqrt:  [[0.15]]
grads:  [-0.02972972]
Stock Position:  -0.02972972313214887
Bond Position:  [5.96194043]


portfolio before change:  [3.00961193]
curr_Stock_Price:  99.31815105005256
curr_Factors:  [99.31815105]
mat_Sqrt:  [[0.15]]
grads:  [0.03321043]
Stock Position:  0.033210426380215784
Bond Position:  [-0.28878621]


portfolio before change:  [3.01215867]
curr_Stock_Price:  99.395379419432
curr_Factors:  [99.39537942]
mat_Sqrt:  [[0.15]]
grads:  [0.12261608]
Stock Position:  0.12261607762188063
Bond Position:  [-9.17531289]


portfolio before change:  [3.03562523]
curr_Stock_Price:  99.59143884220246
curr_Factors:  [99.59143884]
mat_Sqrt:  [[0.15]]
grads:  [0.1175891]
Stock Position:  0.11758909869805106
Bond Position:  [-8.6752423]


portfolio before change:  [3.09189998]
curr_Stock_Price:  100.07462111822363
curr_Factors:  [100.07462112]
mat_Sqrt:  [[0.15]]
grads:  [-0.03200711]
Stock Position:  -0.03200710830987584
Bond Position:  [6.29499922]


portfolio before change:  [3.09124266]
curr_Stock_Price:  100.10745051924054
curr_Factors:  [100.10745052]
mat_Sqrt:  [[0.15]]
grads:  [0.03176197]
Stock Position:  0.03176197478690609
Bond Position:  [-0.08836766]


portfolio before change:  [3.09325167]
curr_Stock_Price:  100.17087645781767
curr_Factors:  [100.17087646]
mat_Sqrt:  [[0.15]]
grads:  [0.00011931]
Stock Position:  0.00011931128593990528
Bond Position:  [3.08130015]


portfolio before change:  [3.09343917]
curr_Stock_Price:  100.12824677568001
curr_Factors:  [100.12824678]
mat_Sqrt:  [[0.15]]
grads:  [0.04400947]
Stock Position:  0.0440094654107808
Bond Position:  [-1.31315144]


portfolio before change:  [3.10242995]
curr_Stock_Price:  100.33440366956262
curr_Factors:  [100.33440367]
mat_Sqrt:  [[0.15]]
grads:  [0.19271934]
Stock Position:  0.1927193391984336
Bond Position:  [-16.23395003]


portfolio before change:  [2.9786425]
curr_Stock_Price:  99.69734878124154
curr_Factors:  [99.69734878]
mat_Sqrt:  [[0.15]]
grads:  [0.00783931]
Stock Position:  0.007839311913287647
Bond Position:  [2.19708388]


portfolio before change:  [2.98439889]
curr_Stock_Price:  100.41412983717218
curr_Factors:  [100.41412984]
mat_Sqrt:  [[0.15]]
grads:  [-0.05100174]
Stock Position:  -0.051001741226609644
Bond Position:  [8.10569436]


portfolio before change:  [2.97715347]
curr_Stock_Price:  100.56612536913109
curr_Factors:  [100.56612537]
mat_Sqrt:  [[0.15]]
grads:  [0.05357743]
Stock Position:  0.0535774295754543
Bond Position:  [-2.41092102]


portfolio before change:  [2.99036302]
curr_Stock_Price:  100.8154884437269
curr_Factors:  [100.81548844]
mat_Sqrt:  [[0.15]]
grads:  [0.08340638]
Stock Position:  0.08340637761070359
Bond Position:  [-5.41829168]


portfolio before change:  [2.98215302]
curr_Stock_Price:  100.72111496481334
curr_Factors:  [100.72111496]
mat_Sqrt:  [[0.15]]
grads:  [0.0573311]
Stock Position:  0.05733110449405446
Bond Position:  [-2.79229975]


portfolio before change:  [3.00299587]
curr_Stock_Price:  101.08771136931334
curr_Factors:  [101.08771137]
mat_Sqrt:  [[0.15]]
grads:  [0.03547335]
Stock Position:  0.03547335307484059
Bond Position:  [-0.58292421]


portfolio before change:  [2.99027855]
curr_Stock_Price:  100.73023514883005
curr_Factors:  [100.73023515]
mat_Sqrt:  [[0.15]]
grads:  [0.07311178]
Stock Position:  0.07311178487536081
Bond Position:  [-4.37428873]


portfolio before change:  [2.91305456]
curr_Stock_Price:  99.67772910237072
curr_Factors:  [99.6777291]
mat_Sqrt:  [[0.15]]
grads:  [-0.06322696]
Stock Position:  -0.06322695593752917
Bond Position:  [9.21537394]


portfolio before change:  [2.91592426]
curr_Stock_Price:  99.64145154429205
curr_Factors:  [99.64145154]
mat_Sqrt:  [[0.15]]
grads:  [0.02129791]
Stock Position:  0.02129790793361557
Bond Position:  [0.79376979]


portfolio before change:  [2.92629283]
curr_Stock_Price:  100.12595757790834
curr_Factors:  [100.12595758]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971991]
Stock Position:  -0.3797199083822183
Bond Position:  [40.94611227]


portfolio before change:  [2.6635448]
curr_Stock_Price:  100.82464952607616
curr_Factors:  [100.82464953]
mat_Sqrt:  [[0.15]]
grads:  [0.09372463]
Stock Position:  0.09372462960743899
Bond Position:  [-6.78620813]


portfolio before change:  [2.68688719]
curr_Stock_Price:  101.07822784496845
curr_Factors:  [101.07822784]
mat_Sqrt:  [[0.15]]
grads:  [0.03954968]
Stock Position:  0.039549679362026004
Bond Position:  [-1.31072432]


portfolio before change:  [2.70464363]
curr_Stock_Price:  101.52926488560047
curr_Factors:  [101.52926489]
mat_Sqrt:  [[0.15]]
grads:  [0.05913654]
Stock Position:  0.05913653646600843
Bond Position:  [-3.29944544]


portfolio before change:  [2.70239408]
curr_Stock_Price:  101.49471210244039
curr_Factors:  [101.4947121]
mat_Sqrt:  [[0.15]]
grads:  [-0.02880636]
Stock Position:  -0.02880635770715827
Bond Position:  [5.62608706]


portfolio before change:  [2.70841832]
curr_Stock_Price:  101.29779022849583
curr_Factors:  [101.29779023]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918018]
Stock Position:  -0.029180184752243266
Bond Position:  [5.66430656]


portfolio before change:  [2.71243187]
curr_Stock_Price:  101.17237917852084
curr_Factors:  [101.17237918]
mat_Sqrt:  [[0.15]]
grads:  [0.1169045]
Stock Position:  0.11690450217119767
Bond Position:  [-9.11507475]


portfolio before change:  [2.74562032]
curr_Stock_Price:  101.4611461225729
curr_Factors:  [101.46114612]
mat_Sqrt:  [[0.15]]
grads:  [0.08976485]
Stock Position:  0.08976484803897773
Bond Position:  [-6.36202405]


portfolio before change:  [2.67958468]
curr_Stock_Price:  100.72992447144719
curr_Factors:  [100.72992447]
mat_Sqrt:  [[0.15]]
grads:  [0.07237245]
Stock Position:  0.07237245371681895
Bond Position:  [-4.61048712]


portfolio before change:  [2.72041098]
curr_Stock_Price:  101.2980199476082
curr_Factors:  [101.29801995]
mat_Sqrt:  [[0.15]]
grads:  [0.01997747]
Stock Position:  0.019977474065120036
Bond Position:  [0.69673241]


portfolio before change:  [2.71887608]
curr_Stock_Price:  101.21900876146773
curr_Factors:  [101.21900876]
mat_Sqrt:  [[0.15]]
grads:  [0.08157287]
Stock Position:  0.08157287013392726
Bond Position:  [-5.53784898]


portfolio before change:  [2.64705069]
curr_Stock_Price:  100.34274606380342
curr_Factors:  [100.34274606]
mat_Sqrt:  [[0.15]]
grads:  [-0.01241452]
Stock Position:  -0.012414520784900492
Bond Position:  [3.8927578]


portfolio before change:  [2.64794644]
curr_Stock_Price:  100.29019066638472
curr_Factors:  [100.29019067]
mat_Sqrt:  [[0.15]]
grads:  [0.00880254]
Stock Position:  0.008802544008182228
Bond Position:  [1.76513763]


portfolio before change:  [2.6455455]
curr_Stock_Price:  100.00490187680963
curr_Factors:  [100.00490188]
mat_Sqrt:  [[0.15]]
grads:  [-0.04758909]
Stock Position:  -0.047589090695765876
Bond Position:  [7.40468785]


portfolio before change:  [2.6647385]
curr_Stock_Price:  99.61132021516785
curr_Factors:  [99.61132022]
mat_Sqrt:  [[0.15]]
grads:  [0.01253083]
Stock Position:  0.012530833944998458
Bond Position:  [1.41652559]


portfolio before change:  [2.66133595]
curr_Stock_Price:  99.33272075479537
curr_Factors:  [99.33272075]
mat_Sqrt:  [[0.15]]
grads:  [0.03934046]
Stock Position:  0.03934046461153247
Bond Position:  [-1.24645943]


portfolio before change:  [2.61629953]
curr_Stock_Price:  98.18991486526417
curr_Factors:  [98.18991487]
mat_Sqrt:  [[0.15]]
grads:  [-0.05542735]
Stock Position:  -0.055427350097493604
Bond Position:  [8.05870632]


portfolio before change:  [2.5772493]
curr_Stock_Price:  98.9035322387539
curr_Factors:  [98.90353224]
mat_Sqrt:  [[0.15]]
grads:  [-0.02929282]
Stock Position:  -0.029292817790634775
Bond Position:  [5.47441245]


portfolio before change:  [2.55357795]
curr_Stock_Price:  99.72330705331059
curr_Factors:  [99.72330705]
mat_Sqrt:  [[0.15]]
grads:  [0.0287145]
Stock Position:  0.02871450357287218
Bond Position:  [-0.30992731]


portfolio before change:  [2.54706194]
curr_Stock_Price:  99.49705773904145
curr_Factors:  [99.49705774]
mat_Sqrt:  [[0.15]]
grads:  [0.03689872]
Stock Position:  0.036898724238670626
Bond Position:  [-1.12425256]


portfolio before change:  [2.54757753]
curr_Stock_Price:  99.51293521928487
curr_Factors:  [99.51293522]
mat_Sqrt:  [[0.15]]
grads:  [0.04892871]
Stock Position:  0.048928711684377776
Bond Position:  [-2.32146219]


portfolio before change:  [2.56245936]
curr_Stock_Price:  99.82005403407511
curr_Factors:  [99.82005403]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685086]
Stock Position:  -0.026850863347902872
Bond Position:  [5.24271399]


portfolio before change:  [2.55028353]
curr_Stock_Price:  100.28571905870263
curr_Factors:  [100.28571906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00348207]
Stock Position:  -0.003482073511594149
Bond Position:  [2.89948578]


portfolio before change:  [2.54994078]
curr_Stock_Price:  100.4361968172993
curr_Factors:  [100.43619682]
mat_Sqrt:  [[0.15]]
grads:  [0.03802724]
Stock Position:  0.038027243369092176
Bond Position:  [-1.26937092]


portfolio before change:  [2.58547802]
curr_Stock_Price:  101.3728037421791
curr_Factors:  [101.37280374]
mat_Sqrt:  [[0.15]]
grads:  [-0.08033187]
Stock Position:  -0.08033186983753453
Bond Position:  [10.7289449]


portfolio before change:  [2.58276945]
curr_Stock_Price:  101.41486861542963
curr_Factors:  [101.41486862]
mat_Sqrt:  [[0.15]]
grads:  [0.04207815]
Stock Position:  0.04207814829513353
Bond Position:  [-1.68458043]


portfolio before change:  [2.59341452]
curr_Stock_Price:  101.67035400370875
curr_Factors:  [101.670354]
mat_Sqrt:  [[0.15]]
grads:  [0.17016901]
Stock Position:  0.17016900905436
Bond Position:  [-14.70772888]


portfolio before change:  [2.68016506]
curr_Stock_Price:  102.18554655500655
curr_Factors:  [102.18554656]
mat_Sqrt:  [[0.15]]
grads:  [0.04207732]
Stock Position:  0.04207731596471154
Bond Position:  [-1.61952847]


portfolio before change:  [2.71634342]
curr_Stock_Price:  103.04775896139691
curr_Factors:  [103.04775896]
mat_Sqrt:  [[0.15]]
grads:  [0.09191819]
Stock Position:  0.09191818958079571
Bond Position:  [-6.75562002]


portfolio before change:  [2.76553036]
curr_Stock_Price:  103.58746912656805
curr_Factors:  [103.58746913]
mat_Sqrt:  [[0.15]]
grads:  [0.06183642]
Stock Position:  0.06183641503163694
Bond Position:  [-3.63994737]


portfolio before change:  [2.74269782]
curr_Stock_Price:  103.22190727224556
curr_Factors:  [103.22190727]
mat_Sqrt:  [[0.15]]
grads:  [0.03771068]
Stock Position:  0.037710680209123534
Bond Position:  [-1.14987051]


portfolio before change:  [2.72362913]
curr_Stock_Price:  102.71815536397983
curr_Factors:  [102.71815536]
mat_Sqrt:  [[0.15]]
grads:  [0.1056112]
Stock Position:  0.10561119757291007
Bond Position:  [-8.12455827]


portfolio before change:  [2.80474298]
curr_Stock_Price:  103.49100574692497
curr_Factors:  [103.49100575]
mat_Sqrt:  [[0.15]]
grads:  [0.00602844]
Stock Position:  0.006028435206972969
Bond Position:  [2.18085416]


portfolio before change:  [2.80465297]
curr_Stock_Price:  103.45346336298736
curr_Factors:  [103.45346336]
mat_Sqrt:  [[0.15]]
grads:  [-0.10238813]
Stock Position:  -0.10238812832447798
Bond Position:  [13.39705945]


portfolio before change:  [2.90188542]
curr_Stock_Price:  102.51199566602914
curr_Factors:  [102.51199567]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365769]
Stock Position:  -0.0136576874836504
Bond Position:  [4.30196222]


portfolio before change:  [2.90609803]
curr_Stock_Price:  102.22324093748493
curr_Factors:  [102.22324094]
mat_Sqrt:  [[0.15]]
grads:  [0.00844481]
Stock Position:  0.008444807781635982
Bond Position:  [2.04284241]


portfolio before change:  [2.90826678]
curr_Stock_Price:  102.46493585102299
curr_Factors:  [102.46493585]
mat_Sqrt:  [[0.15]]
grads:  [0.02524858]
Stock Position:  0.02524858270336725
Bond Position:  [0.32117237]


portfolio before change:  [2.91095493]
curr_Stock_Price:  102.57060817534945
curr_Factors:  [102.57060818]
mat_Sqrt:  [[0.15]]
grads:  [-0.10132846]
Stock Position:  -0.10132846265552585
Bond Position:  [13.30427697]


portfolio before change:  [2.90533394]
curr_Stock_Price:  102.63428753160204
curr_Factors:  [102.63428753]
mat_Sqrt:  [[0.15]]
grads:  [-0.0252479]
Stock Position:  -0.02524789773792041
Bond Position:  [5.49663393]


portfolio before change:  [2.86453817]
curr_Stock_Price:  104.26370331691227
curr_Factors:  [104.26370332]
mat_Sqrt:  [[0.15]]
grads:  [0.07667745]
Stock Position:  0.07667745230170316
Bond Position:  [-5.13013697]


portfolio before change:  [2.81973531]
curr_Stock_Price:  103.68358216687255
curr_Factors:  [103.68358217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03213544]
Stock Position:  -0.03213543688830926
Bond Position:  [6.15165252]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.80308326]
Stock Price:  104.21373040666077
PL:  [-1.41064715]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.22955567e-02]
 [ 4.22673657e-03]
 [ 8.88263552e-03]
 [-1.20434945e-02]
 [ 1.09591040e-02]
 [-1.57148482e-02]
 [-1.35192651e-02]
 [ 3.22497783e-02]
 [-2.08277054e-02]
 [-1.32577200e-02]
 [ 4.72498783e-03]
 [-7.35260645e-03]
 [ 2.67304704e-03]
 [-5.28993845e-03]
 [-2.45514299e-03]
 [ 6.65628229e-03]
 [-6.62285856e-03]
 [-1.41430996e-02]
 [ 2.13739667e-02]
 [ 2.62956954e-03]
 [-4.25511427e-03]
 [ 4.14595201e-03]
 [ 1.63221382e-02]
 [ 1.74013685e-02]
 [-6.06946432e-03]
 [ 4.88034965e-03]
 [-5.90233925e-03]
 [ 5.55122649e-03]
 [ 3.21642184e-02]
 [ 5.01695323e-03]
 [-7.68598568e-03]
 [ 8.99465636e-03]
 [ 1.16378565e-02]
 [-9.13834211e-03]
 [ 1.23128486e-03]
 [ 1.89039029e-02]
 [ 5.78959249e-03]
 [ 1.44291964e-03]
 [-3.24437334e-02]
 [-1.50426131e-02]
 [ 7.13017784e-03]
 [ 3.12034503e-02]
 [-3.04840032e-03]
 [ 3.73377090e-03]
 [-2.03426959e-02]
 [ 1.80166756e-02]
 [ 1.03581627e-02]
 [ 5.27625740e-03]
 [-2.33639376e-03]
 [-1.44474108e-03]
 [-5.89732440e-03]
 [ 1.32031594e-03]
 [ 4.39511083e-04]
 [ 7.76177123e-03]
 [-1.03818101e-02]
 [-4.80706990e-03]
 [-1.40024288e-03]
 [ 1.30104829e-02]
 [ 7.40215494e-03]
 [-2.96327246e-03]
 [-5.12315906e-03]
 [-1.53156324e-03]
 [-4.67257029e-03]
 [-2.95240385e-04]
 [ 2.00433216e-02]
 [ 5.40501878e-03]
 [ 8.17900297e-03]
 [-2.07935571e-04]
 [ 2.86803137e-03]
 [ 2.17964939e-02]
 [ 1.42726362e-03]
 [-1.59649185e-02]
 [-1.50134178e-03]
 [ 1.34001788e-03]
 [ 3.88883262e-03]
 [-1.52283773e-02]
 [-4.00424075e-03]
 [ 1.56715124e-02]
 [-1.22459267e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.78179239]
curr_Stock_Price:  99.23644685987318
curr_Factors:  [99.23644686]
mat_Sqrt:  [[0.15]]
grads:  [-0.08197038]
Stock Position:  -0.08197037812200508
Bond Position:  [-6.64734332]


portfolio before change:  [-14.82282044]
curr_Stock_Price:  99.73190121345337
curr_Factors:  [99.73190121]
mat_Sqrt:  [[0.15]]
grads:  [0.02817824]
Stock Position:  0.028178243767744672
Bond Position:  [-17.63309027]


portfolio before change:  [-14.83210148]
curr_Stock_Price:  99.44164402477801
curr_Factors:  [99.44164402]
mat_Sqrt:  [[0.15]]
grads:  [0.05921757]
Stock Position:  0.059217570101696704
Bond Position:  [-20.72079401]


portfolio before change:  [-14.89624326]
curr_Stock_Price:  98.38035958091919
curr_Factors:  [98.38035958]
mat_Sqrt:  [[0.15]]
grads:  [-0.08028996]
Stock Position:  -0.08028996366456106
Bond Position:  [-6.99728776]


portfolio before change:  [-14.92064308]
curr_Stock_Price:  98.67880877631032
curr_Factors:  [98.67880878]
mat_Sqrt:  [[0.15]]
grads:  [0.07306069]
Stock Position:  0.07306069356783058
Bond Position:  [-22.13018529]


portfolio before change:  [-14.96287808]
curr_Stock_Price:  98.11965968466708
curr_Factors:  [98.11965968]
mat_Sqrt:  [[0.15]]
grads:  [-0.10476565]
Stock Position:  -0.10476565468509151
Bond Position:  [-4.6833077]


portfolio before change:  [-14.98274348]
curr_Stock_Price:  98.30648318118932
curr_Factors:  [98.30648318]
mat_Sqrt:  [[0.15]]
grads:  [-0.09012843]
Stock Position:  -0.09012843398388906
Bond Position:  [-6.1225341]


portfolio before change:  [-14.99975946]
curr_Stock_Price:  98.49103439014469
curr_Factors:  [98.49103439]
mat_Sqrt:  [[0.15]]
grads:  [0.21499852]
Stock Position:  0.2149985218952728
Bond Position:  [-36.17518628]


portfolio before change:  [-15.0719972]
curr_Stock_Price:  98.16555904805317
curr_Factors:  [98.16555905]
mat_Sqrt:  [[0.15]]
grads:  [-0.13885137]
Stock Position:  -0.13885136940394918
Bond Position:  [-1.4415749]


portfolio before change:  [-15.03577495]
curr_Stock_Price:  97.90403944914739
curr_Factors:  [97.90403945]
mat_Sqrt:  [[0.15]]
grads:  [-0.0883848]
Stock Position:  -0.08838480015136758
Bond Position:  [-6.38254599]


portfolio before change:  [-14.99804005]
curr_Stock_Price:  97.47258726791853
curr_Factors:  [97.47258727]
mat_Sqrt:  [[0.15]]
grads:  [0.03149992]
Stock Position:  0.031499918858114144
Bond Position:  [-18.06841864]


portfolio before change:  [-14.99526151]
curr_Stock_Price:  97.59664656313721
curr_Factors:  [97.59664656]
mat_Sqrt:  [[0.15]]
grads:  [-0.04901738]
Stock Position:  -0.04901737632786961
Bond Position:  [-10.21132996]


portfolio before change:  [-15.02534545]
curr_Stock_Price:  98.19736641088515
curr_Factors:  [98.19736641]
mat_Sqrt:  [[0.15]]
grads:  [0.01782031]
Stock Position:  0.01782031361507801
Bond Position:  [-16.77525331]


portfolio before change:  [-15.03447383]
curr_Stock_Price:  97.74395686000256
curr_Factors:  [97.74395686]
mat_Sqrt:  [[0.15]]
grads:  [-0.03526626]
Stock Position:  -0.03526625632747866
Bond Position:  [-11.5874104]


portfolio before change:  [-15.05147061]
curr_Stock_Price:  98.20537634000706
curr_Factors:  [98.20537634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636762]
Stock Position:  -0.016367619929911842
Bond Position:  [-13.44408233]


portfolio before change:  [-15.05588105]
curr_Stock_Price:  98.42349960950618
curr_Factors:  [98.42349961]
mat_Sqrt:  [[0.15]]
grads:  [0.04437522]
Stock Position:  0.04437521527888519
Bond Position:  [-19.42344503]


portfolio before change:  [-15.06459013]
curr_Stock_Price:  98.25459720538834
curr_Factors:  [98.25459721]
mat_Sqrt:  [[0.15]]
grads:  [-0.04415239]
Stock Position:  -0.044152390372207556
Bond Position:  [-10.7264148]


portfolio before change:  [-15.09305567]
curr_Stock_Price:  98.8841241466516
curr_Factors:  [98.88412415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09428733]
Stock Position:  -0.09428733033363305
Bond Position:  [-5.76953559]


portfolio before change:  [-15.14804302]
curr_Stock_Price:  99.46348876016138
curr_Factors:  [99.46348876]
mat_Sqrt:  [[0.15]]
grads:  [0.14249311]
Stock Position:  0.14249311122987474
Bond Position:  [-29.32090499]


portfolio before change:  [-15.06741296]
curr_Stock_Price:  100.04220220301312
curr_Factors:  [100.0422022]
mat_Sqrt:  [[0.15]]
grads:  [0.01753046]
Stock Position:  0.017530463631719336
Bond Position:  [-16.82119914]


portfolio before change:  [-15.06524267]
curr_Stock_Price:  100.22597642325458
curr_Factors:  [100.22597642]
mat_Sqrt:  [[0.15]]
grads:  [-0.02836743]
Stock Position:  -0.028367428462193808
Bond Position:  [-12.22208945]


portfolio before change:  [-15.06188147]
curr_Stock_Price:  100.08055946223173
curr_Factors:  [100.08055946]
mat_Sqrt:  [[0.15]]
grads:  [0.02763968]
Stock Position:  0.027639680036815
Bond Position:  [-17.82807611]


portfolio before change:  [-15.06945553]
curr_Stock_Price:  99.8468456236282
curr_Factors:  [99.84684562]
mat_Sqrt:  [[0.15]]
grads:  [0.10881425]
Stock Position:  0.10881425449789198
Bond Position:  [-25.9342156]


portfolio before change:  [-15.06146728]
curr_Stock_Price:  99.93515381802884
curr_Factors:  [99.93515382]
mat_Sqrt:  [[0.15]]
grads:  [0.11600912]
Stock Position:  0.11600912353734404
Bond Position:  [-26.65485689]


portfolio before change:  [-15.11735573]
curr_Stock_Price:  99.46775551822192
curr_Factors:  [99.46775552]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404631]
Stock Position:  -0.04046309548864128
Bond Position:  [-11.09258244]


portfolio before change:  [-15.14884361]
curr_Stock_Price:  100.22880892741675
curr_Factors:  [100.22880893]
mat_Sqrt:  [[0.15]]
grads:  [0.03253566]
Stock Position:  0.032535664335965934
Bond Position:  [-18.4098545]


portfolio before change:  [-15.13363083]
curr_Stock_Price:  100.73174731292791
curr_Factors:  [100.73174731]
mat_Sqrt:  [[0.15]]
grads:  [-0.03934893]
Stock Position:  -0.03934892834811593
Bond Position:  [-11.16994452]


portfolio before change:  [-15.13037898]
curr_Stock_Price:  100.63136365205465
curr_Factors:  [100.63136365]
mat_Sqrt:  [[0.15]]
grads:  [0.03700818]
Stock Position:  0.03700817657497093
Bond Position:  [-18.85456226]


portfolio before change:  [-15.09750739]
curr_Stock_Price:  101.55143177004774
curr_Factors:  [101.55143177]
mat_Sqrt:  [[0.15]]
grads:  [0.21442812]
Stock Position:  0.2144281227245788
Bond Position:  [-36.87299026]


portfolio before change:  [-15.27219857]
curr_Stock_Price:  100.74749548767805
curr_Factors:  [100.74749549]
mat_Sqrt:  [[0.15]]
grads:  [0.03344635]
Stock Position:  0.03344635489623313
Bond Position:  [-18.64183506]


portfolio before change:  [-15.28493487]
curr_Stock_Price:  100.40153417094102
curr_Factors:  [100.40153417]
mat_Sqrt:  [[0.15]]
grads:  [-0.0512399]
Stock Position:  -0.05123990450854491
Bond Position:  [-10.14036984]


portfolio before change:  [-15.25970096]
curr_Stock_Price:  99.89669910148005
curr_Factors:  [99.8966991]
mat_Sqrt:  [[0.15]]
grads:  [0.05996438]
Stock Position:  0.059964375715033755
Bond Position:  [-21.24994416]


portfolio before change:  [-15.30057018]
curr_Stock_Price:  99.23728991670015
curr_Factors:  [99.23728992]
mat_Sqrt:  [[0.15]]
grads:  [0.07758571]
Stock Position:  0.07758571015176753
Bond Position:  [-22.99996579]


portfolio before change:  [-15.28793593]
curr_Stock_Price:  99.41866081732
curr_Factors:  [99.41866082]
mat_Sqrt:  [[0.15]]
grads:  [-0.06092228]
Stock Position:  -0.06092228074151133
Bond Position:  [-9.23112437]


portfolio before change:  [-15.26414805]
curr_Stock_Price:  99.01872751434652
curr_Factors:  [99.01872751]
mat_Sqrt:  [[0.15]]
grads:  [0.00820857]
Stock Position:  0.008208565732764418
Bond Position:  [-16.07694978]


portfolio before change:  [-15.26418697]
curr_Stock_Price:  99.1363999834988
curr_Factors:  [99.13639998]
mat_Sqrt:  [[0.15]]
grads:  [0.12602602]
Stock Position:  0.12602601912131736
Bond Position:  [-27.75795281]


portfolio before change:  [-15.38792978]
curr_Stock_Price:  98.1682833451742
curr_Factors:  [98.16828335]
mat_Sqrt:  [[0.15]]
grads:  [0.03859728]
Stock Position:  0.038597283242289525
Bond Position:  [-19.17695882]


portfolio before change:  [-15.37452423]
curr_Stock_Price:  98.54665565774948
curr_Factors:  [98.54665566]
mat_Sqrt:  [[0.15]]
grads:  [0.00961946]
Stock Position:  0.009619464238328011
Bond Position:  [-16.32249026]


portfolio before change:  [-15.37506016]
curr_Stock_Price:  98.59699748983799
curr_Factors:  [98.59699749]
mat_Sqrt:  [[0.15]]
grads:  [-0.21629156]
Stock Position:  -0.21629155577069137
Bond Position:  [5.95063782]


portfolio before change:  [-15.18444108]
curr_Stock_Price:  97.71741089254822
curr_Factors:  [97.71741089]
mat_Sqrt:  [[0.15]]
grads:  [-0.10028409]
Stock Position:  -0.10028408725856104
Bond Position:  [-5.38493972]


portfolio before change:  [-15.19686064]
curr_Stock_Price:  97.83789853975955
curr_Factors:  [97.83789854]
mat_Sqrt:  [[0.15]]
grads:  [0.04753452]
Stock Position:  0.04753451894883138
Bond Position:  [-19.84753808]


portfolio before change:  [-15.21985231]
curr_Stock_Price:  97.38031203405875
curr_Factors:  [97.38031203]
mat_Sqrt:  [[0.15]]
grads:  [0.208023]
Stock Position:  0.20802300185293288
Bond Position:  [-35.47719714]


portfolio before change:  [-15.15835848]
curr_Stock_Price:  97.68658211972753
curr_Factors:  [97.68658212]
mat_Sqrt:  [[0.15]]
grads:  [-0.02032267]
Stock Position:  -0.020322668784592445
Bond Position:  [-13.17310642]


portfolio before change:  [-15.15652848]
curr_Stock_Price:  97.55602156395544
curr_Factors:  [97.55602156]
mat_Sqrt:  [[0.15]]
grads:  [0.02489181]
Stock Position:  0.024891805990200768
Bond Position:  [-17.58487405]


portfolio before change:  [-15.16618812]
curr_Stock_Price:  97.21211135221043
curr_Factors:  [97.21211135]
mat_Sqrt:  [[0.15]]
grads:  [-0.13561797]
Stock Position:  -0.13561797239889806
Bond Position:  [-1.98247869]


portfolio before change:  [-15.18444908]
curr_Stock_Price:  97.34584766663009
curr_Factors:  [97.34584767]
mat_Sqrt:  [[0.15]]
grads:  [0.12011117]
Stock Position:  0.12011117063751155
Bond Position:  [-26.8767728]


portfolio before change:  [-15.09080808]
curr_Stock_Price:  98.13945287407338
curr_Factors:  [98.13945287]
mat_Sqrt:  [[0.15]]
grads:  [0.06905442]
Stock Position:  0.06905441795489144
Bond Position:  [-21.86777087]


portfolio before change:  [-15.11376105]
curr_Stock_Price:  97.82685596207726
curr_Factors:  [97.82685596]
mat_Sqrt:  [[0.15]]
grads:  [0.03517505]
Stock Position:  0.03517504936637203
Bond Position:  [-18.55482554]


portfolio before change:  [-15.09778812]
curr_Stock_Price:  98.31392402624743
curr_Factors:  [98.31392403]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557596]
Stock Position:  -0.015575958389507372
Bond Position:  [-13.56645453]


portfolio before change:  [-15.10167971]
curr_Stock_Price:  98.50933156300044
curr_Factors:  [98.50933156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963161]
Stock Position:  -0.009631607167324939
Bond Position:  [-14.15287653]


portfolio before change:  [-15.09894135]
curr_Stock_Price:  98.1331797671341
curr_Factors:  [98.13317977]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393155]
Stock Position:  -0.03931549598844039
Bond Position:  [-11.24078671]


portfolio before change:  [-15.07401798]
curr_Stock_Price:  97.4813772844279
curr_Factors:  [97.48137728]
mat_Sqrt:  [[0.15]]
grads:  [0.00880211]
Stock Position:  0.008802106298208153
Bond Position:  [-15.93205943]


portfolio before change:  [-15.08093337]
curr_Stock_Price:  96.8088557075726
curr_Factors:  [96.80885571]
mat_Sqrt:  [[0.15]]
grads:  [0.00293007]
Stock Position:  0.0029300738876502494
Bond Position:  [-15.36459047]


portfolio before change:  [-15.08206261]
curr_Stock_Price:  96.75120365394517
curr_Factors:  [96.75120365]
mat_Sqrt:  [[0.15]]
grads:  [0.05174514]
Stock Position:  0.051745141504208295
Bond Position:  [-20.08846734]


portfolio before change:  [-15.08878964]
curr_Stock_Price:  96.64546509041858
curr_Factors:  [96.64546509]
mat_Sqrt:  [[0.15]]
grads:  [-0.06921207]
Stock Position:  -0.06921206735718873
Bond Position:  [-8.3997572]


portfolio before change:  [-15.10427623]
curr_Stock_Price:  96.86163540845682
curr_Factors:  [96.86163541]
mat_Sqrt:  [[0.15]]
grads:  [-0.03204713]
Stock Position:  -0.032047132688764184
Bond Position:  [-12.00013855]


portfolio before change:  [-15.08960103]
curr_Stock_Price:  96.3803058475317
curr_Factors:  [96.38030585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00933495]
Stock Position:  -0.009334952507279759
Bond Position:  [-14.18989546]


portfolio before change:  [-15.08749357]
curr_Stock_Price:  96.05953730738193
curr_Factors:  [96.05953731]
mat_Sqrt:  [[0.15]]
grads:  [0.08673655]
Stock Position:  0.08673655234861416
Bond Position:  [-23.41936666]


portfolio before change:  [-15.05751607]
curr_Stock_Price:  96.42202874737704
curr_Factors:  [96.42202875]
mat_Sqrt:  [[0.15]]
grads:  [0.0493477]
Stock Position:  0.04934769957942459
Bond Position:  [-19.81572138]


portfolio before change:  [-15.07066166]
curr_Stock_Price:  96.18073956547587
curr_Factors:  [96.18073957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01975515]
Stock Position:  -0.019755149759323864
Bond Position:  [-13.17059674]


portfolio before change:  [-15.06710093]
curr_Stock_Price:  95.9588271760171
curr_Factors:  [95.95882718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03415439]
Stock Position:  -0.03415439373849224
Bond Position:  [-11.78968537]


portfolio before change:  [-15.08645207]
curr_Stock_Price:  96.50383057938342
curr_Factors:  [96.50383058]
mat_Sqrt:  [[0.15]]
grads:  [-0.01021042]
Stock Position:  -0.010210421608618353
Bond Position:  [-14.10110728]


portfolio before change:  [-15.09634145]
curr_Stock_Price:  97.38606950918845
curr_Factors:  [97.38606951]
mat_Sqrt:  [[0.15]]
grads:  [-0.03115047]
Stock Position:  -0.031150468633030344
Bond Position:  [-12.06271975]


portfolio before change:  [-15.10619141]
curr_Stock_Price:  97.67807207578326
curr_Factors:  [97.67807208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00196827]
Stock Position:  -0.001968269231944581
Bond Position:  [-14.91393467]


portfolio before change:  [-15.10872489]
curr_Stock_Price:  98.49164235617685
curr_Factors:  [98.49164236]
mat_Sqrt:  [[0.15]]
grads:  [0.13362214]
Stock Position:  0.1336221438822893
Bond Position:  [-28.26938929]


portfolio before change:  [-14.98451237]
curr_Stock_Price:  99.43444575906436
curr_Factors:  [99.43444576]
mat_Sqrt:  [[0.15]]
grads:  [0.03603346]
Stock Position:  0.036033458553184815
Bond Position:  [-18.56747935]


portfolio before change:  [-14.98823234]
curr_Stock_Price:  99.36341542915261
curr_Factors:  [99.36341543]
mat_Sqrt:  [[0.15]]
grads:  [0.05452669]
Stock Position:  0.05452668644662015
Bond Position:  [-20.40619014]


portfolio before change:  [-15.00407783]
curr_Stock_Price:  99.09620555608409
curr_Factors:  [99.09620556]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138624]
Stock Position:  -0.0013862371397901398
Bond Position:  [-14.86670699]


portfolio before change:  [-15.00590021]
curr_Stock_Price:  99.74052623981154
curr_Factors:  [99.74052624]
mat_Sqrt:  [[0.15]]
grads:  [0.01912021]
Stock Position:  0.019120209146214186
Bond Position:  [-16.91295994]


portfolio before change:  [-15.0045341]
curr_Stock_Price:  99.86726163971578
curr_Factors:  [99.86726164]
mat_Sqrt:  [[0.15]]
grads:  [0.14530996]
Stock Position:  0.14530995918148532
Bond Position:  [-29.51624181]


portfolio before change:  [-15.02942189]
curr_Stock_Price:  99.70868362013483
curr_Factors:  [99.70868362]
mat_Sqrt:  [[0.15]]
grads:  [0.00951509]
Stock Position:  0.009515090818784528
Bond Position:  [-15.97815907]


portfolio before change:  [-15.03292149]
curr_Stock_Price:  99.44584511268675
curr_Factors:  [99.44584511]
mat_Sqrt:  [[0.15]]
grads:  [-0.10643279]
Stock Position:  -0.10643278973489476
Bond Position:  [-4.44862276]


portfolio before change:  [-15.1465946]
curr_Stock_Price:  100.51125985031507
curr_Factors:  [100.51125985]
mat_Sqrt:  [[0.15]]
grads:  [-0.01000895]
Stock Position:  -0.01000894522421134
Bond Position:  [-14.1405829]


portfolio before change:  [-15.15953017]
curr_Stock_Price:  101.7153584923382
curr_Factors:  [101.71535849]
mat_Sqrt:  [[0.15]]
grads:  [0.00893345]
Stock Position:  0.008933452533596346
Bond Position:  [-16.06819949]


portfolio before change:  [-15.14901022]
curr_Stock_Price:  103.00536843812876
curr_Factors:  [103.00536844]
mat_Sqrt:  [[0.15]]
grads:  [0.02592555]
Stock Position:  0.025925550806499387
Bond Position:  [-17.81948113]


portfolio before change:  [-15.16103053]
curr_Stock_Price:  102.58468097137606
curr_Factors:  [102.58468097]
mat_Sqrt:  [[0.15]]
grads:  [-0.10152252]
Stock Position:  -0.10152251528606092
Bond Position:  [-4.74637568]


portfolio before change:  [-15.12767865]
curr_Stock_Price:  102.253241860015
curr_Factors:  [102.25324186]
mat_Sqrt:  [[0.15]]
grads:  [-0.02669494]
Stock Position:  -0.026694938342730293
Bond Position:  [-12.39803466]


portfolio before change:  [-15.12082867]
curr_Stock_Price:  101.96761150722553
curr_Factors:  [101.96761151]
mat_Sqrt:  [[0.15]]
grads:  [0.10447675]
Stock Position:  0.10447674952771382
Bond Position:  [-25.77407328]


portfolio before change:  [-15.21300883]
curr_Stock_Price:  101.10072745484679
curr_Factors:  [101.10072745]
mat_Sqrt:  [[0.15]]
grads:  [-0.08163951]
Stock Position:  -0.081639511288421
Bond Position:  [-6.95919485]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.2226817]
Stock Price:  101.2138823744197
PL:  [-16.43656408]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.89202944e-03]
 [ 3.22635897e-02]
 [ 1.24348918e-02]
 [-6.48026174e-03]
 [-7.00901111e-03]
 [-9.75949015e-03]
 [ 2.47749566e-03]
 [-4.88603149e-03]
 [-1.71830033e-02]
 [-1.30994570e-02]
 [ 9.09918153e-03]
 [-6.90523575e-03]
 [ 4.32474105e-03]
 [-7.51910865e-04]
 [-3.74219028e-03]
 [ 8.29376915e-03]
 [ 1.23378362e-02]
 [-1.22706986e-02]
 [ 2.49760249e-02]
 [ 1.23760469e-03]
 [-4.56800980e-03]
 [ 4.64361836e-03]
 [ 1.61852902e-02]
 [ 2.01048925e-02]
 [-2.02686703e-03]
 [ 6.56158796e-03]
 [-9.67467291e-03]
 [ 9.27448240e-03]
 [ 2.96944478e-02]
 [-7.65660749e-03]
 [ 3.17084317e-03]
 [ 1.54556420e-02]
 [ 1.52368087e-02]
 [-6.58428312e-03]
 [ 4.30645632e-03]
 [-8.93750121e-03]
 [-9.13804349e-03]
 [-1.62000124e-02]
 [ 1.24357839e-02]
 [-5.22855193e-02]
 [ 3.41360991e-03]
 [ 8.95125856e-04]
 [-1.53716861e-02]
 [ 1.86075816e-02]
 [-9.73051220e-03]
 [ 1.17537267e-02]
 [ 1.04288150e-02]
 [-3.55897277e-03]
 [ 1.51129532e-02]
 [-1.55474888e-03]
 [ 1.89165419e-02]
 [ 1.70687670e-02]
 [-6.26171723e-03]
 [-5.26790993e-02]
 [-2.23395101e-02]
 [-2.21608661e-03]
 [-2.13486642e-03]
 [-1.32517674e-02]
 [-3.73248361e-04]
 [-3.01148245e-03]
 [-7.44917052e-03]
 [-2.16758522e-03]
 [-1.82277356e-02]
 [ 3.09295669e-05]
 [ 7.55412982e-04]
 [ 2.43055864e-02]
 [-1.63275340e-03]
 [ 1.72956623e-02]
 [ 8.10331742e-03]
 [ 1.13276512e-02]
 [ 6.30505785e-03]
 [-1.48859432e-02]
 [-3.63868411e-02]
 [ 5.53305930e-04]
 [-7.22862768e-03]
 [-2.73877666e-02]
 [-6.47101165e-03]
 [ 2.14599889e-02]
 [ 5.51400685e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.34064356]
curr_Stock_Price:  100.15036666426744
curr_Factors:  [100.15036666]
mat_Sqrt:  [[0.15]]
grads:  [-0.04594686]
Stock Position:  -0.04594686292090651
Bond Position:  [9.94223873]


portfolio before change:  [5.31300612]
curr_Stock_Price:  100.76540004513862
curr_Factors:  [100.76540005]
mat_Sqrt:  [[0.15]]
grads:  [0.2150906]
Stock Position:  0.2150905978508173
Bond Position:  [-16.36068402]


portfolio before change:  [5.22269836]
curr_Stock_Price:  100.35029505545285
curr_Factors:  [100.35029506]
mat_Sqrt:  [[0.15]]
grads:  [0.08289928]
Stock Position:  0.08289927890675504
Bond Position:  [-3.09626874]


portfolio before change:  [5.21135751]
curr_Stock_Price:  100.21582670150327
curr_Factors:  [100.2158267]
mat_Sqrt:  [[0.15]]
grads:  [-0.04320174]
Stock Position:  -0.043201744914806606
Bond Position:  [9.54085609]


portfolio before change:  [5.19093473]
curr_Stock_Price:  100.70236031448154
curr_Factors:  [100.70236031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04672674]
Stock Position:  -0.046726740729261244
Bond Position:  [9.89642781]


portfolio before change:  [5.2406701]
curr_Stock_Price:  99.65121016253067
curr_Factors:  [99.65121016]
mat_Sqrt:  [[0.15]]
grads:  [-0.06506327]
Stock Position:  -0.06506326768250408
Bond Position:  [11.72430346]


portfolio before change:  [5.2181186]
curr_Stock_Price:  100.00908166477744
curr_Factors:  [100.00908166]
mat_Sqrt:  [[0.15]]
grads:  [0.01651664]
Stock Position:  0.01651663772230672
Bond Position:  [3.56630483]


portfolio before change:  [5.21566261]
curr_Stock_Price:  99.84688821832847
curr_Factors:  [99.84688822]
mat_Sqrt:  [[0.15]]
grads:  [-0.03257354]
Stock Position:  -0.032573543234073084
Bond Position:  [8.46802954]


portfolio before change:  [5.24786079]
curr_Stock_Price:  98.87466023469725
curr_Factors:  [98.87466023]
mat_Sqrt:  [[0.15]]
grads:  [-0.11455336]
Stock Position:  -0.1145533555047952
Bond Position:  [16.57428489]


portfolio before change:  [5.33583559]
curr_Stock_Price:  98.11572236385416
curr_Factors:  [98.11572236]
mat_Sqrt:  [[0.15]]
grads:  [-0.08732971]
Stock Position:  -0.08732971340968115
Bond Position:  [13.90425351]


portfolio before change:  [5.33841091]
curr_Stock_Price:  98.09618410418098
curr_Factors:  [98.0961841]
mat_Sqrt:  [[0.15]]
grads:  [0.06066121]
Stock Position:  0.060661210175025904
Bond Position:  [-0.61222233]


portfolio before change:  [5.33781715]
curr_Stock_Price:  98.08702677949525
curr_Factors:  [98.08702678]
mat_Sqrt:  [[0.15]]
grads:  [-0.0460349]
Stock Position:  -0.046034904987518326
Bond Position:  [9.85324411]


portfolio before change:  [5.34918893]
curr_Stock_Price:  97.85337945828877
curr_Factors:  [97.85337946]
mat_Sqrt:  [[0.15]]
grads:  [0.02883161]
Stock Position:  0.028831606970211386
Bond Position:  [2.52791875]


portfolio before change:  [5.36360754]
curr_Stock_Price:  98.34799686151368
curr_Factors:  [98.34799686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501274]
Stock Position:  -0.005012739100420334
Bond Position:  [5.85660039]


portfolio before change:  [5.3623231]
curr_Stock_Price:  98.67725534612563
curr_Factors:  [98.67725535]
mat_Sqrt:  [[0.15]]
grads:  [-0.02494794]
Stock Position:  -0.02494793521306825
Bond Position:  [7.82411688]


portfolio before change:  [5.3617575]
curr_Stock_Price:  98.71952832582016
curr_Factors:  [98.71952833]
mat_Sqrt:  [[0.15]]
grads:  [0.05529179]
Stock Position:  0.055291794313814514
Bond Position:  [-0.09662235]


portfolio before change:  [5.37720863]
curr_Stock_Price:  98.99908462233189
curr_Factors:  [98.99908462]
mat_Sqrt:  [[0.15]]
grads:  [0.08225224]
Stock Position:  0.08225224160529325
Bond Position:  [-2.76568799]


portfolio before change:  [5.28313221]
curr_Stock_Price:  97.85743105108574
curr_Factors:  [97.85743105]
mat_Sqrt:  [[0.15]]
grads:  [-0.08180466]
Stock Position:  -0.08180465740401888
Bond Position:  [13.28832583]


portfolio before change:  [5.23680664]
curr_Stock_Price:  98.43387883591481
curr_Factors:  [98.43387884]
mat_Sqrt:  [[0.15]]
grads:  [0.16650683]
Stock Position:  0.16650683289078036
Bond Position:  [-11.15310677]


portfolio before change:  [5.35432875]
curr_Stock_Price:  99.1438749123362
curr_Factors:  [99.14387491]
mat_Sqrt:  [[0.15]]
grads:  [0.0082507]
Stock Position:  0.008250697957228742
Bond Position:  [4.53632258]


portfolio before change:  [5.35274341]
curr_Stock_Price:  98.91736541958392
curr_Factors:  [98.91736542]
mat_Sqrt:  [[0.15]]
grads:  [-0.0304534]
Stock Position:  -0.0304533986532628
Bond Position:  [8.36511338]


portfolio before change:  [5.33152501]
curr_Stock_Price:  99.63128364793867
curr_Factors:  [99.63128365]
mat_Sqrt:  [[0.15]]
grads:  [0.03095746]
Stock Position:  0.030957455757341195
Bond Position:  [2.24719396]


portfolio before change:  [5.33926257]
curr_Stock_Price:  99.87668816832281
curr_Factors:  [99.87668817]
mat_Sqrt:  [[0.15]]
grads:  [0.10790193]
Stock Position:  0.1079019347724809
Bond Position:  [-5.43762532]


portfolio before change:  [5.46944757]
curr_Stock_Price:  101.08635009105426
curr_Factors:  [101.08635009]
mat_Sqrt:  [[0.15]]
grads:  [0.13403262]
Stock Position:  0.13403261675347625
Bond Position:  [-8.07942045]


portfolio before change:  [5.50031035]
curr_Stock_Price:  101.32038088527003
curr_Factors:  [101.32038089]
mat_Sqrt:  [[0.15]]
grads:  [-0.01351245]
Stock Position:  -0.01351244686100195
Bond Position:  [6.86939661]


portfolio before change:  [5.50778694]
curr_Stock_Price:  100.79884349889365
curr_Factors:  [100.7988435]
mat_Sqrt:  [[0.15]]
grads:  [0.04374392]
Stock Position:  0.04374391973912209
Bond Position:  [1.09845042]


portfolio before change:  [5.52301154]
curr_Stock_Price:  101.14531304646734
curr_Factors:  [101.14531305]
mat_Sqrt:  [[0.15]]
grads:  [-0.06449782]
Stock Position:  -0.06449781937669657
Bond Position:  [12.04666367]


portfolio before change:  [5.51557219]
curr_Stock_Price:  101.27232945979203
curr_Factors:  [101.27232946]
mat_Sqrt:  [[0.15]]
grads:  [0.06182988]
Stock Position:  0.06182988269651324
Bond Position:  [-0.74608406]


portfolio before change:  [5.54906698]
curr_Stock_Price:  101.81480859401839
curr_Factors:  [101.81480859]
mat_Sqrt:  [[0.15]]
grads:  [0.19796299]
Stock Position:  0.19796298543896376
Bond Position:  [-14.60649649]


portfolio before change:  [5.65165117]
curr_Stock_Price:  102.33761905158484
curr_Factors:  [102.33761905]
mat_Sqrt:  [[0.15]]
grads:  [-0.05104405]
Stock Position:  -0.05104404994163726
Bond Position:  [10.87537771]


portfolio before change:  [5.57108463]
curr_Stock_Price:  103.92930848377313
curr_Factors:  [103.92930848]
mat_Sqrt:  [[0.15]]
grads:  [0.02113895]
Stock Position:  0.02113895443586998
Bond Position:  [3.37412771]


portfolio before change:  [5.58559152]
curr_Stock_Price:  104.60559577915005
curr_Factors:  [104.60559578]
mat_Sqrt:  [[0.15]]
grads:  [0.10303761]
Stock Position:  0.10303761348673837
Bond Position:  [-5.19271943]


portfolio before change:  [5.5332397]
curr_Stock_Price:  104.10066103624138
curr_Factors:  [104.10066104]
mat_Sqrt:  [[0.15]]
grads:  [0.10157872]
Stock Position:  0.10157872435269379
Bond Position:  [-5.04117266]


portfolio before change:  [5.51381099]
curr_Stock_Price:  103.91249541645384
curr_Factors:  [103.91249542]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389522]
Stock Position:  -0.04389522079546577
Bond Position:  [10.07507292]


portfolio before change:  [5.48855278]
curr_Stock_Price:  104.50226172712654
curr_Factors:  [104.50226173]
mat_Sqrt:  [[0.15]]
grads:  [0.02870971]
Stock Position:  0.02870970882307894
Bond Position:  [2.48832327]


portfolio before change:  [5.49334102]
curr_Stock_Price:  104.66362577943008
curr_Factors:  [104.66362578]
mat_Sqrt:  [[0.15]]
grads:  [-0.05958334]
Stock Position:  -0.05958334139921018
Bond Position:  [11.72954956]


portfolio before change:  [5.42596838]
curr_Stock_Price:  105.80665926512523
curr_Factors:  [105.80665927]
mat_Sqrt:  [[0.15]]
grads:  [-0.06092029]
Stock Position:  -0.060920289937570864
Bond Position:  [11.87174074]


portfolio before change:  [5.4257278]
curr_Stock_Price:  105.82278834182883
curr_Factors:  [105.82278834]
mat_Sqrt:  [[0.15]]
grads:  [-0.10800008]
Stock Position:  -0.10800008292050231
Bond Position:  [16.85459772]


portfolio before change:  [5.42934091]
curr_Stock_Price:  105.79908778570933
curr_Factors:  [105.79908779]
mat_Sqrt:  [[0.15]]
grads:  [0.08290523]
Stock Position:  0.08290522591302854
Bond Position:  [-3.34195636]


portfolio before change:  [5.38654721]
curr_Stock_Price:  105.28543116294966
curr_Factors:  [105.28543116]
mat_Sqrt:  [[0.15]]
grads:  [-0.34857013]
Stock Position:  -0.3485701288316145
Bond Position:  [42.08590352]


portfolio before change:  [5.50113355]
curr_Stock_Price:  104.96424503091335
curr_Factors:  [104.96424503]
mat_Sqrt:  [[0.15]]
grads:  [0.0227574]
Stock Position:  0.02275739941792224
Bond Position:  [3.11242031]


portfolio before change:  [5.51339143]
curr_Stock_Price:  105.49432962953985
curr_Factors:  [105.49432963]
mat_Sqrt:  [[0.15]]
grads:  [0.00596751]
Stock Position:  0.005967505709967291
Bond Position:  [4.88385342]


portfolio before change:  [5.51282566]
curr_Stock_Price:  105.34836784912092
curr_Factors:  [105.34836785]
mat_Sqrt:  [[0.15]]
grads:  [-0.10247791]
Stock Position:  -0.1024779075434913
Bond Position:  [16.30870596]


portfolio before change:  [5.45254344]
curr_Stock_Price:  105.9465606512198
curr_Factors:  [105.94656065]
mat_Sqrt:  [[0.15]]
grads:  [0.12405054]
Stock Position:  0.12405054404762499
Bond Position:  [-7.69018505]


portfolio before change:  [5.52773581]
curr_Stock_Price:  106.55657834723903
curr_Factors:  [106.55657835]
mat_Sqrt:  [[0.15]]
grads:  [-0.06487008]
Stock Position:  -0.06487008136652199
Bond Position:  [12.44006972]


portfolio before change:  [5.53303059]
curr_Stock_Price:  106.4869430791433
curr_Factors:  [106.48694308]
mat_Sqrt:  [[0.15]]
grads:  [0.07835818]
Stock Position:  0.07835817781317334
Bond Position:  [-2.81109223]


portfolio before change:  [5.56596255]
curr_Stock_Price:  106.90946005172614
curr_Factors:  [106.90946005]
mat_Sqrt:  [[0.15]]
grads:  [0.06952543]
Stock Position:  0.06952543361194422
Bond Position:  [-1.86696402]


portfolio before change:  [5.5680976]
curr_Stock_Price:  106.94184733383393
curr_Factors:  [106.94184733]
mat_Sqrt:  [[0.15]]
grads:  [-0.02372649]
Stock Position:  -0.023726485109901822
Bond Position:  [8.10545175]


portfolio before change:  [5.57128941]
curr_Stock_Price:  106.82867408383697
curr_Factors:  [106.82867408]
mat_Sqrt:  [[0.15]]
grads:  [0.10075302]
Stock Position:  0.10075302146240198
Bond Position:  [-5.19202228]


portfolio before change:  [5.58442688]
curr_Stock_Price:  106.962287777971
curr_Factors:  [106.96228778]
mat_Sqrt:  [[0.15]]
grads:  [-0.01036499]
Stock Position:  -0.010364992556256357
Bond Position:  [6.6930902]


portfolio before change:  [5.58836762]
curr_Stock_Price:  106.62245084303224
curr_Factors:  [106.62245084]
mat_Sqrt:  [[0.15]]
grads:  [0.12611028]
Stock Position:  0.126110279035614
Bond Position:  [-7.85781941]


portfolio before change:  [5.48815789]
curr_Stock_Price:  105.83172543753442
curr_Factors:  [105.83172544]
mat_Sqrt:  [[0.15]]
grads:  [0.11379178]
Stock Position:  0.11379178016974782
Bond Position:  [-6.55462255]


portfolio before change:  [5.50613314]
curr_Stock_Price:  105.99329187799161
curr_Factors:  [105.99329188]
mat_Sqrt:  [[0.15]]
grads:  [-0.04174478]
Stock Position:  -0.04174478154184287
Bond Position:  [9.93079996]


portfolio before change:  [5.49705061]
curr_Stock_Price:  106.22573351126222
curr_Factors:  [106.22573351]
mat_Sqrt:  [[0.15]]
grads:  [-0.351194]
Stock Position:  -0.3511939954752668
Bond Position:  [42.80289039]


portfolio before change:  [5.04763669]
curr_Stock_Price:  107.51302540354362
curr_Factors:  [107.5130254]
mat_Sqrt:  [[0.15]]
grads:  [-0.14893007]
Stock Position:  -0.14893006719490592
Bond Position:  [21.05955879]


portfolio before change:  [5.1442678]
curr_Stock_Price:  106.87302807990748
curr_Factors:  [106.87302808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477391]
Stock Position:  -0.014773910717516082
Bond Position:  [6.72320038]


portfolio before change:  [5.14442247]
curr_Stock_Price:  106.89100174821348
curr_Factors:  [106.89100175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01423244]
Stock Position:  -0.01423244280774917
Bond Position:  [6.66574254]


portfolio before change:  [5.13482993]
curr_Stock_Price:  107.59426586480434
curr_Factors:  [107.59426586]
mat_Sqrt:  [[0.15]]
grads:  [-0.08834512]
Stock Position:  -0.08834511624165764
Bond Position:  [14.64025785]


portfolio before change:  [5.14347419]
curr_Stock_Price:  107.50677700608254
curr_Factors:  [107.50677701]
mat_Sqrt:  [[0.15]]
grads:  [-0.00248832]
Stock Position:  -0.0024883224088069825
Bond Position:  [5.41098571]


portfolio before change:  [5.14445029]
curr_Stock_Price:  107.25041889351665
curr_Factors:  [107.25041889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007655]
Stock Position:  -0.020076549677287003
Bond Position:  [7.29766865]


portfolio before change:  [5.14713142]
curr_Stock_Price:  107.13959226162461
curr_Factors:  [107.13959226]
mat_Sqrt:  [[0.15]]
grads:  [-0.04966114]
Stock Position:  -0.04966113677236217
Bond Position:  [10.46780537]


portfolio before change:  [5.16476104]
curr_Stock_Price:  106.79776847334512
curr_Factors:  [106.79776847]
mat_Sqrt:  [[0.15]]
grads:  [-0.01445057]
Stock Position:  -0.014450568126169976
Bond Position:  [6.70804947]


portfolio before change:  [5.17372595]
curr_Stock_Price:  106.20639732479327
curr_Factors:  [106.20639732]
mat_Sqrt:  [[0.15]]
grads:  [-0.12151824]
Stock Position:  -0.12151823723370056
Bond Position:  [18.07974014]


portfolio before change:  [5.09398226]
curr_Stock_Price:  106.87192466303806
curr_Factors:  [106.87192466]
mat_Sqrt:  [[0.15]]
grads:  [0.0002062]
Stock Position:  0.0002061971125469418
Bond Position:  [5.07194558]


portfolio before change:  [5.09428112]
curr_Stock_Price:  106.78391024405903
curr_Factors:  [106.78391024]
mat_Sqrt:  [[0.15]]
grads:  [0.00503609]
Stock Position:  0.005036086544704689
Bond Position:  [4.55650811]


portfolio before change:  [5.09528464]
curr_Stock_Price:  106.92662615498348
curr_Factors:  [106.92662615]
mat_Sqrt:  [[0.15]]
grads:  [0.16203724]
Stock Position:  0.16203724299747815
Bond Position:  [-12.23081106]


portfolio before change:  [5.15793255]
curr_Stock_Price:  107.31797048609738
curr_Factors:  [107.31797049]
mat_Sqrt:  [[0.15]]
grads:  [-0.01088502]
Stock Position:  -0.01088502263515526
Bond Position:  [6.32609109]


portfolio before change:  [5.16445305]
curr_Stock_Price:  106.75526106193853
curr_Factors:  [106.75526106]
mat_Sqrt:  [[0.15]]
grads:  [0.11530442]
Stock Position:  0.1153044153001645
Bond Position:  [-7.14489991]


portfolio before change:  [5.1150105]
curr_Stock_Price:  106.33033392364662
curr_Factors:  [106.33033392]
mat_Sqrt:  [[0.15]]
grads:  [0.05402212]
Stock Position:  0.0540221161259837
Bond Position:  [-0.62917915]


portfolio before change:  [5.12348202]
curr_Stock_Price:  106.48787754459467
curr_Factors:  [106.48787754]
mat_Sqrt:  [[0.15]]
grads:  [0.07551767]
Stock Position:  0.07551767485944436
Bond Position:  [-2.9182349]


portfolio before change:  [5.16818143]
curr_Stock_Price:  107.08219953074956
curr_Factors:  [107.08219953]
mat_Sqrt:  [[0.15]]
grads:  [0.04203372]
Stock Position:  0.04203371901779343
Bond Position:  [0.66711835]


portfolio before change:  [5.13287511]
curr_Stock_Price:  106.24125506501784
curr_Factors:  [106.24125507]
mat_Sqrt:  [[0.15]]
grads:  [-0.09923962]
Stock Position:  -0.09923962163169874
Bond Position:  [15.67621706]


portfolio before change:  [5.05863009]
curr_Stock_Price:  106.99926699189639
curr_Factors:  [106.99926699]
mat_Sqrt:  [[0.15]]
grads:  [-0.24257894]
Stock Position:  -0.24257894086026768
Bond Position:  [31.01439894]


portfolio before change:  [4.85381962]
curr_Stock_Price:  107.85156243970165
curr_Factors:  [107.85156244]
mat_Sqrt:  [[0.15]]
grads:  [0.00368871]
Stock Position:  0.003688706198112988
Bond Position:  [4.45598689]


portfolio before change:  [4.85230535]
curr_Stock_Price:  107.36554445204818
curr_Factors:  [107.36554445]
mat_Sqrt:  [[0.15]]
grads:  [-0.04819085]
Stock Position:  -0.048190851185246415
Bond Position:  [10.02634232]


portfolio before change:  [4.82674464]
curr_Stock_Price:  107.90895413834699
curr_Factors:  [107.90895414]
mat_Sqrt:  [[0.15]]
grads:  [-0.18258511]
Stock Position:  -0.1825851108850849
Bond Position:  [24.529313]


portfolio before change:  [4.63429469]
curr_Stock_Price:  108.971379670564
curr_Factors:  [108.97137967]
mat_Sqrt:  [[0.15]]
grads:  [-0.04314008]
Stock Position:  -0.04314007766208268
Bond Position:  [9.33532847]


portfolio before change:  [4.64273507]
curr_Stock_Price:  108.7892541770805
curr_Factors:  [108.78925418]
mat_Sqrt:  [[0.15]]
grads:  [0.14306659]
Stock Position:  0.14306659237979424
Bond Position:  [-10.92137281]


portfolio before change:  [4.50918262]
curr_Stock_Price:  107.86052693357416
curr_Factors:  [107.86052693]
mat_Sqrt:  [[0.15]]
grads:  [0.36760046]
Stock Position:  0.3676004564038498
Bond Position:  [-35.14039631]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.55438522]
Stock Price:  107.98946840525306
PL:  [-3.43508318]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.60885872e-03]
 [ 4.81373382e-03]
 [ 2.10536441e-02]
 [-1.41344538e-02]
 [ 1.20222028e-02]
 [-1.25375755e-03]
 [ 5.35100817e-03]
 [-4.36838495e-02]
 [ 1.64916522e-02]
 [-5.21018732e-03]
 [-3.25470927e-05]
 [ 3.79800243e-03]
 [-3.35867964e-03]
 [ 7.90666189e-03]
 [ 2.73855278e-04]
 [ 1.30738959e-02]
 [ 3.44944679e-02]
 [-1.47017910e-02]
 [ 1.96062330e-02]
 [ 1.98915090e-03]
 [-4.26274149e-03]
 [ 4.88909913e-03]
 [ 8.55659913e-03]
 [ 2.81294847e-02]
 [-1.44551660e-03]
 [ 7.41921971e-03]
 [-8.02534309e-03]
 [ 5.69533352e-03]
 [ 2.57953930e-02]
 [ 1.74470498e-03]
 [-6.43954708e-03]
 [ 9.99738008e-03]
 [ 1.23634184e-02]
 [-5.00442955e-03]
 [ 5.98928422e-03]
 [ 1.94853671e-02]
 [-1.32748356e-03]
 [ 2.79314618e-03]
 [-3.57666358e-02]
 [-1.76391740e-02]
 [ 7.17887458e-03]
 [ 1.51475151e-02]
 [-2.62718662e-03]
 [ 3.49769616e-03]
 [-2.53374958e-03]
 [ 1.68965010e-02]
 [ 1.00869392e-02]
 [ 5.29915893e-03]
 [-7.69715207e-03]
 [-4.25051518e-04]
 [-4.58149144e-03]
 [ 1.62521746e-03]
 [ 1.51568383e-03]
 [ 5.70891722e-03]
 [-4.12352643e-03]
 [-3.91466869e-03]
 [ 5.77922642e-03]
 [ 4.41593700e-03]
 [ 7.22549450e-03]
 [-3.97865700e-03]
 [-2.33829829e-03]
 [ 2.20613919e-03]
 [-6.46420676e-03]
 [ 4.09460033e-03]
 [ 1.98955836e-02]
 [ 3.77026987e-03]
 [ 1.09823586e-02]
 [-4.91301559e-04]
 [ 3.14802950e-03]
 [ 2.34049550e-02]
 [ 3.39459815e-03]
 [-1.53929969e-02]
 [-5.41414175e-03]
 [ 1.55963463e-03]
 [ 9.94174675e-03]
 [-2.69672576e-04]
 [-1.42555185e-03]
 [ 8.29762670e-04]
 [-2.39998890e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.39192146]
curr_Stock_Price:  100.60687510856108
curr_Factors:  [100.60687511]
mat_Sqrt:  [[0.15]]
grads:  [-0.03072572]
Stock Position:  -0.03072572479762182
Bond Position:  [18.48314062]


portfolio before change:  [15.41937589]
curr_Stock_Price:  99.75094106783041
curr_Factors:  [99.75094107]
mat_Sqrt:  [[0.15]]
grads:  [0.03209156]
Stock Position:  0.03209155877099002
Bond Position:  [12.2182127]


portfolio before change:  [15.45358161]
curr_Stock_Price:  100.793023699917
curr_Factors:  [100.7930237]
mat_Sqrt:  [[0.15]]
grads:  [0.14035763]
Stock Position:  0.1403576276424023
Bond Position:  [1.30651192]


portfolio before change:  [15.42433375]
curr_Stock_Price:  100.58406091350861
curr_Factors:  [100.58406091]
mat_Sqrt:  [[0.15]]
grads:  [-0.09422969]
Stock Position:  -0.09422969215503281
Bond Position:  [24.90233884]


portfolio before change:  [15.48406633]
curr_Stock_Price:  99.96667443572873
curr_Factors:  [99.96667444]
mat_Sqrt:  [[0.15]]
grads:  [0.08014802]
Stock Position:  0.08014801886006083
Bond Position:  [7.47193542]


portfolio before change:  [15.56281418]
curr_Stock_Price:  100.94337783800276
curr_Factors:  [100.94337784]
mat_Sqrt:  [[0.15]]
grads:  [-0.00835838]
Stock Position:  -0.008358383696920015
Bond Position:  [16.40653766]


portfolio before change:  [15.55587433]
curr_Stock_Price:  101.89634825921881
curr_Factors:  [101.89634826]
mat_Sqrt:  [[0.15]]
grads:  [0.03567339]
Stock Position:  0.03567338780618517
Bond Position:  [11.92088638]


portfolio before change:  [15.55950911]
curr_Stock_Price:  101.97735280205642
curr_Factors:  [101.9773528]
mat_Sqrt:  [[0.15]]
grads:  [-0.29122566]
Stock Position:  -0.29122566361363356
Bond Position:  [45.25793136]


portfolio before change:  [15.63419813]
curr_Stock_Price:  101.73060152024296
curr_Factors:  [101.73060152]
mat_Sqrt:  [[0.15]]
grads:  [0.10994435]
Stock Position:  0.10994434823106414
Bond Position:  [4.44949345]


portfolio before change:  [15.62186031]
curr_Stock_Price:  101.6158533064646
curr_Factors:  [101.61585331]
mat_Sqrt:  [[0.15]]
grads:  [-0.03473458]
Stock Position:  -0.034734582162151105
Bond Position:  [19.15144452]


portfolio before change:  [15.65232111]
curr_Stock_Price:  100.77335599470118
curr_Factors:  [100.77335599]
mat_Sqrt:  [[0.15]]
grads:  [-0.00021698]
Stock Position:  -0.0002169806178994813
Bond Position:  [15.67418697]


portfolio before change:  [15.65329135]
curr_Stock_Price:  100.81681467649504
curr_Factors:  [100.81681468]
mat_Sqrt:  [[0.15]]
grads:  [0.02532002]
Stock Position:  0.025320016196321536
Bond Position:  [13.10060797]


portfolio before change:  [15.65997311]
curr_Stock_Price:  101.04836854019368
curr_Factors:  [101.04836854]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223912]
Stock Position:  -0.02239119763151791
Bond Position:  [17.9225671]


portfolio before change:  [15.67413027]
curr_Stock_Price:  100.4661320760862
curr_Factors:  [100.46613208]
mat_Sqrt:  [[0.15]]
grads:  [0.05271108]
Stock Position:  0.05271107923969637
Bond Position:  [10.37845203]


portfolio before change:  [15.63745953]
curr_Stock_Price:  99.75813256220667
curr_Factors:  [99.75813256]
mat_Sqrt:  [[0.15]]
grads:  [0.0018257]
Stock Position:  0.0018257018500636782
Bond Position:  [15.45533092]


portfolio before change:  [15.63884577]
curr_Stock_Price:  99.98831911987828
curr_Factors:  [99.98831912]
mat_Sqrt:  [[0.15]]
grads:  [0.08715931]
Stock Position:  0.08715930611139565
Bond Position:  [6.92393326]


portfolio before change:  [15.64058231]
curr_Stock_Price:  100.00327771505744
curr_Factors:  [100.00327772]
mat_Sqrt:  [[0.15]]
grads:  [0.22996312]
Stock Position:  0.22996311963956767
Bond Position:  [-7.35648341]


portfolio before change:  [15.71655492]
curr_Stock_Price:  100.33564579629858
curr_Factors:  [100.3356458]
mat_Sqrt:  [[0.15]]
grads:  [-0.09801194]
Stock Position:  -0.09801193984032869
Bond Position:  [25.5506462]


portfolio before change:  [15.72738886]
curr_Stock_Price:  100.24140242424424
curr_Factors:  [100.24140242]
mat_Sqrt:  [[0.15]]
grads:  [0.13070822]
Stock Position:  0.1307082200424158
Bond Position:  [2.62501357]


portfolio before change:  [15.80620512]
curr_Stock_Price:  100.84314110768726
curr_Factors:  [100.84314111]
mat_Sqrt:  [[0.15]]
grads:  [0.01326101]
Stock Position:  0.013261006031367777
Bond Position:  [14.46892362]


portfolio before change:  [15.81541647]
curr_Stock_Price:  101.46956558708033
curr_Factors:  [101.46956559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02841828]
Stock Position:  -0.028418276620435706
Bond Position:  [18.69900666]


portfolio before change:  [15.80590333]
curr_Stock_Price:  101.84544590862849
curr_Factors:  [101.84544591]
mat_Sqrt:  [[0.15]]
grads:  [0.03259399]
Stock Position:  0.03259399421592967
Bond Position:  [12.48635345]


portfolio before change:  [15.82187869]
curr_Stock_Price:  102.31163438650772
curr_Factors:  [102.31163439]
mat_Sqrt:  [[0.15]]
grads:  [0.05704399]
Stock Position:  0.05704399418503985
Bond Position:  [9.98561442]


portfolio before change:  [15.80420626]
curr_Stock_Price:  101.99088981035341
curr_Factors:  [101.99088981]
mat_Sqrt:  [[0.15]]
grads:  [0.1875299]
Stock Position:  0.1875298983138078
Bond Position:  [-3.32213493]


portfolio before change:  [15.71029334]
curr_Stock_Price:  101.49120801469086
curr_Factors:  [101.49120801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963678]
Stock Position:  -0.009636777303695169
Bond Position:  [16.68834151]


portfolio before change:  [15.71077159]
curr_Stock_Price:  101.5498180562068
curr_Factors:  [101.54981806]
mat_Sqrt:  [[0.15]]
grads:  [0.04946146]
Stock Position:  0.04946146476080871
Bond Position:  [10.68796884]


portfolio before change:  [15.67689428]
curr_Stock_Price:  100.85138897356185
curr_Factors:  [100.85138897]
mat_Sqrt:  [[0.15]]
grads:  [-0.05350229]
Stock Position:  -0.05350228726874869
Bond Position:  [21.07267426]


portfolio before change:  [15.68585433]
curr_Stock_Price:  100.70853594067205
curr_Factors:  [100.70853594]
mat_Sqrt:  [[0.15]]
grads:  [0.03796889]
Stock Position:  0.0379688901553132
Bond Position:  [11.86206299]


portfolio before change:  [15.66544615]
curr_Stock_Price:  100.15151203725712
curr_Factors:  [100.15151204]
mat_Sqrt:  [[0.15]]
grads:  [0.17196929]
Stock Position:  0.17196928680986073
Bond Position:  [-1.55753795]


portfolio before change:  [15.68838188]
curr_Stock_Price:  100.28544917710985
curr_Factors:  [100.28544918]
mat_Sqrt:  [[0.15]]
grads:  [0.01163137]
Stock Position:  0.011631366548211
Bond Position:  [14.52192506]


portfolio before change:  [15.67039436]
curr_Stock_Price:  98.66094853792
curr_Factors:  [98.66094854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293031]
Stock Position:  -0.04293031389441615
Bond Position:  [19.90593985]


portfolio before change:  [15.63160418]
curr_Stock_Price:  99.59349105680985
curr_Factors:  [99.59349106]
mat_Sqrt:  [[0.15]]
grads:  [0.0666492]
Stock Position:  0.06664920050885625
Bond Position:  [8.99377762]


portfolio before change:  [15.68922901]
curr_Stock_Price:  100.44965593451923
curr_Factors:  [100.44965593]
mat_Sqrt:  [[0.15]]
grads:  [0.08242279]
Stock Position:  0.08242278902566774
Bond Position:  [7.40988821]


portfolio before change:  [15.63540782]
curr_Stock_Price:  99.79104768903589
curr_Factors:  [99.79104769]
mat_Sqrt:  [[0.15]]
grads:  [-0.03336286]
Stock Position:  -0.03336286366636642
Bond Position:  [18.96472294]


portfolio before change:  [15.64719182]
curr_Stock_Price:  99.47336886556789
curr_Factors:  [99.47336887]
mat_Sqrt:  [[0.15]]
grads:  [0.03992856]
Stock Position:  0.03992856148721838
Bond Position:  [11.6753633]


portfolio before change:  [15.64204726]
curr_Stock_Price:  99.3262488160633
curr_Factors:  [99.32624882]
mat_Sqrt:  [[0.15]]
grads:  [0.12990245]
Stock Position:  0.1299024472050822
Bond Position:  [2.73932447]


portfolio before change:  [15.63484388]
curr_Stock_Price:  99.26947852330393
curr_Factors:  [99.26947852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00884989]
Stock Position:  -0.008849890426245155
Bond Position:  [16.51336789]


portfolio before change:  [15.63576569]
curr_Stock_Price:  99.28194281079645
curr_Factors:  [99.28194281]
mat_Sqrt:  [[0.15]]
grads:  [0.01862097]
Stock Position:  0.018620974514088624
Bond Position:  [13.78703916]


portfolio before change:  [15.62776285]
curr_Stock_Price:  98.80589073593505
curr_Factors:  [98.80589074]
mat_Sqrt:  [[0.15]]
grads:  [-0.23844424]
Stock Position:  -0.2384442383630971
Bond Position:  [39.18745821]


portfolio before change:  [15.72798143]
curr_Stock_Price:  98.39586075064571
curr_Factors:  [98.39586075]
mat_Sqrt:  [[0.15]]
grads:  [-0.11759449]
Stock Position:  -0.11759449336345601
Bond Position:  [27.29879283]


portfolio before change:  [15.67055541]
curr_Stock_Price:  98.8987095567697
curr_Factors:  [98.89870956]
mat_Sqrt:  [[0.15]]
grads:  [0.04785916]
Stock Position:  0.047859163844119264
Bond Position:  [10.93734586]


portfolio before change:  [15.66984729]
curr_Stock_Price:  98.8696298731287
curr_Factors:  [98.86962987]
mat_Sqrt:  [[0.15]]
grads:  [0.10098343]
Stock Position:  0.10098343410484781
Bond Position:  [5.68565253]


portfolio before change:  [15.62809445]
curr_Stock_Price:  98.45264864398983
curr_Factors:  [98.45264864]
mat_Sqrt:  [[0.15]]
grads:  [-0.01751458]
Stock Position:  -0.017514577443082775
Bond Position:  [17.35245099]


portfolio before change:  [15.64334393]
curr_Stock_Price:  97.6438988222709
curr_Factors:  [97.64389882]
mat_Sqrt:  [[0.15]]
grads:  [0.02331797]
Stock Position:  0.023317974366788785
Bond Position:  [13.366486]


portfolio before change:  [15.65741016]
curr_Stock_Price:  98.21130654399929
curr_Factors:  [98.21130654]
mat_Sqrt:  [[0.15]]
grads:  [-0.01689166]
Stock Position:  -0.016891663849767393
Bond Position:  [17.31636253]


portfolio before change:  [15.66565259]
curr_Stock_Price:  97.78742125222668
curr_Factors:  [97.78742125]
mat_Sqrt:  [[0.15]]
grads:  [0.11264334]
Stock Position:  0.11264334021088283
Bond Position:  [4.65055083]


portfolio before change:  [15.6449373]
curr_Stock_Price:  97.60093922896978
curr_Factors:  [97.60093923]
mat_Sqrt:  [[0.15]]
grads:  [0.06724626]
Stock Position:  0.06724626158819684
Bond Position:  [9.08163901]


portfolio before change:  [15.624]
curr_Stock_Price:  97.28114566016293
curr_Factors:  [97.28114566]
mat_Sqrt:  [[0.15]]
grads:  [0.03532773]
Stock Position:  0.03532772618929782
Bond Position:  [12.18727832]


portfolio before change:  [15.62319193]
curr_Stock_Price:  97.23671036760442
curr_Factors:  [97.23671037]
mat_Sqrt:  [[0.15]]
grads:  [-0.05131435]
Stock Position:  -0.05131434714434713
Bond Position:  [20.61283024]


portfolio before change:  [15.62357822]
curr_Stock_Price:  97.25428938133484
curr_Factors:  [97.25428938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00283368]
Stock Position:  -0.0028336767869941285
Bond Position:  [15.89916544]


portfolio before change:  [15.62470554]
curr_Stock_Price:  97.20714367653449
curr_Factors:  [97.20714368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054328]
Stock Position:  -0.030543276264458238
Bond Position:  [18.59373019]


portfolio before change:  [15.6061786]
curr_Stock_Price:  97.8517727444406
curr_Factors:  [97.85177274]
mat_Sqrt:  [[0.15]]
grads:  [0.01083478]
Stock Position:  0.010834783053484988
Bond Position:  [14.54597587]


portfolio before change:  [15.61894842]
curr_Stock_Price:  98.9464568268132
curr_Factors:  [98.94645683]
mat_Sqrt:  [[0.15]]
grads:  [0.01010456]
Stock Position:  0.01010455885950303
Bond Position:  [14.61913812]


portfolio before change:  [15.624148]
curr_Stock_Price:  99.37060756726325
curr_Factors:  [99.37060757]
mat_Sqrt:  [[0.15]]
grads:  [0.03805945]
Stock Position:  0.03805944815733819
Bond Position:  [11.84215751]


portfolio before change:  [15.66526182]
curr_Stock_Price:  100.43141280635459
curr_Factors:  [100.43141281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02749018]
Stock Position:  -0.02749017616719539
Bond Position:  [18.42613905]


portfolio before change:  [15.66598984]
curr_Stock_Price:  100.44682356793294
curr_Factors:  [100.44682357]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609779]
Stock Position:  -0.026097791291335316
Bond Position:  [18.28743008]


portfolio before change:  [15.67691283]
curr_Stock_Price:  100.07207980269708
curr_Factors:  [100.0720798]
mat_Sqrt:  [[0.15]]
grads:  [0.03852818]
Stock Position:  0.03852817614347681
Bond Position:  [11.82131811]


portfolio before change:  [15.66737187]
curr_Stock_Price:  99.80526678590408
curr_Factors:  [99.80526679]
mat_Sqrt:  [[0.15]]
grads:  [0.02943958]
Stock Position:  0.029439580014841996
Bond Position:  [12.72914673]


portfolio before change:  [15.66702114]
curr_Stock_Price:  99.76632854595532
curr_Factors:  [99.76632855]
mat_Sqrt:  [[0.15]]
grads:  [0.04816996]
Stock Position:  0.04816996330763774
Bond Position:  [10.86128075]


portfolio before change:  [15.63028075]
curr_Stock_Price:  98.98951180097806
curr_Factors:  [98.9895118]
mat_Sqrt:  [[0.15]]
grads:  [-0.02652438]
Stock Position:  -0.026524379982598822
Bond Position:  [18.25591618]


portfolio before change:  [15.63944478]
curr_Stock_Price:  98.68703546389435
curr_Factors:  [98.68703546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558866]
Stock Position:  -0.015588655257112317
Bond Position:  [17.17784296]


portfolio before change:  [15.63419804]
curr_Stock_Price:  99.09248372140553
curr_Factors:  [99.09248372]
mat_Sqrt:  [[0.15]]
grads:  [0.01470759]
Stock Position:  0.014707594576446107
Bond Position:  [14.17678596]


portfolio before change:  [15.63535219]
curr_Stock_Price:  99.11071087247262
curr_Factors:  [99.11071087]
mat_Sqrt:  [[0.15]]
grads:  [-0.04309471]
Stock Position:  -0.04309471176114038
Bond Position:  [19.90649971]


portfolio before change:  [15.64545844]
curr_Stock_Price:  98.90506961616578
curr_Factors:  [98.90506962]
mat_Sqrt:  [[0.15]]
grads:  [0.02729734]
Stock Position:  0.027297335523355278
Bond Position:  [12.94561357]


portfolio before change:  [15.62917371]
curr_Stock_Price:  98.27885989261982
curr_Factors:  [98.27885989]
mat_Sqrt:  [[0.15]]
grads:  [0.13263722]
Stock Position:  0.13263722392697821
Bond Position:  [2.59373856]


portfolio before change:  [15.54660736]
curr_Stock_Price:  97.6551401050603
curr_Factors:  [97.65514011]
mat_Sqrt:  [[0.15]]
grads:  [0.02513513]
Stock Position:  0.025135132462130762
Bond Position:  [13.09203248]


portfolio before change:  [15.55853546]
curr_Stock_Price:  98.09714391074118
curr_Factors:  [98.09714391]
mat_Sqrt:  [[0.15]]
grads:  [0.07321572]
Stock Position:  0.0732157236840238
Bond Position:  [8.37628208]


portfolio before change:  [15.55836054]
curr_Stock_Price:  98.08760425094685
curr_Factors:  [98.08760425]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327534]
Stock Position:  -0.0032753437266025537
Bond Position:  [15.87963116]


portfolio before change:  [15.56055487]
curr_Stock_Price:  97.72067631875184
curr_Factors:  [97.72067632]
mat_Sqrt:  [[0.15]]
grads:  [0.02098686]
Stock Position:  0.020986863308243786
Bond Position:  [13.50970439]


portfolio before change:  [15.54761321]
curr_Stock_Price:  97.06378759684195
curr_Factors:  [97.0637876]
mat_Sqrt:  [[0.15]]
grads:  [0.15603303]
Stock Position:  0.15603303343065336
Bond Position:  [0.402456]


portfolio before change:  [15.52533523]
curr_Stock_Price:  96.92084904297715
curr_Factors:  [96.92084904]
mat_Sqrt:  [[0.15]]
grads:  [0.02263065]
Stock Position:  0.022630654350008016
Bond Position:  [13.331953]


portfolio before change:  [15.51271646]
curr_Stock_Price:  96.32643197984038
curr_Factors:  [96.32643198]
mat_Sqrt:  [[0.15]]
grads:  [-0.10261998]
Stock Position:  -0.10261997921682671
Bond Position:  [25.39773291]


portfolio before change:  [15.41310474]
curr_Stock_Price:  97.31258621527552
curr_Factors:  [97.31258622]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609428]
Stock Position:  -0.0360942783396685
Bond Position:  [18.92553231]


portfolio before change:  [15.420934]
curr_Stock_Price:  97.1284467502817
curr_Factors:  [97.12844675]
mat_Sqrt:  [[0.15]]
grads:  [0.01039756]
Stock Position:  0.010397564206028847
Bond Position:  [14.41103474]


portfolio before change:  [15.41642735]
curr_Stock_Price:  96.60838579899101
curr_Factors:  [96.6083858]
mat_Sqrt:  [[0.15]]
grads:  [0.06627831]
Stock Position:  0.06627831169685444
Bond Position:  [9.01338665]


portfolio before change:  [15.54299455]
curr_Stock_Price:  98.509518186078
curr_Factors:  [98.50951819]
mat_Sqrt:  [[0.15]]
grads:  [-0.00179782]
Stock Position:  -0.0017978171723070115
Bond Position:  [15.72009666]


portfolio before change:  [15.54343791]
curr_Stock_Price:  98.80942728810093
curr_Factors:  [98.80942729]
mat_Sqrt:  [[0.15]]
grads:  [-0.00950368]
Stock Position:  -0.009503679002539744
Bond Position:  [16.48249099]


portfolio before change:  [15.54618519]
curr_Stock_Price:  98.62875084872474
curr_Factors:  [98.62875085]
mat_Sqrt:  [[0.15]]
grads:  [0.00553175]
Stock Position:  0.005531751135316807
Bond Position:  [15.00059548]


portfolio before change:  [15.54885971]
curr_Stock_Price:  98.9427489029637
curr_Factors:  [98.9427489]
mat_Sqrt:  [[0.15]]
grads:  [-0.15999926]
Stock Position:  -0.15999926022581556
Bond Position:  [31.37962634]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.56800481]
Stock Price:  98.83534958216822
PL:  [15.56800481]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.34289296e-02]
 [ 8.79447010e-03]
 [ 2.59400547e-03]
 [-1.42455554e-02]
 [-1.53394669e-03]
 [-5.78931835e-03]
 [-9.28242956e-04]
 [-8.56439353e-03]
 [ 7.25760305e-04]
 [-1.93828565e-03]
 [-9.48156971e-03]
 [ 1.62897493e-02]
 [-3.73958981e-03]
 [ 5.78667166e-03]
 [-1.51012868e-03]
 [ 1.55333052e-02]
 [ 7.16939348e-02]
 [-1.47216120e-02]
 [ 1.79913409e-02]
 [ 1.45392828e-03]
 [-4.61927610e-03]
 [ 5.21059556e-03]
 [ 8.38545347e-03]
 [ 4.24881559e-02]
 [ 4.02029469e-03]
 [ 5.90157148e-03]
 [ 7.85925692e-02]
 [ 3.49145238e-02]
 [-2.13519038e-03]
 [-7.10054914e-03]
 [ 9.91411503e-03]
 [ 1.71976350e-02]
 [ 1.88179776e-02]
 [-1.55296986e-02]
 [ 3.10364854e-03]
 [-4.57937071e-02]
 [-8.01959542e-03]
 [-2.35477885e-02]
 [ 5.17559229e-02]
 [-9.78228085e-02]
 [ 2.90478220e-03]
 [-1.34776378e-02]
 [-2.56061885e-02]
 [ 3.74935845e-02]
 [-1.94267755e-02]
 [ 1.19376013e-02]
 [ 1.03624739e-02]
 [-4.08719683e-03]
 [ 1.60827196e-02]
 [-1.65455386e-03]
 [ 1.73871181e-02]
 [ 2.38149029e-02]
 [-8.00581345e-03]
 [-7.83653806e-02]
 [-2.58811699e-02]
 [-1.92441282e-03]
 [-6.89516426e-03]
 [-1.37427065e-02]
 [-2.01440377e-04]
 [-2.96240673e-03]
 [-7.63478410e-03]
 [-4.15262120e-03]
 [-1.73824191e-02]
 [ 8.59332288e-05]
 [ 2.90649382e-03]
 [ 2.19492114e-02]
 [ 1.42479512e-03]
 [ 1.51917440e-02]
 [ 8.09479836e-03]
 [ 1.12709489e-02]
 [ 4.78302286e-03]
 [-1.47293302e-02]
 [-3.53845217e-02]
 [ 6.51233854e-04]
 [-8.11723078e-03]
 [-2.83362392e-02]
 [-5.56440929e-03]
 [ 1.76555490e-02]
 [ 3.55433853e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.59863729]
curr_Stock_Price:  99.93499445699305
curr_Factors:  [99.93499446]
mat_Sqrt:  [[0.15]]
grads:  [-0.0895262]
Stock Position:  -0.08952619728389476
Bond Position:  [9.54543732]


portfolio before change:  [0.60157818]
curr_Stock_Price:  99.90880905052134
curr_Factors:  [99.90880905]
mat_Sqrt:  [[0.15]]
grads:  [0.0586298]
Stock Position:  0.058629800657334155
Bond Position:  [-5.25605538]


portfolio before change:  [0.60322199]
curr_Stock_Price:  99.9424493932134
curr_Factors:  [99.94244939]
mat_Sqrt:  [[0.15]]
grads:  [0.01729337]
Stock Position:  0.017293369793504137
Bond Position:  [-1.12511975]


portfolio before change:  [0.61433108]
curr_Stock_Price:  100.58890627051133
curr_Factors:  [100.58890627]
mat_Sqrt:  [[0.15]]
grads:  [-0.09497037]
Stock Position:  -0.09497036942988887
Bond Position:  [10.16729667]


portfolio before change:  [0.61685859]
curr_Stock_Price:  100.5689839128961
curr_Factors:  [100.56898391]
mat_Sqrt:  [[0.15]]
grads:  [-0.01022631]
Stock Position:  -0.010226311239831774
Bond Position:  [1.64530832]


portfolio before change:  [0.62252455]
curr_Stock_Price:  100.02498340178286
curr_Factors:  [100.0249834]
mat_Sqrt:  [[0.15]]
grads:  [-0.03859546]
Stock Position:  -0.038595455682885776
Bond Position:  [4.48303436]


portfolio before change:  [0.61086495]
curr_Stock_Price:  100.33434088405939
curr_Factors:  [100.33434088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00618829]
Stock Position:  -0.006188286373273455
Bond Position:  [1.23176259]


portfolio before change:  [0.61238099]
curr_Stock_Price:  100.10179734891354
curr_Factors:  [100.10179735]
mat_Sqrt:  [[0.15]]
grads:  [-0.05709596]
Stock Position:  -0.05709595689489009
Bond Position:  [6.32778889]


portfolio before change:  [0.59852521]
curr_Stock_Price:  100.35139961667733
curr_Factors:  [100.35139962]
mat_Sqrt:  [[0.15]]
grads:  [0.0048384]
Stock Position:  0.004838402031950943
Bond Position:  [0.11298479]


portfolio before change:  [0.60245763]
curr_Stock_Price:  101.1626927866094
curr_Factors:  [101.16269279]
mat_Sqrt:  [[0.15]]
grads:  [-0.0129219]
Stock Position:  -0.012921904340281454
Bond Position:  [1.90967227]


portfolio before change:  [0.59561587]
curr_Stock_Price:  101.70139962813911
curr_Factors:  [101.70139963]
mat_Sqrt:  [[0.15]]
grads:  [-0.06321046]
Stock Position:  -0.06321046470503111
Bond Position:  [7.0242086]


portfolio before change:  [0.59105911]
curr_Stock_Price:  101.78043373625216
curr_Factors:  [101.78043374]
mat_Sqrt:  [[0.15]]
grads:  [0.10859833]
Stock Position:  0.10859832869761962
Bond Position:  [-10.46212588]


portfolio before change:  [0.56652292]
curr_Stock_Price:  101.56051973875664
curr_Factors:  [101.56051974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0249306]
Stock Position:  -0.024930598766280364
Bond Position:  [3.09848749]


portfolio before change:  [0.57925017]
curr_Stock_Price:  101.05778064591406
curr_Factors:  [101.05778065]
mat_Sqrt:  [[0.15]]
grads:  [0.03857781]
Stock Position:  0.03857781104683911
Bond Position:  [-3.3193378]


portfolio before change:  [0.57248472]
curr_Stock_Price:  100.88778717773181
curr_Factors:  [100.88778718]
mat_Sqrt:  [[0.15]]
grads:  [-0.01006752]
Stock Position:  -0.01006752452434475
Bond Position:  [1.588175]


portfolio before change:  [0.56834526]
curr_Stock_Price:  101.30881669109351
curr_Factors:  [101.30881669]
mat_Sqrt:  [[0.15]]
grads:  [0.10355537]
Stock Position:  0.10355536787622097
Bond Position:  [-9.92272652]


portfolio before change:  [0.59411495]
curr_Stock_Price:  101.56365497896648
curr_Factors:  [101.56365498]
mat_Sqrt:  [[0.15]]
grads:  [0.47795957]
Stock Position:  0.47795956543740803
Bond Position:  [-47.94920545]


portfolio before change:  [0.18118012]
curr_Stock_Price:  100.70597174580807
curr_Factors:  [100.70597175]
mat_Sqrt:  [[0.15]]
grads:  [-0.09814408]
Stock Position:  -0.09814407976612827
Bond Position:  [10.06487505]


portfolio before change:  [0.12980303]
curr_Stock_Price:  101.23586788568419
curr_Factors:  [101.23586789]
mat_Sqrt:  [[0.15]]
grads:  [0.11994227]
Stock Position:  0.11994227240107783
Bond Position:  [-12.01265702]


portfolio before change:  [0.15903398]
curr_Stock_Price:  101.48583617683266
curr_Factors:  [101.48583618]
mat_Sqrt:  [[0.15]]
grads:  [0.00969286]
Stock Position:  0.009692855170643595
Bond Position:  [-0.82465353]


portfolio before change:  [0.16122559]
curr_Stock_Price:  101.71726000119799
curr_Factors:  [101.71726]
mat_Sqrt:  [[0.15]]
grads:  [-0.03079517]
Stock Position:  -0.030795174000584867
Bond Position:  [3.29362631]


portfolio before change:  [0.14727562]
curr_Stock_Price:  102.17693682442128
curr_Factors:  [102.17693682]
mat_Sqrt:  [[0.15]]
grads:  [0.0347373]
Stock Position:  0.03473730376637702
Bond Position:  [-3.40207567]


portfolio before change:  [0.152843]
curr_Stock_Price:  102.34332903810339
curr_Factors:  [102.34332904]
mat_Sqrt:  [[0.15]]
grads:  [0.05590302]
Stock Position:  0.0559030231614633
Bond Position:  [-5.56845849]


portfolio before change:  [0.20062937]
curr_Stock_Price:  103.20436298622369
curr_Factors:  [103.20436299]
mat_Sqrt:  [[0.15]]
grads:  [0.28325437]
Stock Position:  0.2832543725800472
Bond Position:  [-29.03245772]


portfolio before change:  [0.31469844]
curr_Stock_Price:  103.61347815232534
curr_Factors:  [103.61347815]
mat_Sqrt:  [[0.15]]
grads:  [0.02680196]
Stock Position:  0.026801964588233456
Bond Position:  [-2.46234633]


portfolio before change:  [0.34912369]
curr_Stock_Price:  104.90365043525397
curr_Factors:  [104.90365044]
mat_Sqrt:  [[0.15]]
grads:  [0.03934381]
Stock Position:  0.03934380984220657
Bond Position:  [-3.77818558]


portfolio before change:  [0.35396746]
curr_Stock_Price:  105.03276651125783
curr_Factors:  [105.03276651]
mat_Sqrt:  [[0.15]]
grads:  [0.52395046]
Stock Position:  0.5239504616057987
Bond Position:  [-54.67799903]


portfolio before change:  [0.47338661]
curr_Stock_Price:  105.2672097190243
curr_Factors:  [105.26720972]
mat_Sqrt:  [[0.15]]
grads:  [0.23276349]
Stock Position:  0.2327634918944104
Bond Position:  [-24.02897671]


portfolio before change:  [0.45225804]
curr_Stock_Price:  105.18288933063556
curr_Factors:  [105.18288933]
mat_Sqrt:  [[0.15]]
grads:  [-0.0142346]
Stock Position:  -0.014234602549321903
Bond Position:  [1.94949467]


portfolio before change:  [0.43681151]
curr_Stock_Price:  106.27658906049452
curr_Factors:  [106.27658906]
mat_Sqrt:  [[0.15]]
grads:  [-0.04733699]
Stock Position:  -0.04733699428215575
Bond Position:  [5.4676258]


portfolio before change:  [0.42639726]
curr_Stock_Price:  106.50381062798712
curr_Factors:  [106.50381063]
mat_Sqrt:  [[0.15]]
grads:  [0.0660941]
Stock Position:  0.0660941001922983
Bond Position:  [-6.61287627]


portfolio before change:  [0.45095983]
curr_Stock_Price:  106.8816943388443
curr_Factors:  [106.88169434]
mat_Sqrt:  [[0.15]]
grads:  [0.1146509]
Stock Position:  0.11465090026211172
Bond Position:  [-11.80312265]


portfolio before change:  [0.49434318]
curr_Stock_Price:  107.26652400439616
curr_Factors:  [107.266524]
mat_Sqrt:  [[0.15]]
grads:  [0.12545318]
Stock Position:  0.12545318400504563
Bond Position:  [-12.9625838]


portfolio before change:  [0.54308975]
curr_Stock_Price:  107.66154593856278
curr_Factors:  [107.66154594]
mat_Sqrt:  [[0.15]]
grads:  [-0.10353132]
Stock Position:  -0.10353132412028321
Bond Position:  [11.68943216]


portfolio before change:  [0.53421039]
curr_Stock_Price:  107.75436785054012
curr_Factors:  [107.75436785]
mat_Sqrt:  [[0.15]]
grads:  [0.02069099]
Stock Position:  0.020690990283243817
Bond Position:  [-1.69533419]


portfolio before change:  [0.54174027]
curr_Stock_Price:  108.12341008660813
curr_Factors:  [108.12341009]
mat_Sqrt:  [[0.15]]
grads:  [-0.30529138]
Stock Position:  -0.3052913806478592
Bond Position:  [33.55088542]


portfolio before change:  [0.57975945]
curr_Stock_Price:  108.00574484442559
curr_Factors:  [108.00574484]
mat_Sqrt:  [[0.15]]
grads:  [-0.05346397]
Stock Position:  -0.05346396946942642
Bond Position:  [6.3541753]


portfolio before change:  [0.52580646]
curr_Stock_Price:  109.02231993242322
curr_Factors:  [109.02231993]
mat_Sqrt:  [[0.15]]
grads:  [-0.15698526]
Stock Position:  -0.15698525671151914
Bond Position:  [17.64070334]


portfolio before change:  [0.53534907]
curr_Stock_Price:  108.96855673208138
curr_Factors:  [108.96855673]
mat_Sqrt:  [[0.15]]
grads:  [0.34503949]
Stock Position:  0.345039486230353
Bond Position:  [-37.06310576]


portfolio before change:  [0.28519518]
curr_Stock_Price:  108.25026973180856
curr_Factors:  [108.25026973]
mat_Sqrt:  [[0.15]]
grads:  [-0.65215206]
Stock Position:  -0.6521520567007005
Bond Position:  [70.88083122]


portfolio before change:  [-0.06342566]
curr_Stock_Price:  108.79163278430718
curr_Factors:  [108.79163278]
mat_Sqrt:  [[0.15]]
grads:  [0.01936521]
Stock Position:  0.019365214699131467
Bond Position:  [-2.17019899]


portfolio before change:  [-0.06775508]
curr_Stock_Price:  108.57507018056278
curr_Factors:  [108.57507018]
mat_Sqrt:  [[0.15]]
grads:  [-0.08985092]
Stock Position:  -0.08985091862622896
Bond Position:  [9.68781471]


portfolio before change:  [-0.08155495]
curr_Stock_Price:  108.7353954080662
curr_Factors:  [108.73539541]
mat_Sqrt:  [[0.15]]
grads:  [-0.17070792]
Stock Position:  -0.1707079233617728
Bond Position:  [18.4804386]


portfolio before change:  [-0.14494117]
curr_Stock_Price:  109.11347562380998
curr_Factors:  [109.11347562]
mat_Sqrt:  [[0.15]]
grads:  [0.24995723]
Stock Position:  0.2499572300210606
Bond Position:  [-27.4186433]


portfolio before change:  [-0.26354985]
curr_Stock_Price:  108.64581577137275
curr_Factors:  [108.64581577]
mat_Sqrt:  [[0.15]]
grads:  [-0.12951184]
Stock Position:  -0.12951183654800855
Bond Position:  [13.80736928]


portfolio before change:  [-0.12976664]
curr_Stock_Price:  107.61949855147553
curr_Factors:  [107.61949855]
mat_Sqrt:  [[0.15]]
grads:  [0.07958401]
Stock Position:  0.0795840088357145
Bond Position:  [-8.69455776]


portfolio before change:  [-0.12991898]
curr_Stock_Price:  107.62441257144427
curr_Factors:  [107.62441257]
mat_Sqrt:  [[0.15]]
grads:  [0.06908316]
Stock Position:  0.06908315960780306
Bond Position:  [-7.56495346]


portfolio before change:  [-0.08499431]
curr_Stock_Price:  108.28155531392953
curr_Factors:  [108.28155531]
mat_Sqrt:  [[0.15]]
grads:  [-0.02724798]
Stock Position:  -0.027247978846214438
Bond Position:  [2.86545922]


portfolio before change:  [-0.07524259]
curr_Stock_Price:  107.93024008997901
curr_Factors:  [107.93024009]
mat_Sqrt:  [[0.15]]
grads:  [0.10721813]
Stock Position:  0.10721813091193695
Bond Position:  [-11.6473212]


portfolio before change:  [-0.02605431]
curr_Stock_Price:  108.39579807451251
curr_Factors:  [108.39579807]
mat_Sqrt:  [[0.15]]
grads:  [-0.01103036]
Stock Position:  -0.011030359063440489
Bond Position:  [1.16959026]


portfolio before change:  [-0.02364393]
curr_Stock_Price:  108.18390348346612
curr_Factors:  [108.18390348]
mat_Sqrt:  [[0.15]]
grads:  [0.11591412]
Stock Position:  0.11591412038618609
Bond Position:  [-12.56368595]


portfolio before change:  [-0.17418173]
curr_Stock_Price:  106.89197682282108
curr_Factors:  [106.89197682]
mat_Sqrt:  [[0.15]]
grads:  [0.15876602]
Stock Position:  0.15876601954602623
Bond Position:  [-17.14499541]


portfolio before change:  [-0.16203965]
curr_Stock_Price:  106.97520419346698
curr_Factors:  [106.97520419]
mat_Sqrt:  [[0.15]]
grads:  [-0.05337209]
Stock Position:  -0.05337208968144415
Bond Position:  [5.54745054]


portfolio before change:  [-0.22988646]
curr_Stock_Price:  108.25290450959862
curr_Factors:  [108.25290451]
mat_Sqrt:  [[0.15]]
grads:  [-0.52243587]
Stock Position:  -0.522435870397531
Bond Position:  [56.32531393]


portfolio before change:  [-0.21032474]
curr_Stock_Price:  108.22219973116509
curr_Factors:  [108.22219973]
mat_Sqrt:  [[0.15]]
grads:  [-0.17254113]
Stock Position:  -0.1725411324607215
Bond Position:  [18.46245616]


portfolio before change:  [-0.1550745]
curr_Stock_Price:  107.90867273475766
curr_Factors:  [107.90867273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01282942]
Stock Position:  -0.012829418784468253
Bond Position:  [1.22933106]


portfolio before change:  [-0.15847369]
curr_Stock_Price:  108.17961470247175
curr_Factors:  [108.1796147]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596776]
Stock Position:  -0.04596776170032759
Bond Position:  [4.81430106]


portfolio before change:  [-0.17516045]
curr_Stock_Price:  108.54917079294741
curr_Factors:  [108.54917079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09161804]
Stock Position:  -0.09161804349768222
Bond Position:  [9.7699022]


portfolio before change:  [-0.06554146]
curr_Stock_Price:  107.35935761236841
curr_Factors:  [107.35935761]
mat_Sqrt:  [[0.15]]
grads:  [-0.00134294]
Stock Position:  -0.001342935847564788
Bond Position:  [0.07863527]


portfolio before change:  [-0.06604154]
curr_Stock_Price:  107.73539603022137
curr_Factors:  [107.73539603]
mat_Sqrt:  [[0.15]]
grads:  [-0.01974938]
Stock Position:  -0.019749378212516367
Bond Position:  [2.06166555]


portfolio before change:  [-0.06937648]
curr_Stock_Price:  107.91078394246328
curr_Factors:  [107.91078394]
mat_Sqrt:  [[0.15]]
grads:  [-0.05089856]
Stock Position:  -0.050898560638579046
Bond Position:  [5.4231271]


portfolio before change:  [-0.05196527]
curr_Stock_Price:  107.57536673208196
curr_Factors:  [107.57536673]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768414]
Stock Position:  -0.027684141359049678
Bond Position:  [2.92616639]


portfolio before change:  [-0.04218348]
curr_Stock_Price:  107.22863753460364
curr_Factors:  [107.22863753]
mat_Sqrt:  [[0.15]]
grads:  [-0.11588279]
Stock Position:  -0.11588279404135529
Bond Position:  [12.38377064]


portfolio before change:  [0.02064588]
curr_Stock_Price:  106.69313658262104
curr_Factors:  [106.69313658]
mat_Sqrt:  [[0.15]]
grads:  [0.00057289]
Stock Position:  0.0005728881920362373
Bond Position:  [-0.04047736]


portfolio before change:  [0.0204873]
curr_Stock_Price:  106.42074847498228
curr_Factors:  [106.42074847]
mat_Sqrt:  [[0.15]]
grads:  [0.01937663]
Stock Position:  0.019376625461715036
Bond Position:  [-2.04158769]


portfolio before change:  [0.01864384]
curr_Stock_Price:  106.33219566249673
curr_Factors:  [106.33219566]
mat_Sqrt:  [[0.15]]
grads:  [0.14632808]
Stock Position:  0.1463280760985732
Bond Position:  [-15.54074178]


portfolio before change:  [-0.01098225]
curr_Stock_Price:  106.13637017084187
curr_Factors:  [106.13637017]
mat_Sqrt:  [[0.15]]
grads:  [0.00949863]
Stock Position:  0.009498634125754777
Bond Position:  [-1.0191328]


portfolio before change:  [-0.01306069]
curr_Stock_Price:  105.92426242751706
curr_Factors:  [105.92426243]
mat_Sqrt:  [[0.15]]
grads:  [0.10127829]
Stock Position:  0.10127829359934136
Bond Position:  [-10.74088924]


portfolio before change:  [0.02597831]
curr_Stock_Price:  106.31635354877012
curr_Factors:  [106.31635355]
mat_Sqrt:  [[0.15]]
grads:  [0.05396532]
Stock Position:  0.05396532238103079
Bond Position:  [-5.71141799]


portfolio before change:  [0.01852255]
curr_Stock_Price:  106.18481013674909
curr_Factors:  [106.18481014]
mat_Sqrt:  [[0.15]]
grads:  [0.07513966]
Stock Position:  0.07513965941899353
Bond Position:  [-7.96016792]


portfolio before change:  [0.004909]
curr_Stock_Price:  106.0102548810744
curr_Factors:  [106.01025488]
mat_Sqrt:  [[0.15]]
grads:  [0.03188682]
Stock Position:  0.03188681907531746
Bond Position:  [-3.37542082]


portfolio before change:  [0.03836093]
curr_Stock_Price:  107.0659544986896
curr_Factors:  [107.0659545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09819553]
Stock Position:  -0.09819553485291661
Bond Position:  [10.5517596]


portfolio before change:  [0.05601623]
curr_Stock_Price:  106.89287338715347
curr_Factors:  [106.89287339]
mat_Sqrt:  [[0.15]]
grads:  [-0.23589681]
Stock Position:  -0.2358968111423146
Bond Position:  [25.2717042]


portfolio before change:  [0.10136296]
curr_Stock_Price:  106.70733802227896
curr_Factors:  [106.70733802]
mat_Sqrt:  [[0.15]]
grads:  [0.00434156]
Stock Position:  0.004341559025315356
Bond Position:  [-0.36191324]


portfolio before change:  [0.10549294]
curr_Stock_Price:  107.66381408734085
curr_Factors:  [107.66381409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05411487]
Stock Position:  -0.05411487186174051
Bond Position:  [5.93170644]


portfolio before change:  [0.06940646]
curr_Stock_Price:  108.33751473372925
curr_Factors:  [108.33751473]
mat_Sqrt:  [[0.15]]
grads:  [-0.18890826]
Stock Position:  -0.18890826120798065
Bond Position:  [20.53525799]


portfolio before change:  [0.25638929]
curr_Stock_Price:  107.35450139255707
curr_Factors:  [107.35450139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03709606]
Stock Position:  -0.037096061920454476
Bond Position:  [4.23881852]


portfolio before change:  [0.26770138]
curr_Stock_Price:  107.0567028118986
curr_Factors:  [107.05670281]
mat_Sqrt:  [[0.15]]
grads:  [0.11770366]
Stock Position:  0.11770366012178231
Bond Position:  [-12.33326438]


portfolio before change:  [0.22946639]
curr_Stock_Price:  106.738410761498
curr_Factors:  [106.73841076]
mat_Sqrt:  [[0.15]]
grads:  [0.2369559]
Stock Position:  0.23695590180062426
Bond Position:  [-25.06282999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.07030947]
Stock Price:  106.07334842704972
PL:  [-6.00303896]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.04258490e-03]
 [ 4.54234539e-02]
 [ 2.69702475e-03]
 [-5.95235997e-03]
 [-1.16982632e-02]
 [-1.16013047e-03]
 [-8.29217284e-03]
 [ 7.69502789e-03]
 [-1.09648811e-02]
 [-5.71610317e-03]
 [ 1.42103975e-02]
 [-3.10062074e-03]
 [-9.26627821e-04]
 [ 8.98539665e-03]
 [-2.37153338e-03]
 [ 1.27828384e-02]
 [ 4.26445835e-02]
 [-1.47521593e-02]
 [ 1.78467558e-02]
 [ 2.05279241e-03]
 [-4.01474017e-03]
 [ 4.39753466e-03]
 [ 1.39173029e-02]
 [ 1.92275282e-02]
 [-4.19307748e-03]
 [ 4.65623652e-03]
 [ 9.54389571e-03]
 [ 8.30122606e-03]
 [ 1.60614691e-02]
 [ 3.35980756e-02]
 [-6.70171849e-03]
 [ 2.24324007e-02]
 [ 1.24957239e-02]
 [-1.98262813e-02]
 [-1.07014836e-02]
 [ 2.61658727e-03]
 [ 7.69322804e-03]
 [-1.32658952e-03]
 [ 2.70900180e-03]
 [-9.46117273e-03]
 [ 7.09822700e-03]
 [ 2.96449420e-02]
 [-2.67820277e-03]
 [ 4.32059582e-04]
 [-2.33859805e-02]
 [ 1.95091854e-02]
 [ 1.01099245e-02]
 [ 5.26652436e-03]
 [-6.15075294e-03]
 [-7.99450344e-04]
 [-4.36142947e-03]
 [-1.50473151e-04]
 [-1.97089477e-04]
 [ 7.28211967e-03]
 [-1.61214915e-02]
 [-5.45029878e-03]
 [-6.05060731e-03]
 [ 1.43893887e-02]
 [ 5.37162186e-03]
 [-2.15723369e-03]
 [-5.16085445e-03]
 [-4.35066079e-03]
 [ 2.29592046e-03]
 [-6.67194813e-03]
 [ 1.71220901e-02]
 [ 9.85415912e-03]
 [ 2.05768148e-02]
 [-7.61401471e-03]
 [ 1.10479231e-02]
 [ 3.23903205e-02]
 [ 3.28749781e-03]
 [-1.48594268e-02]
 [-5.77626396e-03]
 [ 3.95762256e-03]
 [ 1.28923136e-02]
 [ 2.45923521e-02]
 [ 7.85910742e-03]
 [-3.69754619e-02]
 [-2.72122458e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.2257214]
curr_Stock_Price:  100.32681893792879
curr_Factors:  [100.32681894]
mat_Sqrt:  [[0.15]]
grads:  [-0.0202839]
Stock Position:  -0.020283899341676244
Bond Position:  [11.26074049]


portfolio before change:  [9.20929674]
curr_Stock_Price:  101.17125609364604
curr_Factors:  [101.17125609]
mat_Sqrt:  [[0.15]]
grads:  [0.30282303]
Stock Position:  0.30282302592276833
Bond Position:  [-21.42768917]


portfolio before change:  [8.82509849]
curr_Stock_Price:  99.90695666995597
curr_Factors:  [99.90695667]
mat_Sqrt:  [[0.15]]
grads:  [0.01798016]
Stock Position:  0.01798016498424408
Bond Position:  [7.02875492]


portfolio before change:  [8.83003998]
curr_Stock_Price:  100.15735384106993
curr_Factors:  [100.15735384]
mat_Sqrt:  [[0.15]]
grads:  [-0.0396824]
Stock Position:  -0.03968239978168728
Bond Position:  [12.80452414]


portfolio before change:  [8.80468007]
curr_Stock_Price:  100.81659377745154
curr_Factors:  [100.81659378]
mat_Sqrt:  [[0.15]]
grads:  [-0.07798842]
Stock Position:  -0.07798842128823998
Bond Position:  [16.66720705]


portfolio before change:  [8.79164769]
curr_Stock_Price:  100.99705782456842
curr_Factors:  [100.99705782]
mat_Sqrt:  [[0.15]]
grads:  [-0.0077342]
Stock Position:  -0.007734203124721275
Bond Position:  [9.57277945]


portfolio before change:  [8.79398591]
curr_Stock_Price:  100.7720958453488
curr_Factors:  [100.77209585]
mat_Sqrt:  [[0.15]]
grads:  [-0.05528115]
Stock Position:  -0.05528115224604227
Bond Position:  [14.36478349]


portfolio before change:  [8.88497743]
curr_Stock_Price:  99.14235969416538
curr_Factors:  [99.14235969]
mat_Sqrt:  [[0.15]]
grads:  [0.05130019]
Stock Position:  0.05130018593475253
Bond Position:  [3.79895595]


portfolio before change:  [8.90952166]
curr_Stock_Price:  99.61617451712877
curr_Factors:  [99.61617452]
mat_Sqrt:  [[0.15]]
grads:  [-0.07309921]
Stock Position:  -0.07309920710814376
Bond Position:  [16.19138503]


portfolio before change:  [8.90660251]
curr_Stock_Price:  99.66995271892186
curr_Factors:  [99.66995272]
mat_Sqrt:  [[0.15]]
grads:  [-0.03810735]
Stock Position:  -0.03810735445030001
Bond Position:  [12.70476073]


portfolio before change:  [8.91124628]
curr_Stock_Price:  99.5689302829758
curr_Factors:  [99.56893028]
mat_Sqrt:  [[0.15]]
grads:  [0.09473598]
Stock Position:  0.09473598316060058
Bond Position:  [-0.52151422]


portfolio before change:  [8.94705833]
curr_Stock_Price:  99.94729385516999
curr_Factors:  [99.94729386]
mat_Sqrt:  [[0.15]]
grads:  [-0.0206708]
Stock Position:  -0.020670804931119155
Bond Position:  [11.01304935]


portfolio before change:  [8.95862409]
curr_Stock_Price:  99.42107236666364
curr_Factors:  [99.42107237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00617752]
Stock Position:  -0.006177518803841936
Bond Position:  [9.57279963]


portfolio before change:  [8.95665601]
curr_Stock_Price:  99.83651378686818
curr_Factors:  [99.83651379]
mat_Sqrt:  [[0.15]]
grads:  [0.05990264]
Stock Position:  0.05990264432988307
Bond Position:  [2.97618484]


portfolio before change:  [8.99262499]
curr_Stock_Price:  100.43386570788569
curr_Factors:  [100.43386571]
mat_Sqrt:  [[0.15]]
grads:  [-0.01581022]
Stock Position:  -0.015810222504682517
Bond Position:  [10.58050675]


portfolio before change:  [9.00231629]
curr_Stock_Price:  99.86271640327816
curr_Factors:  [99.8627164]
mat_Sqrt:  [[0.15]]
grads:  [0.08521892]
Stock Position:  0.0852189229199534
Bond Position:  [0.49212316]


portfolio before change:  [9.05697565]
curr_Stock_Price:  100.50375478710117
curr_Factors:  [100.50375479]
mat_Sqrt:  [[0.15]]
grads:  [0.28429722]
Stock Position:  0.28429722303428606
Bond Position:  [-19.51596274]


portfolio before change:  [9.08611138]
curr_Stock_Price:  100.6105286669988
curr_Factors:  [100.61052867]
mat_Sqrt:  [[0.15]]
grads:  [-0.09834773]
Stock Position:  -0.0983477288816386
Bond Position:  [18.98092838]


portfolio before change:  [9.06447385]
curr_Stock_Price:  100.84260188142493
curr_Factors:  [100.84260188]
mat_Sqrt:  [[0.15]]
grads:  [0.11897837]
Stock Position:  0.118978371792752
Bond Position:  [-2.93361473]


portfolio before change:  [9.05515746]
curr_Stock_Price:  100.76583971468523
curr_Factors:  [100.76583971]
mat_Sqrt:  [[0.15]]
grads:  [0.01368528]
Stock Position:  0.013685282764604177
Bond Position:  [7.67614845]


portfolio before change:  [9.05639886]
curr_Stock_Price:  100.82149284173978
curr_Factors:  [100.82149284]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676493]
Stock Position:  -0.02676493447053808
Bond Position:  [11.75487951]


portfolio before change:  [9.05406036]
curr_Stock_Price:  100.93631487656707
curr_Factors:  [100.93631488]
mat_Sqrt:  [[0.15]]
grads:  [0.0293169]
Stock Position:  0.029316897718131726
Bond Position:  [6.09492074]


portfolio before change:  [9.06446786]
curr_Stock_Price:  101.27832080751803
curr_Factors:  [101.27832081]
mat_Sqrt:  [[0.15]]
grads:  [0.09278202]
Stock Position:  0.09278201910549798
Bond Position:  [-0.33233924]


portfolio before change:  [9.0186667]
curr_Stock_Price:  100.78490210363162
curr_Factors:  [100.7849021]
mat_Sqrt:  [[0.15]]
grads:  [0.12818352]
Stock Position:  0.12818352131535504
Bond Position:  [-3.90029695]


portfolio before change:  [8.95662544]
curr_Stock_Price:  100.30280045498273
curr_Factors:  [100.30280045]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795385]
Stock Position:  -0.027953849886338263
Bond Position:  [11.76047486]


portfolio before change:  [9.00519915]
curr_Stock_Price:  98.59145620954207
curr_Factors:  [98.59145621]
mat_Sqrt:  [[0.15]]
grads:  [0.03104158]
Stock Position:  0.03104157678486586
Bond Position:  [5.94476489]


portfolio before change:  [9.00487802]
curr_Stock_Price:  98.56914133863413
curr_Factors:  [98.56914134]
mat_Sqrt:  [[0.15]]
grads:  [0.06362597]
Stock Position:  0.06362597142004169
Bond Position:  [2.73332065]


portfolio before change:  [9.01963496]
curr_Stock_Price:  98.79838897793637
curr_Factors:  [98.79838898]
mat_Sqrt:  [[0.15]]
grads:  [0.05534151]
Stock Position:  0.055341507044568305
Bond Position:  [3.55198322]


portfolio before change:  [8.95338537]
curr_Stock_Price:  97.59727237899212
curr_Factors:  [97.59727238]
mat_Sqrt:  [[0.15]]
grads:  [0.10707646]
Stock Position:  0.10707646056329503
Bond Position:  [-1.49698512]


portfolio before change:  [8.91309284]
curr_Stock_Price:  97.22184942364491
curr_Factors:  [97.22184942]
mat_Sqrt:  [[0.15]]
grads:  [0.22398717]
Stock Position:  0.223987170518401
Bond Position:  [-12.86335413]


portfolio before change:  [8.71302996]
curr_Stock_Price:  96.33224982190761
curr_Factors:  [96.33224982]
mat_Sqrt:  [[0.15]]
grads:  [-0.04467812]
Stock Position:  -0.04467812327459231
Bond Position:  [13.01697409]


portfolio before change:  [8.71566143]
curr_Stock_Price:  96.29156136802632
curr_Factors:  [96.29156137]
mat_Sqrt:  [[0.15]]
grads:  [0.14954934]
Stock Position:  0.14954933784245628
Bond Position:  [-5.68467781]


portfolio before change:  [8.74844117]
curr_Stock_Price:  96.51312735459993
curr_Factors:  [96.51312735]
mat_Sqrt:  [[0.15]]
grads:  [0.08330483]
Stock Position:  0.08330482618901555
Bond Position:  [0.70843187]


portfolio before change:  [8.75674037]
curr_Stock_Price:  96.61222035288715
curr_Factors:  [96.61222035]
mat_Sqrt:  [[0.15]]
grads:  [-0.13217521]
Stock Position:  -0.13217520874179922
Bond Position:  [21.52648077]


portfolio before change:  [8.72456547]
curr_Stock_Price:  96.86582581497416
curr_Factors:  [96.86582581]
mat_Sqrt:  [[0.15]]
grads:  [-0.07134322]
Stock Position:  -0.07134322399936777
Bond Position:  [15.63528578]


portfolio before change:  [8.71236273]
curr_Stock_Price:  97.05056609568545
curr_Factors:  [97.0505661]
mat_Sqrt:  [[0.15]]
grads:  [0.01744392]
Stock Position:  0.017443915113526064
Bond Position:  [7.0194209]


portfolio before change:  [8.71103908]
curr_Stock_Price:  96.94953489929588
curr_Factors:  [96.9495349]
mat_Sqrt:  [[0.15]]
grads:  [0.05128819]
Stock Position:  0.05128818692349376
Bond Position:  [3.73867321]


portfolio before change:  [8.71160499]
curr_Stock_Price:  96.95601258948939
curr_Factors:  [96.95601259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00884393]
Stock Position:  -0.008843930108399957
Bond Position:  [9.56907719]


portfolio before change:  [8.71471652]
curr_Stock_Price:  96.67181181162596
curr_Factors:  [96.67181181]
mat_Sqrt:  [[0.15]]
grads:  [0.01806001]
Stock Position:  0.018060011994966686
Bond Position:  [6.96882244]


portfolio before change:  [8.71907159]
curr_Stock_Price:  96.88883847448365
curr_Factors:  [96.88883847]
mat_Sqrt:  [[0.15]]
grads:  [-0.06307448]
Stock Position:  -0.06307448489634034
Bond Position:  [14.83028517]


portfolio before change:  [8.68496291]
curr_Stock_Price:  97.44430251612472
curr_Factors:  [97.44430252]
mat_Sqrt:  [[0.15]]
grads:  [0.04732151]
Stock Position:  0.047321513324889965
Bond Position:  [4.07375105]


portfolio before change:  [8.69346974]
curr_Stock_Price:  97.61868871941876
curr_Factors:  [97.61868872]
mat_Sqrt:  [[0.15]]
grads:  [0.19763295]
Stock Position:  0.19763294692386257
Bond Position:  [-10.59919938]


portfolio before change:  [8.845015]
curr_Stock_Price:  98.38884230615834
curr_Factors:  [98.38884231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785469]
Stock Position:  -0.017854685149830848
Bond Position:  [10.6017168]


portfolio before change:  [8.84176242]
curr_Stock_Price:  98.60812389572393
curr_Factors:  [98.6081239]
mat_Sqrt:  [[0.15]]
grads:  [0.0028804]
Stock Position:  0.002880397211477183
Bond Position:  [8.55773185]


portfolio before change:  [8.8377844]
curr_Stock_Price:  97.0413637191711
curr_Factors:  [97.04136372]
mat_Sqrt:  [[0.15]]
grads:  [-0.15590654]
Stock Position:  -0.15590653696651532
Bond Position:  [23.96716736]


portfolio before change:  [8.88353872]
curr_Stock_Price:  96.7574992657455
curr_Factors:  [96.75749927]
mat_Sqrt:  [[0.15]]
grads:  [0.13006124]
Stock Position:  0.13006123611447662
Bond Position:  [-3.70086124]


portfolio before change:  [8.99986007]
curr_Stock_Price:  97.6536360977201
curr_Factors:  [97.6536361]
mat_Sqrt:  [[0.15]]
grads:  [0.0673995]
Stock Position:  0.06739949695092151
Bond Position:  [2.41805413]


portfolio before change:  [9.02731774]
curr_Stock_Price:  98.05878051261372
curr_Factors:  [98.05878051]
mat_Sqrt:  [[0.15]]
grads:  [0.03511016]
Stock Position:  0.0351101623678855
Bond Position:  [5.58445803]


portfolio before change:  [9.01345954]
curr_Stock_Price:  97.65413302717018
curr_Factors:  [97.65413303]
mat_Sqrt:  [[0.15]]
grads:  [-0.04100502]
Stock Position:  -0.041005019610332226
Bond Position:  [13.01776918]


portfolio before change:  [9.00240448]
curr_Stock_Price:  97.94357793024557
curr_Factors:  [97.94357793]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532967]
Stock Position:  -0.005329668956776497
Bond Position:  [9.52441133]


portfolio before change:  [9.00775014]
curr_Stock_Price:  97.05227194382908
curr_Factors:  [97.05227194]
mat_Sqrt:  [[0.15]]
grads:  [-0.0290762]
Stock Position:  -0.029076196436666736
Bond Position:  [11.82966106]


portfolio before change:  [9.01570293]
curr_Stock_Price:  96.80418544550038
curr_Factors:  [96.80418545]
mat_Sqrt:  [[0.15]]
grads:  [-0.00100315]
Stock Position:  -0.0010031543413266514
Bond Position:  [9.11281247]


portfolio before change:  [9.01720909]
curr_Stock_Price:  95.87053969665146
curr_Factors:  [95.8705397]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131393]
Stock Position:  -0.0013139298435837867
Bond Position:  [9.14317625]


portfolio before change:  [9.01789494]
curr_Stock_Price:  95.78348154458548
curr_Factors:  [95.78348154]
mat_Sqrt:  [[0.15]]
grads:  [0.04854746]
Stock Position:  0.048547464461765465
Bond Position:  [4.36784978]


portfolio before change:  [8.96772319]
curr_Stock_Price:  94.74440036154965
curr_Factors:  [94.74440036]
mat_Sqrt:  [[0.15]]
grads:  [-0.10747661]
Stock Position:  -0.10747660997404758
Bond Position:  [19.15053015]


portfolio before change:  [9.01637122]
curr_Stock_Price:  94.30289879742965
curr_Factors:  [94.3028988]
mat_Sqrt:  [[0.15]]
grads:  [-0.03633533]
Stock Position:  -0.036335325179365406
Bond Position:  [12.44289772]


portfolio before change:  [9.03461766]
curr_Stock_Price:  93.82213427268326
curr_Factors:  [93.82213427]
mat_Sqrt:  [[0.15]]
grads:  [-0.04033738]
Stock Position:  -0.04033738204759241
Bond Position:  [12.81915694]


portfolio before change:  [9.03807499]
curr_Stock_Price:  93.75628699435312
curr_Factors:  [93.75628699]
mat_Sqrt:  [[0.15]]
grads:  [0.09592926]
Stock Position:  0.09592925784031836
Bond Position:  [0.04410396]


portfolio before change:  [8.9975699]
curr_Stock_Price:  93.33401903059907
curr_Factors:  [93.33401903]
mat_Sqrt:  [[0.15]]
grads:  [0.03581081]
Stock Position:  0.03581081239576771
Bond Position:  [5.65520285]


portfolio before change:  [9.00269439]
curr_Stock_Price:  93.46724797464996
curr_Factors:  [93.46724797]
mat_Sqrt:  [[0.15]]
grads:  [-0.01438156]
Stock Position:  -0.014381557962437301
Bond Position:  [10.34689904]


portfolio before change:  [9.00160765]
curr_Stock_Price:  93.58778064933387
curr_Factors:  [93.58778065]
mat_Sqrt:  [[0.15]]
grads:  [-0.0344057]
Stock Position:  -0.034405696360634216
Bond Position:  [12.22156041]


portfolio before change:  [9.01184867]
curr_Stock_Price:  93.31232762862922
curr_Factors:  [93.31232763]
mat_Sqrt:  [[0.15]]
grads:  [-0.02900441]
Stock Position:  -0.02900440529584535
Bond Position:  [11.71831724]


portfolio before change:  [9.01281456]
curr_Stock_Price:  93.30427811444254
curr_Factors:  [93.30427811]
mat_Sqrt:  [[0.15]]
grads:  [0.01530614]
Stock Position:  0.015306136400651527
Bond Position:  [7.58468655]


portfolio before change:  [9.02153117]
curr_Stock_Price:  93.84279102435079
curr_Factors:  [93.84279102]
mat_Sqrt:  [[0.15]]
grads:  [-0.04447965]
Stock Position:  -0.04447965419120195
Bond Position:  [13.19562606]


portfolio before change:  [9.03289251]
curr_Stock_Price:  93.60590559602947
curr_Factors:  [93.6059056]
mat_Sqrt:  [[0.15]]
grads:  [0.11414727]
Stock Position:  0.11414726750657896
Bond Position:  [-1.65196584]


portfolio before change:  [8.98521036]
curr_Stock_Price:  93.18908533993161
curr_Factors:  [93.18908534]
mat_Sqrt:  [[0.15]]
grads:  [0.06569439]
Stock Position:  0.06569439412109584
Bond Position:  [2.86320986]


portfolio before change:  [8.96528417]
curr_Stock_Price:  92.88304479060885
curr_Factors:  [92.88304479]
mat_Sqrt:  [[0.15]]
grads:  [0.13717877]
Stock Position:  0.137178765262468
Bond Position:  [-3.77629723]


portfolio before change:  [8.80914393]
curr_Stock_Price:  91.74654077950447
curr_Factors:  [91.74654078]
mat_Sqrt:  [[0.15]]
grads:  [-0.0507601]
Stock Position:  -0.050760098096602674
Bond Position:  [13.46620734]


portfolio before change:  [8.81170022]
curr_Stock_Price:  91.71276166020483
curr_Factors:  [91.71276166]
mat_Sqrt:  [[0.15]]
grads:  [0.07365282]
Stock Position:  0.07365282086131403
Bond Position:  [2.05679662]


portfolio before change:  [8.82132481]
curr_Stock_Price:  91.84169134730593
curr_Factors:  [91.84169135]
mat_Sqrt:  [[0.15]]
grads:  [0.21593547]
Stock Position:  0.2159354701595824
Bond Position:  [-11.01055399]


portfolio before change:  [8.6995353]
curr_Stock_Price:  91.2808694788697
curr_Factors:  [91.28086948]
mat_Sqrt:  [[0.15]]
grads:  [0.02191665]
Stock Position:  0.021916652089094758
Bond Position:  [6.69896424]


portfolio before change:  [8.69559195]
curr_Stock_Price:  91.08184066943427
curr_Factors:  [91.08184067]
mat_Sqrt:  [[0.15]]
grads:  [-0.09906285]
Stock Position:  -0.09906284519563206
Bond Position:  [17.71841823]


portfolio before change:  [8.70395915]
curr_Stock_Price:  91.00855618769654
curr_Factors:  [91.00855619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03850843]
Stock Position:  -0.03850842639616011
Bond Position:  [12.20855544]


portfolio before change:  [8.67736889]
curr_Stock_Price:  91.71887668272892
curr_Factors:  [91.71887668]
mat_Sqrt:  [[0.15]]
grads:  [0.02638415]
Stock Position:  0.026384150409263202
Bond Position:  [6.25744425]


portfolio before change:  [8.68628457]
curr_Stock_Price:  92.04197139035195
curr_Factors:  [92.04197139]
mat_Sqrt:  [[0.15]]
grads:  [0.08594876]
Stock Position:  0.08594875735079655
Bond Position:  [0.7753915]


portfolio before change:  [8.64807484]
curr_Stock_Price:  91.59684345299645
curr_Factors:  [91.59684345]
mat_Sqrt:  [[0.15]]
grads:  [0.16394901]
Stock Position:  0.16394901400551587
Bond Position:  [-6.36913733]


portfolio before change:  [8.63529794]
curr_Stock_Price:  91.52133935969407
curr_Factors:  [91.52133936]
mat_Sqrt:  [[0.15]]
grads:  [0.05239405]
Stock Position:  0.052394049442475894
Bond Position:  [3.84012436]


portfolio before change:  [8.68464844]
curr_Stock_Price:  92.45866888118398
curr_Factors:  [92.45866888]
mat_Sqrt:  [[0.15]]
grads:  [-0.24650308]
Stock Position:  -0.2465030791412809
Bond Position:  [31.47599501]


portfolio before change:  [8.54742756]
curr_Stock_Price:  93.02331981599035
curr_Factors:  [93.02331982]
mat_Sqrt:  [[0.15]]
grads:  [-0.18141497]
Stock Position:  -0.1814149719950756
Bond Position:  [25.42325052]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.74427539]
Stock Price:  91.94700937054121
PL:  [8.74427539]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39458040e-02]
 [-9.38202167e-04]
 [ 1.70284769e-02]
 [-1.25994886e-02]
 [ 6.02538610e-03]
 [-5.42978944e-03]
 [ 2.49374977e-03]
 [-4.68781233e-03]
 [-1.11231292e-02]
 [-1.20539922e-02]
 [ 1.35491666e-02]
 [-2.25912655e-03]
 [-6.22556479e-04]
 [ 1.53815171e-03]
 [-3.71192555e-03]
 [ 8.17277950e-03]
 [ 2.33382589e-02]
 [-1.51353181e-02]
 [ 2.43691164e-02]
 [-2.88419240e-03]
 [-9.66235839e-03]
 [ 5.66552863e-03]
 [ 1.32214100e-02]
 [ 1.90500922e-02]
 [ 5.54202990e-03]
 [ 4.42937102e-03]
 [ 3.97161421e-04]
 [ 1.43820532e-02]
 [-5.18290015e-03]
 [ 4.54511126e-02]
 [-6.63991852e-03]
 [ 2.43624690e-02]
 [ 1.28205553e-02]
 [-1.95541555e-02]
 [-1.05351791e-02]
 [-8.37947923e-03]
 [ 7.43585916e-03]
 [-5.20493632e-04]
 [ 5.87047026e-04]
 [-2.47109091e-03]
 [ 6.97768346e-03]
 [ 3.37888607e-02]
 [-3.34547340e-03]
 [ 1.44165960e-02]
 [-3.80144199e-02]
 [ 1.88253860e-02]
 [ 9.92923701e-03]
 [ 5.31485905e-03]
 [-6.59204614e-03]
 [-5.24239366e-04]
 [-5.45559316e-03]
 [ 1.34300671e-03]
 [ 4.97927866e-04]
 [ 6.42444370e-03]
 [-9.79489728e-03]
 [-4.87170391e-03]
 [-1.36094413e-03]
 [ 1.28043052e-02]
 [ 6.93386700e-03]
 [-3.23386927e-03]
 [-5.13651326e-03]
 [ 9.30537482e-05]
 [-5.30356523e-03]
 [-1.76702890e-03]
 [ 1.91994648e-02]
 [ 4.28102107e-03]
 [ 1.58461797e-02]
 [-2.69476812e-03]
 [ 5.58186252e-03]
 [ 2.63669355e-02]
 [ 3.25739873e-03]
 [-1.53382984e-02]
 [-5.85407800e-03]
 [ 2.36084891e-03]
 [ 1.03378449e-02]
 [ 1.52800375e-03]
 [-1.47099311e-03]
 [-9.73060208e-04]
 [-2.38440883e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.8677866]
curr_Stock_Price:  99.82297453821059
curr_Factors:  [99.82297454]
mat_Sqrt:  [[0.15]]
grads:  [-0.09297203]
Stock Position:  -0.0929720265483752
Bond Position:  [7.41295763]


portfolio before change:  [-1.84356921]
curr_Stock_Price:  99.56747757073032
curr_Factors:  [99.56747757]
mat_Sqrt:  [[0.15]]
grads:  [-0.00625468]
Stock Position:  -0.006254681110132241
Bond Position:  [-1.22080639]


portfolio before change:  [-1.84923712]
curr_Stock_Price:  100.46146585271795
curr_Factors:  [100.46146585]
mat_Sqrt:  [[0.15]]
grads:  [0.11352318]
Stock Position:  0.11352317903661575
Bond Position:  [-13.2539421]


portfolio before change:  [-1.8437477]
curr_Stock_Price:  100.51711808723569
curr_Factors:  [100.51711809]
mat_Sqrt:  [[0.15]]
grads:  [-0.08399659]
Stock Position:  -0.08399659062972259
Bond Position:  [6.59934752]


portfolio before change:  [-1.83363522]
curr_Stock_Price:  100.40163713258652
curr_Factors:  [100.40163713]
mat_Sqrt:  [[0.15]]
grads:  [0.04016924]
Stock Position:  0.040169240647640755
Bond Position:  [-5.86669275]


portfolio before change:  [-1.84752269]
curr_Stock_Price:  100.06504166672059
curr_Factors:  [100.06504167]
mat_Sqrt:  [[0.15]]
grads:  [-0.0361986]
Stock Position:  -0.036198596274446056
Bond Position:  [1.77469136]


portfolio before change:  [-1.84628479]
curr_Stock_Price:  100.03390861653138
curr_Factors:  [100.03390862]
mat_Sqrt:  [[0.15]]
grads:  [0.016625]
Stock Position:  0.016624998494812852
Bond Position:  [-3.50934837]


portfolio before change:  [-1.84993169]
curr_Stock_Price:  99.82773987479092
curr_Factors:  [99.82773987]
mat_Sqrt:  [[0.15]]
grads:  [-0.03125208]
Stock Position:  -0.03125208221581243
Bond Position:  [1.26989304]


portfolio before change:  [-1.8427997]
curr_Stock_Price:  99.60207109618028
curr_Factors:  [99.6020711]
mat_Sqrt:  [[0.15]]
grads:  [-0.07415419]
Stock Position:  -0.07415419464596407
Bond Position:  [5.54311167]


portfolio before change:  [-1.80405196]
curr_Stock_Price:  99.08421394728224
curr_Factors:  [99.08421395]
mat_Sqrt:  [[0.15]]
grads:  [-0.08035995]
Stock Position:  -0.08035994770354131
Bond Position:  [6.15835029]


portfolio before change:  [-1.82705197]
curr_Stock_Price:  99.37521602552182
curr_Factors:  [99.37521603]
mat_Sqrt:  [[0.15]]
grads:  [0.09032778]
Stock Position:  0.09032777707945816
Bond Position:  [-10.80339433]


portfolio before change:  [-1.75701555]
curr_Stock_Price:  100.15804995409083
curr_Factors:  [100.15804995]
mat_Sqrt:  [[0.15]]
grads:  [-0.01506084]
Stock Position:  -0.015060843660028907
Bond Position:  [-0.24855082]


portfolio before change:  [-1.74206395]
curr_Stock_Price:  99.16427153587162
curr_Factors:  [99.16427154]
mat_Sqrt:  [[0.15]]
grads:  [-0.00415038]
Stock Position:  -0.004150376526775845
Bond Position:  [-1.33049488]


portfolio before change:  [-1.73989952]
curr_Stock_Price:  98.62273511507834
curr_Factors:  [98.62273512]
mat_Sqrt:  [[0.15]]
grads:  [0.01025434]
Stock Position:  0.01025434471961825
Bond Position:  [-2.75121105]


portfolio before change:  [-1.73964228]
curr_Stock_Price:  98.66459088070971
curr_Factors:  [98.66459088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02474617]
Stock Position:  -0.024746170329839914
Bond Position:  [0.70192849]


portfolio before change:  [-1.74043124]
curr_Stock_Price:  98.69824594385528
curr_Factors:  [98.69824594]
mat_Sqrt:  [[0.15]]
grads:  [0.0544852]
Stock Position:  0.054485196682928436
Bond Position:  [-7.11802458]


portfolio before change:  [-1.70367318]
curr_Stock_Price:  99.38105430759077
curr_Factors:  [99.38105431]
mat_Sqrt:  [[0.15]]
grads:  [0.15558839]
Stock Position:  0.1555883927645662
Bond Position:  [-17.16621169]


portfolio before change:  [-1.71175042]
curr_Stock_Price:  99.3360360445016
curr_Factors:  [99.33603604]
mat_Sqrt:  [[0.15]]
grads:  [-0.10090212]
Stock Position:  -0.10090212071383232
Bond Position:  [8.31146628]


portfolio before change:  [-1.66097661]
curr_Stock_Price:  98.83798571866198
curr_Factors:  [98.83798572]
mat_Sqrt:  [[0.15]]
grads:  [0.16246078]
Stock Position:  0.16246077599640768
Bond Position:  [-17.71827246]


portfolio before change:  [-1.9039488]
curr_Stock_Price:  97.34922780119086
curr_Factors:  [97.3492278]
mat_Sqrt:  [[0.15]]
grads:  [-0.01922795]
Stock Position:  -0.019227949307070683
Bond Position:  [-0.03212278]


portfolio before change:  [-1.91778281]
curr_Stock_Price:  98.06859746243832
curr_Factors:  [98.06859746]
mat_Sqrt:  [[0.15]]
grads:  [-0.06441572]
Stock Position:  -0.06441572258965889
Bond Position:  [4.39937676]


portfolio before change:  [-1.86374975]
curr_Stock_Price:  97.2340482515174
curr_Factors:  [97.23404825]
mat_Sqrt:  [[0.15]]
grads:  [0.03777019]
Stock Position:  0.03777019084065707
Bond Position:  [-5.53629831]


portfolio before change:  [-1.8776709]
curr_Stock_Price:  96.874634693011
curr_Factors:  [96.87463469]
mat_Sqrt:  [[0.15]]
grads:  [0.08814273]
Stock Position:  0.08814273325969396
Bond Position:  [-10.41646598]


portfolio before change:  [-1.84782113]
curr_Stock_Price:  97.22067364717678
curr_Factors:  [97.22067365]
mat_Sqrt:  [[0.15]]
grads:  [0.12700061]
Stock Position:  0.127000614879522
Bond Position:  [-14.19490646]


portfolio before change:  [-1.8880396]
curr_Stock_Price:  96.91098020548796
curr_Factors:  [96.91098021]
mat_Sqrt:  [[0.15]]
grads:  [0.03694687]
Stock Position:  0.036946865978726214
Bond Position:  [-5.46859659]


portfolio before change:  [-1.89324672]
curr_Stock_Price:  96.77929584884622
curr_Factors:  [96.77929585]
mat_Sqrt:  [[0.15]]
grads:  [0.02952914]
Stock Position:  0.02952914010168658
Bond Position:  [-4.7510561]


portfolio before change:  [-1.89571866]
curr_Stock_Price:  96.70563993064926
curr_Factors:  [96.70563993]
mat_Sqrt:  [[0.15]]
grads:  [0.00264774]
Stock Position:  0.0026477428073326077
Bond Position:  [-2.15177033]


portfolio before change:  [-1.89661685]
curr_Stock_Price:  96.41720733696545
curr_Factors:  [96.41720734]
mat_Sqrt:  [[0.15]]
grads:  [0.09588035]
Stock Position:  0.095880354348273
Bond Position:  [-11.14113285]


portfolio before change:  [-1.89037366]
curr_Stock_Price:  96.48958427846082
curr_Factors:  [96.48958428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03455267]
Stock Position:  -0.03455266766488656
Bond Position:  [1.44359887]


portfolio before change:  [-1.89595034]
curr_Stock_Price:  96.65359193060398
curr_Factors:  [96.65359193]
mat_Sqrt:  [[0.15]]
grads:  [0.30300742]
Stock Position:  0.30300741756034305
Bond Position:  [-31.18270563]


portfolio before change:  [-2.0423504]
curr_Stock_Price:  96.17686735732396
curr_Factors:  [96.17686736]
mat_Sqrt:  [[0.15]]
grads:  [-0.04426612]
Stock Position:  -0.04426612347877578
Bond Position:  [2.21502669]


portfolio before change:  [-2.02983851]
curr_Stock_Price:  95.89734337245429
curr_Factors:  [95.89734337]
mat_Sqrt:  [[0.15]]
grads:  [0.16241646]
Stock Position:  0.16241646004986215
Bond Position:  [-17.60514555]


portfolio before change:  [-1.99570029]
curr_Stock_Price:  96.11430769786799
curr_Factors:  [96.1143077]
mat_Sqrt:  [[0.15]]
grads:  [0.08547037]
Stock Position:  0.0854703684687686
Bond Position:  [-10.21062559]


portfolio before change:  [-1.99912471]
curr_Stock_Price:  96.08170887329153
curr_Factors:  [96.08170887]
mat_Sqrt:  [[0.15]]
grads:  [-0.13036104]
Stock Position:  -0.13036103674520388
Bond Position:  [10.52618647]


portfolio before change:  [-2.10671142]
curr_Stock_Price:  96.9120537271814
curr_Factors:  [96.91205373]
mat_Sqrt:  [[0.15]]
grads:  [-0.07023453]
Stock Position:  -0.07023452745858305
Bond Position:  [4.69986088]


portfolio before change:  [-2.0886075]
curr_Stock_Price:  96.65847237479149
curr_Factors:  [96.65847237]
mat_Sqrt:  [[0.15]]
grads:  [-0.05586319]
Stock Position:  -0.055863194837179914
Bond Position:  [3.31104357]


portfolio before change:  [-2.11154846]
curr_Stock_Price:  97.0728401802309
curr_Factors:  [97.07284018]
mat_Sqrt:  [[0.15]]
grads:  [0.04957239]
Stock Position:  0.04957239438841162
Bond Position:  [-6.92368158]


portfolio before change:  [-2.09557028]
curr_Stock_Price:  97.40388983253466
curr_Factors:  [97.40388983]
mat_Sqrt:  [[0.15]]
grads:  [-0.00346996]
Stock Position:  -0.0034699575490939293
Bond Position:  [-1.75758292]


portfolio before change:  [-2.0934044]
curr_Stock_Price:  96.74805005348188
curr_Factors:  [96.74805005]
mat_Sqrt:  [[0.15]]
grads:  [0.00391365]
Stock Position:  0.003913646842603527
Bond Position:  [-2.4720421]


portfolio before change:  [-2.09538958]
curr_Stock_Price:  96.28028472463915
curr_Factors:  [96.28028472]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647394]
Stock Position:  -0.01647393942982498
Bond Position:  [-0.509274]


portfolio before change:  [-2.09890732]
curr_Stock_Price:  96.49188632066056
curr_Factors:  [96.49188632]
mat_Sqrt:  [[0.15]]
grads:  [0.04651789]
Stock Position:  0.046517889731843
Bond Position:  [-6.58750625]


portfolio before change:  [-2.07691087]
curr_Stock_Price:  96.97359729039788
curr_Factors:  [96.97359729]
mat_Sqrt:  [[0.15]]
grads:  [0.22525907]
Stock Position:  0.225259071577368
Bond Position:  [-23.92109337]


portfolio before change:  [-2.08493271]
curr_Stock_Price:  96.94462301858289
curr_Factors:  [96.94462302]
mat_Sqrt:  [[0.15]]
grads:  [-0.02230316]
Stock Position:  -0.022303155988603593
Bond Position:  [0.07723834]


portfolio before change:  [-2.06578926]
curr_Stock_Price:  96.08651054427855
curr_Factors:  [96.08651054]
mat_Sqrt:  [[0.15]]
grads:  [0.09611064]
Stock Position:  0.09611064019630187
Bond Position:  [-11.3007253]


portfolio before change:  [-2.05197956]
curr_Stock_Price:  96.23754505325196
curr_Factors:  [96.23754505]
mat_Sqrt:  [[0.15]]
grads:  [-0.25342947]
Stock Position:  -0.25342946614749534
Bond Position:  [22.33745011]


portfolio before change:  [-2.25066812]
curr_Stock_Price:  97.02705348171204
curr_Factors:  [97.02705348]
mat_Sqrt:  [[0.15]]
grads:  [0.12550257]
Stock Position:  0.1255025730936772
Bond Position:  [-14.42781299]


portfolio before change:  [-2.22671986]
curr_Stock_Price:  97.2250575890146
curr_Factors:  [97.22505759]
mat_Sqrt:  [[0.15]]
grads:  [0.06619491]
Stock Position:  0.06619491341247422
Bond Position:  [-8.66252413]


portfolio before change:  [-2.24831281]
curr_Stock_Price:  96.90703434187762
curr_Factors:  [96.90703434]
mat_Sqrt:  [[0.15]]
grads:  [0.03543239]
Stock Position:  0.03543239367916561
Bond Position:  [-5.681961]


portfolio before change:  [-2.22584856]
curr_Stock_Price:  97.55106023488791
curr_Factors:  [97.55106023]
mat_Sqrt:  [[0.15]]
grads:  [-0.04394697]
Stock Position:  -0.043946974263724486
Bond Position:  [2.06122537]


portfolio before change:  [-2.22673056]
curr_Stock_Price:  97.57406135545219
curr_Factors:  [97.57406136]
mat_Sqrt:  [[0.15]]
grads:  [-0.00349493]
Stock Position:  -0.0034949291096848557
Bond Position:  [-1.88571613]


portfolio before change:  [-2.22771602]
curr_Stock_Price:  97.82230514777649
curr_Factors:  [97.82230515]
mat_Sqrt:  [[0.15]]
grads:  [-0.03637062]
Stock Position:  -0.036370621058298
Bond Position:  [1.33014197]


portfolio before change:  [-2.21565697]
curr_Stock_Price:  97.49303094402096
curr_Factors:  [97.49303094]
mat_Sqrt:  [[0.15]]
grads:  [0.00895338]
Stock Position:  0.008953378069783541
Bond Position:  [-3.08854894]


portfolio before change:  [-2.2212571]
curr_Stock_Price:  96.88911565358175
curr_Factors:  [96.88911565]
mat_Sqrt:  [[0.15]]
grads:  [0.00331952]
Stock Position:  0.003319519105732569
Bond Position:  [-2.54288237]


portfolio before change:  [-2.2202069]
curr_Stock_Price:  97.25336340758427
curr_Factors:  [97.25336341]
mat_Sqrt:  [[0.15]]
grads:  [0.04282962]
Stock Position:  0.04282962466769097
Bond Position:  [-6.38553196]


portfolio before change:  [-2.23087448]
curr_Stock_Price:  97.01361179880954
curr_Factors:  [97.0136118]
mat_Sqrt:  [[0.15]]
grads:  [-0.06529932]
Stock Position:  -0.06529931519716829
Bond Position:  [4.10404793]


portfolio before change:  [-2.20250111]
curr_Stock_Price:  96.58302741126104
curr_Factors:  [96.58302741]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247803]
Stock Position:  -0.032478026050026934
Bond Position:  [0.93432497]


portfolio before change:  [-2.20406739]
curr_Stock_Price:  96.6330512957861
curr_Factors:  [96.6330513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00907296]
Stock Position:  -0.009072960835678823
Bond Position:  [-1.3273195]


portfolio before change:  [-2.2020715]
curr_Stock_Price:  96.40392531581989
curr_Factors:  [96.40392532]
mat_Sqrt:  [[0.15]]
grads:  [0.08536203]
Stock Position:  0.0853620349900205
Bond Position:  [-10.43130674]


portfolio before change:  [-2.25625097]
curr_Stock_Price:  95.7768608898282
curr_Factors:  [95.77686089]
mat_Sqrt:  [[0.15]]
grads:  [0.04622578]
Stock Position:  0.0462257799769636
Bond Position:  [-6.68361107]


portfolio before change:  [-2.20924414]
curr_Stock_Price:  96.8027942821618
curr_Factors:  [96.80279428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02155913]
Stock Position:  -0.02155912844208844
Bond Position:  [-0.12226026]


portfolio before change:  [-2.20190502]
curr_Stock_Price:  96.46202164130645
curr_Factors:  [96.46202164]
mat_Sqrt:  [[0.15]]
grads:  [-0.03424342]
Stock Position:  -0.03424342175934822
Bond Position:  [1.10128468]


portfolio before change:  [-2.25491575]
curr_Stock_Price:  98.01208781332191
curr_Factors:  [98.01208781]
mat_Sqrt:  [[0.15]]
grads:  [0.00062036]
Stock Position:  0.0006203583213316873
Bond Position:  [-2.31571837]


portfolio before change:  [-2.25521956]
curr_Stock_Price:  97.75567460668348
curr_Factors:  [97.75567461]
mat_Sqrt:  [[0.15]]
grads:  [-0.0353571]
Stock Position:  -0.035357101547898166
Bond Position:  [1.20113776]


portfolio before change:  [-2.23322592]
curr_Stock_Price:  97.1357549752948
curr_Factors:  [97.13575498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01178019]
Stock Position:  -0.011780192646606324
Bond Position:  [-1.08894802]


portfolio before change:  [-2.23494918]
curr_Stock_Price:  97.27626155236256
curr_Factors:  [97.27626155]
mat_Sqrt:  [[0.15]]
grads:  [0.12799643]
Stock Position:  0.12799643212499562
Bond Position:  [-14.68596359]


portfolio before change:  [-2.24369972]
curr_Stock_Price:  97.21506731601814
curr_Factors:  [97.21506732]
mat_Sqrt:  [[0.15]]
grads:  [0.02854014]
Stock Position:  0.028540140443233376
Bond Position:  [-5.0182314]


portfolio before change:  [-2.25699614]
curr_Stock_Price:  96.76017251732469
curr_Factors:  [96.76017252]
mat_Sqrt:  [[0.15]]
grads:  [0.1056412]
Stock Position:  0.10564119801037947
Bond Position:  [-12.47885668]


portfolio before change:  [-2.32477642]
curr_Stock_Price:  96.12594708447573
curr_Factors:  [96.12594708]
mat_Sqrt:  [[0.15]]
grads:  [-0.01796512]
Stock Position:  -0.017965120784904726
Bond Position:  [-0.59786217]


portfolio before change:  [-2.32638774]
curr_Stock_Price:  96.21355839459162
curr_Factors:  [96.21355839]
mat_Sqrt:  [[0.15]]
grads:  [0.03721242]
Stock Position:  0.03721241677639065
Bond Position:  [-5.90672677]


portfolio before change:  [-2.34832756]
curr_Stock_Price:  95.63389591144492
curr_Factors:  [95.63389591]
mat_Sqrt:  [[0.15]]
grads:  [0.17577957]
Stock Position:  0.175779569670102
Bond Position:  [-19.15881263]


portfolio before change:  [-2.26379362]
curr_Stock_Price:  96.12161698593758
curr_Factors:  [96.12161699]
mat_Sqrt:  [[0.15]]
grads:  [0.02171599]
Stock Position:  0.021715991542825584
Bond Position:  [-4.35116985]


portfolio before change:  [-2.26921499]
curr_Stock_Price:  95.88449188272627
curr_Factors:  [95.88449188]
mat_Sqrt:  [[0.15]]
grads:  [-0.10225532]
Stock Position:  -0.1022553227912417
Bond Position:  [7.53548468]


portfolio before change:  [-2.27776358]
curr_Stock_Price:  95.97269832301838
curr_Factors:  [95.97269832]
mat_Sqrt:  [[0.15]]
grads:  [-0.03902719]
Stock Position:  -0.03902718669452586
Bond Position:  [1.46778083]


portfolio before change:  [-2.26405311]
curr_Stock_Price:  95.62374327019252
curr_Factors:  [95.62374327]
mat_Sqrt:  [[0.15]]
grads:  [0.01573899]
Stock Position:  0.015738992701300754
Bond Position:  [-3.76907451]


portfolio before change:  [-2.25486487]
curr_Stock_Price:  96.22249896040286
curr_Factors:  [96.22249896]
mat_Sqrt:  [[0.15]]
grads:  [0.06891897]
Stock Position:  0.06891896591421787
Bond Position:  [-8.88642]


portfolio before change:  [-2.19139531]
curr_Stock_Price:  97.15148829701893
curr_Factors:  [97.1514883]
mat_Sqrt:  [[0.15]]
grads:  [0.01018669]
Stock Position:  0.010186691660133581
Bond Position:  [-3.18104756]


portfolio before change:  [-2.18063651]
curr_Stock_Price:  98.22716822740071
curr_Factors:  [98.22716823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00980662]
Stock Position:  -0.00980662071484967
Bond Position:  [-1.21735993]


portfolio before change:  [-2.18198046]
curr_Stock_Price:  98.35645450258859
curr_Factors:  [98.3564545]
mat_Sqrt:  [[0.15]]
grads:  [-0.00648707]
Stock Position:  -0.0064870680510164085
Bond Position:  [-1.54393544]


portfolio before change:  [-2.18400186]
curr_Stock_Price:  98.65318307895748
curr_Factors:  [98.65318308]
mat_Sqrt:  [[0.15]]
grads:  [-0.15896059]
Stock Position:  -0.1589605888940102
Bond Position:  [13.49796622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.16438665]
Stock Price:  98.53509371047944
PL:  [-2.16438665]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.35509979e-02]
 [-5.52774830e-03]
 [ 6.67341637e-03]
 [-8.76566464e-03]
 [ 1.48211086e-02]
 [-1.35555298e-02]
 [-3.85249252e-05]
 [-1.45661393e-02]
 [-1.46516386e-02]
 [-1.27300594e-02]
 [ 1.19445534e-02]
 [-6.99845010e-03]
 [ 3.47085073e-03]
 [-5.88908475e-03]
 [-2.23095691e-03]
 [ 6.70384751e-03]
 [-2.27199663e-02]
 [-1.01693397e-02]
 [ 2.28822527e-02]
 [-4.60823053e-03]
 [-2.50668392e-02]
 [ 6.12568910e-03]
 [ 1.47829224e-02]
 [ 9.68998716e-03]
 [ 1.31733559e-02]
 [ 4.43226841e-03]
 [ 1.88878340e-04]
 [ 1.67726070e-02]
 [ 1.16440587e-04]
 [ 2.71034105e-02]
 [-7.07326664e-03]
 [ 1.80908031e-02]
 [ 1.25197573e-02]
 [-1.94160287e-02]
 [-1.58721703e-02]
 [-4.81209454e-02]
 [ 1.54562081e-02]
 [-7.72743396e-03]
 [ 6.51200923e-02]
 [ 1.94862261e-02]
 [ 6.30253360e-03]
 [ 3.50937373e-02]
 [-3.37623545e-03]
 [ 2.65308190e-02]
 [-7.37721313e-02]
 [ 2.52662862e-02]
 [ 9.04517169e-03]
 [ 5.40198345e-03]
 [-1.29720490e-02]
 [ 2.04472995e-04]
 [-1.33645813e-03]
 [-4.08251003e-03]
 [-1.23732539e-03]
 [ 3.67533721e-03]
 [-1.79639136e-02]
 [-5.84554723e-03]
 [-6.96474436e-03]
 [ 1.48053567e-02]
 [ 5.15039152e-03]
 [-2.04099677e-03]
 [-5.17730979e-03]
 [-5.11830270e-03]
 [ 4.75516786e-03]
 [-9.35107086e-03]
 [ 1.56449675e-02]
 [ 1.20030349e-02]
 [ 2.07111792e-02]
 [-6.99577588e-03]
 [ 1.00616890e-02]
 [ 3.02424043e-02]
 [ 3.14748372e-03]
 [-1.50973136e-02]
 [-6.01599872e-03]
 [ 3.34069749e-03]
 [ 1.23155380e-02]
 [ 2.08469286e-02]
 [ 7.25935472e-03]
 [-4.05568118e-02]
 [-2.04267724e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.73278649]
curr_Stock_Price:  99.60201621331001
curr_Factors:  [99.60201621]
mat_Sqrt:  [[0.15]]
grads:  [-0.09033999]
Stock Position:  -0.09033998602283169
Bond Position:  [2.26525826]


portfolio before change:  [-6.71635353]
curr_Stock_Price:  99.42168214194203
curr_Factors:  [99.42168214]
mat_Sqrt:  [[0.15]]
grads:  [-0.03685166]
Stock Position:  -0.03685165532502803
Bond Position:  [-3.05249997]


portfolio before change:  [-6.74539404]
curr_Stock_Price:  100.20454316903252
curr_Factors:  [100.20454317]
mat_Sqrt:  [[0.15]]
grads:  [0.04448944]
Stock Position:  0.044489442471238205
Bond Position:  [-11.2034383]


portfolio before change:  [-6.76878298]
curr_Stock_Price:  99.69456374514095
curr_Factors:  [99.69456375]
mat_Sqrt:  [[0.15]]
grads:  [-0.05843776]
Stock Position:  -0.05843776425516232
Bond Position:  [-0.94285556]


portfolio before change:  [-6.76691505]
curr_Stock_Price:  99.6615909233664
curr_Factors:  [99.66159092]
mat_Sqrt:  [[0.15]]
grads:  [0.09880739]
Stock Position:  0.09880739043851855
Bond Position:  [-16.61421677]


portfolio before change:  [-6.81211436]
curr_Stock_Price:  99.21465180981629
curr_Factors:  [99.21465181]
mat_Sqrt:  [[0.15]]
grads:  [-0.0903702]
Stock Position:  -0.09037019881043419
Bond Position:  [2.15393345]


portfolio before change:  [-6.90643415]
curr_Stock_Price:  100.25984608400944
curr_Factors:  [100.25984608]
mat_Sqrt:  [[0.15]]
grads:  [-0.00025683]
Stock Position:  -0.00025683283452966843
Bond Position:  [-6.88068413]


portfolio before change:  [-6.90690703]
curr_Stock_Price:  100.42660011587705
curr_Factors:  [100.42660012]
mat_Sqrt:  [[0.15]]
grads:  [-0.0971076]
Stock Position:  -0.09710759511254058
Bond Position:  [2.84527859]


portfolio before change:  [-6.79087349]
curr_Stock_Price:  99.233534797534
curr_Factors:  [99.2335348]
mat_Sqrt:  [[0.15]]
grads:  [-0.09767759]
Stock Position:  -0.09767759053732025
Bond Position:  [2.90201909]


portfolio before change:  [-6.72976778]
curr_Stock_Price:  98.60980599101124
curr_Factors:  [98.60980599]
mat_Sqrt:  [[0.15]]
grads:  [-0.08486706]
Stock Position:  -0.08486706268031129
Bond Position:  [1.6389568]


portfolio before change:  [-6.74834779]
curr_Stock_Price:  98.8299437504199
curr_Factors:  [98.82994375]
mat_Sqrt:  [[0.15]]
grads:  [0.07963036]
Stock Position:  0.0796303561828693
Bond Position:  [-14.61821141]


portfolio before change:  [-6.78665248]
curr_Stock_Price:  98.36038632169928
curr_Factors:  [98.36038632]
mat_Sqrt:  [[0.15]]
grads:  [-0.04665633]
Stock Position:  -0.04665633398445272
Bond Position:  [-2.19751745]


portfolio before change:  [-6.77143183]
curr_Stock_Price:  98.03121332245509
curr_Factors:  [98.03121332]
mat_Sqrt:  [[0.15]]
grads:  [0.023139]
Stock Position:  0.023139004875765222
Bond Position:  [-9.03977655]


portfolio before change:  [-6.78620852]
curr_Stock_Price:  97.41702587893744
curr_Factors:  [97.41702588]
mat_Sqrt:  [[0.15]]
grads:  [-0.03926057]
Stock Position:  -0.03926056500956769
Bond Position:  [-2.96156104]


portfolio before change:  [-6.81447394]
curr_Stock_Price:  98.13225560467156
curr_Factors:  [98.1322556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487305]
Stock Position:  -0.01487304609655638
Bond Position:  [-5.35494838]


portfolio before change:  [-6.81931147]
curr_Stock_Price:  98.43500694844242
curr_Factors:  [98.43500695]
mat_Sqrt:  [[0.15]]
grads:  [0.04469232]
Stock Position:  0.04469231675045938
Bond Position:  [-11.21859998]


portfolio before change:  [-6.85205652]
curr_Stock_Price:  97.71801869814456
curr_Factors:  [97.7180187]
mat_Sqrt:  [[0.15]]
grads:  [-0.15146644]
Stock Position:  -0.15146644204933765
Bond Position:  [7.94894409]


portfolio before change:  [-6.67558694]
curr_Stock_Price:  96.55622498031634
curr_Factors:  [96.55622498]
mat_Sqrt:  [[0.15]]
grads:  [-0.0677956]
Stock Position:  -0.06779559801783941
Bond Position:  [-0.12949992]


portfolio before change:  [-6.63939341]
curr_Stock_Price:  96.02224308083439
curr_Factors:  [96.02224308]
mat_Sqrt:  [[0.15]]
grads:  [0.15254835]
Stock Position:  0.15254835157041205
Bond Position:  [-21.2874283]


portfolio before change:  [-6.59953667]
curr_Stock_Price:  96.29223773908633
curr_Factors:  [96.29223774]
mat_Sqrt:  [[0.15]]
grads:  [-0.03072154]
Stock Position:  -0.03072153689973598
Bond Position:  [-3.64129114]


portfolio before change:  [-6.5950257]
curr_Stock_Price:  96.13799550731727
curr_Factors:  [96.13799551]
mat_Sqrt:  [[0.15]]
grads:  [-0.16711226]
Stock Position:  -0.16711226104353913
Bond Position:  [9.4708121]


portfolio before change:  [-6.54995968]
curr_Stock_Price:  95.87186258017022
curr_Factors:  [95.87186258]
mat_Sqrt:  [[0.15]]
grads:  [0.04083793]
Stock Position:  0.040837927308816184
Bond Position:  [-10.46516784]


portfolio before change:  [-6.54652719]
curr_Stock_Price:  95.97193100257594
curr_Factors:  [95.971931]
mat_Sqrt:  [[0.15]]
grads:  [0.09855282]
Stock Position:  0.09855281582670766
Bond Position:  [-16.00483123]


portfolio before change:  [-6.56234511]
curr_Stock_Price:  95.82157921982251
curr_Factors:  [95.82157922]
mat_Sqrt:  [[0.15]]
grads:  [0.06459991]
Stock Position:  0.06459991437379255
Bond Position:  [-12.75241093]


portfolio before change:  [-6.56781424]
curr_Stock_Price:  95.74925600082531
curr_Factors:  [95.749256]
mat_Sqrt:  [[0.15]]
grads:  [0.08782237]
Stock Position:  0.08782237244163651
Bond Position:  [-14.97674106]


portfolio before change:  [-6.59494986]
curr_Stock_Price:  95.45093169030771
curr_Factors:  [95.45093169]
mat_Sqrt:  [[0.15]]
grads:  [0.02954846]
Stock Position:  0.02954845609636783
Bond Position:  [-9.41537753]


portfolio before change:  [-6.58431407]
curr_Stock_Price:  95.83079165599456
curr_Factors:  [95.83079166]
mat_Sqrt:  [[0.15]]
grads:  [0.00125919]
Stock Position:  0.0012591889359347616
Bond Position:  [-6.70498314]


portfolio before change:  [-6.58454062]
curr_Stock_Price:  95.98368409723163
curr_Factors:  [95.9836841]
mat_Sqrt:  [[0.15]]
grads:  [0.11181738]
Stock Position:  0.11181738005457095
Bond Position:  [-17.31718471]


portfolio before change:  [-6.50118792]
curr_Stock_Price:  96.73879981294235
curr_Factors:  [96.73879981]
mat_Sqrt:  [[0.15]]
grads:  [0.00077627]
Stock Position:  0.000776270577520453
Bond Position:  [-6.5762834]


portfolio before change:  [-6.50098227]
curr_Stock_Price:  97.53321621385783
curr_Factors:  [97.53321621]
mat_Sqrt:  [[0.15]]
grads:  [0.1806894]
Stock Position:  0.18068940324811794
Bond Position:  [-24.1242009]


portfolio before change:  [-6.55069622]
curr_Stock_Price:  97.26642611744288
curr_Factors:  [97.26642612]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715511]
Stock Position:  -0.04715511090668102
Bond Position:  [-1.96408711]


portfolio before change:  [-6.55196296]
curr_Stock_Price:  97.29068615369751
curr_Factors:  [97.29068615]
mat_Sqrt:  [[0.15]]
grads:  [0.12060535]
Stock Position:  0.12060535401785906
Bond Position:  [-18.28574061]


portfolio before change:  [-6.65044238]
curr_Stock_Price:  96.48361978625816
curr_Factors:  [96.48361979]
mat_Sqrt:  [[0.15]]
grads:  [0.08346505]
Stock Position:  0.08346504869996305
Bond Position:  [-14.70345241]


portfolio before change:  [-6.7073823]
curr_Stock_Price:  95.81242953502252
curr_Factors:  [95.81242954]
mat_Sqrt:  [[0.15]]
grads:  [-0.12944019]
Stock Position:  -0.12944019138456836
Bond Position:  [5.69459691]


portfolio before change:  [-6.65733333]
curr_Stock_Price:  95.4285220752381
curr_Factors:  [95.42852208]
mat_Sqrt:  [[0.15]]
grads:  [-0.10581447]
Stock Position:  -0.1058144689294528
Bond Position:  [3.44038506]


portfolio before change:  [-6.63632114]
curr_Stock_Price:  95.23197843994033
curr_Factors:  [95.23197844]
mat_Sqrt:  [[0.15]]
grads:  [-0.3208063]
Stock Position:  -0.3208063029083241
Bond Position:  [23.91469779]


portfolio before change:  [-6.51821039]
curr_Stock_Price:  94.86846926759237
curr_Factors:  [94.86846927]
mat_Sqrt:  [[0.15]]
grads:  [0.10304139]
Stock Position:  0.103041387480844
Bond Position:  [-16.29358909]


portfolio before change:  [-6.57144674]
curr_Stock_Price:  94.36170228063548
curr_Factors:  [94.36170228]
mat_Sqrt:  [[0.15]]
grads:  [-0.05151623]
Stock Position:  -0.051516226430730096
Bond Position:  [-1.71028792]


portfolio before change:  [-6.57143319]
curr_Stock_Price:  94.35936417671165
curr_Factors:  [94.35936418]
mat_Sqrt:  [[0.15]]
grads:  [0.43413395]
Stock Position:  0.4341339488811088
Bond Position:  [-47.53603657]


portfolio before change:  [-6.34131138]
curr_Stock_Price:  94.89627888622705
curr_Factors:  [94.89627889]
mat_Sqrt:  [[0.15]]
grads:  [0.12990817]
Stock Position:  0.12990817424946613
Bond Position:  [-18.66911371]


portfolio before change:  [-6.44525082]
curr_Stock_Price:  94.10516170867537
curr_Factors:  [94.10516171]
mat_Sqrt:  [[0.15]]
grads:  [0.04201689]
Stock Position:  0.042016890648076226
Bond Position:  [-10.39925711]


portfolio before change:  [-6.43804595]
curr_Stock_Price:  94.29210677249723
curr_Factors:  [94.29210677]
mat_Sqrt:  [[0.15]]
grads:  [0.23395825]
Stock Position:  0.2339582483930033
Bond Position:  [-28.49846208]


portfolio before change:  [-6.42630508]
curr_Stock_Price:  94.34990375511053
curr_Factors:  [94.34990376]
mat_Sqrt:  [[0.15]]
grads:  [-0.02250824]
Stock Position:  -0.022508236312016282
Bond Position:  [-4.30265515]


portfolio before change:  [-6.43241393]
curr_Stock_Price:  94.60936140536361
curr_Factors:  [94.60936141]
mat_Sqrt:  [[0.15]]
grads:  [0.17687213]
Stock Position:  0.1768721269421971
Bond Position:  [-23.16617291]


portfolio before change:  [-6.49299414]
curr_Stock_Price:  94.2750392289441
curr_Factors:  [94.27503923]
mat_Sqrt:  [[0.15]]
grads:  [-0.49181421]
Stock Position:  -0.4918142089041494
Bond Position:  [39.8728097]


portfolio before change:  [-6.59526184]
curr_Stock_Price:  94.48804614797483
curr_Factors:  [94.48804615]
mat_Sqrt:  [[0.15]]
grads:  [0.16844191]
Stock Position:  0.1684419083229325
Bond Position:  [-22.51100865]


portfolio before change:  [-6.49206084]
curr_Stock_Price:  95.1090791234384
curr_Factors:  [95.10907912]
mat_Sqrt:  [[0.15]]
grads:  [0.06030114]
Stock Position:  0.060301144597503104
Bond Position:  [-12.22724718]


portfolio before change:  [-6.50959443]
curr_Stock_Price:  94.83098547257354
curr_Factors:  [94.83098547]
mat_Sqrt:  [[0.15]]
grads:  [0.03601322]
Stock Position:  0.03601322300287831
Bond Position:  [-9.92476386]


portfolio before change:  [-6.51905107]
curr_Stock_Price:  94.58562221170232
curr_Factors:  [94.58562221]
mat_Sqrt:  [[0.15]]
grads:  [-0.08648033]
Stock Position:  -0.08648032668650668
Bond Position:  [1.66074443]


portfolio before change:  [-6.52692451]
curr_Stock_Price:  94.67786557537845
curr_Factors:  [94.67786558]
mat_Sqrt:  [[0.15]]
grads:  [0.00136315]
Stock Position:  0.0013631533019849975
Bond Position:  [-6.65598496]


portfolio before change:  [-6.52677605]
curr_Stock_Price:  95.09195897142672
curr_Factors:  [95.09195897]
mat_Sqrt:  [[0.15]]
grads:  [-0.00890972]
Stock Position:  -0.00890972086420784
Bond Position:  [-5.67953324]


portfolio before change:  [-6.52281379]
curr_Stock_Price:  94.60740444756964
curr_Factors:  [94.60740445]
mat_Sqrt:  [[0.15]]
grads:  [-0.02721673]
Stock Position:  -0.027216733540515303
Bond Position:  [-3.94790927]


portfolio before change:  [-6.51517506]
curr_Stock_Price:  94.31767549687252
curr_Factors:  [94.3176755]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824884]
Stock Position:  -0.00824883593891254
Bond Position:  [-5.73716403]


portfolio before change:  [-6.51580032]
curr_Stock_Price:  94.35000385438909
curr_Factors:  [94.35000385]
mat_Sqrt:  [[0.15]]
grads:  [0.02450225]
Stock Position:  0.024502248096143084
Bond Position:  [-8.82758752]


portfolio before change:  [-6.51772411]
curr_Stock_Price:  94.29400676635242
curr_Factors:  [94.29400677]
mat_Sqrt:  [[0.15]]
grads:  [-0.11975942]
Stock Position:  -0.11975942405243972
Bond Position:  [4.77487183]


portfolio before change:  [-6.33195373]
curr_Stock_Price:  92.74530234491071
curr_Factors:  [92.74530234]
mat_Sqrt:  [[0.15]]
grads:  [-0.03897031]
Stock Position:  -0.038970314891663395
Bond Position:  [-2.71764009]


portfolio before change:  [-6.35780965]
curr_Stock_Price:  93.40442122710712
curr_Factors:  [93.40442123]
mat_Sqrt:  [[0.15]]
grads:  [-0.04643163]
Stock Position:  -0.04643162907607674
Bond Position:  [-2.02089021]


portfolio before change:  [-6.34201247]
curr_Stock_Price:  93.06147631149115
curr_Factors:  [93.06147631]
mat_Sqrt:  [[0.15]]
grads:  [0.09870238]
Stock Position:  0.09870237804523459
Bond Position:  [-15.52740149]


portfolio before change:  [-6.34258251]
curr_Stock_Price:  93.06553352768523
curr_Factors:  [93.06553353]
mat_Sqrt:  [[0.15]]
grads:  [0.03433594]
Stock Position:  0.03433594347581823
Bond Position:  [-9.53807541]


portfolio before change:  [-6.35213989]
curr_Stock_Price:  92.80454654661784
curr_Factors:  [92.80454655]
mat_Sqrt:  [[0.15]]
grads:  [-0.01360665]
Stock Position:  -0.013606645107448067
Bond Position:  [-5.08938136]


portfolio before change:  [-6.35232446]
curr_Stock_Price:  92.79473288811846
curr_Factors:  [92.79473289]
mat_Sqrt:  [[0.15]]
grads:  [-0.0345154]
Stock Position:  -0.03451539860868391
Bond Position:  [-3.14947726]


portfolio before change:  [-6.34039075]
curr_Stock_Price:  92.44327952099117
curr_Factors:  [92.44327952]
mat_Sqrt:  [[0.15]]
grads:  [-0.03412202]
Stock Position:  -0.034122017972501334
Bond Position:  [-3.18603951]


portfolio before change:  [-6.32081601]
curr_Stock_Price:  91.86377467998935
curr_Factors:  [91.86377468]
mat_Sqrt:  [[0.15]]
grads:  [0.03170112]
Stock Position:  0.03170111905218894
Bond Position:  [-9.23300047]


portfolio before change:  [-6.31567542]
curr_Stock_Price:  92.04413662176185
curr_Factors:  [92.04413662]
mat_Sqrt:  [[0.15]]
grads:  [-0.06234047]
Stock Position:  -0.06234047239196415
Bond Position:  [-0.57760046]


portfolio before change:  [-6.30088723]
curr_Stock_Price:  91.80634108107749
curr_Factors:  [91.80634108]
mat_Sqrt:  [[0.15]]
grads:  [0.10429978]
Stock Position:  0.10429978318881088
Bond Position:  [-15.8762687]


portfolio before change:  [-6.28497992]
curr_Stock_Price:  91.96837022724121
curr_Factors:  [91.96837023]
mat_Sqrt:  [[0.15]]
grads:  [0.08002023]
Stock Position:  0.08002023265582996
Bond Position:  [-13.64431031]


portfolio before change:  [-6.30252742]
curr_Stock_Price:  91.75973925831423
curr_Factors:  [91.75973926]
mat_Sqrt:  [[0.15]]
grads:  [0.13807453]
Stock Position:  0.1380745278774191
Bond Position:  [-18.97221009]


portfolio before change:  [-6.22954033]
curr_Stock_Price:  92.29693380839267
curr_Factors:  [92.29693381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663851]
Stock Position:  -0.04663850589027662
Bond Position:  [-1.92494924]


portfolio before change:  [-6.24449297]
curr_Stock_Price:  92.61496129877975
curr_Factors:  [92.6149613]
mat_Sqrt:  [[0.15]]
grads:  [0.06707793]
Stock Position:  0.06707792691863171
Bond Position:  [-12.45691258]


portfolio before change:  [-6.20299118]
curr_Stock_Price:  93.24527857719778
curr_Factors:  [93.24527858]
mat_Sqrt:  [[0.15]]
grads:  [0.20161603]
Stock Position:  0.2016160288156349
Bond Position:  [-25.00273395]


portfolio before change:  [-6.20252087]
curr_Stock_Price:  93.2553622409678
curr_Factors:  [93.25536224]
mat_Sqrt:  [[0.15]]
grads:  [0.02098322]
Stock Position:  0.020983224804212667
Bond Position:  [-8.1593191]


portfolio before change:  [-6.18909716]
curr_Stock_Price:  93.91940128950166
curr_Factors:  [93.91940129]
mat_Sqrt:  [[0.15]]
grads:  [-0.10064876]
Stock Position:  -0.10064875716900455
Bond Position:  [3.26377385]


portfolio before change:  [-6.12457796]
curr_Stock_Price:  93.28039476774077
curr_Factors:  [93.28039477]
mat_Sqrt:  [[0.15]]
grads:  [-0.04010666]
Stock Position:  -0.04010665810839152
Bond Position:  [-2.38341306]


portfolio before change:  [-6.1241259]
curr_Stock_Price:  93.26540896144047
curr_Factors:  [93.26540896]
mat_Sqrt:  [[0.15]]
grads:  [0.02227132]
Stock Position:  0.02227131661599884
Bond Position:  [-8.20126935]


portfolio before change:  [-6.12438201]
curr_Stock_Price:  93.27692505346755
curr_Factors:  [93.27692505]
mat_Sqrt:  [[0.15]]
grads:  [0.08210359]
Stock Position:  0.0821035865323176
Bond Position:  [-13.7827521]


portfolio before change:  [-6.20883092]
curr_Stock_Price:  92.25885185934213
curr_Factors:  [92.25885186]
mat_Sqrt:  [[0.15]]
grads:  [0.13897952]
Stock Position:  0.13897952418052695
Bond Position:  [-19.03092226]


portfolio before change:  [-6.27081753]
curr_Stock_Price:  91.82139791354732
curr_Factors:  [91.82139791]
mat_Sqrt:  [[0.15]]
grads:  [0.0483957]
Stock Position:  0.04839569813890995
Bond Position:  [-10.71457819]


portfolio before change:  [-6.26939246]
curr_Stock_Price:  91.86468182359836
curr_Factors:  [91.86468182]
mat_Sqrt:  [[0.15]]
grads:  [-0.27037875]
Stock Position:  -0.2703787454845318
Bond Position:  [18.56886496]


portfolio before change:  [-6.03574016]
curr_Stock_Price:  91.00480760384119
curr_Factors:  [91.0048076]
mat_Sqrt:  [[0.15]]
grads:  [-0.13617848]
Stock Position:  -0.13617848250476133
Bond Position:  [6.35715644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.01317256]
Stock Price:  90.84200465388838
PL:  [-6.01317256]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.52285281e-03]
 [ 1.40259208e-02]
 [ 1.84880187e-02]
 [-3.39070932e-02]
 [-4.32821869e-02]
 [-1.12058331e-03]
 [-5.58371716e-03]
 [-3.58844328e-02]
 [ 1.45184861e-02]
 [-4.54404251e-03]
 [-9.01128056e-03]
 [ 7.30190986e-03]
 [-3.35501146e-03]
 [ 5.35473274e-03]
 [ 4.27158343e-03]
 [ 1.22591957e-02]
 [ 9.52306424e-02]
 [-1.16174871e-02]
 [ 2.18757321e-02]
 [ 8.18515870e-04]
 [-4.92388624e-03]
 [ 5.36769584e-03]
 [ 7.88969802e-03]
 [ 4.37968122e-02]
 [-2.83849840e-04]
 [ 8.21935957e-03]
 [ 4.70248203e-03]
 [ 1.37801896e-02]
 [ 3.01024175e-02]
 [-5.95346071e-03]
 [-3.31875317e-03]
 [ 1.40137322e-02]
 [ 1.30848081e-02]
 [ 1.13252470e-03]
 [ 5.63433166e-03]
 [ 9.49107372e-03]
 [-2.77075757e-02]
 [ 2.88248112e-03]
 [-4.72737224e-02]
 [-9.47940881e-03]
 [ 5.87286999e-03]
 [ 8.26481384e-03]
 [-2.00960495e-03]
 [-5.09816789e-04]
 [-6.33970296e-03]
 [ 1.82963536e-02]
 [ 9.88318955e-03]
 [ 5.32441430e-03]
 [-8.04591958e-03]
 [-2.39497260e-04]
 [-3.43543989e-03]
 [-2.56956929e-03]
 [-1.08410481e-03]
 [ 4.70020617e-03]
 [-1.60104070e-02]
 [-5.30278427e-03]
 [-4.16085713e-03]
 [ 1.37329881e-02]
 [ 6.26097720e-03]
 [-2.23079927e-03]
 [-5.15011059e-03]
 [-3.59069266e-03]
 [ 2.93446234e-06]
 [-5.08681208e-03]
 [ 1.81060297e-02]
 [ 5.79991524e-03]
 [ 2.02772698e-02]
 [-3.68194830e-03]
 [ 7.44382115e-03]
 [ 2.88037177e-02]
 [ 3.06401518e-03]
 [-1.51428029e-02]
 [-5.82281220e-03]
 [ 2.63996830e-03]
 [ 1.17885797e-02]
 [ 1.16452488e-02]
 [ 2.84192465e-03]
 [-2.39383687e-02]
 [-3.01666833e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.45831159]
curr_Stock_Price:  101.10948787017986
curr_Factors:  [101.10948787]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015235]
Stock Position:  -0.050152352084005626
Bond Position:  [31.52919023]


portfolio before change:  [26.50705724]
curr_Stock_Price:  100.17682957322359
curr_Factors:  [100.17682957]
mat_Sqrt:  [[0.15]]
grads:  [0.09350614]
Stock Position:  0.09350613835509186
Bond Position:  [17.13990875]


portfolio before change:  [26.62039709]
curr_Stock_Price:  101.37748416399653
curr_Factors:  [101.37748416]
mat_Sqrt:  [[0.15]]
grads:  [0.12325346]
Stock Position:  0.12325345771352705
Bond Position:  [14.12527163]


portfolio before change:  [26.66227806]
curr_Stock_Price:  101.71011672063455
curr_Factors:  [101.71011672]
mat_Sqrt:  [[0.15]]
grads:  [-0.22604729]
Stock Position:  -0.22604728766870166
Bond Position:  [49.65357407]


portfolio before change:  [26.63906113]
curr_Stock_Price:  101.82655420372036
curr_Factors:  [101.8265542]
mat_Sqrt:  [[0.15]]
grads:  [-0.28854791]
Stock Position:  -0.28854791249054407
Bond Position:  [56.02090078]


portfolio before change:  [26.87531114]
curr_Stock_Price:  101.01993392220338
curr_Factors:  [101.01993392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00747056]
Stock Position:  -0.007470555384206061
Bond Position:  [27.62998615]


portfolio before change:  [26.87503239]
curr_Stock_Price:  101.28841134989439
curr_Factors:  [101.28841135]
mat_Sqrt:  [[0.15]]
grads:  [-0.03722478]
Stock Position:  -0.03722478107053876
Bond Position:  [30.64547133]


portfolio before change:  [26.86966229]
curr_Stock_Price:  101.48412783223027
curr_Factors:  [101.48412783]
mat_Sqrt:  [[0.15]]
grads:  [-0.23922955]
Stock Position:  -0.23922955198918
Bond Position:  [51.14766473]


portfolio before change:  [26.87648072]
curr_Stock_Price:  101.46898922781328
curr_Factors:  [101.46898923]
mat_Sqrt:  [[0.15]]
grads:  [0.09678991]
Stock Position:  0.0967899075208375
Bond Position:  [17.05530664]


portfolio before change:  [26.88282517]
curr_Stock_Price:  101.52352440981953
curr_Factors:  [101.52352441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03029362]
Stock Position:  -0.0302936167292241
Bond Position:  [29.95833991]


portfolio before change:  [26.88651978]
curr_Stock_Price:  101.46337458374676
curr_Factors:  [101.46337458]
mat_Sqrt:  [[0.15]]
grads:  [-0.0600752]
Stock Position:  -0.060075203726246626
Bond Position:  [32.98195268]


portfolio before change:  [26.91319785]
curr_Stock_Price:  101.05361089316014
curr_Factors:  [101.05361089]
mat_Sqrt:  [[0.15]]
grads:  [0.0486794]
Stock Position:  0.04867939908308045
Bond Position:  [21.9939688]


portfolio before change:  [26.91407724]
curr_Stock_Price:  101.04343649088446
curr_Factors:  [101.04343649]
mat_Sqrt:  [[0.15]]
grads:  [-0.02236674]
Stock Position:  -0.022366743033641764
Bond Position:  [29.17408981]


portfolio before change:  [26.90818971]
curr_Stock_Price:  101.38818767376951
curr_Factors:  [101.38818767]
mat_Sqrt:  [[0.15]]
grads:  [0.03569822]
Stock Position:  0.03569821825508823
Bond Position:  [23.28881206]


portfolio before change:  [26.93366324]
curr_Stock_Price:  102.06099255159265
curr_Factors:  [102.06099255]
mat_Sqrt:  [[0.15]]
grads:  [0.02847722]
Stock Position:  0.028477222883761644
Bond Position:  [24.02724961]


portfolio before change:  [26.9319324]
curr_Stock_Price:  101.9474775516024
curr_Factors:  [101.94747755]
mat_Sqrt:  [[0.15]]
grads:  [0.08172797]
Stock Position:  0.08172797139983075
Bond Position:  [18.59997187]


portfolio before change:  [26.93778709]
curr_Stock_Price:  102.00488938875918
curr_Factors:  [102.00488939]
mat_Sqrt:  [[0.15]]
grads:  [0.63487095]
Stock Position:  0.6348709491921738
Bond Position:  [-37.82215386]


portfolio before change:  [27.19993247]
curr_Stock_Price:  102.42152419581033
curr_Factors:  [102.4215242]
mat_Sqrt:  [[0.15]]
grads:  [-0.07744991]
Stock Position:  -0.07744991368109001
Bond Position:  [35.13247067]


portfolio before change:  [27.20776619]
curr_Stock_Price:  102.34873031340474
curr_Factors:  [102.34873031]
mat_Sqrt:  [[0.15]]
grads:  [0.14583821]
Stock Position:  0.14583821433251581
Bond Position:  [12.28141013]


portfolio before change:  [27.23171055]
curr_Stock_Price:  102.50765124644923
curr_Factors:  [102.50765125]
mat_Sqrt:  [[0.15]]
grads:  [0.00545677]
Stock Position:  0.005456772468922783
Bond Position:  [26.67234962]


portfolio before change:  [27.23021941]
curr_Stock_Price:  101.92888105445053
curr_Factors:  [101.92888105]
mat_Sqrt:  [[0.15]]
grads:  [-0.03282591]
Stock Position:  -0.03282590823757764
Bond Position:  [30.5761275]


portfolio before change:  [27.21813723]
curr_Stock_Price:  102.3551677066083
curr_Factors:  [102.35516771]
mat_Sqrt:  [[0.15]]
grads:  [0.03578464]
Stock Position:  0.03578463892874482
Bond Position:  [23.55539451]


portfolio before change:  [27.22247121]
curr_Stock_Price:  102.43513853580438
curr_Factors:  [102.43513854]
mat_Sqrt:  [[0.15]]
grads:  [0.05259799]
Stock Position:  0.052597986781753585
Bond Position:  [21.83458915]


portfolio before change:  [27.27056863]
curr_Stock_Price:  103.32362720839198
curr_Factors:  [103.32362721]
mat_Sqrt:  [[0.15]]
grads:  [0.29197875]
Stock Position:  0.2919787480949212
Bond Position:  [-2.89773469]


portfolio before change:  [26.88396097]
curr_Stock_Price:  102.00015227221306
curr_Factors:  [102.00015227]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189233]
Stock Position:  -0.0018923322662538443
Bond Position:  [27.07697914]


portfolio before change:  [26.88538092]
curr_Stock_Price:  102.14410533325443
curr_Factors:  [102.14410533]
mat_Sqrt:  [[0.15]]
grads:  [0.05479573]
Stock Position:  0.05479573043944174
Bond Position:  [21.28832006]


portfolio before change:  [26.89038237]
curr_Stock_Price:  102.21109758974474
curr_Factors:  [102.21109759]
mat_Sqrt:  [[0.15]]
grads:  [0.03134988]
Stock Position:  0.03134988017603896
Bond Position:  [23.68607671]


portfolio before change:  [26.87725213]
curr_Stock_Price:  101.74504588149942
curr_Factors:  [101.74504588]
mat_Sqrt:  [[0.15]]
grads:  [0.09186793]
Stock Position:  0.0918679304243313
Bond Position:  [17.53014534]


portfolio before change:  [26.88075996]
curr_Stock_Price:  101.77130262751146
curr_Factors:  [101.77130263]
mat_Sqrt:  [[0.15]]
grads:  [0.20068278]
Stock Position:  0.2006827832574684
Bond Position:  [6.45701169]


portfolio before change:  [26.95524055]
curr_Stock_Price:  102.14042753381152
curr_Factors:  [102.14042753]
mat_Sqrt:  [[0.15]]
grads:  [-0.03968974]
Stock Position:  -0.03968973803991261
Bond Position:  [31.00916736]


portfolio before change:  [26.97412794]
curr_Stock_Price:  101.71338372459815
curr_Factors:  [101.71338372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02212502]
Stock Position:  -0.02212502112501912
Bond Position:  [29.2245387]


portfolio before change:  [26.95364799]
curr_Stock_Price:  102.72158768785995
curr_Factors:  [102.72158769]
mat_Sqrt:  [[0.15]]
grads:  [0.09342488]
Stock Position:  0.09342488113906101
Bond Position:  [17.35689587]


portfolio before change:  [26.87810197]
curr_Stock_Price:  101.90134731695923
curr_Factors:  [101.90134732]
mat_Sqrt:  [[0.15]]
grads:  [0.08723205]
Stock Position:  0.08723205414344912
Bond Position:  [17.98903813]


portfolio before change:  [26.92505876]
curr_Stock_Price:  102.42675547977242
curr_Factors:  [102.42675548]
mat_Sqrt:  [[0.15]]
grads:  [0.00755016]
Stock Position:  0.007550164686281682
Bond Position:  [26.15171988]


portfolio before change:  [26.91889943]
curr_Stock_Price:  101.39447874087588
curr_Factors:  [101.39447874]
mat_Sqrt:  [[0.15]]
grads:  [0.03756221]
Stock Position:  0.037562211038988116
Bond Position:  [23.11029862]


portfolio before change:  [26.90465824]
curr_Stock_Price:  100.97688810191637
curr_Factors:  [100.9768881]
mat_Sqrt:  [[0.15]]
grads:  [0.06327382]
Stock Position:  0.06327382482110579
Bond Position:  [20.51546431]


portfolio before change:  [26.91095525]
curr_Stock_Price:  101.05614282793022
curr_Factors:  [101.05614283]
mat_Sqrt:  [[0.15]]
grads:  [-0.18471717]
Stock Position:  -0.18471717104787036
Bond Position:  [45.57776007]


portfolio before change:  [26.99481207]
curr_Stock_Price:  100.61759064524361
curr_Factors:  [100.61759065]
mat_Sqrt:  [[0.15]]
grads:  [0.01921654]
Stock Position:  0.019216540778404328
Bond Position:  [25.06129003]


portfolio before change:  [27.00866279]
curr_Stock_Price:  101.25684942794894
curr_Factors:  [101.25684943]
mat_Sqrt:  [[0.15]]
grads:  [-0.31515815]
Stock Position:  -0.3151581495369673
Bond Position:  [58.92058408]


portfolio before change:  [26.84059964]
curr_Stock_Price:  101.80180059059921
curr_Factors:  [101.80180059]
mat_Sqrt:  [[0.15]]
grads:  [-0.06319606]
Stock Position:  -0.06319605872237086
Bond Position:  [33.27407221]


portfolio before change:  [26.88705691]
curr_Stock_Price:  101.09957992150886
curr_Factors:  [101.09957992]
mat_Sqrt:  [[0.15]]
grads:  [0.03915247]
Stock Position:  0.03915246657191336
Bond Position:  [22.92875899]


portfolio before change:  [26.89560622]
curr_Stock_Price:  101.2813363430544
curr_Factors:  [101.28133634]
mat_Sqrt:  [[0.15]]
grads:  [0.05509876]
Stock Position:  0.0550987589465433
Bond Position:  [21.31513028]


portfolio before change:  [26.84287366]
curr_Stock_Price:  100.30010194214461
curr_Factors:  [100.30010194]
mat_Sqrt:  [[0.15]]
grads:  [-0.01339737]
Stock Position:  -0.013397366326399561
Bond Position:  [28.18663086]


portfolio before change:  [26.86341389]
curr_Stock_Price:  98.8984449126288
curr_Factors:  [98.89844491]
mat_Sqrt:  [[0.15]]
grads:  [-0.00339878]
Stock Position:  -0.003398778596226089
Bond Position:  [27.19954781]


portfolio before change:  [26.86817511]
curr_Stock_Price:  97.99776834448849
curr_Factors:  [97.99776834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04226469]
Stock Position:  -0.04226468642882508
Bond Position:  [31.01002006]


portfolio before change:  [26.90232617]
curr_Stock_Price:  97.23559838971815
curr_Factors:  [97.23559839]
mat_Sqrt:  [[0.15]]
grads:  [0.12197569]
Stock Position:  0.12197569091565363
Bond Position:  [15.04194688]


portfolio before change:  [26.88854535]
curr_Stock_Price:  97.11491057882242
curr_Factors:  [97.11491058]
mat_Sqrt:  [[0.15]]
grads:  [0.06588793]
Stock Position:  0.06588793035188
Bond Position:  [20.48984488]


portfolio before change:  [26.86112759]
curr_Stock_Price:  96.67934661500756
curr_Factors:  [96.67934662]
mat_Sqrt:  [[0.15]]
grads:  [0.0354961]
Stock Position:  0.035496095314696094
Bond Position:  [23.42938829]


portfolio before change:  [26.8589234]
curr_Stock_Price:  96.57599499772884
curr_Factors:  [96.575995]
mat_Sqrt:  [[0.15]]
grads:  [-0.05363946]
Stock Position:  -0.053639463858200086
Bond Position:  [32.03920799]


portfolio before change:  [26.85663017]
curr_Stock_Price:  96.65608050298997
curr_Factors:  [96.6560805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00159665]
Stock Position:  -0.0015966483971496023
Bond Position:  [27.01095594]


portfolio before change:  [26.8589514]
curr_Stock_Price:  96.25962588751055
curr_Factors:  [96.25962589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02290293]
Stock Position:  -0.022902932613114158
Bond Position:  [29.06357913]


portfolio before change:  [26.87564505]
curr_Stock_Price:  95.61005333654994
curr_Factors:  [95.61005334]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713046]
Stock Position:  -0.017130461930566516
Bond Position:  [28.51348943]


portfolio before change:  [26.89564802]
curr_Stock_Price:  94.54640318121918
curr_Factors:  [94.54640318]
mat_Sqrt:  [[0.15]]
grads:  [-0.00722737]
Stock Position:  -0.00722736541201666
Bond Position:  [27.57896942]


portfolio before change:  [26.89584733]
curr_Stock_Price:  94.75732722485084
curr_Factors:  [94.75732722]
mat_Sqrt:  [[0.15]]
grads:  [0.03133471]
Stock Position:  0.03133470781317236
Bond Position:  [23.92665417]


portfolio before change:  [26.89784209]
curr_Stock_Price:  94.77326146646301
curr_Factors:  [94.77326147]
mat_Sqrt:  [[0.15]]
grads:  [-0.10673605]
Stock Position:  -0.10673604678824491
Bond Position:  [37.01356536]


portfolio before change:  [26.88831176]
curr_Stock_Price:  94.88422446664124
curr_Factors:  [94.88422447]
mat_Sqrt:  [[0.15]]
grads:  [-0.0353519]
Stock Position:  -0.035351895128924476
Bond Position:  [30.24264891]


portfolio before change:  [26.8972219]
curr_Stock_Price:  94.68565172538517
curr_Factors:  [94.68565173]
mat_Sqrt:  [[0.15]]
grads:  [-0.02773905]
Stock Position:  -0.02773904755479564
Bond Position:  [29.5237117]


portfolio before change:  [26.89443334]
curr_Stock_Price:  94.85270326032565
curr_Factors:  [94.85270326]
mat_Sqrt:  [[0.15]]
grads:  [0.09155325]
Stock Position:  0.09155325416742822
Bond Position:  [18.21035969]


portfolio before change:  [26.85716043]
curr_Stock_Price:  94.43315408064439
curr_Factors:  [94.43315408]
mat_Sqrt:  [[0.15]]
grads:  [0.04173985]
Stock Position:  0.041739847969320384
Bond Position:  [22.91553494]


portfolio before change:  [26.83578242]
curr_Stock_Price:  93.88666729999424
curr_Factors:  [93.8866673]
mat_Sqrt:  [[0.15]]
grads:  [-0.014872]
Stock Position:  -0.01487199515344395
Bond Position:  [28.23206449]


portfolio before change:  [26.83429146]
curr_Stock_Price:  94.10557015724575
curr_Factors:  [94.10557016]
mat_Sqrt:  [[0.15]]
grads:  [-0.03433407]
Stock Position:  -0.034334070569840204
Bond Position:  [30.06531875]


portfolio before change:  [26.83386617]
curr_Stock_Price:  94.17268825195367
curr_Factors:  [94.17268825]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393795]
Stock Position:  -0.023937951098749577
Bond Position:  [29.08816737]


portfolio before change:  [26.82432075]
curr_Stock_Price:  94.64739398313354
curr_Factors:  [94.64739398]
mat_Sqrt:  [[0.15]]
grads:  [1.95630822e-05]
Stock Position:  1.9563082239171713e-05
Bond Position:  [26.82246916]


portfolio before change:  [26.82600229]
curr_Stock_Price:  94.90698711290538
curr_Factors:  [94.90698711]
mat_Sqrt:  [[0.15]]
grads:  [-0.03391208]
Stock Position:  -0.03391208054265836
Bond Position:  [30.04449568]


portfolio before change:  [26.81819773]
curr_Stock_Price:  95.19250176669706
curr_Factors:  [95.19250177]
mat_Sqrt:  [[0.15]]
grads:  [0.12070686]
Stock Position:  0.12070686485988863
Bond Position:  [15.32780928]


portfolio before change:  [26.90770516]
curr_Stock_Price:  95.92609231240003
curr_Factors:  [95.92609231]
mat_Sqrt:  [[0.15]]
grads:  [0.0386661]
Stock Position:  0.03866610159623134
Bond Position:  [23.19861713]


portfolio before change:  [26.88832151]
curr_Stock_Price:  95.38728414046652
curr_Factors:  [95.38728414]
mat_Sqrt:  [[0.15]]
grads:  [0.1351818]
Stock Position:  0.1351817983429605
Bond Position:  [13.9936969]


portfolio before change:  [26.87024587]
curr_Stock_Price:  95.24710049440246
curr_Factors:  [95.24710049]
mat_Sqrt:  [[0.15]]
grads:  [-0.02454632]
Stock Position:  -0.024546321974024565
Bond Position:  [29.20821186]


portfolio before change:  [26.88096153]
curr_Stock_Price:  94.88492406060776
curr_Factors:  [94.88492406]
mat_Sqrt:  [[0.15]]
grads:  [0.04962547]
Stock Position:  0.049625474336403075
Bond Position:  [22.17225217]


portfolio before change:  [26.84803244]
curr_Stock_Price:  94.19344647425365
curr_Factors:  [94.19344647]
mat_Sqrt:  [[0.15]]
grads:  [0.19202478]
Stock Position:  0.1920247849306783
Bond Position:  [8.76055614]


portfolio before change:  [26.89447343]
curr_Stock_Price:  94.43244395486532
curr_Factors:  [94.43244395]
mat_Sqrt:  [[0.15]]
grads:  [0.02042677]
Stock Position:  0.020426767870372047
Bond Position:  [24.96552382]


portfolio before change:  [26.89342999]
curr_Stock_Price:  94.30497202879666
curr_Factors:  [94.30497203]
mat_Sqrt:  [[0.15]]
grads:  [-0.10095202]
Stock Position:  -0.10095201931677604
Bond Position:  [36.41370734]


portfolio before change:  [26.75650163]
curr_Stock_Price:  95.68388733413408
curr_Factors:  [95.68388733]
mat_Sqrt:  [[0.15]]
grads:  [-0.03881875]
Stock Position:  -0.03881874799968987
Bond Position:  [30.47083034]


portfolio before change:  [26.78409879]
curr_Stock_Price:  95.02202474375169
curr_Factors:  [95.02202474]
mat_Sqrt:  [[0.15]]
grads:  [0.01759979]
Stock Position:  0.017599788675249965
Bond Position:  [25.11173124]


portfolio before change:  [26.77481257]
curr_Stock_Price:  94.40521305581662
curr_Factors:  [94.40521306]
mat_Sqrt:  [[0.15]]
grads:  [0.07859053]
Stock Position:  0.07859053156430582
Bond Position:  [19.35545669]


portfolio before change:  [26.76723732]
curr_Stock_Price:  94.29343109877061
curr_Factors:  [94.2934311]
mat_Sqrt:  [[0.15]]
grads:  [0.07763499]
Stock Position:  0.07763499180819933
Bond Position:  [19.44676757]


portfolio before change:  [26.74811427]
curr_Stock_Price:  94.03145497240399
curr_Factors:  [94.03145497]
mat_Sqrt:  [[0.15]]
grads:  [0.01894616]
Stock Position:  0.0189461643437272
Bond Position:  [24.96657887]


portfolio before change:  [26.75993091]
curr_Stock_Price:  94.5727878988159
curr_Factors:  [94.5727879]
mat_Sqrt:  [[0.15]]
grads:  [-0.15958912]
Stock Position:  -0.15958912442037163
Bond Position:  [41.85271932]


portfolio before change:  [26.63900073]
curr_Stock_Price:  95.34693875793153
curr_Factors:  [95.34693876]
mat_Sqrt:  [[0.15]]
grads:  [-0.20111122]
Stock Position:  -0.2011112219096245
Bond Position:  [45.81434009]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.66266544]
Stock Price:  95.24350731440211
PL:  [26.66266544]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33219125e-02]
 [-1.33138163e-02]
 [ 1.20741655e-02]
 [-7.53443100e-03]
 [ 2.93268429e-03]
 [-3.43302996e-03]
 [ 2.01099087e-03]
 [ 6.41634092e-03]
 [-1.32747351e-02]
 [-1.28842827e-03]
 [ 1.43267158e-02]
 [-3.02039848e-03]
 [-3.29294861e-03]
 [ 5.64772334e-03]
 [-2.15887203e-03]
 [ 1.47296926e-02]
 [ 3.45930145e-02]
 [-1.47405069e-02]
 [ 1.77022643e-02]
 [ 1.78310620e-03]
 [-3.91333125e-03]
 [ 5.06711291e-03]
 [ 1.07523701e-02]
 [ 2.22529575e-02]
 [ 9.72203668e-04]
 [ 7.65875445e-03]
 [ 1.30223289e-02]
 [ 2.06114566e-02]
 [ 2.00231199e-02]
 [-8.22112303e-03]
 [-1.82981859e-03]
 [ 1.41988042e-02]
 [ 1.39813324e-02]
 [-4.09212691e-03]
 [ 4.82621773e-03]
 [ 1.12114499e-02]
 [-2.52348407e-02]
 [ 1.35746691e-04]
 [-4.15503774e-02]
 [ 5.39541835e-03]
 [ 5.77673103e-03]
 [ 8.47035086e-03]
 [-3.15015649e-03]
 [-4.71066675e-03]
 [ 2.23110963e-02]
 [ 1.31200499e-02]
 [ 1.05885863e-02]
 [ 4.06203551e-04]
 [ 1.22735444e-02]
 [-1.16922742e-03]
 [ 2.15524055e-02]
 [ 3.76157716e-03]
 [-1.99974466e-03]
 [-1.91349048e-02]
 [-4.26711285e-03]
 [-3.09647421e-03]
 [ 1.07010414e-02]
 [-1.66316828e-02]
 [ 5.16395650e-03]
 [-3.77910389e-03]
 [-3.98292444e-03]
 [ 4.77103828e-03]
 [-1.96169768e-02]
 [ 1.02498836e-03]
 [ 2.02300718e-02]
 [ 8.22015049e-03]
 [ 1.53166193e-02]
 [ 7.03843728e-03]
 [ 4.11098470e-03]
 [ 1.96416330e-02]
 [ 4.66377085e-04]
 [-1.57936308e-02]
 [-1.79173346e-04]
 [ 1.32756313e-03]
 [ 2.28505910e-03]
 [-1.32005311e-02]
 [-4.36370729e-03]
 [ 1.21940850e-02]
 [-1.57799037e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.55138417]
curr_Stock_Price:  98.97440382481997
curr_Factors:  [98.97440382]
mat_Sqrt:  [[0.15]]
grads:  [-0.08881275]
Stock Position:  -0.0888127496969216
Bond Position:  [-11.76119522]


portfolio before change:  [-20.56987644]
curr_Stock_Price:  99.17434327950791
curr_Factors:  [99.17434328]
mat_Sqrt:  [[0.15]]
grads:  [-0.08875878]
Stock Position:  -0.08875877517875391
Bond Position:  [-11.7672832]


portfolio before change:  [-20.58689959]
curr_Stock_Price:  99.35784823111644
curr_Factors:  [99.35784823]
mat_Sqrt:  [[0.15]]
grads:  [0.08049444]
Stock Position:  0.08049443639427763
Bond Position:  [-28.58465359]


portfolio before change:  [-20.51428263]
curr_Stock_Price:  100.28217989479546
curr_Factors:  [100.28217989]
mat_Sqrt:  [[0.15]]
grads:  [-0.05022954]
Stock Position:  -0.0502295400110454
Bond Position:  [-15.47715487]


portfolio before change:  [-20.52464277]
curr_Stock_Price:  100.46917708350274
curr_Factors:  [100.46917708]
mat_Sqrt:  [[0.15]]
grads:  [0.01955123]
Stock Position:  0.01955122858779943
Bond Position:  [-22.48893862]


portfolio before change:  [-20.52838181]
curr_Stock_Price:  100.34982710060882
curr_Factors:  [100.3498271]
mat_Sqrt:  [[0.15]]
grads:  [-0.02288687]
Stock Position:  -0.022886866368270888
Bond Position:  [-18.23168873]


portfolio before change:  [-20.51589119]
curr_Stock_Price:  99.75428323389798
curr_Factors:  [99.75428323]
mat_Sqrt:  [[0.15]]
grads:  [0.01340661]
Stock Position:  0.013406605788464424
Bond Position:  [-21.85325754]


portfolio before change:  [-20.52491267]
curr_Stock_Price:  99.18325069572526
curr_Factors:  [99.1832507]
mat_Sqrt:  [[0.15]]
grads:  [0.04277561]
Stock Position:  0.04277560614725546
Bond Position:  [-24.76753634]


portfolio before change:  [-20.51733335]
curr_Stock_Price:  99.39662804119483
curr_Factors:  [99.39662804]
mat_Sqrt:  [[0.15]]
grads:  [-0.08849823]
Stock Position:  -0.0884982339383638
Bond Position:  [-11.72090731]


portfolio before change:  [-20.58205681]
curr_Stock_Price:  100.11970325291692
curr_Factors:  [100.11970325]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858952]
Stock Position:  -0.008589521784604487
Bond Position:  [-19.72207643]


portfolio before change:  [-20.57877014]
curr_Stock_Price:  99.5935584077621
curr_Factors:  [99.59355841]
mat_Sqrt:  [[0.15]]
grads:  [0.09551144]
Stock Position:  0.09551143860569955
Bond Position:  [-30.09109418]


portfolio before change:  [-20.54494609]
curr_Stock_Price:  99.96738588882188
curr_Factors:  [99.96738589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013599]
Stock Position:  -0.020135989895056997
Bond Position:  [-18.53200382]


portfolio before change:  [-20.56609145]
curr_Stock_Price:  100.95999015151719
curr_Factors:  [100.95999015]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195299]
Stock Position:  -0.021952990748231618
Bond Position:  [-18.34971772]


portfolio before change:  [-20.57171845]
curr_Stock_Price:  101.16406766769431
curr_Factors:  [101.16406767]
mat_Sqrt:  [[0.15]]
grads:  [0.03765149]
Stock Position:  0.03765148891694484
Bond Position:  [-24.38069623]


portfolio before change:  [-20.59374713]
curr_Stock_Price:  100.61947211860522
curr_Factors:  [100.61947212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01439248]
Stock Position:  -0.014392480180861096
Bond Position:  [-19.14558337]


portfolio before change:  [-20.59435505]
curr_Stock_Price:  100.5785675602068
curr_Factors:  [100.57856756]
mat_Sqrt:  [[0.15]]
grads:  [0.09819795]
Stock Position:  0.0981979509639369
Bond Position:  [-30.47096429]


portfolio before change:  [-20.64813414]
curr_Stock_Price:  100.05030200448842
curr_Factors:  [100.050302]
mat_Sqrt:  [[0.15]]
grads:  [0.2306201]
Stock Position:  0.23062009673383133
Bond Position:  [-43.72174446]


portfolio before change:  [-20.65646095]
curr_Stock_Price:  100.02604514789681
curr_Factors:  [100.02604515]
mat_Sqrt:  [[0.15]]
grads:  [-0.09827005]
Stock Position:  -0.09827004571426344
Bond Position:  [-10.82689692]


portfolio before change:  [-20.76428538]
curr_Stock_Price:  101.11638478893072
curr_Factors:  [101.11638479]
mat_Sqrt:  [[0.15]]
grads:  [0.1180151]
Stock Position:  0.11801509501882189
Bond Position:  [-32.69754514]


portfolio before change:  [-20.77054295]
curr_Stock_Price:  101.08067824609937
curr_Factors:  [101.08067825]
mat_Sqrt:  [[0.15]]
grads:  [0.01188737]
Stock Position:  0.011887374659481944
Bond Position:  [-21.97212684]


portfolio before change:  [-20.770179]
curr_Stock_Price:  101.22682066346609
curr_Factors:  [101.22682066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02608887]
Stock Position:  -0.026088874986416127
Bond Position:  [-18.12928513]


portfolio before change:  [-20.79223991]
curr_Stock_Price:  102.02899366390757
curr_Factors:  [102.02899366]
mat_Sqrt:  [[0.15]]
grads:  [0.03378075]
Stock Position:  0.03378075270043291
Bond Position:  [-24.23885611]


portfolio before change:  [-20.79867869]
curr_Stock_Price:  101.88323578749227
curr_Factors:  [101.88323579]
mat_Sqrt:  [[0.15]]
grads:  [0.07168247]
Stock Position:  0.07168246722398128
Bond Position:  [-28.1019204]


portfolio before change:  [-20.82306364]
curr_Stock_Price:  101.56755855474327
curr_Factors:  [101.56755855]
mat_Sqrt:  [[0.15]]
grads:  [0.14835305]
Stock Position:  0.14835304996720253
Bond Position:  [-35.89092073]


portfolio before change:  [-20.70597984]
curr_Stock_Price:  102.37190367010572
curr_Factors:  [102.37190367]
mat_Sqrt:  [[0.15]]
grads:  [0.00648136]
Stock Position:  0.006481357789345568
Bond Position:  [-21.36948878]


portfolio before change:  [-20.71149156]
curr_Stock_Price:  101.72758145899192
curr_Factors:  [101.72758146]
mat_Sqrt:  [[0.15]]
grads:  [0.05105836]
Stock Position:  0.05105836298202161
Bond Position:  [-25.90553534]


portfolio before change:  [-20.6697187]
curr_Stock_Price:  102.57743269132366
curr_Factors:  [102.57743269]
mat_Sqrt:  [[0.15]]
grads:  [0.08681553]
Stock Position:  0.0868155260025529
Bond Position:  [-29.57503247]


portfolio before change:  [-20.64201929]
curr_Stock_Price:  102.91778547882707
curr_Factors:  [102.91778548]
mat_Sqrt:  [[0.15]]
grads:  [0.13740971]
Stock Position:  0.1374097104855723
Bond Position:  [-34.78392239]


portfolio before change:  [-20.65403526]
curr_Stock_Price:  102.8461609154834
curr_Factors:  [102.84616092]
mat_Sqrt:  [[0.15]]
grads:  [0.13348747]
Stock Position:  0.13348746588963759
Bond Position:  [-34.38270866]


portfolio before change:  [-20.68619291]
curr_Stock_Price:  102.62135578855772
curr_Factors:  [102.62135579]
mat_Sqrt:  [[0.15]]
grads:  [-0.05480749]
Stock Position:  -0.05480748686108629
Bond Position:  [-15.0617743]


portfolio before change:  [-20.6665028]
curr_Stock_Price:  102.24491984437364
curr_Factors:  [102.24491984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01219879]
Stock Position:  -0.012198790605613224
Bond Position:  [-19.41923843]


portfolio before change:  [-20.67648117]
curr_Stock_Price:  102.96340388712936
curr_Factors:  [102.96340389]
mat_Sqrt:  [[0.15]]
grads:  [0.09465869]
Stock Position:  0.0946586945242878
Bond Position:  [-30.42286257]


portfolio before change:  [-20.68848148]
curr_Stock_Price:  102.85671724150019
curr_Factors:  [102.85671724]
mat_Sqrt:  [[0.15]]
grads:  [0.09320888]
Stock Position:  0.09320888270459124
Bond Position:  [-30.27564117]


portfolio before change:  [-20.65947629]
curr_Stock_Price:  103.18820358012901
curr_Factors:  [103.18820358]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728085]
Stock Position:  -0.027280846051045186
Bond Position:  [-17.8444148]


portfolio before change:  [-20.65810214]
curr_Stock_Price:  103.09695051115739
curr_Factors:  [103.09695051]
mat_Sqrt:  [[0.15]]
grads:  [0.03217478]
Stock Position:  0.03217478489196842
Bond Position:  [-23.97522435]


portfolio before change:  [-20.68185557]
curr_Stock_Price:  102.40526220131734
curr_Factors:  [102.4052622]
mat_Sqrt:  [[0.15]]
grads:  [0.074743]
Stock Position:  0.07474299906103583
Bond Position:  [-28.33593198]


portfolio before change:  [-20.7126157]
curr_Stock_Price:  102.01741204426601
curr_Factors:  [102.01741204]
mat_Sqrt:  [[0.15]]
grads:  [-0.16823227]
Stock Position:  -0.16823227137924668
Bond Position:  [-3.54999475]


portfolio before change:  [-20.67999563]
curr_Stock_Price:  101.82219411777183
curr_Factors:  [101.82219412]
mat_Sqrt:  [[0.15]]
grads:  [0.00090498]
Stock Position:  0.0009049779403983288
Bond Position:  [-20.77214247]


portfolio before change:  [-20.68151868]
curr_Stock_Price:  101.57384533025305
curr_Factors:  [101.57384533]
mat_Sqrt:  [[0.15]]
grads:  [-0.27700252]
Stock Position:  -0.2770025161307382
Bond Position:  [7.45469205]


portfolio before change:  [-20.53628499]
curr_Stock_Price:  101.05122280422704
curr_Factors:  [101.0512228]
mat_Sqrt:  [[0.15]]
grads:  [0.03596946]
Stock Position:  0.03596945568289746
Bond Position:  [-24.17104247]


portfolio before change:  [-20.5348171]
curr_Stock_Price:  101.13403276356627
curr_Factors:  [101.13403276]
mat_Sqrt:  [[0.15]]
grads:  [0.03851154]
Stock Position:  0.03851154017325483
Bond Position:  [-24.42964446]


portfolio before change:  [-20.5274309]
curr_Stock_Price:  101.36547255240043
curr_Factors:  [101.36547255]
mat_Sqrt:  [[0.15]]
grads:  [0.05646901]
Stock Position:  0.05646900575710284
Bond Position:  [-26.25143835]


portfolio before change:  [-20.56512952]
curr_Stock_Price:  100.72693012628822
curr_Factors:  [100.72693013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100104]
Stock Position:  -0.021001043280933367
Bond Position:  [-18.4497589]


portfolio before change:  [-20.57127739]
curr_Stock_Price:  100.96476266538986
curr_Factors:  [100.96476267]
mat_Sqrt:  [[0.15]]
grads:  [-0.03140445]
Stock Position:  -0.03140444502004359
Bond Position:  [-17.40053506]


portfolio before change:  [-20.56099905]
curr_Stock_Price:  100.60284206202546
curr_Factors:  [100.60284206]
mat_Sqrt:  [[0.15]]
grads:  [0.14874064]
Stock Position:  0.14874064214171548
Bond Position:  [-35.52473038]


portfolio before change:  [-20.39993024]
curr_Stock_Price:  101.70065343540881
curr_Factors:  [101.70065344]
mat_Sqrt:  [[0.15]]
grads:  [0.087467]
Stock Position:  0.08746699942130397
Bond Position:  [-29.29538124]


portfolio before change:  [-20.3470865]
curr_Stock_Price:  102.32574363461929
curr_Factors:  [102.32574363]
mat_Sqrt:  [[0.15]]
grads:  [0.07059058]
Stock Position:  0.0705905752113036
Bond Position:  [-27.5703196]


portfolio before change:  [-20.37269186]
curr_Stock_Price:  101.98742417160187
curr_Factors:  [101.98742417]
mat_Sqrt:  [[0.15]]
grads:  [0.00270802]
Stock Position:  0.002708023674698481
Bond Position:  [-20.64887622]


portfolio before change:  [-20.37143021]
curr_Stock_Price:  102.92989993949129
curr_Factors:  [102.92989994]
mat_Sqrt:  [[0.15]]
grads:  [0.08182363]
Stock Position:  0.08182362916961136
Bond Position:  [-28.79352817]


portfolio before change:  [-20.39919063]
curr_Stock_Price:  102.61262281267874
curr_Factors:  [102.61262281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779485]
Stock Position:  -0.007794849485518355
Bond Position:  [-19.59934068]


portfolio before change:  [-20.40674545]
curr_Stock_Price:  103.42467534870515
curr_Factors:  [103.42467535]
mat_Sqrt:  [[0.15]]
grads:  [0.1436827]
Stock Position:  0.14368270352343016
Bond Position:  [-35.26708242]


portfolio before change:  [-20.36359834]
curr_Stock_Price:  103.74031093170159
curr_Factors:  [103.74031093]
mat_Sqrt:  [[0.15]]
grads:  [0.02507718]
Stock Position:  0.025077181041998367
Bond Position:  [-22.9651129]


portfolio before change:  [-20.3687069]
curr_Stock_Price:  103.59383518088252
curr_Factors:  [103.59383518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01333163]
Stock Position:  -0.013331631054560934
Bond Position:  [-18.98763211]


portfolio before change:  [-20.36926903]
curr_Stock_Price:  103.54698158212754
curr_Factors:  [103.54698158]
mat_Sqrt:  [[0.15]]
grads:  [-0.12756603]
Stock Position:  -0.12756603195005084
Bond Position:  [-7.16019147]


portfolio before change:  [-20.37862075]
curr_Stock_Price:  103.61678219372274
curr_Factors:  [103.61678219]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844742]
Stock Position:  -0.02844741902210705
Bond Position:  [-17.43099072]


portfolio before change:  [-20.3612697]
curr_Stock_Price:  102.96855069467416
curr_Factors:  [102.96855069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02064316]
Stock Position:  -0.020643161415259792
Bond Position:  [-18.23567329]


portfolio before change:  [-20.35488641]
curr_Stock_Price:  102.60411731164959
curr_Factors:  [102.60411731]
mat_Sqrt:  [[0.15]]
grads:  [0.07134028]
Stock Position:  0.07134027619926826
Bond Position:  [-27.67469248]


portfolio before change:  [-20.27986727]
curr_Stock_Price:  103.67993129651447
curr_Factors:  [103.6799313]
mat_Sqrt:  [[0.15]]
grads:  [-0.11087789]
Stock Position:  -0.11087788518703924
Bond Position:  [-8.78405575]


portfolio before change:  [-20.20357153]
curr_Stock_Price:  102.9868737519665
curr_Factors:  [102.98687375]
mat_Sqrt:  [[0.15]]
grads:  [0.03442638]
Stock Position:  0.03442637663516088
Bond Position:  [-23.74903644]


portfolio before change:  [-20.20440082]
curr_Stock_Price:  103.00590199374192
curr_Factors:  [103.00590199]
mat_Sqrt:  [[0.15]]
grads:  [-0.02519403]
Stock Position:  -0.025194025909124524
Bond Position:  [-17.60926746]


portfolio before change:  [-20.21892765]
curr_Stock_Price:  103.53881468741824
curr_Factors:  [103.53881469]
mat_Sqrt:  [[0.15]]
grads:  [-0.02655283]
Stock Position:  -0.026552829613271586
Bond Position:  [-17.46967915]


portfolio before change:  [-20.23743005]
curr_Stock_Price:  104.19450809819287
curr_Factors:  [104.1945081]
mat_Sqrt:  [[0.15]]
grads:  [0.03180692]
Stock Position:  0.03180692189261405
Bond Position:  [-23.55153664]


portfolio before change:  [-20.23280805]
curr_Stock_Price:  104.38610244922567
curr_Factors:  [104.38610245]
mat_Sqrt:  [[0.15]]
grads:  [-0.13077985]
Stock Position:  -0.13077984524807976
Bond Position:  [-6.58120972]


portfolio before change:  [-20.15141542]
curr_Stock_Price:  103.76059352436293
curr_Factors:  [103.76059352]
mat_Sqrt:  [[0.15]]
grads:  [0.00683326]
Stock Position:  0.006833255760489739
Bond Position:  [-20.8604381]


portfolio before change:  [-20.15556605]
curr_Stock_Price:  103.34398328651723
curr_Factors:  [103.34398329]
mat_Sqrt:  [[0.15]]
grads:  [0.13486715]
Stock Position:  0.1348671455263244
Bond Position:  [-34.09327408]


portfolio before change:  [-20.2217786]
curr_Stock_Price:  102.86883676213039
curr_Factors:  [102.86883676]
mat_Sqrt:  [[0.15]]
grads:  [0.054801]
Stock Position:  0.054801003237526055
Bond Position:  [-25.85909405]


portfolio before change:  [-20.23875672]
curr_Stock_Price:  102.58851560237058
curr_Factors:  [102.5885156]
mat_Sqrt:  [[0.15]]
grads:  [0.1021108]
Stock Position:  0.10211079551280987
Bond Position:  [-30.71415166]


portfolio before change:  [-20.22180655]
curr_Stock_Price:  102.7733135497869
curr_Factors:  [102.77331355]
mat_Sqrt:  [[0.15]]
grads:  [0.04692292]
Stock Position:  0.046922915168813494
Bond Position:  [-25.04423002]


portfolio before change:  [-20.24588608]
curr_Stock_Price:  102.29350077887939
curr_Factors:  [102.29350078]
mat_Sqrt:  [[0.15]]
grads:  [0.02740656]
Stock Position:  0.027406564653788466
Bond Position:  [-23.04939952]


portfolio before change:  [-20.26305375]
curr_Stock_Price:  101.71965871759014
curr_Factors:  [101.71965872]
mat_Sqrt:  [[0.15]]
grads:  [0.13094422]
Stock Position:  0.13094421986584528
Bond Position:  [-33.58265511]


portfolio before change:  [-20.33084071]
curr_Stock_Price:  101.21801019485473
curr_Factors:  [101.21801019]
mat_Sqrt:  [[0.15]]
grads:  [0.00310918]
Stock Position:  0.0031091805648527974
Bond Position:  [-20.64554578]


portfolio before change:  [-20.33138391]
curr_Stock_Price:  101.45832506722239
curr_Factors:  [101.45832507]
mat_Sqrt:  [[0.15]]
grads:  [-0.10529087]
Stock Position:  -0.10529087177625837
Bond Position:  [-9.64874842]


portfolio before change:  [-20.33898225]
curr_Stock_Price:  101.524762706635
curr_Factors:  [101.52476271]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119449]
Stock Position:  -0.0011944889711507437
Bond Position:  [-20.21771204]


portfolio before change:  [-20.34056992]
curr_Stock_Price:  101.7960258378867
curr_Factors:  [101.79602584]
mat_Sqrt:  [[0.15]]
grads:  [0.00885042]
Stock Position:  0.008850420872475017
Bond Position:  [-21.24150759]


portfolio before change:  [-20.33865356]
curr_Stock_Price:  102.16256169706367
curr_Factors:  [102.1625617]
mat_Sqrt:  [[0.15]]
grads:  [0.01523373]
Stock Position:  0.015233727305554653
Bond Position:  [-21.89497017]


portfolio before change:  [-20.34780269]
curr_Stock_Price:  101.65180993383377
curr_Factors:  [101.65180993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08800354]
Stock Position:  -0.08800354054335693
Bond Position:  [-11.40208351]


portfolio before change:  [-20.30223294]
curr_Stock_Price:  101.12589472334113
curr_Factors:  [101.12589472]
mat_Sqrt:  [[0.15]]
grads:  [-0.02909138]
Stock Position:  -0.029091381905753562
Bond Position:  [-17.36034092]


portfolio before change:  [-20.28409363]
curr_Stock_Price:  100.46506782298138
curr_Factors:  [100.46506782]
mat_Sqrt:  [[0.15]]
grads:  [0.0812939]
Stock Position:  0.08129389968503226
Bond Position:  [-28.45129078]


portfolio before change:  [-20.26646333]
curr_Stock_Price:  100.7038134808515
curr_Factors:  [100.70381348]
mat_Sqrt:  [[0.15]]
grads:  [-0.10519936]
Stock Position:  -0.10519935804477512
Bond Position:  [-9.6724868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.20472242]
Stock Price:  100.11117241497486
PL:  [-20.31589483]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.64168013e-03]
 [ 9.38942793e-03]
 [ 2.79777368e-03]
 [-8.77853317e-03]
 [ 1.30179555e-02]
 [-7.10587069e-03]
 [ 2.50134991e-03]
 [-1.50070990e-02]
 [-6.88793684e-03]
 [ 1.40194520e-03]
 [-1.93488682e-03]
 [ 5.88636196e-03]
 [-3.17442361e-03]
 [ 7.94585822e-03]
 [-2.32358330e-03]
 [ 1.31859771e-02]
 [ 3.59544980e-02]
 [-1.47263231e-02]
 [ 1.95030769e-02]
 [ 2.68065901e-03]
 [-4.06163235e-03]
 [ 5.46494797e-03]
 [ 1.23255652e-02]
 [ 1.95666262e-02]
 [ 9.21699878e-03]
 [ 4.41826379e-03]
 [ 1.04191826e-02]
 [ 8.65640937e-03]
 [ 1.59552075e-02]
 [ 3.08336491e-02]
 [-7.06100484e-03]
 [ 1.69057716e-02]
 [ 1.19427591e-02]
 [-1.99306655e-02]
 [-1.03312538e-02]
 [-1.79593778e-03]
 [ 8.34814853e-03]
 [-2.31283960e-03]
 [ 3.41036836e-02]
 [ 1.51795770e-02]
 [ 6.66298826e-03]
 [ 3.54069512e-02]
 [-3.37444901e-03]
 [ 2.53438385e-02]
 [-7.66401279e-02]
 [ 2.64575071e-02]
 [ 8.29635824e-03]
 [ 5.44988780e-03]
 [-1.82674631e-02]
 [ 3.59529569e-04]
 [ 1.42338471e-03]
 [-5.10947071e-03]
 [-1.60923593e-03]
 [ 4.22713607e-03]
 [-1.65856305e-02]
 [-5.34504522e-03]
 [-4.55258622e-03]
 [ 1.47037115e-02]
 [ 5.30627412e-03]
 [-2.17105936e-03]
 [-5.16710895e-03]
 [-4.30571063e-03]
 [ 1.15270503e-03]
 [-6.07981178e-03]
 [ 1.75285098e-02]
 [ 8.69792754e-03]
 [ 2.04761607e-02]
 [-6.04985349e-03]
 [ 9.45220617e-03]
 [ 3.05343708e-02]
 [ 3.14033247e-03]
 [-1.50711824e-02]
 [-5.97586418e-03]
 [ 3.53731686e-03]
 [ 1.26817892e-02]
 [ 1.92004365e-02]
 [ 3.95737925e-03]
 [-2.89227514e-02]
 [-3.14650964e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.73705157]
curr_Stock_Price:  100.44087840795552
curr_Factors:  [100.44087841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427787]
Stock Position:  -0.024277867540158215
Bond Position:  [14.17554191]


portfolio before change:  [11.75019702]
curr_Stock_Price:  99.93591449684756
curr_Factors:  [99.9359145]
mat_Sqrt:  [[0.15]]
grads:  [0.06259619]
Stock Position:  0.062596186201991
Bond Position:  [5.4945899]


portfolio before change:  [11.74809534]
curr_Stock_Price:  99.89685307427744
curr_Factors:  [99.89685307]
mat_Sqrt:  [[0.15]]
grads:  [0.01865182]
Stock Position:  0.01865182453850686
Bond Position:  [9.88483677]


portfolio before change:  [11.73974207]
curr_Stock_Price:  99.41587623417234
curr_Factors:  [99.41587623]
mat_Sqrt:  [[0.15]]
grads:  [-0.05852355]
Stock Position:  -0.05852355445627217
Bond Position:  [17.55791252]


portfolio before change:  [11.74494327]
curr_Stock_Price:  99.34575403167834
curr_Factors:  [99.34575403]
mat_Sqrt:  [[0.15]]
grads:  [0.08678637]
Stock Position:  0.08678636978766326
Bond Position:  [3.12308593]


portfolio before change:  [11.79150837]
curr_Stock_Price:  99.88005328584083
curr_Factors:  [99.88005329]
mat_Sqrt:  [[0.15]]
grads:  [-0.04737247]
Stock Position:  -0.04737247128540344
Bond Position:  [16.52307332]


portfolio before change:  [11.78470265]
curr_Stock_Price:  100.04551725838515
curr_Factors:  [100.04551726]
mat_Sqrt:  [[0.15]]
grads:  [0.01667567]
Stock Position:  0.016675666068160223
Bond Position:  [10.11637701]


portfolio before change:  [11.79191116]
curr_Stock_Price:  100.43987737008996
curr_Factors:  [100.43987737]
mat_Sqrt:  [[0.15]]
grads:  [-0.10004733]
Stock Position:  -0.10004732698809109
Bond Position:  [21.84065242]


portfolio before change:  [11.84104587]
curr_Stock_Price:  99.96240707642504
curr_Factors:  [99.96240708]
mat_Sqrt:  [[0.15]]
grads:  [-0.04591958]
Stock Position:  -0.04591957890220099
Bond Position:  [16.43127751]


portfolio before change:  [11.82013014]
curr_Stock_Price:  100.4402581836804
curr_Factors:  [100.44025818]
mat_Sqrt:  [[0.15]]
grads:  [0.0093463]
Stock Position:  0.009346301305888302
Bond Position:  [10.88138522]


portfolio before change:  [11.82483032]
curr_Stock_Price:  100.87038311898473
curr_Factors:  [100.87038312]
mat_Sqrt:  [[0.15]]
grads:  [-0.01289925]
Stock Position:  -0.01289924548801109
Bond Position:  [13.12598216]


portfolio before change:  [11.82452121]
curr_Stock_Price:  100.95794729661023
curr_Factors:  [100.9579473]
mat_Sqrt:  [[0.15]]
grads:  [0.03924241]
Stock Position:  0.03924241308893992
Bond Position:  [7.86268774]


portfolio before change:  [11.82120918]
curr_Stock_Price:  100.86102498729952
curr_Factors:  [100.86102499]
mat_Sqrt:  [[0.15]]
grads:  [-0.02116282]
Stock Position:  -0.021162824056893383
Bond Position:  [13.95571331]


portfolio before change:  [11.83064127]
curr_Stock_Price:  100.45654986515677
curr_Factors:  [100.45654987]
mat_Sqrt:  [[0.15]]
grads:  [0.05297239]
Stock Position:  0.052972388140097165
Bond Position:  [6.50921792]


portfolio before change:  [11.82825707]
curr_Stock_Price:  100.40386125300537
curr_Factors:  [100.40386125]
mat_Sqrt:  [[0.15]]
grads:  [-0.01549056]
Stock Position:  -0.015490555307935902
Bond Position:  [13.38356864]


portfolio before change:  [11.83478145]
curr_Stock_Price:  100.03667727089152
curr_Factors:  [100.03667727]
mat_Sqrt:  [[0.15]]
grads:  [0.08790651]
Stock Position:  0.08790651405300857
Bond Position:  [3.04090588]


portfolio before change:  [11.85025858]
curr_Stock_Price:  100.21057859505467
curr_Factors:  [100.2105786]
mat_Sqrt:  [[0.15]]
grads:  [0.23969665]
Stock Position:  0.23969665343739932
Bond Position:  [-12.16988175]


portfolio before change:  [11.83613123]
curr_Stock_Price:  100.1548134983037
curr_Factors:  [100.1548135]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817549]
Stock Position:  -0.09817548737418552
Bond Position:  [21.66887886]


portfolio before change:  [11.82211346]
curr_Stock_Price:  100.3113914126338
curr_Factors:  [100.31139141]
mat_Sqrt:  [[0.15]]
grads:  [0.13002051]
Stock Position:  0.13002051288469202
Bond Position:  [-1.2204251]


portfolio before change:  [11.79769005]
curr_Stock_Price:  100.12413528426167
curr_Factors:  [100.12413528]
mat_Sqrt:  [[0.15]]
grads:  [0.01787106]
Stock Position:  0.017871060076496116
Bond Position:  [10.00836561]


portfolio before change:  [11.78420592]
curr_Stock_Price:  99.33460946340132
curr_Factors:  [99.33460946]
mat_Sqrt:  [[0.15]]
grads:  [-0.02707755]
Stock Position:  -0.027077549009028215
Bond Position:  [14.47394368]


portfolio before change:  [11.81385236]
curr_Stock_Price:  98.27314755820474
curr_Factors:  [98.27314756]
mat_Sqrt:  [[0.15]]
grads:  [0.03643299]
Stock Position:  0.036432986436945515
Bond Position:  [8.23346811]


portfolio before change:  [11.7866684]
curr_Stock_Price:  97.51288675294026
curr_Factors:  [97.51288675]
mat_Sqrt:  [[0.15]]
grads:  [0.08217043]
Stock Position:  0.08217043491876934
Bond Position:  [3.77399208]


portfolio before change:  [11.77424989]
curr_Stock_Price:  97.35888499021462
curr_Factors:  [97.35888499]
mat_Sqrt:  [[0.15]]
grads:  [0.13044417]
Stock Position:  0.13044417459786847
Bond Position:  [-0.92564951]


portfolio before change:  [11.64278924]
curr_Stock_Price:  96.35153610430744
curr_Factors:  [96.3515361]
mat_Sqrt:  [[0.15]]
grads:  [0.06144666]
Stock Position:  0.06144665850350328
Bond Position:  [5.7223093]


portfolio before change:  [11.72756631]
curr_Stock_Price:  97.72540121090786
curr_Factors:  [97.72540121]
mat_Sqrt:  [[0.15]]
grads:  [0.02945509]
Stock Position:  0.02945509194797321
Bond Position:  [8.84905564]


portfolio before change:  [11.75627382]
curr_Stock_Price:  98.6812433556813
curr_Factors:  [98.68124336]
mat_Sqrt:  [[0.15]]
grads:  [0.06946122]
Stock Position:  0.06946121731386402
Bond Position:  [4.90175453]


portfolio before change:  [11.74051991]
curr_Stock_Price:  98.45003129336904
curr_Factors:  [98.45003129]
mat_Sqrt:  [[0.15]]
grads:  [0.0577094]
Stock Position:  0.057709395778134075
Bond Position:  [6.05902809]


portfolio before change:  [11.71145496]
curr_Stock_Price:  97.93982578437
curr_Factors:  [97.93982578]
mat_Sqrt:  [[0.15]]
grads:  [0.10636805]
Stock Position:  0.10636804979136291
Bond Position:  [1.2937867]


portfolio before change:  [11.64926325]
curr_Stock_Price:  97.35438137038759
curr_Factors:  [97.35438137]
mat_Sqrt:  [[0.15]]
grads:  [0.20555766]
Stock Position:  0.20555766047971724
Bond Position:  [-8.36267563]


portfolio before change:  [11.62432343]
curr_Stock_Price:  97.23559652161441
curr_Factors:  [97.23559652]
mat_Sqrt:  [[0.15]]
grads:  [-0.04707337]
Stock Position:  -0.04707336560021757
Bond Position:  [16.20153021]


portfolio before change:  [11.60979498]
curr_Stock_Price:  97.56574223958818
curr_Factors:  [97.56574224]
mat_Sqrt:  [[0.15]]
grads:  [0.11270514]
Stock Position:  0.11270514390920315
Bond Position:  [0.61363396]


portfolio before change:  [11.56771557]
curr_Stock_Price:  97.19204349623983
curr_Factors:  [97.1920435]
mat_Sqrt:  [[0.15]]
grads:  [0.07961839]
Stock Position:  0.07961839402773366
Bond Position:  [3.82944115]


portfolio before change:  [11.53799249]
curr_Stock_Price:  96.81571809631912
curr_Factors:  [96.8157181]
mat_Sqrt:  [[0.15]]
grads:  [-0.1328711]
Stock Position:  -0.13287110302816998
Bond Position:  [24.40200374]


portfolio before change:  [11.51918559]
curr_Stock_Price:  96.9687391541763
curr_Factors:  [96.96873915]
mat_Sqrt:  [[0.15]]
grads:  [-0.06887503]
Stock Position:  -0.06887502550789133
Bond Position:  [18.19790997]


portfolio before change:  [11.52538742]
curr_Stock_Price:  96.89520851546351
curr_Factors:  [96.89520852]
mat_Sqrt:  [[0.15]]
grads:  [-0.01197292]
Stock Position:  -0.011972918514931038
Bond Position:  [12.68550585]


portfolio before change:  [11.52816701]
curr_Stock_Price:  96.7292739949769
curr_Factors:  [96.72927399]
mat_Sqrt:  [[0.15]]
grads:  [0.05565432]
Stock Position:  0.05565432354847136
Bond Position:  [6.14476469]


portfolio before change:  [11.51679921]
curr_Stock_Price:  96.51811601109607
curr_Factors:  [96.51811601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541893]
Stock Position:  -0.015418930686353378
Bond Position:  [13.00500535]


portfolio before change:  [11.53317801]
curr_Stock_Price:  95.50858013042533
curr_Factors:  [95.50858013]
mat_Sqrt:  [[0.15]]
grads:  [0.22735789]
Stock Position:  0.22735789091786063
Bond Position:  [-10.18145133]


portfolio before change:  [11.45504761]
curr_Stock_Price:  95.16773407364855
curr_Factors:  [95.16773407]
mat_Sqrt:  [[0.15]]
grads:  [0.10119718]
Stock Position:  0.10119717968490516
Bond Position:  [1.82434133]


portfolio before change:  [11.47210243]
curr_Stock_Price:  95.33513792369381
curr_Factors:  [95.33513792]
mat_Sqrt:  [[0.15]]
grads:  [0.04441992]
Stock Position:  0.04441992175440707
Bond Position:  [7.23732307]


portfolio before change:  [11.44977475]
curr_Stock_Price:  94.82230424783317
curr_Factors:  [94.82230425]
mat_Sqrt:  [[0.15]]
grads:  [0.23604634]
Stock Position:  0.23604634117832277
Bond Position:  [-10.93268323]


portfolio before change:  [11.51521742]
curr_Stock_Price:  95.10244410528648
curr_Factors:  [95.10244411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02249633]
Stock Position:  -0.02249632671106751
Bond Position:  [13.65467308]


portfolio before change:  [11.52390742]
curr_Stock_Price:  94.75409601142809
curr_Factors:  [94.75409601]
mat_Sqrt:  [[0.15]]
grads:  [0.16895892]
Stock Position:  0.16895892328428178
Bond Position:  [-4.48564262]


portfolio before change:  [11.41609108]
curr_Stock_Price:  94.11763374248213
curr_Factors:  [94.11763374]
mat_Sqrt:  [[0.15]]
grads:  [-0.51093419]
Stock Position:  -0.5109341859936216
Bond Position:  [59.50400766]


portfolio before change:  [11.47047834]
curr_Stock_Price:  94.01846608313922
curr_Factors:  [94.01846608]
mat_Sqrt:  [[0.15]]
grads:  [0.17638338]
Stock Position:  0.17638338039078685
Bond Position:  [-5.11281652]


portfolio before change:  [11.35794586]
curr_Stock_Price:  93.38227846929296
curr_Factors:  [93.38227847]
mat_Sqrt:  [[0.15]]
grads:  [0.05530905]
Stock Position:  0.05530905492567257
Bond Position:  [6.19306029]


portfolio before change:  [11.37532473]
curr_Stock_Price:  93.68949378747868
curr_Factors:  [93.68949379]
mat_Sqrt:  [[0.15]]
grads:  [0.03633259]
Stock Position:  0.03633258535184844
Bond Position:  [7.9713432]


portfolio before change:  [11.36394904]
curr_Stock_Price:  93.36268227288899
curr_Factors:  [93.36268227]
mat_Sqrt:  [[0.15]]
grads:  [-0.12178309]
Stock Position:  -0.12178308723678705
Bond Position:  [22.73394472]


portfolio before change:  [11.29691593]
curr_Stock_Price:  93.92478024967939
curr_Factors:  [93.92478025]
mat_Sqrt:  [[0.15]]
grads:  [0.00239686]
Stock Position:  0.00239686379546618
Bond Position:  [11.07179103]


portfolio before change:  [11.29726558]
curr_Stock_Price:  93.78194259244489
curr_Factors:  [93.78194259]
mat_Sqrt:  [[0.15]]
grads:  [0.00948923]
Stock Position:  0.009489231409093371
Bond Position:  [10.40734702]


portfolio before change:  [11.29805702]
curr_Stock_Price:  93.79679767554225
curr_Factors:  [93.79679768]
mat_Sqrt:  [[0.15]]
grads:  [-0.03406314]
Stock Position:  -0.03406313805481285
Bond Position:  [14.49307029]


portfolio before change:  [11.30013158]
curr_Stock_Price:  93.76248743309378
curr_Factors:  [93.76248743]
mat_Sqrt:  [[0.15]]
grads:  [-0.01072824]
Stock Position:  -0.010728239539112117
Bond Position:  [12.30603801]


portfolio before change:  [11.29224494]
curr_Stock_Price:  94.56931049574493
curr_Factors:  [94.5693105]
mat_Sqrt:  [[0.15]]
grads:  [0.02818091]
Stock Position:  0.0281809071208936
Bond Position:  [8.62719599]


portfolio before change:  [11.29435894]
curr_Stock_Price:  94.62519173609844
curr_Factors:  [94.62519174]
mat_Sqrt:  [[0.15]]
grads:  [-0.11057087]
Stock Position:  -0.11057086982912995
Bond Position:  [21.7571487]


portfolio before change:  [11.28549204]
curr_Stock_Price:  94.71768237266146
curr_Factors:  [94.71768237]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563363]
Stock Position:  -0.03563363479492823
Bond Position:  [14.66062734]


portfolio before change:  [11.29392814]
curr_Stock_Price:  94.50665192752706
curr_Factors:  [94.50665193]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035057]
Stock Position:  -0.030350574768870424
Bond Position:  [14.16225934]


portfolio before change:  [11.33352221]
curr_Stock_Price:  93.23125903528978
curr_Factors:  [93.23125904]
mat_Sqrt:  [[0.15]]
grads:  [0.09802474]
Stock Position:  0.09802474323991991
Bond Position:  [2.19455198]


portfolio before change:  [11.33595844]
curr_Stock_Price:  93.25471290406213
curr_Factors:  [93.2547129]
mat_Sqrt:  [[0.15]]
grads:  [0.03537516]
Stock Position:  0.035375160787314036
Bond Position:  [8.03705797]


portfolio before change:  [11.34676765]
curr_Stock_Price:  93.5460722196297
curr_Factors:  [93.54607222]
mat_Sqrt:  [[0.15]]
grads:  [-0.01447373]
Stock Position:  -0.014473729064136878
Bond Position:  [12.70072815]


portfolio before change:  [11.35132059]
curr_Stock_Price:  93.28635180946098
curr_Factors:  [93.28635181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03444739]
Stock Position:  -0.03444739299352098
Bond Position:  [14.56479222]


portfolio before change:  [11.34958316]
curr_Stock_Price:  93.3632157538004
curr_Factors:  [93.36321575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02870474]
Stock Position:  -0.028704737518908324
Bond Position:  [14.02954976]


portfolio before change:  [11.33293004]
curr_Stock_Price:  93.97391621330793
curr_Factors:  [93.97391621]
mat_Sqrt:  [[0.15]]
grads:  [0.0076847]
Stock Position:  0.00768470020610731
Bond Position:  [10.61076866]


portfolio before change:  [11.33564052]
curr_Stock_Price:  94.24032736795306
curr_Factors:  [94.24032737]
mat_Sqrt:  [[0.15]]
grads:  [-0.04053208]
Stock Position:  -0.04053207851960219
Bond Position:  [15.15539687]


portfolio before change:  [11.33573954]
curr_Stock_Price:  94.26125459255837
curr_Factors:  [94.26125459]
mat_Sqrt:  [[0.15]]
grads:  [0.11685673]
Stock Position:  0.1168567317184561
Bond Position:  [0.3206774]


portfolio before change:  [11.28722349]
curr_Stock_Price:  93.8459075607177
curr_Factors:  [93.84590756]
mat_Sqrt:  [[0.15]]
grads:  [0.05798618]
Stock Position:  0.05798618359499807
Bond Position:  [5.84545746]


portfolio before change:  [11.28055047]
curr_Stock_Price:  93.72452743420878
curr_Factors:  [93.72452743]
mat_Sqrt:  [[0.15]]
grads:  [0.13650774]
Stock Position:  0.13650773794924237
Bond Position:  [-1.51357276]


portfolio before change:  [11.2005337]
curr_Stock_Price:  93.13905026497935
curr_Factors:  [93.13905026]
mat_Sqrt:  [[0.15]]
grads:  [-0.04033236]
Stock Position:  -0.04033235657131128
Bond Position:  [14.95705109]


portfolio before change:  [11.20011897]
curr_Stock_Price:  93.17251170652439
curr_Factors:  [93.17251171]
mat_Sqrt:  [[0.15]]
grads:  [0.06301471]
Stock Position:  0.06301470782400788
Bond Position:  [5.32888037]


portfolio before change:  [11.19301486]
curr_Stock_Price:  93.05448881669032
curr_Factors:  [93.05448882]
mat_Sqrt:  [[0.15]]
grads:  [0.20356247]
Stock Position:  0.2035624719909716
Bond Position:  [-7.74938692]


portfolio before change:  [11.2539496]
curr_Stock_Price:  93.3562099535536
curr_Factors:  [93.35620995]
mat_Sqrt:  [[0.15]]
grads:  [0.02093555]
Stock Position:  0.020935549771742338
Bond Position:  [9.29948602]


portfolio before change:  [11.26034872]
curr_Stock_Price:  93.63410458730472
curr_Factors:  [93.63410459]
mat_Sqrt:  [[0.15]]
grads:  [-0.10047455]
Stock Position:  -0.10047454913364921
Bond Position:  [20.66819316]


portfolio before change:  [11.3353932]
curr_Stock_Price:  92.90006114830592
curr_Factors:  [92.90006115]
mat_Sqrt:  [[0.15]]
grads:  [-0.03983909]
Stock Position:  -0.039839094533607664
Bond Position:  [15.03644752]


portfolio before change:  [11.3414143]
curr_Stock_Price:  92.77251572262595
curr_Factors:  [92.77251572]
mat_Sqrt:  [[0.15]]
grads:  [0.02358211]
Stock Position:  0.02358211238597576
Bond Position:  [9.15364241]


portfolio before change:  [11.33538854]
curr_Stock_Price:  92.49273219147543
curr_Factors:  [92.49273219]
mat_Sqrt:  [[0.15]]
grads:  [0.08454526]
Stock Position:  0.08454526155143081
Bond Position:  [3.5155663]


portfolio before change:  [11.34757401]
curr_Stock_Price:  92.63426279776928
curr_Factors:  [92.6342628]
mat_Sqrt:  [[0.15]]
grads:  [0.12800291]
Stock Position:  0.12800291008165623
Bond Position:  [-0.5098812]


portfolio before change:  [11.45495271]
curr_Stock_Price:  93.47338879383673
curr_Factors:  [93.47338879]
mat_Sqrt:  [[0.15]]
grads:  [0.02638253]
Stock Position:  0.026382528359671344
Bond Position:  [8.98888838]


portfolio before change:  [11.46397983]
curr_Stock_Price:  93.79425626355568
curr_Factors:  [93.79425626]
mat_Sqrt:  [[0.15]]
grads:  [-0.19281834]
Stock Position:  -0.19281834256911204
Bond Position:  [29.54923286]


portfolio before change:  [11.36591639]
curr_Stock_Price:  94.31241406023315
curr_Factors:  [94.31241406]
mat_Sqrt:  [[0.15]]
grads:  [-0.20976731]
Stock Position:  -0.2097673091457759
Bond Position:  [31.1495777]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.2931585]
Stock Price:  94.66854581774838
PL:  [11.2931585]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33260811e-02]
 [ 4.43503774e-02]
 [ 1.94785167e-02]
 [-2.49466953e-02]
 [-6.87981964e-03]
 [-1.81740751e-03]
 [-6.91716862e-03]
 [-3.35863689e-02]
 [ 1.24951202e-02]
 [-5.89064694e-03]
 [-9.98233946e-03]
 [ 1.89297037e-02]
 [-3.01772507e-03]
 [ 9.78998639e-03]
 [-1.75769840e-03]
 [ 1.38107848e-02]
 [ 4.95522064e-02]
 [-1.41179027e-02]
 [ 1.87560834e-02]
 [ 1.84568719e-03]
 [-3.99278154e-03]
 [ 4.47718255e-03]
 [ 1.52297736e-02]
 [ 1.95952244e-02]
 [-2.37772611e-03]
 [ 7.66264112e-03]
 [ 2.75588386e-02]
 [ 2.66671870e-02]
 [ 4.60658647e-03]
 [-9.13567784e-03]
 [ 4.33096485e-03]
 [ 1.58368358e-02]
 [ 1.73261791e-02]
 [-1.15444824e-02]
 [ 3.86566400e-03]
 [-1.60714729e-02]
 [-9.91959164e-03]
 [-1.13653143e-02]
 [ 4.76633356e-05]
 [-2.88839869e-02]
 [ 3.50942063e-03]
 [ 6.54850672e-03]
 [-1.21739182e-02]
 [ 8.97069088e-03]
 [-4.45971612e-03]
 [ 1.16022156e-02]
 [ 1.05624798e-02]
 [-3.06395452e-03]
 [ 1.40213191e-02]
 [-1.46393236e-03]
 [ 1.98005898e-02]
 [ 1.36861438e-02]
 [-6.39561065e-03]
 [-4.98605616e-02]
 [-1.93092273e-02]
 [-2.08776801e-03]
 [-3.63976183e-03]
 [-1.32736346e-02]
 [-1.18043447e-03]
 [-2.89074237e-03]
 [-7.65396759e-03]
 [-2.93436405e-03]
 [-1.76639869e-02]
 [ 1.72427046e-05]
 [ 7.72844633e-04]
 [ 2.51732186e-02]
 [-2.09885223e-03]
 [ 1.84584455e-02]
 [ 8.71774751e-03]
 [ 1.15405582e-02]
 [ 7.69872935e-03]
 [-1.44525770e-02]
 [-5.62438106e-02]
 [ 3.58566919e-04]
 [-1.58455840e-02]
 [-3.18764007e-02]
 [-6.63278388e-03]
 [ 2.52505595e-02]
 [ 1.08623618e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.7897441]
curr_Stock_Price:  99.94367413656707
curr_Factors:  [99.94367414]
mat_Sqrt:  [[0.15]]
grads:  [-0.08884054]
Stock Position:  -0.08884054078525612
Bond Position:  [9.66879415]


portfolio before change:  [0.68422947]
curr_Stock_Price:  101.1381619392662
curr_Factors:  [101.13816194]
mat_Sqrt:  [[0.15]]
grads:  [0.29566918]
Stock Position:  0.2956691827574176
Bond Position:  [-29.21920821]


portfolio before change:  [0.68644872]
curr_Stock_Price:  101.15184446950667
curr_Factors:  [101.15184447]
mat_Sqrt:  [[0.15]]
grads:  [0.12985678]
Stock Position:  0.1298567780652855
Bond Position:  [-12.4488039]


portfolio before change:  [0.68162188]
curr_Stock_Price:  101.12066581968536
curr_Factors:  [101.12066582]
mat_Sqrt:  [[0.15]]
grads:  [-0.1663113]
Stock Position:  -0.16631130191572438
Bond Position:  [17.49913147]


portfolio before change:  [0.75280796]
curr_Stock_Price:  100.69921311985405
curr_Factors:  [100.69921312]
mat_Sqrt:  [[0.15]]
grads:  [-0.04586546]
Stock Position:  -0.04586546426487323
Bond Position:  [5.37142412]


portfolio before change:  [0.75676693]
curr_Stock_Price:  100.62021577885184
curr_Factors:  [100.62021578]
mat_Sqrt:  [[0.15]]
grads:  [-0.01211605]
Stock Position:  -0.012116050043337682
Bond Position:  [1.9758865]


portfolio before change:  [0.74969277]
curr_Stock_Price:  101.21427557294598
curr_Factors:  [101.21427557]
mat_Sqrt:  [[0.15]]
grads:  [-0.04611446]
Stock Position:  -0.04611445745784395
Bond Position:  [5.41713418]


portfolio before change:  [0.74428892]
curr_Stock_Price:  101.33880125926811
curr_Factors:  [101.33880126]
mat_Sqrt:  [[0.15]]
grads:  [-0.22390913]
Stock Position:  -0.22390912587124984
Bond Position:  [23.43497133]


portfolio before change:  [0.75803093]
curr_Stock_Price:  101.28396974735949
curr_Factors:  [101.28396975]
mat_Sqrt:  [[0.15]]
grads:  [0.0833008]
Stock Position:  0.08330080109103674
Bond Position:  [-7.67900489]


portfolio before change:  [0.79305349]
curr_Stock_Price:  101.71016626035656
curr_Factors:  [101.71016626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927098]
Stock Position:  -0.039270979577593755
Bond Position:  [4.78731135]


portfolio before change:  [0.78374367]
curr_Stock_Price:  101.95485166622704
curr_Factors:  [101.95485167]
mat_Sqrt:  [[0.15]]
grads:  [-0.06654893]
Stock Position:  -0.06654892972680646
Bond Position:  [7.56872992]


portfolio before change:  [0.75920295]
curr_Stock_Price:  102.33072212075969
curr_Factors:  [102.33072212]
mat_Sqrt:  [[0.15]]
grads:  [0.12619802]
Stock Position:  0.12619802470825583
Bond Position:  [-12.15473205]


portfolio before change:  [0.55807672]
curr_Stock_Price:  100.74300684714709
curr_Factors:  [100.74300685]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011817]
Stock Position:  -0.020118167156471686
Bond Position:  [2.58484138]


portfolio before change:  [0.57240328]
curr_Stock_Price:  100.03891708309428
curr_Factors:  [100.03891708]
mat_Sqrt:  [[0.15]]
grads:  [0.06526658]
Stock Position:  0.06526657594286651
Bond Position:  [-5.9567943]


portfolio before change:  [0.58326677]
curr_Stock_Price:  100.21106962370663
curr_Factors:  [100.21106962]
mat_Sqrt:  [[0.15]]
grads:  [-0.01171799]
Stock Position:  -0.011717989340648296
Bond Position:  [1.75753902]


portfolio before change:  [0.58232177]
curr_Stock_Price:  100.30108951083444
curr_Factors:  [100.30108951]
mat_Sqrt:  [[0.15]]
grads:  [0.0920719]
Stock Position:  0.0920718984657879
Bond Position:  [-8.65258996]


portfolio before change:  [0.62552681]
curr_Stock_Price:  100.77621646053296
curr_Factors:  [100.77621646]
mat_Sqrt:  [[0.15]]
grads:  [0.33034804]
Stock Position:  0.33034804263472434
Bond Position:  [-32.66569905]


portfolio before change:  [0.76227957]
curr_Stock_Price:  101.19636252178285
curr_Factors:  [101.19636252]
mat_Sqrt:  [[0.15]]
grads:  [-0.09411935]
Stock Position:  -0.09411935112317107
Bond Position:  [10.28681554]


portfolio before change:  [0.72945424]
curr_Stock_Price:  101.55195645064286
curr_Factors:  [101.55195645]
mat_Sqrt:  [[0.15]]
grads:  [0.12504056]
Stock Position:  0.12504055617284082
Bond Position:  [-11.96865887]


portfolio before change:  [0.66186464]
curr_Stock_Price:  101.01739757577715
curr_Factors:  [101.01739758]
mat_Sqrt:  [[0.15]]
grads:  [0.01230458]
Stock Position:  0.012304581287190504
Bond Position:  [-0.58111214]


portfolio before change:  [0.65963332]
curr_Stock_Price:  100.8390088012563
curr_Factors:  [100.8390088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02661854]
Stock Position:  -0.026618543592911704
Bond Position:  [3.34382087]


portfolio before change:  [0.65194196]
curr_Stock_Price:  101.13580779124752
curr_Factors:  [101.13580779]
mat_Sqrt:  [[0.15]]
grads:  [0.02984788]
Stock Position:  0.02984788368739932
Bond Position:  [-2.36674787]


portfolio before change:  [0.63615082]
curr_Stock_Price:  100.61171005526158
curr_Factors:  [100.61171006]
mat_Sqrt:  [[0.15]]
grads:  [0.10153182]
Stock Position:  0.1015318237954163
Bond Position:  [-9.57913959]


portfolio before change:  [0.66600975]
curr_Stock_Price:  100.91169125708872
curr_Factors:  [100.91169126]
mat_Sqrt:  [[0.15]]
grads:  [0.13063483]
Stock Position:  0.13063482908800314
Bond Position:  [-12.51657179]


portfolio before change:  [0.70722094]
curr_Stock_Price:  101.23314845799405
curr_Factors:  [101.23314846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01585151]
Stock Position:  -0.015851507386209527
Bond Position:  [2.31191894]


portfolio before change:  [0.69948221]
curr_Stock_Price:  101.7304658377591
curr_Factors:  [101.73046584]
mat_Sqrt:  [[0.15]]
grads:  [0.05108427]
Stock Position:  0.05108427416087201
Bond Position:  [-4.4973448]


portfolio before change:  [0.76990904]
curr_Stock_Price:  103.11460854986514
curr_Factors:  [103.11460855]
mat_Sqrt:  [[0.15]]
grads:  [0.18372559]
Stock Position:  0.18372559047161827
Bond Position:  [-18.1748833]


portfolio before change:  [0.91384601]
curr_Stock_Price:  103.90422597405875
curr_Factors:  [103.90422597]
mat_Sqrt:  [[0.15]]
grads:  [0.17778125]
Stock Position:  0.1777812465007295
Bond Position:  [-17.5583768]


portfolio before change:  [1.01504662]
curr_Stock_Price:  104.47964125149825
curr_Factors:  [104.47964125]
mat_Sqrt:  [[0.15]]
grads:  [0.03071058]
Stock Position:  0.030710576464136795
Bond Position:  [-2.19358339]


portfolio before change:  [1.0034541]
curr_Stock_Price:  104.10662911020906
curr_Factors:  [104.10662911]
mat_Sqrt:  [[0.15]]
grads:  [-0.06090452]
Stock Position:  -0.06090451894441888
Bond Position:  [7.34401826]


portfolio before change:  [0.98949483]
curr_Stock_Price:  104.34336489625352
curr_Factors:  [104.3433649]
mat_Sqrt:  [[0.15]]
grads:  [0.0288731]
Stock Position:  0.02887309898311992
Bond Position:  [-2.02322147]


portfolio before change:  [1.01132062]
curr_Stock_Price:  105.10366582893761
curr_Factors:  [105.10366583]
mat_Sqrt:  [[0.15]]
grads:  [0.10557891]
Stock Position:  0.10557890516225556
Bond Position:  [-10.08540934]


portfolio before change:  [1.09980547]
curr_Stock_Price:  105.94772845298367
curr_Factors:  [105.94772845]
mat_Sqrt:  [[0.15]]
grads:  [0.11550786]
Stock Position:  0.11550786056603086
Bond Position:  [-11.13798997]


portfolio before change:  [1.09297178]
curr_Stock_Price:  105.89459313063888
curr_Factors:  [105.89459313]
mat_Sqrt:  [[0.15]]
grads:  [-0.07696322]
Stock Position:  -0.07696321578057233
Bond Position:  [9.2429602]


portfolio before change:  [1.10898321]
curr_Stock_Price:  105.69405932253503
curr_Factors:  [105.69405932]
mat_Sqrt:  [[0.15]]
grads:  [0.02577109]
Stock Position:  0.025771093319350645
Bond Position:  [-1.61486826]


portfolio before change:  [1.10364684]
curr_Stock_Price:  105.49090764029492
curr_Factors:  [105.49090764]
mat_Sqrt:  [[0.15]]
grads:  [-0.10714315]
Stock Position:  -0.1071431525628918
Bond Position:  [12.40627525]


portfolio before change:  [1.23523584]
curr_Stock_Price:  104.2699841966601
curr_Factors:  [104.2699842]
mat_Sqrt:  [[0.15]]
grads:  [-0.06613061]
Stock Position:  -0.06613061093359522
Bond Position:  [8.1306736]


portfolio before change:  [1.23700389]
curr_Stock_Price:  104.2509329136163
curr_Factors:  [104.25093291]
mat_Sqrt:  [[0.15]]
grads:  [-0.07576876]
Stock Position:  -0.07576876203300525
Bond Position:  [9.13596802]


portfolio before change:  [1.19593326]
curr_Stock_Price:  104.8005215460561
curr_Factors:  [104.80052155]
mat_Sqrt:  [[0.15]]
grads:  [0.00031776]
Stock Position:  0.0003177555707266818
Bond Position:  [1.16263231]


portfolio before change:  [1.19576667]
curr_Stock_Price:  104.04756651047917
curr_Factors:  [104.04756651]
mat_Sqrt:  [[0.15]]
grads:  [-0.19255991]
Stock Position:  -0.19255991279930493
Bond Position:  [21.23115701]


portfolio before change:  [1.15935327]
curr_Stock_Price:  104.24355946958187
curr_Factors:  [104.24355947]
mat_Sqrt:  [[0.15]]
grads:  [0.02339614]
Stock Position:  0.023396137561459942
Bond Position:  [-1.27954338]


portfolio before change:  [1.15693974]
curr_Stock_Price:  104.14381818575842
curr_Factors:  [104.14381819]
mat_Sqrt:  [[0.15]]
grads:  [0.04365671]
Stock Position:  0.043656711482905355
Bond Position:  [-3.38963688]


portfolio before change:  [1.16284682]
curr_Stock_Price:  104.2839786552468
curr_Factors:  [104.28397866]
mat_Sqrt:  [[0.15]]
grads:  [-0.08115945]
Stock Position:  -0.08115945439755376
Bond Position:  [9.62647763]


portfolio before change:  [1.16097876]
curr_Stock_Price:  104.31440934476142
curr_Factors:  [104.31440934]
mat_Sqrt:  [[0.15]]
grads:  [0.05980461]
Stock Position:  0.05980460583437895
Bond Position:  [-5.07750337]


portfolio before change:  [1.22805779]
curr_Stock_Price:  105.44135238971619
curr_Factors:  [105.44135239]
mat_Sqrt:  [[0.15]]
grads:  [-0.02973144]
Stock Position:  -0.029731440822688786
Bond Position:  [4.36298112]


portfolio before change:  [1.23950618]
curr_Stock_Price:  105.06546422987375
curr_Factors:  [105.06546423]
mat_Sqrt:  [[0.15]]
grads:  [0.0773481]
Stock Position:  0.0773481037928331
Bond Position:  [-6.88710825]


portfolio before change:  [1.25647297]
curr_Stock_Price:  105.29038566870665
curr_Factors:  [105.29038567]
mat_Sqrt:  [[0.15]]
grads:  [0.07041653]
Stock Position:  0.07041653191558868
Bond Position:  [-6.15771083]


portfolio before change:  [1.28397107]
curr_Stock_Price:  105.68635758848673
curr_Factors:  [105.68635759]
mat_Sqrt:  [[0.15]]
grads:  [-0.02042636]
Stock Position:  -0.020426363486434704
Bond Position:  [3.44275903]


portfolio before change:  [1.2861815]
curr_Stock_Price:  105.58867747052041
curr_Factors:  [105.58867747]
mat_Sqrt:  [[0.15]]
grads:  [0.09347546]
Stock Position:  0.0934754604470428
Bond Position:  [-8.58376874]


portfolio before change:  [1.29211371]
curr_Stock_Price:  105.65787968955225
curr_Factors:  [105.65787969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00975955]
Stock Position:  -0.009759549082409096
Bond Position:  [2.32328697]


portfolio before change:  [1.29165373]
curr_Stock_Price:  105.71988940812858
curr_Factors:  [105.71988941]
mat_Sqrt:  [[0.15]]
grads:  [0.13200393]
Stock Position:  0.1320039317426057
Bond Position:  [-12.66378733]


portfolio before change:  [1.2354481]
curr_Stock_Price:  105.3000980053945
curr_Factors:  [105.30009801]
mat_Sqrt:  [[0.15]]
grads:  [0.09124096]
Stock Position:  0.0912409589929449
Bond Position:  [-8.37223382]


portfolio before change:  [1.30505032]
curr_Stock_Price:  106.06867280768864
curr_Factors:  [106.06867281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426374]
Stock Position:  -0.042637404318462864
Bond Position:  [5.82754321]


portfolio before change:  [1.30820216]
curr_Stock_Price:  106.00329345558266
curr_Factors:  [106.00329346]
mat_Sqrt:  [[0.15]]
grads:  [-0.33240374]
Stock Position:  -0.33240374432051106
Bond Position:  [36.54409382]


portfolio before change:  [1.01034074]
curr_Stock_Price:  106.90624809915224
curr_Factors:  [106.9062481]
mat_Sqrt:  [[0.15]]
grads:  [-0.12872818]
Stock Position:  -0.1287281817376981
Bond Position:  [14.77218767]


portfolio before change:  [0.9467125]
curr_Stock_Price:  107.40770418034606
curr_Factors:  [107.40770418]
mat_Sqrt:  [[0.15]]
grads:  [-0.01391845]
Stock Position:  -0.013918453403350352
Bond Position:  [2.44166162]


portfolio before change:  [0.94838677]
curr_Stock_Price:  107.29837704001432
curr_Factors:  [107.29837704]
mat_Sqrt:  [[0.15]]
grads:  [-0.02426508]
Stock Position:  -0.024265078869287294
Bond Position:  [3.55199035]


portfolio before change:  [0.94176333]
curr_Stock_Price:  107.58048794431433
curr_Factors:  [107.58048794]
mat_Sqrt:  [[0.15]]
grads:  [-0.0884909]
Stock Position:  -0.08849089720314961
Bond Position:  [10.46165723]


portfolio before change:  [0.88765081]
curr_Stock_Price:  108.19938094788476
curr_Factors:  [108.19938095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786956]
Stock Position:  -0.007869563148013466
Bond Position:  [1.73913267]


portfolio before change:  [0.88583762]
curr_Stock_Price:  108.44359915513816
curr_Factors:  [108.44359916]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927162]
Stock Position:  -0.019271615785799667
Bond Position:  [2.975721]


portfolio before change:  [0.89475579]
curr_Stock_Price:  107.99048795668354
curr_Factors:  [107.99048796]
mat_Sqrt:  [[0.15]]
grads:  [-0.05102645]
Stock Position:  -0.051026450567736754
Bond Position:  [6.40512709]


portfolio before change:  [0.94068954]
curr_Stock_Price:  107.09813878737394
curr_Factors:  [107.09813879]
mat_Sqrt:  [[0.15]]
grads:  [-0.01956243]
Stock Position:  -0.019562426985191447
Bond Position:  [3.03578906]


portfolio before change:  [0.9449874]
curr_Stock_Price:  106.88813795156364
curr_Factors:  [106.88813795]
mat_Sqrt:  [[0.15]]
grads:  [-0.11775991]
Stock Position:  -0.11775991258827202
Bond Position:  [13.53212519]


portfolio before change:  [0.94250347]
curr_Stock_Price:  106.91641347966048
curr_Factors:  [106.91641348]
mat_Sqrt:  [[0.15]]
grads:  [0.00011495]
Stock Position:  0.00011495136420355809
Bond Position:  [0.93021328]


portfolio before change:  [0.94254604]
curr_Stock_Price:  106.7809673005546
curr_Factors:  [106.7809673]
mat_Sqrt:  [[0.15]]
grads:  [0.0051523]
Stock Position:  0.0051522975543694585
Bond Position:  [0.39237872]


portfolio before change:  [0.94444874]
curr_Stock_Price:  107.14549920442747
curr_Factors:  [107.1454992]
mat_Sqrt:  [[0.15]]
grads:  [0.16782146]
Stock Position:  0.16782145714336402
Bond Position:  [-17.03686507]


portfolio before change:  [1.00255721]
curr_Stock_Price:  107.49809600875973
curr_Factors:  [107.49809601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01399235]
Stock Position:  -0.013992348166831278
Bond Position:  [2.506708]


portfolio before change:  [1.00668159]
curr_Stock_Price:  107.21453330872298
curr_Factors:  [107.21453331]
mat_Sqrt:  [[0.15]]
grads:  [0.1230563]
Stock Position:  0.12305630340247661
Bond Position:  [-12.18674255]


portfolio before change:  [1.05030679]
curr_Stock_Price:  107.5752372167585
curr_Factors:  [107.57523722]
mat_Sqrt:  [[0.15]]
grads:  [0.05811832]
Stock Position:  0.05811831674313733
Bond Position:  [-5.20178492]


portfolio before change:  [1.05292268]
curr_Stock_Price:  107.62584121708294
curr_Factors:  [107.62584122]
mat_Sqrt:  [[0.15]]
grads:  [0.07693705]
Stock Position:  0.0769370549304689
Bond Position:  [-7.22749257]


portfolio before change:  [1.09249279]
curr_Stock_Price:  108.14603063767412
curr_Factors:  [108.14603064]
mat_Sqrt:  [[0.15]]
grads:  [0.05132486]
Stock Position:  0.05132486234569889
Bond Position:  [-4.45808734]


portfolio before change:  [1.11681928]
curr_Stock_Price:  108.62543039709422
curr_Factors:  [108.6254304]
mat_Sqrt:  [[0.15]]
grads:  [-0.09635051]
Stock Position:  -0.09635051323465595
Bond Position:  [11.58293525]


portfolio before change:  [1.07114061]
curr_Stock_Price:  109.10703268106701
curr_Factors:  [109.10703268]
mat_Sqrt:  [[0.15]]
grads:  [-0.37495874]
Stock Position:  -0.37495873741025665
Bond Position:  [41.98177583]


portfolio before change:  [0.69133323]
curr_Stock_Price:  110.12696175316081
curr_Factors:  [110.12696175]
mat_Sqrt:  [[0.15]]
grads:  [0.00239045]
Stock Position:  0.0023904461258867802
Bond Position:  [0.42808067]


portfolio before change:  [0.69167347]
curr_Stock_Price:  110.25810056985543
curr_Factors:  [110.25810057]
mat_Sqrt:  [[0.15]]
grads:  [-0.10563723]
Stock Position:  -0.10563722687572781
Bond Position:  [12.33903346]


portfolio before change:  [0.72635307]
curr_Stock_Price:  109.93711159480159
curr_Factors:  [109.93711159]
mat_Sqrt:  [[0.15]]
grads:  [-0.21250934]
Stock Position:  -0.2125093377361911
Bond Position:  [24.08901585]


portfolio before change:  [0.82516739]
curr_Stock_Price:  109.47920839255346
curr_Factors:  [109.47920839]
mat_Sqrt:  [[0.15]]
grads:  [-0.04421856]
Stock Position:  -0.04421855920358818
Bond Position:  [5.66618024]


portfolio before change:  [0.76910284]
curr_Stock_Price:  110.75511372469643
curr_Factors:  [110.75511372]
mat_Sqrt:  [[0.15]]
grads:  [0.16833706]
Stock Position:  0.1683370632077592
Bond Position:  [-17.87508774]


portfolio before change:  [0.79625089]
curr_Stock_Price:  110.92302255035463
curr_Factors:  [110.92302255]
mat_Sqrt:  [[0.15]]
grads:  [0.72415746]
Stock Position:  0.7241574562805597
Bond Position:  [-79.52948296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.31475477]
Stock Price:  110.26498144202665
PL:  [-9.95022668]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38271231e-02]
 [ 2.56452889e-02]
 [ 9.49889543e-03]
 [-8.98741624e-03]
 [ 1.09584042e-02]
 [-1.35297094e-02]
 [ 1.78601053e-03]
 [-5.87845491e-03]
 [-1.15870761e-02]
 [-1.25005467e-02]
 [ 1.47445427e-02]
 [-5.07584884e-03]
 [-1.11350839e-03]
 [ 2.17765950e-03]
 [-1.82669966e-03]
 [ 1.20495426e-02]
 [-2.42743682e-03]
 [-1.21081763e-02]
 [ 2.45430343e-02]
 [-3.87354829e-03]
 [-1.57393637e-02]
 [ 5.76324149e-03]
 [ 1.42550033e-02]
 [ 1.66949231e-02]
 [ 8.11647334e-03]
 [ 4.43276006e-03]
 [ 5.13662854e-04]
 [ 1.27081301e-02]
 [-3.63662873e-03]
 [ 4.15610926e-02]
 [-6.59436167e-03]
 [ 2.55634118e-02]
 [ 1.29026408e-02]
 [-1.93173568e-02]
 [-1.95403374e-02]
 [-6.88735369e-02]
 [ 1.64208301e-02]
 [-6.21278424e-03]
 [ 4.08290452e-02]
 [ 4.94940846e-03]
 [ 6.83943501e-03]
 [ 3.49084878e-02]
 [-3.33731777e-03]
 [ 3.22804926e-03]
 [-1.26979165e-02]
 [ 1.77846944e-02]
 [ 9.97723561e-03]
 [ 5.31906680e-03]
 [-8.24661396e-03]
 [ 4.62964974e-05]
 [-2.78700134e-03]
 [-1.54476450e-03]
 [-8.29072941e-04]
 [ 4.12545714e-03]
 [-1.57855572e-02]
 [-5.28424421e-03]
 [-2.37138397e-03]
 [ 1.34809865e-02]
 [ 6.68238957e-03]
 [-2.70733121e-03]
 [-5.14307214e-03]
 [-1.10910579e-03]
 [-2.80397832e-03]
 [-4.01917361e-03]
 [ 1.82083150e-02]
 [ 7.00925548e-03]
 [ 2.00717566e-02]
 [-3.13640129e-03]
 [ 5.73981748e-03]
 [ 2.31626610e-02]
 [ 3.52154851e-03]
 [-1.53739883e-02]
 [-5.77190687e-03]
 [ 1.72610190e-03]
 [ 9.31018076e-03]
 [ 1.07937017e-03]
 [-1.55101836e-03]
 [-6.48222463e-03]
 [-2.32568678e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.95514712]
curr_Stock_Price:  99.68275295029292
curr_Factors:  [99.68275295]
mat_Sqrt:  [[0.15]]
grads:  [-0.09218082]
Stock Position:  -0.09218082084606698
Bond Position:  [4.23369087]


portfolio before change:  [-5.03586666]
curr_Stock_Price:  100.5612887125645
curr_Factors:  [100.56128871]
mat_Sqrt:  [[0.15]]
grads:  [0.17096859]
Stock Position:  0.17096859235259923
Bond Position:  [-22.22868863]


portfolio before change:  [-5.08600216]
curr_Stock_Price:  100.27617107566583
curr_Factors:  [100.27617108]
mat_Sqrt:  [[0.15]]
grads:  [0.06332597]
Stock Position:  0.06332596951550178
Bond Position:  [-11.43608791]


portfolio before change:  [-5.14352971]
curr_Stock_Price:  99.37902297967165
curr_Factors:  [99.37902298]
mat_Sqrt:  [[0.15]]
grads:  [-0.05991611]
Stock Position:  -0.059916108278578635
Bond Position:  [0.81087459]


portfolio before change:  [-5.10195113]
curr_Stock_Price:  98.68592235071581
curr_Factors:  [98.68592235]
mat_Sqrt:  [[0.15]]
grads:  [0.07305603]
Stock Position:  0.07305602787894223
Bond Position:  [-12.31155263]


portfolio before change:  [-5.07717281]
curr_Stock_Price:  99.03562407015781
curr_Factors:  [99.03562407]
mat_Sqrt:  [[0.15]]
grads:  [-0.09019806]
Stock Position:  -0.09019806260338069
Bond Position:  [3.85564861]


portfolio before change:  [-5.17357511]
curr_Stock_Price:  100.10708037687883
curr_Factors:  [100.10708038]
mat_Sqrt:  [[0.15]]
grads:  [0.01190674]
Stock Position:  0.011906736885113692
Bond Position:  [-6.36552377]


portfolio before change:  [-5.17638774]
curr_Stock_Price:  99.9042730315107
curr_Factors:  [99.90427303]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391897]
Stock Position:  -0.039189699410797564
Bond Position:  [-1.26116931]


portfolio before change:  [-5.16300295]
curr_Stock_Price:  99.56072312868444
curr_Factors:  [99.56072313]
mat_Sqrt:  [[0.15]]
grads:  [-0.07724717]
Stock Position:  -0.07724717404306211
Bond Position:  [2.52778156]


portfolio before change:  [-5.1131028]
curr_Stock_Price:  98.91678817447148
curr_Factors:  [98.91678817]
mat_Sqrt:  [[0.15]]
grads:  [-0.08333698]
Stock Position:  -0.08333697777879001
Bond Position:  [3.13032338]


portfolio before change:  [-5.18195725]
curr_Stock_Price:  99.7453531056918
curr_Factors:  [99.74535311]
mat_Sqrt:  [[0.15]]
grads:  [0.09829695]
Stock Position:  0.09829695161679215
Bond Position:  [-14.98662139]


portfolio before change:  [-5.18996225]
curr_Stock_Price:  99.67344536254059
curr_Factors:  [99.67344536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03383899]
Stock Position:  -0.033838992270513624
Bond Position:  [-1.8171133]


portfolio before change:  [-5.18691227]
curr_Stock_Price:  99.57995700138589
curr_Factors:  [99.579957]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742339]
Stock Position:  -0.007423389285640415
Bond Position:  [-4.44769149]


portfolio before change:  [-5.18065397]
curr_Stock_Price:  98.699456710827
curr_Factors:  [98.69945671]
mat_Sqrt:  [[0.15]]
grads:  [0.01451773]
Stock Position:  0.014517730025101414
Bond Position:  [-6.61354603]


portfolio before change:  [-5.17532769]
curr_Stock_Price:  99.0948101367004
curr_Factors:  [99.09481014]
mat_Sqrt:  [[0.15]]
grads:  [-0.012178]
Stock Position:  -0.012177997760089375
Bond Position:  [-3.96855132]


portfolio before change:  [-5.18140473]
curr_Stock_Price:  99.57345990166213
curr_Factors:  [99.5734599]
mat_Sqrt:  [[0.15]]
grads:  [0.08033028]
Stock Position:  0.08033028413909316
Bond Position:  [-13.18016906]


portfolio before change:  [-5.27456057]
curr_Stock_Price:  98.4240546467558
curr_Factors:  [98.42405465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01618291]
Stock Position:  -0.01618291214217647
Bond Position:  [-3.68177274]


portfolio before change:  [-5.2639617]
curr_Stock_Price:  97.75489316900641
curr_Factors:  [97.75489317]
mat_Sqrt:  [[0.15]]
grads:  [-0.08072118]
Stock Position:  -0.08072117555472567
Bond Position:  [2.62692819]


portfolio before change:  [-5.22773228]
curr_Stock_Price:  97.30810538564303
curr_Factors:  [97.30810539]
mat_Sqrt:  [[0.15]]
grads:  [0.16362023]
Stock Position:  0.1636202289214881
Bond Position:  [-21.14930676]


portfolio before change:  [-5.32081034]
curr_Stock_Price:  96.74731784740723
curr_Factors:  [96.74731785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582366]
Stock Position:  -0.02582365523715039
Bond Position:  [-2.82244096]


portfolio before change:  [-5.33543934]
curr_Stock_Price:  97.3069828101498
curr_Factors:  [97.30698281]
mat_Sqrt:  [[0.15]]
grads:  [-0.10492909]
Stock Position:  -0.10492909108507274
Bond Position:  [4.87489392]


portfolio before change:  [-5.29736527]
curr_Stock_Price:  96.94703134273202
curr_Factors:  [96.94703134]
mat_Sqrt:  [[0.15]]
grads:  [0.03842161]
Stock Position:  0.03842160996374599
Bond Position:  [-9.0222263]


portfolio before change:  [-5.3236683]
curr_Stock_Price:  96.27711880086687
curr_Factors:  [96.2771188]
mat_Sqrt:  [[0.15]]
grads:  [0.09503336]
Stock Position:  0.09503335510851522
Bond Position:  [-14.47320592]


portfolio before change:  [-5.26955721]
curr_Stock_Price:  96.85602801395464
curr_Factors:  [96.85602801]
mat_Sqrt:  [[0.15]]
grads:  [0.11129949]
Stock Position:  0.11129948702463567
Bond Position:  [-16.04958345]


portfolio before change:  [-5.30806358]
curr_Stock_Price:  96.51907016599847
curr_Factors:  [96.51907017]
mat_Sqrt:  [[0.15]]
grads:  [0.05410982]
Stock Position:  0.05410982226981702
Bond Position:  [-10.53069331]


portfolio before change:  [-5.29840513]
curr_Stock_Price:  96.7097312344378
curr_Factors:  [96.70973123]
mat_Sqrt:  [[0.15]]
grads:  [0.02955173]
Stock Position:  0.029551733716644615
Bond Position:  [-8.15634536]


portfolio before change:  [-5.28518008]
curr_Stock_Price:  97.1745038278121
curr_Factors:  [97.17450383]
mat_Sqrt:  [[0.15]]
grads:  [0.00342442]
Stock Position:  0.003424419026141097
Bond Position:  [-5.6179463]


portfolio before change:  [-5.28708499]
curr_Stock_Price:  96.72077069705212
curr_Factors:  [96.7207707]
mat_Sqrt:  [[0.15]]
grads:  [0.08472087]
Stock Position:  0.08472086708258011
Bond Position:  [-13.48135255]


portfolio before change:  [-5.30135322]
curr_Stock_Price:  96.5623017875612
curr_Factors:  [96.56230179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424419]
Stock Position:  -0.024244191536009138
Bond Position:  [-2.96027828]


portfolio before change:  [-5.30827292]
curr_Stock_Price:  96.8400870058447
curr_Factors:  [96.84008701]
mat_Sqrt:  [[0.15]]
grads:  [0.27707395]
Stock Position:  0.27707395060548695
Bond Position:  [-32.14013841]


portfolio before change:  [-5.52577943]
curr_Stock_Price:  96.06232464909183
curr_Factors:  [96.06232465]
mat_Sqrt:  [[0.15]]
grads:  [-0.04396241]
Stock Position:  -0.043962411135620764
Bond Position:  [-1.30264802]


portfolio before change:  [-5.50782418]
curr_Stock_Price:  95.65204984490408
curr_Factors:  [95.65204984]
mat_Sqrt:  [[0.15]]
grads:  [0.17042275]
Stock Position:  0.17042274548362105
Bond Position:  [-21.80910913]


portfolio before change:  [-5.44758368]
curr_Stock_Price:  96.01352518524536
curr_Factors:  [96.01352519]
mat_Sqrt:  [[0.15]]
grads:  [0.08601761]
Stock Position:  0.08601760526730672
Bond Position:  [-13.70643719]


portfolio before change:  [-5.49843038]
curr_Stock_Price:  95.43236480937097
curr_Factors:  [95.43236481]
mat_Sqrt:  [[0.15]]
grads:  [-0.12878238]
Stock Position:  -0.12878237839531653
Bond Position:  [6.79157654]


portfolio before change:  [-5.36619858]
curr_Stock_Price:  94.40887605174835
curr_Factors:  [94.40887605]
mat_Sqrt:  [[0.15]]
grads:  [-0.13026892]
Stock Position:  -0.130268915714763
Bond Position:  [6.93234334]


portfolio before change:  [-5.37883394]
curr_Stock_Price:  94.50919660377055
curr_Factors:  [94.5091966]
mat_Sqrt:  [[0.15]]
grads:  [-0.45915691]
Stock Position:  -0.4591569124271752
Bond Position:  [38.01571697]


portfolio before change:  [-5.42547113]
curr_Stock_Price:  94.61594279341531
curr_Factors:  [94.61594279]
mat_Sqrt:  [[0.15]]
grads:  [0.1094722]
Stock Position:  0.10947220098875307
Bond Position:  [-15.78328664]


portfolio before change:  [-5.39134624]
curr_Stock_Price:  94.93667607957113
curr_Factors:  [94.93667608]
mat_Sqrt:  [[0.15]]
grads:  [-0.04141856]
Stock Position:  -0.04141856157890377
Bond Position:  [-1.45920568]


portfolio before change:  [-5.40480391]
curr_Stock_Price:  95.25939290576808
curr_Factors:  [95.25939291]
mat_Sqrt:  [[0.15]]
grads:  [0.27219363]
Stock Position:  0.27219363466377927
Bond Position:  [-31.3338043]


portfolio before change:  [-5.2561942]
curr_Stock_Price:  95.81255843374676
curr_Factors:  [95.81255843]
mat_Sqrt:  [[0.15]]
grads:  [0.03299606]
Stock Position:  0.03299605642131343
Bond Position:  [-8.41763078]


portfolio before change:  [-5.25676835]
curr_Stock_Price:  95.81110276044961
curr_Factors:  [95.81110276]
mat_Sqrt:  [[0.15]]
grads:  [0.04559623]
Stock Position:  0.04559623342120286
Bond Position:  [-9.62539376]


portfolio before change:  [-5.23440596]
curr_Stock_Price:  96.314740683593
curr_Factors:  [96.31474068]
mat_Sqrt:  [[0.15]]
grads:  [0.23272325]
Stock Position:  0.23272325225585483
Bond Position:  [-27.64908566]


portfolio before change:  [-5.08480543]
curr_Stock_Price:  96.96499222256367
curr_Factors:  [96.96499222]
mat_Sqrt:  [[0.15]]
grads:  [-0.02224879]
Stock Position:  -0.02224878513746432
Bond Position:  [-2.92745215]


portfolio before change:  [-5.10232646]
curr_Stock_Price:  97.74427309201941
curr_Factors:  [97.74427309]
mat_Sqrt:  [[0.15]]
grads:  [0.02152033]
Stock Position:  0.02152032838948693
Bond Position:  [-7.20581531]


portfolio before change:  [-5.10499861]
curr_Stock_Price:  97.64103211111703
curr_Factors:  [97.64103211]
mat_Sqrt:  [[0.15]]
grads:  [-0.08465278]
Stock Position:  -0.08465277682594664
Bond Position:  [3.16058589]


portfolio before change:  [-5.08755414]
curr_Stock_Price:  97.43729479536982
curr_Factors:  [97.4372948]
mat_Sqrt:  [[0.15]]
grads:  [0.11856463]
Stock Position:  0.11856462964704953
Bond Position:  [-16.64017091]


portfolio before change:  [-5.10014511]
curr_Stock_Price:  97.33987179452623
curr_Factors:  [97.33987179]
mat_Sqrt:  [[0.15]]
grads:  [0.0665149]
Stock Position:  0.06651490408808275
Bond Position:  [-11.57469734]


portfolio before change:  [-5.13632778]
curr_Stock_Price:  96.80676966848289
curr_Factors:  [96.80676967]
mat_Sqrt:  [[0.15]]
grads:  [0.03546045]
Stock Position:  0.03546044536104132
Bond Position:  [-8.56913895]


portfolio before change:  [-5.15852885]
curr_Stock_Price:  96.19579369130143
curr_Factors:  [96.19579369]
mat_Sqrt:  [[0.15]]
grads:  [-0.05497743]
Stock Position:  -0.05497742639473058
Bond Position:  [0.13006831]


portfolio before change:  [-5.11730471]
curr_Stock_Price:  95.44610387905209
curr_Factors:  [95.44610388]
mat_Sqrt:  [[0.15]]
grads:  [0.00030864]
Stock Position:  0.0003086433163277089
Bond Position:  [-5.14676351]


portfolio before change:  [-5.11753689]
curr_Stock_Price:  95.73608315045044
curr_Factors:  [95.73608315]
mat_Sqrt:  [[0.15]]
grads:  [-0.01858001]
Stock Position:  -0.018580008961294935
Bond Position:  [-3.33875961]


portfolio before change:  [-5.12629536]
curr_Stock_Price:  96.19624412544863
curr_Factors:  [96.19624413]
mat_Sqrt:  [[0.15]]
grads:  [-0.01029843]
Stock Position:  -0.01029843003285825
Bond Position:  [-4.13562507]


portfolio before change:  [-5.11348381]
curr_Stock_Price:  94.92711476413794
curr_Factors:  [94.92711476]
mat_Sqrt:  [[0.15]]
grads:  [-0.00552715]
Stock Position:  -0.005527152941846023
Bond Position:  [-4.58880713]


portfolio before change:  [-5.11156962]
curr_Stock_Price:  94.52889927828951
curr_Factors:  [94.52889928]
mat_Sqrt:  [[0.15]]
grads:  [0.02750305]
Stock Position:  0.027503047623003558
Bond Position:  [-7.71140244]


portfolio before change:  [-5.1037242]
curr_Stock_Price:  94.8316801929533
curr_Factors:  [94.83168019]
mat_Sqrt:  [[0.15]]
grads:  [-0.10523705]
Stock Position:  -0.10523704810714611
Bond Position:  [4.87608189]


portfolio before change:  [-5.11663795]
curr_Stock_Price:  94.95728721458136
curr_Factors:  [94.95728721]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522829]
Stock Position:  -0.03522829470028773
Bond Position:  [-1.77145465]


portfolio before change:  [-5.13598545]
curr_Stock_Price:  95.503347804964
curr_Factors:  [95.5033478]
mat_Sqrt:  [[0.15]]
grads:  [-0.01580923]
Stock Position:  -0.01580922645882446
Bond Position:  [-3.6261514]


portfolio before change:  [-5.13258048]
curr_Stock_Price:  95.27363332001592
curr_Factors:  [95.27363332]
mat_Sqrt:  [[0.15]]
grads:  [0.08987324]
Stock Position:  0.08987324307638453
Bond Position:  [-13.69513089]


portfolio before change:  [-5.13334232]
curr_Stock_Price:  95.27468068866219
curr_Factors:  [95.27468069]
mat_Sqrt:  [[0.15]]
grads:  [0.04454926]
Stock Position:  0.04454926377371261
Bond Position:  [-9.37775921]


portfolio before change:  [-5.12035312]
curr_Stock_Price:  95.57940707055756
curr_Factors:  [95.57940707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01804887]
Stock Position:  -0.018048874755602247
Bond Position:  [-3.39525237]


portfolio before change:  [-5.14316572]
curr_Stock_Price:  96.83158423838928
curr_Factors:  [96.83158424]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428715]
Stock Position:  -0.03428714761128436
Bond Position:  [-1.82308689]


portfolio before change:  [-5.14844025]
curr_Stock_Price:  96.98209504895864
curr_Factors:  [96.98209505]
mat_Sqrt:  [[0.15]]
grads:  [-0.00739404]
Stock Position:  -0.007394038613499106
Bond Position:  [-4.43135089]


portfolio before change:  [-5.14361124]
curr_Stock_Price:  96.291542312135
curr_Factors:  [96.29154231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01869319]
Stock Position:  -0.018693188783406752
Bond Position:  [-3.34361526]


portfolio before change:  [-5.13133718]
curr_Stock_Price:  95.62375630416945
curr_Factors:  [95.6237563]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679449]
Stock Position:  -0.026794490749617712
Bond Position:  [-2.56914732]


portfolio before change:  [-5.12436184]
curr_Stock_Price:  95.35743612716806
curr_Factors:  [95.35743613]
mat_Sqrt:  [[0.15]]
grads:  [0.12138877]
Stock Position:  0.12138876679209867
Bond Position:  [-16.69968341]


portfolio before change:  [-5.18012953]
curr_Stock_Price:  94.90662067567179
curr_Factors:  [94.90662068]
mat_Sqrt:  [[0.15]]
grads:  [0.04672837]
Stock Position:  0.04672836983517115
Bond Position:  [-9.6149612]


portfolio before change:  [-5.14805235]
curr_Stock_Price:  95.60594172195877
curr_Factors:  [95.60594172]
mat_Sqrt:  [[0.15]]
grads:  [0.13381171]
Stock Position:  0.1338117106319797
Bond Position:  [-17.94124696]


portfolio before change:  [-5.13220141]
curr_Stock_Price:  95.73277892845508
curr_Factors:  [95.73277893]
mat_Sqrt:  [[0.15]]
grads:  [-0.02090934]
Stock Position:  -0.0209093419551906
Bond Position:  [-3.130492]


portfolio before change:  [-5.14009313]
curr_Stock_Price:  96.10084677016579
curr_Factors:  [96.10084677]
mat_Sqrt:  [[0.15]]
grads:  [0.03826545]
Stock Position:  0.03826544983890768
Bond Position:  [-8.81743526]


portfolio before change:  [-5.09134224]
curr_Stock_Price:  97.38926751913414
curr_Factors:  [97.38926752]
mat_Sqrt:  [[0.15]]
grads:  [0.15441774]
Stock Position:  0.1544177399076914
Bond Position:  [-20.12997282]


portfolio before change:  [-5.10981715]
curr_Stock_Price:  97.27777286717294
curr_Factors:  [97.27777287]
mat_Sqrt:  [[0.15]]
grads:  [0.02347699]
Stock Position:  0.02347699005290395
Bond Position:  [-7.39360646]


portfolio before change:  [-5.13621952]
curr_Stock_Price:  96.17285052987067
curr_Factors:  [96.17285053]
mat_Sqrt:  [[0.15]]
grads:  [-0.10249326]
Stock Position:  -0.10249325511338413
Bond Position:  [4.72084898]


portfolio before change:  [-5.17629442]
curr_Stock_Price:  96.56672969329297
curr_Factors:  [96.56672969]
mat_Sqrt:  [[0.15]]
grads:  [-0.03847938]
Stock Position:  -0.03847937914449496
Bond Position:  [-1.46046661]


portfolio before change:  [-5.18595307]
curr_Stock_Price:  96.81536601469323
curr_Factors:  [96.81536601]
mat_Sqrt:  [[0.15]]
grads:  [0.01150735]
Stock Position:  0.01150734601688319
Bond Position:  [-6.30004099]


portfolio before change:  [-5.18235612]
curr_Stock_Price:  97.16216292691587
curr_Factors:  [97.16216293]
mat_Sqrt:  [[0.15]]
grads:  [0.06206787]
Stock Position:  0.06206787170048518
Bond Position:  [-11.21300478]


portfolio before change:  [-5.16617017]
curr_Stock_Price:  97.43423260227229
curr_Factors:  [97.4342326]
mat_Sqrt:  [[0.15]]
grads:  [0.0071958]
Stock Position:  0.007195801142977956
Bond Position:  [-5.86728753]


portfolio before change:  [-5.16609038]
curr_Stock_Price:  97.49628352313319
curr_Factors:  [97.49628352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034012]
Stock Position:  -0.010340122395315239
Bond Position:  [-4.15796688]


portfolio before change:  [-5.16565999]
curr_Stock_Price:  97.42952668567239
curr_Factors:  [97.42952669]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321483]
Stock Position:  -0.04321483087541104
Bond Position:  [-0.95525947]


portfolio before change:  [-5.18095771]
curr_Stock_Price:  97.7821374501146
curr_Factors:  [97.78213745]
mat_Sqrt:  [[0.15]]
grads:  [-0.15504579]
Stock Position:  -0.15504578554358478
Bond Position:  [9.9797506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.07680355]
Stock Price:  97.1143965989769
PL:  [-5.07680355]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.66141616e-03]
 [ 1.62424065e-02]
 [ 4.62737937e-03]
 [-9.12221009e-03]
 [ 1.23357597e-02]
 [-1.79790156e-03]
 [ 2.42668763e-03]
 [-2.53882945e-02]
 [ 1.36184445e-02]
 [-7.25270877e-04]
 [ 2.30537257e-03]
 [-1.89075392e-03]
 [-2.93979960e-03]
 [ 6.06541092e-03]
 [ 2.36250202e-03]
 [ 1.41135342e-02]
 [ 8.15515940e-02]
 [-1.31996135e-02]
 [ 1.93936447e-02]
 [ 1.28984514e-03]
 [-4.96072101e-03]
 [ 4.58022465e-03]
 [ 6.64593643e-03]
 [ 4.55990423e-02]
 [ 2.75704847e-03]
 [ 8.06087935e-03]
 [ 3.20995031e-02]
 [ 2.73437258e-02]
 [ 9.47616864e-03]
 [-7.58068156e-03]
 [ 3.67206450e-03]
 [ 1.49123983e-02]
 [ 1.47941090e-02]
 [-5.75378434e-03]
 [ 4.54431599e-03]
 [-2.89704993e-06]
 [-1.83589697e-02]
 [-7.54216152e-03]
 [-3.43604221e-02]
 [-7.74684789e-03]
 [ 4.09166972e-03]
 [ 1.03949777e-02]
 [-5.33986514e-03]
 [-4.20570825e-03]
 [ 2.05987461e-02]
 [ 1.54286646e-02]
 [ 1.08745173e-02]
 [ 4.17042419e-03]
 [ 9.62339759e-03]
 [-1.92953441e-03]
 [-3.63265542e-03]
 [-2.97422360e-03]
 [ 1.35944207e-03]
 [ 7.12240989e-03]
 [-6.98316548e-03]
 [-4.38817879e-03]
 [ 4.50871153e-03]
 [ 4.21026688e-03]
 [ 7.26117418e-03]
 [-3.99518268e-03]
 [-1.18377100e-03]
 [ 2.34856997e-03]
 [-7.80940993e-03]
 [ 7.16083137e-03]
 [ 2.23606700e-02]
 [ 5.49731504e-03]
 [ 7.70217323e-03]
 [-1.31242065e-03]
 [ 2.76019777e-03]
 [ 2.16235293e-02]
 [ 3.26565602e-04]
 [-1.55447726e-02]
 [-2.22039892e-03]
 [ 1.13403300e-03]
 [ 3.86030332e-03]
 [-1.53981891e-02]
 [-3.48440998e-03]
 [ 1.16005398e-02]
 [ 3.45129040e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.81052852]
curr_Stock_Price:  100.44421558057905
curr_Factors:  [100.44421558]
mat_Sqrt:  [[0.15]]
grads:  [-0.02440944]
Stock Position:  -0.024409441041569207
Bond Position:  [14.26231568]


portfolio before change:  [11.81564073]
curr_Stock_Price:  100.27129965095443
curr_Factors:  [100.27129965]
mat_Sqrt:  [[0.15]]
grads:  [0.10828271]
Stock Position:  0.10828271004796819
Bond Position:  [0.95799266]


portfolio before change:  [11.75855448]
curr_Stock_Price:  99.74355039506844
curr_Factors:  [99.7435504]
mat_Sqrt:  [[0.15]]
grads:  [0.0308492]
Stock Position:  0.03084919582128108
Bond Position:  [8.68154617]


portfolio before change:  [11.76207754]
curr_Stock_Price:  99.84016368748419
curr_Factors:  [99.84016369]
mat_Sqrt:  [[0.15]]
grads:  [-0.06081473]
Stock Position:  -0.0608147339333921
Bond Position:  [17.83383053]


portfolio before change:  [11.73901625]
curr_Stock_Price:  100.23769794834593
curr_Factors:  [100.23769795]
mat_Sqrt:  [[0.15]]
grads:  [0.0822384]
Stock Position:  0.08223839786884941
Bond Position:  [3.49562856]


portfolio before change:  [11.7716121]
curr_Stock_Price:  100.63139928404244
curr_Factors:  [100.63139928]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198601]
Stock Position:  -0.011986010393261075
Bond Position:  [12.9777811]


portfolio before change:  [11.78081252]
curr_Stock_Price:  99.93147619212709
curr_Factors:  [99.93147619]
mat_Sqrt:  [[0.15]]
grads:  [0.01617792]
Stock Position:  0.01617791756647212
Bond Position:  [10.16412934]


portfolio before change:  [11.79587911]
curr_Stock_Price:  100.82351389530136
curr_Factors:  [100.8235139]
mat_Sqrt:  [[0.15]]
grads:  [-0.1692553]
Stock Position:  -0.16925529649306184
Bond Position:  [28.86079285]


portfolio before change:  [11.70236275]
curr_Stock_Price:  101.38668813649215
curr_Factors:  [101.38668814]
mat_Sqrt:  [[0.15]]
grads:  [0.09078963]
Stock Position:  0.09078963026680695
Bond Position:  [2.49750282]


portfolio before change:  [11.66739905]
curr_Stock_Price:  100.99986203398551
curr_Factors:  [100.99986203]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483514]
Stock Position:  -0.004835139178148221
Bond Position:  [12.15574743]


portfolio before change:  [11.66983055]
curr_Stock_Price:  100.654112508594
curr_Factors:  [100.65411251]
mat_Sqrt:  [[0.15]]
grads:  [0.01536915]
Stock Position:  0.01536915043579471
Bond Position:  [10.12286235]


portfolio before change:  [11.66425716]
curr_Stock_Price:  100.25031057736076
curr_Factors:  [100.25031058]
mat_Sqrt:  [[0.15]]
grads:  [-0.01260503]
Stock Position:  -0.012605026124777458
Bond Position:  [12.92791494]


portfolio before change:  [11.6595811]
curr_Stock_Price:  100.68538105314214
curr_Factors:  [100.68538105]
mat_Sqrt:  [[0.15]]
grads:  [-0.01959866]
Stock Position:  -0.019598663976216277
Bond Position:  [13.63288005]


portfolio before change:  [11.65575637]
curr_Stock_Price:  100.92400998876258
curr_Factors:  [100.92400999]
mat_Sqrt:  [[0.15]]
grads:  [0.04043607]
Stock Position:  0.04043607276676334
Bond Position:  [7.57478576]


portfolio before change:  [11.68022455]
curr_Stock_Price:  101.51740914923161
curr_Factors:  [101.51740915]
mat_Sqrt:  [[0.15]]
grads:  [0.01575001]
Stock Position:  0.01575001349302287
Bond Position:  [10.08132398]


portfolio before change:  [11.68257522]
curr_Stock_Price:  101.62665202437996
curr_Factors:  [101.62665202]
mat_Sqrt:  [[0.15]]
grads:  [0.09409023]
Stock Position:  0.09409022796957503
Bond Position:  [2.12050037]


portfolio before change:  [11.69406727]
curr_Stock_Price:  101.74738196160543
curr_Factors:  [101.74738196]
mat_Sqrt:  [[0.15]]
grads:  [0.54367729]
Stock Position:  0.5436772934006168
Bond Position:  [-43.62367397]


portfolio before change:  [11.67678742]
curr_Stock_Price:  101.72061372072709
curr_Factors:  [101.72061372]
mat_Sqrt:  [[0.15]]
grads:  [-0.08799742]
Stock Position:  -0.08799742320613856
Bond Position:  [20.62793931]


portfolio before change:  [11.67327388]
curr_Stock_Price:  101.77519281793023
curr_Factors:  [101.77519282]
mat_Sqrt:  [[0.15]]
grads:  [0.12929096]
Stock Position:  0.12929096434212428
Bond Position:  [-1.48533894]


portfolio before change:  [11.67097046]
curr_Stock_Price:  101.75809506283328
curr_Factors:  [101.75809506]
mat_Sqrt:  [[0.15]]
grads:  [0.00859897]
Stock Position:  0.008598967626608998
Bond Position:  [10.7959559]


portfolio before change:  [11.67333386]
curr_Stock_Price:  101.95447118913906
curr_Factors:  [101.95447119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03307147]
Stock Position:  -0.03307147342044798
Bond Position:  [15.04511845]


portfolio before change:  [11.69045836]
curr_Stock_Price:  101.46510245939551
curr_Factors:  [101.46510246]
mat_Sqrt:  [[0.15]]
grads:  [0.03053483]
Stock Position:  0.03053483101700011
Bond Position:  [8.5922386]


portfolio before change:  [11.72764847]
curr_Stock_Price:  102.66547211121582
curr_Factors:  [102.66547211]
mat_Sqrt:  [[0.15]]
grads:  [0.04430624]
Stock Position:  0.044306242841679534
Bond Position:  [7.17892713]


portfolio before change:  [11.76453467]
curr_Stock_Price:  103.48787320830947
curr_Factors:  [103.48787321]
mat_Sqrt:  [[0.15]]
grads:  [0.30399362]
Stock Position:  0.30399361520296414
Bond Position:  [-19.69511803]


portfolio before change:  [11.59866127]
curr_Stock_Price:  102.94627493706115
curr_Factors:  [102.94627494]
mat_Sqrt:  [[0.15]]
grads:  [0.01838032]
Stock Position:  0.01838032313285623
Bond Position:  [9.70647547]


portfolio before change:  [11.599222]
curr_Stock_Price:  102.94377536346121
curr_Factors:  [102.94377536]
mat_Sqrt:  [[0.15]]
grads:  [0.0537392]
Stock Position:  0.05373919567987842
Bond Position:  [6.06710632]


portfolio before change:  [11.61533034]
curr_Stock_Price:  103.23646915840258
curr_Factors:  [103.23646916]
mat_Sqrt:  [[0.15]]
grads:  [0.21399669]
Stock Position:  0.21399668710352038
Bond Position:  [-10.47693205]


portfolio before change:  [11.78149962]
curr_Stock_Price:  104.01603315430357
curr_Factors:  [104.01603315]
mat_Sqrt:  [[0.15]]
grads:  [0.18229151]
Stock Position:  0.18229150558760543
Bond Position:  [-7.17973967]


portfolio before change:  [11.77282164]
curr_Stock_Price:  103.97088988000436
curr_Factors:  [103.97088988]
mat_Sqrt:  [[0.15]]
grads:  [0.06317446]
Stock Position:  0.06317445758937437
Bond Position:  [5.20451707]


portfolio before change:  [11.74517312]
curr_Stock_Price:  103.52808732556232
curr_Factors:  [103.52808733]
mat_Sqrt:  [[0.15]]
grads:  [-0.05053788]
Stock Position:  -0.05053787703966445
Bond Position:  [16.97726287]


portfolio before change:  [11.71708755]
curr_Stock_Price:  104.10481670320303
curr_Factors:  [104.1048167]
mat_Sqrt:  [[0.15]]
grads:  [0.02448043]
Stock Position:  0.024480430025942863
Bond Position:  [9.16855687]


portfolio before change:  [11.71254355]
curr_Stock_Price:  103.895790246776
curr_Factors:  [103.89579025]
mat_Sqrt:  [[0.15]]
grads:  [0.09941599]
Stock Position:  0.09941598859395924
Bond Position:  [1.38364085]


portfolio before change:  [11.69409002]
curr_Stock_Price:  103.70930101232881
curr_Factors:  [103.70930101]
mat_Sqrt:  [[0.15]]
grads:  [0.09862739]
Stock Position:  0.09862739348511362
Bond Position:  [1.46551198]


portfolio before change:  [11.69024852]
curr_Stock_Price:  103.6694226868108
curr_Factors:  [103.66942269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03835856]
Stock Position:  -0.0383585622721103
Bond Position:  [15.66685853]


portfolio before change:  [11.68395022]
curr_Stock_Price:  103.85914577203793
curr_Factors:  [103.85914577]
mat_Sqrt:  [[0.15]]
grads:  [0.03029544]
Stock Position:  0.030295439926748824
Bond Position:  [8.53749171]


portfolio before change:  [11.67746711]
curr_Stock_Price:  103.62753588550757
curr_Factors:  [103.62753589]
mat_Sqrt:  [[0.15]]
grads:  [-1.93136662e-05]
Stock Position:  -1.9313666221575564e-05
Bond Position:  [11.67946854]


portfolio before change:  [11.67821067]
curr_Stock_Price:  102.92520862558061
curr_Factors:  [102.92520863]
mat_Sqrt:  [[0.15]]
grads:  [-0.12239313]
Stock Position:  -0.12239313115105266
Bond Position:  [24.27554922]


portfolio before change:  [11.61941823]
curr_Stock_Price:  103.41796260893737
curr_Factors:  [103.41796261]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028108]
Stock Position:  -0.050281076832245704
Bond Position:  [16.81938476]


portfolio before change:  [11.68304986]
curr_Stock_Price:  102.17335149928294
curr_Factors:  [102.1733515]
mat_Sqrt:  [[0.15]]
grads:  [-0.22906948]
Stock Position:  -0.22906948079846665
Bond Position:  [35.08784644]


portfolio before change:  [11.80990609]
curr_Stock_Price:  101.62913595789459
curr_Factors:  [101.62913596]
mat_Sqrt:  [[0.15]]
grads:  [-0.05164565]
Stock Position:  -0.051645652579268925
Bond Position:  [17.05860914]


portfolio before change:  [11.77467443]
curr_Stock_Price:  102.3319611137036
curr_Factors:  [102.33196111]
mat_Sqrt:  [[0.15]]
grads:  [0.0272778]
Stock Position:  0.027277798102542668
Bond Position:  [8.98328385]


portfolio before change:  [11.77036283]
curr_Stock_Price:  102.1533150925899
curr_Factors:  [102.15331509]
mat_Sqrt:  [[0.15]]
grads:  [0.06929985]
Stock Position:  0.0692998515523766
Bond Position:  [4.69115326]


portfolio before change:  [11.75175393]
curr_Stock_Price:  101.88055685509987
curr_Factors:  [101.88055686]
mat_Sqrt:  [[0.15]]
grads:  [-0.0355991]
Stock Position:  -0.03559910090087687
Bond Position:  [15.37861015]


portfolio before change:  [11.76342909]
curr_Stock_Price:  101.57959505736436
curr_Factors:  [101.57959506]
mat_Sqrt:  [[0.15]]
grads:  [-0.02803805]
Stock Position:  -0.028038054996915078
Bond Position:  [14.61152336]


portfolio before change:  [11.78600826]
curr_Stock_Price:  100.80686247389286
curr_Factors:  [100.80686247]
mat_Sqrt:  [[0.15]]
grads:  [0.13732497]
Stock Position:  0.13732497409220779
Bond Position:  [-2.05729152]


portfolio before change:  [11.6283263]
curr_Stock_Price:  99.65955931792207
curr_Factors:  [99.65955932]
mat_Sqrt:  [[0.15]]
grads:  [0.10285776]
Stock Position:  0.10285776402345362
Bond Position:  [1.37756686]


portfolio before change:  [11.68701207]
curr_Stock_Price:  100.22927487178802
curr_Factors:  [100.22927487]
mat_Sqrt:  [[0.15]]
grads:  [0.07249678]
Stock Position:  0.07249678183162009
Bond Position:  [4.42071219]


portfolio before change:  [11.67010886]
curr_Stock_Price:  99.99230555533232
curr_Factors:  [99.99230556]
mat_Sqrt:  [[0.15]]
grads:  [0.02780283]
Stock Position:  0.027802827906000898
Bond Position:  [8.89003999]


portfolio before change:  [11.68500743]
curr_Stock_Price:  100.5081857021375
curr_Factors:  [100.5081857]
mat_Sqrt:  [[0.15]]
grads:  [0.06415598]
Stock Position:  0.06415598394492024
Bond Position:  [5.23680588]


portfolio before change:  [11.66857685]
curr_Stock_Price:  100.24698022953265
curr_Factors:  [100.24698023]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286356]
Stock Position:  -0.012863562709026737
Bond Position:  [12.95811016]


portfolio before change:  [11.67590887]
curr_Stock_Price:  99.7399574814782
curr_Factors:  [99.73995748]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242177]
Stock Position:  -0.024217702813664525
Bond Position:  [14.09138152]


portfolio before change:  [11.68712638]
curr_Stock_Price:  99.3131305653213
curr_Factors:  [99.31313057]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982816]
Stock Position:  -0.019828157327111465
Bond Position:  [13.65632276]


portfolio before change:  [11.70090992]
curr_Stock_Price:  98.6610277239633
curr_Factors:  [98.66102772]
mat_Sqrt:  [[0.15]]
grads:  [0.00906295]
Stock Position:  0.009062947104291437
Bond Position:  [10.80675025]


portfolio before change:  [11.70566229]
curr_Stock_Price:  99.11087296576699
curr_Factors:  [99.11087297]
mat_Sqrt:  [[0.15]]
grads:  [0.04748273]
Stock Position:  0.04748273261547634
Bond Position:  [6.99960721]


portfolio before change:  [11.70322515]
curr_Stock_Price:  99.05033241939324
curr_Factors:  [99.05033242]
mat_Sqrt:  [[0.15]]
grads:  [-0.04655444]
Stock Position:  -0.04655443653347566
Bond Position:  [16.31445756]


portfolio before change:  [11.69516671]
curr_Stock_Price:  99.24533266135809
curr_Factors:  [99.24533266]
mat_Sqrt:  [[0.15]]
grads:  [-0.02925453]
Stock Position:  -0.02925452523395277
Bond Position:  [14.5985418]


portfolio before change:  [11.68069822]
curr_Stock_Price:  99.77109474282359
curr_Factors:  [99.77109474]
mat_Sqrt:  [[0.15]]
grads:  [0.03005808]
Stock Position:  0.030058076848981548
Bond Position:  [8.68177099]


portfolio before change:  [11.68399091]
curr_Stock_Price:  99.86258638476029
curr_Factors:  [99.86258638]
mat_Sqrt:  [[0.15]]
grads:  [0.02806845]
Stock Position:  0.02806844583852291
Bond Position:  [8.88100332]


portfolio before change:  [11.67961449]
curr_Stock_Price:  99.6868907619023
curr_Factors:  [99.68689076]
mat_Sqrt:  [[0.15]]
grads:  [0.04840783]
Stock Position:  0.04840782785795576
Bond Position:  [6.85398864]


portfolio before change:  [11.6581376]
curr_Stock_Price:  99.23437555170366
curr_Factors:  [99.23437555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02663455]
Stock Position:  -0.02663455119155845
Bond Position:  [14.30120066]


portfolio before change:  [11.66154724]
curr_Stock_Price:  99.1399198645087
curr_Factors:  [99.13991986]
mat_Sqrt:  [[0.15]]
grads:  [-0.00789181]
Stock Position:  -0.00789180664099148
Bond Position:  [12.44394032]


portfolio before change:  [11.6622536]
curr_Stock_Price:  99.14896851126987
curr_Factors:  [99.14896851]
mat_Sqrt:  [[0.15]]
grads:  [0.01565713]
Stock Position:  0.015657133123525187
Bond Position:  [10.109865]


portfolio before change:  [11.6769972]
curr_Stock_Price:  100.0502649871517
curr_Factors:  [100.05026499]
mat_Sqrt:  [[0.15]]
grads:  [-0.05206273]
Stock Position:  -0.05206273286097004
Bond Position:  [16.88588742]


portfolio before change:  [11.69646041]
curr_Stock_Price:  99.69669520314328
curr_Factors:  [99.6966952]
mat_Sqrt:  [[0.15]]
grads:  [0.04773888]
Stock Position:  0.047738875824252174
Bond Position:  [6.93705226]


portfolio before change:  [11.70808671]
curr_Stock_Price:  99.93115227223508
curr_Factors:  [99.93115227]
mat_Sqrt:  [[0.15]]
grads:  [0.14907113]
Stock Position:  0.14907113365596225
Bond Position:  [-3.18876345]


portfolio before change:  [11.73239084]
curr_Stock_Price:  100.09552635079348
curr_Factors:  [100.09552635]
mat_Sqrt:  [[0.15]]
grads:  [0.03664877]
Stock Position:  0.03664876691694055
Bond Position:  [8.06401322]


portfolio before change:  [11.73833233]
curr_Stock_Price:  100.24389354725889
curr_Factors:  [100.24389355]
mat_Sqrt:  [[0.15]]
grads:  [0.05134782]
Stock Position:  0.05134782152771266
Bond Position:  [6.59102677]


portfolio before change:  [11.74443289]
curr_Stock_Price:  100.3546794213968
curr_Factors:  [100.35467942]
mat_Sqrt:  [[0.15]]
grads:  [-0.00874947]
Stock Position:  -0.00874947102741188
Bond Position:  [12.62248325]


portfolio before change:  [11.74446334]
curr_Stock_Price:  100.44136882106578
curr_Factors:  [100.44136882]
mat_Sqrt:  [[0.15]]
grads:  [0.01840132]
Stock Position:  0.018401318465094827
Bond Position:  [9.89620972]


portfolio before change:  [11.72992967]
curr_Stock_Price:  99.61793891534576
curr_Factors:  [99.61793892]
mat_Sqrt:  [[0.15]]
grads:  [0.14415686]
Stock Position:  0.14415686182850201
Bond Position:  [-2.63067978]


portfolio before change:  [11.91140117]
curr_Stock_Price:  100.87792693418574
curr_Factors:  [100.87792693]
mat_Sqrt:  [[0.15]]
grads:  [0.0021771]
Stock Position:  0.00217710401202217
Bond Position:  [11.69177943]


portfolio before change:  [11.91512582]
curr_Stock_Price:  102.25309873194979
curr_Factors:  [102.25309873]
mat_Sqrt:  [[0.15]]
grads:  [-0.10363182]
Stock Position:  -0.1036318171402075
Bond Position:  [22.51180025]


portfolio before change:  [11.84331845]
curr_Stock_Price:  102.95958453008609
curr_Factors:  [102.95958453]
mat_Sqrt:  [[0.15]]
grads:  [-0.01480266]
Stock Position:  -0.014802659477464522
Bond Position:  [13.36739412]


portfolio before change:  [11.84092319]
curr_Stock_Price:  103.17783858324246
curr_Factors:  [103.17783858]
mat_Sqrt:  [[0.15]]
grads:  [0.00756022]
Stock Position:  0.007560220003285127
Bond Position:  [11.06087603]


portfolio before change:  [11.84050755]
curr_Stock_Price:  103.03141801013285
curr_Factors:  [103.03141801]
mat_Sqrt:  [[0.15]]
grads:  [0.02573536]
Stock Position:  0.02573535549446482
Bond Position:  [9.18895738]


portfolio before change:  [11.83169778]
curr_Stock_Price:  102.66677991358551
curr_Factors:  [102.66677991]
mat_Sqrt:  [[0.15]]
grads:  [-0.10265459]
Stock Position:  -0.10265459420412552
Bond Position:  [22.37091441]


portfolio before change:  [11.73268436]
curr_Stock_Price:  103.64493052663535
curr_Factors:  [103.64493053]
mat_Sqrt:  [[0.15]]
grads:  [-0.0232294]
Stock Position:  -0.023229399838783443
Bond Position:  [14.14029389]


portfolio before change:  [11.71555039]
curr_Stock_Price:  104.42057533535964
curr_Factors:  [104.42057534]
mat_Sqrt:  [[0.15]]
grads:  [0.07733693]
Stock Position:  0.0773369317027624
Bond Position:  [3.63998349]


portfolio before change:  [11.75291707]
curr_Stock_Price:  104.90080088136553
curr_Factors:  [104.90080088]
mat_Sqrt:  [[0.15]]
grads:  [0.0230086]
Stock Position:  0.0230086026718662
Bond Position:  [9.33929622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.75849978]
Stock Price:  105.11806694666089
PL:  [6.64043283]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40465448e-02]
 [ 2.04697944e-02]
 [ 4.27417386e-03]
 [-8.98264949e-03]
 [ 1.23097953e-02]
 [-9.92361351e-03]
 [ 6.20801752e-05]
 [-1.80844609e-03]
 [-7.56818142e-03]
 [-4.11881085e-03]
 [-1.04505803e-02]
 [ 1.76739930e-02]
 [-4.25793217e-03]
 [ 4.03398970e-03]
 [ 3.24944401e-03]
 [ 1.06441122e-02]
 [ 9.52720305e-02]
 [-1.09291194e-02]
 [ 2.46641275e-02]
 [-5.83957256e-05]
 [-6.15205235e-03]
 [ 6.22308848e-03]
 [-2.61449568e-03]
 [ 4.74252596e-02]
 [ 5.41923890e-03]
 [ 7.12904389e-03]
 [ 5.23830618e-02]
 [ 2.63907617e-02]
 [ 1.08136395e-02]
 [-9.02249069e-03]
 [ 4.42344759e-03]
 [ 1.55491260e-02]
 [ 1.59119643e-02]
 [-1.07466750e-02]
 [ 3.54022184e-03]
 [-2.96563414e-02]
 [-9.07761079e-03]
 [-1.69022599e-02]
 [ 2.63336520e-02]
 [-7.03277306e-02]
 [ 3.30776982e-03]
 [ 8.40508230e-04]
 [-1.54160227e-02]
 [ 1.59337816e-02]
 [-4.63401850e-03]
 [ 1.16362217e-02]
 [ 1.05707674e-02]
 [-2.71666424e-03]
 [ 1.29724101e-02]
 [-1.23657751e-03]
 [ 2.15765048e-02]
 [-5.14193887e-03]
 [-1.69645135e-03]
 [-2.23326441e-02]
 [-7.54777462e-03]
 [-2.74730845e-03]
 [ 5.40983785e-03]
 [-1.62841848e-02]
 [ 2.72805824e-03]
 [-3.21149232e-03]
 [-5.94308370e-03]
 [ 4.05440940e-03]
 [-1.89215510e-02]
 [ 3.40282327e-04]
 [ 4.72184988e-03]
 [ 2.44014208e-02]
 [-3.66290291e-03]
 [ 2.06433965e-02]
 [ 9.17137550e-03]
 [ 1.18470629e-02]
 [ 8.14318145e-03]
 [-1.45605152e-02]
 [-3.81892570e-02]
 [ 6.38087167e-04]
 [-5.20382775e-03]
 [-2.16221858e-02]
 [-4.88570588e-03]
 [ 1.56748923e-02]
 [ 5.43225206e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.03716175]
curr_Stock_Price:  99.769863915405
curr_Factors:  [99.76986392]
mat_Sqrt:  [[0.15]]
grads:  [-0.09364363]
Stock Position:  -0.0936436322594462
Bond Position:  [6.30565069]


portfolio before change:  [-3.09593264]
curr_Stock_Price:  100.40167416876031
curr_Factors:  [100.40167417]
mat_Sqrt:  [[0.15]]
grads:  [0.1364653]
Stock Position:  0.13646529608526844
Bond Position:  [-16.79727684]


portfolio before change:  [-3.17707604]
curr_Stock_Price:  99.81475910072145
curr_Factors:  [99.8147591]
mat_Sqrt:  [[0.15]]
grads:  [0.02849449]
Stock Position:  0.02849449242525085
Bond Position:  [-6.02124694]


portfolio before change:  [-3.1898445]
curr_Stock_Price:  99.37986397725614
curr_Factors:  [99.37986398]
mat_Sqrt:  [[0.15]]
grads:  [-0.05988433]
Stock Position:  -0.05988432996166474
Bond Position:  [2.76145207]


portfolio before change:  [-3.22769406]
curr_Stock_Price:  100.0147906750692
curr_Factors:  [100.01479068]
mat_Sqrt:  [[0.15]]
grads:  [0.0820653]
Stock Position:  0.08206530216425324
Bond Position:  [-11.43543808]


portfolio before change:  [-3.2594848]
curr_Stock_Price:  99.63611665077833
curr_Factors:  [99.63611665]
mat_Sqrt:  [[0.15]]
grads:  [-0.06615742]
Stock Position:  -0.06615742336888385
Bond Position:  [3.33218395]


portfolio before change:  [-3.29998359]
curr_Stock_Price:  100.25142256490139
curr_Factors:  [100.25142256]
mat_Sqrt:  [[0.15]]
grads:  [0.00041387]
Stock Position:  0.0004138678343567603
Bond Position:  [-3.34147442]


portfolio before change:  [-3.30044518]
curr_Stock_Price:  99.64071846020767
curr_Factors:  [99.64071846]
mat_Sqrt:  [[0.15]]
grads:  [-0.01205631]
Stock Position:  -0.01205630726611053
Bond Position:  [-2.09914607]


portfolio before change:  [-3.30377766]
curr_Stock_Price:  99.9062452647253
curr_Factors:  [99.90624526]
mat_Sqrt:  [[0.15]]
grads:  [-0.05045454]
Stock Position:  -0.0504545427698307
Bond Position:  [1.73694627]


portfolio before change:  [-3.38229449]
curr_Stock_Price:  101.46458652014499
curr_Factors:  [101.46458652]
mat_Sqrt:  [[0.15]]
grads:  [-0.02745874]
Stock Position:  -0.02745873902305504
Bond Position:  [-0.59620489]


portfolio before change:  [-3.40230122]
curr_Stock_Price:  102.19184001426912
curr_Factors:  [102.19184001]
mat_Sqrt:  [[0.15]]
grads:  [-0.06967054]
Stock Position:  -0.06967053536263308
Bond Position:  [3.71745898]


portfolio before change:  [-3.38433987]
curr_Stock_Price:  101.93737085871847
curr_Factors:  [101.93737086]
mat_Sqrt:  [[0.15]]
grads:  [0.11782662]
Stock Position:  0.11782661986024286
Bond Position:  [-15.39527571]


portfolio before change:  [-3.34758769]
curr_Stock_Price:  102.25745481476544
curr_Factors:  [102.25745481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02838621]
Stock Position:  -0.028386214466953597
Bond Position:  [-0.44488565]


portfolio before change:  [-3.33311034]
curr_Stock_Price:  101.74646168656794
curr_Factors:  [101.74646169]
mat_Sqrt:  [[0.15]]
grads:  [0.02689326]
Stock Position:  0.026893264685093923
Bond Position:  [-6.06940486]


portfolio before change:  [-3.33285793]
curr_Stock_Price:  101.76995308993777
curr_Factors:  [101.76995309]
mat_Sqrt:  [[0.15]]
grads:  [0.02166296]
Stock Position:  0.02166296006160634
Bond Position:  [-5.53749636]


portfolio before change:  [-3.3160766]
curr_Stock_Price:  102.56058507843095
curr_Factors:  [102.56058508]
mat_Sqrt:  [[0.15]]
grads:  [0.07096075]
Stock Position:  0.07096074822560537
Bond Position:  [-10.59385246]


portfolio before change:  [-3.35549819]
curr_Stock_Price:  102.01437531188247
curr_Factors:  [102.01437531]
mat_Sqrt:  [[0.15]]
grads:  [0.63514687]
Stock Position:  0.6351468700443219
Bond Position:  [-68.14960937]


portfolio before change:  [-2.90746442]
curr_Stock_Price:  102.72648345826505
curr_Factors:  [102.72648346]
mat_Sqrt:  [[0.15]]
grads:  [-0.0728608]
Stock Position:  -0.07286079589809388
Bond Position:  [4.57726893]


portfolio before change:  [-2.97265369]
curr_Stock_Price:  103.62511980056024
curr_Factors:  [103.6251198]
mat_Sqrt:  [[0.15]]
grads:  [0.16442752]
Stock Position:  0.16442751648472875
Bond Position:  [-20.01147478]


portfolio before change:  [-3.01740386]
curr_Stock_Price:  103.36056906930683
curr_Factors:  [103.36056907]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003893]
Stock Position:  -0.00038930483761578927
Bond Position:  [-2.97716509]


portfolio before change:  [-3.01736475]
curr_Stock_Price:  102.78212188964041
curr_Factors:  [102.78212189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101368]
Stock Position:  -0.04101368232616004
Bond Position:  [1.19810855]


portfolio before change:  [-3.03949391]
curr_Stock_Price:  103.32350333029713
curr_Factors:  [103.32350333]
mat_Sqrt:  [[0.15]]
grads:  [0.04148726]
Stock Position:  0.04148725654430453
Bond Position:  [-7.3261026]


portfolio before change:  [-2.99600484]
curr_Stock_Price:  104.38279179120966
curr_Factors:  [104.38279179]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742997]
Stock Position:  -0.017429971182865364
Bond Position:  [-1.17661578]


portfolio before change:  [-2.98338088]
curr_Stock_Price:  103.6543052808691
curr_Factors:  [103.65430528]
mat_Sqrt:  [[0.15]]
grads:  [0.3161684]
Stock Position:  0.3161683971478808
Bond Position:  [-35.75559644]


portfolio before change:  [-2.79830533]
curr_Stock_Price:  104.24674383119027
curr_Factors:  [104.24674383]
mat_Sqrt:  [[0.15]]
grads:  [0.03612826]
Stock Position:  0.03612825933202134
Bond Position:  [-6.56455872]


portfolio before change:  [-2.81523335]
curr_Stock_Price:  103.78954687510031
curr_Factors:  [103.78954688]
mat_Sqrt:  [[0.15]]
grads:  [0.04752696]
Stock Position:  0.047526959290025844
Bond Position:  [-7.74803492]


portfolio before change:  [-2.81613183]
curr_Stock_Price:  103.7808315130731
curr_Factors:  [103.78083151]
mat_Sqrt:  [[0.15]]
grads:  [0.34922041]
Stock Position:  0.3492204122988308
Bond Position:  [-39.0585166]


portfolio before change:  [-2.79143464]
curr_Stock_Price:  103.85854296844958
curr_Factors:  [103.85854297]
mat_Sqrt:  [[0.15]]
grads:  [0.17593841]
Stock Position:  0.17593841144565076
Bond Position:  [-21.06414171]


portfolio before change:  [-2.79807883]
curr_Stock_Price:  103.82826172734649
curr_Factors:  [103.82826173]
mat_Sqrt:  [[0.15]]
grads:  [0.07209093]
Stock Position:  0.07209092973335973
Bond Position:  [-10.28315475]


portfolio before change:  [-2.78168965]
curr_Stock_Price:  104.06451743466022
curr_Factors:  [104.06451743]
mat_Sqrt:  [[0.15]]
grads:  [-0.06014994]
Stock Position:  -0.06014993790635223
Bond Position:  [3.47778461]


portfolio before change:  [-2.80037402]
curr_Stock_Price:  104.37876106283954
curr_Factors:  [104.37876106]
mat_Sqrt:  [[0.15]]
grads:  [0.02948965]
Stock Position:  0.029489650579055997
Bond Position:  [-5.87846721]


portfolio before change:  [-2.79045009]
curr_Stock_Price:  104.72774246108332
curr_Factors:  [104.72774246]
mat_Sqrt:  [[0.15]]
grads:  [0.10366084]
Stock Position:  0.1036608397701121
Bond Position:  [-13.64661582]


portfolio before change:  [-2.79443599]
curr_Stock_Price:  104.69751926782165
curr_Factors:  [104.69751927]
mat_Sqrt:  [[0.15]]
grads:  [0.10607976]
Stock Position:  0.10607976179852574
Bond Position:  [-13.9007239]


portfolio before change:  [-2.70584303]
curr_Stock_Price:  105.54086376283593
curr_Factors:  [105.54086376]
mat_Sqrt:  [[0.15]]
grads:  [-0.0716445]
Stock Position:  -0.07164449978284976
Bond Position:  [4.85557936]


portfolio before change:  [-2.77955647]
curr_Stock_Price:  106.57397751020015
curr_Factors:  [106.57397751]
mat_Sqrt:  [[0.15]]
grads:  [0.02360148]
Stock Position:  0.023601478916496256
Bond Position:  [-5.29485995]


portfolio before change:  [-2.77542861]
curr_Stock_Price:  106.76289768841784
curr_Factors:  [106.76289769]
mat_Sqrt:  [[0.15]]
grads:  [-0.19770894]
Stock Position:  -0.1977089425248753
Bond Position:  [18.33255099]


portfolio before change:  [-2.60871815]
curr_Stock_Price:  105.92548165931915
curr_Factors:  [105.92548166]
mat_Sqrt:  [[0.15]]
grads:  [-0.06051741]
Stock Position:  -0.060517405275764075
Bond Position:  [3.80161715]


portfolio before change:  [-2.62104009]
curr_Stock_Price:  106.13301772924272
curr_Factors:  [106.13301773]
mat_Sqrt:  [[0.15]]
grads:  [-0.11268173]
Stock Position:  -0.11268173236431821
Bond Position:  [9.33821221]


portfolio before change:  [-2.7090617]
curr_Stock_Price:  106.91934987841724
curr_Factors:  [106.91934988]
mat_Sqrt:  [[0.15]]
grads:  [0.17555768]
Stock Position:  0.17555767968439703
Bond Position:  [-21.47957468]


portfolio before change:  [-2.79102517]
curr_Stock_Price:  106.46012216517377
curr_Factors:  [106.46012217]
mat_Sqrt:  [[0.15]]
grads:  [-0.46885154]
Stock Position:  -0.46885153735461366
Bond Position:  [47.12296678]


portfolio before change:  [-2.4600006]
curr_Stock_Price:  105.76037124416058
curr_Factors:  [105.76037124]
mat_Sqrt:  [[0.15]]
grads:  [0.0220518]
Stock Position:  0.022051798797130286
Bond Position:  [-4.79220702]


portfolio before change:  [-2.46590865]
curr_Stock_Price:  105.50603668466017
curr_Factors:  [105.50603668]
mat_Sqrt:  [[0.15]]
grads:  [0.00560339]
Stock Position:  0.005603388200989569
Bond Position:  [-3.05709993]


portfolio before change:  [-2.46690119]
curr_Stock_Price:  105.36300511619315
curr_Factors:  [105.36300512]
mat_Sqrt:  [[0.15]]
grads:  [-0.10277348]
Stock Position:  -0.10277348492242462
Bond Position:  [8.36162203]


portfolio before change:  [-2.48027326]
curr_Stock_Price:  105.49820229485077
curr_Factors:  [105.49820229]
mat_Sqrt:  [[0.15]]
grads:  [0.10622521]
Stock Position:  0.10622521079191365
Bond Position:  [-13.68684203]


portfolio before change:  [-2.48325003]
curr_Stock_Price:  105.47823230928385
curr_Factors:  [105.47823231]
mat_Sqrt:  [[0.15]]
grads:  [-0.03089346]
Stock Position:  -0.0308934566708962
Bond Position:  [0.77533717]


portfolio before change:  [-2.49080194]
curr_Stock_Price:  105.72425132077782
curr_Factors:  [105.72425132]
mat_Sqrt:  [[0.15]]
grads:  [0.07757481]
Stock Position:  0.07757481121024555
Bond Position:  [-10.69234078]


portfolio before change:  [-2.54179038]
curr_Stock_Price:  105.07558530193891
curr_Factors:  [105.0755853]
mat_Sqrt:  [[0.15]]
grads:  [0.07047178]
Stock Position:  0.07047178288791685
Bond Position:  [-9.94665421]


portfolio before change:  [-2.55655669]
curr_Stock_Price:  104.87487193080845
curr_Factors:  [104.87487193]
mat_Sqrt:  [[0.15]]
grads:  [-0.01811109]
Stock Position:  -0.018111094962724172
Bond Position:  [-0.65715793]


portfolio before change:  [-2.54794684]
curr_Stock_Price:  104.3972128074324
curr_Factors:  [104.39721281]
mat_Sqrt:  [[0.15]]
grads:  [0.08648273]
Stock Position:  0.08648273426525485
Bond Position:  [-11.57650325]


portfolio before change:  [-2.64206065]
curr_Stock_Price:  103.31734116244887
curr_Factors:  [103.31734116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824385]
Stock Position:  -0.008243850096082837
Bond Position:  [-1.79032797]


portfolio before change:  [-2.64266844]
curr_Stock_Price:  103.37749470108544
curr_Factors:  [103.3774947]
mat_Sqrt:  [[0.15]]
grads:  [0.14384337]
Stock Position:  0.14384336504630188
Bond Position:  [-17.51283515]


portfolio before change:  [-2.72145667]
curr_Stock_Price:  102.83736798781624
curr_Factors:  [102.83736799]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427959]
Stock Position:  -0.03427959244484174
Bond Position:  [0.80376639]


portfolio before change:  [-2.74148452]
curr_Stock_Price:  103.42308345626006
curr_Factors:  [103.42308346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130968]
Stock Position:  -0.011309675645444078
Bond Position:  [-1.57180299]


portfolio before change:  [-2.74619368]
curr_Stock_Price:  103.83077982157542
curr_Factors:  [103.83077982]
mat_Sqrt:  [[0.15]]
grads:  [-0.14888429]
Stock Position:  -0.148884293673828
Bond Position:  [12.71257864]


portfolio before change:  [-2.82469728]
curr_Stock_Price:  104.36339588692638
curr_Factors:  [104.36339589]
mat_Sqrt:  [[0.15]]
grads:  [-0.0503185]
Stock Position:  -0.05031849747592751
Bond Position:  [2.42671199]


portfolio before change:  [-2.82859585]
curr_Stock_Price:  104.44388806779776
curr_Factors:  [104.44388807]
mat_Sqrt:  [[0.15]]
grads:  [-0.01831539]
Stock Position:  -0.01831538967671861
Bond Position:  [-0.91566534]


portfolio before change:  [-2.83606645]
curr_Stock_Price:  104.84864977875367
curr_Factors:  [104.84864978]
mat_Sqrt:  [[0.15]]
grads:  [0.03606559]
Stock Position:  0.036065585647971764
Bond Position:  [-6.61749441]


portfolio before change:  [-2.80636643]
curr_Stock_Price:  105.683618353983
curr_Factors:  [105.68361835]
mat_Sqrt:  [[0.15]]
grads:  [-0.10856123]
Stock Position:  -0.10856123168534446
Bond Position:  [8.66677735]


portfolio before change:  [-2.73795246]
curr_Stock_Price:  105.05842028104793
curr_Factors:  [105.05842028]
mat_Sqrt:  [[0.15]]
grads:  [0.01818705]
Stock Position:  0.018187054946924294
Bond Position:  [-4.64865573]


portfolio before change:  [-2.73432449]
curr_Stock_Price:  105.27387701245723
curr_Factors:  [105.27387701]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140995]
Stock Position:  -0.021409948828431787
Bond Position:  [-0.48041617]


portfolio before change:  [-2.72733709]
curr_Stock_Price:  104.94611205953085
curr_Factors:  [104.94611206]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962056]
Stock Position:  -0.039620557970131864
Bond Position:  [1.43068643]


portfolio before change:  [-2.71086269]
curr_Stock_Price:  104.53256478416247
curr_Factors:  [104.53256478]
mat_Sqrt:  [[0.15]]
grads:  [0.0270294]
Stock Position:  0.02702939603237292
Bond Position:  [-5.53631478]


portfolio before change:  [-2.69003698]
curr_Stock_Price:  105.31585050512128
curr_Factors:  [105.31585051]
mat_Sqrt:  [[0.15]]
grads:  [-0.12614367]
Stock Position:  -0.12614367363234855
Bond Position:  [10.59489129]


portfolio before change:  [-2.75882072]
curr_Stock_Price:  105.86638095437321
curr_Factors:  [105.86638095]
mat_Sqrt:  [[0.15]]
grads:  [0.00226855]
Stock Position:  0.0022685488484324016
Bond Position:  [-2.99898377]


portfolio before change:  [-2.75844582]
curr_Stock_Price:  106.11426630707557
curr_Factors:  [106.11426631]
mat_Sqrt:  [[0.15]]
grads:  [0.031479]
Stock Position:  0.031478999198381055
Bond Position:  [-6.09881672]


portfolio before change:  [-2.73249371]
curr_Stock_Price:  106.9508017823314
curr_Factors:  [106.95080178]
mat_Sqrt:  [[0.15]]
grads:  [0.16267614]
Stock Position:  0.16267613849441917
Bond Position:  [-20.13083715]


portfolio before change:  [-2.54639341]
curr_Stock_Price:  108.10252886709304
curr_Factors:  [108.10252887]
mat_Sqrt:  [[0.15]]
grads:  [-0.02441935]
Stock Position:  -0.024419352764082164
Bond Position:  [0.09340038]


portfolio before change:  [-2.54516598]
curr_Stock_Price:  108.05250324125818
curr_Factors:  [108.05250324]
mat_Sqrt:  [[0.15]]
grads:  [0.13762264]
Stock Position:  0.1376226436074284
Bond Position:  [-17.41563712]


portfolio before change:  [-2.47762215]
curr_Stock_Price:  108.55120269285584
curr_Factors:  [108.55120269]
mat_Sqrt:  [[0.15]]
grads:  [0.0611425]
Stock Position:  0.06114250334868634
Bond Position:  [-9.11471443]


portfolio before change:  [-2.43460512]
curr_Stock_Price:  109.26407376456993
curr_Factors:  [109.26407376]
mat_Sqrt:  [[0.15]]
grads:  [0.07898042]
Stock Position:  0.078980419482276
Bond Position:  [-11.0643275]


portfolio before change:  [-2.496805]
curr_Stock_Price:  108.48529420738471
curr_Factors:  [108.48529421]
mat_Sqrt:  [[0.15]]
grads:  [0.05428788]
Stock Position:  0.05428787633504411
Bond Position:  [-8.38624123]


portfolio before change:  [-2.52475264]
curr_Stock_Price:  107.98014476160859
curr_Factors:  [107.98014476]
mat_Sqrt:  [[0.15]]
grads:  [-0.0970701]
Stock Position:  -0.0970701016351643
Bond Position:  [7.95689098]


portfolio before change:  [-2.44761304]
curr_Stock_Price:  107.19058875588237
curr_Factors:  [107.19058876]
mat_Sqrt:  [[0.15]]
grads:  [-0.25459505]
Stock Position:  -0.2545950469778377
Bond Position:  [24.84257994]


portfolio before change:  [-2.36213557]
curr_Stock_Price:  106.86094854922686
curr_Factors:  [106.86094855]
mat_Sqrt:  [[0.15]]
grads:  [0.00425391]
Stock Position:  0.004253914446787777
Bond Position:  [-2.8167129]


portfolio before change:  [-2.36305627]
curr_Stock_Price:  106.6858975608762
curr_Factors:  [106.68589756]
mat_Sqrt:  [[0.15]]
grads:  [-0.03469219]
Stock Position:  -0.034692185013388
Bond Position:  [1.33811063]


portfolio before change:  [-2.31502525]
curr_Stock_Price:  105.3038173172133
curr_Factors:  [105.30381732]
mat_Sqrt:  [[0.15]]
grads:  [-0.14414791]
Stock Position:  -0.14414790525014864
Bond Position:  [12.86429943]


portfolio before change:  [-2.43534174]
curr_Stock_Price:  106.14406906799388
curr_Factors:  [106.14406907]
mat_Sqrt:  [[0.15]]
grads:  [-0.03257137]
Stock Position:  -0.03257137250916893
Bond Position:  [1.02191628]


portfolio before change:  [-2.44007957]
curr_Stock_Price:  106.29148998892506
curr_Factors:  [106.29148999]
mat_Sqrt:  [[0.15]]
grads:  [0.10449928]
Stock Position:  0.10449928195205803
Bond Position:  [-13.54746395]


portfolio before change:  [-2.28185502]
curr_Stock_Price:  107.81371372370043
curr_Factors:  [107.81371372]
mat_Sqrt:  [[0.15]]
grads:  [0.36215014]
Stock Position:  0.3621501375280544
Bond Position:  [-41.32660627]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.00182238]
Stock Price:  108.59409622640128
PL:  [-10.59591861]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-8.57968382e-03]
 [-7.23188165e-03]
 [ 4.05770423e-02]
 [-1.20543010e-02]
 [ 8.99995055e-03]
 [-1.61046205e-02]
 [-1.35436536e-02]
 [ 2.64248782e-02]
 [-2.09712892e-02]
 [-1.33991066e-02]
 [ 8.80482161e-04]
 [-7.09702403e-03]
 [ 4.44801557e-03]
 [-3.99849863e-03]
 [-1.79075777e-03]
 [ 5.73006044e-03]
 [ 1.12536413e-02]
 [-1.38320779e-02]
 [ 2.33413455e-02]
 [ 1.42173638e-03]
 [-5.55603647e-03]
 [ 5.46392048e-03]
 [ 1.29212105e-02]
 [ 1.99528603e-02]
 [ 7.87914532e-04]
 [ 4.41571235e-03]
 [ 5.91601169e-04]
 [ 1.07131550e-02]
 [-1.48543648e-03]
 [ 2.76741128e-02]
 [-6.71184255e-03]
 [ 1.61191821e-02]
 [ 1.14883229e-02]
 [-2.02057503e-02]
 [-1.02191200e-02]
 [-2.08387783e-02]
 [ 8.15791942e-03]
 [-2.61775236e-03]
 [ 9.99139855e-03]
 [-1.24852300e-02]
 [ 7.09197738e-03]
 [ 3.10516409e-02]
 [-3.36911971e-03]
 [ 1.37659872e-02]
 [-3.66870976e-02]
 [ 1.91593695e-02]
 [ 1.00891107e-02]
 [ 5.21277408e-03]
 [-2.45014279e-03]
 [-1.45852537e-03]
 [-7.14571167e-03]
 [-1.16568015e-02]
 [ 1.77471496e-03]
 [-3.89308544e-03]
 [-3.03586617e-03]
 [-3.15391202e-03]
 [ 1.07512390e-02]
 [-9.50741529e-03]
 [ 6.10626792e-03]
 [-3.92493536e-03]
 [-1.94452429e-03]
 [ 6.63313696e-03]
 [-8.21498385e-03]
 [ 7.44409039e-03]
 [ 2.53504857e-02]
 [ 5.45546783e-03]
 [ 1.20977334e-02]
 [ 1.80968819e-03]
 [ 2.65266280e-03]
 [ 1.96442324e-02]
 [ 6.17051932e-04]
 [-1.55753736e-02]
 [-2.28144078e-03]
 [ 1.01027843e-03]
 [ 1.31211091e-03]
 [-2.04711991e-02]
 [-4.07583189e-03]
 [ 1.41598451e-02]
 [ 2.05559380e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.28478244]
curr_Stock_Price:  100.10241161564619
curr_Factors:  [100.10241162]
mat_Sqrt:  [[0.15]]
grads:  [-0.05719789]
Stock Position:  -0.057197892135115586
Bond Position:  [10.01042938]


portfolio before change:  [4.3274408]
curr_Stock_Price:  99.36754719144226
curr_Factors:  [99.36754719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04821254]
Stock Position:  -0.048212544334598165
Bond Position:  [9.11820308]


portfolio before change:  [4.35894954]
curr_Stock_Price:  98.72582969259167
curr_Factors:  [98.72582969]
mat_Sqrt:  [[0.15]]
grads:  [0.27051362]
Stock Position:  0.27051361524231354
Bond Position:  [-22.34773157]


portfolio before change:  [4.02486139]
curr_Stock_Price:  97.49597892546342
curr_Factors:  [97.49597893]
mat_Sqrt:  [[0.15]]
grads:  [-0.08036201]
Stock Position:  -0.08036200646580709
Bond Position:  [11.85983388]


portfolio before change:  [4.0680672]
curr_Stock_Price:  96.96756315582047
curr_Factors:  [96.96756316]
mat_Sqrt:  [[0.15]]
grads:  [0.05999967]
Stock Position:  0.05999967033594828
Bond Position:  [-1.74995462]


portfolio before change:  [4.12787495]
curr_Stock_Price:  97.9661874093144
curr_Factors:  [97.96618741]
mat_Sqrt:  [[0.15]]
grads:  [-0.10736414]
Stock Position:  -0.10736413641370193
Bond Position:  [14.64593006]


portfolio before change:  [4.11439961]
curr_Stock_Price:  98.10022414962084
curr_Factors:  [98.10022415]
mat_Sqrt:  [[0.15]]
grads:  [-0.09029102]
Stock Position:  -0.09029102390440796
Bond Position:  [12.9719693]


portfolio before change:  [4.06587486]
curr_Stock_Price:  98.64662975692639
curr_Factors:  [98.64662976]
mat_Sqrt:  [[0.15]]
grads:  [0.17616585]
Stock Position:  0.17616585451406966
Bond Position:  [-13.31229296]


portfolio before change:  [3.83385625]
curr_Stock_Price:  97.33430636211945
curr_Factors:  [97.33430636]
mat_Sqrt:  [[0.15]]
grads:  [-0.13980859]
Stock Position:  -0.1398085945749124
Bond Position:  [17.44202882]


portfolio before change:  [3.78173204]
curr_Stock_Price:  97.71492936214612
curr_Factors:  [97.71492936]
mat_Sqrt:  [[0.15]]
grads:  [-0.08932738]
Stock Position:  -0.08932737761819146
Bond Position:  [12.51035044]


portfolio before change:  [3.83160288]
curr_Stock_Price:  97.16538996206236
curr_Factors:  [97.16538996]
mat_Sqrt:  [[0.15]]
grads:  [0.00586988]
Stock Position:  0.005869881075604688
Bond Position:  [3.26125359]


portfolio before change:  [3.83377863]
curr_Stock_Price:  97.5013289841959
curr_Factors:  [97.50132898]
mat_Sqrt:  [[0.15]]
grads:  [-0.04731349]
Stock Position:  -0.047313493520301224
Bond Position:  [8.44690713]


portfolio before change:  [3.84977163]
curr_Stock_Price:  97.17446569572536
curr_Factors:  [97.1744657]
mat_Sqrt:  [[0.15]]
grads:  [0.02965344]
Stock Position:  0.029653437131959715
Bond Position:  [0.96821472]


portfolio before change:  [3.87308159]
curr_Stock_Price:  97.95850451145925
curr_Factors:  [97.95850451]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665666]
Stock Position:  -0.02665665755149685
Bond Position:  [6.4843279]


portfolio before change:  [3.8726825]
curr_Stock_Price:  97.98867984772004
curr_Factors:  [97.98867985]
mat_Sqrt:  [[0.15]]
grads:  [-0.01193839]
Stock Position:  -0.011938385107998658
Bond Position:  [5.04250909]


portfolio before change:  [3.87048175]
curr_Stock_Price:  98.19942099551133
curr_Factors:  [98.199421]
mat_Sqrt:  [[0.15]]
grads:  [0.0382004]
Stock Position:  0.03820040295782953
Bond Position:  [0.1192243]


portfolio before change:  [3.89970097]
curr_Stock_Price:  98.96411874811055
curr_Factors:  [98.96411875]
mat_Sqrt:  [[0.15]]
grads:  [0.07502428]
Stock Position:  0.07502427522301042
Bond Position:  [-3.52501031]


portfolio before change:  [3.88228736]
curr_Stock_Price:  98.73494914292891
curr_Factors:  [98.73494914]
mat_Sqrt:  [[0.15]]
grads:  [-0.09221385]
Stock Position:  -0.09221385276569627
Bond Position:  [12.98701743]


portfolio before change:  [3.85507084]
curr_Stock_Price:  99.0388973404765
curr_Factors:  [99.03889734]
mat_Sqrt:  [[0.15]]
grads:  [0.15560897]
Stock Position:  0.1556089701061938
Bond Position:  [-11.55626997]


portfolio before change:  [3.88239887]
curr_Stock_Price:  99.2191588718991
curr_Factors:  [99.21915887]
mat_Sqrt:  [[0.15]]
grads:  [0.00947824]
Stock Position:  0.009478242564873902
Bond Position:  [2.94197561]


portfolio before change:  [3.87674383]
curr_Stock_Price:  98.60312515041771
curr_Factors:  [98.60312515]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704024]
Stock Position:  -0.037040243145554465
Bond Position:  [7.52902756]


portfolio before change:  [3.88911949]
curr_Stock_Price:  98.28171563178152
curr_Factors:  [98.28171563]
mat_Sqrt:  [[0.15]]
grads:  [0.03642614]
Stock Position:  0.03642613650336532
Bond Position:  [0.3090963]


portfolio before change:  [3.86846455]
curr_Stock_Price:  97.71414901353772
curr_Factors:  [97.71414901]
mat_Sqrt:  [[0.15]]
grads:  [0.0861414]
Stock Position:  0.08614140315413203
Bond Position:  [-4.54876935]


portfolio before change:  [3.84647971]
curr_Stock_Price:  97.4622314076575
curr_Factors:  [97.46223141]
mat_Sqrt:  [[0.15]]
grads:  [0.13301907]
Stock Position:  0.1330190686139422
Bond Position:  [-9.11785554]


portfolio before change:  [3.86885195]
curr_Stock_Price:  97.63470383002574
curr_Factors:  [97.63470383]
mat_Sqrt:  [[0.15]]
grads:  [0.00525276]
Stock Position:  0.005252763549118261
Bond Position:  [3.35599993]


portfolio before change:  [3.86604113]
curr_Stock_Price:  97.05965821502748
curr_Factors:  [97.05965822]
mat_Sqrt:  [[0.15]]
grads:  [0.02943808]
Stock Position:  0.029438082321749465
Bond Position:  [1.00879092]


portfolio before change:  [3.87701131]
curr_Stock_Price:  97.43016924518436
curr_Factors:  [97.43016925]
mat_Sqrt:  [[0.15]]
grads:  [0.00394401]
Stock Position:  0.003944007791969786
Bond Position:  [3.49274596]


portfolio before change:  [3.87618449]
curr_Stock_Price:  97.16517897399636
curr_Factors:  [97.16517897]
mat_Sqrt:  [[0.15]]
grads:  [0.07142103]
Stock Position:  0.07142103358668785
Bond Position:  [-3.06345302]


portfolio before change:  [3.84016025]
curr_Stock_Price:  96.66346730116166
curr_Factors:  [96.6634673]
mat_Sqrt:  [[0.15]]
grads:  [-0.00990291]
Stock Position:  -0.009902909843082671
Bond Position:  [4.79740986]


portfolio before change:  [3.832118]
curr_Stock_Price:  97.50585564478638
curr_Factors:  [97.50585564]
mat_Sqrt:  [[0.15]]
grads:  [0.18449409]
Stock Position:  0.18449408502303588
Bond Position:  [-14.15713562]


portfolio before change:  [3.86739665]
curr_Stock_Price:  97.70187002109779
curr_Factors:  [97.70187002]
mat_Sqrt:  [[0.15]]
grads:  [-0.04474562]
Stock Position:  -0.044745617004607496
Bond Position:  [8.23912711]


portfolio before change:  [3.86583334]
curr_Stock_Price:  97.7483164784261
curr_Factors:  [97.74831648]
mat_Sqrt:  [[0.15]]
grads:  [0.10746121]
Stock Position:  0.10746121395732808
Bond Position:  [-6.63831942]


portfolio before change:  [3.91414177]
curr_Stock_Price:  98.20172050501306
curr_Factors:  [98.20172051]
mat_Sqrt:  [[0.15]]
grads:  [0.07658882]
Stock Position:  0.0765888191884542
Bond Position:  [-3.60701204]


portfolio before change:  [3.84883711]
curr_Stock_Price:  97.35199826174075
curr_Factors:  [97.35199826]
mat_Sqrt:  [[0.15]]
grads:  [-0.134705]
Stock Position:  -0.13470500200275817
Bond Position:  [16.96263823]


portfolio before change:  [3.89732547]
curr_Stock_Price:  96.99990915557382
curr_Factors:  [96.99990916]
mat_Sqrt:  [[0.15]]
grads:  [-0.06812747]
Stock Position:  -0.06812746692097643
Bond Position:  [10.50568357]


portfolio before change:  [3.95176587]
curr_Stock_Price:  96.2104511384958
curr_Factors:  [96.21045114]
mat_Sqrt:  [[0.15]]
grads:  [-0.13892519]
Stock Position:  -0.13892518868160525
Bond Position:  [17.31782095]


portfolio before change:  [3.87385227]
curr_Stock_Price:  96.77907369365889
curr_Factors:  [96.77907369]
mat_Sqrt:  [[0.15]]
grads:  [0.05438613]
Stock Position:  0.054386129486769026
Bond Position:  [-1.38958696]


portfolio before change:  [3.85221005]
curr_Stock_Price:  96.38273427192134
curr_Factors:  [96.38273427]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745168]
Stock Position:  -0.01745168238444667
Bond Position:  [5.53425092]


portfolio before change:  [3.85221999]
curr_Stock_Price:  96.40198539146479
curr_Factors:  [96.40198539]
mat_Sqrt:  [[0.15]]
grads:  [0.06660932]
Stock Position:  0.06660932364954837
Bond Position:  [-2.56905106]


portfolio before change:  [3.90029835]
curr_Stock_Price:  97.1261923640579
curr_Factors:  [97.12619236]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323487]
Stock Position:  -0.08323486651731547
Bond Position:  [11.98458401]


portfolio before change:  [3.87857667]
curr_Stock_Price:  97.39616032692864
curr_Factors:  [97.39616033]
mat_Sqrt:  [[0.15]]
grads:  [0.04727985]
Stock Position:  0.04727984921267967
Bond Position:  [-0.72629911]


portfolio before change:  [3.87887978]
curr_Stock_Price:  97.40353155221638
curr_Factors:  [97.40353155]
mat_Sqrt:  [[0.15]]
grads:  [0.20701094]
Stock Position:  0.20701093949993699
Bond Position:  [-16.2847168]


portfolio before change:  [3.69168081]
curr_Stock_Price:  96.50415327864752
curr_Factors:  [96.50415328]
mat_Sqrt:  [[0.15]]
grads:  [-0.0224608]
Stock Position:  -0.022460798044658156
Bond Position:  [5.85924111]


portfolio before change:  [3.69964576]
curr_Stock_Price:  96.16584260922616
curr_Factors:  [96.16584261]
mat_Sqrt:  [[0.15]]
grads:  [0.09177325]
Stock Position:  0.09177324775365585
Bond Position:  [-5.12580594]


portfolio before change:  [3.71259125]
curr_Stock_Price:  96.31039305136146
curr_Factors:  [96.31039305]
mat_Sqrt:  [[0.15]]
grads:  [-0.24458065]
Stock Position:  -0.2445806509875224
Bond Position:  [27.26824988]


portfolio before change:  [3.57121493]
curr_Stock_Price:  96.89539695491807
curr_Factors:  [96.89539695]
mat_Sqrt:  [[0.15]]
grads:  [0.12772913]
Stock Position:  0.12772912977352918
Bond Position:  [-8.8051498]


portfolio before change:  [3.66141879]
curr_Stock_Price:  97.60591770220645
curr_Factors:  [97.6059177]
mat_Sqrt:  [[0.15]]
grads:  [0.06726074]
Stock Position:  0.06726073831461965
Bond Position:  [-2.9036273]


portfolio before change:  [3.71861292]
curr_Stock_Price:  98.45895043961548
curr_Factors:  [98.45895044]
mat_Sqrt:  [[0.15]]
grads:  [0.03475183]
Stock Position:  0.03475182720936666
Bond Position:  [0.29698448]


portfolio before change:  [3.71302484]
curr_Stock_Price:  98.29761669912742
curr_Factors:  [98.2976167]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633429]
Stock Position:  -0.016334285284792978
Bond Position:  [5.31864615]


portfolio before change:  [3.70971802]
curr_Stock_Price:  98.52041463659575
curr_Factors:  [98.52041464]
mat_Sqrt:  [[0.15]]
grads:  [-0.0097235]
Stock Position:  -0.009723502440651122
Bond Position:  [4.66768151]


portfolio before change:  [3.70428222]
curr_Stock_Price:  99.10945476174936
curr_Factors:  [99.10945476]
mat_Sqrt:  [[0.15]]
grads:  [-0.04763808]
Stock Position:  -0.04763807783051075
Bond Position:  [8.42566614]


portfolio before change:  [3.63555823]
curr_Stock_Price:  100.56313679963168
curr_Factors:  [100.5631368]
mat_Sqrt:  [[0.15]]
grads:  [-0.07771201]
Stock Position:  -0.07771200972465477
Bond Position:  [11.45052169]


portfolio before change:  [3.57281368]
curr_Stock_Price:  101.37974448983852
curr_Factors:  [101.37974449]
mat_Sqrt:  [[0.15]]
grads:  [0.01183143]
Stock Position:  0.01183143303719049
Bond Position:  [2.37334602]


portfolio before change:  [3.57754514]
curr_Stock_Price:  101.76711260917459
curr_Factors:  [101.76711261]
mat_Sqrt:  [[0.15]]
grads:  [-0.0259539]
Stock Position:  -0.025953902942430544
Bond Position:  [6.2187989]


portfolio before change:  [3.57068537]
curr_Stock_Price:  102.04639459207955
curr_Factors:  [102.04639459]
mat_Sqrt:  [[0.15]]
grads:  [-0.02023911]
Stock Position:  -0.020239107799601138
Bond Position:  [5.63601335]


portfolio before change:  [3.55703055]
curr_Stock_Price:  102.73847464630964
curr_Factors:  [102.73847465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02102608]
Stock Position:  -0.02102608016343514
Bond Position:  [5.71721795]


portfolio before change:  [3.55604858]
curr_Stock_Price:  102.80217211277203
curr_Factors:  [102.80217211]
mat_Sqrt:  [[0.15]]
grads:  [0.07167493]
Stock Position:  0.07167492640194366
Bond Position:  [-3.81228954]


portfolio before change:  [3.54579506]
curr_Stock_Price:  102.6624406126795
curr_Factors:  [102.66244061]
mat_Sqrt:  [[0.15]]
grads:  [-0.06338277]
Stock Position:  -0.06338276860064929
Bond Position:  [10.05282477]


portfolio before change:  [3.57286806]
curr_Stock_Price:  102.24521873883464
curr_Factors:  [102.24521874]
mat_Sqrt:  [[0.15]]
grads:  [0.04070845]
Stock Position:  0.040708452791831835
Bond Position:  [-0.5893766]


portfolio before change:  [3.5747245]
curr_Stock_Price:  102.29172711833995
curr_Factors:  [102.29172712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02616624]
Stock Position:  -0.026166235733629015
Bond Position:  [6.25131395]


portfolio before change:  [3.58965737]
curr_Stock_Price:  101.73596700771391
curr_Factors:  [101.73596701]
mat_Sqrt:  [[0.15]]
grads:  [-0.0129635]
Stock Position:  -0.012963495299313248
Bond Position:  [4.9085111]


portfolio before change:  [3.60131387]
curr_Stock_Price:  100.86045387073318
curr_Factors:  [100.86045387]
mat_Sqrt:  [[0.15]]
grads:  [0.04422091]
Stock Position:  0.04422091303500683
Bond Position:  [-0.85882748]


portfolio before change:  [3.57667852]
curr_Stock_Price:  100.30457046495758
curr_Factors:  [100.30457046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05476656]
Stock Position:  -0.054766558984829496
Bond Position:  [9.0700147]


portfolio before change:  [3.54250581]
curr_Stock_Price:  100.9388920868734
curr_Factors:  [100.93889209]
mat_Sqrt:  [[0.15]]
grads:  [0.04962727]
Stock Position:  0.04962726924349212
Bond Position:  [-1.46681577]


portfolio before change:  [3.54403863]
curr_Stock_Price:  100.97162623788236
curr_Factors:  [100.97162624]
mat_Sqrt:  [[0.15]]
grads:  [0.16900324]
Stock Position:  0.16900323803057585
Bond Position:  [-13.52049315]


portfolio before change:  [3.60885402]
curr_Stock_Price:  101.36014211336072
curr_Factors:  [101.36014211]
mat_Sqrt:  [[0.15]]
grads:  [0.03636979]
Stock Position:  0.03636978555565744
Bond Position:  [-0.07759262]


portfolio before change:  [3.61186267]
curr_Stock_Price:  101.44299944542648
curr_Factors:  [101.44299945]
mat_Sqrt:  [[0.15]]
grads:  [0.08065156]
Stock Position:  0.08065155612438382
Bond Position:  [-4.56967309]


portfolio before change:  [3.59028449]
curr_Stock_Price:  101.17899250020027
curr_Factors:  [101.1789925]
mat_Sqrt:  [[0.15]]
grads:  [0.01206459]
Stock Position:  0.012064587934532835
Bond Position:  [2.36960163]


portfolio before change:  [3.58560712]
curr_Stock_Price:  100.77902242961613
curr_Factors:  [100.77902243]
mat_Sqrt:  [[0.15]]
grads:  [0.01768442]
Stock Position:  0.01768441869129668
Bond Position:  [1.80338869]


portfolio before change:  [3.60231066]
curr_Stock_Price:  101.71718310652533
curr_Factors:  [101.71718311]
mat_Sqrt:  [[0.15]]
grads:  [0.13096155]
Stock Position:  0.13096154914401956
Bond Position:  [-9.71872922]


portfolio before change:  [3.64952792]
curr_Stock_Price:  102.08236435835643
curr_Factors:  [102.08236436]
mat_Sqrt:  [[0.15]]
grads:  [0.00411368]
Stock Position:  0.00411367954546458
Bond Position:  [3.22959379]


portfolio before change:  [3.65003995]
curr_Stock_Price:  102.15776542628288
curr_Factors:  [102.15776543]
mat_Sqrt:  [[0.15]]
grads:  [-0.10383582]
Stock Position:  -0.10383582366698214
Bond Position:  [14.25767567]


portfolio before change:  [3.55080952]
curr_Stock_Price:  103.12199495437801
curr_Factors:  [103.12199495]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520961]
Stock Position:  -0.015209605185474255
Bond Position:  [5.11925435]


portfolio before change:  [3.53861586]
curr_Stock_Price:  103.94473984612245
curr_Factors:  [103.94473985]
mat_Sqrt:  [[0.15]]
grads:  [0.00673519]
Stock Position:  0.00673518954770299
Bond Position:  [2.83852833]


portfolio before change:  [3.54245136]
curr_Stock_Price:  104.4878713338402
curr_Factors:  [104.48787133]
mat_Sqrt:  [[0.15]]
grads:  [0.00874741]
Stock Position:  0.008747406096921059
Bond Position:  [2.62845352]


portfolio before change:  [3.54520384]
curr_Stock_Price:  104.78375213900239
curr_Factors:  [104.78375214]
mat_Sqrt:  [[0.15]]
grads:  [-0.13647466]
Stock Position:  -0.1364746605912506
Bond Position:  [17.84553085]


portfolio before change:  [3.55779009]
curr_Stock_Price:  104.69970083080779
curr_Factors:  [104.69970083]
mat_Sqrt:  [[0.15]]
grads:  [-0.02717221]
Stock Position:  -0.027172212608881655
Bond Position:  [6.40271262]


portfolio before change:  [3.53084249]
curr_Stock_Price:  105.7061621220371
curr_Factors:  [105.70616212]
mat_Sqrt:  [[0.15]]
grads:  [0.09439897]
Stock Position:  0.09439896701270162
Bond Position:  [-6.44771002]


portfolio before change:  [3.54687055]
curr_Stock_Price:  105.88022181385502
curr_Factors:  [105.88022181]
mat_Sqrt:  [[0.15]]
grads:  [0.13703959]
Stock Position:  0.13703958687684312
Bond Position:  [-10.9629113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.5802284]
Stock Price:  106.12863947854855
PL:  [-2.54841107]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39496152e-02]
 [ 3.86552530e-02]
 [ 2.00138704e-02]
 [-7.07333277e-03]
 [ 1.43881435e-02]
 [-1.10403222e-02]
 [ 2.24592222e-03]
 [-3.65138783e-03]
 [-6.73514132e-03]
 [ 1.08157923e-03]
 [ 1.39861557e-02]
 [-9.36008333e-04]
 [-3.16560689e-03]
 [ 9.51272677e-03]
 [-6.64128623e-04]
 [ 1.22299722e-02]
 [ 3.48303969e-02]
 [-1.47117195e-02]
 [ 2.26574177e-02]
 [ 2.64394347e-03]
 [-3.84895800e-03]
 [ 5.29840747e-03]
 [ 1.70372121e-02]
 [ 1.78377549e-02]
 [-5.97350726e-03]
 [ 5.48711801e-03]
 [-6.01870259e-03]
 [ 5.47937785e-03]
 [ 3.21644261e-02]
 [ 2.80569720e-03]
 [-6.07200559e-03]
 [ 1.07264548e-02]
 [ 1.26990041e-02]
 [ 7.91693325e-03]
 [ 1.98486023e-03]
 [ 1.83281537e-02]
 [ 6.87403855e-03]
 [ 5.19077173e-04]
 [-3.34493055e-02]
 [-1.34599648e-02]
 [ 7.05887647e-03]
 [ 3.21169009e-02]
 [-3.29395693e-03]
 [ 7.51892233e-03]
 [-1.76121500e-02]
 [ 1.80901761e-02]
 [ 1.06294225e-02]
 [ 4.65552327e-03]
 [ 6.16883921e-03]
 [-2.19840051e-03]
 [-2.58200695e-03]
 [-4.38685510e-03]
 [ 1.55042139e-03]
 [ 5.14064369e-03]
 [-6.64728134e-03]
 [-4.37042552e-03]
 [ 2.02374881e-03]
 [ 6.08912303e-03]
 [ 7.39903347e-03]
 [-4.02736842e-03]
 [-7.55524573e-04]
 [ 5.64637169e-03]
 [-7.98944811e-03]
 [ 7.75116743e-03]
 [ 2.41813534e-02]
 [ 5.47996381e-03]
 [ 7.43924472e-03]
 [-1.40689293e-03]
 [ 2.94062511e-03]
 [ 2.11739491e-02]
 [ 4.67656232e-04]
 [-1.59429622e-02]
 [-2.00742626e-03]
 [ 1.33440110e-03]
 [ 1.31571455e-03]
 [-1.28814463e-02]
 [-4.36258061e-03]
 [ 1.48496958e-02]
 [-1.25027197e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.91202686]
curr_Stock_Price:  99.82096523648283
curr_Factors:  [99.82096524]
mat_Sqrt:  [[0.15]]
grads:  [-0.09299743]
Stock Position:  -0.09299743499670998
Bond Position:  [7.37106687]


portfolio before change:  [-2.01772798]
curr_Stock_Price:  100.96252177700093
curr_Factors:  [100.96252178]
mat_Sqrt:  [[0.15]]
grads:  [0.25770169]
Stock Position:  0.2577016867470633
Bond Position:  [-28.03594014]


portfolio before change:  [-2.00211974]
curr_Stock_Price:  101.02988860142545
curr_Factors:  [101.0298886]
mat_Sqrt:  [[0.15]]
grads:  [0.1334258]
Stock Position:  0.13342580286625222
Bond Position:  [-15.48211374]


portfolio before change:  [-2.13010625]
curr_Stock_Price:  100.0779074747562
curr_Factors:  [100.07790747]
mat_Sqrt:  [[0.15]]
grads:  [-0.04715555]
Stock Position:  -0.04715555179038289
Bond Position:  [2.5891227]


portfolio before change:  [-2.11175672]
curr_Stock_Price:  99.69221155178569
curr_Factors:  [99.69221155]
mat_Sqrt:  [[0.15]]
grads:  [0.09592096]
Stock Position:  0.09592095699781342
Bond Position:  [-11.67432906]


portfolio before change:  [-2.12771791]
curr_Stock_Price:  99.5334191688443
curr_Factors:  [99.53341917]
mat_Sqrt:  [[0.15]]
grads:  [-0.07360215]
Stock Position:  -0.07360214767683389
Bond Position:  [5.19815551]


portfolio before change:  [-2.14595153]
curr_Stock_Price:  99.78556557522049
curr_Factors:  [99.78556558]
mat_Sqrt:  [[0.15]]
grads:  [0.01497281]
Stock Position:  0.014972814804925055
Bond Position:  [-3.64002232]


portfolio before change:  [-2.14658083]
curr_Stock_Price:  99.7587305940795
curr_Factors:  [99.75873059]
mat_Sqrt:  [[0.15]]
grads:  [-0.02434259]
Stock Position:  -0.024342585537942853
Bond Position:  [0.2818046]


portfolio before change:  [-2.1516925]
curr_Stock_Price:  99.96944274305058
curr_Factors:  [99.96944274]
mat_Sqrt:  [[0.15]]
grads:  [-0.04490094]
Stock Position:  -0.04490094215600749
Bond Position:  [2.33702967]


portfolio before change:  [-2.17088049]
curr_Stock_Price:  100.40003648958321
curr_Factors:  [100.40003649]
mat_Sqrt:  [[0.15]]
grads:  [0.00721053]
Stock Position:  0.007210528179540122
Bond Position:  [-2.89481779]


portfolio before change:  [-2.17420846]
curr_Stock_Price:  99.96358707589103
curr_Factors:  [99.96358708]
mat_Sqrt:  [[0.15]]
grads:  [0.09324104]
Stock Position:  0.0932410379338006
Bond Position:  [-11.49491707]


portfolio before change:  [-2.13207371]
curr_Stock_Price:  100.42318295932176
curr_Factors:  [100.42318296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624006]
Stock Position:  -0.006240055554790116
Bond Position:  [-1.50542747]


portfolio before change:  [-2.13485775]
curr_Stock_Price:  100.8542592542489
curr_Factors:  [100.85425925]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110405]
Stock Position:  -0.021104045937873964
Bond Position:  [-0.00642482]


portfolio before change:  [-2.11941619]
curr_Stock_Price:  100.12255337863567
curr_Factors:  [100.12255338]
mat_Sqrt:  [[0.15]]
grads:  [0.06341818]
Stock Position:  0.06341817843979287
Bond Position:  [-8.46900615]


portfolio before change:  [-2.12979413]
curr_Stock_Price:  99.9672570742546
curr_Factors:  [99.96725707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00442752]
Stock Position:  -0.004427524154905725
Bond Position:  [-1.68718669]


portfolio before change:  [-2.12843555]
curr_Stock_Price:  99.63659065969142
curr_Factors:  [99.63659066]
mat_Sqrt:  [[0.15]]
grads:  [0.08153315]
Stock Position:  0.08153314805821535
Bond Position:  [-10.25212045]


portfolio before change:  [-2.09262771]
curr_Stock_Price:  100.08363117561397
curr_Factors:  [100.08363118]
mat_Sqrt:  [[0.15]]
grads:  [0.23220265]
Stock Position:  0.2322026463234837
Bond Position:  [-25.33231172]


portfolio before change:  [-2.33295762]
curr_Stock_Price:  99.05544913344659
curr_Factors:  [99.05544913]
mat_Sqrt:  [[0.15]]
grads:  [-0.09807813]
Stock Position:  -0.09807812971689653
Bond Position:  [7.38221557]


portfolio before change:  [-2.34398552]
curr_Stock_Price:  99.17259352846948
curr_Factors:  [99.17259353]
mat_Sqrt:  [[0.15]]
grads:  [0.15104945]
Stock Position:  0.15104945124851785
Bond Position:  [-17.32395135]


portfolio before change:  [-2.19404245]
curr_Stock_Price:  100.17243727188225
curr_Factors:  [100.17243727]
mat_Sqrt:  [[0.15]]
grads:  [0.01762629]
Stock Position:  0.017626289816493567
Bond Position:  [-3.95971086]


portfolio before change:  [-2.20059207]
curr_Stock_Price:  99.81489591361444
curr_Factors:  [99.81489591]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565972]
Stock Position:  -0.02565971996853611
Bond Position:  [0.36063021]


portfolio before change:  [-2.18070349]
curr_Stock_Price:  99.04068492467987
curr_Factors:  [99.04068492]
mat_Sqrt:  [[0.15]]
grads:  [0.03532272]
Stock Position:  0.035322716476590556
Bond Position:  [-5.67908952]


portfolio before change:  [-2.19150814]
curr_Stock_Price:  98.74484989072226
curr_Factors:  [98.74484989]
mat_Sqrt:  [[0.15]]
grads:  [0.11358141]
Stock Position:  0.11358141371903094
Bond Position:  [-13.40708779]


portfolio before change:  [-2.14436078]
curr_Stock_Price:  99.16732505541066
curr_Factors:  [99.16732506]
mat_Sqrt:  [[0.15]]
grads:  [0.11891837]
Stock Position:  0.11891836616379346
Bond Position:  [-13.93717706]


portfolio before change:  [-2.08904193]
curr_Stock_Price:  99.63983368030374
curr_Factors:  [99.63983368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03982338]
Stock Position:  -0.03982338174466419
Bond Position:  [1.8789532]


portfolio before change:  [-2.11997066]
curr_Stock_Price:  100.41943016185753
curr_Factors:  [100.41943016]
mat_Sqrt:  [[0.15]]
grads:  [0.03658079]
Stock Position:  0.0365807867378191
Bond Position:  [-5.79339242]


portfolio before change:  [-2.10841512]
curr_Stock_Price:  100.74521983462519
curr_Factors:  [100.74521983]
mat_Sqrt:  [[0.15]]
grads:  [-0.04012468]
Stock Position:  -0.040124683955412764
Bond Position:  [1.93395499]


portfolio before change:  [-2.10156207]
curr_Stock_Price:  100.57743848497837
curr_Factors:  [100.57743848]
mat_Sqrt:  [[0.15]]
grads:  [0.03652919]
Stock Position:  0.03652918563736518
Bond Position:  [-5.77557399]


portfolio before change:  [-2.09201788]
curr_Stock_Price:  100.84859617772013
curr_Factors:  [100.84859618]
mat_Sqrt:  [[0.15]]
grads:  [0.21442951]
Stock Position:  0.21442950746195566
Bond Position:  [-23.71693269]


portfolio before change:  [-2.03395531]
curr_Stock_Price:  101.12628614724179
curr_Factors:  [101.12628615]
mat_Sqrt:  [[0.15]]
grads:  [0.01870465]
Stock Position:  0.01870464801474662
Bond Position:  [-3.9254869]


portfolio before change:  [-2.03794542]
curr_Stock_Price:  100.92608152510893
curr_Factors:  [100.92608153]
mat_Sqrt:  [[0.15]]
grads:  [-0.04048004]
Stock Position:  -0.040480037287785535
Bond Position:  [2.04754612]


portfolio before change:  [-2.03545349]
curr_Stock_Price:  100.86768338021271
curr_Factors:  [100.86768338]
mat_Sqrt:  [[0.15]]
grads:  [0.0715097]
Stock Position:  0.07150969835131962
Bond Position:  [-9.2484711]


portfolio before change:  [-1.99465157]
curr_Stock_Price:  101.4463456414907
curr_Factors:  [101.44634564]
mat_Sqrt:  [[0.15]]
grads:  [0.08466003]
Stock Position:  0.08466002748432251
Bond Position:  [-10.58310198]


portfolio before change:  [-2.06018621]
curr_Stock_Price:  100.68006694651393
curr_Factors:  [100.68006695]
mat_Sqrt:  [[0.15]]
grads:  [0.05277956]
Stock Position:  0.05277955501956378
Bond Position:  [-7.37403534]


portfolio before change:  [-2.1446909]
curr_Stock_Price:  99.08771165395245
curr_Factors:  [99.08771165]
mat_Sqrt:  [[0.15]]
grads:  [0.0132324]
Stock Position:  0.013232401531155286
Bond Position:  [-3.45585929]


portfolio before change:  [-2.15286591]
curr_Stock_Price:  98.48623260802688
curr_Factors:  [98.48623261]
mat_Sqrt:  [[0.15]]
grads:  [0.12218769]
Stock Position:  0.12218769152499333
Bond Position:  [-14.18667132]


portfolio before change:  [-2.29978851]
curr_Stock_Price:  97.29105571986169
curr_Factors:  [97.29105572]
mat_Sqrt:  [[0.15]]
grads:  [0.04582692]
Stock Position:  0.045826923689513875
Bond Position:  [-6.7583383]


portfolio before change:  [-2.25762089]
curr_Stock_Price:  98.2204228614882
curr_Factors:  [98.22042286]
mat_Sqrt:  [[0.15]]
grads:  [0.00346051]
Stock Position:  0.0034605144856940384
Bond Position:  [-2.59751408]


portfolio before change:  [-2.25751711]
curr_Stock_Price:  98.29732748667088
curr_Factors:  [98.29732749]
mat_Sqrt:  [[0.15]]
grads:  [-0.22299537]
Stock Position:  -0.2229953700071207
Bond Position:  [19.66233181]


portfolio before change:  [-2.01219084]
curr_Stock_Price:  97.20269789299
curr_Factors:  [97.20269789]
mat_Sqrt:  [[0.15]]
grads:  [-0.0897331]
Stock Position:  -0.08973309859664631
Bond Position:  [6.71010843]


portfolio before change:  [-2.00625095]
curr_Stock_Price:  97.14117663417656
curr_Factors:  [97.14117663]
mat_Sqrt:  [[0.15]]
grads:  [0.04705918]
Stock Position:  0.04705917646463822
Bond Position:  [-6.57763473]


portfolio before change:  [-2.00198338]
curr_Stock_Price:  97.2405980954327
curr_Factors:  [97.2405981]
mat_Sqrt:  [[0.15]]
grads:  [0.21411267]
Stock Position:  0.21411267247020774
Bond Position:  [-22.82242771]


portfolio before change:  [-2.03923288]
curr_Stock_Price:  97.07328869554895
curr_Factors:  [97.0732887]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195971]
Stock Position:  -0.021959712897962107
Bond Position:  [0.09246866]


portfolio before change:  [-2.03602737]
curr_Stock_Price:  96.9275791584884
curr_Factors:  [96.92757916]
mat_Sqrt:  [[0.15]]
grads:  [0.05012615]
Stock Position:  0.05012614888840803
Bond Position:  [-6.89463363]


portfolio before change:  [-2.01451641]
curr_Stock_Price:  97.36531234700308
curr_Factors:  [97.36531235]
mat_Sqrt:  [[0.15]]
grads:  [-0.11741433]
Stock Position:  -0.11741433338295797
Bond Position:  [9.41756683]


portfolio before change:  [-2.00824041]
curr_Stock_Price:  97.3168737063534
curr_Factors:  [97.31687371]
mat_Sqrt:  [[0.15]]
grads:  [0.12060117]
Stock Position:  0.12060117418208931
Bond Position:  [-13.74476964]


portfolio before change:  [-1.83043138]
curr_Stock_Price:  98.798352704726
curr_Factors:  [98.7983527]
mat_Sqrt:  [[0.15]]
grads:  [0.07086282]
Stock Position:  0.07086281670758351
Bond Position:  [-8.83156093]


portfolio before change:  [-1.79669625]
curr_Stock_Price:  99.28220466156452
curr_Factors:  [99.28220466]
mat_Sqrt:  [[0.15]]
grads:  [0.03103682]
Stock Position:  0.03103682177104643
Bond Position:  [-4.87810034]


portfolio before change:  [-1.78889237]
curr_Stock_Price:  99.54346760647185
curr_Factors:  [99.54346761]
mat_Sqrt:  [[0.15]]
grads:  [0.04112559]
Stock Position:  0.041125594717603756
Bond Position:  [-5.88267668]


portfolio before change:  [-1.78019107]
curr_Stock_Price:  99.76398669326011
curr_Factors:  [99.76398669]
mat_Sqrt:  [[0.15]]
grads:  [-0.014656]
Stock Position:  -0.014656003403437631
Bond Position:  [-0.31804974]


portfolio before change:  [-1.78179913]
curr_Stock_Price:  99.87235054055218
curr_Factors:  [99.87235054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721338]
Stock Position:  -0.01721337964332053
Bond Position:  [-0.06265845]


portfolio before change:  [-1.77670728]
curr_Stock_Price:  99.5763154078049
curr_Factors:  [99.57631541]
mat_Sqrt:  [[0.15]]
grads:  [-0.0292457]
Stock Position:  -0.029245700688279152
Bond Position:  [1.13547183]


portfolio before change:  [-1.76007159]
curr_Stock_Price:  99.00991687810497
curr_Factors:  [99.00991688]
mat_Sqrt:  [[0.15]]
grads:  [0.01033614]
Stock Position:  0.010336142586431575
Bond Position:  [-2.78345221]


portfolio before change:  [-1.75535928]
curr_Stock_Price:  99.48265438679968
curr_Factors:  [99.48265439]
mat_Sqrt:  [[0.15]]
grads:  [0.03427096]
Stock Position:  0.03427095791187256
Bond Position:  [-5.16472514]


portfolio before change:  [-1.76601337]
curr_Stock_Price:  99.18119555397135
curr_Factors:  [99.18119555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04431521]
Stock Position:  -0.04431520895363425
Bond Position:  [2.62922204]


portfolio before change:  [-1.78189188]
curr_Stock_Price:  99.5432122606362
curr_Factors:  [99.54321226]
mat_Sqrt:  [[0.15]]
grads:  [-0.02913617]
Stock Position:  -0.02913617012259704
Bond Position:  [1.11841608]


portfolio before change:  [-1.77107967]
curr_Stock_Price:  99.17451891808359
curr_Factors:  [99.17451892]
mat_Sqrt:  [[0.15]]
grads:  [0.01349166]
Stock Position:  0.013491658742497982
Bond Position:  [-3.10910843]


portfolio before change:  [-1.76835288]
curr_Stock_Price:  99.39103170373939
curr_Factors:  [99.3910317]
mat_Sqrt:  [[0.15]]
grads:  [0.04059415]
Stock Position:  0.04059415350138462
Bond Position:  [-5.80304768]


portfolio before change:  [-1.77107174]
curr_Stock_Price:  99.3329897501344
curr_Factors:  [99.33298975]
mat_Sqrt:  [[0.15]]
grads:  [0.04932689]
Stock Position:  0.04932688980684443
Bond Position:  [-6.67085918]


portfolio before change:  [-1.71734341]
curr_Stock_Price:  100.43067255318003
curr_Factors:  [100.43067255]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684912]
Stock Position:  -0.026849122771733874
Bond Position:  [0.97913205]


portfolio before change:  [-1.71939974]
curr_Stock_Price:  100.50954020253342
curr_Factors:  [100.5095402]
mat_Sqrt:  [[0.15]]
grads:  [-0.00503683]
Stock Position:  -0.0050368304871982695
Bond Position:  [-1.21315022]


portfolio before change:  [-1.71898675]
curr_Stock_Price:  100.41249330804702
curr_Factors:  [100.41249331]
mat_Sqrt:  [[0.15]]
grads:  [0.03764248]
Stock Position:  0.037642477947697824
Bond Position:  [-5.49876182]


portfolio before change:  [-1.72878609]
curr_Stock_Price:  100.16129701923778
curr_Factors:  [100.16129702]
mat_Sqrt:  [[0.15]]
grads:  [-0.05326299]
Stock Position:  -0.05326298743016039
Bond Position:  [3.60610382]


portfolio before change:  [-1.74421965]
curr_Stock_Price:  100.4552901754045
curr_Factors:  [100.45529018]
mat_Sqrt:  [[0.15]]
grads:  [0.05167445]
Stock Position:  0.051674449553656514
Bond Position:  [-6.93519148]


portfolio before change:  [-1.75429769]
curr_Stock_Price:  100.26864912514668
curr_Factors:  [100.26864913]
mat_Sqrt:  [[0.15]]
grads:  [0.16120902]
Stock Position:  0.16120902258861303
Bond Position:  [-17.91850861]


portfolio before change:  [-1.80427195]
curr_Stock_Price:  99.96559960815634
curr_Factors:  [99.96559961]
mat_Sqrt:  [[0.15]]
grads:  [0.03653309]
Stock Position:  0.03653309206815182
Bond Position:  [-5.4563244]


portfolio before change:  [-1.79706644]
curr_Stock_Price:  100.17216682348055
curr_Factors:  [100.17216682]
mat_Sqrt:  [[0.15]]
grads:  [0.04959496]
Stock Position:  0.049594964769772584
Bond Position:  [-6.76510152]


portfolio before change:  [-1.79985815]
curr_Stock_Price:  100.12440227980146
curr_Factors:  [100.12440228]
mat_Sqrt:  [[0.15]]
grads:  [-0.00937929]
Stock Position:  -0.009379286168193366
Bond Position:  [-0.86076273]


portfolio before change:  [-1.81003862]
curr_Stock_Price:  101.20408728300413
curr_Factors:  [101.20408728]
mat_Sqrt:  [[0.15]]
grads:  [0.01960417]
Stock Position:  0.019604167389937397
Bond Position:  [-3.79406049]


portfolio before change:  [-1.82763091]
curr_Stock_Price:  100.31880880706399
curr_Factors:  [100.31880881]
mat_Sqrt:  [[0.15]]
grads:  [0.14115966]
Stock Position:  0.14115966055213786
Bond Position:  [-15.98859991]


portfolio before change:  [-1.82251895]
curr_Stock_Price:  100.36210216576498
curr_Factors:  [100.36210217]
mat_Sqrt:  [[0.15]]
grads:  [0.00311771]
Stock Position:  0.003117708214191263
Bond Position:  [-2.1354187]


portfolio before change:  [-1.82085938]
curr_Stock_Price:  100.9372153706021
curr_Factors:  [100.93721537]
mat_Sqrt:  [[0.15]]
grads:  [-0.10628641]
Stock Position:  -0.10628641494057542
Bond Position:  [8.90739537]


portfolio before change:  [-1.76005307]
curr_Stock_Price:  100.37035475711848
curr_Factors:  [100.37035476]
mat_Sqrt:  [[0.15]]
grads:  [-0.01338284]
Stock Position:  -0.013382841756018327
Bond Position:  [-0.4168125]


portfolio before change:  [-1.77856595]
curr_Stock_Price:  101.75173741726486
curr_Factors:  [101.75173742]
mat_Sqrt:  [[0.15]]
grads:  [0.00889601]
Stock Position:  0.008896007362369616
Bond Position:  [-2.68375015]


portfolio before change:  [-1.77925155]
curr_Stock_Price:  101.69352411731072
curr_Factors:  [101.69352412]
mat_Sqrt:  [[0.15]]
grads:  [0.00877143]
Stock Position:  0.008771430342382983
Bond Position:  [-2.67124922]


portfolio before change:  [-1.78093169]
curr_Stock_Price:  101.52101174304318
curr_Factors:  [101.52101174]
mat_Sqrt:  [[0.15]]
grads:  [-0.08587631]
Stock Position:  -0.08587630838431447
Bond Position:  [6.93731802]


portfolio before change:  [-1.73486705]
curr_Stock_Price:  100.9896539043706
curr_Factors:  [100.9896539]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908387]
Stock Position:  -0.029083870702716494
Bond Position:  [1.20230299]


portfolio before change:  [-1.73126916]
curr_Stock_Price:  100.86853048572793
curr_Factors:  [100.86853049]
mat_Sqrt:  [[0.15]]
grads:  [0.09899797]
Stock Position:  0.09899797192975941
Bond Position:  [-11.71704911]


portfolio before change:  [-1.71190648]
curr_Stock_Price:  101.07151464151484
curr_Factors:  [101.07151464]
mat_Sqrt:  [[0.15]]
grads:  [-0.08335146]
Stock Position:  -0.08335146462017688
Bond Position:  [6.71255229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68474362]
Stock Price:  100.75066465976342
PL:  [-2.43540828]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39915377e-02]
 [ 1.68427183e-04]
 [ 4.51886087e-03]
 [-8.58679220e-03]
 [ 1.21606032e-02]
 [-1.37573604e-02]
 [ 2.17094392e-04]
 [ 6.57879641e-04]
 [-7.76525932e-03]
 [-7.44977715e-04]
 [ 1.45198060e-02]
 [-4.64113950e-03]
 [-1.09533353e-03]
 [ 5.29559741e-03]
 [-3.73206732e-03]
 [ 1.15257871e-02]
 [ 9.94327451e-03]
 [-1.27030769e-02]
 [ 2.50547329e-02]
 [-1.91930533e-03]
 [-1.56881257e-02]
 [ 5.87239204e-03]
 [ 1.52574332e-02]
 [ 7.56624886e-03]
 [ 1.51040629e-02]
 [ 4.38740353e-03]
 [ 7.12620327e-05]
 [ 2.75533286e-02]
 [-3.06798929e-02]
 [ 1.05849367e-01]
 [-5.44370085e-03]
 [ 3.42237925e-02]
 [ 1.48735989e-02]
 [-1.86974096e-02]
 [-2.55440037e-02]
 [-1.13355300e-01]
 [ 2.12361600e-02]
 [-1.05652388e-02]
 [ 7.65798142e-02]
 [ 2.92839678e-02]
 [ 6.28888007e-03]
 [ 3.45751420e-02]
 [-3.27394517e-03]
 [ 3.77624692e-02]
 [-1.05607342e-01]
 [ 2.85926707e-02]
 [ 8.27748909e-03]
 [ 5.45193437e-03]
 [-1.57387713e-02]
 [ 6.02948150e-04]
 [ 2.69039626e-03]
 [-4.81482598e-03]
 [-2.00018379e-03]
 [-2.98916441e-04]
 [-2.38166404e-02]
 [-5.78071659e-03]
 [-9.52702402e-03]
 [ 1.49885431e-02]
 [ 4.78312119e-03]
 [-2.06449873e-03]
 [-5.16752510e-03]
 [-4.44749053e-03]
 [ 2.95523862e-03]
 [-8.37665826e-03]
 [ 1.66829953e-02]
 [ 1.08690273e-02]
 [ 2.06330156e-02]
 [-7.71101486e-03]
 [ 1.18274139e-02]
 [ 3.22087552e-02]
 [ 3.22860486e-03]
 [-1.50116350e-02]
 [-5.96543000e-03]
 [ 3.31023139e-03]
 [ 1.23866504e-02]
 [ 1.86942873e-02]
 [ 2.64295972e-03]
 [-2.31572305e-02]
 [-3.21289351e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.39865289]
curr_Stock_Price:  99.79886367965418
curr_Factors:  [99.79886368]
mat_Sqrt:  [[0.15]]
grads:  [-0.09327692]
Stock Position:  -0.09327691829036358
Bond Position:  [6.91027757]


portfolio before change:  [-2.37991707]
curr_Stock_Price:  99.60263170055033
curr_Factors:  [99.6026317]
mat_Sqrt:  [[0.15]]
grads:  [0.00112285]
Stock Position:  0.0011228478877903236
Bond Position:  [-2.49175567]


portfolio before change:  [-2.37985911]
curr_Stock_Price:  99.79294444709295
curr_Factors:  [99.79294445]
mat_Sqrt:  [[0.15]]
grads:  [0.03012574]
Stock Position:  0.030125739108533996
Bond Position:  [-5.38619532]


portfolio before change:  [-2.38662744]
curr_Stock_Price:  99.57945006049454
curr_Factors:  [99.57945006]
mat_Sqrt:  [[0.15]]
grads:  [-0.05724528]
Stock Position:  -0.0572452813334584
Bond Position:  [3.3138262]


portfolio before change:  [-2.41004438]
curr_Stock_Price:  99.99213141020162
curr_Factors:  [99.99213141]
mat_Sqrt:  [[0.15]]
grads:  [0.08107069]
Stock Position:  0.08107068833196521
Bond Position:  [-10.5164753]


portfolio before change:  [-2.50001836]
curr_Stock_Price:  98.89041774346617
curr_Factors:  [98.89041774]
mat_Sqrt:  [[0.15]]
grads:  [-0.09171574]
Stock Position:  -0.0917157358748968
Bond Position:  [6.56978907]


portfolio before change:  [-2.55705685]
curr_Stock_Price:  99.51680006239623
curr_Factors:  [99.51680006]
mat_Sqrt:  [[0.15]]
grads:  [0.0014473]
Stock Position:  0.0014472959450414237
Bond Position:  [-2.70108711]


portfolio before change:  [-2.55745583]
curr_Stock_Price:  99.35777463338114
curr_Factors:  [99.35777463]
mat_Sqrt:  [[0.15]]
grads:  [0.00438586]
Stock Position:  0.004385864271275857
Bond Position:  [-2.99322555]


portfolio before change:  [-2.55530876]
curr_Stock_Price:  99.88997427534198
curr_Factors:  [99.88997428]
mat_Sqrt:  [[0.15]]
grads:  [-0.0517684]
Stock Position:  -0.051768395487731975
Bond Position:  [2.61583493]


portfolio before change:  [-2.56996326]
curr_Stock_Price:  100.17621060942803
curr_Factors:  [100.17621061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00496652]
Stock Position:  -0.00496651809931611
Bond Position:  [-2.0724363]


portfolio before change:  [-2.56875975]
curr_Stock_Price:  99.90780550454488
curr_Factors:  [99.9078055]
mat_Sqrt:  [[0.15]]
grads:  [0.09679871]
Stock Position:  0.09679870679062134
Bond Position:  [-12.23970612]


portfolio before change:  [-2.58716949]
curr_Stock_Price:  99.72552273142429
curr_Factors:  [99.72552273]
mat_Sqrt:  [[0.15]]
grads:  [-0.03094093]
Stock Position:  -0.030940929996454952
Bond Position:  [0.49843092]


portfolio before change:  [-2.5821563]
curr_Stock_Price:  99.56450485585184
curr_Factors:  [99.56450486]
mat_Sqrt:  [[0.15]]
grads:  [-0.00730222]
Stock Position:  -0.0073022235603641475
Bond Position:  [-1.85511403]


portfolio before change:  [-2.57944907]
curr_Stock_Price:  99.17788575151995
curr_Factors:  [99.17788575]
mat_Sqrt:  [[0.15]]
grads:  [0.03530398]
Stock Position:  0.03530398271429098
Bond Position:  [-6.08082343]


portfolio before change:  [-2.59441334]
curr_Stock_Price:  98.76478194398143
curr_Factors:  [98.76478194]
mat_Sqrt:  [[0.15]]
grads:  [-0.02488045]
Stock Position:  -0.02488044877767429
Bond Position:  [-0.13710124]


portfolio before change:  [-2.60998265]
curr_Stock_Price:  99.39020237266969
curr_Factors:  [99.39020237]
mat_Sqrt:  [[0.15]]
grads:  [0.07683858]
Stock Position:  0.07683858094379473
Bond Position:  [-10.24698476]


portfolio before change:  [-2.64660997]
curr_Stock_Price:  98.92185871055685
curr_Factors:  [98.92185871]
mat_Sqrt:  [[0.15]]
grads:  [0.0662885]
Stock Position:  0.06628849676602813
Bond Position:  [-9.20399128]


portfolio before change:  [-2.70168887]
curr_Stock_Price:  98.09964018278285
curr_Factors:  [98.09964018]
mat_Sqrt:  [[0.15]]
grads:  [-0.08468718]
Stock Position:  -0.08468717901638118
Bond Position:  [5.60609292]


portfolio before change:  [-2.75063992]
curr_Stock_Price:  98.68179965816638
curr_Factors:  [98.68179966]
mat_Sqrt:  [[0.15]]
grads:  [0.16703155]
Stock Position:  0.16703155298499964
Bond Position:  [-19.23361417]


portfolio before change:  [-2.86891968]
curr_Stock_Price:  97.98086849452788
curr_Factors:  [97.98086849]
mat_Sqrt:  [[0.15]]
grads:  [-0.01279537]
Stock Position:  -0.012795368878920467
Bond Position:  [-1.61521832]


portfolio before change:  [-2.86048018]
curr_Stock_Price:  97.31340432777202
curr_Factors:  [97.31340433]
mat_Sqrt:  [[0.15]]
grads:  [-0.1045875]
Stock Position:  -0.10458750455053518
Bond Position:  [7.31728593]


portfolio before change:  [-2.78817265]
curr_Stock_Price:  96.62641797369649
curr_Factors:  [96.62641797]
mat_Sqrt:  [[0.15]]
grads:  [0.03914928]
Stock Position:  0.03914928026230627
Bond Position:  [-6.57102737]


portfolio before change:  [-2.82494519]
curr_Stock_Price:  95.6976182796415
curr_Factors:  [95.69761828]
mat_Sqrt:  [[0.15]]
grads:  [0.10171622]
Stock Position:  0.10171622163216487
Bond Position:  [-12.55894534]


portfolio before change:  [-2.84502171]
curr_Stock_Price:  95.50795771766715
curr_Factors:  [95.50795772]
mat_Sqrt:  [[0.15]]
grads:  [0.05044166]
Stock Position:  0.05044165907120909
Bond Position:  [-7.66260155]


portfolio before change:  [-2.84796474]
curr_Stock_Price:  95.45910715324305
curr_Factors:  [95.45910715]
mat_Sqrt:  [[0.15]]
grads:  [0.10069375]
Stock Position:  0.10069375268006625
Bond Position:  [-12.46010046]


portfolio before change:  [-2.86469279]
curr_Stock_Price:  95.3007132433874
curr_Factors:  [95.30071324]
mat_Sqrt:  [[0.15]]
grads:  [0.02924936]
Stock Position:  0.029249356882423312
Bond Position:  [-5.65217737]


portfolio before change:  [-2.86443237]
curr_Stock_Price:  95.32169483887292
curr_Factors:  [95.32169484]
mat_Sqrt:  [[0.15]]
grads:  [0.00047508]
Stock Position:  0.0004750802180960324
Bond Position:  [-2.90971782]


portfolio before change:  [-2.86522855]
curr_Stock_Price:  94.02861692294218
curr_Factors:  [94.02861692]
mat_Sqrt:  [[0.15]]
grads:  [0.18368886]
Stock Position:  0.18368885765591392
Bond Position:  [-20.13723778]


portfolio before change:  [-2.765739]
curr_Stock_Price:  94.57708873756387
curr_Factors:  [94.57708874]
mat_Sqrt:  [[0.15]]
grads:  [-0.20453262]
Stock Position:  -0.20453261937989667
Bond Position:  [16.57836069]


portfolio before change:  [-2.66020918]
curr_Stock_Price:  94.06619886553604
curr_Factors:  [94.06619887]
mat_Sqrt:  [[0.15]]
grads:  [0.70566245]
Stock Position:  0.7056624498630064
Bond Position:  [-69.03919352]


portfolio before change:  [-2.93343648]
curr_Stock_Price:  93.68512117035209
curr_Factors:  [93.68512117]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629134]
Stock Position:  -0.03629133898911036
Bond Position:  [0.46652201]


portfolio before change:  [-2.94059443]
curr_Stock_Price:  93.88316018489063
curr_Factors:  [93.88316018]
mat_Sqrt:  [[0.15]]
grads:  [0.22815862]
Stock Position:  0.22815861670832951
Bond Position:  [-24.36084639]


portfolio before change:  [-3.00817516]
curr_Stock_Price:  93.59363294167461
curr_Factors:  [93.59363294]
mat_Sqrt:  [[0.15]]
grads:  [0.09915733]
Stock Position:  0.09915732613472948
Bond Position:  [-12.28866955]


portfolio before change:  [-3.07033181]
curr_Stock_Price:  92.97453008681478
curr_Factors:  [92.97453009]
mat_Sqrt:  [[0.15]]
grads:  [-0.1246494]
Stock Position:  -0.12464939760447112
Bond Position:  [8.51888736]


portfolio before change:  [-3.04056878]
curr_Stock_Price:  92.7400277012462
curr_Factors:  [92.7400277]
mat_Sqrt:  [[0.15]]
grads:  [-0.17029336]
Stock Position:  -0.17029335776616414
Bond Position:  [12.75244193]


portfolio before change:  [-3.07722527]
curr_Stock_Price:  92.9599630828286
curr_Factors:  [92.95996308]
mat_Sqrt:  [[0.15]]
grads:  [-0.755702]
Stock Position:  -0.755701998625221
Bond Position:  [67.17280463]


portfolio before change:  [-3.37373882]
curr_Stock_Price:  93.35788712005963
curr_Factors:  [93.35788712]
mat_Sqrt:  [[0.15]]
grads:  [0.1415744]
Stock Position:  0.1415744000566763
Bond Position:  [-16.59082568]


portfolio before change:  [-3.38517293]
curr_Stock_Price:  93.28444766377245
curr_Factors:  [93.28444766]
mat_Sqrt:  [[0.15]]
grads:  [-0.07043493]
Stock Position:  -0.0704349251632656
Bond Position:  [3.18531016]


portfolio before change:  [-3.42627009]
curr_Stock_Price:  93.87075118425737
curr_Factors:  [93.87075118]
mat_Sqrt:  [[0.15]]
grads:  [0.51053209]
Stock Position:  0.510532094676424
Bond Position:  [-51.35030132]


portfolio before change:  [-3.22120295]
curr_Stock_Price:  94.27871110281367
curr_Factors:  [94.2787111]
mat_Sqrt:  [[0.15]]
grads:  [0.19522645]
Stock Position:  0.19522645179372644
Bond Position:  [-21.6269012]


portfolio before change:  [-3.31728936]
curr_Stock_Price:  93.79345570362202
curr_Factors:  [93.7934557]
mat_Sqrt:  [[0.15]]
grads:  [0.04192587]
Stock Position:  0.041925867151776215
Bond Position:  [-7.24966133]


portfolio before change:  [-3.33364114]
curr_Stock_Price:  93.41424692501526
curr_Factors:  [93.41424693]
mat_Sqrt:  [[0.15]]
grads:  [0.23050095]
Stock Position:  0.23050094635117782
Bond Position:  [-24.86571346]


portfolio before change:  [-3.27885231]
curr_Stock_Price:  93.65868401046697
curr_Factors:  [93.65868401]
mat_Sqrt:  [[0.15]]
grads:  [-0.0218263]
Stock Position:  -0.021826301102468647
Bond Position:  [-1.23462968]


portfolio before change:  [-3.27431805]
curr_Stock_Price:  93.44740530715934
curr_Factors:  [93.44740531]
mat_Sqrt:  [[0.15]]
grads:  [0.25174979]
Stock Position:  0.2517497947743597
Bond Position:  [-26.79968316]


portfolio before change:  [-3.50750008]
curr_Stock_Price:  92.52781368788317
curr_Factors:  [92.52781369]
mat_Sqrt:  [[0.15]]
grads:  [-0.70404895]
Stock Position:  -0.704048947769478
Bond Position:  [61.63660978]


portfolio before change:  [-3.94706014]
curr_Stock_Price:  93.15761714695773
curr_Factors:  [93.15761715]
mat_Sqrt:  [[0.15]]
grads:  [0.1906178]
Stock Position:  0.19061780459930425
Bond Position:  [-21.7045606]


portfolio before change:  [-3.91388665]
curr_Stock_Price:  93.3387652913356
curr_Factors:  [93.33876529]
mat_Sqrt:  [[0.15]]
grads:  [0.05518326]
Stock Position:  0.05518326062176844
Bond Position:  [-9.06462406]


portfolio before change:  [-3.89778997]
curr_Stock_Price:  93.64072707042953
curr_Factors:  [93.64072707]
mat_Sqrt:  [[0.15]]
grads:  [0.03634623]
Stock Position:  0.036346229124739365
Bond Position:  [-7.30127729]


portfolio before change:  [-3.88712657]
curr_Stock_Price:  93.94666647854942
curr_Factors:  [93.94666648]
mat_Sqrt:  [[0.15]]
grads:  [-0.10492514]
Stock Position:  -0.10492514194997235
Bond Position:  [5.97024074]


portfolio before change:  [-3.76040971]
curr_Stock_Price:  92.74253459204323
curr_Factors:  [92.74253459]
mat_Sqrt:  [[0.15]]
grads:  [0.00401965]
Stock Position:  0.004019654335218947
Bond Position:  [-4.13320264]


portfolio before change:  [-3.75890746]
curr_Stock_Price:  93.18052940383771
curr_Factors:  [93.1805294]
mat_Sqrt:  [[0.15]]
grads:  [0.01793598]
Stock Position:  0.017935975076769965
Bond Position:  [-5.43019111]


portfolio before change:  [-3.76679709]
curr_Stock_Price:  92.75957457240678
curr_Factors:  [92.75957457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209884]
Stock Position:  -0.032098839843761065
Bond Position:  [-0.78932236]


portfolio before change:  [-3.78030566]
curr_Stock_Price:  93.17888045566707
curr_Factors:  [93.17888046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01333456]
Stock Position:  -0.01333455861428236
Bond Position:  [-2.53780641]


portfolio before change:  [-3.77725229]
curr_Stock_Price:  92.93800336353127
curr_Factors:  [92.93800336]
mat_Sqrt:  [[0.15]]
grads:  [-0.00199278]
Stock Position:  -0.0019927762739539957
Bond Position:  [-3.59204764]


portfolio before change:  [-3.77737649]
curr_Stock_Price:  92.88766643607383
curr_Factors:  [92.88766644]
mat_Sqrt:  [[0.15]]
grads:  [-0.1587776]
Stock Position:  -0.15877760290005566
Bond Position:  [10.97110453]


portfolio before change:  [-3.79465181]
curr_Stock_Price:  93.00078715997152
curr_Factors:  [93.00078716]
mat_Sqrt:  [[0.15]]
grads:  [-0.03853811]
Stock Position:  -0.03853811060778429
Bond Position:  [-0.21057719]


portfolio before change:  [-3.76509875]
curr_Stock_Price:  92.23359281040892
curr_Factors:  [92.23359281]
mat_Sqrt:  [[0.15]]
grads:  [-0.06351349]
Stock Position:  -0.06351349346814171
Bond Position:  [2.09297895]


portfolio before change:  [-3.79811554]
curr_Stock_Price:  92.75549153295017
curr_Factors:  [92.75549153]
mat_Sqrt:  [[0.15]]
grads:  [0.09992362]
Stock Position:  0.09992362088547665
Bond Position:  [-13.06658011]


portfolio before change:  [-3.81248966]
curr_Stock_Price:  92.6198136484667
curr_Factors:  [92.61981365]
mat_Sqrt:  [[0.15]]
grads:  [0.03188747]
Stock Position:  0.03188747460234604
Bond Position:  [-6.76590161]


portfolio before change:  [-3.80274921]
curr_Stock_Price:  92.9385382797036
curr_Factors:  [92.93853828]
mat_Sqrt:  [[0.15]]
grads:  [-0.01376332]
Stock Position:  -0.013763324891191354
Bond Position:  [-2.52360592]


portfolio before change:  [-3.80741798]
curr_Stock_Price:  93.26629591452075
curr_Factors:  [93.26629591]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445017]
Stock Position:  -0.034450167324234955
Bond Position:  [-0.59437848]


portfolio before change:  [-3.80526447]
curr_Stock_Price:  93.20270659558496
curr_Factors:  [93.2027066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02964994]
Stock Position:  -0.029649936864701954
Bond Position:  [-1.0418101]


portfolio before change:  [-3.7968905]
curr_Stock_Price:  92.91808269774967
curr_Factors:  [92.9180827]
mat_Sqrt:  [[0.15]]
grads:  [0.01970159]
Stock Position:  0.019701590798985882
Bond Position:  [-5.62752454]


portfolio before change:  [-3.80157195]
curr_Stock_Price:  92.69831774124795
curr_Factors:  [92.69831774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05584439]
Stock Position:  -0.05584438841457843
Bond Position:  [1.37510891]


portfolio before change:  [-3.82083831]
curr_Stock_Price:  93.04485761721035
curr_Factors:  [93.04485762]
mat_Sqrt:  [[0.15]]
grads:  [0.11121997]
Stock Position:  0.11121996868523448
Bond Position:  [-14.16928446]


portfolio before change:  [-3.8698032]
curr_Stock_Price:  92.61256766620718
curr_Factors:  [92.61256767]
mat_Sqrt:  [[0.15]]
grads:  [0.07246018]
Stock Position:  0.07246018166672057
Bond Position:  [-10.58052667]


portfolio before change:  [-3.88491083]
curr_Stock_Price:  92.41319837495654
curr_Factors:  [92.41319837]
mat_Sqrt:  [[0.15]]
grads:  [0.13755344]
Stock Position:  0.1375534370163321
Bond Position:  [-16.5966639]


portfolio before change:  [-3.98952767]
curr_Stock_Price:  91.66018547431868
curr_Factors:  [91.66018547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05140677]
Stock Position:  -0.05140676572164106
Bond Position:  [0.72242601]


portfolio before change:  [-3.95552854]
curr_Stock_Price:  90.9996892397127
curr_Factors:  [90.99968924]
mat_Sqrt:  [[0.15]]
grads:  [0.07884943]
Stock Position:  0.07884942628846008
Bond Position:  [-11.13080183]


portfolio before change:  [-3.88047764]
curr_Stock_Price:  91.9603378923971
curr_Factors:  [91.96033789]
mat_Sqrt:  [[0.15]]
grads:  [0.21472503]
Stock Position:  0.21472503435131024
Bond Position:  [-23.62666436]


portfolio before change:  [-3.84952101]
curr_Stock_Price:  92.11138384342676
curr_Factors:  [92.11138384]
mat_Sqrt:  [[0.15]]
grads:  [0.02152403]
Stock Position:  0.02152403238278602
Bond Position:  [-5.83212942]


portfolio before change:  [-3.8325586]
curr_Stock_Price:  92.916387803114
curr_Factors:  [92.9163878]
mat_Sqrt:  [[0.15]]
grads:  [-0.10007757]
Stock Position:  -0.10007756682961366
Bond Position:  [5.46628741]


portfolio before change:  [-3.82068742]
curr_Stock_Price:  92.80118193798201
curr_Factors:  [92.80118194]
mat_Sqrt:  [[0.15]]
grads:  [-0.03976953]
Stock Position:  -0.03976953330200948
Bond Position:  [-0.13002773]


portfolio before change:  [-3.84219498]
curr_Stock_Price:  93.3417825884396
curr_Factors:  [93.34178259]
mat_Sqrt:  [[0.15]]
grads:  [0.02206821]
Stock Position:  0.022068209291075856
Bond Position:  [-5.90208098]


portfolio before change:  [-3.8473553]
curr_Stock_Price:  93.12466385417221
curr_Factors:  [93.12466385]
mat_Sqrt:  [[0.15]]
grads:  [0.08257767]
Stock Position:  0.08257766935647799
Bond Position:  [-11.537373]


portfolio before change:  [-3.87904268]
curr_Stock_Price:  92.74966812695736
curr_Factors:  [92.74966813]
mat_Sqrt:  [[0.15]]
grads:  [0.12462858]
Stock Position:  0.12462858175558797
Bond Position:  [-15.43830228]


portfolio before change:  [-3.70785443]
curr_Stock_Price:  94.13099788368724
curr_Factors:  [94.13099788]
mat_Sqrt:  [[0.15]]
grads:  [0.01761973]
Stock Position:  0.017619731472612126
Bond Position:  [-5.36641734]


portfolio before change:  [-3.69828578]
curr_Stock_Price:  94.6930989310237
curr_Factors:  [94.69309893]
mat_Sqrt:  [[0.15]]
grads:  [-0.15438154]
Stock Position:  -0.1543815369232988
Bond Position:  [10.92058037]


portfolio before change:  [-3.6707975]
curr_Stock_Price:  94.51946601681
curr_Factors:  [94.51946602]
mat_Sqrt:  [[0.15]]
grads:  [-0.2141929]
Stock Position:  -0.21419290040736275
Bond Position:  [16.57460107]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.77416986]
Stock Price:  95.00691587128718
PL:  [-3.77416986]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.31967484e-02]
 [-1.75978173e-02]
 [ 6.50667285e-03]
 [-1.85323182e-02]
 [ 8.40782707e-03]
 [-1.78162316e-03]
 [-4.16864628e-03]
 [-2.87766400e-02]
 [ 1.65521709e-02]
 [-6.84738389e-03]
 [-1.26182191e-02]
 [ 1.98164974e-02]
 [-4.63640027e-03]
 [ 4.33185502e-03]
 [-5.10555991e-04]
 [ 1.41496443e-02]
 [ 8.87048098e-02]
 [-1.36685079e-02]
 [ 1.84209657e-02]
 [ 1.33392755e-03]
 [-3.90004810e-03]
 [ 4.45181646e-03]
 [ 1.34439969e-02]
 [ 2.04683296e-02]
 [-2.56441110e-03]
 [ 6.86681171e-03]
 [-1.05739817e-02]
 [ 7.30167834e-03]
 [ 3.44255619e-02]
 [ 4.91381817e-03]
 [-6.27496830e-03]
 [ 1.14842845e-02]
 [ 1.25903801e-02]
 [ 7.81525243e-03]
 [ 5.79180751e-03]
 [ 1.62413843e-02]
 [-2.37285917e-02]
 [-4.26911868e-03]
 [-2.10304289e-02]
 [-1.92159717e-02]
 [ 3.61376577e-03]
 [ 7.63685887e-03]
 [-1.29041859e-02]
 [ 1.06795020e-02]
 [-5.70978090e-05]
 [ 1.16062911e-02]
 [ 1.05607065e-02]
 [-2.33622149e-03]
 [ 1.27109451e-02]
 [-1.40097935e-03]
 [ 2.03242109e-02]
 [ 9.82546038e-03]
 [-3.08211814e-03]
 [-2.38659161e-02]
 [-5.96782689e-03]
 [-2.82263919e-03]
 [ 7.85678231e-03]
 [-1.76753512e-02]
 [ 3.26781837e-03]
 [-3.39968853e-03]
 [-5.55526379e-03]
 [ 5.91068591e-03]
 [-1.81236144e-02]
 [ 1.87006597e-03]
 [ 2.07902775e-02]
 [ 9.75525194e-03]
 [ 1.15696689e-02]
 [ 9.49519949e-03]
 [ 6.12460566e-03]
 [ 1.62688763e-02]
 [ 7.42608478e-04]
 [-1.54440209e-02]
 [-3.44533564e-03]
 [ 1.04500642e-03]
 [ 2.29711589e-03]
 [-1.67360816e-02]
 [-3.46963078e-03]
 [ 1.12970541e-02]
 [-5.03398274e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.01337472]
curr_Stock_Price:  99.49843656941198
curr_Factors:  [99.49843657]
mat_Sqrt:  [[0.15]]
grads:  [-0.08797832]
Stock Position:  -0.08797832239124125
Bond Position:  [-0.25966919]


portfolio before change:  [-8.97290486]
curr_Stock_Price:  99.03825405688671
curr_Factors:  [99.03825406]
mat_Sqrt:  [[0.15]]
grads:  [-0.11731878]
Stock Position:  -0.11731878196410138
Bond Position:  [2.64614247]


portfolio before change:  [-9.03109354]
curr_Stock_Price:  99.5356515245303
curr_Factors:  [99.53565152]
mat_Sqrt:  [[0.15]]
grads:  [0.04337782]
Stock Position:  0.043377818989337694
Bond Position:  [-13.34873301]


portfolio before change:  [-8.97769293]
curr_Stock_Price:  100.78594333683453
curr_Factors:  [100.78594334]
mat_Sqrt:  [[0.15]]
grads:  [-0.12354879]
Stock Position:  -0.12354878789814207
Bond Position:  [3.47428821]


portfolio before change:  [-8.9232172]
curr_Stock_Price:  100.3467760953616
curr_Factors:  [100.3467761]
mat_Sqrt:  [[0.15]]
grads:  [0.05605218]
Stock Position:  0.05605218045545012
Bond Position:  [-14.5478728]


portfolio before change:  [-8.90764958]
curr_Stock_Price:  100.6407323116649
curr_Factors:  [100.64073231]
mat_Sqrt:  [[0.15]]
grads:  [-0.01187749]
Stock Position:  -0.011877487740883578
Bond Position:  [-7.71229052]


portfolio before change:  [-8.90710166]
curr_Stock_Price:  100.55401763320002
curr_Factors:  [100.55401763]
mat_Sqrt:  [[0.15]]
grads:  [-0.02779098]
Stock Position:  -0.027790975187769046
Bond Position:  [-6.11260745]


portfolio before change:  [-8.92084069]
curr_Stock_Price:  101.03464025931538
curr_Factors:  [101.03464026]
mat_Sqrt:  [[0.15]]
grads:  [-0.19184427]
Stock Position:  -0.19184426648077255
Bond Position:  [10.46207576]


portfolio before change:  [-9.06612262]
curr_Stock_Price:  101.79533973311972
curr_Factors:  [101.79533973]
mat_Sqrt:  [[0.15]]
grads:  [0.11034781]
Stock Position:  0.11034780620027182
Bond Position:  [-20.29901504]


portfolio before change:  [-9.02420468]
curr_Stock_Price:  102.1867083189933
curr_Factors:  [102.18670832]
mat_Sqrt:  [[0.15]]
grads:  [-0.04564923]
Stock Position:  -0.04564922595845693
Bond Position:  [-4.35946054]


portfolio before change:  [-9.07427814]
curr_Stock_Price:  103.27765747314866
curr_Factors:  [103.27765747]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412146]
Stock Position:  -0.08412146051822418
Bond Position:  [-0.38641075]


portfolio before change:  [-9.02634441]
curr_Stock_Price:  102.70755462046044
curr_Factors:  [102.70755462]
mat_Sqrt:  [[0.15]]
grads:  [0.13210998]
Stock Position:  0.1321099827068673
Bond Position:  [-22.59503767]


portfolio before change:  [-9.01999281]
curr_Stock_Price:  102.76632254180186
curr_Factors:  [102.76632254]
mat_Sqrt:  [[0.15]]
grads:  [-0.03090934]
Stock Position:  -0.03090933515300517
Bond Position:  [-5.84355411]


portfolio before change:  [-8.98653663]
curr_Stock_Price:  101.67210907718191
curr_Factors:  [101.67210908]
mat_Sqrt:  [[0.15]]
grads:  [0.02887903]
Stock Position:  0.028879033474681938
Bond Position:  [-11.92272888]


portfolio before change:  [-9.00403451]
curr_Stock_Price:  101.09201070883579
curr_Factors:  [101.09201071]
mat_Sqrt:  [[0.15]]
grads:  [-0.00340371]
Stock Position:  -0.0034037066083727105
Bond Position:  [-8.65994696]


portfolio before change:  [-9.00232342]
curr_Stock_Price:  100.43027594132637
curr_Factors:  [100.43027594]
mat_Sqrt:  [[0.15]]
grads:  [0.09433096]
Stock Position:  0.09433096231886215
Bond Position:  [-18.476008]


portfolio before change:  [-8.86755154]
curr_Stock_Price:  101.87123088432169
curr_Factors:  [101.87123088]
mat_Sqrt:  [[0.15]]
grads:  [0.5913654]
Stock Position:  0.5913653985782584
Bond Position:  [-69.1106726]


portfolio before change:  [-9.09375761]
curr_Stock_Price:  101.49602036014589
curr_Factors:  [101.49602036]
mat_Sqrt:  [[0.15]]
grads:  [-0.09112339]
Stock Position:  -0.09112338626738116
Bond Position:  [0.15490345]


portfolio before change:  [-9.08622324]
curr_Stock_Price:  101.41344334267495
curr_Factors:  [101.41344334]
mat_Sqrt:  [[0.15]]
grads:  [0.12280644]
Stock Position:  0.12280643824256537
Bond Position:  [-21.540447]


portfolio before change:  [-9.05422676]
curr_Stock_Price:  101.68495027302177
curr_Factors:  [101.68495027]
mat_Sqrt:  [[0.15]]
grads:  [0.00889285]
Stock Position:  0.008892850319149104
Bond Position:  [-9.9584958]


portfolio before change:  [-9.05900532]
curr_Stock_Price:  101.21759249203159
curr_Factors:  [101.21759249]
mat_Sqrt:  [[0.15]]
grads:  [-0.02600032]
Stock Position:  -0.026000320641804044
Bond Position:  [-6.42731547]


portfolio before change:  [-9.05562871]
curr_Stock_Price:  101.07227370628209
curr_Factors:  [101.07227371]
mat_Sqrt:  [[0.15]]
grads:  [0.02967878]
Stock Position:  0.029678776389824614
Bond Position:  [-12.05533012]


portfolio before change:  [-9.04582178]
curr_Stock_Price:  101.42809726215513
curr_Factors:  [101.42809726]
mat_Sqrt:  [[0.15]]
grads:  [0.08962665]
Stock Position:  0.08962664577841543
Bond Position:  [-18.13648193]


portfolio before change:  [-9.06729535]
curr_Stock_Price:  101.20115577695253
curr_Factors:  [101.20115578]
mat_Sqrt:  [[0.15]]
grads:  [0.13645553]
Stock Position:  0.13645553052347295
Bond Position:  [-22.87675275]


portfolio before change:  [-9.07879215]
curr_Stock_Price:  101.12738118050318
curr_Factors:  [101.12738118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01709607]
Stock Position:  -0.017096074001713993
Bond Position:  [-7.34991095]


portfolio before change:  [-9.07817661]
curr_Stock_Price:  101.06450618058983
curr_Factors:  [101.06450618]
mat_Sqrt:  [[0.15]]
grads:  [0.04577874]
Stock Position:  0.045778744749992974
Bond Position:  [-13.70478285]


portfolio before change:  [-9.0828317]
curr_Stock_Price:  100.98153074169512
curr_Factors:  [100.98153074]
mat_Sqrt:  [[0.15]]
grads:  [-0.07049321]
Stock Position:  -0.07049321133285442
Bond Position:  [-1.96431931]


portfolio before change:  [-9.08584037]
curr_Stock_Price:  101.02246938825125
curr_Factors:  [101.02246939]
mat_Sqrt:  [[0.15]]
grads:  [0.04867786]
Stock Position:  0.048677855602904135
Bond Position:  [-14.00339755]


portfolio before change:  [-9.07270553]
curr_Stock_Price:  101.31028165350921
curr_Factors:  [101.31028165]
mat_Sqrt:  [[0.15]]
grads:  [0.22950375]
Stock Position:  0.22950374599085277
Bond Position:  [-32.32379467]


portfolio before change:  [-9.20975372]
curr_Stock_Price:  100.72193444417458
curr_Factors:  [100.72193444]
mat_Sqrt:  [[0.15]]
grads:  [0.03275879]
Stock Position:  0.032758787785789716
Bond Position:  [-12.50928219]


portfolio before change:  [-9.20555185]
curr_Stock_Price:  100.8740682895688
curr_Factors:  [100.87406829]
mat_Sqrt:  [[0.15]]
grads:  [-0.04183312]
Stock Position:  -0.041833121973312605
Bond Position:  [-4.98567465]


portfolio before change:  [-9.21188746]
curr_Stock_Price:  101.01806899017527
curr_Factors:  [101.01806899]
mat_Sqrt:  [[0.15]]
grads:  [0.0765619]
Stock Position:  0.07656189694105492
Bond Position:  [-16.94602245]


portfolio before change:  [-9.21152995]
curr_Stock_Price:  101.0365726475774
curr_Factors:  [101.03657265]
mat_Sqrt:  [[0.15]]
grads:  [0.08393587]
Stock Position:  0.08393586748730612
Bond Position:  [-17.69212232]


portfolio before change:  [-9.17282861]
curr_Stock_Price:  101.51082909196145
curr_Factors:  [101.51082909]
mat_Sqrt:  [[0.15]]
grads:  [0.05210168]
Stock Position:  0.05210168283707584
Bond Position:  [-14.46171364]


portfolio before change:  [-9.17376991]
curr_Stock_Price:  101.51011109084504
curr_Factors:  [101.51011109]
mat_Sqrt:  [[0.15]]
grads:  [0.03861205]
Stock Position:  0.03861205009581578
Bond Position:  [-13.0932834]


portfolio before change:  [-9.15996218]
curr_Stock_Price:  101.88890696251632
curr_Factors:  [101.88890696]
mat_Sqrt:  [[0.15]]
grads:  [0.1082759]
Stock Position:  0.10827589552430082
Bond Position:  [-20.19207482]


portfolio before change:  [-9.12577797]
curr_Stock_Price:  102.21627669570852
curr_Factors:  [102.2162767]
mat_Sqrt:  [[0.15]]
grads:  [-0.15819061]
Stock Position:  -0.1581906113515086
Bond Position:  [7.04387733]


portfolio before change:  [-9.20589749]
curr_Stock_Price:  102.72553432225118
curr_Factors:  [102.72553432]
mat_Sqrt:  [[0.15]]
grads:  [-0.02846079]
Stock Position:  -0.028460791177661853
Bond Position:  [-6.28224751]


portfolio before change:  [-9.21698999]
curr_Stock_Price:  103.10148486032996
curr_Factors:  [103.10148486]
mat_Sqrt:  [[0.15]]
grads:  [-0.14020286]
Stock Position:  -0.140202859207538
Bond Position:  [5.23813297]


portfolio before change:  [-9.27124819]
curr_Stock_Price:  103.49081781143005
curr_Factors:  [103.49081781]
mat_Sqrt:  [[0.15]]
grads:  [-0.12810648]
Stock Position:  -0.12810647779187068
Bond Position:  [3.98659596]


portfolio before change:  [-9.29667821]
curr_Stock_Price:  103.69126974438946
curr_Factors:  [103.69126974]
mat_Sqrt:  [[0.15]]
grads:  [0.02409177]
Stock Position:  0.024091771815122502
Bond Position:  [-11.79478462]


portfolio before change:  [-9.29335315]
curr_Stock_Price:  103.8598859544919
curr_Factors:  [103.85988595]
mat_Sqrt:  [[0.15]]
grads:  [0.05091239]
Stock Position:  0.05091239246010416
Bond Position:  [-14.58110842]


portfolio before change:  [-9.25995655]
curr_Stock_Price:  104.53374843683555
curr_Factors:  [104.53374844]
mat_Sqrt:  [[0.15]]
grads:  [-0.08602791]
Stock Position:  -0.08602790567335049
Bond Position:  [-0.26713709]


portfolio before change:  [-9.26681437]
curr_Stock_Price:  104.6132705946731
curr_Factors:  [104.61327059]
mat_Sqrt:  [[0.15]]
grads:  [0.07119668]
Stock Position:  0.07119668003100153
Bond Position:  [-16.71493192]


portfolio before change:  [-9.27522438]
curr_Stock_Price:  104.50982057757949
curr_Factors:  [104.50982058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00038065]
Stock Position:  -0.00038065206009258584
Bond Position:  [-9.2354425]


portfolio before change:  [-9.27597084]
curr_Stock_Price:  104.9543975934242
curr_Factors:  [104.95439759]
mat_Sqrt:  [[0.15]]
grads:  [0.07737527]
Stock Position:  0.07737527382707743
Bond Position:  [-17.3968461]


portfolio before change:  [-9.33211539]
curr_Stock_Price:  104.2428368491826
curr_Factors:  [104.24283685]
mat_Sqrt:  [[0.15]]
grads:  [0.07040471]
Stock Position:  0.07040470968039403
Bond Position:  [-16.67130205]


portfolio before change:  [-9.34600981]
curr_Stock_Price:  104.06028610393331
curr_Factors:  [104.0602861]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557481]
Stock Position:  -0.01557480995527491
Bond Position:  [-7.72529063]


portfolio before change:  [-9.3471145]
curr_Stock_Price:  104.10021244044191
curr_Factors:  [104.10021244]
mat_Sqrt:  [[0.15]]
grads:  [0.08473963]
Stock Position:  0.08473963410744355
Bond Position:  [-18.16852841]


portfolio before change:  [-9.2928756]
curr_Stock_Price:  104.75367837026049
curr_Factors:  [104.75367837]
mat_Sqrt:  [[0.15]]
grads:  [-0.00933986]
Stock Position:  -0.009339862335086848
Bond Position:  [-8.31449067]


portfolio before change:  [-9.29742659]
curr_Stock_Price:  105.18530276023054
curr_Factors:  [105.18530276]
mat_Sqrt:  [[0.15]]
grads:  [0.13549474]
Stock Position:  0.13549473904132692
Bond Position:  [-23.54948174]


portfolio before change:  [-9.3655573]
curr_Stock_Price:  104.69333658624733
curr_Factors:  [104.69333659]
mat_Sqrt:  [[0.15]]
grads:  [0.06550307]
Stock Position:  0.065503069198406
Bond Position:  [-16.22329218]


portfolio before change:  [-9.39867656]
curr_Stock_Price:  104.20320285289867
curr_Factors:  [104.20320285]
mat_Sqrt:  [[0.15]]
grads:  [-0.02054745]
Stock Position:  -0.020547454281518947
Bond Position:  [-7.25756601]


portfolio before change:  [-9.3939642]
curr_Stock_Price:  103.95178623237172
curr_Factors:  [103.95178623]
mat_Sqrt:  [[0.15]]
grads:  [-0.15910611]
Stock Position:  -0.159106107560953
Bond Position:  [7.14539988]


portfolio before change:  [-9.40179824]
curr_Stock_Price:  104.00383104985592
curr_Factors:  [104.00383105]
mat_Sqrt:  [[0.15]]
grads:  [-0.03978551]
Stock Position:  -0.03978551257036132
Bond Position:  [-5.26395252]


portfolio before change:  [-9.40593031]
curr_Stock_Price:  104.09942010134537
curr_Factors:  [104.0994201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01881759]
Stock Position:  -0.018817594592544312
Bond Position:  [-7.44702963]


portfolio before change:  [-9.40756773]
curr_Stock_Price:  104.16170022734825
curr_Factors:  [104.16170023]
mat_Sqrt:  [[0.15]]
grads:  [0.05237855]
Stock Position:  0.0523785487361598
Bond Position:  [-14.86340642]


portfolio before change:  [-9.37469264]
curr_Stock_Price:  104.80708047355665
curr_Factors:  [104.80708047]
mat_Sqrt:  [[0.15]]
grads:  [-0.11783567]
Stock Position:  -0.11783567444943459
Bond Position:  [2.97532038]


portfolio before change:  [-9.35998834]
curr_Stock_Price:  104.68387216598967
curr_Factors:  [104.68387217]
mat_Sqrt:  [[0.15]]
grads:  [0.02178546]
Stock Position:  0.021785455831111123
Bond Position:  [-11.64057421]


portfolio before change:  [-9.36755874]
curr_Stock_Price:  104.36977103644806
curr_Factors:  [104.36977104]
mat_Sqrt:  [[0.15]]
grads:  [-0.02266459]
Stock Position:  -0.022664590203370086
Bond Position:  [-7.00206064]


portfolio before change:  [-9.37461769]
curr_Stock_Price:  104.66191430786826
curr_Factors:  [104.66191431]
mat_Sqrt:  [[0.15]]
grads:  [-0.03703509]
Stock Position:  -0.03703509195124028
Bond Position:  [-5.49845406]


portfolio before change:  [-9.33710215]
curr_Stock_Price:  103.63966231148616
curr_Factors:  [103.63966231]
mat_Sqrt:  [[0.15]]
grads:  [0.03940457]
Stock Position:  0.03940457273497897
Bond Position:  [-13.42097876]


portfolio before change:  [-9.37589144]
curr_Stock_Price:  102.67656479407293
curr_Factors:  [102.67656479]
mat_Sqrt:  [[0.15]]
grads:  [-0.1208241]
Stock Position:  -0.12082409621327948
Bond Position:  [3.02991171]


portfolio before change:  [-9.45635635]
curr_Stock_Price:  103.34409957859918
curr_Factors:  [103.34409958]
mat_Sqrt:  [[0.15]]
grads:  [0.01246711]
Stock Position:  0.01246710644602831
Bond Position:  [-10.74475824]


portfolio before change:  [-9.45853967]
curr_Stock_Price:  103.22284025749363
curr_Factors:  [103.22284026]
mat_Sqrt:  [[0.15]]
grads:  [0.13860185]
Stock Position:  0.1386018498023122
Bond Position:  [-23.76541627]


portfolio before change:  [-9.45541674]
curr_Stock_Price:  103.25608883319084
curr_Factors:  [103.25608883]
mat_Sqrt:  [[0.15]]
grads:  [0.06503501]
Stock Position:  0.06503501292095554
Bond Position:  [-16.17067781]


portfolio before change:  [-9.44740457]
curr_Stock_Price:  103.39482747333871
curr_Factors:  [103.39482747]
mat_Sqrt:  [[0.15]]
grads:  [0.07713113]
Stock Position:  0.0771311260232617
Bond Position:  [-17.42236404]


portfolio before change:  [-9.42694054]
curr_Stock_Price:  103.67426021010013
curr_Factors:  [103.67426021]
mat_Sqrt:  [[0.15]]
grads:  [0.06330133]
Stock Position:  0.06330132995416826
Bond Position:  [-15.98965909]


portfolio before change:  [-9.44018331]
curr_Stock_Price:  103.48084589946788
curr_Factors:  [103.4808459]
mat_Sqrt:  [[0.15]]
grads:  [0.0408307]
Stock Position:  0.04083070442496312
Bond Position:  [-13.66537914]


portfolio before change:  [-9.47642667]
curr_Stock_Price:  102.61411452287186
curr_Factors:  [102.61411452]
mat_Sqrt:  [[0.15]]
grads:  [0.10845918]
Stock Position:  0.10845917556415531
Bond Position:  [-20.60586894]


portfolio before change:  [-9.45726877]
curr_Stock_Price:  102.80262607060394
curr_Factors:  [102.80262607]
mat_Sqrt:  [[0.15]]
grads:  [0.00495072]
Stock Position:  0.004950723185996427
Bond Position:  [-9.96621612]


portfolio before change:  [-9.45787425]
curr_Stock_Price:  102.80614656050075
curr_Factors:  [102.80614656]
mat_Sqrt:  [[0.15]]
grads:  [-0.10296014]
Stock Position:  -0.10296013940532736
Bond Position:  [1.12706093]


portfolio before change:  [-9.52948848]
curr_Stock_Price:  103.5023837255847
curr_Factors:  [103.50238373]
mat_Sqrt:  [[0.15]]
grads:  [-0.0229689]
Stock Position:  -0.02296890425490943
Bond Position:  [-7.15215214]


portfolio before change:  [-9.53515286]
curr_Stock_Price:  103.72953215189442
curr_Factors:  [103.72953215]
mat_Sqrt:  [[0.15]]
grads:  [0.00696671]
Stock Position:  0.006966709445514804
Bond Position:  [-10.25780637]


portfolio before change:  [-9.53372767]
curr_Stock_Price:  104.026130931927
curr_Factors:  [104.02613093]
mat_Sqrt:  [[0.15]]
grads:  [0.01531411]
Stock Position:  0.015314105901214932
Bond Position:  [-11.12679486]


portfolio before change:  [-9.54669283]
curr_Stock_Price:  103.22492787312505
curr_Factors:  [103.22492787]
mat_Sqrt:  [[0.15]]
grads:  [-0.11157388]
Stock Position:  -0.11157387757356664
Bond Position:  [1.97051264]


portfolio before change:  [-9.55674644]
curr_Stock_Price:  103.31613890597325
curr_Factors:  [103.31613891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313087]
Stock Position:  -0.023130871886153717
Bond Position:  [-7.16695406]


portfolio before change:  [-9.56556396]
curr_Stock_Price:  103.67797479644172
curr_Factors:  [103.6779748]
mat_Sqrt:  [[0.15]]
grads:  [0.07531369]
Stock Position:  0.07531369407610566
Bond Position:  [-17.37393524]


portfolio before change:  [-9.55932839]
curr_Stock_Price:  103.77518785273568
curr_Factors:  [103.77518785]
mat_Sqrt:  [[0.15]]
grads:  [-0.03355988]
Stock Position:  -0.03355988491982819
Bond Position:  [-6.07664503]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.56588769]
Stock Price:  103.95932118885372
PL:  [-13.52520888]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-9.19802606e-03]
 [ 1.47735464e-02]
 [ 1.18038201e-02]
 [-1.10914228e-02]
 [ 1.25406888e-02]
 [-1.29683971e-03]
 [-9.79103821e-03]
 [-3.03176475e-02]
 [ 1.42573664e-02]
 [-9.39821920e-05]
 [ 1.35952542e-03]
 [ 4.94575842e-03]
 [-3.64601506e-03]
 [ 5.93381692e-03]
 [ 1.98981832e-04]
 [ 1.60941542e-02]
 [ 3.27535621e-02]
 [-1.47488761e-02]
 [ 1.81526197e-02]
 [ 1.61940345e-03]
 [-4.63496083e-03]
 [ 4.59520799e-03]
 [ 1.06358286e-02]
 [ 2.08097894e-02]
 [-1.21435382e-03]
 [ 6.91822878e-03]
 [-9.64296465e-03]
 [ 5.67043777e-03]
 [ 2.99854631e-02]
 [ 6.67254474e-04]
 [-7.17124072e-03]
 [ 8.47429987e-03]
 [ 1.24476296e-02]
 [ 9.34214256e-03]
 [ 5.98216899e-03]
 [ 1.89815556e-02]
 [-1.13664632e-03]
 [ 3.16421240e-03]
 [-5.69776939e-02]
 [ 8.60563143e-03]
 [ 7.19753576e-03]
 [ 6.06931118e-04]
 [-2.03388888e-03]
 [-2.37307162e-03]
 [ 7.68488310e-03]
 [ 1.52155020e-02]
 [ 1.03581813e-02]
 [ 5.29835954e-03]
 [-7.43396438e-03]
 [-9.36736008e-04]
 [-5.30588271e-03]
 [ 1.84011003e-03]
 [ 1.01664278e-03]
 [ 6.52567588e-03]
 [-1.03064979e-02]
 [-4.97017152e-03]
 [-2.86167599e-03]
 [ 1.37620831e-02]
 [ 5.21118095e-03]
 [-2.19960003e-03]
 [-5.17433959e-03]
 [-4.22340381e-03]
 [ 3.66982659e-04]
 [-4.83827625e-03]
 [ 1.80325428e-02]
 [ 6.03883483e-03]
 [ 1.37171886e-02]
 [-4.95840291e-04]
 [ 2.83392740e-03]
 [ 2.27568098e-02]
 [ 3.39526024e-03]
 [-1.58990965e-02]
 [-5.98392636e-03]
 [ 1.15759574e-03]
 [ 8.30528432e-03]
 [ 9.96780415e-04]
 [-1.51082556e-03]
 [-5.43015891e-03]
 [-2.29572203e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.86594178]
curr_Stock_Price:  100.08338873136051
curr_Factors:  [100.08338873]
mat_Sqrt:  [[0.15]]
grads:  [-0.06132017]
Stock Position:  -0.06132017374657263
Bond Position:  [10.00307257]


portfolio before change:  [3.85782208]
curr_Stock_Price:  100.22599935273946
curr_Factors:  [100.22599935]
mat_Sqrt:  [[0.15]]
grads:  [0.09849031]
Stock Position:  0.09849030909842449
Bond Position:  [-6.01346757]


portfolio before change:  [3.86813669]
curr_Stock_Price:  100.3345426437889
curr_Factors:  [100.33454264]
mat_Sqrt:  [[0.15]]
grads:  [0.07869213]
Stock Position:  0.07869213412923332
Bond Position:  [-4.0274026]


portfolio before change:  [3.87707666]
curr_Stock_Price:  100.45134839975294
curr_Factors:  [100.4513484]
mat_Sqrt:  [[0.15]]
grads:  [-0.07394282]
Stock Position:  -0.0739428189745694
Bond Position:  [11.30473254]


portfolio before change:  [3.89451379]
curr_Stock_Price:  100.22508489255031
curr_Factors:  [100.22508489]
mat_Sqrt:  [[0.15]]
grads:  [0.08360459]
Stock Position:  0.08360459175033098
Bond Position:  [-4.48476351]


portfolio before change:  [3.95222099]
curr_Stock_Price:  100.91867719442861
curr_Factors:  [100.91867719]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086456]
Stock Position:  -0.008645598035564105
Bond Position:  [4.82472331]


portfolio before change:  [3.95179105]
curr_Stock_Price:  101.0032857267107
curr_Factors:  [101.00328573]
mat_Sqrt:  [[0.15]]
grads:  [-0.06527359]
Stock Position:  -0.06527358804093884
Bond Position:  [10.54463792]


portfolio before change:  [3.94404249]
curr_Stock_Price:  101.13209157130126
curr_Factors:  [101.13209157]
mat_Sqrt:  [[0.15]]
grads:  [-0.20211765]
Stock Position:  -0.20211765003990853
Bond Position:  [24.38462319]


portfolio before change:  [3.88229961]
curr_Stock_Price:  101.44511206363148
curr_Factors:  [101.44511206]
mat_Sqrt:  [[0.15]]
grads:  [0.09504911]
Stock Position:  0.09504910915679426
Bond Position:  [-5.75996792]


portfolio before change:  [3.83156434]
curr_Stock_Price:  100.91512010517084
curr_Factors:  [100.91512011]
mat_Sqrt:  [[0.15]]
grads:  [-0.00062655]
Stock Position:  -0.0006265479466519471
Bond Position:  [3.8947925]


portfolio before change:  [3.83194108]
curr_Stock_Price:  100.70235459005383
curr_Factors:  [100.70235459]
mat_Sqrt:  [[0.15]]
grads:  [0.0090635]
Stock Position:  0.009063502819453475
Bond Position:  [2.91922501]


portfolio before change:  [3.83386397]
curr_Stock_Price:  100.89438073120643
curr_Factors:  [100.89438073]
mat_Sqrt:  [[0.15]]
grads:  [0.03297172]
Stock Position:  0.03297172278410458
Bond Position:  [0.50720242]


portfolio before change:  [3.85171106]
curr_Stock_Price:  101.43470418824157
curr_Factors:  [101.43470419]
mat_Sqrt:  [[0.15]]
grads:  [-0.02430677]
Stock Position:  -0.024306767068443605
Bond Position:  [6.31726079]


portfolio before change:  [3.86351973]
curr_Stock_Price:  100.96513023137759
curr_Factors:  [100.96513023]
mat_Sqrt:  [[0.15]]
grads:  [0.03955878]
Stock Position:  0.039558779465562154
Bond Position:  [-0.13053759]


portfolio before change:  [3.87171555]
curr_Stock_Price:  101.17251720528628
curr_Factors:  [101.17251721]
mat_Sqrt:  [[0.15]]
grads:  [0.00132655]
Stock Position:  0.001326545548109547
Bond Position:  [3.73750559]


portfolio before change:  [3.87161551]
curr_Stock_Price:  100.92100628746688
curr_Factors:  [100.92100629]
mat_Sqrt:  [[0.15]]
grads:  [0.10729436]
Stock Position:  0.10729436152223613
Bond Position:  [-6.95663943]


portfolio before change:  [3.76147263]
curr_Stock_Price:  99.89851010883402
curr_Factors:  [99.89851011]
mat_Sqrt:  [[0.15]]
grads:  [0.21835708]
Stock Position:  0.2183570805390538
Bond Position:  [-18.05207439]


portfolio before change:  [3.93182345]
curr_Stock_Price:  100.68382519388815
curr_Factors:  [100.68382519]
mat_Sqrt:  [[0.15]]
grads:  [-0.09832584]
Stock Position:  -0.09832584065198025
Bond Position:  [13.8316452]


portfolio before change:  [3.87185341]
curr_Stock_Price:  101.30252873034108
curr_Factors:  [101.30252873]
mat_Sqrt:  [[0.15]]
grads:  [0.12101746]
Stock Position:  0.12101746442066501
Bond Position:  [-8.38752176]


portfolio before change:  [3.86028497]
curr_Stock_Price:  101.21126751850917
curr_Factors:  [101.21126752]
mat_Sqrt:  [[0.15]]
grads:  [0.01079602]
Stock Position:  0.010796022967053683
Bond Position:  [2.7676058]


portfolio before change:  [3.8660383]
curr_Stock_Price:  101.72815661810004
curr_Factors:  [101.72815662]
mat_Sqrt:  [[0.15]]
grads:  [-0.03089974]
Stock Position:  -0.03089973889462712
Bond Position:  [7.00941178]


portfolio before change:  [3.8729479]
curr_Stock_Price:  101.5187212055134
curr_Factors:  [101.51872121]
mat_Sqrt:  [[0.15]]
grads:  [0.03063472]
Stock Position:  0.0306347199581956
Bond Position:  [0.76295031]


portfolio before change:  [3.8852443]
curr_Stock_Price:  101.91855227586582
curr_Factors:  [101.91855228]
mat_Sqrt:  [[0.15]]
grads:  [0.07090552]
Stock Position:  0.07090552409870232
Bond Position:  [-3.34134407]


portfolio before change:  [3.84851751]
curr_Stock_Price:  101.40352959865888
curr_Factors:  [101.4035296]
mat_Sqrt:  [[0.15]]
grads:  [0.13873193]
Stock Position:  0.13873192946943766
Bond Position:  [-10.21938981]


portfolio before change:  [3.87560038]
curr_Stock_Price:  101.6033510184722
curr_Factors:  [101.60335102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00809569]
Stock Position:  -0.008095692110258526
Bond Position:  [4.69814983]


portfolio before change:  [3.87985463]
curr_Stock_Price:  101.11412787200129
curr_Factors:  [101.11412787]
mat_Sqrt:  [[0.15]]
grads:  [0.04612153]
Stock Position:  0.046121525198178005
Bond Position:  [-0.78368317]


portfolio before change:  [3.8714365]
curr_Stock_Price:  100.9326692272266
curr_Factors:  [100.93266923]
mat_Sqrt:  [[0.15]]
grads:  [-0.06428643]
Stock Position:  -0.06428643097935605
Bond Position:  [10.36003757]


portfolio before change:  [3.91389031]
curr_Stock_Price:  100.28235632649945
curr_Factors:  [100.28235633]
mat_Sqrt:  [[0.15]]
grads:  [0.03780292]
Stock Position:  0.037802918469178895
Bond Position:  [0.12292457]


portfolio before change:  [3.91851509]
curr_Stock_Price:  100.40449231929395
curr_Factors:  [100.40449232]
mat_Sqrt:  [[0.15]]
grads:  [0.19990309]
Stock Position:  0.19990308752492475
Bond Position:  [-16.15265292]


portfolio before change:  [3.86052356]
curr_Stock_Price:  100.11944439480529
curr_Factors:  [100.11944439]
mat_Sqrt:  [[0.15]]
grads:  [0.00444836]
Stock Position:  0.004448363161739753
Bond Position:  [3.41515591]


portfolio before change:  [3.86279918]
curr_Stock_Price:  100.58302186473749
curr_Factors:  [100.58302186]
mat_Sqrt:  [[0.15]]
grads:  [-0.04780827]
Stock Position:  -0.04780827143791631
Bond Position:  [8.67149959]


portfolio before change:  [3.86204804]
curr_Stock_Price:  100.61006988286566
curr_Factors:  [100.61006988]
mat_Sqrt:  [[0.15]]
grads:  [0.05649533]
Stock Position:  0.05649533247586658
Bond Position:  [-1.8219513]


portfolio before change:  [3.86564908]
curr_Stock_Price:  100.67582593191536
curr_Factors:  [100.67582593]
mat_Sqrt:  [[0.15]]
grads:  [0.0829842]
Stock Position:  0.08298419734750324
Bond Position:  [-4.48885353]


portfolio before change:  [3.88723756]
curr_Stock_Price:  100.93935850697473
curr_Factors:  [100.93935851]
mat_Sqrt:  [[0.15]]
grads:  [0.06228095]
Stock Position:  0.06228095037513197
Bond Position:  [-2.39936162]


portfolio before change:  [3.85079328]
curr_Stock_Price:  100.35660709049324
curr_Factors:  [100.35660709]
mat_Sqrt:  [[0.15]]
grads:  [0.03988113]
Stock Position:  0.039881126627792744
Bond Position:  [-0.15154128]


portfolio before change:  [3.80294481]
curr_Stock_Price:  99.15706725031522
curr_Factors:  [99.15706725]
mat_Sqrt:  [[0.15]]
grads:  [0.1265437]
Stock Position:  0.12654370408655383
Bond Position:  [-8.74475777]


portfolio before change:  [3.81541447]
curr_Stock_Price:  99.25992677411249
curr_Factors:  [99.25992677]
mat_Sqrt:  [[0.15]]
grads:  [-0.00757764]
Stock Position:  -0.00757764215970762
Bond Position:  [4.56757067]


portfolio before change:  [3.81301564]
curr_Stock_Price:  99.61416760673863
curr_Factors:  [99.61416761]
mat_Sqrt:  [[0.15]]
grads:  [0.02109475]
Stock Position:  0.021094749352340316
Bond Position:  [1.71167974]


portfolio before change:  [3.82044127]
curr_Stock_Price:  99.96110929980168
curr_Factors:  [99.9611093]
mat_Sqrt:  [[0.15]]
grads:  [-0.37985129]
Stock Position:  -0.3798512923558937
Bond Position:  [41.79079782]


portfolio before change:  [3.70071653]
curr_Stock_Price:  100.28317413782248
curr_Factors:  [100.28317414]
mat_Sqrt:  [[0.15]]
grads:  [0.05737088]
Stock Position:  0.057370876225182915
Bond Position:  [-2.05261704]


portfolio before change:  [3.64542341]
curr_Stock_Price:  99.32162658019476
curr_Factors:  [99.32162658]
mat_Sqrt:  [[0.15]]
grads:  [0.04798357]
Stock Position:  0.04798357170487817
Bond Position:  [-1.12038298]


portfolio before change:  [3.65301295]
curr_Stock_Price:  99.48125536262262
curr_Factors:  [99.48125536]
mat_Sqrt:  [[0.15]]
grads:  [0.00404621]
Stock Position:  0.004046207453525172
Bond Position:  [3.25049115]


portfolio before change:  [3.65205661]
curr_Stock_Price:  99.19469114717737
curr_Factors:  [99.19469115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01355926]
Stock Position:  -0.013559259168350131
Bond Position:  [4.99706314]


portfolio before change:  [3.64599495]
curr_Stock_Price:  99.66477469697402
curr_Factors:  [99.6647747]
mat_Sqrt:  [[0.15]]
grads:  [-0.01582048]
Stock Position:  -0.015820477455905636
Bond Position:  [5.22273927]


portfolio before change:  [3.6590405]
curr_Stock_Price:  98.86080901067307
curr_Factors:  [98.86080901]
mat_Sqrt:  [[0.15]]
grads:  [0.05123255]
Stock Position:  0.05123255402862671
Bond Position:  [-1.40585123]


portfolio before change:  [3.6395079]
curr_Stock_Price:  98.48127032322247
curr_Factors:  [98.48127032]
mat_Sqrt:  [[0.15]]
grads:  [0.10143668]
Stock Position:  0.10143668011391152
Bond Position:  [-6.35010522]


portfolio before change:  [3.60444149]
curr_Stock_Price:  98.1394855453532
curr_Factors:  [98.13948555]
mat_Sqrt:  [[0.15]]
grads:  [0.06905454]
Stock Position:  0.06905454208116268
Bond Position:  [-3.17253574]


portfolio before change:  [3.54628631]
curr_Stock_Price:  97.30019402826947
curr_Factors:  [97.30019403]
mat_Sqrt:  [[0.15]]
grads:  [0.0353224]
Stock Position:  0.035322396906866796
Bond Position:  [0.10941024]


portfolio before change:  [3.54820831]
curr_Stock_Price:  97.35441350498836
curr_Factors:  [97.3544135]
mat_Sqrt:  [[0.15]]
grads:  [-0.04955976]
Stock Position:  -0.04955976255918462
Bond Position:  [8.37306993]


portfolio before change:  [3.51324275]
curr_Stock_Price:  98.07049635587425
curr_Factors:  [98.07049636]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624491]
Stock Position:  -0.006244906720257714
Bond Position:  [4.12568385]


portfolio before change:  [3.51570851]
curr_Stock_Price:  97.71694430066194
curr_Factors:  [97.7169443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03537255]
Stock Position:  -0.03537255142518514
Bond Position:  [6.97220615]


portfolio before change:  [3.50109394]
curr_Stock_Price:  98.14242536508162
curr_Factors:  [98.14242537]
mat_Sqrt:  [[0.15]]
grads:  [0.0122674]
Stock Position:  0.01226740022533486
Bond Position:  [2.29714153]


portfolio before change:  [3.49955755]
curr_Stock_Price:  98.00548032877956
curr_Factors:  [98.00548033]
mat_Sqrt:  [[0.15]]
grads:  [0.00677762]
Stock Position:  0.006777618508785848
Bond Position:  [2.8353138]


portfolio before change:  [3.49813853]
curr_Stock_Price:  97.76996401775472
curr_Factors:  [97.76996402]
mat_Sqrt:  [[0.15]]
grads:  [0.04350451]
Stock Position:  0.04350450583641966
Bond Position:  [-0.75529544]


portfolio before change:  [3.45079097]
curr_Stock_Price:  96.68271234281697
curr_Factors:  [96.68271234]
mat_Sqrt:  [[0.15]]
grads:  [-0.06870999]
Stock Position:  -0.06870998602602726
Bond Position:  [10.09385879]


portfolio before change:  [3.48493353]
curr_Stock_Price:  96.1949859065612
curr_Factors:  [96.19498591]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313448]
Stock Position:  -0.033134476808614095
Bond Position:  [6.67230406]


portfolio before change:  [3.51569101]
curr_Stock_Price:  95.27930987673987
curr_Factors:  [95.27930988]
mat_Sqrt:  [[0.15]]
grads:  [-0.01907784]
Stock Position:  -0.019077839907237347
Bond Position:  [5.33341443]


portfolio before change:  [3.52509025]
curr_Stock_Price:  94.80410458741629
curr_Factors:  [94.80410459]
mat_Sqrt:  [[0.15]]
grads:  [0.09174722]
Stock Position:  0.09174722061771641
Bond Position:  [-5.17292285]


portfolio before change:  [3.37202644]
curr_Stock_Price:  93.13930767739234
curr_Factors:  [93.13930768]
mat_Sqrt:  [[0.15]]
grads:  [0.03474121]
Stock Position:  0.03474120632732363
Bond Position:  [0.13625454]


portfolio before change:  [3.3918195]
curr_Stock_Price:  93.70879107825155
curr_Factors:  [93.70879108]
mat_Sqrt:  [[0.15]]
grads:  [-0.014664]
Stock Position:  -0.014664000172605243
Bond Position:  [4.76596523]


portfolio before change:  [3.40342205]
curr_Stock_Price:  92.93787852125064
curr_Factors:  [92.93787852]
mat_Sqrt:  [[0.15]]
grads:  [-0.0344956]
Stock Position:  -0.034495597282053814
Bond Position:  [6.60936967]


portfolio before change:  [3.3859486]
curr_Stock_Price:  93.4563953749806
curr_Factors:  [93.45639537]
mat_Sqrt:  [[0.15]]
grads:  [-0.02815603]
Stock Position:  -0.028156025420732356
Bond Position:  [6.01730924]


portfolio before change:  [3.35879492]
curr_Stock_Price:  94.43415286004125
curr_Factors:  [94.43415286]
mat_Sqrt:  [[0.15]]
grads:  [0.00244655]
Stock Position:  0.0024465510574670293
Bond Position:  [3.12775695]


portfolio before change:  [3.36055545]
curr_Stock_Price:  95.07384399366036
curr_Factors:  [95.07384399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03225518]
Stock Position:  -0.03225517502016253
Bond Position:  [6.42717893]


portfolio before change:  [3.36095198]
curr_Stock_Price:  95.07400465255142
curr_Factors:  [95.07400465]
mat_Sqrt:  [[0.15]]
grads:  [0.12021695]
Stock Position:  0.12021695232215857
Bond Position:  [-8.0685551]


portfolio before change:  [3.43867031]
curr_Stock_Price:  95.72468352892919
curr_Factors:  [95.72468353]
mat_Sqrt:  [[0.15]]
grads:  [0.0402589]
Stock Position:  0.04025889886446298
Bond Position:  [-0.41510004]


portfolio before change:  [3.49910069]
curr_Stock_Price:  97.22637201515354
curr_Factors:  [97.22637202]
mat_Sqrt:  [[0.15]]
grads:  [0.09144792]
Stock Position:  0.09144792414405438
Bond Position:  [-5.3920492]


portfolio before change:  [3.57715207]
curr_Stock_Price:  98.08356360112852
curr_Factors:  [98.0835636]
mat_Sqrt:  [[0.15]]
grads:  [-0.0033056]
Stock Position:  -0.0033056019419609294
Bond Position:  [3.90137729]


portfolio before change:  [3.57769182]
curr_Stock_Price:  97.9940458683318
curr_Factors:  [97.99404587]
mat_Sqrt:  [[0.15]]
grads:  [0.01889285]
Stock Position:  0.01889284930200936
Bond Position:  [1.72630508]


portfolio before change:  [3.57667394]
curr_Stock_Price:  97.93445812706555
curr_Factors:  [97.93445813]
mat_Sqrt:  [[0.15]]
grads:  [0.15171207]
Stock Position:  0.1517120650028633
Bond Position:  [-11.28116494]


portfolio before change:  [3.57600752]
curr_Stock_Price:  97.93471308822376
curr_Factors:  [97.93471309]
mat_Sqrt:  [[0.15]]
grads:  [0.02263507]
Stock Position:  0.022635068236778515
Bond Position:  [1.35924861]


portfolio before change:  [3.59684155]
curr_Stock_Price:  98.85139123611924
curr_Factors:  [98.85139124]
mat_Sqrt:  [[0.15]]
grads:  [-0.10599398]
Stock Position:  -0.1059939766550868
Bond Position:  [14.07449361]


portfolio before change:  [3.6653879]
curr_Stock_Price:  98.2129902504387
curr_Factors:  [98.21299025]
mat_Sqrt:  [[0.15]]
grads:  [-0.03989284]
Stock Position:  -0.039892842382227844
Bond Position:  [7.58338324]


portfolio before change:  [3.67762489]
curr_Stock_Price:  97.91812496725018
curr_Factors:  [97.91812497]
mat_Sqrt:  [[0.15]]
grads:  [0.0077173]
Stock Position:  0.00771730495414482
Bond Position:  [2.92196086]


portfolio before change:  [3.67720299]
curr_Stock_Price:  97.83979131619135
curr_Factors:  [97.83979132]
mat_Sqrt:  [[0.15]]
grads:  [0.05536856]
Stock Position:  0.0553685621560847
Bond Position:  [-1.74004558]


portfolio before change:  [3.65752101]
curr_Stock_Price:  97.48628350659014
curr_Factors:  [97.48628351]
mat_Sqrt:  [[0.15]]
grads:  [0.0066452]
Stock Position:  0.006645202764014614
Bond Position:  [3.00970489]


portfolio before change:  [3.6592408]
curr_Stock_Price:  97.71677725259374
curr_Factors:  [97.71677725]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007217]
Stock Position:  -0.01007217040963525
Bond Position:  [4.64346084]


portfolio before change:  [3.6606412]
curr_Stock_Price:  97.60655610415482
curr_Factors:  [97.6065561]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620106]
Stock Position:  -0.03620105938166447
Bond Position:  [7.19410193]


portfolio before change:  [3.66896552]
curr_Stock_Price:  97.38903003458802
curr_Factors:  [97.38903003]
mat_Sqrt:  [[0.15]]
grads:  [-0.15304814]
Stock Position:  -0.15304813514228796
Bond Position:  [18.57417495]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.6826964]
Stock Price:  97.30689928249424
PL:  [3.6826964]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-9.29626016e-03]
 [-1.46771122e-03]
 [ 6.73531709e-03]
 [-1.38923834e-02]
 [ 7.20744254e-03]
 [-1.61030401e-03]
 [-9.67576415e-03]
 [-3.10086847e-02]
 [ 1.14002606e-02]
 [-5.46986499e-03]
 [-8.72777741e-03]
 [ 1.97079658e-02]
 [-4.74674678e-03]
 [ 3.64293798e-03]
 [ 7.13740983e-03]
 [ 1.08608840e-02]
 [ 9.70516143e-02]
 [-1.10738902e-02]
 [ 2.17944357e-02]
 [ 8.19528364e-04]
 [-5.22729532e-03]
 [ 4.69146551e-03]
 [ 1.46295727e-02]
 [ 1.99095709e-02]
 [-2.12905918e-03]
 [ 8.15445733e-03]
 [ 7.60649170e-03]
 [ 1.52985064e-02]
 [ 3.12324695e-02]
 [ 4.69658689e-03]
 [-7.31187402e-03]
 [ 9.98910136e-03]
 [ 1.21719598e-02]
 [-8.11198935e-03]
 [-3.37610715e-03]
 [ 1.82216730e-02]
 [ 5.90135060e-03]
 [-5.54821082e-04]
 [-1.65185448e-02]
 [-1.38338918e-02]
 [ 7.07979216e-03]
 [ 2.83998646e-02]
 [-2.72247775e-03]
 [ 9.70822720e-04]
 [ 1.42804799e-03]
 [ 1.61166184e-02]
 [ 9.75613980e-03]
 [ 5.29911401e-03]
 [-7.79104349e-03]
 [-2.99712331e-04]
 [-3.58262262e-03]
 [-5.61881695e-04]
 [-2.40891131e-04]
 [ 7.55529181e-03]
 [-1.14912513e-02]
 [-5.04670465e-03]
 [-1.44098418e-03]
 [ 1.33705624e-02]
 [ 6.32510280e-03]
 [-2.39926166e-03]
 [-5.13415669e-03]
 [-2.96253090e-03]
 [-5.69462048e-06]
 [-5.87557336e-03]
 [ 1.72638730e-02]
 [ 9.53189892e-03]
 [ 2.04480078e-02]
 [-5.86695320e-03]
 [ 1.00352903e-02]
 [ 3.02482624e-02]
 [ 3.16503700e-03]
 [-1.50287860e-02]
 [-6.02684280e-03]
 [ 3.20759510e-03]
 [ 1.24334678e-02]
 [ 2.05279597e-02]
 [ 5.50785718e-03]
 [-3.39952985e-02]
 [-3.21350179e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.80493899]
curr_Stock_Price:  100.08061810965445
curr_Factors:  [100.08061811]
mat_Sqrt:  [[0.15]]
grads:  [-0.06197507]
Stock Position:  -0.061975067757650784
Bond Position:  [10.00744208]


portfolio before change:  [3.83840887]
curr_Stock_Price:  99.55065673536872
curr_Factors:  [99.55065674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00978474]
Stock Position:  -0.009784741483829709
Bond Position:  [4.81248631]


portfolio before change:  [3.83229619]
curr_Stock_Price:  100.206112396247
curr_Factors:  [100.2061124]
mat_Sqrt:  [[0.15]]
grads:  [0.04490211]
Stock Position:  0.044902113904110405
Bond Position:  [-0.66717008]


portfolio before change:  [3.84875114]
curr_Stock_Price:  100.57350374997587
curr_Factors:  [100.57350375]
mat_Sqrt:  [[0.15]]
grads:  [-0.09261589]
Stock Position:  -0.0926158892688266
Bond Position:  [13.16345563]


portfolio before change:  [3.86788475]
curr_Stock_Price:  100.37579609403213
curr_Factors:  [100.37579609]
mat_Sqrt:  [[0.15]]
grads:  [0.04804962]
Stock Position:  0.04804961695809656
Bond Position:  [-0.9551338]


portfolio before change:  [3.88527476]
curr_Stock_Price:  100.73895613048971
curr_Factors:  [100.73895613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073536]
Stock Position:  -0.01073536004376349
Bond Position:  [4.96674372]


portfolio before change:  [3.88448168]
curr_Stock_Price:  100.8417476459727
curr_Factors:  [100.84174765]
mat_Sqrt:  [[0.15]]
grads:  [-0.06450509]
Stock Position:  -0.0645050943035024
Bond Position:  [10.38928812]


portfolio before change:  [3.86358348]
curr_Stock_Price:  101.1757918653057
curr_Factors:  [101.17579187]
mat_Sqrt:  [[0.15]]
grads:  [-0.20672456]
Stock Position:  -0.20672456474229597
Bond Position:  [24.77910502]


portfolio before change:  [3.86346554]
curr_Stock_Price:  101.18385421904408
curr_Factors:  [101.18385422]
mat_Sqrt:  [[0.15]]
grads:  [0.07600174]
Stock Position:  0.07600173715782324
Bond Position:  [-3.82668316]


portfolio before change:  [3.89879448]
curr_Stock_Price:  101.65184510837585
curr_Factors:  [101.65184511]
mat_Sqrt:  [[0.15]]
grads:  [-0.03646577]
Stock Position:  -0.03646576659047896
Bond Position:  [7.60560694]


portfolio before change:  [3.91137497]
curr_Stock_Price:  101.31988658518661
curr_Factors:  [101.31988659]
mat_Sqrt:  [[0.15]]
grads:  [-0.05818518]
Stock Position:  -0.058185182766652965
Bond Position:  [9.80669109]


portfolio before change:  [3.83552183]
curr_Stock_Price:  102.63407126130423
curr_Factors:  [102.63407126]
mat_Sqrt:  [[0.15]]
grads:  [0.13138644]
Stock Position:  0.13138643877756845
Bond Position:  [-9.64920329]


portfolio before change:  [3.87178803]
curr_Stock_Price:  102.91468848473248
curr_Factors:  [102.91468848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03164498]
Stock Position:  -0.03164497854287766
Bond Position:  [7.12852114]


portfolio before change:  [3.87929017]
curr_Stock_Price:  102.69169592139318
curr_Factors:  [102.69169592]
mat_Sqrt:  [[0.15]]
grads:  [0.02428625]
Stock Position:  0.024286253170855296
Bond Position:  [1.38529365]


portfolio before change:  [3.87475481]
curr_Stock_Price:  102.50138459398796
curr_Factors:  [102.50138459]
mat_Sqrt:  [[0.15]]
grads:  [0.04758273]
Stock Position:  0.04758273217617283
Bond Position:  [-1.00254112]


portfolio before change:  [3.87192569]
curr_Stock_Price:  102.44324453007049
curr_Factors:  [102.44324453]
mat_Sqrt:  [[0.15]]
grads:  [0.07240589]
Stock Position:  0.07240589340459727
Bond Position:  [-3.54556896]


portfolio before change:  [3.87018365]
curr_Stock_Price:  102.42224577125592
curr_Factors:  [102.42224577]
mat_Sqrt:  [[0.15]]
grads:  [0.64701076]
Stock Position:  0.6470107617556482
Bond Position:  [-62.39811161]


portfolio before change:  [4.02163197]
curr_Stock_Price:  102.66234738522752
curr_Factors:  [102.66234739]
mat_Sqrt:  [[0.15]]
grads:  [-0.07382593]
Stock Position:  -0.07382593462166932
Bond Position:  [11.60077572]


portfolio before change:  [4.04689695]
curr_Stock_Price:  102.32994509821741
curr_Factors:  [102.3299451]
mat_Sqrt:  [[0.15]]
grads:  [0.14529624]
Stock Position:  0.145296238168306
Bond Position:  [-10.82125912]


portfolio before change:  [4.07189755]
curr_Stock_Price:  102.50666645653718
curr_Factors:  [102.50666646]
mat_Sqrt:  [[0.15]]
grads:  [0.00546352]
Stock Position:  0.005463522425134645
Bond Position:  [3.51185008]


portfolio before change:  [4.07011194]
curr_Stock_Price:  102.13966770148275
curr_Factors:  [102.1396677]
mat_Sqrt:  [[0.15]]
grads:  [-0.03484864]
Stock Position:  -0.03484863543910146
Bond Position:  [7.62953999]


portfolio before change:  [4.0879434]
curr_Stock_Price:  101.64166837134263
curr_Factors:  [101.64166837]
mat_Sqrt:  [[0.15]]
grads:  [0.03127644]
Stock Position:  0.031276436717297
Bond Position:  [0.90895419]


portfolio before change:  [4.06959498]
curr_Stock_Price:  101.05319865974562
curr_Factors:  [101.05319866]
mat_Sqrt:  [[0.15]]
grads:  [0.09753048]
Stock Position:  0.09753048481386438
Bond Position:  [-5.78617248]


portfolio before change:  [4.06610443]
curr_Stock_Price:  101.02111745697839
curr_Factors:  [101.02111746]
mat_Sqrt:  [[0.15]]
grads:  [0.13273047]
Stock Position:  0.13273047251654257
Bond Position:  [-9.34247622]


portfolio before change:  [4.10186953]
curr_Stock_Price:  101.29497333487123
curr_Factors:  [101.29497333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01419373]
Stock Position:  -0.014193727894166817
Bond Position:  [5.53962282]


portfolio before change:  [4.09085399]
curr_Stock_Price:  102.09545224866072
curr_Factors:  [102.09545225]
mat_Sqrt:  [[0.15]]
grads:  [0.05436305]
Stock Position:  0.0543630488760493
Bond Position:  [-1.45936607]


portfolio before change:  [4.10560055]
curr_Stock_Price:  102.36839089647695
curr_Factors:  [102.3683909]
mat_Sqrt:  [[0.15]]
grads:  [0.05070994]
Stock Position:  0.050709944658636576
Bond Position:  [-1.08549489]


portfolio before change:  [4.08193928]
curr_Stock_Price:  101.90312849841618
curr_Factors:  [101.9031285]
mat_Sqrt:  [[0.15]]
grads:  [0.10199004]
Stock Position:  0.1019900426670963
Bond Position:  [-6.31116515]


portfolio before change:  [4.05580917]
curr_Stock_Price:  101.65079365786681
curr_Factors:  [101.65079366]
mat_Sqrt:  [[0.15]]
grads:  [0.20821646]
Stock Position:  0.20821646332632815
Bond Position:  [-17.10955958]


portfolio before change:  [3.84867469]
curr_Stock_Price:  100.66112596798567
curr_Factors:  [100.66112597]
mat_Sqrt:  [[0.15]]
grads:  [0.03131058]
Stock Position:  0.031310579293273626
Bond Position:  [0.69691652]


portfolio before change:  [3.82374284]
curr_Stock_Price:  99.86345925521123
curr_Factors:  [99.86345926]
mat_Sqrt:  [[0.15]]
grads:  [-0.04874583]
Stock Position:  -0.04874582678934298
Bond Position:  [8.69166973]


portfolio before change:  [3.83529033]
curr_Stock_Price:  99.6377119053908
curr_Factors:  [99.63771191]
mat_Sqrt:  [[0.15]]
grads:  [0.06659401]
Stock Position:  0.06659400906232736
Bond Position:  [-2.79998436]


portfolio before change:  [3.85854691]
curr_Stock_Price:  99.98956926401793
curr_Factors:  [99.98956926]
mat_Sqrt:  [[0.15]]
grads:  [0.0811464]
Stock Position:  0.0811463989080149
Bond Position:  [-4.25524656]


portfolio before change:  [3.81945617]
curr_Stock_Price:  99.51111567373455
curr_Factors:  [99.51111567]
mat_Sqrt:  [[0.15]]
grads:  [-0.05407993]
Stock Position:  -0.05407992903128442
Bond Position:  [9.20101024]


portfolio before change:  [3.88234492]
curr_Stock_Price:  98.35886440158254
curr_Factors:  [98.3588644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02250738]
Stock Position:  -0.02250738101335443
Bond Position:  [6.09614535]


portfolio before change:  [3.88387014]
curr_Stock_Price:  98.30802775006894
curr_Factors:  [98.30802775]
mat_Sqrt:  [[0.15]]
grads:  [0.12147782]
Stock Position:  0.1214778200194215
Bond Position:  [-8.05837477]


portfolio before change:  [3.86225076]
curr_Stock_Price:  98.13420414687612
curr_Factors:  [98.13420415]
mat_Sqrt:  [[0.15]]
grads:  [0.03934234]
Stock Position:  0.03934233731997305
Bond Position:  [0.0014218]


portfolio before change:  [3.83185156]
curr_Stock_Price:  97.36151785085374
curr_Factors:  [97.36151785]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369881]
Stock Position:  -0.003698807210531626
Bond Position:  [4.19197305]


portfolio before change:  [3.83269684]
curr_Stock_Price:  97.20382774076006
curr_Factors:  [97.20382774]
mat_Sqrt:  [[0.15]]
grads:  [-0.11012363]
Stock Position:  -0.11012363208522317
Bond Position:  [14.5371354]


portfolio before change:  [3.83049784]
curr_Stock_Price:  97.23204688107596
curr_Factors:  [97.23204688]
mat_Sqrt:  [[0.15]]
grads:  [-0.09222595]
Stock Position:  -0.09222594504236269
Bond Position:  [12.79781525]


portfolio before change:  [3.82481904]
curr_Stock_Price:  97.30229485109446
curr_Factors:  [97.30229485]
mat_Sqrt:  [[0.15]]
grads:  [0.04719861]
Stock Position:  0.04719861440007262
Bond Position:  [-0.76771445]


portfolio before change:  [3.84869277]
curr_Stock_Price:  97.80912559717133
curr_Factors:  [97.8091256]
mat_Sqrt:  [[0.15]]
grads:  [0.18933243]
Stock Position:  0.18933243038055655
Bond Position:  [-14.66974669]


portfolio before change:  [3.94629543]
curr_Stock_Price:  98.32947779433593
curr_Factors:  [98.32947779]
mat_Sqrt:  [[0.15]]
grads:  [-0.01814985]
Stock Position:  -0.018149851672855676
Bond Position:  [5.73096086]


portfolio before change:  [3.94465557]
curr_Stock_Price:  98.4395642988399
curr_Factors:  [98.4395643]
mat_Sqrt:  [[0.15]]
grads:  [0.00647215]
Stock Position:  0.006472151464160525
Bond Position:  [3.3075398]


portfolio before change:  [3.94482362]
curr_Stock_Price:  98.43358859352868
curr_Factors:  [98.43358859]
mat_Sqrt:  [[0.15]]
grads:  [0.00952032]
Stock Position:  0.00952031992900999
Bond Position:  [3.00770437]


portfolio before change:  [3.94178672]
curr_Stock_Price:  98.09485153396012
curr_Factors:  [98.09485153]
mat_Sqrt:  [[0.15]]
grads:  [0.10744412]
Stock Position:  0.10744412248844054
Bond Position:  [-6.59792852]


portfolio before change:  [3.80205046]
curr_Stock_Price:  96.79814140710765
curr_Factors:  [96.79814141]
mat_Sqrt:  [[0.15]]
grads:  [0.06504093]
Stock Position:  0.0650409319946251
Bond Position:  [-2.49379087]


portfolio before change:  [3.83337926]
curr_Stock_Price:  97.28221603611082
curr_Factors:  [97.28221604]
mat_Sqrt:  [[0.15]]
grads:  [0.03532743]
Stock Position:  0.035327426723448435
Bond Position:  [0.3966489]


portfolio before change:  [3.82551274]
curr_Stock_Price:  97.05883972459614
curr_Factors:  [97.05883972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05194029]
Stock Position:  -0.0519402899085364
Bond Position:  [8.86677701]


portfolio before change:  [3.83690332]
curr_Stock_Price:  96.85020803456004
curr_Factors:  [96.85020803]
mat_Sqrt:  [[0.15]]
grads:  [-0.00199808]
Stock Position:  -0.001998082204797265
Bond Position:  [4.030418]


portfolio before change:  [3.83804292]
curr_Stock_Price:  96.40593766074433
curr_Factors:  [96.40593766]
mat_Sqrt:  [[0.15]]
grads:  [-0.02388415]
Stock Position:  -0.02388415080458064
Bond Position:  [6.14061687]


portfolio before change:  [3.83319932]
curr_Stock_Price:  96.62480238284707
curr_Factors:  [96.62480238]
mat_Sqrt:  [[0.15]]
grads:  [-0.00374588]
Stock Position:  -0.0037458779673699844
Bond Position:  [4.19514404]


portfolio before change:  [3.83653183]
curr_Stock_Price:  95.80515258553754
curr_Factors:  [95.80515259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00160594]
Stock Position:  -0.001605940874222782
Bond Position:  [3.99038924]


portfolio before change:  [3.83664169]
curr_Stock_Price:  95.8920509323095
curr_Factors:  [95.89205093]
mat_Sqrt:  [[0.15]]
grads:  [0.05036861]
Stock Position:  0.05036861203619913
Bond Position:  [-0.99330782]


portfolio before change:  [3.84691523]
curr_Stock_Price:  96.09725077214475
curr_Factors:  [96.09725077]
mat_Sqrt:  [[0.15]]
grads:  [-0.07660834]
Stock Position:  -0.07660834216956039
Bond Position:  [11.2087663]


portfolio before change:  [3.86323371]
curr_Stock_Price:  95.8933838854125
curr_Factors:  [95.89338389]
mat_Sqrt:  [[0.15]]
grads:  [-0.0336447]
Stock Position:  -0.03364469768235188
Bond Position:  [7.08953762]


portfolio before change:  [3.85611016]
curr_Stock_Price:  96.1182827959312
curr_Factors:  [96.1182828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00960656]
Stock Position:  -0.00960656118613362
Bond Position:  [4.77947633]


portfolio before change:  [3.86275117]
curr_Stock_Price:  95.45807982145327
curr_Factors:  [95.45807982]
mat_Sqrt:  [[0.15]]
grads:  [0.08913708]
Stock Position:  0.08913708237465917
Bond Position:  [-4.64610356]


portfolio before change:  [3.78251622]
curr_Stock_Price:  94.56120776068357
curr_Factors:  [94.56120776]
mat_Sqrt:  [[0.15]]
grads:  [0.04216735]
Stock Position:  0.042167352018610195
Bond Position:  [-0.20487952]


portfolio before change:  [3.78856471]
curr_Stock_Price:  94.70495168885614
curr_Factors:  [94.70495169]
mat_Sqrt:  [[0.15]]
grads:  [-0.01599508]
Stock Position:  -0.01599507774813078
Bond Position:  [5.30337778]


portfolio before change:  [3.78618503]
curr_Stock_Price:  94.87445136559407
curr_Factors:  [94.87445137]
mat_Sqrt:  [[0.15]]
grads:  [-0.03422771]
Stock Position:  -0.03422771127956278
Bond Position:  [7.03352035]


portfolio before change:  [3.7863036]
curr_Stock_Price:  94.88383076282486
curr_Factors:  [94.88383076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01975021]
Stock Position:  -0.01975020602853163
Bond Position:  [5.66027881]


portfolio before change:  [3.79122723]
curr_Stock_Price:  94.65244846583566
curr_Factors:  [94.65244847]
mat_Sqrt:  [[0.15]]
grads:  [-3.79641365e-05]
Stock Position:  -3.796413653184977e-05
Bond Position:  [3.79482062]


portfolio before change:  [3.79147485]
curr_Stock_Price:  94.37744476101425
curr_Factors:  [94.37744476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03917049]
Stock Position:  -0.03917048908579925
Bond Position:  [7.48828552]


portfolio before change:  [3.81320913]
curr_Stock_Price:  93.83452961228345
curr_Factors:  [93.83452961]
mat_Sqrt:  [[0.15]]
grads:  [0.11509249]
Stock Position:  0.11509248691379051
Bond Position:  [-6.98644024]


portfolio before change:  [3.7595563]
curr_Stock_Price:  93.37215217760867
curr_Factors:  [93.37215218]
mat_Sqrt:  [[0.15]]
grads:  [0.06354599]
Stock Position:  0.06354599280258845
Bond Position:  [-2.17386981]


portfolio before change:  [3.79676878]
curr_Stock_Price:  93.95988951974273
curr_Factors:  [93.95988952]
mat_Sqrt:  [[0.15]]
grads:  [0.13632005]
Stock Position:  0.13632005209607334
Bond Position:  [-9.01184825]


portfolio before change:  [3.70650549]
curr_Stock_Price:  93.30187899478022
curr_Factors:  [93.30187899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911302]
Stock Position:  -0.03911302131724922
Bond Position:  [7.35582388]


portfolio before change:  [3.73288812]
curr_Stock_Price:  92.63911066508379
curr_Factors:  [92.63911067]
mat_Sqrt:  [[0.15]]
grads:  [0.06690194]
Stock Position:  0.0669019353581797
Bond Position:  [-2.46484767]


portfolio before change:  [3.77303176]
curr_Stock_Price:  93.24145053533275
curr_Factors:  [93.24145054]
mat_Sqrt:  [[0.15]]
grads:  [0.20165508]
Stock Position:  0.2016550826199026
Bond Position:  [-15.02958065]


portfolio before change:  [3.72498042]
curr_Stock_Price:  93.00782407199979
curr_Factors:  [93.00782407]
mat_Sqrt:  [[0.15]]
grads:  [0.02110025]
Stock Position:  0.02110024669732878
Bond Position:  [1.76249239]


portfolio before change:  [3.72752305]
curr_Stock_Price:  93.12310579645914
curr_Factors:  [93.1231058]
mat_Sqrt:  [[0.15]]
grads:  [-0.10019191]
Stock Position:  -0.10019190633941946
Bond Position:  [13.05770455]


portfolio before change:  [3.70228402]
curr_Stock_Price:  93.38315837279002
curr_Factors:  [93.38315837]
mat_Sqrt:  [[0.15]]
grads:  [-0.04017895]
Stock Position:  -0.04017895200017399
Bond Position:  [7.45432146]


portfolio before change:  [3.69407462]
curr_Stock_Price:  93.59907532516942
curr_Factors:  [93.59907533]
mat_Sqrt:  [[0.15]]
grads:  [0.02138397]
Stock Position:  0.02138396734090752
Bond Position:  [1.69255505]


portfolio before change:  [3.68189202]
curr_Stock_Price:  93.02442144677187
curr_Factors:  [93.02442145]
mat_Sqrt:  [[0.15]]
grads:  [0.08288979]
Stock Position:  0.08288978566595762
Bond Position:  [-4.02888233]


portfolio before change:  [3.62421064]
curr_Stock_Price:  92.33157885088734
curr_Factors:  [92.33157885]
mat_Sqrt:  [[0.15]]
grads:  [0.13685306]
Stock Position:  0.13685306477551304
Bond Position:  [-9.0116489]


portfolio before change:  [3.67374929]
curr_Stock_Price:  92.69767879105211
curr_Factors:  [92.69767879]
mat_Sqrt:  [[0.15]]
grads:  [0.03671905]
Stock Position:  0.03671904788559039
Bond Position:  [0.26997878]


portfolio before change:  [3.68313932]
curr_Stock_Price:  92.95294576677706
curr_Factors:  [92.95294577]
mat_Sqrt:  [[0.15]]
grads:  [-0.22663532]
Stock Position:  -0.22663532301613984
Bond Position:  [24.74956021]


portfolio before change:  [3.32922741]
curr_Stock_Price:  94.52136327405859
curr_Factors:  [94.52136327]
mat_Sqrt:  [[0.15]]
grads:  [-0.21423345]
Stock Position:  -0.21423345295870858
Bond Position:  [23.57886544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.35916827]
Stock Price:  94.38848424622434
PL:  [3.35916827]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40655658e-02]
 [ 1.43664541e-02]
 [ 1.91683425e-02]
 [-1.39804252e-02]
 [ 1.38210120e-02]
 [-1.07170394e-02]
 [-2.95538654e-03]
 [-8.08548304e-03]
 [-7.61929688e-03]
 [-9.20368776e-03]
 [ 1.35382234e-02]
 [-7.93459349e-03]
 [-1.69181839e-04]
 [ 1.13186935e-03]
 [-3.06481030e-03]
 [ 9.66253947e-03]
 [ 4.81872334e-02]
 [-1.43376701e-02]
 [ 1.84786814e-02]
 [ 2.37829845e-03]
 [-4.19900779e-03]
 [ 4.93074306e-03]
 [ 1.73500908e-02]
 [ 1.77216915e-02]
 [-6.09975243e-03]
 [ 4.52951172e-03]
 [-8.68732136e-06]
 [ 7.79082886e-03]
 [ 2.02838280e-02]
 [ 9.56912256e-04]
 [-6.44846724e-03]
 [ 1.00686544e-02]
 [ 1.15303023e-02]
 [-1.57699767e-02]
 [-3.02210629e-03]
 [ 1.84838692e-02]
 [ 4.45169275e-03]
 [ 2.69498410e-03]
 [-3.71859627e-02]
 [-1.58600345e-02]
 [ 7.15269939e-03]
 [ 2.85196388e-02]
 [-2.88579333e-03]
 [ 3.21691151e-04]
 [ 9.58071809e-03]
 [ 1.50841626e-02]
 [ 1.07678586e-02]
 [ 4.61263291e-03]
 [ 5.95308166e-03]
 [-1.43263669e-03]
 [-7.20875791e-03]
 [-2.82070153e-03]
 [ 1.98995415e-03]
 [ 3.37713907e-03]
 [-5.42295847e-03]
 [-4.04364030e-03]
 [ 7.19572622e-03]
 [ 2.37480549e-03]
 [ 7.06392041e-03]
 [-4.03206510e-03]
 [-6.16494613e-04]
 [ 5.25423978e-03]
 [-8.16473141e-03]
 [ 6.82167053e-03]
 [ 2.27745896e-02]
 [ 5.46965228e-03]
 [ 7.96007934e-03]
 [-1.42195950e-03]
 [ 2.97664077e-03]
 [ 2.17039969e-02]
 [ 1.71247012e-03]
 [-1.59851344e-02]
 [-3.11218304e-03]
 [ 1.26602906e-03]
 [-4.99823033e-04]
 [-1.27021986e-03]
 [-1.40814427e-03]
 [ 4.07565787e-03]
 [-2.38590546e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.2579522]
curr_Stock_Price:  99.75983606569405
curr_Factors:  [99.75983607]
mat_Sqrt:  [[0.15]]
grads:  [-0.09377044]
Stock Position:  -0.0937704385512936
Bond Position:  [6.09657138]


portfolio before change:  [-3.29894107]
curr_Stock_Price:  100.20101899561203
curr_Factors:  [100.201019]
mat_Sqrt:  [[0.15]]
grads:  [0.09577636]
Stock Position:  0.09577636034530003
Bond Position:  [-12.89582997]


portfolio before change:  [-3.26987348]
curr_Stock_Price:  100.51292901312725
curr_Factors:  [100.51292901]
mat_Sqrt:  [[0.15]]
grads:  [0.12778895]
Stock Position:  0.1277889499055248
Bond Position:  [-16.11431513]


portfolio before change:  [-3.2626492]
curr_Stock_Price:  100.57734342470407
curr_Factors:  [100.57734342]
mat_Sqrt:  [[0.15]]
grads:  [-0.09320283]
Stock Position:  -0.09320283462960023
Bond Position:  [6.1114443]


portfolio before change:  [-3.15671753]
curr_Stock_Price:  99.44487042021974
curr_Factors:  [99.44487042]
mat_Sqrt:  [[0.15]]
grads:  [0.09214008]
Stock Position:  0.09214008031339893
Bond Position:  [-12.31957588]


portfolio before change:  [-3.14658927]
curr_Stock_Price:  99.56314968102588
curr_Factors:  [99.56314968]
mat_Sqrt:  [[0.15]]
grads:  [-0.07144693]
Stock Position:  -0.07144692962710494
Bond Position:  [3.96689208]


portfolio before change:  [-3.12431632]
curr_Stock_Price:  99.2548787357801
curr_Factors:  [99.25487874]
mat_Sqrt:  [[0.15]]
grads:  [-0.01970258]
Stock Position:  -0.019702576904678377
Bond Position:  [-1.16873944]


portfolio before change:  [-3.14016831]
curr_Stock_Price:  100.05573533915965
curr_Factors:  [100.05573534]
mat_Sqrt:  [[0.15]]
grads:  [-0.05390322]
Stock Position:  -0.05390322028476731
Bond Position:  [2.25315804]


portfolio before change:  [-3.131742]
curr_Stock_Price:  99.90202511066754
curr_Factors:  [99.90202511]
mat_Sqrt:  [[0.15]]
grads:  [-0.05079531]
Stock Position:  -0.05079531251333834
Bond Position:  [1.94281258]


portfolio before change:  [-3.10365478]
curr_Stock_Price:  99.35146665198657
curr_Factors:  [99.35146665]
mat_Sqrt:  [[0.15]]
grads:  [-0.06135792]
Stock Position:  -0.06135791836911699
Bond Position:  [2.9923444]


portfolio before change:  [-3.10730999]
curr_Stock_Price:  99.41408669661386
curr_Factors:  [99.4140867]
mat_Sqrt:  [[0.15]]
grads:  [0.09025482]
Stock Position:  0.09025482275624931
Bond Position:  [-12.07991077]


portfolio before change:  [-3.1518441]
curr_Stock_Price:  98.92902578372822
curr_Factors:  [98.92902578]
mat_Sqrt:  [[0.15]]
grads:  [-0.05289729]
Stock Position:  -0.052897289936295395
Bond Position:  [2.08123326]


portfolio before change:  [-3.14888273]
curr_Stock_Price:  98.87550161826792
curr_Factors:  [98.87550162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00112788]
Stock Position:  -0.001127878927985361
Bond Position:  [-3.03736314]


portfolio before change:  [-3.14873251]
curr_Stock_Price:  98.57399351904925
curr_Factors:  [98.57399352]
mat_Sqrt:  [[0.15]]
grads:  [0.0075458]
Stock Position:  0.007545795682694801
Bond Position:  [-3.89255172]


portfolio before change:  [-3.14666404]
curr_Stock_Price:  98.88035734285461
curr_Factors:  [98.88035734]
mat_Sqrt:  [[0.15]]
grads:  [-0.02043207]
Stock Position:  -0.020432068683448
Bond Position:  [-1.12633379]


portfolio before change:  [-3.1483678]
curr_Stock_Price:  98.96029845823588
curr_Factors:  [98.96029846]
mat_Sqrt:  [[0.15]]
grads:  [0.06441693]
Stock Position:  0.06441692977633597
Bond Position:  [-9.5230864]


portfolio before change:  [-3.03545533]
curr_Stock_Price:  100.72237697991288
curr_Factors:  [100.72237698]
mat_Sqrt:  [[0.15]]
grads:  [0.32124822]
Stock Position:  0.3212482225455784
Bond Position:  [-35.3923399]


portfolio before change:  [-2.94274844]
curr_Stock_Price:  101.01784624639396
curr_Factors:  [101.01784625]
mat_Sqrt:  [[0.15]]
grads:  [-0.09558447]
Stock Position:  -0.09558446752011708
Bond Position:  [6.7129886]


portfolio before change:  [-2.90545122]
curr_Stock_Price:  100.63203416409654
curr_Factors:  [100.63203416]
mat_Sqrt:  [[0.15]]
grads:  [0.12319121]
Stock Position:  0.12319120927605741
Bond Position:  [-15.3024332]


portfolio before change:  [-2.93208256]
curr_Stock_Price:  100.42361906180597
curr_Factors:  [100.42361906]
mat_Sqrt:  [[0.15]]
grads:  [0.01585532]
Stock Position:  0.015855322978694117
Bond Position:  [-4.52433148]


portfolio before change:  [-2.93674532]
curr_Stock_Price:  100.1473723867721
curr_Factors:  [100.14737239]
mat_Sqrt:  [[0.15]]
grads:  [-0.02799339]
Stock Position:  -0.02799338523741447
Bond Position:  [-0.13328135]


portfolio before change:  [-2.91476747]
curr_Stock_Price:  99.3619659344705
curr_Factors:  [99.36196593]
mat_Sqrt:  [[0.15]]
grads:  [0.03287162]
Stock Position:  0.03287162038015271
Bond Position:  [-6.18095629]


portfolio before change:  [-2.90658372]
curr_Stock_Price:  99.62267916479377
curr_Factors:  [99.62267916]
mat_Sqrt:  [[0.15]]
grads:  [0.11566727]
Stock Position:  0.11566727203587715
Bond Position:  [-14.42966726]


portfolio before change:  [-2.9250773]
curr_Stock_Price:  99.4705904241522
curr_Factors:  [99.47059042]
mat_Sqrt:  [[0.15]]
grads:  [0.11814461]
Stock Position:  0.11814460984001128
Bond Position:  [-14.67699139]


portfolio before change:  [-2.9178332]
curr_Stock_Price:  99.53967051453756
curr_Factors:  [99.53967051]
mat_Sqrt:  [[0.15]]
grads:  [-0.04066502]
Stock Position:  -0.04066501617825861
Bond Position:  [1.12994912]


portfolio before change:  [-2.91426282]
curr_Stock_Price:  99.45360754977091
curr_Factors:  [99.45360755]
mat_Sqrt:  [[0.15]]
grads:  [0.03019674]
Stock Position:  0.030196744831104926
Bond Position:  [-5.91743803]


portfolio before change:  [-2.89293481]
curr_Stock_Price:  100.17215731441463
curr_Factors:  [100.17215731]
mat_Sqrt:  [[0.15]]
grads:  [-5.79154757e-05]
Stock Position:  -5.791547572005461e-05
Bond Position:  [-2.88713329]


portfolio before change:  [-2.89310122]
curr_Stock_Price:  99.92976698835592
curr_Factors:  [99.92976699]
mat_Sqrt:  [[0.15]]
grads:  [0.05193886]
Stock Position:  0.0519388590354301
Bond Position:  [-8.0833393]


portfolio before change:  [-2.90052273]
curr_Stock_Price:  99.79660500258828
curr_Factors:  [99.796605]
mat_Sqrt:  [[0.15]]
grads:  [0.13522552]
Stock Position:  0.1352255198527634
Bond Position:  [-16.39557052]


portfolio before change:  [-2.90524469]
curr_Stock_Price:  99.7692639561054
curr_Factors:  [99.76926396]
mat_Sqrt:  [[0.15]]
grads:  [0.00637942]
Stock Position:  0.006379415038422881
Bond Position:  [-3.54171423]


portfolio before change:  [-2.9094892]
curr_Stock_Price:  99.13861924522672
curr_Factors:  [99.13861925]
mat_Sqrt:  [[0.15]]
grads:  [-0.04298978]
Stock Position:  -0.04298978157600177
Bond Position:  [1.35245839]


portfolio before change:  [-2.91011981]
curr_Stock_Price:  99.1552545085164
curr_Factors:  [99.15525451]
mat_Sqrt:  [[0.15]]
grads:  [0.06712436]
Stock Position:  0.06712436283420056
Bond Position:  [-9.56585309]


portfolio before change:  [-2.93886609]
curr_Stock_Price:  98.73590760923747
curr_Factors:  [98.73590761]
mat_Sqrt:  [[0.15]]
grads:  [0.07686868]
Stock Position:  0.07686868203504507
Bond Position:  [-10.52856518]


portfolio before change:  [-2.9329703]
curr_Stock_Price:  98.82116786810545
curr_Factors:  [98.82116787]
mat_Sqrt:  [[0.15]]
grads:  [-0.10513318]
Stock Position:  -0.10513317805331097
Bond Position:  [7.45641313]


portfolio before change:  [-2.89061583]
curr_Stock_Price:  98.42273575119086
curr_Factors:  [98.42273575]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014738]
Stock Position:  -0.020147375275375978
Bond Position:  [-0.90765604]


portfolio before change:  [-2.89720233]
curr_Stock_Price:  98.74683609574404
curr_Factors:  [98.7468361]
mat_Sqrt:  [[0.15]]
grads:  [0.12322579]
Stock Position:  0.12322579448302981
Bond Position:  [-15.06535966]


portfolio before change:  [-2.90526809]
curr_Stock_Price:  98.68902232091494
curr_Factors:  [98.68902232]
mat_Sqrt:  [[0.15]]
grads:  [0.02967795]
Stock Position:  0.02967795169370034
Bond Position:  [-5.83415613]


portfolio before change:  [-2.89064438]
curr_Stock_Price:  99.19405586925521
curr_Factors:  [99.19405587]
mat_Sqrt:  [[0.15]]
grads:  [0.01796656]
Stock Position:  0.017966560673667552
Bond Position:  [-4.6728204]


portfolio before change:  [-2.89660001]
curr_Stock_Price:  98.87882722633147
curr_Factors:  [98.87882723]
mat_Sqrt:  [[0.15]]
grads:  [-0.24790642]
Stock Position:  -0.24790641829499332
Bond Position:  [21.61609589]


portfolio before change:  [-2.68189769]
curr_Stock_Price:  98.01821509124906
curr_Factors:  [98.01821509]
mat_Sqrt:  [[0.15]]
grads:  [-0.10573356]
Stock Position:  -0.10573356345691713
Bond Position:  [7.68191747]


portfolio before change:  [-2.71308166]
curr_Stock_Price:  98.3176857752113
curr_Factors:  [98.31768578]
mat_Sqrt:  [[0.15]]
grads:  [0.04768466]
Stock Position:  0.047684662625840916
Bond Position:  [-7.40132734]


portfolio before change:  [-2.73866835]
curr_Stock_Price:  97.79080590151644
curr_Factors:  [97.7908059]
mat_Sqrt:  [[0.15]]
grads:  [0.19013093]
Stock Position:  0.1901309256018941
Bond Position:  [-21.33172479]


portfolio before change:  [-2.68260155]
curr_Stock_Price:  98.09270352716942
curr_Factors:  [98.09270353]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923862]
Stock Position:  -0.019238622171412856
Bond Position:  [-0.79543308]


portfolio before change:  [-2.69323156]
curr_Stock_Price:  98.64265420577586
curr_Factors:  [98.64265421]
mat_Sqrt:  [[0.15]]
grads:  [0.00214461]
Stock Position:  0.0021446076731288246
Bond Position:  [-2.90478135]


portfolio before change:  [-2.69268681]
curr_Stock_Price:  98.98131675853274
curr_Factors:  [98.98131676]
mat_Sqrt:  [[0.15]]
grads:  [0.06387145]
Stock Position:  0.06387145393787047
Bond Position:  [-9.01476743]


portfolio before change:  [-2.67322978]
curr_Stock_Price:  99.2947662087217
curr_Factors:  [99.29476621]
mat_Sqrt:  [[0.15]]
grads:  [0.10056108]
Stock Position:  0.10056108404410491
Bond Position:  [-12.65841911]


portfolio before change:  [-2.64330279]
curr_Stock_Price:  99.6002339113887
curr_Factors:  [99.60023391]
mat_Sqrt:  [[0.15]]
grads:  [0.07178572]
Stock Position:  0.07178572428517092
Bond Position:  [-9.79317772]


portfolio before change:  [-2.66223785]
curr_Stock_Price:  99.34498870445526
curr_Factors:  [99.3449887]
mat_Sqrt:  [[0.15]]
grads:  [0.03075089]
Stock Position:  0.030750886052174038
Bond Position:  [-5.71718427]


portfolio before change:  [-2.65754289]
curr_Stock_Price:  99.50928626694669
curr_Factors:  [99.50928627]
mat_Sqrt:  [[0.15]]
grads:  [0.03968721]
Stock Position:  0.03968721105892151
Bond Position:  [-6.60678893]


portfolio before change:  [-2.69802749]
curr_Stock_Price:  98.49959919334147
curr_Factors:  [98.49959919]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955091]
Stock Position:  -0.009550911251861324
Bond Position:  [-1.75726656]


portfolio before change:  [-2.70298373]
curr_Stock_Price:  99.00702817602979
curr_Factors:  [99.00702818]
mat_Sqrt:  [[0.15]]
grads:  [-0.04805839]
Stock Position:  -0.04805838608483037
Bond Position:  [2.05513426]


portfolio before change:  [-2.71611057]
curr_Stock_Price:  99.28284460184777
curr_Factors:  [99.2828446]
mat_Sqrt:  [[0.15]]
grads:  [-0.01880468]
Stock Position:  -0.018804676896076383
Bond Position:  [-0.84912876]


portfolio before change:  [-2.72613068]
curr_Stock_Price:  99.81287402921927
curr_Factors:  [99.81287403]
mat_Sqrt:  [[0.15]]
grads:  [0.01326636]
Stock Position:  0.013266360981055835
Bond Position:  [-4.05028429]


portfolio before change:  [-2.72635582]
curr_Stock_Price:  99.81498486349939
curr_Factors:  [99.81498486]
mat_Sqrt:  [[0.15]]
grads:  [0.02251426]
Stock Position:  0.022514260434212605
Bond Position:  [-4.97361639]


portfolio before change:  [-2.73421375]
curr_Stock_Price:  99.47977208122262
curr_Factors:  [99.47977208]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615306]
Stock Position:  -0.03615305644633786
Bond Position:  [0.86228406]


portfolio before change:  [-2.76190579]
curr_Stock_Price:  100.24722963596139
curr_Factors:  [100.24722964]
mat_Sqrt:  [[0.15]]
grads:  [-0.0269576]
Stock Position:  -0.02695760199224784
Bond Position:  [-0.05948088]


portfolio before change:  [-2.76554275]
curr_Stock_Price:  100.3820055142054
curr_Factors:  [100.38200551]
mat_Sqrt:  [[0.15]]
grads:  [0.04797151]
Stock Position:  0.0479715081535785
Bond Position:  [-7.58101894]


portfolio before change:  [-2.76915033]
curr_Stock_Price:  100.31668015230238
curr_Factors:  [100.31668015]
mat_Sqrt:  [[0.15]]
grads:  [0.01583204]
Stock Position:  0.01583203658129835
Bond Position:  [-4.35736768]


portfolio before change:  [-2.77156842]
curr_Stock_Price:  100.18114827299657
curr_Factors:  [100.18114827]
mat_Sqrt:  [[0.15]]
grads:  [0.0470928]
Stock Position:  0.04709280273194555
Bond Position:  [-7.48937947]


portfolio before change:  [-2.78179688]
curr_Stock_Price:  99.97389022869284
curr_Factors:  [99.97389023]
mat_Sqrt:  [[0.15]]
grads:  [-0.02688043]
Stock Position:  -0.02688043400017426
Bond Position:  [-0.09445533]


portfolio before change:  [-2.79261462]
curr_Stock_Price:  100.37610951151905
curr_Factors:  [100.37610951]
mat_Sqrt:  [[0.15]]
grads:  [-0.00410996]
Stock Position:  -0.004109964088145832
Bond Position:  [-2.38007241]


portfolio before change:  [-2.79195675]
curr_Stock_Price:  100.17984950540979
curr_Factors:  [100.17984951]
mat_Sqrt:  [[0.15]]
grads:  [0.03502827]
Stock Position:  0.03502826518023887
Bond Position:  [-6.30108309]


portfolio before change:  [-2.78910004]
curr_Stock_Price:  100.27264718798577
curr_Factors:  [100.27264719]
mat_Sqrt:  [[0.15]]
grads:  [-0.05443154]
Stock Position:  -0.054431542744063345
Bond Position:  [2.66889484]


portfolio before change:  [-2.75150417]
curr_Stock_Price:  99.58501160256918
curr_Factors:  [99.5850116]
mat_Sqrt:  [[0.15]]
grads:  [0.0454778]
Stock Position:  0.045477803558219836
Bond Position:  [-7.28041176]


portfolio before change:  [-2.73272809]
curr_Stock_Price:  100.00787981588053
curr_Factors:  [100.00787982]
mat_Sqrt:  [[0.15]]
grads:  [0.1518306]
Stock Position:  0.15183059761780107
Bond Position:  [-17.91698425]


portfolio before change:  [-2.75199069]
curr_Stock_Price:  99.88838643156363
curr_Factors:  [99.88838643]
mat_Sqrt:  [[0.15]]
grads:  [0.03646435]
Stock Position:  0.03646434854125671
Bond Position:  [-6.39435562]


portfolio before change:  [-2.7368615]
curr_Stock_Price:  100.31425016250118
curr_Factors:  [100.31425016]
mat_Sqrt:  [[0.15]]
grads:  [0.0530672]
Stock Position:  0.05306719559077959
Bond Position:  [-8.06025744]


portfolio before change:  [-2.74653311]
curr_Stock_Price:  100.1414913654725
curr_Factors:  [100.14149137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947973]
Stock Position:  -0.009479730018679003
Bond Position:  [-1.79721881]


portfolio before change:  [-2.74468009]
curr_Stock_Price:  99.9341697367645
curr_Factors:  [99.93416974]
mat_Sqrt:  [[0.15]]
grads:  [0.01984427]
Stock Position:  0.019844271814760454
Bond Position:  [-4.72780091]


portfolio before change:  [-2.74894919]
curr_Stock_Price:  99.73393037978235
curr_Factors:  [99.73393038]
mat_Sqrt:  [[0.15]]
grads:  [0.14469331]
Stock Position:  0.1446933129319802
Bond Position:  [-17.17978199]


portfolio before change:  [-2.78485946]
curr_Stock_Price:  99.49316940060572
curr_Factors:  [99.4931694]
mat_Sqrt:  [[0.15]]
grads:  [0.01141647]
Stock Position:  0.01141646747086662
Bond Position:  [-3.92071999]


portfolio before change:  [-2.78151402]
curr_Stock_Price:  99.80767027998965
curr_Factors:  [99.80767028]
mat_Sqrt:  [[0.15]]
grads:  [-0.10656756]
Stock Position:  -0.10656756296925196
Bond Position:  [7.85474616]


portfolio before change:  [-2.80820802]
curr_Stock_Price:  100.0627660770222
curr_Factors:  [100.06276608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074789]
Stock Position:  -0.020747886960964027
Bond Position:  [-0.73211706]


portfolio before change:  [-2.80846459]
curr_Stock_Price:  100.07292658806948
curr_Factors:  [100.07292659]
mat_Sqrt:  [[0.15]]
grads:  [0.00844019]
Stock Position:  0.008440193754143639
Bond Position:  [-3.65309948]


portfolio before change:  [-2.80365267]
curr_Stock_Price:  100.67009843854599
curr_Factors:  [100.67009844]
mat_Sqrt:  [[0.15]]
grads:  [-0.00333215]
Stock Position:  -0.0033321535512759993
Bond Position:  [-2.46820445]


portfolio before change:  [-2.79986141]
curr_Stock_Price:  99.48601992254753
curr_Factors:  [99.48601992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00846813]
Stock Position:  -0.00846813240636098
Bond Position:  [-1.95740062]


portfolio before change:  [-2.7961431]
curr_Stock_Price:  99.03247833218771
curr_Factors:  [99.03247833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00938763]
Stock Position:  -0.009387628485186199
Bond Position:  [-1.86646298]


portfolio before change:  [-2.79655393]
curr_Stock_Price:  99.06381455466382
curr_Factors:  [99.06381455]
mat_Sqrt:  [[0.15]]
grads:  [0.02717105]
Stock Position:  0.027171052466829985
Bond Position:  [-5.48822203]


portfolio before change:  [-2.80729846]
curr_Stock_Price:  98.68099888346543
curr_Factors:  [98.68099888]
mat_Sqrt:  [[0.15]]
grads:  [-0.15906036]
Stock Position:  -0.15906036406192778
Bond Position:  [12.88893715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.69659232]
Stock Price:  97.99006275746027
PL:  [-2.69659232]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.23909258e-02]
 [-2.49858195e-02]
 [ 4.15233919e-02]
 [-8.57022631e-03]
 [ 1.31276761e-02]
 [-2.57620183e-03]
 [ 2.42795120e-03]
 [ 2.08888624e-02]
 [-1.64534923e-02]
 [-1.21759036e-02]
 [ 1.18956007e-02]
 [-7.57266435e-03]
 [-9.44293770e-04]
 [ 8.47579624e-03]
 [-1.26305530e-03]
 [ 1.29377329e-02]
 [ 3.50605940e-02]
 [-1.47294905e-02]
 [ 1.92211428e-02]
 [ 2.67350833e-03]
 [-4.19003300e-03]
 [ 4.27138127e-03]
 [ 1.49844698e-02]
 [ 2.49666019e-02]
 [ 2.06728040e-03]
 [ 8.27094030e-03]
 [ 2.25845553e-02]
 [ 2.45689760e-02]
 [ 1.07189864e-02]
 [-9.32600427e-03]
 [ 3.02163761e-03]
 [ 1.58039972e-02]
 [ 1.76238918e-02]
 [-1.42867996e-02]
 [ 3.39335468e-03]
 [-2.32996820e-02]
 [-8.83488502e-03]
 [-1.51747625e-02]
 [ 9.93433260e-03]
 [-5.77316369e-02]
 [ 3.32195511e-03]
 [-6.19206101e-04]
 [-1.61943684e-02]
 [ 1.72137562e-02]
 [-7.88801650e-03]
 [ 1.17558558e-02]
 [ 1.04686439e-02]
 [-3.55131209e-03]
 [ 1.46292525e-02]
 [-1.43603023e-03]
 [ 2.09900850e-02]
 [ 1.54468066e-02]
 [-7.15865923e-03]
 [-5.94497703e-02]
 [-1.92228319e-02]
 [-2.24568348e-03]
 [-4.99705373e-03]
 [-1.28483653e-02]
 [-5.58548870e-04]
 [-2.89147190e-03]
 [-7.68646140e-03]
 [-4.19150543e-03]
 [-1.75820148e-02]
 [-7.68710706e-05]
 [-2.53976124e-03]
 [ 2.20041203e-02]
 [-3.94209908e-04]
 [ 1.70659800e-02]
 [ 8.06972888e-03]
 [ 1.14975167e-02]
 [ 7.05636189e-03]
 [-1.45801474e-02]
 [-3.85373166e-02]
 [ 7.38400008e-04]
 [-2.66211271e-03]
 [-2.06504307e-02]
 [-4.56029052e-03]
 [ 1.34953378e-02]
 [ 3.08454262e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.98022985]
curr_Stock_Price:  99.1365983355197
curr_Factors:  [99.13659834]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260617]
Stock Position:  -0.08260617168416168
Bond Position:  [-8.79093499]


portfolio before change:  [-16.92431047]
curr_Stock_Price:  98.45300729874151
curr_Factors:  [98.4530073]
mat_Sqrt:  [[0.15]]
grads:  [-0.16657213]
Stock Position:  -0.16657213028029294
Bond Position:  [-0.52478331]


portfolio before change:  [-16.96418011]
curr_Stock_Price:  98.69216398204325
curr_Factors:  [98.69216398]
mat_Sqrt:  [[0.15]]
grads:  [0.27682261]
Stock Position:  0.2768226127840196
Bond Position:  [-44.2844028]


portfolio before change:  [-16.75643438]
curr_Stock_Price:  99.45262782686474
curr_Factors:  [99.45262783]
mat_Sqrt:  [[0.15]]
grads:  [-0.05713484]
Stock Position:  -0.057134842073253485
Bond Position:  [-11.07422419]


portfolio before change:  [-16.79644014]
curr_Stock_Price:  100.14071243942212
curr_Factors:  [100.14071244]
mat_Sqrt:  [[0.15]]
grads:  [0.08751784]
Stock Position:  0.08751784084338882
Bond Position:  [-25.56053908]


portfolio before change:  [-16.77109217]
curr_Stock_Price:  100.44859891107637
curr_Factors:  [100.44859891]
mat_Sqrt:  [[0.15]]
grads:  [-0.01717468]
Stock Position:  -0.017174678872444227
Bond Position:  [-15.04591974]


portfolio before change:  [-16.7631843]
curr_Stock_Price:  99.93340619024366
curr_Factors:  [99.93340619]
mat_Sqrt:  [[0.15]]
grads:  [0.01618634]
Stock Position:  0.016186341318567336
Bond Position:  [-18.38074052]


portfolio before change:  [-16.78278965]
curr_Stock_Price:  98.79315355189621
curr_Factors:  [98.79315355]
mat_Sqrt:  [[0.15]]
grads:  [0.13925908]
Stock Position:  0.13925908280771118
Bond Position:  [-30.5406336]


portfolio before change:  [-16.75881207]
curr_Stock_Price:  98.97904039323927
curr_Factors:  [98.97904039]
mat_Sqrt:  [[0.15]]
grads:  [-0.10968995]
Stock Position:  -0.10968994867366827
Bond Position:  [-5.90180621]


portfolio before change:  [-16.76709993]
curr_Stock_Price:  99.05123471275495
curr_Factors:  [99.05123471]
mat_Sqrt:  [[0.15]]
grads:  [-0.08117269]
Stock Position:  -0.08117269075731874
Bond Position:  [-8.72684469]


portfolio before change:  [-16.7485801]
curr_Stock_Price:  98.81636171630845
curr_Factors:  [98.81636172]
mat_Sqrt:  [[0.15]]
grads:  [0.079304]
Stock Position:  0.07930400450155768
Bond Position:  [-24.5851133]


portfolio before change:  [-16.7302916]
curr_Stock_Price:  99.0663506713757
curr_Factors:  [99.06635067]
mat_Sqrt:  [[0.15]]
grads:  [-0.05048443]
Stock Position:  -0.05048442898543725
Bond Position:  [-11.72898345]


portfolio before change:  [-16.74969085]
curr_Stock_Price:  99.43609184103056
curr_Factors:  [99.43609184]
mat_Sqrt:  [[0.15]]
grads:  [-0.00629529]
Stock Position:  -0.006295291801832459
Bond Position:  [-16.12371164]


portfolio before change:  [-16.75247843]
curr_Stock_Price:  99.7188125962988
curr_Factors:  [99.7188126]
mat_Sqrt:  [[0.15]]
grads:  [0.05650531]
Stock Position:  0.05650530824645715
Bond Position:  [-22.38712067]


portfolio before change:  [-16.78362058]
curr_Stock_Price:  99.19243881728296
curr_Factors:  [99.19243882]
mat_Sqrt:  [[0.15]]
grads:  [-0.00842037]
Stock Position:  -0.008420368683632735
Bond Position:  [-15.94838367]


portfolio before change:  [-16.79082431]
curr_Stock_Price:  99.92957070497529
curr_Factors:  [99.9295707]
mat_Sqrt:  [[0.15]]
grads:  [0.08625155]
Stock Position:  0.0862515525837502
Bond Position:  [-25.40990493]


portfolio before change:  [-16.77633684]
curr_Stock_Price:  100.11595149607518
curr_Factors:  [100.1159515]
mat_Sqrt:  [[0.15]]
grads:  [0.23373729]
Stock Position:  0.23373729324556336
Bond Position:  [-40.17716835]


portfolio before change:  [-16.77639122]
curr_Stock_Price:  100.12646234745985
curr_Factors:  [100.12646235]
mat_Sqrt:  [[0.15]]
grads:  [-0.0981966]
Stock Position:  -0.09819660362732481
Bond Position:  [-6.94431268]


portfolio before change:  [-16.80340725]
curr_Stock_Price:  100.39716423659286
curr_Factors:  [100.39716424]
mat_Sqrt:  [[0.15]]
grads:  [0.12814095]
Stock Position:  0.1281409518281015
Bond Position:  [-29.66839544]


portfolio before change:  [-16.84182013]
curr_Stock_Price:  100.11186478105319
curr_Factors:  [100.11186478]
mat_Sqrt:  [[0.15]]
grads:  [0.01782339]
Stock Position:  0.0178233888487507
Bond Position:  [-18.62615283]


portfolio before change:  [-16.83229211]
curr_Stock_Price:  100.71176140711009
curr_Factors:  [100.71176141]
mat_Sqrt:  [[0.15]]
grads:  [-0.02793355]
Stock Position:  -0.027933553358640863
Bond Position:  [-14.01905475]


portfolio before change:  [-16.8322902]
curr_Stock_Price:  100.68032501800204
curr_Factors:  [100.68032502]
mat_Sqrt:  [[0.15]]
grads:  [0.02847588]
Stock Position:  0.02847587515504621
Bond Position:  [-19.69925056]


portfolio before change:  [-16.83000387]
curr_Stock_Price:  100.80385305845806
curr_Factors:  [100.80385306]
mat_Sqrt:  [[0.15]]
grads:  [0.09989647]
Stock Position:  0.09989646525648861
Bond Position:  [-26.89995248]


portfolio before change:  [-16.73586547]
curr_Stock_Price:  101.76304314036769
curr_Factors:  [101.76304314]
mat_Sqrt:  [[0.15]]
grads:  [0.16644401]
Stock Position:  0.16644401269110642
Bond Position:  [-33.67371472]


portfolio before change:  [-16.58268321]
curr_Stock_Price:  102.69601112584661
curr_Factors:  [102.69601113]
mat_Sqrt:  [[0.15]]
grads:  [0.01378187]
Stock Position:  0.013781869352900029
Bond Position:  [-17.99802622]


portfolio before change:  [-16.58464774]
curr_Stock_Price:  102.6350895351054
curr_Factors:  [102.63508954]
mat_Sqrt:  [[0.15]]
grads:  [0.0551396]
Stock Position:  0.05513960200813364
Bond Position:  [-22.24390572]


portfolio before change:  [-16.56739806]
curr_Stock_Price:  102.9731399224879
curr_Factors:  [102.97313992]
mat_Sqrt:  [[0.15]]
grads:  [0.1505637]
Stock Position:  0.15056370220218177
Bond Position:  [-32.07141523]


portfolio before change:  [-16.48142394]
curr_Stock_Price:  103.5574682921925
curr_Factors:  [103.55746829]
mat_Sqrt:  [[0.15]]
grads:  [0.16379317]
Stock Position:  0.16379317362243062
Bond Position:  [-33.44343033]


portfolio before change:  [-16.43750681]
curr_Stock_Price:  103.83835555353444
curr_Factors:  [103.83835555]
mat_Sqrt:  [[0.15]]
grads:  [0.07145991]
Stock Position:  0.0714599090102122
Bond Position:  [-23.85778625]


portfolio before change:  [-16.41284625]
curr_Stock_Price:  104.20431901685171
curr_Factors:  [104.20431902]
mat_Sqrt:  [[0.15]]
grads:  [-0.06217336]
Stock Position:  -0.06217336181210259
Bond Position:  [-9.93411342]


portfolio before change:  [-16.39312051]
curr_Stock_Price:  103.87706250258009
curr_Factors:  [103.8770625]
mat_Sqrt:  [[0.15]]
grads:  [0.02014425]
Stock Position:  0.02014425076100544
Bond Position:  [-18.48564611]


portfolio before change:  [-16.37043123]
curr_Stock_Price:  105.06075876031986
curr_Factors:  [105.06075876]
mat_Sqrt:  [[0.15]]
grads:  [0.10535998]
Stock Position:  0.10535998138567815
Bond Position:  [-27.43963081]


portfolio before change:  [-16.25096575]
curr_Stock_Price:  106.21091564300235
curr_Factors:  [106.21091564]
mat_Sqrt:  [[0.15]]
grads:  [0.11749261]
Stock Position:  0.11749261227901461
Bond Position:  [-28.72996368]


portfolio before change:  [-16.14707006]
curr_Stock_Price:  107.11047321833384
curr_Factors:  [107.11047322]
mat_Sqrt:  [[0.15]]
grads:  [-0.09524533]
Stock Position:  -0.09524533047719108
Bond Position:  [-5.94529764]


portfolio before change:  [-16.13416428]
curr_Stock_Price:  106.97107138068614
curr_Factors:  [106.97107138]
mat_Sqrt:  [[0.15]]
grads:  [0.02262236]
Stock Position:  0.022622364502487398
Bond Position:  [-18.55410285]


portfolio before change:  [-16.15215707]
curr_Stock_Price:  106.22697911826518
curr_Factors:  [106.22697912]
mat_Sqrt:  [[0.15]]
grads:  [-0.15533121]
Stock Position:  -0.15533121300980574
Bond Position:  [0.34820845]


portfolio before change:  [-16.17943453]
curr_Stock_Price:  106.40272755622732
curr_Factors:  [106.40272756]
mat_Sqrt:  [[0.15]]
grads:  [-0.05889923]
Stock Position:  -0.05889923343972845
Bond Position:  [-9.91239544]


portfolio before change:  [-16.11921939]
curr_Stock_Price:  105.36986727711458
curr_Factors:  [105.36986728]
mat_Sqrt:  [[0.15]]
grads:  [-0.10116508]
Stock Position:  -0.10116508360471184
Bond Position:  [-5.45946796]


portfolio before change:  [-16.14258444]
curr_Stock_Price:  105.59745390653819
curr_Factors:  [105.59745391]
mat_Sqrt:  [[0.15]]
grads:  [0.06622888]
Stock Position:  0.06622888401924217
Bond Position:  [-23.13618597]


portfolio before change:  [-16.14121162]
curr_Stock_Price:  105.64001659979029
curr_Factors:  [105.6400166]
mat_Sqrt:  [[0.15]]
grads:  [-0.38487758]
Stock Position:  -0.38487757964564195
Bond Position:  [24.51726229]


portfolio before change:  [-16.1449341]
curr_Stock_Price:  105.65366991619523
curr_Factors:  [105.65366992]
mat_Sqrt:  [[0.15]]
grads:  [0.02214637]
Stock Position:  0.02214636737432187
Bond Position:  [-18.48477908]


portfolio before change:  [-16.14242974]
curr_Stock_Price:  105.81892022212219
curr_Factors:  [105.81892022]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412804]
Stock Position:  -0.0041280406758736204
Bond Position:  [-15.70560493]


portfolio before change:  [-16.14259008]
curr_Stock_Price:  105.61996780272551
curr_Factors:  [105.6199678]
mat_Sqrt:  [[0.15]]
grads:  [-0.10796246]
Stock Position:  -0.10796245612819895
Bond Position:  [-4.73959894]


portfolio before change:  [-16.15291258]
curr_Stock_Price:  105.71283588327215
curr_Factors:  [105.71283588]
mat_Sqrt:  [[0.15]]
grads:  [0.11475837]
Stock Position:  0.11475837447032448
Bond Position:  [-28.28434579]


portfolio before change:  [-16.102592]
curr_Stock_Price:  106.16673229634675
curr_Factors:  [106.1667323]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258678]
Stock Position:  -0.052586776662814735
Bond Position:  [-10.51962576]


portfolio before change:  [-16.12077797]
curr_Stock_Price:  106.50005714695729
curr_Factors:  [106.50005715]
mat_Sqrt:  [[0.15]]
grads:  [0.07837237]
Stock Position:  0.07837237193571372
Bond Position:  [-24.46744006]


portfolio before change:  [-16.12386129]
curr_Stock_Price:  106.4802280342114
curr_Factors:  [106.48022803]
mat_Sqrt:  [[0.15]]
grads:  [0.06979096]
Stock Position:  0.06979095916483921
Bond Position:  [-23.55521854]


portfolio before change:  [-16.09447268]
curr_Stock_Price:  106.92241794384788
curr_Factors:  [106.92241794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02367541]
Stock Position:  -0.023675413924126403
Bond Position:  [-13.56304018]


portfolio before change:  [-16.08009276]
curr_Stock_Price:  106.27923426865858
curr_Factors:  [106.27923427]
mat_Sqrt:  [[0.15]]
grads:  [0.09752835]
Stock Position:  0.09752834993000678
Bond Position:  [-26.44533111]


portfolio before change:  [-16.18143093]
curr_Stock_Price:  105.25711823000026
curr_Factors:  [105.25711823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00957353]
Stock Position:  -0.009573534895277371
Bond Position:  [-15.17374824]


portfolio before change:  [-16.17489158]
curr_Stock_Price:  104.47498867027726
curr_Factors:  [104.47498867]
mat_Sqrt:  [[0.15]]
grads:  [0.1399339]
Stock Position:  0.13993389997030325
Bond Position:  [-30.79448419]


portfolio before change:  [-16.02263396]
curr_Stock_Price:  105.57681124569349
curr_Factors:  [105.57681125]
mat_Sqrt:  [[0.15]]
grads:  [0.10297871]
Stock Position:  0.10297871070022288
Bond Position:  [-26.89479786]


portfolio before change:  [-15.92942502]
curr_Stock_Price:  106.49826309758367
curr_Factors:  [106.4982631]
mat_Sqrt:  [[0.15]]
grads:  [-0.04772439]
Stock Position:  -0.04772439487318676
Bond Position:  [-10.84685985]


portfolio before change:  [-15.9425979]
curr_Stock_Price:  106.7600774173436
curr_Factors:  [106.76007742]
mat_Sqrt:  [[0.15]]
grads:  [-0.3963318]
Stock Position:  -0.3963318020074996
Bond Position:  [26.36981597]


portfolio before change:  [-15.99202543]
curr_Stock_Price:  106.8889484813142
curr_Factors:  [106.88894848]
mat_Sqrt:  [[0.15]]
grads:  [-0.12815221]
Stock Position:  -0.12815221276936634
Bond Position:  [-2.29397016]


portfolio before change:  [-15.9727846]
curr_Stock_Price:  106.73768925341015
curr_Factors:  [106.73768925]
mat_Sqrt:  [[0.15]]
grads:  [-0.01497122]
Stock Position:  -0.014971223183662175
Bond Position:  [-14.37479084]


portfolio before change:  [-15.98757795]
curr_Stock_Price:  107.66579605173962
curr_Factors:  [107.66579605]
mat_Sqrt:  [[0.15]]
grads:  [-0.03331369]
Stock Position:  -0.033313691539031715
Bond Position:  [-12.40083283]


portfolio before change:  [-15.99443754]
curr_Stock_Price:  107.84843907938483
curr_Factors:  [107.84843908]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565577]
Stock Position:  -0.0856557687719909
Bond Position:  [-6.75659658]


portfolio before change:  [-15.97921349]
curr_Stock_Price:  107.66577362538932
curr_Factors:  [107.66577363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00372366]
Stock Position:  -0.0037236591338382584
Bond Position:  [-15.57830285]


portfolio before change:  [-15.98305668]
curr_Stock_Price:  108.43638977945635
curr_Factors:  [108.43638978]
mat_Sqrt:  [[0.15]]
grads:  [-0.01927648]
Stock Position:  -0.019276479318167245
Bond Position:  [-13.89278485]


portfolio before change:  [-15.97793203]
curr_Stock_Price:  108.12549401473194
curr_Factors:  [108.12549401]
mat_Sqrt:  [[0.15]]
grads:  [-0.05124308]
Stock Position:  -0.05124307598326414
Bond Position:  [-10.43724912]


portfolio before change:  [-15.9511747]
curr_Stock_Price:  107.59059885262447
curr_Factors:  [107.59059885]
mat_Sqrt:  [[0.15]]
grads:  [-0.02794337]
Stock Position:  -0.02794336954073157
Bond Position:  [-12.94473084]


portfolio before change:  [-15.93512464]
curr_Stock_Price:  106.98726666170893
curr_Factors:  [106.98726666]
mat_Sqrt:  [[0.15]]
grads:  [-0.11721343]
Stock Position:  -0.11721343221174893
Bond Position:  [-3.39477991]


portfolio before change:  [-15.96288917]
curr_Stock_Price:  107.2223280428132
curr_Factors:  [107.22232804]
mat_Sqrt:  [[0.15]]
grads:  [-0.00051247]
Stock Position:  -0.0005124738038066617
Bond Position:  [-15.90794054]


portfolio before change:  [-15.96394387]
curr_Stock_Price:  107.34022652892193
curr_Factors:  [107.34022653]
mat_Sqrt:  [[0.15]]
grads:  [-0.01693174]
Stock Position:  -0.016931741603958113
Bond Position:  [-14.14648689]


portfolio before change:  [-15.94799486]
curr_Stock_Price:  106.34604724973762
curr_Factors:  [106.34604725]
mat_Sqrt:  [[0.15]]
grads:  [0.14669414]
Stock Position:  0.14669413554291905
Bond Position:  [-31.54833633]


portfolio before change:  [-15.87760486]
curr_Stock_Price:  106.83933102441316
curr_Factors:  [106.83933102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00262807]
Stock Position:  -0.002628066054123866
Bond Position:  [-15.59682404]


portfolio before change:  [-15.87812033]
curr_Stock_Price:  106.66454192183076
curr_Factors:  [106.66454192]
mat_Sqrt:  [[0.15]]
grads:  [0.1137732]
Stock Position:  0.11377320014885256
Bond Position:  [-28.01368661]


portfolio before change:  [-15.92416647]
curr_Stock_Price:  106.27521279531886
curr_Factors:  [106.2752128]
mat_Sqrt:  [[0.15]]
grads:  [0.05379819]
Stock Position:  0.05379819256660747
Bond Position:  [-21.64158083]


portfolio before change:  [-15.86523413]
curr_Stock_Price:  107.39578896012596
curr_Factors:  [107.39578896]
mat_Sqrt:  [[0.15]]
grads:  [0.07665011]
Stock Position:  0.07665011115826129
Bond Position:  [-24.0971333]


portfolio before change:  [-15.84681863]
curr_Stock_Price:  107.65569235940305
curr_Factors:  [107.65569236]
mat_Sqrt:  [[0.15]]
grads:  [0.04704241]
Stock Position:  0.04704241262889627
Bond Position:  [-20.91120213]


portfolio before change:  [-15.83838381]
curr_Stock_Price:  107.86277796144292
curr_Factors:  [107.86277796]
mat_Sqrt:  [[0.15]]
grads:  [-0.09720098]
Stock Position:  -0.0972009828811732
Bond Position:  [-5.35401578]


portfolio before change:  [-15.77697215]
curr_Stock_Price:  107.22753436966264
curr_Factors:  [107.22753437]
mat_Sqrt:  [[0.15]]
grads:  [-0.25691544]
Stock Position:  -0.2569154438135837
Bond Position:  [11.77143743]


portfolio before change:  [-15.39320699]
curr_Stock_Price:  105.7366570238675
curr_Factors:  [105.73665702]
mat_Sqrt:  [[0.15]]
grads:  [0.00492267]
Stock Position:  0.00492266672179306
Bond Position:  [-15.91371332]


portfolio before change:  [-15.39372864]
curr_Stock_Price:  105.83274229136812
curr_Factors:  [105.83274229]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774742]
Stock Position:  -0.017747418068317068
Bond Position:  [-13.51547071]


portfolio before change:  [-15.37739378]
curr_Stock_Price:  104.86473668926365
curr_Factors:  [104.86473669]
mat_Sqrt:  [[0.15]]
grads:  [-0.13766954]
Stock Position:  -0.13766953826001355
Bond Position:  [-0.9407139]


portfolio before change:  [-15.47367959]
curr_Stock_Price:  105.56370766260702
curr_Factors:  [105.56370766]
mat_Sqrt:  [[0.15]]
grads:  [-0.03040194]
Stock Position:  -0.030401936802285947
Bond Position:  [-12.26433842]


portfolio before change:  [-15.470972]
curr_Stock_Price:  105.44943440327661
curr_Factors:  [105.4494344]
mat_Sqrt:  [[0.15]]
grads:  [0.08996892]
Stock Position:  0.08996891855638968
Bond Position:  [-24.95814358]


portfolio before change:  [-15.38076645]
curr_Stock_Price:  106.46940320400475
curr_Factors:  [106.4694032]
mat_Sqrt:  [[0.15]]
grads:  [0.20563617]
Stock Position:  0.2056361744781099
Bond Position:  [-37.27472722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.27757471]
Stock Price:  106.98254969021893
PL:  [-22.2601244]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.27189240e-02]
 [ 3.80268122e-03]
 [ 6.06815152e-03]
 [-9.34211099e-03]
 [ 1.19105128e-02]
 [-4.12002414e-03]
 [-9.72895240e-03]
 [-3.31359713e-02]
 [ 1.64669264e-02]
 [-2.38420067e-03]
 [-9.24371526e-03]
 [ 1.85906341e-02]
 [-4.11062543e-03]
 [ 3.95956845e-03]
 [ 3.91655902e-03]
 [ 1.46186300e-02]
 [ 8.03406818e-02]
 [-1.25842260e-02]
 [ 2.19805073e-02]
 [ 9.82873262e-04]
 [-4.99857213e-03]
 [ 4.58299227e-03]
 [ 9.68707368e-03]
 [ 3.24525644e-02]
 [ 1.64885913e-03]
 [ 8.31173299e-03]
 [ 1.81988530e-02]
 [ 1.87605337e-02]
 [ 2.36768742e-02]
 [-8.32888810e-03]
 [ 1.45952750e-04]
 [ 1.48631265e-02]
 [ 1.59253635e-02]
 [-9.55676796e-03]
 [ 4.03784055e-03]
 [-1.38059588e-02]
 [-9.62160614e-03]
 [-1.35480074e-02]
 [-6.40492690e-03]
 [-5.59082708e-02]
 [ 3.36665501e-03]
 [ 1.40602598e-03]
 [-1.45646410e-02]
 [ 1.78069611e-02]
 [-8.97321287e-03]
 [ 1.17859882e-02]
 [ 1.05342223e-02]
 [-3.12236808e-03]
 [ 1.43809058e-02]
 [-1.40970026e-03]
 [ 2.06072185e-02]
 [ 8.88986164e-03]
 [-4.10302430e-03]
 [-3.37892422e-02]
 [-1.15679877e-02]
 [-2.60888835e-03]
 [ 3.59898422e-03]
 [-1.59818847e-02]
 [ 2.07956665e-03]
 [-3.21707795e-03]
 [-7.26437871e-03]
 [ 5.09453402e-04]
 [-1.89289560e-02]
 [ 4.50220297e-04]
 [ 2.02875091e-03]
 [ 2.05464830e-02]
 [ 2.05762698e-03]
 [ 1.89672751e-02]
 [ 8.81956962e-03]
 [ 1.16985273e-02]
 [ 8.01158753e-03]
 [-1.45715336e-02]
 [-4.76950831e-02]
 [ 5.47251782e-04]
 [-8.58023380e-03]
 [-2.83874540e-02]
 [-5.99473040e-03]
 [ 1.95164938e-02]
 [ 5.50131175e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.0895129]
curr_Stock_Price:  99.35872467734748
curr_Factors:  [99.35872468]
mat_Sqrt:  [[0.15]]
grads:  [-0.08479283]
Stock Position:  -0.08479282684431332
Bond Position:  [-3.66460576]


portfolio before change:  [-12.12021834]
curr_Stock_Price:  99.71814654597162
curr_Factors:  [99.71814655]
mat_Sqrt:  [[0.15]]
grads:  [0.02535121]
Stock Position:  0.025351208142624163
Bond Position:  [-14.64819383]


portfolio before change:  [-12.12486238]
curr_Stock_Price:  99.57107275964691
curr_Factors:  [99.57107276]
mat_Sqrt:  [[0.15]]
grads:  [0.04045434]
Stock Position:  0.040454343449468126
Bond Position:  [-16.15294475]


portfolio before change:  [-12.1361728]
curr_Stock_Price:  99.31644416086047
curr_Factors:  [99.31644416]
mat_Sqrt:  [[0.15]]
grads:  [-0.06228074]
Stock Position:  -0.062280739964751426
Bond Position:  [-5.95067117]


portfolio before change:  [-12.12985733]
curr_Stock_Price:  99.20906911379802
curr_Factors:  [99.20906911]
mat_Sqrt:  [[0.15]]
grads:  [0.07940342]
Stock Position:  0.079403418347099
Bond Position:  [-20.00739655]


portfolio before change:  [-12.0489623]
curr_Stock_Price:  100.2436029987962
curr_Factors:  [100.243603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02746683]
Stock Position:  -0.027466827571026965
Bond Position:  [-9.29558855]


portfolio before change:  [-12.07070901]
curr_Stock_Price:  101.01419479320614
curr_Factors:  [101.01419479]
mat_Sqrt:  [[0.15]]
grads:  [-0.06485968]
Stock Position:  -0.06485968267723048
Bond Position:  [-5.51896039]


portfolio before change:  [-12.09026046]
curr_Stock_Price:  101.3103187031773
curr_Factors:  [101.3103187]
mat_Sqrt:  [[0.15]]
grads:  [-0.22090648]
Stock Position:  -0.2209064754450768
Bond Position:  [10.28984497]


portfolio before change:  [-12.1766176]
curr_Stock_Price:  101.70415177363721
curr_Factors:  [101.70415177]
mat_Sqrt:  [[0.15]]
grads:  [0.10977951]
Stock Position:  0.10977950955885825
Bond Position:  [-23.3416495]


portfolio before change:  [-12.23076906]
curr_Stock_Price:  101.22416635754901
curr_Factors:  [101.22416636]
mat_Sqrt:  [[0.15]]
grads:  [-0.01589467]
Stock Position:  -0.015894671106467216
Bond Position:  [-10.62184423]


portfolio before change:  [-12.23710495]
curr_Stock_Price:  101.5810155718138
curr_Factors:  [101.58101557]
mat_Sqrt:  [[0.15]]
grads:  [-0.06162477]
Stock Position:  -0.061624768396358054
Bond Position:  [-5.97719839]


portfolio before change:  [-12.27713364]
curr_Stock_Price:  102.22450859435496
curr_Factors:  [102.22450859]
mat_Sqrt:  [[0.15]]
grads:  [0.12393756]
Stock Position:  0.12393756054893221
Bond Position:  [-24.94658987]


portfolio before change:  [-12.29915674]
curr_Stock_Price:  102.05939413983516
curr_Factors:  [102.05939414]
mat_Sqrt:  [[0.15]]
grads:  [-0.02740417]
Stock Position:  -0.027404169508197067
Bond Position:  [-9.5023038]


portfolio before change:  [-12.29168408]
curr_Stock_Price:  101.76503858593152
curr_Factors:  [101.76503859]
mat_Sqrt:  [[0.15]]
grads:  [0.02639712]
Stock Position:  0.026397123026204578
Bond Position:  [-14.97798832]


portfolio before change:  [-12.28747633]
curr_Stock_Price:  101.9599044700167
curr_Factors:  [101.95990447]
mat_Sqrt:  [[0.15]]
grads:  [0.02611039]
Stock Position:  0.026110393478122874
Bond Position:  [-14.94968956]


portfolio before change:  [-12.2999259]
curr_Stock_Price:  101.51888532106555
curr_Factors:  [101.51888532]
mat_Sqrt:  [[0.15]]
grads:  [0.09745753]
Stock Position:  0.09745753319140647
Bond Position:  [-22.19370604]


portfolio before change:  [-12.28108757]
curr_Stock_Price:  101.72641654122839
curr_Factors:  [101.72641654]
mat_Sqrt:  [[0.15]]
grads:  [0.53560455]
Stock Position:  0.5356045451674842
Bond Position:  [-66.76621863]


portfolio before change:  [-12.14234796]
curr_Stock_Price:  101.99324143418742
curr_Factors:  [101.99324143]
mat_Sqrt:  [[0.15]]
grads:  [-0.08389484]
Stock Position:  -0.08389484019912381
Bond Position:  [-3.58564127]


portfolio before change:  [-12.17442689]
curr_Stock_Price:  102.37294076683976
curr_Factors:  [102.37294077]
mat_Sqrt:  [[0.15]]
grads:  [0.14653672]
Stock Position:  0.1465367151777637
Bond Position:  [-27.17582135]


portfolio before change:  [-12.19158435]
curr_Stock_Price:  102.26744554760312
curr_Factors:  [102.26744555]
mat_Sqrt:  [[0.15]]
grads:  [0.00655249]
Stock Position:  0.006552488413304391
Bond Position:  [-12.86169061]


portfolio before change:  [-12.19426669]
curr_Stock_Price:  101.98076740618788
curr_Factors:  [101.98076741]
mat_Sqrt:  [[0.15]]
grads:  [-0.03332381]
Stock Position:  -0.033323814231740884
Bond Position:  [-8.79587854]


portfolio before change:  [-12.17796257]
curr_Stock_Price:  101.47500651947378
curr_Factors:  [101.47500652]
mat_Sqrt:  [[0.15]]
grads:  [0.03055328]
Stock Position:  0.030553281766903494
Bond Position:  [-15.27835703]


portfolio before change:  [-12.15975221]
curr_Stock_Price:  102.10228056207364
curr_Factors:  [102.10228056]
mat_Sqrt:  [[0.15]]
grads:  [0.06458049]
Stock Position:  0.0645804912067255
Bond Position:  [-18.75356765]


portfolio before change:  [-12.14606038]
curr_Stock_Price:  102.33244239680111
curr_Factors:  [102.3324424]
mat_Sqrt:  [[0.15]]
grads:  [0.21635043]
Stock Position:  0.21635042931307932
Bond Position:  [-34.28572823]


portfolio before change:  [-12.09633773]
curr_Stock_Price:  102.5721719007995
curr_Factors:  [102.5721719]
mat_Sqrt:  [[0.15]]
grads:  [0.01099239]
Stock Position:  0.01099239420055793
Bond Position:  [-13.22385148]


portfolio before change:  [-12.0974671]
curr_Stock_Price:  102.54462007240481
curr_Factors:  [102.54462007]
mat_Sqrt:  [[0.15]]
grads:  [0.05541155]
Stock Position:  0.05541155328705072
Bond Position:  [-17.77962378]


portfolio before change:  [-12.08494908]
curr_Stock_Price:  102.7905847467342
curr_Factors:  [102.79058475]
mat_Sqrt:  [[0.15]]
grads:  [0.12132569]
Stock Position:  0.12132568653207804
Bond Position:  [-24.55608734]


portfolio before change:  [-12.10592339]
curr_Stock_Price:  102.63035892246961
curr_Factors:  [102.63035892]
mat_Sqrt:  [[0.15]]
grads:  [0.12507022]
Stock Position:  0.12507022465134007
Bond Position:  [-24.94192544]


portfolio before change:  [-12.12922391]
curr_Stock_Price:  102.45652383136239
curr_Factors:  [102.45652383]
mat_Sqrt:  [[0.15]]
grads:  [0.15784583]
Stock Position:  0.15784582812098585
Bond Position:  [-28.30155876]


portfolio before change:  [-12.11783557]
curr_Stock_Price:  102.53987883597173
curr_Factors:  [102.53987884]
mat_Sqrt:  [[0.15]]
grads:  [-0.05552592]
Stock Position:  -0.05552592068651133
Bond Position:  [-6.42421439]


portfolio before change:  [-12.13657346]
curr_Stock_Price:  102.87010950311834
curr_Factors:  [102.8701095]
mat_Sqrt:  [[0.15]]
grads:  [0.00097302]
Stock Position:  0.0009730183310889309
Bond Position:  [-12.23666796]


portfolio before change:  [-12.13640291]
curr_Stock_Price:  103.83141137505723
curr_Factors:  [103.83141138]
mat_Sqrt:  [[0.15]]
grads:  [0.09908751]
Stock Position:  0.09908750971664533
Bond Position:  [-22.42479889]


portfolio before change:  [-12.0508103]
curr_Stock_Price:  104.7093646215761
curr_Factors:  [104.70936462]
mat_Sqrt:  [[0.15]]
grads:  [0.10616909]
Stock Position:  0.10616909018169417
Bond Position:  [-23.16770828]


portfolio before change:  [-12.01999122]
curr_Stock_Price:  105.01328648932711
curr_Factors:  [105.01328649]
mat_Sqrt:  [[0.15]]
grads:  [-0.06371179]
Stock Position:  -0.06371178641478827
Bond Position:  [-5.32940714]


portfolio before change:  [-12.03403818]
curr_Stock_Price:  105.22853488283405
curr_Factors:  [105.22853488]
mat_Sqrt:  [[0.15]]
grads:  [0.02691894]
Stock Position:  0.026918936997790573
Bond Position:  [-14.86667848]


portfolio before change:  [-12.03497665]
curr_Stock_Price:  105.22819020656058
curr_Factors:  [105.22819021]
mat_Sqrt:  [[0.15]]
grads:  [-0.09203973]
Stock Position:  -0.09203972514729374
Bond Position:  [-2.34980295]


portfolio before change:  [-12.00085632]
curr_Stock_Price:  104.85588140805544
curr_Factors:  [104.85588141]
mat_Sqrt:  [[0.15]]
grads:  [-0.06414404]
Stock Position:  -0.06414404096529772
Bond Position:  [-5.27497637]


portfolio before change:  [-11.99288618]
curr_Stock_Price:  104.72648768352337
curr_Factors:  [104.72648768]
mat_Sqrt:  [[0.15]]
grads:  [-0.09032005]
Stock Position:  -0.09032004939946567
Bond Position:  [-2.53398464]


portfolio before change:  [-11.95275382]
curr_Stock_Price:  104.2803991642722
curr_Factors:  [104.28039916]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269951]
Stock Position:  -0.04269951266263888
Bond Position:  [-7.5000316]


portfolio before change:  [-12.00620849]
curr_Stock_Price:  105.5213010075207
curr_Factors:  [105.52130101]
mat_Sqrt:  [[0.15]]
grads:  [-0.37272181]
Stock Position:  -0.37272180538263083
Bond Position:  [27.32388133]


portfolio before change:  [-11.92851668]
curr_Stock_Price:  105.31743846775088
curr_Factors:  [105.31743847]
mat_Sqrt:  [[0.15]]
grads:  [0.02244437]
Stock Position:  0.022444366755330118
Bond Position:  [-14.2922999]


portfolio before change:  [-11.92789764]
curr_Stock_Price:  105.38482036882654
curr_Factors:  [105.38482037]
mat_Sqrt:  [[0.15]]
grads:  [0.00937351]
Stock Position:  0.009373506519833041
Bond Position:  [-12.91572294]


portfolio before change:  [-11.93154404]
curr_Stock_Price:  105.08193033729438
curr_Factors:  [105.08193034]
mat_Sqrt:  [[0.15]]
grads:  [-0.09709761]
Stock Position:  -0.09709760663030001
Bond Position:  [-1.7283401]


portfolio before change:  [-12.00256998]
curr_Stock_Price:  105.81230794848528
curr_Factors:  [105.81230795]
mat_Sqrt:  [[0.15]]
grads:  [0.11871307]
Stock Position:  0.11871307429217567
Bond Position:  [-24.56387435]


portfolio before change:  [-11.93477249]
curr_Stock_Price:  106.39634451158736
curr_Factors:  [106.39634451]
mat_Sqrt:  [[0.15]]
grads:  [-0.05982142]
Stock Position:  -0.05982141915063311
Bond Position:  [-5.56999217]


portfolio before change:  [-11.95242756]
curr_Stock_Price:  106.68565447404443
curr_Factors:  [106.68565447]
mat_Sqrt:  [[0.15]]
grads:  [0.07857325]
Stock Position:  0.07857325477704213
Bond Position:  [-20.33506667]


portfolio before change:  [-12.0253699]
curr_Stock_Price:  105.7734947685027
curr_Factors:  [105.77349477]
mat_Sqrt:  [[0.15]]
grads:  [0.07022815]
Stock Position:  0.07022814868814907
Bond Position:  [-19.45364662]


portfolio before change:  [-12.02230088]
curr_Stock_Price:  105.83450893540929
curr_Factors:  [105.83450894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02081579]
Stock Position:  -0.02081578718769285
Bond Position:  [-9.81927226]


portfolio before change:  [-12.02629979]
curr_Stock_Price:  105.99713512190279
curr_Factors:  [105.99713512]
mat_Sqrt:  [[0.15]]
grads:  [0.09587271]
Stock Position:  0.09587270528481312
Bond Position:  [-22.18853189]


portfolio before change:  [-12.13489122]
curr_Stock_Price:  104.87893778074807
curr_Factors:  [104.87893778]
mat_Sqrt:  [[0.15]]
grads:  [-0.009398]
Stock Position:  -0.009398001726655322
Bond Position:  [-11.14923879]


portfolio before change:  [-12.13575189]
curr_Stock_Price:  104.89636841265073
curr_Factors:  [104.89636841]
mat_Sqrt:  [[0.15]]
grads:  [0.13738146]
Stock Position:  0.13738145681355082
Bond Position:  [-26.54656779]


portfolio before change:  [-12.18550484]
curr_Stock_Price:  104.54629391273976
curr_Factors:  [104.54629391]
mat_Sqrt:  [[0.15]]
grads:  [0.05926574]
Stock Position:  0.05926574426902639
Bond Position:  [-18.38151876]


portfolio before change:  [-12.17292357]
curr_Stock_Price:  104.77796490639545
curr_Factors:  [104.77796491]
mat_Sqrt:  [[0.15]]
grads:  [-0.0273535]
Stock Position:  -0.027353495307414037
Bond Position:  [-9.30688]


portfolio before change:  [-12.17232836]
curr_Stock_Price:  104.73493886871996
curr_Factors:  [104.73493887]
mat_Sqrt:  [[0.15]]
grads:  [-0.22526161]
Stock Position:  -0.22526161487071789
Bond Position:  [11.42043311]


portfolio before change:  [-12.29401675]
curr_Stock_Price:  105.27831682842721
curr_Factors:  [105.27831683]
mat_Sqrt:  [[0.15]]
grads:  [-0.07711992]
Stock Position:  -0.07711991817415391
Bond Position:  [-4.17496157]


portfolio before change:  [-12.27874039]
curr_Stock_Price:  105.07684738966158
curr_Factors:  [105.07684739]
mat_Sqrt:  [[0.15]]
grads:  [-0.01739259]
Stock Position:  -0.017392588969786547
Bond Position:  [-10.45118197]


portfolio before change:  [-12.28395048]
curr_Stock_Price:  105.33884798198025
curr_Factors:  [105.33884798]
mat_Sqrt:  [[0.15]]
grads:  [0.02399323]
Stock Position:  0.023993228119237334
Bond Position:  [-14.81136949]


portfolio before change:  [-12.27203404]
curr_Stock_Price:  105.87408975995493
curr_Factors:  [105.87408976]
mat_Sqrt:  [[0.15]]
grads:  [-0.1065459]
Stock Position:  -0.10654589818712391
Bond Position:  [-0.99158405]


portfolio before change:  [-12.23378777]
curr_Stock_Price:  105.51454292379722
curr_Factors:  [105.51454292]
mat_Sqrt:  [[0.15]]
grads:  [0.01386378]
Stock Position:  0.013863777633594504
Bond Position:  [-13.69661793]


portfolio before change:  [-12.23874564]
curr_Stock_Price:  105.21867859379604
curr_Factors:  [105.21867859]
mat_Sqrt:  [[0.15]]
grads:  [-0.02144719]
Stock Position:  -0.021447186351852193
Bond Position:  [-9.98210103]


portfolio before change:  [-12.26413382]
curr_Stock_Price:  106.37334195159673
curr_Factors:  [106.37334195]
mat_Sqrt:  [[0.15]]
grads:  [-0.04842919]
Stock Position:  -0.04842919137521476
Bond Position:  [-7.11255888]


portfolio before change:  [-12.23677462]
curr_Stock_Price:  105.79923055371262
curr_Factors:  [105.79923055]
mat_Sqrt:  [[0.15]]
grads:  [0.00339636]
Stock Position:  0.0033963560134091706
Bond Position:  [-12.59610647]


portfolio before change:  [-12.23923725]
curr_Stock_Price:  105.30595048675441
curr_Factors:  [105.30595049]
mat_Sqrt:  [[0.15]]
grads:  [-0.12619304]
Stock Position:  -0.12619303989222588
Bond Position:  [1.04964076]


portfolio before change:  [-12.2647989]
curr_Stock_Price:  105.50903022845196
curr_Factors:  [105.50903023]
mat_Sqrt:  [[0.15]]
grads:  [0.00300147]
Stock Position:  0.0030014686445322624
Bond Position:  [-12.58148094]


portfolio before change:  [-12.26240399]
curr_Stock_Price:  106.56893568460346
curr_Factors:  [106.56893568]
mat_Sqrt:  [[0.15]]
grads:  [0.01352501]
Stock Position:  0.01352500608014201
Bond Position:  [-13.70374949]


portfolio before change:  [-12.27124836]
curr_Stock_Price:  105.97833665586259
curr_Factors:  [105.97833666]
mat_Sqrt:  [[0.15]]
grads:  [0.13697655]
Stock Position:  0.136976553482966
Bond Position:  [-26.78779566]


portfolio before change:  [-12.28477476]
curr_Stock_Price:  105.89181008423702
curr_Factors:  [105.89181008]
mat_Sqrt:  [[0.15]]
grads:  [0.01371751]
Stock Position:  0.013717513215757409
Bond Position:  [-13.73734706]


portfolio before change:  [-12.26473201]
curr_Stock_Price:  107.41550911533365
curr_Factors:  [107.41550912]
mat_Sqrt:  [[0.15]]
grads:  [0.1264485]
Stock Position:  0.126448500459942
Bond Position:  [-25.84726206]


portfolio before change:  [-12.21844946]
curr_Stock_Price:  107.79430409196009
curr_Factors:  [107.79430409]
mat_Sqrt:  [[0.15]]
grads:  [0.05879713]
Stock Position:  0.05879713082614503
Bond Position:  [-18.55644526]


portfolio before change:  [-12.17987042]
curr_Stock_Price:  108.47016790731142
curr_Factors:  [108.47016791]
mat_Sqrt:  [[0.15]]
grads:  [0.07799018]
Stock Position:  0.07799018211415507
Bond Position:  [-20.63947857]


portfolio before change:  [-12.1878148]
curr_Stock_Price:  108.38484463531377
curr_Factors:  [108.38484464]
mat_Sqrt:  [[0.15]]
grads:  [0.05341058]
Stock Position:  0.05341058353427611
Bond Position:  [-17.9767126]


portfolio before change:  [-12.21407185]
curr_Stock_Price:  107.91427365950369
curr_Factors:  [107.91427366]
mat_Sqrt:  [[0.15]]
grads:  [-0.09714356]
Stock Position:  -0.09714355760318336
Bond Position:  [-1.73089539]


portfolio before change:  [-12.24189838]
curr_Stock_Price:  108.19960748463414
curr_Factors:  [108.19960748]
mat_Sqrt:  [[0.15]]
grads:  [-0.31796722]
Stock Position:  -0.3179672209882458
Bond Position:  [22.16203012]


portfolio before change:  [-12.15233891]
curr_Stock_Price:  107.92230123508514
curr_Factors:  [107.92230124]
mat_Sqrt:  [[0.15]]
grads:  [0.00364835]
Stock Position:  0.003648345214851481
Bond Position:  [-12.54607672]


portfolio before change:  [-12.15349912]
curr_Stock_Price:  107.81922626237889
curr_Factors:  [107.81922626]
mat_Sqrt:  [[0.15]]
grads:  [-0.05720156]
Stock Position:  -0.057201558635608135
Bond Position:  [-5.98607133]


portfolio before change:  [-12.18484387]
curr_Stock_Price:  108.36065576896678
curr_Factors:  [108.36065577]
mat_Sqrt:  [[0.15]]
grads:  [-0.18924969]
Stock Position:  -0.18924969307551787
Bond Position:  [8.32237697]


portfolio before change:  [-12.13914999]
curr_Stock_Price:  108.12195676327663
curr_Factors:  [108.12195676]
mat_Sqrt:  [[0.15]]
grads:  [-0.03996487]
Stock Position:  -0.03996486930361985
Bond Position:  [-7.81807012]


portfolio before change:  [-12.12602521]
curr_Stock_Price:  107.78132195075086
curr_Factors:  [107.78132195]
mat_Sqrt:  [[0.15]]
grads:  [0.13010996]
Stock Position:  0.13010995875206724
Bond Position:  [-26.14944857]


portfolio before change:  [-12.11830005]
curr_Stock_Price:  107.85325765415489
curr_Factors:  [107.85325765]
mat_Sqrt:  [[0.15]]
grads:  [0.36675412]
Stock Position:  0.36675411642974465
Bond Position:  [-51.67392627]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.3390562]
Stock Price:  107.26014521516822
PL:  [-19.59920142]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38848169e-02]
 [ 2.49924302e-03]
 [ 6.19170354e-03]
 [-8.87499045e-03]
 [ 9.90746251e-03]
 [-1.66289178e-03]
 [-7.91143397e-03]
 [-8.93948928e-03]
 [ 5.66234514e-03]
 [ 1.62571688e-03]
 [ 1.18741303e-02]
 [ 2.84102792e-03]
 [-2.87047248e-03]
 [ 5.73773100e-03]
 [-1.53597838e-03]
 [ 1.28829590e-02]
 [ 3.53594217e-02]
 [-1.46188772e-02]
 [ 1.85589174e-02]
 [ 2.19083277e-03]
 [-4.37566742e-03]
 [ 4.57126645e-03]
 [ 1.41403715e-02]
 [ 3.05272977e-02]
 [-1.63701117e-04]
 [ 8.41302680e-03]
 [ 1.15807443e-02]
 [ 1.67696624e-02]
 [ 2.69471296e-02]
 [-1.46498826e-03]
 [-2.28027864e-03]
 [ 1.36054956e-02]
 [ 1.30920491e-02]
 [ 4.87688853e-04]
 [ 4.77583931e-03]
 [ 6.85222267e-03]
 [-2.55510748e-02]
 [-1.92882437e-03]
 [-2.93795200e-02]
 [-9.32326324e-03]
 [ 4.36263408e-03]
 [ 8.20518203e-03]
 [-6.12650232e-03]
 [-2.13564296e-03]
 [ 1.17659632e-02]
 [ 1.33193959e-02]
 [ 1.07298201e-02]
 [ 3.95152619e-03]
 [ 9.59924840e-03]
 [-2.30349776e-03]
 [-5.42486582e-03]
 [-1.70378680e-03]
 [ 1.66502550e-03]
 [ 5.61028386e-03]
 [-7.21941039e-03]
 [-4.45090464e-03]
 [-7.13470362e-04]
 [ 9.86713791e-03]
 [ 7.42650487e-03]
 [-3.91837968e-03]
 [-4.93369419e-03]
 [ 5.91998622e-04]
 [-5.91674541e-03]
 [ 5.53911967e-04]
 [ 1.93553694e-02]
 [ 3.88588379e-03]
 [ 1.12563469e-02]
 [-5.23228808e-04]
 [ 2.98047450e-03]
 [ 2.31249197e-02]
 [ 3.34480434e-03]
 [-1.58554371e-02]
 [-5.32221167e-03]
 [ 1.54710863e-03]
 [ 6.45526333e-03]
 [-5.53288328e-04]
 [-1.98318840e-03]
 [ 1.09967677e-02]
 [-1.47017980e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.25287523]
curr_Stock_Price:  99.85090255262868
curr_Factors:  [99.85090255]
mat_Sqrt:  [[0.15]]
grads:  [-0.09256545]
Stock Position:  -0.09256544592703397
Bond Position:  [7.98986809]


portfolio before change:  [-1.23624834]
curr_Stock_Price:  99.67667438021745
curr_Factors:  [99.67667438]
mat_Sqrt:  [[0.15]]
grads:  [0.01666162]
Stock Position:  0.016661620120947476
Bond Position:  [-2.89702322]


portfolio before change:  [-1.23839666]
curr_Stock_Price:  99.5586036087355
curr_Factors:  [99.55860361]
mat_Sqrt:  [[0.15]]
grads:  [0.04127802]
Stock Position:  0.041278023588869825
Bond Position:  [-5.34797905]


portfolio before change:  [-1.23198815]
curr_Stock_Price:  99.72195370797851
curr_Factors:  [99.72195371]
mat_Sqrt:  [[0.15]]
grads:  [-0.0591666]
Stock Position:  -0.059166602970567334
Bond Position:  [4.66822109]


portfolio before change:  [-1.26632557]
curr_Stock_Price:  100.30723638567603
curr_Factors:  [100.30723639]
mat_Sqrt:  [[0.15]]
grads:  [0.06604975]
Stock Position:  0.06604975005467735
Bond Position:  [-7.89159346]


portfolio before change:  [-1.24029526]
curr_Stock_Price:  100.70880555118805
curr_Factors:  [100.70880555]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108595]
Stock Position:  -0.011085945188147855
Bond Position:  [-0.12384296]


portfolio before change:  [-1.24081659]
curr_Stock_Price:  100.7551335253301
curr_Factors:  [100.75513353]
mat_Sqrt:  [[0.15]]
grads:  [-0.05274289]
Stock Position:  -0.052742893130527546
Bond Position:  [4.07330065]


portfolio before change:  [-1.20800597]
curr_Stock_Price:  100.13787436952205
curr_Factors:  [100.13787437]
mat_Sqrt:  [[0.15]]
grads:  [-0.0595966]
Stock Position:  -0.05959659516700247
Bond Position:  [4.75987039]


portfolio before change:  [-1.23877597]
curr_Stock_Price:  100.65917101708241
curr_Factors:  [100.65917102]
mat_Sqrt:  [[0.15]]
grads:  [0.03774897]
Stock Position:  0.037748967580099164
Bond Position:  [-5.03855576]


portfolio before change:  [-1.24374862]
curr_Stock_Price:  100.5357840507216
curr_Factors:  [100.53578405]
mat_Sqrt:  [[0.15]]
grads:  [0.01083811]
Stock Position:  0.010838112500009569
Bond Position:  [-2.33336676]


portfolio before change:  [-1.24840542]
curr_Stock_Price:  100.11957168470423
curr_Factors:  [100.11957168]
mat_Sqrt:  [[0.15]]
grads:  [0.07916087]
Stock Position:  0.07916086842829972
Bond Position:  [-9.17395766]


portfolio before change:  [-1.19890402]
curr_Stock_Price:  100.75214175154734
curr_Factors:  [100.75214175]
mat_Sqrt:  [[0.15]]
grads:  [0.01894019]
Stock Position:  0.01894018615707463
Bond Position:  [-3.10716834]


portfolio before change:  [-1.20133369]
curr_Stock_Price:  100.63411373523945
curr_Factors:  [100.63411374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01913648]
Stock Position:  -0.01913648319149084
Bond Position:  [0.72444933]


portfolio before change:  [-1.21011231]
curr_Stock_Price:  101.09521727617795
curr_Factors:  [101.09521728]
mat_Sqrt:  [[0.15]]
grads:  [0.03825154]
Stock Position:  0.03825153998851735
Bond Position:  [-5.07716006]


portfolio before change:  [-1.24614053]
curr_Stock_Price:  100.1616369089946
curr_Factors:  [100.16163691]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023986]
Stock Position:  -0.010239855887490176
Bond Position:  [-0.2204998]


portfolio before change:  [-1.243536]
curr_Stock_Price:  99.90593816367019
curr_Factors:  [99.90593816]
mat_Sqrt:  [[0.15]]
grads:  [0.08588639]
Stock Position:  0.08588639340843673
Bond Position:  [-9.8240967]


portfolio before change:  [-1.22250926]
curr_Stock_Price:  100.15790775716819
curr_Factors:  [100.15790776]
mat_Sqrt:  [[0.15]]
grads:  [0.23572948]
Stock Position:  0.2357294779154406
Bond Position:  [-24.83268057]


portfolio before change:  [-1.07519465]
curr_Stock_Price:  100.78942277732075
curr_Factors:  [100.78942278]
mat_Sqrt:  [[0.15]]
grads:  [-0.09745918]
Stock Position:  -0.09745918157214045
Bond Position:  [8.74766001]


portfolio before change:  [-1.05670327]
curr_Stock_Price:  100.6052982495376
curr_Factors:  [100.60529825]
mat_Sqrt:  [[0.15]]
grads:  [0.12372612]
Stock Position:  0.12372611588203415
Bond Position:  [-13.50420606]


portfolio before change:  [-1.05842918]
curr_Stock_Price:  100.59817066596561
curr_Factors:  [100.59817067]
mat_Sqrt:  [[0.15]]
grads:  [0.01460555]
Stock Position:  0.014605551772612323
Bond Position:  [-2.52772097]


portfolio before change:  [-1.06074214]
curr_Stock_Price:  100.4506257224894
curr_Factors:  [100.45062572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02917112]
Stock Position:  -0.02917111610870514
Bond Position:  [1.86951472]


portfolio before change:  [-1.08928356]
curr_Stock_Price:  101.43304500354094
curr_Factors:  [101.433045]
mat_Sqrt:  [[0.15]]
grads:  [0.03047511]
Stock Position:  0.030475109640530403
Bond Position:  [-4.18046673]


portfolio before change:  [-1.09662561]
curr_Stock_Price:  101.20069922475231
curr_Factors:  [101.20069922]
mat_Sqrt:  [[0.15]]
grads:  [0.09426914]
Stock Position:  0.0942691431581083
Bond Position:  [-10.63672882]


portfolio before change:  [-1.00573657]
curr_Stock_Price:  102.17189566446243
curr_Factors:  [102.17189566]
mat_Sqrt:  [[0.15]]
grads:  [0.20351532]
Stock Position:  0.2035153182456776
Bond Position:  [-21.79928244]


portfolio before change:  [-1.03481445]
curr_Stock_Price:  102.03571242584592
curr_Factors:  [102.03571243]
mat_Sqrt:  [[0.15]]
grads:  [-0.00109134]
Stock Position:  -0.0010913407796340226
Bond Position:  [-0.92345871]


portfolio before change:  [-1.03518239]
curr_Stock_Price:  102.31997209035057
curr_Factors:  [102.31997209]
mat_Sqrt:  [[0.15]]
grads:  [0.05608685]
Stock Position:  0.05608684530495476
Bond Position:  [-6.77398683]


portfolio before change:  [-1.02428452]
curr_Stock_Price:  102.52182432222831
curr_Factors:  [102.52182432]
mat_Sqrt:  [[0.15]]
grads:  [0.07720496]
Stock Position:  0.07720496193338876
Bond Position:  [-8.93947807]


portfolio before change:  [-1.04003597]
curr_Stock_Price:  102.32504017489156
curr_Factors:  [102.32504017]
mat_Sqrt:  [[0.15]]
grads:  [0.11179775]
Stock Position:  0.11179774916066185
Bond Position:  [-12.47974514]


portfolio before change:  [-1.06510482]
curr_Stock_Price:  102.10778315398873
curr_Factors:  [102.10778315]
mat_Sqrt:  [[0.15]]
grads:  [0.17964753]
Stock Position:  0.17964753050112975
Bond Position:  [-19.40851591]


portfolio before change:  [-1.15381236]
curr_Stock_Price:  101.62074907619655
curr_Factors:  [101.62074908]
mat_Sqrt:  [[0.15]]
grads:  [-0.00976659]
Stock Position:  -0.009766588388261435
Bond Position:  [-0.16132433]


portfolio before change:  [-1.15832207]
curr_Stock_Price:  102.0814650864414
curr_Factors:  [102.08146509]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520186]
Stock Position:  -0.015201857589556602
Bond Position:  [0.39350583]


portfolio before change:  [-1.15991979]
curr_Stock_Price:  102.18818337096243
curr_Factors:  [102.18818337]
mat_Sqrt:  [[0.15]]
grads:  [0.0907033]
Stock Position:  0.09070330422273232
Bond Position:  [-10.42872567]


portfolio before change:  [-1.18588869]
curr_Stock_Price:  101.9090635724303
curr_Factors:  [101.90906357]
mat_Sqrt:  [[0.15]]
grads:  [0.08728033]
Stock Position:  0.0872803273148143
Bond Position:  [-10.08054512]


portfolio before change:  [-1.13406957]
curr_Stock_Price:  102.50999145626373
curr_Factors:  [102.50999146]
mat_Sqrt:  [[0.15]]
grads:  [0.00325126]
Stock Position:  0.003251259020296618
Bond Position:  [-1.4673561]


portfolio before change:  [-1.13181006]
curr_Stock_Price:  103.23316177906712
curr_Factors:  [103.23316178]
mat_Sqrt:  [[0.15]]
grads:  [0.03183893]
Stock Position:  0.03183892874894194
Bond Position:  [-4.41864335]


portfolio before change:  [-1.14296429]
curr_Stock_Price:  102.8915027666
curr_Factors:  [102.89150277]
mat_Sqrt:  [[0.15]]
grads:  [0.04568148]
Stock Position:  0.045681484459046615
Bond Position:  [-5.84320088]


portfolio before change:  [-1.18516653]
curr_Stock_Price:  101.97566078710064
curr_Factors:  [101.97566079]
mat_Sqrt:  [[0.15]]
grads:  [-0.1703405]
Stock Position:  -0.17034049889552014
Bond Position:  [16.18541841]


portfolio before change:  [-1.2301351]
curr_Stock_Price:  102.2455918573973
curr_Factors:  [102.24559186]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285883]
Stock Position:  -0.012858829100733207
Bond Position:  [0.08462349]


portfolio before change:  [-1.23350553]
curr_Stock_Price:  102.50811328247772
curr_Factors:  [102.50811328]
mat_Sqrt:  [[0.15]]
grads:  [-0.19586347]
Stock Position:  -0.19586346685484124
Bond Position:  [18.84408892]


portfolio before change:  [-1.090939]
curr_Stock_Price:  101.78623933861181
curr_Factors:  [101.78623934]
mat_Sqrt:  [[0.15]]
grads:  [-0.06215509]
Stock Position:  -0.06215508827153839
Bond Position:  [5.23559369]


portfolio before change:  [-1.08100572]
curr_Stock_Price:  101.63168965897418
curr_Factors:  [101.63168966]
mat_Sqrt:  [[0.15]]
grads:  [0.02908423]
Stock Position:  0.029084227202387947
Bond Position:  [-4.03688487]


portfolio before change:  [-1.09215774]
curr_Stock_Price:  101.25692616738257
curr_Factors:  [101.25692617]
mat_Sqrt:  [[0.15]]
grads:  [0.05470121]
Stock Position:  0.05470121351848673
Bond Position:  [-6.63103448]


portfolio before change:  [-1.04410128]
curr_Stock_Price:  102.1430292227342
curr_Factors:  [102.14302922]
mat_Sqrt:  [[0.15]]
grads:  [-0.04084335]
Stock Position:  -0.04084334880898796
Bond Position:  [3.12776209]


portfolio before change:  [-1.04769354]
curr_Stock_Price:  102.23576764898375
curr_Factors:  [102.23576765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01423762]
Stock Position:  -0.014237619744451802
Bond Position:  [0.40790045]


portfolio before change:  [-1.04442842]
curr_Stock_Price:  102.00822796504006
curr_Factors:  [102.00822797]
mat_Sqrt:  [[0.15]]
grads:  [0.07843975]
Stock Position:  0.07843975469799812
Bond Position:  [-9.0459288]


portfolio before change:  [-1.07998538]
curr_Stock_Price:  101.5621330878888
curr_Factors:  [101.56213309]
mat_Sqrt:  [[0.15]]
grads:  [0.08879597]
Stock Position:  0.08879597257581726
Bond Position:  [-10.09829376]


portfolio before change:  [-1.11226215]
curr_Stock_Price:  101.20574746289746
curr_Factors:  [101.20574746]
mat_Sqrt:  [[0.15]]
grads:  [0.07153213]
Stock Position:  0.07153213417281332
Bond Position:  [-8.35172526]


portfolio before change:  [-1.17666329]
curr_Stock_Price:  100.31273424761106
curr_Factors:  [100.31273425]
mat_Sqrt:  [[0.15]]
grads:  [0.02634351]
Stock Position:  0.026343507921884834
Bond Position:  [-3.8192526]


portfolio before change:  [-1.17214199]
curr_Stock_Price:  100.49342434454866
curr_Factors:  [100.49342434]
mat_Sqrt:  [[0.15]]
grads:  [0.06399499]
Stock Position:  0.06399498934307779
Bond Position:  [-7.60321761]


portfolio before change:  [-1.24110854]
curr_Stock_Price:  99.42316344792361
curr_Factors:  [99.42316345]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535665]
Stock Position:  -0.015356651766132217
Bond Position:  [0.28569836]


portfolio before change:  [-1.24182837]
curr_Stock_Price:  99.47120053426306
curr_Factors:  [99.47120053]
mat_Sqrt:  [[0.15]]
grads:  [-0.03616577]
Stock Position:  -0.0361657721662155
Bond Position:  [2.3556244]


portfolio before change:  [-1.22690039]
curr_Stock_Price:  99.06250598940908
curr_Factors:  [99.06250599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01135858]
Stock Position:  -0.011358578698488006
Bond Position:  [-0.10169112]


portfolio before change:  [-1.22868748]
curr_Stock_Price:  99.21928054003669
curr_Factors:  [99.21928054]
mat_Sqrt:  [[0.15]]
grads:  [0.01110017]
Stock Position:  0.01110016997258386
Bond Position:  [-2.33003836]


portfolio before change:  [-1.22693748]
curr_Stock_Price:  99.39005516431169
curr_Factors:  [99.39005516]
mat_Sqrt:  [[0.15]]
grads:  [0.03740189]
Stock Position:  0.03740189239608952
Bond Position:  [-4.94431363]


portfolio before change:  [-1.24483153]
curr_Stock_Price:  98.91989130994116
curr_Factors:  [98.91989131]
mat_Sqrt:  [[0.15]]
grads:  [-0.0481294]
Stock Position:  -0.04812940263021982
Bond Position:  [3.51612374]


portfolio before change:  [-1.22868689]
curr_Stock_Price:  98.5890150730177
curr_Factors:  [98.58901507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296727]
Stock Position:  -0.02967269762132995
Bond Position:  [1.69671514]


portfolio before change:  [-1.19795314]
curr_Stock_Price:  97.55683040411442
curr_Factors:  [97.5568304]
mat_Sqrt:  [[0.15]]
grads:  [-0.00475647]
Stock Position:  -0.004756469079585429
Bond Position:  [-0.73392709]


portfolio before change:  [-1.20300239]
curr_Stock_Price:  98.60874145414394
curr_Factors:  [98.60874145]
mat_Sqrt:  [[0.15]]
grads:  [0.06578092]
Stock Position:  0.06578091941565406
Bond Position:  [-7.68957607]


portfolio before change:  [-1.16811327]
curr_Stock_Price:  99.14643139216027
curr_Factors:  [99.14643139]
mat_Sqrt:  [[0.15]]
grads:  [0.04951003]
Stock Position:  0.04951003248152237
Bond Position:  [-6.07685631]


portfolio before change:  [-1.20327235]
curr_Stock_Price:  98.44396244994348
curr_Factors:  [98.44396245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02612253]
Stock Position:  -0.02612253120206344
Bond Position:  [1.36833314]


portfolio before change:  [-1.17525224]
curr_Stock_Price:  97.37459516887317
curr_Factors:  [97.37459517]
mat_Sqrt:  [[0.15]]
grads:  [-0.03289129]
Stock Position:  -0.03289129457853451
Bond Position:  [2.02752425]


portfolio before change:  [-1.20528704]
curr_Stock_Price:  98.29160132624648
curr_Factors:  [98.29160133]
mat_Sqrt:  [[0.15]]
grads:  [0.00394666]
Stock Position:  0.003946657481841409
Bond Position:  [-1.59321032]


portfolio before change:  [-1.20529381]
curr_Stock_Price:  98.31511594160276
curr_Factors:  [98.31511594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03944497]
Stock Position:  -0.039444969407405626
Bond Position:  [2.67274293]


portfolio before change:  [-1.19173589]
curr_Stock_Price:  97.97563372493754
curr_Factors:  [97.97563372]
mat_Sqrt:  [[0.15]]
grads:  [0.00369275]
Stock Position:  0.003692746444790944
Bond Position:  [-1.55353507]


portfolio before change:  [-1.19358641]
curr_Stock_Price:  97.50080612961483
curr_Factors:  [97.50080613]
mat_Sqrt:  [[0.15]]
grads:  [0.1290358]
Stock Position:  0.12903579613693342
Bond Position:  [-13.77468055]


portfolio before change:  [-1.15623655]
curr_Stock_Price:  97.79693175251052
curr_Factors:  [97.79693175]
mat_Sqrt:  [[0.15]]
grads:  [0.02590589]
Stock Position:  0.02590589194315234
Bond Position:  [-3.6897533]


portfolio before change:  [-1.15456943]
curr_Stock_Price:  97.87018666665836
curr_Factors:  [97.87018667]
mat_Sqrt:  [[0.15]]
grads:  [0.07504231]
Stock Position:  0.07504231291488403
Bond Position:  [-8.49897461]


portfolio before change:  [-1.13241546]
curr_Stock_Price:  98.17248512066928
curr_Factors:  [98.17248512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00348819]
Stock Position:  -0.0034881920521677
Bond Position:  [-0.78997098]


portfolio before change:  [-1.1313275]
curr_Stock_Price:  97.84643280252942
curr_Factors:  [97.8464328]
mat_Sqrt:  [[0.15]]
grads:  [0.01986983]
Stock Position:  0.019869830025245613
Bond Position:  [-3.07551949]


portfolio before change:  [-1.13959615]
curr_Stock_Price:  97.43996642676613
curr_Factors:  [97.43996643]
mat_Sqrt:  [[0.15]]
grads:  [0.15416613]
Stock Position:  0.15416613109402794
Bond Position:  [-16.16153878]


portfolio before change:  [-1.05738696]
curr_Stock_Price:  97.97976923221889
curr_Factors:  [97.97976923]
mat_Sqrt:  [[0.15]]
grads:  [0.0222987]
Stock Position:  0.022298695589680267
Bond Position:  [-3.24220801]


portfolio before change:  [-1.04517753]
curr_Stock_Price:  98.5363972899724
curr_Factors:  [98.53639729]
mat_Sqrt:  [[0.15]]
grads:  [-0.10570291]
Stock Position:  -0.10570291430793642
Bond Position:  [9.37040683]


portfolio before change:  [-0.94860131]
curr_Stock_Price:  97.62828092875627
curr_Factors:  [97.62828093]
mat_Sqrt:  [[0.15]]
grads:  [-0.03548141]
Stock Position:  -0.035481411152096895
Bond Position:  [2.51538786]


portfolio before change:  [-0.93155917]
curr_Stock_Price:  97.15240014015403
curr_Factors:  [97.15240014]
mat_Sqrt:  [[0.15]]
grads:  [0.01031406]
Stock Position:  0.010314057508072183
Bond Position:  [-1.93359462]


portfolio before change:  [-0.91984082]
curr_Stock_Price:  98.3002716042933
curr_Factors:  [98.3002716]
mat_Sqrt:  [[0.15]]
grads:  [0.04303509]
Stock Position:  0.04303508883974303
Bond Position:  [-5.15020174]


portfolio before change:  [-0.89659575]
curr_Stock_Price:  98.84789365829585
curr_Factors:  [98.84789366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00368859]
Stock Position:  -0.0036885888528499374
Bond Position:  [-0.53198651]


portfolio before change:  [-0.89827074]
curr_Stock_Price:  99.29298011829401
curr_Factors:  [99.29298012]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322126]
Stock Position:  -0.013221255986635323
Bond Position:  [0.41450717]


portfolio before change:  [-0.91164325]
curr_Stock_Price:  100.3063796643182
curr_Factors:  [100.30637966]
mat_Sqrt:  [[0.15]]
grads:  [0.07331178]
Stock Position:  0.07331178434052929
Bond Position:  [-8.26528292]


portfolio before change:  [-0.87426483]
curr_Stock_Price:  100.8232817968534
curr_Factors:  [100.8232818]
mat_Sqrt:  [[0.15]]
grads:  [-0.09801199]
Stock Position:  -0.09801198646295348
Bond Position:  [9.0076253]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.91460816]
Stock Price:  101.24064224422357
PL:  [-2.1552504]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.23448353e-02]
 [ 1.19892778e-02]
 [ 5.36630563e-03]
 [-1.21118753e-02]
 [ 1.09705505e-02]
 [-1.37106995e-02]
 [-1.34987670e-02]
 [ 1.47931818e-02]
 [-1.19681702e-02]
 [ 1.36578676e-03]
 [-5.09978166e-03]
 [ 2.37764007e-03]
 [-2.63917064e-03]
 [ 9.20821912e-03]
 [-2.07637716e-03]
 [ 1.55733160e-02]
 [ 4.34335079e-02]
 [-1.46726740e-02]
 [ 1.85647390e-02]
 [ 1.73586783e-03]
 [-4.24595210e-03]
 [ 4.95408002e-03]
 [ 9.54645188e-03]
 [ 2.67311560e-02]
 [ 8.49535111e-04]
 [ 7.27333780e-03]
 [-1.12111361e-02]
 [ 5.88457005e-03]
 [ 3.26737947e-02]
 [ 5.38876092e-04]
 [-6.43933537e-03]
 [ 1.07508480e-02]
 [ 1.16544775e-02]
 [-1.94817278e-02]
 [-1.26854428e-04]
 [ 1.86753706e-02]
 [-3.68339957e-04]
 [ 7.61954196e-04]
 [-3.39992615e-02]
 [-1.63875795e-02]
 [ 7.09349821e-03]
 [ 3.11474499e-02]
 [-3.27751653e-03]
 [ 8.27962734e-03]
 [-2.33134275e-02]
 [ 2.16944863e-02]
 [ 9.56116325e-03]
 [ 5.30999528e-03]
 [-7.23853579e-03]
 [-2.08876623e-04]
 [-3.50063612e-03]
 [-6.43226747e-07]
 [ 8.05399642e-05]
 [ 8.24985100e-03]
 [-1.27170093e-02]
 [-5.10211774e-03]
 [-2.71308405e-03]
 [ 1.39062945e-02]
 [ 6.37409636e-03]
 [-2.44553600e-03]
 [-5.13093413e-03]
 [-2.39958919e-03]
 [-6.42351257e-04]
 [-5.46957891e-03]
 [ 1.80879479e-02]
 [ 6.84764861e-03]
 [ 2.03029650e-02]
 [-4.42958158e-03]
 [ 8.11651980e-03]
 [ 2.78353541e-02]
 [ 3.08264553e-03]
 [-1.51134947e-02]
 [-5.68025434e-03]
 [ 2.57917674e-03]
 [ 1.15906394e-02]
 [ 6.72257139e-03]
 [ 1.85622031e-03]
 [-2.47224148e-02]
 [-3.14397049e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.47107623]
curr_Stock_Price:  99.25055895098129
curr_Factors:  [99.25055895]
mat_Sqrt:  [[0.15]]
grads:  [-0.0822989]
Stock Position:  -0.08229890226259656
Bond Position:  [-6.30286418]


portfolio before change:  [-14.53762212]
curr_Stock_Price:  100.05436002137559
curr_Factors:  [100.05436002]
mat_Sqrt:  [[0.15]]
grads:  [0.07992852]
Stock Position:  0.07992851899826052
Bond Position:  [-22.53481894]


portfolio before change:  [-14.57134245]
curr_Stock_Price:  99.65010052207337
curr_Factors:  [99.65010052]
mat_Sqrt:  [[0.15]]
grads:  [0.03577537]
Stock Position:  0.03577537084750495
Bond Position:  [-18.13636176]


portfolio before change:  [-14.60172892]
curr_Stock_Price:  98.83241753584194
curr_Factors:  [98.83241754]
mat_Sqrt:  [[0.15]]
grads:  [-0.08074584]
Stock Position:  -0.08074583529248971
Bond Position:  [-6.62142282]


portfolio before change:  [-14.58034503]
curr_Stock_Price:  98.5624624546944
curr_Factors:  [98.56246245]
mat_Sqrt:  [[0.15]]
grads:  [0.073137]
Stock Position:  0.07313700340996643
Bond Position:  [-21.78890818]


portfolio before change:  [-14.55637749]
curr_Stock_Price:  98.90879041417418
curr_Factors:  [98.90879041]
mat_Sqrt:  [[0.15]]
grads:  [-0.09140466]
Stock Position:  -0.09140466308320999
Bond Position:  [-5.51565282]


portfolio before change:  [-14.51751421]
curr_Stock_Price:  98.47984058673383
curr_Factors:  [98.47984059]
mat_Sqrt:  [[0.15]]
grads:  [-0.08999178]
Stock Position:  -0.08999177976528581
Bond Position:  [-5.65513809]


portfolio before change:  [-14.56058223]
curr_Stock_Price:  98.95449020610229
curr_Factors:  [98.95449021]
mat_Sqrt:  [[0.15]]
grads:  [0.09862121]
Stock Position:  0.09862121190164541
Bond Position:  [-24.31959398]


portfolio before change:  [-14.5056644]
curr_Stock_Price:  99.52675918653185
curr_Factors:  [99.52675919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0797878]
Stock Position:  -0.0797878013020152
Bond Position:  [-6.56464311]


portfolio before change:  [-14.57859857]
curr_Stock_Price:  100.43571852078875
curr_Factors:  [100.43571852]
mat_Sqrt:  [[0.15]]
grads:  [0.00910525]
Stock Position:  0.009105245074313567
Bond Position:  [-15.4930904]


portfolio before change:  [-14.57412485]
curr_Stock_Price:  101.03340346970548
curr_Factors:  [101.03340347]
mat_Sqrt:  [[0.15]]
grads:  [-0.03399854]
Stock Position:  -0.03399854437472061
Bond Position:  [-11.13913619]


portfolio before change:  [-14.56419388]
curr_Stock_Price:  100.72082571585196
curr_Factors:  [100.72082572]
mat_Sqrt:  [[0.15]]
grads:  [0.01585093]
Stock Position:  0.01585093380918545
Bond Position:  [-16.16071302]


portfolio before change:  [-14.56928968]
curr_Stock_Price:  100.46306631163431
curr_Factors:  [100.46306631]
mat_Sqrt:  [[0.15]]
grads:  [-0.01759447]
Stock Position:  -0.01759447093687849
Bond Position:  [-12.80169518]


portfolio before change:  [-14.55997144]
curr_Stock_Price:  99.88797856079741
curr_Factors:  [99.88797856]
mat_Sqrt:  [[0.15]]
grads:  [0.06138813]
Stock Position:  0.061388127464330235
Bond Position:  [-20.6919074]


portfolio before change:  [-14.51445613]
curr_Stock_Price:  100.65048096446478
curr_Factors:  [100.65048096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01384251]
Stock Position:  -0.013842514414865482
Bond Position:  [-13.1212004]


portfolio before change:  [-14.51653469]
curr_Stock_Price:  100.74139336230199
curr_Factors:  [100.74139336]
mat_Sqrt:  [[0.15]]
grads:  [0.10382211]
Stock Position:  0.10382210689846573
Bond Position:  [-24.9757184]


portfolio before change:  [-14.53953712]
curr_Stock_Price:  100.5348728261075
curr_Factors:  [100.53487283]
mat_Sqrt:  [[0.15]]
grads:  [0.28955672]
Stock Position:  0.28955671947116435
Bond Position:  [-43.65008509]


portfolio before change:  [-14.48121199]
curr_Stock_Price:  100.74572388537838
curr_Factors:  [100.74572389]
mat_Sqrt:  [[0.15]]
grads:  [-0.09781783]
Stock Position:  -0.09781782653587644
Bond Position:  [-4.62648425]


portfolio before change:  [-14.46757527]
curr_Stock_Price:  100.60335838333715
curr_Factors:  [100.60335838]
mat_Sqrt:  [[0.15]]
grads:  [0.12376493]
Stock Position:  0.12376492686951816
Bond Position:  [-26.91874257]


portfolio before change:  [-14.40621846]
curr_Stock_Price:  101.11270530502102
curr_Factors:  [101.11270531]
mat_Sqrt:  [[0.15]]
grads:  [0.01157245]
Stock Position:  0.011572452199651648
Bond Position:  [-15.57634041]


portfolio before change:  [-14.40319725]
curr_Stock_Price:  101.4579015300897
curr_Factors:  [101.45790153]
mat_Sqrt:  [[0.15]]
grads:  [-0.02830635]
Stock Position:  -0.028306347303815246
Bond Position:  [-11.53129465]


portfolio before change:  [-14.4167845]
curr_Stock_Price:  101.91244688105908
curr_Factors:  [101.91244688]
mat_Sqrt:  [[0.15]]
grads:  [0.0330272]
Stock Position:  0.0330272001267352
Bond Position:  [-17.78266727]


portfolio before change:  [-14.41076618]
curr_Stock_Price:  102.12832246831329
curr_Factors:  [102.12832247]
mat_Sqrt:  [[0.15]]
grads:  [0.06364301]
Stock Position:  0.06364301251798138
Bond Position:  [-20.91052029]


portfolio before change:  [-14.42723067]
curr_Stock_Price:  101.89015748214194
curr_Factors:  [101.89015748]
mat_Sqrt:  [[0.15]]
grads:  [0.17820771]
Stock Position:  0.17820770654638693
Bond Position:  [-32.58484195]


portfolio before change:  [-14.3498864]
curr_Stock_Price:  102.33559772663467
curr_Factors:  [102.33559773]
mat_Sqrt:  [[0.15]]
grads:  [0.00566357]
Stock Position:  0.00566356740704681
Bond Position:  [-14.92947095]


portfolio before change:  [-14.35588298]
curr_Stock_Price:  101.4415562366621
curr_Factors:  [101.44155624]
mat_Sqrt:  [[0.15]]
grads:  [0.04848892]
Stock Position:  0.04848891864418631
Bond Position:  [-19.27467435]


portfolio before change:  [-14.37723428]
curr_Stock_Price:  101.02606765686738
curr_Factors:  [101.02606766]
mat_Sqrt:  [[0.15]]
grads:  [-0.07474091]
Stock Position:  -0.07474090752741874
Bond Position:  [-6.8264543]


portfolio before change:  [-14.35755135]
curr_Stock_Price:  100.75701020956362
curr_Factors:  [100.75701021]
mat_Sqrt:  [[0.15]]
grads:  [0.03923047]
Stock Position:  0.039230467027578264
Bond Position:  [-18.31029592]


portfolio before change:  [-14.35182663]
curr_Stock_Price:  100.93210748964528
curr_Factors:  [100.93210749]
mat_Sqrt:  [[0.15]]
grads:  [0.2178253]
Stock Position:  0.2178252981769692
Bond Position:  [-36.33739304]


portfolio before change:  [-14.57869571]
curr_Stock_Price:  99.90101550745648
curr_Factors:  [99.90101551]
mat_Sqrt:  [[0.15]]
grads:  [0.00359251]
Stock Position:  0.003592507282696375
Bond Position:  [-14.93759083]


portfolio before change:  [-14.58243464]
curr_Stock_Price:  99.12013833176046
curr_Factors:  [99.12013833]
mat_Sqrt:  [[0.15]]
grads:  [-0.0429289]
Stock Position:  -0.04292890248722316
Bond Position:  [-10.32731589]


portfolio before change:  [-14.56928029]
curr_Stock_Price:  98.79868060951095
curr_Factors:  [98.79868061]
mat_Sqrt:  [[0.15]]
grads:  [0.07167232]
Stock Position:  0.07167231999411022
Bond Position:  [-21.65041095]


portfolio before change:  [-14.66041685]
curr_Stock_Price:  97.5459883652661
curr_Factors:  [97.54598837]
mat_Sqrt:  [[0.15]]
grads:  [0.07769652]
Stock Position:  0.07769651639296776
Bond Position:  [-22.23940033]


portfolio before change:  [-14.61046719]
curr_Stock_Price:  98.20676011772136
curr_Factors:  [98.20676012]
mat_Sqrt:  [[0.15]]
grads:  [-0.12987819]
Stock Position:  -0.1298781853661403
Bond Position:  [-1.85555139]


portfolio before change:  [-14.69183429]
curr_Stock_Price:  98.83235495466018
curr_Factors:  [98.83235495]
mat_Sqrt:  [[0.15]]
grads:  [-0.0008457]
Stock Position:  -0.0008456961893122505
Bond Position:  [-14.60825214]


portfolio before change:  [-14.69294605]
curr_Stock_Price:  99.06733064477548
curr_Factors:  [99.06733064]
mat_Sqrt:  [[0.15]]
grads:  [0.12450247]
Stock Position:  0.12450247094771882
Bond Position:  [-27.0270735]


portfolio before change:  [-14.67544436]
curr_Stock_Price:  99.22147165013081
curr_Factors:  [99.22147165]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024556]
Stock Position:  -0.0024555997102488894
Bond Position:  [-14.43179614]


portfolio before change:  [-14.67409881]
curr_Stock_Price:  98.30618905385516
curr_Factors:  [98.30618905]
mat_Sqrt:  [[0.15]]
grads:  [0.00507969]
Stock Position:  0.005079694639610449
Bond Position:  [-15.17346423]


portfolio before change:  [-14.67592471]
curr_Stock_Price:  98.13343539925822
curr_Factors:  [98.1334354]
mat_Sqrt:  [[0.15]]
grads:  [-0.22666174]
Stock Position:  -0.22666174334186606
Bond Position:  [7.56717084]


portfolio before change:  [-14.66949624]
curr_Stock_Price:  98.10716053898459
curr_Factors:  [98.10716054]
mat_Sqrt:  [[0.15]]
grads:  [-0.10925053]
Stock Position:  -0.1092505297552242
Bond Position:  [-3.95123698]


portfolio before change:  [-14.59334595]
curr_Stock_Price:  97.40787560987486
curr_Factors:  [97.40787561]
mat_Sqrt:  [[0.15]]
grads:  [0.04728999]
Stock Position:  0.047289988071576576
Bond Position:  [-19.19976323]


portfolio before change:  [-14.5954444]
curr_Stock_Price:  97.38887739724986
curr_Factors:  [97.3888774]
mat_Sqrt:  [[0.15]]
grads:  [0.20764967]
Stock Position:  0.207649665870393
Bond Position:  [-34.81821225]


portfolio before change:  [-14.6546262]
curr_Stock_Price:  97.11434965266507
curr_Factors:  [97.11434965]
mat_Sqrt:  [[0.15]]
grads:  [-0.02185011]
Stock Position:  -0.02185011022575634
Bond Position:  [-12.53266696]


portfolio before change:  [-14.64930182]
curr_Stock_Price:  96.83482250839174
curr_Factors:  [96.83482251]
mat_Sqrt:  [[0.15]]
grads:  [0.05519752]
Stock Position:  0.05519751559744407
Bond Position:  [-19.99434345]


portfolio before change:  [-14.63892625]
curr_Stock_Price:  97.04543440463347
curr_Factors:  [97.0454344]
mat_Sqrt:  [[0.15]]
grads:  [-0.15542285]
Stock Position:  -0.15542285023324978
Bond Position:  [0.44415176]


portfolio before change:  [-14.46025823]
curr_Stock_Price:  95.89605215312531
curr_Factors:  [95.89605215]
mat_Sqrt:  [[0.15]]
grads:  [0.14462991]
Stock Position:  0.14462990862659048
Bond Position:  [-28.32969549]


portfolio before change:  [-14.40375332]
curr_Stock_Price:  96.29898105360103
curr_Factors:  [96.29898105]
mat_Sqrt:  [[0.15]]
grads:  [0.06374109]
Stock Position:  0.06374108835811956
Bond Position:  [-20.54195518]


portfolio before change:  [-14.35889187]
curr_Stock_Price:  97.02293099242418
curr_Factors:  [97.02293099]
mat_Sqrt:  [[0.15]]
grads:  [0.03539997]
Stock Position:  0.03539996854016583
Bond Position:  [-17.79350058]


portfolio before change:  [-14.34665366]
curr_Stock_Price:  97.40005973515326
curr_Factors:  [97.40005974]
mat_Sqrt:  [[0.15]]
grads:  [-0.04825691]
Stock Position:  -0.04825690526513063
Bond Position:  [-9.6464282]


portfolio before change:  [-14.30659062]
curr_Stock_Price:  96.55736254815558
curr_Factors:  [96.55736255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00139251]
Stock Position:  -0.001392510817220347
Bond Position:  [-14.17213345]


portfolio before change:  [-14.30715205]
curr_Stock_Price:  96.32443631677553
curr_Factors:  [96.32443632]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333757]
Stock Position:  -0.02333757413775686
Bond Position:  [-12.05917338]


portfolio before change:  [-14.32062658]
curr_Stock_Price:  96.86951454749236
curr_Factors:  [96.86951455]
mat_Sqrt:  [[0.15]]
grads:  [-4.28817832e-06]
Stock Position:  -4.288178316082247e-06
Bond Position:  [-14.32021118]


portfolio before change:  [-14.32151911]
curr_Stock_Price:  96.28498493294138
curr_Factors:  [96.28498493]
mat_Sqrt:  [[0.15]]
grads:  [0.00053693]
Stock Position:  0.0005369330945508701
Bond Position:  [-14.37321771]


portfolio before change:  [-14.32248023]
curr_Stock_Price:  96.16809616583426
curr_Factors:  [96.16809617]
mat_Sqrt:  [[0.15]]
grads:  [0.05499901]
Stock Position:  0.05499900664380127
Bond Position:  [-19.61162999]


portfolio before change:  [-14.35335979]
curr_Stock_Price:  95.62892643378451
curr_Factors:  [95.62892643]
mat_Sqrt:  [[0.15]]
grads:  [-0.08478006]
Stock Position:  -0.08478006221725806
Bond Position:  [-6.24593346]


portfolio before change:  [-14.3576573]
curr_Stock_Price:  95.67501181392068
curr_Factors:  [95.67501181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03401412]
Stock Position:  -0.034014118247546146
Bond Position:  [-11.10335613]


portfolio before change:  [-14.34720134]
curr_Stock_Price:  95.34720865776492
curr_Factors:  [95.34720866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01808723]
Stock Position:  -0.01808722697598722
Bond Position:  [-12.62263474]


portfolio before change:  [-14.33381013]
curr_Stock_Price:  94.56322160249327
curr_Factors:  [94.5632216]
mat_Sqrt:  [[0.15]]
grads:  [0.09270863]
Stock Position:  0.09270862994688663
Bond Position:  [-23.10063685]


portfolio before change:  [-14.32637041]
curr_Stock_Price:  94.65904395546504
curr_Factors:  [94.65904396]
mat_Sqrt:  [[0.15]]
grads:  [0.04249398]
Stock Position:  0.0424939757394073
Bond Position:  [-18.34880952]


portfolio before change:  [-14.31890607]
curr_Stock_Price:  94.86168857937936
curr_Factors:  [94.86168858]
mat_Sqrt:  [[0.15]]
grads:  [-0.01630357]
Stock Position:  -0.016303573327275406
Bond Position:  [-12.77232157]


portfolio before change:  [-14.32244452]
curr_Stock_Price:  95.0297595778066
curr_Factors:  [95.02975958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420623]
Stock Position:  -0.03420622750411628
Bond Position:  [-11.07183494]


portfolio before change:  [-14.33994472]
curr_Stock_Price:  95.52113759801586
curr_Factors:  [95.5211376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01599726]
Stock Position:  -0.0159972612720473
Bond Position:  [-12.81186812]


portfolio before change:  [-14.33281456]
curr_Stock_Price:  95.0253699019049
curr_Factors:  [95.0253699]
mat_Sqrt:  [[0.15]]
grads:  [-0.00428234]
Stock Position:  -0.0042823417121133755
Bond Position:  [-13.92588346]


portfolio before change:  [-14.33207755]
curr_Stock_Price:  94.65001297882334
curr_Factors:  [94.65001298]
mat_Sqrt:  [[0.15]]
grads:  [-0.03646386]
Stock Position:  -0.03646385940830997
Bond Position:  [-10.88077278]


portfolio before change:  [-14.35147568]
curr_Stock_Price:  95.16334487718385
curr_Factors:  [95.16334488]
mat_Sqrt:  [[0.15]]
grads:  [0.12058632]
Stock Position:  0.12058631909101723
Bond Position:  [-25.82687315]


portfolio before change:  [-14.36761935]
curr_Stock_Price:  95.042854972219
curr_Factors:  [95.04285497]
mat_Sqrt:  [[0.15]]
grads:  [0.04565099]
Stock Position:  0.04565099072766412
Bond Position:  [-18.70641984]


portfolio before change:  [-14.36287155]
curr_Stock_Price:  95.17246848984865
curr_Factors:  [95.17246849]
mat_Sqrt:  [[0.15]]
grads:  [0.1353531]
Stock Position:  0.13535309975953666
Bond Position:  [-27.24476017]


portfolio before change:  [-14.44456208]
curr_Stock_Price:  94.58151282018214
curr_Factors:  [94.58151282]
mat_Sqrt:  [[0.15]]
grads:  [-0.02953054]
Stock Position:  -0.02953054384223154
Bond Position:  [-11.65151857]


portfolio before change:  [-14.43976442]
curr_Stock_Price:  94.39438769937394
curr_Factors:  [94.3943877]
mat_Sqrt:  [[0.15]]
grads:  [0.05411013]
Stock Position:  0.05411013202880456
Bond Position:  [-19.5474572]


portfolio before change:  [-14.41610107]
curr_Stock_Price:  94.85428496904254
curr_Factors:  [94.85428497]
mat_Sqrt:  [[0.15]]
grads:  [0.18556903]
Stock Position:  0.18556902727094843
Bond Position:  [-32.01811846]


portfolio before change:  [-14.54513689]
curr_Stock_Price:  94.1697169092299
curr_Factors:  [94.16971691]
mat_Sqrt:  [[0.15]]
grads:  [0.02055097]
Stock Position:  0.020550970195941466
Bond Position:  [-16.48041594]


portfolio before change:  [-14.54825375]
curr_Stock_Price:  94.06817448022115
curr_Factors:  [94.06817448]
mat_Sqrt:  [[0.15]]
grads:  [-0.10075663]
Stock Position:  -0.10075663141643681
Bond Position:  [-5.07026136]


portfolio before change:  [-14.57868338]
curr_Stock_Price:  94.36704047720825
curr_Factors:  [94.36704048]
mat_Sqrt:  [[0.15]]
grads:  [-0.03786836]
Stock Position:  -0.037868362277813906
Bond Position:  [-11.0051581]


portfolio before change:  [-14.60994534]
curr_Stock_Price:  95.1744194578316
curr_Factors:  [95.17441946]
mat_Sqrt:  [[0.15]]
grads:  [0.01719451]
Stock Position:  0.017194511566837496
Bond Position:  [-16.246423]


portfolio before change:  [-14.61689958]
curr_Stock_Price:  94.82902967546204
curr_Factors:  [94.82902968]
mat_Sqrt:  [[0.15]]
grads:  [0.07727093]
Stock Position:  0.07727092958496068
Bond Position:  [-21.94442686]


portfolio before change:  [-14.57867688]
curr_Stock_Price:  95.34143808674582
curr_Factors:  [95.34143809]
mat_Sqrt:  [[0.15]]
grads:  [0.04481714]
Stock Position:  0.04481714259007761
Bond Position:  [-18.8516077]


portfolio before change:  [-14.61646319]
curr_Stock_Price:  94.52460660238118
curr_Factors:  [94.5246066]
mat_Sqrt:  [[0.15]]
grads:  [0.0123748]
Stock Position:  0.012374802063752355
Bond Position:  [-15.78618649]


portfolio before change:  [-14.618348]
curr_Stock_Price:  94.45202897056667
curr_Factors:  [94.45202897]
mat_Sqrt:  [[0.15]]
grads:  [-0.1648161]
Stock Position:  -0.16481609881640621
Bond Position:  [0.94886694]


portfolio before change:  [-14.59397262]
curr_Stock_Price:  94.3044944273283
curr_Factors:  [94.30449443]
mat_Sqrt:  [[0.15]]
grads:  [-0.20959803]
Stock Position:  -0.20959803251222964
Bond Position:  [5.17206387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.5988587]
Stock Price:  94.32934838425795
PL:  [-14.5988587]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32978036e-02]
 [ 3.22655918e-02]
 [ 2.58738955e-03]
 [-7.54842466e-03]
 [ 1.50412657e-02]
 [-1.25709104e-02]
 [-8.51480235e-03]
 [-2.63650300e-02]
 [-1.23917268e-03]
 [ 1.65390946e-03]
 [ 2.46872217e-03]
 [ 7.84772933e-03]
 [-3.35550994e-03]
 [ 6.77941955e-03]
 [ 1.38268399e-04]
 [ 1.60849953e-02]
 [ 9.49695914e-02]
 [-1.23612367e-02]
 [ 2.15849863e-02]
 [ 9.38303547e-04]
 [-6.26465808e-03]
 [ 5.57276878e-03]
 [ 7.31575749e-03]
 [ 3.50644456e-02]
 [ 4.54894874e-04]
 [ 8.37067942e-03]
 [ 5.36134157e-03]
 [ 1.20195388e-02]
 [ 3.43692095e-02]
 [ 2.00540268e-03]
 [-7.09912450e-03]
 [ 8.23589087e-03]
 [ 1.18232616e-02]
 [-9.03556576e-03]
 [ 7.52480422e-03]
 [ 1.90121043e-02]
 [ 4.08795516e-03]
 [ 2.37032942e-03]
 [-3.47487682e-02]
 [-1.35307247e-02]
 [ 7.16177786e-03]
 [ 2.35891787e-02]
 [-2.45515875e-03]
 [-1.53308124e-03]
 [ 2.74588213e-03]
 [ 1.46618639e-02]
 [ 1.06183490e-02]
 [ 5.00864020e-03]
 [ 3.65060714e-03]
 [-1.94331852e-03]
 [-5.31213892e-03]
 [-5.42648938e-03]
 [ 2.12385061e-03]
 [ 1.47448596e-03]
 [-3.65250643e-03]
 [-3.92589864e-03]
 [ 7.54928574e-03]
 [-1.08114229e-03]
 [ 6.76733350e-03]
 [-3.99778384e-03]
 [-2.57075103e-03]
 [ 8.09941868e-03]
 [-1.56833261e-02]
 [ 4.37896274e-03]
 [ 2.54505502e-02]
 [ 5.56312973e-03]
 [ 1.04144042e-02]
 [ 1.62800043e-03]
 [ 2.83866839e-03]
 [ 2.15627779e-02]
 [ 1.00626917e-03]
 [-1.59888731e-02]
 [-4.58168469e-03]
 [ 1.21606627e-03]
 [ 2.77507610e-03]
 [-1.54952802e-03]
 [-4.10023345e-03]
 [ 1.39828096e-02]
 [-1.71933974e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.84228773]
curr_Stock_Price:  99.94606056090515
curr_Factors:  [99.94606056]
mat_Sqrt:  [[0.15]]
grads:  [-0.08865202]
Stock Position:  -0.08865202376202223
Bond Position:  [9.70270827]


portfolio before change:  [0.77025259]
curr_Stock_Price:  100.76546179015615
curr_Factors:  [100.76546179]
mat_Sqrt:  [[0.15]]
grads:  [0.21510395]
Stock Position:  0.21510394504701807
Bond Position:  [-20.90479576]


portfolio before change:  [0.59023588]
curr_Stock_Price:  99.93465360323968
curr_Factors:  [99.9346536]
mat_Sqrt:  [[0.15]]
grads:  [0.01724926]
Stock Position:  0.017249263692673707
Bond Position:  [-1.13356331]


portfolio before change:  [0.59158801]
curr_Stock_Price:  100.0171486463415
curr_Factors:  [100.01714865]
mat_Sqrt:  [[0.15]]
grads:  [-0.05032283]
Stock Position:  -0.050322831098937294
Bond Position:  [5.62473409]


portfolio before change:  [0.61304937]
curr_Stock_Price:  99.59766114390433
curr_Factors:  [99.59766114]
mat_Sqrt:  [[0.15]]
grads:  [0.1002751]
Stock Position:  0.10027510486032185
Bond Position:  [-9.37411655]


portfolio before change:  [0.59190691]
curr_Stock_Price:  99.39265948252766
curr_Factors:  [99.39265948]
mat_Sqrt:  [[0.15]]
grads:  [-0.08380607]
Stock Position:  -0.08380606931703831
Bond Position:  [8.92161502]


portfolio before change:  [0.47602816]
curr_Stock_Price:  100.78201422606115
curr_Factors:  [100.78201423]
mat_Sqrt:  [[0.15]]
grads:  [-0.05676535]
Stock Position:  -0.05676534899663406
Bond Position:  [6.19695437]


portfolio before change:  [0.47060591]
curr_Stock_Price:  100.884357955488
curr_Factors:  [100.88435796]
mat_Sqrt:  [[0.15]]
grads:  [-0.17576687]
Stock Position:  -0.1757668663401699
Bond Position:  [18.20273337]


portfolio before change:  [0.58550218]
curr_Stock_Price:  100.23714514542655
curr_Factors:  [100.23714515]
mat_Sqrt:  [[0.15]]
grads:  [-0.00826115]
Stock Position:  -0.008261151181471449
Bond Position:  [1.41357639]


portfolio before change:  [0.58301234]
curr_Stock_Price:  100.54923135921783
curr_Factors:  [100.54923136]
mat_Sqrt:  [[0.15]]
grads:  [0.01102606]
Stock Position:  0.011026063068934982
Bond Position:  [-0.52564982]


portfolio before change:  [0.58404405]
curr_Stock_Price:  100.64578100931281
curr_Factors:  [100.64578101]
mat_Sqrt:  [[0.15]]
grads:  [0.01645815]
Stock Position:  0.016458147779880722
Bond Position:  [-1.07239909]


portfolio before change:  [0.59129624]
curr_Stock_Price:  101.09049770834189
curr_Factors:  [101.09049771]
mat_Sqrt:  [[0.15]]
grads:  [0.0523182]
Stock Position:  0.052318195561498256
Bond Position:  [-4.69757619]


portfolio before change:  [0.58857554]
curr_Stock_Price:  101.04410673220274
curr_Factors:  [101.04410673]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237007]
Stock Position:  -0.02237006629358719
Bond Position:  [2.8489389]


portfolio before change:  [0.59551833]
curr_Stock_Price:  100.74170564266191
curr_Factors:  [100.74170564]
mat_Sqrt:  [[0.15]]
grads:  [0.04519613]
Stock Position:  0.045196130321161834
Bond Position:  [-3.95761692]


portfolio before change:  [0.6144354]
curr_Stock_Price:  101.16573365214842
curr_Factors:  [101.16573365]
mat_Sqrt:  [[0.15]]
grads:  [0.00092179]
Stock Position:  0.0009217893256201783
Bond Position:  [0.52118191]


portfolio before change:  [0.61433937]
curr_Stock_Price:  101.02621524230989
curr_Factors:  [101.02621524]
mat_Sqrt:  [[0.15]]
grads:  [0.1072333]
Stock Position:  0.10723330202632822
Bond Position:  [-10.21903528]


portfolio before change:  [0.71594573]
curr_Stock_Price:  101.97969768819405
curr_Factors:  [101.97969769]
mat_Sqrt:  [[0.15]]
grads:  [0.63313061]
Stock Position:  0.6331306092712733
Bond Position:  [-63.8505224]


portfolio before change:  [0.78307581]
curr_Stock_Price:  102.09202973723174
curr_Factors:  [102.09202974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08240824]
Stock Position:  -0.08240824440070937
Bond Position:  [9.19630074]


portfolio before change:  [0.76803277]
curr_Stock_Price:  102.28154747972243
curr_Factors:  [102.28154748]
mat_Sqrt:  [[0.15]]
grads:  [0.14389991]
Stock Position:  0.14389990837558064
Bond Position:  [-13.95027254]


portfolio before change:  [0.77577347]
curr_Stock_Price:  102.34139892008126
curr_Factors:  [102.34139892]
mat_Sqrt:  [[0.15]]
grads:  [0.00625536]
Stock Position:  0.006255356980125063
Bond Position:  [0.13559148]


portfolio before change:  [0.77902818]
curr_Stock_Price:  102.86035219489393
curr_Factors:  [102.86035219]
mat_Sqrt:  [[0.15]]
grads:  [-0.04176439]
Stock Position:  -0.04176438721495551
Bond Position:  [5.07492776]


portfolio before change:  [0.79061214]
curr_Stock_Price:  102.59058244349787
curr_Factors:  [102.59058244]
mat_Sqrt:  [[0.15]]
grads:  [0.03715179]
Stock Position:  0.037151791870211615
Bond Position:  [-3.02081183]


portfolio before change:  [0.78859713]
curr_Stock_Price:  102.5414272134253
curr_Factors:  [102.54142721]
mat_Sqrt:  [[0.15]]
grads:  [0.04877172]
Stock Position:  0.04877171656913975
Bond Position:  [-4.2125243]


portfolio before change:  [0.78876392]
curr_Stock_Price:  102.55024547067656
curr_Factors:  [102.55024547]
mat_Sqrt:  [[0.15]]
grads:  [0.23376297]
Stock Position:  0.23376297084095649
Bond Position:  [-23.18368612]


portfolio before change:  [0.7098345]
curr_Stock_Price:  102.21879692252365
curr_Factors:  [102.21879692]
mat_Sqrt:  [[0.15]]
grads:  [0.00303263]
Stock Position:  0.0030326324935139063
Bond Position:  [0.39984245]


portfolio before change:  [0.70998044]
curr_Stock_Price:  102.25868262916651
curr_Factors:  [102.25868263]
mat_Sqrt:  [[0.15]]
grads:  [0.05580453]
Stock Position:  0.05580452946803455
Bond Position:  [-4.99651722]


portfolio before change:  [0.70973827]
curr_Stock_Price:  102.25993912495547
curr_Factors:  [102.25993912]
mat_Sqrt:  [[0.15]]
grads:  [0.03574228]
Stock Position:  0.03574227714041714
Bond Position:  [-2.94526481]


portfolio before change:  [0.68459868]
curr_Stock_Price:  101.56173217733794
curr_Factors:  [101.56173218]
mat_Sqrt:  [[0.15]]
grads:  [0.08013026]
Stock Position:  0.08013025853257175
Bond Position:  [-7.45356918]


portfolio before change:  [0.65843672]
curr_Stock_Price:  101.24105313607637
curr_Factors:  [101.24105314]
mat_Sqrt:  [[0.15]]
grads:  [0.22912806]
Stock Position:  0.22912806348522746
Bond Position:  [-22.53872973]


portfolio before change:  [0.44586345]
curr_Stock_Price:  100.31945252912848
curr_Factors:  [100.31945253]
mat_Sqrt:  [[0.15]]
grads:  [0.01336935]
Stock Position:  0.013369351228852203
Bond Position:  [-0.89534255]


portfolio before change:  [0.43738243]
curr_Stock_Price:  99.68927582898021
curr_Factors:  [99.68927583]
mat_Sqrt:  [[0.15]]
grads:  [-0.0473275]
Stock Position:  -0.047327496638594126
Bond Position:  [5.1554263]


portfolio before change:  [0.41730398]
curr_Stock_Price:  100.12032910505053
curr_Factors:  [100.12032911]
mat_Sqrt:  [[0.15]]
grads:  [0.05490594]
Stock Position:  0.054905939108577224
Bond Position:  [-5.07989671]


portfolio before change:  [0.38544191]
curr_Stock_Price:  99.54580886724442
curr_Factors:  [99.54580887]
mat_Sqrt:  [[0.15]]
grads:  [0.07882174]
Stock Position:  0.07882174404722782
Bond Position:  [-7.46093236]


portfolio before change:  [0.3756833]
curr_Stock_Price:  99.42791901134537
curr_Factors:  [99.42791901]
mat_Sqrt:  [[0.15]]
grads:  [-0.06023711]
Stock Position:  -0.06023710505491365
Bond Position:  [6.3649333]


portfolio before change:  [0.3465826]
curr_Stock_Price:  99.91762584386699
curr_Factors:  [99.91762584]
mat_Sqrt:  [[0.15]]
grads:  [0.05016536]
Stock Position:  0.050165361485912725
Bond Position:  [-4.66582122]


portfolio before change:  [0.30854515]
curr_Stock_Price:  99.16519777381626
curr_Factors:  [99.16519777]
mat_Sqrt:  [[0.15]]
grads:  [0.12674736]
Stock Position:  0.12674736187127109
Bond Position:  [-12.26038206]


portfolio before change:  [0.25860563]
curr_Stock_Price:  98.77723530538171
curr_Factors:  [98.77723531]
mat_Sqrt:  [[0.15]]
grads:  [0.02725303]
Stock Position:  0.027253034376507636
Bond Position:  [-2.43337376]


portfolio before change:  [0.26189149]
curr_Stock_Price:  98.90338447940526
curr_Factors:  [98.90338448]
mat_Sqrt:  [[0.15]]
grads:  [0.0158022]
Stock Position:  0.015802196125347282
Bond Position:  [-1.30099919]


portfolio before change:  [0.25944301]
curr_Stock_Price:  98.75358447639108
curr_Factors:  [98.75358448]
mat_Sqrt:  [[0.15]]
grads:  [-0.23165845]
Stock Position:  -0.2316584547768649
Bond Position:  [23.13654579]


portfolio before change:  [0.13744161]
curr_Stock_Price:  99.28647014510966
curr_Factors:  [99.28647015]
mat_Sqrt:  [[0.15]]
grads:  [-0.09020483]
Stock Position:  -0.09020483163394279
Bond Position:  [9.09356094]


portfolio before change:  [0.20793877]
curr_Stock_Price:  98.51124790311557
curr_Factors:  [98.5112479]
mat_Sqrt:  [[0.15]]
grads:  [0.04774519]
Stock Position:  0.047745185751994136
Bond Position:  [-4.49549906]


portfolio before change:  [0.20459185]
curr_Stock_Price:  98.44703326400352
curr_Factors:  [98.44703326]
mat_Sqrt:  [[0.15]]
grads:  [0.15726119]
Stock Position:  0.15726119155011622
Bond Position:  [-15.2773059]


portfolio before change:  [0.23835587]
curr_Stock_Price:  98.66780534647056
curr_Factors:  [98.66780535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636773]
Stock Position:  -0.016367725027489795
Bond Position:  [1.85332338]


portfolio before change:  [0.22794618]
curr_Stock_Price:  99.31087121674277
curr_Factors:  [99.31087122]
mat_Sqrt:  [[0.15]]
grads:  [-0.01022054]
Stock Position:  -0.010220541622515126
Bond Position:  [1.24295708]


portfolio before change:  [0.23623448]
curr_Stock_Price:  98.50752747297707
curr_Factors:  [98.50752747]
mat_Sqrt:  [[0.15]]
grads:  [0.01830588]
Stock Position:  0.018305880835734478
Bond Position:  [-1.56703258]


portfolio before change:  [0.24389675]
curr_Stock_Price:  98.93144637842943
curr_Factors:  [98.93144638]
mat_Sqrt:  [[0.15]]
grads:  [0.09774576]
Stock Position:  0.09774575948859449
Bond Position:  [-9.42623262]


portfolio before change:  [0.22691622]
curr_Stock_Price:  98.76375244802828
curr_Factors:  [98.76375245]
mat_Sqrt:  [[0.15]]
grads:  [0.07078899]
Stock Position:  0.07078899350777106
Bond Position:  [-6.76447041]


portfolio before change:  [0.22396152]
curr_Stock_Price:  98.72798553676965
curr_Factors:  [98.72798554]
mat_Sqrt:  [[0.15]]
grads:  [0.03339093]
Stock Position:  0.03339093469068242
Bond Position:  [-3.0726582]


portfolio before change:  [0.23860336]
curr_Stock_Price:  99.17223445202939
curr_Factors:  [99.17223445]
mat_Sqrt:  [[0.15]]
grads:  [0.02433738]
Stock Position:  0.024337380907869147
Bond Position:  [-2.17498908]


portfolio before change:  [0.23234633]
curr_Stock_Price:  98.92072447126574
curr_Factors:  [98.92072447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295546]
Stock Position:  -0.012955456827353088
Bond Position:  [1.5139095]


portfolio before change:  [0.22509028]
curr_Stock_Price:  99.4881048764704
curr_Factors:  [99.48810488]
mat_Sqrt:  [[0.15]]
grads:  [-0.03541426]
Stock Position:  -0.03541425948851413
Bond Position:  [3.74838784]


portfolio before change:  [0.21621049]
curr_Stock_Price:  99.74546065171175
curr_Factors:  [99.74546065]
mat_Sqrt:  [[0.15]]
grads:  [-0.0361766]
Stock Position:  -0.03617659588435392
Bond Position:  [3.82466171]


portfolio before change:  [0.1985112]
curr_Stock_Price:  100.24131549300479
curr_Factors:  [100.24131549]
mat_Sqrt:  [[0.15]]
grads:  [0.014159]
Stock Position:  0.014159004035954728
Bond Position:  [-1.22080599]


portfolio before change:  [0.19887123]
curr_Stock_Price:  100.27213180176426
curr_Factors:  [100.2721318]
mat_Sqrt:  [[0.15]]
grads:  [0.00982991]
Stock Position:  0.009829906405138372
Bond Position:  [-0.78679444]


portfolio before change:  [0.20703271]
curr_Stock_Price:  101.10740568309664
curr_Factors:  [101.10740568]
mat_Sqrt:  [[0.15]]
grads:  [-0.02435004]
Stock Position:  -0.02435004284795943
Bond Position:  [2.66900238]


portfolio before change:  [0.22401463]
curr_Stock_Price:  100.41684840539861
curr_Factors:  [100.41684841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617266]
Stock Position:  -0.02617265758644069
Bond Position:  [2.85219042]


portfolio before change:  [0.22316227]
curr_Stock_Price:  100.45622651207496
curr_Factors:  [100.45622651]
mat_Sqrt:  [[0.15]]
grads:  [0.05032857]
Stock Position:  0.0503285716219759
Bond Position:  [-4.83265612]


portfolio before change:  [0.24971224]
curr_Stock_Price:  100.98976087888286
curr_Factors:  [100.98976088]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720762]
Stock Position:  -0.007207615295079575
Bond Position:  [0.97760759]


portfolio before change:  [0.24575657]
curr_Stock_Price:  101.54705713346787
curr_Factors:  [101.54705713]
mat_Sqrt:  [[0.15]]
grads:  [0.04511556]
Stock Position:  0.04511555669889759
Bond Position:  [-4.33559545]


portfolio before change:  [0.23586177]
curr_Stock_Price:  101.33374248375424
curr_Factors:  [101.33374248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665189]
Stock Position:  -0.026651892282215657
Bond Position:  [2.93659776]


portfolio before change:  [0.20688507]
curr_Stock_Price:  102.42785791251686
curr_Factors:  [102.42785791]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713834]
Stock Position:  -0.017138340204571726
Bond Position:  [1.96232855]


portfolio before change:  [0.20623027]
curr_Stock_Price:  102.47322092406935
curr_Factors:  [102.47322092]
mat_Sqrt:  [[0.15]]
grads:  [0.05399612]
Stock Position:  0.0539961245310373
Bond Position:  [-5.32692652]


portfolio before change:  [0.18380544]
curr_Stock_Price:  102.06408247504665
curr_Factors:  [102.06408248]
mat_Sqrt:  [[0.15]]
grads:  [-0.10455551]
Stock Position:  -0.10455550746738837
Bond Position:  [10.85516738]


portfolio before change:  [0.17274835]
curr_Stock_Price:  102.17632481898484
curr_Factors:  [102.17632482]
mat_Sqrt:  [[0.15]]
grads:  [0.02919308]
Stock Position:  0.029193084930009945
Bond Position:  [-2.81009377]


portfolio before change:  [0.17130003]
curr_Stock_Price:  102.13272935715268
curr_Factors:  [102.13272936]
mat_Sqrt:  [[0.15]]
grads:  [0.16967033]
Stock Position:  0.16967033481765964
Bond Position:  [-17.15759435]


portfolio before change:  [-0.09180778]
curr_Stock_Price:  100.58834962247704
curr_Factors:  [100.58834962]
mat_Sqrt:  [[0.15]]
grads:  [0.03708753]
Stock Position:  0.037087531533635455
Bond Position:  [-3.82238137]


portfolio before change:  [-0.07738084]
curr_Stock_Price:  100.98378835989793
curr_Factors:  [100.98378836]
mat_Sqrt:  [[0.15]]
grads:  [0.06942936]
Stock Position:  0.06942936149191503
Bond Position:  [-7.08862078]


portfolio before change:  [-0.06735774]
curr_Stock_Price:  101.13453373214445
curr_Factors:  [101.13453373]
mat_Sqrt:  [[0.15]]
grads:  [0.01085334]
Stock Position:  0.010853336187426135
Bond Position:  [-1.16500483]


portfolio before change:  [-0.06830909]
curr_Stock_Price:  101.0535876697839
curr_Factors:  [101.05358767]
mat_Sqrt:  [[0.15]]
grads:  [0.01892446]
Stock Position:  0.018924455966321335
Bond Position:  [-1.98069326]


portfolio before change:  [-0.08432864]
curr_Stock_Price:  100.213629147779
curr_Factors:  [100.21362915]
mat_Sqrt:  [[0.15]]
grads:  [0.14375185]
Stock Position:  0.14375185260001108
Bond Position:  [-14.49022349]


portfolio before change:  [-0.11909662]
curr_Stock_Price:  99.97806827872675
curr_Factors:  [99.97806828]
mat_Sqrt:  [[0.15]]
grads:  [0.00670846]
Stock Position:  0.006708461125305264
Bond Position:  [-0.7897956]


portfolio before change:  [-0.11790222]
curr_Stock_Price:  100.1634705814802
curr_Factors:  [100.16347058]
mat_Sqrt:  [[0.15]]
grads:  [-0.10659249]
Stock Position:  -0.10659248706806129
Bond Position:  [10.55877122]


portfolio before change:  [-0.0628965]
curr_Stock_Price:  99.65362437221057
curr_Factors:  [99.65362437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054456]
Stock Position:  -0.030544564622258706
Bond Position:  [2.98098007]


portfolio before change:  [-0.06298217]
curr_Stock_Price:  99.66252907723343
curr_Factors:  [99.66252908]
mat_Sqrt:  [[0.15]]
grads:  [0.00810711]
Stock Position:  0.00810710847530835
Bond Position:  [-0.87095711]


portfolio before change:  [-0.06665432]
curr_Stock_Price:  99.21629021936795
curr_Factors:  [99.21629022]
mat_Sqrt:  [[0.15]]
grads:  [0.01850051]
Stock Position:  0.018500507364250785
Bond Position:  [-1.90220602]


portfolio before change:  [-0.06096271]
curr_Stock_Price:  99.53036233544985
curr_Factors:  [99.53036234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033019]
Stock Position:  -0.010330186809176292
Bond Position:  [0.96720452]


portfolio before change:  [-0.06697343]
curr_Stock_Price:  100.11807342083142
curr_Factors:  [100.11807342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02733489]
Stock Position:  -0.027334889662579565
Bond Position:  [2.66974306]


portfolio before change:  [-0.08277225]
curr_Stock_Price:  100.70215068507402
curr_Factors:  [100.70215069]
mat_Sqrt:  [[0.15]]
grads:  [0.09321873]
Stock Position:  0.09321873042549343
Bond Position:  [-9.47009889]


portfolio before change:  [-0.09768253]
curr_Stock_Price:  100.54855083468071
curr_Factors:  [100.54855083]
mat_Sqrt:  [[0.15]]
grads:  [-0.11462265]
Stock Position:  -0.11462264941750405
Bond Position:  [11.42745876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.1027932]
Stock Price:  100.59936891259778
PL:  [-0.70216211]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.24973791e-02]
 [-2.28433731e-02]
 [ 3.72133288e-02]
 [-9.45678177e-03]
 [ 1.35533663e-02]
 [-9.55589492e-03]
 [-8.18639623e-04]
 [ 4.40022717e-02]
 [-2.08929713e-02]
 [-1.32972006e-02]
 [ 5.45950722e-03]
 [-5.15149258e-03]
 [ 4.76542516e-04]
 [-8.75017523e-03]
 [ 7.07467287e-03]
 [-3.85793208e-04]
 [-4.78230962e-02]
 [-9.09784341e-03]
 [ 2.40429081e-02]
 [-3.43254277e-03]
 [-2.51099085e-02]
 [ 5.89325045e-03]
 [ 1.43711863e-02]
 [ 1.46849544e-02]
 [ 4.88050384e-03]
 [ 4.44383885e-03]
 [ 2.72296027e-04]
 [ 1.31718747e-02]
 [-1.22516604e-02]
 [ 5.18374234e-02]
 [-6.87798484e-03]
 [ 1.80489633e-02]
 [ 1.21632089e-02]
 [-1.96842777e-02]
 [-1.18525985e-02]
 [-9.59086080e-03]
 [ 9.31791303e-03]
 [-1.87527877e-03]
 [ 1.32441067e-02]
 [-8.08853144e-03]
 [ 6.89866578e-03]
 [ 3.57861513e-02]
 [-3.37150686e-03]
 [ 1.39461135e-02]
 [-4.86103586e-02]
 [ 2.22895650e-02]
 [ 9.69444489e-03]
 [ 5.31453837e-03]
 [-7.69903621e-03]
 [-3.88685306e-04]
 [-4.52699895e-03]
 [-7.32105183e-05]
 [ 5.38339987e-04]
 [ 6.33457048e-03]
 [-1.01988671e-02]
 [-4.96514511e-03]
 [-1.36761585e-03]
 [ 1.28866467e-02]
 [ 7.26882653e-03]
 [-3.11301245e-03]
 [-4.87662607e-03]
 [-9.18133297e-05]
 [-5.44499574e-03]
 [-2.88553128e-03]
 [ 1.89136452e-02]
 [ 4.11728178e-03]
 [ 1.42441915e-02]
 [-1.66132376e-03]
 [ 5.19661425e-03]
 [ 2.54103191e-02]
 [ 3.24606726e-03]
 [-1.53521884e-02]
 [-5.80704345e-03]
 [ 2.68831769e-03]
 [ 1.11364649e-02]
 [ 9.98194097e-03]
 [ 1.17499925e-03]
 [-1.93588282e-02]
 [-3.23912461e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.50924311]
curr_Stock_Price:  99.2942434403906
curr_Factors:  [99.29424344]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331586]
Stock Position:  -0.08331586064462831
Bond Position:  [-5.23645776]


portfolio before change:  [-13.45514936]
curr_Stock_Price:  98.64105404216403
curr_Factors:  [98.64105404]
mat_Sqrt:  [[0.15]]
grads:  [-0.15228915]
Stock Position:  -0.1522891543161792
Bond Position:  [1.56681334]


portfolio before change:  [-13.48618502]
curr_Stock_Price:  98.84549139204954
curr_Factors:  [98.84549139]
mat_Sqrt:  [[0.15]]
grads:  [0.24808886]
Stock Position:  0.24808885855612414
Bond Position:  [-38.00865016]


portfolio before change:  [-13.37674168]
curr_Stock_Price:  99.29621278879134
curr_Factors:  [99.29621279]
mat_Sqrt:  [[0.15]]
grads:  [-0.06304521]
Stock Position:  -0.06304521178378318
Bond Position:  [-7.11659092]


portfolio before change:  [-13.40587438]
curr_Stock_Price:  99.75124959027589
curr_Factors:  [99.75124959]
mat_Sqrt:  [[0.15]]
grads:  [0.09035578]
Stock Position:  0.09035577504797491
Bond Position:  [-22.41897584]


portfolio before change:  [-13.41462297]
curr_Stock_Price:  99.6699336835956
curr_Factors:  [99.66993368]
mat_Sqrt:  [[0.15]]
grads:  [-0.06370597]
Stock Position:  -0.06370596612284042
Bond Position:  [-7.06505355]


portfolio before change:  [-13.39703937]
curr_Stock_Price:  99.38699034999857
curr_Factors:  [99.38699035]
mat_Sqrt:  [[0.15]]
grads:  [-0.0054576]
Stock Position:  -0.00545759748577192
Bond Position:  [-12.85462518]


portfolio before change:  [-13.39119337]
curr_Stock_Price:  98.1686083818704
curr_Factors:  [98.16860838]
mat_Sqrt:  [[0.15]]
grads:  [0.29334848]
Stock Position:  0.2933484780531173
Bond Position:  [-42.18880523]


portfolio before change:  [-13.50556517]
curr_Stock_Price:  97.78771356272003
curr_Factors:  [97.78771356]
mat_Sqrt:  [[0.15]]
grads:  [-0.13928648]
Stock Position:  -0.13928647561823973
Bond Position:  [0.11494081]


portfolio before change:  [-13.51440534]
curr_Stock_Price:  97.85123268270584
curr_Factors:  [97.85123268]
mat_Sqrt:  [[0.15]]
grads:  [-0.088648]
Stock Position:  -0.08864800381719477
Bond Position:  [-4.84008889]


portfolio before change:  [-13.486619]
curr_Stock_Price:  97.53437438696018
curr_Factors:  [97.53437439]
mat_Sqrt:  [[0.15]]
grads:  [0.03639671]
Stock Position:  0.03639671478917404
Bond Position:  [-17.0365498]


portfolio before change:  [-13.51529498]
curr_Stock_Price:  96.77575737918718
curr_Factors:  [96.77575738]
mat_Sqrt:  [[0.15]]
grads:  [-0.03434328]
Stock Position:  -0.03434328385733797
Bond Position:  [-10.19169768]


portfolio before change:  [-13.51003449]
curr_Stock_Price:  96.60403566448868
curr_Factors:  [96.60403566]
mat_Sqrt:  [[0.15]]
grads:  [0.00317695]
Stock Position:  0.0031769501053189693
Bond Position:  [-13.8169407]


portfolio before change:  [-13.51082361]
curr_Stock_Price:  96.62747646407628
curr_Factors:  [96.62747646]
mat_Sqrt:  [[0.15]]
grads:  [-0.0583345]
Stock Position:  -0.058334501526166725
Bond Position:  [-7.87410794]


portfolio before change:  [-13.51387697]
curr_Stock_Price:  96.6713820316287
curr_Factors:  [96.67138203]
mat_Sqrt:  [[0.15]]
grads:  [0.04716449]
Stock Position:  0.0471644857859818
Bond Position:  [-18.07333299]


portfolio before change:  [-13.53768556]
curr_Stock_Price:  96.19053338604465
curr_Factors:  [96.19053339]
mat_Sqrt:  [[0.15]]
grads:  [-0.00257195]
Stock Position:  -0.002571954717374992
Bond Position:  [-13.29028787]


portfolio before change:  [-13.53839633]
curr_Stock_Price:  96.1439155228641
curr_Factors:  [96.14391552]
mat_Sqrt:  [[0.15]]
grads:  [-0.31882064]
Stock Position:  -0.31882064113455266
Bond Position:  [17.11426845]


portfolio before change:  [-13.48334895]
curr_Stock_Price:  95.97461120557408
curr_Factors:  [95.97461121]
mat_Sqrt:  [[0.15]]
grads:  [-0.06065229]
Stock Position:  -0.060652289428336816
Bond Position:  [-7.66226905]


portfolio before change:  [-13.54505488]
curr_Stock_Price:  96.98408718141863
curr_Factors:  [96.98408718]
mat_Sqrt:  [[0.15]]
grads:  [0.16028605]
Stock Position:  0.1602860540242211
Bond Position:  [-29.09025152]


portfolio before change:  [-13.54181893]
curr_Stock_Price:  97.0156192853978
curr_Factors:  [97.01561929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02288362]
Stock Position:  -0.022883618485009492
Bond Position:  [-11.32175051]


portfolio before change:  [-13.52231983]
curr_Stock_Price:  96.13259774422438
curr_Factors:  [96.13259774]
mat_Sqrt:  [[0.15]]
grads:  [-0.16739939]
Stock Position:  -0.16739938992764877
Bond Position:  [2.57021839]


portfolio before change:  [-13.59456809]
curr_Stock_Price:  96.56514950475471
curr_Factors:  [96.5651495]
mat_Sqrt:  [[0.15]]
grads:  [0.03928834]
Stock Position:  0.03928833636349536
Bond Position:  [-17.38845216]


portfolio before change:  [-13.60960994]
curr_Stock_Price:  96.20995389074228
curr_Factors:  [96.20995389]
mat_Sqrt:  [[0.15]]
grads:  [0.09580791]
Stock Position:  0.09580790856100625
Bond Position:  [-22.82728441]


portfolio before change:  [-13.57757545]
curr_Stock_Price:  96.55920736659694
curr_Factors:  [96.55920737]
mat_Sqrt:  [[0.15]]
grads:  [0.0978997]
Stock Position:  0.09789969627213099
Bond Position:  [-23.03069252]


portfolio before change:  [-13.53471749]
curr_Stock_Price:  97.01168496363196
curr_Factors:  [97.01168496]
mat_Sqrt:  [[0.15]]
grads:  [0.03253669]
Stock Position:  0.032536692244515115
Bond Position:  [-16.69115683]


portfolio before change:  [-13.55298437]
curr_Stock_Price:  96.48232421892813
curr_Factors:  [96.48232422]
mat_Sqrt:  [[0.15]]
grads:  [0.02962559]
Stock Position:  0.029625592338457882
Bond Position:  [-16.41133037]


portfolio before change:  [-13.56261525]
curr_Stock_Price:  96.19186130411678
curr_Factors:  [96.1918613]
mat_Sqrt:  [[0.15]]
grads:  [0.00181531]
Stock Position:  0.0018153068477304419
Bond Position:  [-13.73723299]


portfolio before change:  [-13.56266638]
curr_Stock_Price:  96.63667132102275
curr_Factors:  [96.63667132]
mat_Sqrt:  [[0.15]]
grads:  [0.0878125]
Stock Position:  0.08781249815289277
Bond Position:  [-22.0485739]


portfolio before change:  [-13.60611057]
curr_Stock_Price:  96.1576266202263
curr_Factors:  [96.15762662]
mat_Sqrt:  [[0.15]]
grads:  [-0.08167774]
Stock Position:  -0.08167773594926275
Bond Position:  [-5.75217334]


portfolio before change:  [-13.62197198]
curr_Stock_Price:  96.34741985475476
curr_Factors:  [96.34741985]
mat_Sqrt:  [[0.15]]
grads:  [0.34558282]
Stock Position:  0.34558282284269387
Bond Position:  [-46.9179853]


portfolio before change:  [-13.47699049]
curr_Stock_Price:  96.77543288822093
curr_Factors:  [96.77543289]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585323]
Stock Position:  -0.04585323227623986
Bond Position:  [-9.03952409]


portfolio before change:  [-13.5016268]
curr_Stock_Price:  97.30039752974417
curr_Factors:  [97.30039753]
mat_Sqrt:  [[0.15]]
grads:  [0.12032642]
Stock Position:  0.12032642213760512
Bond Position:  [-25.20943551]


portfolio before change:  [-13.54880816]
curr_Stock_Price:  96.92138086879926
curr_Factors:  [96.92138087]
mat_Sqrt:  [[0.15]]
grads:  [0.08108806]
Stock Position:  0.08108805920942139
Bond Position:  [-21.40797483]


portfolio before change:  [-13.59766362]
curr_Stock_Price:  96.33538314830776
curr_Factors:  [96.33538315]
mat_Sqrt:  [[0.15]]
grads:  [-0.13122852]
Stock Position:  -0.131228518003747
Bond Position:  [-0.95571406]


portfolio before change:  [-13.62534243]
curr_Stock_Price:  96.54584863853749
curr_Factors:  [96.54584864]
mat_Sqrt:  [[0.15]]
grads:  [-0.07901732]
Stock Position:  -0.07901732329796912
Bond Position:  [-5.99654789]


portfolio before change:  [-13.63117447]
curr_Stock_Price:  96.61491256736356
curr_Factors:  [96.61491257]
mat_Sqrt:  [[0.15]]
grads:  [-0.06393907]
Stock Position:  -0.06393907196826794
Bond Position:  [-7.45370662]


portfolio before change:  [-13.62272012]
curr_Stock_Price:  96.47540128261404
curr_Factors:  [96.47540128]
mat_Sqrt:  [[0.15]]
grads:  [0.06211942]
Stock Position:  0.062119420221098634
Bond Position:  [-19.61571611]


portfolio before change:  [-13.60922431]
curr_Stock_Price:  96.7123937062495
curr_Factors:  [96.71239371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01250186]
Stock Position:  -0.012501858434717985
Bond Position:  [-12.40013965]


portfolio before change:  [-13.60461195]
curr_Stock_Price:  96.28146647208506
curr_Factors:  [96.28146647]
mat_Sqrt:  [[0.15]]
grads:  [0.08829404]
Stock Position:  0.08829404441834554
Bond Position:  [-22.10569203]


portfolio before change:  [-13.57096027]
curr_Stock_Price:  96.67824669776911
curr_Factors:  [96.6782467]
mat_Sqrt:  [[0.15]]
grads:  [-0.05392354]
Stock Position:  -0.053923542930401594
Bond Position:  [-8.35772668]


portfolio before change:  [-13.5333388]
curr_Stock_Price:  95.97087765225089
curr_Factors:  [95.97087765]
mat_Sqrt:  [[0.15]]
grads:  [0.04599111]
Stock Position:  0.04599110517384727
Bond Position:  [-17.94714553]


portfolio before change:  [-13.55776315]
curr_Stock_Price:  95.46420090216454
curr_Factors:  [95.4642009]
mat_Sqrt:  [[0.15]]
grads:  [0.23857434]
Stock Position:  0.23857434222544707
Bond Position:  [-36.33307209]


portfolio before change:  [-13.46172088]
curr_Stock_Price:  95.876286955967
curr_Factors:  [95.87628696]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247671]
Stock Position:  -0.022476712368079934
Bond Position:  [-11.30673716]


portfolio before change:  [-13.46844216]
curr_Stock_Price:  96.1438788897172
curr_Factors:  [96.14387889]
mat_Sqrt:  [[0.15]]
grads:  [0.09297409]
Stock Position:  0.09297408969661354
Bond Position:  [-22.40733178]


portfolio before change:  [-13.51520242]
curr_Stock_Price:  95.65600360317421
curr_Factors:  [95.6560036]
mat_Sqrt:  [[0.15]]
grads:  [-0.32406906]
Stock Position:  -0.3240690572569932
Bond Position:  [17.48394848]


portfolio before change:  [-13.51588169]
curr_Stock_Price:  95.66147172578916
curr_Factors:  [95.66147173]
mat_Sqrt:  [[0.15]]
grads:  [0.1485971]
Stock Position:  0.14859709984883185
Bond Position:  [-27.73089896]


portfolio before change:  [-13.37469468]
curr_Stock_Price:  96.62326872131223
curr_Factors:  [96.62326872]
mat_Sqrt:  [[0.15]]
grads:  [0.06462963]
Stock Position:  0.06462963260280298
Bond Position:  [-19.61942104]


portfolio before change:  [-13.35708742]
curr_Stock_Price:  96.91467562299155
curr_Factors:  [96.91467562]
mat_Sqrt:  [[0.15]]
grads:  [0.03543026]
Stock Position:  0.03543025582961529
Bond Position:  [-16.79079917]


portfolio before change:  [-13.34685356]
curr_Stock_Price:  97.23314100675134
curr_Factors:  [97.23314101]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132691]
Stock Position:  -0.051326908045690456
Bond Position:  [-8.35617708]


portfolio before change:  [-13.3424437]
curr_Stock_Price:  97.13704825136976
curr_Factors:  [97.13704825]
mat_Sqrt:  [[0.15]]
grads:  [-0.00259124]
Stock Position:  -0.002591235373176389
Bond Position:  [-13.09073874]


portfolio before change:  [-13.34334415]
curr_Stock_Price:  97.16879381571552
curr_Factors:  [97.16879382]
mat_Sqrt:  [[0.15]]
grads:  [-0.03017999]
Stock Position:  -0.030179993009191188
Bond Position:  [-10.41079064]


portfolio before change:  [-13.33400768]
curr_Stock_Price:  96.83787363190807
curr_Factors:  [96.83787363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00048807]
Stock Position:  -0.00048807012204603317
Bond Position:  [-13.28674401]


portfolio before change:  [-13.33489732]
curr_Stock_Price:  96.95914800592627
curr_Factors:  [96.95914801]
mat_Sqrt:  [[0.15]]
grads:  [0.00358893]
Stock Position:  0.0035889332473401764
Bond Position:  [-13.68287723]


portfolio before change:  [-13.33463555]
curr_Stock_Price:  97.27037582404851
curr_Factors:  [97.27037582]
mat_Sqrt:  [[0.15]]
grads:  [0.04223047]
Stock Position:  0.04223046986967656
Bond Position:  [-17.44240922]


portfolio before change:  [-13.35829506]
curr_Stock_Price:  96.73594345027105
curr_Factors:  [96.73594345]
mat_Sqrt:  [[0.15]]
grads:  [-0.06799245]
Stock Position:  -0.06799244731998014
Bond Position:  [-6.78098152]


portfolio before change:  [-13.32328466]
curr_Stock_Price:  96.21479401554046
curr_Factors:  [96.21479402]
mat_Sqrt:  [[0.15]]
grads:  [-0.03310097]
Stock Position:  -0.03310096738241063
Bond Position:  [-10.1384819]


portfolio before change:  [-13.33634275]
curr_Stock_Price:  96.59014285696625
curr_Factors:  [96.59014286]
mat_Sqrt:  [[0.15]]
grads:  [-0.00911744]
Stock Position:  -0.009117439000131733
Bond Position:  [-12.45568801]


portfolio before change:  [-13.33416942]
curr_Stock_Price:  96.26638650453121
curr_Factors:  [96.2663865]
mat_Sqrt:  [[0.15]]
grads:  [0.08591098]
Stock Position:  0.08591097827191382
Bond Position:  [-21.60450886]


portfolio before change:  [-13.33347793]
curr_Stock_Price:  96.29015313079564
curr_Factors:  [96.29015313]
mat_Sqrt:  [[0.15]]
grads:  [0.04845884]
Stock Position:  0.04845884356159169
Bond Position:  [-17.9995874]


portfolio before change:  [-13.3232242]
curr_Stock_Price:  96.52496559029542
curr_Factors:  [96.52496559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02075342]
Stock Position:  -0.02075341630110909
Bond Position:  [-11.32000141]


portfolio before change:  [-13.34240213]
curr_Stock_Price:  97.4149590486344
curr_Factors:  [97.41495905]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251084]
Stock Position:  -0.03251084048700021
Bond Position:  [-10.17535993]


portfolio before change:  [-13.3588274]
curr_Stock_Price:  97.90062133877137
curr_Factors:  [97.90062134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00061209]
Stock Position:  -0.0006120888648105938
Bond Position:  [-13.29890352]


portfolio before change:  [-13.35962059]
curr_Stock_Price:  97.8385174836708
curr_Factors:  [97.83851748]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629997]
Stock Position:  -0.03629997158800045
Bond Position:  [-9.80808519]


portfolio before change:  [-13.30746509]
curr_Stock_Price:  96.38483781219551
curr_Factors:  [96.38483781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923688]
Stock Position:  -0.019236875217000925
Bond Position:  [-11.45332199]


portfolio before change:  [-13.31041352]
curr_Stock_Price:  96.50089492451953
curr_Factors:  [96.50089492]
mat_Sqrt:  [[0.15]]
grads:  [0.12609097]
Stock Position:  0.1260909679341834
Bond Position:  [-25.47830476]


portfolio before change:  [-13.20416625]
curr_Stock_Price:  97.35614814974025
curr_Factors:  [97.35614815]
mat_Sqrt:  [[0.15]]
grads:  [0.02744855]
Stock Position:  0.027448545196342447
Bond Position:  [-15.87645089]


portfolio before change:  [-13.21188833]
curr_Stock_Price:  97.11097064412732
curr_Factors:  [97.11097064]
mat_Sqrt:  [[0.15]]
grads:  [0.09496128]
Stock Position:  0.0949612768421
Bond Position:  [-22.4336701]


portfolio before change:  [-13.219462]
curr_Stock_Price:  97.0459808036181
curr_Factors:  [97.0459808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01107549]
Stock Position:  -0.011075491724677772
Bond Position:  [-12.14463004]


portfolio before change:  [-13.21404623]
curr_Stock_Price:  96.48845927874397
curr_Factors:  [96.48845928]
mat_Sqrt:  [[0.15]]
grads:  [0.03464409]
Stock Position:  0.03464409499589765
Bond Position:  [-16.55680158]


portfolio before change:  [-13.23228295]
curr_Stock_Price:  95.9919278806044
curr_Factors:  [95.99192788]
mat_Sqrt:  [[0.15]]
grads:  [0.16940213]
Stock Position:  0.16940212750882935
Bond Position:  [-29.49351975]


portfolio before change:  [-13.2233389]
curr_Stock_Price:  96.05560743407942
curr_Factors:  [96.05560743]
mat_Sqrt:  [[0.15]]
grads:  [0.02164045]
Stock Position:  0.021640448424313712
Bond Position:  [-15.30202532]


portfolio before change:  [-13.22556971]
curr_Stock_Price:  95.99671732126261
curr_Factors:  [95.99671732]
mat_Sqrt:  [[0.15]]
grads:  [-0.10234792]
Stock Position:  -0.10234792295932695
Bond Position:  [-3.40050508]


portfolio before change:  [-13.17885672]
curr_Stock_Price:  95.53822699434419
curr_Factors:  [95.53822699]
mat_Sqrt:  [[0.15]]
grads:  [-0.03871362]
Stock Position:  -0.03871362301385584
Bond Position:  [-9.48022581]


portfolio before change:  [-13.15477294]
curr_Stock_Price:  94.90082057404955
curr_Factors:  [94.90082057]
mat_Sqrt:  [[0.15]]
grads:  [0.01792212]
Stock Position:  0.017922117935296744
Bond Position:  [-14.85559664]


portfolio before change:  [-13.14713938]
curr_Stock_Price:  95.37855767004478
curr_Factors:  [95.37855767]
mat_Sqrt:  [[0.15]]
grads:  [0.0742431]
Stock Position:  0.07424309930423241
Bond Position:  [-20.22833911]


portfolio before change:  [-13.2026768]
curr_Stock_Price:  94.64753884607995
curr_Factors:  [94.64753885]
mat_Sqrt:  [[0.15]]
grads:  [0.06654627]
Stock Position:  0.06654627313408203
Bond Position:  [-19.50111777]


portfolio before change:  [-13.1893962]
curr_Stock_Price:  94.8654240895138
curr_Factors:  [94.86542409]
mat_Sqrt:  [[0.15]]
grads:  [0.00783333]
Stock Position:  0.007833328319859986
Bond Position:  [-13.93250822]


portfolio before change:  [-13.18703415]
curr_Stock_Price:  95.27812953090644
curr_Factors:  [95.27812953]
mat_Sqrt:  [[0.15]]
grads:  [-0.12905885]
Stock Position:  -0.12905885469335562
Bond Position:  [-0.89054788]


portfolio before change:  [-13.09973653]
curr_Stock_Price:  94.60128110470423
curr_Factors:  [94.6012811]
mat_Sqrt:  [[0.15]]
grads:  [-0.21594164]
Stock Position:  -0.21594164088794984
Bond Position:  [7.32861934]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.10099361]
Stock Price:  94.60922368494896
PL:  [-13.10099361]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.05889830e-03]
 [ 4.35957540e-02]
 [ 1.84330276e-02]
 [-3.91213294e-02]
 [-3.36068812e-02]
 [-1.39695425e-03]
 [ 9.07675646e-03]
 [-4.59016488e-02]
 [ 1.65078301e-02]
 [-4.90545294e-03]
 [-9.52602483e-03]
 [ 1.93956341e-02]
 [-4.75920870e-03]
 [ 4.79087074e-03]
 [ 9.36567691e-03]
 [ 1.13582263e-02]
 [ 7.84023280e-02]
 [-1.09945150e-02]
 [ 2.36993094e-02]
 [ 1.01420044e-03]
 [-4.99058957e-03]
 [ 5.44749704e-03]
 [ 1.25300438e-02]
 [ 3.22781518e-02]
 [ 1.11566226e-03]
 [ 8.40133335e-03]
 [ 5.58422008e-02]
 [ 2.12003455e-02]
 [ 1.52153711e-02]
 [-7.22693305e-03]
 [ 9.48515659e-04]
 [ 1.49961405e-02]
 [ 1.59734520e-02]
 [-9.28517798e-03]
 [ 3.97686768e-03]
 [-1.66564028e-02]
 [-9.66907863e-03]
 [-1.70116720e-02]
 [ 1.82219523e-02]
 [-6.92006883e-02]
 [ 3.18616893e-03]
 [-6.50954720e-03]
 [-1.82150023e-02]
 [ 2.04065890e-02]
 [-6.54261449e-03]
 [ 1.16923476e-02]
 [ 1.03434579e-02]
 [-3.71072759e-03]
 [ 1.48648493e-02]
 [-1.60721652e-03]
 [ 1.81753685e-02]
 [ 2.46723680e-02]
 [-9.77780526e-03]
 [-7.97753126e-02]
 [-2.67718919e-02]
 [-2.06718011e-03]
 [-3.07541363e-03]
 [-1.55902477e-02]
 [ 8.12462642e-04]
 [-3.04439072e-03]
 [-7.50985825e-03]
 [-5.89937187e-03]
 [-1.62426299e-02]
 [-5.51655229e-04]
 [-1.09606657e-02]
 [ 3.40555625e-02]
 [-6.51319803e-03]
 [ 2.12664117e-02]
 [ 9.38137821e-03]
 [ 1.18548817e-02]
 [ 7.97029794e-03]
 [-1.45305539e-02]
 [-4.64761446e-02]
 [ 6.06474724e-04]
 [-3.25934966e-03]
 [-2.27196333e-02]
 [-4.26746520e-03]
 [ 1.21218122e-02]
 [-1.87877661e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.05790202]
curr_Stock_Price:  100.27377897517947
curr_Factors:  [100.27377898]
mat_Sqrt:  [[0.15]]
grads:  [-0.02039266]
Stock Position:  -0.020392655365618875
Bond Position:  [10.10275064]


portfolio before change:  [8.041381]
curr_Stock_Price:  101.11488901766866
curr_Factors:  [101.11488902]
mat_Sqrt:  [[0.15]]
grads:  [0.29063836]
Stock Position:  0.2906383598151713
Bond Position:  [-21.3464845]


portfolio before change:  [8.12000791]
curr_Stock_Price:  101.39001135559
curr_Factors:  [101.39001136]
mat_Sqrt:  [[0.15]]
grads:  [0.12288685]
Stock Position:  0.12288685085657929
Bond Position:  [-4.3394913]


portfolio before change:  [8.20122525]
curr_Stock_Price:  102.05313008755125
curr_Factors:  [102.05313009]
mat_Sqrt:  [[0.15]]
grads:  [-0.26080886]
Stock Position:  -0.2608088624940552
Bond Position:  [34.81758602]


portfolio before change:  [8.36386928]
curr_Stock_Price:  101.43786010398536
curr_Factors:  [101.4378601]
mat_Sqrt:  [[0.15]]
grads:  [-0.22404587]
Stock Position:  -0.22404587449662686
Bond Position:  [31.09060336]


portfolio before change:  [8.20484253]
curr_Stock_Price:  102.15632893578787
curr_Factors:  [102.15632894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00931303]
Stock Position:  -0.009313028326633329
Bond Position:  [9.15622732]


portfolio before change:  [8.20590692]
curr_Stock_Price:  102.10348834118135
curr_Factors:  [102.10348834]
mat_Sqrt:  [[0.15]]
grads:  [0.06051171]
Stock Position:  0.060511709751177326
Bond Position:  [2.02745027]


portfolio before change:  [8.20688777]
curr_Stock_Price:  102.11760354375197
curr_Factors:  [102.11760354]
mat_Sqrt:  [[0.15]]
grads:  [-0.30601099]
Stock Position:  -0.30601099214877636
Bond Position:  [39.45599695]


portfolio before change:  [8.32248496]
curr_Stock_Price:  101.74790732321873
curr_Factors:  [101.74790732]
mat_Sqrt:  [[0.15]]
grads:  [0.1100522]
Stock Position:  0.11005220051511509
Bond Position:  [-2.87509614]


portfolio before change:  [8.30312418]
curr_Stock_Price:  101.5736165599581
curr_Factors:  [101.57361656]
mat_Sqrt:  [[0.15]]
grads:  [-0.03270302]
Stock Position:  -0.032703019584772605
Bond Position:  [11.62488815]


portfolio before change:  [8.29893605]
curr_Stock_Price:  101.72389947129263
curr_Factors:  [101.72389947]
mat_Sqrt:  [[0.15]]
grads:  [-0.06350683]
Stock Position:  -0.0635068321753034
Bond Position:  [14.75909866]


portfolio before change:  [8.25205215]
curr_Stock_Price:  102.47667477962271
curr_Factors:  [102.47667478]
mat_Sqrt:  [[0.15]]
grads:  [0.12930423]
Stock Position:  0.12930422751957132
Bond Position:  [-4.99861512]


portfolio before change:  [8.31054332]
curr_Stock_Price:  102.93144411149305
curr_Factors:  [102.93144411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03172806]
Stock Position:  -0.03172805802746915
Bond Position:  [11.57635815]


portfolio before change:  [8.30691364]
curr_Stock_Price:  103.06864836974896
curr_Factors:  [103.06864837]
mat_Sqrt:  [[0.15]]
grads:  [0.03193914]
Stock Position:  0.031939138270735135
Bond Position:  [5.01498983]


portfolio before change:  [8.29968121]
curr_Stock_Price:  102.83239038758936
curr_Factors:  [102.83239039]
mat_Sqrt:  [[0.15]]
grads:  [0.06243785]
Stock Position:  0.0624378460496954
Bond Position:  [1.87904825]


portfolio before change:  [8.25869196]
curr_Stock_Price:  102.17402859477734
curr_Factors:  [102.17402859]
mat_Sqrt:  [[0.15]]
grads:  [0.07572151]
Stock Position:  0.07572150864956301
Bond Position:  [0.52192037]


portfolio before change:  [8.2222895]
curr_Stock_Price:  101.69285638649204
curr_Factors:  [101.69285639]
mat_Sqrt:  [[0.15]]
grads:  [0.52268219]
Stock Position:  0.5226821865894322
Bond Position:  [-44.93075504]


portfolio before change:  [8.74459685]
curr_Stock_Price:  102.6975120337563
curr_Factors:  [102.69751203]
mat_Sqrt:  [[0.15]]
grads:  [-0.07329677]
Stock Position:  -0.07329676652033909
Bond Position:  [16.27199241]


portfolio before change:  [8.73052257]
curr_Stock_Price:  102.9034053030246
curr_Factors:  [102.9034053]
mat_Sqrt:  [[0.15]]
grads:  [0.1579954]
Stock Position:  0.15799539621345907
Bond Position:  [-7.52774172]


portfolio before change:  [8.6213607]
curr_Stock_Price:  102.2154651737615
curr_Factors:  [102.21546517]
mat_Sqrt:  [[0.15]]
grads:  [0.00676134]
Stock Position:  0.00676133626512249
Bond Position:  [7.93024757]


portfolio before change:  [8.62023199]
curr_Stock_Price:  101.97522169852616
curr_Factors:  [101.9752217]
mat_Sqrt:  [[0.15]]
grads:  [-0.0332706]
Stock Position:  -0.0332705971333286
Bond Position:  [12.01300851]


portfolio before change:  [8.60529393]
curr_Stock_Price:  102.44677598147204
curr_Factors:  [102.44677598]
mat_Sqrt:  [[0.15]]
grads:  [0.03631665]
Stock Position:  0.036316646924919746
Bond Position:  [4.88477054]


portfolio before change:  [8.57442091]
curr_Stock_Price:  101.5882624999195
curr_Factors:  [101.5882625]
mat_Sqrt:  [[0.15]]
grads:  [0.08353363]
Stock Position:  0.0835336250810667
Bond Position:  [0.08838507]


portfolio before change:  [8.63537555]
curr_Stock_Price:  102.3178982420123
curr_Factors:  [102.31789824]
mat_Sqrt:  [[0.15]]
grads:  [0.21518768]
Stock Position:  0.21518767850914408
Bond Position:  [-13.38217544]


portfolio before change:  [8.65529712]
curr_Stock_Price:  102.41436279530679
curr_Factors:  [102.4143628]
mat_Sqrt:  [[0.15]]
grads:  [0.00743775]
Stock Position:  0.0074377484215824045
Bond Position:  [7.89356486]


portfolio before change:  [8.65528132]
curr_Stock_Price:  102.34590565203283
curr_Factors:  [102.34590565]
mat_Sqrt:  [[0.15]]
grads:  [0.05600889]
Stock Position:  0.05600888899731428
Bond Position:  [2.92300085]


portfolio before change:  [8.74128597]
curr_Stock_Price:  103.87819748544646
curr_Factors:  [103.87819749]
mat_Sqrt:  [[0.15]]
grads:  [0.37228134]
Stock Position:  0.37228133878157327
Bond Position:  [-29.93062846]


portfolio before change:  [8.41591599]
curr_Stock_Price:  103.00923300991943
curr_Factors:  [103.00923301]
mat_Sqrt:  [[0.15]]
grads:  [0.14133564]
Stock Position:  0.14133563691627504
Bond Position:  [-6.14295956]


portfolio before change:  [8.46494683]
curr_Stock_Price:  103.35886019961629
curr_Factors:  [103.3588602]
mat_Sqrt:  [[0.15]]
grads:  [0.10143581]
Stock Position:  0.10143580708299377
Bond Position:  [-2.01934258]


portfolio before change:  [8.46625732]
curr_Stock_Price:  103.37302389922547
curr_Factors:  [103.3730239]
mat_Sqrt:  [[0.15]]
grads:  [-0.04817955]
Stock Position:  -0.04817955369647016
Bond Position:  [13.44672348]


portfolio before change:  [8.47778824]
curr_Stock_Price:  103.15113582097679
curr_Factors:  [103.15113582]
mat_Sqrt:  [[0.15]]
grads:  [0.00632344]
Stock Position:  0.0063234377265002206
Bond Position:  [7.82551845]


portfolio before change:  [8.48367802]
curr_Stock_Price:  104.00520837897724
curr_Factors:  [104.00520838]
mat_Sqrt:  [[0.15]]
grads:  [0.09997427]
Stock Position:  0.09997427028271505
Bond Position:  [-1.91416679]


portfolio before change:  [8.55820597]
curr_Stock_Price:  104.75187633392487
curr_Factors:  [104.75187633]
mat_Sqrt:  [[0.15]]
grads:  [0.10648968]
Stock Position:  0.10648968022978925
Bond Position:  [-2.59678785]


portfolio before change:  [8.57305801]
curr_Stock_Price:  104.89286976541737
curr_Factors:  [104.89286977]
mat_Sqrt:  [[0.15]]
grads:  [-0.06190119]
Stock Position:  -0.061901186520777855
Bond Position:  [15.0660511]


portfolio before change:  [8.54301681]
curr_Stock_Price:  105.39339100754214
curr_Factors:  [105.39339101]
mat_Sqrt:  [[0.15]]
grads:  [0.02651245]
Stock Position:  0.026512451227204897
Bond Position:  [5.74877967]


portfolio before change:  [8.54775988]
curr_Stock_Price:  105.55873828585926
curr_Factors:  [105.55873829]
mat_Sqrt:  [[0.15]]
grads:  [-0.11104269]
Stock Position:  -0.11104268529382601
Bond Position:  [20.26928563]


portfolio before change:  [8.6374386]
curr_Stock_Price:  104.76254130929489
curr_Factors:  [104.76254131]
mat_Sqrt:  [[0.15]]
grads:  [-0.06446052]
Stock Position:  -0.06446052418697744
Bond Position:  [15.39048693]


portfolio before change:  [8.54694323]
curr_Stock_Price:  106.18135236088888
curr_Factors:  [106.18135236]
mat_Sqrt:  [[0.15]]
grads:  [-0.11341115]
Stock Position:  -0.11341114682517774
Bond Position:  [20.58909217]


portfolio before change:  [8.53868771]
curr_Stock_Price:  106.26549206779269
curr_Factors:  [106.26549207]
mat_Sqrt:  [[0.15]]
grads:  [0.12147968]
Stock Position:  0.12147968225301112
Bond Position:  [-4.3704105]


portfolio before change:  [8.55314404]
curr_Stock_Price:  106.38674277368766
curr_Factors:  [106.38674277]
mat_Sqrt:  [[0.15]]
grads:  [-0.46133792]
Stock Position:  -0.4613379218184446
Bond Position:  [57.63338286]


portfolio before change:  [8.42373932]
curr_Stock_Price:  106.67504971693788
curr_Factors:  [106.67504972]
mat_Sqrt:  [[0.15]]
grads:  [0.02124113]
Stock Position:  0.021241126208440885
Bond Position:  [6.15784112]


portfolio before change:  [8.43275744]
curr_Stock_Price:  107.08148969856255
curr_Factors:  [107.0814897]
mat_Sqrt:  [[0.15]]
grads:  [-0.04339698]
Stock Position:  -0.04339698132305776
Bond Position:  [13.07977085]


portfolio before change:  [8.46805085]
curr_Stock_Price:  106.2870589500663
curr_Factors:  [106.28705895]
mat_Sqrt:  [[0.15]]
grads:  [-0.12143335]
Stock Position:  -0.12143334873867961
Bond Position:  [21.37484434]


portfolio before change:  [8.4741021]
curr_Stock_Price:  106.24822868810088
curr_Factors:  [106.24822869]
mat_Sqrt:  [[0.15]]
grads:  [0.13604393]
Stock Position:  0.13604392660337536
Bond Position:  [-5.98032412]


portfolio before change:  [8.42391387]
curr_Stock_Price:  105.88206424571825
curr_Factors:  [105.88206425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04361743]
Stock Position:  -0.0436174299238216
Bond Position:  [13.04221739]


portfolio before change:  [8.41483568]
curr_Stock_Price:  106.10888548873167
curr_Factors:  [106.10888549]
mat_Sqrt:  [[0.15]]
grads:  [0.07794898]
Stock Position:  0.07794898397326416
Bond Position:  [0.14375586]


portfolio before change:  [8.54895284]
curr_Stock_Price:  107.82934635255937
curr_Factors:  [107.82934635]
mat_Sqrt:  [[0.15]]
grads:  [0.06895639]
Stock Position:  0.0689563863166294
Bond Position:  [1.11343078]


portfolio before change:  [8.5143642]
curr_Stock_Price:  107.32673541926722
curr_Factors:  [107.32673542]
mat_Sqrt:  [[0.15]]
grads:  [-0.02473818]
Stock Position:  -0.02473818392947427
Bond Position:  [11.16943272]


portfolio before change:  [8.53435524]
curr_Stock_Price:  106.54685073273656
curr_Factors:  [106.54685073]
mat_Sqrt:  [[0.15]]
grads:  [0.099099]
Stock Position:  0.09909899546655614
Bond Position:  [-2.02433064]


portfolio before change:  [8.65007898]
curr_Stock_Price:  107.71588642599835
curr_Factors:  [107.71588643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01071478]
Stock Position:  -0.010714776789733
Bond Position:  [9.80423066]


portfolio before change:  [8.65429986]
curr_Stock_Price:  107.3791456537995
curr_Factors:  [107.37914565]
mat_Sqrt:  [[0.15]]
grads:  [0.12116912]
Stock Position:  0.1211691235115904
Bond Position:  [-4.3567371]


portfolio before change:  [8.61132683]
curr_Stock_Price:  107.0267396765983
curr_Factors:  [107.02673968]
mat_Sqrt:  [[0.15]]
grads:  [0.16448245]
Stock Position:  0.16448245333608258
Bond Position:  [-8.99269388]


portfolio before change:  [8.76946948]
curr_Stock_Price:  107.9916128212889
curr_Factors:  [107.99161282]
mat_Sqrt:  [[0.15]]
grads:  [-0.06518537]
Stock Position:  -0.06518536840989714
Bond Position:  [15.80894254]


portfolio before change:  [8.74617184]
curr_Stock_Price:  108.36417688027666
curr_Factors:  [108.36417688]
mat_Sqrt:  [[0.15]]
grads:  [-0.53183542]
Stock Position:  -0.5318354175485056
Bond Position:  [66.3780791]


portfolio before change:  [8.7309729]
curr_Stock_Price:  108.40055599208257
curr_Factors:  [108.40055599]
mat_Sqrt:  [[0.15]]
grads:  [-0.17847928]
Stock Position:  -0.17847927933528962
Bond Position:  [28.07822601]


portfolio before change:  [8.89866252]
curr_Stock_Price:  107.47084201537656
curr_Factors:  [107.47084202]
mat_Sqrt:  [[0.15]]
grads:  [-0.0137812]
Stock Position:  -0.013781200700552984
Bond Position:  [10.37973977]


portfolio before change:  [8.90379339]
curr_Stock_Price:  107.14560794388899
curr_Factors:  [107.14560794]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050276]
Stock Position:  -0.02050275755593462
Bond Position:  [11.10057382]


portfolio before change:  [8.92549756]
curr_Stock_Price:  106.12085012608995
curr_Factors:  [106.12085013]
mat_Sqrt:  [[0.15]]
grads:  [-0.10393498]
Stock Position:  -0.10393498433699751
Bond Position:  [19.95516646]


portfolio before change:  [8.88844157]
curr_Stock_Price:  106.48938076555984
curr_Factors:  [106.48938077]
mat_Sqrt:  [[0.15]]
grads:  [0.00541642]
Stock Position:  0.0054164176121208425
Bond Position:  [8.31165062]


portfolio before change:  [8.89132171]
curr_Stock_Price:  106.92521213535967
curr_Factors:  [106.92521214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029594]
Stock Position:  -0.020295938104837354
Bond Position:  [11.0614692]


portfolio before change:  [8.88254447]
curr_Stock_Price:  107.39173908259295
curr_Factors:  [107.39173908]
mat_Sqrt:  [[0.15]]
grads:  [-0.05006572]
Stock Position:  -0.050065721652890985
Bond Position:  [14.25918939]


portfolio before change:  [8.83998454]
curr_Stock_Price:  108.25962147018403
curr_Factors:  [108.25962147]
mat_Sqrt:  [[0.15]]
grads:  [-0.03932915]
Stock Position:  -0.03932914581331396
Bond Position:  [13.09774298]


portfolio before change:  [8.82714174]
curr_Stock_Price:  108.60698323377918
curr_Factors:  [108.60698323]
mat_Sqrt:  [[0.15]]
grads:  [-0.1082842]
Stock Position:  -0.10828419949129557
Bond Position:  [20.58756197]


portfolio before change:  [8.81125254]
curr_Stock_Price:  108.76560253124896
curr_Factors:  [108.76560253]
mat_Sqrt:  [[0.15]]
grads:  [-0.0036777]
Stock Position:  -0.0036777015236437905
Bond Position:  [9.21125996]


portfolio before change:  [8.81167686]
curr_Stock_Price:  108.80676949761904
curr_Factors:  [108.8067695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0730711]
Stock Position:  -0.0730711046628707
Bond Position:  [16.7623077]


portfolio before change:  [8.77038476]
curr_Stock_Price:  109.38620198533597
curr_Factors:  [109.38620199]
mat_Sqrt:  [[0.15]]
grads:  [0.22703708]
Stock Position:  0.22703708353035812
Bond Position:  [-16.06433951]


portfolio before change:  [8.7631594]
curr_Stock_Price:  109.3587998112038
curr_Factors:  [109.35879981]
mat_Sqrt:  [[0.15]]
grads:  [-0.04342132]
Stock Position:  -0.04342132017100718
Bond Position:  [13.51166286]


portfolio before change:  [8.81082932]
curr_Stock_Price:  108.28040294886374
curr_Factors:  [108.28040295]
mat_Sqrt:  [[0.15]]
grads:  [0.14177608]
Stock Position:  0.14177607783543475
Bond Position:  [-6.54074152]


portfolio before change:  [8.91286983]
curr_Stock_Price:  109.0030165164734
curr_Factors:  [109.00301652]
mat_Sqrt:  [[0.15]]
grads:  [0.06254252]
Stock Position:  0.06254252143031969
Bond Position:  [2.09554633]


portfolio before change:  [8.93194168]
curr_Stock_Price:  109.30586446342865
curr_Factors:  [109.30586446]
mat_Sqrt:  [[0.15]]
grads:  [0.07903254]
Stock Position:  0.07903254494686554
Bond Position:  [0.29322103]


portfolio before change:  [8.85667855]
curr_Stock_Price:  108.35332706034076
curr_Factors:  [108.35332706]
mat_Sqrt:  [[0.15]]
grads:  [0.05313532]
Stock Position:  0.05313531962770665
Bond Position:  [3.09928988]


portfolio before change:  [8.84656058]
curr_Stock_Price:  108.15926240753966
curr_Factors:  [108.15926241]
mat_Sqrt:  [[0.15]]
grads:  [-0.09687036]
Stock Position:  -0.09687035911301539
Bond Position:  [19.32398717]


portfolio before change:  [8.8563939]
curr_Stock_Price:  108.07022032137345
curr_Factors:  [108.07022032]
mat_Sqrt:  [[0.15]]
grads:  [-0.30984096]
Stock Position:  -0.3098409636738623
Bond Position:  [42.34097511]


portfolio before change:  [9.11927598]
curr_Stock_Price:  107.23031948458566
curr_Factors:  [107.23031948]
mat_Sqrt:  [[0.15]]
grads:  [0.00404316]
Stock Position:  0.00404316482830073
Bond Position:  [8.68572612]


portfolio before change:  [9.11497875]
curr_Stock_Price:  106.03321159677618
curr_Factors:  [106.0332116]
mat_Sqrt:  [[0.15]]
grads:  [-0.021729]
Stock Position:  -0.021728997718804995
Bond Position:  [11.41897416]


portfolio before change:  [9.12076662]
curr_Stock_Price:  105.7996911779034
curr_Factors:  [105.79969118]
mat_Sqrt:  [[0.15]]
grads:  [-0.15146422]
Stock Position:  -0.15146422176669933
Bond Position:  [25.14563451]


portfolio before change:  [9.23718182]
curr_Stock_Price:  105.04146890018045
curr_Factors:  [105.0414689]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844977]
Stock Position:  -0.02844976801881669
Bond Position:  [12.22558724]


portfolio before change:  [9.24143635]
curr_Stock_Price:  104.91878244008642
curr_Factors:  [104.91878244]
mat_Sqrt:  [[0.15]]
grads:  [0.08081208]
Stock Position:  0.08081208141500248
Bond Position:  [0.76273116]


portfolio before change:  [9.22319122]
curr_Stock_Price:  104.69242024390975
curr_Factors:  [104.69242024]
mat_Sqrt:  [[0.15]]
grads:  [-0.00125252]
Stock Position:  -0.0012525177413390642
Bond Position:  [9.35432033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.22365363]
Stock Price:  104.79002518493964
PL:  [4.43362844]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39494903e-02]
 [ 3.89530151e-02]
 [ 1.86670988e-02]
 [-4.23749785e-02]
 [-3.74985602e-02]
 [-1.31997201e-03]
 [-1.74486205e-03]
 [-4.06469262e-02]
 [ 1.65254347e-02]
 [-6.76952798e-03]
 [-8.43559897e-03]
 [ 1.51363860e-02]
 [-4.19853516e-03]
 [ 4.17422165e-03]
 [ 5.77680494e-03]
 [ 9.43610122e-03]
 [ 9.72905314e-02]
 [-1.21587974e-02]
 [ 1.90408796e-02]
 [ 1.71912123e-03]
 [-4.13373686e-03]
 [ 4.43271155e-03]
 [ 1.48373709e-02]
 [ 1.84569628e-02]
 [-4.15280664e-03]
 [ 4.54744911e-03]
 [ 4.60405689e-03]
 [ 8.26131554e-03]
 [ 1.55728980e-02]
 [ 4.22285089e-03]
 [-6.43418935e-03]
 [ 1.12567903e-02]
 [ 1.15140774e-02]
 [-1.70901315e-02]
 [-3.97627702e-03]
 [ 1.82156092e-02]
 [ 6.43526114e-03]
 [-1.34206265e-03]
 [-2.65917007e-02]
 [-1.58468337e-02]
 [ 7.06540110e-03]
 [ 3.40349538e-02]
 [-3.37001877e-03]
 [ 7.40566267e-03]
 [-2.85128557e-02]
 [ 1.95946005e-02]
 [ 9.66380763e-03]
 [ 5.35944017e-03]
 [-8.03577499e-03]
 [-3.23579468e-04]
 [-4.67393610e-03]
 [ 1.49712429e-03]
 [ 6.71162906e-04]
 [ 7.52547894e-03]
 [-1.40882221e-02]
 [-5.28760846e-03]
 [-4.48981098e-03]
 [ 1.44411070e-02]
 [ 5.30078042e-03]
 [-2.13626261e-03]
 [-5.18174148e-03]
 [-5.11922754e-03]
 [ 4.11007068e-03]
 [-7.03286030e-03]
 [ 1.73963351e-02]
 [ 8.71992878e-03]
 [ 2.03836220e-02]
 [-5.02408398e-03]
 [ 8.20280197e-03]
 [ 2.89947310e-02]
 [ 3.04409008e-03]
 [-1.52130273e-02]
 [-5.86777762e-03]
 [ 2.01525606e-03]
 [ 1.02355721e-02]
 [ 3.33953791e-03]
 [-1.58393161e-03]
 [-6.75373173e-03]
 [-2.31428181e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.16737188]
curr_Stock_Price:  99.71853208763501
curr_Factors:  [99.71853209]
mat_Sqrt:  [[0.15]]
grads:  [-0.0929966]
Stock Position:  -0.0929966016718221
Bond Position:  [5.10611273]


portfolio before change:  [-4.28359355]
curr_Stock_Price:  100.97170489197356
curr_Factors:  [100.97170489]
mat_Sqrt:  [[0.15]]
grads:  [0.25968677]
Stock Position:  0.25968676736068425
Bond Position:  [-30.50460919]


portfolio before change:  [-4.19071862]
curr_Stock_Price:  101.33668894826775
curr_Factors:  [101.33668895]
mat_Sqrt:  [[0.15]]
grads:  [0.12444733]
Stock Position:  0.12444732512628519
Bond Position:  [-16.80179849]


portfolio before change:  [-4.07597311]
curr_Stock_Price:  102.2671681703379
curr_Factors:  [102.26716817]
mat_Sqrt:  [[0.15]]
grads:  [-0.28249986]
Stock Position:  -0.28249985633823965
Bond Position:  [24.81448721]


portfolio before change:  [-3.88430981]
curr_Stock_Price:  101.59420376035482
curr_Factors:  [101.59420376]
mat_Sqrt:  [[0.15]]
grads:  [-0.2499904]
Stock Position:  -0.24999040123404173
Bond Position:  [21.51326595]


portfolio before change:  [-3.7107745]
curr_Stock_Price:  100.90541456114163
curr_Factors:  [100.90541456]
mat_Sqrt:  [[0.15]]
grads:  [-0.00879981]
Stock Position:  -0.008799813387756383
Bond Position:  [-2.82282568]


portfolio before change:  [-3.71619936]
curr_Stock_Price:  101.50183982098302
curr_Factors:  [101.50183982]
mat_Sqrt:  [[0.15]]
grads:  [-0.01163241]
Stock Position:  -0.011632413688521573
Bond Position:  [-2.53548797]


portfolio before change:  [-3.71965518]
curr_Stock_Price:  101.78530172234716
curr_Factors:  [101.78530172]
mat_Sqrt:  [[0.15]]
grads:  [-0.27097951]
Stock Position:  -0.2709795082300574
Bond Position:  [23.86207583]


portfolio before change:  [-3.71313374]
curr_Stock_Price:  101.7667393846261
curr_Factors:  [101.76673938]
mat_Sqrt:  [[0.15]]
grads:  [0.11016956]
Stock Position:  0.11016956466395167
Bond Position:  [-14.92473112]


portfolio before change:  [-3.67333359]
curr_Stock_Price:  102.13646919014143
curr_Factors:  [102.13646919]
mat_Sqrt:  [[0.15]]
grads:  [-0.04513019]
Stock Position:  -0.04513018650049513
Bond Position:  [0.93610431]


portfolio before change:  [-3.63155985]
curr_Stock_Price:  101.21213802068947
curr_Factors:  [101.21213802]
mat_Sqrt:  [[0.15]]
grads:  [-0.05623733]
Stock Position:  -0.05623732646500702
Bond Position:  [2.0603402]


portfolio before change:  [-3.65669373]
curr_Stock_Price:  101.66135322152536
curr_Factors:  [101.66135322]
mat_Sqrt:  [[0.15]]
grads:  [0.10090924]
Stock Position:  0.10090923979964939
Bond Position:  [-13.9152636]


portfolio before change:  [-3.60547012]
curr_Stock_Price:  102.17759280670937
curr_Factors:  [102.17759281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02799023]
Stock Position:  -0.027990234384409434
Bond Position:  [-0.74549535]


portfolio before change:  [-3.62478977]
curr_Stock_Price:  102.86615620869232
curr_Factors:  [102.86615621]
mat_Sqrt:  [[0.15]]
grads:  [0.02782814]
Stock Position:  0.027828144300667882
Bond Position:  [-6.48736401]


portfolio before change:  [-3.64097067]
curr_Stock_Price:  102.29926874221249
curr_Factors:  [102.29926874]
mat_Sqrt:  [[0.15]]
grads:  [0.03851203]
Stock Position:  0.03851203295637499
Bond Position:  [-7.58072348]


portfolio before change:  [-3.60619735]
curr_Stock_Price:  103.2144925074002
curr_Factors:  [103.21449251]
mat_Sqrt:  [[0.15]]
grads:  [0.06290734]
Stock Position:  0.06290734143924212
Bond Position:  [-10.09914667]


portfolio before change:  [-3.6461822]
curr_Stock_Price:  102.58891159023369
curr_Factors:  [102.58891159]
mat_Sqrt:  [[0.15]]
grads:  [0.64860354]
Stock Position:  0.6486035423650047
Bond Position:  [-70.18571366]


portfolio before change:  [-3.91467876]
curr_Stock_Price:  102.18171396724975
curr_Factors:  [102.18171397]
mat_Sqrt:  [[0.15]]
grads:  [-0.08105865]
Stock Position:  -0.08105864940393177
Bond Position:  [4.36803297]


portfolio before change:  [-3.87290019]
curr_Stock_Price:  101.66967032719087
curr_Factors:  [101.66967033]
mat_Sqrt:  [[0.15]]
grads:  [0.1269392]
Stock Position:  0.12693919729133468
Bond Position:  [-16.77876653]


portfolio before change:  [-3.94320832]
curr_Stock_Price:  101.12405930383225
curr_Factors:  [101.1240593]
mat_Sqrt:  [[0.15]]
grads:  [0.01146081]
Stock Position:  0.011460808191274582
Bond Position:  [-5.10217176]


portfolio before change:  [-3.94059458]
curr_Stock_Price:  101.37994251686395
curr_Factors:  [101.37994252]
mat_Sqrt:  [[0.15]]
grads:  [-0.02755825]
Stock Position:  -0.0275582457571761
Bond Position:  [-1.14674121]


portfolio before change:  [-3.93086873]
curr_Stock_Price:  101.02442191855009
curr_Factors:  [101.02442192]
mat_Sqrt:  [[0.15]]
grads:  [0.02955141]
Stock Position:  0.029551410323060915
Bond Position:  [-6.91628288]


portfolio before change:  [-3.93230213]
curr_Stock_Price:  100.99054480704847
curr_Factors:  [100.99054481]
mat_Sqrt:  [[0.15]]
grads:  [0.09891581]
Stock Position:  0.09891580574253703
Bond Position:  [-13.92186324]


portfolio before change:  [-3.96988595]
curr_Stock_Price:  100.61938397688584
curr_Factors:  [100.61938398]
mat_Sqrt:  [[0.15]]
grads:  [0.12304642]
Stock Position:  0.12304641836519387
Bond Position:  [-16.35074076]


portfolio before change:  [-4.00620769]
curr_Stock_Price:  100.33250211041539
curr_Factors:  [100.33250211]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768538]
Stock Position:  -0.027685377571840947
Bond Position:  [-1.22846448]


portfolio before change:  [-3.99032048]
curr_Stock_Price:  99.75588058065308
curr_Factors:  [99.75588058]
mat_Sqrt:  [[0.15]]
grads:  [0.03031633]
Stock Position:  0.030316327410758424
Bond Position:  [-7.01455242]


portfolio before change:  [-3.99804927]
curr_Stock_Price:  99.51540425775079
curr_Factors:  [99.51540426]
mat_Sqrt:  [[0.15]]
grads:  [0.03069371]
Stock Position:  0.030693712626485847
Bond Position:  [-7.05254649]


portfolio before change:  [-4.01929646]
curr_Stock_Price:  98.83753252525177
curr_Factors:  [98.83753253]
mat_Sqrt:  [[0.15]]
grads:  [0.05507544]
Stock Position:  0.0550754369425268
Bond Position:  [-9.46281675]


portfolio before change:  [-4.00145216]
curr_Stock_Price:  99.17226891441946
curr_Factors:  [99.17226891]
mat_Sqrt:  [[0.15]]
grads:  [0.10381932]
Stock Position:  0.10381932023440964
Bond Position:  [-14.2974497]


portfolio before change:  [-4.05985686]
curr_Stock_Price:  98.6183153005037
curr_Factors:  [98.6183153]
mat_Sqrt:  [[0.15]]
grads:  [0.02815234]
Stock Position:  0.028152339253500656
Bond Position:  [-6.83619313]


portfolio before change:  [-4.04722136]
curr_Stock_Price:  99.08231861428447
curr_Factors:  [99.08231861]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428946]
Stock Position:  -0.04289459564549308
Bond Position:  [0.20287463]


portfolio before change:  [-4.03175169]
curr_Stock_Price:  98.72197055714359
curr_Factors:  [98.72197056]
mat_Sqrt:  [[0.15]]
grads:  [0.07504527]
Stock Position:  0.07504526886084037
Bond Position:  [-11.44036852]


portfolio before change:  [-4.03502185]
curr_Stock_Price:  98.68792299539464
curr_Factors:  [98.687923]
mat_Sqrt:  [[0.15]]
grads:  [0.07676052]
Stock Position:  0.07676051625530353
Bond Position:  [-11.61035776]


portfolio before change:  [-4.03486571]
curr_Stock_Price:  98.69941072275617
curr_Factors:  [98.69941072]
mat_Sqrt:  [[0.15]]
grads:  [-0.11393421]
Stock Position:  -0.11393420990307822
Bond Position:  [7.21037366]


portfolio before change:  [-3.98327759]
curr_Stock_Price:  98.25057749169282
curr_Factors:  [98.25057749]
mat_Sqrt:  [[0.15]]
grads:  [-0.02650851]
Stock Position:  -0.02650851344996082
Bond Position:  [-1.37880084]


portfolio before change:  [-3.98461768]
curr_Stock_Price:  98.2978795127446
curr_Factors:  [98.29787951]
mat_Sqrt:  [[0.15]]
grads:  [0.12143739]
Stock Position:  0.12143739494576845
Bond Position:  [-15.92165609]


portfolio before change:  [-4.09805971]
curr_Stock_Price:  97.37191349277222
curr_Factors:  [97.37191349]
mat_Sqrt:  [[0.15]]
grads:  [0.04290174]
Stock Position:  0.042901740908129725
Bond Position:  [-8.27548432]


portfolio before change:  [-4.11671456]
curr_Stock_Price:  96.9491424943221
curr_Factors:  [96.94914249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00894708]
Stock Position:  -0.00894708432773901
Bond Position:  [-3.2493024]


portfolio before change:  [-4.12159772]
curr_Stock_Price:  97.472226505077
curr_Factors:  [97.47222651]
mat_Sqrt:  [[0.15]]
grads:  [-0.177278]
Stock Position:  -0.1772780049398438
Bond Position:  [13.15808413]


portfolio before change:  [-4.12649257]
curr_Stock_Price:  97.50447669895391
curr_Factors:  [97.5044767]
mat_Sqrt:  [[0.15]]
grads:  [-0.10564556]
Stock Position:  -0.10564555776152706
Bond Position:  [6.17442226]


portfolio before change:  [-4.09303543]
curr_Stock_Price:  97.1914372970588
curr_Factors:  [97.1914373]
mat_Sqrt:  [[0.15]]
grads:  [0.04710267]
Stock Position:  0.04710267398589885
Bond Position:  [-8.67101202]


portfolio before change:  [-4.10849703]
curr_Stock_Price:  96.87469011025182
curr_Factors:  [96.87469011]
mat_Sqrt:  [[0.15]]
grads:  [0.22689969]
Stock Position:  0.22689969198658128
Bond Position:  [-26.08933437]


portfolio before change:  [-4.24785776]
curr_Stock_Price:  96.26768135540766
curr_Factors:  [96.26768136]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246679]
Stock Position:  -0.022466791821566766
Bond Position:  [-2.0850318]


portfolio before change:  [-4.26312414]
curr_Stock_Price:  96.94138948870182
curr_Factors:  [96.94138949]
mat_Sqrt:  [[0.15]]
grads:  [0.04937108]
Stock Position:  0.04937108443952842
Bond Position:  [-9.04922566]


portfolio before change:  [-4.27269334]
curr_Stock_Price:  96.7590234807614
curr_Factors:  [96.75902348]
mat_Sqrt:  [[0.15]]
grads:  [-0.1900857]
Stock Position:  -0.19008570468945013
Bond Position:  [14.11981382]


portfolio before change:  [-4.26512078]
curr_Stock_Price:  96.7238285784337
curr_Factors:  [96.72382858]
mat_Sqrt:  [[0.15]]
grads:  [0.13063067]
Stock Position:  0.1306306700466553
Bond Position:  [-16.90021931]


portfolio before change:  [-4.29065731]
curr_Stock_Price:  96.53642817412727
curr_Factors:  [96.53642817]
mat_Sqrt:  [[0.15]]
grads:  [0.06442538]
Stock Position:  0.06442538421443857
Bond Position:  [-10.51005379]


portfolio before change:  [-4.3358771]
curr_Stock_Price:  95.84473045229412
curr_Factors:  [95.84473045]
mat_Sqrt:  [[0.15]]
grads:  [0.0357296]
Stock Position:  0.03572960115770204
Bond Position:  [-7.7603711]


portfolio before change:  [-4.30954769]
curr_Stock_Price:  96.59521321277991
curr_Factors:  [96.59521321]
mat_Sqrt:  [[0.15]]
grads:  [-0.05357183]
Stock Position:  -0.05357183323378433
Bond Position:  [0.86523496]


portfolio before change:  [-4.32727626]
curr_Stock_Price:  96.92715336240006
curr_Factors:  [96.92715336]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021572]
Stock Position:  -0.0021571964514252168
Bond Position:  [-4.11818534]


portfolio before change:  [-4.32827799]
curr_Stock_Price:  97.27220291882763
curr_Factors:  [97.27220292]
mat_Sqrt:  [[0.15]]
grads:  [-0.03115957]
Stock Position:  -0.031159574024626168
Bond Position:  [-1.29731758]


portfolio before change:  [-4.34101976]
curr_Stock_Price:  97.67852052264375
curr_Factors:  [97.67852052]
mat_Sqrt:  [[0.15]]
grads:  [0.00998083]
Stock Position:  0.00998082857180907
Bond Position:  [-5.31593233]


portfolio before change:  [-4.34563189]
curr_Stock_Price:  97.24971062974166
curr_Factors:  [97.24971063]
mat_Sqrt:  [[0.15]]
grads:  [0.00447442]
Stock Position:  0.004474419374310358
Bond Position:  [-4.78076788]


portfolio before change:  [-4.35205846]
curr_Stock_Price:  95.88020212374997
curr_Factors:  [95.88020212]
mat_Sqrt:  [[0.15]]
grads:  [0.05016986]
Stock Position:  0.050169859612330434
Bond Position:  [-9.16235474]


portfolio before change:  [-4.38311099]
curr_Stock_Price:  95.27266861161337
curr_Factors:  [95.27266861]
mat_Sqrt:  [[0.15]]
grads:  [-0.09392148]
Stock Position:  -0.09392148034889929
Bond Position:  [4.56503908]


portfolio before change:  [-4.35195938]
curr_Stock_Price:  94.9440293623094
curr_Factors:  [94.94402936]
mat_Sqrt:  [[0.15]]
grads:  [-0.03525072]
Stock Position:  -0.03525072304126608
Bond Position:  [-1.0051137]


portfolio before change:  [-4.3376155]
curr_Stock_Price:  94.53533694309793
curr_Factors:  [94.53533694]
mat_Sqrt:  [[0.15]]
grads:  [-0.02993207]
Stock Position:  -0.029932073185651328
Bond Position:  [-1.50797688]


portfolio before change:  [-4.31180542]
curr_Stock_Price:  93.66989949574118
curr_Factors:  [93.6698995]
mat_Sqrt:  [[0.15]]
grads:  [0.09627405]
Stock Position:  0.09627404660618219
Bond Position:  [-13.32978568]


portfolio before change:  [-4.35325212]
curr_Stock_Price:  93.24804574059733
curr_Factors:  [93.24804574]
mat_Sqrt:  [[0.15]]
grads:  [0.03533854]
Stock Position:  0.03533853612016537
Bond Position:  [-7.64850155]


portfolio before change:  [-4.35020904]
curr_Stock_Price:  93.34768555542283
curr_Factors:  [93.34768556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424175]
Stock Position:  -0.014241750725401698
Bond Position:  [-3.02077457]


portfolio before change:  [-4.33948107]
curr_Stock_Price:  92.58115250008149
curr_Factors:  [92.5811525]
mat_Sqrt:  [[0.15]]
grads:  [-0.03454494]
Stock Position:  -0.03454494317062943
Bond Position:  [-1.14127042]


portfolio before change:  [-4.33475342]
curr_Stock_Price:  92.44223250025189
curr_Factors:  [92.4422325]
mat_Sqrt:  [[0.15]]
grads:  [-0.03412818]
Stock Position:  -0.03412818362266625
Bond Position:  [-1.17986794]


portfolio before change:  [-4.32798131]
curr_Stock_Price:  92.24164016069284
curr_Factors:  [92.24164016]
mat_Sqrt:  [[0.15]]
grads:  [0.02740047]
Stock Position:  0.027400471200488274
Bond Position:  [-6.85544572]


portfolio before change:  [-4.29117669]
curr_Stock_Price:  93.60048921985845
curr_Factors:  [93.60048922]
mat_Sqrt:  [[0.15]]
grads:  [-0.04688574]
Stock Position:  -0.046885735355835435
Bond Position:  [0.09735108]


portfolio before change:  [-4.31215828]
curr_Stock_Price:  94.04812379260323
curr_Factors:  [94.04812379]
mat_Sqrt:  [[0.15]]
grads:  [0.11597557]
Stock Position:  0.1159755672122377
Bond Position:  [-15.21944278]


portfolio before change:  [-4.33801116]
curr_Stock_Price:  93.83340928440575
curr_Factors:  [93.83340928]
mat_Sqrt:  [[0.15]]
grads:  [0.05813286]
Stock Position:  0.058132858512467474
Bond Position:  [-9.79281547]


portfolio before change:  [-4.29997914]
curr_Stock_Price:  94.49816391401242
curr_Factors:  [94.49816391]
mat_Sqrt:  [[0.15]]
grads:  [0.13589081]
Stock Position:  0.13589081350949989
Bond Position:  [-17.14141151]


portfolio before change:  [-4.36164593]
curr_Stock_Price:  94.05225137281022
curr_Factors:  [94.05225137]
mat_Sqrt:  [[0.15]]
grads:  [-0.03349389]
Stock Position:  -0.033493893198242815
Bond Position:  [-1.21146987]


portfolio before change:  [-4.37053745]
curr_Stock_Price:  94.31545741234224
curr_Factors:  [94.31545741]
mat_Sqrt:  [[0.15]]
grads:  [0.05468535]
Stock Position:  0.054685346475707504
Bond Position:  [-9.52821091]


portfolio before change:  [-4.38493358]
curr_Stock_Price:  94.06309366153792
curr_Factors:  [94.06309366]
mat_Sqrt:  [[0.15]]
grads:  [0.19329821]
Stock Position:  0.19329820676641107
Bond Position:  [-22.56716091]


portfolio before change:  [-4.2286263]
curr_Stock_Price:  94.87902346119014
curr_Factors:  [94.87902346]
mat_Sqrt:  [[0.15]]
grads:  [0.02029393]
Stock Position:  0.020293933866933612
Bond Position:  [-6.15409493]


portfolio before change:  [-4.22914627]
curr_Stock_Price:  94.87235541911633
curr_Factors:  [94.87235542]
mat_Sqrt:  [[0.15]]
grads:  [-0.10142018]
Stock Position:  -0.10142018231081378
Bond Position:  [5.39282532]


portfolio before change:  [-4.35324062]
curr_Stock_Price:  96.09924548225636
curr_Factors:  [96.09924548]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911852]
Stock Position:  -0.03911851744620075
Bond Position:  [-0.59398061]


portfolio before change:  [-4.3601938]
curr_Stock_Price:  96.27604296414621
curr_Factors:  [96.27604296]
mat_Sqrt:  [[0.15]]
grads:  [0.01343504]
Stock Position:  0.01343504043175132
Bond Position:  [-5.65366633]


portfolio before change:  [-4.35981452]
curr_Stock_Price:  96.33057570656594
curr_Factors:  [96.33057571]
mat_Sqrt:  [[0.15]]
grads:  [0.06823715]
Stock Position:  0.06823714714375954
Bond Position:  [-10.93313818]


portfolio before change:  [-4.35596202]
curr_Stock_Price:  96.39704736210112
curr_Factors:  [96.39704736]
mat_Sqrt:  [[0.15]]
grads:  [0.02226359]
Stock Position:  0.02226358606772771
Bond Position:  [-6.50210598]


portfolio before change:  [-4.34936838]
curr_Stock_Price:  96.71146382073428
curr_Factors:  [96.71146382]
mat_Sqrt:  [[0.15]]
grads:  [-0.01055954]
Stock Position:  -0.010559544035528296
Bond Position:  [-3.32813942]


portfolio before change:  [-4.35667639]
curr_Stock_Price:  97.38384062077014
curr_Factors:  [97.38384062]
mat_Sqrt:  [[0.15]]
grads:  [-0.04502488]
Stock Position:  -0.04502487816822606
Bond Position:  [0.02801917]


portfolio before change:  [-4.3678712]
curr_Stock_Price:  97.63251573070833
curr_Factors:  [97.63251573]
mat_Sqrt:  [[0.15]]
grads:  [-0.15428545]
Stock Position:  -0.15428545420408474
Bond Position:  [10.69540583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.30180583]
Stock Price:  97.20864632380074
PL:  [-4.30180583]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40669003e-02]
 [ 3.78137437e-02]
 [ 7.00421901e-03]
 [-8.94205587e-03]
 [-2.83143324e-03]
 [-1.89295163e-03]
 [-9.56894467e-03]
 [-1.85318059e-02]
 [-6.83566551e-03]
 [-6.62126599e-03]
 [ 1.01064900e-02]
 [-6.96681740e-03]
 [ 4.10416900e-03]
 [-5.53542475e-03]
 [ 2.71767571e-04]
 [ 1.71590080e-03]
 [-4.08444141e-02]
 [-1.10323877e-02]
 [ 2.45576165e-02]
 [-2.52201682e-03]
 [-1.16111606e-02]
 [ 5.49818494e-03]
 [ 1.47382417e-02]
 [ 1.99707925e-02]
 [-5.39450918e-03]
 [ 4.68276566e-03]
 [ 9.75999858e-03]
 [ 8.23876247e-03]
 [ 1.56882058e-02]
 [ 2.76079239e-03]
 [-6.43367490e-03]
 [ 1.00549333e-02]
 [ 1.14569290e-02]
 [-2.02535528e-02]
 [-9.77412494e-03]
 [ 3.98290813e-03]
 [ 7.36834991e-03]
 [-1.55768459e-03]
 [ 4.39405986e-03]
 [-1.24739987e-02]
 [ 6.93952407e-03]
 [ 3.53791957e-02]
 [-3.37084767e-03]
 [ 1.64478099e-02]
 [-5.29184115e-02]
 [ 2.16489639e-02]
 [ 9.22399534e-03]
 [ 5.43027881e-03]
 [-1.27719452e-02]
 [ 4.07244917e-04]
 [ 8.73041216e-04]
 [-5.02277941e-03]
 [-1.01533513e-03]
 [ 7.29841074e-03]
 [-1.10333792e-02]
 [-4.99653925e-03]
 [-1.55145628e-03]
 [ 1.34254759e-02]
 [ 6.70955441e-03]
 [-2.72268642e-03]
 [-5.12803189e-03]
 [-1.70118352e-03]
 [-3.01924563e-03]
 [-3.60054840e-03]
 [ 1.89097334e-02]
 [ 4.09829329e-03]
 [ 1.47818120e-02]
 [-2.04770182e-03]
 [ 3.79556877e-03]
 [ 2.27660484e-02]
 [ 3.29708560e-03]
 [-1.58724435e-02]
 [-6.02217033e-03]
 [ 9.26346613e-04]
 [ 5.24933189e-03]
 [ 5.25181563e-05]
 [-1.48766591e-03]
 [-1.04941627e-03]
 [-2.38805914e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.27344247]
curr_Stock_Price:  99.75913252944801
curr_Factors:  [99.75913253]
mat_Sqrt:  [[0.15]]
grads:  [-0.09377934]
Stock Position:  -0.09377933505703623
Bond Position:  [6.08190265]


portfolio before change:  [-3.38348157]
curr_Stock_Price:  100.9365692552423
curr_Factors:  [100.93656926]
mat_Sqrt:  [[0.15]]
grads:  [0.25209162]
Stock Position:  0.25209162436940874
Bond Position:  [-28.82874527]


portfolio before change:  [-3.56770701]
curr_Stock_Price:  100.21292925154879
curr_Factors:  [100.21292925]
mat_Sqrt:  [[0.15]]
grads:  [0.04669479]
Stock Position:  0.04669479339572974
Bond Position:  [-8.24712904]


portfolio before change:  [-3.59036389]
curr_Stock_Price:  99.73875595666121
curr_Factors:  [99.73875596]
mat_Sqrt:  [[0.15]]
grads:  [-0.05961371]
Stock Position:  -0.0596137057803961
Bond Position:  [2.35543296]


portfolio before change:  [-3.64159389]
curr_Stock_Price:  100.60059159360117
curr_Factors:  [100.60059159]
mat_Sqrt:  [[0.15]]
grads:  [-0.01887622]
Stock Position:  -0.01887622162267167
Bond Position:  [-1.74263483]


portfolio before change:  [-3.64127153]
curr_Stock_Price:  100.57774372554181
curr_Factors:  [100.57774373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01261968]
Stock Position:  -0.012619677503519893
Bond Position:  [-2.37201284]


portfolio before change:  [-3.64726057]
curr_Stock_Price:  101.0405751269225
curr_Factors:  [101.04057513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06379296]
Stock Position:  -0.06379296444575223
Bond Position:  [2.79841725]


portfolio before change:  [-3.6154897]
curr_Stock_Price:  100.54528595241393
curr_Factors:  [100.54528595]
mat_Sqrt:  [[0.15]]
grads:  [-0.12354537]
Stock Position:  -0.12354537236109242
Bond Position:  [8.8064151]


portfolio before change:  [-3.54324264]
curr_Stock_Price:  99.96495960358564
curr_Factors:  [99.9649596]
mat_Sqrt:  [[0.15]]
grads:  [-0.0455711]
Stock Position:  -0.0455711033743381
Bond Position:  [1.01227087]


portfolio before change:  [-3.5259687]
curr_Stock_Price:  99.58729329055511
curr_Factors:  [99.58729329]
mat_Sqrt:  [[0.15]]
grads:  [-0.04414177]
Stock Position:  -0.04414177329074684
Bond Position:  [0.86999102]


portfolio before change:  [-3.46997241]
curr_Stock_Price:  98.31996956177807
curr_Factors:  [98.31996956]
mat_Sqrt:  [[0.15]]
grads:  [0.0673766]
Stock Position:  0.06737660004273816
Bond Position:  [-10.09443768]


portfolio before change:  [-3.48864343]
curr_Stock_Price:  98.05221937587712
curr_Factors:  [98.05221938]
mat_Sqrt:  [[0.15]]
grads:  [-0.04644545]
Stock Position:  -0.04644544932881074
Bond Position:  [1.06543596]


portfolio before change:  [-3.48147519]
curr_Stock_Price:  97.89931648066879
curr_Factors:  [97.89931648]
mat_Sqrt:  [[0.15]]
grads:  [0.02736113]
Stock Position:  0.02736112669335872
Bond Position:  [-6.16011079]


portfolio before change:  [-3.48927336]
curr_Stock_Price:  97.62837907879822
curr_Factors:  [97.62837908]
mat_Sqrt:  [[0.15]]
grads:  [-0.03690283]
Stock Position:  -0.03690283167704891
Bond Position:  [0.11349028]


portfolio before change:  [-3.48878891]
curr_Stock_Price:  97.61544355886502
curr_Factors:  [97.61544356]
mat_Sqrt:  [[0.15]]
grads:  [0.00181178]
Stock Position:  0.0018117838092063475
Bond Position:  [-3.66564699]


portfolio before change:  [-3.49020035]
curr_Stock_Price:  96.96286891552776
curr_Factors:  [96.96286892]
mat_Sqrt:  [[0.15]]
grads:  [0.01143934]
Stock Position:  0.011439338687430078
Bond Position:  [-4.59939145]


portfolio before change:  [-3.49511796]
curr_Stock_Price:  96.55811326107661
curr_Factors:  [96.55811326]
mat_Sqrt:  [[0.15]]
grads:  [-0.27229609]
Stock Position:  -0.27229609403432736
Bond Position:  [22.79727913]


portfolio before change:  [-3.63101826]
curr_Stock_Price:  97.06243622779114
curr_Factors:  [97.06243623]
mat_Sqrt:  [[0.15]]
grads:  [-0.07354925]
Stock Position:  -0.07354925149642799
Bond Position:  [3.50785128]


portfolio before change:  [-3.64956264]
curr_Stock_Price:  97.31755280034005
curr_Factors:  [97.3175528]
mat_Sqrt:  [[0.15]]
grads:  [0.16371744]
Stock Position:  0.16371744362274923
Bond Position:  [-19.58214361]


portfolio before change:  [-3.60952691]
curr_Stock_Price:  97.56957023189763
curr_Factors:  [97.56957023]
mat_Sqrt:  [[0.15]]
grads:  [-0.01681345]
Stock Position:  -0.016813445496782882
Bond Position:  [-1.96904626]


portfolio before change:  [-3.61393387]
curr_Stock_Price:  97.82435934545484
curr_Factors:  [97.82435935]
mat_Sqrt:  [[0.15]]
grads:  [-0.07740774]
Stock Position:  -0.07740773738906655
Bond Position:  [3.95842845]


portfolio before change:  [-3.62909594]
curr_Stock_Price:  98.02342842293403
curr_Factors:  [98.02342842]
mat_Sqrt:  [[0.15]]
grads:  [0.03665457]
Stock Position:  0.03665456628593216
Bond Position:  [-7.2221022]


portfolio before change:  [-3.62104315]
curr_Stock_Price:  98.25543730466144
curr_Factors:  [98.2554373]
mat_Sqrt:  [[0.15]]
grads:  [0.09825494]
Stock Position:  0.09825494485814495
Bond Position:  [-13.27512573]


portfolio before change:  [-3.62941267]
curr_Stock_Price:  98.17870024288345
curr_Factors:  [98.17870024]
mat_Sqrt:  [[0.15]]
grads:  [0.13313862]
Stock Position:  0.1331386166595573
Bond Position:  [-16.70078901]


portfolio before change:  [-3.57558877]
curr_Stock_Price:  98.59081006954924
curr_Factors:  [98.59081007]
mat_Sqrt:  [[0.15]]
grads:  [-0.03596339]
Stock Position:  -0.03596339455261326
Bond Position:  [-0.02992857]


portfolio before change:  [-3.58201536]
curr_Stock_Price:  98.76945613090771
curr_Factors:  [98.76945613]
mat_Sqrt:  [[0.15]]
grads:  [0.03121844]
Stock Position:  0.03121843776295434
Bond Position:  [-6.66544348]


portfolio before change:  [-3.5761158]
curr_Stock_Price:  98.97177756737467
curr_Factors:  [98.97177757]
mat_Sqrt:  [[0.15]]
grads:  [0.06506666]
Stock Position:  0.0650666572132518
Bond Position:  [-10.01587853]


portfolio before change:  [-3.58403744]
curr_Stock_Price:  98.8596521900394
curr_Factors:  [98.85965219]
mat_Sqrt:  [[0.15]]
grads:  [0.05492508]
Stock Position:  0.05492508313274602
Bond Position:  [-9.01391205]


portfolio before change:  [-3.58784682]
curr_Stock_Price:  98.80055355082015
curr_Factors:  [98.80055355]
mat_Sqrt:  [[0.15]]
grads:  [0.10458804]
Stock Position:  0.10458803881531545
Bond Position:  [-13.92120295]


portfolio before change:  [-3.58585263]
curr_Stock_Price:  98.82794001982066
curr_Factors:  [98.82794002]
mat_Sqrt:  [[0.15]]
grads:  [0.01840528]
Stock Position:  0.018405282589166717
Bond Position:  [-5.40480879]


portfolio before change:  [-3.59014826]
curr_Stock_Price:  98.61290309763976
curr_Factors:  [98.6129031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04289117]
Stock Position:  -0.04289116597021083
Bond Position:  [0.63947414]


portfolio before change:  [-3.61698892]
curr_Stock_Price:  99.23962023490819
curr_Factors:  [99.23962023]
mat_Sqrt:  [[0.15]]
grads:  [0.06703289]
Stock Position:  0.06703288845834622
Bond Position:  [-10.26930731]


portfolio before change:  [-3.67025617]
curr_Stock_Price:  98.4545518774037
curr_Factors:  [98.45455188]
mat_Sqrt:  [[0.15]]
grads:  [0.07637953]
Stock Position:  0.07637952655609734
Bond Position:  [-11.19016823]


portfolio before change:  [-3.74805019]
curr_Stock_Price:  97.44518964103695
curr_Factors:  [97.44518964]
mat_Sqrt:  [[0.15]]
grads:  [-0.13502369]
Stock Position:  -0.1350236853812447
Bond Position:  [9.40935844]


portfolio before change:  [-3.70404056]
curr_Stock_Price:  97.12360512738314
curr_Factors:  [97.12360513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06516083]
Stock Position:  -0.0651608329220367
Bond Position:  [2.62461445]


portfolio before change:  [-3.70210777]
curr_Stock_Price:  97.0964609091797
curr_Factors:  [97.09646091]
mat_Sqrt:  [[0.15]]
grads:  [0.02655272]
Stock Position:  0.026552720839486538
Bond Position:  [-6.28028299]


portfolio before change:  [-3.70226869]
curr_Stock_Price:  97.10518382277563
curr_Factors:  [97.10518382]
mat_Sqrt:  [[0.15]]
grads:  [0.04912233]
Stock Position:  0.04912233272021049
Bond Position:  [-8.47230183]


portfolio before change:  [-3.71516613]
curr_Stock_Price:  96.85340601810512
curr_Factors:  [96.85340602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01038456]
Stock Position:  -0.010384563900581407
Bond Position:  [-2.70938575]


portfolio before change:  [-3.71280134]
curr_Stock_Price:  96.60937725899153
curr_Factors:  [96.60937726]
mat_Sqrt:  [[0.15]]
grads:  [0.02929373]
Stock Position:  0.029293732369911965
Bond Position:  [-6.54285059]


portfolio before change:  [-3.69809666]
curr_Stock_Price:  97.12531083658291
curr_Factors:  [97.12531084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08315999]
Stock Position:  -0.08315999127369784
Bond Position:  [4.37884334]


portfolio before change:  [-3.61805149]
curr_Stock_Price:  96.1660576155366
curr_Factors:  [96.16605762]
mat_Sqrt:  [[0.15]]
grads:  [0.04626349]
Stock Position:  0.04626349379629269
Bond Position:  [-8.0670293]


portfolio before change:  [-3.62563624]
curr_Stock_Price:  96.01300934455918
curr_Factors:  [96.01300934]
mat_Sqrt:  [[0.15]]
grads:  [0.2358613]
Stock Position:  0.23586130464833313
Bond Position:  [-26.27138989]


portfolio before change:  [-3.61863235]
curr_Stock_Price:  96.04966607030732
curr_Factors:  [96.04966607]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247232]
Stock Position:  -0.022472317784073027
Bond Position:  [-1.46017373]


portfolio before change:  [-3.61398574]
curr_Stock_Price:  95.83883425653785
curr_Factors:  [95.83883426]
mat_Sqrt:  [[0.15]]
grads:  [0.10965207]
Stock Position:  0.10965206584025315
Bond Position:  [-14.1229119]


portfolio before change:  [-3.66084242]
curr_Stock_Price:  95.41956288490464
curr_Factors:  [95.41956288]
mat_Sqrt:  [[0.15]]
grads:  [-0.35278941]
Stock Position:  -0.3527894101363388
Bond Position:  [30.00216889]


portfolio before change:  [-3.83339839]
curr_Stock_Price:  95.91399712622264
curr_Factors:  [95.91399713]
mat_Sqrt:  [[0.15]]
grads:  [0.14432643]
Stock Position:  0.14432642576332014
Bond Position:  [-17.67632277]


portfolio before change:  [-3.89115736]
curr_Stock_Price:  95.52145526642377
curr_Factors:  [95.52145527]
mat_Sqrt:  [[0.15]]
grads:  [0.0614933]
Stock Position:  0.061493302290612936
Bond Position:  [-9.76508708]


portfolio before change:  [-3.97568807]
curr_Stock_Price:  94.15674771042534
curr_Factors:  [94.15674771]
mat_Sqrt:  [[0.15]]
grads:  [0.03620186]
Stock Position:  0.03620185876632342
Bond Position:  [-7.38433735]


portfolio before change:  [-3.95895057]
curr_Stock_Price:  94.63183481792935
curr_Factors:  [94.63183482]
mat_Sqrt:  [[0.15]]
grads:  [-0.0851463]
Stock Position:  -0.08514630158825029
Bond Position:  [4.09860018]


portfolio before change:  [-3.87875901]
curr_Stock_Price:  93.69303433243994
curr_Factors:  [93.69303433]
mat_Sqrt:  [[0.15]]
grads:  [0.00271497]
Stock Position:  0.0027149661117601177
Bond Position:  [-4.13313242]


portfolio before change:  [-3.87806672]
curr_Stock_Price:  94.04317449392597
curr_Factors:  [94.04317449]
mat_Sqrt:  [[0.15]]
grads:  [0.00582027]
Stock Position:  0.005820274772574199
Bond Position:  [-4.42542383]


portfolio before change:  [-3.87868613]
curr_Stock_Price:  93.98427360218132
curr_Factors:  [93.9842736]
mat_Sqrt:  [[0.15]]
grads:  [-0.0334852]
Stock Position:  -0.03348519603441553
Bond Position:  [-0.73160431]


portfolio before change:  [-3.90099245]
curr_Stock_Price:  94.64906257056211
curr_Factors:  [94.64906257]
mat_Sqrt:  [[0.15]]
grads:  [-0.0067689]
Stock Position:  -0.006768900837330385
Bond Position:  [-3.26032233]


portfolio before change:  [-3.90891882]
curr_Stock_Price:  95.78995625770249
curr_Factors:  [95.78995626]
mat_Sqrt:  [[0.15]]
grads:  [0.04865607]
Stock Position:  0.04865607157778016
Bond Position:  [-8.56968179]


portfolio before change:  [-3.88350804]
curr_Stock_Price:  96.32321771324946
curr_Factors:  [96.32321771]
mat_Sqrt:  [[0.15]]
grads:  [-0.07355586]
Stock Position:  -0.07355586137350559
Bond Position:  [3.20162921]


portfolio before change:  [-3.86623253]
curr_Stock_Price:  96.09107585297934
curr_Factors:  [96.09107585]
mat_Sqrt:  [[0.15]]
grads:  [-0.03331026]
Stock Position:  -0.03331026169933448
Bond Position:  [-0.66541365]


portfolio before change:  [-3.85917691]
curr_Stock_Price:  95.87801207471566
curr_Factors:  [95.87801207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034304]
Stock Position:  -0.01034304186920016
Bond Position:  [-2.86750662]


portfolio before change:  [-3.85406405]
curr_Stock_Price:  95.36635513081646
curr_Factors:  [95.36635513]
mat_Sqrt:  [[0.15]]
grads:  [0.08950317]
Stock Position:  0.08950317287840177
Bond Position:  [-12.38965542]


portfolio before change:  [-3.85818839]
curr_Stock_Price:  95.32892669784479
curr_Factors:  [95.3289267]
mat_Sqrt:  [[0.15]]
grads:  [0.04473036]
Stock Position:  0.04473036273608747
Bond Position:  [-8.12228586]


portfolio before change:  [-3.84572427]
curr_Stock_Price:  95.61892613927074
curr_Factors:  [95.61892614]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815124]
Stock Position:  -0.018151242804004594
Bond Position:  [-2.11012192]


portfolio before change:  [-3.85535855]
curr_Stock_Price:  96.14243831756468
curr_Factors:  [96.14243832]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418688]
Stock Position:  -0.0341868792638044
Bond Position:  [-0.56854862]


portfolio before change:  [-3.86118415]
curr_Stock_Price:  96.31180330628689
curr_Factors:  [96.31180331]
mat_Sqrt:  [[0.15]]
grads:  [-0.01134122]
Stock Position:  -0.01134122345770527
Bond Position:  [-2.76889046]


portfolio before change:  [-3.86255747]
curr_Stock_Price:  96.41763507690602
curr_Factors:  [96.41763508]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201283]
Stock Position:  -0.02012830420310029
Bond Position:  [-1.92183398]


portfolio before change:  [-3.85235517]
curr_Stock_Price:  95.9048043011523
curr_Factors:  [95.9048043]
mat_Sqrt:  [[0.15]]
grads:  [-0.02400366]
Stock Position:  -0.024003656016400615
Bond Position:  [-1.55028924]


portfolio before change:  [-3.86660109]
curr_Stock_Price:  96.4942568066275
curr_Factors:  [96.49425681]
mat_Sqrt:  [[0.15]]
grads:  [0.12606489]
Stock Position:  0.1260648895413588
Bond Position:  [-16.03113891]


portfolio before change:  [-3.7568863]
curr_Stock_Price:  97.37250898814457
curr_Factors:  [97.37250899]
mat_Sqrt:  [[0.15]]
grads:  [0.02732196]
Stock Position:  0.0273219552622877
Bond Position:  [-6.41729363]


portfolio before change:  [-3.76764965]
curr_Stock_Price:  96.9932442744132
curr_Factors:  [96.99324427]
mat_Sqrt:  [[0.15]]
grads:  [0.09854541]
Stock Position:  0.09854541327815886
Bond Position:  [-13.32588899]


portfolio before change:  [-3.79718293]
curr_Stock_Price:  96.70200404477445
curr_Factors:  [96.70200404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365135]
Stock Position:  -0.01365134544010583
Bond Position:  [-2.47707047]


portfolio before change:  [-3.80582055]
curr_Stock_Price:  97.32339329016214
curr_Factors:  [97.32339329]
mat_Sqrt:  [[0.15]]
grads:  [0.02530379]
Stock Position:  0.0253037918166317
Bond Position:  [-6.26847143]


portfolio before change:  [-3.79106412]
curr_Stock_Price:  97.92204763420774
curr_Factors:  [97.92204763]
mat_Sqrt:  [[0.15]]
grads:  [0.15177366]
Stock Position:  0.15177365586410244
Bond Position:  [-18.65305128]


portfolio before change:  [-3.77700198]
curr_Stock_Price:  98.0223811481249
curr_Factors:  [98.02238115]
mat_Sqrt:  [[0.15]]
grads:  [0.02198057]
Stock Position:  0.021980570653095003
Bond Position:  [-5.93158986]


portfolio before change:  [-3.76337739]
curr_Stock_Price:  98.65909497207878
curr_Factors:  [98.65909497]
mat_Sqrt:  [[0.15]]
grads:  [-0.10581629]
Stock Position:  -0.10581629005937751
Bond Position:  [6.67636202]


portfolio before change:  [-3.71885398]
curr_Stock_Price:  98.24227712004111
curr_Factors:  [98.24227712]
mat_Sqrt:  [[0.15]]
grads:  [-0.0401478]
Stock Position:  -0.040147802229203444
Bond Position:  [0.22535753]


portfolio before change:  [-3.73205053]
curr_Stock_Price:  98.57132718028438
curr_Factors:  [98.57132718]
mat_Sqrt:  [[0.15]]
grads:  [0.00617564]
Stock Position:  0.006175644089464523
Bond Position:  [-4.34079197]


portfolio before change:  [-3.73214209]
curr_Stock_Price:  98.60043449678554
curr_Factors:  [98.6004345]
mat_Sqrt:  [[0.15]]
grads:  [0.03499555]
Stock Position:  0.03499554595210186
Bond Position:  [-7.18271812]


portfolio before change:  [-3.74922492]
curr_Stock_Price:  98.12511978675876
curr_Factors:  [98.12511979]
mat_Sqrt:  [[0.15]]
grads:  [0.00035012]
Stock Position:  0.00035012104175814165
Bond Position:  [-3.78358059]


portfolio before change:  [-3.74950047]
curr_Stock_Price:  98.01353220238313
curr_Factors:  [98.0135322]
mat_Sqrt:  [[0.15]]
grads:  [-0.00991777]
Stock Position:  -0.009917772721916534
Bond Position:  [-2.77742453]


portfolio before change:  [-3.75294856]
curr_Stock_Price:  98.34369666777675
curr_Factors:  [98.34369667]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699611]
Stock Position:  -0.006996108496462314
Bond Position:  [-3.06492539]


portfolio before change:  [-3.75577996]
curr_Stock_Price:  98.721026373514
curr_Factors:  [98.72102637]
mat_Sqrt:  [[0.15]]
grads:  [-0.15920394]
Stock Position:  -0.1592039424919455
Bond Position:  [11.96099664]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.75121617]
Stock Price:  98.69705583959131
PL:  [-3.75121617]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.74806123e-03]
 [ 4.64256047e-02]
 [ 1.78012112e-02]
 [-1.88052651e-02]
 [-1.88805165e-02]
 [-1.17046602e-03]
 [-6.59225695e-03]
 [-2.14226368e-02]
 [ 1.36459388e-02]
 [ 1.67834548e-03]
 [-8.90293508e-03]
 [ 1.34516367e-02]
 [-3.40258850e-03]
 [ 3.93809826e-03]
 [-1.94394054e-03]
 [ 1.39501476e-02]
 [ 3.52375901e-02]
 [-1.47713516e-02]
 [ 2.00359286e-02]
 [ 2.11907530e-03]
 [-4.15291609e-03]
 [ 4.89069181e-03]
 [ 1.79695718e-02]
 [ 1.78356139e-02]
 [-5.81335790e-03]
 [ 4.67803422e-03]
 [ 1.13285074e-02]
 [ 8.26613025e-03]
 [ 3.08723810e-02]
 [ 2.10838121e-03]
 [-7.38608841e-03]
 [ 7.60956795e-03]
 [ 1.20558121e-02]
 [-1.75429509e-03]
 [ 5.53874023e-03]
 [ 9.22106762e-03]
 [-2.75755535e-02]
 [-4.01815030e-03]
 [-2.64918768e-02]
 [-1.35301763e-02]
 [ 4.19696756e-03]
 [ 1.06519497e-02]
 [-6.35229475e-03]
 [-4.11758326e-03]
 [ 1.15373749e-02]
 [ 1.20029814e-02]
 [ 1.05597521e-02]
 [-8.61610047e-04]
 [ 1.27796120e-02]
 [-1.17362907e-03]
 [ 1.67140014e-02]
 [-1.22887672e-02]
 [ 1.70665325e-03]
 [-7.63163779e-03]
 [-3.55539655e-03]
 [-3.84713346e-03]
 [ 3.02783422e-03]
 [ 9.25999125e-03]
 [ 7.47609606e-03]
 [-4.02643708e-03]
 [-1.64657185e-03]
 [-2.99399544e-04]
 [-4.71952836e-03]
 [-5.65425128e-04]
 [ 2.00920245e-02]
 [ 5.18998937e-03]
 [ 7.80131834e-03]
 [-2.14266533e-04]
 [ 2.80491706e-03]
 [ 2.17961038e-02]
 [ 1.88973988e-03]
 [-1.58911670e-02]
 [-6.43657519e-03]
 [ 1.11131583e-03]
 [ 9.12639706e-03]
 [ 1.68842405e-03]
 [-1.54661934e-03]
 [-6.52803598e-03]
 [-2.31518436e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.13310696]
curr_Stock_Price:  100.45886643198973
curr_Factors:  [100.45886643]
mat_Sqrt:  [[0.15]]
grads:  [-0.02498707]
Stock Position:  -0.0249870748760174
Bond Position:  [14.64328018]


portfolio before change:  [12.11544939]
curr_Stock_Price:  101.20216287045147
curr_Factors:  [101.20216287]
mat_Sqrt:  [[0.15]]
grads:  [0.30950403]
Stock Position:  0.30950403162168905
Bond Position:  [-19.20702803]


portfolio before change:  [11.89075203]
curr_Stock_Price:  100.48004989401367
curr_Factors:  [100.48004989]
mat_Sqrt:  [[0.15]]
grads:  [0.11867474]
Stock Position:  0.11867474129658297
Bond Position:  [-0.03369189]


portfolio before change:  [11.92861082]
curr_Stock_Price:  100.79908062718583
curr_Factors:  [100.79908063]
mat_Sqrt:  [[0.15]]
grads:  [-0.12536843]
Stock Position:  -0.12536843380738127
Bond Position:  [24.56563368]


portfolio before change:  [11.90601557]
curr_Stock_Price:  100.99155849474855
curr_Factors:  [100.99155849]
mat_Sqrt:  [[0.15]]
grads:  [-0.12587011]
Stock Position:  -0.12587010988475053
Bond Position:  [24.61783413]


portfolio before change:  [11.87686472]
curr_Stock_Price:  101.23537742154265
curr_Factors:  [101.23537742]
mat_Sqrt:  [[0.15]]
grads:  [-0.00780311]
Stock Position:  -0.007803106791963285
Bond Position:  [12.66681518]


portfolio before change:  [11.87768012]
curr_Stock_Price:  101.23233965692863
curr_Factors:  [101.23233966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04394838]
Stock Position:  -0.04394837965507628
Bond Position:  [16.32667742]


portfolio before change:  [11.90511861]
curr_Stock_Price:  100.63122442308581
curr_Factors:  [100.63122442]
mat_Sqrt:  [[0.15]]
grads:  [-0.14281758]
Stock Position:  -0.14281757877196954
Bond Position:  [26.27702643]


portfolio before change:  [11.79850842]
curr_Stock_Price:  101.38920225285023
curr_Factors:  [101.38920225]
mat_Sqrt:  [[0.15]]
grads:  [0.09097293]
Stock Position:  0.09097292546927788
Bond Position:  [2.57483608]


portfolio before change:  [11.72331508]
curr_Stock_Price:  100.56088685913473
curr_Factors:  [100.56088686]
mat_Sqrt:  [[0.15]]
grads:  [0.01118897]
Stock Position:  0.011188969857388875
Bond Position:  [10.59814234]


portfolio before change:  [11.73346183]
curr_Stock_Price:  101.40853823768578
curr_Factors:  [101.40853824]
mat_Sqrt:  [[0.15]]
grads:  [-0.0593529]
Stock Position:  -0.0593529005061668
Bond Position:  [17.75235271]


portfolio before change:  [11.72989017]
curr_Stock_Price:  101.48740906897315
curr_Factors:  [101.48740907]
mat_Sqrt:  [[0.15]]
grads:  [0.08967758]
Stock Position:  0.08967757813506555
Bond Position:  [2.62874511]


portfolio before change:  [11.69597672]
curr_Stock_Price:  101.10740601575576
curr_Factors:  [101.10740602]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268392]
Stock Position:  -0.02268392335949917
Bond Position:  [13.98948937]


portfolio before change:  [11.68181183]
curr_Stock_Price:  101.77039793644609
curr_Factors:  [101.77039794]
mat_Sqrt:  [[0.15]]
grads:  [0.02625399]
Stock Position:  0.026253988426461775
Bond Position:  [9.00993298]


portfolio before change:  [11.65427964]
curr_Stock_Price:  100.7002623274671
curr_Factors:  [100.70026233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0129596]
Stock Position:  -0.01295960359774082
Bond Position:  [12.95931512]


portfolio before change:  [11.65951941]
curr_Stock_Price:  100.3584471712784
curr_Factors:  [100.35844717]
mat_Sqrt:  [[0.15]]
grads:  [0.09300098]
Stock Position:  0.09300098396810494
Bond Position:  [2.32608508]


portfolio before change:  [11.63942361]
curr_Stock_Price:  100.14080225838075
curr_Factors:  [100.14080226]
mat_Sqrt:  [[0.15]]
grads:  [0.23491727]
Stock Position:  0.23491726749517874
Bond Position:  [-11.88538003]


portfolio before change:  [11.75673454]
curr_Stock_Price:  100.64333574025912
curr_Factors:  [100.64333574]
mat_Sqrt:  [[0.15]]
grads:  [-0.09847568]
Stock Position:  -0.09847567707563543
Bond Position:  [21.66765517]


portfolio before change:  [11.82535304]
curr_Stock_Price:  99.960281531343
curr_Factors:  [99.96028153]
mat_Sqrt:  [[0.15]]
grads:  [0.13357286]
Stock Position:  0.13357285737206806
Bond Position:  [-1.52662739]


portfolio before change:  [11.77393188]
curr_Stock_Price:  99.57602880924725
curr_Factors:  [99.57602881]
mat_Sqrt:  [[0.15]]
grads:  [0.01412717]
Stock Position:  0.01412716866379105
Bond Position:  [10.36720453]


portfolio before change:  [11.78162787]
curr_Stock_Price:  100.0749268494415
curr_Factors:  [100.07492685]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768611]
Stock Position:  -0.027686107286316285
Bond Position:  [14.55231303]


portfolio before change:  [11.80127644]
curr_Stock_Price:  99.3980884188382
curr_Factors:  [99.39808842]
mat_Sqrt:  [[0.15]]
grads:  [0.03260461]
Stock Position:  0.032604612047711125
Bond Position:  [8.56044033]


portfolio before change:  [11.8047296]
curr_Stock_Price:  99.48758844299097
curr_Factors:  [99.48758844]
mat_Sqrt:  [[0.15]]
grads:  [0.11979715]
Stock Position:  0.1197971453922527
Bond Position:  [-0.1135995]


portfolio before change:  [11.77379353]
curr_Stock_Price:  99.22941058334789
curr_Factors:  [99.22941058]
mat_Sqrt:  [[0.15]]
grads:  [0.11890409]
Stock Position:  0.11890409280234396
Bond Position:  [-0.02498952]


portfolio before change:  [11.75573354]
curr_Stock_Price:  99.07753674150037
curr_Factors:  [99.07753674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03875572]
Stock Position:  -0.03875571934438364
Bond Position:  [15.59555475]


portfolio before change:  [11.76782959]
curr_Stock_Price:  98.79057808120521
curr_Factors:  [98.79057808]
mat_Sqrt:  [[0.15]]
grads:  [0.03118689]
Stock Position:  0.031186894822706243
Bond Position:  [8.68685822]


portfolio before change:  [11.76971931]
curr_Stock_Price:  98.8337621804584
curr_Factors:  [98.83376218]
mat_Sqrt:  [[0.15]]
grads:  [0.07552338]
Stock Position:  0.07552338251961137
Bond Position:  [4.30545928]


portfolio before change:  [11.82394084]
curr_Stock_Price:  99.54814261450471
curr_Factors:  [99.54814261]
mat_Sqrt:  [[0.15]]
grads:  [0.05510753]
Stock Position:  0.05510753497253927
Bond Position:  [6.33808809]


portfolio before change:  [11.87725594]
curr_Stock_Price:  100.50842794247086
curr_Factors:  [100.50842794]
mat_Sqrt:  [[0.15]]
grads:  [0.20581587]
Stock Position:  0.20581587342433524
Bond Position:  [-8.80897395]


portfolio before change:  [11.84057568]
curr_Stock_Price:  100.3328842362655
curr_Factors:  [100.33288424]
mat_Sqrt:  [[0.15]]
grads:  [0.01405587]
Stock Position:  0.014055874758244144
Bond Position:  [10.43030922]


portfolio before change:  [11.8352435]
curr_Stock_Price:  99.90714793058301
curr_Factors:  [99.90714793]
mat_Sqrt:  [[0.15]]
grads:  [-0.04924059]
Stock Position:  -0.04924058942995187
Bond Position:  [16.75473035]


portfolio before change:  [11.8084842]
curr_Stock_Price:  100.47185470220882
curr_Factors:  [100.4718547]
mat_Sqrt:  [[0.15]]
grads:  [0.05073045]
Stock Position:  0.05073045301986913
Bond Position:  [6.7115015]


portfolio before change:  [11.77607105]
curr_Stock_Price:  99.82465694979288
curr_Factors:  [99.82465695]
mat_Sqrt:  [[0.15]]
grads:  [0.08037208]
Stock Position:  0.08037208056826486
Bond Position:  [3.75295568]


portfolio before change:  [11.79815164]
curr_Stock_Price:  100.09646798475987
curr_Factors:  [100.09646798]
mat_Sqrt:  [[0.15]]
grads:  [-0.0116953]
Stock Position:  -0.011695300569697527
Bond Position:  [12.96880992]


portfolio before change:  [11.79234226]
curr_Stock_Price:  100.66250363182779
curr_Factors:  [100.66250363]
mat_Sqrt:  [[0.15]]
grads:  [0.03692493]
Stock Position:  0.036924934871354266
Bond Position:  [8.07538587]


portfolio before change:  [11.80746352]
curr_Stock_Price:  101.05834815011413
curr_Factors:  [101.05834815]
mat_Sqrt:  [[0.15]]
grads:  [0.06147378]
Stock Position:  0.06147378416211824
Bond Position:  [5.59502443]


portfolio before change:  [11.84489788]
curr_Stock_Price:  101.66160792992535
curr_Factors:  [101.66160793]
mat_Sqrt:  [[0.15]]
grads:  [-0.18383702]
Stock Position:  -0.18383702330870924
Bond Position:  [30.53406526]


portfolio before change:  [11.66067899]
curr_Stock_Price:  102.67406627306754
curr_Factors:  [102.67406627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678767]
Stock Position:  -0.026787668646649256
Bond Position:  [14.41107785]


portfolio before change:  [11.66082636]
curr_Stock_Price:  102.70218909076243
curr_Factors:  [102.70218909]
mat_Sqrt:  [[0.15]]
grads:  [-0.17661251]
Stock Position:  -0.17661251193842262
Bond Position:  [29.79931796]


portfolio before change:  [11.71355298]
curr_Stock_Price:  102.41419078593418
curr_Factors:  [102.41419079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09020118]
Stock Position:  -0.09020117536865593
Bond Position:  [20.95143337]


portfolio before change:  [11.76239538]
curr_Stock_Price:  101.88722552056237
curr_Factors:  [101.88722552]
mat_Sqrt:  [[0.15]]
grads:  [0.02797978]
Stock Position:  0.02797978370732034
Bond Position:  [8.91161284]


portfolio before change:  [11.77592236]
curr_Stock_Price:  102.35077408691326
curr_Factors:  [102.35077409]
mat_Sqrt:  [[0.15]]
grads:  [0.071013]
Stock Position:  0.07101299794668132
Bond Position:  [4.50768705]


portfolio before change:  [11.76680154]
curr_Stock_Price:  102.21836798635047
curr_Factors:  [102.21836799]
mat_Sqrt:  [[0.15]]
grads:  [-0.04234863]
Stock Position:  -0.042348631658589465
Bond Position:  [16.09560956]


portfolio before change:  [11.79047768]
curr_Stock_Price:  101.68304645673645
curr_Factors:  [101.68304646]
mat_Sqrt:  [[0.15]]
grads:  [-0.02745056]
Stock Position:  -0.02745055505822643
Bond Position:  [14.58173375]


portfolio before change:  [11.78113498]
curr_Stock_Price:  102.0565940147286
curr_Factors:  [102.05659401]
mat_Sqrt:  [[0.15]]
grads:  [0.07691583]
Stock Position:  0.07691583282094096
Bond Position:  [3.93136706]


portfolio before change:  [11.86027147]
curr_Stock_Price:  103.08227060531812
curr_Factors:  [103.08227061]
mat_Sqrt:  [[0.15]]
grads:  [0.08001988]
Stock Position:  0.08001987567157641
Bond Position:  [3.61164099]


portfolio before change:  [11.85137486]
curr_Stock_Price:  102.96826963974723
curr_Factors:  [102.96826964]
mat_Sqrt:  [[0.15]]
grads:  [0.07039835]
Stock Position:  0.07039834754699816
Bond Position:  [4.60257883]


portfolio before change:  [11.82949694]
curr_Stock_Price:  102.65341012846017
curr_Factors:  [102.65341013]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574407]
Stock Position:  -0.005744066978473775
Bond Position:  [12.41914501]


portfolio before change:  [11.8299668]
curr_Stock_Price:  102.70674598869604
curr_Factors:  [102.70674599]
mat_Sqrt:  [[0.15]]
grads:  [0.08519741]
Stock Position:  0.08519741331724519
Bond Position:  [3.07961771]


portfolio before change:  [11.80684139]
curr_Stock_Price:  102.43305348357953
curr_Factors:  [102.43305348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782419]
Stock Position:  -0.007824193788106745
Bond Position:  [12.60829745]


portfolio before change:  [11.81183668]
curr_Stock_Price:  101.89533026891733
curr_Factors:  [101.89533027]
mat_Sqrt:  [[0.15]]
grads:  [0.11142668]
Stock Position:  0.11142667598430396
Bond Position:  [0.45797873]


portfolio before change:  [11.67259533]
curr_Stock_Price:  100.6454502642221
curr_Factors:  [100.64545026]
mat_Sqrt:  [[0.15]]
grads:  [-0.08192511]
Stock Position:  -0.08192511452555734
Bond Position:  [19.91798537]


portfolio before change:  [11.60981888]
curr_Stock_Price:  101.42691225953465
curr_Factors:  [101.42691226]
mat_Sqrt:  [[0.15]]
grads:  [0.01137769]
Stock Position:  0.011377688340447467
Bond Position:  [10.45581508]


portfolio before change:  [11.61909013]
curr_Stock_Price:  102.18433703694429
curr_Factors:  [102.18433704]
mat_Sqrt:  [[0.15]]
grads:  [-0.05087759]
Stock Position:  -0.05087758528594902
Bond Position:  [16.81798246]


portfolio before change:  [11.64763414]
curr_Stock_Price:  101.64396446631068
curr_Factors:  [101.64396447]
mat_Sqrt:  [[0.15]]
grads:  [-0.02370264]
Stock Position:  -0.023702643675215924
Bond Position:  [14.05686481]


portfolio before change:  [11.67261534]
curr_Stock_Price:  100.62708977674417
curr_Factors:  [100.62708978]
mat_Sqrt:  [[0.15]]
grads:  [-0.02564756]
Stock Position:  -0.02564755642869079
Bond Position:  [14.2534543]


portfolio before change:  [11.70406034]
curr_Stock_Price:  99.43578228169764
curr_Factors:  [99.43578228]
mat_Sqrt:  [[0.15]]
grads:  [0.02018556]
Stock Position:  0.02018556144117161
Bond Position:  [9.69689324]


portfolio before change:  [11.6912021]
curr_Stock_Price:  98.76875526370192
curr_Factors:  [98.76875526]
mat_Sqrt:  [[0.15]]
grads:  [0.06173327]
Stock Position:  0.06173327497610592
Bond Position:  [5.59388337]


portfolio before change:  [11.69407676]
curr_Stock_Price:  98.80965751775467
curr_Factors:  [98.80965752]
mat_Sqrt:  [[0.15]]
grads:  [0.04984064]
Stock Position:  0.04984064038775642
Bond Position:  [6.76934015]


portfolio before change:  [11.74279746]
curr_Stock_Price:  99.77869817774156
curr_Factors:  [99.77869818]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684291]
Stock Position:  -0.026842913855586945
Bond Position:  [14.42114846]


portfolio before change:  [11.76573146]
curr_Stock_Price:  98.95789860829667
curr_Factors:  [98.95789861]
mat_Sqrt:  [[0.15]]
grads:  [-0.01097715]
Stock Position:  -0.010977145681560248
Bond Position:  [12.85200673]


portfolio before change:  [11.77951458]
curr_Stock_Price:  97.77545625432984
curr_Factors:  [97.77545625]
mat_Sqrt:  [[0.15]]
grads:  [-0.001996]
Stock Position:  -0.0019959969568644938
Bond Position:  [11.97467409]


portfolio before change:  [11.78098533]
curr_Stock_Price:  97.41357518107658
curr_Factors:  [97.41357518]
mat_Sqrt:  [[0.15]]
grads:  [-0.03146352]
Stock Position:  -0.03146352239093124
Bond Position:  [14.84595954]


portfolio before change:  [11.77657015]
curr_Stock_Price:  97.58339340286159
curr_Factors:  [97.5833934]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037695]
Stock Position:  -0.0037695008529728693
Bond Position:  [12.14441084]


portfolio before change:  [11.77335821]
curr_Stock_Price:  98.63684758732822
curr_Factors:  [98.63684759]
mat_Sqrt:  [[0.15]]
grads:  [0.13394683]
Stock Position:  0.13394682987443143
Bond Position:  [-1.43873484]


portfolio before change:  [11.82417931]
curr_Stock_Price:  99.01693141514417
curr_Factors:  [99.01693142]
mat_Sqrt:  [[0.15]]
grads:  [0.03459993]
Stock Position:  0.034599929106869
Bond Position:  [8.3982005]


portfolio before change:  [11.84751363]
curr_Stock_Price:  99.67616458985434
curr_Factors:  [99.67616459]
mat_Sqrt:  [[0.15]]
grads:  [0.05200879]
Stock Position:  0.052008788912445585
Bond Position:  [6.66347703]


portfolio before change:  [11.82397768]
curr_Stock_Price:  99.21561863058356
curr_Factors:  [99.21561863]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142844]
Stock Position:  -0.0014284435508964393
Bond Position:  [11.96570159]


portfolio before change:  [11.82432583]
curr_Stock_Price:  99.4954490062749
curr_Factors:  [99.49544901]
mat_Sqrt:  [[0.15]]
grads:  [0.01869945]
Stock Position:  0.018699447077113702
Bond Position:  [9.96381595]


portfolio before change:  [11.81989134]
curr_Stock_Price:  99.22499963525277
curr_Factors:  [99.22499964]
mat_Sqrt:  [[0.15]]
grads:  [0.14530736]
Stock Position:  0.14530735860927785
Bond Position:  [-2.59823127]


portfolio before change:  [11.83104142]
curr_Stock_Price:  99.30285168336479
curr_Factors:  [99.30285168]
mat_Sqrt:  [[0.15]]
grads:  [0.01259827]
Stock Position:  0.012598265854324732
Bond Position:  [10.57999769]


portfolio before change:  [11.82529433]
curr_Stock_Price:  98.79418144362445
curr_Factors:  [98.79418144]
mat_Sqrt:  [[0.15]]
grads:  [-0.10594111]
Stock Position:  -0.1059411133645785
Bond Position:  [22.2916599]


portfolio before change:  [11.8404464]
curr_Stock_Price:  98.66430928378372
curr_Factors:  [98.66430928]
mat_Sqrt:  [[0.15]]
grads:  [-0.0429105]
Stock Position:  -0.042910501298891415
Bond Position:  [16.07418137]


portfolio before change:  [11.86888718]
curr_Stock_Price:  98.02492925813276
curr_Factors:  [98.02492926]
mat_Sqrt:  [[0.15]]
grads:  [0.00740877]
Stock Position:  0.007408772221884911
Bond Position:  [11.14264281]


portfolio before change:  [11.86438549]
curr_Stock_Price:  97.32331030863966
curr_Factors:  [97.32331031]
mat_Sqrt:  [[0.15]]
grads:  [0.06084265]
Stock Position:  0.060842647062077836
Bond Position:  [5.94297767]


portfolio before change:  [11.84815149]
curr_Stock_Price:  97.05038590508772
curr_Factors:  [97.05038591]
mat_Sqrt:  [[0.15]]
grads:  [0.01125616]
Stock Position:  0.011256160362669541
Bond Position:  [10.75573678]


portfolio before change:  [11.85400683]
curr_Stock_Price:  97.51085251436882
curr_Factors:  [97.51085251]
mat_Sqrt:  [[0.15]]
grads:  [-0.0103108]
Stock Position:  -0.010310795574114483
Bond Position:  [12.8594213]


portfolio before change:  [11.85572859]
curr_Stock_Price:  97.42181808391206
curr_Factors:  [97.42181808]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352024]
Stock Position:  -0.04352023983933741
Bond Position:  [16.09554948]


portfolio before change:  [11.87824431]
curr_Stock_Price:  96.92757164034474
curr_Factors:  [96.92757164]
mat_Sqrt:  [[0.15]]
grads:  [-0.15434562]
Stock Position:  -0.15434562396612544
Bond Position:  [26.83859084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.92261306]
Stock Price:  96.65097626281356
PL:  [11.92261306]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.24451627e-02]
 [-2.37800485e-02]
 [ 4.74321730e-02]
 [-1.00435120e-02]
 [ 1.31135487e-02]
 [-1.16623539e-03]
 [-9.98130299e-03]
 [-3.61817980e-02]
 [ 7.19659922e-03]
 [-6.23011535e-03]
 [-9.47507278e-03]
 [ 1.27330827e-02]
 [-3.82431196e-03]
 [ 3.33906418e-03]
 [ 5.05759541e-03]
 [ 1.11568111e-02]
 [ 9.69514569e-02]
 [-1.20499146e-02]
 [ 1.90356146e-02]
 [ 1.59895866e-03]
 [-4.30549022e-03]
 [ 4.53457878e-03]
 [ 9.91163165e-03]
 [ 2.94374687e-02]
 [ 2.62041455e-03]
 [ 7.70399887e-03]
 [ 5.94961401e-02]
 [ 2.51252682e-02]
 [ 5.69455134e-03]
 [-9.18975826e-03]
 [ 4.59285763e-03]
 [ 1.50198690e-02]
 [ 1.54015957e-02]
 [-7.19417296e-03]
 [ 4.47756261e-03]
 [-6.44471484e-03]
 [-9.31620043e-03]
 [-1.40635072e-02]
 [-1.04366749e-02]
 [-2.35169548e-02]
 [ 3.49089615e-03]
 [ 3.01085887e-03]
 [-1.57894081e-02]
 [ 1.17055745e-02]
 [-2.82383203e-03]
 [ 1.16092555e-02]
 [ 1.05657016e-02]
 [-3.08504574e-03]
 [ 1.36203975e-02]
 [-1.45629561e-03]
 [ 1.98851241e-02]
 [ 2.10845230e-02]
 [-7.59139980e-03]
 [-5.99993456e-02]
 [-1.62418427e-02]
 [-2.15568990e-03]
 [-6.49762251e-03]
 [-1.43319846e-02]
 [-2.03139405e-03]
 [-2.88002888e-03]
 [-7.84916370e-03]
 [-4.99036044e-03]
 [-1.66376845e-02]
 [-1.23468995e-04]
 [ 3.09810516e-04]
 [ 2.66542416e-02]
 [-1.58827274e-03]
 [ 1.88650076e-02]
 [ 8.74250711e-03]
 [ 1.16950804e-02]
 [ 7.30035255e-03]
 [-1.43795222e-02]
 [-6.11106535e-02]
 [ 4.23650343e-04]
 [-1.31697711e-02]
 [-3.22590333e-02]
 [-6.61171351e-03]
 [ 2.46489686e-02]
 [ 9.66656015e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.84418924]
curr_Stock_Price:  99.99156487401946
curr_Factors:  [99.99156487]
mat_Sqrt:  [[0.15]]
grads:  [-0.08296775]
Stock Position:  -0.08296775108551979
Bond Position:  [10.1402645]


portfolio before change:  [1.96369297]
curr_Stock_Price:  98.55884020208079
curr_Factors:  [98.5588402]
mat_Sqrt:  [[0.15]]
grads:  [-0.15853366]
Stock Position:  -0.1585336565099135
Bond Position:  [17.58858629]


portfolio before change:  [1.97697986]
curr_Stock_Price:  98.48196332546289
curr_Factors:  [98.48196333]
mat_Sqrt:  [[0.15]]
grads:  [0.31621449]
Stock Position:  0.3162144867123354
Bond Position:  [-29.16444362]


portfolio before change:  [2.19990097]
curr_Stock_Price:  99.19269593256557
curr_Factors:  [99.19269593]
mat_Sqrt:  [[0.15]]
grads:  [-0.06695675]
Stock Position:  -0.06695674675575239
Bond Position:  [8.84152119]


portfolio before change:  [2.13713478]
curr_Stock_Price:  100.13836327753192
curr_Factors:  [100.13836328]
mat_Sqrt:  [[0.15]]
grads:  [0.08742366]
Stock Position:  0.08742365776071612
Bond Position:  [-6.61732722]


portfolio before change:  [2.2114854]
curr_Stock_Price:  100.9935576394236
curr_Factors:  [100.99355764]
mat_Sqrt:  [[0.15]]
grads:  [-0.0077749]
Stock Position:  -0.0077749026052220584
Bond Position:  [2.99670047]


portfolio before change:  [2.21269124]
curr_Stock_Price:  100.86255439347548
curr_Factors:  [100.86255439]
mat_Sqrt:  [[0.15]]
grads:  [-0.06654202]
Stock Position:  -0.06654201994895642
Bond Position:  [8.92428934]


portfolio before change:  [2.17063695]
curr_Stock_Price:  101.50293281778798
curr_Factors:  [101.50293282]
mat_Sqrt:  [[0.15]]
grads:  [-0.24121199]
Stock Position:  -0.24121198635072283
Bond Position:  [26.65436099]


portfolio before change:  [2.34198767]
curr_Stock_Price:  100.79946540675077
curr_Factors:  [100.79946541]
mat_Sqrt:  [[0.15]]
grads:  [0.04797733]
Stock Position:  0.047977328124073584
Bond Position:  [-2.49410136]


portfolio before change:  [2.38927799]
curr_Stock_Price:  101.78839520059714
curr_Factors:  [101.7883952]
mat_Sqrt:  [[0.15]]
grads:  [-0.0415341]
Stock Position:  -0.04153410235269614
Bond Position:  [6.61696762]


portfolio before change:  [2.39344142]
curr_Stock_Price:  101.69811137056973
curr_Factors:  [101.69811137]
mat_Sqrt:  [[0.15]]
grads:  [-0.06316715]
Stock Position:  -0.06316715184410111
Bond Position:  [8.81742147]


portfolio before change:  [2.4112213]
curr_Stock_Price:  101.42536254602922
curr_Factors:  [101.42536255]
mat_Sqrt:  [[0.15]]
grads:  [0.08488722]
Stock Position:  0.08488721776724298
Bond Position:  [-6.19849554]


portfolio before change:  [2.43197674]
curr_Stock_Price:  101.67443255114334
curr_Factors:  [101.67443255]
mat_Sqrt:  [[0.15]]
grads:  [-0.02549541]
Stock Position:  -0.02549541307473148
Bond Position:  [5.02420839]


portfolio before change:  [2.42571614]
curr_Stock_Price:  101.93230699389268
curr_Factors:  [101.93230699]
mat_Sqrt:  [[0.15]]
grads:  [0.02226043]
Stock Position:  0.02226042789427889
Bond Position:  [0.15665937]


portfolio before change:  [2.43204384]
curr_Stock_Price:  102.21612467689043
curr_Factors:  [102.21612468]
mat_Sqrt:  [[0.15]]
grads:  [0.0337173]
Stock Position:  0.033717302743112916
Bond Position:  [-1.01440818]


portfolio before change:  [2.4342372]
curr_Stock_Price:  102.28305650248915
curr_Factors:  [102.2830565]
mat_Sqrt:  [[0.15]]
grads:  [0.07437874]
Stock Position:  0.0743787404640828
Bond Position:  [-5.17344772]


portfolio before change:  [2.47773268]
curr_Stock_Price:  102.87218771741922
curr_Factors:  [102.87218772]
mat_Sqrt:  [[0.15]]
grads:  [0.64634305]
Stock Position:  0.6463430459556193
Bond Position:  [-64.01299047]


portfolio before change:  [2.05862652]
curr_Stock_Price:  102.22995101112252
curr_Factors:  [102.22995101]
mat_Sqrt:  [[0.15]]
grads:  [-0.08033276]
Stock Position:  -0.08033276400516119
Bond Position:  [10.27104105]


portfolio before change:  [2.10445219]
curr_Stock_Price:  101.66749418362824
curr_Factors:  [101.66749418]
mat_Sqrt:  [[0.15]]
grads:  [0.1269041]
Stock Position:  0.12690409764319613
Bond Position:  [-10.79756942]


portfolio before change:  [2.05018532]
curr_Stock_Price:  101.24519102073185
curr_Factors:  [101.24519102]
mat_Sqrt:  [[0.15]]
grads:  [0.01065972]
Stock Position:  0.010659724398156501
Bond Position:  [0.97093949]


portfolio before change:  [2.05295436]
curr_Stock_Price:  101.49926430455807
curr_Factors:  [101.4992643]
mat_Sqrt:  [[0.15]]
grads:  [-0.02870327]
Stock Position:  -0.028703268125061118
Bond Position:  [4.96631495]


portfolio before change:  [2.05893389]
curr_Stock_Price:  101.30175609018582
curr_Factors:  [101.30175609]
mat_Sqrt:  [[0.15]]
grads:  [0.03023053]
Stock Position:  0.03023052520886686
Bond Position:  [-1.0034714]


portfolio before change:  [2.08181428]
curr_Stock_Price:  102.06069442538235
curr_Factors:  [102.06069443]
mat_Sqrt:  [[0.15]]
grads:  [0.06607754]
Stock Position:  0.0660775443232119
Bond Position:  [-4.66210578]


portfolio before change:  [2.08313647]
curr_Stock_Price:  102.0851139123763
curr_Factors:  [102.08511391]
mat_Sqrt:  [[0.15]]
grads:  [0.19624979]
Stock Position:  0.19624979155728095
Bond Position:  [-17.95104586]


portfolio before change:  [2.23685473]
curr_Stock_Price:  102.87410959624809
curr_Factors:  [102.8741096]
mat_Sqrt:  [[0.15]]
grads:  [0.01746943]
Stock Position:  0.017469430301514308
Bond Position:  [0.43970264]


portfolio before change:  [2.24375792]
curr_Stock_Price:  103.26769450789334
curr_Factors:  [103.26769451]
mat_Sqrt:  [[0.15]]
grads:  [0.05135999]
Stock Position:  0.05135999246870455
Bond Position:  [-3.0600701]


portfolio before change:  [2.28298556]
curr_Stock_Price:  104.03519668528413
curr_Factors:  [104.03519669]
mat_Sqrt:  [[0.15]]
grads:  [0.39664093]
Stock Position:  0.39664093416784163
Bond Position:  [-38.98163204]


portfolio before change:  [2.1275276]
curr_Stock_Price:  103.64940307749471
curr_Factors:  [103.64940308]
mat_Sqrt:  [[0.15]]
grads:  [0.16750179]
Stock Position:  0.16750178786260164
Bond Position:  [-15.23393273]


portfolio before change:  [2.24663242]
curr_Stock_Price:  104.36615348333245
curr_Factors:  [104.36615348]
mat_Sqrt:  [[0.15]]
grads:  [0.03796368]
Stock Position:  0.037963675629804655
Bond Position:  [-1.71549038]


portfolio before change:  [2.23743656]
curr_Stock_Price:  104.12674991972187
curr_Factors:  [104.12674992]
mat_Sqrt:  [[0.15]]
grads:  [-0.06126506]
Stock Position:  -0.06126505509338599
Bond Position:  [8.61676763]


portfolio before change:  [2.2185633]
curr_Stock_Price:  104.4435998212411
curr_Factors:  [104.44359982]
mat_Sqrt:  [[0.15]]
grads:  [0.03061905]
Stock Position:  0.030619050845433968
Bond Position:  [-0.9794006]


portfolio before change:  [2.20602826]
curr_Stock_Price:  104.03621209134654
curr_Factors:  [104.03621209]
mat_Sqrt:  [[0.15]]
grads:  [0.10013246]
Stock Position:  0.10013245983092847
Bond Position:  [-8.21137357]


portfolio before change:  [2.22655543]
curr_Stock_Price:  104.24633779112973
curr_Factors:  [104.24633779]
mat_Sqrt:  [[0.15]]
grads:  [0.1026773]
Stock Position:  0.10267730437395563
Bond Position:  [-8.47717752]


portfolio before change:  [2.2100759]
curr_Stock_Price:  104.09099969754665
curr_Factors:  [104.0909997]
mat_Sqrt:  [[0.15]]
grads:  [-0.04796115]
Stock Position:  -0.0479611530405973
Bond Position:  [7.20240026]


portfolio before change:  [2.21298976]
curr_Stock_Price:  104.0396310416171
curr_Factors:  [104.03963104]
mat_Sqrt:  [[0.15]]
grads:  [0.02985042]
Stock Position:  0.029850417371389295
Bond Position:  [-0.89263665]


portfolio before change:  [2.22293153]
curr_Stock_Price:  104.37455301007338
curr_Factors:  [104.37455301]
mat_Sqrt:  [[0.15]]
grads:  [-0.04296477]
Stock Position:  -0.042964765586614696
Bond Position:  [6.70735973]


portfolio before change:  [2.17687082]
curr_Stock_Price:  105.45636820515497
curr_Factors:  [105.45636821]
mat_Sqrt:  [[0.15]]
grads:  [-0.062108]
Stock Position:  -0.06210800287828156
Bond Position:  [8.72655524]


portfolio before change:  [2.21327842]
curr_Stock_Price:  104.87895190093734
curr_Factors:  [104.8789519]
mat_Sqrt:  [[0.15]]
grads:  [-0.09375671]
Stock Position:  -0.09375671485860537
Bond Position:  [12.0463844]


portfolio before change:  [2.30061931]
curr_Stock_Price:  103.95541302431853
curr_Factors:  [103.95541302]
mat_Sqrt:  [[0.15]]
grads:  [-0.06957783]
Stock Position:  -0.06957783292750538
Bond Position:  [9.53361167]


portfolio before change:  [2.3125174]
curr_Stock_Price:  103.79297303431127
curr_Factors:  [103.79297303]
mat_Sqrt:  [[0.15]]
grads:  [-0.1567797]
Stock Position:  -0.15677969869521216
Bond Position:  [18.58514844]


portfolio before change:  [2.22119041]
curr_Stock_Price:  104.38290015127154
curr_Factors:  [104.38290015]
mat_Sqrt:  [[0.15]]
grads:  [0.02327264]
Stock Position:  0.02327264097277105
Bond Position:  [-0.20807534]


portfolio before change:  [2.2364892]
curr_Stock_Price:  105.04083128772614
curr_Factors:  [105.04083129]
mat_Sqrt:  [[0.15]]
grads:  [0.02007239]
Stock Position:  0.02007239245131835
Bond Position:  [0.12806842]


portfolio before change:  [2.24543832]
curr_Stock_Price:  105.48627437449018
curr_Factors:  [105.48627437]
mat_Sqrt:  [[0.15]]
grads:  [-0.10526272]
Stock Position:  -0.10526272038494286
Bond Position:  [13.34921052]


portfolio before change:  [2.31964947]
curr_Stock_Price:  104.78919190058411
curr_Factors:  [104.7891919]
mat_Sqrt:  [[0.15]]
grads:  [0.07803716]
Stock Position:  0.07803716348547743
Bond Position:  [-5.85780183]


portfolio before change:  [2.3431651]
curr_Stock_Price:  105.09522243619296
curr_Factors:  [105.09522244]
mat_Sqrt:  [[0.15]]
grads:  [-0.01882555]
Stock Position:  -0.018825546876925597
Bond Position:  [4.32164013]


portfolio before change:  [2.33655231]
curr_Stock_Price:  105.460837380997
curr_Factors:  [105.46083738]
mat_Sqrt:  [[0.15]]
grads:  [0.07739504]
Stock Position:  0.0773950367977328
Bond Position:  [-5.82559308]


portfolio before change:  [2.26576808]
curr_Stock_Price:  104.55095841424195
curr_Factors:  [104.55095841]
mat_Sqrt:  [[0.15]]
grads:  [0.07043801]
Stock Position:  0.07043801082781849
Bond Position:  [-5.09859346]


portfolio before change:  [2.34919258]
curr_Stock_Price:  105.73985017743534
curr_Factors:  [105.73985018]
mat_Sqrt:  [[0.15]]
grads:  [-0.02056697]
Stock Position:  -0.020566971603815747
Bond Position:  [4.52394108]


portfolio before change:  [2.36195091]
curr_Stock_Price:  105.13326718169704
curr_Factors:  [105.13326718]
mat_Sqrt:  [[0.15]]
grads:  [0.09080265]
Stock Position:  0.09080264978906065
Bond Position:  [-7.18442833]


portfolio before change:  [2.39917815]
curr_Stock_Price:  105.54819208740476
curr_Factors:  [105.54819209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00970864]
Stock Position:  -0.009708637375044066
Bond Position:  [3.42390727]


portfolio before change:  [2.3985631]
curr_Stock_Price:  105.63358482018235
curr_Factors:  [105.63358482]
mat_Sqrt:  [[0.15]]
grads:  [0.13256749]
Stock Position:  0.13256749367723406
Bond Position:  [-11.60501648]


portfolio before change:  [2.50777253]
curr_Stock_Price:  106.46285871546785
curr_Factors:  [106.46285872]
mat_Sqrt:  [[0.15]]
grads:  [0.14056349]
Stock Position:  0.1405634868744164
Bond Position:  [-12.45701811]


portfolio before change:  [2.54621592]
curr_Stock_Price:  106.74189259752809
curr_Factors:  [106.7418926]
mat_Sqrt:  [[0.15]]
grads:  [-0.05060933]
Stock Position:  -0.05060933197307363
Bond Position:  [7.94835179]


portfolio before change:  [2.54359732]
curr_Stock_Price:  106.80345010870226
curr_Factors:  [106.80345011]
mat_Sqrt:  [[0.15]]
grads:  [-0.39999564]
Stock Position:  -0.3999956374682366
Bond Position:  [45.26451143]


portfolio before change:  [2.7509876]
curr_Stock_Price:  106.2920416290756
curr_Factors:  [106.29204163]
mat_Sqrt:  [[0.15]]
grads:  [-0.10827895]
Stock Position:  -0.10827895157407272
Bond Position:  [14.26017843]


portfolio before change:  [2.65906597]
curr_Stock_Price:  107.14920658297932
curr_Factors:  [107.14920658]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437127]
Stock Position:  -0.014371266014972394
Bond Position:  [4.19893572]


portfolio before change:  [2.6460667]
curr_Stock_Price:  108.0720001257299
curr_Factors:  [108.07200013]
mat_Sqrt:  [[0.15]]
grads:  [-0.04331748]
Stock Position:  -0.04331748343088538
Bond Position:  [7.32747377]


portfolio before change:  [2.60787369]
curr_Stock_Price:  108.9642724008691
curr_Factors:  [108.9642724]
mat_Sqrt:  [[0.15]]
grads:  [-0.09554656]
Stock Position:  -0.09554656431685085
Bond Position:  [13.01903555]


portfolio before change:  [2.61200553]
curr_Stock_Price:  108.92954460266965
curr_Factors:  [108.9295446]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354263]
Stock Position:  -0.013542627028060486
Bond Position:  [4.08719772]


portfolio before change:  [2.61740816]
curr_Stock_Price:  108.5494722447313
curr_Factors:  [108.54947224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01920019]
Stock Position:  -0.01920019251410207
Bond Position:  [4.70157893]


portfolio before change:  [2.61286317]
curr_Stock_Price:  108.80149338879681
curr_Factors:  [108.80149339]
mat_Sqrt:  [[0.15]]
grads:  [-0.05232776]
Stock Position:  -0.0523277580147221
Bond Position:  [8.30620138]


portfolio before change:  [2.6603705]
curr_Stock_Price:  107.9035343697073
curr_Factors:  [107.90353437]
mat_Sqrt:  [[0.15]]
grads:  [-0.03326907]
Stock Position:  -0.03326906958693782
Bond Position:  [6.2502207]


portfolio before change:  [2.653252]
curr_Stock_Price:  108.12924425128972
curr_Factors:  [108.12924425]
mat_Sqrt:  [[0.15]]
grads:  [-0.1109179]
Stock Position:  -0.1109178964157079
Bond Position:  [14.64672031]


portfolio before change:  [2.73796045]
curr_Stock_Price:  107.37379347657749
curr_Factors:  [107.37379348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00082313]
Stock Position:  -0.0008231266352636559
Bond Position:  [2.82634268]


portfolio before change:  [2.73856073]
curr_Stock_Price:  106.85914022936261
curr_Factors:  [106.85914023]
mat_Sqrt:  [[0.15]]
grads:  [0.0020654]
Stock Position:  0.0020654034391713594
Bond Position:  [2.5178535]


portfolio before change:  [2.7400812]
curr_Stock_Price:  107.51910920248523
curr_Factors:  [107.5191092]
mat_Sqrt:  [[0.15]]
grads:  [0.17769494]
Stock Position:  0.17769494426889193
Bond Position:  [-16.36552091]


portfolio before change:  [2.70026247]
curr_Stock_Price:  107.3007807814146
curr_Factors:  [107.30078078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01058848]
Stock Position:  -0.010588484934927304
Bond Position:  [3.83641517]


portfolio before change:  [2.69971516]
curr_Stock_Price:  107.37511584567201
curr_Factors:  [107.37511585]
mat_Sqrt:  [[0.15]]
grads:  [0.12576672]
Stock Position:  0.1257667172503191
Bond Position:  [-10.80450068]


portfolio before change:  [2.73090799]
curr_Stock_Price:  107.62850666069973
curr_Factors:  [107.62850666]
mat_Sqrt:  [[0.15]]
grads:  [0.05828338]
Stock Position:  0.058283380715990485
Bond Position:  [-3.54204524]


portfolio before change:  [2.77866769]
curr_Stock_Price:  108.45174459692272
curr_Factors:  [108.4517446]
mat_Sqrt:  [[0.15]]
grads:  [0.0779672]
Stock Position:  0.07796720275177249
Bond Position:  [-5.67701147]


portfolio before change:  [2.73076793]
curr_Stock_Price:  107.84193771885924
curr_Factors:  [107.84193772]
mat_Sqrt:  [[0.15]]
grads:  [0.04866902]
Stock Position:  0.048669017000211603
Bond Position:  [-2.51779317]


portfolio before change:  [2.78999819]
curr_Stock_Price:  109.06217240108225
curr_Factors:  [109.0621724]
mat_Sqrt:  [[0.15]]
grads:  [-0.09586348]
Stock Position:  -0.09586348165855701
Bond Position:  [13.24507775]


portfolio before change:  [2.73700223]
curr_Stock_Price:  109.6236353964843
curr_Factors:  [109.6236354]
mat_Sqrt:  [[0.15]]
grads:  [-0.40740436]
Stock Position:  -0.40740435634953315
Bond Position:  [47.39814885]


portfolio before change:  [2.84472113]
curr_Stock_Price:  109.3665040665143
curr_Factors:  [109.36650407]
mat_Sqrt:  [[0.15]]
grads:  [0.00282434]
Stock Position:  0.002824335617437076
Bond Position:  [2.53583342]


portfolio before change:  [2.84486057]
curr_Stock_Price:  109.35975613388237
curr_Factors:  [109.35975613]
mat_Sqrt:  [[0.15]]
grads:  [-0.08779847]
Stock Position:  -0.0877984740828959
Bond Position:  [12.44648028]


portfolio before change:  [2.7797681]
curr_Stock_Price:  110.1100014600623
curr_Factors:  [110.11000146]
mat_Sqrt:  [[0.15]]
grads:  [-0.21506022]
Stock Position:  -0.21506022229983948
Bond Position:  [26.4600495]


portfolio before change:  [2.76831619]
curr_Stock_Price:  110.17094120706862
curr_Factors:  [110.17094121]
mat_Sqrt:  [[0.15]]
grads:  [-0.04407809]
Stock Position:  -0.044078090086464565
Bond Position:  [7.62444086]


portfolio before change:  [2.75679572]
curr_Stock_Price:  110.44311763621748
curr_Factors:  [110.44311764]
mat_Sqrt:  [[0.15]]
grads:  [0.16432646]
Stock Position:  0.16432645723038505
Bond Position:  [-15.39193053]


portfolio before change:  [2.72217679]
curr_Stock_Price:  110.2383003420971
curr_Factors:  [110.23830034]
mat_Sqrt:  [[0.15]]
grads:  [0.64443734]
Stock Position:  0.6444373433806353
Bond Position:  [-68.31950062]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.97379463]
Stock Price:  110.63537221607758
PL:  [-7.66157758]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32833648e-02]
 [ 7.02331859e-03]
 [ 1.55446623e-02]
 [-1.03046505e-02]
 [ 1.49550557e-02]
 [-4.34953260e-03]
 [ 3.44614286e-04]
 [-1.36895744e-02]
 [-2.62878223e-03]
 [-3.62072923e-03]
 [ 1.23471587e-02]
 [-4.50775199e-03]
 [-6.30631069e-04]
 [ 7.40733018e-03]
 [-5.99323539e-04]
 [ 1.16184578e-02]
 [ 3.09956567e-02]
 [-1.47032031e-02]
 [ 2.03810966e-02]
 [ 2.11506354e-03]
 [-4.14663640e-03]
 [ 4.56359700e-03]
 [ 1.66421708e-02]
 [ 1.76020448e-02]
 [-5.81902787e-03]
 [ 4.56148924e-03]
 [ 3.18967098e-03]
 [ 8.01090058e-03]
 [ 1.56764365e-02]
 [ 1.23606400e-03]
 [-8.41185160e-03]
 [ 8.78802174e-03]
 [ 1.19943915e-02]
 [-4.88161061e-03]
 [ 7.61207183e-03]
 [ 1.27559031e-02]
 [-1.51194944e-02]
 [ 2.91006536e-03]
 [-5.18383624e-02]
 [-5.49330338e-03]
 [ 5.15104817e-03]
 [ 8.46583249e-03]
 [-4.21705059e-03]
 [-3.61999321e-03]
 [ 1.33558155e-02]
 [ 1.26328067e-02]
 [ 1.06477256e-02]
 [ 1.72691296e-03]
 [ 1.58370908e-02]
 [-1.17446240e-03]
 [ 2.18512717e-02]
 [-8.41055926e-03]
 [ 6.71621268e-04]
 [-1.50798282e-02]
 [-2.55572827e-03]
 [-2.93321529e-03]
 [ 1.06917021e-02]
 [-1.11517597e-02]
 [ 5.13999483e-03]
 [-3.72646753e-03]
 [-3.55817219e-03]
 [ 5.83389960e-03]
 [-1.90271689e-02]
 [ 1.65163265e-03]
 [ 1.96940565e-02]
 [ 1.24691248e-02]
 [ 5.91807109e-03]
 [ 1.02660833e-02]
 [ 6.80010658e-03]
 [ 1.26099796e-02]
 [ 1.53488718e-03]
 [-1.51908250e-02]
 [-1.66462791e-02]
 [ 8.41804277e-04]
 [ 1.31764561e-03]
 [-1.80120694e-02]
 [-3.47795869e-03]
 [ 1.12837724e-02]
 [-4.32124023e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.45575525]
curr_Stock_Price:  99.52376250306092
curr_Factors:  [99.5237625]
mat_Sqrt:  [[0.15]]
grads:  [-0.08855577]
Stock Position:  -0.08855576535381429
Bond Position:  [0.35764771]


portfolio before change:  [-8.48268532]
curr_Stock_Price:  99.82811786594434
curr_Factors:  [99.82811787]
mat_Sqrt:  [[0.15]]
grads:  [0.04682212]
Stock Position:  0.046822123918286745
Bond Position:  [-13.15684982]


portfolio before change:  [-8.50928106]
curr_Stock_Price:  99.27766416217104
curr_Factors:  [99.27766416]
mat_Sqrt:  [[0.15]]
grads:  [0.10363108]
Stock Position:  0.10363108226888154
Bond Position:  [-18.79753284]


portfolio before change:  [-8.52403585]
curr_Stock_Price:  99.14662324603204
curr_Factors:  [99.14662325]
mat_Sqrt:  [[0.15]]
grads:  [-0.06869767]
Stock Position:  -0.06869767022656756
Bond Position:  [-1.71289382]


portfolio before change:  [-8.55886921]
curr_Stock_Price:  99.65211777018511
curr_Factors:  [99.65211777]
mat_Sqrt:  [[0.15]]
grads:  [0.09970037]
Stock Position:  0.09970037100563593
Bond Position:  [-18.49422232]


portfolio before change:  [-8.50481442]
curr_Stock_Price:  100.20588415682599
curr_Factors:  [100.20588416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899688]
Stock Position:  -0.02899688400585981
Bond Position:  [-5.59915602]


portfolio before change:  [-8.50579889]
curr_Stock_Price:  100.22776639363005
curr_Factors:  [100.22776639]
mat_Sqrt:  [[0.15]]
grads:  [0.00229743]
Stock Position:  0.0022974285755946247
Bond Position:  [-8.73606503]


portfolio before change:  [-8.50594874]
curr_Stock_Price:  100.40020683543692
curr_Factors:  [100.40020684]
mat_Sqrt:  [[0.15]]
grads:  [-0.09126383]
Stock Position:  -0.09126382903214732
Bond Position:  [0.65695857]


portfolio before change:  [-8.48370427]
curr_Stock_Price:  100.15691859459749
curr_Factors:  [100.15691859]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752521]
Stock Position:  -0.017525214899553172
Bond Position:  [-6.72843274]


portfolio before change:  [-8.47894407]
curr_Stock_Price:  99.8613021725283
curr_Factors:  [99.86130217]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413819]
Stock Position:  -0.024138194842412433
Bond Position:  [-6.0684725]


portfolio before change:  [-8.48486502]
curr_Stock_Price:  100.09088282875695
curr_Factors:  [100.09088283]
mat_Sqrt:  [[0.15]]
grads:  [0.08231439]
Stock Position:  0.08231439145781454
Bond Position:  [-16.72378513]


portfolio before change:  [-8.51469077]
curr_Stock_Price:  99.74124184030917
curr_Factors:  [99.74124184]
mat_Sqrt:  [[0.15]]
grads:  [-0.03005168]
Stock Position:  -0.030051679920686584
Bond Position:  [-5.5172989]


portfolio before change:  [-8.49790002]
curr_Stock_Price:  99.17103764800738
curr_Factors:  [99.17103765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00420421]
Stock Position:  -0.004204207128044787
Bond Position:  [-8.08096444]


portfolio before change:  [-8.49975074]
curr_Stock_Price:  99.49110694770397
curr_Factors:  [99.49110695]
mat_Sqrt:  [[0.15]]
grads:  [0.0493822]
Stock Position:  0.04938220117480661
Bond Position:  [-13.41284059]


portfolio before change:  [-8.50966074]
curr_Stock_Price:  99.30740360853724
curr_Factors:  [99.30740361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00399549]
Stock Position:  -0.003995490258479305
Bond Position:  [-8.11287898]


portfolio before change:  [-8.51062818]
curr_Stock_Price:  99.42262703335608
curr_Factors:  [99.42262703]
mat_Sqrt:  [[0.15]]
grads:  [0.07745639]
Stock Position:  0.0774563852541966
Bond Position:  [-16.21154549]


portfolio before change:  [-8.48242077]
curr_Stock_Price:  99.79988024490801
curr_Factors:  [99.79988024]
mat_Sqrt:  [[0.15]]
grads:  [0.20663771]
Stock Position:  0.20663771134677905
Bond Position:  [-29.10483961]


portfolio before change:  [-8.37467165]
curr_Stock_Price:  100.33012339885494
curr_Factors:  [100.3301234]
mat_Sqrt:  [[0.15]]
grads:  [-0.09802135]
Stock Position:  -0.09802135401464056
Bond Position:  [1.4598229]


portfolio before change:  [-8.31740386]
curr_Stock_Price:  99.7468164293875
curr_Factors:  [99.74681643]
mat_Sqrt:  [[0.15]]
grads:  [0.13587398]
Stock Position:  0.13587397700662296
Bond Position:  [-21.87040051]


portfolio before change:  [-8.34240812]
curr_Stock_Price:  99.57285144172086
curr_Factors:  [99.57285144]
mat_Sqrt:  [[0.15]]
grads:  [0.01410042]
Stock Position:  0.014100423626204915
Bond Position:  [-9.74642751]


portfolio before change:  [-8.34715184]
curr_Stock_Price:  99.27962980239306
curr_Factors:  [99.2796298]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764424]
Stock Position:  -0.02764424263661422
Bond Position:  [-5.60264167]


portfolio before change:  [-8.35989487]
curr_Stock_Price:  99.72792772297704
curr_Factors:  [99.72792772]
mat_Sqrt:  [[0.15]]
grads:  [0.03042398]
Stock Position:  0.030423980005504083
Bond Position:  [-11.39401535]


portfolio before change:  [-8.35911235]
curr_Stock_Price:  99.77705584669292
curr_Factors:  [99.77705585]
mat_Sqrt:  [[0.15]]
grads:  [0.11094781]
Stock Position:  0.11094780546620535
Bond Position:  [-19.42915773]


portfolio before change:  [-8.37507635]
curr_Stock_Price:  99.64411368959433
curr_Factors:  [99.64411369]
mat_Sqrt:  [[0.15]]
grads:  [0.11734697]
Stock Position:  0.1173469650805876
Bond Position:  [-20.06801068]


portfolio before change:  [-8.36609343]
curr_Stock_Price:  99.73135248775017
curr_Factors:  [99.73135249]
mat_Sqrt:  [[0.15]]
grads:  [-0.03879352]
Stock Position:  -0.03879351915962233
Bond Position:  [-4.4971633]


portfolio before change:  [-8.36887488]
curr_Stock_Price:  99.79580581006677
curr_Factors:  [99.79580581]
mat_Sqrt:  [[0.15]]
grads:  [0.03040993]
Stock Position:  0.030409928280963734
Bond Position:  [-11.40365818]


portfolio before change:  [-8.37053677]
curr_Stock_Price:  99.76459445517528
curr_Factors:  [99.76459446]
mat_Sqrt:  [[0.15]]
grads:  [0.02126447]
Stock Position:  0.02126447316768488
Bond Position:  [-10.49197831]


portfolio before change:  [-8.37865136]
curr_Stock_Price:  99.41383028447963
curr_Factors:  [99.41383028]
mat_Sqrt:  [[0.15]]
grads:  [0.053406]
Stock Position:  0.05340600383509433
Bond Position:  [-13.68794676]


portfolio before change:  [-8.41023328]
curr_Stock_Price:  98.83849413642692
curr_Factors:  [98.83849414]
mat_Sqrt:  [[0.15]]
grads:  [0.10450958]
Stock Position:  0.10450957654019133
Bond Position:  [-18.73980245]


portfolio before change:  [-8.32396604]
curr_Stock_Price:  99.67514973122613
curr_Factors:  [99.67514973]
mat_Sqrt:  [[0.15]]
grads:  [0.00824043]
Stock Position:  0.008240426638353171
Bond Position:  [-9.14533179]


portfolio before change:  [-8.32068541]
curr_Stock_Price:  100.14262840248988
curr_Factors:  [100.1426284]
mat_Sqrt:  [[0.15]]
grads:  [-0.05607901]
Stock Position:  -0.0560790106828609
Bond Position:  [-2.70478588]


portfolio before change:  [-8.30911125]
curr_Stock_Price:  99.93322357331948
curr_Factors:  [99.93322357]
mat_Sqrt:  [[0.15]]
grads:  [0.05858681]
Stock Position:  0.058586811580028965
Bond Position:  [-14.16388019]


portfolio before change:  [-8.32066825]
curr_Stock_Price:  99.75107109941086
curr_Factors:  [99.7510711]
mat_Sqrt:  [[0.15]]
grads:  [0.07996261]
Stock Position:  0.07996260967592753
Bond Position:  [-16.29702422]


portfolio before change:  [-8.31760554]
curr_Stock_Price:  99.8021113392506
curr_Factors:  [99.80211134]
mat_Sqrt:  [[0.15]]
grads:  [-0.03254407]
Stock Position:  -0.03254407070184761
Bond Position:  [-5.06963857]


portfolio before change:  [-8.3210016]
curr_Stock_Price:  99.89672748236217
curr_Factors:  [99.89672748]
mat_Sqrt:  [[0.15]]
grads:  [0.05074715]
Stock Position:  0.05074714554773468
Bond Position:  [-13.39047537]


portfolio before change:  [-8.30765331]
curr_Stock_Price:  100.17625485517893
curr_Factors:  [100.17625486]
mat_Sqrt:  [[0.15]]
grads:  [0.08503935]
Stock Position:  0.08503935375165714
Bond Position:  [-16.82657729]


portfolio before change:  [-8.32711273]
curr_Stock_Price:  99.95979362265783
curr_Factors:  [99.95979362]
mat_Sqrt:  [[0.15]]
grads:  [-0.10079663]
Stock Position:  -0.10079662928158611
Bond Position:  [1.74849753]


portfolio before change:  [-8.353621]
curr_Stock_Price:  100.22386549582473
curr_Factors:  [100.2238655]
mat_Sqrt:  [[0.15]]
grads:  [0.01940044]
Stock Position:  0.019400435762150763
Bond Position:  [-10.29800766]


portfolio before change:  [-8.34200274]
curr_Stock_Price:  100.85590836473055
curr_Factors:  [100.85590836]
mat_Sqrt:  [[0.15]]
grads:  [-0.34558908]
Stock Position:  -0.34558908287394646
Bond Position:  [26.51269814]


portfolio before change:  [-8.52995048]
curr_Stock_Price:  101.4045508191431
curr_Factors:  [101.40455082]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662202]
Stock Position:  -0.036622022518777816
Bond Position:  [-4.81631074]


portfolio before change:  [-8.52810655]
curr_Stock_Price:  101.34598049419749
curr_Factors:  [101.34598049]
mat_Sqrt:  [[0.15]]
grads:  [0.03434032]
Stock Position:  0.03434032110522057
Bond Position:  [-12.00836006]


portfolio before change:  [-8.52825125]
curr_Stock_Price:  101.36362296312264
curr_Factors:  [101.36362296]
mat_Sqrt:  [[0.15]]
grads:  [0.05643888]
Stock Position:  0.05643888324708679
Bond Position:  [-14.24910093]


portfolio before change:  [-8.52595276]
curr_Stock_Price:  101.42012795812647
curr_Factors:  [101.42012796]
mat_Sqrt:  [[0.15]]
grads:  [-0.02811367]
Stock Position:  -0.028113670574853145
Bond Position:  [-5.6746607]


portfolio before change:  [-8.53947797]
curr_Stock_Price:  101.8886020239656
curr_Factors:  [101.88860202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413329]
Stock Position:  -0.024133288091236587
Bond Position:  [-6.08057098]


portfolio before change:  [-8.53462678]
curr_Stock_Price:  101.67183769546114
curr_Factors:  [101.6718377]
mat_Sqrt:  [[0.15]]
grads:  [0.08903877]
Stock Position:  0.08903876979932498
Bond Position:  [-17.58736213]


portfolio before change:  [-8.50301421]
curr_Stock_Price:  102.03922611559143
curr_Factors:  [102.03922612]
mat_Sqrt:  [[0.15]]
grads:  [0.08421871]
Stock Position:  0.0842187112754105
Bond Position:  [-17.09662633]


portfolio before change:  [-8.53246934]
curr_Stock_Price:  101.70216846370414
curr_Factors:  [101.70216846]
mat_Sqrt:  [[0.15]]
grads:  [0.07098484]
Stock Position:  0.07098483700103816
Bond Position:  [-15.7517812]


portfolio before change:  [-8.53775251]
curr_Stock_Price:  101.64161112521593
curr_Factors:  [101.64161113]
mat_Sqrt:  [[0.15]]
grads:  [0.01151275]
Stock Position:  0.011512753082118177
Bond Position:  [-9.70792729]


portfolio before change:  [-8.53197595]
curr_Stock_Price:  102.19606826730914
curr_Factors:  [102.19606827]
mat_Sqrt:  [[0.15]]
grads:  [0.10558061]
Stock Position:  0.10558060564872372
Bond Position:  [-19.32189873]


portfolio before change:  [-8.51175193]
curr_Stock_Price:  102.39905701945322
curr_Factors:  [102.39905702]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782975]
Stock Position:  -0.007829749316633043
Bond Position:  [-7.70999299]


portfolio before change:  [-8.51576991]
curr_Stock_Price:  102.85067969269872
curr_Factors:  [102.85067969]
mat_Sqrt:  [[0.15]]
grads:  [0.14567514]
Stock Position:  0.14567514444909316
Bond Position:  [-23.49855753]


portfolio before change:  [-8.56486786]
curr_Stock_Price:  102.52372452279083
curr_Factors:  [102.52372452]
mat_Sqrt:  [[0.15]]
grads:  [-0.0560704]
Stock Position:  -0.056070395094867664
Bond Position:  [-2.81632212]


portfolio before change:  [-8.54071791]
curr_Stock_Price:  102.08987738829182
curr_Factors:  [102.08987739]
mat_Sqrt:  [[0.15]]
grads:  [0.00447748]
Stock Position:  0.004477475123052022
Bond Position:  [-8.99782279]


portfolio before change:  [-8.53699169]
curr_Stock_Price:  103.04769293201961
curr_Factors:  [103.04769293]
mat_Sqrt:  [[0.15]]
grads:  [-0.10053219]
Stock Position:  -0.10053218774590203
Bond Position:  [1.82261832]


portfolio before change:  [-8.55345467]
curr_Stock_Price:  103.21258435993592
curr_Factors:  [103.21258436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01703819]
Stock Position:  -0.01703818844756335
Bond Position:  [-6.79489921]


portfolio before change:  [-8.56086375]
curr_Stock_Price:  103.62250958809318
curr_Factors:  [103.62250959]
mat_Sqrt:  [[0.15]]
grads:  [-0.01955477]
Stock Position:  -0.019554768587730777
Bond Position:  [-6.53454955]


portfolio before change:  [-8.54063718]
curr_Stock_Price:  102.56726875364069
curr_Factors:  [102.56726875]
mat_Sqrt:  [[0.15]]
grads:  [0.07127801]
Stock Position:  0.07127801374798665
Bond Position:  [-15.85142837]


portfolio before change:  [-8.51509785]
curr_Stock_Price:  102.93947437433268
curr_Factors:  [102.93947437]
mat_Sqrt:  [[0.15]]
grads:  [-0.07434506]
Stock Position:  -0.07434506483336017
Bond Position:  [-0.86205595]


portfolio before change:  [-8.52007773]
curr_Stock_Price:  103.00573300635469
curr_Factors:  [103.00573301]
mat_Sqrt:  [[0.15]]
grads:  [0.03426663]
Stock Position:  0.034266632184942254
Bond Position:  [-12.0497373]


portfolio before change:  [-8.51429027]
curr_Stock_Price:  103.19660664933869
curr_Factors:  [103.19660665]
mat_Sqrt:  [[0.15]]
grads:  [-0.02484312]
Stock Position:  -0.024843116859115687
Bond Position:  [-5.95056491]


portfolio before change:  [-8.51537484]
curr_Stock_Price:  103.22529277441998
curr_Factors:  [103.22529277]
mat_Sqrt:  [[0.15]]
grads:  [-0.02372115]
Stock Position:  -0.02372114795466965
Bond Position:  [-6.0667524]


portfolio before change:  [-8.52647014]
curr_Stock_Price:  103.67704628754153
curr_Factors:  [103.67704629]
mat_Sqrt:  [[0.15]]
grads:  [0.03889266]
Stock Position:  0.03889266401372176
Bond Position:  [-12.55874666]


portfolio before change:  [-8.55262166]
curr_Stock_Price:  103.02482621975481
curr_Factors:  [103.02482622]
mat_Sqrt:  [[0.15]]
grads:  [-0.12684779]
Stock Position:  -0.12684779283211892
Bond Position:  [4.51585015]


portfolio before change:  [-8.60558958]
curr_Stock_Price:  103.44462201259918
curr_Factors:  [103.44462201]
mat_Sqrt:  [[0.15]]
grads:  [0.01101088]
Stock Position:  0.01101088434556602
Bond Position:  [-9.74460635]


portfolio before change:  [-8.60603046]
curr_Stock_Price:  103.4598952327187
curr_Factors:  [103.45989523]
mat_Sqrt:  [[0.15]]
grads:  [0.13129371]
Stock Position:  0.13129370969096557
Bond Position:  [-22.18966391]


portfolio before change:  [-8.54429027]
curr_Stock_Price:  103.94070343690922
curr_Factors:  [103.94070344]
mat_Sqrt:  [[0.15]]
grads:  [0.0831275]
Stock Position:  0.0831274984296456
Bond Position:  [-17.18462093]


portfolio before change:  [-8.50833306]
curr_Stock_Price:  104.38617916541523
curr_Factors:  [104.38617917]
mat_Sqrt:  [[0.15]]
grads:  [0.03945381]
Stock Position:  0.03945380728314892
Bond Position:  [-12.62676525]


portfolio before change:  [-8.52519723]
curr_Stock_Price:  103.97874132405533
curr_Factors:  [103.97874132]
mat_Sqrt:  [[0.15]]
grads:  [0.06844056]
Stock Position:  0.06844055519839644
Bond Position:  [-15.64156002]


portfolio before change:  [-8.51160163]
curr_Stock_Price:  104.19167398015159
curr_Factors:  [104.19167398]
mat_Sqrt:  [[0.15]]
grads:  [0.04533404]
Stock Position:  0.045334043850044276
Bond Position:  [-13.23503155]


portfolio before change:  [-8.54195441]
curr_Stock_Price:  103.54038504502702
curr_Factors:  [103.54038505]
mat_Sqrt:  [[0.15]]
grads:  [0.08406653]
Stock Position:  0.08406653050418839
Bond Position:  [-17.24623534]


portfolio before change:  [-8.49821489]
curr_Stock_Price:  104.07350378384888
curr_Factors:  [104.07350378]
mat_Sqrt:  [[0.15]]
grads:  [0.01023258]
Stock Position:  0.010232581216792888
Bond Position:  [-9.56315547]


portfolio before change:  [-8.49207198]
curr_Stock_Price:  104.73224464833109
curr_Factors:  [104.73224465]
mat_Sqrt:  [[0.15]]
grads:  [-0.10127217]
Stock Position:  -0.10127216695607247
Bond Position:  [2.11438938]


portfolio before change:  [-8.50931945]
curr_Stock_Price:  104.90385764892153
curr_Factors:  [104.90385765]
mat_Sqrt:  [[0.15]]
grads:  [-0.11097519]
Stock Position:  -0.11097519385122087
Bond Position:  [3.13240649]


portfolio before change:  [-8.51854642]
curr_Stock_Price:  104.98876629063693
curr_Factors:  [104.98876629]
mat_Sqrt:  [[0.15]]
grads:  [0.00561203]
Stock Position:  0.005612028516616784
Bond Position:  [-9.10774637]


portfolio before change:  [-8.52193758]
curr_Stock_Price:  104.48593465530288
curr_Factors:  [104.48593466]
mat_Sqrt:  [[0.15]]
grads:  [0.0087843]
Stock Position:  0.00878430407072879
Bond Position:  [-9.4397738]


portfolio before change:  [-8.52924819]
curr_Stock_Price:  103.72086462985189
curr_Factors:  [103.72086463]
mat_Sqrt:  [[0.15]]
grads:  [-0.12008046]
Stock Position:  -0.12008046277628318
Bond Position:  [3.92560123]


portfolio before change:  [-8.51850304]
curr_Stock_Price:  103.63342498652823
curr_Factors:  [103.63342499]
mat_Sqrt:  [[0.15]]
grads:  [-0.02318639]
Stock Position:  -0.0231863912422371
Bond Position:  [-6.1156179]


portfolio before change:  [-8.52003817]
curr_Stock_Price:  103.68314789696167
curr_Factors:  [103.6831479]
mat_Sqrt:  [[0.15]]
grads:  [0.07522515]
Stock Position:  0.07522514936177077
Bond Position:  [-16.31961846]


portfolio before change:  [-8.5574759]
curr_Stock_Price:  103.19903163243904
curr_Factors:  [103.19903163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02880827]
Stock Position:  -0.02880826821334812
Bond Position:  [-5.58449052]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.55125322]
Stock Price:  102.97091221942209
PL:  [-11.52216544]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.30770557e-02]
 [-2.07128345e-02]
 [ 3.81686850e-02]
 [-1.22295160e-02]
 [ 1.09367463e-02]
 [-1.47600651e-02]
 [-1.33243749e-02]
 [ 5.39987517e-02]
 [-2.08929510e-02]
 [-1.33383789e-02]
 [ 1.13015888e-02]
 [-7.12305034e-03]
 [ 3.91314418e-03]
 [-3.56120004e-03]
 [-1.87305774e-03]
 [ 6.44020088e-03]
 [-1.87224055e-02]
 [-1.31367942e-02]
 [ 2.46666124e-02]
 [ 3.81240405e-04]
 [-3.77355845e-03]
 [ 4.39094357e-03]
 [ 1.62000557e-02]
 [ 1.73436313e-02]
 [-3.90903054e-03]
 [ 6.66142959e-03]
 [-8.15033306e-03]
 [ 1.39293612e-02]
 [ 2.14522436e-02]
 [-8.04675685e-03]
 [-2.20041932e-03]
 [ 1.38926646e-02]
 [ 1.34731451e-02]
 [ 1.83264475e-03]
 [ 6.07413487e-03]
 [ 1.69971713e-02]
 [-2.72312711e-02]
 [-5.91875271e-04]
 [-3.24170333e-02]
 [-1.14678061e-02]
 [ 3.53433732e-03]
 [ 6.57997202e-03]
 [-1.21698790e-02]
 [ 1.06500825e-02]
 [-2.69791647e-03]
 [ 1.16196429e-02]
 [ 1.05583719e-02]
 [-2.38870744e-03]
 [ 1.31777666e-02]
 [-1.38680275e-03]
 [ 2.10302160e-02]
 [ 4.87646687e-03]
 [-1.79273000e-03]
 [-2.40591681e-02]
 [-7.96437905e-03]
 [-2.79670222e-03]
 [ 6.84653799e-03]
 [-1.75502988e-02]
 [ 3.00831221e-03]
 [-3.20609878e-03]
 [-6.27921285e-03]
 [ 2.80291780e-03]
 [-1.90071635e-02]
 [ 4.53867733e-04]
 [ 1.07785293e-02]
 [ 1.76229989e-02]
 [ 4.80497970e-03]
 [ 1.41987291e-02]
 [ 6.78630603e-03]
 [ 1.18491431e-02]
 [ 1.40389852e-03]
 [-1.53111298e-02]
 [-1.03757662e-02]
 [ 9.39401156e-04]
 [ 2.49148417e-03]
 [-2.05415566e-02]
 [-3.98642866e-03]
 [ 1.14136796e-02]
 [ 2.49825719e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.78393219]
curr_Stock_Price:  99.46343942838658
curr_Factors:  [99.46343943]
mat_Sqrt:  [[0.15]]
grads:  [-0.08718037]
Stock Position:  -0.08718037144201059
Bond Position:  [-1.11267259]


portfolio before change:  [-9.72860873]
curr_Stock_Price:  98.82805562167009
curr_Factors:  [98.82805562]
mat_Sqrt:  [[0.15]]
grads:  [-0.13808556]
Stock Position:  -0.13808556314132697
Bond Position:  [3.91811898]


portfolio before change:  [-9.72607848]
curr_Stock_Price:  98.81150527780365
curr_Factors:  [98.81150528]
mat_Sqrt:  [[0.15]]
grads:  [0.2544579]
Stock Position:  0.25445790016363956
Bond Position:  [-34.86944662]


portfolio before change:  [-9.76327963]
curr_Stock_Price:  98.67387253099768
curr_Factors:  [98.67387253]
mat_Sqrt:  [[0.15]]
grads:  [-0.08153011]
Stock Position:  -0.08153010649962973
Bond Position:  [-1.71838829]


portfolio before change:  [-9.78231737]
curr_Stock_Price:  98.90606087611259
curr_Factors:  [98.90606088]
mat_Sqrt:  [[0.15]]
grads:  [0.07291164]
Stock Position:  0.07291164225602254
Bond Position:  [-16.9937207]


portfolio before change:  [-9.81330658]
curr_Stock_Price:  98.49560417327612
curr_Factors:  [98.49560417]
mat_Sqrt:  [[0.15]]
grads:  [-0.09840043]
Stock Position:  -0.09840043411103475
Bond Position:  [-0.12129638]


portfolio before change:  [-9.82744714]
curr_Stock_Price:  98.63923129347555
curr_Factors:  [98.63923129]
mat_Sqrt:  [[0.15]]
grads:  [-0.08882917]
Stock Position:  -0.08882916619017786
Bond Position:  [-1.06540647]


portfolio before change:  [-9.76134726]
curr_Stock_Price:  97.89435805758664
curr_Factors:  [97.89435806]
mat_Sqrt:  [[0.15]]
grads:  [0.35999168]
Stock Position:  0.3599916778337864
Bond Position:  [-45.00250147]


portfolio before change:  [-9.8025087]
curr_Stock_Price:  97.78783142595115
curr_Factors:  [97.78783143]
mat_Sqrt:  [[0.15]]
grads:  [-0.13928634]
Stock Position:  -0.1392863398933834
Bond Position:  [3.81800042]


portfolio before change:  [-9.80342945]
curr_Stock_Price:  97.79615510672258
curr_Factors:  [97.79615511]
mat_Sqrt:  [[0.15]]
grads:  [-0.08892253]
Stock Position:  -0.08892252583171194
Bond Position:  [-1.10714832]


portfolio before change:  [-9.8795627]
curr_Stock_Price:  98.65155198488353
curr_Factors:  [98.65155198]
mat_Sqrt:  [[0.15]]
grads:  [0.07534393]
Stock Position:  0.07534392514189486
Bond Position:  [-17.31235784]


portfolio before change:  [-9.89637122]
curr_Stock_Price:  98.44282288018528
curr_Factors:  [98.44282288]
mat_Sqrt:  [[0.15]]
grads:  [-0.047487]
Stock Position:  -0.047487002249958936
Bond Position:  [-5.22161667]


portfolio before change:  [-9.87277729]
curr_Stock_Price:  97.93909990690197
curr_Factors:  [97.93909991]
mat_Sqrt:  [[0.15]]
grads:  [0.02608763]
Stock Position:  0.026087627877140602
Bond Position:  [-12.42777608]


portfolio before change:  [-9.8716792]
curr_Stock_Price:  98.01096711792711
curr_Factors:  [98.01096712]
mat_Sqrt:  [[0.15]]
grads:  [-0.02374133]
Stock Position:  -0.023741333602354614
Bond Position:  [-7.54476814]


portfolio before change:  [-9.87225893]
curr_Stock_Price:  98.01552288321828
curr_Factors:  [98.01552288]
mat_Sqrt:  [[0.15]]
grads:  [-0.01248705]
Stock Position:  -0.012487051615240875
Bond Position:  [-8.64833403]


portfolio before change:  [-9.87724112]
curr_Stock_Price:  98.37122355501758
curr_Factors:  [98.37122356]
mat_Sqrt:  [[0.15]]
grads:  [0.04293467]
Stock Position:  0.04293467251758534
Bond Position:  [-14.10077739]


portfolio before change:  [-9.89965547]
curr_Stock_Price:  97.86969357089157
curr_Factors:  [97.86969357]
mat_Sqrt:  [[0.15]]
grads:  [-0.12481604]
Stock Position:  -0.12481603698455121
Bond Position:  [2.31605182]


portfolio before change:  [-9.95853695]
curr_Stock_Price:  98.34259944190994
curr_Factors:  [98.34259944]
mat_Sqrt:  [[0.15]]
grads:  [-0.08757863]
Stock Position:  -0.08757862786659691
Bond Position:  [-1.34582703]


portfolio before change:  [-9.99677773]
curr_Stock_Price:  98.77828411082153
curr_Factors:  [98.77828411]
mat_Sqrt:  [[0.15]]
grads:  [0.16444408]
Stock Position:  0.16444408248499637
Bond Position:  [-26.24028203]


portfolio before change:  [-9.99288071]
curr_Stock_Price:  98.81195566627768
curr_Factors:  [98.81195567]
mat_Sqrt:  [[0.15]]
grads:  [0.0025416]
Stock Position:  0.0025416026977210897
Bond Position:  [-10.24402144]


portfolio before change:  [-9.99171905]
curr_Stock_Price:  99.52093242456087
curr_Factors:  [99.52093242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02515706]
Stock Position:  -0.025157056360914865
Bond Position:  [-7.48806534]


portfolio before change:  [-10.00068171]
curr_Stock_Price:  99.85859700136912
curr_Factors:  [99.858597]
mat_Sqrt:  [[0.15]]
grads:  [0.02927296]
Stock Position:  0.029272957146242708
Bond Position:  [-12.92383814]


portfolio before change:  [-10.00105415]
curr_Stock_Price:  99.873468238684
curr_Factors:  [99.87346824]
mat_Sqrt:  [[0.15]]
grads:  [0.10800037]
Stock Position:  0.10800037159661893
Bond Position:  [-20.78742583]


portfolio before change:  [-9.9866478]
curr_Stock_Price:  100.01889001656174
curr_Factors:  [100.01889002]
mat_Sqrt:  [[0.15]]
grads:  [0.11562421]
Stock Position:  0.11562420835168499
Bond Position:  [-21.55125278]


portfolio before change:  [-9.93579591]
curr_Stock_Price:  100.4703429599592
curr_Factors:  [100.47034296]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260602]
Stock Position:  -0.026060203631569235
Bond Position:  [-7.31751831]


portfolio before change:  [-9.94657187]
curr_Stock_Price:  100.8662955666309
curr_Factors:  [100.86629557]
mat_Sqrt:  [[0.15]]
grads:  [0.04440953]
Stock Position:  0.044409530578623714
Bond Position:  [-14.42599671]


portfolio before change:  [-9.93006421]
curr_Stock_Price:  101.25831300059762
curr_Factors:  [101.258313]
mat_Sqrt:  [[0.15]]
grads:  [-0.05433555]
Stock Position:  -0.054335553728100096
Bond Position:  [-4.42813771]


portfolio before change:  [-9.95763178]
curr_Stock_Price:  101.76057718543187
curr_Factors:  [101.76057719]
mat_Sqrt:  [[0.15]]
grads:  [0.09286241]
Stock Position:  0.0928624078991281
Bond Position:  [-19.40736401]


portfolio before change:  [-9.87218728]
curr_Stock_Price:  102.6937588818486
curr_Factors:  [102.69375888]
mat_Sqrt:  [[0.15]]
grads:  [0.14301496]
Stock Position:  0.1430149572177406
Bond Position:  [-24.55893081]


portfolio before change:  [-9.86522312]
curr_Stock_Price:  102.75318722584288
curr_Factors:  [102.75318723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05364505]
Stock Position:  -0.05364504569467153
Bond Position:  [-4.3530237]


portfolio before change:  [-9.83101515]
curr_Stock_Price:  102.11044298653705
curr_Factors:  [102.11044299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466946]
Stock Position:  -0.014669462105068587
Bond Position:  [-8.33310988]


portfolio before change:  [-9.83818062]
curr_Stock_Price:  102.56340003420806
curr_Factors:  [102.56340003]
mat_Sqrt:  [[0.15]]
grads:  [0.09261776]
Stock Position:  0.09261776381175578
Bond Position:  [-19.33737338]


portfolio before change:  [-9.86237941]
curr_Stock_Price:  102.31517376965294
curr_Factors:  [102.31517377]
mat_Sqrt:  [[0.15]]
grads:  [0.08982097]
Stock Position:  0.0898209672945558
Bond Position:  [-19.05242728]


portfolio before change:  [-9.86164366]
curr_Stock_Price:  102.33662264458613
curr_Factors:  [102.33662264]
mat_Sqrt:  [[0.15]]
grads:  [0.01221763]
Stock Position:  0.01221763165982312
Bond Position:  [-11.11195482]


portfolio before change:  [-9.86299542]
curr_Stock_Price:  102.28282812048234
curr_Factors:  [102.28282812]
mat_Sqrt:  [[0.15]]
grads:  [0.04049423]
Stock Position:  0.04049423248440974
Bond Position:  [-14.00486004]


portfolio before change:  [-9.89052289]
curr_Stock_Price:  101.62465682495696
curr_Factors:  [101.62465682]
mat_Sqrt:  [[0.15]]
grads:  [0.11331448]
Stock Position:  0.11331447504157904
Bond Position:  [-21.40606753]


portfolio before change:  [-9.87753541]
curr_Stock_Price:  101.7510784664344
curr_Factors:  [101.75107847]
mat_Sqrt:  [[0.15]]
grads:  [-0.18154181]
Stock Position:  -0.18154180717269452
Bond Position:  [8.59453925]


portfolio before change:  [-9.91699821]
curr_Stock_Price:  101.97141324652443
curr_Factors:  [101.97141325]
mat_Sqrt:  [[0.15]]
grads:  [-0.00394584]
Stock Position:  -0.003945835143331067
Bond Position:  [-9.51463583]


portfolio before change:  [-9.91890509]
curr_Stock_Price:  102.30396485129467
curr_Factors:  [102.30396485]
mat_Sqrt:  [[0.15]]
grads:  [-0.21611356]
Stock Position:  -0.2161135551048778
Bond Position:  [12.19036846]


portfolio before change:  [-9.85244393]
curr_Stock_Price:  101.99996152398495
curr_Factors:  [101.99996152]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645204]
Stock Position:  -0.07645204071734633
Bond Position:  [-2.05433872]


portfolio before change:  [-10.00977113]
curr_Stock_Price:  104.05613686152864
curr_Factors:  [104.05613686]
mat_Sqrt:  [[0.15]]
grads:  [0.02356225]
Stock Position:  0.02356224879657852
Bond Position:  [-12.46156771]


portfolio before change:  [-10.00867745]
curr_Stock_Price:  104.13560943336134
curr_Factors:  [104.13560943]
mat_Sqrt:  [[0.15]]
grads:  [0.04386648]
Stock Position:  0.04386648016027002
Bond Position:  [-14.57674009]


portfolio before change:  [-10.00314271]
curr_Stock_Price:  104.28255113032887
curr_Factors:  [104.28255113]
mat_Sqrt:  [[0.15]]
grads:  [-0.08113253]
Stock Position:  -0.08113252693061321
Bond Position:  [-1.54243582]


portfolio before change:  [-10.02964565]
curr_Stock_Price:  104.60802528490593
curr_Factors:  [104.60802528]
mat_Sqrt:  [[0.15]]
grads:  [0.07100055]
Stock Position:  0.07100055029027325
Bond Position:  [-17.45687301]


portfolio before change:  [-9.99803707]
curr_Stock_Price:  105.06858048291065
curr_Factors:  [105.06858048]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798611]
Stock Position:  -0.017986109798315622
Bond Position:  [-8.10826205]


portfolio before change:  [-9.98994557]
curr_Stock_Price:  104.5905293484393
curr_Factors:  [104.59052935]
mat_Sqrt:  [[0.15]]
grads:  [0.07746429]
Stock Position:  0.07746428627035191
Bond Position:  [-18.09197628]


portfolio before change:  [-10.01034442]
curr_Stock_Price:  104.34179454663186
curr_Factors:  [104.34179455]
mat_Sqrt:  [[0.15]]
grads:  [0.07038915]
Stock Position:  0.07038914598819714
Bond Position:  [-17.35487423]


portfolio before change:  [-10.02333391]
curr_Stock_Price:  104.17266650333468
curr_Factors:  [104.1726665]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592472]
Stock Position:  -0.01592471626683727
Bond Position:  [-8.36441376]


portfolio before change:  [-10.03114724]
curr_Stock_Price:  104.6304789626704
curr_Factors:  [104.63047896]
mat_Sqrt:  [[0.15]]
grads:  [0.08785178]
Stock Position:  0.087851777260479
Bond Position:  [-19.22312077]


portfolio before change:  [-10.03941383]
curr_Stock_Price:  104.55005817530832
curr_Factors:  [104.55005818]
mat_Sqrt:  [[0.15]]
grads:  [-0.00924535]
Stock Position:  -0.009245351637651101
Bond Position:  [-9.07281178]


portfolio before change:  [-10.03861205]
curr_Stock_Price:  104.4020006948447
curr_Factors:  [104.40200069]
mat_Sqrt:  [[0.15]]
grads:  [0.14020144]
Stock Position:  0.1402014401505917
Bond Position:  [-24.67592291]


portfolio before change:  [-10.108358]
curr_Stock_Price:  103.91553173606351
curr_Factors:  [103.91553174]
mat_Sqrt:  [[0.15]]
grads:  [0.03250978]
Stock Position:  0.032509779111131606
Bond Position:  [-13.48662898]


portfolio before change:  [-10.12344816]
curr_Stock_Price:  103.47728757505145
curr_Factors:  [103.47728758]
mat_Sqrt:  [[0.15]]
grads:  [-0.01195153]
Stock Position:  -0.011951533356861012
Bond Position:  [-8.8867359]


portfolio before change:  [-10.12985686]
curr_Stock_Price:  103.96703775282485
curr_Factors:  [103.96703775]
mat_Sqrt:  [[0.15]]
grads:  [-0.16039445]
Stock Position:  -0.16039445420756157
Bond Position:  [6.54587941]


portfolio before change:  [-10.20822852]
curr_Stock_Price:  104.45820681113334
curr_Factors:  [104.45820681]
mat_Sqrt:  [[0.15]]
grads:  [-0.05309586]
Stock Position:  -0.0530958603618287
Bond Position:  [-4.66193016]


portfolio before change:  [-10.19576715]
curr_Stock_Price:  104.21802315794216
curr_Factors:  [104.21802316]
mat_Sqrt:  [[0.15]]
grads:  [-0.01864468]
Stock Position:  -0.0186446814515394
Bond Position:  [-8.2526553]


portfolio before change:  [-10.20071174]
curr_Stock_Price:  104.45555925382236
curr_Factors:  [104.45555925]
mat_Sqrt:  [[0.15]]
grads:  [0.04564359]
Stock Position:  0.045643586567043475
Bond Position:  [-14.9684381]


portfolio before change:  [-10.18200624]
curr_Stock_Price:  104.88587272949744
curr_Factors:  [104.88587273]
mat_Sqrt:  [[0.15]]
grads:  [-0.11700199]
Stock Position:  -0.11700199197626972
Bond Position:  [2.08984979]


portfolio before change:  [-10.17931034]
curr_Stock_Price:  104.86394760535917
curr_Factors:  [104.86394761]
mat_Sqrt:  [[0.15]]
grads:  [0.02005541]
Stock Position:  0.02005541476510087
Bond Position:  [-12.28240031]


portfolio before change:  [-10.17078775]
curr_Stock_Price:  105.32717718246217
curr_Factors:  [105.32717718]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137399]
Stock Position:  -0.02137399188660247
Bond Position:  [-7.91952552]


portfolio before change:  [-10.16840266]
curr_Stock_Price:  105.19243039081412
curr_Factors:  [105.19243039]
mat_Sqrt:  [[0.15]]
grads:  [-0.04186142]
Stock Position:  -0.04186141903126776
Bond Position:  [-5.76489826]


portfolio before change:  [-10.15985952]
curr_Stock_Price:  104.97974144211916
curr_Factors:  [104.97974144]
mat_Sqrt:  [[0.15]]
grads:  [0.01868612]
Stock Position:  0.018686118660323714
Bond Position:  [-12.12152343]


portfolio before change:  [-10.15647537]
curr_Stock_Price:  105.2013910754549
curr_Factors:  [105.20139108]
mat_Sqrt:  [[0.15]]
grads:  [-0.12671442]
Stock Position:  -0.12671442347754283
Bond Position:  [3.17405825]


portfolio before change:  [-10.19375699]
curr_Stock_Price:  105.49717432557578
curr_Factors:  [105.49717433]
mat_Sqrt:  [[0.15]]
grads:  [0.00302578]
Stock Position:  0.0030257848842603265
Bond Position:  [-10.51296874]


portfolio before change:  [-10.19574709]
curr_Stock_Price:  105.05661881070846
curr_Factors:  [105.05661881]
mat_Sqrt:  [[0.15]]
grads:  [0.07185686]
Stock Position:  0.07185686202070761
Bond Position:  [-17.74478606]


portfolio before change:  [-10.1836183]
curr_Stock_Price:  105.24084451035036
curr_Factors:  [105.24084451]
mat_Sqrt:  [[0.15]]
grads:  [0.11748666]
Stock Position:  0.11748665963176633
Bond Position:  [-22.54801358]


portfolio before change:  [-10.2390472]
curr_Stock_Price:  104.78105097883916
curr_Factors:  [104.78105098]
mat_Sqrt:  [[0.15]]
grads:  [0.0320332]
Stock Position:  0.03203319802647594
Bond Position:  [-13.59551935]


portfolio before change:  [-10.21584021]
curr_Stock_Price:  105.53204467331427
curr_Factors:  [105.53204467]
mat_Sqrt:  [[0.15]]
grads:  [0.09465819]
Stock Position:  0.09465819372697268
Bond Position:  [-20.20531294]


portfolio before change:  [-10.34612394]
curr_Stock_Price:  104.16902632059359
curr_Factors:  [104.16902632]
mat_Sqrt:  [[0.15]]
grads:  [0.04524204]
Stock Position:  0.04524204020836222
Bond Position:  [-15.05894322]


portfolio before change:  [-10.36307551]
curr_Stock_Price:  103.81514396349642
curr_Factors:  [103.81514396]
mat_Sqrt:  [[0.15]]
grads:  [0.07899429]
Stock Position:  0.07899428762563827
Bond Position:  [-18.56387886]


portfolio before change:  [-10.35253981]
curr_Stock_Price:  103.96320514952455
curr_Factors:  [103.96320515]
mat_Sqrt:  [[0.15]]
grads:  [0.00935932]
Stock Position:  0.009359323440792667
Bond Position:  [-11.32556507]


portfolio before change:  [-10.35506161]
curr_Stock_Price:  103.76939456538982
curr_Factors:  [103.76939457]
mat_Sqrt:  [[0.15]]
grads:  [-0.1020742]
Stock Position:  -0.10207419880082695
Bond Position:  [0.2371162]


portfolio before change:  [-10.40290575]
curr_Stock_Price:  104.23825900722275
curr_Factors:  [104.23825901]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917177]
Stock Position:  -0.06917177460745108
Bond Position:  [-3.1925604]


portfolio before change:  [-10.4131839]
curr_Stock_Price:  104.38396300771234
curr_Factors:  [104.38396301]
mat_Sqrt:  [[0.15]]
grads:  [0.00626267]
Stock Position:  0.006262674371827664
Bond Position:  [-11.06690667]


portfolio before change:  [-10.41671636]
curr_Stock_Price:  103.9303608801877
curr_Factors:  [103.93036088]
mat_Sqrt:  [[0.15]]
grads:  [0.01660989]
Stock Position:  0.016609894449746723
Bond Position:  [-12.14298869]


portfolio before change:  [-10.40277255]
curr_Stock_Price:  104.81554268151986
curr_Factors:  [104.81554268]
mat_Sqrt:  [[0.15]]
grads:  [-0.13694371]
Stock Position:  -0.13694371066573324
Bond Position:  [3.9510568]


portfolio before change:  [-10.36482666]
curr_Stock_Price:  104.54025480790551
curr_Factors:  [104.54025481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657619]
Stock Position:  -0.026576191074379245
Bond Position:  [-7.58654487]


portfolio before change:  [-10.35424499]
curr_Stock_Price:  104.12424944488738
curr_Factors:  [104.12424944]
mat_Sqrt:  [[0.15]]
grads:  [0.0760912]
Stock Position:  0.07609119761518476
Bond Position:  [-18.27718383]


portfolio before change:  [-10.20248637]
curr_Stock_Price:  106.1336931481204
curr_Factors:  [106.13369315]
mat_Sqrt:  [[0.15]]
grads:  [0.16655048]
Stock Position:  0.16655047923704966
Bond Position:  [-27.87910383]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.08412781]
Stock Price:  106.85480223297199
PL:  [-16.93893004]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.29486161e-02]
 [-3.78096700e-03]
 [ 1.22045582e-02]
 [-8.75350873e-03]
 [ 1.51569221e-02]
 [-8.24329356e-03]
 [ 2.44437077e-03]
 [ 1.02667705e-03]
 [-1.32763952e-02]
 [-9.28982377e-03]
 [ 1.20273532e-02]
 [-6.56106741e-03]
 [-2.42481657e-03]
 [ 8.42465033e-03]
 [-2.02894691e-03]
 [ 1.39891814e-02]
 [ 3.53206293e-02]
 [-1.51331246e-02]
 [ 2.19768354e-02]
 [-4.19201354e-05]
 [-4.42144191e-03]
 [ 5.47602724e-03]
 [ 1.32478040e-02]
 [ 2.08812917e-02]
 [-1.44758648e-03]
 [ 4.53765414e-03]
 [ 8.05895897e-03]
 [ 8.32377372e-03]
 [ 1.81451106e-02]
 [ 3.57805381e-03]
 [-8.30512245e-03]
 [ 8.31934828e-03]
 [ 1.24882796e-02]
 [ 5.65537249e-03]
 [ 5.55812266e-03]
 [ 1.05106443e-02]
 [-2.79054617e-02]
 [ 3.39724305e-03]
 [-5.45890234e-02]
 [ 7.96231228e-03]
 [ 6.97744398e-03]
 [-2.48020044e-03]
 [-3.88392787e-03]
 [-4.48597281e-03]
 [ 2.35400768e-02]
 [ 1.44780127e-02]
 [ 1.08614111e-02]
 [ 3.45542948e-03]
 [ 1.18098989e-02]
 [-1.69915465e-03]
 [ 6.48519129e-03]
 [-6.89511554e-03]
 [ 2.12239400e-03]
 [ 1.73094055e-03]
 [-4.53296736e-03]
 [-4.37751094e-03]
 [ 2.45054623e-03]
 [ 8.04994752e-03]
 [ 7.57710787e-03]
 [-3.94925325e-03]
 [-4.38510089e-03]
 [-2.21111796e-04]
 [-5.89147097e-03]
 [ 5.43436991e-03]
 [ 1.99198481e-02]
 [ 5.36689110e-03]
 [ 8.15379184e-03]
 [-1.38310271e-03]
 [ 2.65957072e-03]
 [ 1.99419890e-02]
 [ 5.83239647e-04]
 [-1.55669131e-02]
 [-1.87801131e-04]
 [ 1.39018687e-03]
 [ 9.52808231e-04]
 [-1.48238365e-02]
 [-3.93786449e-03]
 [ 1.53253934e-02]
 [-5.97660078e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.49112676]
curr_Stock_Price:  99.97552949999069
curr_Factors:  [99.9755295]
mat_Sqrt:  [[0.15]]
grads:  [-0.08632411]
Stock Position:  -0.08632410722781507
Bond Position:  [10.12142509]


portfolio before change:  [1.53477965]
curr_Stock_Price:  99.47717188332008
curr_Factors:  [99.47717188]
mat_Sqrt:  [[0.15]]
grads:  [-0.02520645]
Stock Position:  -0.02520644669094358
Bond Position:  [4.04224568]


portfolio before change:  [1.51316889]
curr_Stock_Price:  100.34454561455101
curr_Factors:  [100.34454561]
mat_Sqrt:  [[0.15]]
grads:  [0.08136372]
Stock Position:  0.08136372163591651
Bond Position:  [-6.65123679]


portfolio before change:  [1.45962044]
curr_Stock_Price:  99.6915182625499
curr_Factors:  [99.69151826]
mat_Sqrt:  [[0.15]]
grads:  [-0.05835672]
Stock Position:  -0.05835672487469271
Bond Position:  [7.27729094]


portfolio before change:  [1.46464279]
curr_Stock_Price:  99.61324946084946
curr_Factors:  [99.61324946]
mat_Sqrt:  [[0.15]]
grads:  [0.10104615]
Stock Position:  0.10104614726025574
Bond Position:  [-8.60089228]


portfolio before change:  [1.48203049]
curr_Stock_Price:  99.79064632826832
curr_Factors:  [99.79064633]
mat_Sqrt:  [[0.15]]
grads:  [-0.05495529]
Stock Position:  -0.05495529041835378
Bond Position:  [6.96605444]


portfolio before change:  [1.48006784]
curr_Stock_Price:  99.83428260412062
curr_Factors:  [99.8342826]
mat_Sqrt:  [[0.15]]
grads:  [0.01629581]
Stock Position:  0.01629580513671529
Bond Position:  [-0.14681218]


portfolio before change:  [1.47216342]
curr_Stock_Price:  99.34978731965626
curr_Factors:  [99.34978732]
mat_Sqrt:  [[0.15]]
grads:  [0.00684451]
Stock Position:  0.006844513638477138
Bond Position:  [0.79216245]


portfolio before change:  [1.47253219]
curr_Stock_Price:  99.39643139899236
curr_Factors:  [99.3964314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0885093]
Stock Position:  -0.0885093015268067
Bond Position:  [10.2700409]


portfolio before change:  [1.47785009]
curr_Stock_Price:  99.34360071506062
curr_Factors:  [99.34360072]
mat_Sqrt:  [[0.15]]
grads:  [-0.06193216]
Stock Position:  -0.061932158463944335
Bond Position:  [7.63041371]


portfolio before change:  [1.50871613]
curr_Stock_Price:  98.8529167090201
curr_Factors:  [98.85291671]
mat_Sqrt:  [[0.15]]
grads:  [0.08018235]
Stock Position:  0.08018235477176597
Bond Position:  [-6.41754351]


portfolio before change:  [1.54215822]
curr_Stock_Price:  99.27499457341261
curr_Factors:  [99.27499457]
mat_Sqrt:  [[0.15]]
grads:  [-0.04374045]
Stock Position:  -0.04374044942817151
Bond Position:  [5.88449109]


portfolio before change:  [1.49863131]
curr_Stock_Price:  100.27852100929579
curr_Factors:  [100.27852101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616544]
Stock Position:  -0.01616544380773792
Bond Position:  [3.11967811]


portfolio before change:  [1.49768897]
curr_Stock_Price:  100.34887635492218
curr_Factors:  [100.34887635]
mat_Sqrt:  [[0.15]]
grads:  [0.05616434]
Stock Position:  0.05616433554154427
Bond Position:  [-4.13833899]


portfolio before change:  [1.49308704]
curr_Stock_Price:  100.27154476939994
curr_Factors:  [100.27154477]
mat_Sqrt:  [[0.15]]
grads:  [-0.01352631]
Stock Position:  -0.013526312764815241
Bond Position:  [2.84939132]


portfolio before change:  [1.49187236]
curr_Stock_Price:  100.37451236039111
curr_Factors:  [100.37451236]
mat_Sqrt:  [[0.15]]
grads:  [0.09326121]
Stock Position:  0.09326120961505531
Bond Position:  [-7.86917608]


portfolio before change:  [1.47067176]
curr_Stock_Price:  100.1524611950572
curr_Factors:  [100.1524612]
mat_Sqrt:  [[0.15]]
grads:  [0.23547086]
Stock Position:  0.23547086198402983
Bond Position:  [-22.11231461]


portfolio before change:  [1.27582189]
curr_Stock_Price:  99.3308401921248
curr_Factors:  [99.33084019]
mat_Sqrt:  [[0.15]]
grads:  [-0.1008875]
Stock Position:  -0.10088749738754577
Bond Position:  [11.29706177]


portfolio before change:  [1.27747831]
curr_Stock_Price:  99.32142045467651
curr_Factors:  [99.32142045]
mat_Sqrt:  [[0.15]]
grads:  [0.14651224]
Stock Position:  0.14651223577399422
Bond Position:  [-13.27432506]


portfolio before change:  [1.18199071]
curr_Stock_Price:  98.67534516450193
curr_Factors:  [98.67534516]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027947]
Stock Position:  -0.0002794675696324185
Bond Position:  [1.20956727]


portfolio before change:  [1.18196873]
curr_Stock_Price:  99.02449373880805
curr_Factors:  [99.02449374]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947628]
Stock Position:  -0.029476279400398517
Bond Position:  [4.10084238]


portfolio before change:  [1.20695565]
curr_Stock_Price:  98.18549346715447
curr_Factors:  [98.18549347]
mat_Sqrt:  [[0.15]]
grads:  [0.03650685]
Stock Position:  0.0365068482514078
Bond Position:  [-2.37748726]


portfolio before change:  [1.19357598]
curr_Stock_Price:  97.82306627040654
curr_Factors:  [97.82306627]
mat_Sqrt:  [[0.15]]
grads:  [0.08831869]
Stock Position:  0.08831869364289406
Bond Position:  [-7.44602944]


portfolio before change:  [1.1925512]
curr_Stock_Price:  97.8167325092398
curr_Factors:  [97.81673251]
mat_Sqrt:  [[0.15]]
grads:  [0.13920861]
Stock Position:  0.1392086113058679
Bond Position:  [-12.4243803]


portfolio before change:  [1.21380912]
curr_Stock_Price:  97.97501633264179
curr_Factors:  [97.97501633]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965058]
Stock Position:  -0.009650576552398295
Bond Position:  [2.15932451]


portfolio before change:  [1.21090389]
curr_Stock_Price:  98.29004286937105
curr_Factors:  [98.29004287]
mat_Sqrt:  [[0.15]]
grads:  [0.03025103]
Stock Position:  0.030251027580557015
Bond Position:  [-1.7624709]


portfolio before change:  [1.23645322]
curr_Stock_Price:  99.13826130400379
curr_Factors:  [99.1382613]
mat_Sqrt:  [[0.15]]
grads:  [0.05372639]
Stock Position:  0.05372639316102165
Bond Position:  [-4.08988799]


portfolio before change:  [1.21674935]
curr_Stock_Price:  98.77627461833653
curr_Factors:  [98.77627462]
mat_Sqrt:  [[0.15]]
grads:  [0.05549182]
Stock Position:  0.055491824793439976
Bond Position:  [-4.26452637]


portfolio before change:  [1.26683582]
curr_Stock_Price:  99.68366975082876
curr_Factors:  [99.68366975]
mat_Sqrt:  [[0.15]]
grads:  [0.1209674]
Stock Position:  0.1209674038320272
Bond Position:  [-10.79163891]


portfolio before change:  [1.36617972]
curr_Stock_Price:  100.51049081692621
curr_Factors:  [100.51049082]
mat_Sqrt:  [[0.15]]
grads:  [0.02385369]
Stock Position:  0.023853692077358407
Bond Position:  [-1.03136658]


portfolio before change:  [1.35830912]
curr_Stock_Price:  100.18324023008594
curr_Factors:  [100.18324023]
mat_Sqrt:  [[0.15]]
grads:  [-0.05536748]
Stock Position:  -0.05536748302853167
Bond Position:  [6.90520298]


portfolio before change:  [1.36381573]
curr_Stock_Price:  100.09157958611449
curr_Factors:  [100.09157959]
mat_Sqrt:  [[0.15]]
grads:  [0.05546232]
Stock Position:  0.05546232189552991
Bond Position:  [-4.18749568]


portfolio before change:  [1.40089914]
curr_Stock_Price:  100.76492200395938
curr_Factors:  [100.764922]
mat_Sqrt:  [[0.15]]
grads:  [0.0832552]
Stock Position:  0.08325519736787494
Bond Position:  [-6.98830433]


portfolio before change:  [1.38207734]
curr_Stock_Price:  100.5440948074642
curr_Factors:  [100.54409481]
mat_Sqrt:  [[0.15]]
grads:  [0.03770248]
Stock Position:  0.03770248324662195
Bond Position:  [-2.40868471]


portfolio before change:  [1.38588699]
curr_Stock_Price:  100.64913278766296
curr_Factors:  [100.64913279]
mat_Sqrt:  [[0.15]]
grads:  [0.03705415]
Stock Position:  0.03705415104073058
Bond Position:  [-2.34358118]


portfolio before change:  [1.39174659]
curr_Stock_Price:  100.81122191478744
curr_Factors:  [100.81122191]
mat_Sqrt:  [[0.15]]
grads:  [0.07007096]
Stock Position:  0.07007096200759587
Bond Position:  [-5.67219272]


portfolio before change:  [1.42693004]
curr_Stock_Price:  101.31839323686557
curr_Factors:  [101.31839324]
mat_Sqrt:  [[0.15]]
grads:  [-0.18603641]
Stock Position:  -0.18603641146963196
Bond Position:  [20.27584034]


portfolio before change:  [1.53564816]
curr_Stock_Price:  100.74081362374606
curr_Factors:  [100.74081362]
mat_Sqrt:  [[0.15]]
grads:  [0.02264829]
Stock Position:  0.02264828700955775
Bond Position:  [-0.7459587]


portfolio before change:  [1.53118184]
curr_Stock_Price:  100.54566882604524
curr_Factors:  [100.54566883]
mat_Sqrt:  [[0.15]]
grads:  [-0.36392682]
Stock Position:  -0.36392682287056777
Bond Position:  [38.12244765]


portfolio before change:  [1.63663543]
curr_Stock_Price:  100.2624501907684
curr_Factors:  [100.26245019]
mat_Sqrt:  [[0.15]]
grads:  [0.05308208]
Stock Position:  0.05308208188370583
Bond Position:  [-3.68550416]


portfolio before change:  [1.63440647]
curr_Stock_Price:  100.22479898484123
curr_Factors:  [100.22479898]
mat_Sqrt:  [[0.15]]
grads:  [0.04651629]
Stock Position:  0.0465162931976619
Bond Position:  [-3.02767966]


portfolio before change:  [1.62379847]
curr_Stock_Price:  100.00081802070066
curr_Factors:  [100.00081802]
mat_Sqrt:  [[0.15]]
grads:  [-0.01653467]
Stock Position:  -0.01653466960702931
Bond Position:  [3.27727896]


portfolio before change:  [1.60628376]
curr_Stock_Price:  101.07247850219295
curr_Factors:  [101.0724785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02589285]
Stock Position:  -0.02589285248759161
Bond Position:  [4.22333853]


portfolio before change:  [1.61874332]
curr_Stock_Price:  100.6014759589383
curr_Factors:  [100.60147596]
mat_Sqrt:  [[0.15]]
grads:  [-0.02990649]
Stock Position:  -0.0299064854200471
Bond Position:  [4.6273799]


portfolio before change:  [1.627107]
curr_Stock_Price:  100.33148576474986
curr_Factors:  [100.33148576]
mat_Sqrt:  [[0.15]]
grads:  [0.15693385]
Stock Position:  0.1569338451971147
Bond Position:  [-14.11829885]


portfolio before change:  [1.69300849]
curr_Stock_Price:  100.75704027792149
curr_Factors:  [100.75704028]
mat_Sqrt:  [[0.15]]
grads:  [0.09652008]
Stock Position:  0.09652008495709496
Bond Position:  [-8.0320696]


portfolio before change:  [1.68772583]
curr_Stock_Price:  100.70751035901158
curr_Factors:  [100.70751036]
mat_Sqrt:  [[0.15]]
grads:  [0.07240941]
Stock Position:  0.07240940746342776
Bond Position:  [-5.60444532]


portfolio before change:  [1.70409637]
curr_Stock_Price:  100.93843091605832
curr_Factors:  [100.93843092]
mat_Sqrt:  [[0.15]]
grads:  [0.0230362]
Stock Position:  0.02303619655737126
Bond Position:  [-0.62114117]


portfolio before change:  [1.70831055]
curr_Stock_Price:  101.1230538142598
curr_Factors:  [101.12305381]
mat_Sqrt:  [[0.15]]
grads:  [0.07873266]
Stock Position:  0.07873265962401148
Bond Position:  [-6.25337642]


portfolio before change:  [1.66402997]
curr_Stock_Price:  100.56560104368701
curr_Factors:  [100.56560104]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113277]
Stock Position:  -0.011327697645329643
Bond Position:  [2.80320669]


portfolio before change:  [1.66147493]
curr_Stock_Price:  100.80662451752603
curr_Factors:  [100.80662452]
mat_Sqrt:  [[0.15]]
grads:  [0.04323461]
Stock Position:  0.043234608575967726
Bond Position:  [-2.69686002]


portfolio before change:  [1.62549401]
curr_Stock_Price:  99.9782982504244
curr_Factors:  [99.97829825]
mat_Sqrt:  [[0.15]]
grads:  [-0.04596744]
Stock Position:  -0.045967436940898165
Bond Position:  [6.22124013]


portfolio before change:  [1.61492141]
curr_Stock_Price:  100.2167591340537
curr_Factors:  [100.21675913]
mat_Sqrt:  [[0.15]]
grads:  [0.01414929]
Stock Position:  0.014149293363178526
Bond Position:  [0.19692509]


portfolio before change:  [1.61470878]
curr_Stock_Price:  100.20086103756827
curr_Factors:  [100.20086104]
mat_Sqrt:  [[0.15]]
grads:  [0.0115396]
Stock Position:  0.011539603633950308
Bond Position:  [0.45843056]


portfolio before change:  [1.61000132]
curr_Stock_Price:  99.79043935436101
curr_Factors:  [99.79043935]
mat_Sqrt:  [[0.15]]
grads:  [-0.03021978]
Stock Position:  -0.030219782388341238
Bond Position:  [4.62564669]


portfolio before change:  [1.62061426]
curr_Stock_Price:  99.44881455627025
curr_Factors:  [99.44881456]
mat_Sqrt:  [[0.15]]
grads:  [-0.02918341]
Stock Position:  -0.029183406239807003
Bond Position:  [4.52286942]


portfolio before change:  [1.62473006]
curr_Stock_Price:  99.31746920888172
curr_Factors:  [99.31746921]
mat_Sqrt:  [[0.15]]
grads:  [0.01633697]
Stock Position:  0.016336974878619667
Bond Position:  [0.00218306]


portfolio before change:  [1.61980472]
curr_Stock_Price:  99.01597658929497
curr_Factors:  [99.01597659]
mat_Sqrt:  [[0.15]]
grads:  [0.05366632]
Stock Position:  0.053666316778072064
Bond Position:  [-3.69401805]


portfolio before change:  [1.59924436]
curr_Stock_Price:  98.63716404490695
curr_Factors:  [98.63716404]
mat_Sqrt:  [[0.15]]
grads:  [0.05051405]
Stock Position:  0.05051405248052892
Bond Position:  [-3.38331852]


portfolio before change:  [1.60460425]
curr_Stock_Price:  98.74745731612724
curr_Factors:  [98.74745732]
mat_Sqrt:  [[0.15]]
grads:  [-0.02632835]
Stock Position:  -0.0263283549743845
Bond Position:  [4.20446236]


portfolio before change:  [1.63079641]
curr_Stock_Price:  97.76261139380044
curr_Factors:  [97.76261139]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923401]
Stock Position:  -0.029234005902903974
Bond Position:  [4.48878917]


portfolio before change:  [1.6293215]
curr_Stock_Price:  97.82266022035236
curr_Factors:  [97.82266022]
mat_Sqrt:  [[0.15]]
grads:  [-0.00147408]
Stock Position:  -0.0014740786371744755
Bond Position:  [1.7735198]


portfolio before change:  [1.62876162]
curr_Stock_Price:  98.2776755606176
curr_Factors:  [98.27767556]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927647]
Stock Position:  -0.03927647314082105
Bond Position:  [5.48876211]


portfolio before change:  [1.59658364]
curr_Stock_Price:  99.10567868492372
curr_Factors:  [99.10567868]
mat_Sqrt:  [[0.15]]
grads:  [0.03622913]
Stock Position:  0.036229132715441724
Bond Position:  [-1.99392915]


portfolio before change:  [1.58767429]
curr_Stock_Price:  98.86320170262094
curr_Factors:  [98.8632017]
mat_Sqrt:  [[0.15]]
grads:  [0.13279899]
Stock Position:  0.13279898761282008
Bond Position:  [-11.54125881]


portfolio before change:  [1.64401335]
curr_Stock_Price:  99.29287675655456
curr_Factors:  [99.29287676]
mat_Sqrt:  [[0.15]]
grads:  [0.03577927]
Stock Position:  0.03577927401961651
Bond Position:  [-1.9086137]


portfolio before change:  [1.64716483]
curr_Stock_Price:  99.38429199753416
curr_Factors:  [99.384292]
mat_Sqrt:  [[0.15]]
grads:  [0.05435861]
Stock Position:  0.05435861226240151
Bond Position:  [-3.75522737]


portfolio before change:  [1.69838283]
curr_Stock_Price:  100.33083408732999
curr_Factors:  [100.33083409]
mat_Sqrt:  [[0.15]]
grads:  [-0.00922068]
Stock Position:  -0.009220684754256614
Bond Position:  [2.62350182]


portfolio before change:  [1.69602709]
curr_Stock_Price:  100.60410213255123
curr_Factors:  [100.60410213]
mat_Sqrt:  [[0.15]]
grads:  [0.01773047]
Stock Position:  0.017730471484284166
Bond Position:  [-0.08773108]


portfolio before change:  [1.70271216]
curr_Stock_Price:  100.98144995768
curr_Factors:  [100.98144996]
mat_Sqrt:  [[0.15]]
grads:  [0.13294659]
Stock Position:  0.13294659301730002
Bond Position:  [-11.72242757]


portfolio before change:  [1.82255519]
curr_Stock_Price:  101.88839841050986
curr_Factors:  [101.88839841]
mat_Sqrt:  [[0.15]]
grads:  [0.00388826]
Stock Position:  0.003888264310468835
Bond Position:  [1.42638617]


portfolio before change:  [1.8237942]
curr_Stock_Price:  102.18412279073833
curr_Factors:  [102.18412279]
mat_Sqrt:  [[0.15]]
grads:  [-0.10377942]
Stock Position:  -0.10377942077252804
Bond Position:  [12.42840327]


portfolio before change:  [1.89424215]
curr_Stock_Price:  101.51278392410177
curr_Factors:  [101.51278392]
mat_Sqrt:  [[0.15]]
grads:  [-0.00125201]
Stock Position:  -0.0012520075381058464
Bond Position:  [2.02133693]


portfolio before change:  [1.89452169]
curr_Stock_Price:  101.39042228031506
curr_Factors:  [101.39042228]
mat_Sqrt:  [[0.15]]
grads:  [0.00926791]
Stock Position:  0.009267912447447393
Bond Position:  [0.95484413]


portfolio before change:  [1.89474409]
curr_Stock_Price:  101.40797933310122
curr_Factors:  [101.40797933]
mat_Sqrt:  [[0.15]]
grads:  [0.00635205]
Stock Position:  0.00635205487165412
Bond Position:  [1.25059504]


portfolio before change:  [1.90105437]
curr_Stock_Price:  102.3890976103021
curr_Factors:  [102.38909761]
mat_Sqrt:  [[0.15]]
grads:  [-0.09882558]
Stock Position:  -0.09882557676484316
Bond Position:  [12.01971599]


portfolio before change:  [1.90792705]
curr_Stock_Price:  102.32715586180814
curr_Factors:  [102.32715586]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625243]
Stock Position:  -0.0262524299533407
Bond Position:  [4.59426354]


portfolio before change:  [1.91356842]
curr_Stock_Price:  102.12320458756552
curr_Factors:  [102.12320459]
mat_Sqrt:  [[0.15]]
grads:  [0.10216929]
Stock Position:  0.10216928947622139
Bond Position:  [-8.52028683]


portfolio before change:  [1.90790195]
curr_Stock_Price:  102.07295528442195
curr_Factors:  [102.07295528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03984401]
Stock Position:  -0.039844005220567885
Bond Position:  [5.97489731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.89817281]
Stock Price:  102.32650867161549
PL:  [-0.42833586]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.31739324e-02]
 [-1.77938013e-03]
 [ 1.66782723e-02]
 [-1.01807890e-02]
 [ 1.32267998e-02]
 [-1.08391279e-02]
 [ 2.48338633e-03]
 [-1.05339207e-02]
 [ 5.81043139e-03]
 [-5.04828159e-04]
 [-1.10279354e-02]
 [ 2.13699235e-02]
 [-5.02310405e-03]
 [ 4.36846697e-03]
 [ 3.75616937e-03]
 [ 1.12760861e-02]
 [ 9.62994710e-02]
 [-9.64594378e-03]
 [ 2.02983131e-02]
 [ 1.07974782e-03]
 [-4.36001977e-03]
 [ 4.32422445e-03]
 [ 1.34817127e-02]
 [ 2.86938174e-02]
 [-1.32730545e-03]
 [ 7.40731691e-03]
 [-3.97245722e-04]
 [ 1.24068373e-02]
 [ 3.27465951e-02]
 [-4.14623007e-04]
 [-5.43089922e-03]
 [ 1.12144075e-02]
 [ 1.27708607e-02]
 [ 7.33374928e-03]
 [ 5.60328029e-03]
 [ 1.31895612e-02]
 [-2.73616142e-02]
 [ 2.91713661e-03]
 [-5.69568488e-02]
 [ 8.49029046e-03]
 [ 6.21107493e-03]
 [ 9.43687128e-03]
 [-5.97072890e-03]
 [ 1.28665923e-04]
 [ 1.17710921e-02]
 [ 1.20775685e-02]
 [ 1.06224410e-02]
 [ 3.32876711e-03]
 [ 1.16014475e-02]
 [-1.63373028e-03]
 [ 7.45383502e-03]
 [-1.63098179e-02]
 [ 1.93984350e-03]
 [-2.84683964e-03]
 [-3.70019905e-03]
 [-3.53737516e-03]
 [ 6.81561118e-03]
 [ 4.71470538e-03]
 [ 7.15375208e-03]
 [-3.99056942e-03]
 [-2.33757862e-03]
 [ 3.31023364e-03]
 [-7.08652209e-03]
 [ 6.63821166e-03]
 [ 2.00360299e-02]
 [ 5.14622647e-03]
 [ 8.73053867e-03]
 [-2.39886355e-04]
 [ 2.81068044e-03]
 [ 2.23266824e-02]
 [ 2.66097342e-03]
 [-1.58369414e-02]
 [-5.95054808e-03]
 [ 9.73095107e-04]
 [ 5.13923181e-03]
 [-8.31844711e-05]
 [-1.41945278e-03]
 [ 3.63130706e-03]
 [-2.39084852e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.16025912]
curr_Stock_Price:  99.49176538094557
curr_Factors:  [99.49176538]
mat_Sqrt:  [[0.15]]
grads:  [-0.08782622]
Stock Position:  -0.0878262162187569
Bond Position:  [-0.42227382]


portfolio before change:  [-9.16458817]
curr_Stock_Price:  99.54075599563316
curr_Factors:  [99.540756]
mat_Sqrt:  [[0.15]]
grads:  [-0.01186253]
Stock Position:  -0.011862534189095084
Bond Position:  [-7.98378255]


portfolio before change:  [-9.1617251]
curr_Stock_Price:  99.25733652541193
curr_Factors:  [99.25733653]
mat_Sqrt:  [[0.15]]
grads:  [0.11118848]
Stock Position:  0.11118848174689815
Bond Position:  [-20.19799765]


portfolio before change:  [-9.17286777]
curr_Stock_Price:  99.16847615280852
curr_Factors:  [99.16847615]
mat_Sqrt:  [[0.15]]
grads:  [-0.06787193]
Stock Position:  -0.06787192636018728
Bond Position:  [-2.44211226]


portfolio before change:  [-9.18680209]
curr_Stock_Price:  99.37153042183914
curr_Factors:  [99.37153042]
mat_Sqrt:  [[0.15]]
grads:  [0.08817867]
Stock Position:  0.08817866558606821
Bond Position:  [-17.94925104]


portfolio before change:  [-9.17201727]
curr_Stock_Price:  99.5519218870129
curr_Factors:  [99.55192189]
mat_Sqrt:  [[0.15]]
grads:  [-0.07226085]
Stock Position:  -0.07226085251439382
Bond Position:  [-1.97831053]


portfolio before change:  [-9.20582585]
curr_Stock_Price:  100.01807923080433
curr_Factors:  [100.01807923]
mat_Sqrt:  [[0.15]]
grads:  [0.01655591]
Stock Position:  0.016555908882738477
Bond Position:  [-10.86171605]


portfolio before change:  [-9.20264829]
curr_Stock_Price:  100.25101328184368
curr_Factors:  [100.25101328]
mat_Sqrt:  [[0.15]]
grads:  [-0.07022614]
Stock Position:  -0.07022613825917855
Bond Position:  [-2.16240677]


portfolio before change:  [-9.23239773]
curr_Stock_Price:  100.67271223593585
curr_Factors:  [100.67271224]
mat_Sqrt:  [[0.15]]
grads:  [0.03873621]
Stock Position:  0.038736209257868075
Bond Position:  [-13.13207698]


portfolio before change:  [-9.22169223]
curr_Stock_Price:  100.97027059421166
curr_Factors:  [100.97027059]
mat_Sqrt:  [[0.15]]
grads:  [-0.00336552]
Stock Position:  -0.0033655210599201303
Bond Position:  [-8.88187466]


portfolio before change:  [-9.22734204]
curr_Stock_Price:  102.48405382498875
curr_Factors:  [102.48405382]
mat_Sqrt:  [[0.15]]
grads:  [-0.07351957]
Stock Position:  -0.07351956965459198
Bond Position:  [-1.6927585]


portfolio before change:  [-9.29484048]
curr_Stock_Price:  103.40071640826677
curr_Factors:  [103.40071641]
mat_Sqrt:  [[0.15]]
grads:  [0.14246616]
Stock Position:  0.14246615694857703
Bond Position:  [-24.02594317]


portfolio before change:  [-9.31264781]
curr_Stock_Price:  103.28626350972061
curr_Factors:  [103.28626351]
mat_Sqrt:  [[0.15]]
grads:  [-0.03348736]
Stock Position:  -0.03348736032925639
Bond Position:  [-5.85386349]


portfolio before change:  [-9.3010814]
curr_Stock_Price:  102.92994152108375
curr_Factors:  [102.92994152]
mat_Sqrt:  [[0.15]]
grads:  [0.02912311]
Stock Position:  0.029123113119469253
Bond Position:  [-12.29872173]


portfolio before change:  [-9.33143061]
curr_Stock_Price:  101.91423582915971
curr_Factors:  [101.91423583]
mat_Sqrt:  [[0.15]]
grads:  [0.02504113]
Stock Position:  0.02504112912558155
Bond Position:  [-11.88347815]


portfolio before change:  [-9.32455444]
curr_Stock_Price:  102.21849182620986
curr_Factors:  [102.21849183]
mat_Sqrt:  [[0.15]]
grads:  [0.07517391]
Stock Position:  0.07517390745419736
Bond Position:  [-17.00871788]


portfolio before change:  [-9.32325953]
curr_Stock_Price:  102.24985882695516
curr_Factors:  [102.24985883]
mat_Sqrt:  [[0.15]]
grads:  [0.64199647]
Stock Position:  0.641996473535873
Bond Position:  [-74.96730832]


portfolio before change:  [-8.62391659]
curr_Stock_Price:  103.34648253016718
curr_Factors:  [103.34648253]
mat_Sqrt:  [[0.15]]
grads:  [-0.06430629]
Stock Position:  -0.06430629187360959
Bond Position:  [-1.97808752]


portfolio before change:  [-8.53643914]
curr_Stock_Price:  101.98423512765739
curr_Factors:  [101.98423513]
mat_Sqrt:  [[0.15]]
grads:  [0.13532209]
Stock Position:  0.13532208765126738
Bond Position:  [-22.33715875]


portfolio before change:  [-8.5212625]
curr_Stock_Price:  102.10670410973779
curr_Factors:  [102.10670411]
mat_Sqrt:  [[0.15]]
grads:  [0.00719832]
Stock Position:  0.007198318781870229
Bond Position:  [-9.25625911]


portfolio before change:  [-8.52594088]
curr_Stock_Price:  101.5371474865849
curr_Factors:  [101.53714749]
mat_Sqrt:  [[0.15]]
grads:  [-0.0290668]
Stock Position:  -0.029066798471241863
Bond Position:  [-5.57458108]


portfolio before change:  [-8.50446641]
curr_Stock_Price:  100.78636308529248
curr_Factors:  [100.78636309]
mat_Sqrt:  [[0.15]]
grads:  [0.02882816]
Stock Position:  0.028828162987270582
Bond Position:  [-11.40995211]


portfolio before change:  [-8.48692229]
curr_Stock_Price:  101.41967641647146
curr_Factors:  [101.41967642]
mat_Sqrt:  [[0.15]]
grads:  [0.08987808]
Stock Position:  0.08987808456577746
Bond Position:  [-17.60232855]


portfolio before change:  [-8.43302907]
curr_Stock_Price:  102.03154301217924
curr_Factors:  [102.03154301]
mat_Sqrt:  [[0.15]]
grads:  [0.19129212]
Stock Position:  0.19129211596636234
Bond Position:  [-27.95085883]


portfolio before change:  [-8.5271678]
curr_Stock_Price:  101.54855527987394
curr_Factors:  [101.54855528]
mat_Sqrt:  [[0.15]]
grads:  [-0.0088487]
Stock Position:  -0.008848702985389395
Bond Position:  [-7.6285948]


portfolio before change:  [-8.52757762]
curr_Stock_Price:  101.54098475296772
curr_Factors:  [101.54098475]
mat_Sqrt:  [[0.15]]
grads:  [0.04938211]
Stock Position:  0.04938211273441356
Bond Position:  [-13.54188597]


portfolio before change:  [-8.51400108]
curr_Stock_Price:  101.83305262644836
curr_Factors:  [101.83305263]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026483]
Stock Position:  -0.0026483048117358194
Bond Position:  [-8.24431612]


portfolio before change:  [-8.51390462]
curr_Stock_Price:  101.60205654092982
curr_Factors:  [101.60205654]
mat_Sqrt:  [[0.15]]
grads:  [0.08271225]
Stock Position:  0.08271224852208503
Bond Position:  [-16.91763917]


portfolio before change:  [-8.52428612]
curr_Stock_Price:  101.48932700916812
curr_Factors:  [101.48932701]
mat_Sqrt:  [[0.15]]
grads:  [0.21831063]
Stock Position:  0.2183106337160824
Bond Position:  [-30.68048541]


portfolio before change:  [-8.52406207]
curr_Stock_Price:  101.49913705784509
curr_Factors:  [101.49913706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00276415]
Stock Position:  -0.0027641533801402627
Bond Position:  [-8.24350289]


portfolio before change:  [-8.52408517]
curr_Stock_Price:  101.32109455388093
curr_Factors:  [101.32109455]
mat_Sqrt:  [[0.15]]
grads:  [-0.03620599]
Stock Position:  -0.03620599477811299
Bond Position:  [-4.85565415]


portfolio before change:  [-8.5107516]
curr_Stock_Price:  100.94444269547833
curr_Factors:  [100.9444427]
mat_Sqrt:  [[0.15]]
grads:  [0.07476272]
Stock Position:  0.07476271697161262
Bond Position:  [-16.0576324]


portfolio before change:  [-8.46812408]
curr_Stock_Price:  101.52803782763398
curr_Factors:  [101.52803783]
mat_Sqrt:  [[0.15]]
grads:  [0.08513907]
Stock Position:  0.08513907126808955
Bond Position:  [-17.11212693]


portfolio before change:  [-8.45932348]
curr_Stock_Price:  101.64396744463895
curr_Factors:  [101.64396744]
mat_Sqrt:  [[0.15]]
grads:  [0.04889166]
Stock Position:  0.04889166184751051
Bond Position:  [-13.42886596]


portfolio before change:  [-8.47347548]
curr_Stock_Price:  101.37167814878154
curr_Factors:  [101.37167815]
mat_Sqrt:  [[0.15]]
grads:  [0.0373552]
Stock Position:  0.03735520190957219
Bond Position:  [-12.26023499]


portfolio before change:  [-8.4726358]
curr_Stock_Price:  101.4146702187717
curr_Factors:  [101.41467022]
mat_Sqrt:  [[0.15]]
grads:  [0.08793041]
Stock Position:  0.08793040807217926
Bond Position:  [-17.39006913]


portfolio before change:  [-8.44673536]
curr_Stock_Price:  101.72158730337446
curr_Factors:  [101.7215873]
mat_Sqrt:  [[0.15]]
grads:  [-0.18241076]
Stock Position:  -0.18241076117842617
Bond Position:  [10.1083768]


portfolio before change:  [-8.34720314]
curr_Stock_Price:  101.17940201293732
curr_Factors:  [101.17940201]
mat_Sqrt:  [[0.15]]
grads:  [0.01944758]
Stock Position:  0.019447577374560404
Bond Position:  [-10.31489739]


portfolio before change:  [-8.36958071]
curr_Stock_Price:  100.06189152758037
curr_Factors:  [100.06189153]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971233]
Stock Position:  -0.37971232560295415
Bond Position:  [29.62515282]


portfolio before change:  [-8.45034196]
curr_Stock_Price:  100.27945853226883
curr_Factors:  [100.27945853]
mat_Sqrt:  [[0.15]]
grads:  [0.05660194]
Stock Position:  0.05660193640729494
Bond Position:  [-14.12635349]


portfolio before change:  [-8.41166462]
curr_Stock_Price:  100.9783790929521
curr_Factors:  [100.97837909]
mat_Sqrt:  [[0.15]]
grads:  [0.04140717]
Stock Position:  0.04140716621126097
Bond Position:  [-12.59289315]


portfolio before change:  [-8.38004079]
curr_Stock_Price:  101.76111594193858
curr_Factors:  [101.76111594]
mat_Sqrt:  [[0.15]]
grads:  [0.06291248]
Stock Position:  0.06291247518420791
Bond Position:  [-14.78208447]


portfolio before change:  [-8.36020752]
curr_Stock_Price:  102.09105326873197
curr_Factors:  [102.09105327]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980486]
Stock Position:  -0.03980485934624951
Bond Position:  [-4.29648751]


portfolio before change:  [-8.38665767]
curr_Stock_Price:  102.74880232111
curr_Factors:  [102.74880232]
mat_Sqrt:  [[0.15]]
grads:  [0.00085777]
Stock Position:  0.0008577728202816572
Bond Position:  [-8.4747928]


portfolio before change:  [-8.38782354]
curr_Stock_Price:  102.00714277311954
curr_Factors:  [102.00714277]
mat_Sqrt:  [[0.15]]
grads:  [0.07847395]
Stock Position:  0.07847394702338198
Bond Position:  [-16.39272666]


portfolio before change:  [-8.32273298]
curr_Stock_Price:  102.84965343572978
curr_Factors:  [102.84965344]
mat_Sqrt:  [[0.15]]
grads:  [0.08051712]
Stock Position:  0.08051712324590059
Bond Position:  [-16.6038912]


portfolio before change:  [-8.39469665]
curr_Stock_Price:  101.96877375291629
curr_Factors:  [101.96877375]
mat_Sqrt:  [[0.15]]
grads:  [0.07081627]
Stock Position:  0.07081627307582092
Bond Position:  [-15.61574518]


portfolio before change:  [-8.46331752]
curr_Stock_Price:  101.0135574644885
curr_Factors:  [101.01355746]
mat_Sqrt:  [[0.15]]
grads:  [0.02219178]
Stock Position:  0.022191780700054956
Bond Position:  [-10.70498824]


portfolio before change:  [-8.46231302]
curr_Stock_Price:  101.08897223692605
curr_Factors:  [101.08897224]
mat_Sqrt:  [[0.15]]
grads:  [0.07734298]
Stock Position:  0.0773429831805479
Bond Position:  [-16.2808357]


portfolio before change:  [-8.49558438]
curr_Stock_Price:  100.67194956782669
curr_Factors:  [100.67194957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01089154]
Stock Position:  -0.01089153519553414
Bond Position:  [-7.3991123]


portfolio before change:  [-8.49851646]
curr_Stock_Price:  100.89869601724668
curr_Factors:  [100.89869602]
mat_Sqrt:  [[0.15]]
grads:  [0.04969223]
Stock Position:  0.04969223347152198
Bond Position:  [-13.51239802]


portfolio before change:  [-8.46265798]
curr_Stock_Price:  101.63730294037595
curr_Factors:  [101.63730294]
mat_Sqrt:  [[0.15]]
grads:  [-0.10873212]
Stock Position:  -0.10873211932936866
Bond Position:  [2.58858137]


portfolio before change:  [-8.42204839]
curr_Stock_Price:  101.26530795839324
curr_Factors:  [101.26530796]
mat_Sqrt:  [[0.15]]
grads:  [0.01293229]
Stock Position:  0.01293229003321718
Bond Position:  [-9.73164072]


portfolio before change:  [-8.41767714]
curr_Stock_Price:  101.65035102170093
curr_Factors:  [101.65035102]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897893]
Stock Position:  -0.01897893090717693
Bond Position:  [-6.48846216]


portfolio before change:  [-8.40593657]
curr_Stock_Price:  101.01037199667806
curr_Factors:  [101.010372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02466799]
Stock Position:  -0.02466799367618487
Bond Position:  [-5.91421335]


portfolio before change:  [-8.41413466]
curr_Stock_Price:  101.3277243101076
curr_Factors:  [101.32772431]
mat_Sqrt:  [[0.15]]
grads:  [-0.0235825]
Stock Position:  -0.0235825010604018
Bond Position:  [-6.0245735]


portfolio before change:  [-8.39032701]
curr_Stock_Price:  100.3022098477813
curr_Factors:  [100.30220985]
mat_Sqrt:  [[0.15]]
grads:  [0.04543741]
Stock Position:  0.04543740788999536
Bond Position:  [-12.94779944]


portfolio before change:  [-8.41757698]
curr_Stock_Price:  99.72029490053272
curr_Factors:  [99.7202949]
mat_Sqrt:  [[0.15]]
grads:  [0.03143137]
Stock Position:  0.03143136917166963
Bond Position:  [-11.55192239]


portfolio before change:  [-8.41183162]
curr_Stock_Price:  99.92605694229434
curr_Factors:  [99.92605694]
mat_Sqrt:  [[0.15]]
grads:  [0.04769168]
Stock Position:  0.04769168054054995
Bond Position:  [-13.1774732]


portfolio before change:  [-8.44943101]
curr_Stock_Price:  99.15494181798393
curr_Factors:  [99.15494182]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266038]
Stock Position:  -0.026603796113229956
Bond Position:  [-5.81153316]


portfolio before change:  [-8.43735366]
curr_Stock_Price:  98.68731726846798
curr_Factors:  [98.68731727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558386]
Stock Position:  -0.015583857467097147
Bond Position:  [-6.89942457]


portfolio before change:  [-8.45030648]
curr_Stock_Price:  99.49081482961523
curr_Factors:  [99.49081483]
mat_Sqrt:  [[0.15]]
grads:  [0.02206822]
Stock Position:  0.02206822429217504
Bond Position:  [-10.64589209]


portfolio before change:  [-8.44568345]
curr_Stock_Price:  99.73045404746551
curr_Factors:  [99.73045405]
mat_Sqrt:  [[0.15]]
grads:  [-0.04724348]
Stock Position:  -0.04724348062693309
Bond Position:  [-3.73406968]


portfolio before change:  [-8.43202995]
curr_Stock_Price:  99.43651114696885
curr_Factors:  [99.43651115]
mat_Sqrt:  [[0.15]]
grads:  [0.04425474]
Stock Position:  0.0442547443679529
Bond Position:  [-12.83256734]


portfolio before change:  [-8.43027499]
curr_Stock_Price:  99.49429087209319
curr_Factors:  [99.49429087]
mat_Sqrt:  [[0.15]]
grads:  [0.13357353]
Stock Position:  0.1335735323504552
Bond Position:  [-21.72007887]


portfolio before change:  [-8.50034848]
curr_Stock_Price:  98.97984807359721
curr_Factors:  [98.97984807]
mat_Sqrt:  [[0.15]]
grads:  [0.03430818]
Stock Position:  0.03430817644416627
Bond Position:  [-11.89616657]


portfolio before change:  [-8.49841082]
curr_Stock_Price:  99.05799821697441
curr_Factors:  [99.05799822]
mat_Sqrt:  [[0.15]]
grads:  [0.05820359]
Stock Position:  0.05820359112611367
Bond Position:  [-14.26394205]


portfolio before change:  [-8.50710286]
curr_Stock_Price:  98.9239769452075
curr_Factors:  [98.92397695]
mat_Sqrt:  [[0.15]]
grads:  [-0.00159924]
Stock Position:  -0.0015992423687704745
Bond Position:  [-8.34889945]


portfolio before change:  [-8.50807723]
curr_Stock_Price:  99.20695121157516
curr_Factors:  [99.20695121]
mat_Sqrt:  [[0.15]]
grads:  [0.01873787]
Stock Position:  0.018737869611081377
Bond Position:  [-10.36700415]


portfolio before change:  [-8.52174223]
curr_Stock_Price:  98.51225953125584
curr_Factors:  [98.51225953]
mat_Sqrt:  [[0.15]]
grads:  [0.14884455]
Stock Position:  0.14884454906156022
Bond Position:  [-23.18475508]


portfolio before change:  [-8.511558]
curr_Stock_Price:  98.59041707177218
curr_Factors:  [98.59041707]
mat_Sqrt:  [[0.15]]
grads:  [0.01773982]
Stock Position:  0.0177398227696372
Bond Position:  [-10.26053453]


portfolio before change:  [-8.51552486]
curr_Stock_Price:  98.4029543058819
curr_Factors:  [98.40295431]
mat_Sqrt:  [[0.15]]
grads:  [-0.10557961]
Stock Position:  -0.10557960962657591
Bond Position:  [1.87382064]


portfolio before change:  [-8.49265272]
curr_Stock_Price:  98.18742948692673
curr_Factors:  [98.18742949]
mat_Sqrt:  [[0.15]]
grads:  [-0.03967032]
Stock Position:  -0.039670320533970765
Bond Position:  [-4.59752592]


portfolio before change:  [-8.51409323]
curr_Stock_Price:  98.72065332621
curr_Factors:  [98.72065333]
mat_Sqrt:  [[0.15]]
grads:  [0.0064873]
Stock Position:  0.006487300710729161
Bond Position:  [-9.1545238]


portfolio before change:  [-8.51526752]
curr_Stock_Price:  98.62783900605908
curr_Factors:  [98.62783901]
mat_Sqrt:  [[0.15]]
grads:  [0.03426155]
Stock Position:  0.034261545403965976
Bond Position:  [-11.89440971]


portfolio before change:  [-8.52768781]
curr_Stock_Price:  98.2870234902399
curr_Factors:  [98.28702349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00055456]
Stock Position:  -0.0005545631409068
Bond Position:  [-8.47318145]


portfolio before change:  [-8.52855045]
curr_Stock_Price:  98.88757738280246
curr_Factors:  [98.88757738]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946302]
Stock Position:  -0.009463018538660654
Bond Position:  [-7.59277547]


portfolio before change:  [-8.52967407]
curr_Stock_Price:  98.95616662341031
curr_Factors:  [98.95616662]
mat_Sqrt:  [[0.15]]
grads:  [0.02420871]
Stock Position:  0.02420871372251552
Bond Position:  [-10.92527558]


portfolio before change:  [-8.53479433]
curr_Stock_Price:  98.7728688096483
curr_Factors:  [98.77286881]
mat_Sqrt:  [[0.15]]
grads:  [-0.1593899]
Stock Position:  -0.15938990108139087
Bond Position:  [7.20860346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.51578894]
Stock Price:  98.65645719923546
PL:  [-8.51578894]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.55644942e-03]
 [ 3.22928898e-02]
 [ 1.96676166e-02]
 [-2.58998162e-02]
 [ 2.44780030e-03]
 [-6.93096534e-03]
 [ 2.25516102e-03]
 [-7.68192265e-03]
 [-9.40438261e-03]
 [-4.92929642e-03]
 [ 1.35565389e-02]
 [-2.20832600e-03]
 [-2.81589623e-03]
 [ 9.00691566e-03]
 [-2.21375755e-03]
 [ 1.41743543e-02]
 [ 4.01205784e-02]
 [-1.47188821e-02]
 [ 1.79217430e-02]
 [ 2.67576916e-03]
 [-3.66666838e-03]
 [ 4.97658211e-03]
 [ 1.31813340e-02]
 [ 2.02541378e-02]
 [-1.51026180e-03]
 [ 4.42031450e-03]
 [ 5.37192842e-04]
 [ 1.05125016e-02]
 [ 1.15721028e-03]
 [ 5.02809780e-02]
 [-6.70978656e-03]
 [ 2.05473952e-02]
 [ 1.17807317e-02]
 [-2.02646958e-02]
 [-1.16814638e-03]
 [ 1.81349543e-02]
 [ 5.39373724e-03]
 [-4.91845574e-04]
 [-3.50765083e-03]
 [-7.96203224e-03]
 [ 7.06840589e-03]
 [ 3.40579197e-02]
 [-3.36862289e-03]
 [ 1.57572797e-02]
 [-5.66105189e-02]
 [ 2.48953013e-02]
 [ 9.29043817e-03]
 [ 5.36108472e-03]
 [-9.78472454e-03]
 [ 1.50858319e-04]
 [-2.14522134e-03]
 [-2.91894042e-03]
 [-1.43711222e-04]
 [ 3.29923364e-03]
 [-2.27282693e-02]
 [-5.79270940e-03]
 [-7.87441648e-03]
 [ 1.48698189e-02]
 [ 5.15054675e-03]
 [-2.12166659e-03]
 [-5.15760843e-03]
 [-3.80298584e-03]
 [ 1.09035133e-03]
 [-7.47915828e-03]
 [ 1.73589011e-02]
 [ 7.14028714e-03]
 [ 2.03084215e-02]
 [-3.71846174e-03]
 [ 6.84025559e-03]
 [ 2.54013300e-02]
 [ 3.17731528e-03]
 [-1.54095415e-02]
 [-5.81850956e-03]
 [ 2.02798716e-03]
 [ 9.92185509e-03]
 [ 2.49969811e-03]
 [-1.61279710e-03]
 [-7.67250141e-03]
 [-2.58469723e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.19288819]
curr_Stock_Price:  100.59783542518564
curr_Factors:  [100.59783543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03037633]
Stock Position:  -0.030376329451677966
Bond Position:  [18.24868118]


portfolio before change:  [15.18891132]
curr_Stock_Price:  100.76630367299244
curr_Factors:  [100.76630367]
mat_Sqrt:  [[0.15]]
grads:  [0.21528593]
Stock Position:  0.21528593180230113
Bond Position:  [-6.50465626]


portfolio before change:  [15.26223224]
curr_Stock_Price:  101.1087667152
curr_Factors:  [101.10876672]
mat_Sqrt:  [[0.15]]
grads:  [0.13111744]
Stock Position:  0.1311174437135182
Bond Position:  [2.00510921]


portfolio before change:  [15.27213882]
curr_Stock_Price:  101.18336593625966
curr_Factors:  [101.18336594]
mat_Sqrt:  [[0.15]]
grads:  [-0.17266544]
Stock Position:  -0.17266544144517754
Bond Position:  [32.74300937]


portfolio before change:  [15.39567268]
curr_Stock_Price:  100.47976621965266
curr_Factors:  [100.47976622]
mat_Sqrt:  [[0.15]]
grads:  [0.01631867]
Stock Position:  0.016318668689832967
Bond Position:  [13.75597667]


portfolio before change:  [15.38706014]
curr_Stock_Price:  99.89930740309963
curr_Factors:  [99.8993074]
mat_Sqrt:  [[0.15]]
grads:  [-0.04620644]
Stock Position:  -0.04620643559644592
Bond Position:  [20.00305106]


portfolio before change:  [15.3934994]
curr_Stock_Price:  99.78700653671127
curr_Factors:  [99.78700654]
mat_Sqrt:  [[0.15]]
grads:  [0.01503441]
Stock Position:  0.015034406791687022
Bond Position:  [13.89326095]


portfolio before change:  [15.39782437]
curr_Stock_Price:  100.01692056416307
curr_Factors:  [100.01692056]
mat_Sqrt:  [[0.15]]
grads:  [-0.05121282]
Stock Position:  -0.051212817633918495
Bond Position:  [20.51997269]


portfolio before change:  [15.41276537]
curr_Stock_Price:  99.7502204878156
curr_Factors:  [99.75022049]
mat_Sqrt:  [[0.15]]
grads:  [-0.06269588]
Stock Position:  -0.06269588404594076
Bond Position:  [21.66669363]


portfolio before change:  [15.41464727]
curr_Stock_Price:  99.74180387534489
curr_Factors:  [99.74180388]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286198]
Stock Position:  -0.03286197614810256
Bond Position:  [18.69236005]


portfolio before change:  [15.42872293]
curr_Stock_Price:  99.34902923848962
curr_Factors:  [99.34902924]
mat_Sqrt:  [[0.15]]
grads:  [0.09037693]
Stock Position:  0.09037692568613911
Bond Position:  [6.4498631]


portfolio before change:  [15.50339275]
curr_Stock_Price:  100.1707731869166
curr_Factors:  [100.17077319]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472217]
Stock Position:  -0.014722173302392227
Bond Position:  [16.97812423]


portfolio before change:  [15.49822671]
curr_Stock_Price:  100.59375466412494
curr_Factors:  [100.59375466]
mat_Sqrt:  [[0.15]]
grads:  [-0.01877264]
Stock Position:  -0.018772641509858606
Bond Position:  [17.3866372]


portfolio before change:  [15.50616453]
curr_Stock_Price:  100.2288022020961
curr_Factors:  [100.2288022]
mat_Sqrt:  [[0.15]]
grads:  [0.0600461]
Stock Position:  0.06004610437483104
Bond Position:  [9.48781541]


portfolio before change:  [15.52897694]
curr_Stock_Price:  100.5988413002492
curr_Factors:  [100.5988413]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475838]
Stock Position:  -0.014758383635369333
Bond Position:  [17.01365324]


portfolio before change:  [15.53240525]
curr_Stock_Price:  100.43859882962916
curr_Factors:  [100.43859883]
mat_Sqrt:  [[0.15]]
grads:  [0.0944957]
Stock Position:  0.0944956952130447
Bond Position:  [6.04139003]


portfolio before change:  [15.5295322]
curr_Stock_Price:  100.40419888470203
curr_Factors:  [100.40419888]
mat_Sqrt:  [[0.15]]
grads:  [0.26747052]
Stock Position:  0.2674705228096425
Bond Position:  [-11.32563137]


portfolio before change:  [15.56565436]
curr_Stock_Price:  100.54189642657818
curr_Factors:  [100.54189643]
mat_Sqrt:  [[0.15]]
grads:  [-0.09812588]
Stock Position:  -0.09812588074206957
Bond Position:  [25.4314165]


portfolio before change:  [15.50197007]
curr_Stock_Price:  101.20710124799524
curr_Factors:  [101.20710125]
mat_Sqrt:  [[0.15]]
grads:  [0.11947829]
Stock Position:  0.11947828699206162
Bond Position:  [3.40991898]


portfolio before change:  [15.37382698]
curr_Stock_Price:  100.13279551526958
curr_Factors:  [100.13279552]
mat_Sqrt:  [[0.15]]
grads:  [0.01783846]
Stock Position:  0.017838461043220705
Bond Position:  [13.58761201]


portfolio before change:  [15.36796939]
curr_Stock_Price:  99.75681863893334
curr_Factors:  [99.75681864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02444446]
Stock Position:  -0.024444455837913846
Bond Position:  [17.80647054]


portfolio before change:  [15.37969876]
curr_Stock_Price:  99.32251032336325
curr_Factors:  [99.32251032]
mat_Sqrt:  [[0.15]]
grads:  [0.03317721]
Stock Position:  0.033177214099541455
Bond Position:  [12.08445457]


portfolio before change:  [15.32999902]
curr_Stock_Price:  97.80173646906847
curr_Factors:  [97.80173647]
mat_Sqrt:  [[0.15]]
grads:  [0.08787556]
Stock Position:  0.0878755597471623
Bond Position:  [6.73561668]


portfolio before change:  [15.30766983]
curr_Stock_Price:  97.54284559772408
curr_Factors:  [97.5428456]
mat_Sqrt:  [[0.15]]
grads:  [0.13502759]
Stock Position:  0.135027585220023
Bond Position:  [2.13669493]


portfolio before change:  [15.36744666]
curr_Stock_Price:  97.984557456723
curr_Factors:  [97.98455746]
mat_Sqrt:  [[0.15]]
grads:  [-0.01006841]
Stock Position:  -0.010068411971432297
Bond Position:  [16.35399555]


portfolio before change:  [15.36958811]
curr_Stock_Price:  97.87338913946165
curr_Factors:  [97.87338914]
mat_Sqrt:  [[0.15]]
grads:  [0.02946876]
Stock Position:  0.029468763350945018
Bond Position:  [12.48538036]


portfolio before change:  [15.35256379]
curr_Stock_Price:  97.26920105064538
curr_Factors:  [97.26920105]
mat_Sqrt:  [[0.15]]
grads:  [0.00358129]
Stock Position:  0.0035812856166523785
Bond Position:  [15.004215]


portfolio before change:  [15.35332729]
curr_Stock_Price:  97.22053209243789
curr_Factors:  [97.22053209]
mat_Sqrt:  [[0.15]]
grads:  [0.07008334]
Stock Position:  0.07008334397482696
Bond Position:  [8.53978729]


portfolio before change:  [15.32246043]
curr_Stock_Price:  96.77248538057215
curr_Factors:  [96.77248538]
mat_Sqrt:  [[0.15]]
grads:  [0.00771474]
Stock Position:  0.007714735219891966
Bond Position:  [14.57588633]


portfolio before change:  [15.32066785]
curr_Stock_Price:  96.42203885587655
curr_Factors:  [96.42203886]
mat_Sqrt:  [[0.15]]
grads:  [0.33520652]
Stock Position:  0.33520651989046546
Bond Position:  [-17.00062824]


portfolio before change:  [15.2963072]
curr_Stock_Price:  96.35253521021775
curr_Factors:  [96.35253521]
mat_Sqrt:  [[0.15]]
grads:  [-0.04473191]
Stock Position:  -0.04473191039828245
Bond Position:  [19.60634017]


portfolio before change:  [15.28107332]
curr_Stock_Price:  96.72048982721712
curr_Factors:  [96.72048983]
mat_Sqrt:  [[0.15]]
grads:  [0.13698263]
Stock Position:  0.1369826349196509
Bond Position:  [2.03204577]


portfolio before change:  [15.37304538]
curr_Stock_Price:  97.39097665649935
curr_Factors:  [97.39097666]
mat_Sqrt:  [[0.15]]
grads:  [0.07853821]
Stock Position:  0.07853821113776022
Bond Position:  [7.72413229]


portfolio before change:  [15.41510668]
curr_Stock_Price:  97.92038169523912
curr_Factors:  [97.9203817]
mat_Sqrt:  [[0.15]]
grads:  [-0.13509797]
Stock Position:  -0.13509797216716218
Bond Position:  [28.64395168]


portfolio before change:  [15.31338146]
curr_Stock_Price:  98.68660724675368
curr_Factors:  [98.68660725]
mat_Sqrt:  [[0.15]]
grads:  [-0.00778764]
Stock Position:  -0.007787642539660274
Bond Position:  [16.08191748]


portfolio before change:  [15.31846509]
curr_Stock_Price:  98.16289630011597
curr_Factors:  [98.1628963]
mat_Sqrt:  [[0.15]]
grads:  [0.1208997]
Stock Position:  0.12089969503414177
Bond Position:  [3.45060086]


portfolio before change:  [15.33392597]
curr_Stock_Price:  98.28899431007407
curr_Factors:  [98.28899431]
mat_Sqrt:  [[0.15]]
grads:  [0.03595825]
Stock Position:  0.0359582482558116
Bond Position:  [11.79962591]


portfolio before change:  [15.31086061]
curr_Stock_Price:  97.62703611327971
curr_Factors:  [97.62703611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327897]
Stock Position:  -0.003278970491148916
Bond Position:  [15.63097678]


portfolio before change:  [15.314362]
curr_Stock_Price:  96.85715308460007
curr_Factors:  [96.85715308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02338434]
Stock Position:  -0.023384338861340098
Bond Position:  [17.57930249]


portfolio before change:  [15.32016399]
curr_Stock_Price:  96.65602508995381
curr_Factors:  [96.65602509]
mat_Sqrt:  [[0.15]]
grads:  [-0.05308021]
Stock Position:  -0.053080214906291445
Bond Position:  [20.45068657]


portfolio before change:  [15.29179378]
curr_Stock_Price:  97.21458385862208
curr_Factors:  [97.21458386]
mat_Sqrt:  [[0.15]]
grads:  [0.04712271]
Stock Position:  0.047122705915363654
Bond Position:  [10.71077953]


portfolio before change:  [15.27575279]
curr_Stock_Price:  96.85996859980796
curr_Factors:  [96.8599686]
mat_Sqrt:  [[0.15]]
grads:  [0.2270528]
Stock Position:  0.22705279796230407
Bond Position:  [-6.71657409]


portfolio before change:  [15.22421392]
curr_Stock_Price:  96.6348268384055
curr_Factors:  [96.63482684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245749]
Stock Position:  -0.022457485904449934
Bond Position:  [17.39438919]


portfolio before change:  [15.24128618]
curr_Stock_Price:  95.92303413117892
curr_Factors:  [95.92303413]
mat_Sqrt:  [[0.15]]
grads:  [0.10504853]
Stock Position:  0.10504853131507556
Bond Position:  [5.16471233]


portfolio before change:  [15.16743351]
curr_Stock_Price:  95.2169273692507
curr_Factors:  [95.21692737]
mat_Sqrt:  [[0.15]]
grads:  [-0.37740346]
Stock Position:  -0.37740345951861765
Bond Position:  [51.1026313]


portfolio before change:  [15.39051739]
curr_Stock_Price:  94.6342886626458
curr_Factors:  [94.63428866]
mat_Sqrt:  [[0.15]]
grads:  [0.16596868]
Stock Position:  0.1659686754658286
Bond Position:  [-0.31581016]


portfolio before change:  [15.5631693]
curr_Stock_Price:  95.67467569031183
curr_Factors:  [95.67467569]
mat_Sqrt:  [[0.15]]
grads:  [0.06193625]
Stock Position:  0.061936254459856586
Bond Position:  [9.63743825]


portfolio before change:  [15.57187712]
curr_Stock_Price:  95.80554338977602
curr_Factors:  [95.80554339]
mat_Sqrt:  [[0.15]]
grads:  [0.03574056]
Stock Position:  0.035740564770051136
Bond Position:  [12.14773289]


portfolio before change:  [15.55411249]
curr_Stock_Price:  95.28725591186029
curr_Factors:  [95.28725591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0652315]
Stock Position:  -0.06523149695746937
Bond Position:  [21.76984283]


portfolio before change:  [15.57823844]
curr_Stock_Price:  94.93826360460187
curr_Factors:  [94.9382636]
mat_Sqrt:  [[0.15]]
grads:  [0.00100572]
Stock Position:  0.001005722123731444
Bond Position:  [15.48275692]


portfolio before change:  [15.57974681]
curr_Stock_Price:  95.47585512426339
curr_Factors:  [95.47585512]
mat_Sqrt:  [[0.15]]
grads:  [-0.01430148]
Stock Position:  -0.014301475583667785
Bond Position:  [16.94519242]


portfolio before change:  [15.58219795]
curr_Stock_Price:  95.37851976445421
curr_Factors:  [95.37851976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0194596]
Stock Position:  -0.019459602789989663
Bond Position:  [17.43822606]


portfolio before change:  [15.57216276]
curr_Stock_Price:  95.95022275663607
curr_Factors:  [95.95022276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00095807]
Stock Position:  -0.0009580748123065319
Bond Position:  [15.66409026]


portfolio before change:  [15.57481814]
curr_Stock_Price:  94.20052545218404
curr_Factors:  [94.20052545]
mat_Sqrt:  [[0.15]]
grads:  [0.02199489]
Stock Position:  0.021994890955123355
Bond Position:  [13.50288786]


portfolio before change:  [15.55253807]
curr_Stock_Price:  93.14918900443486
curr_Factors:  [93.149189]
mat_Sqrt:  [[0.15]]
grads:  [-0.1515218]
Stock Position:  -0.1515217956638534
Bond Position:  [29.66667045]


portfolio before change:  [15.58403952]
curr_Stock_Price:  92.95352586160222
curr_Factors:  [92.95352586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861806]
Stock Position:  -0.038618062661341934
Bond Position:  [19.17372461]


portfolio before change:  [15.58387769]
curr_Stock_Price:  92.98874842591464
curr_Factors:  [92.98874843]
mat_Sqrt:  [[0.15]]
grads:  [-0.05249611]
Stock Position:  -0.05249610984898411
Bond Position:  [20.46542524]


portfolio before change:  [15.58699136]
curr_Stock_Price:  92.95380216316103
curr_Factors:  [92.95380216]
mat_Sqrt:  [[0.15]]
grads:  [0.09913213]
Stock Position:  0.09913212583646237
Bond Position:  [6.37228335]


portfolio before change:  [15.59848449]
curr_Stock_Price:  93.06572191131282
curr_Factors:  [93.06572191]
mat_Sqrt:  [[0.15]]
grads:  [0.03433698]
Stock Position:  0.03433697832185037
Bond Position:  [12.40288881]


portfolio before change:  [15.60608408]
curr_Stock_Price:  93.2644693121957
curr_Factors:  [93.26446931]
mat_Sqrt:  [[0.15]]
grads:  [-0.01414444]
Stock Position:  -0.01414444395361443
Bond Position:  [16.92525813]


portfolio before change:  [15.60035614]
curr_Stock_Price:  93.74421930787939
curr_Factors:  [93.74421931]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438406]
Stock Position:  -0.03438405621061599
Bond Position:  [18.82366265]


portfolio before change:  [15.59506393]
curr_Stock_Price:  93.93235095380518
curr_Factors:  [93.93235095]
mat_Sqrt:  [[0.15]]
grads:  [-0.02535324]
Stock Position:  -0.02535323892098624
Bond Position:  [17.97655326]


portfolio before change:  [15.59420769]
curr_Stock_Price:  94.01043987622639
curr_Factors:  [94.01043988]
mat_Sqrt:  [[0.15]]
grads:  [0.00726901]
Stock Position:  0.00726900885432244
Bond Position:  [14.91084497]


portfolio before change:  [15.58998172]
curr_Stock_Price:  93.30086284588174
curr_Factors:  [93.30086285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04986106]
Stock Position:  -0.049861055231654086
Bond Position:  [20.2420612]


portfolio before change:  [15.55699739]
curr_Stock_Price:  93.98776179442133
curr_Factors:  [93.98776179]
mat_Sqrt:  [[0.15]]
grads:  [0.11572601]
Stock Position:  0.11572600755059559
Bond Position:  [4.68016896]


portfolio before change:  [15.65084274]
curr_Stock_Price:  94.79616121894233
curr_Factors:  [94.79616122]
mat_Sqrt:  [[0.15]]
grads:  [0.04760191]
Stock Position:  0.047601914265046896
Bond Position:  [11.13836401]


portfolio before change:  [15.66728039]
curr_Stock_Price:  95.12685130421872
curr_Factors:  [95.1268513]
mat_Sqrt:  [[0.15]]
grads:  [0.13538948]
Stock Position:  0.13538947647834715
Bond Position:  [2.7881058]


portfolio before change:  [15.6793341]
curr_Stock_Price:  95.21459405518475
curr_Factors:  [95.21459406]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478974]
Stock Position:  -0.02478974490909674
Bond Position:  [18.0396796]


portfolio before change:  [15.67795748]
curr_Stock_Price:  95.31560920542496
curr_Factors:  [95.31560921]
mat_Sqrt:  [[0.15]]
grads:  [0.0456017]
Stock Position:  0.045601703945923944
Bond Position:  [11.33140329]


portfolio before change:  [15.70967278]
curr_Stock_Price:  95.99556326682024
curr_Factors:  [95.99556327]
mat_Sqrt:  [[0.15]]
grads:  [0.1693422]
Stock Position:  0.16934219998107722
Bond Position:  [-0.5464271]


portfolio before change:  [15.65198457]
curr_Stock_Price:  95.6551043743223
curr_Factors:  [95.65510437]
mat_Sqrt:  [[0.15]]
grads:  [0.0211821]
Stock Position:  0.02118210187815607
Bond Position:  [13.6258084]


portfolio before change:  [15.66988781]
curr_Stock_Price:  96.46010502799875
curr_Factors:  [96.46010503]
mat_Sqrt:  [[0.15]]
grads:  [-0.10273028]
Stock Position:  -0.102730276373063
Bond Position:  [25.57926106]


portfolio before change:  [15.67051381]
curr_Stock_Price:  96.46957399810414
curr_Factors:  [96.469574]
mat_Sqrt:  [[0.15]]
grads:  [-0.03879006]
Stock Position:  -0.03879006373323113
Bond Position:  [19.41257474]


portfolio before change:  [15.68015532]
curr_Stock_Price:  96.25229724771636
curr_Factors:  [96.25229725]
mat_Sqrt:  [[0.15]]
grads:  [0.01351991]
Stock Position:  0.013519914395310776
Bond Position:  [14.3788325]


portfolio before change:  [15.68610412]
curr_Stock_Price:  96.62582743912462
curr_Factors:  [96.62582744]
mat_Sqrt:  [[0.15]]
grads:  [0.0661457]
Stock Position:  0.06614570062370308
Bond Position:  [9.29472106]


portfolio before change:  [15.69343448]
curr_Stock_Price:  96.72786621722673
curr_Factors:  [96.72786622]
mat_Sqrt:  [[0.15]]
grads:  [0.01666465]
Stock Position:  0.016664654075913568
Bond Position:  [14.08149805]


portfolio before change:  [15.70004898]
curr_Stock_Price:  97.07197023657079
curr_Factors:  [97.07197024]
mat_Sqrt:  [[0.15]]
grads:  [-0.01075198]
Stock Position:  -0.010751980636729148
Bond Position:  [16.74376492]


portfolio before change:  [15.69940453]
curr_Stock_Price:  97.22924071349281
curr_Factors:  [97.22924071]
mat_Sqrt:  [[0.15]]
grads:  [-0.05115001]
Stock Position:  -0.05115000941416722
Bond Position:  [20.67268111]


portfolio before change:  [15.74718964]
curr_Stock_Price:  96.32028634116095
curr_Factors:  [96.32028634]
mat_Sqrt:  [[0.15]]
grads:  [-0.17231315]
Stock Position:  -0.1723131485283543
Bond Position:  [32.34444144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.76468692]
Stock Price:  96.2304749051953
PL:  [15.76468692]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.05527094e-03]
 [ 2.11258294e-02]
 [ 2.63361858e-03]
 [-6.95884761e-03]
 [ 1.28432047e-02]
 [-1.15430339e-03]
 [-7.09355267e-03]
 [-1.37684786e-02]
 [-5.21092580e-04]
 [ 1.81485005e-03]
 [-6.69663822e-03]
 [ 1.24135777e-02]
 [-3.65339253e-03]
 [ 7.16927088e-03]
 [ 2.52849790e-03]
 [ 1.61118652e-02]
 [ 5.00003028e-02]
 [-1.46942870e-02]
 [ 2.04086451e-02]
 [ 2.62755366e-03]
 [-4.07383663e-03]
 [ 4.12840297e-03]
 [ 1.50937154e-02]
 [ 2.87308485e-02]
 [-2.00153246e-03]
 [ 7.36647808e-03]
 [-2.23110735e-03]
 [ 1.59474384e-02]
 [ 2.73928037e-02]
 [ 2.40784406e-03]
 [-2.75171882e-03]
 [ 1.42316495e-02]
 [ 1.49628343e-02]
 [-7.22612918e-03]
 [ 4.71800010e-03]
 [ 1.16062067e-02]
 [-2.70439291e-02]
 [ 2.88065599e-03]
 [-5.69557911e-02]
 [-4.25038671e-03]
 [ 5.87469793e-03]
 [ 6.11343165e-03]
 [-3.83073502e-03]
 [-4.71815325e-03]
 [ 1.70157097e-02]
 [ 1.45634464e-02]
 [ 1.07554969e-02]
 [ 3.87358469e-03]
 [ 7.52712232e-03]
 [-2.23290132e-03]
 [-4.03834683e-03]
 [-8.17674645e-03]
 [ 2.11367626e-03]
 [ 2.12388775e-03]
 [-4.04001313e-03]
 [-3.83998706e-03]
 [ 9.10394125e-03]
 [-4.19301514e-03]
 [ 5.88571234e-03]
 [-3.81165989e-03]
 [-2.70473149e-03]
 [ 8.13176653e-03]
 [-1.61050375e-02]
 [ 3.14391285e-03]
 [ 2.52058001e-02]
 [ 6.08988644e-03]
 [ 1.45607135e-02]
 [ 5.13248880e-03]
 [ 2.95734676e-03]
 [ 1.99624662e-02]
 [ 7.74403834e-04]
 [-1.59827377e-02]
 [-1.90607692e-03]
 [ 1.36274528e-03]
 [-1.69947967e-04]
 [-5.67546166e-03]
 [-3.61127298e-03]
 [ 9.01267764e-03]
 [-2.47963396e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.28951215]
curr_Stock_Price:  100.32971618326567
curr_Factors:  [100.32971618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02036847]
Stock Position:  -0.020368472935424622
Bond Position:  [11.33307526]


portfolio before change:  [9.28834271]
curr_Stock_Price:  100.4219065797171
curr_Factors:  [100.42190658]
mat_Sqrt:  [[0.15]]
grads:  [0.14083886]
Stock Position:  0.14083886288442804
Bond Position:  [-4.85496442]


portfolio before change:  [9.22708709]
curr_Stock_Price:  99.98912706403314
curr_Factors:  [99.98912706]
mat_Sqrt:  [[0.15]]
grads:  [0.01755746]
Stock Position:  0.01755745721280018
Bond Position:  [7.47153227]


portfolio before change:  [9.2293699]
curr_Stock_Price:  100.09254881934852
curr_Factors:  [100.09254882]
mat_Sqrt:  [[0.15]]
grads:  [-0.04639232]
Stock Position:  -0.046392317393232435
Bond Position:  [13.8728952]


portfolio before change:  [9.22495213]
curr_Stock_Price:  100.20646552513332
curr_Factors:  [100.20646553]
mat_Sqrt:  [[0.15]]
grads:  [0.08562136]
Stock Position:  0.08562136439086591
Bond Position:  [0.64513783]


portfolio before change:  [9.30711237]
curr_Stock_Price:  101.16557102301464
curr_Factors:  [101.16557102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00769536]
Stock Position:  -0.007695355960900154
Bond Position:  [10.08561745]


portfolio before change:  [9.30744341]
curr_Stock_Price:  101.20446916521584
curr_Factors:  [101.20446917]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729035]
Stock Position:  -0.04729035113335933
Bond Position:  [14.09343829]


portfolio before change:  [9.34624577]
curr_Stock_Price:  100.40258263492326
curr_Factors:  [100.40258263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09178986]
Stock Position:  -0.09178985748410777
Bond Position:  [18.56218452]


portfolio before change:  [9.35878609]
curr_Stock_Price:  100.27860217852545
curr_Factors:  [100.27860218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00347395]
Stock Position:  -0.0034739505325362178
Bond Position:  [9.70714899]


portfolio before change:  [9.35815234]
curr_Stock_Price:  100.63567811879697
curr_Factors:  [100.63567812]
mat_Sqrt:  [[0.15]]
grads:  [0.012099]
Stock Position:  0.012099000334366816
Bond Position:  [8.14056124]


portfolio before change:  [9.36450841]
curr_Stock_Price:  101.11896374313491
curr_Factors:  [101.11896374]
mat_Sqrt:  [[0.15]]
grads:  [-0.04464425]
Stock Position:  -0.04464425482022408
Bond Position:  [13.8788892]


portfolio before change:  [9.35287116]
curr_Stock_Price:  101.39906054619343
curr_Factors:  [101.39906055]
mat_Sqrt:  [[0.15]]
grads:  [0.08275718]
Stock Position:  0.08275718472910411
Bond Position:  [0.96137037]


portfolio before change:  [9.35670191]
curr_Stock_Price:  101.44462353182469
curr_Factors:  [101.44462353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02435595]
Stock Position:  -0.024355950185503093
Bond Position:  [11.82748211]


portfolio before change:  [9.37688265]
curr_Stock_Price:  100.64639985152606
curr_Factors:  [100.64639985]
mat_Sqrt:  [[0.15]]
grads:  [0.04779514]
Stock Position:  0.04779513922076806
Bond Position:  [4.56647396]


portfolio before change:  [9.42105711]
curr_Stock_Price:  101.56467408199998
curr_Factors:  [101.56467408]
mat_Sqrt:  [[0.15]]
grads:  [0.01685665]
Stock Position:  0.01685665268319993
Bond Position:  [7.70901667]


portfolio before change:  [9.40997583]
curr_Stock_Price:  100.87870709358117
curr_Factors:  [100.87870709]
mat_Sqrt:  [[0.15]]
grads:  [0.10741243]
Stock Position:  0.10741243473307648
Bond Position:  [-1.42565171]


portfolio before change:  [9.40077642]
curr_Stock_Price:  100.79389100488123
curr_Factors:  [100.793891]
mat_Sqrt:  [[0.15]]
grads:  [0.33333535]
Stock Position:  0.33333535179659635
Bond Position:  [-24.1973907]


portfolio before change:  [9.25629675]
curr_Stock_Price:  100.3649917328731
curr_Factors:  [100.36499173]
mat_Sqrt:  [[0.15]]
grads:  [-0.09796191]
Stock Position:  -0.09796191306027996
Bond Position:  [19.08824334]


portfolio before change:  [9.31971642]
curr_Stock_Price:  99.72977933953159
curr_Factors:  [99.72977934]
mat_Sqrt:  [[0.15]]
grads:  [0.13605763]
Stock Position:  0.13605763410852842
Bond Position:  [-4.24928141]


portfolio before change:  [9.38186012]
curr_Stock_Price:  100.18847681100975
curr_Factors:  [100.18847681]
mat_Sqrt:  [[0.15]]
grads:  [0.01751702]
Stock Position:  0.017517024411180745
Bond Position:  [7.62685613]


portfolio before change:  [9.36724133]
curr_Stock_Price:  99.32671587297527
curr_Factors:  [99.32671587]
mat_Sqrt:  [[0.15]]
grads:  [-0.02715891]
Stock Position:  -0.027158910867416525
Bond Position:  [12.06484675]


portfolio before change:  [9.34172007]
curr_Stock_Price:  100.29418228517953
curr_Factors:  [100.29418229]
mat_Sqrt:  [[0.15]]
grads:  [0.02752269]
Stock Position:  0.027522686457214965
Bond Position:  [6.58135474]


portfolio before change:  [9.35916992]
curr_Stock_Price:  100.91325356904048
curr_Factors:  [100.91325357]
mat_Sqrt:  [[0.15]]
grads:  [0.10062477]
Stock Position:  0.10062476959721087
Bond Position:  [-0.79520297]


portfolio before change:  [9.47191627]
curr_Stock_Price:  102.03421064647802
curr_Factors:  [102.03421065]
mat_Sqrt:  [[0.15]]
grads:  [0.19153899]
Stock Position:  0.19153899002298438
Bond Position:  [-10.07161338]


portfolio before change:  [9.33576701]
curr_Stock_Price:  101.32667969927508
curr_Factors:  [101.3266797]
mat_Sqrt:  [[0.15]]
grads:  [-0.01334355]
Stock Position:  -0.013343549724295923
Bond Position:  [10.6878246]


portfolio before change:  [9.33397984]
curr_Stock_Price:  101.51067745908736
curr_Factors:  [101.51067746]
mat_Sqrt:  [[0.15]]
grads:  [0.04910985]
Stock Position:  0.049109853861501324
Bond Position:  [4.3488053]


portfolio before change:  [9.34340721]
curr_Stock_Price:  101.69710769270681
curr_Factors:  [101.69710769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487405]
Stock Position:  -0.014874048980356252
Bond Position:  [10.85605497]


portfolio before change:  [9.33846888]
curr_Stock_Price:  102.07473509071036
curr_Factors:  [102.07473509]
mat_Sqrt:  [[0.15]]
grads:  [0.10631626]
Stock Position:  0.10631625592638162
Bond Position:  [-1.51373477]


portfolio before change:  [9.33683495]
curr_Stock_Price:  102.06025638139704
curr_Factors:  [102.06025638]
mat_Sqrt:  [[0.15]]
grads:  [0.18261869]
Stock Position:  0.1826186910750447
Bond Position:  [-9.30127548]


portfolio before change:  [9.17410528]
curr_Stock_Price:  101.17234986012467
curr_Factors:  [101.17234986]
mat_Sqrt:  [[0.15]]
grads:  [0.01605229]
Stock Position:  0.01605229374855105
Bond Position:  [7.550057]


portfolio before change:  [9.18642453]
curr_Stock_Price:  101.91039743886851
curr_Factors:  [101.91039744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834479]
Stock Position:  -0.01834479212964507
Bond Position:  [11.05594958]


portfolio before change:  [9.16701108]
curr_Stock_Price:  103.00631980492399
curr_Factors:  [103.0063198]
mat_Sqrt:  [[0.15]]
grads:  [0.09487766]
Stock Position:  0.09487766345182105
Bond Position:  [-0.60598787]


portfolio before change:  [9.24782221]
curr_Stock_Price:  103.85845931356013
curr_Factors:  [103.85845931]
mat_Sqrt:  [[0.15]]
grads:  [0.09975223]
Stock Position:  0.0997522286028623
Bond Position:  [-1.11229057]


portfolio before change:  [9.27188209]
curr_Stock_Price:  104.1003527340915
curr_Factors:  [104.10035273]
mat_Sqrt:  [[0.15]]
grads:  [-0.04817419]
Stock Position:  -0.04817419450181489
Bond Position:  [14.28683273]


portfolio before change:  [9.30701763]
curr_Stock_Price:  103.38954524415723
curr_Factors:  [103.38954524]
mat_Sqrt:  [[0.15]]
grads:  [0.03145333]
Stock Position:  0.03145333401640444
Bond Position:  [6.05507173]


portfolio before change:  [9.27499962]
curr_Stock_Price:  102.35956016289225
curr_Factors:  [102.35956016]
mat_Sqrt:  [[0.15]]
grads:  [0.07737471]
Stock Position:  0.07737471132234398
Bond Position:  [1.3549582]


portfolio before change:  [9.23012994]
curr_Stock_Price:  101.77856458998542
curr_Factors:  [101.77856459]
mat_Sqrt:  [[0.15]]
grads:  [-0.18029286]
Stock Position:  -0.18029286091579122
Bond Position:  [27.58007853]


portfolio before change:  [9.44123808]
curr_Stock_Price:  100.6172078312687
curr_Factors:  [100.61720783]
mat_Sqrt:  [[0.15]]
grads:  [0.01920437]
Stock Position:  0.019204373279153288
Bond Position:  [7.50894766]


portfolio before change:  [9.42989876]
curr_Stock_Price:  100.0023141455475
curr_Factors:  [100.00231415]
mat_Sqrt:  [[0.15]]
grads:  [-0.37970527]
Stock Position:  -0.3797052740969733
Bond Position:  [47.40130486]


portfolio before change:  [9.4873138]
curr_Stock_Price:  99.85890722206338
curr_Factors:  [99.85890722]
mat_Sqrt:  [[0.15]]
grads:  [-0.02833591]
Stock Position:  -0.02833591142116284
Bond Position:  [12.31690695]


portfolio before change:  [9.4529466]
curr_Stock_Price:  101.09892485100426
curr_Factors:  [101.09892485]
mat_Sqrt:  [[0.15]]
grads:  [0.03916465]
Stock Position:  0.03916465285189253
Bond Position:  [5.4934423]


portfolio before change:  [9.44824869]
curr_Stock_Price:  100.97020516382416
curr_Factors:  [100.97020516]
mat_Sqrt:  [[0.15]]
grads:  [0.04075621]
Stock Position:  0.040756211000807084
Bond Position:  [5.3330857]


portfolio before change:  [9.44956089]
curr_Stock_Price:  100.9942228950309
curr_Factors:  [100.9942229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02553823]
Stock Position:  -0.02553823343509762
Bond Position:  [12.02877493]


portfolio before change:  [9.4563067]
curr_Stock_Price:  100.75951627921773
curr_Factors:  [100.75951628]
mat_Sqrt:  [[0.15]]
grads:  [-0.03145436]
Stock Position:  -0.031454355027727594
Bond Position:  [12.6256323]


portfolio before change:  [9.44214755]
curr_Stock_Price:  101.23475332582034
curr_Factors:  [101.23475333]
mat_Sqrt:  [[0.15]]
grads:  [0.11343806]
Stock Position:  0.11343806448335846
Bond Position:  [-2.04172692]


portfolio before change:  [9.38109477]
curr_Stock_Price:  100.69767461559476
curr_Factors:  [100.69767462]
mat_Sqrt:  [[0.15]]
grads:  [0.09708964]
Stock Position:  0.09708964295304731
Bond Position:  [-0.3956065]


portfolio before change:  [9.41929707]
curr_Stock_Price:  101.09140377086537
curr_Factors:  [101.09140377]
mat_Sqrt:  [[0.15]]
grads:  [0.07170331]
Stock Position:  0.0717033129082624
Bond Position:  [2.17070851]


portfolio before change:  [9.37178039]
curr_Stock_Price:  100.42682707802373
curr_Factors:  [100.42682708]
mat_Sqrt:  [[0.15]]
grads:  [0.0258239]
Stock Position:  0.025823897938516867
Bond Position:  [6.77836826]


portfolio before change:  [9.3549492]
curr_Stock_Price:  99.75865329365438
curr_Factors:  [99.75865329]
mat_Sqrt:  [[0.15]]
grads:  [0.05018082]
Stock Position:  0.050180815499628356
Bond Position:  [4.34897863]


portfolio before change:  [9.35071472]
curr_Stock_Price:  99.66885212299745
curr_Factors:  [99.66885212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488601]
Stock Position:  -0.014886008813764562
Bond Position:  [10.83438614]


portfolio before change:  [9.35123904]
curr_Stock_Price:  99.67912066035467
curr_Factors:  [99.67912066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02692231]
Stock Position:  -0.026922312184713672
Bond Position:  [12.03483144]


portfolio before change:  [9.34016299]
curr_Stock_Price:  100.11846803979628
curr_Factors:  [100.11846804]
mat_Sqrt:  [[0.15]]
grads:  [-0.05451164]
Stock Position:  -0.05451164298117891
Bond Position:  [14.79778518]


portfolio before change:  [9.34374143]
curr_Stock_Price:  100.06978953934569
curr_Factors:  [100.06978954]
mat_Sqrt:  [[0.15]]
grads:  [0.01409118]
Stock Position:  0.014091175071085644
Bond Position:  [7.9336405]


portfolio before change:  [9.35338067]
curr_Stock_Price:  100.71866182326762
curr_Factors:  [100.71866182]
mat_Sqrt:  [[0.15]]
grads:  [0.01415925]
Stock Position:  0.014159251638139261
Bond Position:  [7.92727979]


portfolio before change:  [9.35164328]
curr_Stock_Price:  100.56096610933861
curr_Factors:  [100.56096611]
mat_Sqrt:  [[0.15]]
grads:  [-0.02693342]
Stock Position:  -0.02693342085264954
Bond Position:  [12.06009411]


portfolio before change:  [9.35010236]
curr_Stock_Price:  100.64616508241278
curr_Factors:  [100.64616508]
mat_Sqrt:  [[0.15]]
grads:  [-0.02559991]
Stock Position:  -0.025599913735785403
Bond Position:  [11.92663551]


portfolio before change:  [9.3473554]
curr_Stock_Price:  100.7825876371025
curr_Factors:  [100.78258764]
mat_Sqrt:  [[0.15]]
grads:  [0.06069294]
Stock Position:  0.0606929416437774
Bond Position:  [3.23056369]


portfolio before change:  [9.38280702]
curr_Stock_Price:  101.3633752167409
curr_Factors:  [101.36337522]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795343]
Stock Position:  -0.02795343424390348
Bond Position:  [12.21626146]


portfolio before change:  [9.35406756]
curr_Stock_Price:  102.41880906731478
curr_Factors:  [102.41880907]
mat_Sqrt:  [[0.15]]
grads:  [0.03923808]
Stock Position:  0.039238082276882004
Bond Position:  [5.3353499]


portfolio before change:  [9.37280921]
curr_Stock_Price:  102.88794966626463
curr_Factors:  [102.88794967]
mat_Sqrt:  [[0.15]]
grads:  [-0.02541107]
Stock Position:  -0.025411065912955878
Bond Position:  [11.98730168]


portfolio before change:  [9.38158651]
curr_Stock_Price:  102.57202120606775
curr_Factors:  [102.57202121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01803154]
Stock Position:  -0.01803154323842287
Bond Position:  [11.23111835]


portfolio before change:  [9.38482285]
curr_Stock_Price:  102.43146907351435
curr_Factors:  [102.43146907]
mat_Sqrt:  [[0.15]]
grads:  [0.05421178]
Stock Position:  0.05421177688940662
Bond Position:  [3.83183091]


portfolio before change:  [9.37068759]
curr_Stock_Price:  102.16630979092712
curr_Factors:  [102.16630979]
mat_Sqrt:  [[0.15]]
grads:  [-0.10736692]
Stock Position:  -0.1073669164609129
Bond Position:  [20.33996924]


portfolio before change:  [9.30844396]
curr_Stock_Price:  102.75787860994447
curr_Factors:  [102.75787861]
mat_Sqrt:  [[0.15]]
grads:  [0.02095942]
Stock Position:  0.020959419020841828
Bond Position:  [7.15469853]


portfolio before change:  [9.29743686]
curr_Stock_Price:  102.21138046388944
curr_Factors:  [102.21138046]
mat_Sqrt:  [[0.15]]
grads:  [0.16803867]
Stock Position:  0.16803866730697592
Bond Position:  [-7.8780273]


portfolio before change:  [9.27682243]
curr_Stock_Price:  102.09163395994571
curr_Factors:  [102.09163396]
mat_Sqrt:  [[0.15]]
grads:  [0.04059924]
Stock Position:  0.040599242930765334
Bond Position:  [5.13197938]


portfolio before change:  [9.30995169]
curr_Stock_Price:  102.89974025987334
curr_Factors:  [102.89974026]
mat_Sqrt:  [[0.15]]
grads:  [0.09707142]
Stock Position:  0.097071423565225
Bond Position:  [-0.67867258]


portfolio before change:  [9.22415001]
curr_Stock_Price:  102.01627470233444
curr_Factors:  [102.0162747]
mat_Sqrt:  [[0.15]]
grads:  [0.03421659]
Stock Position:  0.03421659198799659
Bond Position:  [5.73350076]


portfolio before change:  [9.19756265]
curr_Stock_Price:  101.22877033294013
curr_Factors:  [101.22877033]
mat_Sqrt:  [[0.15]]
grads:  [0.01971565]
Stock Position:  0.019715645091787876
Bond Position:  [7.20177214]


portfolio before change:  [9.1871615]
curr_Stock_Price:  100.67838147999618
curr_Factors:  [100.67838148]
mat_Sqrt:  [[0.15]]
grads:  [0.13308311]
Stock Position:  0.1330831080266711
Bond Position:  [-4.21143041]


portfolio before change:  [9.11344334]
curr_Stock_Price:  100.12643356792813
curr_Factors:  [100.12643357]
mat_Sqrt:  [[0.15]]
grads:  [0.00516269]
Stock Position:  0.005162692229887095
Bond Position:  [8.59652138]


portfolio before change:  [9.11474001]
curr_Stock_Price:  100.27352290241045
curr_Factors:  [100.2735229]
mat_Sqrt:  [[0.15]]
grads:  [-0.10655158]
Stock Position:  -0.10655158477775989
Bond Position:  [19.79904279]


portfolio before change:  [9.10265324]
curr_Stock_Price:  100.39857265200372
curr_Factors:  [100.39857265]
mat_Sqrt:  [[0.15]]
grads:  [-0.01270718]
Stock Position:  -0.012707179467818705
Bond Position:  [10.37843593]


portfolio before change:  [9.09690273]
curr_Stock_Price:  100.90216126686481
curr_Factors:  [100.90216127]
mat_Sqrt:  [[0.15]]
grads:  [0.00908497]
Stock Position:  0.00908496851259417
Bond Position:  [8.18020977]


portfolio before change:  [9.09237237]
curr_Stock_Price:  100.34721884041245
curr_Factors:  [100.34721884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00113299]
Stock Position:  -0.0011329864493566863
Bond Position:  [9.20606441]


portfolio before change:  [9.0931397]
curr_Stock_Price:  100.17781360458788
curr_Factors:  [100.1778136]
mat_Sqrt:  [[0.15]]
grads:  [-0.03783641]
Stock Position:  -0.0378364110723695
Bond Position:  [12.88350864]


portfolio before change:  [9.11174381]
curr_Stock_Price:  99.70739722803462
curr_Factors:  [99.70739723]
mat_Sqrt:  [[0.15]]
grads:  [-0.02407515]
Stock Position:  -0.02407515317253971
Bond Position:  [11.51221467]


portfolio before change:  [9.10605239]
curr_Stock_Price:  99.97368654491787
curr_Factors:  [99.97368654]
mat_Sqrt:  [[0.15]]
grads:  [0.06008452]
Stock Position:  0.060084517572599055
Bond Position:  [3.09918167]


portfolio before change:  [9.06435372]
curr_Stock_Price:  99.27646237594342
curr_Factors:  [99.27646238]
mat_Sqrt:  [[0.15]]
grads:  [-0.16530893]
Stock Position:  -0.16530893037274064
Bond Position:  [25.47563953]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.0557686]
Stock Price:  99.338028278019
PL:  [9.0557686]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.51447591e-03]
 [ 3.66212202e-02]
 [ 1.68555685e-02]
 [-9.64567229e-03]
 [ 1.32663848e-02]
 [-1.31063710e-02]
 [-6.51142886e-04]
 [-4.88544345e-03]
 [-7.66550301e-03]
 [-7.06182652e-03]
 [ 1.47418130e-02]
 [ 5.29740650e-03]
 [-2.17648872e-03]
 [ 7.31953816e-03]
 [-2.27189207e-03]
 [ 1.33176066e-02]
 [ 2.25229199e-02]
 [-1.50151101e-02]
 [ 2.09675001e-02]
 [ 2.57915589e-03]
 [-4.14446387e-03]
 [ 4.84021700e-03]
 [ 1.77780749e-02]
 [ 1.92298255e-02]
 [-1.57430811e-03]
 [ 4.50965809e-03]
 [ 9.74178394e-03]
 [ 8.00886409e-03]
 [ 1.56589896e-02]
 [ 1.69152473e-03]
 [-7.01820098e-03]
 [ 9.90194365e-03]
 [ 1.23051854e-02]
 [ 9.42354822e-03]
 [ 5.22687187e-03]
 [ 9.66541703e-03]
 [-2.76417141e-02]
 [ 3.43515591e-03]
 [-4.18635731e-02]
 [-1.00712733e-02]
 [ 4.07830731e-03]
 [ 1.06700364e-02]
 [-8.37296383e-03]
 [-3.93080379e-03]
 [ 1.32686857e-02]
 [ 1.25281609e-02]
 [ 1.06765923e-02]
 [ 7.97306094e-04]
 [ 1.58048408e-02]
 [-1.17311689e-03]
 [ 2.17794541e-02]
 [ 2.81918859e-03]
 [-1.13644072e-03]
 [-1.64890578e-02]
 [-1.94990774e-03]
 [-3.17089293e-03]
 [ 1.04909246e-02]
 [-4.90980409e-03]
 [ 6.65536035e-03]
 [-3.99766274e-03]
 [-1.55460347e-03]
 [ 7.74600663e-03]
 [-1.09025948e-02]
 [ 7.34916912e-03]
 [ 2.48981909e-02]
 [ 5.51463292e-03]
 [ 7.40251736e-03]
 [-1.45202906e-03]
 [ 2.79959281e-03]
 [ 2.22460798e-02]
 [ 3.62546230e-03]
 [-1.56390169e-02]
 [-5.92325503e-03]
 [ 1.18014877e-03]
 [ 5.64430806e-03]
 [ 3.03092472e-04]
 [-1.45635597e-03]
 [ 4.30202848e-04]
 [-2.36592673e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.62882812]
curr_Stock_Price:  100.93556057840529
curr_Factors:  [100.93556058]
mat_Sqrt:  [[0.15]]
grads:  [-0.04342984]
Stock Position:  -0.0434298393858549
Bond Position:  [27.0124433]


portfolio before change:  [22.6320699]
curr_Stock_Price:  100.89979130385946
curr_Factors:  [100.8997913]
mat_Sqrt:  [[0.15]]
grads:  [0.24414147]
Stock Position:  0.2441414681842415
Bond Position:  [-2.00175329]


portfolio before change:  [22.52391613]
curr_Stock_Price:  100.45730745618364
curr_Factors:  [100.45730746]
mat_Sqrt:  [[0.15]]
grads:  [0.11237046]
Stock Position:  0.1123704567461738
Bond Position:  [11.23548261]


portfolio before change:  [22.51681234]
curr_Stock_Price:  100.38784047627907
curr_Factors:  [100.38784048]
mat_Sqrt:  [[0.15]]
grads:  [-0.06430448]
Stock Position:  -0.06430448191660663
Bond Position:  [28.97220041]


portfolio before change:  [22.53303142]
curr_Stock_Price:  100.16377738288344
curr_Factors:  [100.16377738]
mat_Sqrt:  [[0.15]]
grads:  [0.08844257]
Stock Position:  0.08844256531040923
Bond Position:  [13.67428999]


portfolio before change:  [22.46099905]
curr_Stock_Price:  99.33966020819096
curr_Factors:  [99.33966021]
mat_Sqrt:  [[0.15]]
grads:  [-0.08737581]
Stock Position:  -0.08737580685070426
Bond Position:  [31.14088201]


portfolio before change:  [22.45712375]
curr_Stock_Price:  99.40628815256107
curr_Factors:  [99.40628815]
mat_Sqrt:  [[0.15]]
grads:  [-0.00434095]
Stock Position:  -0.004340952570314044
Bond Position:  [22.88864173]


portfolio before change:  [22.45664185]
curr_Stock_Price:  99.84685421620819
curr_Factors:  [99.84685422]
mat_Sqrt:  [[0.15]]
grads:  [-0.03256962]
Stock Position:  -0.03256962297493759
Bond Position:  [25.70861625]


portfolio before change:  [22.45657605]
curr_Stock_Price:  99.89821027662876
curr_Factors:  [99.89821028]
mat_Sqrt:  [[0.15]]
grads:  [-0.05110335]
Stock Position:  -0.0511033534045283
Bond Position:  [27.56170959]


portfolio before change:  [22.47624359]
curr_Stock_Price:  99.54706132348863
curr_Factors:  [99.54706132]
mat_Sqrt:  [[0.15]]
grads:  [-0.04707884]
Stock Position:  -0.04707884344536949
Bond Position:  [27.16280411]


portfolio before change:  [22.46967836]
curr_Stock_Price:  99.72257458437424
curr_Factors:  [99.72257458]
mat_Sqrt:  [[0.15]]
grads:  [0.09827875]
Stock Position:  0.09827875317105292
Bond Position:  [12.66906807]


portfolio before change:  [22.5879694]
curr_Stock_Price:  100.91814532442244
curr_Factors:  [100.91814532]
mat_Sqrt:  [[0.15]]
grads:  [0.03531604]
Stock Position:  0.03531604331379438
Bond Position:  [19.02393981]


portfolio before change:  [22.55992756]
curr_Stock_Price:  100.09045118088169
curr_Factors:  [100.09045118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01450992]
Stock Position:  -0.014509924833268732
Bond Position:  [24.01223248]


portfolio before change:  [22.55389462]
curr_Stock_Price:  100.60966445847988
curr_Factors:  [100.60966446]
mat_Sqrt:  [[0.15]]
grads:  [0.04879692]
Stock Position:  0.04879692108858139
Bond Position:  [17.64445276]


portfolio before change:  [22.55340298]
curr_Stock_Price:  100.57698921767879
curr_Factors:  [100.57698922]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514595]
Stock Position:  -0.01514594715140153
Bond Position:  [24.07673675]


portfolio before change:  [22.56223119]
curr_Stock_Price:  100.09346967488709
curr_Factors:  [100.09346967]
mat_Sqrt:  [[0.15]]
grads:  [0.08878404]
Stock Position:  0.08878404419838529
Bond Position:  [13.67552815]


portfolio before change:  [22.49673358]
curr_Stock_Price:  99.34612416449019
curr_Factors:  [99.34612416]
mat_Sqrt:  [[0.15]]
grads:  [0.1501528]
Stock Position:  0.15015279943328141
Bond Position:  [7.57963492]


portfolio before change:  [22.48071482]
curr_Stock_Price:  99.23628607451055
curr_Factors:  [99.23628607]
mat_Sqrt:  [[0.15]]
grads:  [-0.10010073]
Stock Position:  -0.10010073376425793
Bond Position:  [32.41433988]


portfolio before change:  [22.45040944]
curr_Stock_Price:  99.55927416998658
curr_Factors:  [99.55927417]
mat_Sqrt:  [[0.15]]
grads:  [0.13978333]
Stock Position:  0.13978333377259355
Bond Position:  [8.53368219]


portfolio before change:  [22.50594359]
curr_Stock_Price:  99.9527458597685
curr_Factors:  [99.95274586]
mat_Sqrt:  [[0.15]]
grads:  [0.01719437]
Stock Position:  0.017194372589726822
Bond Position:  [20.78731884]


portfolio before change:  [22.50921934]
curr_Stock_Price:  100.0676961175557
curr_Factors:  [100.06769612]
mat_Sqrt:  [[0.15]]
grads:  [-0.02762976]
Stock Position:  -0.027629759131643634
Bond Position:  [25.27406568]


portfolio before change:  [22.52798385]
curr_Stock_Price:  99.44572803191458
curr_Factors:  [99.44572803]
mat_Sqrt:  [[0.15]]
grads:  [0.03226811]
Stock Position:  0.032268113360957355
Bond Position:  [19.31905782]


portfolio before change:  [22.53188959]
curr_Stock_Price:  99.52934833410332
curr_Factors:  [99.52934833]
mat_Sqrt:  [[0.15]]
grads:  [0.1185205]
Stock Position:  0.11852049915505333
Bond Position:  [10.73562155]


portfolio before change:  [22.40471614]
curr_Stock_Price:  98.45067883658855
curr_Factors:  [98.45067884]
mat_Sqrt:  [[0.15]]
grads:  [0.12819884]
Stock Position:  0.12819883634925586
Bond Position:  [9.78345368]


portfolio before change:  [22.34682133]
curr_Stock_Price:  97.9943072902079
curr_Factors:  [97.99430729]
mat_Sqrt:  [[0.15]]
grads:  [-0.01049539]
Stock Position:  -0.010495387422647436
Bond Position:  [23.37530955]


portfolio before change:  [22.34601717]
curr_Stock_Price:  98.21013168668344
curr_Factors:  [98.21013169]
mat_Sqrt:  [[0.15]]
grads:  [0.03006439]
Stock Position:  0.030064387272425178
Bond Position:  [19.39338974]


portfolio before change:  [22.35878467]
curr_Stock_Price:  98.59448579463873
curr_Factors:  [98.59448579]
mat_Sqrt:  [[0.15]]
grads:  [0.06494523]
Stock Position:  0.06494522629812152
Bond Position:  [15.95554347]


portfolio before change:  [22.39515159]
curr_Stock_Price:  99.13909353503536
curr_Factors:  [99.13909354]
mat_Sqrt:  [[0.15]]
grads:  [0.05339243]
Stock Position:  0.0533924272900001
Bond Position:  [17.10187475]


portfolio before change:  [22.38317371]
curr_Stock_Price:  98.89473713931073
curr_Factors:  [98.89473714]
mat_Sqrt:  [[0.15]]
grads:  [0.10439326]
Stock Position:  0.10439326431423475
Bond Position:  [12.05922928]


portfolio before change:  [22.44785449]
curr_Stock_Price:  99.50710478197412
curr_Factors:  [99.50710478]
mat_Sqrt:  [[0.15]]
grads:  [0.01127683]
Stock Position:  0.011276831510231983
Bond Position:  [21.32572964]


portfolio before change:  [22.45049457]
curr_Stock_Price:  99.62302169506295
curr_Factors:  [99.6230217]
mat_Sqrt:  [[0.15]]
grads:  [-0.04678801]
Stock Position:  -0.04678800652877191
Bond Position:  [27.11165716]


portfolio before change:  [22.4501485]
curr_Stock_Price:  99.6666353553357
curr_Factors:  [99.66663536]
mat_Sqrt:  [[0.15]]
grads:  [0.06601296]
Stock Position:  0.0660129576544617
Bond Position:  [15.87085912]


portfolio before change:  [22.49359229]
curr_Stock_Price:  100.30971855027293
curr_Factors:  [100.30971855]
mat_Sqrt:  [[0.15]]
grads:  [0.08203457]
Stock Position:  0.08203456935795266
Bond Position:  [14.26472772]


portfolio before change:  [22.5426642]
curr_Stock_Price:  100.89703607775294
curr_Factors:  [100.89703608]
mat_Sqrt:  [[0.15]]
grads:  [0.06282365]
Stock Position:  0.0628236547966572
Bond Position:  [16.20394364]


portfolio before change:  [22.5424587]
curr_Stock_Price:  100.87764405606882
curr_Factors:  [100.87764406]
mat_Sqrt:  [[0.15]]
grads:  [0.03484581]
Stock Position:  0.03484581247970074
Bond Position:  [19.02729523]


portfolio before change:  [22.55205326]
curr_Stock_Price:  101.11885851002809
curr_Factors:  [101.11885851]
mat_Sqrt:  [[0.15]]
grads:  [0.06443611]
Stock Position:  0.06443611352826603
Bond Position:  [16.03634701]


portfolio before change:  [22.54339018]
curr_Stock_Price:  100.96885913064024
curr_Factors:  [100.96885913]
mat_Sqrt:  [[0.15]]
grads:  [-0.18427809]
Stock Position:  -0.18427809382357446
Bond Position:  [41.14973908]


portfolio before change:  [22.58218191]
curr_Stock_Price:  100.77230952960375
curr_Factors:  [100.77230953]
mat_Sqrt:  [[0.15]]
grads:  [0.02290104]
Stock Position:  0.022901039374983688
Bond Position:  [20.27439128]


portfolio before change:  [22.60113603]
curr_Stock_Price:  101.54462965590537
curr_Factors:  [101.54462966]
mat_Sqrt:  [[0.15]]
grads:  [-0.27909049]
Stock Position:  -0.27909048749275145
Bond Position:  [50.94127623]


portfolio before change:  [22.51608402]
curr_Stock_Price:  101.86078498871194
curr_Factors:  [101.86078499]
mat_Sqrt:  [[0.15]]
grads:  [-0.06714182]
Stock Position:  -0.06714182192608538
Bond Position:  [29.3552027]


portfolio before change:  [22.4833137]
curr_Stock_Price:  102.37618756784867
curr_Factors:  [102.37618757]
mat_Sqrt:  [[0.15]]
grads:  [0.02718872]
Stock Position:  0.027188715421850237
Bond Position:  [19.69983668]


portfolio before change:  [22.48501196]
curr_Stock_Price:  102.39336309844548
curr_Factors:  [102.3933631]
mat_Sqrt:  [[0.15]]
grads:  [0.07113358]
Stock Position:  0.07113357581720103
Bond Position:  [15.20140591]


portfolio before change:  [22.52449929]
curr_Stock_Price:  102.93512138408809
curr_Factors:  [102.93512138]
mat_Sqrt:  [[0.15]]
grads:  [-0.05581976]
Stock Position:  -0.05581975889578702
Bond Position:  [28.27031294]


portfolio before change:  [22.58874043]
curr_Stock_Price:  101.81590843379509
curr_Factors:  [101.81590843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02620536]
Stock Position:  -0.02620535861730601
Bond Position:  [25.25686283]


portfolio before change:  [22.59361135]
curr_Stock_Price:  101.69027312422557
curr_Factors:  [101.69027312]
mat_Sqrt:  [[0.15]]
grads:  [0.0884579]
Stock Position:  0.08845790463899113
Bond Position:  [13.59830287]


portfolio before change:  [22.6317612]
curr_Stock_Price:  102.11194176101843
curr_Factors:  [102.11194176]
mat_Sqrt:  [[0.15]]
grads:  [0.08352107]
Stock Position:  0.08352107267995698
Bond Position:  [14.10326229]


portfolio before change:  [22.57367129]
curr_Stock_Price:  101.40587578089003
curr_Factors:  [101.40587578]
mat_Sqrt:  [[0.15]]
grads:  [0.07117728]
Stock Position:  0.0711772820016608
Bond Position:  [15.35587667]


portfolio before change:  [22.60861062]
curr_Stock_Price:  101.88326911304446
curr_Factors:  [101.88326911]
mat_Sqrt:  [[0.15]]
grads:  [0.00531537]
Stock Position:  0.005315373960036121
Bond Position:  [22.06706295]


portfolio before change:  [22.61025753]
curr_Stock_Price:  101.9336280170884
curr_Factors:  [101.93362802]
mat_Sqrt:  [[0.15]]
grads:  [0.10536561]
Stock Position:  0.10536560520455901
Bond Position:  [11.86995913]


portfolio before change:  [22.66582331]
curr_Stock_Price:  102.45394846033334
curr_Factors:  [102.45394846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782078]
Stock Position:  -0.007820779237729364
Bond Position:  [23.46709302]


portfolio before change:  [22.66734566]
curr_Stock_Price:  102.44683743116398
curr_Factors:  [102.44683743]
mat_Sqrt:  [[0.15]]
grads:  [0.14519636]
Stock Position:  0.14519636066208688
Bond Position:  [7.79243771]


portfolio before change:  [22.83514122]
curr_Stock_Price:  103.59912881099622
curr_Factors:  [103.59912881]
mat_Sqrt:  [[0.15]]
grads:  [0.01879459]
Stock Position:  0.01879459063204
Bond Position:  [20.888038]


portfolio before change:  [22.82721247]
curr_Stock_Price:  103.10780192485073
curr_Factors:  [103.10780192]
mat_Sqrt:  [[0.15]]
grads:  [-0.00757627]
Stock Position:  -0.007576271492501199
Bond Position:  [23.60838517]


portfolio before change:  [22.82782886]
curr_Stock_Price:  103.22120687881078
curr_Factors:  [103.22120688]
mat_Sqrt:  [[0.15]]
grads:  [-0.10992705]
Stock Position:  -0.10992705182660051
Bond Position:  [34.17463182]


portfolio before change:  [22.87140856]
curr_Stock_Price:  102.8441957345156
curr_Factors:  [102.84419573]
mat_Sqrt:  [[0.15]]
grads:  [-0.01299938]
Stock Position:  -0.01299938493043614
Bond Position:  [24.20831985]


portfolio before change:  [22.87518015]
curr_Stock_Price:  102.67045501560686
curr_Factors:  [102.67045502]
mat_Sqrt:  [[0.15]]
grads:  [-0.02113929]
Stock Position:  -0.021139286175209118
Bond Position:  [25.04556028]


portfolio before change:  [22.89567272]
curr_Stock_Price:  101.77509965430298
curr_Factors:  [101.77509965]
mat_Sqrt:  [[0.15]]
grads:  [0.0699395]
Stock Position:  0.06993949759920252
Bond Position:  [15.77757338]


portfolio before change:  [22.88352712]
curr_Stock_Price:  101.58734122476906
curr_Factors:  [101.58734122]
mat_Sqrt:  [[0.15]]
grads:  [-0.03273203]
Stock Position:  -0.03273202726902048
Bond Position:  [26.20868674]


portfolio before change:  [22.87829969]
curr_Stock_Price:  101.7970906975298
curr_Factors:  [101.7970907]
mat_Sqrt:  [[0.15]]
grads:  [0.04436907]
Stock Position:  0.04436906900524481
Bond Position:  [18.36165755]


portfolio before change:  [22.85324687]
curr_Stock_Price:  101.20657892413709
curr_Factors:  [101.20657892]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665108]
Stock Position:  -0.02665108495237804
Bond Position:  [25.550512]


portfolio before change:  [22.85221653]
curr_Stock_Price:  101.30516030827847
curr_Factors:  [101.30516031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01036402]
Stock Position:  -0.010364023125587613
Bond Position:  [23.90214555]


portfolio before change:  [22.85213835]
curr_Stock_Price:  101.45684910394034
curr_Factors:  [101.4568491]
mat_Sqrt:  [[0.15]]
grads:  [0.05164004]
Stock Position:  0.05164004419619489
Bond Position:  [17.61290218]


portfolio before change:  [22.83767778]
curr_Stock_Price:  101.15550512812068
curr_Factors:  [101.15550513]
mat_Sqrt:  [[0.15]]
grads:  [-0.07268397]
Stock Position:  -0.07268396561295246
Bond Position:  [30.19006103]


portfolio before change:  [22.85223327]
curr_Stock_Price:  100.98120865455876
curr_Factors:  [100.98120865]
mat_Sqrt:  [[0.15]]
grads:  [0.04899446]
Stock Position:  0.04899446081988375
Bond Position:  [17.9047134]


portfolio before change:  [22.82649544]
curr_Stock_Price:  100.43304635426678
curr_Factors:  [100.43304635]
mat_Sqrt:  [[0.15]]
grads:  [0.16598794]
Stock Position:  0.1659879395619508
Bond Position:  [6.15582101]


portfolio before change:  [22.79238077]
curr_Stock_Price:  100.22520341735854
curr_Factors:  [100.22520342]
mat_Sqrt:  [[0.15]]
grads:  [0.03676422]
Stock Position:  0.03676421947706655
Bond Position:  [19.10767939]


portfolio before change:  [22.78860911]
curr_Stock_Price:  100.09012852649141
curr_Factors:  [100.09012853]
mat_Sqrt:  [[0.15]]
grads:  [0.04935012]
Stock Position:  0.04935011572727469
Bond Position:  [17.84914969]


portfolio before change:  [22.79556219]
curr_Stock_Price:  100.208415348219
curr_Factors:  [100.20841535]
mat_Sqrt:  [[0.15]]
grads:  [-0.00968019]
Stock Position:  -0.009680193745395117
Bond Position:  [23.76559906]


portfolio before change:  [22.80470441]
curr_Stock_Price:  99.41743611593216
curr_Factors:  [99.41743612]
mat_Sqrt:  [[0.15]]
grads:  [0.01866395]
Stock Position:  0.018663952047900653
Bond Position:  [20.94918215]


portfolio before change:  [22.79114046]
curr_Stock_Price:  98.62053510272322
curr_Factors:  [98.6205351]
mat_Sqrt:  [[0.15]]
grads:  [0.1483072]
Stock Position:  0.14830719846845888
Bond Position:  [8.16500518]


portfolio before change:  [22.63481323]
curr_Stock_Price:  97.56301695395695
curr_Factors:  [97.56301695]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [20.27673963]


portfolio before change:  [22.6364097]
curr_Stock_Price:  97.57663439350446
curr_Factors:  [97.57663439]
mat_Sqrt:  [[0.15]]
grads:  [-0.10426011]
Stock Position:  -0.10426011250181208
Bond Position:  [32.80976058]


portfolio before change:  [22.57695792]
curr_Stock_Price:  98.16652872890354
curr_Factors:  [98.16652873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03948837]
Stock Position:  -0.039488366841425135
Bond Position:  [26.45339382]


portfolio before change:  [22.59047565]
curr_Stock_Price:  97.86607732774696
curr_Factors:  [97.86607733]
mat_Sqrt:  [[0.15]]
grads:  [0.00786766]
Stock Position:  0.007867658467949352
Bond Position:  [21.82049877]


portfolio before change:  [22.59684366]
curr_Stock_Price:  98.50212277964823
curr_Factors:  [98.50212278]
mat_Sqrt:  [[0.15]]
grads:  [0.03762872]
Stock Position:  0.03762872042520364
Bond Position:  [18.89033482]


portfolio before change:  [22.57625036]
curr_Stock_Price:  97.92346949824115
curr_Factors:  [97.9234695]
mat_Sqrt:  [[0.15]]
grads:  [0.00202062]
Stock Position:  0.0020206164775088756
Bond Position:  [22.37838458]


portfolio before change:  [22.57864168]
curr_Stock_Price:  98.41472041448073
curr_Factors:  [98.41472041]
mat_Sqrt:  [[0.15]]
grads:  [-0.00970904]
Stock Position:  -0.009709039784751376
Bond Position:  [23.53415412]


portfolio before change:  [22.5784215]
curr_Stock_Price:  98.58889964191793
curr_Factors:  [98.58889964]
mat_Sqrt:  [[0.15]]
grads:  [0.00286802]
Stock Position:  0.0028680189838955115
Bond Position:  [22.29566666]


portfolio before change:  [22.57901422]
curr_Stock_Price:  98.3096811033416
curr_Factors:  [98.3096811]
mat_Sqrt:  [[0.15]]
grads:  [-0.15772845]
Stock Position:  -0.1577284488245966
Bond Position:  [38.08524772]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.52552457]
Stock Price:  98.66389777265252
PL:  [22.52552457]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38074198e-02]
 [ 2.82216504e-03]
 [ 2.18400194e-02]
 [-6.04926353e-03]
 [ 1.51662803e-02]
 [-3.60366681e-03]
 [ 2.38040119e-03]
 [ 9.36735742e-04]
 [-5.62966195e-03]
 [-3.21316109e-03]
 [ 1.27995590e-02]
 [-6.36535986e-03]
 [ 5.64800992e-04]
 [-3.50972235e-03]
 [-3.07002421e-03]
 [ 6.05127350e-03]
 [-2.13338251e-02]
 [-1.39849164e-02]
 [ 1.99547393e-02]
 [ 2.03842138e-03]
 [-3.84807719e-03]
 [ 5.33385954e-03]
 [ 6.18169500e-03]
 [ 4.08457425e-02]
 [ 3.38241716e-03]
 [ 7.48789185e-03]
 [ 2.61517657e-02]
 [ 2.57064788e-02]
 [ 8.81036034e-03]
 [-8.13781808e-03]
 [-1.67058508e-03]
 [ 8.78385547e-03]
 [ 1.25828366e-02]
 [ 9.48840936e-03]
 [ 6.02461517e-03]
 [ 1.15109374e-02]
 [-1.65568143e-02]
 [ 3.52442078e-03]
 [-5.69574616e-02]
 [-1.44849090e-02]
 [ 7.19852918e-03]
 [-1.97512433e-03]
 [-2.46293041e-03]
 [-4.79143849e-03]
 [ 1.90295270e-02]
 [ 1.49881899e-02]
 [ 1.07895743e-02]
 [ 4.48071247e-03]
 [ 5.78340583e-03]
 [-2.27209893e-03]
 [-3.02168991e-03]
 [-1.69004763e-02]
 [ 1.42311934e-03]
 [ 1.39814313e-03]
 [-3.48700664e-03]
 [-3.45472752e-03]
 [ 1.02953747e-02]
 [-6.39886285e-03]
 [ 6.94354894e-03]
 [-4.01532656e-03]
 [-1.58021321e-03]
 [ 7.72688646e-03]
 [-8.58421026e-03]
 [ 7.42843479e-03]
 [ 2.23991810e-02]
 [ 5.44626659e-03]
 [ 7.65675670e-03]
 [-3.15164697e-04]
 [ 2.80493869e-03]
 [ 2.18512271e-02]
 [ 3.74282683e-04]
 [-1.59378264e-02]
 [-6.28980689e-04]
 [ 1.29439128e-03]
 [ 3.00067822e-05]
 [-4.47071615e-03]
 [-1.43936553e-03]
 [-3.31197341e-03]
 [-2.28887020e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.84051057]
curr_Stock_Price:  99.86963131065299
curr_Factors:  [99.86963131]
mat_Sqrt:  [[0.15]]
grads:  [-0.09204947]
Stock Position:  -0.09204946565368119
Bond Position:  [8.35243563]


portfolio before change:  [-0.8231712]
curr_Stock_Price:  99.6869325960148
curr_Factors:  [99.6869326]
mat_Sqrt:  [[0.15]]
grads:  [0.01881443]
Stock Position:  0.018814433599744752
Bond Position:  [-2.69872438]


portfolio before change:  [-0.80589981]
curr_Stock_Price:  100.61388404615387
curr_Factors:  [100.61388405]
mat_Sqrt:  [[0.15]]
grads:  [0.14560013]
Stock Position:  0.14560012951768342
Bond Position:  [-15.45529436]


portfolio before change:  [-0.87480817]
curr_Stock_Price:  100.14724728270684
curr_Factors:  [100.14724728]
mat_Sqrt:  [[0.15]]
grads:  [-0.04032842]
Stock Position:  -0.040328423517854574
Bond Position:  [3.16397243]


portfolio before change:  [-0.85404018]
curr_Stock_Price:  99.63717930927176
curr_Factors:  [99.63717931]
mat_Sqrt:  [[0.15]]
grads:  [0.10110854]
Stock Position:  0.10110853521907373
Bond Position:  [-10.92820943]


portfolio before change:  [-0.78457139]
curr_Stock_Price:  100.33100627106539
curr_Factors:  [100.33100627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02402445]
Stock Position:  -0.024024445376217805
Bond Position:  [1.62582539]


portfolio before change:  [-0.77317278]
curr_Stock_Price:  99.86077709011894
curr_Factors:  [99.86077709]
mat_Sqrt:  [[0.15]]
grads:  [0.01586934]
Stock Position:  0.015869341250502787
Bond Position:  [-2.35789752]


portfolio before change:  [-0.78139831]
curr_Stock_Price:  99.35173524390957
curr_Factors:  [99.35173524]
mat_Sqrt:  [[0.15]]
grads:  [0.0062449]
Stock Position:  0.006244904946781811
Bond Position:  [-1.40184045]


portfolio before change:  [-0.77732052]
curr_Stock_Price:  100.01874449363468
curr_Factors:  [100.01874449]
mat_Sqrt:  [[0.15]]
grads:  [-0.03753108]
Stock Position:  -0.03753107969786319
Bond Position:  [2.97649095]


portfolio before change:  [-0.77255795]
curr_Stock_Price:  99.89680479061481
curr_Factors:  [99.89680479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02142107]
Stock Position:  -0.02142107391388797
Bond Position:  [1.36733889]


portfolio before change:  [-0.75470075]
curr_Stock_Price:  99.06716667945805
curr_Factors:  [99.06716668]
mat_Sqrt:  [[0.15]]
grads:  [0.08533039]
Stock Position:  0.08533039353382356
Bond Position:  [-9.20814107]


portfolio before change:  [-0.73409787]
curr_Stock_Price:  99.31535964910273
curr_Factors:  [99.31535965]
mat_Sqrt:  [[0.15]]
grads:  [-0.04243573]
Stock Position:  -0.04243573243129804
Bond Position:  [3.48042216]


portfolio before change:  [-0.70595984]
curr_Stock_Price:  98.65741184237689
curr_Factors:  [98.65741184]
mat_Sqrt:  [[0.15]]
grads:  [0.00376534]
Stock Position:  0.003765339943514375
Bond Position:  [-1.07743854]


portfolio before change:  [-0.70843802]
curr_Stock_Price:  98.01714288387983
curr_Factors:  [98.01714288]
mat_Sqrt:  [[0.15]]
grads:  [-0.02339815]
Stock Position:  -0.023398149006726755
Bond Position:  [1.5849817]


portfolio before change:  [-0.71784928]
curr_Stock_Price:  98.42359955189691
curr_Factors:  [98.42359955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02046683]
Stock Position:  -0.020466828055046803
Bond Position:  [1.2965696]


portfolio before change:  [-0.71477051]
curr_Stock_Price:  98.27713129334585
curr_Factors:  [98.27713129]
mat_Sqrt:  [[0.15]]
grads:  [0.04034182]
Stock Position:  0.04034182331020836
Bond Position:  [-4.67944917]


portfolio before change:  [-0.73429528]
curr_Stock_Price:  97.80039788308466
curr_Factors:  [97.80039788]
mat_Sqrt:  [[0.15]]
grads:  [-0.1422255]
Stock Position:  -0.14222550088732158
Bond Position:  [13.1754153]


portfolio before change:  [-0.87873456]
curr_Stock_Price:  98.82175319137882
curr_Factors:  [98.82175319]
mat_Sqrt:  [[0.15]]
grads:  [-0.09323278]
Stock Position:  -0.09323277571616306
Bond Position:  [8.33469179]


portfolio before change:  [-0.98904305]
curr_Stock_Price:  100.01049211819661
curr_Factors:  [100.01049212]
mat_Sqrt:  [[0.15]]
grads:  [0.1330316]
Stock Position:  0.1330315952818582
Bond Position:  [-14.29359836]


portfolio before change:  [-0.88712919]
curr_Stock_Price:  100.78329531783395
curr_Factors:  [100.78329532]
mat_Sqrt:  [[0.15]]
grads:  [0.01358948]
Stock Position:  0.013589475871701139
Bond Position:  [-2.25672135]


portfolio before change:  [-0.88179217]
curr_Stock_Price:  101.18640594990843
curr_Factors:  [101.18640595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565385]
Stock Position:  -0.02565384791505437
Bond Position:  [1.7140285]


portfolio before change:  [-0.91067182]
curr_Stock_Price:  102.31632512224067
curr_Factors:  [102.31632512]
mat_Sqrt:  [[0.15]]
grads:  [0.03555906]
Stock Position:  0.03555906361356273
Bond Position:  [-4.54894453]


portfolio before change:  [-0.89548366]
curr_Stock_Price:  102.75144549034634
curr_Factors:  [102.75144549]
mat_Sqrt:  [[0.15]]
grads:  [0.0412113]
Stock Position:  0.041211300021728785
Bond Position:  [-5.13000431]


portfolio before change:  [-0.88330753]
curr_Stock_Price:  103.05468186085682
curr_Factors:  [103.05468186]
mat_Sqrt:  [[0.15]]
grads:  [0.27230495]
Stock Position:  0.2723049501845617
Bond Position:  [-28.94560754]


portfolio before change:  [-0.82469459]
curr_Stock_Price:  103.27657317519795
curr_Factors:  [103.27657318]
mat_Sqrt:  [[0.15]]
grads:  [0.02254945]
Stock Position:  0.022549447728320907
Bond Position:  [-3.15352428]


portfolio before change:  [-0.82066888]
curr_Stock_Price:  103.46384197486674
curr_Factors:  [103.46384197]
mat_Sqrt:  [[0.15]]
grads:  [0.04991928]
Stock Position:  0.04991927897180756
Bond Position:  [-5.98550927]


portfolio before change:  [-0.84036154]
curr_Stock_Price:  103.076846069375
curr_Factors:  [103.07684607]
mat_Sqrt:  [[0.15]]
grads:  [0.1743451]
Stock Position:  0.17434510476998633
Bond Position:  [-18.81130507]


portfolio before change:  [-0.72496842]
curr_Stock_Price:  103.74545597876721
curr_Factors:  [103.74545598]
mat_Sqrt:  [[0.15]]
grads:  [0.17137653]
Stock Position:  0.17137652533327732
Bond Position:  [-18.50450419]


portfolio before change:  [-0.67545216]
curr_Stock_Price:  104.04113728372886
curr_Factors:  [104.04113728]
mat_Sqrt:  [[0.15]]
grads:  [0.05873574]
Stock Position:  0.05873573559956477
Bond Position:  [-6.78638489]


portfolio before change:  [-0.69383567]
curr_Stock_Price:  103.73537191022373
curr_Factors:  [103.73537191]
mat_Sqrt:  [[0.15]]
grads:  [-0.05425212]
Stock Position:  -0.05425212053700036
Bond Position:  [4.93402823]


portfolio before change:  [-0.61580177]
curr_Stock_Price:  102.30269960622931
curr_Factors:  [102.30269961]
mat_Sqrt:  [[0.15]]
grads:  [-0.01113723]
Stock Position:  -0.011137233894973678
Bond Position:  [0.52356732]


portfolio before change:  [-0.59726398]
curr_Stock_Price:  100.64114989887717
curr_Factors:  [100.6411499]
mat_Sqrt:  [[0.15]]
grads:  [0.05855904]
Stock Position:  0.0585590364779775
Bond Position:  [-6.49071275]


portfolio before change:  [-0.57618052]
curr_Stock_Price:  101.00811531842187
curr_Factors:  [101.00811532]
mat_Sqrt:  [[0.15]]
grads:  [0.08388558]
Stock Position:  0.08388557705894104
Bond Position:  [-9.04930457]


portfolio before change:  [-0.58889278]
curr_Stock_Price:  100.86331507189723
curr_Factors:  [100.86331507]
mat_Sqrt:  [[0.15]]
grads:  [0.06325606]
Stock Position:  0.06325606237138386
Bond Position:  [-6.96910892]


portfolio before change:  [-0.62323293]
curr_Stock_Price:  100.32732586182885
curr_Factors:  [100.32732586]
mat_Sqrt:  [[0.15]]
grads:  [0.0401641]
Stock Position:  0.040164101147277094
Bond Position:  [-4.65278979]


portfolio before change:  [-0.61122189]
curr_Stock_Price:  100.63361538241487
curr_Factors:  [100.63361538]
mat_Sqrt:  [[0.15]]
grads:  [0.07673958]
Stock Position:  0.07673958247562492
Bond Position:  [-8.33380352]


portfolio before change:  [-0.65793089]
curr_Stock_Price:  100.03173408273207
curr_Factors:  [100.03173408]
mat_Sqrt:  [[0.15]]
grads:  [-0.11037876]
Stock Position:  -0.11037876170454812
Bond Position:  [10.38344805]


portfolio before change:  [-0.64689616]
curr_Stock_Price:  99.93764218277511
curr_Factors:  [99.93764218]
mat_Sqrt:  [[0.15]]
grads:  [0.02349614]
Stock Position:  0.02349613856258427
Bond Position:  [-2.99504484]


portfolio before change:  [-0.64335304]
curr_Stock_Price:  100.09640515199804
curr_Factors:  [100.09640515]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971641]
Stock Position:  -0.37971641059327654
Bond Position:  [37.36489464]


portfolio before change:  [-0.23315391]
curr_Stock_Price:  99.02227789242366
curr_Factors:  [99.02227789]
mat_Sqrt:  [[0.15]]
grads:  [-0.09656606]
Stock Position:  -0.09656606022454828
Bond Position:  [9.32903734]


portfolio before change:  [-0.288532]
curr_Stock_Price:  99.60178967673315
curr_Factors:  [99.60178968]
mat_Sqrt:  [[0.15]]
grads:  [0.04799019]
Stock Position:  0.047990194541407315
Bond Position:  [-5.06844126]


portfolio before change:  [-0.26620605]
curr_Stock_Price:  100.07360958791382
curr_Factors:  [100.07360959]
mat_Sqrt:  [[0.15]]
grads:  [-0.0131675]
Stock Position:  -0.013167495552208452
Bond Position:  [1.05151276]


portfolio before change:  [-0.27137101]
curr_Stock_Price:  100.47085130445387
curr_Factors:  [100.4708513]
mat_Sqrt:  [[0.15]]
grads:  [-0.01641954]
Stock Position:  -0.016419536096335896
Bond Position:  [1.37831376]


portfolio before change:  [-0.27770249]
curr_Stock_Price:  100.8617043922736
curr_Factors:  [100.86170439]
mat_Sqrt:  [[0.15]]
grads:  [-0.03194292]
Stock Position:  -0.031942923242586026
Bond Position:  [2.94411519]


portfolio before change:  [-0.28173893]
curr_Stock_Price:  100.99382932508212
curr_Factors:  [100.99382933]
mat_Sqrt:  [[0.15]]
grads:  [0.12686351]
Stock Position:  0.12686351344764535
Bond Position:  [-13.09417096]


portfolio before change:  [-0.35757148]
curr_Stock_Price:  100.40253141456876
curr_Factors:  [100.40253141]
mat_Sqrt:  [[0.15]]
grads:  [0.09992127]
Stock Position:  0.09992126587287875
Bond Position:  [-10.38991951]


portfolio before change:  [-0.42458169]
curr_Stock_Price:  99.73840023174175
curr_Factors:  [99.73840023]
mat_Sqrt:  [[0.15]]
grads:  [0.0719305]
Stock Position:  0.0719304955399906
Bond Position:  [-7.59881425]


portfolio before change:  [-0.43946452]
curr_Stock_Price:  99.53809733501605
curr_Factors:  [99.53809734]
mat_Sqrt:  [[0.15]]
grads:  [0.02987142]
Stock Position:  0.029871416483832465
Bond Position:  [-3.41280848]


portfolio before change:  [-0.44134143]
curr_Stock_Price:  99.48240541334002
curr_Factors:  [99.48240541]
mat_Sqrt:  [[0.15]]
grads:  [0.03855604]
Stock Position:  0.038556038872681594
Bond Position:  [-4.27698892]


portfolio before change:  [-0.43858746]
curr_Stock_Price:  99.56076633571571
curr_Factors:  [99.56076634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514733]
Stock Position:  -0.015147326185416227
Bond Position:  [1.06949194]


portfolio before change:  [-0.4425389]
curr_Stock_Price:  99.82604693590548
curr_Factors:  [99.82604694]
mat_Sqrt:  [[0.15]]
grads:  [-0.0201446]
Stock Position:  -0.02014459941376367
Bond Position:  [1.56841682]


portfolio before change:  [-0.47211968]
curr_Stock_Price:  101.29933551608593
curr_Factors:  [101.29933552]
mat_Sqrt:  [[0.15]]
grads:  [-0.11266984]
Stock Position:  -0.11266984193919939
Bond Position:  [10.94126044]


portfolio before change:  [-0.50794874]
curr_Stock_Price:  101.62340545980771
curr_Factors:  [101.62340546]
mat_Sqrt:  [[0.15]]
grads:  [0.00948746]
Stock Position:  0.009487462278364087
Bond Position:  [-1.47209697]


portfolio before change:  [-0.51227972]
curr_Stock_Price:  101.17660869056193
curr_Factors:  [101.17660869]
mat_Sqrt:  [[0.15]]
grads:  [0.00932095]
Stock Position:  0.009320954210057427
Bond Position:  [-1.45534226]


portfolio before change:  [-0.50906198]
curr_Stock_Price:  101.53158335173585
curr_Factors:  [101.53158335]
mat_Sqrt:  [[0.15]]
grads:  [-0.02324671]
Stock Position:  -0.023246710937131106
Bond Position:  [1.85121339]


portfolio before change:  [-0.50905723]
curr_Stock_Price:  101.53635612359054
curr_Factors:  [101.53635612]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303152]
Stock Position:  -0.02303151678322573
Bond Position:  [1.82947906]


portfolio before change:  [-0.50959562]
curr_Stock_Price:  101.56469709584252
curr_Factors:  [101.5646971]
mat_Sqrt:  [[0.15]]
grads:  [0.06863583]
Stock Position:  0.06863583110819636
Bond Position:  [-7.48057301]


portfolio before change:  [-0.48458311]
curr_Stock_Price:  101.93593261277167
curr_Factors:  [101.93593261]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265909]
Stock Position:  -0.04265908565667135
Bond Position:  [3.86391057]


portfolio before change:  [-0.43868056]
curr_Stock_Price:  100.86556173246312
curr_Factors:  [100.86556173]
mat_Sqrt:  [[0.15]]
grads:  [0.04629033]
Stock Position:  0.0462903262867169
Bond Position:  [-5.10778033]


portfolio before change:  [-0.45002308]
curr_Stock_Price:  100.62742832844484
curr_Factors:  [100.62742833]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676884]
Stock Position:  -0.026768843737634454
Bond Position:  [2.24365682]


portfolio before change:  [-0.46878238]
curr_Stock_Price:  101.33345541197323
curr_Factors:  [101.33345541]
mat_Sqrt:  [[0.15]]
grads:  [-0.01053475]
Stock Position:  -0.010534754766491955
Bond Position:  [0.59874073]


portfolio before change:  [-0.46991834]
curr_Stock_Price:  101.44483812085633
curr_Factors:  [101.44483812]
mat_Sqrt:  [[0.15]]
grads:  [0.05151258]
Stock Position:  0.051512576373377125
Bond Position:  [-5.69560332]


portfolio before change:  [-0.51692997]
curr_Stock_Price:  100.53912460933547
curr_Factors:  [100.53912461]
mat_Sqrt:  [[0.15]]
grads:  [-0.05722807]
Stock Position:  -0.05722806842745174
Bond Position:  [5.23672994]


portfolio before change:  [-0.48986163]
curr_Stock_Price:  100.07185338713957
curr_Factors:  [100.07185339]
mat_Sqrt:  [[0.15]]
grads:  [0.0495229]
Stock Position:  0.04952289857922372
Bond Position:  [-5.44570988]


portfolio before change:  [-0.4968164]
curr_Stock_Price:  99.93829097391311
curr_Factors:  [99.93829097]
mat_Sqrt:  [[0.15]]
grads:  [0.14932787]
Stock Position:  0.14932787314062326
Bond Position:  [-15.42038883]


portfolio before change:  [-0.5313816]
curr_Stock_Price:  99.71327338323204
curr_Factors:  [99.71327338]
mat_Sqrt:  [[0.15]]
grads:  [0.03630844]
Stock Position:  0.03630844395244329
Bond Position:  [-4.1518154]


portfolio before change:  [-0.52864208]
curr_Stock_Price:  99.79587168724832
curr_Factors:  [99.79587169]
mat_Sqrt:  [[0.15]]
grads:  [0.05104504]
Stock Position:  0.051045044662340264
Bond Position:  [-5.62272681]


portfolio before change:  [-0.55090298]
curr_Stock_Price:  99.36665329695059
curr_Factors:  [99.3666533]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021011]
Stock Position:  -0.0021010979770605225
Bond Position:  [-0.34212391]


portfolio before change:  [-0.55081784]
curr_Stock_Price:  99.31595112982461
curr_Factors:  [99.31595113]
mat_Sqrt:  [[0.15]]
grads:  [0.01869959]
Stock Position:  0.01869959129193774
Bond Position:  [-2.40798553]


portfolio before change:  [-0.53918373]
curr_Stock_Price:  99.9461577675212
curr_Factors:  [99.94615777]
mat_Sqrt:  [[0.15]]
grads:  [0.14567485]
Stock Position:  0.14567484736551636
Bond Position:  [-15.09882501]


portfolio before change:  [-0.38742579]
curr_Stock_Price:  100.99439395748911
curr_Factors:  [100.99439396]
mat_Sqrt:  [[0.15]]
grads:  [0.00249522]
Stock Position:  0.0024952178892208472
Bond Position:  [-0.63942881]


portfolio before change:  [-0.38754997]
curr_Stock_Price:  100.96064479116231
curr_Factors:  [100.96064479]
mat_Sqrt:  [[0.15]]
grads:  [-0.10625218]
Stock Position:  -0.10625217630312765
Bond Position:  [10.33973826]


portfolio before change:  [-0.38048685]
curr_Stock_Price:  100.90025197478396
curr_Factors:  [100.90025197]
mat_Sqrt:  [[0.15]]
grads:  [-0.0041932]
Stock Position:  -0.004193204595605097
Bond Position:  [0.04260855]


portfolio before change:  [-0.37803472]
curr_Stock_Price:  100.31610123073547
curr_Factors:  [100.31610123]
mat_Sqrt:  [[0.15]]
grads:  [0.00862928]
Stock Position:  0.00862927517523669
Bond Position:  [-1.24368996]


portfolio before change:  [-0.38041805]
curr_Stock_Price:  100.04891876494922
curr_Factors:  [100.04891876]
mat_Sqrt:  [[0.15]]
grads:  [0.00020005]
Stock Position:  0.00020004521450599685
Bond Position:  [-0.40043235]


portfolio before change:  [-0.38045403]
curr_Stock_Price:  99.99412440296801
curr_Factors:  [99.9941244]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980477]
Stock Position:  -0.029804774301360182
Bond Position:  [2.59984827]


portfolio before change:  [-0.33970644]
curr_Stock_Price:  98.63242651469153
curr_Factors:  [98.63242651]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959577]
Stock Position:  -0.009595770171224368
Bond Position:  [0.60674766]


portfolio before change:  [-0.33324466]
curr_Stock_Price:  97.96297979283091
curr_Factors:  [97.96297979]
mat_Sqrt:  [[0.15]]
grads:  [-0.02207982]
Stock Position:  -0.02207982276030472
Bond Position:  [1.82976057]


portfolio before change:  [-0.31847286]
curr_Stock_Price:  97.29914100825711
curr_Factors:  [97.29914101]
mat_Sqrt:  [[0.15]]
grads:  [-0.15259135]
Stock Position:  -0.15259134688943457
Bond Position:  [14.52853412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.35455998]
Stock Price:  97.54158714160071
PL:  [-0.35455998]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39323464e-02]
 [-1.88376688e-02]
 [ 4.30663725e-02]
 [-1.20977471e-02]
 [ 1.10103091e-02]
 [-1.38222674e-02]
 [-1.35526263e-02]
 [ 5.34403854e-03]
 [-1.40906908e-02]
 [-1.25325118e-02]
 [ 1.18783047e-02]
 [-7.12502054e-03]
 [ 7.00671236e-04]
 [-6.03612397e-03]
 [ 2.88884561e-03]
 [ 1.23487905e-04]
 [-5.79757790e-02]
 [-6.43850889e-03]
 [ 2.18516595e-02]
 [-7.04739615e-03]
 [-3.73288128e-02]
 [ 6.49776850e-03]
 [ 1.70054566e-02]
 [ 4.25068117e-03]
 [ 1.61759937e-02]
 [ 4.48248642e-03]
 [ 4.52609945e-05]
 [ 2.59133609e-02]
 [-3.30957714e-02]
 [ 9.59072879e-02]
 [-5.71583863e-03]
 [ 3.56417099e-02]
 [ 1.48588338e-02]
 [-1.89426780e-02]
 [-1.95140143e-02]
 [-8.40423794e-02]
 [ 1.51231444e-02]
 [-7.12864386e-03]
 [ 5.87097711e-02]
 [ 2.12619177e-02]
 [ 6.56931161e-03]
 [ 3.58763857e-02]
 [-3.37317114e-03]
 [ 2.04893527e-02]
 [-6.29313675e-02]
 [ 2.47889082e-02]
 [ 8.71031528e-03]
 [ 5.40656829e-03]
 [-1.37274127e-02]
 [ 9.01841313e-05]
 [-2.39793538e-03]
 [-3.20691701e-03]
 [-8.94734228e-04]
 [ 5.03460783e-03]
 [-1.56447680e-02]
 [-5.40545038e-03]
 [-2.93840069e-03]
 [ 1.36444110e-02]
 [ 6.99862773e-03]
 [-2.68658067e-03]
 [-5.13033437e-03]
 [-3.14314671e-03]
 [-1.22786837e-03]
 [-4.11809815e-03]
 [ 1.84919066e-02]
 [ 5.73472306e-03]
 [ 1.83071265e-02]
 [-3.52681352e-03]
 [ 7.07667929e-03]
 [ 2.72541901e-02]
 [ 3.12088874e-03]
 [-1.52402465e-02]
 [-5.76546335e-03]
 [ 2.82273711e-03]
 [ 1.19111722e-02]
 [ 7.54223048e-03]
 [ 3.18100469e-04]
 [-2.47862386e-02]
 [-3.23704432e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.2777408]
curr_Stock_Price:  99.71351935723011
curr_Factors:  [99.71351936]
mat_Sqrt:  [[0.15]]
grads:  [-0.09288231]
Stock Position:  -0.09288230910769797
Bond Position:  [4.98388112]


portfolio before change:  [-4.2104726]
curr_Stock_Price:  98.99264260706457
curr_Factors:  [98.99264261]
mat_Sqrt:  [[0.15]]
grads:  [-0.12558446]
Stock Position:  -0.1255844588222102
Bond Position:  [8.22146485]


portfolio before change:  [-4.16532992]
curr_Stock_Price:  98.63727355131505
curr_Factors:  [98.63727355]
mat_Sqrt:  [[0.15]]
grads:  [0.28710915]
Stock Position:  0.2871091502396715
Bond Position:  [-32.48499371]


portfolio before change:  [-4.21654548]
curr_Stock_Price:  98.46596175320022
curr_Factors:  [98.46596175]
mat_Sqrt:  [[0.15]]
grads:  [-0.08065165]
Stock Position:  -0.08065164760590754
Bond Position:  [3.72489657]


portfolio before change:  [-4.19150257]
curr_Stock_Price:  98.15834139356298
curr_Factors:  [98.15834139]
mat_Sqrt:  [[0.15]]
grads:  [0.07340206]
Stock Position:  0.07340206047365652
Bond Position:  [-11.39652708]


portfolio before change:  [-4.14035491]
curr_Stock_Price:  98.86486069628397
curr_Factors:  [98.8648607]
mat_Sqrt:  [[0.15]]
grads:  [-0.09214845]
Stock Position:  -0.09214844934048862
Bond Position:  [4.9698887]


portfolio before change:  [-4.06259155]
curr_Stock_Price:  98.02433948305342
curr_Factors:  [98.02433948]
mat_Sqrt:  [[0.15]]
grads:  [-0.09035084]
Stock Position:  -0.090350842288175
Bond Position:  [4.79399009]


portfolio before change:  [-4.17074273]
curr_Stock_Price:  99.2246692863574
curr_Factors:  [99.22466929]
mat_Sqrt:  [[0.15]]
grads:  [0.03562692]
Stock Position:  0.03562692361966928
Bond Position:  [-7.70581244]


portfolio before change:  [-4.16854131]
curr_Stock_Price:  99.29997866619713
curr_Factors:  [99.29997867]
mat_Sqrt:  [[0.15]]
grads:  [-0.09393794]
Stock Position:  -0.09393793860212765
Bond Position:  [5.15949399]


portfolio before change:  [-4.12820643]
curr_Stock_Price:  98.87403358460168
curr_Factors:  [98.87403358]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355008]
Stock Position:  -0.08355007859035225
Bond Position:  [4.13272684]


portfolio before change:  [-4.1227287]
curr_Stock_Price:  98.81156291560382
curr_Factors:  [98.81156292]
mat_Sqrt:  [[0.15]]
grads:  [0.0791887]
Stock Position:  0.07918869801172086
Bond Position:  [-11.94748772]


portfolio before change:  [-4.15257226]
curr_Stock_Price:  98.44412638559281
curr_Factors:  [98.44412639]
mat_Sqrt:  [[0.15]]
grads:  [-0.04750014]
Stock Position:  -0.04750013696343859
Bond Position:  [0.52353723]


portfolio before change:  [-4.16122944]
curr_Stock_Price:  98.6270712090077
curr_Factors:  [98.62707121]
mat_Sqrt:  [[0.15]]
grads:  [0.00467114]
Stock Position:  0.0046711415718860005
Bond Position:  [-4.62193046]


portfolio before change:  [-4.16763029]
curr_Stock_Price:  97.31861847872109
curr_Factors:  [97.31861848]
mat_Sqrt:  [[0.15]]
grads:  [-0.04024083]
Stock Position:  -0.04024082643868146
Bond Position:  [-0.25144866]


portfolio before change:  [-4.16338335]
curr_Stock_Price:  97.2126898327998
curr_Factors:  [97.21268983]
mat_Sqrt:  [[0.15]]
grads:  [0.01925897]
Stock Position:  0.019258970715475093
Bond Position:  [-6.0355997]


portfolio before change:  [-4.18011048]
curr_Stock_Price:  96.36374052387944
curr_Factors:  [96.36374052]
mat_Sqrt:  [[0.15]]
grads:  [0.00082325]
Stock Position:  0.0008232526971144993
Bond Position:  [-4.25944219]


portfolio before change:  [-4.1812172]
curr_Stock_Price:  95.34278962858328
curr_Factors:  [95.34278963]
mat_Sqrt:  [[0.15]]
grads:  [-0.38650519]
Stock Position:  -0.38650519316498216
Bond Position:  [32.66926612]


portfolio before change:  [-3.92633401]
curr_Stock_Price:  94.68861653058171
curr_Factors:  [94.68861653]
mat_Sqrt:  [[0.15]]
grads:  [-0.04292339]
Stock Position:  -0.04292339262246268
Bond Position:  [0.13802266]


portfolio before change:  [-3.9463792]
curr_Stock_Price:  95.15581663649749
curr_Factors:  [95.15581664]
mat_Sqrt:  [[0.15]]
grads:  [0.14567773]
Stock Position:  0.14567772993328412
Bond Position:  [-17.80846255]


portfolio before change:  [-4.01441296]
curr_Stock_Price:  94.69644168721983
curr_Factors:  [94.69644169]
mat_Sqrt:  [[0.15]]
grads:  [-0.04698264]
Stock Position:  -0.046982641027243685
Bond Position:  [0.43467597]


portfolio before change:  [-4.00991275]
curr_Stock_Price:  94.60123547686189
curr_Factors:  [94.60123548]
mat_Sqrt:  [[0.15]]
grads:  [-0.24885875]
Stock Position:  -0.24885875215395195
Bond Position:  [19.53243266]


portfolio before change:  [-4.01081011]
curr_Stock_Price:  94.60974700599316
curr_Factors:  [94.60974701]
mat_Sqrt:  [[0.15]]
grads:  [0.04331846]
Stock Position:  0.04331845668407253
Bond Position:  [-8.10915833]


portfolio before change:  [-4.00796642]
curr_Stock_Price:  94.6870933705888
curr_Factors:  [94.68709337]
mat_Sqrt:  [[0.15]]
grads:  [0.11336971]
Stock Position:  0.11336971086758917
Bond Position:  [-14.74261482]


portfolio before change:  [-3.97133524]
curr_Stock_Price:  95.01833368039622
curr_Factors:  [95.01833368]
mat_Sqrt:  [[0.15]]
grads:  [0.02833787]
Stock Position:  0.028337874495467076
Bond Position:  [-6.66395286]


portfolio before change:  [-3.96362246]
curr_Stock_Price:  95.30520389618447
curr_Factors:  [95.3052039]
mat_Sqrt:  [[0.15]]
grads:  [0.10783996]
Stock Position:  0.1078399582753756
Bond Position:  [-14.24133167]


portfolio before change:  [-3.92312064]
curr_Stock_Price:  95.68903127185806
curr_Factors:  [95.68903127]
mat_Sqrt:  [[0.15]]
grads:  [0.02988324]
Stock Position:  0.029883242805544115
Bond Position:  [-6.7826192]


portfolio before change:  [-3.93788496]
curr_Stock_Price:  95.20915053237474
curr_Factors:  [95.20915053]
mat_Sqrt:  [[0.15]]
grads:  [0.00030174]
Stock Position:  0.00030173996355024185
Bond Position:  [-3.96661337]


portfolio before change:  [-3.93839936]
curr_Stock_Price:  94.32602253812834
curr_Factors:  [94.32602254]
mat_Sqrt:  [[0.15]]
grads:  [0.17275574]
Stock Position:  0.17275573919765183
Bond Position:  [-20.23376111]


portfolio before change:  [-3.99491914]
curr_Stock_Price:  94.00617712208995
curr_Factors:  [94.00617712]
mat_Sqrt:  [[0.15]]
grads:  [-0.22063848]
Stock Position:  -0.22063847601292233
Bond Position:  [16.74646052]


portfolio before change:  [-4.09774486]
curr_Stock_Price:  94.47695815482736
curr_Factors:  [94.47695815]
mat_Sqrt:  [[0.15]]
grads:  [0.63938192]
Stock Position:  0.6393819192272282
Bond Position:  [-64.50460369]


portfolio before change:  [-4.24990534]
curr_Stock_Price:  94.24528314157597
curr_Factors:  [94.24528314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03810559]
Stock Position:  -0.03810559088344609
Bond Position:  [-0.65863314]


portfolio before change:  [-4.22511181]
curr_Stock_Price:  93.5935494228596
curr_Factors:  [93.59354942]
mat_Sqrt:  [[0.15]]
grads:  [0.2376114]
Stock Position:  0.23761139945668147
Bond Position:  [-26.46400607]


portfolio before change:  [-4.22243854]
curr_Stock_Price:  93.61176116523237
curr_Factors:  [93.61176117]
mat_Sqrt:  [[0.15]]
grads:  [0.09905889]
Stock Position:  0.09905889208337701
Bond Position:  [-13.49551589]


portfolio before change:  [-4.19008177]
curr_Stock_Price:  93.94691800731842
curr_Factors:  [93.94691801]
mat_Sqrt:  [[0.15]]
grads:  [-0.12628452]
Stock Position:  -0.12628451999891444
Bond Position:  [7.67395967]


portfolio before change:  [-4.24886432]
curr_Stock_Price:  94.41619311381773
curr_Factors:  [94.41619311]
mat_Sqrt:  [[0.15]]
grads:  [-0.13009343]
Stock Position:  -0.13009342863309123
Bond Position:  [8.03406196]


portfolio before change:  [-4.19173189]
curr_Stock_Price:  93.98088842011595
curr_Factors:  [93.98088842]
mat_Sqrt:  [[0.15]]
grads:  [-0.56028253]
Stock Position:  -0.5602825295424878
Bond Position:  [48.464118]


portfolio before change:  [-4.73485103]
curr_Stock_Price:  94.955661349615
curr_Factors:  [94.95566135]
mat_Sqrt:  [[0.15]]
grads:  [0.10082096]
Stock Position:  0.10082096278802284
Bond Position:  [-14.30837223]


portfolio before change:  [-4.77271167]
curr_Stock_Price:  94.58900805138359
curr_Factors:  [94.58900805]
mat_Sqrt:  [[0.15]]
grads:  [-0.04752429]
Stock Position:  -0.04752429237017067
Bond Position:  [-0.277436]


portfolio before change:  [-4.77310305]
curr_Stock_Price:  94.5968785681746
curr_Factors:  [94.59687857]
mat_Sqrt:  [[0.15]]
grads:  [0.39139847]
Stock Position:  0.39139847395357785
Bond Position:  [-41.79817697]


portfolio before change:  [-4.70233788]
curr_Stock_Price:  94.78435412158476
curr_Factors:  [94.78435412]
mat_Sqrt:  [[0.15]]
grads:  [0.14174612]
Stock Position:  0.14174611825712147
Bond Position:  [-18.13765214]


portfolio before change:  [-4.66297908]
curr_Stock_Price:  95.07002288668015
curr_Factors:  [95.07002289]
mat_Sqrt:  [[0.15]]
grads:  [0.04379541]
Stock Position:  0.0437954107021975
Bond Position:  [-8.82660977]


portfolio before change:  [-4.63619017]
curr_Stock_Price:  95.69430250644437
curr_Factors:  [95.69430251]
mat_Sqrt:  [[0.15]]
grads:  [0.2391759]
Stock Position:  0.23917590484547388
Bond Position:  [-27.52396157]


portfolio before change:  [-4.69908053]
curr_Stock_Price:  95.43854910566806
curr_Factors:  [95.43854911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248781]
Stock Position:  -0.022487807566965494
Bond Position:  [-2.5528768]


portfolio before change:  [-4.6971595]
curr_Stock_Price:  95.34602828493931
curr_Factors:  [95.34602828]
mat_Sqrt:  [[0.15]]
grads:  [0.13659568]
Stock Position:  0.13659568439239847
Bond Position:  [-17.72101548]


portfolio before change:  [-4.76328811]
curr_Stock_Price:  94.87001752288732
curr_Factors:  [94.87001752]
mat_Sqrt:  [[0.15]]
grads:  [-0.41954245]
Stock Position:  -0.4195424501197028
Bond Position:  [35.03871148]


portfolio before change:  [-4.67979558]
curr_Stock_Price:  94.67622891756903
curr_Factors:  [94.67622892]
mat_Sqrt:  [[0.15]]
grads:  [0.16525939]
Stock Position:  0.16525938776830235
Bond Position:  [-20.3259312]


portfolio before change:  [-4.73714596]
curr_Stock_Price:  94.33688377600706
curr_Factors:  [94.33688378]
mat_Sqrt:  [[0.15]]
grads:  [0.05806877]
Stock Position:  0.05806876855033553
Bond Position:  [-10.21517263]


portfolio before change:  [-4.71543656]
curr_Stock_Price:  94.72173541111714
curr_Factors:  [94.72173541]
mat_Sqrt:  [[0.15]]
grads:  [0.03604379]
Stock Position:  0.03604378858360701
Bond Position:  [-8.12956677]


portfolio before change:  [-4.72713841]
curr_Stock_Price:  94.4111760913308
curr_Factors:  [94.41117609]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151608]
Stock Position:  -0.09151608471594676
Bond Position:  [3.91300278]


portfolio before change:  [-4.80209924]
curr_Stock_Price:  95.23294856299158
curr_Factors:  [95.23294856]
mat_Sqrt:  [[0.15]]
grads:  [0.00060123]
Stock Position:  0.0006012275420905927
Bond Position:  [-4.85935591]


portfolio before change:  [-4.8021848]
curr_Stock_Price:  95.59581105982517
curr_Factors:  [95.59581106]
mat_Sqrt:  [[0.15]]
grads:  [-0.01598624]
Stock Position:  -0.015986235842173718
Bond Position:  [-3.27396762]


portfolio before change:  [-4.79586484]
curr_Stock_Price:  95.18767328792588
curr_Factors:  [95.18767329]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137945]
Stock Position:  -0.02137944673458748
Bond Position:  [-2.76080505]


portfolio before change:  [-4.7883712]
curr_Stock_Price:  94.82909559391058
curr_Factors:  [94.82909559]
mat_Sqrt:  [[0.15]]
grads:  [-0.00596489]
Stock Position:  -0.005964894852030773
Bond Position:  [-4.22272562]


portfolio before change:  [-4.7889998]
curr_Stock_Price:  94.8902316400561
curr_Factors:  [94.89023164]
mat_Sqrt:  [[0.15]]
grads:  [0.03356405]
Stock Position:  0.033564052184148256
Bond Position:  [-7.97390049]


portfolio before change:  [-4.79023568]
curr_Stock_Price:  94.86825894199771
curr_Factors:  [94.86825894]
mat_Sqrt:  [[0.15]]
grads:  [-0.10429845]
Stock Position:  -0.10429845358672386
Bond Position:  [5.10437702]


portfolio before change:  [-4.74938403]
curr_Stock_Price:  94.47963752102328
curr_Factors:  [94.47963752]
mat_Sqrt:  [[0.15]]
grads:  [-0.03603634]
Stock Position:  -0.036036335850209725
Bond Position:  [-1.34468408]


portfolio before change:  [-4.77702193]
curr_Stock_Price:  95.24425068181834
curr_Factors:  [95.24425068]
mat_Sqrt:  [[0.15]]
grads:  [-0.01958934]
Stock Position:  -0.01958933792419989
Bond Position:  [-2.91125012]


portfolio before change:  [-4.77243207]
curr_Stock_Price:  95.00065766241086
curr_Factors:  [95.00065766]
mat_Sqrt:  [[0.15]]
grads:  [0.09096274]
Stock Position:  0.09096274030235824
Bond Position:  [-13.41395222]


portfolio before change:  [-4.69090141]
curr_Stock_Price:  95.90618287324335
curr_Factors:  [95.90618287]
mat_Sqrt:  [[0.15]]
grads:  [0.04665752]
Stock Position:  0.04665751822576079
Bond Position:  [-9.16564589]


portfolio before change:  [-4.70921257]
curr_Stock_Price:  95.52600225108196
curr_Factors:  [95.52600225]
mat_Sqrt:  [[0.15]]
grads:  [-0.01791054]
Stock Position:  -0.017910537812880364
Bond Position:  [-2.99829049]


portfolio before change:  [-4.70102969]
curr_Stock_Price:  95.05866431473552
curr_Factors:  [95.05866431]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420223]
Stock Position:  -0.03420222911363407
Bond Position:  [-1.44981148]


portfolio before change:  [-4.6881471]
curr_Stock_Price:  94.67935544282862
curr_Factors:  [94.67935544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095431]
Stock Position:  -0.020954311394482037
Bond Position:  [-2.7042064]


portfolio before change:  [-4.70275324]
curr_Stock_Price:  95.36833637873633
curr_Factors:  [95.36833638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818579]
Stock Position:  -0.008185789148074918
Bond Position:  [-3.92208815]


portfolio before change:  [-4.70454554]
curr_Stock_Price:  95.55734237726483
curr_Factors:  [95.55734238]
mat_Sqrt:  [[0.15]]
grads:  [-0.02745399]
Stock Position:  -0.027453987689516
Bond Position:  [-2.08111544]


portfolio before change:  [-4.71174181]
curr_Stock_Price:  95.81472567616845
curr_Factors:  [95.81472568]
mat_Sqrt:  [[0.15]]
grads:  [0.12327938]
Stock Position:  0.12327937725163161
Bond Position:  [-16.52372152]


portfolio before change:  [-4.69227031]
curr_Stock_Price:  95.98104920595844
curr_Factors:  [95.98104921]
mat_Sqrt:  [[0.15]]
grads:  [0.03823149]
Stock Position:  0.03823148703562561
Bond Position:  [-8.36176855]


portfolio before change:  [-4.68360847]
curr_Stock_Price:  96.22128244638103
curr_Factors:  [96.22128245]
mat_Sqrt:  [[0.15]]
grads:  [0.12204751]
Stock Position:  0.12204750989266891
Bond Position:  [-16.42717639]


portfolio before change:  [-4.78667567]
curr_Stock_Price:  95.38521070766727
curr_Factors:  [95.38521071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02351209]
Stock Position:  -0.023512090163792392
Bond Position:  [-2.54397]


portfolio before change:  [-4.78123161]
curr_Stock_Price:  95.14690479115455
curr_Factors:  [95.14690479]
mat_Sqrt:  [[0.15]]
grads:  [0.04717786]
Stock Position:  0.047177861923632894
Bond Position:  [-9.27005914]


portfolio before change:  [-4.77690532]
curr_Stock_Price:  95.25088758838335
curr_Factors:  [95.25088759]
mat_Sqrt:  [[0.15]]
grads:  [0.1816946]
Stock Position:  0.18169460043614913
Bond Position:  [-22.08347728]


portfolio before change:  [-4.76456518]
curr_Stock_Price:  95.32640107194652
curr_Factors:  [95.32640107]
mat_Sqrt:  [[0.15]]
grads:  [0.02080592]
Stock Position:  0.020805924918494523
Bond Position:  [-6.74791913]


portfolio before change:  [-4.76985816]
curr_Stock_Price:  95.09227476931854
curr_Factors:  [95.09227477]
mat_Sqrt:  [[0.15]]
grads:  [-0.10160164]
Stock Position:  -0.10160164356469274
Bond Position:  [4.89167325]


portfolio before change:  [-4.77583802]
curr_Stock_Price:  95.15413990461342
curr_Factors:  [95.1541399]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843642]
Stock Position:  -0.03843642230208204
Bond Position:  [-1.11845331]


portfolio before change:  [-4.75321939]
curr_Stock_Price:  94.56385264027433
curr_Factors:  [94.56385264]
mat_Sqrt:  [[0.15]]
grads:  [0.01881825]
Stock Position:  0.018818247375564052
Bond Position:  [-6.53274536]


portfolio before change:  [-4.76155256]
curr_Stock_Price:  94.14272631180255
curr_Factors:  [94.14272631]
mat_Sqrt:  [[0.15]]
grads:  [0.07940781]
Stock Position:  0.0794078143486446
Bond Position:  [-12.23722069]


portfolio before change:  [-4.68098701]
curr_Stock_Price:  95.16693783337045
curr_Factors:  [95.16693783]
mat_Sqrt:  [[0.15]]
grads:  [0.05028154]
Stock Position:  0.05028153650109636
Bond Position:  [-9.46612687]


portfolio before change:  [-4.6774331]
curr_Stock_Price:  95.24938482778755
curr_Factors:  [95.24938483]
mat_Sqrt:  [[0.15]]
grads:  [0.00212067]
Stock Position:  0.0021206697952617466
Bond Position:  [-4.8794256]


portfolio before change:  [-4.67944985]
curr_Stock_Price:  94.44219881560221
curr_Factors:  [94.44219882]
mat_Sqrt:  [[0.15]]
grads:  [-0.16524159]
Stock Position:  -0.16524159090260807
Bond Position:  [10.92632933]


portfolio before change:  [-4.70398178]
curr_Stock_Price:  94.59479265347012
curr_Factors:  [94.59479265]
mat_Sqrt:  [[0.15]]
grads:  [-0.21580295]
Stock Position:  -0.21580295476511593
Bond Position:  [15.70985398]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.65734938]
Stock Price:  94.38325473666241
PL:  [-4.65734938]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.03710431e-03]
 [ 2.23400087e-02]
 [ 2.62816648e-03]
 [-8.89719917e-03]
 [ 1.38405019e-02]
 [-1.35671272e-02]
 [-1.34553465e-02]
 [ 1.43909807e-02]
 [-1.63641327e-02]
 [-1.21865998e-02]
 [ 1.31644949e-02]
 [-6.45929881e-03]
 [-8.33498375e-05]
 [ 3.03513750e-03]
 [-8.80697004e-04]
 [ 1.34548818e-02]
 [ 4.67896365e-02]
 [-1.45715013e-02]
 [ 1.81743616e-02]
 [ 2.34451416e-03]
 [-4.33385112e-03]
 [ 4.75045124e-03]
 [ 8.64799773e-03]
 [ 3.90275786e-02]
 [ 4.09439928e-04]
 [ 7.40877186e-03]
 [-3.90400566e-03]
 [ 9.74529677e-03]
 [ 3.13857953e-02]
 [-2.35046425e-04]
 [-1.94243283e-03]
 [ 1.32087705e-02]
 [ 1.36748426e-02]
 [ 8.14885880e-03]
 [ 6.19582256e-03]
 [ 9.10303132e-03]
 [-2.76487319e-02]
 [ 3.21660032e-03]
 [-5.48143436e-02]
 [-6.64364697e-03]
 [ 6.80733271e-03]
 [ 6.79821626e-04]
 [-3.83961288e-03]
 [-3.50363187e-03]
 [ 2.30431322e-02]
 [ 1.53245880e-02]
 [ 1.07285490e-02]
 [ 4.70466648e-03]
 [ 5.85114691e-03]
 [-1.80669892e-03]
 [-7.12256412e-03]
 [-1.81633471e-03]
 [ 1.66005513e-03]
 [ 7.67545902e-03]
 [-7.82561089e-03]
 [-4.45678757e-03]
 [-1.87484815e-04]
 [ 1.14118841e-02]
 [ 8.25512334e-03]
 [-3.62015835e-03]
 [-5.14735159e-03]
 [-1.64210839e-03]
 [-3.09213575e-03]
 [-2.92495891e-03]
 [ 1.87429079e-02]
 [ 5.88652880e-03]
 [ 1.87979022e-02]
 [-2.04001138e-03]
 [ 4.25977113e-03]
 [ 2.29238369e-02]
 [ 3.62546230e-03]
 [-1.54774269e-02]
 [-5.78336997e-03]
 [ 1.79166788e-03]
 [ 1.00482221e-02]
 [ 2.32880636e-03]
 [-1.48611431e-03]
 [-1.31323888e-02]
 [-2.49827360e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.81592796]
curr_Stock_Price:  100.85322236825806
curr_Factors:  [100.85322237]
mat_Sqrt:  [[0.15]]
grads:  [-0.04024736]
Stock Position:  -0.04024736205518313
Bond Position:  [24.87500411]


portfolio before change:  [20.83333492]
curr_Stock_Price:  100.45935240525829
curr_Factors:  [100.45935241]
mat_Sqrt:  [[0.15]]
grads:  [0.14893339]
Stock Position:  0.14893339100090733
Bond Position:  [5.87158291]


portfolio before change:  [20.76271284]
curr_Stock_Price:  99.98270264402406
curr_Factors:  [99.98270264]
mat_Sqrt:  [[0.15]]
grads:  [0.01752111]
Stock Position:  0.01752110988717868
Bond Position:  [19.01090492]


portfolio before change:  [20.75942994]
curr_Stock_Price:  99.72751777522404
curr_Factors:  [99.72751778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05931466]
Stock Position:  -0.059314661135074095
Bond Position:  [26.67473386]


portfolio before change:  [20.77771961]
curr_Stock_Price:  99.44727593702682
curr_Factors:  [99.44727594]
mat_Sqrt:  [[0.15]]
grads:  [0.09227001]
Stock Position:  0.09227001281840104
Bond Position:  [11.60171819]


portfolio before change:  [20.74928702]
curr_Stock_Price:  99.13127162690706
curr_Factors:  [99.13127163]
mat_Sqrt:  [[0.15]]
grads:  [-0.09044751]
Stock Position:  -0.0904475146583832
Bond Position:  [29.71546416]


portfolio before change:  [20.80308894]
curr_Stock_Price:  98.55696456472272
curr_Factors:  [98.55696456]
mat_Sqrt:  [[0.15]]
grads:  [-0.08970231]
Stock Position:  -0.08970230976163596
Bond Position:  [29.6438763]


portfolio before change:  [20.76832787]
curr_Stock_Price:  98.96513541252631
curr_Factors:  [98.96513541]
mat_Sqrt:  [[0.15]]
grads:  [0.09593987]
Stock Position:  0.09593987128157878
Bond Position:  [11.27362552]


portfolio before change:  [20.7715932]
curr_Stock_Price:  98.9918261752517
curr_Factors:  [98.99182618]
mat_Sqrt:  [[0.15]]
grads:  [-0.10909422]
Stock Position:  -0.10909421802476808
Bond Position:  [31.57102907]


portfolio before change:  [20.76751274]
curr_Stock_Price:  99.04731685333114
curr_Factors:  [99.04731685]
mat_Sqrt:  [[0.15]]
grads:  [-0.081244]
Stock Position:  -0.08124399862429048
Bond Position:  [28.81451282]


portfolio before change:  [20.75961361]
curr_Stock_Price:  99.16671153584171
curr_Factors:  [99.16671154]
mat_Sqrt:  [[0.15]]
grads:  [0.0877633]
Stock Position:  0.08776329903861389
Bond Position:  [12.05641585]


portfolio before change:  [20.77171258]
curr_Stock_Price:  99.29598455195305
curr_Factors:  [99.29598455]
mat_Sqrt:  [[0.15]]
grads:  [-0.04306199]
Stock Position:  -0.04306199209104272
Bond Position:  [25.04759548]


portfolio before change:  [20.79315791]
curr_Stock_Price:  98.83432894535773
curr_Factors:  [98.83432895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00055567]
Stock Position:  -0.0005556655830243664
Bond Position:  [20.84807675]


portfolio before change:  [20.79447874]
curr_Stock_Price:  98.80232813847587
curr_Factors:  [98.80232814]
mat_Sqrt:  [[0.15]]
grads:  [0.02023425]
Stock Position:  0.02023424997900295
Bond Position:  [18.79528774]


portfolio before change:  [20.80488716]
curr_Stock_Price:  99.25866699017692
curr_Factors:  [99.25866699]
mat_Sqrt:  [[0.15]]
grads:  [-0.00587131]
Stock Position:  -0.005871313358271358
Bond Position:  [21.3876659]


portfolio before change:  [20.80097479]
curr_Stock_Price:  100.15269791167498
curr_Factors:  [100.15269791]
mat_Sqrt:  [[0.15]]
grads:  [0.08969921]
Stock Position:  0.08969921171344435
Bond Position:  [11.81735674]


portfolio before change:  [20.84786838]
curr_Stock_Price:  100.66725069589828
curr_Factors:  [100.6672507]
mat_Sqrt:  [[0.15]]
grads:  [0.31193091]
Stock Position:  0.3119309100281009
Bond Position:  [-10.55335874]


portfolio before change:  [20.89732215]
curr_Stock_Price:  100.82790606804059
curr_Factors:  [100.82790607]
mat_Sqrt:  [[0.15]]
grads:  [-0.09714334]
Stock Position:  -0.097143342021269
Bond Position:  [30.69208192]


portfolio before change:  [20.90841737]
curr_Stock_Price:  100.73343838320879
curr_Factors:  [100.73343838]
mat_Sqrt:  [[0.15]]
grads:  [0.12116241]
Stock Position:  0.12116241065174026
Bond Position:  [8.70331115]


portfolio before change:  [20.87497119]
curr_Stock_Price:  100.45290455417312
curr_Factors:  [100.45290455]
mat_Sqrt:  [[0.15]]
grads:  [0.01563009]
Stock Position:  0.015630094422252997
Bond Position:  [19.30488281]


portfolio before change:  [20.87895738]
curr_Stock_Price:  100.63074059468966
curr_Factors:  [100.63074059]
mat_Sqrt:  [[0.15]]
grads:  [-0.02889234]
Stock Position:  -0.028892340831406644
Bond Position:  [23.78641503]


portfolio before change:  [20.84947879]
curr_Stock_Price:  101.70248781930437
curr_Factors:  [101.70248782]
mat_Sqrt:  [[0.15]]
grads:  [0.03166967]
Stock Position:  0.03166967495538734
Bond Position:  [17.62859406]


portfolio before change:  [20.86933604]
curr_Stock_Price:  102.29470817966633
curr_Factors:  [102.29470818]
mat_Sqrt:  [[0.15]]
grads:  [0.05765332]
Stock Position:  0.05765331817419259
Bond Position:  [14.97170668]


portfolio before change:  [20.90453376]
curr_Stock_Price:  102.8889837297458
curr_Factors:  [102.88898373]
mat_Sqrt:  [[0.15]]
grads:  [0.26018386]
Stock Position:  0.2601838572730144
Bond Position:  [-5.8655189]


portfolio before change:  [20.72629506]
curr_Stock_Price:  102.20534372199167
curr_Factors:  [102.20534372]
mat_Sqrt:  [[0.15]]
grads:  [0.0027296]
Stock Position:  0.00272959952000233
Bond Position:  [20.4473154]


portfolio before change:  [20.72576257]
curr_Stock_Price:  101.54206449611735
curr_Factors:  [101.5420645]
mat_Sqrt:  [[0.15]]
grads:  [0.04939181]
Stock Position:  0.049391812368241285
Bond Position:  [15.71041597]


portfolio before change:  [20.72827715]
curr_Stock_Price:  101.57309503693642
curr_Factors:  [101.57309504]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260267]
Stock Position:  -0.026026704407751032
Bond Position:  [23.37189007]


portfolio before change:  [20.73619647]
curr_Stock_Price:  101.32494488818863
curr_Factors:  [101.32494489]
mat_Sqrt:  [[0.15]]
grads:  [0.06496865]
Stock Position:  0.06496864516118105
Bond Position:  [14.15325208]


portfolio before change:  [20.75718875]
curr_Stock_Price:  101.63444296390918
curr_Factors:  [101.63444296]
mat_Sqrt:  [[0.15]]
grads:  [0.20923864]
Stock Position:  0.20923863534840895
Bond Position:  [-0.5086634]


portfolio before change:  [20.72449535]
curr_Stock_Price:  101.47834555645875
curr_Factors:  [101.47834556]
mat_Sqrt:  [[0.15]]
grads:  [-0.00156698]
Stock Position:  -0.0015669761672896614
Bond Position:  [20.8835095]


portfolio before change:  [20.72466344]
curr_Stock_Price:  102.20405643518406
curr_Factors:  [102.20405644]
mat_Sqrt:  [[0.15]]
grads:  [-0.01294955]
Stock Position:  -0.012949552201916686
Bond Position:  [22.0481602]


portfolio before change:  [20.73451658]
curr_Stock_Price:  101.54958639845873
curr_Factors:  [101.5495864]
mat_Sqrt:  [[0.15]]
grads:  [0.08805847]
Stock Position:  0.08805846983646497
Bond Position:  [11.79221539]


portfolio before change:  [20.82159704]
curr_Stock_Price:  102.53011017041887
curr_Factors:  [102.53011017]
mat_Sqrt:  [[0.15]]
grads:  [0.09116562]
Stock Position:  0.09116561713743641
Bond Position:  [11.47437627]


portfolio before change:  [20.72064687]
curr_Stock_Price:  101.41491625274091
curr_Factors:  [101.41491625]
mat_Sqrt:  [[0.15]]
grads:  [0.05432573]
Stock Position:  0.05432572530492089
Bond Position:  [15.21120799]


portfolio before change:  [20.74276016]
curr_Stock_Price:  101.80446577654709
curr_Factors:  [101.80446578]
mat_Sqrt:  [[0.15]]
grads:  [0.04130548]
Stock Position:  0.04130548376017811
Bond Position:  [16.53767745]


portfolio before change:  [20.71231111]
curr_Stock_Price:  101.04227426961232
curr_Factors:  [101.04227427]
mat_Sqrt:  [[0.15]]
grads:  [0.06068688]
Stock Position:  0.06068687546902642
Bond Position:  [14.5803712]


portfolio before change:  [20.70933149]
curr_Stock_Price:  100.9781595824819
curr_Factors:  [100.97815958]
mat_Sqrt:  [[0.15]]
grads:  [-0.18432488]
Stock Position:  -0.18432487938269027
Bond Position:  [39.32211858]


portfolio before change:  [20.71097788]
curr_Stock_Price:  100.98256115861435
curr_Factors:  [100.98256116]
mat_Sqrt:  [[0.15]]
grads:  [0.021444]
Stock Position:  0.02144400211203467
Bond Position:  [18.54550763]


portfolio before change:  [20.70217939]
curr_Stock_Price:  100.51820650136992
curr_Factors:  [100.5182065]
mat_Sqrt:  [[0.15]]
grads:  [-0.36542896]
Stock Position:  -0.36542895742336284
Bond Position:  [57.43444279]


portfolio before change:  [20.97714525]
curr_Stock_Price:  99.77558309704577
curr_Factors:  [99.7755831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04429098]
Stock Position:  -0.04429097978506156
Bond Position:  [25.39630359]


portfolio before change:  [20.93526473]
curr_Stock_Price:  100.75699836557709
curr_Factors:  [100.75699837]
mat_Sqrt:  [[0.15]]
grads:  [0.04538222]
Stock Position:  0.04538221808985408
Bond Position:  [16.36268865]


portfolio before change:  [20.91864895]
curr_Stock_Price:  100.36833355592869
curr_Factors:  [100.36833356]
mat_Sqrt:  [[0.15]]
grads:  [0.00453214]
Stock Position:  0.004532144171343322
Bond Position:  [20.4637652]


portfolio before change:  [20.92282379]
curr_Stock_Price:  101.0072837154377
curr_Factors:  [101.00728372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02559742]
Stock Position:  -0.025597419171754923
Bond Position:  [23.50834958]


portfolio before change:  [20.94638962]
curr_Stock_Price:  100.14405180871911
curr_Factors:  [100.14405181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02335755]
Stock Position:  -0.02335754579472265
Bond Position:  [23.2855089]


portfolio before change:  [20.94917456]
curr_Stock_Price:  100.08713017438482
curr_Factors:  [100.08713017]
mat_Sqrt:  [[0.15]]
grads:  [0.15362088]
Stock Position:  0.15362088164778795
Bond Position:  [5.57370138]


portfolio before change:  [20.9348495]
curr_Stock_Price:  99.99161302551916
curr_Factors:  [99.99161303]
mat_Sqrt:  [[0.15]]
grads:  [0.10216392]
Stock Position:  0.10216392005518096
Bond Position:  [10.71931434]


portfolio before change:  [20.87051575]
curr_Stock_Price:  99.35534413799367
curr_Factors:  [99.35534414]
mat_Sqrt:  [[0.15]]
grads:  [0.07152366]
Stock Position:  0.07152366018023534
Bond Position:  [13.76425788]


portfolio before change:  [20.86099964]
curr_Stock_Price:  99.21026752682292
curr_Factors:  [99.21026753]
mat_Sqrt:  [[0.15]]
grads:  [0.03136444]
Stock Position:  0.03136444317592719
Bond Position:  [17.74932484]


portfolio before change:  [20.87098106]
curr_Stock_Price:  99.49313727844223
curr_Factors:  [99.49313728]
mat_Sqrt:  [[0.15]]
grads:  [0.03900765]
Stock Position:  0.039007646083067594
Bond Position:  [16.98998797]


portfolio before change:  [20.9082611]
curr_Stock_Price:  100.4216252915544
curr_Factors:  [100.42162529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01204466]
Stock Position:  -0.012044659440584802
Bond Position:  [22.11780537]


portfolio before change:  [20.9249952]
curr_Stock_Price:  99.14706088588122
curr_Factors:  [99.14706089]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748376]
Stock Position:  -0.04748376082116704
Bond Position:  [25.63287052]


portfolio before change:  [20.92955801]
curr_Stock_Price:  99.08470880212002
curr_Factors:  [99.0847088]
mat_Sqrt:  [[0.15]]
grads:  [-0.0121089]
Stock Position:  -0.012108898045055216
Bond Position:  [22.12936465]


portfolio before change:  [20.92942157]
curr_Stock_Price:  99.21020047203777
curr_Factors:  [99.21020047]
mat_Sqrt:  [[0.15]]
grads:  [0.01106703]
Stock Position:  0.01106703422899171
Bond Position:  [19.83145889]


portfolio before change:  [20.92859141]
curr_Stock_Price:  99.02318851011678
curr_Factors:  [99.02318851]
mat_Sqrt:  [[0.15]]
grads:  [0.05116973]
Stock Position:  0.05116972677577516
Bond Position:  [15.86160191]


portfolio before change:  [20.90444981]
curr_Stock_Price:  98.53201947362489
curr_Factors:  [98.53201947]
mat_Sqrt:  [[0.15]]
grads:  [-0.05217074]
Stock Position:  -0.05217073927080467
Bond Position:  [26.0449381]


portfolio before change:  [20.90540237]
curr_Stock_Price:  98.54496343720815
curr_Factors:  [98.54496344]
mat_Sqrt:  [[0.15]]
grads:  [-0.02971192]
Stock Position:  -0.029711917128351188
Bond Position:  [23.83336216]


portfolio before change:  [20.91546413]
curr_Stock_Price:  98.25645550106482
curr_Factors:  [98.2564555]
mat_Sqrt:  [[0.15]]
grads:  [-0.0012499]
Stock Position:  -0.001249898763422142
Bond Position:  [21.03827475]


portfolio before change:  [20.91684759]
curr_Stock_Price:  98.2016228192313
curr_Factors:  [98.20162282]
mat_Sqrt:  [[0.15]]
grads:  [0.07607923]
Stock Position:  0.0760792273141566
Bond Position:  [13.44574401]


portfolio before change:  [20.87924443]
curr_Stock_Price:  97.69631339829951
curr_Factors:  [97.6963134]
mat_Sqrt:  [[0.15]]
grads:  [0.05503416]
Stock Position:  0.0550341556127994
Bond Position:  [15.50261032]


portfolio before change:  [20.88022999]
curr_Stock_Price:  97.6966152937124
curr_Factors:  [97.69661529]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413439]
Stock Position:  -0.024134389006163978
Bond Position:  [23.23807811]


portfolio before change:  [20.89626172]
curr_Stock_Price:  97.09252680508439
curr_Factors:  [97.09252681]
mat_Sqrt:  [[0.15]]
grads:  [-0.03431568]
Stock Position:  -0.034315677248920574
Bond Position:  [24.22805753]


portfolio before change:  [20.92227208]
curr_Stock_Price:  96.37868231559696
curr_Factors:  [96.37868232]
mat_Sqrt:  [[0.15]]
grads:  [-0.01094739]
Stock Position:  -0.010947389258149087
Bond Position:  [21.97736703]


portfolio before change:  [20.92275187]
curr_Stock_Price:  96.46033044485877
curr_Factors:  [96.46033044]
mat_Sqrt:  [[0.15]]
grads:  [-0.02061424]
Stock Position:  -0.020614238356496974
Bond Position:  [22.91120812]


portfolio before change:  [20.92628575]
curr_Stock_Price:  96.35836770459836
curr_Factors:  [96.3583677]
mat_Sqrt:  [[0.15]]
grads:  [-0.01949973]
Stock Position:  -0.019499726034182197
Bond Position:  [22.80524752]


portfolio before change:  [20.93041971]
curr_Stock_Price:  96.21946369281946
curr_Factors:  [96.21946369]
mat_Sqrt:  [[0.15]]
grads:  [0.12495272]
Stock Position:  0.12495271951218359
Bond Position:  [8.90753606]


portfolio before change:  [20.88519547]
curr_Stock_Price:  95.85307723901533
curr_Factors:  [95.85307724]
mat_Sqrt:  [[0.15]]
grads:  [0.03924353]
Stock Position:  0.03924352531838843
Bond Position:  [17.12358281]


portfolio before change:  [20.89452156]
curr_Stock_Price:  96.06345162698825
curr_Factors:  [96.06345163]
mat_Sqrt:  [[0.15]]
grads:  [0.12531935]
Stock Position:  0.125319348213101
Bond Position:  [8.85591241]


portfolio before change:  [20.97595604]
curr_Stock_Price:  96.70885053148425
curr_Factors:  [96.70885053]
mat_Sqrt:  [[0.15]]
grads:  [-0.01360008]
Stock Position:  -0.013600075847682285
Bond Position:  [22.29120374]


portfolio before change:  [20.97243814]
curr_Stock_Price:  97.06996224011299
curr_Factors:  [97.06996224]
mat_Sqrt:  [[0.15]]
grads:  [0.02839847]
Stock Position:  0.028398474197876892
Bond Position:  [18.21579932]


portfolio before change:  [20.99175521]
curr_Stock_Price:  97.71008623302386
curr_Factors:  [97.71008623]
mat_Sqrt:  [[0.15]]
grads:  [0.15282558]
Stock Position:  0.1528255790550602
Bond Position:  [6.0591547]


portfolio before change:  [20.9776877]
curr_Stock_Price:  97.61555874789559
curr_Factors:  [97.61555875]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [18.61834418]


portfolio before change:  [20.96200992]
curr_Stock_Price:  96.91875968145341
curr_Factors:  [96.91875968]
mat_Sqrt:  [[0.15]]
grads:  [-0.10318285]
Stock Position:  -0.10318284633329038
Bond Position:  [30.96236341]


portfolio before change:  [21.00273444]
curr_Stock_Price:  96.54283182427294
curr_Factors:  [96.54283182]
mat_Sqrt:  [[0.15]]
grads:  [-0.0385558]
Stock Position:  -0.03855579977628321
Bond Position:  [24.72502053]


portfolio before change:  [20.99848709]
curr_Stock_Price:  96.69307400230791
curr_Factors:  [96.693074]
mat_Sqrt:  [[0.15]]
grads:  [0.01194445]
Stock Position:  0.011944452550748294
Bond Position:  [19.84354126]


portfolio before change:  [20.99760065]
curr_Stock_Price:  96.51502484606361
curr_Factors:  [96.51502485]
mat_Sqrt:  [[0.15]]
grads:  [0.06698815]
Stock Position:  0.06698814724347171
Bond Position:  [14.53223796]


portfolio before change:  [21.01727613]
curr_Stock_Price:  96.79518169022305
curr_Factors:  [96.79518169]
mat_Sqrt:  [[0.15]]
grads:  [0.01552538]
Stock Position:  0.015525375738347294
Bond Position:  [19.51449457]


portfolio before change:  [21.00890337]
curr_Stock_Price:  96.17732498016156
curr_Factors:  [96.17732498]
mat_Sqrt:  [[0.15]]
grads:  [-0.00990743]
Stock Position:  -0.009907428764256414
Bond Position:  [21.96177336]


portfolio before change:  [21.00895646]
curr_Stock_Price:  96.31051418540358
curr_Factors:  [96.31051419]
mat_Sqrt:  [[0.15]]
grads:  [-0.08754926]
Stock Position:  -0.08754925869430946
Bond Position:  [29.44087058]


portfolio before change:  [20.99289205]
curr_Stock_Price:  96.51502211974054
curr_Factors:  [96.51502212]
mat_Sqrt:  [[0.15]]
grads:  [-0.16655157]
Stock Position:  -0.16655157338488247
Bond Position:  [37.06762084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.1743382]
Stock Price:  95.43950335090904
PL:  [21.1743382]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.02821039e-03]
 [ 2.74272856e-02]
 [ 1.49569215e-02]
 [-1.02419379e-02]
 [ 1.72289424e-03]
 [-2.77167156e-03]
 [ 2.39549639e-03]
 [-8.64162655e-03]
 [-7.01694577e-03]
 [-4.46617577e-03]
 [ 1.00537305e-02]
 [-7.29501877e-03]
 [ 5.30119214e-03]
 [-4.29529814e-03]
 [-3.43388945e-03]
 [ 9.27093342e-03]
 [ 1.09481972e-02]
 [-1.43755823e-02]
 [ 2.22360439e-02]
 [ 1.63862950e-03]
 [-5.00363412e-03]
 [ 4.58809058e-03]
 [ 1.86128283e-02]
 [ 1.82960544e-02]
 [-5.59496577e-03]
 [ 4.68149430e-03]
 [ 6.69249615e-03]
 [ 8.95062600e-03]
 [ 1.59881599e-02]
 [ 3.33682629e-02]
 [-6.95329366e-03]
 [ 2.58115248e-02]
 [ 1.31626577e-02]
 [-1.93844893e-02]
 [-1.39201389e-02]
 [-3.23755414e-02]
 [ 1.22384522e-02]
 [-8.33074889e-03]
 [ 7.59380594e-02]
 [ 3.30980308e-02]
 [ 6.28607981e-03]
 [ 3.48289304e-02]
 [-4.32778564e-03]
 [ 3.51642857e-02]
 [-8.08432240e-02]
 [ 2.66150591e-02]
 [ 8.66011572e-03]
 [ 5.44093459e-03]
 [-1.60637699e-02]
 [ 4.06414147e-04]
 [ 3.67058149e-03]
 [-5.01353652e-03]
 [-1.63629012e-03]
 [ 2.00486041e-03]
 [-2.11648952e-02]
 [-5.60243223e-03]
 [-6.69980240e-03]
 [ 1.46047954e-02]
 [ 5.46315967e-03]
 [-2.15612825e-03]
 [-5.16870166e-03]
 [-4.05648863e-03]
 [ 1.69156077e-03]
 [-7.24215486e-03]
 [ 1.68306801e-02]
 [ 1.13170256e-02]
 [ 2.06726767e-02]
 [-6.25791364e-03]
 [ 9.29375550e-03]
 [ 3.14468076e-02]
 [ 3.15137961e-03]
 [-1.50083133e-02]
 [-5.90419567e-03]
 [ 3.83593794e-03]
 [ 1.26508504e-02]
 [ 1.45008876e-02]
 [ 3.18127876e-03]
 [-2.93016063e-02]
 [-3.14916446e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.15344028]
curr_Stock_Price:  100.32353607766996
curr_Factors:  [100.32353608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02018807]
Stock Position:  -0.020188069248749944
Bond Position:  [11.17877877]


portfolio before change:  [9.14822972]
curr_Stock_Price:  100.61624628217179
curr_Factors:  [100.61624628]
mat_Sqrt:  [[0.15]]
grads:  [0.18284857]
Stock Position:  0.18284857058703038
Bond Position:  [-9.24930709]


portfolio before change:  [9.11024067]
curr_Stock_Price:  100.41164553412659
curr_Factors:  [100.41164553]
mat_Sqrt:  [[0.15]]
grads:  [0.09971281]
Stock Position:  0.09971280975521876
Bond Position:  [-0.90208664]


portfolio before change:  [9.11044904]
curr_Stock_Price:  100.41430070577393
curr_Factors:  [100.41430071]
mat_Sqrt:  [[0.15]]
grads:  [-0.06827959]
Stock Position:  -0.06827958611045233
Bond Position:  [15.96669593]


portfolio before change:  [9.10589611]
curr_Stock_Price:  100.4955970766642
curr_Factors:  [100.49559708]
mat_Sqrt:  [[0.15]]
grads:  [0.01148596]
Stock Position:  0.01148596158309402
Bond Position:  [7.95160754]


portfolio before change:  [9.10555833]
curr_Stock_Price:  100.42292001541101
curr_Factors:  [100.42292002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847781]
Stock Position:  -0.018477810394357492
Bond Position:  [10.96115401]


portfolio before change:  [9.11620456]
curr_Stock_Price:  99.8838338934637
curr_Factors:  [99.88383389]
mat_Sqrt:  [[0.15]]
grads:  [0.01596998]
Stock Position:  0.01596997595776261
Bond Position:  [7.52106213]


portfolio before change:  [9.12027414]
curr_Stock_Price:  100.10922568432686
curr_Factors:  [100.10922568]
mat_Sqrt:  [[0.15]]
grads:  [-0.05761084]
Stock Position:  -0.05761084364327793
Bond Position:  [14.88765109]


portfolio before change:  [9.13027661]
curr_Stock_Price:  99.95175594373245
curr_Factors:  [99.95175594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04677964]
Stock Position:  -0.046779638441740365
Bond Position:  [13.80598362]


portfolio before change:  [9.13898258]
curr_Stock_Price:  99.78409603199006
curr_Factors:  [99.78409603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02977451]
Stock Position:  -0.029774505161363728
Bond Position:  [12.11000466]


portfolio before change:  [9.18376897]
curr_Stock_Price:  98.30533132967557
curr_Factors:  [98.30533133]
mat_Sqrt:  [[0.15]]
grads:  [0.06702487]
Stock Position:  0.06702486983657983
Bond Position:  [2.59486693]


portfolio before change:  [9.13499216]
curr_Stock_Price:  97.57516966107654
curr_Factors:  [97.57516966]
mat_Sqrt:  [[0.15]]
grads:  [-0.04863346]
Stock Position:  -0.0486334584337353
Bond Position:  [13.88041012]


portfolio before change:  [9.133444]
curr_Stock_Price:  97.62484151036762
curr_Factors:  [97.62484151]
mat_Sqrt:  [[0.15]]
grads:  [0.03534128]
Stock Position:  0.03534128093662613
Bond Position:  [5.68325705]


portfolio before change:  [9.1443329]
curr_Stock_Price:  97.92289754579119
curr_Factors:  [97.92289755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863532]
Stock Position:  -0.0286353209606806
Bond Position:  [11.9483865]


portfolio before change:  [9.12697663]
curr_Stock_Price:  98.55509116653236
curr_Factors:  [98.55509117]
mat_Sqrt:  [[0.15]]
grads:  [-0.0228926]
Stock Position:  -0.022892596344784785
Bond Position:  [11.38315855]


portfolio before change:  [9.11998879]
curr_Stock_Price:  98.89141397166523
curr_Factors:  [98.89141397]
mat_Sqrt:  [[0.15]]
grads:  [0.06180622]
Stock Position:  0.06180622277162267
Bond Position:  [3.00788403]


portfolio before change:  [9.12406156]
curr_Stock_Price:  98.9542680126851
curr_Factors:  [98.95426801]
mat_Sqrt:  [[0.15]]
grads:  [0.07298798]
Stock Position:  0.07298798166303296
Bond Position:  [1.90158927]


portfolio before change:  [9.12405656]
curr_Stock_Price:  98.95257102389054
curr_Factors:  [98.95257102]
mat_Sqrt:  [[0.15]]
grads:  [-0.09583722]
Stock Position:  -0.09583721544991641
Bond Position:  [18.60739543]


portfolio before change:  [9.09572412]
curr_Stock_Price:  99.26033697858236
curr_Factors:  [99.26033698]
mat_Sqrt:  [[0.15]]
grads:  [0.14824029]
Stock Position:  0.14824029255043203
Bond Position:  [-5.61865727]


portfolio before change:  [9.10326052]
curr_Stock_Price:  99.31354502944592
curr_Factors:  [99.31354503]
mat_Sqrt:  [[0.15]]
grads:  [0.0109242]
Stock Position:  0.010924196678690762
Bond Position:  [8.01833983]


portfolio before change:  [9.0968875]
curr_Stock_Price:  98.68428239084334
curr_Factors:  [98.68428239]
mat_Sqrt:  [[0.15]]
grads:  [-0.03335756]
Stock Position:  -0.03335756081941405
Bond Position:  [12.38875445]


portfolio before change:  [9.06432394]
curr_Stock_Price:  99.68369241320069
curr_Factors:  [99.68369241]
mat_Sqrt:  [[0.15]]
grads:  [0.03058727]
Stock Position:  0.030587270536550748
Bond Position:  [6.01527187]


portfolio before change:  [9.04767285]
curr_Stock_Price:  99.12702117993976
curr_Factors:  [99.12702118]
mat_Sqrt:  [[0.15]]
grads:  [0.12408552]
Stock Position:  0.12408552210563992
Bond Position:  [-3.25255533]


portfolio before change:  [9.00182348]
curr_Stock_Price:  98.75916133578328
curr_Factors:  [98.75916134]
mat_Sqrt:  [[0.15]]
grads:  [0.1219737]
Stock Position:  0.12197369631039733
Bond Position:  [-3.04419647]


portfolio before change:  [9.00009162]
curr_Stock_Price:  98.74652263273843
curr_Factors:  [98.74652263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03729977]
Stock Position:  -0.03729977182246883
Bond Position:  [12.68331438]


portfolio before change:  [8.99981724]
curr_Stock_Price:  98.77513171249576
curr_Factors:  [98.77513171]
mat_Sqrt:  [[0.15]]
grads:  [0.03120996]
Stock Position:  0.031209962005347553
Bond Position:  [5.91704913]


portfolio before change:  [8.98188606]
curr_Stock_Price:  98.18874817464561
curr_Factors:  [98.18874817]
mat_Sqrt:  [[0.15]]
grads:  [0.04461664]
Stock Position:  0.04461664103255116
Bond Position:  [4.60103393]


portfolio before change:  [8.98095651]
curr_Stock_Price:  98.16146868198675
curr_Factors:  [98.16146868]
mat_Sqrt:  [[0.15]]
grads:  [0.05967084]
Stock Position:  0.059670839968087995
Bond Position:  [3.12357923]


portfolio before change:  [8.96158741]
curr_Stock_Price:  97.83359776572671
curr_Factors:  [97.83359777]
mat_Sqrt:  [[0.15]]
grads:  [0.10658773]
Stock Position:  0.10658773253719565
Bond Position:  [-1.46627394]


portfolio before change:  [8.89746525]
curr_Stock_Price:  97.23286708568016
curr_Factors:  [97.23286709]
mat_Sqrt:  [[0.15]]
grads:  [0.22245509]
Stock Position:  0.22245508623176902
Bond Position:  [-12.73248059]


portfolio before change:  [8.83703219]
curr_Stock_Price:  96.9647803931558
curr_Factors:  [96.96478039]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635529]
Stock Position:  -0.04635529107406218
Bond Position:  [13.33186281]


portfolio before change:  [8.90106663]
curr_Stock_Price:  95.60137257020595
curr_Factors:  [95.60137257]
mat_Sqrt:  [[0.15]]
grads:  [0.17207683]
Stock Position:  0.17207683203979923
Bond Position:  [-7.5497147]


portfolio before change:  [8.91658249]
curr_Stock_Price:  95.69428300681709
curr_Factors:  [95.69428301]
mat_Sqrt:  [[0.15]]
grads:  [0.08775105]
Stock Position:  0.08775105150847738
Bond Position:  [0.51930853]


portfolio before change:  [8.91698656]
curr_Stock_Price:  95.69851784777677
curr_Factors:  [95.69851785]
mat_Sqrt:  [[0.15]]
grads:  [-0.12922993]
Stock Position:  -0.12922992899140087
Bond Position:  [21.28409922]


portfolio before change:  [8.88308704]
curr_Stock_Price:  95.97113125778492
curr_Factors:  [95.97113126]
mat_Sqrt:  [[0.15]]
grads:  [-0.09280093]
Stock Position:  -0.09280092592126503
Bond Position:  [17.78929689]


portfolio before change:  [8.90048808]
curr_Stock_Price:  95.79560317210431
curr_Factors:  [95.79560317]
mat_Sqrt:  [[0.15]]
grads:  [-0.21583694]
Stock Position:  -0.21583694294505712
Bond Position:  [29.57671821]


portfolio before change:  [8.92063189]
curr_Stock_Price:  95.71083916047044
curr_Factors:  [95.71083916]
mat_Sqrt:  [[0.15]]
grads:  [0.08158968]
Stock Position:  0.08158968146297196
Bond Position:  [1.11161501]


portfolio before change:  [8.79193977]
curr_Stock_Price:  94.13267885173515
curr_Factors:  [94.13267885]
mat_Sqrt:  [[0.15]]
grads:  [-0.05553833]
Stock Position:  -0.05553832592905932
Bond Position:  [14.01991117]


portfolio before change:  [8.80570384]
curr_Stock_Price:  93.90062650189395
curr_Factors:  [93.9006265]
mat_Sqrt:  [[0.15]]
grads:  [0.50625373]
Stock Position:  0.506253729088149
Bond Position:  [-38.73183849]


portfolio before change:  [8.87298299]
curr_Stock_Price:  94.03830443425707
curr_Factors:  [94.03830443]
mat_Sqrt:  [[0.15]]
grads:  [0.22065354]
Stock Position:  0.22065353837761964
Bond Position:  [-11.87690163]


portfolio before change:  [8.804554]
curr_Stock_Price:  93.73154905246135
curr_Factors:  [93.73154905]
mat_Sqrt:  [[0.15]]
grads:  [0.0419072]
Stock Position:  0.041907198723748464
Bond Position:  [4.87652735]


portfolio before change:  [8.80956505]
curr_Stock_Price:  93.8438510512159
curr_Factors:  [93.84385105]
mat_Sqrt:  [[0.15]]
grads:  [0.23219287]
Stock Position:  0.23219286930100785
Bond Position:  [-12.98030799]


portfolio before change:  [8.60832998]
curr_Stock_Price:  92.98067304866146
curr_Factors:  [92.98067305]
mat_Sqrt:  [[0.15]]
grads:  [-0.0288519]
Stock Position:  -0.028851904249313567
Bond Position:  [11.29099946]


portfolio before change:  [8.58787777]
curr_Stock_Price:  93.71400157212206
curr_Factors:  [93.71400157]
mat_Sqrt:  [[0.15]]
grads:  [0.23442857]
Stock Position:  0.2344285710432587
Bond Position:  [-13.38136171]


portfolio before change:  [8.62758626]
curr_Stock_Price:  93.88695341244699
curr_Factors:  [93.88695341]
mat_Sqrt:  [[0.15]]
grads:  [-0.53895483]
Stock Position:  -0.538954826978899
Bond Position:  [59.22841299]


portfolio before change:  [8.59388169]
curr_Stock_Price:  93.95635897189746
curr_Factors:  [93.95635897]
mat_Sqrt:  [[0.15]]
grads:  [0.17743373]
Stock Position:  0.1774337271283861
Bond Position:  [-8.07714527]


portfolio before change:  [8.64035459]
curr_Stock_Price:  94.22112112482068
curr_Factors:  [94.22112112]
mat_Sqrt:  [[0.15]]
grads:  [0.0577341]
Stock Position:  0.057734104827581
Bond Position:  [3.2005825]


portfolio before change:  [8.62217871]
curr_Stock_Price:  93.90283582897104
curr_Factors:  [93.90283583]
mat_Sqrt:  [[0.15]]
grads:  [0.0362729]
Stock Position:  0.03627289729945636
Bond Position:  [5.21605079]


portfolio before change:  [8.62137208]
curr_Stock_Price:  93.87161026588507
curr_Factors:  [93.87161027]
mat_Sqrt:  [[0.15]]
grads:  [-0.1070918]
Stock Position:  -0.10709179905176919
Bond Position:  [18.67425171]


portfolio before change:  [8.64123117]
curr_Stock_Price:  93.69706925030582
curr_Factors:  [93.69706925]
mat_Sqrt:  [[0.15]]
grads:  [0.00270943]
Stock Position:  0.0027094276464681194
Bond Position:  [8.38736574]


portfolio before change:  [8.63909527]
curr_Stock_Price:  92.71526425012037
curr_Factors:  [92.71526425]
mat_Sqrt:  [[0.15]]
grads:  [0.02447054]
Stock Position:  0.024470543266160497
Bond Position:  [6.37030239]


portfolio before change:  [8.65769513]
curr_Stock_Price:  93.45908534141891
curr_Factors:  [93.45908534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03342358]
Stock Position:  -0.033423576776469524
Bond Position:  [11.78143205]


portfolio before change:  [8.64964057]
curr_Stock_Price:  93.72210093493206
curr_Factors:  [93.72210093]
mat_Sqrt:  [[0.15]]
grads:  [-0.0109086]
Stock Position:  -0.010908600817523036
Bond Position:  [9.67201756]


portfolio before change:  [8.65003937]
curr_Stock_Price:  93.74096013449048
curr_Factors:  [93.74096013]
mat_Sqrt:  [[0.15]]
grads:  [0.01336574]
Stock Position:  0.013365736036667134
Bond Position:  [7.39712244]


portfolio before change:  [8.64761322]
curr_Stock_Price:  93.52484914280491
curr_Factors:  [93.52484914]
mat_Sqrt:  [[0.15]]
grads:  [-0.1410993]
Stock Position:  -0.14109930108749488
Bond Position:  [21.84390407]


portfolio before change:  [8.62378923]
curr_Stock_Price:  93.70337077386594
curr_Factors:  [93.70337077]
mat_Sqrt:  [[0.15]]
grads:  [-0.03734955]
Stock Position:  -0.03734954819699616
Bond Position:  [12.12356779]


portfolio before change:  [8.63119089]
curr_Stock_Price:  93.52548591338392
curr_Factors:  [93.52548591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04466535]
Stock Position:  -0.0446653493000187
Bond Position:  [12.80853939]


portfolio before change:  [8.63775341]
curr_Stock_Price:  93.39648309296659
curr_Factors:  [93.39648309]
mat_Sqrt:  [[0.15]]
grads:  [0.0973653]
Stock Position:  0.09736530292907941
Bond Position:  [-0.45582346]


portfolio before change:  [8.64245944]
curr_Stock_Price:  93.4451094736784
curr_Factors:  [93.44510947]
mat_Sqrt:  [[0.15]]
grads:  [0.03642106]
Stock Position:  0.03642106449512851
Bond Position:  [5.23908908]


portfolio before change:  [8.64336366]
curr_Stock_Price:  93.46094548374106
curr_Factors:  [93.46094548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437419]
Stock Position:  -0.014374188306937557
Bond Position:  [9.98678889]


portfolio before change:  [8.64760084]
curr_Stock_Price:  93.20959295579097
curr_Factors:  [93.20959296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445801]
Stock Position:  -0.03445801104102976
Bond Position:  [11.85941802]


portfolio before change:  [8.6333264]
curr_Stock_Price:  93.645360210168
curr_Factors:  [93.64536021]
mat_Sqrt:  [[0.15]]
grads:  [-0.02704326]
Stock Position:  -0.027043257522732563
Bond Position:  [11.165802]


portfolio before change:  [8.63367485]
curr_Stock_Price:  93.65828162280697
curr_Factors:  [93.65828162]
mat_Sqrt:  [[0.15]]
grads:  [0.01127707]
Stock Position:  0.011277071811561373
Bond Position:  [7.57748368]


portfolio before change:  [8.63191217]
curr_Stock_Price:  93.4599773393661
curr_Factors:  [93.45997734]
mat_Sqrt:  [[0.15]]
grads:  [-0.04828103]
Stock Position:  -0.04828103238950043
Bond Position:  [13.14425636]


portfolio before change:  [8.64426856]
curr_Stock_Price:  93.22106681942188
curr_Factors:  [93.22106682]
mat_Sqrt:  [[0.15]]
grads:  [0.11220453]
Stock Position:  0.11220453395336404
Bond Position:  [-1.8155578]


portfolio before change:  [8.54732321]
curr_Stock_Price:  92.35807257025334
curr_Factors:  [92.35807257]
mat_Sqrt:  [[0.15]]
grads:  [0.07544684]
Stock Position:  0.0754468372873602
Bond Position:  [1.57919874]


portfolio before change:  [8.52656487]
curr_Stock_Price:  92.08162560796777
curr_Factors:  [92.08162561]
mat_Sqrt:  [[0.15]]
grads:  [0.13781784]
Stock Position:  0.1378178445886849
Bond Position:  [-4.1639263]


portfolio before change:  [8.64650894]
curr_Stock_Price:  92.95382272055575
curr_Factors:  [92.95382272]
mat_Sqrt:  [[0.15]]
grads:  [-0.04171942]
Stock Position:  -0.04171942429096471
Bond Position:  [12.52448891]


portfolio before change:  [8.63212096]
curr_Stock_Price:  93.31746120437954
curr_Factors:  [93.3174612]
mat_Sqrt:  [[0.15]]
grads:  [0.06195837]
Stock Position:  0.06195837003058117
Bond Position:  [2.85032316]


portfolio before change:  [8.57906339]
curr_Stock_Price:  92.45824367236582
curr_Factors:  [92.45824367]
mat_Sqrt:  [[0.15]]
grads:  [0.20964538]
Stock Position:  0.20964538382497702
Bond Position:  [-10.80438059]


portfolio before change:  [8.73398235]
curr_Stock_Price:  93.20042196902989
curr_Factors:  [93.20042197]
mat_Sqrt:  [[0.15]]
grads:  [0.0210092]
Stock Position:  0.021009197423535596
Bond Position:  [6.77591628]


portfolio before change:  [8.7275974]
curr_Stock_Price:  92.87635181783011
curr_Factors:  [92.87635182]
mat_Sqrt:  [[0.15]]
grads:  [-0.10005542]
Stock Position:  -0.10005542219257517
Bond Position:  [18.02038]


portfolio before change:  [8.79430554]
curr_Stock_Price:  92.22089681874772
curr_Factors:  [92.22089682]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393613]
Stock Position:  -0.03936130443934173
Bond Position:  [12.42424033]


portfolio before change:  [8.80283532]
curr_Stock_Price:  92.02392053870682
curr_Factors:  [92.02392054]
mat_Sqrt:  [[0.15]]
grads:  [0.02557292]
Stock Position:  0.025572919569426592
Bond Position:  [6.449515]


portfolio before change:  [8.81692137]
curr_Stock_Price:  92.55897646715299
curr_Factors:  [92.55897647]
mat_Sqrt:  [[0.15]]
grads:  [0.084339]
Stock Position:  0.08433900235051145
Bond Position:  [1.01058964]


portfolio before change:  [8.91199302]
curr_Stock_Price:  93.68548358036645
curr_Factors:  [93.68548358]
mat_Sqrt:  [[0.15]]
grads:  [0.09667258]
Stock Position:  0.09667258432470237
Bond Position:  [-0.14482479]


portfolio before change:  [8.92901683]
curr_Stock_Price:  93.86167481981752
curr_Factors:  [93.86167482]
mat_Sqrt:  [[0.15]]
grads:  [0.02120853]
Stock Position:  0.021208525091975437
Bond Position:  [6.93834914]


portfolio before change:  [8.926688]
curr_Stock_Price:  93.73142104652874
curr_Factors:  [93.73142105]
mat_Sqrt:  [[0.15]]
grads:  [-0.19534404]
Stock Position:  -0.19534404183676796
Bond Position:  [27.23656263]


portfolio before change:  [8.67112846]
curr_Stock_Price:  95.04838917875435
curr_Factors:  [95.04838918]
mat_Sqrt:  [[0.15]]
grads:  [-0.2099443]
Stock Position:  -0.20994429740827172
Bond Position:  [28.62599575]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.56906881]
Stock Price:  95.54303864862725
PL:  [8.56906881]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.03426367e-03]
 [ 2.02712513e-02]
 [ 2.03328775e-02]
 [-1.73208820e-02]
 [-9.85309637e-03]
 [-1.02280014e-02]
 [ 1.54061015e-03]
 [-7.75778491e-03]
 [ 2.88789941e-03]
 [-1.43721557e-03]
 [ 7.26741761e-03]
 [-2.70092179e-03]
 [-1.89891924e-03]
 [ 7.59841616e-03]
 [-1.33984329e-03]
 [ 1.60708292e-02]
 [ 3.44434798e-02]
 [-1.47620239e-02]
 [ 2.00247151e-02]
 [ 2.52974922e-03]
 [-4.17708417e-03]
 [ 4.20925422e-03]
 [ 1.49824984e-02]
 [ 1.91224291e-02]
 [-2.07706510e-03]
 [ 6.88832666e-03]
 [-5.77947782e-03]
 [ 9.10836328e-03]
 [ 3.10416733e-02]
 [ 3.48481587e-04]
 [-8.38093908e-03]
 [ 1.16950212e-02]
 [ 1.23492131e-02]
 [ 3.24978096e-03]
 [ 3.01270742e-03]
 [ 1.42619518e-02]
 [-1.29587858e-02]
 [ 2.78075715e-03]
 [-5.03524391e-02]
 [-8.71121943e-03]
 [ 4.19009335e-03]
 [ 1.00263614e-02]
 [-5.63028219e-03]
 [-1.19361370e-03]
 [ 1.71386413e-02]
 [ 1.27186940e-02]
 [ 1.06540533e-02]
 [-6.13513802e-05]
 [ 1.02260899e-02]
 [-1.32941835e-03]
 [ 1.61900496e-02]
 [-1.20325105e-03]
 [-1.82478235e-03]
 [-2.84149831e-02]
 [-8.25804733e-03]
 [-2.76347792e-03]
 [ 7.57309105e-03]
 [-1.44457483e-02]
 [ 4.68119252e-03]
 [-3.60338671e-03]
 [-3.59083736e-03]
 [ 7.20688417e-03]
 [-1.95091835e-02]
 [ 1.60288712e-03]
 [ 1.80029398e-02]
 [ 1.30486368e-02]
 [ 5.28779040e-03]
 [ 1.33040041e-02]
 [ 7.22023364e-03]
 [ 1.11573445e-02]
 [ 4.94960985e-03]
 [-1.50493319e-02]
 [-1.51624898e-02]
 [ 9.10442807e-04]
 [-3.07071072e-04]
 [-2.18732971e-02]
 [-4.63591608e-03]
 [ 1.48390804e-02]
 [ 2.77430358e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.18387875]
curr_Stock_Price:  100.32491853071501
curr_Factors:  [100.32491853]
mat_Sqrt:  [[0.15]]
grads:  [-0.02022842]
Stock Position:  -0.020228424485747187
Bond Position:  [11.21329379]


portfolio before change:  [9.18315082]
curr_Stock_Price:  100.39555101208411
curr_Factors:  [100.39555101]
mat_Sqrt:  [[0.15]]
grads:  [0.13514168]
Stock Position:  0.13514167554384224
Bond Position:  [-4.38447216]


portfolio before change:  [9.25878132]
curr_Stock_Price:  100.9572174251153
curr_Factors:  [100.95721743]
mat_Sqrt:  [[0.15]]
grads:  [0.13555252]
Stock Position:  0.13555251669025314
Bond Position:  [-4.42622358]


portfolio before change:  [9.22738424]
curr_Stock_Price:  100.7276353310233
curr_Factors:  [100.72763533]
mat_Sqrt:  [[0.15]]
grads:  [-0.11547255]
Stock Position:  -0.11547254680023794
Bond Position:  [20.85866083]


portfolio before change:  [9.22360613]
curr_Stock_Price:  100.77164422206658
curr_Factors:  [100.77164422]
mat_Sqrt:  [[0.15]]
grads:  [-0.06568731]
Stock Position:  -0.06568730911691659
Bond Position:  [15.84302428]


portfolio before change:  [9.30102488]
curr_Stock_Price:  99.60812378908878
curr_Factors:  [99.60812379]
mat_Sqrt:  [[0.15]]
grads:  [-0.06818668]
Stock Position:  -0.06818667602381429
Bond Position:  [16.09297175]


portfolio before change:  [9.29631064]
curr_Stock_Price:  99.69201235758091
curr_Factors:  [99.69201236]
mat_Sqrt:  [[0.15]]
grads:  [0.01027073]
Stock Position:  0.010270734310127625
Bond Position:  [8.27240047]


portfolio before change:  [9.30023967]
curr_Stock_Price:  100.0242170600163
curr_Factors:  [100.02421706]
mat_Sqrt:  [[0.15]]
grads:  [-0.05171857]
Stock Position:  -0.051718566070877416
Bond Position:  [14.47334875]


portfolio before change:  [9.27784793]
curr_Stock_Price:  100.47466163655979
curr_Factors:  [100.47466164]
mat_Sqrt:  [[0.15]]
grads:  [0.01925266]
Stock Position:  0.019252662751659592
Bond Position:  [7.34344316]


portfolio before change:  [9.29025837]
curr_Stock_Price:  101.09543093665143
curr_Factors:  [101.09543094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00958144]
Stock Position:  -0.009581437160612235
Bond Position:  [10.25889789]


portfolio before change:  [9.29776346]
curr_Stock_Price:  100.37905764471977
curr_Factors:  [100.37905764]
mat_Sqrt:  [[0.15]]
grads:  [0.04844945]
Stock Position:  0.04844945075288228
Bond Position:  [4.43445325]


portfolio before change:  [9.28197201]
curr_Stock_Price:  100.04740029879841
curr_Factors:  [100.0474003]
mat_Sqrt:  [[0.15]]
grads:  [-0.01800615]
Stock Position:  -0.018006145286071525
Bond Position:  [11.08344003]


portfolio before change:  [9.28370928]
curr_Stock_Price:  99.9893901348656
curr_Factors:  [99.98939013]
mat_Sqrt:  [[0.15]]
grads:  [-0.01265946]
Stock Position:  -0.012659461596945799
Bond Position:  [10.54952113]


portfolio before change:  [9.27737939]
curr_Stock_Price:  100.54148798815758
curr_Factors:  [100.54148799]
mat_Sqrt:  [[0.15]]
grads:  [0.05065611]
Stock Position:  0.050656107723513075
Bond Position:  [4.18433894]


portfolio before change:  [9.29718873]
curr_Stock_Price:  100.92738061452533
curr_Factors:  [100.92738061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893229]
Stock Position:  -0.008932288612123277
Bond Position:  [10.19870123]


portfolio before change:  [9.29608991]
curr_Stock_Price:  101.12176072728447
curr_Factors:  [101.12176073]
mat_Sqrt:  [[0.15]]
grads:  [0.10713886]
Stock Position:  0.10713886146735038
Bond Position:  [-1.5379804]


portfolio before change:  [9.17509451]
curr_Stock_Price:  99.99332542497164
curr_Factors:  [99.99332542]
mat_Sqrt:  [[0.15]]
grads:  [0.2296232]
Stock Position:  0.22962319863623515
Bond Position:  [-13.78569271]


portfolio before change:  [9.33033529]
curr_Stock_Price:  100.67314528834736
curr_Factors:  [100.67314529]
mat_Sqrt:  [[0.15]]
grads:  [-0.09841349]
Stock Position:  -0.0984134926304432
Bond Position:  [19.23793113]


portfolio before change:  [9.40101063]
curr_Stock_Price:  99.96721641220772
curr_Factors:  [99.96721641]
mat_Sqrt:  [[0.15]]
grads:  [0.1334981]
Stock Position:  0.13349810046625626
Bond Position:  [-3.94442287]


portfolio before change:  [9.39196283]
curr_Stock_Price:  99.90128839669876
curr_Factors:  [99.9012884]
mat_Sqrt:  [[0.15]]
grads:  [0.01686499]
Stock Position:  0.016864994810569654
Bond Position:  [7.70712812]


portfolio before change:  [9.39572164]
curr_Stock_Price:  100.09560222704236
curr_Factors:  [100.09560223]
mat_Sqrt:  [[0.15]]
grads:  [-0.02784723]
Stock Position:  -0.027847227819253802
Bond Position:  [12.18310668]


portfolio before change:  [9.38367185]
curr_Stock_Price:  100.55565740124814
curr_Factors:  [100.5556574]
mat_Sqrt:  [[0.15]]
grads:  [0.02806169]
Stock Position:  0.028061694799094202
Bond Position:  [6.56190968]


portfolio before change:  [9.37487702]
curr_Stock_Price:  100.22763178836546
curr_Factors:  [100.22763179]
mat_Sqrt:  [[0.15]]
grads:  [0.09988332]
Stock Position:  0.09988332287743486
Bond Position:  [-0.63619188]


portfolio before change:  [9.42687947]
curr_Stock_Price:  100.74866179367265
curr_Factors:  [100.74866179]
mat_Sqrt:  [[0.15]]
grads:  [0.12748286]
Stock Position:  0.1274828608009234
Bond Position:  [-3.41684816]


portfolio before change:  [9.49795924]
curr_Stock_Price:  101.30790037770558
curr_Factors:  [101.30790038]
mat_Sqrt:  [[0.15]]
grads:  [-0.0138471]
Stock Position:  -0.013847100653062463
Bond Position:  [10.90077994]


portfolio before change:  [9.50172335]
curr_Stock_Price:  101.0852698703334
curr_Factors:  [101.08526987]
mat_Sqrt:  [[0.15]]
grads:  [0.04592218]
Stock Position:  0.045922177726052955
Bond Position:  [4.85966762]


portfolio before change:  [9.48513933]
curr_Stock_Price:  100.71752244316464
curr_Factors:  [100.71752244]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852985]
Stock Position:  -0.03852985210315993
Bond Position:  [13.36577057]


portfolio before change:  [9.46540872]
curr_Stock_Price:  101.25129009888506
curr_Factors:  [101.2512901]
mat_Sqrt:  [[0.15]]
grads:  [0.06072242]
Stock Position:  0.06072242185663441
Bond Position:  [3.31718517]


portfolio before change:  [9.42427206]
curr_Stock_Price:  100.57042146280313
curr_Factors:  [100.57042146]
mat_Sqrt:  [[0.15]]
grads:  [0.20694449]
Stock Position:  0.20694448883720973
Bond Position:  [-11.3882224]


portfolio before change:  [9.31440449]
curr_Stock_Price:  100.0429573941924
curr_Factors:  [100.04295739]
mat_Sqrt:  [[0.15]]
grads:  [0.00232321]
Stock Position:  0.002323210578267232
Bond Position:  [9.08198364]


portfolio before change:  [9.31523594]
curr_Stock_Price:  100.15650896276902
curr_Factors:  [100.15650896]
mat_Sqrt:  [[0.15]]
grads:  [-0.05587293]
Stock Position:  -0.0558729272216097
Bond Position:  [14.91127328]


portfolio before change:  [9.2648178]
curr_Stock_Price:  101.0755609628384
curr_Factors:  [101.07556096]
mat_Sqrt:  [[0.15]]
grads:  [0.07796681]
Stock Position:  0.07796680813541904
Bond Position:  [1.38427893]


portfolio before change:  [9.21344302]
curr_Stock_Price:  100.41551984183495
curr_Factors:  [100.41551984]
mat_Sqrt:  [[0.15]]
grads:  [0.08232809]
Stock Position:  0.08232808736584776
Bond Position:  [0.94642533]


portfolio before change:  [9.21218025]
curr_Stock_Price:  100.39946308629708
curr_Factors:  [100.39946309]
mat_Sqrt:  [[0.15]]
grads:  [0.02166521]
Stock Position:  0.021665206375633593
Bond Position:  [7.03700516]


portfolio before change:  [9.18628331]
curr_Stock_Price:  99.18383824970428
curr_Factors:  [99.18383825]
mat_Sqrt:  [[0.15]]
grads:  [0.02008472]
Stock Position:  0.020084716134168956
Bond Position:  [7.19420408]


portfolio before change:  [9.20222246]
curr_Stock_Price:  99.9550465034894
curr_Factors:  [99.9550465]
mat_Sqrt:  [[0.15]]
grads:  [0.09507968]
Stock Position:  0.09507967846873666
Bond Position:  [-0.30147122]


portfolio before change:  [9.19237236]
curr_Stock_Price:  99.8516462465839
curr_Factors:  [99.85164625]
mat_Sqrt:  [[0.15]]
grads:  [-0.08639191]
Stock Position:  -0.08639190518520343
Bond Position:  [17.81874631]


portfolio before change:  [9.15420993]
curr_Stock_Price:  100.3062736986582
curr_Factors:  [100.3062737]
mat_Sqrt:  [[0.15]]
grads:  [0.01853838]
Stock Position:  0.018538380983151945
Bond Position:  [7.29469402]


portfolio before change:  [9.16735476]
curr_Stock_Price:  100.99073980673431
curr_Factors:  [100.99073981]
mat_Sqrt:  [[0.15]]
grads:  [-0.33568293]
Stock Position:  -0.33568292755788876
Bond Position:  [43.06822195]


portfolio before change:  [8.92348613]
curr_Stock_Price:  101.72524389604813
curr_Factors:  [101.7252439]
mat_Sqrt:  [[0.15]]
grads:  [-0.0580748]
Stock Position:  -0.05807479618477253
Bond Position:  [14.83115893]


portfolio before change:  [8.91311121]
curr_Stock_Price:  101.91985310203917
curr_Factors:  [101.9198531]
mat_Sqrt:  [[0.15]]
grads:  [0.02793396]
Stock Position:  0.02793395567944825
Bond Position:  [6.06608655]


portfolio before change:  [8.91579685]
curr_Stock_Price:  102.0024226484007
curr_Factors:  [102.00242265]
mat_Sqrt:  [[0.15]]
grads:  [0.06684241]
Stock Position:  0.06684240912663743
Bond Position:  [2.09770918]


portfolio before change:  [8.9142593]
curr_Stock_Price:  101.97745851742552
curr_Factors:  [101.97745852]
mat_Sqrt:  [[0.15]]
grads:  [-0.03753521]
Stock Position:  -0.03753521457457118
Bond Position:  [12.74200508]


portfolio before change:  [8.89709004]
curr_Stock_Price:  102.45609312528407
curr_Factors:  [102.45609313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795742]
Stock Position:  -0.007957424688557526
Bond Position:  [9.71237669]


portfolio before change:  [8.90753315]
curr_Stock_Price:  101.22000667105168
curr_Factors:  [101.22000667]
mat_Sqrt:  [[0.15]]
grads:  [0.11425761]
Stock Position:  0.11425760851037595
Bond Position:  [-2.65762274]


portfolio before change:  [8.9941501]
curr_Stock_Price:  101.97954524078675
curr_Factors:  [101.97954524]
mat_Sqrt:  [[0.15]]
grads:  [0.08479129]
Stock Position:  0.08479129344022092
Bond Position:  [0.34717256]


portfolio before change:  [8.96499533]
curr_Stock_Price:  101.63544776696804
curr_Factors:  [101.63544777]
mat_Sqrt:  [[0.15]]
grads:  [0.07102702]
Stock Position:  0.07102702184503847
Bond Position:  [1.74613217]


portfolio before change:  [9.00564665]
curr_Stock_Price:  102.20624710612532
curr_Factors:  [102.20624711]
mat_Sqrt:  [[0.15]]
grads:  [-0.00040901]
Stock Position:  -0.0004090092014879234
Bond Position:  [9.04744994]


portfolio before change:  [9.00675597]
curr_Stock_Price:  100.87658552073148
curr_Factors:  [100.87658552]
mat_Sqrt:  [[0.15]]
grads:  [0.06817393]
Stock Position:  0.06817393295514919
Bond Position:  [2.1296024]


portfolio before change:  [9.02984793]
curr_Stock_Price:  101.21335428447236
curr_Factors:  [101.21335428]
mat_Sqrt:  [[0.15]]
grads:  [-0.00886279]
Stock Position:  -0.00886278900893364
Bond Position:  [9.92688053]


portfolio before change:  [9.02492976]
curr_Stock_Price:  101.83828440093686
curr_Factors:  [101.8382844]
mat_Sqrt:  [[0.15]]
grads:  [0.10793366]
Stock Position:  0.1079336642779398
Bond Position:  [-1.96684944]


portfolio before change:  [9.1733655]
curr_Stock_Price:  103.21467314698047
curr_Factors:  [103.21467315]
mat_Sqrt:  [[0.15]]
grads:  [-0.00802167]
Stock Position:  -0.008021673652292186
Bond Position:  [10.00131993]


portfolio before change:  [9.17173925]
curr_Stock_Price:  103.49533279139818
curr_Factors:  [103.49533279]
mat_Sqrt:  [[0.15]]
grads:  [-0.01216522]
Stock Position:  -0.012165215665965946
Bond Position:  [10.43078229]


portfolio before change:  [9.16247085]
curr_Stock_Price:  104.31080030994987
curr_Factors:  [104.31080031]
mat_Sqrt:  [[0.15]]
grads:  [-0.18943322]
Stock Position:  -0.18943322047763442
Bond Position:  [28.92240169]


portfolio before change:  [9.12369446]
curr_Stock_Price:  104.52503989968699
curr_Factors:  [104.5250399]
mat_Sqrt:  [[0.15]]
grads:  [-0.05505365]
Stock Position:  -0.05505364888938182
Bond Position:  [14.87817931]


portfolio before change:  [9.13316268]
curr_Stock_Price:  104.36994926538627
curr_Factors:  [104.36994927]
mat_Sqrt:  [[0.15]]
grads:  [-0.01842319]
Stock Position:  -0.01842318614448234
Bond Position:  [11.05598969]


portfolio before change:  [9.13617004]
curr_Stock_Price:  104.2442201043253
curr_Factors:  [104.2442201]
mat_Sqrt:  [[0.15]]
grads:  [0.05048727]
Stock Position:  0.05048727367032638
Bond Position:  [3.87316357]


portfolio before change:  [9.09426802]
curr_Stock_Price:  103.40947309134724
curr_Factors:  [103.40947309]
mat_Sqrt:  [[0.15]]
grads:  [-0.09630499]
Stock Position:  -0.09630498838072775
Bond Position:  [19.05311612]


portfolio before change:  [9.09956488]
curr_Stock_Price:  103.36683764924643
curr_Factors:  [103.36683765]
mat_Sqrt:  [[0.15]]
grads:  [0.03120795]
Stock Position:  0.03120795014678798
Bond Position:  [5.87369776]


portfolio before change:  [9.10847655]
curr_Stock_Price:  103.64063163414758
curr_Factors:  [103.64063163]
mat_Sqrt:  [[0.15]]
grads:  [-0.02402258]
Stock Position:  -0.02402257803729054
Bond Position:  [11.59819171]


portfolio before change:  [9.11859975]
curr_Stock_Price:  103.24940387805141
curr_Factors:  [103.24940388]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393892]
Stock Position:  -0.02393891573131009
Bond Position:  [11.59027853]


portfolio before change:  [9.12508878]
curr_Stock_Price:  103.00859870505866
curr_Factors:  [103.00859871]
mat_Sqrt:  [[0.15]]
grads:  [0.04804589]
Stock Position:  0.048045894442436066
Bond Position:  [4.17594852]


portfolio before change:  [9.14794054]
curr_Stock_Price:  103.47878974840451
curr_Factors:  [103.47878975]
mat_Sqrt:  [[0.15]]
grads:  [-0.13006122]
Stock Position:  -0.1300612231143165
Bond Position:  [22.6065185]


portfolio before change:  [9.15087978]
curr_Stock_Price:  103.46705457717668
curr_Factors:  [103.46705458]
mat_Sqrt:  [[0.15]]
grads:  [0.01068591]
Stock Position:  0.010685914137345988
Bond Position:  [8.04523972]


portfolio before change:  [9.15520417]
curr_Stock_Price:  103.8246790101126
curr_Factors:  [103.82467901]
mat_Sqrt:  [[0.15]]
grads:  [0.1200196]
Stock Position:  0.12001959857549964
Bond Position:  [-3.30579213]


portfolio before change:  [9.18646848]
curr_Stock_Price:  104.08689393941836
curr_Factors:  [104.08689394]
mat_Sqrt:  [[0.15]]
grads:  [0.08699091]
Stock Position:  0.08699091228875491
Bond Position:  [0.13185462]


portfolio before change:  [9.23196243]
curr_Stock_Price:  104.60977273710044
curr_Factors:  [104.60977274]
mat_Sqrt:  [[0.15]]
grads:  [0.03525194]
Stock Position:  0.035251936014108746
Bond Position:  [5.54426541]


portfolio before change:  [9.25236295]
curr_Stock_Price:  105.17864916773708
curr_Factors:  [105.17864917]
mat_Sqrt:  [[0.15]]
grads:  [0.08869336]
Stock Position:  0.08869336037535053
Bond Position:  [-0.07628489]


portfolio before change:  [9.22597037]
curr_Stock_Price:  104.88113180435157
curr_Factors:  [104.8811318]
mat_Sqrt:  [[0.15]]
grads:  [0.04813489]
Stock Position:  0.04813489090666982
Bond Position:  [4.17752853]


portfolio before change:  [9.25975625]
curr_Stock_Price:  105.57760746829783
curr_Factors:  [105.57760747]
mat_Sqrt:  [[0.15]]
grads:  [0.0743823]
Stock Position:  0.07438229660723618
Bond Position:  [1.40665134]


portfolio before change:  [9.29860718]
curr_Stock_Price:  106.0987397513715
curr_Factors:  [106.09873975]
mat_Sqrt:  [[0.15]]
grads:  [0.0329974]
Stock Position:  0.03299739897581835
Bond Position:  [5.79762474]


portfolio before change:  [9.27528191]
curr_Stock_Price:  105.38087597567932
curr_Factors:  [105.38087598]
mat_Sqrt:  [[0.15]]
grads:  [-0.10032888]
Stock Position:  -0.10032887960283551
Bond Position:  [19.84802713]


portfolio before change:  [9.340183]
curr_Stock_Price:  104.74635727517845
curr_Factors:  [104.74635728]
mat_Sqrt:  [[0.15]]
grads:  [-0.10108327]
Stock Position:  -0.10108326537938943
Bond Position:  [19.92828683]


portfolio before change:  [9.3599208]
curr_Stock_Price:  104.56341653721604
curr_Factors:  [104.56341654]
mat_Sqrt:  [[0.15]]
grads:  [0.00606962]
Stock Position:  0.006069618714771799
Bond Position:  [8.72526073]


portfolio before change:  [9.36337246]
curr_Stock_Price:  105.04224605133395
curr_Factors:  [105.04224605]
mat_Sqrt:  [[0.15]]
grads:  [-0.00204714]
Stock Position:  -0.002047140478685118
Bond Position:  [9.5784087]


portfolio before change:  [9.36320338]
curr_Stock_Price:  105.41728019218053
curr_Factors:  [105.41728019]
mat_Sqrt:  [[0.15]]
grads:  [-0.14582198]
Stock Position:  -0.14582198080029482
Bond Position:  [24.73535999]


portfolio before change:  [9.32372942]
curr_Stock_Price:  105.69858191671563
curr_Factors:  [105.69858192]
mat_Sqrt:  [[0.15]]
grads:  [-0.03090611]
Stock Position:  -0.030906107169382278
Bond Position:  [12.59046112]


portfolio before change:  [9.31617176]
curr_Stock_Price:  105.96857994687541
curr_Factors:  [105.96857995]
mat_Sqrt:  [[0.15]]
grads:  [0.0989272]
Stock Position:  0.0989272029408146
Bond Position:  [-1.16700346]


portfolio before change:  [9.34806999]
curr_Stock_Price:  106.29175873145991
curr_Factors:  [106.29175873]
mat_Sqrt:  [[0.15]]
grads:  [0.18495357]
Stock Position:  0.184953571757569
Bond Position:  [-10.31097043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.36589498]
Stock Price:  106.39161860844185
PL:  [2.97427637]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.06278174e-03]
 [ 7.12941682e-03]
 [ 7.83289627e-03]
 [-7.45071126e-03]
 [ 1.09451986e-02]
 [-1.45306324e-02]
 [-7.74168019e-03]
 [ 2.88604666e-03]
 [-1.39190353e-02]
 [-1.12491145e-02]
 [ 1.39260021e-02]
 [-7.09884916e-03]
 [-7.71514566e-04]
 [ 8.22642114e-03]
 [ 4.22653127e-04]
 [ 1.34747213e-02]
 [ 4.01422751e-02]
 [-1.47184290e-02]
 [ 2.01344160e-02]
 [ 2.49631692e-03]
 [-4.28162957e-03]
 [ 5.05629790e-03]
 [ 1.52508087e-02]
 [ 1.77207199e-02]
 [-5.66783930e-03]
 [ 4.54473962e-03]
 [ 1.03779483e-02]
 [ 8.94384028e-03]
 [ 1.59234562e-02]
 [ 2.77017742e-03]
 [-6.93832886e-03]
 [ 9.94125811e-03]
 [ 1.16082147e-02]
 [-1.65526721e-02]
 [ 1.62447844e-03]
 [ 1.81998112e-02]
 [ 4.91561818e-03]
 [ 2.48785570e-03]
 [-3.29797360e-02]
 [-1.42112302e-02]
 [ 7.20162241e-03]
 [ 2.13929305e-02]
 [-2.48732512e-03]
 [ 2.30834532e-03]
 [-1.80375810e-02]
 [ 1.84998932e-02]
 [ 1.01843575e-02]
 [ 5.30302409e-03]
 [-7.51854346e-03]
 [-2.78497937e-04]
 [-3.76902935e-03]
 [ 1.08614078e-03]
 [ 8.47254786e-04]
 [ 5.72777003e-03]
 [-8.84377053e-03]
 [-4.51829866e-03]
 [-3.27429658e-04]
 [ 1.21252316e-02]
 [ 8.23962413e-03]
 [-3.59034624e-03]
 [-3.73051997e-03]
 [-2.49388022e-04]
 [-5.68179106e-03]
 [ 2.55485109e-03]
 [ 1.98962845e-02]
 [ 5.47502284e-03]
 [ 7.69617475e-03]
 [-3.65329707e-04]
 [ 2.80477867e-03]
 [ 2.08562744e-02]
 [ 7.73620715e-04]
 [-1.59651742e-02]
 [-3.60742959e-03]
 [ 1.21486594e-03]
 [ 3.18740421e-03]
 [-5.17876791e-04]
 [-1.41718545e-03]
 [ 6.21834209e-03]
 [-2.44304168e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.32727964]
curr_Stock_Price:  100.33143150524822
curr_Factors:  [100.33143151]
mat_Sqrt:  [[0.15]]
grads:  [-0.02041854]
Stock Position:  -0.02041854496165317
Bond Position:  [11.37590149]


portfolio before change:  [9.33816889]
curr_Stock_Price:  99.83295155287341
curr_Factors:  [99.83295155]
mat_Sqrt:  [[0.15]]
grads:  [0.04752945]
Stock Position:  0.04752944545552072
Bond Position:  [4.59316407]


portfolio before change:  [9.35751458]
curr_Stock_Price:  100.2339368104299
curr_Factors:  [100.23393681]
mat_Sqrt:  [[0.15]]
grads:  [0.05221931]
Stock Position:  0.05221930848485344
Bond Position:  [4.12336771]


portfolio before change:  [9.34710433]
curr_Stock_Price:  100.02964507503394
curr_Factors:  [100.02964508]
mat_Sqrt:  [[0.15]]
grads:  [-0.04967141]
Stock Position:  -0.04967140839937034
Bond Position:  [14.31571768]


portfolio before change:  [9.40807647]
curr_Stock_Price:  98.82014883706202
curr_Factors:  [98.82014884]
mat_Sqrt:  [[0.15]]
grads:  [0.07296799]
Stock Position:  0.07296799069958683
Bond Position:  [2.19736877]


portfolio before change:  [9.39112428]
curr_Stock_Price:  98.58594297495432
curr_Factors:  [98.58594297]
mat_Sqrt:  [[0.15]]
grads:  [-0.09687088]
Stock Position:  -0.09687088276369299
Bond Position:  [18.9412316]


portfolio before change:  [9.35464368]
curr_Stock_Price:  98.97475394679228
curr_Factors:  [98.97475395]
mat_Sqrt:  [[0.15]]
grads:  [-0.0516112]
Stock Position:  -0.05161120129579365
Bond Position:  [14.46284963]


portfolio before change:  [9.33827008]
curr_Stock_Price:  99.30951759912978
curr_Factors:  [99.3095176]
mat_Sqrt:  [[0.15]]
grads:  [0.01924031]
Stock Position:  0.019240311061764794
Bond Position:  [7.42752407]


portfolio before change:  [9.33894199]
curr_Stock_Price:  99.3203111357086
curr_Factors:  [99.32031114]
mat_Sqrt:  [[0.15]]
grads:  [-0.09279357]
Stock Position:  -0.0927935687680751
Bond Position:  [18.55522811]


portfolio before change:  [9.35454345]
curr_Stock_Price:  99.16467837249385
curr_Factors:  [99.16467837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0749941]
Stock Position:  -0.07499409678477689
Bond Position:  [16.79130893]


portfolio before change:  [9.32981491]
curr_Stock_Price:  99.50841240235863
curr_Factors:  [99.5084124]
mat_Sqrt:  [[0.15]]
grads:  [0.09284001]
Stock Position:  0.09284001366721238
Bond Position:  [0.09145254]


portfolio before change:  [9.29785243]
curr_Stock_Price:  99.1640760076549
curr_Factors:  [99.16407601]
mat_Sqrt:  [[0.15]]
grads:  [-0.04732566]
Stock Position:  -0.04732566103842494
Bond Position:  [13.99085788]


portfolio before change:  [9.2928055]
curr_Stock_Price:  99.28919609709511
curr_Factors:  [99.2891961]
mat_Sqrt:  [[0.15]]
grads:  [-0.00514343]
Stock Position:  -0.005143430442860394
Bond Position:  [9.80349257]


portfolio before change:  [9.29150478]
curr_Stock_Price:  99.66121502572746
curr_Factors:  [99.66121503]
mat_Sqrt:  [[0.15]]
grads:  [0.05484281]
Stock Position:  0.05484280760501872
Bond Position:  [3.82580394]


portfolio before change:  [9.29183406]
curr_Stock_Price:  99.6628589734653
curr_Factors:  [99.66285897]
mat_Sqrt:  [[0.15]]
grads:  [0.00281769]
Stock Position:  0.002817687515813093
Bond Position:  [9.01101527]


portfolio before change:  [9.2938016]
curr_Stock_Price:  100.16125780968642
curr_Factors:  [100.16125781]
mat_Sqrt:  [[0.15]]
grads:  [0.08983148]
Stock Position:  0.08983147532649692
Bond Position:  [0.29616804]


portfolio before change:  [9.31572074]
curr_Stock_Price:  100.4050546796258
curr_Factors:  [100.40505468]
mat_Sqrt:  [[0.15]]
grads:  [0.26761517]
Stock Position:  0.2676151672183531
Bond Position:  [-17.55419476]


portfolio before change:  [9.26656451]
curr_Stock_Price:  100.22547195082731
curr_Factors:  [100.22547195]
mat_Sqrt:  [[0.15]]
grads:  [-0.09812286]
Stock Position:  -0.0981228601712144
Bond Position:  [19.10097448]


portfolio before change:  [9.29975611]
curr_Stock_Price:  99.89937312012141
curr_Factors:  [99.89937312]
mat_Sqrt:  [[0.15]]
grads:  [0.13422944]
Stock Position:  0.13422944029680664
Bond Position:  [-4.10968083]


portfolio before change:  [9.35554483]
curr_Stock_Price:  100.31690885228247
curr_Factors:  [100.31690885]
mat_Sqrt:  [[0.15]]
grads:  [0.01664211]
Stock Position:  0.0166421127984915
Bond Position:  [7.68605952]


portfolio before change:  [9.35512884]
curr_Stock_Price:  100.26304653359462
curr_Factors:  [100.26304653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0285442]
Stock Position:  -0.02854419710202985
Bond Position:  [12.217057]


portfolio before change:  [9.38473035]
curr_Stock_Price:  99.25275642918258
curr_Factors:  [99.25275643]
mat_Sqrt:  [[0.15]]
grads:  [0.03370865]
Stock Position:  0.03370865265513325
Bond Position:  [6.03905366]


portfolio before change:  [9.41300896]
curr_Stock_Price:  100.08047129537009
curr_Factors:  [100.0804713]
mat_Sqrt:  [[0.15]]
grads:  [0.10167206]
Stock Position:  0.10167205831878816
Bond Position:  [-0.76237856]


portfolio before change:  [9.35109673]
curr_Stock_Price:  99.47199951256052
curr_Factors:  [99.47199951]
mat_Sqrt:  [[0.15]]
grads:  [0.11813813]
Stock Position:  0.11813813259915487
Bond Position:  [-2.40033954]


portfolio before change:  [9.27917507]
curr_Stock_Price:  98.86447649383338
curr_Factors:  [98.86447649]
mat_Sqrt:  [[0.15]]
grads:  [-0.0377856]
Stock Position:  -0.03778559533978974
Bond Position:  [13.01482817]


portfolio before change:  [9.30092964]
curr_Stock_Price:  98.31026747678376
curr_Factors:  [98.31026748]
mat_Sqrt:  [[0.15]]
grads:  [0.03029826]
Stock Position:  0.030298264110319238
Bond Position:  [6.32229919]


portfolio before change:  [9.31240471]
curr_Stock_Price:  98.67596229459983
curr_Factors:  [98.67596229]
mat_Sqrt:  [[0.15]]
grads:  [0.06918632]
Stock Position:  0.06918632226021253
Bond Position:  [2.48537779]


portfolio before change:  [9.27742459]
curr_Stock_Price:  98.16812399533015
curr_Factors:  [98.168124]
mat_Sqrt:  [[0.15]]
grads:  [0.0596256]
Stock Position:  0.05962560186316799
Bond Position:  [3.42409111]


portfolio before change:  [9.27012922]
curr_Stock_Price:  98.04218181033234
curr_Factors:  [98.04218181]
mat_Sqrt:  [[0.15]]
grads:  [0.10615637]
Stock Position:  0.10615637444315268
Bond Position:  [-1.13767334]


portfolio before change:  [9.35057828]
curr_Stock_Price:  98.80068704819824
curr_Factors:  [98.80068705]
mat_Sqrt:  [[0.15]]
grads:  [0.01846785]
Stock Position:  0.018467849459212184
Bond Position:  [7.52594207]


portfolio before change:  [9.36502775]
curr_Stock_Price:  99.55762836458233
curr_Factors:  [99.55762836]
mat_Sqrt:  [[0.15]]
grads:  [-0.04625553]
Stock Position:  -0.04625552571653015
Bond Position:  [13.97011818]


portfolio before change:  [9.36143769]
curr_Stock_Price:  99.65411873329846
curr_Factors:  [99.65411873]
mat_Sqrt:  [[0.15]]
grads:  [0.06627505]
Stock Position:  0.06627505406441839
Bond Position:  [2.75685559]


portfolio before change:  [9.32354888]
curr_Stock_Price:  99.07982842913799
curr_Factors:  [99.07982843]
mat_Sqrt:  [[0.15]]
grads:  [0.0773881]
Stock Position:  0.07738809813859464
Bond Position:  [1.65594939]


portfolio before change:  [9.29804867]
curr_Stock_Price:  98.74898030111298
curr_Factors:  [98.7489803]
mat_Sqrt:  [[0.15]]
grads:  [-0.11035115]
Stock Position:  -0.11035114759781195
Bond Position:  [20.19511197]


portfolio before change:  [9.26547702]
curr_Stock_Price:  99.0555823453222
curr_Factors:  [99.05558235]
mat_Sqrt:  [[0.15]]
grads:  [0.01082986]
Stock Position:  0.010829856281760345
Bond Position:  [8.1927193]


portfolio before change:  [9.25749693]
curr_Stock_Price:  98.27144016100603
curr_Factors:  [98.27144016]
mat_Sqrt:  [[0.15]]
grads:  [0.12133207]
Stock Position:  0.12133207490769567
Bond Position:  [-2.66598081]


portfolio before change:  [9.21114692]
curr_Stock_Price:  97.89080392038798
curr_Factors:  [97.89080392]
mat_Sqrt:  [[0.15]]
grads:  [0.03277079]
Stock Position:  0.03277078784559831
Bond Position:  [6.00318815]


portfolio before change:  [9.24815347]
curr_Stock_Price:  99.0086086696616
curr_Factors:  [99.00860867]
mat_Sqrt:  [[0.15]]
grads:  [0.0165857]
Stock Position:  0.016585704633474453
Bond Position:  [7.60602593]


portfolio before change:  [9.24289135]
curr_Stock_Price:  98.66267730312468
curr_Factors:  [98.6626773]
mat_Sqrt:  [[0.15]]
grads:  [-0.21986491]
Stock Position:  -0.219864906364107
Bond Position:  [30.93535166]


portfolio before change:  [9.13894917]
curr_Stock_Price:  99.1442261896175
curr_Factors:  [99.14422619]
mat_Sqrt:  [[0.15]]
grads:  [-0.09474153]
Stock Position:  -0.0947415343532628
Bond Position:  [18.53202528]


portfolio before change:  [9.11452572]
curr_Stock_Price:  99.41424222027081
curr_Factors:  [99.41424222]
mat_Sqrt:  [[0.15]]
grads:  [0.04801082]
Stock Position:  0.04801081608856679
Bond Position:  [4.34156682]


portfolio before change:  [9.07432888]
curr_Stock_Price:  98.57134462471075
curr_Factors:  [98.57134462]
mat_Sqrt:  [[0.15]]
grads:  [0.14261954]
Stock Position:  0.14261953644839825
Bond Position:  [-4.9838706]


portfolio before change:  [9.08203687]
curr_Stock_Price:  98.62757460108506
curr_Factors:  [98.6275746]
mat_Sqrt:  [[0.15]]
grads:  [-0.01658217]
Stock Position:  -0.016582167464069743
Bond Position:  [10.71749583]


portfolio before change:  [9.09227318]
curr_Stock_Price:  98.0506628817011
curr_Factors:  [98.05066288]
mat_Sqrt:  [[0.15]]
grads:  [0.01538897]
Stock Position:  0.0153889688021549
Bond Position:  [7.58337459]


portfolio before change:  [9.08183299]
curr_Stock_Price:  97.34144296208756
curr_Factors:  [97.34144296]
mat_Sqrt:  [[0.15]]
grads:  [-0.12025054]
Stock Position:  -0.12025053994364625
Bond Position:  [20.78719407]


portfolio before change:  [9.10550846]
curr_Stock_Price:  97.15536293718064
curr_Factors:  [97.15536294]
mat_Sqrt:  [[0.15]]
grads:  [0.12333262]
Stock Position:  0.12333262161372624
Bond Position:  [-2.87691716]


portfolio before change:  [9.18782836]
curr_Stock_Price:  97.82428345249772
curr_Factors:  [97.82428345]
mat_Sqrt:  [[0.15]]
grads:  [0.06789572]
Stock Position:  0.0678957163644745
Bond Position:  [2.54597856]


portfolio before change:  [9.14485749]
curr_Stock_Price:  97.18904448795936
curr_Factors:  [97.18904449]
mat_Sqrt:  [[0.15]]
grads:  [0.03535349]
Stock Position:  0.03535349391680895
Bond Position:  [5.7088852]


portfolio before change:  [9.15036226]
curr_Stock_Price:  97.33465838130681
curr_Factors:  [97.33465838]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012362]
Stock Position:  -0.05012362307713914
Bond Position:  [14.02912799]


portfolio before change:  [9.17894963]
curr_Stock_Price:  96.78181489186997
curr_Factors:  [96.78181489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00185665]
Stock Position:  -0.0018566529110489443
Bond Position:  [9.35863987]


portfolio before change:  [9.17988839]
curr_Stock_Price:  96.59124132777484
curr_Factors:  [96.59124133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02512686]
Stock Position:  -0.025126862344582817
Bond Position:  [11.60692322]


portfolio before change:  [9.16126951]
curr_Stock_Price:  97.36110819981184
curr_Factors:  [97.3611082]
mat_Sqrt:  [[0.15]]
grads:  [0.00724094]
Stock Position:  0.007240938550829359
Bond Position:  [8.45628371]


portfolio before change:  [9.16378076]
curr_Stock_Price:  97.63492817318549
curr_Factors:  [97.63492817]
mat_Sqrt:  [[0.15]]
grads:  [0.00564837]
Stock Position:  0.005648365238737182
Bond Position:  [8.61230302]


portfolio before change:  [9.16325136]
curr_Stock_Price:  97.44590353705252
curr_Factors:  [97.44590354]
mat_Sqrt:  [[0.15]]
grads:  [0.03818513]
Stock Position:  0.03818513353190809
Bond Position:  [5.44226652]


portfolio before change:  [9.17783723]
curr_Stock_Price:  97.8189732532831
curr_Factors:  [97.81897325]
mat_Sqrt:  [[0.15]]
grads:  [-0.05895847]
Stock Position:  -0.05895847022895147
Bond Position:  [14.94509426]


portfolio before change:  [9.15373957]
curr_Stock_Price:  98.24353920127663
curr_Factors:  [98.2435392]
mat_Sqrt:  [[0.15]]
grads:  [-0.03012199]
Stock Position:  -0.030121991056953693
Bond Position:  [12.11303058]


portfolio before change:  [9.15885537]
curr_Stock_Price:  98.09883736712534
curr_Factors:  [98.09883737]
mat_Sqrt:  [[0.15]]
grads:  [-0.00218286]
Stock Position:  -0.002182864383502801
Bond Position:  [9.37299183]


portfolio before change:  [9.16066496]
curr_Stock_Price:  97.53821357450558
curr_Factors:  [97.53821357]
mat_Sqrt:  [[0.15]]
grads:  [0.08083488]
Stock Position:  0.08083487706636275
Bond Position:  [1.27617546]


portfolio before change:  [9.17879861]
curr_Stock_Price:  97.7615563101199
curr_Factors:  [97.76155631]
mat_Sqrt:  [[0.15]]
grads:  [0.05493083]
Stock Position:  0.05493082754283951
Bond Position:  [3.80867542]


portfolio before change:  [9.17167622]
curr_Stock_Price:  97.62756162226542
curr_Factors:  [97.62756162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393564]
Stock Position:  -0.023935641627166864
Bond Position:  [11.50845455]


portfolio before change:  [9.1605995]
curr_Stock_Price:  98.12038392462543
curr_Factors:  [98.12038392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487013]
Stock Position:  -0.024870133130518453
Bond Position:  [11.60086651]


portfolio before change:  [9.16915303]
curr_Stock_Price:  97.80561093662891
curr_Factors:  [97.80561094]
mat_Sqrt:  [[0.15]]
grads:  [-0.00166259]
Stock Position:  -0.0016625868127082
Bond Position:  [9.33176334]


portfolio before change:  [9.16930794]
curr_Stock_Price:  98.06324256223651
curr_Factors:  [98.06324256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03787861]
Stock Position:  -0.03787860707694906
Bond Position:  [12.88380698]


portfolio before change:  [9.14788338]
curr_Stock_Price:  98.65011269083767
curr_Factors:  [98.65011269]
mat_Sqrt:  [[0.15]]
grads:  [0.01703234]
Stock Position:  0.01703234059299589
Bond Position:  [7.46764107]


portfolio before change:  [9.16199822]
curr_Stock_Price:  99.45141730678839
curr_Factors:  [99.45141731]
mat_Sqrt:  [[0.15]]
grads:  [0.1326419]
Stock Position:  0.13264189675514734
Bond Position:  [-4.02942641]


portfolio before change:  [9.22504098]
curr_Stock_Price:  99.92860140082837
curr_Factors:  [99.9286014]
mat_Sqrt:  [[0.15]]
grads:  [0.03650015]
Stock Position:  0.03650015225952384
Bond Position:  [5.57763181]


portfolio before change:  [9.23683807]
curr_Stock_Price:  100.24225716604161
curr_Factors:  [100.24225717]
mat_Sqrt:  [[0.15]]
grads:  [0.05130783]
Stock Position:  0.05130783166446255
Bond Position:  [4.09362522]


portfolio before change:  [9.1960102]
curr_Stock_Price:  99.44152688367717
curr_Factors:  [99.44152688]
mat_Sqrt:  [[0.15]]
grads:  [-0.00243553]
Stock Position:  -0.0024355313796029362
Bond Position:  [9.43820316]


portfolio before change:  [9.19689855]
curr_Stock_Price:  99.31898900451331
curr_Factors:  [99.318989]
mat_Sqrt:  [[0.15]]
grads:  [0.01869852]
Stock Position:  0.01869852445868931
Bond Position:  [7.33978]


portfolio before change:  [9.21765926]
curr_Stock_Price:  100.40474099597643
curr_Factors:  [100.404741]
mat_Sqrt:  [[0.15]]
grads:  [0.13904183]
Stock Position:  0.13904182961154102
Bond Position:  [-4.74279963]


portfolio before change:  [9.17873612]
curr_Stock_Price:  100.1269346677617
curr_Factors:  [100.12693467]
mat_Sqrt:  [[0.15]]
grads:  [0.00515747]
Stock Position:  0.005157471436395631
Bond Position:  [8.66233432]


portfolio before change:  [9.18160779]
curr_Stock_Price:  100.57875541396685
curr_Factors:  [100.57875541]
mat_Sqrt:  [[0.15]]
grads:  [-0.10643449]
Stock Position:  -0.10643449481735498
Bond Position:  [19.88665681]


portfolio before change:  [9.2524458]
curr_Stock_Price:  99.9248785037171
curr_Factors:  [99.9248785]
mat_Sqrt:  [[0.15]]
grads:  [-0.02404953]
Stock Position:  -0.024049530604919163
Bond Position:  [11.65559223]


portfolio before change:  [9.25971664]
curr_Stock_Price:  99.65284234831435
curr_Factors:  [99.65284235]
mat_Sqrt:  [[0.15]]
grads:  [0.00809911]
Stock Position:  0.008099106297428209
Bond Position:  [8.45261768]


portfolio before change:  [9.25587805]
curr_Stock_Price:  99.11365951111726
curr_Factors:  [99.11365951]
mat_Sqrt:  [[0.15]]
grads:  [0.02124936]
Stock Position:  0.021249361407198922
Bond Position:  [7.14977608]


portfolio before change:  [9.24977981]
curr_Stock_Price:  98.80564496287356
curr_Factors:  [98.80564496]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345251]
Stock Position:  -0.003452511940062123
Bond Position:  [9.59090748]


portfolio before change:  [9.24999609]
curr_Stock_Price:  98.91662965020141
curr_Factors:  [98.91662965]
mat_Sqrt:  [[0.15]]
grads:  [-0.0094479]
Stock Position:  -0.009447903026981418
Bond Position:  [10.18455081]


portfolio before change:  [9.24527659]
curr_Stock_Price:  99.4835332759783
curr_Factors:  [99.48353328]
mat_Sqrt:  [[0.15]]
grads:  [0.04145561]
Stock Position:  0.04145561396274093
Bond Position:  [5.12112564]


portfolio before change:  [9.23309406]
curr_Stock_Price:  99.18194310699418
curr_Factors:  [99.18194311]
mat_Sqrt:  [[0.15]]
grads:  [-0.16286945]
Stock Position:  -0.1628694452769873
Bond Position:  [25.38680212]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.18791968]
Stock Price:  99.469051018962
PL:  [9.18791968]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.76110143e-03]
 [ 4.07271409e-02]
 [ 1.86365000e-02]
 [-3.24278586e-02]
 [-3.46756032e-02]
 [-1.25432980e-03]
 [ 1.39957078e-04]
 [-4.22377696e-02]
 [ 1.73009754e-02]
 [-7.46378859e-03]
 [-1.15639000e-02]
 [ 1.99290011e-02]
 [-4.49131968e-03]
 [ 4.35030319e-03]
 [ 3.51836419e-03]
 [ 1.17849441e-02]
 [ 9.54379230e-02]
 [-1.16573747e-02]
 [ 2.23810172e-02]
 [ 1.00365203e-03]
 [-5.42200857e-03]
 [ 4.86968520e-03]
 [ 1.16663689e-02]
 [ 2.34117509e-02]
 [-8.62501584e-04]
 [ 7.85116718e-03]
 [-7.21854948e-03]
 [ 1.63701632e-02]
 [ 2.88701398e-02]
 [-8.43974558e-03]
 [-4.01916584e-03]
 [ 1.33871265e-02]
 [ 1.31231909e-02]
 [ 9.20435961e-03]
 [ 6.47761521e-03]
 [ 1.60668315e-02]
 [-2.80365634e-02]
 [ 2.79869894e-03]
 [-3.83810542e-02]
 [-1.24130580e-02]
 [ 3.85474262e-03]
 [ 1.07192479e-02]
 [-8.34077193e-03]
 [-2.81718385e-03]
 [ 8.83509956e-03]
 [ 1.22491934e-02]
 [ 1.05651054e-02]
 [-2.13927621e-04]
 [ 1.51382107e-02]
 [-1.17855085e-03]
 [ 1.93006009e-02]
 [-9.86929784e-03]
 [ 1.65345482e-03]
 [ 4.09602070e-04]
 [-3.60230555e-03]
 [-3.77994109e-03]
 [ 8.45425109e-03]
 [-4.10887674e-03]
 [ 6.64764075e-03]
 [-3.99798094e-03]
 [-1.15524492e-03]
 [ 8.23141714e-03]
 [-1.30220717e-02]
 [ 4.51904085e-03]
 [ 2.32498806e-02]
 [ 7.71901318e-03]
 [ 1.22680918e-02]
 [ 8.06618327e-03]
 [ 5.10655279e-03]
 [ 1.63843019e-02]
 [ 7.71863174e-04]
 [-1.55533430e-02]
 [-1.23934193e-03]
 [ 1.29704244e-03]
 [ 1.04127170e-03]
 [-1.38202791e-02]
 [-4.23582836e-03]
 [ 1.63652509e-02]
 [-1.24387011e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.56543064]
curr_Stock_Price:  100.9780991457535
curr_Factors:  [100.97809915]
mat_Sqrt:  [[0.15]]
grads:  [-0.04507401]
Stock Position:  -0.04507400952293847
Bond Position:  [28.11691845]


portfolio before change:  [23.56501]
curr_Stock_Price:  101.0264197178609
curr_Factors:  [101.02641972]
mat_Sqrt:  [[0.15]]
grads:  [0.27151427]
Stock Position:  0.27151427256674043
Bond Position:  [-3.86510485]


portfolio before change:  [23.65090355]
curr_Stock_Price:  101.3436594837662
curr_Factors:  [101.34365948]
mat_Sqrt:  [[0.15]]
grads:  [0.12424333]
Stock Position:  0.12424333318673028
Bond Position:  [11.0596295]


portfolio before change:  [23.68503455]
curr_Stock_Price:  101.61280673930082
curr_Factors:  [101.61280674]
mat_Sqrt:  [[0.15]]
grads:  [-0.21618572]
Stock Position:  -0.2161857238824502
Bond Position:  [45.65227273]


portfolio before change:  [23.71642701]
curr_Stock_Price:  101.48079476295169
curr_Factors:  [101.48079476]
mat_Sqrt:  [[0.15]]
grads:  [-0.23117069]
Stock Position:  -0.23117068808600177
Bond Position:  [47.17581217]


portfolio before change:  [23.69237707]
curr_Stock_Price:  101.59758519150057
curr_Factors:  [101.59758519]
mat_Sqrt:  [[0.15]]
grads:  [-0.0083622]
Stock Position:  -0.008362198638174204
Bond Position:  [24.54195626]


portfolio before change:  [23.69383536]
curr_Stock_Price:  101.6066299352797
curr_Factors:  [101.60662994]
mat_Sqrt:  [[0.15]]
grads:  [0.00093305]
Stock Position:  0.0009330471865226161
Bond Position:  [23.59903158]


portfolio before change:  [23.69557092]
curr_Stock_Price:  101.88590458918024
curr_Factors:  [101.88590459]
mat_Sqrt:  [[0.15]]
grads:  [-0.28158513]
Stock Position:  -0.2815851308436848
Bond Position:  [52.38512669]


portfolio before change:  [23.49879346]
curr_Stock_Price:  102.59635273871662
curr_Factors:  [102.59635274]
mat_Sqrt:  [[0.15]]
grads:  [0.11533984]
Stock Position:  0.11533983588702251
Bond Position:  [11.66534697]


portfolio before change:  [23.49815132]
curr_Stock_Price:  102.58446401327605
curr_Factors:  [102.58446401]
mat_Sqrt:  [[0.15]]
grads:  [-0.04975859]
Stock Position:  -0.04975859060469234
Bond Position:  [28.60260967]


portfolio before change:  [23.49143754]
curr_Stock_Price:  102.75531884917642
curr_Factors:  [102.75531885]
mat_Sqrt:  [[0.15]]
grads:  [-0.07709267]
Stock Position:  -0.07709266696212874
Bond Position:  [31.41311912]


portfolio before change:  [23.49121083]
curr_Stock_Price:  102.78372738834153
curr_Factors:  [102.78372739]
mat_Sqrt:  [[0.15]]
grads:  [0.13286001]
Stock Position:  0.13286000753440844
Bond Position:  [9.83536404]


portfolio before change:  [23.46359648]
curr_Stock_Price:  102.57125502708861
curr_Factors:  [102.57125503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994213]
Stock Position:  -0.02994213119134706
Bond Position:  [26.53479846]


portfolio before change:  [23.49231519]
curr_Stock_Price:  101.66750407852675
curr_Factors:  [101.66750408]
mat_Sqrt:  [[0.15]]
grads:  [0.02900202]
Stock Position:  0.029002021257909343
Bond Position:  [20.54375208]


portfolio before change:  [23.49879116]
curr_Stock_Price:  101.84652423391971
curr_Factors:  [101.84652423]
mat_Sqrt:  [[0.15]]
grads:  [0.02345576]
Stock Position:  0.023455761273920024
Bond Position:  [21.1099034]


portfolio before change:  [23.5044031]
curr_Stock_Price:  102.02952947387247
curr_Factors:  [102.02952947]
mat_Sqrt:  [[0.15]]
grads:  [0.07856629]
Stock Position:  0.0785662936994149
Bond Position:  [15.48832112]


portfolio before change:  [23.50716776]
curr_Stock_Price:  102.05239692092181
curr_Factors:  [102.05239692]
mat_Sqrt:  [[0.15]]
grads:  [0.63625282]
Stock Position:  0.6362528198427602
Bond Position:  [-41.42395755]


portfolio before change:  [23.72819376]
curr_Stock_Price:  102.40385324028539
curr_Factors:  [102.40385324]
mat_Sqrt:  [[0.15]]
grads:  [-0.07771583]
Stock Position:  -0.07771583148135396
Bond Position:  [31.68659436]


portfolio before change:  [23.72538432]
curr_Stock_Price:  102.46548685335664
curr_Factors:  [102.46548685]
mat_Sqrt:  [[0.15]]
grads:  [0.14920678]
Stock Position:  0.1492067816360339
Bond Position:  [8.4368388]


portfolio before change:  [23.69121823]
curr_Stock_Price:  102.2329678841509
curr_Factors:  [102.23296788]
mat_Sqrt:  [[0.15]]
grads:  [0.00669101]
Stock Position:  0.006691013502978594
Bond Position:  [23.00717607]


portfolio before change:  [23.69293707]
curr_Stock_Price:  102.27494036231849
curr_Factors:  [102.27494036]
mat_Sqrt:  [[0.15]]
grads:  [-0.03614672]
Stock Position:  -0.03614672378837493
Bond Position:  [27.38984109]


portfolio before change:  [23.71089737]
curr_Stock_Price:  101.82542845109388
curr_Factors:  [101.82542845]
mat_Sqrt:  [[0.15]]
grads:  [0.03246457]
Stock Position:  0.032464568020925316
Bond Position:  [20.40517882]


portfolio before change:  [23.70869478]
curr_Stock_Price:  101.7182978763702
curr_Factors:  [101.71829788]
mat_Sqrt:  [[0.15]]
grads:  [0.07777579]
Stock Position:  0.07777579265317648
Bond Position:  [15.79747354]


portfolio before change:  [23.70445076]
curr_Stock_Price:  101.65103531742412
curr_Factors:  [101.65103532]
mat_Sqrt:  [[0.15]]
grads:  [0.15607834]
Stock Position:  0.156078339391674
Bond Position:  [7.83892597]


portfolio before change:  [23.72413963]
curr_Stock_Price:  101.77404357746978
curr_Factors:  [101.77404358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00575001]
Stock Position:  -0.005750010556963189
Bond Position:  [24.30934146]


portfolio before change:  [23.72510511]
curr_Stock_Price:  101.87037470764456
curr_Factors:  [101.87037471]
mat_Sqrt:  [[0.15]]
grads:  [0.05234111]
Stock Position:  0.052341114556316425
Bond Position:  [18.39309615]


portfolio before change:  [23.6978341]
curr_Stock_Price:  101.32738650896125
curr_Factors:  [101.32738651]
mat_Sqrt:  [[0.15]]
grads:  [-0.04812366]
Stock Position:  -0.04812366323067238
Bond Position:  [28.57407913]


portfolio before change:  [23.65719085]
curr_Stock_Price:  102.209056393458
curr_Factors:  [102.20905639]
mat_Sqrt:  [[0.15]]
grads:  [0.10913442]
Stock Position:  0.10913442149075482
Bond Position:  [12.50266461]


portfolio before change:  [23.62453968]
curr_Stock_Price:  101.9027129635183
curr_Factors:  [101.90271296]
mat_Sqrt:  [[0.15]]
grads:  [0.1924676]
Stock Position:  0.1924675986771327
Bond Position:  [4.01156922]


portfolio before change:  [23.73129253]
curr_Stock_Price:  102.4560638394694
curr_Factors:  [102.45606384]
mat_Sqrt:  [[0.15]]
grads:  [-0.05626497]
Stock Position:  -0.05626497052396681
Bond Position:  [29.49597994]


portfolio before change:  [23.78160755]
curr_Stock_Price:  101.59457815898487
curr_Factors:  [101.59457816]
mat_Sqrt:  [[0.15]]
grads:  [-0.02679444]
Stock Position:  -0.026794438904787343
Bond Position:  [26.50377727]


portfolio before change:  [23.78231056]
curr_Stock_Price:  101.63016489108338
curr_Factors:  [101.63016489]
mat_Sqrt:  [[0.15]]
grads:  [0.08924751]
Stock Position:  0.08924751011882155
Bond Position:  [14.71207139]


portfolio before change:  [23.81108287]
curr_Stock_Price:  101.94224946676043
curr_Factors:  [101.94224947]
mat_Sqrt:  [[0.15]]
grads:  [0.08748794]
Stock Position:  0.08748793946165329
Bond Position:  [14.89236552]


portfolio before change:  [23.7305398]
curr_Stock_Price:  101.01099122757849
curr_Factors:  [101.01099123]
mat_Sqrt:  [[0.15]]
grads:  [0.0613624]
Stock Position:  0.061362397378234734
Bond Position:  [17.53226322]


portfolio before change:  [23.79158916]
curr_Stock_Price:  101.98803178889901
curr_Factors:  [101.98803179]
mat_Sqrt:  [[0.15]]
grads:  [0.0431841]
Stock Position:  0.0431841013796303
Bond Position:  [19.38732765]


portfolio before change:  [23.77459767]
curr_Stock_Price:  101.56650557686764
curr_Factors:  [101.56650558]
mat_Sqrt:  [[0.15]]
grads:  [0.10711221]
Stock Position:  0.10711221031389276
Bond Position:  [12.89558476]


portfolio before change:  [23.76743789]
curr_Stock_Price:  101.49213705463767
curr_Factors:  [101.49213705]
mat_Sqrt:  [[0.15]]
grads:  [-0.18691042]
Stock Position:  -0.18691042294731283
Bond Position:  [42.73737616]


portfolio before change:  [23.81607073]
curr_Stock_Price:  101.24623493397574
curr_Factors:  [101.24623493]
mat_Sqrt:  [[0.15]]
grads:  [0.01865799]
Stock Position:  0.01865799290372772
Bond Position:  [21.9270192]


portfolio before change:  [23.8293599]
curr_Stock_Price:  101.885032672528
curr_Factors:  [101.88503267]
mat_Sqrt:  [[0.15]]
grads:  [-0.25587369]
Stock Position:  -0.2558736944310383
Bond Position:  [49.89905961]


portfolio before change:  [23.77896747]
curr_Stock_Price:  102.09416402504303
curr_Factors:  [102.09416403]
mat_Sqrt:  [[0.15]]
grads:  [-0.08275372]
Stock Position:  -0.08275372004723033
Bond Position:  [32.22763934]


portfolio before change:  [23.70390241]
curr_Stock_Price:  103.02559472212556
curr_Factors:  [103.02559472]
mat_Sqrt:  [[0.15]]
grads:  [0.02569828]
Stock Position:  0.025698284146016576
Bond Position:  [21.0563214]


portfolio before change:  [23.6919491]
curr_Stock_Price:  102.50924224512698
curr_Factors:  [102.50924225]
mat_Sqrt:  [[0.15]]
grads:  [0.07146165]
Stock Position:  0.07146165247927465
Bond Position:  [16.36646925]


portfolio before change:  [23.7224599]
curr_Stock_Price:  102.92188118573112
curr_Factors:  [102.92188119]
mat_Sqrt:  [[0.15]]
grads:  [-0.05560515]
Stock Position:  -0.05560514620252848
Bond Position:  [29.44544615]


portfolio before change:  [23.77131528]
curr_Stock_Price:  102.0763662083961
curr_Factors:  [102.07636621]
mat_Sqrt:  [[0.15]]
grads:  [-0.01878123]
Stock Position:  -0.018781225667338548
Bond Position:  [25.68843455]


portfolio before change:  [23.76255379]
curr_Stock_Price:  102.62835728976557
curr_Factors:  [102.62835729]
mat_Sqrt:  [[0.15]]
grads:  [0.05890066]
Stock Position:  0.05890066373151668
Bond Position:  [17.71767542]


portfolio before change:  [23.74516898]
curr_Stock_Price:  102.31440161760571
curr_Factors:  [102.31440162]
mat_Sqrt:  [[0.15]]
grads:  [0.08166129]
Stock Position:  0.08166128929643685
Bond Position:  [15.39004303]


portfolio before change:  [23.81601814]
curr_Stock_Price:  103.17022022413894
curr_Factors:  [103.17022022]
mat_Sqrt:  [[0.15]]
grads:  [0.07043404]
Stock Position:  0.07043403607224277
Bond Position:  [16.54932312]


portfolio before change:  [23.75516087]
curr_Stock_Price:  102.29150260645494
curr_Factors:  [102.29150261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142618]
Stock Position:  -0.0014261841407066697
Bond Position:  [23.90104739]


portfolio before change:  [23.75662436]
curr_Stock_Price:  102.31279925173892
curr_Factors:  [102.31279925]
mat_Sqrt:  [[0.15]]
grads:  [0.1009214]
Stock Position:  0.10092140473388224
Bond Position:  [13.43107294]


portfolio before change:  [23.74933615]
curr_Stock_Price:  102.23226453381496
curr_Factors:  [102.23226453]
mat_Sqrt:  [[0.15]]
grads:  [-0.00785701]
Stock Position:  -0.007857005692722378
Bond Position:  [24.55257564]


portfolio before change:  [23.75130535]
curr_Stock_Price:  102.17694935496324
curr_Factors:  [102.17694935]
mat_Sqrt:  [[0.15]]
grads:  [0.12867067]
Stock Position:  0.12867067277352834
Bond Position:  [10.60412853]


portfolio before change:  [23.77711265]
curr_Stock_Price:  102.37236703346439
curr_Factors:  [102.37236703]
mat_Sqrt:  [[0.15]]
grads:  [-0.06579532]
Stock Position:  -0.06579531890924528
Bond Position:  [30.51273519]


portfolio before change:  [23.83880056]
curr_Stock_Price:  101.46377956359812
curr_Factors:  [101.46377956]
mat_Sqrt:  [[0.15]]
grads:  [0.01102303]
Stock Position:  0.011023032103576658
Bond Position:  [22.72036206]


portfolio before change:  [23.83827121]
curr_Stock_Price:  101.2869303980217
curr_Factors:  [101.2869304]
mat_Sqrt:  [[0.15]]
grads:  [0.00273068]
Stock Position:  0.002730680464533957
Bond Position:  [23.56168897]


portfolio before change:  [23.83953254]
curr_Stock_Price:  101.20954256356389
curr_Factors:  [101.20954256]
mat_Sqrt:  [[0.15]]
grads:  [-0.02401537]
Stock Position:  -0.02401537035497763
Bond Position:  [26.27011719]


portfolio before change:  [23.85085511]
curr_Stock_Price:  100.80644082106956
curr_Factors:  [100.80644082]
mat_Sqrt:  [[0.15]]
grads:  [-0.02519961]
Stock Position:  -0.025199607290915537
Bond Position:  [26.39113783]


portfolio before change:  [23.85654258]
curr_Stock_Price:  100.64620140255028
curr_Factors:  [100.6462014]
mat_Sqrt:  [[0.15]]
grads:  [0.05636167]
Stock Position:  0.05636167393945072
Bond Position:  [18.1839542]


portfolio before change:  [23.89667184]
curr_Stock_Price:  101.3380318389366
curr_Factors:  [101.33803184]
mat_Sqrt:  [[0.15]]
grads:  [-0.02739251]
Stock Position:  -0.027392511572781796
Bond Position:  [26.67257505]


portfolio before change:  [23.88529197]
curr_Stock_Price:  101.81432839369222
curr_Factors:  [101.81432839]
mat_Sqrt:  [[0.15]]
grads:  [0.04431761]
Stock Position:  0.04431760500240005
Bond Position:  [19.37312478]


portfolio before change:  [23.87437672]
curr_Stock_Price:  101.54071028872825
curr_Factors:  [101.54071029]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665321]
Stock Position:  -0.02665320626937428
Bond Position:  [26.58076222]


portfolio before change:  [23.89337445]
curr_Stock_Price:  100.89026783099007
curr_Factors:  [100.89026783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00770163]
Stock Position:  -0.007701632794863695
Bond Position:  [24.67039425]


portfolio before change:  [23.88820436]
curr_Stock_Price:  101.7617761225579
curr_Factors:  [101.76177612]
mat_Sqrt:  [[0.15]]
grads:  [0.05487611]
Stock Position:  0.05487611429217189
Bond Position:  [18.3039135]


portfolio before change:  [23.87810965]
curr_Stock_Price:  101.55697404522732
curr_Factors:  [101.55697405]
mat_Sqrt:  [[0.15]]
grads:  [-0.08681381]
Stock Position:  -0.08681381103549514
Bond Position:  [32.6946576]


portfolio before change:  [23.83120519]
curr_Stock_Price:  102.12080064065493
curr_Factors:  [102.12080064]
mat_Sqrt:  [[0.15]]
grads:  [0.03012694]
Stock Position:  0.030126939003333776
Bond Position:  [20.75461806]


portfolio before change:  [23.84967948]
curr_Stock_Price:  102.69095741385122
curr_Factors:  [102.69095741]
mat_Sqrt:  [[0.15]]
grads:  [0.1549992]
Stock Position:  0.15499920379359428
Bond Position:  [7.93266284]


portfolio before change:  [23.85508931]
curr_Stock_Price:  102.7226609467971
curr_Factors:  [102.72266095]
mat_Sqrt:  [[0.15]]
grads:  [0.05146009]
Stock Position:  0.051460087836074205
Bond Position:  [18.56897215]


portfolio before change:  [23.88523443]
curr_Stock_Price:  103.28590376618185
curr_Factors:  [103.28590377]
mat_Sqrt:  [[0.15]]
grads:  [0.08178728]
Stock Position:  0.08178727835547232
Bond Position:  [15.43776147]


portfolio before change:  [23.87434493]
curr_Stock_Price:  103.1409620625247
curr_Factors:  [103.14096206]
mat_Sqrt:  [[0.15]]
grads:  [0.05377456]
Stock Position:  0.05377455512351825
Bond Position:  [18.32798558]


portfolio before change:  [23.86234816]
curr_Stock_Price:  102.89656564749232
curr_Factors:  [102.89656565]
mat_Sqrt:  [[0.15]]
grads:  [0.03404369]
Stock Position:  0.03404368523457592
Bond Position:  [20.35936986]


portfolio before change:  [23.85304797]
curr_Stock_Price:  102.58600341554144
curr_Factors:  [102.58600342]
mat_Sqrt:  [[0.15]]
grads:  [0.10922868]
Stock Position:  0.10922867929109527
Bond Position:  [12.64771431]


portfolio before change:  [23.89583077]
curr_Stock_Price:  102.97044717078803
curr_Factors:  [102.97044717]
mat_Sqrt:  [[0.15]]
grads:  [0.00514575]
Stock Position:  0.005145754495126855
Bond Position:  [23.36597012]


portfolio before change:  [23.89346249]
curr_Stock_Price:  102.22639859693648
curr_Factors:  [102.2263986]
mat_Sqrt:  [[0.15]]
grads:  [-0.10368895]
Stock Position:  -0.10368895353939536
Bond Position:  [34.49321079]


portfolio before change:  [23.90645616]
curr_Stock_Price:  102.12187663206763
curr_Factors:  [102.12187663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00826228]
Stock Position:  -0.008262279505701482
Bond Position:  [24.75021565]


portfolio before change:  [23.90897218]
curr_Stock_Price:  102.00458613548504
curr_Factors:  [102.00458614]
mat_Sqrt:  [[0.15]]
grads:  [0.00864695]
Stock Position:  0.008646949591484925
Bond Position:  [23.02694367]


portfolio before change:  [23.90585446]
curr_Stock_Price:  101.47758484791662
curr_Factors:  [101.47758485]
mat_Sqrt:  [[0.15]]
grads:  [0.00694181]
Stock Position:  0.006941811310868899
Bond Position:  [23.20141621]


portfolio before change:  [23.91097641]
curr_Stock_Price:  102.00652695235944
curr_Factors:  [102.00652695]
mat_Sqrt:  [[0.15]]
grads:  [-0.09213519]
Stock Position:  -0.09213519384576571
Bond Position:  [33.30936754]


portfolio before change:  [23.94829971]
curr_Stock_Price:  101.62403026755031
curr_Factors:  [101.62403027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823886]
Stock Position:  -0.028238855701791313
Bond Position:  [26.81804604]


portfolio before change:  [23.95249566]
curr_Stock_Price:  101.53479986008128
curr_Factors:  [101.53479986]
mat_Sqrt:  [[0.15]]
grads:  [0.10910167]
Stock Position:  0.10910167272552874
Bond Position:  [12.87487916]


portfolio before change:  [23.90354973]
curr_Stock_Price:  101.07879740328373
curr_Factors:  [101.0787974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08292467]
Stock Position:  -0.082924674220603
Bond Position:  [32.28547608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.94005661]
Stock Price:  100.66289023816927
PL:  [23.27716637]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.55394847e-03]
 [ 2.44000544e-02]
 [ 2.08404923e-02]
 [-2.32677742e-02]
 [-1.34161785e-02]
 [-1.66815052e-03]
 [ 2.30503948e-03]
 [-2.40372286e-03]
 [ 2.17934561e-03]
 [-4.86216620e-03]
 [-9.83830978e-03]
 [ 1.85689451e-02]
 [-4.48407491e-03]
 [ 5.37808463e-03]
 [ 1.40481685e-02]
 [ 1.01631954e-02]
 [ 9.68676374e-02]
 [-1.11835360e-02]
 [ 2.34892994e-02]
 [ 5.35672563e-04]
 [-7.15405424e-03]
 [ 6.27269687e-03]
 [ 1.06214037e-03]
 [ 5.78632026e-02]
 [ 6.17746393e-03]
 [ 5.36762859e-03]
 [ 1.02167134e-01]
 [ 4.35028791e-02]
 [-9.61459696e-03]
 [-7.39068869e-03]
 [ 1.03052415e-02]
 [ 1.63155272e-02]
 [ 1.74281638e-02]
 [-1.32594015e-02]
 [ 3.60555676e-03]
 [-2.68585298e-02]
 [-8.58716647e-03]
 [-1.88644349e-02]
 [ 2.47459584e-02]
 [-7.17843344e-02]
 [ 3.11937595e-03]
 [-8.72792665e-03]
 [-1.88033104e-02]
 [ 2.11724948e-02]
 [-1.19233709e-02]
 [ 1.17727457e-02]
 [ 1.05255511e-02]
 [-3.56234110e-03]
 [ 1.52558693e-02]
 [-1.59146168e-03]
 [ 1.72611265e-02]
 [ 2.89570904e-02]
 [-1.03982032e-02]
 [-8.56447137e-02]
 [-2.69419718e-02]
 [-1.94869263e-03]
 [-5.21728518e-03]
 [-1.39304036e-02]
 [ 2.09767414e-04]
 [-3.07258327e-03]
 [-7.50840793e-03]
 [-1.61654895e-03]
 [-1.80026734e-02]
 [-7.53818835e-05]
 [-6.65018801e-03]
 [ 2.91891533e-02]
 [-3.40123076e-03]
 [ 1.93058247e-02]
 [ 9.06777553e-03]
 [ 1.15838452e-02]
 [ 7.34604368e-03]
 [-1.44594220e-02]
 [-5.67982391e-02]
 [ 4.09454432e-04]
 [-1.68330291e-02]
 [-3.41805191e-02]
 [-6.60848432e-03]
 [ 2.54749635e-02]
 [ 1.06087135e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.95431579]
curr_Stock_Price:  100.13282044856018
curr_Factors:  [100.13282045]
mat_Sqrt:  [[0.15]]
grads:  [-0.05035966]
Stock Position:  -0.05035965646551853
Bond Position:  [9.99697023]


portfolio before change:  [4.9352971]
curr_Stock_Price:  100.52288512978863
curr_Factors:  [100.52288513]
mat_Sqrt:  [[0.15]]
grads:  [0.16266703]
Stock Position:  0.16266702933295277
Bond Position:  [-11.41646201]


portfolio before change:  [4.98642479]
curr_Stock_Price:  100.84158059830331
curr_Factors:  [100.8415806]
mat_Sqrt:  [[0.15]]
grads:  [0.13893662]
Stock Position:  0.13893661545721264
Bond Position:  [-9.02416311]


portfolio before change:  [5.00979766]
curr_Stock_Price:  101.01386702382055
curr_Factors:  [101.01386702]
mat_Sqrt:  [[0.15]]
grads:  [-0.15511849]
Stock Position:  -0.1551184947061866
Bond Position:  [20.67891665]


portfolio before change:  [5.03519921]
curr_Stock_Price:  100.85844339610124
curr_Factors:  [100.8584434]
mat_Sqrt:  [[0.15]]
grads:  [-0.08944119]
Stock Position:  -0.08944118981794134
Bond Position:  [14.05609839]


portfolio before change:  [5.0497312]
curr_Stock_Price:  100.70579051380881
curr_Factors:  [100.70579051]
mat_Sqrt:  [[0.15]]
grads:  [-0.011121]
Stock Position:  -0.01112100346362368
Bond Position:  [6.16968064]


portfolio before change:  [5.05725836]
curr_Stock_Price:  100.06362283593378
curr_Factors:  [100.06362284]
mat_Sqrt:  [[0.15]]
grads:  [0.01536693]
Stock Position:  0.01536692987644536
Bond Position:  [3.51958769]


portfolio before change:  [5.05156536]
curr_Stock_Price:  99.6788368009898
curr_Factors:  [99.6788368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01602482]
Stock Position:  -0.016024819034727116
Bond Position:  [6.64890069]


portfolio before change:  [5.0397608]
curr_Stock_Price:  100.44141196782321
curr_Factors:  [100.44141197]
mat_Sqrt:  [[0.15]]
grads:  [0.01452897]
Stock Position:  0.014528970758217834
Bond Position:  [3.58045047]


portfolio before change:  [5.05634719]
curr_Stock_Price:  101.56761693869406
curr_Factors:  [101.56761694]
mat_Sqrt:  [[0.15]]
grads:  [-0.03241444]
Stock Position:  -0.03241444134315648
Bond Position:  [8.34860475]


portfolio before change:  [5.04667991]
curr_Stock_Price:  101.881954657747
curr_Factors:  [101.88195466]
mat_Sqrt:  [[0.15]]
grads:  [-0.06558873]
Stock Position:  -0.06558873183359316
Bond Position:  [11.72898811]


portfolio before change:  [5.02539093]
curr_Stock_Price:  102.21771453176197
curr_Factors:  [102.21771453]
mat_Sqrt:  [[0.15]]
grads:  [0.12379297]
Stock Position:  0.12379296752479083
Bond Position:  [-7.62844328]


portfolio before change:  [5.06747411]
curr_Stock_Price:  102.5615140994119
curr_Factors:  [102.5615141]
mat_Sqrt:  [[0.15]]
grads:  [-0.02989383]
Stock Position:  -0.029893832714519588
Bond Position:  [8.13343085]


portfolio before change:  [5.04705796]
curr_Stock_Price:  103.26147474358352
curr_Factors:  [103.26147474]
mat_Sqrt:  [[0.15]]
grads:  [0.0358539]
Stock Position:  0.035853897518536064
Bond Position:  [1.34473162]


portfolio before change:  [5.05669681]
curr_Stock_Price:  103.52796761753123
curr_Factors:  [103.52796762]
mat_Sqrt:  [[0.15]]
grads:  [0.09365446]
Stock Position:  0.09365445662980974
Bond Position:  [-4.63915874]


portfolio before change:  [4.99018774]
curr_Stock_Price:  102.82090974335395
curr_Factors:  [102.82090974]
mat_Sqrt:  [[0.15]]
grads:  [0.06775464]
Stock Position:  0.06775463627417293
Bond Position:  [-1.97640561]


portfolio before change:  [4.99828312]
curr_Stock_Price:  102.94221383356525
curr_Factors:  [102.94221383]
mat_Sqrt:  [[0.15]]
grads:  [0.64578425]
Stock Position:  0.6457842491883657
Bond Position:  [-61.48017715]


portfolio before change:  [4.78233814]
curr_Stock_Price:  102.61377232639795
curr_Factors:  [102.61377233]
mat_Sqrt:  [[0.15]]
grads:  [-0.07455691]
Stock Position:  -0.07455690657015358
Bond Position:  [12.43290357]


portfolio before change:  [4.77323354]
curr_Stock_Price:  102.74631111090534
curr_Factors:  [102.74631111]
mat_Sqrt:  [[0.15]]
grads:  [0.15659533]
Stock Position:  0.15659532909401058
Bond Position:  [-11.31635887]


portfolio before change:  [4.77823326]
curr_Stock_Price:  102.78275548623738
curr_Factors:  [102.78275549]
mat_Sqrt:  [[0.15]]
grads:  [0.00357115]
Stock Position:  0.003571150419462305
Bond Position:  [4.41118058]


portfolio before change:  [4.78099265]
curr_Stock_Price:  103.47824020614517
curr_Factors:  [103.47824021]
mat_Sqrt:  [[0.15]]
grads:  [-0.04769369]
Stock Position:  -0.0476936949080675
Bond Position:  [9.71625227]


portfolio before change:  [4.786487]
curr_Stock_Price:  103.37577250892902
curr_Factors:  [103.37577251]
mat_Sqrt:  [[0.15]]
grads:  [0.04181798]
Stock Position:  0.04181797910146806
Bond Position:  [0.4635211]


portfolio before change:  [4.80005533]
curr_Stock_Price:  103.69954143685797
curr_Factors:  [103.69954144]
mat_Sqrt:  [[0.15]]
grads:  [0.00708094]
Stock Position:  0.007080935809502913
Bond Position:  [4.06576553]


portfolio before change:  [4.80672495]
curr_Stock_Price:  104.60556584317497
curr_Factors:  [104.60556584]
mat_Sqrt:  [[0.15]]
grads:  [0.38575468]
Stock Position:  0.38575468385787165
Bond Position:  [-35.54536203]


portfolio before change:  [4.77642209]
curr_Stock_Price:  104.53277034284575
curr_Factors:  [104.53277034]
mat_Sqrt:  [[0.15]]
grads:  [0.04118309]
Stock Position:  0.041183092858137774
Bond Position:  [0.4714393]


portfolio before change:  [4.81168403]
curr_Stock_Price:  105.3882785701158
curr_Factors:  [105.38827857]
mat_Sqrt:  [[0.15]]
grads:  [0.03578419]
Stock Position:  0.03578419061466797
Bond Position:  [1.04044978]


portfolio before change:  [4.84885874]
curr_Stock_Price:  106.4253198355989
curr_Factors:  [106.42531984]
mat_Sqrt:  [[0.15]]
grads:  [0.68111423]
Stock Position:  0.6811142263695025
Bond Position:  [-67.63894064]


portfolio before change:  [5.01370081]
curr_Stock_Price:  106.67354491558476
curr_Factors:  [106.67354492]
mat_Sqrt:  [[0.15]]
grads:  [0.29001919]
Stock Position:  0.2900191940183143
Bond Position:  [-25.92367471]


portfolio before change:  [5.30493566]
curr_Stock_Price:  107.6833233694425
curr_Factors:  [107.68332337]
mat_Sqrt:  [[0.15]]
grads:  [-0.06409731]
Stock Position:  -0.06409731304940858
Bond Position:  [12.20714735]


portfolio before change:  [5.34721533]
curr_Stock_Price:  107.03560977163322
curr_Factors:  [107.03560977]
mat_Sqrt:  [[0.15]]
grads:  [-0.04927126]
Stock Position:  -0.049271257934116006
Bond Position:  [10.62099447]


portfolio before change:  [5.36559684]
curr_Stock_Price:  106.67601524144285
curr_Factors:  [106.67601524]
mat_Sqrt:  [[0.15]]
grads:  [0.06870161]
Stock Position:  0.06870160994763243
Bond Position:  [-1.96321715]


portfolio before change:  [5.30042138]
curr_Stock_Price:  105.72912687265536
curr_Factors:  [105.72912687]
mat_Sqrt:  [[0.15]]
grads:  [0.10877018]
Stock Position:  0.1087701810569568
Bond Position:  [-6.19975489]


portfolio before change:  [5.33361768]
curr_Stock_Price:  106.03788609667728
curr_Factors:  [106.0378861]
mat_Sqrt:  [[0.15]]
grads:  [0.11618776]
Stock Position:  0.11618775892182391
Bond Position:  [-6.98668666]


portfolio before change:  [5.40487612]
curr_Stock_Price:  106.65494866464932
curr_Factors:  [106.65494866]
mat_Sqrt:  [[0.15]]
grads:  [-0.08839601]
Stock Position:  -0.08839601020139416
Bond Position:  [14.83274805]


portfolio before change:  [5.42857588]
curr_Stock_Price:  106.39732740802265
curr_Factors:  [106.39732741]
mat_Sqrt:  [[0.15]]
grads:  [0.02403705]
Stock Position:  0.02403704509903766
Bond Position:  [2.87109853]


portfolio before change:  [5.43187274]
curr_Stock_Price:  106.52701920945908
curr_Factors:  [106.52701921]
mat_Sqrt:  [[0.15]]
grads:  [-0.17905687]
Stock Position:  -0.17905686563025952
Bond Position:  [24.50626691]


portfolio before change:  [5.36844779]
curr_Stock_Price:  106.8897902136385
curr_Factors:  [106.88979021]
mat_Sqrt:  [[0.15]]
grads:  [-0.05724778]
Stock Position:  -0.057247776445099555
Bond Position:  [11.48765061]


portfolio before change:  [5.36286563]
curr_Stock_Price:  106.99984094678761
curr_Factors:  [106.99984095]
mat_Sqrt:  [[0.15]]
grads:  [-0.1257629]
Stock Position:  -0.12576289939409283
Bond Position:  [18.81947586]


portfolio before change:  [5.39025966]
curr_Stock_Price:  106.79137105029268
curr_Factors:  [106.79137105]
mat_Sqrt:  [[0.15]]
grads:  [0.16497306]
Stock Position:  0.16497305619877872
Bond Position:  [-12.22743919]


portfolio before change:  [5.35049375]
curr_Stock_Price:  106.5549586237978
curr_Factors:  [106.55495862]
mat_Sqrt:  [[0.15]]
grads:  [-0.47856223]
Stock Position:  -0.47856222961414063
Bond Position:  [56.34367232]


portfolio before change:  [5.05610746]
curr_Stock_Price:  107.17746465840992
curr_Factors:  [107.17746466]
mat_Sqrt:  [[0.15]]
grads:  [0.02079584]
Stock Position:  0.020795839658772047
Bond Position:  [2.82726209]


portfolio before change:  [5.06417671]
curr_Stock_Price:  107.55698986644786
curr_Factors:  [107.55698987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05818618]
Stock Position:  -0.058186177655491014
Bond Position:  [11.32250683]


portfolio before change:  [5.12747568]
curr_Stock_Price:  106.4812827146835
curr_Factors:  [106.48128271]
mat_Sqrt:  [[0.15]]
grads:  [-0.1253554]
Stock Position:  -0.12535540269786022
Bond Position:  [18.47547975]


portfolio before change:  [5.14174543]
curr_Stock_Price:  106.37666023400783
curr_Factors:  [106.37666023]
mat_Sqrt:  [[0.15]]
grads:  [0.14114997]
Stock Position:  0.14114996527493565
Bond Position:  [-9.87331647]


portfolio before change:  [5.23201423]
curr_Stock_Price:  107.02055625175176
curr_Factors:  [107.02055625]
mat_Sqrt:  [[0.15]]
grads:  [-0.07948914]
Stock Position:  -0.07948913923275679
Bond Position:  [13.73898612]


portfolio before change:  [5.26597758]
curr_Stock_Price:  106.60408877255615
curr_Factors:  [106.60408877]
mat_Sqrt:  [[0.15]]
grads:  [0.07848497]
Stock Position:  0.07848497144814366
Bond Position:  [-3.10084128]


portfolio before change:  [5.20792893]
curr_Stock_Price:  105.86694331117778
curr_Factors:  [105.86694331]
mat_Sqrt:  [[0.15]]
grads:  [0.07017034]
Stock Position:  0.0701703408477538
Bond Position:  [-2.22079056]


portfolio before change:  [5.28381597]
curr_Stock_Price:  106.9503902608259
curr_Factors:  [106.95039026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02374894]
Stock Position:  -0.023748940648227208
Bond Position:  [7.82377444]


portfolio before change:  [5.28334021]
curr_Stock_Price:  106.99101373853509
curr_Factors:  [106.99101374]
mat_Sqrt:  [[0.15]]
grads:  [0.1017058]
Stock Position:  0.10170579563096849
Bond Position:  [-5.59826597]


portfolio before change:  [5.3336992]
curr_Stock_Price:  107.48959783387144
curr_Factors:  [107.48959783]
mat_Sqrt:  [[0.15]]
grads:  [-0.01060974]
Stock Position:  -0.010609744513004784
Bond Position:  [6.47413637]


portfolio before change:  [5.3253727]
curr_Stock_Price:  108.31253354140196
curr_Factors:  [108.31253354]
mat_Sqrt:  [[0.15]]
grads:  [0.11507418]
Stock Position:  0.11507417657755813
Bond Position:  [-7.13860291]


portfolio before change:  [5.2544564]
curr_Stock_Price:  107.7001448501607
curr_Factors:  [107.70014485]
mat_Sqrt:  [[0.15]]
grads:  [0.19304727]
Stock Position:  0.19304726908950137
Bond Position:  [-15.53676244]


portfolio before change:  [5.38603239]
curr_Stock_Price:  108.38674905135109
curr_Factors:  [108.38674905]
mat_Sqrt:  [[0.15]]
grads:  [-0.06932135]
Stock Position:  -0.06932135496434144
Bond Position:  [12.8995487]


portfolio before change:  [5.35629266]
curr_Stock_Price:  108.82739222702168
curr_Factors:  [108.82739223]
mat_Sqrt:  [[0.15]]
grads:  [-0.57096476]
Stock Position:  -0.5709647581588833
Bond Position:  [67.49289834]


portfolio before change:  [5.58477452]
curr_Stock_Price:  108.43461242333748
curr_Factors:  [108.43461242]
mat_Sqrt:  [[0.15]]
grads:  [-0.17961315]
Stock Position:  -0.17961314528300049
Bond Position:  [25.06105632]


portfolio before change:  [5.69418056]
curr_Stock_Price:  107.83421275756636
curr_Factors:  [107.83421276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01299128]
Stock Position:  -0.012991284219271291
Bond Position:  [7.09508546]


portfolio before change:  [5.69603747]
curr_Stock_Price:  107.7254127196974
curr_Factors:  [107.72541272]
mat_Sqrt:  [[0.15]]
grads:  [-0.0347819]
Stock Position:  -0.03478190118468333
Bond Position:  [9.44293213]


portfolio before change:  [5.71606164]
curr_Stock_Price:  107.16667479399008
curr_Factors:  [107.16667479]
mat_Sqrt:  [[0.15]]
grads:  [-0.09286936]
Stock Position:  -0.09286935757937811
Bond Position:  [15.66856188]


portfolio before change:  [5.73191425]
curr_Stock_Price:  107.00652183756355
curr_Factors:  [107.00652184]
mat_Sqrt:  [[0.15]]
grads:  [0.00139845]
Stock Position:  0.001398449424786976
Bond Position:  [5.58227104]


portfolio before change:  [5.73175983]
curr_Stock_Price:  106.64660709982356
curr_Factors:  [106.6466071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048389]
Stock Position:  -0.0204838884444929
Bond Position:  [7.91629704]


portfolio before change:  [5.71711485]
curr_Stock_Price:  107.38571328756078
curr_Factors:  [107.38571329]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005605]
Stock Position:  -0.050056052898972886
Bond Position:  [11.09241979]


portfolio before change:  [5.75804332]
curr_Stock_Price:  106.581911005239
curr_Factors:  [106.58191101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01077699]
Stock Position:  -0.010776993012091743
Bond Position:  [6.90667583]


portfolio before change:  [5.75958876]
curr_Stock_Price:  106.47856478717631
curr_Factors:  [106.47856479]
mat_Sqrt:  [[0.15]]
grads:  [-0.12001782]
Stock Position:  -0.12001782249913542
Bond Position:  [18.53891425]


portfolio before change:  [5.67206358]
curr_Stock_Price:  107.2174874761834
curr_Factors:  [107.21748748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050255]
Stock Position:  -0.0005025458902755346
Bond Position:  [5.72594529]


portfolio before change:  [5.67201104]
curr_Stock_Price:  108.03417992763326
curr_Factors:  [108.03417993]
mat_Sqrt:  [[0.15]]
grads:  [-0.04433459]
Stock Position:  -0.04433458674955322
Bond Position:  [10.46166176]


portfolio before change:  [5.66714977]
curr_Stock_Price:  108.15857819380669
curr_Factors:  [108.15857819]
mat_Sqrt:  [[0.15]]
grads:  [0.19459436]
Stock Position:  0.1945943551139154
Bond Position:  [-15.379899]


portfolio before change:  [5.63560343]
curr_Stock_Price:  108.00140474951066
curr_Factors:  [108.00140475]
mat_Sqrt:  [[0.15]]
grads:  [-0.02267487]
Stock Position:  -0.022674871761126557
Bond Position:  [8.08452143]


portfolio before change:  [5.64636177]
curr_Stock_Price:  107.54922831867046
curr_Factors:  [107.54922832]
mat_Sqrt:  [[0.15]]
grads:  [0.1287055]
Stock Position:  0.12870549793508826
Bond Position:  [-8.19581521]


portfolio before change:  [5.74612172]
curr_Stock_Price:  108.32831080969254
curr_Factors:  [108.32831081]
mat_Sqrt:  [[0.15]]
grads:  [0.06045184]
Stock Position:  0.06045183686092956
Bond Position:  [-0.80252365]


portfolio before change:  [5.71759236]
curr_Stock_Price:  107.8572051226654
curr_Factors:  [107.85720512]
mat_Sqrt:  [[0.15]]
grads:  [0.07722563]
Stock Position:  0.07722563471968155
Bond Position:  [-2.61174877]


portfolio before change:  [5.71894351]
curr_Stock_Price:  107.87681512680072
curr_Factors:  [107.87681513]
mat_Sqrt:  [[0.15]]
grads:  [0.04897362]
Stock Position:  0.048973624558667946
Bond Position:  [0.43582487]


portfolio before change:  [5.75362907]
curr_Stock_Price:  108.5845087928924
curr_Factors:  [108.58450879]
mat_Sqrt:  [[0.15]]
grads:  [-0.09639615]
Stock Position:  -0.09639614684261884
Bond Position:  [16.22075733]


portfolio before change:  [5.69860059]
curr_Stock_Price:  109.16588382834458
curr_Factors:  [109.16588383]
mat_Sqrt:  [[0.15]]
grads:  [-0.37865493]
Stock Position:  -0.3786549276193311
Bond Position:  [47.03480043]


portfolio before change:  [5.56276701]
curr_Stock_Price:  109.53237410064709
curr_Factors:  [109.5323741]
mat_Sqrt:  [[0.15]]
grads:  [0.0027297]
Stock Position:  0.0027296962100945236
Bond Position:  [5.2637769]


portfolio before change:  [5.56609205]
curr_Stock_Price:  110.6299469755307
curr_Factors:  [110.62994698]
mat_Sqrt:  [[0.15]]
grads:  [-0.11222019]
Stock Position:  -0.11222019404122166
Bond Position:  [17.98100616]


portfolio before change:  [5.52813362]
curr_Stock_Price:  110.97821119036281
curr_Factors:  [110.97821119]
mat_Sqrt:  [[0.15]]
grads:  [-0.22787013]
Stock Position:  -0.2278701275866149
Bond Position:  [30.81675276]


portfolio before change:  [5.3458524]
curr_Stock_Price:  111.78659851466412
curr_Factors:  [111.78659851]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405656]
Stock Position:  -0.04405656216311685
Bond Position:  [10.27078563]


portfolio before change:  [5.38421055]
curr_Stock_Price:  110.93051253388457
curr_Factors:  [110.93051253]
mat_Sqrt:  [[0.15]]
grads:  [0.16983309]
Stock Position:  0.16983309028471413
Bond Position:  [-13.4554612]


portfolio before change:  [5.3574309]
curr_Stock_Price:  110.7777822230667
curr_Factors:  [110.77778222]
mat_Sqrt:  [[0.15]]
grads:  [0.70724757]
Stock Position:  0.7072475691038588
Bond Position:  [-72.98988629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.45420529]
Stock Price:  110.92106501726505
PL:  [-5.46685972]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.41485909e-03]
 [ 1.24178518e-02]
 [ 5.79999523e-03]
 [-8.67602553e-03]
 [ 1.20599672e-02]
 [-1.35239916e-02]
 [-3.39283064e-03]
 [ 3.49396241e-02]
 [-1.82292288e-02]
 [-1.23949327e-02]
 [ 1.46285066e-02]
 [ 4.71245433e-04]
 [-2.42167007e-03]
 [ 9.27659653e-03]
 [-2.13273757e-03]
 [ 1.32854613e-02]
 [ 3.65475043e-02]
 [-1.47293476e-02]
 [ 1.76145483e-02]
 [ 1.32919692e-03]
 [-3.82574963e-03]
 [ 4.47144420e-03]
 [ 1.42284288e-02]
 [ 2.84397419e-02]
 [-1.07790677e-03]
 [ 7.73495741e-03]
 [ 1.76146869e-02]
 [ 2.15367651e-02]
 [ 2.23058859e-02]
 [-8.08926942e-03]
 [-2.21174386e-03]
 [ 1.34770755e-02]
 [ 1.29114637e-02]
 [ 5.07644991e-03]
 [ 6.02095487e-03]
 [ 1.73543722e-02]
 [-2.35566603e-02]
 [-1.26734306e-03]
 [-2.89519434e-02]
 [-1.32842017e-02]
 [ 3.87526896e-03]
 [ 8.57458464e-03]
 [-1.02384633e-02]
 [ 6.66028486e-03]
 [ 3.68963039e-03]
 [ 1.21228356e-02]
 [ 1.06088458e-02]
 [ 1.68177136e-03]
 [ 1.58220885e-02]
 [-1.17138556e-03]
 [ 1.44147639e-02]
 [-8.59856767e-03]
 [ 1.54071282e-03]
 [ 2.05988641e-03]
 [-3.57361730e-03]
 [-3.34561506e-03]
 [ 1.07117699e-02]
 [-6.35951046e-03]
 [ 6.69690444e-03]
 [-3.99760505e-03]
 [-1.92164797e-03]
 [ 8.04116528e-03]
 [-1.60484517e-02]
 [ 3.40292848e-03]
 [ 2.32180298e-02]
 [ 7.95219175e-03]
 [ 1.07111538e-02]
 [ 6.41265461e-03]
 [ 6.59837673e-03]
 [ 1.17557979e-02]
 [ 1.94872314e-03]
 [-1.52819778e-02]
 [-5.30411690e-03]
 [ 9.76528908e-04]
 [ 2.43526704e-03]
 [-1.56334965e-02]
 [-3.75281536e-03]
 [ 1.38556928e-02]
 [-6.59447947e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.88509345]
curr_Stock_Price:  100.40218421602933
curr_Factors:  [100.40218422]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276573]
Stock Position:  -0.02276572729006151
Bond Position:  [13.1708222]


portfolio before change:  [10.89341018]
curr_Stock_Price:  100.07302601646091
curr_Factors:  [100.07302602]
mat_Sqrt:  [[0.15]]
grads:  [0.08278568]
Stock Position:  0.08278567858677591
Bond Position:  [2.60879681]


portfolio before change:  [10.85425912]
curr_Stock_Price:  99.5981357023692
curr_Factors:  [99.5981357]
mat_Sqrt:  [[0.15]]
grads:  [0.03866663]
Stock Position:  0.038666634840239245
Bond Position:  [7.00313437]


portfolio before change:  [10.84834877]
curr_Stock_Price:  99.43396166398522
curr_Factors:  [99.43396166]
mat_Sqrt:  [[0.15]]
grads:  [-0.05784017]
Stock Position:  -0.057840170186546636
Bond Position:  [16.59962603]


portfolio before change:  [10.81808543]
curr_Stock_Price:  99.97512275402353
curr_Factors:  [99.97512275]
mat_Sqrt:  [[0.15]]
grads:  [0.08039978]
Stock Position:  0.08039978138380344
Bond Position:  [2.78010741]


portfolio before change:  [10.76205958]
curr_Stock_Price:  99.2761207678562
curr_Factors:  [99.27612077]
mat_Sqrt:  [[0.15]]
grads:  [-0.09015994]
Stock Position:  -0.09015994389875144
Bond Position:  [19.71278906]


portfolio before change:  [10.76751282]
curr_Stock_Price:  99.22930234682576
curr_Factors:  [99.22930235]
mat_Sqrt:  [[0.15]]
grads:  [-0.02261887]
Stock Position:  -0.022618870925627775
Bond Position:  [13.0119676]


portfolio before change:  [10.78669404]
curr_Stock_Price:  98.41723930548895
curr_Factors:  [98.41723931]
mat_Sqrt:  [[0.15]]
grads:  [0.23293083]
Stock Position:  0.23293082728957684
Bond Position:  [-12.13771493]


portfolio before change:  [10.85752033]
curr_Stock_Price:  98.72456195582205
curr_Factors:  [98.72456196]
mat_Sqrt:  [[0.15]]
grads:  [-0.12152819]
Stock Position:  -0.12152819202161494
Bond Position:  [22.85533785]


portfolio before change:  [10.82899876]
curr_Stock_Price:  98.9710074515643
curr_Factors:  [98.97100745]
mat_Sqrt:  [[0.15]]
grads:  [-0.08263288]
Stock Position:  -0.0826328847688046
Bond Position:  [19.00725861]


portfolio before change:  [10.77346346]
curr_Stock_Price:  99.657456698092
curr_Factors:  [99.6574567]
mat_Sqrt:  [[0.15]]
grads:  [0.09752338]
Stock Position:  0.09752337729769371
Bond Position:  [1.05453171]


portfolio before change:  [10.86466826]
curr_Stock_Price:  100.59199039516176
curr_Factors:  [100.5919904]
mat_Sqrt:  [[0.15]]
grads:  [0.00314164]
Stock Position:  0.0031416362210528207
Bond Position:  [10.54864482]


portfolio before change:  [10.86432906]
curr_Stock_Price:  100.27415949244507
curr_Factors:  [100.27415949]
mat_Sqrt:  [[0.15]]
grads:  [-0.01614447]
Stock Position:  -0.01614446714782468
Bond Position:  [12.48320193]


portfolio before change:  [10.86675611]
curr_Stock_Price:  100.17215402877926
curr_Factors:  [100.17215403]
mat_Sqrt:  [[0.15]]
grads:  [0.06184398]
Stock Position:  0.061843976858005405
Bond Position:  [4.67171173]


portfolio before change:  [10.89531956]
curr_Stock_Price:  100.62929575202573
curr_Factors:  [100.62929575]
mat_Sqrt:  [[0.15]]
grads:  [-0.01421825]
Stock Position:  -0.01421825047545852
Bond Position:  [12.32609209]


portfolio before change:  [10.90390567]
curr_Stock_Price:  100.07960035273064
curr_Factors:  [100.07960035]
mat_Sqrt:  [[0.15]]
grads:  [0.08856974]
Stock Position:  0.088569741801727
Bond Position:  [2.03988131]


portfolio before change:  [10.91903835]
curr_Stock_Price:  100.24901688360424
curr_Factors:  [100.24901688]
mat_Sqrt:  [[0.15]]
grads:  [0.24365003]
Stock Position:  0.24365002867966798
Bond Position:  [-13.50663749]


portfolio before change:  [10.88864549]
curr_Stock_Price:  100.12774184009392
curr_Factors:  [100.12774184]
mat_Sqrt:  [[0.15]]
grads:  [-0.09819565]
Stock Position:  -0.09819565064695054
Bond Position:  [20.72075425]


portfolio before change:  [10.81214652]
curr_Stock_Price:  100.91997711206844
curr_Factors:  [100.91997711]
mat_Sqrt:  [[0.15]]
grads:  [0.11743032]
Stock Position:  0.11743032218633472
Bond Position:  [-1.03891891]


portfolio before change:  [10.90283439]
curr_Stock_Price:  101.69279968066252
curr_Factors:  [101.69279968]
mat_Sqrt:  [[0.15]]
grads:  [0.00886131]
Stock Position:  0.008861312802146852
Bond Position:  [10.00170268]


portfolio before change:  [10.89752545]
curr_Stock_Price:  101.02314049976026
curr_Factors:  [101.0231405]
mat_Sqrt:  [[0.15]]
grads:  [-0.025505]
Stock Position:  -0.025504997513939854
Bond Position:  [13.4741204]


portfolio before change:  [10.89586061]
curr_Stock_Price:  101.12143501046395
curr_Factors:  [101.12143501]
mat_Sqrt:  [[0.15]]
grads:  [0.02980963]
Stock Position:  0.02980962796815409
Bond Position:  [7.88146825]


portfolio before change:  [10.8979246]
curr_Stock_Price:  101.17414880031856
curr_Factors:  [101.1741488]
mat_Sqrt:  [[0.15]]
grads:  [0.09485619]
Stock Position:  0.09485619179198868
Bond Position:  [1.30093013]


portfolio before change:  [10.9775989]
curr_Stock_Price:  102.0132400104474
curr_Factors:  [102.01324001]
mat_Sqrt:  [[0.15]]
grads:  [0.18959828]
Stock Position:  0.18959827948811167
Bond Position:  [-8.36393589]


portfolio before change:  [10.91191216]
curr_Stock_Price:  101.66954498777449
curr_Factors:  [101.66954499]
mat_Sqrt:  [[0.15]]
grads:  [-0.00718605]
Stock Position:  -0.007186045118945257
Bond Position:  [11.64251409]


portfolio before change:  [10.9118164]
curr_Stock_Price:  101.78413316822692
curr_Factors:  [101.78413317]
mat_Sqrt:  [[0.15]]
grads:  [0.05156638]
Stock Position:  0.05156638275700929
Bond Position:  [5.66317683]


portfolio before change:  [10.96281554]
curr_Stock_Price:  102.76626879092116
curr_Factors:  [102.76626879]
mat_Sqrt:  [[0.15]]
grads:  [0.11743125]
Stock Position:  0.11743124588332345
Bond Position:  [-1.10515544]


portfolio before change:  [10.9974129]
curr_Stock_Price:  103.06147500631675
curr_Factors:  [103.06147501]
mat_Sqrt:  [[0.15]]
grads:  [0.14357843]
Stock Position:  0.14357843376381113
Bond Position:  [-3.79999226]


portfolio before change:  [10.93130897]
curr_Stock_Price:  102.60272629226768
curr_Factors:  [102.60272629]
mat_Sqrt:  [[0.15]]
grads:  [0.14870591]
Stock Position:  0.1487059062629835
Bond Position:  [-4.32632243]


portfolio before change:  [10.94863328]
curr_Stock_Price:  102.72104514011869
curr_Factors:  [102.72104514]
mat_Sqrt:  [[0.15]]
grads:  [-0.05392846]
Stock Position:  -0.05392846279448946
Bond Position:  [16.48822134]


portfolio before change:  [10.98281427]
curr_Stock_Price:  102.10633374095731
curr_Factors:  [102.10633374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01474496]
Stock Position:  -0.014744959079800099
Bond Position:  [12.48836798]


portfolio before change:  [10.98739248]
curr_Stock_Price:  101.8487765579295
curr_Factors:  [101.84877656]
mat_Sqrt:  [[0.15]]
grads:  [0.08984717]
Stock Position:  0.08984716999186694
Bond Position:  [1.83656814]


portfolio before change:  [10.97249988]
curr_Stock_Price:  101.68174410814059
curr_Factors:  [101.68174411]
mat_Sqrt:  [[0.15]]
grads:  [0.08607642]
Stock Position:  0.08607642473840194
Bond Position:  [2.22009889]


portfolio before change:  [10.99306233]
curr_Stock_Price:  101.91901803880478
curr_Factors:  [101.91901804]
mat_Sqrt:  [[0.15]]
grads:  [0.033843]
Stock Position:  0.033842999390177764
Bond Position:  [7.54381707]


portfolio before change:  [10.98538961]
curr_Stock_Price:  101.67837083144205
curr_Factors:  [101.67837083]
mat_Sqrt:  [[0.15]]
grads:  [0.0401397]
Stock Position:  0.040139699126710206
Bond Position:  [6.9040504]


portfolio before change:  [10.98675731]
curr_Stock_Price:  101.70169379326282
curr_Factors:  [101.70169379]
mat_Sqrt:  [[0.15]]
grads:  [0.11569581]
Stock Position:  0.11569581481487753
Bond Position:  [-0.77970303]


portfolio before change:  [11.0488699]
curr_Stock_Price:  102.23897617699889
curr_Factors:  [102.23897618]
mat_Sqrt:  [[0.15]]
grads:  [-0.1570444]
Stock Position:  -0.15704440224762609
Bond Position:  [27.1049288]


portfolio before change:  [11.07082893]
curr_Stock_Price:  102.10993671019594
curr_Factors:  [102.10993671]
mat_Sqrt:  [[0.15]]
grads:  [-0.00844895]
Stock Position:  -0.008448953715315724
Bond Position:  [11.93355106]


portfolio before change:  [11.06796783]
curr_Stock_Price:  102.53685030585082
curr_Factors:  [102.53685031]
mat_Sqrt:  [[0.15]]
grads:  [-0.19301296]
Stock Position:  -0.1930129562926179
Bond Position:  [30.85890844]


portfolio before change:  [11.11032347]
curr_Stock_Price:  102.32739857672638
curr_Factors:  [102.32739858]
mat_Sqrt:  [[0.15]]
grads:  [-0.08856134]
Stock Position:  -0.08856134456340052
Bond Position:  [20.17257547]


portfolio before change:  [11.05477271]
curr_Stock_Price:  102.96889271100308
curr_Factors:  [102.96889271]
mat_Sqrt:  [[0.15]]
grads:  [0.02583513]
Stock Position:  0.02583512641440302
Bond Position:  [8.39455835]


portfolio before change:  [11.06936032]
curr_Stock_Price:  103.51322640030713
curr_Factors:  [103.5132264]
mat_Sqrt:  [[0.15]]
grads:  [0.0571639]
Stock Position:  0.05716389760982746
Bond Position:  [5.15214084]


portfolio before change:  [11.07463928]
curr_Stock_Price:  103.59994104024793
curr_Factors:  [103.59994104]
mat_Sqrt:  [[0.15]]
grads:  [-0.06825642]
Stock Position:  -0.06825642200053005
Bond Position:  [18.14600058]


portfolio before change:  [11.05261792]
curr_Stock_Price:  103.93918424889206
curr_Factors:  [103.93918425]
mat_Sqrt:  [[0.15]]
grads:  [0.0444019]
Stock Position:  0.04440189909610859
Bond Position:  [6.43752075]


portfolio before change:  [11.0431578]
curr_Stock_Price:  103.71706584406132
curr_Factors:  [103.71706584]
mat_Sqrt:  [[0.15]]
grads:  [0.02459754]
Stock Position:  0.02459753593186545
Bond Position:  [8.49197354]


portfolio before change:  [11.01887977]
curr_Stock_Price:  102.7084775109578
curr_Factors:  [102.70847751]
mat_Sqrt:  [[0.15]]
grads:  [0.0808189]
Stock Position:  0.08081890400554989
Bond Position:  [2.71809319]


portfolio before change:  [10.97085302]
curr_Stock_Price:  102.11212400239367
curr_Factors:  [102.112124]
mat_Sqrt:  [[0.15]]
grads:  [0.07072564]
Stock Position:  0.07072563841210441
Bond Position:  [3.74890786]


portfolio before change:  [10.93863997]
curr_Stock_Price:  101.65334600961663
curr_Factors:  [101.65334601]
mat_Sqrt:  [[0.15]]
grads:  [0.01121181]
Stock Position:  0.011211809056893066
Bond Position:  [9.79892206]


portfolio before change:  [10.94536541]
curr_Stock_Price:  102.19857404041126
curr_Factors:  [102.19857404]
mat_Sqrt:  [[0.15]]
grads:  [0.10548059]
Stock Position:  0.10548059021249007
Bond Position:  [0.16539951]


portfolio before change:  [10.97976299]
curr_Stock_Price:  102.52457941185106
curr_Factors:  [102.52457941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00780924]
Stock Position:  -0.007809237088388841
Bond Position:  [11.78040174]


portfolio before change:  [10.98736815]
curr_Stock_Price:  101.64499806238739
curr_Factors:  [101.64499806]
mat_Sqrt:  [[0.15]]
grads:  [0.09609843]
Stock Position:  0.096098425948941
Bond Position:  [1.21944383]


portfolio before change:  [11.07001395]
curr_Stock_Price:  102.50421692799671
curr_Factors:  [102.50421693]
mat_Sqrt:  [[0.15]]
grads:  [-0.05732378]
Stock Position:  -0.05732378449778728
Bond Position:  [16.94594359]


portfolio before change:  [11.12623609]
curr_Stock_Price:  101.54191143484742
curr_Factors:  [101.54191143]
mat_Sqrt:  [[0.15]]
grads:  [0.01027142]
Stock Position:  0.010271418820727395
Bond Position:  [10.08325659]


portfolio before change:  [11.12222288]
curr_Stock_Price:  101.08983795534031
curr_Factors:  [101.08983796]
mat_Sqrt:  [[0.15]]
grads:  [0.01373258]
Stock Position:  0.0137325760847718
Bond Position:  [9.73399899]


portfolio before change:  [11.13313119]
curr_Stock_Price:  101.83987311611365
curr_Factors:  [101.83987312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02382412]
Stock Position:  -0.02382411532008564
Bond Position:  [13.55937607]


portfolio before change:  [11.13320799]
curr_Stock_Price:  101.87222214577793
curr_Factors:  [101.87222215]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223041]
Stock Position:  -0.022304100397873308
Bond Position:  [13.40537626]


portfolio before change:  [11.11677747]
curr_Stock_Price:  102.64644659919603
curr_Factors:  [102.6464466]
mat_Sqrt:  [[0.15]]
grads:  [0.0714118]
Stock Position:  0.07141179935637547
Bond Position:  [3.78661002]


portfolio before change:  [11.06561828]
curr_Stock_Price:  101.9267354628785
curr_Factors:  [101.92673546]
mat_Sqrt:  [[0.15]]
grads:  [-0.04239674]
Stock Position:  -0.042396736421151965
Bond Position:  [15.38697921]


portfolio before change:  [11.07600953]
curr_Stock_Price:  101.704323664068
curr_Factors:  [101.70432366]
mat_Sqrt:  [[0.15]]
grads:  [0.04464603]
Stock Position:  0.044646029616975946
Bond Position:  [6.53531528]


portfolio before change:  [11.05149112]
curr_Stock_Price:  101.1460013104792
curr_Factors:  [101.14600131]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266507]
Stock Position:  -0.02665070036016354
Bond Position:  [13.74710289]


portfolio before change:  [11.03730094]
curr_Stock_Price:  101.71069194643533
curr_Factors:  [101.71069195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01281099]
Stock Position:  -0.01281098648603581
Bond Position:  [12.34031524]


portfolio before change:  [11.03894888]
curr_Stock_Price:  101.64226298281818
curr_Factors:  [101.64226298]
mat_Sqrt:  [[0.15]]
grads:  [0.05360777]
Stock Position:  0.053607768511134024
Bond Position:  [5.59013397]


portfolio before change:  [11.06665591]
curr_Stock_Price:  102.15259280956295
curr_Factors:  [102.15259281]
mat_Sqrt:  [[0.15]]
grads:  [-0.10698968]
Stock Position:  -0.10698967829869444
Bond Position:  [21.99592896]


portfolio before change:  [11.01602436]
curr_Stock_Price:  102.63868030162098
curr_Factors:  [102.6386803]
mat_Sqrt:  [[0.15]]
grads:  [0.02268619]
Stock Position:  0.022686189891893114
Bond Position:  [8.68754377]


portfolio before change:  [11.01790957]
curr_Stock_Price:  102.69784506109673
curr_Factors:  [102.69784506]
mat_Sqrt:  [[0.15]]
grads:  [0.15478687]
Stock Position:  0.1547868653220647
Bond Position:  [-4.87836794]


portfolio before change:  [11.03360887]
curr_Stock_Price:  102.80124020355572
curr_Factors:  [102.8012402]
mat_Sqrt:  [[0.15]]
grads:  [0.05301461]
Stock Position:  0.053014611668010976
Bond Position:  [5.58364104]


portfolio before change:  [11.07252485]
curr_Stock_Price:  103.52871862869473
curr_Factors:  [103.52871863]
mat_Sqrt:  [[0.15]]
grads:  [0.07140769]
Stock Position:  0.07140769233241591
Bond Position:  [3.67977796]


portfolio before change:  [10.99498128]
curr_Stock_Price:  102.43957041233992
curr_Factors:  [102.43957041]
mat_Sqrt:  [[0.15]]
grads:  [0.04275103]
Stock Position:  0.04275103070985691
Bond Position:  [6.61558406]


portfolio before change:  [11.05614615]
curr_Stock_Price:  103.86062121515678
curr_Factors:  [103.86062122]
mat_Sqrt:  [[0.15]]
grads:  [0.04398918]
Stock Position:  0.04398917817461363
Bond Position:  [6.48740278]


portfolio before change:  [11.05650781]
curr_Stock_Price:  103.85962519868507
curr_Factors:  [103.8596252]
mat_Sqrt:  [[0.15]]
grads:  [0.07837199]
Stock Position:  0.07837198623717169
Bond Position:  [2.9168227]


portfolio before change:  [11.10076245]
curr_Stock_Price:  104.42197317632161
curr_Factors:  [104.42197318]
mat_Sqrt:  [[0.15]]
grads:  [0.01299149]
Stock Position:  0.012991487603431806
Bond Position:  [9.74416568]


portfolio before change:  [11.09551845]
curr_Stock_Price:  103.97144561169293
curr_Factors:  [103.97144561]
mat_Sqrt:  [[0.15]]
grads:  [-0.10187985]
Stock Position:  -0.10187985198826187
Bond Position:  [21.68811394]


portfolio before change:  [11.12453734]
curr_Stock_Price:  103.69991661984336
curr_Factors:  [103.69991662]
mat_Sqrt:  [[0.15]]
grads:  [-0.03536078]
Stock Position:  -0.035360779352299754
Bond Position:  [14.79144721]


portfolio before change:  [11.10940919]
curr_Stock_Price:  104.15388406648553
curr_Factors:  [104.15388407]
mat_Sqrt:  [[0.15]]
grads:  [0.00651019]
Stock Position:  0.006510192719870758
Bond Position:  [10.43134733]


portfolio before change:  [11.10878632]
curr_Stock_Price:  103.95806044786686
curr_Factors:  [103.95806045]
mat_Sqrt:  [[0.15]]
grads:  [0.01623511]
Stock Position:  0.01623511358719033
Bond Position:  [9.4210154]


portfolio before change:  [11.09025804]
curr_Stock_Price:  102.78054400571821
curr_Factors:  [102.78054401]
mat_Sqrt:  [[0.15]]
grads:  [-0.10422331]
Stock Position:  -0.10422331027853694
Bond Position:  [21.80238657]


portfolio before change:  [11.09917262]
curr_Stock_Price:  102.70808524969651
curr_Factors:  [102.70808525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02501877]
Stock Position:  -0.025018769099510778
Bond Position:  [13.66880249]


portfolio before change:  [11.10069436]
curr_Stock_Price:  102.68140899067777
curr_Factors:  [102.68140899]
mat_Sqrt:  [[0.15]]
grads:  [0.09237129]
Stock Position:  0.09237128540780036
Bond Position:  [1.61588062]


portfolio before change:  [11.03213428]
curr_Stock_Price:  101.93809276763494
curr_Factors:  [101.93809277]
mat_Sqrt:  [[0.15]]
grads:  [-0.0439632]
Stock Position:  -0.04396319648974087
Bond Position:  [15.51365868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.03359458]
Stock Price:  101.92693182427345
PL:  [9.10666276]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.01704562e-03]
 [ 4.55058323e-03]
 [ 2.70813337e-03]
 [-1.12561954e-02]
 [ 1.45357332e-02]
 [-6.95476958e-03]
 [-1.28108549e-04]
 [-7.01364504e-03]
 [-7.82842959e-03]
 [ 6.22009739e-04]
 [ 5.65574008e-03]
 [-2.66578065e-03]
 [-1.48735057e-03]
 [ 9.00993793e-03]
 [-1.44380549e-03]
 [ 5.46400607e-03]
 [ 1.16295884e-02]
 [-1.51989669e-02]
 [ 1.99928712e-02]
 [ 2.27986880e-03]
 [-3.62900313e-03]
 [ 5.46387233e-03]
 [ 1.23304989e-02]
 [ 1.51381491e-02]
 [ 8.12511996e-03]
 [ 4.45697214e-03]
 [ 2.41151774e-04]
 [ 1.62013472e-02]
 [-1.62839239e-02]
 [ 5.21171671e-02]
 [-6.77514237e-03]
 [ 1.99823503e-02]
 [ 1.28123310e-02]
 [-1.95026587e-02]
 [-1.50970380e-02]
 [-6.53381467e-02]
 [ 1.74137831e-02]
 [-4.65918601e-03]
 [ 1.85746190e-02]
 [ 9.30482709e-03]
 [ 6.54345932e-03]
 [ 3.54468182e-02]
 [-3.36897570e-03]
 [ 1.00756962e-02]
 [-2.80784580e-02]
 [ 1.82007872e-02]
 [ 1.00587888e-02]
 [ 5.26739286e-03]
 [-7.77045586e-03]
 [-7.18791763e-04]
 [-5.62193665e-03]
 [ 9.62158008e-04]
 [ 9.71527999e-04]
 [ 6.71990870e-03]
 [-8.94139437e-03]
 [-4.64124552e-03]
 [-7.70759689e-04]
 [ 1.21355313e-02]
 [ 8.25480245e-03]
 [-3.49221239e-03]
 [-2.40931456e-03]
 [ 6.25223963e-04]
 [-6.20454248e-03]
 [ 5.58726813e-03]
 [ 2.00627237e-02]
 [ 4.77085145e-03]
 [ 9.46878312e-03]
 [-4.80189612e-04]
 [ 2.82204094e-03]
 [ 2.19184109e-02]
 [ 2.17352337e-03]
 [-1.59087091e-02]
 [-6.02282894e-03]
 [ 1.00887215e-03]
 [ 4.56768650e-03]
 [-4.12560008e-04]
 [-1.48900732e-03]
 [-2.82051831e-03]
 [-2.38055859e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.86375388]
curr_Stock_Price:  100.31037911482213
curr_Factors:  [100.31037911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011364]
Stock Position:  -0.020113637478393967
Bond Position:  [10.88136048]


portfolio before change:  [8.875858]
curr_Stock_Price:  99.74240551031502
curr_Factors:  [99.74240551]
mat_Sqrt:  [[0.15]]
grads:  [0.03033722]
Stock Position:  0.030337221546314595
Bond Position:  [5.84995054]


portfolio before change:  [8.8811453]
curr_Stock_Price:  99.9046375846699
curr_Factors:  [99.90463758]
mat_Sqrt:  [[0.15]]
grads:  [0.01805422]
Stock Position:  0.01805422249416634
Bond Position:  [7.07744475]


portfolio before change:  [8.86490393]
curr_Stock_Price:  98.98054749774967
curr_Factors:  [98.9805475]
mat_Sqrt:  [[0.15]]
grads:  [-0.0750413]
Stock Position:  -0.07504130247496357
Bond Position:  [16.29253313]


portfolio before change:  [8.82445917]
curr_Stock_Price:  99.53308411018963
curr_Factors:  [99.53308411]
mat_Sqrt:  [[0.15]]
grads:  [0.09690489]
Stock Position:  0.09690488830787733
Bond Position:  [-0.82078322]


portfolio before change:  [8.85964277]
curr_Stock_Price:  99.8966869591814
curr_Factors:  [99.89668696]
mat_Sqrt:  [[0.15]]
grads:  [-0.04636513]
Stock Position:  -0.046365130544051156
Bond Position:  [13.4913657]


portfolio before change:  [8.84330031]
curr_Stock_Price:  100.26734679084207
curr_Factors:  [100.26734679]
mat_Sqrt:  [[0.15]]
grads:  [-0.00085406]
Stock Position:  -0.0008540569905206413
Bond Position:  [8.92893434]


portfolio before change:  [8.84411241]
curr_Stock_Price:  99.96991303144203
curr_Factors:  [99.96991303]
mat_Sqrt:  [[0.15]]
grads:  [-0.04675763]
Stock Position:  -0.04675763362375471
Bond Position:  [13.51846898]


portfolio before change:  [8.84893895]
curr_Stock_Price:  99.88475886222358
curr_Factors:  [99.88475886]
mat_Sqrt:  [[0.15]]
grads:  [-0.05218953]
Stock Position:  -0.05218953058524628
Bond Position:  [14.06187763]


portfolio before change:  [8.80105983]
curr_Stock_Price:  100.81900791637335
curr_Factors:  [100.81900792]
mat_Sqrt:  [[0.15]]
grads:  [0.00414673]
Stock Position:  0.004146731593603371
Bond Position:  [8.38299046]


portfolio before change:  [8.80016763]
curr_Stock_Price:  100.477496933174
curr_Factors:  [100.47749693]
mat_Sqrt:  [[0.15]]
grads:  [0.03770493]
Stock Position:  0.03770493388753976
Bond Position:  [5.01167025]


portfolio before change:  [8.78459595]
curr_Stock_Price:  100.05620156107807
curr_Factors:  [100.05620156]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777187]
Stock Position:  -0.017771870971931027
Bond Position:  [10.56278186]


portfolio before change:  [8.78910661]
curr_Stock_Price:  99.8395409515763
curr_Factors:  [99.83954095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00991567]
Stock Position:  -0.009915670437038704
Bond Position:  [9.77908259]


portfolio before change:  [8.78969163]
curr_Stock_Price:  99.84218202799092
curr_Factors:  [99.84218203]
mat_Sqrt:  [[0.15]]
grads:  [0.06006625]
Stock Position:  0.060066252871161914
Bond Position:  [2.79254588]


portfolio before change:  [8.748958]
curr_Stock_Price:  99.16113112869485
curr_Factors:  [99.16113113]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962537]
Stock Position:  -0.009625369921520539
Bond Position:  [9.70342057]


portfolio before change:  [8.75944084]
curr_Stock_Price:  98.13505510424646
curr_Factors:  [98.1350551]
mat_Sqrt:  [[0.15]]
grads:  [0.03642671]
Stock Position:  0.036426707149235966
Bond Position:  [5.18470393]


portfolio before change:  [8.79040661]
curr_Stock_Price:  98.97624324657934
curr_Factors:  [98.97624325]
mat_Sqrt:  [[0.15]]
grads:  [0.07753059]
Stock Position:  0.07753058943039275
Bond Position:  [1.11672013]


portfolio before change:  [8.83006049]
curr_Stock_Price:  99.48680414267193
curr_Factors:  [99.48680414]
mat_Sqrt:  [[0.15]]
grads:  [-0.10132645]
Stock Position:  -0.1013264459127136
Bond Position:  [18.91070477]


portfolio before change:  [8.78056851]
curr_Stock_Price:  99.98690989975408
curr_Factors:  [99.9869099]
mat_Sqrt:  [[0.15]]
grads:  [0.13328581]
Stock Position:  0.13328580782239707
Bond Position:  [-4.54626755]


portfolio before change:  [8.74249379]
curr_Stock_Price:  99.70337954694719
curr_Factors:  [99.70337955]
mat_Sqrt:  [[0.15]]
grads:  [0.01519913]
Stock Position:  0.015199125319145336
Bond Position:  [7.22708963]


portfolio before change:  [8.74159353]
curr_Stock_Price:  99.6144291856808
curr_Factors:  [99.61442919]
mat_Sqrt:  [[0.15]]
grads:  [-0.02419335]
Stock Position:  -0.024193354188967175
Bond Position:  [11.1516007]


portfolio before change:  [8.77452362]
curr_Stock_Price:  98.28211711946271
curr_Factors:  [98.28211712]
mat_Sqrt:  [[0.15]]
grads:  [0.03642582]
Stock Position:  0.03642581552526861
Bond Position:  [5.19451736]


portfolio before change:  [8.7415845]
curr_Stock_Price:  97.36892439673473
curr_Factors:  [97.3689244]
mat_Sqrt:  [[0.15]]
grads:  [0.08220333]
Stock Position:  0.0822033262876821
Bond Position:  [0.73753504]


portfolio before change:  [8.68057064]
curr_Stock_Price:  96.62613255171505
curr_Factors:  [96.62613255]
mat_Sqrt:  [[0.15]]
grads:  [0.10092099]
Stock Position:  0.10092099376150249
Bond Position:  [-1.07103468]


portfolio before change:  [8.66956601]
curr_Stock_Price:  96.51775388235488
curr_Factors:  [96.51775388]
mat_Sqrt:  [[0.15]]
grads:  [0.05416747]
Stock Position:  0.05416746641353658
Bond Position:  [3.44144382]


portfolio before change:  [8.6532596]
curr_Stock_Price:  96.2127459460581
curr_Factors:  [96.21274595]
mat_Sqrt:  [[0.15]]
grads:  [0.02971315]
Stock Position:  0.029713147595538843
Bond Position:  [5.79447608]


portfolio before change:  [8.6489957]
curr_Stock_Price:  96.05705482437082
curr_Factors:  [96.05705482]
mat_Sqrt:  [[0.15]]
grads:  [0.00160768]
Stock Position:  0.0016076784901467949
Bond Position:  [8.49456683]


portfolio before change:  [8.64957522]
curr_Stock_Price:  96.08728118230944
curr_Factors:  [96.08728118]
mat_Sqrt:  [[0.15]]
grads:  [0.10800898]
Stock Position:  0.1080089812038052
Bond Position:  [-1.72871413]


portfolio before change:  [8.63642484]
curr_Stock_Price:  95.96652893421191
curr_Factors:  [95.96652893]
mat_Sqrt:  [[0.15]]
grads:  [-0.10855949]
Stock Position:  -0.10855949269517377
Bond Position:  [19.05450254]


portfolio before change:  [8.5977224]
curr_Stock_Price:  96.33400840372838
curr_Factors:  [96.3340084]
mat_Sqrt:  [[0.15]]
grads:  [0.34744778]
Stock Position:  0.3474477805181733
Bond Position:  [-24.87331501]


portfolio before change:  [8.65969847]
curr_Stock_Price:  96.51685804472152
curr_Factors:  [96.51685804]
mat_Sqrt:  [[0.15]]
grads:  [-0.04516762]
Stock Position:  -0.04516761576854381
Bond Position:  [13.01913483]


portfolio before change:  [8.64539081]
curr_Stock_Price:  96.85164166368301
curr_Factors:  [96.85164166]
mat_Sqrt:  [[0.15]]
grads:  [0.13321567]
Stock Position:  0.13321566840857924
Bond Position:  [-4.25676537]


portfolio before change:  [8.54824547]
curr_Stock_Price:  96.12440520106897
curr_Factors:  [96.1244052]
mat_Sqrt:  [[0.15]]
grads:  [0.08541554]
Stock Position:  0.08541554025322666
Bond Position:  [0.33772747]


portfolio before change:  [8.53604449]
curr_Stock_Price:  95.98131544236428
curr_Factors:  [95.98131544]
mat_Sqrt:  [[0.15]]
grads:  [-0.13001772]
Stock Position:  -0.1300177247566128
Bond Position:  [21.01531674]


portfolio before change:  [8.58121669]
curr_Stock_Price:  95.64398680447283
curr_Factors:  [95.6439868]
mat_Sqrt:  [[0.15]]
grads:  [-0.10064692]
Stock Position:  -0.10064691996265716
Bond Position:  [18.20748937]


portfolio before change:  [8.68417494]
curr_Stock_Price:  94.63232897442826
curr_Factors:  [94.63232897]
mat_Sqrt:  [[0.15]]
grads:  [-0.43558764]
Stock Position:  -0.435587644801037
Bond Position:  [49.90484824]


portfolio before change:  [8.80745567]
curr_Stock_Price:  94.35646811084493
curr_Factors:  [94.35646811]
mat_Sqrt:  [[0.15]]
grads:  [0.11609189]
Stock Position:  0.11609188740794722
Bond Position:  [-2.1465648]


portfolio before change:  [8.94314518]
curr_Stock_Price:  95.52643505505546
curr_Factors:  [95.52643506]
mat_Sqrt:  [[0.15]]
grads:  [-0.03106124]
Stock Position:  -0.031061240099523824
Bond Position:  [11.91031471]


portfolio before change:  [8.92657215]
curr_Stock_Price:  96.0839610197318
curr_Factors:  [96.08396102]
mat_Sqrt:  [[0.15]]
grads:  [0.12383079]
Stock Position:  0.12383079339218557
Bond Position:  [-2.97158098]


portfolio before change:  [8.85878325]
curr_Stock_Price:  95.53802922805878
curr_Factors:  [95.53802923]
mat_Sqrt:  [[0.15]]
grads:  [0.06203218]
Stock Position:  0.0620321806051663
Bond Position:  [2.93235097]


portfolio before change:  [8.82498951]
curr_Stock_Price:  94.9902970482267
curr_Factors:  [94.99029705]
mat_Sqrt:  [[0.15]]
grads:  [0.04362306]
Stock Position:  0.04362306213016091
Bond Position:  [4.68122188]


portfolio before change:  [8.868005]
curr_Stock_Price:  95.96966220278674
curr_Factors:  [95.9696622]
mat_Sqrt:  [[0.15]]
grads:  [0.23631212]
Stock Position:  0.23631212159821063
Bond Position:  [-13.81078949]


portfolio before change:  [9.00239907]
curr_Stock_Price:  96.54202925903253
curr_Factors:  [96.54202926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245984]
Stock Position:  -0.022459838014505306
Bond Position:  [11.17071741]


portfolio before change:  [9.00143996]
curr_Stock_Price:  96.61581864568089
curr_Factors:  [96.61581865]
mat_Sqrt:  [[0.15]]
grads:  [0.06717131]
Stock Position:  0.0671713082834114
Bond Position:  [2.51162903]


portfolio before change:  [9.01281765]
curr_Stock_Price:  96.78286471405139
curr_Factors:  [96.78286471]
mat_Sqrt:  [[0.15]]
grads:  [-0.18718972]
Stock Position:  -0.18718972028296355
Bond Position:  [27.12957502]


portfolio before change:  [8.92271433]
curr_Stock_Price:  97.27327075431124
curr_Factors:  [97.27327075]
mat_Sqrt:  [[0.15]]
grads:  [0.12133858]
Stock Position:  0.12133858117963736
Bond Position:  [-2.88028633]


portfolio before change:  [8.95428604]
curr_Stock_Price:  97.53494957607789
curr_Factors:  [97.53494958]
mat_Sqrt:  [[0.15]]
grads:  [0.06705859]
Stock Position:  0.06705859178627971
Bond Position:  [2.41372968]


portfolio before change:  [8.98817648]
curr_Stock_Price:  98.03808525152408
curr_Factors:  [98.03808525]
mat_Sqrt:  [[0.15]]
grads:  [0.03511595]
Stock Position:  0.035115952411983516
Bond Position:  [5.54547574]


portfolio before change:  [8.95550553]
curr_Stock_Price:  97.09784152333809
curr_Factors:  [97.09784152]
mat_Sqrt:  [[0.15]]
grads:  [-0.05180304]
Stock Position:  -0.05180303907669596
Bond Position:  [13.9854688]


portfolio before change:  [8.91643076]
curr_Stock_Price:  97.86901034812523
curr_Factors:  [97.86901035]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479195]
Stock Position:  -0.0047919450861096105
Bond Position:  [9.38541368]


portfolio before change:  [8.9166802]
curr_Stock_Price:  97.93937173708878
curr_Factors:  [97.93937174]
mat_Sqrt:  [[0.15]]
grads:  [-0.03747958]
Stock Position:  -0.037479577668314674
Bond Position:  [12.58740649]


portfolio before change:  [8.89581378]
curr_Stock_Price:  98.51710383113023
curr_Factors:  [98.51710383]
mat_Sqrt:  [[0.15]]
grads:  [0.00641439]
Stock Position:  0.0064143867222999276
Bond Position:  [8.26388698]


portfolio before change:  [8.89241548]
curr_Stock_Price:  97.90678751083396
curr_Factors:  [97.90678751]
mat_Sqrt:  [[0.15]]
grads:  [0.00647685]
Stock Position:  0.0064768533244174056
Bond Position:  [8.25828758]


portfolio before change:  [8.88833726]
curr_Stock_Price:  97.1974338024077
curr_Factors:  [97.1974338]
mat_Sqrt:  [[0.15]]
grads:  [0.04479939]
Stock Position:  0.04479939135915786
Bond Position:  [4.53395139]


portfolio before change:  [8.91340235]
curr_Stock_Price:  97.75060449927503
curr_Factors:  [97.7506045]
mat_Sqrt:  [[0.15]]
grads:  [-0.0596093]
Stock Position:  -0.05960929579244461
Bond Position:  [14.74024705]


portfolio before change:  [8.91928674]
curr_Stock_Price:  97.66734411360589
curr_Factors:  [97.66734411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03094164]
Stock Position:  -0.030941636783914303
Bond Position:  [11.94127423]


portfolio before change:  [8.92594136]
curr_Stock_Price:  97.47639532652592
curr_Factors:  [97.47639533]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051384]
Stock Position:  -0.005138397924671793
Bond Position:  [9.42681387]


portfolio before change:  [8.92630131]
curr_Stock_Price:  97.52100938901454
curr_Factors:  [97.52100939]
mat_Sqrt:  [[0.15]]
grads:  [0.08090354]
Stock Position:  0.08090354220863974
Bond Position:  [1.03650621]


portfolio before change:  [8.94065809]
curr_Stock_Price:  97.69766416869979
curr_Factors:  [97.69766417]
mat_Sqrt:  [[0.15]]
grads:  [0.05503202]
Stock Position:  0.05503201633828622
Bond Position:  [3.56415864]


portfolio before change:  [8.92451381]
curr_Stock_Price:  97.40025454846723
curr_Factors:  [97.40025455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02328142]
Stock Position:  -0.023281415947369606
Bond Position:  [11.19212965]


portfolio before change:  [8.89590267]
curr_Stock_Price:  98.65922723113034
curr_Factors:  [98.65922723]
mat_Sqrt:  [[0.15]]
grads:  [-0.0160621]
Stock Position:  -0.016062097046150595
Bond Position:  [10.48057675]


portfolio before change:  [8.90217602]
curr_Stock_Price:  98.30944168074029
curr_Factors:  [98.30944168]
mat_Sqrt:  [[0.15]]
grads:  [0.00416816]
Stock Position:  0.0041681597521922315
Bond Position:  [8.49240656]


portfolio before change:  [8.90450747]
curr_Stock_Price:  98.74144514800062
curr_Factors:  [98.74144515]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136362]
Stock Position:  -0.04136361653982755
Bond Position:  [12.98881074]


portfolio before change:  [8.8893063]
curr_Stock_Price:  99.12857274900595
curr_Factors:  [99.12857275]
mat_Sqrt:  [[0.15]]
grads:  [0.03724845]
Stock Position:  0.0372484542174616
Bond Position:  [5.19692019]


portfolio before change:  [8.87274995]
curr_Stock_Price:  98.6753683478805
curr_Factors:  [98.67536835]
mat_Sqrt:  [[0.15]]
grads:  [0.13375149]
Stock Position:  0.13375149100527003
Bond Position:  [-4.32522769]


portfolio before change:  [8.87050951]
curr_Stock_Price:  98.66063873973476
curr_Factors:  [98.66063874]
mat_Sqrt:  [[0.15]]
grads:  [0.03180568]
Stock Position:  0.031805676327835354
Bond Position:  [5.73254117]


portfolio before change:  [8.87582135]
curr_Stock_Price:  98.81638280345013
curr_Factors:  [98.8163828]
mat_Sqrt:  [[0.15]]
grads:  [0.06312522]
Stock Position:  0.06312522083288857
Bond Position:  [2.63801536]


portfolio before change:  [8.85547831]
curr_Stock_Price:  98.49150605425181
curr_Factors:  [98.49150605]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320126]
Stock Position:  -0.003201264080716854
Bond Position:  [9.17077563]


portfolio before change:  [8.85249154]
curr_Stock_Price:  99.60355573779889
curr_Factors:  [99.60355574]
mat_Sqrt:  [[0.15]]
grads:  [0.01881361]
Stock Position:  0.018813606278015746
Bond Position:  [6.97858946]


portfolio before change:  [8.84271467]
curr_Stock_Price:  99.060701334169
curr_Factors:  [99.06070133]
mat_Sqrt:  [[0.15]]
grads:  [0.14612274]
Stock Position:  0.14612273910865028
Bond Position:  [-5.63230635]


portfolio before change:  [8.83724823]
curr_Stock_Price:  99.02570056785089
curr_Factors:  [99.02570057]
mat_Sqrt:  [[0.15]]
grads:  [0.01449016]
Stock Position:  0.014490155824547681
Bond Position:  [7.4023504]


portfolio before change:  [8.83619006]
curr_Stock_Price:  98.92074450859867
curr_Factors:  [98.92074451]
mat_Sqrt:  [[0.15]]
grads:  [-0.10605806]
Stock Position:  -0.10605806082723472
Bond Position:  [19.3275324]


portfolio before change:  [8.80651298]
curr_Stock_Price:  99.21195376971419
curr_Factors:  [99.21195377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04015219]
Stock Position:  -0.04015219295152311
Bond Position:  [12.79009049]


portfolio before change:  [8.82271382]
curr_Stock_Price:  98.82837729569113
curr_Factors:  [98.8283773]
mat_Sqrt:  [[0.15]]
grads:  [0.00672581]
Stock Position:  0.006725814331099812
Bond Position:  [8.1580125]


portfolio before change:  [8.82283175]
curr_Stock_Price:  98.77009974185862
curr_Factors:  [98.77009974]
mat_Sqrt:  [[0.15]]
grads:  [0.03045124]
Stock Position:  0.030451243347000546
Bond Position:  [5.81515941]


portfolio before change:  [8.82045137]
curr_Stock_Price:  98.67999391595627
curr_Factors:  [98.67999392]
mat_Sqrt:  [[0.15]]
grads:  [-0.0027504]
Stock Position:  -0.0027504000535692164
Bond Position:  [9.09186083]


portfolio before change:  [8.82289994]
curr_Stock_Price:  97.99634404205965
curr_Factors:  [97.99634404]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992672]
Stock Position:  -0.009926715495110617
Bond Position:  [9.79568177]


portfolio before change:  [8.82302249]
curr_Stock_Price:  98.04567615774707
curr_Factors:  [98.04567616]
mat_Sqrt:  [[0.15]]
grads:  [-0.01880346]
Stock Position:  -0.01880345540928801
Bond Position:  [10.66661999]


portfolio before change:  [8.8136115]
curr_Stock_Price:  98.58162373247579
curr_Factors:  [98.58162373]
mat_Sqrt:  [[0.15]]
grads:  [-0.15870391]
Stock Position:  -0.15870390583423183
Bond Position:  [24.45890023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.83320617]
Stock Price:  98.46778947629397
PL:  [8.83320617]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.24854589e-02]
 [ 4.15052220e-03]
 [ 4.95788318e-03]
 [-1.12520188e-02]
 [ 1.23836483e-02]
 [-5.95544744e-03]
 [ 7.50301821e-04]
 [-2.66523265e-03]
 [ 2.93711222e-03]
 [-6.38057507e-03]
 [ 1.35402746e-02]
 [-2.30425670e-03]
 [-9.92066791e-04]
 [ 9.55153056e-03]
 [-7.98165970e-04]
 [ 1.33092926e-02]
 [ 4.98172746e-02]
 [-1.42908765e-02]
 [ 1.88797494e-02]
 [ 1.40022255e-03]
 [-4.74378288e-03]
 [ 4.68022745e-03]
 [ 6.53623372e-03]
 [ 4.45132389e-02]
 [ 3.72662261e-03]
 [ 7.36009055e-03]
 [ 4.59243974e-02]
 [ 2.40055169e-02]
 [ 1.06482901e-02]
 [-8.80010004e-03]
 [ 6.31402862e-03]
 [ 1.55568622e-02]
 [ 1.58098587e-02]
 [-9.69285262e-03]
 [ 4.27567331e-03]
 [-9.25550908e-03]
 [-9.78481336e-03]
 [-1.09680807e-02]
 [-6.68313848e-03]
 [-4.30833088e-02]
 [ 3.32400659e-03]
 [ 2.16649255e-03]
 [-1.36078999e-02]
 [ 1.07529576e-02]
 [ 4.44381625e-04]
 [ 1.17488899e-02]
 [ 1.05725235e-02]
 [-1.87663233e-03]
 [ 1.20614668e-02]
 [-1.19460981e-03]
 [ 2.14729867e-02]
 [ 7.25774844e-04]
 [-1.74941359e-03]
 [-1.46067362e-02]
 [-2.43325895e-03]
 [-3.17330528e-03]
 [ 1.07213120e-02]
 [-1.33476351e-02]
 [ 5.02115842e-03]
 [-3.84438313e-03]
 [-3.61900754e-03]
 [ 6.11816335e-03]
 [-1.99255268e-02]
 [ 1.25399005e-03]
 [ 1.12383042e-02]
 [ 1.63789615e-02]
 [ 3.55942945e-03]
 [ 1.29395743e-02]
 [ 6.84104357e-03]
 [ 1.12200698e-02]
 [ 2.70804223e-03]
 [-1.50011686e-02]
 [-2.64253314e-02]
 [ 7.13614914e-04]
 [-4.27210875e-03]
 [-2.34000770e-02]
 [-4.73200605e-03]
 [ 1.43891176e-02]
 [ 1.48469434e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.34284787]
curr_Stock_Price:  99.12012896815875
curr_Factors:  [99.12012897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323639]
Stock Position:  -0.08323639284827859
Bond Position:  [-9.09244588]


portfolio before change:  [-17.39413212]
curr_Stock_Price:  99.72942912266002
curr_Factors:  [99.72942912]
mat_Sqrt:  [[0.15]]
grads:  [0.02767015]
Stock Position:  0.027670147970402098
Bond Position:  [-20.15366018]


portfolio before change:  [-17.39619164]
curr_Stock_Price:  99.70052161760198
curr_Factors:  [99.70052162]
mat_Sqrt:  [[0.15]]
grads:  [0.03305255]
Stock Position:  0.0330525545609015
Bond Position:  [-20.69154857]


portfolio before change:  [-17.42125798]
curr_Stock_Price:  98.98127051419907
curr_Factors:  [98.98127051]
mat_Sqrt:  [[0.15]]
grads:  [-0.07501346]
Stock Position:  -0.07501345887728744
Bond Position:  [-9.99633052]


portfolio before change:  [-17.48771751]
curr_Stock_Price:  99.85890953823117
curr_Factors:  [99.85890954]
mat_Sqrt:  [[0.15]]
grads:  [0.08255766]
Stock Position:  0.08255765509619396
Bond Position:  [-25.73183493]


portfolio before change:  [-17.47712495]
curr_Stock_Price:  100.006695402253
curr_Factors:  [100.0066954]
mat_Sqrt:  [[0.15]]
grads:  [-0.03970298]
Stock Position:  -0.039702982963666034
Bond Position:  [-13.50656082]


portfolio before change:  [-17.4853977]
curr_Stock_Price:  100.19379876489297
curr_Factors:  [100.19379876]
mat_Sqrt:  [[0.15]]
grads:  [0.00500201]
Stock Position:  0.005002012137672179
Bond Position:  [-17.98656829]


portfolio before change:  [-17.48901398]
curr_Stock_Price:  99.69558249007186
curr_Factors:  [99.69558249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01776822]
Stock Position:  -0.01776821769353949
Bond Position:  [-15.71760116]


portfolio before change:  [-17.50388024]
curr_Stock_Price:  100.47697100168845
curr_Factors:  [100.476971]
mat_Sqrt:  [[0.15]]
grads:  [0.01958075]
Stock Position:  0.01958074811258939
Bond Position:  [-19.4712945]


portfolio before change:  [-17.5220874]
curr_Stock_Price:  99.60927317494651
curr_Factors:  [99.60927317]
mat_Sqrt:  [[0.15]]
grads:  [-0.04253717]
Stock Position:  -0.04253716712417831
Bond Position:  [-13.2849911]


portfolio before change:  [-17.51430514]
curr_Stock_Price:  99.40680088095446
curr_Factors:  [99.40680088]
mat_Sqrt:  [[0.15]]
grads:  [0.0902685]
Stock Position:  0.09026849712140694
Bond Position:  [-26.48760766]


portfolio before change:  [-17.44916686]
curr_Stock_Price:  100.14674689909688
curr_Factors:  [100.1467469]
mat_Sqrt:  [[0.15]]
grads:  [-0.01536171]
Stock Position:  -0.015361711350623525
Bond Position:  [-15.91074144]


portfolio before change:  [-17.43986837]
curr_Stock_Price:  99.47670814911648
curr_Factors:  [99.47670815]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661378]
Stock Position:  -0.00661377860461451
Bond Position:  [-16.78195144]


portfolio before change:  [-17.44513484]
curr_Stock_Price:  100.11440239714794
curr_Factors:  [100.1144024]
mat_Sqrt:  [[0.15]]
grads:  [0.06367687]
Stock Position:  0.06367687037052294
Bond Position:  [-23.82010666]


portfolio before change:  [-17.45409049]
curr_Stock_Price:  99.99714084388533
curr_Factors:  [99.99714084]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532111]
Stock Position:  -0.005321106468864668
Bond Position:  [-16.92199506]


portfolio before change:  [-17.45564164]
curr_Stock_Price:  100.08988254926972
curr_Factors:  [100.08988255]
mat_Sqrt:  [[0.15]]
grads:  [0.08872862]
Stock Position:  0.08872861758068558
Bond Position:  [-26.33647855]


portfolio before change:  [-17.39546258]
curr_Stock_Price:  100.7866717100487
curr_Factors:  [100.78667171]
mat_Sqrt:  [[0.15]]
grads:  [0.33211516]
Stock Position:  0.33211516387149076
Bond Position:  [-50.86824457]


portfolio before change:  [-17.30924158]
curr_Stock_Price:  101.05585655072325
curr_Factors:  [101.05585655]
mat_Sqrt:  [[0.15]]
grads:  [-0.09527251]
Stock Position:  -0.0952725098568483
Bond Position:  [-7.68139649]


portfolio before change:  [-17.36185617]
curr_Stock_Price:  101.6030709212412
curr_Factors:  [101.60307092]
mat_Sqrt:  [[0.15]]
grads:  [0.125865]
Stock Position:  0.1258649962344032
Bond Position:  [-30.15012631]


portfolio before change:  [-17.36728021]
curr_Stock_Price:  101.57494869277924
curr_Factors:  [101.57494869]
mat_Sqrt:  [[0.15]]
grads:  [0.00933482]
Stock Position:  0.009334817008350812
Bond Position:  [-18.31546377]


portfolio before change:  [-17.36628907]
curr_Stock_Price:  101.80375829260998
curr_Factors:  [101.80375829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03162522]
Stock Position:  -0.03162521921164465
Bond Position:  [-14.1467229]


portfolio before change:  [-17.36168068]
curr_Stock_Price:  101.63008094781323
curr_Factors:  [101.63008095]
mat_Sqrt:  [[0.15]]
grads:  [0.03120152]
Stock Position:  0.031201516306714194
Bond Position:  [-20.53269331]


portfolio before change:  [-17.33002435]
curr_Stock_Price:  102.68578807677153
curr_Factors:  [102.68578808]
mat_Sqrt:  [[0.15]]
grads:  [0.04357489]
Stock Position:  0.04357489143543134
Bond Position:  [-21.80454642]


portfolio before change:  [-17.30074834]
curr_Stock_Price:  103.38891866405898
curr_Factors:  [103.38891866]
mat_Sqrt:  [[0.15]]
grads:  [0.29675493]
Stock Position:  0.2967549262881422
Bond Position:  [-47.98191928]


portfolio before change:  [-17.28313708]
curr_Stock_Price:  103.45837065887001
curr_Factors:  [103.45837066]
mat_Sqrt:  [[0.15]]
grads:  [0.02484415]
Stock Position:  0.02484415073626381
Bond Position:  [-19.85347244]


portfolio before change:  [-17.28136017]
curr_Stock_Price:  103.57983959161355
curr_Factors:  [103.57983959]
mat_Sqrt:  [[0.15]]
grads:  [0.04906727]
Stock Position:  0.04906727035485354
Bond Position:  [-22.36374016]


portfolio before change:  [-17.28140091]
curr_Stock_Price:  103.60749635893451
curr_Factors:  [103.60749636]
mat_Sqrt:  [[0.15]]
grads:  [0.30616265]
Stock Position:  0.3061626493054487
Bond Position:  [-49.00214648]


portfolio before change:  [-17.32828999]
curr_Stock_Price:  103.46434906931671
curr_Factors:  [103.46434907]
mat_Sqrt:  [[0.15]]
grads:  [0.16003678]
Stock Position:  0.16003677962144786
Bond Position:  [-33.88639122]


portfolio before change:  [-17.26934663]
curr_Stock_Price:  103.84589462022376
curr_Factors:  [103.84589462]
mat_Sqrt:  [[0.15]]
grads:  [0.0709886]
Stock Position:  0.0709886003879384
Bond Position:  [-24.64122135]


portfolio before change:  [-17.19101024]
curr_Stock_Price:  104.97109662584566
curr_Factors:  [104.97109663]
mat_Sqrt:  [[0.15]]
grads:  [-0.05866733]
Stock Position:  -0.05866733361185877
Bond Position:  [-11.0326359]


portfolio before change:  [-17.19939999]
curr_Stock_Price:  105.10234820652718
curr_Factors:  [105.10234821]
mat_Sqrt:  [[0.15]]
grads:  [0.04209352]
Stock Position:  0.04209352414133664
Bond Position:  [-21.62352822]


portfolio before change:  [-17.21609449]
curr_Stock_Price:  104.73785063988397
curr_Factors:  [104.73785064]
mat_Sqrt:  [[0.15]]
grads:  [0.10371241]
Stock Position:  0.10371241450473463
Bond Position:  [-28.07870987]


portfolio before change:  [-17.23139386]
curr_Stock_Price:  104.60725484677077
curr_Factors:  [104.60725485]
mat_Sqrt:  [[0.15]]
grads:  [0.10539906]
Stock Position:  0.10539905821151027
Bond Position:  [-28.25690001]


portfolio before change:  [-17.18400518]
curr_Stock_Price:  105.07362328034637
curr_Factors:  [105.07362328]
mat_Sqrt:  [[0.15]]
grads:  [-0.06461902]
Stock Position:  -0.06461901743617225
Bond Position:  [-10.39425089]


portfolio before change:  [-17.15311226]
curr_Stock_Price:  104.58549166012376
curr_Factors:  [104.58549166]
mat_Sqrt:  [[0.15]]
grads:  [0.02850449]
Stock Position:  0.028504488765224725
Bond Position:  [-20.13426823]


portfolio before change:  [-17.15109234]
curr_Stock_Price:  104.7005031536837
curr_Factors:  [104.70050315]
mat_Sqrt:  [[0.15]]
grads:  [-0.06170339]
Stock Position:  -0.06170339387308069
Bond Position:  [-10.69071596]


portfolio before change:  [-17.14154747]
curr_Stock_Price:  104.53498439756507
curr_Factors:  [104.5349844]
mat_Sqrt:  [[0.15]]
grads:  [-0.06523209]
Stock Position:  -0.06523208909312314
Bond Position:  [-10.32251205]


portfolio before change:  [-17.11801771]
curr_Stock_Price:  104.16438555350098
curr_Factors:  [104.16438555]
mat_Sqrt:  [[0.15]]
grads:  [-0.07312054]
Stock Position:  -0.073120538132123
Bond Position:  [-9.50146178]


portfolio before change:  [-17.12545476]
curr_Stock_Price:  104.25797343069762
curr_Factors:  [104.25797343]
mat_Sqrt:  [[0.15]]
grads:  [-0.04455426]
Stock Position:  -0.044554256527340984
Bond Position:  [-12.48031827]


portfolio before change:  [-17.14687055]
curr_Stock_Price:  104.72113332446241
curr_Factors:  [104.72113332]
mat_Sqrt:  [[0.15]]
grads:  [-0.28722206]
Stock Position:  -0.2872220588231774
Bond Position:  [12.93134896]


portfolio before change:  [-17.4094752]
curr_Stock_Price:  105.6382386765621
curr_Factors:  [105.63823868]
mat_Sqrt:  [[0.15]]
grads:  [0.02216004]
Stock Position:  0.022160043964896972
Bond Position:  [-19.75042322]


portfolio before change:  [-17.41993755]
curr_Stock_Price:  105.22181760386997
curr_Factors:  [105.2218176]
mat_Sqrt:  [[0.15]]
grads:  [0.01444328]
Stock Position:  0.014443283686040148
Bond Position:  [-18.93968612]


portfolio before change:  [-17.42770378]
curr_Stock_Price:  104.76607226850867
curr_Factors:  [104.76607227]
mat_Sqrt:  [[0.15]]
grads:  [-0.09071933]
Stock Position:  -0.0907193326242251
Bond Position:  [-7.92339562]


portfolio before change:  [-17.41552506]
curr_Stock_Price:  104.62636727049345
curr_Factors:  [104.62636727]
mat_Sqrt:  [[0.15]]
grads:  [0.07168638]
Stock Position:  0.07168638373718318
Bond Position:  [-24.91581098]


portfolio before change:  [-17.43304351]
curr_Stock_Price:  104.40371461689672
curr_Factors:  [104.40371462]
mat_Sqrt:  [[0.15]]
grads:  [0.00296254]
Stock Position:  0.00296254416560444
Bond Position:  [-17.74234413]


portfolio before change:  [-17.43571963]
curr_Stock_Price:  103.87471336328586
curr_Factors:  [103.87471336]
mat_Sqrt:  [[0.15]]
grads:  [0.07832593]
Stock Position:  0.07832593261531981
Bond Position:  [-25.57180343]


portfolio before change:  [-17.44771818]
curr_Stock_Price:  103.74193155505583
curr_Factors:  [103.74193156]
mat_Sqrt:  [[0.15]]
grads:  [0.07048349]
Stock Position:  0.0704834901696185
Bond Position:  [-24.75981159]


portfolio before change:  [-17.4832873]
curr_Stock_Price:  103.25924288477728
curr_Factors:  [103.25924288]
mat_Sqrt:  [[0.15]]
grads:  [-0.01251088]
Stock Position:  -0.012510882219175812
Bond Position:  [-16.19142307]


portfolio before change:  [-17.48559069]
curr_Stock_Price:  103.3624644904194
curr_Factors:  [103.36246449]
mat_Sqrt:  [[0.15]]
grads:  [0.08040978]
Stock Position:  0.08040977895898109
Bond Position:  [-25.79694361]


portfolio before change:  [-17.51359343]
curr_Stock_Price:  103.03426586866193
curr_Factors:  [103.03426587]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796407]
Stock Position:  -0.007964065431155859
Bond Position:  [-16.69302179]


portfolio before change:  [-17.5189843]
curr_Stock_Price:  103.58015879237608
curr_Factors:  [103.58015879]
mat_Sqrt:  [[0.15]]
grads:  [0.14315324]
Stock Position:  0.14315324477070449
Bond Position:  [-32.34682013]


portfolio before change:  [-17.54613466]
curr_Stock_Price:  103.4046223103087
curr_Factors:  [103.40462231]
mat_Sqrt:  [[0.15]]
grads:  [0.0048385]
Stock Position:  0.004838498962046675
Bond Position:  [-18.04645781]


portfolio before change:  [-17.547029]
curr_Stock_Price:  103.45290077990167
curr_Factors:  [103.45290078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01166276]
Stock Position:  -0.01166275728462435
Bond Position:  [-16.34048293]


portfolio before change:  [-17.54264511]
curr_Stock_Price:  102.98944262732101
curr_Factors:  [102.98944263]
mat_Sqrt:  [[0.15]]
grads:  [-0.09737824]
Stock Position:  -0.09737824130284639
Bond Position:  [-7.51371432]


portfolio before change:  [-17.5495922]
curr_Stock_Price:  103.05596119169353
curr_Factors:  [103.05596119]
mat_Sqrt:  [[0.15]]
grads:  [-0.01622173]
Stock Position:  -0.016221726362743556
Bond Position:  [-15.87784659]


portfolio before change:  [-17.54417426]
curr_Stock_Price:  102.66079197330457
curr_Factors:  [102.66079197]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115537]
Stock Position:  -0.02115536851010777
Bond Position:  [-15.37234738]


portfolio before change:  [-17.54562805]
curr_Stock_Price:  102.68409511461562
curr_Factors:  [102.68409511]
mat_Sqrt:  [[0.15]]
grads:  [0.07147541]
Stock Position:  0.07147541348359797
Bond Position:  [-24.88501621]


portfolio before change:  [-17.50621037]
curr_Stock_Price:  103.25734176497215
curr_Factors:  [103.25734176]
mat_Sqrt:  [[0.15]]
grads:  [-0.08898423]
Stock Position:  -0.08898423369546415
Bond Position:  [-8.31793494]


portfolio before change:  [-17.49266386]
curr_Stock_Price:  103.09926431361299
curr_Factors:  [103.09926431]
mat_Sqrt:  [[0.15]]
grads:  [0.03347439]
Stock Position:  0.03347438945102134
Bond Position:  [-20.94384879]


portfolio before change:  [-17.50501519]
curr_Stock_Price:  102.76939140050334
curr_Factors:  [102.7693914]
mat_Sqrt:  [[0.15]]
grads:  [-0.02562922]
Stock Position:  -0.025629220882895123
Bond Position:  [-14.87111575]


portfolio before change:  [-17.51877992]
curr_Stock_Price:  103.27019710045799
curr_Factors:  [103.2701971]
mat_Sqrt:  [[0.15]]
grads:  [-0.02412672]
Stock Position:  -0.024126716915440594
Bond Position:  [-15.02720911]


portfolio before change:  [-17.52619605]
curr_Stock_Price:  103.53865040199682
curr_Factors:  [103.5386504]
mat_Sqrt:  [[0.15]]
grads:  [0.04078776]
Stock Position:  0.04078775566185268
Bond Position:  [-21.74930522]


portfolio before change:  [-17.51217427]
curr_Stock_Price:  103.91575267066797
curr_Factors:  [103.91575267]
mat_Sqrt:  [[0.15]]
grads:  [-0.13283685]
Stock Position:  -0.13283684566175658
Bond Position:  [-3.70833347]


portfolio before change:  [-17.47502408]
curr_Stock_Price:  103.63434003666876
curr_Factors:  [103.63434004]
mat_Sqrt:  [[0.15]]
grads:  [0.00835993]
Stock Position:  0.008359933689034735
Bond Position:  [-18.34140029]


portfolio before change:  [-17.46498266]
curr_Stock_Price:  104.97260268275636
curr_Factors:  [104.97260268]
mat_Sqrt:  [[0.15]]
grads:  [0.07492203]
Stock Position:  0.07492202772603361
Bond Position:  [-25.32974291]


portfolio before change:  [-17.46998114]
curr_Stock_Price:  104.92701765400115
curr_Factors:  [104.92701765]
mat_Sqrt:  [[0.15]]
grads:  [0.10919308]
Stock Position:  0.10919307690668688
Bond Position:  [-28.92728505]


portfolio before change:  [-17.43513037]
curr_Stock_Price:  105.26274207112635
curr_Factors:  [105.26274207]
mat_Sqrt:  [[0.15]]
grads:  [0.02372953]
Stock Position:  0.02372952969272034
Bond Position:  [-19.93296574]


portfolio before change:  [-17.44178737]
curr_Stock_Price:  105.03470790875633
curr_Factors:  [105.03470791]
mat_Sqrt:  [[0.15]]
grads:  [0.08626383]
Stock Position:  0.08626382856554286
Bond Position:  [-26.5024834]


portfolio before change:  [-17.51037191]
curr_Stock_Price:  104.2588544421955
curr_Factors:  [104.25885444]
mat_Sqrt:  [[0.15]]
grads:  [0.04560696]
Stock Position:  0.04560695713461932
Bond Position:  [-22.26530102]


portfolio before change:  [-17.51186789]
curr_Stock_Price:  104.25656632546195
curr_Factors:  [104.25656633]
mat_Sqrt:  [[0.15]]
grads:  [0.07480047]
Stock Position:  0.07480046516335305
Bond Position:  [-25.31030755]


portfolio before change:  [-17.46471469]
curr_Stock_Price:  104.90810160224939
curr_Factors:  [104.9081016]
mat_Sqrt:  [[0.15]]
grads:  [0.01805361]
Stock Position:  0.018053614883184674
Bond Position:  [-19.35868516]


portfolio before change:  [-17.4528106]
curr_Stock_Price:  105.63449637919162
curr_Factors:  [105.63449638]
mat_Sqrt:  [[0.15]]
grads:  [-0.10000779]
Stock Position:  -0.10000779085301348
Bond Position:  [-6.88853798]


portfolio before change:  [-17.48398177]
curr_Stock_Price:  105.94187862697757
curr_Factors:  [105.94187863]
mat_Sqrt:  [[0.15]]
grads:  [-0.17616888]
Stock Position:  -0.17616887576552775
Bond Position:  [1.17967989]


portfolio before change:  [-17.49035178]
curr_Stock_Price:  105.97845570649852
curr_Factors:  [105.97845571]
mat_Sqrt:  [[0.15]]
grads:  [0.00475743]
Stock Position:  0.004757432758919932
Bond Position:  [-17.99453715]


portfolio before change:  [-17.48959871]
curr_Stock_Price:  106.37315558950846
curr_Factors:  [106.37315559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848073]
Stock Position:  -0.028480725026949774
Bond Position:  [-14.46001412]


portfolio before change:  [-17.48292631]
curr_Stock_Price:  106.10714487443981
curr_Factors:  [106.10714487]
mat_Sqrt:  [[0.15]]
grads:  [-0.15600051]
Stock Position:  -0.15600051362712064
Bond Position:  [-0.93015721]


portfolio before change:  [-17.44598246]
curr_Stock_Price:  105.86995339929184
curr_Factors:  [105.8699534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03154671]
Stock Position:  -0.03154670699216766
Bond Position:  [-14.10613406]


portfolio before change:  [-17.44449138]
curr_Stock_Price:  105.79473997672753
curr_Factors:  [105.79473998]
mat_Sqrt:  [[0.15]]
grads:  [0.09592745]
Stock Position:  0.09592745092682406
Bond Position:  [-27.59311111]


portfolio before change:  [-17.46937463]
curr_Stock_Price:  105.5533218412105
curr_Factors:  [105.55332184]
mat_Sqrt:  [[0.15]]
grads:  [0.09897962]
Stock Position:  0.0989796226871
Bond Position:  [-27.9170026]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.42895563]
Stock Price:  105.97930719881083
PL:  [-23.40826283]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.22796321e-02]
 [ 1.30151837e-02]
 [ 3.32094408e-03]
 [-7.57088633e-03]
 [-2.88948057e-03]
 [-1.15057605e-03]
 [ 4.24975728e-04]
 [-4.81032339e-03]
 [ 9.57230790e-03]
 [-4.72797182e-03]
 [-8.77027377e-03]
 [ 1.09208272e-02]
 [-3.34429101e-03]
 [ 6.43251546e-03]
 [-1.23587221e-04]
 [ 1.35611877e-02]
 [ 4.33126519e-02]
 [-1.52136101e-02]
 [ 2.02709587e-02]
 [ 2.37904778e-03]
 [-3.86616494e-03]
 [ 4.13790036e-03]
 [ 1.58664322e-02]
 [ 1.78402353e-02]
 [-5.81546635e-03]
 [ 4.64521163e-03]
 [ 7.21277706e-03]
 [ 8.22302260e-03]
 [ 1.65360242e-02]
 [ 1.58361362e-03]
 [-6.82027947e-03]
 [ 1.00203870e-02]
 [ 1.25130217e-02]
 [ 9.44901116e-03]
 [ 6.11958039e-03]
 [ 9.30599866e-03]
 [-2.70236871e-02]
 [ 1.11332565e-03]
 [-3.15226237e-02]
 [-1.08392878e-02]
 [ 4.05767376e-03]
 [ 1.02504582e-02]
 [-8.04615660e-03]
 [-1.47796965e-03]
 [ 1.07075188e-02]
 [ 1.21799365e-02]
 [ 1.06095339e-02]
 [-1.24254736e-03]
 [ 1.20107996e-02]
 [-1.18059552e-03]
 [ 2.18136436e-02]
 [-3.65013073e-03]
 [-1.75479432e-03]
 [-1.89672005e-02]
 [-2.43323649e-03]
 [-2.98172371e-03]
 [ 8.50963064e-03]
 [-9.86854295e-03]
 [ 4.84303725e-03]
 [-3.85549886e-03]
 [-4.37435882e-03]
 [ 5.87106330e-03]
 [-1.94823201e-02]
 [ 9.61953900e-04]
 [ 1.78120660e-02]
 [ 1.63640543e-02]
 [ 4.45489604e-03]
 [ 1.48868805e-02]
 [ 7.83571625e-03]
 [ 1.11923887e-02]
 [ 4.63059812e-03]
 [-1.50295283e-02]
 [-1.96850444e-02]
 [ 8.39988715e-04]
 [-3.43374929e-03]
 [-2.35906396e-02]
 [-5.31560627e-03]
 [ 1.76612748e-02]
 [ 2.52452433e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.8822016]
curr_Stock_Price:  99.23188647960146
curr_Factors:  [99.23188648]
mat_Sqrt:  [[0.15]]
grads:  [-0.08186421]
Stock Position:  -0.08186421419505346
Bond Position:  [-6.75866119]


portfolio before change:  [-14.95410347]
curr_Stock_Price:  100.10503293301566
curr_Factors:  [100.10503293]
mat_Sqrt:  [[0.15]]
grads:  [0.08676789]
Stock Position:  0.08676789100028874
Bond Position:  [-23.64000606]


portfolio before change:  [-14.95726054]
curr_Stock_Price:  100.08567642403344
curr_Factors:  [100.08567642]
mat_Sqrt:  [[0.15]]
grads:  [0.02213963]
Stock Position:  0.022139627226072402
Bond Position:  [-17.17312011]


portfolio before change:  [-14.95991467]
curr_Stock_Price:  100.0142760554952
curr_Factors:  [100.01427606]
mat_Sqrt:  [[0.15]]
grads:  [-0.05047258]
Stock Position:  -0.05047257555232512
Bond Position:  [-9.91193657]


portfolio before change:  [-14.99019842]
curr_Stock_Price:  100.6020056672043
curr_Factors:  [100.60200567]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192632]
Stock Position:  -0.019263203826646765
Bond Position:  [-13.05228148]


portfolio before change:  [-14.9987297]
curr_Stock_Price:  101.00253573615025
curr_Factors:  [101.00253574]
mat_Sqrt:  [[0.15]]
grads:  [-0.00767051]
Stock Position:  -0.007670507021119979
Bond Position:  [-14.22398904]


portfolio before change:  [-14.99362424]
curr_Stock_Price:  100.2210378466617
curr_Factors:  [100.22103785]
mat_Sqrt:  [[0.15]]
grads:  [0.00283317]
Stock Position:  0.0028331715227437188
Bond Position:  [-15.27756763]


portfolio before change:  [-14.99565155]
curr_Stock_Price:  99.84251055583334
curr_Factors:  [99.84251056]
mat_Sqrt:  [[0.15]]
grads:  [-0.03206882]
Stock Position:  -0.03206882260938813
Bond Position:  [-11.7938198]


portfolio before change:  [-15.03404368]
curr_Stock_Price:  101.01670361009283
curr_Factors:  [101.01670361]
mat_Sqrt:  [[0.15]]
grads:  [0.06381539]
Stock Position:  0.06381538603188136
Bond Position:  [-21.48046362]


portfolio before change:  [-15.00141644]
curr_Stock_Price:  101.54901735035706
curr_Factors:  [101.54901735]
mat_Sqrt:  [[0.15]]
grads:  [-0.03151981]
Stock Position:  -0.03151981212226554
Bond Position:  [-11.8006105]


portfolio before change:  [-14.99560979]
curr_Stock_Price:  101.34139504834656
curr_Factors:  [101.34139505]
mat_Sqrt:  [[0.15]]
grads:  [-0.05846849]
Stock Position:  -0.05846849180008391
Bond Position:  [-9.07033126]


portfolio before change:  [-14.99364996]
curr_Stock_Price:  101.29817954735394
curr_Factors:  [101.29817955]
mat_Sqrt:  [[0.15]]
grads:  [0.07280551]
Stock Position:  0.07280551442339496
Bond Position:  [-22.36871603]


portfolio before change:  [-15.01464417]
curr_Stock_Price:  101.02902236489122
curr_Factors:  [101.02902236]
mat_Sqrt:  [[0.15]]
grads:  [-0.02229527]
Stock Position:  -0.02229527342074911
Bond Position:  [-12.7621745]


portfolio before change:  [-14.97833385]
curr_Stock_Price:  99.3646343593468
curr_Factors:  [99.36463436]
mat_Sqrt:  [[0.15]]
grads:  [0.04288344]
Stock Position:  0.04288343636900782
Bond Position:  [-19.23943082]


portfolio before change:  [-14.95886188]
curr_Stock_Price:  99.84674279150676
curr_Factors:  [99.84674279]
mat_Sqrt:  [[0.15]]
grads:  [-0.00082391]
Stock Position:  -0.0008239148052936278
Bond Position:  [-14.87659667]


portfolio before change:  [-14.96008141]
curr_Stock_Price:  100.19836264621392
curr_Factors:  [100.19836265]
mat_Sqrt:  [[0.15]]
grads:  [0.09040792]
Stock Position:  0.09040791775460409
Bond Position:  [-24.01880674]


portfolio before change:  [-14.93159042]
curr_Stock_Price:  100.53010582762488
curr_Factors:  [100.53010583]
mat_Sqrt:  [[0.15]]
grads:  [0.28875101]
Stock Position:  0.2887510128027956
Bond Position:  [-43.95976029]


portfolio before change:  [-15.22557675]
curr_Stock_Price:  99.52149028964944
curr_Factors:  [99.52149029]
mat_Sqrt:  [[0.15]]
grads:  [-0.10142407]
Stock Position:  -0.1014240674015648
Bond Position:  [-5.13170241]


portfolio before change:  [-15.25565933]
curr_Stock_Price:  99.81492992756294
curr_Factors:  [99.81492993]
mat_Sqrt:  [[0.15]]
grads:  [0.13513972]
Stock Position:  0.13513972439767716
Bond Position:  [-28.74462145]


portfolio before change:  [-15.17528562]
curr_Stock_Price:  100.42296951463658
curr_Factors:  [100.42296951]
mat_Sqrt:  [[0.15]]
grads:  [0.01586032]
Stock Position:  0.01586031850922741
Bond Position:  [-16.7680259]


portfolio before change:  [-15.16759886]
curr_Stock_Price:  100.97370226760641
curr_Factors:  [100.97370227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02577443]
Stock Position:  -0.025774432907338062
Bond Position:  [-12.56505895]


portfolio before change:  [-15.15185716]
curr_Stock_Price:  100.33248373891324
curr_Factors:  [100.33248374]
mat_Sqrt:  [[0.15]]
grads:  [0.027586]
Stock Position:  0.02758600242041531
Bond Position:  [-17.9196293]


portfolio before change:  [-15.16363259]
curr_Stock_Price:  99.94622179785385
curr_Factors:  [99.9462218]
mat_Sqrt:  [[0.15]]
grads:  [0.10577621]
Stock Position:  0.10577621451471501
Bond Position:  [-25.73556559]


portfolio before change:  [-15.25523803]
curr_Stock_Price:  99.09539809451154
curr_Factors:  [99.09539809]
mat_Sqrt:  [[0.15]]
grads:  [0.1189349]
Stock Position:  0.11893490205460391
Bond Position:  [-27.04113949]


portfolio before change:  [-15.25869183]
curr_Stock_Price:  99.08056913293385
curr_Factors:  [99.08056913]
mat_Sqrt:  [[0.15]]
grads:  [-0.03876978]
Stock Position:  -0.038769775676903664
Bond Position:  [-11.41736039]


portfolio before change:  [-15.25384331]
curr_Stock_Price:  98.93710367035695
curr_Factors:  [98.93710367]
mat_Sqrt:  [[0.15]]
grads:  [0.03096808]
Stock Position:  0.030968077533662087
Bond Position:  [-18.31773521]


portfolio before change:  [-15.24619405]
curr_Stock_Price:  99.2210786158449
curr_Factors:  [99.22107862]
mat_Sqrt:  [[0.15]]
grads:  [0.04808518]
Stock Position:  0.04808518037117227
Bond Position:  [-20.01725751]


portfolio before change:  [-15.26408211]
curr_Stock_Price:  98.87508958219846
curr_Factors:  [98.87508958]
mat_Sqrt:  [[0.15]]
grads:  [0.05482015]
Stock Position:  0.05482015067800704
Bond Position:  [-20.68442942]


portfolio before change:  [-15.23424671]
curr_Stock_Price:  99.44291398672944
curr_Factors:  [99.44291399]
mat_Sqrt:  [[0.15]]
grads:  [0.11024016]
Stock Position:  0.11024016161514989
Bond Position:  [-26.19684962]


portfolio before change:  [-15.22441851]
curr_Stock_Price:  99.5469192279489
curr_Factors:  [99.54691923]
mat_Sqrt:  [[0.15]]
grads:  [0.01055742]
Stock Position:  0.010557424123891837
Bond Position:  [-16.27537756]


portfolio before change:  [-15.22634307]
curr_Stock_Price:  99.46097833777245
curr_Factors:  [99.46097834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04546853]
Stock Position:  -0.04546852978895346
Bond Position:  [-10.70399861]


portfolio before change:  [-15.22660526]
curr_Stock_Price:  99.45203091370998
curr_Factors:  [99.45203091]
mat_Sqrt:  [[0.15]]
grads:  [0.06680258]
Stock Position:  0.06680258007247473
Bond Position:  [-21.87025752]


portfolio before change:  [-15.1365821]
curr_Stock_Price:  100.82009327896395
curr_Factors:  [100.82009328]
mat_Sqrt:  [[0.15]]
grads:  [0.08342014]
Stock Position:  0.08342014484669115
Bond Position:  [-23.54700889]


portfolio before change:  [-15.13273958]
curr_Stock_Price:  100.8837980119849
curr_Factors:  [100.88379801]
mat_Sqrt:  [[0.15]]
grads:  [0.06299341]
Stock Position:  0.06299340773752048
Bond Position:  [-21.4877538]


portfolio before change:  [-15.17265731]
curr_Stock_Price:  100.27143694235394
curr_Factors:  [100.27143694]
mat_Sqrt:  [[0.15]]
grads:  [0.0407972]
Stock Position:  0.040797202571768734
Bond Position:  [-19.26345144]


portfolio before change:  [-15.14128569]
curr_Stock_Price:  101.0699138402452
curr_Factors:  [101.06991384]
mat_Sqrt:  [[0.15]]
grads:  [0.06203999]
Stock Position:  0.062039991065594415
Bond Position:  [-21.41166224]


portfolio before change:  [-15.09849348]
curr_Stock_Price:  101.78123706936398
curr_Factors:  [101.78123707]
mat_Sqrt:  [[0.15]]
grads:  [-0.18015791]
Stock Position:  -0.18015791421130853
Bond Position:  [3.2382019]


portfolio before change:  [-15.0695518]
curr_Stock_Price:  101.62171435221003
curr_Factors:  [101.62171435]
mat_Sqrt:  [[0.15]]
grads:  [0.00742217]
Stock Position:  0.007422170996942713
Bond Position:  [-15.82380554]


portfolio before change:  [-15.06503088]
curr_Stock_Price:  102.36407728185971
curr_Factors:  [102.36407728]
mat_Sqrt:  [[0.15]]
grads:  [-0.21015082]
Stock Position:  -0.21015082486584497
Bond Position:  [6.4468644]


portfolio before change:  [-14.97494543]
curr_Stock_Price:  101.93732425508082
curr_Factors:  [101.93732426]
mat_Sqrt:  [[0.15]]
grads:  [-0.07226192]
Stock Position:  -0.0722619186048745
Bond Position:  [-7.60875881]


portfolio before change:  [-15.01206903]
curr_Stock_Price:  102.44447984440686
curr_Factors:  [102.44447984]
mat_Sqrt:  [[0.15]]
grads:  [0.02705116]
Stock Position:  0.02705115840571606
Bond Position:  [-17.78331089]


portfolio before change:  [-15.00231607]
curr_Stock_Price:  102.84610602898582
curr_Factors:  [102.84610603]
mat_Sqrt:  [[0.15]]
grads:  [0.06833639]
Stock Position:  0.06833638769953043
Bond Position:  [-22.03044745]


portfolio before change:  [-15.00679529]
curr_Stock_Price:  102.8007089380222
curr_Factors:  [102.80070894]
mat_Sqrt:  [[0.15]]
grads:  [-0.05364104]
Stock Position:  -0.053641044024604026
Bond Position:  [-9.49245794]


portfolio before change:  [-14.98533557]
curr_Stock_Price:  102.38958684773979
curr_Factors:  [102.38958685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985313]
Stock Position:  -0.009853130997392113
Bond Position:  [-13.97647756]


portfolio before change:  [-14.98465817]
curr_Stock_Price:  102.23217985011877
curr_Factors:  [102.23217985]
mat_Sqrt:  [[0.15]]
grads:  [0.07138346]
Stock Position:  0.07138345840592232
Bond Position:  [-22.28234473]


portfolio before change:  [-14.96476322]
curr_Stock_Price:  102.53039527617997
curr_Factors:  [102.53039528]
mat_Sqrt:  [[0.15]]
grads:  [0.08119958]
Stock Position:  0.08119957650461872
Bond Position:  [-23.29018789]


portfolio before change:  [-15.00077156]
curr_Stock_Price:  102.10486766542466
curr_Factors:  [102.10486767]
mat_Sqrt:  [[0.15]]
grads:  [0.07073023]
Stock Position:  0.07073022630548718
Bond Position:  [-22.22267196]


portfolio before change:  [-14.94738608]
curr_Stock_Price:  102.87928115765212
curr_Factors:  [102.87928116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00828365]
Stock Position:  -0.008283649095299881
Bond Position:  [-14.09517022]


portfolio before change:  [-14.95179282]
curr_Stock_Price:  103.30491113677611
curr_Factors:  [103.30491114]
mat_Sqrt:  [[0.15]]
grads:  [0.080072]
Stock Position:  0.08007199735677396
Bond Position:  [-23.2236234]


portfolio before change:  [-14.98877794]
curr_Stock_Price:  102.8611405581255
curr_Factors:  [102.86114056]
mat_Sqrt:  [[0.15]]
grads:  [-0.00787064]
Stock Position:  -0.007870636816618667
Bond Position:  [-14.17919526]


portfolio before change:  [-14.99013911]
curr_Stock_Price:  102.92148361090072
curr_Factors:  [102.92148361]
mat_Sqrt:  [[0.15]]
grads:  [0.14542429]
Stock Position:  0.14542429069605564
Bond Position:  [-29.95742286]


portfolio before change:  [-14.98346178]
curr_Stock_Price:  102.98027520223565
curr_Factors:  [102.9802752]
mat_Sqrt:  [[0.15]]
grads:  [-0.0243342]
Stock Position:  -0.024334204898575434
Bond Position:  [-12.47751866]


portfolio before change:  [-14.99581633]
curr_Stock_Price:  103.4559300884269
curr_Factors:  [103.45593009]
mat_Sqrt:  [[0.15]]
grads:  [-0.01169863]
Stock Position:  -0.011698628821336626
Bond Position:  [-13.78552381]


portfolio before change:  [-14.99750157]
curr_Stock_Price:  103.52633268610666
curr_Factors:  [103.52633269]
mat_Sqrt:  [[0.15]]
grads:  [-0.126448]
Stock Position:  -0.1264480032548343
Bond Position:  [-1.90680352]


portfolio before change:  [-14.94185067]
curr_Stock_Price:  103.08528123383071
curr_Factors:  [103.08528123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01622158]
Stock Position:  -0.01622157661459327
Bond Position:  [-13.26964489]


portfolio before change:  [-14.94824276]
curr_Stock_Price:  103.42820159872876
curr_Factors:  [103.4282016]
mat_Sqrt:  [[0.15]]
grads:  [-0.01987816]
Stock Position:  -0.019878158060806308
Bond Position:  [-12.89228062]


portfolio before change:  [-14.95985429]
curr_Stock_Price:  103.97180025049894
curr_Factors:  [103.97180025]
mat_Sqrt:  [[0.15]]
grads:  [0.05673087]
Stock Position:  0.056730870920514355
Bond Position:  [-20.85826507]


portfolio before change:  [-15.030651]
curr_Stock_Price:  102.74684071166392
curr_Factors:  [102.74684071]
mat_Sqrt:  [[0.15]]
grads:  [-0.06579029]
Stock Position:  -0.06579028633206414
Bond Position:  [-8.27090693]


portfolio before change:  [-15.06357726]
curr_Stock_Price:  103.23945624509682
curr_Factors:  [103.23945625]
mat_Sqrt:  [[0.15]]
grads:  [0.03228691]
Stock Position:  0.03228691498575323
Bond Position:  [-18.39686081]


portfolio before change:  [-15.08120433]
curr_Stock_Price:  102.72911847356538
curr_Factors:  [102.72911847]
mat_Sqrt:  [[0.15]]
grads:  [-0.02570333]
Stock Position:  -0.025703325704765616
Bond Position:  [-12.44072434]


portfolio before change:  [-15.11022023]
curr_Stock_Price:  103.82774371437638
curr_Factors:  [103.82774371]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916239]
Stock Position:  -0.029162392110677282
Bond Position:  [-12.08235485]


portfolio before change:  [-15.10605305]
curr_Stock_Price:  103.65895286967972
curr_Factors:  [103.65895287]
mat_Sqrt:  [[0.15]]
grads:  [0.03914042]
Stock Position:  0.03914042199396161
Bond Position:  [-19.16330821]


portfolio before change:  [-15.11529271]
curr_Stock_Price:  103.45348968876637
curr_Factors:  [103.45348969]
mat_Sqrt:  [[0.15]]
grads:  [-0.12988213]
Stock Position:  -0.1298821338865444
Bond Position:  [-1.67853271]


portfolio before change:  [-15.16633256]
curr_Stock_Price:  103.84565245663774
curr_Factors:  [103.84565246]
mat_Sqrt:  [[0.15]]
grads:  [0.00641303]
Stock Position:  0.00641302599959738
Bond Position:  [-15.83229743]


portfolio before change:  [-15.16719524]
curr_Stock_Price:  103.86543611079001
curr_Factors:  [103.86543611]
mat_Sqrt:  [[0.15]]
grads:  [0.11874711]
Stock Position:  0.11874710675216205
Bond Position:  [-27.50091527]


portfolio before change:  [-15.04330092]
curr_Stock_Price:  104.92325707792196
curr_Factors:  [104.92325708]
mat_Sqrt:  [[0.15]]
grads:  [0.1090937]
Stock Position:  0.10909369519930379
Bond Position:  [-26.48976675]


portfolio before change:  [-15.04692169]
curr_Stock_Price:  104.90524399127754
curr_Factors:  [104.90524399]
mat_Sqrt:  [[0.15]]
grads:  [0.02969931]
Stock Position:  0.029699306909449302
Bond Position:  [-18.16253473]


portfolio before change:  [-15.02136896]
curr_Stock_Price:  105.80384845868059
curr_Factors:  [105.80384846]
mat_Sqrt:  [[0.15]]
grads:  [0.09924587]
Stock Position:  0.09924587030594408
Bond Position:  [-25.52196398]


portfolio before change:  [-15.01429666]
curr_Stock_Price:  105.89118172963069
curr_Factors:  [105.89118173]
mat_Sqrt:  [[0.15]]
grads:  [0.05223811]
Stock Position:  0.05223810833486537
Bond Position:  [-20.54585169]


portfolio before change:  [-15.02217676]
curr_Stock_Price:  105.76491488928477
curr_Factors:  [105.76491489]
mat_Sqrt:  [[0.15]]
grads:  [0.07461592]
Stock Position:  0.07461592482132773
Bond Position:  [-22.9139237]


portfolio before change:  [-15.01134374]
curr_Stock_Price:  105.9292924731741
curr_Factors:  [105.92929247]
mat_Sqrt:  [[0.15]]
grads:  [0.03087065]
Stock Position:  0.03087065413538686
Bond Position:  [-18.28145029]


portfolio before change:  [-15.02619707]
curr_Stock_Price:  105.48515858253312
curr_Factors:  [105.48515858]
mat_Sqrt:  [[0.15]]
grads:  [-0.10019686]
Stock Position:  -0.10019685563552387
Bond Position:  [-4.45691586]


portfolio before change:  [-15.00055031]
curr_Stock_Price:  105.22641468363123
curr_Factors:  [105.22641468]
mat_Sqrt:  [[0.15]]
grads:  [-0.13123363]
Stock Position:  -0.13123362905112224
Bond Position:  [-1.19130604]


portfolio before change:  [-14.97091381]
curr_Stock_Price:  105.00001724580282
curr_Factors:  [105.00001725]
mat_Sqrt:  [[0.15]]
grads:  [0.00559992]
Stock Position:  0.005599924767261364
Bond Position:  [-15.55890601]


portfolio before change:  [-14.96577265]
curr_Stock_Price:  106.09175079700731
curr_Factors:  [106.0917508]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289166]
Stock Position:  -0.022891661937756727
Bond Position:  [-12.53715616]


portfolio before change:  [-14.96887971]
curr_Stock_Price:  106.19324921499522
curr_Factors:  [106.19324921]
mat_Sqrt:  [[0.15]]
grads:  [-0.15727093]
Stock Position:  -0.15727093068051215
Bond Position:  [1.73223142]


portfolio before change:  [-15.08161725]
curr_Stock_Price:  106.91077411298397
curr_Factors:  [106.91077411]
mat_Sqrt:  [[0.15]]
grads:  [-0.03543738]
Stock Position:  -0.03543737511687168
Bond Position:  [-11.29298005]


portfolio before change:  [-15.08757281]
curr_Stock_Price:  107.05891491452707
curr_Factors:  [107.05891491]
mat_Sqrt:  [[0.15]]
grads:  [0.11774183]
Stock Position:  0.11774183177648996
Bond Position:  [-27.69288556]


portfolio before change:  [-15.19647005]
curr_Stock_Price:  106.14873384734584
curr_Factors:  [106.14873385]
mat_Sqrt:  [[0.15]]
grads:  [0.16830162]
Stock Position:  0.16830162185501385
Bond Position:  [-33.06147412]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.20233919]
Stock Price:  106.12613914287225
PL:  [-21.32847833]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.01595736e-03]
 [ 3.40866552e-02]
 [ 2.17694695e-02]
 [-7.65169449e-03]
 [ 1.42655113e-02]
 [-1.35250585e-02]
 [ 1.56017811e-03]
 [-9.32427942e-03]
 [-3.15173103e-03]
 [ 4.62533434e-04]
 [ 1.55796565e-03]
 [ 1.13818919e-02]
 [-4.29577789e-03]
 [ 2.40501292e-03]
 [ 1.45986420e-03]
 [ 1.60659946e-02]
 [ 8.93456446e-02]
 [-1.39169539e-02]
 [ 1.89705291e-02]
 [ 1.24057209e-03]
 [-3.95544228e-03]
 [ 4.56749660e-03]
 [ 9.03993351e-03]
 [ 3.25513636e-02]
 [ 3.22777999e-03]
 [ 7.51792176e-03]
 [ 6.91903111e-02]
 [ 2.73119167e-02]
 [ 1.06222526e-02]
 [-7.85559321e-03]
 [-1.66561673e-03]
 [ 1.36661385e-02]
 [ 1.37500908e-02]
 [-5.35386718e-03]
 [ 4.51839336e-03]
 [-7.79640725e-04]
 [-9.59554822e-03]
 [-1.45541221e-02]
 [ 6.79805815e-03]
 [-6.30800806e-02]
 [ 3.26226323e-03]
 [-4.07281618e-03]
 [-1.84665530e-02]
 [ 1.82528273e-02]
 [-1.39865257e-02]
 [ 1.20119323e-02]
 [ 1.02764201e-02]
 [-4.25210126e-03]
 [ 1.72079095e-02]
 [-1.76311298e-03]
 [ 1.59805799e-02]
 [ 4.32810442e-02]
 [-1.30779805e-02]
 [-1.02322695e-01]
 [-3.60090592e-02]
 [-1.42838096e-03]
 [-5.06723092e-03]
 [-1.29052112e-02]
 [-8.41036449e-04]
 [-2.96636749e-03]
 [-7.55414963e-03]
 [-3.57040283e-03]
 [-1.70422876e-02]
 [-1.24595466e-04]
 [-2.68705468e-03]
 [ 2.82509035e-02]
 [-4.84827149e-03]
 [ 2.29803345e-02]
 [ 9.21466937e-03]
 [ 1.18494362e-02]
 [ 9.18192085e-03]
 [-1.43115797e-02]
 [-7.07260651e-02]
 [ 3.08581261e-04]
 [-1.62631317e-02]
 [-3.49663583e-02]
 [-6.60826702e-03]
 [ 2.70159742e-02]
 [ 1.21077566e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.14027733]
curr_Stock_Price:  100.50461004612468
curr_Factors:  [100.50461005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677305]
Stock Position:  -0.026773049091632917
Bond Position:  [15.83109218]


portfolio before change:  [13.13277936]
curr_Stock_Price:  100.82162419322364
curr_Factors:  [100.82162419]
mat_Sqrt:  [[0.15]]
grads:  [0.22724437]
Stock Position:  0.22724436775498874
Bond Position:  [-9.77836688]


portfolio before change:  [13.0886126]
curr_Stock_Price:  100.6299556288332
curr_Factors:  [100.62995563]
mat_Sqrt:  [[0.15]]
grads:  [0.1451298]
Stock Position:  0.14512979645314344
Bond Position:  [-1.51579238]


portfolio before change:  [12.99766457]
curr_Stock_Price:  100.00394161523417
curr_Factors:  [100.00394162]
mat_Sqrt:  [[0.15]]
grads:  [-0.0510113]
Stock Position:  -0.0510112965852729
Bond Position:  [18.09899529]


portfolio before change:  [13.02451616]
curr_Stock_Price:  99.49973226041087
curr_Factors:  [99.49973226]
mat_Sqrt:  [[0.15]]
grads:  [0.09510341]
Stock Position:  0.09510340873582049
Bond Position:  [3.56175246]


portfolio before change:  [13.00331911]
curr_Stock_Price:  99.2745072386972
curr_Factors:  [99.27450724]
mat_Sqrt:  [[0.15]]
grads:  [-0.09016706]
Stock Position:  -0.09016705681881317
Bond Position:  [21.95460925]


portfolio before change:  [12.96681254]
curr_Stock_Price:  99.69460284228288
curr_Factors:  [99.69460284]
mat_Sqrt:  [[0.15]]
grads:  [0.01040119]
Stock Position:  0.010401187381810159
Bond Position:  [11.92987029]


portfolio before change:  [12.97249002]
curr_Stock_Price:  100.16876440391405
curr_Factors:  [100.1687644]
mat_Sqrt:  [[0.15]]
grads:  [-0.06216186]
Stock Position:  -0.062161862823566054
Bond Position:  [19.19916701]


portfolio before change:  [12.97630312]
curr_Stock_Price:  100.12672710842833
curr_Factors:  [100.12672711]
mat_Sqrt:  [[0.15]]
grads:  [-0.02101154]
Stock Position:  -0.02101154017122714
Bond Position:  [15.08011987]


portfolio before change:  [12.97330194]
curr_Stock_Price:  100.31442011745469
curr_Factors:  [100.31442012]
mat_Sqrt:  [[0.15]]
grads:  [0.00308356]
Stock Position:  0.0030835562270209913
Bond Position:  [12.66397678]


portfolio before change:  [12.97525847]
curr_Stock_Price:  100.69223332521777
curr_Factors:  [100.69223333]
mat_Sqrt:  [[0.15]]
grads:  [0.01038644]
Stock Position:  0.01038643764225906
Bond Position:  [11.92942487]


portfolio before change:  [12.98262134]
curr_Stock_Price:  101.3293385866822
curr_Factors:  [101.32933859]
mat_Sqrt:  [[0.15]]
grads:  [0.07587928]
Stock Position:  0.07587927945352586
Bond Position:  [5.29382414]


portfolio before change:  [13.05723814]
curr_Stock_Price:  102.30834012810169
curr_Factors:  [102.30834013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863852]
Stock Position:  -0.028638519299572125
Bond Position:  [15.98719752]


portfolio before change:  [13.05890029]
curr_Stock_Price:  102.28519225289519
curr_Factors:  [102.28519225]
mat_Sqrt:  [[0.15]]
grads:  [0.01603342]
Stock Position:  0.016033419474553535
Bond Position:  [11.4189189]


portfolio before change:  [13.04418996]
curr_Stock_Price:  101.32319910933805
curr_Factors:  [101.32319911]
mat_Sqrt:  [[0.15]]
grads:  [0.00973243]
Stock Position:  0.009732427969414334
Bond Position:  [12.05806922]


portfolio before change:  [13.04269273]
curr_Stock_Price:  101.09192264403421
curr_Factors:  [101.09192264]
mat_Sqrt:  [[0.15]]
grads:  [0.10710663]
Stock Position:  0.10710663096955601
Bond Position:  [2.21507748]


portfolio before change:  [13.12748863]
curr_Stock_Price:  101.88232613253022
curr_Factors:  [101.88232613]
mat_Sqrt:  [[0.15]]
grads:  [0.59563763]
Stock Position:  0.5956376308426665
Bond Position:  [-47.55745873]


portfolio before change:  [12.81302936]
curr_Stock_Price:  101.3593792481793
curr_Factors:  [101.35937925]
mat_Sqrt:  [[0.15]]
grads:  [-0.09277969]
Stock Position:  -0.09277969242085976
Bond Position:  [22.21712139]


portfolio before change:  [12.78832708]
curr_Stock_Price:  101.64059259175951
curr_Factors:  [101.64059259]
mat_Sqrt:  [[0.15]]
grads:  [0.12647019]
Stock Position:  0.12647019409696447
Bond Position:  [-0.06617839]


portfolio before change:  [12.81352339]
curr_Stock_Price:  101.83985255853048
curr_Factors:  [101.83985256]
mat_Sqrt:  [[0.15]]
grads:  [0.00827048]
Stock Position:  0.008270480621140113
Bond Position:  [11.97125886]


portfolio before change:  [12.80944351]
curr_Stock_Price:  101.25607635787145
curr_Factors:  [101.25607636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02636962]
Stock Position:  -0.026369615202678956
Bond Position:  [15.47952728]


portfolio before change:  [12.80610016]
curr_Stock_Price:  101.41955438158772
curr_Factors:  [101.41955438]
mat_Sqrt:  [[0.15]]
grads:  [0.03044998]
Stock Position:  0.030449977311997133
Bond Position:  [9.71787703]


portfolio before change:  [12.83114581]
curr_Stock_Price:  102.2221251608659
curr_Factors:  [102.22212516]
mat_Sqrt:  [[0.15]]
grads:  [0.06026622]
Stock Position:  0.06026622341484488
Bond Position:  [6.67060437]


portfolio before change:  [12.83870766]
curr_Stock_Price:  102.34068119652916
curr_Factors:  [102.3406812]
mat_Sqrt:  [[0.15]]
grads:  [0.21700909]
Stock Position:  0.21700909055165515
Bond Position:  [-9.3701505]


portfolio before change:  [13.02349506]
curr_Stock_Price:  103.1948991403019
curr_Factors:  [103.19489914]
mat_Sqrt:  [[0.15]]
grads:  [0.02151853]
Stock Position:  0.02151853327471455
Bond Position:  [10.80289219]


portfolio before change:  [13.029371]
curr_Stock_Price:  103.4365856117037
curr_Factors:  [103.43658561]
mat_Sqrt:  [[0.15]]
grads:  [0.05011948]
Stock Position:  0.05011947839773524
Bond Position:  [7.84518328]


portfolio before change:  [13.08517781]
curr_Stock_Price:  104.54027769395216
curr_Factors:  [104.54027769]
mat_Sqrt:  [[0.15]]
grads:  [0.46126874]
Stock Position:  0.46126874052240857
Bond Position:  [-35.13598441]


portfolio before change:  [12.83873929]
curr_Stock_Price:  104.0107762660801
curr_Factors:  [104.01077627]
mat_Sqrt:  [[0.15]]
grads:  [0.18207944]
Stock Position:  0.18207944471793092
Bond Position:  [-6.0994851]


portfolio before change:  [12.80884207]
curr_Stock_Price:  103.84867126482281
curr_Factors:  [103.84867126]
mat_Sqrt:  [[0.15]]
grads:  [0.07081502]
Stock Position:  0.07081501702616898
Bond Position:  [5.45479665]


portfolio before change:  [12.74184127]
curr_Stock_Price:  102.89771857041308
curr_Factors:  [102.89771857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05237062]
Stock Position:  -0.052370621412985846
Bond Position:  [18.13065874]


portfolio before change:  [12.77404157]
curr_Stock_Price:  102.30450243168353
curr_Factors:  [102.30450243]
mat_Sqrt:  [[0.15]]
grads:  [-0.01110411]
Stock Position:  -0.011104111545598393
Bond Position:  [13.91004218]


portfolio before change:  [12.77532275]
curr_Stock_Price:  102.26741967710005
curr_Factors:  [102.26741968]
mat_Sqrt:  [[0.15]]
grads:  [0.09110759]
Stock Position:  0.09110758985538989
Bond Position:  [3.45798462]


portfolio before change:  [12.80677765]
curr_Stock_Price:  102.61029752081829
curr_Factors:  [102.61029752]
mat_Sqrt:  [[0.15]]
grads:  [0.09166727]
Stock Position:  0.09166727208155652
Bond Position:  [3.40077159]


portfolio before change:  [12.89337709]
curr_Stock_Price:  103.55269358782256
curr_Factors:  [103.55269359]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569245]
Stock Position:  -0.035692447877256436
Bond Position:  [16.5894262]


portfolio before change:  [12.88097429]
curr_Stock_Price:  103.92923438574495
curr_Factors:  [103.92923439]
mat_Sqrt:  [[0.15]]
grads:  [0.03012262]
Stock Position:  0.03012262242177325
Bond Position:  [9.75035321]


portfolio before change:  [12.87520903]
curr_Stock_Price:  103.71760996798018
curr_Factors:  [103.71760997]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051976]
Stock Position:  -0.0051976048337094155
Bond Position:  [13.41429218]


portfolio before change:  [12.86986486]
curr_Stock_Price:  104.90711633606902
curr_Factors:  [104.90711634]
mat_Sqrt:  [[0.15]]
grads:  [-0.06397032]
Stock Position:  -0.06397032146750818
Bond Position:  [19.58080682]


portfolio before change:  [12.85902564]
curr_Stock_Price:  105.09568911111316
curr_Factors:  [105.09568911]
mat_Sqrt:  [[0.15]]
grads:  [-0.09702748]
Stock Position:  -0.09702748055856815
Bond Position:  [23.05619557]


portfolio before change:  [12.83631075]
curr_Stock_Price:  105.34464898935785
curr_Factors:  [105.34464899]
mat_Sqrt:  [[0.15]]
grads:  [0.04532039]
Stock Position:  0.04532038764621283
Bond Position:  [8.06205042]


portfolio before change:  [12.86598256]
curr_Stock_Price:  105.98824268984956
curr_Factors:  [105.98824269]
mat_Sqrt:  [[0.15]]
grads:  [-0.42053387]
Stock Position:  -0.42053387097458217
Bond Position:  [57.43762854]


portfolio before change:  [12.82145173]
curr_Stock_Price:  106.10267056665086
curr_Factors:  [106.10267057]
mat_Sqrt:  [[0.15]]
grads:  [0.02174842]
Stock Position:  0.021748421505405895
Bond Position:  [10.51388612]


portfolio before change:  [12.83203737]
curr_Stock_Price:  106.55918680422187
curr_Factors:  [106.5591868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02715211]
Stock Position:  -0.0271521078800979
Bond Position:  [15.72534391]


portfolio before change:  [12.83815418]
curr_Stock_Price:  106.37010578317555
curr_Factors:  [106.37010578]
mat_Sqrt:  [[0.15]]
grads:  [-0.12311035]
Stock Position:  -0.1231103534102526
Bond Position:  [25.9334155]


portfolio before change:  [12.89924136]
curr_Stock_Price:  105.8870733829496
curr_Factors:  [105.88707338]
mat_Sqrt:  [[0.15]]
grads:  [0.12168552]
Stock Position:  0.12168551534608434
Bond Position:  [0.01431827]


portfolio before change:  [13.0908398]
curr_Stock_Price:  107.4616038009546
curr_Factors:  [107.4616038]
mat_Sqrt:  [[0.15]]
grads:  [-0.0932435]
Stock Position:  -0.09324350437610827
Bond Position:  [23.11093633]


portfolio before change:  [13.03487163]
curr_Stock_Price:  108.07733192075088
curr_Factors:  [108.07733192]
mat_Sqrt:  [[0.15]]
grads:  [0.08007955]
Stock Position:  0.08007954866658616
Bond Position:  [4.38008767]


portfolio before change:  [13.07314121]
curr_Stock_Price:  108.55180771883435
curr_Factors:  [108.55180772]
mat_Sqrt:  [[0.15]]
grads:  [0.06850947]
Stock Position:  0.06850946729405473
Bond Position:  [5.63631469]


portfolio before change:  [13.08363195]
curr_Stock_Price:  108.69979408860725
curr_Factors:  [108.69979409]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834734]
Stock Position:  -0.02834734172767284
Bond Position:  [16.16498216]


portfolio before change:  [13.070226]
curr_Stock_Price:  109.20835295301137
curr_Factors:  [109.20835295]
mat_Sqrt:  [[0.15]]
grads:  [0.1147194]
Stock Position:  0.11471939683907094
Bond Position:  [0.54190962]


portfolio before change:  [13.15591996]
curr_Stock_Price:  109.95504518123862
curr_Factors:  [109.95504518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01175409]
Stock Position:  -0.011754086548162663
Bond Position:  [14.44834107]


portfolio before change:  [13.16076237]
curr_Stock_Price:  109.61989707927557
curr_Factors:  [109.61989708]
mat_Sqrt:  [[0.15]]
grads:  [0.1065372]
Stock Position:  0.10653719908656474
Bond Position:  [1.48216557]


portfolio before change:  [13.19616796]
curr_Stock_Price:  109.95135830635321
curr_Factors:  [109.95135831]
mat_Sqrt:  [[0.15]]
grads:  [0.28854029]
Stock Position:  0.28854029486708793
Bond Position:  [-18.52922939]


portfolio before change:  [13.23602914]
curr_Stock_Price:  110.09351972443544
curr_Factors:  [110.09351972]
mat_Sqrt:  [[0.15]]
grads:  [-0.08718654]
Stock Position:  -0.08718653668732781
Bond Position:  [22.83470184]


portfolio before change:  [13.23308787]
curr_Stock_Price:  110.14362479058028
curr_Factors:  [110.14362479]
mat_Sqrt:  [[0.15]]
grads:  [-0.6821513]
Stock Position:  -0.6821512995026986
Bond Position:  [88.36770465]


portfolio before change:  [13.16591983]
curr_Stock_Price:  110.2501864719172
curr_Factors:  [110.25018647]
mat_Sqrt:  [[0.15]]
grads:  [-0.24006039]
Stock Position:  -0.24006039455062805
Bond Position:  [39.63262309]


portfolio before change:  [13.36532113]
curr_Stock_Price:  109.42987546006727
curr_Factors:  [109.42987546]
mat_Sqrt:  [[0.15]]
grads:  [-0.00952254]
Stock Position:  -0.0095225397087032
Bond Position:  [14.40737147]


portfolio before change:  [13.38283924]
curr_Stock_Price:  107.68479302164666
curr_Factors:  [107.68479302]
mat_Sqrt:  [[0.15]]
grads:  [-0.03378154]
Stock Position:  -0.033781539464974655
Bond Position:  [17.02059732]


portfolio before change:  [13.3795848]
curr_Stock_Price:  107.81262193421489
curr_Factors:  [107.81262193]
mat_Sqrt:  [[0.15]]
grads:  [-0.08603474]
Stock Position:  -0.08603474162675244
Bond Position:  [22.65521587]


portfolio before change:  [13.37278109]
curr_Stock_Price:  107.90816135750312
curr_Factors:  [107.90816136]
mat_Sqrt:  [[0.15]]
grads:  [-0.00560691]
Stock Position:  -0.005606909661319491
Bond Position:  [13.9778124]


portfolio before change:  [13.37484287]
curr_Stock_Price:  107.69625492035175
curr_Factors:  [107.69625492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01977578]
Stock Position:  -0.01977578328046618
Bond Position:  [15.50462067]


portfolio before change:  [13.37819478]
curr_Stock_Price:  107.57576197792154
curr_Factors:  [107.57576198]
mat_Sqrt:  [[0.15]]
grads:  [-0.050361]
Stock Position:  -0.050360997559345665
Bond Position:  [18.79581747]


portfolio before change:  [13.39087541]
curr_Stock_Price:  107.34729429628536
curr_Factors:  [107.3472943]
mat_Sqrt:  [[0.15]]
grads:  [-0.02380269]
Stock Position:  -0.023802685546097473
Bond Position:  [15.94602931]


portfolio before change:  [13.38490589]
curr_Stock_Price:  107.63995817138495
curr_Factors:  [107.63995817]
mat_Sqrt:  [[0.15]]
grads:  [-0.11361525]
Stock Position:  -0.11361525060080736
Bond Position:  [25.61444671]


portfolio before change:  [13.4163312]
curr_Stock_Price:  107.37745504264574
curr_Factors:  [107.37745504]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083064]
Stock Position:  -0.0008306364402294898
Bond Position:  [13.50552283]


portfolio before change:  [13.41718559]
curr_Stock_Price:  107.36509372388988
curr_Factors:  [107.36509372]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179137]
Stock Position:  -0.0179136978767822
Bond Position:  [15.34049144]


portfolio before change:  [13.4081701]
curr_Stock_Price:  107.92189080606478
curr_Factors:  [107.92189081]
mat_Sqrt:  [[0.15]]
grads:  [0.18833936]
Stock Position:  0.1883393568863701
Bond Position:  [-6.9177694]


portfolio before change:  [13.52803533]
curr_Stock_Price:  108.5606186984892
curr_Factors:  [108.5606187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03232181]
Stock Position:  -0.032321809938717895
Bond Position:  [17.03691101]


portfolio before change:  [13.5115234]
curr_Stock_Price:  109.10442404821185
curr_Factors:  [109.10442405]
mat_Sqrt:  [[0.15]]
grads:  [0.15320223]
Stock Position:  0.1532022301135433
Bond Position:  [-3.20351768]


portfolio before change:  [13.44083849]
curr_Stock_Price:  108.64434799449714
curr_Factors:  [108.64434799]
mat_Sqrt:  [[0.15]]
grads:  [0.06143113]
Stock Position:  0.06143112910491693
Bond Position:  [6.76669353]


portfolio before change:  [13.48011113]
curr_Stock_Price:  109.27675878907806
curr_Factors:  [109.27675879]
mat_Sqrt:  [[0.15]]
grads:  [0.07899624]
Stock Position:  0.07899624149085403
Bond Position:  [4.84765791]


portfolio before change:  [13.48052758]
curr_Stock_Price:  109.27819503646826
curr_Factors:  [109.27819504]
mat_Sqrt:  [[0.15]]
grads:  [0.06121281]
Stock Position:  0.061212805677566935
Bond Position:  [6.79130266]


portfolio before change:  [13.49259211]
curr_Stock_Price:  109.4683522448264
curr_Factors:  [109.46835224]
mat_Sqrt:  [[0.15]]
grads:  [-0.09541053]
Stock Position:  -0.09541053138660711
Bond Position:  [23.93702576]


portfolio before change:  [13.38189172]
curr_Stock_Price:  110.6442863421162
curr_Factors:  [110.64428634]
mat_Sqrt:  [[0.15]]
grads:  [-0.4715071]
Stock Position:  -0.47150710041899824
Bond Position:  [65.55145835]


portfolio before change:  [13.35452728]
curr_Stock_Price:  110.71101181986236
curr_Factors:  [110.71101182]
mat_Sqrt:  [[0.15]]
grads:  [0.00205721]
Stock Position:  0.002057208404799954
Bond Position:  [13.12677165]


portfolio before change:  [13.35473946]
curr_Stock_Price:  110.41533827365656
curr_Factors:  [110.41533827]
mat_Sqrt:  [[0.15]]
grads:  [-0.10842088]
Stock Position:  -0.10842087793568829
Bond Position:  [25.32606738]


portfolio before change:  [13.25679758]
curr_Stock_Price:  111.33328704190397
curr_Factors:  [111.33328704]
mat_Sqrt:  [[0.15]]
grads:  [-0.23310906]
Stock Position:  -0.23310905531239495
Bond Position:  [39.20959495]


portfolio before change:  [13.02490044]
curr_Stock_Price:  112.33860112870106
curr_Factors:  [112.33860113]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405511]
Stock Position:  -0.044055113441071825
Bond Position:  [17.97399026]


portfolio before change:  [13.0289382]
curr_Stock_Price:  112.27244888526195
curr_Factors:  [112.27244889]
mat_Sqrt:  [[0.15]]
grads:  [0.18010649]
Stock Position:  0.18010649487827957
Bond Position:  [-7.19205904]


portfolio before change:  [12.91388567]
curr_Stock_Price:  111.63614199007415
curr_Factors:  [111.63614199]
mat_Sqrt:  [[0.15]]
grads:  [0.80718377]
Stock Position:  0.8071837720038966
Bond Position:  [-77.19699651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.24690326]
Stock Price:  112.05468676091544
PL:  [1.1922165]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.09017831e-03]
 [ 3.14201304e-02]
 [ 2.10387480e-02]
 [-1.41822332e-02]
 [ 5.90963537e-03]
 [-5.17929214e-03]
 [ 2.10608260e-03]
 [-5.46193146e-03]
 [ 8.95905995e-03]
 [ 1.71470368e-03]
 [ 2.38528912e-03]
 [-2.06274754e-03]
 [-2.39663542e-03]
 [ 9.13683627e-03]
 [-4.73853987e-04]
 [ 1.60719026e-02]
 [ 5.90024703e-02]
 [-1.36476036e-02]
 [ 1.96725305e-02]
 [ 1.09670927e-03]
 [-4.40257117e-03]
 [ 4.12551385e-03]
 [ 1.49654017e-02]
 [ 1.75040679e-02]
 [-5.72968489e-03]
 [ 4.61327579e-03]
 [ 1.08481261e-02]
 [ 9.21709529e-03]
 [ 1.61611791e-02]
 [ 3.29494251e-02]
 [-6.40624257e-03]
 [ 1.11337164e-02]
 [ 1.15354127e-02]
 [-2.02031165e-02]
 [-4.09447299e-03]
 [ 1.80633188e-02]
 [-1.04225282e-02]
 [ 3.01812829e-03]
 [-5.73961314e-02]
 [-1.30118728e-02]
 [ 7.18401653e-03]
 [ 1.65086052e-03]
 [-1.51492084e-03]
 [-3.93766528e-03]
 [ 1.97548665e-02]
 [ 1.46349941e-02]
 [ 1.08377650e-02]
 [ 4.24793104e-03]
 [ 6.59918158e-03]
 [-2.27483592e-03]
 [-5.31390317e-03]
 [-4.84712435e-03]
 [ 2.05481510e-03]
 [ 3.29834671e-03]
 [-6.58168916e-03]
 [-4.36649980e-03]
 [ 2.80744894e-03]
 [ 5.38619807e-03]
 [ 7.26301715e-03]
 [-3.99968497e-03]
 [-1.79480382e-03]
 [ 1.17538060e-03]
 [-6.39306364e-03]
 [ 5.35511083e-03]
 [ 1.98088811e-02]
 [ 5.25811147e-03]
 [ 8.61902158e-03]
 [-3.35853441e-04]
 [ 2.71982489e-03]
 [ 2.26532104e-02]
 [ 3.62546230e-03]
 [-1.55756750e-02]
 [-5.53824756e-03]
 [ 1.31649278e-03]
 [ 9.11484795e-03]
 [ 1.76466000e-03]
 [-1.58564996e-03]
 [-7.15079043e-03]
 [-2.28266055e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.42214404]
curr_Stock_Price:  100.51741185453558
curr_Factors:  [100.51741185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02726786]
Stock Position:  -0.027267855390998078
Bond Position:  [16.16303829]


portfolio before change:  [13.41710146]
curr_Stock_Price:  100.73938738561316
curr_Factors:  [100.73938739]
mat_Sqrt:  [[0.15]]
grads:  [0.20946754]
Stock Position:  0.20946753571050683
Bond Position:  [-7.68452976]


portfolio before change:  [13.42856704]
curr_Stock_Price:  100.7964171005051
curr_Factors:  [100.7964171]
mat_Sqrt:  [[0.15]]
grads:  [0.14025832]
Stock Position:  0.14025832015479162
Bond Position:  [-0.7089691]


portfolio before change:  [13.39903027]
curr_Stock_Price:  100.58614466497771
curr_Factors:  [100.58614466]
mat_Sqrt:  [[0.15]]
grads:  [-0.09454822]
Stock Position:  -0.0945482212868885
Bond Position:  [22.90927133]


portfolio before change:  [13.417668]
curr_Stock_Price:  100.40416495413143
curr_Factors:  [100.40416495]
mat_Sqrt:  [[0.15]]
grads:  [0.03939757]
Stock Position:  0.03939756914964403
Bond Position:  [9.46198797]


portfolio before change:  [13.40618546]
curr_Stock_Price:  100.09770118101113
curr_Factors:  [100.09770118]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452861]
Stock Position:  -0.034528614264214504
Bond Position:  [16.86242038]


portfolio before change:  [13.41866248]
curr_Stock_Price:  99.76687185690305
curr_Factors:  [99.76687186]
mat_Sqrt:  [[0.15]]
grads:  [0.01404055]
Stock Position:  0.014040550678401665
Bond Position:  [12.01788066]


portfolio before change:  [13.42100464]
curr_Stock_Price:  99.88018843204031
curr_Factors:  [99.88018843]
mat_Sqrt:  [[0.15]]
grads:  [-0.03641288]
Stock Position:  -0.036412876368018536
Bond Position:  [17.0579296]


portfolio before change:  [13.38272891]
curr_Stock_Price:  100.96062733951234
curr_Factors:  [100.96062734]
mat_Sqrt:  [[0.15]]
grads:  [0.05972707]
Stock Position:  0.05972706635769818
Bond Position:  [7.35264682]


portfolio before change:  [13.36526456]
curr_Stock_Price:  100.66053040932178
curr_Factors:  [100.66053041]
mat_Sqrt:  [[0.15]]
grads:  [0.01143136]
Stock Position:  0.011431357879526882
Bond Position:  [12.21457801]


portfolio before change:  [13.36590803]
curr_Stock_Price:  100.65003643668429
curr_Factors:  [100.65003644]
mat_Sqrt:  [[0.15]]
grads:  [0.01590193]
Stock Position:  0.015901927470776175
Bond Position:  [11.76537845]


portfolio before change:  [13.35960198]
curr_Stock_Price:  100.20723398294045
curr_Factors:  [100.20723398]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375165]
Stock Position:  -0.013751650244439232
Bond Position:  [14.73761681]


portfolio before change:  [13.36007998]
curr_Stock_Price:  100.239457730654
curr_Factors:  [100.23945773]
mat_Sqrt:  [[0.15]]
grads:  [-0.01597757]
Stock Position:  -0.01597756946511479
Bond Position:  [14.96166288]


portfolio before change:  [13.3616214]
curr_Stock_Price:  100.20151155540411
curr_Factors:  [100.20151156]
mat_Sqrt:  [[0.15]]
grads:  [0.06091224]
Stock Position:  0.06091224179573475
Bond Position:  [7.2581227]


portfolio before change:  [13.41664201]
curr_Stock_Price:  101.09734080236628
curr_Factors:  [101.0973408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00315903]
Stock Position:  -0.003159026577282467
Bond Position:  [13.7360112]


portfolio before change:  [13.4175822]
curr_Stock_Price:  101.07149201965653
curr_Factors:  [101.07149202]
mat_Sqrt:  [[0.15]]
grads:  [0.10714602]
Stock Position:  0.10714601722913285
Bond Position:  [2.58817437]


portfolio before change:  [13.42604532]
curr_Stock_Price:  101.14896910365012
curr_Factors:  [101.1489691]
mat_Sqrt:  [[0.15]]
grads:  [0.3933498]
Stock Position:  0.3933498017723116
Bond Position:  [-26.36088162]


portfolio before change:  [13.56514382]
curr_Stock_Price:  101.50678319400176
curr_Factors:  [101.50678319]
mat_Sqrt:  [[0.15]]
grads:  [-0.09098402]
Stock Position:  -0.09098402422964683
Bond Position:  [22.80063944]


portfolio before change:  [13.53628469]
curr_Stock_Price:  101.83963515325668
curr_Factors:  [101.83963515]
mat_Sqrt:  [[0.15]]
grads:  [0.1311502]
Stock Position:  0.13115020360899915
Bond Position:  [0.17999581]


portfolio before change:  [13.56763104]
curr_Stock_Price:  102.07856041248607
curr_Factors:  [102.07856041]
mat_Sqrt:  [[0.15]]
grads:  [0.0073114]
Stock Position:  0.0073113951273992535
Bond Position:  [12.82129435]


portfolio before change:  [13.55722776]
curr_Stock_Price:  100.54607143486083
curr_Factors:  [100.54607143]
mat_Sqrt:  [[0.15]]
grads:  [-0.02935047]
Stock Position:  -0.02935047446976922
Bond Position:  [16.50830267]


portfolio before change:  [13.56919998]
curr_Stock_Price:  100.17332058116382
curr_Factors:  [100.17332058]
mat_Sqrt:  [[0.15]]
grads:  [0.02750343]
Stock Position:  0.0275034256368091
Bond Position:  [10.8140905]


portfolio before change:  [13.56982106]
curr_Stock_Price:  100.17132728943955
curr_Factors:  [100.17132729]
mat_Sqrt:  [[0.15]]
grads:  [0.09976934]
Stock Position:  0.09976934473206937
Bond Position:  [3.57579337]


portfolio before change:  [13.53162158]
curr_Stock_Price:  99.78620928720511
curr_Factors:  [99.78620929]
mat_Sqrt:  [[0.15]]
grads:  [0.11669379]
Stock Position:  0.11669378575917154
Bond Position:  [1.88719105]


portfolio before change:  [13.43479985]
curr_Stock_Price:  98.95549084125624
curr_Factors:  [98.95549084]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381979]
Stock Position:  -0.03819789924766519
Bond Position:  [17.21469172]


portfolio before change:  [13.4311324]
curr_Stock_Price:  99.07967064876658
curr_Factors:  [99.07967065]
mat_Sqrt:  [[0.15]]
grads:  [0.03075517]
Stock Position:  0.03075517192513714
Bond Position:  [10.38392009]


portfolio before change:  [13.4212173]
curr_Stock_Price:  98.73618012106624
curr_Factors:  [98.73618012]
mat_Sqrt:  [[0.15]]
grads:  [0.07232084]
Stock Position:  0.07232084056665143
Bond Position:  [6.28053376]


portfolio before change:  [13.36114529]
curr_Stock_Price:  97.90012017961233
curr_Factors:  [97.90012018]
mat_Sqrt:  [[0.15]]
grads:  [0.0614473]
Stock Position:  0.061447301925789344
Bond Position:  [7.34544705]


portfolio before change:  [13.32324402]
curr_Stock_Price:  97.27583924513011
curr_Factors:  [97.27583925]
mat_Sqrt:  [[0.15]]
grads:  [0.10774119]
Stock Position:  0.1077411939768574
Bond Position:  [2.84262895]


portfolio before change:  [13.32095525]
curr_Stock_Price:  97.25294697961816
curr_Factors:  [97.25294698]
mat_Sqrt:  [[0.15]]
grads:  [0.21966283]
Stock Position:  0.21966283412952833
Bond Position:  [-8.04190271]


portfolio before change:  [13.52416611]
curr_Stock_Price:  98.18033872038293
curr_Factors:  [98.18033872]
mat_Sqrt:  [[0.15]]
grads:  [-0.04270828]
Stock Position:  -0.04270828379996392
Bond Position:  [17.71727988]


portfolio before change:  [13.50134436]
curr_Stock_Price:  98.74063080693548
curr_Factors:  [98.74063081]
mat_Sqrt:  [[0.15]]
grads:  [0.07422478]
Stock Position:  0.07422477576448537
Bond Position:  [6.17234318]


portfolio before change:  [13.50250138]
curr_Stock_Price:  98.75102134298972
curr_Factors:  [98.75102134]
mat_Sqrt:  [[0.15]]
grads:  [0.07690275]
Stock Position:  0.07690275105561631
Bond Position:  [5.90827617]


portfolio before change:  [13.44104202]
curr_Stock_Price:  97.94703664614237
curr_Factors:  [97.94703665]
mat_Sqrt:  [[0.15]]
grads:  [-0.13468744]
Stock Position:  -0.13468744309231964
Bond Position:  [26.63327795]


portfolio before change:  [13.40469583]
curr_Stock_Price:  98.22925173562672
curr_Factors:  [98.22925174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02729649]
Stock Position:  -0.027296486570794674
Bond Position:  [16.08600928]


portfolio before change:  [13.41078503]
curr_Stock_Price:  98.04300809481641
curr_Factors:  [98.04300809]
mat_Sqrt:  [[0.15]]
grads:  [0.12042213]
Stock Position:  0.12042212544501064
Bond Position:  [1.60423761]


portfolio before change:  [13.61339845]
curr_Stock_Price:  99.724701966346
curr_Factors:  [99.72470197]
mat_Sqrt:  [[0.15]]
grads:  [-0.06948352]
Stock Position:  -0.06948352147008932
Bond Position:  [20.54262192]


portfolio before change:  [13.63145066]
curr_Stock_Price:  99.48337487540728
curr_Factors:  [99.48337488]
mat_Sqrt:  [[0.15]]
grads:  [0.02012086]
Stock Position:  0.020120855254892978
Bond Position:  [11.62976007]


portfolio before change:  [13.63475452]
curr_Stock_Price:  99.61144987745313
curr_Factors:  [99.61144988]
mat_Sqrt:  [[0.15]]
grads:  [-0.38264088]
Stock Position:  -0.3826408758432151
Bond Position:  [51.75016695]


portfolio before change:  [13.73099261]
curr_Stock_Price:  99.36839272562943
curr_Factors:  [99.36839273]
mat_Sqrt:  [[0.15]]
grads:  [-0.08674582]
Stock Position:  -0.08674581868645746
Bond Position:  [22.35078519]


portfolio before change:  [13.76302399]
curr_Stock_Price:  99.01524119431234
curr_Factors:  [99.01524119]
mat_Sqrt:  [[0.15]]
grads:  [0.04789344]
Stock Position:  0.047893443504039256
Bond Position:  [9.02084313]


portfolio before change:  [13.78284057]
curr_Stock_Price:  99.41723267109273
curr_Factors:  [99.41723267]
mat_Sqrt:  [[0.15]]
grads:  [0.01100574]
Stock Position:  0.011005736825481066
Bond Position:  [12.68868067]


portfolio before change:  [13.79111295]
curr_Stock_Price:  100.09681583833914
curr_Factors:  [100.09681584]
mat_Sqrt:  [[0.15]]
grads:  [-0.01009947]
Stock Position:  -0.010099472290264902
Bond Position:  [14.80203797]


portfolio before change:  [13.7898553]
curr_Stock_Price:  100.3129469682161
curr_Factors:  [100.31294697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262511]
Stock Position:  -0.026251101857103123
Bond Position:  [16.42318069]


portfolio before change:  [13.77527653]
curr_Stock_Price:  100.90740772145043
curr_Factors:  [100.90740772]
mat_Sqrt:  [[0.15]]
grads:  [0.13169911]
Stock Position:  0.13169910970164497
Bond Position:  [0.48586077]


portfolio before change:  [13.7411376]
curr_Stock_Price:  100.64795797153891
curr_Factors:  [100.64795797]
mat_Sqrt:  [[0.15]]
grads:  [0.09756663]
Stock Position:  0.09756662764494006
Bond Position:  [3.92125576]


portfolio before change:  [13.68243227]
curr_Stock_Price:  100.04375125433143
curr_Factors:  [100.04375125]
mat_Sqrt:  [[0.15]]
grads:  [0.07225177]
Stock Position:  0.07225176638550945
Bond Position:  [6.45409453]


portfolio before change:  [13.67092118]
curr_Stock_Price:  99.87884896871577
curr_Factors:  [99.87884897]
mat_Sqrt:  [[0.15]]
grads:  [0.02831954]
Stock Position:  0.0283195402609453
Bond Position:  [10.8423981]


portfolio before change:  [13.66403174]
curr_Stock_Price:  99.61164449752982
curr_Factors:  [99.6116445]
mat_Sqrt:  [[0.15]]
grads:  [0.04399454]
Stock Position:  0.04399454389747332
Bond Position:  [9.28166288]


portfolio before change:  [13.66204147]
curr_Stock_Price:  99.55321920565603
curr_Factors:  [99.55321921]
mat_Sqrt:  [[0.15]]
grads:  [-0.01516557]
Stock Position:  -0.015165572767509058
Bond Position:  [15.17182306]


portfolio before change:  [13.66398125]
curr_Stock_Price:  99.48784031342201
curr_Factors:  [99.48784031]
mat_Sqrt:  [[0.15]]
grads:  [-0.03542602]
Stock Position:  -0.035426021110615456
Bond Position:  [17.18843958]


portfolio before change:  [13.65945683]
curr_Stock_Price:  99.64588039046122
curr_Factors:  [99.64588039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231416]
Stock Position:  -0.0323141623174987
Bond Position:  [16.87942998]


portfolio before change:  [13.65128664]
curr_Stock_Price:  99.93136478291532
curr_Factors:  [99.93136478]
mat_Sqrt:  [[0.15]]
grads:  [0.01369877]
Stock Position:  0.01369876734992766
Bond Position:  [12.28235012]


portfolio before change:  [13.65065562]
curr_Stock_Price:  99.8292613986977
curr_Factors:  [99.8292614]
mat_Sqrt:  [[0.15]]
grads:  [0.02198898]
Stock Position:  0.02198897803921909
Bond Position:  [11.45551218]


portfolio before change:  [13.63747304]
curr_Stock_Price:  99.19719156728961
curr_Factors:  [99.19719157]
mat_Sqrt:  [[0.15]]
grads:  [-0.04387793]
Stock Position:  -0.04387792776005114
Bond Position:  [17.99004025]


portfolio before change:  [13.6214979]
curr_Stock_Price:  99.58689896702207
curr_Factors:  [99.58689897]
mat_Sqrt:  [[0.15]]
grads:  [-0.02911]
Stock Position:  -0.029109998682846187
Bond Position:  [16.5204724]


portfolio before change:  [13.62824428]
curr_Stock_Price:  99.39061512114517
curr_Factors:  [99.39061512]
mat_Sqrt:  [[0.15]]
grads:  [0.01871633]
Stock Position:  0.018716326275237442
Bond Position:  [11.7680171]


portfolio before change:  [13.63157581]
curr_Stock_Price:  99.52931752509669
curr_Factors:  [99.52931753]
mat_Sqrt:  [[0.15]]
grads:  [0.03590799]
Stock Position:  0.03590798710159433
Bond Position:  [10.05767836]


portfolio before change:  [13.63771523]
curr_Stock_Price:  99.6827875416617
curr_Factors:  [99.68278754]
mat_Sqrt:  [[0.15]]
grads:  [0.04842011]
Stock Position:  0.0484201143366009
Bond Position:  [8.81106326]


portfolio before change:  [13.62030745]
curr_Stock_Price:  99.31189845893567
curr_Factors:  [99.31189846]
mat_Sqrt:  [[0.15]]
grads:  [-0.02666457]
Stock Position:  -0.026664566437884202
Bond Position:  [16.26841616]


portfolio before change:  [13.63231123]
curr_Stock_Price:  98.89985459714975
curr_Factors:  [98.8998546]
mat_Sqrt:  [[0.15]]
grads:  [-0.01196536]
Stock Position:  -0.011965358802241902
Bond Position:  [14.81568347]


portfolio before change:  [13.63676709]
curr_Stock_Price:  98.60484841662164
curr_Factors:  [98.60484842]
mat_Sqrt:  [[0.15]]
grads:  [0.00783587]
Stock Position:  0.007835870654311931
Bond Position:  [12.86411225]


portfolio before change:  [13.64078902]
curr_Stock_Price:  99.01551005314325
curr_Factors:  [99.01551005]
mat_Sqrt:  [[0.15]]
grads:  [-0.04262042]
Stock Position:  -0.042620424248135835
Bond Position:  [17.86087206]


portfolio before change:  [13.63856814]
curr_Stock_Price:  99.09381090619324
curr_Factors:  [99.09381091]
mat_Sqrt:  [[0.15]]
grads:  [0.03570074]
Stock Position:  0.03570073889258296
Bond Position:  [10.10084587]


portfolio before change:  [13.64108082]
curr_Stock_Price:  99.14650902207805
curr_Factors:  [99.14650902]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [0.54787146]


portfolio before change:  [13.63252236]
curr_Stock_Price:  99.08144192963036
curr_Factors:  [99.08144193]
mat_Sqrt:  [[0.15]]
grads:  [0.03505408]
Stock Position:  0.035054076476996904
Bond Position:  [10.15931391]


portfolio before change:  [13.63390623]
curr_Stock_Price:  99.10280581215056
curr_Factors:  [99.10280581]
mat_Sqrt:  [[0.15]]
grads:  [0.05746014]
Stock Position:  0.05746014383575219
Bond Position:  [7.93944475]


portfolio before change:  [13.61420294]
curr_Stock_Price:  98.75126613129427
curr_Factors:  [98.75126613]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223902]
Stock Position:  -0.0022390229402800372
Bond Position:  [13.83530929]


portfolio before change:  [13.61550374]
curr_Stock_Price:  98.55650587639737
curr_Factors:  [98.55650588]
mat_Sqrt:  [[0.15]]
grads:  [0.01813217]
Stock Position:  0.018132165939859887
Bond Position:  [11.82846082]


portfolio before change:  [13.60748738]
curr_Stock_Price:  98.07362583559403
curr_Factors:  [98.07362584]
mat_Sqrt:  [[0.15]]
grads:  [0.1510214]
Stock Position:  0.15102140274447148
Bond Position:  [-1.20372916]


portfolio before change:  [13.52656223]
curr_Stock_Price:  97.53827177359078
curr_Factors:  [97.53827177]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [11.16908671]


portfolio before change:  [13.52297676]
curr_Stock_Price:  97.36104369184692
curr_Factors:  [97.36104369]
mat_Sqrt:  [[0.15]]
grads:  [-0.10383783]
Stock Position:  -0.10383783344931823
Bond Position:  [23.6327366]


portfolio before change:  [13.55635169]
curr_Stock_Price:  97.05385465241054
curr_Factors:  [97.05385465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03692165]
Stock Position:  -0.03692165041544381
Bond Position:  [17.13974019]


portfolio before change:  [13.53750187]
curr_Stock_Price:  97.59340519349067
curr_Factors:  [97.59340519]
mat_Sqrt:  [[0.15]]
grads:  [0.00877662]
Stock Position:  0.008776618507470633
Bond Position:  [12.68096178]


portfolio before change:  [13.53604124]
curr_Stock_Price:  97.33667610686541
curr_Factors:  [97.33667611]
mat_Sqrt:  [[0.15]]
grads:  [0.06076565]
Stock Position:  0.060765653026960444
Bond Position:  [7.62131455]


portfolio before change:  [13.51711674]
curr_Stock_Price:  97.0174029451427
curr_Factors:  [97.01740295]
mat_Sqrt:  [[0.15]]
grads:  [0.0117644]
Stock Position:  0.01176439998332764
Bond Position:  [12.37576521]


portfolio before change:  [13.51454353]
curr_Stock_Price:  96.73292465811927
curr_Factors:  [96.73292466]
mat_Sqrt:  [[0.15]]
grads:  [-0.010571]
Stock Position:  -0.010570999727920645
Bond Position:  [14.53710726]


portfolio before change:  [13.50927757]
curr_Stock_Price:  97.31702818707186
curr_Factors:  [97.31702819]
mat_Sqrt:  [[0.15]]
grads:  [-0.04767194]
Stock Position:  -0.04767193619348508
Bond Position:  [18.14856873]


portfolio before change:  [13.51514818]
curr_Stock_Price:  97.21767661092636
curr_Factors:  [97.21767661]
mat_Sqrt:  [[0.15]]
grads:  [-0.15217737]
Stock Position:  -0.15217736999764467
Bond Position:  [28.30947852]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.54286368]
Stock Price:  97.04717753827404
PL:  [13.54286368]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32650812e-02]
 [-7.84548078e-03]
 [ 4.45038316e-03]
 [-8.59148577e-03]
 [ 1.33459609e-02]
 [-1.35440033e-02]
 [-1.21791528e-04]
 [-3.48652141e-04]
 [-1.16235712e-02]
 [ 1.07213788e-03]
 [ 1.48920469e-02]
 [-5.60287940e-03]
 [-1.33400558e-03]
 [ 9.77414582e-03]
 [ 2.33810877e-04]
 [ 1.44104612e-02]
 [ 6.05721148e-02]
 [-1.37638022e-02]
 [ 1.98225687e-02]
 [ 1.33850719e-03]
 [-5.07224428e-03]
 [ 4.58018293e-03]
 [ 1.24695004e-02]
 [ 2.95967815e-02]
 [-1.35818308e-03]
 [ 7.86647494e-03]
 [-4.37140164e-03]
 [ 1.43288986e-02]
 [ 2.80925695e-02]
 [-8.22879888e-03]
 [-2.10551280e-03]
 [ 1.28014315e-02]
 [ 1.26777420e-02]
 [-2.31941583e-03]
 [ 5.89595105e-03]
 [ 1.46012497e-02]
 [-1.44701535e-02]
 [ 2.62902965e-03]
 [-5.64392833e-02]
 [ 1.45856246e-02]
 [ 7.20164752e-03]
 [-2.63501706e-03]
 [-1.68257665e-03]
 [-2.68366428e-03]
 [ 1.94728236e-02]
 [ 1.52107338e-02]
 [ 1.09066458e-02]
 [ 3.80705202e-03]
 [ 1.02220299e-02]
 [-1.53803434e-03]
 [ 5.39235760e-03]
 [-1.75651101e-02]
 [ 2.20853248e-03]
 [ 2.29312116e-03]
 [-3.49888431e-03]
 [-3.81973296e-03]
 [ 7.79958805e-03]
 [ 6.01298740e-03]
 [ 7.47390928e-03]
 [-3.92287497e-03]
 [-3.65221462e-03]
 [ 4.93688813e-04]
 [-6.06667164e-03]
 [ 6.46803834e-03]
 [ 2.03253516e-02]
 [ 5.02915564e-03]
 [ 8.46697659e-03]
 [-7.09029707e-04]
 [ 2.98418757e-03]
 [ 2.17874282e-02]
 [ 7.26400781e-04]
 [-1.59961120e-02]
 [-2.86213241e-03]
 [ 1.31523197e-03]
 [ 1.51367454e-05]
 [-1.17409679e-02]
 [-4.19830382e-03]
 [ 1.56063353e-02]
 [-7.57458885e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.90309042]
curr_Stock_Price:  99.94882209424549
curr_Factors:  [99.94882209]
mat_Sqrt:  [[0.15]]
grads:  [-0.08843387]
Stock Position:  -0.08843387477796633
Bond Position:  [9.74195203]


portfolio before change:  [0.95682746]
curr_Stock_Price:  99.34805507920184
curr_Factors:  [99.34805508]
mat_Sqrt:  [[0.15]]
grads:  [-0.05230321]
Stock Position:  -0.05230320520490584
Bond Position:  [6.15304917]


portfolio before change:  [0.93330989]
curr_Stock_Price:  99.80504718723665
curr_Factors:  [99.80504719]
mat_Sqrt:  [[0.15]]
grads:  [0.02966922]
Stock Position:  0.029669221043094537
Bond Position:  [-2.02782812]


portfolio before change:  [0.92261585]
curr_Stock_Price:  99.44887701872013
curr_Factors:  [99.44887702]
mat_Sqrt:  [[0.15]]
grads:  [-0.05727657]
Stock Position:  -0.05727657181433878
Bond Position:  [6.6187066]


portfolio before change:  [0.9266173]
curr_Stock_Price:  99.38623775227067
curr_Factors:  [99.38623775]
mat_Sqrt:  [[0.15]]
grads:  [0.08897307]
Stock Position:  0.08897307295800276
Bond Position:  [-7.91608168]


portfolio before change:  [0.91363243]
curr_Stock_Price:  99.24585712738644
curr_Factors:  [99.24585713]
mat_Sqrt:  [[0.15]]
grads:  [-0.09029336]
Stock Position:  -0.09029335509509305
Bond Position:  [9.87487385]


portfolio before change:  [0.89383612]
curr_Stock_Price:  99.47193699244303
curr_Factors:  [99.47193699]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081194]
Stock Position:  -0.0008119435231882892
Bond Position:  [0.97460172]


portfolio before change:  [0.8938419]
curr_Stock_Price:  99.53984257650468
curr_Factors:  [99.53984258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232435]
Stock Position:  -0.002324347603814003
Bond Position:  [1.1252071]


portfolio before change:  [0.89387125]
curr_Stock_Price:  99.55747060820602
curr_Factors:  [99.55747061]
mat_Sqrt:  [[0.15]]
grads:  [-0.07749047]
Stock Position:  -0.07749047448653469
Bond Position:  [8.60862689]


portfolio before change:  [0.82921033]
curr_Stock_Price:  100.39885113605587
curr_Factors:  [100.39885114]
mat_Sqrt:  [[0.15]]
grads:  [0.00714759]
Stock Position:  0.007147585872764572
Bond Position:  [0.11160092]


portfolio before change:  [0.82531354]
curr_Stock_Price:  99.85268452480686
curr_Factors:  [99.85268452]
mat_Sqrt:  [[0.15]]
grads:  [0.09928031]
Stock Position:  0.09928031290008442
Bond Position:  [-9.08809223]


portfolio before change:  [0.79482796]
curr_Stock_Price:  99.5513402334591
curr_Factors:  [99.55134023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03735253]
Stock Position:  -0.037352529366421326
Bond Position:  [4.51332232]


portfolio before change:  [0.78703884]
curr_Stock_Price:  99.7674222608835
curr_Factors:  [99.76742226]
mat_Sqrt:  [[0.15]]
grads:  [-0.00889337]
Stock Position:  -0.008893370530705496
Bond Position:  [1.67430749]


portfolio before change:  [0.78490888]
curr_Stock_Price:  100.0186892994747
curr_Factors:  [100.0186893]
mat_Sqrt:  [[0.15]]
grads:  [0.06516097]
Stock Position:  0.06516097213014442
Bond Position:  [-5.73240615]


portfolio before change:  [0.76815421]
curr_Stock_Price:  99.76706050397482
curr_Factors:  [99.7670605]
mat_Sqrt:  [[0.15]]
grads:  [0.00155874]
Stock Position:  0.0015587391822786956
Bond Position:  [0.61264339]


portfolio before change:  [0.76936239]
curr_Stock_Price:  100.51759244060274
curr_Factors:  [100.51759244]
mat_Sqrt:  [[0.15]]
grads:  [0.09606974]
Stock Position:  0.09606974137977904
Bond Position:  [-8.88733672]


portfolio before change:  [0.83541102]
curr_Stock_Price:  101.21088157024843
curr_Factors:  [101.21088157]
mat_Sqrt:  [[0.15]]
grads:  [0.4038141]
Stock Position:  0.40381409861974027
Bond Position:  [-40.03496989]


portfolio before change:  [0.92823933]
curr_Stock_Price:  101.44695697064445
curr_Factors:  [101.44695697]
mat_Sqrt:  [[0.15]]
grads:  [-0.09175868]
Stock Position:  -0.09175868121206304
Bond Position:  [10.23687831]


portfolio before change:  [0.8896663]
curr_Stock_Price:  101.87430455198076
curr_Factors:  [101.87430455]
mat_Sqrt:  [[0.15]]
grads:  [0.13215046]
Stock Position:  0.1321504576677668
Bond Position:  [-12.57306967]


portfolio before change:  [0.86285301]
curr_Stock_Price:  101.67735138901949
curr_Factors:  [101.67735139]
mat_Sqrt:  [[0.15]]
grads:  [0.00892338]
Stock Position:  0.008923381276947388
Bond Position:  [-0.04445276]


portfolio before change:  [0.86601445]
curr_Stock_Price:  102.03194947350009
curr_Factors:  [102.03194947]
mat_Sqrt:  [[0.15]]
grads:  [-0.03381496]
Stock Position:  -0.03381496185062619
Bond Position:  [4.31622093]


portfolio before change:  [0.88545718]
curr_Stock_Price:  101.46495315771493
curr_Factors:  [101.46495316]
mat_Sqrt:  [[0.15]]
grads:  [0.03053455]
Stock Position:  0.030534552875717935
Bond Position:  [-2.2127298]


portfolio before change:  [0.88936241]
curr_Stock_Price:  101.59737794276974
curr_Factors:  [101.59737794]
mat_Sqrt:  [[0.15]]
grads:  [0.08313]
Stock Position:  0.08313000266791969
Bond Position:  [-7.55642789]


portfolio before change:  [0.93038965]
curr_Stock_Price:  102.09659042809184
curr_Factors:  [102.09659043]
mat_Sqrt:  [[0.15]]
grads:  [0.19731188]
Stock Position:  0.19731187641347164
Bond Position:  [-19.21448018]


portfolio before change:  [0.81809923]
curr_Stock_Price:  101.5335757450051
curr_Factors:  [101.53357575]
mat_Sqrt:  [[0.15]]
grads:  [-0.00905455]
Stock Position:  -0.009054553895500243
Bond Position:  [1.73744046]


portfolio before change:  [0.8150554]
curr_Stock_Price:  101.88173489141514
curr_Factors:  [101.88173489]
mat_Sqrt:  [[0.15]]
grads:  [0.05244317]
Stock Position:  0.052443166255213315
Bond Position:  [-4.52794537]


portfolio before change:  [0.79676927]
curr_Stock_Price:  101.5384467761313
curr_Factors:  [101.53844678]
mat_Sqrt:  [[0.15]]
grads:  [-0.02914268]
Stock Position:  -0.0291426776244953
Bond Position:  [3.7558715]


portfolio before change:  [0.78931825]
curr_Stock_Price:  101.8021758234443
curr_Factors:  [101.80217582]
mat_Sqrt:  [[0.15]]
grads:  [0.09552599]
Stock Position:  0.09552599034304585
Bond Position:  [-8.93543541]


portfolio before change:  [0.80628472]
curr_Stock_Price:  101.9856332123044
curr_Factors:  [101.98563321]
mat_Sqrt:  [[0.15]]
grads:  [0.1872838]
Stock Position:  0.18728379677901008
Bond Position:  [-18.29397188]


portfolio before change:  [0.92311496]
curr_Stock_Price:  102.61555237458117
curr_Factors:  [102.61555237]
mat_Sqrt:  [[0.15]]
grads:  [-0.05485866]
Stock Position:  -0.05485865923279795
Bond Position:  [6.55246658]


portfolio before change:  [0.94934491]
curr_Stock_Price:  102.14488093736185
curr_Factors:  [102.14488094]
mat_Sqrt:  [[0.15]]
grads:  [-0.01403675]
Stock Position:  -0.014036752024156988
Bond Position:  [2.38312727]


portfolio before change:  [0.96026672]
curr_Stock_Price:  101.37740548298407
curr_Factors:  [101.37740548]
mat_Sqrt:  [[0.15]]
grads:  [0.08534288]
Stock Position:  0.08534287692670255
Bond Position:  [-7.69157272]


portfolio before change:  [0.95882425]
curr_Stock_Price:  101.36613643955899
curr_Factors:  [101.36613644]
mat_Sqrt:  [[0.15]]
grads:  [0.08451828]
Stock Position:  0.08451827998925981
Bond Position:  [-7.60846725]


portfolio before change:  [0.8461892]
curr_Stock_Price:  100.03909212946249
curr_Factors:  [100.03909213]
mat_Sqrt:  [[0.15]]
grads:  [-0.01546277]
Stock Position:  -0.015462772193209259
Bond Position:  [2.3930709]


portfolio before change:  [0.84050944]
curr_Stock_Price:  100.41608399684225
curr_Factors:  [100.416084]
mat_Sqrt:  [[0.15]]
grads:  [0.03930634]
Stock Position:  0.039306340330830136
Bond Position:  [-3.10647934]


portfolio before change:  [0.82074434]
curr_Stock_Price:  99.9181762352818
curr_Factors:  [99.91817624]
mat_Sqrt:  [[0.15]]
grads:  [0.09734166]
Stock Position:  0.09734166495461734
Bond Position:  [-8.90545729]


portfolio before change:  [0.82107517]
curr_Stock_Price:  99.92729293418274
curr_Factors:  [99.92729293]
mat_Sqrt:  [[0.15]]
grads:  [-0.09646769]
Stock Position:  -0.09646768976014873
Bond Position:  [10.46083026]


portfolio before change:  [0.77584155]
curr_Stock_Price:  100.40296972188932
curr_Factors:  [100.40296972]
mat_Sqrt:  [[0.15]]
grads:  [0.01752686]
Stock Position:  0.017526864337109687
Bond Position:  [-0.98390768]


portfolio before change:  [0.77438157]
curr_Stock_Price:  100.32317858585482
curr_Factors:  [100.32317859]
mat_Sqrt:  [[0.15]]
grads:  [-0.37626189]
Stock Position:  -0.37626188868116467
Bond Position:  [38.52217022]


portfolio before change:  [0.66725335]
curr_Stock_Price:  100.61429478022913
curr_Factors:  [100.61429478]
mat_Sqrt:  [[0.15]]
grads:  [0.0972375]
Stock Position:  0.09723749712530676
Bond Position:  [-9.11622885]


portfolio before change:  [0.55004879]
curr_Stock_Price:  99.41481126777812
curr_Factors:  [99.41481127]
mat_Sqrt:  [[0.15]]
grads:  [0.04801098]
Stock Position:  0.04801098348306539
Bond Position:  [-4.22295407]


portfolio before change:  [0.56308317]
curr_Stock_Price:  99.6917963013951
curr_Factors:  [99.6917963]
mat_Sqrt:  [[0.15]]
grads:  [-0.01756678]
Stock Position:  -0.01756678043229152
Bond Position:  [2.31434707]


portfolio before change:  [0.56436076]
curr_Stock_Price:  99.6273033018154
curr_Factors:  [99.6273033]
mat_Sqrt:  [[0.15]]
grads:  [-0.01121718]
Stock Position:  -0.01121717765367001
Bond Position:  [1.68189792]


portfolio before change:  [0.5625777]
curr_Stock_Price:  99.79563312765
curr_Factors:  [99.79563313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178911]
Stock Position:  -0.017891095169427215
Bond Position:  [2.34803086]


portfolio before change:  [0.56665805]
curr_Stock_Price:  99.57576946169937
curr_Factors:  [99.57576946]
mat_Sqrt:  [[0.15]]
grads:  [0.12981882]
Stock Position:  0.1298188243259557
Bond Position:  [-12.36015127]


portfolio before change:  [0.63986523]
curr_Stock_Price:  100.14563839080813
curr_Factors:  [100.14563839]
mat_Sqrt:  [[0.15]]
grads:  [0.10140489]
Stock Position:  0.10140489207788399
Bond Position:  [-9.51539242]


portfolio before change:  [0.66022768]
curr_Stock_Price:  100.35230665280639
curr_Factors:  [100.35230665]
mat_Sqrt:  [[0.15]]
grads:  [0.07271097]
Stock Position:  0.07271097233180612
Bond Position:  [-6.63648612]


portfolio before change:  [0.67231282]
curr_Stock_Price:  100.52421936038662
curr_Factors:  [100.52421936]
mat_Sqrt:  [[0.15]]
grads:  [0.02538035]
Stock Position:  0.02538034682285338
Bond Position:  [-1.87902673]


portfolio before change:  [0.68107557]
curr_Stock_Price:  100.8741038001623
curr_Factors:  [100.8741038]
mat_Sqrt:  [[0.15]]
grads:  [0.06814687]
Stock Position:  0.06814686609408815
Bond Position:  [-6.19317848]


portfolio before change:  [0.67851456]
curr_Stock_Price:  100.84220327069248
curr_Factors:  [100.84220327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025356]
Stock Position:  -0.01025356227098416
Bond Position:  [1.71250637]


portfolio before change:  [0.6800608]
curr_Stock_Price:  100.70184166822536
curr_Factors:  [100.70184167]
mat_Sqrt:  [[0.15]]
grads:  [0.03594905]
Stock Position:  0.03594905069602555
Bond Position:  [-2.94007481]


portfolio before change:  [0.70522244]
curr_Stock_Price:  101.40687842144129
curr_Factors:  [101.40687842]
mat_Sqrt:  [[0.15]]
grads:  [-0.11710073]
Stock Position:  -0.11710073432631037
Bond Position:  [12.58004237]


portfolio before change:  [0.76072169]
curr_Stock_Price:  100.93964845356425
curr_Factors:  [100.93964845]
mat_Sqrt:  [[0.15]]
grads:  [0.01472355]
Stock Position:  0.014723549892750588
Bond Position:  [-0.72546826]


portfolio before change:  [0.75814997]
curr_Stock_Price:  100.76806080712149
curr_Factors:  [100.76806081]
mat_Sqrt:  [[0.15]]
grads:  [0.01528747]
Stock Position:  0.015287474367114487
Bond Position:  [-0.78233917]


portfolio before change:  [0.76806696]
curr_Stock_Price:  101.4199596845938
curr_Factors:  [101.41995968]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233259]
Stock Position:  -0.02332589538629837
Bond Position:  [3.13377833]


portfolio before change:  [0.78505122]
curr_Stock_Price:  100.70022767601654
curr_Factors:  [100.70022768]
mat_Sqrt:  [[0.15]]
grads:  [-0.02546489]
Stock Position:  -0.025464886408334983
Bond Position:  [3.34937108]


portfolio before change:  [0.79013598]
curr_Stock_Price:  100.50877123423757
curr_Factors:  [100.50877123]
mat_Sqrt:  [[0.15]]
grads:  [0.05199725]
Stock Position:  0.05199725364756973
Bond Position:  [-4.43604409]


portfolio before change:  [0.73249656]
curr_Stock_Price:  99.40559448395945
curr_Factors:  [99.40559448]
mat_Sqrt:  [[0.15]]
grads:  [0.04008658]
Stock Position:  0.04008658265788059
Bond Position:  [-3.25233402]


portfolio before change:  [0.70899951]
curr_Stock_Price:  98.82450790519913
curr_Factors:  [98.82450791]
mat_Sqrt:  [[0.15]]
grads:  [0.04982606]
Stock Position:  0.04982606189496675
Bond Position:  [-4.21503654]


portfolio before change:  [0.69226549]
curr_Stock_Price:  98.49394656599841
curr_Factors:  [98.49394657]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261525]
Stock Position:  -0.026152499821552114
Bond Position:  [3.26812841]


portfolio before change:  [0.70139172]
curr_Stock_Price:  98.1527947748294
curr_Factors:  [98.15279477]
mat_Sqrt:  [[0.15]]
grads:  [-0.0243481]
Stock Position:  -0.02434809743890596
Bond Position:  [3.09122554]


portfolio before change:  [0.69949053]
curr_Stock_Price:  98.23881385091258
curr_Factors:  [98.23881385]
mat_Sqrt:  [[0.15]]
grads:  [0.00329126]
Stock Position:  0.003291258754388876
Bond Position:  [0.37616118]


portfolio before change:  [0.70049614]
curr_Stock_Price:  98.53720968480708
curr_Factors:  [98.53720968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04044448]
Stock Position:  -0.04044447757417704
Bond Position:  [4.68578211]


portfolio before change:  [0.66865715]
curr_Stock_Price:  99.3316780140155
curr_Factors:  [99.33167801]
mat_Sqrt:  [[0.15]]
grads:  [0.04312026]
Stock Position:  0.04312025558080686
Bond Position:  [-3.61455019]


portfolio before change:  [0.67801217]
curr_Stock_Price:  99.5538688869953
curr_Factors:  [99.55386889]
mat_Sqrt:  [[0.15]]
grads:  [0.13550234]
Stock Position:  0.135502343942316
Bond Position:  [-12.81177042]


portfolio before change:  [0.5859881]
curr_Stock_Price:  98.8806458423186
curr_Factors:  [98.88064584]
mat_Sqrt:  [[0.15]]
grads:  [0.0335277]
Stock Position:  0.03352770429914851
Bond Position:  [-2.72925295]


portfolio before change:  [0.5953143]
curr_Stock_Price:  99.16389752579161
curr_Factors:  [99.16389753]
mat_Sqrt:  [[0.15]]
grads:  [0.05644651]
Stock Position:  0.056446510571315514
Bond Position:  [-5.00214169]


portfolio before change:  [0.62266982]
curr_Stock_Price:  99.65406367728258
curr_Factors:  [99.65406368]
mat_Sqrt:  [[0.15]]
grads:  [-0.00472686]
Stock Position:  -0.0047268647166557
Bond Position:  [1.0937211]


portfolio before change:  [0.62072893]
curr_Stock_Price:  100.07913417578823
curr_Factors:  [100.07913418]
mat_Sqrt:  [[0.15]]
grads:  [0.01989458]
Stock Position:  0.019894583832285366
Bond Position:  [-1.37030379]


portfolio before change:  [0.62202086]
curr_Stock_Price:  100.14837788208803
curr_Factors:  [100.14837788]
mat_Sqrt:  [[0.15]]
grads:  [0.14524952]
Stock Position:  0.14524952116042217
Bond Position:  [-13.92448307]


portfolio before change:  [0.62242464]
curr_Stock_Price:  100.15714961693688
curr_Factors:  [100.15714962]
mat_Sqrt:  [[0.15]]
grads:  [0.00484267]
Stock Position:  0.004842671870654685
Bond Position:  [0.13739643]


portfolio before change:  [0.62183503]
curr_Stock_Price:  100.0336233344363
curr_Factors:  [100.03362333]
mat_Sqrt:  [[0.15]]
grads:  [-0.10664075]
Stock Position:  -0.10664074638461664
Bond Position:  [11.28949529]


portfolio before change:  [0.61200856]
curr_Stock_Price:  100.13238569585066
curr_Factors:  [100.1323857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01908088]
Stock Position:  -0.019080882701697593
Bond Position:  [2.52262286]


portfolio before change:  [0.60525129]
curr_Stock_Price:  100.49478718523821
curr_Factors:  [100.49478719]
mat_Sqrt:  [[0.15]]
grads:  [0.00876821]
Stock Position:  0.008768213157570452
Bond Position:  [-0.27590843]


portfolio before change:  [0.60925448]
curr_Stock_Price:  100.95331113886411
curr_Factors:  [100.95331114]
mat_Sqrt:  [[0.15]]
grads:  [0.00010091]
Stock Position:  0.00010091163591878737
Bond Position:  [0.59906711]


portfolio before change:  [0.60931221]
curr_Stock_Price:  101.15435721043072
curr_Factors:  [101.15435721]
mat_Sqrt:  [[0.15]]
grads:  [-0.07827312]
Stock Position:  -0.078273119548223
Bond Position:  [8.5269793]


portfolio before change:  [0.56164106]
curr_Stock_Price:  101.77020216078319
curr_Factors:  [101.77020216]
mat_Sqrt:  [[0.15]]
grads:  [-0.02798869]
Stock Position:  -0.02798869212540642
Bond Position:  [3.41005591]


portfolio before change:  [0.55550891]
curr_Stock_Price:  101.99691098017342
curr_Factors:  [101.99691098]
mat_Sqrt:  [[0.15]]
grads:  [0.10404224]
Stock Position:  0.10404223558140381
Bond Position:  [-10.05647773]


portfolio before change:  [0.52982585]
curr_Stock_Price:  101.75610002883045
curr_Factors:  [101.75610003]
mat_Sqrt:  [[0.15]]
grads:  [-0.05049726]
Stock Position:  -0.05049725901788198
Bond Position:  [5.66822999]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.52263583]
Stock Price:  101.90550017884152
PL:  [-1.38286435]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33370256e-02]
 [-2.49680426e-02]
 [ 1.72603827e-02]
 [-8.55559180e-03]
 [ 1.09539594e-02]
 [-1.35009434e-02]
 [-9.64638348e-03]
 [ 6.76173165e-03]
 [-1.69863237e-02]
 [-1.22777075e-02]
 [ 1.15782923e-02]
 [-7.35355344e-03]
 [ 2.95470619e-03]
 [-2.28740487e-03]
 [ 5.80643902e-04]
 [ 6.59931131e-03]
 [-8.21055639e-03]
 [-1.18853696e-02]
 [ 2.48085490e-02]
 [-4.77637279e-03]
 [-2.75710021e-02]
 [ 6.05619974e-03]
 [ 1.52061978e-02]
 [ 1.40891257e-02]
 [ 4.83502324e-03]
 [ 4.41927049e-03]
 [ 4.66041264e-04]
 [ 1.08474863e-02]
 [ 1.60205777e-02]
 [ 2.49050012e-02]
 [-6.48222852e-03]
 [ 1.42623813e-02]
 [ 1.14789276e-02]
 [-1.57491097e-02]
 [-5.30948066e-04]
 [ 1.91699159e-02]
 [-3.05469859e-03]
 [ 3.16964412e-03]
 [-3.67270597e-02]
 [-1.62604895e-02]
 [ 7.16653508e-03]
 [ 3.11859596e-03]
 [-2.25583657e-03]
 [-1.38587972e-03]
 [ 1.93963186e-02]
 [ 1.54174001e-02]
 [ 1.08998083e-02]
 [ 4.15944690e-03]
 [ 7.25803037e-03]
 [-2.15146913e-03]
 [-3.27861537e-03]
 [-1.16933656e-03]
 [ 1.74909397e-03]
 [ 2.44967285e-03]
 [-4.18018388e-03]
 [-3.58888640e-03]
 [ 1.00835724e-02]
 [-6.73120343e-03]
 [ 6.94757267e-03]
 [-4.02586170e-03]
 [-7.26275702e-04]
 [ 8.00895638e-03]
 [-1.39680771e-02]
 [ 4.78180948e-03]
 [ 2.56840895e-02]
 [ 5.34961994e-03]
 [ 1.44059510e-02]
 [ 5.23862041e-03]
 [ 3.75431464e-03]
 [ 1.95818076e-02]
 [ 4.99654296e-04]
 [-1.57535187e-02]
 [-1.28790117e-03]
 [ 1.30861318e-03]
 [ 2.77176395e-04]
 [-4.12908568e-03]
 [-1.41912828e-03]
 [ 1.24668814e-03]
 [-2.52441080e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.11029756]
curr_Stock_Price:  99.53945248351059
curr_Factors:  [99.53945248]
mat_Sqrt:  [[0.15]]
grads:  [-0.0889135]
Stock Position:  -0.08891350414122294
Bond Position:  [0.74010396]


portfolio before change:  [-8.01379038]
curr_Stock_Price:  98.4545676158408
curr_Factors:  [98.45456762]
mat_Sqrt:  [[0.15]]
grads:  [-0.16645362]
Stock Position:  -0.1664536173445185
Bond Position:  [8.37432854]


portfolio before change:  [-8.14520523]
curr_Stock_Price:  99.24721040841244
curr_Factors:  [99.24721041]
mat_Sqrt:  [[0.15]]
grads:  [0.11506922]
Stock Position:  0.11506921784624853
Bond Position:  [-19.56550411]


portfolio before change:  [-8.12030415]
curr_Stock_Price:  99.47423868021377
curr_Factors:  [99.47423868]
mat_Sqrt:  [[0.15]]
grads:  [-0.05703728]
Stock Position:  -0.05703727864023152
Bond Position:  [-2.44656428]


portfolio before change:  [-8.07807048]
curr_Stock_Price:  98.7311004809845
curr_Factors:  [98.73110048]
mat_Sqrt:  [[0.15]]
grads:  [0.0730264]
Stock Position:  0.07302639620738717
Bond Position:  [-15.28804694]


portfolio before change:  [-8.06001863]
curr_Stock_Price:  98.99138156523742
curr_Factors:  [98.99138157]
mat_Sqrt:  [[0.15]]
grads:  [-0.09000629]
Stock Position:  -0.09000628936072735
Bond Position:  [0.84982831]


portfolio before change:  [-8.04843441]
curr_Stock_Price:  98.86326718024854
curr_Factors:  [98.86326718]
mat_Sqrt:  [[0.15]]
grads:  [-0.06430922]
Stock Position:  -0.06430922323233774
Bond Position:  [-1.69061449]


portfolio before change:  [-8.06826002]
curr_Stock_Price:  99.16990968521132
curr_Factors:  [99.16990969]
mat_Sqrt:  [[0.15]]
grads:  [0.04507821]
Stock Position:  0.045078211023615034
Bond Position:  [-12.53866213]


portfolio before change:  [-8.08108446]
curr_Stock_Price:  98.90280161486162
curr_Factors:  [98.90280161]
mat_Sqrt:  [[0.15]]
grads:  [-0.11324216]
Stock Position:  -0.11324215821940645
Bond Position:  [3.11888225]


portfolio before change:  [-8.09347569]
curr_Stock_Price:  99.01394537733087
curr_Factors:  [99.01394538]
mat_Sqrt:  [[0.15]]
grads:  [-0.08185138]
Stock Position:  -0.08185138355413664
Bond Position:  [0.01095274]


portfolio before change:  [-8.07009649]
curr_Stock_Price:  98.72832390246944
curr_Factors:  [98.7283239]
mat_Sqrt:  [[0.15]]
grads:  [0.07718862]
Stock Position:  0.07718861528006349
Bond Position:  [-15.6907991]


portfolio before change:  [-8.08134314]
curr_Stock_Price:  98.59532565420268
curr_Factors:  [98.59532565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04902369]
Stock Position:  -0.04902368957782035
Bond Position:  [-3.24783651]


portfolio before change:  [-8.05916102]
curr_Stock_Price:  98.13870719643718
curr_Factors:  [98.1387072]
mat_Sqrt:  [[0.15]]
grads:  [0.01969804]
Stock Position:  0.019698041282924413
Bond Position:  [-9.99230132]


portfolio before change:  [-8.05929159]
curr_Stock_Price:  98.1637840167899
curr_Factors:  [98.16378402]
mat_Sqrt:  [[0.15]]
grads:  [-0.01524937]
Stock Position:  -0.01524936579741419
Bond Position:  [-6.56235614]


portfolio before change:  [-8.05054077]
curr_Stock_Price:  97.56303909637464
curr_Factors:  [97.5630391]
mat_Sqrt:  [[0.15]]
grads:  [0.00387096]
Stock Position:  0.0038709593497885295
Bond Position:  [-8.42820333]


portfolio before change:  [-8.0477901]
curr_Stock_Price:  98.40971675690493
curr_Factors:  [98.40971676]
mat_Sqrt:  [[0.15]]
grads:  [0.04399541]
Stock Position:  0.0439954087166066
Bond Position:  [-12.37736581]


portfolio before change:  [-8.05820963]
curr_Stock_Price:  98.190468440831
curr_Factors:  [98.19046844]
mat_Sqrt:  [[0.15]]
grads:  [-0.05473704]
Stock Position:  -0.05473704259952352
Bond Position:  [-2.68355377]


portfolio before change:  [-8.02588613]
curr_Stock_Price:  97.59688085750547
curr_Factors:  [97.59688086]
mat_Sqrt:  [[0.15]]
grads:  [-0.0792358]
Stock Position:  -0.07923579725384287
Bond Position:  [-0.29271946]


portfolio before change:  [-8.0239845]
curr_Stock_Price:  97.57265040854749
curr_Factors:  [97.57265041]
mat_Sqrt:  [[0.15]]
grads:  [0.16539033]
Stock Position:  0.16539032676029441
Bond Position:  [-24.16155704]


portfolio before change:  [-8.2554563]
curr_Stock_Price:  96.18223260496677
curr_Factors:  [96.1822326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03184249]
Stock Position:  -0.03184248524296984
Bond Position:  [-5.19277498]


portfolio before change:  [-8.2443788]
curr_Stock_Price:  95.82415553144463
curr_Factors:  [95.82415553]
mat_Sqrt:  [[0.15]]
grads:  [-0.18380668]
Stock Position:  -0.18380668065969955
Bond Position:  [9.36874116]


portfolio before change:  [-8.29201581]
curr_Stock_Price:  96.08651039148407
curr_Factors:  [96.08651039]
mat_Sqrt:  [[0.15]]
grads:  [0.04037466]
Stock Position:  0.04037466494518869
Bond Position:  [-12.17147647]


portfolio before change:  [-8.30728208]
curr_Stock_Price:  95.72723726546772
curr_Factors:  [95.72723727]
mat_Sqrt:  [[0.15]]
grads:  [0.10137465]
Stock Position:  0.10137465208806191
Bond Position:  [-18.01159745]


portfolio before change:  [-8.23298697]
curr_Stock_Price:  96.4712187931117
curr_Factors:  [96.47121879]
mat_Sqrt:  [[0.15]]
grads:  [0.0939275]
Stock Position:  0.09392750470186984
Bond Position:  [-17.29428783]


portfolio before change:  [-8.18265295]
curr_Stock_Price:  97.0186085194671
curr_Factors:  [97.01860852]
mat_Sqrt:  [[0.15]]
grads:  [0.03223349]
Stock Position:  0.032233488258385894
Bond Position:  [-11.30990113]


portfolio before change:  [-8.18439086]
curr_Stock_Price:  96.9866225245041
curr_Factors:  [96.98662252]
mat_Sqrt:  [[0.15]]
grads:  [0.0294618]
Stock Position:  0.02946180329373948
Bond Position:  [-11.04179165]


portfolio before change:  [-8.18519216]
curr_Stock_Price:  96.98284915279162
curr_Factors:  [96.98284915]
mat_Sqrt:  [[0.15]]
grads:  [0.00310694]
Stock Position:  0.003106941759896803
Bond Position:  [-8.48651223]


portfolio before change:  [-8.18527123]
curr_Stock_Price:  97.12812178222201
curr_Factors:  [97.12812178]
mat_Sqrt:  [[0.15]]
grads:  [0.07231658]
Stock Position:  0.07231657519079102
Bond Position:  [-15.20924435]


portfolio before change:  [-8.14276165]
curr_Stock_Price:  97.729093074287
curr_Factors:  [97.72909307]
mat_Sqrt:  [[0.15]]
grads:  [0.10680385]
Stock Position:  0.10680385139040567
Bond Position:  [-18.58060519]


portfolio before change:  [-8.15358668]
curr_Stock_Price:  97.63861220392157
curr_Factors:  [97.6386122]
mat_Sqrt:  [[0.15]]
grads:  [0.16603334]
Stock Position:  0.16603334103326023
Bond Position:  [-24.36485168]


portfolio before change:  [-8.0891615]
curr_Stock_Price:  98.03580976458345
curr_Factors:  [98.03580976]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321486]
Stock Position:  -0.04321485679193788
Bond Position:  [-3.85255802]


portfolio before change:  [-8.09661704]
curr_Stock_Price:  98.20276037313151
curr_Factors:  [98.20276037]
mat_Sqrt:  [[0.15]]
grads:  [0.09508254]
Stock Position:  0.09508254172518348
Bond Position:  [-17.4339851]


portfolio before change:  [-8.09061112]
curr_Stock_Price:  98.27738573938483
curr_Factors:  [98.27738574]
mat_Sqrt:  [[0.15]]
grads:  [0.07652618]
Stock Position:  0.07652618385989579
Bond Position:  [-15.61140441]


portfolio before change:  [-8.04982602]
curr_Stock_Price:  98.82309242401014
curr_Factors:  [98.82309242]
mat_Sqrt:  [[0.15]]
grads:  [-0.10499406]
Stock Position:  -0.104994064428683
Bond Position:  [2.32601212]


portfolio before change:  [-8.04471466]
curr_Stock_Price:  98.77579471585858
curr_Factors:  [98.77579472]
mat_Sqrt:  [[0.15]]
grads:  [-0.00353965]
Stock Position:  -0.0035396537750841148
Bond Position:  [-7.69508254]


portfolio before change:  [-8.04672264]
curr_Stock_Price:  99.20719931184749
curr_Factors:  [99.20719931]
mat_Sqrt:  [[0.15]]
grads:  [0.12779944]
Stock Position:  0.12779943929150991
Bond Position:  [-20.72534708]


portfolio before change:  [-8.02901047]
curr_Stock_Price:  99.35592876081341
curr_Factors:  [99.35592876]
mat_Sqrt:  [[0.15]]
grads:  [-0.02036466]
Stock Position:  -0.020364657262008236
Bond Position:  [-6.00566104]


portfolio before change:  [-8.03474382]
curr_Stock_Price:  99.61903075656255
curr_Factors:  [99.61903076]
mat_Sqrt:  [[0.15]]
grads:  [0.02113096]
Stock Position:  0.02113096079054645
Bond Position:  [-10.13978965]


portfolio before change:  [-8.0515171]
curr_Stock_Price:  98.8552450770412
curr_Factors:  [98.85524508]
mat_Sqrt:  [[0.15]]
grads:  [-0.24484706]
Stock Position:  -0.24484706434812095
Bond Position:  [16.15289945]


portfolio before change:  [-7.98753188]
curr_Stock_Price:  98.59804111781538
curr_Factors:  [98.59804112]
mat_Sqrt:  [[0.15]]
grads:  [-0.10840326]
Stock Position:  -0.10840326333738486
Bond Position:  [2.70081753]


portfolio before change:  [-7.98964164]
curr_Stock_Price:  98.61906044098329
curr_Factors:  [98.61906044]
mat_Sqrt:  [[0.15]]
grads:  [0.0477769]
Stock Position:  0.047776900548174475
Bond Position:  [-12.70135468]


portfolio before change:  [-7.95574858]
curr_Stock_Price:  99.3450789861564
curr_Factors:  [99.34507899]
mat_Sqrt:  [[0.15]]
grads:  [0.02079064]
Stock Position:  0.02079063970985296
Bond Position:  [-10.02119633]


portfolio before change:  [-7.9652729]
curr_Stock_Price:  98.91709929026462
curr_Factors:  [98.91709929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01503891]
Stock Position:  -0.01503891045496455
Bond Position:  [-6.4776675]


portfolio before change:  [-7.97066697]
curr_Stock_Price:  99.24885249365478
curr_Factors:  [99.24885249]
mat_Sqrt:  [[0.15]]
grads:  [-0.0092392]
Stock Position:  -0.009239198151310454
Bond Position:  [-7.05368716]


portfolio before change:  [-7.97407142]
curr_Stock_Price:  99.56961454470213
curr_Factors:  [99.56961454]
mat_Sqrt:  [[0.15]]
grads:  [0.12930879]
Stock Position:  0.12930879053676886
Bond Position:  [-20.84929786]


portfolio before change:  [-7.97093944]
curr_Stock_Price:  99.60391311112156
curr_Factors:  [99.60391311]
mat_Sqrt:  [[0.15]]
grads:  [0.10278267]
Stock Position:  0.1027826672601361
Bond Position:  [-18.2084953]


portfolio before change:  [-7.89918681]
curr_Stock_Price:  100.31308612354407
curr_Factors:  [100.31308612]
mat_Sqrt:  [[0.15]]
grads:  [0.07266539]
Stock Position:  0.0726653886602266
Bond Position:  [-15.1884762]


portfolio before change:  [-7.92227812]
curr_Stock_Price:  100.00837439607899
curr_Factors:  [100.0083744]
mat_Sqrt:  [[0.15]]
grads:  [0.02772965]
Stock Position:  0.027729646006288834
Bond Position:  [-10.69547494]


portfolio before change:  [-7.93105342]
curr_Stock_Price:  99.71602246318207
curr_Factors:  [99.71602246]
mat_Sqrt:  [[0.15]]
grads:  [0.04838687]
Stock Position:  0.04838686913125204
Bond Position:  [-12.75599955]


portfolio before change:  [-7.92326805]
curr_Stock_Price:  99.89339805808237
curr_Factors:  [99.89339806]
mat_Sqrt:  [[0.15]]
grads:  [-0.01434313]
Stock Position:  -0.014343127505804104
Bond Position:  [-6.4904843]


portfolio before change:  [-7.92223439]
curr_Stock_Price:  99.79304875001779
curr_Factors:  [99.79304875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02185744]
Stock Position:  -0.0218574357950845
Bond Position:  [-5.74101424]


portfolio before change:  [-7.90432092]
curr_Stock_Price:  98.95707267194092
curr_Factors:  [98.95707267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779558]
Stock Position:  -0.007795577068967312
Bond Position:  [-7.13289344]


portfolio before change:  [-7.90800805]
curr_Stock_Price:  99.37286040845872
curr_Factors:  [99.37286041]
mat_Sqrt:  [[0.15]]
grads:  [0.01166063]
Stock Position:  0.01166062647374297
Bond Position:  [-9.06675786]


portfolio before change:  [-7.90123793]
curr_Stock_Price:  100.00205583808146
curr_Factors:  [100.00205584]
mat_Sqrt:  [[0.15]]
grads:  [0.01633115]
Stock Position:  0.016331152309500517
Bond Position:  [-9.53438673]


portfolio before change:  [-7.89625733]
curr_Stock_Price:  100.34352068995918
curr_Factors:  [100.34352069]
mat_Sqrt:  [[0.15]]
grads:  [-0.02786789]
Stock Position:  -0.027867892533993625
Bond Position:  [-5.09989488]


portfolio before change:  [-7.92038003]
curr_Stock_Price:  101.19769175846618
curr_Factors:  [101.19769176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02392591]
Stock Position:  -0.023925909336826395
Bond Position:  [-5.49913323]


portfolio before change:  [-7.92432436]
curr_Stock_Price:  101.3481821156217
curr_Factors:  [101.34818212]
mat_Sqrt:  [[0.15]]
grads:  [0.06722382]
Stock Position:  0.06722381605170911
Bond Position:  [-14.73733591]


portfolio before change:  [-7.88051321]
curr_Stock_Price:  102.01360480722744
curr_Factors:  [102.01360481]
mat_Sqrt:  [[0.15]]
grads:  [-0.04487469]
Stock Position:  -0.044874689520177674
Bond Position:  [-3.30268437]


portfolio before change:  [-7.82713831]
curr_Stock_Price:  100.81958365058314
curr_Factors:  [100.81958365]
mat_Sqrt:  [[0.15]]
grads:  [0.04631715]
Stock Position:  0.046317151127170914
Bond Position:  [-12.4968142]


portfolio before change:  [-7.84479237]
curr_Stock_Price:  100.45529127214687
curr_Factors:  [100.45529127]
mat_Sqrt:  [[0.15]]
grads:  [-0.02683908]
Stock Position:  -0.026839077999341484
Bond Position:  [-5.14866497]


portfolio before change:  [-7.84581677]
curr_Stock_Price:  100.48146929589403
curr_Factors:  [100.4814693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00484184]
Stock Position:  -0.004841838016147101
Bond Position:  [-7.35930177]


portfolio before change:  [-7.85179915]
curr_Stock_Price:  101.62202987560045
curr_Factors:  [101.62202988]
mat_Sqrt:  [[0.15]]
grads:  [0.05339304]
Stock Position:  0.053393042530101416
Bond Position:  [-13.27770851]


portfolio before change:  [-7.84653499]
curr_Stock_Price:  101.7361653267254
curr_Factors:  [101.73616533]
mat_Sqrt:  [[0.15]]
grads:  [-0.09312051]
Stock Position:  -0.09312051374832894
Bond Position:  [1.62718899]


portfolio before change:  [-7.87255164]
curr_Stock_Price:  102.01664438112601
curr_Factors:  [102.01664438]
mat_Sqrt:  [[0.15]]
grads:  [0.03187873]
Stock Position:  0.03187872984741155
Bond Position:  [-11.12471269]


portfolio before change:  [-7.87663528]
curr_Stock_Price:  101.91035658580792
curr_Factors:  [101.91035659]
mat_Sqrt:  [[0.15]]
grads:  [0.17122726]
Stock Position:  0.17122726309179048
Bond Position:  [-25.32646672]


portfolio before change:  [-7.90659539]
curr_Stock_Price:  101.74462855660308
curr_Factors:  [101.74462856]
mat_Sqrt:  [[0.15]]
grads:  [0.03566413]
Stock Position:  0.03566413294443983
Bond Position:  [-11.53522935]


portfolio before change:  [-7.8948676]
curr_Stock_Price:  102.09368412190858
curr_Factors:  [102.09368412]
mat_Sqrt:  [[0.15]]
grads:  [0.09603967]
Stock Position:  0.0960396733952808
Bond Position:  [-17.69991168]


portfolio before change:  [-7.90080543]
curr_Stock_Price:  102.04337625084462
curr_Factors:  [102.04337625]
mat_Sqrt:  [[0.15]]
grads:  [0.03492414]
Stock Position:  0.03492413605277872
Bond Position:  [-11.46458218]


portfolio before change:  [-7.89922461]
curr_Stock_Price:  102.10915832438654
curr_Factors:  [102.10915832]
mat_Sqrt:  [[0.15]]
grads:  [0.02502876]
Stock Position:  0.025028764237653083
Bond Position:  [-10.45489066]


portfolio before change:  [-7.9082007]
curr_Stock_Price:  101.77663530050619
curr_Factors:  [101.7766353]
mat_Sqrt:  [[0.15]]
grads:  [0.13054538]
Stock Position:  0.13054538376885136
Bond Position:  [-21.19467061]


portfolio before change:  [-7.95753068]
curr_Stock_Price:  101.40890666547752
curr_Factors:  [101.40890667]
mat_Sqrt:  [[0.15]]
grads:  [0.00333103]
Stock Position:  0.0033310286431522335
Bond Position:  [-8.29532665]


portfolio before change:  [-7.95743394]
curr_Stock_Price:  101.59359914194427
curr_Factors:  [101.59359914]
mat_Sqrt:  [[0.15]]
grads:  [-0.10502346]
Stock Position:  -0.10502345793872525
Bond Position:  [2.71227715]


portfolio before change:  [-7.84983459]
curr_Stock_Price:  100.57068642839312
curr_Factors:  [100.57068643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858601]
Stock Position:  -0.008586007833332304
Bond Position:  [-6.98633389]


portfolio before change:  [-7.84913233]
curr_Stock_Price:  100.43803834824152
curr_Factors:  [100.43803835]
mat_Sqrt:  [[0.15]]
grads:  [0.00872409]
Stock Position:  0.008724087871203936
Bond Position:  [-8.7253626]


portfolio before change:  [-7.85386809]
curr_Stock_Price:  99.95771248042941
curr_Factors:  [99.95771248]
mat_Sqrt:  [[0.15]]
grads:  [0.00184784]
Stock Position:  0.0018478426324933703
Bond Position:  [-8.03857421]


portfolio before change:  [-7.85440345]
curr_Stock_Price:  99.93988782352757
curr_Factors:  [99.93988782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02752724]
Stock Position:  -0.02752723785418586
Bond Position:  [-5.10333439]


portfolio before change:  [-7.82586968]
curr_Stock_Price:  98.89173540034163
curr_Factors:  [98.8917354]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946086]
Stock Position:  -0.009460855176957514
Bond Position:  [-6.89026929]


portfolio before change:  [-7.82418823]
curr_Stock_Price:  98.6684885630259
curr_Factors:  [98.66848856]
mat_Sqrt:  [[0.15]]
grads:  [0.00831125]
Stock Position:  0.008311254297439195
Bond Position:  [-8.64424713]


portfolio before change:  [-7.8187142]
curr_Stock_Price:  99.39212270179269
curr_Factors:  [99.3921227]
mat_Sqrt:  [[0.15]]
grads:  [-0.16829405]
Stock Position:  -0.1682940533451878
Bond Position:  [8.908389]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.70315765]
Stock Price:  98.70879637748493
PL:  [-7.70315765]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40382504e-02]
 [ 1.07350389e-02]
 [ 2.69374267e-03]
 [-9.03295183e-03]
 [-1.03329127e-03]
 [-6.06336892e-03]
 [-8.30925309e-03]
 [-2.76073022e-02]
 [-1.07681669e-02]
 [-6.90217178e-03]
 [ 1.46070335e-02]
 [-5.39441407e-03]
 [-1.26236622e-03]
 [ 3.53046127e-03]
 [-1.24460621e-03]
 [ 2.46345938e-03]
 [-2.43106258e-02]
 [-1.13814088e-02]
 [ 2.48248413e-02]
 [-3.67905646e-03]
 [-2.00226748e-02]
 [ 5.80097498e-03]
 [ 1.40314399e-02]
 [ 1.62193756e-02]
 [ 7.41319371e-03]
 [ 4.43430991e-03]
 [ 4.00140803e-04]
 [ 1.30861894e-02]
 [-1.72979183e-02]
 [ 7.83859788e-02]
 [-6.51241713e-03]
 [ 2.08786843e-02]
 [ 1.18930022e-02]
 [-2.01873646e-02]
 [-5.08490863e-03]
 [ 1.30321654e-02]
 [ 8.43944948e-03]
 [-1.59609956e-03]
 [ 6.41570012e-03]
 [ 4.80420222e-04]
 [ 6.86264646e-03]
 [ 3.48679049e-02]
 [-3.37107107e-03]
 [ 1.36951523e-02]
 [-3.92360154e-02]
 [ 2.15204458e-02]
 [ 9.71726953e-03]
 [ 5.31383663e-03]
 [-8.29208554e-03]
 [-1.96648966e-04]
 [-3.56654614e-03]
 [-1.54673771e-03]
 [ 4.58684034e-04]
 [ 6.81668639e-03]
 [-9.75406505e-03]
 [-4.58511218e-03]
 [-6.12323170e-04]
 [ 1.06472218e-02]
 [ 7.40733888e-03]
 [-4.01130506e-03]
 [-3.48277258e-04]
 [ 4.52520312e-03]
 [-7.85743707e-03]
 [ 7.58454657e-03]
 [ 2.39446984e-02]
 [ 5.56314249e-03]
 [ 8.41863498e-03]
 [-1.44213945e-03]
 [ 2.94756258e-03]
 [ 2.16214069e-02]
 [ 7.13500812e-04]
 [-1.59677374e-02]
 [-1.00130694e-03]
 [ 1.32102948e-03]
 [-3.70611947e-05]
 [-7.42577354e-03]
 [-3.95206075e-03]
 [ 3.51145470e-03]
 [-2.47582250e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.94088242]
curr_Stock_Price:  99.77423672526226
curr_Factors:  [99.77423673]
mat_Sqrt:  [[0.15]]
grads:  [-0.09358834]
Stock Position:  -0.09358833627686469
Bond Position:  [6.3968224]


portfolio before change:  [-2.96135112]
curr_Stock_Price:  99.99721865029953
curr_Factors:  [99.99721865]
mat_Sqrt:  [[0.15]]
grads:  [0.07156693]
Stock Position:  0.07156692607297606
Bond Position:  [-10.11784467]


portfolio before change:  [-2.96839424]
curr_Stock_Price:  99.90764184987225
curr_Factors:  [99.90764185]
mat_Sqrt:  [[0.15]]
grads:  [0.01795828]
Stock Position:  0.017958284495955594
Bond Position:  [-4.76256409]


portfolio before change:  [-2.97131585]
curr_Stock_Price:  99.76152859495777
curr_Factors:  [99.76152859]
mat_Sqrt:  [[0.15]]
grads:  [-0.06021968]
Stock Position:  -0.06021967887137413
Bond Position:  [3.03629137]


portfolio before change:  [-3.01901632]
curr_Stock_Price:  100.55678759643635
curr_Factors:  [100.5567876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00688861]
Stock Position:  -0.006888608440251005
Bond Position:  [-2.32631998]


portfolio before change:  [-3.01529051]
curr_Stock_Price:  99.99481507498697
curr_Factors:  [99.99481507]
mat_Sqrt:  [[0.15]]
grads:  [-0.04042246]
Stock Position:  -0.040422459499645104
Bond Position:  [1.02674585]


portfolio before change:  [-3.04667669]
curr_Stock_Price:  100.77285678894114
curr_Factors:  [100.77285679]
mat_Sqrt:  [[0.15]]
grads:  [-0.05539502]
Stock Position:  -0.05539502063241273
Bond Position:  [2.53563779]


portfolio before change:  [-3.05698158]
curr_Stock_Price:  100.96174317625334
curr_Factors:  [100.96174318]
mat_Sqrt:  [[0.15]]
grads:  [-0.18404868]
Stock Position:  -0.18404868166613253
Bond Position:  [15.52489415]


portfolio before change:  [-2.81092722]
curr_Stock_Price:  99.6301170865722
curr_Factors:  [99.63011709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07178778]
Stock Position:  -0.07178777956836731
Bond Position:  [4.34129767]


portfolio before change:  [-2.80574013]
curr_Stock_Price:  99.5616409865314
curr_Factors:  [99.56164099]
mat_Sqrt:  [[0.15]]
grads:  [-0.04601448]
Stock Position:  -0.04601447855571287
Bond Position:  [1.77553687]


portfolio before change:  [-2.80982886]
curr_Stock_Price:  99.65291019739439
curr_Factors:  [99.6529102]
mat_Sqrt:  [[0.15]]
grads:  [0.09738022]
Stock Position:  0.09738022353537151
Bond Position:  [-12.51405153]


portfolio before change:  [-2.81404868]
curr_Stock_Price:  99.61760866661635
curr_Factors:  [99.61760867]
mat_Sqrt:  [[0.15]]
grads:  [-0.03596276]
Stock Position:  -0.035962760450587786
Bond Position:  [0.76847551]


portfolio before change:  [-2.81719797]
curr_Stock_Price:  99.70651494641669
curr_Factors:  [99.70651495]
mat_Sqrt:  [[0.15]]
grads:  [-0.00841577]
Stock Position:  -0.00841577478740119
Bond Position:  [-1.97809039]


portfolio before change:  [-2.81030719]
curr_Stock_Price:  98.8730311907573
curr_Factors:  [98.87303119]
mat_Sqrt:  [[0.15]]
grads:  [0.02353641]
Stock Position:  0.023536408483996147
Bond Position:  [-5.13742324]


portfolio before change:  [-2.83417216]
curr_Stock_Price:  97.87271400976996
curr_Factors:  [97.87271401]
mat_Sqrt:  [[0.15]]
grads:  [-0.00829737]
Stock Position:  -0.008297374736506331
Bond Position:  [-2.02208558]


portfolio before change:  [-2.82934892]
curr_Stock_Price:  97.27618522216457
curr_Factors:  [97.27618522]
mat_Sqrt:  [[0.15]]
grads:  [0.01642306]
Stock Position:  0.016423062506922284
Bond Position:  [-4.42692179]


portfolio before change:  [-2.82418784]
curr_Stock_Price:  97.60729109372922
curr_Factors:  [97.60729109]
mat_Sqrt:  [[0.15]]
grads:  [-0.16207084]
Stock Position:  -0.16207083889376125
Bond Position:  [12.99510771]


portfolio before change:  [-2.76824878]
curr_Stock_Price:  97.2671506629145
curr_Factors:  [97.26715066]
mat_Sqrt:  [[0.15]]
grads:  [-0.07587606]
Stock Position:  -0.07587605859058189
Bond Position:  [4.61199924]


portfolio before change:  [-2.79749763]
curr_Stock_Price:  97.65643175028323
curr_Factors:  [97.65643175]
mat_Sqrt:  [[0.15]]
grads:  [0.16549894]
Stock Position:  0.1654989418253523
Bond Position:  [-18.95953375]


portfolio before change:  [-2.9295572]
curr_Stock_Price:  96.86564388643728
curr_Factors:  [96.86564389]
mat_Sqrt:  [[0.15]]
grads:  [-0.02452704]
Stock Position:  -0.024527043090420732
Bond Position:  [-0.55372937]


portfolio before change:  [-2.92725004]
curr_Stock_Price:  96.77016699934728
curr_Factors:  [96.770167]
mat_Sqrt:  [[0.15]]
grads:  [-0.1334845]
Stock Position:  -0.13348449858919262
Bond Position:  [9.99006718]


portfolio before change:  [-2.93543934]
curr_Stock_Price:  96.83619489273121
curr_Factors:  [96.83619489]
mat_Sqrt:  [[0.15]]
grads:  [0.03867317]
Stock Position:  0.03867316651270106
Bond Position:  [-6.68040163]


portfolio before change:  [-2.95247996]
curr_Stock_Price:  96.40635985303815
curr_Factors:  [96.40635985]
mat_Sqrt:  [[0.15]]
grads:  [0.09354293]
Stock Position:  0.09354293246107655
Bond Position:  [-11.97061357]


portfolio before change:  [-2.91773403]
curr_Stock_Price:  96.7858018865481
curr_Factors:  [96.78580189]
mat_Sqrt:  [[0.15]]
grads:  [0.10812917]
Stock Position:  0.1081291704682128
Bond Position:  [-13.3831025]


portfolio before change:  [-2.93583557]
curr_Stock_Price:  96.62613111049443
curr_Factors:  [96.62613111]
mat_Sqrt:  [[0.15]]
grads:  [0.04942129]
Stock Position:  0.049421291419062194
Bond Position:  [-7.71122375]


portfolio before change:  [-2.93375814]
curr_Stock_Price:  96.67791836660851
curr_Factors:  [96.67791837]
mat_Sqrt:  [[0.15]]
grads:  [0.02956207]
Stock Position:  0.02956206609169705
Bond Position:  [-5.79175715]


portfolio before change:  [-2.93294616]
curr_Stock_Price:  96.71763055300285
curr_Factors:  [96.71763055]
mat_Sqrt:  [[0.15]]
grads:  [0.00266761]
Stock Position:  0.0026676053544111636
Bond Position:  [-3.19095063]


portfolio before change:  [-2.93332012]
curr_Stock_Price:  96.6522102130349
curr_Factors:  [96.65221021]
mat_Sqrt:  [[0.15]]
grads:  [0.08724126]
Stock Position:  0.08724126298313048
Bond Position:  [-11.36538101]


portfolio before change:  [-2.99976275]
curr_Stock_Price:  95.89875630641455
curr_Factors:  [95.89875631]
mat_Sqrt:  [[0.15]]
grads:  [-0.11531946]
Stock Position:  -0.11531945520702502
Bond Position:  [8.05922959]


portfolio before change:  [-2.91877744]
curr_Stock_Price:  95.20085503976713
curr_Factors:  [95.20085504]
mat_Sqrt:  [[0.15]]
grads:  [0.52257319]
Stock Position:  0.5225731922908887
Bond Position:  [-52.66819216]


portfolio before change:  [-2.56458407]
curr_Stock_Price:  95.8849414644682
curr_Factors:  [95.88494146]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341611]
Stock Position:  -0.043416114216315485
Bond Position:  [1.5983675]


portfolio before change:  [-2.59742195]
curr_Stock_Price:  96.6435947705081
curr_Factors:  [96.64359477]
mat_Sqrt:  [[0.15]]
grads:  [0.13919123]
Stock Position:  0.13919122849557997
Bond Position:  [-16.04936263]


portfolio before change:  [-2.51358259]
curr_Stock_Price:  97.25313373021105
curr_Factors:  [97.25313373]
mat_Sqrt:  [[0.15]]
grads:  [0.07928668]
Stock Position:  0.07928668147968941
Bond Position:  [-10.22446083]


portfolio before change:  [-2.50922488]
curr_Stock_Price:  97.31615510307206
curr_Factors:  [97.3161551]
mat_Sqrt:  [[0.15]]
grads:  [-0.13458243]
Stock Position:  -0.13458243037664425
Bond Position:  [10.58781978]


portfolio before change:  [-2.60739982]
curr_Stock_Price:  98.05055030127882
curr_Factors:  [98.0505503]
mat_Sqrt:  [[0.15]]
grads:  [-0.03389939]
Stock Position:  -0.03389939089381631
Bond Position:  [0.71645412]


portfolio before change:  [-2.58531622]
curr_Stock_Price:  97.40042609543544
curr_Factors:  [97.4004261]
mat_Sqrt:  [[0.15]]
grads:  [0.0868811]
Stock Position:  0.08688110259456375
Bond Position:  [-11.04757263]


portfolio before change:  [-2.64639374]
curr_Stock_Price:  96.7053725024562
curr_Factors:  [96.7053725]
mat_Sqrt:  [[0.15]]
grads:  [0.056263]
Stock Position:  0.05626299652607594
Bond Position:  [-8.08732778]


portfolio before change:  [-2.63953004]
curr_Stock_Price:  96.83634971001018
curr_Factors:  [96.83634971]
mat_Sqrt:  [[0.15]]
grads:  [-0.01064066]
Stock Position:  -0.01064066372212678
Bond Position:  [-1.60912701]


portfolio before change:  [-2.63641843]
curr_Stock_Price:  96.53447170601568
curr_Factors:  [96.53447171]
mat_Sqrt:  [[0.15]]
grads:  [0.04277133]
Stock Position:  0.0427713341329686
Bond Position:  [-6.76532658]


portfolio before change:  [-2.65567032]
curr_Stock_Price:  96.09424611915611
curr_Factors:  [96.09424612]
mat_Sqrt:  [[0.15]]
grads:  [0.0032028]
Stock Position:  0.0032028014774246097
Bond Position:  [-2.96344111]


portfolio before change:  [-2.65656185]
curr_Stock_Price:  95.87371560250118
curr_Factors:  [95.8737156]
mat_Sqrt:  [[0.15]]
grads:  [0.04575098]
Stock Position:  0.04575097639990383
Bond Position:  [-7.04287795]


portfolio before change:  [-2.63563454]
curr_Stock_Price:  96.34075497987601
curr_Factors:  [96.34075498]
mat_Sqrt:  [[0.15]]
grads:  [0.2324527]
Stock Position:  0.23245269956831915
Bond Position:  [-25.03030311]


portfolio before change:  [-2.71852226]
curr_Stock_Price:  95.99090627221207
curr_Factors:  [95.99090627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247381]
Stock Position:  -0.02247380714955926
Bond Position:  [-0.56124114]


portfolio before change:  [-2.72268293]
curr_Stock_Price:  96.1744798691907
curr_Factors:  [96.17447987]
mat_Sqrt:  [[0.15]]
grads:  [0.09130102]
Stock Position:  0.09130101516875896
Bond Position:  [-11.50351058]


portfolio before change:  [-2.72376532]
curr_Stock_Price:  96.17049970306644
curr_Factors:  [96.1704997]
mat_Sqrt:  [[0.15]]
grads:  [-0.26157344]
Stock Position:  -0.26157343614699385
Bond Position:  [22.43188275]


portfolio before change:  [-2.66852083]
curr_Stock_Price:  95.96465904927541
curr_Factors:  [95.96465905]
mat_Sqrt:  [[0.15]]
grads:  [0.14346964]
Stock Position:  0.14346963844001628
Bond Position:  [-16.43653577]


portfolio before change:  [-2.56577576]
curr_Stock_Price:  96.68796460056164
curr_Factors:  [96.6879646]
mat_Sqrt:  [[0.15]]
grads:  [0.0647818]
Stock Position:  0.0647817968797319
Bond Position:  [-8.82939585]


portfolio before change:  [-2.55055762]
curr_Stock_Price:  96.93139723360125
curr_Factors:  [96.93139723]
mat_Sqrt:  [[0.15]]
grads:  [0.03542558]
Stock Position:  0.03542557751884648
Bond Position:  [-5.98440834]


portfolio before change:  [-2.58004249]
curr_Stock_Price:  96.10965100561171
curr_Factors:  [96.10965101]
mat_Sqrt:  [[0.15]]
grads:  [-0.05528057]
Stock Position:  -0.055280570240636456
Bond Position:  [2.73295383]


portfolio before change:  [-2.60244222]
curr_Stock_Price:  96.51794177288264
curr_Factors:  [96.51794177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131099]
Stock Position:  -0.0013109931067222548
Bond Position:  [-2.47590786]


portfolio before change:  [-2.60242918]
curr_Stock_Price:  96.38995631277663
curr_Factors:  [96.38995631]
mat_Sqrt:  [[0.15]]
grads:  [-0.02377697]
Stock Position:  -0.023776974266401706
Bond Position:  [-0.31056767]


portfolio before change:  [-2.59782224]
curr_Stock_Price:  96.19538376578348
curr_Factors:  [96.19538377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01031158]
Stock Position:  -0.010311584723973484
Bond Position:  [-1.60589539]


portfolio before change:  [-2.60452011]
curr_Stock_Price:  96.83519779548188
curr_Factors:  [96.8351978]
mat_Sqrt:  [[0.15]]
grads:  [0.00305789]
Stock Position:  0.003057893562104059
Bond Position:  [-2.90063184]


portfolio before change:  [-2.60364975]
curr_Stock_Price:  97.17911441439958
curr_Factors:  [97.17911441]
mat_Sqrt:  [[0.15]]
grads:  [0.04544458]
Stock Position:  0.045444575965638376
Bond Position:  [-7.01991339]


portfolio before change:  [-2.60923828]
curr_Stock_Price:  97.06579445755204
curr_Factors:  [97.06579446]
mat_Sqrt:  [[0.15]]
grads:  [-0.0650271]
Stock Position:  -0.0650271003330873
Bond Position:  [3.70266887]


portfolio before change:  [-2.66523063]
curr_Stock_Price:  97.93041512258468
curr_Factors:  [97.93041512]
mat_Sqrt:  [[0.15]]
grads:  [-0.03056741]
Stock Position:  -0.03056741452306796
Bond Position:  [0.32824896]


portfolio before change:  [-2.65813154]
curr_Stock_Price:  97.69884258514043
curr_Factors:  [97.69884259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00408215]
Stock Position:  -0.00408215446569344
Bond Position:  [-2.25930978]


portfolio before change:  [-2.66114785]
curr_Stock_Price:  98.40314994194796
curr_Factors:  [98.40314994]
mat_Sqrt:  [[0.15]]
grads:  [0.07098148]
Stock Position:  0.07098147893896656
Bond Position:  [-9.64594896]


portfolio before change:  [-2.59975283]
curr_Stock_Price:  99.27658769217663
curr_Factors:  [99.27658769]
mat_Sqrt:  [[0.15]]
grads:  [0.04938226]
Stock Position:  0.04938225920365891
Bond Position:  [-7.50225502]


portfolio before change:  [-2.58859755]
curr_Stock_Price:  99.51197972233825
curr_Factors:  [99.51197972]
mat_Sqrt:  [[0.15]]
grads:  [-0.02674203]
Stock Position:  -0.02674203371330803
Bond Position:  [0.07255517]


portfolio before change:  [-2.60441086]
curr_Stock_Price:  100.10347707902626
curr_Factors:  [100.10347708]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232185]
Stock Position:  -0.0023218483843863323
Bond Position:  [-2.37198576]


portfolio before change:  [-2.6040087]
curr_Stock_Price:  99.86641918581024
curr_Factors:  [99.86641919]
mat_Sqrt:  [[0.15]]
grads:  [0.03016802]
Stock Position:  0.030168020787710362
Bond Position:  [-5.61678091]


portfolio before change:  [-2.59796125]
curr_Stock_Price:  100.07851500673554
curr_Factors:  [100.07851501]
mat_Sqrt:  [[0.15]]
grads:  [-0.05238291]
Stock Position:  -0.05238291377902961
Bond Position:  [2.64444298]


portfolio before change:  [-2.60576633]
curr_Stock_Price:  100.23067094138692
curr_Factors:  [100.23067094]
mat_Sqrt:  [[0.15]]
grads:  [0.05056364]
Stock Position:  0.050563643820067596
Bond Position:  [-7.67379428]


portfolio before change:  [-2.60654379]
curr_Stock_Price:  100.2247808169989
curr_Factors:  [100.22478082]
mat_Sqrt:  [[0.15]]
grads:  [0.15963132]
Stock Position:  0.15963132298232777
Bond Position:  [-18.60555815]


portfolio before change:  [-2.48672378]
curr_Stock_Price:  100.98267026713154
curr_Factors:  [100.98267027]
mat_Sqrt:  [[0.15]]
grads:  [0.03708762]
Stock Position:  0.03708761660737558
Bond Position:  [-6.23193034]


portfolio before change:  [-2.50726397]
curr_Stock_Price:  100.43934383771638
curr_Factors:  [100.43934384]
mat_Sqrt:  [[0.15]]
grads:  [0.05612423]
Stock Position:  0.056124233225095486
Bond Position:  [-8.14434512]


portfolio before change:  [-2.51498084]
curr_Stock_Price:  100.31091742548958
curr_Factors:  [100.31091743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00961426]
Stock Position:  -0.00961426298745905
Bond Position:  [-1.5505653]


portfolio before change:  [-2.51341878]
curr_Stock_Price:  100.13836384518176
curr_Factors:  [100.13836385]
mat_Sqrt:  [[0.15]]
grads:  [0.01965042]
Stock Position:  0.01965041719839606
Bond Position:  [-4.4811794]


portfolio before change:  [-2.52703539]
curr_Stock_Price:  99.45967449212047
curr_Factors:  [99.45967449]
mat_Sqrt:  [[0.15]]
grads:  [0.14414271]
Stock Position:  0.14414271295731
Bond Position:  [-16.8634227]


portfolio before change:  [-2.42636362]
curr_Stock_Price:  100.16540401012881
curr_Factors:  [100.16540401]
mat_Sqrt:  [[0.15]]
grads:  [0.00475667]
Stock Position:  0.004756672077068722
Bond Position:  [-2.9028176]


portfolio before change:  [-2.4247769]
curr_Stock_Price:  100.53712352765783
curr_Factors:  [100.53712353]
mat_Sqrt:  [[0.15]]
grads:  [-0.10645158]
Stock Position:  -0.10645158238567806
Bond Position:  [8.27755899]


portfolio before change:  [-2.43674559]
curr_Stock_Price:  100.65441683438573
curr_Factors:  [100.65441683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667538]
Stock Position:  -0.006675379607359358
Bond Position:  [-1.76483915]


portfolio before change:  [-2.43612213]
curr_Stock_Price:  100.54449435558811
curr_Factors:  [100.54449436]
mat_Sqrt:  [[0.15]]
grads:  [0.00880686]
Stock Position:  0.00880686316772461
Bond Position:  [-3.32160373]


portfolio before change:  [-2.43975368]
curr_Stock_Price:  100.15571276403655
curr_Factors:  [100.15571276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00024707]
Stock Position:  -0.00024707463127959567
Bond Position:  [-2.41500774]


portfolio before change:  [-2.4399815]
curr_Stock_Price:  100.46684470925265
curr_Factors:  [100.46684471]
mat_Sqrt:  [[0.15]]
grads:  [-0.04950516]
Stock Position:  -0.04950515690894343
Bond Position:  [2.53364542]


portfolio before change:  [-2.4134757]
curr_Stock_Price:  99.93462868179665
curr_Factors:  [99.93462868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02634707]
Stock Position:  -0.026347071640152247
Bond Position:  [0.21950912]


portfolio before change:  [-2.38691804]
curr_Stock_Price:  98.92715653087167
curr_Factors:  [98.92715653]
mat_Sqrt:  [[0.15]]
grads:  [0.0234097]
Stock Position:  0.02340969803312909
Bond Position:  [-4.7027729]


portfolio before change:  [-2.37045864]
curr_Stock_Price:  99.64281424281144
curr_Factors:  [99.64281424]
mat_Sqrt:  [[0.15]]
grads:  [-0.16505483]
Stock Position:  -0.1650548333781203
Bond Position:  [14.07606946]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.31056143]
Stock Price:  99.28525170805165
PL:  [-2.31056143]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.72609125e-03]
 [ 1.70687840e-02]
 [ 1.84924731e-02]
 [-2.08288374e-02]
 [-1.16998544e-02]
 [-1.27039394e-03]
 [ 8.78672731e-03]
 [-5.95068504e-02]
 [ 1.73370776e-02]
 [-7.37142876e-03]
 [-1.28372725e-02]
 [ 2.21609662e-02]
 [-5.67615566e-03]
 [ 5.49757176e-03]
 [ 1.67974246e-02]
 [ 8.01847167e-03]
 [ 8.05876678e-02]
 [-8.02936210e-03]
 [ 2.47737580e-02]
 [-2.23467181e-04]
 [-6.29737589e-03]
 [ 6.82749753e-03]
 [ 1.69339095e-03]
 [ 4.41617383e-02]
 [ 4.26265129e-03]
 [ 6.23154354e-03]
 [ 7.16945375e-02]
 [ 3.23339458e-02]
 [-4.70819358e-03]
 [-8.83108778e-03]
 [ 4.62489083e-03]
 [ 1.57873850e-02]
 [ 1.63365591e-02]
 [-9.52517199e-03]
 [ 4.36576289e-03]
 [-1.11579868e-02]
 [-9.87564382e-03]
 [-1.02380122e-02]
 [-1.39555201e-02]
 [-1.51000842e-02]
 [ 3.69579050e-03]
 [ 8.35840655e-03]
 [-1.22039319e-02]
 [ 1.33948983e-02]
 [-8.69985045e-03]
 [ 1.18316734e-02]
 [ 1.04280642e-02]
 [-3.26639344e-03]
 [ 1.58125732e-02]
 [-1.61774678e-03]
 [ 1.73455050e-02]
 [ 2.83485359e-02]
 [-9.07964953e-03]
 [-7.48681147e-02]
 [-2.71827409e-02]
 [-1.68294704e-03]
 [-8.68194941e-03]
 [-1.43931770e-02]
 [-2.12600817e-03]
 [-2.89598048e-03]
 [-7.55862589e-03]
 [-3.82690919e-03]
 [-1.75729231e-02]
 [ 2.37806435e-04]
 [ 5.26143240e-03]
 [ 2.50977032e-02]
 [-2.84198063e-04]
 [ 1.80605902e-02]
 [ 8.63134181e-03]
 [ 1.14237235e-02]
 [ 7.23728320e-03]
 [-1.46881264e-02]
 [-4.35492526e-02]
 [ 6.15064728e-04]
 [-5.90830492e-03]
 [-2.66252118e-02]
 [-6.08309346e-03]
 [ 2.04682748e-02]
 [ 7.22362909e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.83713203]
curr_Stock_Price:  100.62709566009632
curr_Factors:  [100.62709566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150728]
Stock Position:  -0.03150727502514669
Bond Position:  [19.00761761]


portfolio before change:  [15.84872721]
curr_Stock_Price:  100.29678549967831
curr_Factors:  [100.2967855]
mat_Sqrt:  [[0.15]]
grads:  [0.11379189]
Stock Position:  0.11379189341050096
Bond Position:  [4.43576609]


portfolio before change:  [15.97186374]
curr_Stock_Price:  101.37646943391576
curr_Factors:  [101.37646943]
mat_Sqrt:  [[0.15]]
grads:  [0.12328315]
Stock Position:  0.12328315367553011
Bond Position:  [3.47385288]


portfolio before change:  [15.91290598]
curr_Stock_Price:  100.89647780613218
curr_Factors:  [100.89647781]
mat_Sqrt:  [[0.15]]
grads:  [-0.13885892]
Stock Position:  -0.13885891574862552
Bond Position:  [29.92328149]


portfolio before change:  [15.92586347]
curr_Stock_Price:  100.81663253968283
curr_Factors:  [100.81663254]
mat_Sqrt:  [[0.15]]
grads:  [-0.07799903]
Stock Position:  -0.07799902914744845
Bond Position:  [23.78946293]


portfolio before change:  [15.86102515]
curr_Stock_Price:  101.66696623854894
curr_Factors:  [101.66696624]
mat_Sqrt:  [[0.15]]
grads:  [-0.00846929]
Stock Position:  -0.008469292910864476
Bond Position:  [16.72207247]


portfolio before change:  [15.85850985]
curr_Stock_Price:  102.08736361736864
curr_Factors:  [102.08736362]
mat_Sqrt:  [[0.15]]
grads:  [0.05857818]
Stock Position:  0.05857818207493481
Bond Position:  [9.87841767]


portfolio before change:  [15.91129789]
curr_Stock_Price:  102.97797879508262
curr_Factors:  [102.9779788]
mat_Sqrt:  [[0.15]]
grads:  [-0.39671234]
Stock Position:  -0.3967123360464171
Bond Position:  [56.76393242]


portfolio before change:  [16.05092072]
curr_Stock_Price:  102.63497212993904
curr_Factors:  [102.63497213]
mat_Sqrt:  [[0.15]]
grads:  [0.11558052]
Stock Position:  0.1155805175565094
Bond Position:  [4.18831752]


portfolio before change:  [16.03845634]
curr_Stock_Price:  102.52486574878093
curr_Factors:  [102.52486575]
mat_Sqrt:  [[0.15]]
grads:  [-0.04914286]
Stock Position:  -0.04914285837354207
Bond Position:  [21.0768213]


portfolio before change:  [15.99825625]
curr_Stock_Price:  103.36969729746384
curr_Factors:  [103.3696973]
mat_Sqrt:  [[0.15]]
grads:  [-0.08558182]
Stock Position:  -0.08558181699945433
Bond Position:  [24.84482277]


portfolio before change:  [15.98330146]
curr_Stock_Price:  103.56258454544191
curr_Factors:  [103.56258455]
mat_Sqrt:  [[0.15]]
grads:  [0.14773977]
Stock Position:  0.14773977486153153
Bond Position:  [0.68298853]


portfolio before change:  [16.02396457]
curr_Stock_Price:  103.83753032832544
curr_Factors:  [103.83753033]
mat_Sqrt:  [[0.15]]
grads:  [-0.03784104]
Stock Position:  -0.03784103771481459
Bond Position:  [19.95328448]


portfolio before change:  [16.04552548]
curr_Stock_Price:  103.30071133276371
curr_Factors:  [103.30071133]
mat_Sqrt:  [[0.15]]
grads:  [0.03665048]
Stock Position:  0.0366504783870706
Bond Position:  [12.25950499]


portfolio before change:  [16.06958876]
curr_Stock_Price:  103.93636556874185
curr_Factors:  [103.93636557]
mat_Sqrt:  [[0.15]]
grads:  [0.11198283]
Stock Position:  0.11198283090066319
Bond Position:  [4.43050031]


portfolio before change:  [16.06719479]
curr_Stock_Price:  103.91251479274403
curr_Factors:  [103.91251479]
mat_Sqrt:  [[0.15]]
grads:  [0.05345648]
Stock Position:  0.05345647780625393
Bond Position:  [10.51239775]


portfolio before change:  [16.11661693]
curr_Stock_Price:  104.82475394990759
curr_Factors:  [104.82475395]
mat_Sqrt:  [[0.15]]
grads:  [0.53725112]
Stock Position:  0.5372511183560809
Bond Position:  [-40.20059936]


portfolio before change:  [15.9483151]
curr_Stock_Price:  104.5161660167432
curr_Factors:  [104.51616602]
mat_Sqrt:  [[0.15]]
grads:  [-0.05352908]
Stock Position:  -0.05352908066730237
Bond Position:  [21.54296938]


portfolio before change:  [15.9929687]
curr_Stock_Price:  103.7071269450027
curr_Factors:  [103.70712695]
mat_Sqrt:  [[0.15]]
grads:  [0.16515839]
Stock Position:  0.16515838695769014
Bond Position:  [-1.1351331]


portfolio before change:  [15.96217779]
curr_Stock_Price:  103.5211238927677
curr_Factors:  [103.52112389]
mat_Sqrt:  [[0.15]]
grads:  [-0.00148978]
Stock Position:  -0.0014897812079479654
Bond Position:  [16.11640161]


portfolio before change:  [15.96413564]
curr_Stock_Price:  102.88308215743
curr_Factors:  [102.88308216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04198251]
Stock Position:  -0.04198250593432666
Bond Position:  [20.28342524]


portfolio before change:  [15.92017781]
curr_Stock_Price:  103.9603304615039
curr_Factors:  [103.96033046]
mat_Sqrt:  [[0.15]]
grads:  [0.04551665]
Stock Position:  0.04551665021025701
Bond Position:  [11.18825181]


portfolio before change:  [15.90368586]
curr_Stock_Price:  103.58263944812751
curr_Factors:  [103.58263945]
mat_Sqrt:  [[0.15]]
grads:  [0.01128927]
Stock Position:  0.011289273021769623
Bond Position:  [14.73431317]


portfolio before change:  [15.90205818]
curr_Stock_Price:  103.35688469681614
curr_Factors:  [103.3568847]
mat_Sqrt:  [[0.15]]
grads:  [0.29441159]
Stock Position:  0.29441158849264265
Bond Position:  [-14.52740642]


portfolio before change:  [16.01438026]
curr_Stock_Price:  103.74148257630526
curr_Factors:  [103.74148258]
mat_Sqrt:  [[0.15]]
grads:  [0.02841768]
Stock Position:  0.028417675272472676
Bond Position:  [13.0662885]


portfolio before change:  [16.03971206]
curr_Stock_Price:  104.60415445628286
curr_Factors:  [104.60415446]
mat_Sqrt:  [[0.15]]
grads:  [0.04154362]
Stock Position:  0.0415436236141
Bond Position:  [11.69407644]


portfolio before change:  [16.04320965]
curr_Stock_Price:  104.6707516896064
curr_Factors:  [104.67075169]
mat_Sqrt:  [[0.15]]
grads:  [0.47796358]
Stock Position:  0.4779635834896488
Bond Position:  [-33.98559791]


portfolio before change:  [16.12233101]
curr_Stock_Price:  104.84073436280565
curr_Factors:  [104.84073436]
mat_Sqrt:  [[0.15]]
grads:  [0.21555964]
Stock Position:  0.2155596383806883
Bond Position:  [-6.47709977]


portfolio before change:  [16.25353612]
curr_Stock_Price:  105.45128438385625
curr_Factors:  [105.45128438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138796]
Stock Position:  -0.03138795720636973
Bond Position:  [19.56343653]


portfolio before change:  [16.27124912]
curr_Stock_Price:  104.92591596195602
curr_Factors:  [104.92591596]
mat_Sqrt:  [[0.15]]
grads:  [-0.05887392]
Stock Position:  -0.058873918519719015
Bond Position:  [22.44864895]


portfolio before change:  [16.30032624]
curr_Stock_Price:  104.4558599731211
curr_Factors:  [104.45585997]
mat_Sqrt:  [[0.15]]
grads:  [0.03083261]
Stock Position:  0.03083260550225446
Bond Position:  [13.07967992]


portfolio before change:  [16.31912511]
curr_Stock_Price:  105.0390531248505
curr_Factors:  [105.03905312]
mat_Sqrt:  [[0.15]]
grads:  [0.10524923]
Stock Position:  0.10524923320727816
Bond Position:  [5.26384531]


portfolio before change:  [16.32301374]
curr_Stock_Price:  105.07287408741082
curr_Factors:  [105.07287409]
mat_Sqrt:  [[0.15]]
grads:  [0.10891039]
Stock Position:  0.10891039394708665
Bond Position:  [4.87948563]


portfolio before change:  [16.31530329]
curr_Stock_Price:  104.99927756624977
curr_Factors:  [104.99927757]
mat_Sqrt:  [[0.15]]
grads:  [-0.06350115]
Stock Position:  -0.06350114661480445
Bond Position:  [22.98287781]


portfolio before change:  [16.35848331]
curr_Stock_Price:  104.3419108684382
curr_Factors:  [104.34191087]
mat_Sqrt:  [[0.15]]
grads:  [0.02910509]
Stock Position:  0.029105085958586453
Bond Position:  [13.32160302]


portfolio before change:  [16.37617391]
curr_Stock_Price:  104.92112153429365
curr_Factors:  [104.92112153]
mat_Sqrt:  [[0.15]]
grads:  [-0.07438658]
Stock Position:  -0.07438657842891881
Bond Position:  [24.18089715]


portfolio before change:  [16.4196934]
curr_Stock_Price:  104.35639412794951
curr_Factors:  [104.35639413]
mat_Sqrt:  [[0.15]]
grads:  [-0.06583763]
Stock Position:  -0.06583762545572747
Bond Position:  [23.29027059]


portfolio before change:  [16.44426286]
curr_Stock_Price:  104.0053217091868
curr_Factors:  [104.00532171]
mat_Sqrt:  [[0.15]]
grads:  [-0.06825341]
Stock Position:  -0.06825341481700656
Bond Position:  [23.54298123]


portfolio before change:  [16.46850037]
curr_Stock_Price:  103.6717703260525
curr_Factors:  [103.67177033]
mat_Sqrt:  [[0.15]]
grads:  [-0.0930368]
Stock Position:  -0.09303680039569412
Bond Position:  [26.11379017]


portfolio before change:  [16.52957681]
curr_Stock_Price:  103.03283731631274
curr_Factors:  [103.03283732]
mat_Sqrt:  [[0.15]]
grads:  [-0.10066723]
Stock Position:  -0.10066722810257825
Bond Position:  [26.90160695]


portfolio before change:  [16.48778536]
curr_Stock_Price:  103.46468443945778
curr_Factors:  [103.46468444]
mat_Sqrt:  [[0.15]]
grads:  [0.0246386]
Stock Position:  0.02463860333830953
Bond Position:  [13.93856004]


portfolio before change:  [16.49265041]
curr_Stock_Price:  103.62678189436926
curr_Factors:  [103.62678189]
mat_Sqrt:  [[0.15]]
grads:  [0.05572271]
Stock Position:  0.055722710321573075
Bond Position:  [10.71828526]


portfolio before change:  [16.53053219]
curr_Stock_Price:  104.29458626267106
curr_Factors:  [104.29458626]
mat_Sqrt:  [[0.15]]
grads:  [-0.08135955]
Stock Position:  -0.08135954617503677
Bond Position:  [25.0158924]


portfolio before change:  [16.46880766]
curr_Stock_Price:  105.07246755193165
curr_Factors:  [105.07246755]
mat_Sqrt:  [[0.15]]
grads:  [0.08929932]
Stock Position:  0.08929932201730671
Bond Position:  [7.08590755]


portfolio before change:  [16.58230682]
curr_Stock_Price:  106.33850488608138
curr_Factors:  [106.33850489]
mat_Sqrt:  [[0.15]]
grads:  [-0.057999]
Stock Position:  -0.05799900298811977
Bond Position:  [22.74983408]


portfolio before change:  [16.54727391]
curr_Stock_Price:  106.96704701960395
curr_Factors:  [106.96704702]
mat_Sqrt:  [[0.15]]
grads:  [0.07887782]
Stock Position:  0.07887782238568065
Bond Position:  [8.10994618]


portfolio before change:  [16.54387672]
curr_Stock_Price:  106.91755172416053
curr_Factors:  [106.91755172]
mat_Sqrt:  [[0.15]]
grads:  [0.06952043]
Stock Position:  0.06952042805385601
Bond Position:  [9.11092276]


portfolio before change:  [16.49454729]
curr_Stock_Price:  106.1997931793471
curr_Factors:  [106.19979318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02177596]
Stock Position:  -0.02177595626641184
Bond Position:  [18.80714934]


portfolio before change:  [16.46472284]
curr_Stock_Price:  107.62337840901777
curr_Factors:  [107.62337841]
mat_Sqrt:  [[0.15]]
grads:  [0.10541715]
Stock Position:  0.10541715453628517
Bond Position:  [5.11937253]


portfolio before change:  [16.49073881]
curr_Stock_Price:  107.86713381017661
curr_Factors:  [107.86713381]
mat_Sqrt:  [[0.15]]
grads:  [-0.01078498]
Stock Position:  -0.01078497854829324
Bond Position:  [17.65408354]


portfolio before change:  [16.48796768]
curr_Stock_Price:  108.22638798641626
curr_Factors:  [108.22638799]
mat_Sqrt:  [[0.15]]
grads:  [0.1156367]
Stock Position:  0.1156367000398984
Bond Position:  [3.97302532]


portfolio before change:  [16.41630314]
curr_Stock_Price:  107.60450185112549
curr_Factors:  [107.60450185]
mat_Sqrt:  [[0.15]]
grads:  [0.18899024]
Stock Position:  0.1889902396029403
Bond Position:  [-3.91989745]


portfolio before change:  [16.41138319]
curr_Stock_Price:  107.579765372948
curr_Factors:  [107.57976537]
mat_Sqrt:  [[0.15]]
grads:  [-0.060531]
Stock Position:  -0.060530996859081004
Bond Position:  [22.92329363]


portfolio before change:  [16.38877705]
curr_Stock_Price:  107.97689896872065
curr_Factors:  [107.97689897]
mat_Sqrt:  [[0.15]]
grads:  [-0.49912076]
Stock Position:  -0.49912076459359767
Bond Position:  [70.28228942]


portfolio before change:  [16.14065239]
curr_Stock_Price:  108.48282350109635
curr_Factors:  [108.4828235]
mat_Sqrt:  [[0.15]]
grads:  [-0.18121827]
Stock Position:  -0.1812182723429681
Bond Position:  [35.79972224]


portfolio before change:  [16.11274193]
curr_Stock_Price:  108.64918646134522
curr_Factors:  [108.64918646]
mat_Sqrt:  [[0.15]]
grads:  [-0.01121965]
Stock Position:  -0.011219646919728241
Bond Position:  [17.33174744]


portfolio before change:  [16.11366688]
curr_Stock_Price:  108.66329756846565
curr_Factors:  [108.66329757]
mat_Sqrt:  [[0.15]]
grads:  [-0.05787966]
Stock Position:  -0.057879662744367684
Bond Position:  [22.40306189]


portfolio before change:  [16.09515187]
curr_Stock_Price:  109.00737773791026
curr_Factors:  [109.00737774]
mat_Sqrt:  [[0.15]]
grads:  [-0.09595451]
Stock Position:  -0.09595451314372071
Bond Position:  [26.55490173]


portfolio before change:  [16.09649013]
curr_Stock_Price:  109.01072800238971
curr_Factors:  [109.010728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01417339]
Stock Position:  -0.014173387830235732
Bond Position:  [17.64154145]


portfolio before change:  [16.10636457]
curr_Stock_Price:  108.39183497677
curr_Factors:  [108.39183498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01930654]
Stock Position:  -0.019306536529021572
Bond Position:  [18.19903549]


portfolio before change:  [16.12289852]
curr_Stock_Price:  107.59436004338279
curr_Factors:  [107.59436004]
mat_Sqrt:  [[0.15]]
grads:  [-0.05039084]
Stock Position:  -0.05039083928435258
Bond Position:  [21.54466863]


portfolio before change:  [16.13163162]
curr_Stock_Price:  107.44777554776213
curr_Factors:  [107.44777555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551273]
Stock Position:  -0.025512727955540958
Bond Position:  [18.87291749]


portfolio before change:  [16.14427955]
curr_Stock_Price:  106.99826130087764
curr_Factors:  [106.9982613]
mat_Sqrt:  [[0.15]]
grads:  [-0.11715282]
Stock Position:  -0.11715282056307674
Bond Position:  [28.67942766]


portfolio before change:  [16.23965198]
curr_Stock_Price:  106.19947637935518
curr_Factors:  [106.19947638]
mat_Sqrt:  [[0.15]]
grads:  [0.00158538]
Stock Position:  0.0015853762304672812
Bond Position:  [16.07128585]


portfolio before change:  [16.24037695]
curr_Stock_Price:  106.02316989676827
curr_Factors:  [106.0231699]
mat_Sqrt:  [[0.15]]
grads:  [0.03507622]
Stock Position:  0.0350762159994028
Bond Position:  [12.52148535]


portfolio before change:  [16.27985844]
curr_Stock_Price:  107.1264493410457
curr_Factors:  [107.12644934]
mat_Sqrt:  [[0.15]]
grads:  [0.16731802]
Stock Position:  0.1673180215238124
Bond Position:  [-1.64432712]


portfolio before change:  [16.22460216]
curr_Stock_Price:  106.79681656218911
curr_Factors:  [106.79681656]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189465]
Stock Position:  -0.0018946537537367694
Bond Position:  [16.42694515]


portfolio before change:  [16.22513518]
curr_Stock_Price:  107.05738975288483
curr_Factors:  [107.05738975]
mat_Sqrt:  [[0.15]]
grads:  [0.12040393]
Stock Position:  0.12040393485770694
Bond Position:  [3.3350042]


portfolio before change:  [16.26531153]
curr_Stock_Price:  107.38933824166281
curr_Factors:  [107.38933824]
mat_Sqrt:  [[0.15]]
grads:  [0.05754228]
Stock Position:  0.05754227875384522
Bond Position:  [10.08588429]


portfolio before change:  [16.24361752]
curr_Stock_Price:  107.00137304568734
curr_Factors:  [107.00137305]
mat_Sqrt:  [[0.15]]
grads:  [0.07615816]
Stock Position:  0.0761581568875024
Bond Position:  [8.09459016]


portfolio before change:  [16.30447284]
curr_Stock_Price:  107.7937950008441
curr_Factors:  [107.793795]
mat_Sqrt:  [[0.15]]
grads:  [0.04824855]
Stock Position:  0.04824855468212173
Bond Position:  [11.10357803]


portfolio before change:  [16.28062337]
curr_Stock_Price:  107.28510683935326
curr_Factors:  [107.28510684]
mat_Sqrt:  [[0.15]]
grads:  [-0.09792084]
Stock Position:  -0.09792084266158332
Bond Position:  [26.78607143]


portfolio before change:  [16.23584081]
curr_Stock_Price:  107.75953834849331
curr_Factors:  [107.75953835]
mat_Sqrt:  [[0.15]]
grads:  [-0.29032835]
Stock Position:  -0.2903283505912354
Bond Position:  [47.52148984]


portfolio before change:  [16.4215981]
curr_Stock_Price:  107.12995084649845
curr_Factors:  [107.12995085]
mat_Sqrt:  [[0.15]]
grads:  [0.00410043]
Stock Position:  0.004100431521914308
Bond Position:  [15.98231907]


portfolio before change:  [16.42174583]
curr_Stock_Price:  106.9223632529714
curr_Factors:  [106.92236325]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393887]
Stock Position:  -0.03938869945368262
Bond Position:  [20.63327866]


portfolio before change:  [16.39774649]
curr_Stock_Price:  107.56439912928771
curr_Factors:  [107.56439913]
mat_Sqrt:  [[0.15]]
grads:  [-0.17750141]
Stock Position:  -0.17750141177633902
Bond Position:  [35.49057919]


portfolio before change:  [16.27302484]
curr_Stock_Price:  108.27954770319141
curr_Factors:  [108.2795477]
mat_Sqrt:  [[0.15]]
grads:  [-0.04055396]
Stock Position:  -0.040553956394799744
Bond Position:  [20.6641889]


portfolio before change:  [16.27450354]
curr_Stock_Price:  108.27493303847729
curr_Factors:  [108.27493304]
mat_Sqrt:  [[0.15]]
grads:  [0.13645517]
Stock Position:  0.13645516515701012
Bond Position:  [1.49982966]


portfolio before change:  [16.35163064]
curr_Stock_Price:  108.83946543812795
curr_Factors:  [108.83946544]
mat_Sqrt:  [[0.15]]
grads:  [0.48157527]
Stock Position:  0.481575272999484
Bond Position:  [-36.06276464]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.14654907]
Stock Price:  108.41829020927894
PL:  [7.72825886]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.24119729e-02]
 [-1.18775255e-02]
 [ 2.78022330e-03]
 [-1.41758446e-02]
 [ 1.28171556e-02]
 [-1.10427293e-02]
 [-4.23956686e-03]
 [-5.70736111e-04]
 [-6.47218308e-03]
 [-1.40483715e-03]
 [ 8.24752360e-03]
 [ 9.83326028e-04]
 [-2.67812818e-03]
 [ 7.68615006e-03]
 [-1.01543996e-03]
 [ 1.12734321e-02]
 [ 2.57316918e-02]
 [-1.47266178e-02]
 [ 2.04449976e-02]
 [ 1.31093179e-03]
 [-4.39134501e-03]
 [ 4.86729473e-03]
 [ 1.89658476e-02]
 [ 1.78120709e-02]
 [-5.89402436e-03]
 [ 4.57264019e-03]
 [-5.40189999e-04]
 [ 8.37590191e-03]
 [ 1.65160259e-02]
 [ 1.88224452e-03]
 [-6.43683300e-03]
 [ 1.40556486e-02]
 [ 1.15007349e-02]
 [-2.04500883e-02]
 [-9.28100680e-03]
 [ 1.81051478e-02]
 [ 2.19568415e-03]
 [ 2.47994181e-03]
 [-3.27616786e-02]
 [-1.60484221e-02]
 [ 7.16881160e-03]
 [ 2.67711943e-02]
 [-3.08937398e-03]
 [ 4.85082078e-03]
 [-1.03648068e-02]
 [ 1.65455776e-02]
 [ 9.82906447e-03]
 [ 5.32900729e-03]
 [-8.24180546e-03]
 [-3.82151482e-05]
 [-3.67481624e-03]
 [-7.26602769e-04]
 [ 6.52636657e-04]
 [ 7.61017230e-03]
 [-1.02656776e-02]
 [-4.83181078e-03]
 [-1.40560079e-03]
 [ 1.32855168e-02]
 [ 7.00365145e-03]
 [-2.76884948e-03]
 [-5.11737985e-03]
 [-2.72270880e-03]
 [-6.04610093e-04]
 [-5.34461213e-03]
 [ 1.73294871e-02]
 [ 9.42107743e-03]
 [ 2.04783110e-02]
 [-5.29967329e-03]
 [ 8.24954102e-03]
 [ 2.88973262e-02]
 [ 3.08506031e-03]
 [-1.52338321e-02]
 [-5.76267371e-03]
 [ 2.51181281e-03]
 [ 1.13581890e-02]
 [ 8.33100482e-03]
 [ 2.56463343e-06]
 [-1.44276541e-02]
 [-3.15701647e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.06096431]
curr_Stock_Price:  99.13293154210271
curr_Factors:  [99.13293154]
mat_Sqrt:  [[0.15]]
grads:  [-0.08274649]
Stock Position:  -0.08274648617015211
Bond Position:  [-8.85806256]


portfolio before change:  [-17.06872006]
curr_Stock_Price:  99.21996971400242
curr_Factors:  [99.21996971]
mat_Sqrt:  [[0.15]]
grads:  [-0.0791835]
Stock Position:  -0.07918350350289441
Bond Position:  [-9.21213524]


portfolio before change:  [-17.13223798]
curr_Stock_Price:  100.01485935879403
curr_Factors:  [100.01485936]
mat_Sqrt:  [[0.15]]
grads:  [0.01853482]
Stock Position:  0.018534821969668908
Bond Position:  [-18.98599559]


portfolio before change:  [-17.12284114]
curr_Stock_Price:  100.5858660458589
curr_Factors:  [100.58586605]
mat_Sqrt:  [[0.15]]
grads:  [-0.09450563]
Stock Position:  -0.09450563064815286
Bond Position:  [-7.61691043]


portfolio before change:  [-17.07636794]
curr_Stock_Price:  100.08907804844749
curr_Factors:  [100.08907805]
mat_Sqrt:  [[0.15]]
grads:  [0.0854477]
Stock Position:  0.08544770419840017
Bond Position:  [-25.62874988]


portfolio before change:  [-17.12546848]
curr_Stock_Price:  99.53319779791941
curr_Factors:  [99.5331978]
mat_Sqrt:  [[0.15]]
grads:  [-0.0736182]
Stock Position:  -0.07361819525146379
Bond Position:  [-9.79801409]


portfolio before change:  [-17.10006002]
curr_Stock_Price:  99.17974088299565
curr_Factors:  [99.17974088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02826378]
Stock Position:  -0.02826377905627281
Bond Position:  [-14.29686573]


portfolio before change:  [-17.10729386]
curr_Stock_Price:  99.40406565183788
curr_Factors:  [99.40406565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00380491]
Stock Position:  -0.0038049074037652354
Bond Position:  [-16.7290706]


portfolio before change:  [-17.11053529]
curr_Stock_Price:  99.98117005508666
curr_Factors:  [99.98117006]
mat_Sqrt:  [[0.15]]
grads:  [-0.04314789]
Stock Position:  -0.043147887230255075
Bond Position:  [-12.79655904]


portfolio before change:  [-17.11657642]
curr_Stock_Price:  100.10264344306242
curr_Factors:  [100.10264344]
mat_Sqrt:  [[0.15]]
grads:  [-0.00936558]
Stock Position:  -0.009365580997910222
Bond Position:  [-16.17905701]


portfolio before change:  [-17.11967546]
curr_Stock_Price:  100.32556709768895
curr_Factors:  [100.3255671]
mat_Sqrt:  [[0.15]]
grads:  [0.05498349]
Stock Position:  0.05498349069276323
Bond Position:  [-22.63592534]


portfolio before change:  [-17.10453856]
curr_Stock_Price:  100.62659711631461
curr_Factors:  [100.62659712]
mat_Sqrt:  [[0.15]]
grads:  [0.00655551]
Stock Position:  0.006555506853150086
Bond Position:  [-17.76419691]


portfolio before change:  [-17.10653203]
curr_Stock_Price:  100.49187536214316
curr_Factors:  [100.49187536]
mat_Sqrt:  [[0.15]]
grads:  [-0.01785419]
Stock Position:  -0.017854187850422875
Bond Position:  [-15.31233121]


portfolio before change:  [-17.10799194]
curr_Stock_Price:  100.5200399440073
curr_Factors:  [100.52003994]
mat_Sqrt:  [[0.15]]
grads:  [0.051241]
Stock Position:  0.05124100038282994
Bond Position:  [-22.25873934]


portfolio before change:  [-17.13369483]
curr_Stock_Price:  100.04558231076727
curr_Factors:  [100.04558231]
mat_Sqrt:  [[0.15]]
grads:  [-0.0067696]
Stock Position:  -0.006769599701238807
Bond Position:  [-16.45642629]


portfolio before change:  [-17.129689]
curr_Stock_Price:  99.30190550898486
curr_Factors:  [99.30190551]
mat_Sqrt:  [[0.15]]
grads:  [0.07515621]
Stock Position:  0.07515621382491966
Bond Position:  [-24.59284424]


portfolio before change:  [-17.11599703]
curr_Stock_Price:  99.50453776310097
curr_Factors:  [99.50453776]
mat_Sqrt:  [[0.15]]
grads:  [0.17154461]
Stock Position:  0.17154461231283163
Bond Position:  [-34.18546438]


portfolio before change:  [-17.00703485]
curr_Stock_Price:  100.15217589879558
curr_Factors:  [100.1521759]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817745]
Stock Position:  -0.0981774518876968
Bond Position:  [-7.17434942]


portfolio before change:  [-16.96380624]
curr_Stock_Price:  99.7072975888436
curr_Factors:  [99.70729759]
mat_Sqrt:  [[0.15]]
grads:  [0.13629998]
Stock Position:  0.13629998378280048
Bond Position:  [-30.55390929]


portfolio before change:  [-17.03842409]
curr_Stock_Price:  99.17385538056881
curr_Factors:  [99.17385538]
mat_Sqrt:  [[0.15]]
grads:  [0.00873955]
Stock Position:  0.008739545280447257
Bond Position:  [-17.90515849]


portfolio before change:  [-17.04043025]
curr_Stock_Price:  99.07235652710996
curr_Factors:  [99.07235653]
mat_Sqrt:  [[0.15]]
grads:  [-0.02927563]
Stock Position:  -0.029275633368354814
Bond Position:  [-14.14002426]


portfolio before change:  [-17.05149652]
curr_Stock_Price:  99.42017127187444
curr_Factors:  [99.42017127]
mat_Sqrt:  [[0.15]]
grads:  [0.03244863]
Stock Position:  0.03244863153975531
Bond Position:  [-20.27754503]


portfolio before change:  [-17.05762606]
curr_Stock_Price:  99.27032978399814
curr_Factors:  [99.27032978]
mat_Sqrt:  [[0.15]]
grads:  [0.12643898]
Stock Position:  0.1264389838193682
Bond Position:  [-29.60926568]


portfolio before change:  [-17.0482412]
curr_Stock_Price:  99.35919078693645
curr_Factors:  [99.35919079]
mat_Sqrt:  [[0.15]]
grads:  [0.11874714]
Stock Position:  0.118747139148129
Bond Position:  [-28.84686086]


portfolio before change:  [-17.01112704]
curr_Stock_Price:  99.6869220350256
curr_Factors:  [99.68692204]
mat_Sqrt:  [[0.15]]
grads:  [-0.0392935]
Stock Position:  -0.03929349574557469
Bond Position:  [-13.09407939]


portfolio before change:  [-17.0171276]
curr_Stock_Price:  99.81880524746208
curr_Factors:  [99.81880525]
mat_Sqrt:  [[0.15]]
grads:  [0.03048427]
Stock Position:  0.030484267960747838
Bond Position:  [-20.06003081]


portfolio before change:  [-17.00682905]
curr_Stock_Price:  100.19776588896052
curr_Factors:  [100.19776589]
mat_Sqrt:  [[0.15]]
grads:  [-0.00360127]
Stock Position:  -0.0036012666582175535
Bond Position:  [-16.64599018]


portfolio before change:  [-17.00654069]
curr_Stock_Price:  99.82879166905389
curr_Factors:  [99.82879167]
mat_Sqrt:  [[0.15]]
grads:  [0.05583935]
Stock Position:  0.055839346033720344
Bond Position:  [-22.58091513]


portfolio before change:  [-17.02973808]
curr_Stock_Price:  99.43863593866025
curr_Factors:  [99.43863594]
mat_Sqrt:  [[0.15]]
grads:  [0.11010684]
Stock Position:  0.11010683937248966
Bond Position:  [-27.97861199]


portfolio before change:  [-17.03169582]
curr_Stock_Price:  99.43673757946405
curr_Factors:  [99.43673758]
mat_Sqrt:  [[0.15]]
grads:  [0.0125483]
Stock Position:  0.012548296778738834
Bond Position:  [-18.27945751]


portfolio before change:  [-17.0428518]
curr_Stock_Price:  98.63874223350352
curr_Factors:  [98.63874223]
mat_Sqrt:  [[0.15]]
grads:  [-0.04291222]
Stock Position:  -0.042912219966728005
Bond Position:  [-12.8100444]


portfolio before change:  [-17.02740017]
curr_Stock_Price:  98.26000906464685
curr_Factors:  [98.26000906]
mat_Sqrt:  [[0.15]]
grads:  [0.09370432]
Stock Position:  0.0937043236696303
Bond Position:  [-26.23478787]


portfolio before change:  [-16.9926401]
curr_Stock_Price:  98.64846289328494
curr_Factors:  [98.64846289]
mat_Sqrt:  [[0.15]]
grads:  [0.07667157]
Stock Position:  0.07667156622796037
Bond Position:  [-24.55617225]


portfolio before change:  [-17.05705522]
curr_Stock_Price:  97.82833726283818
curr_Factors:  [97.82833726]
mat_Sqrt:  [[0.15]]
grads:  [-0.13633392]
Stock Position:  -0.13633392222393048
Bond Position:  [-3.7197343]


portfolio before change:  [-16.97989649]
curr_Stock_Price:  97.26067793380516
curr_Factors:  [97.26067793]
mat_Sqrt:  [[0.15]]
grads:  [-0.06187338]
Stock Position:  -0.06187337867503455
Bond Position:  [-10.96204973]


portfolio before change:  [-17.01283235]
curr_Stock_Price:  97.78191520464753
curr_Factors:  [97.7819152]
mat_Sqrt:  [[0.15]]
grads:  [0.12070099]
Stock Position:  0.12070098524206825
Bond Position:  [-28.81520585]


portfolio before change:  [-16.86318963]
curr_Stock_Price:  99.03661687997041
curr_Factors:  [99.03661688]
mat_Sqrt:  [[0.15]]
grads:  [0.01463789]
Stock Position:  0.014637894353824692
Bond Position:  [-18.31287716]


portfolio before change:  [-16.86484792]
curr_Stock_Price:  99.00152317152289
curr_Factors:  [99.00152317]
mat_Sqrt:  [[0.15]]
grads:  [0.01653295]
Stock Position:  0.016532945395674438
Bond Position:  [-18.50163469]


portfolio before change:  [-16.87425881]
curr_Stock_Price:  98.50224679441453
curr_Factors:  [98.50224679]
mat_Sqrt:  [[0.15]]
grads:  [-0.21841119]
Stock Position:  -0.21841119088324257
Bond Position:  [4.63973421]


portfolio before change:  [-16.90168377]
curr_Stock_Price:  98.62914023025063
curr_Factors:  [98.62914023]
mat_Sqrt:  [[0.15]]
grads:  [-0.10698948]
Stock Position:  -0.10698948068380482
Bond Position:  [-6.34940327]


portfolio before change:  [-16.90652206]
curr_Stock_Price:  98.67065308511417
curr_Factors:  [98.67065309]
mat_Sqrt:  [[0.15]]
grads:  [0.04779208]
Stock Position:  0.047792077356228285
Bond Position:  [-21.62219754]


portfolio before change:  [-16.93718012]
curr_Stock_Price:  98.05744193837744
curr_Factors:  [98.05744194]
mat_Sqrt:  [[0.15]]
grads:  [0.17847463]
Stock Position:  0.1784746287616041
Bond Position:  [-34.43794567]


portfolio before change:  [-17.02378571]
curr_Stock_Price:  97.58424777349158
curr_Factors:  [97.58424777]
mat_Sqrt:  [[0.15]]
grads:  [-0.02059583]
Stock Position:  -0.020595826513823825
Bond Position:  [-15.01395747]


portfolio before change:  [-17.0181893]
curr_Stock_Price:  97.2669595525723
curr_Factors:  [97.26695955]
mat_Sqrt:  [[0.15]]
grads:  [0.03233881]
Stock Position:  0.03233880521584865
Bond Position:  [-20.16368656]


portfolio before change:  [-17.00311929]
curr_Stock_Price:  97.7719344126046
curr_Factors:  [97.77193441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06909871]
Stock Position:  -0.06909871175045289
Bond Position:  [-10.24720457]


portfolio before change:  [-17.0143886]
curr_Stock_Price:  97.92575550150423
curr_Factors:  [97.9257555]
mat_Sqrt:  [[0.15]]
grads:  [0.11030385]
Stock Position:  0.11030385082678831
Bond Position:  [-27.81597652]


portfolio before change:  [-17.11984739]
curr_Stock_Price:  96.98544163305428
curr_Factors:  [96.98544163]
mat_Sqrt:  [[0.15]]
grads:  [0.0655271]
Stock Position:  0.06552709647037501
Bond Position:  [-23.47502178]


portfolio before change:  [-17.14854372]
curr_Stock_Price:  96.56990209654197
curr_Factors:  [96.5699021]
mat_Sqrt:  [[0.15]]
grads:  [0.03552672]
Stock Position:  0.035526715299892084
Bond Position:  [-20.57935514]


portfolio before change:  [-17.16279719]
curr_Stock_Price:  96.20490304703063
curr_Factors:  [96.20490305]
mat_Sqrt:  [[0.15]]
grads:  [-0.05494537]
Stock Position:  -0.05494536975396794
Bond Position:  [-11.87678322]


portfolio before change:  [-17.14439987]
curr_Stock_Price:  95.85656361366861
curr_Factors:  [95.85656361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00025477]
Stock Position:  -0.00025476765497324066
Bond Position:  [-17.11997872]


portfolio before change:  [-17.14563322]
curr_Stock_Price:  96.4975857247901
curr_Factors:  [96.49758572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02449877]
Stock Position:  -0.024498774943614784
Bond Position:  [-14.78156058]


portfolio before change:  [-17.1479142]
curr_Stock_Price:  96.55298041639243
curr_Factors:  [96.55298042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00484402]
Stock Position:  -0.0048440184570588615
Bond Position:  [-16.68020978]


portfolio before change:  [-17.1521354]
curr_Stock_Price:  97.20918271696063
curr_Factors:  [97.20918272]
mat_Sqrt:  [[0.15]]
grads:  [0.00435091]
Stock Position:  0.004350911043984119
Bond Position:  [-17.57508391]


portfolio before change:  [-17.15477522]
curr_Stock_Price:  96.85492400667364
curr_Factors:  [96.85492401]
mat_Sqrt:  [[0.15]]
grads:  [0.05073448]
Stock Position:  0.05073448200003483
Bond Position:  [-22.06865962]


portfolio before change:  [-17.16386737]
curr_Stock_Price:  96.70290090877965
curr_Factors:  [96.70290091]
mat_Sqrt:  [[0.15]]
grads:  [-0.06843785]
Stock Position:  -0.0684378504611171
Bond Position:  [-10.5457287]


portfolio before change:  [-17.16763571]
curr_Stock_Price:  96.74833199315127
curr_Factors:  [96.74833199]
mat_Sqrt:  [[0.15]]
grads:  [-0.03221207]
Stock Position:  -0.03221207187921312
Bond Position:  [-14.05117148]


portfolio before change:  [-17.15554906]
curr_Stock_Price:  96.34584701608041
curr_Factors:  [96.34584702]
mat_Sqrt:  [[0.15]]
grads:  [-0.00937067]
Stock Position:  -0.009370671951153701
Bond Position:  [-16.25272373]


portfolio before change:  [-17.14957706]
curr_Stock_Price:  95.60013531818169
curr_Factors:  [95.60013532]
mat_Sqrt:  [[0.15]]
grads:  [0.08857011]
Stock Position:  0.08857011215109498
Bond Position:  [-25.61689177]


portfolio before change:  [-17.12318297]
curr_Stock_Price:  95.91621483642353
curr_Factors:  [95.91621484]
mat_Sqrt:  [[0.15]]
grads:  [0.04669101]
Stock Position:  0.046691009687158475
Bond Position:  [-21.60160789]


portfolio before change:  [-17.13305047]
curr_Stock_Price:  95.7337951437103
curr_Factors:  [95.73379514]
mat_Sqrt:  [[0.15]]
grads:  [-0.018459]
Stock Position:  -0.018458996563120812
Bond Position:  [-15.36590068]


portfolio before change:  [-17.13307313]
curr_Stock_Price:  95.68299379415546
curr_Factors:  [95.68299379]
mat_Sqrt:  [[0.15]]
grads:  [-0.03411587]
Stock Position:  -0.03411586565513178
Bond Position:  [-13.86876497]


portfolio before change:  [-17.11593837]
curr_Stock_Price:  95.15533358671595
curr_Factors:  [95.15533359]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815139]
Stock Position:  -0.018151392014576398
Bond Position:  [-15.38873661]


portfolio before change:  [-17.1141399]
curr_Stock_Price:  95.00326302613273
curr_Factors:  [95.00326303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403073]
Stock Position:  -0.00403073395048241
Bond Position:  [-16.73120703]


portfolio before change:  [-17.11409995]
curr_Stock_Price:  94.73391061191208
curr_Factors:  [94.73391061]
mat_Sqrt:  [[0.15]]
grads:  [-0.03563075]
Stock Position:  -0.03563074751648946
Bond Position:  [-13.7386599]


portfolio before change:  [-17.08668284]
curr_Stock_Price:  93.94033181084804
curr_Factors:  [93.94033181]
mat_Sqrt:  [[0.15]]
grads:  [0.11552991]
Stock Position:  0.1155299137994149
Bond Position:  [-27.93960127]


portfolio before change:  [-17.14679773]
curr_Stock_Price:  93.43510670950239
curr_Factors:  [93.43510671]
mat_Sqrt:  [[0.15]]
grads:  [0.06280718]
Stock Position:  0.06280718286277262
Bond Position:  [-23.01519356]


portfolio before change:  [-17.13118762]
curr_Stock_Price:  93.70655021998908
curr_Factors:  [93.70655022]
mat_Sqrt:  [[0.15]]
grads:  [0.13652207]
Stock Position:  0.13652207360054652
Bond Position:  [-29.92420017]


portfolio before change:  [-17.11935725]
curr_Stock_Price:  93.80690535261536
curr_Factors:  [93.80690535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533116]
Stock Position:  -0.03533115528481186
Bond Position:  [-13.80505091]


portfolio before change:  [-17.13667719]
curr_Stock_Price:  94.27270087325547
curr_Factors:  [94.27270087]
mat_Sqrt:  [[0.15]]
grads:  [0.05499694]
Stock Position:  0.0549969401605549
Bond Position:  [-22.32138728]


portfolio before change:  [-17.14594433]
curr_Stock_Price:  94.12956541824074
curr_Factors:  [94.12956542]
mat_Sqrt:  [[0.15]]
grads:  [0.19264884]
Stock Position:  0.19264884151926848
Bond Position:  [-35.27989606]


portfolio before change:  [-17.14697462]
curr_Stock_Price:  94.13566341973232
curr_Factors:  [94.13566342]
mat_Sqrt:  [[0.15]]
grads:  [0.02056707]
Stock Position:  0.020567068738743286
Bond Position:  [-19.08306928]


portfolio before change:  [-17.12955856]
curr_Stock_Price:  95.04044928905881
curr_Factors:  [95.04044929]
mat_Sqrt:  [[0.15]]
grads:  [-0.10155888]
Stock Position:  -0.10155888099458618
Bond Position:  [-7.47735688]


portfolio before change:  [-17.13895516]
curr_Stock_Price:  95.12837126381682
curr_Factors:  [95.12837126]
mat_Sqrt:  [[0.15]]
grads:  [-0.03841782]
Stock Position:  -0.03841782473459991
Bond Position:  [-13.48433007]


portfolio before change:  [-17.14736513]
curr_Stock_Price:  95.32534157289358
curr_Factors:  [95.32534157]
mat_Sqrt:  [[0.15]]
grads:  [0.01674542]
Stock Position:  0.016745418712575347
Bond Position:  [-18.74362789]


portfolio before change:  [-17.15156908]
curr_Stock_Price:  95.14425087583052
curr_Factors:  [95.14425088]
mat_Sqrt:  [[0.15]]
grads:  [0.07572126]
Stock Position:  0.07572125974126255
Bond Position:  [-24.35601162]


portfolio before change:  [-17.16408899]
curr_Stock_Price:  94.99901274762391
curr_Factors:  [94.99901275]
mat_Sqrt:  [[0.15]]
grads:  [0.05554003]
Stock Position:  0.05554003210962052
Bond Position:  [-22.44033721]


portfolio before change:  [-17.14421554]
curr_Stock_Price:  95.3820880580058
curr_Factors:  [95.38208806]
mat_Sqrt:  [[0.15]]
grads:  [1.70975562e-05]
Stock Position:  1.709755622499957e-05
Bond Position:  [-17.14584635]


portfolio before change:  [-17.14527505]
curr_Stock_Price:  96.09256195604044
curr_Factors:  [96.09256196]
mat_Sqrt:  [[0.15]]
grads:  [-0.09618436]
Stock Position:  -0.0961843609638073
Bond Position:  [-7.90267338]


portfolio before change:  [-17.04363413]
curr_Stock_Price:  95.03069648568628
curr_Factors:  [95.03069649]
mat_Sqrt:  [[0.15]]
grads:  [-0.21046776]
Stock Position:  -0.21046776454587537
Bond Position:  [2.95726413]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.96710362]
Stock Price:  94.66795365133966
PL:  [-16.96710362]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.82383651e-03]
 [ 1.92239620e-03]
 [ 1.08710444e-02]
 [-1.06183309e-02]
 [ 1.25251801e-02]
 [-4.57954402e-03]
 [ 4.48344336e-04]
 [-4.50364293e-03]
 [-8.87837978e-04]
 [-1.29166573e-03]
 [ 1.48140774e-02]
 [-5.75433535e-03]
 [-1.01251862e-03]
 [ 5.73288470e-03]
 [-2.14854074e-03]
 [ 1.26313755e-02]
 [ 3.48557040e-02]
 [-1.51008362e-02]
 [ 2.26746730e-02]
 [-4.01496724e-04]
 [-9.28837654e-03]
 [ 5.40945992e-03]
 [ 1.77732650e-02]
 [ 1.78425558e-02]
 [-5.63624224e-03]
 [ 4.67146345e-03]
 [ 1.00685836e-02]
 [ 8.56369076e-03]
 [ 1.59580340e-02]
 [ 3.44008397e-02]
 [-6.86738755e-03]
 [ 1.87549897e-02]
 [ 1.26055173e-02]
 [-1.94540762e-02]
 [-1.58843710e-02]
 [-4.88059282e-02]
 [ 1.42551778e-02]
 [-3.90079030e-03]
 [ 1.08600780e-02]
 [-1.88808041e-03]
 [ 6.88764410e-03]
 [ 3.20934826e-02]
 [-3.36799184e-03]
 [ 4.46767919e-03]
 [-1.50731454e-02]
 [ 1.84361800e-02]
 [ 9.83634513e-03]
 [ 5.30913260e-03]
 [-2.36613849e-03]
 [-1.67812098e-03]
 [-7.20031811e-03]
 [-3.38318375e-03]
 [ 1.21389199e-03]
 [ 6.54765336e-03]
 [-9.20099074e-03]
 [-4.87128218e-03]
 [-1.37591536e-03]
 [ 1.28011392e-02]
 [ 7.13879039e-03]
 [-3.11249237e-03]
 [-5.13848306e-03]
 [-1.45772452e-03]
 [-3.72981236e-03]
 [-2.50382606e-03]
 [ 1.89969281e-02]
 [ 5.02354215e-03]
 [ 1.73214509e-02]
 [-1.90243822e-03]
 [ 6.40023950e-03]
 [ 2.69375983e-02]
 [ 3.05987655e-03]
 [-1.51461483e-02]
 [-5.77883353e-03]
 [ 3.18817567e-03]
 [ 1.21580825e-02]
 [ 1.31836486e-02]
 [ 2.57685304e-03]
 [-2.48293071e-02]
 [-3.23819154e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.2497089]
curr_Stock_Price:  100.23707249990264
curr_Factors:  [100.2370725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02549224]
Stock Position:  -0.025492243407196347
Bond Position:  [9.80497676]


portfolio before change:  [7.26507468]
curr_Stock_Price:  99.6583497733027
curr_Factors:  [99.65834977]
mat_Sqrt:  [[0.15]]
grads:  [0.01281597]
Stock Position:  0.012815974685225946
Bond Position:  [5.98785579]


portfolio before change:  [7.27381271]
curr_Stock_Price:  100.31095602923993
curr_Factors:  [100.31095603]
mat_Sqrt:  [[0.15]]
grads:  [0.07247363]
Stock Position:  0.07247362926893174
Bond Position:  [0.00391367]


portfolio before change:  [7.28249239]
curr_Stock_Price:  100.43071593944408
curr_Factors:  [100.43071594]
mat_Sqrt:  [[0.15]]
grads:  [-0.07078887]
Stock Position:  -0.07078887294610725
Bond Position:  [14.39186958]


portfolio before change:  [7.32607904]
curr_Stock_Price:  99.8276956794415
curr_Factors:  [99.82769568]
mat_Sqrt:  [[0.15]]
grads:  [0.0835012]
Stock Position:  0.08350120036242799
Bond Position:  [-1.00965338]


portfolio before change:  [7.35509104]
curr_Stock_Price:  100.17589556548326
curr_Factors:  [100.17589557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03053029]
Stock Position:  -0.030530293462259318
Bond Position:  [10.41349053]


portfolio before change:  [7.37492964]
curr_Stock_Price:  99.547413852491
curr_Factors:  [99.54741385]
mat_Sqrt:  [[0.15]]
grads:  [0.00298896]
Stock Position:  0.0029889622404249048
Bond Position:  [7.07738617]


portfolio before change:  [7.37616672]
curr_Stock_Price:  99.8133044534459
curr_Factors:  [99.81330445]
mat_Sqrt:  [[0.15]]
grads:  [-0.03002429]
Stock Position:  -0.030024286228750634
Bond Position:  [10.37298995]


portfolio before change:  [7.36348054]
curr_Stock_Price:  100.2574288078223
curr_Factors:  [100.25742881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00591892]
Stock Position:  -0.005918919851216273
Bond Position:  [7.95689622]


portfolio before change:  [7.36479504]
curr_Stock_Price:  100.1193666251256
curr_Factors:  [100.11936663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086111]
Stock Position:  -0.008611104881103133
Bond Position:  [8.22693341]


portfolio before change:  [7.36739589]
curr_Stock_Price:  99.87704581104904
curr_Factors:  [99.87704581]
mat_Sqrt:  [[0.15]]
grads:  [0.09876052]
Stock Position:  0.09876051605763618
Bond Position:  [-2.4965127]


portfolio before change:  [7.32741336]
curr_Stock_Price:  99.47378255583811
curr_Factors:  [99.47378256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03836224]
Stock Position:  -0.03836223566316064
Bond Position:  [11.14345005]


portfolio before change:  [7.32733058]
curr_Stock_Price:  99.4940961591798
curr_Factors:  [99.49409616]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675012]
Stock Position:  -0.00675012412671587
Bond Position:  [7.99892808]


portfolio before change:  [7.32945145]
curr_Stock_Price:  99.2539639018978
curr_Factors:  [99.2539639]
mat_Sqrt:  [[0.15]]
grads:  [0.03821923]
Stock Position:  0.03821923131158981
Bond Position:  [3.53604124]


portfolio before change:  [7.32145915]
curr_Stock_Price:  99.03906413513035
curr_Factors:  [99.03906414]
mat_Sqrt:  [[0.15]]
grads:  [-0.0143236]
Stock Position:  -0.01432360492333183
Bond Position:  [8.74005558]


portfolio before change:  [7.31114581]
curr_Stock_Price:  99.7972258863337
curr_Factors:  [99.79722589]
mat_Sqrt:  [[0.15]]
grads:  [0.08420917]
Stock Position:  0.08420916991703503
Bond Position:  [-1.09269574]


portfolio before change:  [7.33549468]
curr_Stock_Price:  100.0871843626414
curr_Factors:  [100.08718436]
mat_Sqrt:  [[0.15]]
grads:  [0.23237136]
Stock Position:  0.23237136023032023
Bond Position:  [-15.92190049]


portfolio before change:  [7.14864869]
curr_Stock_Price:  99.28738339647207
curr_Factors:  [99.2873834]
mat_Sqrt:  [[0.15]]
grads:  [-0.10067224]
Stock Position:  -0.10067224116534888
Bond Position:  [17.1441321]


portfolio before change:  [7.16161597]
curr_Stock_Price:  99.16922040424893
curr_Factors:  [99.1692204]
mat_Sqrt:  [[0.15]]
grads:  [0.15116449]
Stock Position:  0.15116448686564152
Bond Position:  [-7.82924835]


portfolio before change:  [7.06892253]
curr_Stock_Price:  98.55926170800002
curr_Factors:  [98.55926171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00267664]
Stock Position:  -0.002676644824765686
Bond Position:  [7.33273067]


portfolio before change:  [7.07056872]
curr_Stock_Price:  98.11546759763992
curr_Factors:  [98.1154676]
mat_Sqrt:  [[0.15]]
grads:  [-0.06192251]
Stock Position:  -0.061922510237261315
Bond Position:  [13.14612477]


portfolio before change:  [7.03297453]
curr_Stock_Price:  98.7358534476608
curr_Factors:  [98.73585345]
mat_Sqrt:  [[0.15]]
grads:  [0.03606307]
Stock Position:  0.036063066106368155
Bond Position:  [3.47225692]


portfolio before change:  [7.03995441]
curr_Stock_Price:  98.92338214081335
curr_Factors:  [98.92338214]
mat_Sqrt:  [[0.15]]
grads:  [0.11848843]
Stock Position:  0.11848843357732983
Bond Position:  [-4.68132218]


portfolio before change:  [7.05207046]
curr_Stock_Price:  99.02810661500875
curr_Factors:  [99.02810662]
mat_Sqrt:  [[0.15]]
grads:  [0.11895037]
Stock Position:  0.1189503722558139
Bond Position:  [-4.72735969]


portfolio before change:  [7.02678]
curr_Stock_Price:  98.81797703967442
curr_Factors:  [98.81797704]
mat_Sqrt:  [[0.15]]
grads:  [-0.03757495]
Stock Position:  -0.03757494825823976
Bond Position:  [10.73986037]


portfolio before change:  [7.02737859]
curr_Stock_Price:  98.81991114127032
curr_Factors:  [98.81991114]
mat_Sqrt:  [[0.15]]
grads:  [0.03114309]
Stock Position:  0.031143089636731704
Bond Position:  [3.94982124]


portfolio before change:  [7.0219085]
curr_Stock_Price:  98.63634052714329
curr_Factors:  [98.63634053]
mat_Sqrt:  [[0.15]]
grads:  [0.06712389]
Stock Position:  0.06712389054000964
Bond Position:  [0.40105358]


portfolio before change:  [7.0155318]
curr_Stock_Price:  98.54096811321386
curr_Factors:  [98.54096811]
mat_Sqrt:  [[0.15]]
grads:  [0.05709127]
Stock Position:  0.05709127170418323
Bond Position:  [1.38970262]


portfolio before change:  [6.98077847]
curr_Stock_Price:  97.9307138604653
curr_Factors:  [97.93071386]
mat_Sqrt:  [[0.15]]
grads:  [0.10638689]
Stock Position:  0.10638689352476574
Bond Position:  [-3.43776596]


portfolio before change:  [6.9010553]
curr_Stock_Price:  97.18336336066382
curr_Factors:  [97.18336336]
mat_Sqrt:  [[0.15]]
grads:  [0.22933893]
Stock Position:  0.2293389313692162
Bond Position:  [-15.3868734]


portfolio before change:  [6.98079419]
curr_Stock_Price:  97.53524691484316
curr_Factors:  [97.53524691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04578258]
Stock Position:  -0.045782583637117784
Bond Position:  [11.44620979]


portfolio before change:  [6.99976423]
curr_Stock_Price:  97.13652269341253
curr_Factors:  [97.13652269]
mat_Sqrt:  [[0.15]]
grads:  [0.12503326]
Stock Position:  0.1250332645052239
Bond Position:  [-5.14553231]


portfolio before change:  [6.9046428]
curr_Stock_Price:  96.37832585685722
curr_Factors:  [96.37832586]
mat_Sqrt:  [[0.15]]
grads:  [0.08403678]
Stock Position:  0.0840367819434734
Bond Position:  [-1.19468156]


portfolio before change:  [6.86324536]
curr_Stock_Price:  95.886603447493
curr_Factors:  [95.88660345]
mat_Sqrt:  [[0.15]]
grads:  [-0.12969384]
Stock Position:  -0.12969384138095408
Bond Position:  [19.2991473]


portfolio before change:  [6.92430177]
curr_Stock_Price:  95.42513065056843
curr_Factors:  [95.42513065]
mat_Sqrt:  [[0.15]]
grads:  [-0.10589581]
Stock Position:  -0.10589580638598216
Bond Position:  [17.02942293]


portfolio before change:  [6.9483465]
curr_Stock_Price:  95.20812151093774
curr_Factors:  [95.20812151]
mat_Sqrt:  [[0.15]]
grads:  [-0.32537285]
Stock Position:  -0.32537285467206034
Bond Position:  [37.92648479]


portfolio before change:  [6.95892838]
curr_Stock_Price:  95.18288461038999
curr_Factors:  [95.18288461]
mat_Sqrt:  [[0.15]]
grads:  [0.09503452]
Stock Position:  0.09503451833911969
Bond Position:  [-2.08673121]


portfolio before change:  [7.01880692]
curr_Stock_Price:  95.8143284584145
curr_Factors:  [95.81432846]
mat_Sqrt:  [[0.15]]
grads:  [-0.02600527]
Stock Position:  -0.02600526866995162
Bond Position:  [9.51048428]


portfolio before change:  [7.00495618]
curr_Stock_Price:  96.36979919277469
curr_Factors:  [96.36979919]
mat_Sqrt:  [[0.15]]
grads:  [0.07240052]
Stock Position:  0.07240052004257781
Bond Position:  [0.0277326]


portfolio before change:  [6.99581644]
curr_Stock_Price:  96.24353661286739
curr_Factors:  [96.24353661]
mat_Sqrt:  [[0.15]]
grads:  [-0.0125872]
Stock Position:  -0.012587202737264422
Bond Position:  [8.20725334]


portfolio before change:  [7.00013565]
curr_Stock_Price:  95.94114669142441
curr_Factors:  [95.94114669]
mat_Sqrt:  [[0.15]]
grads:  [0.04591763]
Stock Position:  0.04591762731711397
Bond Position:  [2.59474583]


portfolio before change:  [7.06013002]
curr_Stock_Price:  97.24417996885144
curr_Factors:  [97.24417997]
mat_Sqrt:  [[0.15]]
grads:  [0.21395655]
Stock Position:  0.21395655040015912
Bond Position:  [-13.74589927]


portfolio before change:  [6.96440758]
curr_Stock_Price:  96.80080352114179
curr_Factors:  [96.80080352]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245328]
Stock Position:  -0.02245327894746867
Bond Position:  [9.13790303]


portfolio before change:  [6.9532816]
curr_Stock_Price:  97.32175732892813
curr_Factors:  [97.32175733]
mat_Sqrt:  [[0.15]]
grads:  [0.02978453]
Stock Position:  0.029784527932682284
Bond Position:  [4.054599]


portfolio before change:  [6.95907522]
curr_Stock_Price:  97.50776666085974
curr_Factors:  [97.50776666]
mat_Sqrt:  [[0.15]]
grads:  [-0.10048764]
Stock Position:  -0.10048763581666911
Bond Position:  [16.75740016]


portfolio before change:  [6.99301098]
curr_Stock_Price:  97.18047874205578
curr_Factors:  [97.18047874]
mat_Sqrt:  [[0.15]]
grads:  [0.12290787]
Stock Position:  0.12290786665112477
Bond Position:  [-4.95123435]


portfolio before change:  [6.97087043]
curr_Stock_Price:  97.00285720000083
curr_Factors:  [97.0028572]
mat_Sqrt:  [[0.15]]
grads:  [0.06557563]
Stock Position:  0.06557563418405339
Bond Position:  [0.60984655]


portfolio before change:  [6.97357289]
curr_Stock_Price:  97.04348733779739
curr_Factors:  [97.04348734]
mat_Sqrt:  [[0.15]]
grads:  [0.03539422]
Stock Position:  0.03539421736139655
Bond Position:  [3.53879461]


portfolio before change:  [7.01860926]
curr_Stock_Price:  98.30965975137806
curr_Factors:  [98.30965975]
mat_Sqrt:  [[0.15]]
grads:  [-0.01577426]
Stock Position:  -0.015774256632900992
Bond Position:  [8.56937106]


portfolio before change:  [7.01303521]
curr_Stock_Price:  98.69697753742716
curr_Factors:  [98.69697754]
mat_Sqrt:  [[0.15]]
grads:  [-0.01118747]
Stock Position:  -0.011187473232837163
Bond Position:  [8.117205]


portfolio before change:  [7.00992047]
curr_Stock_Price:  99.02073970373804
curr_Factors:  [99.0207397]
mat_Sqrt:  [[0.15]]
grads:  [-0.04800212]
Stock Position:  -0.04800212072916507
Bond Position:  [11.76312597]


portfolio before change:  [6.99274762]
curr_Stock_Price:  99.39380790801978
curr_Factors:  [99.39380791]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255456]
Stock Position:  -0.022554558339646348
Bond Position:  [9.23453106]


portfolio before change:  [7.01584952]
curr_Stock_Price:  98.39513065156171
curr_Factors:  [98.39513065]
mat_Sqrt:  [[0.15]]
grads:  [0.00809261]
Stock Position:  0.00809261326823723
Bond Position:  [6.21957578]


portfolio before change:  [7.01125126]
curr_Stock_Price:  97.77888992518331
curr_Factors:  [97.77888993]
mat_Sqrt:  [[0.15]]
grads:  [0.04365102]
Stock Position:  0.04365102238995125
Bond Position:  [2.74310275]


portfolio before change:  [7.00225215]
curr_Stock_Price:  97.56880175987646
curr_Factors:  [97.56880176]
mat_Sqrt:  [[0.15]]
grads:  [-0.06133994]
Stock Position:  -0.0613399382771632
Bond Position:  [12.98711643]


portfolio before change:  [7.06342926]
curr_Stock_Price:  96.58468935799894
curr_Factors:  [96.58468936]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247521]
Stock Position:  -0.0324752145306827
Bond Position:  [10.20003777]


portfolio before change:  [7.06562312]
curr_Stock_Price:  96.53676551242044
curr_Factors:  [96.53676551]
mat_Sqrt:  [[0.15]]
grads:  [-0.00917277]
Stock Position:  -0.009172769055805349
Bond Position:  [7.95113258]


portfolio before change:  [7.06729009]
curr_Stock_Price:  96.40921375025103
curr_Factors:  [96.40921375]
mat_Sqrt:  [[0.15]]
grads:  [0.08534093]
Stock Position:  0.08534092785287488
Bond Position:  [-1.16036167]


portfolio before change:  [7.04608033]
curr_Stock_Price:  96.16153389680525
curr_Factors:  [96.1615339]
mat_Sqrt:  [[0.15]]
grads:  [0.04759194]
Stock Position:  0.04759193591706234
Bond Position:  [2.46956677]


portfolio before change:  [7.0634742]
curr_Stock_Price:  96.52377002418473
curr_Factors:  [96.52377002]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074995]
Stock Position:  -0.02074994912094043
Bond Position:  [9.06633752]


portfolio before change:  [7.06346004]
curr_Stock_Price:  96.55176166911684
curr_Factors:  [96.55176167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03425655]
Stock Position:  -0.03425655376603751
Bond Position:  [10.37099066]


portfolio before change:  [7.0628866]
curr_Stock_Price:  96.58742346099244
curr_Factors:  [96.58742346]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971816]
Stock Position:  -0.009718163485229539
Bond Position:  [8.00153897]


portfolio before change:  [7.0609919]
curr_Stock_Price:  96.83384932949527
curr_Factors:  [96.83384933]
mat_Sqrt:  [[0.15]]
grads:  [-0.02486542]
Stock Position:  -0.024865415748491194
Bond Position:  [9.46880583]


portfolio before change:  [7.06637653]
curr_Stock_Price:  96.64109922331089
curr_Factors:  [96.64109922]
mat_Sqrt:  [[0.15]]
grads:  [-0.01669217]
Stock Position:  -0.016692173761727276
Bond Position:  [8.67952656]


portfolio before change:  [7.06518764]
curr_Stock_Price:  96.74482347313999
curr_Factors:  [96.74482347]
mat_Sqrt:  [[0.15]]
grads:  [0.12664619]
Stock Position:  0.12664618708728909
Bond Position:  [-5.18717537]


portfolio before change:  [7.04406179]
curr_Stock_Price:  96.58057342633961
curr_Factors:  [96.58057343]
mat_Sqrt:  [[0.15]]
grads:  [0.03349028]
Stock Position:  0.03349028099681293
Bond Position:  [3.80955125]


portfolio before change:  [7.03949568]
curr_Stock_Price:  96.43712246400445
curr_Factors:  [96.43712246]
mat_Sqrt:  [[0.15]]
grads:  [0.11547634]
Stock Position:  0.1154763391906225
Bond Position:  [-4.09671018]


portfolio before change:  [7.08476085]
curr_Stock_Price:  96.83132635342295
curr_Factors:  [96.83132635]
mat_Sqrt:  [[0.15]]
grads:  [-0.01268292]
Stock Position:  -0.012682921438612568
Bond Position:  [8.31286495]


portfolio before change:  [7.10052194]
curr_Stock_Price:  95.6295906609465
curr_Factors:  [95.62959066]
mat_Sqrt:  [[0.15]]
grads:  [0.04266826]
Stock Position:  0.04266826335924338
Bond Position:  [3.02017338]


portfolio before change:  [7.0928117]
curr_Stock_Price:  95.44446470831582
curr_Factors:  [95.44446471]
mat_Sqrt:  [[0.15]]
grads:  [0.17958399]
Stock Position:  0.1795839884780563
Bond Position:  [-10.04748595]


portfolio before change:  [7.00715431]
curr_Stock_Price:  94.97098484751494
curr_Factors:  [94.97098485]
mat_Sqrt:  [[0.15]]
grads:  [0.02039918]
Stock Position:  0.020399176967516648
Bond Position:  [5.06982439]


portfolio before change:  [6.99443644]
curr_Stock_Price:  94.33200110995021
curr_Factors:  [94.33200111]
mat_Sqrt:  [[0.15]]
grads:  [-0.10097432]
Stock Position:  -0.10097432172423955
Bond Position:  [16.51954627]


portfolio before change:  [7.02270373]
curr_Stock_Price:  94.0622812741613
curr_Factors:  [94.06228127]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852556]
Stock Position:  -0.03852555685346443
Bond Position:  [10.64650549]


portfolio before change:  [7.03933894]
curr_Stock_Price:  93.64775673804614
curr_Factors:  [93.64775674]
mat_Sqrt:  [[0.15]]
grads:  [0.0212545]
Stock Position:  0.02125450443687419
Bond Position:  [5.04890228]


portfolio before change:  [7.03893827]
curr_Stock_Price:  93.61405837069402
curr_Factors:  [93.61405837]
mat_Sqrt:  [[0.15]]
grads:  [0.08105388]
Stock Position:  0.08105388302355124
Bond Position:  [-0.54884467]


portfolio before change:  [7.06742335]
curr_Stock_Price:  93.96591546112305
curr_Factors:  [93.96591546]
mat_Sqrt:  [[0.15]]
grads:  [0.08789099]
Stock Position:  0.08789099099162248
Bond Position:  [-1.19133408]


portfolio before change:  [7.084765]
curr_Stock_Price:  94.16407130827362
curr_Factors:  [94.16407131]
mat_Sqrt:  [[0.15]]
grads:  [0.01717902]
Stock Position:  0.017179020256050788
Bond Position:  [5.46711851]


portfolio before change:  [7.08977071]
curr_Stock_Price:  94.43556540186175
curr_Factors:  [94.4355654]
mat_Sqrt:  [[0.15]]
grads:  [-0.16552871]
Stock Position:  -0.1655287140518642
Bond Position:  [22.72156841]


portfolio before change:  [7.06424188]
curr_Stock_Price:  94.59837083619617
curr_Factors:  [94.59837084]
mat_Sqrt:  [[0.15]]
grads:  [-0.21587944]
Stock Position:  -0.2158794359269772
Bond Position:  [27.48608481]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.02358893]
Stock Price:  94.79464188424515
PL:  [7.02358893]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.96274268e-03]
 [ 1.79353992e-02]
 [ 2.18485904e-02]
 [-2.04612374e-02]
 [ 3.33957903e-03]
 [-1.73090059e-03]
 [-7.26519086e-03]
 [-3.04847215e-02]
 [ 1.57674882e-02]
 [-8.76310734e-05]
 [-4.13913384e-03]
 [ 1.87883891e-02]
 [-3.90747098e-03]
 [ 5.46513702e-03]
 [ 1.90992519e-03]
 [ 1.39883741e-02]
 [ 5.99044507e-02]
 [-1.41334149e-02]
 [ 1.87334262e-02]
 [ 1.24264121e-03]
 [-4.35861096e-03]
 [ 4.60397777e-03]
 [ 1.27656640e-02]
 [ 1.90269518e-02]
 [-4.07043797e-03]
 [ 5.16151102e-03]
 [ 1.48602119e-03]
 [ 5.54726671e-03]
 [ 3.13655436e-02]
 [-6.24323258e-03]
 [-1.31597811e-03]
 [ 1.39874688e-02]
 [ 1.41213781e-02]
 [-4.48345222e-03]
 [ 5.22333817e-03]
 [ 3.64263889e-03]
 [-1.35093823e-02]
 [-9.33589930e-03]
 [-1.02580953e-02]
 [-3.57860117e-02]
 [ 3.48438251e-03]
 [ 6.25899962e-03]
 [-8.05163569e-03]
 [ 4.88334013e-03]
 [ 3.85528467e-03]
 [ 1.16718134e-02]
 [ 1.05636324e-02]
 [-2.22621315e-03]
 [ 1.31864684e-02]
 [-1.43126384e-03]
 [ 1.98886586e-02]
 [ 1.27652895e-02]
 [-5.31367273e-03]
 [-4.24441508e-02]
 [-8.49541546e-03]
 [-2.55758102e-03]
 [ 2.27963800e-04]
 [-1.63082069e-02]
 [ 1.77835874e-03]
 [-3.08688189e-03]
 [-7.61124656e-03]
 [-5.02918871e-03]
 [-1.71860006e-02]
 [ 1.43941385e-04]
 [ 3.42198409e-03]
 [ 1.79606234e-02]
 [ 2.96605335e-03]
 [ 1.32036519e-02]
 [ 7.79664227e-03]
 [ 1.14046572e-02]
 [ 5.44078767e-03]
 [-1.47128939e-02]
 [-3.04540351e-02]
 [ 7.63288168e-04]
 [-5.80298213e-04]
 [-2.24063180e-02]
 [-4.89449879e-03]
 [ 1.64188307e-02]
 [ 2.57402500e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.93818546]
curr_Stock_Price:  100.49543144774877
curr_Factors:  [100.49543145]
mat_Sqrt:  [[0.15]]
grads:  [-0.02641828]
Stock Position:  -0.02641828450291487
Bond Position:  [15.59310236]


portfolio before change:  [12.94370187]
curr_Stock_Price:  100.32351229492072
curr_Factors:  [100.32351229]
mat_Sqrt:  [[0.15]]
grads:  [0.11956933]
Stock Position:  0.11956932767523859
Bond Position:  [0.94808695]


portfolio before change:  [12.9741169]
curr_Stock_Price:  100.57738821411408
curr_Factors:  [100.57738821]
mat_Sqrt:  [[0.15]]
grads:  [0.14565727]
Stock Position:  0.14565726938605303
Bond Position:  [-1.67571083]


portfolio before change:  [13.01791276]
curr_Stock_Price:  100.87878473739956
curr_Factors:  [100.87878474]
mat_Sqrt:  [[0.15]]
grads:  [-0.13640825]
Stock Position:  -0.13640824903728122
Bond Position:  [26.77861115]


portfolio before change:  [13.07667246]
curr_Stock_Price:  100.46029111491963
curr_Factors:  [100.46029111]
mat_Sqrt:  [[0.15]]
grads:  [0.02226386]
Stock Position:  0.022263860221735945
Bond Position:  [10.84003858]


portfolio before change:  [13.08201476]
curr_Stock_Price:  100.66981350181658
curr_Factors:  [100.6698135]
mat_Sqrt:  [[0.15]]
grads:  [-0.01153934]
Stock Position:  -0.011539337248112085
Bond Position:  [14.24367769]


portfolio before change:  [13.08228991]
curr_Stock_Price:  100.72311890496096
curr_Factors:  [100.7231189]
mat_Sqrt:  [[0.15]]
grads:  [-0.04843461]
Stock Position:  -0.048434605751754053
Bond Position:  [17.96077446]


portfolio before change:  [13.06309232]
curr_Stock_Price:  101.14265711242268
curr_Factors:  [101.14265711]
mat_Sqrt:  [[0.15]]
grads:  [-0.20323148]
Stock Position:  -0.203231476567619
Bond Position:  [33.61846387]


portfolio before change:  [12.97566141]
curr_Stock_Price:  101.58319976516302
curr_Factors:  [101.58319977]
mat_Sqrt:  [[0.15]]
grads:  [0.10511659]
Stock Position:  0.10511658798678973
Bond Position:  [2.29758205]


portfolio before change:  [12.90548914]
curr_Stock_Price:  100.91426755378991
curr_Factors:  [100.91426755]
mat_Sqrt:  [[0.15]]
grads:  [-0.00058421]
Stock Position:  -0.0005842071560146813
Bond Position:  [12.96444398]


portfolio before change:  [12.9062594]
curr_Stock_Price:  100.98280875237639
curr_Factors:  [100.98280875]
mat_Sqrt:  [[0.15]]
grads:  [-0.02759423]
Stock Position:  -0.02759422559167989
Bond Position:  [15.69280181]


portfolio before change:  [12.87126711]
curr_Stock_Price:  102.28645534839633
curr_Factors:  [102.28645535]
mat_Sqrt:  [[0.15]]
grads:  [0.12525593]
Stock Position:  0.12525592763490437
Bond Position:  [0.05928226]


portfolio before change:  [12.80861634]
curr_Stock_Price:  101.78624366394511
curr_Factors:  [101.78624366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02604981]
Stock Position:  -0.026049806518551634
Bond Position:  [15.46012829]


portfolio before change:  [12.82215188]
curr_Stock_Price:  101.30373510438925
curr_Factors:  [101.3037351]
mat_Sqrt:  [[0.15]]
grads:  [0.03643425]
Stock Position:  0.036434246818435975
Bond Position:  [9.13122659]


portfolio before change:  [12.82581256]
curr_Stock_Price:  101.38854442096519
curr_Factors:  [101.38854442]
mat_Sqrt:  [[0.15]]
grads:  [0.01273283]
Stock Position:  0.012732834578796856
Bond Position:  [11.534849]


portfolio before change:  [12.82984102]
curr_Stock_Price:  101.64830641019397
curr_Factors:  [101.64830641]
mat_Sqrt:  [[0.15]]
grads:  [0.09325583]
Stock Position:  0.0932558271798049
Bond Position:  [3.35054413]


portfolio before change:  [12.78680212]
curr_Stock_Price:  101.18454647994974
curr_Factors:  [101.18454648]
mat_Sqrt:  [[0.15]]
grads:  [0.399363]
Stock Position:  0.3993630047200699
Bond Position:  [-27.62256239]


portfolio before change:  [12.78476237]
curr_Stock_Price:  101.18376200495973
curr_Factors:  [101.183762]
mat_Sqrt:  [[0.15]]
grads:  [-0.09422277]
Stock Position:  -0.09422276591696128
Bond Position:  [22.31857629]


portfolio before change:  [12.84744639]
curr_Stock_Price:  100.53329215940377
curr_Factors:  [100.53329216]
mat_Sqrt:  [[0.15]]
grads:  [0.12488951]
Stock Position:  0.1248895080343637
Bond Position:  [0.29189299]


portfolio before change:  [13.01021154]
curr_Stock_Price:  101.83641931903094
curr_Factors:  [101.83641932]
mat_Sqrt:  [[0.15]]
grads:  [0.00828427]
Stock Position:  0.008284274763837921
Bond Position:  [12.16657066]


portfolio before change:  [13.00848462]
curr_Stock_Price:  101.53616874399245
curr_Factors:  [101.53616874]
mat_Sqrt:  [[0.15]]
grads:  [-0.02905741]
Stock Position:  -0.029057406371253928
Bond Position:  [15.95886234]


portfolio before change:  [13.00907715]
curr_Stock_Price:  101.55010434041832
curr_Factors:  [101.55010434]
mat_Sqrt:  [[0.15]]
grads:  [0.03069319]
Stock Position:  0.03069318510973336
Bond Position:  [9.892181]


portfolio before change:  [13.00974582]
curr_Stock_Price:  101.55174606525863
curr_Factors:  [101.55174607]
mat_Sqrt:  [[0.15]]
grads:  [0.08510443]
Stock Position:  0.08510442695222982
Bond Position:  [4.36724266]


portfolio before change:  [12.9388709]
curr_Stock_Price:  100.71573924904997
curr_Factors:  [100.71573925]
mat_Sqrt:  [[0.15]]
grads:  [0.12684635]
Stock Position:  0.12684634507912507
Bond Position:  [0.16344748]


portfolio before change:  [12.8979749]
curr_Stock_Price:  100.3932528956216
curr_Factors:  [100.3932529]
mat_Sqrt:  [[0.15]]
grads:  [-0.02713625]
Stock Position:  -0.02713625316533058
Bond Position:  [15.62227163]


portfolio before change:  [12.90101679]
curr_Stock_Price:  100.31713806807429
curr_Factors:  [100.31713807]
mat_Sqrt:  [[0.15]]
grads:  [0.03441007]
Stock Position:  0.03441007348381589
Bond Position:  [9.4490967]


portfolio before change:  [12.89292262]
curr_Stock_Price:  100.06474791396839
curr_Factors:  [100.06474791]
mat_Sqrt:  [[0.15]]
grads:  [0.00990681]
Stock Position:  0.009906807952117676
Bond Position:  [11.90160038]


portfolio before change:  [12.89921182]
curr_Stock_Price:  100.62449785542873
curr_Factors:  [100.62449786]
mat_Sqrt:  [[0.15]]
grads:  [0.03698178]
Stock Position:  0.03698177803423475
Bond Position:  [9.17793898]


portfolio before change:  [12.9372149]
curr_Stock_Price:  101.63660261407267
curr_Factors:  [101.63660261]
mat_Sqrt:  [[0.15]]
grads:  [0.20910362]
Stock Position:  0.20910362371035077
Bond Position:  [-8.31536701]


portfolio before change:  [13.04906221]
curr_Stock_Price:  102.17397752209794
curr_Factors:  [102.17397752]
mat_Sqrt:  [[0.15]]
grads:  [-0.04162155]
Stock Position:  -0.041621550501243686
Bond Position:  [17.30170158]


portfolio before change:  [13.0394304]
curr_Stock_Price:  102.43137294085746
curr_Factors:  [102.43137294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00877319]
Stock Position:  -0.008773187428392065
Bond Position:  [13.93808004]


portfolio before change:  [13.03805651]
curr_Stock_Price:  102.68727183791955
curr_Factors:  [102.68727184]
mat_Sqrt:  [[0.15]]
grads:  [0.09324979]
Stock Position:  0.09324979214539564
Bond Position:  [3.46248976]


portfolio before change:  [13.06799008]
curr_Stock_Price:  103.00595519370695
curr_Factors:  [103.00595519]
mat_Sqrt:  [[0.15]]
grads:  [0.09414252]
Stock Position:  0.0941425206936501
Bond Position:  [3.37074981]


portfolio before change:  [13.09600048]
curr_Stock_Price:  103.30124916370228
curr_Factors:  [103.30124916]
mat_Sqrt:  [[0.15]]
grads:  [-0.02988968]
Stock Position:  -0.029889681457116908
Bond Position:  [16.18364191]


portfolio before change:  [13.11800603]
curr_Stock_Price:  102.5988648699618
curr_Factors:  [102.59886487]
mat_Sqrt:  [[0.15]]
grads:  [0.03482225]
Stock Position:  0.03482225444576775
Bond Position:  [9.54528225]


portfolio before change:  [13.13970217]
curr_Stock_Price:  103.20478599296082
curr_Factors:  [103.20478599]
mat_Sqrt:  [[0.15]]
grads:  [0.02428426]
Stock Position:  0.024284259287704012
Bond Position:  [10.63345039]


portfolio before change:  [13.14912602]
curr_Stock_Price:  103.56548225155821
curr_Factors:  [103.56548225]
mat_Sqrt:  [[0.15]]
grads:  [-0.09006255]
Stock Position:  -0.09006254836443561
Bond Position:  [22.47649728]


portfolio before change:  [13.1286194]
curr_Stock_Price:  103.80877364502408
curr_Factors:  [103.80877365]
mat_Sqrt:  [[0.15]]
grads:  [-0.06223933]
Stock Position:  -0.06223932865083839
Bond Position:  [19.58960778]


portfolio before change:  [13.11982114]
curr_Stock_Price:  103.96980774979505
curr_Factors:  [103.96980775]
mat_Sqrt:  [[0.15]]
grads:  [-0.0683873]
Stock Position:  -0.06838730202813174
Bond Position:  [20.23003578]


portfolio before change:  [13.09337728]
curr_Stock_Price:  104.3749747386484
curr_Factors:  [104.37497474]
mat_Sqrt:  [[0.15]]
grads:  [-0.23857341]
Stock Position:  -0.2385734111798013
Bond Position:  [37.99447104]


portfolio before change:  [13.08217222]
curr_Stock_Price:  104.43189552140407
curr_Factors:  [104.43189552]
mat_Sqrt:  [[0.15]]
grads:  [0.02322922]
Stock Position:  0.023229216748061266
Bond Position:  [10.65630108]


portfolio before change:  [13.07790089]
curr_Stock_Price:  104.21934557725216
curr_Factors:  [104.21934558]
mat_Sqrt:  [[0.15]]
grads:  [0.04172666]
Stock Position:  0.04172666410760694
Bond Position:  [8.72917527]


portfolio before change:  [13.01934554]
curr_Stock_Price:  102.80296242973803
curr_Factors:  [102.80296243]
mat_Sqrt:  [[0.15]]
grads:  [-0.05367757]
Stock Position:  -0.05367757126636662
Bond Position:  [18.53755888]


portfolio before change:  [12.97500522]
curr_Stock_Price:  103.6505967638784
curr_Factors:  [103.65059676]
mat_Sqrt:  [[0.15]]
grads:  [0.0325556]
Stock Position:  0.03255560083692044
Bond Position:  [9.60059776]


portfolio before change:  [12.97662814]
curr_Stock_Price:  103.6820157398372
curr_Factors:  [103.68201574]
mat_Sqrt:  [[0.15]]
grads:  [0.0257019]
Stock Position:  0.02570189779239007
Bond Position:  [10.31180357]


portfolio before change:  [12.98840358]
curr_Stock_Price:  104.11509401167196
curr_Factors:  [104.11509401]
mat_Sqrt:  [[0.15]]
grads:  [0.07781209]
Stock Position:  0.07781208965808668
Bond Position:  [4.88699055]


portfolio before change:  [12.9889984]
curr_Stock_Price:  104.11881284017076
curr_Factors:  [104.11881284]
mat_Sqrt:  [[0.15]]
grads:  [0.07042422]
Stock Position:  0.07042421570722204
Bond Position:  [5.65651266]


portfolio before change:  [12.9686422]
curr_Stock_Price:  103.82474149716602
curr_Factors:  [103.8247415]
mat_Sqrt:  [[0.15]]
grads:  [-0.01484142]
Stock Position:  -0.014841420992418586
Bond Position:  [14.50954889]


portfolio before change:  [12.95744408]
curr_Stock_Price:  104.64036339710741
curr_Factors:  [104.6403634]
mat_Sqrt:  [[0.15]]
grads:  [0.08790979]
Stock Position:  0.0879097891727256
Bond Position:  [3.7585318]


portfolio before change:  [13.00587946]
curr_Stock_Price:  105.18865800275354
curr_Factors:  [105.188658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954176]
Stock Position:  -0.009541758951711369
Bond Position:  [14.00956428]


portfolio before change:  [13.00254414]
curr_Stock_Price:  105.62997622175614
curr_Factors:  [105.62997622]
mat_Sqrt:  [[0.15]]
grads:  [0.13259106]
Stock Position:  0.13259105753123962
Bond Position:  [-1.00304612]


portfolio before change:  [12.93955325]
curr_Stock_Price:  105.15537261562271
curr_Factors:  [105.15537262]
mat_Sqrt:  [[0.15]]
grads:  [0.08510193]
Stock Position:  0.08510192968937859
Bond Position:  [3.99062812]


portfolio before change:  [12.96568878]
curr_Stock_Price:  105.45955035349428
curr_Factors:  [105.45955035]
mat_Sqrt:  [[0.15]]
grads:  [-0.03542448]
Stock Position:  -0.035424484836707425
Bond Position:  [16.70153903]


portfolio before change:  [12.968205]
curr_Stock_Price:  105.4179875157314
curr_Factors:  [105.41798752]
mat_Sqrt:  [[0.15]]
grads:  [-0.28296101]
Stock Position:  -0.282961005338193
Bond Position:  [42.79738473]


portfolio before change:  [13.20826364]
curr_Stock_Price:  104.5790601878072
curr_Factors:  [104.57906019]
mat_Sqrt:  [[0.15]]
grads:  [-0.0566361]
Stock Position:  -0.05663610306927406
Bond Position:  [19.13121408]


portfolio before change:  [13.16797897]
curr_Stock_Price:  105.31146251416394
curr_Factors:  [105.31146251]
mat_Sqrt:  [[0.15]]
grads:  [-0.01705054]
Stock Position:  -0.017050540128306178
Bond Position:  [14.96359629]


portfolio before change:  [13.15288806]
curr_Stock_Price:  106.25138344329135
curr_Factors:  [106.25138344]
mat_Sqrt:  [[0.15]]
grads:  [0.00151976]
Stock Position:  0.0015197586652824307
Bond Position:  [12.9914116]


portfolio before change:  [13.15281418]
curr_Stock_Price:  105.6684825958776
curr_Factors:  [105.6684826]
mat_Sqrt:  [[0.15]]
grads:  [-0.10872138]
Stock Position:  -0.10872137960978003
Bond Position:  [24.64123739]


portfolio before change:  [13.14631168]
curr_Stock_Price:  105.74245729696685
curr_Factors:  [105.7424573]
mat_Sqrt:  [[0.15]]
grads:  [0.01185572]
Stock Position:  0.01185572493705181
Bond Position:  [11.89265819]


portfolio before change:  [13.1560991]
curr_Stock_Price:  106.5053049616972
curr_Factors:  [106.50530496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02057921]
Stock Position:  -0.02057921258249277
Bond Position:  [15.34789442]


portfolio before change:  [13.13014726]
curr_Stock_Price:  107.81298962009568
curr_Factors:  [107.81298962]
mat_Sqrt:  [[0.15]]
grads:  [-0.05074164]
Stock Position:  -0.050741643711847445
Bond Position:  [18.60075556]


portfolio before change:  [13.12594366]
curr_Stock_Price:  107.91874457124509
curr_Factors:  [107.91874457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352792]
Stock Position:  -0.03352792473955114
Bond Position:  [16.74423521]


portfolio before change:  [13.14216422]
curr_Stock_Price:  107.46616623157719
curr_Factors:  [107.46616623]
mat_Sqrt:  [[0.15]]
grads:  [-0.11457334]
Stock Position:  -0.11457333715881424
Bond Position:  [25.45492152]


portfolio before change:  [13.25392706]
curr_Stock_Price:  106.50458246702365
curr_Factors:  [106.50458247]
mat_Sqrt:  [[0.15]]
grads:  [0.00095961]
Stock Position:  0.000959609230872549
Bond Position:  [13.15172428]


portfolio before change:  [13.25458511]
curr_Stock_Price:  106.3337195009051
curr_Factors:  [106.3337195]
mat_Sqrt:  [[0.15]]
grads:  [0.02281323]
Stock Position:  0.0228132272627078
Bond Position:  [10.8287698]


portfolio before change:  [13.23227294]
curr_Stock_Price:  105.32601528723099
curr_Factors:  [105.32601529]
mat_Sqrt:  [[0.15]]
grads:  [0.11973749]
Stock Position:  0.11973748957040217
Bond Position:  [0.62080029]


portfolio before change:  [13.25634504]
curr_Stock_Price:  105.52673185273264
curr_Factors:  [105.52673185]
mat_Sqrt:  [[0.15]]
grads:  [0.01977369]
Stock Position:  0.019773689000896207
Bond Position:  [11.16969227]


portfolio before change:  [13.24937653]
curr_Stock_Price:  105.13901240638153
curr_Factors:  [105.13901241]
mat_Sqrt:  [[0.15]]
grads:  [0.08802435]
Stock Position:  0.0880243459924489
Bond Position:  [3.99458372]


portfolio before change:  [13.31019101]
curr_Stock_Price:  105.82705859536927
curr_Factors:  [105.8270586]
mat_Sqrt:  [[0.15]]
grads:  [0.05197762]
Stock Position:  0.05197761511025643
Bond Position:  [7.80955289]


portfolio before change:  [13.36642028]
curr_Stock_Price:  106.89946558453808
curr_Factors:  [106.89946558]
mat_Sqrt:  [[0.15]]
grads:  [0.07603105]
Stock Position:  0.07603104789189857
Bond Position:  [5.23874189]


portfolio before change:  [13.33048172]
curr_Stock_Price:  106.42247627426745
curr_Factors:  [106.42247627]
mat_Sqrt:  [[0.15]]
grads:  [0.03627192]
Stock Position:  0.03627191783259601
Bond Position:  [9.4703344]


portfolio before change:  [13.35756039]
curr_Stock_Price:  107.1527038697433
curr_Factors:  [107.15270387]
mat_Sqrt:  [[0.15]]
grads:  [-0.09808596]
Stock Position:  -0.09808595965287338
Bond Position:  [23.86773617]


portfolio before change:  [13.43587199]
curr_Stock_Price:  106.36951505037554
curr_Factors:  [106.36951505]
mat_Sqrt:  [[0.15]]
grads:  [-0.2030269]
Stock Position:  -0.20302690036363352
Bond Position:  [35.03174493]


portfolio before change:  [13.61476966]
curr_Stock_Price:  105.49914705640468
curr_Factors:  [105.49914706]
mat_Sqrt:  [[0.15]]
grads:  [0.00508859]
Stock Position:  0.0050885877860077896
Bond Position:  [13.07792799]


portfolio before change:  [13.61372876]
curr_Stock_Price:  105.13395781741522
curr_Factors:  [105.13395782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00386865]
Stock Position:  -0.0038686547538817227
Bond Position:  [14.02045575]


portfolio before change:  [13.61257726]
curr_Stock_Price:  105.6581219072565
curr_Factors:  [105.65812191]
mat_Sqrt:  [[0.15]]
grads:  [-0.14937545]
Stock Position:  -0.14937545348270734
Bond Position:  [29.39530713]


portfolio before change:  [13.53948348]
curr_Stock_Price:  106.15975077443035
curr_Factors:  [106.15975077]
mat_Sqrt:  [[0.15]]
grads:  [-0.03262999]
Stock Position:  -0.03262999193763599
Bond Position:  [17.00347529]


portfolio before change:  [13.52686922]
curr_Stock_Price:  106.57890535212124
curr_Factors:  [106.57890535]
mat_Sqrt:  [[0.15]]
grads:  [0.10945887]
Stock Position:  0.10945887101472346
Bond Position:  [1.86086257]


portfolio before change:  [13.48300198]
curr_Stock_Price:  106.1770781862428
curr_Factors:  [106.17707819]
mat_Sqrt:  [[0.15]]
grads:  [0.17160167]
Stock Position:  0.17160166655881873
Bond Position:  [-4.73716159]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.41490879]
Stock Price:  105.78199400144854
PL:  [7.63291479]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37446715e-02]
 [ 1.99500538e-02]
 [ 1.57444579e-02]
 [-1.16801970e-02]
 [-3.52553009e-02]
 [-1.12473989e-03]
 [-9.50239644e-03]
 [-4.00403915e-02]
 [ 1.73813124e-02]
 [-9.05503377e-03]
 [-1.38297317e-02]
 [ 2.50081160e-02]
 [-5.00817810e-03]
 [ 4.02698343e-03]
 [ 4.20614310e-03]
 [ 8.50674427e-03]
 [ 9.62449437e-02]
 [-8.93903434e-03]
 [ 2.51810821e-02]
 [-9.38316757e-04]
 [-9.60174112e-03]
 [ 7.44701750e-03]
 [ 3.95622029e-04]
 [ 5.30978305e-02]
 [ 4.09918390e-03]
 [ 6.89988984e-03]
 [ 5.64499979e-02]
 [ 3.23243600e-02]
 [ 1.37051000e-02]
 [-7.23762444e-03]
 [ 6.87676631e-04]
 [ 1.38625910e-02]
 [ 1.42498570e-02]
 [-4.72598809e-03]
 [ 4.79841585e-03]
 [ 9.31702262e-03]
 [-1.66802987e-02]
 [-8.32401909e-03]
 [-1.93127439e-02]
 [-2.07419430e-02]
 [ 3.68701288e-03]
 [ 9.16139340e-03]
 [-7.76247768e-03]
 [ 1.15291631e-03]
 [ 7.32597993e-03]
 [ 1.19617482e-02]
 [ 1.05716961e-02]
 [-1.67621698e-03]
 [ 1.41449199e-02]
 [-1.19085379e-03]
 [ 2.19320767e-02]
 [-1.56124768e-02]
 [ 2.00153915e-03]
 [-1.04521986e-03]
 [-2.76876723e-03]
 [-3.27632928e-03]
 [ 1.02710012e-02]
 [-1.84615653e-02]
 [ 3.08130274e-03]
 [-3.21844220e-03]
 [-5.76238806e-03]
 [ 4.95321839e-03]
 [-1.98884535e-02]
 [ 1.95240281e-03]
 [ 1.77080870e-02]
 [ 1.02217282e-02]
 [ 1.41230243e-02]
 [ 9.66652950e-03]
 [ 7.00140290e-03]
 [ 1.09750510e-02]
 [ 3.38843448e-03]
 [-1.49867571e-02]
 [-2.53247070e-02]
 [ 7.64677394e-04]
 [-4.55380556e-04]
 [-2.05235104e-02]
 [-4.08518208e-03]
 [ 1.19290478e-02]
 [-3.99133862e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.48595423]
curr_Stock_Price:  99.65864477920874
curr_Factors:  [99.65864478]
mat_Sqrt:  [[0.15]]
grads:  [-0.09163114]
Stock Position:  -0.09163114343136508
Bond Position:  [3.64588134]


portfolio before change:  [-5.55234223]
curr_Stock_Price:  100.38564513839877
curr_Factors:  [100.38564514]
mat_Sqrt:  [[0.15]]
grads:  [0.13300036]
Stock Position:  0.1330003588041119
Bond Position:  [-18.90366905]


portfolio before change:  [-5.54754666]
curr_Stock_Price:  100.43058556171387
curr_Factors:  [100.43058556]
mat_Sqrt:  [[0.15]]
grads:  [0.10496305]
Stock Position:  0.10496305267970976
Bond Position:  [-16.0890475]


portfolio before change:  [-5.54367772]
curr_Stock_Price:  100.47702598882823
curr_Factors:  [100.47702599]
mat_Sqrt:  [[0.15]]
grads:  [-0.07786798]
Stock Position:  -0.07786798004950392
Bond Position:  [2.28026533]


portfolio before change:  [-5.62351009]
curr_Stock_Price:  101.50408344128726
curr_Factors:  [101.50408344]
mat_Sqrt:  [[0.15]]
grads:  [-0.23503534]
Stock Position:  -0.235035339532611
Bond Position:  [18.23353662]


portfolio before change:  [-5.51279763]
curr_Stock_Price:  101.03788620204173
curr_Factors:  [101.0378862]
mat_Sqrt:  [[0.15]]
grads:  [-0.00749827]
Stock Position:  -0.00749826592525747
Bond Position:  [-4.75518869]


portfolio before change:  [-5.51154884]
curr_Stock_Price:  100.83170430019402
curr_Factors:  [100.8317043]
mat_Sqrt:  [[0.15]]
grads:  [-0.06334931]
Stock Position:  -0.06334930962317933
Bond Position:  [0.87607002]


portfolio before change:  [-5.56947396]
curr_Stock_Price:  101.74694525266943
curr_Factors:  [101.74694525]
mat_Sqrt:  [[0.15]]
grads:  [-0.26693594]
Stock Position:  -0.2669359431210448
Bond Position:  [21.59044283]


portfolio before change:  [-5.81780194]
curr_Stock_Price:  102.6822910783456
curr_Factors:  [102.68229108]
mat_Sqrt:  [[0.15]]
grads:  [0.11587542]
Stock Position:  0.11587541613311164
Bond Position:  [-17.71615515]


portfolio before change:  [-5.71126364]
curr_Stock_Price:  103.6112680525627
curr_Factors:  [103.61126805]
mat_Sqrt:  [[0.15]]
grads:  [-0.06036689]
Stock Position:  -0.0603668918265365
Bond Position:  [0.54342657]


portfolio before change:  [-5.72181992]
curr_Stock_Price:  103.78669944075027
curr_Factors:  [103.78669944]
mat_Sqrt:  [[0.15]]
grads:  [-0.09219821]
Stock Position:  -0.09219821144790347
Bond Position:  [3.84712814]


portfolio before change:  [-5.75463131]
curr_Stock_Price:  104.14518626997707
curr_Factors:  [104.14518627]
mat_Sqrt:  [[0.15]]
grads:  [0.16672077]
Stock Position:  0.1667207734956412
Bond Position:  [-23.11779732]


portfolio before change:  [-5.90262234]
curr_Stock_Price:  103.2661948909144
curr_Factors:  [103.26619489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03338785]
Stock Position:  -0.033387854024257736
Bond Position:  [-2.4547857]


portfolio before change:  [-5.88780506]
curr_Stock_Price:  102.81780685523518
curr_Factors:  [102.81780686]
mat_Sqrt:  [[0.15]]
grads:  [0.02684656]
Stock Position:  0.0268465561765557
Bond Position:  [-8.64810908]


portfolio before change:  [-5.90916368]
curr_Stock_Price:  102.04235936129724
curr_Factors:  [102.04235936]
mat_Sqrt:  [[0.15]]
grads:  [0.02804095]
Stock Position:  0.02804095401779348
Bond Position:  [-8.77052878]


portfolio before change:  [-5.86273757]
curr_Stock_Price:  103.71756193365636
curr_Factors:  [103.71756193]
mat_Sqrt:  [[0.15]]
grads:  [0.05671163]
Stock Position:  0.05671162848059001
Bond Position:  [-11.74472941]


portfolio before change:  [-5.87784056]
curr_Stock_Price:  103.46419383853186
curr_Factors:  [103.46419384]
mat_Sqrt:  [[0.15]]
grads:  [0.64163296]
Stock Position:  0.6416329579548158
Bond Position:  [-72.26387729]


portfolio before change:  [-5.62969781]
curr_Stock_Price:  103.8579694008506
curr_Factors:  [103.8579694]
mat_Sqrt:  [[0.15]]
grads:  [-0.05959356]
Stock Position:  -0.059593562235316797
Bond Position:  [0.55956855]


portfolio before change:  [-5.63883124]
curr_Stock_Price:  104.0118182353008
curr_Factors:  [104.01181824]
mat_Sqrt:  [[0.15]]
grads:  [0.16787388]
Stock Position:  0.16787388045476936
Bond Position:  [-23.09969878]


portfolio before change:  [-5.44697954]
curr_Stock_Price:  105.16325092782121
curr_Factors:  [105.16325093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00625545]
Stock Position:  -0.006255445046781912
Bond Position:  [-4.7891366]


portfolio before change:  [-5.44649847]
curr_Stock_Price:  105.0384950208368
curr_Factors:  [105.03849502]
mat_Sqrt:  [[0.15]]
grads:  [-0.06401161]
Stock Position:  -0.0640116074778324
Bond Position:  [1.27718445]


portfolio before change:  [-5.41918708]
curr_Stock_Price:  104.61307899719769
curr_Factors:  [104.613079]
mat_Sqrt:  [[0.15]]
grads:  [0.04964678]
Stock Position:  0.04964678331278393
Bond Position:  [-10.61288994]


portfolio before change:  [-5.45907654]
curr_Stock_Price:  103.82297470083935
curr_Factors:  [103.8229747]
mat_Sqrt:  [[0.15]]
grads:  [0.00263748]
Stock Position:  0.0026374801960820163
Bond Position:  [-5.73290758]


portfolio before change:  [-5.45851623]
curr_Stock_Price:  104.17127428775764
curr_Factors:  [104.17127429]
mat_Sqrt:  [[0.15]]
grads:  [0.35398554]
Stock Position:  0.35398553680341754
Bond Position:  [-42.33364067]


portfolio before change:  [-5.64386456]
curr_Stock_Price:  103.65514472090445
curr_Factors:  [103.65514472]
mat_Sqrt:  [[0.15]]
grads:  [0.02732789]
Stock Position:  0.027327892661152403
Bond Position:  [-8.47654123]


portfolio before change:  [-5.63503752]
curr_Stock_Price:  103.9975363559507
curr_Factors:  [103.99753636]
mat_Sqrt:  [[0.15]]
grads:  [0.04599927]
Stock Position:  0.04599926557622207
Bond Position:  [-10.41884782]


portfolio before change:  [-5.64002981]
curr_Stock_Price:  103.9031634147241
curr_Factors:  [103.90316341]
mat_Sqrt:  [[0.15]]
grads:  [0.37633332]
Stock Position:  0.3763333191240056
Bond Position:  [-44.74225216]


portfolio before change:  [-5.29058328]
curr_Stock_Price:  104.83915018008051
curr_Factors:  [104.83915018]
mat_Sqrt:  [[0.15]]
grads:  [0.21549573]
Stock Position:  0.21549573305264358
Bond Position:  [-27.8829728]


portfolio before change:  [-5.5766154]
curr_Stock_Price:  103.51991579993337
curr_Factors:  [103.5199158]
mat_Sqrt:  [[0.15]]
grads:  [0.09136733]
Stock Position:  0.09136733359372022
Bond Position:  [-15.03495408]


portfolio before change:  [-5.59171479]
curr_Stock_Price:  103.36494056159277
curr_Factors:  [103.36494056]
mat_Sqrt:  [[0.15]]
grads:  [-0.04825083]
Stock Position:  -0.0482508295971174
Bond Position:  [-0.60427065]


portfolio before change:  [-5.57702928]
curr_Stock_Price:  103.05980013800426
curr_Factors:  [103.05980014]
mat_Sqrt:  [[0.15]]
grads:  [0.00458451]
Stock Position:  0.004584510876539556
Bond Position:  [-6.04950805]


portfolio before change:  [-5.57986328]
curr_Stock_Price:  102.5241057326366
curr_Factors:  [102.52410573]
mat_Sqrt:  [[0.15]]
grads:  [0.09241727]
Stock Position:  0.09241727337567868
Bond Position:  [-15.05486159]


portfolio before change:  [-5.52362]
curr_Stock_Price:  103.14286711314794
curr_Factors:  [103.14286711]
mat_Sqrt:  [[0.15]]
grads:  [0.09499905]
Stock Position:  0.0949990465790226
Bond Position:  [-15.32209403]


portfolio before change:  [-5.50287555]
curr_Stock_Price:  103.37131263433736
curr_Factors:  [103.37131263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03150659]
Stock Position:  -0.03150658728472477
Bond Position:  [-2.24599827]


portfolio before change:  [-5.49674006]
curr_Stock_Price:  103.17212017908717
curr_Factors:  [103.17212018]
mat_Sqrt:  [[0.15]]
grads:  [0.03198944]
Stock Position:  0.031989439030859476
Bond Position:  [-8.7971583]


portfolio before change:  [-5.51480524]
curr_Stock_Price:  102.62458502976065
curr_Factors:  [102.62458503]
mat_Sqrt:  [[0.15]]
grads:  [0.06211348]
Stock Position:  0.06211348412714283
Bond Position:  [-11.88917577]


portfolio before change:  [-5.48310941]
curr_Stock_Price:  103.14683752688843
curr_Factors:  [103.14683753]
mat_Sqrt:  [[0.15]]
grads:  [-0.11120199]
Stock Position:  -0.11120199153367497
Bond Position:  [5.98702434]


portfolio before change:  [-5.53182783]
curr_Stock_Price:  103.58831000842187
curr_Factors:  [103.58831001]
mat_Sqrt:  [[0.15]]
grads:  [-0.05549346]
Stock Position:  -0.05549346059723764
Bond Position:  [0.21664597]


portfolio before change:  [-5.51248214]
curr_Stock_Price:  103.23994188195127
curr_Factors:  [103.23994188]
mat_Sqrt:  [[0.15]]
grads:  [-0.12875163]
Stock Position:  -0.1287516257162042
Bond Position:  [7.77982822]


portfolio before change:  [-5.56372231]
curr_Stock_Price:  103.64169545499577
curr_Factors:  [103.64169545]
mat_Sqrt:  [[0.15]]
grads:  [-0.13827962]
Stock Position:  -0.13827961974079617
Bond Position:  [8.76781193]


portfolio before change:  [-5.5420502]
curr_Stock_Price:  103.48893174675037
curr_Factors:  [103.48893175]
mat_Sqrt:  [[0.15]]
grads:  [0.02458009]
Stock Position:  0.024580085898337094
Bond Position:  [-8.08581703]


portfolio before change:  [-5.54779096]
curr_Stock_Price:  103.27593878674989
curr_Factors:  [103.27593879]
mat_Sqrt:  [[0.15]]
grads:  [0.06107596]
Stock Position:  0.06107595601897078
Bond Position:  [-11.85546765]


portfolio before change:  [-5.58438621]
curr_Stock_Price:  102.68889500970566
curr_Factors:  [102.68889501]
mat_Sqrt:  [[0.15]]
grads:  [-0.05174985]
Stock Position:  -0.05174985122383629
Bond Position:  [-0.27025117]


portfolio before change:  [-5.59880277]
curr_Stock_Price:  102.96715036300075
curr_Factors:  [102.96715036]
mat_Sqrt:  [[0.15]]
grads:  [0.00768611]
Stock Position:  0.007686108750343564
Bond Position:  [-6.39021949]


portfolio before change:  [-5.59935194]
curr_Stock_Price:  102.94766567428772
curr_Factors:  [102.94766567]
mat_Sqrt:  [[0.15]]
grads:  [0.04883987]
Stock Position:  0.048839866212708916
Bond Position:  [-10.62730215]


portfolio before change:  [-5.58716151]
curr_Stock_Price:  103.21086560156256
curr_Factors:  [103.2108656]
mat_Sqrt:  [[0.15]]
grads:  [0.07974499]
Stock Position:  0.07974498818125941
Bond Position:  [-13.81771077]


portfolio before change:  [-5.57143943]
curr_Stock_Price:  103.41885000448319
curr_Factors:  [103.41885]
mat_Sqrt:  [[0.15]]
grads:  [0.07047797]
Stock Position:  0.07047797370292158
Bond Position:  [-12.86019043]


portfolio before change:  [-5.59195603]
curr_Stock_Price:  103.13914831081469
curr_Factors:  [103.13914831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117478]
Stock Position:  -0.011174779857252402
Bond Position:  [-4.43939875]


portfolio before change:  [-5.57504756]
curr_Stock_Price:  101.6012265720126
curr_Factors:  [101.60122657]
mat_Sqrt:  [[0.15]]
grads:  [0.09429947]
Stock Position:  0.09429946601404439
Bond Position:  [-15.15598898]


portfolio before change:  [-5.56381815]
curr_Stock_Price:  101.7303544607756
curr_Factors:  [101.73035446]
mat_Sqrt:  [[0.15]]
grads:  [-0.00793903]
Stock Position:  -0.007939025273289473
Bond Position:  [-4.7561783]


portfolio before change:  [-5.57180259]
curr_Stock_Price:  102.6986305731443
curr_Factors:  [102.69863057]
mat_Sqrt:  [[0.15]]
grads:  [0.14621384]
Stock Position:  0.14621384475346688
Bond Position:  [-20.58776422]


portfolio before change:  [-5.80815786]
curr_Stock_Price:  101.09092721662678
curr_Factors:  [101.09092722]
mat_Sqrt:  [[0.15]]
grads:  [-0.10408318]
Stock Position:  -0.10408317837052392
Bond Position:  [4.71370715]


portfolio before change:  [-5.82156316]
curr_Stock_Price:  101.22255196245732
curr_Factors:  [101.22255196]
mat_Sqrt:  [[0.15]]
grads:  [0.01334359]
Stock Position:  0.013343594331361407
Bond Position:  [-7.17223583]


portfolio before change:  [-5.81898595]
curr_Stock_Price:  101.4492892974552
curr_Factors:  [101.4492893]
mat_Sqrt:  [[0.15]]
grads:  [-0.00696813]
Stock Position:  -0.006968132370455266
Bond Position:  [-5.11207387]


portfolio before change:  [-5.82418095]
curr_Stock_Price:  102.14897302337128
curr_Factors:  [102.14897302]
mat_Sqrt:  [[0.15]]
grads:  [-0.01845845]
Stock Position:  -0.018458448205239984
Bond Position:  [-3.93866943]


portfolio before change:  [-5.82607676]
curr_Stock_Price:  102.23834280979545
curr_Factors:  [102.23834281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0218422]
Stock Position:  -0.021842195221832842
Bond Position:  [-3.59296691]


portfolio before change:  [-5.84965066]
curr_Stock_Price:  103.3073441012276
curr_Factors:  [103.3073441]
mat_Sqrt:  [[0.15]]
grads:  [0.06847334]
Stock Position:  0.06847334128527523
Bond Position:  [-12.92344969]


portfolio before change:  [-5.78168629]
curr_Stock_Price:  104.3117073463705
curr_Factors:  [104.31170735]
mat_Sqrt:  [[0.15]]
grads:  [-0.1230771]
Stock Position:  -0.12307710190801888
Bond Position:  [7.05669634]


portfolio before change:  [-5.8429796]
curr_Stock_Price:  104.81329832548442
curr_Factors:  [104.81329833]
mat_Sqrt:  [[0.15]]
grads:  [0.02054202]
Stock Position:  0.02054201823781174
Bond Position:  [-7.99605628]


portfolio before change:  [-5.83542898]
curr_Stock_Price:  105.20519680657404
curr_Factors:  [105.20519681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02145628]
Stock Position:  -0.021456281329201264
Bond Position:  [-3.57811668]


portfolio before change:  [-5.82725248]
curr_Stock_Price:  104.81369674419668
curr_Factors:  [104.81369674]
mat_Sqrt:  [[0.15]]
grads:  [-0.03841592]
Stock Position:  -0.03841592036770715
Bond Position:  [-1.80073786]


portfolio before change:  [-5.80017101]
curr_Stock_Price:  104.10581238062873
curr_Factors:  [104.10581238]
mat_Sqrt:  [[0.15]]
grads:  [0.03302146]
Stock Position:  0.0330214559296573
Bond Position:  [-9.2378965]


portfolio before change:  [-5.80347795]
curr_Stock_Price:  104.02315223242093
curr_Factors:  [104.02315223]
mat_Sqrt:  [[0.15]]
grads:  [-0.13258969]
Stock Position:  -0.13258968984243405
Bond Position:  [7.98891954]


portfolio before change:  [-5.70791926]
curr_Stock_Price:  103.30620838107468
curr_Factors:  [103.30620838]
mat_Sqrt:  [[0.15]]
grads:  [0.01301602]
Stock Position:  0.013016018734086148
Bond Position:  [-7.05255481]


portfolio before change:  [-5.70079216]
curr_Stock_Price:  103.88763865589064
curr_Factors:  [103.88763866]
mat_Sqrt:  [[0.15]]
grads:  [0.11805391]
Stock Position:  0.11805391325634756
Bond Position:  [-17.96513444]


portfolio before change:  [-5.76257988]
curr_Stock_Price:  103.37376436504624
curr_Factors:  [103.37376437]
mat_Sqrt:  [[0.15]]
grads:  [0.06814485]
Stock Position:  0.06814485434598168
Bond Position:  [-12.80697]


portfolio before change:  [-5.7892948]
curr_Stock_Price:  102.99347951901262
curr_Factors:  [102.99347952]
mat_Sqrt:  [[0.15]]
grads:  [0.0941535]
Stock Position:  0.09415349544089531
Bond Position:  [-15.4864909]


portfolio before change:  [-5.71979336]
curr_Stock_Price:  103.7419315650063
curr_Factors:  [103.74193157]
mat_Sqrt:  [[0.15]]
grads:  [0.06444353]
Stock Position:  0.06444352997743837
Bond Position:  [-12.40528963]


portfolio before change:  [-5.67029736]
curr_Stock_Price:  104.52201529860646
curr_Factors:  [104.5220153]
mat_Sqrt:  [[0.15]]
grads:  [0.04667602]
Stock Position:  0.04667601935166362
Bond Position:  [-10.54896897]


portfolio before change:  [-5.67096185]
curr_Stock_Price:  104.52190493882617
curr_Factors:  [104.52190494]
mat_Sqrt:  [[0.15]]
grads:  [0.07316701]
Stock Position:  0.07316700674531643
Bond Position:  [-13.31851677]


portfolio before change:  [-5.61709492]
curr_Stock_Price:  105.26950090003737
curr_Factors:  [105.2695009]
mat_Sqrt:  [[0.15]]
grads:  [0.02258956]
Stock Position:  0.022589563173901792
Bond Position:  [-7.99508696]


portfolio before change:  [-5.60763524]
curr_Stock_Price:  105.71038538808077
curr_Factors:  [105.71038539]
mat_Sqrt:  [[0.15]]
grads:  [-0.09991171]
Stock Position:  -0.09991171377620105
Bond Position:  [4.95407053]


portfolio before change:  [-5.61878196]
curr_Stock_Price:  105.82505021690785
curr_Factors:  [105.82505022]
mat_Sqrt:  [[0.15]]
grads:  [-0.16883138]
Stock Position:  -0.16883138031442138
Bond Position:  [12.24780734]


portfolio before change:  [-5.56075549]
curr_Stock_Price:  105.48588955019504
curr_Factors:  [105.48588955]
mat_Sqrt:  [[0.15]]
grads:  [0.00509785]
Stock Position:  0.0050978492901149145
Bond Position:  [-6.09850665]


portfolio before change:  [-5.5631445]
curr_Stock_Price:  105.092027799366
curr_Factors:  [105.0920278]
mat_Sqrt:  [[0.15]]
grads:  [-0.00303587]
Stock Position:  -0.0030358703719058494
Bond Position:  [-5.24409873]


portfolio before change:  [-5.56260814]
curr_Stock_Price:  104.80738862464794
curr_Factors:  [104.80738862]
mat_Sqrt:  [[0.15]]
grads:  [-0.1368234]
Stock Position:  -0.13682340252751837
Bond Position:  [8.77749538]


portfolio before change:  [-5.54960693]
curr_Stock_Price:  104.71637641158631
curr_Factors:  [104.71637641]
mat_Sqrt:  [[0.15]]
grads:  [-0.02723455]
Stock Position:  -0.027234547216314454
Bond Position:  [-2.69770383]


portfolio before change:  [-5.51479121]
curr_Stock_Price:  103.4318191868362
curr_Factors:  [103.43181919]
mat_Sqrt:  [[0.15]]
grads:  [0.07952699]
Stock Position:  0.07952698512860817
Bond Position:  [-13.74041195]


portfolio before change:  [-5.56113637]
curr_Stock_Price:  102.85985780781728
curr_Factors:  [102.85985781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02660892]
Stock Position:  -0.026608924110284208
Bond Position:  [-2.82414622]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.54112811]
Stock Price:  102.101285953667
PL:  [-7.64241406]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-8.12581705e-03]
 [-1.67163863e-02]
 [ 2.82240726e-02]
 [-1.20268485e-02]
 [ 1.09832220e-02]
 [-1.58531910e-02]
 [-1.35559856e-02]
 [ 4.77001002e-02]
 [-2.08628204e-02]
 [-1.30698016e-02]
 [ 1.13420333e-02]
 [-7.60179068e-03]
 [ 3.86224640e-03]
 [-5.14583254e-03]
 [ 1.06459421e-03]
 [ 4.06577580e-03]
 [-1.55134771e-02]
 [-1.23690005e-02]
 [ 2.31056125e-02]
 [ 1.24744958e-03]
 [-3.93919407e-03]
 [ 4.12583884e-03]
 [ 1.59366418e-02]
 [ 1.74702601e-02]
 [-4.47271387e-03]
 [ 4.51821861e-03]
 [ 3.49373958e-03]
 [ 7.92204151e-03]
 [ 2.62367515e-02]
 [ 1.51586240e-03]
 [-7.05520818e-03]
 [ 9.64004549e-03]
 [ 1.21548836e-02]
 [-1.12706881e-02]
 [ 7.97914339e-03]
 [ 1.35151707e-02]
 [-2.41255425e-02]
 [ 3.33088921e-03]
 [-5.10713830e-02]
 [-1.01584523e-02]
 [ 7.00631151e-03]
 [ 2.17219979e-03]
 [-1.53486665e-03]
 [-5.47606614e-04]
 [-4.81661035e-03]
 [ 1.61960760e-02]
 [ 9.90540650e-03]
 [ 5.34773402e-03]
 [-8.28339770e-03]
 [-1.97133819e-04]
 [-3.28294529e-03]
 [-2.63339332e-03]
 [-4.22336400e-04]
 [ 7.79271588e-03]
 [-1.16535529e-02]
 [-4.96328556e-03]
 [-1.90047768e-03]
 [ 1.29211303e-02]
 [ 6.95530999e-03]
 [-2.82600057e-03]
 [-5.12333455e-03]
 [-2.59358332e-03]
 [-2.03204714e-03]
 [-3.75662855e-03]
 [ 1.84528125e-02]
 [ 6.11776573e-03]
 [ 1.94237194e-02]
 [-2.96836238e-03]
 [ 6.43602879e-03]
 [ 2.68760661e-02]
 [ 3.12315884e-03]
 [-1.52497575e-02]
 [-5.78920066e-03]
 [ 2.46550716e-03]
 [ 1.07950262e-02]
 [ 3.18831996e-03]
 [-9.87637314e-04]
 [-1.69050245e-02]
 [-3.16925791e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.60210597]
curr_Stock_Price:  100.1168238003667
curr_Factors:  [100.1168238]
mat_Sqrt:  [[0.15]]
grads:  [-0.05417211]
Stock Position:  -0.05417211368676082
Bond Position:  [10.02564593]


portfolio before change:  [4.65964416]
curr_Stock_Price:  99.06625434535457
curr_Factors:  [99.06625435]
mat_Sqrt:  [[0.15]]
grads:  [-0.11144258]
Stock Position:  -0.11144257506666484
Bond Position:  [15.69984265]


portfolio before change:  [4.66171346]
curr_Stock_Price:  99.05649125309407
curr_Factors:  [99.05649125]
mat_Sqrt:  [[0.15]]
grads:  [0.18816048]
Stock Position:  0.18816048381914138
Bond Position:  [-13.97680386]


portfolio before change:  [4.5286766]
curr_Stock_Price:  98.35409467850597
curr_Factors:  [98.35409468]
mat_Sqrt:  [[0.15]]
grads:  [-0.08017899]
Stock Position:  -0.08017898992206439
Bond Position:  [12.41460857]


portfolio before change:  [4.52307271]
curr_Stock_Price:  98.4336645495766
curr_Factors:  [98.43366455]
mat_Sqrt:  [[0.15]]
grads:  [0.07322148]
Stock Position:  0.07322148006269137
Bond Position:  [-2.6843859]


portfolio before change:  [4.49592448]
curr_Stock_Price:  98.06518739630296
curr_Factors:  [98.0651874]
mat_Sqrt:  [[0.15]]
grads:  [-0.10568794]
Stock Position:  -0.10568794013179224
Bond Position:  [14.86023214]


portfolio before change:  [4.50417298]
curr_Stock_Price:  97.99592967262844
curr_Factors:  [97.99592967]
mat_Sqrt:  [[0.15]]
grads:  [-0.09037324]
Stock Position:  -0.09037323718057721
Bond Position:  [13.36038238]


portfolio before change:  [4.49857075]
curr_Stock_Price:  98.06715960515959
curr_Factors:  [98.06715961]
mat_Sqrt:  [[0.15]]
grads:  [0.31800067]
Stock Position:  0.31800066802408655
Bond Position:  [-26.68685151]


portfolio before change:  [4.46354687]
curr_Stock_Price:  97.96226703950013
curr_Factors:  [97.96226704]
mat_Sqrt:  [[0.15]]
grads:  [-0.13908547]
Stock Position:  -0.13908546937250926
Bond Position:  [18.08867476]


portfolio before change:  [4.43781718]
curr_Stock_Price:  98.15538760129623
curr_Factors:  [98.1553876]
mat_Sqrt:  [[0.15]]
grads:  [-0.08713201]
Stock Position:  -0.0871320107930626
Bond Position:  [12.99029347]


portfolio before change:  [4.39441956]
curr_Stock_Price:  98.66277339369978
curr_Factors:  [98.66277339]
mat_Sqrt:  [[0.15]]
grads:  [0.07561356]
Stock Position:  0.07561355527268497
Bond Position:  [-3.06582351]


portfolio before change:  [4.40154643]
curr_Stock_Price:  98.75956148401461
curr_Factors:  [98.75956148]
mat_Sqrt:  [[0.15]]
grads:  [-0.0506786]
Stock Position:  -0.05067860451349227
Bond Position:  [9.40654319]


portfolio before change:  [4.443177]
curr_Stock_Price:  97.94970003778651
curr_Factors:  [97.94970004]
mat_Sqrt:  [[0.15]]
grads:  [0.02574831]
Stock Position:  0.025748309336447728
Bond Position:  [1.92113783]


portfolio before change:  [4.44003218]
curr_Stock_Price:  97.82289957379747
curr_Factors:  [97.82289957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03430555]
Stock Position:  -0.03430555029377618
Bond Position:  [7.79590058]


portfolio before change:  [4.45225085]
curr_Stock_Price:  97.48093129652202
curr_Factors:  [97.4809313]
mat_Sqrt:  [[0.15]]
grads:  [0.00709729]
Stock Position:  0.0070972947630873594
Bond Position:  [3.76039994]


portfolio before change:  [4.45472758]
curr_Stock_Price:  97.79678463199531
curr_Factors:  [97.79678463]
mat_Sqrt:  [[0.15]]
grads:  [0.02710517]
Stock Position:  0.027105171985001945
Bond Position:  [1.80392892]


portfolio before change:  [4.45912457]
curr_Stock_Price:  97.95484453814186
curr_Factors:  [97.95484454]
mat_Sqrt:  [[0.15]]
grads:  [-0.10342318]
Stock Position:  -0.1034231806965757
Bond Position:  [14.58992616]


portfolio before change:  [4.46441612]
curr_Stock_Price:  97.91249766798268
curr_Factors:  [97.91249767]
mat_Sqrt:  [[0.15]]
grads:  [-0.08246]
Stock Position:  -0.08246000310553277
Bond Position:  [12.53828098]


portfolio before change:  [4.36851697]
curr_Stock_Price:  99.08497910614341
curr_Factors:  [99.08497911]
mat_Sqrt:  [[0.15]]
grads:  [0.15403742]
Stock Position:  0.15403741685020772
Bond Position:  [-10.89427726]


portfolio before change:  [4.37752824]
curr_Stock_Price:  99.1479000845512
curr_Factors:  [99.14790008]
mat_Sqrt:  [[0.15]]
grads:  [0.00831633]
Stock Position:  0.008316330509980256
Bond Position:  [3.55298153]


portfolio before change:  [4.38393925]
curr_Stock_Price:  99.89209132339647
curr_Factors:  [99.89209132]
mat_Sqrt:  [[0.15]]
grads:  [-0.02626129]
Stock Position:  -0.026261293773112895
Bond Position:  [7.0072348]


portfolio before change:  [4.37408934]
curr_Stock_Price:  100.28384156019075
curr_Factors:  [100.28384156]
mat_Sqrt:  [[0.15]]
grads:  [0.02750559]
Stock Position:  0.027505592250624246
Bond Position:  [1.61572289]


portfolio before change:  [4.36448277]
curr_Stock_Price:  99.93091113351954
curr_Factors:  [99.93091113]
mat_Sqrt:  [[0.15]]
grads:  [0.10624428]
Stock Position:  0.10624427852280456
Bond Position:  [-6.25260479]


portfolio before change:  [4.35392752]
curr_Stock_Price:  99.83524055557935
curr_Factors:  [99.83524056]
mat_Sqrt:  [[0.15]]
grads:  [0.1164684]
Stock Position:  0.11646840079902243
Bond Position:  [-7.27372329]


portfolio before change:  [4.39422206]
curr_Stock_Price:  100.18511370872179
curr_Factors:  [100.18511371]
mat_Sqrt:  [[0.15]]
grads:  [-0.02981809]
Stock Position:  -0.02981809245053279
Bond Position:  [7.38155104]


portfolio before change:  [4.41499228]
curr_Stock_Price:  99.504021919476
curr_Factors:  [99.50402192]
mat_Sqrt:  [[0.15]]
grads:  [0.03012146]
Stock Position:  0.030121457396523662
Bond Position:  [1.41778612]


portfolio before change:  [4.42131607]
curr_Stock_Price:  99.71102285670145
curr_Factors:  [99.71102286]
mat_Sqrt:  [[0.15]]
grads:  [0.0232916]
Stock Position:  0.02329159716943577
Bond Position:  [2.09888709]


portfolio before change:  [4.41068429]
curr_Stock_Price:  99.24892662574658
curr_Factors:  [99.24892663]
mat_Sqrt:  [[0.15]]
grads:  [0.05281361]
Stock Position:  0.052813610067278714
Bond Position:  [-0.83100982]


portfolio before change:  [4.45947603]
curr_Stock_Price:  100.17375785078933
curr_Factors:  [100.17375785]
mat_Sqrt:  [[0.15]]
grads:  [0.17491168]
Stock Position:  0.1749116767539571
Bond Position:  [-13.06208393]


portfolio before change:  [4.4729749]
curr_Stock_Price:  100.25560075537767
curr_Factors:  [100.25560076]
mat_Sqrt:  [[0.15]]
grads:  [0.01010575]
Stock Position:  0.010105749318374501
Bond Position:  [3.45981693]


portfolio before change:  [4.46710465]
curr_Stock_Price:  99.6533204278257
curr_Factors:  [99.65332043]
mat_Sqrt:  [[0.15]]
grads:  [-0.04703472]
Stock Position:  -0.04703472119696249
Bond Position:  [9.15427079]


portfolio before change:  [4.46316325]
curr_Stock_Price:  99.74928286243846
curr_Factors:  [99.74928286]
mat_Sqrt:  [[0.15]]
grads:  [0.06426697]
Stock Position:  0.06426696990990553
Bond Position:  [-1.94742091]


portfolio before change:  [4.47584679]
curr_Stock_Price:  99.94853396941686
curr_Factors:  [99.94853397]
mat_Sqrt:  [[0.15]]
grads:  [0.08103256]
Stock Position:  0.08103255721717285
Bond Position:  [-3.6232385]


portfolio before change:  [4.41711832]
curr_Stock_Price:  99.22657701509372
curr_Factors:  [99.22657702]
mat_Sqrt:  [[0.15]]
grads:  [-0.07513792]
Stock Position:  -0.07513792049954254
Bond Position:  [11.87279697]


portfolio before change:  [4.38327358]
curr_Stock_Price:  99.68688803763149
curr_Factors:  [99.68688804]
mat_Sqrt:  [[0.15]]
grads:  [0.05319429]
Stock Position:  0.05319428926953601
Bond Position:  [-0.91949958]


portfolio before change:  [4.40274632]
curr_Stock_Price:  100.05403680909421
curr_Factors:  [100.05403681]
mat_Sqrt:  [[0.15]]
grads:  [0.09010114]
Stock Position:  0.0901011382245162
Bond Position:  [-4.61223628]


portfolio before change:  [4.43610626]
curr_Stock_Price:  100.42748615307816
curr_Factors:  [100.42748615]
mat_Sqrt:  [[0.15]]
grads:  [-0.16083695]
Stock Position:  -0.16083694999685272
Bond Position:  [20.58855683]


portfolio before change:  [4.3916902]
curr_Stock_Price:  100.71164277622368
curr_Factors:  [100.71164278]
mat_Sqrt:  [[0.15]]
grads:  [0.02220593]
Stock Position:  0.0222059280741772
Bond Position:  [2.1552947]


portfolio before change:  [4.36150573]
curr_Stock_Price:  99.34627852961016
curr_Factors:  [99.34627853]
mat_Sqrt:  [[0.15]]
grads:  [-0.34047589]
Stock Position:  -0.3404758864325016
Bond Position:  [38.18651798]


portfolio before change:  [4.25938933]
curr_Stock_Price:  99.65321108303594
curr_Factors:  [99.65321108]
mat_Sqrt:  [[0.15]]
grads:  [-0.06772302]
Stock Position:  -0.06772301521229035
Bond Position:  [11.00820526]


portfolio before change:  [4.22692598]
curr_Stock_Price:  100.1427253609158
curr_Factors:  [100.14272536]
mat_Sqrt:  [[0.15]]
grads:  [0.04670874]
Stock Position:  0.04670874337273568
Bond Position:  [-0.45061488]


portfolio before change:  [4.19151755]
curr_Stock_Price:  99.3852596825667
curr_Factors:  [99.38525968]
mat_Sqrt:  [[0.15]]
grads:  [0.01448133]
Stock Position:  0.014481331922139528
Bond Position:  [2.75228661]


portfolio before change:  [4.19765685]
curr_Stock_Price:  99.79732680860643
curr_Factors:  [99.79732681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023244]
Stock Position:  -0.010232444307371732
Bond Position:  [5.21882744]


portfolio before change:  [4.20703235]
curr_Stock_Price:  98.91295186739603
curr_Factors:  [98.91295187]
mat_Sqrt:  [[0.15]]
grads:  [-0.00365071]
Stock Position:  -0.0036507107568947705
Bond Position:  [4.56813493]


portfolio before change:  [4.21034697]
curr_Stock_Price:  98.08322353051153
curr_Factors:  [98.08322353]
mat_Sqrt:  [[0.15]]
grads:  [-0.03211074]
Stock Position:  -0.03211073566297881
Bond Position:  [7.35987143]


portfolio before change:  [4.21143937]
curr_Stock_Price:  98.06352927177016
curr_Factors:  [98.06352927]
mat_Sqrt:  [[0.15]]
grads:  [0.10797384]
Stock Position:  0.10797384018497605
Bond Position:  [-6.37685646]


portfolio before change:  [4.11435293]
curr_Stock_Price:  97.16805422800684
curr_Factors:  [97.16805423]
mat_Sqrt:  [[0.15]]
grads:  [0.06603604]
Stock Position:  0.06603604331517617
Bond Position:  [-2.30224091]


portfolio before change:  [4.0452421]
curr_Stock_Price:  96.12367111274133
curr_Factors:  [96.12367111]
mat_Sqrt:  [[0.15]]
grads:  [0.03565156]
Stock Position:  0.03565156016475674
Bond Position:  [0.61828326]


portfolio before change:  [4.04536768]
curr_Stock_Price:  96.12610950581326
curr_Factors:  [96.12610951]
mat_Sqrt:  [[0.15]]
grads:  [-0.05522265]
Stock Position:  -0.05522265130057782
Bond Position:  [9.35370631]


portfolio before change:  [4.02422797]
curr_Stock_Price:  96.51950489272814
curr_Factors:  [96.51950489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131423]
Stock Position:  -0.0013142254620008478
Bond Position:  [4.15107636]


portfolio before change:  [4.02502819]
curr_Stock_Price:  96.10803367394314
curr_Factors:  [96.10803367]
mat_Sqrt:  [[0.15]]
grads:  [-0.0218863]
Stock Position:  -0.021886301932277898
Bond Position:  [6.12847763]


portfolio before change:  [4.0372359]
curr_Stock_Price:  95.56775617715886
curr_Factors:  [95.56775618]
mat_Sqrt:  [[0.15]]
grads:  [-0.01755596]
Stock Position:  -0.017555955483331265
Bond Position:  [5.71501918]


portfolio before change:  [4.03818062]
curr_Stock_Price:  95.53429108336971
curr_Factors:  [95.53429108]
mat_Sqrt:  [[0.15]]
grads:  [-0.00281558]
Stock Position:  -0.0028155760004888422
Bond Position:  [4.30716467]


portfolio before change:  [4.03717684]
curr_Stock_Price:  95.98641262783535
curr_Factors:  [95.98641263]
mat_Sqrt:  [[0.15]]
grads:  [0.05195144]
Stock Position:  0.051951439171259724
Bond Position:  [-0.94945544]


portfolio before change:  [4.03965047]
curr_Stock_Price:  96.03516911072464
curr_Factors:  [96.03516911]
mat_Sqrt:  [[0.15]]
grads:  [-0.07769035]
Stock Position:  -0.07769035264852917
Bond Position:  [11.50065662]


portfolio before change:  [4.02584483]
curr_Stock_Price:  96.22212212823423
curr_Factors:  [96.22212213]
mat_Sqrt:  [[0.15]]
grads:  [-0.03308857]
Stock Position:  -0.03308857039631875
Bond Position:  [7.2096973]


portfolio before change:  [4.04295868]
curr_Stock_Price:  95.71852746561822
curr_Factors:  [95.71852747]
mat_Sqrt:  [[0.15]]
grads:  [-0.01266985]
Stock Position:  -0.012669851183332121
Bond Position:  [5.25569818]


portfolio before change:  [4.03707566]
curr_Stock_Price:  96.20878704335514
curr_Factors:  [96.20878704]
mat_Sqrt:  [[0.15]]
grads:  [0.08614087]
Stock Position:  0.08614086856220371
Bond Position:  [-4.25043282]


portfolio before change:  [4.00329205]
curr_Stock_Price:  95.81968081785571
curr_Factors:  [95.81968082]
mat_Sqrt:  [[0.15]]
grads:  [0.04636873]
Stock Position:  0.04636873324950104
Bond Position:  [-0.43974517]


portfolio before change:  [4.00537409]
curr_Stock_Price:  95.86517549218209
curr_Factors:  [95.86517549]
mat_Sqrt:  [[0.15]]
grads:  [-0.01884]
Stock Position:  -0.01884000379869003
Bond Position:  [5.81147436]


portfolio before change:  [4.01457634]
curr_Stock_Price:  95.39601306526166
curr_Factors:  [95.39601307]
mat_Sqrt:  [[0.15]]
grads:  [-0.03415556]
Stock Position:  -0.03415556368171512
Bond Position:  [7.27288094]


portfolio before change:  [4.01825849]
curr_Stock_Price:  95.3015166630249
curr_Factors:  [95.30151666]
mat_Sqrt:  [[0.15]]
grads:  [-0.01729056]
Stock Position:  -0.017290555476465252
Bond Position:  [5.66607465]


portfolio before change:  [4.00931261]
curr_Stock_Price:  95.83938385378997
curr_Factors:  [95.83938385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354698]
Stock Position:  -0.013546980934810727
Bond Position:  [5.30764692]


portfolio before change:  [4.01017763]
curr_Stock_Price:  95.80001841897041
curr_Factors:  [95.80001842]
mat_Sqrt:  [[0.15]]
grads:  [-0.02504419]
Stock Position:  -0.025044190311906828
Bond Position:  [6.40941152]


portfolio before change:  [4.01178866]
curr_Stock_Price:  95.75168668167686
curr_Factors:  [95.75168668]
mat_Sqrt:  [[0.15]]
grads:  [0.12301875]
Stock Position:  0.12301874986007043
Bond Position:  [-7.76746413]


portfolio before change:  [3.99979579]
curr_Stock_Price:  95.65814492115783
curr_Factors:  [95.65814492]
mat_Sqrt:  [[0.15]]
grads:  [0.0407851]
Stock Position:  0.04078510487625558
Bond Position:  [0.09836832]


portfolio before change:  [4.00741085]
curr_Stock_Price:  95.84470602225362
curr_Factors:  [95.84470602]
mat_Sqrt:  [[0.15]]
grads:  [0.12949146]
Stock Position:  0.12949146241545004
Bond Position:  [-8.4036603]


portfolio before change:  [4.0117637]
curr_Stock_Price:  95.88237718032543
curr_Factors:  [95.88237718]
mat_Sqrt:  [[0.15]]
grads:  [-0.01978908]
Stock Position:  -0.019789082510345488
Bond Position:  [5.90918797]


portfolio before change:  [4.01764082]
curr_Stock_Price:  95.60405256682198
curr_Factors:  [95.60405257]
mat_Sqrt:  [[0.15]]
grads:  [0.04290686]
Stock Position:  0.04290685860266926
Bond Position:  [-0.08442874]


portfolio before change:  [4.01166453]
curr_Stock_Price:  95.46489026584965
curr_Factors:  [95.46489027]
mat_Sqrt:  [[0.15]]
grads:  [0.17917377]
Stock Position:  0.179173774247449
Bond Position:  [-13.09314017]


portfolio before change:  [3.98840196]
curr_Stock_Price:  95.33962516774194
curr_Factors:  [95.33962517]
mat_Sqrt:  [[0.15]]
grads:  [0.02082106]
Stock Position:  0.02082105893179664
Bond Position:  [2.00333001]


portfolio before change:  [3.98497706]
curr_Stock_Price:  95.16911937038078
curr_Factors:  [95.16911937]
mat_Sqrt:  [[0.15]]
grads:  [-0.10166505]
Stock Position:  -0.1016650500709859
Bond Position:  [13.66035035]


portfolio before change:  [3.96506183]
curr_Stock_Price:  95.37340812987865
curr_Factors:  [95.37340813]
mat_Sqrt:  [[0.15]]
grads:  [-0.03859467]
Stock Position:  -0.038594671068411315
Bond Position:  [7.64596715]


portfolio before change:  [3.96386228]
curr_Stock_Price:  95.41687129996535
curr_Factors:  [95.4168713]
mat_Sqrt:  [[0.15]]
grads:  [0.01643671]
Stock Position:  0.016436714375556768
Bond Position:  [2.39552242]


portfolio before change:  [3.96931287]
curr_Stock_Price:  95.73937283605913
curr_Factors:  [95.73937284]
mat_Sqrt:  [[0.15]]
grads:  [0.07196684]
Stock Position:  0.07196684135246707
Bond Position:  [-2.92074739]


portfolio before change:  [4.02074784]
curr_Stock_Price:  96.45661318360104
curr_Factors:  [96.45661318]
mat_Sqrt:  [[0.15]]
grads:  [0.02125547]
Stock Position:  0.021255466432321922
Bond Position:  [1.97051753]


portfolio before change:  [4.00688318]
curr_Stock_Price:  95.79853203079226
curr_Factors:  [95.79853203]
mat_Sqrt:  [[0.15]]
grads:  [-0.00658425]
Stock Position:  -0.006584248762377959
Bond Position:  [4.63764454]


portfolio before change:  [4.0079818]
curr_Stock_Price:  95.67569879842728
curr_Factors:  [95.6756988]
mat_Sqrt:  [[0.15]]
grads:  [-0.11270016]
Stock Position:  -0.11270016357291054
Bond Position:  [14.79064871]


portfolio before change:  [4.08470675]
curr_Stock_Price:  95.00311320911645
curr_Factors:  [95.00311321]
mat_Sqrt:  [[0.15]]
grads:  [-0.21128386]
Stock Position:  -0.21128386070354802
Bond Position:  [24.15733129]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.06003389]
Stock Price:  95.12703531319653
PL:  [4.06003389]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.78237097e-03]
 [ 3.70574850e-02]
 [ 1.84292184e-02]
 [-6.49256136e-03]
 [ 8.92333310e-03]
 [-5.37177662e-03]
 [-6.54967168e-03]
 [ 7.46071320e-03]
 [-6.98616294e-03]
 [ 1.74539629e-03]
 [ 6.31400988e-03]
 [-2.03323956e-03]
 [-2.79922602e-04]
 [ 2.30948314e-03]
 [-2.61860108e-03]
 [ 1.13502926e-02]
 [-1.28249889e-02]
 [-1.20030344e-02]
 [ 2.48225231e-02]
 [-3.24405047e-03]
 [-1.56182440e-02]
 [ 5.58117906e-03]
 [ 1.28602575e-02]
 [ 1.73790481e-02]
 [ 1.21996463e-02]
 [ 4.45186712e-03]
 [ 1.71022328e-04]
 [ 1.43022651e-02]
 [-1.73808047e-02]
 [ 5.15484659e-02]
 [-6.58320181e-03]
 [ 2.37821089e-02]
 [ 1.34323667e-02]
 [-1.91458688e-02]
 [-1.86264489e-02]
 [-8.30529038e-02]
 [ 1.91192898e-02]
 [-1.15035126e-02]
 [ 8.14166207e-02]
 [ 4.19962504e-02]
 [ 6.26653170e-03]
 [ 3.43572119e-02]
 [-6.38380801e-03]
 [ 5.76343350e-02]
 [-1.33473861e-01]
 [ 3.64795837e-02]
 [ 6.48528260e-03]
 [ 5.68941209e-03]
 [-3.36636319e-02]
 [ 1.32899336e-03]
 [ 1.17957366e-02]
 [-1.93661247e-03]
 [-5.08922147e-03]
 [-1.45854340e-02]
 [-4.07898561e-02]
 [-6.78093520e-03]
 [-1.70270405e-02]
 [ 1.74559252e-02]
 [ 2.10455944e-03]
 [-1.42684536e-03]
 [-5.22136232e-03]
 [-6.78261018e-03]
 [ 7.11707160e-03]
 [-1.18978009e-02]
 [ 1.49033300e-02]
 [ 1.29175566e-02]
 [ 2.07477482e-02]
 [-7.81234421e-03]
 [ 1.20069340e-02]
 [ 3.50502664e-02]
 [ 3.36875681e-03]
 [-1.48088855e-02]
 [-6.06394496e-03]
 [ 4.61580296e-03]
 [ 1.32170673e-02]
 [ 3.13948092e-02]
 [ 1.03633549e-02]
 [-5.15986271e-02]
 [-1.69818299e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.05086385]
curr_Stock_Price:  100.6368029215133
curr_Factors:  [100.63680292]
mat_Sqrt:  [[0.15]]
grads:  [-0.03188247]
Stock Position:  -0.031882473117833474
Bond Position:  [19.25941402]


portfolio before change:  [16.04325392]
curr_Stock_Price:  100.91324590351273
curr_Factors:  [100.9132459]
mat_Sqrt:  [[0.15]]
grads:  [0.2470499]
Stock Position:  0.24704990012866745
Bond Position:  [-8.88735341]


portfolio before change:  [16.16069768]
curr_Stock_Price:  101.39087912112488
curr_Factors:  [101.39087912]
mat_Sqrt:  [[0.15]]
grads:  [0.12286146]
Stock Position:  0.12286145579552862
Bond Position:  [3.70366667]


portfolio before change:  [16.01665663]
curr_Stock_Price:  100.21660898929132
curr_Factors:  [100.21660899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04328374]
Stock Position:  -0.04328374239589465
Bond Position:  [20.35440651]


portfolio before change:  [16.01288301]
curr_Stock_Price:  100.33318415280412
curr_Factors:  [100.33318415]
mat_Sqrt:  [[0.15]]
grads:  [0.05948889]
Stock Position:  0.059488887320215296
Bond Position:  [10.04417352]


portfolio before change:  [15.99800924]
curr_Stock_Price:  100.0726053028479
curr_Factors:  [100.0726053]
mat_Sqrt:  [[0.15]]
grads:  [-0.03581184]
Stock Position:  -0.03581184415828806
Bond Position:  [19.58179379]


portfolio before change:  [16.03605059]
curr_Stock_Price:  99.04452501088974
curr_Factors:  [99.04452501]
mat_Sqrt:  [[0.15]]
grads:  [-0.04366448]
Stock Position:  -0.0436644778423135
Bond Position:  [20.36077806]


portfolio before change:  [16.03278049]
curr_Stock_Price:  99.14856138856895
curr_Factors:  [99.14856139]
mat_Sqrt:  [[0.15]]
grads:  [0.04973809]
Stock Position:  0.04973808798614021
Bond Position:  [11.10132062]


portfolio before change:  [16.07355011]
curr_Stock_Price:  99.95429741098464
curr_Factors:  [99.95429741]
mat_Sqrt:  [[0.15]]
grads:  [-0.04657442]
Stock Position:  -0.046574419596220044
Bond Position:  [20.7288635]


portfolio before change:  [16.04510462]
curr_Stock_Price:  100.59286877819869
curr_Factors:  [100.59286878]
mat_Sqrt:  [[0.15]]
grads:  [0.01163598]
Stock Position:  0.011635975284910102
Bond Position:  [14.87460848]


portfolio before change:  [16.044224]
curr_Stock_Price:  100.43729062097177
curr_Factors:  [100.43729062]
mat_Sqrt:  [[0.15]]
grads:  [0.0420934]
Stock Position:  0.04209339916734453
Bond Position:  [11.81647704]


portfolio before change:  [16.03558978]
curr_Stock_Price:  100.21462439157168
curr_Factors:  [100.21462439]
mat_Sqrt:  [[0.15]]
grads:  [-0.01355493]
Stock Position:  -0.013554930403774843
Bond Position:  [17.39399204]


portfolio before change:  [16.0541086]
curr_Stock_Price:  98.9286227515829
curr_Factors:  [98.92862275]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186615]
Stock Position:  -0.0018661506804308384
Bond Position:  [16.23872432]


portfolio before change:  [16.0555217]
curr_Stock_Price:  98.71527156115002
curr_Factors:  [98.71527156]
mat_Sqrt:  [[0.15]]
grads:  [0.01539655]
Stock Position:  0.015396554296386466
Bond Position:  [14.53564666]


portfolio before change:  [16.06016192]
curr_Stock_Price:  98.95764511676414
curr_Factors:  [98.95764512]
mat_Sqrt:  [[0.15]]
grads:  [-0.01745734]
Stock Position:  -0.017457340511725455
Bond Position:  [17.78769923]


portfolio before change:  [16.05479434]
curr_Stock_Price:  99.32879832817972
curr_Factors:  [99.32879833]
mat_Sqrt:  [[0.15]]
grads:  [0.07566862]
Stock Position:  0.07566861701637129
Bond Position:  [8.53872154]


portfolio before change:  [15.9567611]
curr_Stock_Price:  98.02618528976689
curr_Factors:  [98.02618529]
mat_Sqrt:  [[0.15]]
grads:  [-0.08549993]
Stock Position:  -0.08549992631351455
Bond Position:  [24.33799272]


portfolio before change:  [15.98785308]
curr_Stock_Price:  97.68032755831686
curr_Factors:  [97.68032756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08002023]
Stock Position:  -0.08002022928630988
Bond Position:  [23.80425529]


portfolio before change:  [15.99220696]
curr_Stock_Price:  97.6445108255215
curr_Factors:  [97.64451083]
mat_Sqrt:  [[0.15]]
grads:  [0.16548349]
Stock Position:  0.1654834874056482
Bond Position:  [-0.16634722]


portfolio before change:  [15.90710238]
curr_Stock_Price:  97.13029530064782
curr_Factors:  [97.1302953]
mat_Sqrt:  [[0.15]]
grads:  [-0.021627]
Stock Position:  -0.021627003157304953
Bond Position:  [18.00773958]


portfolio before change:  [15.90407839]
curr_Stock_Price:  97.32216240719123
curr_Factors:  [97.32216241]
mat_Sqrt:  [[0.15]]
grads:  [-0.10412163]
Stock Position:  -0.10412162682909637
Bond Position:  [26.03742027]


portfolio before change:  [15.88908275]
curr_Stock_Price:  97.48181247567526
curr_Factors:  [97.48181248]
mat_Sqrt:  [[0.15]]
grads:  [0.03720786]
Stock Position:  0.037207860369199
Bond Position:  [12.26199309]


portfolio before change:  [15.87502565]
curr_Stock_Price:  97.08341544047352
curr_Factors:  [97.08341544]
mat_Sqrt:  [[0.15]]
grads:  [0.08573505]
Stock Position:  0.0857350497168914
Bond Position:  [7.5515742]


portfolio before change:  [15.86466418]
curr_Stock_Price:  96.95705567935966
curr_Factors:  [96.95705568]
mat_Sqrt:  [[0.15]]
grads:  [0.11586032]
Stock Position:  0.1158603206077855
Bond Position:  [4.63118862]


portfolio before change:  [15.74219141]
curr_Stock_Price:  95.89748475692936
curr_Factors:  [95.89748476]
mat_Sqrt:  [[0.15]]
grads:  [0.08133098]
Stock Position:  0.08133097542253928
Bond Position:  [7.94275544]


portfolio before change:  [15.71170629]
curr_Stock_Price:  95.51655289900155
curr_Factors:  [95.5165529]
mat_Sqrt:  [[0.15]]
grads:  [0.02967911]
Stock Position:  0.029679114163607963
Bond Position:  [12.87685961]


portfolio before change:  [15.71954358]
curr_Stock_Price:  95.75350272122871
curr_Factors:  [95.75350272]
mat_Sqrt:  [[0.15]]
grads:  [0.00114015]
Stock Position:  0.0011401488525865137
Bond Position:  [15.61037033]


portfolio before change:  [15.72129248]
curr_Stock_Price:  96.43167678517484
curr_Factors:  [96.43167679]
mat_Sqrt:  [[0.15]]
grads:  [0.09534843]
Stock Position:  0.09534843368766278
Bond Position:  [6.52668314]


portfolio before change:  [15.67035905]
curr_Stock_Price:  95.8932164065249
curr_Factors:  [95.89321641]
mat_Sqrt:  [[0.15]]
grads:  [-0.11587203]
Stock Position:  -0.11587203102989974
Bond Position:  [26.7817008]


portfolio before change:  [15.61779829]
curr_Stock_Price:  96.36127303886148
curr_Factors:  [96.36127304]
mat_Sqrt:  [[0.15]]
grads:  [0.34365644]
Stock Position:  0.3436564390398638
Bond Position:  [-17.49737366]


portfolio before change:  [15.50432647]
curr_Stock_Price:  96.03426562303322
curr_Factors:  [96.03426562]
mat_Sqrt:  [[0.15]]
grads:  [-0.04388801]
Stock Position:  -0.043888012051799194
Bond Position:  [19.71907947]


portfolio before change:  [15.50636575]
curr_Stock_Price:  96.01588237903316
curr_Factors:  [96.01588238]
mat_Sqrt:  [[0.15]]
grads:  [0.15854739]
Stock Position:  0.15854739293185396
Bond Position:  [0.28329792]


portfolio before change:  [15.40289304]
curr_Stock_Price:  95.36314116099962
curr_Factors:  [95.36314116]
mat_Sqrt:  [[0.15]]
grads:  [0.08954911]
Stock Position:  0.08954911149777013
Bond Position:  [6.86320848]


portfolio before change:  [15.34863835]
curr_Stock_Price:  94.75248575716127
curr_Factors:  [94.75248576]
mat_Sqrt:  [[0.15]]
grads:  [-0.12763913]
Stock Position:  -0.12763912533721108
Bond Position:  [27.44276276]


portfolio before change:  [15.36178682]
curr_Stock_Price:  94.66291104342304
curr_Factors:  [94.66291104]
mat_Sqrt:  [[0.15]]
grads:  [-0.12417633]
Stock Position:  -0.12417632569587223
Bond Position:  [27.11667929]


portfolio before change:  [15.44389337]
curr_Stock_Price:  94.01535038025426
curr_Factors:  [94.01535038]
mat_Sqrt:  [[0.15]]
grads:  [-0.55368603]
Stock Position:  -0.5536860256574211
Bond Position:  [67.49887907]


portfolio before change:  [15.50593872]
curr_Stock_Price:  93.91091115818644
curr_Factors:  [93.91091116]
mat_Sqrt:  [[0.15]]
grads:  [0.12746193]
Stock Position:  0.12746193228825306
Bond Position:  [3.53587252]


portfolio before change:  [15.3809105]
curr_Stock_Price:  92.9282710007347
curr_Factors:  [92.928271]
mat_Sqrt:  [[0.15]]
grads:  [-0.07669008]
Stock Position:  -0.07669008422973911
Bond Position:  [22.50758743]


portfolio before change:  [15.32730636]
curr_Stock_Price:  93.64558555876772
curr_Factors:  [93.64558556]
mat_Sqrt:  [[0.15]]
grads:  [0.54277747]
Stock Position:  0.5427774711264975
Bond Position:  [-35.50140775]


portfolio before change:  [15.24030447]
curr_Stock_Price:  93.48938345452007
curr_Factors:  [93.48938345]
mat_Sqrt:  [[0.15]]
grads:  [0.279975]
Stock Position:  0.2799750023880667
Bond Position:  [-10.93438589]


portfolio before change:  [15.18642777]
curr_Stock_Price:  93.29939051058737
curr_Factors:  [93.29939051]
mat_Sqrt:  [[0.15]]
grads:  [0.04177688]
Stock Position:  0.0417768779830157
Bond Position:  [11.28867052]


portfolio before change:  [15.17652001]
curr_Stock_Price:  93.04534265824279
curr_Factors:  [93.04534266]
mat_Sqrt:  [[0.15]]
grads:  [0.22904808]
Stock Position:  0.229048079497308
Bond Position:  [-6.13533703]


portfolio before change:  [14.90341388]
curr_Stock_Price:  91.85466398928287
curr_Factors:  [91.85466399]
mat_Sqrt:  [[0.15]]
grads:  [-0.04255872]
Stock Position:  -0.04255872006756788
Bond Position:  [18.81263081]


portfolio before change:  [14.92358303]
curr_Stock_Price:  91.4083787858805
curr_Factors:  [91.40837879]
mat_Sqrt:  [[0.15]]
grads:  [0.3842289]
Stock Position:  0.38422889973727864
Bond Position:  [-20.19815778]


portfolio before change:  [14.76479627]
curr_Stock_Price:  90.99840354697396
curr_Factors:  [90.99840355]
mat_Sqrt:  [[0.15]]
grads:  [-0.88982574]
Stock Position:  -0.8898257431777873
Bond Position:  [95.73751833]


portfolio before change:  [15.87844497]
curr_Stock_Price:  89.75359250172446
curr_Factors:  [89.7535925]
mat_Sqrt:  [[0.15]]
grads:  [0.24319722]
Stock Position:  0.24319722494925586
Bond Position:  [-5.94937966]


portfolio before change:  [15.74486341]
curr_Stock_Price:  89.20584895687732
curr_Factors:  [89.20584896]
mat_Sqrt:  [[0.15]]
grads:  [0.04323522]
Stock Position:  0.04323521734401139
Bond Position:  [11.88802914]


portfolio before change:  [15.75183699]
curr_Stock_Price:  89.34995740799248
curr_Factors:  [89.34995741]
mat_Sqrt:  [[0.15]]
grads:  [0.03792941]
Stock Position:  0.03792941394196359
Bond Position:  [12.36284547]


portfolio before change:  [15.76280326]
curr_Stock_Price:  89.61870836355638
curr_Factors:  [89.61870836]
mat_Sqrt:  [[0.15]]
grads:  [-0.22442421]
Stock Position:  -0.22442421256829254
Bond Position:  [35.87541132]


portfolio before change:  [15.8553675]
curr_Stock_Price:  89.21624753857826
curr_Factors:  [89.21624754]
mat_Sqrt:  [[0.15]]
grads:  [0.00885996]
Stock Position:  0.008859955700552175
Bond Position:  [15.0649155]


portfolio before change:  [15.85093284]
curr_Stock_Price:  88.60944535095932
curr_Factors:  [88.60944535]
mat_Sqrt:  [[0.15]]
grads:  [0.07863824]
Stock Position:  0.07863824393609706
Bond Position:  [8.88284167]


portfolio before change:  [15.81395215]
curr_Stock_Price:  88.13212173992912
curr_Factors:  [88.13212174]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291075]
Stock Position:  -0.012910749786879689
Bond Position:  [16.95180392]


portfolio before change:  [15.80938977]
curr_Stock_Price:  88.56756493645359
curr_Factors:  [88.56756494]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392814]
Stock Position:  -0.03392814310559209
Bond Position:  [18.81432279]


portfolio before change:  [15.79456539]
curr_Stock_Price:  89.03915896220562
curr_Factors:  [89.03915896]
mat_Sqrt:  [[0.15]]
grads:  [-0.09723623]
Stock Position:  -0.09723622663849472
Bond Position:  [24.45239723]


portfolio before change:  [15.81845352]
curr_Stock_Price:  88.8092055066393
curr_Factors:  [88.80920551]
mat_Sqrt:  [[0.15]]
grads:  [-0.27193237]
Stock Position:  -0.27193237386233454
Bond Position:  [39.9685516]


portfolio before change:  [15.8392883]
curr_Stock_Price:  88.74177452128592
curr_Factors:  [88.74177452]
mat_Sqrt:  [[0.15]]
grads:  [-0.04520623]
Stock Position:  -0.04520623467017009
Bond Position:  [19.85096979]


portfolio before change:  [15.83760413]
curr_Stock_Price:  88.80647570585442
curr_Factors:  [88.80647571]
mat_Sqrt:  [[0.15]]
grads:  [-0.1135136]
Stock Position:  -0.11351360347641837
Bond Position:  [25.9183472]


portfolio before change:  [15.78318362]
curr_Stock_Price:  89.30016508915612
curr_Factors:  [89.30016509]
mat_Sqrt:  [[0.15]]
grads:  [0.11637283]
Stock Position:  0.11637283440825259
Bond Position:  [5.39107029]


portfolio before change:  [15.7915435]
curr_Stock_Price:  89.36910669230781
curr_Factors:  [89.36910669]
mat_Sqrt:  [[0.15]]
grads:  [0.0140304]
Stock Position:  0.014030396266757174
Bond Position:  [14.53765952]


portfolio before change:  [15.79152584]
curr_Stock_Price:  89.30308604044683
curr_Factors:  [89.30308604]
mat_Sqrt:  [[0.15]]
grads:  [-0.0095123]
Stock Position:  -0.009512302402429193
Bond Position:  [16.64100379]


portfolio before change:  [15.77954757]
curr_Stock_Price:  90.67166731760467
curr_Factors:  [90.67166732]
mat_Sqrt:  [[0.15]]
grads:  [-0.03480908]
Stock Position:  -0.034809082138519895
Bond Position:  [18.93574509]


portfolio before change:  [15.78464892]
curr_Stock_Price:  90.55911547473254
curr_Factors:  [90.55911547]
mat_Sqrt:  [[0.15]]
grads:  [-0.0452174]
Stock Position:  -0.04521740121226195
Bond Position:  [19.87949678]


portfolio before change:  [15.7894557]
curr_Stock_Price:  90.480290261976
curr_Factors:  [90.48029026]
mat_Sqrt:  [[0.15]]
grads:  [0.04744714]
Stock Position:  0.04744714401089462
Bond Position:  [11.49642434]


portfolio before change:  [15.78325052]
curr_Stock_Price:  90.3343652859453
curr_Factors:  [90.33436529]
mat_Sqrt:  [[0.15]]
grads:  [-0.07931867]
Stock Position:  -0.07931867284555785
Bond Position:  [22.94845249]


portfolio before change:  [15.7381172]
curr_Stock_Price:  90.9214609272119
curr_Factors:  [90.92146093]
mat_Sqrt:  [[0.15]]
grads:  [0.09935553]
Stock Position:  0.09935553365462721
Bond Position:  [6.70456693]


portfolio before change:  [15.79093592]
curr_Stock_Price:  91.44885652942436
curr_Factors:  [91.44885653]
mat_Sqrt:  [[0.15]]
grads:  [0.08611704]
Stock Position:  0.08611704367597373
Bond Position:  [7.91563075]


portfolio before change:  [15.79187507]
curr_Stock_Price:  91.45401704164843
curr_Factors:  [91.45401704]
mat_Sqrt:  [[0.15]]
grads:  [0.13831832]
Stock Position:  0.13831832132842242
Bond Position:  [3.14210895]


portfolio before change:  [15.80811071]
curr_Stock_Price:  91.56997605125899
curr_Factors:  [91.56997605]
mat_Sqrt:  [[0.15]]
grads:  [-0.05208229]
Stock Position:  -0.0520822947263796
Bond Position:  [20.57728519]


portfolio before change:  [15.84765182]
curr_Stock_Price:  90.83546561840552
curr_Factors:  [90.83546562]
mat_Sqrt:  [[0.15]]
grads:  [0.08004623]
Stock Position:  0.08004622669361579
Bond Position:  [8.57661555]


portfolio before change:  [15.78959766]
curr_Stock_Price:  90.10351086327702
curr_Factors:  [90.10351086]
mat_Sqrt:  [[0.15]]
grads:  [0.23366844]
Stock Position:  0.23366844247236443
Bond Position:  [-5.26474938]


portfolio before change:  [15.85470096]
curr_Stock_Price:  90.3835330947215
curr_Factors:  [90.38353309]
mat_Sqrt:  [[0.15]]
grads:  [0.02245838]
Stock Position:  0.022458378733262986
Bond Position:  [13.82483335]


portfolio before change:  [15.85756698]
curr_Stock_Price:  90.47267312824724
curr_Factors:  [90.47267313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0987259]
Stock Position:  -0.09872590346684584
Bond Position:  [24.78956338]


portfolio before change:  [15.86392586]
curr_Stock_Price:  90.42395760094074
curr_Factors:  [90.4239576]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404263]
Stock Position:  -0.0404262997664633
Bond Position:  [19.51943188]


portfolio before change:  [15.87949856]
curr_Stock_Price:  90.06892391033492
curr_Factors:  [90.06892391]
mat_Sqrt:  [[0.15]]
grads:  [0.03077202]
Stock Position:  0.03077201971726487
Bond Position:  [13.10789586]


portfolio before change:  [15.89381683]
curr_Stock_Price:  90.5076014997175
curr_Factors:  [90.5076015]
mat_Sqrt:  [[0.15]]
grads:  [0.08811378]
Stock Position:  0.0881137820989427
Bond Position:  [7.91884975]


portfolio before change:  [15.89676444]
curr_Stock_Price:  90.53543671383126
curr_Factors:  [90.53543671]
mat_Sqrt:  [[0.15]]
grads:  [0.20929873]
Stock Position:  0.20929872795640972
Bond Position:  [-3.0521873]


portfolio before change:  [15.8406947]
curr_Stock_Price:  90.2684548397164
curr_Factors:  [90.26845484]
mat_Sqrt:  [[0.15]]
grads:  [0.06908903]
Stock Position:  0.06908903243609728
Bond Position:  [9.6041345]


portfolio before change:  [15.82505075]
curr_Stock_Price:  90.03333457890908
curr_Factors:  [90.03333458]
mat_Sqrt:  [[0.15]]
grads:  [-0.34399085]
Stock Position:  -0.34399084732149776
Bond Position:  [46.7956938]


portfolio before change:  [15.84631477]
curr_Stock_Price:  89.98002155149963
curr_Factors:  [89.98002155]
mat_Sqrt:  [[0.15]]
grads:  [-0.1132122]
Stock Position:  -0.11321219911665621
Bond Position:  [26.03315088]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.86209887]
Stock Price:  89.85497333915957
PL:  [15.86209887]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.17840783e-03]
 [ 8.54034193e-03]
 [ 1.40465760e-02]
 [-8.30074925e-03]
 [ 1.51076385e-02]
 [-1.04905847e-02]
 [ 2.10224645e-03]
 [ 2.98460769e-03]
 [-1.50792654e-02]
 [-5.47971356e-03]
 [ 1.35600722e-02]
 [-4.04937602e-03]
 [-5.53315562e-04]
 [ 4.28199957e-03]
 [-2.85167779e-03]
 [ 2.08959571e-03]
 [-3.62226171e-02]
 [-9.63154205e-03]
 [ 2.30956209e-02]
 [-4.66979096e-03]
 [-2.36526142e-02]
 [ 5.83956802e-03]
 [ 1.28911011e-02]
 [ 1.51324798e-02]
 [ 9.22946764e-03]
 [ 4.47204262e-03]
 [ 6.26726772e-05]
 [ 1.73654391e-02]
 [-2.86371567e-02]
 [ 9.33613145e-02]
 [-5.38497582e-03]
 [ 3.51410393e-02]
 [ 1.44592581e-02]
 [-1.90737326e-02]
 [-1.94708071e-02]
 [-7.16728317e-02]
 [ 1.67196543e-02]
 [-7.52755717e-03]
 [ 6.63367254e-02]
 [ 2.80227574e-02]
 [ 6.29181299e-03]
 [ 3.48015501e-02]
 [-3.50643700e-03]
 [ 3.93601747e-02]
 [-8.88240478e-02]
 [ 2.68253699e-02]
 [ 8.46632348e-03]
 [ 5.46707195e-03]
 [-1.92774904e-02]
 [ 6.87662184e-04]
 [ 4.66398137e-03]
 [-4.31327548e-03]
 [-3.12787161e-03]
 [-6.37955885e-03]
 [-2.98936584e-02]
 [-6.21351497e-03]
 [-1.21083849e-02]
 [ 1.61615752e-02]
 [ 3.53422713e-03]
 [-1.67606872e-03]
 [-5.21625612e-03]
 [-5.81520604e-03]
 [ 5.96382207e-03]
 [-1.05666733e-02]
 [ 1.52713223e-02]
 [ 1.37012266e-02]
 [ 2.07286320e-02]
 [-8.43619713e-03]
 [ 1.18786849e-02]
 [ 3.35875285e-02]
 [ 3.30546438e-03]
 [-1.48352231e-02]
 [-6.45374882e-03]
 [ 4.75613726e-03]
 [ 1.30181269e-02]
 [ 3.60183925e-02]
 [ 1.12324525e-02]
 [-5.68806288e-02]
 [-1.33538354e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.76078361]
curr_Stock_Price:  100.16944856418533
curr_Factors:  [100.16944856]
mat_Sqrt:  [[0.15]]
grads:  [-0.04118939]
Stock Position:  -0.041189385546448826
Bond Position:  [9.88670165]


portfolio before change:  [5.77261401]
curr_Stock_Price:  99.8972313268035
curr_Factors:  [99.89723133]
mat_Sqrt:  [[0.15]]
grads:  [0.05693561]
Stock Position:  0.056935612875226374
Bond Position:  [0.08490392]


portfolio before change:  [5.80066128]
curr_Stock_Price:  100.38975198444928
curr_Factors:  [100.38975198]
mat_Sqrt:  [[0.15]]
grads:  [0.09364384]
Stock Position:  0.09364384001609814
Bond Position:  [-3.60022059]


portfolio before change:  [5.79395419]
curr_Stock_Price:  100.32053156587895
curr_Factors:  [100.32053157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05533833]
Stock Position:  -0.055338328311300936
Bond Position:  [11.34552471]


portfolio before change:  [5.8341707]
curr_Stock_Price:  99.6066069536559
curr_Factors:  [99.60660695]
mat_Sqrt:  [[0.15]]
grads:  [0.10071759]
Stock Position:  0.10071759000124514
Bond Position:  [-4.1979667]


portfolio before change:  [5.83162893]
curr_Stock_Price:  99.58397546478804
curr_Factors:  [99.58397546]
mat_Sqrt:  [[0.15]]
grads:  [-0.06993723]
Stock Position:  -0.0699372312811812
Bond Position:  [12.79625646]


portfolio before change:  [5.81967298]
curr_Stock_Price:  99.7663640120946
curr_Factors:  [99.76636401]
mat_Sqrt:  [[0.15]]
grads:  [0.01401498]
Stock Position:  0.014014976346636126
Bond Position:  [4.42144974]


portfolio before change:  [5.81351672]
curr_Stock_Price:  99.30738299123898
curr_Factors:  [99.30738299]
mat_Sqrt:  [[0.15]]
grads:  [0.01989738]
Stock Position:  0.019897384581188046
Bond Position:  [3.83755953]


portfolio before change:  [5.81113579]
curr_Stock_Price:  99.17566802526997
curr_Factors:  [99.17566803]
mat_Sqrt:  [[0.15]]
grads:  [-0.10052844]
Stock Position:  -0.1005284357753989
Bond Position:  [15.78111056]


portfolio before change:  [5.76026236]
curr_Stock_Price:  99.69153980752048
curr_Factors:  [99.69153981]
mat_Sqrt:  [[0.15]]
grads:  [-0.03653142]
Stock Position:  -0.03653142370986483
Bond Position:  [9.40213624]


portfolio before change:  [5.7738209]
curr_Stock_Price:  99.33647848187223
curr_Factors:  [99.33647848]
mat_Sqrt:  [[0.15]]
grads:  [0.09040048]
Stock Position:  0.09040048154275475
Bond Position:  [-3.20624459]


portfolio before change:  [5.81509452]
curr_Stock_Price:  99.795259354457
curr_Factors:  [99.79525935]
mat_Sqrt:  [[0.15]]
grads:  [-0.02699584]
Stock Position:  -0.026995840120826797
Bond Position:  [8.50915138]


portfolio before change:  [5.83411394]
curr_Stock_Price:  99.11042859651968
curr_Factors:  [99.1104286]
mat_Sqrt:  [[0.15]]
grads:  [-0.00368877]
Stock Position:  -0.0036887704115095197
Bond Position:  [6.19970956]


portfolio before change:  [5.83489834]
curr_Stock_Price:  99.0028284759683
curr_Factors:  [99.00282848]
mat_Sqrt:  [[0.15]]
grads:  [0.02854666]
Stock Position:  0.02854666381621141
Bond Position:  [3.00869788]


portfolio before change:  [5.81629887]
curr_Stock_Price:  98.34469472592184
curr_Factors:  [98.34469473]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901119]
Stock Position:  -0.019011185234871858
Bond Position:  [7.68594808]


portfolio before change:  [5.84007182]
curr_Stock_Price:  97.11949170471459
curr_Factors:  [97.1194917]
mat_Sqrt:  [[0.15]]
grads:  [0.01393064]
Stock Position:  0.013930638082359203
Bond Position:  [4.48713533]


portfolio before change:  [5.83635326]
curr_Stock_Price:  96.83242549656019
curr_Factors:  [96.8324255]
mat_Sqrt:  [[0.15]]
grads:  [-0.24148411]
Stock Position:  -0.24148411380720256
Bond Position:  [29.21984572]


portfolio before change:  [5.98105116]
curr_Stock_Price:  96.24078573015186
curr_Factors:  [96.24078573]
mat_Sqrt:  [[0.15]]
grads:  [-0.06421028]
Stock Position:  -0.0642102803307159
Bond Position:  [12.16069899]


portfolio before change:  [5.98432587]
curr_Stock_Price:  96.20162308672985
curr_Factors:  [96.20162309]
mat_Sqrt:  [[0.15]]
grads:  [0.15397081]
Stock Position:  0.15397080601859878
Bond Position:  [-8.82791557]


portfolio before change:  [5.99152492]
curr_Stock_Price:  96.25196253713693
curr_Factors:  [96.25196254]
mat_Sqrt:  [[0.15]]
grads:  [-0.03113194]
Stock Position:  -0.031131939752838435
Bond Position:  [8.98803522]


portfolio before change:  [5.99011685]
curr_Stock_Price:  96.31523649770062
curr_Factors:  [96.3152365]
mat_Sqrt:  [[0.15]]
grads:  [-0.15768409]
Stock Position:  -0.1576840947992102
Bond Position:  [21.17749773]


portfolio before change:  [5.9271689]
curr_Stock_Price:  96.72283362426235
curr_Factors:  [96.72283362]
mat_Sqrt:  [[0.15]]
grads:  [0.03893045]
Stock Position:  0.03893045343844609
Bond Position:  [2.16170513]


portfolio before change:  [5.94064747]
curr_Stock_Price:  97.06558485191542
curr_Factors:  [97.06558485]
mat_Sqrt:  [[0.15]]
grads:  [0.08594067]
Stock Position:  0.08594067411067075
Bond Position:  [-2.40123433]


portfolio before change:  [5.90265861]
curr_Stock_Price:  96.62529535292924
curr_Factors:  [96.62529535]
mat_Sqrt:  [[0.15]]
grads:  [0.1008832]
Stock Position:  0.10088319892260554
Bond Position:  [-3.84521028]


portfolio before change:  [5.87460908]
curr_Stock_Price:  96.3496379563471
curr_Factors:  [96.34963796]
mat_Sqrt:  [[0.15]]
grads:  [0.06152978]
Stock Position:  0.061529784290533546
Bond Position:  [-0.05376336]


portfolio before change:  [5.84714905]
curr_Stock_Price:  95.9034042034361
curr_Factors:  [95.9034042]
mat_Sqrt:  [[0.15]]
grads:  [0.02981362]
Stock Position:  0.02981361747210867
Bond Position:  [2.98792164]


portfolio before change:  [5.82888451]
curr_Stock_Price:  95.2845162057809
curr_Factors:  [95.28451621]
mat_Sqrt:  [[0.15]]
grads:  [0.00041782]
Stock Position:  0.00041781784806263955
Bond Position:  [5.78907294]


portfolio before change:  [5.82949354]
curr_Stock_Price:  95.87617491471198
curr_Factors:  [95.87617491]
mat_Sqrt:  [[0.15]]
grads:  [0.11576959]
Stock Position:  0.11576959402706968
Bond Position:  [-5.2700523]


portfolio before change:  [5.74099779]
curr_Stock_Price:  95.11460733386804
curr_Factors:  [95.11460733]
mat_Sqrt:  [[0.15]]
grads:  [-0.19091438]
Stock Position:  -0.19091437767127148
Bond Position:  [23.89974385]


portfolio before change:  [5.84414616]
curr_Stock_Price:  94.58214562768276
curr_Factors:  [94.58214563]
mat_Sqrt:  [[0.15]]
grads:  [0.62240876]
Stock Position:  0.622408763174882
Bond Position:  [-53.02461012]


portfolio before change:  [5.20728048]
curr_Stock_Price:  93.56424295851119
curr_Factors:  [93.56424296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03589984]
Stock Position:  -0.03589983878723638
Bond Position:  [8.56622172]


portfolio before change:  [5.20309258]
curr_Stock_Price:  93.69581179394793
curr_Factors:  [93.69581179]
mat_Sqrt:  [[0.15]]
grads:  [0.2342736]
Stock Position:  0.2342735953970182
Bond Position:  [-16.74736212]


portfolio before change:  [5.29728701]
curr_Stock_Price:  94.102350012935
curr_Factors:  [94.10235001]
mat_Sqrt:  [[0.15]]
grads:  [0.09639505]
Stock Position:  0.09639505424654374
Bond Position:  [-3.77371412]


portfolio before change:  [5.33215296]
curr_Stock_Price:  94.46649540738439
curr_Factors:  [94.46649541]
mat_Sqrt:  [[0.15]]
grads:  [-0.12715822]
Stock Position:  -0.1271582172390596
Bond Position:  [17.34434411]


portfolio before change:  [5.33810615]
curr_Stock_Price:  94.42820347760014
curr_Factors:  [94.42820348]
mat_Sqrt:  [[0.15]]
grads:  [-0.12980538]
Stock Position:  -0.12980538082510412
Bond Position:  [17.59539506]


portfolio before change:  [5.34134796]
curr_Stock_Price:  94.41170133631559
curr_Factors:  [94.41170134]
mat_Sqrt:  [[0.15]]
grads:  [-0.47781888]
Stock Position:  -0.4778188779091446
Bond Position:  [50.45304116]


portfolio before change:  [5.28424593]
curr_Stock_Price:  94.537806533227
curr_Factors:  [94.53780653]
mat_Sqrt:  [[0.15]]
grads:  [0.11146436]
Stock Position:  0.11146436226507624
Bond Position:  [-5.25335038]


portfolio before change:  [5.27274559]
curr_Stock_Price:  94.43757719717307
curr_Factors:  [94.4375772]
mat_Sqrt:  [[0.15]]
grads:  [-0.05018371]
Stock Position:  -0.05018371444622716
Bond Position:  [10.011974]


portfolio before change:  [5.27955859]
curr_Stock_Price:  94.31428564542665
curr_Factors:  [94.31428565]
mat_Sqrt:  [[0.15]]
grads:  [0.44224484]
Stock Position:  0.4422448361062331
Bond Position:  [-36.43044721]


portfolio before change:  [5.29670572]
curr_Stock_Price:  94.35820726852225
curr_Factors:  [94.35820727]
mat_Sqrt:  [[0.15]]
grads:  [0.18681838]
Stock Position:  0.1868183826636352
Bond Position:  [-12.33114195]


portfolio before change:  [5.20254221]
curr_Stock_Price:  93.85829505907958
curr_Factors:  [93.85829506]
mat_Sqrt:  [[0.15]]
grads:  [0.04194542]
Stock Position:  0.041945419959399134
Bond Position:  [1.26561661]


portfolio before change:  [5.20007135]
curr_Stock_Price:  93.79750257661146
curr_Factors:  [93.79750258]
mat_Sqrt:  [[0.15]]
grads:  [0.23201033]
Stock Position:  0.23201033369883478
Bond Position:  [-16.56191852]


portfolio before change:  [5.11366733]
curr_Stock_Price:  93.42954970348315
curr_Factors:  [93.4295497]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337625]
Stock Position:  -0.023376246683619675
Bond Position:  [7.29769953]


portfolio before change:  [5.11753832]
curr_Stock_Price:  93.28346681233216
curr_Factors:  [93.28346681]
mat_Sqrt:  [[0.15]]
grads:  [0.26240116]
Stock Position:  0.2624011643553941
Bond Position:  [-19.36015199]


portfolio before change:  [5.15974822]
curr_Stock_Price:  93.44893843837792
curr_Factors:  [93.44893844]
mat_Sqrt:  [[0.15]]
grads:  [-0.59216032]
Stock Position:  -0.5921603184600986
Bond Position:  [60.49650136]


portfolio before change:  [4.91214793]
curr_Stock_Price:  93.87345428479404
curr_Factors:  [93.87345428]
mat_Sqrt:  [[0.15]]
grads:  [0.1788358]
Stock Position:  0.1788357995463377
Bond Position:  [-11.87578632]


portfolio before change:  [4.89366022]
curr_Stock_Price:  93.77422668246747
curr_Factors:  [93.77422668]
mat_Sqrt:  [[0.15]]
grads:  [0.05644216]
Stock Position:  0.05644215655045116
Bond Position:  [-0.39915936]


portfolio before change:  [4.8657412]
curr_Stock_Price:  93.28002023201788
curr_Factors:  [93.28002023]
mat_Sqrt:  [[0.15]]
grads:  [0.03644715]
Stock Position:  0.036447146358486095
Bond Position:  [1.46595065]


portfolio before change:  [4.86034399]
curr_Stock_Price:  93.1294233164186
curr_Factors:  [93.12942332]
mat_Sqrt:  [[0.15]]
grads:  [-0.1285166]
Stock Position:  -0.12851660278005494
Bond Position:  [16.8290211]


portfolio before change:  [4.96399468]
curr_Stock_Price:  92.33109189002586
curr_Factors:  [92.33109189]
mat_Sqrt:  [[0.15]]
grads:  [0.00458441]
Stock Position:  0.004584414560956711
Bond Position:  [4.54071068]


portfolio before change:  [4.96387797]
curr_Stock_Price:  92.24372649123082
curr_Factors:  [92.24372649]
mat_Sqrt:  [[0.15]]
grads:  [0.03109321]
Stock Position:  0.03109320910459179
Bond Position:  [2.09572449]


portfolio before change:  [4.95040908]
curr_Stock_Price:  91.80633590671675
curr_Factors:  [91.80633591]
mat_Sqrt:  [[0.15]]
grads:  [-0.02875517]
Stock Position:  -0.02875516985011074
Bond Position:  [7.59031586]


portfolio before change:  [4.95982254]
curr_Stock_Price:  91.49546804913342
curr_Factors:  [91.49546805]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085248]
Stock Position:  -0.020852477412773754
Bond Position:  [6.86772973]


portfolio before change:  [4.96651704]
curr_Stock_Price:  91.19501209301009
curr_Factors:  [91.19501209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04253039]
Stock Position:  -0.04253039235994444
Bond Position:  [8.84507669]


portfolio before change:  [4.95718498]
curr_Stock_Price:  91.42743163288507
curr_Factors:  [91.42743163]
mat_Sqrt:  [[0.15]]
grads:  [-0.19929106]
Stock Position:  -0.19929105578456854
Bond Position:  [23.17785436]


portfolio before change:  [4.98498346]
curr_Stock_Price:  91.29521386525775
curr_Factors:  [91.29521387]
mat_Sqrt:  [[0.15]]
grads:  [-0.04142343]
Stock Position:  -0.041423433104425214
Bond Position:  [8.76674465]


portfolio before change:  [4.99552143]
curr_Stock_Price:  91.05404527872335
curr_Factors:  [91.05404528]
mat_Sqrt:  [[0.15]]
grads:  [-0.08072257]
Stock Position:  -0.08072256585901247
Bond Position:  [12.3456376]


portfolio before change:  [5.01711331]
curr_Stock_Price:  90.7961217567991
curr_Factors:  [90.79612176]
mat_Sqrt:  [[0.15]]
grads:  [0.10774383]
Stock Position:  0.10774383443309446
Bond Position:  [-4.765609]


portfolio before change:  [5.050004]
curr_Stock_Price:  91.10415375959415
curr_Factors:  [91.10415376]
mat_Sqrt:  [[0.15]]
grads:  [0.02356151]
Stock Position:  0.02356151420950662
Bond Position:  [2.90345218]


portfolio before change:  [5.04122806]
curr_Stock_Price:  90.7239828239257
curr_Factors:  [90.72398282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01117379]
Stock Position:  -0.011173791478135867
Bond Position:  [6.05495893]


portfolio before change:  [5.03944134]
curr_Stock_Price:  90.91775539676298
curr_Factors:  [90.9177554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03477504]
Stock Position:  -0.03477504078966025
Bond Position:  [8.20110999]


portfolio before change:  [5.01434005]
curr_Stock_Price:  91.65431459760444
curr_Factors:  [91.6543146]
mat_Sqrt:  [[0.15]]
grads:  [-0.03876804]
Stock Position:  -0.03876804027883223
Bond Position:  [8.56759821]


portfolio before change:  [5.03420175]
curr_Stock_Price:  91.15580583295922
curr_Factors:  [91.15580583]
mat_Sqrt:  [[0.15]]
grads:  [0.03975881]
Stock Position:  0.03975881380478351
Bond Position:  [1.40995503]


portfolio before change:  [5.03716143]
curr_Stock_Price:  91.22803041107558
curr_Factors:  [91.22803041]
mat_Sqrt:  [[0.15]]
grads:  [-0.07044449]
Stock Position:  -0.07044448872806498
Bond Position:  [11.46367339]


portfolio before change:  [5.02854417]
curr_Stock_Price:  91.36052861546601
curr_Factors:  [91.36052862]
mat_Sqrt:  [[0.15]]
grads:  [0.10180882]
Stock Position:  0.10180881526981776
Bond Position:  [-4.27276301]


portfolio before change:  [4.99289235]
curr_Stock_Price:  91.0129677487477
curr_Factors:  [91.01296775]
mat_Sqrt:  [[0.15]]
grads:  [0.09134151]
Stock Position:  0.0913415108367422
Bond Position:  [-3.32036963]


portfolio before change:  [5.04756862]
curr_Stock_Price:  91.61383142281733
curr_Factors:  [91.61383142]
mat_Sqrt:  [[0.15]]
grads:  [0.13819088]
Stock Position:  0.13819087982309114
Bond Position:  [-7.61262735]


portfolio before change:  [4.96428243]
curr_Stock_Price:  91.01458502853052
curr_Factors:  [91.01458503]
mat_Sqrt:  [[0.15]]
grads:  [-0.05624131]
Stock Position:  -0.05624131417356473
Bond Position:  [10.0830623]


portfolio before change:  [4.96838824]
curr_Stock_Price:  90.95278695598459
curr_Factors:  [90.95278696]
mat_Sqrt:  [[0.15]]
grads:  [0.07919123]
Stock Position:  0.0791912326115804
Bond Position:  [-2.23427507]


portfolio before change:  [4.97668811]
curr_Stock_Price:  91.05935831068345
curr_Factors:  [91.05935831]
mat_Sqrt:  [[0.15]]
grads:  [0.22391686]
Stock Position:  0.22391685656063365
Bond Position:  [-15.41303716]


portfolio before change:  [4.96859186]
curr_Stock_Price:  91.02750313936873
curr_Factors:  [91.02750314]
mat_Sqrt:  [[0.15]]
grads:  [0.02203643]
Stock Position:  0.022036429208009
Bond Position:  [2.96267073]


portfolio before change:  [4.96354589]
curr_Stock_Price:  90.79011714822931
curr_Factors:  [90.79011715]
mat_Sqrt:  [[0.15]]
grads:  [-0.09890149]
Stock Position:  -0.09890148757081367
Bond Position:  [13.94282353]


portfolio before change:  [5.0533024]
curr_Stock_Price:  89.89139406058018
curr_Factors:  [89.89139406]
mat_Sqrt:  [[0.15]]
grads:  [-0.04302499]
Stock Position:  -0.04302499214555451
Bond Position:  [8.92087892]


portfolio before change:  [5.06135775]
curr_Stock_Price:  89.71712829543952
curr_Factors:  [89.7171283]
mat_Sqrt:  [[0.15]]
grads:  [0.03170758]
Stock Position:  0.03170758175704939
Bond Position:  [2.21664457]


portfolio before change:  [5.04683817]
curr_Stock_Price:  89.25483732364414
curr_Factors:  [89.25483732]
mat_Sqrt:  [[0.15]]
grads:  [0.08678751]
Stock Position:  0.08678751274707364
Bond Position:  [-2.69936716]


portfolio before change:  [5.0951983]
curr_Stock_Price:  89.81400584472284
curr_Factors:  [89.81400584]
mat_Sqrt:  [[0.15]]
grads:  [0.24012262]
Stock Position:  0.24012261699177062
Bond Position:  [-16.47117583]


portfolio before change:  [5.0988839]
curr_Stock_Price:  89.83364200229036
curr_Factors:  [89.833642]
mat_Sqrt:  [[0.15]]
grads:  [0.07488302]
Stock Position:  0.07488301648688984
Bond Position:  [-1.62813019]


portfolio before change:  [5.04813448]
curr_Stock_Price:  89.15728484771773
curr_Factors:  [89.15728485]
mat_Sqrt:  [[0.15]]
grads:  [-0.37920419]
Stock Position:  -0.3792041921493083
Bond Position:  [38.85695065]


portfolio before change:  [5.14783006]
curr_Stock_Price:  88.90078202464825
curr_Factors:  [88.90078202]
mat_Sqrt:  [[0.15]]
grads:  [-0.08902557]
Stock Position:  -0.08902556937020373
Bond Position:  [13.06227279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.18418698]
Stock Price:  88.50156525059815
PL:  [5.18418698]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.22695809e-03]
 [ 3.51062308e-02]
 [ 2.10452198e-02]
 [-3.55632318e-02]
 [-5.38776282e-02]
 [-1.26778678e-03]
 [-1.01449696e-02]
 [-1.39933546e-02]
 [-4.87496268e-03]
 [ 4.86497135e-04]
 [ 3.70631031e-03]
 [ 6.32920707e-03]
 [-2.63833732e-03]
 [ 9.16678465e-03]
 [ 4.58001988e-04]
 [ 1.43453914e-02]
 [ 3.69712509e-02]
 [-1.47315969e-02]
 [ 2.10456636e-02]
 [ 2.64965706e-03]
 [-4.30531796e-03]
 [ 4.14081074e-03]
 [ 1.49828373e-02]
 [ 1.73942034e-02]
 [-4.60790105e-03]
 [ 4.71856577e-03]
 [-1.09414402e-02]
 [ 1.07824137e-02]
 [ 3.17379820e-02]
 [-1.52852724e-03]
 [-3.92361309e-03]
 [ 1.34513194e-02]
 [ 1.25674881e-02]
 [ 9.49407474e-03]
 [ 5.64259784e-03]
 [ 1.15002741e-02]
 [-2.78498821e-02]
 [ 3.10471655e-03]
 [-4.60390851e-02]
 [-8.34579364e-03]
 [ 6.33459620e-03]
 [ 2.95777701e-03]
 [-3.94471514e-03]
 [-4.28978317e-03]
 [ 1.47391973e-02]
 [ 1.40304732e-02]
 [ 1.08261381e-02]
 [ 4.28790225e-03]
 [ 5.72147005e-03]
 [-2.26052638e-03]
 [-1.62768516e-03]
 [-3.16903572e-03]
 [ 1.91243111e-03]
 [ 2.71282716e-03]
 [-4.26611632e-03]
 [-4.18327938e-03]
 [ 8.34220063e-03]
 [ 2.44325481e-03]
 [ 7.39545597e-03]
 [-4.02632488e-03]
 [-1.35486934e-04]
 [ 3.66846949e-03]
 [-7.17255929e-03]
 [ 6.86501229e-03]
 [ 2.17609535e-02]
 [ 5.39489661e-03]
 [ 8.78519116e-03]
 [-4.26482365e-04]
 [ 2.74080465e-03]
 [ 1.99295293e-02]
 [ 6.57609654e-04]
 [-1.59860070e-02]
 [-9.53084297e-04]
 [ 1.36349000e-03]
 [-5.84185983e-04]
 [-9.66418265e-03]
 [-4.23533207e-03]
 [ 1.58822673e-02]
 [-6.07758619e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.33460085]
curr_Stock_Price:  101.05845123094585
curr_Factors:  [101.05845123]
mat_Sqrt:  [[0.15]]
grads:  [-0.04817972]
Stock Position:  -0.048179720579076116
Bond Position:  [30.20356879]


portfolio before change:  [25.34638392]
curr_Stock_Price:  100.85306835827399
curr_Factors:  [100.85306836]
mat_Sqrt:  [[0.15]]
grads:  [0.23404154]
Stock Position:  0.23404153871919567
Bond Position:  [1.74257662]


portfolio before change:  [25.33288904]
curr_Stock_Price:  100.79494279963166
curr_Factors:  [100.7949428]
mat_Sqrt:  [[0.15]]
grads:  [0.14030147]
Stock Position:  0.1403014654044976
Bond Position:  [11.19121086]


portfolio before change:  [25.47727424]
curr_Stock_Price:  101.81906416406879
curr_Factors:  [101.81906416]
mat_Sqrt:  [[0.15]]
grads:  [-0.23708821]
Stock Position:  -0.23708821222803508
Bond Position:  [49.61737413]


portfolio before change:  [25.37768078]
curr_Stock_Price:  102.25221367541054
curr_Factors:  [102.25221368]
mat_Sqrt:  [[0.15]]
grads:  [-0.35918419]
Stock Position:  -0.35918418773668015
Bond Position:  [62.10505909]


portfolio before change:  [25.59581862]
curr_Stock_Price:  101.6557059271819
curr_Factors:  [101.65570593]
mat_Sqrt:  [[0.15]]
grads:  [-0.00845191]
Stock Position:  -0.008451911869392677
Bond Position:  [26.45500369]


portfolio before change:  [25.60351192]
curr_Stock_Price:  100.9410966095877
curr_Factors:  [100.94109661]
mat_Sqrt:  [[0.15]]
grads:  [-0.06763313]
Stock Position:  -0.06763313082604364
Bond Position:  [32.43047432]


portfolio before change:  [25.64150233]
curr_Stock_Price:  100.40935362629291
curr_Factors:  [100.40935363]
mat_Sqrt:  [[0.15]]
grads:  [-0.09328903]
Stock Position:  -0.09328903034313753
Bond Position:  [35.00859357]


portfolio before change:  [25.67699008]
curr_Stock_Price:  100.0524022864062
curr_Factors:  [100.05240229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03249975]
Stock Position:  -0.03249975118656222
Bond Position:  [28.92866826]


portfolio before change:  [25.6532925]
curr_Stock_Price:  100.83719864235954
curr_Factors:  [100.83719864]
mat_Sqrt:  [[0.15]]
grads:  [0.00324331]
Stock Position:  0.003243314230430376
Bond Position:  [25.32624577]


portfolio before change:  [25.65404988]
curr_Stock_Price:  100.58265894101932
curr_Factors:  [100.58265894]
mat_Sqrt:  [[0.15]]
grads:  [0.02470874]
Stock Position:  0.024708735387814068
Bond Position:  [23.16877958]


portfolio before change:  [25.66551036]
curr_Stock_Price:  100.98787504123997
curr_Factors:  [100.98787504]
mat_Sqrt:  [[0.15]]
grads:  [0.04219471]
Stock Position:  0.042194713829168014
Bond Position:  [21.40435587]


portfolio before change:  [25.64467801]
curr_Stock_Price:  100.46245007484575
curr_Factors:  [100.46245007]
mat_Sqrt:  [[0.15]]
grads:  [-0.01758892]
Stock Position:  -0.017588915491145177
Bond Position:  [27.41170356]


portfolio before change:  [25.65109157]
curr_Stock_Price:  100.1952207085251
curr_Factors:  [100.19522071]
mat_Sqrt:  [[0.15]]
grads:  [0.0611119]
Stock Position:  0.06111189766877389
Bond Position:  [19.5279715]


portfolio before change:  [25.6209966]
curr_Stock_Price:  99.68279176258399
curr_Factors:  [99.68279176]
mat_Sqrt:  [[0.15]]
grads:  [0.00305335]
Stock Position:  0.003053346583866516
Bond Position:  [25.31663049]


portfolio before change:  [25.62506259]
curr_Stock_Price:  100.49620815757862
curr_Factors:  [100.49620816]
mat_Sqrt:  [[0.15]]
grads:  [0.09563594]
Stock Position:  0.09563594256225312
Bond Position:  [16.01401299]


portfolio before change:  [25.60504995]
curr_Stock_Price:  100.27648386450753
curr_Factors:  [100.27648386]
mat_Sqrt:  [[0.15]]
grads:  [0.24647501]
Stock Position:  0.24647500571117473
Bond Position:  [0.88940302]


portfolio before change:  [25.56348198]
curr_Stock_Price:  100.10760846630191
curr_Factors:  [100.10760847]
mat_Sqrt:  [[0.15]]
grads:  [-0.09821065]
Stock Position:  -0.09821064620814936
Bond Position:  [35.39511489]


portfolio before change:  [25.6213555]
curr_Stock_Price:  99.54085463529043
curr_Factors:  [99.54085464]
mat_Sqrt:  [[0.15]]
grads:  [0.14030442]
Stock Position:  0.14030442398857032
Bond Position:  [11.65533323]


portfolio before change:  [25.69689363]
curr_Stock_Price:  100.0740498799539
curr_Factors:  [100.07404988]
mat_Sqrt:  [[0.15]]
grads:  [0.01766438]
Stock Position:  0.017664380405147687
Bond Position:  [23.92914755]


portfolio before change:  [25.70231277]
curr_Stock_Price:  100.29616445839972
curr_Factors:  [100.29616446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02870212]
Stock Position:  -0.028702119764473576
Bond Position:  [28.58102529]


portfolio before change:  [25.70267801]
curr_Stock_Price:  100.34567742980802
curr_Factors:  [100.34567743]
mat_Sqrt:  [[0.15]]
grads:  [0.0276054]
Stock Position:  0.027605404952958254
Bond Position:  [22.93259495]


portfolio before change:  [25.70088345]
curr_Stock_Price:  100.22874783936786
curr_Factors:  [100.22874784]
mat_Sqrt:  [[0.15]]
grads:  [0.09988558]
Stock Position:  0.09988558211827298
Bond Position:  [15.68947663]


portfolio before change:  [25.67357623]
curr_Stock_Price:  99.94554537474255
curr_Factors:  [99.94554537]
mat_Sqrt:  [[0.15]]
grads:  [0.11596136]
Stock Position:  0.1159613560478733
Bond Position:  [14.08375526]


portfolio before change:  [25.69696193]
curr_Stock_Price:  100.1396223935582
curr_Factors:  [100.13962239]
mat_Sqrt:  [[0.15]]
grads:  [-0.03071934]
Stock Position:  -0.03071934030712233
Bond Position:  [28.77318507]


portfolio before change:  [25.70186434]
curr_Stock_Price:  100.03857777232184
curr_Factors:  [100.03857777]
mat_Sqrt:  [[0.15]]
grads:  [0.03145711]
Stock Position:  0.03145710515113447
Bond Position:  [22.55494027]


portfolio before change:  [25.73374462]
curr_Stock_Price:  101.007215989201
curr_Factors:  [101.00721599]
mat_Sqrt:  [[0.15]]
grads:  [-0.07294293]
Stock Position:  -0.0729429348412135
Bond Position:  [33.10150739]


portfolio before change:  [25.70476096]
curr_Stock_Price:  101.43292641051286
curr_Factors:  [101.43292641]
mat_Sqrt:  [[0.15]]
grads:  [0.07188276]
Stock Position:  0.07188275823969979
Bond Position:  [18.41348243]


portfolio before change:  [25.71769768]
curr_Stock_Price:  101.59688570954361
curr_Factors:  [101.59688571]
mat_Sqrt:  [[0.15]]
grads:  [0.21158655]
Stock Position:  0.21158654637519236
Bond Position:  [4.22116351]


portfolio before change:  [25.72456724]
curr_Stock_Price:  101.62810566321825
curr_Factors:  [101.62810566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01019018]
Stock Position:  -0.010190181575838522
Bond Position:  [26.76017609]


portfolio before change:  [25.72641629]
curr_Stock_Price:  101.61078603057307
curr_Factors:  [101.61078603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615742]
Stock Position:  -0.02615742056835325
Bond Position:  [28.38429235]


portfolio before change:  [25.72403971]
curr_Stock_Price:  101.76946592899982
curr_Factors:  [101.76946593]
mat_Sqrt:  [[0.15]]
grads:  [0.08967546]
Stock Position:  0.08967546261182241
Bond Position:  [16.59781577]


portfolio before change:  [25.65161039]
curr_Stock_Price:  100.95021489863461
curr_Factors:  [100.9502149]
mat_Sqrt:  [[0.15]]
grads:  [0.08378325]
Stock Position:  0.08378325414248927
Bond Position:  [17.19367288]


portfolio before change:  [25.6451575]
curr_Stock_Price:  100.86036966519958
curr_Factors:  [100.86036967]
mat_Sqrt:  [[0.15]]
grads:  [0.06329383]
Stock Position:  0.06329383159369303
Bond Position:  [19.26131825]


portfolio before change:  [25.62930295]
curr_Stock_Price:  100.59085811670245
curr_Factors:  [100.59085812]
mat_Sqrt:  [[0.15]]
grads:  [0.03761732]
Stock Position:  0.03761731890510391
Bond Position:  [21.84534456]


portfolio before change:  [25.63234796]
curr_Stock_Price:  100.6355087003129
curr_Factors:  [100.6355087]
mat_Sqrt:  [[0.15]]
grads:  [0.07666849]
Stock Position:  0.0766684937700544
Bond Position:  [17.91677509]


portfolio before change:  [25.68017633]
curr_Stock_Price:  101.24473586681938
curr_Factors:  [101.24473587]
mat_Sqrt:  [[0.15]]
grads:  [-0.18566588]
Stock Position:  -0.18566588095141456
Bond Position:  [44.4778694]


portfolio before change:  [25.71169673]
curr_Stock_Price:  101.08993923673252
curr_Factors:  [101.08993924]
mat_Sqrt:  [[0.15]]
grads:  [0.02069811]
Stock Position:  0.020698110359494877
Bond Position:  [23.61932601]


portfolio before change:  [25.71821632]
curr_Stock_Price:  101.3336010117449
curr_Factors:  [101.33360101]
mat_Sqrt:  [[0.15]]
grads:  [-0.30692723]
Stock Position:  -0.306927234253288
Bond Position:  [56.82025822]


portfolio before change:  [25.61273946]
curr_Stock_Price:  101.68882606580773
curr_Factors:  [101.68882607]
mat_Sqrt:  [[0.15]]
grads:  [-0.05563862]
Stock Position:  -0.055638624262714854
Bond Position:  [31.27056584]


portfolio before change:  [25.65668511]
curr_Stock_Price:  100.93411338874701
curr_Factors:  [100.93411339]
mat_Sqrt:  [[0.15]]
grads:  [0.04223064]
Stock Position:  0.04223064133511237
Bond Position:  [21.39417276]


portfolio before change:  [25.64478489]
curr_Stock_Price:  100.62065874419083
curr_Factors:  [100.62065874]
mat_Sqrt:  [[0.15]]
grads:  [0.01971851]
Stock Position:  0.019718513427612074
Bond Position:  [23.66069508]


portfolio before change:  [25.65720053]
curr_Stock_Price:  101.17530481245528
curr_Factors:  [101.17530481]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262981]
Stock Position:  -0.026298100932925436
Bond Position:  [28.31791891]


portfolio before change:  [25.6519753]
curr_Stock_Price:  101.44129951002985
curr_Factors:  [101.44129951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02859855]
Stock Position:  -0.028598554475487998
Bond Position:  [28.55304983]


portfolio before change:  [25.65290313]
curr_Stock_Price:  101.47125882220911
curr_Factors:  [101.47125882]
mat_Sqrt:  [[0.15]]
grads:  [0.09826132]
Stock Position:  0.09826131546960862
Bond Position:  [15.68220375]


portfolio before change:  [25.6142609]
curr_Stock_Price:  101.06802390727496
curr_Factors:  [101.06802391]
mat_Sqrt:  [[0.15]]
grads:  [0.09353649]
Stock Position:  0.09353648794551403
Bond Position:  [16.1607129]


portfolio before change:  [25.59489103]
curr_Stock_Price:  100.85014162189216
curr_Factors:  [100.85014162]
mat_Sqrt:  [[0.15]]
grads:  [0.07217425]
Stock Position:  0.07217425384928744
Bond Position:  [18.31610731]


portfolio before change:  [25.52171052]
curr_Stock_Price:  99.82033805454417
curr_Factors:  [99.82033805]
mat_Sqrt:  [[0.15]]
grads:  [0.02858601]
Stock Position:  0.028586014981833448
Bond Position:  [22.66824484]


portfolio before change:  [25.51318669]
curr_Stock_Price:  99.47259325140475
curr_Factors:  [99.47259325]
mat_Sqrt:  [[0.15]]
grads:  [0.03814313]
Stock Position:  0.03814313365655793
Bond Position:  [21.71899027]


portfolio before change:  [25.51912455]
curr_Stock_Price:  99.592677163493
curr_Factors:  [99.59267716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01507018]
Stock Position:  -0.015070175860181969
Bond Position:  [27.02000371]


portfolio before change:  [25.51508406]
curr_Stock_Price:  99.97285145133877
curr_Factors:  [99.97285145]
mat_Sqrt:  [[0.15]]
grads:  [-0.01085123]
Stock Position:  -0.010851234430372485
Bond Position:  [26.59991291]


portfolio before change:  [25.52348836]
curr_Stock_Price:  99.35156199660665
curr_Factors:  [99.351562]
mat_Sqrt:  [[0.15]]
grads:  [-0.0211269]
Stock Position:  -0.02112690477794359
Bond Position:  [27.62247935]


portfolio before change:  [25.51846077]
curr_Stock_Price:  99.67125163907448
curr_Factors:  [99.67125164]
mat_Sqrt:  [[0.15]]
grads:  [0.01274954]
Stock Position:  0.012749540709741127
Bond Position:  [24.24769809]


portfolio before change:  [25.52336194]
curr_Stock_Price:  99.93680210868737
curr_Factors:  [99.93680211]
mat_Sqrt:  [[0.15]]
grads:  [0.01808551]
Stock Position:  0.018085514410381746
Bond Position:  [23.71595347]


portfolio before change:  [25.52978904]
curr_Stock_Price:  100.21021459004061
curr_Factors:  [100.21021459]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844078]
Stock Position:  -0.028440775493219998
Bond Position:  [28.37984526]


portfolio before change:  [25.5361456]
curr_Stock_Price:  100.04908097905289
curr_Factors:  [100.04908098]
mat_Sqrt:  [[0.15]]
grads:  [-0.02788853]
Stock Position:  -0.02788852918476894
Bond Position:  [28.32636732]


portfolio before change:  [25.52191925]
curr_Stock_Price:  100.62267920500584
curr_Factors:  [100.62267921]
mat_Sqrt:  [[0.15]]
grads:  [0.05561467]
Stock Position:  0.05561467087940252
Bond Position:  [19.92582206]


portfolio before change:  [25.50526141]
curr_Stock_Price:  100.30076345247167
curr_Factors:  [100.30076345]
mat_Sqrt:  [[0.15]]
grads:  [0.01628837]
Stock Position:  0.016288365413899518
Bond Position:  [23.87152592]


portfolio before change:  [25.4913857]
curr_Stock_Price:  99.35728454719786
curr_Factors:  [99.35728455]
mat_Sqrt:  [[0.15]]
grads:  [0.04930304]
Stock Position:  0.049303039821438896
Bond Position:  [20.59276954]


portfolio before change:  [25.5132579]
curr_Stock_Price:  99.77480680940246
curr_Factors:  [99.77480681]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684217]
Stock Position:  -0.02684216585021472
Bond Position:  [28.19142982]


portfolio before change:  [25.51782172]
curr_Stock_Price:  99.67042639080051
curr_Factors:  [99.67042639]
mat_Sqrt:  [[0.15]]
grads:  [-0.00090325]
Stock Position:  -0.0009032462242502977
Bond Position:  [25.60784866]


portfolio before change:  [25.51950052]
curr_Stock_Price:  99.58378054946357
curr_Factors:  [99.58378055]
mat_Sqrt:  [[0.15]]
grads:  [0.02445646]
Stock Position:  0.024456463284951387
Bond Position:  [23.08403345]


portfolio before change:  [25.52576862]
curr_Stock_Price:  99.78108222995388
curr_Factors:  [99.78108223]
mat_Sqrt:  [[0.15]]
grads:  [-0.04781706]
Stock Position:  -0.047817061950319664
Bond Position:  [30.29700681]


portfolio before change:  [25.5353602]
curr_Stock_Price:  99.6200945116024
curr_Factors:  [99.62009451]
mat_Sqrt:  [[0.15]]
grads:  [0.04576675]
Stock Position:  0.04576674862671055
Bond Position:  [20.97607238]


portfolio before change:  [25.54581953]
curr_Stock_Price:  99.819983882049
curr_Factors:  [99.81998388]
mat_Sqrt:  [[0.15]]
grads:  [0.14507302]
Stock Position:  0.14507302356616641
Bond Position:  [11.06463266]


portfolio before change:  [25.48264263]
curr_Stock_Price:  99.3797334207849
curr_Factors:  [99.37973342]
mat_Sqrt:  [[0.15]]
grads:  [0.03596598]
Stock Position:  0.03596597742388322
Bond Position:  [21.90835338]


portfolio before change:  [25.47165063]
curr_Stock_Price:  99.03603883141732
curr_Factors:  [99.03603883]
mat_Sqrt:  [[0.15]]
grads:  [0.05856794]
Stock Position:  0.0585679410901373
Bond Position:  [19.67131374]


portfolio before change:  [25.50197441]
curr_Stock_Price:  99.5328000406382
curr_Factors:  [99.53280004]
mat_Sqrt:  [[0.15]]
grads:  [-0.00284322]
Stock Position:  -0.0028432157684216575
Bond Position:  [25.78496764]


portfolio before change:  [25.50091359]
curr_Stock_Price:  100.47273123488789
curr_Factors:  [100.47273123]
mat_Sqrt:  [[0.15]]
grads:  [0.01827203]
Stock Position:  0.01827203097975182
Bond Position:  [23.66507274]


portfolio before change:  [25.51595172]
curr_Stock_Price:  101.21479486249788
curr_Factors:  [101.21479486]
mat_Sqrt:  [[0.15]]
grads:  [0.13286353]
Stock Position:  0.13286352872312165
Bond Position:  [12.06819691]


portfolio before change:  [25.38203189]
curr_Stock_Price:  100.20116747513872
curr_Factors:  [100.20116748]
mat_Sqrt:  [[0.15]]
grads:  [0.00438406]
Stock Position:  0.004384064359304862
Bond Position:  [24.94274352]


portfolio before change:  [25.38365098]
curr_Stock_Price:  100.21488002495806
curr_Factors:  [100.21488002]
mat_Sqrt:  [[0.15]]
grads:  [-0.10657338]
Stock Position:  -0.10657338011998793
Bond Position:  [36.06388948]


portfolio before change:  [25.33733593]
curr_Stock_Price:  100.67061401514313
curr_Factors:  [100.67061402]
mat_Sqrt:  [[0.15]]
grads:  [-0.0063539]
Stock Position:  -0.0063538953163255986
Bond Position:  [25.97698647]


portfolio before change:  [25.33744774]
curr_Stock_Price:  100.90854641475933
curr_Factors:  [100.90854641]
mat_Sqrt:  [[0.15]]
grads:  [0.00908993]
Stock Position:  0.009089933310011155
Bond Position:  [24.42019579]


portfolio before change:  [25.33755717]
curr_Stock_Price:  100.75267235298217
curr_Factors:  [100.75267235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00389457]
Stock Position:  -0.003894573218404321
Bond Position:  [25.72994583]


portfolio before change:  [25.33915025]
curr_Stock_Price:  100.75654606037835
curr_Factors:  [100.75654606]
mat_Sqrt:  [[0.15]]
grads:  [-0.06442788]
Stock Position:  -0.06442788433704033
Bond Position:  [31.83068135]


portfolio before change:  [25.28512501]
curr_Stock_Price:  101.62596346232588
curr_Factors:  [101.62596346]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823555]
Stock Position:  -0.028235547166147342
Bond Position:  [28.1545897]


portfolio before change:  [25.2799132]
curr_Stock_Price:  101.87286950814064
curr_Factors:  [101.87286951]
mat_Sqrt:  [[0.15]]
grads:  [0.10588178]
Stock Position:  0.10588178230686576
Bond Position:  [14.49343221]


portfolio before change:  [25.29967068]
curr_Stock_Price:  102.05091350378682
curr_Factors:  [102.0509135]
mat_Sqrt:  [[0.15]]
grads:  [-0.04051724]
Stock Position:  -0.04051724128728502
Bond Position:  [29.43449217]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.28385864]
Stock Price:  102.48657377000376
PL:  [22.79728487]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.58859882e-03]
 [ 3.71743940e-02]
 [ 1.89795719e-02]
 [-2.89999867e-02]
 [-3.04746362e-02]
 [-2.14440956e-03]
 [ 2.31390916e-02]
 [-4.86488874e-02]
 [ 1.68445585e-02]
 [-6.17916696e-03]
 [-9.66712167e-03]
 [ 1.18957008e-02]
 [-3.48803893e-03]
 [ 6.73850512e-03]
 [-1.60726163e-03]
 [ 1.38101534e-02]
 [ 3.88222474e-02]
 [-1.47432781e-02]
 [ 1.94707213e-02]
 [ 2.65411910e-03]
 [-4.24274460e-03]
 [ 4.56810454e-03]
 [ 1.51666234e-02]
 [ 1.75594851e-02]
 [-5.32690306e-03]
 [ 4.68363768e-03]
 [-4.08959957e-03]
 [ 5.74090984e-03]
 [ 3.12779497e-02]
 [ 3.54825381e-03]
 [-5.63439129e-03]
 [ 1.34086163e-02]
 [ 1.27049171e-02]
 [ 2.26592151e-03]
 [ 5.44665151e-03]
 [ 1.16995110e-02]
 [-1.46003809e-02]
 [-9.15283104e-03]
 [-2.29813551e-02]
 [-1.52341886e-02]
 [ 3.54851498e-03]
 [ 6.04536585e-03]
 [-1.02559954e-02]
 [ 5.42230048e-03]
 [ 5.72998618e-03]
 [ 1.20588954e-02]
 [ 1.05809666e-02]
 [ 2.23698779e-04]
 [ 1.29021794e-02]
 [-1.29846180e-03]
 [ 1.22018390e-02]
 [-1.71031017e-02]
 [ 2.22408208e-03]
 [-2.51940106e-04]
 [-3.38368166e-03]
 [-3.33315870e-03]
 [ 1.05124092e-02]
 [-1.07954363e-02]
 [ 6.31373377e-03]
 [-3.93695568e-03]
 [-2.22977363e-03]
 [ 7.96326028e-03]
 [-1.07014636e-02]
 [ 7.43341238e-03]
 [ 2.56739703e-02]
 [ 6.08748931e-03]
 [ 1.38462484e-02]
 [ 6.57291789e-03]
 [ 4.79205728e-03]
 [ 1.71613642e-02]
 [ 6.21438474e-04]
 [-1.56387924e-02]
 [-1.13774890e-03]
 [ 1.40073393e-03]
 [ 9.19497393e-04]
 [-1.31275460e-02]
 [-4.00549547e-03]
 [ 1.42410824e-02]
 [-3.73454613e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.31498104]
curr_Stock_Price:  100.60338063205361
curr_Factors:  [100.60338063]
mat_Sqrt:  [[0.15]]
grads:  [-0.03059066]
Stock Position:  -0.03059065880277352
Bond Position:  [18.39250473]


portfolio before change:  [15.30654133]
curr_Stock_Price:  100.91685142816628
curr_Factors:  [100.91685143]
mat_Sqrt:  [[0.15]]
grads:  [0.24782929]
Stock Position:  0.24782929329896286
Bond Position:  [-9.70361065]


portfolio before change:  [15.3923417]
curr_Stock_Price:  101.26550622743918
curr_Factors:  [101.26550623]
mat_Sqrt:  [[0.15]]
grads:  [0.12653048]
Stock Position:  0.1265304794675617
Bond Position:  [2.57916865]


portfolio before change:  [15.40791449]
curr_Stock_Price:  101.38730757978188
curr_Factors:  [101.38730758]
mat_Sqrt:  [[0.15]]
grads:  [-0.19333324]
Stock Position:  -0.19333324446704628
Bond Position:  [35.00945161]


portfolio before change:  [15.42130862]
curr_Stock_Price:  101.32934564848405
curr_Factors:  [101.32934565]
mat_Sqrt:  [[0.15]]
grads:  [-0.20316424]
Stock Position:  -0.2031642415112498
Bond Position:  [36.00780827]


portfolio before change:  [15.13627254]
curr_Stock_Price:  102.7434066767656
curr_Factors:  [102.74340668]
mat_Sqrt:  [[0.15]]
grads:  [-0.01429606]
Stock Position:  -0.01429606375283705
Bond Position:  [16.60509883]


portfolio before change:  [15.13528172]
curr_Stock_Price:  102.88531068368042
curr_Factors:  [102.88531068]
mat_Sqrt:  [[0.15]]
grads:  [0.15426061]
Stock Position:  0.15426061079821085
Bond Position:  [-0.73586915]


portfolio before change:  [15.04360873]
curr_Stock_Price:  102.29133533605483
curr_Factors:  [102.29133534]
mat_Sqrt:  [[0.15]]
grads:  [-0.32432592]
Stock Position:  -0.32432591580010467
Bond Position:  [48.21933974]


portfolio before change:  [15.10604619]
curr_Stock_Price:  102.10811328343574
curr_Factors:  [102.10811328]
mat_Sqrt:  [[0.15]]
grads:  [0.11229706]
Stock Position:  0.11229705650894267
Bond Position:  [3.63960562]


portfolio before change:  [15.06667838]
curr_Stock_Price:  101.75551904911998
curr_Factors:  [101.75551905]
mat_Sqrt:  [[0.15]]
grads:  [-0.04119445]
Stock Position:  -0.04119444638666935
Bond Position:  [19.25844065]


portfolio before change:  [15.06624282]
curr_Stock_Price:  101.79531209694748
curr_Factors:  [101.7953121]
mat_Sqrt:  [[0.15]]
grads:  [-0.06444748]
Stock Position:  -0.06444747780853785
Bond Position:  [21.62669393]


portfolio before change:  [15.0953875]
curr_Stock_Price:  101.36406210933694
curr_Factors:  [101.36406211]
mat_Sqrt:  [[0.15]]
grads:  [0.07930467]
Stock Position:  0.07930467227564275
Bond Position:  [7.05674377]


portfolio before change:  [15.08458601]
curr_Stock_Price:  101.22229802823665
curr_Factors:  [101.22229803]
mat_Sqrt:  [[0.15]]
grads:  [-0.02325359]
Stock Position:  -0.023253592839308328
Bond Position:  [17.43836811]


portfolio before change:  [15.09661885]
curr_Stock_Price:  100.75170787076914
curr_Factors:  [100.75170787]
mat_Sqrt:  [[0.15]]
grads:  [0.04492337]
Stock Position:  0.044923367464289876
Bond Position:  [10.57051286]


portfolio before change:  [15.10074085]
curr_Stock_Price:  100.82875738210045
curr_Factors:  [100.82875738]
mat_Sqrt:  [[0.15]]
grads:  [-0.01071508]
Stock Position:  -0.0107150775573034
Bond Position:  [16.18112881]


portfolio before change:  [15.10740899]
curr_Stock_Price:  100.30082965832912
curr_Factors:  [100.30082966]
mat_Sqrt:  [[0.15]]
grads:  [0.09206769]
Stock Position:  0.09206768934718813
Bond Position:  [5.87294336]


portfolio before change:  [15.11257816]
curr_Stock_Price:  100.35298800665254
curr_Factors:  [100.35298801]
mat_Sqrt:  [[0.15]]
grads:  [0.25881498]
Stock Position:  0.2588149828324665
Bond Position:  [-10.86027871]


portfolio before change:  [15.01349061]
curr_Stock_Price:  99.97275978116531
curr_Factors:  [99.97275978]
mat_Sqrt:  [[0.15]]
grads:  [-0.09828852]
Stock Position:  -0.09828852058573911
Bond Position:  [24.83966527]


portfolio before change:  [14.97960185]
curr_Stock_Price:  100.3333439750117
curr_Factors:  [100.33334398]
mat_Sqrt:  [[0.15]]
grads:  [0.12980481]
Stock Position:  0.12980480846282394
Bond Position:  [1.95585135]


portfolio before change:  [14.95754501]
curr_Stock_Price:  100.16247911317436
curr_Factors:  [100.16247911]
mat_Sqrt:  [[0.15]]
grads:  [0.01769413]
Stock Position:  0.017694127317230985
Bond Position:  [13.18525736]


portfolio before change:  [14.96760228]
curr_Stock_Price:  100.68429981448945
curr_Factors:  [100.68429981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02828496]
Stock Position:  -0.028284964015789563
Bond Position:  [17.81545408]


portfolio before change:  [14.99606214]
curr_Stock_Price:  99.71748358410174
curr_Factors:  [99.71748358]
mat_Sqrt:  [[0.15]]
grads:  [0.03045403]
Stock Position:  0.030454030259613244
Bond Position:  [11.95926288]


portfolio before change:  [15.00842315]
curr_Stock_Price:  100.09882966850459
curr_Factors:  [100.09882967]
mat_Sqrt:  [[0.15]]
grads:  [0.10111082]
Stock Position:  0.10111082246881384
Bond Position:  [4.88734815]


portfolio before change:  [14.96899289]
curr_Stock_Price:  99.70583782455016
curr_Factors:  [99.70583782]
mat_Sqrt:  [[0.15]]
grads:  [0.11706323]
Stock Position:  0.11706323406243271
Bond Position:  [3.29710506]


portfolio before change:  [14.9916559]
curr_Stock_Price:  99.8976738032011
curr_Factors:  [99.8976738]
mat_Sqrt:  [[0.15]]
grads:  [-0.03551269]
Stock Position:  -0.035512687074082144
Bond Position:  [18.53929073]


portfolio before change:  [14.98967887]
curr_Stock_Price:  99.98597400168495
curr_Factors:  [99.985974]
mat_Sqrt:  [[0.15]]
grads:  [0.03122425]
Stock Position:  0.031224251183320298
Bond Position:  [11.8676917]


portfolio before change:  [15.00715353]
curr_Stock_Price:  100.52186871627683
curr_Factors:  [100.52186872]
mat_Sqrt:  [[0.15]]
grads:  [-0.027264]
Stock Position:  -0.02726399711832604
Bond Position:  [17.74778147]


portfolio before change:  [15.00285521]
curr_Stock_Price:  100.72021063582301
curr_Factors:  [100.72021064]
mat_Sqrt:  [[0.15]]
grads:  [0.03827273]
Stock Position:  0.03827273229115135
Bond Position:  [11.14801755]


portfolio before change:  [15.0011306]
curr_Stock_Price:  100.6569440366925
curr_Factors:  [100.65694404]
mat_Sqrt:  [[0.15]]
grads:  [0.20851966]
Stock Position:  0.2085196649189961
Bond Position:  [-5.98782165]


portfolio before change:  [14.9695182]
curr_Stock_Price:  100.50713491681532
curr_Factors:  [100.50713492]
mat_Sqrt:  [[0.15]]
grads:  [0.02365503]
Stock Position:  0.023655025373179688
Bond Position:  [12.59201937]


portfolio before change:  [14.98465168]
curr_Stock_Price:  101.11362162056018
curr_Factors:  [101.11362162]
mat_Sqrt:  [[0.15]]
grads:  [-0.03756261]
Stock Position:  -0.0375626086140749
Bond Position:  [18.78274308]


portfolio before change:  [14.96605824]
curr_Stock_Price:  101.63987364345599
curr_Factors:  [101.63987364]
mat_Sqrt:  [[0.15]]
grads:  [0.08939078]
Stock Position:  0.08939077536599213
Bond Position:  [5.88039113]


portfolio before change:  [14.94999167]
curr_Stock_Price:  101.45602799106484
curr_Factors:  [101.45602799]
mat_Sqrt:  [[0.15]]
grads:  [0.08469945]
Stock Position:  0.08469944721439014
Bond Position:  [6.35672219]


portfolio before change:  [15.02025035]
curr_Stock_Price:  102.28084297750594
curr_Factors:  [102.28084298]
mat_Sqrt:  [[0.15]]
grads:  [0.01510614]
Stock Position:  0.015106143414210679
Bond Position:  [13.47518127]


portfolio before change:  [15.02484482]
curr_Stock_Price:  102.52923447947101
curr_Factors:  [102.52923448]
mat_Sqrt:  [[0.15]]
grads:  [0.03631101]
Stock Position:  0.03631101009317215
Bond Position:  [11.30190475]


portfolio before change:  [15.01899793]
curr_Stock_Price:  102.34875807624731
curr_Factors:  [102.34875808]
mat_Sqrt:  [[0.15]]
grads:  [0.07799674]
Stock Position:  0.07799674011691879
Bond Position:  [7.03612844]


portfolio before change:  [15.10310352]
curr_Stock_Price:  103.42144161165842
curr_Factors:  [103.42144161]
mat_Sqrt:  [[0.15]]
grads:  [-0.09733587]
Stock Position:  -0.09733587283693182
Bond Position:  [25.16971981]


portfolio before change:  [15.07085771]
curr_Stock_Price:  103.76888760662095
curr_Factors:  [103.76888761]
mat_Sqrt:  [[0.15]]
grads:  [-0.06101887]
Stock Position:  -0.06101887362979656
Bond Position:  [21.40271835]


portfolio before change:  [15.12251529]
curr_Stock_Price:  102.94422702329025
curr_Factors:  [102.94422702]
mat_Sqrt:  [[0.15]]
grads:  [-0.15320903]
Stock Position:  -0.15320903389768345
Bond Position:  [30.89450085]


portfolio before change:  [15.1040852]
curr_Stock_Price:  103.07712420797472
curr_Factors:  [103.07712421]
mat_Sqrt:  [[0.15]]
grads:  [-0.10156126]
Stock Position:  -0.10156125729403886
Bond Position:  [25.57272754]


portfolio before change:  [15.01708469]
curr_Stock_Price:  103.94949289131203
curr_Factors:  [103.94949289]
mat_Sqrt:  [[0.15]]
grads:  [0.02365677]
Stock Position:  0.02365676653803267
Bond Position:  [12.5579758]


portfolio before change:  [15.0255719]
curr_Stock_Price:  104.27507892794954
curr_Factors:  [104.27507893]
mat_Sqrt:  [[0.15]]
grads:  [0.04030244]
Stock Position:  0.040302439000627285
Bond Position:  [10.82303189]


portfolio before change:  [14.99928838]
curr_Stock_Price:  103.60613731757475
curr_Factors:  [103.60613732]
mat_Sqrt:  [[0.15]]
grads:  [-0.0683733]
Stock Position:  -0.06837330265933546
Bond Position:  [22.08318217]


portfolio before change:  [14.99164402]
curr_Stock_Price:  103.73812746224515
curr_Factors:  [103.73812746]
mat_Sqrt:  [[0.15]]
grads:  [0.03614867]
Stock Position:  0.03614866988368992
Bond Position:  [11.2416487]


portfolio before change:  [14.97597954]
curr_Stock_Price:  103.28535539658837
curr_Factors:  [103.2853554]
mat_Sqrt:  [[0.15]]
grads:  [0.03819991]
Stock Position:  0.03819990783725444
Bond Position:  [11.03048848]


portfolio before change:  [14.96224982]
curr_Stock_Price:  102.90788980215274
curr_Factors:  [102.9078898]
mat_Sqrt:  [[0.15]]
grads:  [0.08039264]
Stock Position:  0.08039263590907794
Bond Position:  [6.6892133]


portfolio before change:  [14.92232666]
curr_Stock_Price:  102.40608712523618
curr_Factors:  [102.40608713]
mat_Sqrt:  [[0.15]]
grads:  [0.07053978]
Stock Position:  0.07053977721631985
Bond Position:  [7.69862409]


portfolio before change:  [14.89885516]
curr_Stock_Price:  102.06652438098679
curr_Factors:  [102.06652438]
mat_Sqrt:  [[0.15]]
grads:  [0.00149133]
Stock Position:  0.0014913251924678521
Bond Position:  [14.74664078]


portfolio before change:  [14.89873069]
curr_Stock_Price:  101.36502436322091
curr_Factors:  [101.36502436]
mat_Sqrt:  [[0.15]]
grads:  [0.08601453]
Stock Position:  0.08601452940245875
Bond Position:  [6.17986582]


portfolio before change:  [14.89080838]
curr_Stock_Price:  101.26842943521882
curr_Factors:  [101.26842944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865641]
Stock Position:  -0.008656411970429783
Bond Position:  [15.76742962]


portfolio before change:  [14.89061977]
curr_Stock_Price:  101.40406324268545
curr_Factors:  [101.40406324]
mat_Sqrt:  [[0.15]]
grads:  [0.08134559]
Stock Position:  0.08134559326388768
Bond Position:  [6.64184609]


portfolio before change:  [14.88518279]
curr_Stock_Price:  101.33212187842811
curr_Factors:  [101.33212188]
mat_Sqrt:  [[0.15]]
grads:  [-0.11402068]
Stock Position:  -0.11402067808057938
Bond Position:  [26.43914003]


portfolio before change:  [14.92726035]
curr_Stock_Price:  100.97758031951646
curr_Factors:  [100.97758032]
mat_Sqrt:  [[0.15]]
grads:  [0.01482721]
Stock Position:  0.014827213860367274
Bond Position:  [13.43004418]


portfolio before change:  [14.93378123]
curr_Stock_Price:  101.36075885613667
curr_Factors:  [101.36075886]
mat_Sqrt:  [[0.15]]
grads:  [-0.0016796]
Stock Position:  -0.001679600706694801
Bond Position:  [15.10402683]


portfolio before change:  [14.93379802]
curr_Stock_Price:  101.91281724627301
curr_Factors:  [101.91281725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255788]
Stock Position:  -0.02255787773402626
Bond Position:  [17.23273489]


portfolio before change:  [14.93430604]
curr_Stock_Price:  101.93804415737502
curr_Factors:  [101.93804416]
mat_Sqrt:  [[0.15]]
grads:  [-0.02222106]
Stock Position:  -0.022221058027304917
Bond Position:  [17.19947723]


portfolio before change:  [14.93711821]
curr_Stock_Price:  101.85986723056072
curr_Factors:  [101.85986723]
mat_Sqrt:  [[0.15]]
grads:  [0.07008273]
Stock Position:  0.07008272809103695
Bond Position:  [7.79850083]


portfolio before change:  [15.00965257]
curr_Stock_Price:  102.88789421358247
curr_Factors:  [102.88789421]
mat_Sqrt:  [[0.15]]
grads:  [-0.07196958]
Stock Position:  -0.07196957522545372
Bond Position:  [22.41445061]


portfolio before change:  [15.06905836]
curr_Stock_Price:  102.08193080031066
curr_Factors:  [102.0819308]
mat_Sqrt:  [[0.15]]
grads:  [0.04209156]
Stock Position:  0.042091558477239124
Bond Position:  [10.7722708]


portfolio before change:  [15.07503743]
curr_Stock_Price:  102.20798426180941
curr_Factors:  [102.20798426]
mat_Sqrt:  [[0.15]]
grads:  [-0.02624637]
Stock Position:  -0.02624637117127314
Bond Position:  [17.75762613]


portfolio before change:  [15.08026426]
curr_Stock_Price:  102.05112668984725
curr_Factors:  [102.05112669]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486516]
Stock Position:  -0.014865157518261013
Bond Position:  [16.59727034]


portfolio before change:  [15.08810693]
curr_Stock_Price:  101.59332432879589
curr_Factors:  [101.59332433]
mat_Sqrt:  [[0.15]]
grads:  [0.0530884]
Stock Position:  0.05308840189174782
Bond Position:  [9.6946797]


portfolio before change:  [15.06344718]
curr_Stock_Price:  101.11740706647252
curr_Factors:  [101.11740707]
mat_Sqrt:  [[0.15]]
grads:  [-0.07134309]
Stock Position:  -0.07134309039435167
Bond Position:  [22.27747549]


portfolio before change:  [15.07723576]
curr_Stock_Price:  100.94365241814438
curr_Factors:  [100.94365242]
mat_Sqrt:  [[0.15]]
grads:  [0.04955608]
Stock Position:  0.04955608252178419
Bond Position:  [10.07486379]


portfolio before change:  [15.12501334]
curr_Stock_Price:  101.89505704547983
curr_Factors:  [101.89505705]
mat_Sqrt:  [[0.15]]
grads:  [0.1711598]
Stock Position:  0.17115980214957294
Bond Position:  [-2.31532446]


portfolio before change:  [15.1583409]
curr_Stock_Price:  102.09061858140068
curr_Factors:  [102.09061858]
mat_Sqrt:  [[0.15]]
grads:  [0.04058326]
Stock Position:  0.04058326207488863
Bond Position:  [11.01517057]


portfolio before change:  [15.19748879]
curr_Stock_Price:  103.03828544657813
curr_Factors:  [103.03828545]
mat_Sqrt:  [[0.15]]
grads:  [0.09230832]
Stock Position:  0.0923083226083282
Bond Position:  [5.68619749]


portfolio before change:  [15.14879713]
curr_Stock_Price:  102.50694602970717
curr_Factors:  [102.50694603]
mat_Sqrt:  [[0.15]]
grads:  [0.04381945]
Stock Position:  0.04381945258536347
Bond Position:  [10.65699887]


portfolio before change:  [15.15822692]
curr_Stock_Price:  102.70694183815422
curr_Factors:  [102.70694184]
mat_Sqrt:  [[0.15]]
grads:  [0.03194705]
Stock Position:  0.03194704855315882
Bond Position:  [11.87704327]


portfolio before change:  [15.14905971]
curr_Stock_Price:  102.39675519428539
curr_Factors:  [102.39675519]
mat_Sqrt:  [[0.15]]
grads:  [0.11440909]
Stock Position:  0.11440909462876334
Bond Position:  [3.43393966]


portfolio before change:  [15.11618412]
curr_Stock_Price:  102.10752798488706
curr_Factors:  [102.10752798]
mat_Sqrt:  [[0.15]]
grads:  [0.00414292]
Stock Position:  0.004142923156782554
Bond Position:  [14.69316048]


portfolio before change:  [15.11649207]
curr_Stock_Price:  101.96019248581406
curr_Factors:  [101.96019249]
mat_Sqrt:  [[0.15]]
grads:  [-0.10425862]
Stock Position:  -0.10425861577607483
Bond Position:  [25.7467206]


portfolio before change:  [15.10635005]
curr_Stock_Price:  102.07290489512732
curr_Factors:  [102.0729049]
mat_Sqrt:  [[0.15]]
grads:  [-0.00758499]
Stock Position:  -0.007584992633798404
Bond Position:  [15.88057228]


portfolio before change:  [15.11375219]
curr_Stock_Price:  101.22787199317685
curr_Factors:  [101.22787199]
mat_Sqrt:  [[0.15]]
grads:  [0.00933823]
Stock Position:  0.00933822619736404
Bond Position:  [14.16846342]


portfolio before change:  [15.11607487]
curr_Stock_Price:  101.3817694397104
curr_Factors:  [101.38176944]
mat_Sqrt:  [[0.15]]
grads:  [0.00612998]
Stock Position:  0.0061299826200607605
Bond Position:  [14.49460639]


portfolio before change:  [15.11838009]
curr_Stock_Price:  101.61003644493306
curr_Factors:  [101.61003644]
mat_Sqrt:  [[0.15]]
grads:  [-0.08751697]
Stock Position:  -0.08751697360589455
Bond Position:  [24.01098296]


portfolio before change:  [15.06371171]
curr_Stock_Price:  102.25184465084104
curr_Factors:  [102.25184465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0267033]
Stock Position:  -0.026703303155434368
Bond Position:  [17.79417371]


portfolio before change:  [15.05717884]
curr_Stock_Price:  102.53814040906832
curr_Factors:  [102.53814041]
mat_Sqrt:  [[0.15]]
grads:  [0.09494055]
Stock Position:  0.09494054911327698
Bond Position:  [5.32215148]


portfolio before change:  [15.06299026]
curr_Stock_Price:  102.5958479184556
curr_Factors:  [102.59584792]
mat_Sqrt:  [[0.15]]
grads:  [-0.02489697]
Stock Position:  -0.024896974215667042
Bond Position:  [17.61731644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.08669702]
Stock Price:  101.68788074900523
PL:  [13.39881627]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.10637099e-03]
 [ 1.27253732e-02]
 [ 2.75623355e-03]
 [-8.81496613e-03]
 [ 1.50737493e-02]
 [-9.28398560e-03]
 [ 2.06917508e-03]
 [-2.95926192e-02]
 [ 1.50852164e-02]
 [-5.86369725e-03]
 [-1.07280493e-02]
 [ 1.62712706e-02]
 [-4.17261393e-03]
 [ 2.82931260e-03]
 [ 4.13716840e-03]
 [ 1.11453032e-02]
 [ 8.40940372e-02]
 [-1.35695268e-02]
 [ 1.93588693e-02]
 [ 1.08081096e-03]
 [-5.58024501e-03]
 [ 5.75096221e-03]
 [ 7.39543552e-03]
 [ 3.22946838e-02]
 [ 2.37380719e-03]
 [ 8.17035018e-03]
 [ 1.31586485e-02]
 [ 2.40018612e-02]
 [ 7.43517845e-03]
 [-8.04313361e-03]
 [ 2.05299358e-03]
 [ 1.44326728e-02]
 [ 1.42644076e-02]
 [-5.57203432e-03]
 [ 4.93579759e-03]
 [ 5.00916697e-03]
 [-1.80129030e-02]
 [-5.90249088e-03]
 [-1.60001772e-02]
 [-2.31624639e-02]
 [ 3.83969765e-03]
 [ 8.64724654e-03]
 [-8.81902777e-03]
 [-1.55249332e-03]
 [ 1.22002942e-02]
 [ 1.28227951e-02]
 [ 1.05787730e-02]
 [ 1.17477361e-04]
 [ 1.24399740e-02]
 [-1.56136305e-03]
 [ 9.53077826e-04]
 [-1.49297716e-02]
 [ 1.93973311e-03]
 [ 1.15994724e-03]
 [-3.12788104e-03]
 [-3.27438903e-03]
 [ 1.06788900e-02]
 [-1.42125935e-02]
 [ 5.75097317e-03]
 [-3.80123504e-03]
 [-3.99154406e-03]
 [ 7.08339275e-03]
 [-1.96040771e-02]
 [ 1.25613006e-03]
 [ 2.29004338e-02]
 [ 8.20945349e-03]
 [ 1.51176921e-02]
 [ 6.75681346e-03]
 [ 4.56595835e-03]
 [ 1.52470153e-02]
 [ 7.28074163e-04]
 [-1.56070289e-02]
 [-5.44022169e-05]
 [ 1.37305235e-03]
 [-2.31751286e-04]
 [-1.22697123e-02]
 [-4.19985764e-03]
 [ 1.55188938e-02]
 [-8.52053855e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.77992229]
curr_Stock_Price:  100.26115370541488
curr_Factors:  [100.26115371]
mat_Sqrt:  [[0.15]]
grads:  [-0.02070914]
Stock Position:  -0.020709139947029283
Bond Position:  [9.85624456]


portfolio before change:  [7.78417364]
curr_Stock_Price:  100.08561222954224
curr_Factors:  [100.08561223]
mat_Sqrt:  [[0.15]]
grads:  [0.08483582]
Stock Position:  0.08483582163290235
Bond Position:  [-0.70667151]


portfolio before change:  [7.76831368]
curr_Stock_Price:  99.89918398987034
curr_Factors:  [99.89918399]
mat_Sqrt:  [[0.15]]
grads:  [0.01837489]
Stock Position:  0.01837489033357835
Bond Position:  [5.93267713]


portfolio before change:  [7.76515157]
curr_Stock_Price:  99.70691550329674
curr_Factors:  [99.7069155]
mat_Sqrt:  [[0.15]]
grads:  [-0.05876644]
Stock Position:  -0.058766440843759225
Bond Position:  [13.62457212]


portfolio before change:  [7.76971671]
curr_Stock_Price:  99.643723389988
curr_Factors:  [99.64372339]
mat_Sqrt:  [[0.15]]
grads:  [0.10049166]
Stock Position:  0.10049166174543411
Bond Position:  [-2.24364664]


portfolio before change:  [7.77472329]
curr_Stock_Price:  99.694939671223
curr_Factors:  [99.69493967]
mat_Sqrt:  [[0.15]]
grads:  [-0.06189324]
Stock Position:  -0.06189323731558896
Bond Position:  [13.94516585]


portfolio before change:  [7.75155359]
curr_Stock_Price:  100.08337142025141
curr_Factors:  [100.08337142]
mat_Sqrt:  [[0.15]]
grads:  [0.0137945]
Stock Position:  0.013794500522217082
Bond Position:  [6.37095347]


portfolio before change:  [7.76578588]
curr_Stock_Price:  101.08624172269107
curr_Factors:  [101.08624172]
mat_Sqrt:  [[0.15]]
grads:  [-0.19728413]
Stock Position:  -0.19728412782966911
Bond Position:  [27.70849691]


portfolio before change:  [7.68178392]
curr_Stock_Price:  101.52081185244057
curr_Factors:  [101.52081185]
mat_Sqrt:  [[0.15]]
grads:  [0.10056811]
Stock Position:  0.1005681091315792
Bond Position:  [-2.52797216]


portfolio before change:  [7.70029329]
curr_Stock_Price:  101.70643098362095
curr_Factors:  [101.70643098]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909131]
Stock Position:  -0.03909131497130003
Bond Position:  [11.67613141]


portfolio before change:  [7.67655804]
curr_Stock_Price:  102.3322739908397
curr_Factors:  [102.33227399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07152033]
Stock Position:  -0.07152032880752592
Bond Position:  [14.99539593]


portfolio before change:  [7.71709953]
curr_Stock_Price:  101.77852588263923
curr_Factors:  [101.77852588]
mat_Sqrt:  [[0.15]]
grads:  [0.10847514]
Stock Position:  0.10847513762754535
Bond Position:  [-3.32334007]


portfolio before change:  [7.75640005]
curr_Stock_Price:  102.14274052721187
curr_Factors:  [102.14274053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02781743]
Stock Position:  -0.027817426201291972
Bond Position:  [10.59774819]


portfolio before change:  [7.75883642]
curr_Stock_Price:  102.07896796317466
curr_Factors:  [102.07896796]
mat_Sqrt:  [[0.15]]
grads:  [0.01886208]
Stock Position:  0.018862083980221583
Bond Position:  [5.83341435]


portfolio before change:  [7.75814006]
curr_Stock_Price:  102.02271980956706
curr_Factors:  [102.02271981]
mat_Sqrt:  [[0.15]]
grads:  [0.02758112]
Stock Position:  0.0275811226724571
Bond Position:  [4.94423891]


portfolio before change:  [7.76580127]
curr_Stock_Price:  102.28928580258045
curr_Factors:  [102.2892858]
mat_Sqrt:  [[0.15]]
grads:  [0.07430202]
Stock Position:  0.07430202151976871
Bond Position:  [0.16550056]


portfolio before change:  [7.72881778]
curr_Stock_Price:  101.79140116335279
curr_Factors:  [101.79140116]
mat_Sqrt:  [[0.15]]
grads:  [0.56062691]
Stock Position:  0.5606269145739367
Bond Position:  [-49.33818138]


portfolio before change:  [7.58870608]
curr_Stock_Price:  101.54698198130201
curr_Factors:  [101.54698198]
mat_Sqrt:  [[0.15]]
grads:  [-0.09046351]
Stock Position:  -0.09046351216120414
Bond Position:  [16.77500272]


portfolio before change:  [7.56983672]
curr_Stock_Price:  101.76715724787877
curr_Factors:  [101.76715725]
mat_Sqrt:  [[0.15]]
grads:  [0.12905913]
Stock Position:  0.12905912843338888
Bond Position:  [-5.5641439]


portfolio before change:  [7.61308291]
curr_Stock_Price:  102.10494007268404
curr_Factors:  [102.10494007]
mat_Sqrt:  [[0.15]]
grads:  [0.00720541]
Stock Position:  0.007205406367471829
Bond Position:  [6.87737532]


portfolio before change:  [7.61552978]
curr_Stock_Price:  102.38487158118747
curr_Factors:  [102.38487158]
mat_Sqrt:  [[0.15]]
grads:  [-0.03720163]
Stock Position:  -0.03720163343200617
Bond Position:  [11.42441424]


portfolio before change:  [7.60098114]
curr_Stock_Price:  102.79514068089395
curr_Factors:  [102.79514068]
mat_Sqrt:  [[0.15]]
grads:  [0.03833975]
Stock Position:  0.03833974806892866
Bond Position:  [3.65984135]


portfolio before change:  [7.59091685]
curr_Stock_Price:  102.52667155113106
curr_Factors:  [102.52667155]
mat_Sqrt:  [[0.15]]
grads:  [0.0493029]
Stock Position:  0.049302903449695054
Bond Position:  [2.53605426]


portfolio before change:  [7.5808502]
curr_Stock_Price:  102.3192768327404
curr_Factors:  [102.31927683]
mat_Sqrt:  [[0.15]]
grads:  [0.21529789]
Stock Position:  0.21529789168417424
Bond Position:  [-14.44827438]


portfolio before change:  [7.68058952]
curr_Stock_Price:  102.78673318427703
curr_Factors:  [102.78673318]
mat_Sqrt:  [[0.15]]
grads:  [0.01582538]
Stock Position:  0.015825381234250493
Bond Position:  [6.05395028]


portfolio before change:  [7.68137956]
curr_Stock_Price:  102.81274580509172
curr_Factors:  [102.81274581]
mat_Sqrt:  [[0.15]]
grads:  [0.054469]
Stock Position:  0.05446900123138394
Bond Position:  [2.08127199]


portfolio before change:  [7.66897869]
curr_Stock_Price:  102.58268910790946
curr_Factors:  [102.58268911]
mat_Sqrt:  [[0.15]]
grads:  [0.08772432]
Stock Position:  0.08772432332956505
Bond Position:  [-1.3300183]


portfolio before change:  [7.74618558]
curr_Stock_Price:  103.46374491018585
curr_Factors:  [103.46374491]
mat_Sqrt:  [[0.15]]
grads:  [0.16001241]
Stock Position:  0.16001240807210837
Bond Position:  [-8.80929739]


portfolio before change:  [7.86097838]
curr_Stock_Price:  104.18458522665111
curr_Factors:  [104.18458523]
mat_Sqrt:  [[0.15]]
grads:  [0.04956786]
Stock Position:  0.04956785634753406
Bond Position:  [2.69677183]


portfolio before change:  [7.83713423]
curr_Stock_Price:  103.70014422271612
curr_Factors:  [103.70014422]
mat_Sqrt:  [[0.15]]
grads:  [-0.05362089]
Stock Position:  -0.05362089072574523
Bond Position:  [13.39762833]


portfolio before change:  [7.84667231]
curr_Stock_Price:  103.5378810354845
curr_Factors:  [103.53788104]
mat_Sqrt:  [[0.15]]
grads:  [0.01368662]
Stock Position:  0.01368662389551591
Bond Position:  [6.42958827]


portfolio before change:  [7.84339379]
curr_Stock_Price:  103.26897804625197
curr_Factors:  [103.26897805]
mat_Sqrt:  [[0.15]]
grads:  [0.09621782]
Stock Position:  0.09621781872210335
Bond Position:  [-2.09292201]


portfolio before change:  [7.83262079]
curr_Stock_Price:  103.15837280338492
curr_Factors:  [103.1583728]
mat_Sqrt:  [[0.15]]
grads:  [0.09509605]
Stock Position:  0.09509605073404996
Bond Position:  [-1.97733307]


portfolio before change:  [7.87603738]
curr_Stock_Price:  103.61622757689565
curr_Factors:  [103.61622758]
mat_Sqrt:  [[0.15]]
grads:  [-0.0371469]
Stock Position:  -0.037146895462982686
Bond Position:  [11.72505856]


portfolio before change:  [7.90706555]
curr_Stock_Price:  102.80067264100607
curr_Factors:  [102.80067264]
mat_Sqrt:  [[0.15]]
grads:  [0.03290532]
Stock Position:  0.03290531727934068
Bond Position:  [4.5243768]


portfolio before change:  [7.91612112]
curr_Stock_Price:  103.06727954375246
curr_Factors:  [103.06727954]
mat_Sqrt:  [[0.15]]
grads:  [0.03339445]
Stock Position:  0.03339444649595719
Bond Position:  [4.47424637]


portfolio before change:  [7.91318218]
curr_Stock_Price:  102.97089857272681
curr_Factors:  [102.97089857]
mat_Sqrt:  [[0.15]]
grads:  [-0.12008602]
Stock Position:  -0.12008601969308658
Bond Position:  [20.27854754]


portfolio before change:  [7.90366345]
curr_Stock_Price:  103.06071898391795
curr_Factors:  [103.06071898]
mat_Sqrt:  [[0.15]]
grads:  [-0.03934994]
Stock Position:  -0.039349939187449605
Bond Position:  [11.95909648]


portfolio before change:  [7.88685148]
curr_Stock_Price:  103.50695714454612
curr_Factors:  [103.50695714]
mat_Sqrt:  [[0.15]]
grads:  [-0.10666785]
Stock Position:  -0.10666784779061222
Bond Position:  [18.92771583]


portfolio before change:  [7.8593195]
curr_Stock_Price:  103.77615720928573
curr_Factors:  [103.77615721]
mat_Sqrt:  [[0.15]]
grads:  [-0.15441643]
Stock Position:  -0.15441642596408459
Bond Position:  [23.8840628]


portfolio before change:  [7.97029389]
curr_Stock_Price:  103.06715498539211
curr_Factors:  [103.06715499]
mat_Sqrt:  [[0.15]]
grads:  [0.02559798]
Stock Position:  0.025597984340285842
Bond Position:  [5.33198248]


portfolio before change:  [7.98116604]
curr_Stock_Price:  103.47886259286696
curr_Factors:  [103.47886259]
mat_Sqrt:  [[0.15]]
grads:  [0.05764831]
Stock Position:  0.05764831025661387
Bond Position:  [2.01578446]


portfolio before change:  [7.95935194]
curr_Stock_Price:  103.09827741796427
curr_Factors:  [103.09827742]
mat_Sqrt:  [[0.15]]
grads:  [-0.05879352]
Stock Position:  -0.0587935184572136
Bond Position:  [14.02086241]


portfolio before change:  [8.00291945]
curr_Stock_Price:  102.37215696045456
curr_Factors:  [102.37215696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034996]
Stock Position:  -0.010349955485379519
Bond Position:  [9.06246671]


portfolio before change:  [8.00820366]
curr_Stock_Price:  101.91632966070912
curr_Factors:  [101.91632966]
mat_Sqrt:  [[0.15]]
grads:  [0.08133529]
Stock Position:  0.08133529479970529
Bond Position:  [-0.28119106]


portfolio before change:  [8.00744418]
curr_Stock_Price:  101.90720811068104
curr_Factors:  [101.90720811]
mat_Sqrt:  [[0.15]]
grads:  [0.0854853]
Stock Position:  0.08548530053525162
Bond Position:  [-0.70412413]


portfolio before change:  [8.05202426]
curr_Stock_Price:  102.42921699020978
curr_Factors:  [102.42921699]
mat_Sqrt:  [[0.15]]
grads:  [0.07052515]
Stock Position:  0.07052515312224725
Bond Position:  [0.82818804]


portfolio before change:  [8.0297439]
curr_Stock_Price:  102.11256228076633
curr_Factors:  [102.11256228]
mat_Sqrt:  [[0.15]]
grads:  [0.00078318]
Stock Position:  0.0007831824046999928
Bond Position:  [7.94977114]


portfolio before change:  [8.02958677]
curr_Stock_Price:  101.27749580918498
curr_Factors:  [101.27749581]
mat_Sqrt:  [[0.15]]
grads:  [0.08293316]
Stock Position:  0.08293315987689054
Bond Position:  [-0.36967599]


portfolio before change:  [7.99002139]
curr_Stock_Price:  100.80069891118909
curr_Factors:  [100.80069891]
mat_Sqrt:  [[0.15]]
grads:  [-0.01040909]
Stock Position:  -0.010409086980099161
Bond Position:  [9.03926463]


portfolio before change:  [7.99626331]
curr_Stock_Price:  100.25531493506008
curr_Factors:  [100.25531494]
mat_Sqrt:  [[0.15]]
grads:  [0.00635385]
Stock Position:  0.006353852173863658
Bond Position:  [7.35925586]


portfolio before change:  [8.00133074]
curr_Stock_Price:  100.98046024106611
curr_Factors:  [100.98046024]
mat_Sqrt:  [[0.15]]
grads:  [-0.09953181]
Stock Position:  -0.09953181090075382
Bond Position:  [18.05209881]


portfolio before change:  [7.97410001]
curr_Stock_Price:  101.26538446308957
curr_Factors:  [101.26538446]
mat_Sqrt:  [[0.15]]
grads:  [0.01293155]
Stock Position:  0.012931554073038047
Bond Position:  [6.66458121]


portfolio before change:  [7.97371231]
curr_Stock_Price:  101.2031914782475
curr_Factors:  [101.20319148]
mat_Sqrt:  [[0.15]]
grads:  [0.00773298]
Stock Position:  0.0077329816178915945
Bond Position:  [7.19110989]


portfolio before change:  [7.98040897]
curr_Stock_Price:  102.01105659801759
curr_Factors:  [102.0110566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085254]
Stock Position:  -0.020852540247139346
Bond Position:  [10.10759863]


portfolio before change:  [7.97608743]
curr_Stock_Price:  102.2485954987869
curr_Factors:  [102.2485955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02182926]
Stock Position:  -0.021829260223678086
Bond Position:  [10.20809863]


portfolio before change:  [7.97087252]
curr_Stock_Price:  102.51671874996872
curr_Factors:  [102.51671875]
mat_Sqrt:  [[0.15]]
grads:  [0.0711926]
Stock Position:  0.0711926001711473
Bond Position:  [0.67244075]


portfolio before change:  [8.03241833]
curr_Stock_Price:  103.38062565430256
curr_Factors:  [103.38062565]
mat_Sqrt:  [[0.15]]
grads:  [-0.09475062]
Stock Position:  -0.09475062354672915
Bond Position:  [17.82779707]


portfolio before change:  [8.11461723]
curr_Stock_Price:  102.52485679550318
curr_Factors:  [102.5248568]
mat_Sqrt:  [[0.15]]
grads:  [0.03833982]
Stock Position:  0.03833982110028962
Bond Position:  [4.18383257]


portfolio before change:  [8.13024774]
curr_Stock_Price:  102.92571952269898
curr_Factors:  [102.92571952]
mat_Sqrt:  [[0.15]]
grads:  [-0.02534157]
Stock Position:  -0.025341566904665432
Bond Position:  [10.73854674]


portfolio before change:  [8.11522089]
curr_Stock_Price:  103.54517707554774
curr_Factors:  [103.54517708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02661029]
Stock Position:  -0.026610293723511695
Bond Position:  [10.87058847]


portfolio before change:  [8.12857895]
curr_Stock_Price:  103.06872140596433
curr_Factors:  [103.06872141]
mat_Sqrt:  [[0.15]]
grads:  [0.04722262]
Stock Position:  0.0472226183175644
Bond Position:  [3.26140406]


portfolio before change:  [8.15236764]
curr_Stock_Price:  103.56816102649758
curr_Factors:  [103.56816103]
mat_Sqrt:  [[0.15]]
grads:  [-0.13069385]
Stock Position:  -0.1306938474404101
Bond Position:  [21.68808908]


portfolio before change:  [8.1452282]
curr_Stock_Price:  103.63316020663432
curr_Factors:  [103.63316021]
mat_Sqrt:  [[0.15]]
grads:  [0.0083742]
Stock Position:  0.008374200387768841
Bond Position:  [7.27738334]


portfolio before change:  [8.13842566]
curr_Stock_Price:  102.76652436859096
curr_Factors:  [102.76652437]
mat_Sqrt:  [[0.15]]
grads:  [0.15266956]
Stock Position:  0.15266955898229484
Bond Position:  [-7.55089429]


portfolio before change:  [8.15316173]
curr_Stock_Price:  102.86613828661565
curr_Factors:  [102.86613829]
mat_Sqrt:  [[0.15]]
grads:  [0.05472969]
Stock Position:  0.05472968993383554
Bond Position:  [2.52332988]


portfolio before change:  [8.14515112]
curr_Stock_Price:  102.71688978310381
curr_Factors:  [102.71688978]
mat_Sqrt:  [[0.15]]
grads:  [0.10078461]
Stock Position:  0.10078461430224418
Bond Position:  [-2.207131]


portfolio before change:  [8.13425358]
curr_Stock_Price:  102.61013156725592
curr_Factors:  [102.61013157]
mat_Sqrt:  [[0.15]]
grads:  [0.04504542]
Stock Position:  0.04504542306257114
Bond Position:  [3.5121368]


portfolio before change:  [8.13265138]
curr_Stock_Price:  102.56968982813444
curr_Factors:  [102.56968983]
mat_Sqrt:  [[0.15]]
grads:  [0.03043972]
Stock Position:  0.03043972235110194
Bond Position:  [5.0104585]


portfolio before change:  [8.14189227]
curr_Stock_Price:  102.86298181257129
curr_Factors:  [102.86298181]
mat_Sqrt:  [[0.15]]
grads:  [0.10164677]
Stock Position:  0.10164676847231593
Bond Position:  [-2.31379742]


portfolio before change:  [8.1271377]
curr_Stock_Price:  102.7192492107322
curr_Factors:  [102.71924921]
mat_Sqrt:  [[0.15]]
grads:  [0.00485383]
Stock Position:  0.004853827753216336
Bond Position:  [7.62855616]


portfolio before change:  [8.12441048]
curr_Stock_Price:  102.05914739116267
curr_Factors:  [102.05914739]
mat_Sqrt:  [[0.15]]
grads:  [-0.10404686]
Stock Position:  -0.10404685928230537
Bond Position:  [18.74334423]


portfolio before change:  [8.16315881]
curr_Stock_Price:  101.69799444694267
curr_Factors:  [101.69799445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00036268]
Stock Position:  -0.0003626814459658373
Bond Position:  [8.20004278]


portfolio before change:  [8.16374263]
curr_Stock_Price:  101.50139967893419
curr_Factors:  [101.50139968]
mat_Sqrt:  [[0.15]]
grads:  [0.00915368]
Stock Position:  0.009153682362254794
Bond Position:  [7.23463106]


portfolio before change:  [8.15856652]
curr_Stock_Price:  100.88653423189928
curr_Factors:  [100.88653423]
mat_Sqrt:  [[0.15]]
grads:  [-0.00154501]
Stock Position:  -0.0015450085747392938
Bond Position:  [8.31443708]


portfolio before change:  [8.15835604]
curr_Stock_Price:  101.35912016145726
curr_Factors:  [101.35912016]
mat_Sqrt:  [[0.15]]
grads:  [-0.08179808]
Stock Position:  -0.08179808209864586
Bond Position:  [16.44933767]


portfolio before change:  [8.12625354]
curr_Stock_Price:  101.76414945106114
curr_Factors:  [101.76414945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02799905]
Stock Position:  -0.027999050939795402
Bond Position:  [10.97555314]


portfolio before change:  [8.11932184]
curr_Stock_Price:  102.03621910967556
curr_Factors:  [102.03621911]
mat_Sqrt:  [[0.15]]
grads:  [0.10345929]
Stock Position:  0.10345929231473115
Bond Position:  [-2.43727318]


portfolio before change:  [8.07277088]
curr_Stock_Price:  101.58774685747083
curr_Factors:  [101.58774686]
mat_Sqrt:  [[0.15]]
grads:  [-0.05680359]
Stock Position:  -0.056803590304443874
Bond Position:  [13.84331964]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.04517759]
Stock Price:  102.08874567558802
PL:  [5.95643191]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.09612565e-03]
 [ 2.35855016e-02]
 [ 1.81122836e-02]
 [-2.43579816e-02]
 [-3.92317466e-02]
 [-2.87502388e-03]
 [ 3.33426431e-02]
 [-7.70242550e-02]
 [ 1.78584803e-02]
 [-9.22958580e-03]
 [-1.25490424e-02]
 [ 2.05197732e-02]
 [-4.31880719e-03]
 [ 2.97126335e-03]
 [ 4.02747233e-03]
 [ 1.44740205e-02]
 [ 7.69217385e-02]
 [-1.32591159e-02]
 [ 1.89671973e-02]
 [ 1.12731568e-03]
 [-4.97644613e-03]
 [ 5.67351541e-03]
 [ 4.69207196e-03]
 [ 3.67947757e-02]
 [ 2.84064346e-03]
 [ 5.64033971e-03]
 [ 8.84146070e-02]
 [ 3.78883700e-02]
 [-6.33290074e-03]
 [-7.05705828e-03]
 [ 8.15273385e-03]
 [ 1.64517098e-02]
 [ 1.78610280e-02]
 [-1.24926988e-02]
 [ 3.79052066e-03]
 [-1.80104968e-02]
 [-9.07679714e-03]
 [-1.67355309e-02]
 [ 7.53617601e-03]
 [-6.15480660e-02]
 [ 3.18546113e-03]
 [-4.71234594e-03]
 [-2.09454425e-02]
 [ 1.93297054e-02]
 [-7.71526537e-03]
 [ 1.17381622e-02]
 [ 1.04691296e-02]
 [-3.10074130e-03]
 [ 1.39120824e-02]
 [-1.48941126e-03]
 [ 2.00088236e-02]
 [ 1.30113311e-02]
 [-3.90928401e-03]
 [-2.75641276e-02]
 [-2.70906441e-03]
 [-2.85612028e-03]
 [ 6.80817012e-03]
 [-1.85061049e-02]
 [ 3.68843819e-03]
 [-3.31787842e-03]
 [-4.52176253e-03]
 [ 6.82175521e-03]
 [-1.97097496e-02]
 [ 8.85448732e-04]
 [ 2.11343806e-02]
 [ 1.39205062e-02]
 [ 7.41134417e-03]
 [ 8.51713479e-03]
 [ 6.06137261e-03]
 [ 1.16876936e-02]
 [ 1.31939078e-03]
 [-1.53745815e-02]
 [-7.32719144e-03]
 [ 9.19308159e-04]
 [-4.75054281e-05]
 [-1.95956209e-02]
 [-3.64260013e-03]
 [ 1.21748379e-02]
 [-2.02752490e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.83774232]
curr_Stock_Price:  101.03588493489752
curr_Factors:  [101.03588493]
mat_Sqrt:  [[0.15]]
grads:  [-0.0473075]
Stock Position:  -0.04730750432027461
Bond Position:  [29.61749789]


portfolio before change:  [24.86505064]
curr_Stock_Price:  100.49776396155775
curr_Factors:  [100.49776396]
mat_Sqrt:  [[0.15]]
grads:  [0.15723668]
Stock Position:  0.15723667762819238
Bond Position:  [9.06311612]


portfolio before change:  [25.0173999]
curr_Stock_Price:  101.46307821054647
curr_Factors:  [101.46307821]
mat_Sqrt:  [[0.15]]
grads:  [0.12074856]
Stock Position:  0.1207485575413731
Bond Position:  [12.76587957]


portfolio before change:  [24.97217565]
curr_Stock_Price:  101.08193787428323
curr_Factors:  [101.08193787]
mat_Sqrt:  [[0.15]]
grads:  [-0.16238654]
Stock Position:  -0.16238654416056872
Bond Position:  [41.38652222]


portfolio before change:  [24.88027053]
curr_Stock_Price:  101.66383249832698
curr_Factors:  [101.6638325]
mat_Sqrt:  [[0.15]]
grads:  [-0.26154498]
Stock Position:  -0.26154497719804976
Bond Position:  [51.46993528]


portfolio before change:  [24.45104265]
curr_Stock_Price:  103.31725690473739
curr_Factors:  [103.3172569]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916683]
Stock Position:  -0.01916682586103022
Bond Position:  [26.43130653]


portfolio before change:  [24.45010063]
curr_Stock_Price:  103.45259658900936
curr_Factors:  [103.45259659]
mat_Sqrt:  [[0.15]]
grads:  [0.22228429]
Stock Position:  0.22228428742283352
Bond Position:  [1.45421392]


portfolio before change:  [24.59093306]
curr_Stock_Price:  104.08575667311108
curr_Factors:  [104.08575667]
mat_Sqrt:  [[0.15]]
grads:  [-0.51349503]
Stock Position:  -0.513495033040393
Bond Position:  [78.03845212]


portfolio before change:  [25.05437625]
curr_Stock_Price:  103.19272829493904
curr_Factors:  [103.19272829]
mat_Sqrt:  [[0.15]]
grads:  [0.11905654]
Stock Position:  0.11905653519191928
Bond Position:  [12.76860756]


portfolio before change:  [25.1184142]
curr_Stock_Price:  103.72390357268101
curr_Factors:  [103.72390357]
mat_Sqrt:  [[0.15]]
grads:  [-0.06153057]
Stock Position:  -0.06153057202253939
Bond Position:  [31.50060532]


portfolio before change:  [25.14962928]
curr_Stock_Price:  103.24859145410527
curr_Factors:  [103.24859145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08366028]
Stock Position:  -0.08366028244004542
Bond Position:  [33.7874356]


portfolio before change:  [25.15716816]
curr_Stock_Price:  103.18372073117871
curr_Factors:  [103.18372073]
mat_Sqrt:  [[0.15]]
grads:  [0.13679849]
Stock Position:  0.13679848773309772
Bond Position:  [11.04179121]


portfolio before change:  [25.04234337]
curr_Stock_Price:  102.33930407166581
curr_Factors:  [102.33930407]
mat_Sqrt:  [[0.15]]
grads:  [-0.02879205]
Stock Position:  -0.028792047932608967
Bond Position:  [27.98890152]


portfolio before change:  [25.04029706]
curr_Stock_Price:  102.47113474937792
curr_Factors:  [102.47113475]
mat_Sqrt:  [[0.15]]
grads:  [0.01980842]
Stock Position:  0.019808422308395406
Bond Position:  [23.01050555]


portfolio before change:  [25.03223417]
curr_Stock_Price:  101.99148543539839
curr_Factors:  [101.99148544]
mat_Sqrt:  [[0.15]]
grads:  [0.02684982]
Stock Position:  0.02684981553815741
Bond Position:  [22.29378159]


portfolio before change:  [25.02183007]
curr_Stock_Price:  101.55209702094739
curr_Factors:  [101.55209702]
mat_Sqrt:  [[0.15]]
grads:  [0.09649347]
Stock Position:  0.09649346989691085
Bond Position:  [15.22271586]


portfolio before change:  [25.03389032]
curr_Stock_Price:  101.66722184344131
curr_Factors:  [101.66722184]
mat_Sqrt:  [[0.15]]
grads:  [0.51281159]
Stock Position:  0.5128115897495686
Bond Position:  [-27.10223934]


portfolio before change:  [25.04605831]
curr_Stock_Price:  101.69425308943656
curr_Factors:  [101.69425309]
mat_Sqrt:  [[0.15]]
grads:  [-0.08839411]
Stock Position:  -0.0883941058346725
Bond Position:  [34.03523088]


portfolio before change:  [25.05305058]
curr_Stock_Price:  101.63921547522145
curr_Factors:  [101.63921548]
mat_Sqrt:  [[0.15]]
grads:  [0.12644798]
Stock Position:  0.1264479821865183
Bond Position:  [12.20097687]


portfolio before change:  [25.10294586]
curr_Stock_Price:  102.0277759956194
curr_Factors:  [102.027776]
mat_Sqrt:  [[0.15]]
grads:  [0.00751544]
Stock Position:  0.007515437837841381
Bond Position:  [24.33616245]


portfolio before change:  [25.1039981]
curr_Stock_Price:  101.96539586349049
curr_Factors:  [101.96539586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317631]
Stock Position:  -0.033176307556241395
Bond Position:  [28.48683343]


portfolio before change:  [25.08120027]
curr_Stock_Price:  102.70623515127737
curr_Factors:  [102.70623515]
mat_Sqrt:  [[0.15]]
grads:  [0.03782344]
Stock Position:  0.03782343605748056
Bond Position:  [21.19649755]


portfolio before change:  [25.09466926]
curr_Stock_Price:  103.02731041791351
curr_Factors:  [103.02731042]
mat_Sqrt:  [[0.15]]
grads:  [0.03128048]
Stock Position:  0.031280479743581696
Bond Position:  [21.87192557]


portfolio before change:  [25.08562698]
curr_Stock_Price:  102.69453656444193
curr_Factors:  [102.69453656]
mat_Sqrt:  [[0.15]]
grads:  [0.2452985]
Stock Position:  0.2452985043740126
Bond Position:  [-0.10518925]


portfolio before change:  [25.15820187]
curr_Stock_Price:  102.99042693515236
curr_Factors:  [102.99042694]
mat_Sqrt:  [[0.15]]
grads:  [0.01893762]
Stock Position:  0.018937623051315963
Bond Position:  [23.20780798]


portfolio before change:  [25.2003745]
curr_Stock_Price:  105.14075493664312
curr_Factors:  [105.14075494]
mat_Sqrt:  [[0.15]]
grads:  [0.03760226]
Stock Position:  0.0376022647659566
Bond Position:  [21.246844]


portfolio before change:  [25.21934853]
curr_Stock_Price:  105.61003677238543
curr_Factors:  [105.61003677]
mat_Sqrt:  [[0.15]]
grads:  [0.58943071]
Stock Position:  0.5894307133435288
Bond Position:  [-37.03045078]


portfolio before change:  [25.30464773]
curr_Stock_Price:  105.75867795321254
curr_Factors:  [105.75867795]
mat_Sqrt:  [[0.15]]
grads:  [0.25258913]
Stock Position:  0.2525891333630992
Bond Position:  [-1.40884508]


portfolio before change:  [25.33121872]
curr_Stock_Price:  105.8642210551384
curr_Factors:  [105.86422106]
mat_Sqrt:  [[0.15]]
grads:  [-0.04221934]
Stock Position:  -0.042219338274820294
Bond Position:  [29.80073608]


portfolio before change:  [25.3294442]
curr_Stock_Price:  105.95036928606905
curr_Factors:  [105.95036929]
mat_Sqrt:  [[0.15]]
grads:  [-0.04704706]
Stock Position:  -0.047047055227420455
Bond Position:  [30.31409707]


portfolio before change:  [25.33812724]
curr_Stock_Price:  105.80608078568922
curr_Factors:  [105.80608079]
mat_Sqrt:  [[0.15]]
grads:  [0.05435156]
Stock Position:  0.05435155902599815
Bond Position:  [19.58740179]


portfolio before change:  [25.34484008]
curr_Stock_Price:  105.90706391904547
curr_Factors:  [105.90706392]
mat_Sqrt:  [[0.15]]
grads:  [0.10967807]
Stock Position:  0.10967806526912821
Bond Position:  [13.72915821]


portfolio before change:  [25.40201648]
curr_Stock_Price:  106.42055128417806
curr_Factors:  [106.42055128]
mat_Sqrt:  [[0.15]]
grads:  [0.11907352]
Stock Position:  0.1190735201411958
Bond Position:  [12.73014682]


portfolio before change:  [25.39024501]
curr_Stock_Price:  106.3150104015935
curr_Factors:  [106.3150104]
mat_Sqrt:  [[0.15]]
grads:  [-0.08328466]
Stock Position:  -0.08328465886185714
Bond Position:  [34.24465439]


portfolio before change:  [25.42718015]
curr_Stock_Price:  105.89722903961946
curr_Factors:  [105.89722904]
mat_Sqrt:  [[0.15]]
grads:  [0.02527014]
Stock Position:  0.025270137718489835
Bond Position:  [22.75114259]


portfolio before change:  [25.4240165]
curr_Stock_Price:  105.71576405422594
curr_Factors:  [105.71576405]
mat_Sqrt:  [[0.15]]
grads:  [-0.12006998]
Stock Position:  -0.12006997846273916
Bond Position:  [38.11730601]


portfolio before change:  [25.40102603]
curr_Stock_Price:  105.92708146088208
curr_Factors:  [105.92708146]
mat_Sqrt:  [[0.15]]
grads:  [-0.06051198]
Stock Position:  -0.06051198091517888
Bond Position:  [31.81088356]


portfolio before change:  [25.39500968]
curr_Stock_Price:  106.05936246454753
curr_Factors:  [106.05936246]
mat_Sqrt:  [[0.15]]
grads:  [-0.11157021]
Stock Position:  -0.11157020604545843
Bond Position:  [37.22807461]


portfolio before change:  [25.47043912]
curr_Stock_Price:  105.40414627737066
curr_Factors:  [105.40414628]
mat_Sqrt:  [[0.15]]
grads:  [0.05024117]
Stock Position:  0.05024117338288156
Bond Position:  [20.17481113]


portfolio before change:  [25.4960344]
curr_Stock_Price:  105.88849639277373
curr_Factors:  [105.88849639]
mat_Sqrt:  [[0.15]]
grads:  [-0.41032044]
Stock Position:  -0.41032044030684195
Bond Position:  [68.94424886]


portfolio before change:  [25.17542007]
curr_Stock_Price:  106.68037378378673
curr_Factors:  [106.68037378]
mat_Sqrt:  [[0.15]]
grads:  [0.02123641]
Stock Position:  0.021236407528398504
Bond Position:  [22.90991218]


portfolio before change:  [25.1771895]
curr_Stock_Price:  106.6962672776515
curr_Factors:  [106.69626728]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141564]
Stock Position:  -0.031415639571180334
Bond Position:  [28.52912098]


portfolio before change:  [25.16350929]
curr_Stock_Price:  107.1884852111605
curr_Factors:  [107.18848521]
mat_Sqrt:  [[0.15]]
grads:  [-0.13963628]
Stock Position:  -0.13963628308711692
Bond Position:  [40.13091095]


portfolio before change:  [25.32252673]
curr_Stock_Price:  106.06765058265783
curr_Factors:  [106.06765058]
mat_Sqrt:  [[0.15]]
grads:  [0.1288647]
Stock Position:  0.12886470297013106
Bond Position:  [11.65415044]


portfolio before change:  [25.33131305]
curr_Stock_Price:  106.1301805994455
curr_Factors:  [106.1301806]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514351]
Stock Position:  -0.051435102484127485
Bond Position:  [30.79012977]


portfolio before change:  [25.31981833]
curr_Stock_Price:  106.39107565540297
curr_Factors:  [106.39107566]
mat_Sqrt:  [[0.15]]
grads:  [0.07825441]
Stock Position:  0.07825441489387898
Bond Position:  [16.99424695]


portfolio before change:  [25.32744746]
curr_Stock_Price:  106.47499372587885
curr_Factors:  [106.47499373]
mat_Sqrt:  [[0.15]]
grads:  [0.0697942]
Stock Position:  0.06979419714000723
Bond Position:  [17.89611076]


portfolio before change:  [25.28003561]
curr_Stock_Price:  105.77965801913902
curr_Factors:  [105.77965802]
mat_Sqrt:  [[0.15]]
grads:  [-0.02067161]
Stock Position:  -0.020671608634645115
Bond Position:  [27.4666713]


portfolio before change:  [25.2882652]
curr_Stock_Price:  105.46459456891955
curr_Factors:  [105.46459457]
mat_Sqrt:  [[0.15]]
grads:  [0.09274722]
Stock Position:  0.09274721580696466
Bond Position:  [15.50671768]


portfolio before change:  [25.34110249]
curr_Stock_Price:  106.02383606033463
curr_Factors:  [106.02383606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992941]
Stock Position:  -0.0099294084219595
Bond Position:  [26.39385646]


portfolio before change:  [25.3478811]
curr_Stock_Price:  105.50729480601
curr_Factors:  [105.50729481]
mat_Sqrt:  [[0.15]]
grads:  [0.13339216]
Stock Position:  0.1333921571905522
Bond Position:  [11.27403545]


portfolio before change:  [25.30680023]
curr_Stock_Price:  105.19404156130231
curr_Factors:  [105.19404156]
mat_Sqrt:  [[0.15]]
grads:  [0.08674221]
Stock Position:  0.08674220712127498
Bond Position:  [16.18203689]


portfolio before change:  [25.26225889]
curr_Stock_Price:  104.66889066331093
curr_Factors:  [104.66889066]
mat_Sqrt:  [[0.15]]
grads:  [-0.02606189]
Stock Position:  -0.026061893384870204
Bond Position:  [27.99012836]


portfolio before change:  [25.27509089]
curr_Stock_Price:  104.24365047199949
curr_Factors:  [104.24365047]
mat_Sqrt:  [[0.15]]
grads:  [-0.18376085]
Stock Position:  -0.18376085038118645
Bond Position:  [44.43099275]


portfolio before change:  [25.45933961]
curr_Stock_Price:  103.2561077022141
curr_Factors:  [103.2561077]
mat_Sqrt:  [[0.15]]
grads:  [-0.01806043]
Stock Position:  -0.01806042938534782
Bond Position:  [27.32418925]


portfolio before change:  [25.4485819]
curr_Stock_Price:  103.94631973073957
curr_Factors:  [103.94631973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0190408]
Stock Position:  -0.019040801875139627
Bond Position:  [27.42780318]


portfolio before change:  [25.44038736]
curr_Stock_Price:  104.46671966680606
curr_Factors:  [104.46671967]
mat_Sqrt:  [[0.15]]
grads:  [0.0453878]
Stock Position:  0.04538780079064975
Bond Position:  [20.6988727]


portfolio before change:  [25.43337169]
curr_Stock_Price:  104.28364411466477
curr_Factors:  [104.28364411]
mat_Sqrt:  [[0.15]]
grads:  [-0.12337403]
Stock Position:  -0.12337403241386723
Bond Position:  [38.29926537]


portfolio before change:  [25.42239748]
curr_Stock_Price:  104.39199740921185
curr_Factors:  [104.39199741]
mat_Sqrt:  [[0.15]]
grads:  [0.02458959]
Stock Position:  0.024589587905564904
Bond Position:  [22.85544128]


portfolio before change:  [25.43048027]
curr_Stock_Price:  104.66261103223704
curr_Factors:  [104.66261103]
mat_Sqrt:  [[0.15]]
grads:  [-0.02211919]
Stock Position:  -0.022119189488071924
Bond Position:  [27.74553239]


portfolio before change:  [25.44827437]
curr_Stock_Price:  103.93654665573159
curr_Factors:  [103.93654666]
mat_Sqrt:  [[0.15]]
grads:  [-0.03014508]
Stock Position:  -0.03014508352924881
Bond Position:  [28.58145025]


portfolio before change:  [25.47238155]
curr_Stock_Price:  103.19610155538719
curr_Factors:  [103.19610156]
mat_Sqrt:  [[0.15]]
grads:  [0.04547837]
Stock Position:  0.04547836807227111
Bond Position:  [20.77919126]


portfolio before change:  [25.49512708]
curr_Stock_Price:  103.66768382629532
curr_Factors:  [103.66768383]
mat_Sqrt:  [[0.15]]
grads:  [-0.13139833]
Stock Position:  -0.13139833041857021
Bond Position:  [39.11688765]


portfolio before change:  [25.44151128]
curr_Stock_Price:  104.09433066561704
curr_Factors:  [104.09433067]
mat_Sqrt:  [[0.15]]
grads:  [0.00590299]
Stock Position:  0.00590299154605154
Bond Position:  [24.82704333]


portfolio before change:  [25.43747937]
curr_Stock_Price:  103.14842884030435
curr_Factors:  [103.14842884]
mat_Sqrt:  [[0.15]]
grads:  [0.14089587]
Stock Position:  0.14089587068159062
Bond Position:  [10.90429168]


portfolio before change:  [25.60137568]
curr_Stock_Price:  104.30683589141407
curr_Factors:  [104.30683589]
mat_Sqrt:  [[0.15]]
grads:  [0.09280337]
Stock Position:  0.09280337459619373
Bond Position:  [15.92134931]


portfolio before change:  [25.57791804]
curr_Stock_Price:  104.04334598270253
curr_Factors:  [104.04334598]
mat_Sqrt:  [[0.15]]
grads:  [0.04940896]
Stock Position:  0.04940896113671634
Bond Position:  [20.4372444]


portfolio before change:  [25.54238318]
curr_Stock_Price:  103.29829436249705
curr_Factors:  [103.29829436]
mat_Sqrt:  [[0.15]]
grads:  [0.0567809]
Stock Position:  0.05678089858314016
Bond Position:  [19.67701321]


portfolio before change:  [25.55213924]
curr_Stock_Price:  103.44845409051169
curr_Factors:  [103.44845409]
mat_Sqrt:  [[0.15]]
grads:  [0.04040915]
Stock Position:  0.04040915073794497
Bond Position:  [21.37187506]


portfolio before change:  [25.57212919]
curr_Stock_Price:  103.91008623059038
curr_Factors:  [103.91008623]
mat_Sqrt:  [[0.15]]
grads:  [0.07791796]
Stock Position:  0.0779179575999283
Bond Position:  [17.47566749]


portfolio before change:  [25.57181576]
curr_Stock_Price:  103.89204565068462
curr_Factors:  [103.89204565]
mat_Sqrt:  [[0.15]]
grads:  [0.00879594]
Stock Position:  0.008795938535087198
Bond Position:  [24.65798772]


portfolio before change:  [25.5685336]
curr_Stock_Price:  103.34368641000538
curr_Factors:  [103.34368641]
mat_Sqrt:  [[0.15]]
grads:  [-0.10249721]
Stock Position:  -0.10249720975200217
Bond Position:  [36.1609731]


portfolio before change:  [25.51227046]
curr_Stock_Price:  103.91466072274676
curr_Factors:  [103.91466072]
mat_Sqrt:  [[0.15]]
grads:  [-0.04884794]
Stock Position:  -0.048847942939181495
Bond Position:  [30.58828788]


portfolio before change:  [25.48517552]
curr_Stock_Price:  104.5084783645301
curr_Factors:  [104.50847836]
mat_Sqrt:  [[0.15]]
grads:  [0.00612872]
Stock Position:  0.006128721063188484
Bond Position:  [24.8446722]


portfolio before change:  [25.4894657]
curr_Stock_Price:  104.95511992072878
curr_Factors:  [104.95511992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0003167]
Stock Position:  -0.00031670285414617716
Bond Position:  [25.52270529]


portfolio before change:  [25.49124049]
curr_Stock_Price:  104.38812834055625
curr_Factors:  [104.38812834]
mat_Sqrt:  [[0.15]]
grads:  [-0.13063747]
Stock Position:  -0.13063747262799758
Bond Position:  [39.12824174]


portfolio before change:  [25.5539196]
curr_Stock_Price:  103.92705446086495
curr_Factors:  [103.92705446]
mat_Sqrt:  [[0.15]]
grads:  [-0.024284]
Stock Position:  -0.02428400087014596
Bond Position:  [28.07768428]


portfolio before change:  [25.53109391]
curr_Stock_Price:  104.93926853167825
curr_Factors:  [104.93926853]
mat_Sqrt:  [[0.15]]
grads:  [0.08116559]
Stock Position:  0.08116558581597022
Bond Position:  [17.0136367]


portfolio before change:  [25.50357179]
curr_Stock_Price:  104.58708109572551
curr_Factors:  [104.5870811]
mat_Sqrt:  [[0.15]]
grads:  [-0.01351683]
Stock Position:  -0.013516832648548638
Bond Position:  [26.91725786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.48811761]
Stock Price:  105.85487549674981
PL:  [19.63324211]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-8.77134562e-03]
 [-1.91646167e-02]
 [ 6.95528997e-03]
 [-1.14359338e-02]
 [ 1.24767484e-02]
 [-1.03233143e-02]
 [-9.33329515e-03]
 [ 2.08705736e-02]
 [-1.51812910e-02]
 [-4.07606505e-03]
 [ 1.43364688e-02]
 [-3.60972098e-03]
 [-4.45219937e-04]
 [ 5.41033248e-03]
 [-2.91346167e-03]
 [ 1.02080152e-02]
 [ 3.45097338e-02]
 [-1.52081500e-02]
 [ 2.12803921e-02]
 [ 2.27495096e-03]
 [-4.20582440e-03]
 [ 4.31470663e-03]
 [ 1.62180344e-02]
 [ 1.96176111e-02]
 [-1.23820714e-03]
 [ 7.25686208e-03]
 [-1.09412532e-02]
 [ 1.48609895e-02]
 [ 3.39147100e-02]
 [ 3.77025924e-03]
 [-6.83603162e-03]
 [ 1.02549544e-02]
 [ 1.23753104e-02]
 [-3.19011249e-03]
 [ 6.03487919e-03]
 [ 1.48698804e-02]
 [-2.77578428e-02]
 [-1.99726892e-04]
 [-4.15313818e-02]
 [-8.31715856e-03]
 [ 4.26210638e-03]
 [ 9.62304814e-03]
 [-3.95789901e-03]
 [-1.99061333e-03]
 [ 9.03747056e-03]
 [ 1.21328876e-02]
 [ 1.05728168e-02]
 [-1.34574846e-03]
 [ 1.38071788e-02]
 [-1.19154396e-03]
 [ 1.16268758e-02]
 [-1.70197441e-02]
 [ 7.43164271e-04]
 [-6.66249862e-03]
 [-3.18090445e-03]
 [-3.49572813e-03]
 [ 1.04838016e-02]
 [-4.14896133e-03]
 [ 6.89963245e-03]
 [-4.00498926e-03]
 [-5.66217091e-04]
 [ 2.95746131e-03]
 [-6.61537805e-03]
 [ 4.36100998e-03]
 [ 2.00127659e-02]
 [ 3.88298657e-03]
 [ 1.06391365e-02]
 [-4.24746921e-04]
 [ 2.81346169e-03]
 [ 2.21252085e-02]
 [ 2.18995922e-03]
 [-1.59613373e-02]
 [-6.13121647e-03]
 [ 9.33951432e-04]
 [ 4.88549088e-03]
 [ 4.86543856e-04]
 [-1.61009034e-03]
 [-8.73584825e-03]
 [-2.29846798e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.1502037]
curr_Stock_Price:  100.09629932508656
curr_Factors:  [100.09629933]
mat_Sqrt:  [[0.15]]
grads:  [-0.05847564]
Stock Position:  -0.058475637448241496
Bond Position:  [10.0033986]


portfolio before change:  [4.21704403]
curr_Stock_Price:  98.96394574332258
curr_Factors:  [98.96394574]
mat_Sqrt:  [[0.15]]
grads:  [-0.12776411]
Stock Position:  -0.12776411164475834
Bond Position:  [16.86108464]


portfolio before change:  [4.14732221]
curr_Stock_Price:  99.51790150912912
curr_Factors:  [99.51790151]
mat_Sqrt:  [[0.15]]
grads:  [0.0463686]
Stock Position:  0.04636859979869857
Bond Position:  [-0.46718354]


portfolio before change:  [4.12093389]
curr_Stock_Price:  98.94943230371179
curr_Factors:  [98.9494323]
mat_Sqrt:  [[0.15]]
grads:  [-0.07623956]
Stock Position:  -0.0762395586766584
Bond Position:  [11.66479494]


portfolio before change:  [4.03850732]
curr_Stock_Price:  100.04014747382372
curr_Factors:  [100.04014747]
mat_Sqrt:  [[0.15]]
grads:  [0.08317832]
Stock Position:  0.08317832250852113
Bond Position:  [-4.28266433]


portfolio before change:  [4.00157555]
curr_Stock_Price:  99.5993583905616
curr_Factors:  [99.59935839]
mat_Sqrt:  [[0.15]]
grads:  [-0.0688221]
Stock Position:  -0.0688220954543129
Bond Position:  [10.8562121]


portfolio before change:  [4.0516522]
curr_Stock_Price:  98.88159297734563
curr_Factors:  [98.88159298]
mat_Sqrt:  [[0.15]]
grads:  [-0.06222197]
Stock Position:  -0.0622219676704664
Bond Position:  [10.20425948]


portfolio before change:  [4.05776274]
curr_Stock_Price:  98.79363760996104
curr_Factors:  [98.79363761]
mat_Sqrt:  [[0.15]]
grads:  [0.13913716]
Stock Position:  0.13913715707889251
Bond Position:  [-9.68810313]


portfolio before change:  [4.10828071]
curr_Stock_Price:  99.16106995369424
curr_Factors:  [99.16106995]
mat_Sqrt:  [[0.15]]
grads:  [-0.10120861]
Stock Position:  -0.10120860681570377
Bond Position:  [14.14423445]


portfolio before change:  [4.0425036]
curr_Stock_Price:  99.81972092604553
curr_Factors:  [99.81972093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02717377]
Stock Position:  -0.027173766974263176
Bond Position:  [6.75498144]


portfolio before change:  [4.04901538]
curr_Stock_Price:  99.59562342026226
curr_Factors:  [99.59562342]
mat_Sqrt:  [[0.15]]
grads:  [0.09557646]
Stock Position:  0.09557645878897941
Bond Position:  [-5.46998162]


portfolio before change:  [4.07279978]
curr_Stock_Price:  99.84805261946605
curr_Factors:  [99.84805262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02406481]
Stock Position:  -0.02406480653881222
Bond Position:  [6.47562385]


portfolio before change:  [4.09290667]
curr_Stock_Price:  99.02934028527656
curr_Factors:  [99.02934029]
mat_Sqrt:  [[0.15]]
grads:  [-0.00296813]
Stock Position:  -0.002968132912211941
Bond Position:  [4.38683892]


portfolio before change:  [4.09268114]
curr_Stock_Price:  99.19770150936577
curr_Factors:  [99.19770151]
mat_Sqrt:  [[0.15]]
grads:  [0.03606888]
Stock Position:  0.03606888319928596
Bond Position:  [0.51473083]


portfolio before change:  [4.08221261]
curr_Stock_Price:  98.90657239732965
curr_Factors:  [98.9065724]
mat_Sqrt:  [[0.15]]
grads:  [-0.01942308]
Stock Position:  -0.019423077776795073
Bond Position:  [6.00328266]


portfolio before change:  [4.07968065]
curr_Stock_Price:  99.05624901192277
curr_Factors:  [99.05624901]
mat_Sqrt:  [[0.15]]
grads:  [0.06805343]
Stock Position:  0.06805343481669134
Bond Position:  [-2.66143734]


portfolio before change:  [4.14473538]
curr_Stock_Price:  100.01462933008136
curr_Factors:  [100.01462933]
mat_Sqrt:  [[0.15]]
grads:  [0.23006489]
Stock Position:  0.23006489182041281
Bond Position:  [-18.8651195]


portfolio before change:  [4.04459735]
curr_Stock_Price:  99.58449453670127
curr_Factors:  [99.58449454]
mat_Sqrt:  [[0.15]]
grads:  [-0.10138767]
Stock Position:  -0.10138766670323997
Bond Position:  [14.1412369]


portfolio before change:  [4.05551398]
curr_Stock_Price:  99.48553996726254
curr_Factors:  [99.48553997]
mat_Sqrt:  [[0.15]]
grads:  [0.14186928]
Stock Position:  0.14186928069015503
Bond Position:  [-10.05842801]


portfolio before change:  [4.08523747]
curr_Stock_Price:  99.6994845484942
curr_Factors:  [99.69948455]
mat_Sqrt:  [[0.15]]
grads:  [0.01516634]
Stock Position:  0.015166339725675713
Bond Position:  [2.57316122]


portfolio before change:  [4.09233814]
curr_Stock_Price:  100.15706597072885
curr_Factors:  [100.15706597]
mat_Sqrt:  [[0.15]]
grads:  [-0.02803883]
Stock Position:  -0.02803882930638603
Bond Position:  [6.90062501]


portfolio before change:  [4.09956092]
curr_Stock_Price:  99.91484895801362
curr_Factors:  [99.91484896]
mat_Sqrt:  [[0.15]]
grads:  [0.02876471]
Stock Position:  0.028764710866739443
Bond Position:  [1.22553918]


portfolio before change:  [4.09833444]
curr_Stock_Price:  99.86954761048354
curr_Factors:  [99.86954761]
mat_Sqrt:  [[0.15]]
grads:  [0.10812023]
Stock Position:  0.1081202295537691
Bond Position:  [-6.69958397]


portfolio before change:  [4.21142714]
curr_Stock_Price:  100.91941064987967
curr_Factors:  [100.91941065]
mat_Sqrt:  [[0.15]]
grads:  [0.13078407]
Stock Position:  0.13078407377520745
Bond Position:  [-8.98722451]


portfolio before change:  [4.29880051]
curr_Stock_Price:  101.59177915982315
curr_Factors:  [101.59177916]
mat_Sqrt:  [[0.15]]
grads:  [-0.00825471]
Stock Position:  -0.00825471424648874
Bond Position:  [5.13741162]


portfolio before change:  [4.30046258]
curr_Stock_Price:  101.42932928269168
curr_Factors:  [101.42932928]
mat_Sqrt:  [[0.15]]
grads:  [0.04837908]
Stock Position:  0.04837908050686307
Bond Position:  [-0.6065951]


portfolio before change:  [4.28000259]
curr_Stock_Price:  101.00720291766754
curr_Factors:  [101.00720292]
mat_Sqrt:  [[0.15]]
grads:  [-0.07294169]
Stock Position:  -0.07294168814725756
Bond Position:  [11.64763848]


portfolio before change:  [4.21870297]
curr_Stock_Price:  101.85757554251812
curr_Factors:  [101.85757554]
mat_Sqrt:  [[0.15]]
grads:  [0.09907326]
Stock Position:  0.09907326319074976
Bond Position:  [-5.87265942]


portfolio before change:  [4.1469288]
curr_Stock_Price:  101.13682486080259
curr_Factors:  [101.13682486]
mat_Sqrt:  [[0.15]]
grads:  [0.22609807]
Stock Position:  0.22609806638402943
Bond Position:  [-18.71991174]


portfolio before change:  [4.11812588]
curr_Stock_Price:  101.01460848501341
curr_Factors:  [101.01460849]
mat_Sqrt:  [[0.15]]
grads:  [0.02513506]
Stock Position:  0.025135061572668187
Bond Position:  [1.57911748]


portfolio before change:  [4.11034727]
curr_Stock_Price:  100.70120918150445
curr_Factors:  [100.70120918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04557354]
Stock Position:  -0.04557354413347872
Bond Position:  [8.69965827]


portfolio before change:  [4.10632018]
curr_Stock_Price:  100.80150495181375
curr_Factors:  [100.80150495]
mat_Sqrt:  [[0.15]]
grads:  [0.06836636]
Stock Position:  0.06836636266482751
Bond Position:  [-2.78511207]


portfolio before change:  [4.08404519]
curr_Stock_Price:  100.47823322384757
curr_Factors:  [100.47823322]
mat_Sqrt:  [[0.15]]
grads:  [0.08250207]
Stock Position:  0.08250206923965046
Bond Position:  [-4.20561696]


portfolio before change:  [4.04025906]
curr_Stock_Price:  99.95069161258081
curr_Factors:  [99.95069161]
mat_Sqrt:  [[0.15]]
grads:  [-0.02126742]
Stock Position:  -0.021267416622984064
Bond Position:  [6.16595206]


portfolio before change:  [4.03278499]
curr_Stock_Price:  100.32024529377249
curr_Factors:  [100.32024529]
mat_Sqrt:  [[0.15]]
grads:  [0.04023253]
Stock Position:  0.04023252793245051
Bond Position:  [-0.00335208]


portfolio before change:  [4.01543409]
curr_Stock_Price:  99.88898512044366
curr_Factors:  [99.88898512]
mat_Sqrt:  [[0.15]]
grads:  [0.09913254]
Stock Position:  0.09913253631199201
Bond Position:  [-5.88681435]


portfolio before change:  [4.18477841]
curr_Stock_Price:  101.6009584325468
curr_Factors:  [101.60095843]
mat_Sqrt:  [[0.15]]
grads:  [-0.18505229]
Stock Position:  -0.18505228535334267
Bond Position:  [22.98626796]


portfolio before change:  [4.13254367]
curr_Stock_Price:  101.89099231020502
curr_Factors:  [101.89099231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00133151]
Stock Position:  -0.001331512614007671
Bond Position:  [4.26821281]


portfolio before change:  [4.13323024]
curr_Stock_Price:  101.57571045795552
curr_Factors:  [101.57571046]
mat_Sqrt:  [[0.15]]
grads:  [-0.27687588]
Stock Position:  -0.2768758787476627
Bond Position:  [32.25709433]


portfolio before change:  [4.10471752]
curr_Stock_Price:  101.68597233339668
curr_Factors:  [101.68597233]
mat_Sqrt:  [[0.15]]
grads:  [-0.05544772]
Stock Position:  -0.055447723741543976
Bond Position:  [9.74297322]


portfolio before change:  [4.10241922]
curr_Stock_Price:  101.73840468115267
curr_Factors:  [101.73840468]
mat_Sqrt:  [[0.15]]
grads:  [0.02841404]
Stock Position:  0.028414042538484497
Bond Position:  [1.21161986]


portfolio before change:  [4.10530573]
curr_Stock_Price:  101.83732710626587
curr_Factors:  [101.83732711]
mat_Sqrt:  [[0.15]]
grads:  [0.06415365]
Stock Position:  0.0641536542872384
Bond Position:  [-2.42793094]


portfolio before change:  [4.06593291]
curr_Stock_Price:  101.22596564366694
curr_Factors:  [101.22596564]
mat_Sqrt:  [[0.15]]
grads:  [-0.02638599]
Stock Position:  -0.02638599343225043
Bond Position:  [6.73688058]


portfolio before change:  [4.03881433]
curr_Stock_Price:  102.26968774368989
curr_Factors:  [102.26968774]
mat_Sqrt:  [[0.15]]
grads:  [-0.01327076]
Stock Position:  -0.01327075556403115
Bond Position:  [5.39601036]


portfolio before change:  [4.03496002]
curr_Stock_Price:  102.58553844618804
curr_Factors:  [102.58553845]
mat_Sqrt:  [[0.15]]
grads:  [0.0602498]
Stock Position:  0.060249803735678474
Bond Position:  [-2.14579854]


portfolio before change:  [4.04034417]
curr_Stock_Price:  102.67712818303639
curr_Factors:  [102.67712818]
mat_Sqrt:  [[0.15]]
grads:  [0.08088592]
Stock Position:  0.08088591701793076
Bond Position:  [-4.2647895]


portfolio before change:  [4.02510498]
curr_Stock_Price:  102.49202026972078
curr_Factors:  [102.49202027]
mat_Sqrt:  [[0.15]]
grads:  [0.07048545]
Stock Position:  0.07048544510541764
Bond Position:  [-3.19909068]


portfolio before change:  [4.05656018]
curr_Stock_Price:  102.94112218408024
curr_Factors:  [102.94112218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00897166]
Stock Position:  -0.008971656377794797
Bond Position:  [4.98011256]


portfolio before change:  [4.060514]
curr_Stock_Price:  102.5351158581945
curr_Factors:  [102.53511586]
mat_Sqrt:  [[0.15]]
grads:  [0.09204786]
Stock Position:  0.09204785893760402
Bond Position:  [-5.37762388]


portfolio before change:  [3.9835096]
curr_Stock_Price:  101.70219821287694
curr_Factors:  [101.70219821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00794363]
Stock Position:  -0.007943626423509473
Bond Position:  [4.79139387]


portfolio before change:  [3.98667462]
curr_Stock_Price:  101.3414634430475
curr_Factors:  [101.34146344]
mat_Sqrt:  [[0.15]]
grads:  [0.07751251]
Stock Position:  0.07751250524730739
Bond Position:  [-3.8685561]


portfolio before change:  [4.00187041]
curr_Stock_Price:  101.5406259841923
curr_Factors:  [101.54062598]
mat_Sqrt:  [[0.15]]
grads:  [-0.11346496]
Stock Position:  -0.11346496085986485
Bond Position:  [15.52317356]


portfolio before change:  [3.94509001]
curr_Stock_Price:  102.04959924648632
curr_Factors:  [102.04959925]
mat_Sqrt:  [[0.15]]
grads:  [0.00495443]
Stock Position:  0.00495442847080226
Bond Position:  [3.43949257]


portfolio before change:  [3.94543668]
curr_Stock_Price:  102.076180590751
curr_Factors:  [102.07618059]
mat_Sqrt:  [[0.15]]
grads:  [-0.04441666]
Stock Position:  -0.044416657476100685
Bond Position:  [8.47931943]


portfolio before change:  [3.94976372]
curr_Stock_Price:  101.99069313879778
curr_Factors:  [101.99069314]
mat_Sqrt:  [[0.15]]
grads:  [-0.02120603]
Stock Position:  -0.02120602965595113
Bond Position:  [6.11258138]


portfolio before change:  [3.96197528]
curr_Stock_Price:  101.4328561135773
curr_Factors:  [101.43285611]
mat_Sqrt:  [[0.15]]
grads:  [-0.02330485]
Stock Position:  -0.023304854186821287
Bond Position:  [6.3258532]


portfolio before change:  [3.95504968]
curr_Stock_Price:  101.74699564094561
curr_Factors:  [101.74699564]
mat_Sqrt:  [[0.15]]
grads:  [0.06989201]
Stock Position:  0.06989201067279255
Bond Position:  [-3.15625243]


portfolio before change:  [3.92707834]
curr_Stock_Price:  101.34961028046256
curr_Factors:  [101.34961028]
mat_Sqrt:  [[0.15]]
grads:  [-0.02765974]
Stock Position:  -0.02765974222755728
Bond Position:  [6.73038244]


portfolio before change:  [3.93020894]
curr_Stock_Price:  101.25163652587197
curr_Factors:  [101.25163653]
mat_Sqrt:  [[0.15]]
grads:  [0.04599755]
Stock Position:  0.04599754967791684
Bond Position:  [-0.72711825]


portfolio before change:  [3.90922064]
curr_Stock_Price:  100.79633288633
curr_Factors:  [100.79633289]
mat_Sqrt:  [[0.15]]
grads:  [-0.02669993]
Stock Position:  -0.02669992837927325
Bond Position:  [6.60047551]


portfolio before change:  [3.92214146]
curr_Stock_Price:  100.32785685798157
curr_Factors:  [100.32785686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00377478]
Stock Position:  -0.0037747806090749373
Bond Position:  [4.3008571]


portfolio before change:  [3.9260306]
curr_Stock_Price:  99.36877253229427
curr_Factors:  [99.36877253]
mat_Sqrt:  [[0.15]]
grads:  [0.01971641]
Stock Position:  0.01971640871252217
Bond Position:  [1.96683527]


portfolio before change:  [3.92505394]
curr_Stock_Price:  99.31300209253004
curr_Factors:  [99.31300209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04410252]
Stock Position:  -0.04410252031089388
Bond Position:  [8.30500763]


portfolio before change:  [3.94180459]
curr_Stock_Price:  98.94496020047168
curr_Factors:  [98.9449602]
mat_Sqrt:  [[0.15]]
grads:  [0.0290734]
Stock Position:  0.02907339984138533
Bond Position:  [1.0651382]


portfolio before change:  [3.9274122]
curr_Stock_Price:  98.44763399582536
curr_Factors:  [98.447634]
mat_Sqrt:  [[0.15]]
grads:  [0.13341844]
Stock Position:  0.13341843953755092
Bond Position:  [-9.2073175]


portfolio before change:  [3.83962764]
curr_Stock_Price:  97.79398309166845
curr_Factors:  [97.79398309]
mat_Sqrt:  [[0.15]]
grads:  [0.02588658]
Stock Position:  0.025886577152462835
Bond Position:  [1.30807616]


portfolio before change:  [3.85491692]
curr_Stock_Price:  98.38145058116184
curr_Factors:  [98.38145058]
mat_Sqrt:  [[0.15]]
grads:  [0.07092758]
Stock Position:  0.07092757683702283
Bond Position:  [-3.12304097]


portfolio before change:  [3.86960482]
curr_Stock_Price:  98.59128560044248
curr_Factors:  [98.5912856]
mat_Sqrt:  [[0.15]]
grads:  [-0.00283165]
Stock Position:  -0.0028316461416865585
Bond Position:  [4.14878045]


portfolio before change:  [3.86827028]
curr_Stock_Price:  99.15415276992073
curr_Factors:  [99.15415277]
mat_Sqrt:  [[0.15]]
grads:  [0.01875641]
Stock Position:  0.018756411235996265
Bond Position:  [2.00849422]


portfolio before change:  [3.86143254]
curr_Stock_Price:  98.7829046180151
curr_Factors:  [98.78290462]
mat_Sqrt:  [[0.15]]
grads:  [0.14750139]
Stock Position:  0.14750139015767172
Bond Position:  [-10.70918322]


portfolio before change:  [3.89441107]
curr_Stock_Price:  99.01102367155508
curr_Factors:  [99.01102367]
mat_Sqrt:  [[0.15]]
grads:  [0.01459973]
Stock Position:  0.014599728149661373
Bond Position:  [2.44887704]


portfolio before change:  [3.89997664]
curr_Stock_Price:  99.38175029526936
curr_Factors:  [99.3817503]
mat_Sqrt:  [[0.15]]
grads:  [-0.10640892]
Stock Position:  -0.10640891559171874
Bond Position:  [14.47508091]


portfolio before change:  [4.01324563]
curr_Stock_Price:  98.32578359825726
curr_Factors:  [98.3257836]
mat_Sqrt:  [[0.15]]
grads:  [-0.04087478]
Stock Position:  -0.04087477643971172
Bond Position:  [8.03229005]


portfolio before change:  [4.00223901]
curr_Stock_Price:  98.60734241457752
curr_Factors:  [98.60734241]
mat_Sqrt:  [[0.15]]
grads:  [0.00622634]
Stock Position:  0.006226342880061039
Bond Position:  [3.38827588]


portfolio before change:  [4.00297164]
curr_Stock_Price:  98.690996503398
curr_Factors:  [98.6909965]
mat_Sqrt:  [[0.15]]
grads:  [0.03256994]
Stock Position:  0.032569939208688455
Bond Position:  [0.78861188]


portfolio before change:  [3.97425697]
curr_Stock_Price:  97.80785212845623
curr_Factors:  [97.80785213]
mat_Sqrt:  [[0.15]]
grads:  [0.00324363]
Stock Position:  0.0032436257069904002
Bond Position:  [3.65700491]


portfolio before change:  [3.97198896]
curr_Stock_Price:  97.03816507907533
curr_Factors:  [97.03816508]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073394]
Stock Position:  -0.010733935605279743
Bond Position:  [5.01359038]


portfolio before change:  [3.97217193]
curr_Stock_Price:  97.05031304017507
curr_Factors:  [97.05031304]
mat_Sqrt:  [[0.15]]
grads:  [-0.05823899]
Stock Position:  -0.05823898832691706
Bond Position:  [9.62428398]


portfolio before change:  [3.97772814]
curr_Stock_Price:  96.96523814986794
curr_Factors:  [96.96523815]
mat_Sqrt:  [[0.15]]
grads:  [-0.1532312]
Stock Position:  -0.15323119894062054
Bond Position:  [18.83582784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.01100484]
Stock Price:  96.7557545205281
PL:  [4.01100484]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.44629558e-02]
 [-2.57264135e-02]
 [ 4.06868040e-02]
 [-1.20643276e-02]
 [ 1.10344994e-02]
 [-1.81465315e-02]
 [-1.37034931e-02]
 [ 7.93691823e-02]
 [-2.09186588e-02]
 [-1.33639613e-02]
 [ 9.16394823e-03]
 [-7.30028689e-03]
 [ 4.44714171e-03]
 [-6.98488352e-03]
 [ 7.08587750e-04]
 [ 2.30447502e-03]
 [-2.08209955e-02]
 [-1.21171535e-02]
 [ 2.48659546e-02]
 [-8.43148837e-04]
 [-8.77438599e-03]
 [ 5.42225044e-03]
 [ 1.66207098e-02]
 [ 1.74496273e-02]
 [-2.73199542e-03]
 [ 6.85608490e-03]
 [-8.88617791e-03]
 [ 6.07204988e-03]
 [ 3.27433969e-02]
 [ 4.81308171e-03]
 [-8.23768928e-03]
 [ 9.14268803e-03]
 [ 1.16395105e-02]
 [-1.03421767e-02]
 [ 4.36258232e-03]
 [ 1.85070668e-02]
 [ 4.83109793e-03]
 [-5.30961060e-04]
 [-5.16768493e-03]
 [-1.09577610e-02]
 [ 7.07562156e-03]
 [ 3.00228180e-02]
 [-2.90185139e-03]
 [ 2.49603768e-03]
 [-1.22505298e-02]
 [ 1.57271475e-02]
 [ 9.99578614e-03]
 [ 5.32195431e-03]
 [-8.08528117e-03]
 [-6.60291235e-07]
 [-9.74470277e-04]
 [-4.53011667e-03]
 [-9.44673775e-04]
 [ 7.90955177e-03]
 [-1.11337604e-02]
 [-5.15580152e-03]
 [-1.48106026e-03]
 [ 1.30644574e-02]
 [ 6.59887198e-03]
 [-2.41937726e-03]
 [-5.12174322e-03]
 [-2.59540559e-03]
 [-1.28834177e-03]
 [-4.01671090e-03]
 [ 1.85579743e-02]
 [ 4.38582274e-03]
 [ 1.35852896e-02]
 [-9.22499145e-04]
 [ 3.12260534e-03]
 [ 2.31272232e-02]
 [ 3.31247166e-03]
 [-1.54024793e-02]
 [-5.87376177e-03]
 [ 2.42665880e-03]
 [ 1.07030785e-02]
 [ 4.51176571e-03]
 [-1.02522028e-03]
 [-1.48446161e-02]
 [-2.85566475e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.65352079]
curr_Stock_Price:  98.78809318594875
curr_Factors:  [98.78809319]
mat_Sqrt:  [[0.15]]
grads:  [-0.09641971]
Stock Position:  -0.09641970553935793
Bond Position:  [-15.12840194]


portfolio before change:  [-24.61588986]
curr_Stock_Price:  98.38800390752334
curr_Factors:  [98.38800391]
mat_Sqrt:  [[0.15]]
grads:  [-0.17150942]
Stock Position:  -0.17150942330359603
Bond Position:  [-7.74142005]


portfolio before change:  [-24.67364432]
curr_Stock_Price:  98.72192499970029
curr_Factors:  [98.721925]
mat_Sqrt:  [[0.15]]
grads:  [0.27124536]
Stock Position:  0.2712453597221281
Bond Position:  [-51.45150838]


portfolio before change:  [-24.76059201]
curr_Stock_Price:  98.4132308266868
curr_Factors:  [98.41323083]
mat_Sqrt:  [[0.15]]
grads:  [-0.08042885]
Stock Position:  -0.08042885034709928
Bond Position:  [-16.84532899]


portfolio before change:  [-24.72136862]
curr_Stock_Price:  97.91246215785485
curr_Factors:  [97.91246216]
mat_Sqrt:  [[0.15]]
grads:  [0.07356333]
Stock Position:  0.0735633290500987
Bond Position:  [-31.92413529]


portfolio before change:  [-24.77855662]
curr_Stock_Price:  97.16218784275604
curr_Factors:  [97.16218784]
mat_Sqrt:  [[0.15]]
grads:  [-0.12097688]
Stock Position:  -0.12097687642626485
Bond Position:  [-13.02417863]


portfolio before change:  [-24.77087644]
curr_Stock_Price:  97.09197427953724
curr_Factors:  [97.09197428]
mat_Sqrt:  [[0.15]]
grads:  [-0.09135662]
Stock Position:  -0.09135662072733067
Bond Position:  [-15.90088177]


portfolio before change:  [-24.76716947]
curr_Stock_Price:  97.04051871383734
curr_Factors:  [97.04051871]
mat_Sqrt:  [[0.15]]
grads:  [0.52912788]
Stock Position:  0.5291278818888955
Bond Position:  [-76.11401359]


portfolio before change:  [-24.45525326]
curr_Stock_Price:  97.6390006579453
curr_Factors:  [97.63900066]
mat_Sqrt:  [[0.15]]
grads:  [-0.13945773]
Stock Position:  -0.13945772527325606
Bond Position:  [-10.83874033]


portfolio before change:  [-24.4730752]
curr_Stock_Price:  97.76193756077134
curr_Factors:  [97.76193756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08909308]
Stock Position:  -0.08909307563312699
Bond Position:  [-15.76316351]


portfolio before change:  [-24.50482827]
curr_Stock_Price:  98.10728244235636
curr_Factors:  [98.10728244]
mat_Sqrt:  [[0.15]]
grads:  [0.06109299]
Stock Position:  0.06109298819947128
Bond Position:  [-30.49849532]


portfolio before change:  [-24.53912281]
curr_Stock_Price:  97.57713437011455
curr_Factors:  [97.57713437]
mat_Sqrt:  [[0.15]]
grads:  [-0.04866858]
Stock Position:  -0.04866857927911491
Bond Position:  [-19.79018231]


portfolio before change:  [-24.55256356]
curr_Stock_Price:  97.82788791377008
curr_Factors:  [97.82788791]
mat_Sqrt:  [[0.15]]
grads:  [0.02964761]
Stock Position:  0.029647611393204938
Bond Position:  [-27.45292676]


portfolio before change:  [-24.57981853]
curr_Stock_Price:  96.96646575696494
curr_Factors:  [96.96646576]
mat_Sqrt:  [[0.15]]
grads:  [-0.04656589]
Stock Position:  -0.046565890160758565
Bond Position:  [-20.06448874]


portfolio before change:  [-24.60784175]
curr_Stock_Price:  97.54133193439728
curr_Factors:  [97.54133193]
mat_Sqrt:  [[0.15]]
grads:  [0.00472392]
Stock Position:  0.0047239183321935605
Bond Position:  [-25.06861904]


portfolio before change:  [-24.61097589]
curr_Stock_Price:  97.2095517922908
curr_Factors:  [97.20955179]
mat_Sqrt:  [[0.15]]
grads:  [0.01536317]
Stock Position:  0.01536316678939299
Bond Position:  [-26.10442245]


portfolio before change:  [-24.60332114]
curr_Stock_Price:  97.81400614614033
curr_Factors:  [97.81400615]
mat_Sqrt:  [[0.15]]
grads:  [-0.13880664]
Stock Position:  -0.1388066364248281
Bond Position:  [-11.02608795]


portfolio before change:  [-24.59668873]
curr_Stock_Price:  97.76125966644221
curr_Factors:  [97.76125967]
mat_Sqrt:  [[0.15]]
grads:  [-0.08078102]
Stock Position:  -0.0807810231517511
Bond Position:  [-16.69943415]


portfolio before change:  [-24.60634321]
curr_Stock_Price:  97.8678531299447
curr_Factors:  [97.86785313]
mat_Sqrt:  [[0.15]]
grads:  [0.16577303]
Stock Position:  0.1657730308579558
Bond Position:  [-40.83019384]


portfolio before change:  [-24.5171477]
curr_Stock_Price:  98.42130545118634
curr_Factors:  [98.42130545]
mat_Sqrt:  [[0.15]]
grads:  [-0.00562099]
Stock Position:  -0.005620992245258316
Bond Position:  [-23.96392231]


portfolio before change:  [-24.51728847]
curr_Stock_Price:  98.17988464363852
curr_Factors:  [98.17988464]
mat_Sqrt:  [[0.15]]
grads:  [-0.05849591]
Stock Position:  -0.05849590662074078
Bond Position:  [-18.77416711]


portfolio before change:  [-24.54474473]
curr_Stock_Price:  98.62919532252627
curr_Factors:  [98.62919532]
mat_Sqrt:  [[0.15]]
grads:  [0.03614834]
Stock Position:  0.03614833627432498
Bond Position:  [-28.11002605]


portfolio before change:  [-24.50483924]
curr_Stock_Price:  99.78173587773576
curr_Factors:  [99.78173588]
mat_Sqrt:  [[0.15]]
grads:  [0.11080473]
Stock Position:  0.11080473172099944
Bond Position:  [-35.56112771]


portfolio before change:  [-24.43366235]
curr_Stock_Price:  100.44415815416193
curr_Factors:  [100.44415815]
mat_Sqrt:  [[0.15]]
grads:  [0.11633085]
Stock Position:  0.11633084867939579
Bond Position:  [-36.11841652]


portfolio before change:  [-24.37631547]
curr_Stock_Price:  100.95652747207166
curr_Factors:  [100.95652747]
mat_Sqrt:  [[0.15]]
grads:  [-0.0182133]
Stock Position:  -0.018213302780721627
Bond Position:  [-22.53756367]


portfolio before change:  [-24.37950221]
curr_Stock_Price:  101.0541539224574
curr_Factors:  [101.05415392]
mat_Sqrt:  [[0.15]]
grads:  [0.04570723]
Stock Position:  0.04570723264346403
Bond Position:  [-28.99840793]


portfolio before change:  [-24.37447638]
curr_Stock_Price:  101.20376451229004
curr_Factors:  [101.20376451]
mat_Sqrt:  [[0.15]]
grads:  [-0.05924119]
Stock Position:  -0.05924118606377272
Bond Position:  [-18.37904534]


portfolio before change:  [-24.35200387]
curr_Stock_Price:  100.80503448514796
curr_Factors:  [100.80503449]
mat_Sqrt:  [[0.15]]
grads:  [0.04048033]
Stock Position:  0.04048033250816943
Bond Position:  [-28.43262518]


portfolio before change:  [-24.34817507]
curr_Stock_Price:  100.94351880571554
curr_Factors:  [100.94351881]
mat_Sqrt:  [[0.15]]
grads:  [0.21828931]
Stock Position:  0.21828931245556318
Bond Position:  [-46.38306639]


portfolio before change:  [-24.36191196]
curr_Stock_Price:  100.89386977422976
curr_Factors:  [100.89386977]
mat_Sqrt:  [[0.15]]
grads:  [0.03208721]
Stock Position:  0.03208721142338027
Bond Position:  [-27.59931489]


portfolio before change:  [-24.3856762]
curr_Stock_Price:  100.20701567809678
curr_Factors:  [100.20701568]
mat_Sqrt:  [[0.15]]
grads:  [-0.05491793]
Stock Position:  -0.05491792850526693
Bond Position:  [-18.88251448]


portfolio before change:  [-24.36837747]
curr_Stock_Price:  99.87053321170711
curr_Factors:  [99.87053321]
mat_Sqrt:  [[0.15]]
grads:  [0.06095125]
Stock Position:  0.060951253539582216
Bond Position:  [-30.45561166]


portfolio before change:  [-24.4073384]
curr_Stock_Price:  99.26254921625561
curr_Factors:  [99.26254922]
mat_Sqrt:  [[0.15]]
grads:  [0.07759674]
Stock Position:  0.07759673644014713
Bond Position:  [-32.10978827]


portfolio before change:  [-24.40564636]
curr_Stock_Price:  99.31021822620825
curr_Factors:  [99.31021823]
mat_Sqrt:  [[0.15]]
grads:  [-0.06894784]
Stock Position:  -0.06894784454129618
Bond Position:  [-17.55842087]


portfolio before change:  [-24.40679666]
curr_Stock_Price:  99.31098497147897
curr_Factors:  [99.31098497]
mat_Sqrt:  [[0.15]]
grads:  [0.02908388]
Stock Position:  0.029083882135433024
Bond Position:  [-27.29514564]


portfolio before change:  [-24.42378117]
curr_Stock_Price:  98.78565939398436
curr_Factors:  [98.78565939]
mat_Sqrt:  [[0.15]]
grads:  [0.12338045]
Stock Position:  0.12338044544759305
Bond Position:  [-36.61199983]


portfolio before change:  [-24.4636149]
curr_Stock_Price:  98.48135338780192
curr_Factors:  [98.48135339]
mat_Sqrt:  [[0.15]]
grads:  [0.03220732]
Stock Position:  0.0322073195600554
Bond Position:  [-27.63543532]


portfolio before change:  [-24.50046051]
curr_Stock_Price:  97.39096939493946
curr_Factors:  [97.39096939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00353974]
Stock Position:  -0.0035397404021017976
Bond Position:  [-24.15572177]


portfolio before change:  [-24.50023729]
curr_Stock_Price:  96.90138461479994
curr_Factors:  [96.90138461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445123]
Stock Position:  -0.03445123284847226
Bond Position:  [-21.16186513]


portfolio before change:  [-24.50517454]
curr_Stock_Price:  97.00630352722412
curr_Factors:  [97.00630353]
mat_Sqrt:  [[0.15]]
grads:  [-0.07305174]
Stock Position:  -0.07305173993363129
Bond Position:  [-17.41869528]


portfolio before change:  [-24.52553898]
curr_Stock_Price:  97.27016775373801
curr_Factors:  [97.27016775]
mat_Sqrt:  [[0.15]]
grads:  [0.04717081]
Stock Position:  0.04717081036765109
Bond Position:  [-29.11385162]


portfolio before change:  [-24.51364496]
curr_Stock_Price:  97.56089189340034
curr_Factors:  [97.56089189]
mat_Sqrt:  [[0.15]]
grads:  [0.20015212]
Stock Position:  0.2001521202907959
Bond Position:  [-44.04066433]


portfolio before change:  [-24.41798167]
curr_Stock_Price:  98.05259747073963
curr_Factors:  [98.05259747]
mat_Sqrt:  [[0.15]]
grads:  [-0.01934568]
Stock Position:  -0.01934567595839387
Bond Position:  [-22.52108789]


portfolio before change:  [-24.41831629]
curr_Stock_Price:  97.99713318184722
curr_Factors:  [97.99713318]
mat_Sqrt:  [[0.15]]
grads:  [0.01664025]
Stock Position:  0.016640251184208976
Bond Position:  [-26.0490132]


portfolio before change:  [-24.42545232]
curr_Stock_Price:  97.66613335139415
curr_Factors:  [97.66613335]
mat_Sqrt:  [[0.15]]
grads:  [-0.0816702]
Stock Position:  -0.0816701988245727
Bond Position:  [-16.44903979]


portfolio before change:  [-24.47465096]
curr_Stock_Price:  98.25595123158146
curr_Factors:  [98.25595123]
mat_Sqrt:  [[0.15]]
grads:  [0.10484765]
Stock Position:  0.1048476499481557
Bond Position:  [-34.77655654]


portfolio before change:  [-24.56822089]
curr_Stock_Price:  97.38424525223071
curr_Factors:  [97.38424525]
mat_Sqrt:  [[0.15]]
grads:  [0.06663857]
Stock Position:  0.06663857426153097
Bond Position:  [-31.05776815]


portfolio before change:  [-24.61322928]
curr_Stock_Price:  96.73796460402092
curr_Factors:  [96.7379646]
mat_Sqrt:  [[0.15]]
grads:  [0.0354797]
Stock Position:  0.03547969538913578
Bond Position:  [-28.0454628]


portfolio before change:  [-24.62337445]
curr_Stock_Price:  96.50142724748083
curr_Factors:  [96.50142725]
mat_Sqrt:  [[0.15]]
grads:  [-0.05390187]
Stock Position:  -0.05390187446694524
Bond Position:  [-19.42176664]


portfolio before change:  [-24.5799974]
curr_Stock_Price:  95.67416559603032
curr_Factors:  [95.6741656]
mat_Sqrt:  [[0.15]]
grads:  [-4.40194157e-06]
Stock Position:  -4.4019415690545824e-06
Bond Position:  [-24.57957625]


portfolio before change:  [-24.58153035]
curr_Stock_Price:  94.9201339640561
curr_Factors:  [94.92013396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649647]
Stock Position:  -0.006496468510501554
Bond Position:  [-23.96488469]


portfolio before change:  [-24.57906948]
curr_Stock_Price:  94.31076870623166
curr_Factors:  [94.31076871]
mat_Sqrt:  [[0.15]]
grads:  [-0.03020078]
Stock Position:  -0.030200777794926553
Bond Position:  [-21.73081091]


portfolio before change:  [-24.59383011]
curr_Stock_Price:  94.75454583597387
curr_Factors:  [94.75454584]
mat_Sqrt:  [[0.15]]
grads:  [-0.00629783]
Stock Position:  -0.006297825169307835
Bond Position:  [-23.99708255]


portfolio before change:  [-24.6033805]
curr_Stock_Price:  96.03284782515206
curr_Factors:  [96.03284783]
mat_Sqrt:  [[0.15]]
grads:  [0.05273035]
Stock Position:  0.052730345166168494
Bond Position:  [-29.66722571]


portfolio before change:  [-24.59254129]
curr_Stock_Price:  96.273572061363
curr_Factors:  [96.27357206]
mat_Sqrt:  [[0.15]]
grads:  [-0.07422507]
Stock Position:  -0.07422506925812832
Bond Position:  [-17.44662873]


portfolio before change:  [-24.53350071]
curr_Stock_Price:  95.46345456908597
curr_Factors:  [95.46345457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03437201]
Stock Position:  -0.03437201015388689
Bond Position:  [-21.25222988]


portfolio before change:  [-24.55018384]
curr_Stock_Price:  95.91017939307315
curr_Factors:  [95.91017939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00987374]
Stock Position:  -0.009873735041485332
Bond Position:  [-23.60319214]


portfolio before change:  [-24.55224363]
curr_Stock_Price:  95.96938114406973
curr_Factors:  [95.96938114]
mat_Sqrt:  [[0.15]]
grads:  [0.08709638]
Stock Position:  0.08709638256459334
Bond Position:  [-32.91082957]


portfolio before change:  [-24.62933227]
curr_Stock_Price:  95.10790278892372
curr_Factors:  [95.10790279]
mat_Sqrt:  [[0.15]]
grads:  [0.04399248]
Stock Position:  0.04399247987302031
Bond Position:  [-28.81336477]


portfolio before change:  [-24.6458626]
curr_Stock_Price:  94.7730857002185
curr_Factors:  [94.7730857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01612918]
Stock Position:  -0.016129181731082787
Bond Position:  [-23.11725027]


portfolio before change:  [-24.66557202]
curr_Stock_Price:  95.90547739339824
curr_Factors:  [95.90547739]
mat_Sqrt:  [[0.15]]
grads:  [-0.03414495]
Stock Position:  -0.03414495479214589
Bond Position:  [-21.39088383]


portfolio before change:  [-24.64621634]
curr_Stock_Price:  95.2994536711722
curr_Factors:  [95.29945367]
mat_Sqrt:  [[0.15]]
grads:  [-0.0173027]
Stock Position:  -0.01730270393310931
Bond Position:  [-22.99727811]


portfolio before change:  [-24.64945847]
curr_Stock_Price:  95.4037586537486
curr_Factors:  [95.40375865]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858895]
Stock Position:  -0.00858894513535987
Bond Position:  [-23.83004083]


portfolio before change:  [-24.65285165]
curr_Stock_Price:  95.62540966736918
curr_Factors:  [95.62540967]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677807]
Stock Position:  -0.026778072687599734
Bond Position:  [-22.09218748]


portfolio before change:  [-24.66215474]
curr_Stock_Price:  95.92125950231971
curr_Factors:  [95.9212595]
mat_Sqrt:  [[0.15]]
grads:  [0.12371983]
Stock Position:  0.12371982896642804
Bond Position:  [-36.52951656]


portfolio before change:  [-24.51554001]
curr_Stock_Price:  97.12476823211131
curr_Factors:  [97.12476823]
mat_Sqrt:  [[0.15]]
grads:  [0.02923882]
Stock Position:  0.029238818273458138
Bond Position:  [-27.35535346]


portfolio before change:  [-24.5134345]
curr_Stock_Price:  97.25525482758238
curr_Factors:  [97.25525483]
mat_Sqrt:  [[0.15]]
grads:  [0.0905686]
Stock Position:  0.09056859744219938
Bond Position:  [-33.32170652]


portfolio before change:  [-24.47489972]
curr_Stock_Price:  97.70372647829811
curr_Factors:  [97.70372648]
mat_Sqrt:  [[0.15]]
grads:  [-0.00614999]
Stock Position:  -0.006149994299715723
Bond Position:  [-23.87402236]


portfolio before change:  [-24.47661141]
curr_Stock_Price:  97.73942009018715
curr_Factors:  [97.73942009]
mat_Sqrt:  [[0.15]]
grads:  [0.02081737]
Stock Position:  0.020817368946667098
Bond Position:  [-26.51128898]


portfolio before change:  [-24.48456667]
curr_Stock_Price:  97.43687203096482
curr_Factors:  [97.43687203]
mat_Sqrt:  [[0.15]]
grads:  [0.15418149]
Stock Position:  0.15418148797828715
Bond Position:  [-39.50752859]


portfolio before change:  [-24.64035975]
curr_Stock_Price:  96.44243504791794
curr_Factors:  [96.44243505]
mat_Sqrt:  [[0.15]]
grads:  [0.02208314]
Stock Position:  0.022083144419866994
Bond Position:  [-26.77011197]


portfolio before change:  [-24.64290276]
curr_Stock_Price:  96.40304608429334
curr_Factors:  [96.40304608]
mat_Sqrt:  [[0.15]]
grads:  [-0.1026832]
Stock Position:  -0.10268319553429066
Bond Position:  [-14.74392993]


portfolio before change:  [-24.63882772]
curr_Stock_Price:  96.35438608169152
curr_Factors:  [96.35438608]
mat_Sqrt:  [[0.15]]
grads:  [-0.03915841]
Stock Position:  -0.039158411778793235
Bond Position:  [-20.865743]


portfolio before change:  [-24.60642723]
curr_Stock_Price:  95.49366062823162
curr_Factors:  [95.49366063]
mat_Sqrt:  [[0.15]]
grads:  [0.01617773]
Stock Position:  0.01617772530795083
Bond Position:  [-26.15129744]


portfolio before change:  [-24.60251475]
curr_Stock_Price:  95.83653852369845
curr_Factors:  [95.83653852]
mat_Sqrt:  [[0.15]]
grads:  [0.07135386]
Stock Position:  0.07135385667233046
Bond Position:  [-31.44082139]


portfolio before change:  [-24.59728664]
curr_Stock_Price:  95.93734911482353
curr_Factors:  [95.93734911]
mat_Sqrt:  [[0.15]]
grads:  [0.03007844]
Stock Position:  0.030078438070776335
Bond Position:  [-27.48293226]


portfolio before change:  [-24.60270436]
curr_Stock_Price:  95.81433810013394
curr_Factors:  [95.8143381]
mat_Sqrt:  [[0.15]]
grads:  [-0.0068348]
Stock Position:  -0.006834801884715667
Bond Position:  [-23.94783234]


portfolio before change:  [-24.60562321]
curr_Stock_Price:  96.02240043230218
curr_Factors:  [96.02240043]
mat_Sqrt:  [[0.15]]
grads:  [-0.09896411]
Stock Position:  -0.09896410740014334
Bond Position:  [-15.10285206]


portfolio before change:  [-24.57562335]
curr_Stock_Price:  95.70972330779844
curr_Factors:  [95.70972331]
mat_Sqrt:  [[0.15]]
grads:  [-0.19037765]
Stock Position:  -0.19037765019416883
Bond Position:  [-6.35463113]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.6531358]
Stock Price:  96.1147880006997
PL:  [-24.6531358]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37255442e-02]
 [ 1.04706422e-02]
 [ 3.13288731e-03]
 [-6.00200837e-03]
 [ 1.34981891e-02]
 [-3.60771889e-03]
 [-7.95636236e-03]
 [-2.70557563e-02]
 [ 1.20648458e-02]
 [ 9.22085711e-04]
 [-9.93130109e-03]
 [ 1.83034053e-02]
 [-4.53957949e-03]
 [ 3.53812678e-03]
 [ 7.43051504e-03]
 [ 1.01222869e-02]
 [ 9.68592053e-02]
 [-9.84727731e-03]
 [ 2.25872595e-02]
 [ 7.24206967e-04]
 [-4.95517416e-03]
 [ 4.79226539e-03]
 [ 1.10696491e-02]
 [ 2.47762355e-02]
 [-4.32411653e-04]
 [ 7.14893913e-03]
 [-2.83354275e-03]
 [ 9.14467826e-03]
 [ 2.82013706e-02]
 [-8.36292343e-03]
 [-1.49532117e-03]
 [ 1.35530001e-02]
 [ 1.27529625e-02]
 [ 3.50194050e-03]
 [ 5.69965580e-03]
 [ 1.01737157e-02]
 [-2.16806069e-02]
 [-3.79717973e-03]
 [-2.23143131e-02]
 [-2.06969877e-02]
 [ 3.70001586e-03]
 [ 9.43068697e-03]
 [-6.69689669e-03]
 [-2.20575988e-03]
 [ 2.17899058e-02]
 [ 1.43079420e-02]
 [ 1.07210997e-02]
 [ 2.99110753e-03]
 [ 1.07480877e-02]
 [-1.18169618e-03]
 [ 2.18970994e-02]
 [-7.30762323e-03]
 [ 5.76059011e-04]
 [-4.93512154e-03]
 [-3.60168148e-03]
 [-3.43415673e-03]
 [ 1.04118544e-02]
 [-5.05872384e-03]
 [ 6.56622825e-03]
 [-3.99784306e-03]
 [-1.83507958e-03]
 [ 8.44933199e-03]
 [-1.51237116e-02]
 [ 6.37309794e-03]
 [ 2.55208872e-02]
 [ 5.36239406e-03]
 [ 1.12743885e-02]
 [ 3.52858810e-03]
 [ 4.31076271e-03]
 [ 1.94089258e-02]
 [ 5.09164406e-04]
 [-1.59612892e-02]
 [-3.73622768e-03]
 [ 1.10214322e-03]
 [ 6.37682616e-03]
 [-2.63290736e-04]
 [-1.44203568e-03]
 [ 1.92761107e-03]
 [-2.40131211e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.60909213]
curr_Stock_Price:  99.65305210831514
curr_Factors:  [99.65305211]
mat_Sqrt:  [[0.15]]
grads:  [-0.09150363]
Stock Position:  -0.09150362795674202
Bond Position:  [3.50952368]


portfolio before change:  [-5.63926305]
curr_Stock_Price:  99.98517310667721
curr_Factors:  [99.98517311]
mat_Sqrt:  [[0.15]]
grads:  [0.06980428]
Stock Position:  0.06980428141750294
Bond Position:  [-12.61865621]


portfolio before change:  [-5.63432522]
curr_Stock_Price:  100.06721001825728
curr_Factors:  [100.06721002]
mat_Sqrt:  [[0.15]]
grads:  [0.02088592]
Stock Position:  0.020885915391478452
Bond Position:  [-7.7243205]


portfolio before change:  [-5.63303341]
curr_Stock_Price:  100.1521757599562
curr_Factors:  [100.15217576]
mat_Sqrt:  [[0.15]]
grads:  [-0.04001339]
Stock Position:  -0.04001338914394793
Bond Position:  [-1.62560543]


portfolio before change:  [-5.61724875]
curr_Stock_Price:  99.75515188956463
curr_Factors:  [99.75515189]
mat_Sqrt:  [[0.15]]
grads:  [0.08998793]
Stock Position:  0.08998792736671786
Bond Position:  [-14.59400811]


portfolio before change:  [-5.56638118]
curr_Stock_Price:  100.33055933572038
curr_Factors:  [100.33055934]
mat_Sqrt:  [[0.15]]
grads:  [-0.02405146]
Stock Position:  -0.02405145928999013
Bond Position:  [-3.15328481]


portfolio before change:  [-5.57683803]
curr_Stock_Price:  100.7571351327935
curr_Factors:  [100.75713513]
mat_Sqrt:  [[0.15]]
grads:  [-0.05304242]
Stock Position:  -0.05304241574206163
Bond Position:  [-0.23243618]


portfolio before change:  [-5.58588306]
curr_Stock_Price:  100.92738556824233
curr_Factors:  [100.92738557]
mat_Sqrt:  [[0.15]]
grads:  [-0.18037171]
Stock Position:  -0.1803717087018523
Bond Position:  [12.61856193]


portfolio before change:  [-5.64231536]
curr_Stock_Price:  101.24462484358565
curr_Factors:  [101.24462484]
mat_Sqrt:  [[0.15]]
grads:  [0.08043231]
Stock Position:  0.08043230533494858
Bond Position:  [-13.78565394]


portfolio before change:  [-5.68065025]
curr_Stock_Price:  100.77872679411279
curr_Factors:  [100.77872679]
mat_Sqrt:  [[0.15]]
grads:  [0.00614724]
Stock Position:  0.006147238076189415
Bond Position:  [-6.30016107]


portfolio before change:  [-5.67397289]
curr_Stock_Price:  101.92901987748246
curr_Factors:  [101.92901988]
mat_Sqrt:  [[0.15]]
grads:  [-0.06620867]
Stock Position:  -0.06620867393788413
Bond Position:  [1.07461235]


portfolio before change:  [-5.68751256]
curr_Stock_Price:  102.1345342177409
curr_Factors:  [102.13453422]
mat_Sqrt:  [[0.15]]
grads:  [0.1220227]
Stock Position:  0.12202270223965528
Bond Position:  [-18.15024442]


portfolio before change:  [-5.62743938]
curr_Stock_Price:  102.63614256133769
curr_Factors:  [102.63614256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03026386]
Stock Position:  -0.030263863286412614
Bond Position:  [-2.52127319]


portfolio before change:  [-5.62823662]
curr_Stock_Price:  102.65727854353742
curr_Factors:  [102.65727854]
mat_Sqrt:  [[0.15]]
grads:  [0.02358751]
Stock Position:  0.023587511885799533
Bond Position:  [-8.0496664]


portfolio before change:  [-5.63138988]
curr_Stock_Price:  102.54492494163519
curr_Factors:  [102.54492494]
mat_Sqrt:  [[0.15]]
grads:  [0.04953677]
Stock Position:  0.049536766923888344
Bond Position:  [-10.71113393]


portfolio before change:  [-5.61729101]
curr_Stock_Price:  102.8430538848441
curr_Factors:  [102.84305388]
mat_Sqrt:  [[0.15]]
grads:  [0.06748191]
Stock Position:  0.06748191299339305
Bond Position:  [-12.55733702]


portfolio before change:  [-5.61090899]
curr_Stock_Price:  102.94925830659415
curr_Factors:  [102.94925831]
mat_Sqrt:  [[0.15]]
grads:  [0.64572804]
Stock Position:  0.6457280354645145
Bond Position:  [-72.0881313]


portfolio before change:  [-5.44978497]
curr_Stock_Price:  103.20575896257778
curr_Factors:  [103.20575896]
mat_Sqrt:  [[0.15]]
grads:  [-0.06564852]
Stock Position:  -0.06564851540498175
Bond Position:  [1.32551989]


portfolio before change:  [-5.40423294]
curr_Stock_Price:  102.51314338778433
curr_Factors:  [102.51314339]
mat_Sqrt:  [[0.15]]
grads:  [0.15058173]
Stock Position:  0.15058173025765545
Bond Position:  [-20.84083944]


portfolio before change:  [-5.39254992]
curr_Stock_Price:  102.59937970016084
curr_Factors:  [102.5993797]
mat_Sqrt:  [[0.15]]
grads:  [0.00482805]
Stock Position:  0.004828046444871954
Bond Position:  [-5.88790449]


portfolio before change:  [-5.39605018]
curr_Stock_Price:  101.95061763743912
curr_Factors:  [101.95061764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03303449]
Stock Position:  -0.03303449439945321
Bond Position:  [-2.02816307]


portfolio before change:  [-5.38940435]
curr_Stock_Price:  101.74560186292686
curr_Factors:  [101.74560186]
mat_Sqrt:  [[0.15]]
grads:  [0.03194844]
Stock Position:  0.03194843596225681
Bond Position:  [-8.64001719]


portfolio before change:  [-5.38794636]
curr_Stock_Price:  101.80814034189926
curr_Factors:  [101.80814034]
mat_Sqrt:  [[0.15]]
grads:  [0.07379766]
Stock Position:  0.07379766088977124
Bond Position:  [-12.90114898]


portfolio before change:  [-5.3930928]
curr_Stock_Price:  101.74932959401696
curr_Factors:  [101.74932959]
mat_Sqrt:  [[0.15]]
grads:  [0.1651749]
Stock Position:  0.16517490364575108
Bond Position:  [-22.19952851]


portfolio before change:  [-5.36031337]
curr_Stock_Price:  101.95618275862437
curr_Factors:  [101.95618276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00288274]
Stock Position:  -0.002882744355553827
Bond Position:  [-5.06639976]


portfolio before change:  [-5.35884445]
curr_Stock_Price:  101.33678230375142
curr_Factors:  [101.3367823]
mat_Sqrt:  [[0.15]]
grads:  [0.04765959]
Stock Position:  0.047659594210635606
Bond Position:  [-10.18851438]


portfolio before change:  [-5.40525065]
curr_Stock_Price:  100.37644273805337
curr_Factors:  [100.37644274]
mat_Sqrt:  [[0.15]]
grads:  [-0.01889029]
Stock Position:  -0.01889028501095356
Bond Position:  [-3.50911104]


portfolio before change:  [-5.42208297]
curr_Stock_Price:  101.25588947273526
curr_Factors:  [101.25588947]
mat_Sqrt:  [[0.15]]
grads:  [0.06096452]
Stock Position:  0.060964521721244176
Bond Position:  [-11.59509985]


portfolio before change:  [-5.37902656]
curr_Stock_Price:  101.97403064435899
curr_Factors:  [101.97403064]
mat_Sqrt:  [[0.15]]
grads:  [0.18800914]
Stock Position:  0.18800913726723875
Bond Position:  [-24.55107608]


portfolio before change:  [-5.27901441]
curr_Stock_Price:  102.51414605905401
curr_Factors:  [102.51414606]
mat_Sqrt:  [[0.15]]
grads:  [-0.05575282]
Stock Position:  -0.055752822856670325
Bond Position:  [0.43643861]


portfolio before change:  [-5.27074409]
curr_Stock_Price:  102.36629619265723
curr_Factors:  [102.36629619]
mat_Sqrt:  [[0.15]]
grads:  [-0.00996881]
Stock Position:  -0.009968807772606827
Bond Position:  [-4.25027416]


portfolio before change:  [-5.26818133]
curr_Stock_Price:  102.08257061341682
curr_Factors:  [102.08257061]
mat_Sqrt:  [[0.15]]
grads:  [0.09035333]
Stock Position:  0.09035333373410162
Bond Position:  [-14.4916819]


portfolio before change:  [-5.3209569]
curr_Stock_Price:  101.50849316393435
curr_Factors:  [101.50849316]
mat_Sqrt:  [[0.15]]
grads:  [0.08501975]
Stock Position:  0.0850197500101448
Bond Position:  [-13.95118362]


portfolio before change:  [-5.26969257]
curr_Stock_Price:  102.12171898626768
curr_Factors:  [102.12171899]
mat_Sqrt:  [[0.15]]
grads:  [0.02334627]
Stock Position:  0.02334627002586541
Bond Position:  [-7.6538538]


portfolio before change:  [-5.26250259]
curr_Stock_Price:  102.45018116024636
curr_Factors:  [102.45018116]
mat_Sqrt:  [[0.15]]
grads:  [0.03799771]
Stock Position:  0.037997705306095884
Bond Position:  [-9.15537438]


portfolio before change:  [-5.26021654]
curr_Stock_Price:  102.52540341612625
curr_Factors:  [102.52540342]
mat_Sqrt:  [[0.15]]
grads:  [0.06782477]
Stock Position:  0.06782477136273932
Bond Position:  [-12.21397859]


portfolio before change:  [-5.26360738]
curr_Stock_Price:  102.4866647765817
curr_Factors:  [102.48666478]
mat_Sqrt:  [[0.15]]
grads:  [-0.14453738]
Stock Position:  -0.14453737954793663
Bond Position:  [9.54954659]


portfolio before change:  [-5.28354716]
curr_Stock_Price:  102.6287501095072
curr_Factors:  [102.62875011]
mat_Sqrt:  [[0.15]]
grads:  [-0.02531453]
Stock Position:  -0.025314531516440072
Bond Position:  [-2.68554843]


portfolio before change:  [-5.29306227]
curr_Stock_Price:  102.99799511730923
curr_Factors:  [102.99799512]
mat_Sqrt:  [[0.15]]
grads:  [-0.14876209]
Stock Position:  -0.1487620871716498
Bond Position:  [10.02913446]


portfolio before change:  [-5.38753241]
curr_Stock_Price:  103.63725058598692
curr_Factors:  [103.63725059]
mat_Sqrt:  [[0.15]]
grads:  [-0.13797992]
Stock Position:  -0.13797991805999968
Bond Position:  [8.91232693]


portfolio before change:  [-5.36155419]
curr_Stock_Price:  103.45301228731165
curr_Factors:  [103.45301229]
mat_Sqrt:  [[0.15]]
grads:  [0.02466677]
Stock Position:  0.02466677242340912
Bond Position:  [-7.9134061]


portfolio before change:  [-5.36903833]
curr_Stock_Price:  103.16965383492416
curr_Factors:  [103.16965383]
mat_Sqrt:  [[0.15]]
grads:  [0.06287125]
Stock Position:  0.0628712464370769
Bond Position:  [-11.85544306]


portfolio before change:  [-5.42235883]
curr_Stock_Price:  102.33334918668814
curr_Factors:  [102.33334919]
mat_Sqrt:  [[0.15]]
grads:  [-0.04464598]
Stock Position:  -0.04464597794603996
Bond Position:  [-0.85358638]


portfolio before change:  [-5.4173234]
curr_Stock_Price:  102.21936843157044
curr_Factors:  [102.21936843]
mat_Sqrt:  [[0.15]]
grads:  [-0.01470507]
Stock Position:  -0.01470506584214758
Bond Position:  [-3.91418086]


portfolio before change:  [-5.39471007]
curr_Stock_Price:  100.66494005004361
curr_Factors:  [100.66494005]
mat_Sqrt:  [[0.15]]
grads:  [0.14526604]
Stock Position:  0.14526603873674773
Bond Position:  [-20.01790715]


portfolio before change:  [-5.36541498]
curr_Stock_Price:  100.87521804159316
curr_Factors:  [100.87521804]
mat_Sqrt:  [[0.15]]
grads:  [0.09538628]
Stock Position:  0.09538627986497751
Bond Position:  [-14.98752676]


portfolio before change:  [-5.33111958]
curr_Stock_Price:  101.24458094683605
curr_Factors:  [101.24458095]
mat_Sqrt:  [[0.15]]
grads:  [0.071474]
Stock Position:  0.07147399833203757
Bond Position:  [-12.56747459]


portfolio before change:  [-5.32793198]
curr_Stock_Price:  101.3001688227071
curr_Factors:  [101.30016882]
mat_Sqrt:  [[0.15]]
grads:  [0.01994072]
Stock Position:  0.019940716872753457
Bond Position:  [-7.34792997]


portfolio before change:  [-5.33512768]
curr_Stock_Price:  100.96234557682773
curr_Factors:  [100.96234558]
mat_Sqrt:  [[0.15]]
grads:  [0.07165392]
Stock Position:  0.07165391813918814
Bond Position:  [-12.56947532]


portfolio before change:  [-5.254113]
curr_Stock_Price:  102.1039480817537
curr_Factors:  [102.10394808]
mat_Sqrt:  [[0.15]]
grads:  [-0.00787797]
Stock Position:  -0.007877974511925769
Bond Position:  [-4.4497407]


portfolio before change:  [-5.25959451]
curr_Stock_Price:  102.76444664142495
curr_Factors:  [102.76444664]
mat_Sqrt:  [[0.15]]
grads:  [0.14598066]
Stock Position:  0.14598066263364054
Bond Position:  [-20.26121653]


portfolio before change:  [-5.28050106]
curr_Stock_Price:  102.62990704657673
curr_Factors:  [102.62990705]
mat_Sqrt:  [[0.15]]
grads:  [-0.04871749]
Stock Position:  -0.04871748817825733
Bond Position:  [-0.28062977]


portfolio before change:  [-5.25683075]
curr_Stock_Price:  102.14367817997308
curr_Factors:  [102.14367818]
mat_Sqrt:  [[0.15]]
grads:  [0.00384039]
Stock Position:  0.0038403934069217486
Bond Position:  [-5.64910266]


portfolio before change:  [-5.25818338]
curr_Stock_Price:  101.88340439084051
curr_Factors:  [101.88340439]
mat_Sqrt:  [[0.15]]
grads:  [-0.03290081]
Stock Position:  -0.032900810248162535
Bond Position:  [-1.90613683]


portfolio before change:  [-5.23617369]
curr_Stock_Price:  101.21081227445046
curr_Factors:  [101.21081227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02401121]
Stock Position:  -0.024011209886145714
Bond Position:  [-2.80597964]


portfolio before change:  [-5.24541263]
curr_Stock_Price:  101.58828404246391
curr_Factors:  [101.58828404]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289438]
Stock Position:  -0.022894378221430846
Bond Position:  [-2.91961203]


portfolio before change:  [-5.24745567]
curr_Stock_Price:  101.66955129628352
curr_Factors:  [101.6695513]
mat_Sqrt:  [[0.15]]
grads:  [0.06941236]
Stock Position:  0.06941236243217173
Bond Position:  [-12.30457941]


portfolio before change:  [-5.25147504]
curr_Stock_Price:  101.62272518597959
curr_Factors:  [101.62272519]
mat_Sqrt:  [[0.15]]
grads:  [-0.03372483]
Stock Position:  -0.033724825594344005
Bond Position:  [-1.82426636]


portfolio before change:  [-5.26037362]
curr_Stock_Price:  101.88320266315257
curr_Factors:  [101.88320266]
mat_Sqrt:  [[0.15]]
grads:  [0.04377485]
Stock Position:  0.04377485498302086
Bond Position:  [-9.72029604]


portfolio before change:  [-5.2823116]
curr_Stock_Price:  101.39592642377825
curr_Factors:  [101.39592642]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665229]
Stock Position:  -0.026652287072597057
Bond Position:  [-2.57987826]


portfolio before change:  [-5.2883129]
curr_Stock_Price:  101.61504625845824
curr_Factors:  [101.61504626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01223386]
Stock Position:  -0.01223386383506694
Bond Position:  [-4.04516826]


portfolio before change:  [-5.29353924]
curr_Stock_Price:  102.0215826657533
curr_Factors:  [102.02158267]
mat_Sqrt:  [[0.15]]
grads:  [0.05632888]
Stock Position:  0.05632887994764846
Bond Position:  [-11.04030072]


portfolio before change:  [-5.29797618]
curr_Stock_Price:  101.95506432904367
curr_Factors:  [101.95506433]
mat_Sqrt:  [[0.15]]
grads:  [-0.10082474]
Stock Position:  -0.10082474422324846
Bond Position:  [4.9816171]


portfolio before change:  [-5.24069281]
curr_Stock_Price:  101.39000451610437
curr_Factors:  [101.39000452]
mat_Sqrt:  [[0.15]]
grads:  [0.04248732]
Stock Position:  0.04248731957281025
Bond Position:  [-9.54848233]


portfolio before change:  [-5.22966508]
curr_Stock_Price:  101.66360440756613
curr_Factors:  [101.66360441]
mat_Sqrt:  [[0.15]]
grads:  [0.17013925]
Stock Position:  0.17013924776051687
Bond Position:  [-22.52663426]


portfolio before change:  [-5.22502538]
curr_Stock_Price:  101.6991497876027
curr_Factors:  [101.69914979]
mat_Sqrt:  [[0.15]]
grads:  [0.03574929]
Stock Position:  0.03574929373178677
Bond Position:  [-8.86069815]


portfolio before change:  [-5.24276596]
curr_Stock_Price:  101.21839150299283
curr_Factors:  [101.2183915]
mat_Sqrt:  [[0.15]]
grads:  [0.07516259]
Stock Position:  0.07516259010108411
Bond Position:  [-12.85060243]


portfolio before change:  [-5.21438243]
curr_Stock_Price:  101.60670593550714
curr_Factors:  [101.60670594]
mat_Sqrt:  [[0.15]]
grads:  [0.02352392]
Stock Position:  0.0235239206825222
Bond Position:  [-7.60457052]


portfolio before change:  [-5.19584878]
curr_Stock_Price:  102.41477483102699
curr_Factors:  [102.41477483]
mat_Sqrt:  [[0.15]]
grads:  [0.02873842]
Stock Position:  0.02873841805546425
Bond Position:  [-8.13908739]


portfolio before change:  [-5.21260613]
curr_Stock_Price:  101.84937690013334
curr_Factors:  [101.8493769]
mat_Sqrt:  [[0.15]]
grads:  [0.12939284]
Stock Position:  0.12939283868570292
Bond Position:  [-18.39118612]


portfolio before change:  [-5.26369025]
curr_Stock_Price:  101.46346191042907
curr_Factors:  [101.46346191]
mat_Sqrt:  [[0.15]]
grads:  [0.00339443]
Stock Position:  0.0033944293766187813
Bond Position:  [-5.60810081]


portfolio before change:  [-5.26682964]
curr_Stock_Price:  100.6418585956615
curr_Factors:  [100.6418586]
mat_Sqrt:  [[0.15]]
grads:  [-0.10640859]
Stock Position:  -0.10640859447931582
Bond Position:  [5.44232908]


portfolio before change:  [-5.1863808]
curr_Stock_Price:  99.88901827291949
curr_Factors:  [99.88901827]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490818]
Stock Position:  -0.024908184508572233
Bond Position:  [-2.69832671]


portfolio before change:  [-5.16872749]
curr_Stock_Price:  99.17351173195159
curr_Factors:  [99.17351173]
mat_Sqrt:  [[0.15]]
grads:  [0.00734762]
Stock Position:  0.0073476214801179
Bond Position:  [-5.89741691]


portfolio before change:  [-5.17536887]
curr_Stock_Price:  98.31979504274098
curr_Factors:  [98.31979504]
mat_Sqrt:  [[0.15]]
grads:  [0.04251217]
Stock Position:  0.04251217436683417
Bond Position:  [-9.35515714]


portfolio before change:  [-5.16821173]
curr_Stock_Price:  98.50190415921972
curr_Factors:  [98.50190416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00175527]
Stock Position:  -0.0017552715756529356
Bond Position:  [-4.99531414]


portfolio before change:  [-5.168693]
curr_Stock_Price:  98.5982126007592
curr_Factors:  [98.5982126]
mat_Sqrt:  [[0.15]]
grads:  [-0.00961357]
Stock Position:  -0.009613571219539273
Bond Position:  [-4.22081206]


portfolio before change:  [-5.17025633]
curr_Stock_Price:  98.7333882205225
curr_Factors:  [98.73338822]
mat_Sqrt:  [[0.15]]
grads:  [0.01285074]
Stock Position:  0.012850740435603546
Bond Position:  [-6.43905347]


portfolio before change:  [-5.16765231]
curr_Stock_Price:  98.96734147606207
curr_Factors:  [98.96734148]
mat_Sqrt:  [[0.15]]
grads:  [-0.16008747]
Stock Position:  -0.16008747367690324
Bond Position:  [10.67577936]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.25534116]
Stock Price:  99.51926540976984
PL:  [-5.25534116]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.27738572e-02]
 [-2.64415971e-02]
 [ 5.51660824e-02]
 [-1.18656079e-02]
 [ 1.09581458e-02]
 [-1.49459994e-02]
 [-1.35292948e-02]
 [ 5.78412496e-02]
 [-2.09538571e-02]
 [-1.34046478e-02]
 [ 9.08131231e-03]
 [-7.10557103e-03]
 [ 1.38963492e-03]
 [ 7.10101184e-04]
 [-2.40525969e-03]
 [ 9.96930363e-03]
 [ 1.66018009e-02]
 [-1.46748045e-02]
 [ 1.95804926e-02]
 [ 2.47273739e-03]
 [-4.28619550e-03]
 [ 4.65481456e-03]
 [ 1.49780552e-02]
 [ 1.73565987e-02]
 [-3.53686162e-03]
 [ 5.04674771e-03]
 [-1.05459633e-02]
 [ 7.86020757e-03]
 [ 3.39730794e-02]
 [ 5.17991729e-03]
 [-6.81221763e-03]
 [ 1.20590738e-02]
 [ 1.24018077e-02]
 [ 6.32810472e-03]
 [ 5.52373504e-03]
 [ 9.61590067e-03]
 [-2.65982651e-02]
 [ 2.65726508e-03]
 [-5.71667440e-02]
 [-4.92352329e-03]
 [ 7.20666265e-03]
 [-1.37964683e-03]
 [-1.95618297e-03]
 [-1.62662288e-03]
 [ 8.41860982e-03]
 [ 1.49408994e-02]
 [ 1.03037418e-02]
 [ 5.26315555e-03]
 [-3.28502517e-03]
 [-1.17466905e-03]
 [-6.94186477e-03]
 [ 1.44877789e-03]
 [ 1.33041867e-03]
 [ 7.85284046e-03]
 [-7.75812532e-03]
 [-4.57097938e-03]
 [ 3.51901499e-04]
 [ 9.32617114e-03]
 [ 7.48447563e-03]
 [-3.93471639e-03]
 [-2.46559663e-03]
 [ 2.69049411e-04]
 [-6.11791105e-03]
 [ 2.04436474e-03]
 [ 1.93272132e-02]
 [ 4.19195806e-03]
 [ 1.26655928e-02]
 [-1.58834997e-03]
 [ 4.86701053e-03]
 [ 2.46458202e-02]
 [ 3.37986428e-03]
 [-1.54223556e-02]
 [-5.89083991e-03]
 [ 1.98022537e-03]
 [ 1.00626350e-02]
 [ 3.56796893e-03]
 [-1.01316590e-03]
 [-1.43973437e-02]
 [-2.38448445e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.4491093]
curr_Stock_Price:  99.06988484104548
curr_Factors:  [99.06988484]
mat_Sqrt:  [[0.15]]
grads:  [-0.08515905]
Stock Position:  -0.08515904789539598
Bond Position:  [-10.01241224]


portfolio before change:  [-18.38632107]
curr_Stock_Price:  98.32523083138526
curr_Factors:  [98.32523083]
mat_Sqrt:  [[0.15]]
grads:  [-0.17627731]
Stock Position:  -0.17627731410221045
Bond Position:  [-1.05381347]


portfolio before change:  [-18.36551645]
curr_Stock_Price:  98.20683503740604
curr_Factors:  [98.20683504]
mat_Sqrt:  [[0.15]]
grads:  [0.36777388]
Stock Position:  0.36777388245144865
Bond Position:  [-54.48342545]


portfolio before change:  [-18.40832985]
curr_Stock_Price:  98.09968201682794
curr_Factors:  [98.09968202]
mat_Sqrt:  [[0.15]]
grads:  [-0.07910405]
Stock Position:  -0.07910405254895547
Bond Position:  [-10.64824745]


portfolio before change:  [-18.45557709]
curr_Stock_Price:  98.68854819901861
curr_Factors:  [98.6885482]
mat_Sqrt:  [[0.15]]
grads:  [0.07305431]
Stock Position:  0.07305430562363956
Bond Position:  [-25.66520045]


portfolio before change:  [-18.47662501]
curr_Stock_Price:  98.4223928267488
curr_Factors:  [98.42239283]
mat_Sqrt:  [[0.15]]
grads:  [-0.09964]
Stock Position:  -0.09963999575720857
Bond Position:  [-8.6698182]


portfolio before change:  [-18.45716588]
curr_Stock_Price:  98.22166004618725
curr_Factors:  [98.22166005]
mat_Sqrt:  [[0.15]]
grads:  [-0.0901953]
Stock Position:  -0.0901952983857689
Bond Position:  [-9.59803394]


portfolio before change:  [-18.41873649]
curr_Stock_Price:  97.78894031947836
curr_Factors:  [97.78894032]
mat_Sqrt:  [[0.15]]
grads:  [0.38560833]
Stock Position:  0.3856083307931783
Bond Position:  [-56.12696653]


portfolio before change:  [-18.55863958]
curr_Stock_Price:  97.43522635692453
curr_Factors:  [97.43522636]
mat_Sqrt:  [[0.15]]
grads:  [-0.13969238]
Stock Position:  -0.139692380623468
Bond Position:  [-4.94768086]


portfolio before change:  [-18.59698586]
curr_Stock_Price:  97.70751780252519
curr_Factors:  [97.7075178]
mat_Sqrt:  [[0.15]]
grads:  [-0.08936432]
Stock Position:  -0.0893643189004017
Bond Position:  [-9.86542008]


portfolio before change:  [-18.63206173]
curr_Stock_Price:  98.09312205801946
curr_Factors:  [98.09312206]
mat_Sqrt:  [[0.15]]
grads:  [0.06054208]
Stock Position:  0.06054208204777965
Bond Position:  [-24.57082358]


portfolio before change:  [-18.61312598]
curr_Stock_Price:  98.4312584248218
curr_Factors:  [98.43125842]
mat_Sqrt:  [[0.15]]
grads:  [-0.04737047]
Stock Position:  -0.04737047353679188
Bond Position:  [-13.95039065]


portfolio before change:  [-18.61598572]
curr_Stock_Price:  98.47322152185973
curr_Factors:  [98.47322152]
mat_Sqrt:  [[0.15]]
grads:  [0.00926423]
Stock Position:  0.009264232805261813
Bond Position:  [-19.52826456]


portfolio before change:  [-18.61674146]
curr_Stock_Price:  98.52339409374265
curr_Factors:  [98.52339409]
mat_Sqrt:  [[0.15]]
grads:  [0.00473401]
Stock Position:  0.0047340078905746315
Bond Position:  [-19.08315198]


portfolio before change:  [-18.61951671]
curr_Stock_Price:  98.18910635605732
curr_Factors:  [98.18910636]
mat_Sqrt:  [[0.15]]
grads:  [-0.01603506]
Stock Position:  -0.016035064572408483
Bond Position:  [-17.04504805]


portfolio before change:  [-18.63381344]
curr_Stock_Price:  99.01425904409214
curr_Factors:  [99.01425904]
mat_Sqrt:  [[0.15]]
grads:  [0.06646202]
Stock Position:  0.06646202420160816
Bond Position:  [-25.21450152]


portfolio before change:  [-18.62725838]
curr_Stock_Price:  99.13659979114728
curr_Factors:  [99.13659979]
mat_Sqrt:  [[0.15]]
grads:  [0.11067867]
Stock Position:  0.11067867278673454
Bond Position:  [-29.59956567]


portfolio before change:  [-18.48447092]
curr_Stock_Price:  100.44342328903247
curr_Factors:  [100.44342329]
mat_Sqrt:  [[0.15]]
grads:  [-0.09783203]
Stock Position:  -0.09783202981806355
Bond Position:  [-8.65788694]


portfolio before change:  [-18.46695651]
curr_Stock_Price:  100.25886672012331
curr_Factors:  [100.25886672]
mat_Sqrt:  [[0.15]]
grads:  [0.13053662]
Stock Position:  0.13053661702947056
Bond Position:  [-31.5544098]


portfolio before change:  [-18.45833989]
curr_Stock_Price:  100.3399844520144
curr_Factors:  [100.33998445]
mat_Sqrt:  [[0.15]]
grads:  [0.01648492]
Stock Position:  0.0164849159652466
Bond Position:  [-20.1124361]


portfolio before change:  [-18.46076004]
curr_Stock_Price:  100.2694300064671
curr_Factors:  [100.26943001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02857464]
Stock Position:  -0.028574636661198954
Bond Position:  [-15.59559751]


portfolio before change:  [-18.44319804]
curr_Stock_Price:  99.62071634894953
curr_Factors:  [99.62071635]
mat_Sqrt:  [[0.15]]
grads:  [0.0310321]
Stock Position:  0.03103209704854311
Bond Position:  [-21.53463778]


portfolio before change:  [-18.42843106]
curr_Stock_Price:  100.13995087637416
curr_Factors:  [100.13995088]
mat_Sqrt:  [[0.15]]
grads:  [0.0998537]
Stock Position:  0.09985370148747517
Bond Position:  [-28.42777582]


portfolio before change:  [-18.40769859]
curr_Stock_Price:  100.36537330474162
curr_Factors:  [100.3653733]
mat_Sqrt:  [[0.15]]
grads:  [0.11571066]
Stock Position:  0.11571065799914303
Bond Position:  [-30.02104197]


portfolio before change:  [-18.38606507]
curr_Stock_Price:  100.56855159598881
curr_Factors:  [100.5685516]
mat_Sqrt:  [[0.15]]
grads:  [-0.02357908]
Stock Position:  -0.023579077445858087
Bond Position:  [-16.0147514]


portfolio before change:  [-18.38028781]
curr_Stock_Price:  100.28108423658567
curr_Factors:  [100.28108424]
mat_Sqrt:  [[0.15]]
grads:  [0.03364498]
Stock Position:  0.03364498473672467
Bond Position:  [-21.75424335]


portfolio before change:  [-18.35474362]
curr_Stock_Price:  101.08072392644806
curr_Factors:  [101.08072393]
mat_Sqrt:  [[0.15]]
grads:  [-0.07030642]
Stock Position:  -0.07030642169602665
Bond Position:  [-11.24811962]


portfolio before change:  [-18.35632439]
curr_Stock_Price:  101.09320837193465
curr_Factors:  [101.09320837]
mat_Sqrt:  [[0.15]]
grads:  [0.05240138]
Stock Position:  0.05240138383309018
Bond Position:  [-23.6537484]


portfolio before change:  [-18.35481581]
curr_Stock_Price:  101.15021046215261
curr_Factors:  [101.15021046]
mat_Sqrt:  [[0.15]]
grads:  [0.2264872]
Stock Position:  0.22648719623561525
Bond Position:  [-41.26404337]


portfolio before change:  [-18.43945706]
curr_Stock_Price:  100.78788457713345
curr_Factors:  [100.78788458]
mat_Sqrt:  [[0.15]]
grads:  [0.03453278]
Stock Position:  0.03453278196352117
Bond Position:  [-21.91994311]


portfolio before change:  [-18.4435303]
curr_Stock_Price:  100.70960546636006
curr_Factors:  [100.70960547]
mat_Sqrt:  [[0.15]]
grads:  [-0.04541478]
Stock Position:  -0.04541478422982764
Bond Position:  [-13.8698253]


portfolio before change:  [-18.46552752]
curr_Stock_Price:  101.17487970684742
curr_Factors:  [101.17487971]
mat_Sqrt:  [[0.15]]
grads:  [0.08039383]
Stock Position:  0.08039382548766599
Bond Position:  [-26.59936314]


portfolio before change:  [-18.51807705]
curr_Stock_Price:  100.54190794183829
curr_Factors:  [100.54190794]
mat_Sqrt:  [[0.15]]
grads:  [0.08267872]
Stock Position:  0.08267871808865788
Bond Position:  [-26.83075312]


portfolio before change:  [-18.51622913]
curr_Stock_Price:  100.58454158297592
curr_Factors:  [100.58454158]
mat_Sqrt:  [[0.15]]
grads:  [0.04218736]
Stock Position:  0.04218736479394509
Bond Position:  [-22.75962588]


portfolio before change:  [-18.48759594]
curr_Stock_Price:  101.29697564537794
curr_Factors:  [101.29697565]
mat_Sqrt:  [[0.15]]
grads:  [0.0368249]
Stock Position:  0.03682490029227256
Bond Position:  [-22.21784697]


portfolio before change:  [-18.49579205]
curr_Stock_Price:  101.11211549891243
curr_Factors:  [101.1121155]
mat_Sqrt:  [[0.15]]
grads:  [0.064106]
Stock Position:  0.0641060044383079
Bond Position:  [-24.97768578]


portfolio before change:  [-18.52998508]
curr_Stock_Price:  100.60308560393214
curr_Factors:  [100.6030856]
mat_Sqrt:  [[0.15]]
grads:  [-0.17732177]
Stock Position:  -0.17732176754683357
Bond Position:  [-0.69086812]


portfolio before change:  [-18.49135255]
curr_Stock_Price:  100.38497526409557
curr_Factors:  [100.38497526]
mat_Sqrt:  [[0.15]]
grads:  [0.0177151]
Stock Position:  0.01771510055393251
Bond Position:  [-20.26968248]


portfolio before change:  [-18.501094]
curr_Stock_Price:  99.90659501068059
curr_Factors:  [99.90659501]
mat_Sqrt:  [[0.15]]
grads:  [-0.38111163]
Stock Position:  -0.38111162645259333
Bond Position:  [19.57447092]


portfolio before change:  [-18.47276444]
curr_Stock_Price:  99.8354711931335
curr_Factors:  [99.83547119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03282349]
Stock Position:  -0.032823488622553756
Bond Position:  [-15.19581599]


portfolio before change:  [-18.46363732]
curr_Stock_Price:  99.52846875489962
curr_Factors:  [99.52846875]
mat_Sqrt:  [[0.15]]
grads:  [0.04804442]
Stock Position:  0.04804441766530168
Bond Position:  [-23.24542464]


portfolio before change:  [-18.4615051]
curr_Stock_Price:  99.60308933566459
curr_Factors:  [99.60308934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00919765]
Stock Position:  -0.009197645524630604
Bond Position:  [-17.54539119]


portfolio before change:  [-18.45973932]
curr_Stock_Price:  99.29187857388935
curr_Factors:  [99.29187857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304122]
Stock Position:  -0.013041219833275896
Bond Position:  [-17.1648521]


portfolio before change:  [-18.46157381]
curr_Stock_Price:  99.35028203660671
curr_Factors:  [99.35028204]
mat_Sqrt:  [[0.15]]
grads:  [-0.01084415]
Stock Position:  -0.010844152507141712
Bond Position:  [-17.3842042]


portfolio before change:  [-18.45789672]
curr_Stock_Price:  98.91100079554205
curr_Factors:  [98.9110008]
mat_Sqrt:  [[0.15]]
grads:  [0.05612407]
Stock Position:  0.05612406548066183
Bond Position:  [-24.00918421]


portfolio before change:  [-18.47623315]
curr_Stock_Price:  98.61102595589217
curr_Factors:  [98.61102596]
mat_Sqrt:  [[0.15]]
grads:  [0.099606]
Stock Position:  0.09960599569980992
Bond Position:  [-28.29848258]


portfolio before change:  [-18.53448516]
curr_Stock_Price:  98.0439586677007
curr_Factors:  [98.04395867]
mat_Sqrt:  [[0.15]]
grads:  [0.06869161]
Stock Position:  0.0686916118503059
Bond Position:  [-25.26928271]


portfolio before change:  [-18.52953227]
curr_Stock_Price:  98.13905429836068
curr_Factors:  [98.1390543]
mat_Sqrt:  [[0.15]]
grads:  [0.0350877]
Stock Position:  0.03508770366309458
Bond Position:  [-21.97300632]


portfolio before change:  [-18.52973959]
curr_Stock_Price:  98.17228639193165
curr_Factors:  [98.17228639]
mat_Sqrt:  [[0.15]]
grads:  [-0.02190017]
Stock Position:  -0.021900167777970866
Bond Position:  [-16.37975004]


portfolio before change:  [-18.53338378]
curr_Stock_Price:  98.29193969744634
curr_Factors:  [98.2919397]
mat_Sqrt:  [[0.15]]
grads:  [-0.00783113]
Stock Position:  -0.007831127003453009
Bond Position:  [-17.76364712]


portfolio before change:  [-18.53803152]
curr_Stock_Price:  98.74365950351307
curr_Factors:  [98.7436595]
mat_Sqrt:  [[0.15]]
grads:  [-0.0462791]
Stock Position:  -0.046279098468092056
Bond Position:  [-13.96826398]


portfolio before change:  [-18.52068298]
curr_Stock_Price:  98.34992700807132
curr_Factors:  [98.34992701]
mat_Sqrt:  [[0.15]]
grads:  [0.00965852]
Stock Position:  0.009658519273330312
Bond Position:  [-19.47059764]


portfolio before change:  [-18.51940726]
curr_Stock_Price:  98.60800655194669
curr_Factors:  [98.60800655]
mat_Sqrt:  [[0.15]]
grads:  [0.00886946]
Stock Position:  0.00886945780871442
Bond Position:  [-19.39400681]


portfolio before change:  [-18.52327165]
curr_Stock_Price:  98.30897697837504
curr_Factors:  [98.30897698]
mat_Sqrt:  [[0.15]]
grads:  [0.05235227]
Stock Position:  0.0523522697114952
Bond Position:  [-23.66996973]


portfolio before change:  [-18.51060002]
curr_Stock_Price:  98.57928154317297
curr_Factors:  [98.57928154]
mat_Sqrt:  [[0.15]]
grads:  [-0.05172084]
Stock Position:  -0.05172083545886968
Bond Position:  [-13.41199722]


portfolio before change:  [-18.48130405]
curr_Stock_Price:  97.99664903709814
curr_Factors:  [97.99664904]
mat_Sqrt:  [[0.15]]
grads:  [-0.0304732]
Stock Position:  -0.03047319583538306
Bond Position:  [-15.49503297]


portfolio before change:  [-18.49936961]
curr_Stock_Price:  98.55770232900069
curr_Factors:  [98.55770233]
mat_Sqrt:  [[0.15]]
grads:  [0.00234601]
Stock Position:  0.0023460099913564752
Bond Position:  [-18.73058696]


portfolio before change:  [-18.50008609]
curr_Stock_Price:  98.75131352009491
curr_Factors:  [98.75131352]
mat_Sqrt:  [[0.15]]
grads:  [0.06217447]
Stock Position:  0.06217447424960569
Bond Position:  [-24.63989709]


portfolio before change:  [-18.50153671]
curr_Stock_Price:  98.75275184547384
curr_Factors:  [98.75275185]
mat_Sqrt:  [[0.15]]
grads:  [0.0498965]
Stock Position:  0.04989650417825626
Bond Position:  [-23.4289538]


portfolio before change:  [-18.51002893]
curr_Stock_Price:  98.61190300340196
curr_Factors:  [98.611903]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623144]
Stock Position:  -0.026231442584489246
Bond Position:  [-15.92329646]


portfolio before change:  [-18.51168744]
curr_Stock_Price:  98.63718855006009
curr_Factors:  [98.63718855]
mat_Sqrt:  [[0.15]]
grads:  [-0.01643731]
Stock Position:  -0.01643731084281647
Bond Position:  [-16.89035731]


portfolio before change:  [-18.50421224]
curr_Stock_Price:  98.11819367072688
curr_Factors:  [98.11819367]
mat_Sqrt:  [[0.15]]
grads:  [0.00179366]
Stock Position:  0.001793662741343243
Bond Position:  [-18.68020319]


portfolio before change:  [-18.50449207]
curr_Stock_Price:  98.61311336507312
curr_Factors:  [98.61311337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04078607]
Stock Position:  -0.04078607363725977
Bond Position:  [-14.48245037]


portfolio before change:  [-18.50069901]
curr_Stock_Price:  98.49792113957588
curr_Factors:  [98.49792114]
mat_Sqrt:  [[0.15]]
grads:  [0.0136291]
Stock Position:  0.013629098291316625
Bond Position:  [-19.84313686]


portfolio before change:  [-18.51608172]
curr_Stock_Price:  97.46025363138094
curr_Factors:  [97.46025363]
mat_Sqrt:  [[0.15]]
grads:  [0.12884809]
Stock Position:  0.12884808816476034
Bond Position:  [-31.07364907]


portfolio before change:  [-18.53972808]
curr_Stock_Price:  97.29180566677431
curr_Factors:  [97.29180567]
mat_Sqrt:  [[0.15]]
grads:  [0.02794639]
Stock Position:  0.027946387084044517
Bond Position:  [-21.25868255]


portfolio before change:  [-18.53645007]
curr_Stock_Price:  97.45664701560601
curr_Factors:  [97.45664702]
mat_Sqrt:  [[0.15]]
grads:  [0.08443729]
Stock Position:  0.08443728564870806
Bond Position:  [-26.76542482]


portfolio before change:  [-18.56731298]
curr_Stock_Price:  97.11094641725707
curr_Factors:  [97.11094642]
mat_Sqrt:  [[0.15]]
grads:  [-0.010589]
Stock Position:  -0.010588999794730124
Bond Position:  [-17.53900519]


portfolio before change:  [-18.56430817]
curr_Stock_Price:  96.7236539853997
curr_Factors:  [96.72365399]
mat_Sqrt:  [[0.15]]
grads:  [0.03244674]
Stock Position:  0.03244673688399818
Bond Position:  [-21.70267512]


portfolio before change:  [-18.57967028]
curr_Stock_Price:  96.29200344710097
curr_Factors:  [96.29200345]
mat_Sqrt:  [[0.15]]
grads:  [0.16430547]
Stock Position:  0.16430546807608185
Bond Position:  [-34.40097298]


portfolio before change:  [-18.49259992]
curr_Stock_Price:  96.83501936491056
curr_Factors:  [96.83501936]
mat_Sqrt:  [[0.15]]
grads:  [0.02253243]
Stock Position:  0.022532428542386206
Bond Position:  [-20.67452808]


portfolio before change:  [-18.50000701]
curr_Stock_Price:  96.56363751234431
curr_Factors:  [96.56363751]
mat_Sqrt:  [[0.15]]
grads:  [-0.1028157]
Stock Position:  -0.10281570375546151
Bond Position:  [-8.57174866]


portfolio before change:  [-18.4746991]
curr_Stock_Price:  96.31227836741765
curr_Factors:  [96.31227837]
mat_Sqrt:  [[0.15]]
grads:  [-0.03927227]
Stock Position:  -0.0392722660854464
Bond Position:  [-14.69229767]


portfolio before change:  [-18.47676033]
curr_Stock_Price:  96.34138133150117
curr_Factors:  [96.34138133]
mat_Sqrt:  [[0.15]]
grads:  [0.0132015]
Stock Position:  0.01320150247022902
Bond Position:  [-19.74861132]


portfolio before change:  [-18.47586914]
curr_Stock_Price:  96.50238710819092
curr_Factors:  [96.50238711]
mat_Sqrt:  [[0.15]]
grads:  [0.06708423]
Stock Position:  0.06708423361887378
Bond Position:  [-24.94965782]


portfolio before change:  [-18.49053146]
curr_Stock_Price:  96.30706676414583
curr_Factors:  [96.30706676]
mat_Sqrt:  [[0.15]]
grads:  [0.02378646]
Stock Position:  0.02378645950957876
Bond Position:  [-20.7813356]


portfolio before change:  [-18.50367119]
curr_Stock_Price:  95.80926845044647
curr_Factors:  [95.80926845]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675444]
Stock Position:  -0.006754439301779973
Bond Position:  [-17.8565333]


portfolio before change:  [-18.5067352]
curr_Stock_Price:  96.09766224864161
curr_Factors:  [96.09766225]
mat_Sqrt:  [[0.15]]
grads:  [-0.09598229]
Stock Position:  -0.0959822912334622
Bond Position:  [-9.28306139]


portfolio before change:  [-18.5719842]
curr_Stock_Price:  96.77141982029555
curr_Factors:  [96.77141982]
mat_Sqrt:  [[0.15]]
grads:  [-0.15896563]
Stock Position:  -0.15896562986111695
Bond Position:  [-3.1886545]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.64209661]
Stock Price:  97.21121997417407
PL:  [-18.64209661]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.36626547e-02]
 [-1.37278015e-02]
 [ 5.12395448e-02]
 [-1.20039399e-02]
 [ 1.07299622e-02]
 [-1.69331568e-02]
 [-1.35640886e-02]
 [ 8.69098525e-02]
 [-2.11715550e-02]
 [-1.32690195e-02]
 [-1.24949312e-02]
 [-2.36837335e-03]
 [-1.15712622e-03]
 [-9.86002889e-03]
 [ 1.17938782e-02]
 [ 1.22693417e-03]
 [-2.00578719e-02]
 [-1.10514302e-02]
 [ 2.35852796e-02]
 [-2.75108544e-03]
 [-1.19353929e-02]
 [ 5.82389417e-03]
 [ 1.27994776e-02]
 [ 1.90539579e-02]
 [-3.80466132e-03]
 [ 4.47410151e-03]
 [ 1.07933186e-02]
 [ 8.99366529e-03]
 [ 1.56953548e-02]
 [ 2.78615030e-03]
 [-6.44607935e-03]
 [ 1.00685807e-02]
 [ 1.16381159e-02]
 [-1.16832100e-03]
 [ 7.06636281e-03]
 [ 1.20806789e-02]
 [-2.67846641e-02]
 [ 1.42442866e-03]
 [-4.78732297e-02]
 [-1.34763789e-02]
 [ 4.03201908e-03]
 [ 9.35614195e-03]
 [-8.25867037e-03]
 [-1.52072977e-03]
 [ 9.36877707e-03]
 [ 1.34367028e-02]
 [ 1.06265152e-02]
 [ 7.73052689e-04]
 [ 1.36036072e-02]
 [-1.26041279e-03]
 [ 2.07110022e-02]
 [-1.68991344e-02]
 [ 2.13861132e-03]
 [ 1.26107728e-03]
 [-3.66882971e-03]
 [-3.86172678e-03]
 [ 7.46506336e-03]
 [ 2.28139007e-03]
 [ 7.06560956e-03]
 [-4.02921395e-03]
 [-1.20697870e-03]
 [ 6.77782465e-03]
 [-9.40917847e-03]
 [ 7.48793826e-03]
 [ 2.51753663e-02]
 [ 5.50893697e-03]
 [ 1.01671803e-02]
 [ 1.87655292e-03]
 [ 2.61871178e-03]
 [ 1.98882140e-02]
 [ 7.24916354e-04]
 [-1.55858458e-02]
 [-3.44464049e-05]
 [ 1.25030222e-03]
 [ 3.05262985e-03]
 [-1.44001206e-02]
 [-4.19320778e-03]
 [ 1.64154544e-02]
 [-9.36375491e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.0139623]
curr_Stock_Price:  99.6346637348987
curr_Factors:  [99.63466373]
mat_Sqrt:  [[0.15]]
grads:  [-0.09108436]
Stock Position:  -0.09108436456571894
Bond Position:  [3.06119774]


portfolio before change:  [-5.97064512]
curr_Stock_Price:  99.16119227176614
curr_Factors:  [99.16119227]
mat_Sqrt:  [[0.15]]
grads:  [-0.09151868]
Stock Position:  -0.09151867683080904
Bond Position:  [3.10445599]


portfolio before change:  [-5.89589325]
curr_Stock_Price:  98.34651879834173
curr_Factors:  [98.3465188]
mat_Sqrt:  [[0.15]]
grads:  [0.34159697]
Stock Position:  0.34159696564192177
Bond Position:  [-39.49076565]


portfolio before change:  [-5.90812102]
curr_Stock_Price:  98.31794852383604
curr_Factors:  [98.31794852]
mat_Sqrt:  [[0.15]]
grads:  [-0.08002627]
Stock Position:  -0.0800262661846035
Bond Position:  [1.9598973]


portfolio before change:  [-5.84794981]
curr_Stock_Price:  97.56758598466858
curr_Factors:  [97.56758598]
mat_Sqrt:  [[0.15]]
grads:  [0.07153308]
Stock Position:  0.07153308165390074
Bond Position:  [-12.8272599]


portfolio before change:  [-5.84357494]
curr_Stock_Price:  97.63995240548059
curr_Factors:  [97.63995241]
mat_Sqrt:  [[0.15]]
grads:  [-0.11288771]
Stock Position:  -0.11288771189173041
Bond Position:  [5.17877587]


portfolio before change:  [-5.87570062]
curr_Stock_Price:  97.92740054343066
curr_Factors:  [97.92740054]
mat_Sqrt:  [[0.15]]
grads:  [-0.09042726]
Stock Position:  -0.09042725733952385
Bond Position:  [2.97960563]


portfolio before change:  [-5.76746788]
curr_Stock_Price:  96.73255606647636
curr_Factors:  [96.73255607]
mat_Sqrt:  [[0.15]]
grads:  [0.57939902]
Stock Position:  0.5793990165763278
Bond Position:  [-61.81421574]


portfolio before change:  [-6.00359965]
curr_Stock_Price:  96.33167816481203
curr_Factors:  [96.33167816]
mat_Sqrt:  [[0.15]]
grads:  [-0.1411437]
Stock Position:  -0.1411436997447757
Bond Position:  [7.59300981]


portfolio before change:  [-5.9568265]
curr_Stock_Price:  96.00365375836765
curr_Factors:  [96.00365376]
mat_Sqrt:  [[0.15]]
grads:  [-0.08846013]
Stock Position:  -0.08846012998711955
Bond Position:  [2.53566919]


portfolio before change:  [-5.96592758]
curr_Stock_Price:  96.10832880670932
curr_Factors:  [96.10832881]
mat_Sqrt:  [[0.15]]
grads:  [-0.08329954]
Stock Position:  -0.08329954117503749
Bond Position:  [2.03985211]


portfolio before change:  [-5.93493634]
curr_Stock_Price:  95.73781359037949
curr_Factors:  [95.73781359]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578916]
Stock Position:  -0.01578915568270649
Bond Position:  [-4.42331709]


portfolio before change:  [-5.93679515]
curr_Stock_Price:  95.8380307144914
curr_Factors:  [95.83803071]
mat_Sqrt:  [[0.15]]
grads:  [-0.00771417]
Stock Position:  -0.007714174795942821
Bond Position:  [-5.19748383]


portfolio before change:  [-5.94156584]
curr_Stock_Price:  96.41435106087604
curr_Factors:  [96.41435106]
mat_Sqrt:  [[0.15]]
grads:  [-0.06573353]
Stock Position:  -0.06573352590533321
Bond Position:  [0.39608941]


portfolio before change:  [-5.91832052]
curr_Stock_Price:  96.06109820274051
curr_Factors:  [96.0610982]
mat_Sqrt:  [[0.15]]
grads:  [0.07862585]
Stock Position:  0.07862585498753637
Bond Position:  [-13.4712065]


portfolio before change:  [-5.86437323]
curr_Stock_Price:  96.75793351080097
curr_Factors:  [96.75793351]
mat_Sqrt:  [[0.15]]
grads:  [0.00817956]
Stock Position:  0.008179561151566856
Bond Position:  [-6.65581066]


portfolio before change:  [-5.85598538]
curr_Stock_Price:  97.83425611743351
curr_Factors:  [97.83425612]
mat_Sqrt:  [[0.15]]
grads:  [-0.13371915]
Stock Position:  -0.13371914605683752
Bond Position:  [7.2263278]


portfolio before change:  [-5.75382016]
curr_Stock_Price:  97.0736054052804
curr_Factors:  [97.07360541]
mat_Sqrt:  [[0.15]]
grads:  [-0.0736762]
Stock Position:  -0.07367620161307309
Bond Position:  [1.39819436]


portfolio before change:  [-5.72345442]
curr_Stock_Price:  96.66264031362954
curr_Factors:  [96.66264031]
mat_Sqrt:  [[0.15]]
grads:  [0.1572352]
Stock Position:  0.15723519711605027
Bond Position:  [-20.92222373]


portfolio before change:  [-5.60407342]
curr_Stock_Price:  97.4302081643724
curr_Factors:  [97.43020816]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834057]
Stock Position:  -0.018340569627935944
Bond Position:  [-3.8171479]


portfolio before change:  [-5.61079569]
curr_Stock_Price:  97.78372419398677
curr_Factors:  [97.78372419]
mat_Sqrt:  [[0.15]]
grads:  [-0.07956929]
Stock Position:  -0.07956928570007354
Bond Position:  [2.1697854]


portfolio before change:  [-5.5299091]
curr_Stock_Price:  96.76887319743993
curr_Factors:  [96.7688732]
mat_Sqrt:  [[0.15]]
grads:  [0.03882596]
Stock Position:  0.03882596113339808
Bond Position:  [-9.28705361]


portfolio before change:  [-5.51691294]
curr_Stock_Price:  97.11855203132961
curr_Factors:  [97.11855203]
mat_Sqrt:  [[0.15]]
grads:  [0.08532985]
Stock Position:  0.08532985051829385
Bond Position:  [-13.80402447]


portfolio before change:  [-5.50897344]
curr_Stock_Price:  97.22170799624628
curr_Factors:  [97.221708]
mat_Sqrt:  [[0.15]]
grads:  [0.12702639]
Stock Position:  0.12702638586699824
Bond Position:  [-17.85869563]


portfolio before change:  [-5.36882002]
curr_Stock_Price:  98.33383613643004
curr_Factors:  [98.33383614]
mat_Sqrt:  [[0.15]]
grads:  [-0.02536441]
Stock Position:  -0.025364408779859564
Bond Position:  [-2.87464041]


portfolio before change:  [-5.36328773]
curr_Stock_Price:  98.10863992387804
curr_Factors:  [98.10863992]
mat_Sqrt:  [[0.15]]
grads:  [0.02982734]
Stock Position:  0.02982734342892588
Bond Position:  [-8.28960782]


portfolio before change:  [-5.34529736]
curr_Stock_Price:  98.72916067322616
curr_Factors:  [98.72916067]
mat_Sqrt:  [[0.15]]
grads:  [0.07195546]
Stock Position:  0.07195545727324891
Bond Position:  [-12.44939926]


portfolio before change:  [-5.3899614]
curr_Stock_Price:  98.11925648182235
curr_Factors:  [98.11925648]
mat_Sqrt:  [[0.15]]
grads:  [0.05995777]
Stock Position:  0.05995776859810356
Bond Position:  [-11.27297308]


portfolio before change:  [-5.35119873]
curr_Stock_Price:  98.77750748507341
curr_Factors:  [98.77750749]
mat_Sqrt:  [[0.15]]
grads:  [0.1046357]
Stock Position:  0.1046356987742283
Bond Position:  [-15.68685224]


portfolio before change:  [-5.35460712]
curr_Stock_Price:  98.75430376080911
curr_Factors:  [98.75430376]
mat_Sqrt:  [[0.15]]
grads:  [0.01857434]
Stock Position:  0.018574335355670754
Bond Position:  [-7.18890268]


portfolio before change:  [-5.35313405]
curr_Stock_Price:  98.857800935928
curr_Factors:  [98.85780094]
mat_Sqrt:  [[0.15]]
grads:  [-0.04297386]
Stock Position:  -0.042973862363352745
Bond Position:  [-1.10483252]


portfolio before change:  [-5.36600533]
curr_Stock_Price:  99.15570807347632
curr_Factors:  [99.15570807]
mat_Sqrt:  [[0.15]]
grads:  [0.06712387]
Stock Position:  0.06712387105189271
Bond Position:  [-12.02172029]


portfolio before change:  [-5.36118814]
curr_Stock_Price:  99.23866763789827
curr_Factors:  [99.23866764]
mat_Sqrt:  [[0.15]]
grads:  [0.07758744]
Stock Position:  0.07758743917302702
Bond Position:  [-13.06086223]


portfolio before change:  [-5.29200043]
curr_Stock_Price:  100.1409276394412
curr_Factors:  [100.14092764]
mat_Sqrt:  [[0.15]]
grads:  [-0.00778881]
Stock Position:  -0.0077888066653127724
Bond Position:  [-4.5120221]


portfolio before change:  [-5.29125217]
curr_Stock_Price:  100.00865263093478
curr_Factors:  [100.00865263]
mat_Sqrt:  [[0.15]]
grads:  [0.04710909]
Stock Position:  0.047109085429900305
Bond Position:  [-10.00256833]


portfolio before change:  [-5.2670486]
curr_Stock_Price:  100.53570064533714
curr_Factors:  [100.53570065]
mat_Sqrt:  [[0.15]]
grads:  [0.08053786]
Stock Position:  0.08053785938519055
Bond Position:  [-13.36397872]


portfolio before change:  [-5.26031153]
curr_Stock_Price:  100.62972280636721
curr_Factors:  [100.62972281]
mat_Sqrt:  [[0.15]]
grads:  [-0.17856443]
Stock Position:  -0.17856442723401456
Bond Position:  [12.70857728]


portfolio before change:  [-5.42525916]
curr_Stock_Price:  101.55791402346145
curr_Factors:  [101.55791402]
mat_Sqrt:  [[0.15]]
grads:  [0.00949619]
Stock Position:  0.009496191077524672
Bond Position:  [-6.38967251]


portfolio before change:  [-5.42890824]
curr_Stock_Price:  101.21570120562234
curr_Factors:  [101.21570121]
mat_Sqrt:  [[0.15]]
grads:  [-0.31915486]
Stock Position:  -0.3191548646344038
Bond Position:  [26.87457518]


portfolio before change:  [-5.80367397]
curr_Stock_Price:  102.39520834405344
curr_Factors:  [102.39520834]
mat_Sqrt:  [[0.15]]
grads:  [-0.08984253]
Stock Position:  -0.08984252574746099
Bond Position:  [3.39577017]


portfolio before change:  [-5.81465684]
curr_Stock_Price:  102.51981654069029
curr_Factors:  [102.51981654]
mat_Sqrt:  [[0.15]]
grads:  [0.02688013]
Stock Position:  0.026880127170895066
Bond Position:  [-8.57040255]


portfolio before change:  [-5.79693395]
curr_Stock_Price:  103.19907530900095
curr_Factors:  [103.19907531]
mat_Sqrt:  [[0.15]]
grads:  [0.06237428]
Stock Position:  0.06237427965495751
Bond Position:  [-12.23390193]


portfolio before change:  [-5.8170946]
curr_Stock_Price:  102.88811365928794
curr_Factors:  [102.88811366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0550578]
Stock Position:  -0.05505780245439908
Bond Position:  [-0.15230116]


portfolio before change:  [-5.7891057]
curr_Stock_Price:  102.37958594298942
curr_Factors:  [102.37958594]
mat_Sqrt:  [[0.15]]
grads:  [-0.0101382]
Stock Position:  -0.010138198496722591
Bond Position:  [-4.75116113]


portfolio before change:  [-5.79077996]
curr_Stock_Price:  102.51543867092177
curr_Factors:  [102.51543867]
mat_Sqrt:  [[0.15]]
grads:  [0.06245851]
Stock Position:  0.062458513807990605
Bond Position:  [-12.1937419]


portfolio before change:  [-5.85617535]
curr_Stock_Price:  101.48061955051814
curr_Factors:  [101.48061955]
mat_Sqrt:  [[0.15]]
grads:  [0.08957802]
Stock Position:  0.08957801871441341
Bond Position:  [-14.94660819]


portfolio before change:  [-5.81722987]
curr_Stock_Price:  101.92581442292357
curr_Factors:  [101.92581442]
mat_Sqrt:  [[0.15]]
grads:  [0.07084343]
Stock Position:  0.07084343455228553
Bond Position:  [-13.03800463]


portfolio before change:  [-5.82061217]
curr_Stock_Price:  101.8895739600307
curr_Factors:  [101.88957396]
mat_Sqrt:  [[0.15]]
grads:  [0.00515368]
Stock Position:  0.00515368459304443
Bond Position:  [-6.3457189]


portfolio before change:  [-5.82302508]
curr_Stock_Price:  101.49834164893947
curr_Factors:  [101.49834165]
mat_Sqrt:  [[0.15]]
grads:  [0.09069071]
Stock Position:  0.09069071455355074
Bond Position:  [-15.02798221]


portfolio before change:  [-5.8386761]
curr_Stock_Price:  101.33612283376729
curr_Factors:  [101.33612283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00840275]
Stock Position:  -0.00840275196352387
Bond Position:  [-4.98717379]


portfolio before change:  [-5.84734338]
curr_Stock_Price:  102.33050846856592
curr_Factors:  [102.33050847]
mat_Sqrt:  [[0.15]]
grads:  [0.13807335]
Stock Position:  0.13807334820685957
Bond Position:  [-19.97645931]


portfolio before change:  [-5.99099943]
curr_Stock_Price:  101.29911839257731
curr_Factors:  [101.29911839]
mat_Sqrt:  [[0.15]]
grads:  [-0.1126609]
Stock Position:  -0.11266089619890836
Bond Position:  [5.42145003]


portfolio before change:  [-5.89952278]
curr_Stock_Price:  100.4901615584756
curr_Factors:  [100.49016156]
mat_Sqrt:  [[0.15]]
grads:  [0.01425741]
Stock Position:  0.014257408800204999
Bond Position:  [-7.33225209]


portfolio before change:  [-5.88997601]
curr_Stock_Price:  101.1919053121036
curr_Factors:  [101.19190531]
mat_Sqrt:  [[0.15]]
grads:  [0.00840718]
Stock Position:  0.008407181883083235
Bond Position:  [-6.74071476]


portfolio before change:  [-5.89138693]
curr_Stock_Price:  101.07419492304318
curr_Factors:  [101.07419492]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445886]
Stock Position:  -0.02445886473296384
Bond Position:  [-3.41922687]


portfolio before change:  [-5.87971221]
curr_Stock_Price:  100.58813703904043
curr_Factors:  [100.58813704]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574485]
Stock Position:  -0.025744845214122736
Bond Position:  [-3.2900862]


portfolio before change:  [-5.87606666]
curr_Stock_Price:  100.43854612447335
curr_Factors:  [100.43854612]
mat_Sqrt:  [[0.15]]
grads:  [0.04976709]
Stock Position:  0.04976708906422177
Bond Position:  [-10.87460073]


portfolio before change:  [-5.88173021]
curr_Stock_Price:  100.33840228194235
curr_Factors:  [100.33840228]
mat_Sqrt:  [[0.15]]
grads:  [0.01520927]
Stock Position:  0.015209267152607002
Bond Position:  [-7.40780377]


portfolio before change:  [-5.88473793]
curr_Stock_Price:  100.171088230957
curr_Factors:  [100.17108823]
mat_Sqrt:  [[0.15]]
grads:  [0.04710406]
Stock Position:  0.04710406372833578
Bond Position:  [-10.60320326]


portfolio before change:  [-5.87459359]
curr_Stock_Price:  100.40051774822494
curr_Factors:  [100.40051775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02686143]
Stock Position:  -0.02686142634255405
Bond Position:  [-3.17769248]


portfolio before change:  [-5.88924971]
curr_Stock_Price:  100.93874313581802
curr_Factors:  [100.93874314]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804652]
Stock Position:  -0.008046524639126208
Bond Position:  [-5.07704362]


portfolio before change:  [-5.88948202]
curr_Stock_Price:  100.92817804045744
curr_Factors:  [100.92817804]
mat_Sqrt:  [[0.15]]
grads:  [0.0451855]
Stock Position:  0.0451854976439445
Bond Position:  [-10.44997197]


portfolio before change:  [-5.89402098]
curr_Stock_Price:  100.84218094943006
curr_Factors:  [100.84218095]
mat_Sqrt:  [[0.15]]
grads:  [-0.06272786]
Stock Position:  -0.06272785643987379
Bond Position:  [0.43159287]


portfolio before change:  [-5.84940115]
curr_Stock_Price:  100.13128687424665
curr_Factors:  [100.13128687]
mat_Sqrt:  [[0.15]]
grads:  [0.04991959]
Stock Position:  0.04991958839757726
Bond Position:  [-10.84791377]


portfolio before change:  [-5.81889626]
curr_Stock_Price:  100.7559495291638
curr_Factors:  [100.75594953]
mat_Sqrt:  [[0.15]]
grads:  [0.16783578]
Stock Position:  0.167835775473467
Bond Position:  [-22.72934918]


portfolio before change:  [-5.75037176]
curr_Stock_Price:  101.17269695772114
curr_Factors:  [101.17269696]
mat_Sqrt:  [[0.15]]
grads:  [0.03672625]
Stock Position:  0.03672624645348701
Bond Position:  [-9.46606516]


portfolio before change:  [-5.76037822]
curr_Stock_Price:  100.91634582895189
curr_Factors:  [100.91634583]
mat_Sqrt:  [[0.15]]
grads:  [0.0677812]
Stock Position:  0.06778120178359319
Bond Position:  [-12.60060942]


portfolio before change:  [-5.74225426]
curr_Stock_Price:  101.1953542164171
curr_Factors:  [101.19535422]
mat_Sqrt:  [[0.15]]
grads:  [0.01251035]
Stock Position:  0.012510352813317287
Bond Position:  [-7.00824385]


portfolio before change:  [-5.74852771]
curr_Stock_Price:  100.72890688387012
curr_Factors:  [100.72890688]
mat_Sqrt:  [[0.15]]
grads:  [0.01745808]
Stock Position:  0.01745807851529607
Bond Position:  [-7.50706088]


portfolio before change:  [-5.73639086]
curr_Stock_Price:  101.45098303537883
curr_Factors:  [101.45098304]
mat_Sqrt:  [[0.15]]
grads:  [0.13258809]
Stock Position:  0.1325880935669951
Bond Position:  [-19.18758329]


portfolio before change:  [-5.57183495]
curr_Stock_Price:  102.70113427451734
curr_Factors:  [102.70113427]
mat_Sqrt:  [[0.15]]
grads:  [0.00483278]
Stock Position:  0.004832775694083586
Bond Position:  [-6.06816649]


portfolio before change:  [-5.57499787]
curr_Stock_Price:  102.12514053437079
curr_Factors:  [102.12514053]
mat_Sqrt:  [[0.15]]
grads:  [-0.10390564]
Stock Position:  -0.10390563862660014
Bond Position:  [5.03638008]


portfolio before change:  [-5.53317907]
curr_Stock_Price:  101.72570101712466
curr_Factors:  [101.72570102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00022964]
Stock Position:  -0.0002296426995245654
Bond Position:  [-5.5098185]


portfolio before change:  [-5.53366489]
curr_Stock_Price:  102.34164233692066
curr_Factors:  [102.34164234]
mat_Sqrt:  [[0.15]]
grads:  [0.00833535]
Stock Position:  0.00833534815416985
Bond Position:  [-6.38671811]


portfolio before change:  [-5.53426896]
curr_Stock_Price:  102.31706122100452
curr_Factors:  [102.31706122]
mat_Sqrt:  [[0.15]]
grads:  [0.02035087]
Stock Position:  0.02035086569532195
Bond Position:  [-7.61650973]


portfolio before change:  [-5.53696413]
curr_Stock_Price:  102.20801816317957
curr_Factors:  [102.20801816]
mat_Sqrt:  [[0.15]]
grads:  [-0.0960008]
Stock Position:  -0.09600080386618133
Bond Position:  [4.27508778]


portfolio before change:  [-5.49657195]
curr_Stock_Price:  101.79005311911675
curr_Factors:  [101.79005312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02795472]
Stock Position:  -0.027954718516516524
Bond Position:  [-2.65105966]


portfolio before change:  [-5.485235]
curr_Stock_Price:  101.37857901704987
curr_Factors:  [101.37857902]
mat_Sqrt:  [[0.15]]
grads:  [0.10943636]
Stock Position:  0.10943636239145717
Bond Position:  [-16.57973791]


portfolio before change:  [-5.47980375]
curr_Stock_Price:  101.43767740882593
curr_Factors:  [101.43767741]
mat_Sqrt:  [[0.15]]
grads:  [-0.06242503]
Stock Position:  -0.06242503272518089
Bond Position:  [0.85244658]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.44807128]
Stock Price:  100.93020161629975
PL:  [-6.3782729]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32840667e-02]
 [ 1.62555692e-02]
 [ 9.96379467e-03]
 [-7.20980824e-03]
 [ 1.20748039e-02]
 [-1.30314572e-02]
 [ 1.76046625e-03]
 [-4.26787159e-04]
 [-1.11715815e-02]
 [-7.52810257e-03]
 [ 1.35608023e-02]
 [-5.60858931e-03]
 [-6.70151365e-04]
 [ 9.77922652e-03]
 [-1.63559409e-03]
 [ 1.60638808e-02]
 [ 7.17631129e-02]
 [-1.19135294e-02]
 [ 2.32794669e-02]
 [-4.71849538e-05]
 [-7.24466719e-03]
 [ 6.62752875e-03]
 [-1.62960522e-03]
 [ 4.87918785e-02]
 [ 6.23205807e-03]
 [ 6.30599513e-03]
 [ 8.62046108e-02]
 [ 3.34787578e-02]
 [ 1.55503549e-03]
 [-7.46003599e-03]
 [ 2.52137636e-03]
 [ 1.46872033e-02]
 [ 1.52549877e-02]
 [-4.56608278e-03]
 [ 4.59537682e-03]
 [ 2.97291774e-03]
 [-1.91888266e-02]
 [-6.81149391e-04]
 [-4.60739663e-02]
 [-1.06271036e-02]
 [ 4.29606100e-03]
 [ 9.81598799e-03]
 [-4.75180332e-03]
 [-4.09690487e-03]
 [ 1.32915707e-02]
 [ 1.45623660e-02]
 [ 1.08758739e-02]
 [ 3.79448043e-03]
 [ 1.36556826e-02]
 [-1.64424359e-03]
 [ 3.15833618e-03]
 [-6.36829427e-03]
 [ 2.11506846e-03]
 [ 3.24977445e-03]
 [-4.34821789e-03]
 [-4.37124035e-03]
 [ 2.12867496e-03]
 [ 1.20604307e-02]
 [ 7.99582546e-03]
 [-3.86277234e-03]
 [-3.61377868e-03]
 [-6.79818287e-04]
 [-4.26595741e-03]
 [-1.91400049e-03]
 [ 1.93501352e-02]
 [ 4.24432147e-03]
 [ 1.15409158e-02]
 [-1.26546793e-03]
 [ 4.40664530e-03]
 [ 2.45120112e-02]
 [ 3.19640529e-03]
 [-1.54372300e-02]
 [-5.81330074e-03]
 [ 1.60432134e-03]
 [ 8.92144549e-03]
 [ 9.10301504e-04]
 [-1.58372491e-03]
 [-5.85076769e-03]
 [-2.28994345e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.45123647]
curr_Stock_Price:  99.523967736919
curr_Factors:  [99.52396774]
mat_Sqrt:  [[0.15]]
grads:  [-0.08856044]
Stock Position:  -0.0885604447803923
Bond Position:  [0.36265038]


portfolio before change:  [-8.5174338]
curr_Stock_Price:  100.27170559271526
curr_Factors:  [100.27170559]
mat_Sqrt:  [[0.15]]
grads:  [0.10837046]
Stock Position:  0.10837046100416088
Bond Position:  [-19.38392476]


portfolio before change:  [-8.5168842]
curr_Stock_Price:  100.28795660267805
curr_Factors:  [100.2879566]
mat_Sqrt:  [[0.15]]
grads:  [0.0664253]
Stock Position:  0.0664252978182677
Bond Position:  [-15.17854158]


portfolio before change:  [-8.51954194]
curr_Stock_Price:  100.26222774622124
curr_Factors:  [100.26222775]
mat_Sqrt:  [[0.15]]
grads:  [-0.04806539]
Stock Position:  -0.04806538825040526
Bond Position:  [-3.70039903]


portfolio before change:  [-8.51910394]
curr_Stock_Price:  100.24830337510761
curr_Factors:  [100.24830338]
mat_Sqrt:  [[0.15]]
grads:  [0.08049869]
Stock Position:  0.08049869290399767
Bond Position:  [-16.58896132]


portfolio before change:  [-8.59248786]
curr_Stock_Price:  99.34956731470287
curr_Factors:  [99.34956731]
mat_Sqrt:  [[0.15]]
grads:  [-0.08687638]
Stock Position:  -0.08687638144107203
Bond Position:  [0.03864305]


portfolio before change:  [-8.6247644]
curr_Stock_Price:  99.72111778621009
curr_Factors:  [99.72111779]
mat_Sqrt:  [[0.15]]
grads:  [0.01173644]
Stock Position:  0.011736441698574386
Bond Position:  [-9.79513549]


portfolio before change:  [-8.62806479]
curr_Stock_Price:  99.49207266069429
curr_Factors:  [99.49207266]
mat_Sqrt:  [[0.15]]
grads:  [-0.00284525]
Stock Position:  -0.002845247728555332
Bond Position:  [-8.3449852]


portfolio before change:  [-8.62888706]
curr_Stock_Price:  99.59775291712114
curr_Factors:  [99.59775292]
mat_Sqrt:  [[0.15]]
grads:  [-0.07447721]
Stock Position:  -0.07447721025402786
Bond Position:  [-1.21112427]


portfolio before change:  [-8.62201612]
curr_Stock_Price:  99.50448101583055
curr_Factors:  [99.50448102]
mat_Sqrt:  [[0.15]]
grads:  [-0.05018735]
Stock Position:  -0.050187350434117664
Bond Position:  [-3.62814987]


portfolio before change:  [-8.61368114]
curr_Stock_Price:  99.33388522198838
curr_Factors:  [99.33388522]
mat_Sqrt:  [[0.15]]
grads:  [0.09040535]
Stock Position:  0.0904053486961741
Bond Position:  [-17.59399567]


portfolio before change:  [-8.59538238]
curr_Stock_Price:  99.54845679499118
curr_Factors:  [99.54845679]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373906]
Stock Position:  -0.03739059537534241
Bond Position:  [-4.87320631]


portfolio before change:  [-8.58281327]
curr_Stock_Price:  99.2041537252912
curr_Factors:  [99.20415373]
mat_Sqrt:  [[0.15]]
grads:  [-0.00446768]
Stock Position:  -0.004467675766473325
Bond Position:  [-8.13960128]


portfolio before change:  [-8.58709944]
curr_Stock_Price:  100.04965675973159
curr_Factors:  [100.04965676]
mat_Sqrt:  [[0.15]]
grads:  [0.06519484]
Stock Position:  0.06519484348559691
Bond Position:  [-15.10982116]


portfolio before change:  [-8.53807138]
curr_Stock_Price:  100.8161661194922
curr_Factors:  [100.81616612]
mat_Sqrt:  [[0.15]]
grads:  [-0.01090396]
Stock Position:  -0.010903960570855555
Bond Position:  [-7.43877588]


portfolio before change:  [-8.54168602]
curr_Stock_Price:  101.10502476226318
curr_Factors:  [101.10502476]
mat_Sqrt:  [[0.15]]
grads:  [0.10709254]
Stock Position:  0.10709253895201858
Bond Position:  [-19.36927982]


portfolio before change:  [-8.49357116]
curr_Stock_Price:  101.56561219640234
curr_Factors:  [101.5656122]
mat_Sqrt:  [[0.15]]
grads:  [0.47842075]
Stock Position:  0.4784207528724986
Bond Position:  [-57.08466781]


portfolio before change:  [-8.15039888]
curr_Stock_Price:  102.29037211793718
curr_Factors:  [102.29037212]
mat_Sqrt:  [[0.15]]
grads:  [-0.07942353]
Stock Position:  -0.07942352919943799
Bond Position:  [-0.02613652]


portfolio before change:  [-8.18079749]
curr_Stock_Price:  102.67309217162516
curr_Factors:  [102.67309217]
mat_Sqrt:  [[0.15]]
grads:  [0.15519645]
Stock Position:  0.15519644600467722
Bond Position:  [-24.11529649]


portfolio before change:  [-8.07730304]
curr_Stock_Price:  103.34966504296412
curr_Factors:  [103.34966504]
mat_Sqrt:  [[0.15]]
grads:  [-0.00031457]
Stock Position:  -0.0003145663584286088
Bond Position:  [-8.04479271]


portfolio before change:  [-8.0778661]
curr_Stock_Price:  103.54119151953935
curr_Factors:  [103.54119152]
mat_Sqrt:  [[0.15]]
grads:  [-0.04829778]
Stock Position:  -0.048297781247344254
Bond Position:  [-3.07705628]


portfolio before change:  [-8.08812583]
curr_Stock_Price:  103.74963615003821
curr_Factors:  [103.74963615]
mat_Sqrt:  [[0.15]]
grads:  [0.04418352]
Stock Position:  0.04418352496720517
Bond Position:  [-12.67215047]


portfolio before change:  [-8.0691063]
curr_Stock_Price:  104.19802875952854
curr_Factors:  [104.19802876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01086403]
Stock Position:  -0.010864034781841402
Bond Position:  [-6.93709529]


portfolio before change:  [-8.06498593]
curr_Stock_Price:  103.77885191280946
curr_Factors:  [103.77885191]
mat_Sqrt:  [[0.15]]
grads:  [0.32527919]
Stock Position:  0.3252791896924136
Bond Position:  [-41.82208679]


portfolio before change:  [-7.81566691]
curr_Stock_Price:  104.553364981931
curr_Factors:  [104.55336498]
mat_Sqrt:  [[0.15]]
grads:  [0.04154705]
Stock Position:  0.041547053777368066
Bond Position:  [-12.15955119]


portfolio before change:  [-7.81712431]
curr_Stock_Price:  104.53657918344408
curr_Factors:  [104.53657918]
mat_Sqrt:  [[0.15]]
grads:  [0.04203997]
Stock Position:  0.042039967559487544
Bond Position:  [-12.2118387]


portfolio before change:  [-7.77826727]
curr_Stock_Price:  105.47902285416366
curr_Factors:  [105.47902285]
mat_Sqrt:  [[0.15]]
grads:  [0.57469741]
Stock Position:  0.5746974055883987
Bond Position:  [-68.39678805]


portfolio before change:  [-8.0406347]
curr_Stock_Price:  105.02993000475166
curr_Factors:  [105.02993]
mat_Sqrt:  [[0.15]]
grads:  [0.22319172]
Stock Position:  0.22319171855135406
Bond Position:  [-31.48244527]


portfolio before change:  [-8.09437741]
curr_Stock_Price:  104.797954570116
curr_Factors:  [104.79795457]
mat_Sqrt:  [[0.15]]
grads:  [0.0103669]
Stock Position:  0.0103669032824142
Bond Position:  [-9.18080767]


portfolio before change:  [-8.11155041]
curr_Stock_Price:  103.19678389899944
curr_Factors:  [103.1967839]
mat_Sqrt:  [[0.15]]
grads:  [-0.04973357]
Stock Position:  -0.049733573250914126
Bond Position:  [-2.9792056]


portfolio before change:  [-8.13685737]
curr_Stock_Price:  103.70189046742584
curr_Factors:  [103.70189047]
mat_Sqrt:  [[0.15]]
grads:  [0.01680918]
Stock Position:  0.016809175734704522
Bond Position:  [-9.88000067]


portfolio before change:  [-8.13916154]
curr_Stock_Price:  103.6015490619691
curr_Factors:  [103.60154906]
mat_Sqrt:  [[0.15]]
grads:  [0.09791469]
Stock Position:  0.09791468837752836
Bond Position:  [-18.28327494]


portfolio before change:  [-8.08986032]
curr_Stock_Price:  104.11673191022825
curr_Factors:  [104.11673191]
mat_Sqrt:  [[0.15]]
grads:  [0.10169992]
Stock Position:  0.10169991830089598
Bond Position:  [-18.67852344]


portfolio before change:  [-8.17153469]
curr_Stock_Price:  103.325119379715
curr_Factors:  [103.32511938]
mat_Sqrt:  [[0.15]]
grads:  [-0.03044055]
Stock Position:  -0.030440551846884364
Bond Position:  [-5.02626104]


portfolio before change:  [-8.18390239]
curr_Stock_Price:  103.72108942362149
curr_Factors:  [103.72108942]
mat_Sqrt:  [[0.15]]
grads:  [0.03063585]
Stock Position:  0.030635845485048042
Bond Position:  [-11.36148566]


portfolio before change:  [-8.19805061]
curr_Stock_Price:  103.28244934569123
curr_Factors:  [103.28244935]
mat_Sqrt:  [[0.15]]
grads:  [0.01981945]
Stock Position:  0.019819451626705033
Bond Position:  [-10.24505212]


portfolio before change:  [-8.20794274]
curr_Stock_Price:  102.81564559599835
curr_Factors:  [102.8156456]
mat_Sqrt:  [[0.15]]
grads:  [-0.12792551]
Stock Position:  -0.12792551051909803
Bond Position:  [4.94480121]


portfolio before change:  [-8.10197691]
curr_Stock_Price:  101.98972138865169
curr_Factors:  [101.98972139]
mat_Sqrt:  [[0.15]]
grads:  [-0.004541]
Stock Position:  -0.004540995938813912
Bond Position:  [-7.638842]


portfolio before change:  [-8.09946506]
curr_Stock_Price:  101.3314326112733
curr_Factors:  [101.33143261]
mat_Sqrt:  [[0.15]]
grads:  [-0.30715978]
Stock Position:  -0.30715977565113584
Bond Position:  [23.02547504]


portfolio before change:  [-8.27763627]
curr_Stock_Price:  101.91617827576074
curr_Factors:  [101.91617828]
mat_Sqrt:  [[0.15]]
grads:  [-0.07084736]
Stock Position:  -0.07084735763998848
Bond Position:  [-1.05714434]


portfolio before change:  [-8.26171151]
curr_Stock_Price:  101.6904700100238
curr_Factors:  [101.69047001]
mat_Sqrt:  [[0.15]]
grads:  [0.02864041]
Stock Position:  0.028640406676924784
Bond Position:  [-11.17416793]


portfolio before change:  [-8.25594187]
curr_Stock_Price:  101.91630668400745
curr_Factors:  [101.91630668]
mat_Sqrt:  [[0.15]]
grads:  [0.06543992]
Stock Position:  0.065439919919371
Bond Position:  [-14.92533681]


portfolio before change:  [-8.27205448]
curr_Stock_Price:  101.68434190322333
curr_Factors:  [101.6843419]
mat_Sqrt:  [[0.15]]
grads:  [-0.03167869]
Stock Position:  -0.031678688782096336
Bond Position:  [-5.05082786]


portfolio before change:  [-8.27303349]
curr_Stock_Price:  101.70528072003319
curr_Factors:  [101.70528072]
mat_Sqrt:  [[0.15]]
grads:  [-0.0273127]
Stock Position:  -0.027312699150960004
Bond Position:  [-5.49518775]


portfolio before change:  [-8.2728348]
curr_Stock_Price:  101.68543098357344
curr_Factors:  [101.68543098]
mat_Sqrt:  [[0.15]]
grads:  [0.08861047]
Stock Position:  0.08861047124550733
Bond Position:  [-17.28322875]


portfolio before change:  [-8.36137406]
curr_Stock_Price:  100.69842539584384
curr_Factors:  [100.6984254]
mat_Sqrt:  [[0.15]]
grads:  [0.09708244]
Stock Position:  0.09708243991888062
Bond Position:  [-18.13742289]


portfolio before change:  [-8.36730329]
curr_Stock_Price:  100.64902812129993
curr_Factors:  [100.64902812]
mat_Sqrt:  [[0.15]]
grads:  [0.07250583]
Stock Position:  0.07250582608360376
Bond Position:  [-15.66494422]


portfolio before change:  [-8.37599745]
curr_Stock_Price:  100.54262199938216
curr_Factors:  [100.542622]
mat_Sqrt:  [[0.15]]
grads:  [0.02529654]
Stock Position:  0.02529653616702314
Bond Position:  [-10.91937752]


portfolio before change:  [-8.35225315]
curr_Stock_Price:  101.508239392412
curr_Factors:  [101.50823939]
mat_Sqrt:  [[0.15]]
grads:  [0.09103788]
Stock Position:  0.09103788394577163
Bond Position:  [-17.59334847]


portfolio before change:  [-8.4311408]
curr_Stock_Price:  100.65378164777275
curr_Factors:  [100.65378165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01096162]
Stock Position:  -0.010961623910061035
Bond Position:  [-7.3278119]


portfolio before change:  [-8.42959165]
curr_Stock_Price:  100.4706746481727
curr_Factors:  [100.47067465]
mat_Sqrt:  [[0.15]]
grads:  [0.02105557]
Stock Position:  0.02105557453288942
Bond Position:  [-10.54505943]


portfolio before change:  [-8.44211215]
curr_Stock_Price:  99.90733644803598
curr_Factors:  [99.90733645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0424553]
Stock Position:  -0.04245529511181518
Bond Position:  [-4.20051669]


portfolio before change:  [-8.45026813]
curr_Stock_Price:  100.09326017101037
curr_Factors:  [100.09326017]
mat_Sqrt:  [[0.15]]
grads:  [0.01410046]
Stock Position:  0.01410045639916852
Bond Position:  [-9.86162878]


portfolio before change:  [-8.45448291]
curr_Stock_Price:  99.83806229751235
curr_Factors:  [99.8380623]
mat_Sqrt:  [[0.15]]
grads:  [0.02166516]
Stock Position:  0.021665162971820882
Bond Position:  [-10.6174908]


portfolio before change:  [-8.44984313]
curr_Stock_Price:  100.08285128853713
curr_Factors:  [100.08285129]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898812]
Stock Position:  -0.028988119276488224
Bond Position:  [-5.5486295]


portfolio before change:  [-8.43423212]
curr_Stock_Price:  99.53235642242629
curr_Factors:  [99.53235642]
mat_Sqrt:  [[0.15]]
grads:  [-0.0291416]
Stock Position:  -0.029141602327220444
Bond Position:  [-5.53369977]


portfolio before change:  [-8.42529877]
curr_Stock_Price:  99.21393813020921
curr_Factors:  [99.21393813]
mat_Sqrt:  [[0.15]]
grads:  [0.01419117]
Stock Position:  0.014191166391144677
Bond Position:  [-9.83326027]


portfolio before change:  [-8.44375212]
curr_Stock_Price:  97.95690625369578
curr_Factors:  [97.95690625]
mat_Sqrt:  [[0.15]]
grads:  [0.08040287]
Stock Position:  0.08040287102234883
Bond Position:  [-16.31976861]


portfolio before change:  [-8.42643583]
curr_Stock_Price:  98.18496154400846
curr_Factors:  [98.18496154]
mat_Sqrt:  [[0.15]]
grads:  [0.0533055]
Stock Position:  0.053305503052132
Bond Position:  [-13.6602346]


portfolio before change:  [-8.42336529]
curr_Stock_Price:  98.2585811708927
curr_Factors:  [98.25858117]
mat_Sqrt:  [[0.15]]
grads:  [-0.02575182]
Stock Position:  -0.02575181560832751
Bond Position:  [-5.89302843]


portfolio before change:  [-8.42141911]
curr_Stock_Price:  98.16870353871586
curr_Factors:  [98.16870354]
mat_Sqrt:  [[0.15]]
grads:  [-0.02409186]
Stock Position:  -0.024091857861545055
Bond Position:  [-6.05635265]


portfolio before change:  [-8.4049186]
curr_Stock_Price:  97.4680918310513
curr_Factors:  [97.46809183]
mat_Sqrt:  [[0.15]]
grads:  [-0.00453212]
Stock Position:  -0.004532121912925388
Bond Position:  [-7.96318133]


portfolio before change:  [-8.40396515]
curr_Stock_Price:  97.14789613513003
curr_Factors:  [97.14789614]
mat_Sqrt:  [[0.15]]
grads:  [-0.02843972]
Stock Position:  -0.028439716098637297
Bond Position:  [-5.64110657]


portfolio before change:  [-8.40116627]
curr_Stock_Price:  97.03708420425983
curr_Factors:  [97.0370842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01276]
Stock Position:  -0.012760003276512768
Bond Position:  [-7.16297276]


portfolio before change:  [-8.40743487]
curr_Stock_Price:  97.49326738039433
curr_Factors:  [97.49326738]
mat_Sqrt:  [[0.15]]
grads:  [0.1290009]
Stock Position:  0.129000901040687
Bond Position:  [-20.98415421]


portfolio before change:  [-8.32304171]
curr_Stock_Price:  98.15764031571264
curr_Factors:  [98.15764032]
mat_Sqrt:  [[0.15]]
grads:  [0.02829548]
Stock Position:  0.02829547648638058
Bond Position:  [-11.10045892]


portfolio before change:  [-8.3366019]
curr_Stock_Price:  97.70292510732854
curr_Factors:  [97.70292511]
mat_Sqrt:  [[0.15]]
grads:  [0.07693944]
Stock Position:  0.07693943886986576
Bond Position:  [-15.85381013]


portfolio before change:  [-8.36102315]
curr_Stock_Price:  97.3983952409102
curr_Factors:  [97.39839524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00843645]
Stock Position:  -0.008436452852630059
Bond Position:  [-7.53932618]


portfolio before change:  [-8.35804708]
curr_Stock_Price:  96.9897763566053
curr_Factors:  [96.98977636]
mat_Sqrt:  [[0.15]]
grads:  [0.02937764]
Stock Position:  0.029377635357757
Bond Position:  [-11.20737736]


portfolio before change:  [-8.37778184]
curr_Stock_Price:  96.34185883594881
curr_Factors:  [96.34185884]
mat_Sqrt:  [[0.15]]
grads:  [0.16341341]
Stock Position:  0.16341340820462164
Bond Position:  [-24.12133335]


portfolio before change:  [-8.47334187]
curr_Stock_Price:  95.76631001473051
curr_Factors:  [95.76631001]
mat_Sqrt:  [[0.15]]
grads:  [0.02130937]
Stock Position:  0.021309368624196124
Bond Position:  [-10.51406147]


portfolio before change:  [-8.45492803]
curr_Stock_Price:  96.66126780071696
curr_Factors:  [96.6612678]
mat_Sqrt:  [[0.15]]
grads:  [-0.10291487]
Stock Position:  -0.10291486665411992
Bond Position:  [1.49295345]


portfolio before change:  [-8.43622415]
curr_Stock_Price:  96.48043316548286
curr_Factors:  [96.48043317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03875534]
Stock Position:  -0.03875533827586579
Bond Position:  [-4.69709232]


portfolio before change:  [-8.45831991]
curr_Stock_Price:  97.04299266973565
curr_Factors:  [97.04299267]
mat_Sqrt:  [[0.15]]
grads:  [0.01069548]
Stock Position:  0.010695475613614802
Bond Position:  [-9.49624087]


portfolio before change:  [-8.45267717]
curr_Stock_Price:  97.6260683239873
curr_Factors:  [97.62606832]
mat_Sqrt:  [[0.15]]
grads:  [0.0594763]
Stock Position:  0.0594763032947054
Bond Position:  [-14.25911482]


portfolio before change:  [-8.4586407]
curr_Stock_Price:  97.54078548938574
curr_Factors:  [97.54078549]
mat_Sqrt:  [[0.15]]
grads:  [0.00606868]
Stock Position:  0.006068676692646188
Bond Position:  [-9.05058419]


portfolio before change:  [-8.46425493]
curr_Stock_Price:  96.7088824130785
curr_Factors:  [96.70888241]
mat_Sqrt:  [[0.15]]
grads:  [-0.01055817]
Stock Position:  -0.01055816609246312
Bond Position:  [-7.44318649]


portfolio before change:  [-8.47345068]
curr_Stock_Price:  97.53578093567216
curr_Factors:  [97.53578094]
mat_Sqrt:  [[0.15]]
grads:  [-0.03900512]
Stock Position:  -0.03900511795805345
Bond Position:  [-4.66905604]


portfolio before change:  [-8.46506152]
curr_Stock_Price:  97.31322089391915
curr_Factors:  [97.31322089]
mat_Sqrt:  [[0.15]]
grads:  [-0.1526629]
Stock Position:  -0.15266289651717502
Bond Position:  [6.39105665]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.44911572]
Stock Price:  97.21138638039278
PL:  [-8.44911572]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37191145e-02]
 [ 5.07580501e-03]
 [ 4.77176439e-02]
 [-1.18727417e-02]
 [ 1.09866778e-02]
 [-1.60947322e-02]
 [-1.37214136e-02]
 [ 7.87238710e-02]
 [-2.10574748e-02]
 [-1.37339090e-02]
 [ 4.21711452e-04]
 [-7.56515569e-03]
 [ 2.00480672e-03]
 [-6.33034363e-03]
 [ 3.03685092e-03]
 [ 2.95199646e-03]
 [-1.90808019e-02]
 [-1.11501634e-02]
 [ 2.34647545e-02]
 [-3.45982093e-03]
 [-2.04243600e-02]
 [ 5.59742464e-03]
 [ 1.40545475e-02]
 [ 2.01217525e-02]
 [-5.62444227e-03]
 [ 4.56044026e-03]
 [ 1.04586557e-02]
 [ 8.54652644e-03]
 [ 1.57768553e-02]
 [ 2.32341922e-02]
 [-6.74763783e-03]
 [ 1.55060842e-02]
 [ 1.16951912e-02]
 [-1.98510773e-02]
 [-8.96481003e-03]
 [ 5.62953741e-06]
 [ 7.90915767e-03]
 [-3.01589975e-03]
 [ 1.10751456e-02]
 [-4.02100068e-03]
 [ 6.68403296e-03]
 [ 3.56944759e-02]
 [-3.37078033e-03]
 [ 1.64914039e-02]
 [-3.99013807e-02]
 [ 2.01744184e-02]
 [ 9.94087273e-03]
 [ 5.28898286e-03]
 [-7.71794253e-03]
 [-7.77138287e-04]
 [-5.60116558e-03]
 [ 1.79405927e-03]
 [ 8.73011892e-04]
 [ 6.51337649e-03]
 [-9.73768853e-03]
 [-4.80510122e-03]
 [-1.13480746e-03]
 [ 1.25101318e-02]
 [ 7.05412381e-03]
 [-3.00887370e-03]
 [-5.12656963e-03]
 [-2.58292362e-03]
 [-8.54777548e-04]
 [-5.85384587e-03]
 [ 1.77016419e-02]
 [ 8.43671953e-03]
 [ 2.04151149e-02]
 [-5.67052248e-03]
 [ 8.61271336e-03]
 [ 2.85309108e-02]
 [ 3.08989778e-03]
 [-1.51303784e-02]
 [-5.68624680e-03]
 [ 2.89522541e-03]
 [ 1.20129409e-02]
 [ 1.67644984e-02]
 [ 5.30182116e-03]
 [-3.32494287e-02]
 [-2.67229020e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.37002746]
curr_Stock_Price:  99.89099968940059
curr_Factors:  [99.89099969]
mat_Sqrt:  [[0.15]]
grads:  [-0.09146076]
Stock Position:  -0.09146076340802589
Bond Position:  [8.76607963]


portfolio before change:  [-0.35744716]
curr_Stock_Price:  99.75944161433328
curr_Factors:  [99.75944161]
mat_Sqrt:  [[0.15]]
grads:  [0.0338387]
Stock Position:  0.033838700083458156
Bond Position:  [-3.73317698]


portfolio before change:  [-0.40125234]
curr_Stock_Price:  98.47180790259937
curr_Factors:  [98.4718079]
mat_Sqrt:  [[0.15]]
grads:  [0.31811763]
Stock Position:  0.31811762604423055
Bond Position:  [-31.7268701]


portfolio before change:  [-0.51803439]
curr_Stock_Price:  98.11093804613695
curr_Factors:  [98.11093805]
mat_Sqrt:  [[0.15]]
grads:  [-0.07915161]
Stock Position:  -0.07915161121406751
Bond Position:  [7.24760443]


portfolio before change:  [-0.54034542]
curr_Stock_Price:  98.39853820074697
curr_Factors:  [98.3985382]
mat_Sqrt:  [[0.15]]
grads:  [0.07324452]
Stock Position:  0.07324451891855488
Bond Position:  [-7.74749901]


portfolio before change:  [-0.5722118]
curr_Stock_Price:  97.97008091372626
curr_Factors:  [97.97008091]
mat_Sqrt:  [[0.15]]
grads:  [-0.10729821]
Stock Position:  -0.10729821440888895
Bond Position:  [9.93980295]


portfolio before change:  [-0.47036095]
curr_Stock_Price:  97.02663937931399
curr_Factors:  [97.02663938]
mat_Sqrt:  [[0.15]]
grads:  [-0.09147609]
Stock Position:  -0.09147609093163968
Bond Position:  [8.40525674]


portfolio before change:  [-0.47351605]
curr_Stock_Price:  97.0668733699105
curr_Factors:  [97.06687337]
mat_Sqrt:  [[0.15]]
grads:  [0.52482581]
Stock Position:  0.5248258066974771
Bond Position:  [-51.41671617]


portfolio before change:  [-0.59823896]
curr_Stock_Price:  96.83535033761449
curr_Factors:  [96.83535034]
mat_Sqrt:  [[0.15]]
grads:  [-0.14038317]
Stock Position:  -0.14038316506826712
Bond Position:  [12.99581401]


portfolio before change:  [-0.65000372]
curr_Stock_Price:  97.2098754453501
curr_Factors:  [97.20987545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09155939]
Stock Position:  -0.09155939356469169
Bond Position:  [8.25047353]


portfolio before change:  [-0.64209534]
curr_Stock_Price:  97.12913323608998
curr_Factors:  [97.12913324]
mat_Sqrt:  [[0.15]]
grads:  [0.00281141]
Stock Position:  0.002811409679427529
Bond Position:  [-0.91516513]


portfolio before change:  [-0.64050817]
curr_Stock_Price:  97.71402444341356
curr_Factors:  [97.71402444]
mat_Sqrt:  [[0.15]]
grads:  [-0.05043437]
Stock Position:  -0.050434371263351534
Bond Position:  [4.28763722]


portfolio before change:  [-0.59464454]
curr_Stock_Price:  96.80996543644002
curr_Factors:  [96.80996544]
mat_Sqrt:  [[0.15]]
grads:  [0.01336538]
Stock Position:  0.013365378156796887
Bond Position:  [-1.88854633]


portfolio before change:  [-0.590596]
curr_Stock_Price:  97.1217091548708
curr_Factors:  [97.12170915]
mat_Sqrt:  [[0.15]]
grads:  [-0.04220229]
Stock Position:  -0.042202290868988065
Bond Position:  [3.50816262]


portfolio before change:  [-0.59340858]
curr_Stock_Price:  97.19354990470859
curr_Factors:  [97.1935499]
mat_Sqrt:  [[0.15]]
grads:  [0.02024567]
Stock Position:  0.020245672829580567
Bond Position:  [-2.56115739]


portfolio before change:  [-0.58775024]
curr_Stock_Price:  97.48094059484286
curr_Factors:  [97.48094059]
mat_Sqrt:  [[0.15]]
grads:  [0.01967998]
Stock Position:  0.019679976387145897
Bond Position:  [-2.50617285]


portfolio before change:  [-0.58044339]
curr_Stock_Price:  97.86018329508127
curr_Factors:  [97.8601833]
mat_Sqrt:  [[0.15]]
grads:  [-0.12720535]
Stock Position:  -0.12720534588189433
Bond Position:  [11.86789507]


portfolio before change:  [-0.48701128]
curr_Stock_Price:  97.13151623943673
curr_Factors:  [97.13151624]
mat_Sqrt:  [[0.15]]
grads:  [-0.07433442]
Stock Position:  -0.07433442261083581
Bond Position:  [6.7332039]


portfolio before change:  [-0.443279]
curr_Stock_Price:  96.54885967729983
curr_Factors:  [96.54885968]
mat_Sqrt:  [[0.15]]
grads:  [0.1564317]
Stock Position:  0.15643169668091453
Bond Position:  [-15.54658094]


portfolio before change:  [-0.37383078]
curr_Stock_Price:  96.99902364629526
curr_Factors:  [96.99902365]
mat_Sqrt:  [[0.15]]
grads:  [-0.02306547]
Stock Position:  -0.023065472854677315
Bond Position:  [1.86349757]


portfolio before change:  [-0.36727446]
curr_Stock_Price:  96.71982488102361
curr_Factors:  [96.71982488]
mat_Sqrt:  [[0.15]]
grads:  [-0.1361624]
Stock Position:  -0.13616239978812392
Bond Position:  [12.80232901]


portfolio before change:  [-0.46373082]
curr_Stock_Price:  97.43409349782962
curr_Factors:  [97.4340935]
mat_Sqrt:  [[0.15]]
grads:  [0.03731616]
Stock Position:  0.03731616428353792
Bond Position:  [-4.09959746]


portfolio before change:  [-0.43981172]
curr_Stock_Price:  98.08194479629991
curr_Factors:  [98.0819448]
mat_Sqrt:  [[0.15]]
grads:  [0.09369698]
Stock Position:  0.09369698328948495
Bond Position:  [-9.62979407]


portfolio before change:  [-0.43653978]
curr_Stock_Price:  98.12328901425167
curr_Factors:  [98.12328901]
mat_Sqrt:  [[0.15]]
grads:  [0.13414502]
Stock Position:  0.13414501680464158
Bond Position:  [-13.59929003]


portfolio before change:  [-0.36713976]
curr_Stock_Price:  98.64697600740126
curr_Factors:  [98.64697601]
mat_Sqrt:  [[0.15]]
grads:  [-0.03749628]
Stock Position:  -0.03749628179055403
Bond Position:  [3.33175505]


portfolio before change:  [-0.39200008]
curr_Stock_Price:  99.31553734815493
curr_Factors:  [99.31553735]
mat_Sqrt:  [[0.15]]
grads:  [0.03040294]
Stock Position:  0.03040293507671524
Bond Position:  [-3.41148392]


portfolio before change:  [-0.40474353]
curr_Stock_Price:  98.90339876520754
curr_Factors:  [98.90339877]
mat_Sqrt:  [[0.15]]
grads:  [0.06972437]
Stock Position:  0.06972437146120833
Bond Position:  [-7.30072084]


portfolio before change:  [-0.42929631]
curr_Stock_Price:  98.5578025770052
curr_Factors:  [98.55780258]
mat_Sqrt:  [[0.15]]
grads:  [0.05697684]
Stock Position:  0.056976842946291816
Bond Position:  [-6.04480875]


portfolio before change:  [-0.43212564]
curr_Stock_Price:  98.51477605738283
curr_Factors:  [98.51477606]
mat_Sqrt:  [[0.15]]
grads:  [0.10517904]
Stock Position:  0.10517903528929151
Bond Position:  [-10.79381475]


portfolio before change:  [-0.51652931]
curr_Stock_Price:  97.7187140113255
curr_Factors:  [97.71871401]
mat_Sqrt:  [[0.15]]
grads:  [0.15489461]
Stock Position:  0.15489461486232634
Bond Position:  [-15.65263189]


portfolio before change:  [-0.52605606]
curr_Stock_Price:  97.66352536150966
curr_Factors:  [97.66352536]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498425]
Stock Position:  -0.04498425217005139
Bond Position:  [3.86726459]


portfolio before change:  [-0.53603011]
curr_Stock_Price:  97.8906218139599
curr_Factors:  [97.89062181]
mat_Sqrt:  [[0.15]]
grads:  [0.10337389]
Stock Position:  0.103373894650579
Bond Position:  [-10.65536494]


portfolio before change:  [-0.57748957]
curr_Stock_Price:  97.49600112664726
curr_Factors:  [97.49600113]
mat_Sqrt:  [[0.15]]
grads:  [0.07796794]
Stock Position:  0.07796794102525459
Bond Position:  [-8.17905204]


portfolio before change:  [-0.64313838]
curr_Stock_Price:  96.66056027599407
curr_Factors:  [96.66056028]
mat_Sqrt:  [[0.15]]
grads:  [-0.13234052]
Stock Position:  -0.13234051512665845
Bond Position:  [12.14896996]


portfolio before change:  [-0.73343082]
curr_Stock_Price:  97.34857163544838
curr_Factors:  [97.34857164]
mat_Sqrt:  [[0.15]]
grads:  [-0.0597654]
Stock Position:  -0.05976540021968617
Bond Position:  [5.08464552]


portfolio before change:  [-0.70988933]
curr_Stock_Price:  96.9599906842368
curr_Factors:  [96.95999068]
mat_Sqrt:  [[0.15]]
grads:  [3.75302494e-05]
Stock Position:  3.7530249430821803e-05
Bond Position:  [-0.71352826]


portfolio before change:  [-0.7099382]
curr_Stock_Price:  96.84608313964881
curr_Factors:  [96.84608314]
mat_Sqrt:  [[0.15]]
grads:  [0.05272772]
Stock Position:  0.052727717782168664
Bond Position:  [-5.81641114]


portfolio before change:  [-0.74405417]
curr_Stock_Price:  96.20595620878282
curr_Factors:  [96.20595621]
mat_Sqrt:  [[0.15]]
grads:  [-0.020106]
Stock Position:  -0.020105998322630006
Bond Position:  [1.19026263]


portfolio before change:  [-0.74711378]
curr_Stock_Price:  96.36183053530065
curr_Factors:  [96.36183054]
mat_Sqrt:  [[0.15]]
grads:  [0.0738343]
Stock Position:  0.07383430415810076
Bond Position:  [-7.86192249]


portfolio before change:  [-0.74641293]
curr_Stock_Price:  96.37797808871727
curr_Factors:  [96.37797809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02680667]
Stock Position:  -0.026806671221334677
Bond Position:  [1.83715985]


portfolio before change:  [-0.71986479]
curr_Stock_Price:  95.39190595718618
curr_Factors:  [95.39190596]
mat_Sqrt:  [[0.15]]
grads:  [0.04456022]
Stock Position:  0.04456021972379757
Bond Position:  [-4.97054908]


portfolio before change:  [-0.70150456]
curr_Stock_Price:  95.81090962187587
curr_Factors:  [95.81090962]
mat_Sqrt:  [[0.15]]
grads:  [0.23796317]
Stock Position:  0.23796317288752794
Bond Position:  [-23.50097261]


portfolio before change:  [-0.64194357]
curr_Stock_Price:  96.06737721979034
curr_Factors:  [96.06737722]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247187]
Stock Position:  -0.022471868865328853
Bond Position:  [1.51686993]


portfolio before change:  [-0.63659353]
curr_Stock_Price:  95.83351861558832
curr_Factors:  [95.83351862]
mat_Sqrt:  [[0.15]]
grads:  [0.10994269]
Stock Position:  0.10994269259877182
Bond Position:  [-11.17278861]


portfolio before change:  [-0.60425808]
curr_Stock_Price:  96.13398217708374
curr_Factors:  [96.13398218]
mat_Sqrt:  [[0.15]]
grads:  [-0.2660092]
Stock Position:  -0.2660092044029014
Bond Position:  [24.96826604]


portfolio before change:  [-0.69880179]
curr_Stock_Price:  96.49526395709542
curr_Factors:  [96.49526396]
mat_Sqrt:  [[0.15]]
grads:  [0.13449612]
Stock Position:  0.13449612280324358
Bond Position:  [-13.67704066]


portfolio before change:  [-0.59775879]
curr_Stock_Price:  97.25289059508601
curr_Factors:  [97.2528906]
mat_Sqrt:  [[0.15]]
grads:  [0.06627248]
Stock Position:  0.06627248484518432
Bond Position:  [-7.0429495]


portfolio before change:  [-0.58025663]
curr_Stock_Price:  97.52362675623344
curr_Factors:  [97.52362676]
mat_Sqrt:  [[0.15]]
grads:  [0.03525989]
Stock Position:  0.035259885719294275
Bond Position:  [-4.01892856]


portfolio before change:  [-0.5920132]
curr_Stock_Price:  97.1973243087414
curr_Factors:  [97.19732431]
mat_Sqrt:  [[0.15]]
grads:  [-0.05145295]
Stock Position:  -0.05145295022205749
Bond Position:  [4.40907589]


portfolio before change:  [-0.62907325]
curr_Stock_Price:  97.92295078669598
curr_Factors:  [97.92295079]
mat_Sqrt:  [[0.15]]
grads:  [-0.00518092]
Stock Position:  -0.005180921912083797
Bond Position:  [-0.12174209]


portfolio before change:  [-0.6290902]
curr_Stock_Price:  97.92475380467532
curr_Factors:  [97.9247538]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373411]
Stock Position:  -0.037341103891382135
Bond Position:  [3.0275282]


portfolio before change:  [-0.63470325]
curr_Stock_Price:  98.08013948147678
curr_Factors:  [98.08013948]
mat_Sqrt:  [[0.15]]
grads:  [0.0119604]
Stock Position:  0.011960395161284878
Bond Position:  [-1.80778047]


portfolio before change:  [-0.63946722]
curr_Stock_Price:  97.69127426368377
curr_Factors:  [97.69127426]
mat_Sqrt:  [[0.15]]
grads:  [0.00582008]
Stock Position:  0.005820079276799204
Bond Position:  [-1.20803818]


portfolio before change:  [-0.63911382]
curr_Stock_Price:  97.76496876192768
curr_Factors:  [97.76496876]
mat_Sqrt:  [[0.15]]
grads:  [0.04342251]
Stock Position:  0.04342250995268009
Bond Position:  [-4.88431414]


portfolio before change:  [-0.66887022]
curr_Stock_Price:  97.08672327360387
curr_Factors:  [97.08672327]
mat_Sqrt:  [[0.15]]
grads:  [-0.06491792]
Stock Position:  -0.06491792354995266
Bond Position:  [5.63379826]


portfolio before change:  [-0.65449114]
curr_Stock_Price:  96.87065120294109
curr_Factors:  [96.8706512]
mat_Sqrt:  [[0.15]]
grads:  [-0.03203401]
Stock Position:  -0.03203400812548881
Bond Position:  [2.44866408]


portfolio before change:  [-0.65736901]
curr_Stock_Price:  96.96526676900884
curr_Factors:  [96.96526677]
mat_Sqrt:  [[0.15]]
grads:  [-0.00756538]
Stock Position:  -0.007565383084826372
Bond Position:  [0.07621038]


portfolio before change:  [-0.6568349]
curr_Stock_Price:  96.89529682911582
curr_Factors:  [96.89529683]
mat_Sqrt:  [[0.15]]
grads:  [0.08340088]
Stock Position:  0.08340087879992203
Bond Position:  [-8.73798781]


portfolio before change:  [-0.73063143]
curr_Stock_Price:  96.01700406607145
curr_Factors:  [96.01700407]
mat_Sqrt:  [[0.15]]
grads:  [0.04702749]
Stock Position:  0.04702749204194975
Bond Position:  [-5.24607032]


portfolio before change:  [-0.71832939]
curr_Stock_Price:  96.2855688312996
curr_Factors:  [96.28556883]
mat_Sqrt:  [[0.15]]
grads:  [-0.02005916]
Stock Position:  -0.020059158001369464
Bond Position:  [1.21307805]


portfolio before change:  [-0.69728238]
curr_Stock_Price:  95.24010171359694
curr_Factors:  [95.24010171]
mat_Sqrt:  [[0.15]]
grads:  [-0.03417713]
Stock Position:  -0.034177130889404946
Bond Position:  [2.55775104]


portfolio before change:  [-0.69963395]
curr_Stock_Price:  95.31358451725393
curr_Factors:  [95.31358452]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721949]
Stock Position:  -0.01721949082165529
Bond Position:  [0.94161745]


portfolio before change:  [-0.69675478]
curr_Stock_Price:  95.14979853876521
curr_Factors:  [95.14979854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00569852]
Stock Position:  -0.005698516983818867
Bond Position:  [-0.15454204]


portfolio before change:  [-0.6924463]
curr_Stock_Price:  94.39203172097346
curr_Factors:  [94.39203172]
mat_Sqrt:  [[0.15]]
grads:  [-0.03902564]
Stock Position:  -0.039025639113754416
Bond Position:  [2.99126307]


portfolio before change:  [-0.69805064]
curr_Stock_Price:  94.540429024129
curr_Factors:  [94.54042902]
mat_Sqrt:  [[0.15]]
grads:  [0.11801095]
Stock Position:  0.11801094593899847
Bond Position:  [-11.8548561]


portfolio before change:  [-0.76324169]
curr_Stock_Price:  93.99429239212142
curr_Factors:  [93.99429239]
mat_Sqrt:  [[0.15]]
grads:  [0.0562448]
Stock Position:  0.05624479683440607
Bond Position:  [-6.04993157]


portfolio before change:  [-0.75008806]
curr_Stock_Price:  94.23487920664742
curr_Factors:  [94.23487921]
mat_Sqrt:  [[0.15]]
grads:  [0.13610077]
Stock Position:  0.13610076582537975
Bond Position:  [-13.57552729]


portfolio before change:  [-0.85411808]
curr_Stock_Price:  93.4767533220236
curr_Factors:  [93.47675332]
mat_Sqrt:  [[0.15]]
grads:  [-0.03780348]
Stock Position:  -0.03780348317555301
Bond Position:  [2.6796288]


portfolio before change:  [-0.87148083]
curr_Stock_Price:  93.94047351572857
curr_Factors:  [93.94047352]
mat_Sqrt:  [[0.15]]
grads:  [0.05741809]
Stock Position:  0.057418089036259806
Bond Position:  [-6.2653633]


portfolio before change:  [-0.84665761]
curr_Stock_Price:  94.3796176054678
curr_Factors:  [94.37961761]
mat_Sqrt:  [[0.15]]
grads:  [0.19020607]
Stock Position:  0.19020607171128523
Bond Position:  [-18.79823393]


portfolio before change:  [-0.90720968]
curr_Stock_Price:  94.06744491529483
curr_Factors:  [94.06744492]
mat_Sqrt:  [[0.15]]
grads:  [0.02059932]
Stock Position:  0.020599318547199402
Bond Position:  [-2.84493494]


portfolio before change:  [-0.90456245]
curr_Stock_Price:  94.20458775600837
curr_Factors:  [94.20458776]
mat_Sqrt:  [[0.15]]
grads:  [-0.10086919]
Stock Position:  -0.10086918960673395
Bond Position:  [8.59777798]


portfolio before change:  [-0.92599506]
curr_Stock_Price:  94.42239449788958
curr_Factors:  [94.4223945]
mat_Sqrt:  [[0.15]]
grads:  [-0.03790831]
Stock Position:  -0.037908312003651336
Bond Position:  [2.65339853]


portfolio before change:  [-0.92430309]
curr_Stock_Price:  94.38213608489545
curr_Factors:  [94.38213608]
mat_Sqrt:  [[0.15]]
grads:  [0.0193015]
Stock Position:  0.019301502720470626
Bond Position:  [-2.74602014]


portfolio before change:  [-0.9333015]
curr_Stock_Price:  93.92482572086084
curr_Factors:  [93.92482572]
mat_Sqrt:  [[0.15]]
grads:  [0.08008627]
Stock Position:  0.08008627299745301
Bond Position:  [-8.45539073]


portfolio before change:  [-0.99270565]
curr_Stock_Price:  93.18967257184286
curr_Factors:  [93.18967257]
mat_Sqrt:  [[0.15]]
grads:  [0.11176332]
Stock Position:  0.11176332265170771
Bond Position:  [-11.40789309]


portfolio before change:  [-1.0368849]
curr_Stock_Price:  92.80075939621275
curr_Factors:  [92.8007594]
mat_Sqrt:  [[0.15]]
grads:  [0.03534547]
Stock Position:  0.03534547440560215
Bond Position:  [-4.31697176]


portfolio before change:  [-1.02740314]
curr_Stock_Price:  93.07665247367422
curr_Factors:  [93.07665247]
mat_Sqrt:  [[0.15]]
grads:  [-0.22166286]
Stock Position:  -0.22166285767269622
Bond Position:  [19.60423363]


portfolio before change:  [-0.982089]
curr_Stock_Price:  92.87775201565401
curr_Factors:  [92.87775202]
mat_Sqrt:  [[0.15]]
grads:  [-0.17815268]
Stock Position:  -0.1781526799809825
Bond Position:  [15.56433144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.1347495]
Stock Price:  93.74012079849284
PL:  [-1.1347495]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33879901e-02]
 [ 5.80423949e-03]
 [ 2.70584691e-02]
 [-1.19899456e-02]
 [ 1.09617016e-02]
 [-1.44132517e-02]
 [-1.35916037e-02]
 [ 7.06206002e-02]
 [-2.08146656e-02]
 [-1.34211434e-02]
 [ 1.04723128e-02]
 [-7.59258202e-03]
 [ 3.72302822e-03]
 [-2.83036965e-03]
 [-1.69425666e-03]
 [ 9.51288796e-03]
 [ 1.88375154e-02]
 [-1.48917108e-02]
 [ 2.21552202e-02]
 [ 1.96679799e-03]
 [-4.59640750e-03]
 [ 5.39215185e-03]
 [ 1.61386039e-02]
 [ 1.72663825e-02]
 [-2.96517557e-03]
 [ 5.25631725e-03]
 [ 1.03903610e-02]
 [ 9.04142110e-03]
 [ 1.59712882e-02]
 [ 3.93204513e-03]
 [-6.44939032e-03]
 [ 1.11757793e-02]
 [ 1.15294375e-02]
 [-2.04453180e-02]
 [-3.73548861e-03]
 [ 1.80820214e-02]
 [ 4.89428658e-03]
 [ 2.39692172e-03]
 [-4.54003990e-02]
 [-1.45247146e-02]
 [ 7.15400230e-03]
 [ 2.77643082e-02]
 [-2.81600557e-03]
 [ 1.44009514e-03]
 [-2.97425188e-03]
 [ 1.57632267e-02]
 [ 1.04793275e-02]
 [ 4.78757681e-03]
 [ 8.02210634e-03]
 [-2.21148923e-03]
 [-7.15913652e-03]
 [-5.72455537e-04]
 [ 1.15195242e-03]
 [ 8.60996389e-03]
 [-5.91377391e-03]
 [-4.42050005e-03]
 [ 4.21571959e-04]
 [ 9.65111461e-03]
 [ 7.39009298e-03]
 [-3.98484672e-03]
 [-2.83690589e-04]
 [ 2.33194456e-03]
 [-6.03068890e-03]
 [ 3.00226140e-03]
 [ 1.96190024e-02]
 [ 4.52710132e-03]
 [ 1.21190510e-02]
 [-1.04954589e-03]
 [ 2.61242923e-03]
 [ 2.27204486e-02]
 [ 2.79676149e-03]
 [-1.59519068e-02]
 [-6.15449001e-03]
 [ 1.17463794e-03]
 [ 7.70349053e-03]
 [-7.47796617e-05]
 [-1.49242707e-03]
 [-4.87737841e-03]
 [-2.27655547e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.78219822]
curr_Stock_Price:  99.55435408320143
curr_Factors:  [99.55435408]
mat_Sqrt:  [[0.15]]
grads:  [-0.08925327]
Stock Position:  -0.08925326748388347
Bond Position:  [1.10335318]


portfolio before change:  [-7.80254282]
curr_Stock_Price:  99.78306912936762
curr_Factors:  [99.78306913]
mat_Sqrt:  [[0.15]]
grads:  [0.03869493]
Stock Position:  0.038694929928617214
Bond Position:  [-11.66364169]


portfolio before change:  [-7.83060211]
curr_Stock_Price:  99.07676753906193
curr_Factors:  [99.07676754]
mat_Sqrt:  [[0.15]]
grads:  [0.18038979]
Stock Position:  0.18038979393670146
Bond Position:  [-25.70303979]


portfolio before change:  [-7.97307497]
curr_Stock_Price:  98.29586762733751
curr_Factors:  [98.29586763]
mat_Sqrt:  [[0.15]]
grads:  [-0.07993297]
Stock Position:  -0.07993297058869418
Bond Position:  [-0.11599428]


portfolio before change:  [-8.00158143]
curr_Stock_Price:  98.65240640401231
curr_Factors:  [98.6524064]
mat_Sqrt:  [[0.15]]
grads:  [0.07307801]
Stock Position:  0.07307801049572375
Bond Position:  [-15.21090302]


portfolio before change:  [-8.0040116]
curr_Stock_Price:  98.63216145135668
curr_Factors:  [98.63216145]
mat_Sqrt:  [[0.15]]
grads:  [-0.09608834]
Stock Position:  -0.09608834490022705
Bond Position:  [1.47338955]


portfolio before change:  [-7.91384029]
curr_Stock_Price:  97.69469892627954
curr_Factors:  [97.69469893]
mat_Sqrt:  [[0.15]]
grads:  [-0.09061069]
Stock Position:  -0.09061069142795854
Bond Position:  [0.93834393]


portfolio before change:  [-7.88688058]
curr_Stock_Price:  97.39781275036177
curr_Factors:  [97.39781275]
mat_Sqrt:  [[0.15]]
grads:  [0.470804]
Stock Position:  0.4708040014214029
Bond Position:  [-53.74216055]


portfolio before change:  [-7.49323988]
curr_Stock_Price:  98.24105046618303
curr_Factors:  [98.24105047]
mat_Sqrt:  [[0.15]]
grads:  [-0.13876444]
Stock Position:  -0.13876443761190982
Bond Position:  [6.13912424]


portfolio before change:  [-7.41575918]
curr_Stock_Price:  97.68545432669785
curr_Factors:  [97.68545433]
mat_Sqrt:  [[0.15]]
grads:  [-0.08947429]
Stock Position:  -0.08947428942330941
Bond Position:  [1.32457743]


portfolio before change:  [-7.48153068]
curr_Stock_Price:  98.42146779137303
curr_Factors:  [98.42146779]
mat_Sqrt:  [[0.15]]
grads:  [0.06981542]
Stock Position:  0.06981541867672468
Bond Position:  [-14.35286666]


portfolio before change:  [-7.45924896]
curr_Stock_Price:  98.75346895960865
curr_Factors:  [98.75346896]
mat_Sqrt:  [[0.15]]
grads:  [-0.05061721]
Stock Position:  -0.050617213465954616
Bond Position:  [-2.46062354]


portfolio before change:  [-7.4201858]
curr_Stock_Price:  97.9786940519536
curr_Factors:  [97.97869405]
mat_Sqrt:  [[0.15]]
grads:  [0.02482019]
Stock Position:  0.02482018810066562
Bond Position:  [-9.85203542]


portfolio before change:  [-7.41782438]
curr_Stock_Price:  98.09864466376747
curr_Factors:  [98.09864466]
mat_Sqrt:  [[0.15]]
grads:  [-0.01886913]
Stock Position:  -0.018869130972715968
Bond Position:  [-5.56678821]


portfolio before change:  [-7.43740196]
curr_Stock_Price:  99.11775055242364
curr_Factors:  [99.11775055]
mat_Sqrt:  [[0.15]]
grads:  [-0.01129504]
Stock Position:  -0.01129504438375276
Bond Position:  [-6.31786257]


portfolio before change:  [-7.43572108]
curr_Stock_Price:  98.93397438204299
curr_Factors:  [98.93397438]
mat_Sqrt:  [[0.15]]
grads:  [0.06341925]
Stock Position:  0.0634192530347246
Bond Position:  [-13.71003983]


portfolio before change:  [-7.41915491]
curr_Stock_Price:  99.20870279338988
curr_Factors:  [99.20870279]
mat_Sqrt:  [[0.15]]
grads:  [0.12558344]
Stock Position:  0.12558343601308086
Bond Position:  [-19.87812469]


portfolio before change:  [-7.34750537]
curr_Stock_Price:  99.78912932583287
curr_Factors:  [99.78912933]
mat_Sqrt:  [[0.15]]
grads:  [-0.09927807]
Stock Position:  -0.09927807223285938
Bond Position:  [2.55936702]


portfolio before change:  [-7.29673881]
curr_Stock_Price:  99.27938339116855
curr_Factors:  [99.27938339]
mat_Sqrt:  [[0.15]]
grads:  [0.14770147]
Stock Position:  0.14770146790519292
Bond Position:  [-21.96044947]


portfolio before change:  [-7.26749688]
curr_Stock_Price:  99.48665621602818
curr_Factors:  [99.48665622]
mat_Sqrt:  [[0.15]]
grads:  [0.01311199]
Stock Position:  0.013111986569006587
Bond Position:  [-8.57196458]


portfolio before change:  [-7.27576934]
curr_Stock_Price:  98.89660918173432
curr_Factors:  [98.89660918]
mat_Sqrt:  [[0.15]]
grads:  [-0.03064272]
Stock Position:  -0.030642716657752735
Bond Position:  [-4.24530856]


portfolio before change:  [-7.27553132]
curr_Stock_Price:  98.88018259191894
curr_Factors:  [98.88018259]
mat_Sqrt:  [[0.15]]
grads:  [0.03594768]
Stock Position:  0.03594767901929501
Bond Position:  [-10.83004439]


portfolio before change:  [-7.24002018]
curr_Stock_Price:  99.88686910173385
curr_Factors:  [99.8868691]
mat_Sqrt:  [[0.15]]
grads:  [0.10759069]
Stock Position:  0.10759069233424262
Bond Position:  [-17.98691758]


portfolio before change:  [-7.2148864]
curr_Stock_Price:  100.13092360964197
curr_Factors:  [100.13092361]
mat_Sqrt:  [[0.15]]
grads:  [0.11510922]
Stock Position:  0.11510921684220558
Bond Position:  [-18.7408786]


portfolio before change:  [-7.14818791]
curr_Stock_Price:  100.72053612389728
curr_Factors:  [100.72053612]
mat_Sqrt:  [[0.15]]
grads:  [-0.01976784]
Stock Position:  -0.01976783714648182
Bond Position:  [-5.15716075]


portfolio before change:  [-7.1411247]
curr_Stock_Price:  100.34692221911456
curr_Factors:  [100.34692222]
mat_Sqrt:  [[0.15]]
grads:  [0.03504212]
Stock Position:  0.035042115013431435
Bond Position:  [-10.65749309]


portfolio before change:  [-7.20028908]
curr_Stock_Price:  98.67755204248924
curr_Factors:  [98.67755204]
mat_Sqrt:  [[0.15]]
grads:  [0.06926907]
Stock Position:  0.0692690734014336
Bond Position:  [-14.03559167]


portfolio before change:  [-7.24308338]
curr_Stock_Price:  98.07241840889283
curr_Factors:  [98.07241841]
mat_Sqrt:  [[0.15]]
grads:  [0.06027614]
Stock Position:  0.06027614063381682
Bond Position:  [-13.15451026]


portfolio before change:  [-7.25502239]
curr_Stock_Price:  97.88798673252184
curr_Factors:  [97.88798673]
mat_Sqrt:  [[0.15]]
grads:  [0.10647525]
Stock Position:  0.10647525451377787
Bond Position:  [-17.67767069]


portfolio before change:  [-7.1769028]
curr_Stock_Price:  98.63205142702621
curr_Factors:  [98.63205143]
mat_Sqrt:  [[0.15]]
grads:  [0.02621363]
Stock Position:  0.026213634203537072
Bond Position:  [-9.76240732]


portfolio before change:  [-7.16418502]
curr_Stock_Price:  99.14048736228831
curr_Factors:  [99.14048736]
mat_Sqrt:  [[0.15]]
grads:  [-0.04299594]
Stock Position:  -0.042995935452791914
Bond Position:  [-2.90154702]


portfolio before change:  [-7.14689995]
curr_Stock_Price:  98.73425330820248
curr_Factors:  [98.73425331]
mat_Sqrt:  [[0.15]]
grads:  [0.0745052]
Stock Position:  0.0745051950375818
Bond Position:  [-14.50311475]


portfolio before change:  [-7.21215283]
curr_Stock_Price:  97.87060339639123
curr_Factors:  [97.8706034]
mat_Sqrt:  [[0.15]]
grads:  [0.07686292]
Stock Position:  0.07686291638860228
Bond Position:  [-14.73477284]


portfolio before change:  [-7.2170373]
curr_Stock_Price:  97.81903742342057
curr_Factors:  [97.81903742]
mat_Sqrt:  [[0.15]]
grads:  [-0.13630212]
Stock Position:  -0.13630211988054458
Bond Position:  [6.11590487]


portfolio before change:  [-7.28139648]
curr_Stock_Price:  98.29402224699464
curr_Factors:  [98.29402225]
mat_Sqrt:  [[0.15]]
grads:  [-0.02490326]
Stock Position:  -0.024903257377776357
Bond Position:  [-4.83355514]


portfolio before change:  [-7.276227]
curr_Stock_Price:  98.07430858771588
curr_Factors:  [98.07430859]
mat_Sqrt:  [[0.15]]
grads:  [0.12054681]
Stock Position:  0.12054680963305332
Bond Position:  [-19.09877201]


portfolio before change:  [-7.23252206]
curr_Stock_Price:  98.44676683238562
curr_Factors:  [98.44676683]
mat_Sqrt:  [[0.15]]
grads:  [0.03262858]
Stock Position:  0.03262857718663822
Bond Position:  [-10.44469999]


portfolio before change:  [-7.21749924]
curr_Stock_Price:  98.92719322321211
curr_Factors:  [98.92719322]
mat_Sqrt:  [[0.15]]
grads:  [0.01597948]
Stock Position:  0.015979478110554307
Bond Position:  [-8.79830416]


portfolio before change:  [-7.2141778]
curr_Stock_Price:  99.16946356382175
curr_Factors:  [99.16946356]
mat_Sqrt:  [[0.15]]
grads:  [-0.30266933]
Stock Position:  -0.3026693265829419
Bond Position:  [22.80137696]


portfolio before change:  [-7.16283566]
curr_Stock_Price:  99.00454098260393
curr_Factors:  [99.00454098]
mat_Sqrt:  [[0.15]]
grads:  [-0.09683143]
Stock Position:  -0.09683143048052809
Bond Position:  [2.42391567]


portfolio before change:  [-7.09886268]
curr_Stock_Price:  98.34544220586938
curr_Factors:  [98.34544221]
mat_Sqrt:  [[0.15]]
grads:  [0.04769335]
Stock Position:  0.047693348668844435
Bond Position:  [-11.78928615]


portfolio before change:  [-7.12054203]
curr_Stock_Price:  97.90633510090312
curr_Factors:  [97.9063351]
mat_Sqrt:  [[0.15]]
grads:  [0.18509539]
Stock Position:  0.18509538814685492
Bond Position:  [-25.24255312]


portfolio before change:  [-7.06745845]
curr_Stock_Price:  98.20164924987337
curr_Factors:  [98.20164925]
mat_Sqrt:  [[0.15]]
grads:  [-0.01877337]
Stock Position:  -0.01877337047434873
Bond Position:  [-5.22388251]


portfolio before change:  [-7.06959917]
curr_Stock_Price:  98.29828709089244
curr_Factors:  [98.29828709]
mat_Sqrt:  [[0.15]]
grads:  [0.00960063]
Stock Position:  0.009600634266804966
Bond Position:  [-8.01332507]


portfolio before change:  [-7.07117237]
curr_Stock_Price:  98.18659156218081
curr_Factors:  [98.18659156]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982835]
Stock Position:  -0.01982834587274001
Bond Position:  [-5.12429467]


portfolio before change:  [-7.07255289]
curr_Stock_Price:  98.24006263453589
curr_Factors:  [98.24006263]
mat_Sqrt:  [[0.15]]
grads:  [0.10508818]
Stock Position:  0.10508817783612205
Bond Position:  [-17.39642206]


portfolio before change:  [-7.06187009]
curr_Stock_Price:  98.35206484471522
curr_Factors:  [98.35206484]
mat_Sqrt:  [[0.15]]
grads:  [0.06986218]
Stock Position:  0.06986218340775857
Bond Position:  [-13.93296008]


portfolio before change:  [-7.01126393]
curr_Stock_Price:  99.08890118946115
curr_Factors:  [99.08890119]
mat_Sqrt:  [[0.15]]
grads:  [0.03191718]
Stock Position:  0.0319171787011121
Bond Position:  [-10.1739021]


portfolio before change:  [-6.98714248]
curr_Stock_Price:  99.86457573020162
curr_Factors:  [99.86457573]
mat_Sqrt:  [[0.15]]
grads:  [0.05348071]
Stock Position:  0.053480708923775225
Bond Position:  [-12.32797078]


portfolio before change:  [-7.02598336]
curr_Stock_Price:  99.15272356277814
curr_Factors:  [99.15272356]
mat_Sqrt:  [[0.15]]
grads:  [-0.01474326]
Stock Position:  -0.01474326150302692
Bond Position:  [-5.56414882]


portfolio before change:  [-7.02537165]
curr_Stock_Price:  99.08764440094131
curr_Factors:  [99.0876444]
mat_Sqrt:  [[0.15]]
grads:  [-0.04772758]
Stock Position:  -0.047727576807880215
Bond Position:  [-2.29615849]


portfolio before change:  [-7.01352588]
curr_Stock_Price:  98.8364419211202
curr_Factors:  [98.83644192]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381637]
Stock Position:  -0.0038163702439871286
Bond Position:  [-6.63632942]


portfolio before change:  [-7.01182462]
curr_Stock_Price:  98.28197680413771
curr_Factors:  [98.2819768]
mat_Sqrt:  [[0.15]]
grads:  [0.00767968]
Stock Position:  0.0076796827841084485
Bond Position:  [-7.76659902]


portfolio before change:  [-7.00775562]
curr_Stock_Price:  98.87502526823067
curr_Factors:  [98.87502527]
mat_Sqrt:  [[0.15]]
grads:  [0.05739976]
Stock Position:  0.05739975926618904
Bond Position:  [-12.68315827]


portfolio before change:  [-6.98070651]
curr_Stock_Price:  99.36007655607916
curr_Factors:  [99.36007656]
mat_Sqrt:  [[0.15]]
grads:  [-0.03942516]
Stock Position:  -0.039425159379733066
Bond Position:  [-3.06341966]


portfolio before change:  [-6.95718832]
curr_Stock_Price:  98.75869252504789
curr_Factors:  [98.75869253]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947]
Stock Position:  -0.029470000354373596
Bond Position:  [-4.04676962]


portfolio before change:  [-6.95240798]
curr_Stock_Price:  98.58789945836523
curr_Factors:  [98.58789946]
mat_Sqrt:  [[0.15]]
grads:  [0.00281048]
Stock Position:  0.0028104797240019494
Bond Position:  [-7.22948727]


portfolio before change:  [-6.95264125]
curr_Stock_Price:  98.66567450350995
curr_Factors:  [98.6656745]
mat_Sqrt:  [[0.15]]
grads:  [0.06434076]
Stock Position:  0.06434076408575155
Bond Position:  [-13.30086614]


portfolio before change:  [-6.90663057]
curr_Stock_Price:  99.39370467785812
curr_Factors:  [99.39370468]
mat_Sqrt:  [[0.15]]
grads:  [0.04926729]
Stock Position:  0.04926728650428031
Bond Position:  [-11.80348869]


portfolio before change:  [-6.92398614]
curr_Stock_Price:  99.05640521964047
curr_Factors:  [99.05640522]
mat_Sqrt:  [[0.15]]
grads:  [-0.02656564]
Stock Position:  -0.02656564480573926
Bond Position:  [-4.29248886]


portfolio before change:  [-6.93624422]
curr_Stock_Price:  99.50773234490457
curr_Factors:  [99.50773234]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189127]
Stock Position:  -0.0018912705931520858
Bond Position:  [-6.74804817]


portfolio before change:  [-6.935975]
curr_Stock_Price:  99.14237525646519
curr_Factors:  [99.14237526]
mat_Sqrt:  [[0.15]]
grads:  [0.0155463]
Stock Position:  0.015546297098414664
Bond Position:  [-8.47727182]


portfolio before change:  [-6.9467416]
curr_Stock_Price:  98.48390652764323
curr_Factors:  [98.48390653]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020459]
Stock Position:  -0.04020459264931911
Bond Position:  [-2.98723625]


portfolio before change:  [-6.95728512]
curr_Stock_Price:  98.74150932964642
curr_Factors:  [98.74150933]
mat_Sqrt:  [[0.15]]
grads:  [0.02001508]
Stock Position:  0.020015075967914884
Bond Position:  [-8.93360393]


portfolio before change:  [-6.97507648]
curr_Stock_Price:  97.88050849360587
curr_Factors:  [97.88050849]
mat_Sqrt:  [[0.15]]
grads:  [0.13079335]
Stock Position:  0.13079334903448853
Bond Position:  [-19.777196]


portfolio before change:  [-6.90473283]
curr_Stock_Price:  98.4277822291716
curr_Factors:  [98.42778223]
mat_Sqrt:  [[0.15]]
grads:  [0.03018068]
Stock Position:  0.030180675438320412
Bond Position:  [-9.87534978]


portfolio before change:  [-6.93104756]
curr_Stock_Price:  97.57632696813779
curr_Factors:  [97.57632697]
mat_Sqrt:  [[0.15]]
grads:  [0.08079367]
Stock Position:  0.08079367309549146
Bond Position:  [-14.81459742]


portfolio before change:  [-6.93081856]
curr_Stock_Price:  97.59062190316757
curr_Factors:  [97.5906219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00699697]
Stock Position:  -0.006996972569588538
Bond Position:  [-6.24797965]


portfolio before change:  [-6.93624303]
curr_Stock_Price:  98.31007064399523
curr_Factors:  [98.31007064]
mat_Sqrt:  [[0.15]]
grads:  [0.01741619]
Stock Position:  0.017416194862991775
Bond Position:  [-8.64843038]


portfolio before change:  [-6.94247462]
curr_Stock_Price:  97.98330300850856
curr_Factors:  [97.98330301]
mat_Sqrt:  [[0.15]]
grads:  [0.15146966]
Stock Position:  0.1514696573604224
Bond Position:  [-21.78397196]


portfolio before change:  [-6.87024343]
curr_Stock_Price:  98.46916093658632
curr_Factors:  [98.46916094]
mat_Sqrt:  [[0.15]]
grads:  [0.01864508]
Stock Position:  0.01864507660524666
Bond Position:  [-8.70620848]


portfolio before change:  [-6.85548154]
curr_Stock_Price:  99.29007742195265
curr_Factors:  [99.29007742]
mat_Sqrt:  [[0.15]]
grads:  [-0.10634605]
Stock Position:  -0.10634604549458869
Bond Position:  [3.70362556]


portfolio before change:  [-6.75459659]
curr_Stock_Price:  98.34360625298436
curr_Factors:  [98.34360625]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102993]
Stock Position:  -0.041029933388324474
Bond Position:  [-2.71956497]


portfolio before change:  [-6.7356954]
curr_Stock_Price:  97.87879515776245
curr_Factors:  [97.87879516]
mat_Sqrt:  [[0.15]]
grads:  [0.00783092]
Stock Position:  0.00783091961775271
Bond Position:  [-7.50217637]


portfolio before change:  [-6.73529674]
curr_Stock_Price:  97.98958106484788
curr_Factors:  [97.98958106]
mat_Sqrt:  [[0.15]]
grads:  [0.0513566]
Stock Position:  0.05135660352104329
Bond Position:  [-11.7677088]


portfolio before change:  [-6.7212716]
curr_Stock_Price:  98.27699590421594
curr_Factors:  [98.2769959]
mat_Sqrt:  [[0.15]]
grads:  [-0.00049853]
Stock Position:  -0.0004985310781982499
Bond Position:  [-6.67227746]


portfolio before change:  [-6.72152687]
curr_Stock_Price:  97.95252530663277
curr_Factors:  [97.95252531]
mat_Sqrt:  [[0.15]]
grads:  [-0.00994951]
Stock Position:  -0.009949513805411835
Bond Position:  [-5.74694686]


portfolio before change:  [-6.7193693]
curr_Stock_Price:  97.6995715948706
curr_Factors:  [97.69957159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251586]
Stock Position:  -0.03251585608126595
Bond Position:  [-3.54258409]


portfolio before change:  [-6.70131721]
curr_Stock_Price:  97.13758417055573
curr_Factors:  [97.13758417]
mat_Sqrt:  [[0.15]]
grads:  [-0.15177036]
Stock Position:  -0.15177036496714263
Bond Position:  [8.04128939]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.6575617]
Stock Price:  96.8525949566289
PL:  [-6.6575617]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.36761987e-02]
 [ 6.93485255e-03]
 [ 1.26550579e-02]
 [-1.08407618e-02]
 [ 1.27925220e-02]
 [-7.31351923e-03]
 [-2.60025310e-03]
 [-1.62775332e-02]
 [-1.59516967e-02]
 [-1.29669800e-02]
 [ 1.00374212e-02]
 [-7.41907521e-03]
 [-8.23127036e-05]
 [ 5.97015480e-03]
 [-2.17520131e-03]
 [ 6.26561828e-03]
 [ 1.06277597e-03]
 [-1.43760549e-02]
 [ 1.93620210e-02]
 [ 1.84913910e-03]
 [-4.33235084e-03]
 [ 5.31178936e-03]
 [ 1.54809861e-02]
 [ 2.09650788e-02]
 [-9.94155482e-04]
 [ 4.41506827e-03]
 [ 1.53758625e-03]
 [ 9.12282149e-03]
 [ 1.58588681e-02]
 [ 1.74292641e-02]
 [-6.43224371e-03]
 [ 1.46994329e-02]
 [ 1.14651415e-02]
 [-2.00947051e-02]
 [-7.70341974e-04]
 [ 1.82792301e-02]
 [ 5.80981275e-03]
 [ 6.66174551e-04]
 [-2.96598201e-02]
 [-1.49282398e-02]
 [ 7.09614065e-03]
 [ 2.74565848e-02]
 [-3.15653009e-03]
 [ 7.79981236e-03]
 [-2.40275650e-02]
 [ 1.73784690e-02]
 [ 1.01729777e-02]
 [ 5.31798074e-03]
 [-7.82353586e-03]
 [-1.86938999e-04]
 [-2.65349494e-03]
 [-2.78232267e-03]
 [-9.57103150e-04]
 [ 4.53125215e-03]
 [-2.04469139e-02]
 [-5.64831955e-03]
 [-6.20388374e-03]
 [ 1.42111164e-02]
 [ 6.30438162e-03]
 [-2.28907330e-03]
 [-5.14061880e-03]
 [-3.31959088e-03]
 [ 2.00750897e-04]
 [-5.35024762e-03]
 [ 1.82037286e-02]
 [ 6.60125840e-03]
 [ 2.03089069e-02]
 [-3.86102771e-03]
 [ 6.22255368e-03]
 [ 2.41975398e-02]
 [ 3.37439746e-03]
 [-1.54413440e-02]
 [-5.59216165e-03]
 [ 1.83147475e-03]
 [ 9.63085497e-03]
 [ 1.32015198e-03]
 [-1.60913908e-03]
 [-5.32689736e-03]
 [-2.31580693e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.9267685]
curr_Stock_Price:  99.63862389861426
curr_Factors:  [99.6386239]
mat_Sqrt:  [[0.15]]
grads:  [-0.09117466]
Stock Position:  -0.09117465812408829
Bond Position:  [3.15774897]


portfolio before change:  [-5.94348071]
curr_Stock_Price:  99.82408747700329
curr_Factors:  [99.82408748]
mat_Sqrt:  [[0.15]]
grads:  [0.04623235]
Stock Position:  0.046232350326562505
Bond Position:  [-10.55858289]


portfolio before change:  [-5.96631647]
curr_Stock_Price:  99.34442700707037
curr_Factors:  [99.34442701]
mat_Sqrt:  [[0.15]]
grads:  [0.08436705]
Stock Position:  0.08436705238947023
Bond Position:  [-14.34771295]


portfolio before change:  [-5.99184523]
curr_Stock_Price:  99.05246475888259
curr_Factors:  [99.05246476]
mat_Sqrt:  [[0.15]]
grads:  [-0.07227175]
Stock Position:  -0.07227174545222632
Bond Position:  [1.16684929]


portfolio before change:  [-6.04616359]
curr_Stock_Price:  99.80505885801655
curr_Factors:  [99.80505886]
mat_Sqrt:  [[0.15]]
grads:  [0.08528348]
Stock Position:  0.0852834797410424
Bond Position:  [-14.5578863]


portfolio before change:  [-6.0423427]
curr_Stock_Price:  99.86053019795673
curr_Factors:  [99.8605302]
mat_Sqrt:  [[0.15]]
grads:  [-0.04875679]
Stock Position:  -0.04875679489855094
Bond Position:  [-1.17346331]


portfolio before change:  [-6.0716749]
curr_Stock_Price:  100.46062840410168
curr_Factors:  [100.4606284]
mat_Sqrt:  [[0.15]]
grads:  [-0.01733502]
Stock Position:  -0.017335020657701837
Bond Position:  [-4.33018784]


portfolio before change:  [-6.07224894]
curr_Stock_Price:  100.47813001294055
curr_Factors:  [100.47813001]
mat_Sqrt:  [[0.15]]
grads:  [-0.10851689]
Stock Position:  -0.10851688791602809
Bond Position:  [4.83132503]


portfolio before change:  [-5.91706174]
curr_Stock_Price:  99.05083849076397
curr_Factors:  [99.05083849]
mat_Sqrt:  [[0.15]]
grads:  [-0.10634464]
Stock Position:  -0.10634464471129923
Bond Position:  [4.61646449]


portfolio before change:  [-5.83617215]
curr_Stock_Price:  98.29291550206194
curr_Factors:  [98.2929155]
mat_Sqrt:  [[0.15]]
grads:  [-0.08644653]
Stock Position:  -0.08644653334245742
Bond Position:  [2.66090965]


portfolio before change:  [-5.83668797]
curr_Stock_Price:  98.30080628991077
curr_Factors:  [98.30080629]
mat_Sqrt:  [[0.15]]
grads:  [0.06691614]
Stock Position:  0.06691614132631898
Bond Position:  [-12.41459861]


portfolio before change:  [-5.81485501]
curr_Stock_Price:  98.6386754078886
curr_Factors:  [98.63867541]
mat_Sqrt:  [[0.15]]
grads:  [-0.0494605]
Stock Position:  -0.049460501416715014
Bond Position:  [-0.93613666]


portfolio before change:  [-5.82456603]
curr_Stock_Price:  98.83383144357721
curr_Factors:  [98.83383144]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054875]
Stock Position:  -0.0005487513572082053
Bond Position:  [-5.77033083]


portfolio before change:  [-5.82518019]
curr_Stock_Price:  99.29578464981576
curr_Factors:  [99.29578465]
mat_Sqrt:  [[0.15]]
grads:  [0.03980103]
Stock Position:  0.03980103199040191
Bond Position:  [-9.77725489]


portfolio before change:  [-5.83619282]
curr_Stock_Price:  99.03444626436061
curr_Factors:  [99.03444626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01450134]
Stock Position:  -0.01450134209413202
Bond Position:  [-4.40006044]


portfolio before change:  [-5.82623773]
curr_Stock_Price:  98.32898720868873
curr_Factors:  [98.32898721]
mat_Sqrt:  [[0.15]]
grads:  [0.04177079]
Stock Position:  0.04177078852589942
Bond Position:  [-9.93351706]


portfolio before change:  [-5.81699899]
curr_Stock_Price:  98.565027966414
curr_Factors:  [98.56502797]
mat_Sqrt:  [[0.15]]
grads:  [0.00708517]
Stock Position:  0.007085173126763304
Bond Position:  [-6.51534928]


portfolio before change:  [-5.81465941]
curr_Stock_Price:  98.9527101552356
curr_Factors:  [98.95271016]
mat_Sqrt:  [[0.15]]
grads:  [-0.09584037]
Stock Position:  -0.09584036588730104
Bond Position:  [3.66900453]


portfolio before change:  [-5.94985188]
curr_Stock_Price:  100.36570334162522
curr_Factors:  [100.36570334]
mat_Sqrt:  [[0.15]]
grads:  [0.12908014]
Stock Position:  0.12908013988617106
Bond Position:  [-18.90507091]


portfolio before change:  [-5.86745391]
curr_Stock_Price:  101.01320475972547
curr_Factors:  [101.01320476]
mat_Sqrt:  [[0.15]]
grads:  [0.01232759]
Stock Position:  0.012327593994056179
Bond Position:  [-7.11270368]


portfolio before change:  [-5.87260057]
curr_Stock_Price:  100.63177543667867
curr_Factors:  [100.63177544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02888234]
Stock Position:  -0.02888233890782173
Bond Position:  [-2.96611953]


portfolio before change:  [-5.82648223]
curr_Stock_Price:  99.02859051075085
curr_Factors:  [99.02859051]
mat_Sqrt:  [[0.15]]
grads:  [0.03541193]
Stock Position:  0.03541192907008322
Bond Position:  [-9.33327565]


portfolio before change:  [-5.84923638]
curr_Stock_Price:  98.40250775697174
curr_Factors:  [98.40250776]
mat_Sqrt:  [[0.15]]
grads:  [0.10320657]
Stock Position:  0.10320657391334898
Bond Position:  [-16.00502207]


portfolio before change:  [-5.91909609]
curr_Stock_Price:  97.73530834928899
curr_Factors:  [97.73530835]
mat_Sqrt:  [[0.15]]
grads:  [0.13976719]
Stock Position:  0.13976719224502762
Bond Position:  [-19.57928572]


portfolio before change:  [-5.89646412]
curr_Stock_Price:  97.90599008859577
curr_Factors:  [97.90599009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0066277]
Stock Position:  -0.0066277032138052526
Bond Position:  [-5.24757228]


portfolio before change:  [-5.89406685]
curr_Stock_Price:  97.49479888220328
curr_Factors:  [97.49479888]
mat_Sqrt:  [[0.15]]
grads:  [0.02943379]
Stock Position:  0.02943378847144796
Bond Position:  [-8.76370814]


portfolio before change:  [-5.89305481]
curr_Stock_Price:  97.54779204518788
curr_Factors:  [97.54779205]
mat_Sqrt:  [[0.15]]
grads:  [0.01025058]
Stock Position:  0.010250575005313496
Bond Position:  [-6.89297577]


portfolio before change:  [-5.88892628]
curr_Stock_Price:  97.99258230367056
curr_Factors:  [97.9925823]
mat_Sqrt:  [[0.15]]
grads:  [0.06081881]
Stock Position:  0.06081880991444976
Bond Position:  [-11.84871852]


portfolio before change:  [-5.87398711]
curr_Stock_Price:  98.25039300510993
curr_Factors:  [98.25039301]
mat_Sqrt:  [[0.15]]
grads:  [0.10572579]
Stock Position:  0.10572578741379596
Bond Position:  [-16.26158727]


portfolio before change:  [-5.90205648]
curr_Stock_Price:  97.99451416063648
curr_Factors:  [97.99451416]
mat_Sqrt:  [[0.15]]
grads:  [0.11619509]
Stock Position:  0.11619509410511929
Bond Position:  [-17.28853828]


portfolio before change:  [-5.83264391]
curr_Stock_Price:  98.60119332901513
curr_Factors:  [98.60119333]
mat_Sqrt:  [[0.15]]
grads:  [-0.04288162]
Stock Position:  -0.042881624729004475
Bond Position:  [-1.60446454]


portfolio before change:  [-5.81046882]
curr_Stock_Price:  98.08173145067724
curr_Factors:  [98.08173145]
mat_Sqrt:  [[0.15]]
grads:  [0.09799622]
Stock Position:  0.09799621960594208
Bond Position:  [-15.42210771]


portfolio before change:  [-5.76621092]
curr_Stock_Price:  98.54319625887828
curr_Factors:  [98.54319626]
mat_Sqrt:  [[0.15]]
grads:  [0.07643428]
Stock Position:  0.07643427667450786
Bond Position:  [-13.29828885]


portfolio before change:  [-5.80902233]
curr_Stock_Price:  97.99396309060126
curr_Factors:  [97.99396309]
mat_Sqrt:  [[0.15]]
grads:  [-0.1339647]
Stock Position:  -0.13396470044314765
Bond Position:  [7.31870958]


portfolio before change:  [-5.90881391]
curr_Stock_Price:  98.74228719353523
curr_Factors:  [98.74228719]
mat_Sqrt:  [[0.15]]
grads:  [-0.00513561]
Stock Position:  -0.005135613160263715
Bond Position:  [-5.40171172]


portfolio before change:  [-5.90741604]
curr_Stock_Price:  98.40435461227337
curr_Factors:  [98.40435461]
mat_Sqrt:  [[0.15]]
grads:  [0.12186153]
Stock Position:  0.12186153399604174
Bond Position:  [-17.89912165]


portfolio before change:  [-5.94924715]
curr_Stock_Price:  98.07026744528903
curr_Factors:  [98.07026745]
mat_Sqrt:  [[0.15]]
grads:  [0.03873209]
Stock Position:  0.038732085001826205
Bond Position:  [-9.74771308]


portfolio before change:  [-5.94202867]
curr_Stock_Price:  98.27236677050377
curr_Factors:  [98.27236677]
mat_Sqrt:  [[0.15]]
grads:  [0.00444116]
Stock Position:  0.004441163670106848
Bond Position:  [-6.37847233]


portfolio before change:  [-5.94561782]
curr_Stock_Price:  97.55397640167256
curr_Factors:  [97.5539764]
mat_Sqrt:  [[0.15]]
grads:  [-0.19773213]
Stock Position:  -0.19773213426780722
Bond Position:  [13.34393814]


portfolio before change:  [-6.0055144]
curr_Stock_Price:  97.86111208146579
curr_Factors:  [97.86111208]
mat_Sqrt:  [[0.15]]
grads:  [-0.0995216]
Stock Position:  -0.09952159865335374
Bond Position:  [3.73377992]


portfolio before change:  [-5.9622]
curr_Stock_Price:  97.42823090509812
curr_Factors:  [97.42823091]
mat_Sqrt:  [[0.15]]
grads:  [0.0473076]
Stock Position:  0.04730760433121117
Bond Position:  [-10.5712962]


portfolio before change:  [-5.93801614]
curr_Stock_Price:  97.95340195630637
curr_Factors:  [97.95340196]
mat_Sqrt:  [[0.15]]
grads:  [0.1830439]
Stock Position:  0.18304389887373418
Bond Position:  [-23.86778874]


portfolio before change:  [-6.0377807]
curr_Stock_Price:  97.4165210757563
curr_Factors:  [97.41652108]
mat_Sqrt:  [[0.15]]
grads:  [-0.02104353]
Stock Position:  -0.021043533911877552
Bond Position:  [-3.98779283]


portfolio before change:  [-6.02702013]
curr_Stock_Price:  96.89332880182515
curr_Factors:  [96.8933288]
mat_Sqrt:  [[0.15]]
grads:  [0.05199875]
Stock Position:  0.0519987490564134
Bond Position:  [-11.06535202]


portfolio before change:  [-6.0218859]
curr_Stock_Price:  97.00536675057161
curr_Factors:  [97.00536675]
mat_Sqrt:  [[0.15]]
grads:  [-0.16018377]
Stock Position:  -0.16018376651675417
Bond Position:  [9.51679912]


portfolio before change:  [-6.11612987]
curr_Stock_Price:  97.597429166402
curr_Factors:  [97.59742917]
mat_Sqrt:  [[0.15]]
grads:  [0.11585646]
Stock Position:  0.11585645966734523
Bond Position:  [-17.42342248]


portfolio before change:  [-6.09395898]
curr_Stock_Price:  97.7981938499473
curr_Factors:  [97.79819385]
mat_Sqrt:  [[0.15]]
grads:  [0.06781985]
Stock Position:  0.06781985133103008
Bond Position:  [-12.72661795]


portfolio before change:  [-6.16023753]
curr_Stock_Price:  96.83264894475191
curr_Factors:  [96.83264894]
mat_Sqrt:  [[0.15]]
grads:  [0.0354532]
Stock Position:  0.035453204952226425
Bond Position:  [-9.59326528]


portfolio before change:  [-6.15500025]
curr_Stock_Price:  96.99728521365378
curr_Factors:  [96.99728521]
mat_Sqrt:  [[0.15]]
grads:  [-0.05215691]
Stock Position:  -0.052156905759674285
Bond Position:  [-1.09592198]


portfolio before change:  [-6.12843495]
curr_Stock_Price:  96.48663778423224
curr_Factors:  [96.48663778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00124626]
Stock Position:  -0.0012462599941294732
Bond Position:  [-6.00818752]


portfolio before change:  [-6.12781547]
curr_Stock_Price:  95.6882420529357
curr_Factors:  [95.68824205]
mat_Sqrt:  [[0.15]]
grads:  [-0.01768997]
Stock Position:  -0.01768996629769359
Bond Position:  [-4.43509369]


portfolio before change:  [-6.12421532]
curr_Stock_Price:  95.4690584265354
curr_Factors:  [95.46905843]
mat_Sqrt:  [[0.15]]
grads:  [-0.01854882]
Stock Position:  -0.01854881782130441
Bond Position:  [-4.35337715]


portfolio before change:  [-6.11088988]
curr_Stock_Price:  94.7359912645379
curr_Factors:  [94.73599126]
mat_Sqrt:  [[0.15]]
grads:  [-0.00638069]
Stock Position:  -0.006380687669818726
Bond Position:  [-5.50640911]


portfolio before change:  [-6.11094173]
curr_Stock_Price:  94.6901782279694
curr_Factors:  [94.69017823]
mat_Sqrt:  [[0.15]]
grads:  [0.03020835]
Stock Position:  0.030208347654385057
Bond Position:  [-8.97137555]


portfolio before change:  [-6.14149351]
curr_Stock_Price:  93.69737146135232
curr_Factors:  [93.69737146]
mat_Sqrt:  [[0.15]]
grads:  [-0.13631276]
Stock Position:  -0.13631275935548434
Bond Position:  [6.63065374]


portfolio before change:  [-6.11724703]
curr_Stock_Price:  93.52253786586911
curr_Factors:  [93.52253787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765546]
Stock Position:  -0.037655463667878246
Bond Position:  [-2.5956125]


portfolio before change:  [-6.12605334]
curr_Stock_Price:  93.75209492371486
curr_Factors:  [93.75209492]
mat_Sqrt:  [[0.15]]
grads:  [-0.04135922]
Stock Position:  -0.04135922491040961
Bond Position:  [-2.24853936]


portfolio before change:  [-6.13868306]
curr_Stock_Price:  94.05406349133432
curr_Factors:  [94.05406349]
mat_Sqrt:  [[0.15]]
grads:  [0.09474078]
Stock Position:  0.09474077579665387
Bond Position:  [-15.049438]


portfolio before change:  [-6.09549667]
curr_Stock_Price:  94.51982922936212
curr_Factors:  [94.51982923]
mat_Sqrt:  [[0.15]]
grads:  [0.04202921]
Stock Position:  0.04202921081338933
Bond Position:  [-10.0680905]


portfolio before change:  [-6.10877356]
curr_Stock_Price:  94.21890493666443
curr_Factors:  [94.21890494]
mat_Sqrt:  [[0.15]]
grads:  [-0.01526049]
Stock Position:  -0.015260488681112147
Bond Position:  [-4.67094703]


portfolio before change:  [-6.11431682]
curr_Stock_Price:  94.56301681380398
curr_Factors:  [94.56301681]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427079]
Stock Position:  -0.03427079200196386
Bond Position:  [-2.87356734]


portfolio before change:  [-6.11163776]
curr_Stock_Price:  94.4796028359447
curr_Factors:  [94.47960284]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213061]
Stock Position:  -0.022130605852981832
Bond Position:  [-4.02074691]


portfolio before change:  [-6.11303809]
curr_Stock_Price:  94.53152306537568
curr_Factors:  [94.53152307]
mat_Sqrt:  [[0.15]]
grads:  [0.00133834]
Stock Position:  0.0013383393107588178
Bond Position:  [-6.23955334]


portfolio before change:  [-6.11316227]
curr_Stock_Price:  94.73012717164087
curr_Factors:  [94.73012717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03566832]
Stock Position:  -0.03566831745697394
Bond Position:  [-2.73429802]


portfolio before change:  [-6.13544444]
curr_Stock_Price:  95.35004055576073
curr_Factors:  [95.35004056]
mat_Sqrt:  [[0.15]]
grads:  [0.12135819]
Stock Position:  0.12135819066218824
Bond Position:  [-17.70695284]


portfolio before change:  [-6.14862376]
curr_Stock_Price:  95.25056147637895
curr_Factors:  [95.25056148]
mat_Sqrt:  [[0.15]]
grads:  [0.04400839]
Stock Position:  0.044008389314167125
Bond Position:  [-10.34044755]


portfolio before change:  [-6.15489294]
curr_Stock_Price:  95.12279296328478
curr_Factors:  [95.12279296]
mat_Sqrt:  [[0.15]]
grads:  [0.13539271]
Stock Position:  0.1353927127395271
Bond Position:  [-19.03382593]


portfolio before change:  [-6.16083754]
curr_Stock_Price:  95.08767333647539
curr_Factors:  [95.08767334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574018]
Stock Position:  -0.02574018471773777
Bond Position:  [-3.71326326]


portfolio before change:  [-6.1782823]
curr_Stock_Price:  95.75638160088853
curr_Factors:  [95.7563816]
mat_Sqrt:  [[0.15]]
grads:  [0.04148369]
Stock Position:  0.041483691204714526
Bond Position:  [-10.15061046]


portfolio before change:  [-6.14976842]
curr_Stock_Price:  96.45902657940195
curr_Factors:  [96.45902658]
mat_Sqrt:  [[0.15]]
grads:  [0.16131693]
Stock Position:  0.16131693188421653
Bond Position:  [-21.71024264]


portfolio before change:  [-6.09560866]
curr_Stock_Price:  96.80317334362704
curr_Factors:  [96.80317334]
mat_Sqrt:  [[0.15]]
grads:  [0.02249598]
Stock Position:  0.022495983093322708
Bond Position:  [-8.27329121]


portfolio before change:  [-6.09872522]
curr_Stock_Price:  96.68762095910643
curr_Factors:  [96.68762096]
mat_Sqrt:  [[0.15]]
grads:  [-0.10294229]
Stock Position:  -0.10294229319242529
Bond Position:  [3.85452021]


portfolio before change:  [-6.1246147]
curr_Stock_Price:  96.9414563995689
curr_Factors:  [96.9414564]
mat_Sqrt:  [[0.15]]
grads:  [-0.03728108]
Stock Position:  -0.037281077671775985
Bond Position:  [-2.51053274]


portfolio before change:  [-6.11274366]
curr_Stock_Price:  96.61882724366419
curr_Factors:  [96.61882724]
mat_Sqrt:  [[0.15]]
grads:  [0.01220983]
Stock Position:  0.012209831643695272
Bond Position:  [-7.29244327]


portfolio before change:  [-6.10999854]
curr_Stock_Price:  96.88098559349143
curr_Factors:  [96.88098559]
mat_Sqrt:  [[0.15]]
grads:  [0.0642057]
Stock Position:  0.06420569977431531
Bond Position:  [-12.33031001]


portfolio before change:  [-6.08499074]
curr_Stock_Price:  97.28248362556083
curr_Factors:  [97.28248363]
mat_Sqrt:  [[0.15]]
grads:  [0.00880101]
Stock Position:  0.008801013226834657
Bond Position:  [-6.94117517]


portfolio before change:  [-6.08544169]
curr_Stock_Price:  97.28053908594619
curr_Factors:  [97.28053909]
mat_Sqrt:  [[0.15]]
grads:  [-0.01072759]
Stock Position:  -0.01072759389276744
Bond Position:  [-5.04185558]


portfolio before change:  [-6.0894406]
curr_Stock_Price:  97.62393175987718
curr_Factors:  [97.62393176]
mat_Sqrt:  [[0.15]]
grads:  [-0.03551265]
Stock Position:  -0.03551264906074004
Bond Position:  [-2.62255617]


portfolio before change:  [-6.09061989]
curr_Stock_Price:  97.65252377805415
curr_Factors:  [97.65252378]
mat_Sqrt:  [[0.15]]
grads:  [-0.15438713]
Stock Position:  -0.15438712891748563
Bond Position:  [8.98567289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.06484361]
Stock Price:  97.48920281279011
PL:  [-6.06484361]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.07404222e-03]
 [ 7.72658894e-03]
 [ 8.60762893e-03]
 [-9.15041736e-03]
 [ 1.52644842e-02]
 [-1.09248518e-02]
 [-3.43717629e-03]
 [-4.65451037e-04]
 [-1.46820356e-02]
 [-1.26163517e-02]
 [ 1.32506187e-02]
 [-5.68997687e-03]
 [-7.48169383e-04]
 [ 4.97915555e-03]
 [ 2.84684028e-04]
 [ 1.22966698e-02]
 [ 1.31531264e-02]
 [-1.52056467e-02]
 [ 2.15407642e-02]
 [ 2.20384876e-03]
 [-4.02261353e-03]
 [ 4.11336168e-03]
 [ 1.50161008e-02]
 [ 1.75815257e-02]
 [-4.75595244e-03]
 [ 4.67706453e-03]
 [ 9.04267415e-03]
 [ 8.46757469e-03]
 [ 1.57530289e-02]
 [ 8.22426497e-03]
 [-7.05194881e-03]
 [ 2.09167992e-02]
 [ 1.24659862e-02]
 [-1.98416248e-02]
 [-1.28731455e-02]
 [-1.04727013e-02]
 [ 1.16861437e-02]
 [-1.74545473e-03]
 [ 2.11679412e-02]
 [ 5.04819698e-03]
 [ 6.95916317e-03]
 [ 3.52827616e-02]
 [-3.37394938e-03]
 [ 2.06007423e-02]
 [-5.58994821e-02]
 [ 2.63292551e-02]
 [ 8.93280953e-03]
 [ 5.39760783e-03]
 [-1.15193552e-02]
 [ 1.62423739e-04]
 [-5.71163567e-04]
 [-3.78886723e-03]
 [-9.97526152e-04]
 [ 3.99545361e-03]
 [-1.50875399e-02]
 [-5.45664042e-03]
 [-5.19919373e-03]
 [ 1.38326042e-02]
 [ 6.53170052e-03]
 [-2.51306283e-03]
 [-5.12761289e-03]
 [-3.14780007e-03]
 [ 9.02121734e-05]
 [-5.43562467e-03]
 [ 1.78944219e-02]
 [ 8.07304853e-03]
 [ 2.04450274e-02]
 [-4.15727646e-03]
 [ 8.39568367e-03]
 [ 2.86158067e-02]
 [ 3.10800314e-03]
 [-1.50051265e-02]
 [-6.02499979e-03]
 [ 3.45813123e-03]
 [ 1.24348683e-02]
 [ 2.04236314e-02]
 [ 5.37968746e-03]
 [-3.69378532e-02]
 [-2.51525555e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.89647345]
curr_Stock_Price:  100.26644722006478
curr_Factors:  [100.26644722]
mat_Sqrt:  [[0.15]]
grads:  [-0.02049361]
Stock Position:  -0.020493614769957022
Bond Position:  [9.95129539]


portfolio before change:  [7.90542176]
curr_Stock_Price:  99.86015787933754
curr_Factors:  [99.86015788]
mat_Sqrt:  [[0.15]]
grads:  [0.05151059]
Stock Position:  0.051510592960412355
Bond Position:  [2.76156582]


portfolio before change:  [7.92585961]
curr_Stock_Price:  100.25357683501827
curr_Factors:  [100.25357684]
mat_Sqrt:  [[0.15]]
grads:  [0.05738419]
Stock Position:  0.0573841928392514
Bond Position:  [2.17288902]


portfolio before change:  [7.89929373]
curr_Stock_Price:  99.78826250035259
curr_Factors:  [99.7882625]
mat_Sqrt:  [[0.15]]
grads:  [-0.06100278]
Stock Position:  -0.06100278240092139
Bond Position:  [13.98665539]


portfolio before change:  [7.90995983]
curr_Stock_Price:  99.62774682668655
curr_Factors:  [99.62774683]
mat_Sqrt:  [[0.15]]
grads:  [0.10176323]
Stock Position:  0.1017632281219724
Bond Position:  [-2.2284813]


portfolio before change:  [7.90130209]
curr_Stock_Price:  99.54403833078285
curr_Factors:  [99.54403833]
mat_Sqrt:  [[0.15]]
grads:  [-0.07283235]
Stock Position:  -0.0728323456181554
Bond Position:  [15.1513279]


portfolio before change:  [7.92536109]
curr_Stock_Price:  99.2267066913792
curr_Factors:  [99.22670669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02291451]
Stock Position:  -0.022914508612700384
Bond Position:  [10.19909232]


portfolio before change:  [7.91848863]
curr_Stock_Price:  99.55444324001013
curr_Factors:  [99.55444324]
mat_Sqrt:  [[0.15]]
grads:  [-0.00310301]
Stock Position:  -0.0031030069102237537
Bond Position:  [8.22740676]


portfolio before change:  [7.92000981]
curr_Stock_Price:  99.22993429498466
curr_Factors:  [99.22993429]
mat_Sqrt:  [[0.15]]
grads:  [-0.09788024]
Stock Position:  -0.0978802371711973
Bond Position:  [17.63265932]


portfolio before change:  [7.96692374]
curr_Stock_Price:  98.76189449913927
curr_Factors:  [98.7618945]
mat_Sqrt:  [[0.15]]
grads:  [-0.08410901]
Stock Position:  -0.0841090110977779
Bond Position:  [16.27368902]


portfolio before change:  [7.93193637]
curr_Stock_Price:  99.18996398100477
curr_Factors:  [99.18996398]
mat_Sqrt:  [[0.15]]
grads:  [0.08833746]
Stock Position:  0.08833745774406107
Bond Position:  [-0.83025288]


portfolio before change:  [7.95986919]
curr_Stock_Price:  99.5067571745242
curr_Factors:  [99.50675717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793318]
Stock Position:  -0.037933179159147484
Bond Position:  [11.73447683]


portfolio before change:  [7.96960143]
curr_Stock_Price:  99.26952901330962
curr_Factors:  [99.26952901]
mat_Sqrt:  [[0.15]]
grads:  [-0.0049878]
Stock Position:  -0.004987795887387396
Bond Position:  [8.46473758]


portfolio before change:  [7.97086019]
curr_Stock_Price:  99.12323345509948
curr_Factors:  [99.12323346]
mat_Sqrt:  [[0.15]]
grads:  [0.03319437]
Stock Position:  0.03319437033593261
Bond Position:  [4.68052687]


portfolio before change:  [7.98648277]
curr_Stock_Price:  99.58505988869321
curr_Factors:  [99.58505989]
mat_Sqrt:  [[0.15]]
grads:  [0.00189789]
Stock Position:  0.0018978935169082964
Bond Position:  [7.79748093]


portfolio before change:  [7.98711221]
curr_Stock_Price:  99.65992757119083
curr_Factors:  [99.65992757]
mat_Sqrt:  [[0.15]]
grads:  [0.0819778]
Stock Position:  0.08197779864855642
Bond Position:  [-0.18278926]


portfolio before change:  [7.93508183]
curr_Stock_Price:  99.02537817283097
curr_Factors:  [99.02537817]
mat_Sqrt:  [[0.15]]
grads:  [0.08768751]
Stock Position:  0.08768750965765844
Bond Position:  [-0.74820698]


portfolio before change:  [7.97688382]
curr_Stock_Price:  99.50262690724514
curr_Factors:  [99.50262691]
mat_Sqrt:  [[0.15]]
grads:  [-0.10137098]
Stock Position:  -0.10137097786480333
Bond Position:  [18.06356241]


portfolio before change:  [7.98596483]
curr_Stock_Price:  99.42418228432737
curr_Factors:  [99.42418228]
mat_Sqrt:  [[0.15]]
grads:  [0.14360509]
Stock Position:  0.14360509480163713
Bond Position:  [-6.29185429]


portfolio before change:  [8.01701942]
curr_Stock_Price:  99.64317059448885
curr_Factors:  [99.64317059]
mat_Sqrt:  [[0.15]]
grads:  [0.01469233]
Stock Position:  0.014692325056615977
Bond Position:  [6.55302956]


portfolio before change:  [8.02213472]
curr_Stock_Price:  99.9634552456848
curr_Factors:  [99.96345525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681742]
Stock Position:  -0.026817423552872185
Bond Position:  [10.70289704]


portfolio before change:  [8.01556114]
curr_Stock_Price:  100.2335232203383
curr_Factors:  [100.23352322]
mat_Sqrt:  [[0.15]]
grads:  [0.02742241]
Stock Position:  0.027422411226307234
Bond Position:  [5.26691625]


portfolio before change:  [8.01753876]
curr_Stock_Price:  100.29363551260548
curr_Factors:  [100.29363551]
mat_Sqrt:  [[0.15]]
grads:  [0.10010734]
Stock Position:  0.10010733896509165
Bond Position:  [-2.02259021]


portfolio before change:  [7.95536951]
curr_Stock_Price:  99.67387238893362
curr_Factors:  [99.67387239]
mat_Sqrt:  [[0.15]]
grads:  [0.11721017]
Stock Position:  0.11721017148974114
Bond Position:  [-3.72742217]


portfolio before change:  [8.00388774]
curr_Stock_Price:  100.08980219243973
curr_Factors:  [100.08980219]
mat_Sqrt:  [[0.15]]
grads:  [-0.03170635]
Stock Position:  -0.031706349570569524
Bond Position:  [11.17737]


portfolio before change:  [8.00819224]
curr_Stock_Price:  99.97607444980267
curr_Factors:  [99.97607445]
mat_Sqrt:  [[0.15]]
grads:  [0.03118043]
Stock Position:  0.031180430181375667
Bond Position:  [4.89089523]


portfolio before change:  [7.97937257]
curr_Stock_Price:  99.04198337025005
curr_Factors:  [99.04198337]
mat_Sqrt:  [[0.15]]
grads:  [0.06028449]
Stock Position:  0.06028449435022679
Bond Position:  [2.00867668]


portfolio before change:  [7.95497762]
curr_Stock_Price:  98.63523709533789
curr_Factors:  [98.6352371]
mat_Sqrt:  [[0.15]]
grads:  [0.0564505]
Stock Position:  0.05645049795184464
Bond Position:  [2.38696937]


portfolio before change:  [7.95266262]
curr_Stock_Price:  98.5915848331109
curr_Factors:  [98.59158483]
mat_Sqrt:  [[0.15]]
grads:  [0.10502019]
Stock Position:  0.10502019242493776
Bond Position:  [-2.40144459]


portfolio before change:  [7.93547035]
curr_Stock_Price:  98.42930965440016
curr_Factors:  [98.42930965]
mat_Sqrt:  [[0.15]]
grads:  [0.05482843]
Stock Position:  0.05482843312695513
Bond Position:  [2.53874553]


portfolio before change:  [7.87576906]
curr_Stock_Price:  97.33754096432307
curr_Factors:  [97.33754096]
mat_Sqrt:  [[0.15]]
grads:  [-0.04701299]
Stock Position:  -0.04701299206213403
Bond Position:  [12.4518981]


portfolio before change:  [7.90958773]
curr_Stock_Price:  96.63474796726214
curr_Factors:  [96.63474797]
mat_Sqrt:  [[0.15]]
grads:  [0.13944533]
Stock Position:  0.1394453279611732
Bond Position:  [-5.56567639]


portfolio before change:  [7.89737176]
curr_Stock_Price:  96.54963860372322
curr_Factors:  [96.5496386]
mat_Sqrt:  [[0.15]]
grads:  [0.08310657]
Stock Position:  0.08310657454236647
Bond Position:  [-0.12653797]


portfolio before change:  [7.90505072]
curr_Stock_Price:  96.6421326859789
curr_Factors:  [96.64213269]
mat_Sqrt:  [[0.15]]
grads:  [-0.1322775]
Stock Position:  -0.1322774989261501
Bond Position:  [20.68863032]


portfolio before change:  [7.95660489]
curr_Stock_Price:  96.26216563176646
curr_Factors:  [96.26216563]
mat_Sqrt:  [[0.15]]
grads:  [-0.08582097]
Stock Position:  -0.08582096969403478
Bond Position:  [16.21791729]


portfolio before change:  [7.93006684]
curr_Stock_Price:  96.58320265659063
curr_Factors:  [96.58320266]
mat_Sqrt:  [[0.15]]
grads:  [-0.06981801]
Stock Position:  -0.06981800850084276
Bond Position:  [14.6733137]


portfolio before change:  [7.9817958]
curr_Stock_Price:  95.85542690299465
curr_Factors:  [95.8554269]
mat_Sqrt:  [[0.15]]
grads:  [0.07790762]
Stock Position:  0.0779076247173068
Bond Position:  [0.51392717]


portfolio before change:  [8.05308293]
curr_Stock_Price:  96.77003578145909
curr_Factors:  [96.77003578]
mat_Sqrt:  [[0.15]]
grads:  [-0.01163636]
Stock Position:  -0.011636364853543482
Bond Position:  [9.17913437]


portfolio before change:  [8.06275817]
curr_Stock_Price:  95.9878735813488
curr_Factors:  [95.98787358]
mat_Sqrt:  [[0.15]]
grads:  [0.14111961]
Stock Position:  0.14111960813968633
Bond Position:  [-5.48301294]


portfolio before change:  [8.03679634]
curr_Stock_Price:  95.80633163064256
curr_Factors:  [95.80633163]
mat_Sqrt:  [[0.15]]
grads:  [0.03365465]
Stock Position:  0.03365464656202006
Bond Position:  [4.81246811]


portfolio before change:  [8.05484716]
curr_Stock_Price:  96.33374854820075
curr_Factors:  [96.33374855]
mat_Sqrt:  [[0.15]]
grads:  [0.04639442]
Stock Position:  0.04639442115483271
Bond Position:  [3.58549865]


portfolio before change:  [8.04305866]
curr_Stock_Price:  96.07482517209769
curr_Factors:  [96.07482517]
mat_Sqrt:  [[0.15]]
grads:  [0.23521841]
Stock Position:  0.23521841052231462
Bond Position:  [-14.55550901]


portfolio before change:  [7.84433758]
curr_Stock_Price:  95.23385644364184
curr_Factors:  [95.23385644]
mat_Sqrt:  [[0.15]]
grads:  [-0.022493]
Stock Position:  -0.022492995845278658
Bond Position:  [9.98643232]


portfolio before change:  [7.84274418]
curr_Stock_Price:  95.33244597104
curr_Factors:  [95.33244597]
mat_Sqrt:  [[0.15]]
grads:  [0.13733828]
Stock Position:  0.137338282302832
Bond Position:  [-5.2500502]


portfolio before change:  [7.83191042]
curr_Stock_Price:  95.2559515104458
curr_Factors:  [95.25595151]
mat_Sqrt:  [[0.15]]
grads:  [-0.37266321]
Stock Position:  -0.3726632137853983
Bond Position:  [43.33029944]


portfolio before change:  [8.2769432]
curr_Stock_Price:  94.06902310893967
curr_Factors:  [94.06902311]
mat_Sqrt:  [[0.15]]
grads:  [0.17552837]
Stock Position:  0.17552836707507358
Bond Position:  [-8.23483882]


portfolio before change:  [8.41350622]
curr_Stock_Price:  94.84996645793824
curr_Factors:  [94.84996646]
mat_Sqrt:  [[0.15]]
grads:  [0.05955206]
Stock Position:  0.05955206353931692
Bond Position:  [2.76499499]


portfolio before change:  [8.41875785]
curr_Stock_Price:  94.93525008846322
curr_Factors:  [94.93525009]
mat_Sqrt:  [[0.15]]
grads:  [0.03598405]
Stock Position:  0.035984052231790284
Bond Position:  [5.00260286]


portfolio before change:  [8.41833305]
curr_Stock_Price:  94.91475551400826
curr_Factors:  [94.91475551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0767957]
Stock Position:  -0.0767957010197856
Bond Position:  [15.70737824]


portfolio before change:  [8.42182319]
curr_Stock_Price:  94.88209218187276
curr_Factors:  [94.88209218]
mat_Sqrt:  [[0.15]]
grads:  [0.00108282]
Stock Position:  0.0010828249261993507
Bond Position:  [8.3190825]


portfolio before change:  [8.42217705]
curr_Stock_Price:  94.72869610854757
curr_Factors:  [94.72869611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00380776]
Stock Position:  -0.003807757114738519
Bond Position:  [8.78288092]


portfolio before change:  [8.42244685]
curr_Stock_Price:  94.80200600894936
curr_Factors:  [94.80200601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02525911]
Stock Position:  -0.025259114851292775
Bond Position:  [10.81706161]


portfolio before change:  [8.42631464]
curr_Stock_Price:  94.6756478072969
curr_Factors:  [94.67564781]
mat_Sqrt:  [[0.15]]
grads:  [-0.00665017]
Stock Position:  -0.006650174344502467
Bond Position:  [9.0559242]


portfolio before change:  [8.42820016]
curr_Stock_Price:  94.4772307427953
curr_Factors:  [94.47723074]
mat_Sqrt:  [[0.15]]
grads:  [0.02663636]
Stock Position:  0.026636357388653047
Bond Position:  [5.91167087]


portfolio before change:  [8.44284149]
curr_Stock_Price:  95.01303362289775
curr_Factors:  [95.01303362]
mat_Sqrt:  [[0.15]]
grads:  [-0.1005836]
Stock Position:  -0.10058359931372368
Bond Position:  [17.99959439]


portfolio before change:  [8.51790811]
curr_Stock_Price:  94.27790764000001
curr_Factors:  [94.27790764]
mat_Sqrt:  [[0.15]]
grads:  [-0.0363776]
Stock Position:  -0.03637760278125583
Bond Position:  [11.94751239]


portfolio before change:  [8.52108203]
curr_Stock_Price:  94.21118595631948
curr_Factors:  [94.21118596]
mat_Sqrt:  [[0.15]]
grads:  [-0.03466129]
Stock Position:  -0.03466129150640113
Bond Position:  [11.78656341]


portfolio before change:  [8.5053503]
curr_Stock_Price:  94.6863099084626
curr_Factors:  [94.68630991]
mat_Sqrt:  [[0.15]]
grads:  [0.09221736]
Stock Position:  0.09221736135143759
Bond Position:  [-0.22637135]


portfolio before change:  [8.53184467]
curr_Stock_Price:  94.97376678598148
curr_Factors:  [94.97376679]
mat_Sqrt:  [[0.15]]
grads:  [0.04354467]
Stock Position:  0.043544670138885286
Bond Position:  [4.39624332]


portfolio before change:  [8.53672036]
curr_Stock_Price:  95.07942648360586
curr_Factors:  [95.07942648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675375]
Stock Position:  -0.016753752208642014
Bond Position:  [10.12965751]


portfolio before change:  [8.53550393]
curr_Stock_Price:  95.18982303625718
curr_Factors:  [95.18982304]
mat_Sqrt:  [[0.15]]
grads:  [-0.03418409]
Stock Position:  -0.03418408593575006
Bond Position:  [11.78948102]


portfolio before change:  [8.55387075]
curr_Stock_Price:  94.67408736858373
curr_Factors:  [94.67408737]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098533]
Stock Position:  -0.02098533380083721
Bond Position:  [10.54063807]


portfolio before change:  [8.55616256]
curr_Stock_Price:  94.5962710897521
curr_Factors:  [94.59627109]
mat_Sqrt:  [[0.15]]
grads:  [0.00060141]
Stock Position:  0.0006014144892113373
Bond Position:  [8.49927099]


portfolio before change:  [8.55673981]
curr_Stock_Price:  94.67280848003782
curr_Factors:  [94.67280848]
mat_Sqrt:  [[0.15]]
grads:  [-0.0362375]
Stock Position:  -0.03623749780020937
Bond Position:  [11.9874455]


portfolio before change:  [8.55102149]
curr_Stock_Price:  94.85128550737835
curr_Factors:  [94.85128551]
mat_Sqrt:  [[0.15]]
grads:  [0.11929615]
Stock Position:  0.11929614591771989
Bond Position:  [-2.76437131]


portfolio before change:  [8.47325826]
curr_Stock_Price:  94.20088352650212
curr_Factors:  [94.20088353]
mat_Sqrt:  [[0.15]]
grads:  [0.05382032]
Stock Position:  0.05382032350473388
Bond Position:  [3.40333623]


portfolio before change:  [8.46184163]
curr_Stock_Price:  93.98480628753171
curr_Factors:  [93.98480629]
mat_Sqrt:  [[0.15]]
grads:  [0.13630018]
Stock Position:  0.13630018260515642
Bond Position:  [-4.34830463]


portfolio before change:  [8.57594325]
curr_Stock_Price:  94.82393505386366
curr_Factors:  [94.82393505]
mat_Sqrt:  [[0.15]]
grads:  [-0.02771518]
Stock Position:  -0.02771517639290152
Bond Position:  [11.20400534]


portfolio before change:  [8.59562633]
curr_Stock_Price:  94.13901066119146
curr_Factors:  [94.13901066]
mat_Sqrt:  [[0.15]]
grads:  [0.05597122]
Stock Position:  0.055971224485124225
Bond Position:  [3.32655063]


portfolio before change:  [8.60605859]
curr_Stock_Price:  94.32168224534979
curr_Factors:  [94.32168225]
mat_Sqrt:  [[0.15]]
grads:  [0.19077204]
Stock Position:  0.19077204455911476
Bond Position:  [-9.38788157]


portfolio before change:  [8.50826185]
curr_Stock_Price:  93.81212129091558
curr_Factors:  [93.81212129]
mat_Sqrt:  [[0.15]]
grads:  [0.02072002]
Stock Position:  0.020720020958494793
Bond Position:  [6.56447273]


portfolio before change:  [8.4884871]
curr_Stock_Price:  92.83794080439345
curr_Factors:  [92.8379408]
mat_Sqrt:  [[0.15]]
grads:  [-0.10003418]
Stock Position:  -0.1000341763572397
Bond Position:  [17.77545404]


portfolio before change:  [8.43680483]
curr_Stock_Price:  93.36569313058807
curr_Factors:  [93.36569313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04016667]
Stock Position:  -0.04016666525401419
Bond Position:  [12.18699337]


portfolio before change:  [8.45341919]
curr_Stock_Price:  92.97102140509257
curr_Factors:  [92.97102141]
mat_Sqrt:  [[0.15]]
grads:  [0.02305421]
Stock Position:  0.02305420819009059
Bond Position:  [6.31004591]


portfolio before change:  [8.45497555]
curr_Stock_Price:  93.02142297454519
curr_Factors:  [93.02142297]
mat_Sqrt:  [[0.15]]
grads:  [0.08289912]
Stock Position:  0.08289912175544042
Bond Position:  [0.74358128]


portfolio before change:  [8.39980652]
curr_Stock_Price:  92.3553663863032
curr_Factors:  [92.35536639]
mat_Sqrt:  [[0.15]]
grads:  [0.13615754]
Stock Position:  0.13615754269584987
Bond Position:  [-4.17507323]


portfolio before change:  [8.45488492]
curr_Stock_Price:  92.76180259065931
curr_Factors:  [92.76180259]
mat_Sqrt:  [[0.15]]
grads:  [0.03586458]
Stock Position:  0.035864583067118594
Bond Position:  [5.12802155]


portfolio before change:  [8.44455738]
curr_Stock_Price:  92.4649064881044
curr_Factors:  [92.46490649]
mat_Sqrt:  [[0.15]]
grads:  [-0.24625235]
Stock Position:  -0.2462523547867515
Bond Position:  [31.21425834]


portfolio before change:  [8.45987838]
curr_Stock_Price:  92.41061238318157
curr_Factors:  [92.41061238]
mat_Sqrt:  [[0.15]]
grads:  [-0.1676837]
Stock Position:  -0.16768370340127264
Bond Position:  [23.9556321]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.3893277]
Stock Price:  92.84027818511457
PL:  [8.3893277]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.19388874e-02]
 [ 1.90011299e-02]
 [ 6.97388554e-03]
 [-9.88499758e-03]
 [ 1.17638093e-02]
 [-1.35746630e-02]
 [-1.35410394e-02]
 [ 5.25230705e-02]
 [-2.07280355e-02]
 [-1.33072105e-02]
 [ 1.00487675e-03]
 [-5.34216116e-03]
 [ 4.85637172e-03]
 [-3.64178316e-03]
 [ 1.12138176e-03]
 [ 3.64561024e-03]
 [-6.21784444e-04]
 [-1.42492176e-02]
 [ 2.23167575e-02]
 [ 1.57179000e-03]
 [-4.03126302e-03]
 [ 4.14219211e-03]
 [ 1.55887923e-02]
 [ 1.74634389e-02]
 [-6.02765717e-03]
 [ 4.70086673e-03]
 [ 4.15495295e-03]
 [ 9.59804374e-03]
 [ 1.61162472e-02]
 [ 4.16626206e-02]
 [-6.91520174e-03]
 [ 1.77469211e-02]
 [ 1.16835735e-02]
 [-1.99825374e-02]
 [-3.33640365e-03]
 [ 6.87312696e-03]
 [ 8.42432840e-03]
 [-2.82353476e-03]
 [ 1.23226451e-02]
 [ 6.17080990e-04]
 [ 6.97505329e-03]
 [ 3.41991134e-02]
 [-3.36974442e-03]
 [ 1.35351376e-02]
 [-5.76610314e-02]
 [ 2.14551791e-02]
 [ 9.55250710e-03]
 [ 5.35176973e-03]
 [-8.26611547e-03]
 [-3.60637162e-04]
 [-4.65522000e-03]
 [-1.25823976e-04]
 [ 6.64903816e-04]
 [ 7.41131408e-03]
 [-9.55448927e-03]
 [-4.70593740e-03]
 [-9.34138578e-04]
 [ 1.24570117e-02]
 [ 7.92299021e-03]
 [-3.01620367e-03]
 [-5.12865301e-03]
 [-2.37971654e-03]
 [-1.34765158e-03]
 [-4.56530866e-03]
 [ 1.80783128e-02]
 [ 6.03825903e-03]
 [ 1.45334200e-02]
 [-1.63881381e-03]
 [ 3.65178008e-03]
 [ 2.27584483e-02]
 [ 3.56552073e-03]
 [-1.55475791e-02]
 [-5.45682822e-03]
 [ 1.33916970e-03]
 [ 9.08775833e-03]
 [ 1.66986461e-03]
 [-1.46168695e-03]
 [-1.47886001e-02]
 [-2.54022738e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.16158874]
curr_Stock_Price:  100.00598050912276
curr_Factors:  [100.00598051]
mat_Sqrt:  [[0.15]]
grads:  [-0.07959258]
Stock Position:  -0.07959258260360753
Bond Position:  [10.12132301]


portfolio before change:  [2.13433215]
curr_Stock_Price:  100.35637990509561
curr_Factors:  [100.35637991]
mat_Sqrt:  [[0.15]]
grads:  [0.1266742]
Stock Position:  0.12667419960253887
Bond Position:  [-10.57823195]


portfolio before change:  [2.02736421]
curr_Stock_Price:  99.51716575542693
curr_Factors:  [99.51716576]
mat_Sqrt:  [[0.15]]
grads:  [0.04649257]
Stock Position:  0.0464925702856642
Bond Position:  [-2.59944461]


portfolio before change:  [2.01341655]
curr_Stock_Price:  99.2206626450994
curr_Factors:  [99.22066265]
mat_Sqrt:  [[0.15]]
grads:  [-0.06589998]
Stock Position:  -0.06589998384664209
Bond Position:  [8.55205661]


portfolio before change:  [2.01590831]
curr_Stock_Price:  99.19096240341827
curr_Factors:  [99.1909624]
mat_Sqrt:  [[0.15]]
grads:  [0.0784254]
Stock Position:  0.0784253955662746
Bond Position:  [-5.76318215]


portfolio before change:  [2.00514132]
curr_Stock_Price:  99.0582657331994
curr_Factors:  [99.05826573]
mat_Sqrt:  [[0.15]]
grads:  [-0.09049775]
Stock Position:  -0.09049775314305787
Bond Position:  [10.96969179]


portfolio before change:  [2.09052677]
curr_Stock_Price:  98.12233279989445
curr_Factors:  [98.1223328]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902736]
Stock Position:  -0.09027359609209139
Bond Position:  [10.94838261]


portfolio before change:  [2.10813645]
curr_Stock_Price:  97.93484291150726
curr_Factors:  [97.93484291]
mat_Sqrt:  [[0.15]]
grads:  [0.3501538]
Stock Position:  0.35015380356702414
Bond Position:  [-32.1841213]


portfolio before change:  [2.25700546]
curr_Stock_Price:  98.3657409265962
curr_Factors:  [98.36574093]
mat_Sqrt:  [[0.15]]
grads:  [-0.1381869]
Stock Position:  -0.13818690303611603
Bond Position:  [15.84986256]


portfolio before change:  [2.33094454]
curr_Stock_Price:  97.83784403668166
curr_Factors:  [97.83784404]
mat_Sqrt:  [[0.15]]
grads:  [-0.08871474]
Stock Position:  -0.08871473656664135
Bond Position:  [11.0106031]


portfolio before change:  [2.39041717]
curr_Stock_Price:  97.17522088720493
curr_Factors:  [97.17522089]
mat_Sqrt:  [[0.15]]
grads:  [0.00669918]
Stock Position:  0.006699178331219935
Bond Position:  [1.73942303]


portfolio before change:  [2.38832617]
curr_Stock_Price:  96.84686581897851
curr_Factors:  [96.84686582]
mat_Sqrt:  [[0.15]]
grads:  [-0.03561441]
Stock Position:  -0.035614407708565665
Bond Position:  [5.83746994]


portfolio before change:  [2.37281562]
curr_Stock_Price:  97.29262374587255
curr_Factors:  [97.29262375]
mat_Sqrt:  [[0.15]]
grads:  [0.03237581]
Stock Position:  0.03237581149248353
Bond Position:  [-0.77711202]


portfolio before change:  [2.39571101]
curr_Stock_Price:  98.0012995810116
curr_Factors:  [98.00129958]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427855]
Stock Position:  -0.024278554373425038
Bond Position:  [4.77504089]


portfolio before change:  [2.40887716]
curr_Stock_Price:  97.4712966283608
curr_Factors:  [97.47129663]
mat_Sqrt:  [[0.15]]
grads:  [0.00747588]
Stock Position:  0.007475878419446689
Bond Position:  [1.6801936]


portfolio before change:  [2.41065557]
curr_Stock_Price:  97.69513499483826
curr_Factors:  [97.69513499]
mat_Sqrt:  [[0.15]]
grads:  [0.02430407]
Stock Position:  0.02430406829751361
Bond Position:  [0.03626633]


portfolio before change:  [2.43014609]
curr_Stock_Price:  98.49698682168687
curr_Factors:  [98.49698682]
mat_Sqrt:  [[0.15]]
grads:  [-0.00414523]
Stock Position:  -0.004145229627072015
Bond Position:  [2.83843872]


portfolio before change:  [2.42858922]
curr_Stock_Price:  98.91536709530354
curr_Factors:  [98.9153671]
mat_Sqrt:  [[0.15]]
grads:  [-0.09499478]
Stock Position:  -0.094994783807886
Bond Position:  [11.82503313]


portfolio before change:  [2.39836481]
curr_Stock_Price:  99.24131651102752
curr_Factors:  [99.24131651]
mat_Sqrt:  [[0.15]]
grads:  [0.14877838]
Stock Position:  0.14877838320850933
Bond Position:  [-12.3665978]


portfolio before change:  [2.40342297]
curr_Stock_Price:  99.28050969203669
curr_Factors:  [99.28050969]
mat_Sqrt:  [[0.15]]
grads:  [0.0104786]
Stock Position:  0.01047859999654668
Bond Position:  [1.36310223]


portfolio before change:  [2.40428089]
curr_Stock_Price:  99.3542520042448
curr_Factors:  [99.354252]
mat_Sqrt:  [[0.15]]
grads:  [-0.02687509]
Stock Position:  -0.026875086816255847
Bond Position:  [5.07443504]


portfolio before change:  [2.38380668]
curr_Stock_Price:  100.12788192679875
curr_Factors:  [100.12788193]
mat_Sqrt:  [[0.15]]
grads:  [0.02761461]
Stock Position:  0.027614614055037578
Bond Position:  [-0.38118614]


portfolio before change:  [2.38043831]
curr_Stock_Price:  100.00676694244852
curr_Factors:  [100.00676694]
mat_Sqrt:  [[0.15]]
grads:  [0.10392528]
Stock Position:  0.10392528222134557
Bond Position:  [-8.01279317]


portfolio before change:  [2.36313969]
curr_Stock_Price:  99.8451334207012
curr_Factors:  [99.84513342]
mat_Sqrt:  [[0.15]]
grads:  [0.11642293]
Stock Position:  0.11642292567498054
Bond Position:  [-9.26112286]


portfolio before change:  [2.30907737]
curr_Stock_Price:  99.38574386650801
curr_Factors:  [99.38574387]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018438]
Stock Position:  -0.040184381154430224
Bond Position:  [6.30283198]


portfolio before change:  [2.33781549]
curr_Stock_Price:  98.68039077331504
curr_Factors:  [98.68039077]
mat_Sqrt:  [[0.15]]
grads:  [0.03133911]
Stock Position:  0.031339111504763074
Bond Position:  [-0.75474028]


portfolio before change:  [2.3124727]
curr_Stock_Price:  97.87323269523405
curr_Factors:  [97.8732327]
mat_Sqrt:  [[0.15]]
grads:  [0.02769969]
Stock Position:  0.027699686346047775
Bond Position:  [-0.39858515]


portfolio before change:  [2.30284319]
curr_Stock_Price:  97.52649248750404
curr_Factors:  [97.52649249]
mat_Sqrt:  [[0.15]]
grads:  [0.06398696]
Stock Position:  0.0639869582672026
Bond Position:  [-3.93758041]


portfolio before change:  [2.2958268]
curr_Stock_Price:  97.42068527253248
curr_Factors:  [97.42068527]
mat_Sqrt:  [[0.15]]
grads:  [0.10744165]
Stock Position:  0.10744164802439389
Bond Position:  [-8.17121217]


portfolio before change:  [2.23241268]
curr_Stock_Price:  96.83521955624349
curr_Factors:  [96.83521956]
mat_Sqrt:  [[0.15]]
grads:  [0.2777508]
Stock Position:  0.2777508041000069
Bond Position:  [-24.66364741]


portfolio before change:  [2.24025554]
curr_Stock_Price:  96.86900661234895
curr_Factors:  [96.86900661]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610134]
Stock Position:  -0.04610134492741861
Bond Position:  [6.70604703]


portfolio before change:  [2.21755497]
curr_Stock_Price:  97.37050415528859
curr_Factors:  [97.37050416]
mat_Sqrt:  [[0.15]]
grads:  [0.11831281]
Stock Position:  0.11831280709608982
Bond Position:  [-9.3026227]


portfolio before change:  [2.23350903]
curr_Stock_Price:  97.51026496388286
curr_Factors:  [97.51026496]
mat_Sqrt:  [[0.15]]
grads:  [0.07789049]
Stock Position:  0.07789049012211122
Bond Position:  [-5.3616133]


portfolio before change:  [2.27463117]
curr_Stock_Price:  98.04251543460234
curr_Factors:  [98.04251543]
mat_Sqrt:  [[0.15]]
grads:  [-0.13321692]
Stock Position:  -0.13321691632842478
Bond Position:  [15.33555275]


portfolio before change:  [2.23249233]
curr_Stock_Price:  98.36602798935033
curr_Factors:  [98.36602799]
mat_Sqrt:  [[0.15]]
grads:  [-0.02224269]
Stock Position:  -0.022242691002259396
Bond Position:  [4.42041749]


portfolio before change:  [2.25884782]
curr_Stock_Price:  97.19354356261644
curr_Factors:  [97.19354356]
mat_Sqrt:  [[0.15]]
grads:  [0.04582085]
Stock Position:  0.04582084641160482
Bond Position:  [-2.19464261]


portfolio before change:  [2.23652362]
curr_Stock_Price:  96.70933101937086
curr_Factors:  [96.70933102]
mat_Sqrt:  [[0.15]]
grads:  [0.05616219]
Stock Position:  0.05616218933693219
Bond Position:  [-3.19488414]


portfolio before change:  [2.21285014]
curr_Stock_Price:  96.29136656409999
curr_Factors:  [96.29136656]
mat_Sqrt:  [[0.15]]
grads:  [-0.01882357]
Stock Position:  -0.018823565064909314
Bond Position:  [4.02539694]


portfolio before change:  [2.21264542]
curr_Stock_Price:  96.31560834632906
curr_Factors:  [96.31560835]
mat_Sqrt:  [[0.15]]
grads:  [0.08215097]
Stock Position:  0.08215096735364191
Bond Position:  [-5.69977498]


portfolio before change:  [2.1933964]
curr_Stock_Price:  96.08563216598414
curr_Factors:  [96.08563217]
mat_Sqrt:  [[0.15]]
grads:  [0.00411387]
Stock Position:  0.004113873264443106
Bond Position:  [1.79811229]


portfolio before change:  [2.19508768]
curr_Stock_Price:  96.46942831078046
curr_Factors:  [96.46942831]
mat_Sqrt:  [[0.15]]
grads:  [0.04650036]
Stock Position:  0.04650035528400528
Bond Position:  [-2.29077501]


portfolio before change:  [2.20889613]
curr_Stock_Price:  96.76946115853883
curr_Factors:  [96.76946116]
mat_Sqrt:  [[0.15]]
grads:  [0.22799409]
Stock Position:  0.227994089289619
Bond Position:  [-19.85396903]


portfolio before change:  [2.10970475]
curr_Stock_Price:  96.33984269957428
curr_Factors:  [96.3398427]
mat_Sqrt:  [[0.15]]
grads:  [-0.02246496]
Stock Position:  -0.022464962771451907
Bond Position:  [4.27397573]


portfolio before change:  [2.11324843]
curr_Stock_Price:  96.1939912816609
curr_Factors:  [96.19399128]
mat_Sqrt:  [[0.15]]
grads:  [0.09023425]
Stock Position:  0.09023425038645547
Bond Position:  [-6.56674426]


portfolio before change:  [2.01947085]
curr_Stock_Price:  95.15927164465387
curr_Factors:  [95.15927164]
mat_Sqrt:  [[0.15]]
grads:  [-0.38440688]
Stock Position:  -0.38440687571551585
Bond Position:  [38.59934915]


portfolio before change:  [1.70239684]
curr_Stock_Price:  95.99038721443269
curr_Factors:  [95.99038721]
mat_Sqrt:  [[0.15]]
grads:  [0.14303453]
Stock Position:  0.14303452732637673
Bond Position:  [-12.02754282]


portfolio before change:  [1.74292948]
curr_Stock_Price:  96.27901953513242
curr_Factors:  [96.27901954]
mat_Sqrt:  [[0.15]]
grads:  [0.06368338]
Stock Position:  0.06368338066039433
Bond Position:  [-4.38844397]


portfolio before change:  [1.72663797]
curr_Stock_Price:  96.02750607093147
curr_Factors:  [96.02750607]
mat_Sqrt:  [[0.15]]
grads:  [0.03567846]
Stock Position:  0.035678464866772674
Bond Position:  [-1.69947603]


portfolio before change:  [1.73121788]
curr_Stock_Price:  96.15884946064809
curr_Factors:  [96.15884946]
mat_Sqrt:  [[0.15]]
grads:  [-0.05510744]
Stock Position:  -0.05510743645971295
Bond Position:  [7.03028557]


portfolio before change:  [1.68273432]
curr_Stock_Price:  97.04662376245741
curr_Factors:  [97.04662376]
mat_Sqrt:  [[0.15]]
grads:  [-0.00240425]
Stock Position:  -0.0024042477439870026
Bond Position:  [1.91605845]


portfolio before change:  [1.6823434]
curr_Stock_Price:  97.25903119913133
curr_Factors:  [97.2590312]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310348]
Stock Position:  -0.03103480003310277
Bond Position:  [4.70075798]


portfolio before change:  [1.6964197]
curr_Stock_Price:  96.81493302157358
curr_Factors:  [96.81493302]
mat_Sqrt:  [[0.15]]
grads:  [-0.00083883]
Stock Position:  -0.0008388265035550943
Bond Position:  [1.77763063]


portfolio before change:  [1.69617759]
curr_Stock_Price:  97.23601828262298
curr_Factors:  [97.23601828]
mat_Sqrt:  [[0.15]]
grads:  [0.00443269]
Stock Position:  0.004432692109942899
Bond Position:  [1.26516026]


portfolio before change:  [1.69517048]
curr_Stock_Price:  96.9909780335077
curr_Factors:  [96.99097803]
mat_Sqrt:  [[0.15]]
grads:  [0.04940876]
Stock Position:  0.049408760560764556
Bond Position:  [-3.09703353]


portfolio before change:  [1.71100362]
curr_Stock_Price:  97.31534792087368
curr_Factors:  [97.31534792]
mat_Sqrt:  [[0.15]]
grads:  [-0.0636966]
Stock Position:  -0.06369659510806501
Bond Position:  [7.90965993]


portfolio before change:  [1.70838862]
curr_Stock_Price:  97.36416319179571
curr_Factors:  [97.36416319]
mat_Sqrt:  [[0.15]]
grads:  [-0.03137292]
Stock Position:  -0.03137291596760579
Bond Position:  [4.76298633]


portfolio before change:  [1.71236179]
curr_Stock_Price:  97.24700890495652
curr_Factors:  [97.2470089]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622759]
Stock Position:  -0.006227590521920207
Bond Position:  [2.31797634]


portfolio before change:  [1.71414442]
curr_Stock_Price:  96.98402578012401
curr_Factors:  [96.98402578]
mat_Sqrt:  [[0.15]]
grads:  [0.08304674]
Stock Position:  0.08304674485686248
Bond Position:  [-6.34006322]


portfolio before change:  [1.71014292]
curr_Stock_Price:  96.94061364308718
curr_Factors:  [96.94061364]
mat_Sqrt:  [[0.15]]
grads:  [0.05281993]
Stock Position:  0.05281993472458345
Bond Position:  [-3.41025397]


portfolio before change:  [1.67622038]
curr_Stock_Price:  96.30241915558044
curr_Factors:  [96.30241916]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010802]
Stock Position:  -0.020108024483665814
Bond Position:  [3.61267178]


portfolio before change:  [1.67919246]
curr_Stock_Price:  96.16584252081086
curr_Factors:  [96.16584252]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419102]
Stock Position:  -0.03419102006828149
Bond Position:  [4.96720072]


portfolio before change:  [1.70077682]
curr_Stock_Price:  95.54363544712227
curr_Factors:  [95.54363545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01586478]
Stock Position:  -0.015864776917300216
Bond Position:  [3.21655528]


portfolio before change:  [1.70264582]
curr_Stock_Price:  95.43849935494995
curr_Factors:  [95.43849935]
mat_Sqrt:  [[0.15]]
grads:  [-0.00898434]
Stock Position:  -0.00898434384103151
Bond Position:  [2.56009811]


portfolio before change:  [1.70443555]
curr_Stock_Price:  95.25710336863096
curr_Factors:  [95.25710337]
mat_Sqrt:  [[0.15]]
grads:  [-0.03043539]
Stock Position:  -0.03043539108878371
Bond Position:  [4.60362275]


portfolio before change:  [1.70804973]
curr_Stock_Price:  95.14780833227755
curr_Factors:  [95.14780833]
mat_Sqrt:  [[0.15]]
grads:  [0.12052209]
Stock Position:  0.12052208505293552
Bond Position:  [-9.75936252]


portfolio before change:  [1.77702445]
curr_Stock_Price:  95.72516892303577
curr_Factors:  [95.72516892]
mat_Sqrt:  [[0.15]]
grads:  [0.04025506]
Stock Position:  0.04025506023144212
Bond Position:  [-2.07639799]


portfolio before change:  [1.83013068]
curr_Stock_Price:  97.04763633778285
curr_Factors:  [97.04763634]
mat_Sqrt:  [[0.15]]
grads:  [0.09688947]
Stock Position:  0.09688946672490177
Bond Position:  [-7.57276305]


portfolio before change:  [1.8314386]
curr_Stock_Price:  97.06602050035167
curr_Factors:  [97.0660205]
mat_Sqrt:  [[0.15]]
grads:  [-0.01092543]
Stock Position:  -0.010925425401997223
Bond Position:  [2.89192616]


portfolio before change:  [1.82794978]
curr_Stock_Price:  97.40189465649817
curr_Factors:  [97.40189466]
mat_Sqrt:  [[0.15]]
grads:  [0.0243452]
Stock Position:  0.024345200534085055
Bond Position:  [-0.54331888]


portfolio before change:  [1.8408276]
curr_Stock_Price:  97.93225698345996
curr_Factors:  [97.93225698]
mat_Sqrt:  [[0.15]]
grads:  [0.15172299]
Stock Position:  0.1517229888502828
Bond Position:  [-13.01774714]


portfolio before change:  [1.75035651]
curr_Stock_Price:  97.34132840163716
curr_Factors:  [97.3413284]
mat_Sqrt:  [[0.15]]
grads:  [0.02377014]
Stock Position:  0.023770138176613203
Bond Position:  [-0.56346031]


portfolio before change:  [1.74828114]
curr_Stock_Price:  97.2554996982903
curr_Factors:  [97.2554997]
mat_Sqrt:  [[0.15]]
grads:  [-0.10365053]
Stock Position:  -0.10365052701696408
Bond Position:  [11.82886493]


portfolio before change:  [1.75232741]
curr_Stock_Price:  97.22359492933506
curr_Factors:  [97.22359493]
mat_Sqrt:  [[0.15]]
grads:  [-0.03637885]
Stock Position:  -0.03637885477154701
Bond Position:  [5.28921045]


portfolio before change:  [1.74078229]
curr_Stock_Price:  97.55004027523188
curr_Factors:  [97.55004028]
mat_Sqrt:  [[0.15]]
grads:  [0.0089278]
Stock Position:  0.00892779799188819
Bond Position:  [0.86987523]


portfolio before change:  [1.73929367]
curr_Stock_Price:  97.37721088375895
curr_Factors:  [97.37721088]
mat_Sqrt:  [[0.15]]
grads:  [0.06058506]
Stock Position:  0.060585055551829504
Bond Position:  [-4.16031006]


portfolio before change:  [1.71994158]
curr_Stock_Price:  97.06208270397319
curr_Factors:  [97.0620827]
mat_Sqrt:  [[0.15]]
grads:  [0.01113243]
Stock Position:  0.011132430744715816
Bond Position:  [0.63940467]


portfolio before change:  [1.70881945]
curr_Stock_Price:  96.05941788610994
curr_Factors:  [96.05941789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00974458]
Stock Position:  -0.00974457964476824
Bond Position:  [2.6448781]


portfolio before change:  [1.70925363]
curr_Stock_Price:  96.03182616468727
curr_Factors:  [96.03182616]
mat_Sqrt:  [[0.15]]
grads:  [-0.09859067]
Stock Position:  -0.09859066702126752
Bond Position:  [11.17709543]


portfolio before change:  [1.6716337]
curr_Stock_Price:  96.42048892944207
curr_Factors:  [96.42048893]
mat_Sqrt:  [[0.15]]
grads:  [-0.16934849]
Stock Position:  -0.16934849177055106
Bond Position:  [18.00029808]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.72309041]
Stock Price:  96.12328137111389
PL:  [1.72309041]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.04791119e-03]
 [ 1.43727351e-02]
 [ 5.63975819e-03]
 [-8.40997862e-03]
 [ 1.22903071e-02]
 [-1.26664564e-03]
 [-9.94312092e-03]
 [-1.18391108e-02]
 [-3.60063500e-03]
 [-1.06688916e-02]
 [ 1.35745085e-02]
 [-7.55145245e-03]
 [-7.47494861e-04]
 [ 4.66086046e-03]
 [-2.02441114e-03]
 [ 8.13643303e-03]
 [-7.70385271e-03]
 [-1.19944008e-02]
 [ 2.41147669e-02]
 [-2.88500801e-03]
 [-1.47306427e-02]
 [ 5.59715715e-03]
 [ 1.39934490e-02]
 [ 3.59102030e-03]
 [ 2.55086302e-02]
 [ 4.08241202e-03]
 [-1.29607976e-03]
 [ 2.95055408e-02]
 [-3.28486935e-02]
 [ 1.06179620e-01]
 [-5.12655051e-03]
 [ 3.85603605e-02]
 [ 1.52033732e-02]
 [-1.85569757e-02]
 [-2.68963818e-02]
 [-1.40688780e-01]
 [ 2.84650006e-02]
 [-1.61356313e-02]
 [ 1.40790508e-01]
 [ 5.09176067e-02]
 [ 6.14091617e-03]
 [ 3.26695948e-02]
 [-9.37538223e-03]
 [ 6.37511718e-02]
 [-1.49843135e-01]
 [ 3.76092021e-02]
 [ 6.45416881e-03]
 [ 5.73209069e-03]
 [-3.92200540e-02]
 [ 1.52361521e-03]
 [ 1.18310474e-02]
 [-2.58539938e-03]
 [-4.58217788e-03]
 [-1.43778057e-02]
 [-3.88796164e-02]
 [-6.70983325e-03]
 [-1.54599759e-02]
 [ 1.74298872e-02]
 [ 1.66581795e-03]
 [-1.42168741e-03]
 [-5.24687271e-03]
 [-7.61117502e-03]
 [ 7.49465698e-03]
 [-1.18665794e-02]
 [ 1.46067551e-02]
 [ 1.45111370e-02]
 [ 2.08861632e-02]
 [-8.99250759e-03]
 [ 1.19545031e-02]
 [ 3.40445129e-02]
 [ 3.41913883e-03]
 [-1.47927500e-02]
 [-6.20521402e-03]
 [ 4.66445774e-03]
 [ 1.31691531e-02]
 [ 2.86801160e-02]
 [ 7.60545544e-03]
 [-3.81592988e-02]
 [-2.39387364e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.2525042]
curr_Stock_Price:  100.32803535803619
curr_Factors:  [100.32803536]
mat_Sqrt:  [[0.15]]
grads:  [-0.02031941]
Stock Position:  -0.020319407905166103
Bond Position:  [11.29111048]


portfolio before change:  [9.25578175]
curr_Stock_Price:  100.2014651644709
curr_Factors:  [100.20146516]
mat_Sqrt:  [[0.15]]
grads:  [0.09581823]
Stock Position:  0.09581823411717101
Bond Position:  [-0.3453457]


portfolio before change:  [9.19969469]
curr_Stock_Price:  99.61634190265994
curr_Factors:  [99.6163419]
mat_Sqrt:  [[0.15]]
grads:  [0.03759839]
Stock Position:  0.03759838793565842
Bond Position:  [5.45428082]


portfolio before change:  [9.21128057]
curr_Stock_Price:  99.91542337467148
curr_Factors:  [99.91542337]
mat_Sqrt:  [[0.15]]
grads:  [-0.05606652]
Stock Position:  -0.05606652413551325
Bond Position:  [14.81319107]


portfolio before change:  [9.2068012]
curr_Stock_Price:  100.01183080517438
curr_Factors:  [100.01183081]
mat_Sqrt:  [[0.15]]
grads:  [0.08193538]
Stock Position:  0.08193538058222531
Bond Position:  [1.01229378]


portfolio before change:  [9.28258569]
curr_Stock_Price:  100.93598860871154
curr_Factors:  [100.93598861]
mat_Sqrt:  [[0.15]]
grads:  [-0.0084443]
Stock Position:  -0.008444304235694734
Bond Position:  [10.13491988]


portfolio before change:  [9.28386182]
curr_Stock_Price:  100.85988107247681
curr_Factors:  [100.85988107]
mat_Sqrt:  [[0.15]]
grads:  [-0.06628747]
Stock Position:  -0.06628747282212853
Bond Position:  [15.96960844]


portfolio before change:  [9.31933311]
curr_Stock_Price:  100.33982561938711
curr_Factors:  [100.33982562]
mat_Sqrt:  [[0.15]]
grads:  [-0.07892741]
Stock Position:  -0.07892740561327219
Bond Position:  [17.23889522]


portfolio before change:  [9.33872004]
curr_Stock_Price:  100.10784708299438
curr_Factors:  [100.10784708]
mat_Sqrt:  [[0.15]]
grads:  [-0.02400423]
Stock Position:  -0.02400423331684172
Bond Position:  [11.74173216]


portfolio before change:  [9.36082207]
curr_Stock_Price:  99.21766430350714
curr_Factors:  [99.2176643]
mat_Sqrt:  [[0.15]]
grads:  [-0.07112594]
Stock Position:  -0.07112594397144636
Bond Position:  [16.41777211]


portfolio before change:  [9.35704468]
curr_Stock_Price:  99.28519993521752
curr_Factors:  [99.28519994]
mat_Sqrt:  [[0.15]]
grads:  [0.09049672]
Stock Position:  0.09049672355662354
Bond Position:  [0.37205939]


portfolio before change:  [9.33765872]
curr_Stock_Price:  99.0707256682058
curr_Factors:  [99.07072567]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034302]
Stock Position:  -0.05034301632541095
Bond Position:  [14.32517788]


portfolio before change:  [9.32857416]
curr_Stock_Price:  99.26896379709291
curr_Factors:  [99.2689638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0049833]
Stock Position:  -0.004983299076193234
Bond Position:  [9.8232611]


portfolio before change:  [9.3301883]
curr_Stock_Price:  99.06826108838585
curr_Factors:  [99.06826109]
mat_Sqrt:  [[0.15]]
grads:  [0.0310724]
Stock Position:  0.03107240304668037
Bond Position:  [6.25189936]


portfolio before change:  [9.33033991]
curr_Stock_Price:  99.06056458751046
curr_Factors:  [99.06056459]
mat_Sqrt:  [[0.15]]
grads:  [-0.01349607]
Stock Position:  -0.013496074278255393
Bond Position:  [10.66726864]


portfolio before change:  [9.3359828]
curr_Stock_Price:  98.69185250779879
curr_Factors:  [98.69185251]
mat_Sqrt:  [[0.15]]
grads:  [0.05424289]
Stock Position:  0.054242886851965925
Bond Position:  [3.98265181]


portfolio before change:  [9.31014535]
curr_Stock_Price:  98.2109347288449
curr_Factors:  [98.21093473]
mat_Sqrt:  [[0.15]]
grads:  [-0.05135902]
Stock Position:  -0.05135901804990596
Bond Position:  [14.35416252]


portfolio before change:  [9.33860844]
curr_Stock_Price:  97.6742046812192
curr_Factors:  [97.67420468]
mat_Sqrt:  [[0.15]]
grads:  [-0.07996267]
Stock Position:  -0.07996267181693656
Bond Position:  [17.14889882]


portfolio before change:  [9.39114123]
curr_Stock_Price:  97.03064254757915
curr_Factors:  [97.03064255]
mat_Sqrt:  [[0.15]]
grads:  [0.16076511]
Stock Position:  0.16076511270414032
Bond Position:  [-6.20800096]


portfolio before change:  [9.44189084]
curr_Stock_Price:  97.34873159628809
curr_Factors:  [97.3487316]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923339]
Stock Position:  -0.01923338670115123
Bond Position:  [11.31423664]


portfolio before change:  [9.44096948]
curr_Stock_Price:  97.43340308380387
curr_Factors:  [97.43340308]
mat_Sqrt:  [[0.15]]
grads:  [-0.09820428]
Stock Position:  -0.09820428462757073
Bond Position:  [19.00934713]


portfolio before change:  [9.44201264]
curr_Stock_Price:  97.43487920315867
curr_Factors:  [97.4348792]
mat_Sqrt:  [[0.15]]
grads:  [0.03731438]
Stock Position:  0.0373143810315385
Bond Position:  [5.80629043]


portfolio before change:  [9.40481649]
curr_Stock_Price:  96.42832219190593
curr_Factors:  [96.42832219]
mat_Sqrt:  [[0.15]]
grads:  [0.09328966]
Stock Position:  0.09328966024849897
Bond Position:  [0.40905108]


portfolio before change:  [9.2642169]
curr_Stock_Price:  94.92091874219258
curr_Factors:  [94.92091874]
mat_Sqrt:  [[0.15]]
grads:  [0.02394014]
Stock Position:  0.023940135322949273
Bond Position:  [6.99179727]


portfolio before change:  [9.24216743]
curr_Stock_Price:  93.98163925341079
curr_Factors:  [93.98163925]
mat_Sqrt:  [[0.15]]
grads:  [0.17005753]
Stock Position:  0.17005753490516226
Bond Position:  [-6.74011847]


portfolio before change:  [9.34984706]
curr_Stock_Price:  94.6173118031481
curr_Factors:  [94.6173118]
mat_Sqrt:  [[0.15]]
grads:  [0.02721608]
Stock Position:  0.027216080162585962
Bond Position:  [6.77473472]


portfolio before change:  [9.34145066]
curr_Stock_Price:  94.29324478756922
curr_Factors:  [94.29324479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00864053]
Stock Position:  -0.00864053172732221
Bond Position:  [10.15619444]


portfolio before change:  [9.34791121]
curr_Stock_Price:  93.61900760901771
curr_Factors:  [93.61900761]
mat_Sqrt:  [[0.15]]
grads:  [0.19670361]
Stock Position:  0.1967036054817185
Bond Position:  [-9.06728512]


portfolio before change:  [9.43498737]
curr_Stock_Price:  94.06456566945072
curr_Factors:  [94.06456567]
mat_Sqrt:  [[0.15]]
grads:  [-0.21899129]
Stock Position:  -0.21899129009602022
Bond Position:  [30.03430796]


portfolio before change:  [9.43949493]
curr_Stock_Price:  94.05255440873835
curr_Factors:  [94.05255441]
mat_Sqrt:  [[0.15]]
grads:  [0.70786413]
Stock Position:  0.7078641330881096
Bond Position:  [-57.13693496]


portfolio before change:  [8.7137268]
curr_Stock_Price:  93.032306420995
curr_Factors:  [93.03230642]
mat_Sqrt:  [[0.15]]
grads:  [-0.034177]
Stock Position:  -0.03417700339241911
Bond Position:  [11.89329226]


portfolio before change:  [8.71566272]
curr_Stock_Price:  92.99741270807344
curr_Factors:  [92.99741271]
mat_Sqrt:  [[0.15]]
grads:  [0.25706907]
Stock Position:  0.2570690702064512
Bond Position:  [-15.19109569]


portfolio before change:  [8.76389873]
curr_Stock_Price:  93.18874450050565
curr_Factors:  [93.1887445]
mat_Sqrt:  [[0.15]]
grads:  [0.10135582]
Stock Position:  0.1013558211766227
Bond Position:  [-0.68132299]


portfolio before change:  [8.68571314]
curr_Stock_Price:  92.41776749451266
curr_Factors:  [92.41776749]
mat_Sqrt:  [[0.15]]
grads:  [-0.12371317]
Stock Position:  -0.12371317147098519
Bond Position:  [20.11900826]


portfolio before change:  [8.69360937]
curr_Stock_Price:  92.36410506139306
curr_Factors:  [92.36410506]
mat_Sqrt:  [[0.15]]
grads:  [-0.17930921]
Stock Position:  -0.1793092122685129
Bond Position:  [25.25534429]


portfolio before change:  [8.75904462]
curr_Stock_Price:  92.00797868256178
curr_Factors:  [92.00797868]
mat_Sqrt:  [[0.15]]
grads:  [-0.9379252]
Stock Position:  -0.937925202693689
Bond Position:  [95.05564667]


portfolio before change:  [9.27015029]
curr_Stock_Price:  91.46938082384386
curr_Factors:  [91.46938082]
mat_Sqrt:  [[0.15]]
grads:  [0.18976667]
Stock Position:  0.18976667091362223
Bond Position:  [-8.0876896]


portfolio before change:  [9.21280947]
curr_Stock_Price:  91.16987973130543
curr_Factors:  [91.16987973]
mat_Sqrt:  [[0.15]]
grads:  [-0.10757088]
Stock Position:  -0.10757087523263638
Bond Position:  [19.02003322]


portfolio before change:  [9.24501087]
curr_Stock_Price:  90.88158032651643
curr_Factors:  [90.88158033]
mat_Sqrt:  [[0.15]]
grads:  [0.93860338]
Stock Position:  0.9386033838522886
Bond Position:  [-76.05674795]


portfolio before change:  [9.08663004]
curr_Stock_Price:  90.71790402022316
curr_Factors:  [90.71790402]
mat_Sqrt:  [[0.15]]
grads:  [0.33945071]
Stock Position:  0.33945071162679746
Bond Position:  [-21.70762703]


portfolio before change:  [9.01889359]
curr_Stock_Price:  90.52235372406838
curr_Factors:  [90.52235372]
mat_Sqrt:  [[0.15]]
grads:  [0.04093944]
Stock Position:  0.04093944112594939
Bond Position:  [5.31295902]


portfolio before change:  [9.00556212]
curr_Stock_Price:  90.18860383772068
curr_Factors:  [90.18860384]
mat_Sqrt:  [[0.15]]
grads:  [0.2177973]
Stock Position:  0.21779729842390305
Bond Position:  [-10.63727214]


portfolio before change:  [9.00432027]
curr_Stock_Price:  90.18595456036516
curr_Factors:  [90.18595456]
mat_Sqrt:  [[0.15]]
grads:  [-0.06250255]
Stock Position:  -0.06250254822829333
Bond Position:  [14.64117224]


portfolio before change:  [8.96805989]
curr_Stock_Price:  90.78073804247032
curr_Factors:  [90.78073804]
mat_Sqrt:  [[0.15]]
grads:  [0.42500781]
Stock Position:  0.4250078121533329
Bond Position:  [-29.61446297]


portfolio before change:  [8.67689066]
curr_Stock_Price:  90.10000168320285
curr_Factors:  [90.10000168]
mat_Sqrt:  [[0.15]]
grads:  [-0.99895423]
Stock Position:  -0.9989542331595715
Bond Position:  [98.68266874]


portfolio before change:  [9.51614359]
curr_Stock_Price:  89.26604448755049
curr_Factors:  [89.26604449]
mat_Sqrt:  [[0.15]]
grads:  [0.25072801]
Stock Position:  0.250728014132564
Bond Position:  [-12.86535448]


portfolio before change:  [9.48225705]
curr_Stock_Price:  89.13409902725512
curr_Factors:  [89.13409903]
mat_Sqrt:  [[0.15]]
grads:  [0.04302779]
Stock Position:  0.04302779207939751
Bond Position:  [5.64701357]


portfolio before change:  [9.46918876]
curr_Stock_Price:  88.82217876460697
curr_Factors:  [88.82217876]
mat_Sqrt:  [[0.15]]
grads:  [0.03821394]
Stock Position:  0.038213937950708134
Bond Position:  [6.07494353]


portfolio before change:  [9.43953881]
curr_Stock_Price:  88.03634895381118
curr_Factors:  [88.03634895]
mat_Sqrt:  [[0.15]]
grads:  [-0.26146703]
Stock Position:  -0.2614670264657191
Bond Position:  [32.45814119]


portfolio before change:  [9.38021402]
curr_Stock_Price:  88.27099990650012
curr_Factors:  [88.27099991]
mat_Sqrt:  [[0.15]]
grads:  [0.01015743]
Stock Position:  0.010157434701766804
Bond Position:  [8.4836071]


portfolio before change:  [9.38474958]
curr_Stock_Price:  88.66532384504387
curr_Factors:  [88.66532385]
mat_Sqrt:  [[0.15]]
grads:  [0.07887365]
Stock Position:  0.078873649585273
Bond Position:  [2.39139189]


portfolio before change:  [9.42195336]
curr_Stock_Price:  89.13511713608501
curr_Factors:  [89.13511714]
mat_Sqrt:  [[0.15]]
grads:  [-0.017236]
Stock Position:  -0.01723599585495938
Bond Position:  [10.95828587]


portfolio before change:  [9.41937442]
curr_Stock_Price:  89.3244796187151
curr_Factors:  [89.32447962]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054785]
Stock Position:  -0.030547852514562723
Bond Position:  [12.14804545]


portfolio before change:  [9.4271833]
curr_Stock_Price:  89.09370721167974
curr_Factors:  [89.09370721]
mat_Sqrt:  [[0.15]]
grads:  [-0.09585204]
Stock Position:  -0.09585203796011221
Bond Position:  [17.9669967]


portfolio before change:  [9.41157951]
curr_Stock_Price:  89.26821328745423
curr_Factors:  [89.26821329]
mat_Sqrt:  [[0.15]]
grads:  [-0.25919744]
Stock Position:  -0.2591974424245536
Bond Position:  [32.54967208]


portfolio before change:  [9.46355769]
curr_Stock_Price:  89.0755270957222
curr_Factors:  [89.0755271]
mat_Sqrt:  [[0.15]]
grads:  [-0.04473222]
Stock Position:  -0.044732221658575266
Bond Position:  [13.44810392]


portfolio before change:  [9.44440223]
curr_Stock_Price:  89.52254264009062
curr_Factors:  [89.52254264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10306651]
Stock Position:  -0.10306650628282743
Bond Position:  [18.67117793]


portfolio before change:  [9.46557561]
curr_Stock_Price:  89.32843110638761
curr_Factors:  [89.32843111]
mat_Sqrt:  [[0.15]]
grads:  [0.11619925]
Stock Position:  0.11619924823804362
Bond Position:  [-0.91432093]


portfolio before change:  [9.40837379]
curr_Stock_Price:  88.83664930126879
curr_Factors:  [88.8366493]
mat_Sqrt:  [[0.15]]
grads:  [0.01110545]
Stock Position:  0.011105453025062561
Bond Position:  [8.42180255]


portfolio before change:  [9.41375358]
curr_Stock_Price:  89.2736790150438
curr_Factors:  [89.27367902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00947792]
Stock Position:  -0.009477916054297314
Bond Position:  [10.25988201]


portfolio before change:  [9.41279742]
curr_Stock_Price:  89.44222100694083
curr_Factors:  [89.44222101]
mat_Sqrt:  [[0.15]]
grads:  [-0.03497915]
Stock Position:  -0.034979151371083546
Bond Position:  [12.5414104]


portfolio before change:  [9.40732437]
curr_Stock_Price:  89.62109644923002
curr_Factors:  [89.62109645]
mat_Sqrt:  [[0.15]]
grads:  [-0.05074117]
Stock Position:  -0.05074116682853271
Bond Position:  [13.95480337]


portfolio before change:  [9.37582252]
curr_Stock_Price:  90.25911973971397
curr_Factors:  [90.25911974]
mat_Sqrt:  [[0.15]]
grads:  [0.04996438]
Stock Position:  0.04996437985274736
Bond Position:  [4.86608158]


portfolio before change:  [9.38093356]
curr_Stock_Price:  90.35532616666997
curr_Factors:  [90.35532617]
mat_Sqrt:  [[0.15]]
grads:  [-0.07911053]
Stock Position:  -0.0791105292025031
Bond Position:  [16.52899123]


portfolio before change:  [9.36517321]
curr_Stock_Price:  90.5676043367093
curr_Factors:  [90.56760434]
mat_Sqrt:  [[0.15]]
grads:  [0.09737837]
Stock Position:  0.09737836728343281
Bond Position:  [0.54584777]


portfolio before change:  [9.36472127]
curr_Stock_Price:  90.56261288832653
curr_Factors:  [90.56261289]
mat_Sqrt:  [[0.15]]
grads:  [0.09674091]
Stock Position:  0.09674091317446772
Bond Position:  [0.6036114]


portfolio before change:  [9.33904862]
curr_Stock_Price:  90.29684762165331
curr_Factors:  [90.29684762]
mat_Sqrt:  [[0.15]]
grads:  [0.13924109]
Stock Position:  0.13924108817661818
Bond Position:  [-3.2339827]


portfolio before change:  [9.36982439]
curr_Stock_Price:  90.51932432065372
curr_Factors:  [90.51932432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05995005]
Stock Position:  -0.05995005059743995
Bond Position:  [14.79646246]


portfolio before change:  [9.3489211]
curr_Stock_Price:  90.88342899949652
curr_Factors:  [90.883429]
mat_Sqrt:  [[0.15]]
grads:  [0.07969669]
Stock Position:  0.07969668748929527
Bond Position:  [2.10581286]


portfolio before change:  [9.33927443]
curr_Stock_Price:  90.76073516004537
curr_Factors:  [90.76073516]
mat_Sqrt:  [[0.15]]
grads:  [0.22696342]
Stock Position:  0.22696341939509068
Bond Position:  [-11.26009237]


portfolio before change:  [9.2028808]
curr_Stock_Price:  90.16288616155171
curr_Factors:  [90.16288616]
mat_Sqrt:  [[0.15]]
grads:  [0.02279426]
Stock Position:  0.022794258862527315
Bond Position:  [7.14768463]


portfolio before change:  [9.20595588]
curr_Stock_Price:  90.27819323545991
curr_Factors:  [90.27819324]
mat_Sqrt:  [[0.15]]
grads:  [-0.09861833]
Stock Position:  -0.09861833307469688
Bond Position:  [18.10904081]


portfolio before change:  [9.21174669]
curr_Stock_Price:  90.23095092783157
curr_Factors:  [90.23095093]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136809]
Stock Position:  -0.04136809343522059
Bond Position:  [12.9444291]


portfolio before change:  [9.22430415]
curr_Stock_Price:  89.94695415613036
curr_Factors:  [89.94695416]
mat_Sqrt:  [[0.15]]
grads:  [0.03109638]
Stock Position:  0.03109638496573325
Bond Position:  [6.42727903]


portfolio before change:  [9.23275744]
curr_Stock_Price:  90.20587721784784
curr_Factors:  [90.20587722]
mat_Sqrt:  [[0.15]]
grads:  [0.08779435]
Stock Position:  0.08779435432841622
Bond Position:  [1.31319069]


portfolio before change:  [9.29896102]
curr_Stock_Price:  90.95901802229928
curr_Factors:  [90.95901802]
mat_Sqrt:  [[0.15]]
grads:  [0.19120077]
Stock Position:  0.19120077317134995
Bond Position:  [-8.09247355]


portfolio before change:  [9.43023546]
curr_Stock_Price:  91.6482424061598
curr_Factors:  [91.64824241]
mat_Sqrt:  [[0.15]]
grads:  [0.05070304]
Stock Position:  0.050703036289387014
Bond Position:  [4.7833913]


portfolio before change:  [9.46167018]
curr_Stock_Price:  92.26232285703047
curr_Factors:  [92.26232286]
mat_Sqrt:  [[0.15]]
grads:  [-0.25439533]
Stock Position:  -0.25439532544639076
Bond Position:  [32.93277383]


portfolio before change:  [9.51786181]
curr_Stock_Price:  92.04953092651694
curr_Factors:  [92.04953093]
mat_Sqrt:  [[0.15]]
grads:  [-0.15959158]
Stock Position:  -0.15959157622896955
Bond Position:  [24.20819154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.52257383]
Stock Price:  92.02948623935254
PL:  [9.52257383]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32600411e-02]
 [ 9.16309515e-03]
 [ 2.83631674e-03]
 [-8.88374023e-03]
 [ 1.52121500e-03]
 [-4.27304816e-03]
 [ 1.47034774e-03]
 [-7.10279381e-04]
 [-1.77820602e-02]
 [-1.12462555e-02]
 [ 1.35001481e-02]
 [-5.72104518e-03]
 [-8.16305076e-04]
 [ 8.33861732e-03]
 [-3.19320718e-04]
 [ 1.15775501e-02]
 [ 3.36394747e-02]
 [-1.47236189e-02]
 [ 1.86004839e-02]
 [ 2.66494714e-03]
 [-3.77016379e-03]
 [ 4.47762960e-03]
 [ 1.09174324e-02]
 [ 3.91971617e-02]
 [-3.65289066e-04]
 [ 7.41089214e-03]
 [ 3.30588400e-03]
 [ 1.69478005e-02]
 [ 2.78162339e-02]
 [-7.08291402e-03]
 [-3.59835536e-04]
 [ 1.36631524e-02]
 [ 1.37489737e-02]
 [-4.04945668e-03]
 [ 5.84767831e-03]
 [ 8.24119910e-03]
 [-1.90082619e-02]
 [-8.31940976e-03]
 [-1.82056919e-02]
 [-1.12917856e-02]
 [ 4.17534377e-03]
 [ 1.01127603e-02]
 [-8.24606768e-03]
 [ 1.36974289e-03]
 [ 3.41794539e-03]
 [ 1.19806506e-02]
 [ 1.05634409e-02]
 [-1.75685770e-03]
 [ 1.48829518e-02]
 [-1.18536324e-03]
 [ 1.79328008e-02]
 [-9.23932588e-03]
 [ 9.22682702e-04]
 [-2.59048833e-03]
 [-3.46662292e-03]
 [-3.34909250e-03]
 [ 1.04371149e-02]
 [ 6.96178897e-04]
 [ 6.94210316e-03]
 [-3.99774347e-03]
 [-1.52640622e-03]
 [ 7.83729992e-03]
 [-8.81610774e-03]
 [ 4.77871809e-03]
 [ 2.41272632e-02]
 [ 5.49585221e-03]
 [ 7.81667346e-03]
 [-1.36935612e-03]
 [ 2.61665669e-03]
 [ 1.99967543e-02]
 [ 1.70692330e-03]
 [-1.59206351e-02]
 [-5.03877543e-03]
 [ 1.28527090e-03]
 [-3.29527860e-04]
 [-9.39967419e-03]
 [-4.30386800e-03]
 [ 1.36601314e-02]
 [-1.73061668e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.60590888]
curr_Stock_Price:  99.51694283283598
curr_Factors:  [99.51694283]
mat_Sqrt:  [[0.15]]
grads:  [-0.08840027]
Stock Position:  -0.0884002737287846
Bond Position:  [0.19141611]


portfolio before change:  [-8.64202259]
curr_Stock_Price:  99.92560309198578
curr_Factors:  [99.92560309]
mat_Sqrt:  [[0.15]]
grads:  [0.0610873]
Stock Position:  0.06108730098768283
Bond Position:  [-14.74620799]


portfolio before change:  [-8.63653932]
curr_Stock_Price:  100.03045207175899
curr_Factors:  [100.03045207]
mat_Sqrt:  [[0.15]]
grads:  [0.01890878]
Stock Position:  0.0189087782752502
Bond Position:  [-10.52799296]


portfolio before change:  [-8.64031899]
curr_Stock_Price:  99.86536219041264
curr_Factors:  [99.86536219]
mat_Sqrt:  [[0.15]]
grads:  [-0.05922493]
Stock Position:  -0.059224934892652195
Bond Position:  [-2.72579941]


portfolio before change:  [-8.67807582]
curr_Stock_Price:  100.50000144748064
curr_Factors:  [100.50000145]
mat_Sqrt:  [[0.15]]
grads:  [0.01014143]
Stock Position:  0.010141433353840108
Bond Position:  [-9.69728989]


portfolio before change:  [-8.68156357]
curr_Stock_Price:  100.21585609944646
curr_Factors:  [100.2158561]
mat_Sqrt:  [[0.15]]
grads:  [-0.02848699]
Stock Position:  -0.02848698772770001
Bond Position:  [-5.8267157]


portfolio before change:  [-8.67958196]
curr_Stock_Price:  100.13351036448208
curr_Factors:  [100.13351036]
mat_Sqrt:  [[0.15]]
grads:  [0.00980232]
Stock Position:  0.009802318276122154
Bond Position:  [-9.6611225]


portfolio before change:  [-8.68570704]
curr_Stock_Price:  99.57025235398412
curr_Factors:  [99.57025235]
mat_Sqrt:  [[0.15]]
grads:  [-0.0047352]
Stock Position:  -0.004735195876164148
Bond Position:  [-8.21422239]


portfolio before change:  [-8.68251999]
curr_Stock_Price:  98.7887740121304
curr_Factors:  [98.78877401]
mat_Sqrt:  [[0.15]]
grads:  [-0.11854707]
Stock Position:  -0.11854706772130401
Bond Position:  [3.02859949]


portfolio before change:  [-8.72692401]
curr_Stock_Price:  99.16493945433236
curr_Factors:  [99.16493945]
mat_Sqrt:  [[0.15]]
grads:  [-0.07497504]
Stock Position:  -0.0749750369243798
Bond Position:  [-1.29202901]


portfolio before change:  [-8.73377604]
curr_Stock_Price:  99.25525328964318
curr_Factors:  [99.25525329]
mat_Sqrt:  [[0.15]]
grads:  [0.09000099]
Stock Position:  0.09000098713971016
Bond Position:  [-17.66684682]


portfolio before change:  [-8.7136773]
curr_Stock_Price:  99.49083905888008
curr_Factors:  [99.49083906]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381403]
Stock Position:  -0.03814030122214308
Bond Position:  [-4.91906673]


portfolio before change:  [-8.70774644]
curr_Stock_Price:  99.32727669396222
curr_Factors:  [99.32727669]
mat_Sqrt:  [[0.15]]
grads:  [-0.00544203]
Stock Position:  -0.005442033839273888
Bond Position:  [-8.16720404]


portfolio before change:  [-8.71021523]
curr_Stock_Price:  99.68712870845418
curr_Factors:  [99.68712871]
mat_Sqrt:  [[0.15]]
grads:  [0.05559078]
Stock Position:  0.05559078210685734
Bond Position:  [-14.25190068]


portfolio before change:  [-8.69980701]
curr_Stock_Price:  99.8903817837259
curr_Factors:  [99.89038178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021288]
Stock Position:  -0.0021288047883130656
Bond Position:  [-8.48715988]


portfolio before change:  [-8.69931124]
curr_Stock_Price:  99.40831378239153
curr_Factors:  [99.40831378]
mat_Sqrt:  [[0.15]]
grads:  [0.07718367]
Stock Position:  0.07718366726873194
Bond Position:  [-16.37200946]


portfolio before change:  [-8.65866293]
curr_Stock_Price:  99.94821553761429
curr_Factors:  [99.94821554]
mat_Sqrt:  [[0.15]]
grads:  [0.22426316]
Stock Position:  0.2242631646351806
Bond Position:  [-31.07336604]


portfolio before change:  [-8.60884448]
curr_Stock_Price:  100.17901846917515
curr_Factors:  [100.17901847]
mat_Sqrt:  [[0.15]]
grads:  [-0.09815746]
Stock Position:  -0.09815745924210119
Bond Position:  [1.22447345]


portfolio before change:  [-8.64925094]
curr_Stock_Price:  100.59144761872298
curr_Factors:  [100.59144762]
mat_Sqrt:  [[0.15]]
grads:  [0.12400323]
Stock Position:  0.12400322605544307
Bond Position:  [-21.12291496]


portfolio before change:  [-8.71172412]
curr_Stock_Price:  100.09829148604717
curr_Factors:  [100.09829149]
mat_Sqrt:  [[0.15]]
grads:  [0.01776631]
Stock Position:  0.017766314297430263
Bond Position:  [-10.49010182]


portfolio before change:  [-8.69375388]
curr_Stock_Price:  101.14667389869118
curr_Factors:  [101.1466739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513443]
Stock Position:  -0.025134425278553908
Bond Position:  [-6.15149036]


portfolio before change:  [-8.69389339]
curr_Stock_Price:  101.13692751143994
curr_Factors:  [101.13692751]
mat_Sqrt:  [[0.15]]
grads:  [0.02985086]
Stock Position:  0.029850864022378312
Bond Position:  [-11.71291806]


portfolio before change:  [-8.67384067]
curr_Stock_Price:  101.83321563702407
curr_Factors:  [101.83321564]
mat_Sqrt:  [[0.15]]
grads:  [0.07278288]
Stock Position:  0.07278288274719608
Bond Position:  [-16.08555566]


portfolio before change:  [-8.59687934]
curr_Stock_Price:  102.90443866586608
curr_Factors:  [102.90443867]
mat_Sqrt:  [[0.15]]
grads:  [0.26131441]
Stock Position:  0.26131441146454226
Bond Position:  [-35.48729217]


portfolio before change:  [-8.841699]
curr_Stock_Price:  101.97604888322057
curr_Factors:  [101.97604888]
mat_Sqrt:  [[0.15]]
grads:  [-0.00243526]
Stock Position:  -0.0024352604431397236
Bond Position:  [-8.59336076]


portfolio before change:  [-8.84118307]
curr_Stock_Price:  101.54363800005108
curr_Factors:  [101.543638]
mat_Sqrt:  [[0.15]]
grads:  [0.04940595]
Stock Position:  0.04940594759289089
Bond Position:  [-13.85804272]


portfolio before change:  [-8.81418777]
curr_Stock_Price:  102.107567190403
curr_Factors:  [102.10756719]
mat_Sqrt:  [[0.15]]
grads:  [0.02203923]
Stock Position:  0.022039226654864304
Bond Position:  [-11.06455958]


portfolio before change:  [-8.80948588]
curr_Stock_Price:  102.35228720289035
curr_Factors:  [102.3522872]
mat_Sqrt:  [[0.15]]
grads:  [0.11298534]
Stock Position:  0.11298533688706261
Bond Position:  [-20.37379353]


portfolio before change:  [-8.8488563]
curr_Stock_Price:  102.01510169242438
curr_Factors:  [102.01510169]
mat_Sqrt:  [[0.15]]
grads:  [0.18544156]
Stock Position:  0.18544155962443185
Bond Position:  [-27.76669587]


portfolio before change:  [-8.80310117]
curr_Stock_Price:  102.27119642332029
curr_Factors:  [102.27119642]
mat_Sqrt:  [[0.15]]
grads:  [-0.04721943]
Stock Position:  -0.04721942681806697
Bond Position:  [-3.97391389]


portfolio before change:  [-8.824031]
curr_Stock_Price:  102.70918255572488
curr_Factors:  [102.70918256]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023989]
Stock Position:  -0.0023989035734596027
Bond Position:  [-8.57764158]


portfolio before change:  [-8.82349801]
curr_Stock_Price:  102.26351798851435
curr_Factors:  [102.26351799]
mat_Sqrt:  [[0.15]]
grads:  [0.09108768]
Stock Position:  0.09108768235698249
Bond Position:  [-18.13844486]


portfolio before change:  [-8.79315279]
curr_Stock_Price:  102.60910707178017
curr_Factors:  [102.60910707]
mat_Sqrt:  [[0.15]]
grads:  [0.09165982]
Stock Position:  0.09165982458961769
Bond Position:  [-18.19828555]


portfolio before change:  [-8.74234018]
curr_Stock_Price:  103.17587705754045
curr_Factors:  [103.17587706]
mat_Sqrt:  [[0.15]]
grads:  [-0.02699638]
Stock Position:  -0.026996377896286915
Bond Position:  [-5.95696522]


portfolio before change:  [-8.72138026]
curr_Stock_Price:  102.3856876982907
curr_Factors:  [102.3856877]
mat_Sqrt:  [[0.15]]
grads:  [0.03898452]
Stock Position:  0.03898452208783527
Bond Position:  [-12.71283736]


portfolio before change:  [-8.70800598]
curr_Stock_Price:  102.74913595065838
curr_Factors:  [102.74913595]
mat_Sqrt:  [[0.15]]
grads:  [0.05494133]
Stock Position:  0.05494132732671797
Bond Position:  [-14.35317989]


portfolio before change:  [-8.70393919]
curr_Stock_Price:  102.83948490660399
curr_Factors:  [102.83948491]
mat_Sqrt:  [[0.15]]
grads:  [-0.12672175]
Stock Position:  -0.12672174579439152
Bond Position:  [4.32805988]


portfolio before change:  [-8.79843384]
curr_Stock_Price:  103.5873057491622
curr_Factors:  [103.58730575]
mat_Sqrt:  [[0.15]]
grads:  [-0.05546273]
Stock Position:  -0.055462731718036985
Bond Position:  [-3.05319889]


portfolio before change:  [-8.78430818]
curr_Stock_Price:  103.32917775345763
curr_Factors:  [103.32917775]
mat_Sqrt:  [[0.15]]
grads:  [-0.12137128]
Stock Position:  -0.12137127917648853
Bond Position:  [3.7568863]


portfolio before change:  [-8.62061561]
curr_Stock_Price:  101.98241955918
curr_Factors:  [101.98241956]
mat_Sqrt:  [[0.15]]
grads:  [-0.07527857]
Stock Position:  -0.07527857041905109
Bond Position:  [-0.94352485]


portfolio before change:  [-8.6212347]
curr_Stock_Price:  101.98986019928817
curr_Factors:  [101.9898602]
mat_Sqrt:  [[0.15]]
grads:  [0.02783563]
Stock Position:  0.0278356251548199
Bond Position:  [-11.46018622]


portfolio before change:  [-8.62061683]
curr_Stock_Price:  102.0377898848038
curr_Factors:  [102.03778988]
mat_Sqrt:  [[0.15]]
grads:  [0.0674184]
Stock Position:  0.06741840183246957
Bond Position:  [-15.49984155]


portfolio before change:  [-8.56460759]
curr_Stock_Price:  102.88293030512254
curr_Factors:  [102.88293031]
mat_Sqrt:  [[0.15]]
grads:  [-0.05497378]
Stock Position:  -0.054973784559232144
Bond Position:  [-2.90874354]


portfolio before change:  [-8.57196032]
curr_Stock_Price:  103.01337310232954
curr_Factors:  [103.0133731]
mat_Sqrt:  [[0.15]]
grads:  [0.00913162]
Stock Position:  0.009131619271122935
Bond Position:  [-9.51263922]


portfolio before change:  [-8.5656041]
curr_Stock_Price:  103.77455055100451
curr_Factors:  [103.77455055]
mat_Sqrt:  [[0.15]]
grads:  [0.0227863]
Stock Position:  0.022786302575594948
Bond Position:  [-10.93024241]


portfolio before change:  [-8.58047484]
curr_Stock_Price:  103.15191408900111
curr_Factors:  [103.15191409]
mat_Sqrt:  [[0.15]]
grads:  [0.079871]
Stock Position:  0.07987100423018563
Bond Position:  [-16.81932181]


portfolio before change:  [-8.58507935]
curr_Stock_Price:  103.10742650738332
curr_Factors:  [103.10742651]
mat_Sqrt:  [[0.15]]
grads:  [0.07042294]
Stock Position:  0.07042293922321712
Bond Position:  [-15.84620738]


portfolio before change:  [-8.58043283]
curr_Stock_Price:  103.18747052204954
curr_Factors:  [103.18747052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01171238]
Stock Position:  -0.011712384666811541
Bond Position:  [-7.37186149]


portfolio before change:  [-8.56395784]
curr_Stock_Price:  101.74150103351994
curr_Factors:  [101.74150103]
mat_Sqrt:  [[0.15]]
grads:  [0.09921968]
Stock Position:  0.09921967835142159
Bond Position:  [-18.65871685]


portfolio before change:  [-8.54400558]
curr_Stock_Price:  101.95434659571775
curr_Factors:  [101.9543466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790242]
Stock Position:  -0.007902421622665304
Bond Position:  [-7.73831934]


portfolio before change:  [-8.5450715]
curr_Stock_Price:  102.02802849932738
curr_Factors:  [102.0280285]
mat_Sqrt:  [[0.15]]
grads:  [0.11955201]
Stock Position:  0.11955200545417394
Bond Position:  [-20.74272692]


portfolio before change:  [-8.49738704]
curr_Stock_Price:  102.4377323949698
curr_Factors:  [102.43773239]
mat_Sqrt:  [[0.15]]
grads:  [-0.06159551]
Stock Position:  -0.061595505847015834
Bond Position:  [-2.1876831]


portfolio before change:  [-8.46739122]
curr_Stock_Price:  101.94853179592485
curr_Factors:  [101.9485318]
mat_Sqrt:  [[0.15]]
grads:  [0.00615122]
Stock Position:  0.00615121801304686
Bond Position:  [-9.09449886]


portfolio before change:  [-8.4699698]
curr_Stock_Price:  101.62174207943211
curr_Factors:  [101.62174208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726992]
Stock Position:  -0.017269922177501666
Bond Position:  [-6.71497022]


portfolio before change:  [-8.47486624]
curr_Stock_Price:  101.88096393899366
curr_Factors:  [101.88096394]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311082]
Stock Position:  -0.02311081948313325
Bond Position:  [-6.12031367]


portfolio before change:  [-8.47462206]
curr_Stock_Price:  101.85384664352058
curr_Factors:  [101.85384664]
mat_Sqrt:  [[0.15]]
grads:  [-0.02232728]
Stock Position:  -0.022327283300230892
Bond Position:  [-6.20050238]


portfolio before change:  [-8.4714025]
curr_Stock_Price:  101.69229067592825
curr_Factors:  [101.69229068]
mat_Sqrt:  [[0.15]]
grads:  [0.06958077]
Stock Position:  0.06958076618240441
Bond Position:  [-15.54723]


portfolio before change:  [-8.54255886]
curr_Stock_Price:  100.68361214783567
curr_Factors:  [100.68361215]
mat_Sqrt:  [[0.15]]
grads:  [0.00464119]
Stock Position:  0.004641192649367798
Bond Position:  [-9.0098509]


portfolio before change:  [-8.54220085]
curr_Stock_Price:  100.88208227391485
curr_Factors:  [100.88208227]
mat_Sqrt:  [[0.15]]
grads:  [0.04628069]
Stock Position:  0.046280687761782034
Bond Position:  [-13.211093]


portfolio before change:  [-8.52408554]
curr_Stock_Price:  101.29134657493076
curr_Factors:  [101.29134657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665162]
Stock Position:  -0.026651623121126674
Bond Position:  [-5.82450675]


portfolio before change:  [-8.52398744]
curr_Stock_Price:  101.27400638176213
curr_Factors:  [101.27400638]
mat_Sqrt:  [[0.15]]
grads:  [-0.01017604]
Stock Position:  -0.010176041450308003
Bond Position:  [-7.49341895]


portfolio before change:  [-8.52689999]
curr_Stock_Price:  101.51419807090555
curr_Factors:  [101.51419807]
mat_Sqrt:  [[0.15]]
grads:  [0.05224867]
Stock Position:  0.05224866614735122
Bond Position:  [-13.83088144]


portfolio before change:  [-8.57101374]
curr_Stock_Price:  100.68643940489271
curr_Factors:  [100.6864394]
mat_Sqrt:  [[0.15]]
grads:  [-0.05877405]
Stock Position:  -0.05877405160018079
Bond Position:  [-2.65326375]


portfolio before change:  [-8.64943313]
curr_Stock_Price:  102.01786974502669
curr_Factors:  [102.01786975]
mat_Sqrt:  [[0.15]]
grads:  [0.03185812]
Stock Position:  0.03185812060825957
Bond Position:  [-11.89953072]


portfolio before change:  [-8.70622318]
curr_Stock_Price:  100.25862251347114
curr_Factors:  [100.25862251]
mat_Sqrt:  [[0.15]]
grads:  [0.16084842]
Stock Position:  0.1608484210071801
Bond Position:  [-24.8326643]


portfolio before change:  [-8.73577092]
curr_Stock_Price:  100.08457262011522
curr_Factors:  [100.08457262]
mat_Sqrt:  [[0.15]]
grads:  [0.03663901]
Stock Position:  0.03663901472032454
Bond Position:  [-12.40277105]


portfolio before change:  [-8.75197566]
curr_Stock_Price:  99.66344947926295
curr_Factors:  [99.66344948]
mat_Sqrt:  [[0.15]]
grads:  [0.05211116]
Stock Position:  0.05211115639932512
Bond Position:  [-13.94555326]


portfolio before change:  [-8.73104516]
curr_Stock_Price:  100.08182661068979
curr_Factors:  [100.08182661]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912904]
Stock Position:  -0.009129040823014125
Bond Position:  [-7.81739408]


portfolio before change:  [-8.7369352]
curr_Stock_Price:  100.67350238042991
curr_Factors:  [100.67350238]
mat_Sqrt:  [[0.15]]
grads:  [0.01744438]
Stock Position:  0.01744437795904378
Bond Position:  [-10.49312182]


portfolio before change:  [-8.73776947]
curr_Stock_Price:  100.66327379272128
curr_Factors:  [100.66327379]
mat_Sqrt:  [[0.15]]
grads:  [0.1333117]
Stock Position:  0.13331169515546404
Bond Position:  [-22.15736114]


portfolio before change:  [-8.89434906]
curr_Stock_Price:  99.49912449567874
curr_Factors:  [99.4991245]
mat_Sqrt:  [[0.15]]
grads:  [0.01137949]
Stock Position:  0.011379488665988766
Bond Position:  [-10.02659822]


portfolio before change:  [-8.90057828]
curr_Stock_Price:  99.0067883688871
curr_Factors:  [99.00678837]
mat_Sqrt:  [[0.15]]
grads:  [-0.10613757]
Stock Position:  -0.10613756752328325
Bond Position:  [1.60776141]


portfolio before change:  [-8.95562388]
curr_Stock_Price:  99.52636021960755
curr_Factors:  [99.52636022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359184]
Stock Position:  -0.03359183618178716
Bond Position:  [-5.6123507]


portfolio before change:  [-8.97987673]
curr_Stock_Price:  100.23790403857232
curr_Factors:  [100.23790404]
mat_Sqrt:  [[0.15]]
grads:  [0.00856847]
Stock Position:  0.008568472634076991
Bond Position:  [-9.83876247]


portfolio before change:  [-8.97821665]
curr_Stock_Price:  100.50341461565299
curr_Factors:  [100.50341462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00219685]
Stock Position:  -0.0021968523992442826
Bond Position:  [-8.75742548]


portfolio before change:  [-8.97924489]
curr_Stock_Price:  100.72231261446804
curr_Factors:  [100.72231261]
mat_Sqrt:  [[0.15]]
grads:  [-0.06266449]
Stock Position:  -0.06266449462463769
Bond Position:  [-2.66753208]


portfolio before change:  [-8.97853025]
curr_Stock_Price:  100.70824776001656
curr_Factors:  [100.70824776]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869245]
Stock Position:  -0.028692453333253883
Bond Position:  [-6.08896355]


portfolio before change:  [-8.97750847]
curr_Stock_Price:  100.65937238049602
curr_Factors:  [100.65937238]
mat_Sqrt:  [[0.15]]
grads:  [0.09106754]
Stock Position:  0.09106754255233915
Bond Position:  [-18.14431015]


portfolio before change:  [-8.98986282]
curr_Stock_Price:  100.53616388424443
curr_Factors:  [100.53616388]
mat_Sqrt:  [[0.15]]
grads:  [-0.11537445]
Stock Position:  -0.11537444546155934
Bond Position:  [2.60944134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.89375647]
Stock Price:  99.70458239236694
PL:  [-8.89375647]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.66372004e-03]
 [ 3.36555635e-02]
 [ 2.11310883e-02]
 [-1.39974448e-02]
 [-1.35871823e-03]
 [-3.51086184e-03]
 [-2.09651074e-03]
 [-4.43683460e-03]
 [-6.74781085e-03]
 [-8.95388771e-03]
 [ 1.35851086e-02]
 [-6.37603775e-03]
 [-1.43976550e-03]
 [ 8.84152100e-03]
 [-2.40825901e-03]
 [ 1.60986178e-02]
 [ 7.36295880e-02]
 [-1.26061134e-02]
 [ 1.76255058e-02]
 [ 1.33412579e-03]
 [-5.95277221e-03]
 [ 5.43100045e-03]
 [ 1.28297295e-02]
 [ 2.07482009e-02]
 [-3.10191800e-04]
 [ 7.93978380e-03]
 [ 9.89584432e-03]
 [ 1.94012728e-02]
 [ 2.61646357e-02]
 [-8.06386224e-03]
 [ 3.71192840e-03]
 [ 1.54477119e-02]
 [ 1.47083335e-02]
 [-6.02631768e-03]
 [ 4.12943000e-03]
 [-1.33363766e-02]
 [-9.78955453e-03]
 [-1.07320870e-02]
 [ 1.08943783e-03]
 [-5.46192827e-02]
 [ 3.32924033e-03]
 [-4.29139842e-03]
 [-1.90827958e-02]
 [ 2.61019161e-02]
 [-9.06300197e-03]
 [ 1.18335774e-02]
 [ 1.03536118e-02]
 [-3.72695520e-03]
 [ 1.65895499e-02]
 [-1.70696559e-03]
 [ 1.76282818e-02]
 [ 3.34326455e-02]
 [-1.06652125e-02]
 [-6.76361129e-02]
 [-2.12149861e-02]
 [-2.12625181e-03]
 [-8.73212240e-03]
 [-1.39334024e-02]
 [-2.80920250e-03]
 [-2.81983421e-03]
 [-7.73589198e-03]
 [-7.68155494e-03]
 [-1.59771760e-02]
 [-5.05255954e-04]
 [-1.61445220e-02]
 [ 3.54634642e-02]
 [-8.28600876e-03]
 [ 2.54560083e-02]
 [ 1.02001342e-02]
 [ 1.21503485e-02]
 [ 1.09015653e-02]
 [-1.41911292e-02]
 [-7.58002993e-02]
 [ 1.78523575e-04]
 [-2.13331569e-02]
 [-3.75615929e-02]
 [-6.60827687e-03]
 [ 2.67736428e-02]
 [ 1.27048751e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.81910585]
curr_Stock_Price:  100.4446051449439
curr_Factors:  [100.44460514]
mat_Sqrt:  [[0.15]]
grads:  [-0.0244248]
Stock Position:  -0.024424800255277535
Bond Position:  [14.27244526]


portfolio before change:  [11.81111402]
curr_Stock_Price:  100.80832913586755
curr_Factors:  [100.80832914]
mat_Sqrt:  [[0.15]]
grads:  [0.22437042]
Stock Position:  0.22437042348954106
Bond Position:  [-10.80729348]


portfolio before change:  [11.80304608]
curr_Stock_Price:  100.77538158913141
curr_Factors:  [100.77538159]
mat_Sqrt:  [[0.15]]
grads:  [0.14087392]
Stock Position:  0.1408739220358244
Bond Position:  [-2.39357717]


portfolio before change:  [11.77510263]
curr_Stock_Price:  100.57808568111173
curr_Factors:  [100.57808568]
mat_Sqrt:  [[0.15]]
grads:  [-0.0933163]
Stock Position:  -0.09331629839562729
Bond Position:  [21.16067729]


portfolio before change:  [11.7776729]
curr_Stock_Price:  100.56471522504198
curr_Factors:  [100.56471523]
mat_Sqrt:  [[0.15]]
grads:  [-0.00905812]
Stock Position:  -0.009058121528761818
Bond Position:  [12.68860031]


portfolio before change:  [11.7804902]
curr_Stock_Price:  100.34124243289835
curr_Factors:  [100.34124243]
mat_Sqrt:  [[0.15]]
grads:  [-0.02340575]
Stock Position:  -0.023405745610819532
Bond Position:  [14.1290518]


portfolio before change:  [11.77939452]
curr_Stock_Price:  100.42578456934379
curr_Factors:  [100.42578457]
mat_Sqrt:  [[0.15]]
grads:  [-0.01397674]
Stock Position:  -0.013976738288068771
Bond Position:  [13.18301943]


portfolio before change:  [11.78883876]
curr_Stock_Price:  99.8090264049704
curr_Factors:  [99.8090264]
mat_Sqrt:  [[0.15]]
grads:  [-0.0295789]
Stock Position:  -0.029578897332661464
Bond Position:  [14.7410797]


portfolio before change:  [11.78503188]
curr_Stock_Price:  99.96887771219771
curr_Factors:  [99.96887771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04498541]
Stock Position:  -0.04498540568155975
Bond Position:  [16.2821724]


portfolio before change:  [11.81279784]
curr_Stock_Price:  99.37427838118774
curr_Factors:  [99.37427838]
mat_Sqrt:  [[0.15]]
grads:  [-0.05969258]
Stock Position:  -0.05969258470791808
Bond Position:  [17.74470537]


portfolio before change:  [11.81031356]
curr_Stock_Price:  99.43447611677064
curr_Factors:  [99.43447612]
mat_Sqrt:  [[0.15]]
grads:  [0.09056739]
Stock Position:  0.09056739095435708
Bond Position:  [2.80479248]


portfolio before change:  [11.79950133]
curr_Stock_Price:  99.31315731353438
curr_Factors:  [99.31315731]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250692]
Stock Position:  -0.04250691834138752
Bond Position:  [16.0209976]


portfolio before change:  [11.77886418]
curr_Stock_Price:  99.82221557215546
curr_Factors:  [99.82221557]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959844]
Stock Position:  -0.009598436656690704
Bond Position:  [12.73700139]


portfolio before change:  [11.7754242]
curr_Stock_Price:  100.26354439648095
curr_Factors:  [100.2635444]
mat_Sqrt:  [[0.15]]
grads:  [0.05894347]
Stock Position:  0.058943473316627346
Bond Position:  [5.86554265]


portfolio before change:  [11.78718471]
curr_Stock_Price:  100.45684653548413
curr_Factors:  [100.45684654]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605506]
Stock Position:  -0.016055060038530022
Bond Position:  [13.40002541]


portfolio before change:  [11.78017853]
curr_Stock_Price:  100.94539673768706
curr_Factors:  [100.94539674]
mat_Sqrt:  [[0.15]]
grads:  [0.10732412]
Stock Position:  0.1073241187434075
Bond Position:  [0.94630279]


portfolio before change:  [11.85158951]
curr_Stock_Price:  101.61022240369982
curr_Factors:  [101.6102224]
mat_Sqrt:  [[0.15]]
grads:  [0.49086392]
Stock Position:  0.4908639198155616
Bond Position:  [-38.02520255]


portfolio before change:  [12.03246341]
curr_Stock_Price:  101.98354491546388
curr_Factors:  [101.98354492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08404076]
Stock Position:  -0.08404075630001294
Bond Position:  [20.60323765]


portfolio before change:  [12.11755194]
curr_Stock_Price:  100.98640027799311
curr_Factors:  [100.98640028]
mat_Sqrt:  [[0.15]]
grads:  [0.11750337]
Stock Position:  0.11750337207094365
Bond Position:  [0.25130938]


portfolio before change:  [12.19961098]
curr_Stock_Price:  101.68462134031344
curr_Factors:  [101.68462134]
mat_Sqrt:  [[0.15]]
grads:  [0.00889417]
Stock Position:  0.008894171911982078
Bond Position:  [11.29521048]


portfolio before change:  [12.20884695]
curr_Stock_Price:  102.64367648636957
curr_Factors:  [102.64367649]
mat_Sqrt:  [[0.15]]
grads:  [-0.03968515]
Stock Position:  -0.039685148061467876
Bond Position:  [16.28227645]


portfolio before change:  [12.21843018]
curr_Stock_Price:  102.42783862628046
curr_Factors:  [102.42783863]
mat_Sqrt:  [[0.15]]
grads:  [0.03620667]
Stock Position:  0.0362066696941149
Bond Position:  [8.50985926]


portfolio before change:  [12.18683457]
curr_Stock_Price:  101.5405023304843
curr_Factors:  [101.54050233]
mat_Sqrt:  [[0.15]]
grads:  [0.08553153]
Stock Position:  0.08553152996043674
Bond Position:  [3.50192006]


portfolio before change:  [12.17122576]
curr_Stock_Price:  101.3554513718927
curr_Factors:  [101.35545137]
mat_Sqrt:  [[0.15]]
grads:  [0.13832134]
Stock Position:  0.13832133905010088
Bond Position:  [-1.84839599]


portfolio before change:  [12.25920772]
curr_Stock_Price:  101.99235590021394
curr_Factors:  [101.9923559]
mat_Sqrt:  [[0.15]]
grads:  [-0.00206795]
Stock Position:  -0.002067945331998336
Bond Position:  [12.47012234]


portfolio before change:  [12.26010338]
curr_Stock_Price:  101.93613882562373
curr_Factors:  [101.93613883]
mat_Sqrt:  [[0.15]]
grads:  [0.05293189]
Stock Position:  0.05293189196817524
Bond Position:  [6.86443069]


portfolio before change:  [12.28809071]
curr_Stock_Price:  102.45677561989534
curr_Factors:  [102.45677562]
mat_Sqrt:  [[0.15]]
grads:  [0.0659723]
Stock Position:  0.06597229549468518
Bond Position:  [5.52878203]


portfolio before change:  [12.30645215]
curr_Stock_Price:  102.72985817725247
curr_Factors:  [102.72985818]
mat_Sqrt:  [[0.15]]
grads:  [0.12934182]
Stock Position:  0.1293418189690991
Bond Position:  [-0.98081457]


portfolio before change:  [12.2367235]
curr_Stock_Price:  102.19122845929725
curr_Factors:  [102.19122846]
mat_Sqrt:  [[0.15]]
grads:  [0.1744309]
Stock Position:  0.17443090442511014
Bond Position:  [-5.5885849]


portfolio before change:  [12.33214132]
curr_Stock_Price:  102.74025451412278
curr_Factors:  [102.74025451]
mat_Sqrt:  [[0.15]]
grads:  [-0.05375908]
Stock Position:  -0.053759081593895516
Bond Position:  [17.85536304]


portfolio before change:  [12.25914929]
curr_Stock_Price:  104.11877548766901
curr_Factors:  [104.11877549]
mat_Sqrt:  [[0.15]]
grads:  [0.02474619]
Stock Position:  0.024746189303267038
Bond Position:  [9.68260636]


portfolio before change:  [12.27154501]
curr_Stock_Price:  104.59523429307431
curr_Factors:  [104.59523429]
mat_Sqrt:  [[0.15]]
grads:  [0.10298475]
Stock Position:  0.10298474630807136
Bond Position:  [1.49983134]


portfolio before change:  [12.17238233]
curr_Stock_Price:  103.63143693135792
curr_Factors:  [103.63143693]
mat_Sqrt:  [[0.15]]
grads:  [0.09805556]
Stock Position:  0.09805555690929339
Bond Position:  [2.01074407]


portfolio before change:  [12.1840542]
curr_Stock_Price:  103.7491885146312
curr_Factors:  [103.74918851]
mat_Sqrt:  [[0.15]]
grads:  [-0.04017545]
Stock Position:  -0.04017545119717687
Bond Position:  [16.35222466]


portfolio before change:  [12.13559173]
curr_Stock_Price:  104.98089879508139
curr_Factors:  [104.9808988]
mat_Sqrt:  [[0.15]]
grads:  [0.02752953]
Stock Position:  0.027529533335252696
Bond Position:  [9.24551658]


portfolio before change:  [12.1414783]
curr_Stock_Price:  105.17373571798916
curr_Factors:  [105.17373572]
mat_Sqrt:  [[0.15]]
grads:  [-0.08890918]
Stock Position:  -0.08890917760843699
Bond Position:  [21.49238865]


portfolio before change:  [12.20044129]
curr_Stock_Price:  104.52566235073276
curr_Factors:  [104.52566235]
mat_Sqrt:  [[0.15]]
grads:  [-0.0652637]
Stock Position:  -0.06526369685284558
Bond Position:  [19.02217243]


portfolio before change:  [12.22856415]
curr_Stock_Price:  104.11296836260662
curr_Factors:  [104.11296836]
mat_Sqrt:  [[0.15]]
grads:  [-0.07154725]
Stock Position:  -0.07154724654170085
Bond Position:  [19.67756036]


portfolio before change:  [12.17459338]
curr_Stock_Price:  104.88449561069226
curr_Factors:  [104.88449561]
mat_Sqrt:  [[0.15]]
grads:  [0.00726292]
Stock Position:  0.007262918843088708
Bond Position:  [11.4128258]


portfolio before change:  [12.17932224]
curr_Stock_Price:  105.43737766117738
curr_Factors:  [105.43737766]
mat_Sqrt:  [[0.15]]
grads:  [-0.36412855]
Stock Position:  -0.3641285512527992
Bond Position:  [50.57208182]


portfolio before change:  [12.12367889]
curr_Stock_Price:  105.59887065201903
curr_Factors:  [105.59887065]
mat_Sqrt:  [[0.15]]
grads:  [0.02219494]
Stock Position:  0.022194935546275385
Bond Position:  [9.77991876]


portfolio before change:  [12.14664419]
curr_Stock_Price:  106.60603897492413
curr_Factors:  [106.60603897]
mat_Sqrt:  [[0.15]]
grads:  [-0.02860932]
Stock Position:  -0.02860932282535797
Bond Position:  [15.19657077]


portfolio before change:  [12.14852344]
curr_Stock_Price:  106.57355187918375
curr_Factors:  [106.57355188]
mat_Sqrt:  [[0.15]]
grads:  [-0.12721864]
Stock Position:  -0.12721863834593652
Bond Position:  [25.70666559]


portfolio before change:  [12.07002027]
curr_Stock_Price:  107.20325430392488
curr_Factors:  [107.2032543]
mat_Sqrt:  [[0.15]]
grads:  [0.17401277]
Stock Position:  0.17401277368290222
Bond Position:  [-6.58471536]


portfolio before change:  [11.93250202]
curr_Stock_Price:  106.4153426146266
curr_Factors:  [106.41534261]
mat_Sqrt:  [[0.15]]
grads:  [-0.06042001]
Stock Position:  -0.06042001310301304
Bond Position:  [18.36211841]


portfolio before change:  [11.89960712]
curr_Stock_Price:  106.97877449317028
curr_Factors:  [106.97877449]
mat_Sqrt:  [[0.15]]
grads:  [0.07889052]
Stock Position:  0.07889051571617513
Bond Position:  [3.45999643]


portfolio before change:  [11.95829263]
curr_Stock_Price:  107.71991879736508
curr_Factors:  [107.7199188]
mat_Sqrt:  [[0.15]]
grads:  [0.06902408]
Stock Position:  0.06902407887195913
Bond Position:  [4.52302446]


portfolio before change:  [11.93427705]
curr_Stock_Price:  107.36789268499594
curr_Factors:  [107.36789268]
mat_Sqrt:  [[0.15]]
grads:  [-0.02484637]
Stock Position:  -0.02484636799318142
Bond Position:  [14.60197923]


portfolio before change:  [11.90691304]
curr_Stock_Price:  108.50595289681306
curr_Factors:  [108.5059529]
mat_Sqrt:  [[0.15]]
grads:  [0.110597]
Stock Position:  0.11059699907501382
Bond Position:  [-0.09351973]


portfolio before change:  [11.97798135]
curr_Stock_Price:  109.14859373189432
curr_Factors:  [109.14859373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01137977]
Stock Position:  -0.011379770587294875
Bond Position:  [13.2200673]


portfolio before change:  [11.99258744]
curr_Stock_Price:  107.93768936215892
curr_Factors:  [107.93768936]
mat_Sqrt:  [[0.15]]
grads:  [0.11752188]
Stock Position:  0.11752187855801294
Bond Position:  [-0.69245258]


portfolio before change:  [12.04729205]
curr_Stock_Price:  108.40354211908698
curr_Factors:  [108.40354212]
mat_Sqrt:  [[0.15]]
grads:  [0.2228843]
Stock Position:  0.22288430357803188
Bond Position:  [-12.11415594]


portfolio before change:  [12.08069574]
curr_Stock_Price:  108.55680930078069
curr_Factors:  [108.5568093]
mat_Sqrt:  [[0.15]]
grads:  [-0.07110142]
Stock Position:  -0.07110141675461455
Bond Position:  [19.79923868]


portfolio before change:  [12.16374698]
curr_Stock_Price:  107.40614666195715
curr_Factors:  [107.40614666]
mat_Sqrt:  [[0.15]]
grads:  [-0.45090742]
Stock Position:  -0.45090741939154244
Bond Position:  [60.5939754]


portfolio before change:  [12.22087365]
curr_Stock_Price:  107.28785314043672
curr_Factors:  [107.28785314]
mat_Sqrt:  [[0.15]]
grads:  [-0.14143324]
Stock Position:  -0.14143324054284678
Bond Position:  [27.39494239]


portfolio before change:  [12.22315639]
curr_Stock_Price:  107.28381938056759
curr_Factors:  [107.28381938]
mat_Sqrt:  [[0.15]]
grads:  [-0.01417501]
Stock Position:  -0.01417501203705358
Bond Position:  [13.74390582]


portfolio before change:  [12.20426877]
curr_Stock_Price:  108.67687939901317
curr_Factors:  [108.6768794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05821415]
Stock Position:  -0.05821414931160765
Bond Position:  [18.53080085]


portfolio before change:  [12.20504148]
curr_Stock_Price:  108.68350150816954
curr_Factors:  [108.68350151]
mat_Sqrt:  [[0.15]]
grads:  [-0.09288935]
Stock Position:  -0.09288934912823901
Bond Position:  [22.3005812]


portfolio before change:  [12.1215865]
curr_Stock_Price:  109.59694111533152
curr_Factors:  [109.59694112]
mat_Sqrt:  [[0.15]]
grads:  [-0.01872802]
Stock Position:  -0.018728016666177735
Bond Position:  [14.17411984]


portfolio before change:  [12.13094893]
curr_Stock_Price:  109.14432933042791
curr_Factors:  [109.14432933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01879889]
Stock Position:  -0.01879889470163419
Bond Position:  [14.18274169]


portfolio before change:  [12.14712753]
curr_Stock_Price:  108.33086934667476
curr_Factors:  [108.33086935]
mat_Sqrt:  [[0.15]]
grads:  [-0.05157261]
Stock Position:  -0.051572613170441636
Bond Position:  [17.73403355]


portfolio before change:  [12.11590575]
curr_Stock_Price:  108.9577561430488
curr_Factors:  [108.95775614]
mat_Sqrt:  [[0.15]]
grads:  [-0.05121037]
Stock Position:  -0.05121036624554087
Bond Position:  [17.69567235]


portfolio before change:  [12.11853578]
curr_Stock_Price:  108.92799631430448
curr_Factors:  [108.92799631]
mat_Sqrt:  [[0.15]]
grads:  [-0.10651451]
Stock Position:  -0.10651450684768934
Bond Position:  [23.72094758]


portfolio before change:  [12.15338016]
curr_Stock_Price:  108.61478280639159
curr_Factors:  [108.61478281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00336837]
Stock Position:  -0.003368373029332777
Bond Position:  [12.51923527]


portfolio before change:  [12.14986283]
curr_Stock_Price:  109.89130855408342
curr_Factors:  [109.89130855]
mat_Sqrt:  [[0.15]]
grads:  [-0.10763015]
Stock Position:  -0.10763014661220564
Bond Position:  [23.97748048]


portfolio before change:  [12.1674998]
curr_Stock_Price:  109.7413660384005
curr_Factors:  [109.74136604]
mat_Sqrt:  [[0.15]]
grads:  [0.23642309]
Stock Position:  0.23642309494229213
Bond Position:  [-13.7778936]


portfolio before change:  [12.28987594]
curr_Stock_Price:  110.26262344412537
curr_Factors:  [110.26262344]
mat_Sqrt:  [[0.15]]
grads:  [-0.05524006]
Stock Position:  -0.05524005838589095
Bond Position:  [18.3807897]


portfolio before change:  [12.27414542]
curr_Stock_Price:  110.56818712444108
curr_Factors:  [110.56818712]
mat_Sqrt:  [[0.15]]
grads:  [0.16970672]
Stock Position:  0.16970672202961845
Bond Position:  [-6.49001917]


portfolio before change:  [12.30287798]
curr_Stock_Price:  110.73988449049729
curr_Factors:  [110.73988449]
mat_Sqrt:  [[0.15]]
grads:  [0.06800089]
Stock Position:  0.0680008944931874
Bond Position:  [4.77246678]


portfolio before change:  [12.31305109]
curr_Stock_Price:  110.88510057829447
curr_Factors:  [110.88510058]
mat_Sqrt:  [[0.15]]
grads:  [0.08100232]
Stock Position:  0.08100232335286851
Bond Position:  [3.33110032]


portfolio before change:  [12.2894244]
curr_Stock_Price:  110.59085106517114
curr_Factors:  [110.59085107]
mat_Sqrt:  [[0.15]]
grads:  [0.0726771]
Stock Position:  0.07267710224074551
Bond Position:  [4.25200181]


portfolio before change:  [12.26044408]
curr_Stock_Price:  110.18843995182633
curr_Factors:  [110.18843995]
mat_Sqrt:  [[0.15]]
grads:  [-0.09460753]
Stock Position:  -0.09460752767350598
Bond Position:  [22.68509997]


portfolio before change:  [12.16777825]
curr_Stock_Price:  111.18290311562271
curr_Factors:  [111.18290312]
mat_Sqrt:  [[0.15]]
grads:  [-0.50533533]
Stock Position:  -0.505335328699562
Bond Position:  [68.35242714]


portfolio before change:  [11.64258603]
curr_Stock_Price:  112.2306517052955
curr_Factors:  [112.23065171]
mat_Sqrt:  [[0.15]]
grads:  [0.00119016]
Stock Position:  0.0011901571686716564
Bond Position:  [11.50901391]


portfolio before change:  [11.64341715]
curr_Stock_Price:  112.32457929977403
curr_Factors:  [112.3245793]
mat_Sqrt:  [[0.15]]
grads:  [-0.14222105]
Stock Position:  -0.14222104594624374
Bond Position:  [27.61833631]


portfolio before change:  [11.61935212]
curr_Stock_Price:  112.50592540252022
curr_Factors:  [112.5059254]
mat_Sqrt:  [[0.15]]
grads:  [-0.25041062]
Stock Position:  -0.2504106194516661
Bond Position:  [39.79203059]


portfolio before change:  [11.67000491]
curr_Stock_Price:  112.3135784841887
curr_Factors:  [112.31357848]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405518]
Stock Position:  -0.04405517911260274
Bond Position:  [16.61799973]


portfolio before change:  [11.68215233]
curr_Stock_Price:  112.0614228928375
curr_Factors:  [112.06142289]
mat_Sqrt:  [[0.15]]
grads:  [0.17849095]
Stock Position:  0.17849095223521028
Bond Position:  [-8.31979775]


portfolio before change:  [11.66675193]
curr_Stock_Price:  111.97805511751876
curr_Factors:  [111.97805512]
mat_Sqrt:  [[0.15]]
grads:  [0.84699167]
Stock Position:  0.8469916718983876
Bond Position:  [-83.17772819]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.99059812]
Stock Price:  112.3665417682171
PL:  [-0.37594365]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-9.04798384e-03]
 [ 7.00462012e-03]
 [ 1.76323841e-02]
 [-1.82346013e-02]
 [-5.51624918e-04]
 [-1.65422820e-03]
 [-3.54651003e-03]
 [-1.02251916e-02]
 [-1.56828323e-02]
 [-1.25376829e-02]
 [ 8.72226983e-03]
 [-7.31789310e-03]
 [ 4.69865629e-03]
 [-8.53109371e-03]
 [ 8.75860871e-03]
 [ 1.42265319e-03]
 [-4.14140621e-02]
 [-1.08442722e-02]
 [ 2.40941282e-02]
 [-2.63239386e-03]
 [-1.68282004e-02]
 [ 5.47864887e-03]
 [ 1.41966126e-02]
 [ 2.08495009e-02]
 [ 1.60755150e-03]
 [ 4.42089252e-03]
 [ 5.77778063e-03]
 [ 9.23313053e-03]
 [ 1.59385739e-02]
 [ 2.50820983e-02]
 [-6.87007819e-03]
 [ 2.16903292e-02]
 [ 1.23450534e-02]
 [-1.98895416e-02]
 [-1.30941700e-02]
 [-4.36088895e-02]
 [ 1.97797933e-02]
 [-8.61454532e-03]
 [ 6.66297440e-02]
 [ 2.58117891e-02]
 [ 6.52474636e-03]
 [ 3.54284566e-02]
 [-3.37551903e-03]
 [ 2.62452838e-02]
 [-5.78333374e-02]
 [ 2.63602975e-02]
 [ 8.69263384e-03]
 [ 5.40316343e-03]
 [-1.64445999e-02]
 [ 3.01901219e-04]
 [ 9.65464880e-04]
 [-4.91511695e-03]
 [-2.61434730e-03]
 [-3.57959144e-04]
 [-2.15684111e-02]
 [-5.56470264e-03]
 [-7.17471483e-03]
 [ 1.45760028e-02]
 [ 5.79127703e-03]
 [-2.20949607e-03]
 [-5.15772975e-03]
 [-4.07447701e-03]
 [ 2.54175309e-03]
 [-6.13932169e-03]
 [ 1.72966378e-02]
 [ 8.58437572e-03]
 [ 2.05806959e-02]
 [-6.40446328e-03]
 [ 1.00470052e-02]
 [ 3.11309518e-02]
 [ 3.19473401e-03]
 [-1.50320136e-02]
 [-5.96488663e-03]
 [ 3.61445119e-03]
 [ 1.26443000e-02]
 [ 2.27530931e-02]
 [ 7.64630156e-03]
 [-3.68944696e-02]
 [-2.67460507e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.95978208]
curr_Stock_Price:  100.08765076542207
curr_Factors:  [100.08765077]
mat_Sqrt:  [[0.15]]
grads:  [-0.06031989]
Stock Position:  -0.060319892254111336
Bond Position:  [9.99705839]


portfolio before change:  [3.97611329]
curr_Stock_Price:  99.82726598970577
curr_Factors:  [99.82726599]
mat_Sqrt:  [[0.15]]
grads:  [0.04669747]
Stock Position:  0.04669746743568086
Bond Position:  [-0.68556721]


portfolio before change:  [4.0063642]
curr_Stock_Price:  100.47598965120264
curr_Factors:  [100.47598965]
mat_Sqrt:  [[0.15]]
grads:  [0.11754923]
Stock Position:  0.11754922756688331
Bond Position:  [-7.80451077]


portfolio before change:  [4.04062679]
curr_Stock_Price:  100.77161383349979
curr_Factors:  [100.77161383]
mat_Sqrt:  [[0.15]]
grads:  [-0.12156401]
Stock Position:  -0.12156400858465741
Bond Position:  [16.29082812]


portfolio before change:  [4.06916037]
curr_Stock_Price:  100.54526915034397
curr_Factors:  [100.54526915]
mat_Sqrt:  [[0.15]]
grads:  [-0.0036775]
Stock Position:  -0.0036774994540214488
Bond Position:  [4.43891554]


portfolio before change:  [4.06881814]
curr_Stock_Price:  100.71377271094343
curr_Factors:  [100.71377271]
mat_Sqrt:  [[0.15]]
grads:  [-0.01102819]
Stock Position:  -0.011028188008671627
Bond Position:  [5.17950856]


portfolio before change:  [4.06155557]
curr_Stock_Price:  101.40167376540163
curr_Factors:  [101.40167377]
mat_Sqrt:  [[0.15]]
grads:  [-0.0236434]
Stock Position:  -0.02364340022921611
Bond Position:  [6.45903592]


portfolio before change:  [4.08966111]
curr_Stock_Price:  100.23002141522889
curr_Factors:  [100.23002142]
mat_Sqrt:  [[0.15]]
grads:  [-0.06816794]
Stock Position:  -0.06816794368497205
Bond Position:  [10.92213557]


portfolio before change:  [4.16810384]
curr_Stock_Price:  99.08930823812517
curr_Factors:  [99.08930824]
mat_Sqrt:  [[0.15]]
grads:  [-0.10455222]
Stock Position:  -0.10455221562591042
Bond Position:  [14.52811056]


portfolio before change:  [4.19224246]
curr_Stock_Price:  98.86711706266642
curr_Factors:  [98.86711706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08358455]
Stock Position:  -0.08358455246653904
Bond Position:  [12.45600619]


portfolio before change:  [4.26285755]
curr_Stock_Price:  98.03159700630508
curr_Factors:  [98.03159701]
mat_Sqrt:  [[0.15]]
grads:  [0.05814847]
Stock Position:  0.05814846555643493
Bond Position:  [-1.43752939]


portfolio before change:  [4.2524281]
curr_Stock_Price:  97.85378309813002
curr_Factors:  [97.8537831]
mat_Sqrt:  [[0.15]]
grads:  [-0.04878595]
Stock Position:  -0.04878595400505771
Bond Position:  [9.02631826]


portfolio before change:  [4.2825953]
curr_Stock_Price:  97.24698871014174
curr_Factors:  [97.24698871]
mat_Sqrt:  [[0.15]]
grads:  [0.03132438]
Stock Position:  0.03132437529274591
Bond Position:  [1.23639413]


portfolio before change:  [4.26458457]
curr_Stock_Price:  96.66954672807927
curr_Factors:  [96.66954673]
mat_Sqrt:  [[0.15]]
grads:  [-0.05687396]
Stock Position:  -0.056873958088725814
Bond Position:  [9.76256432]


portfolio before change:  [4.27747554]
curr_Stock_Price:  96.45361680871004
curr_Factors:  [96.45361681]
mat_Sqrt:  [[0.15]]
grads:  [0.05839072]
Stock Position:  0.05839072471481665
Bond Position:  [-1.35452105]


portfolio before change:  [4.29994992]
curr_Stock_Price:  96.83996314983024
curr_Factors:  [96.83996315]
mat_Sqrt:  [[0.15]]
grads:  [0.00948435]
Stock Position:  0.009484354605577689
Bond Position:  [3.38148537]


portfolio before change:  [4.29716744]
curr_Stock_Price:  96.52430359395836
curr_Factors:  [96.52430359]
mat_Sqrt:  [[0.15]]
grads:  [-0.27609375]
Stock Position:  -0.27609374743792553
Bond Position:  [30.94692414]


portfolio before change:  [4.18099001]
curr_Stock_Price:  96.95209914640358
curr_Factors:  [96.95209915]
mat_Sqrt:  [[0.15]]
grads:  [-0.07229515]
Stock Position:  -0.0722951479273949
Bond Position:  [11.19015636]


portfolio before change:  [4.17697779]
curr_Stock_Price:  97.01727130186333
curr_Factors:  [97.0172713]
mat_Sqrt:  [[0.15]]
grads:  [0.16062752]
Stock Position:  0.1606275214477552
Bond Position:  [-11.40666604]


portfolio before change:  [4.25419283]
curr_Stock_Price:  97.50241842497698
curr_Factors:  [97.50241842]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754929]
Stock Position:  -0.017549292392714563
Bond Position:  [5.96529128]


portfolio before change:  [4.26039022]
curr_Stock_Price:  97.17052184129723
curr_Factors:  [97.17052184]
mat_Sqrt:  [[0.15]]
grads:  [-0.112188]
Stock Position:  -0.11218800279292104
Bond Position:  [15.16175699]


portfolio before change:  [4.14962143]
curr_Stock_Price:  98.16631840964571
curr_Factors:  [98.16631841]
mat_Sqrt:  [[0.15]]
grads:  [0.03652433]
Stock Position:  0.0365243258130912
Bond Position:  [0.56416283]


portfolio before change:  [4.14824006]
curr_Stock_Price:  98.12753254376821
curr_Factors:  [98.12753254]
mat_Sqrt:  [[0.15]]
grads:  [0.09464408]
Stock Position:  0.09464408428743049
Bond Position:  [-5.1389504]


portfolio before change:  [4.12081784]
curr_Stock_Price:  97.84118572581062
curr_Factors:  [97.84118573]
mat_Sqrt:  [[0.15]]
grads:  [0.13899667]
Stock Position:  0.13899667266212778
Bond Position:  [-9.47878143]


portfolio before change:  [4.07418191]
curr_Stock_Price:  97.50992969449507
curr_Factors:  [97.50992969]
mat_Sqrt:  [[0.15]]
grads:  [0.01071701]
Stock Position:  0.010717009979653858
Bond Position:  [3.02916702]


portfolio before change:  [4.07871346]
curr_Stock_Price:  97.91510126705654
curr_Factors:  [97.91510127]
mat_Sqrt:  [[0.15]]
grads:  [0.02947262]
Stock Position:  0.029472616795687013
Bond Position:  [1.19289921]


portfolio before change:  [4.08350105]
curr_Stock_Price:  98.07501339823126
curr_Factors:  [98.0750134]
mat_Sqrt:  [[0.15]]
grads:  [0.03851854]
Stock Position:  0.03851853750219678
Bond Position:  [0.30579497]


portfolio before change:  [4.07617775]
curr_Stock_Price:  97.88439309473327
curr_Factors:  [97.88439309]
mat_Sqrt:  [[0.15]]
grads:  [0.0615542]
Stock Position:  0.06155420350639702
Bond Position:  [-1.9490181]


portfolio before change:  [4.08276867]
curr_Stock_Price:  97.99344717313708
curr_Factors:  [97.99344717]
mat_Sqrt:  [[0.15]]
grads:  [0.10625716]
Stock Position:  0.10625715914245284
Bond Position:  [-6.32973664]


portfolio before change:  [4.04376713]
curr_Stock_Price:  97.63012182297193
curr_Factors:  [97.63012182]
mat_Sqrt:  [[0.15]]
grads:  [0.16721399]
Stock Position:  0.16721398890563816
Bond Position:  [-12.28135498]


portfolio before change:  [3.89675944]
curr_Stock_Price:  96.75555334540039
curr_Factors:  [96.75555335]
mat_Sqrt:  [[0.15]]
grads:  [-0.04580052]
Stock Position:  -0.045800521260199935
Bond Position:  [8.32821421]


portfolio before change:  [3.91103608]
curr_Stock_Price:  96.455204952422
curr_Factors:  [96.45520495]
mat_Sqrt:  [[0.15]]
grads:  [0.14460219]
Stock Position:  0.1446021945550743
Bond Position:  [-10.03659823]


portfolio before change:  [3.94553436]
curr_Stock_Price:  96.69811678117046
curr_Factors:  [96.69811678]
mat_Sqrt:  [[0.15]]
grads:  [0.08230036]
Stock Position:  0.08230035607881978
Bond Position:  [-4.01275509]


portfolio before change:  [3.94836405]
curr_Stock_Price:  96.73554674539271
curr_Factors:  [96.73554675]
mat_Sqrt:  [[0.15]]
grads:  [-0.13259694]
Stock Position:  -0.13259694379623263
Bond Position:  [16.7752019]


portfolio before change:  [4.02032798]
curr_Stock_Price:  96.20072709826267
curr_Factors:  [96.2007271]
mat_Sqrt:  [[0.15]]
grads:  [-0.08729447]
Stock Position:  -0.0872944666856613
Bond Position:  [12.41811915]


portfolio before change:  [4.09173073]
curr_Stock_Price:  95.39166564148289
curr_Factors:  [95.39166564]
mat_Sqrt:  [[0.15]]
grads:  [-0.29072593]
Stock Position:  -0.2907259302605265
Bond Position:  [31.82456146]


portfolio before change:  [4.57437946]
curr_Stock_Price:  93.73835720748909
curr_Factors:  [93.73835721]
mat_Sqrt:  [[0.15]]
grads:  [0.13186529]
Stock Position:  0.1318652889231269
Bond Position:  [-7.7864561]


portfolio before change:  [4.61168408]
curr_Stock_Price:  94.02494733423386
curr_Factors:  [94.02494733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0574303]
Stock Position:  -0.05743030215427259
Bond Position:  [10.01156522]


portfolio before change:  [4.59631655]
curr_Stock_Price:  94.30342875763738
curr_Factors:  [94.30342876]
mat_Sqrt:  [[0.15]]
grads:  [0.44419829]
Stock Position:  0.44419829354959495
Bond Position:  [-37.29310558]


portfolio before change:  [4.68022208]
curr_Stock_Price:  94.49756823796577
curr_Factors:  [94.49756824]
mat_Sqrt:  [[0.15]]
grads:  [0.17207859]
Stock Position:  0.17207859421379387
Bond Position:  [-11.58078662]


portfolio before change:  [4.75435588]
curr_Stock_Price:  94.93258816637001
curr_Factors:  [94.93258817]
mat_Sqrt:  [[0.15]]
grads:  [0.04349831]
Stock Position:  0.04349830905669361
Bond Position:  [0.62494882]


portfolio before change:  [4.75118127]
curr_Stock_Price:  94.85870792209818
curr_Factors:  [94.85870792]
mat_Sqrt:  [[0.15]]
grads:  [0.23618971]
Stock Position:  0.23618971087193516
Bond Position:  [-17.65346952]


portfolio before change:  [4.74117344]
curr_Stock_Price:  94.82100746293807
curr_Factors:  [94.82100746]
mat_Sqrt:  [[0.15]]
grads:  [-0.02250346]
Stock Position:  -0.022503460194083454
Bond Position:  [6.8749742]


portfolio before change:  [4.74558241]
curr_Stock_Price:  94.64417817236952
curr_Factors:  [94.64417817]
mat_Sqrt:  [[0.15]]
grads:  [0.17496856]
Stock Position:  0.17496855891849183
Bond Position:  [-11.81417306]


portfolio before change:  [4.83331453]
curr_Stock_Price:  95.1498148962387
curr_Factors:  [95.1498149]
mat_Sqrt:  [[0.15]]
grads:  [-0.38555558]
Stock Position:  -0.38555558289912945
Bond Position:  [41.51885687]


portfolio before change:  [5.25733287]
curr_Stock_Price:  94.05678616156256
curr_Factors:  [94.05678616]
mat_Sqrt:  [[0.15]]
grads:  [0.17573532]
Stock Position:  0.17573531660949437
Bond Position:  [-11.27176623]


portfolio before change:  [5.29868592]
curr_Stock_Price:  94.29610949420207
curr_Factors:  [94.29610949]
mat_Sqrt:  [[0.15]]
grads:  [0.05795089]
Stock Position:  0.05795089225084124
Bond Position:  [-0.16585776]


portfolio before change:  [5.32804268]
curr_Stock_Price:  94.80286836704572
curr_Factors:  [94.80286837]
mat_Sqrt:  [[0.15]]
grads:  [0.03602109]
Stock Position:  0.0360210895033399
Bond Position:  [1.91314008]


portfolio before change:  [5.29144927]
curr_Stock_Price:  93.78366015818476
curr_Factors:  [93.78366016]
mat_Sqrt:  [[0.15]]
grads:  [-0.10963067]
Stock Position:  -0.10963066583825065
Bond Position:  [15.57301438]


portfolio before change:  [5.2462668]
curr_Stock_Price:  94.20467206082866
curr_Factors:  [94.20467206]
mat_Sqrt:  [[0.15]]
grads:  [0.00201267]
Stock Position:  0.002012674790115577
Bond Position:  [5.05666343]


portfolio before change:  [5.24616951]
curr_Stock_Price:  93.99930369351753
curr_Factors:  [93.99930369]
mat_Sqrt:  [[0.15]]
grads:  [0.00643643]
Stock Position:  0.006436432536596806
Bond Position:  [4.64114933]


portfolio before change:  [5.24075254]
curr_Stock_Price:  93.11262386529366
curr_Factors:  [93.11262387]
mat_Sqrt:  [[0.15]]
grads:  [-0.03276745]
Stock Position:  -0.0327674463299976
Bond Position:  [8.29181544]


portfolio before change:  [5.26914169]
curr_Stock_Price:  92.26205716139887
curr_Factors:  [92.26205716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742898]
Stock Position:  -0.017428981972529078
Bond Position:  [6.87717542]


portfolio before change:  [5.25814914]
curr_Stock_Price:  92.91742466120755
curr_Factors:  [92.91742466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00238639]
Stock Position:  -0.0023863942922657906
Bond Position:  [5.47988675]


portfolio before change:  [5.25727347]
curr_Stock_Price:  93.42788908554954
curr_Factors:  [93.42788909]
mat_Sqrt:  [[0.15]]
grads:  [-0.14378941]
Stock Position:  -0.14378940729693282
Bond Position:  [18.69121427]


portfolio before change:  [5.19745105]
curr_Stock_Price:  93.85205566728713
curr_Factors:  [93.85205567]
mat_Sqrt:  [[0.15]]
grads:  [-0.03709802]
Stock Position:  -0.03709801760066912
Bond Position:  [8.67917626]


portfolio before change:  [5.21815925]
curr_Stock_Price:  93.30847565340304
curr_Factors:  [93.30847565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04783143]
Stock Position:  -0.047831432203211136
Bond Position:  [9.68123728]


portfolio before change:  [5.21225444]
curr_Stock_Price:  93.44457678383927
curr_Factors:  [93.44457678]
mat_Sqrt:  [[0.15]]
grads:  [0.09717335]
Stock Position:  0.09717335195714176
Bond Position:  [-3.86806831]


portfolio before change:  [5.25075923]
curr_Stock_Price:  93.8433132343188
curr_Factors:  [93.84331323]
mat_Sqrt:  [[0.15]]
grads:  [0.03860851]
Stock Position:  0.038608513515659186
Bond Position:  [1.62760841]


portfolio before change:  [5.24784557]
curr_Stock_Price:  93.76521135908493
curr_Factors:  [93.76521136]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472997]
Stock Position:  -0.014729973775574109
Bond Position:  [6.62900467]


portfolio before change:  [5.24865522]
curr_Stock_Price:  93.73837272045651
curr_Factors:  [93.73837272]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438486]
Stock Position:  -0.03438486496869473
Bond Position:  [8.47183651]


portfolio before change:  [5.25308319]
curr_Stock_Price:  93.62499554982301
curr_Factors:  [93.62499555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02716318]
Stock Position:  -0.027163180048334155
Bond Position:  [7.7962358]


portfolio before change:  [5.26619357]
curr_Stock_Price:  93.1602817229663
curr_Factors:  [93.16028172]
mat_Sqrt:  [[0.15]]
grads:  [0.01694502]
Stock Position:  0.01694502061548356
Bond Position:  [3.68759068]


portfolio before change:  [5.28404846]
curr_Stock_Price:  94.2003748257862
curr_Factors:  [94.20037483]
mat_Sqrt:  [[0.15]]
grads:  [-0.04092881]
Stock Position:  -0.04092881126118589
Bond Position:  [9.13955782]


portfolio before change:  [5.29743091]
curr_Stock_Price:  93.88736263513705
curr_Factors:  [93.88736264]
mat_Sqrt:  [[0.15]]
grads:  [0.11531092]
Stock Position:  0.11531091890252528
Bond Position:  [-5.52880715]


portfolio before change:  [5.29974332]
curr_Stock_Price:  93.91041311295128
curr_Factors:  [93.91041311]
mat_Sqrt:  [[0.15]]
grads:  [0.05722917]
Stock Position:  0.05722917148276529
Bond Position:  [-0.07467181]


portfolio before change:  [5.2390863]
curr_Stock_Price:  92.85059778356873
curr_Factors:  [92.85059778]
mat_Sqrt:  [[0.15]]
grads:  [0.13720464]
Stock Position:  0.13720463962615445
Bond Position:  [-7.50044651]


portfolio before change:  [5.23487974]
curr_Stock_Price:  92.82335550720364
curr_Factors:  [92.82335551]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269642]
Stock Position:  -0.04269642185726639
Bond Position:  [9.19810489]


portfolio before change:  [5.2437788]
curr_Stock_Price:  92.62839393653925
curr_Factors:  [92.62839394]
mat_Sqrt:  [[0.15]]
grads:  [0.06698003]
Stock Position:  0.06698003487250022
Bond Position:  [-0.96047425]


portfolio before change:  [5.24614682]
curr_Stock_Price:  92.66464421666721
curr_Factors:  [92.66464422]
mat_Sqrt:  [[0.15]]
grads:  [0.20753968]
Stock Position:  0.2075396789392819
Bond Position:  [-13.98544369]


portfolio before change:  [5.22958058]
curr_Stock_Price:  92.58903398802546
curr_Factors:  [92.58903399]
mat_Sqrt:  [[0.15]]
grads:  [0.02129823]
Stock Position:  0.02129822670440867
Bond Position:  [3.25759834]


portfolio before change:  [5.24198752]
curr_Stock_Price:  93.16200847247512
curr_Factors:  [93.16200847]
mat_Sqrt:  [[0.15]]
grads:  [-0.10021342]
Stock Position:  -0.10021342412233628
Bond Position:  [14.57807139]


portfolio before change:  [5.27957437]
curr_Stock_Price:  92.79603271621046
curr_Factors:  [92.79603272]
mat_Sqrt:  [[0.15]]
grads:  [-0.03976591]
Stock Position:  -0.03976591083974445
Bond Position:  [8.96969313]


portfolio before change:  [5.28875944]
curr_Stock_Price:  92.57915232417726
curr_Factors:  [92.57915232]
mat_Sqrt:  [[0.15]]
grads:  [0.02409634]
Stock Position:  0.024096341238788843
Bond Position:  [3.05794059]


portfolio before change:  [5.28880236]
curr_Stock_Price:  92.57300169310716
curr_Factors:  [92.57300169]
mat_Sqrt:  [[0.15]]
grads:  [0.08429533]
Stock Position:  0.08429533319014358
Bond Position:  [-2.51466967]


portfolio before change:  [5.23055108]
curr_Stock_Price:  91.88382827499036
curr_Factors:  [91.88382827]
mat_Sqrt:  [[0.15]]
grads:  [0.15168729]
Stock Position:  0.15168728708647575
Bond Position:  [-8.70705756]


portfolio before change:  [5.19117169]
curr_Stock_Price:  91.62780693815836
curr_Factors:  [91.62780694]
mat_Sqrt:  [[0.15]]
grads:  [0.05097534]
Stock Position:  0.05097534374096029
Bond Position:  [0.52041274]


portfolio before change:  [5.23424244]
curr_Stock_Price:  92.47210189997166
curr_Factors:  [92.4721019]
mat_Sqrt:  [[0.15]]
grads:  [-0.24596313]
Stock Position:  -0.2459631308874238
Bond Position:  [27.97897015]


portfolio before change:  [5.13452247]
curr_Stock_Price:  92.88463817959116
curr_Factors:  [92.88463818]
mat_Sqrt:  [[0.15]]
grads:  [-0.178307]
Stock Position:  -0.17830700447835118
Bond Position:  [21.69650406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.30351548]
Stock Price:  91.94447915684884
PL:  [5.30351548]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.78713962e-03]
 [ 1.72945974e-02]
 [ 5.32934621e-03]
 [-1.57777212e-02]
 [ 1.30763442e-02]
 [-3.43025228e-03]
 [-7.31477409e-03]
 [-3.20588050e-02]
 [ 1.61810984e-02]
 [-5.83382097e-03]
 [-9.05729760e-03]
 [ 1.53498677e-02]
 [-4.19683861e-03]
 [ 6.00865337e-03]
 [-4.91026104e-04]
 [ 1.56426759e-02]
 [ 5.60662337e-02]
 [-1.47246830e-02]
 [ 1.91349904e-02]
 [ 1.28680536e-03]
 [-5.79075546e-03]
 [ 6.31816748e-03]
 [ 3.09879057e-03]
 [ 4.96612122e-02]
 [ 1.99895591e-03]
 [ 8.22533932e-03]
 [ 6.01727465e-03]
 [ 6.09406113e-03]
 [ 3.29649993e-02]
 [ 8.70415716e-04]
 [-7.93730009e-03]
 [ 9.69838322e-03]
 [ 1.16548095e-02]
 [-8.32263493e-03]
 [ 7.64601442e-03]
 [ 1.24151074e-02]
 [-2.78109195e-02]
 [ 1.39248985e-03]
 [-3.90412980e-02]
 [-1.33441925e-02]
 [ 4.19181943e-03]
 [ 8.74846596e-03]
 [-4.47559847e-03]
 [-3.80572387e-03]
 [ 8.77828936e-03]
 [ 1.21739012e-02]
 [ 1.05547742e-02]
 [-9.36853931e-04]
 [ 1.38081986e-02]
 [-1.17139693e-03]
 [ 1.76172169e-02]
 [-1.55602143e-02]
 [ 1.57772918e-03]
 [-7.14304283e-03]
 [-2.04828164e-03]
 [-3.43536513e-03]
 [ 1.03635795e-02]
 [-5.96765257e-03]
 [ 6.98582867e-03]
 [-4.02596721e-03]
 [-7.30699516e-04]
 [ 4.75581192e-03]
 [-6.85102411e-03]
 [ 7.27798757e-03]
 [ 2.04233143e-02]
 [ 5.42478377e-03]
 [ 8.20803195e-03]
 [-4.22353300e-04]
 [ 2.98235587e-03]
 [ 2.19911127e-02]
 [ 1.94011792e-03]
 [-1.59395264e-02]
 [-6.40276474e-03]
 [ 1.02793589e-03]
 [ 3.66939477e-03]
 [-4.24034401e-04]
 [-1.41931612e-03]
 [ 5.53510666e-03]
 [-2.49133945e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.4018623]
curr_Stock_Price:  100.15314709404488
curr_Factors:  [100.15314709]
mat_Sqrt:  [[0.15]]
grads:  [-0.0452476]
Stock Position:  -0.04524759746231156
Bond Position:  [9.93355159]


portfolio before change:  [5.39566876]
curr_Stock_Price:  100.3037496857462
curr_Factors:  [100.30374969]
mat_Sqrt:  [[0.15]]
grads:  [0.11529732]
Stock Position:  0.11529731622119406
Bond Position:  [-6.16908438]


portfolio before change:  [5.3799164]
curr_Stock_Price:  100.17047003315145
curr_Factors:  [100.17047003]
mat_Sqrt:  [[0.15]]
grads:  [0.03552897]
Stock Position:  0.03552897474750132
Bond Position:  [1.8209623]


portfolio before change:  [5.39727089]
curr_Stock_Price:  100.65572700644064
curr_Factors:  [100.65572701]
mat_Sqrt:  [[0.15]]
grads:  [-0.10518481]
Stock Position:  -0.1051848078220307
Bond Position:  [15.9847242]


portfolio before change:  [5.4533395]
curr_Stock_Price:  100.1321767934203
curr_Factors:  [100.13217679]
mat_Sqrt:  [[0.15]]
grads:  [0.08717563]
Stock Position:  0.08717562796465611
Bond Position:  [-3.27574589]


portfolio before change:  [5.47213527]
curr_Stock_Price:  100.3501334716647
curr_Factors:  [100.35013347]
mat_Sqrt:  [[0.15]]
grads:  [-0.02286835]
Stock Position:  -0.022868348519150084
Bond Position:  [7.7669771]


portfolio before change:  [5.46402924]
curr_Stock_Price:  100.7258266283173
curr_Factors:  [100.72582663]
mat_Sqrt:  [[0.15]]
grads:  [-0.04876516]
Stock Position:  -0.04876516057287162
Bond Position:  [10.37594035]


portfolio before change:  [5.43949672]
curr_Stock_Price:  101.24220010833864
curr_Factors:  [101.24220011]
mat_Sqrt:  [[0.15]]
grads:  [-0.21372537]
Stock Position:  -0.21372536686863827
Bond Position:  [27.07752308]


portfolio before change:  [5.36022551]
curr_Stock_Price:  101.62102087262477
curr_Factors:  [101.62102087]
mat_Sqrt:  [[0.15]]
grads:  [0.10787399]
Stock Position:  0.10787398922147723
Bond Position:  [-5.6020394]


portfolio before change:  [5.36864221]
curr_Stock_Price:  101.70229007694059
curr_Factors:  [101.70229008]
mat_Sqrt:  [[0.15]]
grads:  [-0.03889214]
Stock Position:  -0.03889213980407969
Bond Position:  [9.32406189]


portfolio before change:  [5.3776111]
curr_Stock_Price:  101.48666495273106
curr_Factors:  [101.48666495]
mat_Sqrt:  [[0.15]]
grads:  [-0.06038198]
Stock Position:  -0.06038198398646791
Bond Position:  [11.50557728]


portfolio before change:  [5.36645131]
curr_Stock_Price:  101.68339442594403
curr_Factors:  [101.68339443]
mat_Sqrt:  [[0.15]]
grads:  [0.10233245]
Stock Position:  0.10233245148614857
Bond Position:  [-5.03905972]


portfolio before change:  [5.41647546]
curr_Stock_Price:  102.17531172259083
curr_Factors:  [102.17531172]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797892]
Stock Position:  -0.027978924076798365
Bond Position:  [8.27523075]


portfolio before change:  [5.45150653]
curr_Stock_Price:  100.94174547934104
curr_Factors:  [100.94174548]
mat_Sqrt:  [[0.15]]
grads:  [0.04005769]
Stock Position:  0.04005768912677176
Bond Position:  [1.40801347]


portfolio before change:  [5.45772961]
curr_Stock_Price:  101.09490134492651
curr_Factors:  [101.09490134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327351]
Stock Position:  -0.0032735073630534017
Bond Position:  [5.78866451]


portfolio before change:  [5.45919683]
curr_Stock_Price:  100.75721332110452
curr_Factors:  [100.75721332]
mat_Sqrt:  [[0.15]]
grads:  [0.10428451]
Stock Position:  0.10428450602787856
Bond Position:  [-5.04821939]


portfolio before change:  [5.48765757]
curr_Stock_Price:  101.03315329702959
curr_Factors:  [101.0331533]
mat_Sqrt:  [[0.15]]
grads:  [0.37377489]
Stock Position:  0.37377489147250953
Bond Position:  [-32.27599834]


portfolio before change:  [5.3624156]
curr_Stock_Price:  100.70347717540993
curr_Factors:  [100.70347718]
mat_Sqrt:  [[0.15]]
grads:  [-0.09816455]
Stock Position:  -0.09816455317106396
Bond Position:  [15.24792744]


portfolio before change:  [5.26470425]
curr_Stock_Price:  101.70856884902491
curr_Factors:  [101.70856885]
mat_Sqrt:  [[0.15]]
grads:  [0.1275666]
Stock Position:  0.12756660278649323
Bond Position:  [-7.70991235]


portfolio before change:  [5.27118368]
curr_Stock_Price:  101.7631388975506
curr_Factors:  [101.7631389]
mat_Sqrt:  [[0.15]]
grads:  [0.0085787]
Stock Position:  0.00857870240018244
Bond Position:  [4.398188]


portfolio before change:  [5.27804685]
curr_Stock_Price:  102.53111898584498
curr_Factors:  [102.53111899]
mat_Sqrt:  [[0.15]]
grads:  [-0.03860504]
Stock Position:  -0.03860503638811401
Bond Position:  [9.23626443]


portfolio before change:  [5.24416671]
curr_Stock_Price:  103.42368198419764
curr_Factors:  [103.42368198]
mat_Sqrt:  [[0.15]]
grads:  [0.04212112]
Stock Position:  0.04212111652562387
Bond Position:  [0.88784575]


portfolio before change:  [5.23995491]
curr_Stock_Price:  103.32237194936266
curr_Factors:  [103.32237195]
mat_Sqrt:  [[0.15]]
grads:  [0.0206586]
Stock Position:  0.02065860379270383
Bond Position:  [3.10545897]


portfolio before change:  [5.25121596]
curr_Stock_Price:  103.8580785287793
curr_Factors:  [103.85807853]
mat_Sqrt:  [[0.15]]
grads:  [0.33107475]
Stock Position:  0.3310747479573088
Bond Position:  [-29.13357121]


portfolio before change:  [4.85796894]
curr_Stock_Price:  102.6757892750388
curr_Factors:  [102.67578928]
mat_Sqrt:  [[0.15]]
grads:  [0.01332637]
Stock Position:  0.013326372717312336
Bond Position:  [3.4896731]


portfolio before change:  [4.85116197]
curr_Stock_Price:  102.14863311860076
curr_Factors:  [102.14863312]
mat_Sqrt:  [[0.15]]
grads:  [0.0548356]
Stock Position:  0.05483559545303525
Bond Position:  [-0.75021915]


portfolio before change:  [4.85980121]
curr_Stock_Price:  102.30703621145412
curr_Factors:  [102.30703621]
mat_Sqrt:  [[0.15]]
grads:  [0.04011516]
Stock Position:  0.04011516433872378
Bond Position:  [0.75573764]


portfolio before change:  [4.79982158]
curr_Stock_Price:  100.81067282351151
curr_Factors:  [100.81067282]
mat_Sqrt:  [[0.15]]
grads:  [0.04062707]
Stock Position:  0.0406270742216621
Bond Position:  [0.70417889]


portfolio before change:  [4.80673879]
curr_Stock_Price:  100.97985066846225
curr_Factors:  [100.97985067]
mat_Sqrt:  [[0.15]]
grads:  [0.21976666]
Stock Position:  0.21976666204246853
Bond Position:  [-17.38526592]


portfolio before change:  [4.62727651]
curr_Stock_Price:  100.16819130718459
curr_Factors:  [100.16819131]
mat_Sqrt:  [[0.15]]
grads:  [0.00580277]
Stock Position:  0.0058027714396046105
Bond Position:  [4.04602339]


portfolio before change:  [4.62676585]
curr_Stock_Price:  100.03660797686729
curr_Factors:  [100.03660798]
mat_Sqrt:  [[0.15]]
grads:  [-0.05291533]
Stock Position:  -0.05291533394414585
Bond Position:  [9.92023636]


portfolio before change:  [4.64356394]
curr_Stock_Price:  99.73087315575188
curr_Factors:  [99.73087316]
mat_Sqrt:  [[0.15]]
grads:  [0.06465589]
Stock Position:  0.06465588814086534
Bond Position:  [-1.80462424]


portfolio before change:  [4.61765889]
curr_Stock_Price:  99.3319572815695
curr_Factors:  [99.33195728]
mat_Sqrt:  [[0.15]]
grads:  [0.07769873]
Stock Position:  0.07769873001949862
Bond Position:  [-3.10030804]


portfolio before change:  [4.62991115]
curr_Stock_Price:  99.49214051508582
curr_Factors:  [99.49214052]
mat_Sqrt:  [[0.15]]
grads:  [-0.05548423]
Stock Position:  -0.055484232864170945
Bond Position:  [10.15015624]


portfolio before change:  [4.60866318]
curr_Stock_Price:  99.88652945266853
curr_Factors:  [99.88652945]
mat_Sqrt:  [[0.15]]
grads:  [0.05097343]
Stock Position:  0.05097342944099546
Bond Position:  [-0.48289578]


portfolio before change:  [4.63094634]
curr_Stock_Price:  100.32427395964744
curr_Factors:  [100.32427396]
mat_Sqrt:  [[0.15]]
grads:  [0.08276738]
Stock Position:  0.08276738238132886
Bond Position:  [-3.67263121]


portfolio before change:  [4.70262727]
curr_Stock_Price:  101.19310019649033
curr_Factors:  [101.1931002]
mat_Sqrt:  [[0.15]]
grads:  [-0.18540613]
Stock Position:  -0.1854061297320397
Bond Position:  [23.46444833]


portfolio before change:  [4.63524072]
curr_Stock_Price:  101.56446396607122
curr_Factors:  [101.56446397]
mat_Sqrt:  [[0.15]]
grads:  [0.00928327]
Stock Position:  0.009283265646484278
Bond Position:  [3.69239082]


portfolio before change:  [4.63784562]
curr_Stock_Price:  101.82020510342551
curr_Factors:  [101.8202051]
mat_Sqrt:  [[0.15]]
grads:  [-0.26027532]
Stock Position:  -0.2602753199559644
Bond Position:  [31.13913208]


portfolio before change:  [4.50227248]
curr_Stock_Price:  102.3485663520878
curr_Factors:  [102.34856635]
mat_Sqrt:  [[0.15]]
grads:  [-0.08896128]
Stock Position:  -0.08896128334169863
Bond Position:  [13.60733229]


portfolio before change:  [4.54199067]
curr_Stock_Price:  101.91166049654022
curr_Factors:  [101.9116605]
mat_Sqrt:  [[0.15]]
grads:  [0.02794546]
Stock Position:  0.027945462844127834
Bond Position:  [1.69402215]


portfolio before change:  [4.53001455]
curr_Stock_Price:  101.47931846590775
curr_Factors:  [101.47931847]
mat_Sqrt:  [[0.15]]
grads:  [0.05832311]
Stock Position:  0.05832310640046606
Bond Position:  [-1.38857454]


portfolio before change:  [4.53729989]
curr_Stock_Price:  101.60571989863169
curr_Factors:  [101.6057199]
mat_Sqrt:  [[0.15]]
grads:  [-0.02983732]
Stock Position:  -0.029837323104892774
Bond Position:  [7.56894258]


portfolio before change:  [4.53062863]
curr_Stock_Price:  101.84516261456075
curr_Factors:  [101.84516261]
mat_Sqrt:  [[0.15]]
grads:  [-0.02537149]
Stock Position:  -0.025371492445795535
Bond Position:  [7.1145924]


portfolio before change:  [4.51089752]
curr_Stock_Price:  102.64037752511187
curr_Factors:  [102.64037753]
mat_Sqrt:  [[0.15]]
grads:  [0.05852193]
Stock Position:  0.058521929066817614
Bond Position:  [-1.49581538]


portfolio before change:  [4.50546917]
curr_Stock_Price:  102.54921763830961
curr_Factors:  [102.54921764]
mat_Sqrt:  [[0.15]]
grads:  [0.08115934]
Stock Position:  0.08115934140964025
Bond Position:  [-3.81735779]


portfolio before change:  [4.51602856]
curr_Stock_Price:  102.68226435195217
curr_Factors:  [102.68226435]
mat_Sqrt:  [[0.15]]
grads:  [0.07036516]
Stock Position:  0.07036516133556053
Bond Position:  [-2.70922553]


portfolio before change:  [4.51683285]
curr_Stock_Price:  102.69610096808128
curr_Factors:  [102.69610097]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624569]
Stock Position:  -0.006245692875734049
Bond Position:  [5.15824115]


portfolio before change:  [4.51816178]
curr_Stock_Price:  102.53494552809906
curr_Factors:  [102.53494553]
mat_Sqrt:  [[0.15]]
grads:  [0.09205466]
Stock Position:  0.09205465749362034
Bond Position:  [-4.92065752]


portfolio before change:  [4.53012957]
curr_Stock_Price:  102.6682939586814
curr_Factors:  [102.66829396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00780931]
Stock Position:  -0.007809312834321638
Bond Position:  [5.3318984]


portfolio before change:  [4.53573118]
curr_Stock_Price:  101.99366892939626
curr_Factors:  [101.99366893]
mat_Sqrt:  [[0.15]]
grads:  [0.11744811]
Stock Position:  0.11744811284557842
Bond Position:  [-7.44323276]


portfolio before change:  [4.50509028]
curr_Stock_Price:  101.73674112796063
curr_Factors:  [101.73674113]
mat_Sqrt:  [[0.15]]
grads:  [-0.10373476]
Stock Position:  -0.10373476200507256
Bond Position:  [15.05872691]


portfolio before change:  [4.52890319]
curr_Stock_Price:  101.51625855429712
curr_Factors:  [101.51625855]
mat_Sqrt:  [[0.15]]
grads:  [0.01051819]
Stock Position:  0.010518194502106278
Bond Position:  [3.46113543]


portfolio before change:  [4.53557296]
curr_Stock_Price:  102.12980958016905
curr_Factors:  [102.12980958]
mat_Sqrt:  [[0.15]]
grads:  [-0.04762029]
Stock Position:  -0.04762028556615422
Bond Position:  [9.39902366]


portfolio before change:  [4.52207132]
curr_Stock_Price:  102.42567304130225
curr_Factors:  [102.42567304]
mat_Sqrt:  [[0.15]]
grads:  [-0.01365521]
Stock Position:  -0.013655210960487623
Bond Position:  [5.92071549]


portfolio before change:  [4.53391775]
curr_Stock_Price:  101.58523363355043
curr_Factors:  [101.58523363]
mat_Sqrt:  [[0.15]]
grads:  [-0.02290243]
Stock Position:  -0.02290243417091539
Bond Position:  [6.86046688]


portfolio before change:  [4.53341073]
curr_Stock_Price:  101.62609460897283
curr_Factors:  [101.62609461]
mat_Sqrt:  [[0.15]]
grads:  [0.06909053]
Stock Position:  0.06909053003260142
Bond Position:  [-2.48799001]


portfolio before change:  [4.5476992]
curr_Stock_Price:  101.83515331912484
curr_Factors:  [101.83515332]
mat_Sqrt:  [[0.15]]
grads:  [-0.03978435]
Stock Position:  -0.03978435044505686
Bond Position:  [8.59914463]


portfolio before change:  [4.60082997]
curr_Stock_Price:  100.51319379119288
curr_Factors:  [100.51319379]
mat_Sqrt:  [[0.15]]
grads:  [0.04657219]
Stock Position:  0.046572191134427725
Bond Position:  [-0.08028971]


portfolio before change:  [4.59804801]
curr_Stock_Price:  100.45356732867201
curr_Factors:  [100.45356733]
mat_Sqrt:  [[0.15]]
grads:  [-0.02683978]
Stock Position:  -0.026839781391741615
Bond Position:  [7.2941998]


portfolio before change:  [4.59764108]
curr_Stock_Price:  100.48571494574485
curr_Factors:  [100.48571495]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487133]
Stock Position:  -0.004871330107950768
Bond Position:  [5.08714017]


portfolio before change:  [4.60053234]
curr_Stock_Price:  99.95746028030129
curr_Factors:  [99.95746028]
mat_Sqrt:  [[0.15]]
grads:  [0.03170541]
Stock Position:  0.03170541276947662
Bond Position:  [1.4313398]


portfolio before change:  [4.58732415]
curr_Stock_Price:  99.53804772420642
curr_Factors:  [99.53804772]
mat_Sqrt:  [[0.15]]
grads:  [-0.04567349]
Stock Position:  -0.04567349406624013
Bond Position:  [9.13357458]


portfolio before change:  [4.57037762]
curr_Stock_Price:  99.9215831167064
curr_Factors:  [99.92158312]
mat_Sqrt:  [[0.15]]
grads:  [0.04851992]
Stock Position:  0.048519917108955146
Bond Position:  [-0.27780931]


portfolio before change:  [4.55339987]
curr_Stock_Price:  99.5720280677972
curr_Factors:  [99.57202807]
mat_Sqrt:  [[0.15]]
grads:  [0.13615543]
Stock Position:  0.1361554289052715
Bond Position:  [-9.00387232]


portfolio before change:  [4.55016588]
curr_Stock_Price:  99.55240906908816
curr_Factors:  [99.55240907]
mat_Sqrt:  [[0.15]]
grads:  [0.03616523]
Stock Position:  0.03616522512900153
Bond Position:  [0.94983059]


portfolio before change:  [4.54252091]
curr_Stock_Price:  99.33937740820383
curr_Factors:  [99.33937741]
mat_Sqrt:  [[0.15]]
grads:  [0.05472021]
Stock Position:  0.05472021302088021
Bond Position:  [-0.89335099]


portfolio before change:  [4.50176505]
curr_Stock_Price:  98.59559337279526
curr_Factors:  [98.59559337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00281569]
Stock Position:  -0.002815688663429291
Bond Position:  [4.77937954]


portfolio before change:  [4.50417851]
curr_Stock_Price:  97.84453774766452
curr_Factors:  [97.84453775]
mat_Sqrt:  [[0.15]]
grads:  [0.01988237]
Stock Position:  0.019882372492692008
Bond Position:  [2.55879696]


portfolio before change:  [4.5265769]
curr_Stock_Price:  98.96303909322964
curr_Factors:  [98.96303909]
mat_Sqrt:  [[0.15]]
grads:  [0.14660742]
Stock Position:  0.14660741780746633
Bond Position:  [-9.98213872]


portfolio before change:  [4.56784262]
curr_Stock_Price:  99.24876556107156
curr_Factors:  [99.24876556]
mat_Sqrt:  [[0.15]]
grads:  [0.01293412]
Stock Position:  0.012934119461756955
Bond Position:  [3.28414723]


portfolio before change:  [4.56704906]
curr_Stock_Price:  99.17154215489641
curr_Factors:  [99.17154215]
mat_Sqrt:  [[0.15]]
grads:  [-0.10626351]
Stock Position:  -0.10626350907068242
Bond Position:  [15.10536513]


portfolio before change:  [4.60782212]
curr_Stock_Price:  98.79672915770263
curr_Factors:  [98.79672916]
mat_Sqrt:  [[0.15]]
grads:  [-0.0426851]
Stock Position:  -0.042685098245160424
Bond Position:  [8.82497021]


portfolio before change:  [4.60374641]
curr_Stock_Price:  98.90513446410615
curr_Factors:  [98.90513446]
mat_Sqrt:  [[0.15]]
grads:  [0.00685291]
Stock Position:  0.006852905947170515
Bond Position:  [3.92595883]


portfolio before change:  [4.60459865]
curr_Stock_Price:  98.99368943924583
curr_Factors:  [98.99368944]
mat_Sqrt:  [[0.15]]
grads:  [0.02446263]
Stock Position:  0.02446263180859891
Bond Position:  [2.18295247]


portfolio before change:  [4.59739616]
curr_Stock_Price:  98.69368375189887
curr_Factors:  [98.69368375]
mat_Sqrt:  [[0.15]]
grads:  [-0.0028269]
Stock Position:  -0.00282689600625131
Bond Position:  [4.87639294]


portfolio before change:  [4.59714788]
curr_Stock_Price:  98.88932853326058
curr_Factors:  [98.88932853]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946211]
Stock Position:  -0.009462107438165767
Bond Position:  [5.53284933]


portfolio before change:  [4.5929468]
curr_Stock_Price:  99.36986502407896
curr_Factors:  [99.36986502]
mat_Sqrt:  [[0.15]]
grads:  [0.03690071]
Stock Position:  0.03690071105872428
Bond Position:  [0.92612812]


portfolio before change:  [4.59067378]
curr_Stock_Price:  99.30669811193961
curr_Factors:  [99.30669811]
mat_Sqrt:  [[0.15]]
grads:  [-0.1660893]
Stock Position:  -0.16608929640965356
Bond Position:  [21.0844534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.54446624]
Stock Price:  99.59284153330232
PL:  [4.54446624]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.27803256e-02]
 [-1.19886334e-03]
 [ 2.62272298e-03]
 [-7.91358174e-03]
 [ 5.54563368e-03]
 [-1.55891671e-03]
 [-5.64284047e-03]
 [-1.51920269e-02]
 [-7.96896855e-03]
 [-6.90708740e-03]
 [ 1.48900699e-02]
 [-4.09075235e-03]
 [-1.47314355e-03]
 [ 9.42101184e-03]
 [-1.97995049e-03]
 [ 1.60918882e-02]
 [ 5.85513967e-02]
 [-1.47159584e-02]
 [ 1.98672329e-02]
 [ 2.39098750e-03]
 [-3.75045245e-03]
 [ 4.65783083e-03]
 [ 7.51432466e-03]
 [ 3.41153401e-02]
 [-2.21593801e-04]
 [ 7.02559782e-03]
 [ 9.16203581e-04]
 [ 8.91287567e-03]
 [ 3.20835076e-02]
 [-7.77388269e-04]
 [-4.38227815e-03]
 [ 1.34693335e-02]
 [ 1.29751986e-02]
 [ 7.47372933e-03]
 [ 6.37606356e-03]
 [ 9.82950199e-03]
 [-1.72545039e-02]
 [-8.65975759e-03]
 [-1.84954709e-02]
 [-2.00671942e-02]
 [ 3.63665489e-03]
 [ 6.17875690e-03]
 [-1.37296011e-02]
 [ 4.55710788e-03]
 [ 4.81249330e-03]
 [ 1.18150275e-02]
 [ 1.05744630e-02]
 [-2.07483979e-03]
 [ 1.21716641e-02]
 [-1.22725171e-03]
 [ 2.14319467e-02]
 [-1.27314809e-03]
 [-2.32909459e-03]
 [-1.39345326e-02]
 [-1.94299101e-03]
 [-3.33584069e-03]
 [ 1.07075837e-02]
 [-1.11682217e-02]
 [ 5.47337623e-03]
 [-3.89077364e-03]
 [-2.84862514e-03]
 [ 5.57906560e-03]
 [-1.96654592e-02]
 [ 9.48235840e-04]
 [ 1.70265719e-02]
 [ 1.63073934e-02]
 [ 5.62552544e-03]
 [ 1.32858379e-02]
 [ 7.01589294e-03]
 [ 1.09728481e-02]
 [ 2.38662413e-03]
 [-1.50581365e-02]
 [-1.28533086e-02]
 [ 8.54424583e-04]
 [ 5.44615103e-05]
 [-1.91035634e-02]
 [-3.42676133e-03]
 [ 1.17069891e-02]
 [-4.91840570e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.69422145]
curr_Stock_Price:  99.37667800491552
curr_Factors:  [99.376678]
mat_Sqrt:  [[0.15]]
grads:  [-0.08520217]
Stock Position:  -0.08520217098943561
Bond Position:  [-3.22711273]


portfolio before change:  [-11.70997418]
curr_Stock_Price:  99.55919718615691
curr_Factors:  [99.55919719]
mat_Sqrt:  [[0.15]]
grads:  [-0.00799242]
Stock Position:  -0.007992422240891833
Bond Position:  [-10.91425504]


portfolio before change:  [-11.71398991]
curr_Stock_Price:  99.97628834692149
curr_Factors:  [99.97628835]
mat_Sqrt:  [[0.15]]
grads:  [0.01748482]
Stock Position:  0.017484819833737144
Bond Position:  [-13.4620573]


portfolio before change:  [-11.70915108]
curr_Stock_Price:  100.30115512429221
curr_Factors:  [100.30115512]
mat_Sqrt:  [[0.15]]
grads:  [-0.05275721]
Stock Position:  -0.05275721162766259
Bond Position:  [-6.41754181]


portfolio before change:  [-11.71540608]
curr_Stock_Price:  100.41211420293965
curr_Factors:  [100.4121142]
mat_Sqrt:  [[0.15]]
grads:  [0.03697089]
Stock Position:  0.03697089122685632
Bond Position:  [-15.42773143]


portfolio before change:  [-11.70319745]
curr_Stock_Price:  100.76841843205241
curr_Factors:  [100.76841843]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039278]
Stock Position:  -0.010392778060714763
Bond Position:  [-10.65593365]


portfolio before change:  [-11.70247192]
curr_Stock_Price:  100.63452288886597
curr_Factors:  [100.63452289]
mat_Sqrt:  [[0.15]]
grads:  [-0.03761894]
Stock Position:  -0.037618936498295445
Bond Position:  [-7.9167082]


portfolio before change:  [-11.69585385]
curr_Stock_Price:  100.44544552968274
curr_Factors:  [100.44544553]
mat_Sqrt:  [[0.15]]
grads:  [-0.10128018]
Stock Position:  -0.10128017950266811
Bond Position:  [-1.52272109]


portfolio before change:  [-11.63798741]
curr_Stock_Price:  99.87315579636144
curr_Factors:  [99.8731558]
mat_Sqrt:  [[0.15]]
grads:  [-0.05312646]
Stock Position:  -0.053126456992104804
Bond Position:  [-6.3320805]


portfolio before change:  [-11.62180965]
curr_Stock_Price:  99.56119209253914
curr_Factors:  [99.56119209]
mat_Sqrt:  [[0.15]]
grads:  [-0.04604725]
Stock Position:  -0.04604724934082212
Bond Position:  [-7.03729062]


portfolio before change:  [-11.6356122]
curr_Stock_Price:  99.85138754731491
curr_Factors:  [99.85138755]
mat_Sqrt:  [[0.15]]
grads:  [0.09926713]
Stock Position:  0.0992671324985961
Bond Position:  [-21.54757312]


portfolio before change:  [-11.64301468]
curr_Stock_Price:  99.79038334282184
curr_Factors:  [99.79038334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02727168]
Stock Position:  -0.02727168232968022
Bond Position:  [-8.92156304]


portfolio before change:  [-11.64477184]
curr_Stock_Price:  99.83436827933743
curr_Factors:  [99.83436828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982096]
Stock Position:  -0.009820956992156772
Bond Position:  [-10.6643028]


portfolio before change:  [-11.64845783]
curr_Stock_Price:  100.1418186798862
curr_Factors:  [100.14181868]
mat_Sqrt:  [[0.15]]
grads:  [0.06280675]
Stock Position:  0.06280674557319947
Bond Position:  [-17.93803956]


portfolio before change:  [-11.6153551]
curr_Stock_Price:  100.68672661092569
curr_Factors:  [100.68672661]
mat_Sqrt:  [[0.15]]
grads:  [-0.01319967]
Stock Position:  -0.013199669956538453
Bond Position:  [-10.28632354]


portfolio before change:  [-11.62016452]
curr_Stock_Price:  101.00237854034626
curr_Factors:  [101.00237854]
mat_Sqrt:  [[0.15]]
grads:  [0.10727925]
Stock Position:  0.10727925453926387
Bond Position:  [-22.45562439]


portfolio before change:  [-11.60775062]
curr_Stock_Price:  101.13117712878007
curr_Factors:  [101.13117713]
mat_Sqrt:  [[0.15]]
grads:  [0.39034264]
Stock Position:  0.39034264478485015
Bond Position:  [-51.08356177]


portfolio before change:  [-11.9558468]
curr_Stock_Price:  100.24758585372182
curr_Factors:  [100.24758585]
mat_Sqrt:  [[0.15]]
grads:  [-0.09810639]
Stock Position:  -0.09810638948986583
Bond Position:  [-2.1209181]


portfolio before change:  [-11.9380282]
curr_Stock_Price:  100.0646094013539
curr_Factors:  [100.0646094]
mat_Sqrt:  [[0.15]]
grads:  [0.13244822]
Stock Position:  0.13244821963075087
Bond Position:  [-25.19140756]


portfolio before change:  [-11.89350937]
curr_Stock_Price:  100.41261971165991
curr_Factors:  [100.41261971]
mat_Sqrt:  [[0.15]]
grads:  [0.01593992]
Stock Position:  0.01593991666501926
Bond Position:  [-13.49407816]


portfolio before change:  [-11.88281224]
curr_Stock_Price:  101.13662207065946
curr_Factors:  [101.13662207]
mat_Sqrt:  [[0.15]]
grads:  [-0.02500302]
Stock Position:  -0.025003016331421175
Bond Position:  [-9.35409162]


portfolio before change:  [-11.89515745]
curr_Stock_Price:  101.60698807821618
curr_Factors:  [101.60698808]
mat_Sqrt:  [[0.15]]
grads:  [0.03105221]
Stock Position:  0.03105220552443764
Bond Position:  [-15.05027853]


portfolio before change:  [-11.86822361]
curr_Stock_Price:  102.50465434103546
curr_Factors:  [102.50465434]
mat_Sqrt:  [[0.15]]
grads:  [0.0500955]
Stock Position:  0.05009549770375185
Bond Position:  [-17.00324529]


portfolio before change:  [-11.87096726]
curr_Stock_Price:  102.47110017634459
curr_Factors:  [102.47110018]
mat_Sqrt:  [[0.15]]
grads:  [0.2274356]
Stock Position:  0.22743560043350644
Bond Position:  [-35.17654345]


portfolio before change:  [-11.9760855]
curr_Stock_Price:  102.01857805525306
curr_Factors:  [102.01857806]
mat_Sqrt:  [[0.15]]
grads:  [-0.00147729]
Stock Position:  -0.001477292007943098
Bond Position:  [-11.82537427]


portfolio before change:  [-11.97564155]
curr_Stock_Price:  101.21774780978866
curr_Factors:  [101.21774781]
mat_Sqrt:  [[0.15]]
grads:  [0.04683732]
Stock Position:  0.046837318789757595
Bond Position:  [-16.71640947]


portfolio before change:  [-11.94330674]
curr_Stock_Price:  101.93041917577669
curr_Factors:  [101.93041918]
mat_Sqrt:  [[0.15]]
grads:  [0.00610802]
Stock Position:  0.006108023871555374
Bond Position:  [-12.56590018]


portfolio before change:  [-11.9483915]
curr_Stock_Price:  101.2265311535334
curr_Factors:  [101.22653115]
mat_Sqrt:  [[0.15]]
grads:  [0.05941917]
Stock Position:  0.05941917112887208
Bond Position:  [-17.96318808]


portfolio before change:  [-11.97275911]
curr_Stock_Price:  100.83532953029435
curr_Factors:  [100.83532953]
mat_Sqrt:  [[0.15]]
grads:  [0.21389005]
Stock Position:  0.2138900505056543
Bond Position:  [-33.54043284]


portfolio before change:  [-11.82388999]
curr_Stock_Price:  101.5411382718421
curr_Factors:  [101.54113827]
mat_Sqrt:  [[0.15]]
grads:  [-0.00518259]
Stock Position:  -0.0051825884596921196
Bond Position:  [-11.29764405]


portfolio before change:  [-11.82455386]
curr_Stock_Price:  101.53298623399814
curr_Factors:  [101.53298623]
mat_Sqrt:  [[0.15]]
grads:  [-0.02921519]
Stock Position:  -0.029215187698320464
Bond Position:  [-8.85824861]


portfolio before change:  [-11.8336369]
curr_Stock_Price:  101.82493658813564
curr_Factors:  [101.82493659]
mat_Sqrt:  [[0.15]]
grads:  [0.08979556]
Stock Position:  0.0897955564968185
Bond Position:  [-20.97706375]


portfolio before change:  [-11.83952757]
curr_Stock_Price:  101.77393670244619
curr_Factors:  [101.7739367]
mat_Sqrt:  [[0.15]]
grads:  [0.08650132]
Stock Position:  0.08650132399072219
Bond Position:  [-20.64310785]


portfolio before change:  [-11.85508349]
curr_Stock_Price:  101.60901801402264
curr_Factors:  [101.60901801]
mat_Sqrt:  [[0.15]]
grads:  [0.04982486]
Stock Position:  0.04982486219126274
Bond Position:  [-16.91773881]


portfolio before change:  [-11.82980708]
curr_Stock_Price:  102.13754546688969
curr_Factors:  [102.13754547]
mat_Sqrt:  [[0.15]]
grads:  [0.04250709]
Stock Position:  0.04250709037880229
Bond Position:  [-16.17137695]


portfolio before change:  [-11.81263718]
curr_Stock_Price:  102.56525394339722
curr_Factors:  [102.56525394]
mat_Sqrt:  [[0.15]]
grads:  [0.06553001]
Stock Position:  0.0655300132982731
Bond Position:  [-18.53373963]


portfolio before change:  [-11.78065224]
curr_Stock_Price:  103.07102727397731
curr_Factors:  [103.07102727]
mat_Sqrt:  [[0.15]]
grads:  [-0.11503003]
Stock Position:  -0.11503002623380039
Bond Position:  [0.07561073]


portfolio before change:  [-11.8485649]
curr_Stock_Price:  103.66145911318694
curr_Factors:  [103.66145911]
mat_Sqrt:  [[0.15]]
grads:  [-0.05773172]
Stock Position:  -0.05773171728477702
Bond Position:  [-5.86401085]


portfolio before change:  [-11.82839974]
curr_Stock_Price:  103.30581960738134
curr_Factors:  [103.30581961]
mat_Sqrt:  [[0.15]]
grads:  [-0.12330314]
Stock Position:  -0.12330313919710872
Bond Position:  [0.90953212]


portfolio before change:  [-11.86153132]
curr_Stock_Price:  103.57498089089559
curr_Factors:  [103.57498089]
mat_Sqrt:  [[0.15]]
grads:  [-0.13378129]
Stock Position:  -0.13378129437852124
Bond Position:  [1.99486369]


portfolio before change:  [-11.86850506]
curr_Stock_Price:  103.62804080126722
curr_Factors:  [103.6280408]
mat_Sqrt:  [[0.15]]
grads:  [0.02424437]
Stock Position:  0.02424436590893395
Bond Position:  [-14.3809012]


portfolio before change:  [-11.85456056]
curr_Stock_Price:  104.24027951356011
curr_Factors:  [104.24027951]
mat_Sqrt:  [[0.15]]
grads:  [0.04119171]
Stock Position:  0.04119171264130166
Bond Position:  [-16.1483962]


portfolio before change:  [-11.83225654]
curr_Stock_Price:  104.80625066239898
curr_Factors:  [104.80625066]
mat_Sqrt:  [[0.15]]
grads:  [-0.09153067]
Stock Position:  -0.0915306742699889
Bond Position:  [-2.23926975]


portfolio before change:  [-11.72176922]
curr_Stock_Price:  103.597614505948
curr_Factors:  [103.59761451]
mat_Sqrt:  [[0.15]]
grads:  [0.03038072]
Stock Position:  0.030380719171976673
Bond Position:  [-14.86913925]


portfolio before change:  [-11.72628746]
curr_Stock_Price:  103.47948392291329
curr_Factors:  [103.47948392]
mat_Sqrt:  [[0.15]]
grads:  [0.03208329]
Stock Position:  0.032083288635718805
Bond Position:  [-15.04624961]


portfolio before change:  [-11.72116529]
curr_Stock_Price:  103.66844803948024
curr_Factors:  [103.66844804]
mat_Sqrt:  [[0.15]]
grads:  [0.07876685]
Stock Position:  0.07876684990492076
Bond Position:  [-19.88680238]


portfolio before change:  [-11.73384642]
curr_Stock_Price:  103.5232325915318
curr_Factors:  [103.52323259]
mat_Sqrt:  [[0.15]]
grads:  [0.07049642]
Stock Position:  0.0704964200996191
Bond Position:  [-19.03186371]


portfolio before change:  [-11.73662948]
curr_Stock_Price:  103.50062810657552
curr_Factors:  [103.50062811]
mat_Sqrt:  [[0.15]]
grads:  [-0.01383227]
Stock Position:  -0.013832265288811874
Bond Position:  [-10.30498134]


portfolio before change:  [-11.73709389]
curr_Stock_Price:  103.4876384528476
curr_Factors:  [103.48763845]
mat_Sqrt:  [[0.15]]
grads:  [0.08114443]
Stock Position:  0.0811444270534374
Bond Position:  [-20.13453902]


portfolio before change:  [-11.75727526]
curr_Stock_Price:  103.25443791539846
curr_Factors:  [103.25443792]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818168]
Stock Position:  -0.008181678072295882
Bond Position:  [-10.91248069]


portfolio before change:  [-11.76127962]
curr_Stock_Price:  103.66050546076009
curr_Factors:  [103.66050546]
mat_Sqrt:  [[0.15]]
grads:  [0.14287964]
Stock Position:  0.14287964492094682
Bond Position:  [-26.57225584]


portfolio before change:  [-11.82759749]
curr_Stock_Price:  103.20797738554786
curr_Factors:  [103.20797739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00848765]
Stock Position:  -0.00848765392232274
Bond Position:  [-10.9516039]


portfolio before change:  [-11.83313081]
curr_Stock_Price:  103.77925657454904
curr_Factors:  [103.77925657]
mat_Sqrt:  [[0.15]]
grads:  [-0.0155273]
Stock Position:  -0.015527297251894515
Bond Position:  [-10.22171944]


portfolio before change:  [-11.82022087]
curr_Stock_Price:  102.90667634368448
curr_Factors:  [102.90667634]
mat_Sqrt:  [[0.15]]
grads:  [-0.09289688]
Stock Position:  -0.09289688404246685
Bond Position:  [-2.26051129]


portfolio before change:  [-11.81435373]
curr_Stock_Price:  102.84199781702684
curr_Factors:  [102.84199782]
mat_Sqrt:  [[0.15]]
grads:  [-0.01295327]
Stock Position:  -0.012953273414508911
Bond Position:  [-10.48221321]


portfolio before change:  [-11.80311615]
curr_Stock_Price:  101.92387198247351
curr_Factors:  [101.92387198]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223894]
Stock Position:  -0.022238937927529387
Bond Position:  [-9.53643749]


portfolio before change:  [-11.81941418]
curr_Stock_Price:  102.62993001040826
curr_Factors:  [102.62993001]
mat_Sqrt:  [[0.15]]
grads:  [0.07138389]
Stock Position:  0.0713838915260477
Bond Position:  [-19.14553797]


portfolio before change:  [-11.79834422]
curr_Stock_Price:  102.9418573604395
curr_Factors:  [102.94185736]
mat_Sqrt:  [[0.15]]
grads:  [-0.07445481]
Stock Position:  -0.07445481165559191
Bond Position:  [-4.13382762]


portfolio before change:  [-11.78382218]
curr_Stock_Price:  102.74334205935372
curr_Factors:  [102.74334206]
mat_Sqrt:  [[0.15]]
grads:  [0.03648917]
Stock Position:  0.036489174853292
Bond Position:  [-15.53284195]


portfolio before change:  [-11.79258775]
curr_Stock_Price:  102.52972417182349
curr_Factors:  [102.52972417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02593849]
Stock Position:  -0.025938490958384033
Bond Position:  [-9.13312143]


portfolio before change:  [-11.79761563]
curr_Stock_Price:  102.70155558713604
curr_Factors:  [102.70155559]
mat_Sqrt:  [[0.15]]
grads:  [-0.01899083]
Stock Position:  -0.01899083429659991
Bond Position:  [-9.84722741]


portfolio before change:  [-11.81911264]
curr_Stock_Price:  103.8011140850408
curr_Factors:  [103.80111409]
mat_Sqrt:  [[0.15]]
grads:  [0.03719377]
Stock Position:  0.03719377068378306
Bond Position:  [-15.67986747]


portfolio before change:  [-11.82660689]
curr_Stock_Price:  103.62597099783146
curr_Factors:  [103.625971]
mat_Sqrt:  [[0.15]]
grads:  [-0.13110306]
Stock Position:  -0.13110306161902444
Bond Position:  [1.75907517]


portfolio before change:  [-11.86114377]
curr_Stock_Price:  103.89024267967842
curr_Factors:  [103.89024268]
mat_Sqrt:  [[0.15]]
grads:  [0.00632157]
Stock Position:  0.006321572268547297
Bond Position:  [-12.51789345]


portfolio before change:  [-11.86128396]
curr_Stock_Price:  103.99183227854189
curr_Factors:  [103.99183228]
mat_Sqrt:  [[0.15]]
grads:  [0.11351048]
Stock Position:  0.1135104791302051
Bond Position:  [-23.66544667]


portfolio before change:  [-11.75865909]
curr_Stock_Price:  104.9089635220516
curr_Factors:  [104.90896352]
mat_Sqrt:  [[0.15]]
grads:  [0.10871596]
Stock Position:  0.10871595573676895
Bond Position:  [-23.16393733]


portfolio before change:  [-11.8056592]
curr_Stock_Price:  104.48996043124957
curr_Factors:  [104.48996043]
mat_Sqrt:  [[0.15]]
grads:  [0.0375035]
Stock Position:  0.03750350291667156
Bond Position:  [-15.72439874]


portfolio before change:  [-11.78108286]
curr_Stock_Price:  105.17147395751353
curr_Factors:  [105.17147396]
mat_Sqrt:  [[0.15]]
grads:  [0.08857225]
Stock Position:  0.08857225262901262
Bond Position:  [-21.09635723]


portfolio before change:  [-11.83781927]
curr_Stock_Price:  104.54579445898055
curr_Factors:  [104.54579446]
mat_Sqrt:  [[0.15]]
grads:  [0.04677262]
Stock Position:  0.04677261959174372
Bond Position:  [-16.72769994]


portfolio before change:  [-11.83672723]
curr_Stock_Price:  104.59149538010595
curr_Factors:  [104.59149538]
mat_Sqrt:  [[0.15]]
grads:  [0.07315232]
Stock Position:  0.07315232074806398
Bond Position:  [-19.48783785]


portfolio before change:  [-11.82727374]
curr_Stock_Price:  104.7373761465933
curr_Factors:  [104.73737615]
mat_Sqrt:  [[0.15]]
grads:  [0.01591083]
Stock Position:  0.0159108275465601
Bond Position:  [-13.49373207]


portfolio before change:  [-11.81861619]
curr_Stock_Price:  105.33451254522558
curr_Factors:  [105.33451255]
mat_Sqrt:  [[0.15]]
grads:  [-0.10038758]
Stock Position:  -0.10038757667813261
Bond Position:  [-1.24433974]


portfolio before change:  [-11.73504413]
curr_Stock_Price:  104.50124369495789
curr_Factors:  [104.50124369]
mat_Sqrt:  [[0.15]]
grads:  [-0.08568872]
Stock Position:  -0.08568872411327538
Bond Position:  [-2.78046589]


portfolio before change:  [-11.77029161]
curr_Stock_Price:  104.91055884741807
curr_Factors:  [104.91055885]
mat_Sqrt:  [[0.15]]
grads:  [0.00569616]
Stock Position:  0.005696163887924523
Bond Position:  [-12.36787934]


portfolio before change:  [-11.77100575]
curr_Stock_Price:  104.92089356985134
curr_Factors:  [104.92089357]
mat_Sqrt:  [[0.15]]
grads:  [0.00036308]
Stock Position:  0.0003630767354854611
Bond Position:  [-11.80910009]


portfolio before change:  [-11.772018]
curr_Stock_Price:  104.16579564835091
curr_Factors:  [104.16579565]
mat_Sqrt:  [[0.15]]
grads:  [-0.12735709]
Stock Position:  -0.12735708929444683
Bond Position:  [1.49423453]


portfolio before change:  [-11.69249473]
curr_Stock_Price:  103.54211715652245
curr_Factors:  [103.54211716]
mat_Sqrt:  [[0.15]]
grads:  [-0.02284508]
Stock Position:  -0.02284507552948652
Bond Position:  [-9.32706725]


portfolio before change:  [-11.69253379]
curr_Stock_Price:  103.5183089669143
curr_Factors:  [103.51830897]
mat_Sqrt:  [[0.15]]
grads:  [0.07804659]
Stock Position:  0.07804659385448685
Bond Position:  [-19.77178521]


portfolio before change:  [-11.67758837]
curr_Stock_Price:  103.7256364305604
curr_Factors:  [103.72563643]
mat_Sqrt:  [[0.15]]
grads:  [-0.03278937]
Stock Position:  -0.03278937133094468
Bond Position:  [-8.27648996]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.68509247]
Stock Price:  103.93871793376773
PL:  [-15.62381041]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37574747e-02]
 [-6.09408137e-03]
 [ 6.65307957e-03]
 [-8.58215072e-03]
 [ 1.21906812e-02]
 [-4.60972360e-03]
 [-1.99374553e-04]
 [-1.58758028e-03]
 [-9.49187637e-03]
 [-1.39690487e-03]
 [ 1.37857353e-02]
 [-5.98274238e-03]
 [-1.09700937e-03]
 [ 4.72200115e-03]
 [-1.18759779e-03]
 [ 1.02086632e-02]
 [-3.09666765e-03]
 [-1.52018812e-02]
 [ 2.01000852e-02]
 [ 2.48655233e-03]
 [-3.51700366e-03]
 [ 4.45714383e-03]
 [ 1.60337907e-02]
 [ 1.72027949e-02]
 [-5.30665412e-03]
 [ 4.80711119e-03]
 [ 5.53520215e-03]
 [ 8.24499252e-03]
 [ 3.08193729e-02]
 [ 5.80354228e-04]
 [-8.36216781e-03]
 [ 7.81600338e-03]
 [ 1.23442982e-02]
 [-8.09887410e-03]
 [ 5.83289998e-03]
 [ 9.53677131e-03]
 [-2.68280954e-02]
 [ 2.87419130e-03]
 [-5.75142117e-02]
 [-1.43076167e-02]
 [ 7.16688984e-03]
 [ 5.93117252e-03]
 [-2.85403023e-03]
 [ 9.69091432e-04]
 [ 4.42092691e-03]
 [ 1.48213968e-02]
 [ 1.06397093e-02]
 [ 5.15393565e-03]
 [-4.69945567e-03]
 [-4.98081415e-04]
 [-5.30008222e-03]
 [ 1.43139647e-03]
 [ 1.01245225e-03]
 [ 7.78473216e-03]
 [-8.12911314e-03]
 [-4.56715986e-03]
 [-3.61634097e-04]
 [ 1.24566946e-02]
 [ 7.86413870e-03]
 [-3.36700797e-03]
 [-5.14909553e-03]
 [-3.00448076e-04]
 [-5.11452826e-03]
 [ 4.84266664e-04]
 [ 1.98088811e-02]
 [ 5.45874542e-03]
 [ 7.38781020e-03]
 [ 5.25798836e-03]
 [ 3.70347792e-03]
 [ 1.85160743e-02]
 [ 7.43561892e-04]
 [-1.53477131e-02]
 [-2.19957164e-03]
 [ 1.22559480e-03]
 [ 3.42843706e-03]
 [-1.72009990e-02]
 [-3.74877480e-03]
 [ 1.16114880e-02]
 [-6.16354946e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.57440734]
curr_Stock_Price:  99.88171717393081
curr_Factors:  [99.88171717]
mat_Sqrt:  [[0.15]]
grads:  [-0.0917165]
Stock Position:  -0.09171649819104101
Bond Position:  [8.58639399]


portfolio before change:  [-0.53002783]
curr_Stock_Price:  99.40369152356097
curr_Factors:  [99.40369152]
mat_Sqrt:  [[0.15]]
grads:  [-0.04062721]
Stock Position:  -0.0406272091355315
Bond Position:  [3.50846673]


portfolio before change:  [-0.53493437]
curr_Stock_Price:  99.52985878627054
curr_Factors:  [99.52985879]
mat_Sqrt:  [[0.15]]
grads:  [0.04435386]
Stock Position:  0.04435386379996932
Bond Position:  [-4.94946817]


portfolio before change:  [-0.51894937]
curr_Stock_Price:  99.89723038721303
curr_Factors:  [99.89723039]
mat_Sqrt:  [[0.15]]
grads:  [-0.05721434]
Stock Position:  -0.05721433811842223
Bond Position:  [5.19660454]


portfolio before change:  [-0.51896688]
curr_Stock_Price:  99.90321322924004
curr_Factors:  [99.90321323]
mat_Sqrt:  [[0.15]]
grads:  [0.08127121]
Stock Position:  0.0812712080411267
Bond Position:  [-8.63822171]


portfolio before change:  [-0.49766535]
curr_Stock_Price:  100.17196079141252
curr_Factors:  [100.17196079]
mat_Sqrt:  [[0.15]]
grads:  [-0.03073149]
Stock Position:  -0.030731490634208335
Bond Position:  [2.58076833]


portfolio before change:  [-0.47567563]
curr_Stock_Price:  99.46166624211376
curr_Factors:  [99.46166624]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132916]
Stock Position:  -0.0013291636897181983
Bond Position:  [-0.3434748]


portfolio before change:  [-0.47591629]
curr_Stock_Price:  99.62657539471779
curr_Factors:  [99.62657539]
mat_Sqrt:  [[0.15]]
grads:  [-0.01058387]
Stock Position:  -0.01058386852168497
Bond Position:  [0.57851828]


portfolio before change:  [-0.47710724]
curr_Stock_Price:  99.7425164018171
curr_Factors:  [99.7425164]
mat_Sqrt:  [[0.15]]
grads:  [-0.06327918]
Stock Position:  -0.0632791758042113
Bond Position:  [5.83451699]


portfolio before change:  [-0.49961735]
curr_Stock_Price:  100.10400628496677
curr_Factors:  [100.10400628]
mat_Sqrt:  [[0.15]]
grads:  [-0.0093127]
Stock Position:  -0.009312699151577883
Bond Position:  [0.43262114]


portfolio before change:  [-0.49376041]
curr_Stock_Price:  99.47798998006128
curr_Factors:  [99.47798998]
mat_Sqrt:  [[0.15]]
grads:  [0.0919049]
Stock Position:  0.09190490193765831
Bond Position:  [-9.63627532]


portfolio before change:  [-0.50205649]
curr_Stock_Price:  99.39427527481912
curr_Factors:  [99.39427527]
mat_Sqrt:  [[0.15]]
grads:  [-0.03988495]
Stock Position:  -0.039884949200230474
Bond Position:  [3.46227913]


portfolio before change:  [-0.50868651]
curr_Stock_Price:  99.56592963839206
curr_Factors:  [99.56592964]
mat_Sqrt:  [[0.15]]
grads:  [-0.0073134]
Stock Position:  -0.007313395782983142
Bond Position:  [0.21947854]


portfolio before change:  [-0.50511038]
curr_Stock_Price:  99.0788206241165
curr_Factors:  [99.07882062]
mat_Sqrt:  [[0.15]]
grads:  [0.03148001]
Stock Position:  0.03148000764422061
Bond Position:  [-3.62411241]


portfolio before change:  [-0.50134875]
curr_Stock_Price:  99.20550879248927
curr_Factors:  [99.20550879]
mat_Sqrt:  [[0.15]]
grads:  [-0.00791732]
Stock Position:  -0.007917318569969484
Bond Position:  [0.28409287]


portfolio before change:  [-0.50015015]
curr_Stock_Price:  99.05636300055556
curr_Factors:  [99.056363]
mat_Sqrt:  [[0.15]]
grads:  [0.06805775]
Stock Position:  0.06805775496099244
Bond Position:  [-7.24170383]


portfolio before change:  [-0.54547593]
curr_Stock_Price:  98.39702371870021
curr_Factors:  [98.39702372]
mat_Sqrt:  [[0.15]]
grads:  [-0.02064445]
Stock Position:  -0.02064445096683613
Bond Position:  [1.48587661]


portfolio before change:  [-0.56802349]
curr_Stock_Price:  99.49370739860557
curr_Factors:  [99.4937074]
mat_Sqrt:  [[0.15]]
grads:  [-0.10134587]
Stock Position:  -0.10134587459479232
Bond Position:  [9.5152533]


portfolio before change:  [-0.61069304]
curr_Stock_Price:  99.9206046356563
curr_Factors:  [99.92060464]
mat_Sqrt:  [[0.15]]
grads:  [0.13400057]
Stock Position:  0.13400056795738868
Bond Position:  [-14.00011081]


portfolio before change:  [-0.61874096]
curr_Stock_Price:  99.86707584196388
curr_Factors:  [99.86707584]
mat_Sqrt:  [[0.15]]
grads:  [0.01657702]
Stock Position:  0.016577015514908762
Bond Position:  [-2.27423903]


portfolio before change:  [-0.62118495]
curr_Stock_Price:  99.72821825825662
curr_Factors:  [99.72821826]
mat_Sqrt:  [[0.15]]
grads:  [-0.02344669]
Stock Position:  -0.02344669107753832
Bond Position:  [1.71711177]


portfolio before change:  [-0.6229893]
curr_Stock_Price:  99.80975068317726
curr_Factors:  [99.80975068]
mat_Sqrt:  [[0.15]]
grads:  [0.02971429]
Stock Position:  0.02971429218540119
Bond Position:  [-3.58876539]


portfolio before change:  [-0.62024291]
curr_Stock_Price:  99.90972578428669
curr_Factors:  [99.90972578]
mat_Sqrt:  [[0.15]]
grads:  [0.10689194]
Stock Position:  0.10689193817088938
Bond Position:  [-11.29978714]


portfolio before change:  [-0.58226068]
curr_Stock_Price:  100.27166601394711
curr_Factors:  [100.27166601]
mat_Sqrt:  [[0.15]]
grads:  [0.1146853]
Stock Position:  0.11468529918276209
Bond Position:  [-12.08194669]


portfolio before change:  [-0.62512578]
curr_Stock_Price:  99.90448769640984
curr_Factors:  [99.9044877]
mat_Sqrt:  [[0.15]]
grads:  [-0.03537769]
Stock Position:  -0.035377694128124644
Bond Position:  [2.90926463]


portfolio before change:  [-0.63440552]
curr_Stock_Price:  100.17193239236833
curr_Factors:  [100.17193239]
mat_Sqrt:  [[0.15]]
grads:  [0.03204741]
Stock Position:  0.03204740793795414
Bond Position:  [-3.8446563]


portfolio before change:  [-0.65985644]
curr_Stock_Price:  99.38526582128556
curr_Factors:  [99.38526582]
mat_Sqrt:  [[0.15]]
grads:  [0.03690135]
Stock Position:  0.03690134763534929
Bond Position:  [-4.32730669]


portfolio before change:  [-0.67974824]
curr_Stock_Price:  98.85354186127346
curr_Factors:  [98.85354186]
mat_Sqrt:  [[0.15]]
grads:  [0.05496662]
Stock Position:  0.054966616818622124
Bond Position:  [-6.11339299]


portfolio before change:  [-0.59023381]
curr_Stock_Price:  100.48901679389971
curr_Factors:  [100.48901679]
mat_Sqrt:  [[0.15]]
grads:  [0.20546249]
Stock Position:  0.2054624861454459
Bond Position:  [-21.23695703]


portfolio before change:  [-0.67177853]
curr_Stock_Price:  100.09859337684448
curr_Factors:  [100.09859338]
mat_Sqrt:  [[0.15]]
grads:  [0.00386903]
Stock Position:  0.003869028185437967
Bond Position:  [-1.05906281]


portfolio before change:  [-0.67173495]
curr_Stock_Price:  100.12696516891363
curr_Factors:  [100.12696517]
mat_Sqrt:  [[0.15]]
grads:  [-0.05574779]
Stock Position:  -0.05574778543232307
Bond Position:  [4.91012162]


portfolio before change:  [-0.69467547]
curr_Stock_Price:  100.54397556760212
curr_Factors:  [100.54397557]
mat_Sqrt:  [[0.15]]
grads:  [0.05210669]
Stock Position:  0.05210668921147347
Bond Position:  [-5.93368915]


portfolio before change:  [-0.70235516]
curr_Stock_Price:  100.40370899256442
curr_Factors:  [100.40370899]
mat_Sqrt:  [[0.15]]
grads:  [0.08229532]
Stock Position:  0.08229532125403337
Bond Position:  [-8.96511065]


portfolio before change:  [-0.77627452]
curr_Stock_Price:  99.51229710835729
curr_Factors:  [99.51229711]
mat_Sqrt:  [[0.15]]
grads:  [-0.05399249]
Stock Position:  -0.05399249402219091
Bond Position:  [4.59664258]


portfolio before change:  [-0.82713336]
curr_Stock_Price:  100.45957938107215
curr_Factors:  [100.45957938]
mat_Sqrt:  [[0.15]]
grads:  [0.038886]
Stock Position:  0.0388859998596937
Bond Position:  [-4.73360455]


portfolio before change:  [-0.80247372]
curr_Stock_Price:  101.10133986657728
curr_Factors:  [101.10133987]
mat_Sqrt:  [[0.15]]
grads:  [0.06357848]
Stock Position:  0.06357847539781604
Bond Position:  [-7.23034277]


portfolio before change:  [-0.83251572]
curr_Stock_Price:  100.63592932776261
curr_Factors:  [100.63592933]
mat_Sqrt:  [[0.15]]
grads:  [-0.17885397]
Stock Position:  -0.17885396942428278
Bond Position:  [17.1666197]


portfolio before change:  [-0.76183258]
curr_Stock_Price:  100.24672805829167
curr_Factors:  [100.24672806]
mat_Sqrt:  [[0.15]]
grads:  [0.01916128]
Stock Position:  0.01916127533203431
Bond Position:  [-2.68268774]


portfolio before change:  [-0.77043751]
curr_Stock_Price:  99.80639957566186
curr_Factors:  [99.80639958]
mat_Sqrt:  [[0.15]]
grads:  [-0.38342808]
Stock Position:  -0.38342807825126535
Bond Position:  [37.49813847]


portfolio before change:  [-0.49773017]
curr_Stock_Price:  99.10127742580815
curr_Factors:  [99.10127743]
mat_Sqrt:  [[0.15]]
grads:  [-0.09538411]
Stock Position:  -0.09538411102315586
Bond Position:  [8.95495707]


portfolio before change:  [-0.55296118]
curr_Stock_Price:  99.68618310180278
curr_Factors:  [99.6861831]
mat_Sqrt:  [[0.15]]
grads:  [0.04777927]
Stock Position:  0.04777926558794543
Bond Position:  [-5.3158938]


portfolio before change:  [-0.5745001]
curr_Stock_Price:  99.24233651213795
curr_Factors:  [99.24233651]
mat_Sqrt:  [[0.15]]
grads:  [0.03954115]
Stock Position:  0.03954115012830897
Bond Position:  [-4.49865622]


portfolio before change:  [-0.6179862]
curr_Stock_Price:  98.14967928907542
curr_Factors:  [98.14967929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902687]
Stock Position:  -0.019026868218585926
Bond Position:  [1.24949482]


portfolio before change:  [-0.62343401]
curr_Stock_Price:  98.44010595650926
curr_Factors:  [98.44010596]
mat_Sqrt:  [[0.15]]
grads:  [0.00646061]
Stock Position:  0.006460609545020947
Bond Position:  [-1.2594171]


portfolio before change:  [-0.62225611]
curr_Stock_Price:  98.63461073236526
curr_Factors:  [98.63461073]
mat_Sqrt:  [[0.15]]
grads:  [0.02947285]
Stock Position:  0.029472846036562226
Bond Position:  [-3.5292988]


portfolio before change:  [-0.62139617]
curr_Stock_Price:  98.67127255428204
curr_Factors:  [98.67127255]
mat_Sqrt:  [[0.15]]
grads:  [0.09880931]
Stock Position:  0.09880931210122819
Bond Position:  [-10.37103673]


portfolio before change:  [-0.60631173]
curr_Stock_Price:  98.83049488687544
curr_Factors:  [98.83049489]
mat_Sqrt:  [[0.15]]
grads:  [0.0709314]
Stock Position:  0.07093139535299521
Bond Position:  [-7.61649663]


portfolio before change:  [-0.62835572]
curr_Stock_Price:  98.52642723074986
curr_Factors:  [98.52642723]
mat_Sqrt:  [[0.15]]
grads:  [0.03435957]
Stock Position:  0.034359570987251876
Bond Position:  [-4.01368149]


portfolio before change:  [-0.64850871]
curr_Stock_Price:  97.94719622232473
curr_Factors:  [97.94719622]
mat_Sqrt:  [[0.15]]
grads:  [-0.0313297]
Stock Position:  -0.03132970444192981
Bond Position:  [2.420148]


portfolio before change:  [-0.63402518]
curr_Stock_Price:  97.48973066342113
curr_Factors:  [97.48973066]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332054]
Stock Position:  -0.0033205427641222647
Bond Position:  [-0.31030636]


portfolio before change:  [-0.6347855]
curr_Stock_Price:  97.71286212338411
curr_Factors:  [97.71286212]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533388]
Stock Position:  -0.03533388148953464
Bond Position:  [2.81778919]


portfolio before change:  [-0.63025477]
curr_Stock_Price:  97.58962046877119
curr_Factors:  [97.58962047]
mat_Sqrt:  [[0.15]]
grads:  [0.00954264]
Stock Position:  0.009542643141120546
Bond Position:  [-1.56151769]


portfolio before change:  [-0.62647145]
curr_Stock_Price:  97.9963131511872
curr_Factors:  [97.99631315]
mat_Sqrt:  [[0.15]]
grads:  [0.00674968]
Stock Position:  0.006749681644522699
Bond Position:  [-1.28791536]


portfolio before change:  [-0.62462827]
curr_Stock_Price:  98.28131556155512
curr_Factors:  [98.28131556]
mat_Sqrt:  [[0.15]]
grads:  [0.05189821]
Stock Position:  0.05189821442460394
Bond Position:  [-5.72525306]


portfolio before change:  [-0.62300605]
curr_Stock_Price:  98.31946819733041
curr_Factors:  [98.3194682]
mat_Sqrt:  [[0.15]]
grads:  [-0.05419409]
Stock Position:  -0.054194087599621424
Bond Position:  [4.70532782]


portfolio before change:  [-0.60618716]
curr_Stock_Price:  98.0145493450653
curr_Factors:  [98.01454935]
mat_Sqrt:  [[0.15]]
grads:  [-0.03044773]
Stock Position:  -0.030447732392097096
Bond Position:  [2.37813361]


portfolio before change:  [-0.6071427]
curr_Stock_Price:  98.05081381922776
curr_Factors:  [98.05081382]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241089]
Stock Position:  -0.00241089397874121
Bond Position:  [-0.37075258]


portfolio before change:  [-0.60459523]
curr_Stock_Price:  96.98455556788132
curr_Factors:  [96.98455557]
mat_Sqrt:  [[0.15]]
grads:  [0.08304463]
Stock Position:  0.08304463037421228
Bond Position:  [-8.6586418]


portfolio before change:  [-0.6136575]
curr_Stock_Price:  96.88194708615698
curr_Factors:  [96.88194709]
mat_Sqrt:  [[0.15]]
grads:  [0.05242759]
Stock Position:  0.05242759131385872
Bond Position:  [-5.69294463]


portfolio before change:  [-0.60204426]
curr_Stock_Price:  97.11024402261826
curr_Factors:  [97.11024402]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244672]
Stock Position:  -0.02244671982352459
Bond Position:  [1.57776218]


portfolio before change:  [-0.6039349]
curr_Stock_Price:  97.19886507187209
curr_Factors:  [97.19886507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0343273]
Stock Position:  -0.034327303532269975
Bond Position:  [2.73264005]


portfolio before change:  [-0.62353522]
curr_Stock_Price:  97.77482403703523
curr_Factors:  [97.77482404]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200299]
Stock Position:  -0.0020029871701005243
Bond Position:  [-0.4276935]


portfolio before change:  [-0.62330181]
curr_Stock_Price:  97.64494625829896
curr_Factors:  [97.64494626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03409686]
Stock Position:  -0.034096855090043024
Bond Position:  [2.70608377]


portfolio before change:  [-0.63357594]
curr_Stock_Price:  97.95122847992381
curr_Factors:  [97.95122848]
mat_Sqrt:  [[0.15]]
grads:  [0.00322844]
Stock Position:  0.0032284444253275757
Bond Position:  [-0.94980603]


portfolio before change:  [-0.62977391]
curr_Stock_Price:  99.14728134500768
curr_Factors:  [99.14728135]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-13.72308526]


portfolio before change:  [-0.54354729]
curr_Stock_Price:  99.8067153709871
curr_Factors:  [99.80671537]
mat_Sqrt:  [[0.15]]
grads:  [0.03639164]
Stock Position:  0.03639163612354452
Bond Position:  [-4.17567696]


portfolio before change:  [-0.53114867]
curr_Stock_Price:  100.1545868770019
curr_Factors:  [100.15458688]
mat_Sqrt:  [[0.15]]
grads:  [0.04925207]
Stock Position:  0.0492520679678144
Bond Position:  [-5.46396919]


portfolio before change:  [-0.43821981]
curr_Stock_Price:  102.0483220110012
curr_Factors:  [102.04832201]
mat_Sqrt:  [[0.15]]
grads:  [0.03505326]
Stock Position:  0.03505325573180057
Bond Position:  [-4.01534574]


portfolio before change:  [-0.43725578]
curr_Stock_Price:  102.08298346008516
curr_Factors:  [102.08298346]
mat_Sqrt:  [[0.15]]
grads:  [0.02468985]
Stock Position:  0.024689852796174288
Bond Position:  [-2.95766961]


portfolio before change:  [-0.43783959]
curr_Stock_Price:  102.06682478479173
curr_Factors:  [102.06682478]
mat_Sqrt:  [[0.15]]
grads:  [0.1234405]
Stock Position:  0.12344049551781809
Bond Position:  [-13.03701902]


portfolio before change:  [-0.34715162]
curr_Stock_Price:  102.808095382071
curr_Factors:  [102.80809538]
mat_Sqrt:  [[0.15]]
grads:  [0.00495708]
Stock Position:  0.004957079281709617
Bond Position:  [-0.8567795]


portfolio before change:  [-0.34365662]
curr_Stock_Price:  103.52395079511822
curr_Factors:  [103.5239508]
mat_Sqrt:  [[0.15]]
grads:  [-0.10231809]
Stock Position:  -0.10231808748702999
Bond Position:  [10.24871603]


portfolio before change:  [-0.24691823]
curr_Stock_Price:  102.58474418138071
curr_Factors:  [102.58474418]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466381]
Stock Position:  -0.014663810963773394
Bond Position:  [1.25736507]


portfolio before change:  [-0.24588752]
curr_Stock_Price:  102.51981420355315
curr_Factors:  [102.5198142]
mat_Sqrt:  [[0.15]]
grads:  [0.00817063]
Stock Position:  0.008170631974804733
Bond Position:  [-1.08353919]


portfolio before change:  [-0.2385532]
curr_Stock_Price:  103.42574708580129
curr_Factors:  [103.42574709]
mat_Sqrt:  [[0.15]]
grads:  [0.02285625]
Stock Position:  0.02285624709378404
Bond Position:  [-2.60247763]


portfolio before change:  [-0.23917574]
curr_Stock_Price:  103.4056267783111
curr_Factors:  [103.40562678]
mat_Sqrt:  [[0.15]]
grads:  [-0.11467333]
Stock Position:  -0.1146733264693241
Bond Position:  [11.61869146]


portfolio before change:  [-0.31995759]
curr_Stock_Price:  104.11641146744272
curr_Factors:  [104.11641147]
mat_Sqrt:  [[0.15]]
grads:  [-0.02499183]
Stock Position:  -0.02499183196919101
Bond Position:  [2.28210227]


portfolio before change:  [-0.32785047]
curr_Stock_Price:  104.43793722547046
curr_Factors:  [104.43793723]
mat_Sqrt:  [[0.15]]
grads:  [0.07740992]
Stock Position:  0.07740991991955766
Bond Position:  [-8.41238283]


portfolio before change:  [-0.34219157]
curr_Stock_Price:  104.25946776172515
curr_Factors:  [104.25946776]
mat_Sqrt:  [[0.15]]
grads:  [-0.04109033]
Stock Position:  -0.04109032974499921
Bond Position:  [3.94186434]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.35633415]
Stock Price:  104.60964644066169
PL:  [-4.96598059]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.30142312e-02]
 [-4.36972593e-03]
 [ 1.05477916e-02]
 [-1.45531881e-02]
 [-9.12281559e-03]
 [-1.39179850e-03]
 [-4.81364904e-03]
 [-1.79797566e-02]
 [ 7.50615094e-03]
 [ 1.76595581e-03]
 [ 6.18774813e-03]
 [-2.08879344e-03]
 [-2.62449948e-03]
 [ 9.30032789e-03]
 [-2.14038079e-03]
 [ 1.34053733e-02]
 [ 5.87400884e-02]
 [-1.46965395e-02]
 [ 2.07558784e-02]
 [-2.57129657e-04]
 [-4.93749143e-03]
 [ 5.41596455e-03]
 [ 1.77868307e-02]
 [ 1.74452650e-02]
 [-4.50721049e-03]
 [ 6.41703100e-03]
 [-2.39159286e-03]
 [ 8.25071220e-03]
 [ 2.28611706e-02]
 [ 2.54329664e-03]
 [-7.04262160e-03]
 [ 1.31180104e-02]
 [ 1.24480716e-02]
 [-4.48281444e-03]
 [-6.11094407e-04]
 [ 1.82772741e-02]
 [ 5.06667853e-03]
 [ 1.29030876e-03]
 [-3.30442251e-02]
 [-1.75002439e-02]
 [ 7.17134234e-03]
 [ 1.22153371e-02]
 [-2.25690522e-03]
 [-9.48989122e-04]
 [ 3.44004988e-03]
 [ 1.52242903e-02]
 [ 1.08351178e-02]
 [ 4.05326848e-03]
 [ 8.21820641e-03]
 [-2.20441807e-03]
 [ 1.77582378e-04]
 [-8.22804886e-03]
 [ 1.96371326e-03]
 [ 2.47226660e-03]
 [-4.77457242e-03]
 [-4.07425663e-03]
 [ 2.72787426e-03]
 [ 5.71097964e-03]
 [ 7.45583024e-03]
 [-4.02701464e-03]
 [-5.65169444e-04]
 [ 5.65622351e-03]
 [-8.15727083e-03]
 [ 7.72345542e-03]
 [ 1.98105818e-02]
 [ 5.43629831e-03]
 [ 8.22460113e-03]
 [-2.14871465e-04]
 [ 2.82140978e-03]
 [ 2.17688782e-02]
 [ 2.51126799e-03]
 [-1.58060502e-02]
 [-6.37014140e-03]
 [ 9.53024214e-04]
 [ 7.91806924e-03]
 [ 3.91579328e-05]
 [-1.47825955e-03]
 [ 1.21243943e-04]
 [-2.35760311e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.18838403]
curr_Stock_Price:  99.44507005464108
curr_Factors:  [99.44507005]
mat_Sqrt:  [[0.15]]
grads:  [-0.08676154]
Stock Position:  -0.08676154125224342
Bond Position:  [-1.56037648]


portfolio before change:  [-10.18964405]
curr_Stock_Price:  99.45846886627304
curr_Factors:  [99.45846887]
mat_Sqrt:  [[0.15]]
grads:  [-0.02913151]
Stock Position:  -0.029131506173844156
Bond Position:  [-7.29226905]


portfolio before change:  [-10.21469535]
curr_Stock_Price:  100.30276134111064
curr_Factors:  [100.30276134]
mat_Sqrt:  [[0.15]]
grads:  [0.07031861]
Stock Position:  0.07031861075977945
Bond Position:  [-17.26784618]


portfolio before change:  [-10.19470988]
curr_Stock_Price:  100.60232273250654
curr_Factors:  [100.60232273]
mat_Sqrt:  [[0.15]]
grads:  [-0.09702125]
Stock Position:  -0.09702125412286211
Bond Position:  [-0.43414636]


portfolio before change:  [-10.20943878]
curr_Stock_Price:  100.75385407128833
curr_Factors:  [100.75385407]
mat_Sqrt:  [[0.15]]
grads:  [-0.06081877]
Stock Position:  -0.060818770632077156
Bond Position:  [-4.08171323]


portfolio before change:  [-10.21640704]
curr_Stock_Price:  100.86423368562734
curr_Factors:  [100.86423369]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927866]
Stock Position:  -0.009278656697650255
Bond Position:  [-9.28052245]


portfolio before change:  [-10.22132014]
curr_Stock_Price:  101.33122475591809
curr_Factors:  [101.33122476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209099]
Stock Position:  -0.03209099357609296
Bond Position:  [-6.96950046]


portfolio before change:  [-10.19600754]
curr_Stock_Price:  100.52887466127137
curr_Factors:  [100.52887466]
mat_Sqrt:  [[0.15]]
grads:  [-0.11986504]
Stock Position:  -0.1198650440064483
Bond Position:  [1.85389045]


portfolio before change:  [-10.23171892]
curr_Stock_Price:  100.82777125915251
curr_Factors:  [100.82777126]
mat_Sqrt:  [[0.15]]
grads:  [0.05004101]
Stock Position:  0.0500410062551369
Bond Position:  [-15.27724205]


portfolio before change:  [-10.24167914]
curr_Stock_Price:  100.64781169778918
curr_Factors:  [100.6478117]
mat_Sqrt:  [[0.15]]
grads:  [0.01177304]
Stock Position:  0.011773038731098298
Bond Position:  [-11.42660972]


portfolio before change:  [-10.244781]
curr_Stock_Price:  100.44500253387552
curr_Factors:  [100.44500253]
mat_Sqrt:  [[0.15]]
grads:  [0.04125165]
Stock Position:  0.04125165417345443
Bond Position:  [-14.38830351]


portfolio before change:  [-10.25575774]
curr_Stock_Price:  100.20071066719609
curr_Factors:  [100.20071067]
mat_Sqrt:  [[0.15]]
grads:  [-0.01392529]
Stock Position:  -0.013925289578590652
Bond Position:  [-8.86043383]


portfolio before change:  [-10.25981384]
curr_Stock_Price:  100.45221700488085
curr_Factors:  [100.452217]
mat_Sqrt:  [[0.15]]
grads:  [-0.01749666]
Stock Position:  -0.01749666318499764
Bond Position:  [-8.50223523]


portfolio before change:  [-10.25084518]
curr_Stock_Price:  99.90925270330392
curr_Factors:  [99.9092527]
mat_Sqrt:  [[0.15]]
grads:  [0.06200219]
Stock Position:  0.06200218592569077
Bond Position:  [-16.44543724]


portfolio before change:  [-10.20740694]
curr_Stock_Price:  100.6264227580748
curr_Factors:  [100.62642276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01426921]
Stock Position:  -0.01426920523611303
Bond Position:  [-8.77154786]


portfolio before change:  [-10.22397594]
curr_Stock_Price:  101.74917340220057
curr_Factors:  [101.7491734]
mat_Sqrt:  [[0.15]]
grads:  [0.08936916]
Stock Position:  0.08936915505181238
Bond Position:  [-19.31721359]


portfolio before change:  [-10.27974796]
curr_Stock_Price:  101.13861981242634
curr_Factors:  [101.13861981]
mat_Sqrt:  [[0.15]]
grads:  [0.39160059]
Stock Position:  0.39160058935231956
Bond Position:  [-49.88569108]


portfolio before change:  [-10.58926875]
curr_Stock_Price:  100.35618270000359
curr_Factors:  [100.3561827]
mat_Sqrt:  [[0.15]]
grads:  [-0.09797693]
Stock Position:  -0.09797693004733954
Bond Position:  [-0.75667805]


portfolio before change:  [-10.51612344]
curr_Stock_Price:  99.609143615971
curr_Factors:  [99.60914362]
mat_Sqrt:  [[0.15]]
grads:  [0.13837252]
Stock Position:  0.13837252286953117
Bond Position:  [-24.29929195]


portfolio before change:  [-10.65646794]
curr_Stock_Price:  98.60586826873708
curr_Factors:  [98.60586827]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017142]
Stock Position:  -0.0017141977138198895
Bond Position:  [-10.48743798]


portfolio before change:  [-10.65731287]
curr_Stock_Price:  98.71638287797077
curr_Factors:  [98.71638288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03291661]
Stock Position:  -0.03291660954002127
Bond Position:  [-7.40790424]


portfolio before change:  [-10.65663135]
curr_Stock_Price:  98.68161234952882
curr_Factors:  [98.68161235]
mat_Sqrt:  [[0.15]]
grads:  [0.03610643]
Stock Position:  0.036106430337101064
Bond Position:  [-14.21967211]


portfolio before change:  [-10.62698033]
curr_Stock_Price:  99.52743893579375
curr_Factors:  [99.52743894]
mat_Sqrt:  [[0.15]]
grads:  [0.11857887]
Stock Position:  0.11857887158137653
Bond Position:  [-22.42883173]


portfolio before change:  [-10.58758488]
curr_Stock_Price:  99.87149091758408
curr_Factors:  [99.87149092]
mat_Sqrt:  [[0.15]]
grads:  [0.11630177]
Stock Position:  0.11630176659463129
Bond Position:  [-22.2028157]


portfolio before change:  [-10.55384778]
curr_Stock_Price:  100.17350538194104
curr_Factors:  [100.17350538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004807]
Stock Position:  -0.030048069965847943
Bond Position:  [-7.54382728]


portfolio before change:  [-10.57145012]
curr_Stock_Price:  100.74361958765162
curr_Factors:  [100.74361959]
mat_Sqrt:  [[0.15]]
grads:  [0.04278021]
Stock Position:  0.042780206634869235
Bond Position:  [-14.88128298]


portfolio before change:  [-10.59058005]
curr_Stock_Price:  100.31819325314609
curr_Factors:  [100.31819325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01594395]
Stock Position:  -0.015943952433096903
Bond Position:  [-8.99111155]


portfolio before change:  [-10.578735]
curr_Stock_Price:  99.54002900809635
curr_Factors:  [99.54002901]
mat_Sqrt:  [[0.15]]
grads:  [0.05500475]
Stock Position:  0.055004748028568765
Bond Position:  [-16.05390921]


portfolio before change:  [-10.55832868]
curr_Stock_Price:  99.9292631139679
curr_Factors:  [99.92926311]
mat_Sqrt:  [[0.15]]
grads:  [0.1524078]
Stock Position:  0.15240780432771736
Bond Position:  [-25.78832826]


portfolio before change:  [-10.48977986]
curr_Stock_Price:  100.3896111740955
curr_Factors:  [100.38961117]
mat_Sqrt:  [[0.15]]
grads:  [0.01695531]
Stock Position:  0.016955310933660095
Bond Position:  [-12.19191693]


portfolio before change:  [-10.48649365]
curr_Stock_Price:  100.6283701223862
curr_Factors:  [100.62837012]
mat_Sqrt:  [[0.15]]
grads:  [-0.04695081]
Stock Position:  -0.0469508106515271
Bond Position:  [-5.7619101]


portfolio before change:  [-10.52818046]
curr_Stock_Price:  101.5085823869488
curr_Factors:  [101.50858239]
mat_Sqrt:  [[0.15]]
grads:  [0.0874534]
Stock Position:  0.08745340240674027
Bond Position:  [-19.40545136]


portfolio before change:  [-10.60214146]
curr_Stock_Price:  100.67673229486446
curr_Factors:  [100.67673229]
mat_Sqrt:  [[0.15]]
grads:  [0.08298714]
Stock Position:  0.08298714377520802
Bond Position:  [-18.95701591]


portfolio before change:  [-10.6730699]
curr_Stock_Price:  99.83631787940163
curr_Factors:  [99.83631788]
mat_Sqrt:  [[0.15]]
grads:  [-0.02988543]
Stock Position:  -0.029885429582410483
Bond Position:  [-7.68941865]


portfolio before change:  [-10.64152106]
curr_Stock_Price:  98.76457678085035
curr_Factors:  [98.76457678]
mat_Sqrt:  [[0.15]]
grads:  [-0.00407396]
Stock Position:  -0.004073962712819402
Bond Position:  [-10.23915786]


portfolio before change:  [-10.64068016]
curr_Stock_Price:  98.40108103625303
curr_Factors:  [98.40108104]
mat_Sqrt:  [[0.15]]
grads:  [0.12184849]
Stock Position:  0.12184849384458431
Bond Position:  [-22.63070368]


portfolio before change:  [-10.64359998]
curr_Stock_Price:  98.38872665435038
curr_Factors:  [98.38872665]
mat_Sqrt:  [[0.15]]
grads:  [0.03377786]
Stock Position:  0.03377785688832554
Bond Position:  [-13.96696031]


portfolio before change:  [-10.64095876]
curr_Stock_Price:  98.49276478761819
curr_Factors:  [98.49276479]
mat_Sqrt:  [[0.15]]
grads:  [0.00860206]
Stock Position:  0.008602058370284679
Bond Position:  [-11.48819927]


portfolio before change:  [-10.64231954]
curr_Stock_Price:  98.41804528656836
curr_Factors:  [98.41804529]
mat_Sqrt:  [[0.15]]
grads:  [-0.22029483]
Stock Position:  -0.22029483376061468
Bond Position:  [11.03866739]


portfolio before change:  [-10.64123069]
curr_Stock_Price:  98.41623447461106
curr_Factors:  [98.41623447]
mat_Sqrt:  [[0.15]]
grads:  [-0.11666829]
Stock Position:  -0.11666829273342341
Bond Position:  [0.84082337]


portfolio before change:  [-10.67755209]
curr_Stock_Price:  98.72800689463676
curr_Factors:  [98.72800689]
mat_Sqrt:  [[0.15]]
grads:  [0.04780895]
Stock Position:  0.047808948903964255
Bond Position:  [-15.39763433]


portfolio before change:  [-10.66550436]
curr_Stock_Price:  99.00013399811861
curr_Factors:  [99.000134]
mat_Sqrt:  [[0.15]]
grads:  [0.08143558]
Stock Position:  0.08143558091314529
Bond Position:  [-18.72763778]


portfolio before change:  [-10.6735457]
curr_Stock_Price:  98.91576272008778
curr_Factors:  [98.91576272]
mat_Sqrt:  [[0.15]]
grads:  [-0.01504603]
Stock Position:  -0.01504603479140496
Bond Position:  [-9.18525569]


portfolio before change:  [-10.67639587]
curr_Stock_Price:  99.06703667796987
curr_Factors:  [99.06703668]
mat_Sqrt:  [[0.15]]
grads:  [-0.00632659]
Stock Position:  -0.006326594143654067
Bond Position:  [-10.04963894]


portfolio before change:  [-10.67375884]
curr_Stock_Price:  98.55093683019781
curr_Factors:  [98.55093683]
mat_Sqrt:  [[0.15]]
grads:  [0.02293367]
Stock Position:  0.022933665891389083
Bond Position:  [-12.9338931]


portfolio before change:  [-10.65456473]
curr_Stock_Price:  99.42312631375205
curr_Factors:  [99.42312631]
mat_Sqrt:  [[0.15]]
grads:  [0.10149527]
Stock Position:  0.101495268535656
Bond Position:  [-20.74554163]


portfolio before change:  [-10.59429332]
curr_Stock_Price:  100.02973633875999
curr_Factors:  [100.02973634]
mat_Sqrt:  [[0.15]]
grads:  [0.07223412]
Stock Position:  0.0722341185488462
Bond Position:  [-17.81985315]


portfolio before change:  [-10.58572304]
curr_Stock_Price:  100.16380117769157
curr_Factors:  [100.16380118]
mat_Sqrt:  [[0.15]]
grads:  [0.02702179]
Stock Position:  0.02702178989371338
Bond Position:  [-13.29232823]


portfolio before change:  [-10.59316991]
curr_Stock_Price:  99.91895903676898
curr_Factors:  [99.91895904]
mat_Sqrt:  [[0.15]]
grads:  [0.05478804]
Stock Position:  0.05478804276012015
Bond Position:  [-16.06753411]


portfolio before change:  [-10.6035739]
curr_Stock_Price:  99.74739351941375
curr_Factors:  [99.74739352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01469612]
Stock Position:  -0.014696120468649843
Bond Position:  [-9.13767419]


portfolio before change:  [-10.61034569]
curr_Stock_Price:  100.16931926823892
curr_Factors:  [100.16931927]
mat_Sqrt:  [[0.15]]
grads:  [0.00118388]
Stock Position:  0.0011838825169108633
Bond Position:  [-10.7289344]


portfolio before change:  [-10.61106983]
curr_Stock_Price:  100.12407889736464
curr_Factors:  [100.1240789]
mat_Sqrt:  [[0.15]]
grads:  [-0.05485366]
Stock Position:  -0.05485365906996303
Bond Position:  [-5.11889774]


portfolio before change:  [-10.59168947]
curr_Stock_Price:  99.76493605580774
curr_Factors:  [99.76493606]
mat_Sqrt:  [[0.15]]
grads:  [0.01309142]
Stock Position:  0.013091421718983602
Bond Position:  [-11.89775432]


portfolio before change:  [-10.58940668]
curr_Stock_Price:  99.9961120591757
curr_Factors:  [99.99611206]
mat_Sqrt:  [[0.15]]
grads:  [0.01648178]
Stock Position:  0.01648177730107258
Bond Position:  [-12.23752033]


portfolio before change:  [-10.59607562]
curr_Stock_Price:  99.63789446611361
curr_Factors:  [99.63789447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03183048]
Stock Position:  -0.0318304828261701
Bond Position:  [-7.42455333]


portfolio before change:  [-10.61455223]
curr_Stock_Price:  100.20378488960316
curr_Factors:  [100.20378489]
mat_Sqrt:  [[0.15]]
grads:  [-0.02716171]
Stock Position:  -0.02716171084863914
Bond Position:  [-7.892846]


portfolio before change:  [-10.5925155]
curr_Stock_Price:  99.37430657918686
curr_Factors:  [99.37430658]
mat_Sqrt:  [[0.15]]
grads:  [0.01818583]
Stock Position:  0.01818582838568302
Bond Position:  [-12.39971958]


portfolio before change:  [-10.59167098]
curr_Stock_Price:  99.46336077332991
curr_Factors:  [99.46336077]
mat_Sqrt:  [[0.15]]
grads:  [0.0380732]
Stock Position:  0.038073197591374654
Bond Position:  [-14.37855917]


portfolio before change:  [-10.61221841]
curr_Stock_Price:  98.94728271440218
curr_Factors:  [98.94728271]
mat_Sqrt:  [[0.15]]
grads:  [0.04970553]
Stock Position:  0.04970553496074255
Bond Position:  [-15.53044603]


portfolio before change:  [-10.57086749]
curr_Stock_Price:  99.79872931441861
curr_Factors:  [99.79872931]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684676]
Stock Position:  -0.02684676427439605
Bond Position:  [-7.89159452]


portfolio before change:  [-10.58553909]
curr_Stock_Price:  100.32685140361993
curr_Factors:  [100.3268514]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037678]
Stock Position:  -0.003767796294922831
Bond Position:  [-10.20752796]


portfolio before change:  [-10.58651501]
curr_Stock_Price:  100.41653945766892
curr_Factors:  [100.41653946]
mat_Sqrt:  [[0.15]]
grads:  [0.03770816]
Stock Position:  0.03770815676545115
Bond Position:  [-14.37303762]


portfolio before change:  [-10.59301798]
curr_Stock_Price:  100.26790779187239
curr_Factors:  [100.26790779]
mat_Sqrt:  [[0.15]]
grads:  [-0.05438181]
Stock Position:  -0.05438180553598136
Bond Position:  [-5.14026812]


portfolio before change:  [-10.60149784]
curr_Stock_Price:  100.4179319959691
curr_Factors:  [100.417932]
mat_Sqrt:  [[0.15]]
grads:  [0.0514897]
Stock Position:  0.0514897027749811
Bond Position:  [-15.77198732]


portfolio before change:  [-10.6535741]
curr_Stock_Price:  99.42568545193704
curr_Factors:  [99.42568545]
mat_Sqrt:  [[0.15]]
grads:  [0.13207055]
Stock Position:  0.13207054557317174
Bond Position:  [-23.78477863]


portfolio before change:  [-10.62693694]
curr_Stock_Price:  99.63863041205826
curr_Factors:  [99.63863041]
mat_Sqrt:  [[0.15]]
grads:  [0.03624199]
Stock Position:  0.03624198870059591
Bond Position:  [-14.23803906]


portfolio before change:  [-10.63916963]
curr_Stock_Price:  99.32565697908304
curr_Factors:  [99.32565698]
mat_Sqrt:  [[0.15]]
grads:  [0.05483067]
Stock Position:  0.05483067417950824
Bond Position:  [-16.08526236]


portfolio before change:  [-10.64558284]
curr_Stock_Price:  99.22702871811856
curr_Factors:  [99.22702872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143248]
Stock Position:  -0.0014324764329511567
Bond Position:  [-10.50344246]


portfolio before change:  [-10.646776]
curr_Stock_Price:  99.60167599989548
curr_Factors:  [99.601676]
mat_Sqrt:  [[0.15]]
grads:  [0.0188094]
Stock Position:  0.01880939856157922
Bond Position:  [-12.52022362]


portfolio before change:  [-10.65395568]
curr_Stock_Price:  99.26157243007965
curr_Factors:  [99.26157243]
mat_Sqrt:  [[0.15]]
grads:  [0.14512585]
Stock Position:  0.14512585494482932
Bond Position:  [-25.05937624]


portfolio before change:  [-10.73352292]
curr_Stock_Price:  98.72410113306222
curr_Factors:  [98.72410113]
mat_Sqrt:  [[0.15]]
grads:  [0.01674179]
Stock Position:  0.01674178659557315
Bond Position:  [-12.38634076]


portfolio before change:  [-10.74340498]
curr_Stock_Price:  98.180080055534
curr_Factors:  [98.18008006]
mat_Sqrt:  [[0.15]]
grads:  [-0.10537367]
Stock Position:  -0.10537366820065594
Bond Position:  [-0.3978098]


portfolio before change:  [-10.83002235]
curr_Stock_Price:  99.00184613785642
curr_Factors:  [99.00184614]
mat_Sqrt:  [[0.15]]
grads:  [-0.04246761]
Stock Position:  -0.042467609329149954
Bond Position:  [-6.62565062]


portfolio before change:  [-10.80785708]
curr_Stock_Price:  98.47016137419003
curr_Factors:  [98.47016137]
mat_Sqrt:  [[0.15]]
grads:  [0.00635349]
Stock Position:  0.00635349475793764
Bond Position:  [-11.43348674]


portfolio before change:  [-10.8119644]
curr_Stock_Price:  97.93617125544918
curr_Factors:  [97.93617126]
mat_Sqrt:  [[0.15]]
grads:  [0.05278713]
Stock Position:  0.05278712829283138
Bond Position:  [-15.98173364]


portfolio before change:  [-10.80214783]
curr_Stock_Price:  98.14105956409819
curr_Factors:  [98.14105956]
mat_Sqrt:  [[0.15]]
grads:  [0.00026105]
Stock Position:  0.0002610528850440925
Bond Position:  [-10.82776783]


portfolio before change:  [-10.80282641]
curr_Stock_Price:  98.13406010398786
curr_Factors:  [98.1340601]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985506]
Stock Position:  -0.00985506364384877
Bond Position:  [-9.835709]


portfolio before change:  [-10.80741927]
curr_Stock_Price:  98.53772178510641
curr_Factors:  [98.53772179]
mat_Sqrt:  [[0.15]]
grads:  [0.00080829]
Stock Position:  0.000808292950848135
Bond Position:  [-10.88706662]


portfolio before change:  [-10.80837203]
curr_Stock_Price:  98.20084746344233
curr_Factors:  [98.20084746]
mat_Sqrt:  [[0.15]]
grads:  [-0.15717354]
Stock Position:  -0.1571735404347766
Bond Position:  [4.62620284]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.87447424]
Stock Price:  98.62325544634959
PL:  [-10.87447424]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.24118069e-02]
 [-1.16479526e-02]
 [ 2.71735105e-03]
 [-6.92667001e-03]
 [ 1.43911375e-02]
 [-8.94159494e-03]
 [-9.75820818e-03]
 [ 3.00656003e-02]
 [-2.08130652e-02]
 [-1.24414198e-02]
 [ 1.18980652e-02]
 [-6.95805458e-03]
 [ 3.37364281e-03]
 [-7.08044646e-03]
 [ 7.92670308e-03]
 [ 1.03801115e-03]
 [-4.45686615e-02]
 [-8.97997500e-03]
 [ 2.29514648e-02]
 [-5.77442524e-03]
 [-3.48492785e-02]
 [ 6.33031297e-03]
 [ 1.71388691e-02]
 [-9.08201777e-05]
 [ 1.93050551e-02]
 [ 4.20777678e-03]
 [-7.22128684e-05]
 [ 2.12187248e-02]
 [-2.42741477e-02]
 [ 7.82573333e-02]
 [-5.96140118e-03]
 [ 3.01868337e-02]
 [ 1.41851780e-02]
 [-1.93231410e-02]
 [-1.53140841e-02]
 [-3.11973697e-02]
 [ 1.33286951e-02]
 [-5.34234397e-03]
 [ 4.78724048e-02]
 [ 1.48179173e-02]
 [ 6.75035510e-03]
 [ 3.56196878e-02]
 [-3.37652890e-03]
 [ 2.32447569e-02]
 [-5.82103771e-02]
 [ 2.21145016e-02]
 [ 9.50125089e-03]
 [ 5.35681517e-03]
 [-9.51114413e-03]
 [-4.06576239e-05]
 [-3.80537374e-03]
 [ 3.68030448e-04]
 [ 5.62959059e-04]
 [ 7.20785595e-03]
 [-9.69206613e-03]
 [-4.60728074e-03]
 [-8.89318943e-04]
 [ 1.25765100e-02]
 [ 7.90248463e-03]
 [-3.01434348e-03]
 [-5.11691078e-03]
 [-1.45153534e-03]
 [-5.58559997e-03]
 [-7.99365020e-04]
 [ 1.97559677e-02]
 [ 3.81449739e-03]
 [ 1.54259220e-02]
 [-2.91301069e-03]
 [ 6.33277477e-03]
 [ 2.49559091e-02]
 [ 3.31220397e-03]
 [-1.54653721e-02]
 [-5.83792757e-03]
 [ 1.60551983e-03]
 [ 9.31225323e-03]
 [ 1.18476539e-04]
 [-1.60953650e-03]
 [-1.28105196e-02]
 [-2.58154762e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.04880121]
curr_Stock_Price:  99.26973781710834
curr_Factors:  [99.26973782]
mat_Sqrt:  [[0.15]]
grads:  [-0.08274538]
Stock Position:  -0.08274537900822161
Bond Position:  [-5.83468913]


portfolio before change:  [-14.04565126]
curr_Stock_Price:  99.22726252243928
curr_Factors:  [99.22726252]
mat_Sqrt:  [[0.15]]
grads:  [-0.07765302]
Stock Position:  -0.07765301744066896
Bond Position:  [-6.34035491]


portfolio before change:  [-14.09849833]
curr_Stock_Price:  99.90271326144395
curr_Factors:  [99.90271326]
mat_Sqrt:  [[0.15]]
grads:  [0.01811567]
Stock Position:  0.018115673699628798
Bond Position:  [-15.90830329]


portfolio before change:  [-14.09597908]
curr_Stock_Price:  100.09666396728336
curr_Factors:  [100.09666397]
mat_Sqrt:  [[0.15]]
grads:  [-0.0461778]
Stock Position:  -0.04617780004249036
Bond Position:  [-9.47373535]


portfolio before change:  [-14.06972222]
curr_Stock_Price:  99.51523753130625
curr_Factors:  [99.51523753]
mat_Sqrt:  [[0.15]]
grads:  [0.09594092]
Stock Position:  0.09594091636920521
Bond Position:  [-23.6173053]


portfolio before change:  [-14.05093659]
curr_Stock_Price:  99.72642743565899
curr_Factors:  [99.72642744]
mat_Sqrt:  [[0.15]]
grads:  [-0.05961063]
Stock Position:  -0.059610632904214395
Bond Position:  [-8.10618113]


portfolio before change:  [-13.99959954]
curr_Stock_Price:  98.85672181781274
curr_Factors:  [98.85672182]
mat_Sqrt:  [[0.15]]
grads:  [-0.06505472]
Stock Position:  -0.06505472118127778
Bond Position:  [-7.56850307]


portfolio before change:  [-13.98013641]
curr_Stock_Price:  98.5502694047956
curr_Factors:  [98.5502694]
mat_Sqrt:  [[0.15]]
grads:  [0.20043734]
Stock Position:  0.20043733559580884
Bond Position:  [-33.73328983]


portfolio before change:  [-14.04236666]
curr_Stock_Price:  98.250316031542
curr_Factors:  [98.25031603]
mat_Sqrt:  [[0.15]]
grads:  [-0.13875377]
Stock Position:  -0.138753767893141
Bond Position:  [-0.40976512]


portfolio before change:  [-14.14002829]
curr_Stock_Price:  98.95397989849728
curr_Factors:  [98.9539799]
mat_Sqrt:  [[0.15]]
grads:  [-0.0829428]
Stock Position:  -0.08294279851445333
Bond Position:  [-5.93250827]


portfolio before change:  [-14.12904136]
curr_Stock_Price:  98.81704549110795
curr_Factors:  [98.81704549]
mat_Sqrt:  [[0.15]]
grads:  [0.07932043]
Stock Position:  0.07932043437160687
Bond Position:  [-21.96725233]


portfolio before change:  [-14.16875668]
curr_Stock_Price:  98.33366030897393
curr_Factors:  [98.33366031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04638703]
Stock Position:  -0.04638703052198179
Bond Position:  [-9.60735017]


portfolio before change:  [-14.15626663]
curr_Stock_Price:  98.05145814838909
curr_Factors:  [98.05145815]
mat_Sqrt:  [[0.15]]
grads:  [0.02249095]
Stock Position:  0.022490952048179344
Bond Position:  [-16.36153728]


portfolio before change:  [-14.1821045]
curr_Stock_Price:  96.94811478877646
curr_Factors:  [96.94811479]
mat_Sqrt:  [[0.15]]
grads:  [-0.04720298]
Stock Position:  -0.04720297639716658
Bond Position:  [-9.60586493]


portfolio before change:  [-14.16444127]
curr_Stock_Price:  96.56119817323234
curr_Factors:  [96.56119817]
mat_Sqrt:  [[0.15]]
grads:  [0.05284469]
Stock Position:  0.052844687169286766
Bond Position:  [-19.26718758]


portfolio before change:  [-14.1594334]
curr_Stock_Price:  96.67875220662324
curr_Factors:  [96.67875221]
mat_Sqrt:  [[0.15]]
grads:  [0.00692007]
Stock Position:  0.006920074353944257
Bond Position:  [-14.82845756]


portfolio before change:  [-14.16272466]
curr_Stock_Price:  96.3370722621626
curr_Factors:  [96.33707226]
mat_Sqrt:  [[0.15]]
grads:  [-0.29712441]
Stock Position:  -0.29712441011697044
Bond Position:  [14.46137111]


portfolio before change:  [-14.03690713]
curr_Stock_Price:  95.91666362697326
curr_Factors:  [95.91666363]
mat_Sqrt:  [[0.15]]
grads:  [-0.0598665]
Stock Position:  -0.05986650002048545
Bond Position:  [-8.29471219]


portfolio before change:  [-14.04722969]
curr_Stock_Price:  96.08043008830307
curr_Factors:  [96.08043009]
mat_Sqrt:  [[0.15]]
grads:  [0.15300977]
Stock Position:  0.1530097651331294
Bond Position:  [-28.74847373]


portfolio before change:  [-14.13335967]
curr_Stock_Price:  95.5292682643582
curr_Factors:  [95.52926826]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849617]
Stock Position:  -0.03849616828834785
Bond Position:  [-10.45584888]


portfolio before change:  [-14.11025029]
curr_Stock_Price:  94.91198881225671
curr_Factors:  [94.91198881]
mat_Sqrt:  [[0.15]]
grads:  [-0.23232852]
Stock Position:  -0.23232852344813576
Bond Position:  [7.94051193]


portfolio before change:  [-14.17150165]
curr_Stock_Price:  95.17776619052243
curr_Factors:  [95.17776619]
mat_Sqrt:  [[0.15]]
grads:  [0.04220209]
Stock Position:  0.04220208643893655
Bond Position:  [-18.18820197]


portfolio before change:  [-14.19660071]
curr_Stock_Price:  94.60996819008847
curr_Factors:  [94.60996819]
mat_Sqrt:  [[0.15]]
grads:  [0.11425913]
Stock Position:  0.11425912730125577
Bond Position:  [-25.00665311]


portfolio before change:  [-14.24524749]
curr_Stock_Price:  94.19788898202368
curr_Factors:  [94.19788898]
mat_Sqrt:  [[0.15]]
grads:  [-0.00060547]
Stock Position:  -0.0006054678512545699
Bond Position:  [-14.18821369]


portfolio before change:  [-14.24653271]
curr_Stock_Price:  94.8559466103277
curr_Factors:  [94.85594661]
mat_Sqrt:  [[0.15]]
grads:  [0.12870037]
Stock Position:  0.12870036754339131
Bond Position:  [-26.4545279]


portfolio before change:  [-14.24721227]
curr_Stock_Price:  94.8635137757932
curr_Factors:  [94.86351378]
mat_Sqrt:  [[0.15]]
grads:  [0.02805185]
Stock Position:  0.028051845186042763
Bond Position:  [-16.90830888]


portfolio before change:  [-14.25210246]
curr_Stock_Price:  94.72686032422097
curr_Factors:  [94.72686032]
mat_Sqrt:  [[0.15]]
grads:  [-0.00048142]
Stock Position:  -0.00048141912274839393
Bond Position:  [-14.20649914]


portfolio before change:  [-14.25320728]
curr_Stock_Price:  95.177387519433
curr_Factors:  [95.17738752]
mat_Sqrt:  [[0.15]]
grads:  [0.14145817]
Stock Position:  0.14145816539093967
Bond Position:  [-27.71682591]


portfolio before change:  [-14.21885415]
curr_Stock_Price:  95.43248409491449
curr_Factors:  [95.43248409]
mat_Sqrt:  [[0.15]]
grads:  [-0.16182765]
Stock Position:  -0.1618276513991991
Bond Position:  [1.22476062]


portfolio before change:  [-14.18215373]
curr_Stock_Price:  95.20617005773093
curr_Factors:  [95.20617006]
mat_Sqrt:  [[0.15]]
grads:  [0.52171556]
Stock Position:  0.5217155556648567
Bond Position:  [-63.85269364]


portfolio before change:  [-14.42374789]
curr_Stock_Price:  94.75074326614731
curr_Factors:  [94.75074327]
mat_Sqrt:  [[0.15]]
grads:  [-0.03974267]
Stock Position:  -0.039742674505012024
Bond Position:  [-10.65809994]


portfolio before change:  [-14.42270387]
curr_Stock_Price:  94.70771224067185
curr_Factors:  [94.70771224]
mat_Sqrt:  [[0.15]]
grads:  [0.20124556]
Stock Position:  0.20124555797616944
Bond Position:  [-33.48221027]


portfolio before change:  [-14.47890217]
curr_Stock_Price:  94.43885865107589
curr_Factors:  [94.43885865]
mat_Sqrt:  [[0.15]]
grads:  [0.09456785]
Stock Position:  0.09456785322699604
Bond Position:  [-23.40978229]


portfolio before change:  [-14.38424292]
curr_Stock_Price:  95.45529707983762
curr_Factors:  [95.45529708]
mat_Sqrt:  [[0.15]]
grads:  [-0.12882094]
Stock Position:  -0.1288209402369489
Bond Position:  [-2.0876018]


portfolio before change:  [-14.40090848]
curr_Stock_Price:  95.58365415396482
curr_Factors:  [95.58365415]
mat_Sqrt:  [[0.15]]
grads:  [-0.10209389]
Stock Position:  -0.10209389426283177
Bond Position:  [-4.642401]


portfolio before change:  [-14.42716261]
curr_Stock_Price:  95.83796879452967
curr_Factors:  [95.83796879]
mat_Sqrt:  [[0.15]]
grads:  [-0.20798246]
Stock Position:  -0.20798246466584447
Bond Position:  [5.50545435]


portfolio before change:  [-14.34101698]
curr_Stock_Price:  95.4254266592008
curr_Factors:  [95.42542666]
mat_Sqrt:  [[0.15]]
grads:  [0.08885797]
Stock Position:  0.08885796719211111
Bond Position:  [-22.82032641]


portfolio before change:  [-14.35651165]
curr_Stock_Price:  95.26710253868693
curr_Factors:  [95.26710254]
mat_Sqrt:  [[0.15]]
grads:  [-0.03561563]
Stock Position:  -0.03561562647385503
Bond Position:  [-10.96351411]


portfolio before change:  [-14.34762771]
curr_Stock_Price:  94.99842325959894
curr_Factors:  [94.99842326]
mat_Sqrt:  [[0.15]]
grads:  [0.31914937]
Stock Position:  0.31914936522820253
Bond Position:  [-44.6663142]


portfolio before change:  [-14.28910868]
curr_Stock_Price:  95.19053007924734
curr_Factors:  [95.19053008]
mat_Sqrt:  [[0.15]]
grads:  [0.09878612]
Stock Position:  0.09878611508504542
Bond Position:  [-23.69261134]


portfolio before change:  [-14.25302315]
curr_Stock_Price:  95.57080983610325
curr_Factors:  [95.57080984]
mat_Sqrt:  [[0.15]]
grads:  [0.04500237]
Stock Position:  0.04500236734428064
Bond Position:  [-18.55393584]


portfolio before change:  [-14.27166139]
curr_Stock_Price:  95.1824172858667
curr_Factors:  [95.18241729]
mat_Sqrt:  [[0.15]]
grads:  [0.23746459]
Stock Position:  0.23746458526962222
Bond Position:  [-36.87411464]


portfolio before change:  [-14.42286255]
curr_Stock_Price:  94.5553913447107
curr_Factors:  [94.55539134]
mat_Sqrt:  [[0.15]]
grads:  [-0.02251019]
Stock Position:  -0.022510192679421274
Bond Position:  [-12.29440247]


portfolio before change:  [-14.43386538]
curr_Stock_Price:  95.01004775705849
curr_Factors:  [95.01004776]
mat_Sqrt:  [[0.15]]
grads:  [0.15496505]
Stock Position:  0.15496504618159293
Bond Position:  [-29.15710182]


portfolio before change:  [-14.41723546]
curr_Stock_Price:  95.12912166521832
curr_Factors:  [95.12912167]
mat_Sqrt:  [[0.15]]
grads:  [-0.38806918]
Stock Position:  -0.3880691808169012
Bond Position:  [22.49944485]


portfolio before change:  [-14.64919855]
curr_Stock_Price:  95.73048183682702
curr_Factors:  [95.73048184]
mat_Sqrt:  [[0.15]]
grads:  [0.14743001]
Stock Position:  0.1474300105487384
Bond Position:  [-28.7627445]


portfolio before change:  [-14.58755149]
curr_Stock_Price:  96.160820194408
curr_Factors:  [96.16082019]
mat_Sqrt:  [[0.15]]
grads:  [0.06334167]
Stock Position:  0.06334167259662275
Bond Position:  [-20.67853868]


portfolio before change:  [-14.60490356]
curr_Stock_Price:  95.9072805625323
curr_Factors:  [95.90728056]
mat_Sqrt:  [[0.15]]
grads:  [0.0357121]
Stock Position:  0.035712101117714994
Bond Position:  [-18.02995407]


portfolio before change:  [-14.62607478]
curr_Stock_Price:  95.34600548797597
curr_Factors:  [95.34600549]
mat_Sqrt:  [[0.15]]
grads:  [-0.06340763]
Stock Position:  -0.06340762753157318
Bond Position:  [-8.58041078]


portfolio before change:  [-14.65973654]
curr_Stock_Price:  95.86842633259397
curr_Factors:  [95.86842633]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027105]
Stock Position:  -0.00027105082583835023
Bond Position:  [-14.63375133]


portfolio before change:  [-14.66085689]
curr_Stock_Price:  96.62737064695095
curr_Factors:  [96.62737065]
mat_Sqrt:  [[0.15]]
grads:  [-0.02536916]
Stock Position:  -0.025369158261290894
Bond Position:  [-12.20950183]


portfolio before change:  [-14.67184108]
curr_Stock_Price:  97.03026427862245
curr_Factors:  [97.03026428]
mat_Sqrt:  [[0.15]]
grads:  [0.00245354]
Stock Position:  0.0024535363170920255
Bond Position:  [-14.90990836]


portfolio before change:  [-14.67281533]
curr_Stock_Price:  97.01300454094786
curr_Factors:  [97.01300454]
mat_Sqrt:  [[0.15]]
grads:  [0.00375306]
Stock Position:  0.0037530603948104715
Bond Position:  [-15.03691099]


portfolio before change:  [-14.67340964]
curr_Stock_Price:  97.10506855990475
curr_Factors:  [97.10506856]
mat_Sqrt:  [[0.15]]
grads:  [0.04805237]
Stock Position:  0.04805237298770949
Bond Position:  [-19.33953862]


portfolio before change:  [-14.67269827]
curr_Stock_Price:  97.14502766402848
curr_Factors:  [97.14502766]
mat_Sqrt:  [[0.15]]
grads:  [-0.06461377]
Stock Position:  -0.06461377420039424
Bond Position:  [-8.39579139]


portfolio before change:  [-14.7172569]
curr_Stock_Price:  97.82652134035303
curr_Factors:  [97.82652134]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307152]
Stock Position:  -0.030715204909494555
Bond Position:  [-11.71249526]


portfolio before change:  [-14.70212194]
curr_Stock_Price:  97.30993634790624
curr_Factors:  [97.30993635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00592879]
Stock Position:  -0.005928792953364563
Bond Position:  [-14.12519148]


portfolio before change:  [-14.69988913]
curr_Stock_Price:  96.784422276859
curr_Factors:  [96.78442228]
mat_Sqrt:  [[0.15]]
grads:  [0.0838434]
Stock Position:  0.08384340000556618
Bond Position:  [-22.81462416]


portfolio before change:  [-14.68993333]
curr_Stock_Price:  96.92017251263269
curr_Factors:  [96.92017251]
mat_Sqrt:  [[0.15]]
grads:  [0.05268323]
Stock Position:  0.0526832308977144
Bond Position:  [-19.79600116]


portfolio before change:  [-14.72394115]
curr_Stock_Price:  96.2981429073247
curr_Factors:  [96.29814291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009562]
Stock Position:  -0.02009562322620627
Bond Position:  [-12.78876995]


portfolio before change:  [-14.71283295]
curr_Stock_Price:  95.70560010076305
curr_Factors:  [95.7056001]
mat_Sqrt:  [[0.15]]
grads:  [-0.03411274]
Stock Position:  -0.03411273852612866
Bond Position:  [-11.44805284]


portfolio before change:  [-14.74386891]
curr_Stock_Price:  96.59443023975508
curr_Factors:  [96.59443024]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096769]
Stock Position:  -0.009676902271376018
Bond Position:  [-13.80913405]


portfolio before change:  [-14.7580537]
curr_Stock_Price:  97.97107915727403
curr_Factors:  [97.97107916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03723733]
Stock Position:  -0.03723733310345918
Bond Position:  [-11.109872]


portfolio before change:  [-14.74125908]
curr_Stock_Price:  97.50141572239195
curr_Factors:  [97.50141572]
mat_Sqrt:  [[0.15]]
grads:  [-0.0053291]
Stock Position:  -0.005329100134668014
Bond Position:  [-14.22166427]


portfolio before change:  [-14.74521944]
curr_Stock_Price:  98.07777549512106
curr_Factors:  [98.0777755]
mat_Sqrt:  [[0.15]]
grads:  [0.13170645]
Stock Position:  0.13170645156685298
Bond Position:  [-27.66269523]


portfolio before change:  [-14.80763119]
curr_Stock_Price:  97.61703284777337
curr_Factors:  [97.61703285]
mat_Sqrt:  [[0.15]]
grads:  [0.02542998]
Stock Position:  0.0254299825833626
Bond Position:  [-17.29003064]


portfolio before change:  [-14.82816156]
curr_Stock_Price:  96.8521991777623
curr_Factors:  [96.85219918]
mat_Sqrt:  [[0.15]]
grads:  [0.10283948]
Stock Position:  0.10283947986036579
Bond Position:  [-24.78839135]


portfolio before change:  [-14.92437921]
curr_Stock_Price:  95.93165454819334
curr_Factors:  [95.93165455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01942007]
Stock Position:  -0.019420071268028513
Bond Position:  [-13.06137964]


portfolio before change:  [-14.92026437]
curr_Stock_Price:  95.67773134752058
curr_Factors:  [95.67773135]
mat_Sqrt:  [[0.15]]
grads:  [0.0422185]
Stock Position:  0.042218498440380725
Bond Position:  [-18.95963452]


portfolio before change:  [-14.90042587]
curr_Stock_Price:  96.17570053356691
curr_Factors:  [96.17570053]
mat_Sqrt:  [[0.15]]
grads:  [0.16637273]
Stock Position:  0.16637272702519118
Bond Position:  [-30.90143944]


portfolio before change:  [-14.85823937]
curr_Stock_Price:  96.44087563314086
curr_Factors:  [96.44087563]
mat_Sqrt:  [[0.15]]
grads:  [0.02208136]
Stock Position:  0.022081359783371245
Bond Position:  [-16.98778504]


portfolio before change:  [-14.85045393]
curr_Stock_Price:  96.84153949281462
curr_Factors:  [96.84153949]
mat_Sqrt:  [[0.15]]
grads:  [-0.10310248]
Stock Position:  -0.10310248092014522
Bond Position:  [-4.86585096]


portfolio before change:  [-14.8082337]
curr_Stock_Price:  96.42909199741811
curr_Factors:  [96.429092]
mat_Sqrt:  [[0.15]]
grads:  [-0.03891952]
Stock Position:  -0.03891951711946759
Bond Position:  [-11.05526]


portfolio before change:  [-14.83272819]
curr_Stock_Price:  97.04070081273434
curr_Factors:  [97.04070081]
mat_Sqrt:  [[0.15]]
grads:  [0.01070347]
Stock Position:  0.010703465522825497
Bond Position:  [-15.87139999]


portfolio before change:  [-14.83243957]
curr_Stock_Price:  97.16034571733242
curr_Factors:  [97.16034572]
mat_Sqrt:  [[0.15]]
grads:  [0.06208169]
Stock Position:  0.062081688182831975
Bond Position:  [-20.86431786]


portfolio before change:  [-14.77873425]
curr_Stock_Price:  98.04642634827648
curr_Factors:  [98.04642635]
mat_Sqrt:  [[0.15]]
grads:  [0.00078984]
Stock Position:  0.0007898435900607672
Bond Position:  [-14.85617559]


portfolio before change:  [-14.78046462]
curr_Stock_Price:  97.03124801283502
curr_Factors:  [97.03124801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073024]
Stock Position:  -0.010730243308391663
Bond Position:  [-13.73929572]


portfolio before change:  [-14.77417086]
curr_Stock_Price:  96.36467459469841
curr_Factors:  [96.36467459]
mat_Sqrt:  [[0.15]]
grads:  [-0.08540346]
Stock Position:  -0.08540346429438318
Bond Position:  [-6.54429382]


portfolio before change:  [-14.77139508]
curr_Stock_Price:  96.32738325690752
curr_Factors:  [96.32738326]
mat_Sqrt:  [[0.15]]
grads:  [-0.17210317]
Stock Position:  -0.17210317471841066
Bond Position:  [1.80685339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.77407281]
Stock Price:  96.34359831293395
PL:  [-14.77407281]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.88283069e-03]
 [-4.60130221e-03]
 [ 1.32444583e-02]
 [-8.75915495e-03]
 [ 1.10120312e-02]
 [-1.41693710e-02]
 [-1.21779374e-03]
 [ 1.54512324e-03]
 [-2.00428258e-02]
 [-1.33264203e-02]
 [ 6.77592118e-03]
 [-6.89694017e-03]
 [ 2.81991438e-03]
 [-1.16297542e-03]
 [-1.68983214e-03]
 [ 9.95215057e-03]
 [ 2.56205768e-02]
 [-1.51486371e-02]
 [ 2.02382696e-02]
 [ 2.48410615e-03]
 [-3.85152783e-03]
 [ 4.13223901e-03]
 [ 1.52282632e-02]
 [ 1.74749715e-02]
 [-4.22191689e-03]
 [ 5.53189192e-03]
 [-9.75623755e-03]
 [ 1.51405947e-02]
 [ 3.07574590e-02]
 [ 5.88773195e-04]
 [-3.01421278e-03]
 [ 1.35210931e-02]
 [ 1.23774437e-02]
 [ 4.30135957e-03]
 [ 6.02102367e-03]
 [ 1.59909274e-02]
 [-9.04748636e-03]
 [ 3.13724194e-03]
 [-5.73461075e-02]
 [-9.98957556e-03]
 [ 7.17235503e-03]
 [ 2.60004370e-02]
 [-3.27915681e-03]
 [ 1.59897028e-02]
 [-3.95906131e-02]
 [ 2.21886476e-02]
 [ 9.18058017e-03]
 [ 5.35620706e-03]
 [-7.95842274e-03]
 [-2.48527380e-04]
 [-3.53995750e-03]
 [-1.30088130e-03]
 [ 1.98467789e-04]
 [ 8.40123729e-03]
 [-1.23190674e-02]
 [-5.15838751e-03]
 [-3.87105263e-03]
 [ 1.37907120e-02]
 [ 6.34019896e-03]
 [-2.30673346e-03]
 [-5.14942869e-03]
 [-3.03075518e-03]
 [-4.50362882e-04]
 [-4.34642013e-03]
 [ 1.84683015e-02]
 [ 6.31786179e-03]
 [ 2.03318218e-02]
 [-4.61461486e-03]
 [ 7.18699970e-03]
 [ 2.78066861e-02]
 [ 3.10741752e-03]
 [-1.53260101e-02]
 [-5.60752560e-03]
 [ 1.13840153e-03]
 [ 6.48381191e-03]
 [ 2.35210905e-04]
 [-1.61085783e-03]
 [-8.14142381e-04]
 [-2.38093502e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.58004848]
curr_Stock_Price:  100.20665789589253
curr_Factors:  [100.2066579]
mat_Sqrt:  [[0.15]]
grads:  [-0.0325522]
Stock Position:  -0.032552204605721384
Bond Position:  [9.84199611]


portfolio before change:  [6.6052583]
curr_Stock_Price:  99.45111241688463
curr_Factors:  [99.45111242]
mat_Sqrt:  [[0.15]]
grads:  [-0.03067535]
Stock Position:  -0.030675348076991567
Bond Position:  [9.65595579]


portfolio before change:  [6.60955216]
curr_Stock_Price:  99.33080920861795
curr_Factors:  [99.33080921]
mat_Sqrt:  [[0.15]]
grads:  [0.08829639]
Stock Position:  0.08829638878420523
Bond Position:  [-2.16099959]


portfolio before change:  [6.61723008]
curr_Stock_Price:  99.41929513391976
curr_Factors:  [99.41929513]
mat_Sqrt:  [[0.15]]
grads:  [-0.05839437]
Stock Position:  -0.058394366356717284
Bond Position:  [12.42275682]


portfolio before change:  [6.71813374]
curr_Stock_Price:  97.70462254047445
curr_Factors:  [97.70462254]
mat_Sqrt:  [[0.15]]
grads:  [0.07341354]
Stock Position:  0.07341354139338577
Bond Position:  [-0.45470861]


portfolio before change:  [6.79324897]
curr_Stock_Price:  98.72818916506195
curr_Factors:  [98.72818917]
mat_Sqrt:  [[0.15]]
grads:  [-0.09446247]
Stock Position:  -0.09446247300297464
Bond Position:  [16.11935788]


portfolio before change:  [6.7349274]
curr_Stock_Price:  99.35625934202675
curr_Factors:  [99.35625934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00811862]
Stock Position:  -0.008118624908007346
Bond Position:  [7.54156361]


portfolio before change:  [6.73554247]
curr_Stock_Price:  99.33855895322594
curr_Factors:  [99.33855895]
mat_Sqrt:  [[0.15]]
grads:  [0.01030082]
Stock Position:  0.010300821600017659
Bond Position:  [5.7122737]


portfolio before change:  [6.72689221]
curr_Stock_Price:  98.46413494324693
curr_Factors:  [98.46413494]
mat_Sqrt:  [[0.15]]
grads:  [-0.13361884]
Stock Position:  -0.13361883886084547
Bond Position:  [19.88355559]


portfolio before change:  [6.81525242]
curr_Stock_Price:  97.81215019260046
curr_Factors:  [97.81215019]
mat_Sqrt:  [[0.15]]
grads:  [-0.0888428]
Stock Position:  -0.08884280185840376
Bond Position:  [15.5051579]


portfolio before change:  [6.82635644]
curr_Stock_Price:  97.6980732295448
curr_Factors:  [97.69807323]
mat_Sqrt:  [[0.15]]
grads:  [0.04517281]
Stock Position:  0.04517280783549562
Bond Position:  [2.41306015]


portfolio before change:  [6.81424898]
curr_Stock_Price:  97.42670918632444
curr_Factors:  [97.42670919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0459796]
Stock Position:  -0.045979601156377926
Bond Position:  [11.29389021]


portfolio before change:  [6.78092674]
curr_Stock_Price:  98.16677936083249
curr_Factors:  [98.16677936]
mat_Sqrt:  [[0.15]]
grads:  [0.01879943]
Stock Position:  0.018799429184595692
Bond Position:  [4.93544733]


portfolio before change:  [6.7837149]
curr_Stock_Price:  98.29868154592799
curr_Factors:  [98.29868155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00775317]
Stock Position:  -0.007753169480571445
Bond Position:  [7.54584124]


portfolio before change:  [6.77783021]
curr_Stock_Price:  99.11851692238216
curr_Factors:  [99.11851692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01126555]
Stock Position:  -0.011265547579921513
Bond Position:  [7.89445458]


portfolio before change:  [6.77953214]
curr_Stock_Price:  99.01124177757514
curr_Factors:  [99.01124178]
mat_Sqrt:  [[0.15]]
grads:  [0.06634767]
Stock Position:  0.0663476704592316
Bond Position:  [0.2103669]


portfolio before change:  [6.8118607]
curr_Stock_Price:  99.49830348941451
curr_Factors:  [99.49830349]
mat_Sqrt:  [[0.15]]
grads:  [0.17080385]
Stock Position:  0.17080384524625652
Bond Position:  [-10.18283213]


portfolio before change:  [6.83251954]
curr_Stock_Price:  99.6229803215933
curr_Factors:  [99.62298032]
mat_Sqrt:  [[0.15]]
grads:  [-0.10099091]
Stock Position:  -0.1009909140330753
Bond Position:  [16.89353538]


portfolio before change:  [6.8121486]
curr_Stock_Price:  99.83514611478101
curr_Factors:  [99.83514611]
mat_Sqrt:  [[0.15]]
grads:  [0.1349218]
Stock Position:  0.13492179713501368
Bond Position:  [-6.65778873]


portfolio before change:  [6.87834506]
curr_Stock_Price:  100.32885866592781
curr_Factors:  [100.32885867]
mat_Sqrt:  [[0.15]]
grads:  [0.01656071]
Stock Position:  0.016560707639590423
Bond Position:  [5.21682816]


portfolio before change:  [6.8896467]
curr_Stock_Price:  100.99160718712783
curr_Factors:  [100.99160719]
mat_Sqrt:  [[0.15]]
grads:  [-0.02567685]
Stock Position:  -0.025676852172250037
Bond Position:  [9.48279327]


portfolio before change:  [6.91154818]
curr_Stock_Price:  100.161724064925
curr_Factors:  [100.16172406]
mat_Sqrt:  [[0.15]]
grads:  [0.02754826]
Stock Position:  0.02754826004635012
Bond Position:  [4.15226696]


portfolio before change:  [6.90970478]
curr_Stock_Price:  100.08538782994603
curr_Factors:  [100.08538783]
mat_Sqrt:  [[0.15]]
grads:  [0.10152175]
Stock Position:  0.10152175439798719
Bond Position:  [-3.25113938]


portfolio before change:  [6.94692232]
curr_Stock_Price:  100.45398608651793
curr_Factors:  [100.45398609]
mat_Sqrt:  [[0.15]]
grads:  [0.11649981]
Stock Position:  0.11649980988895281
Bond Position:  [-4.75594797]


portfolio before change:  [6.92693909]
curr_Stock_Price:  100.28500750498429
curr_Factors:  [100.2850075]
mat_Sqrt:  [[0.15]]
grads:  [-0.02814611]
Stock Position:  -0.02814611257481144
Bond Position:  [9.7495722]


portfolio before change:  [6.92336655]
curr_Stock_Price:  100.43358609806637
curr_Factors:  [100.4335861]
mat_Sqrt:  [[0.15]]
grads:  [0.03687928]
Stock Position:  0.03687927943631951
Bond Position:  [3.21944826]


portfolio before change:  [6.94959276]
curr_Stock_Price:  101.13926662550281
curr_Factors:  [101.13926663]
mat_Sqrt:  [[0.15]]
grads:  [-0.06504158]
Stock Position:  -0.06504158363339783
Bond Position:  [13.52785083]


portfolio before change:  [6.90182486]
curr_Stock_Price:  101.8866871995422
curr_Factors:  [101.8866872]
mat_Sqrt:  [[0.15]]
grads:  [0.1009373]
Stock Position:  0.10093729774254231
Bond Position:  [-3.38234203]


portfolio before change:  [6.882916]
curr_Stock_Price:  101.70144886951996
curr_Factors:  [101.70144887]
mat_Sqrt:  [[0.15]]
grads:  [0.20504973]
Stock Position:  0.20504972677932692
Bond Position:  [-13.97093831]


portfolio before change:  [6.81673738]
curr_Stock_Price:  101.38296314868663
curr_Factors:  [101.38296315]
mat_Sqrt:  [[0.15]]
grads:  [0.00392515]
Stock Position:  0.003925154630279662
Bond Position:  [6.41879357]


portfolio before change:  [6.81883496]
curr_Stock_Price:  101.81514839927574
curr_Factors:  [101.8151484]
mat_Sqrt:  [[0.15]]
grads:  [-0.02009475]
Stock Position:  -0.020094751871850607
Bond Position:  [8.8647851]


portfolio before change:  [6.81598957]
curr_Stock_Price:  101.98431966711594
curr_Factors:  [101.98431967]
mat_Sqrt:  [[0.15]]
grads:  [0.09014062]
Stock Position:  0.09014062059837169
Bond Position:  [-2.3769403]


portfolio before change:  [6.68054355]
curr_Stock_Price:  100.4833597413184
curr_Factors:  [100.48335974]
mat_Sqrt:  [[0.15]]
grads:  [0.08251629]
Stock Position:  0.0825162914213768
Bond Position:  [-1.61097065]


portfolio before change:  [6.67873704]
curr_Stock_Price:  100.46268729683574
curr_Factors:  [100.4626873]
mat_Sqrt:  [[0.15]]
grads:  [0.02867573]
Stock Position:  0.028675730492860714
Bond Position:  [3.7978961]


portfolio before change:  [6.67516388]
curr_Stock_Price:  100.32980343877061
curr_Factors:  [100.32980344]
mat_Sqrt:  [[0.15]]
grads:  [0.04014016]
Stock Position:  0.04014015778231058
Bond Position:  [2.64790974]


portfolio before change:  [6.65274498]
curr_Stock_Price:  99.7671650489878
curr_Factors:  [99.76716505]
mat_Sqrt:  [[0.15]]
grads:  [0.10660618]
Stock Position:  0.10660618293128836
Bond Position:  [-3.98305166]


portfolio before change:  [6.64063221]
curr_Stock_Price:  99.65587863286515
curr_Factors:  [99.65587863]
mat_Sqrt:  [[0.15]]
grads:  [-0.06031658]
Stock Position:  -0.06031657571351876
Bond Position:  [12.65153356]


portfolio before change:  [6.64539531]
curr_Stock_Price:  99.59002028403519
curr_Factors:  [99.59002028]
mat_Sqrt:  [[0.15]]
grads:  [0.02091495]
Stock Position:  0.020914946279105857
Bond Position:  [4.56247539]


portfolio before change:  [6.65121987]
curr_Stock_Price:  99.85487392975777
curr_Factors:  [99.85487393]
mat_Sqrt:  [[0.15]]
grads:  [-0.38230738]
Stock Position:  -0.38230738343404164
Bond Position:  [44.82647545]


portfolio before change:  [6.72887098]
curr_Stock_Price:  99.65909072164266
curr_Factors:  [99.65909072]
mat_Sqrt:  [[0.15]]
grads:  [-0.06659717]
Stock Position:  -0.06659717037557092
Bond Position:  [13.36588443]


portfolio before change:  [6.79018548]
curr_Stock_Price:  98.75095754416039
curr_Factors:  [98.75095754]
mat_Sqrt:  [[0.15]]
grads:  [0.0478157]
Stock Position:  0.04781570020753472
Bond Position:  [2.06833929]


portfolio before change:  [6.76166609]
curr_Stock_Price:  98.15180990672111
curr_Factors:  [98.15180991]
mat_Sqrt:  [[0.15]]
grads:  [0.17333625]
Stock Position:  0.1733362469764933
Bond Position:  [-10.25160028]


portfolio before change:  [6.58048577]
curr_Stock_Price:  97.11025295428783
curr_Factors:  [97.11025295]
mat_Sqrt:  [[0.15]]
grads:  [-0.02186105]
Stock Position:  -0.021861045408979003
Bond Position:  [8.70341742]


portfolio before change:  [6.60760315]
curr_Stock_Price:  95.8946935888669
curr_Factors:  [95.89469359]
mat_Sqrt:  [[0.15]]
grads:  [0.10659802]
Stock Position:  0.10659801895447879
Bond Position:  [-3.61458122]


portfolio before change:  [6.63470305]
curr_Stock_Price:  96.15103816649527
curr_Factors:  [96.15103817]
mat_Sqrt:  [[0.15]]
grads:  [-0.26393742]
Stock Position:  -0.2639374206670425
Bond Position:  [32.01256006]


portfolio before change:  [6.75541893]
curr_Stock_Price:  95.70125341154541
curr_Factors:  [95.70125341]
mat_Sqrt:  [[0.15]]
grads:  [0.14792432]
Stock Position:  0.1479243175697202
Bond Position:  [-7.40112367]


portfolio before change:  [6.71355001]
curr_Stock_Price:  95.42133774590918
curr_Factors:  [95.42133775]
mat_Sqrt:  [[0.15]]
grads:  [0.06120387]
Stock Position:  0.061203867815978995
Bond Position:  [0.87339507]


portfolio before change:  [6.74423305]
curr_Stock_Price:  95.92177094727992
curr_Factors:  [95.92177095]
mat_Sqrt:  [[0.15]]
grads:  [0.03570805]
Stock Position:  0.035708047051118685
Bond Position:  [3.31905394]


portfolio before change:  [6.7737204]
curr_Stock_Price:  96.74175157268122
curr_Factors:  [96.74175157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05305615]
Stock Position:  -0.053056151587251535
Bond Position:  [11.90646544]


portfolio before change:  [6.77746537]
curr_Stock_Price:  96.68519273172207
curr_Factors:  [96.68519273]
mat_Sqrt:  [[0.15]]
grads:  [-0.00165685]
Stock Position:  -0.0016568491978012048
Bond Position:  [6.93765816]


portfolio before change:  [6.77843195]
curr_Stock_Price:  96.36352501310736
curr_Factors:  [96.36352501]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359972]
Stock Position:  -0.023599716678126964
Bond Position:  [9.05258383]


portfolio before change:  [6.78043598]
curr_Stock_Price:  96.3025825018909
curr_Factors:  [96.3025825]
mat_Sqrt:  [[0.15]]
grads:  [-0.00867254]
Stock Position:  -0.008672541985741324
Bond Position:  [7.61562417]


portfolio before change:  [6.77953785]
curr_Stock_Price:  96.46102759220305
curr_Factors:  [96.46102759]
mat_Sqrt:  [[0.15]]
grads:  [0.00132312]
Stock Position:  0.0013231185903111637
Bond Position:  [6.65190847]


portfolio before change:  [6.77975867]
curr_Stock_Price:  96.3136962958409
curr_Factors:  [96.3136963]
mat_Sqrt:  [[0.15]]
grads:  [0.05600825]
Stock Position:  0.056008248579935416
Bond Position:  [1.38539722]


portfolio before change:  [6.74998772]
curr_Stock_Price:  95.78060445552882
curr_Factors:  [95.78060446]
mat_Sqrt:  [[0.15]]
grads:  [-0.08212712]
Stock Position:  -0.08212711574726496
Bond Position:  [14.6161725]


portfolio before change:  [6.77778481]
curr_Stock_Price:  95.45326368349276
curr_Factors:  [95.45326368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03438925]
Stock Position:  -0.0343892500998651
Bond Position:  [10.06035097]


portfolio before change:  [6.80025718]
curr_Stock_Price:  94.81807729592711
curr_Factors:  [94.8180773]
mat_Sqrt:  [[0.15]]
grads:  [-0.02580702]
Stock Position:  -0.025807017544439037
Bond Position:  [9.24722897]


portfolio before change:  [6.80242984]
curr_Stock_Price:  94.75628436765221
curr_Factors:  [94.75628437]
mat_Sqrt:  [[0.15]]
grads:  [0.09193808]
Stock Position:  0.09193808011499
Bond Position:  [-1.90928102]


portfolio before change:  [6.78714709]
curr_Stock_Price:  94.59135357642482
curr_Factors:  [94.59135358]
mat_Sqrt:  [[0.15]]
grads:  [0.04226799]
Stock Position:  0.04226799308019147
Bond Position:  [2.78896041]


portfolio before change:  [6.77583454]
curr_Stock_Price:  94.31959078399682
curr_Factors:  [94.31959078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537822]
Stock Position:  -0.015378223084741016
Bond Position:  [8.22630225]


portfolio before change:  [6.77913457]
curr_Stock_Price:  94.13843361032261
curr_Factors:  [94.13843361]
mat_Sqrt:  [[0.15]]
grads:  [-0.03432952]
Stock Position:  -0.03432952457039664
Bond Position:  [10.01086224]


portfolio before change:  [6.75682264]
curr_Stock_Price:  94.80659400123122
curr_Factors:  [94.806594]
mat_Sqrt:  [[0.15]]
grads:  [-0.02020503]
Stock Position:  -0.020205034508982308
Bond Position:  [8.67239315]


portfolio before change:  [6.75521651]
curr_Stock_Price:  94.91291276810546
curr_Factors:  [94.91291277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00300242]
Stock Position:  -0.0030024192116971083
Bond Position:  [7.04018486]


portfolio before change:  [6.75418192]
curr_Stock_Price:  95.40405625928106
curr_Factors:  [95.40405626]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897613]
Stock Position:  -0.028976134179729912
Bond Position:  [9.51862265]


portfolio before change:  [6.74398016]
curr_Stock_Price:  95.77666258719542
curr_Factors:  [95.77666259]
mat_Sqrt:  [[0.15]]
grads:  [0.12312201]
Stock Position:  0.12312200983684636
Bond Position:  [-5.04823503]


portfolio before change:  [6.7083042]
curr_Stock_Price:  95.48946430077417
curr_Factors:  [95.4894643]
mat_Sqrt:  [[0.15]]
grads:  [0.04211908]
Stock Position:  0.042119078632120395
Bond Position:  [2.68637595]


portfolio before change:  [6.68495943]
curr_Stock_Price:  94.931221476177
curr_Factors:  [94.93122148]
mat_Sqrt:  [[0.15]]
grads:  [0.13554548]
Stock Position:  0.13554547845758705
Bond Position:  [-6.1825384]


portfolio before change:  [6.6148435]
curr_Stock_Price:  94.41678517263747
curr_Factors:  [94.41678517]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307641]
Stock Position:  -0.03076409905214767
Bond Position:  [9.51949083]


portfolio before change:  [6.5953988]
curr_Stock_Price:  95.06818366208886
curr_Factors:  [95.06818366]
mat_Sqrt:  [[0.15]]
grads:  [0.04791333]
Stock Position:  0.047913331331044466
Bond Position:  [2.04036541]


portfolio before change:  [6.58621509]
curr_Stock_Price:  94.87384881970341
curr_Factors:  [94.87384882]
mat_Sqrt:  [[0.15]]
grads:  [0.18537791]
Stock Position:  0.18537790723215863
Bond Position:  [-11.00130045]


portfolio before change:  [6.65487328]
curr_Stock_Price:  95.24792674847848
curr_Factors:  [95.24792675]
mat_Sqrt:  [[0.15]]
grads:  [0.02071612]
Stock Position:  0.020716116777839046
Bond Position:  [4.6817061]


portfolio before change:  [6.66629626]
curr_Stock_Price:  95.78520724806835
curr_Factors:  [95.78520725]
mat_Sqrt:  [[0.15]]
grads:  [-0.1021734]
Stock Position:  -0.10217340042161223
Bond Position:  [16.45299659]


portfolio before change:  [6.55245933]
curr_Stock_Price:  96.90942616308347
curr_Factors:  [96.90942616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373835]
Stock Position:  -0.03738350399717319
Bond Position:  [10.17527325]


portfolio before change:  [6.51373066]
curr_Stock_Price:  97.96242116765957
curr_Factors:  [97.96242117]
mat_Sqrt:  [[0.15]]
grads:  [0.00758934]
Stock Position:  0.007589343543342806
Bond Position:  [5.7702602]


portfolio before change:  [6.51660145]
curr_Stock_Price:  98.29316570539422
curr_Factors:  [98.29316571]
mat_Sqrt:  [[0.15]]
grads:  [0.04322541]
Stock Position:  0.043225412761797886
Bond Position:  [2.26783879]


portfolio before change:  [6.50261216]
curr_Stock_Price:  97.96625079510257
curr_Factors:  [97.9662508]
mat_Sqrt:  [[0.15]]
grads:  [0.00156807]
Stock Position:  0.001568072703091288
Bond Position:  [6.34899396]


portfolio before change:  [6.50182237]
curr_Stock_Price:  97.20951534246318
curr_Factors:  [97.20951534]
mat_Sqrt:  [[0.15]]
grads:  [-0.01073905]
Stock Position:  -0.01073905221285298
Bond Position:  [7.54576043]


portfolio before change:  [6.48969426]
curr_Stock_Price:  98.38277863070626
curr_Factors:  [98.38277863]
mat_Sqrt:  [[0.15]]
grads:  [-0.00542762]
Stock Position:  -0.0054276158707325765
Bond Position:  [7.02367819]


portfolio before change:  [6.48901603]
curr_Stock_Price:  98.58862005989245
curr_Factors:  [98.58862006]
mat_Sqrt:  [[0.15]]
grads:  [-0.158729]
Stock Position:  -0.15872900162977438
Bond Position:  [22.13788926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.59238937]
Stock Price:  97.94608036730808
PL:  [6.59238937]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-6.53484626e-03]
 [ 3.35563177e-02]
 [ 1.92324724e-02]
 [-7.66705523e-03]
 [ 1.13134629e-02]
 [-1.32387809e-03]
 [-5.04420276e-03]
 [-3.26009525e-02]
 [ 1.07006371e-02]
 [-5.26362301e-03]
 [-9.92626938e-03]
 [ 1.94400089e-02]
 [-4.64001228e-03]
 [ 4.19705116e-03]
 [ 7.35491327e-04]
 [ 1.52704471e-02]
 [ 5.27709035e-02]
 [-1.46968145e-02]
 [ 1.98056352e-02]
 [ 2.12042568e-03]
 [-4.37005176e-03]
 [ 4.27574425e-03]
 [ 1.51850590e-02]
 [ 1.73300009e-02]
 [-4.86475909e-03]
 [ 4.75198195e-03]
 [-1.53572052e-03]
 [ 5.37243687e-03]
 [ 2.71239015e-02]
 [ 3.98639601e-03]
 [-7.26332900e-03]
 [ 8.49819023e-03]
 [ 1.23846329e-02]
 [ 9.37836998e-03]
 [ 5.26438355e-03]
 [ 1.32938673e-02]
 [-2.78555868e-02]
 [ 3.11154299e-03]
 [-5.69575487e-02]
 [-1.49391070e-02]
 [ 7.17640526e-03]
 [ 1.00974820e-02]
 [-2.54345504e-03]
 [ 2.24197087e-03]
 [ 4.45479965e-03]
 [ 1.53589614e-02]
 [ 1.08884876e-02]
 [ 4.21809693e-03]
 [ 5.54396383e-03]
 [-2.27159568e-03]
 [-1.98478351e-03]
 [-1.12680614e-02]
 [ 2.25026899e-03]
 [ 2.90700000e-03]
 [-3.74614138e-03]
 [-3.37968125e-03]
 [ 1.07130397e-02]
 [-1.13008905e-02]
 [ 5.70670310e-03]
 [-3.87303868e-03]
 [-2.89419294e-03]
 [ 5.81669731e-03]
 [-1.97559063e-02]
 [ 9.35235605e-04]
 [ 2.03857065e-02]
 [ 6.25897696e-03]
 [ 1.50237351e-02]
 [ 4.53218771e-03]
 [ 4.97302922e-03]
 [ 1.83837775e-02]
 [ 6.78650065e-04]
 [-1.53067892e-02]
 [-2.19304269e-03]
 [ 1.20232673e-03]
 [ 2.30259941e-03]
 [-1.50210801e-02]
 [-3.83498422e-03]
 [ 1.43158410e-02]
 [-3.80253516e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.70618802]
curr_Stock_Price:  100.93907410665936
curr_Factors:  [100.93907411]
mat_Sqrt:  [[0.15]]
grads:  [-0.04356564]
Stock Position:  -0.04356564175512309
Bond Position:  [27.10366356]


portfolio before change:  [22.71371139]
curr_Stock_Price:  100.80526835131444
curr_Factors:  [100.80526835]
mat_Sqrt:  [[0.15]]
grads:  [0.22370878]
Stock Position:  0.22370878480844514
Bond Position:  [0.1626873]


portfolio before change:  [22.80379254]
curr_Stock_Price:  101.20789440592803
curr_Factors:  [101.20789441]
mat_Sqrt:  [[0.15]]
grads:  [0.12821648]
Stock Position:  0.1282164829624105
Bond Position:  [9.82727227]


portfolio before change:  [22.68656593]
curr_Stock_Price:  100.28881729511244
curr_Factors:  [100.2888173]
mat_Sqrt:  [[0.15]]
grads:  [-0.0511137]
Stock Position:  -0.051113701564517125
Bond Position:  [27.81269861]


portfolio before change:  [22.68925764]
curr_Stock_Price:  100.27016547788179
curr_Factors:  [100.27016548]
mat_Sqrt:  [[0.15]]
grads:  [0.07542309]
Stock Position:  0.07542308596752784
Bond Position:  [15.12657233]


portfolio before change:  [22.73794662]
curr_Stock_Price:  100.90317505699159
curr_Factors:  [100.90317506]
mat_Sqrt:  [[0.15]]
grads:  [-0.00882585]
Stock Position:  -0.008825853911818705
Bond Position:  [23.6285033]


portfolio before change:  [22.73575867]
curr_Stock_Price:  101.31840668196908
curr_Factors:  [101.31840668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03362802]
Stock Position:  -0.0336280183973797
Bond Position:  [26.14289592]


portfolio before change:  [22.7388024]
curr_Stock_Price:  101.27648480716485
curr_Factors:  [101.27648481]
mat_Sqrt:  [[0.15]]
grads:  [-0.21733968]
Stock Position:  -0.2173396831264048
Bond Position:  [44.75020152]


portfolio before change:  [22.77563589]
curr_Stock_Price:  101.11987964752163
curr_Factors:  [101.11987965]
mat_Sqrt:  [[0.15]]
grads:  [0.07133758]
Stock Position:  0.07133758070278043
Bond Position:  [15.56198832]


portfolio before change:  [22.81251846]
curr_Stock_Price:  101.6232595908664
curr_Factors:  [101.62325959]
mat_Sqrt:  [[0.15]]
grads:  [-0.03509082]
Stock Position:  -0.035090820070432405
Bond Position:  [26.37856197]


portfolio before change:  [22.80352715]
curr_Stock_Price:  101.92647320489338
curr_Factors:  [101.9264732]
mat_Sqrt:  [[0.15]]
grads:  [-0.06617513]
Stock Position:  -0.06617512921903038
Bond Position:  [29.54852469]


portfolio before change:  [22.76804447]
curr_Stock_Price:  102.49057516977494
curr_Factors:  [102.49057517]
mat_Sqrt:  [[0.15]]
grads:  [0.12960006]
Stock Position:  0.12960005927286353
Bond Position:  [9.48525986]


portfolio before change:  [22.8050036]
curr_Stock_Price:  102.77117904622037
curr_Factors:  [102.77117905]
mat_Sqrt:  [[0.15]]
grads:  [-0.03093342]
Stock Position:  -0.030933415176377044
Bond Position:  [25.98406715]


portfolio before change:  [22.83958475]
curr_Stock_Price:  101.70575857602363
curr_Factors:  [101.70575858]
mat_Sqrt:  [[0.15]]
grads:  [0.02798034]
Stock Position:  0.02798034107993095
Bond Position:  [19.99382293]


portfolio before change:  [22.8275914]
curr_Stock_Price:  101.23246177545097
curr_Factors:  [101.23246178]
mat_Sqrt:  [[0.15]]
grads:  [0.00490328]
Stock Position:  0.004903275513302314
Bond Position:  [22.33122074]


portfolio before change:  [22.82965754]
curr_Stock_Price:  101.36918592446604
curr_Factors:  [101.36918592]
mat_Sqrt:  [[0.15]]
grads:  [0.10180298]
Stock Position:  0.10180298054831001
Bond Position:  [12.50997227]


portfolio before change:  [22.78299798]
curr_Stock_Price:  100.90317353466521
curr_Factors:  [100.90317353]
mat_Sqrt:  [[0.15]]
grads:  [0.35180602]
Stock Position:  0.3518060232902206
Bond Position:  [-12.71534623]


portfolio before change:  [22.58939021]
curr_Stock_Price:  100.35510720179396
curr_Factors:  [100.3551072]
mat_Sqrt:  [[0.15]]
grads:  [-0.09797876]
Stock Position:  -0.09797876347706334
Bond Position:  [32.42205952]


portfolio before change:  [22.61581283]
curr_Stock_Price:  100.10611267089679
curr_Factors:  [100.10611267]
mat_Sqrt:  [[0.15]]
grads:  [0.13203757]
Stock Position:  0.13203756818538315
Bond Position:  [9.39804515]


portfolio before change:  [22.69266211]
curr_Stock_Price:  100.68368978715702
curr_Factors:  [100.68368979]
mat_Sqrt:  [[0.15]]
grads:  [0.01413617]
Stock Position:  0.01413617118373481
Bond Position:  [21.26938023]


portfolio before change:  [22.69140227]
curr_Stock_Price:  100.50052748295228
curr_Factors:  [100.50052748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02913368]
Stock Position:  -0.02913367840104831
Bond Position:  [25.61935232]


portfolio before change:  [22.6875103]
curr_Stock_Price:  100.68908001338283
curr_Factors:  [100.68908001]
mat_Sqrt:  [[0.15]]
grads:  [0.02850496]
Stock Position:  0.028504961674846622
Bond Position:  [19.81737193]


portfolio before change:  [22.67985132]
curr_Stock_Price:  100.37693767483003
curr_Factors:  [100.37693767]
mat_Sqrt:  [[0.15]]
grads:  [0.10123373]
Stock Position:  0.10123372690379814
Bond Position:  [12.51831982]


portfolio before change:  [22.64638843]
curr_Stock_Price:  100.03865801825366
curr_Factors:  [100.03865802]
mat_Sqrt:  [[0.15]]
grads:  [0.11553334]
Stock Position:  0.11553333959749423
Bond Position:  [11.08858818]


portfolio before change:  [22.64876019]
curr_Stock_Price:  100.05318808567867
curr_Factors:  [100.05318809]
mat_Sqrt:  [[0.15]]
grads:  [-0.03243173]
Stock Position:  -0.032431727263447355
Bond Position:  [25.8936579]


portfolio before change:  [22.64922025]
curr_Stock_Price:  100.08890450837386
curr_Factors:  [100.08890451]
mat_Sqrt:  [[0.15]]
grads:  [0.03167988]
Stock Position:  0.03167987967917618
Bond Position:  [19.4784158]


portfolio before change:  [22.65540597]
curr_Stock_Price:  100.24573200188628
curr_Factors:  [100.245732]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023814]
Stock Position:  -0.010238136767903052
Bond Position:  [23.68173548]


portfolio before change:  [22.653858]
curr_Stock_Price:  100.54150090950232
curr_Factors:  [100.54150091]
mat_Sqrt:  [[0.15]]
grads:  [0.03581625]
Stock Position:  0.035816245775463634
Bond Position:  [19.05283889]


portfolio before change:  [22.6436172]
curr_Stock_Price:  100.22232615645785
curr_Factors:  [100.22232616]
mat_Sqrt:  [[0.15]]
grads:  [0.18082601]
Stock Position:  0.18082600996179976
Bond Position:  [4.52081385]


portfolio before change:  [22.70432272]
curr_Stock_Price:  100.55647589672239
curr_Factors:  [100.5564759]
mat_Sqrt:  [[0.15]]
grads:  [0.02657597]
Stock Position:  0.026575973415485316
Bond Position:  [20.03193649]


portfolio before change:  [22.6861009]
curr_Stock_Price:  99.82371422062597
curr_Factors:  [99.82371422]
mat_Sqrt:  [[0.15]]
grads:  [-0.04842219]
Stock Position:  -0.048422193352370295
Bond Position:  [27.51978409]


portfolio before change:  [22.67783349]
curr_Stock_Price:  100.02997188080147
curr_Factors:  [100.02997188]
mat_Sqrt:  [[0.15]]
grads:  [0.0566546]
Stock Position:  0.056654601559619905
Bond Position:  [17.01067529]


portfolio before change:  [22.70556197]
curr_Stock_Price:  100.50063572151562
curr_Factors:  [100.50063572]
mat_Sqrt:  [[0.15]]
grads:  [0.08256422]
Stock Position:  0.0825642191093763
Bond Position:  [14.40780546]


portfolio before change:  [22.72853168]
curr_Stock_Price:  100.76793311435009
curr_Factors:  [100.76793311]
mat_Sqrt:  [[0.15]]
grads:  [0.06252247]
Stock Position:  0.06252246653171284
Bond Position:  [16.42827196]


portfolio before change:  [22.73479998]
curr_Stock_Price:  100.85176685942997
curr_Factors:  [100.85176686]
mat_Sqrt:  [[0.15]]
grads:  [0.03509589]
Stock Position:  0.03509589034932851
Bond Position:  [19.19531742]


portfolio before change:  [22.70925289]
curr_Stock_Price:  100.08965965567035
curr_Factors:  [100.08965966]
mat_Sqrt:  [[0.15]]
grads:  [0.08862578]
Stock Position:  0.08862578186386016
Bond Position:  [13.83872855]


portfolio before change:  [22.81315739]
curr_Stock_Price:  101.25229597501804
curr_Factors:  [101.25229598]
mat_Sqrt:  [[0.15]]
grads:  [-0.18570391]
Stock Position:  -0.1857039117799228
Bond Position:  [41.61610483]


portfolio before change:  [22.8471254]
curr_Stock_Price:  101.08338771221622
curr_Factors:  [101.08338771]
mat_Sqrt:  [[0.15]]
grads:  [0.02074362]
Stock Position:  0.020743619910316622
Bond Position:  [20.75029003]


portfolio before change:  [22.82805048]
curr_Stock_Price:  100.10130943340266
curr_Factors:  [100.10130943]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971699]
Stock Position:  -0.3797169910580181
Bond Position:  [60.8382185]


portfolio before change:  [23.31842885]
curr_Stock_Price:  98.81989229356883
curr_Factors:  [98.81989229]
mat_Sqrt:  [[0.15]]
grads:  [-0.09959405]
Stock Position:  -0.09959404642511369
Bond Position:  [33.16030179]


portfolio before change:  [23.31822518]
curr_Stock_Price:  98.84274757039279
curr_Factors:  [98.84274757]
mat_Sqrt:  [[0.15]]
grads:  [0.0478427]
Stock Position:  0.0478427017236007
Bond Position:  [18.58932109]


portfolio before change:  [23.3312231]
curr_Stock_Price:  99.09014263226199
curr_Factors:  [99.09014263]
mat_Sqrt:  [[0.15]]
grads:  [0.06731655]
Stock Position:  0.0673165464043164
Bond Position:  [16.66081691]


portfolio before change:  [23.29640018]
curr_Stock_Price:  98.55737244057737
curr_Factors:  [98.55737244]
mat_Sqrt:  [[0.15]]
grads:  [-0.01695637]
Stock Position:  -0.016956366903035907
Bond Position:  [24.96757515]


portfolio before change:  [23.30623167]
curr_Stock_Price:  98.06959281950111
curr_Factors:  [98.06959282]
mat_Sqrt:  [[0.15]]
grads:  [0.01494647]
Stock Position:  0.014946472436078117
Bond Position:  [21.84043721]


portfolio before change:  [23.31607735]
curr_Stock_Price:  98.63699159842217
curr_Factors:  [98.6369916]
mat_Sqrt:  [[0.15]]
grads:  [0.02969866]
Stock Position:  0.029698664351375643
Bond Position:  [20.38669045]


portfolio before change:  [23.35566268]
curr_Stock_Price:  99.92698612377473
curr_Factors:  [99.92698612]
mat_Sqrt:  [[0.15]]
grads:  [0.10239308]
Stock Position:  0.10239307617649673
Bond Position:  [13.12383117]


portfolio before change:  [23.42108174]
curr_Stock_Price:  100.55787639664145
curr_Factors:  [100.5578764]
mat_Sqrt:  [[0.15]]
grads:  [0.07258992]
Stock Position:  0.07258991748029123
Bond Position:  [16.12159379]


portfolio before change:  [23.37596897]
curr_Stock_Price:  99.92252093069038
curr_Factors:  [99.92252093]
mat_Sqrt:  [[0.15]]
grads:  [0.02812065]
Stock Position:  0.028120646190623808
Bond Position:  [20.56608311]


portfolio before change:  [23.36381134]
curr_Stock_Price:  99.44447187041825
curr_Factors:  [99.44447187]
mat_Sqrt:  [[0.15]]
grads:  [0.03695976]
Stock Position:  0.0369597588844611
Bond Position:  [19.68836764]


portfolio before change:  [23.3693914]
curr_Stock_Price:  99.56215402668437
curr_Factors:  [99.56215403]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514397]
Stock Position:  -0.015143971185968908
Bond Position:  [24.8771578]


portfolio before change:  [23.3652962]
curr_Stock_Price:  99.935244943662
curr_Factors:  [99.93524494]
mat_Sqrt:  [[0.15]]
grads:  [-0.01323189]
Stock Position:  -0.013231890097260071
Bond Position:  [24.68762838]


portfolio before change:  [23.359201]
curr_Stock_Price:  100.51250344574248
curr_Factors:  [100.51250345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07512041]
Stock Position:  -0.07512040909870855
Bond Position:  [30.90974138]


portfolio before change:  [23.32174021]
curr_Stock_Price:  101.03689770790615
curr_Factors:  [101.03689771]
mat_Sqrt:  [[0.15]]
grads:  [0.01500179]
Stock Position:  0.01500179326615286
Bond Position:  [21.80600556]


portfolio before change:  [23.32175827]
curr_Stock_Price:  100.94725113976973
curr_Factors:  [100.94725114]
mat_Sqrt:  [[0.15]]
grads:  [0.01938]
Stock Position:  0.01937999996854042
Bond Position:  [21.36540054]


portfolio before change:  [23.32250543]
curr_Stock_Price:  100.91689940736957
curr_Factors:  [100.91689941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02497428]
Stock Position:  -0.024974275837400615
Bond Position:  [25.84283191]


portfolio before change:  [23.30391897]
curr_Stock_Price:  101.72579937896214
curr_Factors:  [101.72579938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253121]
Stock Position:  -0.022531208352865754
Bond Position:  [25.59592415]


portfolio before change:  [23.28466259]
curr_Stock_Price:  102.65145651903066
curr_Factors:  [102.65145652]
mat_Sqrt:  [[0.15]]
grads:  [0.07142026]
Stock Position:  0.07142026454216527
Bond Position:  [15.95326841]


portfolio before change:  [23.30777181]
curr_Stock_Price:  102.96106203636067
curr_Factors:  [102.96106204]
mat_Sqrt:  [[0.15]]
grads:  [-0.07533927]
Stock Position:  -0.07533927008709868
Bond Position:  [31.06478307]


portfolio before change:  [23.33995174]
curr_Stock_Price:  102.55969996025202
curr_Factors:  [102.55969996]
mat_Sqrt:  [[0.15]]
grads:  [0.03804469]
Stock Position:  0.03804468736477108
Bond Position:  [19.43810002]


portfolio before change:  [23.34472687]
curr_Stock_Price:  102.65327972858091
curr_Factors:  [102.65327973]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582026]
Stock Position:  -0.0258202578454437
Bond Position:  [25.99526103]


portfolio before change:  [23.34423667]
curr_Stock_Price:  102.73519049525594
curr_Factors:  [102.7351905]
mat_Sqrt:  [[0.15]]
grads:  [-0.01929462]
Stock Position:  -0.01929461960940606
Bond Position:  [25.32647309]


portfolio before change:  [23.32748528]
curr_Stock_Price:  103.68542134792989
curr_Factors:  [103.68542135]
mat_Sqrt:  [[0.15]]
grads:  [0.03877798]
Stock Position:  0.03877798208562741
Bond Position:  [19.30677387]


portfolio before change:  [23.32968987]
curr_Stock_Price:  103.71115442941972
curr_Factors:  [103.71115443]
mat_Sqrt:  [[0.15]]
grads:  [-0.13170604]
Stock Position:  -0.1317060418175031
Bond Position:  [36.98907551]


portfolio before change:  [23.30284926]
curr_Stock_Price:  103.93249963082204
curr_Factors:  [103.93249963]
mat_Sqrt:  [[0.15]]
grads:  [0.0062349]
Stock Position:  0.006234904035437479
Bond Position:  [22.6548401]


portfolio before change:  [23.30038605]
curr_Stock_Price:  103.31032769583665
curr_Factors:  [103.3103277]
mat_Sqrt:  [[0.15]]
grads:  [0.13590471]
Stock Position:  0.1359047097959214
Bond Position:  [9.26002595]


portfolio before change:  [23.14507258]
curr_Stock_Price:  102.16325752665661
curr_Factors:  [102.16325753]
mat_Sqrt:  [[0.15]]
grads:  [0.04172651]
Stock Position:  0.041726513053391916
Bond Position:  [18.88215608]


portfolio before change:  [23.15099408]
curr_Stock_Price:  102.27688611354327
curr_Factors:  [102.27688611]
mat_Sqrt:  [[0.15]]
grads:  [0.10015823]
Stock Position:  0.10015823393644117
Bond Position:  [12.90712179]


portfolio before change:  [23.110345]
curr_Stock_Price:  101.86298305754734
curr_Factors:  [101.86298306]
mat_Sqrt:  [[0.15]]
grads:  [0.03021458]
Stock Position:  0.030214584744423997
Bond Position:  [20.03259726]


portfolio before change:  [23.14041625]
curr_Stock_Price:  102.81679977606518
curr_Factors:  [102.81679978]
mat_Sqrt:  [[0.15]]
grads:  [0.03315353]
Stock Position:  0.03315352813982012
Bond Position:  [19.73167659]


portfolio before change:  [23.11785341]
curr_Stock_Price:  102.09904478161268
curr_Factors:  [102.09904478]
mat_Sqrt:  [[0.15]]
grads:  [0.12255852]
Stock Position:  0.12255851647144721
Bond Position:  [10.60474595]


portfolio before change:  [23.15977929]
curr_Stock_Price:  102.43572528152397
curr_Factors:  [102.43572528]
mat_Sqrt:  [[0.15]]
grads:  [0.00452433]
Stock Position:  0.004524333768117766
Bond Position:  [22.69632588]


portfolio before change:  [23.16736358]
curr_Stock_Price:  103.79851675227034
curr_Factors:  [103.79851675]
mat_Sqrt:  [[0.15]]
grads:  [-0.10204526]
Stock Position:  -0.10204526112646764
Bond Position:  [33.75951032]


portfolio before change:  [23.27750086]
curr_Stock_Price:  102.73989581723866
curr_Factors:  [102.73989582]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462028]
Stock Position:  -0.014620284575994822
Bond Position:  [24.77958738]


portfolio before change:  [23.27981412]
curr_Stock_Price:  102.68760643065052
curr_Factors:  [102.68760643]
mat_Sqrt:  [[0.15]]
grads:  [0.00801551]
Stock Position:  0.008015511555980978
Bond Position:  [22.45672042]


portfolio before change:  [23.27703751]
curr_Stock_Price:  102.1660922772233
curr_Factors:  [102.16609228]
mat_Sqrt:  [[0.15]]
grads:  [0.01535066]
Stock Position:  0.015350662729121979
Bond Position:  [21.70872028]


portfolio before change:  [23.28328148]
curr_Stock_Price:  102.48445896248317
curr_Factors:  [102.48445896]
mat_Sqrt:  [[0.15]]
grads:  [-0.10014053]
Stock Position:  -0.10014053373623598
Bond Position:  [33.5461299]


portfolio before change:  [23.28065221]
curr_Stock_Price:  102.53165236803859
curr_Factors:  [102.53165237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02556656]
Stock Position:  -0.02556656145662958
Bond Position:  [25.902034]


portfolio before change:  [23.28274816]
curr_Stock_Price:  102.5129944887957
curr_Factors:  [102.51299449]
mat_Sqrt:  [[0.15]]
grads:  [0.09543894]
Stock Position:  0.09543894017116225
Bond Position:  [13.49901661]


portfolio before change:  [23.29817049]
curr_Stock_Price:  102.66574784016252
curr_Factors:  [102.66574784]
mat_Sqrt:  [[0.15]]
grads:  [-0.02535023]
Stock Position:  -0.02535023437152424
Bond Position:  [25.90077126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.28771679]
Stock Price:  103.14197802834003
PL:  [20.14573876]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40265077e-02]
 [ 3.25625815e-03]
 [ 4.23268348e-03]
 [-8.58578166e-03]
 [ 1.42686490e-02]
 [-1.35636395e-02]
 [-2.06318226e-03]
 [-1.57041284e-02]
 [ 1.38363013e-02]
 [-4.54085748e-03]
 [-6.86874257e-04]
 [ 8.79703755e-04]
 [-3.64322586e-03]
 [ 5.24231214e-03]
 [-1.24905242e-03]
 [ 1.44674876e-02]
 [ 4.35904746e-02]
 [-1.49049146e-02]
 [ 2.23905801e-02]
 [ 1.50821744e-03]
 [-6.64979711e-03]
 [ 5.45712158e-03]
 [ 1.59354348e-02]
 [ 1.87296408e-02]
 [-2.42425218e-03]
 [ 4.67155166e-03]
 [ 7.90948095e-03]
 [ 8.31441778e-03]
 [ 1.56105969e-02]
 [ 2.88982421e-03]
 [-7.17499124e-03]
 [ 9.38711797e-03]
 [ 1.15819085e-02]
 [-1.35284285e-02]
 [-5.71329110e-03]
 [ 1.54436815e-02]
 [ 4.67629381e-03]
 [-1.35000842e-03]
 [-2.71499675e-02]
 [-1.51067741e-02]
 [ 7.13055527e-03]
 [ 2.44668238e-02]
 [-3.04459869e-03]
 [ 1.18090963e-02]
 [-4.38149684e-02]
 [ 2.15852955e-02]
 [ 9.27244389e-03]
 [ 5.37165107e-03]
 [-8.44810886e-03]
 [ 1.97133148e-04]
 [-1.39228142e-03]
 [-2.49786837e-03]
 [-3.32919115e-05]
 [ 8.41079538e-03]
 [-1.20573112e-02]
 [-5.16885886e-03]
 [-2.76990824e-03]
 [ 1.32265979e-02]
 [ 6.77389289e-03]
 [-2.72550781e-03]
 [-5.12278754e-03]
 [-2.36978177e-03]
 [-2.58408420e-03]
 [-4.09776326e-03]
 [ 1.87954812e-02]
 [ 4.61724713e-03]
 [ 1.39291902e-02]
 [-1.43356884e-03]
 [ 4.06268671e-03]
 [ 2.30091327e-02]
 [ 3.62546230e-03]
 [-1.54674203e-02]
 [-5.65512955e-03]
 [ 1.86093167e-03]
 [ 9.98162719e-03]
 [ 3.65794511e-03]
 [-1.58362922e-03]
 [-1.22609637e-02]
 [-2.28082463e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.67154877]
curr_Stock_Price:  99.74105135729458
curr_Factors:  [99.74105136]
mat_Sqrt:  [[0.15]]
grads:  [-0.09351005]
Stock Position:  -0.09351005140155222
Bond Position:  [5.65524207]


portfolio before change:  [-3.66742414]
curr_Stock_Price:  99.7007223671422
curr_Factors:  [99.70072237]
mat_Sqrt:  [[0.15]]
grads:  [0.02170839]
Stock Position:  0.021708387649751158
Bond Position:  [-5.83176607]


portfolio before change:  [-3.65823734]
curr_Stock_Price:  100.14070387829186
curr_Factors:  [100.14070388]
mat_Sqrt:  [[0.15]]
grads:  [0.02821789]
Stock Position:  0.028217889847013886
Bond Position:  [-6.48399669]


portfolio before change:  [-3.67543439]
curr_Stock_Price:  99.54562805368718
curr_Factors:  [99.54562805]
mat_Sqrt:  [[0.15]]
grads:  [-0.05723854]
Stock Position:  -0.05723854439146551
Bond Position:  [2.02241246]


portfolio before change:  [-3.67270314]
curr_Stock_Price:  99.50011953122899
curr_Factors:  [99.50011953]
mat_Sqrt:  [[0.15]]
grads:  [0.09512433]
Stock Position:  0.09512432692993361
Bond Position:  [-13.13758504]


portfolio before change:  [-3.70622541]
curr_Stock_Price:  99.15634689343653
curr_Factors:  [99.15634689]
mat_Sqrt:  [[0.15]]
grads:  [-0.09042426]
Stock Position:  -0.0904242631443347
Bond Position:  [5.25991419]


portfolio before change:  [-3.82047616]
curr_Stock_Price:  100.4234792394123
curr_Factors:  [100.42347924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375455]
Stock Position:  -0.01375454836784723
Bond Position:  [-2.43919656]


portfolio before change:  [-3.82114284]
curr_Stock_Price:  100.46086485263959
curr_Factors:  [100.46086485]
mat_Sqrt:  [[0.15]]
grads:  [-0.10469419]
Stock Position:  -0.10469418924208745
Bond Position:  [6.69652596]


portfolio before change:  [-3.91973824]
curr_Stock_Price:  101.40660927253278
curr_Factors:  [101.40660927]
mat_Sqrt:  [[0.15]]
grads:  [0.09224201]
Stock Position:  0.09224200881416507
Bond Position:  [-13.27368759]


portfolio before change:  [-3.9098241]
curr_Stock_Price:  101.5230829592388
curr_Factors:  [101.52308296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03027238]
Stock Position:  -0.030272383216850853
Bond Position:  [-0.83647843]


portfolio before change:  [-3.88819065]
curr_Stock_Price:  100.80672936230867
curr_Factors:  [100.80672936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00457916]
Stock Position:  -0.004579161716547371
Bond Position:  [-3.42658034]


portfolio before change:  [-3.8875479]
curr_Stock_Price:  100.61959425943031
curr_Factors:  [100.61959426]
mat_Sqrt:  [[0.15]]
grads:  [0.00586469]
Stock Position:  0.005864691697547823
Bond Position:  [-4.4776508]


portfolio before change:  [-3.88306939]
curr_Stock_Price:  101.43095398179416
curr_Factors:  [101.43095398]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428817]
Stock Position:  -0.024288172406291324
Bond Position:  [-1.41949689]


portfolio before change:  [-3.88343327]
curr_Stock_Price:  101.44228302685445
curr_Factors:  [101.44228303]
mat_Sqrt:  [[0.15]]
grads:  [0.03494875]
Stock Position:  0.03494874761463677
Bond Position:  [-7.42871402]


portfolio before change:  [-3.90115501]
curr_Stock_Price:  100.9484906029769
curr_Factors:  [100.9484906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00832702]
Stock Position:  -0.008327016149371423
Bond Position:  [-3.0605553]


portfolio before change:  [-3.8978489]
curr_Stock_Price:  100.52848482008979
curr_Factors:  [100.52848482]
mat_Sqrt:  [[0.15]]
grads:  [0.09644992]
Stock Position:  0.09644991720508486
Bond Position:  [-13.59381294]


portfolio before change:  [-3.89748527]
curr_Stock_Price:  100.54106416176394
curr_Factors:  [100.54106416]
mat_Sqrt:  [[0.15]]
grads:  [0.29060316]
Stock Position:  0.2906031641978998
Bond Position:  [-33.11503664]


portfolio before change:  [-4.12055102]
curr_Stock_Price:  99.78059069031264
curr_Factors:  [99.78059069]
mat_Sqrt:  [[0.15]]
grads:  [-0.0993661]
Stock Position:  -0.09936609762851444
Bond Position:  [5.7942569]


portfolio before change:  [-4.06495771]
curr_Stock_Price:  99.22475570994533
curr_Factors:  [99.22475571]
mat_Sqrt:  [[0.15]]
grads:  [0.14927053]
Stock Position:  0.14927053403579107
Bond Position:  [-18.87628999]


portfolio before change:  [-4.06169497]
curr_Stock_Price:  99.25451745949489
curr_Factors:  [99.25451746]
mat_Sqrt:  [[0.15]]
grads:  [0.01005478]
Stock Position:  0.010054782956600977
Bond Position:  [-5.0596776]


portfolio before change:  [-4.07004598]
curr_Stock_Price:  98.45541816308658
curr_Factors:  [98.45541816]
mat_Sqrt:  [[0.15]]
grads:  [-0.04433198]
Stock Position:  -0.044331980718336494
Bond Position:  [0.29467772]


portfolio before change:  [-4.06484038]
curr_Stock_Price:  98.33841053562169
curr_Factors:  [98.33841054]
mat_Sqrt:  [[0.15]]
grads:  [0.03638081]
Stock Position:  0.03638081052405854
Bond Position:  [-7.64247146]


portfolio before change:  [-4.0597124]
curr_Stock_Price:  98.49249292795274
curr_Factors:  [98.49249293]
mat_Sqrt:  [[0.15]]
grads:  [0.10623623]
Stock Position:  0.10623623201371928
Bond Position:  [-14.52318373]


portfolio before change:  [-4.04555762]
curr_Stock_Price:  98.63427608625047
curr_Factors:  [98.63427609]
mat_Sqrt:  [[0.15]]
grads:  [0.12486427]
Stock Position:  0.12486427215966207
Bond Position:  [-16.36145472]


portfolio before change:  [-4.11033357]
curr_Stock_Price:  98.12369510519662
curr_Factors:  [98.12369511]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616168]
Stock Position:  -0.016161681187777523
Bond Position:  [-2.52448969]


portfolio before change:  [-4.12173701]
curr_Stock_Price:  98.81951733713535
curr_Factors:  [98.81951734]
mat_Sqrt:  [[0.15]]
grads:  [0.03114368]
Stock Position:  0.031143677733007132
Bond Position:  [-7.19934021]


portfolio before change:  [-4.1118045]
curr_Stock_Price:  99.15289098109395
curr_Factors:  [99.15289098]
mat_Sqrt:  [[0.15]]
grads:  [0.05272987]
Stock Position:  0.05272987299298387
Bond Position:  [-9.34012385]


portfolio before change:  [-4.13176335]
curr_Stock_Price:  98.78545076380111
curr_Factors:  [98.78545076]
mat_Sqrt:  [[0.15]]
grads:  [0.05542945]
Stock Position:  0.05542945185773185
Bond Position:  [-9.60738674]


portfolio before change:  [-4.117659]
curr_Stock_Price:  99.05073992976428
curr_Factors:  [99.05073993]
mat_Sqrt:  [[0.15]]
grads:  [0.10407065]
Stock Position:  0.10407064583935237
Bond Position:  [-14.42593348]


portfolio before change:  [-4.09966741]
curr_Stock_Price:  99.23228237898813
curr_Factors:  [99.23228238]
mat_Sqrt:  [[0.15]]
grads:  [0.01926549]
Stock Position:  0.01926549473645694
Bond Position:  [-6.01142643]


portfolio before change:  [-4.09004227]
curr_Stock_Price:  99.75138985397662
curr_Factors:  [99.75138985]
mat_Sqrt:  [[0.15]]
grads:  [-0.04783327]
Stock Position:  -0.0478332749226883
Bond Position:  [0.68139338]


portfolio before change:  [-4.09363206]
curr_Stock_Price:  99.82732808699704
curr_Factors:  [99.82732809]
mat_Sqrt:  [[0.15]]
grads:  [0.06258079]
Stock Position:  0.06258078648698967
Bond Position:  [-10.34090477]


portfolio before change:  [-4.14975711]
curr_Stock_Price:  98.94081447466203
curr_Factors:  [98.94081447]
mat_Sqrt:  [[0.15]]
grads:  [0.07721272]
Stock Position:  0.07721272312180096
Bond Position:  [-11.78924682]


portfolio before change:  [-4.14413294]
curr_Stock_Price:  99.02319755592761
curr_Factors:  [99.02319756]
mat_Sqrt:  [[0.15]]
grads:  [-0.09018952]
Stock Position:  -0.09018952345710436
Bond Position:  [4.78672206]


portfolio before change:  [-4.04588573]
curr_Stock_Price:  97.93717307350903
curr_Factors:  [97.93717307]
mat_Sqrt:  [[0.15]]
grads:  [-0.03808861]
Stock Position:  -0.03808860733802209
Bond Position:  [-0.3155952]


portfolio before change:  [-4.0285468]
curr_Stock_Price:  97.48142909035806
curr_Factors:  [97.48142909]
mat_Sqrt:  [[0.15]]
grads:  [0.10295788]
Stock Position:  0.10295787658698484
Bond Position:  [-14.06502774]


portfolio before change:  [-4.00703417]
curr_Stock_Price:  97.6989133455099
curr_Factors:  [97.69891335]
mat_Sqrt:  [[0.15]]
grads:  [0.03117529]
Stock Position:  0.031175292089856907
Bond Position:  [-7.05282633]


portfolio before change:  [-4.0309593]
curr_Stock_Price:  96.94561456025632
curr_Factors:  [96.94561456]
mat_Sqrt:  [[0.15]]
grads:  [-0.00900006]
Stock Position:  -0.009000056124428243
Bond Position:  [-3.15844332]


portfolio before change:  [-4.03603012]
curr_Stock_Price:  97.48710149746948
curr_Factors:  [97.4871015]
mat_Sqrt:  [[0.15]]
grads:  [-0.18099978]
Stock Position:  -0.18099978356976879
Bond Position:  [13.60911415]


portfolio before change:  [-4.07379065]
curr_Stock_Price:  97.70042291440775
curr_Factors:  [97.70042291]
mat_Sqrt:  [[0.15]]
grads:  [-0.10071183]
Stock Position:  -0.10071182759545934
Bond Position:  [5.7657975]


portfolio before change:  [-4.08808548]
curr_Stock_Price:  97.84593910441299
curr_Factors:  [97.8459391]
mat_Sqrt:  [[0.15]]
grads:  [0.04753704]
Stock Position:  0.047537035147373376
Bond Position:  [-8.73939133]


portfolio before change:  [-4.06516556]
curr_Stock_Price:  98.33957844046321
curr_Factors:  [98.33957844]
mat_Sqrt:  [[0.15]]
grads:  [0.16311216]
Stock Position:  0.16311215896726913
Bond Position:  [-20.10554651]


portfolio before change:  [-4.17138512]
curr_Stock_Price:  97.69607693056355
curr_Factors:  [97.69607693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029732]
Stock Position:  -0.020297324596029773
Bond Position:  [-2.18841613]


portfolio before change:  [-4.14530545]
curr_Stock_Price:  96.40445632036628
curr_Factors:  [96.40445632]
mat_Sqrt:  [[0.15]]
grads:  [0.07872731]
Stock Position:  0.07872730840877176
Bond Position:  [-11.73496882]


portfolio before change:  [-4.18424254]
curr_Stock_Price:  95.91919105857596
curr_Factors:  [95.91919106]
mat_Sqrt:  [[0.15]]
grads:  [-0.29209979]
Stock Position:  -0.2920997896626662
Bond Position:  [23.83373299]


portfolio before change:  [-4.18856689]
curr_Stock_Price:  95.93909523642283
curr_Factors:  [95.93909524]
mat_Sqrt:  [[0.15]]
grads:  [0.14390197]
Stock Position:  0.1439019700505749
Bond Position:  [-17.9943917]


portfolio before change:  [-4.23371338]
curr_Stock_Price:  95.63318000143745
curr_Factors:  [95.63318]
mat_Sqrt:  [[0.15]]
grads:  [0.06181629]
Stock Position:  0.06181629261054991
Bond Position:  [-10.14540202]


portfolio before change:  [-4.23925679]
curr_Stock_Price:  95.55376240567412
curr_Factors:  [95.55376241]
mat_Sqrt:  [[0.15]]
grads:  [0.03581101]
Stock Position:  0.03581100712855326
Bond Position:  [-7.66113326]


portfolio before change:  [-4.23041354]
curr_Stock_Price:  95.81407584850707
curr_Factors:  [95.81407585]
mat_Sqrt:  [[0.15]]
grads:  [-0.05632073]
Stock Position:  -0.05632072575890933
Bond Position:  [1.16590475]


portfolio before change:  [-4.16835623]
curr_Stock_Price:  94.71351405824997
curr_Factors:  [94.71351406]
mat_Sqrt:  [[0.15]]
grads:  [0.00131422]
Stock Position:  0.001314220983742353
Bond Position:  [-4.29283072]


portfolio before change:  [-4.16809235]
curr_Stock_Price:  95.11845664642551
curr_Factors:  [95.11845665]
mat_Sqrt:  [[0.15]]
grads:  [-0.00928188]
Stock Position:  -0.009281876102476735
Bond Position:  [-3.28521462]


portfolio before change:  [-4.17330168]
curr_Stock_Price:  95.6575706311856
curr_Factors:  [95.65757063]
mat_Sqrt:  [[0.15]]
grads:  [-0.01665246]
Stock Position:  -0.01665245577593681
Bond Position:  [-2.58036821]


portfolio before change:  [-4.18108122]
curr_Stock_Price:  96.11505670592541
curr_Factors:  [96.11505671]
mat_Sqrt:  [[0.15]]
grads:  [-0.00022195]
Stock Position:  -0.00022194607689838856
Bond Position:  [-4.15974886]


portfolio before change:  [-4.18138385]
curr_Stock_Price:  96.30715687569906
curr_Factors:  [96.30715688]
mat_Sqrt:  [[0.15]]
grads:  [0.05607197]
Stock Position:  0.056071969218597806
Bond Position:  [-9.58151578]


portfolio before change:  [-4.2058934]
curr_Stock_Price:  95.88072829565216
curr_Factors:  [95.8807283]
mat_Sqrt:  [[0.15]]
grads:  [-0.08038207]
Stock Position:  -0.08038207475238973
Bond Position:  [3.50119847]


portfolio before change:  [-4.16799707]
curr_Stock_Price:  95.4119981690168
curr_Factors:  [95.41199817]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445906]
Stock Position:  -0.03445905907120748
Bond Position:  [-0.88018939]


portfolio before change:  [-4.16492475]
curr_Stock_Price:  95.32124296065952
curr_Factors:  [95.32124296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01846605]
Stock Position:  -0.018466054915653056
Bond Position:  [-2.40471744]


portfolio before change:  [-4.17204242]
curr_Stock_Price:  95.69855040723296
curr_Factors:  [95.69855041]
mat_Sqrt:  [[0.15]]
grads:  [0.08817732]
Stock Position:  0.08817731900808726
Bond Position:  [-12.61048403]


portfolio before change:  [-4.19409412]
curr_Stock_Price:  95.45740545678969
curr_Factors:  [95.45740546]
mat_Sqrt:  [[0.15]]
grads:  [0.04515929]
Stock Position:  0.04515928590080915
Bond Position:  [-8.50488238]


portfolio before change:  [-4.18700362]
curr_Stock_Price:  95.62618743392197
curr_Factors:  [95.62618743]
mat_Sqrt:  [[0.15]]
grads:  [-0.01817005]
Stock Position:  -0.01817005206714072
Bond Position:  [-2.44947081]


portfolio before change:  [-4.18345345]
curr_Stock_Price:  95.42237595945564
curr_Factors:  [95.42237596]
mat_Sqrt:  [[0.15]]
grads:  [-0.03415192]
Stock Position:  -0.03415191690418214
Bond Position:  [-0.9245964]


portfolio before change:  [-4.18803659]
curr_Stock_Price:  95.55488260469062
curr_Factors:  [95.5548826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01579855]
Stock Position:  -0.015798545145270383
Bond Position:  [-2.67840847]


portfolio before change:  [-4.19780725]
curr_Stock_Price:  96.16273940073052
curr_Factors:  [96.1627394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01722723]
Stock Position:  -0.01722722803146618
Bond Position:  [-2.54118981]


portfolio before change:  [-4.18777196]
curr_Stock_Price:  95.57099440349137
curr_Factors:  [95.5709944]
mat_Sqrt:  [[0.15]]
grads:  [-0.02731842]
Stock Position:  -0.027318421702991064
Bond Position:  [-1.57692323]


portfolio before change:  [-4.20790157]
curr_Stock_Price:  96.30423769740831
curr_Factors:  [96.3042377]
mat_Sqrt:  [[0.15]]
grads:  [0.12530321]
Stock Position:  0.12530320777530374
Bond Position:  [-16.27513147]


portfolio before change:  [-4.13108909]
curr_Stock_Price:  96.92536865147831
curr_Factors:  [96.92536865]
mat_Sqrt:  [[0.15]]
grads:  [0.03078165]
Stock Position:  0.03078164750623509
Bond Position:  [-7.11461163]


portfolio before change:  [-4.12369738]
curr_Stock_Price:  97.17994860472034
curr_Factors:  [97.1799486]
mat_Sqrt:  [[0.15]]
grads:  [0.09286127]
Stock Position:  0.09286126796178865
Bond Position:  [-13.14795063]


portfolio before change:  [-4.11813093]
curr_Stock_Price:  97.24874179579247
curr_Factors:  [97.2487418]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955713]
Stock Position:  -0.00955712560950183
Bond Position:  [-3.18871249]


portfolio before change:  [-4.11764994]
curr_Stock_Price:  97.1775603801767
curr_Factors:  [97.17756038]
mat_Sqrt:  [[0.15]]
grads:  [0.02708458]
Stock Position:  0.02708457809775277
Bond Position:  [-6.74966316]


portfolio before change:  [-4.10675193]
curr_Stock_Price:  97.59550608086201
curr_Factors:  [97.59550608]
mat_Sqrt:  [[0.15]]
grads:  [0.15339422]
Stock Position:  0.15339421805541256
Bond Position:  [-19.07733827]


portfolio before change:  [-4.10165308]
curr_Stock_Price:  97.63651945307441
curr_Factors:  [97.63651945]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [-6.46150322]


portfolio before change:  [-4.1209543]
curr_Stock_Price:  96.85465951351605
curr_Factors:  [96.85465951]
mat_Sqrt:  [[0.15]]
grads:  [-0.10311614]
Stock Position:  -0.10311613532714332
Bond Position:  [5.86632388]


portfolio before change:  [-4.1160014]
curr_Stock_Price:  96.81018307266812
curr_Factors:  [96.81018307]
mat_Sqrt:  [[0.15]]
grads:  [-0.03770086]
Stock Position:  -0.03770086366065633
Bond Position:  [-0.46617389]


portfolio before change:  [-4.10674489]
curr_Stock_Price:  96.56388494025589
curr_Factors:  [96.56388494]
mat_Sqrt:  [[0.15]]
grads:  [0.01240621]
Stock Position:  0.01240621110738176
Bond Position:  [-5.30473683]


portfolio before change:  [-4.10695818]
curr_Stock_Price:  96.57341736995595
curr_Factors:  [96.57341737]
mat_Sqrt:  [[0.15]]
grads:  [0.06654418]
Stock Position:  0.06654418124038575
Bond Position:  [-10.53335717]


portfolio before change:  [-4.1276991]
curr_Stock_Price:  96.27162450616346
curr_Factors:  [96.27162451]
mat_Sqrt:  [[0.15]]
grads:  [0.0243863]
Stock Position:  0.0243863007489915
Bond Position:  [-6.47540788]


portfolio before change:  [-4.11746986]
curr_Stock_Price:  96.70768732691981
curr_Factors:  [96.70768733]
mat_Sqrt:  [[0.15]]
grads:  [-0.01055753]
Stock Position:  -0.010557528161184831
Bond Position:  [-3.09647573]


portfolio before change:  [-4.11501832]
curr_Stock_Price:  96.45714749413766
curr_Factors:  [96.45714749]
mat_Sqrt:  [[0.15]]
grads:  [-0.08173976]
Stock Position:  -0.08173975804944986
Bond Position:  [3.76936558]


portfolio before change:  [-4.17497946]
curr_Stock_Price:  97.19359122140983
curr_Factors:  [97.19359122]
mat_Sqrt:  [[0.15]]
grads:  [-0.15205498]
Stock Position:  -0.15205497549137814
Bond Position:  [10.60378968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.12477063]
Stock Price:  96.86774808253921
PL:  [-4.12477063]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39506826e-02]
 [ 2.47905186e-02]
 [ 2.01731816e-02]
 [-5.97544268e-03]
 [-1.16338653e-02]
 [-1.14294203e-03]
 [-4.82516826e-04]
 [-3.74065662e-02]
 [ 1.03559915e-02]
 [ 1.59962078e-03]
 [-1.53381505e-03]
 [-4.05882787e-03]
 [-1.02096015e-03]
 [ 3.70004485e-03]
 [ 2.59764239e-04]
 [ 1.27341866e-02]
 [ 2.71041209e-02]
 [-1.51917305e-02]
 [ 2.03551624e-02]
 [ 2.30549181e-03]
 [-4.18744799e-03]
 [ 4.40663148e-03]
 [ 1.68888577e-02]
 [ 1.75218702e-02]
 [-4.00527574e-03]
 [ 5.29799634e-03]
 [ 1.27337328e-03]
 [ 7.94759905e-03]
 [ 1.78870902e-02]
 [ 2.73273625e-03]
 [-6.81427139e-03]
 [ 1.05784146e-02]
 [ 1.14528190e-02]
 [-1.58537068e-02]
 [ 6.14555474e-03]
 [ 1.25226989e-02]
 [-2.77050004e-02]
 [-6.57976016e-04]
 [-3.24216830e-02]
 [-1.55427570e-02]
 [ 3.75998119e-03]
 [ 1.00203961e-02]
 [-7.38280987e-03]
 [-3.73903967e-03]
 [ 1.41394377e-02]
 [ 1.31365422e-02]
 [ 1.07088662e-02]
 [-1.78742704e-05]
 [ 1.24385742e-02]
 [-1.23416092e-03]
 [ 2.16644658e-02]
 [ 4.08439437e-03]
 [-3.77547308e-03]
 [-3.96365035e-02]
 [-1.11135404e-02]
 [-2.51318210e-03]
 [ 5.77655312e-03]
 [-1.67843914e-02]
 [ 4.00406490e-03]
 [-3.60010401e-03]
 [-3.02441890e-03]
 [ 7.82624705e-03]
 [-1.77728869e-02]
 [ 2.49735296e-03]
 [ 2.08312627e-02]
 [ 1.03635174e-02]
 [ 8.56695203e-03]
 [ 9.43992401e-03]
 [ 6.57920668e-03]
 [ 1.12414283e-02]
 [ 1.57661161e-03]
 [-1.51628940e-02]
 [-8.13088154e-03]
 [ 1.07916515e-03]
 [ 3.41489506e-03]
 [-1.80317480e-02]
 [-3.52865974e-03]
 [ 1.35546027e-02]
 [-6.51229208e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.92441654]
curr_Stock_Price:  99.82040252283271
curr_Factors:  [99.82040252]
mat_Sqrt:  [[0.15]]
grads:  [-0.09300455]
Stock Position:  -0.09300455074269731
Bond Position:  [7.35933516]


portfolio before change:  [-1.99041061]
curr_Stock_Price:  100.53492722039536
curr_Factors:  [100.53492722]
mat_Sqrt:  [[0.15]]
grads:  [0.16527012]
Stock Position:  0.16527012432654903
Bond Position:  [-18.60583053]


portfolio before change:  [-1.91576913]
curr_Stock_Price:  100.99359683327398
curr_Factors:  [100.99359683]
mat_Sqrt:  [[0.15]]
grads:  [0.13448788]
Stock Position:  0.1344878773907617
Bond Position:  [-15.4981836]


portfolio before change:  [-2.02565656]
curr_Stock_Price:  100.18371890374716
curr_Factors:  [100.1837189]
mat_Sqrt:  [[0.15]]
grads:  [-0.03983628]
Stock Position:  -0.03983628455660409
Bond Position:  [1.96529058]


portfolio before change:  [-2.05068261]
curr_Stock_Price:  100.81502499918517
curr_Factors:  [100.815025]
mat_Sqrt:  [[0.15]]
grads:  [-0.0775591]
Stock Position:  -0.07755910185979811
Bond Position:  [5.76844018]


portfolio before change:  [-2.0737043]
curr_Stock_Price:  101.1165012776155
curr_Factors:  [101.11650128]
mat_Sqrt:  [[0.15]]
grads:  [-0.00761961]
Stock Position:  -0.007619613536734045
Bond Position:  [-1.30323564]


portfolio before change:  [-2.07725665]
curr_Stock_Price:  101.57202231139183
curr_Factors:  [101.57202231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00321678]
Stock Position:  -0.003216778842962317
Bond Position:  [-1.75052192]


portfolio before change:  [-2.07739297]
curr_Stock_Price:  101.58038557035846
curr_Factors:  [101.58038557]
mat_Sqrt:  [[0.15]]
grads:  [-0.24937711]
Stock Position:  -0.24937710818082137
Bond Position:  [23.25442984]


portfolio before change:  [-1.95324079]
curr_Stock_Price:  101.08836475819801
curr_Factors:  [101.08836476]
mat_Sqrt:  [[0.15]]
grads:  [0.06903994]
Stock Position:  0.06903994320446419
Bond Position:  [-8.93237575]


portfolio before change:  [-1.99280859]
curr_Stock_Price:  100.52333672759501
curr_Factors:  [100.52333673]
mat_Sqrt:  [[0.15]]
grads:  [0.01066414]
Stock Position:  0.010664138543519086
Bond Position:  [-3.06480338]


portfolio before change:  [-1.98951734]
curr_Stock_Price:  100.84992681428736
curr_Factors:  [100.84992681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01022543]
Stock Position:  -0.010225433640535771
Bond Position:  [-0.95828311]


portfolio before change:  [-1.97878141]
curr_Stock_Price:  99.79414549674365
curr_Factors:  [99.7941455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02705885]
Stock Position:  -0.0270588524749776
Bond Position:  [0.72153365]


portfolio before change:  [-1.97081152]
curr_Stock_Price:  99.50127309592551
curr_Factors:  [99.5012731]
mat_Sqrt:  [[0.15]]
grads:  [-0.0068064]
Stock Position:  -0.006806401020053403
Bond Position:  [-1.29356596]


portfolio before change:  [-1.96681566]
curr_Stock_Price:  98.90231976930167
curr_Factors:  [98.90231977]
mat_Sqrt:  [[0.15]]
grads:  [0.02466697]
Stock Position:  0.02466696569546922
Bond Position:  [-4.40643579]


portfolio before change:  [-1.95059656]
curr_Stock_Price:  99.57100792509986
curr_Factors:  [99.57100793]
mat_Sqrt:  [[0.15]]
grads:  [0.00173176]
Stock Position:  0.0017317615910142244
Bond Position:  [-2.12302981]


portfolio before change:  [-1.95026052]
curr_Stock_Price:  99.84168003210883
curr_Factors:  [99.84168003]
mat_Sqrt:  [[0.15]]
grads:  [0.08489458]
Stock Position:  0.0848945776567033
Bond Position:  [-10.42627777]


portfolio before change:  [-1.97299666]
curr_Stock_Price:  99.58153991126288
curr_Factors:  [99.58153991]
mat_Sqrt:  [[0.15]]
grads:  [0.18069414]
Stock Position:  0.18069413931192468
Bond Position:  [-19.96679731]


portfolio before change:  [-1.99446012]
curr_Stock_Price:  99.46966303741497
curr_Factors:  [99.46966304]
mat_Sqrt:  [[0.15]]
grads:  [-0.1012782]
Stock Position:  -0.10127820359231915
Bond Position:  [8.07964866]


portfolio before change:  [-2.0236491]
curr_Stock_Price:  99.76285512358929
curr_Factors:  [99.76285512]
mat_Sqrt:  [[0.15]]
grads:  [0.13570108]
Stock Position:  0.13570108245007842
Bond Position:  [-15.56157653]


portfolio before change:  [-2.02993874]
curr_Stock_Price:  99.72367333508845
curr_Factors:  [99.72367334]
mat_Sqrt:  [[0.15]]
grads:  [0.01536995]
Stock Position:  0.015369945383899205
Bond Position:  [-3.56268615]


portfolio before change:  [-2.02398262]
curr_Stock_Price:  100.12567831637362
curr_Factors:  [100.12567832]
mat_Sqrt:  [[0.15]]
grads:  [-0.02791632]
Stock Position:  -0.027916319933609022
Bond Position:  [0.77115785]


portfolio before change:  [-2.01615535]
curr_Stock_Price:  99.84702157041639
curr_Factors:  [99.84702157]
mat_Sqrt:  [[0.15]]
grads:  [0.02937754]
Stock Position:  0.029377543192067788
Bond Position:  [-4.94941554]


portfolio before change:  [-2.02010049]
curr_Stock_Price:  99.72326063939556
curr_Factors:  [99.72326064]
mat_Sqrt:  [[0.15]]
grads:  [0.11259238]
Stock Position:  0.11259238468195927
Bond Position:  [-13.24818021]


portfolio before change:  [-2.01674797]
curr_Stock_Price:  99.7603906023364
curr_Factors:  [99.7603906]
mat_Sqrt:  [[0.15]]
grads:  [0.11681247]
Stock Position:  0.11681246805015004
Bond Position:  [-13.67000541]


portfolio before change:  [-1.93806213]
curr_Stock_Price:  100.44131312865947
curr_Factors:  [100.44131313]
mat_Sqrt:  [[0.15]]
grads:  [-0.02670184]
Stock Position:  -0.026701838254410474
Bond Position:  [0.74390556]


portfolio before change:  [-1.93584486]
curr_Stock_Price:  100.36001604377753
curr_Factors:  [100.36001604]
mat_Sqrt:  [[0.15]]
grads:  [0.03531998]
Stock Position:  0.03531997557616207
Bond Position:  [-5.48055817]


portfolio before change:  [-1.94547429]
curr_Stock_Price:  100.09708019294185
curr_Factors:  [100.09708019]
mat_Sqrt:  [[0.15]]
grads:  [0.00848916]
Stock Position:  0.008489155182764378
Bond Position:  [-2.79521394]


portfolio before change:  [-1.94729903]
curr_Stock_Price:  99.90271067408133
curr_Factors:  [99.90271067]
mat_Sqrt:  [[0.15]]
grads:  [0.05298399]
Stock Position:  0.052983993656237814
Bond Position:  [-7.24054362]


portfolio before change:  [-1.96114273]
curr_Stock_Price:  99.64997110573995
curr_Factors:  [99.64997111]
mat_Sqrt:  [[0.15]]
grads:  [0.11924727]
Stock Position:  0.11924726820062875
Bond Position:  [-13.84412956]


portfolio before change:  [-2.05031772]
curr_Stock_Price:  98.9094115797123
curr_Factors:  [98.90941158]
mat_Sqrt:  [[0.15]]
grads:  [0.01821824]
Stock Position:  0.018218241683286493
Bond Position:  [-3.85227328]


portfolio before change:  [-2.04059953]
curr_Stock_Price:  99.45605937308768
curr_Factors:  [99.45605937]
mat_Sqrt:  [[0.15]]
grads:  [-0.04542848]
Stock Position:  -0.04542847594414259
Bond Position:  [2.47753767]


portfolio before change:  [-2.01176865]
curr_Stock_Price:  98.82482464497186
curr_Factors:  [98.82482464]
mat_Sqrt:  [[0.15]]
grads:  [0.07052276]
Stock Position:  0.07052276407466843
Bond Position:  [-8.98116844]


portfolio before change:  [-2.03610836]
curr_Stock_Price:  98.4876515943867
curr_Factors:  [98.48765159]
mat_Sqrt:  [[0.15]]
grads:  [0.07635213]
Stock Position:  0.07635212676455985
Bond Position:  [-9.55585002]


portfolio before change:  [-2.01183056]
curr_Stock_Price:  98.81344548857199
curr_Factors:  [98.81344549]
mat_Sqrt:  [[0.15]]
grads:  [-0.10569138]
Stock Position:  -0.10569137862572935
Bond Position:  [8.43189872]


portfolio before change:  [-2.16422198]
curr_Stock_Price:  100.2602846190792
curr_Factors:  [100.26028462]
mat_Sqrt:  [[0.15]]
grads:  [0.04097036]
Stock Position:  0.04097036495367098
Bond Position:  [-6.27192243]


portfolio before change:  [-2.15752239]
curr_Stock_Price:  100.4333754475145
curr_Factors:  [100.43337545]
mat_Sqrt:  [[0.15]]
grads:  [0.08348466]
Stock Position:  0.08348465904462968
Bond Position:  [-10.5421685]


portfolio before change:  [-2.10647469]
curr_Stock_Price:  101.05272998943873
curr_Factors:  [101.05272999]
mat_Sqrt:  [[0.15]]
grads:  [-0.1847]
Stock Position:  -0.18470000289736416
Bond Position:  [16.55796483]


portfolio before change:  [-2.27762434]
curr_Stock_Price:  101.98496904339466
curr_Factors:  [101.98496904]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438651]
Stock Position:  -0.004386506774161128
Bond Position:  [-1.83026659]


portfolio before change:  [-2.27913665]
curr_Stock_Price:  102.30365234943177
curr_Factors:  [102.30365235]
mat_Sqrt:  [[0.15]]
grads:  [-0.21614455]
Stock Position:  -0.21614455309131994
Bond Position:  [19.83324057]


portfolio before change:  [-2.45599647]
curr_Stock_Price:  103.12763537489866
curr_Factors:  [103.12763537]
mat_Sqrt:  [[0.15]]
grads:  [-0.10361838]
Stock Position:  -0.10361838006663088
Bond Position:  [8.22992205]


portfolio before change:  [-2.4720329]
curr_Stock_Price:  103.28736391486164
curr_Factors:  [103.28736391]
mat_Sqrt:  [[0.15]]
grads:  [0.02506654]
Stock Position:  0.02506654129565625
Bond Position:  [-5.06108987]


portfolio before change:  [-2.48113397]
curr_Stock_Price:  102.93690706501519
curr_Factors:  [102.93690707]
mat_Sqrt:  [[0.15]]
grads:  [0.06680264]
Stock Position:  0.06680264066255592
Bond Position:  [-9.35759118]


portfolio before change:  [-2.50674935]
curr_Stock_Price:  102.56221359686734
curr_Factors:  [102.5622136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04921873]
Stock Position:  -0.04921873246165223
Bond Position:  [2.5412328]


portfolio before change:  [-2.47206581]
curr_Stock_Price:  101.86075897469178
curr_Factors:  [101.86075897]
mat_Sqrt:  [[0.15]]
grads:  [-0.02492693]
Stock Position:  -0.02492693112937629
Bond Position:  [0.06701031]


portfolio before change:  [-2.46376416]
curr_Stock_Price:  101.52788777655857
curr_Factors:  [101.52788778]
mat_Sqrt:  [[0.15]]
grads:  [0.09426292]
Stock Position:  0.09426291817097371
Bond Position:  [-12.03407914]


portfolio before change:  [-2.44931118]
curr_Stock_Price:  101.6891933721053
curr_Factors:  [101.68919337]
mat_Sqrt:  [[0.15]]
grads:  [0.08757695]
Stock Position:  0.08757694800829559
Bond Position:  [-11.35494038]


portfolio before change:  [-2.48418764]
curr_Stock_Price:  101.29905930413088
curr_Factors:  [101.2990593]
mat_Sqrt:  [[0.15]]
grads:  [0.07139244]
Stock Position:  0.07139244126364719
Bond Position:  [-9.71617478]


portfolio before change:  [-2.42176296]
curr_Stock_Price:  102.1819532663159
curr_Factors:  [102.18195327]
mat_Sqrt:  [[0.15]]
grads:  [-0.00011916]
Stock Position:  -0.00011916180236410196
Bond Position:  [-2.40958678]


portfolio before change:  [-2.42198996]
curr_Stock_Price:  102.82302451887536
curr_Factors:  [102.82302452]
mat_Sqrt:  [[0.15]]
grads:  [0.08292383]
Stock Position:  0.08292382769277312
Bond Position:  [-10.94846873]


portfolio before change:  [-2.3830353]
curr_Stock_Price:  103.301041057675
curr_Factors:  [103.30104106]
mat_Sqrt:  [[0.15]]
grads:  [-0.00822774]
Stock Position:  -0.008227739473034706
Bond Position:  [-1.53310124]


portfolio before change:  [-2.38234328]
curr_Stock_Price:  103.20528747481983
curr_Factors:  [103.20528747]
mat_Sqrt:  [[0.15]]
grads:  [0.14442977]
Stock Position:  0.14442977232592108
Bond Position:  [-17.28825946]


portfolio before change:  [-2.29882283]
curr_Stock_Price:  103.79104625741546
curr_Factors:  [103.79104626]
mat_Sqrt:  [[0.15]]
grads:  [0.0272293]
Stock Position:  0.02722929582831597
Bond Position:  [-5.12497993]


portfolio before change:  [-2.27729137]
curr_Stock_Price:  104.59355617554819
curr_Factors:  [104.59355618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02516982]
Stock Position:  -0.02516982055010531
Bond Position:  [0.35530967]


portfolio before change:  [-2.2924428]
curr_Stock_Price:  105.19640693026176
curr_Factors:  [105.19640693]
mat_Sqrt:  [[0.15]]
grads:  [-0.26424336]
Stock Position:  -0.2642433564899551
Bond Position:  [25.50500885]


portfolio before change:  [-2.28516394]
curr_Stock_Price:  105.17489362136385
curr_Factors:  [105.17489362]
mat_Sqrt:  [[0.15]]
grads:  [-0.07409027]
Stock Position:  -0.07409026964745395
Bond Position:  [5.50727229]


portfolio before change:  [-2.30998031]
curr_Stock_Price:  105.51448727281343
curr_Factors:  [105.51448727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675455]
Stock Position:  -0.016754547345934657
Bond Position:  [-0.54213284]


portfolio before change:  [-2.29719517]
curr_Stock_Price:  104.74937992840574
curr_Factors:  [104.74937993]
mat_Sqrt:  [[0.15]]
grads:  [0.03851035]
Stock Position:  0.0385103541463788
Bond Position:  [-6.33113089]


portfolio before change:  [-2.27375023]
curr_Stock_Price:  105.36845109379608
curr_Factors:  [105.36845109]
mat_Sqrt:  [[0.15]]
grads:  [-0.11189594]
Stock Position:  -0.11189594291801448
Bond Position:  [9.51655196]


portfolio before change:  [-2.12511746]
curr_Stock_Price:  104.04545433380969
curr_Factors:  [104.04545433]
mat_Sqrt:  [[0.15]]
grads:  [0.02669377]
Stock Position:  0.02669376602453475
Bond Position:  [-4.90248247]


portfolio before change:  [-2.13591645]
curr_Stock_Price:  103.65238206441288
curr_Factors:  [103.65238206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02400069]
Stock Position:  -0.024000693413728496
Bond Position:  [0.35181259]


portfolio before change:  [-2.11618826]
curr_Stock_Price:  102.83131403888837
curr_Factors:  [102.83131404]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016279]
Stock Position:  -0.020162792659451746
Bond Position:  [-0.04282179]


portfolio before change:  [-2.11317368]
curr_Stock_Price:  102.6816695630035
curr_Factors:  [102.68166956]
mat_Sqrt:  [[0.15]]
grads:  [0.05217498]
Stock Position:  0.05217498034788992
Bond Position:  [-7.47058778]


portfolio before change:  [-2.11874443]
curr_Stock_Price:  102.58384839241737
curr_Factors:  [102.58384839]
mat_Sqrt:  [[0.15]]
grads:  [-0.11848591]
Stock Position:  -0.11848591283825825
Bond Position:  [10.03599649]


portfolio before change:  [-2.1739922]
curr_Stock_Price:  103.05542376459049
curr_Factors:  [103.05542376]
mat_Sqrt:  [[0.15]]
grads:  [0.01664902]
Stock Position:  0.016649019711560648
Bond Position:  [-3.88976398]


portfolio before change:  [-2.17159555]
curr_Stock_Price:  103.21397729859248
curr_Factors:  [103.2139773]
mat_Sqrt:  [[0.15]]
grads:  [0.13887508]
Stock Position:  0.1388750849258915
Bond Position:  [-16.50544542]


portfolio before change:  [-2.14546939]
curr_Stock_Price:  103.4095328048382
curr_Factors:  [103.4095328]
mat_Sqrt:  [[0.15]]
grads:  [0.06909012]
Stock Position:  0.06909011606708605
Bond Position:  [-9.29004601]


portfolio before change:  [-2.11471156]
curr_Stock_Price:  103.86312122064807
curr_Factors:  [103.86312122]
mat_Sqrt:  [[0.15]]
grads:  [0.05711301]
Stock Position:  0.05711301352407751
Bond Position:  [-8.04664741]


portfolio before change:  [-2.12724783]
curr_Stock_Price:  103.65242768229865
curr_Factors:  [103.65242768]
mat_Sqrt:  [[0.15]]
grads:  [0.06293283]
Stock Position:  0.06293282671084664
Bond Position:  [-8.6503881]


portfolio before change:  [-2.11666612]
curr_Stock_Price:  103.8291618336923
curr_Factors:  [103.82916183]
mat_Sqrt:  [[0.15]]
grads:  [0.04386138]
Stock Position:  0.04386137787576248
Bond Position:  [-6.67075622]


portfolio before change:  [-2.09903062]
curr_Stock_Price:  104.24074102625872
curr_Factors:  [104.24074103]
mat_Sqrt:  [[0.15]]
grads:  [0.07494286]
Stock Position:  0.07494285501865156
Bond Position:  [-9.91112937]


portfolio before change:  [-2.10955029]
curr_Stock_Price:  104.10863771573085
curr_Factors:  [104.10863772]
mat_Sqrt:  [[0.15]]
grads:  [0.01051074]
Stock Position:  0.010510744037260699
Bond Position:  [-3.20380953]


portfolio before change:  [-2.10192425]
curr_Stock_Price:  104.85323633488818
curr_Factors:  [104.85323633]
mat_Sqrt:  [[0.15]]
grads:  [-0.10108596]
Stock Position:  -0.10108596031511183
Bond Position:  [8.49726584]


portfolio before change:  [-2.01513994]
curr_Stock_Price:  103.99997033711978
curr_Factors:  [103.99997034]
mat_Sqrt:  [[0.15]]
grads:  [-0.05420588]
Stock Position:  -0.05420587691281102
Bond Position:  [3.62226965]


portfolio before change:  [-1.9887799]
curr_Stock_Price:  103.51785207055738
curr_Factors:  [103.51785207]
mat_Sqrt:  [[0.15]]
grads:  [0.00719443]
Stock Position:  0.007194434346224094
Bond Position:  [-2.73353229]


portfolio before change:  [-1.98952443]
curr_Stock_Price:  103.43811204092229
curr_Factors:  [103.43811204]
mat_Sqrt:  [[0.15]]
grads:  [0.02276597]
Stock Position:  0.022765967050136286
Bond Position:  [-4.34439308]


portfolio before change:  [-1.9831847]
curr_Stock_Price:  103.7285130870158
curr_Factors:  [103.72851309]
mat_Sqrt:  [[0.15]]
grads:  [-0.12021165]
Stock Position:  -0.12021165340019166
Bond Position:  [10.48619136]


portfolio before change:  [-1.91772066]
curr_Stock_Price:  103.18939198719806
curr_Factors:  [103.18939199]
mat_Sqrt:  [[0.15]]
grads:  [-0.0235244]
Stock Position:  -0.02352439826706959
Bond Position:  [0.5097477]


portfolio before change:  [-1.90849755]
curr_Stock_Price:  102.79868076520366
curr_Factors:  [102.79868077]
mat_Sqrt:  [[0.15]]
grads:  [0.09036402]
Stock Position:  0.09036401805722956
Bond Position:  [-11.1977994]


portfolio before change:  [-1.9853426]
curr_Stock_Price:  101.95603156134277
curr_Factors:  [101.95603156]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341528]
Stock Position:  -0.043415280551486114
Bond Position:  [2.44110711]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.00872205]
Stock Price:  102.49805321476775
PL:  [-4.50677527]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.09134597e-03]
 [ 3.00375931e-02]
 [ 2.12348989e-02]
 [-6.55221687e-03]
 [ 1.40337505e-02]
 [-6.02195006e-03]
 [ 2.41756943e-03]
 [-9.14051644e-03]
 [-1.00372020e-02]
 [-9.60531861e-03]
 [ 1.34332852e-02]
 [-7.86188551e-03]
 [ 1.88080370e-03]
 [-4.60118237e-03]
 [ 2.01938705e-03]
 [ 3.05650242e-03]
 [-3.18817292e-02]
 [-1.02209641e-02]
 [ 2.26634129e-02]
 [-4.66050800e-03]
 [-2.88538908e-02]
 [ 6.13569403e-03]
 [ 1.60385227e-02]
 [ 6.68992536e-03]
 [ 1.83787286e-02]
 [ 4.22990338e-03]
 [ 1.60677809e-04]
 [ 1.99305697e-02]
 [-2.95381201e-02]
 [ 9.18806261e-02]
 [-5.55710786e-03]
 [ 3.50463211e-02]
 [ 1.45406817e-02]
 [-1.88119037e-02]
 [-2.60870835e-02]
 [-1.12802243e-01]
 [ 2.34099915e-02]
 [-1.18896328e-02]
 [ 1.11208133e-01]
 [ 4.70246422e-02]
 [ 6.22422171e-03]
 [ 3.40866893e-02]
 [-6.44848879e-03]
 [ 4.81720160e-02]
 [-1.09956793e-01]
 [ 3.10074387e-02]
 [ 7.94626562e-03]
 [ 5.51585003e-03]
 [-2.15441274e-02]
 [ 6.82127285e-04]
 [ 5.77129130e-03]
 [-4.24094755e-03]
 [-3.19827285e-03]
 [-5.89006828e-03]
 [-3.29670915e-02]
 [-6.39917821e-03]
 [-1.51194791e-02]
 [ 1.70071764e-02]
 [ 2.28277093e-03]
 [-1.55489837e-03]
 [-5.23803793e-03]
 [-7.54691209e-03]
 [ 8.99447209e-03]
 [-1.19737479e-02]
 [ 1.46062840e-02]
 [ 1.49532500e-02]
 [ 2.08926140e-02]
 [-9.23890989e-03]
 [ 1.18986339e-02]
 [ 3.46331377e-02]
 [ 3.28050964e-03]
 [-1.48623931e-02]
 [-5.76511902e-03]
 [ 4.28939728e-03]
 [ 1.32453978e-02]
 [ 2.89541471e-02]
 [ 8.35533558e-03]
 [-4.65912444e-02]
 [-2.05868543e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.42657843]
curr_Stock_Price:  100.51761325564819
curr_Factors:  [100.51761326]
mat_Sqrt:  [[0.15]]
grads:  [-0.02727564]
Stock Position:  -0.027275639802076205
Bond Position:  [16.16826064]


portfolio before change:  [13.42270293]
curr_Stock_Price:  100.69674932356892
curr_Factors:  [100.69674932]
mat_Sqrt:  [[0.15]]
grads:  [0.20025062]
Stock Position:  0.20025062068563612
Bond Position:  [-6.74188362]


portfolio before change:  [13.39542389]
curr_Stock_Price:  100.56262910795274
curr_Factors:  [100.56262911]
mat_Sqrt:  [[0.15]]
grads:  [0.14156599]
Stock Position:  0.14156599273197767
Bond Position:  [-0.84082453]


portfolio before change:  [13.33239608]
curr_Stock_Price:  100.11778172457471
curr_Factors:  [100.11778172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368145]
Stock Position:  -0.04368144578034957
Bond Position:  [17.70568553]


portfolio before change:  [13.36174951]
curr_Stock_Price:  99.47112743498768
curr_Factors:  [99.47112743]
mat_Sqrt:  [[0.15]]
grads:  [0.09355834]
Stock Position:  0.09355833675318896
Bond Position:  [4.05539627]


portfolio before change:  [13.41142491]
curr_Stock_Price:  99.99937459070351
curr_Factors:  [99.99937459]
mat_Sqrt:  [[0.15]]
grads:  [-0.04014633]
Stock Position:  -0.04014633372465405
Bond Position:  [17.42603317]


portfolio before change:  [13.41579907]
curr_Stock_Price:  99.91754881469474
curr_Factors:  [99.91754881]
mat_Sqrt:  [[0.15]]
grads:  [0.01611713]
Stock Position:  0.016117129540922384
Bond Position:  [11.80541499]


portfolio before change:  [13.42038443]
curr_Stock_Price:  100.15626954369175
curr_Factors:  [100.15626954]
mat_Sqrt:  [[0.15]]
grads:  [-0.06093678]
Stock Position:  -0.060936776270429406
Bond Position:  [19.52358462]


portfolio before change:  [13.44974351]
curr_Stock_Price:  99.69449885591338
curr_Factors:  [99.69449886]
mat_Sqrt:  [[0.15]]
grads:  [-0.06691468]
Stock Position:  -0.06691468023439057
Bond Position:  [20.12076902]


portfolio before change:  [13.47640921]
curr_Stock_Price:  99.31478974033868
curr_Factors:  [99.31478974]
mat_Sqrt:  [[0.15]]
grads:  [-0.06403546]
Stock Position:  -0.06403545741131164
Bond Position:  [19.8360772]


portfolio before change:  [13.48258172]
curr_Stock_Price:  99.23775864016628
curr_Factors:  [99.23775864]
mat_Sqrt:  [[0.15]]
grads:  [0.08955523]
Stock Position:  0.08955523477568077
Bond Position:  [4.59532095]


portfolio before change:  [13.4528746]
curr_Stock_Price:  98.90283306194624
curr_Factors:  [98.90283306]
mat_Sqrt:  [[0.15]]
grads:  [-0.05241257]
Stock Position:  -0.052412570063499545
Bond Position:  [18.63662627]


portfolio before change:  [13.48230513]
curr_Stock_Price:  98.36354061428807
curr_Factors:  [98.36354061]
mat_Sqrt:  [[0.15]]
grads:  [0.01253869]
Stock Position:  0.012538691300270466
Bond Position:  [12.24895506]


portfolio before change:  [13.47708549]
curr_Stock_Price:  97.88620068965143
curr_Factors:  [97.88620069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03067455]
Stock Position:  -0.030674549103643714
Bond Position:  [16.47970056]


portfolio before change:  [13.49492075]
curr_Stock_Price:  97.33834457999463
curr_Factors:  [97.33834458]
mat_Sqrt:  [[0.15]]
grads:  [0.01346258]
Stock Position:  0.013462580339999529
Bond Position:  [12.18449546]


portfolio before change:  [13.49819168]
curr_Stock_Price:  97.52474107128765
curr_Factors:  [97.52474107]
mat_Sqrt:  [[0.15]]
grads:  [0.02037668]
Stock Position:  0.02037668279258699
Bond Position:  [11.51096097]


portfolio before change:  [13.49005389]
curr_Stock_Price:  97.09006525105214
curr_Factors:  [97.09006525]
mat_Sqrt:  [[0.15]]
grads:  [-0.21254486]
Stock Position:  -0.21254486139969317
Bond Position:  [34.12604835]


portfolio before change:  [13.59921604]
curr_Stock_Price:  96.58650467474648
curr_Factors:  [96.58650467]
mat_Sqrt:  [[0.15]]
grads:  [-0.06813976]
Stock Position:  -0.06813976040075295
Bond Position:  [20.18059733]


portfolio before change:  [13.65146238]
curr_Stock_Price:  95.83826301280466
curr_Factors:  [95.83826301]
mat_Sqrt:  [[0.15]]
grads:  [0.15108942]
Stock Position:  0.15108941937314685
Bond Position:  [-0.82868513]


portfolio before change:  [13.71483381]
curr_Stock_Price:  96.25803580755732
curr_Factors:  [96.25803581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107005]
Stock Position:  -0.031070053346624535
Bond Position:  [16.70557612]


portfolio before change:  [13.7343541]
curr_Stock_Price:  95.66337455331434
curr_Factors:  [95.66337455]
mat_Sqrt:  [[0.15]]
grads:  [-0.19235927]
Stock Position:  -0.19235927217625207
Bond Position:  [32.1360912]


portfolio before change:  [13.70278623]
curr_Stock_Price:  95.8379252386011
curr_Factors:  [95.83792524]
mat_Sqrt:  [[0.15]]
grads:  [0.04090463]
Stock Position:  0.04090462688403947
Bond Position:  [9.78257165]


portfolio before change:  [13.67918819]
curr_Stock_Price:  95.24607376435146
curr_Factors:  [95.24607376]
mat_Sqrt:  [[0.15]]
grads:  [0.10692348]
Stock Position:  0.10692348480906193
Bond Position:  [3.49514607]


portfolio before change:  [13.69357118]
curr_Stock_Price:  95.37854728432109
curr_Factors:  [95.37854728]
mat_Sqrt:  [[0.15]]
grads:  [0.0445995]
Stock Position:  0.04459950239018122
Bond Position:  [9.43973543]


portfolio before change:  [13.67678509]
curr_Stock_Price:  94.98894461571096
curr_Factors:  [94.98894462]
mat_Sqrt:  [[0.15]]
grads:  [0.12252486]
Stock Position:  0.12252485762632127
Bond Position:  [2.03827818]


portfolio before change:  [13.6668683]
curr_Stock_Price:  94.90696787876674
curr_Factors:  [94.90696788]
mat_Sqrt:  [[0.15]]
grads:  [0.02819936]
Stock Position:  0.028199355861935387
Bond Position:  [10.99055294]


portfolio before change:  [13.69016432]
curr_Stock_Price:  95.70872694186579
curr_Factors:  [95.70872694]
mat_Sqrt:  [[0.15]]
grads:  [0.00107119]
Stock Position:  0.00107118539069555
Bond Position:  [13.58764253]


portfolio before change:  [13.69069465]
curr_Stock_Price:  95.41099245411597
curr_Factors:  [95.41099245]
mat_Sqrt:  [[0.15]]
grads:  [0.13287046]
Stock Position:  0.13287046464519256
Bond Position:  [1.01339175]


portfolio before change:  [13.6188017]
curr_Stock_Price:  94.86944031707299
curr_Factors:  [94.86944032]
mat_Sqrt:  [[0.15]]
grads:  [-0.1969208]
Stock Position:  -0.19692080066351952
Bond Position:  [32.30056785]


portfolio before change:  [13.66534822]
curr_Stock_Price:  94.64332060592304
curr_Factors:  [94.64332061]
mat_Sqrt:  [[0.15]]
grads:  [0.61253751]
Stock Position:  0.61253750736861
Bond Position:  [-44.30723547]


portfolio before change:  [13.21863311]
curr_Stock_Price:  93.91855547891002
curr_Factors:  [93.91855548]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704739]
Stock Position:  -0.037047385736765984
Bond Position:  [16.69807006]


portfolio before change:  [13.22721212]
curr_Stock_Price:  93.71515805882811
curr_Factors:  [93.71515806]
mat_Sqrt:  [[0.15]]
grads:  [0.23364214]
Stock Position:  0.23364214082805854
Bond Position:  [-8.66859804]


portfolio before change:  [13.29377752]
curr_Stock_Price:  94.0023802678472
curr_Factors:  [94.00238027]
mat_Sqrt:  [[0.15]]
grads:  [0.09693788]
Stock Position:  0.09693787781611843
Bond Position:  [4.18138627]


portfolio before change:  [13.23840346]
curr_Stock_Price:  93.42845181208334
curr_Factors:  [93.42845181]
mat_Sqrt:  [[0.15]]
grads:  [-0.12541269]
Stock Position:  -0.12541269130923696
Bond Position:  [24.95551705]


portfolio before change:  [13.34523274]
curr_Stock_Price:  92.58906696520845
curr_Factors:  [92.58906697]
mat_Sqrt:  [[0.15]]
grads:  [-0.17391389]
Stock Position:  -0.17391388999113375
Bond Position:  [29.44775755]


portfolio before change:  [13.27921934]
curr_Stock_Price:  92.97922523897746
curr_Factors:  [92.97922524]
mat_Sqrt:  [[0.15]]
grads:  [-0.75201495]
Stock Position:  -0.7520149510121177
Bond Position:  [83.20098685]


portfolio before change:  [13.42673319]
curr_Stock_Price:  92.78998216018744
curr_Factors:  [92.78998216]
mat_Sqrt:  [[0.15]]
grads:  [0.15606661]
Stock Position:  0.15606660995928878
Bond Position:  [-1.05468476]


portfolio before change:  [13.42537416]
curr_Stock_Price:  92.7816965458188
curr_Factors:  [92.78169655]
mat_Sqrt:  [[0.15]]
grads:  [-0.07926422]
Stock Position:  -0.07926421843258365
Bond Position:  [20.77964282]


portfolio before change:  [13.46812666]
curr_Stock_Price:  92.25871499099905
curr_Factors:  [92.25871499]
mat_Sqrt:  [[0.15]]
grads:  [0.74138755]
Stock Position:  0.7413875540287037
Bond Position:  [-54.93133639]


portfolio before change:  [13.41636677]
curr_Stock_Price:  92.19353103600875
curr_Factors:  [92.19353104]
mat_Sqrt:  [[0.15]]
grads:  [0.31349761]
Stock Position:  0.31349761460346204
Bond Position:  [-15.4860853]


portfolio before change:  [13.46884838]
curr_Stock_Price:  92.36402524145402
curr_Factors:  [92.36402524]
mat_Sqrt:  [[0.15]]
grads:  [0.04149481]
Stock Position:  0.04149481137338541
Bond Position:  [9.63622058]


portfolio before change:  [13.47872003]
curr_Stock_Price:  92.58741146736486
curr_Factors:  [92.58741147]
mat_Sqrt:  [[0.15]]
grads:  [0.2272446]
Stock Position:  0.22724459521017695
Bond Position:  [-7.56126881]


portfolio before change:  [13.30353575]
curr_Stock_Price:  91.81858484718666
curr_Factors:  [91.81858485]
mat_Sqrt:  [[0.15]]
grads:  [-0.04298993]
Stock Position:  -0.042989925283816934
Bond Position:  [17.25080985]


portfolio before change:  [13.28050906]
curr_Stock_Price:  92.37929513098193
curr_Factors:  [92.37929513]
mat_Sqrt:  [[0.15]]
grads:  [0.32114677]
Stock Position:  0.32114677351155724
Bond Position:  [-16.38680351]


portfolio before change:  [13.25051927]
curr_Stock_Price:  92.28910090297563
curr_Factors:  [92.2891009]
mat_Sqrt:  [[0.15]]
grads:  [-0.73304529]
Stock Position:  -0.7330452876111574
Bond Position:  [80.90260978]


portfolio before change:  [13.38291146]
curr_Stock_Price:  92.11539319135879
curr_Factors:  [92.11539319]
mat_Sqrt:  [[0.15]]
grads:  [0.20671626]
Stock Position:  0.20671625780438377
Bond Position:  [-5.65883791]


portfolio before change:  [13.47755515]
curr_Stock_Price:  92.5749476662256
curr_Factors:  [92.57494767]
mat_Sqrt:  [[0.15]]
grads:  [0.0529751]
Stock Position:  0.05297510412824382
Bond Position:  [8.57338766]


portfolio before change:  [13.45386874]
curr_Stock_Price:  92.11770890575752
curr_Factors:  [92.11770891]
mat_Sqrt:  [[0.15]]
grads:  [0.03677233]
Stock Position:  0.03677233355015454
Bond Position:  [10.06648562]


portfolio before change:  [13.472452]
curr_Stock_Price:  92.60595888717614
curr_Factors:  [92.60595889]
mat_Sqrt:  [[0.15]]
grads:  [-0.14362752]
Stock Position:  -0.14362751609282748
Bond Position:  [26.77321585]


portfolio before change:  [13.50974283]
curr_Stock_Price:  92.35797402080392
curr_Factors:  [92.35797402]
mat_Sqrt:  [[0.15]]
grads:  [0.00454752]
Stock Position:  0.00454751523531042
Bond Position:  [13.08974354]


portfolio before change:  [13.50765121]
curr_Stock_Price:  91.71811897310955
curr_Factors:  [91.71811897]
mat_Sqrt:  [[0.15]]
grads:  [0.03847528]
Stock Position:  0.03847527531044907
Bond Position:  [9.97877134]


portfolio before change:  [13.50736694]
curr_Stock_Price:  91.69452017568551
curr_Factors:  [91.69452018]
mat_Sqrt:  [[0.15]]
grads:  [-0.02827298]
Stock Position:  -0.028272983637845132
Bond Position:  [16.09984461]


portfolio before change:  [13.51697235]
curr_Stock_Price:  91.3903730804033
curr_Factors:  [91.39037308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02132182]
Stock Position:  -0.021321818994180872
Bond Position:  [15.46558135]


portfolio before change:  [13.51936246]
curr_Stock_Price:  91.3236113916588
curr_Factors:  [91.32361139]
mat_Sqrt:  [[0.15]]
grads:  [-0.03926712]
Stock Position:  -0.03926712186174043
Bond Position:  [17.10537784]


portfolio before change:  [13.545354]
curr_Stock_Price:  90.68892236724649
curr_Factors:  [90.68892237]
mat_Sqrt:  [[0.15]]
grads:  [-0.21978061]
Stock Position:  -0.2197806101171244
Bond Position:  [33.47702068]


portfolio before change:  [13.58155204]
curr_Stock_Price:  90.53374188351987
curr_Factors:  [90.53374188]
mat_Sqrt:  [[0.15]]
grads:  [-0.04266119]
Stock Position:  -0.042661188096411604
Bond Position:  [17.44382903]


portfolio before change:  [13.61914364]
curr_Stock_Price:  89.67813196908317
curr_Factors:  [89.67813197]
mat_Sqrt:  [[0.15]]
grads:  [-0.10079653]
Stock Position:  -0.10079652736807056
Bond Position:  [22.65838793]


portfolio before change:  [13.6095547]
curr_Stock_Price:  89.78731370983732
curr_Factors:  [89.78731371]
mat_Sqrt:  [[0.15]]
grads:  [0.11338118]
Stock Position:  0.11338117616740143
Bond Position:  [3.42936346]


portfolio before change:  [13.58687406]
curr_Stock_Price:  89.58538445337994
curr_Factors:  [89.58538445]
mat_Sqrt:  [[0.15]]
grads:  [0.01521847]
Stock Position:  0.015218472883258668
Bond Position:  [12.22352132]


portfolio before change:  [13.59445243]
curr_Stock_Price:  90.03315446562982
curr_Factors:  [90.03315447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01036599]
Stock Position:  -0.010365989121312494
Bond Position:  [14.52773513]


portfolio before change:  [13.5970724]
curr_Stock_Price:  89.86800375622136
curr_Factors:  [89.86800376]
mat_Sqrt:  [[0.15]]
grads:  [-0.03492025]
Stock Position:  -0.03492025286955412
Bond Position:  [16.73528581]


portfolio before change:  [13.60419993]
curr_Stock_Price:  89.69384857487066
curr_Factors:  [89.69384857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05031275]
Stock Position:  -0.050312747277117875
Bond Position:  [18.11694386]


portfolio before change:  [13.62109249]
curr_Stock_Price:  89.38060348008196
curr_Factors:  [89.38060348]
mat_Sqrt:  [[0.15]]
grads:  [0.05996315]
Stock Position:  0.059963147291457235
Bond Position:  [8.2615502]


portfolio before change:  [13.67574203]
curr_Stock_Price:  90.28337757712494
curr_Factors:  [90.28337758]
mat_Sqrt:  [[0.15]]
grads:  [-0.07982499]
Stock Position:  -0.0798249858962488
Bond Position:  [20.88261137]


portfolio before change:  [13.65440371]
curr_Stock_Price:  90.56704222578887
curr_Factors:  [90.56704223]
mat_Sqrt:  [[0.15]]
grads:  [0.09737523]
Stock Position:  0.09737522650030603
Bond Position:  [4.83541746]


portfolio before change:  [13.63033597]
curr_Stock_Price:  90.31677362065524
curr_Factors:  [90.31677362]
mat_Sqrt:  [[0.15]]
grads:  [0.09968833]
Stock Position:  0.09968833360494278
Bond Position:  [4.62680731]


portfolio before change:  [13.62326262]
curr_Stock_Price:  90.24291814303139
curr_Factors:  [90.24291814]
mat_Sqrt:  [[0.15]]
grads:  [0.13928409]
Stock Position:  0.1392840934048526
Bond Position:  [1.05385958]


portfolio before change:  [13.63127384]
curr_Stock_Price:  90.29996231373859
curr_Factors:  [90.29996231]
mat_Sqrt:  [[0.15]]
grads:  [-0.06159273]
Stock Position:  -0.061592732627573796
Bond Position:  [19.19309527]


portfolio before change:  [13.59338821]
curr_Stock_Price:  90.93453777011929
curr_Factors:  [90.93453777]
mat_Sqrt:  [[0.15]]
grads:  [0.07932423]
Stock Position:  0.07932422586105037
Bond Position:  [6.3800764]


portfolio before change:  [13.54948851]
curr_Stock_Price:  90.37608970117738
curr_Factors:  [90.3760897]
mat_Sqrt:  [[0.15]]
grads:  [0.23088758]
Stock Position:  0.2308875845407797
Bond Position:  [-7.31722854]


portfolio before change:  [13.78068708]
curr_Stock_Price:  91.37941738932761
curr_Factors:  [91.37941739]
mat_Sqrt:  [[0.15]]
grads:  [0.02187006]
Stock Position:  0.021870064271577613
Bond Position:  [11.78221335]


portfolio before change:  [13.77569737]
curr_Stock_Price:  91.11759288552302
curr_Factors:  [91.11759289]
mat_Sqrt:  [[0.15]]
grads:  [-0.09908262]
Stock Position:  -0.09908262040143737
Bond Position:  [22.80386724]


portfolio before change:  [13.79839088]
curr_Stock_Price:  90.90294150479464
curr_Factors:  [90.9029415]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843413]
Stock Position:  -0.038434126779552755
Bond Position:  [17.29216606]


portfolio before change:  [13.80007781]
curr_Stock_Price:  90.88717063405122
curr_Factors:  [90.88717063]
mat_Sqrt:  [[0.15]]
grads:  [0.02859598]
Stock Position:  0.02859598186609765
Bond Position:  [11.20106993]


portfolio before change:  [13.79502534]
curr_Stock_Price:  90.68600384564782
curr_Factors:  [90.68600385]
mat_Sqrt:  [[0.15]]
grads:  [0.08830265]
Stock Position:  0.08830265209397263
Bond Position:  [5.78721069]


portfolio before change:  [13.8157193]
curr_Stock_Price:  90.91626016283797
curr_Factors:  [90.91626016]
mat_Sqrt:  [[0.15]]
grads:  [0.19302765]
Stock Position:  0.1930276474733229
Bond Position:  [-3.73363252]


portfolio before change:  [13.88436097]
curr_Stock_Price:  91.27307452386974
curr_Factors:  [91.27307452]
mat_Sqrt:  [[0.15]]
grads:  [0.05570224]
Stock Position:  0.05570223718517019
Bond Position:  [8.80024653]


portfolio before change:  [13.86211557]
curr_Stock_Price:  90.86383719425348
curr_Factors:  [90.86383719]
mat_Sqrt:  [[0.15]]
grads:  [-0.3106083]
Stock Position:  -0.31060829615656477
Bond Position:  [42.08517722]


portfolio before change:  [13.80616809]
curr_Stock_Price:  91.05242805201188
curr_Factors:  [91.05242805]
mat_Sqrt:  [[0.15]]
grads:  [-0.1372457]
Stock Position:  -0.1372456952222431
Bond Position:  [26.30272188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.84493984]
Stock Price:  90.7819075676174
PL:  [13.84493984]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.36018504e-03]
 [ 6.05021957e-02]
 [ 1.87444949e-02]
 [-3.71407983e-02]
 [-5.28842444e-02]
 [-3.14673092e-03]
 [ 2.64772166e-02]
 [-5.31474862e-02]
 [ 1.79148689e-02]
 [-7.14524837e-03]
 [-1.08607425e-02]
 [ 2.00031699e-02]
 [-4.55353901e-03]
 [ 3.10600393e-03]
 [ 2.25575988e-04]
 [ 1.44920076e-02]
 [ 9.73949249e-02]
 [-1.19503673e-02]
 [ 2.36787074e-02]
 [ 1.40134962e-03]
 [-4.05148166e-03]
 [ 5.35959432e-03]
 [ 7.17030522e-03]
 [ 2.10785226e-02]
 [-4.14865189e-03]
 [ 4.82941874e-03]
 [-6.38446760e-03]
 [ 5.35329489e-03]
 [ 3.12726842e-02]
 [ 7.97343245e-04]
 [-7.61424162e-03]
 [ 1.01269503e-02]
 [ 1.25988456e-02]
 [ 8.68746238e-03]
 [ 5.72054993e-03]
 [ 2.80869849e-03]
 [-1.65364344e-02]
 [-4.97431194e-03]
 [-1.30344008e-02]
 [-1.49828713e-02]
 [ 3.97662856e-03]
 [ 1.05579571e-02]
 [-8.01702364e-03]
 [-2.59019178e-05]
 [ 7.68448453e-03]
 [ 1.23481421e-02]
 [ 1.06302613e-02]
 [ 2.16578829e-03]
 [ 1.27614493e-02]
 [-1.54721262e-03]
 [ 6.28077686e-03]
 [-1.48906843e-02]
 [ 2.14614379e-03]
 [ 1.39542040e-03]
 [-4.06496396e-03]
 [-3.86208101e-03]
 [ 9.79260615e-03]
 [-2.01962873e-03]
 [ 6.93394800e-03]
 [-3.99777275e-03]
 [-1.09055871e-03]
 [ 5.99562470e-03]
 [-6.60159005e-03]
 [ 4.56757174e-03]
 [ 1.98088811e-02]
 [ 4.53600463e-03]
 [ 1.23043963e-02]
 [-1.92280459e-03]
 [ 5.33751997e-03]
 [ 2.29177509e-02]
 [ 3.39835294e-03]
 [-1.57500577e-02]
 [-5.41318092e-03]
 [ 1.35046178e-03]
 [ 4.42946503e-03]
 [-3.02608774e-03]
 [-3.94544382e-03]
 [ 8.60532731e-03]
 [-1.45795672e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.24521147]
curr_Stock_Price:  100.73646569354086
curr_Factors:  [100.73646569]
mat_Sqrt:  [[0.15]]
grads:  [-0.03573457]
Stock Position:  -0.03573456696493663
Bond Position:  [21.84498545]


portfolio before change:  [18.21442195]
curr_Stock_Price:  101.63629117777592
curr_Factors:  [101.63629118]
mat_Sqrt:  [[0.15]]
grads:  [0.40334797]
Stock Position:  0.40334797120669535
Bond Position:  [-22.7803699]


portfolio before change:  [18.08504269]
curr_Stock_Price:  101.31905777937496
curr_Factors:  [101.31905778]
mat_Sqrt:  [[0.15]]
grads:  [0.1249633]
Stock Position:  0.12496329930644165
Bond Position:  [5.42387894]


portfolio before change:  [18.16083266]
curr_Stock_Price:  101.92284281202802
curr_Factors:  [101.92284281]
mat_Sqrt:  [[0.15]]
grads:  [-0.24760532]
Stock Position:  -0.24760532200931343
Bond Position:  [43.39747097]


portfolio before change:  [18.09187255]
curr_Stock_Price:  102.2123056445014
curr_Factors:  [102.21230564]
mat_Sqrt:  [[0.15]]
grads:  [-0.35256163]
Stock Position:  -0.3525616294634284
Bond Position:  [54.12800958]


portfolio before change:  [17.63045267]
curr_Stock_Price:  103.53066518472434
curr_Factors:  [103.53066518]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097821]
Stock Position:  -0.02097820610114807
Bond Position:  [19.8023403]


portfolio before change:  [17.6413354]
curr_Stock_Price:  103.07090010915151
curr_Factors:  [103.07090011]
mat_Sqrt:  [[0.15]]
grads:  [0.17651478]
Stock Position:  0.17651477742672103
Bond Position:  [-0.55220159]


portfolio before change:  [17.55391208]
curr_Stock_Price:  102.57582087406026
curr_Factors:  [102.57582087]
mat_Sqrt:  [[0.15]]
grads:  [-0.35431657]
Stock Position:  -0.35431657461627847
Bond Position:  [53.89822557]


portfolio before change:  [17.31732788]
curr_Stock_Price:  103.25304843438144
curr_Factors:  [103.25304843]
mat_Sqrt:  [[0.15]]
grads:  [0.11943246]
Stock Position:  0.11943245908416805
Bond Position:  [4.9855624]


portfolio before change:  [17.21323962]
curr_Stock_Price:  102.37891530699233
curr_Factors:  [102.37891531]
mat_Sqrt:  [[0.15]]
grads:  [-0.04763499]
Stock Position:  -0.04763498911055142
Bond Position:  [22.09005813]


portfolio before change:  [17.21364291]
curr_Stock_Price:  102.39943333192946
curr_Factors:  [102.39943333]
mat_Sqrt:  [[0.15]]
grads:  [-0.07240495]
Stock Position:  -0.07240495026413395
Bond Position:  [24.62786879]


portfolio before change:  [17.18372142]
curr_Stock_Price:  102.83394478127755
curr_Factors:  [102.83394478]
mat_Sqrt:  [[0.15]]
grads:  [0.13335447]
Stock Position:  0.13335446628290934
Bond Position:  [3.4703556]


portfolio before change:  [17.16006347]
curr_Stock_Price:  102.65491176731771
curr_Factors:  [102.65491177]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035693]
Stock Position:  -0.030356926708109192
Bond Position:  [20.27635111]


portfolio before change:  [17.18123129]
curr_Stock_Price:  101.99936091525193
curr_Factors:  [101.99936092]
mat_Sqrt:  [[0.15]]
grads:  [0.02070669]
Stock Position:  0.02070669286388547
Bond Position:  [15.06916186]


portfolio before change:  [17.16511348]
curr_Stock_Price:  101.17548858832082
curr_Factors:  [101.17548859]
mat_Sqrt:  [[0.15]]
grads:  [0.00150384]
Stock Position:  0.0015038399170326743
Bond Position:  [17.01296174]


portfolio before change:  [17.16673697]
curr_Stock_Price:  101.5479660047784
curr_Factors:  [101.547966]
mat_Sqrt:  [[0.15]]
grads:  [0.09661338]
Stock Position:  0.09661338429670506
Bond Position:  [7.3558443]


portfolio before change:  [17.25933991]
curr_Stock_Price:  102.50169713695738
curr_Factors:  [102.50169714]
mat_Sqrt:  [[0.15]]
grads:  [0.6492995]
Stock Position:  0.6492994992055472
Bond Position:  [-49.29496071]


portfolio before change:  [17.10844918]
curr_Stock_Price:  102.27405226097717
curr_Factors:  [102.27405226]
mat_Sqrt:  [[0.15]]
grads:  [-0.07966912]
Stock Position:  -0.07966911526620724
Bond Position:  [25.25653244]


portfolio before change:  [17.06111554]
curr_Stock_Price:  102.88799434600344
curr_Factors:  [102.88799435]
mat_Sqrt:  [[0.15]]
grads:  [0.15785805]
Stock Position:  0.15785804947954382
Bond Position:  [0.81941743]


portfolio before change:  [16.85359671]
curr_Stock_Price:  101.57307857495282
curr_Factors:  [101.57307857]
mat_Sqrt:  [[0.15]]
grads:  [0.00934233]
Stock Position:  0.009342330807537547
Bond Position:  [15.90466741]


portfolio before change:  [16.85225258]
curr_Stock_Price:  101.32279755860719
curr_Factors:  [101.32279756]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700988]
Stock Position:  -0.027009877712409487
Bond Position:  [19.58896895]


portfolio before change:  [16.82584393]
curr_Stock_Price:  102.3458675212369
curr_Factors:  [102.34586752]
mat_Sqrt:  [[0.15]]
grads:  [0.03573063]
Stock Position:  0.03573062881895023
Bond Position:  [13.16896173]


portfolio before change:  [16.83461695]
curr_Stock_Price:  102.56836367795883
curr_Factors:  [102.56836368]
mat_Sqrt:  [[0.15]]
grads:  [0.04780203]
Stock Position:  0.047802034810134196
Bond Position:  [11.93164045]


portfolio before change:  [16.78347795]
curr_Stock_Price:  101.48295501933944
curr_Factors:  [101.48295502]
mat_Sqrt:  [[0.15]]
grads:  [0.14052348]
Stock Position:  0.14052348427325226
Bond Position:  [2.52273952]


portfolio before change:  [16.62240059]
curr_Stock_Price:  100.3355664351908
curr_Factors:  [100.33556644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02765768]
Stock Position:  -0.027657679238100395
Bond Position:  [19.3974495]


portfolio before change:  [16.62730486]
curr_Stock_Price:  100.20208108792292
curr_Factors:  [100.20208109]
mat_Sqrt:  [[0.15]]
grads:  [0.03219612]
Stock Position:  0.03219612493366673
Bond Position:  [13.40118614]


portfolio before change:  [16.64639313]
curr_Stock_Price:  100.76894028471025
curr_Factors:  [100.76894028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04256312]
Stock Position:  -0.04256311730756147
Bond Position:  [20.93543336]


portfolio before change:  [16.65765596]
curr_Stock_Price:  100.53506823919543
curr_Factors:  [100.53506824]
mat_Sqrt:  [[0.15]]
grads:  [0.03568863]
Stock Position:  0.03568863262906989
Bond Position:  [13.06969684]


portfolio before change:  [16.66275361]
curr_Stock_Price:  100.65501584463067
curr_Factors:  [100.65501584]
mat_Sqrt:  [[0.15]]
grads:  [0.20848456]
Stock Position:  0.20848456145546804
Bond Position:  [-4.32226323]


portfolio before change:  [16.48830277]
curr_Stock_Price:  99.81955497537628
curr_Factors:  [99.81955498]
mat_Sqrt:  [[0.15]]
grads:  [0.00531562]
Stock Position:  0.005315621631725373
Bond Position:  [15.95769978]


portfolio before change:  [16.49252819]
curr_Stock_Price:  100.426829538612
curr_Factors:  [100.42682954]
mat_Sqrt:  [[0.15]]
grads:  [-0.05076161]
Stock Position:  -0.0507616108104018
Bond Position:  [21.59035583]


portfolio before change:  [16.4757705]
curr_Stock_Price:  100.78353866480423
curr_Factors:  [100.78353866]
mat_Sqrt:  [[0.15]]
grads:  [0.067513]
Stock Position:  0.06751300194779161
Bond Position:  [9.67157126]


portfolio before change:  [16.49561412]
curr_Stock_Price:  101.0685077760375
curr_Factors:  [101.06850778]
mat_Sqrt:  [[0.15]]
grads:  [0.0839923]
Stock Position:  0.08399230396036296
Bond Position:  [8.00663729]


portfolio before change:  [16.51220397]
curr_Stock_Price:  101.26006609547778
curr_Factors:  [101.2600661]
mat_Sqrt:  [[0.15]]
grads:  [0.05791642]
Stock Position:  0.05791641586006172
Bond Position:  [10.64758387]


portfolio before change:  [16.58126942]
curr_Stock_Price:  102.44107757710384
curr_Factors:  [102.44107758]
mat_Sqrt:  [[0.15]]
grads:  [0.038137]
Stock Position:  0.03813699955928975
Bond Position:  [12.67447409]


portfolio before change:  [16.61487525]
curr_Stock_Price:  103.30149282083576
curr_Factors:  [103.30149282]
mat_Sqrt:  [[0.15]]
grads:  [0.01872466]
Stock Position:  0.01872465658209174
Bond Position:  [14.68059028]


portfolio before change:  [16.61325261]
curr_Stock_Price:  103.16583142417596
curr_Factors:  [103.16583142]
mat_Sqrt:  [[0.15]]
grads:  [-0.1102429]
Stock Position:  -0.11024289569748968
Bond Position:  [27.9865526]


portfolio before change:  [16.64759818]
curr_Stock_Price:  102.87015382249086
curr_Factors:  [102.87015382]
mat_Sqrt:  [[0.15]]
grads:  [-0.03316208]
Stock Position:  -0.03316207961024692
Bond Position:  [20.05898641]


portfolio before change:  [16.6198064]
curr_Stock_Price:  103.74601876417258
curr_Factors:  [103.74601876]
mat_Sqrt:  [[0.15]]
grads:  [-0.08689601]
Stock Position:  -0.08689600528596375
Bond Position:  [25.63492099]


portfolio before change:  [16.69259768]
curr_Stock_Price:  102.92677460687608
curr_Factors:  [102.92677461]
mat_Sqrt:  [[0.15]]
grads:  [-0.09988581]
Stock Position:  -0.09988580890349086
Bond Position:  [26.97352181]


portfolio before change:  [16.71902138]
curr_Stock_Price:  102.67911374043362
curr_Factors:  [102.67911374]
mat_Sqrt:  [[0.15]]
grads:  [0.02651086]
Stock Position:  0.02651085709034411
Bond Position:  [13.99691007]


portfolio before change:  [16.72110586]
curr_Stock_Price:  102.72474215895348
curr_Factors:  [102.72474216]
mat_Sqrt:  [[0.15]]
grads:  [0.07038638]
Stock Position:  0.07038638056522577
Bond Position:  [9.49068307]


portfolio before change:  [16.7262027]
curr_Stock_Price:  102.7887268516395
curr_Factors:  [102.78872685]
mat_Sqrt:  [[0.15]]
grads:  [-0.05344682]
Stock Position:  -0.05344682428860512
Bond Position:  [22.21993372]


portfolio before change:  [16.73148643]
curr_Stock_Price:  102.71585179872375
curr_Factors:  [102.7158518]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017268]
Stock Position:  -0.00017267945204534353
Bond Position:  [16.74922335]


portfolio before change:  [16.73250636]
curr_Stock_Price:  102.8718111685662
curr_Factors:  [102.87181117]
mat_Sqrt:  [[0.15]]
grads:  [0.0512299]
Stock Position:  0.051229896853763314
Bond Position:  [11.46239408]


portfolio before change:  [16.70070312]
curr_Stock_Price:  102.237032177721
curr_Factors:  [102.23703218]
mat_Sqrt:  [[0.15]]
grads:  [0.08232095]
Stock Position:  0.08232094714850344
Bond Position:  [8.28445379]


portfolio before change:  [16.67234949]
curr_Stock_Price:  101.88631443772059
curr_Factors:  [101.88631444]
mat_Sqrt:  [[0.15]]
grads:  [0.07086841]
Stock Position:  0.07086840882256919
Bond Position:  [9.45182851]


portfolio before change:  [16.64751323]
curr_Stock_Price:  101.52752232923176
curr_Factors:  [101.52752233]
mat_Sqrt:  [[0.15]]
grads:  [0.01443859]
Stock Position:  0.01443858859307783
Bond Position:  [15.1815991]


portfolio before change:  [16.64572966]
curr_Stock_Price:  101.33827640910125
curr_Factors:  [101.33827641]
mat_Sqrt:  [[0.15]]
grads:  [0.08507633]
Stock Position:  0.08507632858924498
Bond Position:  [8.02424116]


portfolio before change:  [16.60263789]
curr_Stock_Price:  100.82587409802721
curr_Factors:  [100.8258741]
mat_Sqrt:  [[0.15]]
grads:  [-0.01031475]
Stock Position:  -0.010314750778872039
Bond Position:  [17.64263165]


portfolio before change:  [16.60413955]
curr_Stock_Price:  100.78719452289076
curr_Factors:  [100.78719452]
mat_Sqrt:  [[0.15]]
grads:  [0.04187185]
Stock Position:  0.04187184575079519
Bond Position:  [12.38399369]


portfolio before change:  [16.61274115]
curr_Stock_Price:  100.9741356023584
curr_Factors:  [100.9741356]
mat_Sqrt:  [[0.15]]
grads:  [-0.09927123]
Stock Position:  -0.09927122845313724
Bond Position:  [26.63656763]


portfolio before change:  [16.63293782]
curr_Stock_Price:  100.78745674321314
curr_Factors:  [100.78745674]
mat_Sqrt:  [[0.15]]
grads:  [0.01430763]
Stock Position:  0.01430762528326174
Bond Position:  [15.19090866]


portfolio before change:  [16.62682859]
curr_Stock_Price:  100.2941047483439
curr_Factors:  [100.29410475]
mat_Sqrt:  [[0.15]]
grads:  [0.0093028]
Stock Position:  0.009302802671933853
Bond Position:  [15.69381232]


portfolio before change:  [16.62993197]
curr_Stock_Price:  100.52226014251664
curr_Factors:  [100.52226014]
mat_Sqrt:  [[0.15]]
grads:  [-0.02709976]
Stock Position:  -0.027099759743564752
Bond Position:  [19.35406107]


portfolio before change:  [16.62938201]
curr_Stock_Price:  100.58719153051679
curr_Factors:  [100.58719153]
mat_Sqrt:  [[0.15]]
grads:  [-0.02574721]
Stock Position:  -0.025747206726594096
Bond Position:  [19.21922122]


portfolio before change:  [16.61726407]
curr_Stock_Price:  101.10449744160233
curr_Factors:  [101.10449744]
mat_Sqrt:  [[0.15]]
grads:  [0.06528404]
Stock Position:  0.06528404098129371
Bond Position:  [10.01675391]


portfolio before change:  [16.61678989]
curr_Stock_Price:  101.08764430943388
curr_Factors:  [101.08764431]
mat_Sqrt:  [[0.15]]
grads:  [-0.01346419]
Stock Position:  -0.013464191557836456
Bond Position:  [17.9778533]


portfolio before change:  [16.61942658]
curr_Stock_Price:  100.97526923853161
curr_Factors:  [100.97526924]
mat_Sqrt:  [[0.15]]
grads:  [0.04622632]
Stock Position:  0.04622631999879522
Bond Position:  [11.95171148]


portfolio before change:  [16.63620588]
curr_Stock_Price:  101.32209101724112
curr_Factors:  [101.32209102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665182]
Stock Position:  -0.026651818309950358
Bond Position:  [19.33662384]


portfolio before change:  [16.65053875]
curr_Stock_Price:  100.82965590670513
curr_Factors:  [100.82965591]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727039]
Stock Position:  -0.007270391394213581
Bond Position:  [17.38360981]


portfolio before change:  [16.65357084]
curr_Stock_Price:  100.56205262098726
curr_Factors:  [100.56205262]
mat_Sqrt:  [[0.15]]
grads:  [0.03997083]
Stock Position:  0.03997083135863304
Bond Position:  [12.63402199]


portfolio before change:  [16.60369742]
curr_Stock_Price:  99.2945515570585
curr_Factors:  [99.29455156]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440106]
Stock Position:  -0.044010600318565685
Bond Position:  [20.97371024]


portfolio before change:  [16.61903283]
curr_Stock_Price:  98.97588952094776
curr_Factors:  [98.97588952]
mat_Sqrt:  [[0.15]]
grads:  [0.03045048]
Stock Position:  0.030450478253103083
Bond Position:  [13.60516965]


portfolio before change:  [16.6235644]
curr_Stock_Price:  99.09678158746233
curr_Factors:  [99.09678159]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [3.536922]


portfolio before change:  [16.53656115]
curr_Stock_Price:  98.43628763388061
curr_Factors:  [98.43628763]
mat_Sqrt:  [[0.15]]
grads:  [0.03024003]
Stock Position:  0.030240030833556798
Bond Position:  [13.55984478]


portfolio before change:  [16.5101761]
curr_Stock_Price:  97.5357406596681
curr_Factors:  [97.53574066]
mat_Sqrt:  [[0.15]]
grads:  [0.08202931]
Stock Position:  0.08202930847051075
Bond Position:  [8.50938674]


portfolio before change:  [16.45143803]
curr_Stock_Price:  96.81319499642225
curr_Factors:  [96.813195]
mat_Sqrt:  [[0.15]]
grads:  [-0.0128187]
Stock Position:  -0.012818697249318568
Bond Position:  [17.69245707]


portfolio before change:  [16.4579954]
curr_Stock_Price:  96.3879134505051
curr_Factors:  [96.38791345]
mat_Sqrt:  [[0.15]]
grads:  [0.03558347]
Stock Position:  0.0355834664402634
Bond Position:  [13.02817932]


portfolio before change:  [16.50614809]
curr_Stock_Price:  97.7182617150502
curr_Factors:  [97.71826172]
mat_Sqrt:  [[0.15]]
grads:  [0.15278501]
Stock Position:  0.15278500572853598
Bond Position:  [1.57626292]


portfolio before change:  [16.53889519]
curr_Stock_Price:  97.93195135960102
curr_Factors:  [97.93195136]
mat_Sqrt:  [[0.15]]
grads:  [0.02265569]
Stock Position:  0.02265568628983467
Bond Position:  [14.32017962]


portfolio before change:  [16.54043367]
curr_Stock_Price:  97.96035262458646
curr_Factors:  [97.96035262]
mat_Sqrt:  [[0.15]]
grads:  [-0.10500038]
Stock Position:  -0.10500038446991043
Bond Position:  [26.82630836]


portfolio before change:  [16.5671818]
curr_Stock_Price:  97.7215779467351
curr_Factors:  [97.72157795]
mat_Sqrt:  [[0.15]]
grads:  [-0.03608787]
Stock Position:  -0.03608787282590937
Bond Position:  [20.09374568]


portfolio before change:  [16.57540741]
curr_Stock_Price:  97.5284465086677
curr_Factors:  [97.52844651]
mat_Sqrt:  [[0.15]]
grads:  [0.00900308]
Stock Position:  0.009003078532631348
Bond Position:  [15.69735114]


portfolio before change:  [16.58787696]
curr_Stock_Price:  98.80450381919395
curr_Factors:  [98.80450382]
mat_Sqrt:  [[0.15]]
grads:  [0.02952977]
Stock Position:  0.029529766834862158
Bond Position:  [13.670203]


portfolio before change:  [16.61708805]
curr_Stock_Price:  99.76477804474814
curr_Factors:  [99.76477804]
mat_Sqrt:  [[0.15]]
grads:  [-0.02017392]
Stock Position:  -0.02017391823961108
Bond Position:  [18.62973453]


portfolio before change:  [16.61499116]
curr_Stock_Price:  99.92643661837266
curr_Factors:  [99.92643662]
mat_Sqrt:  [[0.15]]
grads:  [-0.02630296]
Stock Position:  -0.026302958803045767
Bond Position:  [19.24335211]


portfolio before change:  [16.61712978]
curr_Stock_Price:  99.89085597759292
curr_Factors:  [99.89085598]
mat_Sqrt:  [[0.15]]
grads:  [0.05736885]
Stock Position:  0.057368848761694034
Bond Position:  [10.88650637]


portfolio before change:  [16.67208888]
curr_Stock_Price:  100.83699079424885
curr_Factors:  [100.83699079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09719711]
Stock Position:  -0.09719711484430758
Bond Position:  [26.47315345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.76623691]
Stock Price:  99.88538427437928
PL:  [16.76623691]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38363500e-02]
 [ 6.71975784e-03]
 [ 7.44907421e-03]
 [-1.71823024e-02]
 [-7.82500964e-03]
 [-1.14188815e-03]
 [ 9.01719200e-03]
 [-4.74706298e-02]
 [ 1.70017385e-02]
 [-7.41090031e-03]
 [-1.07179202e-02]
 [ 1.47946327e-02]
 [-4.45795204e-03]
 [ 5.38484251e-03]
 [ 1.00484255e-02]
 [ 1.06577933e-02]
 [ 9.69611701e-02]
 [-1.10206387e-02]
 [ 2.33772290e-02]
 [ 1.82016900e-04]
 [-8.21463224e-03]
 [ 7.16745686e-03]
 [-2.33933304e-03]
 [ 5.64575168e-02]
 [ 4.86352000e-03]
 [ 6.37666081e-03]
 [ 6.39407236e-02]
 [ 2.81928580e-02]
 [ 1.04615205e-02]
 [-7.35304179e-03]
 [ 2.62646801e-03]
 [ 1.45789654e-02]
 [ 1.46146462e-02]
 [-3.76236040e-03]
 [ 5.83565346e-03]
 [ 1.57861448e-02]
 [-2.76883101e-02]
 [ 3.25556865e-03]
 [-5.21882036e-02]
 [ 6.43513004e-03]
 [ 6.39641987e-03]
 [ 5.46507582e-03]
 [-5.52601026e-03]
 [-4.05237918e-03]
 [ 1.70181112e-02]
 [ 1.51991805e-02]
 [ 1.08870757e-02]
 [ 3.29891691e-03]
 [ 9.75478789e-03]
 [-2.06313339e-03]
 [ 1.21270834e-04]
 [-9.65989302e-03]
 [ 2.11219969e-03]
 [ 1.29688108e-03]
 [-4.57938427e-03]
 [-4.41833697e-03]
 [ 1.05376822e-03]
 [ 8.51723195e-03]
 [ 7.74095087e-03]
 [-3.93768318e-03]
 [-3.18282133e-03]
 [-4.58378075e-04]
 [-5.92620344e-03]
 [ 2.60393036e-03]
 [ 1.97931398e-02]
 [ 4.50223375e-03]
 [ 1.42800551e-02]
 [-1.64338344e-03]
 [ 4.47400640e-03]
 [ 2.34857605e-02]
 [ 3.40448311e-03]
 [-1.54441668e-02]
 [-5.87102686e-03]
 [ 2.19539738e-03]
 [ 1.08467301e-02]
 [ 5.76859382e-03]
 [-2.27334579e-04]
 [-1.79375999e-02]
 [-3.21812479e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.99464763]
curr_Stock_Price:  99.86263072096999
curr_Factors:  [99.86263072]
mat_Sqrt:  [[0.15]]
grads:  [-0.09224233]
Stock Position:  -0.09224233301699428
Bond Position:  [8.21691441]


portfolio before change:  [-0.98967482]
curr_Stock_Price:  99.81428806287018
curr_Factors:  [99.81428806]
mat_Sqrt:  [[0.15]]
grads:  [0.04479839]
Stock Position:  0.044798385576603345
Bond Position:  [-5.46119378]


portfolio before change:  [-0.97165247]
curr_Stock_Price:  100.22420664769385
curr_Factors:  [100.22420665]
mat_Sqrt:  [[0.15]]
grads:  [0.04966049]
Stock Position:  0.04966049471885584
Bond Position:  [-5.94883615]


portfolio before change:  [-0.947355]
curr_Stock_Price:  100.7209653132046
curr_Factors:  [100.72096531]
mat_Sqrt:  [[0.15]]
grads:  [-0.11454868]
Stock Position:  -0.11454868272219829
Bond Position:  [10.5900989]


portfolio before change:  [-0.94683895]
curr_Stock_Price:  100.7222386097645
curr_Factors:  [100.72223861]
mat_Sqrt:  [[0.15]]
grads:  [-0.05216673]
Stock Position:  -0.05216673091283957
Bond Position:  [4.30751097]


portfolio before change:  [-0.96689967]
curr_Stock_Price:  101.1119495740115
curr_Factors:  [101.11194957]
mat_Sqrt:  [[0.15]]
grads:  [-0.00761259]
Stock Position:  -0.007612587678697602
Bond Position:  [-0.19717609]


portfolio before change:  [-0.97443496]
curr_Stock_Price:  102.10017674147268
curr_Factors:  [102.10017674]
mat_Sqrt:  [[0.15]]
grads:  [0.06011461]
Stock Position:  0.06011461335661535
Bond Position:  [-7.11214761]


portfolio before change:  [-0.96786729]
curr_Stock_Price:  102.21682385808747
curr_Factors:  [102.21682386]
mat_Sqrt:  [[0.15]]
grads:  [-0.31647087]
Stock Position:  -0.3164708651382147
Bond Position:  [31.38077939]


portfolio before change:  [-0.98471329]
curr_Stock_Price:  102.2762522634912
curr_Factors:  [102.27625226]
mat_Sqrt:  [[0.15]]
grads:  [0.11334492]
Stock Position:  0.11334492311544145
Bond Position:  [-12.57720723]


portfolio before change:  [-0.95443338]
curr_Stock_Price:  102.55033608578832
curr_Factors:  [102.55033609]
mat_Sqrt:  [[0.15]]
grads:  [-0.049406]
Stock Position:  -0.04940600206684457
Bond Position:  [4.11216874]


portfolio before change:  [-0.9431495]
curr_Stock_Price:  102.32714737790033
curr_Factors:  [102.32714738]
mat_Sqrt:  [[0.15]]
grads:  [-0.0714528]
Stock Position:  -0.07145280116755366
Bond Position:  [6.36841182]


portfolio before change:  [-0.8926574]
curr_Stock_Price:  101.62606845106686
curr_Factors:  [101.62606845]
mat_Sqrt:  [[0.15]]
grads:  [0.09863088]
Stock Position:  0.09863088437414297
Bond Position:  [-10.91612641]


portfolio before change:  [-0.8045401]
curr_Stock_Price:  102.52639070746498
curr_Factors:  [102.52639071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02971968]
Stock Position:  -0.029719680273566664
Bond Position:  [2.24251145]


portfolio before change:  [-0.82631236]
curr_Stock_Price:  103.26369386371144
curr_Factors:  [103.26369386]
mat_Sqrt:  [[0.15]]
grads:  [0.03589895]
Stock Position:  0.03589895007472973
Bond Position:  [-4.53337055]


portfolio before change:  [-0.83843812]
curr_Stock_Price:  102.93381169026874
curr_Factors:  [102.93381169]
mat_Sqrt:  [[0.15]]
grads:  [0.0669895]
Stock Position:  0.06698950354218548
Bond Position:  [-7.73392307]


portfolio before change:  [-0.86441988]
curr_Stock_Price:  102.55317940903257
curr_Factors:  [102.55317941]
mat_Sqrt:  [[0.15]]
grads:  [0.07105196]
Stock Position:  0.07105195512362876
Bond Position:  [-8.15102378]


portfolio before change:  [-0.84283974]
curr_Stock_Price:  102.86407290967561
curr_Factors:  [102.86407291]
mat_Sqrt:  [[0.15]]
grads:  [0.6464078]
Stock Position:  0.6464078007725899
Bond Position:  [-67.33497889]


portfolio before change:  [-0.96219561]
curr_Stock_Price:  102.6859387652634
curr_Factors:  [102.68593877]
mat_Sqrt:  [[0.15]]
grads:  [-0.07347092]
Stock Position:  -0.07347092451055927
Bond Position:  [6.58223525]


portfolio before change:  [-0.96250006]
curr_Stock_Price:  102.69568211613183
curr_Factors:  [102.69568212]
mat_Sqrt:  [[0.15]]
grads:  [0.15584819]
Stock Position:  0.15584819320860058
Bond Position:  [-16.96743657]


portfolio before change:  [-0.89638182]
curr_Stock_Price:  103.12673453701704
curr_Factors:  [103.12673454]
mat_Sqrt:  [[0.15]]
grads:  [0.00121345]
Stock Position:  0.0012134459973056752
Bond Position:  [-1.02152054]


portfolio before change:  [-0.89512505]
curr_Stock_Price:  104.21505296522655
curr_Factors:  [104.21505297]
mat_Sqrt:  [[0.15]]
grads:  [-0.05476421]
Stock Position:  -0.05476421493961471
Bond Position:  [4.81213051]


portfolio before change:  [-0.90049078]
curr_Stock_Price:  104.31852384305792
curr_Factors:  [104.31852384]
mat_Sqrt:  [[0.15]]
grads:  [0.04778305]
Stock Position:  0.047783045707705106
Bond Position:  [-5.88514757]


portfolio before change:  [-0.90033586]
curr_Stock_Price:  104.32946403534372
curr_Factors:  [104.32946404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01559555]
Stock Position:  -0.015595553622747699
Bond Position:  [0.72673989]


portfolio before change:  [-0.9025985]
curr_Stock_Price:  104.47745885870368
curr_Factors:  [104.47745886]
mat_Sqrt:  [[0.15]]
grads:  [0.37638345]
Stock Position:  0.3763834456249293
Bond Position:  [-40.22618445]


portfolio before change:  [-1.07085309]
curr_Stock_Price:  104.03710904835187
curr_Factors:  [104.03710905]
mat_Sqrt:  [[0.15]]
grads:  [0.03242347]
Stock Position:  0.03242346664550206
Bond Position:  [-4.44409683]


portfolio before change:  [-1.05701591]
curr_Stock_Price:  104.47244016059636
curr_Factors:  [104.47244016]
mat_Sqrt:  [[0.15]]
grads:  [0.04251107]
Stock Position:  0.04251107206733743
Bond Position:  [-5.49825135]


portfolio before change:  [-1.06610298]
curr_Stock_Price:  104.26676622340392
curr_Factors:  [104.26676622]
mat_Sqrt:  [[0.15]]
grads:  [0.42627149]
Stock Position:  0.4262714904754097
Bond Position:  [-45.51205283]


portfolio before change:  [-1.11600902]
curr_Stock_Price:  104.15636371390593
curr_Factors:  [104.15636371]
mat_Sqrt:  [[0.15]]
grads:  [0.18795239]
Stock Position:  0.18795238693911806
Bond Position:  [-20.69244619]


portfolio before change:  [-1.17191227]
curr_Stock_Price:  103.86581176046575
curr_Factors:  [103.86581176]
mat_Sqrt:  [[0.15]]
grads:  [0.06974347]
Stock Position:  0.0697434701464936
Bond Position:  [-8.41587441]


portfolio before change:  [-1.21345677]
curr_Stock_Price:  103.27767802086285
curr_Factors:  [103.27767802]
mat_Sqrt:  [[0.15]]
grads:  [-0.04902028]
Stock Position:  -0.0490202786126151
Bond Position:  [3.84924379]


portfolio before change:  [-1.23581509]
curr_Stock_Price:  103.73868947572475
curr_Factors:  [103.73868948]
mat_Sqrt:  [[0.15]]
grads:  [0.01750979]
Stock Position:  0.017509786728132914
Bond Position:  [-3.05225742]


portfolio before change:  [-1.24088347]
curr_Stock_Price:  103.46012479846961
curr_Factors:  [103.4601248]
mat_Sqrt:  [[0.15]]
grads:  [0.0971931]
Stock Position:  0.09719310252087997
Bond Position:  [-11.29649399]


portfolio before change:  [-1.2346426]
curr_Stock_Price:  103.53160023495131
curr_Factors:  [103.53160023]
mat_Sqrt:  [[0.15]]
grads:  [0.09743097]
Stock Position:  0.09743097495082341
Bond Position:  [-11.32182735]


portfolio before change:  [-1.27808923]
curr_Stock_Price:  103.09294103039281
curr_Factors:  [103.09294103]
mat_Sqrt:  [[0.15]]
grads:  [-0.0250824]
Stock Position:  -0.025082402690688246
Bond Position:  [1.30772943]


portfolio before change:  [-1.2603993]
curr_Stock_Price:  102.39092692884665
curr_Factors:  [102.39092693]
mat_Sqrt:  [[0.15]]
grads:  [0.03890436]
Stock Position:  0.03890435643260069
Bond Position:  [-5.24385242]


portfolio before change:  [-1.27847642]
curr_Stock_Price:  101.93469606425282
curr_Factors:  [101.93469606]
mat_Sqrt:  [[0.15]]
grads:  [0.10524097]
Stock Position:  0.10524096551767856
Bond Position:  [-12.00618225]


portfolio before change:  [-1.31191503]
curr_Stock_Price:  101.62409266983116
curr_Factors:  [101.62409267]
mat_Sqrt:  [[0.15]]
grads:  [-0.18458873]
Stock Position:  -0.1845887339354667
Bond Position:  [17.44674757]


portfolio before change:  [-1.18550164]
curr_Stock_Price:  100.94516211976435
curr_Factors:  [100.94516212]
mat_Sqrt:  [[0.15]]
grads:  [0.02170379]
Stock Position:  0.021703791029102394
Bond Position:  [-3.37639435]


portfolio before change:  [-1.18833879]
curr_Stock_Price:  100.82416407121588
curr_Factors:  [100.82416407]
mat_Sqrt:  [[0.15]]
grads:  [-0.34792136]
Stock Position:  -0.3479213571364
Bond Position:  [33.89054121]


portfolio before change:  [-1.25827948]
curr_Stock_Price:  101.03127671388158
curr_Factors:  [101.03127671]
mat_Sqrt:  [[0.15]]
grads:  [0.04290087]
Stock Position:  0.0429008669481479
Bond Position:  [-5.59260884]


portfolio before change:  [-1.2637479]
curr_Stock_Price:  100.91195794840415
curr_Factors:  [100.91195795]
mat_Sqrt:  [[0.15]]
grads:  [0.0426428]
Stock Position:  0.04264279910618918
Bond Position:  [-5.56691625]


portfolio before change:  [-1.26467451]
curr_Stock_Price:  100.89838790745264
curr_Factors:  [100.89838791]
mat_Sqrt:  [[0.15]]
grads:  [0.03643384]
Stock Position:  0.036433838820122716
Bond Position:  [-4.94079011]


portfolio before change:  [-1.22693623]
curr_Stock_Price:  101.94266674995566
curr_Factors:  [101.94266675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684007]
Stock Position:  -0.03684006843245453
Bond Position:  [2.52863859]


portfolio before change:  [-1.21979662]
curr_Stock_Price:  101.7531565983749
curr_Factors:  [101.7531566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02701586]
Stock Position:  -0.027015861223078613
Bond Position:  [1.52915254]


portfolio before change:  [-1.20568815]
curr_Stock_Price:  101.23446523737809
curr_Factors:  [101.23446524]
mat_Sqrt:  [[0.15]]
grads:  [0.11345407]
Stock Position:  0.11345407497290995
Bond Position:  [-12.69115076]


portfolio before change:  [-1.32896891]
curr_Stock_Price:  100.15484304920581
curr_Factors:  [100.15484305]
mat_Sqrt:  [[0.15]]
grads:  [0.10132787]
Stock Position:  0.1013278699594413
Bond Position:  [-11.47744582]


portfolio before change:  [-1.28714726]
curr_Stock_Price:  100.57465861732162
curr_Factors:  [100.57465862]
mat_Sqrt:  [[0.15]]
grads:  [0.0725805]
Stock Position:  0.07258050498602801
Bond Position:  [-8.58690677]


portfolio before change:  [-1.25403603]
curr_Stock_Price:  101.03825310310553
curr_Factors:  [101.0382531]
mat_Sqrt:  [[0.15]]
grads:  [0.02199278]
Stock Position:  0.02199277937202328
Bond Position:  [-3.47614804]


portfolio before change:  [-1.26414464]
curr_Stock_Price:  100.58849892107091
curr_Factors:  [100.58849892]
mat_Sqrt:  [[0.15]]
grads:  [0.06503192]
Stock Position:  0.0650319192799413
Bond Position:  [-7.80560779]


portfolio before change:  [-1.29919483]
curr_Stock_Price:  100.05703184312874
curr_Factors:  [100.05703184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375422]
Stock Position:  -0.013754222614670474
Bond Position:  [0.07701186]


portfolio before change:  [-1.3006473]
curr_Stock_Price:  100.16298337238057
curr_Factors:  [100.16298337]
mat_Sqrt:  [[0.15]]
grads:  [0.00080847]
Stock Position:  0.0008084722245264853
Bond Position:  [-1.38162629]


portfolio before change:  [-1.30062042]
curr_Stock_Price:  100.30303969852824
curr_Factors:  [100.3030397]
mat_Sqrt:  [[0.15]]
grads:  [-0.06439929]
Stock Position:  -0.06439928682066678
Bond Position:  [5.1588238]


portfolio before change:  [-1.28367375]
curr_Stock_Price:  100.04489643349338
curr_Factors:  [100.04489643]
mat_Sqrt:  [[0.15]]
grads:  [0.01408133]
Stock Position:  0.01408133123365861
Bond Position:  [-2.69243907]


portfolio before change:  [-1.27834403]
curr_Stock_Price:  100.43534265933283
curr_Factors:  [100.43534266]
mat_Sqrt:  [[0.15]]
grads:  [0.00864587]
Stock Position:  0.008645873849623259
Bond Position:  [-2.14669533]


portfolio before change:  [-1.28474176]
curr_Stock_Price:  99.7108856345562
curr_Factors:  [99.71088563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03052923]
Stock Position:  -0.030529228495707692
Bond Position:  [1.75935465]


portfolio before change:  [-1.25592196]
curr_Stock_Price:  98.7704807470323
curr_Factors:  [98.77048075]
mat_Sqrt:  [[0.15]]
grads:  [-0.02945558]
Stock Position:  -0.029455579810866012
Bond Position:  [1.65341982]


portfolio before change:  [-1.25694851]
curr_Stock_Price:  98.808839663819
curr_Factors:  [98.80883966]
mat_Sqrt:  [[0.15]]
grads:  [0.00702512]
Stock Position:  0.007025121476197611
Bond Position:  [-1.95109261]


portfolio before change:  [-1.25624319]
curr_Stock_Price:  98.9265971378713
curr_Factors:  [98.92659714]
mat_Sqrt:  [[0.15]]
grads:  [0.05678155]
Stock Position:  0.05678154634725589
Bond Position:  [-6.87344835]


portfolio before change:  [-1.28314453]
curr_Stock_Price:  98.46039395636062
curr_Factors:  [98.46039396]
mat_Sqrt:  [[0.15]]
grads:  [0.05160634]
Stock Position:  0.05160633910333124
Bond Position:  [-6.36432501]


portfolio before change:  [-1.2742958]
curr_Stock_Price:  98.63956798119716
curr_Factors:  [98.63956798]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625122]
Stock Position:  -0.02625122121831232
Bond Position:  [1.31511332]


portfolio before change:  [-1.26653539]
curr_Stock_Price:  98.34707824068181
curr_Factors:  [98.34707824]
mat_Sqrt:  [[0.15]]
grads:  [-0.02121881]
Stock Position:  -0.021218808857246734
Bond Position:  [0.82027246]


portfolio before change:  [-1.25173999]
curr_Stock_Price:  97.65221664916935
curr_Factors:  [97.65221665]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305585]
Stock Position:  -0.003055853834576979
Bond Position:  [-0.95332909]


portfolio before change:  [-1.25386811]
curr_Stock_Price:  98.32912663006137
curr_Factors:  [98.32912663]
mat_Sqrt:  [[0.15]]
grads:  [-0.03950802]
Stock Position:  -0.039508022951077915
Bond Position:  [2.63092128]


portfolio before change:  [-1.26694937]
curr_Stock_Price:  98.66439265441049
curr_Factors:  [98.66439265]
mat_Sqrt:  [[0.15]]
grads:  [0.01735954]
Stock Position:  0.017359535734094777
Bond Position:  [-2.97971742]


portfolio before change:  [-1.27638962]
curr_Stock_Price:  98.13131320628239
curr_Factors:  [98.13131321]
mat_Sqrt:  [[0.15]]
grads:  [0.13195427]
Stock Position:  0.13195426503419888
Bond Position:  [-14.22523493]


portfolio before change:  [-1.42333189]
curr_Stock_Price:  97.02446632733583
curr_Factors:  [97.02446633]
mat_Sqrt:  [[0.15]]
grads:  [0.03001489]
Stock Position:  0.030014891674914244
Bond Position:  [-4.33551074]


portfolio before change:  [-1.42124217]
curr_Stock_Price:  97.10311736055596
curr_Factors:  [97.10311736]
mat_Sqrt:  [[0.15]]
grads:  [0.09520037]
Stock Position:  0.09520036719933392
Bond Position:  [-10.6654946]


portfolio before change:  [-1.42582771]
curr_Stock_Price:  97.06195233998095
curr_Factors:  [97.06195234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01095589]
Stock Position:  -0.010955889628828019
Bond Position:  [-0.36242767]


portfolio before change:  [-1.4246567]
curr_Stock_Price:  96.95300059995633
curr_Factors:  [96.9530006]
mat_Sqrt:  [[0.15]]
grads:  [0.02982671]
Stock Position:  0.02982670932141087
Bond Position:  [-4.31644566]


portfolio before change:  [-1.4248597]
curr_Stock_Price:  96.95523949736952
curr_Factors:  [96.9552395]
mat_Sqrt:  [[0.15]]
grads:  [0.15657174]
Stock Position:  0.1565717365272158
Bond Position:  [-16.60530992]


portfolio before change:  [-1.42226625]
curr_Stock_Price:  96.97843216755317
curr_Factors:  [96.97843217]
mat_Sqrt:  [[0.15]]
grads:  [0.02269655]
Stock Position:  0.022696554036972596
Bond Position:  [-3.62334248]


portfolio before change:  [-1.42868272]
curr_Stock_Price:  96.70570336655496
curr_Factors:  [96.70570337]
mat_Sqrt:  [[0.15]]
grads:  [-0.10296111]
Stock Position:  -0.10296111210715311
Bond Position:  [8.52824405]


portfolio before change:  [-1.3687984]
curr_Stock_Price:  96.12925963418736
curr_Factors:  [96.12925963]
mat_Sqrt:  [[0.15]]
grads:  [-0.03914018]
Stock Position:  -0.039140179054989524
Bond Position:  [2.39371803]


portfolio before change:  [-1.36124301]
curr_Stock_Price:  95.94004792574043
curr_Factors:  [95.94004793]
mat_Sqrt:  [[0.15]]
grads:  [0.01463598]
Stock Position:  0.014635982535563322
Bond Position:  [-2.76541987]


portfolio before change:  [-1.36515261]
curr_Stock_Price:  95.68473472104245
curr_Factors:  [95.68473472]
mat_Sqrt:  [[0.15]]
grads:  [0.07231153]
Stock Position:  0.0723115343019072
Bond Position:  [-8.28426259]


portfolio before change:  [-1.37580853]
curr_Stock_Price:  95.5445338991719
curr_Factors:  [95.5445339]
mat_Sqrt:  [[0.15]]
grads:  [0.03845729]
Stock Position:  0.038457292106724904
Bond Position:  [-5.05019258]


portfolio before change:  [-1.37865307]
curr_Stock_Price:  95.47877554839388
curr_Factors:  [95.47877555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151556]
Stock Position:  -0.0015155638590857424
Bond Position:  [-1.23394888]


portfolio before change:  [-1.37876531]
curr_Stock_Price:  95.501948983925
curr_Factors:  [95.50194898]
mat_Sqrt:  [[0.15]]
grads:  [-0.119584]
Stock Position:  -0.1195839996406467
Bond Position:  [10.04173972]


portfolio before change:  [-1.30531748]
curr_Stock_Price:  94.89300292872441
curr_Factors:  [94.89300293]
mat_Sqrt:  [[0.15]]
grads:  [-0.21454165]
Stock Position:  -0.2145416526674852
Bond Position:  [19.0531842]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.07244196]
Stock Price:  93.81309768522193
PL:  [-1.07244196]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.78684677e-03]
 [ 3.45546897e-02]
 [ 1.99522032e-02]
 [-2.36404492e-02]
 [-1.33915439e-02]
 [-3.32303672e-03]
 [-1.04027851e-02]
 [-2.18698698e-02]
 [ 8.44808566e-03]
 [ 1.70318080e-03]
 [ 9.27083913e-03]
 [-4.83549626e-03]
 [-8.70290927e-04]
 [ 9.24359837e-03]
 [ 3.45824211e-04]
 [ 1.34810633e-02]
 [ 1.10759349e-02]
 [-1.36011339e-02]
 [ 2.50065188e-02]
 [ 4.43162055e-04]
 [-5.89561322e-03]
 [ 5.14298853e-03]
 [ 1.49870459e-02]
 [ 1.77643675e-02]
 [-6.09458063e-03]
 [ 4.62076539e-03]
 [ 2.78366500e-03]
 [ 6.78436352e-03]
 [ 3.05574005e-02]
 [-5.75259466e-04]
 [-3.07475131e-03]
 [ 1.27791986e-02]
 [ 1.23799937e-02]
 [ 8.26314739e-03]
 [ 5.29288641e-03]
 [ 1.17705605e-02]
 [-2.64842778e-02]
 [ 3.34355217e-03]
 [-5.59365782e-02]
 [-9.16023307e-03]
 [ 7.17326055e-03]
 [-3.06029064e-03]
 [-1.35094163e-03]
 [-3.70151294e-03]
 [ 2.31482786e-02]
 [ 1.54388564e-02]
 [ 1.07145220e-02]
 [ 4.96760257e-03]
 [-8.36275583e-04]
 [-1.81079380e-03]
 [-7.21335594e-03]
 [ 1.51349280e-03]
 [ 1.37839907e-03]
 [ 6.98399476e-03]
 [-6.92479735e-03]
 [-4.41036866e-03]
 [ 2.03047618e-03]
 [ 9.71750351e-03]
 [ 7.43283360e-03]
 [-4.02840601e-03]
 [-4.77273630e-04]
 [ 7.12313091e-03]
 [-1.41190234e-02]
 [ 7.36319305e-03]
 [ 2.54937806e-02]
 [ 5.57133153e-03]
 [ 1.12839920e-02]
 [ 1.72331305e-03]
 [ 4.10118954e-03]
 [ 1.88677510e-02]
 [ 7.80354704e-04]
 [-1.55356136e-02]
 [-6.94194883e-03]
 [ 1.08706453e-03]
 [ 3.84757950e-03]
 [-1.50181758e-02]
 [-4.20470934e-03]
 [ 1.59106075e-02]
 [-4.13155673e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.86553222]
curr_Stock_Price:  100.81005734150582
curr_Factors:  [100.81005734]
mat_Sqrt:  [[0.15]]
grads:  [-0.03857898]
Stock Position:  -0.038578978459387486
Bond Position:  [23.75468125]


portfolio before change:  [19.86601383]
curr_Stock_Price:  100.83605858739197
curr_Factors:  [100.83605859]
mat_Sqrt:  [[0.15]]
grads:  [0.2303646]
Stock Position:  0.23036459832144957
Bond Position:  [-3.3630443]


portfolio before change:  [19.91369138]
curr_Stock_Price:  101.04393664893774
curr_Factors:  [101.04393665]
mat_Sqrt:  [[0.15]]
grads:  [0.13301469]
Stock Position:  0.13301468833141736
Bond Position:  [6.47336364]


portfolio before change:  [19.91287212]
curr_Stock_Price:  101.03473571317983
curr_Factors:  [101.03473571]
mat_Sqrt:  [[0.15]]
grads:  [-0.15760299]
Stock Position:  -0.1576029945576393
Bond Position:  [35.83624902]


portfolio before change:  [19.94299073]
curr_Stock_Price:  100.85784327980598
curr_Factors:  [100.85784328]
mat_Sqrt:  [[0.15]]
grads:  [-0.08927696]
Stock Position:  -0.08927695909751347
Bond Position:  [28.94727228]


portfolio before change:  [19.98907103]
curr_Stock_Price:  100.36195908719294
curr_Factors:  [100.36195909]
mat_Sqrt:  [[0.15]]
grads:  [-0.02215358]
Stock Position:  -0.022153578112778956
Bond Position:  [22.21244753]


portfolio before change:  [19.97864907]
curr_Stock_Price:  100.8950683829641
curr_Factors:  [100.89506838]
mat_Sqrt:  [[0.15]]
grads:  [-0.0693519]
Stock Position:  -0.06935190097859355
Bond Position:  [26.97591386]


portfolio before change:  [19.99771114]
curr_Stock_Price:  100.64451974110503
curr_Factors:  [100.64451974]
mat_Sqrt:  [[0.15]]
grads:  [-0.14579913]
Stock Position:  -0.1457991318664274
Bond Position:  [34.67159475]


portfolio before change:  [19.96060232]
curr_Stock_Price:  100.9139031184369
curr_Factors:  [100.91390312]
mat_Sqrt:  [[0.15]]
grads:  [0.05632057]
Stock Position:  0.05632057105574191
Bond Position:  [14.27707367]


portfolio before change:  [19.94227976]
curr_Stock_Price:  100.57273281980947
curr_Factors:  [100.57273282]
mat_Sqrt:  [[0.15]]
grads:  [0.01135454]
Stock Position:  0.011354538680986062
Bond Position:  [18.80032278]


portfolio before change:  [19.9400397]
curr_Stock_Price:  100.27196190943211
curr_Factors:  [100.27196191]
mat_Sqrt:  [[0.15]]
grads:  [0.06180559]
Stock Position:  0.06180559417575488
Bond Position:  [13.74267152]


portfolio before change:  [19.90569015]
curr_Stock_Price:  99.70229666752017
curr_Factors:  [99.70229667]
mat_Sqrt:  [[0.15]]
grads:  [-0.03223664]
Stock Position:  -0.03223664175580071
Bond Position:  [23.11975737]


portfolio before change:  [19.91774495]
curr_Stock_Price:  99.37317510998189
curr_Factors:  [99.37317511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00580194]
Stock Position:  -0.005801939514106132
Bond Position:  [20.4943021]


portfolio before change:  [19.91599162]
curr_Stock_Price:  99.89615002084398
curr_Factors:  [99.89615002]
mat_Sqrt:  [[0.15]]
grads:  [0.06162399]
Stock Position:  0.061623989106308584
Bond Position:  [13.75999236]


portfolio before change:  [19.90735767]
curr_Stock_Price:  99.74208701155626
curr_Factors:  [99.74208701]
mat_Sqrt:  [[0.15]]
grads:  [0.00230549]
Stock Position:  0.0023054947428646777
Bond Position:  [19.67740281]


portfolio before change:  [19.90956025]
curr_Stock_Price:  100.1639941087925
curr_Factors:  [100.16399411]
mat_Sqrt:  [[0.15]]
grads:  [0.08987376]
Stock Position:  0.08987375536367477
Bond Position:  [10.90744594]


portfolio before change:  [19.8018896]
curr_Stock_Price:  98.95838761961456
curr_Factors:  [98.95838762]
mat_Sqrt:  [[0.15]]
grads:  [0.07383957]
Stock Position:  0.07383956570196684
Bond Position:  [12.49484524]


portfolio before change:  [19.77640767]
curr_Stock_Price:  98.60271273683796
curr_Factors:  [98.60271274]
mat_Sqrt:  [[0.15]]
grads:  [-0.09067423]
Stock Position:  -0.09067422624077577
Bond Position:  [28.71713236]


portfolio before change:  [19.77929264]
curr_Stock_Price:  98.59069066739282
curr_Factors:  [98.59069067]
mat_Sqrt:  [[0.15]]
grads:  [0.16671013]
Stock Position:  0.16671012549656816
Bond Position:  [3.34322623]


portfolio before change:  [19.81972132]
curr_Stock_Price:  98.83194606451552
curr_Factors:  [98.83194606]
mat_Sqrt:  [[0.15]]
grads:  [0.00295441]
Stock Position:  0.0029544136995710707
Bond Position:  [19.52773086]


portfolio before change:  [19.82012831]
curr_Stock_Price:  98.5565853735333
curr_Factors:  [98.55658537]
mat_Sqrt:  [[0.15]]
grads:  [-0.03930409]
Stock Position:  -0.0393040881131244
Bond Position:  [23.69380503]


portfolio before change:  [19.79722835]
curr_Stock_Price:  99.17689931258693
curr_Factors:  [99.17689931]
mat_Sqrt:  [[0.15]]
grads:  [0.03428659]
Stock Position:  0.03428659023049699
Bond Position:  [16.39679064]


portfolio before change:  [19.83479269]
curr_Stock_Price:  100.24260783877129
curr_Factors:  [100.24260784]
mat_Sqrt:  [[0.15]]
grads:  [0.09991364]
Stock Position:  0.09991363914847366
Bond Position:  [9.81918894]


portfolio before change:  [19.75292613]
curr_Stock_Price:  99.41709215081329
curr_Factors:  [99.41709215]
mat_Sqrt:  [[0.15]]
grads:  [0.11842912]
Stock Position:  0.11842911692335245
Bond Position:  [7.9790477]


portfolio before change:  [19.76648741]
curr_Stock_Price:  99.52739078375271
curr_Factors:  [99.52739078]
mat_Sqrt:  [[0.15]]
grads:  [-0.04063054]
Stock Position:  -0.04063053753214286
Bond Position:  [23.81033879]


portfolio before change:  [19.78752518]
curr_Stock_Price:  99.04623580393464
curr_Factors:  [99.0462358]
mat_Sqrt:  [[0.15]]
grads:  [0.0308051]
Stock Position:  0.030805102603785793
Bond Position:  [16.73639573]


portfolio before change:  [19.81290388]
curr_Stock_Price:  99.83612564572569
curr_Factors:  [99.83612565]
mat_Sqrt:  [[0.15]]
grads:  [0.01855777]
Stock Position:  0.018557766678246417
Bond Position:  [17.96016835]


portfolio before change:  [19.81888555]
curr_Stock_Price:  100.0979632999708
curr_Factors:  [100.0979633]
mat_Sqrt:  [[0.15]]
grads:  [0.04522909]
Stock Position:  0.045229090103375974
Bond Position:  [15.29154575]


portfolio before change:  [19.83547835]
curr_Stock_Price:  100.44369321369385
curr_Factors:  [100.44369321]
mat_Sqrt:  [[0.15]]
grads:  [0.203716]
Stock Position:  0.2037160035593151
Bond Position:  [-0.62650942]


portfolio before change:  [20.05423882]
curr_Stock_Price:  101.51773565859077
curr_Factors:  [101.51773566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383506]
Stock Position:  -0.0038350631037762746
Bond Position:  [20.44356575]


portfolio before change:  [20.05446024]
curr_Stock_Price:  101.79318127620684
curr_Factors:  [101.79318128]
mat_Sqrt:  [[0.15]]
grads:  [-0.02049834]
Stock Position:  -0.02049834209372587
Bond Position:  [22.14105169]


portfolio before change:  [20.06449114]
curr_Stock_Price:  101.37134002785147
curr_Factors:  [101.37134003]
mat_Sqrt:  [[0.15]]
grads:  [0.08519466]
Stock Position:  0.08519465752458509
Bond Position:  [11.42819455]


portfolio before change:  [19.99007631]
curr_Stock_Price:  100.48948758415112
curr_Factors:  [100.48948758]
mat_Sqrt:  [[0.15]]
grads:  [0.08253329]
Stock Position:  0.08253329151839267
Bond Position:  [11.69634814]


portfolio before change:  [20.00825447]
curr_Stock_Price:  100.70088242821768
curr_Factors:  [100.70088243]
mat_Sqrt:  [[0.15]]
grads:  [0.05508765]
Stock Position:  0.05508764926467215
Bond Position:  [14.46087957]


portfolio before change:  [20.02886902]
curr_Stock_Price:  101.05868888267892
curr_Factors:  [101.05868888]
mat_Sqrt:  [[0.15]]
grads:  [0.03528591]
Stock Position:  0.03528590941846819
Bond Position:  [16.46292127]


portfolio before change:  [20.03828599]
curr_Stock_Price:  101.29640437151228
curr_Factors:  [101.29640437]
mat_Sqrt:  [[0.15]]
grads:  [0.0784704]
Stock Position:  0.07847040316091482
Bond Position:  [12.0895163]


portfolio before change:  [19.98335838]
curr_Stock_Price:  100.5867963317449
curr_Factors:  [100.58679633]
mat_Sqrt:  [[0.15]]
grads:  [-0.17656185]
Stock Position:  -0.17656185208912192
Bond Position:  [37.74314943]


portfolio before change:  [19.93735261]
curr_Stock_Price:  100.86072180172658
curr_Factors:  [100.8607218]
mat_Sqrt:  [[0.15]]
grads:  [0.02229035]
Stock Position:  0.022290347781747037
Bond Position:  [17.68913204]


portfolio before change:  [19.92780783]
curr_Stock_Price:  100.3829193196048
curr_Factors:  [100.38291932]
mat_Sqrt:  [[0.15]]
grads:  [-0.37291052]
Stock Position:  -0.3729105211881968
Bond Position:  [57.36165459]


portfolio before change:  [20.19054873]
curr_Stock_Price:  99.68796523982427
curr_Factors:  [99.68796524]
mat_Sqrt:  [[0.15]]
grads:  [-0.06106822]
Stock Position:  -0.06106822048902903
Bond Position:  [26.27831538]


portfolio before change:  [20.19340612]
curr_Stock_Price:  99.66807045187555
curr_Factors:  [99.66807045]
mat_Sqrt:  [[0.15]]
grads:  [0.04782174]
Stock Position:  0.047821736999378715
Bond Position:  [15.42710587]


portfolio before change:  [20.19939208]
curr_Stock_Price:  99.77307997565454
curr_Factors:  [99.77307998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02040194]
Stock Position:  -0.02040193760730234
Bond Position:  [22.23495623]


portfolio before change:  [20.1958183]
curr_Stock_Price:  100.01636626011295
curr_Factors:  [100.01636626]
mat_Sqrt:  [[0.15]]
grads:  [-0.00900628]
Stock Position:  -0.009006277545458522
Bond Position:  [21.09659345]


portfolio before change:  [20.19529341]
curr_Stock_Price:  100.2210531505041
curr_Factors:  [100.22105315]
mat_Sqrt:  [[0.15]]
grads:  [-0.02467675]
Stock Position:  -0.02467675292888205
Bond Position:  [22.66842358]


portfolio before change:  [20.19929242]
curr_Stock_Price:  100.11641259703435
curr_Factors:  [100.1164126]
mat_Sqrt:  [[0.15]]
grads:  [0.15432186]
Stock Position:  0.15432185758668931
Bond Position:  [4.74914165]


portfolio before change:  [20.14564462]
curr_Stock_Price:  99.76685333134412
curr_Factors:  [99.76685333]
mat_Sqrt:  [[0.15]]
grads:  [0.10292571]
Stock Position:  0.10292570907478052
Bond Position:  [9.87707049]


portfolio before change:  [20.09491292]
curr_Stock_Price:  99.2679592531811
curr_Factors:  [99.26795925]
mat_Sqrt:  [[0.15]]
grads:  [0.07143015]
Stock Position:  0.07143014691789765
Bond Position:  [13.00418801]


portfolio before change:  [20.06218457]
curr_Stock_Price:  98.79839364250971
curr_Factors:  [98.79839364]
mat_Sqrt:  [[0.15]]
grads:  [0.03311735]
Stock Position:  0.033117350470493044
Bond Position:  [16.79024354]


portfolio before change:  [20.05431188]
curr_Stock_Price:  98.52898447013196
curr_Factors:  [98.52898447]
mat_Sqrt:  [[0.15]]
grads:  [-0.00557517]
Stock Position:  -0.005575170552883693
Bond Position:  [20.60362777]


portfolio before change:  [20.05405677]
curr_Stock_Price:  98.80572375453558
curr_Factors:  [98.80572375]
mat_Sqrt:  [[0.15]]
grads:  [-0.01207196]
Stock Position:  -0.012071958693033907
Bond Position:  [21.24683539]


portfolio before change:  [20.05304478]
curr_Stock_Price:  98.99955809361349
curr_Factors:  [98.99955809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04808904]
Stock Position:  -0.04808903962343972
Bond Position:  [24.81383846]


portfolio before change:  [20.0869517]
curr_Stock_Price:  98.326722863644
curr_Factors:  [98.32672286]
mat_Sqrt:  [[0.15]]
grads:  [0.01008995]
Stock Position:  0.010089951991267901
Bond Position:  [19.09483978]


portfolio before change:  [20.09186771]
curr_Stock_Price:  98.69565917928634
curr_Factors:  [98.69565918]
mat_Sqrt:  [[0.15]]
grads:  [0.00918933]
Stock Position:  0.009189327107607068
Bond Position:  [19.18492101]


portfolio before change:  [20.097084]
curr_Stock_Price:  99.13281831387792
curr_Factors:  [99.13281831]
mat_Sqrt:  [[0.15]]
grads:  [0.04655997]
Stock Position:  0.046559965065278736
Bond Position:  [15.48146345]


portfolio before change:  [20.0957116]
curr_Stock_Price:  99.08256000640243
curr_Factors:  [99.08256001]
mat_Sqrt:  [[0.15]]
grads:  [-0.04616532]
Stock Position:  -0.04616531567171261
Bond Position:  [24.66988926]


portfolio before change:  [20.10965602]
curr_Stock_Price:  98.81390595498627
curr_Factors:  [98.81390595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02940246]
Stock Position:  -0.029402457711413442
Bond Position:  [23.01502771]


portfolio before change:  [20.10041728]
curr_Stock_Price:  99.1770462902847
curr_Factors:  [99.17704629]
mat_Sqrt:  [[0.15]]
grads:  [0.01353651]
Stock Position:  0.013536507842475162
Bond Position:  [18.75790642]


portfolio before change:  [20.09443065]
curr_Stock_Price:  98.64817767599735
curr_Factors:  [98.64817768]
mat_Sqrt:  [[0.15]]
grads:  [0.06478336]
Stock Position:  0.0647833567393902
Bond Position:  [13.70367057]


portfolio before change:  [20.12478142]
curr_Stock_Price:  99.10345300939149
curr_Factors:  [99.10345301]
mat_Sqrt:  [[0.15]]
grads:  [0.04955222]
Stock Position:  0.049552223976232546
Bond Position:  [15.21398492]


portfolio before change:  [20.16257599]
curr_Stock_Price:  99.84698496541144
curr_Factors:  [99.84698497]
mat_Sqrt:  [[0.15]]
grads:  [-0.02685604]
Stock Position:  -0.02685604005685533
Bond Position:  [22.84407062]


portfolio before change:  [20.15338194]
curr_Stock_Price:  100.24249549008101
curr_Factors:  [100.24249549]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318182]
Stock Position:  -0.0031818241979022187
Bond Position:  [20.47233594]


portfolio before change:  [20.15196551]
curr_Stock_Price:  101.0898060234144
curr_Factors:  [101.08980602]
mat_Sqrt:  [[0.15]]
grads:  [0.04748754]
Stock Position:  0.0474875393724543
Bond Position:  [15.35145937]


portfolio before change:  [20.18497679]
curr_Stock_Price:  101.76475741261345
curr_Factors:  [101.76475741]
mat_Sqrt:  [[0.15]]
grads:  [-0.09412682]
Stock Position:  -0.09412682267211292
Bond Position:  [29.76377006]


portfolio before change:  [20.26117851]
curr_Stock_Price:  100.9749566900427
curr_Factors:  [100.97495669]
mat_Sqrt:  [[0.15]]
grads:  [0.04908795]
Stock Position:  0.04908795365321714
Bond Position:  [15.30452452]


portfolio before change:  [20.29300377]
curr_Stock_Price:  101.60380124686753
curr_Factors:  [101.60380125]
mat_Sqrt:  [[0.15]]
grads:  [0.16995854]
Stock Position:  0.1699585375976268
Bond Position:  [3.02457029]


portfolio before change:  [20.33877273]
curr_Stock_Price:  101.8719838416197
curr_Factors:  [101.87198384]
mat_Sqrt:  [[0.15]]
grads:  [0.03714221]
Stock Position:  0.037142210180361145
Bond Position:  [16.5550221]


portfolio before change:  [20.31562889]
curr_Stock_Price:  101.22101131518691
curr_Factors:  [101.22101132]
mat_Sqrt:  [[0.15]]
grads:  [0.07522661]
Stock Position:  0.07522661303796245
Bond Position:  [12.70111505]


portfolio before change:  [20.31167183]
curr_Stock_Price:  101.15785661257445
curr_Factors:  [101.15785661]
mat_Sqrt:  [[0.15]]
grads:  [0.01148875]
Stock Position:  0.01148875369681244
Bond Position:  [19.14949413]


portfolio before change:  [20.32584986]
curr_Stock_Price:  102.28775765457327
curr_Factors:  [102.28775765]
mat_Sqrt:  [[0.15]]
grads:  [0.02734126]
Stock Position:  0.027341263578386094
Bond Position:  [17.52917332]


portfolio before change:  [20.31856315]
curr_Stock_Price:  101.98117633841322
curr_Factors:  [101.98117634]
mat_Sqrt:  [[0.15]]
grads:  [0.12578501]
Stock Position:  0.12578500645864404
Bond Position:  [7.49086022]


portfolio before change:  [20.44818579]
curr_Stock_Price:  103.0079636777473
curr_Factors:  [103.00796368]
mat_Sqrt:  [[0.15]]
grads:  [0.00520236]
Stock Position:  0.005202364692249289
Bond Position:  [19.9123008]


portfolio before change:  [20.44565171]
curr_Stock_Price:  102.28163224393414
curr_Factors:  [102.28163224]
mat_Sqrt:  [[0.15]]
grads:  [-0.10357076]
Stock Position:  -0.10357075744406158
Bond Position:  [31.03903783]


portfolio before change:  [20.28269298]
curr_Stock_Price:  103.87376822063727
curr_Factors:  [103.87376822]
mat_Sqrt:  [[0.15]]
grads:  [-0.04627966]
Stock Position:  -0.04627965883744932
Bond Position:  [25.08993554]


portfolio before change:  [20.30299832]
curr_Stock_Price:  103.46889997664685
curr_Factors:  [103.46889998]
mat_Sqrt:  [[0.15]]
grads:  [0.0072471]
Stock Position:  0.0072470968861044404
Bond Position:  [19.55314917]


portfolio before change:  [20.30113415]
curr_Stock_Price:  103.04303590262863
curr_Factors:  [103.0430359]
mat_Sqrt:  [[0.15]]
grads:  [0.02565053]
Stock Position:  0.02565052996688719
Bond Position:  [17.65802567]


portfolio before change:  [20.287874]
curr_Stock_Price:  102.48305485710337
curr_Factors:  [102.48305486]
mat_Sqrt:  [[0.15]]
grads:  [-0.10012117]
Stock Position:  -0.10012117224318293
Bond Position:  [30.54859759]


portfolio before change:  [20.3636532]
curr_Stock_Price:  101.74525029330198
curr_Factors:  [101.74525029]
mat_Sqrt:  [[0.15]]
grads:  [-0.0280314]
Stock Position:  -0.028031395604635745
Bond Position:  [23.21571456]


portfolio before change:  [20.361884]
curr_Stock_Price:  101.86012956918259
curr_Factors:  [101.86012957]
mat_Sqrt:  [[0.15]]
grads:  [0.10607072]
Stock Position:  0.10607071680279509
Bond Position:  [9.55750705]


portfolio before change:  [20.48381431]
curr_Stock_Price:  103.00401688853671
curr_Factors:  [103.00401689]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754371]
Stock Position:  -0.027543711529204203
Bond Position:  [23.32092724]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.48762008]
Stock Price:  102.91876457749585
PL:  [17.56885551]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.34329701e-02]
 [ 1.01282386e-02]
 [ 1.26960966e-02]
 [-1.71414091e-02]
 [ 1.42924577e-02]
 [-1.88202137e-03]
 [-5.24206210e-03]
 [-1.09168562e-02]
 [ 1.11938636e-02]
 [-5.40525362e-03]
 [-5.57942937e-03]
 [ 6.49097520e-05]
 [-2.66577981e-03]
 [ 9.64578043e-03]
 [-6.78563801e-04]
 [ 1.31933717e-02]
 [ 4.35057216e-02]
 [-1.46556098e-02]
 [ 1.87013752e-02]
 [ 1.52098108e-03]
 [-3.75365566e-03]
 [ 4.20253387e-03]
 [ 1.50262181e-02]
 [ 1.78767884e-02]
 [-4.00387465e-03]
 [ 6.43160061e-03]
 [-4.65108617e-03]
 [ 5.86019237e-03]
 [ 2.74351439e-02]
 [-4.01991924e-04]
 [-2.14809285e-03]
 [ 1.35121165e-02]
 [ 1.35331124e-02]
 [ 2.02507240e-03]
 [ 6.33253204e-03]
 [ 1.49089527e-02]
 [-2.05346907e-02]
 [-2.59165705e-03]
 [-2.48943786e-02]
 [-1.46956654e-02]
 [ 3.89588296e-03]
 [ 7.64887768e-03]
 [-1.18122432e-02]
 [ 2.91124533e-03]
 [ 4.52428095e-03]
 [ 1.17490996e-02]
 [ 1.05635105e-02]
 [-2.42213930e-03]
 [ 1.29413348e-02]
 [-1.31328226e-03]
 [ 2.08045541e-02]
 [ 4.80300057e-03]
 [-1.31781663e-03]
 [-2.22981831e-02]
 [-5.54282680e-03]
 [-2.97053943e-03]
 [ 9.21713727e-03]
 [-1.70675978e-02]
 [ 2.79596001e-03]
 [-3.17859954e-03]
 [-6.40967017e-03]
 [ 3.48405668e-03]
 [-1.97591867e-02]
 [ 9.75414643e-04]
 [ 1.81636027e-02]
 [ 1.21578681e-02]
 [ 1.02940138e-02]
 [ 1.05623096e-02]
 [ 6.05421315e-03]
 [ 1.29970104e-02]
 [ 9.46498556e-04]
 [-1.53364097e-02]
 [-2.34685086e-03]
 [ 1.19902279e-03]
 [ 3.79136896e-03]
 [-1.51247710e-02]
 [-3.67723221e-03]
 [ 1.28899947e-02]
 [-5.73262047e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.59112941]
curr_Stock_Price:  99.93465346449216
curr_Factors:  [99.93465346]
mat_Sqrt:  [[0.15]]
grads:  [-0.08955313]
Stock Position:  -0.0895531341912114
Bond Position:  [9.54059084]


portfolio before change:  [0.5885985]
curr_Stock_Price:  99.96957367945652
curr_Factors:  [99.96957368]
mat_Sqrt:  [[0.15]]
grads:  [0.06752159]
Stock Position:  0.06752159099844685
Bond Position:  [-6.16150617]


portfolio before change:  [0.61436055]
curr_Stock_Price:  100.35681508368714
curr_Factors:  [100.35681508]
mat_Sqrt:  [[0.15]]
grads:  [0.08464064]
Stock Position:  0.08464064418595059
Bond Position:  [-7.87990493]


portfolio before change:  [0.64452335]
curr_Stock_Price:  100.71899706417688
curr_Factors:  [100.71899706]
mat_Sqrt:  [[0.15]]
grads:  [-0.11427606]
Stock Position:  -0.11427606057593544
Bond Position:  [12.15429356]


portfolio before change:  [0.7618467]
curr_Stock_Price:  99.69897874826904
curr_Factors:  [99.69897875]
mat_Sqrt:  [[0.15]]
grads:  [0.09528305]
Stock Position:  0.095283051662826
Bond Position:  [-8.73777625]


portfolio before change:  [0.84554903]
curr_Stock_Price:  100.58317017960132
curr_Factors:  [100.58317018]
mat_Sqrt:  [[0.15]]
grads:  [-0.01254681]
Stock Position:  -0.012546809155196867
Bond Position:  [2.10754687]


portfolio before change:  [0.84531104]
curr_Stock_Price:  100.61263651506405
curr_Factors:  [100.61263652]
mat_Sqrt:  [[0.15]]
grads:  [-0.03494708]
Stock Position:  -0.034947080689954266
Bond Position:  [4.36142897]


portfolio before change:  [0.85731138]
curr_Stock_Price:  100.27705076260801
curr_Factors:  [100.27705076]
mat_Sqrt:  [[0.15]]
grads:  [-0.07277904]
Stock Position:  -0.07277904137249101
Bond Position:  [8.15537901]


portfolio before change:  [0.7931984]
curr_Stock_Price:  101.1649809888543
curr_Factors:  [101.16498099]
mat_Sqrt:  [[0.15]]
grads:  [0.07462576]
Stock Position:  0.07462575766593561
Bond Position:  [-6.75631495]


portfolio before change:  [0.82844043]
curr_Stock_Price:  101.64288985378218
curr_Factors:  [101.64288985]
mat_Sqrt:  [[0.15]]
grads:  [-0.03603502]
Stock Position:  -0.03603502413022333
Bond Position:  [4.49114442]


portfolio before change:  [0.8497579]
curr_Stock_Price:  101.05910320424685
curr_Factors:  [101.0591032]
mat_Sqrt:  [[0.15]]
grads:  [-0.0371962]
Stock Position:  -0.037196195825418686
Bond Position:  [4.60877209]


portfolio before change:  [0.8684422]
curr_Stock_Price:  100.56452998023154
curr_Factors:  [100.56452998]
mat_Sqrt:  [[0.15]]
grads:  [0.00043273]
Stock Position:  0.00043273168018494873
Bond Position:  [0.82492474]


portfolio before change:  [0.86845837]
curr_Stock_Price:  100.48274376152472
curr_Factors:  [100.48274376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777187]
Stock Position:  -0.01777186541749104
Bond Position:  [2.65422417]


portfolio before change:  [0.87552222]
curr_Stock_Price:  100.09460461491905
curr_Factors:  [100.09460461]
mat_Sqrt:  [[0.15]]
grads:  [0.0643052]
Stock Position:  0.06430520286234268
Bond Position:  [-5.56108164]


portfolio before change:  [0.86719249]
curr_Stock_Price:  99.97047541249212
curr_Factors:  [99.97047541]
mat_Sqrt:  [[0.15]]
grads:  [-0.00452376]
Stock Position:  -0.004523758671665518
Bond Position:  [1.31943479]


portfolio before change:  [0.86696104]
curr_Stock_Price:  100.03986772116461
curr_Factors:  [100.03986772]
mat_Sqrt:  [[0.15]]
grads:  [0.08795581]
Stock Position:  0.08795581142545614
Bond Position:  [-7.9321267]


portfolio before change:  [0.91025437]
curr_Stock_Price:  100.53772119570351
curr_Factors:  [100.5377212]
mat_Sqrt:  [[0.15]]
grads:  [0.29003814]
Stock Position:  0.29003814407950995
Bond Position:  [-28.24951969]


portfolio before change:  [0.9728377]
curr_Stock_Price:  100.75958503788138
curr_Factors:  [100.75958504]
mat_Sqrt:  [[0.15]]
grads:  [-0.09770407]
Stock Position:  -0.0977040654697301
Bond Position:  [10.81745879]


portfolio before change:  [0.89830523]
curr_Stock_Price:  101.52934406044986
curr_Factors:  [101.52934406]
mat_Sqrt:  [[0.15]]
grads:  [0.12467583]
Stock Position:  0.12467583439944574
Bond Position:  [-11.75995046]


portfolio before change:  [0.87827452]
curr_Stock_Price:  101.37457720382658
curr_Factors:  [101.3745772]
mat_Sqrt:  [[0.15]]
grads:  [0.01013987]
Stock Position:  0.010139873839239656
Bond Position:  [-0.1496509]


portfolio before change:  [0.87586889]
curr_Stock_Price:  101.13825555023575
curr_Factors:  [101.13825555]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502437]
Stock Position:  -0.025024371037312226
Bond Position:  [3.40679013]


portfolio before change:  [0.89099844]
curr_Stock_Price:  100.54217197820705
curr_Factors:  [100.54217198]
mat_Sqrt:  [[0.15]]
grads:  [0.02801689]
Stock Position:  0.028016892488271685
Bond Position:  [-1.92588078]


portfolio before change:  [0.89877197]
curr_Stock_Price:  100.82392713209119
curr_Factors:  [100.82392713]
mat_Sqrt:  [[0.15]]
grads:  [0.10017479]
Stock Position:  0.10017478761444826
Bond Position:  [-9.20124351]


portfolio before change:  [0.86833193]
curr_Stock_Price:  100.5257987246482
curr_Factors:  [100.52579872]
mat_Sqrt:  [[0.15]]
grads:  [0.11917859]
Stock Position:  0.11917858909856235
Bond Position:  [-11.11219093]


portfolio before change:  [0.85769168]
curr_Stock_Price:  100.44234649466966
curr_Factors:  [100.44234649]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266925]
Stock Position:  -0.026692497692060013
Bond Position:  [3.53874878]


portfolio before change:  [0.84972256]
curr_Stock_Price:  100.74918549971339
curr_Factors:  [100.7491855]
mat_Sqrt:  [[0.15]]
grads:  [0.04287734]
Stock Position:  0.04287733742967201
Bond Position:  [-3.47013427]


portfolio before change:  [0.84254633]
curr_Stock_Price:  100.58687750941087
curr_Factors:  [100.58687751]
mat_Sqrt:  [[0.15]]
grads:  [-0.03100724]
Stock Position:  -0.031007241102667928
Bond Position:  [3.96146789]


portfolio before change:  [0.83771221]
curr_Stock_Price:  100.7507656944566
curr_Factors:  [100.75076569]
mat_Sqrt:  [[0.15]]
grads:  [0.03906795]
Stock Position:  0.039067949138858304
Bond Position:  [-3.09841358]


portfolio before change:  [0.81763275]
curr_Stock_Price:  100.24176006111249
curr_Factors:  [100.24176006]
mat_Sqrt:  [[0.15]]
grads:  [0.18290096]
Stock Position:  0.18290095924170174
Bond Position:  [-17.51668132]


portfolio before change:  [1.0462459]
curr_Stock_Price:  101.49767462223038
curr_Factors:  [101.49767462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00267995]
Stock Position:  -0.0026799461571659867
Bond Position:  [1.3182542]


portfolio before change:  [1.04463522]
curr_Stock_Price:  102.12943026502116
curr_Factors:  [102.12943027]
mat_Sqrt:  [[0.15]]
grads:  [-0.01432062]
Stock Position:  -0.014320618976536432
Bond Position:  [2.50719188]


portfolio before change:  [1.04726584]
curr_Stock_Price:  101.95667814130296
curr_Factors:  [101.95667814]
mat_Sqrt:  [[0.15]]
grads:  [0.09008078]
Stock Position:  0.0900807767408477
Bond Position:  [-8.13707092]


portfolio before change:  [1.08480729]
curr_Stock_Price:  102.37907714448572
curr_Factors:  [102.37907714]
mat_Sqrt:  [[0.15]]
grads:  [0.09022075]
Stock Position:  0.09022074910267315
Bond Position:  [-8.15190974]


portfolio before change:  [1.07823247]
curr_Stock_Price:  102.31184967934631
curr_Factors:  [102.31184968]
mat_Sqrt:  [[0.15]]
grads:  [0.01350048]
Stock Position:  0.01350048265252107
Bond Position:  [-0.30302689]


portfolio before change:  [1.07614312]
curr_Stock_Price:  102.15849204762212
curr_Factors:  [102.15849205]
mat_Sqrt:  [[0.15]]
grads:  [0.04221688]
Stock Position:  0.04221688029972407
Bond Position:  [-3.23666971]


portfolio before change:  [1.07021766]
curr_Stock_Price:  102.02292619160366
curr_Factors:  [102.02292619]
mat_Sqrt:  [[0.15]]
grads:  [0.09939302]
Stock Position:  0.09939301806227616
Bond Position:  [-9.07014889]


portfolio before change:  [1.13078042]
curr_Stock_Price:  102.63795597868892
curr_Factors:  [102.63795598]
mat_Sqrt:  [[0.15]]
grads:  [-0.13689794]
Stock Position:  -0.1368979383213112
Bond Position:  [15.18170499]


portfolio before change:  [1.1668343]
curr_Stock_Price:  102.38152414108959
curr_Factors:  [102.38152414]
mat_Sqrt:  [[0.15]]
grads:  [-0.01727771]
Stock Position:  -0.017277713634825973
Bond Position:  [2.93575296]


portfolio before change:  [1.15962239]
curr_Stock_Price:  102.80955545504698
curr_Factors:  [102.80955546]
mat_Sqrt:  [[0.15]]
grads:  [-0.16596252]
Stock Position:  -0.16596252389174396
Bond Position:  [18.22215569]


portfolio before change:  [1.15812608]
curr_Stock_Price:  102.82543390911464
curr_Factors:  [102.82543391]
mat_Sqrt:  [[0.15]]
grads:  [-0.0979711]
Stock Position:  -0.09797110250838686
Bond Position:  [11.23204721]


portfolio before change:  [1.15035217]
curr_Stock_Price:  102.91194854289573
curr_Factors:  [102.91194854]
mat_Sqrt:  [[0.15]]
grads:  [0.02597255]
Stock Position:  0.025972553094355443
Bond Position:  [-1.52253388]


portfolio before change:  [1.17479593]
curr_Stock_Price:  103.85675045384804
curr_Factors:  [103.85675045]
mat_Sqrt:  [[0.15]]
grads:  [0.05099252]
Stock Position:  0.050992517891001975
Bond Position:  [-4.12112128]


portfolio before change:  [1.18980568]
curr_Stock_Price:  104.15615378023547
curr_Factors:  [104.15615378]
mat_Sqrt:  [[0.15]]
grads:  [-0.07874829]
Stock Position:  -0.07874828801247168
Bond Position:  [9.39192447]


portfolio before change:  [1.25542603]
curr_Stock_Price:  103.3303156299356
curr_Factors:  [103.33031563]
mat_Sqrt:  [[0.15]]
grads:  [0.0194083]
Stock Position:  0.01940830223075381
Bond Position:  [-0.75003996]


portfolio before change:  [1.25945781]
curr_Stock_Price:  103.54046558218343
curr_Factors:  [103.54046558]
mat_Sqrt:  [[0.15]]
grads:  [0.03016187]
Stock Position:  0.030161872988597866
Bond Position:  [-1.86351656]


portfolio before change:  [1.26940315]
curr_Stock_Price:  103.87405931160235
curr_Factors:  [103.87405931]
mat_Sqrt:  [[0.15]]
grads:  [0.07832733]
Stock Position:  0.07832733073057364
Bond Position:  [-6.86677465]


portfolio before change:  [1.28854952]
curr_Stock_Price:  104.12397921482044
curr_Factors:  [104.12397921]
mat_Sqrt:  [[0.15]]
grads:  [0.0704234]
Stock Position:  0.0704234031593668
Bond Position:  [-6.04421545]


portfolio before change:  [1.29664156]
curr_Stock_Price:  104.24424920836798
curr_Factors:  [104.24424921]
mat_Sqrt:  [[0.15]]
grads:  [-0.0161476]
Stock Position:  -0.016147595349161863
Bond Position:  [2.97993552]


portfolio before change:  [1.29492781]
curr_Stock_Price:  104.36191401581134
curr_Factors:  [104.36191402]
mat_Sqrt:  [[0.15]]
grads:  [0.08627557]
Stock Position:  0.08627556506250701
Bond Position:  [-7.70895529]


portfolio before change:  [1.24924093]
curr_Stock_Price:  103.83795270160336
curr_Factors:  [103.8379527]
mat_Sqrt:  [[0.15]]
grads:  [-0.00875522]
Stock Position:  -0.008755215038303546
Bond Position:  [2.15836453]


portfolio before change:  [1.24187307]
curr_Stock_Price:  104.69490026899295
curr_Factors:  [104.69490027]
mat_Sqrt:  [[0.15]]
grads:  [0.13869703]
Stock Position:  0.1386970273933728
Bond Position:  [-13.27899838]


portfolio before change:  [1.13134558]
curr_Stock_Price:  103.90398546097656
curr_Factors:  [103.90398546]
mat_Sqrt:  [[0.15]]
grads:  [0.03202]
Stock Position:  0.03202000381173415
Bond Position:  [-2.19566044]


portfolio before change:  [1.10898421]
curr_Stock_Price:  103.20991512137785
curr_Factors:  [103.20991512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00878544]
Stock Position:  -0.008785444228628566
Bond Position:  [2.01572916]


portfolio before change:  [1.10367952]
curr_Stock_Price:  103.82806014835954
curr_Factors:  [103.82806015]
mat_Sqrt:  [[0.15]]
grads:  [-0.14865455]
Stock Position:  -0.1486545538339006
Bond Position:  [16.53819347]


portfolio before change:  [1.09296215]
curr_Stock_Price:  103.90710944059018
curr_Factors:  [103.90710944]
mat_Sqrt:  [[0.15]]
grads:  [-0.03695218]
Stock Position:  -0.036952178647226275
Bond Position:  [4.93255622]


portfolio before change:  [1.10931166]
curr_Stock_Price:  103.47300195002148
curr_Factors:  [103.47300195]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198036]
Stock Position:  -0.0198035962167692
Bond Position:  [3.15844921]


portfolio before change:  [1.1039368]
curr_Stock_Price:  103.75437864112736
curr_Factors:  [103.75437864]
mat_Sqrt:  [[0.15]]
grads:  [0.06144758]
Stock Position:  0.06144758179454536
Bond Position:  [-5.27151887]


portfolio before change:  [1.1918234]
curr_Stock_Price:  105.19001011541748
curr_Factors:  [105.19001012]
mat_Sqrt:  [[0.15]]
grads:  [-0.11378399]
Stock Position:  -0.11378398526928804
Bond Position:  [13.16076196]


portfolio before change:  [1.21298008]
curr_Stock_Price:  105.01130216724465
curr_Factors:  [105.01130217]
mat_Sqrt:  [[0.15]]
grads:  [0.01863973]
Stock Position:  0.018639733402787167
Bond Position:  [-0.7444026]


portfolio before change:  [1.22388679]
curr_Stock_Price:  105.59893078638382
curr_Factors:  [105.59893079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02119066]
Stock Position:  -0.0211906636059007
Bond Position:  [3.46159821]


portfolio before change:  [1.23069133]
curr_Stock_Price:  105.28803063410606
curr_Factors:  [105.28803063]
mat_Sqrt:  [[0.15]]
grads:  [-0.04273113]
Stock Position:  -0.04273113449869523
Bond Position:  [5.72976833]


portfolio before change:  [1.25462295]
curr_Stock_Price:  104.73636033971346
curr_Factors:  [104.73636034]
mat_Sqrt:  [[0.15]]
grads:  [0.02322704]
Stock Position:  0.02322704450776036
Bond Position:  [-1.17809316]


portfolio before change:  [1.24199776]
curr_Stock_Price:  104.19597518905184
curr_Factors:  [104.19597519]
mat_Sqrt:  [[0.15]]
grads:  [-0.13172791]
Stock Position:  -0.1317279113412602
Bond Position:  [14.96751595]


portfolio before change:  [1.29484414]
curr_Stock_Price:  103.80189863495613
curr_Factors:  [103.80189863]
mat_Sqrt:  [[0.15]]
grads:  [0.00650276]
Stock Position:  0.006502764286774192
Bond Position:  [0.61984487]


portfolio before change:  [1.29480794]
curr_Stock_Price:  103.79037281464976
curr_Factors:  [103.79037281]
mat_Sqrt:  [[0.15]]
grads:  [0.12109068]
Stock Position:  0.12109068441062468
Bond Position:  [-11.27323934]


portfolio before change:  [1.30279904]
curr_Stock_Price:  103.86218432436563
curr_Factors:  [103.86218432]
mat_Sqrt:  [[0.15]]
grads:  [0.08105245]
Stock Position:  0.08105245372838676
Bond Position:  [-7.11548585]


portfolio before change:  [1.28059903]
curr_Stock_Price:  103.59377440347679
curr_Factors:  [103.5937744]
mat_Sqrt:  [[0.15]]
grads:  [0.06862676]
Stock Position:  0.06862675872868806
Bond Position:  [-5.82870593]


portfolio before change:  [1.31468326]
curr_Stock_Price:  104.09574381233385
curr_Factors:  [104.09574381]
mat_Sqrt:  [[0.15]]
grads:  [0.0704154]
Stock Position:  0.07041539736048513
Bond Position:  [-6.01525991]


portfolio before change:  [1.26846988]
curr_Stock_Price:  103.44478658064878
curr_Factors:  [103.44478658]
mat_Sqrt:  [[0.15]]
grads:  [0.04036142]
Stock Position:  0.0403614210076611
Bond Position:  [-2.9067087]


portfolio before change:  [1.26794064]
curr_Stock_Price:  103.43617522911472
curr_Factors:  [103.43617523]
mat_Sqrt:  [[0.15]]
grads:  [0.08664674]
Stock Position:  0.08664673621206202
Bond Position:  [-7.69446635]


portfolio before change:  [1.27853685]
curr_Stock_Price:  103.56401774369377
curr_Factors:  [103.56401774]
mat_Sqrt:  [[0.15]]
grads:  [0.00630999]
Stock Position:  0.006309990374236101
Bond Position:  [0.6250489]


portfolio before change:  [1.27880163]
curr_Stock_Price:  103.59978722450695
curr_Factors:  [103.59978722]
mat_Sqrt:  [[0.15]]
grads:  [-0.10224273]
Stock Position:  -0.10224273154253205
Bond Position:  [11.87112686]


portfolio before change:  [1.3106008]
curr_Stock_Price:  103.29602764746495
curr_Factors:  [103.29602765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01564567]
Stock Position:  -0.015645672376442335
Bond Position:  [2.92673661]


portfolio before change:  [1.31993012]
curr_Stock_Price:  102.71143207846872
curr_Factors:  [102.71143208]
mat_Sqrt:  [[0.15]]
grads:  [0.00799349]
Stock Position:  0.007993485240863506
Bond Position:  [0.4989078]


portfolio before change:  [1.32302224]
curr_Stock_Price:  103.09436070078443
curr_Factors:  [103.0943607]
mat_Sqrt:  [[0.15]]
grads:  [0.02527579]
Stock Position:  0.025275793061465605
Bond Position:  [-1.28276949]


portfolio before change:  [1.30879342]
curr_Stock_Price:  102.53459044924894
curr_Factors:  [102.53459045]
mat_Sqrt:  [[0.15]]
grads:  [-0.10083181]
Stock Position:  -0.10083180694599173
Bond Position:  [11.64754145]


portfolio before change:  [1.27566342]
curr_Stock_Price:  102.87037733230979
curr_Factors:  [102.87037733]
mat_Sqrt:  [[0.15]]
grads:  [-0.02451488]
Stock Position:  -0.02451488137948353
Bond Position:  [3.79751852]


portfolio before change:  [1.27131252]
curr_Stock_Price:  103.0575393590858
curr_Factors:  [103.05753936]
mat_Sqrt:  [[0.15]]
grads:  [0.0859333]
Stock Position:  0.08593329799679791
Bond Position:  [-7.58476172]


portfolio before change:  [1.35824774]
curr_Stock_Price:  104.07471528202593
curr_Factors:  [104.07471528]
mat_Sqrt:  [[0.15]]
grads:  [-0.03821747]
Stock Position:  -0.038217469795901696
Bond Position:  [5.33572003]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.39348265]
Stock Price:  103.16148325883582
PL:  [-1.76800061]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.00759023e-03]
 [ 1.93390446e-02]
 [ 2.04715021e-02]
 [-2.82330523e-02]
 [-3.52430260e-03]
 [-1.28521456e-03]
 [-3.63175024e-03]
 [-1.40782263e-02]
 [ 1.20024491e-02]
 [-3.51860633e-03]
 [-9.09827835e-03]
 [ 1.42909502e-02]
 [-3.03106967e-03]
 [ 9.09381280e-03]
 [ 4.24909670e-06]
 [ 1.31493309e-02]
 [ 2.99477649e-02]
 [-1.50202565e-02]
 [ 1.97719611e-02]
 [ 2.67569020e-03]
 [-4.36262446e-03]
 [ 4.55808822e-03]
 [ 1.56329835e-02]
 [ 1.74560630e-02]
 [-4.99316078e-03]
 [ 4.55249747e-03]
 [ 9.66215704e-03]
 [ 8.04581200e-03]
 [ 2.67569650e-02]
 [ 1.88808882e-03]
 [-8.13203649e-03]
 [ 7.55855150e-03]
 [ 1.17820730e-02]
 [-3.72386478e-03]
 [ 4.07125846e-03]
 [ 1.91709919e-02]
 [ 4.56237166e-03]
 [-4.41126634e-04]
 [-2.17179442e-02]
 [-1.55725085e-02]
 [ 7.11886448e-03]
 [ 2.67513268e-02]
 [-2.19352863e-03]
 [ 1.84916646e-04]
 [-9.71703801e-03]
 [ 1.68253512e-02]
 [ 1.00044574e-02]
 [ 5.30026059e-03]
 [-7.67923356e-03]
 [-9.06230351e-04]
 [-6.17966445e-03]
 [-1.11462371e-03]
 [ 1.68748589e-03]
 [ 5.80101421e-03]
 [-6.47035586e-03]
 [-4.38381325e-03]
 [ 3.64700212e-03]
 [ 4.49186733e-03]
 [ 7.21807643e-03]
 [-4.02704546e-03]
 [-1.98223578e-04]
 [ 5.08030449e-03]
 [-6.74856719e-03]
 [ 4.89395741e-03]
 [ 1.98088811e-02]
 [ 5.41195927e-03]
 [ 7.43377837e-03]
 [-2.44934428e-04]
 [ 2.94156479e-03]
 [ 2.15760281e-02]
 [ 2.43057264e-03]
 [-1.56557862e-02]
 [-5.66923915e-03]
 [ 1.05465920e-03]
 [ 4.65078976e-03]
 [ 5.61952481e-04]
 [-1.49695258e-03]
 [-6.25235437e-03]
 [-2.27353692e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.1085017]
curr_Stock_Price:  100.50316686250514
curr_Factors:  [100.50316686]
mat_Sqrt:  [[0.15]]
grads:  [-0.02671727]
Stock Position:  -0.026717268195436742
Bond Position:  [15.79367177]


portfolio before change:  [13.11313215]
curr_Stock_Price:  100.3668013437194
curr_Factors:  [100.36680134]
mat_Sqrt:  [[0.15]]
grads:  [0.12892696]
Stock Position:  0.12892696414265428
Bond Position:  [0.17314516]


portfolio before change:  [13.18519211]
curr_Stock_Price:  100.92563815646133
curr_Factors:  [100.92563816]
mat_Sqrt:  [[0.15]]
grads:  [0.13647668]
Stock Position:  0.1364766804455175
Bond Position:  [-0.58880396]


portfolio before change:  [13.24127689]
curr_Stock_Price:  101.33685556147583
curr_Factors:  [101.33685556]
mat_Sqrt:  [[0.15]]
grads:  [-0.18822035]
Stock Position:  -0.18822034864843806
Bond Position:  [32.31493518]


portfolio before change:  [13.37869957]
curr_Stock_Price:  100.6174703761465
curr_Factors:  [100.61747038]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349535]
Stock Position:  -0.023495350680286624
Bond Position:  [15.74274232]


portfolio before change:  [13.37244996]
curr_Stock_Price:  100.92534233292224
curr_Factors:  [100.92534233]
mat_Sqrt:  [[0.15]]
grads:  [-0.0085681]
Stock Position:  -0.008568097085489997
Bond Position:  [14.23718809]


portfolio before change:  [13.3767663]
curr_Stock_Price:  100.52542992206818
curr_Factors:  [100.52542992]
mat_Sqrt:  [[0.15]]
grads:  [-0.02421167]
Stock Position:  -0.02421166828023155
Bond Position:  [15.81065467]


portfolio before change:  [13.38050303]
curr_Stock_Price:  100.4119091045472
curr_Factors:  [100.4119091]
mat_Sqrt:  [[0.15]]
grads:  [-0.09385484]
Stock Position:  -0.09385484167437777
Bond Position:  [22.80464686]


portfolio before change:  [13.30430946]
curr_Stock_Price:  101.23891920378708
curr_Factors:  [101.2389192]
mat_Sqrt:  [[0.15]]
grads:  [0.08001633]
Stock Position:  0.08001632761030882
Bond Position:  [5.20354294]


portfolio before change:  [13.31603525]
curr_Stock_Price:  101.38139706863905
curr_Factors:  [101.38139707]
mat_Sqrt:  [[0.15]]
grads:  [-0.02345738]
Stock Position:  -0.023457375506904764
Bond Position:  [15.69417675]


portfolio before change:  [13.31406032]
curr_Stock_Price:  101.50740633103612
curr_Factors:  [101.50740633]
mat_Sqrt:  [[0.15]]
grads:  [-0.06065519]
Stock Position:  -0.06065518899400003
Bond Position:  [19.47101123]


portfolio before change:  [13.3112341]
curr_Stock_Price:  101.57406509064714
curr_Factors:  [101.57406509]
mat_Sqrt:  [[0.15]]
grads:  [0.095273]
Stock Position:  0.09527300116228687
Bond Position:  [3.63396807]


portfolio before change:  [13.233224]
curr_Stock_Price:  100.75287515697565
curr_Factors:  [100.75287516]
mat_Sqrt:  [[0.15]]
grads:  [-0.02020713]
Stock Position:  -0.020207131107914007
Bond Position:  [15.26915055]


portfolio before change:  [13.24513721]
curr_Stock_Price:  100.21054890719837
curr_Factors:  [100.21054891]
mat_Sqrt:  [[0.15]]
grads:  [0.06062542]
Stock Position:  0.06062541867046335
Bond Position:  [7.16983072]


portfolio before change:  [13.22180154]
curr_Stock_Price:  99.81824154804492
curr_Factors:  [99.81824155]
mat_Sqrt:  [[0.15]]
grads:  [2.83273113e-05]
Stock Position:  2.832731134850645e-05
Bond Position:  [13.21897395]


portfolio before change:  [13.22263349]
curr_Stock_Price:  100.02086600738514
curr_Factors:  [100.02086601]
mat_Sqrt:  [[0.15]]
grads:  [0.08766221]
Stock Position:  0.08766220567042242
Bond Position:  [4.45458376]


portfolio before change:  [13.19838584]
curr_Stock_Price:  99.7410867331335
curr_Factors:  [99.74108673]
mat_Sqrt:  [[0.15]]
grads:  [0.19965177]
Stock Position:  0.19965176567911558
Bond Position:  [-6.71509824]


portfolio before change:  [13.1909613]
curr_Stock_Price:  99.70600146920965
curr_Factors:  [99.70600147]
mat_Sqrt:  [[0.15]]
grads:  [-0.10013504]
Stock Position:  -0.10013504316830567
Bond Position:  [23.17502606]


portfolio before change:  [13.15005684]
curr_Stock_Price:  100.12895975593251
curr_Factors:  [100.12895976]
mat_Sqrt:  [[0.15]]
grads:  [0.13181307]
Stock Position:  0.13181307424321137
Bond Position:  [-0.04824917]


portfolio before change:  [13.15057786]
curr_Stock_Price:  100.13293535485752
curr_Factors:  [100.13293535]
mat_Sqrt:  [[0.15]]
grads:  [0.01783793]
Stock Position:  0.017837934655948073
Bond Position:  [11.3644131]


portfolio before change:  [13.15508545]
curr_Stock_Price:  100.34581292886794
curr_Factors:  [100.34581293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908416]
Stock Position:  -0.02908416309616709
Bond Position:  [16.07355944]


portfolio before change:  [13.17384726]
curr_Stock_Price:  99.73526816487906
curr_Factors:  [99.73526816]
mat_Sqrt:  [[0.15]]
grads:  [0.03038725]
Stock Position:  0.030387254782103825
Bond Position:  [10.14316626]


portfolio before change:  [13.1824385]
curr_Stock_Price:  99.99713012992052
curr_Factors:  [99.99713013]
mat_Sqrt:  [[0.15]]
grads:  [0.10421989]
Stock Position:  0.10421989028005368
Bond Position:  [2.76074857]


portfolio before change:  [13.16788482]
curr_Stock_Price:  99.85583054451597
curr_Factors:  [99.85583054]
mat_Sqrt:  [[0.15]]
grads:  [0.11637375]
Stock Position:  0.11637375356696371
Bond Position:  [1.54728701]


portfolio before change:  [13.1859205]
curr_Stock_Price:  100.0099801273206
curr_Factors:  [100.00998013]
mat_Sqrt:  [[0.15]]
grads:  [-0.03328774]
Stock Position:  -0.03328773856401701
Bond Position:  [16.51502657]


portfolio before change:  [13.19493325]
curr_Stock_Price:  99.77023635605009
curr_Factors:  [99.77023636]
mat_Sqrt:  [[0.15]]
grads:  [0.03034998]
Stock Position:  0.030349983148981234
Bond Position:  [10.16690825]


portfolio before change:  [13.17162612]
curr_Stock_Price:  98.98135349111178
curr_Factors:  [98.98135349]
mat_Sqrt:  [[0.15]]
grads:  [0.06441438]
Stock Position:  0.06441438026463618
Bond Position:  [6.79580357]


portfolio before change:  [13.201092]
curr_Stock_Price:  99.43220210731934
curr_Factors:  [99.43220211]
mat_Sqrt:  [[0.15]]
grads:  [0.05363875]
Stock Position:  0.05363874664141456
Bond Position:  [7.8676733]


portfolio before change:  [13.24276629]
curr_Stock_Price:  100.19997819837927
curr_Factors:  [100.1999782]
mat_Sqrt:  [[0.15]]
grads:  [0.17837977]
Stock Position:  0.1783797669169741
Bond Position:  [-4.63088246]


portfolio before change:  [13.26105918]
curr_Stock_Price:  100.30415103356631
curr_Factors:  [100.30415103]
mat_Sqrt:  [[0.15]]
grads:  [0.01258726]
Stock Position:  0.012587258779161564
Bond Position:  [11.99850487]


portfolio before change:  [13.26105533]
curr_Stock_Price:  100.24426651561336
curr_Factors:  [100.24426652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05421358]
Stock Position:  -0.05421357658334631
Bond Position:  [18.69565555]


portfolio before change:  [13.24876109]
curr_Stock_Price:  100.49259453336919
curr_Factors:  [100.49259453]
mat_Sqrt:  [[0.15]]
grads:  [0.05039034]
Stock Position:  0.050390343361333204
Bond Position:  [8.18490475]


portfolio before change:  [13.19867361]
curr_Stock_Price:  99.48845270268716
curr_Factors:  [99.4884527]
mat_Sqrt:  [[0.15]]
grads:  [0.07854715]
Stock Position:  0.07854715358124952
Bond Position:  [5.38413884]


portfolio before change:  [13.23130262]
curr_Stock_Price:  99.89957502064411
curr_Factors:  [99.89957502]
mat_Sqrt:  [[0.15]]
grads:  [-0.02482577]
Stock Position:  -0.024825765188508087
Bond Position:  [15.71138601]


portfolio before change:  [13.24756538]
curr_Stock_Price:  99.28405464023133
curr_Factors:  [99.28405464]
mat_Sqrt:  [[0.15]]
grads:  [0.02714172]
Stock Position:  0.0271417230559646
Bond Position:  [10.55282506]


portfolio before change:  [13.24614674]
curr_Stock_Price:  99.20748569839341
curr_Factors:  [99.2074857]
mat_Sqrt:  [[0.15]]
grads:  [0.12780661]
Stock Position:  0.12780661285782505
Bond Position:  [0.56677402]


portfolio before change:  [13.06884054]
curr_Stock_Price:  97.81990786805449
curr_Factors:  [97.81990787]
mat_Sqrt:  [[0.15]]
grads:  [0.03041581]
Stock Position:  0.030415811059107043
Bond Position:  [10.0935687]


portfolio before change:  [13.07148857]
curr_Stock_Price:  97.88622744839495
curr_Factors:  [97.88622745]
mat_Sqrt:  [[0.15]]
grads:  [-0.00294084]
Stock Position:  -0.002940844227280086
Bond Position:  [13.35935672]


portfolio before change:  [13.07392297]
curr_Stock_Price:  97.34236549275015
curr_Factors:  [97.34236549]
mat_Sqrt:  [[0.15]]
grads:  [-0.14478629]
Stock Position:  -0.14478629484099162
Bond Position:  [27.1677634]


portfolio before change:  [13.07183587]
curr_Stock_Price:  97.36850839689599
curr_Factors:  [97.3685084]
mat_Sqrt:  [[0.15]]
grads:  [-0.10381672]
Stock Position:  -0.10381672301715276
Bond Position:  [23.18031534]


portfolio before change:  [13.04891171]
curr_Stock_Price:  97.60327765711085
curr_Factors:  [97.60327766]
mat_Sqrt:  [[0.15]]
grads:  [0.0474591]
Stock Position:  0.04745909655953942
Bond Position:  [8.41674833]


portfolio before change:  [13.07110745]
curr_Stock_Price:  98.05987442285846
curr_Factors:  [98.05987442]
mat_Sqrt:  [[0.15]]
grads:  [0.17834218]
Stock Position:  0.17834217879824069
Bond Position:  [-4.41710421]


portfolio before change:  [13.23760876]
curr_Stock_Price:  98.99502836054937
curr_Factors:  [98.99502836]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462352]
Stock Position:  -0.014623524173846918
Bond Position:  [14.68526495]


portfolio before change:  [13.2430538]
curr_Stock_Price:  98.68544602609721
curr_Factors:  [98.68544603]
mat_Sqrt:  [[0.15]]
grads:  [0.00123278]
Stock Position:  0.0012327776411371015
Bond Position:  [13.12139659]


portfolio before change:  [13.24279256]
curr_Stock_Price:  97.80827836095646
curr_Factors:  [97.80827836]
mat_Sqrt:  [[0.15]]
grads:  [-0.06478025]
Stock Position:  -0.06478025339379098
Bond Position:  [19.57883762]


portfolio before change:  [13.24355049]
curr_Stock_Price:  97.81546856420445
curr_Factors:  [97.81546856]
mat_Sqrt:  [[0.15]]
grads:  [0.11216901]
Stock Position:  0.11216900801211713
Bond Position:  [2.27168642]


portfolio before change:  [13.19764919]
curr_Stock_Price:  97.40498721275075
curr_Factors:  [97.40498721]
mat_Sqrt:  [[0.15]]
grads:  [0.06669638]
Stock Position:  0.06669638273506157
Bond Position:  [6.70108889]


portfolio before change:  [13.18805739]
curr_Stock_Price:  97.2548946514567
curr_Factors:  [97.25489465]
mat_Sqrt:  [[0.15]]
grads:  [0.03533507]
Stock Position:  0.035335070600048
Bond Position:  [9.75154882]


portfolio before change:  [13.1892238]
curr_Stock_Price:  97.27065572255107
curr_Factors:  [97.27065572]
mat_Sqrt:  [[0.15]]
grads:  [-0.05119489]
Stock Position:  -0.051194890392252924
Bond Position:  [18.16898436]


portfolio before change:  [13.15085544]
curr_Stock_Price:  98.04229435810345
curr_Factors:  [98.04229436]
mat_Sqrt:  [[0.15]]
grads:  [-0.00604154]
Stock Position:  -0.0060415356711953664
Bond Position:  [13.74318146]


portfolio before change:  [13.14391334]
curr_Stock_Price:  99.3335349461003
curr_Factors:  [99.33353495]
mat_Sqrt:  [[0.15]]
grads:  [-0.04119776]
Stock Position:  -0.04119776299760135
Bond Position:  [17.23623277]


portfolio before change:  [13.16094471]
curr_Stock_Price:  98.94627923118462
curr_Factors:  [98.94627923]
mat_Sqrt:  [[0.15]]
grads:  [-0.00743082]
Stock Position:  -0.007430824750380433
Bond Position:  [13.89619717]


portfolio before change:  [13.15947973]
curr_Stock_Price:  99.2603121360579
curr_Factors:  [99.26031214]
mat_Sqrt:  [[0.15]]
grads:  [0.01124991]
Stock Position:  0.011249905904638645
Bond Position:  [12.04281056]


portfolio before change:  [13.16126895]
curr_Stock_Price:  99.35244875072179
curr_Factors:  [99.35244875]
mat_Sqrt:  [[0.15]]
grads:  [0.03867343]
Stock Position:  0.03867342809555607
Bond Position:  [9.31896917]


portfolio before change:  [13.1568971]
curr_Stock_Price:  99.22434250254487
curr_Factors:  [99.2243425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04313571]
Stock Position:  -0.04313570573640662
Bond Position:  [17.43700914]


portfolio before change:  [13.15288201]
curr_Stock_Price:  99.34268860092116
curr_Factors:  [99.3426886]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922542]
Stock Position:  -0.029225421666485604
Bond Position:  [16.05621397]


portfolio before change:  [13.14723198]
curr_Stock_Price:  99.57035254221586
curr_Factors:  [99.57035254]
mat_Sqrt:  [[0.15]]
grads:  [0.02431335]
Stock Position:  0.02431334747830996
Bond Position:  [10.7263434]


portfolio before change:  [13.15308889]
curr_Stock_Price:  99.78367165161103
curr_Factors:  [99.78367165]
mat_Sqrt:  [[0.15]]
grads:  [0.02994578]
Stock Position:  0.029945782203214696
Bond Position:  [10.1649888]


portfolio before change:  [13.15369945]
curr_Stock_Price:  99.78284424874138
curr_Factors:  [99.78284425]
mat_Sqrt:  [[0.15]]
grads:  [0.04812051]
Stock Position:  0.0481205095085014
Bond Position:  [8.35209814]


portfolio before change:  [13.18564923]
curr_Stock_Price:  100.43594951313538
curr_Factors:  [100.43594951]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684697]
Stock Position:  -0.026846969700254127
Bond Position:  [15.88205012]


portfolio before change:  [13.20020736]
curr_Stock_Price:  99.93066061504683
curr_Factors:  [99.93066062]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132149]
Stock Position:  -0.0013214905195455043
Bond Position:  [13.33226479]


portfolio before change:  [13.20082136]
curr_Stock_Price:  100.09660997094107
curr_Factors:  [100.09660997]
mat_Sqrt:  [[0.15]]
grads:  [0.0338687]
Stock Position:  0.03386869659343419
Bond Position:  [9.81067964]


portfolio before change:  [13.17968164]
curr_Stock_Price:  99.45433847415711
curr_Factors:  [99.45433847]
mat_Sqrt:  [[0.15]]
grads:  [-0.04499045]
Stock Position:  -0.044990447920162394
Bond Position:  [17.65417688]


portfolio before change:  [13.20011197]
curr_Stock_Price:  99.02476055521122
curr_Factors:  [99.02476056]
mat_Sqrt:  [[0.15]]
grads:  [0.03262638]
Stock Position:  0.03262638270902465
Bond Position:  [9.96929223]


portfolio before change:  [13.20920963]
curr_Stock_Price:  99.28450633683826
curr_Factors:  [99.28450634]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [0.09777646]


portfolio before change:  [13.23397079]
curr_Stock_Price:  99.47196046623318
curr_Factors:  [99.47196047]
mat_Sqrt:  [[0.15]]
grads:  [0.03607973]
Stock Position:  0.0360797284602073
Bond Position:  [9.64504947]


portfolio before change:  [13.25330917]
curr_Stock_Price:  99.99124221312984
curr_Factors:  [99.99124221]
mat_Sqrt:  [[0.15]]
grads:  [0.04955852]
Stock Position:  0.0495585224932871
Bond Position:  [8.29789094]


portfolio before change:  [13.21939126]
curr_Stock_Price:  99.29637600349041
curr_Factors:  [99.296376]
mat_Sqrt:  [[0.15]]
grads:  [-0.0016329]
Stock Position:  -0.0016328961842794736
Bond Position:  [13.38153193]


portfolio before change:  [13.21928444]
curr_Stock_Price:  99.87399519174436
curr_Factors:  [99.87399519]
mat_Sqrt:  [[0.15]]
grads:  [0.01961043]
Stock Position:  0.019610431918644325
Bond Position:  [11.26071226]


portfolio before change:  [13.21305867]
curr_Stock_Price:  99.52063305036289
curr_Factors:  [99.52063305]
mat_Sqrt:  [[0.15]]
grads:  [0.14384019]
Stock Position:  0.14384018749397373
Bond Position:  [-1.10200785]


portfolio before change:  [13.10878153]
curr_Stock_Price:  98.79616052340913
curr_Factors:  [98.79616052]
mat_Sqrt:  [[0.15]]
grads:  [0.01620382]
Stock Position:  0.016203817614430564
Bond Position:  [11.50790656]


portfolio before change:  [13.09066467]
curr_Stock_Price:  97.63371042304185
curr_Factors:  [97.63371042]
mat_Sqrt:  [[0.15]]
grads:  [-0.10437191]
Stock Position:  -0.10437190772993583
Bond Position:  [23.28088128]


portfolio before change:  [13.05681123]
curr_Stock_Price:  97.97200581244859
curr_Factors:  [97.97200581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03779493]
Stock Position:  -0.037794927642018805
Bond Position:  [16.7596561]


portfolio before change:  [13.05091676]
curr_Stock_Price:  98.15568083831728
curr_Factors:  [98.15568084]
mat_Sqrt:  [[0.15]]
grads:  [0.00703106]
Stock Position:  0.00703106134577442
Bond Position:  [12.36077815]


portfolio before change:  [13.05586391]
curr_Stock_Price:  98.74941488774203
curr_Factors:  [98.74941489]
mat_Sqrt:  [[0.15]]
grads:  [0.03100527]
Stock Position:  0.031005265099703465
Bond Position:  [9.99411213]


portfolio before change:  [13.02582163]
curr_Stock_Price:  97.7603270201065
curr_Factors:  [97.76032702]
mat_Sqrt:  [[0.15]]
grads:  [0.00374635]
Stock Position:  0.003746349875961974
Bond Position:  [12.65957724]


portfolio before change:  [13.02711568]
curr_Stock_Price:  97.8945378984499
curr_Factors:  [97.8945379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00997968]
Stock Position:  -0.009979683889336188
Bond Position:  [14.00407222]


portfolio before change:  [13.03224562]
curr_Stock_Price:  97.46820658644626
curr_Factors:  [97.46820659]
mat_Sqrt:  [[0.15]]
grads:  [-0.04168236]
Stock Position:  -0.041682362499508775
Bond Position:  [17.09495073]


portfolio before change:  [13.04874585]
curr_Stock_Price:  97.09798371247643
curr_Factors:  [97.09798371]
mat_Sqrt:  [[0.15]]
grads:  [-0.15156913]
Stock Position:  -0.15156912767715744
Bond Position:  [27.76580254]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.12012364]
Stock Price:  96.63850768769403
PL:  [13.12012364]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.61947547e-03]
 [ 4.05140315e-02]
 [ 2.05053280e-02]
 [-2.02756837e-02]
 [-1.09136588e-02]
 [-1.21618073e-03]
 [-2.29069361e-03]
 [-4.53311637e-02]
 [ 1.68831080e-02]
 [-6.70019372e-03]
 [-1.04617627e-02]
 [ 1.84707398e-02]
 [-4.09240144e-03]
 [ 4.11373506e-03]
 [-2.03157669e-03]
 [ 1.27513836e-02]
 [ 4.07274168e-02]
 [-1.35624805e-02]
 [ 2.11034251e-02]
 [ 1.47720746e-03]
 [-3.77719037e-03]
 [ 4.67289080e-03]
 [ 9.85017154e-03]
 [ 3.66116145e-02]
 [-2.05539294e-03]
 [ 6.94761582e-03]
 [-6.10379873e-03]
 [ 1.79443669e-02]
 [ 1.92068161e-02]
 [-7.33405984e-03]
 [ 6.37974980e-03]
 [ 1.60432713e-02]
 [ 1.68759758e-02]
 [-1.12089197e-02]
 [ 3.70664108e-03]
 [-3.01037430e-02]
 [-8.45705694e-03]
 [-1.97825899e-02]
 [ 3.47544399e-02]
 [-1.02925909e-01]
 [ 2.91203549e-03]
 [-1.44862570e-02]
 [-2.52372843e-02]
 [ 3.71240929e-02]
 [-2.44365712e-02]
 [ 1.22010006e-02]
 [ 1.02181108e-02]
 [-4.55344333e-03]
 [ 1.77151570e-02]
 [-1.81903785e-03]
 [ 1.58032163e-02]
 [ 3.86461295e-02]
 [-1.12725371e-02]
 [-8.25475847e-02]
 [-3.19296112e-02]
 [-1.47345790e-03]
 [-8.63798148e-03]
 [-1.29986045e-02]
 [-1.06948406e-03]
 [-2.97319409e-03]
 [-7.51802409e-03]
 [-5.14289318e-03]
 [-1.70260499e-02]
 [-1.82487839e-04]
 [-3.90979665e-03]
 [ 3.12894876e-02]
 [-3.77074219e-03]
 [ 2.14782482e-02]
 [ 9.00019453e-03]
 [ 1.16597192e-02]
 [ 7.79313040e-03]
 [-1.43527737e-02]
 [-5.28920837e-02]
 [ 4.07651925e-04]
 [-1.29511814e-02]
 [-2.95215369e-02]
 [-6.30610097e-03]
 [ 2.17782999e-02]
 [ 7.54777676e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.43224037]
curr_Stock_Price:  100.6087063108716
curr_Factors:  [100.60870631]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307965]
Stock Position:  -0.030796503113432554
Bond Position:  [18.53063671]


portfolio before change:  [15.42073687]
curr_Stock_Price:  101.01984733128985
curr_Factors:  [101.01984733]
mat_Sqrt:  [[0.15]]
grads:  [0.27009354]
Stock Position:  0.2700935436303922
Bond Position:  [-11.86407167]


portfolio before change:  [15.39246879]
curr_Stock_Price:  100.91793245802613
curr_Factors:  [100.91793246]
mat_Sqrt:  [[0.15]]
grads:  [0.13670219]
Stock Position:  0.13670218684596147
Bond Position:  [1.59676673]


portfolio before change:  [15.38599613]
curr_Stock_Price:  100.86985379896565
curr_Factors:  [100.8698538]
mat_Sqrt:  [[0.15]]
grads:  [-0.13517122]
Stock Position:  -0.13517122487534414
Bond Position:  [29.02069783]


portfolio before change:  [15.3975928]
curr_Stock_Price:  100.79748026646304
curr_Factors:  [100.79748027]
mat_Sqrt:  [[0.15]]
grads:  [-0.07275773]
Stock Position:  -0.07275772566413931
Bond Position:  [22.73138822]


portfolio before change:  [15.35278774]
curr_Stock_Price:  101.43281932132165
curr_Factors:  [101.43281932]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810787]
Stock Position:  -0.008107871530388779
Bond Position:  [16.175192]


portfolio before change:  [15.35348515]
curr_Stock_Price:  101.4714932744774
curr_Factors:  [101.47149327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527129]
Stock Position:  -0.015271290746420366
Bond Position:  [16.90308583]


portfolio before change:  [15.34522563]
curr_Stock_Price:  102.08152680635496
curr_Factors:  [102.08152681]
mat_Sqrt:  [[0.15]]
grads:  [-0.30220776]
Stock Position:  -0.3022077579666079
Bond Position:  [46.19505498]


portfolio before change:  [15.32761603]
curr_Stock_Price:  102.14935061313031
curr_Factors:  [102.14935061]
mat_Sqrt:  [[0.15]]
grads:  [0.11255405]
Stock Position:  0.11255405355218569
Bond Position:  [3.83029255]


portfolio before change:  [15.32136988]
curr_Stock_Price:  102.09172894958762
curr_Factors:  [102.09172895]
mat_Sqrt:  [[0.15]]
grads:  [-0.04466796]
Stock Position:  -0.04466795813912032
Bond Position:  [19.88159895]


portfolio before change:  [15.31788795]
curr_Stock_Price:  102.19749970781112
curr_Factors:  [102.19749971]
mat_Sqrt:  [[0.15]]
grads:  [-0.06974508]
Stock Position:  -0.06974508472931586
Bond Position:  [22.44566123]


portfolio before change:  [15.32002652]
curr_Stock_Price:  102.18695173773271
curr_Factors:  [102.18695174]
mat_Sqrt:  [[0.15]]
grads:  [0.12313827]
Stock Position:  0.12313826566432415
Bond Position:  [2.73690251]


portfolio before change:  [15.30147311]
curr_Stock_Price:  102.03489115559437
curr_Factors:  [102.03489116]
mat_Sqrt:  [[0.15]]
grads:  [-0.02728268]
Stock Position:  -0.027282676273073018
Bond Position:  [18.08525801]


portfolio before change:  [15.31101568]
curr_Stock_Price:  101.72655579191844
curr_Factors:  [101.72655579]
mat_Sqrt:  [[0.15]]
grads:  [0.0274249]
Stock Position:  0.02742490042256445
Bond Position:  [12.52117502]


portfolio before change:  [15.28274887]
curr_Stock_Price:  100.66732093319759
curr_Factors:  [100.66732093]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354384]
Stock Position:  -0.013543844598340645
Bond Position:  [16.64617142]


portfolio before change:  [15.29487093]
curr_Stock_Price:  99.84911575316963
curr_Factors:  [99.84911575]
mat_Sqrt:  [[0.15]]
grads:  [0.08500922]
Stock Position:  0.08500922389894318
Bond Position:  [6.8067751]


portfolio before change:  [15.34451833]
curr_Stock_Price:  100.42813478956488
curr_Factors:  [100.42813479]
mat_Sqrt:  [[0.15]]
grads:  [0.27151611]
Stock Position:  0.27151611213209187
Bond Position:  [-11.92333838]


portfolio before change:  [15.64854317]
curr_Stock_Price:  101.55060988671129
curr_Factors:  [101.55060989]
mat_Sqrt:  [[0.15]]
grads:  [-0.09041654]
Stock Position:  -0.0904165364020951
Bond Position:  [24.83039759]


portfolio before change:  [15.59406734]
curr_Stock_Price:  102.17027284228578
curr_Factors:  [102.17027284]
mat_Sqrt:  [[0.15]]
grads:  [0.1406895]
Stock Position:  0.1406895005857095
Bond Position:  [1.21978268]


portfolio before change:  [15.49241618]
curr_Stock_Price:  101.44720963371327
curr_Factors:  [101.44720963]
mat_Sqrt:  [[0.15]]
grads:  [0.00984805]
Stock Position:  0.00984804971730515
Bond Position:  [14.49335901]


portfolio before change:  [15.48973077]
curr_Stock_Price:  101.08254085649364
curr_Factors:  [101.08254086]
mat_Sqrt:  [[0.15]]
grads:  [-0.02518127]
Stock Position:  -0.025181269140428435
Bond Position:  [18.03511743]


portfolio before change:  [15.47726073]
curr_Stock_Price:  101.62251622839794
curr_Factors:  [101.62251623]
mat_Sqrt:  [[0.15]]
grads:  [0.03115261]
Stock Position:  0.031152605357433902
Bond Position:  [12.31145459]


portfolio before change:  [15.49203519]
curr_Stock_Price:  102.07207628975286
curr_Factors:  [102.07207629]
mat_Sqrt:  [[0.15]]
grads:  [0.06566781]
Stock Position:  0.06566781028963771
Bond Position:  [8.78918545]


portfolio before change:  [15.53245714]
curr_Stock_Price:  102.67926287786834
curr_Factors:  [102.67926288]
mat_Sqrt:  [[0.15]]
grads:  [0.24407743]
Stock Position:  0.2440774302311441
Bond Position:  [-9.52923348]


portfolio before change:  [15.19845806]
curr_Stock_Price:  101.31328862256557
curr_Factors:  [101.31328862]
mat_Sqrt:  [[0.15]]
grads:  [-0.01370262]
Stock Position:  -0.013702619624095323
Bond Position:  [16.58671552]


portfolio before change:  [15.20183517]
curr_Stock_Price:  101.1424887758104
curr_Factors:  [101.14248878]
mat_Sqrt:  [[0.15]]
grads:  [0.04631744]
Stock Position:  0.04631743878036534
Bond Position:  [10.51717414]


portfolio before change:  [15.21488403]
curr_Stock_Price:  101.41002345108336
curr_Factors:  [101.41002345]
mat_Sqrt:  [[0.15]]
grads:  [-0.04069199]
Stock Position:  -0.04069199155703279
Bond Position:  [19.34145985]


portfolio before change:  [15.17154767]
curr_Stock_Price:  102.5047164866911
curr_Factors:  [102.50471649]
mat_Sqrt:  [[0.15]]
grads:  [0.11962911]
Stock Position:  0.1196291127364442
Bond Position:  [2.90899939]


portfolio before change:  [15.22299]
curr_Stock_Price:  102.93321171444258
curr_Factors:  [102.93321171]
mat_Sqrt:  [[0.15]]
grads:  [0.12804544]
Stock Position:  0.1280454405281163
Bond Position:  [2.04286156]


portfolio before change:  [15.26906266]
curr_Stock_Price:  103.29202953468896
curr_Factors:  [103.29202953]
mat_Sqrt:  [[0.15]]
grads:  [-0.04889373]
Stock Position:  -0.04889373223782403
Bond Position:  [20.3193955]


portfolio before change:  [15.18058957]
curr_Stock_Price:  105.1275018479894
curr_Factors:  [105.12750185]
mat_Sqrt:  [[0.15]]
grads:  [0.04253167]
Stock Position:  0.04253166530980042
Bond Position:  [10.70934185]


portfolio before change:  [15.1917172]
curr_Stock_Price:  105.37339571322221
curr_Factors:  [105.37339571]
mat_Sqrt:  [[0.15]]
grads:  [0.10695514]
Stock Position:  0.10695514191823519
Bond Position:  [3.92149071]


portfolio before change:  [15.2108227]
curr_Stock_Price:  105.54973500075286
curr_Factors:  [105.549735]
mat_Sqrt:  [[0.15]]
grads:  [0.11250651]
Stock Position:  0.11250650557601292
Bond Position:  [3.33579085]


portfolio before change:  [15.23309117]
curr_Stock_Price:  105.74581237616897
curr_Factors:  [105.74581238]
mat_Sqrt:  [[0.15]]
grads:  [-0.07472613]
Stock Position:  -0.07472613101753045
Bond Position:  [23.1350666]


portfolio before change:  [15.20627521]
curr_Stock_Price:  106.12401945824854
curr_Factors:  [106.12401946]
mat_Sqrt:  [[0.15]]
grads:  [0.02471094]
Stock Position:  0.02471094055040658
Bond Position:  [12.58385087]


portfolio before change:  [15.22378109]
curr_Stock_Price:  106.8006173213333
curr_Factors:  [106.80061732]
mat_Sqrt:  [[0.15]]
grads:  [-0.20069162]
Stock Position:  -0.20069162028624501
Bond Position:  [36.65777003]


portfolio before change:  [15.15683498]
curr_Stock_Price:  107.14561075364112
curr_Factors:  [107.14561075]
mat_Sqrt:  [[0.15]]
grads:  [-0.05638038]
Stock Position:  -0.05638037958408188
Bond Position:  [21.19774519]


portfolio before change:  [15.14350999]
curr_Stock_Price:  107.40545106406869
curr_Factors:  [107.40545106]
mat_Sqrt:  [[0.15]]
grads:  [-0.13188393]
Stock Position:  -0.1318839325940897
Bond Position:  [29.30856326]


portfolio before change:  [15.11993159]
curr_Stock_Price:  107.5981222936765
curr_Factors:  [107.59812229]
mat_Sqrt:  [[0.15]]
grads:  [0.23169627]
Stock Position:  0.23169626567731547
Bond Position:  [-9.81015154]


portfolio before change:  [15.34740018]
curr_Stock_Price:  108.58252202526958
curr_Factors:  [108.58252203]
mat_Sqrt:  [[0.15]]
grads:  [-0.68617273]
Stock Position:  -0.6861727257675644
Bond Position:  [89.85376529]


portfolio before change:  [15.24696704]
curr_Stock_Price:  108.73707374801995
curr_Factors:  [108.73707375]
mat_Sqrt:  [[0.15]]
grads:  [0.01941357]
Stock Position:  0.019413569958930135
Bond Position:  [13.13599225]


portfolio before change:  [15.24884008]
curr_Stock_Price:  108.7912633933618
curr_Factors:  [108.79126339]
mat_Sqrt:  [[0.15]]
grads:  [-0.09657505]
Stock Position:  -0.09657504636743165
Bond Position:  [25.75536138]


portfolio before change:  [15.26770183]
curr_Stock_Price:  108.61262523268223
curr_Factors:  [108.61262523]
mat_Sqrt:  [[0.15]]
grads:  [-0.16824856]
Stock Position:  -0.16824856166799454
Bond Position:  [33.5416198]


portfolio before change:  [15.19595531]
curr_Stock_Price:  109.05151712135967
curr_Factors:  [109.05151712]
mat_Sqrt:  [[0.15]]
grads:  [0.24749395]
Stock Position:  0.24749395273735936
Bond Position:  [-11.79363571]


portfolio before change:  [15.36470479]
curr_Stock_Price:  109.73632821134538
curr_Factors:  [109.73632821]
mat_Sqrt:  [[0.15]]
grads:  [-0.16291047]
Stock Position:  -0.16291047496622366
Bond Position:  [33.24190214]


portfolio before change:  [15.44733374]
curr_Stock_Price:  109.24187711294962
curr_Factors:  [109.24187711]
mat_Sqrt:  [[0.15]]
grads:  [0.08134]
Stock Position:  0.08134000403378218
Bond Position:  [6.56159902]


portfolio before change:  [15.44272719]
curr_Stock_Price:  109.18020186811123
curr_Factors:  [109.18020187]
mat_Sqrt:  [[0.15]]
grads:  [0.06812074]
Stock Position:  0.06812073882759775
Bond Position:  [8.00529117]


portfolio before change:  [15.46256503]
curr_Stock_Price:  109.46407275353077
curr_Factors:  [109.46407275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035629]
Stock Position:  -0.030356288879822713
Bond Position:  [18.78548804]


portfolio before change:  [15.45401097]
curr_Stock_Price:  109.78453969719392
curr_Factors:  [109.7845397]
mat_Sqrt:  [[0.15]]
grads:  [0.11810105]
Stock Position:  0.11810104654843112
Bond Position:  [2.48834194]


portfolio before change:  [15.56916866]
curr_Stock_Price:  110.7583004642238
curr_Factors:  [110.75830046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01212692]
Stock Position:  -0.012126919002388136
Bond Position:  [16.9123256]


portfolio before change:  [15.58183513]
curr_Stock_Price:  109.80097497777746
curr_Factors:  [109.80097498]
mat_Sqrt:  [[0.15]]
grads:  [0.10535478]
Stock Position:  0.10535477514797081
Bond Position:  [4.0137781]


portfolio before change:  [15.52118466]
curr_Stock_Price:  109.22291541794102
curr_Factors:  [109.22291542]
mat_Sqrt:  [[0.15]]
grads:  [0.25764086]
Stock Position:  0.25764086357180194
Bond Position:  [-12.61910159]


portfolio before change:  [15.44843777]
curr_Stock_Price:  108.94361900807203
curr_Factors:  [108.94361901]
mat_Sqrt:  [[0.15]]
grads:  [-0.07515025]
Stock Position:  -0.07515024757995739
Bond Position:  [23.63557771]


portfolio before change:  [15.47701823]
curr_Stock_Price:  108.58296563832569
curr_Factors:  [108.58296564]
mat_Sqrt:  [[0.15]]
grads:  [-0.55031723]
Stock Position:  -0.5503172314512186
Bond Position:  [75.23209527]


portfolio before change:  [15.0137521]
curr_Stock_Price:  109.43332660037579
curr_Factors:  [109.4333266]
mat_Sqrt:  [[0.15]]
grads:  [-0.21286407]
Stock Position:  -0.21286407484644804
Bond Position:  [38.30817592]


portfolio before change:  [15.04630727]
curr_Stock_Price:  109.29163599957204
curr_Factors:  [109.291636]
mat_Sqrt:  [[0.15]]
grads:  [-0.00982305]
Stock Position:  -0.009823052698688604
Bond Position:  [16.11988477]


portfolio before change:  [15.05360391]
curr_Stock_Price:  108.651395446192
curr_Factors:  [108.65139545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05758654]
Stock Position:  -0.057586543197024435
Bond Position:  [21.31046219]


portfolio before change:  [15.10662658]
curr_Stock_Price:  107.7537772587876
curr_Factors:  [107.75377726]
mat_Sqrt:  [[0.15]]
grads:  [-0.08665736]
Stock Position:  -0.08665736340546705
Bond Position:  [24.44428482]


portfolio before change:  [15.0777894]
curr_Stock_Price:  108.10418023296802
curr_Factors:  [108.10418023]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712989]
Stock Position:  -0.007129893714168702
Bond Position:  [15.84856072]


portfolio before change:  [15.08216943]
curr_Stock_Price:  107.6287929816654
curr_Factors:  [107.62879298]
mat_Sqrt:  [[0.15]]
grads:  [-0.01982129]
Stock Position:  -0.019821293923393078
Bond Position:  [17.21551137]


portfolio before change:  [15.08727166]
curr_Stock_Price:  107.42566672836925
curr_Factors:  [107.42566673]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012016]
Stock Position:  -0.05012016062007811
Bond Position:  [20.47146333]


portfolio before change:  [15.0616056]
curr_Stock_Price:  107.96328603032444
curr_Factors:  [107.96328603]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428595]
Stock Position:  -0.03428595454993588
Bond Position:  [18.76322992]


portfolio before change:  [15.07319069]
curr_Stock_Price:  107.65959440629624
curr_Factors:  [107.65959441]
mat_Sqrt:  [[0.15]]
grads:  [-0.113507]
Stock Position:  -0.11350699924726824
Bond Position:  [27.29330819]


portfolio before change:  [15.08556188]
curr_Stock_Price:  107.56563280985442
curr_Factors:  [107.56563281]
mat_Sqrt:  [[0.15]]
grads:  [-0.00121659]
Stock Position:  -0.0012165855954117902
Bond Position:  [15.21642468]


portfolio before change:  [15.08650576]
curr_Stock_Price:  107.57152628887643
curr_Factors:  [107.57152629]
mat_Sqrt:  [[0.15]]
grads:  [-0.02606531]
Stock Position:  -0.02606531097045485
Bond Position:  [17.89039105]


portfolio before change:  [15.0585118]
curr_Stock_Price:  108.68841863986128
curr_Factors:  [108.68841864]
mat_Sqrt:  [[0.15]]
grads:  [0.20859658]
Stock Position:  0.2085965843098669
Bond Position:  [-7.61352108]


portfolio before change:  [14.94451457]
curr_Stock_Price:  108.14420373346464
curr_Factors:  [108.14420373]
mat_Sqrt:  [[0.15]]
grads:  [-0.02513828]
Stock Position:  -0.0251382812889881
Bond Position:  [17.66307398]


portfolio before change:  [14.94024677]
curr_Stock_Price:  108.35789303006358
curr_Factors:  [108.35789303]
mat_Sqrt:  [[0.15]]
grads:  [0.14318832]
Stock Position:  0.14318832166394999
Bond Position:  [-0.57533808]


portfolio before change:  [14.91515565]
curr_Stock_Price:  108.18291255276058
curr_Factors:  [108.18291255]
mat_Sqrt:  [[0.15]]
grads:  [0.0600013]
Stock Position:  0.06000129688605041
Bond Position:  [8.42404059]


portfolio before change:  [14.92047209]
curr_Stock_Price:  108.26274293148066
curr_Factors:  [108.26274293]
mat_Sqrt:  [[0.15]]
grads:  [0.07773146]
Stock Position:  0.07773146130957694
Bond Position:  [6.50505088]


portfolio before change:  [14.91740771]
curr_Stock_Price:  108.2180897800825
curr_Factors:  [108.21808978]
mat_Sqrt:  [[0.15]]
grads:  [0.0519542]
Stock Position:  0.051954202675986584
Bond Position:  [9.29502314]


portfolio before change:  [14.97015034]
curr_Stock_Price:  109.22208306479497
curr_Factors:  [109.22208306]
mat_Sqrt:  [[0.15]]
grads:  [-0.09568516]
Stock Position:  -0.09568515774679248
Bond Position:  [25.42108259]


portfolio before change:  [15.01679041]
curr_Stock_Price:  108.7512555829431
curr_Factors:  [108.75125558]
mat_Sqrt:  [[0.15]]
grads:  [-0.35261389]
Stock Position:  -0.35261389134469506
Bond Position:  [53.36399383]


portfolio before change:  [14.73726608]
curr_Stock_Price:  109.55343521794363
curr_Factors:  [109.55343522]
mat_Sqrt:  [[0.15]]
grads:  [0.00271768]
Stock Position:  0.002717679502740879
Bond Position:  [14.43953496]


portfolio before change:  [14.73744282]
curr_Stock_Price:  109.28638403369328
curr_Factors:  [109.28638403]
mat_Sqrt:  [[0.15]]
grads:  [-0.08634121]
Stock Position:  -0.08634120928900756
Bond Position:  [24.17336138]


portfolio before change:  [14.77463861]
curr_Stock_Price:  108.8730831209553
curr_Factors:  [108.87308312]
mat_Sqrt:  [[0.15]]
grads:  [-0.19681025]
Stock Position:  -0.19681024626472712
Bond Position:  [36.20197691]


portfolio before change:  [14.81543932]
curr_Stock_Price:  108.67727003262557
curr_Factors:  [108.67727003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04204067]
Stock Position:  -0.04204067314558705
Bond Position:  [19.38430491]


portfolio before change:  [14.80500283]
curr_Stock_Price:  108.95433615400707
curr_Factors:  [108.95433615]
mat_Sqrt:  [[0.15]]
grads:  [0.14518867]
Stock Position:  0.1451886663027278
Bond Position:  [-1.01393192]


portfolio before change:  [14.8152098]
curr_Stock_Price:  109.0250740589493
curr_Factors:  [109.02507406]
mat_Sqrt:  [[0.15]]
grads:  [0.50318512]
Stock Position:  0.5031851171503434
Bond Position:  [-40.04458486]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.11408296]
Stock Price:  109.62401073230168
PL:  [5.49007222]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.46807050e-03]
 [ 2.43370460e-02]
 [ 1.85879701e-02]
 [-3.97583122e-02]
 [-3.49032915e-02]
 [-3.95582299e-03]
 [-1.86942889e-03]
 [-2.89706188e-02]
 [ 9.04952602e-03]
 [-7.48812217e-03]
 [-1.19383671e-02]
 [ 2.02682377e-02]
 [-4.83707489e-03]
 [ 2.32355196e-03]
 [ 4.04549040e-03]
 [ 1.15302213e-02]
 [ 8.59474545e-02]
 [-1.31751392e-02]
 [ 2.40123710e-02]
 [-1.75500025e-04]
 [-6.61072462e-03]
 [ 6.06419660e-03]
 [-9.98285549e-04]
 [ 5.97395034e-02]
 [ 4.95909555e-03]
 [ 6.87081955e-03]
 [ 5.43171012e-02]
 [ 2.87038756e-02]
 [ 1.47721815e-02]
 [-7.32942238e-03]
 [ 3.90775871e-03]
 [ 1.48469779e-02]
 [ 1.56099673e-02]
 [-5.54340543e-03]
 [ 4.79875717e-03]
 [-1.81803676e-03]
 [-1.00134303e-02]
 [-1.47920798e-02]
 [-2.54813038e-03]
 [-1.65073376e-02]
 [ 3.82034974e-03]
 [ 1.04819007e-02]
 [-6.55895931e-03]
 [-5.05592343e-04]
 [ 7.66820639e-03]
 [ 1.20406761e-02]
 [ 1.05711298e-02]
 [-1.78366341e-03]
 [ 1.23131299e-02]
 [-1.37947845e-03]
 [ 2.11359210e-02]
 [-4.44631415e-03]
 [-8.79461428e-04]
 [-1.32369453e-02]
 [-2.36336483e-03]
 [-3.04079655e-03]
 [ 1.06754199e-02]
 [-6.53509321e-03]
 [ 6.79262304e-03]
 [-3.99802958e-03]
 [-6.85583367e-04]
 [ 4.86988846e-03]
 [-8.00946970e-03]
 [ 7.72022661e-03]
 [ 2.51482325e-02]
 [ 5.44880334e-03]
 [ 9.76734164e-03]
 [-3.25861120e-05]
 [ 2.80825485e-03]
 [ 2.01084200e-02]
 [ 3.80220809e-04]
 [-1.57920297e-02]
 [-1.79957383e-04]
 [ 1.35935235e-03]
 [-6.00537558e-04]
 [-1.25608450e-02]
 [-4.32592486e-03]
 [ 1.58330848e-02]
 [-5.64983773e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.85725416]
curr_Stock_Price:  100.5825916153596
curr_Factors:  [100.58259162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02978714]
Stock Position:  -0.029787136668428377
Bond Position:  [17.85332156]


portfolio before change:  [14.8602064]
curr_Stock_Price:  100.52094192246726
curr_Factors:  [100.52094192]
mat_Sqrt:  [[0.15]]
grads:  [0.16224697]
Stock Position:  0.16224697326337295
Bond Position:  [-1.44901218]


portfolio before change:  [14.99539295]
curr_Stock_Price:  101.35471479392324
curr_Factors:  [101.35471479]
mat_Sqrt:  [[0.15]]
grads:  [0.1239198]
Stock Position:  0.1239198007749356
Bond Position:  [2.43553689]


portfolio before change:  [15.08728531]
curr_Stock_Price:  102.09503336934505
curr_Factors:  [102.09503337]
mat_Sqrt:  [[0.15]]
grads:  [-0.26505541]
Stock Position:  -0.2650554143955052
Bond Position:  [42.14812669]


portfolio before change:  [15.25030243]
curr_Stock_Price:  101.48994187219543
curr_Factors:  [101.48994187]
mat_Sqrt:  [[0.15]]
grads:  [-0.23268861]
Stock Position:  -0.23268860973281033
Bond Position:  [38.8658559]


portfolio before change:  [15.53143453]
curr_Stock_Price:  100.29219133683813
curr_Factors:  [100.29219134]
mat_Sqrt:  [[0.15]]
grads:  [-0.02637215]
Stock Position:  -0.02637215329662065
Bond Position:  [18.17635557]


portfolio before change:  [15.52946168]
curr_Stock_Price:  100.41007732828865
curr_Factors:  [100.41007733]
mat_Sqrt:  [[0.15]]
grads:  [-0.01246286]
Stock Position:  -0.012462859259610878
Bond Position:  [16.78085834]


portfolio before change:  [15.52257379]
curr_Stock_Price:  101.04690722704304
curr_Factors:  [101.04690723]
mat_Sqrt:  [[0.15]]
grads:  [-0.19313746]
Stock Position:  -0.19313745855798245
Bond Position:  [35.03851665]


portfolio before change:  [15.53982995]
curr_Stock_Price:  100.96889968644392
curr_Factors:  [100.96889969]
mat_Sqrt:  [[0.15]]
grads:  [0.06033017]
Stock Position:  0.06033017348950086
Bond Position:  [9.44835871]


portfolio before change:  [15.63883507]
curr_Stock_Price:  102.60016606896022
curr_Factors:  [102.60016607]
mat_Sqrt:  [[0.15]]
grads:  [-0.04992081]
Stock Position:  -0.04992081448590649
Bond Position:  [20.76071893]


portfolio before change:  [15.62292595]
curr_Stock_Price:  102.94484597289275
curr_Factors:  [102.94484597]
mat_Sqrt:  [[0.15]]
grads:  [-0.07958911]
Stock Position:  -0.07958911432936278
Bond Position:  [23.81621507]


portfolio before change:  [15.61895725]
curr_Stock_Price:  103.0134138999369
curr_Factors:  [103.0134139]
mat_Sqrt:  [[0.15]]
grads:  [0.13512158]
Stock Position:  0.13512158461818607
Bond Position:  [1.69962153]


portfolio before change:  [15.6221341]
curr_Stock_Price:  103.03613877642223
curr_Factors:  [103.03613878]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224717]
Stock Position:  -0.03224716596213889
Bond Position:  [18.94475757]


portfolio before change:  [15.64839669]
curr_Stock_Price:  102.25844250942359
curr_Factors:  [102.25844251]
mat_Sqrt:  [[0.15]]
grads:  [0.01549035]
Stock Position:  0.015490346431435247
Bond Position:  [14.06437799]


portfolio before change:  [15.64521995]
curr_Stock_Price:  101.99661581992702
curr_Factors:  [101.99661582]
mat_Sqrt:  [[0.15]]
grads:  [0.02696994]
Stock Position:  0.026969935979412146
Bond Position:  [12.89437776]


portfolio before change:  [15.64829972]
curr_Stock_Price:  102.08092610369845
curr_Factors:  [102.0809261]
mat_Sqrt:  [[0.15]]
grads:  [0.07686814]
Stock Position:  0.076868142255889
Bond Position:  [7.80152857]


portfolio before change:  [15.62899875]
curr_Stock_Price:  101.82349075010411
curr_Factors:  [101.82349075]
mat_Sqrt:  [[0.15]]
grads:  [0.57298303]
Stock Position:  0.5729830300292953
Bond Position:  [-42.7141335]


portfolio before change:  [15.57359484]
curr_Stock_Price:  101.73145626391685
curr_Factors:  [101.73145626]
mat_Sqrt:  [[0.15]]
grads:  [-0.08783426]
Stock Position:  -0.087834261387853
Bond Position:  [24.50910216]


portfolio before change:  [15.4516204]
curr_Stock_Price:  103.13758529826616
curr_Factors:  [103.1375853]
mat_Sqrt:  [[0.15]]
grads:  [0.16008247]
Stock Position:  0.16008247344366905
Bond Position:  [-1.05889936]


portfolio before change:  [15.50548343]
curr_Stock_Price:  103.47446919873163
curr_Factors:  [103.4744692]
mat_Sqrt:  [[0.15]]
grads:  [-0.00117]
Stock Position:  -0.0011700001683936142
Bond Position:  [15.62654857]


portfolio before change:  [15.50689734]
curr_Stock_Price:  103.10077415010237
curr_Factors:  [103.10077415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440715]
Stock Position:  -0.04407149743987072
Bond Position:  [20.05070284]


portfolio before change:  [15.50577307]
curr_Stock_Price:  103.15472001827222
curr_Factors:  [103.15472002]
mat_Sqrt:  [[0.15]]
grads:  [0.04042798]
Stock Position:  0.04042797735857572
Bond Position:  [11.33543639]


portfolio before change:  [15.54393379]
curr_Stock_Price:  104.08111397667558
curr_Factors:  [104.08111398]
mat_Sqrt:  [[0.15]]
grads:  [-0.00665524]
Stock Position:  -0.0066552369958720655
Bond Position:  [16.23661827]


portfolio before change:  [15.54032024]
curr_Stock_Price:  104.7765622726006
curr_Factors:  [104.77656227]
mat_Sqrt:  [[0.15]]
grads:  [0.39826336]
Stock Position:  0.39826335607229907
Bond Position:  [-26.18834509]


portfolio before change:  [15.25854533]
curr_Stock_Price:  104.07316317656303
curr_Factors:  [104.07316318]
mat_Sqrt:  [[0.15]]
grads:  [0.03306064]
Stock Position:  0.033060637007724304
Bond Position:  [11.81782026]


portfolio before change:  [15.25765602]
curr_Stock_Price:  104.02392171817581
curr_Factors:  [104.02392172]
mat_Sqrt:  [[0.15]]
grads:  [0.04580546]
Stock Position:  0.04580546369815147
Bond Position:  [10.49279205]


portfolio before change:  [15.24955451]
curr_Stock_Price:  103.83273651678155
curr_Factors:  [103.83273652]
mat_Sqrt:  [[0.15]]
grads:  [0.36211401]
Stock Position:  0.36211400770915625
Bond Position:  [-22.34973384]


portfolio before change:  [15.395929]
curr_Stock_Price:  104.24081625619255
curr_Factors:  [104.24081626]
mat_Sqrt:  [[0.15]]
grads:  [0.19135917]
Stock Position:  0.1913591703444772
Bond Position:  [-4.55150712]


portfolio before change:  [15.23591812]
curr_Stock_Price:  103.40612202616268
curr_Factors:  [103.40612203]
mat_Sqrt:  [[0.15]]
grads:  [0.09848121]
Stock Position:  0.09848120974704218
Bond Position:  [5.05235813]


portfolio before change:  [15.22534323]
curr_Stock_Price:  103.2955357298921
curr_Factors:  [103.29553573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04886282]
Stock Position:  -0.04886281589703533
Bond Position:  [20.27265398]


portfolio before change:  [15.18303387]
curr_Stock_Price:  104.18734764806172
curr_Factors:  [104.18734765]
mat_Sqrt:  [[0.15]]
grads:  [0.02605172]
Stock Position:  0.026051724741179748
Bond Position:  [12.46877377]


portfolio before change:  [15.17399076]
curr_Stock_Price:  103.81031160877488
curr_Factors:  [103.81031161]
mat_Sqrt:  [[0.15]]
grads:  [0.09897985]
Stock Position:  0.09897985285104621
Bond Position:  [4.89886139]


portfolio before change:  [15.23568752]
curr_Stock_Price:  104.43054468250564
curr_Factors:  [104.43054468]
mat_Sqrt:  [[0.15]]
grads:  [0.10406645]
Stock Position:  0.10406644851571947
Bond Position:  [4.36797162]


portfolio before change:  [15.15034545]
curr_Stock_Price:  103.60784839360237
curr_Factors:  [103.60784839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03695604]
Stock Position:  -0.036956036222343856
Bond Position:  [18.97928085]


portfolio before change:  [15.16766858]
curr_Stock_Price:  103.17119734940296
curr_Factors:  [103.17119735]
mat_Sqrt:  [[0.15]]
grads:  [0.03199171]
Stock Position:  0.03199171445214562
Bond Position:  [11.8670451]


portfolio before change:  [15.18974329]
curr_Stock_Price:  103.83802622995307
curr_Factors:  [103.83802623]
mat_Sqrt:  [[0.15]]
grads:  [-0.01212025]
Stock Position:  -0.012120245050285413
Bond Position:  [16.44828562]


portfolio before change:  [15.18777215]
curr_Stock_Price:  104.08547924324111
curr_Factors:  [104.08547924]
mat_Sqrt:  [[0.15]]
grads:  [-0.0667562]
Stock Position:  -0.06675620189449441
Bond Position:  [22.13612342]


portfolio before change:  [15.1147004]
curr_Stock_Price:  105.2008108792329
curr_Factors:  [105.20081088]
mat_Sqrt:  [[0.15]]
grads:  [-0.09861387]
Stock Position:  -0.09861386562464255
Bond Position:  [25.48895903]


portfolio before change:  [15.17640141]
curr_Stock_Price:  104.59128302913793
curr_Factors:  [104.59128303]
mat_Sqrt:  [[0.15]]
grads:  [-0.01698754]
Stock Position:  -0.016987535880393784
Bond Position:  [16.95314958]


portfolio before change:  [15.20070466]
curr_Stock_Price:  103.22300653137299
curr_Factors:  [103.22300653]
mat_Sqrt:  [[0.15]]
grads:  [-0.11004892]
Stock Position:  -0.1100489173531187
Bond Position:  [26.56028477]


portfolio before change:  [15.21363427]
curr_Stock_Price:  103.12060169386085
curr_Factors:  [103.12060169]
mat_Sqrt:  [[0.15]]
grads:  [0.025469]
Stock Position:  0.025468998283532916
Bond Position:  [12.58725584]


portfolio before change:  [15.20510338]
curr_Stock_Price:  102.75476015443489
curr_Factors:  [102.75476015]
mat_Sqrt:  [[0.15]]
grads:  [0.06987934]
Stock Position:  0.06987933776440669
Bond Position:  [8.02466879]


portfolio before change:  [15.17294084]
curr_Stock_Price:  102.28732447471633
curr_Factors:  [102.28732447]
mat_Sqrt:  [[0.15]]
grads:  [-0.0437264]
Stock Position:  -0.043726395432821176
Bond Position:  [19.64559684]


portfolio before change:  [15.15990222]
curr_Stock_Price:  102.61359216942455
curr_Factors:  [102.61359217]
mat_Sqrt:  [[0.15]]
grads:  [-0.00337062]
Stock Position:  -0.0033706156226288027
Bond Position:  [15.5057732]


portfolio before change:  [15.15998939]
curr_Stock_Price:  102.87525539354102
curr_Factors:  [102.87525539]
mat_Sqrt:  [[0.15]]
grads:  [0.05112138]
Stock Position:  0.05112137590110247
Bond Position:  [9.90086479]


portfolio before change:  [15.1651813]
curr_Stock_Price:  102.96471073623661
curr_Factors:  [102.96471074]
mat_Sqrt:  [[0.15]]
grads:  [0.08027117]
Stock Position:  0.08027117423153267
Bond Position:  [6.90008306]


portfolio before change:  [15.20035223]
curr_Stock_Price:  103.39748957002095
curr_Factors:  [103.39748957]
mat_Sqrt:  [[0.15]]
grads:  [0.0704742]
Stock Position:  0.07047419890619673
Bond Position:  [7.91349699]


portfolio before change:  [15.18717793]
curr_Stock_Price:  103.20353326736047
curr_Factors:  [103.20353327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01189109]
Stock Position:  -0.011891089426242162
Bond Position:  [16.41438037]


portfolio before change:  [15.18291473]
curr_Stock_Price:  103.64833068708764
curr_Factors:  [103.64833069]
mat_Sqrt:  [[0.15]]
grads:  [0.08208753]
Stock Position:  0.08208753248357936
Bond Position:  [6.67467902]


portfolio before change:  [15.24871691]
curr_Stock_Price:  104.4448585033184
curr_Factors:  [104.4448585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00919652]
Stock Position:  -0.009196523011531205
Bond Position:  [16.20924646]


portfolio before change:  [15.2518922]
curr_Stock_Price:  104.20975065369548
curr_Factors:  [104.20975065]
mat_Sqrt:  [[0.15]]
grads:  [0.14090614]
Stock Position:  0.14090613993661452
Bond Position:  [0.56809849]


portfolio before change:  [15.06794014]
curr_Stock_Price:  102.9040051031421
curr_Factors:  [102.9040051]
mat_Sqrt:  [[0.15]]
grads:  [-0.02964209]
Stock Position:  -0.029642094334102975
Bond Position:  [18.11823037]


portfolio before change:  [15.06732014]
curr_Stock_Price:  102.96312462274696
curr_Factors:  [102.96312462]
mat_Sqrt:  [[0.15]]
grads:  [-0.00586308]
Stock Position:  -0.005863076183862692
Bond Position:  [15.67100078]


portfolio before change:  [15.06913416]
curr_Stock_Price:  102.82078464626453
curr_Factors:  [102.82078465]
mat_Sqrt:  [[0.15]]
grads:  [-0.0882463]
Stock Position:  -0.08824630212761864
Bond Position:  [24.14268818]


portfolio before change:  [15.05698306]
curr_Stock_Price:  102.97557933738457
curr_Factors:  [102.97557934]
mat_Sqrt:  [[0.15]]
grads:  [-0.01575577]
Stock Position:  -0.01575576551671703
Bond Position:  [16.67944215]


portfolio before change:  [15.05462237]
curr_Stock_Price:  103.19157619884352
curr_Factors:  [103.1915762]
mat_Sqrt:  [[0.15]]
grads:  [-0.02027198]
Stock Position:  -0.02027197698526469
Bond Position:  [17.14651962]


portfolio before change:  [15.0696523]
curr_Stock_Price:  102.50302740116885
curr_Factors:  [102.5030274]
mat_Sqrt:  [[0.15]]
grads:  [0.07116947]
Stock Position:  0.0711694661061067
Bond Position:  [7.77456657]


portfolio before change:  [15.03204434]
curr_Stock_Price:  101.96777137136567
curr_Factors:  [101.96777137]
mat_Sqrt:  [[0.15]]
grads:  [-0.04356729]
Stock Position:  -0.04356728809699659
Bond Position:  [19.47450361]


portfolio before change:  [15.0540512]
curr_Stock_Price:  101.49058616748026
curr_Factors:  [101.49058617]
mat_Sqrt:  [[0.15]]
grads:  [0.04528415]
Stock Position:  0.04528415358834563
Bond Position:  [10.45813591]


portfolio before change:  [15.05928781]
curr_Stock_Price:  101.59179056167785
curr_Factors:  [101.59179056]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665353]
Stock Position:  -0.026653530565332886
Bond Position:  [17.76706771]


portfolio before change:  [15.09103318]
curr_Stock_Price:  100.44241579654023
curr_Factors:  [100.4424158]
mat_Sqrt:  [[0.15]]
grads:  [-0.00457056]
Stock Position:  -0.004570555779344581
Bond Position:  [15.55011085]


portfolio before change:  [15.09399803]
curr_Stock_Price:  100.00637886012007
curr_Factors:  [100.00637886]
mat_Sqrt:  [[0.15]]
grads:  [0.03246592]
Stock Position:  0.03246592306544903
Bond Position:  [11.84719862]


portfolio before change:  [15.10018099]
curr_Stock_Price:  100.17401589813878
curr_Factors:  [100.1740159]
mat_Sqrt:  [[0.15]]
grads:  [-0.05339646]
Stock Position:  -0.05339646467311179
Bond Position:  [20.44911929]


portfolio before change:  [15.08866726]
curr_Stock_Price:  100.4135792872723
curr_Factors:  [100.41357929]
mat_Sqrt:  [[0.15]]
grads:  [0.05146818]
Stock Position:  0.05146817739760955
Bond Position:  [9.92056335]


portfolio before change:  [15.10518853]
curr_Stock_Price:  100.72253155064692
curr_Factors:  [100.72253155]
mat_Sqrt:  [[0.15]]
grads:  [0.16765488]
Stock Position:  0.16765488325341893
Bond Position:  [-1.78143574]


portfolio before change:  [15.21589272]
curr_Stock_Price:  101.38350564208581
curr_Factors:  [101.38350564]
mat_Sqrt:  [[0.15]]
grads:  [0.03632536]
Stock Position:  0.036325355576139404
Bond Position:  [11.53310083]


portfolio before change:  [15.1956816]
curr_Stock_Price:  100.80727011699665
curr_Factors:  [100.80727012]
mat_Sqrt:  [[0.15]]
grads:  [0.06511561]
Stock Position:  0.06511561093047206
Bond Position:  [8.63155462]


portfolio before change:  [15.19107176]
curr_Stock_Price:  100.72819028345872
curr_Factors:  [100.72819028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00021724]
Stock Position:  -0.00021724074641906246
Bond Position:  [15.21295402]


portfolio before change:  [15.19196166]
curr_Stock_Price:  101.0086938467362
curr_Factors:  [101.00869385]
mat_Sqrt:  [[0.15]]
grads:  [0.0187217]
Stock Position:  0.01872169900421108
Bond Position:  [13.3009073]


portfolio before change:  [15.18540501]
curr_Stock_Price:  100.61407270416404
curr_Factors:  [100.6140727]
mat_Sqrt:  [[0.15]]
grads:  [0.13405613]
Stock Position:  0.13405613309372394
Bond Position:  [1.69747149]


portfolio before change:  [15.23828537]
curr_Stock_Price:  101.00774555104348
curr_Factors:  [101.00774555]
mat_Sqrt:  [[0.15]]
grads:  [0.00253481]
Stock Position:  0.0025348053921081847
Bond Position:  [14.98225039]


portfolio before change:  [15.24037761]
curr_Stock_Price:  101.46372459162923
curr_Factors:  [101.46372459]
mat_Sqrt:  [[0.15]]
grads:  [-0.1052802]
Stock Position:  -0.10528019783488825
Bond Position:  [25.9224986]


portfolio before change:  [15.23568631]
curr_Stock_Price:  101.52367415182886
curr_Factors:  [101.52367415]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119972]
Stock Position:  -0.0011997158890220245
Bond Position:  [15.35748588]


portfolio before change:  [15.23656645]
curr_Stock_Price:  101.59013232497833
curr_Factors:  [101.59013232]
mat_Sqrt:  [[0.15]]
grads:  [0.00906235]
Stock Position:  0.009062349011112044
Bond Position:  [14.31592122]


portfolio before change:  [15.23013796]
curr_Stock_Price:  100.78203437966151
curr_Factors:  [100.78203438]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400358]
Stock Position:  -0.004003583717271282
Bond Position:  [15.63362727]


portfolio before change:  [15.22846528]
curr_Stock_Price:  101.44389406599335
curr_Factors:  [101.44389407]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373897]
Stock Position:  -0.08373896696274033
Bond Position:  [23.72327218]


portfolio before change:  [15.24425256]
curr_Stock_Price:  101.27307118340568
curr_Factors:  [101.27307118]
mat_Sqrt:  [[0.15]]
grads:  [-0.0288395]
Stock Position:  -0.028839499079342086
Bond Position:  [18.16491721]


portfolio before change:  [15.24975302]
curr_Stock_Price:  101.12171246159642
curr_Factors:  [101.12171246]
mat_Sqrt:  [[0.15]]
grads:  [0.1055539]
Stock Position:  0.1055538987531308
Bond Position:  [4.57596202]


portfolio before change:  [15.35797468]
curr_Stock_Price:  102.14427687066747
curr_Factors:  [102.14427687]
mat_Sqrt:  [[0.15]]
grads:  [-0.03766558]
Stock Position:  -0.037665584838349406
Bond Position:  [19.20529861]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.39804289]
Stock Price:  101.11235764575771
PL:  [14.28568525]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39540061e-02]
 [ 1.95478676e-04]
 [ 5.70448445e-03]
 [-8.71388225e-03]
 [-7.93282381e-03]
 [-1.14418035e-03]
 [-1.36005401e-03]
 [-4.08799147e-02]
 [ 1.69556363e-02]
 [-7.36289988e-03]
 [-9.61319705e-03]
 [ 1.80611812e-02]
 [-4.73736187e-03]
 [ 5.13164975e-03]
 [ 5.50695259e-03]
 [ 1.22829149e-02]
 [ 9.70381329e-02]
 [-1.08100961e-02]
 [ 2.39504642e-02]
 [-2.75214799e-05]
 [-7.57120543e-03]
 [ 6.10266083e-03]
 [ 4.07784499e-03]
 [ 4.75803262e-02]
 [ 3.46776671e-03]
 [ 7.26057899e-03]
 [ 6.11823299e-02]
 [ 2.59994316e-02]
 [ 1.87849507e-02]
 [-7.72196997e-03]
 [ 4.80229918e-04]
 [ 1.42071805e-02]
 [ 1.43992468e-02]
 [ 2.38986107e-03]
 [ 5.65766842e-03]
 [ 5.11309971e-03]
 [-1.59630672e-02]
 [-4.78057416e-03]
 [-1.93447507e-02]
 [-1.98502688e-02]
 [ 3.83906463e-03]
 [ 1.06824498e-02]
 [-3.97903450e-03]
 [-4.18493359e-03]
 [ 1.41818621e-02]
 [ 1.36719736e-02]
 [ 1.07217245e-02]
 [ 1.41149049e-03]
 [ 1.54718470e-02]
 [-1.18259896e-03]
 [ 1.75443403e-02]
 [-1.73569106e-02]
 [ 2.04114888e-03]
 [ 5.61492568e-03]
 [-7.12341028e-03]
 [-4.61110091e-03]
 [ 6.71273094e-04]
 [ 9.54853522e-03]
 [ 7.92235763e-03]
 [-3.94163912e-03]
 [-8.98433228e-04]
 [ 1.96179715e-03]
 [-6.67139510e-03]
 [ 6.45299495e-03]
 [ 1.98974273e-02]
 [ 3.79831041e-03]
 [ 1.29864695e-02]
 [-7.78956002e-04]
 [ 3.51588593e-03]
 [ 2.28652891e-02]
 [ 3.15598450e-03]
 [-1.57311522e-02]
 [-5.42493269e-03]
 [ 1.20321642e-03]
 [ 5.34724469e-03]
 [-4.17692293e-05]
 [-1.41519174e-03]
 [ 6.33693294e-03]
 [-2.01254858e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.13829943]
curr_Stock_Price:  99.71985249872813
curr_Factors:  [99.7198525]
mat_Sqrt:  [[0.15]]
grads:  [-0.09302671]
Stock Position:  -0.09302670765346104
Bond Position:  [5.13831014]


portfolio before change:  [-4.12715355]
curr_Stock_Price:  99.6034910412823
curr_Factors:  [99.60349104]
mat_Sqrt:  [[0.15]]
grads:  [0.00130319]
Stock Position:  0.0013031911704048868
Bond Position:  [-4.25695594]


portfolio before change:  [-4.12741328]
curr_Stock_Price:  99.60835123304304
curr_Factors:  [99.60835123]
mat_Sqrt:  [[0.15]]
grads:  [0.0380299]
Stock Position:  0.03802989631812607
Bond Position:  [-7.91550855]


portfolio before change:  [-4.10003757]
curr_Stock_Price:  100.34120749403202
curr_Factors:  [100.34120749]
mat_Sqrt:  [[0.15]]
grads:  [-0.05809255]
Stock Position:  -0.058092548319476245
Bond Position:  [1.72903887]


portfolio before change:  [-4.12221715]
curr_Stock_Price:  100.72486503852141
curr_Factors:  [100.72486504]
mat_Sqrt:  [[0.15]]
grads:  [-0.05288549]
Stock Position:  -0.052885492076817774
Bond Position:  [1.2046669]


portfolio before change:  [-4.14313658]
curr_Stock_Price:  101.12184957441558
curr_Factors:  [101.12184957]
mat_Sqrt:  [[0.15]]
grads:  [-0.00762787]
Stock Position:  -0.0076278689894889624
Bond Position:  [-3.37179236]


portfolio before change:  [-4.14640903]
curr_Stock_Price:  101.5232339579852
curr_Factors:  [101.52323396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00906703]
Stock Position:  -0.00906702674090161
Bond Position:  [-3.22589515]


portfolio before change:  [-4.14912042]
curr_Stock_Price:  101.80003560805154
curr_Factors:  [101.80003561]
mat_Sqrt:  [[0.15]]
grads:  [-0.27253276]
Stock Position:  -0.27253276447743885
Bond Position:  [23.59472471]


portfolio before change:  [-4.26398999]
curr_Stock_Price:  102.22693577336362
curr_Factors:  [102.22693577]
mat_Sqrt:  [[0.15]]
grads:  [0.11303758]
Stock Position:  0.11303757556797037
Bond Position:  [-15.81947496]


portfolio before change:  [-4.23192356]
curr_Stock_Price:  102.51936220930509
curr_Factors:  [102.51936221]
mat_Sqrt:  [[0.15]]
grads:  [-0.049086]
Stock Position:  -0.04908599922387714
Bond Position:  [0.80034178]


portfolio before change:  [-4.19499313]
curr_Stock_Price:  101.76801950594376
curr_Factors:  [101.76801951]
mat_Sqrt:  [[0.15]]
grads:  [-0.06408798]
Stock Position:  -0.06408798036236661
Bond Position:  [2.32711371]


portfolio before change:  [-4.21347408]
curr_Stock_Price:  102.05865753110292
curr_Factors:  [102.05865753]
mat_Sqrt:  [[0.15]]
grads:  [0.12040787]
Stock Position:  0.12040787467033141
Bond Position:  [-16.50214013]


portfolio before change:  [-4.11295199]
curr_Stock_Price:  102.90207003524915
curr_Factors:  [102.90207004]
mat_Sqrt:  [[0.15]]
grads:  [-0.03158241]
Stock Position:  -0.03158241243930003
Bond Position:  [-0.86305638]


portfolio before change:  [-4.12180106]
curr_Stock_Price:  103.1805516853038
curr_Factors:  [103.18055169]
mat_Sqrt:  [[0.15]]
grads:  [0.034211]
Stock Position:  0.03421099834213701
Bond Position:  [-7.65171074]


portfolio before change:  [-4.15354602]
curr_Stock_Price:  102.26661405637275
curr_Factors:  [102.26661406]
mat_Sqrt:  [[0.15]]
grads:  [0.03671302]
Stock Position:  0.03671301727271198
Bond Position:  [-7.90806199]


portfolio before change:  [-4.16590742]
curr_Stock_Price:  101.94337381114991
curr_Factors:  [101.94337381]
mat_Sqrt:  [[0.15]]
grads:  [0.0818861]
Stock Position:  0.0818860993792608
Bond Position:  [-12.51365266]


portfolio before change:  [-4.09656218]
curr_Stock_Price:  102.79977518505162
curr_Factors:  [102.79977519]
mat_Sqrt:  [[0.15]]
grads:  [0.64692089]
Stock Position:  0.646920885927656
Bond Position:  [-70.59988381]


portfolio before change:  [-4.11427697]
curr_Stock_Price:  102.77921291912504
curr_Factors:  [102.77921292]
mat_Sqrt:  [[0.15]]
grads:  [-0.07206731]
Stock Position:  -0.07206730727088287
Bond Position:  [3.29274415]


portfolio before change:  [-4.13656079]
curr_Stock_Price:  103.09127705748055
curr_Factors:  [103.09127706]
mat_Sqrt:  [[0.15]]
grads:  [0.15966976]
Stock Position:  0.1596697615260048
Bond Position:  [-20.59712041]


portfolio before change:  [-4.09964515]
curr_Stock_Price:  103.33053959479214
curr_Factors:  [103.33053959]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018348]
Stock Position:  -0.00018347653296225288
Bond Position:  [-4.08068642]


portfolio before change:  [-4.09998048]
curr_Stock_Price:  103.7680466360574
curr_Factors:  [103.76804664]
mat_Sqrt:  [[0.15]]
grads:  [-0.0504747]
Stock Position:  -0.050474702895117254
Bond Position:  [1.13768085]


portfolio before change:  [-4.0710666]
curr_Stock_Price:  103.19661641681654
curr_Factors:  [103.19661642]
mat_Sqrt:  [[0.15]]
grads:  [0.04068441]
Stock Position:  0.040684405502920434
Bond Position:  [-8.26955959]


portfolio before change:  [-4.07384375]
curr_Stock_Price:  103.14105978556044
curr_Factors:  [103.14105979]
mat_Sqrt:  [[0.15]]
grads:  [0.02718563]
Stock Position:  0.027185633266297676
Bond Position:  [-6.87779878]


portfolio before change:  [-4.05993654]
curr_Stock_Price:  103.66843725475267
curr_Factors:  [103.66843725]
mat_Sqrt:  [[0.15]]
grads:  [0.31720217]
Stock Position:  0.31720217445917487
Bond Position:  [-36.94379026]


portfolio before change:  [-4.17224667]
curr_Stock_Price:  103.32165187370533
curr_Factors:  [103.32165187]
mat_Sqrt:  [[0.15]]
grads:  [0.02311844]
Stock Position:  0.023118444740653915
Bond Position:  [-6.56088257]


portfolio before change:  [-4.16459977]
curr_Stock_Price:  103.67016030463719
curr_Factors:  [103.6701603]
mat_Sqrt:  [[0.15]]
grads:  [0.04840386]
Stock Position:  0.04840385995088319
Bond Position:  [-9.18263569]


portfolio before change:  [-4.1432521]
curr_Stock_Price:  104.12304972783072
curr_Factors:  [104.12304973]
mat_Sqrt:  [[0.15]]
grads:  [0.4078822]
Stock Position:  0.4078821990816283
Bond Position:  [-46.6131906]


portfolio before change:  [-4.28043191]
curr_Stock_Price:  103.79387039074257
curr_Factors:  [103.79387039]
mat_Sqrt:  [[0.15]]
grads:  [0.17332954]
Stock Position:  0.17332954428134117
Bond Position:  [-22.27097617]


portfolio before change:  [-4.42320375]
curr_Stock_Price:  102.97819952377603
curr_Factors:  [102.97819952]
mat_Sqrt:  [[0.15]]
grads:  [0.125233]
Stock Position:  0.12523300454499994
Bond Position:  [-17.31947308]


portfolio before change:  [-4.42171317]
curr_Stock_Price:  102.99874586762938
curr_Factors:  [102.99874587]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514798]
Stock Position:  -0.0514797998332914
Bond Position:  [0.88064165]


portfolio before change:  [-4.42106171]
curr_Stock_Price:  102.98716036692899
curr_Factors:  [102.98716037]
mat_Sqrt:  [[0.15]]
grads:  [0.00320153]
Stock Position:  0.0032015327875086048
Bond Position:  [-4.75077848]


portfolio before change:  [-4.42139966]
curr_Stock_Price:  102.9743483822959
curr_Factors:  [102.97434838]
mat_Sqrt:  [[0.15]]
grads:  [0.09471454]
Stock Position:  0.09471453637719822
Bond Position:  [-14.17456733]


portfolio before change:  [-4.3912463]
curr_Stock_Price:  103.30206254534525
curr_Factors:  [103.30206255]
mat_Sqrt:  [[0.15]]
grads:  [0.09599498]
Stock Position:  0.09599497892053671
Bond Position:  [-14.30772562]


portfolio before change:  [-4.4917042]
curr_Stock_Price:  102.26488710884232
curr_Factors:  [102.26488711]
mat_Sqrt:  [[0.15]]
grads:  [0.01593241]
Stock Position:  0.01593240711564204
Bond Position:  [-6.12103001]


portfolio before change:  [-4.48892338]
curr_Stock_Price:  102.46343819098512
curr_Factors:  [102.46343819]
mat_Sqrt:  [[0.15]]
grads:  [0.03771779]
Stock Position:  0.037717789451598954
Bond Position:  [-8.35361777]


portfolio before change:  [-4.46704381]
curr_Stock_Price:  103.05736722219937
curr_Factors:  [103.05736722]
mat_Sqrt:  [[0.15]]
grads:  [0.03408733]
Stock Position:  0.03408733137642087
Bond Position:  [-7.97999443]


portfolio before change:  [-4.46126492]
curr_Stock_Price:  103.24153102837529
curr_Factors:  [103.24153103]
mat_Sqrt:  [[0.15]]
grads:  [-0.10642045]
Stock Position:  -0.10642044819819783
Bond Position:  [6.52574509]


portfolio before change:  [-4.41710669]
curr_Stock_Price:  102.83042249974496
curr_Factors:  [102.8304225]
mat_Sqrt:  [[0.15]]
grads:  [-0.03187049]
Stock Position:  -0.03187049439713867
Bond Position:  [-1.13985029]


portfolio before change:  [-4.4301473]
curr_Stock_Price:  103.2373619119927
curr_Factors:  [103.23736191]
mat_Sqrt:  [[0.15]]
grads:  [-0.128965]
Stock Position:  -0.1289650048431707
Bond Position:  [8.88385958]


portfolio before change:  [-4.47036702]
curr_Stock_Price:  103.55353278642306
curr_Factors:  [103.55353279]
mat_Sqrt:  [[0.15]]
grads:  [-0.13233513]
Stock Position:  -0.13233512511064469
Bond Position:  [9.2334027]


portfolio before change:  [-4.40565645]
curr_Stock_Price:  103.06890363820426
curr_Factors:  [103.06890364]
mat_Sqrt:  [[0.15]]
grads:  [0.02559376]
Stock Position:  0.02559376421453197
Bond Position:  [-7.04357767]


portfolio before change:  [-4.4226382]
curr_Stock_Price:  102.4225932209426
curr_Factors:  [102.42259322]
mat_Sqrt:  [[0.15]]
grads:  [0.07121633]
Stock Position:  0.07121633204466307
Bond Position:  [-11.71679961]


portfolio before change:  [-4.50693]
curr_Stock_Price:  101.24927423851808
curr_Factors:  [101.24927424]
mat_Sqrt:  [[0.15]]
grads:  [-0.0265269]
Stock Position:  -0.026526896681180474
Bond Position:  [-1.82110097]


portfolio before change:  [-4.51662943]
curr_Stock_Price:  101.61062856657509
curr_Factors:  [101.61062857]
mat_Sqrt:  [[0.15]]
grads:  [-0.02789956]
Stock Position:  -0.02789955729487705
Bond Position:  [-1.68173788]


portfolio before change:  [-4.51431436]
curr_Stock_Price:  101.52388209167587
curr_Factors:  [101.52388209]
mat_Sqrt:  [[0.15]]
grads:  [0.09454575]
Stock Position:  0.09454574733139459
Bond Position:  [-14.11296566]


portfolio before change:  [-4.53474341]
curr_Stock_Price:  101.31713599601214
curr_Factors:  [101.317136]
mat_Sqrt:  [[0.15]]
grads:  [0.09114649]
Stock Position:  0.09114649048793033
Bond Position:  [-13.76944478]


portfolio before change:  [-4.54247075]
curr_Stock_Price:  101.24179873377759
curr_Factors:  [101.24179873]
mat_Sqrt:  [[0.15]]
grads:  [0.07147816]
Stock Position:  0.07147816345653753
Bond Position:  [-11.77904859]


portfolio before change:  [-4.50876816]
curr_Stock_Price:  101.72360746535553
curr_Factors:  [101.72360747]
mat_Sqrt:  [[0.15]]
grads:  [0.00940994]
Stock Position:  0.009409936572577103
Bond Position:  [-5.46598086]


portfolio before change:  [-4.50788818]
curr_Stock_Price:  101.85342975619625
curr_Factors:  [101.85342976]
mat_Sqrt:  [[0.15]]
grads:  [0.10314565]
Stock Position:  0.10314564660181517
Bond Position:  [-15.01362605]


portfolio before change:  [-4.48678555]
curr_Stock_Price:  102.0671180206287
curr_Factors:  [102.06711802]
mat_Sqrt:  [[0.15]]
grads:  [-0.00788399]
Stock Position:  -0.007883993092400635
Bond Position:  [-3.68208909]


portfolio before change:  [-4.48637405]
curr_Stock_Price:  101.98573439906924
curr_Factors:  [101.9857344]
mat_Sqrt:  [[0.15]]
grads:  [0.11696227]
Stock Position:  0.11696226858905318
Bond Position:  [-16.41485691]


portfolio before change:  [-4.55904458]
curr_Stock_Price:  101.37319012442728
curr_Factors:  [101.37319012]
mat_Sqrt:  [[0.15]]
grads:  [-0.11571274]
Stock Position:  -0.1157127374307379
Bond Position:  [7.17112475]


portfolio before change:  [-4.38886993]
curr_Stock_Price:  99.90639874712058
curr_Factors:  [99.90639875]
mat_Sqrt:  [[0.15]]
grads:  [0.01360766]
Stock Position:  0.013607659203963606
Bond Position:  [-5.74836216]


portfolio before change:  [-4.39626789]
curr_Stock_Price:  99.38913993388178
curr_Factors:  [99.38913993]
mat_Sqrt:  [[0.15]]
grads:  [0.03743284]
Stock Position:  0.03743283786665651
Bond Position:  [-8.11668545]


portfolio before change:  [-4.41235635]
curr_Stock_Price:  98.97289715779847
curr_Factors:  [98.97289716]
mat_Sqrt:  [[0.15]]
grads:  [-0.0474894]
Stock Position:  -0.04748940183863574
Bond Position:  [0.28780733]


portfolio before change:  [-4.35704744]
curr_Stock_Price:  97.808617941665
curr_Factors:  [97.80861794]
mat_Sqrt:  [[0.15]]
grads:  [-0.03074067]
Stock Position:  -0.030740672749375038
Bond Position:  [-1.35034472]


portfolio before change:  [-4.38366984]
curr_Stock_Price:  98.671904397132
curr_Factors:  [98.6719044]
mat_Sqrt:  [[0.15]]
grads:  [0.00447515]
Stock Position:  0.004475153959331086
Bond Position:  [-4.82524181]


portfolio before change:  [-4.38387833]
curr_Stock_Price:  98.69270935429435
curr_Factors:  [98.69270935]
mat_Sqrt:  [[0.15]]
grads:  [0.0636569]
Stock Position:  0.06365690146318331
Bond Position:  [-10.6663504]


portfolio before change:  [-4.41179238]
curr_Stock_Price:  98.26467432506833
curr_Factors:  [98.26467433]
mat_Sqrt:  [[0.15]]
grads:  [0.05281572]
Stock Position:  0.05281571754986807
Bond Position:  [-9.60171166]


portfolio before change:  [-4.39064393]
curr_Stock_Price:  98.67645657131685
curr_Factors:  [98.67645657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02627759]
Stock Position:  -0.02627759412638505
Bond Position:  [-1.79766405]


portfolio before change:  [-4.40590027]
curr_Stock_Price:  99.25276442062798
curr_Factors:  [99.25276442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00598955]
Stock Position:  -0.005989554853151816
Bond Position:  [-3.81142039]


portfolio before change:  [-4.40459809]
curr_Stock_Price:  98.99558325895448
curr_Factors:  [98.99558326]
mat_Sqrt:  [[0.15]]
grads:  [0.01307865]
Stock Position:  0.01307864765908933
Bond Position:  [-5.69932644]


portfolio before change:  [-4.39982253]
curr_Stock_Price:  99.38796181573805
curr_Factors:  [99.38796182]
mat_Sqrt:  [[0.15]]
grads:  [-0.04447597]
Stock Position:  -0.0444759673142526
Bond Position:  [0.02055321]


portfolio before change:  [-4.39706078]
curr_Stock_Price:  99.32589538549789
curr_Factors:  [99.32589539]
mat_Sqrt:  [[0.15]]
grads:  [0.04301997]
Stock Position:  0.04301996636239399
Bond Position:  [-8.67005746]


portfolio before change:  [-4.44253187]
curr_Stock_Price:  98.28151531543081
curr_Factors:  [98.28151532]
mat_Sqrt:  [[0.15]]
grads:  [0.13264952]
Stock Position:  0.13264951525433955
Bond Position:  [-17.47952724]


portfolio before change:  [-4.51972698]
curr_Stock_Price:  97.70780343797611
curr_Factors:  [97.70780344]
mat_Sqrt:  [[0.15]]
grads:  [0.02532207]
Stock Position:  0.025322069376924876
Bond Position:  [-6.99389075]


portfolio before change:  [-4.52830315]
curr_Stock_Price:  97.38638248689037
curr_Factors:  [97.38638249]
mat_Sqrt:  [[0.15]]
grads:  [0.08657646]
Stock Position:  0.08657646362679208
Bond Position:  [-12.95967175]


portfolio before change:  [-4.49057497]
curr_Stock_Price:  97.83151713376289
curr_Factors:  [97.83151713]
mat_Sqrt:  [[0.15]]
grads:  [-0.00519304]
Stock Position:  -0.005193040010761848
Bond Position:  [-3.98253199]


portfolio before change:  [-4.48897812]
curr_Stock_Price:  97.47608600229286
curr_Factors:  [97.476086]
mat_Sqrt:  [[0.15]]
grads:  [0.02343924]
Stock Position:  0.023439239521702692
Bond Position:  [-6.77374345]


portfolio before change:  [-4.48207324]
curr_Stock_Price:  97.78873497518153
curr_Factors:  [97.78873498]
mat_Sqrt:  [[0.15]]
grads:  [0.15243526]
Stock Position:  0.15243526065108084
Bond Position:  [-19.38852454]


portfolio before change:  [-4.42846222]
curr_Stock_Price:  98.14838170686109
curr_Factors:  [98.14838171]
mat_Sqrt:  [[0.15]]
grads:  [0.0210399]
Stock Position:  0.021039896691236733
Bond Position:  [-6.49349403]


portfolio before change:  [-4.43429122]
curr_Stock_Price:  97.8906263788376
curr_Factors:  [97.89062638]
mat_Sqrt:  [[0.15]]
grads:  [-0.10487435]
Stock Position:  -0.1048743477237604
Bond Position:  [5.83192437]


portfolio before change:  [-4.37094581]
curr_Stock_Price:  97.29008962355405
curr_Factors:  [97.29008962]
mat_Sqrt:  [[0.15]]
grads:  [-0.03616622]
Stock Position:  -0.03616621796537307
Bond Position:  [-0.85233122]


portfolio before change:  [-4.38990506]
curr_Stock_Price:  97.81284205449013
curr_Factors:  [97.81284205]
mat_Sqrt:  [[0.15]]
grads:  [0.00802144]
Stock Position:  0.008021442779186344
Bond Position:  [-5.17450518]


portfolio before change:  [-4.38410634]
curr_Stock_Price:  98.57606346978251
curr_Factors:  [98.57606347]
mat_Sqrt:  [[0.15]]
grads:  [0.0356483]
Stock Position:  0.035648297913478205
Bond Position:  [-7.89817522]


portfolio before change:  [-4.39666522]
curr_Stock_Price:  98.23761191173422
curr_Factors:  [98.23761191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027846]
Stock Position:  -0.0002784615289397561
Bond Position:  [-4.36930982]


portfolio before change:  [-4.3971345]
curr_Stock_Price:  98.9421760247933
curr_Factors:  [98.94217602]
mat_Sqrt:  [[0.15]]
grads:  [-0.00943461]
Stock Position:  -0.009434611585105423
Bond Position:  [-3.4636535]


portfolio before change:  [-4.40264462]
curr_Stock_Price:  99.50326295195879
curr_Factors:  [99.50326295]
mat_Sqrt:  [[0.15]]
grads:  [0.04224622]
Stock Position:  0.0422462195796758
Bond Position:  [-8.60628132]


portfolio before change:  [-4.37262931]
curr_Stock_Price:  100.2264809116743
curr_Factors:  [100.22648091]
mat_Sqrt:  [[0.15]]
grads:  [-0.13416991]
Stock Position:  -0.13416990564256906
Bond Position:  [9.07474818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.39652714]
Stock Price:  100.40882452885783
PL:  [-4.80535167]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.79289047e-03]
 [ 1.22647603e-02]
 [ 1.95179400e-02]
 [-2.19606358e-02]
 [ 6.55459521e-03]
 [-1.61173343e-03]
 [ 7.56382857e-04]
 [-1.53187346e-02]
 [-1.07467469e-02]
 [-1.01613667e-03]
 [ 1.20921573e-02]
 [-7.07973057e-04]
 [-3.11572502e-03]
 [ 9.69016946e-03]
 [ 4.47524870e-04]
 [ 1.25910968e-02]
 [ 2.34793724e-02]
 [-1.51921636e-02]
 [ 2.38554432e-02]
 [-2.78808725e-05]
 [-1.05149511e-02]
 [ 5.72412533e-03]
 [ 1.37041812e-02]
 [ 1.76326680e-02]
 [ 7.03532781e-03]
 [ 4.44717352e-03]
 [ 3.61689516e-04]
 [ 1.44908785e-02]
 [-6.03358762e-03]
 [ 4.47061721e-02]
 [-7.05780419e-03]
 [ 2.00026592e-02]
 [ 1.24892723e-02]
 [-1.98617576e-02]
 [-1.31570736e-02]
 [ 8.34860101e-03]
 [ 7.35060733e-03]
 [-4.89292313e-04]
 [ 4.24339443e-04]
 [-2.73324688e-05]
 [ 6.87286545e-03]
 [ 3.55306179e-02]
 [-3.37304731e-03]
 [ 2.42013455e-02]
 [-4.52034425e-02]
 [ 2.18022580e-02]
 [ 9.65193308e-03]
 [ 5.30537357e-03]
 [-7.88506976e-03]
 [-3.83105133e-04]
 [-3.95750329e-03]
 [ 1.37347556e-03]
 [ 1.07412695e-03]
 [ 7.50400025e-03]
 [-8.52557456e-03]
 [-4.72300469e-03]
 [-1.21632607e-03]
 [ 1.22197610e-02]
 [ 7.49138687e-03]
 [-3.32442939e-03]
 [-5.14224392e-03]
 [-6.50154661e-04]
 [-3.20636286e-03]
 [-2.53512374e-03]
 [ 1.85997149e-02]
 [ 5.64081958e-03]
 [ 1.99713497e-02]
 [-2.31754667e-03]
 [ 5.86841614e-03]
 [ 2.70840925e-02]
 [ 3.19988585e-03]
 [-1.53247873e-02]
 [-5.71968396e-03]
 [ 1.98683589e-03]
 [ 1.04456069e-02]
 [ 4.42231281e-03]
 [-1.45471558e-03]
 [-1.61037142e-02]
 [-2.27164026e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.0045675]
curr_Stock_Price:  100.18052072879064
curr_Factors:  [100.18052073]
mat_Sqrt:  [[0.15]]
grads:  [-0.03861927]
Stock Position:  -0.03861926980628766
Bond Position:  [9.87346606]


portfolio before change:  [6.00957215]
curr_Stock_Price:  100.06691061775692
curr_Factors:  [100.06691062]
mat_Sqrt:  [[0.15]]
grads:  [0.08176507]
Stock Position:  0.08176506887331776
Bond Position:  [-2.17240569]


portfolio before change:  [6.09741174]
curr_Stock_Price:  101.14286368370705
curr_Factors:  [101.14286368]
mat_Sqrt:  [[0.15]]
grads:  [0.1301196]
Stock Position:  0.13011959975443652
Bond Position:  [-7.0632572]


portfolio before change:  [6.0719989]
curr_Stock_Price:  100.95095274329846
curr_Factors:  [100.95095274]
mat_Sqrt:  [[0.15]]
grads:  [-0.14640424]
Stock Position:  -0.1464042385602522
Bond Position:  [20.85164627]


portfolio before change:  [6.15541632]
curr_Stock_Price:  100.39008000248064
curr_Factors:  [100.39008]
mat_Sqrt:  [[0.15]]
grads:  [0.0436973]
Stock Position:  0.043697301368258716
Bond Position:  [1.76864074]


portfolio before change:  [6.17073599]
curr_Stock_Price:  100.73813658809155
curr_Factors:  [100.73813659]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074489]
Stock Position:  -0.01074488952534075
Bond Position:  [7.25315614]


portfolio before change:  [6.17704365]
curr_Stock_Price:  100.1932896085117
curr_Factors:  [100.19328961]
mat_Sqrt:  [[0.15]]
grads:  [0.00504255]
Stock Position:  0.005042552382325041
Bond Position:  [5.67181374]


portfolio before change:  [6.1786889]
curr_Stock_Price:  100.44926068438032
curr_Factors:  [100.44926068]
mat_Sqrt:  [[0.15]]
grads:  [-0.1021249]
Stock Position:  -0.10212489722025968
Bond Position:  [16.43705932]


portfolio before change:  [6.26317817]
curr_Stock_Price:  99.6320072074968
curr_Factors:  [99.63200721]
mat_Sqrt:  [[0.15]]
grads:  [-0.07164498]
Stock Position:  -0.07164497904160252
Bond Position:  [13.40131124]


portfolio before change:  [6.22704636]
curr_Stock_Price:  100.14801581692448
curr_Factors:  [100.14801582]
mat_Sqrt:  [[0.15]]
grads:  [-0.00677424]
Stock Position:  -0.006774244445993799
Bond Position:  [6.9054735]


portfolio before change:  [6.22776023]
curr_Stock_Price:  100.10634849474017
curr_Factors:  [100.10634849]
mat_Sqrt:  [[0.15]]
grads:  [0.08061438]
Stock Position:  0.08061438174203785
Bond Position:  [-1.84225117]


portfolio before change:  [6.25605617]
curr_Stock_Price:  100.4587804469285
curr_Factors:  [100.45878045]
mat_Sqrt:  [[0.15]]
grads:  [-0.00471982]
Stock Position:  -0.004719820382740823
Bond Position:  [6.73020356]


portfolio before change:  [6.25479089]
curr_Stock_Price:  100.81598113249464
curr_Factors:  [100.81598113]
mat_Sqrt:  [[0.15]]
grads:  [-0.0207715]
Stock Position:  -0.020771500154664647
Bond Position:  [8.34889006]


portfolio before change:  [6.27049047]
curr_Stock_Price:  100.08528041894284
curr_Factors:  [100.08528042]
mat_Sqrt:  [[0.15]]
grads:  [0.06460113]
Stock Position:  0.06460112971032031
Bond Position:  [-0.19513172]


portfolio before change:  [6.24409539]
curr_Stock_Price:  99.67688384453109
curr_Factors:  [99.67688384]
mat_Sqrt:  [[0.15]]
grads:  [0.0029835]
Stock Position:  0.0029834991353139043
Bond Position:  [5.94670949]


portfolio before change:  [6.24477415]
curr_Stock_Price:  99.77980994480889
curr_Factors:  [99.77980994]
mat_Sqrt:  [[0.15]]
grads:  [0.08394065]
Stock Position:  0.08394064555543579
Bond Position:  [-2.13080751]


portfolio before change:  [6.21167663]
curr_Stock_Price:  99.38709978459066
curr_Factors:  [99.38709978]
mat_Sqrt:  [[0.15]]
grads:  [0.15652915]
Stock Position:  0.15652914912993277
Bond Position:  [-9.34530154]


portfolio before change:  [6.22417666]
curr_Stock_Price:  99.47068890729506
curr_Factors:  [99.47068891]
mat_Sqrt:  [[0.15]]
grads:  [-0.10128109]
Stock Position:  -0.10128109082407553
Bond Position:  [16.29867654]


portfolio before change:  [6.27910616]
curr_Stock_Price:  98.9384000385541
curr_Factors:  [98.93840004]
mat_Sqrt:  [[0.15]]
grads:  [0.15903629]
Stock Position:  0.15903628804352182
Bond Position:  [-9.45568973]


portfolio before change:  [6.23740069]
curr_Stock_Price:  98.6798775123441
curr_Factors:  [98.67987751]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018587]
Stock Position:  -0.00018587248307121713
Bond Position:  [6.25574257]


portfolio before change:  [6.23792517]
curr_Stock_Price:  97.96174431772899
curr_Factors:  [97.96174432]
mat_Sqrt:  [[0.15]]
grads:  [-0.07009967]
Stock Position:  -0.07009967419628213
Bond Position:  [13.10501153]


portfolio before change:  [6.30182101]
curr_Stock_Price:  97.06192920227397
curr_Factors:  [97.0619292]
mat_Sqrt:  [[0.15]]
grads:  [0.03816084]
Stock Position:  0.03816083556120522
Bond Position:  [2.59785669]


portfolio before change:  [6.28418583]
curr_Stock_Price:  96.59554672455114
curr_Factors:  [96.59554672]
mat_Sqrt:  [[0.15]]
grads:  [0.09136121]
Stock Position:  0.09136120774463503
Bond Position:  [-2.54089998]


portfolio before change:  [6.32047668]
curr_Stock_Price:  96.99450881403202
curr_Factors:  [96.99450881]
mat_Sqrt:  [[0.15]]
grads:  [0.11755112]
Stock Position:  0.1175511199915303
Bond Position:  [-5.08133646]


portfolio before change:  [6.28361776]
curr_Stock_Price:  96.68365400580879
curr_Factors:  [96.68365401]
mat_Sqrt:  [[0.15]]
grads:  [0.04690219]
Stock Position:  0.046902185403550165
Bond Position:  [1.74894309]


portfolio before change:  [6.27107388]
curr_Stock_Price:  96.41387573838924
curr_Factors:  [96.41387574]
mat_Sqrt:  [[0.15]]
grads:  [0.02964782]
Stock Position:  0.02964782344872716
Bond Position:  [3.41261231]


portfolio before change:  [6.27570489]
curr_Stock_Price:  96.56288206706031
curr_Factors:  [96.56288207]
mat_Sqrt:  [[0.15]]
grads:  [0.00241126]
Stock Position:  0.002411263440146756
Bond Position:  [6.04286634]


portfolio before change:  [6.27568373]
curr_Stock_Price:  96.39747202553212
curr_Factors:  [96.39747203]
mat_Sqrt:  [[0.15]]
grads:  [0.09660586]
Stock Position:  0.09660585678230106
Bond Position:  [-3.03687665]


portfolio before change:  [6.28052771]
curr_Stock_Price:  96.44957844675774
curr_Factors:  [96.44957845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04022392]
Stock Position:  -0.040223917494937256
Bond Position:  [10.16010759]


portfolio before change:  [6.27151996]
curr_Stock_Price:  96.68930581644496
curr_Factors:  [96.68930582]
mat_Sqrt:  [[0.15]]
grads:  [0.29804115]
Stock Position:  0.2980411476623795
Bond Position:  [-22.54587171]


portfolio before change:  [6.43052947]
curr_Stock_Price:  97.2275491940059
curr_Factors:  [97.22754919]
mat_Sqrt:  [[0.15]]
grads:  [-0.04705203]
Stock Position:  -0.047052027945801704
Bond Position:  [11.00528283]


portfolio before change:  [6.44912633]
curr_Stock_Price:  96.84692778395208
curr_Factors:  [96.84692778]
mat_Sqrt:  [[0.15]]
grads:  [0.13335106]
Stock Position:  0.13335106130556135
Bond Position:  [-6.46551427]


portfolio before change:  [6.40526587]
curr_Stock_Price:  96.52104847162481
curr_Factors:  [96.52104847]
mat_Sqrt:  [[0.15]]
grads:  [0.08326182]
Stock Position:  0.08326181548598047
Bond Position:  [-1.63125186]


portfolio before change:  [6.41851355]
curr_Stock_Price:  96.6813816608548
curr_Factors:  [96.68138166]
mat_Sqrt:  [[0.15]]
grads:  [-0.13241172]
Stock Position:  -0.13241171730568277
Bond Position:  [19.22026133]


portfolio before change:  [6.48567442]
curr_Stock_Price:  96.1832416789851
curr_Factors:  [96.18324168]
mat_Sqrt:  [[0.15]]
grads:  [-0.08771382]
Stock Position:  -0.0877138242326841
Bond Position:  [14.92227438]


portfolio before change:  [6.39364244]
curr_Stock_Price:  97.24310483953619
curr_Factors:  [97.24310484]
mat_Sqrt:  [[0.15]]
grads:  [0.05565734]
Stock Position:  0.055657340094037284
Bond Position:  [0.98134988]


portfolio before change:  [6.38650058]
curr_Stock_Price:  97.11368428381137
curr_Factors:  [97.11368428]
mat_Sqrt:  [[0.15]]
grads:  [0.04900405]
Stock Position:  0.04900404883586056
Bond Position:  [1.62753685]


portfolio before change:  [6.40271085]
curr_Stock_Price:  97.4424030860087
curr_Factors:  [97.44240309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00326195]
Stock Position:  -0.003261948750148836
Bond Position:  [6.72056298]


portfolio before change:  [6.4053817]
curr_Stock_Price:  96.7523853893514
curr_Factors:  [96.75238539]
mat_Sqrt:  [[0.15]]
grads:  [0.00282893]
Stock Position:  0.0028289296227829628
Bond Position:  [6.13167601]


portfolio before change:  [6.40399365]
curr_Stock_Price:  96.1262506070578
curr_Factors:  [96.12625061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018222]
Stock Position:  -0.00018221645837174227
Bond Position:  [6.42150944]


portfolio before change:  [6.404436]
curr_Stock_Price:  95.90128130229915
curr_Factors:  [95.9012813]
mat_Sqrt:  [[0.15]]
grads:  [0.0458191]
Stock Position:  0.04581910297517097
Bond Position:  [2.01032532]


portfolio before change:  [6.40523354]
curr_Stock_Price:  95.91594526635824
curr_Factors:  [95.91594527]
mat_Sqrt:  [[0.15]]
grads:  [0.23687079]
Stock Position:  0.2368707860094598
Bond Position:  [-16.3144518]


portfolio before change:  [6.29884696]
curr_Stock_Price:  95.47111666707409
curr_Factors:  [95.47111667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248698]
Stock Position:  -0.022486982087581507
Bond Position:  [8.44570425]


portfolio before change:  [6.3123658]
curr_Stock_Price:  94.89340602535455
curr_Factors:  [94.89340603]
mat_Sqrt:  [[0.15]]
grads:  [0.1613423]
Stock Position:  0.16134230316997347
Bond Position:  [-8.99795489]


portfolio before change:  [6.46501096]
curr_Stock_Price:  95.84298683955248
curr_Factors:  [95.84298684]
mat_Sqrt:  [[0.15]]
grads:  [-0.30135628]
Stock Position:  -0.3013562835409916
Bond Position:  [35.34789728]


portfolio before change:  [6.46403143]
curr_Stock_Price:  95.85356847509496
curr_Factors:  [95.85356848]
mat_Sqrt:  [[0.15]]
grads:  [0.14534839]
Stock Position:  0.1453483866193385
Bond Position:  [-7.46813009]


portfolio before change:  [6.55872894]
curr_Stock_Price:  96.50830074881074
curr_Factors:  [96.50830075]
mat_Sqrt:  [[0.15]]
grads:  [0.06434622]
Stock Position:  0.06434622056377318
Bond Position:  [0.34878454]


portfolio before change:  [6.59895163]
curr_Stock_Price:  97.13305980098316
curr_Factors:  [97.1330598]
mat_Sqrt:  [[0.15]]
grads:  [0.03536916]
Stock Position:  0.035369157106801934
Bond Position:  [3.16343717]


portfolio before change:  [6.59022407]
curr_Stock_Price:  96.88071359225377
curr_Factors:  [96.88071359]
mat_Sqrt:  [[0.15]]
grads:  [-0.05256713]
Stock Position:  -0.05256713176263359
Bond Position:  [11.68296531]


portfolio before change:  [6.57842518]
curr_Stock_Price:  97.11905831589289
curr_Factors:  [97.11905832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00255403]
Stock Position:  -0.00255403421866003
Bond Position:  [6.82647058]


portfolio before change:  [6.57974846]
curr_Stock_Price:  96.76800317649078
curr_Factors:  [96.76800318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02638336]
Stock Position:  -0.026383355290332373
Bond Position:  [9.13281307]


portfolio before change:  [6.56070915]
curr_Stock_Price:  97.5112796263452
curr_Factors:  [97.51127963]
mat_Sqrt:  [[0.15]]
grads:  [0.0091565]
Stock Position:  0.009156503715062372
Bond Position:  [5.66784676]


portfolio before change:  [6.56674]
curr_Stock_Price:  98.13123236002355
curr_Factors:  [98.13123236]
mat_Sqrt:  [[0.15]]
grads:  [0.00716085]
Stock Position:  0.007160846322613839
Bond Position:  [5.86403733]


portfolio before change:  [6.56736479]
curr_Stock_Price:  98.16729945226194
curr_Factors:  [98.16729945]
mat_Sqrt:  [[0.15]]
grads:  [0.05002667]
Stock Position:  0.050026668308495836
Bond Position:  [1.65638186]


portfolio before change:  [6.56119074]
curr_Stock_Price:  98.04181496750321
curr_Factors:  [98.04181497]
mat_Sqrt:  [[0.15]]
grads:  [-0.05683716]
Stock Position:  -0.05683716370038827
Bond Position:  [12.13360943]


portfolio before change:  [6.6050407]
curr_Stock_Price:  97.2836562923236
curr_Factors:  [97.28365629]
mat_Sqrt:  [[0.15]]
grads:  [-0.0314867]
Stock Position:  -0.03148669795141771
Bond Position:  [9.66818181]


portfolio before change:  [6.61927378]
curr_Stock_Price:  96.85081341195148
curr_Factors:  [96.85081341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810884]
Stock Position:  -0.008108840489079701
Bond Position:  [7.40462158]


portfolio before change:  [6.61544292]
curr_Stock_Price:  97.38031661143744
curr_Factors:  [97.38031661]
mat_Sqrt:  [[0.15]]
grads:  [0.08146507]
Stock Position:  0.08146507356359502
Bond Position:  [-1.31765173]


portfolio before change:  [6.54449004]
curr_Stock_Price:  96.51036672017085
curr_Factors:  [96.51036672]
mat_Sqrt:  [[0.15]]
grads:  [0.04994258]
Stock Position:  0.04994257914035009
Bond Position:  [1.72451341]


portfolio before change:  [6.56963167]
curr_Stock_Price:  97.01161940750498
curr_Factors:  [97.01161941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02216286]
Stock Position:  -0.022162862595550618
Bond Position:  [8.71968687]


portfolio before change:  [6.57528603]
curr_Stock_Price:  96.78108257007416
curr_Factors:  [96.78108257]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428163]
Stock Position:  -0.03428162611160991
Bond Position:  [9.89309892]


portfolio before change:  [6.55135836]
curr_Stock_Price:  97.49709299894876
curr_Factors:  [97.497093]
mat_Sqrt:  [[0.15]]
grads:  [-0.00433436]
Stock Position:  -0.004334364403452898
Bond Position:  [6.97394629]


portfolio before change:  [6.55599795]
curr_Stock_Price:  96.52723893959103
curr_Factors:  [96.52723894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137575]
Stock Position:  -0.021375752410639205
Bond Position:  [8.61934031]


portfolio before change:  [6.55455197]
curr_Stock_Price:  96.62008722976324
curr_Factors:  [96.62008723]
mat_Sqrt:  [[0.15]]
grads:  [-0.01690082]
Stock Position:  -0.016900824960228693
Bond Position:  [8.18751116]


portfolio before change:  [6.56573694]
curr_Stock_Price:  95.98856595331756
curr_Factors:  [95.98856595]
mat_Sqrt:  [[0.15]]
grads:  [0.1239981]
Stock Position:  0.12399809966062765
Bond Position:  [-5.33666283]


portfolio before change:  [6.57428707]
curr_Stock_Price:  96.06020966849991
curr_Factors:  [96.06020967]
mat_Sqrt:  [[0.15]]
grads:  [0.03760546]
Stock Position:  0.0376054638487756
Bond Position:  [2.96189833]


portfolio before change:  [6.55878042]
curr_Stock_Price:  95.642935882266
curr_Factors:  [95.64293588]
mat_Sqrt:  [[0.15]]
grads:  [0.13314233]
Stock Position:  0.13314233101831058
Bond Position:  [-6.17534301]


portfolio before change:  [6.66741621]
curr_Stock_Price:  96.4617720838747
curr_Factors:  [96.46177208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545031]
Stock Position:  -0.015450311135138152
Bond Position:  [8.1577806]


portfolio before change:  [6.67492028]
curr_Stock_Price:  96.00908286176113
curr_Factors:  [96.00908286]
mat_Sqrt:  [[0.15]]
grads:  [0.03912277]
Stock Position:  0.0391227742718412
Bond Position:  [2.9187786]


portfolio before change:  [6.64998135]
curr_Stock_Price:  95.36696694071443
curr_Factors:  [95.36696694]
mat_Sqrt:  [[0.15]]
grads:  [0.18056062]
Stock Position:  0.1805606166052173
Bond Position:  [-10.569537]


portfolio before change:  [6.72508731]
curr_Stock_Price:  95.78658542631567
curr_Factors:  [95.78658543]
mat_Sqrt:  [[0.15]]
grads:  [0.02133257]
Stock Position:  0.021332572354219155
Bond Position:  [4.68171304]


portfolio before change:  [6.72513978]
curr_Stock_Price:  95.77532807788096
curr_Factors:  [95.77532808]
mat_Sqrt:  [[0.15]]
grads:  [-0.10216525]
Stock Position:  -0.10216524885783287
Bond Position:  [16.51005]


portfolio before change:  [6.63419495]
curr_Stock_Price:  96.6756022424142
curr_Factors:  [96.67560224]
mat_Sqrt:  [[0.15]]
grads:  [-0.03813123]
Stock Position:  -0.0381312263873905
Bond Position:  [10.32055423]


portfolio before change:  [6.64805441]
curr_Stock_Price:  96.3290515510628
curr_Factors:  [96.32905155]
mat_Sqrt:  [[0.15]]
grads:  [0.01324557]
Stock Position:  0.013245572622364131
Bond Position:  [5.37212096]


portfolio before change:  [6.64547046]
curr_Stock_Price:  96.10862149647771
curr_Factors:  [96.1086215]
mat_Sqrt:  [[0.15]]
grads:  [0.06963738]
Stock Position:  0.0696373794045648
Bond Position:  [-0.04728208]


portfolio before change:  [6.63585149]
curr_Stock_Price:  95.97053464642296
curr_Factors:  [95.97053465]
mat_Sqrt:  [[0.15]]
grads:  [0.02948209]
Stock Position:  0.02948208541178463
Bond Position:  [3.80643999]


portfolio before change:  [6.6377178]
curr_Stock_Price:  96.02576817663429
curr_Factors:  [96.02576818]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096981]
Stock Position:  -0.009698103852932323
Bond Position:  [7.56898568]


portfolio before change:  [6.64027824]
curr_Stock_Price:  95.8105340011648
curr_Factors:  [95.810534]
mat_Sqrt:  [[0.15]]
grads:  [-0.10735809]
Stock Position:  -0.10735809495278598
Bond Position:  [16.92631465]


portfolio before change:  [6.50578932]
curr_Stock_Price:  97.07310156890061
curr_Factors:  [97.07310157]
mat_Sqrt:  [[0.15]]
grads:  [-0.15144268]
Stock Position:  -0.1514426843129869
Bond Position:  [21.2068004]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.41638037]
Stock Price:  97.67223525940128
PL:  [6.41638037]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.45600192e-03]
 [ 3.64183948e-02]
 [ 1.66163351e-02]
 [-3.64960715e-02]
 [-5.55684532e-02]
 [-2.47258978e-03]
 [ 4.72984440e-02]
 [-6.52964907e-02]
 [ 1.81408865e-02]
 [-8.98993454e-03]
 [-1.29516133e-02]
 [ 2.02831742e-02]
 [-5.23786014e-03]
 [ 6.75989335e-03]
 [ 1.74960118e-02]
 [ 6.40840246e-03]
 [ 8.37533371e-02]
 [-8.61050272e-03]
 [ 2.60474760e-02]
 [-9.30546730e-04]
 [-8.34065641e-03]
 [ 6.65547018e-03]
 [ 3.59669107e-04]
 [ 4.64920466e-02]
 [ 7.19553321e-04]
 [ 7.93363598e-03]
 [ 2.85805480e-03]
 [ 1.76846874e-02]
 [ 2.58227331e-02]
 [-7.78725664e-03]
 [-7.90970307e-04]
 [ 1.35278553e-02]
 [ 1.32749326e-02]
 [ 8.04489939e-03]
 [ 5.74035656e-03]
 [ 1.62615225e-02]
 [-2.68463042e-02]
 [-2.60689018e-03]
 [-3.83736637e-02]
 [-1.32454761e-02]
 [ 3.86016906e-03]
 [ 8.34547306e-03]
 [-9.82809889e-03]
 [ 4.68611709e-03]
 [ 8.60707041e-03]
 [ 1.20042743e-02]
 [ 1.05611531e-02]
 [-1.53897963e-03]
 [ 1.19946418e-02]
 [-1.28759521e-03]
 [ 2.10727591e-02]
 [ 1.14455717e-03]
 [-1.87995828e-03]
 [-2.05163752e-02]
 [-5.03435497e-03]
 [-2.94446135e-03]
 [ 9.04479280e-03]
 [-1.79189598e-02]
 [ 3.22853094e-03]
 [-3.16466289e-03]
 [-6.66756237e-03]
 [ 1.11718010e-03]
 [-1.88157683e-02]
 [ 5.98292873e-04]
 [ 1.13425180e-02]
 [ 1.24230320e-02]
 [ 8.74517866e-03]
 [ 1.02803928e-02]
 [ 7.09200156e-03]
 [ 1.09658717e-02]
 [ 2.19799171e-03]
 [-1.52181423e-02]
 [-1.97936623e-02]
 [ 9.03082142e-04]
 [-1.05682283e-03]
 [-2.01063687e-02]
 [-4.49922019e-03]
 [ 1.31913139e-02]
 [ 4.57077953e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.81142168]
curr_Stock_Price:  100.58050999795745
curr_Factors:  [100.58051]
mat_Sqrt:  [[0.15]]
grads:  [-0.02970668]
Stock Position:  -0.029706679488443306
Bond Position:  [17.79933465]


portfolio before change:  [14.80323521]
curr_Stock_Price:  100.89353607909426
curr_Factors:  [100.89353608]
mat_Sqrt:  [[0.15]]
grads:  [0.2427893]
Stock Position:  0.2427892989636396
Bond Position:  [-9.69263569]


portfolio before change:  [15.02983248]
curr_Stock_Price:  101.82933959726218
curr_Factors:  [101.8293396]
mat_Sqrt:  [[0.15]]
grads:  [0.11077557]
Stock Position:  0.1107755673679658
Bond Position:  [3.74962961]


portfolio before change:  [15.03572642]
curr_Stock_Price:  101.88043009707087
curr_Factors:  [101.8804301]
mat_Sqrt:  [[0.15]]
grads:  [-0.24330714]
Stock Position:  -0.24330714325965763
Bond Position:  [39.82396282]


portfolio before change:  [14.93123079]
curr_Stock_Price:  102.32014059476299
curr_Factors:  [102.32014059]
mat_Sqrt:  [[0.15]]
grads:  [-0.37045635]
Stock Position:  -0.3704563545533828
Bond Position:  [52.83637707]


portfolio before change:  [14.68224113]
curr_Stock_Price:  103.00117098081174
curr_Factors:  [103.00117098]
mat_Sqrt:  [[0.15]]
grads:  [-0.01648393]
Stock Position:  -0.01648393184767088
Bond Position:  [16.38010541]


portfolio before change:  [14.66303378]
curr_Stock_Price:  104.22849595450154
curr_Factors:  [104.22849595]
mat_Sqrt:  [[0.15]]
grads:  [0.31532296]
Stock Position:  0.31532295987298803
Bond Position:  [-18.20260407]


portfolio before change:  [14.38302829]
curr_Stock_Price:  103.34410811649482
curr_Factors:  [103.34410812]
mat_Sqrt:  [[0.15]]
grads:  [-0.43530994]
Stock Position:  -0.43530993801260603
Bond Position:  [59.36974558]


portfolio before change:  [14.32113064]
curr_Stock_Price:  103.49482458149546
curr_Factors:  [103.49482458]
mat_Sqrt:  [[0.15]]
grads:  [0.12093924]
Stock Position:  0.12093924323811812
Bond Position:  [1.80454487]


portfolio before change:  [14.33024566]
curr_Stock_Price:  103.56926060271432
curr_Factors:  [103.5692606]
mat_Sqrt:  [[0.15]]
grads:  [-0.0599329]
Stock Position:  -0.059932896960425516
Bond Position:  [20.53745148]


portfolio before change:  [14.34061036]
curr_Stock_Price:  103.41773992162605
curr_Factors:  [103.41773992]
mat_Sqrt:  [[0.15]]
grads:  [-0.08634409]
Stock Position:  -0.08634408874532754
Bond Position:  [23.27012088]


portfolio before change:  [14.37610275]
curr_Stock_Price:  103.02352694163812
curr_Factors:  [103.02352694]
mat_Sqrt:  [[0.15]]
grads:  [0.13522116]
Stock Position:  0.1352211613116539
Bond Position:  [0.4451418]


portfolio before change:  [14.44629256]
curr_Stock_Price:  103.54239534547081
curr_Factors:  [103.54239535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03491907]
Stock Position:  -0.034919067591616615
Bond Position:  [18.06189647]


portfolio before change:  [14.44138637]
curr_Stock_Price:  103.71522621598564
curr_Factors:  [103.71522622]
mat_Sqrt:  [[0.15]]
grads:  [0.04506596]
Stock Position:  0.0450659556901729
Bond Position:  [9.76736059]


portfolio before change:  [14.45663939]
curr_Stock_Price:  104.04013966163488
curr_Factors:  [104.04013966]
mat_Sqrt:  [[0.15]]
grads:  [0.11664008]
Stock Position:  0.11664007858891329
Bond Position:  [2.32138932]


portfolio before change:  [14.51268457]
curr_Stock_Price:  104.51939250635408
curr_Factors:  [104.51939251]
mat_Sqrt:  [[0.15]]
grads:  [0.04272268]
Stock Position:  0.042722683045891545
Bond Position:  [10.04733569]


portfolio before change:  [14.52018597]
curr_Stock_Price:  104.68027722590494
curr_Factors:  [104.68027723]
mat_Sqrt:  [[0.15]]
grads:  [0.55835558]
Stock Position:  0.5583555809029584
Bond Position:  [-43.92863103]


portfolio before change:  [14.19102702]
curr_Stock_Price:  104.0956796335723
curr_Factors:  [104.09567963]
mat_Sqrt:  [[0.15]]
grads:  [-0.05740335]
Stock Position:  -0.057403351453217635
Bond Position:  [20.1664679]


portfolio before change:  [14.15989884]
curr_Stock_Price:  104.65990840641554
curr_Factors:  [104.65990841]
mat_Sqrt:  [[0.15]]
grads:  [0.17364984]
Stock Position:  0.173649840258087
Bond Position:  [-4.01427753]


portfolio before change:  [14.18016577]
curr_Stock_Price:  104.77806471362344
curr_Factors:  [104.77806471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620364]
Stock Position:  -0.006203644863661579
Bond Position:  [14.83017167]


portfolio before change:  [14.18404226]
curr_Stock_Price:  104.3026054299121
curr_Factors:  [104.30260543]
mat_Sqrt:  [[0.15]]
grads:  [-0.05560438]
Stock Position:  -0.055604376090111256
Bond Position:  [19.98372356]


portfolio before change:  [14.2144018]
curr_Stock_Price:  103.77907625293258
curr_Factors:  [103.77907625]
mat_Sqrt:  [[0.15]]
grads:  [0.0443698]
Stock Position:  0.04436980120814159
Bond Position:  [9.60974481]


portfolio before change:  [14.21724561]
curr_Stock_Price:  103.82963286204493
curr_Factors:  [103.82963286]
mat_Sqrt:  [[0.15]]
grads:  [0.00239779]
Stock Position:  0.0023977940464194394
Bond Position:  [13.96828353]


portfolio before change:  [14.21749433]
curr_Stock_Price:  103.56925704171908
curr_Factors:  [103.56925704]
mat_Sqrt:  [[0.15]]
grads:  [0.30994698]
Stock Position:  0.3099469774988547
Bond Position:  [-17.88348385]


portfolio before change:  [13.82208381]
curr_Stock_Price:  102.29712730182969
curr_Factors:  [102.2971273]
mat_Sqrt:  [[0.15]]
grads:  [0.00479702]
Stock Position:  0.004797022141984446
Bond Position:  [13.33136222]


portfolio before change:  [13.82116349]
curr_Stock_Price:  101.93157640955835
curr_Factors:  [101.93157641]
mat_Sqrt:  [[0.15]]
grads:  [0.05289091]
Stock Position:  0.05289090651231031
Bond Position:  [8.42991001]


portfolio before change:  [13.82924283]
curr_Stock_Price:  102.07436942378568
curr_Factors:  [102.07436942]
mat_Sqrt:  [[0.15]]
grads:  [0.0190537]
Stock Position:  0.01905369868804375
Bond Position:  [11.88434855]


portfolio before change:  [13.83742853]
curr_Stock_Price:  102.46499734771285
curr_Factors:  [102.46499735]
mat_Sqrt:  [[0.15]]
grads:  [0.11789792]
Stock Position:  0.11789791614664133
Bond Position:  [1.75701886]


portfolio before change:  [13.80956019]
curr_Stock_Price:  102.22768901718682
curr_Factors:  [102.22768902]
mat_Sqrt:  [[0.15]]
grads:  [0.17215155]
Stock Position:  0.17215155394122375
Bond Position:  [-3.78909533]


portfolio before change:  [13.93356448]
curr_Stock_Price:  102.94938517693936
curr_Factors:  [102.94938518]
mat_Sqrt:  [[0.15]]
grads:  [-0.05191504]
Stock Position:  -0.05191504426392424
Bond Position:  [19.27818636]


portfolio before change:  [13.95375739]
curr_Stock_Price:  102.58363393062595
curr_Factors:  [102.58363393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00527314]
Stock Position:  -0.005273135377453822
Bond Position:  [14.49469478]


portfolio before change:  [13.9577138]
curr_Stock_Price:  102.00514245139043
curr_Factors:  [102.00514245]
mat_Sqrt:  [[0.15]]
grads:  [0.0901857]
Stock Position:  0.09018570189177881
Bond Position:  [4.75830843]


portfolio before change:  [13.96692234]
curr_Stock_Price:  102.10395112292146
curr_Factors:  [102.10395112]
mat_Sqrt:  [[0.15]]
grads:  [0.08849955]
Stock Position:  0.0884995508302985
Bond Position:  [4.93076852]


portfolio before change:  [13.90889637]
curr_Stock_Price:  101.44480489571914
curr_Factors:  [101.4448049]
mat_Sqrt:  [[0.15]]
grads:  [0.05363266]
Stock Position:  0.05363266260518185
Bond Position:  [8.46814138]


portfolio before change:  [13.91090197]
curr_Stock_Price:  101.47233136620997
curr_Factors:  [101.47233137]
mat_Sqrt:  [[0.15]]
grads:  [0.03826904]
Stock Position:  0.03826904374431759
Bond Position:  [10.02765288]


portfolio before change:  [13.91544013]
curr_Stock_Price:  101.57453971797419
curr_Factors:  [101.57453972]
mat_Sqrt:  [[0.15]]
grads:  [0.10841015]
Stock Position:  0.10841015017466654
Bond Position:  [2.90372903]


portfolio before change:  [13.94056859]
curr_Stock_Price:  101.804656307107
curr_Factors:  [101.80465631]
mat_Sqrt:  [[0.15]]
grads:  [-0.17897536]
Stock Position:  -0.178975361043521
Bond Position:  [32.16109371]


portfolio before change:  [13.83877448]
curr_Stock_Price:  102.38464812004771
curr_Factors:  [102.38464812]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737927]
Stock Position:  -0.01737926789351994
Bond Position:  [15.61814471]


portfolio before change:  [13.84842098]
curr_Stock_Price:  101.8857583232603
curr_Factors:  [101.88575832]
mat_Sqrt:  [[0.15]]
grads:  [-0.25582442]
Stock Position:  -0.255824424609114
Bond Position:  [39.91328648]


portfolio before change:  [13.74142895]
curr_Stock_Price:  102.31373425759628
curr_Factors:  [102.31373426]
mat_Sqrt:  [[0.15]]
grads:  [-0.08830317]
Stock Position:  -0.08830317425471693
Bond Position:  [22.77605645]


portfolio before change:  [13.68131662]
curr_Stock_Price:  103.01060472431588
curr_Factors:  [103.01060472]
mat_Sqrt:  [[0.15]]
grads:  [0.02573446]
Stock Position:  0.025734460381440703
Bond Position:  [11.03039429]


portfolio before change:  [13.69803786]
curr_Stock_Price:  103.63357568481456
curr_Factors:  [103.63357568]
mat_Sqrt:  [[0.15]]
grads:  [0.05563649]
Stock Position:  0.055636487065624754
Bond Position:  [7.93222977]


portfolio before change:  [13.68859321]
curr_Stock_Price:  103.4549081078885
curr_Factors:  [103.45490811]
mat_Sqrt:  [[0.15]]
grads:  [-0.06552066]
Stock Position:  -0.06552065925322556
Bond Position:  [20.46702699]


portfolio before change:  [13.67914943]
curr_Stock_Price:  103.61856644878858
curr_Factors:  [103.61856645]
mat_Sqrt:  [[0.15]]
grads:  [0.03124078]
Stock Position:  0.03124078059836541
Bond Position:  [10.44202453]


portfolio before change:  [13.65037447]
curr_Stock_Price:  102.67660503540709
curr_Factors:  [102.67660504]
mat_Sqrt:  [[0.15]]
grads:  [0.05738047]
Stock Position:  0.0573804693890954
Bond Position:  [7.75874268]


portfolio before change:  [13.67390532]
curr_Stock_Price:  103.07823836579273
curr_Factors:  [103.07823837]
mat_Sqrt:  [[0.15]]
grads:  [0.0800285]
Stock Position:  0.08002849507540906
Bond Position:  [5.42470902]


portfolio before change:  [13.66967337]
curr_Stock_Price:  103.02112121733992
curr_Factors:  [103.02112122]
mat_Sqrt:  [[0.15]]
grads:  [0.07040769]
Stock Position:  0.07040768743015233
Bond Position:  [6.41619447]


portfolio before change:  [13.67259433]
curr_Stock_Price:  103.05691179532269
curr_Factors:  [103.0569118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025986]
Stock Position:  -0.010259864229012306
Bond Position:  [14.72994425]


portfolio before change:  [13.67115885]
curr_Stock_Price:  103.28655729870832
curr_Factors:  [103.2865573]
mat_Sqrt:  [[0.15]]
grads:  [0.07996428]
Stock Position:  0.07996427837192353
Bond Position:  [5.41192383]


portfolio before change:  [13.70147587]
curr_Stock_Price:  103.66145933723833
curr_Factors:  [103.66145934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858397]
Stock Position:  -0.008583968044706132
Bond Position:  [14.59130253]


portfolio before change:  [13.69669526]
curr_Stock_Price:  104.32462587189926
curr_Factors:  [104.32462587]
mat_Sqrt:  [[0.15]]
grads:  [0.14048506]
Stock Position:  0.14048506048610537
Bond Position:  [-0.95935612]


portfolio before change:  [13.57285489]
curr_Stock_Price:  103.4435328620504
curr_Factors:  [103.44353286]
mat_Sqrt:  [[0.15]]
grads:  [0.00763038]
Stock Position:  0.007630381110549113
Bond Position:  [12.78354131]


portfolio before change:  [13.57428617]
curr_Stock_Price:  103.52639640211996
curr_Factors:  [103.5263964]
mat_Sqrt:  [[0.15]]
grads:  [-0.01253306]
Stock Position:  -0.012533055205299716
Bond Position:  [14.87178821]


portfolio before change:  [13.57319733]
curr_Stock_Price:  103.68743920176705
curr_Factors:  [103.6874392]
mat_Sqrt:  [[0.15]]
grads:  [-0.13677583]
Stock Position:  -0.13677583488636158
Bond Position:  [27.75513339]


portfolio before change:  [13.56071394]
curr_Stock_Price:  103.79139131459777
curr_Factors:  [103.79139131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03356237]
Stock Position:  -0.03356236643892191
Bond Position:  [17.04419865]


portfolio before change:  [13.56895922]
curr_Stock_Price:  103.57746173931595
curr_Factors:  [103.57746174]
mat_Sqrt:  [[0.15]]
grads:  [-0.01962974]
Stock Position:  -0.019629742345253085
Bond Position:  [15.6021581]


portfolio before change:  [13.56524933]
curr_Stock_Price:  103.81613272595501
curr_Factors:  [103.81613273]
mat_Sqrt:  [[0.15]]
grads:  [0.06029862]
Stock Position:  0.060298618698566106
Bond Position:  [7.30527993]


portfolio before change:  [13.61620338]
curr_Stock_Price:  104.65358898530748
curr_Factors:  [104.65358899]
mat_Sqrt:  [[0.15]]
grads:  [-0.11945973]
Stock Position:  -0.11945973206785618
Bond Position:  [26.11809308]


portfolio before change:  [13.61096146]
curr_Stock_Price:  104.71113433675819
curr_Factors:  [104.71113434]
mat_Sqrt:  [[0.15]]
grads:  [0.02152354]
Stock Position:  0.021523539630082918
Bond Position:  [11.35720721]


portfolio before change:  [13.63374416]
curr_Stock_Price:  105.73665587263538
curr_Factors:  [105.73665587]
mat_Sqrt:  [[0.15]]
grads:  [-0.02109775]
Stock Position:  -0.021097752590526334
Bond Position:  [15.86454997]


portfolio before change:  [13.64021354]
curr_Stock_Price:  105.47701625061926
curr_Factors:  [105.47701625]
mat_Sqrt:  [[0.15]]
grads:  [-0.04445042]
Stock Position:  -0.04445041583254002
Bond Position:  [18.32871077]


portfolio before change:  [13.63668896]
curr_Stock_Price:  105.58208072141815
curr_Factors:  [105.58208072]
mat_Sqrt:  [[0.15]]
grads:  [0.00744787]
Stock Position:  0.007447867311886061
Bond Position:  [12.85032763]


portfolio before change:  [13.63656261]
curr_Stock_Price:  105.4572764924557
curr_Factors:  [105.45727649]
mat_Sqrt:  [[0.15]]
grads:  [-0.12543846]
Stock Position:  -0.12543845554229802
Bond Position:  [26.8649605]


portfolio before change:  [13.69212414]
curr_Stock_Price:  105.02772388080311
curr_Factors:  [105.02772388]
mat_Sqrt:  [[0.15]]
grads:  [0.00398862]
Stock Position:  0.003988619151280641
Bond Position:  [13.27320854]


portfolio before change:  [13.69265792]
curr_Stock_Price:  104.95355935131889
curr_Factors:  [104.95355935]
mat_Sqrt:  [[0.15]]
grads:  [0.07561679]
Stock Position:  0.07561678679027664
Bond Position:  [5.756407]


portfolio before change:  [13.61554956]
curr_Stock_Price:  103.92907584452496
curr_Factors:  [103.92907584]
mat_Sqrt:  [[0.15]]
grads:  [0.08282021]
Stock Position:  0.08282021306709171
Bond Position:  [5.00812135]


portfolio before change:  [13.60809816]
curr_Stock_Price:  103.8353255869415
curr_Factors:  [103.83532559]
mat_Sqrt:  [[0.15]]
grads:  [0.05830119]
Stock Position:  0.05830119108510892
Bond Position:  [7.554375]


portfolio before change:  [13.61726114]
curr_Stock_Price:  103.98439324382805
curr_Factors:  [103.98439324]
mat_Sqrt:  [[0.15]]
grads:  [0.06853595]
Stock Position:  0.06853595188292988
Bond Position:  [6.49059177]


portfolio before change:  [13.6647031]
curr_Stock_Price:  104.67069401795952
curr_Factors:  [104.67069402]
mat_Sqrt:  [[0.15]]
grads:  [0.04728001]
Stock Position:  0.04728001039921761
Bond Position:  [8.71587159]


portfolio before change:  [13.65974036]
curr_Stock_Price:  104.55420721430355
curr_Factors:  [104.55420721]
mat_Sqrt:  [[0.15]]
grads:  [0.07310581]
Stock Position:  0.07310581128497232
Bond Position:  [6.01622022]


portfolio before change:  [13.66579392]
curr_Stock_Price:  104.63186906428503
curr_Factors:  [104.63186906]
mat_Sqrt:  [[0.15]]
grads:  [0.01465328]
Stock Position:  0.014653278045692187
Bond Position:  [12.13259405]


portfolio before change:  [13.66628909]
curr_Stock_Price:  104.6139116260234
curr_Factors:  [104.61391163]
mat_Sqrt:  [[0.15]]
grads:  [-0.10145428]
Stock Position:  -0.10145428190318698
Bond Position:  [24.27981837]


portfolio before change:  [13.60449585]
curr_Stock_Price:  105.23794419080588
curr_Factors:  [105.23794419]
mat_Sqrt:  [[0.15]]
grads:  [-0.13195775]
Stock Position:  -0.131957748350503
Bond Position:  [27.49145801]


portfolio before change:  [13.68920419]
curr_Stock_Price:  104.60903023545723
curr_Factors:  [104.60903024]
mat_Sqrt:  [[0.15]]
grads:  [0.00602055]
Stock Position:  0.006020547612581438
Bond Position:  [13.05940054]


portfolio before change:  [13.69414377]
curr_Stock_Price:  105.29390867002776
curr_Factors:  [105.29390867]
mat_Sqrt:  [[0.15]]
grads:  [-0.00704549]
Stock Position:  -0.007045485533755738
Bond Position:  [14.43599048]


portfolio before change:  [13.69980177]
curr_Stock_Price:  104.61890613638761
curr_Factors:  [104.61890614]
mat_Sqrt:  [[0.15]]
grads:  [-0.13404246]
Stock Position:  -0.13404245831718972
Bond Position:  [27.72317714]


portfolio before change:  [13.58949034]
curr_Stock_Price:  105.45479190471951
curr_Factors:  [105.4547919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0299948]
Stock Position:  -0.029994801296702435
Bond Position:  [16.75258587]


portfolio before change:  [13.59422122]
curr_Stock_Price:  105.33197692654362
curr_Factors:  [105.33197693]
mat_Sqrt:  [[0.15]]
grads:  [0.08794209]
Stock Position:  0.08794209295300107
Bond Position:  [4.33110671]


portfolio before change:  [13.56221071]
curr_Stock_Price:  104.96490340571631
curr_Factors:  [104.96490341]
mat_Sqrt:  [[0.15]]
grads:  [0.03047186]
Stock Position:  0.030471863563343665
Bond Position:  [10.36373449]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.56200093]
Stock Price:  104.93676159141478
PL:  [8.62523934]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38731701e-02]
 [ 2.85822612e-02]
 [ 3.16316472e-03]
 [-8.58737329e-03]
 [ 1.09973944e-02]
 [-1.58103445e-02]
 [-1.35925095e-02]
 [ 8.76478090e-02]
 [-2.11043161e-02]
 [-1.35745204e-02]
 [-3.91870887e-03]
 [-6.85165940e-03]
 [ 3.00569192e-03]
 [-7.73646113e-03]
 [ 2.20786609e-03]
 [ 7.10908866e-04]
 [-4.34893860e-02]
 [-1.07631124e-02]
 [ 2.30784374e-02]
 [-4.69523413e-03]
 [-2.18232801e-02]
 [ 5.90125809e-03]
 [ 1.38488058e-02]
 [ 1.93326339e-02]
 [ 2.33634971e-03]
 [ 4.42107063e-03]
 [ 1.32266604e-04]
 [ 1.98607386e-02]
 [-2.72772512e-02]
 [ 6.75658917e-02]
 [-6.56406677e-03]
 [ 2.42931549e-02]
 [ 1.19466735e-02]
 [-2.01897984e-02]
 [-8.17804743e-03]
 [-2.85267556e-03]
 [ 5.55479151e-03]
 [-6.92771515e-04]
 [-2.37420232e-02]
 [-1.36189193e-02]
 [ 6.94523247e-03]
 [ 3.55633288e-02]
 [-3.37057942e-03]
 [ 3.15822365e-03]
 [-3.95651869e-02]
 [ 1.98897549e-02]
 [ 9.46198258e-03]
 [ 5.36406157e-03]
 [-8.30951897e-03]
 [-4.68560099e-05]
 [-3.34642767e-03]
 [-7.71870459e-04]
 [-7.77314120e-05]
 [ 6.04814583e-03]
 [-1.20602329e-02]
 [-5.07934735e-03]
 [-1.95263076e-03]
 [ 1.33716875e-02]
 [ 7.23853973e-03]
 [-3.14171229e-03]
 [-5.14242150e-03]
 [-1.36640331e-03]
 [-2.86996883e-03]
 [-2.75727657e-03]
 [ 1.86120540e-02]
 [ 5.42995842e-03]
 [ 2.02734463e-02]
 [-3.28401971e-03]
 [ 6.23319067e-03]
 [ 2.47931193e-02]
 [ 3.28225243e-03]
 [-1.53456025e-02]
 [-5.72113449e-03]
 [ 2.63566558e-03]
 [ 1.18869695e-02]
 [ 1.21043840e-02]
 [ 4.77839352e-03]
 [-3.20702011e-02]
 [-2.89266839e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.65870559]
curr_Stock_Price:  99.69621671732025
curr_Factors:  [99.69621672]
mat_Sqrt:  [[0.15]]
grads:  [-0.0924878]
Stock Position:  -0.09248780094115207
Bond Position:  [4.56197826]


portfolio before change:  [-4.74680638]
curr_Stock_Price:  100.6518662425269
curr_Factors:  [100.65186624]
mat_Sqrt:  [[0.15]]
grads:  [0.19054841]
Stock Position:  0.19054840805717407
Bond Position:  [-23.92585926]


portfolio before change:  [-4.89607516]
curr_Stock_Price:  99.87635011363811
curr_Factors:  [99.87635011]
mat_Sqrt:  [[0.15]]
grads:  [0.02108776]
Stock Position:  0.02108776478475722
Bond Position:  [-7.00224414]


portfolio before change:  [-4.90236364]
curr_Stock_Price:  99.59889852702266
curr_Factors:  [99.59889853]
mat_Sqrt:  [[0.15]]
grads:  [-0.05724916]
Stock Position:  -0.057249155236967234
Bond Position:  [0.79958916]


portfolio before change:  [-4.82735808]
curr_Stock_Price:  98.289611302555
curr_Factors:  [98.2896113]
mat_Sqrt:  [[0.15]]
grads:  [0.07331596]
Stock Position:  0.07331596246992718
Bond Position:  [-12.03355553]


portfolio before change:  [-4.84332716]
curr_Stock_Price:  98.08205816625842
curr_Factors:  [98.08205817]
mat_Sqrt:  [[0.15]]
grads:  [-0.1054023]
Stock Position:  -0.10540229643897495
Bond Position:  [5.49474701]


portfolio before change:  [-4.80134777]
curr_Stock_Price:  97.68703869324148
curr_Factors:  [97.68703869]
mat_Sqrt:  [[0.15]]
grads:  [-0.09061673]
Stock Position:  -0.09061672983835624
Bond Position:  [4.05073223]


portfolio before change:  [-4.71187146]
curr_Stock_Price:  96.70241776014286
curr_Factors:  [96.70241776]
mat_Sqrt:  [[0.15]]
grads:  [0.58431873]
Stock Position:  0.5843187263850487
Bond Position:  [-61.21690504]


portfolio before change:  [-4.79647798]
curr_Stock_Price:  96.5641707017103
curr_Factors:  [96.5641707]
mat_Sqrt:  [[0.15]]
grads:  [-0.14069544]
Stock Position:  -0.1406954407188999
Bond Position:  [8.78966057]


portfolio before change:  [-4.7928125]
curr_Stock_Price:  96.54202278469366
curr_Factors:  [96.54202278]
mat_Sqrt:  [[0.15]]
grads:  [-0.0904968]
Stock Position:  -0.09049680277322082
Bond Position:  [3.9439319]


portfolio before change:  [-4.81465503]
curr_Stock_Price:  96.78610909139996
curr_Factors:  [96.78610909]
mat_Sqrt:  [[0.15]]
grads:  [-0.02612473]
Stock Position:  -0.0261247257987637
Bond Position:  [-2.28614447]


portfolio before change:  [-4.83109224]
curr_Stock_Price:  97.40982205541636
curr_Factors:  [97.40982206]
mat_Sqrt:  [[0.15]]
grads:  [-0.04567773]
Stock Position:  -0.04567772932598428
Bond Position:  [-0.38163276]


portfolio before change:  [-4.80987642]
curr_Stock_Price:  96.94483220832554
curr_Factors:  [96.94483221]
mat_Sqrt:  [[0.15]]
grads:  [0.02003795]
Stock Position:  0.02003794613407486
Bond Position:  [-6.75245174]


portfolio before change:  [-4.81275696]
curr_Stock_Price:  96.82214017084662
curr_Factors:  [96.82214017]
mat_Sqrt:  [[0.15]]
grads:  [-0.05157641]
Stock Position:  -0.05157640750966203
Bond Position:  [0.1809812]


portfolio before change:  [-4.83802742]
curr_Stock_Price:  97.31232111162738
curr_Factors:  [97.31232111]
mat_Sqrt:  [[0.15]]
grads:  [0.01471911]
Stock Position:  0.014719107270430843
Bond Position:  [-6.27037791]


portfolio before change:  [-4.84944096]
curr_Stock_Price:  96.56352312134297
curr_Factors:  [96.56352312]
mat_Sqrt:  [[0.15]]
grads:  [0.00473939]
Stock Position:  0.00473939243981462
Bond Position:  [-5.3070934]


portfolio before change:  [-4.85054232]
curr_Stock_Price:  96.40112927102295
curr_Factors:  [96.40112927]
mat_Sqrt:  [[0.15]]
grads:  [-0.28992924]
Stock Position:  -0.28992923966846706
Bond Position:  [23.0989638]


portfolio before change:  [-4.99503925]
curr_Stock_Price:  96.90449574659614
curr_Factors:  [96.90449575]
mat_Sqrt:  [[0.15]]
grads:  [-0.07175408]
Stock Position:  -0.07175408237766431
Bond Position:  [1.95825393]


portfolio before change:  [-4.94344629]
curr_Stock_Price:  96.1871768204533
curr_Factors:  [96.18717682]
mat_Sqrt:  [[0.15]]
grads:  [0.15385625]
Stock Position:  0.15385624946240836
Bond Position:  [-19.74244456]


portfolio before change:  [-4.93727362]
curr_Stock_Price:  96.23531664060997
curr_Factors:  [96.23531664]
mat_Sqrt:  [[0.15]]
grads:  [-0.03130156]
Stock Position:  -0.03130156083718952
Bond Position:  [-1.924958]


portfolio before change:  [-4.94707192]
curr_Stock_Price:  96.54450199503773
curr_Factors:  [96.544502]
mat_Sqrt:  [[0.15]]
grads:  [-0.14548853]
Stock Position:  -0.14548853428971495
Bond Position:  [9.09904617]


portfolio before change:  [-4.94608511]
curr_Stock_Price:  96.54162826817024
curr_Factors:  [96.54162827]
mat_Sqrt:  [[0.15]]
grads:  [0.03934172]
Stock Position:  0.0393417206166206
Bond Position:  [-8.74419888]


portfolio before change:  [-4.94779964]
curr_Stock_Price:  96.51193985627148
curr_Factors:  [96.51193986]
mat_Sqrt:  [[0.15]]
grads:  [0.09232537]
Stock Position:  0.09232537174571624
Bond Position:  [-13.85830036]


portfolio before change:  [-4.87625181]
curr_Stock_Price:  97.29627460522843
curr_Factors:  [97.29627461]
mat_Sqrt:  [[0.15]]
grads:  [0.12888423]
Stock Position:  0.12888422593555351
Bond Position:  [-17.41620685]


portfolio before change:  [-4.86410273]
curr_Stock_Price:  97.39898403124135
curr_Factors:  [97.39898403]
mat_Sqrt:  [[0.15]]
grads:  [0.01557566]
Stock Position:  0.01557566471478147
Bond Position:  [-6.38115665]


portfolio before change:  [-4.8714999]
curr_Stock_Price:  96.94967230700809
curr_Factors:  [96.94967231]
mat_Sqrt:  [[0.15]]
grads:  [0.0294738]
Stock Position:  0.029473804208196067
Bond Position:  [-7.72897556]


portfolio before change:  [-4.91218294]
curr_Stock_Price:  95.58575034102532
curr_Factors:  [95.58575034]
mat_Sqrt:  [[0.15]]
grads:  [0.00088178]
Stock Position:  0.000881777361483339
Bond Position:  [-4.99646829]


portfolio before change:  [-4.91263816]
curr_Stock_Price:  95.42365622323163
curr_Factors:  [95.42365622]
mat_Sqrt:  [[0.15]]
grads:  [0.13240492]
Stock Position:  0.13240492371119586
Bond Position:  [-17.54720008]


portfolio before change:  [-4.93914226]
curr_Stock_Price:  95.23176482262748
curr_Factors:  [95.23176482]
mat_Sqrt:  [[0.15]]
grads:  [-0.18184834]
Stock Position:  -0.18184834116975673
Bond Position:  [12.3785962]


portfolio before change:  [-5.01404014]
curr_Stock_Price:  95.64788941338252
curr_Factors:  [95.64788941]
mat_Sqrt:  [[0.15]]
grads:  [0.45043928]
Stock Position:  0.4504392776890302
Bond Position:  [-48.09760636]


portfolio before change:  [-4.8623806]
curr_Stock_Price:  95.99125585607015
curr_Factors:  [95.99125586]
mat_Sqrt:  [[0.15]]
grads:  [-0.04376045]
Stock Position:  -0.043760445135348734
Bond Position:  [-0.66176052]


portfolio before change:  [-4.85893185]
curr_Stock_Price:  95.91150083820648
curr_Factors:  [95.91150084]
mat_Sqrt:  [[0.15]]
grads:  [0.16195437]
Stock Position:  0.1619543658684022
Bond Position:  [-20.39221815]


portfolio before change:  [-4.65359529]
curr_Stock_Price:  97.18723746729732
curr_Factors:  [97.18723747]
mat_Sqrt:  [[0.15]]
grads:  [0.07964449]
Stock Position:  0.0796444901809624
Bond Position:  [-12.39402327]


portfolio before change:  [-4.64372447]
curr_Stock_Price:  97.32089982203851
curr_Factors:  [97.32089982]
mat_Sqrt:  [[0.15]]
grads:  [-0.13459866]
Stock Position:  -0.13459865573012234
Bond Position:  [8.45553782]


portfolio before change:  [-4.66628832]
curr_Stock_Price:  97.49246423019594
curr_Factors:  [97.49246423]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452032]
Stock Position:  -0.05452031620881616
Bond Position:  [0.64903166]


portfolio before change:  [-4.63161346]
curr_Stock_Price:  96.85720951063782
curr_Factors:  [96.85720951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901784]
Stock Position:  -0.01901783703491739
Bond Position:  [-2.78959884]


portfolio before change:  [-4.64466207]
curr_Stock_Price:  97.53416617617611
curr_Factors:  [97.53416618]
mat_Sqrt:  [[0.15]]
grads:  [0.03703194]
Stock Position:  0.037031943377944895
Bond Position:  [-8.25654179]


portfolio before change:  [-4.65468223]
curr_Stock_Price:  97.27751991976211
curr_Factors:  [97.27751992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00461848]
Stock Position:  -0.00461847676772118
Bond Position:  [-4.20540826]


portfolio before change:  [-4.65549365]
curr_Stock_Price:  97.39629698185352
curr_Factors:  [97.39629698]
mat_Sqrt:  [[0.15]]
grads:  [-0.15828015]
Stock Position:  -0.1582801547589737
Bond Position:  [10.76040731]


portfolio before change:  [-4.62615293]
curr_Stock_Price:  97.21517400368545
curr_Factors:  [97.215174]
mat_Sqrt:  [[0.15]]
grads:  [-0.0907928]
Stock Position:  -0.09079279537775614
Bond Position:  [4.20028447]


portfolio before change:  [-4.5350636]
curr_Stock_Price:  96.21479949155857
curr_Factors:  [96.21479949]
mat_Sqrt:  [[0.15]]
grads:  [0.04630155]
Stock Position:  0.046301549789997676
Bond Position:  [-8.98995793]


portfolio before change:  [-4.55043377]
curr_Stock_Price:  95.89497703111903
curr_Factors:  [95.89497703]
mat_Sqrt:  [[0.15]]
grads:  [0.23708886]
Stock Position:  0.23708885888504755
Bond Position:  [-27.28606444]


portfolio before change:  [-4.49873682]
curr_Stock_Price:  96.12021908844157
curr_Factors:  [96.12021909]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247053]
Stock Position:  -0.02247052949967477
Bond Position:  [-2.3388646]


portfolio before change:  [-4.53596041]
curr_Stock_Price:  97.77026521275211
curr_Factors:  [97.77026521]
mat_Sqrt:  [[0.15]]
grads:  [0.02105482]
Stock Position:  0.021054824317639408
Bond Position:  [-6.59449617]


portfolio before change:  [-4.57043574]
curr_Stock_Price:  96.15243364301772
curr_Factors:  [96.15243364]
mat_Sqrt:  [[0.15]]
grads:  [-0.26376791]
Stock Position:  -0.26376791273096023
Bond Position:  [20.79149099]


portfolio before change:  [-4.68916247]
curr_Stock_Price:  96.60747852579094
curr_Factors:  [96.60747853]
mat_Sqrt:  [[0.15]]
grads:  [0.13259837]
Stock Position:  0.13259836578663398
Bond Position:  [-17.49915624]


portfolio before change:  [-4.76148977]
curr_Stock_Price:  96.07026553032294
curr_Factors:  [96.07026553]
mat_Sqrt:  [[0.15]]
grads:  [0.06307988]
Stock Position:  0.06307988383587035
Bond Position:  [-10.82159096]


portfolio before change:  [-4.7833393]
curr_Stock_Price:  95.73460922125965
curr_Factors:  [95.73460922]
mat_Sqrt:  [[0.15]]
grads:  [0.03576041]
Stock Position:  0.03576041047105387
Bond Position:  [-8.20684822]


portfolio before change:  [-4.77162163]
curr_Stock_Price:  96.0766246018426
curr_Factors:  [96.0766246]
mat_Sqrt:  [[0.15]]
grads:  [-0.05539679]
Stock Position:  -0.05539679312102211
Bond Position:  [0.55071527]


portfolio before change:  [-4.76172139]
curr_Stock_Price:  95.89853091575506
curr_Factors:  [95.89853092]
mat_Sqrt:  [[0.15]]
grads:  [-0.00031237]
Stock Position:  -0.00031237339906285417
Bond Position:  [-4.73176524]


portfolio before change:  [-4.76210229]
curr_Stock_Price:  96.17114039474284
curr_Factors:  [96.17114039]
mat_Sqrt:  [[0.15]]
grads:  [-0.02230952]
Stock Position:  -0.022309517788964818
Bond Position:  [-2.61657052]


portfolio before change:  [-4.77034416]
curr_Stock_Price:  96.53324271979011
curr_Factors:  [96.53324272]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051458]
Stock Position:  -0.005145803062551099
Bond Position:  [-4.27360311]


portfolio before change:  [-4.768118]
curr_Stock_Price:  96.04871741852209
curr_Factors:  [96.04871742]
mat_Sqrt:  [[0.15]]
grads:  [-0.00051821]
Stock Position:  -0.0005182094131505674
Bond Position:  [-4.71834465]


portfolio before change:  [-4.76802131]
curr_Stock_Price:  95.293051640859
curr_Factors:  [95.29305164]
mat_Sqrt:  [[0.15]]
grads:  [0.04032097]
Stock Position:  0.0403209721850282
Bond Position:  [-8.6103298]


portfolio before change:  [-4.74490884]
curr_Stock_Price:  95.87961072911943
curr_Factors:  [95.87961073]
mat_Sqrt:  [[0.15]]
grads:  [-0.08040155]
Stock Position:  -0.08040155262510944
Bond Position:  [2.96396073]


portfolio before change:  [-4.73548824]
curr_Stock_Price:  95.76474544037734
curr_Factors:  [95.76474544]
mat_Sqrt:  [[0.15]]
grads:  [-0.03386232]
Stock Position:  -0.033862315653120555
Bond Position:  [-1.4926722]


portfolio before change:  [-4.73320951]
curr_Stock_Price:  95.69469622255801
curr_Factors:  [95.69469622]
mat_Sqrt:  [[0.15]]
grads:  [-0.01301754]
Stock Position:  -0.013017538390478135
Bond Position:  [-3.48750012]


portfolio before change:  [-4.73032285]
curr_Stock_Price:  95.45620046604644
curr_Factors:  [95.45620047]
mat_Sqrt:  [[0.15]]
grads:  [0.08914458]
Stock Position:  0.08914458323579932
Bond Position:  [-13.23972606]


portfolio before change:  [-4.65947849]
curr_Stock_Price:  96.2601963384549
curr_Factors:  [96.26019634]
mat_Sqrt:  [[0.15]]
grads:  [0.04825693]
Stock Position:  0.04825693151873429
Bond Position:  [-9.30470019]


portfolio before change:  [-4.6440993]
curr_Stock_Price:  96.59094151535247
curr_Factors:  [96.59094152]
mat_Sqrt:  [[0.15]]
grads:  [-0.02094475]
Stock Position:  -0.020944748605464372
Bond Position:  [-2.62102631]


portfolio before change:  [-4.64847237]
curr_Stock_Price:  96.7919107340261
curr_Factors:  [96.79191073]
mat_Sqrt:  [[0.15]]
grads:  [-0.03428281]
Stock Position:  -0.034282809987424896
Bond Position:  [-1.33017368]


portfolio before change:  [-4.64508943]
curr_Stock_Price:  96.6908082854341
curr_Factors:  [96.69080829]
mat_Sqrt:  [[0.15]]
grads:  [-0.00910936]
Stock Position:  -0.009109355430201999
Bond Position:  [-3.76429849]


portfolio before change:  [-4.64203976]
curr_Stock_Price:  96.33019623625205
curr_Factors:  [96.33019624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01913313]
Stock Position:  -0.01913312554451114
Bond Position:  [-2.79894203]


portfolio before change:  [-4.64490763]
curr_Stock_Price:  96.47094282490906
curr_Factors:  [96.47094282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01838184]
Stock Position:  -0.018381843824623892
Bond Position:  [-2.87159382]


portfolio before change:  [-4.63658587]
curr_Stock_Price:  96.0084625575761
curr_Factors:  [96.00846256]
mat_Sqrt:  [[0.15]]
grads:  [0.12408036]
Stock Position:  0.12408035985704495
Bond Position:  [-16.54935045]


portfolio before change:  [-4.60914346]
curr_Stock_Price:  96.23796524735624
curr_Factors:  [96.23796525]
mat_Sqrt:  [[0.15]]
grads:  [0.03619972]
Stock Position:  0.03619972277067452
Bond Position:  [-8.09293112]


portfolio before change:  [-4.6392866]
curr_Stock_Price:  95.41924839052822
curr_Factors:  [95.41924839]
mat_Sqrt:  [[0.15]]
grads:  [0.13515631]
Stock Position:  0.1351563089463564
Bond Position:  [-17.53580002]


portfolio before change:  [-4.61576906]
curr_Stock_Price:  95.60136021904226
curr_Factors:  [95.60136022]
mat_Sqrt:  [[0.15]]
grads:  [-0.02189346]
Stock Position:  -0.021893464754811413
Bond Position:  [-2.52272405]


portfolio before change:  [-4.61915452]
curr_Stock_Price:  95.74879138402451
curr_Factors:  [95.74879138]
mat_Sqrt:  [[0.15]]
grads:  [0.0415546]
Stock Position:  0.04155460446987414
Bond Position:  [-8.59795767]


portfolio before change:  [-4.59939953]
curr_Stock_Price:  96.23712183616527
curr_Factors:  [96.23712184]
mat_Sqrt:  [[0.15]]
grads:  [0.16528746]
Stock Position:  0.16528746187711785
Bond Position:  [-20.50618913]


portfolio before change:  [-4.59584222]
curr_Stock_Price:  96.2663979840797
curr_Factors:  [96.26639798]
mat_Sqrt:  [[0.15]]
grads:  [0.02188168]
Stock Position:  0.021881682837388974
Bond Position:  [-6.70231301]


portfolio before change:  [-4.60332655]
curr_Stock_Price:  95.94350585924188
curr_Factors:  [95.94350586]
mat_Sqrt:  [[0.15]]
grads:  [-0.10230402]
Stock Position:  -0.1023040167791289
Bond Position:  [5.21207948]


portfolio before change:  [-4.48035423]
curr_Stock_Price:  94.74466186515342
curr_Factors:  [94.74466187]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381409]
Stock Position:  -0.03814089660744429
Bond Position:  [-0.86670788]


portfolio before change:  [-4.49139867]
curr_Stock_Price:  95.03281098548109
curr_Factors:  [95.03281099]
mat_Sqrt:  [[0.15]]
grads:  [0.0175711]
Stock Position:  0.01757110384267476
Bond Position:  [-6.16123006]


portfolio before change:  [-4.50651297]
curr_Stock_Price:  94.19454744743427
curr_Factors:  [94.19454745]
mat_Sqrt:  [[0.15]]
grads:  [0.07924646]
Stock Position:  0.07924646325956099
Bond Position:  [-11.97109772]


portfolio before change:  [-4.50717112]
curr_Stock_Price:  94.19568409487741
curr_Factors:  [94.19568409]
mat_Sqrt:  [[0.15]]
grads:  [0.08069589]
Stock Position:  0.08069589356944473
Bond Position:  [-12.10837601]


portfolio before change:  [-4.59936055]
curr_Stock_Price:  93.06263223360061
curr_Factors:  [93.06263223]
mat_Sqrt:  [[0.15]]
grads:  [0.03185596]
Stock Position:  0.0318559568188103
Bond Position:  [-7.56395974]


portfolio before change:  [-4.59315624]
curr_Stock_Price:  93.27223400302051
curr_Factors:  [93.272234]
mat_Sqrt:  [[0.15]]
grads:  [-0.21380134]
Stock Position:  -0.21380134069527976
Bond Position:  [15.34857244]


portfolio before change:  [-4.64801814]
curr_Stock_Price:  93.53332317442518
curr_Factors:  [93.53332317]
mat_Sqrt:  [[0.15]]
grads:  [-0.19284456]
Stock Position:  -0.19284455930448208
Bond Position:  [13.38937435]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.60525596]
Stock Price:  93.31591845023416
PL:  [-4.60525596]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.23951188e-03]
 [ 4.71261524e-02]
 [ 1.74789562e-02]
 [-2.89684727e-02]
 [-5.19500169e-02]
 [-1.30260439e-03]
 [-2.98852553e-03]
 [-3.83448146e-02]
 [ 1.64544165e-02]
 [-5.56256658e-03]
 [-8.62842843e-03]
 [ 1.32693597e-02]
 [-3.64199886e-03]
 [ 4.52932366e-03]
 [ 2.01172375e-03]
 [ 1.49723918e-02]
 [ 9.59999744e-02]
 [-1.25537341e-02]
 [ 2.13607580e-02]
 [ 1.59712433e-03]
 [-4.32513098e-03]
 [ 4.31568567e-03]
 [ 1.66500665e-02]
 [ 1.72177651e-02]
 [-2.40828781e-03]
 [ 7.30255129e-03]
 [-6.75216344e-03]
 [ 1.14299585e-02]
 [ 3.44455344e-02]
 [ 2.32732199e-03]
 [-6.89570858e-03]
 [ 8.41819822e-03]
 [ 1.16175538e-02]
 [-1.90598419e-02]
 [-1.73326005e-03]
 [ 1.84742486e-02]
 [ 5.46390088e-03]
 [ 6.86385620e-06]
 [-3.45312293e-02]
 [-1.74568053e-02]
 [ 7.16951921e-03]
 [ 1.12963803e-02]
 [-1.94352060e-03]
 [-1.00308797e-03]
 [ 9.75699307e-03]
 [ 1.52302895e-02]
 [ 1.03290996e-02]
 [ 5.09479774e-03]
 [ 5.27833971e-03]
 [-2.11625535e-03]
 [-4.66621816e-03]
 [ 4.96764503e-05]
 [ 1.32166166e-03]
 [ 3.57004193e-03]
 [-4.54995928e-03]
 [-4.06880241e-03]
 [ 3.62134742e-03]
 [ 8.99232504e-03]
 [ 7.50307248e-03]
 [-3.83045930e-03]
 [-2.97196138e-03]
 [ 8.47249861e-04]
 [-5.76132751e-03]
 [ 3.08498657e-03]
 [ 2.00231381e-02]
 [ 5.02126769e-03]
 [ 1.02108887e-02]
 [-3.49040753e-04]
 [ 2.91968117e-03]
 [ 2.15937325e-02]
 [ 1.43789275e-03]
 [-1.59846580e-02]
 [-7.66161657e-04]
 [ 1.36632539e-03]
 [ 6.39430606e-04]
 [-1.15831913e-02]
 [-4.34607027e-03]
 [ 1.58583112e-02]
 [-7.38341313e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.78693454]
curr_Stock_Price:  100.71565169429637
curr_Factors:  [100.71565169]
mat_Sqrt:  [[0.15]]
grads:  [-0.03493008]
Stock Position:  -0.03493007922300305
Bond Position:  [21.30494023]


portfolio before change:  [17.77051759]
curr_Stock_Price:  101.22376807079807
curr_Factors:  [101.22376807]
mat_Sqrt:  [[0.15]]
grads:  [0.31417435]
Stock Position:  0.31417434931772625
Bond Position:  [-14.03139388]


portfolio before change:  [17.89015312]
curr_Stock_Price:  101.60735290175181
curr_Factors:  [101.6073529]
mat_Sqrt:  [[0.15]]
grads:  [0.11652637]
Stock Position:  0.1165263748849319
Bond Position:  [6.05021662]


portfolio before change:  [17.86464861]
curr_Stock_Price:  101.38523446409424
curr_Factors:  [101.38523446]
mat_Sqrt:  [[0.15]]
grads:  [-0.19312315]
Stock Position:  -0.19312315129561983
Bond Position:  [37.44448458]


portfolio before change:  [17.71451057]
curr_Stock_Price:  102.17477414524821
curr_Factors:  [102.17477415]
mat_Sqrt:  [[0.15]]
grads:  [-0.34633345]
Stock Position:  -0.346333445931832
Bond Position:  [53.10105219]


portfolio before change:  [17.84551949]
curr_Stock_Price:  101.80608322489446
curr_Factors:  [101.80608322]
mat_Sqrt:  [[0.15]]
grads:  [-0.00868403]
Stock Position:  -0.008684029256095481
Bond Position:  [18.72960649]


portfolio before change:  [17.84993263]
curr_Stock_Price:  101.43269597824008
curr_Factors:  [101.43269598]
mat_Sqrt:  [[0.15]]
grads:  [-0.0199235]
Stock Position:  -0.01992350351667603
Bond Position:  [19.87082731]


portfolio before change:  [17.84704997]
curr_Stock_Price:  101.63971917804979
curr_Factors:  [101.63971918]
mat_Sqrt:  [[0.15]]
grads:  [-0.2556321]
Stock Position:  -0.25563209743995474
Bond Position:  [43.82942457]


portfolio before change:  [17.83673927]
curr_Stock_Price:  101.69076958954814
curr_Factors:  [101.69076959]
mat_Sqrt:  [[0.15]]
grads:  [0.10969611]
Stock Position:  0.10969610983902733
Bond Position:  [6.68165744]


portfolio before change:  [17.83429647]
curr_Stock_Price:  101.66469372000083
curr_Factors:  [101.66469372]
mat_Sqrt:  [[0.15]]
grads:  [-0.03708378]
Stock Position:  -0.037083777225946565
Bond Position:  [21.60440732]


portfolio before change:  [17.85029822]
curr_Stock_Price:  101.26960359126481
curr_Factors:  [101.26960359]
mat_Sqrt:  [[0.15]]
grads:  [-0.05752286]
Stock Position:  -0.05752285620710192
Bond Position:  [23.67561506]


portfolio before change:  [17.84021806]
curr_Stock_Price:  101.47056589471227
curr_Factors:  [101.47056589]
mat_Sqrt:  [[0.15]]
grads:  [0.0884624]
Stock Position:  0.08846239783591953
Bond Position:  [8.8638885]


portfolio before change:  [17.83712197]
curr_Stock_Price:  101.42930422215825
curr_Factors:  [101.42930422]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427999]
Stock Position:  -0.024279992397139134
Bond Position:  [20.2998247]


portfolio before change:  [17.83369225]
curr_Stock_Price:  101.62281730786913
curr_Factors:  [101.62281731]
mat_Sqrt:  [[0.15]]
grads:  [0.03019549]
Stock Position:  0.030195491066327847
Bond Position:  [14.76514138]


portfolio before change:  [17.82841635]
curr_Stock_Price:  101.41753009340503
curr_Factors:  [101.41753009]
mat_Sqrt:  [[0.15]]
grads:  [0.01341149]
Stock Position:  0.013411491654916723
Bond Position:  [16.46825599]


portfolio before change:  [17.82971534]
curr_Stock_Price:  101.43763870078541
curr_Factors:  [101.4376387]
mat_Sqrt:  [[0.15]]
grads:  [0.09981595]
Stock Position:  0.09981594557898738
Bond Position:  [7.70462151]


portfolio before change:  [17.90441775]
curr_Stock_Price:  102.18121589618733
curr_Factors:  [102.1812159]
mat_Sqrt:  [[0.15]]
grads:  [0.63999983]
Stock Position:  0.6399998290653992
Bond Position:  [-47.49154296]


portfolio before change:  [17.78979124]
curr_Stock_Price:  102.00674991621072
curr_Factors:  [102.00674992]
mat_Sqrt:  [[0.15]]
grads:  [-0.08369156]
Stock Position:  -0.08369156053948848
Bond Position:  [26.32689533]


portfolio before change:  [17.77277476]
curr_Stock_Price:  102.22973492623356
curr_Factors:  [102.22973493]
mat_Sqrt:  [[0.15]]
grads:  [0.14240505]
Stock Position:  0.14240505358058325
Bond Position:  [3.21474388]


portfolio before change:  [17.63320509]
curr_Stock_Price:  101.24823467741767
curr_Factors:  [101.24823468]
mat_Sqrt:  [[0.15]]
grads:  [0.0106475]
Stock Position:  0.010647495529575429
Bond Position:  [16.55516497]


portfolio before change:  [17.6277291]
curr_Stock_Price:  100.63675541857603
curr_Factors:  [100.63675542]
mat_Sqrt:  [[0.15]]
grads:  [-0.02883421]
Stock Position:  -0.02883420653696709
Bond Position:  [20.52951009]


portfolio before change:  [17.64984866]
curr_Stock_Price:  99.91412656539632
curr_Factors:  [99.91412657]
mat_Sqrt:  [[0.15]]
grads:  [0.02877124]
Stock Position:  0.028771237810547093
Bond Position:  [14.77519557]


portfolio before change:  [17.64677891]
curr_Stock_Price:  99.77533403053849
curr_Factors:  [99.77533403]
mat_Sqrt:  [[0.15]]
grads:  [0.11100044]
Stock Position:  0.11100044329777413
Bond Position:  [6.5716726]


portfolio before change:  [17.69448687]
curr_Stock_Price:  100.20143337366983
curr_Factors:  [100.20143337]
mat_Sqrt:  [[0.15]]
grads:  [0.1147851]
Stock Position:  0.11478510039809806
Bond Position:  [6.19285528]


portfolio before change:  [17.81242727]
curr_Stock_Price:  101.2255500467332
curr_Factors:  [101.22555005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605525]
Stock Position:  -0.016055252075994654
Bond Position:  [19.43762899]


portfolio before change:  [17.80982605]
curr_Stock_Price:  101.46323614334723
curr_Factors:  [101.46323614]
mat_Sqrt:  [[0.15]]
grads:  [0.04868368]
Stock Position:  0.0486836752919504
Bond Position:  [12.8702228]


portfolio before change:  [17.77772904]
curr_Stock_Price:  100.7874158121371
curr_Factors:  [100.78741581]
mat_Sqrt:  [[0.15]]
grads:  [-0.04501442]
Stock Position:  -0.04501442293121566
Bond Position:  [22.31461641]


portfolio before change:  [17.74703157]
curr_Stock_Price:  101.50034684043118
curr_Factors:  [101.50034684]
mat_Sqrt:  [[0.15]]
grads:  [0.07619972]
Stock Position:  0.07619972345952566
Bond Position:  [10.01273321]


portfolio before change:  [17.72923302]
curr_Stock_Price:  101.25855635885436
curr_Factors:  [101.25855636]
mat_Sqrt:  [[0.15]]
grads:  [0.2296369]
Stock Position:  0.2296368957971849
Bond Position:  [-5.52346754]


portfolio before change:  [17.71123248]
curr_Stock_Price:  101.18167276145336
curr_Factors:  [101.18167276]
mat_Sqrt:  [[0.15]]
grads:  [0.01551548]
Stock Position:  0.015515479940785629
Bond Position:  [16.14135027]


portfolio before change:  [17.70446027]
curr_Stock_Price:  100.68016840327446
curr_Factors:  [100.6801684]
mat_Sqrt:  [[0.15]]
grads:  [-0.04597139]
Stock Position:  -0.04597139055984162
Bond Position:  [22.33286761]


portfolio before change:  [17.73447978]
curr_Stock_Price:  100.05752763212593
curr_Factors:  [100.05752763]
mat_Sqrt:  [[0.15]]
grads:  [0.05612132]
Stock Position:  0.05612132148100067
Bond Position:  [12.1191191]


portfolio before change:  [17.68315169]
curr_Stock_Price:  99.12943908122527
curr_Factors:  [99.12943908]
mat_Sqrt:  [[0.15]]
grads:  [0.07745036]
Stock Position:  0.07745035882840248
Bond Position:  [10.00554106]


portfolio before change:  [17.62028559]
curr_Stock_Price:  98.3096693418624
curr_Factors:  [98.30966934]
mat_Sqrt:  [[0.15]]
grads:  [-0.12706561]
Stock Position:  -0.12706561259758536
Bond Position:  [30.11206395]


portfolio before change:  [17.58432244]
curr_Stock_Price:  98.60750933262219
curr_Factors:  [98.60750933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01155507]
Stock Position:  -0.011555066976122678
Bond Position:  [18.72373881]


portfolio before change:  [17.58406882]
curr_Stock_Price:  98.73073527878728
curr_Factors:  [98.73073528]
mat_Sqrt:  [[0.15]]
grads:  [0.12316166]
Stock Position:  0.12316165756047315
Bond Position:  [5.42422781]


portfolio before change:  [17.52736719]
curr_Stock_Price:  98.26759880972139
curr_Factors:  [98.26759881]
mat_Sqrt:  [[0.15]]
grads:  [0.03642601]
Stock Position:  0.03642600587858318
Bond Position:  [13.94787106]


portfolio before change:  [17.51993195]
curr_Stock_Price:  98.0395470203291
curr_Factors:  [98.03954702]
mat_Sqrt:  [[0.15]]
grads:  [4.57590413e-05]
Stock Position:  4.575904132756807e-05
Bond Position:  [17.51544575]


portfolio before change:  [17.52102284]
curr_Stock_Price:  97.95526585561286
curr_Factors:  [97.95526586]
mat_Sqrt:  [[0.15]]
grads:  [-0.2302082]
Stock Position:  -0.2302081951513355
Bond Position:  [40.0711278]


portfolio before change:  [17.44705935]
curr_Stock_Price:  98.28743478508314
curr_Factors:  [98.28743479]
mat_Sqrt:  [[0.15]]
grads:  [-0.1163787]
Stock Position:  -0.11637870173167034
Bond Position:  [28.88562341]


portfolio before change:  [17.40240002]
curr_Stock_Price:  98.68668947250323
curr_Factors:  [98.68668947]
mat_Sqrt:  [[0.15]]
grads:  [0.04779679]
Stock Position:  0.04779679471811931
Bond Position:  [12.68549258]


portfolio before change:  [17.42012944]
curr_Stock_Price:  99.0410345350079
curr_Factors:  [99.04103454]
mat_Sqrt:  [[0.15]]
grads:  [0.0753092]
Stock Position:  0.07530920222101489
Bond Position:  [9.96142815]


portfolio before change:  [17.44083558]
curr_Stock_Price:  99.30771550895399
curr_Factors:  [99.30771551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0129568]
Stock Position:  -0.012956804023658697
Bond Position:  [18.72754619]


portfolio before change:  [17.44485544]
curr_Stock_Price:  99.08780442615301
curr_Factors:  [99.08780443]
mat_Sqrt:  [[0.15]]
grads:  [-0.00668725]
Stock Position:  -0.006687253134872954
Bond Position:  [18.10748067]


portfolio before change:  [17.44662864]
curr_Stock_Price:  98.99188351555189
curr_Factors:  [98.99188352]
mat_Sqrt:  [[0.15]]
grads:  [0.06504662]
Stock Position:  0.06504662046167091
Bond Position:  [11.00754116]


portfolio before change:  [17.41367938]
curr_Stock_Price:  98.47475820449738
curr_Factors:  [98.4747582]
mat_Sqrt:  [[0.15]]
grads:  [0.10153526]
Stock Position:  0.10153526315171159
Bond Position:  [7.41501889]


portfolio before change:  [17.37491942]
curr_Stock_Price:  98.08845491240851
curr_Factors:  [98.08845491]
mat_Sqrt:  [[0.15]]
grads:  [0.06886066]
Stock Position:  0.06886066408734025
Bond Position:  [10.62048328]


portfolio before change:  [17.40993164]
curr_Stock_Price:  98.58726526830175
curr_Factors:  [98.58726527]
mat_Sqrt:  [[0.15]]
grads:  [0.03396532]
Stock Position:  0.03396531825236168
Bond Position:  [14.0613838]


portfolio before change:  [17.43860516]
curr_Stock_Price:  99.40558999419025
curr_Factors:  [99.40558999]
mat_Sqrt:  [[0.15]]
grads:  [0.03518893]
Stock Position:  0.035188931409197634
Bond Position:  [13.94062867]


portfolio before change:  [17.45974228]
curr_Stock_Price:  99.98150409972354
curr_Factors:  [99.9815041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01410837]
Stock Position:  -0.014108368991422088
Bond Position:  [18.87031823]


portfolio before change:  [17.46651622]
curr_Stock_Price:  99.58496609984257
curr_Factors:  [99.5849661]
mat_Sqrt:  [[0.15]]
grads:  [-0.03110812]
Stock Position:  -0.031108121074546424
Bond Position:  [20.5644174]


portfolio before change:  [17.49511396]
curr_Stock_Price:  98.70698233106572
curr_Factors:  [98.70698233]
mat_Sqrt:  [[0.15]]
grads:  [0.00033118]
Stock Position:  0.0003311763353891611
Bond Position:  [17.46242454]


portfolio before change:  [17.49616732]
curr_Stock_Price:  98.59200886740294
curr_Factors:  [98.59200887]
mat_Sqrt:  [[0.15]]
grads:  [0.00881108]
Stock Position:  0.008811077720242168
Bond Position:  [16.62746546]


portfolio before change:  [17.50767433]
curr_Stock_Price:  99.78003243275393
curr_Factors:  [99.78003243]
mat_Sqrt:  [[0.15]]
grads:  [0.02380028]
Stock Position:  0.0238002795052115
Bond Position:  [15.13288167]


portfolio before change:  [17.50817473]
curr_Stock_Price:  99.76131699095075
curr_Factors:  [99.76131699]
mat_Sqrt:  [[0.15]]
grads:  [-0.03033306]
Stock Position:  -0.0303330618429881
Bond Position:  [20.53424093]


portfolio before change:  [17.49580199]
curr_Stock_Price:  100.2115244589818
curr_Factors:  [100.21152446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712535]
Stock Position:  -0.027125349382932526
Bond Position:  [20.21407461]


portfolio before change:  [17.51461866]
curr_Stock_Price:  99.56440864599936
curr_Factors:  [99.56440865]
mat_Sqrt:  [[0.15]]
grads:  [0.02414232]
Stock Position:  0.024142316137871548
Bond Position:  [15.11090323]


portfolio before change:  [17.49797098]
curr_Stock_Price:  98.83572409253358
curr_Factors:  [98.83572409]
mat_Sqrt:  [[0.15]]
grads:  [0.05994883]
Stock Position:  0.05994883360812643
Bond Position:  [11.57288461]


portfolio before change:  [17.49157939]
curr_Stock_Price:  98.71704077579967
curr_Factors:  [98.71704078]
mat_Sqrt:  [[0.15]]
grads:  [0.05002048]
Stock Position:  0.050020483204500504
Bond Position:  [12.55370531]


portfolio before change:  [17.46568778]
curr_Stock_Price:  98.18373458992394
curr_Factors:  [98.18373459]
mat_Sqrt:  [[0.15]]
grads:  [-0.0255364]
Stock Position:  -0.02553639532027147
Bond Position:  [19.97294644]


portfolio before change:  [17.46053622]
curr_Stock_Price:  98.43435388629075
curr_Factors:  [98.43435389]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981308]
Stock Position:  -0.019813075847169317
Bond Position:  [19.41082354]


portfolio before change:  [17.46186227]
curr_Stock_Price:  98.4286585395353
curr_Factors:  [98.42865854]
mat_Sqrt:  [[0.15]]
grads:  [0.00564833]
Stock Position:  0.005648332407749354
Bond Position:  [16.90590449]


portfolio before change:  [17.46128537]
curr_Stock_Price:  98.13944867936326
curr_Factors:  [98.13944868]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840885]
Stock Position:  -0.03840885006823173
Bond Position:  [21.23070874]


portfolio before change:  [17.43901212]
curr_Stock_Price:  98.75389610199575
curr_Factors:  [98.7538961]
mat_Sqrt:  [[0.15]]
grads:  [0.02056658]
Stock Position:  0.020566577149660474
Bond Position:  [15.40798249]


portfolio before change:  [17.43943042]
curr_Stock_Price:  98.72741007415078
curr_Factors:  [98.72741007]
mat_Sqrt:  [[0.15]]
grads:  [0.13348759]
Stock Position:  0.13348758728651944
Bond Position:  [4.26054665]


portfolio before change:  [17.45925955]
curr_Stock_Price:  98.87396182804575
curr_Factors:  [98.87396183]
mat_Sqrt:  [[0.15]]
grads:  [0.03347512]
Stock Position:  0.03347511791183017
Bond Position:  [14.14944202]


portfolio before change:  [17.45082191]
curr_Stock_Price:  98.59548597778966
curr_Factors:  [98.59548598]
mat_Sqrt:  [[0.15]]
grads:  [0.06807259]
Stock Position:  0.06807259123295603
Bond Position:  [10.73917169]


portfolio before change:  [17.50743034]
curr_Stock_Price:  99.41721486952383
curr_Factors:  [99.41721487]
mat_Sqrt:  [[0.15]]
grads:  [-0.00232694]
Stock Position:  -0.002326938350052229
Bond Position:  [17.73876807]


portfolio before change:  [17.50756351]
curr_Stock_Price:  99.83645278046978
curr_Factors:  [99.83645278]
mat_Sqrt:  [[0.15]]
grads:  [0.01946454]
Stock Position:  0.01946454110136497
Bond Position:  [15.56429277]


portfolio before change:  [17.50344701]
curr_Stock_Price:  99.5749878114083
curr_Factors:  [99.57498781]
mat_Sqrt:  [[0.15]]
grads:  [0.14395822]
Stock Position:  0.14395821646080384
Bond Position:  [3.16880936]


portfolio before change:  [17.52191257]
curr_Stock_Price:  99.70188228343726
curr_Factors:  [99.70188228]
mat_Sqrt:  [[0.15]]
grads:  [0.00958595]
Stock Position:  0.009585951697167652
Bond Position:  [16.56617514]


portfolio before change:  [17.52809752]
curr_Stock_Price:  100.2390780116604
curr_Factors:  [100.23907801]
mat_Sqrt:  [[0.15]]
grads:  [-0.10656439]
Stock Position:  -0.10656438664244525
Bond Position:  [28.21001339]


portfolio before change:  [17.47718377]
curr_Stock_Price:  100.73339820879127
curr_Factors:  [100.73339821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00510774]
Stock Position:  -0.005107744378985274
Bond Position:  [17.99170422]


portfolio before change:  [17.4772895]
curr_Stock_Price:  100.93285676598016
curr_Factors:  [100.93285677]
mat_Sqrt:  [[0.15]]
grads:  [0.00910884]
Stock Position:  0.009108835921343131
Bond Position:  [16.55790867]


portfolio before change:  [17.48040622]
curr_Stock_Price:  101.16140510424964
curr_Factors:  [101.1614051]
mat_Sqrt:  [[0.15]]
grads:  [0.00426287]
Stock Position:  0.004262870708655007
Bond Position:  [17.04916823]


portfolio before change:  [17.48118131]
curr_Stock_Price:  101.09325620156018
curr_Factors:  [101.0932562]
mat_Sqrt:  [[0.15]]
grads:  [-0.07722128]
Stock Position:  -0.07722127512528497
Bond Position:  [25.28773146]


portfolio before change:  [17.47493615]
curr_Stock_Price:  101.19459739519424
curr_Factors:  [101.1945974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0289738]
Stock Position:  -0.028973801803875942
Bond Position:  [20.40692836]


portfolio before change:  [17.45624748]
curr_Stock_Price:  101.88363867765236
curr_Factors:  [101.88363868]
mat_Sqrt:  [[0.15]]
grads:  [0.10572207]
Stock Position:  0.10572207450763887
Bond Position:  [6.68489784]


portfolio before change:  [17.44677874]
curr_Stock_Price:  101.79012407888784
curr_Factors:  [101.79012408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04922275]
Stock Position:  -0.04922275417998816
Bond Position:  [22.45716899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.41522515]
Stock Price:  102.45967631553359
PL:  [14.95554883]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.13120730e-02]
 [-2.70396419e-03]
 [ 3.74744895e-02]
 [-5.98872168e-03]
 [-1.99476332e-02]
 [-2.09403422e-03]
 [-1.01650262e-02]
 [-2.67858995e-02]
 [ 1.67942626e-02]
 [-7.27756476e-03]
 [-1.09282863e-02]
 [ 2.00259078e-02]
 [-4.76552960e-03]
 [ 6.43930323e-03]
 [ 1.72322299e-02]
 [ 8.66339611e-03]
 [ 9.57571970e-02]
 [-9.48938385e-03]
 [ 2.50914262e-02]
 [-4.73974908e-04]
 [-8.26071923e-03]
 [ 6.51456696e-03]
 [ 8.94711063e-04]
 [ 3.20941913e-02]
 [-1.50118671e-03]
 [ 7.57320996e-03]
 [-1.49582081e-03]
 [ 1.32059217e-02]
 [ 2.20717782e-02]
 [-7.65597273e-03]
 [ 1.82239124e-03]
 [ 1.48026559e-02]
 [ 1.47732484e-02]
 [-5.96155171e-03]
 [ 4.86682944e-03]
 [ 1.20616290e-02]
 [-2.62523365e-02]
 [ 3.22131721e-03]
 [-5.69574095e-02]
 [ 3.62786200e-03]
 [ 7.20287752e-03]
 [ 2.52656398e-02]
 [-3.07944659e-03]
 [ 4.15089290e-03]
 [-1.54190851e-02]
 [ 1.80943887e-02]
 [ 9.78830476e-03]
 [ 5.28358732e-03]
 [-6.86469481e-05]
 [-1.19428510e-03]
 [-5.60593228e-03]
 [ 1.30838470e-03]
 [ 4.52459229e-05]
 [ 7.97803666e-03]
 [-1.17309444e-02]
 [-5.00534932e-03]
 [-5.63251931e-03]
 [ 1.45643410e-02]
 [ 5.46598159e-03]
 [-2.12118059e-03]
 [-5.15512138e-03]
 [-2.84728481e-03]
 [-1.75704719e-03]
 [-4.04486504e-03]
 [ 1.79197655e-02]
 [ 6.87720554e-03]
 [ 2.03001308e-02]
 [-4.30084075e-03]
 [ 8.34946313e-03]
 [ 2.91817370e-02]
 [ 3.06998416e-03]
 [-1.52489146e-02]
 [-5.76849882e-03]
 [ 2.29847566e-03]
 [ 1.00572399e-02]
 [ 1.20200584e-03]
 [-1.61198449e-03]
 [-7.54173511e-03]
 [-2.29925042e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.55313129]
curr_Stock_Price:  100.02376356924154
curr_Factors:  [100.02376357]
mat_Sqrt:  [[0.15]]
grads:  [-0.07541382]
Stock Position:  -0.07541381976686523
Bond Position:  [10.09630537]


portfolio before change:  [2.59240276]
curr_Stock_Price:  99.51138487131063
curr_Factors:  [99.51138487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01802643]
Stock Position:  -0.018026427947824327
Bond Position:  [4.38623757]


portfolio before change:  [2.60484807]
curr_Stock_Price:  98.83620078537986
curr_Factors:  [98.83620079]
mat_Sqrt:  [[0.15]]
grads:  [0.24982993]
Stock Position:  0.24982993021880684
Bond Position:  [-22.08739308]


portfolio before change:  [2.9325837]
curr_Stock_Price:  100.15356149603089
curr_Factors:  [100.1535615]
mat_Sqrt:  [[0.15]]
grads:  [-0.03992481]
Stock Position:  -0.039924811176641754
Bond Position:  [6.93119573]


portfolio before change:  [2.89852217]
curr_Stock_Price:  101.01755420580878
curr_Factors:  [101.01755421]
mat_Sqrt:  [[0.15]]
grads:  [-0.13298422]
Stock Position:  -0.13298422158144244
Bond Position:  [16.33226298]


portfolio before change:  [2.9643802]
curr_Stock_Price:  100.52999835727717
curr_Factors:  [100.52999836]
mat_Sqrt:  [[0.15]]
grads:  [-0.01396023]
Stock Position:  -0.013960228129440899
Bond Position:  [4.36780191]


portfolio before change:  [2.95896337]
curr_Stock_Price:  100.93757248677473
curr_Factors:  [100.93757249]
mat_Sqrt:  [[0.15]]
grads:  [-0.06776684]
Stock Position:  -0.06776684101428551
Bond Position:  [9.79918379]


portfolio before change:  [2.96140535]
curr_Stock_Price:  100.9105753027936
curr_Factors:  [100.9105753]
mat_Sqrt:  [[0.15]]
grads:  [-0.17857266]
Stock Position:  -0.178572663449416
Bond Position:  [20.98127555]


portfolio before change:  [2.75847686]
curr_Stock_Price:  102.05431060525082
curr_Factors:  [102.05431061]
mat_Sqrt:  [[0.15]]
grads:  [0.11196175]
Stock Position:  0.11196175038426136
Bond Position:  [-8.66770239]


portfolio before change:  [2.80383789]
curr_Stock_Price:  102.46429687454635
curr_Factors:  [102.46429687]
mat_Sqrt:  [[0.15]]
grads:  [-0.0485171]
Stock Position:  -0.04851709840575501
Bond Position:  [7.77510827]


portfolio before change:  [2.80581226]
curr_Stock_Price:  102.43361890372114
curr_Factors:  [102.4336189]
mat_Sqrt:  [[0.15]]
grads:  [-0.07285524]
Stock Position:  -0.07285524191117228
Bond Position:  [10.26863834]


portfolio before change:  [2.77616661]
curr_Stock_Price:  102.84933989679872
curr_Factors:  [102.8493399]
mat_Sqrt:  [[0.15]]
grads:  [0.13350605]
Stock Position:  0.13350605219983255
Bond Position:  [-10.95484273]


portfolio before change:  [2.78757796]
curr_Stock_Price:  102.93994284035536
curr_Factors:  [102.93994284]
mat_Sqrt:  [[0.15]]
grads:  [-0.0317702]
Stock Position:  -0.031770197305435594
Bond Position:  [6.05800025]


portfolio before change:  [2.76667026]
curr_Stock_Price:  103.60995242672382
curr_Factors:  [103.60995243]
mat_Sqrt:  [[0.15]]
grads:  [0.04292869]
Stock Position:  0.042928688199899576
Bond Position:  [-1.68116909]


portfolio before change:  [2.78335042]
curr_Stock_Price:  104.00095524810995
curr_Factors:  [104.00095525]
mat_Sqrt:  [[0.15]]
grads:  [0.11488153]
Stock Position:  0.11488153255669173
Bond Position:  [-9.16443871]


portfolio before change:  [2.74047935]
curr_Stock_Price:  103.63276485777844
curr_Factors:  [103.63276486]
mat_Sqrt:  [[0.15]]
grads:  [0.05775597]
Stock Position:  0.05775597408072449
Bond Position:  [-3.24493193]


portfolio before change:  [2.76070185]
curr_Stock_Price:  103.98641343055958
curr_Factors:  [103.98641343]
mat_Sqrt:  [[0.15]]
grads:  [0.63838131]
Stock Position:  0.6383813130249791
Bond Position:  [-63.62228129]


portfolio before change:  [2.42052092]
curr_Stock_Price:  103.45976203034243
curr_Factors:  [103.45976203]
mat_Sqrt:  [[0.15]]
grads:  [-0.06326256]
Stock Position:  -0.06326255900677465
Bond Position:  [8.96565022]


portfolio before change:  [2.39039954]
curr_Stock_Price:  103.94475276893267
curr_Factors:  [103.94475277]
mat_Sqrt:  [[0.15]]
grads:  [0.16727617]
Stock Position:  0.1672761743712672
Bond Position:  [-14.99708105]


portfolio before change:  [2.38938881]
curr_Stock_Price:  103.94431409321346
curr_Factors:  [103.94431409]
mat_Sqrt:  [[0.15]]
grads:  [-0.00315983]
Stock Position:  -0.0031598327181696284
Bond Position:  [2.71783545]


portfolio before change:  [2.38860202]
curr_Stock_Price:  104.24707086961317
curr_Factors:  [104.24707087]
mat_Sqrt:  [[0.15]]
grads:  [-0.05507146]
Stock Position:  -0.05507146156576679
Bond Position:  [8.12964058]


portfolio before change:  [2.42305923]
curr_Stock_Price:  103.63061555062016
curr_Factors:  [103.63061555]
mat_Sqrt:  [[0.15]]
grads:  [0.04343045]
Stock Position:  0.04343044642216235
Bond Position:  [-2.07766466]


portfolio before change:  [2.42726948]
curr_Stock_Price:  103.7305478543908
curr_Factors:  [103.73054785]
mat_Sqrt:  [[0.15]]
grads:  [0.00596474]
Stock Position:  0.0059647404210448965
Bond Position:  [1.80854369]


portfolio before change:  [2.41886493]
curr_Stock_Price:  102.30255789813678
curr_Factors:  [102.3025579]
mat_Sqrt:  [[0.15]]
grads:  [0.21396128]
Stock Position:  0.21396127536417597
Bond Position:  [-19.46992083]


portfolio before change:  [2.23827211]
curr_Stock_Price:  101.46420101254422
curr_Factors:  [101.46420101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01000791]
Stock Position:  -0.010007911388960587
Bond Position:  [3.25371684]


portfolio before change:  [2.23647493]
curr_Stock_Price:  101.66409722431938
curr_Factors:  [101.66409722]
mat_Sqrt:  [[0.15]]
grads:  [0.05048807]
Stock Position:  0.050488066397711986
Bond Position:  [-2.89634876]


portfolio before change:  [2.2407125]
curr_Stock_Price:  101.75161479325574
curr_Factors:  [101.75161479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00997214]
Stock Position:  -0.009972138711661823
Bond Position:  [3.25539371]


portfolio before change:  [2.24157772]
curr_Stock_Price:  101.68525483030275
curr_Factors:  [101.68525483]
mat_Sqrt:  [[0.15]]
grads:  [0.08803948]
Stock Position:  0.08803947829512367
Bond Position:  [-6.71073907]


portfolio before change:  [2.32412992]
curr_Stock_Price:  102.62769158646086
curr_Factors:  [102.62769159]
mat_Sqrt:  [[0.15]]
grads:  [0.14714519]
Stock Position:  0.1471451880871445
Bond Position:  [-12.77704106]


portfolio before change:  [2.38527242]
curr_Stock_Price:  103.0486437993686
curr_Factors:  [103.0486438]
mat_Sqrt:  [[0.15]]
grads:  [-0.05103982]
Stock Position:  -0.05103981820851938
Bond Position:  [7.64485647]


portfolio before change:  [2.36490102]
curr_Stock_Price:  103.45713306397515
curr_Factors:  [103.45713306]
mat_Sqrt:  [[0.15]]
grads:  [0.01214927]
Stock Position:  0.01214927495184368
Bond Position:  [1.10797187]


portfolio before change:  [2.36855756]
curr_Stock_Price:  103.75240012973589
curr_Factors:  [103.75240013]
mat_Sqrt:  [[0.15]]
grads:  [0.09868437]
Stock Position:  0.09868437240675705
Bond Position:  [-7.87018294]


portfolio before change:  [2.36199256]
curr_Stock_Price:  103.69085955035158
curr_Factors:  [103.69085955]
mat_Sqrt:  [[0.15]]
grads:  [0.09848832]
Stock Position:  0.0984883224184457
Bond Position:  [-7.85034625]


portfolio before change:  [2.36537969]
curr_Stock_Price:  103.7302326288595
curr_Factors:  [103.73023263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03974368]
Stock Position:  -0.03974367809502834
Bond Position:  [6.48800066]


portfolio before change:  [2.39531819]
curr_Stock_Price:  102.98714612262437
curr_Factors:  [102.98714612]
mat_Sqrt:  [[0.15]]
grads:  [0.03244553]
Stock Position:  0.03244552958868833
Bond Position:  [-0.94615431]


portfolio before change:  [2.37326653]
curr_Stock_Price:  102.30931696698593
curr_Factors:  [102.30931697]
mat_Sqrt:  [[0.15]]
grads:  [0.08041086]
Stock Position:  0.08041086019359402
Bond Position:  [-5.85351366]


portfolio before change:  [2.33862625]
curr_Stock_Price:  101.88307572909571
curr_Factors:  [101.88307573]
mat_Sqrt:  [[0.15]]
grads:  [-0.17501558]
Stock Position:  -0.17501557648920096
Bond Position:  [20.16975148]


portfolio before change:  [2.49828326]
curr_Stock_Price:  100.97803422092515
curr_Factors:  [100.97803422]
mat_Sqrt:  [[0.15]]
grads:  [0.02147545]
Stock Position:  0.0214754480602748
Bond Position:  [0.32973473]


portfolio before change:  [2.47930746]
curr_Stock_Price:  100.09347029512209
curr_Factors:  [100.0934703]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971606]
Stock Position:  -0.37971606322721035
Bond Position:  [40.48640596]


portfolio before change:  [2.47069347]
curr_Stock_Price:  100.12281977869719
curr_Factors:  [100.12281978]
mat_Sqrt:  [[0.15]]
grads:  [0.02418575]
Stock Position:  0.024185746662114885
Bond Position:  [0.04914831]


portfolio before change:  [2.45424701]
curr_Stock_Price:  99.442686663391
curr_Factors:  [99.44268666]
mat_Sqrt:  [[0.15]]
grads:  [0.04801918]
Stock Position:  0.048019183480095394
Bond Position:  [-2.3209096]


portfolio before change:  [2.39643516]
curr_Stock_Price:  98.2417751006178
curr_Factors:  [98.2417751]
mat_Sqrt:  [[0.15]]
grads:  [0.1684376]
Stock Position:  0.1684375984019131
Bond Position:  [-14.1511735]


portfolio before change:  [2.28897465]
curr_Stock_Price:  97.60904206078523
curr_Factors:  [97.60904206]
mat_Sqrt:  [[0.15]]
grads:  [-0.02052964]
Stock Position:  -0.020529643932274674
Bond Position:  [4.29285353]


portfolio before change:  [2.29351911]
curr_Stock_Price:  97.40075066334684
curr_Factors:  [97.40075066]
mat_Sqrt:  [[0.15]]
grads:  [0.02767262]
Stock Position:  0.027672619345759052
Bond Position:  [-0.40181479]


portfolio before change:  [2.2959183]
curr_Stock_Price:  97.48835724111852
curr_Factors:  [97.48835724]
mat_Sqrt:  [[0.15]]
grads:  [-0.1027939]
Stock Position:  -0.1027939006745212
Bond Position:  [12.31712681]


portfolio before change:  [2.3144863]
curr_Stock_Price:  97.31521311045397
curr_Factors:  [97.31521311]
mat_Sqrt:  [[0.15]]
grads:  [0.12062926]
Stock Position:  0.12062925794658184
Bond Position:  [-9.42457564]


portfolio before change:  [2.26235599]
curr_Stock_Price:  96.88794309616894
curr_Factors:  [96.8879431]
mat_Sqrt:  [[0.15]]
grads:  [0.06525537]
Stock Position:  0.06525536508879416
Bond Position:  [-4.06010211]


portfolio before change:  [2.31197374]
curr_Stock_Price:  97.65219473577746
curr_Factors:  [97.65219474]
mat_Sqrt:  [[0.15]]
grads:  [0.03522392]
Stock Position:  0.03522391544243148
Bond Position:  [-1.12771891]


portfolio before change:  [2.34666358]
curr_Stock_Price:  98.63903350336734
curr_Factors:  [98.6390335]
mat_Sqrt:  [[0.15]]
grads:  [-0.00045765]
Stock Position:  -0.0004576463204704224
Bond Position:  [2.39180537]


portfolio before change:  [2.34696459]
curr_Stock_Price:  98.30795580679701
curr_Factors:  [98.30795581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0079619]
Stock Position:  -0.00796190065509616
Bond Position:  [3.12968277]


portfolio before change:  [2.35018451]
curr_Stock_Price:  97.92810843428629
curr_Factors:  [97.92810843]
mat_Sqrt:  [[0.15]]
grads:  [-0.03737288]
Stock Position:  -0.03737288186239009
Bond Position:  [6.01004014]


portfolio before change:  [2.36748479]
curr_Stock_Price:  97.47524956629316
curr_Factors:  [97.47524957]
mat_Sqrt:  [[0.15]]
grads:  [0.00872256]
Stock Position:  0.008722564694083277
Bond Position:  [1.51725062]


portfolio before change:  [2.35673789]
curr_Stock_Price:  96.232297987276
curr_Factors:  [96.23229799]
mat_Sqrt:  [[0.15]]
grads:  [0.00030164]
Stock Position:  0.000301639486332438
Bond Position:  [2.32771043]


portfolio before change:  [2.35683143]
curr_Stock_Price:  96.06006641945874
curr_Factors:  [96.06006642]
mat_Sqrt:  [[0.15]]
grads:  [0.05318691]
Stock Position:  0.0531869110365318
Bond Position:  [-2.75230678]


portfolio before change:  [2.35376071]
curr_Stock_Price:  96.0055662534533
curr_Factors:  [96.00556625]
mat_Sqrt:  [[0.15]]
grads:  [-0.0782063]
Stock Position:  -0.07820629569905832
Bond Position:  [9.86200041]


portfolio before change:  [2.35040494]
curr_Stock_Price:  96.05635710075934
curr_Factors:  [96.0563571]
mat_Sqrt:  [[0.15]]
grads:  [-0.033369]
Stock Position:  -0.03336899549702359
Bond Position:  [5.55570909]


portfolio before change:  [2.41893099]
curr_Stock_Price:  94.01317872435239
curr_Factors:  [94.01317872]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755013]
Stock Position:  -0.0375501287065166
Bond Position:  [5.94913795]


portfolio before change:  [2.43992245]
curr_Stock_Price:  93.46405598373238
curr_Factors:  [93.46405598]
mat_Sqrt:  [[0.15]]
grads:  [0.09709561]
Stock Position:  0.09709560680420799
Bond Position:  [-6.63502678]


portfolio before change:  [2.43800065]
curr_Stock_Price:  93.44853415138164
curr_Factors:  [93.44853415]
mat_Sqrt:  [[0.15]]
grads:  [0.03643988]
Stock Position:  0.03643987724535363
Bond Position:  [-0.96725246]


portfolio before change:  [2.43113193]
curr_Stock_Price:  93.26169849071232
curr_Factors:  [93.26169849]
mat_Sqrt:  [[0.15]]
grads:  [-0.0141412]
Stock Position:  -0.014141203964841921
Bond Position:  [3.74996463]


portfolio before change:  [2.4228479]
curr_Stock_Price:  93.8640802566897
curr_Factors:  [93.86408026]
mat_Sqrt:  [[0.15]]
grads:  [-0.03436748]
Stock Position:  -0.034367475852936515
Bond Position:  [5.64871942]


portfolio before change:  [2.38367078]
curr_Stock_Price:  95.01430097184495
curr_Factors:  [95.01430097]
mat_Sqrt:  [[0.15]]
grads:  [-0.0189819]
Stock Position:  -0.018981898739511862
Bond Position:  [4.18722262]


portfolio before change:  [2.37132847]
curr_Stock_Price:  95.6783027144774
curr_Factors:  [95.67830271]
mat_Sqrt:  [[0.15]]
grads:  [-0.01171365]
Stock Position:  -0.011713647933753343
Bond Position:  [3.49207043]


portfolio before change:  [2.37238771]
curr_Stock_Price:  95.60650811959592
curr_Factors:  [95.60650812]
mat_Sqrt:  [[0.15]]
grads:  [-0.02696577]
Stock Position:  -0.02696576694837912
Bond Position:  [4.95049053]


portfolio before change:  [2.39196029]
curr_Stock_Price:  94.89215191522048
curr_Factors:  [94.89215192]
mat_Sqrt:  [[0.15]]
grads:  [0.1194651]
Stock Position:  0.11946510332835551
Bond Position:  [-8.94434045]


portfolio before change:  [2.40642836]
curr_Stock_Price:  95.01793852911472
curr_Factors:  [95.01793853]
mat_Sqrt:  [[0.15]]
grads:  [0.04584804]
Stock Position:  0.04584803696282164
Bond Position:  [-1.9499576]


portfolio before change:  [2.41447772]
curr_Stock_Price:  95.19616274751746
curr_Factors:  [95.19616275]
mat_Sqrt:  [[0.15]]
grads:  [0.13533421]
Stock Position:  0.1353342051403983
Bond Position:  [-10.4688193]


portfolio before change:  [2.34615126]
curr_Stock_Price:  94.69612557106623
curr_Factors:  [94.69612557]
mat_Sqrt:  [[0.15]]
grads:  [-0.02867227]
Stock Position:  -0.02867227166944681
Bond Position:  [5.0613043]


portfolio before change:  [2.36122902]
curr_Stock_Price:  94.18129287267311
curr_Factors:  [94.18129287]
mat_Sqrt:  [[0.15]]
grads:  [0.05566309]
Stock Position:  0.05566308752267431
Bond Position:  [-2.88119252]


portfolio before change:  [2.34752806]
curr_Stock_Price:  93.93838712410846
curr_Factors:  [93.93838712]
mat_Sqrt:  [[0.15]]
grads:  [0.19454491]
Stock Position:  0.19454491348264563
Bond Position:  [-15.92770734]


portfolio before change:  [2.42627296]
curr_Stock_Price:  94.34826886792054
curr_Factors:  [94.34826887]
mat_Sqrt:  [[0.15]]
grads:  [0.02046656]
Stock Position:  0.02046656103870871
Bond Position:  [0.49528835]


portfolio before change:  [2.44296451]
curr_Stock_Price:  95.16230900124873
curr_Factors:  [95.162309]
mat_Sqrt:  [[0.15]]
grads:  [-0.10165943]
Stock Position:  -0.10165943065586419
Bond Position:  [12.11711067]


portfolio before change:  [2.44170184]
curr_Stock_Price:  95.18217938859398
curr_Factors:  [95.18217939]
mat_Sqrt:  [[0.15]]
grads:  [-0.03845666]
Stock Position:  -0.038456658767000995
Bond Position:  [6.10209044]


portfolio before change:  [2.42036086]
curr_Stock_Price:  95.74703288756962
curr_Factors:  [95.74703289]
mat_Sqrt:  [[0.15]]
grads:  [0.01532317]
Stock Position:  0.015323171079066167
Bond Position:  [0.95321269]


portfolio before change:  [2.43206735]
curr_Stock_Price:  96.50711777007868
curr_Factors:  [96.50711777]
mat_Sqrt:  [[0.15]]
grads:  [0.06704827]
Stock Position:  0.06704826577726894
Bond Position:  [-4.03856753]


portfolio before change:  [2.48879426]
curr_Stock_Price:  97.3569433868476
curr_Factors:  [97.35694339]
mat_Sqrt:  [[0.15]]
grads:  [0.00801337]
Stock Position:  0.008013372274198311
Bond Position:  [1.70863683]


portfolio before change:  [2.48734658]
curr_Stock_Price:  97.16295861586204
curr_Factors:  [97.16295862]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074656]
Stock Position:  -0.010746563248590045
Bond Position:  [3.53151446]


portfolio before change:  [2.48661854]
curr_Stock_Price:  97.25124455046166
curr_Factors:  [97.25124455]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027823]
Stock Position:  -0.050278234057234326
Bond Position:  [7.37623938]


portfolio before change:  [2.47782463]
curr_Stock_Price:  97.4353190594663
curr_Factors:  [97.43531906]
mat_Sqrt:  [[0.15]]
grads:  [-0.15328336]
Stock Position:  -0.15328336166173653
Bond Position:  [17.41303788]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.62327361]
Stock Price:  96.4935297593634
PL:  [2.62327361]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.29962338e-03]
 [ 6.85737237e-03]
 [ 3.88129595e-03]
 [-8.92914261e-03]
 [ 1.39431558e-02]
 [-1.05796977e-02]
 [ 2.48924100e-03]
 [ 6.50004317e-03]
 [-1.62435197e-02]
 [-1.28475420e-02]
 [ 9.97779635e-03]
 [-7.29924958e-03]
 [ 2.08404006e-03]
 [-6.01391909e-03]
 [ 6.65607738e-03]
 [-1.41723575e-03]
 [-5.78450828e-02]
 [-8.58506955e-03]
 [ 2.14619177e-02]
 [-7.60902281e-03]
 [-3.45148944e-02]
 [ 6.59670696e-03]
 [ 1.62838980e-02]
 [ 2.69860467e-03]
 [ 1.56143236e-02]
 [ 4.39778216e-03]
 [ 1.91971540e-04]
 [ 1.45277150e-02]
 [-4.72548013e-03]
 [ 5.89455340e-02]
 [-5.76593749e-03]
 [ 3.60001468e-02]
 [ 1.49497591e-02]
 [-1.87880433e-02]
 [-2.35709444e-02]
 [-9.53623931e-02]
 [ 1.67515971e-02]
 [-6.39720295e-03]
 [ 4.91113001e-02]
 [ 2.06605378e-02]
 [ 6.56299866e-03]
 [ 3.54575301e-02]
 [-3.37346083e-03]
 [ 1.97242774e-02]
 [-3.99424805e-02]
 [ 1.97255971e-02]
 [ 9.73717665e-03]
 [ 5.31081955e-03]
 [-7.94894420e-03]
 [-4.28463417e-04]
 [-4.67691163e-03]
 [ 1.77040506e-03]
 [ 9.11332461e-04]
 [ 7.85080181e-03]
 [-8.78078531e-03]
 [-4.68680326e-03]
 [-4.99441279e-04]
 [ 1.16695459e-02]
 [ 8.08497099e-03]
 [-3.55667967e-03]
 [-4.50218467e-03]
 [-1.21208407e-04]
 [-6.05968377e-03]
 [ 1.99648574e-03]
 [ 1.99511636e-02]
 [ 5.39162948e-03]
 [ 9.09366291e-03]
 [-4.88329665e-04]
 [ 2.81985931e-03]
 [ 2.18990671e-02]
 [ 1.54570241e-03]
 [-1.59663278e-02]
 [-7.07435817e-04]
 [ 1.26698098e-03]
 [-2.58578543e-04]
 [-3.62830169e-03]
 [-4.19590971e-03]
 [ 1.62421453e-02]
 [-1.65339423e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.62720122]
curr_Stock_Price:  100.254217427059
curr_Factors:  [100.25421743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02199749]
Stock Position:  -0.021997489221369706
Bond Position:  [9.83254228]


portfolio before change:  [7.6373552]
curr_Stock_Price:  99.82055758853467
curr_Factors:  [99.82055759]
mat_Sqrt:  [[0.15]]
grads:  [0.04571582]
Stock Position:  0.045715815810669407
Bond Position:  [3.07397697]


portfolio before change:  [7.63827216]
curr_Stock_Price:  99.83641287517176
curr_Factors:  [99.83641288]
mat_Sqrt:  [[0.15]]
grads:  [0.02587531]
Stock Position:  0.025875306353313268
Bond Position:  [5.05497439]


portfolio before change:  [7.63597749]
curr_Stock_Price:  99.7355207323018
curr_Factors:  [99.73552073]
mat_Sqrt:  [[0.15]]
grads:  [-0.05952762]
Stock Position:  -0.059527617428245555
Bond Position:  [13.57299542]


portfolio before change:  [7.63753054]
curr_Stock_Price:  99.72368246834732
curr_Factors:  [99.72368247]
mat_Sqrt:  [[0.15]]
grads:  [0.09295437]
Stock Position:  0.09295437170344174
Bond Position:  [-1.63222171]


portfolio before change:  [7.62368036]
curr_Stock_Price:  99.5757802339215
curr_Factors:  [99.57578023]
mat_Sqrt:  [[0.15]]
grads:  [-0.07053132]
Stock Position:  -0.07053131823728231
Bond Position:  [14.6468914]


portfolio before change:  [7.59276916]
curr_Stock_Price:  100.02702180157186
curr_Factors:  [100.0270218]
mat_Sqrt:  [[0.15]]
grads:  [0.01659494]
Stock Position:  0.01659494000851429
Bond Position:  [5.93282673]


portfolio before change:  [7.57908399]
curr_Stock_Price:  99.18001762516842
curr_Factors:  [99.18001763]
mat_Sqrt:  [[0.15]]
grads:  [0.04333362]
Stock Position:  0.04333362115084223
Bond Position:  [3.28125468]


portfolio before change:  [7.57188189]
curr_Stock_Price:  99.00908377480071
curr_Factors:  [99.00908377]
mat_Sqrt:  [[0.15]]
grads:  [-0.10829013]
Stock Position:  -0.10829013103440736
Bond Position:  [18.29358854]


portfolio before change:  [7.63327956]
curr_Stock_Price:  98.45266842887456
curr_Factors:  [98.45266843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565028]
Stock Position:  -0.0856502801575508
Bond Position:  [16.0657782]


portfolio before change:  [7.64870766]
curr_Stock_Price:  98.2842632619663
curr_Factors:  [98.28426326]
mat_Sqrt:  [[0.15]]
grads:  [0.06651864]
Stock Position:  0.06651864232584867
Bond Position:  [1.1109719]


portfolio before change:  [7.60171411]
curr_Stock_Price:  97.5767475139795
curr_Factors:  [97.57674751]
mat_Sqrt:  [[0.15]]
grads:  [-0.04866166]
Stock Position:  -0.04866166389661211
Bond Position:  [12.349961]


portfolio before change:  [7.63927936]
curr_Stock_Price:  96.82064193014743
curr_Factors:  [96.82064193]
mat_Sqrt:  [[0.15]]
grads:  [0.0138936]
Stock Position:  0.013893600409214767
Bond Position:  [6.29409205]


portfolio before change:  [7.64679791]
curr_Stock_Price:  97.33347930750823
curr_Factors:  [97.33347931]
mat_Sqrt:  [[0.15]]
grads:  [-0.04009279]
Stock Position:  -0.04009279390014603
Bond Position:  [11.54916904]


portfolio before change:  [7.67189477]
curr_Stock_Price:  96.72551446174029
curr_Factors:  [96.72551446]
mat_Sqrt:  [[0.15]]
grads:  [0.04437385]
Stock Position:  0.04437384921836867
Bond Position:  [3.37981137]


portfolio before change:  [7.63206515]
curr_Stock_Price:  95.82316192309742
curr_Factors:  [95.82316192]
mat_Sqrt:  [[0.15]]
grads:  [-0.00944824]
Stock Position:  -0.009448238317349134
Bond Position:  [8.53742522]


portfolio before change:  [7.63696164]
curr_Stock_Price:  95.36139559298884
curr_Factors:  [95.36139559]
mat_Sqrt:  [[0.15]]
grads:  [-0.38563389]
Stock Position:  -0.3856338852683843
Bond Position:  [44.41154713]


portfolio before change:  [7.50047699]
curr_Stock_Price:  95.72251648604087
curr_Factors:  [95.72251649]
mat_Sqrt:  [[0.15]]
grads:  [-0.0572338]
Stock Position:  -0.05723379697071293
Bond Position:  [12.97904007]


portfolio before change:  [7.55247573]
curr_Stock_Price:  94.82815819293016
curr_Factors:  [94.82815819]
mat_Sqrt:  [[0.15]]
grads:  [0.14307945]
Stock Position:  0.1430794514450461
Bond Position:  [-6.01548513]


portfolio before change:  [7.48068103]
curr_Stock_Price:  94.32900390950581
curr_Factors:  [94.32900391]
mat_Sqrt:  [[0.15]]
grads:  [-0.05072682]
Stock Position:  -0.05072681871009939
Bond Position:  [12.26569131]


portfolio before change:  [7.44974886]
curr_Stock_Price:  94.95389626747013
curr_Factors:  [94.95389627]
mat_Sqrt:  [[0.15]]
grads:  [-0.2300993]
Stock Position:  -0.230099296147079
Bond Position:  [29.29857356]


portfolio before change:  [7.60799109]
curr_Stock_Price:  94.27414183927466
curr_Factors:  [94.27414184]
mat_Sqrt:  [[0.15]]
grads:  [0.04397805]
Stock Position:  0.04397804641703008
Bond Position:  [3.46199851]


portfolio before change:  [7.64471284]
curr_Stock_Price:  95.10422333287887
curr_Factors:  [95.10422333]
mat_Sqrt:  [[0.15]]
grads:  [0.10855932]
Stock Position:  0.10855932026586024
Bond Position:  [-2.679737]


portfolio before change:  [7.60901335]
curr_Stock_Price:  94.77691846296763
curr_Factors:  [94.77691846]
mat_Sqrt:  [[0.15]]
grads:  [0.0179907]
Stock Position:  0.01799069782469113
Bond Position:  [5.90391045]


portfolio before change:  [7.62033739]
curr_Stock_Price:  95.38584610066363
curr_Factors:  [95.3858461]
mat_Sqrt:  [[0.15]]
grads:  [0.10409549]
Stock Position:  0.10409549058910911
Bond Position:  [-2.30889905]


portfolio before change:  [7.61494847]
curr_Stock_Price:  95.33546339483343
curr_Factors:  [95.33546339]
mat_Sqrt:  [[0.15]]
grads:  [0.02931855]
Stock Position:  0.02931854773877319
Bond Position:  [4.81985113]


portfolio before change:  [7.63016456]
curr_Stock_Price:  95.84418043077696
curr_Factors:  [95.84418043]
mat_Sqrt:  [[0.15]]
grads:  [0.00127981]
Stock Position:  0.001279810268999202
Bond Position:  [7.5075022]


portfolio before change:  [7.63133336]
curr_Stock_Price:  96.39079179384339
curr_Factors:  [96.39079179]
mat_Sqrt:  [[0.15]]
grads:  [0.09685143]
Stock Position:  0.09685143306147086
Bond Position:  [-1.70425296]


portfolio before change:  [7.64287844]
curr_Stock_Price:  96.51109566647952
curr_Factors:  [96.51109567]
mat_Sqrt:  [[0.15]]
grads:  [-0.0315032]
Stock Position:  -0.03150320086338044
Bond Position:  [10.68328687]


portfolio before change:  [7.65943803]
curr_Stock_Price:  96.00664330477089
curr_Factors:  [96.0066433]
mat_Sqrt:  [[0.15]]
grads:  [0.39297023]
Stock Position:  0.3929702264327893
Bond Position:  [-30.06831433]


portfolio before change:  [7.00592059]
curr_Stock_Price:  94.34840543940679
curr_Factors:  [94.34840544]
mat_Sqrt:  [[0.15]]
grads:  [-0.03843958]
Stock Position:  -0.03843958325315126
Bond Position:  [10.63263398]


portfolio before change:  [7.0384157]
curr_Stock_Price:  93.52033840000001
curr_Factors:  [93.5203384]
mat_Sqrt:  [[0.15]]
grads:  [0.24000098]
Stock Position:  0.24000097879766644
Bond Position:  [-15.40655705]


portfolio before change:  [7.03260162]
curr_Stock_Price:  93.50012538090515
curr_Factors:  [93.50012538]
mat_Sqrt:  [[0.15]]
grads:  [0.09966506]
Stock Position:  0.0996650608286064
Bond Position:  [-2.28609406]


portfolio before change:  [7.0158874]
curr_Stock_Price:  93.33385510782173
curr_Factors:  [93.33385511]
mat_Sqrt:  [[0.15]]
grads:  [-0.12525362]
Stock Position:  -0.125253621881988
Bond Position:  [18.70629079]


portfolio before change:  [7.02273972]
curr_Stock_Price:  93.2884820297822
curr_Factors:  [93.28848203]
mat_Sqrt:  [[0.15]]
grads:  [-0.15713963]
Stock Position:  -0.1571396290383718
Bond Position:  [21.68205718]


portfolio before change:  [6.97724415]
curr_Stock_Price:  93.58662921289357
curr_Factors:  [93.58662921]
mat_Sqrt:  [[0.15]]
grads:  [-0.63574929]
Stock Position:  -0.6357492871421102
Bond Position:  [66.47487696]


portfolio before change:  [6.38199394]
curr_Stock_Price:  94.52946161191304
curr_Factors:  [94.52946161]
mat_Sqrt:  [[0.15]]
grads:  [0.11167731]
Stock Position:  0.11167731400849833
Bond Position:  [-4.17480243]


portfolio before change:  [6.41939144]
curr_Stock_Price:  94.8666691816238
curr_Factors:  [94.86666918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04264802]
Stock Position:  -0.04264801967611926
Bond Position:  [10.46526701]


portfolio before change:  [6.41638418]
curr_Stock_Price:  94.95251987231858
curr_Factors:  [94.95251987]
mat_Sqrt:  [[0.15]]
grads:  [0.32740867]
Stock Position:  0.327408667092508
Bond Position:  [-24.67189379]


portfolio before change:  [6.37219395]
curr_Stock_Price:  94.82226008680442
curr_Factors:  [94.82226009]
mat_Sqrt:  [[0.15]]
grads:  [0.13773692]
Stock Position:  0.13773691890556616
Bond Position:  [-6.688332]


portfolio before change:  [6.40322047]
curr_Stock_Price:  95.05055439953563
curr_Factors:  [95.0505544]
mat_Sqrt:  [[0.15]]
grads:  [0.04375332]
Stock Position:  0.04375332439712805
Bond Position:  [2.24444273]


portfolio before change:  [6.39712014]
curr_Stock_Price:  94.90792251887895
curr_Factors:  [94.90792252]
mat_Sqrt:  [[0.15]]
grads:  [0.23638353]
Stock Position:  0.2363835342099345
Bond Position:  [-16.03755001]


portfolio before change:  [6.50353807]
curr_Stock_Price:  95.36235482652445
curr_Factors:  [95.36235483]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248974]
Stock Position:  -0.02248973883857117
Bond Position:  [8.64821253]


portfolio before change:  [6.50234773]
curr_Stock_Price:  95.43931781661351
curr_Factors:  [95.43931782]
mat_Sqrt:  [[0.15]]
grads:  [0.13149518]
Stock Position:  0.13149518297561444
Bond Position:  [-6.04746283]


portfolio before change:  [6.59301815]
curr_Stock_Price:  96.1317264762607
curr_Factors:  [96.13172648]
mat_Sqrt:  [[0.15]]
grads:  [-0.2662832]
Stock Position:  -0.26628320341670036
Bond Position:  [32.19128223]


portfolio before change:  [6.45111391]
curr_Stock_Price:  96.67218963314068
curr_Factors:  [96.67218963]
mat_Sqrt:  [[0.15]]
grads:  [0.13150398]
Stock Position:  0.13150398063278848
Bond Position:  [-6.26166384]


portfolio before change:  [6.46021729]
curr_Stock_Price:  96.7443908440769
curr_Factors:  [96.74439084]
mat_Sqrt:  [[0.15]]
grads:  [0.06491451]
Stock Position:  0.0649145110285143
Bond Position:  [0.18010246]


portfolio before change:  [6.47703484]
curr_Stock_Price:  97.00328973297702
curr_Factors:  [97.00328973]
mat_Sqrt:  [[0.15]]
grads:  [0.03540546]
Stock Position:  0.03540546369955741
Bond Position:  [3.04258839]


portfolio before change:  [6.46860088]
curr_Stock_Price:  96.75970799787889
curr_Factors:  [96.759708]
mat_Sqrt:  [[0.15]]
grads:  [-0.05299296]
Stock Position:  -0.052992961314629494
Bond Position:  [11.59618435]


portfolio before change:  [6.44253343]
curr_Stock_Price:  97.26528901013276
curr_Factors:  [97.26528901]
mat_Sqrt:  [[0.15]]
grads:  [-0.00285642]
Stock Position:  -0.002856422776887187
Bond Position:  [6.72036422]


portfolio before change:  [6.44292774]
curr_Stock_Price:  97.27429698979402
curr_Factors:  [97.27429699]
mat_Sqrt:  [[0.15]]
grads:  [-0.03117941]
Stock Position:  -0.031179410887164964
Bond Position:  [9.47588301]


portfolio before change:  [6.41939184]
curr_Stock_Price:  98.04814600525395
curr_Factors:  [98.04814601]
mat_Sqrt:  [[0.15]]
grads:  [0.0118027]
Stock Position:  0.0118027003731797
Bond Position:  [5.26215895]


portfolio before change:  [6.41649811]
curr_Stock_Price:  97.77510411162845
curr_Factors:  [97.77510411]
mat_Sqrt:  [[0.15]]
grads:  [0.00607555]
Stock Position:  0.006075549737543021
Bond Position:  [5.8224606]


portfolio before change:  [6.42010056]
curr_Stock_Price:  98.30814900448694
curr_Factors:  [98.308149]
mat_Sqrt:  [[0.15]]
grads:  [0.05233868]
Stock Position:  0.052338678725764
Bond Position:  [1.27478194]


portfolio before change:  [6.3968861]
curr_Stock_Price:  97.86308360221996
curr_Factors:  [97.8630836]
mat_Sqrt:  [[0.15]]
grads:  [-0.05853857]
Stock Position:  -0.05853856872395535
Bond Position:  [12.12565095]


portfolio before change:  [6.42160075]
curr_Stock_Price:  97.4538360289417
curr_Factors:  [97.45383603]
mat_Sqrt:  [[0.15]]
grads:  [-0.03124536]
Stock Position:  -0.031245355078310003
Bond Position:  [9.46658046]


portfolio before change:  [6.4095851]
curr_Stock_Price:  97.85733046045056
curr_Factors:  [97.85733046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332961]
Stock Position:  -0.0033296085243933056
Bond Position:  [6.7354117]


portfolio before change:  [6.40908582]
curr_Stock_Price:  98.13371591956081
curr_Factors:  [98.13371592]
mat_Sqrt:  [[0.15]]
grads:  [0.07779697]
Stock Position:  0.07779697271136607
Bond Position:  [-1.2254202]


portfolio before change:  [6.40509398]
curr_Stock_Price:  98.08338938003705
curr_Factors:  [98.08338938]
mat_Sqrt:  [[0.15]]
grads:  [0.05389981]
Stock Position:  0.05389980658579263
Bond Position:  [1.11841826]


portfolio before change:  [6.37639165]
curr_Stock_Price:  97.54957987151305
curr_Factors:  [97.54957987]
mat_Sqrt:  [[0.15]]
grads:  [-0.0237112]
Stock Position:  -0.023711197825021717
Bond Position:  [8.68940904]


portfolio before change:  [6.37384711]
curr_Stock_Price:  97.67979884869267
curr_Factors:  [97.67979885]
mat_Sqrt:  [[0.15]]
grads:  [-0.03001456]
Stock Position:  -0.03001456445681385
Bond Position:  [9.30566373]


portfolio before change:  [6.36833282]
curr_Stock_Price:  97.88289743832142
curr_Factors:  [97.88289744]
mat_Sqrt:  [[0.15]]
grads:  [-0.00080806]
Stock Position:  -0.0008080560497878327
Bond Position:  [6.44742768]


portfolio before change:  [6.36821544]
curr_Stock_Price:  98.5268581785771
curr_Factors:  [98.52685818]
mat_Sqrt:  [[0.15]]
grads:  [-0.04039789]
Stock Position:  -0.04039789177276734
Bond Position:  [10.34849279]


portfolio before change:  [6.37070902]
curr_Stock_Price:  98.48114328588893
curr_Factors:  [98.48114329]
mat_Sqrt:  [[0.15]]
grads:  [0.0133099]
Stock Position:  0.013309904964442369
Bond Position:  [5.05993436]


portfolio before change:  [6.37556248]
curr_Stock_Price:  98.82203232890348
curr_Factors:  [98.82203233]
mat_Sqrt:  [[0.15]]
grads:  [0.13300776]
Stock Position:  0.1330077576056955
Bond Position:  [-6.76853444]


portfolio before change:  [6.44696915]
curr_Stock_Price:  99.362073917417
curr_Factors:  [99.36207392]
mat_Sqrt:  [[0.15]]
grads:  [0.0359442]
Stock Position:  0.03594419653738401
Bond Position:  [2.87547924]


portfolio before change:  [6.4316044]
curr_Stock_Price:  98.92961267724891
curr_Factors:  [98.92961268]
mat_Sqrt:  [[0.15]]
grads:  [0.06062442]
Stock Position:  0.060624419430108406
Bond Position:  [0.43405407]


portfolio before change:  [6.40418345]
curr_Stock_Price:  98.4768564981884
curr_Factors:  [98.4768565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325553]
Stock Position:  -0.003255531101630238
Bond Position:  [6.72477792]


portfolio before change:  [6.40279419]
curr_Stock_Price:  99.03270176461757
curr_Factors:  [99.03270176]
mat_Sqrt:  [[0.15]]
grads:  [0.01879906]
Stock Position:  0.018799062096803897
Bond Position:  [4.54107228]


portfolio before change:  [6.40409288]
curr_Stock_Price:  99.08668634589597
curr_Factors:  [99.08668635]
mat_Sqrt:  [[0.15]]
grads:  [0.14599378]
Stock Position:  0.14599378055157228
Bond Position:  [-8.06194706]


portfolio before change:  [6.4833324]
curr_Stock_Price:  99.63289736641245
curr_Factors:  [99.63289737]
mat_Sqrt:  [[0.15]]
grads:  [0.01030468]
Stock Position:  0.010304682739744633
Bond Position:  [5.45664701]


portfolio before change:  [6.49322714]
curr_Stock_Price:  100.56001853427414
curr_Factors:  [100.56001853]
mat_Sqrt:  [[0.15]]
grads:  [-0.10644219]
Stock Position:  -0.10644218526187471
Bond Position:  [17.19705527]


portfolio before change:  [6.46968121]
curr_Stock_Price:  100.79132518677041
curr_Factors:  [100.79132519]
mat_Sqrt:  [[0.15]]
grads:  [-0.00471624]
Stock Position:  -0.004716238779773341
Bond Position:  [6.94503716]


portfolio before change:  [6.47346493]
curr_Stock_Price:  100.08108821887005
curr_Factors:  [100.08108822]
mat_Sqrt:  [[0.15]]
grads:  [0.00844654]
Stock Position:  0.008446539862986614
Bond Position:  [5.62812603]


portfolio before change:  [6.47679733]
curr_Stock_Price:  100.43396987893233
curr_Factors:  [100.43396988]
mat_Sqrt:  [[0.15]]
grads:  [-0.00172386]
Stock Position:  -0.0017238569505375705
Bond Position:  [6.64993113]


portfolio before change:  [6.47820174]
curr_Stock_Price:  99.86038434526452
curr_Factors:  [99.86038435]
mat_Sqrt:  [[0.15]]
grads:  [-0.02418868]
Stock Position:  -0.024188677950715325
Bond Position:  [8.89369242]


portfolio before change:  [6.46873606]
curr_Stock_Price:  100.27469212197768
curr_Factors:  [100.27469212]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797273]
Stock Position:  -0.027972731428720955
Bond Position:  [9.27369309]


portfolio before change:  [6.44210282]
curr_Stock_Price:  101.24752742225697
curr_Factors:  [101.24752742]
mat_Sqrt:  [[0.15]]
grads:  [0.10828097]
Stock Position:  0.10828096897351479
Bond Position:  [-4.52107755]


portfolio before change:  [6.3739779]
curr_Stock_Price:  100.62098748766181
curr_Factors:  [100.62098749]
mat_Sqrt:  [[0.15]]
grads:  [-0.11022628]
Stock Position:  -0.1102262816887509
Bond Position:  [17.46505521]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.31016914]
Stock Price:  101.20977947888271
PL:  [5.10038967]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38121434e-02]
 [-5.37383023e-03]
 [ 2.61348357e-03]
 [-9.16177034e-03]
 [ 1.28764741e-02]
 [-4.33624544e-03]
 [-9.59072992e-03]
 [-2.66327820e-02]
 [ 6.94107362e-03]
 [-3.83975750e-03]
 [-1.07721732e-02]
 [ 1.97827601e-02]
 [-4.65523435e-03]
 [ 3.13413622e-03]
 [ 6.77050358e-03]
 [ 9.94193111e-03]
 [ 9.03622375e-02]
 [-1.32798873e-02]
 [ 1.78705695e-02]
 [ 2.03000323e-03]
 [-3.80874387e-03]
 [ 4.53364961e-03]
 [ 1.51389670e-02]
 [ 2.08247014e-02]
 [-6.75887475e-04]
 [ 8.23737318e-03]
 [ 1.55481684e-03]
 [ 1.49271428e-02]
 [ 3.24652066e-02]
 [-1.99861491e-03]
 [-5.30982520e-03]
 [ 1.33148455e-02]
 [ 1.27291860e-02]
 [ 8.85962344e-03]
 [ 5.38389694e-03]
 [ 1.00395501e-02]
 [-2.33179085e-02]
 [ 3.19969192e-03]
 [-5.76001710e-02]
 [-1.54705149e-02]
 [ 7.18468956e-03]
 [ 1.66254936e-03]
 [-1.36965788e-03]
 [-6.54807403e-04]
 [ 1.82249737e-02]
 [ 1.53312950e-02]
 [ 1.06746832e-02]
 [ 4.75797213e-03]
 [ 5.43693299e-03]
 [-2.29278310e-03]
 [-6.88025194e-03]
 [-4.85791932e-03]
 [ 1.53181954e-03]
 [ 8.85578633e-03]
 [-7.49719552e-03]
 [-4.43613509e-03]
 [ 9.37456785e-04]
 [ 7.09415108e-03]
 [ 7.44364491e-03]
 [-3.97843508e-03]
 [-3.62074558e-03]
 [ 1.56992601e-03]
 [-6.10534512e-03]
 [ 2.52120197e-03]
 [ 1.98088811e-02]
 [ 4.96153187e-03]
 [ 1.07653792e-02]
 [-4.47418521e-04]
 [ 3.69101237e-03]
 [ 2.35109176e-02]
 [ 3.40791086e-03]
 [-1.54726029e-02]
 [-5.70873057e-03]
 [ 2.07704414e-03]
 [ 1.05802132e-02]
 [ 3.73049100e-03]
 [-1.45395319e-03]
 [-1.76991424e-02]
 [-3.00313162e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.865677]
curr_Stock_Price:  99.86848830275429
curr_Factors:  [99.8684883]
mat_Sqrt:  [[0.15]]
grads:  [-0.09208096]
Stock Position:  -0.09208095570375638
Bond Position:  [8.33030885]


portfolio before change:  [-0.82446423]
curr_Stock_Price:  99.42657163446172
curr_Factors:  [99.42657163]
mat_Sqrt:  [[0.15]]
grads:  [-0.03582553]
Stock Position:  -0.035825534836944124
Bond Position:  [2.73754587]


portfolio before change:  [-0.84212799]
curr_Stock_Price:  99.92439709050927
curr_Factors:  [99.92439709]
mat_Sqrt:  [[0.15]]
grads:  [0.01742322]
Stock Position:  0.017423223794569034
Bond Position:  [-2.58313313]


portfolio before change:  [-0.84461966]
curr_Stock_Price:  99.79065491292813
curr_Factors:  [99.79065491]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107847]
Stock Position:  -0.06107846891280095
Bond Position:  [5.25044075]


portfolio before change:  [-0.86312119]
curr_Stock_Price:  100.0989417294266
curr_Factors:  [100.09894173]
mat_Sqrt:  [[0.15]]
grads:  [0.08584316]
Stock Position:  0.08584316092915494
Bond Position:  [-9.45593075]


portfolio before change:  [-0.85438322]
curr_Stock_Price:  100.20761652016392
curr_Factors:  [100.20761652]
mat_Sqrt:  [[0.15]]
grads:  [-0.0289083]
Stock Position:  -0.028908302908669678
Bond Position:  [2.04244892]


portfolio before change:  [-0.87244481]
curr_Stock_Price:  100.83682153746388
curr_Factors:  [100.83682154]
mat_Sqrt:  [[0.15]]
grads:  [-0.0639382]
Stock Position:  -0.06393819947845442
Bond Position:  [5.57488]


portfolio before change:  [-0.87620219]
curr_Stock_Price:  100.90103710674038
curr_Factors:  [100.90103711]
mat_Sqrt:  [[0.15]]
grads:  [-0.17755188]
Stock Position:  -0.17755187966829483
Bond Position:  [17.0389666]


portfolio before change:  [-0.85295437]
curr_Stock_Price:  100.77609978005917
curr_Factors:  [100.77609978]
mat_Sqrt:  [[0.15]]
grads:  [0.04627382]
Stock Position:  0.04627382412293289
Bond Position:  [-5.51624989]


portfolio before change:  [-0.82322998]
curr_Stock_Price:  101.4259092121138
curr_Factors:  [101.42590921]
mat_Sqrt:  [[0.15]]
grads:  [-0.02559838]
Stock Position:  -0.025598383335436667
Bond Position:  [1.77310933]


portfolio before change:  [-0.8468923]
curr_Stock_Price:  102.35460618511918
curr_Factors:  [102.35460619]
mat_Sqrt:  [[0.15]]
grads:  [-0.07181449]
Stock Position:  -0.0718144880102848
Bond Position:  [6.50365134]


portfolio before change:  [-0.87019219]
curr_Stock_Price:  102.68471211020648
curr_Factors:  [102.68471211]
mat_Sqrt:  [[0.15]]
grads:  [0.13188507]
Stock Position:  0.13188506702780806
Bond Position:  [-14.41277233]


portfolio before change:  [-0.85699006]
curr_Stock_Price:  102.79164581730971
curr_Factors:  [102.79164582]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310349]
Stock Position:  -0.031034895641276705
Bond Position:  [2.33313794]


portfolio before change:  [-0.84855706]
curr_Stock_Price:  102.52461813320642
curr_Factors:  [102.52461813]
mat_Sqrt:  [[0.15]]
grads:  [0.02089424]
Stock Position:  0.020894241469347083
Bond Position:  [-2.99073119]


portfolio before change:  [-0.85036824]
curr_Stock_Price:  102.44688121148418
curr_Factors:  [102.44688121]
mat_Sqrt:  [[0.15]]
grads:  [0.04513669]
Stock Position:  0.045136690538119875
Bond Position:  [-5.47448141]


portfolio before change:  [-0.82842186]
curr_Stock_Price:  102.94068215027785
curr_Factors:  [102.94068215]
mat_Sqrt:  [[0.15]]
grads:  [0.06627954]
Stock Position:  0.06627954076063775
Bond Position:  [-7.651283]


portfolio before change:  [-0.89788085]
curr_Stock_Price:  101.89992715860889
curr_Factors:  [101.89992716]
mat_Sqrt:  [[0.15]]
grads:  [0.60241492]
Stock Position:  0.6024149169462932
Bond Position:  [-62.283917]


portfolio before change:  [-1.03121832]
curr_Stock_Price:  101.68505098726907
curr_Factors:  [101.68505099]
mat_Sqrt:  [[0.15]]
grads:  [-0.08853258]
Stock Position:  -0.08853258180801368
Bond Position:  [7.97122177]


portfolio before change:  [-0.9865334]
curr_Stock_Price:  101.18594985230594
curr_Factors:  [101.18594985]
mat_Sqrt:  [[0.15]]
grads:  [0.11913713]
Stock Position:  0.1191371300210492
Bond Position:  [-13.04153706]


portfolio before change:  [-1.03410145]
curr_Stock_Price:  100.7935203186347
curr_Factors:  [100.79352032]
mat_Sqrt:  [[0.15]]
grads:  [0.01353335]
Stock Position:  0.01353335489161762
Bond Position:  [-2.39817593]


portfolio before change:  [-1.02920573]
curr_Stock_Price:  101.16634786911098
curr_Factors:  [101.16634787]
mat_Sqrt:  [[0.15]]
grads:  [-0.02539163]
Stock Position:  -0.025391625832585692
Bond Position:  [1.53957232]


portfolio before change:  [-1.03246331]
curr_Stock_Price:  101.29843098909166
curr_Factors:  [101.29843099]
mat_Sqrt:  [[0.15]]
grads:  [0.03022433]
Stock Position:  0.030224330718101752
Bond Position:  [-4.09414059]


portfolio before change:  [-1.0527067]
curr_Stock_Price:  100.6371258519257
curr_Factors:  [100.63712585]
mat_Sqrt:  [[0.15]]
grads:  [0.10092645]
Stock Position:  0.10092644680410721
Bond Position:  [-11.20965423]


portfolio before change:  [-0.97488206]
curr_Stock_Price:  101.41517043122214
curr_Factors:  [101.41517043]
mat_Sqrt:  [[0.15]]
grads:  [0.13883134]
Stock Position:  0.1388313427516043
Bond Position:  [-15.05448634]


portfolio before change:  [-0.91343157]
curr_Stock_Price:  101.86457487654485
curr_Factors:  [101.86457488]
mat_Sqrt:  [[0.15]]
grads:  [-0.00450592]
Stock Position:  -0.004505916499885805
Bond Position:  [-0.4544383]


portfolio before change:  [-0.91478097]
curr_Stock_Price:  102.15774499541878
curr_Factors:  [102.157745]
mat_Sqrt:  [[0.15]]
grads:  [0.05491582]
Stock Position:  0.05491582122908898
Bond Position:  [-6.52485743]


portfolio before change:  [-0.92507282]
curr_Stock_Price:  101.97775984518623
curr_Factors:  [101.97775985]
mat_Sqrt:  [[0.15]]
grads:  [0.01036545]
Stock Position:  0.010365445586678474
Bond Position:  [-1.98211774]


portfolio before change:  [-0.92637108]
curr_Stock_Price:  101.8644632259908
curr_Factors:  [101.86446323]
mat_Sqrt:  [[0.15]]
grads:  [0.09951429]
Stock Position:  0.09951428514852727
Bond Position:  [-11.06334032]


portfolio before change:  [-0.96140781]
curr_Stock_Price:  101.51933432786363
curr_Factors:  [101.51933433]
mat_Sqrt:  [[0.15]]
grads:  [0.21643471]
Stock Position:  0.21643471079148266
Bond Position:  [-22.93371558]


portfolio before change:  [-0.92751941]
curr_Stock_Price:  101.68253274028505
curr_Factors:  [101.68253274]
mat_Sqrt:  [[0.15]]
grads:  [-0.0133241]
Stock Position:  -0.013324099382719298
Bond Position:  [0.42730876]


portfolio before change:  [-0.92340382]
curr_Stock_Price:  101.37565362702325
curr_Factors:  [101.37565363]
mat_Sqrt:  [[0.15]]
grads:  [-0.03539883]
Stock Position:  -0.03539883463904834
Bond Position:  [2.66517618]


portfolio before change:  [-0.93109068]
curr_Stock_Price:  101.59750945880651
curr_Factors:  [101.59750946]
mat_Sqrt:  [[0.15]]
grads:  [0.08876564]
Stock Position:  0.08876563681553509
Bond Position:  [-9.9494583]


portfolio before change:  [-0.94191881]
curr_Stock_Price:  101.48252941174353
curr_Factors:  [101.48252941]
mat_Sqrt:  [[0.15]]
grads:  [0.08486124]
Stock Position:  0.08486123986026528
Bond Position:  [-9.55385208]


portfolio before change:  [-0.96732186]
curr_Stock_Price:  101.1902179711388
curr_Factors:  [101.19021797]
mat_Sqrt:  [[0.15]]
grads:  [0.05906416]
Stock Position:  0.059064156280677724
Bond Position:  [-6.94403671]


portfolio before change:  [-0.96997587]
curr_Stock_Price:  101.1526318398971
curr_Factors:  [101.15263184]
mat_Sqrt:  [[0.15]]
grads:  [0.03589265]
Stock Position:  0.03589264624337348
Bond Position:  [-4.6006115]


portfolio before change:  [-0.97951528]
curr_Stock_Price:  100.8948668037661
curr_Factors:  [100.8948668]
mat_Sqrt:  [[0.15]]
grads:  [0.06693033]
Stock Position:  0.06693033417573761
Bond Position:  [-7.73244244]


portfolio before change:  [-1.01440537]
curr_Stock_Price:  100.38079802242456
curr_Factors:  [100.38079802]
mat_Sqrt:  [[0.15]]
grads:  [-0.15545272]
Stock Position:  -0.15545272343819944
Bond Position:  [14.59006306]


portfolio before change:  [-0.89925674]
curr_Stock_Price:  99.64593329952928
curr_Factors:  [99.6459333]
mat_Sqrt:  [[0.15]]
grads:  [0.02133128]
Stock Position:  0.02133127947442882
Bond Position:  [-3.02483199]


portfolio before change:  [-0.89655159]
curr_Stock_Price:  99.7816124404463
curr_Factors:  [99.78161244]
mat_Sqrt:  [[0.15]]
grads:  [-0.38400114]
Stock Position:  -0.38400114032683047
Bond Position:  [37.41970137]


portfolio before change:  [-0.48420568]
curr_Stock_Price:  98.71388876665294
curr_Factors:  [98.71388877]
mat_Sqrt:  [[0.15]]
grads:  [-0.10313677]
Stock Position:  -0.10313676588587206
Bond Position:  [9.69682556]


portfolio before change:  [-0.51625327]
curr_Stock_Price:  99.03049417409078
curr_Factors:  [99.03049417]
mat_Sqrt:  [[0.15]]
grads:  [0.04789793]
Stock Position:  0.04789793041395146
Bond Position:  [-5.25960898]


portfolio before change:  [-0.49809236]
curr_Stock_Price:  99.41651581125633
curr_Factors:  [99.41651581]
mat_Sqrt:  [[0.15]]
grads:  [0.01108366]
Stock Position:  0.011083662432290267
Bond Position:  [-1.59999147]


portfolio before change:  [-0.49186385]
curr_Stock_Price:  99.98749249193264
curr_Factors:  [99.98749249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00913105]
Stock Position:  -0.009131052545566096
Bond Position:  [0.42112719]


portfolio before change:  [-0.48240161]
curr_Stock_Price:  98.95410466545817
curr_Factors:  [98.95410467]
mat_Sqrt:  [[0.15]]
grads:  [-0.00436538]
Stock Position:  -0.004365382684926037
Bond Position:  [-0.05042908]


portfolio before change:  [-0.48470668]
curr_Stock_Price:  99.48141542737841
curr_Factors:  [99.48141543]
mat_Sqrt:  [[0.15]]
grads:  [0.12149982]
Stock Position:  0.12149982495526108
Bond Position:  [-12.57168124]


portfolio before change:  [-0.48040314]
curr_Stock_Price:  99.52330270215401
curr_Factors:  [99.5233027]
mat_Sqrt:  [[0.15]]
grads:  [0.10220863]
Stock Position:  0.10220863343026222
Bond Position:  [-10.6525439]


portfolio before change:  [-0.53253407]
curr_Stock_Price:  99.01977259755313
curr_Factors:  [99.0197726]
mat_Sqrt:  [[0.15]]
grads:  [0.07116455]
Stock Position:  0.07116455471752764
Bond Position:  [-7.57923209]


portfolio before change:  [-0.52500428]
curr_Stock_Price:  99.13223730330829
curr_Factors:  [99.1322373]
mat_Sqrt:  [[0.15]]
grads:  [0.03171981]
Stock Position:  0.03171981417510381
Bond Position:  [-3.66946043]


portfolio before change:  [-0.51584174]
curr_Stock_Price:  99.42832629715495
curr_Factors:  [99.4283263]
mat_Sqrt:  [[0.15]]
grads:  [0.03624622]
Stock Position:  0.03624621994646703
Bond Position:  [-4.11974273]


portfolio before change:  [-0.51336611]
curr_Stock_Price:  99.50373059054071
curr_Factors:  [99.50373059]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528522]
Stock Position:  -0.015285220643088746
Bond Position:  [1.00757036]


portfolio before change:  [-0.50119591]
curr_Stock_Price:  98.71164298837365
curr_Factors:  [98.71164299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04586835]
Stock Position:  -0.04586834627673312
Bond Position:  [4.02654392]


portfolio before change:  [-0.54388127]
curr_Stock_Price:  99.64773581091474
curr_Factors:  [99.64773581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03238613]
Stock Position:  -0.03238612877099402
Bond Position:  [2.68332314]


portfolio before change:  [-0.5219565]
curr_Stock_Price:  98.97593423362619
curr_Factors:  [98.97593423]
mat_Sqrt:  [[0.15]]
grads:  [0.01021213]
Stock Position:  0.010212130277914734
Bond Position:  [-1.53271164]


portfolio before change:  [-0.52348081]
curr_Stock_Price:  98.83605077950006
curr_Factors:  [98.83605078]
mat_Sqrt:  [[0.15]]
grads:  [0.05903858]
Stock Position:  0.05903857553396263
Bond Position:  [-6.35862046]


portfolio before change:  [-0.52824902]
curr_Stock_Price:  98.7620181220804
curr_Factors:  [98.76201812]
mat_Sqrt:  [[0.15]]
grads:  [-0.0499813]
Stock Position:  -0.049981303436329394
Bond Position:  [4.40800538]


portfolio before change:  [-0.52354854]
curr_Stock_Price:  98.6734857205122
curr_Factors:  [98.67348572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02957423]
Stock Position:  -0.02957423392187611
Bond Position:  [2.39464421]


portfolio before change:  [-0.52604249]
curr_Stock_Price:  98.76287505549267
curr_Factors:  [98.76287506]
mat_Sqrt:  [[0.15]]
grads:  [0.00624971]
Stock Position:  0.006249711903283384
Bond Position:  [-1.14328201]


portfolio before change:  [-0.52338957]
curr_Stock_Price:  99.1987957775046
curr_Factors:  [99.19879578]
mat_Sqrt:  [[0.15]]
grads:  [0.04729434]
Stock Position:  0.04729434053685238
Bond Position:  [-5.2149312]


portfolio before change:  [-0.53169703]
curr_Stock_Price:  99.0300333194113
curr_Factors:  [99.03003332]
mat_Sqrt:  [[0.15]]
grads:  [0.0496243]
Stock Position:  0.04962429943049262
Bond Position:  [-5.44599305]


portfolio before change:  [-0.53411328]
curr_Stock_Price:  98.9882015721261
curr_Factors:  [98.98820157]
mat_Sqrt:  [[0.15]]
grads:  [-0.0265229]
Stock Position:  -0.026522900519021383
Bond Position:  [2.09134094]


portfolio before change:  [-0.51217062]
curr_Stock_Price:  98.1658199164725
curr_Factors:  [98.16581992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0241383]
Stock Position:  -0.024138303842526413
Bond Position:  [1.85738577]


portfolio before change:  [-0.52776566]
curr_Stock_Price:  98.8166996665685
curr_Factors:  [98.81669967]
mat_Sqrt:  [[0.15]]
grads:  [0.01046617]
Stock Position:  0.01046617336809253
Bond Position:  [-1.56199838]


portfolio before change:  [-0.53018889]
curr_Stock_Price:  98.59449878964516
curr_Factors:  [98.59449879]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407023]
Stock Position:  -0.040702300812808276
Bond Position:  [3.48283406]


portfolio before change:  [-0.53183632]
curr_Stock_Price:  98.64032224001966
curr_Factors:  [98.64032224]
mat_Sqrt:  [[0.15]]
grads:  [0.01680801]
Stock Position:  0.016808013134421703
Bond Position:  [-2.18978415]


portfolio before change:  [-0.52552067]
curr_Stock_Price:  99.02421766726512
curr_Factors:  [99.02421767]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-13.60258033]


portfolio before change:  [-0.55289814]
curr_Stock_Price:  98.82334352778723
curr_Factors:  [98.82334353]
mat_Sqrt:  [[0.15]]
grads:  [0.03307688]
Stock Position:  0.033076879153782886
Bond Position:  [-3.82166593]


portfolio before change:  [-0.57121237]
curr_Stock_Price:  98.27687790615265
curr_Factors:  [98.27687791]
mat_Sqrt:  [[0.15]]
grads:  [0.07176919]
Stock Position:  0.07176919492586561
Bond Position:  [-7.62446478]


portfolio before change:  [-0.55205244]
curr_Stock_Price:  98.55048379462012
curr_Factors:  [98.55048379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00298279]
Stock Position:  -0.0029827901381520184
Bond Position:  [-0.25809703]


portfolio before change:  [-0.54857869]
curr_Stock_Price:  97.38047580686089
curr_Factors:  [97.38047581]
mat_Sqrt:  [[0.15]]
grads:  [0.02460675]
Stock Position:  0.024606749135119448
Bond Position:  [-2.94479563]


portfolio before change:  [-0.56005799]
curr_Stock_Price:  96.92144527035926
curr_Factors:  [96.92144527]
mat_Sqrt:  [[0.15]]
grads:  [0.15673945]
Stock Position:  0.1567394507002398
Bond Position:  [-15.75147208]


portfolio before change:  [-0.54898065]
curr_Stock_Price:  96.99839999055723
curr_Factors:  [96.99839999]
mat_Sqrt:  [[0.15]]
grads:  [0.02271941]
Stock Position:  0.022719405754294885
Bond Position:  [-2.75272666]


portfolio before change:  [-0.55166415]
curr_Stock_Price:  96.88785772238934
curr_Factors:  [96.88785772]
mat_Sqrt:  [[0.15]]
grads:  [-0.10315069]
Stock Position:  -0.10315068571893607
Bond Position:  [9.44238481]


portfolio before change:  [-0.53153516]
curr_Stock_Price:  96.69843749384195
curr_Factors:  [96.69843749]
mat_Sqrt:  [[0.15]]
grads:  [-0.0380582]
Stock Position:  -0.03805820379530536
Bond Position:  [3.14863368]


portfolio before change:  [-0.51087675]
curr_Stock_Price:  96.1607974016645
curr_Factors:  [96.1607974]
mat_Sqrt:  [[0.15]]
grads:  [0.01384696]
Stock Position:  0.013846960943787706
Bond Position:  [-1.84241155]


portfolio before change:  [-0.51368404]
curr_Stock_Price:  95.96637636659757
curr_Factors:  [95.96637637]
mat_Sqrt:  [[0.15]]
grads:  [0.07053475]
Stock Position:  0.07053475467724583
Bond Position:  [-7.28264886]


portfolio before change:  [-0.49462425]
curr_Stock_Price:  96.24304816721946
curr_Factors:  [96.24304817]
mat_Sqrt:  [[0.15]]
grads:  [0.02486994]
Stock Position:  0.0248699399849167
Bond Position:  [-2.88818308]


portfolio before change:  [-0.50030002]
curr_Stock_Price:  96.0220882483158
curr_Factors:  [96.02208825]
mat_Sqrt:  [[0.15]]
grads:  [-0.00969302]
Stock Position:  -0.009693021265737088
Bond Position:  [0.43044412]


portfolio before change:  [-0.49562033]
curr_Stock_Price:  95.54207385419198
curr_Factors:  [95.54207385]
mat_Sqrt:  [[0.15]]
grads:  [-0.11799428]
Stock Position:  -0.11799428266772059
Bond Position:  [10.77779814]


portfolio before change:  [-0.47552091]
curr_Stock_Price:  95.37744060993829
curr_Factors:  [95.37744061]
mat_Sqrt:  [[0.15]]
grads:  [-0.20020877]
Stock Position:  -0.20020877494464528
Bond Position:  [18.61987963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.31940155]
Stock Price:  94.60347061730462
PL:  [-0.31940155]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.99364496e-03]
 [ 1.44759741e-02]
 [ 7.19553202e-03]
 [-1.05199505e-02]
 [ 9.76164810e-03]
 [-1.73884100e-03]
 [-2.69626838e-03]
 [-1.74837176e-02]
 [ 3.34232858e-03]
 [-7.79009649e-04]
 [ 1.33462882e-02]
 [-5.18414198e-03]
 [-1.06571929e-03]
 [ 8.75231685e-03]
 [-2.35711413e-03]
 [ 1.60924842e-02]
 [ 4.30032853e-02]
 [-1.47355114e-02]
 [ 2.29342530e-02]
 [ 3.93958985e-04]
 [-4.82790193e-03]
 [ 5.45771163e-03]
 [ 1.42763110e-02]
 [ 1.94465402e-02]
 [-3.81829605e-03]
 [ 4.71763397e-03]
 [-3.50840961e-03]
 [ 8.02965324e-03]
 [ 1.76170502e-02]
 [ 1.82918816e-03]
 [-6.47621394e-03]
 [ 1.01210484e-02]
 [ 1.15217302e-02]
 [-1.96581572e-02]
 [-3.92801564e-03]
 [ 1.84163503e-02]
 [ 4.31211124e-03]
 [ 2.32605698e-03]
 [-4.62232537e-02]
 [-1.50000909e-02]
 [ 7.16638216e-03]
 [-3.12605717e-03]
 [-1.76985307e-03]
 [-3.66860046e-03]
 [ 2.30921496e-02]
 [ 1.53779526e-02]
 [ 1.07096419e-02]
 [ 3.98024016e-03]
 [ 8.88246538e-03]
 [-2.12469137e-03]
 [-3.16128610e-03]
 [ 1.02063191e-03]
 [ 1.37707815e-03]
 [ 8.06272785e-03]
 [-9.22369071e-03]
 [-4.67419266e-03]
 [-6.57536995e-04]
 [ 1.22204710e-02]
 [ 8.16007568e-03]
 [-3.23423030e-03]
 [-5.14091317e-03]
 [-3.61785917e-04]
 [-5.21825277e-03]
 [ 6.80506862e-04]
 [ 1.98088811e-02]
 [ 5.08960750e-03]
 [ 7.98640760e-03]
 [-2.58600665e-04]
 [ 2.80470172e-03]
 [ 2.19551482e-02]
 [ 2.18456930e-03]
 [-1.59940734e-02]
 [-1.24153861e-03]
 [ 1.30304125e-03]
 [ 5.92553400e-04]
 [-8.50702216e-04]
 [-3.96027746e-03]
 [ 6.76025189e-03]
 [-2.16221379e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.14232966]
curr_Stock_Price:  100.23219555460076
curr_Factors:  [100.23219555]
mat_Sqrt:  [[0.15]]
grads:  [-0.0266243]
Stock Position:  -0.0266242997241923
Bond Position:  [9.81094168]


portfolio before change:  [7.14356579]
curr_Stock_Price:  100.20879863951806
curr_Factors:  [100.20879864]
mat_Sqrt:  [[0.15]]
grads:  [0.09650649]
Stock Position:  0.09650649430169997
Bond Position:  [-2.52723407]


portfolio before change:  [7.07581444]
curr_Stock_Price:  99.50839607577963
curr_Factors:  [99.50839608]
mat_Sqrt:  [[0.15]]
grads:  [0.04797021]
Stock Position:  0.04797021348768908
Bond Position:  [2.30237543]


portfolio before change:  [7.05678185]
curr_Stock_Price:  99.10863785035103
curr_Factors:  [99.10863785]
mat_Sqrt:  [[0.15]]
grads:  [-0.070133]
Stock Position:  -0.07013300365000809
Bond Position:  [14.00756831]


portfolio before change:  [6.9733264]
curr_Stock_Price:  100.3110809596444
curr_Factors:  [100.31108096]
mat_Sqrt:  [[0.15]]
grads:  [0.06507765]
Stock Position:  0.06507765399899731
Bond Position:  [0.44531659]


portfolio before change:  [6.99640344]
curr_Stock_Price:  100.66526095942278
curr_Factors:  [100.66526096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01159227]
Stock Position:  -0.01159227333655345
Bond Position:  [8.16334266]


portfolio before change:  [6.99920883]
curr_Stock_Price:  100.46726977621316
curr_Factors:  [100.46726978]
mat_Sqrt:  [[0.15]]
grads:  [-0.01797512]
Stock Position:  -0.01797512250146028
Bond Position:  [8.80512031]


portfolio before change:  [6.99891688]
curr_Stock_Price:  100.51412843924857
curr_Factors:  [100.51412844]
mat_Sqrt:  [[0.15]]
grads:  [-0.11655812]
Stock Position:  -0.11655811717400168
Bond Position:  [18.71465444]


portfolio before change:  [7.0022012]
curr_Stock_Price:  100.49598622656846
curr_Factors:  [100.49598623]
mat_Sqrt:  [[0.15]]
grads:  [0.02228219]
Stock Position:  0.022282190530882134
Bond Position:  [4.76293049]


portfolio before change:  [6.99529475]
curr_Stock_Price:  100.17267200846717
curr_Factors:  [100.17267201]
mat_Sqrt:  [[0.15]]
grads:  [-0.0051934]
Stock Position:  -0.005193397661792052
Bond Position:  [7.51553127]


portfolio before change:  [6.99650395]
curr_Stock_Price:  100.03028630168662
curr_Factors:  [100.0302863]
mat_Sqrt:  [[0.15]]
grads:  [0.08897525]
Stock Position:  0.08897525461582953
Bond Position:  [-1.90371624]


portfolio before change:  [6.96347509]
curr_Stock_Price:  99.66040955254806
curr_Factors:  [99.66040955]
mat_Sqrt:  [[0.15]]
grads:  [-0.03456095]
Stock Position:  -0.03456094652615402
Bond Position:  [10.40783317]


portfolio before change:  [6.96831032]
curr_Stock_Price:  99.53932702076811
curr_Factors:  [99.53932702]
mat_Sqrt:  [[0.15]]
grads:  [-0.0071048]
Stock Position:  -0.007104795271711667
Bond Position:  [7.67551686]


portfolio before change:  [6.96351151]
curr_Stock_Price:  100.28228229146862
curr_Factors:  [100.28228229]
mat_Sqrt:  [[0.15]]
grads:  [0.05834878]
Stock Position:  0.058348779016380234
Bond Position:  [1.11216278]


portfolio before change:  [6.97189927]
curr_Stock_Price:  100.42484295869706
curr_Factors:  [100.42484296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571409]
Stock Position:  -0.015714094214680716
Bond Position:  [8.54998471]


portfolio before change:  [6.96443469]
curr_Stock_Price:  100.9338741727852
curr_Factors:  [100.93387417]
mat_Sqrt:  [[0.15]]
grads:  [0.10728323]
Stock Position:  0.10728322767194257
Bond Position:  [-3.86407711]


portfolio before change:  [6.91956648]
curr_Stock_Price:  100.5179032871535
curr_Factors:  [100.51790329]
mat_Sqrt:  [[0.15]]
grads:  [0.28668857]
Stock Position:  0.2866885686328086
Bond Position:  [-21.89776734]


portfolio before change:  [6.79052619]
curr_Stock_Price:  100.07257113215222
curr_Factors:  [100.07257113]
mat_Sqrt:  [[0.15]]
grads:  [-0.09823674]
Stock Position:  -0.09823674240513683
Bond Position:  [16.62132958]


portfolio before change:  [6.88529216]
curr_Stock_Price:  99.11847695741163
curr_Factors:  [99.11847696]
mat_Sqrt:  [[0.15]]
grads:  [0.15289502]
Stock Position:  0.15289502014584427
Bond Position:  [-8.26942937]


portfolio before change:  [6.83853751]
curr_Stock_Price:  98.81606165305826
curr_Factors:  [98.81606165]
mat_Sqrt:  [[0.15]]
grads:  [0.00262639]
Stock Position:  0.0026263932304710007
Bond Position:  [6.57900767]


portfolio before change:  [6.8388266]
curr_Stock_Price:  98.76956904509873
curr_Factors:  [98.76956905]
mat_Sqrt:  [[0.15]]
grads:  [-0.03218601]
Stock Position:  -0.03218601288745474
Bond Position:  [10.01782522]


portfolio before change:  [6.85348838]
curr_Stock_Price:  98.33349017484463
curr_Factors:  [98.33349017]
mat_Sqrt:  [[0.15]]
grads:  [0.03638474]
Stock Position:  0.03638474421396111
Bond Position:  [3.27564949]


portfolio before change:  [6.84712992]
curr_Stock_Price:  98.15310720770579
curr_Factors:  [98.15310721]
mat_Sqrt:  [[0.15]]
grads:  [0.09517541]
Stock Position:  0.09517540665105968
Bond Position:  [-2.49463197]


portfolio before change:  [6.86772458]
curr_Stock_Price:  98.37113175395235
curr_Factors:  [98.37113175]
mat_Sqrt:  [[0.15]]
grads:  [0.1296436]
Stock Position:  0.12964360120076576
Bond Position:  [-5.8854632]


portfolio before change:  [6.86279068]
curr_Stock_Price:  98.33591176470989
curr_Factors:  [98.33591176]
mat_Sqrt:  [[0.15]]
grads:  [-0.02545531]
Stock Position:  -0.025455306980604858
Bond Position:  [9.3659615]


portfolio before change:  [6.82006991]
curr_Stock_Price:  100.03717441637505
curr_Factors:  [100.03717442]
mat_Sqrt:  [[0.15]]
grads:  [0.03145089]
Stock Position:  0.03145089310594245
Bond Position:  [3.67381143]


portfolio before change:  [6.83342726]
curr_Stock_Price:  100.45457867232982
curr_Factors:  [100.45457867]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233894]
Stock Position:  -0.02338939739007978
Bond Position:  [9.18299932]


portfolio before change:  [6.86538474]
curr_Stock_Price:  99.11279466666545
curr_Factors:  [99.11279467]
mat_Sqrt:  [[0.15]]
grads:  [0.05353102]
Stock Position:  0.053531021568391214
Bond Position:  [1.55977559]


portfolio before change:  [6.89234987]
curr_Stock_Price:  99.61470263694893
curr_Factors:  [99.61470264]
mat_Sqrt:  [[0.15]]
grads:  [0.117447]
Stock Position:  0.11744700146371806
Bond Position:  [-4.80709825]


portfolio before change:  [6.87344704]
curr_Stock_Price:  99.45631303773116
curr_Factors:  [99.45631304]
mat_Sqrt:  [[0.15]]
grads:  [0.01219459]
Stock Position:  0.012194587743650093
Bond Position:  [5.6606183]


portfolio before change:  [6.87049391]
curr_Stock_Price:  99.18513337305652
curr_Factors:  [99.18513337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04317476]
Stock Position:  -0.04317475959180622
Bond Position:  [11.1527882]


portfolio before change:  [6.88350451]
curr_Stock_Price:  98.89993128786685
curr_Factors:  [98.89993129]
mat_Sqrt:  [[0.15]]
grads:  [0.06747366]
Stock Position:  0.06747365604168026
Bond Position:  [0.21036457]


portfolio before change:  [6.81825327]
curr_Stock_Price:  97.93267385468478
curr_Factors:  [97.93267385]
mat_Sqrt:  [[0.15]]
grads:  [0.07681153]
Stock Position:  0.07681153475235582
Bond Position:  [-0.70410571]


portfolio before change:  [6.8359566]
curr_Stock_Price:  98.16372428798242
curr_Factors:  [98.16372429]
mat_Sqrt:  [[0.15]]
grads:  [-0.13105438]
Stock Position:  -0.13105438122036223
Bond Position:  [19.70074274]


portfolio before change:  [6.82466426]
curr_Stock_Price:  98.25928515140149
curr_Factors:  [98.25928515]
mat_Sqrt:  [[0.15]]
grads:  [-0.02618677]
Stock Position:  -0.026186770962870334
Bond Position:  [9.39775766]


portfolio before change:  [6.81544333]
curr_Stock_Price:  98.63383739698475
curr_Factors:  [98.6338374]
mat_Sqrt:  [[0.15]]
grads:  [0.12277567]
Stock Position:  0.12277566895146498
Bond Position:  [-5.29439204]


portfolio before change:  [6.82660071]
curr_Stock_Price:  98.72740880612919
curr_Factors:  [98.72740881]
mat_Sqrt:  [[0.15]]
grads:  [0.02874741]
Stock Position:  0.02874740828825916
Bond Position:  [3.98844358]


portfolio before change:  [6.83076934]
curr_Stock_Price:  98.8637462686794
curr_Factors:  [98.86374627]
mat_Sqrt:  [[0.15]]
grads:  [0.01550705]
Stock Position:  0.015507046547337025
Bond Position:  [5.29768463]


portfolio before change:  [6.83619608]
curr_Stock_Price:  99.19234636095022
curr_Factors:  [99.19234636]
mat_Sqrt:  [[0.15]]
grads:  [-0.30815502]
Stock Position:  -0.3081550244127823
Bond Position:  [37.40281599]


portfolio before change:  [6.96168116]
curr_Stock_Price:  98.79271850471349
curr_Factors:  [98.7927185]
mat_Sqrt:  [[0.15]]
grads:  [-0.10000061]
Stock Position:  -0.10000060626997274
Bond Position:  [16.8410129]


portfolio before change:  [6.98044623]
curr_Stock_Price:  98.61559482827842
curr_Factors:  [98.61559483]
mat_Sqrt:  [[0.15]]
grads:  [0.04777588]
Stock Position:  0.04777588108232423
Bond Position:  [2.2689993]


portfolio before change:  [7.03648847]
curr_Stock_Price:  99.78565010847429
curr_Factors:  [99.78565011]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084038]
Stock Position:  -0.020840381151833086
Bond Position:  [9.11605945]


portfolio before change:  [7.04249189]
curr_Stock_Price:  99.52492295680011
curr_Factors:  [99.52492296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01179902]
Stock Position:  -0.011799020494840145
Bond Position:  [8.2167885]


portfolio before change:  [7.03494292]
curr_Stock_Price:  100.20824593793232
curr_Factors:  [100.20824594]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445734]
Stock Position:  -0.024457336412211837
Bond Position:  [9.4857697]


portfolio before change:  [7.02853167]
curr_Stock_Price:  100.49462732809738
curr_Factors:  [100.49462733]
mat_Sqrt:  [[0.15]]
grads:  [0.15394766]
Stock Position:  0.15394766428573928
Bond Position:  [-8.44238148]


portfolio before change:  [6.9351201]
curr_Stock_Price:  99.8912800452299
curr_Factors:  [99.89128005]
mat_Sqrt:  [[0.15]]
grads:  [0.10251968]
Stock Position:  0.10251968392413525
Bond Position:  [-3.30570236]


portfolio before change:  [6.86789404]
curr_Stock_Price:  99.23755730733947
curr_Factors:  [99.23755731]
mat_Sqrt:  [[0.15]]
grads:  [0.07139761]
Stock Position:  0.07139761285730856
Bond Position:  [-0.21743066]


portfolio before change:  [6.94164451]
curr_Stock_Price:  100.27070197697807
curr_Factors:  [100.27070198]
mat_Sqrt:  [[0.15]]
grads:  [0.02653493]
Stock Position:  0.026534934388960173
Bond Position:  [4.28096801]


portfolio before change:  [6.93713906]
curr_Stock_Price:  100.09082518303323
curr_Factors:  [100.09082518]
mat_Sqrt:  [[0.15]]
grads:  [0.05921644]
Stock Position:  0.0592164358650181
Bond Position:  [1.01011713]


portfolio before change:  [6.92988372]
curr_Stock_Price:  99.9672366077328
curr_Factors:  [99.96723661]
mat_Sqrt:  [[0.15]]
grads:  [-0.01416461]
Stock Position:  -0.014164609162120997
Bond Position:  [8.34588055]


portfolio before change:  [6.93262344]
curr_Stock_Price:  99.8106432556467
curr_Factors:  [99.81064326]
mat_Sqrt:  [[0.15]]
grads:  [-0.02107524]
Stock Position:  -0.021075240671735187
Bond Position:  [9.03615677]


portfolio before change:  [6.96073778]
curr_Stock_Price:  98.50344281222434
curr_Factors:  [98.50344281]
mat_Sqrt:  [[0.15]]
grads:  [0.00680421]
Stock Position:  0.006804212757548339
Bond Position:  [6.2904994]


portfolio before change:  [6.96242241]
curr_Stock_Price:  98.69324606498952
curr_Factors:  [98.69324606]
mat_Sqrt:  [[0.15]]
grads:  [0.00918052]
Stock Position:  0.00918052096908396
Bond Position:  [6.05636699]


portfolio before change:  [6.96005573]
curr_Stock_Price:  98.39422038180105
curr_Factors:  [98.39422038]
mat_Sqrt:  [[0.15]]
grads:  [0.05375152]
Stock Position:  0.05375151900700949
Bond Position:  [1.67121692]


portfolio before change:  [6.91493817]
curr_Stock_Price:  97.55290432402965
curr_Factors:  [97.55290432]
mat_Sqrt:  [[0.15]]
grads:  [-0.06149127]
Stock Position:  -0.06149127140869692
Bond Position:  [12.91359029]


portfolio before change:  [6.91820299]
curr_Stock_Price:  97.51293611238489
curr_Factors:  [97.51293611]
mat_Sqrt:  [[0.15]]
grads:  [-0.03116128]
Stock Position:  -0.031161284367028776
Bond Position:  [9.95683132]


portfolio before change:  [6.91501037]
curr_Stock_Price:  97.63536169436715
curr_Factors:  [97.63536169]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438358]
Stock Position:  -0.004383579963436205
Bond Position:  [7.34300279]


portfolio before change:  [6.91659253]
curr_Stock_Price:  97.37913073661709
curr_Factors:  [97.37913074]
mat_Sqrt:  [[0.15]]
grads:  [0.08146981]
Stock Position:  0.08146980661319551
Bond Position:  [-1.01686641]


portfolio before change:  [6.91529924]
curr_Stock_Price:  97.36403635008958
curr_Factors:  [97.36403635]
mat_Sqrt:  [[0.15]]
grads:  [0.0544005]
Stock Position:  0.054400504536224574
Bond Position:  [1.61864654]


portfolio before change:  [6.88491371]
curr_Stock_Price:  96.8036242257843
curr_Factors:  [96.80362423]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156154]
Stock Position:  -0.02156153530528348
Bond Position:  [8.97214847]


portfolio before change:  [6.8877101]
curr_Stock_Price:  96.69993902241332
curr_Factors:  [96.69993902]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427275]
Stock Position:  -0.03427275444287221
Bond Position:  [10.20188336]


portfolio before change:  [6.85303279]
curr_Stock_Price:  97.73034781475388
curr_Factors:  [97.73034781]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241191]
Stock Position:  -0.0024119061140561475
Bond Position:  [7.08874921]


portfolio before change:  [6.85353529]
curr_Stock_Price:  97.70570285530933
curr_Factors:  [97.70570286]
mat_Sqrt:  [[0.15]]
grads:  [-0.03478835]
Stock Position:  -0.03478835177802515
Bond Position:  [10.25255565]


portfolio before change:  [6.84324238]
curr_Stock_Price:  98.01999535881919
curr_Factors:  [98.01999536]
mat_Sqrt:  [[0.15]]
grads:  [0.00453671]
Stock Position:  0.0045367124113847666
Bond Position:  [6.39855385]


portfolio before change:  [6.84919144]
curr_Stock_Price:  99.24315981501402
curr_Factors:  [99.24315982]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-6.25678155]


portfolio before change:  [6.80769181]
curr_Stock_Price:  98.93187089097489
curr_Factors:  [98.93187089]
mat_Sqrt:  [[0.15]]
grads:  [0.03393072]
Stock Position:  0.03393071664159404
Bond Position:  [3.45086254]


portfolio before change:  [6.82796147]
curr_Stock_Price:  99.52289779884353
curr_Factors:  [99.5228978]
mat_Sqrt:  [[0.15]]
grads:  [0.05324272]
Stock Position:  0.053242717324246853
Bond Position:  [1.52909195]


portfolio before change:  [6.79437565]
curr_Stock_Price:  98.89029702577156
curr_Factors:  [98.89029703]
mat_Sqrt:  [[0.15]]
grads:  [-0.001724]
Stock Position:  -0.0017240044355852839
Bond Position:  [6.96486296]


portfolio before change:  [6.79406939]
curr_Stock_Price:  99.32044973978306
curr_Factors:  [99.32044974]
mat_Sqrt:  [[0.15]]
grads:  [0.01869801]
Stock Position:  0.018698011481324425
Bond Position:  [4.93697448]


portfolio before change:  [6.78859843]
curr_Stock_Price:  99.01135113367295
curr_Factors:  [99.01135113]
mat_Sqrt:  [[0.15]]
grads:  [0.14636765]
Stock Position:  0.1463676545512274
Bond Position:  [-7.70346081]


portfolio before change:  [6.7887735]
curr_Stock_Price:  99.01583676770532
curr_Factors:  [99.01583677]
mat_Sqrt:  [[0.15]]
grads:  [0.0145638]
Stock Position:  0.014563795338967091
Bond Position:  [5.34672711]


portfolio before change:  [6.80446306]
curr_Stock_Price:  100.07019010148548
curr_Factors:  [100.0701901]
mat_Sqrt:  [[0.15]]
grads:  [-0.10662716]
Stock Position:  -0.1066271558986679
Bond Position:  [17.47466282]


portfolio before change:  [6.75081238]
curr_Stock_Price:  100.58359478957723
curr_Factors:  [100.58359479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00827692]
Stock Position:  -0.008276924080272825
Bond Position:  [7.58333516]


portfolio before change:  [6.75288653]
curr_Stock_Price:  100.39026522127122
curr_Factors:  [100.39026522]
mat_Sqrt:  [[0.15]]
grads:  [0.00868694]
Stock Position:  0.008686941684255444
Bond Position:  [5.88080215]


portfolio before change:  [6.74851953]
curr_Stock_Price:  99.84524481621789
curr_Factors:  [99.84524482]
mat_Sqrt:  [[0.15]]
grads:  [0.00395036]
Stock Position:  0.00395035599884146
Bond Position:  [6.35409527]


portfolio before change:  [6.74700232]
curr_Stock_Price:  99.36064208607883
curr_Factors:  [99.36064209]
mat_Sqrt:  [[0.15]]
grads:  [-0.00567135]
Stock Position:  -0.00567134810566509
Bond Position:  [7.31051111]


portfolio before change:  [6.74414627]
curr_Stock_Price:  99.94480136372353
curr_Factors:  [99.94480136]
mat_Sqrt:  [[0.15]]
grads:  [-0.02640185]
Stock Position:  -0.02640184976350787
Bond Position:  [9.3828739]


portfolio before change:  [6.75453076]
curr_Stock_Price:  99.57368951719498
curr_Factors:  [99.57368952]
mat_Sqrt:  [[0.15]]
grads:  [0.04506835]
Stock Position:  0.04506834590918358
Bond Position:  [2.26690928]


portfolio before change:  [6.77668357]
curr_Stock_Price:  100.06208388384154
curr_Factors:  [100.06208388]
mat_Sqrt:  [[0.15]]
grads:  [-0.14414759]
Stock Position:  -0.14414758625207522
Bond Position:  [21.20039144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.7566444]
Stock Price:  100.21029474887499
PL:  [6.54634965]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.99301804e-03]
 [ 4.25642813e-02]
 [ 1.63382802e-02]
 [-3.72747168e-02]
 [-4.02058090e-02]
 [-1.25184126e-03]
 [-5.36859910e-03]
 [-3.92644901e-02]
 [ 1.66397774e-02]
 [-8.57949331e-03]
 [-1.14212247e-02]
 [ 1.97893039e-02]
 [-4.71472064e-03]
 [ 3.17386466e-03]
 [ 8.76641815e-03]
 [ 1.06175608e-02]
 [ 9.66654943e-02]
 [-9.37284473e-03]
 [ 2.48737680e-02]
 [-7.57992712e-04]
 [-7.22049387e-03]
 [ 7.04953802e-03]
 [ 4.70333914e-03]
 [ 3.63041635e-02]
 [ 2.88121727e-03]
 [ 8.32340694e-03]
 [ 9.81226887e-03]
 [ 1.60124374e-02]
 [ 2.80833549e-02]
 [-1.28716110e-04]
 [-4.03890448e-03]
 [ 1.34423279e-02]
 [ 1.27482627e-02]
 [ 7.25697581e-03]
 [ 6.07943103e-03]
 [ 1.17194910e-02]
 [-2.76493384e-02]
 [-2.01457524e-03]
 [-1.96951800e-02]
 [-1.28987842e-02]
 [ 3.96146664e-03]
 [ 9.47389983e-03]
 [-6.52834921e-03]
 [ 2.49414274e-05]
 [ 1.13015886e-02]
 [ 1.28860663e-02]
 [ 1.06066161e-02]
 [ 2.96260060e-03]
 [ 1.28046465e-02]
 [-1.50671883e-03]
 [ 4.03845580e-03]
 [-1.65901944e-02]
 [ 1.27999993e-03]
 [-4.06518986e-03]
 [-2.24248192e-03]
 [-3.29298927e-03]
 [ 1.06667597e-02]
 [-4.71277381e-03]
 [ 6.65063228e-03]
 [-3.89279202e-03]
 [-4.01427256e-03]
 [ 6.37253241e-03]
 [-1.76726295e-02]
 [ 2.70003060e-03]
 [ 2.47322718e-02]
 [ 9.20869844e-03]
 [ 1.25770198e-02]
 [ 1.03024403e-02]
 [ 6.62146902e-03]
 [ 1.11881767e-02]
 [ 1.72939915e-03]
 [-1.53146781e-02]
 [-2.64503297e-03]
 [ 1.08143216e-03]
 [ 2.79805168e-03]
 [-1.75810505e-02]
 [-3.44395115e-03]
 [ 1.23356743e-02]
 [-5.28380497e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.64850282]
curr_Stock_Price:  100.84561826143268
curr_Factors:  [100.84561826]
mat_Sqrt:  [[0.15]]
grads:  [-0.03995345]
Stock Position:  -0.039953453582452204
Bond Position:  [24.67763354]


portfolio before change:  [20.64055788]
curr_Stock_Price:  101.08307794443336
curr_Factors:  [101.08307794]
mat_Sqrt:  [[0.15]]
grads:  [0.28376188]
Stock Position:  0.2837618756411122
Bond Position:  [-8.04296591]


portfolio before change:  [20.8818273]
curr_Stock_Price:  101.93510259791317
curr_Factors:  [101.9351026]
mat_Sqrt:  [[0.15]]
grads:  [0.10892187]
Stock Position:  0.10892186819638375
Bond Position:  [9.77886549]


portfolio before change:  [20.8820627]
curr_Stock_Price:  101.93165250652326
curr_Factors:  [101.93165251]
mat_Sqrt:  [[0.15]]
grads:  [-0.24849811]
Stock Position:  -0.24849811186510765
Bond Position:  [46.21188589]


portfolio before change:  [20.94177962]
curr_Stock_Price:  101.70296431694784
curr_Factors:  [101.70296432]
mat_Sqrt:  [[0.15]]
grads:  [-0.26803873]
Stock Position:  -0.2680387265324868
Bond Position:  [48.20211266]


portfolio before change:  [20.97591891]
curr_Stock_Price:  101.58683721257502
curr_Factors:  [101.58683721]
mat_Sqrt:  [[0.15]]
grads:  [-0.00834561]
Stock Position:  -0.00834560841598993
Bond Position:  [21.82372287]


portfolio before change:  [20.97967366]
curr_Stock_Price:  101.30037124876073
curr_Factors:  [101.30037125]
mat_Sqrt:  [[0.15]]
grads:  [-0.03579066]
Stock Position:  -0.0357906606644014
Bond Position:  [24.60528088]


portfolio before change:  [20.9669845]
curr_Stock_Price:  101.69787826058837
curr_Factors:  [101.69787826]
mat_Sqrt:  [[0.15]]
grads:  [-0.26176327]
Stock Position:  -0.26176326745901923
Bond Position:  [47.58775341]


portfolio before change:  [20.91991596]
curr_Stock_Price:  101.88905430899854
curr_Factors:  [101.88905431]
mat_Sqrt:  [[0.15]]
grads:  [0.11093185]
Stock Position:  0.11093184908297268
Bond Position:  [9.61717477]


portfolio before change:  [21.07752505]
curr_Stock_Price:  103.30440970318347
curr_Factors:  [103.3044097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05719662]
Stock Position:  -0.0571966220592741
Bond Position:  [26.98618833]


portfolio before change:  [21.11474814]
curr_Stock_Price:  102.68310729203603
curr_Factors:  [102.68310729]
mat_Sqrt:  [[0.15]]
grads:  [-0.0761415]
Stock Position:  -0.07614149781983325
Bond Position:  [28.93319373]


portfolio before change:  [21.11609697]
curr_Stock_Price:  102.6891427535765
curr_Factors:  [102.68914275]
mat_Sqrt:  [[0.15]]
grads:  [0.13192869]
Stock Position:  0.13192869275681748
Bond Position:  [7.5684526]


portfolio before change:  [21.14064503]
curr_Stock_Price:  102.8716278655867
curr_Factors:  [102.87162787]
mat_Sqrt:  [[0.15]]
grads:  [-0.03143147]
Stock Position:  -0.03143147091968149
Bond Position:  [24.37405161]


portfolio before change:  [21.15266544]
curr_Stock_Price:  102.53766396167596
curr_Factors:  [102.53766396]
mat_Sqrt:  [[0.15]]
grads:  [0.0211591]
Stock Position:  0.021159097757575393
Bond Position:  [18.98306098]


portfolio before change:  [21.1582045]
curr_Stock_Price:  102.74337138182516
curr_Factors:  [102.74337138]
mat_Sqrt:  [[0.15]]
grads:  [0.05844279]
Stock Position:  0.05844278767580112
Bond Position:  [15.15359546]


portfolio before change:  [21.14930906]
curr_Stock_Price:  102.57495763930973
curr_Factors:  [102.57495764]
mat_Sqrt:  [[0.15]]
grads:  [0.07078374]
Stock Position:  0.07078373833981633
Bond Position:  [13.8886701]


portfolio before change:  [21.18812673]
curr_Stock_Price:  103.11109209654575
curr_Factors:  [103.1110921]
mat_Sqrt:  [[0.15]]
grads:  [0.64443663]
Stock Position:  0.6444366287203683
Bond Position:  [-45.26043785]


portfolio before change:  [21.46433392]
curr_Stock_Price:  103.54408433085092
curr_Factors:  [103.54408433]
mat_Sqrt:  [[0.15]]
grads:  [-0.06248563]
Stock Position:  -0.062485631528177724
Bond Position:  [27.93435142]


portfolio before change:  [21.45121746]
curr_Stock_Price:  103.78193753502845
curr_Factors:  [103.78193754]
mat_Sqrt:  [[0.15]]
grads:  [0.16582512]
Stock Position:  0.165825119736723
Bond Position:  [4.24156524]


portfolio before change:  [21.56441353]
curr_Stock_Price:  104.46296200222399
curr_Factors:  [104.462962]
mat_Sqrt:  [[0.15]]
grads:  [-0.00505328]
Stock Position:  -0.005053284748111
Bond Position:  [22.09229463]


portfolio before change:  [21.57053718]
curr_Stock_Price:  103.52439764991846
curr_Factors:  [103.52439765]
mat_Sqrt:  [[0.15]]
grads:  [-0.04813663]
Stock Position:  -0.048136625797607115
Bond Position:  [26.55385237]


portfolio before change:  [21.53995095]
curr_Stock_Price:  104.19428031527853
curr_Factors:  [104.19428032]
mat_Sqrt:  [[0.15]]
grads:  [0.04699692]
Stock Position:  0.046996920149704594
Bond Position:  [16.64314068]


portfolio before change:  [21.48604913]
curr_Stock_Price:  103.02522383585854
curr_Factors:  [103.02522384]
mat_Sqrt:  [[0.15]]
grads:  [0.03135559]
Stock Position:  0.03135559429897746
Bond Position:  [18.25563201]


portfolio before change:  [21.47553843]
curr_Stock_Price:  102.6536247335919
curr_Factors:  [102.65362473]
mat_Sqrt:  [[0.15]]
grads:  [0.24202776]
Stock Position:  0.24202775644111085
Bond Position:  [-3.36948805]


portfolio before change:  [21.56202989]
curr_Stock_Price:  103.01185662878679
curr_Factors:  [103.01185663]
mat_Sqrt:  [[0.15]]
grads:  [0.01920812]
Stock Position:  0.019208115147515276
Bond Position:  [19.58336629]


portfolio before change:  [21.55378185]
curr_Stock_Price:  102.5187297484609
curr_Factors:  [102.51872975]
mat_Sqrt:  [[0.15]]
grads:  [0.05548938]
Stock Position:  0.05548937962201445
Bond Position:  [15.86508114]


portfolio before change:  [21.55115661]
curr_Stock_Price:  102.4535490336476
curr_Factors:  [102.45354903]
mat_Sqrt:  [[0.15]]
grads:  [0.06541513]
Stock Position:  0.0654151257778964
Bond Position:  [14.84914482]


portfolio before change:  [21.52865561]
curr_Stock_Price:  102.09538860028724
curr_Factors:  [102.0953886]
mat_Sqrt:  [[0.15]]
grads:  [0.10674958]
Stock Position:  0.10674958264584002
Bond Position:  [10.63001548]


portfolio before change:  [21.51770856]
curr_Stock_Price:  101.98661585981016
curr_Factors:  [101.98661586]
mat_Sqrt:  [[0.15]]
grads:  [0.18722237]
Stock Position:  0.18722236606600506
Bond Position:  [2.42353303]


portfolio before change:  [21.42039557]
curr_Stock_Price:  101.46603455876964
curr_Factors:  [101.46603456]
mat_Sqrt:  [[0.15]]
grads:  [-0.00085811]
Stock Position:  -0.0008581074027393804
Bond Position:  [21.50746433]


portfolio before change:  [21.4216324]
curr_Stock_Price:  101.59123004551608
curr_Factors:  [101.59123005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02692603]
Stock Position:  -0.02692602988269464
Bond Position:  [24.15708089]


portfolio before change:  [21.41908859]
curr_Stock_Price:  101.74177835217769
curr_Factors:  [101.74177835]
mat_Sqrt:  [[0.15]]
grads:  [0.08961552]
Stock Position:  0.08961551905394036
Bond Position:  [12.30144632]


portfolio before change:  [21.39849156]
curr_Stock_Price:  101.50336099280361
curr_Factors:  [101.50336099]
mat_Sqrt:  [[0.15]]
grads:  [0.08498842]
Stock Position:  0.08498841782020708
Bond Position:  [12.77188151]


portfolio before change:  [21.41191772]
curr_Stock_Price:  101.6519446919327
curr_Factors:  [101.65194469]
mat_Sqrt:  [[0.15]]
grads:  [0.04837984]
Stock Position:  0.04837983871048143
Bond Position:  [16.49401304]


portfolio before change:  [21.41630447]
curr_Stock_Price:  101.72130907152699
curr_Factors:  [101.72130907]
mat_Sqrt:  [[0.15]]
grads:  [0.04052954]
Stock Position:  0.0405295402177598
Bond Position:  [17.29358658]


portfolio before change:  [21.39999165]
curr_Stock_Price:  101.29214801147081
curr_Factors:  [101.29214801]
mat_Sqrt:  [[0.15]]
grads:  [0.07812994]
Stock Position:  0.0781299398079733
Bond Position:  [13.48604223]


portfolio before change:  [21.37636546]
curr_Stock_Price:  100.97896335907647
curr_Factors:  [100.97896336]
mat_Sqrt:  [[0.15]]
grads:  [-0.18432892]
Stock Position:  -0.18432892274940182
Bond Position:  [39.98970899]


portfolio before change:  [21.14214709]
curr_Stock_Price:  102.2631774596506
curr_Factors:  [102.26317746]
mat_Sqrt:  [[0.15]]
grads:  [-0.0134305]
Stock Position:  -0.01343050158139106
Bond Position:  [22.51559286]


portfolio before change:  [21.13084995]
curr_Stock_Price:  103.20911494093764
curr_Factors:  [103.20911494]
mat_Sqrt:  [[0.15]]
grads:  [-0.1313012]
Stock Position:  -0.13130120027180964
Bond Position:  [34.68233062]


portfolio before change:  [21.26664434]
curr_Stock_Price:  102.1914039010134
curr_Factors:  [102.1914039]
mat_Sqrt:  [[0.15]]
grads:  [-0.08599189]
Stock Position:  -0.08599189437172604
Bond Position:  [30.05427675]


portfolio before change:  [21.22253207]
curr_Stock_Price:  102.72623011579167
curr_Factors:  [102.72623012]
mat_Sqrt:  [[0.15]]
grads:  [0.02640978]
Stock Position:  0.026409777611020303
Bond Position:  [18.50955518]


portfolio before change:  [21.23494925]
curr_Stock_Price:  103.15259855554262
curr_Factors:  [103.15259856]
mat_Sqrt:  [[0.15]]
grads:  [0.06315933]
Stock Position:  0.06315933218323291
Bond Position:  [14.71990001]


portfolio before change:  [21.18057406]
curr_Stock_Price:  102.27711098948451
curr_Factors:  [102.27711099]
mat_Sqrt:  [[0.15]]
grads:  [-0.04352233]
Stock Position:  -0.04352232805215096
Bond Position:  [25.63191204]


portfolio before change:  [21.16260936]
curr_Stock_Price:  102.7266905008435
curr_Factors:  [102.7266905]
mat_Sqrt:  [[0.15]]
grads:  [0.00016628]
Stock Position:  0.00016627618263182221
Bond Position:  [21.14552836]


portfolio before change:  [21.16382787]
curr_Stock_Price:  102.10648306834631
curr_Factors:  [102.10648307]
mat_Sqrt:  [[0.15]]
grads:  [0.07534392]
Stock Position:  0.07534392399805209
Bond Position:  [13.47072477]


portfolio before change:  [21.14634313]
curr_Stock_Price:  101.86324259197877
curr_Factors:  [101.86324259]
mat_Sqrt:  [[0.15]]
grads:  [0.08590711]
Stock Position:  0.085907108559312
Bond Position:  [12.39556649]


portfolio before change:  [21.1705182]
curr_Stock_Price:  102.1356336372575
curr_Factors:  [102.13563364]
mat_Sqrt:  [[0.15]]
grads:  [0.07071077]
Stock Position:  0.07071077420462832
Bond Position:  [13.94842847]


portfolio before change:  [21.11300315]
curr_Stock_Price:  101.30991990813267
curr_Factors:  [101.30991991]
mat_Sqrt:  [[0.15]]
grads:  [0.01975067]
Stock Position:  0.019750670659662642
Bond Position:  [19.11206428]


portfolio before change:  [21.11491991]
curr_Stock_Price:  101.34648671776142
curr_Factors:  [101.34648672]
mat_Sqrt:  [[0.15]]
grads:  [0.08536431]
Stock Position:  0.0853643101756966
Bond Position:  [12.46354698]


portfolio before change:  [21.07740706]
curr_Stock_Price:  100.89791704983068
curr_Factors:  [100.89791705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01004479]
Stock Position:  -0.010044792170738144
Bond Position:  [22.09090567]


portfolio before change:  [21.08216456]
curr_Stock_Price:  100.56174567742043
curr_Factors:  [100.56174568]
mat_Sqrt:  [[0.15]]
grads:  [0.02692304]
Stock Position:  0.026923038684759152
Bond Position:  [18.37473679]


portfolio before change:  [21.10181948]
curr_Stock_Price:  101.24912950264918
curr_Factors:  [101.2491295]
mat_Sqrt:  [[0.15]]
grads:  [-0.1106013]
Stock Position:  -0.11060129597618054
Bond Position:  [32.30010442]


portfolio before change:  [21.05147303]
curr_Stock_Price:  101.7225893340791
curr_Factors:  [101.72258933]
mat_Sqrt:  [[0.15]]
grads:  [0.00853333]
Stock Position:  0.008533332853907364
Bond Position:  [20.18344031]


portfolio before change:  [21.05327836]
curr_Stock_Price:  101.78631955423522
curr_Factors:  [101.78631955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02710127]
Stock Position:  -0.02710126576593477
Bond Position:  [23.81181646]


portfolio before change:  [21.03946062]
curr_Stock_Price:  102.3510910924449
curr_Factors:  [102.35109109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494988]
Stock Position:  -0.014949879450994354
Bond Position:  [22.5695971]


portfolio before change:  [21.04387295]
curr_Stock_Price:  102.15030793006451
curr_Factors:  [102.15030793]
mat_Sqrt:  [[0.15]]
grads:  [-0.02195326]
Stock Position:  -0.021953261792546454
Bond Position:  [23.2864054]


portfolio before change:  [21.03833518]
curr_Stock_Price:  102.46885828815252
curr_Factors:  [102.46885829]
mat_Sqrt:  [[0.15]]
grads:  [0.07111173]
Stock Position:  0.07111173107251322
Bond Position:  [13.75159728]


portfolio before change:  [20.97213058]
curr_Stock_Price:  101.5257776554769
curr_Factors:  [101.52577766]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141849]
Stock Position:  -0.031418492034763726
Bond Position:  [24.16191742]


portfolio before change:  [20.9647848]
curr_Stock_Price:  101.80764837104206
curr_Factors:  [101.80764837]
mat_Sqrt:  [[0.15]]
grads:  [0.04433755]
Stock Position:  0.04433754854366166
Bond Position:  [16.45088325]


portfolio before change:  [20.99720462]
curr_Stock_Price:  102.51566258849692
curr_Factors:  [102.51566259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02595195]
Stock Position:  -0.025951946806208295
Bond Position:  [23.65768565]


portfolio before change:  [20.97152999]
curr_Stock_Price:  103.56195363829433
curr_Factors:  [103.56195364]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676182]
Stock Position:  -0.02676181705586686
Bond Position:  [23.74303604]


portfolio before change:  [20.97695183]
curr_Stock_Price:  103.41480896340151
curr_Factors:  [103.41480896]
mat_Sqrt:  [[0.15]]
grads:  [0.04248355]
Stock Position:  0.042483549399150576
Bond Position:  [16.58352369]


portfolio before change:  [20.94161836]
curr_Stock_Price:  102.55871338685323
curr_Factors:  [102.55871339]
mat_Sqrt:  [[0.15]]
grads:  [-0.11781753]
Stock Position:  -0.11781753008925099
Bond Position:  [33.02483266]


portfolio before change:  [20.89615033]
curr_Stock_Price:  102.9621520479013
curr_Factors:  [102.96215205]
mat_Sqrt:  [[0.15]]
grads:  [0.0180002]
Stock Position:  0.01800020401725314
Bond Position:  [19.04281058]


portfolio before change:  [20.88656558]
curr_Stock_Price:  102.36355003759815
curr_Factors:  [102.36355004]
mat_Sqrt:  [[0.15]]
grads:  [0.16488181]
Stock Position:  0.1648818121801171
Bond Position:  [4.00867795]


portfolio before change:  [21.01124626]
curr_Stock_Price:  103.11821262008763
curr_Factors:  [103.11821262]
mat_Sqrt:  [[0.15]]
grads:  [0.06139132]
Stock Position:  0.06139132291782905
Bond Position:  [14.68068277]


portfolio before change:  [21.01950082]
curr_Stock_Price:  103.23772436701961
curr_Factors:  [103.23772437]
mat_Sqrt:  [[0.15]]
grads:  [0.0838468]
Stock Position:  0.08384679898352711
Bond Position:  [12.3633481]


portfolio before change:  [21.08360951]
curr_Stock_Price:  103.99310147932889
curr_Factors:  [103.99310148]
mat_Sqrt:  [[0.15]]
grads:  [0.06868294]
Stock Position:  0.06868293500164355
Bond Position:  [13.94105808]


portfolio before change:  [21.07798453]
curr_Stock_Price:  103.89851728568117
curr_Factors:  [103.89851729]
mat_Sqrt:  [[0.15]]
grads:  [0.04414313]
Stock Position:  0.044143126819273834
Bond Position:  [16.4915791]


portfolio before change:  [21.09588149]
curr_Stock_Price:  104.28059725988402
curr_Factors:  [104.28059726]
mat_Sqrt:  [[0.15]]
grads:  [0.07458784]
Stock Position:  0.0745878448141354
Bond Position:  [13.31781648]


portfolio before change:  [21.09348384]
curr_Stock_Price:  104.23729203458905
curr_Factors:  [104.23729203]
mat_Sqrt:  [[0.15]]
grads:  [0.01152933]
Stock Position:  0.011529327676552136
Bond Position:  [19.89169794]


portfolio before change:  [21.0890581]
curr_Stock_Price:  103.74558873580231
curr_Factors:  [103.74558874]
mat_Sqrt:  [[0.15]]
grads:  [-0.10209785]
Stock Position:  -0.10209785380130078
Bond Position:  [31.68126005]


portfolio before change:  [21.12780702]
curr_Stock_Price:  103.38545601312249
curr_Factors:  [103.38545601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01763355]
Stock Position:  -0.01763355314421149
Bond Position:  [22.95085995]


portfolio before change:  [21.1271546]
curr_Stock_Price:  103.50380355846498
curr_Factors:  [103.50380356]
mat_Sqrt:  [[0.15]]
grads:  [0.00720955]
Stock Position:  0.007209547700306095
Bond Position:  [20.38093899]


portfolio before change:  [21.13041471]
curr_Stock_Price:  103.77930749898606
curr_Factors:  [103.7793075]
mat_Sqrt:  [[0.15]]
grads:  [0.01865368]
Stock Position:  0.018653677845739194
Bond Position:  [19.19454894]


portfolio before change:  [21.1273993]
curr_Stock_Price:  103.55334100130466
curr_Factors:  [103.553341]
mat_Sqrt:  [[0.15]]
grads:  [-0.117207]
Stock Position:  -0.11720700360961323
Bond Position:  [33.26457611]


portfolio before change:  [21.12720068]
curr_Stock_Price:  103.5727743069204
curr_Factors:  [103.57277431]
mat_Sqrt:  [[0.15]]
grads:  [-0.02295967]
Stock Position:  -0.022959674322802628
Bond Position:  [23.50519785]


portfolio before change:  [21.13554238]
curr_Stock_Price:  103.27344198103248
curr_Factors:  [103.27344198]
mat_Sqrt:  [[0.15]]
grads:  [0.08223783]
Stock Position:  0.08223782834360749
Bond Position:  [12.64255878]


portfolio before change:  [21.18640325]
curr_Stock_Price:  103.88229430795452
curr_Factors:  [103.88229431]
mat_Sqrt:  [[0.15]]
grads:  [-0.03522537]
Stock Position:  -0.035225366465672536
Bond Position:  [24.84569514]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.16820389]
Stock Price:  104.44303425244388
PL:  [16.72516964]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.31504193e-02]
 [-1.31820178e-02]
 [ 1.53086763e-02]
 [-1.09385973e-02]
 [ 1.09600269e-02]
 [-1.40572123e-02]
 [-1.85585918e-04]
 [-3.66530517e-03]
 [-9.97797868e-03]
 [-8.32125398e-03]
 [ 1.35643666e-02]
 [-7.01382352e-03]
 [-6.04861455e-04]
 [ 3.04311190e-03]
 [-1.45135082e-03]
 [ 9.10446510e-03]
 [-7.64192771e-04]
 [-1.17134453e-02]
 [ 2.48408934e-02]
 [-2.60233972e-03]
 [-1.28284669e-02]
 [ 5.42314142e-03]
 [ 1.43888265e-02]
 [ 2.05349482e-02]
 [-5.87491637e-03]
 [ 5.59570408e-03]
 [-3.78681176e-03]
 [ 5.75218329e-03]
 [ 3.06818850e-02]
 [ 5.23263534e-03]
 [-7.18298556e-03]
 [ 8.34500337e-03]
 [ 1.16398117e-02]
 [-1.08603875e-02]
 [ 6.10329402e-03]
 [ 1.16475895e-02]
 [-2.75982634e-02]
 [ 9.17614943e-04]
 [-3.77743340e-02]
 [-1.32165023e-02]
 [ 4.03923697e-03]
 [ 1.02683461e-02]
 [-6.57097654e-03]
 [-2.22944498e-03]
 [ 8.03660126e-03]
 [ 1.27178787e-02]
 [ 1.05529261e-02]
 [-6.00137866e-04]
 [ 1.28981412e-02]
 [-1.23140293e-03]
 [ 2.20327983e-02]
 [-8.96473059e-03]
 [-1.18962277e-03]
 [-1.06193000e-02]
 [-2.22175505e-03]
 [-3.50008240e-03]
 [ 1.06247145e-02]
 [-5.57988995e-03]
 [ 6.69174778e-03]
 [-3.99878584e-03]
 [-9.04453746e-04]
 [ 6.12671528e-03]
 [-8.56180753e-03]
 [ 7.69825533e-03]
 [ 2.51408763e-02]
 [ 5.47449962e-03]
 [ 8.06518244e-03]
 [-4.31452589e-04]
 [ 2.78215566e-03]
 [ 2.29471040e-02]
 [ 3.46490417e-03]
 [-1.54717510e-02]
 [-5.45550359e-03]
 [ 1.78351222e-03]
 [ 9.43265405e-03]
 [ 1.29757846e-03]
 [-1.50882428e-03]
 [-6.99575664e-03]
 [-2.33598266e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.31163229]
curr_Stock_Price:  99.48489032156303
curr_Factors:  [99.48489032]
mat_Sqrt:  [[0.15]]
grads:  [-0.08766946]
Stock Position:  -0.08766946169539878
Bond Position:  [-0.58984551]


portfolio before change:  [-9.28481073]
curr_Stock_Price:  99.17853010336475
curr_Factors:  [99.1785301]
mat_Sqrt:  [[0.15]]
grads:  [-0.08788012]
Stock Position:  -0.08788011840154954
Bond Position:  [-0.56898976]


portfolio before change:  [-9.29403735]
curr_Stock_Price:  99.28311650037391
curr_Factors:  [99.2831165]
mat_Sqrt:  [[0.15]]
grads:  [0.10205784]
Stock Position:  0.10205784185033327
Bond Position:  [-19.42665796]


portfolio before change:  [-9.3205199]
curr_Stock_Price:  99.035528097171
curr_Factors:  [99.0355281]
mat_Sqrt:  [[0.15]]
grads:  [-0.07292398]
Stock Position:  -0.07292398178111573
Bond Position:  [-2.09845485]


portfolio before change:  [-9.29395364]
curr_Stock_Price:  98.66942884938011
curr_Factors:  [98.66942885]
mat_Sqrt:  [[0.15]]
grads:  [0.07306685]
Stock Position:  0.07306684572402537
Bond Position:  [-16.50341757]


portfolio before change:  [-9.2874649]
curr_Stock_Price:  98.77235148119118
curr_Factors:  [98.77235148]
mat_Sqrt:  [[0.15]]
grads:  [-0.09371475]
Stock Position:  -0.09371474856029496
Bond Position:  [-0.03103882]


portfolio before change:  [-9.35223687]
curr_Stock_Price:  99.4634916367305
curr_Factors:  [99.46349164]
mat_Sqrt:  [[0.15]]
grads:  [-0.00123724]
Stock Position:  -0.0012372394507502323
Bond Position:  [-9.22917671]


portfolio before change:  [-9.35318009]
curr_Stock_Price:  99.75962178605411
curr_Factors:  [99.75962179]
mat_Sqrt:  [[0.15]]
grads:  [-0.02443537]
Stock Position:  -0.02443536779883855
Bond Position:  [-6.91551704]


portfolio before change:  [-9.35214845]
curr_Stock_Price:  99.69971364812966
curr_Factors:  [99.69971365]
mat_Sqrt:  [[0.15]]
grads:  [-0.06651986]
Stock Position:  -0.06651985788668596
Bond Position:  [-2.72013767]


portfolio before change:  [-9.33451355]
curr_Stock_Price:  99.43205046461568
curr_Factors:  [99.43205046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05547503]
Stock Position:  -0.05547502652274997
Bond Position:  [-3.81851791]


portfolio before change:  [-9.32860416]
curr_Stock_Price:  99.32122481158378
curr_Factors:  [99.32122481]
mat_Sqrt:  [[0.15]]
grads:  [0.09042911]
Stock Position:  0.09042911035622983
Bond Position:  [-18.31013415]


portfolio before change:  [-9.34237357]
curr_Stock_Price:  99.18161271536192
curr_Factors:  [99.18161272]
mat_Sqrt:  [[0.15]]
grads:  [-0.04675882]
Stock Position:  -0.04675882348830575
Bond Position:  [-4.70475805]


portfolio before change:  [-9.34116346]
curr_Stock_Price:  99.14944397036092
curr_Factors:  [99.14944397]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403241]
Stock Position:  -0.004032409701694833
Bond Position:  [-8.94135228]


portfolio before change:  [-9.34032645]
curr_Stock_Price:  98.80328482515004
curr_Factors:  [98.80328483]
mat_Sqrt:  [[0.15]]
grads:  [0.02028741]
Stock Position:  0.020287412636385865
Bond Position:  [-11.34478946]


portfolio before change:  [-9.33380226]
curr_Stock_Price:  99.15982420307708
curr_Factors:  [99.1598242]
mat_Sqrt:  [[0.15]]
grads:  [-0.00967567]
Stock Position:  -0.009675672165418633
Bond Position:  [-8.37436431]


portfolio before change:  [-9.3314453]
curr_Stock_Price:  98.86213177685386
curr_Factors:  [98.86213178]
mat_Sqrt:  [[0.15]]
grads:  [0.06069643]
Stock Position:  0.060696433980078
Bond Position:  [-15.33202416]


portfolio before change:  [-9.35491571]
curr_Stock_Price:  98.49123480147172
curr_Factors:  [98.4912348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00509462]
Stock Position:  -0.005094618470007547
Bond Position:  [-8.85314044]


portfolio before change:  [-9.35029148]
curr_Stock_Price:  97.47495386089786
curr_Factors:  [97.47495386]
mat_Sqrt:  [[0.15]]
grads:  [-0.07808964]
Stock Position:  -0.07808963520271879
Bond Position:  [-1.73850789]


portfolio before change:  [-9.37101771]
curr_Stock_Price:  97.73897827153336
curr_Factors:  [97.73897827]
mat_Sqrt:  [[0.15]]
grads:  [0.16560596]
Stock Position:  0.16560595605537226
Bond Position:  [-25.55717465]


portfolio before change:  [-9.40876278]
curr_Stock_Price:  97.52070293438163
curr_Factors:  [97.52070293]
mat_Sqrt:  [[0.15]]
grads:  [-0.01734893]
Stock Position:  -0.017348931447774562
Bond Position:  [-7.71688279]


portfolio before change:  [-9.41186643]
curr_Stock_Price:  97.67179764012828
curr_Factors:  [97.67179764]
mat_Sqrt:  [[0.15]]
grads:  [-0.08552311]
Stock Position:  -0.08552311249065021
Bond Position:  [-1.0586703]


portfolio before change:  [-9.49317682]
curr_Stock_Price:  98.62176561111104
curr_Factors:  [98.62176561]
mat_Sqrt:  [[0.15]]
grads:  [0.03615428]
Stock Position:  0.03615427611940894
Bond Position:  [-13.05877537]


portfolio before change:  [-9.50973878]
curr_Stock_Price:  98.1862497721696
curr_Factors:  [98.18624977]
mat_Sqrt:  [[0.15]]
grads:  [0.09592551]
Stock Position:  0.09592551028605496
Bond Position:  [-18.92830489]


portfolio before change:  [-9.53151013]
curr_Stock_Price:  97.97162183990844
curr_Factors:  [97.97162184]
mat_Sqrt:  [[0.15]]
grads:  [0.13689965]
Stock Position:  0.13689965462864714
Bond Position:  [-22.94379132]


portfolio before change:  [-9.36942453]
curr_Stock_Price:  99.1660706869484
curr_Factors:  [99.16607069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03916611]
Stock Position:  -0.03916610916503171
Bond Position:  [-5.48547538]


portfolio before change:  [-9.42021689]
curr_Stock_Price:  100.45416158646925
curr_Factors:  [100.45416159]
mat_Sqrt:  [[0.15]]
grads:  [0.03730469]
Stock Position:  0.037304693855230026
Bond Position:  [-13.16762863]


portfolio before change:  [-9.41982188]
curr_Stock_Price:  100.48681201132977
curr_Factors:  [100.48681201]
mat_Sqrt:  [[0.15]]
grads:  [-0.02524541]
Stock Position:  -0.025245411730450487
Bond Position:  [-6.88299093]


portfolio before change:  [-9.42621722]
curr_Stock_Price:  100.72309840803209
curr_Factors:  [100.72309841]
mat_Sqrt:  [[0.15]]
grads:  [0.03834789]
Stock Position:  0.03834788858983568
Bond Position:  [-13.28873538]


portfolio before change:  [-9.4374352]
curr_Stock_Price:  100.45222544256748
curr_Factors:  [100.45222544]
mat_Sqrt:  [[0.15]]
grads:  [0.2045459]
Stock Position:  0.20454589973335266
Bond Position:  [-29.98452604]


portfolio before change:  [-9.36371265]
curr_Stock_Price:  100.821808205492
curr_Factors:  [100.82180821]
mat_Sqrt:  [[0.15]]
grads:  [0.03488424]
Stock Position:  0.034884235626684225
Bond Position:  [-12.88080437]


portfolio before change:  [-9.37299206]
curr_Stock_Price:  100.57888089186339
curr_Factors:  [100.57888089]
mat_Sqrt:  [[0.15]]
grads:  [-0.04788657]
Stock Position:  -0.047886570407736286
Bond Position:  [-4.5566144]


portfolio before change:  [-9.34951847]
curr_Stock_Price:  100.08274189038272
curr_Factors:  [100.08274189]
mat_Sqrt:  [[0.15]]
grads:  [0.05563336]
Stock Position:  0.055633355775867754
Bond Position:  [-14.91745725]


portfolio before change:  [-9.39561932]
curr_Stock_Price:  99.27084608116866
curr_Factors:  [99.27084608]
mat_Sqrt:  [[0.15]]
grads:  [0.07759874]
Stock Position:  0.07759874473729159
Bond Position:  [-17.09891237]


portfolio before change:  [-9.39725519]
curr_Stock_Price:  99.26353728983001
curr_Factors:  [99.26353729]
mat_Sqrt:  [[0.15]]
grads:  [-0.07240258]
Stock Position:  -0.07240258339709431
Bond Position:  [-2.21031866]


portfolio before change:  [-9.47087417]
curr_Stock_Price:  100.2784296376425
curr_Factors:  [100.27842964]
mat_Sqrt:  [[0.15]]
grads:  [0.04068863]
Stock Position:  0.040688626829992657
Bond Position:  [-13.55106577]


portfolio before change:  [-9.45825635]
curr_Stock_Price:  100.60935219054628
curr_Factors:  [100.60935219]
mat_Sqrt:  [[0.15]]
grads:  [0.0776506]
Stock Position:  0.07765059636544773
Bond Position:  [-17.27063255]


portfolio before change:  [-9.43589126]
curr_Stock_Price:  100.91127574571728
curr_Factors:  [100.91127575]
mat_Sqrt:  [[0.15]]
grads:  [-0.18398842]
Stock Position:  -0.1839884228586343
Bond Position:  [9.13061522]


portfolio before change:  [-9.5734176]
curr_Stock_Price:  101.66185027812783
curr_Factors:  [101.66185028]
mat_Sqrt:  [[0.15]]
grads:  [0.00611743]
Stock Position:  0.006117432950305391
Bond Position:  [-10.19532715]


portfolio before change:  [-9.57232937]
curr_Stock_Price:  101.94390566656982
curr_Factors:  [101.94390567]
mat_Sqrt:  [[0.15]]
grads:  [-0.25182889]
Stock Position:  -0.25182889332061303
Bond Position:  [16.10009157]


portfolio before change:  [-9.66188205]
curr_Stock_Price:  102.30351081424217
curr_Factors:  [102.30351081]
mat_Sqrt:  [[0.15]]
grads:  [-0.08811002]
Stock Position:  -0.08811001501265078
Bond Position:  [-0.64791818]


portfolio before change:  [-9.6791593]
curr_Stock_Price:  102.49913837825582
curr_Factors:  [102.49913838]
mat_Sqrt:  [[0.15]]
grads:  [0.02692825]
Stock Position:  0.026928246480118156
Bond Position:  [-12.43928136]


portfolio before change:  [-9.67078366]
curr_Stock_Price:  102.83904601706429
curr_Factors:  [102.83904602]
mat_Sqrt:  [[0.15]]
grads:  [0.06845564]
Stock Position:  0.06845564043979803
Bond Position:  [-16.71069642]


portfolio before change:  [-9.70932208]
curr_Stock_Price:  102.29133418818469
curr_Factors:  [102.29133419]
mat_Sqrt:  [[0.15]]
grads:  [-0.04380651]
Stock Position:  -0.04380651027179686
Bond Position:  [-5.22829569]


portfolio before change:  [-9.70625362]
curr_Stock_Price:  102.2138288671108
curr_Factors:  [102.21382887]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486297]
Stock Position:  -0.014862966534865497
Bond Position:  [-8.1870529]


portfolio before change:  [-9.71543756]
curr_Stock_Price:  102.79730824457188
curr_Factors:  [102.79730824]
mat_Sqrt:  [[0.15]]
grads:  [0.05357734]
Stock Position:  0.053577341735261456
Bond Position:  [-15.22304407]


portfolio before change:  [-9.76017224]
curr_Stock_Price:  101.98011180265375
curr_Factors:  [101.9801118]
mat_Sqrt:  [[0.15]]
grads:  [0.08478586]
Stock Position:  0.08478585780910167
Bond Position:  [-18.4066435]


portfolio before change:  [-9.69937419]
curr_Stock_Price:  102.7107584579783
curr_Factors:  [102.71075846]
mat_Sqrt:  [[0.15]]
grads:  [0.07035284]
Stock Position:  0.07035284040306483
Bond Position:  [-16.92536779]


portfolio before change:  [-9.71474548]
curr_Stock_Price:  102.5073065051521
curr_Factors:  [102.50730651]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400092]
Stock Position:  -0.004000919104337123
Bond Position:  [-9.30462204]


portfolio before change:  [-9.71604577]
curr_Stock_Price:  102.68694856273811
curr_Factors:  [102.68694856]
mat_Sqrt:  [[0.15]]
grads:  [0.08598761]
Stock Position:  0.08598760784516114
Bond Position:  [-18.54585083]


portfolio before change:  [-9.66600019]
curr_Stock_Price:  103.28243821171655
curr_Factors:  [103.28243821]
mat_Sqrt:  [[0.15]]
grads:  [-0.00820935]
Stock Position:  -0.0082093528771805
Bond Position:  [-8.81811821]


portfolio before change:  [-9.66020278]
curr_Stock_Price:  102.50910497750742
curr_Factors:  [102.50910498]
mat_Sqrt:  [[0.15]]
grads:  [0.14688532]
Stock Position:  0.14688532181532388
Bond Position:  [-24.71728565]


portfolio before change:  [-9.66804622]
curr_Stock_Price:  102.46622417092152
curr_Factors:  [102.46622417]
mat_Sqrt:  [[0.15]]
grads:  [-0.05976487]
Stock Position:  -0.05976487062903057
Bond Position:  [-3.54416558]


portfolio before change:  [-9.70840097]
curr_Stock_Price:  103.13774299475362
curr_Factors:  [103.13774299]
mat_Sqrt:  [[0.15]]
grads:  [-0.00793082]
Stock Position:  -0.007930818472209555
Bond Position:  [-8.89043425]


portfolio before change:  [-9.70394819]
curr_Stock_Price:  102.50622553081206
curr_Factors:  [102.50622553]
mat_Sqrt:  [[0.15]]
grads:  [-0.07079533]
Stock Position:  -0.07079533328710598
Bond Position:  [-2.44698579]


portfolio before change:  [-9.69368187]
curr_Stock_Price:  102.35905117548151
curr_Factors:  [102.35905118]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148117]
Stock Position:  -0.014811700322569727
Bond Position:  [-8.17757028]


portfolio before change:  [-9.68031166]
curr_Stock_Price:  101.42186439774385
curr_Factors:  [101.4218644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333388]
Stock Position:  -0.023333882658089958
Bond Position:  [-7.31374577]


portfolio before change:  [-9.70132836]
curr_Stock_Price:  102.30296863326618
curr_Factors:  [102.30296863]
mat_Sqrt:  [[0.15]]
grads:  [0.07083143]
Stock Position:  0.0708314298310645
Bond Position:  [-16.94759391]


portfolio before change:  [-9.74194275]
curr_Stock_Price:  101.74452829418205
curr_Factors:  [101.74452829]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719927]
Stock Position:  -0.037199266338697794
Bond Position:  [-5.95712094]


portfolio before change:  [-9.74124784]
curr_Stock_Price:  101.7158383804253
curr_Factors:  [101.71583838]
mat_Sqrt:  [[0.15]]
grads:  [0.04461165]
Stock Position:  0.04461165185617864
Bond Position:  [-14.27895941]


portfolio before change:  [-9.7751038]
curr_Stock_Price:  100.976939484558
curr_Factors:  [100.97693948]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665857]
Stock Position:  -0.02665857224901169
Bond Position:  [-7.08320276]


portfolio before change:  [-9.76689666]
curr_Stock_Price:  100.65247142740884
curr_Factors:  [100.65247143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00602969]
Stock Position:  -0.006029691640095792
Bond Position:  [-9.15999329]


portfolio before change:  [-9.76729396]
curr_Stock_Price:  100.62341237018794
curr_Factors:  [100.62341237]
mat_Sqrt:  [[0.15]]
grads:  [0.04084477]
Stock Position:  0.040844768535393323
Bond Position:  [-13.87723394]


portfolio before change:  [-9.77218531]
curr_Stock_Price:  100.52489308687913
curr_Factors:  [100.52489309]
mat_Sqrt:  [[0.15]]
grads:  [-0.05707872]
Stock Position:  -0.057078716869404814
Bond Position:  [-4.0343534]


portfolio before change:  [-9.78960049]
curr_Stock_Price:  100.82558356566602
curr_Factors:  [100.82558357]
mat_Sqrt:  [[0.15]]
grads:  [0.0513217]
Stock Position:  0.05132170219513895
Bond Position:  [-14.96414106]


portfolio before change:  [-9.79628955]
curr_Stock_Price:  100.71347170982985
curr_Factors:  [100.71347171]
mat_Sqrt:  [[0.15]]
grads:  [0.16760584]
Stock Position:  0.16760584214466825
Bond Position:  [-26.67645579]


portfolio before change:  [-9.93016239]
curr_Stock_Price:  99.92468353388918
curr_Factors:  [99.92468353]
mat_Sqrt:  [[0.15]]
grads:  [0.03649666]
Stock Position:  0.03649666415032803
Bond Position:  [-13.57708]


portfolio before change:  [-9.94805554]
curr_Stock_Price:  99.4576667434478
curr_Factors:  [99.45766674]
mat_Sqrt:  [[0.15]]
grads:  [0.05376788]
Stock Position:  0.053767882965503916
Bond Position:  [-15.29568372]


portfolio before change:  [-9.9962439]
curr_Stock_Price:  98.5792174908079
curr_Factors:  [98.57921749]
mat_Sqrt:  [[0.15]]
grads:  [-0.00287635]
Stock Position:  -0.0028763505924623285
Bond Position:  [-9.71269551]


portfolio before change:  [-9.99719703]
curr_Stock_Price:  98.69953304937466
curr_Factors:  [98.69953305]
mat_Sqrt:  [[0.15]]
grads:  [0.0185477]
Stock Position:  0.018547704408364365
Bond Position:  [-11.8278468]


portfolio before change:  [-10.01686798]
curr_Stock_Price:  97.67883089095258
curr_Factors:  [97.67883089]
mat_Sqrt:  [[0.15]]
grads:  [0.15298069]
Stock Position:  0.15298069323614433
Bond Position:  [-24.95984324]


portfolio before change:  [-10.09230688]
curr_Stock_Price:  97.19590159796952
curr_Factors:  [97.1959016]
mat_Sqrt:  [[0.15]]
grads:  [0.02309936]
Stock Position:  0.023099361115392736
Bond Position:  [-12.33747011]


portfolio before change:  [-10.10031966]
curr_Stock_Price:  96.88240098903451
curr_Factors:  [96.88240099]
mat_Sqrt:  [[0.15]]
grads:  [-0.10314501]
Stock Position:  -0.10314500672956536
Bond Position:  [-0.10738376]


portfolio before change:  [-10.13580366]
curr_Stock_Price:  97.22635646543415
curr_Factors:  [97.22635647]
mat_Sqrt:  [[0.15]]
grads:  [-0.03637002]
Stock Position:  -0.036370023928377695
Bond Position:  [-6.59967875]


portfolio before change:  [-10.11737391]
curr_Stock_Price:  96.70828573463544
curr_Factors:  [96.70828573]
mat_Sqrt:  [[0.15]]
grads:  [0.01189008]
Stock Position:  0.011890081480536288
Bond Position:  [-11.2672433]


portfolio before change:  [-10.11395835]
curr_Stock_Price:  97.05477445544349
curr_Factors:  [97.05477446]
mat_Sqrt:  [[0.15]]
grads:  [0.06288436]
Stock Position:  0.0628843603068865
Bond Position:  [-16.21718576]


portfolio before change:  [-10.09975798]
curr_Stock_Price:  97.29671023377192
curr_Factors:  [97.29671023]
mat_Sqrt:  [[0.15]]
grads:  [0.00865052]
Stock Position:  0.008650523095648071
Bond Position:  [-10.94142542]


portfolio before change:  [-10.09658621]
curr_Stock_Price:  97.74242060004713
curr_Factors:  [97.7424206]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005883]
Stock Position:  -0.010058828514058442
Bond Position:  [-9.11341197]


portfolio before change:  [-10.09313928]
curr_Stock_Price:  97.3431154747694
curr_Factors:  [97.34311547]
mat_Sqrt:  [[0.15]]
grads:  [-0.04663838]
Stock Position:  -0.04663837761112824
Bond Position:  [-5.5532143]


portfolio before change:  [-10.12026116]
curr_Stock_Price:  97.91720903076283
curr_Factors:  [97.91720903]
mat_Sqrt:  [[0.15]]
grads:  [-0.15573218]
Stock Position:  -0.15573217757443414
Bond Position:  [5.12859903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.15013296]
Stock Price:  98.11108255869885
PL:  [-10.15013296]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.02617676e-03]
 [ 7.14030073e-03]
 [ 1.33488173e-02]
 [-7.05163962e-03]
 [ 1.37443683e-02]
 [-1.33827163e-03]
 [-1.02300096e-02]
 [-4.27468275e-02]
 [ 1.03460080e-02]
 [ 1.04968110e-03]
 [ 8.62329615e-03]
 [ 3.84991105e-03]
 [-2.40495962e-03]
 [ 6.36734368e-03]
 [-2.43268305e-03]
 [ 1.35793157e-02]
 [ 6.46094594e-02]
 [-1.26903563e-02]
 [ 2.18036594e-02]
 [ 8.27187975e-04]
 [-6.26048519e-03]
 [ 5.65176501e-03]
 [ 1.00454132e-02]
 [ 1.99520540e-02]
 [-1.87907706e-03]
 [ 7.69401566e-03]
 [-4.80336021e-03]
 [ 1.32838432e-02]
 [ 2.98695164e-02]
 [-8.20373185e-03]
 [-2.79415359e-03]
 [ 1.36043211e-02]
 [ 1.28604863e-02]
 [ 8.76337714e-03]
 [ 5.69694645e-03]
 [ 1.72862965e-02]
 [-1.71281065e-02]
 [ 3.36989955e-03]
 [-5.71716602e-02]
 [ 1.41912022e-02]
 [ 6.21068998e-03]
 [ 8.64018924e-03]
 [-4.12108721e-03]
 [-4.68145215e-03]
 [ 1.37223340e-02]
 [ 1.22553572e-02]
 [ 1.05684928e-02]
 [-5.44612918e-04]
 [ 1.63336784e-02]
 [-1.18645998e-03]
 [ 1.72029691e-02]
 [-1.27767335e-02]
 [ 1.91716099e-03]
 [ 2.39835160e-03]
 [-3.61775248e-03]
 [-3.51845310e-03]
 [ 1.02049998e-02]
 [-2.77412366e-03]
 [ 6.94193382e-03]
 [-4.01116306e-03]
 [-1.96124564e-04]
 [ 4.98121426e-03]
 [-7.67436161e-03]
 [ 6.69388764e-03]
 [ 2.15778135e-02]
 [ 5.29461257e-03]
 [ 9.90219506e-03]
 [-3.14187824e-04]
 [ 2.79020516e-03]
 [ 2.19345210e-02]
 [ 1.68259297e-03]
 [-1.59569668e-02]
 [-6.38694984e-03]
 [ 1.00523819e-03]
 [ 5.74427728e-03]
 [-4.67562623e-04]
 [-1.44285928e-03]
 [ 2.71525212e-03]
 [-2.39089078e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.6350051]
curr_Stock_Price:  100.29998981407753
curr_Factors:  [100.29998981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02017451]
Stock Position:  -0.020174511736266693
Bond Position:  [10.65850842]


portfolio before change:  [8.64508354]
curr_Stock_Price:  99.83344740852135
curr_Factors:  [99.83344741]
mat_Sqrt:  [[0.15]]
grads:  [0.047602]
Stock Position:  0.04760200484637392
Bond Position:  [3.89281129]


portfolio before change:  [8.62128549]
curr_Stock_Price:  99.32839804770921
curr_Factors:  [99.32839805]
mat_Sqrt:  [[0.15]]
grads:  [0.08899212]
Stock Position:  0.08899211521497975
Bond Position:  [-0.21815876]


portfolio before change:  [8.68821917]
curr_Stock_Price:  100.0806817809159
curr_Factors:  [100.08068178]
mat_Sqrt:  [[0.15]]
grads:  [-0.04701093]
Stock Position:  -0.047010930790860224
Bond Position:  [13.39310518]


portfolio before change:  [8.70517822]
curr_Stock_Price:  99.7377413303914
curr_Factors:  [99.73774133]
mat_Sqrt:  [[0.15]]
grads:  [0.09162912]
Stock Position:  0.09162912230010856
Bond Position:  [-0.43370348]


portfolio before change:  [8.81118262]
curr_Stock_Price:  100.89492268832404
curr_Factors:  [100.89492269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00892181]
Stock Position:  -0.00892181086945614
Bond Position:  [9.71134804]


portfolio before change:  [8.81151096]
curr_Stock_Price:  100.92615428379203
curr_Factors:  [100.92615428]
mat_Sqrt:  [[0.15]]
grads:  [-0.06820006]
Stock Position:  -0.06820006373416106
Bond Position:  [15.69468111]


portfolio before change:  [8.74484137]
curr_Stock_Price:  101.91809674651667
curr_Factors:  [101.91809675]
mat_Sqrt:  [[0.15]]
grads:  [-0.28497885]
Stock Position:  -0.28497884995504025
Bond Position:  [37.78934337]


portfolio before change:  [8.9839195]
curr_Stock_Price:  101.08745185009259
curr_Factors:  [101.08745185]
mat_Sqrt:  [[0.15]]
grads:  [0.06897339]
Stock Position:  0.06897338635020961
Bond Position:  [2.01157563]


portfolio before change:  [8.93635564]
curr_Stock_Price:  100.39603170553552
curr_Factors:  [100.39603171]
mat_Sqrt:  [[0.15]]
grads:  [0.00699787]
Stock Position:  0.00699787403013491
Bond Position:  [8.23379686]


portfolio before change:  [8.93623877]
curr_Stock_Price:  100.30579004730374
curr_Factors:  [100.30579005]
mat_Sqrt:  [[0.15]]
grads:  [0.05748864]
Stock Position:  0.05748864097493967
Bond Position:  [3.16979522]


portfolio before change:  [8.96601667]
curr_Stock_Price:  100.82032269303083
curr_Factors:  [100.82032269]
mat_Sqrt:  [[0.15]]
grads:  [0.02566607]
Stock Position:  0.025666073673871206
Bond Position:  [6.37835484]


portfolio before change:  [8.95180296]
curr_Stock_Price:  100.25099631836251
curr_Factors:  [100.25099632]
mat_Sqrt:  [[0.15]]
grads:  [-0.01603306]
Stock Position:  -0.016033064156188114
Bond Position:  [10.55913361]


portfolio before change:  [8.94298019]
curr_Stock_Price:  100.8424445981113
curr_Factors:  [100.8424446]
mat_Sqrt:  [[0.15]]
grads:  [0.04244896]
Stock Position:  0.04244895789197726
Bond Position:  [4.66232351]


portfolio before change:  [8.92755212]
curr_Stock_Price:  100.4721297246968
curr_Factors:  [100.47212972]
mat_Sqrt:  [[0.15]]
grads:  [-0.01621789]
Stock Position:  -0.016217887001140907
Bond Position:  [10.55699776]


portfolio before change:  [8.93253087]
curr_Stock_Price:  100.20582360975452
curr_Factors:  [100.20582361]
mat_Sqrt:  [[0.15]]
grads:  [0.09052877]
Stock Position:  0.09052877123790905
Bond Position:  [-0.13897921]


portfolio before change:  [9.03729967]
curr_Stock_Price:  101.36321790843094
curr_Factors:  [101.36321791]
mat_Sqrt:  [[0.15]]
grads:  [0.43072973]
Stock Position:  0.4307297294652823
Bond Position:  [-34.62285176]


portfolio before change:  [9.28625365]
curr_Stock_Price:  101.94622381167555
curr_Factors:  [101.94622381]
mat_Sqrt:  [[0.15]]
grads:  [-0.08460238]
Stock Position:  -0.08460237538217312
Bond Position:  [17.91114635]


portfolio before change:  [9.25472908]
curr_Stock_Price:  102.33207641496868
curr_Factors:  [102.33207641]
mat_Sqrt:  [[0.15]]
grads:  [0.14535773]
Stock Position:  0.1453577292327441
Bond Position:  [-5.62002917]


portfolio before change:  [9.27867291]
curr_Stock_Price:  102.49921642525518
curr_Factors:  [102.49921643]
mat_Sqrt:  [[0.15]]
grads:  [0.00551459]
Stock Position:  0.0055145864991207934
Bond Position:  [8.71343212]


portfolio before change:  [9.28119305]
curr_Stock_Price:  102.85745317043806
curr_Factors:  [102.85745317]
mat_Sqrt:  [[0.15]]
grads:  [-0.04173657]
Stock Position:  -0.041736567921336266
Bond Position:  [13.57411013]


portfolio before change:  [9.28939488]
curr_Stock_Price:  102.68126664357636
curr_Factors:  [102.68126664]
mat_Sqrt:  [[0.15]]
grads:  [0.03767843]
Stock Position:  0.03767843337328809
Bond Position:  [5.42052561]


portfolio before change:  [9.26541799]
curr_Stock_Price:  102.03591926932096
curr_Factors:  [102.03591927]
mat_Sqrt:  [[0.15]]
grads:  [0.06696942]
Stock Position:  0.06696942146170336
Bond Position:  [2.43213151]


portfolio before change:  [9.19871458]
curr_Stock_Price:  101.03762148401704
curr_Factors:  [101.03762148]
mat_Sqrt:  [[0.15]]
grads:  [0.13301369]
Stock Position:  0.13301369326766105
Bond Position:  [-4.24067261]


portfolio before change:  [9.2409479]
curr_Stock_Price:  101.35712520301138
curr_Factors:  [101.3571252]
mat_Sqrt:  [[0.15]]
grads:  [-0.01252718]
Stock Position:  -0.012527180420088003
Bond Position:  [10.51066689]


portfolio before change:  [9.23663625]
curr_Stock_Price:  101.75374949517199
curr_Factors:  [101.7537495]
mat_Sqrt:  [[0.15]]
grads:  [0.05129344]
Stock Position:  0.05129343774867157
Bond Position:  [4.01733664]


portfolio before change:  [9.22420125]
curr_Stock_Price:  101.50642550556883
curr_Factors:  [101.50642551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0320224]
Stock Position:  -0.03202240142939336
Bond Position:  [12.47468075]


portfolio before change:  [9.2189946]
curr_Stock_Price:  101.69336778021353
curr_Factors:  [101.69336778]
mat_Sqrt:  [[0.15]]
grads:  [0.08855895]
Stock Position:  0.08855895470068022
Bond Position:  [0.21313625]


portfolio before change:  [9.22810925]
curr_Stock_Price:  101.79613924267699
curr_Factors:  [101.79613924]
mat_Sqrt:  [[0.15]]
grads:  [0.19913011]
Stock Position:  0.19913010951706486
Bond Position:  [-11.0425671]


portfolio before change:  [9.39436285]
curr_Stock_Price:  102.63450458085411
curr_Factors:  [102.63450458]
mat_Sqrt:  [[0.15]]
grads:  [-0.05469155]
Stock Position:  -0.054691545642749965
Bond Position:  [15.00760254]


portfolio before change:  [9.43574553]
curr_Stock_Price:  101.89499947933301
curr_Factors:  [101.89499948]
mat_Sqrt:  [[0.15]]
grads:  [-0.01862769]
Stock Position:  -0.018627690617802582
Bond Position:  [11.33381406]


portfolio before change:  [9.43102117]
curr_Stock_Price:  102.18664873373666
curr_Factors:  [102.18664873]
mat_Sqrt:  [[0.15]]
grads:  [0.09069547]
Stock Position:  0.09069547407753804
Bond Position:  [0.16315462]


portfolio before change:  [9.38017474]
curr_Stock_Price:  101.6259082401047
curr_Factors:  [101.62590824]
mat_Sqrt:  [[0.15]]
grads:  [0.08573658]
Stock Position:  0.08573657557468933
Bond Position:  [0.66711738]


portfolio before change:  [9.34697912]
curr_Stock_Price:  101.238240373191
curr_Factors:  [101.23824037]
mat_Sqrt:  [[0.15]]
grads:  [0.05842251]
Stock Position:  0.05842251424742685
Bond Position:  [3.43238658]


portfolio before change:  [9.30718157]
curr_Stock_Price:  100.55336606491576
curr_Factors:  [100.55336606]
mat_Sqrt:  [[0.15]]
grads:  [0.03797964]
Stock Position:  0.03797964302272968
Bond Position:  [5.48820063]


portfolio before change:  [9.27231883]
curr_Stock_Price:  99.62640203471939
curr_Factors:  [99.62640203]
mat_Sqrt:  [[0.15]]
grads:  [0.11524198]
Stock Position:  0.11524197679626226
Bond Position:  [-2.20882468]


portfolio before change:  [9.3221873]
curr_Stock_Price:  100.06032829309368
curr_Factors:  [100.06032829]
mat_Sqrt:  [[0.15]]
grads:  [-0.11418738]
Stock Position:  -0.11418737663322992
Bond Position:  [20.74781369]


portfolio before change:  [9.35340161]
curr_Stock_Price:  99.79832441087325
curr_Factors:  [99.79832441]
mat_Sqrt:  [[0.15]]
grads:  [0.022466]
Stock Position:  0.022465996995277612
Bond Position:  [7.11133276]


portfolio before change:  [9.35624664]
curr_Stock_Price:  99.90517736772397
curr_Factors:  [99.90517737]
mat_Sqrt:  [[0.15]]
grads:  [-0.3811444]
Stock Position:  -0.3811444014146078
Bond Position:  [47.43454567]


portfolio before change:  [9.14139482]
curr_Stock_Price:  100.47665780964154
curr_Factors:  [100.47665781]
mat_Sqrt:  [[0.15]]
grads:  [0.09460801]
Stock Position:  0.09460801480520908
Bond Position:  [-0.36450231]


portfolio before change:  [9.18885195]
curr_Stock_Price:  100.97851704740785
curr_Factors:  [100.97851705]
mat_Sqrt:  [[0.15]]
grads:  [0.0414046]
Stock Position:  0.04140459984380829
Bond Position:  [5.00787686]


portfolio before change:  [9.20806526]
curr_Stock_Price:  101.43499558373016
curr_Factors:  [101.43499558]
mat_Sqrt:  [[0.15]]
grads:  [0.05760126]
Stock Position:  0.057601261568012804
Bond Position:  [3.36528155]


portfolio before change:  [9.20345135]
curr_Stock_Price:  101.35124311553065
curr_Factors:  [101.35124312]
mat_Sqrt:  [[0.15]]
grads:  [-0.02747391]
Stock Position:  -0.027473914705614128
Bond Position:  [11.98796676]


portfolio before change:  [9.21411509]
curr_Stock_Price:  100.99037473632019
curr_Factors:  [100.99037474]
mat_Sqrt:  [[0.15]]
grads:  [-0.03120968]
Stock Position:  -0.031209681032618123
Bond Position:  [12.36599247]


portfolio before change:  [9.19604006]
curr_Stock_Price:  101.5942875640419
curr_Factors:  [101.59428756]
mat_Sqrt:  [[0.15]]
grads:  [0.09148223]
Stock Position:  0.09148222636853906
Bond Position:  [-0.09803155]


portfolio before change:  [9.26073185]
curr_Stock_Price:  102.30150599054542
curr_Factors:  [102.30150599]
mat_Sqrt:  [[0.15]]
grads:  [0.08170238]
Stock Position:  0.08170238122698507
Bond Position:  [0.90245521]


portfolio before change:  [9.28007879]
curr_Stock_Price:  102.53761332398439
curr_Factors:  [102.53761332]
mat_Sqrt:  [[0.15]]
grads:  [0.07045662]
Stock Position:  0.07045661842980283
Bond Position:  [2.05562529]


portfolio before change:  [9.27588597]
curr_Stock_Price:  102.47628065783474
curr_Factors:  [102.47628066]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363075]
Stock Position:  -0.0036307527897035553
Bond Position:  [9.64795202]


portfolio before change:  [9.27795972]
curr_Stock_Price:  102.07120383517717
curr_Factors:  [102.07120384]
mat_Sqrt:  [[0.15]]
grads:  [0.10889119]
Stock Position:  0.10889118952617183
Bond Position:  [-1.83669508]


portfolio before change:  [9.26024813]
curr_Stock_Price:  101.90960403897155
curr_Factors:  [101.90960404]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790973]
Stock Position:  -0.007909733222760524
Bond Position:  [10.06632591]


portfolio before change:  [9.26056911]
curr_Stock_Price:  101.9485672071452
curr_Factors:  [101.94856721]
mat_Sqrt:  [[0.15]]
grads:  [0.11468646]
Stock Position:  0.11468646069832686
Bond Position:  [-2.43155124]


portfolio before change:  [9.27333885]
curr_Stock_Price:  102.06123711383295
curr_Factors:  [102.06123711]
mat_Sqrt:  [[0.15]]
grads:  [-0.08517822]
Stock Position:  -0.08517822301166184
Bond Position:  [17.96673366]


portfolio before change:  [9.34091869]
curr_Stock_Price:  101.281027275425
curr_Factors:  [101.28102728]
mat_Sqrt:  [[0.15]]
grads:  [0.01278107]
Stock Position:  0.012781073285307705
Bond Position:  [8.04643846]


portfolio before change:  [9.33525794]
curr_Stock_Price:  100.79877741843154
curr_Factors:  [100.79877742]
mat_Sqrt:  [[0.15]]
grads:  [0.01598901]
Stock Position:  0.015989010640403135
Bond Position:  [7.72358521]


portfolio before change:  [9.3418059]
curr_Stock_Price:  101.17811480190908
curr_Factors:  [101.1781148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02411835]
Stock Position:  -0.024118349879060752
Bond Position:  [11.78205508]


portfolio before change:  [9.33778194]
curr_Stock_Price:  101.37549026657608
curr_Factors:  [101.37549027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02345635]
Stock Position:  -0.023456353995105074
Bond Position:  [11.71568132]


portfolio before change:  [9.33619213]
curr_Stock_Price:  101.47448496301836
curr_Factors:  [101.47448496]
mat_Sqrt:  [[0.15]]
grads:  [0.06803333]
Stock Position:  0.06803333170090987
Bond Position:  [2.43254484]


portfolio before change:  [9.31537988]
curr_Stock_Price:  101.16633756364564
curr_Factors:  [101.16633756]
mat_Sqrt:  [[0.15]]
grads:  [-0.01849416]
Stock Position:  -0.0184941577489346
Bond Position:  [11.18636608]


portfolio before change:  [9.32130032]
curr_Stock_Price:  100.88401734053377
curr_Factors:  [100.88401734]
mat_Sqrt:  [[0.15]]
grads:  [0.04627956]
Stock Position:  0.046279558792255704
Bond Position:  [4.65243251]


portfolio before change:  [9.31286463]
curr_Stock_Price:  100.69545712674181
curr_Factors:  [100.69545713]
mat_Sqrt:  [[0.15]]
grads:  [-0.02674109]
Stock Position:  -0.026741087062076268
Bond Position:  [12.00557061]


portfolio before change:  [9.33421768]
curr_Stock_Price:  99.92500676076071
curr_Factors:  [99.92500676]
mat_Sqrt:  [[0.15]]
grads:  [-0.0013075]
Stock Position:  -0.0013074970928188211
Bond Position:  [9.46486933]


portfolio before change:  [9.33464044]
curr_Stock_Price:  100.05411786073945
curr_Factors:  [100.05411786]
mat_Sqrt:  [[0.15]]
grads:  [0.0332081]
Stock Position:  0.03320809509139462
Bond Position:  [6.01203378]


portfolio before change:  [9.33254521]
curr_Stock_Price:  99.97970848769171
curr_Factors:  [99.97970849]
mat_Sqrt:  [[0.15]]
grads:  [-0.05116241]
Stock Position:  -0.05116241071067589
Bond Position:  [14.44774812]


portfolio before change:  [9.35893378]
curr_Stock_Price:  99.48157797504774
curr_Factors:  [99.48157798]
mat_Sqrt:  [[0.15]]
grads:  [0.04462592]
Stock Position:  0.044625917628231586
Bond Position:  [4.91947707]


portfolio before change:  [9.37282795]
curr_Stock_Price:  99.78603553249202
curr_Factors:  [99.78603553]
mat_Sqrt:  [[0.15]]
grads:  [0.14385209]
Stock Position:  0.14385208982170447
Bond Position:  [-4.98160179]


portfolio before change:  [9.28136523]
curr_Stock_Price:  99.15238906740557
curr_Factors:  [99.15238907]
mat_Sqrt:  [[0.15]]
grads:  [0.03529742]
Stock Position:  0.03529741713529309
Bond Position:  [5.78154199]


portfolio before change:  [9.2653127]
curr_Stock_Price:  98.68737242278999
curr_Factors:  [98.68737242]
mat_Sqrt:  [[0.15]]
grads:  [0.06601463]
Stock Position:  0.06601463373717571
Bond Position:  [2.75050195]


portfolio before change:  [9.31023084]
curr_Stock_Price:  99.3651952701609
curr_Factors:  [99.36519527]
mat_Sqrt:  [[0.15]]
grads:  [-0.00209459]
Stock Position:  -0.0020945854954018397
Bond Position:  [9.51835973]


portfolio before change:  [9.31218135]
curr_Stock_Price:  98.71800380369937
curr_Factors:  [98.7180038]
mat_Sqrt:  [[0.15]]
grads:  [0.01860137]
Stock Position:  0.018601367700481812
Bond Position:  [7.47589146]


portfolio before change:  [9.31862069]
curr_Stock_Price:  99.03906014522732
curr_Factors:  [99.03906015]
mat_Sqrt:  [[0.15]]
grads:  [0.14623014]
Stock Position:  0.14623014011845908
Bond Position:  [-5.16387495]


portfolio before change:  [9.38939292]
curr_Stock_Price:  99.52524565897693
curr_Factors:  [99.52524566]
mat_Sqrt:  [[0.15]]
grads:  [0.01121729]
Stock Position:  0.011217286486352777
Bond Position:  [8.27298972]


portfolio before change:  [9.38781548]
curr_Stock_Price:  99.33852351436119
curr_Factors:  [99.33852351]
mat_Sqrt:  [[0.15]]
grads:  [-0.10637978]
Stock Position:  -0.10637977863847857
Bond Position:  [19.95542562]


portfolio before change:  [9.43612081]
curr_Stock_Price:  98.89616425423694
curr_Factors:  [98.89616425]
mat_Sqrt:  [[0.15]]
grads:  [-0.04257967]
Stock Position:  -0.04257966557282673
Bond Position:  [13.64708641]


portfolio before change:  [9.46329556]
curr_Stock_Price:  98.27798700226838
curr_Factors:  [98.277987]
mat_Sqrt:  [[0.15]]
grads:  [0.00670159]
Stock Position:  0.006701587927474635
Bond Position:  [8.80467699]


portfolio before change:  [9.46518118]
curr_Stock_Price:  98.47723989776435
curr_Factors:  [98.4772399]
mat_Sqrt:  [[0.15]]
grads:  [0.03829518]
Stock Position:  0.03829518187356158
Bond Position:  [5.69397737]


portfolio before change:  [9.47581459]
curr_Stock_Price:  98.74561627849631
curr_Factors:  [98.74561628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00311708]
Stock Position:  -0.0031170841512309184
Bond Position:  [9.78361299]


portfolio before change:  [9.47691845]
curr_Stock_Price:  98.5876594400198
curr_Factors:  [98.58765944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00961906]
Stock Position:  -0.009619061889930617
Bond Position:  [10.42523925]


portfolio before change:  [9.47544616]
curr_Stock_Price:  98.80845932336318
curr_Factors:  [98.80845932]
mat_Sqrt:  [[0.15]]
grads:  [0.01810168]
Stock Position:  0.018101680792874768
Bond Position:  [7.68684697]


portfolio before change:  [9.47529657]
curr_Stock_Price:  98.77365426339092
curr_Factors:  [98.77365426]
mat_Sqrt:  [[0.15]]
grads:  [-0.15939272]
Stock Position:  -0.15939271850049694
Bond Position:  [25.21909784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.40382489]
Stock Price:  99.23194325568282
PL:  [9.40382489]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.48982064e-03]
 [ 5.41887351e-02]
 [ 1.73038679e-02]
 [-2.61169376e-02]
 [-4.64075559e-02]
 [-1.29382106e-03]
 [-1.41150563e-03]
 [-3.83378249e-02]
 [ 1.72342670e-02]
 [-6.71939833e-03]
 [-9.44201683e-03]
 [ 1.89887452e-02]
 [-4.67089295e-03]
 [ 3.03681922e-03]
 [ 7.08220314e-03]
 [ 9.16382970e-03]
 [ 9.64979277e-02]
 [-1.04191863e-02]
 [ 2.26721292e-02]
 [ 5.29051331e-04]
 [-5.87061251e-03]
 [ 5.05028622e-03]
 [ 8.75705298e-03]
 [ 2.74834347e-02]
 [ 3.18328823e-03]
 [ 6.70793183e-03]
 [ 6.45068435e-02]
 [ 3.05193503e-02]
 [-1.99126733e-03]
 [-9.00630134e-03]
 [ 3.97746493e-03]
 [ 1.57033808e-02]
 [ 1.60979621e-02]
 [-1.10291489e-02]
 [ 3.66906602e-03]
 [-3.02139721e-02]
 [-8.93146247e-03]
 [-1.80380948e-02]
 [ 2.48600122e-02]
 [-7.23916119e-02]
 [ 3.17220567e-03]
 [-5.08860735e-03]
 [-2.23129257e-02]
 [ 3.50855389e-02]
 [-1.85075036e-02]
 [ 1.19938279e-02]
 [ 1.03514130e-02]
 [-3.83618870e-03]
 [ 1.63107297e-02]
 [-1.63335965e-03]
 [ 1.75786498e-02]
 [ 3.16618619e-02]
 [-1.07089538e-02]
 [-8.32810741e-02]
 [-2.51031784e-02]
 [-1.66258670e-03]
 [-1.14888779e-02]
 [-1.54041056e-02]
 [-3.67033657e-03]
 [-2.60665093e-03]
 [-8.33398035e-03]
 [-1.34279394e-02]
 [-1.44815984e-02]
 [-1.25264832e-03]
 [-2.25324523e-02]
 [ 3.89681880e-02]
 [-1.04321053e-02]
 [ 2.72584280e-02]
 [ 1.03246108e-02]
 [ 1.21475152e-02]
 [ 1.26001946e-02]
 [-1.36666117e-02]
 [-9.86588341e-02]
 [ 5.47596045e-05]
 [-2.58055568e-02]
 [-4.09745228e-02]
 [-6.60718914e-03]
 [ 2.96008771e-02]
 [ 1.60074619e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.19621527]
curr_Stock_Price:  100.18922497774048
curr_Factors:  [100.18922498]
mat_Sqrt:  [[0.15]]
grads:  [-0.0365988]
Stock Position:  -0.03659880424876254
Bond Position:  [9.8630211]


portfolio before change:  [6.15099698]
curr_Stock_Price:  101.44158125247588
curr_Factors:  [101.44158125]
mat_Sqrt:  [[0.15]]
grads:  [0.36125823]
Stock Position:  0.3612582337761399
Bond Position:  [-30.49560949]


portfolio before change:  [6.22338642]
curr_Stock_Price:  101.64723876209159
curr_Factors:  [101.64723876]
mat_Sqrt:  [[0.15]]
grads:  [0.11535912]
Stock Position:  0.11535911965563993
Bond Position:  [-5.50254956]


portfolio before change:  [6.17117822]
curr_Stock_Price:  101.19764905362871
curr_Factors:  [101.19764905]
mat_Sqrt:  [[0.15]]
grads:  [-0.17411292]
Stock Position:  -0.17411291755267144
Bond Position:  [23.79099615]


portfolio before change:  [6.04130342]
curr_Stock_Price:  101.95211225312383
curr_Factors:  [101.95211225]
mat_Sqrt:  [[0.15]]
grads:  [-0.30938371]
Stock Position:  -0.30938370618688754
Bond Position:  [37.58362576]


portfolio before change:  [6.10056801]
curr_Stock_Price:  101.76814800174029
curr_Factors:  [101.768148]
mat_Sqrt:  [[0.15]]
grads:  [-0.00862547]
Stock Position:  -0.008625473709504203
Bond Position:  [6.97836649]


portfolio before change:  [6.10314134]
curr_Stock_Price:  101.52037340703464
curr_Factors:  [101.52037341]
mat_Sqrt:  [[0.15]]
grads:  [-0.00941004]
Stock Position:  -0.009410037541982379
Bond Position:  [7.05845187]


portfolio before change:  [6.10246362]
curr_Stock_Price:  101.63927715879316
curr_Factors:  [101.63927716]
mat_Sqrt:  [[0.15]]
grads:  [-0.2555855]
Stock Position:  -0.25558549946942943
Bond Position:  [32.07998904]


portfolio before change:  [5.87809248]
curr_Stock_Price:  102.52499329353003
curr_Factors:  [102.52499329]
mat_Sqrt:  [[0.15]]
grads:  [0.11489511]
Stock Position:  0.11489511343393896
Bond Position:  [-5.90152825]


portfolio before change:  [5.8293675]
curr_Stock_Price:  102.10412136621272
curr_Factors:  [102.10412137]
mat_Sqrt:  [[0.15]]
grads:  [-0.04479599]
Stock Position:  -0.04479598888636811
Bond Position:  [10.40322258]


portfolio before change:  [5.8489548]
curr_Stock_Price:  101.68138093069402
curr_Factors:  [101.68138093]
mat_Sqrt:  [[0.15]]
grads:  [-0.06294678]
Stock Position:  -0.06294677883489108
Bond Position:  [12.24947019]


portfolio before change:  [5.80768229]
curr_Stock_Price:  102.34921684999291
curr_Factors:  [102.34921685]
mat_Sqrt:  [[0.15]]
grads:  [0.12659163]
Stock Position:  0.12659163439228896
Bond Position:  [-7.14887235]


portfolio before change:  [5.8659085]
curr_Stock_Price:  102.81269952917441
curr_Factors:  [102.81269953]
mat_Sqrt:  [[0.15]]
grads:  [-0.03113929]
Stock Position:  -0.031139286336739926
Bond Position:  [9.06742259]


portfolio before change:  [5.87644099]
curr_Stock_Price:  102.49266166027554
curr_Factors:  [102.49266166]
mat_Sqrt:  [[0.15]]
grads:  [0.02024546]
Stock Position:  0.02024546145318298
Bond Position:  [3.80142975]


portfolio before change:  [5.87668915]
curr_Stock_Price:  102.49318372265164
curr_Factors:  [102.49318372]
mat_Sqrt:  [[0.15]]
grads:  [0.04721469]
Stock Position:  0.0472146876285601
Bond Position:  [1.0375055]


portfolio before change:  [5.91776901]
curr_Stock_Price:  103.361875570681
curr_Factors:  [103.36187557]
mat_Sqrt:  [[0.15]]
grads:  [0.0610922]
Stock Position:  0.06109219802683006
Bond Position:  [-0.39683516]


portfolio before change:  [5.9109757]
curr_Stock_Price:  103.2510838354154
curr_Factors:  [103.25108384]
mat_Sqrt:  [[0.15]]
grads:  [0.64331952]
Stock Position:  0.6433195179133174
Bond Position:  [-60.51246178]


portfolio before change:  [5.71503991]
curr_Stock_Price:  102.95239300217295
curr_Factors:  [102.952393]
mat_Sqrt:  [[0.15]]
grads:  [-0.06946124]
Stock Position:  -0.06946124181683253
Bond Position:  [12.86624097]


portfolio before change:  [5.7449927]
curr_Stock_Price:  102.5327542770009
curr_Factors:  [102.53275428]
mat_Sqrt:  [[0.15]]
grads:  [0.15114753]
Stock Position:  0.15114752811561796
Bond Position:  [-9.75257966]


portfolio before change:  [5.78314361]
curr_Stock_Price:  102.78919555000496
curr_Factors:  [102.78919555]
mat_Sqrt:  [[0.15]]
grads:  [0.00352701]
Stock Position:  0.0035270088742450027
Bond Position:  [5.42060521]


portfolio before change:  [5.78276784]
curr_Stock_Price:  102.58659788300734
curr_Factors:  [102.58659788]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913742]
Stock Position:  -0.03913741676410485
Bond Position:  [9.79774228]


portfolio before change:  [5.80588244]
curr_Stock_Price:  102.01164387986536
curr_Factors:  [102.01164388]
mat_Sqrt:  [[0.15]]
grads:  [0.03366857]
Stock Position:  0.033668574791282824
Bond Position:  [2.37129578]


portfolio before change:  [5.81488105]
curr_Stock_Price:  102.2745121167393
curr_Factors:  [102.27451212]
mat_Sqrt:  [[0.15]]
grads:  [0.05838035]
Stock Position:  0.05838035322363951
Bond Position:  [-0.1559411]


portfolio before change:  [5.79559631]
curr_Stock_Price:  101.9443498805085
curr_Factors:  [101.94434988]
mat_Sqrt:  [[0.15]]
grads:  [0.1832229]
Stock Position:  0.1832228981822731
Bond Position:  [-12.88294293]


portfolio before change:  [6.0196148]
curr_Stock_Price:  103.1714001221357
curr_Factors:  [103.17140012]
mat_Sqrt:  [[0.15]]
grads:  [0.02122192]
Stock Position:  0.021221921536309155
Bond Position:  [3.83011945]


portfolio before change:  [6.04108386]
curr_Stock_Price:  104.17176519499859
curr_Factors:  [104.17176519]
mat_Sqrt:  [[0.15]]
grads:  [0.04471955]
Stock Position:  0.04471954555822642
Bond Position:  [1.38256986]


portfolio before change:  [6.04673771]
curr_Stock_Price:  104.29626193032155
curr_Factors:  [104.29626193]
mat_Sqrt:  [[0.15]]
grads:  [0.43004562]
Stock Position:  0.4300456233417227
Bond Position:  [-38.80541326]


portfolio before change:  [6.14949545]
curr_Stock_Price:  104.5408479622865
curr_Factors:  [104.54084796]
mat_Sqrt:  [[0.15]]
grads:  [0.20346234]
Stock Position:  0.20346233514836837
Bond Position:  [-15.12062959]


portfolio before change:  [6.27612706]
curr_Stock_Price:  105.1678764320401
curr_Factors:  [105.16787643]
mat_Sqrt:  [[0.15]]
grads:  [-0.01327512]
Stock Position:  -0.013275115513520949
Bond Position:  [7.67224277]


portfolio before change:  [6.28320996]
curr_Stock_Price:  104.67045150619418
curr_Factors:  [104.67045151]
mat_Sqrt:  [[0.15]]
grads:  [-0.06004201]
Stock Position:  -0.060042008948488934
Bond Position:  [12.56783415]


portfolio before change:  [6.31153647]
curr_Stock_Price:  104.21175605543353
curr_Factors:  [104.21175606]
mat_Sqrt:  [[0.15]]
grads:  [0.02651643]
Stock Position:  0.026516432876732693
Bond Position:  [3.54821244]


portfolio before change:  [6.33078476]
curr_Stock_Price:  104.92929270715537
curr_Factors:  [104.92929271]
mat_Sqrt:  [[0.15]]
grads:  [0.10468921]
Stock Position:  0.10468920508290304
Bond Position:  [-4.65417949]


portfolio before change:  [6.3234435]
curr_Stock_Price:  104.86194708095732
curr_Factors:  [104.86194708]
mat_Sqrt:  [[0.15]]
grads:  [0.10731975]
Stock Position:  0.1073197476191122
Bond Position:  [-4.93031419]


portfolio before change:  [6.4094375]
curr_Stock_Price:  105.66610615634723
curr_Factors:  [105.66610616]
mat_Sqrt:  [[0.15]]
grads:  [-0.07352766]
Stock Position:  -0.07352765900736877
Bond Position:  [14.17881892]


portfolio before change:  [6.36918444]
curr_Stock_Price:  106.225613483122
curr_Factors:  [106.22561348]
mat_Sqrt:  [[0.15]]
grads:  [0.02446044]
Stock Position:  0.024460440148552157
Bond Position:  [3.77085918]


portfolio before change:  [6.38371229]
curr_Stock_Price:  106.80991053333557
curr_Factors:  [106.80991053]
mat_Sqrt:  [[0.15]]
grads:  [-0.20142648]
Stock Position:  -0.2014264804804836
Bond Position:  [27.89805664]


portfolio before change:  [6.50572227]
curr_Stock_Price:  106.21283757818772
curr_Factors:  [106.21283758]
mat_Sqrt:  [[0.15]]
grads:  [-0.05954308]
Stock Position:  -0.059543083112192134
Bond Position:  [12.82996209]


portfolio before change:  [6.48139973]
curr_Stock_Price:  106.63479155685427
curr_Factors:  [106.63479156]
mat_Sqrt:  [[0.15]]
grads:  [-0.12025397]
Stock Position:  -0.12025396522253207
Bond Position:  [19.30465625]


portfolio before change:  [6.46267145]
curr_Stock_Price:  106.80056455858544
curr_Factors:  [106.80056456]
mat_Sqrt:  [[0.15]]
grads:  [0.16573341]
Stock Position:  0.1657334149644967
Bond Position:  [-11.23775084]


portfolio before change:  [6.42781682]
curr_Stock_Price:  106.59449720106394
curr_Factors:  [106.5944972]
mat_Sqrt:  [[0.15]]
grads:  [-0.48261075]
Stock Position:  -0.48261074599467085
Bond Position:  [57.87146663]


portfolio before change:  [6.34186919]
curr_Stock_Price:  106.78008094575888
curr_Factors:  [106.78008095]
mat_Sqrt:  [[0.15]]
grads:  [0.02114804]
Stock Position:  0.021148037827446155
Bond Position:  [4.08368]


portfolio before change:  [6.34205752]
curr_Stock_Price:  106.77691730507512
curr_Factors:  [106.77691731]
mat_Sqrt:  [[0.15]]
grads:  [-0.03392405]
Stock Position:  -0.033924048968990844
Bond Position:  [9.96436289]


portfolio before change:  [6.3134029]
curr_Stock_Price:  107.63994550913608
curr_Factors:  [107.63994551]
mat_Sqrt:  [[0.15]]
grads:  [-0.14875284]
Stock Position:  -0.14875283817283158
Bond Position:  [22.3251503]


portfolio before change:  [6.15567215]
curr_Stock_Price:  108.70968050821149
curr_Factors:  [108.70968051]
mat_Sqrt:  [[0.15]]
grads:  [0.23390359]
Stock Position:  0.23390359256716786
Bond Position:  [-19.27191267]


portfolio before change:  [6.09272451]
curr_Stock_Price:  108.4457123097715
curr_Factors:  [108.44571231]
mat_Sqrt:  [[0.15]]
grads:  [-0.12338336]
Stock Position:  -0.1233833570228954
Bond Position:  [19.47312055]


portfolio before change:  [6.15315239]
curr_Stock_Price:  107.96581962510638
curr_Factors:  [107.96581963]
mat_Sqrt:  [[0.15]]
grads:  [0.07995885]
Stock Position:  0.07995885238747648
Bond Position:  [-2.47967065]


portfolio before change:  [6.13523017]
curr_Stock_Price:  107.74361492370984
curr_Factors:  [107.74361492]
mat_Sqrt:  [[0.15]]
grads:  [0.06900942]
Stock Position:  0.06900942030318416
Bond Position:  [-1.30009424]


portfolio before change:  [6.12833914]
curr_Stock_Price:  107.64493608790167
curr_Factors:  [107.64493609]
mat_Sqrt:  [[0.15]]
grads:  [-0.02557459]
Stock Position:  -0.025574591324320873
Bond Position:  [8.88131439]


portfolio before change:  [6.11497393]
curr_Stock_Price:  108.189238659123
curr_Factors:  [108.18923866]
mat_Sqrt:  [[0.15]]
grads:  [0.1087382]
Stock Position:  0.10873819787792209
Bond Position:  [-5.64932891]


portfolio before change:  [6.10398021]
curr_Stock_Price:  108.09138322716363
curr_Factors:  [108.09138323]
mat_Sqrt:  [[0.15]]
grads:  [-0.01088906]
Stock Position:  -0.010889064338035175
Bond Position:  [7.28099424]


portfolio before change:  [6.1055571]
curr_Stock_Price:  107.98836072824807
curr_Factors:  [107.98836073]
mat_Sqrt:  [[0.15]]
grads:  [0.117191]
Stock Position:  0.11719099866178723
Bond Position:  [-6.54970673]


portfolio before change:  [6.12118855]
curr_Stock_Price:  108.12523823821208
curr_Factors:  [108.12523824]
mat_Sqrt:  [[0.15]]
grads:  [0.21107908]
Stock Position:  0.21107907933450892
Bond Position:  [-16.70178719]


portfolio before change:  [6.21712076]
curr_Stock_Price:  108.58466843682784
curr_Factors:  [108.58466844]
mat_Sqrt:  [[0.15]]
grads:  [-0.07139303]
Stock Position:  -0.07139302507433598
Bond Position:  [13.96930871]


portfolio before change:  [6.21398269]
curr_Stock_Price:  108.64085289542302
curr_Factors:  [108.6408529]
mat_Sqrt:  [[0.15]]
grads:  [-0.55520716]
Stock Position:  -0.5552071605433326
Bond Position:  [66.53216214]


portfolio before change:  [6.53707234]
curr_Stock_Price:  108.06641639488626
curr_Factors:  [108.06641639]
mat_Sqrt:  [[0.15]]
grads:  [-0.16735452]
Stock Position:  -0.16735452265697598
Bond Position:  [24.62247587]


portfolio before change:  [6.43063247]
curr_Stock_Price:  108.71162641880761
curr_Factors:  [108.71162642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108391]
Stock Position:  -0.011083911303831285
Bond Position:  [7.6355825]


portfolio before change:  [6.42322343]
curr_Stock_Price:  109.42313330252243
curr_Factors:  [109.4231333]
mat_Sqrt:  [[0.15]]
grads:  [-0.07659252]
Stock Position:  -0.07659251926702157
Bond Position:  [14.80421688]


portfolio before change:  [6.40144925]
curr_Stock_Price:  109.71950004195389
curr_Factors:  [109.71950004]
mat_Sqrt:  [[0.15]]
grads:  [-0.10269404]
Stock Position:  -0.10269403725984355
Bond Position:  [17.66898768]


portfolio before change:  [6.33925968]
curr_Stock_Price:  110.33583495899457
curr_Factors:  [110.33583496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02446891]
Stock Position:  -0.024468910434587543
Bond Position:  [9.03905734]


portfolio before change:  [6.31743023]
curr_Stock_Price:  111.2510536741484
curr_Factors:  [111.25105367]
mat_Sqrt:  [[0.15]]
grads:  [-0.01737767]
Stock Position:  -0.017377672880567956
Bond Position:  [8.25071465]


portfolio before change:  [6.32550925]
curr_Stock_Price:  110.81582104076318
curr_Factors:  [110.81582104]
mat_Sqrt:  [[0.15]]
grads:  [-0.05555987]
Stock Position:  -0.055559869009764416
Bond Position:  [12.48242175]


portfolio before change:  [6.30033785]
curr_Stock_Price:  111.28291310546385
curr_Factors:  [111.28291311]
mat_Sqrt:  [[0.15]]
grads:  [-0.0895196]
Stock Position:  -0.08951959586435396
Bond Position:  [16.26233925]


portfolio before change:  [6.35026031]
curr_Stock_Price:  110.73659654390943
curr_Factors:  [110.73659654]
mat_Sqrt:  [[0.15]]
grads:  [-0.09654399]
Stock Position:  -0.096543989396129
Bond Position:  [17.04121312]


portfolio before change:  [6.32163166]
curr_Stock_Price:  111.04416371424648
curr_Factors:  [111.04416371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00835099]
Stock Position:  -0.008350988791599897
Bond Position:  [7.24896023]


portfolio before change:  [6.32122262]
curr_Stock_Price:  111.14739858768849
curr_Factors:  [111.14739859]
mat_Sqrt:  [[0.15]]
grads:  [-0.15021635]
Stock Position:  -0.15021634858128674
Bond Position:  [23.01737899]


portfolio before change:  [6.40106128]
curr_Stock_Price:  110.62548450286388
curr_Factors:  [110.6254845]
mat_Sqrt:  [[0.15]]
grads:  [0.25978792]
Stock Position:  0.25978792008535706
Bond Position:  [-22.33810325]


portfolio before change:  [6.58964102]
curr_Stock_Price:  111.35675759044328
curr_Factors:  [111.35675759]
mat_Sqrt:  [[0.15]]
grads:  [-0.06954737]
Stock Position:  -0.06954736854716335
Bond Position:  [14.33421048]


portfolio before change:  [6.57126359]
curr_Stock_Price:  111.63388302439337
curr_Factors:  [111.63388302]
mat_Sqrt:  [[0.15]]
grads:  [0.18172285]
Stock Position:  0.18172285336356833
Bond Position:  [-13.71516416]


portfolio before change:  [6.44888445]
curr_Stock_Price:  110.96516185616235
curr_Factors:  [110.96516186]
mat_Sqrt:  [[0.15]]
grads:  [0.06883074]
Stock Position:  0.06883073873773612
Bond Position:  [-1.18892962]


portfolio before change:  [6.44225712]
curr_Stock_Price:  110.86995708555031
curr_Factors:  [110.86995709]
mat_Sqrt:  [[0.15]]
grads:  [0.08098343]
Stock Position:  0.08098343490121873
Bond Position:  [-2.53637283]


portfolio before change:  [6.52449992]
curr_Stock_Price:  111.88746551016195
curr_Factors:  [111.88746551]
mat_Sqrt:  [[0.15]]
grads:  [0.0840013]
Stock Position:  0.08400129700345488
Bond Position:  [-2.8741923]


portfolio before change:  [6.64500401]
curr_Stock_Price:  113.32415442335608
curr_Factors:  [113.32415442]
mat_Sqrt:  [[0.15]]
grads:  [-0.09111074]
Stock Position:  -0.09111074479638394
Bond Position:  [16.97005212]


portfolio before change:  [6.62008693]
curr_Stock_Price:  113.60927716137611
curr_Factors:  [113.60927716]
mat_Sqrt:  [[0.15]]
grads:  [-0.65772556]
Stock Position:  -0.6577255607738868
Bond Position:  [81.34381246]


portfolio before change:  [6.58079009]
curr_Stock_Price:  113.67675360843053
curr_Factors:  [113.67675361]
mat_Sqrt:  [[0.15]]
grads:  [0.00036506]
Stock Position:  0.0003650640300275988
Bond Position:  [6.5392908]


portfolio before change:  [6.58132002]
curr_Stock_Price:  114.00877001433554
curr_Factors:  [114.00877001]
mat_Sqrt:  [[0.15]]
grads:  [-0.17203705]
Stock Position:  -0.17203704525449187
Bond Position:  [26.19505194]


portfolio before change:  [6.57620247]
curr_Stock_Price:  114.04803356450489
curr_Factors:  [114.04803356]
mat_Sqrt:  [[0.15]]
grads:  [-0.27316349]
Stock Position:  -0.2731634852714828
Bond Position:  [37.72996081]


portfolio before change:  [6.29759216]
curr_Stock_Price:  115.07660629343434
curr_Factors:  [115.07660629]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404793]
Stock Position:  -0.044047927590243126
Bond Position:  [11.36647818]


portfolio before change:  [6.32266916]
curr_Stock_Price:  114.52342295711601
curr_Factors:  [114.52342296]
mat_Sqrt:  [[0.15]]
grads:  [0.19733918]
Stock Position:  0.19733918057611166
Bond Position:  [-16.27728928]


portfolio before change:  [6.19253482]
curr_Stock_Price:  113.86913332358584
curr_Factors:  [113.86913332]
mat_Sqrt:  [[0.15]]
grads:  [1.06716412]
Stock Position:  1.0671641247152706
Bond Position:  [-115.32451917]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.59435855]
Stock Price:  114.2524218201301
PL:  [-7.65806327]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.39217799e-02]
 [ 2.39082218e-02]
 [ 1.67743008e-02]
 [-4.12517722e-02]
 [-4.62917977e-02]
 [-1.51242245e-03]
 [ 1.84248040e-02]
 [-5.83091564e-02]
 [ 1.82296358e-02]
 [-8.45950822e-03]
 [-1.18649676e-02]
 [ 1.99368847e-02]
 [-3.93893753e-03]
 [ 3.23209995e-03]
 [-1.55561642e-03]
 [ 1.55607363e-02]
 [ 4.64661824e-02]
 [-1.47247957e-02]
 [ 2.01505270e-02]
 [ 9.20854197e-04]
 [-6.17899364e-03]
 [ 5.48348252e-03]
 [ 1.35638074e-02]
 [ 1.78763601e-02]
 [ 1.06290244e-03]
 [ 4.41713072e-03]
 [ 5.42016050e-04]
 [ 9.45132030e-03]
 [ 1.28492927e-02]
 [ 4.35775445e-02]
 [-7.01055239e-03]
 [ 1.81682153e-02]
 [ 1.19593094e-02]
 [-2.02492220e-02]
 [-7.19785039e-03]
 [ 1.84209131e-02]
 [ 4.38191197e-03]
 [-1.04814773e-03]
 [-2.16590149e-03]
 [-8.18925581e-03]
 [ 6.95862085e-03]
 [ 3.47343877e-02]
 [-3.36890664e-03]
 [ 1.45924719e-02]
 [-3.12078826e-02]
 [ 2.06747668e-02]
 [ 9.50224675e-03]
 [ 5.35000663e-03]
 [-7.93865512e-03]
 [-1.22652719e-04]
 [-3.50262002e-03]
 [-2.15955425e-03]
 [-3.95260235e-04]
 [ 7.85000624e-03]
 [-1.41021615e-02]
 [-5.14734030e-03]
 [-1.40536660e-03]
 [ 1.28485680e-02]
 [ 6.91964596e-03]
 [-2.66625116e-03]
 [-5.11783887e-03]
 [-2.20750740e-03]
 [-2.16921002e-03]
 [-2.95364783e-03]
 [ 1.89001310e-02]
 [ 5.81214765e-03]
 [ 2.02967088e-02]
 [-3.31465272e-03]
 [ 5.52980099e-03]
 [ 2.57563558e-02]
 [ 3.21450913e-03]
 [-1.52690806e-02]
 [-5.88499500e-03]
 [ 2.28844360e-03]
 [ 1.12007066e-02]
 [ 7.88961478e-03]
 [ 2.02806916e-03]
 [-2.41553336e-02]
 [-3.13744364e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.58892145]
curr_Stock_Price:  99.83564002196415
curr_Factors:  [99.83564002]
mat_Sqrt:  [[0.15]]
grads:  [-0.09281187]
Stock Position:  -0.09281186628714871
Bond Position:  [7.67701062]


portfolio before change:  [-1.65081832]
curr_Stock_Price:  100.50771679558044
curr_Factors:  [100.5077168]
mat_Sqrt:  [[0.15]]
grads:  [0.15938815]
Stock Position:  0.15938814561350043
Bond Position:  [-17.67055692]


portfolio before change:  [-1.4508486]
curr_Stock_Price:  101.76925461164558
curr_Factors:  [101.76925461]
mat_Sqrt:  [[0.15]]
grads:  [0.11182867]
Stock Position:  0.11182867183149689
Bond Position:  [-12.83156917]


portfolio before change:  [-1.40423249]
curr_Stock_Price:  102.19327915679635
curr_Factors:  [102.19327916]
mat_Sqrt:  [[0.15]]
grads:  [-0.27501181]
Stock Position:  -0.2750118144112323
Bond Position:  [26.70012663]


portfolio before change:  [-1.334961]
curr_Stock_Price:  101.94746180080705
curr_Factors:  [101.9474618]
mat_Sqrt:  [[0.15]]
grads:  [-0.30861198]
Stock Position:  -0.3086119845368029
Bond Position:  [30.1272475]


portfolio before change:  [-1.42552578]
curr_Stock_Price:  102.24702172682792
curr_Factors:  [102.24702173]
mat_Sqrt:  [[0.15]]
grads:  [-0.01008282]
Stock Position:  -0.010082816310591238
Bond Position:  [-0.39458784]


portfolio before change:  [-1.42934348]
curr_Stock_Price:  102.62321087253994
curr_Factors:  [102.62321087]
mat_Sqrt:  [[0.15]]
grads:  [0.12283203]
Stock Position:  0.12283202667702632
Bond Position:  [-14.03476046]


portfolio before change:  [-1.39594719]
curr_Stock_Price:  102.90223818215114
curr_Factors:  [102.90223818]
mat_Sqrt:  [[0.15]]
grads:  [-0.38872771]
Stock Position:  -0.3887277091410168
Bond Position:  [38.60500412]


portfolio before change:  [-1.66079377]
curr_Stock_Price:  103.58976176399632
curr_Factors:  [103.58976176]
mat_Sqrt:  [[0.15]]
grads:  [0.12153091]
Stock Position:  0.12153090558331077
Bond Position:  [-14.25015133]


portfolio before change:  [-1.70577299]
curr_Stock_Price:  103.22698531964357
curr_Factors:  [103.22698532]
mat_Sqrt:  [[0.15]]
grads:  [-0.05639672]
Stock Position:  -0.05639672144427745
Bond Position:  [4.11589055]


portfolio before change:  [-1.6875089]
curr_Stock_Price:  102.90769661814464
curr_Factors:  [102.90769662]
mat_Sqrt:  [[0.15]]
grads:  [-0.07909978]
Stock Position:  -0.07909978379430889
Bond Position:  [6.45246766]


portfolio before change:  [-1.67772188]
curr_Stock_Price:  102.78906512258527
curr_Factors:  [102.78906512]
mat_Sqrt:  [[0.15]]
grads:  [0.13291256]
Stock Position:  0.1329125648106761
Bond Position:  [-15.33968016]


portfolio before change:  [-1.80634492]
curr_Stock_Price:  101.82855188983244
curr_Factors:  [101.82855189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02625958]
Stock Position:  -0.026259583547541845
Bond Position:  [0.86763045]


portfolio before change:  [-1.80982339]
curr_Stock_Price:  101.96308174413018
curr_Factors:  [101.96308174]
mat_Sqrt:  [[0.15]]
grads:  [0.02154733]
Stock Position:  0.021547333021878202
Bond Position:  [-4.00685587]


portfolio before change:  [-1.8337996]
curr_Stock_Price:  100.8619814148335
curr_Factors:  [100.86198141]
mat_Sqrt:  [[0.15]]
grads:  [-0.01037078]
Stock Position:  -0.01037077615365609
Bond Position:  [-0.78778257]


portfolio before change:  [-1.83256849]
curr_Stock_Price:  100.73852410153437
curr_Factors:  [100.7385241]
mat_Sqrt:  [[0.15]]
grads:  [0.10373824]
Stock Position:  0.10373824171919624
Bond Position:  [-12.28300585]


portfolio before change:  [-1.84205349]
curr_Stock_Price:  100.6544924940416
curr_Factors:  [100.65449249]
mat_Sqrt:  [[0.15]]
grads:  [0.30977455]
Stock Position:  0.30977454930137177
Bond Position:  [-33.02225354]


portfolio before change:  [-1.87490424]
curr_Stock_Price:  100.55510798778577
curr_Factors:  [100.55510799]
mat_Sqrt:  [[0.15]]
grads:  [-0.0981653]
Stock Position:  -0.09816530499080549
Bond Position:  [7.99611861]


portfolio before change:  [-1.80905597]
curr_Stock_Price:  99.88940947644691
curr_Factors:  [99.88940948]
mat_Sqrt:  [[0.15]]
grads:  [0.13433685]
Stock Position:  0.13433684678096308
Bond Position:  [-15.22788426]


portfolio before change:  [-1.92796981]
curr_Stock_Price:  99.01130290799264
curr_Factors:  [99.01130291]
mat_Sqrt:  [[0.15]]
grads:  [0.00613903]
Stock Position:  0.006139027978303615
Bond Position:  [-2.53580297]


portfolio before change:  [-1.93115319]
curr_Stock_Price:  98.51857235420206
curr_Factors:  [98.51857235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04119329]
Stock Position:  -0.041193290928476435
Bond Position:  [2.12715103]


portfolio before change:  [-1.91505338]
curr_Stock_Price:  98.13096429313256
curr_Factors:  [98.13096429]
mat_Sqrt:  [[0.15]]
grads:  [0.03655655]
Stock Position:  0.036556550162449096
Bond Position:  [-5.5023829]


portfolio before change:  [-1.92294603]
curr_Stock_Price:  97.92446962090551
curr_Factors:  [97.92446962]
mat_Sqrt:  [[0.15]]
grads:  [0.09042538]
Stock Position:  0.09042538282553697
Bond Position:  [-10.77780368]


portfolio before change:  [-1.84222029]
curr_Stock_Price:  98.82465236027332
curr_Factors:  [98.82465236]
mat_Sqrt:  [[0.15]]
grads:  [0.11917573]
Stock Position:  0.11917573374525245
Bond Position:  [-13.61972075]


portfolio before change:  [-1.98987344]
curr_Stock_Price:  97.59284215298919
curr_Factors:  [97.59284215]
mat_Sqrt:  [[0.15]]
grads:  [0.00708602]
Stock Position:  0.007086016236867362
Bond Position:  [-2.6814179]


portfolio before change:  [-1.98968112]
curr_Stock_Price:  97.64363384915642
curr_Factors:  [97.64363385]
mat_Sqrt:  [[0.15]]
grads:  [0.02944754]
Stock Position:  0.029447538125419098
Bond Position:  [-4.86504575]


portfolio before change:  [-2.00043971]
curr_Stock_Price:  97.28861221142678
curr_Factors:  [97.28861221]
mat_Sqrt:  [[0.15]]
grads:  [0.00361344]
Stock Position:  0.0036134403358567893
Bond Position:  [-2.3519863]


portfolio before change:  [-1.99920716]
curr_Stock_Price:  97.67039631916255
curr_Factors:  [97.67039632]
mat_Sqrt:  [[0.15]]
grads:  [0.0630088]
Stock Position:  0.0630088019732644
Bond Position:  [-8.15330182]


portfolio before change:  [-2.03607828]
curr_Stock_Price:  97.09330991704644
curr_Factors:  [97.09330992]
mat_Sqrt:  [[0.15]]
grads:  [0.08566195]
Stock Position:  0.08566195151693079
Bond Position:  [-10.35328068]


portfolio before change:  [-2.06669811]
curr_Stock_Price:  96.74341440805051
curr_Factors:  [96.74341441]
mat_Sqrt:  [[0.15]]
grads:  [0.29051696]
Stock Position:  0.29051696306627034
Bond Position:  [-30.17230106]


portfolio before change:  [-1.96244923]
curr_Stock_Price:  97.10874491244445
curr_Factors:  [97.10874491]
mat_Sqrt:  [[0.15]]
grads:  [-0.04673702]
Stock Position:  -0.04673701595344722
Bond Position:  [2.57612373]


portfolio before change:  [-1.96995183]
curr_Stock_Price:  97.27271810628784
curr_Factors:  [97.27271811]
mat_Sqrt:  [[0.15]]
grads:  [0.12112144]
Stock Position:  0.12112143549018506
Bond Position:  [-13.75176308]


portfolio before change:  [-1.98304396]
curr_Stock_Price:  97.17172345080485
curr_Factors:  [97.17172345]
mat_Sqrt:  [[0.15]]
grads:  [0.07972873]
Stock Position:  0.0797287294055746
Bond Position:  [-9.73042201]


portfolio before change:  [-1.96252217]
curr_Stock_Price:  97.43674668441909
curr_Factors:  [97.43674668]
mat_Sqrt:  [[0.15]]
grads:  [-0.13499481]
Stock Position:  -0.13499481329071747
Bond Position:  [11.19093326]


portfolio before change:  [-1.99321868]
curr_Stock_Price:  97.66931834269795
curr_Factors:  [97.66931834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04798567]
Stock Position:  -0.04798566925287553
Bond Position:  [2.69350893]


portfolio before change:  [-2.03969985]
curr_Stock_Price:  98.64147362306174
curr_Factors:  [98.64147362]
mat_Sqrt:  [[0.15]]
grads:  [0.12280609]
Stock Position:  0.12280608753468626
Bond Position:  [-14.1534733]


portfolio before change:  [-2.14808842]
curr_Stock_Price:  97.76607773667196
curr_Factors:  [97.76607774]
mat_Sqrt:  [[0.15]]
grads:  [0.02921275]
Stock Position:  0.02921274644993537
Bond Position:  [-5.00410406]


portfolio before change:  [-2.16801003]
curr_Stock_Price:  97.09483472459816
curr_Factors:  [97.09483472]
mat_Sqrt:  [[0.15]]
grads:  [-0.00698765]
Stock Position:  -0.006987651507248836
Bond Position:  [-1.48954517]


portfolio before change:  [-2.16619248]
curr_Stock_Price:  96.82140223690384
curr_Factors:  [96.82140224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01443934]
Stock Position:  -0.01443934329784971
Bond Position:  [-0.76815502]


portfolio before change:  [-2.16442891]
curr_Stock_Price:  96.69594054384628
curr_Factors:  [96.69594054]
mat_Sqrt:  [[0.15]]
grads:  [-0.05459504]
Stock Position:  -0.054595038727431475
Bond Position:  [3.11468971]


portfolio before change:  [-2.14420754]
curr_Stock_Price:  96.32911785879273
curr_Factors:  [96.32911786]
mat_Sqrt:  [[0.15]]
grads:  [0.04639081]
Stock Position:  0.046390805670544016
Bond Position:  [-6.61299292]


portfolio before change:  [-2.14011057]
curr_Stock_Price:  96.42634168749277
curr_Factors:  [96.42634169]
mat_Sqrt:  [[0.15]]
grads:  [0.23156258]
Stock Position:  0.23156258462878176
Bond Position:  [-24.46884348]


portfolio before change:  [-2.11064502]
curr_Stock_Price:  96.56019275022103
curr_Factors:  [96.56019275]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245938]
Stock Position:  -0.02245937763040304
Bond Position:  [0.05803681]


portfolio before change:  [-2.09952114]
curr_Stock_Price:  96.06506510141175
curr_Factors:  [96.0650651]
mat_Sqrt:  [[0.15]]
grads:  [0.09728315]
Stock Position:  0.09728314594011571
Bond Position:  [-11.44503288]


portfolio before change:  [-2.04711539]
curr_Stock_Price:  96.61111116380003
curr_Factors:  [96.61111116]
mat_Sqrt:  [[0.15]]
grads:  [-0.20805255]
Stock Position:  -0.20805255054164595
Bond Position:  [18.05307269]


portfolio before change:  [-1.98084893]
curr_Stock_Price:  96.2980262862176
curr_Factors:  [96.29802629]
mat_Sqrt:  [[0.15]]
grads:  [0.13783178]
Stock Position:  0.1378317785759246
Bond Position:  [-15.25377717]


portfolio before change:  [-2.00039715]
curr_Stock_Price:  96.16311669521257
curr_Factors:  [96.1631167]
mat_Sqrt:  [[0.15]]
grads:  [0.06334831]
Stock Position:  0.06334831165940064
Bond Position:  [-8.09216824]


portfolio before change:  [-2.00683224]
curr_Stock_Price:  96.06951814424056
curr_Factors:  [96.06951814]
mat_Sqrt:  [[0.15]]
grads:  [0.03566671]
Stock Position:  0.035666710883285796
Bond Position:  [-5.43331597]


portfolio before change:  [-1.98185982]
curr_Stock_Price:  96.77919991820451
curr_Factors:  [96.77919992]
mat_Sqrt:  [[0.15]]
grads:  [-0.05292437]
Stock Position:  -0.05292436749677614
Bond Position:  [3.14011812]


portfolio before change:  [-1.95453789]
curr_Stock_Price:  96.2666635766498
curr_Factors:  [96.26666358]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081768]
Stock Position:  -0.000817684791509379
Bond Position:  [-1.87582211]


portfolio before change:  [-1.95470399]
curr_Stock_Price:  96.32640847767001
curr_Factors:  [96.32640848]
mat_Sqrt:  [[0.15]]
grads:  [-0.0233508]
Stock Position:  -0.02335080014208647
Bond Position:  [0.29459472]


portfolio before change:  [-1.94430306]
curr_Stock_Price:  95.88177655119289
curr_Factors:  [95.88177655]
mat_Sqrt:  [[0.15]]
grads:  [-0.01439703]
Stock Position:  -0.01439702834704715
Bond Position:  [-0.56389041]


portfolio before change:  [-1.93991747]
curr_Stock_Price:  95.574710383631
curr_Factors:  [95.57471038]
mat_Sqrt:  [[0.15]]
grads:  [-0.00263507]
Stock Position:  -0.002635068231818004
Bond Position:  [-1.68807159]


portfolio before change:  [-1.94116784]
curr_Stock_Price:  96.009182080816
curr_Factors:  [96.00918208]
mat_Sqrt:  [[0.15]]
grads:  [0.05233337]
Stock Position:  0.052333374953861804
Bond Position:  [-6.96565236]


portfolio before change:  [-1.98033697]
curr_Stock_Price:  95.26904698520514
curr_Factors:  [95.26904699]
mat_Sqrt:  [[0.15]]
grads:  [-0.09401441]
Stock Position:  -0.09401440968056289
Bond Position:  [6.97632624]


portfolio before change:  [-2.00131287]
curr_Stock_Price:  95.49679858638335
curr_Factors:  [95.49679859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0343156]
Stock Position:  -0.03431560199861458
Bond Position:  [1.27571726]


portfolio before change:  [-2.03042043]
curr_Stock_Price:  96.34735321034636
curr_Factors:  [96.34735321]
mat_Sqrt:  [[0.15]]
grads:  [-0.00936911]
Stock Position:  -0.009369110655564753
Bond Position:  [-1.12773142]


portfolio before change:  [-2.03032825]
curr_Stock_Price:  96.3299911090425
curr_Factors:  [96.32999111]
mat_Sqrt:  [[0.15]]
grads:  [0.08565712]
Stock Position:  0.08565712032435109
Bond Position:  [-10.28167789]


portfolio before change:  [-2.08078293]
curr_Stock_Price:  95.7484626289518
curr_Factors:  [95.74846263]
mat_Sqrt:  [[0.15]]
grads:  [0.04613097]
Stock Position:  0.04613097308415327
Bond Position:  [-6.49775268]


portfolio before change:  [-2.09386499]
curr_Stock_Price:  95.4736810274663
curr_Factors:  [95.47368103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01777501]
Stock Position:  -0.017775007757998992
Bond Position:  [-0.39681957]


portfolio before change:  [-2.09721711]
curr_Stock_Price:  95.66087162004587
curr_Factors:  [95.66087162]
mat_Sqrt:  [[0.15]]
grads:  [-0.03411893]
Stock Position:  -0.03411892581411621
Bond Position:  [1.16662907]


portfolio before change:  [-2.09979598]
curr_Stock_Price:  95.73859356593054
curr_Factors:  [95.73859357]
mat_Sqrt:  [[0.15]]
grads:  [-0.01471672]
Stock Position:  -0.014716716031531966
Bond Position:  [-0.69083829]


portfolio before change:  [-2.10250485]
curr_Stock_Price:  95.91972696964008
curr_Factors:  [95.91972697]
mat_Sqrt:  [[0.15]]
grads:  [-0.0144614]
Stock Position:  -0.014461400129536981
Bond Position:  [-0.7153713]


portfolio before change:  [-2.10861439]
curr_Stock_Price:  96.33910712005043
curr_Factors:  [96.33910712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01969099]
Stock Position:  -0.019690985566061227
Bond Position:  [-0.21160242]


portfolio before change:  [-2.1113618]
curr_Stock_Price:  96.47796173507493
curr_Factors:  [96.47796174]
mat_Sqrt:  [[0.15]]
grads:  [0.12600087]
Stock Position:  0.1260008730107753
Bond Position:  [-14.2676692]


portfolio before change:  [-2.18308889]
curr_Stock_Price:  95.9157804114402
curr_Factors:  [95.91578041]
mat_Sqrt:  [[0.15]]
grads:  [0.03874765]
Stock Position:  0.038747651007315004
Bond Position:  [-5.89960008]


portfolio before change:  [-2.21023261]
curr_Stock_Price:  95.22477130667559
curr_Factors:  [95.22477131]
mat_Sqrt:  [[0.15]]
grads:  [0.13531139]
Stock Position:  0.13531139168758002
Bond Position:  [-15.09522894]


portfolio before change:  [-2.16390944]
curr_Stock_Price:  95.57408888851525
curr_Factors:  [95.57408889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02209768]
Stock Position:  -0.022097684825663846
Bond Position:  [-0.05194335]


portfolio before change:  [-2.1788644]
curr_Stock_Price:  96.25070784295805
curr_Factors:  [96.25070784]
mat_Sqrt:  [[0.15]]
grads:  [0.03686534]
Stock Position:  0.03686533991024291
Bond Position:  [-5.72717946]


portfolio before change:  [-2.19392146]
curr_Stock_Price:  95.85198363339042
curr_Factors:  [95.85198363]
mat_Sqrt:  [[0.15]]
grads:  [0.17170904]
Stock Position:  0.1717090385935752
Bond Position:  [-18.65257342]


portfolio before change:  [-2.19168964]
curr_Stock_Price:  95.87177086070442
curr_Factors:  [95.87177086]
mat_Sqrt:  [[0.15]]
grads:  [0.02143006]
Stock Position:  0.021430060871931444
Bond Position:  [-4.24622752]


portfolio before change:  [-2.2036672]
curr_Stock_Price:  95.325241275115
curr_Factors:  [95.32524128]
mat_Sqrt:  [[0.15]]
grads:  [-0.10179387]
Stock Position:  -0.10179387037063208
Bond Position:  [7.49985805]


portfolio before change:  [-2.29817681]
curr_Stock_Price:  96.25828725674504
curr_Factors:  [96.25828726]
mat_Sqrt:  [[0.15]]
grads:  [-0.0392333]
Stock Position:  -0.039233299989714365
Bond Position:  [1.47835346]


portfolio before change:  [-2.27878999]
curr_Stock_Price:  95.76650046612926
curr_Factors:  [95.76650047]
mat_Sqrt:  [[0.15]]
grads:  [0.01525629]
Stock Position:  0.015256290657509348
Bond Position:  [-3.73983155]


portfolio before change:  [-2.28597801]
curr_Stock_Price:  95.31067033376428
curr_Factors:  [95.31067033]
mat_Sqrt:  [[0.15]]
grads:  [0.07467138]
Stock Position:  0.07467137700314304
Bond Position:  [-9.40295701]


portfolio before change:  [-2.30282081]
curr_Stock_Price:  95.0929819044739
curr_Factors:  [95.0929819]
mat_Sqrt:  [[0.15]]
grads:  [0.05259743]
Stock Position:  0.05259743186359074
Bond Position:  [-7.30446744]


portfolio before change:  [-2.33769458]
curr_Stock_Price:  94.43862997104925
curr_Factors:  [94.43862997]
mat_Sqrt:  [[0.15]]
grads:  [0.01352046]
Stock Position:  0.013520461041134335
Bond Position:  [-3.6145484]


portfolio before change:  [-2.33655844]
curr_Stock_Price:  94.539370917533
curr_Factors:  [94.53937092]
mat_Sqrt:  [[0.15]]
grads:  [-0.16103556]
Stock Position:  -0.16103555747580542
Bond Position:  [12.88764186]


portfolio before change:  [-2.29465122]
curr_Stock_Price:  94.28413713119085
curr_Factors:  [94.28413713]
mat_Sqrt:  [[0.15]]
grads:  [-0.20916291]
Stock Position:  -0.20916290949583805
Bond Position:  [17.42609322]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.19818131]
Stock Price:  93.82812538423796
PL:  [-2.19818131]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.99237911e-03]
 [ 1.33394125e-02]
 [ 8.16858714e-03]
 [-8.07681020e-03]
 [ 1.32552357e-02]
 [-1.04821100e-02]
 [-1.19550586e-03]
 [ 4.52565021e-03]
 [-2.08087629e-02]
 [-1.37395523e-02]
 [-6.01650918e-06]
 [-5.44164146e-03]
 [-6.61609916e-04]
 [-1.19253816e-02]
 [ 5.74664581e-03]
 [ 1.08793794e-03]
 [-3.77486919e-02]
 [-1.09811136e-02]
 [ 2.36495556e-02]
 [-4.49520004e-03]
 [-2.74494308e-02]
 [ 6.43321537e-03]
 [ 1.69199174e-02]
 [ 5.34419785e-03]
 [ 1.57327744e-02]
 [ 4.45369866e-03]
 [ 7.59402169e-05]
 [ 2.36768093e-02]
 [-3.36725505e-02]
 [ 1.07438845e-01]
 [-5.05473957e-03]
 [ 3.92352152e-02]
 [ 1.60735506e-02]
 [-1.84685123e-02]
 [-2.96273145e-02]
 [-1.69805715e-01]
 [ 3.06139259e-02]
 [-1.73632600e-02]
 [ 1.56739889e-01]
 [ 5.30789647e-02]
 [ 6.09264100e-03]
 [ 3.26022552e-02]
 [-1.07796275e-02]
 [ 8.51067422e-02]
 [-1.73984692e-01]
 [ 3.92038716e-02]
 [ 6.05453497e-03]
 [ 5.76223928e-03]
 [-3.95537267e-02]
 [ 1.64739413e-03]
 [ 1.11020203e-02]
 [-1.21247213e-03]
 [-5.75094454e-03]
 [-2.06189499e-02]
 [-4.88042277e-02]
 [-7.24840728e-03]
 [-2.34415075e-02]
 [ 2.12444274e-02]
 [-1.62189078e-03]
 [-6.04625237e-04]
 [-5.36574046e-03]
 [-1.23568333e-02]
 [ 1.78997017e-02]
 [-2.01470162e-02]
 [ 9.90336064e-03]
 [ 2.54065003e-02]
 [ 2.14623495e-02]
 [-1.58252170e-02]
 [ 1.79572515e-02]
 [ 4.23768086e-02]
 [ 4.56076181e-03]
 [-1.43476307e-02]
 [-1.08422781e-02]
 [ 6.48916693e-03]
 [ 1.24757178e-02]
 [ 6.23124170e-02]
 [ 1.95791011e-02]
 [-7.81784822e-02]
 [-4.79312622e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.84840564]
curr_Stock_Price:  100.67302563526006
curr_Factors:  [100.67302564]
mat_Sqrt:  [[0.15]]
grads:  [-0.03328253]
Stock Position:  -0.03328252742006281
Bond Position:  [20.19905838]


portfolio before change:  [16.86780582]
curr_Stock_Price:  100.12806418894623
curr_Factors:  [100.12806419]
mat_Sqrt:  [[0.15]]
grads:  [0.08892942]
Stock Position:  0.08892941692827734
Bond Position:  [7.96347545]


portfolio before change:  [16.87847553]
curr_Stock_Price:  100.24244681309834
curr_Factors:  [100.24244681]
mat_Sqrt:  [[0.15]]
grads:  [0.05445725]
Stock Position:  0.05445724761982347
Bond Position:  [11.41954778]


portfolio before change:  [16.88283123]
curr_Stock_Price:  100.30932416367614
curr_Factors:  [100.30932416]
mat_Sqrt:  [[0.15]]
grads:  [-0.0538454]
Stock Position:  -0.05384540131144871
Bond Position:  [22.28402705]


portfolio before change:  [16.91313846]
curr_Stock_Price:  99.77233430466042
curr_Factors:  [99.7723343]
mat_Sqrt:  [[0.15]]
grads:  [0.08836824]
Stock Position:  0.08836823828505067
Bond Position:  [8.09643305]


portfolio before change:  [16.89706844]
curr_Stock_Price:  99.5847548377838
curr_Factors:  [99.58475484]
mat_Sqrt:  [[0.15]]
grads:  [-0.06988073]
Stock Position:  -0.06988073313753422
Bond Position:  [23.85612411]


portfolio before change:  [16.91443605]
curr_Stock_Price:  99.35755973769959
curr_Factors:  [99.35755974]
mat_Sqrt:  [[0.15]]
grads:  [-0.00797004]
Stock Position:  -0.00797003908268568
Bond Position:  [17.70631968]


portfolio before change:  [16.91634993]
curr_Stock_Price:  99.25628023105597
curr_Factors:  [99.25628023]
mat_Sqrt:  [[0.15]]
grads:  [0.030171]
Stock Position:  0.03017100142148961
Bond Position:  [13.92168856]


portfolio before change:  [16.88762059]
curr_Stock_Price:  98.27522315364207
curr_Factors:  [98.27522315]
mat_Sqrt:  [[0.15]]
grads:  [-0.13872509]
Stock Position:  -0.1387250862123316
Bond Position:  [30.52085939]


portfolio before change:  [17.0389019]
curr_Stock_Price:  97.19846260442449
curr_Factors:  [97.1984626]
mat_Sqrt:  [[0.15]]
grads:  [-0.09159702]
Stock Position:  -0.09159701559483843
Bond Position:  [25.941991]


portfolio before change:  [17.04996998]
curr_Stock_Price:  97.0953298237153
curr_Factors:  [97.09532982]
mat_Sqrt:  [[0.15]]
grads:  [-4.01100612e-05]
Stock Position:  -4.0110061209746216e-05
Bond Position:  [17.05386448]


portfolio before change:  [17.05104436]
curr_Stock_Price:  96.88396626461981
curr_Factors:  [96.88396626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03627761]
Stock Position:  -0.03627760973471344
Bond Position:  [20.56576308]


portfolio before change:  [17.07733689]
curr_Stock_Price:  96.1946394321698
curr_Factors:  [96.19463943]
mat_Sqrt:  [[0.15]]
grads:  [-0.00441073]
Stock Position:  -0.004410732770689224
Bond Position:  [17.50162574]


portfolio before change:  [17.07921103]
curr_Stock_Price:  96.01774099074689
curr_Factors:  [96.01774099]
mat_Sqrt:  [[0.15]]
grads:  [-0.07950254]
Stock Position:  -0.07950254421025825
Bond Position:  [24.71286573]


portfolio before change:  [17.01513579]
curr_Stock_Price:  96.84312141868836
curr_Factors:  [96.84312142]
mat_Sqrt:  [[0.15]]
grads:  [0.03831097]
Stock Position:  0.03831097204865014
Bond Position:  [13.30498167]


portfolio before change:  [17.0104719]
curr_Stock_Price:  96.69967749071259
curr_Factors:  [96.69967749]
mat_Sqrt:  [[0.15]]
grads:  [0.00725292]
Stock Position:  0.007252919579477287
Bond Position:  [16.30911691]


portfolio before change:  [17.01179712]
curr_Stock_Price:  96.74185012104405
curr_Factors:  [96.74185012]
mat_Sqrt:  [[0.15]]
grads:  [-0.25165795]
Stock Position:  -0.2516579460992534
Bond Position:  [41.35765243]


portfolio before change:  [16.94127244]
curr_Stock_Price:  97.03236197430427
curr_Factors:  [97.03236197]
mat_Sqrt:  [[0.15]]
grads:  [-0.07320742]
Stock Position:  -0.07320742417818112
Bond Position:  [24.04476172]


portfolio before change:  [16.96539949]
curr_Stock_Price:  96.72331953240081
curr_Factors:  [96.72331953]
mat_Sqrt:  [[0.15]]
grads:  [0.1576637]
Stock Position:  0.15766370393635973
Bond Position:  [1.71564267]


portfolio before change:  [16.90919982]
curr_Stock_Price:  96.36618664282021
curr_Factors:  [96.36618664]
mat_Sqrt:  [[0.15]]
grads:  [-0.029968]
Stock Position:  -0.029968000241762008
Bond Position:  [19.79710173]


portfolio before change:  [16.92622417]
curr_Stock_Price:  95.83939173591043
curr_Factors:  [95.83939174]
mat_Sqrt:  [[0.15]]
grads:  [-0.18299621]
Stock Position:  -0.18299620522551568
Bond Position:  [34.46446917]


portfolio before change:  [17.11332826]
curr_Stock_Price:  94.82871507397597
curr_Factors:  [94.82871507]
mat_Sqrt:  [[0.15]]
grads:  [0.0428881]
Stock Position:  0.04288810249465638
Bond Position:  [13.04630461]


portfolio before change:  [17.11019061]
curr_Stock_Price:  94.73654323828171
curr_Factors:  [94.73654324]
mat_Sqrt:  [[0.15]]
grads:  [0.11279945]
Stock Position:  0.11279944931768579
Bond Position:  [6.4239607]


portfolio before change:  [17.16059326]
curr_Stock_Price:  95.17981795677143
curr_Factors:  [95.17981796]
mat_Sqrt:  [[0.15]]
grads:  [0.03562799]
Stock Position:  0.03562798565353599
Bond Position:  [13.76952807]


portfolio before change:  [17.16818834]
curr_Stock_Price:  95.36883943212081
curr_Factors:  [95.36883943]
mat_Sqrt:  [[0.15]]
grads:  [0.10488516]
Stock Position:  0.10488516296005833
Bond Position:  [7.16541207]


portfolio before change:  [17.18477234]
curr_Stock_Price:  95.5226853058171
curr_Factors:  [95.52268531]
mat_Sqrt:  [[0.15]]
grads:  [0.02969132]
Stock Position:  0.02969132436878397
Bond Position:  [14.34857731]


portfolio before change:  [17.18030271]
curr_Stock_Price:  95.34194414541525
curr_Factors:  [95.34194415]
mat_Sqrt:  [[0.15]]
grads:  [0.00050627]
Stock Position:  0.0005062681125317497
Bond Position:  [17.13203412]


portfolio before change:  [17.18106451]
curr_Stock_Price:  94.73161770506624
curr_Factors:  [94.73161771]
mat_Sqrt:  [[0.15]]
grads:  [0.1578454]
Stock Position:  0.15784539527743113
Bond Position:  [2.22811486]


portfolio before change:  [17.04518162]
curr_Stock_Price:  93.86987479086761
curr_Factors:  [93.86987479]
mat_Sqrt:  [[0.15]]
grads:  [-0.22448367]
Stock Position:  -0.22448366981510315
Bond Position:  [38.1174356]


portfolio before change:  [17.01823424]
curr_Stock_Price:  94.00052922962026
curr_Factors:  [94.00052923]
mat_Sqrt:  [[0.15]]
grads:  [0.71625897]
Stock Position:  0.7162589681369229
Bond Position:  [-50.31048783]


portfolio before change:  [16.21571841]
curr_Stock_Price:  92.88449247947423
curr_Factors:  [92.88449248]
mat_Sqrt:  [[0.15]]
grads:  [-0.03369826]
Stock Position:  -0.03369826378282483
Bond Position:  [19.34576454]


portfolio before change:  [16.2177673]
curr_Stock_Price:  92.85957310320724
curr_Factors:  [92.8595731]
mat_Sqrt:  [[0.15]]
grads:  [0.2615681]
Stock Position:  0.26156810135357134
Bond Position:  [-8.07133493]


portfolio before change:  [16.023909]
curr_Stock_Price:  92.12036285177193
curr_Factors:  [92.12036285]
mat_Sqrt:  [[0.15]]
grads:  [0.107157]
Stock Position:  0.10715700372164515
Bond Position:  [6.15256694]


portfolio before change:  [16.01858034]
curr_Stock_Price:  92.06704660352047
curr_Factors:  [92.0670466]
mat_Sqrt:  [[0.15]]
grads:  [-0.12312342]
Stock Position:  -0.12312341549914707
Bond Position:  [27.35418957]


portfolio before change:  [16.07718081]
curr_Stock_Price:  91.604983509046
curr_Factors:  [91.60498351]
mat_Sqrt:  [[0.15]]
grads:  [-0.19751543]
Stock Position:  -0.19751543009096673
Bond Position:  [34.17057853]


portfolio before change:  [16.20001906]
curr_Stock_Price:  90.99387924769468
curr_Factors:  [90.99387925]
mat_Sqrt:  [[0.15]]
grads:  [-1.1320381]
Stock Position:  -1.1320380980454552
Bond Position:  [119.20855706]


portfolio before change:  [16.3047082]
curr_Stock_Price:  90.90798252242796
curr_Factors:  [90.90798252]
mat_Sqrt:  [[0.15]]
grads:  [0.20409284]
Stock Position:  0.20409283919523122
Bond Position:  [-2.24896006]


portfolio before change:  [16.262908]
curr_Stock_Price:  90.70386151987468
curr_Factors:  [90.70386152]
mat_Sqrt:  [[0.15]]
grads:  [-0.11575507]
Stock Position:  -0.11575506679507991
Bond Position:  [26.76233955]


portfolio before change:  [16.32995515]
curr_Stock_Price:  90.13909611683626
curr_Factors:  [90.13909612]
mat_Sqrt:  [[0.15]]
grads:  [1.04493259]
Stock Position:  1.0449325928392648
Bond Position:  [-77.85932427]


portfolio before change:  [16.07383041]
curr_Stock_Price:  89.89864195835104
curr_Factors:  [89.89864196]
mat_Sqrt:  [[0.15]]
grads:  [0.35385976]
Stock Position:  0.35385976455944335
Bond Position:  [-15.73768187]


portfolio before change:  [15.91894526]
curr_Stock_Price:  89.46371964653576
curr_Factors:  [89.46371965]
mat_Sqrt:  [[0.15]]
grads:  [0.04061761]
Stock Position:  0.04061760668535448
Bond Position:  [12.28514309]


portfolio before change:  [15.94452617]
curr_Stock_Price:  90.07461387633616
curr_Factors:  [90.07461388]
mat_Sqrt:  [[0.15]]
grads:  [0.21734837]
Stock Position:  0.21734836830439308
Bond Position:  [-3.63304418]


portfolio before change:  [15.79825149]
curr_Stock_Price:  89.40266215554144
curr_Factors:  [89.40266216]
mat_Sqrt:  [[0.15]]
grads:  [-0.07186418]
Stock Position:  -0.07186418354399832
Bond Position:  [22.22310081]


portfolio before change:  [15.85807983]
curr_Stock_Price:  88.58947050016415
curr_Factors:  [88.5894705]
mat_Sqrt:  [[0.15]]
grads:  [0.56737828]
Stock Position:  0.5673782814481351
Bond Position:  [-34.4056617]


portfolio before change:  [15.96121197]
curr_Stock_Price:  88.77503023364623
curr_Factors:  [88.77503023]
mat_Sqrt:  [[0.15]]
grads:  [-1.15989795]
Stock Position:  -1.1598979482050347
Bond Position:  [118.93118739]


portfolio before change:  [16.19743729]
curr_Stock_Price:  88.57777849014423
curr_Factors:  [88.57777849]
mat_Sqrt:  [[0.15]]
grads:  [0.26135914]
Stock Position:  0.26135914373994773
Bond Position:  [-6.95317505]


portfolio before change:  [16.10154003]
curr_Stock_Price:  88.21252372195535
curr_Factors:  [88.21252372]
mat_Sqrt:  [[0.15]]
grads:  [0.04036357]
Stock Position:  0.040363566447818876
Bond Position:  [12.54096797]


portfolio before change:  [16.11188305]
curr_Stock_Price:  88.4493507337874
curr_Factors:  [88.44935073]
mat_Sqrt:  [[0.15]]
grads:  [0.03841493]
Stock Position:  0.03841492851224479
Bond Position:  [12.71410757]


portfolio before change:  [16.09288342]
curr_Stock_Price:  87.934074776314
curr_Factors:  [87.93407478]
mat_Sqrt:  [[0.15]]
grads:  [-0.26369151]
Stock Position:  -0.2636915116000176
Bond Position:  [39.28035252]


portfolio before change:  [16.16501889]
curr_Stock_Price:  87.66982521146157
curr_Factors:  [87.66982521]
mat_Sqrt:  [[0.15]]
grads:  [0.01098263]
Stock Position:  0.010982627504587446
Bond Position:  [15.20217385]


portfolio before change:  [16.16414357]
curr_Stock_Price:  87.50361028174211
curr_Factors:  [87.50361028]
mat_Sqrt:  [[0.15]]
grads:  [0.07401347]
Stock Position:  0.07401346874637278
Bond Position:  [9.68769785]


portfolio before change:  [16.12841017]
curr_Stock_Price:  87.012633328315
curr_Factors:  [87.01263333]
mat_Sqrt:  [[0.15]]
grads:  [-0.00808315]
Stock Position:  -0.008083147517564677
Bond Position:  [16.83174612]


portfolio before change:  [16.12487814]
curr_Stock_Price:  87.57974471246777
curr_Factors:  [87.57974471]
mat_Sqrt:  [[0.15]]
grads:  [-0.03833963]
Stock Position:  -0.038339630274517394
Bond Position:  [19.48265317]


portfolio before change:  [16.13091572]
curr_Stock_Price:  87.45402953280069
curr_Factors:  [87.45402953]
mat_Sqrt:  [[0.15]]
grads:  [-0.13745967]
Stock Position:  -0.1374596660908471
Bond Position:  [28.15231741]


portfolio before change:  [16.21110727]
curr_Stock_Price:  86.88344776386312
curr_Factors:  [86.88344776]
mat_Sqrt:  [[0.15]]
grads:  [-0.32536152]
Stock Position:  -0.32536151786614587
Bond Position:  [44.47963771]


portfolio before change:  [16.32320467]
curr_Stock_Price:  86.54746048396642
curr_Factors:  [86.54746048]
mat_Sqrt:  [[0.15]]
grads:  [-0.04832272]
Stock Position:  -0.048322715215590305
Bond Position:  [20.50541295]


portfolio before change:  [16.34674621]
curr_Stock_Price:  86.08680939588606
curr_Factors:  [86.0868094]
mat_Sqrt:  [[0.15]]
grads:  [-0.15627672]
Stock Position:  -0.15627671636605348
Bond Position:  [29.8001101]


portfolio before change:  [16.52125453]
curr_Stock_Price:  84.98206544558315
curr_Factors:  [84.98206545]
mat_Sqrt:  [[0.15]]
grads:  [0.14162952]
Stock Position:  0.14162951580410876
Bond Position:  [4.48528575]


portfolio before change:  [16.50236037]
curr_Stock_Price:  84.84668056071642
curr_Factors:  [84.84668056]
mat_Sqrt:  [[0.15]]
grads:  [-0.01081261]
Stock Position:  -0.0108126052058105
Bond Position:  [17.41977403]


portfolio before change:  [16.50595028]
curr_Stock_Price:  84.61536365965313
curr_Factors:  [84.61536366]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403083]
Stock Position:  -0.004030834912183256
Bond Position:  [16.84702084]


portfolio before change:  [16.51063846]
curr_Stock_Price:  83.71351372278475
curr_Factors:  [83.71351372]
mat_Sqrt:  [[0.15]]
grads:  [-0.0357716]
Stock Position:  -0.03577160309748073
Bond Position:  [19.50520505]


portfolio before change:  [16.4927191]
curr_Stock_Price:  84.24853227635785
curr_Factors:  [84.24853228]
mat_Sqrt:  [[0.15]]
grads:  [-0.08237889]
Stock Position:  -0.08237888892422383
Bond Position:  [23.43301958]


portfolio before change:  [16.45787028]
curr_Stock_Price:  84.68934216230313
curr_Factors:  [84.68934216]
mat_Sqrt:  [[0.15]]
grads:  [0.11933134]
Stock Position:  0.11933134491161175
Bond Position:  [6.35177718]


portfolio before change:  [16.47101597]
curr_Stock_Price:  84.79617655396072
curr_Factors:  [84.79617655]
mat_Sqrt:  [[0.15]]
grads:  [-0.13431344]
Stock Position:  -0.13431344113517926
Bond Position:  [27.86028224]


portfolio before change:  [16.45132067]
curr_Stock_Price:  84.95577807714182
curr_Factors:  [84.95577808]
mat_Sqrt:  [[0.15]]
grads:  [0.0660224]
Stock Position:  0.06602240427694285
Bond Position:  [10.84233594]


portfolio before change:  [16.42218337]
curr_Stock_Price:  84.50418947413716
curr_Factors:  [84.50418947]
mat_Sqrt:  [[0.15]]
grads:  [0.16937667]
Stock Position:  0.1693766687093656
Bond Position:  [2.10914526]


portfolio before change:  [16.39974746]
curr_Stock_Price:  84.37094957364198
curr_Factors:  [84.37094957]
mat_Sqrt:  [[0.15]]
grads:  [0.14308233]
Stock Position:  0.14308232979462346
Bond Position:  [4.32775543]


portfolio before change:  [16.48342991]
curr_Stock_Price:  84.95391432560633
curr_Factors:  [84.95391433]
mat_Sqrt:  [[0.15]]
grads:  [-0.10550145]
Stock Position:  -0.10550144657588297
Bond Position:  [25.44619076]


portfolio before change:  [16.51000078]
curr_Stock_Price:  84.71713618648573
curr_Factors:  [84.71713619]
mat_Sqrt:  [[0.15]]
grads:  [0.11971501]
Stock Position:  0.11971500983243288
Bond Position:  [6.36808799]


portfolio before change:  [16.49863411]
curr_Stock_Price:  84.61886374614001
curr_Factors:  [84.61886375]
mat_Sqrt:  [[0.15]]
grads:  [0.28251206]
Stock Position:  0.28251205728572976
Bond Position:  [-7.40721517]


portfolio before change:  [16.65194528]
curr_Stock_Price:  85.16317372752012
curr_Factors:  [85.16317373]
mat_Sqrt:  [[0.15]]
grads:  [0.03040508]
Stock Position:  0.030405078711698612
Bond Position:  [14.06255228]


portfolio before change:  [16.65231124]
curr_Stock_Price:  85.14630215745782
curr_Factors:  [85.14630216]
mat_Sqrt:  [[0.15]]
grads:  [-0.09565087]
Stock Position:  -0.09565087108654191
Bond Position:  [24.79662921]


portfolio before change:  [16.70837151]
curr_Stock_Price:  84.57641257063752
curr_Factors:  [84.57641257]
mat_Sqrt:  [[0.15]]
grads:  [-0.07228185]
Stock Position:  -0.07228185366999393
Bond Position:  [22.82171139]


portfolio before change:  [16.65224073]
curr_Stock_Price:  85.37270066328959
curr_Factors:  [85.37270066]
mat_Sqrt:  [[0.15]]
grads:  [0.04326111]
Stock Position:  0.04326111285617637
Bond Position:  [12.95892269]


portfolio before change:  [16.67323145]
curr_Stock_Price:  85.83918789120463
curr_Factors:  [85.83918789]
mat_Sqrt:  [[0.15]]
grads:  [0.08317145]
Stock Position:  0.08317145216241419
Bond Position:  [9.53386154]


portfolio before change:  [16.66318858]
curr_Stock_Price:  85.71127437421333
curr_Factors:  [85.71127437]
mat_Sqrt:  [[0.15]]
grads:  [0.41541611]
Stock Position:  0.4154161135746855
Bond Position:  [-18.94265591]


portfolio before change:  [16.63978303]
curr_Stock_Price:  85.6577819829425
curr_Factors:  [85.65778198]
mat_Sqrt:  [[0.15]]
grads:  [0.13052734]
Stock Position:  0.13052734036120525
Bond Position:  [5.45910056]


portfolio before change:  [16.63583431]
curr_Stock_Price:  85.6249159202915
curr_Factors:  [85.62491592]
mat_Sqrt:  [[0.15]]
grads:  [-0.52118988]
Stock Position:  -0.5211898816276304
Bond Position:  [61.2626741]


portfolio before change:  [16.25957796]
curr_Stock_Price:  86.35418063788254
curr_Factors:  [86.35418064]
mat_Sqrt:  [[0.15]]
grads:  [-0.03195417]
Stock Position:  -0.031954174817782066
Bond Position:  [19.01895454]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.25233131]
Stock Price:  86.61816390216642
PL:  [16.25233131]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.30859204e-02]
 [ 4.73283045e-02]
 [ 1.83379209e-02]
 [-6.76070819e-03]
 [ 1.21824598e-02]
 [-2.32332136e-03]
 [ 2.47158541e-03]
 [-8.90189869e-03]
 [-4.17302809e-04]
 [-4.13232316e-04]
 [-2.47382216e-03]
 [ 5.62193475e-03]
 [-2.99307175e-03]
 [ 5.09881522e-03]
 [ 4.19179756e-03]
 [ 1.14695055e-02]
 [ 6.26291061e-02]
 [-1.40555194e-02]
 [ 2.00501796e-02]
 [ 1.68742834e-04]
 [-6.43941185e-03]
 [ 6.24556404e-03]
 [ 9.10542170e-04]
 [ 4.48043733e-02]
 [ 9.32918801e-04]
 [ 7.52882119e-03]
 [-4.43430704e-03]
 [ 1.16821475e-02]
 [ 2.70836202e-02]
 [-7.41121843e-03]
 [ 1.15935740e-03]
 [ 1.49976044e-02]
 [ 1.54080995e-02]
 [-7.69905831e-03]
 [ 4.42606350e-03]
 [-5.03963666e-03]
 [-9.88730817e-03]
 [-1.02111291e-02]
 [-1.34302328e-02]
 [-3.17673826e-02]
 [ 3.67634538e-03]
 [ 8.73109478e-03]
 [-1.11715717e-02]
 [ 9.23772714e-03]
 [ 7.82696772e-04]
 [ 1.16130189e-02]
 [ 1.05682953e-02]
 [-2.82581344e-03]
 [ 1.38087479e-02]
 [-1.48604946e-03]
 [ 1.93324548e-02]
 [ 2.61948659e-02]
 [-8.21454751e-03]
 [-7.12477495e-02]
 [-2.01056389e-02]
 [-2.23127192e-03]
 [-3.93643485e-03]
 [-1.42888365e-02]
 [-2.60307980e-04]
 [-2.95019821e-03]
 [-7.67556608e-03]
 [-5.96966142e-03]
 [-1.63222999e-02]
 [-6.09311263e-04]
 [-1.18907564e-02]
 [ 3.22486456e-02]
 [-7.05696948e-03]
 [ 2.42481332e-02]
 [ 9.87079148e-03]
 [ 1.21547189e-02]
 [ 1.16306259e-02]
 [-1.41740083e-02]
 [-6.98603948e-02]
 [ 3.49030329e-04]
 [-1.33818282e-02]
 [-3.03584579e-02]
 [-6.62042720e-03]
 [ 2.55110665e-02]
 [ 1.14469199e-01]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.23599621]
curr_Stock_Price:  99.96394199307959
curr_Factors:  [99.96394199]
mat_Sqrt:  [[0.15]]
grads:  [-0.08723947]
Stock Position:  -0.0872394692926079
Bond Position:  [9.95679746]


portfolio before change:  [1.12616808]
curr_Stock_Price:  101.23000253108515
curr_Factors:  [101.23000253]
mat_Sqrt:  [[0.15]]
grads:  [0.31552203]
Stock Position:  0.31552202995650086
Bond Position:  [-30.81412781]


portfolio before change:  [0.89168823]
curr_Stock_Price:  100.49295760988484
curr_Factors:  [100.49295761]
mat_Sqrt:  [[0.15]]
grads:  [0.12225281]
Stock Position:  0.1222528059858589
Bond Position:  [-11.39385782]


portfolio before change:  [0.85927669]
curr_Stock_Price:  100.23366382120811
curr_Factors:  [100.23366382]
mat_Sqrt:  [[0.15]]
grads:  [-0.04507139]
Stock Position:  -0.0450713879132769
Bond Position:  [5.37694704]


portfolio before change:  [0.87442156]
curr_Stock_Price:  99.90510080244896
curr_Factors:  [99.9051008]
mat_Sqrt:  [[0.15]]
grads:  [0.0812164]
Stock Position:  0.08121639854465879
Bond Position:  [-7.23951093]


portfolio before change:  [0.92124271]
curr_Stock_Price:  100.48717093071964
curr_Factors:  [100.48717093]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548881]
Stock Position:  -0.015488809065038111
Bond Position:  [2.47766932]


portfolio before change:  [0.92894243]
curr_Stock_Price:  100.00005420470272
curr_Factors:  [100.0000542]
mat_Sqrt:  [[0.15]]
grads:  [0.01647724]
Stock Position:  0.016477236085040668
Bond Position:  [-0.71878207]


portfolio before change:  [0.93110883]
curr_Stock_Price:  100.13425887566835
curr_Factors:  [100.13425888]
mat_Sqrt:  [[0.15]]
grads:  [-0.05934599]
Stock Position:  -0.05934599126039774
Bond Position:  [6.87367568]


portfolio before change:  [0.92261664]
curr_Stock_Price:  100.28459428994648
curr_Factors:  [100.28459429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00278202]
Stock Position:  -0.0027820187289541907
Bond Position:  [1.20161026]


portfolio before change:  [0.92081838]
curr_Stock_Price:  100.957975096722
curr_Factors:  [100.9579751]
mat_Sqrt:  [[0.15]]
grads:  [-0.00275488]
Stock Position:  -0.0027548821041427827
Bond Position:  [1.1989457]


portfolio before change:  [0.9210589]
curr_Stock_Price:  100.89787103027041
curr_Factors:  [100.89787103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01649215]
Stock Position:  -0.016492147722568736
Bond Position:  [2.58508149]


portfolio before change:  [0.9205244]
curr_Stock_Price:  100.94007714307442
curr_Factors:  [100.94007714]
mat_Sqrt:  [[0.15]]
grads:  [0.03747956]
Stock Position:  0.037479564997163484
Bond Position:  [-2.86266578]


portfolio before change:  [0.91227608]
curr_Stock_Price:  100.72477574217963
curr_Factors:  [100.72477574]
mat_Sqrt:  [[0.15]]
grads:  [-0.01995381]
Stock Position:  -0.019953811642179922
Bond Position:  [2.92211928]


portfolio before change:  [0.89737591]
curr_Stock_Price:  101.48066184006102
curr_Factors:  [101.48066184]
mat_Sqrt:  [[0.15]]
grads:  [0.0339921]
Stock Position:  0.03399210148220635
Bond Position:  [-2.55216505]


portfolio before change:  [0.91617082]
curr_Stock_Price:  102.03827467538147
curr_Factors:  [102.03827468]
mat_Sqrt:  [[0.15]]
grads:  [0.02794532]
Stock Position:  0.02794531707832899
Bond Position:  [-1.93532112]


portfolio before change:  [0.91816022]
curr_Stock_Price:  102.11379214104122
curr_Factors:  [102.11379214]
mat_Sqrt:  [[0.15]]
grads:  [0.07646337]
Stock Position:  0.07646337002598115
Bond Position:  [-6.88980445]


portfolio before change:  [0.85489388]
curr_Stock_Price:  101.292016758938
curr_Factors:  [101.29201676]
mat_Sqrt:  [[0.15]]
grads:  [0.41752737]
Stock Position:  0.41752737392385664
Bond Position:  [-41.43729588]


portfolio before change:  [0.83352335]
curr_Stock_Price:  101.2470361906893
curr_Factors:  [101.24703619]
mat_Sqrt:  [[0.15]]
grads:  [-0.09370346]
Stock Position:  -0.09370346286286253
Bond Position:  [10.32072125]


portfolio before change:  [0.77046294]
curr_Stock_Price:  101.92689874682874
curr_Factors:  [101.92689875]
mat_Sqrt:  [[0.15]]
grads:  [0.13366786]
Stock Position:  0.1336678637607597
Bond Position:  [-12.85388788]


portfolio before change:  [0.9317648]
curr_Stock_Price:  103.13964540228172
curr_Factors:  [103.1396454]
mat_Sqrt:  [[0.15]]
grads:  [0.00112495]
Stock Position:  0.0011249522240383877
Bond Position:  [0.81573763]


portfolio before change:  [0.93163817]
curr_Stock_Price:  102.98175845437767
curr_Factors:  [102.98175845]
mat_Sqrt:  [[0.15]]
grads:  [-0.04292941]
Stock Position:  -0.04292941235744219
Bond Position:  [5.35258455]


portfolio before change:  [0.9162852]
curr_Stock_Price:  103.34718439089288
curr_Factors:  [103.34718439]
mat_Sqrt:  [[0.15]]
grads:  [0.04163709]
Stock Position:  0.04163709362079143
Bond Position:  [-3.38679119]


portfolio before change:  [0.93191359]
curr_Stock_Price:  103.72761607423526
curr_Factors:  [103.72761607]
mat_Sqrt:  [[0.15]]
grads:  [0.00607028]
Stock Position:  0.006070281136483271
Bond Position:  [0.3022578]


portfolio before change:  [0.93003755]
curr_Stock_Price:  103.41545115886517
curr_Factors:  [103.41545116]
mat_Sqrt:  [[0.15]]
grads:  [0.29869582]
Stock Position:  0.2986958222570028
Bond Position:  [-29.95972567]


portfolio before change:  [0.61298878]
curr_Stock_Price:  102.36027661423782
curr_Factors:  [102.36027661]
mat_Sqrt:  [[0.15]]
grads:  [0.00621946]
Stock Position:  0.006219458674375511
Bond Position:  [-0.02363673]


portfolio before change:  [0.60845256]
curr_Stock_Price:  101.6311554541247
curr_Factors:  [101.63115545]
mat_Sqrt:  [[0.15]]
grads:  [0.05019214]
Stock Position:  0.050192141289375124
Bond Position:  [-4.49263275]


portfolio before change:  [0.60328446]
curr_Stock_Price:  101.5337835728664
curr_Factors:  [101.53378357]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956205]
Stock Position:  -0.029562046912881328
Bond Position:  [3.60483094]


portfolio before change:  [0.60372201]
curr_Stock_Price:  101.52660400672777
curr_Factors:  [101.52660401]
mat_Sqrt:  [[0.15]]
grads:  [0.07788098]
Stock Position:  0.07788098348428141
Bond Position:  [-7.30326976]


portfolio before change:  [0.64739476]
curr_Stock_Price:  102.09322777057847
curr_Factors:  [102.09322777]
mat_Sqrt:  [[0.15]]
grads:  [0.18055747]
Stock Position:  0.18055746776319476
Bond Position:  [-17.78629992]


portfolio before change:  [0.85220259]
curr_Stock_Price:  103.23369294194893
curr_Factors:  [103.23369294]
mat_Sqrt:  [[0.15]]
grads:  [-0.04940812]
Stock Position:  -0.04940812287412317
Bond Position:  [5.95278557]


portfolio before change:  [0.85300591]
curr_Stock_Price:  103.22496439959785
curr_Factors:  [103.2249644]
mat_Sqrt:  [[0.15]]
grads:  [0.00772905]
Stock Position:  0.007729049350351179
Bond Position:  [0.05517506]


portfolio before change:  [0.85905468]
curr_Stock_Price:  104.00712105444495
curr_Factors:  [104.00712105]
mat_Sqrt:  [[0.15]]
grads:  [0.09998403]
Stock Position:  0.09998402928397487
Bond Position:  [-9.53999635]


portfolio before change:  [0.88295114]
curr_Stock_Price:  104.25208740457016
curr_Factors:  [104.2520874]
mat_Sqrt:  [[0.15]]
grads:  [0.10272066]
Stock Position:  0.10272066345660728
Bond Position:  [-9.82589245]


portfolio before change:  [0.88096913]
curr_Stock_Price:  104.2387709696154
curr_Factors:  [104.23877097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05132706]
Stock Position:  -0.05132705539504083
Bond Position:  [6.2312383]


portfolio before change:  [0.88443301]
curr_Stock_Price:  104.17887237028437
curr_Factors:  [104.17887237]
mat_Sqrt:  [[0.15]]
grads:  [0.02950709]
Stock Position:  0.02950709000711392
Bond Position:  [-2.18958235]


portfolio before change:  [0.88526229]
curr_Stock_Price:  104.21161492429276
curr_Factors:  [104.21161492]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359758]
Stock Position:  -0.03359757774207987
Bond Position:  [4.38652013]


portfolio before change:  [0.88144277]
curr_Stock_Price:  104.33345974988598
curr_Factors:  [104.33345975]
mat_Sqrt:  [[0.15]]
grads:  [-0.06591539]
Stock Position:  -0.06591538781031218
Bond Position:  [7.75862323]


portfolio before change:  [0.90394312]
curr_Stock_Price:  103.99946454769592
curr_Factors:  [103.99946455]
mat_Sqrt:  [[0.15]]
grads:  [-0.06807419]
Stock Position:  -0.06807419415642484
Bond Position:  [7.98362286]


portfolio before change:  [0.92386726]
curr_Stock_Price:  103.71411203053411
curr_Factors:  [103.71411203]
mat_Sqrt:  [[0.15]]
grads:  [-0.08953489]
Stock Position:  -0.08953488522546806
Bond Position:  [10.20989837]


portfolio before change:  [0.88240315]
curr_Stock_Price:  104.18434484788224
curr_Factors:  [104.18434485]
mat_Sqrt:  [[0.15]]
grads:  [-0.21178255]
Stock Position:  -0.21178255067183308
Bond Position:  [22.94682945]


portfolio before change:  [1.02487294]
curr_Stock_Price:  103.51839968277284
curr_Factors:  [103.51839968]
mat_Sqrt:  [[0.15]]
grads:  [0.02450897]
Stock Position:  0.024508969210760113
Bond Position:  [-1.51225633]


portfolio before change:  [1.02299833]
curr_Stock_Price:  103.44576931522415
curr_Factors:  [103.44576932]
mat_Sqrt:  [[0.15]]
grads:  [0.0582073]
Stock Position:  0.05820729855397257
Bond Position:  [-4.99830045]


portfolio before change:  [1.05085566]
curr_Stock_Price:  103.92972463814516
curr_Factors:  [103.92972464]
mat_Sqrt:  [[0.15]]
grads:  [-0.07447714]
Stock Position:  -0.07447714488823566
Bond Position:  [8.79124482]


portfolio before change:  [1.01952495]
curr_Stock_Price:  104.35777778552237
curr_Factors:  [104.35777779]
mat_Sqrt:  [[0.15]]
grads:  [0.06158485]
Stock Position:  0.06158484756685045
Bond Position:  [-5.40733289]


portfolio before change:  [1.01760758]
curr_Stock_Price:  104.33213191314863
curr_Factors:  [104.33213191]
mat_Sqrt:  [[0.15]]
grads:  [0.00521798]
Stock Position:  0.005217978482921701
Bond Position:  [0.47320476]


portfolio before change:  [1.01992743]
curr_Stock_Price:  104.77105033695418
curr_Factors:  [104.77105034]
mat_Sqrt:  [[0.15]]
grads:  [0.07742013]
Stock Position:  0.07742012574117273
Bond Position:  [-7.09146046]


portfolio before change:  [1.04802197]
curr_Stock_Price:  105.13965951530585
curr_Factors:  [105.13965952]
mat_Sqrt:  [[0.15]]
grads:  [0.0704553]
Stock Position:  0.07045530171219559
Bond Position:  [-6.35962447]


portfolio before change:  [1.04543455]
curr_Stock_Price:  105.10857696232328
curr_Factors:  [105.10857696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01883876]
Stock Position:  -0.018838756245354596
Bond Position:  [3.02554941]


portfolio before change:  [1.04112798]
curr_Stock_Price:  105.34721608527909
curr_Factors:  [105.34721609]
mat_Sqrt:  [[0.15]]
grads:  [0.09205832]
Stock Position:  0.09205831950885356
Bond Position:  [-8.65695969]


portfolio before change:  [1.09843028]
curr_Stock_Price:  105.97555009367512
curr_Factors:  [105.97555009]
mat_Sqrt:  [[0.15]]
grads:  [-0.009907]
Stock Position:  -0.00990699639948589
Bond Position:  [2.14832967]


portfolio before change:  [1.09636245]
curr_Stock_Price:  106.19782799347456
curr_Factors:  [106.19782799]
mat_Sqrt:  [[0.15]]
grads:  [0.12888303]
Stock Position:  0.12888303168154702
Bond Position:  [-12.59073558]


portfolio before change:  [1.23324757]
curr_Stock_Price:  107.26602191345805
curr_Factors:  [107.26602191]
mat_Sqrt:  [[0.15]]
grads:  [0.17463244]
Stock Position:  0.17463243922467694
Bond Position:  [-17.49887948]


portfolio before change:  [1.20188969]
curr_Stock_Price:  107.09271980739136
curr_Factors:  [107.09271981]
mat_Sqrt:  [[0.15]]
grads:  [-0.05476365]
Stock Position:  -0.054763650040529716
Bond Position:  [7.06667792]


portfolio before change:  [1.1695576]
curr_Stock_Price:  107.69117838219246
curr_Factors:  [107.69117838]
mat_Sqrt:  [[0.15]]
grads:  [-0.474985]
Stock Position:  -0.4749849965793909
Bond Position:  [52.32125159]


portfolio before change:  [1.4699112]
curr_Stock_Price:  107.06571984198946
curr_Factors:  [107.06571984]
mat_Sqrt:  [[0.15]]
grads:  [-0.13403759]
Stock Position:  -0.134037592388267
Bond Position:  [15.82074251]


portfolio before change:  [1.50603534]
curr_Stock_Price:  106.803589562846
curr_Factors:  [106.80358956]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487515]
Stock Position:  -0.014875146153063476
Bond Position:  [3.09475434]


portfolio before change:  [1.49767412]
curr_Stock_Price:  107.37868644721762
curr_Factors:  [107.37868645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262429]
Stock Position:  -0.026242899004688278
Bond Position:  [4.31560214]


portfolio before change:  [1.50943433]
curr_Stock_Price:  106.94083554487469
curr_Factors:  [106.94083554]
mat_Sqrt:  [[0.15]]
grads:  [-0.09525891]
Stock Position:  -0.09525890997246682
Bond Position:  [11.69650175]


portfolio before change:  [1.46548578]
curr_Stock_Price:  107.40986880581094
curr_Factors:  [107.40986881]
mat_Sqrt:  [[0.15]]
grads:  [-0.00173539]
Stock Position:  -0.0017353865333515593
Bond Position:  [1.65188342]


portfolio before change:  [1.46481474]
curr_Stock_Price:  107.85604338933618
curr_Factors:  [107.85604339]
mat_Sqrt:  [[0.15]]
grads:  [-0.01966799]
Stock Position:  -0.01966798803921767
Bond Position:  [3.58612611]


portfolio before change:  [1.46062966]
curr_Stock_Price:  108.08022588966566
curr_Factors:  [108.08022589]
mat_Sqrt:  [[0.15]]
grads:  [-0.05117044]
Stock Position:  -0.05117044052864544
Bond Position:  [6.99114244]


portfolio before change:  [1.45047792]
curr_Stock_Price:  108.2871559978427
curr_Factors:  [108.287156]
mat_Sqrt:  [[0.15]]
grads:  [-0.03979774]
Stock Position:  -0.039797742783677065
Bond Position:  [5.7600623]


portfolio before change:  [1.44194384]
curr_Stock_Price:  108.5106384409676
curr_Factors:  [108.51063844]
mat_Sqrt:  [[0.15]]
grads:  [-0.10881533]
Stock Position:  -0.1088153325865871
Bond Position:  [13.24956505]


portfolio before change:  [1.39463493]
curr_Stock_Price:  108.95301208423932
curr_Factors:  [108.95301208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00406208]
Stock Position:  -0.00406207508552948
Bond Position:  [1.83721024]


portfolio before change:  [1.39454426]
curr_Stock_Price:  109.00360150048859
curr_Factors:  [109.0036015]
mat_Sqrt:  [[0.15]]
grads:  [-0.07927171]
Stock Position:  -0.07927170936226836
Bond Position:  [10.03544608]


portfolio before change:  [1.40097585]
curr_Stock_Price:  108.93038044392729
curr_Factors:  [108.93038044]
mat_Sqrt:  [[0.15]]
grads:  [0.21499097]
Stock Position:  0.21499097088874497
Bond Position:  [-22.0180724]


portfolio before change:  [1.55130758]
curr_Stock_Price:  109.63602821370985
curr_Factors:  [109.63602821]
mat_Sqrt:  [[0.15]]
grads:  [-0.04704646]
Stock Position:  -0.047046463169711866
Bond Position:  [6.70929494]


portfolio before change:  [1.54147114]
curr_Stock_Price:  109.85402076847372
curr_Factors:  [109.85402077]
mat_Sqrt:  [[0.15]]
grads:  [0.16165422]
Stock Position:  0.16165422156679732
Bond Position:  [-16.21689507]


portfolio before change:  [1.57310396]
curr_Stock_Price:  110.05597281022993
curr_Factors:  [110.05597281]
mat_Sqrt:  [[0.15]]
grads:  [0.06580528]
Stock Position:  0.06580527651520293
Bond Position:  [-5.66915977]


portfolio before change:  [1.62884776]
curr_Stock_Price:  110.9084597554314
curr_Factors:  [110.90845976]
mat_Sqrt:  [[0.15]]
grads:  [0.08103146]
Stock Position:  0.08103145921309401
Bond Position:  [-7.35822657]


portfolio before change:  [1.64774668]
curr_Stock_Price:  111.1473647765085
curr_Factors:  [111.14736478]
mat_Sqrt:  [[0.15]]
grads:  [0.07753751]
Stock Position:  0.07753750594799186
Bond Position:  [-6.97034278]


portfolio before change:  [1.58089459]
curr_Stock_Price:  110.29079308759225
curr_Factors:  [110.29079309]
mat_Sqrt:  [[0.15]]
grads:  [-0.09449339]
Stock Position:  -0.0944933888717064
Bond Position:  [12.00264539]


portfolio before change:  [1.55692487]
curr_Stock_Price:  110.55239769582472
curr_Factors:  [110.5523977]
mat_Sqrt:  [[0.15]]
grads:  [-0.46573597]
Stock Position:  -0.4657359654376208
Bond Position:  [53.04515254]


portfolio before change:  [1.70648468]
curr_Stock_Price:  110.23839063526061
curr_Factors:  [110.23839064]
mat_Sqrt:  [[0.15]]
grads:  [0.00232687]
Stock Position:  0.002326868859396767
Bond Position:  [1.4499744]


portfolio before change:  [1.70469646]
curr_Stock_Price:  109.43093548015635
curr_Factors:  [109.43093548]
mat_Sqrt:  [[0.15]]
grads:  [-0.08921219]
Stock Position:  -0.08921218794838078
Bond Position:  [11.46726965]


portfolio before change:  [1.72144422]
curr_Stock_Price:  109.25123991025919
curr_Factors:  [109.25123991]
mat_Sqrt:  [[0.15]]
grads:  [-0.20238972]
Stock Position:  -0.20238971915644097
Bond Position:  [23.83277199]


portfolio before change:  [1.61445285]
curr_Stock_Price:  109.78724031426209
curr_Factors:  [109.78724031]
mat_Sqrt:  [[0.15]]
grads:  [-0.04413618]
Stock Position:  -0.0441361813429331
Bond Position:  [6.46004239]


portfolio before change:  [1.56300934]
curr_Stock_Price:  110.96195159226377
curr_Factors:  [110.96195159]
mat_Sqrt:  [[0.15]]
grads:  [0.17007378]
Stock Position:  0.1700737769360882
Bond Position:  [-17.30870886]


portfolio before change:  [1.61223396]
curr_Stock_Price:  111.25774349749554
curr_Factors:  [111.2577435]
mat_Sqrt:  [[0.15]]
grads:  [0.76312799]
Stock Position:  0.7631279926152109
Bond Position:  [-83.2916645]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.45168311]
Stock Price:  111.05418005538479
PL:  [-9.60249695]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.40213911e-02]
 [-1.21206270e-02]
 [ 4.11962792e-03]
 [-1.67225231e-02]
 [-4.70626807e-02]
 [-1.69931901e-03]
 [ 1.37092608e-02]
 [-4.03977307e-02]
 [ 1.73607364e-02]
 [-7.86074094e-03]
 [-1.03368050e-02]
 [ 1.43334683e-02]
 [-3.58242159e-03]
 [ 5.91343621e-03]
 [ 1.73320474e-03]
 [ 1.57242744e-02]
 [ 3.37186536e-02]
 [-1.47257038e-02]
 [ 2.00247208e-02]
 [ 2.35519325e-03]
 [-3.78615745e-03]
 [ 5.41946247e-03]
 [ 1.82372691e-02]
 [ 1.78433551e-02]
 [-5.77813114e-03]
 [ 4.65703562e-03]
 [-8.37469933e-04]
 [ 7.45043982e-03]
 [ 1.67097438e-02]
 [ 1.17629323e-03]
 [-5.64798249e-03]
 [ 1.18677406e-02]
 [ 1.25130934e-02]
 [ 9.00301497e-03]
 [ 6.30869051e-03]
 [ 1.01458039e-02]
 [-2.76346245e-02]
 [ 2.85233883e-03]
 [-5.65390344e-02]
 [ 1.37402169e-02]
 [ 7.06445878e-03]
 [ 6.33543889e-03]
 [-1.84131033e-03]
 [-1.90032160e-03]
 [ 2.18161239e-02]
 [ 1.54085214e-02]
 [ 1.07281591e-02]
 [ 4.72229532e-03]
 [-5.50820027e-04]
 [-1.33478207e-03]
 [-6.31255302e-03]
 [ 1.73192346e-03]
 [ 1.23450443e-03]
 [ 8.92075721e-03]
 [-5.68356911e-03]
 [-4.37478963e-03]
 [ 3.86377066e-03]
 [ 5.33164251e-03]
 [ 7.20001895e-03]
 [-4.01492238e-03]
 [-2.79390837e-04]
 [ 3.43184591e-03]
 [-8.38600581e-03]
 [ 7.77041776e-03]
 [ 2.23257672e-02]
 [ 5.46083619e-03]
 [ 7.53407702e-03]
 [-7.47243547e-04]
 [ 2.61371805e-03]
 [ 1.99343234e-02]
 [ 6.20556980e-04]
 [-1.56814042e-02]
 [-5.58121345e-04]
 [ 1.20253110e-03]
 [ 4.08441827e-03]
 [-1.58918437e-02]
 [-3.85647873e-03]
 [ 1.34699155e-02]
 [-4.78136015e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.74518292]
curr_Stock_Price:  99.78312499545981
curr_Factors:  [99.783125]
mat_Sqrt:  [[0.15]]
grads:  [-0.09347594]
Stock Position:  -0.09347594043755998
Bond Position:  [6.58213853]


portfolio before change:  [-2.69140818]
curr_Stock_Price:  99.21224714466541
curr_Factors:  [99.21224714]
mat_Sqrt:  [[0.15]]
grads:  [-0.08080418]
Stock Position:  -0.08080418020614168
Bond Position:  [5.32535611]


portfolio before change:  [-2.74044911]
curr_Stock_Price:  99.82327702190243
curr_Factors:  [99.82327702]
mat_Sqrt:  [[0.15]]
grads:  [0.02746419]
Stock Position:  0.027464186112128287
Bond Position:  [-5.48201416]


portfolio before change:  [-2.71674524]
curr_Stock_Price:  100.69883553512906
curr_Factors:  [100.69883554]
mat_Sqrt:  [[0.15]]
grads:  [-0.11148349]
Stock Position:  -0.11148348745965177
Bond Position:  [8.50951213]


portfolio before change:  [-2.85886716]
curr_Stock_Price:  101.97843112367983
curr_Factors:  [101.97843112]
mat_Sqrt:  [[0.15]]
grads:  [-0.3137512]
Stock Position:  -0.3137512044064836
Bond Position:  [29.13698843]


portfolio before change:  [-2.98737382]
curr_Stock_Price:  102.3938168742744
curr_Factors:  [102.39381687]
mat_Sqrt:  [[0.15]]
grads:  [-0.01132879]
Stock Position:  -0.011328793408790219
Bond Position:  [-1.82737542]


portfolio before change:  [-2.98711673]
curr_Stock_Price:  102.36104125561897
curr_Factors:  [102.36104126]
mat_Sqrt:  [[0.15]]
grads:  [0.09139507]
Stock Position:  0.09139507209255998
Bond Position:  [-12.34241147]


portfolio before change:  [-3.04194818]
curr_Stock_Price:  101.76954292332027
curr_Factors:  [101.76954292]
mat_Sqrt:  [[0.15]]
grads:  [-0.2693182]
Stock Position:  -0.26931820492345854
Bond Position:  [24.36644243]


portfolio before change:  [-3.28031706]
curr_Stock_Price:  102.66028041590944
curr_Factors:  [102.66028042]
mat_Sqrt:  [[0.15]]
grads:  [0.11573824]
Stock Position:  0.11573824247982752
Bond Position:  [-15.16203748]


portfolio before change:  [-3.2603936]
curr_Stock_Price:  102.84061076116609
curr_Factors:  [102.84061076]
mat_Sqrt:  [[0.15]]
grads:  [-0.05240494]
Stock Position:  -0.05240493962032414
Bond Position:  [2.1289624]


portfolio before change:  [-3.22324402]
curr_Stock_Price:  102.13425547790058
curr_Factors:  [102.13425548]
mat_Sqrt:  [[0.15]]
grads:  [-0.06891203]
Stock Position:  -0.06891203303646556
Bond Position:  [3.81503516]


portfolio before change:  [-3.18470423]
curr_Stock_Price:  101.57845493115364
curr_Factors:  [101.57845493]
mat_Sqrt:  [[0.15]]
grads:  [0.09555646]
Stock Position:  0.09555645537794798
Bond Position:  [-12.89118133]


portfolio before change:  [-3.20741676]
curr_Stock_Price:  101.34919985142265
curr_Factors:  [101.34919985]
mat_Sqrt:  [[0.15]]
grads:  [-0.02388281]
Stock Position:  -0.02388281060684732
Bond Position:  [-0.78691301]


portfolio before change:  [-3.19844538]
curr_Stock_Price:  100.97149875707727
curr_Factors:  [100.97149876]
mat_Sqrt:  [[0.15]]
grads:  [0.03942291]
Stock Position:  0.039422908065503345
Bond Position:  [-7.17903549]


portfolio before change:  [-3.18363086]
curr_Stock_Price:  101.35866520468032
curr_Factors:  [101.3586652]
mat_Sqrt:  [[0.15]]
grads:  [0.0115547]
Stock Position:  0.011554698282048801
Bond Position:  [-4.35479965]


portfolio before change:  [-3.19063758]
curr_Stock_Price:  100.77582471994069
curr_Factors:  [100.77582472]
mat_Sqrt:  [[0.15]]
grads:  [0.1048285]
Stock Position:  0.10482849572636142
Bond Position:  [-13.7548157]


portfolio before change:  [-3.27778862]
curr_Stock_Price:  99.95265798851973
curr_Factors:  [99.95265799]
mat_Sqrt:  [[0.15]]
grads:  [0.22479102]
Stock Position:  0.22479102425301786
Bond Position:  [-25.74624898]


portfolio before change:  [-3.2327089]
curr_Stock_Price:  100.1603571375936
curr_Factors:  [100.16035714]
mat_Sqrt:  [[0.15]]
grads:  [-0.09817136]
Stock Position:  -0.09817135840985522
Bond Position:  [6.60016941]


portfolio before change:  [-3.21333515]
curr_Stock_Price:  99.96721288847849
curr_Factors:  [99.96721289]
mat_Sqrt:  [[0.15]]
grads:  [0.13349814]
Stock Position:  0.13349813845149328
Bond Position:  [-16.55877197]


portfolio before change:  [-3.24162713]
curr_Stock_Price:  99.76303758557941
curr_Factors:  [99.76303759]
mat_Sqrt:  [[0.15]]
grads:  [0.01570129]
Stock Position:  0.01570128834318581
Bond Position:  [-4.80803534]


portfolio before change:  [-3.24585695]
curr_Stock_Price:  99.51278353862291
curr_Factors:  [99.51278354]
mat_Sqrt:  [[0.15]]
grads:  [-0.02524105]
Stock Position:  -0.02524104963494164
Bond Position:  [-0.73404984]


portfolio before change:  [-3.22418695]
curr_Stock_Price:  98.65244379758934
curr_Factors:  [98.6524438]
mat_Sqrt:  [[0.15]]
grads:  [0.03612975]
Stock Position:  0.03612974977310091
Bond Position:  [-6.78847506]


portfolio before change:  [-3.21075606]
curr_Stock_Price:  99.03592797214195
curr_Factors:  [99.03592797]
mat_Sqrt:  [[0.15]]
grads:  [0.12158179]
Stock Position:  0.12158179418313902
Bond Position:  [-15.25172187]


portfolio before change:  [-3.21547804]
curr_Stock_Price:  99.0049305178834
curr_Factors:  [99.00493052]
mat_Sqrt:  [[0.15]]
grads:  [0.1189557]
Stock Position:  0.11895570040268244
Bond Position:  [-14.9926789]


portfolio before change:  [-3.21381526]
curr_Stock_Price:  99.0267862064793
curr_Factors:  [99.02678621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03852087]
Stock Position:  -0.038520874234875546
Bond Position:  [0.60078312]


portfolio before change:  [-3.20828976]
curr_Stock_Price:  98.88431937182948
curr_Factors:  [98.88431937]
mat_Sqrt:  [[0.15]]
grads:  [0.0310469]
Stock Position:  0.03104690415483276
Bond Position:  [-6.27834175]


portfolio before change:  [-3.16745902]
curr_Stock_Price:  100.2120892699793
curr_Factors:  [100.21208927]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558313]
Stock Position:  -0.005583132887410046
Bond Position:  [-2.60796161]


portfolio before change:  [-3.16636926]
curr_Stock_Price:  99.98770475995634
curr_Factors:  [99.98770476]
mat_Sqrt:  [[0.15]]
grads:  [0.0496696]
Stock Position:  0.049669598823786784
Bond Position:  [-8.13271844]


portfolio before change:  [-3.19209128]
curr_Stock_Price:  99.48007610042882
curr_Factors:  [99.4800761]
mat_Sqrt:  [[0.15]]
grads:  [0.11139829]
Stock Position:  0.11139829173905265
Bond Position:  [-14.27400182]


portfolio before change:  [-3.11152522]
curr_Stock_Price:  100.21131003122575
curr_Factors:  [100.21131003]
mat_Sqrt:  [[0.15]]
grads:  [0.00784195]
Stock Position:  0.007841954853983226
Bond Position:  [-3.89737779]


portfolio before change:  [-3.10486006]
curr_Stock_Price:  101.09230890822907
curr_Factors:  [101.09230891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03765322]
Stock Position:  -0.0376532166134727
Bond Position:  [0.70159054]


portfolio before change:  [-3.10595983]
curr_Stock_Price:  101.1226812772409
curr_Factors:  [101.12268128]
mat_Sqrt:  [[0.15]]
grads:  [0.07911827]
Stock Position:  0.07911827075044968
Bond Position:  [-11.10661151]


portfolio before change:  [-3.1305816]
curr_Stock_Price:  100.82025319067898
curr_Factors:  [100.82025319]
mat_Sqrt:  [[0.15]]
grads:  [0.08342062]
Stock Position:  0.08342062294030456
Bond Position:  [-11.54106993]


portfolio before change:  [-3.10665914]
curr_Stock_Price:  101.11566937591591
curr_Factors:  [101.11566938]
mat_Sqrt:  [[0.15]]
grads:  [0.0600201]
Stock Position:  0.06002009980731205
Bond Position:  [-9.17563171]


portfolio before change:  [-3.06147805]
curr_Stock_Price:  101.8779904720554
curr_Factors:  [101.87799047]
mat_Sqrt:  [[0.15]]
grads:  [0.04205794]
Stock Position:  0.04205793671525979
Bond Position:  [-7.34625612]


portfolio before change:  [-3.09209277]
curr_Stock_Price:  101.16098991236821
curr_Factors:  [101.16098991]
mat_Sqrt:  [[0.15]]
grads:  [0.06763869]
Stock Position:  0.06763869241563704
Bond Position:  [-9.93448985]


portfolio before change:  [-3.10634466]
curr_Stock_Price:  100.95946365853112
curr_Factors:  [100.95946366]
mat_Sqrt:  [[0.15]]
grads:  [-0.18423083]
Stock Position:  -0.18423083026872242
Bond Position:  [15.49350115]


portfolio before change:  [-2.97663412]
curr_Stock_Price:  100.26065464818817
curr_Factors:  [100.26065465]
mat_Sqrt:  [[0.15]]
grads:  [0.01901559]
Stock Position:  0.019015592220855342
Bond Position:  [-4.88314985]


portfolio before change:  [-2.97597582]
curr_Stock_Price:  100.31132430985049
curr_Factors:  [100.31132431]
mat_Sqrt:  [[0.15]]
grads:  [-0.3769269]
Stock Position:  -0.3769268961686827
Bond Position:  [34.83406031]


portfolio before change:  [-3.02950876]
curr_Stock_Price:  100.45912522514497
curr_Factors:  [100.45912523]
mat_Sqrt:  [[0.15]]
grads:  [0.09160145]
Stock Position:  0.09160144599429057
Bond Position:  [-12.23170989]


portfolio before change:  [-3.07439943]
curr_Stock_Price:  99.97740612550379
curr_Factors:  [99.97740613]
mat_Sqrt:  [[0.15]]
grads:  [0.04709639]
Stock Position:  0.04709639185560318
Bond Position:  [-7.78297453]


portfolio before change:  [-3.02697047]
curr_Stock_Price:  100.99479652257676
curr_Factors:  [100.99479652]
mat_Sqrt:  [[0.15]]
grads:  [0.04223626]
Stock Position:  0.04223625925561138
Bond Position:  [-7.29261288]


portfolio before change:  [-3.05952627]
curr_Stock_Price:  100.23478590256377
curr_Factors:  [100.2347859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122754]
Stock Position:  -0.012275402184878059
Bond Position:  [-1.82910396]


portfolio before change:  [-3.05019849]
curr_Stock_Price:  99.46559637279384
curr_Factors:  [99.46559637]
mat_Sqrt:  [[0.15]]
grads:  [-0.01266881]
Stock Position:  -0.012668810696137118
Bond Position:  [-1.79008768]


portfolio before change:  [-3.05481421]
curr_Stock_Price:  99.82110255374523
curr_Factors:  [99.82110255]
mat_Sqrt:  [[0.15]]
grads:  [0.14544083]
Stock Position:  0.1454408262914175
Bond Position:  [-17.57287785]


portfolio before change:  [-3.0540649]
curr_Stock_Price:  99.83380637753511
curr_Factors:  [99.83380638]
mat_Sqrt:  [[0.15]]
grads:  [0.10272348]
Stock Position:  0.10272347588090905
Bond Position:  [-13.3093405]


portfolio before change:  [-3.10429557]
curr_Stock_Price:  99.35291518285273
curr_Factors:  [99.35291518]
mat_Sqrt:  [[0.15]]
grads:  [0.07152106]
Stock Position:  0.0715210608803703
Bond Position:  [-10.21012147]


portfolio before change:  [-3.11698168]
curr_Stock_Price:  99.18446196494398
curr_Factors:  [99.18446196]
mat_Sqrt:  [[0.15]]
grads:  [0.03148197]
Stock Position:  0.03148196876916751
Bond Position:  [-6.23950381]


portfolio before change:  [-3.13671902]
curr_Stock_Price:  98.5699080450448
curr_Factors:  [98.56990805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367213]
Stock Position:  -0.00367213351442607
Bond Position:  [-2.77475716]


portfolio before change:  [-3.13634535]
curr_Stock_Price:  98.42092050603539
curr_Factors:  [98.42092051]
mat_Sqrt:  [[0.15]]
grads:  [-0.00889855]
Stock Position:  -0.00889854713889495
Bond Position:  [-2.26054215]


portfolio before change:  [-3.13644858]
curr_Stock_Price:  98.41664369080563
curr_Factors:  [98.41664369]
mat_Sqrt:  [[0.15]]
grads:  [-0.04208369]
Stock Position:  -0.04208368678466276
Bond Position:  [1.00528663]


portfolio before change:  [-3.11868763]
curr_Stock_Price:  97.99609777961918
curr_Factors:  [97.99609778]
mat_Sqrt:  [[0.15]]
grads:  [0.01154616]
Stock Position:  0.011546156387290316
Bond Position:  [-4.2501659]


portfolio before change:  [-3.1139112]
curr_Stock_Price:  98.4327863354681
curr_Factors:  [98.43278634]
mat_Sqrt:  [[0.15]]
grads:  [0.00823003]
Stock Position:  0.008230029539443675
Bond Position:  [-3.92401593]


portfolio before change:  [-3.11160586]
curr_Stock_Price:  98.74269935282187
curr_Factors:  [98.74269935]
mat_Sqrt:  [[0.15]]
grads:  [0.05947171]
Stock Position:  0.05947171476533254
Bond Position:  [-8.98400351]


portfolio before change:  [-3.07211214]
curr_Stock_Price:  99.4162167707772
curr_Factors:  [99.41621677]
mat_Sqrt:  [[0.15]]
grads:  [-0.03789046]
Stock Position:  -0.03789046072684095
Bond Position:  [0.69481411]


portfolio before change:  [-3.0746776]
curr_Stock_Price:  99.48507000798476
curr_Factors:  [99.48507001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02916526]
Stock Position:  -0.029165264201521345
Bond Position:  [-0.17316925]


portfolio before change:  [-3.07864047]
curr_Stock_Price:  99.62057529425928
curr_Factors:  [99.62057529]
mat_Sqrt:  [[0.15]]
grads:  [0.02575847]
Stock Position:  0.02575847106217556
Bond Position:  [-5.64471417]


portfolio before change:  [-3.08094427]
curr_Stock_Price:  99.54483351846825
curr_Factors:  [99.54483352]
mat_Sqrt:  [[0.15]]
grads:  [0.03554428]
Stock Position:  0.035544283422196815
Bond Position:  [-6.61919404]


portfolio before change:  [-3.07146905]
curr_Stock_Price:  99.8230476864479
curr_Factors:  [99.82304769]
mat_Sqrt:  [[0.15]]
grads:  [0.04800013]
Stock Position:  0.04800012633385346
Bond Position:  [-7.86298795]


portfolio before change:  [-3.08390211]
curr_Stock_Price:  99.57426487137313
curr_Factors:  [99.57426487]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676615]
Stock Position:  -0.026766149218743394
Bond Position:  [-0.41868248]


portfolio before change:  [-3.0822738]
curr_Stock_Price:  99.51245249919253
curr_Factors:  [99.5124525]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186261]
Stock Position:  -0.0018626055769506665
Bond Position:  [-2.89692135]


portfolio before change:  [-3.08247335]
curr_Stock_Price:  99.52237440771165
curr_Factors:  [99.52237441]
mat_Sqrt:  [[0.15]]
grads:  [0.02287897]
Stock Position:  0.022878972760840655
Bond Position:  [-5.35944304]


portfolio before change:  [-3.06242684]
curr_Stock_Price:  100.41321358463902
curr_Factors:  [100.41321358]
mat_Sqrt:  [[0.15]]
grads:  [-0.05590671]
Stock Position:  -0.055906705391882305
Bond Position:  [2.55134511]


portfolio before change:  [-3.06607058]
curr_Stock_Price:  100.48124126754098
curr_Factors:  [100.48124127]
mat_Sqrt:  [[0.15]]
grads:  [0.05180279]
Stock Position:  0.0518027850546838
Bond Position:  [-8.27127872]


portfolio before change:  [-3.09541885]
curr_Stock_Price:  99.92468239959913
curr_Factors:  [99.9246824]
mat_Sqrt:  [[0.15]]
grads:  [0.14883845]
Stock Position:  0.14883844824042083
Bond Position:  [-17.96805352]


portfolio before change:  [-3.11176974]
curr_Stock_Price:  99.82237112994393
curr_Factors:  [99.82237113]
mat_Sqrt:  [[0.15]]
grads:  [0.03640557]
Stock Position:  0.03640557457465355
Bond Position:  [-6.74586051]


portfolio before change:  [-3.10945775]
curr_Stock_Price:  99.89745900036415
curr_Factors:  [99.897459]
mat_Sqrt:  [[0.15]]
grads:  [0.05022718]
Stock Position:  0.050227180132747726
Bond Position:  [-8.12702542]


portfolio before change:  [-3.12149635]
curr_Stock_Price:  99.66788904461724
curr_Factors:  [99.66788904]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498162]
Stock Position:  -0.0049816236487109505
Bond Position:  [-2.62498844]


portfolio before change:  [-3.12669368]
curr_Stock_Price:  100.67825473935142
curr_Factors:  [100.67825474]
mat_Sqrt:  [[0.15]]
grads:  [0.01742479]
Stock Position:  0.017424786975457712
Bond Position:  [-4.88099083]


portfolio before change:  [-3.11921413]
curr_Stock_Price:  101.12501037156568
curr_Factors:  [101.12501037]
mat_Sqrt:  [[0.15]]
grads:  [0.13289549]
Stock Position:  0.13289548950398067
Bond Position:  [-16.55827189]


portfolio before change:  [-2.99034892]
curr_Stock_Price:  102.1024712506799
curr_Factors:  [102.10247125]
mat_Sqrt:  [[0.15]]
grads:  [0.00413705]
Stock Position:  0.004137046532858236
Bond Position:  [-3.41275159]


portfolio before change:  [-2.99170003]
curr_Stock_Price:  101.82744108921226
curr_Factors:  [101.82744109]
mat_Sqrt:  [[0.15]]
grads:  [-0.10454269]
Stock Position:  -0.10454269436913063
Bond Position:  [7.65361502]


portfolio before change:  [-3.00043897]
curr_Stock_Price:  101.91560896319919
curr_Factors:  [101.91560896]
mat_Sqrt:  [[0.15]]
grads:  [-0.00372081]
Stock Position:  -0.003720808968999586
Bond Position:  [-2.62123046]


portfolio before change:  [-3.00346978]
curr_Stock_Price:  102.68613271990914
curr_Factors:  [102.68613272]
mat_Sqrt:  [[0.15]]
grads:  [0.00801687]
Stock Position:  0.008016873970863843
Bond Position:  [-3.82669156]


portfolio before change:  [-3.00258138]
curr_Stock_Price:  102.82678281140099
curr_Factors:  [102.82678281]
mat_Sqrt:  [[0.15]]
grads:  [0.02722946]
Stock Position:  0.027229455108461403
Bond Position:  [-5.80249864]


portfolio before change:  [-3.00099629]
curr_Stock_Price:  102.8983138631657
curr_Factors:  [102.89831386]
mat_Sqrt:  [[0.15]]
grads:  [-0.10594562]
Stock Position:  -0.10594562437798667
Bond Position:  [7.90062982]


portfolio before change:  [-2.9567666]
curr_Stock_Price:  102.48549937643668
curr_Factors:  [102.48549938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02570986]
Stock Position:  -0.025709858192590192
Bond Position:  [-0.32187894]


portfolio before change:  [-2.9656866]
curr_Stock_Price:  102.8316656487058
curr_Factors:  [102.83166565]
mat_Sqrt:  [[0.15]]
grads:  [0.08979944]
Stock Position:  0.08979943651163676
Bond Position:  [-12.19991224]


portfolio before change:  [-3.01115387]
curr_Stock_Price:  102.33383684989789
curr_Factors:  [102.33383685]
mat_Sqrt:  [[0.15]]
grads:  [-0.03187573]
Stock Position:  -0.03187573432959914
Bond Position:  [0.25081233]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.03631575]
Stock Price:  103.12370273410086
PL:  [-6.16001848]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.02675455e-02]
 [-3.39850766e-03]
 [ 3.48319303e-03]
 [-1.13735277e-02]
 [ 3.06973812e-03]
 [-6.27314720e-03]
 [ 1.48252927e-03]
 [-1.17537478e-02]
 [ 1.04155733e-02]
 [-2.03149323e-03]
 [-1.83566436e-03]
 [-2.68955931e-03]
 [-1.87491701e-03]
 [ 8.60164963e-03]
 [-2.30907979e-03]
 [ 1.51372697e-02]
 [ 4.97666971e-02]
 [-1.42658582e-02]
 [ 1.78352666e-02]
 [ 2.19648652e-03]
 [-4.14813819e-03]
 [ 4.61880271e-03]
 [ 1.66632022e-02]
 [ 1.77087110e-02]
 [-4.41179469e-03]
 [ 6.68152552e-03]
 [-4.25142772e-03]
 [ 1.06467293e-02]
 [ 3.42147068e-02]
 [-1.71253983e-03]
 [-4.30707749e-03]
 [ 8.93042510e-03]
 [ 1.25482470e-02]
 [ 9.47542202e-03]
 [ 5.20316980e-03]
 [ 1.19804740e-02]
 [-2.74807912e-02]
 [ 2.64308335e-03]
 [-5.50833029e-02]
 [-1.00105907e-03]
 [ 6.39250425e-03]
 [ 8.55454887e-03]
 [-3.16914857e-03]
 [-4.79322437e-03]
 [ 2.31104287e-02]
 [ 1.42908375e-02]
 [ 1.07709195e-02]
 [ 3.88083730e-03]
 [ 9.20798155e-03]
 [-2.01738715e-03]
 [ 2.45103803e-03]
 [-1.10480187e-02]
 [ 2.19848518e-03]
 [-2.84201703e-03]
 [-3.53501231e-03]
 [-3.43970732e-03]
 [ 9.63604633e-03]
 [ 3.17175289e-04]
 [ 6.85003897e-03]
 [-3.99761724e-03]
 [-1.02228826e-03]
 [ 5.72098878e-03]
 [-7.97592295e-03]
 [ 7.19993850e-03]
 [ 2.13717190e-02]
 [ 5.36230592e-03]
 [ 1.00496469e-02]
 [-2.13589993e-04]
 [ 2.82891797e-03]
 [ 2.22272137e-02]
 [ 2.55269851e-03]
 [-1.59367323e-02]
 [-5.32832266e-03]
 [ 1.23436833e-03]
 [ 2.51718332e-04]
 [-5.98685768e-03]
 [-4.11952961e-03]
 [ 7.72061993e-03]
 [-2.47134156e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.20177663]
curr_Stock_Price:  100.05322371138519
curr_Factors:  [100.05322371]
mat_Sqrt:  [[0.15]]
grads:  [-0.0684503]
Stock Position:  -0.06845030301781854
Bond Position:  [10.05045011]


portfolio before change:  [3.24100409]
curr_Stock_Price:  99.4893214122007
curr_Factors:  [99.48932141]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265672]
Stock Position:  -0.0226567177661559
Bond Position:  [5.49510556]


portfolio before change:  [3.22747512]
curr_Stock_Price:  100.10160860626206
curr_Factors:  [100.10160861]
mat_Sqrt:  [[0.15]]
grads:  [0.02322129]
Stock Position:  0.023221286843706293
Bond Position:  [0.90298696]


portfolio before change:  [3.23593866]
curr_Stock_Price:  100.4636515434392
curr_Factors:  [100.46365154]
mat_Sqrt:  [[0.15]]
grads:  [-0.07582352]
Stock Position:  -0.07582351815372568
Bond Position:  [10.85344617]


portfolio before change:  [3.236425]
curr_Stock_Price:  100.46618403411652
curr_Factors:  [100.46618403]
mat_Sqrt:  [[0.15]]
grads:  [0.02046492]
Stock Position:  0.020464920817412753
Bond Position:  [1.1803925]


portfolio before change:  [3.22637966]
curr_Stock_Price:  99.97172203973466
curr_Factors:  [99.97172204]
mat_Sqrt:  [[0.15]]
grads:  [-0.04182098]
Stock Position:  -0.041820981327917825
Bond Position:  [7.40729518]


portfolio before change:  [3.22011913]
curr_Stock_Price:  100.13249042283341
curr_Factors:  [100.13249042]
mat_Sqrt:  [[0.15]]
grads:  [0.00988353]
Stock Position:  0.009883528461223739
Bond Position:  [2.23045681]


portfolio before change:  [3.22224972]
curr_Stock_Price:  100.33395473198591
curr_Factors:  [100.33395473]
mat_Sqrt:  [[0.15]]
grads:  [-0.07835832]
Stock Position:  -0.07835831848841304
Bond Position:  [11.0842497]


portfolio before change:  [3.16340129]
curr_Stock_Price:  101.09381300179363
curr_Factors:  [101.093813]
mat_Sqrt:  [[0.15]]
grads:  [0.06943716]
Stock Position:  0.06943715509553912
Bond Position:  [-3.85626548]


portfolio before change:  [3.16881714]
curr_Stock_Price:  101.17528045816
curr_Factors:  [101.17528046]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354329]
Stock Position:  -0.013543288200000536
Bond Position:  [4.53906312]


portfolio before change:  [3.17329869]
curr_Stock_Price:  100.86532236682191
curr_Factors:  [100.86532237]
mat_Sqrt:  [[0.15]]
grads:  [-0.01223776]
Stock Position:  -0.012237762424951622
Bond Position:  [4.40766454]


portfolio before change:  [3.18354888]
curr_Stock_Price:  100.05024608472853
curr_Factors:  [100.05024608]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179304]
Stock Position:  -0.017930395407726424
Bond Position:  [4.97748936]


portfolio before change:  [3.18510785]
curr_Stock_Price:  99.9806510970405
curr_Factors:  [99.9806511]
mat_Sqrt:  [[0.15]]
grads:  [-0.01249945]
Stock Position:  -0.012499446745985049
Bond Position:  [4.43481068]


portfolio before change:  [3.18122412]
curr_Stock_Price:  100.31353952382538
curr_Factors:  [100.31353952]
mat_Sqrt:  [[0.15]]
grads:  [0.05734433]
Stock Position:  0.05734433085873956
Bond Position:  [-2.57118868]


portfolio before change:  [3.19536918]
curr_Stock_Price:  100.56301079306003
curr_Factors:  [100.56301079]
mat_Sqrt:  [[0.15]]
grads:  [-0.01539387]
Stock Position:  -0.015393865278948392
Bond Position:  [4.74342262]


portfolio before change:  [3.19426122]
curr_Stock_Price:  100.65424363696613
curr_Factors:  [100.65424364]
mat_Sqrt:  [[0.15]]
grads:  [0.10091513]
Stock Position:  0.10091513116222985
Bond Position:  [-6.96327498]


portfolio before change:  [3.20698868]
curr_Stock_Price:  100.78467675114827
curr_Factors:  [100.78467675]
mat_Sqrt:  [[0.15]]
grads:  [0.33177798]
Stock Position:  0.33177798069531517
Bond Position:  [-30.23114786]


portfolio before change:  [3.30181315]
curr_Stock_Price:  101.07617883696165
curr_Factors:  [101.07617884]
mat_Sqrt:  [[0.15]]
grads:  [-0.09510572]
Stock Position:  -0.09510572105999243
Bond Position:  [12.91473602]


portfolio before change:  [3.32447075]
curr_Stock_Price:  100.84643024610743
curr_Factors:  [100.84643025]
mat_Sqrt:  [[0.15]]
grads:  [0.11890178]
Stock Position:  0.11890177753396033
Bond Position:  [-8.66634907]


portfolio before change:  [3.29359405]
curr_Stock_Price:  100.59130339577717
curr_Factors:  [100.5913034]
mat_Sqrt:  [[0.15]]
grads:  [0.01464324]
Stock Position:  0.014643243499095418
Bond Position:  [1.8206111]


portfolio before change:  [3.28608656]
curr_Stock_Price:  100.07083943200439
curr_Factors:  [100.07083943]
mat_Sqrt:  [[0.15]]
grads:  [-0.02765425]
Stock Position:  -0.0276542545729817
Bond Position:  [6.05347103]


portfolio before change:  [3.29797279]
curr_Stock_Price:  99.65470539585532
curr_Factors:  [99.6547054]
mat_Sqrt:  [[0.15]]
grads:  [0.03079202]
Stock Position:  0.030792018069952996
Bond Position:  [0.2294033]


portfolio before change:  [3.30161332]
curr_Stock_Price:  99.77246951341256
curr_Factors:  [99.77246951]
mat_Sqrt:  [[0.15]]
grads:  [0.11108801]
Stock Position:  0.11108801476677817
Bond Position:  [-7.78191224]


portfolio before change:  [3.26968308]
curr_Stock_Price:  99.48941596507392
curr_Factors:  [99.48941597]
mat_Sqrt:  [[0.15]]
grads:  [0.11805807]
Stock Position:  0.11805807335153948
Bond Position:  [-8.47584569]


portfolio before change:  [3.35370621]
curr_Stock_Price:  100.20561338664498
curr_Factors:  [100.20561339]
mat_Sqrt:  [[0.15]]
grads:  [-0.02941196]
Stock Position:  -0.029411964583650915
Bond Position:  [6.30095016]


portfolio before change:  [3.33409765]
curr_Stock_Price:  100.88568979385268
curr_Factors:  [100.88568979]
mat_Sqrt:  [[0.15]]
grads:  [0.0445435]
Stock Position:  0.04454350347858319
Bond Position:  [-1.15970442]


portfolio before change:  [3.36349741]
curr_Stock_Price:  101.54734049359786
curr_Factors:  [101.54734049]
mat_Sqrt:  [[0.15]]
grads:  [-0.02834285]
Stock Position:  -0.02834285146355149
Bond Position:  [6.2416386]


portfolio before change:  [3.36753074]
curr_Stock_Price:  101.41879935639274
curr_Factors:  [101.41879936]
mat_Sqrt:  [[0.15]]
grads:  [0.0709782]
Stock Position:  0.07097819561129394
Bond Position:  [-3.83099264]


portfolio before change:  [3.35216034]
curr_Stock_Price:  101.2056217534905
curr_Factors:  [101.20562175]
mat_Sqrt:  [[0.15]]
grads:  [0.22809805]
Stock Position:  0.22809804561105135
Bond Position:  [-19.73264419]


portfolio before change:  [3.45215442]
curr_Stock_Price:  101.64941076932242
curr_Factors:  [101.64941077]
mat_Sqrt:  [[0.15]]
grads:  [-0.01141693]
Stock Position:  -0.011416932211653885
Bond Position:  [4.61267885]


portfolio before change:  [3.4536263]
curr_Stock_Price:  101.5457419385675
curr_Factors:  [101.54574194]
mat_Sqrt:  [[0.15]]
grads:  [-0.02871385]
Stock Position:  -0.028713849958777547
Bond Position:  [6.3693955]


portfolio before change:  [3.47957617]
curr_Stock_Price:  100.65586578974639
curr_Factors:  [100.65586579]
mat_Sqrt:  [[0.15]]
grads:  [0.05953617]
Stock Position:  0.05953616734142956
Bond Position:  [-2.5130883]


portfolio before change:  [3.49387296]
curr_Stock_Price:  100.89864035588424
curr_Factors:  [100.89864036]
mat_Sqrt:  [[0.15]]
grads:  [0.08365498]
Stock Position:  0.08365497977311444
Bond Position:  [-4.94680076]


portfolio before change:  [3.49117348]
curr_Stock_Price:  100.87006712674943
curr_Factors:  [100.87006713]
mat_Sqrt:  [[0.15]]
grads:  [0.06316948]
Stock Position:  0.06316948014795996
Bond Position:  [-2.88073622]


portfolio before change:  [3.49250493]
curr_Stock_Price:  100.89399478176023
curr_Factors:  [100.89399478]
mat_Sqrt:  [[0.15]]
grads:  [0.0346878]
Stock Position:  0.034687798661401696
Bond Position:  [-0.00728565]


portfolio before change:  [3.48061783]
curr_Stock_Price:  100.55131958643307
curr_Factors:  [100.55131959]
mat_Sqrt:  [[0.15]]
grads:  [0.07986983]
Stock Position:  0.0798698268105968
Bond Position:  [-4.55039865]


portfolio before change:  [3.49664882]
curr_Stock_Price:  100.7555945273802
curr_Factors:  [100.75559453]
mat_Sqrt:  [[0.15]]
grads:  [-0.18320527]
Stock Position:  -0.18320527458072336
Bond Position:  [21.95560518]


portfolio before change:  [3.56426468]
curr_Stock_Price:  100.3940132938853
curr_Factors:  [100.39401329]
mat_Sqrt:  [[0.15]]
grads:  [0.01762056]
Stock Position:  0.017620555636011243
Bond Position:  [1.79526638]


portfolio before change:  [3.56598762]
curr_Stock_Price:  100.48542538222956
curr_Factors:  [100.48542538]
mat_Sqrt:  [[0.15]]
grads:  [-0.36722202]
Stock Position:  -0.3672220194573388
Bond Position:  [40.46644845]


portfolio before change:  [3.75704462]
curr_Stock_Price:  99.97203632374277
curr_Factors:  [99.97203632]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667373]
Stock Position:  -0.006673727139476539
Bond Position:  [4.42423071]


portfolio before change:  [3.751039]
curr_Stock_Price:  100.91336116943978
curr_Factors:  [100.91336117]
mat_Sqrt:  [[0.15]]
grads:  [0.04261669]
Stock Position:  0.04261669497801916
Bond Position:  [-0.54955494]


portfolio before change:  [3.77174098]
curr_Stock_Price:  101.39993885583401
curr_Factors:  [101.39993886]
mat_Sqrt:  [[0.15]]
grads:  [0.05703033]
Stock Position:  0.05703032582035163
Bond Position:  [-2.01113057]


portfolio before change:  [3.73360416]
curr_Stock_Price:  100.73343171563188
curr_Factors:  [100.73343172]
mat_Sqrt:  [[0.15]]
grads:  [-0.02112766]
Stock Position:  -0.02112765713617348
Bond Position:  [5.86186557]


portfolio before change:  [3.73120783]
curr_Stock_Price:  100.86419460655407
curr_Factors:  [100.86419461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03195483]
Stock Position:  -0.03195482912389877
Bond Position:  [6.95430593]


portfolio before change:  [3.74366468]
curr_Stock_Price:  100.48796981411714
curr_Factors:  [100.48796981]
mat_Sqrt:  [[0.15]]
grads:  [0.15406952]
Stock Position:  0.15406952496156626
Bond Position:  [-11.73846909]


portfolio before change:  [3.80442535]
curr_Stock_Price:  100.88710353401353
curr_Factors:  [100.88710353]
mat_Sqrt:  [[0.15]]
grads:  [0.09527225]
Stock Position:  0.09527224968358088
Bond Position:  [-5.80731597]


portfolio before change:  [3.81846941]
curr_Stock_Price:  101.03832313077773
curr_Factors:  [101.03832313]
mat_Sqrt:  [[0.15]]
grads:  [0.07180613]
Stock Position:  0.07180613020658884
Bond Position:  [-3.43670158]


portfolio before change:  [3.77358311]
curr_Stock_Price:  100.41621051390246
curr_Factors:  [100.41621051]
mat_Sqrt:  [[0.15]]
grads:  [0.02587225]
Stock Position:  0.025872248677879985
Bond Position:  [1.17558994]


portfolio before change:  [3.76946656]
curr_Stock_Price:  100.2542598102018
curr_Factors:  [100.25425981]
mat_Sqrt:  [[0.15]]
grads:  [0.06138654]
Stock Position:  0.06138654369365184
Bond Position:  [-2.38479594]


portfolio before change:  [3.76120301]
curr_Stock_Price:  100.12207293562159
curr_Factors:  [100.12207294]
mat_Sqrt:  [[0.15]]
grads:  [-0.01344925]
Stock Position:  -0.013449247698066238
Bond Position:  [5.10776957]


portfolio before change:  [3.75781733]
curr_Stock_Price:  100.39754722666582
curr_Factors:  [100.39754723]
mat_Sqrt:  [[0.15]]
grads:  [0.01634025]
Stock Position:  0.01634025354246382
Bond Position:  [2.11729596]


portfolio before change:  [3.75935976]
curr_Stock_Price:  100.48384291825634
curr_Factors:  [100.48384292]
mat_Sqrt:  [[0.15]]
grads:  [-0.07365346]
Stock Position:  -0.07365345825963178
Bond Position:  [11.16034229]


portfolio before change:  [3.72829086]
curr_Stock_Price:  100.91513895064412
curr_Factors:  [100.91513895]
mat_Sqrt:  [[0.15]]
grads:  [0.01465657]
Stock Position:  0.014656567890857706
Bond Position:  [2.24922127]


portfolio before change:  [3.73919924]
curr_Stock_Price:  101.64981281616244
curr_Factors:  [101.64981282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01894678]
Stock Position:  -0.018946780191676643
Bond Position:  [5.6651359]


portfolio before change:  [3.74530097]
curr_Stock_Price:  101.34645496164231
curr_Factors:  [101.34645496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02356675]
Stock Position:  -0.023566748727066086
Bond Position:  [6.13370741]


portfolio before change:  [3.74031543]
curr_Stock_Price:  101.57427239485229
curr_Factors:  [101.57427239]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293138]
Stock Position:  -0.02293138215387268
Bond Position:  [6.06955388]


portfolio before change:  [3.7536221]
curr_Stock_Price:  101.01053327894141
curr_Factors:  [101.01053328]
mat_Sqrt:  [[0.15]]
grads:  [0.06424031]
Stock Position:  0.06424030883341593
Bond Position:  [-2.73532575]


portfolio before change:  [3.73667547]
curr_Stock_Price:  100.74939394581666
curr_Factors:  [100.74939395]
mat_Sqrt:  [[0.15]]
grads:  [0.0021145]
Stock Position:  0.0021145019254928286
Bond Position:  [3.52364068]


portfolio before change:  [3.73819186]
curr_Stock_Price:  101.36237767799138
curr_Factors:  [101.36237768]
mat_Sqrt:  [[0.15]]
grads:  [0.04566693]
Stock Position:  0.045666926437200286
Bond Position:  [-0.89071639]


portfolio before change:  [3.72883938]
curr_Stock_Price:  101.15879914865066
curr_Factors:  [101.15879915]
mat_Sqrt:  [[0.15]]
grads:  [-0.02665078]
Stock Position:  -0.026650781610457603
Bond Position:  [6.42480044]


portfolio before change:  [3.73972107]
curr_Stock_Price:  100.76556029053658
curr_Factors:  [100.76556029]
mat_Sqrt:  [[0.15]]
grads:  [-0.00681526]
Stock Position:  -0.0068152550404150065
Bond Position:  [4.42646406]


portfolio before change:  [3.74219511]
curr_Stock_Price:  100.44313859276156
curr_Factors:  [100.44313859]
mat_Sqrt:  [[0.15]]
grads:  [0.03813993]
Stock Position:  0.03813992521432116
Bond Position:  [-0.08869868]


portfolio before change:  [3.73111246]
curr_Stock_Price:  100.15270504479751
curr_Factors:  [100.15270504]
mat_Sqrt:  [[0.15]]
grads:  [-0.05317282]
Stock Position:  -0.05317281965132382
Bond Position:  [9.05651418]


portfolio before change:  [3.75318708]
curr_Stock_Price:  99.7482018053796
curr_Factors:  [99.74820181]
mat_Sqrt:  [[0.15]]
grads:  [0.04799959]
Stock Position:  0.04799958997425359
Bond Position:  [-1.0346857]


portfolio before change:  [3.75310467]
curr_Stock_Price:  99.74783216728929
curr_Factors:  [99.74783217]
mat_Sqrt:  [[0.15]]
grads:  [0.14247813]
Stock Position:  0.14247812677676389
Bond Position:  [-10.4587796]


portfolio before change:  [3.68635999]
curr_Stock_Price:  99.28396454405218
curr_Factors:  [99.28396454]
mat_Sqrt:  [[0.15]]
grads:  [0.03574871]
Stock Position:  0.03574870613872358
Bond Position:  [0.13708672]


portfolio before change:  [3.66347212]
curr_Stock_Price:  98.64348156759407
curr_Factors:  [98.64348157]
mat_Sqrt:  [[0.15]]
grads:  [0.06699765]
Stock Position:  0.0669976461330339
Bond Position:  [-2.94540895]


portfolio before change:  [3.68525124]
curr_Stock_Price:  98.97130219244025
curr_Factors:  [98.97130219]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142393]
Stock Position:  -0.001423933289764976
Bond Position:  [3.82617977]


portfolio before change:  [3.68564782]
curr_Stock_Price:  98.8607344533459
curr_Factors:  [98.86073445]
mat_Sqrt:  [[0.15]]
grads:  [0.01885945]
Stock Position:  0.018859453147814252
Bond Position:  [1.82118843]


portfolio before change:  [3.68170958]
curr_Stock_Price:  98.64587836949681
curr_Factors:  [98.64587837]
mat_Sqrt:  [[0.15]]
grads:  [0.14818142]
Stock Position:  0.14818142476671478
Bond Position:  [-10.93577722]


portfolio before change:  [3.68713502]
curr_Stock_Price:  98.6871044787264
curr_Factors:  [98.68710448]
mat_Sqrt:  [[0.15]]
grads:  [0.01701799]
Stock Position:  0.01701799004862649
Bond Position:  [2.00767885]


portfolio before change:  [3.69504941]
curr_Stock_Price:  99.14479119849037
curr_Factors:  [99.1447912]
mat_Sqrt:  [[0.15]]
grads:  [-0.10624488]
Stock Position:  -0.10624488230809387
Bond Position:  [14.22867608]


portfolio before change:  [3.66396405]
curr_Stock_Price:  99.44574387664926
curr_Factors:  [99.44574388]
mat_Sqrt:  [[0.15]]
grads:  [-0.03552215]
Stock Position:  -0.03552215107490808
Bond Position:  [7.19649078]


portfolio before change:  [3.65146658]
curr_Stock_Price:  99.81022806969344
curr_Factors:  [99.81022807]
mat_Sqrt:  [[0.15]]
grads:  [0.00822912]
Stock Position:  0.008229122172631451
Bond Position:  [2.83011602]


portfolio before change:  [3.65293184]
curr_Stock_Price:  99.9667911667403
curr_Factors:  [99.96679117]
mat_Sqrt:  [[0.15]]
grads:  [0.00167812]
Stock Position:  0.0016781222115053985
Bond Position:  [3.48517535]


portfolio before change:  [3.65359156]
curr_Stock_Price:  100.2301121569428
curr_Factors:  [100.23011216]
mat_Sqrt:  [[0.15]]
grads:  [-0.03991238]
Stock Position:  -0.03991238452019055
Bond Position:  [7.65401433]


portfolio before change:  [3.65734005]
curr_Stock_Price:  100.14818013127231
curr_Factors:  [100.14818013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02746353]
Stock Position:  -0.02746353070835299
Bond Position:  [6.40776267]


portfolio before change:  [3.66913013]
curr_Stock_Price:  99.73346366081213
curr_Factors:  [99.73346366]
mat_Sqrt:  [[0.15]]
grads:  [0.0514708]
Stock Position:  0.051470799528273395
Bond Position:  [-1.46423099]


portfolio before change:  [3.64441391]
curr_Stock_Price:  99.25504280186587
curr_Factors:  [99.2550428]
mat_Sqrt:  [[0.15]]
grads:  [-0.1647561]
Stock Position:  -0.16475610413635078
Bond Position:  [19.99728807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.60295841]
Stock Price:  99.51424631455832
PL:  [3.60295841]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.50705950e-03]
 [ 4.68921601e-02]
 [ 1.97255739e-02]
 [-3.31847907e-02]
 [-4.01259898e-02]
 [-1.21593430e-03]
 [-1.11709673e-03]
 [-1.30223722e-02]
 [-7.83858883e-03]
 [-5.32242561e-03]
 [ 1.23367128e-02]
 [-2.48037389e-03]
 [-6.07847630e-04]
 [ 1.30833876e-03]
 [ 8.29265059e-05]
 [ 1.10099372e-02]
 [ 2.98361500e-02]
 [-1.51461902e-02]
 [ 1.91952046e-02]
 [ 2.50897960e-03]
 [-3.98776410e-03]
 [ 4.45346943e-03]
 [ 1.55083984e-02]
 [ 1.91989482e-02]
 [-1.52055558e-03]
 [ 7.13844512e-03]
 [-6.73818095e-03]
 [ 6.43074710e-03]
 [ 3.13459955e-02]
 [ 4.99721445e-03]
 [-7.31626687e-03]
 [ 7.82207774e-03]
 [ 1.23090982e-02]
 [-5.56566405e-03]
 [-1.49551529e-04]
 [ 1.92163589e-02]
 [-1.55011498e-02]
 [ 2.91050178e-03]
 [-4.36838443e-02]
 [-1.21469260e-02]
 [ 7.19367165e-03]
 [-2.84564695e-03]
 [-1.41429979e-03]
 [-2.08267168e-03]
 [ 7.51766487e-03]
 [ 1.46633501e-02]
 [ 1.09068839e-02]
 [ 3.88522484e-03]
 [ 1.02378645e-02]
 [-1.69810542e-03]
 [ 3.40761393e-03]
 [-6.23924472e-03]
 [ 1.91179750e-03]
 [ 1.34246586e-03]
 [-5.87057936e-03]
 [-4.43520373e-03]
 [ 6.69180839e-03]
 [ 1.18208607e-03]
 [ 6.97326735e-03]
 [-4.02193240e-03]
 [-1.73231746e-04]
 [ 4.22049634e-03]
 [-7.80097563e-03]
 [ 7.46118069e-03]
 [ 1.98088811e-02]
 [ 5.29676921e-03]
 [ 7.79767629e-03]
 [-1.43682526e-03]
 [ 2.98164959e-03]
 [ 2.05921253e-02]
 [ 1.01287558e-03]
 [-1.59807958e-02]
 [-2.69642059e-03]
 [ 1.22959081e-03]
 [ 4.08579141e-03]
 [ 7.44268909e-05]
 [-1.43865708e-03]
 [ 7.09524248e-03]
 [-2.39272960e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.00532156]
curr_Stock_Price:  100.58931653311167
curr_Factors:  [100.58931653]
mat_Sqrt:  [[0.15]]
grads:  [-0.03004706]
Stock Position:  -0.030047063356879868
Bond Position:  [18.02773512]


portfolio before change:  [14.98760175]
curr_Stock_Price:  101.2165516443703
curr_Factors:  [101.21655164]
mat_Sqrt:  [[0.15]]
grads:  [0.3126144]
Stock Position:  0.3126144006244895
Bond Position:  [-16.65414987]


portfolio before change:  [14.77078769]
curr_Stock_Price:  100.52633027082942
curr_Factors:  [100.52633027]
mat_Sqrt:  [[0.15]]
grads:  [0.13150383]
Stock Position:  0.1315038261434753
Bond Position:  [1.55119064]


portfolio before change:  [14.92030857]
curr_Stock_Price:  101.66260076910842
curr_Factors:  [101.66260077]
mat_Sqrt:  [[0.15]]
grads:  [-0.22123194]
Stock Position:  -0.2212319379952461
Bond Position:  [37.41132275]


portfolio before change:  [14.91442655]
curr_Stock_Price:  101.69975767431778
curr_Factors:  [101.69975767]
mat_Sqrt:  [[0.15]]
grads:  [-0.2675066]
Stock Position:  -0.26750659860747195
Bond Position:  [42.11978281]


portfolio before change:  [14.98875161]
curr_Stock_Price:  101.43175499701839
curr_Factors:  [101.431755]
mat_Sqrt:  [[0.15]]
grads:  [-0.00810623]
Stock Position:  -0.008106228674853902
Bond Position:  [15.81098061]


portfolio before change:  [14.99850753]
curr_Stock_Price:  100.35015333690562
curr_Factors:  [100.35015334]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744731]
Stock Position:  -0.007447311557959418
Bond Position:  [15.74584639]


portfolio before change:  [14.99926853]
curr_Stock_Price:  100.38011744494051
curr_Factors:  [100.38011744]
mat_Sqrt:  [[0.15]]
grads:  [-0.08681581]
Stock Position:  -0.08681581435564369
Bond Position:  [23.71385017]


portfolio before change:  [15.04382847]
curr_Stock_Price:  99.88392010271687
curr_Factors:  [99.8839201]
mat_Sqrt:  [[0.15]]
grads:  [-0.05225726]
Stock Position:  -0.05225725888569447
Bond Position:  [20.26348834]


portfolio before change:  [15.05439764]
curr_Stock_Price:  99.70590333607345
curr_Factors:  [99.70590334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03548284]
Stock Position:  -0.03548283737158635
Bond Position:  [18.59224599]


portfolio before change:  [15.04187705]
curr_Stock_Price:  100.09151636858769
curr_Factors:  [100.09151637]
mat_Sqrt:  [[0.15]]
grads:  [0.08224475]
Stock Position:  0.08224475178831876
Bond Position:  [6.80987513]


portfolio before change:  [15.04321734]
curr_Stock_Price:  100.10263753887686
curr_Factors:  [100.10263754]
mat_Sqrt:  [[0.15]]
grads:  [-0.01653583]
Stock Position:  -0.016535825901964642
Bond Position:  [16.69849712]


portfolio before change:  [15.05998149]
curr_Stock_Price:  99.15194623922885
curr_Factors:  [99.15194624]
mat_Sqrt:  [[0.15]]
grads:  [-0.00405232]
Stock Position:  -0.00405231753576471
Bond Position:  [15.46177666]


portfolio before change:  [15.06320414]
curr_Stock_Price:  98.59516451142419
curr_Factors:  [98.59516451]
mat_Sqrt:  [[0.15]]
grads:  [0.00872226]
Stock Position:  0.008722258410210253
Bond Position:  [14.20323164]


portfolio before change:  [15.07173367]
curr_Stock_Price:  99.47129129451322
curr_Factors:  [99.47129129]
mat_Sqrt:  [[0.15]]
grads:  [0.00055284]
Stock Position:  0.0005528433727177914
Bond Position:  [15.01674163]


portfolio before change:  [15.07252764]
curr_Stock_Price:  99.20971091336715
curr_Factors:  [99.20971091]
mat_Sqrt:  [[0.15]]
grads:  [0.07339958]
Stock Position:  0.07339958114588266
Bond Position:  [7.79057641]


portfolio before change:  [15.11155767]
curr_Stock_Price:  99.73482441714879
curr_Factors:  [99.73482442]
mat_Sqrt:  [[0.15]]
grads:  [0.19890767]
Stock Position:  0.1989076665786808
Bond Position:  [-4.72646353]


portfolio before change:  [15.03706273]
curr_Stock_Price:  99.36178936253373
curr_Factors:  [99.36178936]
mat_Sqrt:  [[0.15]]
grads:  [-0.1009746]
Stock Position:  -0.1009746014436979
Bond Position:  [25.07007981]


portfolio before change:  [14.93349819]
curr_Stock_Price:  100.40295675320903
curr_Factors:  [100.40295675]
mat_Sqrt:  [[0.15]]
grads:  [0.12796803]
Stock Position:  0.12796803041446472
Bond Position:  [2.08512957]


portfolio before change:  [14.86732595]
curr_Stock_Price:  99.88483856212756
curr_Factors:  [99.88483856]
mat_Sqrt:  [[0.15]]
grads:  [0.01672653]
Stock Position:  0.01672653067626959
Bond Position:  [13.19659914]


portfolio before change:  [14.86896708]
curr_Stock_Price:  99.93364215387604
curr_Factors:  [99.93364215]
mat_Sqrt:  [[0.15]]
grads:  [-0.02658509]
Stock Position:  -0.0265850939996483
Bond Position:  [17.52571235]


portfolio before change:  [14.87328406]
curr_Stock_Price:  99.81246185954414
curr_Factors:  [99.81246186]
mat_Sqrt:  [[0.15]]
grads:  [0.0296898]
Stock Position:  0.029689796232127
Bond Position:  [11.90987241]


portfolio before change:  [14.88031784]
curr_Stock_Price:  100.02429851052763
curr_Factors:  [100.02429851]
mat_Sqrt:  [[0.15]]
grads:  [0.10338932]
Stock Position:  0.10338932271991388
Bond Position:  [4.53887336]


portfolio before change:  [14.95822092]
curr_Stock_Price:  100.77504714264893
curr_Factors:  [100.77504714]
mat_Sqrt:  [[0.15]]
grads:  [0.12799299]
Stock Position:  0.1279929881206984
Bond Position:  [2.05972151]


portfolio before change:  [15.04535386]
curr_Stock_Price:  101.45480467450643
curr_Factors:  [101.45480467]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013704]
Stock Position:  -0.010137037209870312
Bond Position:  [16.07380499]


portfolio before change:  [15.04765756]
curr_Stock_Price:  101.32665471828248
curr_Factors:  [101.32665472]
mat_Sqrt:  [[0.15]]
grads:  [0.04758963]
Stock Position:  0.04758963411481187
Bond Position:  [10.22555914]


portfolio before change:  [15.02260106]
curr_Stock_Price:  100.78671323704711
curr_Factors:  [100.78671324]
mat_Sqrt:  [[0.15]]
grads:  [-0.04492121]
Stock Position:  -0.04492120630852521
Bond Position:  [19.5500618]


portfolio before change:  [15.01887248]
curr_Stock_Price:  100.8969173037463
curr_Factors:  [100.8969173]
mat_Sqrt:  [[0.15]]
grads:  [0.04287165]
Stock Position:  0.04287164735525854
Bond Position:  [10.69325542]


portfolio before change:  [15.01032105]
curr_Stock_Price:  100.6818618645125
curr_Factors:  [100.68186186]
mat_Sqrt:  [[0.15]]
grads:  [0.2089733]
Stock Position:  0.2089733033699554
Bond Position:  [-6.02950022]


portfolio before change:  [15.02263755]
curr_Stock_Price:  100.74260341725999
curr_Factors:  [100.74260342]
mat_Sqrt:  [[0.15]]
grads:  [0.03331476]
Stock Position:  0.03331476297898707
Bond Position:  [11.6664216]


portfolio before change:  [15.01634682]
curr_Stock_Price:  100.5318888488545
curr_Factors:  [100.53188885]
mat_Sqrt:  [[0.15]]
grads:  [-0.04877511]
Stock Position:  -0.048775112465175005
Bond Position:  [19.91980101]


portfolio before change:  [15.02940274]
curr_Stock_Price:  100.28973890938408
curr_Factors:  [100.28973891]
mat_Sqrt:  [[0.15]]
grads:  [0.05214718]
Stock Position:  0.052147184941253776
Bond Position:  [9.79957518]


portfolio before change:  [15.03154743]
curr_Stock_Price:  100.31912118518129
curr_Factors:  [100.31912119]
mat_Sqrt:  [[0.15]]
grads:  [0.08206065]
Stock Position:  0.08206065450896094
Bond Position:  [6.79929469]


portfolio before change:  [14.98448964]
curr_Stock_Price:  99.74049113804467
curr_Factors:  [99.74049114]
mat_Sqrt:  [[0.15]]
grads:  [-0.03710443]
Stock Position:  -0.0371044270255366
Bond Position:  [18.68530342]


portfolio before change:  [15.01947126]
curr_Stock_Price:  98.82917808351918
curr_Factors:  [98.82917808]
mat_Sqrt:  [[0.15]]
grads:  [-0.00099701]
Stock Position:  -0.0009970101917041794
Bond Position:  [15.11800496]


portfolio before change:  [15.01988211]
curr_Stock_Price:  99.36483310513842
curr_Factors:  [99.36483311]
mat_Sqrt:  [[0.15]]
grads:  [0.12810906]
Stock Position:  0.12810905962722932
Bond Position:  [2.29034678]


portfolio before change:  [15.0986923]
curr_Stock_Price:  99.97889616710225
curr_Factors:  [99.97889617]
mat_Sqrt:  [[0.15]]
grads:  [-0.103341]
Stock Position:  -0.10334099875452368
Bond Position:  [25.43061129]


portfolio before change:  [15.16144744]
curr_Stock_Price:  99.38701418883555
curr_Factors:  [99.38701419]
mat_Sqrt:  [[0.15]]
grads:  [0.01940335]
Stock Position:  0.01940334516910392
Bond Position:  [13.2330069]


portfolio before change:  [15.15712709]
curr_Stock_Price:  99.12172782923925
curr_Factors:  [99.12172783]
mat_Sqrt:  [[0.15]]
grads:  [-0.29122563]
Stock Position:  -0.2912256287633592
Bond Position:  [44.0239146]


portfolio before change:  [15.04827137]
curr_Stock_Price:  99.5049609159038
curr_Factors:  [99.50496092]
mat_Sqrt:  [[0.15]]
grads:  [-0.08097951]
Stock Position:  -0.08097950693973016
Bond Position:  [23.10613404]


portfolio before change:  [15.07165341]
curr_Stock_Price:  99.23405464514816
curr_Factors:  [99.23405465]
mat_Sqrt:  [[0.15]]
grads:  [0.04795781]
Stock Position:  0.04795781100833909
Bond Position:  [10.31260537]


portfolio before change:  [15.09618095]
curr_Stock_Price:  99.73205455335548
curr_Factors:  [99.73205455]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897098]
Stock Position:  -0.018970979651124164
Bond Position:  [16.98819573]


portfolio before change:  [15.09337167]
curr_Stock_Price:  99.93610685038128
curr_Factors:  [99.93610685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00942867]
Stock Position:  -0.009428665244607417
Bond Position:  [16.03563577]


portfolio before change:  [15.09808584]
curr_Stock_Price:  99.54242383155439
curr_Factors:  [99.54242383]
mat_Sqrt:  [[0.15]]
grads:  [-0.01388448]
Stock Position:  -0.013884477857760926
Bond Position:  [16.48018042]


portfolio before change:  [15.10873857]
curr_Stock_Price:  98.84937017215859
curr_Factors:  [98.84937017]
mat_Sqrt:  [[0.15]]
grads:  [0.05011777]
Stock Position:  0.05011776582697921
Bond Position:  [10.15462898]


portfolio before change:  [15.11310828]
curr_Stock_Price:  98.9238951617706
curr_Factors:  [98.92389516]
mat_Sqrt:  [[0.15]]
grads:  [0.09775567]
Stock Position:  0.09775566710951734
Bond Position:  [5.44273691]


portfolio before change:  [15.25423597]
curr_Stock_Price:  100.36409306103938
curr_Factors:  [100.36409306]
mat_Sqrt:  [[0.15]]
grads:  [0.07271256]
Stock Position:  0.07271255951599757
Bond Position:  [7.95650588]


portfolio before change:  [15.25805585]
curr_Stock_Price:  100.40978791612716
curr_Factors:  [100.40978792]
mat_Sqrt:  [[0.15]]
grads:  [0.0259015]
Stock Position:  0.025901498946377385
Bond Position:  [12.65729184]


portfolio before change:  [15.27112414]
curr_Stock_Price:  100.88378280896265
curr_Factors:  [100.88378281]
mat_Sqrt:  [[0.15]]
grads:  [0.06825243]
Stock Position:  0.06825243010869064
Bond Position:  [8.3855608]


portfolio before change:  [15.25004657]
curr_Stock_Price:  100.56728597743529
curr_Factors:  [100.56728598]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113207]
Stock Position:  -0.011320702796549582
Bond Position:  [16.38853893]


portfolio before change:  [15.25187259]
curr_Stock_Price:  100.49646884741925
curr_Factors:  [100.49646885]
mat_Sqrt:  [[0.15]]
grads:  [0.02271743]
Stock Position:  0.022717426173915617
Bond Position:  [12.96885148]


portfolio before change:  [15.2387957]
curr_Stock_Price:  99.88515563563381
curr_Factors:  [99.88515564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04159496]
Stock Position:  -0.041594964828621475
Bond Position:  [19.39351524]


portfolio before change:  [15.24895331]
curr_Stock_Price:  99.67009414828162
curr_Factors:  [99.67009415]
mat_Sqrt:  [[0.15]]
grads:  [0.01274532]
Stock Position:  0.0127453166975281
Bond Position:  [13.9786264]


portfolio before change:  [15.25797549]
curr_Stock_Price:  100.3094260369715
curr_Factors:  [100.30942604]
mat_Sqrt:  [[0.15]]
grads:  [0.00894977]
Stock Position:  0.008949772368713669
Bond Position:  [14.36022896]


portfolio before change:  [15.25047085]
curr_Stock_Price:  99.3706104424842
curr_Factors:  [99.37061044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391372]
Stock Position:  -0.03913719572725171
Bond Position:  [19.13955788]


portfolio before change:  [15.27875197]
curr_Stock_Price:  98.6785613700022
curr_Factors:  [98.67856137]
mat_Sqrt:  [[0.15]]
grads:  [-0.02956802]
Stock Position:  -0.029568024874880198
Bond Position:  [18.19648212]


portfolio before change:  [15.23264966]
curr_Stock_Price:  100.27622054128368
curr_Factors:  [100.27622054]
mat_Sqrt:  [[0.15]]
grads:  [0.04461206]
Stock Position:  0.04461205594549302
Bond Position:  [10.7591213]


portfolio before change:  [15.24773427]
curr_Stock_Price:  100.59927562200936
curr_Factors:  [100.59927562]
mat_Sqrt:  [[0.15]]
grads:  [0.00788057]
Stock Position:  0.007880573816035144
Bond Position:  [14.45495426]


portfolio before change:  [15.24828721]
curr_Stock_Price:  100.55479594901963
curr_Factors:  [100.55479595]
mat_Sqrt:  [[0.15]]
grads:  [0.04648845]
Stock Position:  0.046488449027773424
Bond Position:  [10.57365071]


portfolio before change:  [15.24730693]
curr_Stock_Price:  100.51949341795353
curr_Factors:  [100.51949342]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681288]
Stock Position:  -0.02681288265007902
Bond Position:  [17.94252431]


portfolio before change:  [15.26602165]
curr_Stock_Price:  99.86334321042801
curr_Factors:  [99.86334321]
mat_Sqrt:  [[0.15]]
grads:  [-0.00115488]
Stock Position:  -0.001154878307539758
Bond Position:  [15.38135166]


portfolio before change:  [15.26711335]
curr_Stock_Price:  99.750482204643
curr_Factors:  [99.7504822]
mat_Sqrt:  [[0.15]]
grads:  [0.02813664]
Stock Position:  0.028136642249183254
Bond Position:  [12.46046972]


portfolio before change:  [15.27618745]
curr_Stock_Price:  100.04530385107371
curr_Factors:  [100.04530385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0520065]
Stock Position:  -0.052006504188300995
Bond Position:  [20.47919396]


portfolio before change:  [15.27438569]
curr_Stock_Price:  100.10456077634058
curr_Factors:  [100.10456078]
mat_Sqrt:  [[0.15]]
grads:  [0.0497412]
Stock Position:  0.04974120460352966
Bond Position:  [10.29506425]


portfolio before change:  [15.23775491]
curr_Stock_Price:  99.3551971929534
curr_Factors:  [99.35519719]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [2.11698635]


portfolio before change:  [15.21165811]
curr_Stock_Price:  99.1565809207088
curr_Factors:  [99.15658092]
mat_Sqrt:  [[0.15]]
grads:  [0.03531179]
Stock Position:  0.035311794718015654
Bond Position:  [11.71026128]


portfolio before change:  [15.23084396]
curr_Stock_Price:  99.67918045633031
curr_Factors:  [99.67918046]
mat_Sqrt:  [[0.15]]
grads:  [0.05198451]
Stock Position:  0.05198450861463038
Bond Position:  [10.04907074]


portfolio before change:  [15.25638157]
curr_Stock_Price:  100.15835267712629
curr_Factors:  [100.15835268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00957884]
Stock Position:  -0.009578835090730901
Bond Position:  [16.21578192]


portfolio before change:  [15.25946019]
curr_Stock_Price:  99.94276260566932
curr_Factors:  [99.94276261]
mat_Sqrt:  [[0.15]]
grads:  [0.01987766]
Stock Position:  0.01987766393382615
Bond Position:  [13.27283155]


portfolio before change:  [15.27089315]
curr_Stock_Price:  100.47619433404655
curr_Factors:  [100.47619433]
mat_Sqrt:  [[0.15]]
grads:  [0.13728084]
Stock Position:  0.1372808353660894
Bond Position:  [1.47743726]


portfolio before change:  [15.20202201]
curr_Stock_Price:  99.97384098867207
curr_Factors:  [99.97384099]
mat_Sqrt:  [[0.15]]
grads:  [0.0067525]
Stock Position:  0.006752503862751649
Bond Position:  [14.52694826]


portfolio before change:  [15.20518878]
curr_Stock_Price:  100.30835609092102
curr_Factors:  [100.30835609]
mat_Sqrt:  [[0.15]]
grads:  [-0.10653864]
Stock Position:  -0.10653863859746547
Bond Position:  [25.89190448]


portfolio before change:  [15.22063926]
curr_Stock_Price:  100.17852352366015
curr_Factors:  [100.17852352]
mat_Sqrt:  [[0.15]]
grads:  [-0.01797614]
Stock Position:  -0.017976137275537974
Bond Position:  [17.02146215]


portfolio before change:  [15.22901673]
curr_Stock_Price:  99.77167318283047
curr_Factors:  [99.77167318]
mat_Sqrt:  [[0.15]]
grads:  [0.00819727]
Stock Position:  0.008197272095541058
Bond Position:  [14.41116118]


portfolio before change:  [15.22269052]
curr_Stock_Price:  98.89004605057117
curr_Factors:  [98.89004605]
mat_Sqrt:  [[0.15]]
grads:  [0.02723861]
Stock Position:  0.02723860941646331
Bond Position:  [12.52906318]


portfolio before change:  [15.2019261]
curr_Stock_Price:  98.09898097617994
curr_Factors:  [98.09898098]
mat_Sqrt:  [[0.15]]
grads:  [0.00049618]
Stock Position:  0.0004961792725201887
Bond Position:  [15.15325142]


portfolio before change:  [15.2031424]
curr_Stock_Price:  98.64150416366638
curr_Factors:  [98.64150416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959105]
Stock Position:  -0.009591047190149431
Bond Position:  [16.14921772]


portfolio before change:  [15.1946766]
curr_Stock_Price:  99.62942110510345
curr_Factors:  [99.62942111]
mat_Sqrt:  [[0.15]]
grads:  [0.04730162]
Stock Position:  0.04730161656627552
Bond Position:  [10.48204392]


portfolio before change:  [15.15646915]
curr_Stock_Price:  98.80782994318906
curr_Factors:  [98.80782994]
mat_Sqrt:  [[0.15]]
grads:  [-0.15951531]
Stock Position:  -0.15951530651299103
Bond Position:  [30.91783043]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.30914557]
Stock Price:  97.86281727508072
PL:  [15.30914557]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.11860328e-03]
 [ 3.40302885e-02]
 [ 2.02888549e-02]
 [-2.16406823e-02]
 [-1.12498567e-02]
 [-4.91376756e-03]
 [ 2.43357648e-03]
 [-9.02118318e-03]
 [ 6.48437979e-04]
 [ 1.03661098e-03]
 [ 1.37588420e-02]
 [-3.23128338e-03]
 [-2.78684575e-03]
 [ 5.70001257e-03]
 [-2.26193253e-03]
 [ 1.34214786e-02]
 [ 5.34150599e-02]
 [-1.44614875e-02]
 [ 1.76324663e-02]
 [ 2.25228094e-03]
 [-4.82774767e-03]
 [ 4.55091271e-03]
 [ 1.49966968e-02]
 [ 1.89370020e-02]
 [-2.51270792e-03]
 [ 6.51656003e-03]
 [-2.61840055e-03]
 [ 6.21413134e-03]
 [ 2.25531478e-02]
 [ 1.94906730e-03]
 [-7.12349333e-03]
 [ 9.54444998e-03]
 [ 1.23592038e-02]
 [ 7.42436734e-03]
 [ 6.13856476e-03]
 [ 1.25425711e-02]
 [-2.10671056e-02]
 [ 3.43998775e-03]
 [-5.79979229e-02]
 [ 6.39880353e-04]
 [ 5.03242779e-03]
 [ 8.38600865e-03]
 [-4.16640885e-03]
 [-2.85330528e-03]
 [ 1.05950770e-02]
 [ 1.28179295e-02]
 [ 1.06177981e-02]
 [-3.44325691e-04]
 [ 1.51853716e-02]
 [-1.18659889e-03]
 [ 1.98265605e-02]
 [-6.16717889e-03]
 [ 1.37176611e-03]
 [ 2.35400957e-03]
 [-3.71369736e-03]
 [-3.76113466e-03]
 [ 9.52861314e-03]
 [-4.06871339e-03]
 [ 6.92893640e-03]
 [-4.03742276e-03]
 [-9.42890571e-04]
 [ 5.17002538e-03]
 [-8.21709027e-03]
 [ 6.85751248e-03]
 [ 2.26298127e-02]
 [ 5.50812010e-03]
 [ 1.05354225e-02]
 [-5.31578850e-04]
 [ 2.85287306e-03]
 [ 2.06848489e-02]
 [ 3.26967160e-04]
 [-1.59701915e-02]
 [-1.97174955e-03]
 [ 1.37927680e-03]
 [ 1.64941731e-03]
 [-8.77278469e-03]
 [-4.12668300e-03]
 [ 1.15870209e-02]
 [-1.45824346e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.20840417]
curr_Stock_Price:  100.14436062214102
curr_Factors:  [100.14436062]
mat_Sqrt:  [[0.15]]
grads:  [-0.04745736]
Stock Position:  -0.04745735523254207
Bond Position:  [9.96099067]


portfolio before change:  [5.17696811]
curr_Stock_Price:  100.8198858208344
curr_Factors:  [100.81988582]
mat_Sqrt:  [[0.15]]
grads:  [0.22686859]
Stock Position:  0.22686859010879745
Bond Position:  [-17.69589724]


portfolio before change:  [5.20929347]
curr_Stock_Price:  100.96724596130407
curr_Factors:  [100.96724596]
mat_Sqrt:  [[0.15]]
grads:  [0.13525903]
Stock Position:  0.1352590327034782
Bond Position:  [-8.44743855]


portfolio before change:  [5.20447873]
curr_Stock_Price:  100.93555296248822
curr_Factors:  [100.93555296]
mat_Sqrt:  [[0.15]]
grads:  [-0.14427122]
Stock Position:  -0.14427121512808475
Bond Position:  [19.7665736]


portfolio before change:  [5.22445251]
curr_Stock_Price:  100.80567028063143
curr_Factors:  [100.80567028]
mat_Sqrt:  [[0.15]]
grads:  [-0.07499904]
Stock Position:  -0.07499904445155134
Bond Position:  [12.78478146]


portfolio before change:  [5.27575222]
curr_Stock_Price:  100.13231993257673
curr_Factors:  [100.13231993]
mat_Sqrt:  [[0.15]]
grads:  [-0.03275845]
Stock Position:  -0.032758450390466785
Bond Position:  [8.55593185]


portfolio before change:  [5.28252162]
curr_Stock_Price:  99.94199838501835
curr_Factors:  [99.94199839]
mat_Sqrt:  [[0.15]]
grads:  [0.01622384]
Stock Position:  0.016223843178342162
Bond Position:  [3.66107831]


portfolio before change:  [5.28605488]
curr_Stock_Price:  100.14567631974569
curr_Factors:  [100.14567632]
mat_Sqrt:  [[0.15]]
grads:  [-0.06014122]
Stock Position:  -0.060141221189733175
Bond Position:  [11.30893815]


portfolio before change:  [5.27468175]
curr_Stock_Price:  100.34653622696187
curr_Factors:  [100.34653623]
mat_Sqrt:  [[0.15]]
grads:  [0.00432292]
Stock Position:  0.004322919861830371
Bond Position:  [4.84089172]


portfolio before change:  [5.27678618]
curr_Stock_Price:  100.76335333222295
curr_Factors:  [100.76335333]
mat_Sqrt:  [[0.15]]
grads:  [0.00691074]
Stock Position:  0.006910739896507367
Bond Position:  [4.58043686]


portfolio before change:  [5.2717097]
curr_Stock_Price:  99.98734779710576
curr_Factors:  [99.9873478]
mat_Sqrt:  [[0.15]]
grads:  [0.09172561]
Stock Position:  0.09172561311084873
Bond Position:  [-3.89969108]


portfolio before change:  [5.26479026]
curr_Stock_Price:  99.91456879463716
curr_Factors:  [99.91456879]
mat_Sqrt:  [[0.15]]
grads:  [-0.02154189]
Stock Position:  -0.021541889199252814
Bond Position:  [7.41713883]


portfolio before change:  [5.25108568]
curr_Stock_Price:  100.57227186899571
curr_Factors:  [100.57227187]
mat_Sqrt:  [[0.15]]
grads:  [-0.01857897]
Stock Position:  -0.01857897163366675
Bond Position:  [7.11961506]


portfolio before change:  [5.24127883]
curr_Stock_Price:  101.12406958157509
curr_Factors:  [101.12406958]
mat_Sqrt:  [[0.15]]
grads:  [0.03800008]
Stock Position:  0.038000083803743576
Bond Position:  [1.39855572]


portfolio before change:  [5.21253232]
curr_Stock_Price:  100.3652836843718
curr_Factors:  [100.36528368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01507955]
Stock Position:  -0.015079550233136549
Bond Position:  [6.72599566]


portfolio before change:  [5.21637573]
curr_Stock_Price:  100.13828588945364
curr_Factors:  [100.13828589]
mat_Sqrt:  [[0.15]]
grads:  [0.08947652]
Stock Position:  0.0894765237646118
Bond Position:  [-3.74364999]


portfolio before change:  [5.28685464]
curr_Stock_Price:  100.9285813964402
curr_Factors:  [100.9285814]
mat_Sqrt:  [[0.15]]
grads:  [0.3561004]
Stock Position:  0.3561003992451752
Bond Position:  [-30.65385349]


portfolio before change:  [5.28091068]
curr_Stock_Price:  100.91726987710027
curr_Factors:  [100.91726988]
mat_Sqrt:  [[0.15]]
grads:  [-0.09640992]
Stock Position:  -0.09640991655817517
Bond Position:  [15.01033625]


portfolio before change:  [5.27349557]
curr_Stock_Price:  101.00391332711278
curr_Factors:  [101.00391333]
mat_Sqrt:  [[0.15]]
grads:  [0.11754978]
Stock Position:  0.1175497754260528
Bond Position:  [-6.59949176]


portfolio before change:  [5.21771038]
curr_Stock_Price:  100.53285579234361
curr_Factors:  [100.53285579]
mat_Sqrt:  [[0.15]]
grads:  [0.01501521]
Stock Position:  0.015015206281289764
Bond Position:  [3.70818881]


portfolio before change:  [5.23790089]
curr_Stock_Price:  101.86209094173422
curr_Factors:  [101.86209094]
mat_Sqrt:  [[0.15]]
grads:  [-0.03218498]
Stock Position:  -0.03218498444242094
Bond Position:  [8.5163307]


portfolio before change:  [5.25458627]
curr_Stock_Price:  101.36020798567279
curr_Factors:  [101.36020799]
mat_Sqrt:  [[0.15]]
grads:  [0.03033942]
Stock Position:  0.0303394180564958
Bond Position:  [2.17937654]


portfolio before change:  [5.22177944]
curr_Stock_Price:  100.27439130944252
curr_Factors:  [100.27439131]
mat_Sqrt:  [[0.15]]
grads:  [0.09997798]
Stock Position:  0.09997797896339893
Bond Position:  [-4.80345155]


portfolio before change:  [5.26379232]
curr_Stock_Price:  100.69761555187772
curr_Factors:  [100.69761555]
mat_Sqrt:  [[0.15]]
grads:  [0.12624668]
Stock Position:  0.12624668012439474
Bond Position:  [-7.44894734]


portfolio before change:  [5.3257172]
curr_Stock_Price:  101.19181037426867
curr_Factors:  [101.19181037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675139]
Stock Position:  -0.016751386132478285
Bond Position:  [7.02082029]


portfolio before change:  [5.33302691]
curr_Stock_Price:  100.78164184740197
curr_Factors:  [100.78164185]
mat_Sqrt:  [[0.15]]
grads:  [0.04344373]
Stock Position:  0.04344373352296189
Bond Position:  [0.95469611]


portfolio before change:  [5.31427849]
curr_Stock_Price:  100.3487119574892
curr_Factors:  [100.34871196]
mat_Sqrt:  [[0.15]]
grads:  [-0.017456]
Stock Position:  -0.01745600364551019
Bond Position:  [7.06596597]


portfolio before change:  [5.30611924]
curr_Stock_Price:  100.84142965111567
curr_Factors:  [100.84142965]
mat_Sqrt:  [[0.15]]
grads:  [0.04142754]
Stock Position:  0.041427542248451306
Bond Position:  [1.12850665]


portfolio before change:  [5.26763511]
curr_Stock_Price:  99.91077679745261
curr_Factors:  [99.9107768]
mat_Sqrt:  [[0.15]]
grads:  [0.15035432]
Stock Position:  0.15035431885584954
Bond Position:  [-9.75438168]


portfolio before change:  [5.19204467]
curr_Stock_Price:  99.41208291541052
curr_Factors:  [99.41208292]
mat_Sqrt:  [[0.15]]
grads:  [0.01299378]
Stock Position:  0.012993782003852932
Bond Position:  [3.90030573]


portfolio before change:  [5.19614947]
curr_Stock_Price:  99.70922721208093
curr_Factors:  [99.70922721]
mat_Sqrt:  [[0.15]]
grads:  [-0.04748996]
Stock Position:  -0.04748995554075964
Bond Position:  [9.93133624]


portfolio before change:  [5.14888665]
curr_Stock_Price:  100.71751514468095
curr_Factors:  [100.71751514]
mat_Sqrt:  [[0.15]]
grads:  [0.06362967]
Stock Position:  0.06362966653586001
Bond Position:  [-1.25973525]


portfolio before change:  [5.13111969]
curr_Stock_Price:  100.43952809615386
curr_Factors:  [100.4395281]
mat_Sqrt:  [[0.15]]
grads:  [0.08239469]
Stock Position:  0.08239469198736696
Bond Position:  [-3.14456429]


portfolio before change:  [5.14830219]
curr_Stock_Price:  100.65045233607587
curr_Factors:  [100.65045234]
mat_Sqrt:  [[0.15]]
grads:  [0.04949578]
Stock Position:  0.049495782253887226
Bond Position:  [0.16652932]


portfolio before change:  [5.12914949]
curr_Stock_Price:  100.26328583192196
curr_Factors:  [100.26328583]
mat_Sqrt:  [[0.15]]
grads:  [0.04092377]
Stock Position:  0.040923765052318976
Bond Position:  [1.02599833]


portfolio before change:  [5.13699898]
curr_Stock_Price:  100.45352662764229
curr_Factors:  [100.45352663]
mat_Sqrt:  [[0.15]]
grads:  [0.08361714]
Stock Position:  0.08361714093398194
Bond Position:  [-3.26263771]


portfolio before change:  [5.1204024]
curr_Stock_Price:  100.25748232729778
curr_Factors:  [100.25748233]
mat_Sqrt:  [[0.15]]
grads:  [-0.14044737]
Stock Position:  -0.1404473708216934
Bond Position:  [19.2013022]


portfolio before change:  [5.17727673]
curr_Stock_Price:  99.86107611463768
curr_Factors:  [99.86107611]
mat_Sqrt:  [[0.15]]
grads:  [0.02293325]
Stock Position:  0.022933251660569483
Bond Position:  [2.88713754]


portfolio before change:  [5.17300448]
curr_Stock_Price:  99.66691713123332
curr_Factors:  [99.66691713]
mat_Sqrt:  [[0.15]]
grads:  [-0.38665282]
Stock Position:  -0.38665281957025965
Bond Position:  [43.70949901]


portfolio before change:  [5.03667769]
curr_Stock_Price:  100.02656464107301
curr_Factors:  [100.02656464]
mat_Sqrt:  [[0.15]]
grads:  [0.00426587]
Stock Position:  0.004265869019914095
Bond Position:  [4.60997746]


portfolio before change:  [5.04276372]
curr_Stock_Price:  101.38570063454401
curr_Factors:  [101.38570063]
mat_Sqrt:  [[0.15]]
grads:  [0.03354952]
Stock Position:  0.03354951860689405
Bond Position:  [1.64132227]


portfolio before change:  [5.04102935]
curr_Stock_Price:  101.33094721893669
curr_Factors:  [101.33094722]
mat_Sqrt:  [[0.15]]
grads:  [0.05590672]
Stock Position:  0.055906724327621324
Bond Position:  [-0.62405198]


portfolio before change:  [5.04394384]
curr_Stock_Price:  101.38377609383636
curr_Factors:  [101.38377609]
mat_Sqrt:  [[0.15]]
grads:  [-0.02777606]
Stock Position:  -0.02777605902402413
Bond Position:  [7.85998559]


portfolio before change:  [5.02543234]
curr_Stock_Price:  102.06791798736357
curr_Factors:  [102.06791799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902204]
Stock Position:  -0.01902203520444003
Bond Position:  [6.96697187]


portfolio before change:  [5.02229064]
curr_Stock_Price:  102.25597093104068
curr_Factors:  [102.25597093]
mat_Sqrt:  [[0.15]]
grads:  [0.07063385]
Stock Position:  0.07063384687202204
Bond Position:  [-2.20044196]


portfolio before change:  [4.99775745]
curr_Stock_Price:  101.91058905899125
curr_Factors:  [101.91058906]
mat_Sqrt:  [[0.15]]
grads:  [0.08545286]
Stock Position:  0.08545286349894969
Bond Position:  [-3.7107942]


portfolio before change:  [5.00668089]
curr_Stock_Price:  102.01772844144753
curr_Factors:  [102.01772844]
mat_Sqrt:  [[0.15]]
grads:  [0.07078532]
Stock Position:  0.07078532097250366
Bond Position:  [-2.21467676]


portfolio before change:  [5.03107929]
curr_Stock_Price:  102.36436554117735
curr_Factors:  [102.36436554]
mat_Sqrt:  [[0.15]]
grads:  [-0.0022955]
Stock Position:  -0.0022955046057913557
Bond Position:  [5.26605716]


portfolio before change:  [5.03154488]
curr_Stock_Price:  102.30492217314837
curr_Factors:  [102.30492217]
mat_Sqrt:  [[0.15]]
grads:  [0.10123581]
Stock Position:  0.10123581047589378
Bond Position:  [-5.32537684]


portfolio before change:  [4.99061798]
curr_Stock_Price:  101.90393710745411
curr_Factors:  [101.90393711]
mat_Sqrt:  [[0.15]]
grads:  [-0.00791066]
Stock Position:  -0.007910659283764533
Bond Position:  [5.79674531]


portfolio before change:  [4.98836758]
curr_Stock_Price:  102.23421382737847
curr_Factors:  [102.23421383]
mat_Sqrt:  [[0.15]]
grads:  [0.13217707]
Stock Position:  0.13217706998662104
Bond Position:  [-8.52465125]


portfolio before change:  [5.05457649]
curr_Stock_Price:  102.73915549492443
curr_Factors:  [102.73915549]
mat_Sqrt:  [[0.15]]
grads:  [-0.04111453]
Stock Position:  -0.04111452592012017
Bond Position:  [9.27864816]


portfolio before change:  [5.09956675]
curr_Stock_Price:  101.6589940110009
curr_Factors:  [101.65899401]
mat_Sqrt:  [[0.15]]
grads:  [0.00914511]
Stock Position:  0.009145107393392663
Bond Position:  [4.16988433]


portfolio before change:  [5.09184223]
curr_Stock_Price:  100.78583404477446
curr_Factors:  [100.78583404]
mat_Sqrt:  [[0.15]]
grads:  [0.0156934]
Stock Position:  0.015693397103235737
Bond Position:  [3.51017012]


portfolio before change:  [5.0951544]
curr_Stock_Price:  100.98290883157667
curr_Factors:  [100.98290883]
mat_Sqrt:  [[0.15]]
grads:  [-0.02475798]
Stock Position:  -0.024757982384353904
Bond Position:  [7.59528747]


portfolio before change:  [5.09881399]
curr_Stock_Price:  100.85426877056523
curr_Factors:  [100.85426877]
mat_Sqrt:  [[0.15]]
grads:  [-0.02507423]
Stock Position:  -0.025074231052929996
Bond Position:  [7.62765722]


portfolio before change:  [5.09698929]
curr_Stock_Price:  100.94605397020658
curr_Factors:  [100.94605397]
mat_Sqrt:  [[0.15]]
grads:  [0.06352409]
Stock Position:  0.0635240876114771
Bond Position:  [-1.31551669]


portfolio before change:  [5.12131341]
curr_Stock_Price:  101.33026011357282
curr_Factors:  [101.33026011]
mat_Sqrt:  [[0.15]]
grads:  [-0.02712476]
Stock Position:  -0.02712475592495244
Bond Position:  [7.86987198]


portfolio before change:  [5.129881]
curr_Stock_Price:  101.03253550744094
curr_Factors:  [101.03253551]
mat_Sqrt:  [[0.15]]
grads:  [0.04619291]
Stock Position:  0.04619290932866549
Bond Position:  [0.46289425]


portfolio before change:  [5.08959137]
curr_Stock_Price:  100.15970547880403
curr_Factors:  [100.15970548]
mat_Sqrt:  [[0.15]]
grads:  [-0.02691615]
Stock Position:  -0.026916151720320754
Bond Position:  [7.7855052]


portfolio before change:  [5.07582171]
curr_Stock_Price:  100.68936025389615
curr_Factors:  [100.68936025]
mat_Sqrt:  [[0.15]]
grads:  [-0.00628594]
Stock Position:  -0.006285937137377318
Bond Position:  [5.7087487]


portfolio before change:  [5.07966266]
curr_Stock_Price:  100.13508430042668
curr_Factors:  [100.1350843]
mat_Sqrt:  [[0.15]]
grads:  [0.03446684]
Stock Position:  0.034466835865114634
Bond Position:  [1.62832315]


portfolio before change:  [5.08565221]
curr_Stock_Price:  100.3059085861867
curr_Factors:  [100.30590859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547806]
Stock Position:  -0.05478060178952849
Bond Position:  [10.58047025]


portfolio before change:  [5.12421537]
curr_Stock_Price:  99.61402380401401
curr_Factors:  [99.6140238]
mat_Sqrt:  [[0.15]]
grads:  [0.04571675]
Stock Position:  0.04571674989318903
Bond Position:  [0.57018596]


portfolio before change:  [5.14102993]
curr_Stock_Price:  99.98104276317176
curr_Factors:  [99.98104276]
mat_Sqrt:  [[0.15]]
grads:  [0.15086542]
Stock Position:  0.15086541775834883
Bond Position:  [-9.94265186]


portfolio before change:  [5.16988644]
curr_Stock_Price:  100.17643513171626
curr_Factors:  [100.17643513]
mat_Sqrt:  [[0.15]]
grads:  [0.0367208]
Stock Position:  0.03672080067080043
Bond Position:  [1.49132754]


portfolio before change:  [5.2008386]
curr_Stock_Price:  101.01680205762766
curr_Factors:  [101.01680206]
mat_Sqrt:  [[0.15]]
grads:  [0.07023615]
Stock Position:  0.07023614981461852
Bond Position:  [-1.89419264]


portfolio before change:  [5.17184265]
curr_Stock_Price:  100.6056524890448
curr_Factors:  [100.60565249]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354386]
Stock Position:  -0.003543858998366854
Bond Position:  [5.52837489]


portfolio before change:  [5.17052645]
curr_Stock_Price:  101.07455536472506
curr_Factors:  [101.07455536]
mat_Sqrt:  [[0.15]]
grads:  [0.01901915]
Stock Position:  0.019019153763036357
Bond Position:  [3.24817394]


portfolio before change:  [5.15887211]
curr_Stock_Price:  100.4511122461541
curr_Factors:  [100.45111225]
mat_Sqrt:  [[0.15]]
grads:  [0.13789899]
Stock Position:  0.13789899280471282
Bond Position:  [-8.69323509]


portfolio before change:  [5.20151376]
curr_Stock_Price:  100.76427617117247
curr_Factors:  [100.76427617]
mat_Sqrt:  [[0.15]]
grads:  [0.00217978]
Stock Position:  0.002179781069385093
Bond Position:  [4.9818697]


portfolio before change:  [5.2012431]
curr_Stock_Price:  100.49726215539626
curr_Factors:  [100.49726216]
mat_Sqrt:  [[0.15]]
grads:  [-0.10646794]
Stock Position:  -0.10646794325669207
Bond Position:  [15.90097991]


portfolio before change:  [5.21469095]
curr_Stock_Price:  100.38028794166027
curr_Factors:  [100.38028794]
mat_Sqrt:  [[0.15]]
grads:  [-0.013145]
Stock Position:  -0.013144997004526048
Bond Position:  [6.53418953]


portfolio before change:  [5.20089227]
curr_Stock_Price:  101.46108497211357
curr_Factors:  [101.46108497]
mat_Sqrt:  [[0.15]]
grads:  [0.00919518]
Stock Position:  0.00919517867098012
Bond Position:  [4.26793947]


portfolio before change:  [5.20571069]
curr_Stock_Price:  101.9560907304149
curr_Factors:  [101.95609073]
mat_Sqrt:  [[0.15]]
grads:  [0.01099612]
Stock Position:  0.010996115429646344
Bond Position:  [4.08458975]


portfolio before change:  [5.19150707]
curr_Stock_Price:  100.6411787699705
curr_Factors:  [100.64117877]
mat_Sqrt:  [[0.15]]
grads:  [-0.05848523]
Stock Position:  -0.05848523124900702
Bond Position:  [11.07752968]


portfolio before change:  [5.22033961]
curr_Stock_Price:  100.16002863529593
curr_Factors:  [100.16002864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02751122]
Stock Position:  -0.027511219996541932
Bond Position:  [7.97586419]


portfolio before change:  [5.21465962]
curr_Stock_Price:  100.38460972753875
curr_Factors:  [100.38460973]
mat_Sqrt:  [[0.15]]
grads:  [0.07724681]
Stock Position:  0.07724680629361372
Bond Position:  [-2.53973089]


portfolio before change:  [5.24942103]
curr_Stock_Price:  100.8366692038612
curr_Factors:  [100.8366692]
mat_Sqrt:  [[0.15]]
grads:  [-0.09721623]
Stock Position:  -0.09721623038369881
Bond Position:  [15.05238189]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.18987008]
Stock Price:  101.45890849183786
PL:  [3.73096158]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.66766067e-03]
 [ 4.89024825e-02]
 [ 1.84722828e-02]
 [-3.72223332e-02]
 [-4.15076177e-02]
 [-1.28332878e-03]
 [ 1.72204970e-02]
 [-4.68974463e-02]
 [ 7.90602260e-03]
 [-1.84386100e-03]
 [-1.34225658e-03]
 [ 1.11594647e-02]
 [-3.35480054e-03]
 [ 3.75538706e-03]
 [-1.51471326e-03]
 [ 1.48338455e-02]
 [ 3.45254584e-02]
 [-1.47955707e-02]
 [ 2.23361782e-02]
 [ 1.57595057e-03]
 [-4.26614367e-03]
 [ 5.39650486e-03]
 [ 1.45414540e-02]
 [ 1.78417495e-02]
 [-5.92270585e-03]
 [ 4.79286152e-03]
 [ 9.72019850e-03]
 [ 8.04413530e-03]
 [ 2.34349879e-02]
 [ 2.68643569e-03]
 [-6.50684503e-03]
 [ 1.80320796e-02]
 [ 1.14832306e-02]
 [-1.48799910e-02]
 [-6.72111945e-05]
 [ 1.81610429e-02]
 [ 4.68102397e-03]
 [ 3.14001911e-03]
 [-3.39309736e-02]
 [-1.68620009e-02]
 [ 7.14287822e-03]
 [ 2.89037402e-02]
 [-2.82673323e-03]
 [ 1.00856236e-03]
 [ 6.63722835e-03]
 [ 1.58262464e-02]
 [ 1.00261995e-02]
 [ 5.32456368e-03]
 [-8.12462476e-03]
 [-2.79968876e-04]
 [-4.29326273e-03]
 [ 1.42529466e-03]
 [ 4.67314045e-04]
 [ 8.31546840e-03]
 [-1.05312543e-02]
 [-4.92878554e-03]
 [-1.46987633e-03]
 [ 1.27800246e-02]
 [ 7.93577235e-03]
 [-3.12883214e-03]
 [-5.14104899e-03]
 [-1.43292874e-03]
 [-2.94676749e-03]
 [-2.32779163e-03]
 [ 1.89355267e-02]
 [ 4.70100700e-03]
 [ 1.34210684e-02]
 [-1.43986851e-03]
 [ 4.33484235e-03]
 [ 2.32761256e-02]
 [ 3.39051990e-03]
 [-1.54161713e-02]
 [-5.70592169e-03]
 [ 1.71267972e-03]
 [ 9.42883795e-03]
 [ 1.62942615e-03]
 [-1.61231628e-03]
 [-8.64613541e-03]
 [-2.44702959e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.83377675]
curr_Stock_Price:  100.44527146752174
curr_Factors:  [100.44527147]
mat_Sqrt:  [[0.15]]
grads:  [-0.02445107]
Stock Position:  -0.02445107111523129
Bond Position:  [14.28977123]


portfolio before change:  [11.81429532]
curr_Stock_Price:  101.27855087760766
curr_Factors:  [101.27855088]
mat_Sqrt:  [[0.15]]
grads:  [0.32601655]
Stock Position:  0.32601654971285904
Bond Position:  [-21.2041884]


portfolio before change:  [11.84639258]
curr_Stock_Price:  101.38106886520626
curr_Factors:  [101.38106887]
mat_Sqrt:  [[0.15]]
grads:  [0.12314855]
Stock Position:  0.12314855183468018
Bond Position:  [-0.63853924]


portfolio before change:  [11.91373187]
curr_Stock_Price:  101.92820650406526
curr_Factors:  [101.9282065]
mat_Sqrt:  [[0.15]]
grads:  [-0.24814889]
Stock Position:  -0.2481488879460248
Bond Position:  [37.20710297]


portfolio before change:  [11.95897314]
curr_Stock_Price:  101.75526295996228
curr_Factors:  [101.75526296]
mat_Sqrt:  [[0.15]]
grads:  [-0.27671745]
Stock Position:  -0.2767174511672257
Bond Position:  [40.11643015]


portfolio before change:  [11.97045475]
curr_Stock_Price:  101.7228318287902
curr_Factors:  [101.72283183]
mat_Sqrt:  [[0.15]]
grads:  [-0.00855553]
Stock Position:  -0.008555525174715204
Bond Position:  [12.840747]


portfolio before change:  [11.96412695]
curr_Stock_Price:  102.55625512954292
curr_Factors:  [102.55625513]
mat_Sqrt:  [[0.15]]
grads:  [0.11480331]
Stock Position:  0.11480331352373609
Bond Position:  [0.19032904]


portfolio before change:  [11.92100969]
curr_Stock_Price:  102.18057648360517
curr_Factors:  [102.18057648]
mat_Sqrt:  [[0.15]]
grads:  [-0.31264964]
Stock Position:  -0.31264964227851433
Bond Position:  [43.86773038]


portfolio before change:  [12.3352736]
curr_Stock_Price:  100.86433609676742
curr_Factors:  [100.8643361]
mat_Sqrt:  [[0.15]]
grads:  [0.05270682]
Stock Position:  0.05270681736306083
Bond Position:  [7.01903546]


portfolio before change:  [12.35076966]
curr_Stock_Price:  101.15001755985791
curr_Factors:  [101.15001756]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229241]
Stock Position:  -0.012292406653485351
Bond Position:  [13.59414681]


portfolio before change:  [12.35542826]
curr_Stock_Price:  100.84015654728448
curr_Factors:  [100.84015655]
mat_Sqrt:  [[0.15]]
grads:  [-0.00894838]
Stock Position:  -0.008948377199904755
Bond Position:  [13.25778402]


portfolio before change:  [12.35201402]
curr_Stock_Price:  101.31430682057312
curr_Factors:  [101.31430682]
mat_Sqrt:  [[0.15]]
grads:  [0.07439643]
Stock Position:  0.07439643152229046
Bond Position:  [4.81459113]


portfolio before change:  [12.33214206]
curr_Stock_Price:  101.04315291243343
curr_Factors:  [101.04315291]
mat_Sqrt:  [[0.15]]
grads:  [-0.02236534]
Stock Position:  -0.02236533696558577
Bond Position:  [14.59200622]


portfolio before change:  [12.31576897]
curr_Stock_Price:  101.81600598195435
curr_Factors:  [101.81600598]
mat_Sqrt:  [[0.15]]
grads:  [0.02503591]
Stock Position:  0.025035913713653324
Bond Position:  [9.76671223]


portfolio before change:  [12.29311392]
curr_Stock_Price:  100.8867212075238
curr_Factors:  [100.88672121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01009809]
Stock Position:  -0.010098088369250673
Bond Position:  [13.31187694]


portfolio before change:  [12.29685681]
curr_Stock_Price:  100.59846137995366
curr_Factors:  [100.59846138]
mat_Sqrt:  [[0.15]]
grads:  [0.0988923]
Stock Position:  0.09889230331823626
Bond Position:  [2.34844325]


portfolio before change:  [12.24042342]
curr_Stock_Price:  100.02632207439639
curr_Factors:  [100.02632207]
mat_Sqrt:  [[0.15]]
grads:  [0.23016972]
Stock Position:  0.23016972237417138
Bond Position:  [-10.78260737]


portfolio before change:  [12.02778776]
curr_Stock_Price:  99.10542891525556
curr_Factors:  [99.10542892]
mat_Sqrt:  [[0.15]]
grads:  [-0.09863714]
Stock Position:  -0.09863713778448668
Bond Position:  [21.80326361]


portfolio before change:  [12.01619836]
curr_Stock_Price:  99.2367399440244
curr_Factors:  [99.23673994]
mat_Sqrt:  [[0.15]]
grads:  [0.14890785]
Stock Position:  0.14890785468145545
Bond Position:  [-2.76093169]


portfolio before change:  [12.02279676]
curr_Stock_Price:  99.28221077911928
curr_Factors:  [99.28221078]
mat_Sqrt:  [[0.15]]
grads:  [0.01050634]
Stock Position:  0.010506337117275869
Bond Position:  [10.97970439]


portfolio before change:  [12.0226438]
curr_Stock_Price:  99.20233383725525
curr_Factors:  [99.20233384]
mat_Sqrt:  [[0.15]]
grads:  [-0.02844096]
Stock Position:  -0.028440957823256428
Bond Position:  [14.84405319]


portfolio before change:  [12.03376625]
curr_Stock_Price:  98.84388359774302
curr_Factors:  [98.8438836]
mat_Sqrt:  [[0.15]]
grads:  [0.0359767]
Stock Position:  0.035976699043096666
Bond Position:  [8.4776896]


portfolio before change:  [12.01172391]
curr_Stock_Price:  98.21647146591819
curr_Factors:  [98.21647147]
mat_Sqrt:  [[0.15]]
grads:  [0.09694303]
Stock Position:  0.09694302681988148
Bond Position:  [2.49032188]


portfolio before change:  [12.09282873]
curr_Stock_Price:  99.05148951980149
curr_Factors:  [99.05148952]
mat_Sqrt:  [[0.15]]
grads:  [0.118945]
Stock Position:  0.11894499656420046
Bond Position:  [0.31114965]


portfolio before change:  [12.1664086]
curr_Stock_Price:  99.6699301543525
curr_Factors:  [99.66993015]
mat_Sqrt:  [[0.15]]
grads:  [-0.03948471]
Stock Position:  -0.0394847056470474
Bond Position:  [16.10184645]


portfolio before change:  [12.14844096]
curr_Stock_Price:  100.15047154838167
curr_Factors:  [100.15047155]
mat_Sqrt:  [[0.15]]
grads:  [0.03195241]
Stock Position:  0.03195241013429038
Bond Position:  [8.94839202]


portfolio before change:  [12.1114626]
curr_Stock_Price:  98.97567287155394
curr_Factors:  [98.97567287]
mat_Sqrt:  [[0.15]]
grads:  [0.06480132]
Stock Position:  0.06480132332027622
Bond Position:  [5.69770803]


portfolio before change:  [12.14134524]
curr_Stock_Price:  99.4313197589643
curr_Factors:  [99.43131976]
mat_Sqrt:  [[0.15]]
grads:  [0.05362757]
Stock Position:  0.053627568641599135
Bond Position:  [6.80908532]


portfolio before change:  [12.17080529]
curr_Stock_Price:  99.97272898078647
curr_Factors:  [99.97272898]
mat_Sqrt:  [[0.15]]
grads:  [0.15623325]
Stock Position:  0.1562332528484906
Bond Position:  [-3.44825936]


portfolio before change:  [12.02546996]
curr_Stock_Price:  99.0438626958457
curr_Factors:  [99.0438627]
mat_Sqrt:  [[0.15]]
grads:  [0.01790957]
Stock Position:  0.01790957128846862
Bond Position:  [10.25163684]


portfolio before change:  [12.00721835]
curr_Stock_Price:  97.98898796190795
curr_Factors:  [97.98898796]
mat_Sqrt:  [[0.15]]
grads:  [-0.04337897]
Stock Position:  -0.04337896688696843
Bond Position:  [16.25787942]


portfolio before change:  [12.03793485]
curr_Stock_Price:  97.30431638911533
curr_Factors:  [97.30431639]
mat_Sqrt:  [[0.15]]
grads:  [0.12021386]
Stock Position:  0.12021386395763221
Bond Position:  [0.340607]


portfolio before change:  [12.15076665]
curr_Stock_Price:  98.24273151669252
curr_Factors:  [98.24273152]
mat_Sqrt:  [[0.15]]
grads:  [0.07655487]
Stock Position:  0.0765548704640184
Bond Position:  [4.62980706]


portfolio before change:  [12.20148393]
curr_Stock_Price:  98.90144749233737
curr_Factors:  [98.90144749]
mat_Sqrt:  [[0.15]]
grads:  [-0.09919994]
Stock Position:  -0.09919993987148437
Bond Position:  [22.01250158]


portfolio before change:  [12.2088856]
curr_Stock_Price:  98.84070310775253
curr_Factors:  [98.84070311]
mat_Sqrt:  [[0.15]]
grads:  [-0.00044807]
Stock Position:  -0.00044807462994756256
Bond Position:  [12.25317361]


portfolio before change:  [12.20993559]
curr_Stock_Price:  98.20655788145423
curr_Factors:  [98.20655788]
mat_Sqrt:  [[0.15]]
grads:  [0.12107362]
Stock Position:  0.12107361909454824
Bond Position:  [0.31971221]


portfolio before change:  [12.25317148]
curr_Stock_Price:  98.56349696765321
curr_Factors:  [98.56349697]
mat_Sqrt:  [[0.15]]
grads:  [0.03120683]
Stock Position:  0.03120682647623869
Bond Position:  [9.17731753]


portfolio before change:  [12.28585721]
curr_Stock_Price:  99.59250674746472
curr_Factors:  [99.59250675]
mat_Sqrt:  [[0.15]]
grads:  [0.02093346]
Stock Position:  0.02093346070290408
Bond Position:  [10.20104138]


portfolio before change:  [12.26805352]
curr_Stock_Price:  98.71155958043076
curr_Factors:  [98.71155958]
mat_Sqrt:  [[0.15]]
grads:  [-0.22620649]
Stock Position:  -0.22620649067721318
Bond Position:  [34.597249]


portfolio before change:  [12.31584821]
curr_Stock_Price:  98.50983108638817
curr_Factors:  [98.50983109]
mat_Sqrt:  [[0.15]]
grads:  [-0.11241334]
Stock Position:  -0.11241333959159504
Bond Position:  [23.38966731]


portfolio before change:  [12.3624295]
curr_Stock_Price:  98.10846063063008
curr_Factors:  [98.10846063]
mat_Sqrt:  [[0.15]]
grads:  [0.04761919]
Stock Position:  0.04761918811920741
Bond Position:  [7.69058426]


portfolio before change:  [12.34498614]
curr_Stock_Price:  97.73205689609507
curr_Factors:  [97.7320569]
mat_Sqrt:  [[0.15]]
grads:  [0.1926916]
Stock Position:  0.1926916013342293
Bond Position:  [-6.4871604]


portfolio before change:  [12.43224195]
curr_Stock_Price:  98.18698728645391
curr_Factors:  [98.18698729]
mat_Sqrt:  [[0.15]]
grads:  [-0.01884489]
Stock Position:  -0.01884488822413827
Bond Position:  [14.28256475]


portfolio before change:  [12.42859736]
curr_Stock_Price:  98.42775692459895
curr_Factors:  [98.42775692]
mat_Sqrt:  [[0.15]]
grads:  [0.00672375]
Stock Position:  0.006723749044048651
Bond Position:  [11.76679382]


portfolio before change:  [12.43176267]
curr_Stock_Price:  98.78914246122226
curr_Factors:  [98.78914246]
mat_Sqrt:  [[0.15]]
grads:  [0.04424819]
Stock Position:  0.04424818899196686
Bond Position:  [8.06052202]


portfolio before change:  [12.40674267]
curr_Stock_Price:  98.21230994416851
curr_Factors:  [98.21230994]
mat_Sqrt:  [[0.15]]
grads:  [0.10550831]
Stock Position:  0.10550830907743336
Bond Position:  [2.04452792]


portfolio before change:  [12.32717846]
curr_Stock_Price:  97.45699497437523
curr_Factors:  [97.45699497]
mat_Sqrt:  [[0.15]]
grads:  [0.06684133]
Stock Position:  0.0668413299452517
Bond Position:  [5.8130233]


portfolio before change:  [12.27532481]
curr_Stock_Price:  96.67578708065405
curr_Factors:  [96.67578708]
mat_Sqrt:  [[0.15]]
grads:  [0.03549709]
Stock Position:  0.03549709118813704
Bond Position:  [8.84361558]


portfolio before change:  [12.26704256]
curr_Stock_Price:  96.42689360346733
curr_Factors:  [96.4268936]
mat_Sqrt:  [[0.15]]
grads:  [-0.05416417]
Stock Position:  -0.05416416505278781
Bond Position:  [17.48992474]


portfolio before change:  [12.24865484]
curr_Stock_Price:  96.78655705681987
curr_Factors:  [96.78655706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00186646]
Stock Position:  -0.0018664591725149615
Bond Position:  [12.429303]


portfolio before change:  [12.24902529]
curr_Stock_Price:  97.00429863625295
curr_Factors:  [97.00429864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02862175]
Stock Position:  -0.02862175151900554
Bond Position:  [15.02545822]


portfolio before change:  [12.23344769]
curr_Stock_Price:  97.581367476349
curr_Factors:  [97.58136748]
mat_Sqrt:  [[0.15]]
grads:  [0.00950196]
Stock Position:  0.009501964413927064
Bond Position:  [11.30623301]


portfolio before change:  [12.22717694]
curr_Stock_Price:  96.84705473361598
curr_Factors:  [96.84705473]
mat_Sqrt:  [[0.15]]
grads:  [0.00311543]
Stock Position:  0.0031154269655889644
Bond Position:  [11.92545701]


portfolio before change:  [12.2258883]
curr_Stock_Price:  96.19417511291762
curr_Factors:  [96.19417511]
mat_Sqrt:  [[0.15]]
grads:  [0.05543646]
Stock Position:  0.05543645602267546
Bond Position:  [6.89322414]


portfolio before change:  [12.24723971]
curr_Stock_Price:  96.57155429051545
curr_Factors:  [96.57155429]
mat_Sqrt:  [[0.15]]
grads:  [-0.07020836]
Stock Position:  -0.07020836185981828
Bond Position:  [19.02737034]


portfolio before change:  [12.26341664]
curr_Stock_Price:  96.3580799280833
curr_Factors:  [96.35807993]
mat_Sqrt:  [[0.15]]
grads:  [-0.03285857]
Stock Position:  -0.03285857025518489
Bond Position:  [15.42960538]


portfolio before change:  [12.27836608]
curr_Stock_Price:  95.93246621925218
curr_Factors:  [95.93246622]
mat_Sqrt:  [[0.15]]
grads:  [-0.00979918]
Stock Position:  -0.009799175517554956
Bond Position:  [13.21842515]


portfolio before change:  [12.27417492]
curr_Stock_Price:  96.44448246948124
curr_Factors:  [96.44448247]
mat_Sqrt:  [[0.15]]
grads:  [0.08520016]
Stock Position:  0.08520016375653719
Bond Position:  [4.05708922]


portfolio before change:  [12.31778457]
curr_Stock_Price:  96.9533556098924
curr_Factors:  [96.95335561]
mat_Sqrt:  [[0.15]]
grads:  [0.05290515]
Stock Position:  0.05290514897572233
Bond Position:  [7.18845285]


portfolio before change:  [12.29749381]
curr_Stock_Price:  96.5613322917438
curr_Factors:  [96.56133229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085888]
Stock Position:  -0.02085888090480964
Bond Position:  [14.31165514]


portfolio before change:  [12.29532438]
curr_Stock_Price:  96.70822123717933
curr_Factors:  [96.70822124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03427366]
Stock Position:  -0.034273659962385905
Bond Position:  [15.60986907]


portfolio before change:  [12.2994781]
curr_Stock_Price:  96.61549478613158
curr_Factors:  [96.61549479]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955286]
Stock Position:  -0.00955285828736985
Bond Position:  [13.22243223]


portfolio before change:  [12.30260021]
curr_Stock_Price:  96.37518102964879
curr_Factors:  [96.37518103]
mat_Sqrt:  [[0.15]]
grads:  [-0.01964512]
Stock Position:  -0.01964511662324272
Bond Position:  [14.19590188]


portfolio before change:  [12.29594178]
curr_Stock_Price:  96.7592816079336
curr_Factors:  [96.75928161]
mat_Sqrt:  [[0.15]]
grads:  [-0.01551861]
Stock Position:  -0.015518610856457334
Bond Position:  [13.79751142]


portfolio before change:  [12.30023771]
curr_Stock_Price:  96.53802714900822
curr_Factors:  [96.53802715]
mat_Sqrt:  [[0.15]]
grads:  [0.12623684]
Stock Position:  0.12623684493613127
Bond Position:  [0.11358175]


portfolio before change:  [12.34003119]
curr_Stock_Price:  96.85319957981555
curr_Factors:  [96.85319958]
mat_Sqrt:  [[0.15]]
grads:  [0.03134005]
Stock Position:  0.03134004664183074
Bond Position:  [9.30464739]


portfolio before change:  [12.35434018]
curr_Stock_Price:  97.29121546039849
curr_Factors:  [97.29121546]
mat_Sqrt:  [[0.15]]
grads:  [0.08947379]
Stock Position:  0.08947378907723474
Bond Position:  [3.64932649]


portfolio before change:  [12.35026619]
curr_Stock_Price:  97.24313345474239
curr_Factors:  [97.24313345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959912]
Stock Position:  -0.009599123406619862
Bond Position:  [13.28371503]


portfolio before change:  [12.35315217]
curr_Stock_Price:  97.02897714637085
curr_Factors:  [97.02897715]
mat_Sqrt:  [[0.15]]
grads:  [0.02889895]
Stock Position:  0.028898948971875008
Bond Position:  [9.54911671]


portfolio before change:  [12.35975624]
curr_Stock_Price:  97.23684747126943
curr_Factors:  [97.23684747]
mat_Sqrt:  [[0.15]]
grads:  [0.15517417]
Stock Position:  0.15517417094758953
Bond Position:  [-2.72889095]


portfolio before change:  [12.30686438]
curr_Stock_Price:  96.89709187540643
curr_Factors:  [96.89709188]
mat_Sqrt:  [[0.15]]
grads:  [0.02260347]
Stock Position:  0.022603466004158294
Bond Position:  [10.11665426]


portfolio before change:  [12.29883006]
curr_Stock_Price:  96.51367121200437
curr_Factors:  [96.51367121]
mat_Sqrt:  [[0.15]]
grads:  [-0.10277448]
Stock Position:  -0.1027744752437228
Bond Position:  [22.21797197]


portfolio before change:  [12.28062764]
curr_Stock_Price:  96.70429334702618
curr_Factors:  [96.70429335]
mat_Sqrt:  [[0.15]]
grads:  [-0.03803948]
Stock Position:  -0.038039477941564
Bond Position:  [15.95920847]


portfolio before change:  [12.27644766]
curr_Stock_Price:  96.84040073057022
curr_Factors:  [96.84040073]
mat_Sqrt:  [[0.15]]
grads:  [0.01141786]
Stock Position:  0.011417864801635747
Bond Position:  [11.17073706]


portfolio before change:  [12.27963175]
curr_Stock_Price:  97.05812053139269
curr_Factors:  [97.05812053]
mat_Sqrt:  [[0.15]]
grads:  [0.06285892]
Stock Position:  0.06285891965342327
Bond Position:  [6.17866315]


portfolio before change:  [12.28186899]
curr_Stock_Price:  97.08756841356359
curr_Factors:  [97.08756841]
mat_Sqrt:  [[0.15]]
grads:  [0.01086284]
Stock Position:  0.010862840992700898
Bond Position:  [11.22722217]


portfolio before change:  [12.28324073]
curr_Stock_Price:  97.14924816295921
curr_Factors:  [97.14924816]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074878]
Stock Position:  -0.010748775167452434
Bond Position:  [13.32747616]


portfolio before change:  [12.2849749]
curr_Stock_Price:  97.06540887556038
curr_Factors:  [97.06540888]
mat_Sqrt:  [[0.15]]
grads:  [-0.0576409]
Stock Position:  -0.05764090276121004
Bond Position:  [17.87991269]


portfolio before change:  [12.31116162]
curr_Stock_Price:  96.63048871003544
curr_Factors:  [96.63048871]
mat_Sqrt:  [[0.15]]
grads:  [-0.16313531]
Stock Position:  -0.16313530626952674
Bond Position:  [28.07500599]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.40934268]
Stock Price:  96.03940682700656
PL:  [12.40934268]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.22051174e-03]
 [ 2.35694543e-02]
 [ 1.94472407e-02]
 [-2.06676541e-02]
 [ 1.28652374e-02]
 [-8.00807910e-03]
 [-2.03166322e-03]
 [-4.10073331e-04]
 [-6.95854339e-03]
 [-9.68690544e-04]
 [-4.33158713e-03]
 [ 6.61262220e-03]
 [-2.75489211e-03]
 [ 9.33158138e-03]
 [-8.21955785e-05]
 [ 1.14834548e-02]
 [ 6.70764374e-03]
 [-1.32925847e-02]
 [ 1.90919088e-02]
 [ 2.60314188e-03]
 [-4.24475859e-03]
 [ 4.53468619e-03]
 [ 1.11730032e-02]
 [ 2.67379674e-02]
 [-2.29398249e-03]
 [ 6.79828321e-03]
 [-5.49297210e-03]
 [ 6.19256046e-03]
 [ 3.18222495e-02]
 [ 3.37794111e-04]
 [-7.03953885e-03]
 [ 7.94151561e-03]
 [ 1.24184295e-02]
 [ 9.44722527e-03]
 [ 6.51687791e-03]
 [ 1.34647215e-02]
 [-1.12771212e-02]
 [ 2.76750989e-03]
 [-5.69571188e-02]
 [ 3.31324430e-03]
 [ 6.90828852e-03]
 [ 8.91977137e-03]
 [-4.86699965e-03]
 [-4.39984219e-03]
 [ 1.43656998e-02]
 [ 1.40923518e-02]
 [ 1.09069275e-02]
 [ 3.82419432e-03]
 [ 9.71185321e-03]
 [-1.95506786e-03]
 [ 8.08241518e-03]
 [-1.52673036e-02]
 [ 1.19639347e-03]
 [-1.30354025e-02]
 [-2.09861240e-03]
 [-3.18001426e-03]
 [ 1.06200243e-02]
 [-1.24918149e-02]
 [ 5.57439968e-03]
 [-3.92332230e-03]
 [-2.47927537e-03]
 [ 8.44384554e-03]
 [-1.71282433e-02]
 [ 6.10128812e-03]
 [ 2.54813133e-02]
 [ 5.45014347e-03]
 [ 9.87207975e-03]
 [-1.42946255e-03]
 [ 2.99576295e-03]
 [ 1.99460279e-02]
 [ 3.29371685e-04]
 [-1.59299292e-02]
 [-3.77829850e-04]
 [ 1.40451430e-03]
 [-2.67807654e-04]
 [-7.56796334e-03]
 [-4.13467881e-03]
 [ 1.27447922e-02]
 [-2.05930513e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.71477823]
curr_Stock_Price:  100.7123745026833
curr_Factors:  [100.7123745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03480341]
Stock Position:  -0.034803411567752414
Bond Position:  [21.21991245]


portfolio before change:  [17.72359092]
curr_Stock_Price:  100.49726905324957
curr_Factors:  [100.49726905]
mat_Sqrt:  [[0.15]]
grads:  [0.1571297]
Stock Position:  0.157129695096553
Bond Position:  [1.93248567]


portfolio before change:  [17.82768446]
curr_Stock_Price:  101.15896926770152
curr_Factors:  [101.15896927]
mat_Sqrt:  [[0.15]]
grads:  [0.12964827]
Stock Position:  0.12964827164522177
Bond Position:  [4.71259893]


portfolio before change:  [17.79294163]
curr_Stock_Price:  100.8887198454974
curr_Factors:  [100.88871985]
mat_Sqrt:  [[0.15]]
grads:  [-0.13778436]
Stock Position:  -0.13778436072581507
Bond Position:  [31.6938294]


portfolio before change:  [17.90399908]
curr_Stock_Price:  100.09707324089534
curr_Factors:  [100.09707324]
mat_Sqrt:  [[0.15]]
grads:  [0.08576825]
Stock Position:  0.0857682491018577
Bond Position:  [9.31884837]


portfolio before change:  [17.88037435]
curr_Stock_Price:  99.8148339170337
curr_Factors:  [99.81483392]
mat_Sqrt:  [[0.15]]
grads:  [-0.05338719]
Stock Position:  -0.05338719402213077
Bond Position:  [23.20920826]


portfolio before change:  [17.9088421]
curr_Stock_Price:  99.30877377382721
curr_Factors:  [99.30877377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01354442]
Stock Position:  -0.01354442144763
Bond Position:  [19.25392199]


portfolio before change:  [17.90742443]
curr_Stock_Price:  99.50229110258606
curr_Factors:  [99.5022911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00273382]
Stock Position:  -0.002733822209674252
Bond Position:  [18.17944601]


portfolio before change:  [17.90731874]
curr_Stock_Price:  99.95657771451572
curr_Factors:  [99.95657771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04639029]
Stock Position:  -0.04639028924486969
Bond Position:  [22.5443333]


portfolio before change:  [17.85881371]
curr_Stock_Price:  101.03253781711369
curr_Factors:  [101.03253782]
mat_Sqrt:  [[0.15]]
grads:  [-0.00645794]
Stock Position:  -0.006457936962891732
Bond Position:  [18.51127547]


portfolio before change:  [17.86022846]
curr_Stock_Price:  100.99262465918129
curr_Factors:  [100.99262466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02887725]
Stock Position:  -0.028877247540017855
Bond Position:  [20.77661748]


portfolio before change:  [17.86111109]
curr_Stock_Price:  101.00702840963353
curr_Factors:  [101.00702841]
mat_Sqrt:  [[0.15]]
grads:  [0.04408415]
Stock Position:  0.0440841480109186
Bond Position:  [13.4083023]


portfolio before change:  [17.84174157]
curr_Stock_Price:  100.54864219197601
curr_Factors:  [100.54864219]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836595]
Stock Position:  -0.01836594736958283
Bond Position:  [19.68841264]


portfolio before change:  [17.85458256]
curr_Stock_Price:  99.91647124797252
curr_Factors:  [99.91647125]
mat_Sqrt:  [[0.15]]
grads:  [0.06221054]
Stock Position:  0.06221054254599172
Bond Position:  [11.63872467]


portfolio before change:  [17.85039806]
curr_Stock_Price:  99.83751448066803
curr_Factors:  [99.83751448]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054797]
Stock Position:  -0.0005479705233272028
Bond Position:  [17.90510607]


portfolio before change:  [17.85177039]
curr_Stock_Price:  99.37539064523402
curr_Factors:  [99.37539065]
mat_Sqrt:  [[0.15]]
grads:  [0.07655637]
Stock Position:  0.0765563652209296
Bond Position:  [10.24395169]


portfolio before change:  [17.80782725]
curr_Stock_Price:  98.79303003882904
curr_Factors:  [98.79303004]
mat_Sqrt:  [[0.15]]
grads:  [0.04471762]
Stock Position:  0.04471762496454484
Bond Position:  [13.39003758]


portfolio before change:  [17.79242449]
curr_Stock_Price:  98.4298699651607
curr_Factors:  [98.42986997]
mat_Sqrt:  [[0.15]]
grads:  [-0.08861723]
Stock Position:  -0.08861723102589923
Bond Position:  [26.51500702]


portfolio before change:  [17.61718802]
curr_Stock_Price:  100.4260247413911
curr_Factors:  [100.42602474]
mat_Sqrt:  [[0.15]]
grads:  [0.12727939]
Stock Position:  0.12727939205733652
Bond Position:  [4.83502465]


portfolio before change:  [17.59029598]
curr_Stock_Price:  100.21236687881446
curr_Factors:  [100.21236688]
mat_Sqrt:  [[0.15]]
grads:  [0.01735428]
Stock Position:  0.017354279215019704
Bond Position:  [15.85118258]


portfolio before change:  [17.59127164]
curr_Stock_Price:  100.2114985101756
curr_Factors:  [100.21149851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02829839]
Stock Position:  -0.02829839060449254
Bond Position:  [20.42709577]


portfolio before change:  [17.56168496]
curr_Stock_Price:  101.30214044272073
curr_Factors:  [101.30214044]
mat_Sqrt:  [[0.15]]
grads:  [0.03023124]
Stock Position:  0.030231241237691477
Bond Position:  [14.49919552]


portfolio before change:  [17.57741776]
curr_Stock_Price:  101.79257929120456
curr_Factors:  [101.79257929]
mat_Sqrt:  [[0.15]]
grads:  [0.07448669]
Stock Position:  0.07448668817409611
Bond Position:  [9.99522565]


portfolio before change:  [17.58534731]
curr_Stock_Price:  101.89064815881326
curr_Factors:  [101.89064816]
mat_Sqrt:  [[0.15]]
grads:  [0.17825312]
Stock Position:  0.17825311582171083
Bond Position:  [-0.5769782]


portfolio before change:  [17.47182125]
curr_Stock_Price:  101.25396923538469
curr_Factors:  [101.25396924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01529322]
Stock Position:  -0.015293216621876111
Bond Position:  [19.02032013]


portfolio before change:  [17.47691898]
curr_Stock_Price:  100.99837054716086
curr_Factors:  [100.99837055]
mat_Sqrt:  [[0.15]]
grads:  [0.04532189]
Stock Position:  0.04532188805238843
Bond Position:  [12.89948214]


portfolio before change:  [17.49843432]
curr_Stock_Price:  101.45530428639064
curr_Factors:  [101.45530429]
mat_Sqrt:  [[0.15]]
grads:  [-0.03661981]
Stock Position:  -0.03661981399975464
Bond Position:  [21.2137087]


portfolio before change:  [17.52244254]
curr_Stock_Price:  100.83590411997767
curr_Factors:  [100.83590412]
mat_Sqrt:  [[0.15]]
grads:  [0.04128374]
Stock Position:  0.04128373642218288
Bond Position:  [13.35955965]


portfolio before change:  [17.52148549]
curr_Stock_Price:  100.79249609908305
curr_Factors:  [100.7924961]
mat_Sqrt:  [[0.15]]
grads:  [0.21214833]
Stock Position:  0.21214832995730765
Bond Position:  [-3.86147423]


portfolio before change:  [17.36168673]
curr_Stock_Price:  100.04039302010523
curr_Factors:  [100.04039302]
mat_Sqrt:  [[0.15]]
grads:  [0.00225196]
Stock Position:  0.00225196074270471
Bond Position:  [17.13639969]


portfolio before change:  [17.36185723]
curr_Stock_Price:  99.6404915470261
curr_Factors:  [99.64049155]
mat_Sqrt:  [[0.15]]
grads:  [-0.04693026]
Stock Position:  -0.046930258970950746
Bond Position:  [22.0380113]


portfolio before change:  [17.32024251]
curr_Stock_Price:  100.55657725251037
curr_Factors:  [100.55657725]
mat_Sqrt:  [[0.15]]
grads:  [0.05294344]
Stock Position:  0.05294343741549094
Bond Position:  [11.99643165]


portfolio before change:  [17.32363138]
curr_Stock_Price:  100.60642433661175
curr_Factors:  [100.60642434]
mat_Sqrt:  [[0.15]]
grads:  [0.08278953]
Stock Position:  0.08278952970979606
Bond Position:  [8.99447283]


portfolio before change:  [17.33916276]
curr_Stock_Price:  100.78723474697173
curr_Factors:  [100.78723475]
mat_Sqrt:  [[0.15]]
grads:  [0.0629815]
Stock Position:  0.06298150177816984
Bond Position:  [10.99143136]


portfolio before change:  [17.29823237]
curr_Stock_Price:  100.1264473472325
curr_Factors:  [100.12644735]
mat_Sqrt:  [[0.15]]
grads:  [0.04344585]
Stock Position:  0.04344585274761309
Bond Position:  [12.94815348]


portfolio before change:  [17.29624853]
curr_Stock_Price:  100.06215753190071
curr_Factors:  [100.06215753]
mat_Sqrt:  [[0.15]]
grads:  [0.08976481]
Stock Position:  0.08976481024409849
Bond Position:  [8.31418794]


portfolio before change:  [17.27031614]
curr_Stock_Price:  99.76747589084216
curr_Factors:  [99.76747589]
mat_Sqrt:  [[0.15]]
grads:  [-0.07518081]
Stock Position:  -0.0751808079254313
Bond Position:  [24.77091558]


portfolio before change:  [17.2307224]
curr_Stock_Price:  100.31471618416427
curr_Factors:  [100.31471618]
mat_Sqrt:  [[0.15]]
grads:  [0.01845007]
Stock Position:  0.018450065928013095
Bond Position:  [15.37990927]


portfolio before change:  [17.22729957]
curr_Stock_Price:  100.07709634663708
curr_Factors:  [100.07709635]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971413]
Stock Position:  -0.379714125226719
Bond Position:  [55.22798667]


portfolio before change:  [17.21723805]
curr_Stock_Price:  100.11268465275906
curr_Factors:  [100.11268465]
mat_Sqrt:  [[0.15]]
grads:  [0.0220883]
Stock Position:  0.022088295309811365
Bond Position:  [15.00591951]


portfolio before change:  [17.2267292]
curr_Stock_Price:  100.49991482117265
curr_Factors:  [100.49991482]
mat_Sqrt:  [[0.15]]
grads:  [0.04605526]
Stock Position:  0.04605525677293854
Bond Position:  [12.59817982]


portfolio before change:  [17.27585286]
curr_Stock_Price:  101.54944202574791
curr_Factors:  [101.54944203]
mat_Sqrt:  [[0.15]]
grads:  [0.05946514]
Stock Position:  0.05946514245085347
Bond Position:  [11.23720082]


portfolio before change:  [17.2868627]
curr_Stock_Price:  101.7227787527333
curr_Factors:  [101.72277875]
mat_Sqrt:  [[0.15]]
grads:  [-0.03244666]
Stock Position:  -0.03244666435778792
Bond Position:  [20.58742756]


portfolio before change:  [17.30315656]
curr_Stock_Price:  101.26026250778808
curr_Factors:  [101.26026251]
mat_Sqrt:  [[0.15]]
grads:  [-0.02933228]
Stock Position:  -0.029332281246267338
Bond Position:  [20.27335106]


portfolio before change:  [17.29720027]
curr_Stock_Price:  101.50652424483073
curr_Factors:  [101.50652424]
mat_Sqrt:  [[0.15]]
grads:  [0.09577133]
Stock Position:  0.09577133181786562
Bond Position:  [7.57578525]


portfolio before change:  [17.25156005]
curr_Stock_Price:  101.02502609692388
curr_Factors:  [101.0250261]
mat_Sqrt:  [[0.15]]
grads:  [0.09394901]
Stock Position:  0.09394901171319496
Bond Position:  [7.76035869]


portfolio before change:  [17.19015376]
curr_Stock_Price:  100.36625038557135
curr_Factors:  [100.36625039]
mat_Sqrt:  [[0.15]]
grads:  [0.07271285]
Stock Position:  0.0727128500261619
Bond Position:  [9.89223765]


portfolio before change:  [17.20043381]
curr_Stock_Price:  100.49912600617516
curr_Factors:  [100.49912601]
mat_Sqrt:  [[0.15]]
grads:  [0.02549463]
Stock Position:  0.025494628827404445
Bond Position:  [14.63824589]


portfolio before change:  [17.20295817]
curr_Stock_Price:  100.56225480551842
curr_Factors:  [100.56225481]
mat_Sqrt:  [[0.15]]
grads:  [0.06474569]
Stock Position:  0.06474568809092823
Bond Position:  [10.69198579]


portfolio before change:  [17.18086331]
curr_Stock_Price:  100.21067727825366
curr_Factors:  [100.21067728]
mat_Sqrt:  [[0.15]]
grads:  [-0.01303379]
Stock Position:  -0.013033785703666922
Bond Position:  [18.48698781]


portfolio before change:  [17.17227256]
curr_Stock_Price:  100.95844380267289
curr_Factors:  [100.9584438]
mat_Sqrt:  [[0.15]]
grads:  [0.05388277]
Stock Position:  0.05388276786917212
Bond Position:  [11.73235217]


portfolio before change:  [17.17713498]
curr_Stock_Price:  101.03507552170035
curr_Factors:  [101.03507552]
mat_Sqrt:  [[0.15]]
grads:  [-0.10178202]
Stock Position:  -0.10178202378446269
Bond Position:  [27.46068944]


portfolio before change:  [17.10297748]
curr_Stock_Price:  101.78052984725544
curr_Factors:  [101.78052985]
mat_Sqrt:  [[0.15]]
grads:  [0.00797596]
Stock Position:  0.007975956476993553
Bond Position:  [16.2911804]


portfolio before change:  [17.11209481]
curr_Stock_Price:  102.7959693172916
curr_Factors:  [102.79596932]
mat_Sqrt:  [[0.15]]
grads:  [-0.08690268]
Stock Position:  -0.08690268308644075
Bond Position:  [26.04534036]


portfolio before change:  [17.10542522]
curr_Stock_Price:  102.89144937955093
curr_Factors:  [102.89144938]
mat_Sqrt:  [[0.15]]
grads:  [-0.01399075]
Stock Position:  -0.013990749354627706
Bond Position:  [18.5449537]


portfolio before change:  [17.11018737]
curr_Stock_Price:  102.63391808620511
curr_Factors:  [102.63391809]
mat_Sqrt:  [[0.15]]
grads:  [-0.0212001]
Stock Position:  -0.021200095091948343
Bond Position:  [19.2860362]


portfolio before change:  [17.11880126]
curr_Stock_Price:  102.2844635232041
curr_Factors:  [102.28446352]
mat_Sqrt:  [[0.15]]
grads:  [0.07080016]
Stock Position:  0.07080016202640783
Bond Position:  [9.87704467]


portfolio before change:  [17.17952741]
curr_Stock_Price:  103.13345616997375
curr_Factors:  [103.13345617]
mat_Sqrt:  [[0.15]]
grads:  [-0.08327877]
Stock Position:  -0.08327876594957337
Bond Position:  [25.76835437]


portfolio before change:  [17.22024782]
curr_Stock_Price:  102.66383060939498
curr_Factors:  [102.66383061]
mat_Sqrt:  [[0.15]]
grads:  [0.03716266]
Stock Position:  0.037162664515094285
Bond Position:  [13.40498633]


portfolio before change:  [17.20767493]
curr_Stock_Price:  102.30296491438865
curr_Factors:  [102.30296491]
mat_Sqrt:  [[0.15]]
grads:  [-0.02615548]
Stock Position:  -0.026155482031858756
Bond Position:  [19.88345829]


portfolio before change:  [17.20829451]
curr_Stock_Price:  102.326790406543
curr_Factors:  [102.32679041]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165285]
Stock Position:  -0.016528502498261374
Bond Position:  [18.89960313]


portfolio before change:  [17.21440336]
curr_Stock_Price:  102.02866410387723
curr_Factors:  [102.0286641]
mat_Sqrt:  [[0.15]]
grads:  [0.0562923]
Stock Position:  0.05629230363278411
Bond Position:  [11.47097482]


portfolio before change:  [17.23727523]
curr_Stock_Price:  102.42223320011513
curr_Factors:  [102.4222332]
mat_Sqrt:  [[0.15]]
grads:  [-0.11418829]
Stock Position:  -0.1141882887045903
Bond Position:  [28.93269476]


portfolio before change:  [17.34437831]
curr_Stock_Price:  101.50011824579963
curr_Factors:  [101.50011825]
mat_Sqrt:  [[0.15]]
grads:  [0.04067525]
Stock Position:  0.04067525411732249
Bond Position:  [13.2158352]


portfolio before change:  [17.33442136]
curr_Stock_Price:  101.23501946015865
curr_Factors:  [101.23501946]
mat_Sqrt:  [[0.15]]
grads:  [0.16987542]
Stock Position:  0.16987542167720593
Bond Position:  [0.13707974]


portfolio before change:  [17.35885599]
curr_Stock_Price:  101.3788075595497
curr_Factors:  [101.37880756]
mat_Sqrt:  [[0.15]]
grads:  [0.03633429]
Stock Position:  0.03633428983060543
Bond Position:  [13.67532902]


portfolio before change:  [17.33998248]
curr_Stock_Price:  100.83584260386054
curr_Factors:  [100.8358426]
mat_Sqrt:  [[0.15]]
grads:  [0.06581386]
Stock Position:  0.06581386499886241
Bond Position:  [10.70358595]


portfolio before change:  [17.30638559]
curr_Stock_Price:  100.31519410929936
curr_Factors:  [100.31519411]
mat_Sqrt:  [[0.15]]
grads:  [-0.00952975]
Stock Position:  -0.009529750348176989
Bond Position:  [18.26236434]


portfolio before change:  [17.31084546]
curr_Stock_Price:  99.96697475562523
curr_Factors:  [99.96697476]
mat_Sqrt:  [[0.15]]
grads:  [0.01997175]
Stock Position:  0.01997175299804003
Bond Position:  [15.31432974]


portfolio before change:  [17.33055278]
curr_Stock_Price:  100.90580766406875
curr_Factors:  [100.90580766]
mat_Sqrt:  [[0.15]]
grads:  [0.13297352]
Stock Position:  0.13297351956936565
Bond Position:  [3.91275239]


portfolio before change:  [17.30868215]
curr_Stock_Price:  100.73949497180502
curr_Factors:  [100.73949497]
mat_Sqrt:  [[0.15]]
grads:  [0.00219581]
Stock Position:  0.002195811236653103
Bond Position:  [17.08747723]


portfolio before change:  [17.31030228]
curr_Stock_Price:  100.99094216788056
curr_Factors:  [100.99094217]
mat_Sqrt:  [[0.15]]
grads:  [-0.10619953]
Stock Position:  -0.10619952799613086
Bond Position:  [28.03549267]


portfolio before change:  [17.28465437]
curr_Stock_Price:  101.24894880401038
curr_Factors:  [101.2489488]
mat_Sqrt:  [[0.15]]
grads:  [-0.00251887]
Stock Position:  -0.0025188656664730294
Bond Position:  [17.53968687]


portfolio before change:  [17.28571981]
curr_Stock_Price:  101.26118830751608
curr_Factors:  [101.26118831]
mat_Sqrt:  [[0.15]]
grads:  [0.00936343]
Stock Position:  0.009363428650759115
Bond Position:  [16.33756789]


portfolio before change:  [17.28314157]
curr_Stock_Price:  100.87678190536397
curr_Factors:  [100.87678191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00178538]
Stock Position:  -0.0017853843584489382
Bond Position:  [17.4632454]


portfolio before change:  [17.2849321]
curr_Stock_Price:  100.48524732338365
curr_Factors:  [100.48524732]
mat_Sqrt:  [[0.15]]
grads:  [-0.05045309]
Stock Position:  -0.050453088955425635
Bond Position:  [22.35472322]


portfolio before change:  [17.30206941]
curr_Stock_Price:  100.1732724695628
curr_Factors:  [100.17327247]
mat_Sqrt:  [[0.15]]
grads:  [-0.02756453]
Stock Position:  -0.027564525378202
Bond Position:  [20.06329812]


portfolio before change:  [17.2932683]
curr_Stock_Price:  100.53805658962241
curr_Factors:  [100.53805659]
mat_Sqrt:  [[0.15]]
grads:  [0.08496528]
Stock Position:  0.08496528108544492
Bond Position:  [8.75102407]


portfolio before change:  [17.26297842]
curr_Stock_Price:  100.17512203234186
curr_Factors:  [100.17512203]
mat_Sqrt:  [[0.15]]
grads:  [-0.13728701]
Stock Position:  -0.13728700879946235
Bond Position:  [31.01572128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.16075317]
Stock Price:  100.93385217602373
PL:  [16.226901]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.28857895e-02]
 [ 1.35452690e-02]
 [ 1.02849670e-02]
 [-9.25715604e-03]
 [ 1.28603939e-02]
 [-2.49303236e-03]
 [ 7.26978744e-04]
 [-7.60396875e-03]
 [-1.22423789e-02]
 [-8.58221130e-03]
 [ 1.15339825e-02]
 [ 1.05544468e-02]
 [-3.60166309e-03]
 [ 3.35286864e-03]
 [ 8.58576400e-03]
 [ 1.37754256e-02]
 [ 9.55490342e-02]
 [-1.34212389e-02]
 [ 1.84084647e-02]
 [ 1.42052992e-03]
 [-3.74281944e-03]
 [ 4.46784295e-03]
 [ 1.16540994e-02]
 [ 2.05949004e-02]
 [ 1.71991131e-04]
 [ 8.42107537e-03]
 [-2.02688045e-03]
 [ 1.57911227e-02]
 [ 2.77617097e-02]
 [-2.77099060e-03]
 [-3.20159023e-03]
 [ 1.35608265e-02]
 [ 1.34334802e-02]
 [ 4.75723177e-04]
 [ 4.89094311e-03]
 [ 8.73051375e-03]
 [-2.49649394e-02]
 [ 2.74564799e-03]
 [-4.41994181e-02]
 [-2.23153379e-03]
 [ 4.66199818e-03]
 [ 8.62259558e-04]
 [-1.82232731e-03]
 [-4.70226828e-03]
 [ 2.02720936e-02]
 [ 1.40472349e-02]
 [ 1.07855918e-02]
 [ 3.18413266e-03]
 [ 1.24481334e-02]
 [-1.37046395e-03]
 [ 1.72820989e-02]
 [-1.13176168e-02]
 [ 2.16085970e-03]
 [ 1.96313413e-03]
 [-4.13642063e-03]
 [-3.89667307e-03]
 [ 9.32631652e-03]
 [ 3.46576990e-03]
 [ 6.95379481e-03]
 [-3.97697608e-03]
 [-2.63609829e-03]
 [ 8.09602165e-03]
 [-1.64477559e-02]
 [ 4.51469648e-03]
 [ 2.55940736e-02]
 [ 5.39860511e-03]
 [ 1.44731076e-02]
 [ 5.51125923e-03]
 [ 6.20084269e-03]
 [ 1.27218038e-02]
 [ 8.41641938e-04]
 [-1.53261886e-02]
 [-4.57380553e-03]
 [ 1.12220903e-03]
 [ 2.87420445e-03]
 [-1.62504496e-02]
 [-3.51900032e-03]
 [ 1.32281022e-02]
 [-3.86542901e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.01526594]
curr_Stock_Price:  99.40751477244953
curr_Factors:  [99.40751477]
mat_Sqrt:  [[0.15]]
grads:  [-0.08590526]
Stock Position:  -0.08590526350510999
Bond Position:  [-2.47563719]


portfolio before change:  [-11.07857584]
curr_Stock_Price:  100.1426869858722
curr_Factors:  [100.14268699]
mat_Sqrt:  [[0.15]]
grads:  [0.09030179]
Stock Position:  0.09030179344089627
Bond Position:  [-20.12164007]


portfolio before change:  [-11.14697288]
curr_Stock_Price:  99.39918675390555
curr_Factors:  [99.39918675]
mat_Sqrt:  [[0.15]]
grads:  [0.06856645]
Stock Position:  0.06856644651635845
Bond Position:  [-17.96242191]


portfolio before change:  [-11.11987576]
curr_Stock_Price:  99.8107555407051
curr_Factors:  [99.81075554]
mat_Sqrt:  [[0.15]]
grads:  [-0.06171437]
Stock Position:  -0.06171437361359201
Bond Position:  [-4.9601175]


portfolio before change:  [-11.14454148]
curr_Stock_Price:  100.20540755344598
curr_Factors:  [100.20540755]
mat_Sqrt:  [[0.15]]
grads:  [0.08573596]
Stock Position:  0.08573595949529272
Bond Position:  [-19.73574824]


portfolio before change:  [-11.12398801]
curr_Stock_Price:  100.45952490031557
curr_Factors:  [100.4595249]
mat_Sqrt:  [[0.15]]
grads:  [-0.01662022]
Stock Position:  -0.016620215737765256
Bond Position:  [-9.45432903]


portfolio before change:  [-11.12019495]
curr_Stock_Price:  100.19575157225646
curr_Factors:  [100.19575157]
mat_Sqrt:  [[0.15]]
grads:  [0.00484652]
Stock Position:  0.004846524960864322
Bond Position:  [-11.60579616]


portfolio before change:  [-11.12182338]
curr_Stock_Price:  100.00942289383241
curr_Factors:  [100.00942289]
mat_Sqrt:  [[0.15]]
grads:  [-0.05069313]
Stock Position:  -0.05069312501340003
Bond Position:  [-6.05203321]


portfolio before change:  [-11.09649507]
curr_Stock_Price:  99.50232110782258
curr_Factors:  [99.50232111]
mat_Sqrt:  [[0.15]]
grads:  [-0.08161586]
Stock Position:  -0.0816158590888958
Bond Position:  [-2.97552766]


portfolio before change:  [-11.0890009]
curr_Stock_Price:  99.408219854161
curr_Factors:  [99.40821985]
mat_Sqrt:  [[0.15]]
grads:  [-0.05721474]
Stock Position:  -0.05721474197382904
Bond Position:  [-5.40138525]


portfolio before change:  [-11.13121863]
curr_Stock_Price:  100.14020141862531
curr_Factors:  [100.14020142]
mat_Sqrt:  [[0.15]]
grads:  [0.07689322]
Stock Position:  0.07689321644759943
Bond Position:  [-18.83132081]


portfolio before change:  [-11.04525885]
curr_Stock_Price:  101.27341933453268
curr_Factors:  [101.27341933]
mat_Sqrt:  [[0.15]]
grads:  [0.07036298]
Stock Position:  0.07036297839053457
Bond Position:  [-18.17115827]


portfolio before change:  [-11.03924208]
curr_Stock_Price:  101.37507092924149
curr_Factors:  [101.37507093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02401109]
Stock Position:  -0.024011087265292826
Bond Position:  [-8.6051164]


portfolio before change:  [-11.06910642]
curr_Stock_Price:  102.59644439578196
curr_Factors:  [102.5964444]
mat_Sqrt:  [[0.15]]
grads:  [0.02235246]
Stock Position:  0.022352457583984044
Bond Position:  [-13.36238909]


portfolio before change:  [-11.06725726]
curr_Stock_Price:  102.71653547312341
curr_Factors:  [102.71653547]
mat_Sqrt:  [[0.15]]
grads:  [0.05723843]
Stock Position:  0.05723842664233841
Bond Position:  [-16.94659014]


portfolio before change:  [-11.12735138]
curr_Stock_Price:  101.68514937133244
curr_Factors:  [101.68514937]
mat_Sqrt:  [[0.15]]
grads:  [0.09183617]
Stock Position:  0.09183617038900607
Bond Position:  [-20.46572608]


portfolio before change:  [-11.09256521]
curr_Stock_Price:  102.07786298207628
curr_Factors:  [102.07786298]
mat_Sqrt:  [[0.15]]
grads:  [0.63699356]
Stock Position:  0.6369935613819143
Bond Position:  [-76.11550669]


portfolio before change:  [-11.38743066]
curr_Stock_Price:  101.62242967187515
curr_Factors:  [101.62242967]
mat_Sqrt:  [[0.15]]
grads:  [-0.08947493]
Stock Position:  -0.08947492600754882
Bond Position:  [-2.29477129]


portfolio before change:  [-11.36841274]
curr_Stock_Price:  101.4082763330887
curr_Factors:  [101.40827633]
mat_Sqrt:  [[0.15]]
grads:  [0.1227231]
Stock Position:  0.12272309805237007
Bond Position:  [-23.81355058]


portfolio before change:  [-11.3535818]
curr_Stock_Price:  101.54125319959284
curr_Factors:  [101.5412532]
mat_Sqrt:  [[0.15]]
grads:  [0.0094702]
Stock Position:  0.009470199477691442
Bond Position:  [-12.31519772]


portfolio before change:  [-11.35822032]
curr_Stock_Price:  101.13272960615109
curr_Factors:  [101.13272961]
mat_Sqrt:  [[0.15]]
grads:  [-0.02495213]
Stock Position:  -0.024952129601049276
Bond Position:  [-8.83474335]


portfolio before change:  [-11.35826562]
curr_Stock_Price:  101.11241502428491
curr_Factors:  [101.11241502]
mat_Sqrt:  [[0.15]]
grads:  [0.02978562]
Stock Position:  0.029785619666346727
Bond Position:  [-14.36996156]


portfolio before change:  [-11.34106215]
curr_Stock_Price:  101.7201451798244
curr_Factors:  [101.72014518]
mat_Sqrt:  [[0.15]]
grads:  [0.077694]
Stock Position:  0.07769399596043851
Bond Position:  [-19.2441067]


portfolio before change:  [-11.37948092]
curr_Stock_Price:  101.24113807110629
curr_Factors:  [101.24113807]
mat_Sqrt:  [[0.15]]
grads:  [0.13729934]
Stock Position:  0.13729933586554474
Bond Position:  [-25.27982194]


portfolio before change:  [-11.25832518]
curr_Stock_Price:  102.13506652316586
curr_Factors:  [102.13506652]
mat_Sqrt:  [[0.15]]
grads:  [0.00114661]
Stock Position:  0.001146607541279189
Bond Position:  [-11.37543401]


portfolio before change:  [-11.25884462]
curr_Stock_Price:  102.30212208304549
curr_Factors:  [102.30212208]
mat_Sqrt:  [[0.15]]
grads:  [0.0561405]
Stock Position:  0.05614050244152208
Bond Position:  [-17.00213715]


portfolio before change:  [-11.29302316]
curr_Stock_Price:  101.71224711863783
curr_Factors:  [101.71224712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01351254]
Stock Position:  -0.013512536320791416
Bond Position:  [-9.91863273]


portfolio before change:  [-11.29787006]
curr_Stock_Price:  102.02506560405845
curr_Factors:  [102.0250656]
mat_Sqrt:  [[0.15]]
grads:  [0.10527415]
Stock Position:  0.10527415140521366
Bond Position:  [-22.03847227]


portfolio before change:  [-11.29968434]
curr_Stock_Price:  102.02091617350499
curr_Factors:  [102.02091617]
mat_Sqrt:  [[0.15]]
grads:  [0.18507806]
Stock Position:  0.18507806435634502
Bond Position:  [-30.18151803]


portfolio before change:  [-11.34764727]
curr_Stock_Price:  101.77195893433313
curr_Factors:  [101.77195893]
mat_Sqrt:  [[0.15]]
grads:  [-0.01847327]
Stock Position:  -0.018473270659817992
Bond Position:  [-9.46758632]


portfolio before change:  [-11.34778082]
curr_Stock_Price:  101.74715627480613
curr_Factors:  [101.74715627]
mat_Sqrt:  [[0.15]]
grads:  [-0.02134393]
Stock Position:  -0.021343934867474962
Bond Position:  [-9.17609615]


portfolio before change:  [-11.3560278]
curr_Stock_Price:  102.10667061438224
curr_Factors:  [102.10667061]
mat_Sqrt:  [[0.15]]
grads:  [0.09040551]
Stock Position:  0.09040551019620721
Bond Position:  [-20.58703345]


portfolio before change:  [-11.34228599]
curr_Stock_Price:  102.27290533356687
curr_Factors:  [102.27290533]
mat_Sqrt:  [[0.15]]
grads:  [0.08955653]
Stock Position:  0.08955653444028168
Bond Position:  [-20.50149296]


portfolio before change:  [-11.32219235]
curr_Stock_Price:  102.51158172405731
curr_Factors:  [102.51158172]
mat_Sqrt:  [[0.15]]
grads:  [0.00317149]
Stock Position:  0.003171487847851267
Bond Position:  [-11.64730658]


portfolio before change:  [-11.32161885]
curr_Stock_Price:  102.92194849330909
curr_Factors:  [102.92194849]
mat_Sqrt:  [[0.15]]
grads:  [0.03260629]
Stock Position:  0.03260628739274043
Bond Position:  [-14.67752148]


portfolio before change:  [-11.33001812]
curr_Stock_Price:  102.69248670550978
curr_Factors:  [102.69248671]
mat_Sqrt:  [[0.15]]
grads:  [0.05820342]
Stock Position:  0.05820342499651528
Bond Position:  [-17.30707257]


portfolio before change:  [-11.36831748]
curr_Stock_Price:  102.05304614638442
curr_Factors:  [102.05304615]
mat_Sqrt:  [[0.15]]
grads:  [-0.16643293]
Stock Position:  -0.16643292928264372
Bond Position:  [5.61666993]


portfolio before change:  [-11.23866881]
curr_Stock_Price:  101.27617093144418
curr_Factors:  [101.27617093]
mat_Sqrt:  [[0.15]]
grads:  [0.01830432]
Stock Position:  0.018304319918128736
Bond Position:  [-13.09246024]


portfolio before change:  [-11.23669579]
curr_Stock_Price:  101.42866653579115
curr_Factors:  [101.42866654]
mat_Sqrt:  [[0.15]]
grads:  [-0.29466279]
Stock Position:  -0.2946627870610453
Bond Position:  [18.65055778]


portfolio before change:  [-11.17216965]
curr_Stock_Price:  101.21363960087729
curr_Factors:  [101.2136396]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487689]
Stock Position:  -0.014876891919850244
Bond Position:  [-9.66642528]


portfolio before change:  [-11.17717887]
curr_Stock_Price:  101.50973932606713
curr_Factors:  [101.50973933]
mat_Sqrt:  [[0.15]]
grads:  [0.03107999]
Stock Position:  0.031079987877901446
Bond Position:  [-14.33210034]


portfolio before change:  [-11.21292145]
curr_Stock_Price:  100.3885418908948
curr_Factors:  [100.38854189]
mat_Sqrt:  [[0.15]]
grads:  [0.0057484]
Stock Position:  0.00574839705106312
Bond Position:  [-11.78999465]


portfolio before change:  [-11.21458646]
curr_Stock_Price:  100.22708706634258
curr_Factors:  [100.22708707]
mat_Sqrt:  [[0.15]]
grads:  [-0.01214885]
Stock Position:  -0.012148848765276752
Bond Position:  [-9.99694274]


portfolio before change:  [-11.22426265]
curr_Stock_Price:  100.97212550164387
curr_Factors:  [100.9721255]
mat_Sqrt:  [[0.15]]
grads:  [-0.03134846]
Stock Position:  -0.031348455195890204
Bond Position:  [-8.05894249]


portfolio before change:  [-11.22080567]
curr_Stock_Price:  100.84578195319638
curr_Factors:  [100.84578195]
mat_Sqrt:  [[0.15]]
grads:  [0.13514729]
Stock Position:  0.13514729073042067
Bond Position:  [-24.84983988]


portfolio before change:  [-11.19389754]
curr_Stock_Price:  101.05637661347345
curr_Factors:  [101.05637661]
mat_Sqrt:  [[0.15]]
grads:  [0.09364823]
Stock Position:  0.09364823283398752
Bond Position:  [-20.65764862]


portfolio before change:  [-11.20154492]
curr_Stock_Price:  100.98850303774395
curr_Factors:  [100.98850304]
mat_Sqrt:  [[0.15]]
grads:  [0.07190395]
Stock Position:  0.07190394535337705
Bond Position:  [-18.46301672]


portfolio before change:  [-11.19093243]
curr_Stock_Price:  101.15214444212678
curr_Factors:  [101.15214444]
mat_Sqrt:  [[0.15]]
grads:  [0.02122755]
Stock Position:  0.021227551041330835
Bond Position:  [-13.33814474]


portfolio before change:  [-11.18907288]
curr_Stock_Price:  101.27901787155608
curr_Factors:  [101.27901787]
mat_Sqrt:  [[0.15]]
grads:  [0.08298756]
Stock Position:  0.08298755621411243
Bond Position:  [-19.59397107]


portfolio before change:  [-11.20180694]
curr_Stock_Price:  101.1403296011257
curr_Factors:  [101.1403296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00913643]
Stock Position:  -0.009136426351410275
Bond Position:  [-10.27774577]


portfolio before change:  [-11.20991244]
curr_Stock_Price:  101.95718255668461
curr_Factors:  [101.95718256]
mat_Sqrt:  [[0.15]]
grads:  [0.11521399]
Stock Position:  0.11521399262764807
Bond Position:  [-22.95680652]


portfolio before change:  [-11.18082616]
curr_Stock_Price:  102.22209067633577
curr_Factors:  [102.22209068]
mat_Sqrt:  [[0.15]]
grads:  [-0.07545078]
Stock Position:  -0.0754507785147252
Bond Position:  [-3.46808984]


portfolio before change:  [-11.07550722]
curr_Stock_Price:  100.82335489389381
curr_Factors:  [100.82335489]
mat_Sqrt:  [[0.15]]
grads:  [0.01440573]
Stock Position:  0.014405731311959297
Bond Position:  [-12.52794138]


portfolio before change:  [-11.07847439]
curr_Stock_Price:  100.67173807806223
curr_Factors:  [100.67173808]
mat_Sqrt:  [[0.15]]
grads:  [0.01308756]
Stock Position:  0.013087560851422602
Bond Position:  [-12.39602189]


portfolio before change:  [-11.08265623]
curr_Stock_Price:  100.41141015807406
curr_Factors:  [100.41141016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02757614]
Stock Position:  -0.02757613754740465
Bond Position:  [-8.31369737]


portfolio before change:  [-11.08547701]
curr_Stock_Price:  100.49485781017776
curr_Factors:  [100.49485781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02597782]
Stock Position:  -0.02597782044043678
Bond Position:  [-8.47483964]


portfolio before change:  [-11.09530976]
curr_Stock_Price:  100.85297294994893
curr_Factors:  [100.85297295]
mat_Sqrt:  [[0.15]]
grads:  [0.06217544]
Stock Position:  0.06217544343903594
Bond Position:  [-17.36588807]


portfolio before change:  [-11.14551237]
curr_Stock_Price:  100.06299535441691
curr_Factors:  [100.06299535]
mat_Sqrt:  [[0.15]]
grads:  [0.02310513]
Stock Position:  0.02310513269412525
Bond Position:  [-13.45748115]


portfolio before change:  [-11.13051516]
curr_Stock_Price:  100.74848479160762
curr_Factors:  [100.74848479]
mat_Sqrt:  [[0.15]]
grads:  [0.04635863]
Stock Position:  0.046358632099636456
Bond Position:  [-15.8010771]


portfolio before change:  [-11.07676776]
curr_Stock_Price:  101.9291710163994
curr_Factors:  [101.92917102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02651317]
Stock Position:  -0.026513173885768185
Bond Position:  [-8.37430192]


portfolio before change:  [-11.09242718]
curr_Stock_Price:  102.50005728560639
curr_Factors:  [102.50005729]
mat_Sqrt:  [[0.15]]
grads:  [-0.01757399]
Stock Position:  -0.01757398863239941
Bond Position:  [-9.29109234]


portfolio before change:  [-11.09261332]
curr_Stock_Price:  102.47760552198986
curr_Factors:  [102.47760552]
mat_Sqrt:  [[0.15]]
grads:  [0.05397348]
Stock Position:  0.05397347765743798
Bond Position:  [-16.62368607]


portfolio before change:  [-11.10584892]
curr_Stock_Price:  102.25163181175739
curr_Factors:  [102.25163181]
mat_Sqrt:  [[0.15]]
grads:  [-0.10965171]
Stock Position:  -0.10965170626206616
Bond Position:  [0.10621698]


portfolio before change:  [-11.09168524]
curr_Stock_Price:  102.12252266468698
curr_Factors:  [102.12252266]
mat_Sqrt:  [[0.15]]
grads:  [0.03009798]
Stock Position:  0.030097976500780048
Bond Position:  [-14.16536653]


portfolio before change:  [-11.09365157]
curr_Stock_Price:  102.08660774848893
curr_Factors:  [102.08660775]
mat_Sqrt:  [[0.15]]
grads:  [0.17062716]
Stock Position:  0.17062715708653084
Bond Position:  [-28.51239923]


portfolio before change:  [-11.14467326]
curr_Stock_Price:  101.79802760927987
curr_Factors:  [101.79802761]
mat_Sqrt:  [[0.15]]
grads:  [0.0359907]
Stock Position:  0.035990700738082054
Bond Position:  [-14.80845561]


portfolio before change:  [-11.13424118]
curr_Stock_Price:  102.11359920810214
curr_Factors:  [102.11359921]
mat_Sqrt:  [[0.15]]
grads:  [0.09648738]
Stock Position:  0.09648738407483605
Bond Position:  [-20.98691524]


portfolio before change:  [-11.13561103]
curr_Stock_Price:  102.11299673814135
curr_Factors:  [102.11299674]
mat_Sqrt:  [[0.15]]
grads:  [0.03674173]
Stock Position:  0.03674172823041851
Bond Position:  [-14.88741901]


portfolio before change:  [-11.0848495]
curr_Stock_Price:  103.51989913501023
curr_Factors:  [103.51989914]
mat_Sqrt:  [[0.15]]
grads:  [0.04133895]
Stock Position:  0.041338951292408305
Bond Position:  [-15.36425357]


portfolio before change:  [-11.08622281]
curr_Stock_Price:  103.50990807563487
curr_Factors:  [103.50990808]
mat_Sqrt:  [[0.15]]
grads:  [0.08481203]
Stock Position:  0.08481202522788121
Bond Position:  [-19.86510775]


portfolio before change:  [-11.10592767]
curr_Stock_Price:  103.29221198252999
curr_Factors:  [103.29221198]
mat_Sqrt:  [[0.15]]
grads:  [0.00561095]
Stock Position:  0.00561094625647889
Bond Position:  [-11.68549472]


portfolio before change:  [-11.10454747]
curr_Stock_Price:  103.66836272457859
curr_Factors:  [103.66836272]
mat_Sqrt:  [[0.15]]
grads:  [-0.10217459]
Stock Position:  -0.10217459052351299
Bond Position:  [-0.51227496]


portfolio before change:  [-11.09988286]
curr_Stock_Price:  103.6223959662374
curr_Factors:  [103.62239597]
mat_Sqrt:  [[0.15]]
grads:  [-0.03049204]
Stock Position:  -0.030492036870388477
Bond Position:  [-7.94022494]


portfolio before change:  [-11.08905791]
curr_Stock_Price:  103.25111114444569
curr_Factors:  [103.25111114]
mat_Sqrt:  [[0.15]]
grads:  [0.00748139]
Stock Position:  0.007481393565675488
Bond Position:  [-11.8615201]


portfolio before change:  [-11.08612835]
curr_Stock_Price:  103.74178514565874
curr_Factors:  [103.74178515]
mat_Sqrt:  [[0.15]]
grads:  [0.01916136]
Stock Position:  0.019161363023647092
Bond Position:  [-13.07396235]


portfolio before change:  [-11.10046336]
curr_Stock_Price:  103.03630995703894
curr_Factors:  [103.03630996]
mat_Sqrt:  [[0.15]]
grads:  [-0.10833633]
Stock Position:  -0.10833633076115726
Bond Position:  [0.06211239]


portfolio before change:  [-11.1192908]
curr_Stock_Price:  103.21013267467487
curr_Factors:  [103.21013267]
mat_Sqrt:  [[0.15]]
grads:  [-0.02346]
Stock Position:  -0.023460002163721867
Bond Position:  [-8.69798086]


portfolio before change:  [-11.11316516]
curr_Stock_Price:  102.92584967102886
curr_Factors:  [102.92584967]
mat_Sqrt:  [[0.15]]
grads:  [0.08818735]
Stock Position:  0.08818734772284849
Bond Position:  [-20.18992285]


portfolio before change:  [-11.14745968]
curr_Stock_Price:  102.5512765420807
curr_Factors:  [102.55127654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02576953]
Stock Position:  -0.025769526753420088
Bond Position:  [-8.50476181]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.17151471]
Stock Price:  103.46411693775254
PL:  [-14.63563164]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.35900839e-02]
 [ 2.63238706e-02]
 [ 3.58708627e-02]
 [-1.18562547e-02]
 [ 8.33592746e-03]
 [-2.01012215e-02]
 [-1.37721922e-02]
 [ 9.56614188e-02]
 [-2.12444659e-02]
 [-1.36924700e-02]
 [-1.90334369e-03]
 [-5.06475280e-03]
 [ 5.12087404e-04]
 [-1.20865461e-02]
 [ 1.30794420e-02]
 [-4.77310562e-04]
 [-4.16219587e-02]
 [-1.07757539e-02]
 [ 2.31542940e-02]
 [-4.71944310e-03]
 [-2.20284284e-02]
 [ 5.82549791e-03]
 [ 1.38732749e-02]
 [ 1.67689479e-02]
 [ 6.41560389e-03]
 [ 4.41158306e-03]
 [ 4.40546777e-04]
 [ 1.41497036e-02]
 [-1.42162561e-03]
 [ 5.26647434e-02]
 [-7.05473984e-03]
 [ 1.68212777e-02]
 [ 1.15503685e-02]
 [-2.03563510e-02]
 [-8.67714065e-03]
 [ 1.38895959e-02]
 [ 4.66689567e-03]
 [-5.63143570e-04]
 [-3.49446955e-02]
 [-1.74767076e-02]
 [ 7.14153178e-03]
 [ 2.49565049e-02]
 [-2.75300045e-03]
 [ 3.39078540e-03]
 [-9.37093688e-03]
 [ 1.74479649e-02]
 [ 1.01751971e-02]
 [ 5.29504880e-03]
 [-6.78317566e-03]
 [-2.65805261e-04]
 [-3.81339070e-03]
 [ 2.63856685e-04]
 [ 1.85572381e-04]
 [ 8.01314782e-03]
 [-1.08628719e-02]
 [-4.87108835e-03]
 [-1.38810986e-03]
 [ 1.29585503e-02]
 [ 7.11097688e-03]
 [-3.35588898e-03]
 [-5.00226523e-03]
 [-1.13867263e-03]
 [-4.01484555e-03]
 [-1.11818833e-03]
 [ 1.93655996e-02]
 [ 4.03817011e-03]
 [ 1.07263763e-02]
 [-2.99382216e-04]
 [ 2.62886746e-03]
 [ 2.23375668e-02]
 [ 2.67403425e-03]
 [-1.59655749e-02]
 [-6.12916552e-03]
 [ 1.18254852e-03]
 [ 3.10505956e-03]
 [-8.44165278e-04]
 [-1.56557591e-03]
 [ 4.23847745e-03]
 [-2.35082861e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.26913388]
curr_Stock_Price:  99.9200290874439
curr_Factors:  [99.92002909]
mat_Sqrt:  [[0.15]]
grads:  [-0.09060056]
Stock Position:  -0.09060055951030571
Bond Position:  [9.32194442]


portfolio before change:  [0.20972197]
curr_Stock_Price:  100.58221647538032
curr_Factors:  [100.58221648]
mat_Sqrt:  [[0.15]]
grads:  [0.17549247]
Stock Position:  0.17549247083783479
Bond Position:  [-17.44169972]


portfolio before change:  [-0.0877693]
curr_Stock_Price:  98.89324866202105
curr_Factors:  [98.89324866]
mat_Sqrt:  [[0.15]]
grads:  [0.23913908]
Stock Position:  0.2391390846187665
Bond Position:  [-23.73701026]


portfolio before change:  [-0.34676454]
curr_Stock_Price:  97.8164208093156
curr_Factors:  [97.81642081]
mat_Sqrt:  [[0.15]]
grads:  [-0.0790417]
Stock Position:  -0.07904169774179752
Bond Position:  [7.38481143]


portfolio before change:  [-0.26100419]
curr_Stock_Price:  96.73725892544307
curr_Factors:  [96.73725893]
mat_Sqrt:  [[0.15]]
grads:  [0.05557285]
Stock Position:  0.05557284973929493
Bond Position:  [-5.63696934]


portfolio before change:  [-0.280514]
curr_Stock_Price:  96.39253141320334
curr_Factors:  [96.39253141]
mat_Sqrt:  [[0.15]]
grads:  [-0.13400814]
Stock Position:  -0.13400814324565552
Bond Position:  [12.63687016]


portfolio before change:  [-0.339891]
curr_Stock_Price:  96.84151031009628
curr_Factors:  [96.84151031]
mat_Sqrt:  [[0.15]]
grads:  [-0.09181461]
Stock Position:  -0.09181461456368631
Bond Position:  [8.55157494]


portfolio before change:  [-0.29653691]
curr_Stock_Price:  96.37514015284971
curr_Factors:  [96.37514015]
mat_Sqrt:  [[0.15]]
grads:  [0.63774279]
Stock Position:  0.6377427919897604
Bond Position:  [-61.75908787]


portfolio before change:  [-0.38453624]
curr_Stock_Price:  96.24320724047027
curr_Factors:  [96.24320724]
mat_Sqrt:  [[0.15]]
grads:  [-0.14162977]
Stock Position:  -0.14162977235517651
Bond Position:  [13.24636729]


portfolio before change:  [-0.45546818]
curr_Stock_Price:  96.74987943399023
curr_Factors:  [96.74987943]
mat_Sqrt:  [[0.15]]
grads:  [-0.09128313]
Stock Position:  -0.0912831332646339
Bond Position:  [8.37616395]


portfolio before change:  [-0.4727909]
curr_Stock_Price:  96.94538373933285
curr_Factors:  [96.94538374]
mat_Sqrt:  [[0.15]]
grads:  [-0.01268896]
Stock Position:  -0.012688957902622821
Bond Position:  [0.75734499]


portfolio before change:  [-0.47018071]
curr_Stock_Price:  96.74340841821218
curr_Factors:  [96.74340842]
mat_Sqrt:  [[0.15]]
grads:  [-0.03376502]
Stock Position:  -0.03376501866155709
Bond Position:  [2.79636228]


portfolio before change:  [-0.46546173]
curr_Stock_Price:  96.60882524906052
curr_Factors:  [96.60882525]
mat_Sqrt:  [[0.15]]
grads:  [0.00341392]
Stock Position:  0.003413916025031908
Bond Position:  [-0.79527615]


portfolio before change:  [-0.467635]
curr_Stock_Price:  95.98679255260059
curr_Factors:  [95.98679255]
mat_Sqrt:  [[0.15]]
grads:  [-0.08057697]
Stock Position:  -0.0805769738413728
Bond Position:  [7.26669027]


portfolio before change:  [-0.43923641]
curr_Stock_Price:  95.63998865532066
curr_Factors:  [95.63998866]
mat_Sqrt:  [[0.15]]
grads:  [0.08719628]
Stock Position:  0.08719628024629923
Bond Position:  [-8.77868767]


portfolio before change:  [-0.39449364]
curr_Stock_Price:  96.15940822035962
curr_Factors:  [96.15940822]
mat_Sqrt:  [[0.15]]
grads:  [-0.00318207]
Stock Position:  -0.0031820704125598218
Bond Position:  [-0.08850764]


portfolio before change:  [-0.39562103]
curr_Stock_Price:  96.51196454314223
curr_Factors:  [96.51196454]
mat_Sqrt:  [[0.15]]
grads:  [-0.27747972]
Stock Position:  -0.27747972495037
Bond Position:  [26.38449234]


portfolio before change:  [-0.50494885]
curr_Stock_Price:  96.91191049850637
curr_Factors:  [96.9119105]
mat_Sqrt:  [[0.15]]
grads:  [-0.07183836]
Stock Position:  -0.07183835927458022
Bond Position:  [6.4570438]


portfolio before change:  [-0.45740937]
curr_Stock_Price:  96.25577216367321
curr_Factors:  [96.25577216]
mat_Sqrt:  [[0.15]]
grads:  [0.15436196]
Stock Position:  0.15436196010421416
Bond Position:  [-15.31563903]


portfolio before change:  [-0.46396903]
curr_Stock_Price:  96.2194782002226
curr_Factors:  [96.2194782]
mat_Sqrt:  [[0.15]]
grads:  [-0.03146295]
Stock Position:  -0.03146295397264388
Bond Position:  [2.56337998]


portfolio before change:  [-0.47322609]
curr_Stock_Price:  96.5187913232799
curr_Factors:  [96.51879132]
mat_Sqrt:  [[0.15]]
grads:  [-0.14685619]
Stock Position:  -0.14685618906901846
Bond Position:  [13.70115578]


portfolio before change:  [-0.50840401]
curr_Stock_Price:  96.76416245348877
curr_Factors:  [96.76416245]
mat_Sqrt:  [[0.15]]
grads:  [0.03883665]
Stock Position:  0.03883665272890988
Bond Position:  [-4.26640018]


portfolio before change:  [-0.51901551]
curr_Stock_Price:  96.49779435226027
curr_Factors:  [96.49779435]
mat_Sqrt:  [[0.15]]
grads:  [0.0924885]
Stock Position:  0.0924884993215409
Bond Position:  [-9.4439517]


portfolio before change:  [-0.48546224]
curr_Stock_Price:  96.8669595729318
curr_Factors:  [96.86695957]
mat_Sqrt:  [[0.15]]
grads:  [0.11179299]
Stock Position:  0.11179298572223796
Bond Position:  [-11.31450887]


portfolio before change:  [-0.49611502]
curr_Stock_Price:  96.77799518305454
curr_Factors:  [96.77799518]
mat_Sqrt:  [[0.15]]
grads:  [0.04277069]
Stock Position:  0.04277069261600178
Bond Position:  [-4.6353769]


portfolio before change:  [-0.47650369]
curr_Stock_Price:  97.24329140680662
curr_Factors:  [97.24329141]
mat_Sqrt:  [[0.15]]
grads:  [0.02941055]
Stock Position:  0.029410553738181702
Bond Position:  [-3.33648274]


portfolio before change:  [-0.4873896]
curr_Stock_Price:  96.88024573911228
curr_Factors:  [96.88024574]
mat_Sqrt:  [[0.15]]
grads:  [0.00293698]
Stock Position:  0.0029369785107419047
Bond Position:  [-0.7719248]


portfolio before change:  [-0.48867403]
curr_Stock_Price:  96.45934357542954
curr_Factors:  [96.45934358]
mat_Sqrt:  [[0.15]]
grads:  [0.09433136]
Stock Position:  0.09433135707656667
Bond Position:  [-9.58781481]


portfolio before change:  [-0.46973494]
curr_Stock_Price:  96.66646817605938
curr_Factors:  [96.66646818]
mat_Sqrt:  [[0.15]]
grads:  [-0.0094775]
Stock Position:  -0.009477504082742566
Bond Position:  [0.4464219]


portfolio before change:  [-0.46630735]
curr_Stock_Price:  96.30775653803632
curr_Factors:  [96.30775654]
mat_Sqrt:  [[0.15]]
grads:  [0.35109829]
Stock Position:  0.35109828920077363
Bond Position:  [-34.27979591]


portfolio before change:  [-0.14821736]
curr_Stock_Price:  97.21984455456668
curr_Factors:  [97.21984455]
mat_Sqrt:  [[0.15]]
grads:  [-0.0470316]
Stock Position:  -0.0470315989361042
Bond Position:  [4.42418737]


portfolio before change:  [-0.16513134]
curr_Stock_Price:  97.58535400486373
curr_Factors:  [97.585354]
mat_Sqrt:  [[0.15]]
grads:  [0.11214185]
Stock Position:  0.11214185127825939
Bond Position:  [-11.10853359]


portfolio before change:  [-0.1526254]
curr_Stock_Price:  97.70306421584861
curr_Factors:  [97.70306422]
mat_Sqrt:  [[0.15]]
grads:  [0.07700246]
Stock Position:  0.07700245664139192
Bond Position:  [-7.67600137]


portfolio before change:  [-0.1575304]
curr_Stock_Price:  97.6455955256095
curr_Factors:  [97.64559553]
mat_Sqrt:  [[0.15]]
grads:  [-0.13570901]
Stock Position:  -0.13570900654342102
Bond Position:  [13.09385637]


portfolio before change:  [-0.12371012]
curr_Stock_Price:  97.40241428665227
curr_Factors:  [97.40241429]
mat_Sqrt:  [[0.15]]
grads:  [-0.0578476]
Stock Position:  -0.05784760433989379
Bond Position:  [5.5107862]


portfolio before change:  [-0.12491675]
curr_Stock_Price:  97.4292272451801
curr_Factors:  [97.42922725]
mat_Sqrt:  [[0.15]]
grads:  [0.09259731]
Stock Position:  0.09259730574988238
Bond Position:  [-9.1466007]


portfolio before change:  [-0.10035054]
curr_Stock_Price:  97.70070269014839
curr_Factors:  [97.70070269]
mat_Sqrt:  [[0.15]]
grads:  [0.03111264]
Stock Position:  0.031112637794186992
Bond Position:  [-3.14007711]


portfolio before change:  [-0.09903708]
curr_Stock_Price:  97.74922709280581
curr_Factors:  [97.74922709]
mat_Sqrt:  [[0.15]]
grads:  [-0.00375429]
Stock Position:  -0.0037542904677444924
Bond Position:  [0.26794192]


portfolio before change:  [-0.09921682]
curr_Stock_Price:  97.80156545524906
curr_Factors:  [97.80156546]
mat_Sqrt:  [[0.15]]
grads:  [-0.23296464]
Stock Position:  -0.2329646363380053
Bond Position:  [22.68508931]


portfolio before change:  [-0.21177106]
curr_Stock_Price:  98.29079037180229
curr_Factors:  [98.29079037]
mat_Sqrt:  [[0.15]]
grads:  [-0.11651138]
Stock Position:  -0.11651138401842831
Bond Position:  [11.24022496]


portfolio before change:  [-0.18648304]
curr_Stock_Price:  98.07977676550125
curr_Factors:  [98.07977677]
mat_Sqrt:  [[0.15]]
grads:  [0.04761021]
Stock Position:  0.047610211846678595
Bond Position:  [-4.85608199]


portfolio before change:  [-0.17727178]
curr_Stock_Price:  98.27962415219896
curr_Factors:  [98.27962415]
mat_Sqrt:  [[0.15]]
grads:  [0.1663767]
Stock Position:  0.16637669913024544
Bond Position:  [-16.52871124]


portfolio before change:  [-0.17695106]
curr_Stock_Price:  98.28776109721773
curr_Factors:  [98.2877611]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835334]
Stock Position:  -0.018353336310021468
Bond Position:  [1.62695728]


portfolio before change:  [-0.16576275]
curr_Stock_Price:  97.68369564388915
curr_Factors:  [97.68369564]
mat_Sqrt:  [[0.15]]
grads:  [0.02260524]
Stock Position:  0.022605235968086737
Bond Position:  [-2.37392574]


portfolio before change:  [-0.16265595]
curr_Stock_Price:  97.82769683654148
curr_Factors:  [97.82769684]
mat_Sqrt:  [[0.15]]
grads:  [-0.06247291]
Stock Position:  -0.062472912503034744
Bond Position:  [5.9489252]


portfolio before change:  [-0.14618717]
curr_Stock_Price:  97.57003379927005
curr_Factors:  [97.5700338]
mat_Sqrt:  [[0.15]]
grads:  [0.11631977]
Stock Position:  0.11631976626649386
Bond Position:  [-11.49551069]


portfolio before change:  [-0.11977427]
curr_Stock_Price:  97.80328214007115
curr_Factors:  [97.80328214]
mat_Sqrt:  [[0.15]]
grads:  [0.06783465]
Stock Position:  0.067834647390099
Bond Position:  [-6.75422542]


portfolio before change:  [-0.14897174]
curr_Stock_Price:  97.37908418831941
curr_Factors:  [97.37908419]
mat_Sqrt:  [[0.15]]
grads:  [0.03530033]
Stock Position:  0.03530032530778881
Bond Position:  [-3.58648509]


portfolio before change:  [-0.14470097]
curr_Stock_Price:  97.50641813780392
curr_Factors:  [97.50641814]
mat_Sqrt:  [[0.15]]
grads:  [-0.04522117]
Stock Position:  -0.04522117109438527
Bond Position:  [4.26465345]


portfolio before change:  [-0.10981657]
curr_Stock_Price:  96.74089494069273
curr_Factors:  [96.74089494]
mat_Sqrt:  [[0.15]]
grads:  [-0.00177204]
Stock Position:  -0.0017720350741198634
Bond Position:  [0.06161169]


portfolio before change:  [-0.10962567]
curr_Stock_Price:  96.6353401710383
curr_Factors:  [96.63534017]
mat_Sqrt:  [[0.15]]
grads:  [-0.0254226]
Stock Position:  -0.025422604691738942
Bond Position:  [2.34709638]


portfolio before change:  [-0.11836422]
curr_Stock_Price:  96.98484225496459
curr_Factors:  [96.98484225]
mat_Sqrt:  [[0.15]]
grads:  [0.00175904]
Stock Position:  0.0017590445652708917
Bond Position:  [-0.28896488]


portfolio before change:  [-0.11933756]
curr_Stock_Price:  96.44177732819752
curr_Factors:  [96.44177733]
mat_Sqrt:  [[0.15]]
grads:  [0.00123715]
Stock Position:  0.0012371492098542647
Bond Position:  [-0.23865043]


portfolio before change:  [-0.11918244]
curr_Stock_Price:  96.57921781073144
curr_Factors:  [96.57921781]
mat_Sqrt:  [[0.15]]
grads:  [0.05342099]
Stock Position:  0.05342098546785334
Bond Position:  [-5.27853943]


portfolio before change:  [-0.12868325]
curr_Stock_Price:  96.40754574400688
curr_Factors:  [96.40754574]
mat_Sqrt:  [[0.15]]
grads:  [-0.07241915]
Stock Position:  -0.07241914585194005
Bond Position:  [6.85306887]


portfolio before change:  [-0.14113883]
curr_Stock_Price:  96.58545319880537
curr_Factors:  [96.5854532]
mat_Sqrt:  [[0.15]]
grads:  [-0.03247392]
Stock Position:  -0.032473922339330094
Bond Position:  [2.99536968]


portfolio before change:  [-0.13682368]
curr_Stock_Price:  96.45833796950492
curr_Factors:  [96.45833797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00925407]
Stock Position:  -0.009254065724884524
Bond Position:  [0.75580812]


portfolio before change:  [-0.13388866]
curr_Stock_Price:  96.146282734503
curr_Factors:  [96.14628273]
mat_Sqrt:  [[0.15]]
grads:  [0.08639034]
Stock Position:  0.08639033502270518
Bond Position:  [-8.43999824]


portfolio before change:  [-0.13577662]
curr_Stock_Price:  96.1305350887944
curr_Factors:  [96.13053509]
mat_Sqrt:  [[0.15]]
grads:  [0.04740651]
Stock Position:  0.04740651255833963
Bond Position:  [-4.69299004]


portfolio before change:  [-0.09084631]
curr_Stock_Price:  97.08448913166917
curr_Factors:  [97.08448913]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237259]
Stock Position:  -0.022372593177319863
Bond Position:  [2.08118547]


portfolio before change:  [-0.09612159]
curr_Stock_Price:  97.32609534447192
curr_Factors:  [97.32609534]
mat_Sqrt:  [[0.15]]
grads:  [-0.03334843]
Stock Position:  -0.03334843489163872
Bond Position:  [3.14955137]


portfolio before change:  [-0.0833366]
curr_Stock_Price:  96.94862240102806
curr_Factors:  [96.9486224]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759115]
Stock Position:  -0.007591150885955979
Bond Position:  [0.65261502]


portfolio before change:  [-0.08369196]
curr_Stock_Price:  97.00080743318452
curr_Factors:  [97.00080743]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676564]
Stock Position:  -0.026765636982297426
Bond Position:  [2.51259644]


portfolio before change:  [-0.09394369]
curr_Stock_Price:  97.38969302808052
curr_Factors:  [97.38969303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00745459]
Stock Position:  -0.007454588838409815
Bond Position:  [0.63205643]


portfolio before change:  [-0.09484232]
curr_Stock_Price:  97.51554038881781
curr_Factors:  [97.51554039]
mat_Sqrt:  [[0.15]]
grads:  [0.129104]
Stock Position:  0.12910399755575874
Bond Position:  [-12.68448841]


portfolio before change:  [-0.03929651]
curr_Stock_Price:  97.95192202840927
curr_Factors:  [97.95192203]
mat_Sqrt:  [[0.15]]
grads:  [0.02692113]
Stock Position:  0.0269211340812788
Bond Position:  [-2.67627334]


portfolio before change:  [-0.02984584]
curr_Stock_Price:  98.3091858212816
curr_Factors:  [98.30918582]
mat_Sqrt:  [[0.15]]
grads:  [0.07150918]
Stock Position:  0.07150917551082304
Bond Position:  [-7.05985466]


portfolio before change:  [0.00601934]
curr_Stock_Price:  98.8169029579417
curr_Factors:  [98.81690296]
mat_Sqrt:  [[0.15]]
grads:  [-0.00199588]
Stock Position:  -0.0019958814396808452
Bond Position:  [0.20324616]


portfolio before change:  [0.00696834]
curr_Stock_Price:  98.34779060097868
curr_Factors:  [98.3477906]
mat_Sqrt:  [[0.15]]
grads:  [0.01752578]
Stock Position:  0.017525783082004157
Bond Position:  [-1.71665371]


portfolio before change:  [0.00948724]
curr_Stock_Price:  98.4976381859976
curr_Factors:  [98.49763819]
mat_Sqrt:  [[0.15]]
grads:  [0.14891711]
Stock Position:  0.14891711195307833
Bond Position:  [-14.65849657]


portfolio before change:  [0.02065059]
curr_Stock_Price:  98.57875400131832
curr_Factors:  [98.578754]
mat_Sqrt:  [[0.15]]
grads:  [0.01782689]
Stock Position:  0.017826894976310594
Bond Position:  [-1.73670251]


portfolio before change:  [0.03620902]
curr_Stock_Price:  99.45759382939367
curr_Factors:  [99.45759383]
mat_Sqrt:  [[0.15]]
grads:  [-0.10643717]
Stock Position:  -0.1064371659162476
Bond Position:  [10.62219344]


portfolio before change:  [0.06864212]
curr_Stock_Price:  99.15911549828961
curr_Factors:  [99.1591155]
mat_Sqrt:  [[0.15]]
grads:  [-0.0408611]
Stock Position:  -0.04086110347251755
Bond Position:  [4.120393]


portfolio before change:  [0.05655022]
curr_Stock_Price:  99.46134504967095
curr_Factors:  [99.46134505]
mat_Sqrt:  [[0.15]]
grads:  [0.00788366]
Stock Position:  0.007883656774822726
Bond Position:  [-0.72756889]


portfolio before change:  [0.0539253]
curr_Stock_Price:  99.13415554294262
curr_Factors:  [99.13415554]
mat_Sqrt:  [[0.15]]
grads:  [0.0207004]
Stock Position:  0.020700397058147867
Bond Position:  [-1.99819109]


portfolio before change:  [0.05754046]
curr_Stock_Price:  99.31483096408718
curr_Factors:  [99.31483096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00562777]
Stock Position:  -0.0056277685196440795
Bond Position:  [0.61646134]


portfolio before change:  [0.05832083]
curr_Stock_Price:  99.18301317860501
curr_Factors:  [99.18301318]
mat_Sqrt:  [[0.15]]
grads:  [-0.01043717]
Stock Position:  -0.010437172742018738
Bond Position:  [1.09351107]


portfolio before change:  [0.05921472]
curr_Stock_Price:  99.10391693936593
curr_Factors:  [99.10391694]
mat_Sqrt:  [[0.15]]
grads:  [0.02825652]
Stock Position:  0.028256516344888346
Bond Position:  [-2.74111673]


portfolio before change:  [0.03101451]
curr_Stock_Price:  98.11197285226955
curr_Factors:  [98.11197285]
mat_Sqrt:  [[0.15]]
grads:  [-0.15672191]
Stock Position:  -0.15672190712626582
Bond Position:  [15.40731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.01557045]
Stock Price:  98.21666175584353
PL:  [0.01557045]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.36492651e-02]
 [-1.10121651e-02]
 [ 3.14697830e-02]
 [-1.21275578e-02]
 [ 1.10340229e-02]
 [-1.50035409e-02]
 [-2.98914202e-03]
 [ 2.06000023e-02]
 [-2.08404769e-02]
 [-1.30419273e-02]
 [ 7.30520090e-03]
 [-7.25860119e-03]
 [ 9.72595203e-04]
 [ 3.68947176e-03]
 [-2.11973191e-03]
 [ 2.01927792e-03]
 [-2.51788026e-02]
 [-1.12224793e-02]
 [ 2.48578156e-02]
 [ 5.40521211e-04]
 [-4.14167633e-03]
 [ 4.72427232e-03]
 [ 1.49843499e-02]
 [ 1.71870965e-02]
 [-4.11461009e-03]
 [ 4.92233070e-03]
 [-7.56819440e-03]
 [ 8.12042736e-03]
 [ 2.44517872e-02]
 [ 2.88965899e-04]
 [-7.31019451e-03]
 [ 9.99213995e-03]
 [ 1.16581550e-02]
 [-1.10343352e-02]
 [-3.87859040e-03]
 [ 1.88419005e-02]
 [ 6.67146864e-04]
 [ 1.94416242e-03]
 [-3.35256246e-02]
 [-1.69781968e-02]
 [ 7.14665637e-03]
 [ 2.38684923e-02]
 [-1.93011875e-03]
 [-2.82447835e-03]
 [ 1.70642031e-02]
 [ 1.51306999e-02]
 [ 1.06677719e-02]
 [ 4.71439752e-03]
 [ 4.81033386e-03]
 [-1.85764542e-03]
 [-7.24022543e-03]
 [ 2.76525482e-04]
 [ 1.46333785e-03]
 [ 7.18581468e-03]
 [-9.05810102e-03]
 [-4.62265307e-03]
 [-6.39664745e-04]
 [ 1.20071690e-02]
 [ 7.58691881e-03]
 [-3.31252080e-03]
 [-5.13961232e-03]
 [-1.90537773e-03]
 [-1.85865929e-03]
 [-2.47351444e-03]
 [ 1.88327711e-02]
 [ 4.69669967e-03]
 [ 1.86556013e-02]
 [-3.31867280e-03]
 [ 6.47099238e-03]
 [ 2.74310860e-02]
 [ 3.11395521e-03]
 [-1.52946608e-02]
 [-5.76790507e-03]
 [ 1.73933063e-03]
 [ 8.23680260e-03]
 [-5.91416849e-04]
 [-1.46454812e-03]
 [-4.65240889e-03]
 [-2.35402164e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.10016162]
curr_Stock_Price:  99.63074873833702
curr_Factors:  [99.63074874]
mat_Sqrt:  [[0.15]]
grads:  [-0.0909951]
Stock Position:  -0.09099510083928
Bond Position:  [2.96574841]


portfolio before change:  [-6.06509881]
curr_Stock_Price:  99.24745948920128
curr_Factors:  [99.24745949]
mat_Sqrt:  [[0.15]]
grads:  [-0.07341443]
Stock Position:  -0.0734144341299849
Bond Position:  [1.22109727]


portfolio before change:  [-6.04685763]
curr_Stock_Price:  99.0000304121161
curr_Factors:  [99.00003041]
mat_Sqrt:  [[0.15]]
grads:  [0.20979855]
Stock Position:  0.209798553356963
Bond Position:  [-26.81692079]


portfolio before change:  [-6.15071237]
curr_Stock_Price:  98.51299827839829
curr_Factors:  [98.51299828]
mat_Sqrt:  [[0.15]]
grads:  [-0.08085039]
Stock Position:  -0.08085038503706765
Bond Position:  [1.81410147]


portfolio before change:  [-6.10243698]
curr_Stock_Price:  97.91730527551867
curr_Factors:  [97.91730528]
mat_Sqrt:  [[0.15]]
grads:  [0.07356015]
Stock Position:  0.07356015252041345
Bond Position:  [-13.30524889]


portfolio before change:  [-6.06778091]
curr_Stock_Price:  98.39973592940609
curr_Factors:  [98.39973593]
mat_Sqrt:  [[0.15]]
grads:  [-0.10002361]
Stock Position:  -0.10002360598020639
Bond Position:  [3.7745155]


portfolio before change:  [-6.15288247]
curr_Stock_Price:  99.25290925728355
curr_Factors:  [99.25290926]
mat_Sqrt:  [[0.15]]
grads:  [-0.01992761]
Stock Position:  -0.019927613479296474
Bond Position:  [-4.17500886]


portfolio before change:  [-6.14413393]
curr_Stock_Price:  98.80079892043712
curr_Factors:  [98.80079892]
mat_Sqrt:  [[0.15]]
grads:  [0.13733335]
Stock Position:  0.1373333486878103
Bond Position:  [-19.7127785]


portfolio before change:  [-6.24275981]
curr_Stock_Price:  98.09162093216068
curr_Factors:  [98.09162093]
mat_Sqrt:  [[0.15]]
grads:  [-0.13893651]
Stock Position:  -0.13893651249800884
Bond Position:  [7.38574791]


portfolio before change:  [-6.25633767]
curr_Stock_Price:  98.19267057068255
curr_Factors:  [98.19267057]
mat_Sqrt:  [[0.15]]
grads:  [-0.08694618]
Stock Position:  -0.08694618206548342
Bond Position:  [2.28114014]


portfolio before change:  [-6.22107747]
curr_Stock_Price:  97.78876991608622
curr_Factors:  [97.78876992]
mat_Sqrt:  [[0.15]]
grads:  [0.04870134]
Stock Position:  0.048701339361542445
Bond Position:  [-10.98352154]


portfolio before change:  [-6.1855431]
curr_Stock_Price:  98.5325044577966
curr_Factors:  [98.53250446]
mat_Sqrt:  [[0.15]]
grads:  [-0.04839067]
Stock Position:  -0.04839067462409045
Bond Position:  [-1.41748874]


portfolio before change:  [-6.18726945]
curr_Stock_Price:  98.56634897029173
curr_Factors:  [98.56634897]
mat_Sqrt:  [[0.15]]
grads:  [0.00648397]
Stock Position:  0.006483968022738997
Bond Position:  [-6.82637051]


portfolio before change:  [-6.18552953]
curr_Stock_Price:  98.90049370282144
curr_Factors:  [98.9004937]
mat_Sqrt:  [[0.15]]
grads:  [0.02459648]
Stock Position:  0.02459647840211228
Bond Position:  [-8.61813339]


portfolio before change:  [-6.20585642]
curr_Stock_Price:  98.0959783564058
curr_Factors:  [98.09597836]
mat_Sqrt:  [[0.15]]
grads:  [-0.01413155]
Stock Position:  -0.014131546086259909
Bond Position:  [-4.81960859]


portfolio before change:  [-6.19194192]
curr_Stock_Price:  97.09002015457189
curr_Factors:  [97.09002015]
mat_Sqrt:  [[0.15]]
grads:  [0.01346185]
Stock Position:  0.013461852821802015
Bond Position:  [-7.49895348]


portfolio before change:  [-6.18626075]
curr_Stock_Price:  97.54685632673205
curr_Factors:  [97.54685633]
mat_Sqrt:  [[0.15]]
grads:  [-0.16785868]
Stock Position:  -0.1678586842627827
Bond Position:  [10.1878262]


portfolio before change:  [-6.12302546]
curr_Stock_Price:  97.17393233309062
curr_Factors:  [97.17393233]
mat_Sqrt:  [[0.15]]
grads:  [-0.07481653]
Stock Position:  -0.07481652866046884
Bond Position:  [1.14719083]


portfolio before change:  [-6.17173914]
curr_Stock_Price:  97.8259991345814
curr_Factors:  [97.82599913]
mat_Sqrt:  [[0.15]]
grads:  [0.16571877]
Stock Position:  0.16571877087195983
Bond Position:  [-22.38334347]


portfolio before change:  [-6.00122517]
curr_Stock_Price:  98.86337688557364
curr_Factors:  [98.86337689]
mat_Sqrt:  [[0.15]]
grads:  [0.00360347]
Stock Position:  0.0036034747425584468
Bond Position:  [-6.35747685]


portfolio before change:  [-6.00011101]
curr_Stock_Price:  99.2828379172518
curr_Factors:  [99.28283792]
mat_Sqrt:  [[0.15]]
grads:  [-0.02761118]
Stock Position:  -0.027611175531185493
Bond Position:  [-3.25879515]


portfolio before change:  [-6.00783383]
curr_Stock_Price:  99.55516005814128
curr_Factors:  [99.55516006]
mat_Sqrt:  [[0.15]]
grads:  [0.03149515]
Stock Position:  0.03149514878932979
Bond Position:  [-9.1433384]


portfolio before change:  [-5.98703367]
curr_Stock_Price:  100.23372909716998
curr_Factors:  [100.2337291]
mat_Sqrt:  [[0.15]]
grads:  [0.09989567]
Stock Position:  0.09989566576232872
Bond Position:  [-15.99994877]


portfolio before change:  [-5.98681669]
curr_Stock_Price:  100.24591189156052
curr_Factors:  [100.24591189]
mat_Sqrt:  [[0.15]]
grads:  [0.11458064]
Stock Position:  0.11458064333804877
Bond Position:  [-17.47305777]


portfolio before change:  [-5.97475929]
curr_Stock_Price:  100.36067387360724
curr_Factors:  [100.36067387]
mat_Sqrt:  [[0.15]]
grads:  [-0.02743073]
Stock Position:  -0.027430733904428708
Bond Position:  [-3.22179235]


portfolio before change:  [-5.97170528]
curr_Stock_Price:  100.24199761603526
curr_Factors:  [100.24199762]
mat_Sqrt:  [[0.15]]
grads:  [0.03281554]
Stock Position:  0.03281553798140904
Bond Position:  [-9.26120036]


portfolio before change:  [-5.9530404]
curr_Stock_Price:  100.82841872991906
curr_Factors:  [100.82841873]
mat_Sqrt:  [[0.15]]
grads:  [-0.05045463]
Stock Position:  -0.05045462935255356
Bond Position:  [-0.8657799]


portfolio before change:  [-5.90488331]
curr_Stock_Price:  99.87288295673464
curr_Factors:  [99.87288296]
mat_Sqrt:  [[0.15]]
grads:  [0.05413618]
Stock Position:  0.05413618237426951
Bond Position:  [-11.31161991]


portfolio before change:  [-5.89601539]
curr_Stock_Price:  100.04975012124694
curr_Factors:  [100.04975012]
mat_Sqrt:  [[0.15]]
grads:  [0.16301191]
Stock Position:  0.16301191457569322
Bond Position:  [-22.20531671]


portfolio before change:  [-5.90397629]
curr_Stock_Price:  100.00942777351248
curr_Factors:  [100.00942777]
mat_Sqrt:  [[0.15]]
grads:  [0.00192644]
Stock Position:  0.0019264393286714625
Bond Position:  [-6.09663839]


portfolio before change:  [-5.90464119]
curr_Stock_Price:  99.8620842000544
curr_Factors:  [99.8620842]
mat_Sqrt:  [[0.15]]
grads:  [-0.04873463]
Stock Position:  -0.04873463007430487
Bond Position:  [-1.03789946]


portfolio before change:  [-5.89318647]
curr_Stock_Price:  99.62571040318007
curr_Factors:  [99.6257104]
mat_Sqrt:  [[0.15]]
grads:  [0.06661427]
Stock Position:  0.06661426636289804
Bond Position:  [-12.52968008]


portfolio before change:  [-5.9133309]
curr_Stock_Price:  99.33506256150885
curr_Factors:  [99.33506256]
mat_Sqrt:  [[0.15]]
grads:  [0.07772103]
Stock Position:  0.0777210335369769
Bond Position:  [-13.63375462]


portfolio before change:  [-5.92095989]
curr_Stock_Price:  99.24786790899522
curr_Factors:  [99.24786791]
mat_Sqrt:  [[0.15]]
grads:  [-0.07356223]
Stock Position:  -0.0735622349168841
Bond Position:  [1.37993508]


portfolio before change:  [-5.84880729]
curr_Stock_Price:  98.26820280579147
curr_Factors:  [98.26820281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02585727]
Stock Position:  -0.025857269305887207
Bond Position:  [-3.3078599]


portfolio before change:  [-5.87103655]
curr_Stock_Price:  99.1198980745218
curr_Factors:  [99.11989807]
mat_Sqrt:  [[0.15]]
grads:  [0.12561267]
Stock Position:  0.1256126703098366
Bond Position:  [-18.32175163]


portfolio before change:  [-5.86673335]
curr_Stock_Price:  99.1632722164708
curr_Factors:  [99.16327222]
mat_Sqrt:  [[0.15]]
grads:  [0.00444765]
Stock Position:  0.00444764575689678
Bond Position:  [-6.30777646]


portfolio before change:  [-5.86908285]
curr_Stock_Price:  98.72365751948276
curr_Factors:  [98.72365752]
mat_Sqrt:  [[0.15]]
grads:  [0.01296108]
Stock Position:  0.01296108281570831
Bond Position:  [-7.14864835]


portfolio before change:  [-5.86995644]
curr_Stock_Price:  98.69072947066431
curr_Factors:  [98.69072947]
mat_Sqrt:  [[0.15]]
grads:  [-0.22350416]
Stock Position:  -0.22350416368642925
Bond Position:  [16.18783252]


portfolio before change:  [-5.76077104]
curr_Stock_Price:  98.20674015287422
curr_Factors:  [98.20674015]
mat_Sqrt:  [[0.15]]
grads:  [-0.11318798]
Stock Position:  -0.1131879785506845
Bond Position:  [5.35505136]


portfolio before change:  [-5.75842252]
curr_Stock_Price:  98.18894831963149
curr_Factors:  [98.18894832]
mat_Sqrt:  [[0.15]]
grads:  [0.04764438]
Stock Position:  0.04764437577883601
Bond Position:  [-10.43657367]


portfolio before change:  [-5.74840786]
curr_Stock_Price:  98.41283539345375
curr_Factors:  [98.41283539]
mat_Sqrt:  [[0.15]]
grads:  [0.15912328]
Stock Position:  0.15912328223836997
Bond Position:  [-21.40818125]


portfolio before change:  [-5.60468246]
curr_Stock_Price:  99.32447731732422
curr_Factors:  [99.32447732]
mat_Sqrt:  [[0.15]]
grads:  [-0.01286746]
Stock Position:  -0.01286745835049365
Bond Position:  [-4.32662889]


portfolio before change:  [-5.61177886]
curr_Stock_Price:  99.85496070003731
curr_Factors:  [99.8549607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01882986]
Stock Position:  -0.01882985564248777
Bond Position:  [-3.73152436]


portfolio before change:  [-5.60365158]
curr_Stock_Price:  99.41095798389276
curr_Factors:  [99.41095798]
mat_Sqrt:  [[0.15]]
grads:  [0.11376135]
Stock Position:  0.11376135432949129
Bond Position:  [-16.91277679]


portfolio before change:  [-5.61329192]
curr_Stock_Price:  99.33550826832999
curr_Factors:  [99.33550827]
mat_Sqrt:  [[0.15]]
grads:  [0.10087133]
Stock Position:  0.1008713327087094
Bond Position:  [-15.63339703]


portfolio before change:  [-5.65046084]
curr_Stock_Price:  98.97671657048537
curr_Factors:  [98.97671657]
mat_Sqrt:  [[0.15]]
grads:  [0.07111848]
Stock Position:  0.07111847913405528
Bond Position:  [-12.68953439]


portfolio before change:  [-5.63565722]
curr_Stock_Price:  99.19602296768933
curr_Factors:  [99.19602297]
mat_Sqrt:  [[0.15]]
grads:  [0.03142932]
Stock Position:  0.03142931679776406
Bond Position:  [-8.75332045]


portfolio before change:  [-5.6317265]
curr_Stock_Price:  99.33849558320944
curr_Factors:  [99.33849558]
mat_Sqrt:  [[0.15]]
grads:  [0.03206889]
Stock Position:  0.03206889242330905
Bond Position:  [-8.81740203]


portfolio before change:  [-5.64805921]
curr_Stock_Price:  98.84638008580332
curr_Factors:  [98.84638009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0123843]
Stock Position:  -0.012384302770919904
Bond Position:  [-4.42391571]


portfolio before change:  [-5.64899427]
curr_Stock_Price:  98.89955701575957
curr_Factors:  [98.89955702]
mat_Sqrt:  [[0.15]]
grads:  [-0.04826817]
Stock Position:  -0.04826816955446868
Bond Position:  [-0.87529368]


portfolio before change:  [-5.63747525]
curr_Stock_Price:  98.65977726331951
curr_Factors:  [98.65977726]
mat_Sqrt:  [[0.15]]
grads:  [0.0018435]
Stock Position:  0.0018435032103436093
Bond Position:  [-5.81935486]


portfolio before change:  [-5.63748676]
curr_Stock_Price:  98.85082895910978
curr_Factors:  [98.85082896]
mat_Sqrt:  [[0.15]]
grads:  [0.00975559]
Stock Position:  0.009755585646431324
Bond Position:  [-6.60183449]


portfolio before change:  [-5.64582831]
curr_Stock_Price:  98.03807196371896
curr_Factors:  [98.03807196]
mat_Sqrt:  [[0.15]]
grads:  [0.04790543]
Stock Position:  0.047905431180020344
Bond Position:  [-10.34238442]


portfolio before change:  [-5.66416144]
curr_Stock_Price:  97.66887150493346
curr_Factors:  [97.6688715]
mat_Sqrt:  [[0.15]]
grads:  [-0.06038734]
Stock Position:  -0.06038734013258334
Bond Position:  [0.23380193]


portfolio before change:  [-5.66931639]
curr_Stock_Price:  97.75447832628119
curr_Factors:  [97.75447833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03081769]
Stock Position:  -0.030817687124120974
Bond Position:  [-2.65674946]


portfolio before change:  [-5.66658485]
curr_Stock_Price:  97.66045460174495
curr_Factors:  [97.6604546]
mat_Sqrt:  [[0.15]]
grads:  [-0.00426443]
Stock Position:  -0.00426443163385183
Bond Position:  [-5.25011852]


portfolio before change:  [-5.66734059]
curr_Stock_Price:  97.76072443648181
curr_Factors:  [97.76072444]
mat_Sqrt:  [[0.15]]
grads:  [0.08004779]
Stock Position:  0.08004779312809289
Bond Position:  [-13.49287083]


portfolio before change:  [-5.76064921]
curr_Stock_Price:  96.60559842736569
curr_Factors:  [96.60559843]
mat_Sqrt:  [[0.15]]
grads:  [0.05057946]
Stock Position:  0.05057945873180851
Bond Position:  [-10.64690808]


portfolio before change:  [-5.74217351]
curr_Stock_Price:  96.98403558543775
curr_Factors:  [96.98403559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02208347]
Stock Position:  -0.022083471996561337
Bond Position:  [-3.60042928]


portfolio before change:  [-5.73437304]
curr_Stock_Price:  96.62061861242003
curr_Factors:  [96.62061861]
mat_Sqrt:  [[0.15]]
grads:  [-0.03426408]
Stock Position:  -0.03426408210327302
Bond Position:  [-2.42375623]


portfolio before change:  [-5.71602248]
curr_Stock_Price:  96.0806348474905
curr_Factors:  [96.08063485]
mat_Sqrt:  [[0.15]]
grads:  [-0.01270252]
Stock Position:  -0.012702518217778559
Bond Position:  [-4.49555646]


portfolio before change:  [-5.71194887]
curr_Stock_Price:  95.73782196913417
curr_Factors:  [95.73782197]
mat_Sqrt:  [[0.15]]
grads:  [-0.01239106]
Stock Position:  -0.012391061901808609
Bond Position:  [-4.52565559]


portfolio before change:  [-5.72367646]
curr_Stock_Price:  96.66144921666513
curr_Factors:  [96.66144922]
mat_Sqrt:  [[0.15]]
grads:  [-0.0164901]
Stock Position:  -0.01649009629138955
Bond Position:  [-4.12971985]


portfolio before change:  [-5.71903567]
curr_Stock_Price:  96.36436749437415
curr_Factors:  [96.36436749]
mat_Sqrt:  [[0.15]]
grads:  [0.12555181]
Stock Position:  0.12555180742802194
Bond Position:  [-17.81775618]


portfolio before change:  [-5.6583096]
curr_Stock_Price:  96.85691085158788
curr_Factors:  [96.85691085]
mat_Sqrt:  [[0.15]]
grads:  [0.03131133]
Stock Position:  0.031311331142214585
Bond Position:  [-8.69102841]


portfolio before change:  [-5.68221938]
curr_Stock_Price:  96.11064518270213
curr_Factors:  [96.11064518]
mat_Sqrt:  [[0.15]]
grads:  [0.12437068]
Stock Position:  0.12437067566267743
Bond Position:  [-17.63556526]


portfolio before change:  [-5.75049862]
curr_Stock_Price:  95.5705099773124
curr_Factors:  [95.57050998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02212449]
Stock Position:  -0.022124485333204144
Bond Position:  [-3.63605027]


portfolio before change:  [-5.75091601]
curr_Stock_Price:  95.57910366304199
curr_Factors:  [95.57910366]
mat_Sqrt:  [[0.15]]
grads:  [0.04313995]
Stock Position:  0.04313994920612497
Bond Position:  [-9.87419369]


portfolio before change:  [-5.77090019]
curr_Stock_Price:  95.13016884217788
curr_Factors:  [95.13016884]
mat_Sqrt:  [[0.15]]
grads:  [0.18287391]
Stock Position:  0.18287390669120912
Bond Position:  [-23.16772581]


portfolio before change:  [-5.74384876]
curr_Stock_Price:  95.28601096614418
curr_Factors:  [95.28601097]
mat_Sqrt:  [[0.15]]
grads:  [0.0207597]
Stock Position:  0.020759701387756298
Bond Position:  [-7.72195789]


portfolio before change:  [-5.73922643]
curr_Stock_Price:  95.5319187322963
curr_Factors:  [95.53191873]
mat_Sqrt:  [[0.15]]
grads:  [-0.10196441]
Stock Position:  -0.10196440538946579
Bond Position:  [4.00162886]


portfolio before change:  [-5.84534087]
curr_Stock_Price:  96.57507251709671
curr_Factors:  [96.57507252]
mat_Sqrt:  [[0.15]]
grads:  [-0.0384527]
Stock Position:  -0.03845270045337625
Bond Position:  [-2.13176854]


portfolio before change:  [-5.85376527]
curr_Stock_Price:  96.79069213069717
curr_Factors:  [96.79069213]
mat_Sqrt:  [[0.15]]
grads:  [0.01159554]
Stock Position:  0.01159553751606734
Bond Position:  [-6.97610537]


portfolio before change:  [-5.84183877]
curr_Stock_Price:  97.85683678908153
curr_Factors:  [97.85683679]
mat_Sqrt:  [[0.15]]
grads:  [0.05491202]
Stock Position:  0.05491201734735503
Bond Position:  [-11.21535509]


portfolio before change:  [-5.78562086]
curr_Stock_Price:  98.89338392518685
curr_Factors:  [98.89338393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00394278]
Stock Position:  -0.0039427789920290675
Bond Position:  [-5.3957061]


portfolio before change:  [-5.78365696]
curr_Stock_Price:  98.30975071071386
curr_Factors:  [98.30975071]
mat_Sqrt:  [[0.15]]
grads:  [-0.00976365]
Stock Position:  -0.00976365413761566
Bond Position:  [-4.82379456]


portfolio before change:  [-5.77837048]
curr_Stock_Price:  97.73742685708058
curr_Factors:  [97.73742686]
mat_Sqrt:  [[0.15]]
grads:  [-0.03101606]
Stock Position:  -0.03101605926075632
Bond Position:  [-2.74694066]


portfolio before change:  [-5.79145836]
curr_Stock_Price:  98.15386219555221
curr_Factors:  [98.1538622]
mat_Sqrt:  [[0.15]]
grads:  [-0.15693478]
Stock Position:  -0.1569347758235068
Bond Position:  [9.612296]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.65314657]
Stock Price:  97.27635749621068
PL:  [-5.65314657]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-7.47765484e-03]
 [ 7.81785082e-03]
 [ 1.23507376e-02]
 [-8.73462408e-03]
 [ 1.23763829e-02]
 [-1.35578794e-02]
 [-2.74508667e-03]
 [ 1.10838229e-02]
 [-1.59721041e-02]
 [-8.08274658e-03]
 [ 1.36757679e-02]
 [-7.84576720e-03]
 [-1.09807211e-03]
 [ 7.86848600e-03]
 [-9.31672764e-04]
 [ 1.36332229e-02]
 [ 5.28622566e-02]
 [-1.41637776e-02]
 [ 1.94538258e-02]
 [ 2.37376080e-03]
 [-3.74463116e-03]
 [ 4.57368313e-03]
 [ 1.82319784e-02]
 [ 1.76310550e-02]
 [-6.06545907e-03]
 [ 4.60167534e-03]
 [ 5.00300031e-03]
 [ 8.18139776e-03]
 [ 3.09739785e-02]
 [ 2.18204503e-04]
 [-5.59466881e-03]
 [ 1.13925616e-02]
 [ 1.18819918e-02]
 [-1.00539774e-02]
 [ 6.16212190e-03]
 [ 1.93428151e-02]
 [-2.67065165e-03]
 [ 2.62859091e-03]
 [-5.79367695e-02]
 [-1.32395018e-02]
 [ 7.17534341e-03]
 [ 1.04601728e-02]
 [-1.60181155e-03]
 [-1.01741782e-03]
 [ 1.97451590e-02]
 [ 1.54304727e-02]
 [ 1.08330330e-02]
 [ 3.53921565e-03]
 [ 1.08477119e-02]
 [-1.73845785e-03]
 [ 1.48047008e-02]
 [-1.71241931e-02]
 [ 1.79509657e-03]
 [-2.52043850e-03]
 [-3.59049149e-03]
 [-3.34086072e-03]
 [ 1.08042794e-02]
 [-1.31471860e-02]
 [ 3.94757868e-03]
 [-3.56333556e-03]
 [-4.69424171e-03]
 [ 5.39682298e-03]
 [-1.96174934e-02]
 [ 3.24191452e-03]
 [ 2.20488058e-02]
 [ 9.57669337e-03]
 [ 1.10155947e-02]
 [ 1.05451540e-02]
 [ 7.02746698e-03]
 [ 1.10596913e-02]
 [ 3.93958585e-03]
 [-1.50220839e-02]
 [-2.15098757e-02]
 [ 7.82289667e-04]
 [-1.95108258e-03]
 [-2.11295356e-02]
 [-4.34855582e-03]
 [ 1.38300449e-02]
 [ 2.70000418e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.99884442]
curr_Stock_Price:  100.1348428476655
curr_Factors:  [100.13484285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985103]
Stock Position:  -0.04985103227751775
Bond Position:  [9.9906697]


portfolio before change:  [5.01295492]
curr_Stock_Price:  99.86431564253805
curr_Factors:  [99.86431564]
mat_Sqrt:  [[0.15]]
grads:  [0.05211901]
Stock Position:  0.05211900544173265
Bond Position:  [-0.19187389]


portfolio before change:  [5.03816221]
curr_Stock_Price:  100.34819444984575
curr_Factors:  [100.34819445]
mat_Sqrt:  [[0.15]]
grads:  [0.08233825]
Stock Position:  0.08233825040533872
Bond Position:  [-3.22433256]


portfolio before change:  [4.96183309]
curr_Stock_Price:  99.42362311736238
curr_Factors:  [99.42362312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05823083]
Stock Position:  -0.05823082720752877
Bond Position:  [10.75135291]


portfolio before change:  [4.97165049]
curr_Stock_Price:  99.26656862880452
curr_Factors:  [99.26656863]
mat_Sqrt:  [[0.15]]
grads:  [0.08250922]
Stock Position:  0.08250921914598916
Bond Position:  [-3.21875658]


portfolio before change:  [4.96577192]
curr_Stock_Price:  99.19775949541696
curr_Factors:  [99.1977595]
mat_Sqrt:  [[0.15]]
grads:  [-0.09038586]
Stock Position:  -0.09038586252771111
Bond Position:  [13.93184697]


portfolio before change:  [4.96037088]
curr_Stock_Price:  99.2671487725873
curr_Factors:  [99.26714877]
mat_Sqrt:  [[0.15]]
grads:  [-0.01830058]
Stock Position:  -0.018300577817926093
Bond Position:  [6.77701706]


portfolio before change:  [4.96471959]
curr_Stock_Price:  99.05266719203607
curr_Factors:  [99.05266719]
mat_Sqrt:  [[0.15]]
grads:  [0.07389215]
Stock Position:  0.07389215265619536
Bond Position:  [-2.35449521]


portfolio before change:  [4.96422154]
curr_Stock_Price:  99.04791855603476
curr_Factors:  [99.04791856]
mat_Sqrt:  [[0.15]]
grads:  [-0.10648069]
Stock Position:  -0.10648069384847934
Bond Position:  [15.51091264]


portfolio before change:  [4.92196917]
curr_Stock_Price:  99.45383094975
curr_Factors:  [99.45383095]
mat_Sqrt:  [[0.15]]
grads:  [-0.05388498]
Stock Position:  -0.05388497717876679
Bond Position:  [10.28103658]


portfolio before change:  [4.8933953]
curr_Stock_Price:  99.99603139352496
curr_Factors:  [99.99603139]
mat_Sqrt:  [[0.15]]
grads:  [0.09117179]
Stock Position:  0.0911717857481503
Bond Position:  [-4.22342145]


portfolio before change:  [4.79293309]
curr_Stock_Price:  98.89702651493832
curr_Factors:  [98.89702651]
mat_Sqrt:  [[0.15]]
grads:  [-0.05230511]
Stock Position:  -0.05230511468904514
Bond Position:  [9.9657534]


portfolio before change:  [4.75852166]
curr_Stock_Price:  99.56683317133361
curr_Factors:  [99.56683317]
mat_Sqrt:  [[0.15]]
grads:  [-0.00732048]
Stock Position:  -0.007320480703581211
Bond Position:  [5.48739874]


portfolio before change:  [4.75876668]
curr_Stock_Price:  99.58021389102805
curr_Factors:  [99.58021389]
mat_Sqrt:  [[0.15]]
grads:  [0.05245657]
Stock Position:  0.0524565733426472
Bond Position:  [-0.46487012]


portfolio before change:  [4.78216957]
curr_Stock_Price:  100.02690632603644
curr_Factors:  [100.02690633]
mat_Sqrt:  [[0.15]]
grads:  [-0.00621115]
Stock Position:  -0.006211151759179535
Bond Position:  [5.40345187]


portfolio before change:  [4.78125821]
curr_Stock_Price:  100.22801022529575
curr_Factors:  [100.22801023]
mat_Sqrt:  [[0.15]]
grads:  [0.09088815]
Stock Position:  0.09088815240313225
Bond Position:  [-4.32828045]


portfolio before change:  [4.84267953]
curr_Stock_Price:  100.90677683056302
curr_Factors:  [100.90677683]
mat_Sqrt:  [[0.15]]
grads:  [0.35241504]
Stock Position:  0.35241504373433047
Bond Position:  [-30.71838664]


portfolio before change:  [4.92968152]
curr_Stock_Price:  101.15909849861258
curr_Factors:  [101.1590985]
mat_Sqrt:  [[0.15]]
grads:  [-0.09442518]
Stock Position:  -0.09442518391765442
Bond Position:  [14.481648]


portfolio before change:  [5.00748344]
curr_Stock_Price:  100.34473116420381
curr_Factors:  [100.34473116]
mat_Sqrt:  [[0.15]]
grads:  [0.12969217]
Stock Position:  0.12969217168789443
Bond Position:  [-8.00644266]


portfolio before change:  [4.93344914]
curr_Stock_Price:  99.77774334667691
curr_Factors:  [99.77774335]
mat_Sqrt:  [[0.15]]
grads:  [0.01582507]
Stock Position:  0.015825071987986397
Bond Position:  [3.35445917]


portfolio before change:  [4.92989083]
curr_Stock_Price:  99.53964227464324
curr_Factors:  [99.53964227]
mat_Sqrt:  [[0.15]]
grads:  [-0.02496421]
Stock Position:  -0.024964207721612213
Bond Position:  [7.41481914]


portfolio before change:  [4.92623729]
curr_Stock_Price:  99.70455776697104
curr_Factors:  [99.70455777]
mat_Sqrt:  [[0.15]]
grads:  [0.03049122]
Stock Position:  0.030491220888154612
Bond Position:  [1.8861236]


portfolio before change:  [4.91799471]
curr_Stock_Price:  99.43036521575969
curr_Factors:  [99.43036522]
mat_Sqrt:  [[0.15]]
grads:  [0.12154652]
Stock Position:  0.12154652298350777
Bond Position:  [-7.16742046]


portfolio before change:  [5.04587499]
curr_Stock_Price:  100.48616061344295
curr_Factors:  [100.48616061]
mat_Sqrt:  [[0.15]]
grads:  [0.11754037]
Stock Position:  0.11754036680468641
Bond Position:  [-6.76530519]


portfolio before change:  [4.92463064]
curr_Stock_Price:  99.45824558170061
curr_Factors:  [99.45824558]
mat_Sqrt:  [[0.15]]
grads:  [-0.04043639]
Stock Position:  -0.04043639378469945
Bond Position:  [8.94636342]


portfolio before change:  [4.96503834]
curr_Stock_Price:  98.47278331302888
curr_Factors:  [98.47278331]
mat_Sqrt:  [[0.15]]
grads:  [0.03067784]
Stock Position:  0.030677835588715133
Bond Position:  [1.94410649]


portfolio before change:  [4.99498356]
curr_Stock_Price:  99.44494137574974
curr_Factors:  [99.44494138]
mat_Sqrt:  [[0.15]]
grads:  [0.03335334]
Stock Position:  0.03335333540316141
Bond Position:  [1.67816307]


portfolio before change:  [5.00901076]
curr_Stock_Price:  99.8623603289696
curr_Factors:  [99.86236033]
mat_Sqrt:  [[0.15]]
grads:  [0.05454265]
Stock Position:  0.05454265172805903
Bond Position:  [-0.43774718]


portfolio before change:  [5.04625086]
curr_Stock_Price:  100.54563213168335
curr_Factors:  [100.54563213]
mat_Sqrt:  [[0.15]]
grads:  [0.20649319]
Stock Position:  0.20649318971712988
Bond Position:  [-15.71573743]


portfolio before change:  [5.22703127]
curr_Stock_Price:  101.42586784916256
curr_Factors:  [101.42586785]
mat_Sqrt:  [[0.15]]
grads:  [0.0014547]
Stock Position:  0.001454696687895815
Bond Position:  [5.0794874]


portfolio before change:  [5.22697381]
curr_Stock_Price:  101.16812057867217
curr_Factors:  [101.16812058]
mat_Sqrt:  [[0.15]]
grads:  [-0.03729779]
Stock Position:  -0.03729779207746825
Bond Position:  [9.00032133]


portfolio before change:  [5.23406625]
curr_Stock_Price:  100.99304566696806
curr_Factors:  [100.99304567]
mat_Sqrt:  [[0.15]]
grads:  [0.07595041]
Stock Position:  0.07595041075845471
Bond Position:  [-2.43639705]


portfolio before change:  [5.12935786]
curr_Stock_Price:  99.6164091290472
curr_Factors:  [99.61640913]
mat_Sqrt:  [[0.15]]
grads:  [0.07921328]
Stock Position:  0.07921327869881081
Bond Position:  [-2.76158452]


portfolio before change:  [5.10698735]
curr_Stock_Price:  99.33617949473906
curr_Factors:  [99.33617949]
mat_Sqrt:  [[0.15]]
grads:  [-0.06702652]
Stock Position:  -0.06702651626260601
Bond Position:  [11.7651454]


portfolio before change:  [5.04625992]
curr_Stock_Price:  100.25317136273205
curr_Factors:  [100.25317136]
mat_Sqrt:  [[0.15]]
grads:  [0.04108081]
Stock Position:  0.041080812649797384
Bond Position:  [0.92777817]


portfolio before change:  [5.00907914]
curr_Stock_Price:  99.34669528010093
curr_Factors:  [99.34669528]
mat_Sqrt:  [[0.15]]
grads:  [0.1289521]
Stock Position:  0.12895210095029577
Bond Position:  [-7.80188594]


portfolio before change:  [5.00730343]
curr_Stock_Price:  99.33670651633685
curr_Factors:  [99.33670652]
mat_Sqrt:  [[0.15]]
grads:  [-0.01780434]
Stock Position:  -0.017804344305279402
Bond Position:  [6.77592836]


portfolio before change:  [5.0113251]
curr_Stock_Price:  99.13461239829525
curr_Factors:  [99.1346124]
mat_Sqrt:  [[0.15]]
grads:  [0.01752394]
Stock Position:  0.017523939398690614
Bond Position:  [3.27409616]


portfolio before change:  [5.02028302]
curr_Stock_Price:  99.63411666865919
curr_Factors:  [99.63411667]
mat_Sqrt:  [[0.15]]
grads:  [-0.38624513]
Stock Position:  -0.38624513029586516
Bond Position:  [43.50347539]


portfolio before change:  [5.13951861]
curr_Stock_Price:  99.33245191764745
curr_Factors:  [99.33245192]
mat_Sqrt:  [[0.15]]
grads:  [-0.08826335]
Stock Position:  -0.08826334559251567
Bond Position:  [13.90693314]


portfolio before change:  [5.18573479]
curr_Stock_Price:  98.81868296926058
curr_Factors:  [98.81868297]
mat_Sqrt:  [[0.15]]
grads:  [0.04783562]
Stock Position:  0.047835622733205255
Bond Position:  [0.45868155]


portfolio before change:  [5.19811512]
curr_Stock_Price:  99.07689365774185
curr_Factors:  [99.07689366]
mat_Sqrt:  [[0.15]]
grads:  [0.06973449]
Stock Position:  0.06973448540322681
Bond Position:  [-1.71096107]


portfolio before change:  [5.24287363]
curr_Stock_Price:  99.72026900688236
curr_Factors:  [99.72026901]
mat_Sqrt:  [[0.15]]
grads:  [-0.01067874]
Stock Position:  -0.010678743694922877
Bond Position:  [6.30776083]


portfolio before change:  [5.24995978]
curr_Stock_Price:  99.0936126815267
curr_Factors:  [99.09361268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00678279]
Stock Position:  -0.006782785498524851
Bond Position:  [5.9220905]


portfolio before change:  [5.24691095]
curr_Stock_Price:  99.59767913892223
curr_Factors:  [99.59767914]
mat_Sqrt:  [[0.15]]
grads:  [0.13163439]
Stock Position:  0.1316343931953434
Bond Position:  [-7.86356911]


portfolio before change:  [5.25707067]
curr_Stock_Price:  99.67859425566257
curr_Factors:  [99.67859426]
mat_Sqrt:  [[0.15]]
grads:  [0.10286982]
Stock Position:  0.10286981809600193
Bond Position:  [-4.99684818]


portfolio before change:  [5.29174487]
curr_Stock_Price:  100.01869897849663
curr_Factors:  [100.01869898]
mat_Sqrt:  [[0.15]]
grads:  [0.07222022]
Stock Position:  0.07222022010399803
Bond Position:  [-1.93162758]


portfolio before change:  [5.35480574]
curr_Stock_Price:  100.89354530223122
curr_Factors:  [100.8935453]
mat_Sqrt:  [[0.15]]
grads:  [0.02359477]
Stock Position:  0.023594771029393984
Bond Position:  [2.97424564]


portfolio before change:  [5.35687244]
curr_Stock_Price:  100.97325835084942
curr_Factors:  [100.97325835]
mat_Sqrt:  [[0.15]]
grads:  [0.07231808]
Stock Position:  0.07231807946970915
Bond Position:  [-1.94531968]


portfolio before change:  [5.32270542]
curr_Stock_Price:  100.5024847861148
curr_Factors:  [100.50248479]
mat_Sqrt:  [[0.15]]
grads:  [-0.01158972]
Stock Position:  -0.011589719032064167
Bond Position:  [6.48750098]


portfolio before change:  [5.30937745]
curr_Stock_Price:  101.68745290131544
curr_Factors:  [101.6874529]
mat_Sqrt:  [[0.15]]
grads:  [0.09869801]
Stock Position:  0.09869800510545722
Bond Position:  [-4.72697129]


portfolio before change:  [5.29318663]
curr_Stock_Price:  101.52640224658357
curr_Factors:  [101.52640225]
mat_Sqrt:  [[0.15]]
grads:  [-0.11416129]
Stock Position:  -0.11416128704483045
Bond Position:  [16.88357138]


portfolio before change:  [5.31259702]
curr_Stock_Price:  101.36561972783574
curr_Factors:  [101.36561973]
mat_Sqrt:  [[0.15]]
grads:  [0.01196731]
Stock Position:  0.011967310478350111
Bond Position:  [4.09952318]


portfolio before change:  [5.31582479]
curr_Stock_Price:  101.61392448173942
curr_Factors:  [101.61392448]
mat_Sqrt:  [[0.15]]
grads:  [-0.01680292]
Stock Position:  -0.016802923342789308
Bond Position:  [7.02323578]


portfolio before change:  [5.31478998]
curr_Stock_Price:  101.70163391531614
curr_Factors:  [101.70163392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02393661]
Stock Position:  -0.023936609941597773
Bond Position:  [7.74918232]


portfolio before change:  [5.31058966]
curr_Stock_Price:  101.89734506281918
curr_Factors:  [101.89734506]
mat_Sqrt:  [[0.15]]
grads:  [-0.0222724]
Stock Position:  -0.02227240482163555
Bond Position:  [7.58008858]


portfolio before change:  [5.28624978]
curr_Stock_Price:  103.01144344408958
curr_Factors:  [103.01144344]
mat_Sqrt:  [[0.15]]
grads:  [0.07202853]
Stock Position:  0.07202852900608499
Bond Position:  [-2.13351296]


portfolio before change:  [5.30173812]
curr_Stock_Price:  103.22832544381724
curr_Factors:  [103.22832544]
mat_Sqrt:  [[0.15]]
grads:  [-0.08764791]
Stock Position:  -0.08764790654252978
Bond Position:  [14.34948474]


portfolio before change:  [5.22527117]
curr_Stock_Price:  104.11099141570614
curr_Factors:  [104.11099142]
mat_Sqrt:  [[0.15]]
grads:  [0.02631719]
Stock Position:  0.02631719122985606
Bond Position:  [2.4853623]


portfolio before change:  [5.21682088]
curr_Stock_Price:  103.78399505186023
curr_Factors:  [103.78399505]
mat_Sqrt:  [[0.15]]
grads:  [-0.02375557]
Stock Position:  -0.023755570416431213
Bond Position:  [7.68226889]


portfolio before change:  [5.21065272]
curr_Stock_Price:  104.06385852392748
curr_Factors:  [104.06385852]
mat_Sqrt:  [[0.15]]
grads:  [-0.03129494]
Stock Position:  -0.031294944726015336
Bond Position:  [8.46732542]


portfolio before change:  [5.21662784]
curr_Stock_Price:  103.88984023979128
curr_Factors:  [103.88984024]
mat_Sqrt:  [[0.15]]
grads:  [0.03597882]
Stock Position:  0.035978819862256234
Bond Position:  [1.47879399]


portfolio before change:  [5.20560124]
curr_Stock_Price:  103.58079652311062
curr_Factors:  [103.58079652]
mat_Sqrt:  [[0.15]]
grads:  [-0.13078329]
Stock Position:  -0.13078328917941456
Bond Position:  [18.75223851]


portfolio before change:  [5.32029554]
curr_Stock_Price:  102.71277850205776
curr_Factors:  [102.7127785]
mat_Sqrt:  [[0.15]]
grads:  [0.02161276]
Stock Position:  0.02161276346570319
Bond Position:  [3.10038856]


portfolio before change:  [5.32563118]
curr_Stock_Price:  102.95068675006655
curr_Factors:  [102.95068675]
mat_Sqrt:  [[0.15]]
grads:  [0.14699204]
Stock Position:  0.14699203845869124
Bond Position:  [-9.80730013]


portfolio before change:  [5.36328876]
curr_Stock_Price:  103.21104478976054
curr_Factors:  [103.21104479]
mat_Sqrt:  [[0.15]]
grads:  [0.06384462]
Stock Position:  0.06384462244638893
Bond Position:  [-1.22618142]


portfolio before change:  [5.38046257]
curr_Stock_Price:  103.4812390523836
curr_Factors:  [103.48123905]
mat_Sqrt:  [[0.15]]
grads:  [0.0734373]
Stock Position:  0.07343729769330495
Bond Position:  [-2.21891998]


portfolio before change:  [5.42495384]
curr_Stock_Price:  104.0889677344151
curr_Factors:  [104.08896773]
mat_Sqrt:  [[0.15]]
grads:  [0.07030103]
Stock Position:  0.07030102642218782
Bond Position:  [-1.89260743]


portfolio before change:  [5.45828622]
curr_Stock_Price:  104.56478826431878
curr_Factors:  [104.56478826]
mat_Sqrt:  [[0.15]]
grads:  [0.04684978]
Stock Position:  0.04684977985000515
Bond Position:  [0.55944891]


portfolio before change:  [5.48131854]
curr_Stock_Price:  105.05566256968626
curr_Factors:  [105.05566257]
mat_Sqrt:  [[0.15]]
grads:  [0.07373128]
Stock Position:  0.07373127566063431
Bond Position:  [-2.26456948]


portfolio before change:  [5.5185285]
curr_Stock_Price:  105.5622522059801
curr_Factors:  [105.56225221]
mat_Sqrt:  [[0.15]]
grads:  [0.02626391]
Stock Position:  0.026263905636446247
Bond Position:  [2.74605147]


portfolio before change:  [5.51770493]
curr_Stock_Price:  105.5243598005109
curr_Factors:  [105.5243598]
mat_Sqrt:  [[0.15]]
grads:  [-0.10014723]
Stock Position:  -0.10014722607142862
Bond Position:  [16.08567685]


portfolio before change:  [5.52915007]
curr_Stock_Price:  105.4201157914001
curr_Factors:  [105.42011579]
mat_Sqrt:  [[0.15]]
grads:  [-0.14339917]
Stock Position:  -0.1433991716300216
Bond Position:  [20.64630734]


portfolio before change:  [5.53940872]
curr_Stock_Price:  105.3575755424384
curr_Factors:  [105.35757554]
mat_Sqrt:  [[0.15]]
grads:  [0.00521526]
Stock Position:  0.005215264448327214
Bond Position:  [4.9899411]


portfolio before change:  [5.54095402]
curr_Stock_Price:  105.59407702472893
curr_Factors:  [105.59407702]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300722]
Stock Position:  -0.013007217233109079
Bond Position:  [6.91443912]


portfolio before change:  [5.54805707]
curr_Stock_Price:  105.08121683464532
curr_Factors:  [105.08121683]
mat_Sqrt:  [[0.15]]
grads:  [-0.14086357]
Stock Position:  -0.1408635708330491
Bond Position:  [20.3501725]


portfolio before change:  [5.53455621]
curr_Stock_Price:  105.1860898098156
curr_Factors:  [105.18608981]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899037]
Stock Position:  -0.0289903721362033
Bond Position:  [8.5839401]


portfolio before change:  [5.52370947]
curr_Stock_Price:  105.57874615989624
curr_Factors:  [105.57874616]
mat_Sqrt:  [[0.15]]
grads:  [0.0922003]
Stock Position:  0.09220029953294176
Bond Position:  [-4.21068255]


portfolio before change:  [5.58526368]
curr_Stock_Price:  106.24921451346553
curr_Factors:  [106.24921451]
mat_Sqrt:  [[0.15]]
grads:  [0.18000028]
Stock Position:  0.18000027855216594
Bond Position:  [-13.53962453]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.58308006]
Stock Price:  106.24178472802843
PL:  [-0.65870467]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.91118516e-03]
 [ 4.15095020e-02]
 [ 2.16944986e-02]
 [-1.75866116e-02]
 [-2.50022060e-02]
 [-1.47859254e-03]
 [ 4.25838229e-04]
 [-8.63063620e-03]
 [-1.69580153e-04]
 [-1.57377270e-03]
 [-3.71839591e-03]
 [-3.38168747e-03]
 [-2.45609693e-03]
 [ 6.29712665e-03]
 [-3.17954230e-03]
 [ 8.85648145e-03]
 [ 2.63196033e-02]
 [-1.39685525e-02]
 [ 2.36838088e-02]
 [ 1.76658323e-03]
 [-3.68417795e-03]
 [ 4.40669874e-03]
 [ 1.54600477e-02]
 [ 1.85120890e-02]
 [-1.67762329e-03]
 [ 6.98654839e-03]
 [-3.41576104e-03]
 [ 6.44124388e-03]
 [ 3.41443334e-02]
 [-3.30005717e-03]
 [-4.51619086e-03]
 [ 1.30154986e-02]
 [ 1.30344526e-02]
 [ 3.97482177e-04]
 [ 5.60839538e-03]
 [ 1.26263796e-02]
 [-2.65587920e-02]
 [-1.86120179e-03]
 [-2.84523287e-02]
 [-1.68964128e-02]
 [ 3.62867163e-03]
 [ 8.08102072e-03]
 [-1.06330466e-02]
 [ 3.01724865e-03]
 [ 1.01166727e-02]
 [ 1.34553903e-02]
 [ 1.07481113e-02]
 [ 3.50268425e-03]
 [ 1.23822865e-02]
 [-1.89744700e-03]
 [-5.80849207e-03]
 [-5.71846581e-03]
 [ 2.01430057e-03]
 [ 4.87055671e-03]
 [-6.67990170e-03]
 [-4.38371833e-03]
 [ 1.02770451e-03]
 [ 9.35959585e-03]
 [ 7.52190982e-03]
 [-3.98689304e-03]
 [-2.81359890e-04]
 [ 2.42060166e-03]
 [-6.44998023e-03]
 [ 7.25355136e-03]
 [ 2.07071225e-02]
 [ 5.41928672e-03]
 [ 8.07239655e-03]
 [-4.98679015e-04]
 [ 3.36808646e-03]
 [ 2.28591679e-02]
 [ 3.15563166e-03]
 [-1.57997030e-02]
 [-5.43315386e-03]
 [ 9.62842159e-04]
 [ 8.47305734e-03]
 [-2.42488421e-04]
 [-1.43905827e-03]
 [-1.55250530e-03]
 [-2.37495363e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.742387]
curr_Stock_Price:  100.48653868294682
curr_Factors:  [100.48653868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02607457]
Stock Position:  -0.02607456774809779
Bond Position:  [15.36253006]


portfolio before change:  [12.72864089]
curr_Stock_Price:  101.05054808171165
curr_Factors:  [101.05054808]
mat_Sqrt:  [[0.15]]
grads:  [0.27673001]
Stock Position:  0.2767300133541801
Bond Position:  [-15.23507863]


portfolio before change:  [12.5957256]
curr_Stock_Price:  100.57368234875533
curr_Factors:  [100.57368235]
mat_Sqrt:  [[0.15]]
grads:  [0.14462999]
Stock Position:  0.14462999034491775
Bond Position:  [-1.9502451]


portfolio before change:  [12.61971973]
curr_Stock_Price:  100.74042524528299
curr_Factors:  [100.74042525]
mat_Sqrt:  [[0.15]]
grads:  [-0.11724408]
Stock Position:  -0.11724407765171567
Bond Position:  [24.43093797]


portfolio before change:  [12.57317667]
curr_Stock_Price:  101.1504250593242
curr_Factors:  [101.15042506]
mat_Sqrt:  [[0.15]]
grads:  [-0.16668137]
Stock Position:  -0.1666813732685682
Bond Position:  [29.43306842]


portfolio before change:  [12.63101352]
curr_Stock_Price:  100.81447134667364
curr_Factors:  [100.81447135]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985728]
Stock Position:  -0.009857283615972984
Bond Position:  [13.62477035]


portfolio before change:  [12.63771544]
curr_Stock_Price:  100.22096563077208
curr_Factors:  [100.22096563]
mat_Sqrt:  [[0.15]]
grads:  [0.00283892]
Stock Position:  0.0028389215240016397
Bond Position:  [12.35319599]


portfolio before change:  [12.63816732]
curr_Stock_Price:  100.1081686231927
curr_Factors:  [100.10816862]
mat_Sqrt:  [[0.15]]
grads:  [-0.05753757]
Stock Position:  -0.057537574634821655
Bond Position:  [18.39814855]


portfolio before change:  [12.62834325]
curr_Stock_Price:  100.2988961016826
curr_Factors:  [100.2988961]
mat_Sqrt:  [[0.15]]
grads:  [-0.00113053]
Stock Position:  -0.0011305343532941325
Bond Position:  [12.74173459]


portfolio before change:  [12.62821839]
curr_Stock_Price:  101.11376187598448
curr_Factors:  [101.11376188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01049182]
Stock Position:  -0.010491818026628862
Bond Position:  [13.68908558]


portfolio before change:  [12.63067307]
curr_Stock_Price:  100.96134939331293
curr_Factors:  [100.96134939]
mat_Sqrt:  [[0.15]]
grads:  [-0.02478931]
Stock Position:  -0.024789306064327582
Bond Position:  [15.13343486]


portfolio before change:  [12.65842853]
curr_Stock_Price:  99.87985118972719
curr_Factors:  [99.87985119]
mat_Sqrt:  [[0.15]]
grads:  [-0.02254458]
Stock Position:  -0.022544583124662773
Bond Position:  [14.91017814]


portfolio before change:  [12.64939509]
curr_Stock_Price:  100.32188025136509
curr_Factors:  [100.32188025]
mat_Sqrt:  [[0.15]]
grads:  [-0.01637398]
Stock Position:  -0.016373979531917396
Bond Position:  [14.2920635]


portfolio before change:  [12.66623594]
curr_Stock_Price:  99.34792199011488
curr_Factors:  [99.34792199]
mat_Sqrt:  [[0.15]]
grads:  [0.04198084]
Stock Position:  0.04198084433638918
Bond Position:  [8.49552629]


portfolio before change:  [12.62962457]
curr_Stock_Price:  98.46317659696898
curr_Factors:  [98.4631766]
mat_Sqrt:  [[0.15]]
grads:  [-0.02119695]
Stock Position:  -0.02119694868824253
Bond Position:  [14.71674347]


portfolio before change:  [12.62301239]
curr_Stock_Price:  98.81851083124953
curr_Factors:  [98.81851083]
mat_Sqrt:  [[0.15]]
grads:  [0.05904321]
Stock Position:  0.059043209663386054
Bond Position:  [6.78845034]


portfolio before change:  [12.66588949]
curr_Stock_Price:  99.53752339710206
curr_Factors:  [99.5375234]
mat_Sqrt:  [[0.15]]
grads:  [0.17546402]
Stock Position:  0.1754640217848974
Bond Position:  [-4.79936468]


portfolio before change:  [12.53837649]
curr_Stock_Price:  98.81251417500727
curr_Factors:  [98.81251418]
mat_Sqrt:  [[0.15]]
grads:  [-0.09312368]
Stock Position:  -0.0931236831196188
Bond Position:  [21.74016175]


portfolio before change:  [12.52488789]
curr_Stock_Price:  98.97195163358161
curr_Factors:  [98.97195163]
mat_Sqrt:  [[0.15]]
grads:  [0.15789206]
Stock Position:  0.157892058484478
Bond Position:  [-3.10199729]


portfolio before change:  [12.58968541]
curr_Stock_Price:  99.3835708279438
curr_Factors:  [99.38357083]
mat_Sqrt:  [[0.15]]
grads:  [0.01177722]
Stock Position:  0.011777221502307408
Bond Position:  [11.41922308]


portfolio before change:  [12.5948348]
curr_Stock_Price:  99.76020172384234
curr_Factors:  [99.76020172]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456119]
Stock Position:  -0.024561186344354176
Bond Position:  [15.0450637]


portfolio before change:  [12.59364397]
curr_Stock_Price:  99.84697194337203
curr_Factors:  [99.84697194]
mat_Sqrt:  [[0.15]]
grads:  [0.02937799]
Stock Position:  0.029377991581104653
Bond Position:  [9.66034047]


portfolio before change:  [12.61422501]
curr_Stock_Price:  100.52697952777137
curr_Factors:  [100.52697953]
mat_Sqrt:  [[0.15]]
grads:  [0.10306698]
Stock Position:  0.10306698493847624
Bond Position:  [2.25321233]


portfolio before change:  [12.62480618]
curr_Stock_Price:  100.62827613143172
curr_Factors:  [100.62827613]
mat_Sqrt:  [[0.15]]
grads:  [0.12341393]
Stock Position:  0.12341392643696407
Bond Position:  [0.20587551]


portfolio before change:  [12.72095054]
curr_Stock_Price:  101.40721169891715
curr_Factors:  [101.4072117]
mat_Sqrt:  [[0.15]]
grads:  [-0.01118416]
Stock Position:  -0.011184155250691715
Bond Position:  [13.85510454]


portfolio before change:  [12.72435699]
curr_Stock_Price:  101.18006190710136
curr_Factors:  [101.18006191]
mat_Sqrt:  [[0.15]]
grads:  [0.04657699]
Stock Position:  0.04657698927969928
Bond Position:  [8.01169433]


portfolio before change:  [12.74484984]
curr_Stock_Price:  101.60928881619942
curr_Factors:  [101.60928882]
mat_Sqrt:  [[0.15]]
grads:  [-0.02277174]
Stock Position:  -0.022771740257292172
Bond Position:  [15.05867017]


portfolio before change:  [12.76195174]
curr_Stock_Price:  100.89960612792206
curr_Factors:  [100.89960613]
mat_Sqrt:  [[0.15]]
grads:  [0.04294163]
Stock Position:  0.042941625891733386
Bond Position:  [8.4291586]


portfolio before change:  [12.77492638]
curr_Stock_Price:  101.18948334209053
curr_Factors:  [101.18948334]
mat_Sqrt:  [[0.15]]
grads:  [0.22762889]
Stock Position:  0.2276288894283222
Bond Position:  [-10.25872333]


portfolio before change:  [12.92081703]
curr_Stock_Price:  101.83321462884021
curr_Factors:  [101.83321463]
mat_Sqrt:  [[0.15]]
grads:  [-0.02200038]
Stock Position:  -0.022000381100692284
Bond Position:  [15.16118656]


portfolio before change:  [12.9288695]
curr_Stock_Price:  101.51027166095935
curr_Factors:  [101.51027166]
mat_Sqrt:  [[0.15]]
grads:  [-0.03010794]
Stock Position:  -0.030107939066150963
Bond Position:  [15.98513457]


portfolio before change:  [12.93131386]
curr_Stock_Price:  101.46226914396404
curr_Factors:  [101.46226914]
mat_Sqrt:  [[0.15]]
grads:  [0.08676999]
Stock Position:  0.08676999037306113
Bond Position:  [4.12743374]


portfolio before change:  [12.9650145]
curr_Stock_Price:  101.84768663561131
curr_Factors:  [101.84768664]
mat_Sqrt:  [[0.15]]
grads:  [0.08689635]
Stock Position:  0.08689635099365127
Bond Position:  [4.11482218]


portfolio before change:  [13.02386533]
curr_Stock_Price:  102.52198014571869
curr_Factors:  [102.52198015]
mat_Sqrt:  [[0.15]]
grads:  [0.00264988]
Stock Position:  0.0026498811782708215
Bond Position:  [12.75219427]


portfolio before change:  [13.02454795]
curr_Stock_Price:  102.47880180940268
curr_Factors:  [102.47880181]
mat_Sqrt:  [[0.15]]
grads:  [0.0373893]
Stock Position:  0.03738930251475262
Bond Position:  [9.19293703]


portfolio before change:  [13.01666175]
curr_Stock_Price:  102.25251296967436
curr_Factors:  [102.25251297]
mat_Sqrt:  [[0.15]]
grads:  [0.08417586]
Stock Position:  0.08417586429716915
Bond Position:  [4.40946809]


portfolio before change:  [12.98243388]
curr_Stock_Price:  101.84261550083748
curr_Factors:  [101.8426155]
mat_Sqrt:  [[0.15]]
grads:  [-0.17705861]
Stock Position:  -0.1770586135692786
Bond Position:  [31.01454618]


portfolio before change:  [12.91547734]
curr_Stock_Price:  102.23172396758697
curr_Factors:  [102.23172397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01240801]
Stock Position:  -0.01240801195752923
Bond Position:  [14.18396979]


portfolio before change:  [12.91216121]
curr_Stock_Price:  102.57042894947752
curr_Factors:  [102.57042895]
mat_Sqrt:  [[0.15]]
grads:  [-0.18968219]
Stock Position:  -0.18968219106059162
Bond Position:  [32.36794491]


portfolio before change:  [12.78310502]
curr_Stock_Price:  103.26147563984577
curr_Factors:  [103.26147564]
mat_Sqrt:  [[0.15]]
grads:  [-0.11264275]
Stock Position:  -0.1126427522771877
Bond Position:  [24.41476184]


portfolio before change:  [12.74085598]
curr_Stock_Price:  103.650093758379
curr_Factors:  [103.65009376]
mat_Sqrt:  [[0.15]]
grads:  [0.02419114]
Stock Position:  0.024191144222153196
Bond Position:  [10.23344161]


portfolio before change:  [12.74376757]
curr_Stock_Price:  103.74401181748564
curr_Factors:  [103.74401182]
mat_Sqrt:  [[0.15]]
grads:  [0.05387347]
Stock Position:  0.053873471474894206
Bond Position:  [7.15471751]


portfolio before change:  [12.74396611]
curr_Stock_Price:  103.73939652015478
curr_Factors:  [103.73939652]
mat_Sqrt:  [[0.15]]
grads:  [-0.07088698]
Stock Position:  -0.07088697701055445
Bond Position:  [20.09773833]


portfolio before change:  [12.7730004]
curr_Stock_Price:  103.34753126388605
curr_Factors:  [103.34753126]
mat_Sqrt:  [[0.15]]
grads:  [0.02011499]
Stock Position:  0.020114990999633084
Bond Position:  [10.69416574]


portfolio before change:  [12.7537482]
curr_Stock_Price:  102.35719451852418
curr_Factors:  [102.35719452]
mat_Sqrt:  [[0.15]]
grads:  [0.06744448]
Stock Position:  0.0674444849035826
Bond Position:  [5.85031993]


portfolio before change:  [12.69411791]
curr_Stock_Price:  101.46763407407123
curr_Factors:  [101.46763407]
mat_Sqrt:  [[0.15]]
grads:  [0.0897026]
Stock Position:  0.08970260221355618
Bond Position:  [3.59220709]


portfolio before change:  [12.66354387]
curr_Stock_Price:  101.12429336143886
curr_Factors:  [101.12429336]
mat_Sqrt:  [[0.15]]
grads:  [0.07165408]
Stock Position:  0.07165407539962723
Bond Position:  [5.41757613]


portfolio before change:  [12.64906194]
curr_Stock_Price:  100.91745885936872
curr_Factors:  [100.91745886]
mat_Sqrt:  [[0.15]]
grads:  [0.02335123]
Stock Position:  0.023351228318437736
Bond Position:  [10.29251532]


portfolio before change:  [12.65786127]
curr_Stock_Price:  101.26673479996688
curr_Factors:  [101.2667348]
mat_Sqrt:  [[0.15]]
grads:  [0.08254858]
Stock Position:  0.08254857676295863
Bond Position:  [4.29843644]


portfolio before change:  [12.57771661]
curr_Stock_Price:  100.29260146688769
curr_Factors:  [100.29260147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01264965]
Stock Position:  -0.012649646667268024
Bond Position:  [13.84638258]


portfolio before change:  [12.58979455]
curr_Stock_Price:  99.4062119120001
curr_Factors:  [99.40621191]
mat_Sqrt:  [[0.15]]
grads:  [-0.03872328]
Stock Position:  -0.03872328049606272
Bond Position:  [16.43912918]


portfolio before change:  [12.5757419]
curr_Stock_Price:  99.79564505512982
curr_Factors:  [99.79564506]
mat_Sqrt:  [[0.15]]
grads:  [-0.03812311]
Stock Position:  -0.038123105381922415
Bond Position:  [16.38026179]


portfolio before change:  [12.57441327]
curr_Stock_Price:  99.8573511127996
curr_Factors:  [99.85735111]
mat_Sqrt:  [[0.15]]
grads:  [0.01342867]
Stock Position:  0.013428670474489498
Bond Position:  [11.23346181]


portfolio before change:  [12.57079882]
curr_Stock_Price:  99.53590759140974
curr_Factors:  [99.53590759]
mat_Sqrt:  [[0.15]]
grads:  [0.03247038]
Stock Position:  0.03247037805570481
Bond Position:  [9.33883028]


portfolio before change:  [12.55960658]
curr_Stock_Price:  99.17324040335566
curr_Factors:  [99.1732404]
mat_Sqrt:  [[0.15]]
grads:  [-0.04453268]
Stock Position:  -0.04453267799964889
Bond Position:  [16.97605656]


portfolio before change:  [12.55302737]
curr_Stock_Price:  99.34480541059295
curr_Factors:  [99.34480541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02922479]
Stock Position:  -0.02922478886777428
Bond Position:  [15.45635833]


portfolio before change:  [12.56995792]
curr_Stock_Price:  98.79853965830988
curr_Factors:  [98.79853966]
mat_Sqrt:  [[0.15]]
grads:  [0.00685136]
Stock Position:  0.006851363379182131
Bond Position:  [11.89305322]


portfolio before change:  [12.57031734]
curr_Stock_Price:  98.74250442089858
curr_Factors:  [98.74250442]
mat_Sqrt:  [[0.15]]
grads:  [0.06239731]
Stock Position:  0.0623973056507077
Bond Position:  [6.40905111]


portfolio before change:  [12.56786092]
curr_Stock_Price:  98.69671718153344
curr_Factors:  [98.69671718]
mat_Sqrt:  [[0.15]]
grads:  [0.05014607]
Stock Position:  0.05014606548104293
Bond Position:  [7.61860888]


portfolio before change:  [12.58814091]
curr_Stock_Price:  99.09163983073321
curr_Factors:  [99.09163983]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657929]
Stock Position:  -0.02657928690933034
Bond Position:  [15.22192604]


portfolio before change:  [12.57796487]
curr_Stock_Price:  99.51029092492438
curr_Factors:  [99.51029092]
mat_Sqrt:  [[0.15]]
grads:  [-0.00187573]
Stock Position:  -0.0018757325973057723
Bond Position:  [12.76461956]


portfolio before change:  [12.57938895]
curr_Stock_Price:  99.17641173715425
curr_Factors:  [99.17641174]
mat_Sqrt:  [[0.15]]
grads:  [0.01613734]
Stock Position:  0.016137344415485817
Bond Position:  [10.97894503]


portfolio before change:  [12.5787077]
curr_Stock_Price:  99.09167350981676
curr_Factors:  [99.09167351]
mat_Sqrt:  [[0.15]]
grads:  [-0.04299987]
Stock Position:  -0.04299986821408033
Bond Position:  [16.83963661]


portfolio before change:  [12.54623131]
curr_Stock_Price:  99.87141794315917
curr_Factors:  [99.87141794]
mat_Sqrt:  [[0.15]]
grads:  [0.04835701]
Stock Position:  0.04835700907973453
Bond Position:  [7.71674824]


portfolio before change:  [12.53478003]
curr_Stock_Price:  99.62463708548795
curr_Factors:  [99.62463709]
mat_Sqrt:  [[0.15]]
grads:  [0.13804748]
Stock Position:  0.13804748332911945
Bond Position:  [-1.21815039]


portfolio before change:  [12.51909483]
curr_Stock_Price:  99.5115668004836
curr_Factors:  [99.5115668]
mat_Sqrt:  [[0.15]]
grads:  [0.03612858]
Stock Position:  0.03612857813921502
Bond Position:  [8.92388341]


portfolio before change:  [12.51748943]
curr_Stock_Price:  99.45169296509499
curr_Factors:  [99.45169297]
mat_Sqrt:  [[0.15]]
grads:  [0.05381598]
Stock Position:  0.05381597697717288
Bond Position:  [7.16539941]


portfolio before change:  [12.44417406]
curr_Stock_Price:  98.08103640047541
curr_Factors:  [98.0810364]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332453]
Stock Position:  -0.0033245267647128715
Bond Position:  [12.77024709]


portfolio before change:  [12.44670961]
curr_Stock_Price:  97.55844093120062
curr_Factors:  [97.55844093]
mat_Sqrt:  [[0.15]]
grads:  [0.02245391]
Stock Position:  0.022453909763277588
Bond Position:  [10.25614118]


portfolio before change:  [12.45270628]
curr_Stock_Price:  97.79695779102178
curr_Factors:  [97.79695779]
mat_Sqrt:  [[0.15]]
grads:  [0.15239445]
Stock Position:  0.15239445241604832
Bond Position:  [-2.45100756]


portfolio before change:  [12.50615616]
curr_Stock_Price:  98.14869679315375
curr_Factors:  [98.14869679]
mat_Sqrt:  [[0.15]]
grads:  [0.02103754]
Stock Position:  0.021037544372531174
Bond Position:  [10.44134859]


portfolio before change:  [12.50669842]
curr_Stock_Price:  98.14345185774839
curr_Factors:  [98.14345186]
mat_Sqrt:  [[0.15]]
grads:  [-0.10533135]
Stock Position:  -0.10533135355224724
Bond Position:  [22.84428105]


portfolio before change:  [12.55040517]
curr_Stock_Price:  97.74206196290027
curr_Factors:  [97.74206196]
mat_Sqrt:  [[0.15]]
grads:  [-0.03622103]
Stock Position:  -0.03622102574975451
Bond Position:  [16.09072292]


portfolio before change:  [12.5263505]
curr_Stock_Price:  98.43393550242779
curr_Factors:  [98.4339355]
mat_Sqrt:  [[0.15]]
grads:  [0.00641895]
Stock Position:  0.006418947727485514
Bond Position:  [11.89450822]


portfolio before change:  [12.5230121]
curr_Stock_Price:  97.79803170059257
curr_Factors:  [97.7980317]
mat_Sqrt:  [[0.15]]
grads:  [0.05648705]
Stock Position:  0.05648704891435886
Bond Position:  [6.9986899]


portfolio before change:  [12.56180727]
curr_Stock_Price:  98.47708539225655
curr_Factors:  [98.47708539]
mat_Sqrt:  [[0.15]]
grads:  [-0.00161659]
Stock Position:  -0.0016165894737488196
Bond Position:  [12.72100429]


portfolio before change:  [12.56234487]
curr_Stock_Price:  98.63636352610365
curr_Factors:  [98.63636353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00959372]
Stock Position:  -0.009593721796095224
Bond Position:  [13.5086347]


portfolio before change:  [12.5668091]
curr_Stock_Price:  98.25904268076957
curr_Factors:  [98.25904268]
mat_Sqrt:  [[0.15]]
grads:  [-0.01035004]
Stock Position:  -0.010350035352194968
Bond Position:  [13.58379367]


portfolio before change:  [12.56539757]
curr_Stock_Price:  98.47745190811304
curr_Factors:  [98.47745191]
mat_Sqrt:  [[0.15]]
grads:  [-0.15833024]
Stock Position:  -0.15833024196033024
Bond Position:  [28.15735636]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.5770168]
Stock Price:  98.41518120001886
PL:  [12.5770168]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38444613e-02]
 [ 1.81224810e-02]
 [ 1.24202319e-02]
 [-7.80357295e-03]
 [ 1.49364767e-02]
 [-1.47139948e-02]
 [-1.35463560e-02]
 [ 7.88373383e-02]
 [-2.10573038e-02]
 [-1.35404853e-02]
 [ 8.09156357e-04]
 [-7.56624534e-03]
 [ 4.59735461e-03]
 [-5.54002148e-03]
 [-1.97974449e-03]
 [ 6.40605149e-03]
 [-1.66295420e-02]
 [-1.13510470e-02]
 [ 2.47198156e-02]
 [-2.45001140e-03]
 [-1.57039718e-02]
 [ 5.55551779e-03]
 [ 1.34030208e-02]
 [ 1.91402989e-02]
 [-4.64045923e-03]
 [ 4.51736424e-03]
 [ 9.37495854e-03]
 [ 8.22595462e-03]
 [ 1.56871400e-02]
 [ 2.34366659e-02]
 [-7.04120540e-03]
 [ 2.05952292e-02]
 [ 1.33054533e-02]
 [-1.93317641e-02]
 [-1.69651297e-02]
 [-5.58432161e-02]
 [ 1.70570398e-02]
 [-8.06442680e-03]
 [ 5.18590479e-02]
 [ 1.14281552e-02]
 [ 6.75351234e-03]
 [ 3.55149647e-02]
 [-3.37090502e-03]
 [ 1.97227943e-02]
 [-4.84460948e-02]
 [ 2.19141542e-02]
 [ 9.21794659e-03]
 [ 5.37710668e-03]
 [-8.23540775e-03]
 [-1.08786586e-04]
 [-3.79545796e-03]
 [-3.17577870e-04]
 [ 4.92468720e-04]
 [ 7.61116502e-03]
 [-1.00591746e-02]
 [-4.73674326e-03]
 [-1.14034233e-03]
 [ 1.27126170e-02]
 [ 7.20874037e-03]
 [-2.93123907e-03]
 [-5.13669880e-03]
 [-1.69530618e-03]
 [-2.75442673e-03]
 [-2.53827351e-03]
 [ 1.89828000e-02]
 [ 5.83835964e-03]
 [ 1.67213787e-02]
 [-2.21688941e-03]
 [ 5.53662792e-03]
 [ 2.70148982e-02]
 [ 3.18367784e-03]
 [-1.52872529e-02]
 [-5.78709042e-03]
 [ 2.09874384e-03]
 [ 1.04783734e-02]
 [ 6.85278380e-03]
 [ 1.88794786e-04]
 [-1.60327630e-02]
 [-2.37294377e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.84352769]
curr_Stock_Price:  99.68782247640722
curr_Factors:  [99.68782248]
mat_Sqrt:  [[0.15]]
grads:  [-0.09229641]
Stock Position:  -0.09229640837854929
Bond Position:  [4.35730029]


portfolio before change:  [-4.90245976]
curr_Stock_Price:  100.32928198271851
curr_Factors:  [100.32928198]
mat_Sqrt:  [[0.15]]
grads:  [0.12081654]
Stock Position:  0.12081654013290632
Bond Position:  [-17.02389648]


portfolio before change:  [-5.02185506]
curr_Stock_Price:  99.34985254109108
curr_Factors:  [99.34985254]
mat_Sqrt:  [[0.15]]
grads:  [0.08280155]
Stock Position:  0.08280154616150154
Bond Position:  [-13.24817646]


portfolio before change:  [-4.94436964]
curr_Stock_Price:  100.2956495514672
curr_Factors:  [100.29564955]
mat_Sqrt:  [[0.15]]
grads:  [-0.05202382]
Stock Position:  -0.052023819698708694
Bond Position:  [0.27339315]


portfolio before change:  [-4.90730599]
curr_Stock_Price:  99.58354188146365
curr_Factors:  [99.58354188]
mat_Sqrt:  [[0.15]]
grads:  [0.09957651]
Stock Position:  0.09957651115044337
Bond Position:  [-14.82348766]


portfolio before change:  [-5.0147592]
curr_Stock_Price:  98.51374429460338
curr_Factors:  [98.51374429]
mat_Sqrt:  [[0.15]]
grads:  [-0.0980933]
Stock Position:  -0.09809329867751568
Bond Position:  [4.64877894]


portfolio before change:  [-4.97166316]
curr_Stock_Price:  98.07736910279291
curr_Factors:  [98.0773691]
mat_Sqrt:  [[0.15]]
grads:  [-0.09030904]
Stock Position:  -0.09030904008638531
Bond Position:  [3.8856099]


portfolio before change:  [-4.87974491]
curr_Stock_Price:  97.06223934011875
curr_Factors:  [97.06223934]
mat_Sqrt:  [[0.15]]
grads:  [0.52558226]
Stock Position:  0.52558225537008
Bond Position:  [-55.89393557]


portfolio before change:  [-5.00196714]
curr_Stock_Price:  96.83633987701158
curr_Factors:  [96.83633988]
mat_Sqrt:  [[0.15]]
grads:  [-0.14038203]
Stock Position:  -0.140382025568769
Bond Position:  [8.5921144]


portfolio before change:  [-4.95169339]
curr_Stock_Price:  96.48204434313861
curr_Factors:  [96.48204434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0902699]
Stock Position:  -0.09026990179323399
Bond Position:  [3.75773128]


portfolio before change:  [-5.01263522]
curr_Stock_Price:  97.15975307181208
curr_Factors:  [97.15975307]
mat_Sqrt:  [[0.15]]
grads:  [0.00539438]
Stock Position:  0.005394375714005539
Bond Position:  [-5.53675144]


portfolio before change:  [-5.00999466]
curr_Stock_Price:  97.71340854536585
curr_Factors:  [97.71340855]
mat_Sqrt:  [[0.15]]
grads:  [-0.05044164]
Stock Position:  -0.05044163562185052
Bond Position:  [-0.08117051]


portfolio before change:  [-4.98499422]
curr_Stock_Price:  97.21767702034886
curr_Factors:  [97.21767702]
mat_Sqrt:  [[0.15]]
grads:  [0.03064903]
Stock Position:  0.030649030763478902
Bond Position:  [-7.96462179]


portfolio before change:  [-4.97297074]
curr_Stock_Price:  97.62621488716455
curr_Factors:  [97.62621489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03693348]
Stock Position:  -0.03693347651762716
Bond Position:  [-1.36729522]


portfolio before change:  [-4.98871987]
curr_Stock_Price:  98.05031992901479
curr_Factors:  [98.05031993]
mat_Sqrt:  [[0.15]]
grads:  [-0.0131983]
Stock Position:  -0.013198296570408018
Bond Position:  [-3.69462267]


portfolio before change:  [-4.99307713]
curr_Stock_Price:  98.36296187566215
curr_Factors:  [98.36296188]
mat_Sqrt:  [[0.15]]
grads:  [0.04270701]
Stock Position:  0.04270700991932559
Bond Position:  [-9.19386512]


portfolio before change:  [-5.01234602]
curr_Stock_Price:  97.92522904231141
curr_Factors:  [97.92522904]
mat_Sqrt:  [[0.15]]
grads:  [-0.11086361]
Stock Position:  -0.11086361345567143
Bond Position:  [5.84399872]


portfolio before change:  [-4.93704951]
curr_Stock_Price:  97.24934227679157
curr_Factors:  [97.24934228]
mat_Sqrt:  [[0.15]]
grads:  [-0.07567365]
Stock Position:  -0.0756736464883706
Bond Position:  [2.42216283]


portfolio before change:  [-4.95001198]
curr_Stock_Price:  97.4226371619348
curr_Factors:  [97.42263716]
mat_Sqrt:  [[0.15]]
grads:  [0.16479877]
Stock Position:  0.16479877064683823
Bond Position:  [-21.00514282]


portfolio before change:  [-4.9197765]
curr_Stock_Price:  97.61407273045486
curr_Factors:  [97.61407273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633341]
Stock Position:  -0.01633340932240972
Bond Position:  [-3.32540589]


portfolio before change:  [-4.91504096]
curr_Stock_Price:  97.31141838045988
curr_Factors:  [97.31141838]
mat_Sqrt:  [[0.15]]
grads:  [-0.10469315]
Stock Position:  -0.10469314513272056
Bond Position:  [5.27279748]


portfolio before change:  [-4.94891397]
curr_Stock_Price:  97.63811181398593
curr_Factors:  [97.63811181]
mat_Sqrt:  [[0.15]]
grads:  [0.03703679]
Stock Position:  0.03703678525269788
Bond Position:  [-8.56511575]


portfolio before change:  [-4.94075446]
curr_Stock_Price:  97.87287429036644
curr_Factors:  [97.87287429]
mat_Sqrt:  [[0.15]]
grads:  [0.08935347]
Stock Position:  0.08935347224086033
Bond Position:  [-13.68603561]


portfolio before change:  [-4.88704473]
curr_Stock_Price:  98.48354036114972
curr_Factors:  [98.48354036]
mat_Sqrt:  [[0.15]]
grads:  [0.12760199]
Stock Position:  0.1276019926426159
Bond Position:  [-17.45374072]


portfolio before change:  [-4.89100282]
curr_Stock_Price:  98.46107046894289
curr_Factors:  [98.46107047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03093639]
Stock Position:  -0.03093639486750534
Bond Position:  [-1.84497227]


portfolio before change:  [-4.88403548]
curr_Stock_Price:  98.2321279277795
curr_Factors:  [98.23212793]
mat_Sqrt:  [[0.15]]
grads:  [0.03011576]
Stock Position:  0.03011576162427228
Bond Position:  [-7.84237083]


portfolio before change:  [-4.87502783]
curr_Stock_Price:  98.54750477756897
curr_Factors:  [98.54750478]
mat_Sqrt:  [[0.15]]
grads:  [0.06249972]
Stock Position:  0.0624997235840306
Bond Position:  [-11.03421964]


portfolio before change:  [-4.85542326]
curr_Stock_Price:  98.87221390616328
curr_Factors:  [98.87221391]
mat_Sqrt:  [[0.15]]
grads:  [0.0548397]
Stock Position:  0.05483969748632053
Bond Position:  [-10.27754556]


portfolio before change:  [-4.85980703]
curr_Stock_Price:  98.80398955649676
curr_Factors:  [98.80398956]
mat_Sqrt:  [[0.15]]
grads:  [0.10458093]
Stock Position:  0.10458093305196445
Bond Position:  [-15.19282044]


portfolio before change:  [-4.9752709]
curr_Stock_Price:  97.70900703306465
curr_Factors:  [97.70900703]
mat_Sqrt:  [[0.15]]
grads:  [0.15624444]
Stock Position:  0.15624443924580828
Bond Position:  [-20.24175992]


portfolio before change:  [-5.05828187]
curr_Stock_Price:  97.1858151809352
curr_Factors:  [97.18581518]
mat_Sqrt:  [[0.15]]
grads:  [-0.04694137]
Stock Position:  -0.046941369353084635
Bond Position:  [-0.49624662]


portfolio before change:  [-5.0359487]
curr_Stock_Price:  96.70938715983928
curr_Factors:  [96.70938716]
mat_Sqrt:  [[0.15]]
grads:  [0.13730153]
Stock Position:  0.13730152771843232
Bond Position:  [-18.3142953]


portfolio before change:  [-5.20054055]
curr_Stock_Price:  95.51896220817841
curr_Factors:  [95.51896221]
mat_Sqrt:  [[0.15]]
grads:  [0.08870302]
Stock Position:  0.08870302214373438
Bond Position:  [-13.67336117]


portfolio before change:  [-5.20400996]
curr_Stock_Price:  95.48948403983024
curr_Factors:  [95.48948404]
mat_Sqrt:  [[0.15]]
grads:  [-0.12887843]
Stock Position:  -0.1288784274421094
Bond Position:  [7.10252458]


portfolio before change:  [-5.1565546]
curr_Stock_Price:  95.12471047742673
curr_Factors:  [95.12471048]
mat_Sqrt:  [[0.15]]
grads:  [-0.11310086]
Stock Position:  -0.11310086477691639
Bond Position:  [5.60213242]


portfolio before change:  [-5.13791749]
curr_Stock_Price:  94.96302326098966
curr_Factors:  [94.96302326]
mat_Sqrt:  [[0.15]]
grads:  [-0.37228811]
Stock Position:  -0.37228810706967846
Bond Position:  [30.21568668]


portfolio before change:  [-4.94491211]
curr_Stock_Price:  94.44966589952138
curr_Factors:  [94.4496659]
mat_Sqrt:  [[0.15]]
grads:  [0.1137136]
Stock Position:  0.11371359876566704
Bond Position:  [-15.68512352]


portfolio before change:  [-4.97044197]
curr_Stock_Price:  94.23377695974533
curr_Factors:  [94.23377696]
mat_Sqrt:  [[0.15]]
grads:  [-0.05376285]
Stock Position:  -0.05376284535284842
Bond Position:  [0.09583401]


portfolio before change:  [-5.00360409]
curr_Stock_Price:  94.85071067750144
curr_Factors:  [94.85071068]
mat_Sqrt:  [[0.15]]
grads:  [0.34572699]
Stock Position:  0.34572698568238736
Bond Position:  [-37.79605438]


portfolio before change:  [-4.81461286]
curr_Stock_Price:  95.40419236240832
curr_Factors:  [95.40419236]
mat_Sqrt:  [[0.15]]
grads:  [0.0761877]
Stock Position:  0.07618770129617317
Bond Position:  [-12.08323897]


portfolio before change:  [-4.80202502]
curr_Stock_Price:  95.57932647177456
curr_Factors:  [95.57932647]
mat_Sqrt:  [[0.15]]
grads:  [0.04502342]
Stock Position:  0.04502341557542786
Bond Position:  [-9.10533276]


portfolio before change:  [-4.8284457]
curr_Stock_Price:  95.00514568741603
curr_Factors:  [95.00514569]
mat_Sqrt:  [[0.15]]
grads:  [0.23676643]
Stock Position:  0.2367664311610375
Bond Position:  [-27.32247499]


portfolio before change:  [-4.58641787]
curr_Stock_Price:  96.03458021303332
curr_Factors:  [96.03458021]
mat_Sqrt:  [[0.15]]
grads:  [-0.0224727]
Stock Position:  -0.02247270016038952
Bond Position:  [-2.42826155]


portfolio before change:  [-4.57319655]
curr_Stock_Price:  95.43949866186614
curr_Factors:  [95.43949866]
mat_Sqrt:  [[0.15]]
grads:  [0.1314853]
Stock Position:  0.13148529546250645
Bond Position:  [-17.12208723]


portfolio before change:  [-4.54461411]
curr_Stock_Price:  95.66501896314308
curr_Factors:  [95.66501896]
mat_Sqrt:  [[0.15]]
grads:  [-0.32297397]
Stock Position:  -0.3229739653390898
Bond Position:  [26.3526964]


portfolio before change:  [-4.58961736]
curr_Stock_Price:  95.80945889860115
curr_Factors:  [95.8094589]
mat_Sqrt:  [[0.15]]
grads:  [0.14609436]
Stock Position:  0.1460943615784186
Bond Position:  [-18.58683909]


portfolio before change:  [-4.63489261]
curr_Stock_Price:  95.50750654753752
curr_Factors:  [95.50750655]
mat_Sqrt:  [[0.15]]
grads:  [0.06145298]
Stock Position:  0.061452977279546836
Bond Position:  [-10.50411324]


portfolio before change:  [-4.64069543]
curr_Stock_Price:  95.42376297300623
curr_Factors:  [95.42376297]
mat_Sqrt:  [[0.15]]
grads:  [0.03584738]
Stock Position:  0.03584737789211099
Bond Position:  [-8.06138712]


portfolio before change:  [-4.61276299]
curr_Stock_Price:  96.2170230565813
curr_Factors:  [96.21702306]
mat_Sqrt:  [[0.15]]
grads:  [-0.05490272]
Stock Position:  -0.05490271835207332
Bond Position:  [0.66981313]


portfolio before change:  [-4.61174906]
curr_Stock_Price:  96.19931795519855
curr_Factors:  [96.19931796]
mat_Sqrt:  [[0.15]]
grads:  [-0.00072524]
Stock Position:  -0.0007252439043900545
Bond Position:  [-4.54198109]


portfolio before change:  [-4.61233624]
curr_Stock_Price:  96.61751354502861
curr_Factors:  [96.61751355]
mat_Sqrt:  [[0.15]]
grads:  [-0.02530305]
Stock Position:  -0.02530305307024893
Bond Position:  [-2.16761817]


portfolio before change:  [-4.61535148]
curr_Stock_Price:  96.7313241580259
curr_Factors:  [96.73132416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00211719]
Stock Position:  -0.002117185797944089
Bond Position:  [-4.41055329]


portfolio before change:  [-4.61594534]
curr_Stock_Price:  96.88161522785639
curr_Factors:  [96.88161523]
mat_Sqrt:  [[0.15]]
grads:  [0.00328312]
Stock Position:  0.003283124801006864
Bond Position:  [-4.93401977]


portfolio before change:  [-4.61942968]
curr_Stock_Price:  95.91425715422291
curr_Factors:  [95.91425715]
mat_Sqrt:  [[0.15]]
grads:  [0.0507411]
Stock Position:  0.050741100156678896
Bond Position:  [-9.48622461]


portfolio before change:  [-4.57482373]
curr_Stock_Price:  96.80503134861925
curr_Factors:  [96.80503135]
mat_Sqrt:  [[0.15]]
grads:  [-0.06706116]
Stock Position:  -0.06706116402426766
Bond Position:  [1.91703436]


portfolio before change:  [-4.60222237]
curr_Stock_Price:  97.21538007339501
curr_Factors:  [97.21538007]
mat_Sqrt:  [[0.15]]
grads:  [-0.03157829]
Stock Position:  -0.03157828840063492
Bond Position:  [-1.53232706]


portfolio before change:  [-4.5941746]
curr_Stock_Price:  96.95749572779883
curr_Factors:  [96.95749573]
mat_Sqrt:  [[0.15]]
grads:  [-0.00760228]
Stock Position:  -0.00760228221992312
Bond Position:  [-3.85707635]


portfolio before change:  [-4.59137157]
curr_Stock_Price:  96.5570763892533
curr_Factors:  [96.55707639]
mat_Sqrt:  [[0.15]]
grads:  [0.08475078]
Stock Position:  0.0847507802315394
Bond Position:  [-12.77465913]


portfolio before change:  [-4.61982883]
curr_Stock_Price:  96.23072168705104
curr_Factors:  [96.23072169]
mat_Sqrt:  [[0.15]]
grads:  [0.04805827]
Stock Position:  0.04805826915829948
Bond Position:  [-9.24451075]


portfolio before change:  [-4.62634765]
curr_Stock_Price:  96.1071003974021
curr_Factors:  [96.1071004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01954159]
Stock Position:  -0.019541593803781336
Bond Position:  [-2.74826174]


portfolio before change:  [-4.63359177]
curr_Stock_Price:  96.46901259356258
curr_Factors:  [96.46901259]
mat_Sqrt:  [[0.15]]
grads:  [-0.03424466]
Stock Position:  -0.034244658638300986
Bond Position:  [-1.33004336]


portfolio before change:  [-4.62851917]
curr_Stock_Price:  96.31845704889422
curr_Factors:  [96.31845705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130204]
Stock Position:  -0.011302041187799585
Bond Position:  [-3.53992401]


portfolio before change:  [-4.6281082]
curr_Stock_Price:  96.26251748425878
curr_Factors:  [96.26251748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01836284]
Stock Position:  -0.018362844864667736
Bond Position:  [-2.86045452]


portfolio before change:  [-4.63481415]
curr_Stock_Price:  96.61797260600461
curr_Factors:  [96.61797261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01692182]
Stock Position:  -0.016921823385752478
Bond Position:  [-2.99986188]


portfolio before change:  [-4.63615146]
curr_Stock_Price:  96.68592155871727
curr_Factors:  [96.68592156]
mat_Sqrt:  [[0.15]]
grads:  [0.126552]
Stock Position:  0.1265520003215922
Bond Position:  [-16.87194824]


portfolio before change:  [-4.73746527]
curr_Stock_Price:  95.89368375351795
curr_Factors:  [95.89368375]
mat_Sqrt:  [[0.15]]
grads:  [0.0389224]
Stock Position:  0.03892239758871585
Bond Position:  [-8.46987736]


portfolio before change:  [-4.71172824]
curr_Stock_Price:  96.56852431252364
curr_Factors:  [96.56852431]
mat_Sqrt:  [[0.15]]
grads:  [0.11147586]
Stock Position:  0.11147585778457227
Bond Position:  [-15.47678733]


portfolio before change:  [-4.7146064]
curr_Stock_Price:  96.55138317243589
curr_Factors:  [96.55138317]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477926]
Stock Position:  -0.014779262730037178
Bond Position:  [-3.28764814]


portfolio before change:  [-4.71029612]
curr_Stock_Price:  96.24583635782243
curr_Factors:  [96.24583636]
mat_Sqrt:  [[0.15]]
grads:  [0.03691085]
Stock Position:  0.036910852828165246
Bond Position:  [-8.26281203]


portfolio before change:  [-4.74150945]
curr_Stock_Price:  95.41418705590242
curr_Factors:  [95.41418706]
mat_Sqrt:  [[0.15]]
grads:  [0.18009932]
Stock Position:  0.18009932141324206
Bond Position:  [-21.92553979]


portfolio before change:  [-4.6928156]
curr_Stock_Price:  95.69216835712608
curr_Factors:  [95.69216836]
mat_Sqrt:  [[0.15]]
grads:  [0.02122452]
Stock Position:  0.02122451890367213
Bond Position:  [-6.72383583]


portfolio before change:  [-4.69790741]
curr_Stock_Price:  95.47206627316334
curr_Factors:  [95.47206627]
mat_Sqrt:  [[0.15]]
grads:  [-0.10191502]
Stock Position:  -0.10191501954746499
Bond Position:  [5.03213009]


portfolio before change:  [-4.68555152]
curr_Stock_Price:  95.35391520382245
curr_Factors:  [95.3539152]
mat_Sqrt:  [[0.15]]
grads:  [-0.0385806]
Stock Position:  -0.03858060276691978
Bond Position:  [-1.00674]


portfolio before change:  [-4.71518295]
curr_Stock_Price:  96.12032366600704
curr_Factors:  [96.12032367]
mat_Sqrt:  [[0.15]]
grads:  [0.01399163]
Stock Position:  0.013991625619433583
Bond Position:  [-6.06006253]


portfolio before change:  [-4.71620992]
curr_Stock_Price:  96.07399549715024
curr_Factors:  [96.0739955]
mat_Sqrt:  [[0.15]]
grads:  [0.06985582]
Stock Position:  0.06985582284522618
Bond Position:  [-11.42753793]


portfolio before change:  [-4.77003407]
curr_Stock_Price:  95.31371668575812
curr_Factors:  [95.31371669]
mat_Sqrt:  [[0.15]]
grads:  [0.04568523]
Stock Position:  0.04568522531105937
Bond Position:  [-9.12446269]


portfolio before change:  [-4.77105895]
curr_Stock_Price:  95.30376623193314
curr_Factors:  [95.30376623]
mat_Sqrt:  [[0.15]]
grads:  [0.00125863]
Stock Position:  0.0012586319089766148
Bond Position:  [-4.89101131]


portfolio before change:  [-4.77071179]
curr_Stock_Price:  95.82247284608484
curr_Factors:  [95.82247285]
mat_Sqrt:  [[0.15]]
grads:  [-0.10688509]
Stock Position:  -0.10688508695848613
Bond Position:  [5.47128155]


portfolio before change:  [-4.87457757]
curr_Stock_Price:  96.79742409405529
curr_Factors:  [96.79742409]
mat_Sqrt:  [[0.15]]
grads:  [-0.15819625]
Stock Position:  -0.15819625107304286
Bond Position:  [10.43841203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.76028259]
Stock Price:  96.0790596552946
PL:  [-4.76028259]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38072478e-02]
 [-1.12907619e-04]
 [ 6.33661911e-03]
 [-8.58516314e-03]
 [ 1.09572400e-02]
 [-1.39832441e-02]
 [ 1.75547839e-03]
 [ 1.80961826e-03]
 [-1.48596553e-02]
 [-1.08071324e-02]
 [ 1.37577233e-02]
 [-5.56697278e-03]
 [-4.45608911e-04]
 [-1.33736162e-03]
 [-3.66530282e-03]
 [ 6.18570549e-03]
 [ 1.55322254e-03]
 [-1.43239723e-02]
 [ 2.50052786e-02]
 [ 1.21466607e-03]
 [-4.15513565e-03]
 [ 5.14656926e-03]
 [ 1.75457174e-02]
 [ 1.93381322e-02]
 [-4.23536247e-03]
 [ 4.84424992e-03]
 [-1.55630305e-03]
 [ 7.21774616e-03]
 [ 2.19896997e-02]
 [ 1.05840580e-03]
 [-7.27432095e-03]
 [ 8.71634565e-03]
 [ 1.22413876e-02]
 [-2.44508859e-04]
 [ 4.19988195e-03]
 [ 1.93683211e-02]
 [-2.01367329e-04]
 [ 3.42377529e-03]
 [-5.56233377e-02]
 [ 1.18625964e-02]
 [ 7.07119531e-03]
 [-3.01683574e-03]
 [-1.40024127e-03]
 [-3.88131915e-03]
 [ 2.16113469e-02]
 [ 1.48535056e-02]
 [ 1.08226723e-02]
 [ 3.10225420e-03]
 [ 1.03135522e-02]
 [-1.72840541e-03]
 [-2.19310802e-03]
 [-7.85172642e-03]
 [ 1.91208559e-03]
 [ 7.74310503e-03]
 [-6.24791380e-03]
 [-3.84110805e-03]
 [ 7.24109976e-03]
 [ 4.83049962e-03]
 [ 7.40768656e-03]
 [-4.01811314e-03]
 [-2.65125042e-03]
 [ 1.33502294e-03]
 [-7.01985354e-03]
 [ 7.59650300e-03]
 [ 2.34868037e-02]
 [ 5.49193610e-03]
 [ 1.06745668e-02]
 [ 2.10763461e-03]
 [ 3.10456305e-03]
 [ 1.90114298e-02]
 [ 3.63248560e-04]
 [-1.59835767e-02]
 [-1.52902431e-03]
 [ 1.24978897e-03]
 [-7.76871155e-05]
 [-8.12379424e-03]
 [-4.24933046e-03]
 [ 8.05563584e-03]
 [-2.23722835e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.83959399]
curr_Stock_Price:  99.8696729395281
curr_Factors:  [99.86967294]
mat_Sqrt:  [[0.15]]
grads:  [-0.09204832]
Stock Position:  -0.092048318771527
Bond Position:  [8.3532415]


portfolio before change:  [-0.81366856]
curr_Stock_Price:  99.59369457977701
curr_Factors:  [99.59369458]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075272]
Stock Position:  -0.0007527174583225247
Bond Position:  [-0.73870264]


portfolio before change:  [-0.8136773]
curr_Stock_Price:  99.54397840019664
curr_Factors:  [99.5439784]
mat_Sqrt:  [[0.15]]
grads:  [0.04224413]
Stock Position:  0.04224412736719747
Bond Position:  [-5.01882581]


portfolio before change:  [-0.81479581]
curr_Stock_Price:  99.52492675959446
curr_Factors:  [99.52492676]
mat_Sqrt:  [[0.15]]
grads:  [-0.05723442]
Stock Position:  -0.05723442093958756
Bond Position:  [4.88145574]


portfolio before change:  [-0.76714805]
curr_Stock_Price:  98.697755650985
curr_Factors:  [98.69775565]
mat_Sqrt:  [[0.15]]
grads:  [0.07304827]
Stock Position:  0.07304826659123748
Bond Position:  [-7.97684802]


portfolio before change:  [-0.76007]
curr_Stock_Price:  98.80147635417607
curr_Factors:  [98.80147635]
mat_Sqrt:  [[0.15]]
grads:  [-0.09322163]
Stock Position:  -0.09322162724489426
Bond Position:  [8.4503644]


portfolio before change:  [-0.84521075]
curr_Stock_Price:  99.7204574727007
curr_Factors:  [99.72045747]
mat_Sqrt:  [[0.15]]
grads:  [0.01170319]
Stock Position:  0.011703189263033431
Bond Position:  [-2.01225814]


portfolio before change:  [-0.84987299]
curr_Stock_Price:  99.33283059209771
curr_Factors:  [99.33283059]
mat_Sqrt:  [[0.15]]
grads:  [0.01206412]
Stock Position:  0.012064121746747555
Bond Position:  [-2.04823636]


portfolio before change:  [-0.85151796]
curr_Stock_Price:  99.20709035709281
curr_Factors:  [99.20709036]
mat_Sqrt:  [[0.15]]
grads:  [-0.09906437]
Stock Position:  -0.09906436841459298
Bond Position:  [8.97636979]


portfolio before change:  [-0.85075382]
curr_Stock_Price:  99.2050401574144
curr_Factors:  [99.20504016]
mat_Sqrt:  [[0.15]]
grads:  [-0.07204755]
Stock Position:  -0.07204754948616825
Bond Position:  [6.29672622]


portfolio before change:  [-0.8695879]
curr_Stock_Price:  99.47191447105197
curr_Factors:  [99.47191447]
mat_Sqrt:  [[0.15]]
grads:  [0.09171816]
Stock Position:  0.09171815547539061
Bond Position:  [-9.99296842]


portfolio before change:  [-0.8618808]
curr_Stock_Price:  99.56275448345515
curr_Factors:  [99.56275448]
mat_Sqrt:  [[0.15]]
grads:  [-0.03711315]
Stock Position:  -0.0371131518968433
Bond Position:  [2.83320683]


portfolio before change:  [-0.84191787]
curr_Stock_Price:  99.02963207536125
curr_Factors:  [99.02963208]
mat_Sqrt:  [[0.15]]
grads:  [-0.00297073]
Stock Position:  -0.002970726071123998
Bond Position:  [-0.54772796]


portfolio before change:  [-0.8397185]
curr_Stock_Price:  98.27776047568233
curr_Factors:  [98.27776048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891574]
Stock Position:  -0.008915744145370906
Bond Position:  [0.03650087]


portfolio before change:  [-0.84299115]
curr_Stock_Price:  98.64508130925525
curr_Factors:  [98.64508131]
mat_Sqrt:  [[0.15]]
grads:  [-0.02443535]
Stock Position:  -0.02443535212496058
Bond Position:  [1.56743614]


portfolio before change:  [-0.8346969]
curr_Stock_Price:  98.3096541018334
curr_Factors:  [98.3096541]
mat_Sqrt:  [[0.15]]
grads:  [0.04123804]
Stock Position:  0.041238036630096904
Bond Position:  [-4.88879402]


portfolio before change:  [-0.82365443]
curr_Stock_Price:  98.58483761284093
curr_Factors:  [98.58483761]
mat_Sqrt:  [[0.15]]
grads:  [0.01035482]
Stock Position:  0.010354816938282682
Bond Position:  [-1.84448238]


portfolio before change:  [-0.82011925]
curr_Stock_Price:  98.93737615194125
curr_Factors:  [98.93737615]
mat_Sqrt:  [[0.15]]
grads:  [-0.09549315]
Stock Position:  -0.09549314853513498
Bond Position:  [8.62772231]


portfolio before change:  [-0.79714699]
curr_Stock_Price:  98.70245870306361
curr_Factors:  [98.7024587]
mat_Sqrt:  [[0.15]]
grads:  [0.16670186]
Stock Position:  0.16670185730376275
Bond Position:  [-17.25103018]


portfolio before change:  [-0.72621497]
curr_Stock_Price:  99.13442895902574
curr_Factors:  [99.13442896]
mat_Sqrt:  [[0.15]]
grads:  [0.00809777]
Stock Position:  0.00809777382596545
Bond Position:  [-1.52898315]


portfolio before change:  [-0.72517925]
curr_Stock_Price:  99.27413257742796
curr_Factors:  [99.27413258]
mat_Sqrt:  [[0.15]]
grads:  [-0.0277009]
Stock Position:  -0.027700904360240617
Bond Position:  [2.02480401]


portfolio before change:  [-0.72227245]
curr_Stock_Price:  99.17376605877827
curr_Factors:  [99.17376606]
mat_Sqrt:  [[0.15]]
grads:  [0.03431046]
Stock Position:  0.03431046175620798
Bond Position:  [-4.12497016]


portfolio before change:  [-0.70859155]
curr_Stock_Price:  99.58001871733958
curr_Factors:  [99.58001872]
mat_Sqrt:  [[0.15]]
grads:  [0.11697145]
Stock Position:  0.11697144928033065
Bond Position:  [-12.35661066]


portfolio before change:  [-0.56396579]
curr_Stock_Price:  100.82304061418134
curr_Factors:  [100.82304061]
mat_Sqrt:  [[0.15]]
grads:  [0.12892088]
Stock Position:  0.12892088113517106
Bond Position:  [-13.56216102]


portfolio before change:  [-0.63519011]
curr_Stock_Price:  100.27715030849333
curr_Factors:  [100.27715031]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823575]
Stock Position:  -0.028235749825771043
Bond Position:  [2.19621042]


portfolio before change:  [-0.63315787]
curr_Stock_Price:  100.21003794820734
curr_Factors:  [100.21003795]
mat_Sqrt:  [[0.15]]
grads:  [0.032295]
Stock Position:  0.032294999463951216
Bond Position:  [-3.869441]


portfolio before change:  [-0.63221496]
curr_Stock_Price:  100.2467236986369
curr_Factors:  [100.2467237]
mat_Sqrt:  [[0.15]]
grads:  [-0.01037535]
Stock Position:  -0.010375353692949549
Bond Position:  [0.40788026]


portfolio before change:  [-0.6299017]
curr_Stock_Price:  100.02622356555645
curr_Factors:  [100.02622357]
mat_Sqrt:  [[0.15]]
grads:  [0.04811831]
Stock Position:  0.048118307720669704
Bond Position:  [-5.4429943]


portfolio before change:  [-0.63733149]
curr_Stock_Price:  99.87888686639921
curr_Factors:  [99.87888687]
mat_Sqrt:  [[0.15]]
grads:  [0.146598]
Stock Position:  0.14659799810880708
Bond Position:  [-15.27937635]


portfolio before change:  [-0.65904628]
curr_Stock_Price:  99.73727645464837
curr_Factors:  [99.73727645]
mat_Sqrt:  [[0.15]]
grads:  [0.00705604]
Stock Position:  0.007056038690916519
Bond Position:  [-1.36279636]


portfolio before change:  [-0.65845805]
curr_Stock_Price:  99.83271360350199
curr_Factors:  [99.8327136]
mat_Sqrt:  [[0.15]]
grads:  [-0.04849547]
Stock Position:  -0.04849547297688669
Bond Position:  [4.18297662]


portfolio before change:  [-0.66411828]
curr_Stock_Price:  99.95482142351061
curr_Factors:  [99.95482142]
mat_Sqrt:  [[0.15]]
grads:  [0.05810897]
Stock Position:  0.058108970968766285
Bond Position:  [-6.4723901]


portfolio before change:  [-0.6528088]
curr_Stock_Price:  100.1564085201967
curr_Factors:  [100.15640852]
mat_Sqrt:  [[0.15]]
grads:  [0.08160925]
Stock Position:  0.08160925078240432
Bond Position:  [-8.82649826]


portfolio before change:  [-0.65032878]
curr_Stock_Price:  100.19355742962496
curr_Factors:  [100.19355743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00163006]
Stock Position:  -0.0016300590630888522
Bond Position:  [-0.48700736]


portfolio before change:  [-0.64889606]
curr_Stock_Price:  99.29594475212551
curr_Factors:  [99.29594475]
mat_Sqrt:  [[0.15]]
grads:  [0.02799921]
Stock Position:  0.02799921301993192
Bond Position:  [-3.42910437]


portfolio before change:  [-0.65011667]
curr_Stock_Price:  99.26000481658491
curr_Factors:  [99.26000482]
mat_Sqrt:  [[0.15]]
grads:  [0.12912214]
Stock Position:  0.12912214035919964
Bond Position:  [-13.46678095]


portfolio before change:  [-0.65702932]
curr_Stock_Price:  99.21298773505977
curr_Factors:  [99.21298774]
mat_Sqrt:  [[0.15]]
grads:  [-0.00134245]
Stock Position:  -0.0013424488619389035
Bond Position:  [-0.52384096]


portfolio before change:  [-0.6579126]
curr_Stock_Price:  99.84656070173561
curr_Factors:  [99.8465607]
mat_Sqrt:  [[0.15]]
grads:  [0.02282517]
Stock Position:  0.02282516862871111
Bond Position:  [-2.93692718]


portfolio before change:  [-0.64500402]
curr_Stock_Price:  100.4201443557139
curr_Factors:  [100.42014436]
mat_Sqrt:  [[0.15]]
grads:  [-0.37082225]
Stock Position:  -0.3708222512907638
Bond Position:  [36.59301999]


portfolio before change:  [-0.63083202]
curr_Stock_Price:  100.38809433164191
curr_Factors:  [100.38809433]
mat_Sqrt:  [[0.15]]
grads:  [0.07908398]
Stock Position:  0.0790839761662922
Bond Position:  [-8.56992168]


portfolio before change:  [-0.66536119]
curr_Stock_Price:  99.95825340375293
curr_Factors:  [99.9582534]
mat_Sqrt:  [[0.15]]
grads:  [0.0471413]
Stock Position:  0.04714130207739922
Bond Position:  [-5.37752341]


portfolio before change:  [-0.6689038]
curr_Stock_Price:  99.89023445676203
curr_Factors:  [99.89023446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011224]
Stock Position:  -0.020112238296857803
Bond Position:  [1.3401124]


portfolio before change:  [-0.67184328]
curr_Stock_Price:  100.04055307421564
curr_Factors:  [100.04055307]
mat_Sqrt:  [[0.15]]
grads:  [-0.00933494]
Stock Position:  -0.009334941767865446
Bond Position:  [0.26202946]


portfolio before change:  [-0.67416501]
curr_Stock_Price:  100.29102103474462
curr_Factors:  [100.29102103]
mat_Sqrt:  [[0.15]]
grads:  [-0.02587546]
Stock Position:  -0.02587546102814933
Bond Position:  [1.9209114]


portfolio before change:  [-0.68427076]
curr_Stock_Price:  100.6862147079291
curr_Factors:  [100.68621471]
mat_Sqrt:  [[0.15]]
grads:  [0.14407565]
Stock Position:  0.14407564592230038
Bond Position:  [-15.19070218]


portfolio before change:  [-0.71260823]
curr_Stock_Price:  100.49612001814131
curr_Factors:  [100.49612002]
mat_Sqrt:  [[0.15]]
grads:  [0.09902337]
Stock Position:  0.09902337076979037
Bond Position:  [-10.66407278]


portfolio before change:  [-0.67698515]
curr_Stock_Price:  100.86259513133591
curr_Factors:  [100.86259513]
mat_Sqrt:  [[0.15]]
grads:  [0.07215115]
Stock Position:  0.07215114883287979
Bond Position:  [-7.95433726]


portfolio before change:  [-0.64980937]
curr_Stock_Price:  101.246136354929
curr_Factors:  [101.24613635]
mat_Sqrt:  [[0.15]]
grads:  [0.02068169]
Stock Position:  0.02068169463700519
Bond Position:  [-2.74375105]


portfolio before change:  [-0.65683456]
curr_Stock_Price:  100.9147468178043
curr_Factors:  [100.91474682]
mat_Sqrt:  [[0.15]]
grads:  [0.06875701]
Stock Position:  0.06875701446818967
Bond Position:  [-7.59543127]


portfolio before change:  [-0.68454525]
curr_Stock_Price:  100.51862781254243
curr_Factors:  [100.51862781]
mat_Sqrt:  [[0.15]]
grads:  [-0.0115227]
Stock Position:  -0.01152270273018945
Bond Position:  [0.47370102]


portfolio before change:  [-0.6775407]
curr_Stock_Price:  99.91330600972569
curr_Factors:  [99.91330601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01462072]
Stock Position:  -0.014620720133004922
Bond Position:  [0.78326379]


portfolio before change:  [-0.67997164]
curr_Stock_Price:  100.082921153147
curr_Factors:  [100.08292115]
mat_Sqrt:  [[0.15]]
grads:  [-0.05234484]
Stock Position:  -0.052344842809879555
Bond Position:  [4.55885314]


portfolio before change:  [-0.65810489]
curr_Stock_Price:  99.67062043327117
curr_Factors:  [99.67062043]
mat_Sqrt:  [[0.15]]
grads:  [0.01274724]
Stock Position:  0.012747237260730052
Bond Position:  [-1.92862993]


portfolio before change:  [-0.66661511]
curr_Stock_Price:  99.01246341530889
curr_Factors:  [99.01246342]
mat_Sqrt:  [[0.15]]
grads:  [0.0516207]
Stock Position:  0.05162070023090043
Bond Position:  [-5.77770781]


portfolio before change:  [-0.65323861]
curr_Stock_Price:  99.27858961349544
curr_Factors:  [99.27858961]
mat_Sqrt:  [[0.15]]
grads:  [-0.04165276]
Stock Position:  -0.041652758644969194
Bond Position:  [3.48198852]


portfolio before change:  [-0.70985964]
curr_Stock_Price:  100.64317292900903
curr_Factors:  [100.64317293]
mat_Sqrt:  [[0.15]]
grads:  [-0.02560739]
Stock Position:  -0.025607386970983692
Bond Position:  [1.86734904]


portfolio before change:  [-0.70329902]
curr_Stock_Price:  100.39153055530389
curr_Factors:  [100.39153056]
mat_Sqrt:  [[0.15]]
grads:  [0.048274]
Stock Position:  0.0482739983794265
Bond Position:  [-5.54959961]


portfolio before change:  [-0.73763891]
curr_Stock_Price:  99.68736218137747
curr_Factors:  [99.68736218]
mat_Sqrt:  [[0.15]]
grads:  [0.03220333]
Stock Position:  0.0322033307755769
Bond Position:  [-3.947904]


portfolio before change:  [-0.75119]
curr_Stock_Price:  99.27422663022018
curr_Factors:  [99.27422663]
mat_Sqrt:  [[0.15]]
grads:  [0.04938458]
Stock Position:  0.0493845770371051
Bond Position:  [-5.65380569]


portfolio before change:  [-0.73401291]
curr_Stock_Price:  99.62920511082561
curr_Factors:  [99.62920511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678742]
Stock Position:  -0.026787420928993205
Bond Position:  [1.93479654]


portfolio before change:  [-0.70537104]
curr_Stock_Price:  98.56449106804553
curr_Factors:  [98.56449107]
mat_Sqrt:  [[0.15]]
grads:  [-0.017675]
Stock Position:  -0.01767500279669384
Bond Position:  [1.03675662]


portfolio before change:  [-0.70753466]
curr_Stock_Price:  98.69056840752997
curr_Factors:  [98.69056841]
mat_Sqrt:  [[0.15]]
grads:  [0.00890015]
Stock Position:  0.008900152903144512
Bond Position:  [-1.5858958]


portfolio before change:  [-0.69886342]
curr_Stock_Price:  99.67598457117056
curr_Factors:  [99.67598457]
mat_Sqrt:  [[0.15]]
grads:  [-0.04679902]
Stock Position:  -0.04679902358257752
Bond Position:  [3.96587533]


portfolio before change:  [-0.72532865]
curr_Stock_Price:  100.24678923496892
curr_Factors:  [100.24678923]
mat_Sqrt:  [[0.15]]
grads:  [0.05064335]
Stock Position:  0.05064335334719193
Bond Position:  [-5.80216222]


portfolio before change:  [-0.73110444]
curr_Stock_Price:  100.13990168306893
curr_Factors:  [100.13990168]
mat_Sqrt:  [[0.15]]
grads:  [0.15657869]
Stock Position:  0.156578691553461
Bond Position:  [-16.41087922]


portfolio before change:  [-0.74538501]
curr_Stock_Price:  100.05524865398758
curr_Factors:  [100.05524865]
mat_Sqrt:  [[0.15]]
grads:  [0.03661291]
Stock Position:  0.036612907351827075
Bond Position:  [-4.40869856]


portfolio before change:  [-0.70906553]
curr_Stock_Price:  101.05476053569556
curr_Factors:  [101.05476054]
mat_Sqrt:  [[0.15]]
grads:  [0.07116378]
Stock Position:  0.07116377861595735
Bond Position:  [-7.90050414]


portfolio before change:  [-0.69553016]
curr_Stock_Price:  101.2518996169258
curr_Factors:  [101.25189962]
mat_Sqrt:  [[0.15]]
grads:  [0.0140509]
Stock Position:  0.0140508974157003
Bond Position:  [-2.11821022]


portfolio before change:  [-0.69293417]
curr_Stock_Price:  101.44607817587485
curr_Factors:  [101.44607818]
mat_Sqrt:  [[0.15]]
grads:  [0.02069709]
Stock Position:  0.02069708697142864
Bond Position:  [-2.79257248]


portfolio before change:  [-0.68275797]
curr_Stock_Price:  101.94618433484544
curr_Factors:  [101.94618433]
mat_Sqrt:  [[0.15]]
grads:  [0.12674287]
Stock Position:  0.1267428654587187
Bond Position:  [-13.6037095]


portfolio before change:  [-0.80738532]
curr_Stock_Price:  100.96958425463131
curr_Factors:  [100.96958425]
mat_Sqrt:  [[0.15]]
grads:  [0.00242166]
Stock Position:  0.002421657068221025
Bond Position:  [-1.05189903]


portfolio before change:  [-0.80917313]
curr_Stock_Price:  100.25847451286961
curr_Factors:  [100.25847451]
mat_Sqrt:  [[0.15]]
grads:  [-0.10655718]
Stock Position:  -0.10655717769567716
Bond Position:  [9.87408695]


portfolio before change:  [-0.83467079]
curr_Stock_Price:  100.50355242327775
curr_Factors:  [100.50355242]
mat_Sqrt:  [[0.15]]
grads:  [-0.0101935]
Stock Position:  -0.010193495411577961
Bond Position:  [0.18981171]


portfolio before change:  [-0.82886007]
curr_Stock_Price:  99.93467386802958
curr_Factors:  [99.93467387]
mat_Sqrt:  [[0.15]]
grads:  [0.00833193]
Stock Position:  0.008331926475615642
Bond Position:  [-1.66150843]


portfolio before change:  [-0.82627903]
curr_Stock_Price:  100.25691451030626
curr_Factors:  [100.25691451]
mat_Sqrt:  [[0.15]]
grads:  [-0.00051791]
Stock Position:  -0.0005179141032606143
Bond Position:  [-0.77435456]


portfolio before change:  [-0.82648295]
curr_Stock_Price:  100.55718455751425
curr_Factors:  [100.55718456]
mat_Sqrt:  [[0.15]]
grads:  [-0.05415863]
Stock Position:  -0.05415862823817634
Bond Position:  [4.61955623]


portfolio before change:  [-0.82021878]
curr_Stock_Price:  100.4468524462343
curr_Factors:  [100.44685245]
mat_Sqrt:  [[0.15]]
grads:  [-0.02832887]
Stock Position:  -0.028328869708079858
Bond Position:  [2.02532702]


portfolio before change:  [-0.80146163]
curr_Stock_Price:  99.78919945963789
curr_Factors:  [99.78919946]
mat_Sqrt:  [[0.15]]
grads:  [0.05370424]
Stock Position:  0.05370423892482476
Bond Position:  [-6.16056464]


portfolio before change:  [-0.79161676]
curr_Stock_Price:  99.97968551341711
curr_Factors:  [99.97968551]
mat_Sqrt:  [[0.15]]
grads:  [-0.14914856]
Stock Position:  -0.1491485563649602
Bond Position:  [14.120209]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.77746732]
Stock Price:  99.89073461105122
PL:  [-0.77746732]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.34305659e-02]
 [-1.56529171e-02]
 [ 2.44098554e-02]
 [-1.21346825e-02]
 [ 1.10308599e-02]
 [-1.43597903e-02]
 [-1.35724018e-02]
 [ 6.60502582e-02]
 [-2.08766322e-02]
 [-1.29898170e-02]
 [ 7.09982641e-03]
 [-7.34135609e-03]
 [-1.12503276e-04]
 [-5.71082548e-04]
 [-1.78871487e-03]
 [ 4.88462733e-03]
 [-3.25180735e-02]
 [-1.14164740e-02]
 [ 2.49377313e-02]
 [-7.68882328e-04]
 [-5.94146138e-03]
 [ 5.35753230e-03]
 [ 1.47869365e-02]
 [ 2.05539366e-02]
 [-5.20642104e-03]
 [ 4.60751538e-03]
 [ 7.45220757e-03]
 [ 9.57387454e-03]
 [ 1.60442290e-02]
 [ 3.14968346e-02]
 [-7.05189869e-03]
 [ 1.84757583e-02]
 [ 1.21012454e-02]
 [-1.98514078e-02]
 [-1.13536776e-02]
 [ 1.01679090e-03]
 [ 7.50894583e-03]
 [-4.87834071e-04]
 [-3.43977080e-02]
 [-1.72566718e-02]
 [ 7.11848815e-03]
 [ 3.38848473e-02]
 [-2.95720696e-03]
 [ 1.20345109e-03]
 [ 1.83349050e-02]
 [ 1.46836464e-02]
 [ 1.06762696e-02]
 [ 5.20685845e-03]
 [-1.76697734e-03]
 [-9.10882410e-04]
 [-5.57266971e-03]
 [ 1.58482117e-03]
 [ 9.16103307e-04]
 [ 6.19992378e-03]
 [-8.82724805e-03]
 [-4.80084687e-03]
 [-1.46641355e-03]
 [ 1.28623840e-02]
 [ 7.07174178e-03]
 [-2.88477281e-03]
 [-5.11925222e-03]
 [-2.31869300e-03]
 [-1.70411004e-03]
 [-4.31987813e-03]
 [ 1.82776669e-02]
 [ 6.96952686e-03]
 [ 2.03405960e-02]
 [-4.36249254e-03]
 [ 8.93869258e-03]
 [ 2.96430810e-02]
 [ 3.12436821e-03]
 [-1.51110436e-02]
 [-6.04886866e-03]
 [ 3.26144956e-03]
 [ 1.20508791e-02]
 [ 1.24383587e-02]
 [ 2.90042888e-03]
 [-2.52413439e-02]
 [-3.15719529e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.50810365]
curr_Stock_Price:  99.56680289655145
curr_Factors:  [99.5668029]
mat_Sqrt:  [[0.15]]
grads:  [-0.08953711]
Stock Position:  -0.08953710616722763
Bond Position:  [1.40681975]


portfolio before change:  [-7.46622289]
curr_Stock_Price:  99.10003741066622
curr_Factors:  [99.10003741]
mat_Sqrt:  [[0.15]]
grads:  [-0.10435278]
Stock Position:  -0.10435278091583423
Bond Position:  [2.8751416]


portfolio before change:  [-7.46842287]
curr_Stock_Price:  99.12284156812632
curr_Factors:  [99.12284157]
mat_Sqrt:  [[0.15]]
grads:  [0.16273237]
Stock Position:  0.16273236929487356
Bond Position:  [-23.59891773]


portfolio before change:  [-7.56730968]
curr_Stock_Price:  98.52424009663243
curr_Factors:  [98.5242401]
mat_Sqrt:  [[0.15]]
grads:  [-0.08089788]
Stock Position:  -0.08089788365793783
Bond Position:  [0.40309283]


portfolio before change:  [-7.52078561]
curr_Stock_Price:  97.94945522386655
curr_Factors:  [97.94945522]
mat_Sqrt:  [[0.15]]
grads:  [0.07353907]
Stock Position:  0.07353906584187508
Bond Position:  [-14.72389704]


portfolio before change:  [-7.46995228]
curr_Stock_Price:  98.65321181064253
curr_Factors:  [98.65321181]
mat_Sqrt:  [[0.15]]
grads:  [-0.09573194]
Stock Position:  -0.09573193541936602
Bond Position:  [1.97431062]


portfolio before change:  [-7.39361501]
curr_Stock_Price:  97.85709431225852
curr_Factors:  [97.85709431]
mat_Sqrt:  [[0.15]]
grads:  [-0.09048268]
Stock Position:  -0.09048267835285517
Bond Position:  [1.46075698]


portfolio before change:  [-7.36697921]
curr_Stock_Price:  97.56372871746821
curr_Factors:  [97.56372872]
mat_Sqrt:  [[0.15]]
grads:  [0.44033505]
Stock Position:  0.44033505472644474
Bond Position:  [-50.32770903]


portfolio before change:  [-7.22984397]
curr_Stock_Price:  97.88230615642158
curr_Factors:  [97.88230616]
mat_Sqrt:  [[0.15]]
grads:  [-0.13917755]
Stock Position:  -0.1391775479561581
Bond Position:  [6.39317539]


portfolio before change:  [-7.28234076]
curr_Stock_Price:  98.26237015679736
curr_Factors:  [98.26237016]
mat_Sqrt:  [[0.15]]
grads:  [-0.08659878]
Stock Position:  -0.08659877987049458
Bond Position:  [1.2270606]


portfolio before change:  [-7.23820322]
curr_Stock_Price:  97.7535772099739
curr_Factors:  [97.75357721]
mat_Sqrt:  [[0.15]]
grads:  [0.04733218]
Stock Position:  0.04733217607962286
Bond Position:  [-11.86509275]


portfolio before change:  [-7.19948499]
curr_Stock_Price:  98.5872557855573
curr_Factors:  [98.58725579]
mat_Sqrt:  [[0.15]]
grads:  [-0.04894237]
Stock Position:  -0.048942373910189074
Bond Position:  [-2.37439065]


portfolio before change:  [-7.21241018]
curr_Stock_Price:  98.84831353132657
curr_Factors:  [98.84831353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00075002]
Stock Position:  -0.0007500218428808242
Bond Position:  [-7.13827179]


portfolio before change:  [-7.21249736]
curr_Stock_Price:  98.36969079107377
curr_Factors:  [98.36969079]
mat_Sqrt:  [[0.15]]
grads:  [-0.00380722]
Stock Position:  -0.0038072169837052704
Bond Position:  [-6.8379826]


portfolio before change:  [-7.21571048]
curr_Stock_Price:  99.10138947193818
curr_Factors:  [99.10138947]
mat_Sqrt:  [[0.15]]
grads:  [-0.01192477]
Stock Position:  -0.011924765807699196
Bond Position:  [-6.03394962]


portfolio before change:  [-7.20289284]
curr_Stock_Price:  97.99488740412633
curr_Factors:  [97.9948874]
mat_Sqrt:  [[0.15]]
grads:  [0.03256418]
Stock Position:  0.03256418217960308
Bond Position:  [-10.3940162]


portfolio before change:  [-7.23423717]
curr_Stock_Price:  97.05229703732682
curr_Factors:  [97.05229704]
mat_Sqrt:  [[0.15]]
grads:  [-0.21678716]
Stock Position:  -0.2167871565071887
Bond Position:  [13.80545434]


portfolio before change:  [-7.2844105]
curr_Stock_Price:  97.28771779594993
curr_Factors:  [97.2877178]
mat_Sqrt:  [[0.15]]
grads:  [-0.07610983]
Stock Position:  -0.0761098269177855
Bond Position:  [0.12014087]


portfolio before change:  [-7.35664948]
curr_Stock_Price:  98.23695783574358
curr_Factors:  [98.23695784]
mat_Sqrt:  [[0.15]]
grads:  [0.16625154]
Stock Position:  0.16625154231173525
Bond Position:  [-23.68869523]


portfolio before change:  [-7.32414784]
curr_Stock_Price:  98.44136032915931
curr_Factors:  [98.44136033]
mat_Sqrt:  [[0.15]]
grads:  [-0.00512588]
Stock Position:  -0.005125882186559513
Bond Position:  [-6.81954903]


portfolio before change:  [-7.32513318]
curr_Stock_Price:  98.55043524084495
curr_Factors:  [98.55043524]
mat_Sqrt:  [[0.15]]
grads:  [-0.03960974]
Stock Position:  -0.039609742549262875
Bond Position:  [-3.42157581]


portfolio before change:  [-7.3426491]
curr_Stock_Price:  98.9872485146929
curr_Factors:  [98.98724851]
mat_Sqrt:  [[0.15]]
grads:  [0.03571688]
Stock Position:  0.03571688197727974
Bond Position:  [-10.87816497]


portfolio before change:  [-7.36912264]
curr_Stock_Price:  98.26507933437519
curr_Factors:  [98.26507933]
mat_Sqrt:  [[0.15]]
grads:  [0.09857958]
Stock Position:  0.09857957671812584
Bond Position:  [-17.05605256]


portfolio before change:  [-7.39980467]
curr_Stock_Price:  97.96465198582099
curr_Factors:  [97.96465199]
mat_Sqrt:  [[0.15]]
grads:  [0.13702624]
Stock Position:  0.13702624381170633
Bond Position:  [-20.82353296]


portfolio before change:  [-7.32024514]
curr_Stock_Price:  98.55476559062886
curr_Factors:  [98.55476559]
mat_Sqrt:  [[0.15]]
grads:  [-0.03470947]
Stock Position:  -0.03470947360201338
Bond Position:  [-3.8994611]


portfolio before change:  [-7.31822189]
curr_Stock_Price:  98.4894529618277
curr_Factors:  [98.48945296]
mat_Sqrt:  [[0.15]]
grads:  [0.03071677]
Stock Position:  0.03071676916826702
Bond Position:  [-10.34349968]


portfolio before change:  [-7.3252035]
curr_Stock_Price:  98.28320990144499
curr_Factors:  [98.2832099]
mat_Sqrt:  [[0.15]]
grads:  [0.04968138]
Stock Position:  0.04968138383012914
Bond Position:  [-12.20804938]


portfolio before change:  [-7.36238361]
curr_Stock_Price:  97.55019722418572
curr_Factors:  [97.55019722]
mat_Sqrt:  [[0.15]]
grads:  [0.06382583]
Stock Position:  0.06382583026168621
Bond Position:  [-13.58860594]


portfolio before change:  [-7.3566811]
curr_Stock_Price:  97.65284892502035
curr_Factors:  [97.65284893]
mat_Sqrt:  [[0.15]]
grads:  [0.10696153]
Stock Position:  0.10696152659021278
Bond Position:  [-17.80177889]


portfolio before change:  [-7.39311907]
curr_Stock_Price:  97.32258697399733
curr_Factors:  [97.32258697]
mat_Sqrt:  [[0.15]]
grads:  [0.2099789]
Stock Position:  0.20997889748596169
Bond Position:  [-27.82880858]


portfolio before change:  [-7.41793214]
curr_Stock_Price:  97.2127011013948
curr_Factors:  [97.2127011]
mat_Sqrt:  [[0.15]]
grads:  [-0.04701266]
Stock Position:  -0.04701265792331925
Bond Position:  [-2.84770467]


portfolio before change:  [-7.41757576]
curr_Stock_Price:  97.2013347226287
curr_Factors:  [97.20133472]
mat_Sqrt:  [[0.15]]
grads:  [0.12317172]
Stock Position:  0.12317172180669377
Bond Position:  [-19.39003152]


portfolio before change:  [-7.44389951]
curr_Stock_Price:  96.99745810496223
curr_Factors:  [96.9974581]
mat_Sqrt:  [[0.15]]
grads:  [0.08067497]
Stock Position:  0.08067496906038576
Bond Position:  [-15.26916644]


portfolio before change:  [-7.4719811]
curr_Stock_Price:  96.66120457288412
curr_Factors:  [96.66120457]
mat_Sqrt:  [[0.15]]
grads:  [-0.13234272]
Stock Position:  -0.13234271840673892
Bond Position:  [5.32042547]


portfolio before change:  [-7.4747361]
curr_Stock_Price:  96.68453444286858
curr_Factors:  [96.68453444]
mat_Sqrt:  [[0.15]]
grads:  [-0.07569118]
Stock Position:  -0.07569118408518132
Bond Position:  [-0.15656921]


portfolio before change:  [-7.49834764]
curr_Stock_Price:  96.9963508166828
curr_Factors:  [96.99635082]
mat_Sqrt:  [[0.15]]
grads:  [0.00677861]
Stock Position:  0.006778606012675474
Bond Position:  [-8.15584769]


portfolio before change:  [-7.49857626]
curr_Stock_Price:  97.03782439716876
curr_Factors:  [97.0378244]
mat_Sqrt:  [[0.15]]
grads:  [0.05005964]
Stock Position:  0.05005963888217937
Bond Position:  [-12.35625471]


portfolio before change:  [-7.47070371]
curr_Stock_Price:  97.61003879652596
curr_Factors:  [97.6100388]
mat_Sqrt:  [[0.15]]
grads:  [-0.00325223]
Stock Position:  -0.0032522271390720363
Bond Position:  [-7.15325369]


portfolio before change:  [-7.47243498]
curr_Stock_Price:  98.00490055603952
curr_Factors:  [98.00490056]
mat_Sqrt:  [[0.15]]
grads:  [-0.22931805]
Stock Position:  -0.2293180534716764
Bond Position:  [15.00185805]


portfolio before change:  [-7.52854965]
curr_Stock_Price:  98.25369177058933
curr_Factors:  [98.25369177]
mat_Sqrt:  [[0.15]]
grads:  [-0.11504448]
Stock Position:  -0.11504447892657789
Bond Position:  [3.77499512]


portfolio before change:  [-7.45315364]
curr_Stock_Price:  97.60037866382049
curr_Factors:  [97.60037866]
mat_Sqrt:  [[0.15]]
grads:  [0.04745659]
Stock Position:  0.047456587658640664
Bond Position:  [-12.08493457]


portfolio before change:  [-7.48534069]
curr_Stock_Price:  96.93805309955096
curr_Factors:  [96.9380531]
mat_Sqrt:  [[0.15]]
grads:  [0.22589898]
Stock Position:  0.22589898187874033
Bond Position:  [-29.38354819]


portfolio before change:  [-7.26663423]
curr_Stock_Price:  97.91434339755232
curr_Factors:  [97.9143434]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971471]
Stock Position:  -0.019714713042011448
Bond Position:  [-5.33628105]


portfolio before change:  [-7.27588748]
curr_Stock_Price:  98.36678325239502
curr_Factors:  [98.36678325]
mat_Sqrt:  [[0.15]]
grads:  [0.00802301]
Stock Position:  0.008023007291509029
Bond Position:  [-8.0650849]


portfolio before change:  [-7.26738567]
curr_Stock_Price:  99.48929116466873
curr_Factors:  [99.48929116]
mat_Sqrt:  [[0.15]]
grads:  [0.1222327]
Stock Position:  0.12223270026213369
Bond Position:  [-19.42823038]


portfolio before change:  [-7.32860084]
curr_Stock_Price:  98.99841711365856
curr_Factors:  [98.99841711]
mat_Sqrt:  [[0.15]]
grads:  [0.09789098]
Stock Position:  0.09789097579519893
Bond Position:  [-17.01965249]


portfolio before change:  [-7.32660664]
curr_Stock_Price:  99.02965555811195
curr_Factors:  [99.02965556]
mat_Sqrt:  [[0.15]]
grads:  [0.07117513]
Stock Position:  0.07117513077865531
Bond Position:  [-14.37505532]


portfolio before change:  [-7.36725534]
curr_Stock_Price:  98.47117068955812
curr_Factors:  [98.47117069]
mat_Sqrt:  [[0.15]]
grads:  [0.03471239]
Stock Position:  0.03471238966499737
Bond Position:  [-10.78542499]


portfolio before change:  [-7.37055419]
curr_Stock_Price:  98.39555689320964
curr_Factors:  [98.39555689]
mat_Sqrt:  [[0.15]]
grads:  [-0.01177985]
Stock Position:  -0.01177984894121306
Bond Position:  [-6.21146939]


portfolio before change:  [-7.3668317]
curr_Stock_Price:  98.04659511358045
curr_Factors:  [98.04659511]
mat_Sqrt:  [[0.15]]
grads:  [-0.00607255]
Stock Position:  -0.006072549401507074
Bond Position:  [-6.7714389]


portfolio before change:  [-7.36639326]
curr_Stock_Price:  97.90469942721472
curr_Factors:  [97.90469943]
mat_Sqrt:  [[0.15]]
grads:  [-0.03715113]
Stock Position:  -0.03715113137595018
Bond Position:  [-3.72912291]


portfolio before change:  [-7.36263019]
curr_Stock_Price:  97.79713480960669
curr_Factors:  [97.79713481]
mat_Sqrt:  [[0.15]]
grads:  [0.01056547]
Stock Position:  0.010565474476445885
Bond Position:  [-8.39590332]


portfolio before change:  [-7.36327744]
curr_Stock_Price:  97.78554078719105
curr_Factors:  [97.78554079]
mat_Sqrt:  [[0.15]]
grads:  [0.00610736]
Stock Position:  0.006107355381713669
Bond Position:  [-7.96048849]


portfolio before change:  [-7.36467813]
curr_Stock_Price:  97.63766346821455
curr_Factors:  [97.63766347]
mat_Sqrt:  [[0.15]]
grads:  [0.04133283]
Stock Position:  0.041332825174925154
Bond Position:  [-11.4003186]


portfolio before change:  [-7.35741836]
curr_Stock_Price:  97.83054442052239
curr_Factors:  [97.83054442]
mat_Sqrt:  [[0.15]]
grads:  [-0.05884832]
Stock Position:  -0.058848320328634615
Bond Position:  [-1.60025514]


portfolio before change:  [-7.30217683]
curr_Stock_Price:  96.8901344216422
curr_Factors:  [96.89013442]
mat_Sqrt:  [[0.15]]
grads:  [-0.03200565]
Stock Position:  -0.03200564581786348
Bond Position:  [-4.2011455]


portfolio before change:  [-7.2725014]
curr_Stock_Price:  95.95473667096341
curr_Factors:  [95.95473667]
mat_Sqrt:  [[0.15]]
grads:  [-0.00977609]
Stock Position:  -0.009776090342682774
Bond Position:  [-6.33443922]


portfolio before change:  [-7.27634023]
curr_Stock_Price:  96.30691370702222
curr_Factors:  [96.30691371]
mat_Sqrt:  [[0.15]]
grads:  [0.08574923]
Stock Position:  0.08574922657918847
Bond Position:  [-15.53458359]


portfolio before change:  [-7.29915389]
curr_Stock_Price:  96.05218574467216
curr_Factors:  [96.05218574]
mat_Sqrt:  [[0.15]]
grads:  [0.04714495]
Stock Position:  0.04714494520735669
Bond Position:  [-11.82752893]


portfolio before change:  [-7.30234011]
curr_Stock_Price:  96.00028260091614
curr_Factors:  [96.0002826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01923182]
Stock Position:  -0.019231818758866953
Bond Position:  [-5.45608007]


portfolio before change:  [-7.29484366]
curr_Stock_Price:  95.59275678760875
curr_Factors:  [95.59275679]
mat_Sqrt:  [[0.15]]
grads:  [-0.03412835]
Stock Position:  -0.03412834813469931
Bond Position:  [-4.03242078]


portfolio before change:  [-7.29577702]
curr_Stock_Price:  95.61272024579291
curr_Factors:  [95.61272025]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545795]
Stock Position:  -0.015457953361349999
Bond Position:  [-5.81780005]


portfolio before change:  [-7.29667509]
curr_Stock_Price:  95.64729479652661
curr_Factors:  [95.6472948]
mat_Sqrt:  [[0.15]]
grads:  [-0.01136073]
Stock Position:  -0.011360733622891965
Bond Position:  [-6.21005165]


portfolio before change:  [-7.2945023]
curr_Stock_Price:  95.42187548188265
curr_Factors:  [95.42187548]
mat_Sqrt:  [[0.15]]
grads:  [-0.02879919]
Stock Position:  -0.028799187516208576
Bond Position:  [-4.54642982]


portfolio before change:  [-7.29615126]
curr_Stock_Price:  95.4692655343138
curr_Factors:  [95.46926553]
mat_Sqrt:  [[0.15]]
grads:  [0.12185111]
Stock Position:  0.1218511124706635
Bond Position:  [-18.92918747]


portfolio before change:  [-7.36181234]
curr_Stock_Price:  94.9401118290695
curr_Factors:  [94.94011183]
mat_Sqrt:  [[0.15]]
grads:  [0.04646351]
Stock Position:  0.04646351238098007
Bond Position:  [-11.7730634]


portfolio before change:  [-7.36636954]
curr_Stock_Price:  94.85786750077862
curr_Factors:  [94.8578675]
mat_Sqrt:  [[0.15]]
grads:  [0.13560397]
Stock Position:  0.1356039734502056
Bond Position:  [-20.22947328]


portfolio before change:  [-7.39700954]
curr_Stock_Price:  94.64123947929936
curr_Factors:  [94.64123948]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908328]
Stock Position:  -0.029083283575827772
Bond Position:  [-4.64453153]


portfolio before change:  [-7.36824652]
curr_Stock_Price:  93.64227013790095
curr_Factors:  [93.64227014]
mat_Sqrt:  [[0.15]]
grads:  [0.05959128]
Stock Position:  0.059591283857821885
Bond Position:  [-12.94850962]


portfolio before change:  [-7.36937494]
curr_Stock_Price:  93.63691515536478
curr_Factors:  [93.63691516]
mat_Sqrt:  [[0.15]]
grads:  [0.19762054]
Stock Position:  0.19762054004958338
Bond Position:  [-25.87395268]


portfolio before change:  [-7.38197501]
curr_Stock_Price:  93.58133947306085
curr_Factors:  [93.58133947]
mat_Sqrt:  [[0.15]]
grads:  [0.02082912]
Stock Position:  0.02082912140686097
Bond Position:  [-9.33119209]


portfolio before change:  [-7.37283037]
curr_Stock_Price:  94.04837084187797
curr_Factors:  [94.04837084]
mat_Sqrt:  [[0.15]]
grads:  [-0.10074029]
Stock Position:  -0.10074029091233012
Bond Position:  [2.10162986]


portfolio before change:  [-7.32671258]
curr_Stock_Price:  93.591885749317
curr_Factors:  [93.59188575]
mat_Sqrt:  [[0.15]]
grads:  [-0.04032579]
Stock Position:  -0.04032579109134296
Bond Position:  [-3.55254575]


portfolio before change:  [-7.32178038]
curr_Stock_Price:  93.46407082785652
curr_Factors:  [93.46407083]
mat_Sqrt:  [[0.15]]
grads:  [0.021743]
Stock Position:  0.021742997065947418
Bond Position:  [-9.3539694]


portfolio before change:  [-7.31411303]
curr_Stock_Price:  93.84359512830966
curr_Factors:  [93.84359513]
mat_Sqrt:  [[0.15]]
grads:  [0.08033919]
Stock Position:  0.08033919382628603
Bond Position:  [-14.8534318]


portfolio before change:  [-7.29246706]
curr_Stock_Price:  94.12458300027069
curr_Factors:  [94.124583]
mat_Sqrt:  [[0.15]]
grads:  [0.08292239]
Stock Position:  0.0829223911298804
Bond Position:  [-15.09750254]


portfolio before change:  [-7.30356021]
curr_Stock_Price:  94.00218508443297
curr_Factors:  [94.00218508]
mat_Sqrt:  [[0.15]]
grads:  [0.01933619]
Stock Position:  0.01933619253396305
Bond Position:  [-9.12120456]


portfolio before change:  [-7.29697749]
curr_Stock_Price:  94.37210342950561
curr_Factors:  [94.37210343]
mat_Sqrt:  [[0.15]]
grads:  [-0.16827563]
Stock Position:  -0.16827562568346396
Bond Position:  [8.58354726]


portfolio before change:  [-7.29200513]
curr_Stock_Price:  94.34574270362833
curr_Factors:  [94.3457427]
mat_Sqrt:  [[0.15]]
grads:  [-0.21047969]
Stock Position:  -0.21047968566908393
Bond Position:  [12.56585714]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.24555672]
Stock Price:  94.12879530222196
PL:  [-7.24555672]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.33417125e-02]
 [ 1.09980772e-02]
 [ 2.14783355e-02]
 [-3.07856617e-02]
 [-5.40889025e-02]
 [-1.91586945e-03]
 [-3.35633091e-03]
 [-3.73685752e-02]
 [ 9.29295325e-03]
 [-4.83608022e-03]
 [-8.91810640e-03]
 [ 1.54291369e-02]
 [-3.70904409e-03]
 [ 3.78917038e-03]
 [ 4.16986925e-03]
 [ 1.60734259e-02]
 [ 5.55750718e-02]
 [-1.47367242e-02]
 [ 1.76314082e-02]
 [ 1.91945518e-03]
 [-3.75677630e-03]
 [ 4.45704730e-03]
 [ 1.35459592e-02]
 [ 2.78632978e-02]
 [-1.47794647e-03]
 [ 5.44595487e-03]
 [ 2.57788675e-03]
 [ 7.98642133e-03]
 [ 1.60901577e-02]
 [ 2.73585955e-03]
 [-6.43544683e-03]
 [ 1.52905421e-02]
 [ 1.15977534e-02]
 [-1.82396629e-02]
 [-3.55461689e-03]
 [ 1.46561092e-02]
 [ 9.81246961e-03]
 [ 4.17777397e-04]
 [-1.10891138e-02]
 [-1.33584357e-02]
 [ 7.12041192e-03]
 [ 3.23546140e-02]
 [-2.98960453e-03]
 [ 3.32322904e-03]
 [-9.54433962e-03]
 [ 1.67294318e-02]
 [ 9.73606766e-03]
 [ 5.30702485e-03]
 [-5.80813049e-03]
 [-1.12094663e-03]
 [-6.97834276e-03]
 [-2.20316530e-03]
 [ 1.59463039e-03]
 [ 7.54087334e-03]
 [-9.25398045e-03]
 [-4.61312509e-03]
 [-1.13183602e-03]
 [ 1.24573580e-02]
 [ 7.97411073e-03]
 [-3.56437221e-03]
 [-4.65421548e-03]
 [-4.15392654e-04]
 [-6.03048714e-03]
 [ 1.28180907e-03]
 [ 2.00495451e-02]
 [ 5.51492926e-03]
 [ 8.01759364e-03]
 [-5.03452991e-04]
 [ 2.93255239e-03]
 [ 2.19120697e-02]
 [ 1.65592977e-03]
 [-1.59847432e-02]
 [-4.22278139e-03]
 [ 1.26752266e-03]
 [-1.48519156e-04]
 [-1.00658179e-02]
 [-4.33502123e-03]
 [ 1.59236415e-02]
 [-1.16619748e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.76069872]
curr_Stock_Price:  99.94235495495134
curr_Factors:  [99.94235495]
mat_Sqrt:  [[0.15]]
grads:  [-0.08894475]
Stock Position:  -0.088944750328938
Bond Position:  [9.65004652]


portfolio before change:  [0.75535614]
curr_Stock_Price:  100.00920230827195
curr_Factors:  [100.00920231]
mat_Sqrt:  [[0.15]]
grads:  [0.07332051]
Stock Position:  0.0733205148972239
Bond Position:  [-6.57737007]


portfolio before change:  [0.80532173]
curr_Stock_Price:  100.69627719066682
curr_Factors:  [100.69627719]
mat_Sqrt:  [[0.15]]
grads:  [0.1431889]
Stock Position:  0.14318890338463186
Bond Position:  [-13.61326778]


portfolio before change:  [0.92023899]
curr_Stock_Price:  101.50477644411586
curr_Factors:  [101.50477644]
mat_Sqrt:  [[0.15]]
grads:  [-0.20523774]
Stock Position:  -0.20523774473157097
Bond Position:  [21.75285039]


portfolio before change:  [0.76645426]
curr_Stock_Price:  102.26070137611866
curr_Factors:  [102.26070138]
mat_Sqrt:  [[0.15]]
grads:  [-0.36059268]
Stock Position:  -0.36059268350219126
Bond Position:  [37.64091499]


portfolio before change:  [0.65947452]
curr_Stock_Price:  102.56390321972016
curr_Factors:  [102.56390322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01277246]
Stock Position:  -0.012772463004333231
Bond Position:  [1.96946818]


portfolio before change:  [0.6743071]
curr_Stock_Price:  101.41224713660975
curr_Factors:  [101.41224714]
mat_Sqrt:  [[0.15]]
grads:  [-0.02237554]
Stock Position:  -0.02237553939019716
Bond Position:  [2.94346083]


portfolio before change:  [0.67078265]
curr_Stock_Price:  101.57798306830448
curr_Factors:  [101.57798307]
mat_Sqrt:  [[0.15]]
grads:  [-0.24912383]
Stock Position:  -0.24912383478101477
Bond Position:  [25.97627932]


portfolio before change:  [0.81859807]
curr_Stock_Price:  100.99115902095491
curr_Factors:  [100.99115902]
mat_Sqrt:  [[0.15]]
grads:  [0.06195302]
Stock Position:  0.06195302169737081
Bond Position:  [-5.4381094]


portfolio before change:  [0.85374749]
curr_Stock_Price:  101.56400137364012
curr_Factors:  [101.56400137]
mat_Sqrt:  [[0.15]]
grads:  [-0.03224053]
Stock Position:  -0.03224053479809361
Bond Position:  [4.12822521]


portfolio before change:  [0.85877017]
curr_Stock_Price:  101.4162168227333
curr_Factors:  [101.41621682]
mat_Sqrt:  [[0.15]]
grads:  [-0.05945404]
Stock Position:  -0.05945404267014949
Bond Position:  [6.88837425]


portfolio before change:  [0.84282933]
curr_Stock_Price:  101.6915786760694
curr_Factors:  [101.69157868]
mat_Sqrt:  [[0.15]]
grads:  [0.10286091]
Stock Position:  0.10286091264473213
Bond Position:  [-9.61725926]


portfolio before change:  [0.82452288]
curr_Stock_Price:  101.51944961053688
curr_Factors:  [101.51944961]
mat_Sqrt:  [[0.15]]
grads:  [-0.02472696]
Stock Position:  -0.02472696060142058
Bond Position:  [3.33479031]


portfolio before change:  [0.81760689]
curr_Stock_Price:  101.80757304808213
curr_Factors:  [101.80757305]
mat_Sqrt:  [[0.15]]
grads:  [0.02526114]
Stock Position:  0.025261135895179494
Bond Position:  [-1.75416804]


portfolio before change:  [0.82316731]
curr_Stock_Price:  102.03203090499436
curr_Factors:  [102.0320309]
mat_Sqrt:  [[0.15]]
grads:  [0.02779913]
Stock Position:  0.02779912833754014
Bond Position:  [-2.01323421]


portfolio before change:  [0.79791063]
curr_Stock_Price:  101.12801515046137
curr_Factors:  [101.12801515]
mat_Sqrt:  [[0.15]]
grads:  [0.10715617]
Stock Position:  0.10715617272565772
Bond Position:  [-10.03858042]


portfolio before change:  [0.78504221]
curr_Stock_Price:  101.01378009345069
curr_Factors:  [101.01378009]
mat_Sqrt:  [[0.15]]
grads:  [0.37050048]
Stock Position:  0.37050047899512584
Bond Position:  [-36.6406117]


portfolio before change:  [0.62268741]
curr_Stock_Price:  100.5817572003017
curr_Factors:  [100.5817572]
mat_Sqrt:  [[0.15]]
grads:  [-0.09824483]
Stock Position:  -0.09824482815739721
Bond Position:  [10.50432486]


portfolio before change:  [0.59066753]
curr_Stock_Price:  100.91435912326892
curr_Factors:  [100.91435912]
mat_Sqrt:  [[0.15]]
grads:  [0.11754272]
Stock Position:  0.11754272153270953
Bond Position:  [-11.27108088]


portfolio before change:  [0.5915425]
curr_Stock_Price:  100.9277961808227
curr_Factors:  [100.92779618]
mat_Sqrt:  [[0.15]]
grads:  [0.01279637]
Stock Position:  0.012796367860088418
Bond Position:  [-0.69996671]


portfolio before change:  [0.59379847]
curr_Stock_Price:  101.10751247793505
curr_Factors:  [101.10751248]
mat_Sqrt:  [[0.15]]
grads:  [-0.02504518]
Stock Position:  -0.02504517530467134
Bond Position:  [3.12605384]


portfolio before change:  [0.59454828]
curr_Stock_Price:  101.08537531448516
curr_Factors:  [101.08537531]
mat_Sqrt:  [[0.15]]
grads:  [0.02971365]
Stock Position:  0.02971364865655063
Bond Position:  [-2.40906705]


portfolio before change:  [0.60390479]
curr_Stock_Price:  101.40533204229445
curr_Factors:  [101.40533204]
mat_Sqrt:  [[0.15]]
grads:  [0.09030639]
Stock Position:  0.0903063945222863
Bond Position:  [-8.55364513]


portfolio before change:  [0.65451811]
curr_Stock_Price:  101.97171432405736
curr_Factors:  [101.97171432]
mat_Sqrt:  [[0.15]]
grads:  [0.18575532]
Stock Position:  0.18575531845787333
Bond Position:  [-18.28727016]


portfolio before change:  [0.56119611]
curr_Stock_Price:  101.4754754489795
curr_Factors:  [101.47547545]
mat_Sqrt:  [[0.15]]
grads:  [-0.00985298]
Stock Position:  -0.0098529764713206
Bond Position:  [1.56103158]


portfolio before change:  [0.57182628]
curr_Stock_Price:  100.40649842587831
curr_Factors:  [100.40649843]
mat_Sqrt:  [[0.15]]
grads:  [0.03630637]
Stock Position:  0.036306365815837835
Bond Position:  [-3.07356878]


portfolio before change:  [0.55224229]
curr_Stock_Price:  99.87238019453443
curr_Factors:  [99.87238019]
mat_Sqrt:  [[0.15]]
grads:  [0.01718591]
Stock Position:  0.017185911662593093
Bond Position:  [-1.16415562]


portfolio before change:  [0.54406754]
curr_Stock_Price:  99.40094829924443
curr_Factors:  [99.4009483]
mat_Sqrt:  [[0.15]]
grads:  [0.05324281]
Stock Position:  0.053242808847815765
Bond Position:  [-4.74831815]


portfolio before change:  [0.54092684]
curr_Stock_Price:  99.34753412623829
curr_Factors:  [99.34753413]
mat_Sqrt:  [[0.15]]
grads:  [0.10726772]
Stock Position:  0.10726771794464302
Bond Position:  [-10.11585643]


portfolio before change:  [0.49232529]
curr_Stock_Price:  98.90034190667849
curr_Factors:  [98.90034191]
mat_Sqrt:  [[0.15]]
grads:  [0.01823906]
Stock Position:  0.018239063671505625
Bond Position:  [-1.31152434]


portfolio before change:  [0.48726513]
curr_Stock_Price:  98.62740081017316
curr_Factors:  [98.62740081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04290298]
Stock Position:  -0.042902978857096596
Bond Position:  [4.71867442]


portfolio before change:  [0.51702367]
curr_Stock_Price:  97.94065099883504
curr_Factors:  [97.940651]
mat_Sqrt:  [[0.15]]
grads:  [0.10193695]
Stock Position:  0.10193694745197922
Bond Position:  [-9.46674733]


portfolio before change:  [0.62689141]
curr_Stock_Price:  99.02425642886061
curr_Factors:  [99.02425643]
mat_Sqrt:  [[0.15]]
grads:  [0.07731836]
Stock Position:  0.077318356038346
Bond Position:  [-7.02950131]


portfolio before change:  [0.59067572]
curr_Stock_Price:  98.56154189045401
curr_Factors:  [98.56154189]
mat_Sqrt:  [[0.15]]
grads:  [-0.12159775]
Stock Position:  -0.12159775239002062
Bond Position:  [12.57553769]


portfolio before change:  [0.62002326]
curr_Stock_Price:  98.32665640760518
curr_Factors:  [98.32665641]
mat_Sqrt:  [[0.15]]
grads:  [-0.02369745]
Stock Position:  -0.023697445902564538
Bond Position:  [2.95011388]


portfolio before change:  [0.64086429]
curr_Stock_Price:  97.45497448089118
curr_Factors:  [97.45497448]
mat_Sqrt:  [[0.15]]
grads:  [0.09770739]
Stock Position:  0.09770739445526708
Bond Position:  [-8.88120735]


portfolio before change:  [0.53194757]
curr_Stock_Price:  96.34593230459676
curr_Factors:  [96.3459323]
mat_Sqrt:  [[0.15]]
grads:  [0.06541646]
Stock Position:  0.06541646404750154
Bond Position:  [-5.77066264]


portfolio before change:  [0.65186939]
curr_Stock_Price:  98.184651276704
curr_Factors:  [98.18465128]
mat_Sqrt:  [[0.15]]
grads:  [0.00278518]
Stock Position:  0.0027851826497083307
Bond Position:  [0.3784072]


portfolio before change:  [0.64875834]
curr_Stock_Price:  97.05916080787696
curr_Factors:  [97.05916081]
mat_Sqrt:  [[0.15]]
grads:  [-0.07392743]
Stock Position:  -0.07392742538774247
Bond Position:  [7.82409221]


portfolio before change:  [0.63922515]
curr_Stock_Price:  97.19472901880195
curr_Factors:  [97.19472902]
mat_Sqrt:  [[0.15]]
grads:  [-0.08905624]
Stock Position:  -0.08905623779184144
Bond Position:  [9.29502205]


portfolio before change:  [0.60105582]
curr_Stock_Price:  97.62985058435069
curr_Factors:  [97.62985058]
mat_Sqrt:  [[0.15]]
grads:  [0.04746941]
Stock Position:  0.047469412829470065
Bond Position:  [-4.03337586]


portfolio before change:  [0.58060022]
curr_Stock_Price:  97.2042394363194
curr_Factors:  [97.20423944]
mat_Sqrt:  [[0.15]]
grads:  [0.21569743]
Stock Position:  0.21569742672066855
Bond Position:  [-20.3861041]


portfolio before change:  [0.71504048]
curr_Stock_Price:  97.83342837404977
curr_Factors:  [97.83342837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0199307]
Stock Position:  -0.01993069687240293
Bond Position:  [2.66492889]


portfolio before change:  [0.71769012]
curr_Stock_Price:  97.70884305094273
curr_Factors:  [97.70884305]
mat_Sqrt:  [[0.15]]
grads:  [0.02215486]
Stock Position:  0.0221548602369088
Bond Position:  [-1.44703565]


portfolio before change:  [0.72001732]
curr_Stock_Price:  97.81796783908776
curr_Factors:  [97.81796784]
mat_Sqrt:  [[0.15]]
grads:  [-0.06362893]
Stock Position:  -0.06362893082964191
Bond Position:  [6.94407003]


portfolio before change:  [0.71820446]
curr_Stock_Price:  97.85328004537391
curr_Factors:  [97.85328005]
mat_Sqrt:  [[0.15]]
grads:  [0.11152955]
Stock Position:  0.11152954555611073
Bond Position:  [-10.1953274]


portfolio before change:  [0.59354274]
curr_Stock_Price:  96.74124743098753
curr_Factors:  [96.74124743]
mat_Sqrt:  [[0.15]]
grads:  [0.06490712]
Stock Position:  0.06490711774187252
Bond Position:  [-5.6856528]


portfolio before change:  [0.61606483]
curr_Stock_Price:  97.09371201867393
curr_Factors:  [97.09371202]
mat_Sqrt:  [[0.15]]
grads:  [0.03538017]
Stock Position:  0.03538016568474365
Bond Position:  [-2.81912678]


portfolio before change:  [0.63854776]
curr_Stock_Price:  97.73415930705372
curr_Factors:  [97.73415931]
mat_Sqrt:  [[0.15]]
grads:  [-0.03872087]
Stock Position:  -0.03872086992073923
Bond Position:  [4.42289943]


portfolio before change:  [0.61918331]
curr_Stock_Price:  98.24140251951398
curr_Factors:  [98.24140252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00747298]
Stock Position:  -0.007472977504576548
Bond Position:  [1.3533391]


portfolio before change:  [0.61537288]
curr_Stock_Price:  98.76261494238122
curr_Factors:  [98.76261494]
mat_Sqrt:  [[0.15]]
grads:  [-0.04652229]
Stock Position:  -0.04652228508660275
Bond Position:  [5.21003541]


portfolio before change:  [0.59716378]
curr_Stock_Price:  99.16102055153145
curr_Factors:  [99.16102055]
mat_Sqrt:  [[0.15]]
grads:  [-0.01468777]
Stock Position:  -0.014687768690821973
Bond Position:  [2.05361791]


portfolio before change:  [0.59832529]
curr_Stock_Price:  99.09067976329352
curr_Factors:  [99.09067976]
mat_Sqrt:  [[0.15]]
grads:  [0.01063087]
Stock Position:  0.010630869262013147
Bond Position:  [-0.45509478]


portfolio before change:  [0.58863971]
curr_Stock_Price:  98.18227504443007
curr_Factors:  [98.18227504]
mat_Sqrt:  [[0.15]]
grads:  [0.05027249]
Stock Position:  0.050272488934479595
Bond Position:  [-4.34722763]


portfolio before change:  [0.55566155]
curr_Stock_Price:  97.53169155972401
curr_Factors:  [97.53169156]
mat_Sqrt:  [[0.15]]
grads:  [-0.0616932]
Stock Position:  -0.06169320297060357
Bond Position:  [6.57270399]


portfolio before change:  [0.53957313]
curr_Stock_Price:  97.79913154880028
curr_Factors:  [97.79913155]
mat_Sqrt:  [[0.15]]
grads:  [-0.03075417]
Stock Position:  -0.030754167278471533
Bond Position:  [3.54730398]


portfolio before change:  [0.56531135]
curr_Stock_Price:  96.96943871807447
curr_Factors:  [96.96943872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00754557]
Stock Position:  -0.007545573472699735
Bond Position:  [1.29700138]


portfolio before change:  [0.56528671]
curr_Stock_Price:  96.98344746371465
curr_Factors:  [96.98344746]
mat_Sqrt:  [[0.15]]
grads:  [0.08304905]
Stock Position:  0.08304905302649652
Bond Position:  [-7.48909676]


portfolio before change:  [0.56803447]
curr_Stock_Price:  97.02216964695191
curr_Factors:  [97.02216965]
mat_Sqrt:  [[0.15]]
grads:  [0.05316074]
Stock Position:  0.053160738198040604
Bond Position:  [-4.58973569]


portfolio before change:  [0.59673235]
curr_Stock_Price:  97.56739806820953
curr_Factors:  [97.56739807]
mat_Sqrt:  [[0.15]]
grads:  [-0.02376248]
Stock Position:  -0.023762481410929247
Bond Position:  [2.91517583]


portfolio before change:  [0.59679882]
curr_Stock_Price:  97.57226851229414
curr_Factors:  [97.57226851]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310281]
Stock Position:  -0.031028103211979918
Bond Position:  [3.62428124]


portfolio before change:  [0.59346586]
curr_Stock_Price:  97.68698656315797
curr_Factors:  [97.68698656]
mat_Sqrt:  [[0.15]]
grads:  [-0.00276928]
Stock Position:  -0.0027692843627387213
Bond Position:  [0.8639889]


portfolio before change:  [0.59131379]
curr_Stock_Price:  98.48360766089597
curr_Factors:  [98.48360766]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020325]
Stock Position:  -0.04020324763279434
Bond Position:  [4.55067466]


portfolio before change:  [0.60176573]
curr_Stock_Price:  98.23070486915798
curr_Factors:  [98.23070487]
mat_Sqrt:  [[0.15]]
grads:  [0.00854539]
Stock Position:  0.008545393787682142
Bond Position:  [-0.23765433]


portfolio before change:  [0.6125904]
curr_Stock_Price:  99.49916943629417
curr_Factors:  [99.49916944]
mat_Sqrt:  [[0.15]]
grads:  [0.13366363]
Stock Position:  0.13366363369866394
Bond Position:  [-12.68683013]


portfolio before change:  [0.70913839]
curr_Stock_Price:  100.22742241383817
curr_Factors:  [100.22742241]
mat_Sqrt:  [[0.15]]
grads:  [0.0367662]
Stock Position:  0.03676619506790367
Bond Position:  [-2.97584257]


portfolio before change:  [0.68210025]
curr_Stock_Price:  99.49707358316516
curr_Factors:  [99.49707358]
mat_Sqrt:  [[0.15]]
grads:  [0.05345062]
Stock Position:  0.053450624289793074
Bond Position:  [-4.63608045]


portfolio before change:  [0.68622629]
curr_Stock_Price:  99.57968817251316
curr_Factors:  [99.57968817]
mat_Sqrt:  [[0.15]]
grads:  [-0.00335635]
Stock Position:  -0.003356353271463765
Bond Position:  [1.0204509]


portfolio before change:  [0.68433348]
curr_Stock_Price:  100.16263821274164
curr_Factors:  [100.16263821]
mat_Sqrt:  [[0.15]]
grads:  [0.01955035]
Stock Position:  0.019550349264916507
Bond Position:  [-1.27388108]


portfolio before change:  [0.68174305]
curr_Stock_Price:  100.03421042569414
curr_Factors:  [100.03421043]
mat_Sqrt:  [[0.15]]
grads:  [0.14608046]
Stock Position:  0.14608046442844752
Bond Position:  [-13.93130087]


portfolio before change:  [0.61070417]
curr_Stock_Price:  99.55387141492365
curr_Factors:  [99.55387141]
mat_Sqrt:  [[0.15]]
grads:  [0.01103953]
Stock Position:  0.011039531768644206
Bond Position:  [-0.48832395]


portfolio before change:  [0.61822113]
curr_Stock_Price:  100.23754900421744
curr_Factors:  [100.237549]
mat_Sqrt:  [[0.15]]
grads:  [-0.10656495]
Stock Position:  -0.10656495491675129
Bond Position:  [11.30003102]


portfolio before change:  [0.67050463]
curr_Stock_Price:  99.75355097728117
curr_Factors:  [99.75355098]
mat_Sqrt:  [[0.15]]
grads:  [-0.02815188]
Stock Position:  -0.028151875907929544
Bond Position:  [3.47875422]


portfolio before change:  [0.66137053]
curr_Stock_Price:  100.08573256880076
curr_Factors:  [100.08573257]
mat_Sqrt:  [[0.15]]
grads:  [0.00845015]
Stock Position:  0.00845015109594794
Bond Position:  [-0.18436904]


portfolio before change:  [0.66339137]
curr_Stock_Price:  100.32624445689169
curr_Factors:  [100.32624446]
mat_Sqrt:  [[0.15]]
grads:  [-0.00099013]
Stock Position:  -0.0009901277042126632
Bond Position:  [0.76272716]


portfolio before change:  [0.66294624]
curr_Stock_Price:  100.82395537753864
curr_Factors:  [100.82395538]
mat_Sqrt:  [[0.15]]
grads:  [-0.06710545]
Stock Position:  -0.06710545254965508
Bond Position:  [7.42878339]


portfolio before change:  [0.63565023]
curr_Stock_Price:  101.23763746444466
curr_Factors:  [101.23763746]
mat_Sqrt:  [[0.15]]
grads:  [-0.02890014]
Stock Position:  -0.028900141557617866
Bond Position:  [3.56143228]


portfolio before change:  [0.63841813]
curr_Stock_Price:  101.14956502269297
curr_Factors:  [101.14956502]
mat_Sqrt:  [[0.15]]
grads:  [0.10615761]
Stock Position:  0.10615760986609417
Bond Position:  [-10.09937793]


portfolio before change:  [0.63965452]
curr_Stock_Price:  101.16715791620923
curr_Factors:  [101.16715792]
mat_Sqrt:  [[0.15]]
grads:  [-0.0777465]
Stock Position:  -0.07774649871317728
Bond Position:  [8.50504683]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.62954323]
Stock Price:  101.30404988399442
PL:  [-0.67450665]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.18475798e-02]
 [ 5.72432878e-03]
 [ 9.81020011e-03]
 [-9.53150662e-03]
 [-7.25791277e-03]
 [-1.17601530e-03]
 [-6.21761439e-03]
 [-3.22639437e-02]
 [ 1.21152871e-02]
 [-1.42678376e-03]
 [-9.15117593e-03]
 [ 6.79435654e-03]
 [-4.02744779e-03]
 [ 5.03470129e-03]
 [ 3.72161543e-04]
 [ 1.60952843e-02]
 [ 7.14115874e-02]
 [-1.43766327e-02]
 [ 1.83466301e-02]
 [ 1.57399514e-03]
 [-3.74049482e-03]
 [ 4.48385246e-03]
 [ 1.44050201e-02]
 [ 2.04477576e-02]
 [-3.59632759e-03]
 [ 6.90502815e-03]
 [-8.03033049e-03]
 [ 5.64913969e-03]
 [ 3.45711814e-02]
 [ 2.36473510e-03]
 [-7.22242284e-03]
 [ 9.60724586e-03]
 [ 1.19727997e-02]
 [-7.64798879e-03]
 [ 4.48441247e-03]
 [ 1.84457919e-02]
 [-1.01623163e-02]
 [ 2.15719145e-03]
 [-3.28081474e-02]
 [-1.62678104e-02]
 [ 7.16159489e-03]
 [ 2.13343354e-02]
 [-2.14137538e-03]
 [-2.21005358e-03]
 [ 2.29538281e-02]
 [ 1.48169436e-02]
 [ 1.07824356e-02]
 [ 3.91713239e-03]
 [ 9.15439466e-03]
 [-1.55012433e-03]
 [ 4.32325516e-03]
 [-1.25886952e-02]
 [ 2.21724660e-03]
 [ 1.83509310e-03]
 [-3.74277918e-03]
 [-3.95461522e-03]
 [ 7.51415039e-03]
 [ 4.07411854e-03]
 [ 7.31608514e-03]
 [-4.02258735e-03]
 [-2.46835923e-04]
 [ 5.01749814e-03]
 [-7.40997794e-03]
 [ 7.62852520e-03]
 [ 2.37489814e-02]
 [ 5.51873398e-03]
 [ 1.00652473e-02]
 [-4.06600948e-04]
 [ 2.64468947e-03]
 [ 2.20737927e-02]
 [ 2.82026890e-03]
 [-1.59328925e-02]
 [-5.46802051e-03]
 [ 9.86080251e-04]
 [ 7.04665346e-03]
 [ 2.48764478e-04]
 [-1.47966526e-03]
 [-1.09405376e-02]
 [-2.30157358e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.21883228]
curr_Stock_Price:  100.00858039315743
curr_Factors:  [100.00858039]
mat_Sqrt:  [[0.15]]
grads:  [-0.07898387]
Stock Position:  -0.07898386529163827
Bond Position:  [10.11789652]


portfolio before change:  [2.23748114]
curr_Stock_Price:  99.78047714407217
curr_Factors:  [99.78047714]
mat_Sqrt:  [[0.15]]
grads:  [0.03816219]
Stock Position:  0.03816219187589825
Bond Position:  [-1.57036057]


portfolio before change:  [2.25660093]
curr_Stock_Price:  100.28406287109543
curr_Factors:  [100.28406287]
mat_Sqrt:  [[0.15]]
grads:  [0.06540133]
Stock Position:  0.06540133406298672
Bond Position:  [-4.30211057]


portfolio before change:  [2.26274555]
curr_Stock_Price:  100.38212686541675
curr_Factors:  [100.38212687]
mat_Sqrt:  [[0.15]]
grads:  [-0.06354338]
Stock Position:  -0.06354337744577493
Bond Position:  [8.64136493]


portfolio before change:  [2.24255165]
curr_Stock_Price:  100.70842373307599
curr_Factors:  [100.70842373]
mat_Sqrt:  [[0.15]]
grads:  [-0.04838609]
Stock Position:  -0.04838608511283141
Bond Position:  [7.11543801]


portfolio before change:  [2.22947117]
curr_Stock_Price:  100.98795044287965
curr_Factors:  [100.98795044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0078401]
Stock Position:  -0.007840102009528293
Bond Position:  [3.02122701]


portfolio before change:  [2.22758067]
curr_Stock_Price:  101.25316862456383
curr_Factors:  [101.25316862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04145076]
Stock Position:  -0.04145076258839087
Bond Position:  [6.42460172]


portfolio before change:  [2.22789914]
curr_Stock_Price:  101.25517281066412
curr_Factors:  [101.25517281]
mat_Sqrt:  [[0.15]]
grads:  [-0.21509296]
Stock Position:  -0.21509295796692623
Bond Position:  [24.00717377]


portfolio before change:  [2.23067633]
curr_Stock_Price:  101.24923726545099
curr_Factors:  [101.24923727]
mat_Sqrt:  [[0.15]]
grads:  [0.08076858]
Stock Position:  0.08076858046277803
Bond Position:  [-5.94708083]


portfolio before change:  [2.21776881]
curr_Stock_Price:  101.09403060744253
curr_Factors:  [101.09403061]
mat_Sqrt:  [[0.15]]
grads:  [-0.00951189]
Stock Position:  -0.009511891738267544
Bond Position:  [3.17936428]


portfolio before change:  [2.21378088]
curr_Stock_Price:  101.53417911518888
curr_Factors:  [101.53417912]
mat_Sqrt:  [[0.15]]
grads:  [-0.06100784]
Stock Position:  -0.061007839555044616
Bond Position:  [8.40816179]


portfolio before change:  [2.24571745]
curr_Stock_Price:  101.01931012788145
curr_Factors:  [101.01931013]
mat_Sqrt:  [[0.15]]
grads:  [0.04529571]
Stock Position:  0.04529571026939055
Bond Position:  [-2.33002395]


portfolio before change:  [2.28761747]
curr_Stock_Price:  101.9475579970117
curr_Factors:  [101.947558]
mat_Sqrt:  [[0.15]]
grads:  [-0.02684965]
Stock Position:  -0.026849651957930126
Bond Position:  [5.02487392]


portfolio before change:  [2.30003783]
curr_Stock_Price:  101.49666584589824
curr_Factors:  [101.49666585]
mat_Sqrt:  [[0.15]]
grads:  [0.03356468]
Stock Position:  0.03356467525517333
Bond Position:  [-1.1066648]


portfolio before change:  [2.28973817]
curr_Stock_Price:  101.1918666919453
curr_Factors:  [101.19186669]
mat_Sqrt:  [[0.15]]
grads:  [0.00248108]
Stock Position:  0.002481076951942561
Bond Position:  [2.03867337]


portfolio before change:  [2.28936632]
curr_Stock_Price:  100.99063405673174
curr_Factors:  [100.99063406]
mat_Sqrt:  [[0.15]]
grads:  [0.1073019]
Stock Position:  0.10730189561335388
Bond Position:  [-8.54712015]


portfolio before change:  [2.34946118]
curr_Stock_Price:  101.55566668208128
curr_Factors:  [101.55566668]
mat_Sqrt:  [[0.15]]
grads:  [0.47607725]
Stock Position:  0.47607724920430455
Bond Position:  [-45.99888125]


portfolio before change:  [2.07547464]
curr_Stock_Price:  100.9861970797832
curr_Factors:  [100.98619708]
mat_Sqrt:  [[0.15]]
grads:  [-0.09584422]
Stock Position:  -0.09584421813865364
Bond Position:  [11.75441774]


portfolio before change:  [2.03820504]
curr_Stock_Price:  101.38271842966014
curr_Factors:  [101.38271843]
mat_Sqrt:  [[0.15]]
grads:  [0.12231087]
Stock Position:  0.12231086724513741
Bond Position:  [-10.36200318]


portfolio before change:  [2.02580257]
curr_Stock_Price:  101.28661233439578
curr_Factors:  [101.28661233]
mat_Sqrt:  [[0.15]]
grads:  [0.0104933]
Stock Position:  0.010493300962947054
Bond Position:  [0.96297166]


portfolio before change:  [2.0241924]
curr_Stock_Price:  101.12742887916707
curr_Factors:  [101.12742888]
mat_Sqrt:  [[0.15]]
grads:  [-0.02493663]
Stock Position:  -0.024936632115175307
Bond Position:  [4.54596989]


portfolio before change:  [2.023851]
curr_Stock_Price:  101.1525137979886
curr_Factors:  [101.1525138]
mat_Sqrt:  [[0.15]]
grads:  [0.02989235]
Stock Position:  0.02989234970362955
Bond Position:  [-0.99983532]


portfolio before change:  [2.02284362]
curr_Stock_Price:  101.12090420348378
curr_Factors:  [101.1209042]
mat_Sqrt:  [[0.15]]
grads:  [0.09603347]
Stock Position:  0.09603346742882132
Bond Position:  [-7.68814744]


portfolio before change:  [2.02944586]
curr_Stock_Price:  101.19465732769437
curr_Factors:  [101.19465733]
mat_Sqrt:  [[0.15]]
grads:  [0.13631838]
Stock Position:  0.13631838416118208
Bond Position:  [-11.76524631]


portfolio before change:  [1.94122168]
curr_Stock_Price:  100.55285960314437
curr_Factors:  [100.5528596]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397552]
Stock Position:  -0.023975517269546998
Bond Position:  [4.35202851]


portfolio before change:  [1.92834244]
curr_Stock_Price:  101.10138818501986
curr_Factors:  [101.10138819]
mat_Sqrt:  [[0.15]]
grads:  [0.04603352]
Stock Position:  0.046033521031270064
Bond Position:  [-2.72571044]


portfolio before change:  [1.91667527]
curr_Stock_Price:  100.85163957423606
curr_Factors:  [100.85163957]
mat_Sqrt:  [[0.15]]
grads:  [-0.05353554]
Stock Position:  -0.0535355365951559
Bond Position:  [7.31582191]


portfolio before change:  [1.94742066]
curr_Stock_Price:  100.28588189069413
curr_Factors:  [100.28588189]
mat_Sqrt:  [[0.15]]
grads:  [0.03766093]
Stock Position:  0.03766093129477232
Bond Position:  [-1.82943905]


portfolio before change:  [1.98502331]
curr_Stock_Price:  101.28737041085537
curr_Factors:  [101.28737041]
mat_Sqrt:  [[0.15]]
grads:  [0.23047454]
Stock Position:  0.2304745427198411
Bond Position:  [-21.35913707]


portfolio before change:  [1.77140988]
curr_Stock_Price:  100.36632101577267
curr_Factors:  [100.36632102]
mat_Sqrt:  [[0.15]]
grads:  [0.0157649]
Stock Position:  0.015764900695498126
Bond Position:  [0.1891448]


portfolio before change:  [1.76233958]
curr_Stock_Price:  99.79022330961898
curr_Factors:  [99.79022331]
mat_Sqrt:  [[0.15]]
grads:  [-0.04814949]
Stock Position:  -0.04814948561039332
Bond Position:  [6.5671875]


portfolio before change:  [1.76422293]
curr_Stock_Price:  99.75963347951118
curr_Factors:  [99.75963348]
mat_Sqrt:  [[0.15]]
grads:  [0.06404831]
Stock Position:  0.06404830571553292
Bond Position:  [-4.62521257]


portfolio before change:  [1.76172862]
curr_Stock_Price:  99.72520281975207
curr_Factors:  [99.72520282]
mat_Sqrt:  [[0.15]]
grads:  [0.07981866]
Stock Position:  0.0798186647802698
Bond Position:  [-6.19820392]


portfolio before change:  [1.7475893]
curr_Stock_Price:  99.55291329654467
curr_Factors:  [99.5529133]
mat_Sqrt:  [[0.15]]
grads:  [-0.05098659]
Stock Position:  -0.05098659194755265
Bond Position:  [6.82345307]


portfolio before change:  [1.75977666]
curr_Stock_Price:  99.32224709792807
curr_Factors:  [99.3222471]
mat_Sqrt:  [[0.15]]
grads:  [0.02989608]
Stock Position:  0.02989608310452292
Bond Position:  [-1.20956949]


portfolio before change:  [1.76427844]
curr_Stock_Price:  99.47535683183513
curr_Factors:  [99.47535683]
mat_Sqrt:  [[0.15]]
grads:  [0.12297195]
Stock Position:  0.12297194596601775
Bond Position:  [-10.46839976]


portfolio before change:  [1.79268501]
curr_Stock_Price:  99.71167788886784
curr_Factors:  [99.71167789]
mat_Sqrt:  [[0.15]]
grads:  [-0.06774878]
Stock Position:  -0.06774877533482851
Bond Position:  [8.54802907]


portfolio before change:  [1.85505997]
curr_Stock_Price:  98.79888360925479
curr_Factors:  [98.79888361]
mat_Sqrt:  [[0.15]]
grads:  [0.01438128]
Stock Position:  0.014381276347146019
Bond Position:  [0.43420592]


portfolio before change:  [1.85062194]
curr_Stock_Price:  98.48839866434483
curr_Factors:  [98.48839866]
mat_Sqrt:  [[0.15]]
grads:  [-0.21872098]
Stock Position:  -0.21872098262258222
Bond Position:  [23.39210127]


portfolio before change:  [1.93988548]
curr_Stock_Price:  98.08696716712247
curr_Factors:  [98.08696717]
mat_Sqrt:  [[0.15]]
grads:  [-0.10845207]
Stock Position:  -0.10845206946190347
Bond Position:  [12.57762006]


portfolio before change:  [1.89509748]
curr_Stock_Price:  98.50719080898084
curr_Factors:  [98.50719081]
mat_Sqrt:  [[0.15]]
grads:  [0.04774397]
Stock Position:  0.047743965959651316
Bond Position:  [-2.80802648]


portfolio before change:  [1.89813837]
curr_Stock_Price:  98.57455825873353
curr_Factors:  [98.57455826]
mat_Sqrt:  [[0.15]]
grads:  [0.1422289]
Stock Position:  0.1422289025890562
Bond Position:  [-12.12201288]


portfolio before change:  [1.9664611]
curr_Stock_Price:  99.06025686033827
curr_Factors:  [99.06025686]
mat_Sqrt:  [[0.15]]
grads:  [-0.01427584]
Stock Position:  -0.014275835899738432
Bond Position:  [3.38062907]


portfolio before change:  [1.9590229]
curr_Stock_Price:  99.59609218164123
curr_Factors:  [99.59609218]
mat_Sqrt:  [[0.15]]
grads:  [-0.01473369]
Stock Position:  -0.014733690520416561
Bond Position:  [3.42644089]


portfolio before change:  [1.95232811]
curr_Stock_Price:  100.06501372898099
curr_Factors:  [100.06501373]
mat_Sqrt:  [[0.15]]
grads:  [0.15302552]
Stock Position:  0.15302552098457922
Bond Position:  [-13.36017275]


portfolio before change:  [2.0213511]
curr_Stock_Price:  100.52152599649457
curr_Factors:  [100.521526]
mat_Sqrt:  [[0.15]]
grads:  [0.09877962]
Stock Position:  0.09877962417371168
Bond Position:  [-7.90812746]


portfolio before change:  [2.06804325]
curr_Stock_Price:  100.99921993660182
curr_Factors:  [100.99921994]
mat_Sqrt:  [[0.15]]
grads:  [0.0718829]
Stock Position:  0.07188290414347434
Bond Position:  [-5.19207399]


portfolio before change:  [2.02199121]
curr_Stock_Price:  100.36308079723237
curr_Factors:  [100.3630808]
mat_Sqrt:  [[0.15]]
grads:  [0.02611422]
Stock Position:  0.02611421595220772
Bond Position:  [-0.59891195]


portfolio before change:  [2.01825662]
curr_Stock_Price:  100.22150445256734
curr_Factors:  [100.22150445]
mat_Sqrt:  [[0.15]]
grads:  [0.0610293]
Stock Position:  0.06102929770669868
Bond Position:  [-4.09819141]


portfolio before change:  [2.05456859]
curr_Stock_Price:  100.82069384173963
curr_Factors:  [100.82069384]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033416]
Stock Position:  -0.010334162181960885
Bond Position:  [3.09646599]


portfolio before change:  [2.05713359]
curr_Stock_Price:  100.59121550127925
curr_Factors:  [100.5912155]
mat_Sqrt:  [[0.15]]
grads:  [0.0288217]
Stock Position:  0.028821701041841636
Bond Position:  [-0.84207635]


portfolio before change:  [2.05963992]
curr_Stock_Price:  100.6800016094185
curr_Factors:  [100.68000161]
mat_Sqrt:  [[0.15]]
grads:  [-0.08392463]
Stock Position:  -0.08392463476499802
Bond Position:  [10.50917229]


portfolio before change:  [2.03672199]
curr_Stock_Price:  100.9609057721832
curr_Factors:  [100.96090577]
mat_Sqrt:  [[0.15]]
grads:  [0.01478164]
Stock Position:  0.014781644002639847
Bond Position:  [0.54435382]


portfolio before change:  [2.03919795]
curr_Stock_Price:  101.12610659243816
curr_Factors:  [101.12610659]
mat_Sqrt:  [[0.15]]
grads:  [0.01223395]
Stock Position:  0.012233953985638358
Bond Position:  [0.80202581]


portfolio before change:  [2.03677233]
curr_Stock_Price:  100.92374001444422
curr_Factors:  [100.92374001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02495186]
Stock Position:  -0.024951861181571038
Bond Position:  [4.55500749]


portfolio before change:  [2.05078513]
curr_Stock_Price:  100.37355673223728
curr_Factors:  [100.37355673]
mat_Sqrt:  [[0.15]]
grads:  [-0.0263641]
Stock Position:  -0.026364101481518902
Bond Position:  [4.69704376]


portfolio before change:  [2.04909364]
curr_Stock_Price:  100.4488507220573
curr_Factors:  [100.44885072]
mat_Sqrt:  [[0.15]]
grads:  [0.05009434]
Stock Position:  0.05009433595147532
Bond Position:  [-2.98282483]


portfolio before change:  [2.02137147]
curr_Stock_Price:  99.89917297483085
curr_Factors:  [99.89917297]
mat_Sqrt:  [[0.15]]
grads:  [0.02716079]
Stock Position:  0.02716079025344658
Bond Position:  [-0.69196901]


portfolio before change:  [2.01224194]
curr_Stock_Price:  99.56463617942008
curr_Factors:  [99.56463618]
mat_Sqrt:  [[0.15]]
grads:  [0.0487739]
Stock Position:  0.04877390090031355
Bond Position:  [-2.84391376]


portfolio before change:  [2.01897098]
curr_Stock_Price:  99.7062445869322
curr_Factors:  [99.70624459]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681725]
Stock Position:  -0.026817249000910405
Bond Position:  [4.69281817]


portfolio before change:  [2.02350287]
curr_Stock_Price:  99.54819042029058
curr_Factors:  [99.54819042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00164557]
Stock Position:  -0.0016455728223448442
Bond Position:  [2.18731667]


portfolio before change:  [2.02278144]
curr_Stock_Price:  100.06967719848336
curr_Factors:  [100.0696772]
mat_Sqrt:  [[0.15]]
grads:  [0.03344999]
Stock Position:  0.03344998757062417
Bond Position:  [-1.32454802]


portfolio before change:  [2.01568677]
curr_Stock_Price:  99.86005426864992
curr_Factors:  [99.86005427]
mat_Sqrt:  [[0.15]]
grads:  [-0.04939985]
Stock Position:  -0.04939985294747828
Bond Position:  [6.94875876]


portfolio before change:  [1.9948839]
curr_Stock_Price:  100.28995791168333
curr_Factors:  [100.28995791]
mat_Sqrt:  [[0.15]]
grads:  [0.05085683]
Stock Position:  0.050856834680683395
Bond Position:  [-3.10554591]


portfolio before change:  [1.98953002]
curr_Stock_Price:  100.18850108906133
curr_Factors:  [100.18850109]
mat_Sqrt:  [[0.15]]
grads:  [0.15832654]
Stock Position:  0.1583265424950017
Bond Position:  [-13.87296895]


portfolio before change:  [1.99933592]
curr_Stock_Price:  100.25591230593255
curr_Factors:  [100.25591231]
mat_Sqrt:  [[0.15]]
grads:  [0.03679156]
Stock Position:  0.0367915598534215
Bond Position:  [-1.68923548]


portfolio before change:  [1.93973565]
curr_Stock_Price:  98.63883790995344
curr_Factors:  [98.63883791]
mat_Sqrt:  [[0.15]]
grads:  [0.06710165]
Stock Position:  0.06710164896010315
Bond Position:  [-4.67909302]


portfolio before change:  [1.9384437]
curr_Stock_Price:  98.62394269013136
curr_Factors:  [98.62394269]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271067]
Stock Position:  -0.0027106729899100453
Bond Position:  [2.20578096]


portfolio before change:  [1.93923171]
curr_Stock_Price:  98.38409654728366
curr_Factors:  [98.38409655]
mat_Sqrt:  [[0.15]]
grads:  [0.01763126]
Stock Position:  0.01763126315974839
Bond Position:  [0.20459582]


portfolio before change:  [1.94749375]
curr_Stock_Price:  98.85197284771645
curr_Factors:  [98.85197285]
mat_Sqrt:  [[0.15]]
grads:  [0.14715862]
Stock Position:  0.1471586179728519
Bond Position:  [-12.59942596]


portfolio before change:  [1.88728309]
curr_Stock_Price:  98.44816927678343
curr_Factors:  [98.44816928]
mat_Sqrt:  [[0.15]]
grads:  [0.01880179]
Stock Position:  0.018801792638816775
Bond Position:  [0.03628102]


portfolio before change:  [1.89969187]
curr_Stock_Price:  99.10802750997185
curr_Factors:  [99.10802751]
mat_Sqrt:  [[0.15]]
grads:  [-0.10621928]
Stock Position:  -0.10621928365331981
Bond Position:  [12.42687556]


portfolio before change:  [1.86872798]
curr_Stock_Price:  99.40684891230683
curr_Factors:  [99.40684891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03645347]
Stock Position:  -0.03645347003806722
Bond Position:  [5.49245257]


portfolio before change:  [1.8927504]
curr_Stock_Price:  98.75727759573002
curr_Factors:  [98.7572776]
mat_Sqrt:  [[0.15]]
grads:  [0.00657387]
Stock Position:  0.006573868336923371
Bond Position:  [1.24353306]


portfolio before change:  [1.88885615]
curr_Stock_Price:  98.15307138266435
curr_Factors:  [98.15307138]
mat_Sqrt:  [[0.15]]
grads:  [0.04697769]
Stock Position:  0.04697768975563355
Bond Position:  [-2.72214838]


portfolio before change:  [1.87950833]
curr_Stock_Price:  97.95770886775476
curr_Factors:  [97.95770887]
mat_Sqrt:  [[0.15]]
grads:  [0.00165843]
Stock Position:  0.0016584298527423022
Bond Position:  [1.71705234]


portfolio before change:  [1.87987825]
curr_Stock_Price:  98.11604811192397
curr_Factors:  [98.11604811]
mat_Sqrt:  [[0.15]]
grads:  [-0.00986444]
Stock Position:  -0.00986443504583558
Bond Position:  [2.84773763]


portfolio before change:  [1.89422861]
curr_Stock_Price:  96.67933348480165
curr_Factors:  [96.67933348]
mat_Sqrt:  [[0.15]]
grads:  [-0.07293692]
Stock Position:  -0.07293691736349077
Bond Position:  [8.94572117]


portfolio before change:  [1.87444513]
curr_Stock_Price:  96.95824040891698
curr_Factors:  [96.95824041]
mat_Sqrt:  [[0.15]]
grads:  [-0.15343824]
Stock Position:  -0.15343823850272684
Bond Position:  [16.75154674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.87199095]
Stock Price:  96.98105856711845
PL:  [1.87199095]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-4.14735409e-03]
 [ 2.61910000e-02]
 [ 2.07583298e-02]
 [-8.94941107e-03]
 [ 1.35793717e-02]
 [-1.12186934e-02]
 [ 2.45563554e-03]
 [-4.57915704e-03]
 [-1.39446600e-02]
 [-1.15187479e-02]
 [ 1.48873121e-02]
 [-5.85425466e-03]
 [ 2.11115551e-04]
 [ 2.76725481e-03]
 [-3.53866281e-03]
 [ 1.06807488e-02]
 [ 4.65401670e-03]
 [-1.50154783e-02]
 [ 2.50188368e-02]
 [ 6.75502119e-04]
 [-4.39174550e-03]
 [ 5.40270091e-03]
 [ 1.82321583e-02]
 [ 1.72474533e-02]
 [-6.03087843e-03]
 [ 4.61688579e-03]
 [-2.72451615e-03]
 [ 5.61926683e-03]
 [ 1.72966856e-02]
 [ 2.08017908e-03]
 [-7.93417363e-03]
 [ 8.82809068e-03]
 [ 1.16384993e-02]
 [-1.15445931e-02]
 [ 3.58283147e-03]
 [ 1.84745115e-02]
 [ 4.34710927e-03]
 [ 1.52055592e-03]
 [-3.43045678e-02]
 [-1.65732650e-02]
 [ 7.16471205e-03]
 [ 2.86804422e-02]
 [-2.31187334e-03]
 [ 1.02581275e-03]
 [-5.29945756e-03]
 [ 1.66711795e-02]
 [ 9.99764315e-03]
 [ 5.25764038e-03]
 [-7.48138676e-04]
 [-1.42278602e-03]
 [-6.61535605e-03]
 [ 1.69365696e-03]
 [ 1.49397023e-03]
 [ 8.69632123e-03]
 [-8.36567830e-03]
 [-4.51363393e-03]
 [ 1.58785317e-03]
 [ 1.02893129e-02]
 [ 7.70043689e-03]
 [-3.95387951e-03]
 [-1.06610348e-03]
 [ 6.41921928e-04]
 [-6.21152471e-03]
 [-1.73196089e-03]
 [ 1.88445173e-02]
 [ 5.62980183e-03]
 [ 1.88022937e-02]
 [-1.88470676e-03]
 [ 6.43246410e-03]
 [ 2.59179654e-02]
 [ 3.10055603e-03]
 [-1.51924031e-02]
 [-5.70474690e-03]
 [ 2.80698882e-03]
 [ 1.21444912e-02]
 [ 1.78931487e-02]
 [ 4.80804870e-03]
 [-2.84027741e-02]
 [-3.13471149e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.0451309]
curr_Stock_Price:  100.22778098618002
curr_Factors:  [100.22778099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02764903]
Stock Position:  -0.02764902724483702
Bond Position:  [9.81633155]


portfolio before change:  [7.03605794]
curr_Stock_Price:  100.57811868592682
curr_Factors:  [100.57811869]
mat_Sqrt:  [[0.15]]
grads:  [0.17460667]
Stock Position:  0.1746066665734791
Bond Position:  [-10.52555209]


portfolio before change:  [7.08467039]
curr_Stock_Price:  100.86029757878691
curr_Factors:  [100.86029758]
mat_Sqrt:  [[0.15]]
grads:  [0.13838887]
Stock Position:  0.13838886512263518
Bond Position:  [-6.87327173]


portfolio before change:  [7.01403576]
curr_Stock_Price:  100.3529949254287
curr_Factors:  [100.35299493]
mat_Sqrt:  [[0.15]]
grads:  [-0.05966274]
Stock Position:  -0.0596627404364863
Bond Position:  [13.00137045]


portfolio before change:  [7.07080896]
curr_Stock_Price:  99.41504622785516
curr_Factors:  [99.41504623]
mat_Sqrt:  [[0.15]]
grads:  [0.09052914]
Stock Position:  0.09052914497834934
Bond Position:  [-1.92915017]


portfolio before change:  [7.07991956]
curr_Stock_Price:  99.51701535868925
curr_Factors:  [99.51701536]
mat_Sqrt:  [[0.15]]
grads:  [-0.07479129]
Stock Position:  -0.07479128924004048
Bond Position:  [14.52292544]


portfolio before change:  [7.04652226]
curr_Stock_Price:  99.97569196834445
curr_Factors:  [99.97569197]
mat_Sqrt:  [[0.15]]
grads:  [0.0163709]
Stock Position:  0.01637090362917203
Bond Position:  [5.40982984]


portfolio before change:  [7.04428112]
curr_Stock_Price:  99.81813997305797
curr_Factors:  [99.81813997]
mat_Sqrt:  [[0.15]]
grads:  [-0.03052771]
Stock Position:  -0.030527713610272306
Bond Position:  [10.09150071]


portfolio before change:  [7.06020209]
curr_Stock_Price:  99.31727590700795
curr_Factors:  [99.31727591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0929644]
Stock Position:  -0.09296440016474858
Bond Position:  [16.29317307]


portfolio before change:  [7.07774427]
curr_Stock_Price:  99.13953237504663
curr_Factors:  [99.13953238]
mat_Sqrt:  [[0.15]]
grads:  [-0.07679165]
Stock Position:  -0.07679165280786954
Bond Position:  [14.69083282]


portfolio before change:  [7.02261544]
curr_Stock_Price:  99.86939070992297
curr_Factors:  [99.86939071]
mat_Sqrt:  [[0.15]]
grads:  [0.09924875]
Stock Position:  0.09924874746121246
Bond Position:  [-2.88929649]


portfolio before change:  [6.97809025]
curr_Stock_Price:  99.4225880367802
curr_Factors:  [99.42258804]
mat_Sqrt:  [[0.15]]
grads:  [-0.03902836]
Stock Position:  -0.03902836440844581
Bond Position:  [10.85839125]


portfolio before change:  [7.00555003]
curr_Stock_Price:  98.73639190410952
curr_Factors:  [98.7363919]
mat_Sqrt:  [[0.15]]
grads:  [0.00140744]
Stock Position:  0.001407437006690227
Bond Position:  [6.86658478]


portfolio before change:  [7.00602678]
curr_Stock_Price:  98.77019031782925
curr_Factors:  [98.77019032]
mat_Sqrt:  [[0.15]]
grads:  [0.01844837]
Stock Position:  0.01844836543165923
Bond Position:  [5.18387821]


portfolio before change:  [7.00308105]
curr_Stock_Price:  98.59295358310597
curr_Factors:  [98.59295358]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359109]
Stock Position:  -0.02359108536822309
Bond Position:  [9.32899584]


portfolio before change:  [6.99077277]
curr_Stock_Price:  99.13940402518438
curr_Factors:  [99.13940403]
mat_Sqrt:  [[0.15]]
grads:  [0.07120499]
Stock Position:  0.0712049916679777
Bond Position:  [-0.06844766]


portfolio before change:  [6.96019862]
curr_Stock_Price:  98.71008190948602
curr_Factors:  [98.71008191]
mat_Sqrt:  [[0.15]]
grads:  [0.03102678]
Stock Position:  0.03102677799341323
Bond Position:  [3.89754282]


portfolio before change:  [6.97677545]
curr_Stock_Price:  99.23650558785187
curr_Factors:  [99.23650559]
mat_Sqrt:  [[0.15]]
grads:  [-0.10010319]
Stock Position:  -0.10010318895162175
Bond Position:  [16.91066612]


portfolio before change:  [7.03163526]
curr_Stock_Price:  98.69903160452829
curr_Factors:  [98.6990316]
mat_Sqrt:  [[0.15]]
grads:  [0.16679225]
Stock Position:  0.1667922454942256
Bond Position:  [-9.43059785]


portfolio before change:  [7.06598097]
curr_Stock_Price:  98.90848462599753
curr_Factors:  [98.90848463]
mat_Sqrt:  [[0.15]]
grads:  [0.00450335]
Stock Position:  0.004503347460396907
Bond Position:  [6.6205617]


portfolio before change:  [7.06718257]
curr_Stock_Price:  99.08342226748739
curr_Factors:  [99.08342227]
mat_Sqrt:  [[0.15]]
grads:  [-0.0292783]
Stock Position:  -0.029278303333866933
Bond Position:  [9.96817707]


portfolio before change:  [7.07633164]
curr_Stock_Price:  98.79221574207816
curr_Factors:  [98.79221574]
mat_Sqrt:  [[0.15]]
grads:  [0.03601801]
Stock Position:  0.036018006038929885
Bond Position:  [3.51803302]


portfolio before change:  [7.0852849]
curr_Stock_Price:  99.03468831720645
curr_Factors:  [99.03468832]
mat_Sqrt:  [[0.15]]
grads:  [0.12154772]
Stock Position:  0.12154772184392366
Bond Position:  [-4.95215585]


portfolio before change:  [7.22155713]
curr_Stock_Price:  100.1583765666341
curr_Factors:  [100.15837657]
mat_Sqrt:  [[0.15]]
grads:  [0.11498302]
Stock Position:  0.11498302219493636
Bond Position:  [-4.29495571]


portfolio before change:  [7.15775694]
curr_Stock_Price:  99.60584506250791
curr_Factors:  [99.60584506]
mat_Sqrt:  [[0.15]]
grads:  [-0.04020586]
Stock Position:  -0.040205856197313795
Bond Position:  [11.16249523]


portfolio before change:  [7.1472132]
curr_Stock_Price:  99.88544171651579
curr_Factors:  [99.88544172]
mat_Sqrt:  [[0.15]]
grads:  [0.03077924]
Stock Position:  0.030779238568984017
Bond Position:  [4.07281536]


portfolio before change:  [7.16216635]
curr_Stock_Price:  100.3629906210598
curr_Factors:  [100.36299062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01816344]
Stock Position:  -0.018163440970529306
Bond Position:  [8.9851036]


portfolio before change:  [7.16403868]
curr_Stock_Price:  100.29082687682052
curr_Factors:  [100.29082688]
mat_Sqrt:  [[0.15]]
grads:  [0.03746178]
Stock Position:  0.037461778884322915
Bond Position:  [3.4069659]


portfolio before change:  [7.13735536]
curr_Stock_Price:  99.572861540888
curr_Factors:  [99.57286154]
mat_Sqrt:  [[0.15]]
grads:  [0.11531124]
Stock Position:  0.1153112372511934
Bond Position:  [-4.3445145]


portfolio before change:  [7.22429881]
curr_Stock_Price:  100.32920577252271
curr_Factors:  [100.32920577]
mat_Sqrt:  [[0.15]]
grads:  [0.01386786]
Stock Position:  0.013867860540417975
Bond Position:  [5.83294737]


portfolio before change:  [7.2244529]
curr_Stock_Price:  100.31402858443711
curr_Factors:  [100.31402858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05289449]
Stock Position:  -0.05289449087872764
Bond Position:  [12.53051237]


portfolio before change:  [7.2457532]
curr_Stock_Price:  99.9261410379289
curr_Factors:  [99.92614104]
mat_Sqrt:  [[0.15]]
grads:  [0.05885394]
Stock Position:  0.05885393787228164
Bond Position:  [1.3647063]


portfolio before change:  [7.20549785]
curr_Stock_Price:  99.24070429215605
curr_Factors:  [99.24070429]
mat_Sqrt:  [[0.15]]
grads:  [0.07759]
Stock Position:  0.07758999514626373
Bond Position:  [-0.49458792]


portfolio before change:  [7.20245637]
curr_Stock_Price:  99.20190338298508
curr_Factors:  [99.20190338]
mat_Sqrt:  [[0.15]]
grads:  [-0.07696395]
Stock Position:  -0.07696395404070293
Bond Position:  [14.8374271]


portfolio before change:  [7.20056168]
curr_Stock_Price:  99.23857060166067
curr_Factors:  [99.2385706]
mat_Sqrt:  [[0.15]]
grads:  [0.02388554]
Stock Position:  0.023885543133156786
Bond Position:  [4.83019453]


portfolio before change:  [7.18874416]
curr_Stock_Price:  98.73117515865869
curr_Factors:  [98.73117516]
mat_Sqrt:  [[0.15]]
grads:  [0.12316341]
Stock Position:  0.12316340980331505
Bond Position:  [-4.97132402]


portfolio before change:  [7.18701142]
curr_Stock_Price:  98.71962927438932
curr_Factors:  [98.71962927]
mat_Sqrt:  [[0.15]]
grads:  [0.02898073]
Stock Position:  0.028980728498431505
Bond Position:  [4.32604464]


portfolio before change:  [7.18306342]
curr_Stock_Price:  98.5740710473739
curr_Factors:  [98.57407105]
mat_Sqrt:  [[0.15]]
grads:  [0.01013704]
Stock Position:  0.010137039445605473
Bond Position:  [6.18381417]


portfolio before change:  [7.1780312]
curr_Stock_Price:  98.03952417729728
curr_Factors:  [98.03952418]
mat_Sqrt:  [[0.15]]
grads:  [-0.22869712]
Stock Position:  -0.2286971183573855
Bond Position:  [29.59938786]


portfolio before change:  [7.06263981]
curr_Stock_Price:  98.55217344100484
curr_Factors:  [98.55217344]
mat_Sqrt:  [[0.15]]
grads:  [-0.11048843]
Stock Position:  -0.11048843300162502
Bond Position:  [17.95151502]


portfolio before change:  [7.06093643]
curr_Stock_Price:  98.57774519950546
curr_Factors:  [98.5777452]
mat_Sqrt:  [[0.15]]
grads:  [0.04776475]
Stock Position:  0.047764747003804515
Bond Position:  [2.35239537]


portfolio before change:  [7.02232072]
curr_Stock_Price:  97.76621072830052
curr_Factors:  [97.76621073]
mat_Sqrt:  [[0.15]]
grads:  [0.19120295]
Stock Position:  0.19120294822993555
Bond Position:  [-11.67086701]


portfolio before change:  [7.22824397]
curr_Stock_Price:  98.84701362679992
curr_Factors:  [98.84701363]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541249]
Stock Position:  -0.015412488928310571
Bond Position:  [8.75172247]


portfolio before change:  [7.23533594]
curr_Stock_Price:  98.42235989670561
curr_Factors:  [98.4223599]
mat_Sqrt:  [[0.15]]
grads:  [0.00683875]
Stock Position:  0.006838751679591719
Bond Position:  [6.56224986]


portfolio before change:  [7.23324156]
curr_Stock_Price:  98.05613272978063
curr_Factors:  [98.05613273]
mat_Sqrt:  [[0.15]]
grads:  [-0.03532972]
Stock Position:  -0.03532971709208431
Bond Position:  [10.69753698]


portfolio before change:  [7.24026562]
curr_Stock_Price:  97.87624317502592
curr_Factors:  [97.87624318]
mat_Sqrt:  [[0.15]]
grads:  [0.1111412]
Stock Position:  0.11114119633437415
Bond Position:  [-3.63781714]


portfolio before change:  [7.1858507]
curr_Stock_Price:  97.38868727135831
curr_Factors:  [97.38868727]
mat_Sqrt:  [[0.15]]
grads:  [0.06665095]
Stock Position:  0.06665095430366402
Bond Position:  [0.69480176]


portfolio before change:  [7.24466598]
curr_Stock_Price:  98.27047280209773
curr_Factors:  [98.2704728]
mat_Sqrt:  [[0.15]]
grads:  [0.03505094]
Stock Position:  0.03505093587704797
Bond Position:  [3.80019394]


portfolio before change:  [7.25440746]
curr_Stock_Price:  98.5416199828345
curr_Factors:  [98.54161998]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498759]
Stock Position:  -0.004987591175371799
Bond Position:  [7.74589277]


portfolio before change:  [7.25514068]
curr_Stock_Price:  98.4916789000491
curr_Factors:  [98.4916789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00948524]
Stock Position:  -0.009485240162459286
Bond Position:  [8.18935791]


portfolio before change:  [7.25487177]
curr_Stock_Price:  98.57399237829965
curr_Factors:  [98.57399238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04410237]
Stock Position:  -0.0441023736378129
Bond Position:  [11.60221881]


portfolio before change:  [7.28336607]
curr_Stock_Price:  97.94434048675865
curr_Factors:  [97.94434049]
mat_Sqrt:  [[0.15]]
grads:  [0.01129105]
Stock Position:  0.011291046399439104
Bond Position:  [6.17747198]


portfolio before change:  [7.29461923]
curr_Stock_Price:  98.90678950879816
curr_Factors:  [98.90678951]
mat_Sqrt:  [[0.15]]
grads:  [0.0099598]
Stock Position:  0.009959801564855573
Bond Position:  [6.30952723]


portfolio before change:  [7.29247143]
curr_Stock_Price:  98.65154720457929
curr_Factors:  [98.6515472]
mat_Sqrt:  [[0.15]]
grads:  [0.05797547]
Stock Position:  0.057975474891196685
Bond Position:  [1.57310113]


portfolio before change:  [7.26371232]
curr_Stock_Price:  98.15379487219435
curr_Factors:  [98.15379487]
mat_Sqrt:  [[0.15]]
grads:  [-0.05577119]
Stock Position:  -0.055771188670890155
Bond Position:  [12.73786613]


portfolio before change:  [7.25828407]
curr_Stock_Price:  98.26540064929203
curr_Factors:  [98.26540065]
mat_Sqrt:  [[0.15]]
grads:  [-0.03009089]
Stock Position:  -0.03009089283547552
Bond Position:  [10.21517771]


portfolio before change:  [7.23649403]
curr_Stock_Price:  99.01075933029934
curr_Factors:  [99.01075933]
mat_Sqrt:  [[0.15]]
grads:  [0.01058569]
Stock Position:  0.010585687820773682
Bond Position:  [6.18839704]


portfolio before change:  [7.23144737]
curr_Stock_Price:  98.49747701488207
curr_Factors:  [98.49747701]
mat_Sqrt:  [[0.15]]
grads:  [0.06859542]
Stock Position:  0.06859541955249703
Bond Position:  [0.47497161]


portfolio before change:  [7.23193167]
curr_Stock_Price:  98.50410445099756
curr_Factors:  [98.50410445]
mat_Sqrt:  [[0.15]]
grads:  [0.05133625]
Stock Position:  0.051336245961665514
Bond Position:  [2.17510074]


portfolio before change:  [7.24677505]
curr_Stock_Price:  98.79059658303906
curr_Factors:  [98.79059658]
mat_Sqrt:  [[0.15]]
grads:  [-0.0263592]
Stock Position:  -0.026359196703951798
Bond Position:  [9.85081582]


portfolio before change:  [7.23695625]
curr_Stock_Price:  99.18645467522316
curr_Factors:  [99.18645468]
mat_Sqrt:  [[0.15]]
grads:  [-0.00710736]
Stock Position:  -0.00710735650956652
Bond Position:  [7.94190974]


portfolio before change:  [7.24362215]
curr_Stock_Price:  98.31840765718869
curr_Factors:  [98.31840766]
mat_Sqrt:  [[0.15]]
grads:  [0.00427948]
Stock Position:  0.004279479521085659
Bond Position:  [6.82287054]


portfolio before change:  [7.24590324]
curr_Stock_Price:  98.75178829269548
curr_Factors:  [98.75178829]
mat_Sqrt:  [[0.15]]
grads:  [-0.04141016]
Stock Position:  -0.041410164711079306
Bond Position:  [11.33523106]


portfolio before change:  [7.31255699]
curr_Stock_Price:  97.15929821142936
curr_Factors:  [97.15929821]
mat_Sqrt:  [[0.15]]
grads:  [-0.01154641]
Stock Position:  -0.011546405955927156
Bond Position:  [8.43439769]


portfolio before change:  [7.32204083]
curr_Stock_Price:  96.38358724942908
curr_Factors:  [96.38358725]
mat_Sqrt:  [[0.15]]
grads:  [0.12563012]
Stock Position:  0.12563011507165464
Bond Position:  [-4.78664033]


portfolio before change:  [7.28228254]
curr_Stock_Price:  96.06949760944737
curr_Factors:  [96.06949761]
mat_Sqrt:  [[0.15]]
grads:  [0.03753201]
Stock Position:  0.03753201220126705
Bond Position:  [3.67660098]


portfolio before change:  [7.28223075]
curr_Stock_Price:  96.06199519930179
curr_Factors:  [96.0619952]
mat_Sqrt:  [[0.15]]
grads:  [0.12534862]
Stock Position:  0.1253486249426655
Bond Position:  [-4.75900826]


portfolio before change:  [7.38034661]
curr_Stock_Price:  96.84711195275169
curr_Factors:  [96.84711195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256471]
Stock Position:  -0.012564711723462539
Bond Position:  [8.59720265]


portfolio before change:  [7.39647067]
curr_Stock_Price:  95.60659621420797
curr_Factors:  [95.60659621]
mat_Sqrt:  [[0.15]]
grads:  [0.04288309]
Stock Position:  0.04288309401928686
Bond Position:  [3.29656402]


portfolio before change:  [7.40439692]
curr_Stock_Price:  95.78662542728706
curr_Factors:  [95.78662543]
mat_Sqrt:  [[0.15]]
grads:  [0.17278644]
Stock Position:  0.1727864360081926
Bond Position:  [-9.1462327]


portfolio before change:  [7.30383909]
curr_Stock_Price:  95.20795631250338
curr_Factors:  [95.20795631]
mat_Sqrt:  [[0.15]]
grads:  [0.02067037]
Stock Position:  0.020670373528614748
Bond Position:  [5.33585507]


portfolio before change:  [7.29379119]
curr_Stock_Price:  94.70572022736076
curr_Factors:  [94.70572023]
mat_Sqrt:  [[0.15]]
grads:  [-0.10128269]
Stock Position:  -0.10128268722087047
Bond Position:  [16.88584103]


portfolio before change:  [7.30623431]
curr_Stock_Price:  94.59328514023615
curr_Factors:  [94.59328514]
mat_Sqrt:  [[0.15]]
grads:  [-0.03803165]
Stock Position:  -0.038031646031168855
Bond Position:  [10.90377265]


portfolio before change:  [7.30653376]
curr_Stock_Price:  94.60333107795601
curr_Factors:  [94.60333108]
mat_Sqrt:  [[0.15]]
grads:  [0.01871326]
Stock Position:  0.018713258779569305
Bond Position:  [5.53619714]


portfolio before change:  [7.28891183]
curr_Stock_Price:  93.64315916624494
curr_Factors:  [93.64315917]
mat_Sqrt:  [[0.15]]
grads:  [0.08096327]
Stock Position:  0.08096327433661109
Bond Position:  [-0.29274495]


portfolio before change:  [7.23134272]
curr_Stock_Price:  92.93233293516597
curr_Factors:  [92.93233294]
mat_Sqrt:  [[0.15]]
grads:  [0.11928766]
Stock Position:  0.11928765823974485
Bond Position:  [-3.85433765]


portfolio before change:  [7.24487509]
curr_Stock_Price:  93.04779563404894
curr_Factors:  [93.04779563]
mat_Sqrt:  [[0.15]]
grads:  [0.03205366]
Stock Position:  0.032053658022112186
Bond Position:  [4.26235287]


portfolio before change:  [7.27183263]
curr_Stock_Price:  93.88049742142545
curr_Factors:  [93.88049742]
mat_Sqrt:  [[0.15]]
grads:  [-0.18935183]
Stock Position:  -0.1893518274589619
Bond Position:  [25.04827638]


portfolio before change:  [7.19858186]
curr_Stock_Price:  94.27561552367085
curr_Factors:  [94.27561552]
mat_Sqrt:  [[0.15]]
grads:  [-0.20898077]
Stock Position:  -0.20898076607445357
Bond Position:  [26.90037222]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.14258219]
Stock Price:  94.55162657370512
PL:  [7.14258219]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-9.86462998e-03]
 [ 1.59947446e-02]
 [ 5.77139447e-03]
 [-9.35823842e-03]
 [ 1.41908819e-02]
 [-9.41383284e-03]
 [-7.50667622e-04]
 [ 1.87636559e-02]
 [-1.30297067e-02]
 [-1.24080994e-02]
 [ 1.18497044e-02]
 [-8.02753977e-03]
 [ 5.10695981e-04]
 [ 3.08332645e-03]
 [ 1.03700242e-05]
 [ 1.16604656e-02]
 [ 2.07464050e-02]
 [-1.35336969e-02]
 [ 2.48819264e-02]
 [-2.62706238e-03]
 [-1.76331658e-02]
 [ 5.91169682e-03]
 [ 1.45666878e-02]
 [ 1.11665692e-02]
 [ 1.18550171e-02]
 [ 4.47125891e-03]
 [ 1.63887149e-04]
 [ 1.80474962e-02]
 [-2.81501403e-02]
 [ 5.90058800e-02]
 [-6.90974016e-03]
 [ 1.53867482e-02]
 [ 1.14678367e-02]
 [-1.95937516e-02]
 [-1.37087529e-03]
 [ 1.85742945e-02]
 [ 4.72010636e-03]
 [ 2.84121210e-03]
 [-5.69582600e-02]
 [-4.97986385e-03]
 [ 7.06645694e-03]
 [-3.10123387e-03]
 [-1.62013025e-03]
 [-1.82355208e-03]
 [ 1.04967611e-02]
 [ 1.49518202e-02]
 [ 1.08315746e-02]
 [ 4.56060855e-03]
 [ 6.04011350e-03]
 [-2.23671643e-03]
 [-6.41421995e-03]
 [-2.21229436e-03]
 [ 1.86323489e-03]
 [ 1.30634151e-03]
 [-4.26315315e-03]
 [-4.11952994e-03]
 [ 1.25958247e-03]
 [ 8.98951678e-03]
 [ 7.20803094e-03]
 [-3.96590567e-03]
 [-1.95497220e-03]
 [ 1.93443030e-03]
 [-7.11498158e-03]
 [ 7.19699123e-03]
 [ 1.99454912e-02]
 [ 5.47542022e-03]
 [ 8.24603177e-03]
 [-9.20337907e-04]
 [ 2.69151616e-03]
 [ 1.99312943e-02]
 [ 4.79886573e-04]
 [-1.57781189e-02]
 [-2.37762049e-04]
 [ 1.40338334e-03]
 [ 1.31473378e-03]
 [-1.46259725e-02]
 [-3.85870322e-03]
 [ 1.49575806e-02]
 [-9.39814891e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45198473]
curr_Stock_Price:  100.06458765044992
curr_Factors:  [100.06458765]
mat_Sqrt:  [[0.15]]
grads:  [-0.0657642]
Stock Position:  -0.0657641998881533
Bond Position:  [10.03265227]


portfolio before change:  [3.43951985]
curr_Stock_Price:  100.26366164654465
curr_Factors:  [100.26366165]
mat_Sqrt:  [[0.15]]
grads:  [0.10663163]
Stock Position:  0.10663163037339148
Bond Position:  [-7.25175786]


portfolio before change:  [3.36840827]
curr_Stock_Price:  99.60102215610046
curr_Factors:  [99.60102216]
mat_Sqrt:  [[0.15]]
grads:  [0.03847596]
Stock Position:  0.03847596310736556
Bond Position:  [-0.46383699]


portfolio before change:  [3.35732039]
curr_Stock_Price:  99.31359879755405
curr_Factors:  [99.3135988]
mat_Sqrt:  [[0.15]]
grads:  [-0.06238826]
Stock Position:  -0.06238825615570625
Bond Position:  [9.55332263]


portfolio before change:  [3.34687961]
curr_Stock_Price:  99.49052120154037
curr_Factors:  [99.4905212]
mat_Sqrt:  [[0.15]]
grads:  [0.09460588]
Stock Position:  0.09460587907847666
Bond Position:  [-6.06550861]


portfolio before change:  [3.36470997]
curr_Stock_Price:  99.68299834257607
curr_Factors:  [99.68299834]
mat_Sqrt:  [[0.15]]
grads:  [-0.06275889]
Stock Position:  -0.06275888560581769
Bond Position:  [9.62070386]


portfolio before change:  [3.38339693]
curr_Stock_Price:  99.39482160849671
curr_Factors:  [99.39482161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00500445]
Stock Position:  -0.0050044508150429625
Bond Position:  [3.88081343]


portfolio before change:  [3.38636902]
curr_Stock_Price:  98.84940218692181
curr_Factors:  [98.84940219]
mat_Sqrt:  [[0.15]]
grads:  [0.12509104]
Stock Position:  0.12509103909773517
Bond Position:  [-8.97880542]


portfolio before change:  [3.45789145]
curr_Stock_Price:  99.42565148329984
curr_Factors:  [99.42565148]
mat_Sqrt:  [[0.15]]
grads:  [-0.08686471]
Stock Position:  -0.08686471118272315
Bond Position:  [12.09447195]


portfolio before change:  [3.49855883]
curr_Stock_Price:  98.96618469536524
curr_Factors:  [98.9661847]
mat_Sqrt:  [[0.15]]
grads:  [-0.08272066]
Stock Position:  -0.08272066240967421
Bond Position:  [11.68510718]


portfolio before change:  [3.51273599]
curr_Stock_Price:  98.80362771936873
curr_Factors:  [98.80362772]
mat_Sqrt:  [[0.15]]
grads:  [0.07899803]
Stock Position:  0.07899802961760577
Bond Position:  [-4.29255592]


portfolio before change:  [3.52501902]
curr_Stock_Price:  98.96250926162688
curr_Factors:  [98.96250926]
mat_Sqrt:  [[0.15]]
grads:  [-0.05351693]
Stock Position:  -0.05351693180791515
Bond Position:  [8.82118888]


portfolio before change:  [3.54125165]
curr_Stock_Price:  98.66949381299167
curr_Factors:  [98.66949381]
mat_Sqrt:  [[0.15]]
grads:  [0.00340464]
Stock Position:  0.003404639870986381
Bond Position:  [3.20531756]


portfolio before change:  [3.54192393]
curr_Stock_Price:  98.80810935552942
curr_Factors:  [98.80810936]
mat_Sqrt:  [[0.15]]
grads:  [0.02055551]
Stock Position:  0.02055550966597134
Bond Position:  [1.51087288]


portfolio before change:  [3.5548094]
curr_Stock_Price:  99.43037758353547
curr_Factors:  [99.43037758]
mat_Sqrt:  [[0.15]]
grads:  [6.91334944e-05]
Stock Position:  6.91334943755372e-05
Bond Position:  [3.54793543]


portfolio before change:  [3.55503163]
curr_Stock_Price:  99.4373252090443
curr_Factors:  [99.43732521]
mat_Sqrt:  [[0.15]]
grads:  [0.07773644]
Stock Position:  0.07773643741520639
Bond Position:  [-4.17487177]


portfolio before change:  [3.54178407]
curr_Stock_Price:  99.27026551599833
curr_Factors:  [99.27026552]
mat_Sqrt:  [[0.15]]
grads:  [0.13830937]
Stock Position:  0.13830936663329377
Bond Position:  [-10.18822348]


portfolio before change:  [3.4435936]
curr_Stock_Price:  98.56493595522011
curr_Factors:  [98.56493596]
mat_Sqrt:  [[0.15]]
grads:  [-0.09022465]
Stock Position:  -0.09022464620762004
Bond Position:  [12.33658008]


portfolio before change:  [3.49984826]
curr_Stock_Price:  97.94998649427856
curr_Factors:  [97.94998649]
mat_Sqrt:  [[0.15]]
grads:  [0.16587951]
Stock Position:  0.16587950946674557
Bond Position:  [-12.74804745]


portfolio before change:  [3.42534716]
curr_Stock_Price:  97.50566202304285
curr_Factors:  [97.50566202]
mat_Sqrt:  [[0.15]]
grads:  [-0.01751375]
Stock Position:  -0.01751374917090308
Bond Position:  [5.13303687]


portfolio before change:  [3.4333044]
curr_Stock_Price:  97.06963770112814
curr_Factors:  [97.0696377]
mat_Sqrt:  [[0.15]]
grads:  [-0.11755444]
Stock Position:  -0.11755443886887047
Bond Position:  [14.84427119]


portfolio before change:  [3.49990653]
curr_Stock_Price:  96.51096607128726
curr_Factors:  [96.51096607]
mat_Sqrt:  [[0.15]]
grads:  [0.03941131]
Stock Position:  0.03941131213124609
Bond Position:  [-0.30371728]


portfolio before change:  [3.48357005]
curr_Stock_Price:  96.09693527339476
curr_Factors:  [96.09693527]
mat_Sqrt:  [[0.15]]
grads:  [0.09711125]
Stock Position:  0.0971112522281076
Bond Position:  [-5.84852367]


portfolio before change:  [3.47763975]
curr_Stock_Price:  96.0396323967156
curr_Factors:  [96.0396324]
mat_Sqrt:  [[0.15]]
grads:  [0.07444379]
Stock Position:  0.07444379474160659
Bond Position:  [-3.67191493]


portfolio before change:  [3.4707338]
curr_Stock_Price:  95.94994799361183
curr_Factors:  [95.94994799]
mat_Sqrt:  [[0.15]]
grads:  [0.07903345]
Stock Position:  0.0790334475530224
Bond Position:  [-4.11252138]


portfolio before change:  [3.46806963]
curr_Stock_Price:  95.9194909102078
curr_Factors:  [95.91949091]
mat_Sqrt:  [[0.15]]
grads:  [0.02980839]
Stock Position:  0.029808392734476885
Bond Position:  [0.60886378]


portfolio before change:  [3.46223924]
curr_Stock_Price:  95.72261842678326
curr_Factors:  [95.72261843]
mat_Sqrt:  [[0.15]]
grads:  [0.00109258]
Stock Position:  0.0010925809957377727
Bond Position:  [3.35765452]


portfolio before change:  [3.46248173]
curr_Stock_Price:  95.75248492160124
curr_Factors:  [95.75248492]
mat_Sqrt:  [[0.15]]
grads:  [0.12031664]
Stock Position:  0.12031664114968302
Bond Position:  [-8.05813564]


portfolio before change:  [3.39230733]
curr_Stock_Price:  95.17342328772513
curr_Factors:  [95.17342329]
mat_Sqrt:  [[0.15]]
grads:  [-0.1876676]
Stock Position:  -0.18766760186011844
Bond Position:  [21.25327544]


portfolio before change:  [3.23781024]
curr_Stock_Price:  96.00375020050859
curr_Factors:  [96.0037502]
mat_Sqrt:  [[0.15]]
grads:  [0.39337253]
Stock Position:  0.3933725331622638
Bond Position:  [-34.52742817]


portfolio before change:  [3.57061854]
curr_Stock_Price:  96.85527466166292
curr_Factors:  [96.85527466]
mat_Sqrt:  [[0.15]]
grads:  [-0.04606493]
Stock Position:  -0.04606493437817181
Bond Position:  [8.03225041]


portfolio before change:  [3.52215142]
curr_Stock_Price:  97.91832073325094
curr_Factors:  [97.91832073]
mat_Sqrt:  [[0.15]]
grads:  [0.10257832]
Stock Position:  0.10257832133514658
Bond Position:  [-6.52214554]


portfolio before change:  [3.56773839]
curr_Stock_Price:  98.36670602563225
curr_Factors:  [98.36670603]
mat_Sqrt:  [[0.15]]
grads:  [0.07645224]
Stock Position:  0.0764522449430009
Bond Position:  [-3.95261711]


portfolio before change:  [3.55317402]
curr_Stock_Price:  98.17943452443427
curr_Factors:  [98.17943452]
mat_Sqrt:  [[0.15]]
grads:  [-0.13062501]
Stock Position:  -0.13062501073777605
Bond Position:  [16.3778637]


portfolio before change:  [3.49165478]
curr_Stock_Price:  98.65823165621866
curr_Factors:  [98.65823166]
mat_Sqrt:  [[0.15]]
grads:  [-0.00913917]
Stock Position:  -0.009139168611548521
Bond Position:  [4.393309]


portfolio before change:  [3.48973653]
curr_Stock_Price:  98.89817090439172
curr_Factors:  [98.8981709]
mat_Sqrt:  [[0.15]]
grads:  [0.12382863]
Stock Position:  0.12382863028498814
Bond Position:  [-8.75668851]


portfolio before change:  [3.44509807]
curr_Stock_Price:  98.54210506492984
curr_Factors:  [98.54210506]
mat_Sqrt:  [[0.15]]
grads:  [0.03146738]
Stock Position:  0.031467375757914536
Bond Position:  [0.34423663]


portfolio before change:  [3.49942097]
curr_Stock_Price:  100.26774572177784
curr_Factors:  [100.26774572]
mat_Sqrt:  [[0.15]]
grads:  [0.01894141]
Stock Position:  0.018941413999925914
Bond Position:  [1.60020809]


portfolio before change:  [3.49712733]
curr_Stock_Price:  100.14137408055124
curr_Factors:  [100.14137408]
mat_Sqrt:  [[0.15]]
grads:  [-0.37972173]
Stock Position:  -0.37972173306059276
Bond Position:  [41.52298345]


portfolio before change:  [3.61662542]
curr_Stock_Price:  99.83350963147662
curr_Factors:  [99.83350963]
mat_Sqrt:  [[0.15]]
grads:  [-0.03319909]
Stock Position:  -0.03319909233070432
Bond Position:  [6.93100732]


portfolio before change:  [3.61246999]
curr_Stock_Price:  99.97172511574419
curr_Factors:  [99.97172512]
mat_Sqrt:  [[0.15]]
grads:  [0.04710971]
Stock Position:  0.04710971296012542
Bond Position:  [-1.09716928]


portfolio before change:  [3.60341196]
curr_Stock_Price:  99.78090556446463
curr_Factors:  [99.78090556]
mat_Sqrt:  [[0.15]]
grads:  [-0.02067489]
Stock Position:  -0.020674892471434874
Bond Position:  [5.66637146]


portfolio before change:  [3.60545573]
curr_Stock_Price:  99.69918303206417
curr_Factors:  [99.69918303]
mat_Sqrt:  [[0.15]]
grads:  [-0.01080087]
Stock Position:  -0.010800868352475035
Bond Position:  [4.68229348]


portfolio before change:  [3.60862067]
curr_Stock_Price:  99.43325195093855
curr_Factors:  [99.43325195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01215701]
Stock Position:  -0.012157013844522677
Bond Position:  [4.81743209]


portfolio before change:  [3.61374838]
curr_Stock_Price:  99.03622871689242
curr_Factors:  [99.03622872]
mat_Sqrt:  [[0.15]]
grads:  [0.06997841]
Stock Position:  0.06997840757593504
Bond Position:  [-3.3166492]


portfolio before change:  [3.62478067]
curr_Stock_Price:  99.19684370049973
curr_Factors:  [99.1968437]
mat_Sqrt:  [[0.15]]
grads:  [0.0996788]
Stock Position:  0.09967880128599055
Bond Position:  [-6.26304181]


portfolio before change:  [3.70554111]
curr_Stock_Price:  100.01097769608903
curr_Factors:  [100.0109777]
mat_Sqrt:  [[0.15]]
grads:  [0.0722105]
Stock Position:  0.07221049732471581
Bond Position:  [-3.51630132]


portfolio before change:  [3.66272911]
curr_Stock_Price:  99.42114333181284
curr_Factors:  [99.42114333]
mat_Sqrt:  [[0.15]]
grads:  [0.03040406]
Stock Position:  0.030404057031353567
Bond Position:  [0.63992299]


portfolio before change:  [3.66586822]
curr_Stock_Price:  99.52307426551694
curr_Factors:  [99.52307427]
mat_Sqrt:  [[0.15]]
grads:  [0.04026742]
Stock Position:  0.04026742330644864
Bond Position:  [-0.34166954]


portfolio before change:  [3.65172513]
curr_Stock_Price:  99.17237549401719
curr_Factors:  [99.17237549]
mat_Sqrt:  [[0.15]]
grads:  [-0.01491144]
Stock Position:  -0.014911442896444218
Bond Position:  [5.13052834]


portfolio before change:  [3.65032751]
curr_Stock_Price:  99.28760808506316
curr_Factors:  [99.28760809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04276147]
Stock Position:  -0.04276146633303881
Bond Position:  [7.89601122]


portfolio before change:  [3.65615708]
curr_Stock_Price:  99.16282147931777
curr_Factors:  [99.16282148]
mat_Sqrt:  [[0.15]]
grads:  [-0.01474863]
Stock Position:  -0.014748629041149725
Bond Position:  [5.11867275]


portfolio before change:  [3.65030388]
curr_Stock_Price:  99.5813778976623
curr_Factors:  [99.5813779]
mat_Sqrt:  [[0.15]]
grads:  [0.01242157]
Stock Position:  0.012421565935602598
Bond Position:  [2.41334723]


portfolio before change:  [3.66073769]
curr_Stock_Price:  100.40921055161645
curr_Factors:  [100.40921055]
mat_Sqrt:  [[0.15]]
grads:  [0.00870894]
Stock Position:  0.008708943432389933
Bond Position:  [2.78627956]


portfolio before change:  [3.65921883]
curr_Stock_Price:  100.21481132874965
curr_Factors:  [100.21481133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02842102]
Stock Position:  -0.02842102100879632
Bond Position:  [6.50742609]


portfolio before change:  [3.66176479]
curr_Stock_Price:  100.13954180001883
curr_Factors:  [100.1395418]
mat_Sqrt:  [[0.15]]
grads:  [-0.02746353]
Stock Position:  -0.027463532924845425
Bond Position:  [6.4119504]


portfolio before change:  [3.69655289]
curr_Stock_Price:  98.88743284999669
curr_Factors:  [98.88743285]
mat_Sqrt:  [[0.15]]
grads:  [0.00839722]
Stock Position:  0.008397216473921934
Bond Position:  [2.86617371]


portfolio before change:  [3.69630233]
curr_Stock_Price:  98.83626124088602
curr_Factors:  [98.83626124]
mat_Sqrt:  [[0.15]]
grads:  [0.05993011]
Stock Position:  0.05993011185045384
Bond Position:  [-2.22696586]


portfolio before change:  [3.75423233]
curr_Stock_Price:  99.8052096678671
curr_Factors:  [99.80520967]
mat_Sqrt:  [[0.15]]
grads:  [0.04805354]
Stock Position:  0.048053539609649934
Bond Position:  [-1.04176127]


portfolio before change:  [3.71080031]
curr_Stock_Price:  98.90273900172423
curr_Factors:  [98.902739]
mat_Sqrt:  [[0.15]]
grads:  [-0.02643937]
Stock Position:  -0.026439371134295734
Bond Position:  [6.32572653]


portfolio before change:  [3.71293016]
curr_Stock_Price:  98.83713657974245
curr_Factors:  [98.83713658]
mat_Sqrt:  [[0.15]]
grads:  [-0.01303315]
Stock Position:  -0.0130331479932432
Bond Position:  [5.00108919]


portfolio before change:  [3.71131913]
curr_Stock_Price:  98.98473019457339
curr_Factors:  [98.98473019]
mat_Sqrt:  [[0.15]]
grads:  [0.0128962]
Stock Position:  0.012896202030655045
Bond Position:  [2.43479205]


portfolio before change:  [3.72138818]
curr_Stock_Price:  99.75370599170263
curr_Factors:  [99.75370599]
mat_Sqrt:  [[0.15]]
grads:  [-0.04743321]
Stock Position:  -0.04743321056586604
Bond Position:  [8.45302672]


portfolio before change:  [3.72249888]
curr_Stock_Price:  99.74142823160322
curr_Factors:  [99.74142823]
mat_Sqrt:  [[0.15]]
grads:  [0.04797994]
Stock Position:  0.04797994153595922
Bond Position:  [-1.06308901]


portfolio before change:  [3.67867768]
curr_Stock_Price:  98.8294896762015
curr_Factors:  [98.82948968]
mat_Sqrt:  [[0.15]]
grads:  [0.13296994]
Stock Position:  0.132969941379659
Bond Position:  [-9.46267377]


portfolio before change:  [3.82463073]
curr_Stock_Price:  99.9315769781045
curr_Factors:  [99.93157698]
mat_Sqrt:  [[0.15]]
grads:  [0.0365028]
Stock Position:  0.03650280144047371
Bond Position:  [0.17684822]


portfolio before change:  [3.84145792]
curr_Stock_Price:  100.39225779701921
curr_Factors:  [100.3922578]
mat_Sqrt:  [[0.15]]
grads:  [0.05497355]
Stock Position:  0.05497354516501129
Bond Position:  [-1.6774604]


portfolio before change:  [3.84655879]
curr_Stock_Price:  100.48695264902045
curr_Factors:  [100.48695265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00613559]
Stock Position:  -0.006135586047829629
Bond Position:  [4.46310513]


portfolio before change:  [3.84469383]
curr_Stock_Price:  100.83637436819018
curr_Factors:  [100.83637437]
mat_Sqrt:  [[0.15]]
grads:  [0.01794344]
Stock Position:  0.017943441070033636
Bond Position:  [2.03534229]


portfolio before change:  [3.85101811]
curr_Stock_Price:  101.18174073030328
curr_Factors:  [101.18174073]
mat_Sqrt:  [[0.15]]
grads:  [0.1328753]
Stock Position:  0.13287529507457746
Bond Position:  [-9.59353555]


portfolio before change:  [3.86553536]
curr_Stock_Price:  101.29550808408237
curr_Factors:  [101.29550808]
mat_Sqrt:  [[0.15]]
grads:  [0.00319924]
Stock Position:  0.0031992438213463478
Bond Position:  [3.54146634]


portfolio before change:  [3.86644496]
curr_Stock_Price:  101.51063735703188
curr_Factors:  [101.51063736]
mat_Sqrt:  [[0.15]]
grads:  [-0.10518746]
Stock Position:  -0.1051874592768799
Bond Position:  [14.544091]


portfolio before change:  [3.87442459]
curr_Stock_Price:  101.4434183830197
curr_Factors:  [101.44341838]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158508]
Stock Position:  -0.001585080328104493
Bond Position:  [4.03522056]


portfolio before change:  [3.87493493]
curr_Stock_Price:  101.28056932657077
curr_Factors:  [101.28056933]
mat_Sqrt:  [[0.15]]
grads:  [0.00935589]
Stock Position:  0.00935588890146292
Bond Position:  [2.92736517]


portfolio before change:  [3.87897423]
curr_Stock_Price:  101.69275242150464
curr_Factors:  [101.69275242]
mat_Sqrt:  [[0.15]]
grads:  [0.00876489]
Stock Position:  0.008764891886745466
Bond Position:  [2.98764825]


portfolio before change:  [3.8844259]
curr_Stock_Price:  102.29343626969812
curr_Factors:  [102.29343627]
mat_Sqrt:  [[0.15]]
grads:  [-0.09750648]
Stock Position:  -0.09750648319241571
Bond Position:  [13.85869912]


portfolio before change:  [3.86703043]
curr_Stock_Price:  102.48072294115349
curr_Factors:  [102.48072294]
mat_Sqrt:  [[0.15]]
grads:  [-0.02572469]
Stock Position:  -0.025724688164859597
Bond Position:  [6.50331507]


portfolio before change:  [3.87238049]
curr_Stock_Price:  102.28854981211757
curr_Factors:  [102.28854981]
mat_Sqrt:  [[0.15]]
grads:  [0.0997172]
Stock Position:  0.09971720420658607
Bond Position:  [-6.32754772]


portfolio before change:  [3.786528]
curr_Stock_Price:  101.43155621814847
curr_Factors:  [101.43155622]
mat_Sqrt:  [[0.15]]
grads:  [-0.06265433]
Stock Position:  -0.06265432603737973
Bond Position:  [10.1416538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.75413222]
Stock Price:  101.95872903661103
PL:  [1.79540318]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37519555e-02]
 [ 1.00592518e-02]
 [ 1.20813375e-02]
 [-9.94799304e-03]
 [ 1.07566380e-03]
 [-7.58903441e-03]
 [-1.05679873e-02]
 [ 4.48517990e-03]
 [-6.09040030e-04]
 [-1.25810447e-02]
 [ 1.08312434e-02]
 [-6.84032412e-03]
 [-9.35682954e-04]
 [ 4.83255072e-03]
 [-8.74951531e-04]
 [ 1.01058415e-02]
 [ 3.73714497e-03]
 [-1.41075552e-02]
 [ 2.50413848e-02]
 [ 3.49604465e-04]
 [-3.57963929e-03]
 [ 5.26669569e-03]
 [ 1.60801688e-02]
 [ 1.97077928e-02]
 [-9.88592916e-04]
 [ 4.41941523e-03]
 [ 4.47551423e-03]
 [ 1.02008750e-02]
 [ 1.59752845e-02]
 [ 1.81468941e-02]
 [-6.58065777e-03]
 [ 1.73889429e-02]
 [ 1.18911881e-02]
 [-2.00714767e-02]
 [-7.93542984e-03]
 [ 1.14052886e-02]
 [ 7.89820980e-03]
 [-1.49870599e-03]
 [-3.51669763e-02]
 [-1.06620529e-02]
 [ 7.11810710e-03]
 [ 3.42458486e-02]
 [-3.37348354e-03]
 [ 1.92193151e-02]
 [-5.24694378e-02]
 [ 2.11879055e-02]
 [ 9.53540499e-03]
 [ 5.35247225e-03]
 [-8.22730920e-03]
 [-5.40853336e-05]
 [-1.98077770e-03]
 [-4.65488283e-04]
 [ 6.58153221e-04]
 [ 7.54413265e-03]
 [-9.72755922e-03]
 [-4.77107314e-03]
 [-1.29812865e-03]
 [ 1.26026028e-02]
 [ 7.83704515e-03]
 [-3.63627431e-03]
 [-2.35043189e-03]
 [ 2.13796139e-03]
 [-6.14646730e-03]
 [ 2.53772870e-03]
 [ 2.00037935e-02]
 [ 5.17954510e-03]
 [ 8.57547367e-03]
 [-4.07067129e-04]
 [ 2.80155444e-03]
 [ 2.18307377e-02]
 [ 2.59124673e-03]
 [-1.59654223e-02]
 [-6.42616588e-03]
 [ 1.14089557e-03]
 [ 1.66224830e-03]
 [ 8.32970472e-05]
 [-1.51091107e-03]
 [-6.25184607e-03]
 [-2.31044527e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.54500113]
curr_Stock_Price:  99.88305274366253
curr_Factors:  [99.88305274]
mat_Sqrt:  [[0.15]]
grads:  [-0.0916797]
Stock Position:  -0.09167970303172726
Bond Position:  [8.61224748]


portfolio before change:  [-0.55210692]
curr_Stock_Price:  99.96643073638626
curr_Factors:  [99.96643074]
mat_Sqrt:  [[0.15]]
grads:  [0.06706168]
Stock Position:  0.06706167885342933
Bond Position:  [-7.25602359]


portfolio before change:  [-0.52740968]
curr_Stock_Price:  100.34146985529503
curr_Factors:  [100.34146986]
mat_Sqrt:  [[0.15]]
grads:  [0.08054225]
Stock Position:  0.08054224967551198
Bond Position:  [-8.6091374]


portfolio before change:  [-0.52311432]
curr_Stock_Price:  100.40148119661399
curr_Factors:  [100.4014812]
mat_Sqrt:  [[0.15]]
grads:  [-0.06631995]
Stock Position:  -0.06631995359951617
Bond Position:  [6.13550725]


portfolio before change:  [-0.52991]
curr_Stock_Price:  100.50973161481568
curr_Factors:  [100.50973161]
mat_Sqrt:  [[0.15]]
grads:  [0.00717109]
Stock Position:  0.00717109202642297
Bond Position:  [-1.25067454]


portfolio before change:  [-0.53477353]
curr_Stock_Price:  99.84241883738002
curr_Factors:  [99.84241884]
mat_Sqrt:  [[0.15]]
grads:  [-0.05059356]
Stock Position:  -0.05059356273468049
Bond Position:  [4.51661015]


portfolio before change:  [-0.48222326]
curr_Stock_Price:  98.80932353825372
curr_Factors:  [98.80932354]
mat_Sqrt:  [[0.15]]
grads:  [-0.07045325]
Stock Position:  -0.07045324884741862
Bond Position:  [6.4792146]


portfolio before change:  [-0.51341798]
curr_Stock_Price:  99.2578434314536
curr_Factors:  [99.25784343]
mat_Sqrt:  [[0.15]]
grads:  [0.0299012]
Stock Position:  0.029901199306086867
Bond Position:  [-3.48134654]


portfolio before change:  [-0.48326549]
curr_Stock_Price:  100.27352469433231
curr_Factors:  [100.27352469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00406027]
Stock Position:  -0.004060266865553996
Bond Position:  [-0.07612822]


portfolio before change:  [-0.47732437]
curr_Stock_Price:  98.80911899287395
curr_Factors:  [98.80911899]
mat_Sqrt:  [[0.15]]
grads:  [-0.08387363]
Stock Position:  -0.0838736310375055
Bond Position:  [7.81015522]


portfolio before change:  [-0.45267514]
curr_Stock_Price:  98.5210537680435
curr_Factors:  [98.52105377]
mat_Sqrt:  [[0.15]]
grads:  [0.07220829]
Stock Position:  0.07220828933621148
Bond Position:  [-7.5667119]


portfolio before change:  [-0.48183913]
curr_Stock_Price:  98.12371636683595
curr_Factors:  [98.12371637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04560216]
Stock Position:  -0.04560216077504144
Bond Position:  [3.99281436]


portfolio before change:  [-0.54110288]
curr_Stock_Price:  99.42877098130784
curr_Factors:  [99.42877098]
mat_Sqrt:  [[0.15]]
grads:  [-0.00623789]
Stock Position:  -0.006237886357650438
Bond Position:  [0.07912249]


portfolio before change:  [-0.53903408]
curr_Stock_Price:  99.09791351010568
curr_Factors:  [99.09791351]
mat_Sqrt:  [[0.15]]
grads:  [0.032217]
Stock Position:  0.03221700482932486
Bond Position:  [-3.73167204]


portfolio before change:  [-0.53405626]
curr_Stock_Price:  99.25966216195782
curr_Factors:  [99.25966216]
mat_Sqrt:  [[0.15]]
grads:  [-0.00583301]
Stock Position:  -0.0058330102039352155
Bond Position:  [0.04492636]


portfolio before change:  [-0.53276211]
curr_Stock_Price:  99.03827639173382
curr_Factors:  [99.03827639]
mat_Sqrt:  [[0.15]]
grads:  [0.06737228]
Stock Position:  0.06737227643464787
Bond Position:  [-7.20519625]


portfolio before change:  [-0.55781868]
curr_Stock_Price:  98.67304850790985
curr_Factors:  [98.67304851]
mat_Sqrt:  [[0.15]]
grads:  [0.0249143]
Stock Position:  0.024914299775813758
Bond Position:  [-3.01618859]


portfolio before change:  [-0.55300912]
curr_Stock_Price:  98.87365930042974
curr_Factors:  [98.8736593]
mat_Sqrt:  [[0.15]]
grads:  [-0.09405037]
Stock Position:  -0.09405036832663226
Bond Position:  [8.74609495]


portfolio before change:  [-0.53550264]
curr_Stock_Price:  98.69333217377653
curr_Factors:  [98.69333217]
mat_Sqrt:  [[0.15]]
grads:  [0.16694257]
Stock Position:  0.16694256543017466
Bond Position:  [-17.01162071]


portfolio before change:  [-0.5184676]
curr_Stock_Price:  98.80174251742584
curr_Factors:  [98.80174252]
mat_Sqrt:  [[0.15]]
grads:  [0.0023307]
Stock Position:  0.0023306964336527783
Bond Position:  [-0.74874447]


portfolio before change:  [-0.51654586]
curr_Stock_Price:  99.64635715927005
curr_Factors:  [99.64635716]
mat_Sqrt:  [[0.15]]
grads:  [-0.02386426]
Stock Position:  -0.02386426196025998
Bond Position:  [1.86144091]


portfolio before change:  [-0.502643]
curr_Stock_Price:  99.06865153833067
curr_Factors:  [99.06865154]
mat_Sqrt:  [[0.15]]
grads:  [0.0351113]
Stock Position:  0.035111304627771685
Bond Position:  [-3.9810726]


portfolio before change:  [-0.52211526]
curr_Stock_Price:  98.5211516303418
curr_Factors:  [98.52115163]
mat_Sqrt:  [[0.15]]
grads:  [0.10720113]
Stock Position:  0.10720112510546431
Bond Position:  [-11.08369356]


portfolio before change:  [-0.54917037]
curr_Stock_Price:  98.27523664378762
curr_Factors:  [98.27523664]
mat_Sqrt:  [[0.15]]
grads:  [0.13138529]
Stock Position:  0.13138528524506046
Bond Position:  [-13.46109037]


portfolio before change:  [-0.59863654]
curr_Stock_Price:  97.90514329366552
curr_Factors:  [97.90514329]
mat_Sqrt:  [[0.15]]
grads:  [-0.00659062]
Stock Position:  -0.006590619437144193
Bond Position:  [0.046619]


portfolio before change:  [-0.59799664]
curr_Stock_Price:  97.80849360769454
curr_Factors:  [97.80849361]
mat_Sqrt:  [[0.15]]
grads:  [0.02946277]
Stock Position:  0.02946276817975416
Bond Position:  [-3.47970562]


portfolio before change:  [-0.59513241]
curr_Stock_Price:  97.9130909513098
curr_Factors:  [97.91309095]
mat_Sqrt:  [[0.15]]
grads:  [0.02983676]
Stock Position:  0.02983676156395458
Bond Position:  [-3.51654195]


portfolio before change:  [-0.61345094]
curr_Stock_Price:  97.30649873591824
curr_Factors:  [97.30649874]
mat_Sqrt:  [[0.15]]
grads:  [0.06800583]
Stock Position:  0.06800583345350718
Bond Position:  [-7.23086049]


portfolio before change:  [-0.57523442]
curr_Stock_Price:  97.87510393561473
curr_Factors:  [97.87510394]
mat_Sqrt:  [[0.15]]
grads:  [0.1065019]
Stock Position:  0.10650189652626013
Bond Position:  [-10.99911861]


portfolio before change:  [-0.56681457]
curr_Stock_Price:  97.9606171126279
curr_Factors:  [97.96061711]
mat_Sqrt:  [[0.15]]
grads:  [0.12097929]
Stock Position:  0.12097929422480404
Bond Position:  [-12.41802089]


portfolio before change:  [-0.58114337]
curr_Stock_Price:  97.84859256608567
curr_Factors:  [97.84859257]
mat_Sqrt:  [[0.15]]
grads:  [-0.04387105]
Stock Position:  -0.04387105177976822
Bond Position:  [3.7115773]


portfolio before change:  [-0.56358238]
curr_Stock_Price:  97.45359399424864
curr_Factors:  [97.45359399]
mat_Sqrt:  [[0.15]]
grads:  [0.11592629]
Stock Position:  0.11592628587605174
Bond Position:  [-11.86101558]


portfolio before change:  [-0.58730413]
curr_Stock_Price:  97.25536102783683
curr_Factors:  [97.25536103]
mat_Sqrt:  [[0.15]]
grads:  [0.07927459]
Stock Position:  0.07927458752419644
Bond Position:  [-8.29718276]


portfolio before change:  [-0.60091336]
curr_Stock_Price:  97.09023075209912
curr_Factors:  [97.09023075]
mat_Sqrt:  [[0.15]]
grads:  [-0.13380984]
Stock Position:  -0.13380984458604706
Bond Position:  [12.39071533]


portfolio before change:  [-0.65981921]
curr_Stock_Price:  97.53623902003105
curr_Factors:  [97.53623902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05290287]
Stock Position:  -0.05290286557056945
Bond Position:  [4.50012733]


portfolio before change:  [-0.64946207]
curr_Stock_Price:  97.345779189918
curr_Factors:  [97.34577919]
mat_Sqrt:  [[0.15]]
grads:  [0.07603526]
Stock Position:  0.07603525732393063
Bond Position:  [-8.05117344]


portfolio before change:  [-0.68756099]
curr_Stock_Price:  96.85132825750111
curr_Factors:  [96.85132826]
mat_Sqrt:  [[0.15]]
grads:  [0.05265473]
Stock Position:  0.05265473198635897
Bond Position:  [-5.78724172]


portfolio before change:  [-0.68643445]
curr_Stock_Price:  96.87959260777336
curr_Factors:  [96.87959261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00999137]
Stock Position:  -0.009991373246214363
Bond Position:  [0.28152572]


portfolio before change:  [-0.69480305]
curr_Stock_Price:  97.71893560039014
curr_Factors:  [97.7189356]
mat_Sqrt:  [[0.15]]
grads:  [-0.23444651]
Stock Position:  -0.23444650843881099
Bond Position:  [22.21506021]


portfolio before change:  [-0.52089903]
curr_Stock_Price:  96.98309382511962
curr_Factors:  [96.98309383]
mat_Sqrt:  [[0.15]]
grads:  [-0.07108035]
Stock Position:  -0.0710803525989876
Bond Position:  [6.37269348]


portfolio before change:  [-0.5641689]
curr_Stock_Price:  97.59744336442417
curr_Factors:  [97.59744336]
mat_Sqrt:  [[0.15]]
grads:  [0.04745405]
Stock Position:  0.04745404733703377
Bond Position:  [-5.1955626]


portfolio before change:  [-0.60520637]
curr_Stock_Price:  96.73950311389228
curr_Factors:  [96.73950311]
mat_Sqrt:  [[0.15]]
grads:  [0.22830566]
Stock Position:  0.22830565756747023
Bond Position:  [-22.69138224]


portfolio before change:  [-0.92239954]
curr_Stock_Price:  95.35637964630895
curr_Factors:  [95.35637965]
mat_Sqrt:  [[0.15]]
grads:  [-0.02248989]
Stock Position:  -0.022489890289520274
Bond Position:  [1.22215498]


portfolio before change:  [-0.92557319]
curr_Stock_Price:  95.50089045681494
curr_Factors:  [95.50089046]
mat_Sqrt:  [[0.15]]
grads:  [0.12812877]
Stock Position:  0.1281287673344755
Bond Position:  [-13.16198456]


portfolio before change:  [-0.93365899]
curr_Stock_Price:  95.44420410143546
curr_Factors:  [95.4442041]
mat_Sqrt:  [[0.15]]
grads:  [-0.34979625]
Stock Position:  -0.3497962521078857
Bond Position:  [32.45236589]


portfolio before change:  [-1.1595378]
curr_Stock_Price:  96.09574665422136
curr_Factors:  [96.09574665]
mat_Sqrt:  [[0.15]]
grads:  [0.1412527]
Stock Position:  0.14125270328650955
Bond Position:  [-14.73332178]


portfolio before change:  [-1.14014163]
curr_Stock_Price:  96.23958122626846
curr_Factors:  [96.23958123]
mat_Sqrt:  [[0.15]]
grads:  [0.06356937]
Stock Position:  0.06356936658825368
Bond Position:  [-7.25803085]


portfolio before change:  [-1.15514091]
curr_Stock_Price:  96.0107661095002
curr_Factors:  [96.01076611]
mat_Sqrt:  [[0.15]]
grads:  [0.03568315]
Stock Position:  0.03568314831166687
Bond Position:  [-4.58110731]


portfolio before change:  [-1.14751988]
curr_Stock_Price:  96.23236519564995
curr_Factors:  [96.2323652]
mat_Sqrt:  [[0.15]]
grads:  [-0.05484873]
Stock Position:  -0.05484872798708224
Bond Position:  [4.13070294]


portfolio before change:  [-1.13087715]
curr_Stock_Price:  95.93364260083737
curr_Factors:  [95.9336426]
mat_Sqrt:  [[0.15]]
grads:  [-0.00036057]
Stock Position:  -0.00036056889042992025
Bond Position:  [-1.09628646]


portfolio before change:  [-1.13075246]
curr_Stock_Price:  95.39779855675434
curr_Factors:  [95.39779856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01320518]
Stock Position:  -0.013205184664517172
Bond Position:  [0.12899308]


portfolio before change:  [-1.14750222]
curr_Stock_Price:  96.66683200470959
curr_Factors:  [96.666832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00310326]
Stock Position:  -0.0031032552182042386
Bond Position:  [-0.84752037]


portfolio before change:  [-1.1492757]
curr_Stock_Price:  97.22125072079585
curr_Factors:  [97.22125072]
mat_Sqrt:  [[0.15]]
grads:  [0.00438769]
Stock Position:  0.0043876881415887
Bond Position:  [-1.57585222]


portfolio before change:  [-1.15078327]
curr_Stock_Price:  96.90010675212548
curr_Factors:  [96.90010675]
mat_Sqrt:  [[0.15]]
grads:  [0.05029422]
Stock Position:  0.05029421767471918
Bond Position:  [-6.02429833]


portfolio before change:  [-1.14112301]
curr_Stock_Price:  97.09966830889717
curr_Factors:  [97.09966831]
mat_Sqrt:  [[0.15]]
grads:  [-0.06485039]
Stock Position:  -0.06485039477491879
Bond Position:  [5.15582882]


portfolio before change:  [-1.13724069]
curr_Stock_Price:  97.04477169677112
curr_Factors:  [97.0447717]
mat_Sqrt:  [[0.15]]
grads:  [-0.03180715]
Stock Position:  -0.031807154294212686
Bond Position:  [1.94947734]


portfolio before change:  [-1.12729647]
curr_Stock_Price:  96.73596136619939
curr_Factors:  [96.73596137]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865419]
Stock Position:  -0.00865419098173809
Bond Position:  [-0.29012498]


portfolio before change:  [-1.12735681]
curr_Stock_Price:  96.74083829363332
curr_Factors:  [96.74083829]
mat_Sqrt:  [[0.15]]
grads:  [0.08401735]
Stock Position:  0.08401735188551697
Bond Position:  [-9.25526586]


portfolio before change:  [-1.11834887]
curr_Stock_Price:  96.85493868571555
curr_Factors:  [96.85493869]
mat_Sqrt:  [[0.15]]
grads:  [0.05224697]
Stock Position:  0.05224696765871527
Bond Position:  [-6.17872571]


portfolio before change:  [-1.07280965]
curr_Stock_Price:  97.73394461941477
curr_Factors:  [97.73394462]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424183]
Stock Position:  -0.024241828704700114
Bond Position:  [1.29643989]


portfolio before change:  [-1.09571811]
curr_Stock_Price:  98.68228424319523
curr_Factors:  [98.68228424]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566955]
Stock Position:  -0.01566954592165028
Bond Position:  [0.45058847]


portfolio before change:  [-1.10169392]
curr_Stock_Price:  99.06544596770652
curr_Factors:  [99.06544597]
mat_Sqrt:  [[0.15]]
grads:  [0.01425308]
Stock Position:  0.014253075945407536
Bond Position:  [-2.51368124]


portfolio before change:  [-1.10769523]
curr_Stock_Price:  98.65541527913396
curr_Factors:  [98.65541528]
mat_Sqrt:  [[0.15]]
grads:  [-0.04097645]
Stock Position:  -0.04097644869224272
Bond Position:  [2.93485334]


portfolio before change:  [-1.10709037]
curr_Stock_Price:  98.64513081043306
curr_Factors:  [98.64513081]
mat_Sqrt:  [[0.15]]
grads:  [0.01691819]
Stock Position:  0.01691819134789352
Bond Position:  [-2.77598757]


portfolio before change:  [-1.1054416]
curr_Stock_Price:  98.75284171913196
curr_Factors:  [98.75284172]
mat_Sqrt:  [[0.15]]
grads:  [0.13335862]
Stock Position:  0.13335862335381626
Bond Position:  [-14.27498463]


portfolio before change:  [-1.07229542]
curr_Stock_Price:  99.00808126310555
curr_Factors:  [99.00808126]
mat_Sqrt:  [[0.15]]
grads:  [0.0345303]
Stock Position:  0.03453030066145711
Bond Position:  [-4.49107424]


portfolio before change:  [-1.06870106]
curr_Stock_Price:  99.12030337163876
curr_Factors:  [99.12030337]
mat_Sqrt:  [[0.15]]
grads:  [0.05716982]
Stock Position:  0.0571698244571225
Bond Position:  [-6.7353914]


portfolio before change:  [-1.04719635]
curr_Stock_Price:  99.50382190664212
curr_Factors:  [99.50382191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271378]
Stock Position:  -0.00271378085852432
Bond Position:  [-0.77716478]


portfolio before change:  [-1.04690943]
curr_Stock_Price:  99.38019699638454
curr_Factors:  [99.380197]
mat_Sqrt:  [[0.15]]
grads:  [0.01867703]
Stock Position:  0.018677029588926093
Bond Position:  [-2.90303631]


portfolio before change:  [-1.05085844]
curr_Stock_Price:  99.17847500133306
curr_Factors:  [99.178475]
mat_Sqrt:  [[0.15]]
grads:  [0.14553825]
Stock Position:  0.145538251314731
Bond Position:  [-15.48512026]


portfolio before change:  [-1.12834934]
curr_Stock_Price:  98.6526816611131
curr_Factors:  [98.65268166]
mat_Sqrt:  [[0.15]]
grads:  [0.01727498]
Stock Position:  0.017274978180642695
Bond Position:  [-2.83257226]


portfolio before change:  [-1.1146687]
curr_Stock_Price:  99.45486367439514
curr_Factors:  [99.45486367]
mat_Sqrt:  [[0.15]]
grads:  [-0.10643615]
Stock Position:  -0.10643614898361631
Bond Position:  [9.47092398]


portfolio before change:  [-1.03385369]
curr_Stock_Price:  98.70114360073846
curr_Factors:  [98.7011436]
mat_Sqrt:  [[0.15]]
grads:  [-0.04284111]
Stock Position:  -0.04284110589413584
Bond Position:  [3.19461246]


portfolio before change:  [-1.05983392]
curr_Stock_Price:  99.31223662862176
curr_Factors:  [99.31223663]
mat_Sqrt:  [[0.15]]
grads:  [0.00760597]
Stock Position:  0.007605970449093041
Bond Position:  [-1.81519986]


portfolio before change:  [-1.05852378]
curr_Stock_Price:  99.49940453072315
curr_Factors:  [99.49940453]
mat_Sqrt:  [[0.15]]
grads:  [0.01108166]
Stock Position:  0.011081655315887598
Bond Position:  [-2.16114189]


portfolio before change:  [-1.07429514]
curr_Stock_Price:  98.08839819544215
curr_Factors:  [98.0883982]
mat_Sqrt:  [[0.15]]
grads:  [0.00055531]
Stock Position:  0.0005553136476842714
Bond Position:  [-1.12876497]


portfolio before change:  [-1.07457267]
curr_Stock_Price:  97.71568164556669
curr_Factors:  [97.71568165]
mat_Sqrt:  [[0.15]]
grads:  [-0.01007274]
Stock Position:  -0.01007274043952701
Bond Position:  [-0.09030797]


portfolio before change:  [-1.07208642]
curr_Stock_Price:  97.46829211737371
curr_Factors:  [97.46829212]
mat_Sqrt:  [[0.15]]
grads:  [-0.04167897]
Stock Position:  -0.04167897382893633
Bond Position:  [2.99029198]


portfolio before change:  [-1.07664642]
curr_Stock_Price:  97.58218409056526
curr_Factors:  [97.58218409]
mat_Sqrt:  [[0.15]]
grads:  [-0.15402968]
Stock Position:  -0.1540296843631744
Bond Position:  [13.95390659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.01890502]
Stock Price:  97.21297436854816
PL:  [-1.01890502]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.26593098e-02]
 [ 5.96704750e-04]
 [ 7.28732561e-03]
 [-7.81061314e-03]
 [ 1.23910293e-02]
 [-2.75326199e-03]
 [-9.90819086e-03]
 [-2.04903247e-02]
 [ 8.20414379e-03]
 [-1.32322571e-03]
 [ 6.48376928e-03]
 [-8.39559977e-04]
 [-2.39395579e-03]
 [ 9.51260292e-03]
 [-7.09885206e-04]
 [ 8.24548075e-03]
 [ 1.30970952e-02]
 [-1.26861723e-02]
 [ 2.49652739e-02]
 [-3.36215991e-03]
 [-2.26555326e-02]
 [ 6.09563489e-03]
 [ 1.43980242e-02]
 [ 1.98285277e-02]
 [ 2.37297102e-03]
 [ 4.45438082e-03]
 [ 4.05201765e-04]
 [ 1.18658427e-02]
 [ 1.61162092e-02]
 [ 8.91963665e-03]
 [-6.39779882e-03]
 [ 1.57750058e-02]
 [ 1.14882560e-02]
 [-1.97994998e-02]
 [-7.74816656e-03]
 [ 1.81308155e-02]
 [ 5.81612239e-03]
 [-8.42907905e-04]
 [-6.18771066e-03]
 [-1.59573409e-02]
 [ 7.08308339e-03]
 [ 2.72679033e-02]
 [-3.28699850e-03]
 [ 1.22857795e-02]
 [-2.64987121e-02]
 [ 1.88701780e-02]
 [ 9.89094791e-03]
 [ 5.31896162e-03]
 [-6.01545422e-03]
 [-1.30559833e-03]
 [-6.42457513e-03]
 [ 7.06254995e-04]
 [ 1.39696004e-03]
 [ 9.02605024e-03]
 [-8.03671589e-03]
 [-4.38504236e-03]
 [ 3.46695104e-04]
 [ 7.84649457e-03]
 [ 7.30011272e-03]
 [-4.01568879e-03]
 [-8.19929280e-04]
 [ 6.19902809e-03]
 [-9.73849452e-03]
 [ 7.62877140e-03]
 [ 2.17574171e-02]
 [ 5.46604616e-03]
 [ 7.69103768e-03]
 [-3.85875638e-04]
 [ 3.32077472e-03]
 [ 2.34159574e-02]
 [ 3.33856947e-03]
 [-1.53718683e-02]
 [-5.68293988e-03]
 [ 2.05458672e-03]
 [ 1.05597675e-02]
 [ 4.17829752e-03]
 [-6.79742513e-04]
 [-1.66254460e-02]
 [-2.52997957e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.47329757]
curr_Stock_Price:  99.34129396410832
curr_Factors:  [99.34129396]
mat_Sqrt:  [[0.15]]
grads:  [-0.0843954]
Stock Position:  -0.08439539854681759
Bond Position:  [-4.08934947]


portfolio before change:  [-12.49675706]
curr_Stock_Price:  99.61623673025123
curr_Factors:  [99.61623673]
mat_Sqrt:  [[0.15]]
grads:  [0.00397803]
Stock Position:  0.0039780316642032704
Bond Position:  [-12.89303361]


portfolio before change:  [-12.49800634]
curr_Stock_Price:  99.50476416468389
curr_Factors:  [99.50476416]
mat_Sqrt:  [[0.15]]
grads:  [0.04858217]
Stock Position:  0.04858217070355261
Bond Position:  [-17.33216378]


portfolio before change:  [-12.47582589]
curr_Stock_Price:  99.98361773413609
curr_Factors:  [99.98361773]
mat_Sqrt:  [[0.15]]
grads:  [-0.05207075]
Stock Position:  -0.05207075427645983
Bond Position:  [-7.2696035]


portfolio before change:  [-12.47854589]
curr_Stock_Price:  100.0271284716615
curr_Factors:  [100.02712847]
mat_Sqrt:  [[0.15]]
grads:  [0.08260686]
Stock Position:  0.08260686179658741
Bond Position:  [-20.74147307]


portfolio before change:  [-12.4469474]
curr_Stock_Price:  100.42533848420193
curr_Factors:  [100.42533848]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835508]
Stock Position:  -0.018355079925054057
Bond Position:  [-10.60363228]


portfolio before change:  [-12.45784058]
curr_Stock_Price:  100.98270089074464
curr_Factors:  [100.98270089]
mat_Sqrt:  [[0.15]]
grads:  [-0.06605461]
Stock Position:  -0.06605460574039022
Bond Position:  [-5.78746808]


portfolio before change:  [-12.43315491]
curr_Stock_Price:  100.60350869869168
curr_Factors:  [100.6035087]
mat_Sqrt:  [[0.15]]
grads:  [-0.13660216]
Stock Position:  -0.13660216491628308
Bond Position:  [1.30950217]


portfolio before change:  [-12.47242651]
curr_Stock_Price:  100.89159672454998
curr_Factors:  [100.89159672]
mat_Sqrt:  [[0.15]]
grads:  [0.05469429]
Stock Position:  0.05469429191763381
Bond Position:  [-17.99062096]


portfolio before change:  [-12.4632393]
curr_Stock_Price:  101.08012934563735
curr_Factors:  [101.08012935]
mat_Sqrt:  [[0.15]]
grads:  [-0.0088215]
Stock Position:  -0.008821504708394884
Bond Position:  [-11.57156047]


portfolio before change:  [-12.45820028]
curr_Stock_Price:  100.42692192431146
curr_Factors:  [100.42692192]
mat_Sqrt:  [[0.15]]
grads:  [0.04322513]
Stock Position:  0.043225128560026735
Bond Position:  [-16.79916689]


portfolio before change:  [-12.45876107]
curr_Stock_Price:  100.43823904723932
curr_Factors:  [100.43823905]
mat_Sqrt:  [[0.15]]
grads:  [-0.00559707]
Stock Position:  -0.005597066514142745
Bond Position:  [-11.89660157]


portfolio before change:  [-12.45837125]
curr_Stock_Price:  100.23574336744491
curr_Factors:  [100.23574337]
mat_Sqrt:  [[0.15]]
grads:  [-0.01595971]
Stock Position:  -0.015959705282423756
Bond Position:  [-10.85863833]


portfolio before change:  [-12.45724388]
curr_Stock_Price:  100.12257939370784
curr_Factors:  [100.12257939]
mat_Sqrt:  [[0.15]]
grads:  [0.06341735]
Stock Position:  0.06341735278594252
Bond Position:  [-18.80675282]


portfolio before change:  [-12.46762251]
curr_Stock_Price:  99.97745855317174
curr_Factors:  [99.97745855]
mat_Sqrt:  [[0.15]]
grads:  [-0.00473257]
Stock Position:  -0.004732568038231603
Bond Position:  [-11.99447239]


portfolio before change:  [-12.46237875]
curr_Stock_Price:  98.71103427581791
curr_Factors:  [98.71103428]
mat_Sqrt:  [[0.15]]
grads:  [0.05496987]
Stock Position:  0.054969871672835964
Bond Position:  [-17.88851164]


portfolio before change:  [-12.44631671]
curr_Stock_Price:  99.02357113554852
curr_Factors:  [99.02357114]
mat_Sqrt:  [[0.15]]
grads:  [0.08731397]
Stock Position:  0.08731396816842324
Bond Position:  [-21.09245765]


portfolio before change:  [-12.52913393]
curr_Stock_Price:  98.090170626441
curr_Factors:  [98.09017063]
mat_Sqrt:  [[0.15]]
grads:  [-0.08457448]
Stock Position:  -0.08457448218854652
Bond Position:  [-4.23320854]


portfolio before change:  [-12.55379166]
curr_Stock_Price:  98.37859265370004
curr_Factors:  [98.37859265]
mat_Sqrt:  [[0.15]]
grads:  [0.16643516]
Stock Position:  0.16643515926806596
Bond Position:  [-28.9274484]


portfolio before change:  [-12.77531963]
curr_Stock_Price:  97.05843921314091
curr_Factors:  [97.05843921]
mat_Sqrt:  [[0.15]]
grads:  [-0.0224144]
Stock Position:  -0.02241439937745782
Bond Position:  [-10.59981301]


portfolio before change:  [-12.76212463]
curr_Stock_Price:  96.44019804661419
curr_Factors:  [96.44019805]
mat_Sqrt:  [[0.15]]
grads:  [-0.15103688]
Stock Position:  -0.15103688381964092
Bond Position:  [1.80390235]


portfolio before change:  [-12.69109667]
curr_Stock_Price:  95.9706755402096
curr_Factors:  [95.97067554]
mat_Sqrt:  [[0.15]]
grads:  [0.04063757]
Stock Position:  0.04063756596227398
Bond Position:  [-16.59111133]


portfolio before change:  [-12.68304044]
curr_Stock_Price:  96.19443898686598
curr_Factors:  [96.19443899]
mat_Sqrt:  [[0.15]]
grads:  [0.09598683]
Stock Position:  0.09598682821324987
Bond Position:  [-21.91643953]


portfolio before change:  [-12.5659122]
curr_Stock_Price:  97.42896318145186
curr_Factors:  [97.42896318]
mat_Sqrt:  [[0.15]]
grads:  [0.13219018]
Stock Position:  0.1321901849554489
Bond Position:  [-25.44506487]


portfolio before change:  [-12.57220247]
curr_Stock_Price:  97.39340913286871
curr_Factors:  [97.39340913]
mat_Sqrt:  [[0.15]]
grads:  [0.01581981]
Stock Position:  0.015819806807241266
Bond Position:  [-14.11294738]


portfolio before change:  [-12.59092095]
curr_Stock_Price:  96.26593631863275
curr_Factors:  [96.26593632]
mat_Sqrt:  [[0.15]]
grads:  [0.02969587]
Stock Position:  0.029695872105584064
Bond Position:  [-15.44962189]


portfolio before change:  [-12.57786829]
curr_Stock_Price:  96.73799856240173
curr_Factors:  [96.73799856]
mat_Sqrt:  [[0.15]]
grads:  [0.00270135]
Stock Position:  0.0027013450998260766
Bond Position:  [-12.839191]


portfolio before change:  [-12.57830468]
curr_Stock_Price:  96.87351820019668
curr_Factors:  [96.8735182]
mat_Sqrt:  [[0.15]]
grads:  [0.07910562]
Stock Position:  0.07910561820761187
Bond Position:  [-20.24154422]


portfolio before change:  [-12.53627613]
curr_Stock_Price:  97.42080777635047
curr_Factors:  [97.42080778]
mat_Sqrt:  [[0.15]]
grads:  [0.10744139]
Stock Position:  0.10744139468280428
Bond Position:  [-23.00330359]


portfolio before change:  [-12.43288802]
curr_Stock_Price:  98.39646397252065
curr_Factors:  [98.39646397]
mat_Sqrt:  [[0.15]]
grads:  [0.05946424]
Stock Position:  0.05946424433798776
Bond Position:  [-18.2839594]


portfolio before change:  [-12.43861514]
curr_Stock_Price:  98.31936996893413
curr_Factors:  [98.31936997]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265199]
Stock Position:  -0.04265199212546506
Bond Position:  [-8.24509815]


portfolio before change:  [-12.41818122]
curr_Stock_Price:  97.82820278765203
curr_Factors:  [97.82820279]
mat_Sqrt:  [[0.15]]
grads:  [0.10516671]
Stock Position:  0.10516670509145001
Bond Position:  [-22.70645097]


portfolio before change:  [-12.38026216]
curr_Stock_Price:  98.20225889481277
curr_Factors:  [98.20225889]
mat_Sqrt:  [[0.15]]
grads:  [0.07658837]
Stock Position:  0.07658837351188584
Bond Position:  [-19.90141345]


portfolio before change:  [-12.38767253]
curr_Stock_Price:  98.12174425897973
curr_Factors:  [98.12174426]
mat_Sqrt:  [[0.15]]
grads:  [-0.13199667]
Stock Position:  -0.13199666512291477
Bond Position:  [0.56407049]


portfolio before change:  [-12.31481235]
curr_Stock_Price:  97.5700263900473
curr_Factors:  [97.57002639]
mat_Sqrt:  [[0.15]]
grads:  [-0.05165444]
Stock Position:  -0.051654443741399415
Bond Position:  [-7.27488691]


portfolio before change:  [-12.34553362]
curr_Stock_Price:  98.15596968102372
curr_Factors:  [98.15596968]
mat_Sqrt:  [[0.15]]
grads:  [0.1208721]
Stock Position:  0.12087210314029628
Bond Position:  [-24.20985211]


portfolio before change:  [-12.34653626]
curr_Stock_Price:  98.1601933928438
curr_Factors:  [98.16019339]
mat_Sqrt:  [[0.15]]
grads:  [0.03877415]
Stock Position:  0.03877414925654635
Bond Position:  [-16.15261425]


portfolio before change:  [-12.3847633]
curr_Stock_Price:  97.20034059580988
curr_Factors:  [97.2003406]
mat_Sqrt:  [[0.15]]
grads:  [-0.00561939]
Stock Position:  -0.005619386034382617
Bond Position:  [-11.83855707]


portfolio before change:  [-12.38397601]
curr_Stock_Price:  96.92856315227691
curr_Factors:  [96.92856315]
mat_Sqrt:  [[0.15]]
grads:  [-0.0412514]
Stock Position:  -0.041251404391796226
Bond Position:  [-8.38553666]


portfolio before change:  [-12.40705039]
curr_Stock_Price:  97.47521759690478
curr_Factors:  [97.4752176]
mat_Sqrt:  [[0.15]]
grads:  [-0.10638227]
Stock Position:  -0.10638227275281772
Bond Position:  [-2.0374152]


portfolio before change:  [-12.39147893]
curr_Stock_Price:  97.32764792738928
curr_Factors:  [97.32764793]
mat_Sqrt:  [[0.15]]
grads:  [0.04722056]
Stock Position:  0.04722055593271311
Bond Position:  [-16.98734458]


portfolio before change:  [-12.36162948]
curr_Stock_Price:  97.98226114195039
curr_Factors:  [97.98226114]
mat_Sqrt:  [[0.15]]
grads:  [0.18178602]
Stock Position:  0.18178602198197163
Bond Position:  [-30.17343495]


portfolio before change:  [-12.52559458]
curr_Stock_Price:  97.09066782489236
curr_Factors:  [97.09066782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191332]
Stock Position:  -0.021913323355427526
Bond Position:  [-10.39801538]


portfolio before change:  [-12.5099336]
curr_Stock_Price:  96.34633190009049
curr_Factors:  [96.3463319]
mat_Sqrt:  [[0.15]]
grads:  [0.0819052]
Stock Position:  0.08190519645951046
Bond Position:  [-20.40119884]


portfolio before change:  [-12.46835307]
curr_Stock_Price:  96.86956659006252
curr_Factors:  [96.86956659]
mat_Sqrt:  [[0.15]]
grads:  [-0.17665808]
Stock Position:  -0.17665808050211182
Bond Position:  [4.64443862]


portfolio before change:  [-12.49276486]
curr_Stock_Price:  97.00939641989932
curr_Factors:  [97.00939642]
mat_Sqrt:  [[0.15]]
grads:  [0.12580119]
Stock Position:  0.12580118684176117
Bond Position:  [-24.69666206]


portfolio before change:  [-12.47869999]
curr_Stock_Price:  97.13346882522585
curr_Factors:  [97.13346883]
mat_Sqrt:  [[0.15]]
grads:  [0.06593965]
Stock Position:  0.06593965274788736
Bond Position:  [-18.8836472]


portfolio before change:  [-12.50125741]
curr_Stock_Price:  96.80927615643388
curr_Factors:  [96.80927616]
mat_Sqrt:  [[0.15]]
grads:  [0.03545974]
Stock Position:  0.0354597441050531
Bond Position:  [-15.93408957]


portfolio before change:  [-12.47117432]
curr_Stock_Price:  97.68573473057502
curr_Factors:  [97.68573473]
mat_Sqrt:  [[0.15]]
grads:  [-0.04010303]
Stock Position:  -0.04010302815042901
Bond Position:  [-8.55368055]


portfolio before change:  [-12.50025111]
curr_Stock_Price:  98.39745570920982
curr_Factors:  [98.39745571]
mat_Sqrt:  [[0.15]]
grads:  [-0.00870399]
Stock Position:  -0.008703988842472296
Bond Position:  [-11.64380075]


portfolio before change:  [-12.50165255]
curr_Stock_Price:  98.47485490472663
curr_Factors:  [98.4748549]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428305]
Stock Position:  -0.042830500845330466
Bond Position:  [-8.2839252]


portfolio before change:  [-12.50626062]
curr_Stock_Price:  98.57035474881796
curr_Factors:  [98.57035475]
mat_Sqrt:  [[0.15]]
grads:  [0.00470837]
Stock Position:  0.004708366632080857
Bond Position:  [-12.97036599]


portfolio before change:  [-12.50632166]
curr_Stock_Price:  98.72956715814426
curr_Factors:  [98.72956716]
mat_Sqrt:  [[0.15]]
grads:  [0.00931307]
Stock Position:  0.009313066940095167
Bond Position:  [-13.42579673]


portfolio before change:  [-12.50664024]
curr_Stock_Price:  98.7854629288507
curr_Factors:  [98.78546293]
mat_Sqrt:  [[0.15]]
grads:  [0.06017367]
Stock Position:  0.06017366824474721
Bond Position:  [-18.45092391]


portfolio before change:  [-12.53194033]
curr_Stock_Price:  98.38417662262759
curr_Factors:  [98.38417662]
mat_Sqrt:  [[0.15]]
grads:  [-0.05357811]
Stock Position:  -0.05357810595760101
Bond Position:  [-7.26070249]


portfolio before change:  [-12.58228079]
curr_Stock_Price:  99.31527813897392
curr_Factors:  [99.31527814]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923362]
Stock Position:  -0.029233615745163973
Bond Position:  [-9.67893611]


portfolio before change:  [-12.5606731]
curr_Stock_Price:  98.55544573184507
curr_Factors:  [98.55544573]
mat_Sqrt:  [[0.15]]
grads:  [0.0023113]
Stock Position:  0.0023113006961481635
Bond Position:  [-12.78846437]


portfolio before change:  [-12.56031803]
curr_Stock_Price:  99.05489188699909
curr_Factors:  [99.05489189]
mat_Sqrt:  [[0.15]]
grads:  [0.05230996]
Stock Position:  0.05230996378898435
Bond Position:  [-17.74187584]


portfolio before change:  [-12.53290202]
curr_Stock_Price:  99.60019739476081
curr_Factors:  [99.60019739]
mat_Sqrt:  [[0.15]]
grads:  [0.04866742]
Stock Position:  0.04866741816547117
Bond Position:  [-17.38018648]


portfolio before change:  [-12.53460815]
curr_Stock_Price:  99.5874613262488
curr_Factors:  [99.58746133]
mat_Sqrt:  [[0.15]]
grads:  [-0.02677126]
Stock Position:  -0.026771258609733263
Bond Position:  [-9.86852647]


portfolio before change:  [-12.56156492]
curr_Stock_Price:  100.57135108549623
curr_Factors:  [100.57135109]
mat_Sqrt:  [[0.15]]
grads:  [-0.0054662]
Stock Position:  -0.005466195201406637
Bond Position:  [-12.01182228]


portfolio before change:  [-12.56278527]
curr_Stock_Price:  100.65725992862927
curr_Factors:  [100.65725993]
mat_Sqrt:  [[0.15]]
grads:  [0.04132685]
Stock Position:  0.04132685394235461
Bond Position:  [-16.72263315]


portfolio before change:  [-12.55265041]
curr_Stock_Price:  100.92778777104525
curr_Factors:  [100.92778777]
mat_Sqrt:  [[0.15]]
grads:  [-0.0649233]
Stock Position:  -0.06492329680629577
Bond Position:  [-6.00008569]


portfolio before change:  [-12.51163695]
curr_Stock_Price:  100.29028980814874
curr_Factors:  [100.29028981]
mat_Sqrt:  [[0.15]]
grads:  [0.05085848]
Stock Position:  0.0508584760027115
Bond Position:  [-17.61224825]


portfolio before change:  [-12.53669014]
curr_Stock_Price:  99.81932834130205
curr_Factors:  [99.81932834]
mat_Sqrt:  [[0.15]]
grads:  [0.14504945]
Stock Position:  0.14504944740328188
Bond Position:  [-27.01542855]


portfolio before change:  [-12.53227856]
curr_Stock_Price:  99.86138363981685
curr_Factors:  [99.86138364]
mat_Sqrt:  [[0.15]]
grads:  [0.03644031]
Stock Position:  0.036440307733423126
Bond Position:  [-16.17125811]


portfolio before change:  [-12.536711]
curr_Stock_Price:  99.76748464882235
curr_Factors:  [99.76748465]
mat_Sqrt:  [[0.15]]
grads:  [0.05127358]
Stock Position:  0.05127358453721923
Bond Position:  [-17.65214756]


portfolio before change:  [-12.59453533]
curr_Stock_Price:  98.66124178344904
curr_Factors:  [98.66124178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0025725]
Stock Position:  -0.00257250425166531
Bond Position:  [-12.34072887]


portfolio before change:  [-12.59255942]
curr_Stock_Price:  97.59332116706665
curr_Factors:  [97.59332117]
mat_Sqrt:  [[0.15]]
grads:  [0.0221385]
Stock Position:  0.02213849814346779
Bond Position:  [-14.75312898]


portfolio before change:  [-12.6055318]
curr_Stock_Price:  97.04900783773927
curr_Factors:  [97.04900784]
mat_Sqrt:  [[0.15]]
grads:  [0.15610638]
Stock Position:  0.1561063824992576
Bond Position:  [-27.75550134]


portfolio before change:  [-12.67822385]
curr_Stock_Price:  96.59446343396286
curr_Factors:  [96.59446343]
mat_Sqrt:  [[0.15]]
grads:  [0.02225713]
Stock Position:  0.022257129821386425
Bond Position:  [-14.82813937]


portfolio before change:  [-12.68891576]
curr_Stock_Price:  96.1557222458208
curr_Factors:  [96.15572225]
mat_Sqrt:  [[0.15]]
grads:  [-0.10247912]
Stock Position:  -0.10247912211463878
Bond Position:  [-2.83496176]


portfolio before change:  [-12.75021999]
curr_Stock_Price:  96.75220504001007
curr_Factors:  [96.75220504]
mat_Sqrt:  [[0.15]]
grads:  [-0.03788627]
Stock Position:  -0.03788626587714085
Bond Position:  [-9.08464022]


portfolio before change:  [-12.72996851]
curr_Stock_Price:  96.20268441469165
curr_Factors:  [96.20268441]
mat_Sqrt:  [[0.15]]
grads:  [0.01369724]
Stock Position:  0.013697244811710587
Bond Position:  [-14.04768023]


portfolio before change:  [-12.73378734]
curr_Stock_Price:  95.98798234413636
curr_Factors:  [95.98798234]
mat_Sqrt:  [[0.15]]
grads:  [0.07039845]
Stock Position:  0.07039845004592558
Bond Position:  [-19.49119252]


portfolio before change:  [-12.72946722]
curr_Stock_Price:  96.066654001393
curr_Factors:  [96.066654]
mat_Sqrt:  [[0.15]]
grads:  [0.02785532]
Stock Position:  0.02785531679434911
Bond Position:  [-15.4054343]


portfolio before change:  [-12.74150569]
curr_Stock_Price:  95.66904234986266
curr_Factors:  [95.66904235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00453162]
Stock Position:  -0.004531616753365829
Bond Position:  [-12.30797025]


portfolio before change:  [-12.74251831]
curr_Stock_Price:  95.72274302905599
curr_Factors:  [95.72274303]
mat_Sqrt:  [[0.15]]
grads:  [-0.11083631]
Stock Position:  -0.11083630678256802
Bond Position:  [-2.132963]


portfolio before change:  [-12.82254653]
curr_Stock_Price:  96.44358001384117
curr_Factors:  [96.44358001]
mat_Sqrt:  [[0.15]]
grads:  [-0.1686653]
Stock Position:  -0.16866530443394534
Bond Position:  [3.44413925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.80839782]
Stock Price:  96.3609700024875
PL:  [-12.80839782]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.22942252e-03]
 [ 1.40235335e-02]
 [ 2.62442717e-03]
 [-7.07930460e-03]
 [ 1.13449756e-02]
 [-1.35715005e-02]
 [-1.35062812e-02]
 [-4.61557294e-04]
 [-9.01170373e-03]
 [-2.74984888e-04]
 [ 1.14408988e-02]
 [-2.81689022e-05]
 [-3.53406618e-03]
 [ 5.43792548e-03]
 [ 2.98783638e-03]
 [ 1.15385357e-02]
 [ 9.72461709e-02]
 [-1.24261218e-02]
 [ 1.81916462e-02]
 [ 1.28373231e-03]
 [-4.97042710e-03]
 [ 5.09497905e-03]
 [ 7.05473759e-03]
 [ 4.20980295e-02]
 [ 1.14859092e-03]
 [ 8.40781627e-03]
 [ 2.32343097e-03]
 [ 1.57354068e-02]
 [ 3.24449213e-02]
 [ 3.80855767e-03]
 [-3.35327176e-03]
 [ 1.27087160e-02]
 [ 1.24195160e-02]
 [ 5.52645968e-03]
 [ 6.66260901e-03]
 [ 1.36529422e-02]
 [-2.77110126e-02]
 [ 2.67985317e-03]
 [-4.84543221e-02]
 [-1.29136488e-02]
 [ 3.95928847e-03]
 [ 8.88561284e-03]
 [-9.20913833e-03]
 [ 1.81750071e-03]
 [ 7.24616923e-03]
 [ 1.22213844e-02]
 [ 1.06206136e-02]
 [ 1.62750585e-04]
 [ 1.55724665e-02]
 [-1.17226950e-03]
 [ 2.11362793e-02]
 [-1.06248036e-02]
 [ 2.11079128e-04]
 [-8.33403297e-03]
 [-3.51566406e-03]
 [-3.56224686e-03]
 [ 1.03783851e-02]
 [-7.07796064e-03]
 [ 6.66006147e-03]
 [-3.90838339e-03]
 [-3.40156520e-03]
 [ 8.01285888e-03]
 [-1.40928144e-02]
 [ 7.79716126e-03]
 [ 2.37020168e-02]
 [ 5.57283240e-03]
 [ 7.92869657e-03]
 [-1.47723669e-03]
 [ 2.68432185e-03]
 [ 2.03544901e-02]
 [ 3.32852015e-04]
 [-1.59822529e-02]
 [-3.68511057e-03]
 [ 1.28914565e-03]
 [-3.14310649e-05]
 [-8.57603934e-04]
 [-4.12250396e-03]
 [ 5.50834179e-03]
 [-2.31718393e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.14069697]
curr_Stock_Price:  100.36837525347124
curr_Factors:  [100.36837525]
mat_Sqrt:  [[0.15]]
grads:  [-0.02152948]
Stock Position:  -0.021529483476554354
Bond Position:  [12.30157625]


portfolio before change:  [10.14559338]
curr_Stock_Price:  100.1766599943172
curr_Factors:  [100.17665999]
mat_Sqrt:  [[0.15]]
grads:  [0.09349022]
Stock Position:  0.09349022306136749
Bond Position:  [0.78005509]


portfolio before change:  [10.12709708]
curr_Stock_Price:  99.97829646354211
curr_Factors:  [99.97829646]
mat_Sqrt:  [[0.15]]
grads:  [0.01749618]
Stock Position:  0.01749618111905528
Bond Position:  [8.3778587]


portfolio before change:  [10.12935016]
curr_Stock_Price:  100.07714374506828
curr_Factors:  [100.07714375]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719536]
Stock Position:  -0.047195364033327705
Bond Position:  [14.85252739]


portfolio before change:  [10.17454185]
curr_Stock_Price:  99.13926830187496
curr_Factors:  [99.1392683]
mat_Sqrt:  [[0.15]]
grads:  [0.07563317]
Stock Position:  0.07563317059093388
Bond Position:  [2.67632466]


portfolio before change:  [10.17172625]
curr_Stock_Price:  99.09982962279727
curr_Factors:  [99.09982962]
mat_Sqrt:  [[0.15]]
grads:  [-0.09047667]
Stock Position:  -0.0904766698499902
Bond Position:  [19.13794882]


portfolio before change:  [10.23476671]
curr_Stock_Price:  98.41629094484549
curr_Factors:  [98.41629094]
mat_Sqrt:  [[0.15]]
grads:  [-0.09004187]
Stock Position:  -0.09004187469274219
Bond Position:  [19.09635405]


portfolio before change:  [10.14100895]
curr_Stock_Price:  99.47081501661562
curr_Factors:  [99.47081502]
mat_Sqrt:  [[0.15]]
grads:  [-0.00307705]
Stock Position:  -0.003077048628022337
Bond Position:  [10.44708548]


portfolio before change:  [10.14069577]
curr_Stock_Price:  99.78479703015857
curr_Factors:  [99.78479703]
mat_Sqrt:  [[0.15]]
grads:  [-0.06007802]
Stock Position:  -0.06007802487587289
Bond Position:  [16.13556929]


portfolio before change:  [10.11525295]
curr_Stock_Price:  100.2250799170021
curr_Factors:  [100.22507992]
mat_Sqrt:  [[0.15]]
grads:  [-0.00183323]
Stock Position:  -0.0018332325880134291
Bond Position:  [10.29898883]


portfolio before change:  [10.11604191]
curr_Stock_Price:  100.14584688138167
curr_Factors:  [100.14584688]
mat_Sqrt:  [[0.15]]
grads:  [0.07627266]
Stock Position:  0.07627265852618215
Bond Position:  [2.47765193]


portfolio before change:  [10.14765106]
curr_Stock_Price:  100.55823966760182
curr_Factors:  [100.55823967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00018779]
Stock Position:  -0.00018779268149703848
Bond Position:  [10.16653516]


portfolio before change:  [10.14815016]
curr_Stock_Price:  101.28418378217533
curr_Factors:  [101.28418378]
mat_Sqrt:  [[0.15]]
grads:  [-0.02356044]
Stock Position:  -0.023560441196236275
Bond Position:  [12.53445022]


portfolio before change:  [10.14798254]
curr_Stock_Price:  101.32455028032419
curr_Factors:  [101.32455028]
mat_Sqrt:  [[0.15]]
grads:  [0.03625284]
Stock Position:  0.03625283654102551
Bond Position:  [6.47468018]


portfolio before change:  [10.1618339]
curr_Stock_Price:  101.69546409058928
curr_Factors:  [101.69546409]
mat_Sqrt:  [[0.15]]
grads:  [0.01991891]
Stock Position:  0.019918909216975998
Bond Position:  [8.13617118]


portfolio before change:  [10.16993076]
curr_Stock_Price:  102.07642546443273
curr_Factors:  [102.07642546]
mat_Sqrt:  [[0.15]]
grads:  [0.07692357]
Stock Position:  0.07692357132306221
Bond Position:  [2.31784756]


portfolio before change:  [10.21234872]
curr_Stock_Price:  102.62597206197144
curr_Factors:  [102.62597206]
mat_Sqrt:  [[0.15]]
grads:  [0.64830781]
Stock Position:  0.6483078059606501
Bond Position:  [-56.32087007]


portfolio before change:  [9.84403379]
curr_Stock_Price:  102.06328445926854
curr_Factors:  [102.06328446]
mat_Sqrt:  [[0.15]]
grads:  [-0.08284081]
Stock Position:  -0.08284081190240221
Bond Position:  [18.29903914]


portfolio before change:  [9.90686285]
curr_Stock_Price:  101.31865946282147
curr_Factors:  [101.31865946]
mat_Sqrt:  [[0.15]]
grads:  [0.12127764]
Stock Position:  0.12127764166447652
Bond Position:  [-2.38082522]


portfolio before change:  [9.96123786]
curr_Stock_Price:  101.76823792361114
curr_Factors:  [101.76823792]
mat_Sqrt:  [[0.15]]
grads:  [0.00855822]
Stock Position:  0.008558215424803017
Bond Position:  [9.09028336]


portfolio before change:  [9.96345755]
curr_Stock_Price:  101.96121427740363
curr_Factors:  [101.96121428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03313618]
Stock Position:  -0.0331361806884226
Bond Position:  [13.34206277]


portfolio before change:  [9.96109343]
curr_Stock_Price:  102.05772609125918
curr_Factors:  [102.05772609]
mat_Sqrt:  [[0.15]]
grads:  [0.03396653]
Stock Position:  0.03396652697965549
Bond Position:  [6.49454692]


portfolio before change:  [9.97957089]
curr_Stock_Price:  102.58976577538307
curr_Factors:  [102.58976578]
mat_Sqrt:  [[0.15]]
grads:  [0.04703158]
Stock Position:  0.04703158390515712
Bond Position:  [5.15461171]


portfolio before change:  [10.00712638]
curr_Stock_Price:  103.16880887010628
curr_Factors:  [103.16880887]
mat_Sqrt:  [[0.15]]
grads:  [0.28065353]
Stock Position:  0.28065353006023375
Bond Position:  [-18.94756403]


portfolio before change:  [9.79693936]
curr_Stock_Price:  102.42410861829634
curr_Factors:  [102.42410862]
mat_Sqrt:  [[0.15]]
grads:  [0.00765727]
Stock Position:  0.007657272817493134
Bond Position:  [9.01265002]


portfolio before change:  [9.79679375]
curr_Stock_Price:  102.33152791557559
curr_Factors:  [102.33152792]
mat_Sqrt:  [[0.15]]
grads:  [0.05605211]
Stock Position:  0.05605210848487118
Bond Position:  [4.06089585]


portfolio before change:  [9.78041184]
curr_Stock_Price:  102.03473753411369
curr_Factors:  [102.03473753]
mat_Sqrt:  [[0.15]]
grads:  [0.01548954]
Stock Position:  0.015489539798754157
Bond Position:  [8.19994071]


portfolio before change:  [9.78050032]
curr_Stock_Price:  102.00736182251565
curr_Factors:  [102.00736182]
mat_Sqrt:  [[0.15]]
grads:  [0.10490271]
Stock Position:  0.10490271227766991
Bond Position:  [-0.92034861]


portfolio before change:  [9.72947431]
curr_Stock_Price:  101.52149756206803
curr_Factors:  [101.52149756]
mat_Sqrt:  [[0.15]]
grads:  [0.21629948]
Stock Position:  0.21629947509526862
Bond Position:  [-12.22957232]


portfolio before change:  [9.61811098]
curr_Stock_Price:  101.01017426542687
curr_Factors:  [101.01017427]
mat_Sqrt:  [[0.15]]
grads:  [0.02539038]
Stock Position:  0.02539038448307851
Bond Position:  [7.05342382]


portfolio before change:  [9.63625793]
curr_Stock_Price:  101.70752860415416
curr_Factors:  [101.7075286]
mat_Sqrt:  [[0.15]]
grads:  [-0.02235515]
Stock Position:  -0.02235514505366352
Bond Position:  [11.90994448]


portfolio before change:  [9.64494773]
curr_Stock_Price:  101.35211135720341
curr_Factors:  [101.35211136]
mat_Sqrt:  [[0.15]]
grads:  [0.08472477]
Stock Position:  0.08472477323648624
Bond Position:  [1.05791308]


portfolio before change:  [9.58224057]
curr_Stock_Price:  100.61120310062185
curr_Factors:  [100.6112031]
mat_Sqrt:  [[0.15]]
grads:  [0.08279677]
Stock Position:  0.08279677362606308
Bond Position:  [1.25195756]


portfolio before change:  [9.57612074]
curr_Stock_Price:  100.53634416431609
curr_Factors:  [100.53634416]
mat_Sqrt:  [[0.15]]
grads:  [0.03684306]
Stock Position:  0.036843064516820144
Bond Position:  [5.87205372]


portfolio before change:  [9.55992684]
curr_Stock_Price:  100.08684547287251
curr_Factors:  [100.08684547]
mat_Sqrt:  [[0.15]]
grads:  [0.04441739]
Stock Position:  0.044417393431818594
Bond Position:  [5.11433005]


portfolio before change:  [9.62094042]
curr_Stock_Price:  101.45329045834323
curr_Factors:  [101.45329046]
mat_Sqrt:  [[0.15]]
grads:  [0.09101961]
Stock Position:  0.09101961484224345
Bond Position:  [0.386701]


portfolio before change:  [9.58523095]
curr_Stock_Price:  101.0606977088676
curr_Factors:  [101.06069771]
mat_Sqrt:  [[0.15]]
grads:  [-0.18474008]
Stock Position:  -0.1847400841982198
Bond Position:  [28.25519275]


portfolio before change:  [9.71448938]
curr_Stock_Price:  100.37057986241747
curr_Factors:  [100.37057986]
mat_Sqrt:  [[0.15]]
grads:  [0.01786569]
Stock Position:  0.017865687805996858
Bond Position:  [7.92129994]


portfolio before change:  [9.72914114]
curr_Stock_Price:  101.16297336131933
curr_Factors:  [101.16297336]
mat_Sqrt:  [[0.15]]
grads:  [-0.32302881]
Stock Position:  -0.32302881426650787
Bond Position:  [42.40769647]


portfolio before change:  [9.39788471]
curr_Stock_Price:  102.19664890947833
curr_Factors:  [102.19664891]
mat_Sqrt:  [[0.15]]
grads:  [-0.08609099]
Stock Position:  -0.08609099228078015
Bond Position:  [18.19609563]


portfolio before change:  [9.3528471]
curr_Stock_Price:  102.73299887442693
curr_Factors:  [102.73299887]
mat_Sqrt:  [[0.15]]
grads:  [0.02639526]
Stock Position:  0.026395256489789676
Bond Position:  [6.64118325]


portfolio before change:  [9.37046623]
curr_Stock_Price:  103.38478403353065
curr_Factors:  [103.38478403]
mat_Sqrt:  [[0.15]]
grads:  [0.05923742]
Stock Position:  0.05923741890486916
Bond Position:  [3.24621847]


portfolio before change:  [9.36186455]
curr_Stock_Price:  103.23615213971966
curr_Factors:  [103.23615214]
mat_Sqrt:  [[0.15]]
grads:  [-0.06139426]
Stock Position:  -0.06139425555490005
Bond Position:  [15.69997126]


portfolio before change:  [9.37066296]
curr_Stock_Price:  103.10882538967806
curr_Factors:  [103.10882539]
mat_Sqrt:  [[0.15]]
grads:  [0.01211667]
Stock Position:  0.012116671381801222
Bond Position:  [8.12132721]


portfolio before change:  [9.36942245]
curr_Stock_Price:  102.96455249170475
curr_Factors:  [102.96455249]
mat_Sqrt:  [[0.15]]
grads:  [0.04830779]
Stock Position:  0.048307794839061585
Bond Position:  [4.39543198]


portfolio before change:  [9.3424795]
curr_Stock_Price:  102.40113052373755
curr_Factors:  [102.40113052]
mat_Sqrt:  [[0.15]]
grads:  [0.0814759]
Stock Position:  0.08147589568050485
Bond Position:  [0.99925568]


portfolio before change:  [9.30888519]
curr_Stock_Price:  101.98804182306705
curr_Factors:  [101.98804182]
mat_Sqrt:  [[0.15]]
grads:  [0.07080409]
Stock Position:  0.07080409064108538
Bond Position:  [2.08771463]


portfolio before change:  [9.31644291]
curr_Stock_Price:  102.09294021014712
curr_Factors:  [102.09294021]
mat_Sqrt:  [[0.15]]
grads:  [0.001085]
Stock Position:  0.0010850039008282197
Bond Position:  [9.20567167]


portfolio before change:  [9.31678347]
curr_Stock_Price:  101.87652881766887
curr_Factors:  [101.87652882]
mat_Sqrt:  [[0.15]]
grads:  [0.10381644]
Stock Position:  0.10381644341080871
Bond Position:  [-1.25967541]


portfolio before change:  [9.40080213]
curr_Stock_Price:  102.6865873018231
curr_Factors:  [102.6865873]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781513]
Stock Position:  -0.007815130000163343
Bond Position:  [10.20331116]


portfolio before change:  [9.4038608]
curr_Stock_Price:  102.37681101232502
curr_Factors:  [102.37681101]
mat_Sqrt:  [[0.15]]
grads:  [0.14090853]
Stock Position:  0.1409085286171274
Bond Position:  [-5.021905]


portfolio before change:  [9.39187482]
curr_Stock_Price:  102.2939763888365
curr_Factors:  [102.29397639]
mat_Sqrt:  [[0.15]]
grads:  [-0.07083202]
Stock Position:  -0.07083202406442946
Bond Position:  [16.63756422]


portfolio before change:  [9.38900601]
curr_Stock_Price:  102.34915895409479
curr_Factors:  [102.34915895]
mat_Sqrt:  [[0.15]]
grads:  [0.00140719]
Stock Position:  0.001407194189616799
Bond Position:  [9.24498086]


portfolio before change:  [9.38946221]
curr_Stock_Price:  102.26272471189841
curr_Factors:  [102.26272471]
mat_Sqrt:  [[0.15]]
grads:  [-0.05556022]
Stock Position:  -0.05556021981108296
Bond Position:  [15.07120167]


portfolio before change:  [9.43912519]
curr_Stock_Price:  101.38582020494013
curr_Factors:  [101.3858202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02343776]
Stock Position:  -0.02343776041206117
Bond Position:  [11.81538176]


portfolio before change:  [9.44269685]
curr_Stock_Price:  101.2649393584537
curr_Factors:  [101.26493936]
mat_Sqrt:  [[0.15]]
grads:  [-0.02374831]
Stock Position:  -0.02374831240349012
Bond Position:  [11.84756827]


portfolio before change:  [9.43454401]
curr_Stock_Price:  101.6394225229623
curr_Factors:  [101.63942252]
mat_Sqrt:  [[0.15]]
grads:  [0.06918923]
Stock Position:  0.06918923416321857
Bond Position:  [2.4021902]


portfolio before change:  [9.46619074]
curr_Stock_Price:  102.09464635161021
curr_Factors:  [102.09464635]
mat_Sqrt:  [[0.15]]
grads:  [-0.0471864]
Stock Position:  -0.04718640428628153
Bond Position:  [14.28366999]


portfolio before change:  [9.48161941]
curr_Stock_Price:  101.78659319791409
curr_Factors:  [101.7865932]
mat_Sqrt:  [[0.15]]
grads:  [0.04440041]
Stock Position:  0.04440040981465436
Bond Position:  [4.96225296]


portfolio before change:  [9.5094777]
curr_Stock_Price:  102.40704101462435
curr_Factors:  [102.40704101]
mat_Sqrt:  [[0.15]]
grads:  [-0.02605589]
Stock Position:  -0.026055889252412052
Bond Position:  [12.17778422]


portfolio before change:  [9.49193052]
curr_Stock_Price:  103.10969662257482
curr_Factors:  [103.10969662]
mat_Sqrt:  [[0.15]]
grads:  [-0.0226771]
Stock Position:  -0.022677101304613638
Bond Position:  [11.83015956]


portfolio before change:  [9.50519235]
curr_Stock_Price:  102.55749117986424
curr_Factors:  [102.55749118]
mat_Sqrt:  [[0.15]]
grads:  [0.05341906]
Stock Position:  0.05341905921057398
Bond Position:  [4.02666765]


portfolio before change:  [9.46283173]
curr_Stock_Price:  101.75979293305821
curr_Factors:  [101.75979293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0939521]
Stock Position:  -0.09395209599781766
Bond Position:  [19.02337757]


portfolio before change:  [9.58075613]
curr_Stock_Price:  100.51729380210324
curr_Factors:  [100.5172938]
mat_Sqrt:  [[0.15]]
grads:  [0.05198108]
Stock Position:  0.05198107504964969
Bond Position:  [4.35575913]


portfolio before change:  [9.56348484]
curr_Stock_Price:  100.179795343635
curr_Factors:  [100.17979534]
mat_Sqrt:  [[0.15]]
grads:  [0.15801345]
Stock Position:  0.15801344514268875
Bond Position:  [-6.26626976]


portfolio before change:  [9.64649646]
curr_Stock_Price:  100.70761926881028
curr_Factors:  [100.70761927]
mat_Sqrt:  [[0.15]]
grads:  [0.03715222]
Stock Position:  0.03715221598204403
Bond Position:  [5.90498524]


portfolio before change:  [9.63193293]
curr_Stock_Price:  100.30568896416241
curr_Factors:  [100.30568896]
mat_Sqrt:  [[0.15]]
grads:  [0.05285798]
Stock Position:  0.052857977135318604
Bond Position:  [4.32997712]


portfolio before change:  [9.63184418]
curr_Stock_Price:  100.29888994053958
curr_Factors:  [100.29888994]
mat_Sqrt:  [[0.15]]
grads:  [-0.00984824]
Stock Position:  -0.009848244625899616
Bond Position:  [10.61961219]


portfolio before change:  [9.62731923]
curr_Stock_Price:  100.82575475212363
curr_Factors:  [100.82575475]
mat_Sqrt:  [[0.15]]
grads:  [0.01789548]
Stock Position:  0.017895478990926635
Bond Position:  [7.82299406]


portfolio before change:  [9.62270298]
curr_Stock_Price:  100.5404755459124
curr_Factors:  [100.54047555]
mat_Sqrt:  [[0.15]]
grads:  [0.1356966]
Stock Position:  0.135696600853836
Bond Position:  [-4.0202978]


portfolio before change:  [9.64459073]
curr_Stock_Price:  100.70362645752837
curr_Factors:  [100.70362646]
mat_Sqrt:  [[0.15]]
grads:  [0.00221901]
Stock Position:  0.0022190134342136287
Bond Position:  [9.42112803]


portfolio before change:  [9.64307699]
curr_Stock_Price:  99.75609710797862
curr_Factors:  [99.75609711]
mat_Sqrt:  [[0.15]]
grads:  [-0.10654835]
Stock Position:  -0.106548352909184
Bond Position:  [20.27192482]


portfolio before change:  [9.62866508]
curr_Stock_Price:  99.90325040264224
curr_Factors:  [99.9032504]
mat_Sqrt:  [[0.15]]
grads:  [-0.0245674]
Stock Position:  -0.024567403831149415
Bond Position:  [12.08302858]


portfolio before change:  [9.62038255]
curr_Stock_Price:  100.27112581347562
curr_Factors:  [100.27112581]
mat_Sqrt:  [[0.15]]
grads:  [0.0085943]
Stock Position:  0.008594304358721808
Bond Position:  [8.75862197]


portfolio before change:  [9.62041873]
curr_Stock_Price:  100.21163938465034
curr_Factors:  [100.21163938]
mat_Sqrt:  [[0.15]]
grads:  [-0.00020954]
Stock Position:  -0.0002095404325384853
Bond Position:  [9.64141712]


portfolio before change:  [9.62118953]
curr_Stock_Price:  99.40900960311994
curr_Factors:  [99.4090096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00571736]
Stock Position:  -0.005717359560479645
Bond Position:  [10.18954658]


portfolio before change:  [9.61757212]
curr_Stock_Price:  100.15310670251401
curr_Factors:  [100.1531067]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748336]
Stock Position:  -0.027483359766541336
Bond Position:  [12.37011598]


portfolio before change:  [9.63999377]
curr_Stock_Price:  99.36541221701812
curr_Factors:  [99.36541222]
mat_Sqrt:  [[0.15]]
grads:  [0.03672228]
Stock Position:  0.03672227861630044
Bond Position:  [5.99106942]


portfolio before change:  [9.65970058]
curr_Stock_Price:  99.89185975554058
curr_Factors:  [99.89185976]
mat_Sqrt:  [[0.15]]
grads:  [-0.15447893]
Stock Position:  -0.15447892865290258
Bond Position:  [25.09088805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.68798726]
Stock Price:  99.71890120548773
PL:  [9.68798726]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.23677976e-02]
 [-2.34260610e-02]
 [ 3.77450355e-02]
 [-1.15722492e-02]
 [ 1.09595021e-02]
 [-1.44084158e-02]
 [-7.92677005e-03]
 [ 4.32027626e-02]
 [-2.08937198e-02]
 [-1.33328816e-02]
 [ 3.77069602e-03]
 [-6.76169092e-03]
 [ 3.57657176e-03]
 [ 1.08035081e-03]
 [-2.51376642e-03]
 [ 1.21249899e-02]
 [ 2.91395944e-02]
 [-1.41697549e-02]
 [ 2.29103105e-02]
 [ 6.85385413e-04]
 [-3.83624057e-03]
 [ 4.69331889e-03]
 [ 1.83778520e-02]
 [ 1.77152075e-02]
 [-5.61127798e-03]
 [ 4.61247170e-03]
 [ 5.38685066e-03]
 [ 8.91524073e-03]
 [ 1.58177241e-02]
 [ 8.35780184e-03]
 [-6.64873621e-03]
 [ 1.00698165e-02]
 [ 1.15846214e-02]
 [-5.93617595e-03]
 [ 5.71563056e-03]
 [ 1.35947926e-02]
 [-1.10176150e-02]
 [ 3.47955223e-03]
 [-5.42184348e-02]
 [ 1.40458100e-02]
 [ 6.88104308e-03]
 [ 4.63980331e-03]
 [-3.40142539e-03]
 [-4.22561065e-03]
 [ 1.91140042e-02]
 [ 1.48910062e-02]
 [ 1.08916288e-02]
 [ 1.76375331e-03]
 [ 1.38745743e-02]
 [-1.60176255e-03]
 [ 6.03098695e-03]
 [-1.75938038e-02]
 [ 2.14391093e-03]
 [ 2.62019967e-03]
 [-3.59894118e-03]
 [-3.68543918e-03]
 [ 8.12655875e-03]
 [ 1.58214993e-03]
 [ 6.95159083e-03]
 [-4.01785641e-03]
 [-6.34395258e-04]
 [ 7.11733392e-03]
 [-1.66199887e-02]
 [ 4.59009882e-03]
 [ 2.54913593e-02]
 [ 6.02179814e-03]
 [ 1.42565806e-02]
 [ 2.73388504e-03]
 [ 2.96528214e-03]
 [ 1.99568883e-02]
 [ 3.79798865e-04]
 [-1.59318687e-02]
 [-5.32446805e-05]
 [ 1.39408987e-03]
 [ 9.76065711e-04]
 [-1.12648288e-02]
 [-4.33785257e-03]
 [ 9.90255900e-03]
 [-1.97939507e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.89151286]
curr_Stock_Price:  99.14062767953247
curr_Factors:  [99.14062768]
mat_Sqrt:  [[0.15]]
grads:  [-0.08245198]
Stock Position:  -0.08245198374125548
Bond Position:  [-8.71717144]


portfolio before change:  [-16.84664997]
curr_Stock_Price:  98.58991038187503
curr_Factors:  [98.58991038]
mat_Sqrt:  [[0.15]]
grads:  [-0.15617374]
Stock Position:  -0.15617373991085517
Bond Position:  [-1.44949495]


portfolio before change:  [-16.88370157]
curr_Stock_Price:  98.82657630504204
curr_Factors:  [98.82657631]
mat_Sqrt:  [[0.15]]
grads:  [0.25163357]
Stock Position:  0.2516335702371641
Bond Position:  [-41.7517858]


portfolio before change:  [-16.86133451]
curr_Stock_Price:  98.9258342323409
curr_Factors:  [98.92583423]
mat_Sqrt:  [[0.15]]
grads:  [-0.07714833]
Stock Position:  -0.0771483280493893
Bond Position:  [-9.2293718]


portfolio before change:  [-16.8425416]
curr_Stock_Price:  98.6747625341559
curr_Factors:  [98.67476253]
mat_Sqrt:  [[0.15]]
grads:  [0.07306335]
Stock Position:  0.0730633474385827
Bond Position:  [-24.05205006]


portfolio before change:  [-16.84701836]
curr_Stock_Price:  98.63406559437499
curr_Factors:  [98.63406559]
mat_Sqrt:  [[0.15]]
grads:  [-0.09605611]
Stock Position:  -0.09605610532581298
Bond Position:  [-7.37261416]


portfolio before change:  [-16.87916371]
curr_Stock_Price:  98.96392020217507
curr_Factors:  [98.9639202]
mat_Sqrt:  [[0.15]]
grads:  [-0.05284513]
Stock Position:  -0.05284513363654534
Bond Position:  [-11.64940212]


portfolio before change:  [-16.83902258]
curr_Stock_Price:  98.19054266502678
curr_Factors:  [98.19054267]
mat_Sqrt:  [[0.15]]
grads:  [0.28801842]
Stock Position:  0.288018417575504
Bond Position:  [-45.1197073]


portfolio before change:  [-16.95911291]
curr_Stock_Price:  97.7833803045723
curr_Factors:  [97.7833803]
mat_Sqrt:  [[0.15]]
grads:  [-0.13929147]
Stock Position:  -0.13929146556154037
Bond Position:  [-3.33872256]


portfolio before change:  [-16.96212519]
curr_Stock_Price:  97.80350791378301
curr_Factors:  [97.80350791]
mat_Sqrt:  [[0.15]]
grads:  [-0.08888588]
Stock Position:  -0.088885877388665
Bond Position:  [-8.26877458]


portfolio before change:  [-16.92622511]
curr_Stock_Price:  97.39380404722037
curr_Factors:  [97.39380405]
mat_Sqrt:  [[0.15]]
grads:  [0.02513797]
Stock Position:  0.02513797346960278
Bond Position:  [-19.37450798]


portfolio before change:  [-16.92787686]
curr_Stock_Price:  97.37626897325772
curr_Factors:  [97.37626897]
mat_Sqrt:  [[0.15]]
grads:  [-0.04507794]
Stock Position:  -0.04507793943973455
Bond Position:  [-12.5383553]


portfolio before change:  [-16.95719155]
curr_Stock_Price:  98.00919553148842
curr_Factors:  [98.00919553]
mat_Sqrt:  [[0.15]]
grads:  [0.02384381]
Stock Position:  0.023843811710839036
Bond Position:  [-19.29410436]


portfolio before change:  [-16.94507791]
curr_Stock_Price:  98.56781285162614
curr_Factors:  [98.56781285]
mat_Sqrt:  [[0.15]]
grads:  [0.00720234]
Stock Position:  0.007202338714514832
Bond Position:  [-17.65499668]


portfolio before change:  [-16.94324289]
curr_Stock_Price:  98.97580349719347
curr_Factors:  [98.9758035]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675844]
Stock Position:  -0.016758442832524104
Bond Position:  [-15.28456255]


portfolio before change:  [-16.95465639]
curr_Stock_Price:  99.59985826212052
curr_Factors:  [99.59985826]
mat_Sqrt:  [[0.15]]
grads:  [0.08083327]
Stock Position:  0.08083326614518058
Bond Position:  [-25.00563824]


portfolio before change:  [-16.9484686]
curr_Stock_Price:  99.6957431444569
curr_Factors:  [99.69574314]
mat_Sqrt:  [[0.15]]
grads:  [0.19426396]
Stock Position:  0.19426396288743436
Bond Position:  [-36.31575875]


portfolio before change:  [-17.10688219]
curr_Stock_Price:  98.89197193663489
curr_Factors:  [98.89197194]
mat_Sqrt:  [[0.15]]
grads:  [-0.09446503]
Stock Position:  -0.09446503271219973
Bond Position:  [-7.76504883]


portfolio before change:  [-17.12920645]
curr_Stock_Price:  99.1231573114218
curr_Factors:  [99.12315731]
mat_Sqrt:  [[0.15]]
grads:  [0.1527354]
Stock Position:  0.15273540331091168
Bond Position:  [-32.26882186]


portfolio before change:  [-17.16337885]
curr_Stock_Price:  98.91262636112766
curr_Factors:  [98.91262636]
mat_Sqrt:  [[0.15]]
grads:  [0.00456924]
Stock Position:  0.004569236087703576
Bond Position:  [-17.61533399]


portfolio before change:  [-17.16188559]
curr_Stock_Price:  99.48039033563668
curr_Factors:  [99.48039034]
mat_Sqrt:  [[0.15]]
grads:  [-0.02557494]
Stock Position:  -0.02557493713757017
Bond Position:  [-14.61768086]


portfolio before change:  [-17.16545862]
curr_Stock_Price:  99.58437482119592
curr_Factors:  [99.58437482]
mat_Sqrt:  [[0.15]]
grads:  [0.03128879]
Stock Position:  0.03128879259189505
Bond Position:  [-20.28133347]


portfolio before change:  [-17.18281957]
curr_Stock_Price:  99.07002685645422
curr_Factors:  [99.07002686]
mat_Sqrt:  [[0.15]]
grads:  [0.12251901]
Stock Position:  0.12251901366242546
Bond Position:  [-29.32078155]


portfolio before change:  [-17.1344234]
curr_Stock_Price:  99.47999406079005
curr_Factors:  [99.47999406]
mat_Sqrt:  [[0.15]]
grads:  [0.11810138]
Stock Position:  0.11810138358176524
Bond Position:  [-28.88314834]


portfolio before change:  [-17.22935871]
curr_Stock_Price:  98.69143382712024
curr_Factors:  [98.69143383]
mat_Sqrt:  [[0.15]]
grads:  [-0.03740852]
Stock Position:  -0.037408519852823785
Bond Position:  [-13.53745825]


portfolio before change:  [-17.22317825]
curr_Stock_Price:  98.50360017459619
curr_Factors:  [98.50360017]
mat_Sqrt:  [[0.15]]
grads:  [0.03074981]
Stock Position:  0.030749811354122854
Bond Position:  [-20.25214537]


portfolio before change:  [-17.23911769]
curr_Stock_Price:  98.02640557369931
curr_Factors:  [98.02640557]
mat_Sqrt:  [[0.15]]
grads:  [0.03591234]
Stock Position:  0.035912337747591165
Bond Position:  [-20.75947508]


portfolio before change:  [-17.23431842]
curr_Stock_Price:  98.19617394508649
curr_Factors:  [98.19617395]
mat_Sqrt:  [[0.15]]
grads:  [0.05943494]
Stock Position:  0.05943493817768801
Bond Position:  [-23.07060195]


portfolio before change:  [-17.22465472]
curr_Stock_Price:  98.38302797688073
curr_Factors:  [98.38302798]
mat_Sqrt:  [[0.15]]
grads:  [0.10545149]
Stock Position:  0.10545149429260026
Bond Position:  [-27.59929203]


portfolio before change:  [-17.2221644]
curr_Stock_Price:  98.4230020783768
curr_Factors:  [98.42300208]
mat_Sqrt:  [[0.15]]
grads:  [0.05571868]
Stock Position:  0.055718678966599676
Bond Position:  [-22.70616406]


portfolio before change:  [-17.17382004]
curr_Stock_Price:  99.31612343388171
curr_Factors:  [99.31612343]
mat_Sqrt:  [[0.15]]
grads:  [-0.04432491]
Stock Position:  -0.04432490803916992
Bond Position:  [-12.771642]


portfolio before change:  [-17.16717109]
curr_Stock_Price:  99.14810950017859
curr_Factors:  [99.1481095]
mat_Sqrt:  [[0.15]]
grads:  [0.06713211]
Stock Position:  0.06713210988037824
Bond Position:  [-23.82319287]


portfolio before change:  [-17.18165766]
curr_Stock_Price:  98.9544975813988
curr_Factors:  [98.95449758]
mat_Sqrt:  [[0.15]]
grads:  [0.07723081]
Stock Position:  0.07723080963892504
Bond Position:  [-24.82399363]


portfolio before change:  [-17.12508395]
curr_Stock_Price:  99.70711506512102
curr_Factors:  [99.70711507]
mat_Sqrt:  [[0.15]]
grads:  [-0.03957451]
Stock Position:  -0.039574506354044664
Bond Position:  [-13.17922409]


portfolio before change:  [-17.11550249]
curr_Stock_Price:  99.44418851848603
curr_Factors:  [99.44418852]
mat_Sqrt:  [[0.15]]
grads:  [0.0381042]
Stock Position:  0.03810420375104671
Bond Position:  [-20.90474411]


portfolio before change:  [-17.09405966]
curr_Stock_Price:  100.0412202150792
curr_Factors:  [100.04122022]
mat_Sqrt:  [[0.15]]
grads:  [0.09063195]
Stock Position:  0.09063195047899364
Bond Position:  [-26.16099058]


portfolio before change:  [-17.12168195]
curr_Stock_Price:  99.75448713591534
curr_Factors:  [99.75448714]
mat_Sqrt:  [[0.15]]
grads:  [-0.07345077]
Stock Position:  -0.07345076658861024
Bond Position:  [-9.7946384]


portfolio before change:  [-17.13680325]
curr_Stock_Price:  99.95202242522974
curr_Factors:  [99.95202243]
mat_Sqrt:  [[0.15]]
grads:  [0.02319701]
Stock Position:  0.023197014853570327
Bond Position:  [-19.4553918]


portfolio before change:  [-17.12320067]
curr_Stock_Price:  100.59083666523946
curr_Factors:  [100.59083667]
mat_Sqrt:  [[0.15]]
grads:  [-0.36145623]
Stock Position:  -0.3614562318797862
Bond Position:  [19.23598411]


portfolio before change:  [-17.18057224]
curr_Stock_Price:  100.7528863125846
curr_Factors:  [100.75288631]
mat_Sqrt:  [[0.15]]
grads:  [0.09363873]
Stock Position:  0.09363873323996771
Bond Position:  [-26.61494488]


portfolio before change:  [-17.19564413]
curr_Stock_Price:  100.6096933933893
curr_Factors:  [100.60969339]
mat_Sqrt:  [[0.15]]
grads:  [0.04587362]
Stock Position:  0.04587362053374295
Bond Position:  [-21.81097503]


portfolio before change:  [-17.18795739]
curr_Stock_Price:  100.80697389519656
curr_Factors:  [100.8069739]
mat_Sqrt:  [[0.15]]
grads:  [0.03093202]
Stock Position:  0.0309320220776912
Bond Position:  [-20.30612093]


portfolio before change:  [-17.18904179]
curr_Stock_Price:  100.81294742139828
curr_Factors:  [100.81294742]
mat_Sqrt:  [[0.15]]
grads:  [-0.02267617]
Stock Position:  -0.022676169280984752
Bond Position:  [-14.90299032]


portfolio before change:  [-17.18196864]
curr_Stock_Price:  100.45995073299981
curr_Factors:  [100.45995073]
mat_Sqrt:  [[0.15]]
grads:  [-0.02817074]
Stock Position:  -0.028170737656690634
Bond Position:  [-14.35193772]


portfolio before change:  [-17.19762187]
curr_Stock_Price:  100.98376417320146
curr_Factors:  [100.98376417]
mat_Sqrt:  [[0.15]]
grads:  [0.12742669]
Stock Position:  0.12742669451215638
Bond Position:  [-30.06564914]


portfolio before change:  [-17.26496043]
curr_Stock_Price:  100.47006180772654
curr_Factors:  [100.47006181]
mat_Sqrt:  [[0.15]]
grads:  [0.09927337]
Stock Position:  0.09927337492236367
Bond Position:  [-27.23896254]


portfolio before change:  [-17.26108925]
curr_Stock_Price:  100.52620646715704
curr_Factors:  [100.52620647]
mat_Sqrt:  [[0.15]]
grads:  [0.07261086]
Stock Position:  0.0726108587129176
Bond Position:  [-24.56038342]


portfolio before change:  [-17.18232922]
curr_Stock_Price:  101.63203421135242
curr_Factors:  [101.63203421]
mat_Sqrt:  [[0.15]]
grads:  [0.01175836]
Stock Position:  0.01175835541690984
Bond Position:  [-18.3773548]


portfolio before change:  [-17.18444427]
curr_Stock_Price:  101.54984317396723
curr_Factors:  [101.54984317]
mat_Sqrt:  [[0.15]]
grads:  [0.09249716]
Stock Position:  0.092497161971794
Bond Position:  [-26.57751656]


portfolio before change:  [-17.26204739]
curr_Stock_Price:  100.72882371260044
curr_Factors:  [100.72882371]
mat_Sqrt:  [[0.15]]
grads:  [-0.01067842]
Stock Position:  -0.010678416985111471
Bond Position:  [-16.18642301]


portfolio before change:  [-17.26342884]
curr_Stock_Price:  100.76345149826975
curr_Factors:  [100.7634515]
mat_Sqrt:  [[0.15]]
grads:  [0.04020658]
Stock Position:  0.04020657965484146
Bond Position:  [-21.31478258]


portfolio before change:  [-17.23665667]
curr_Stock_Price:  101.46245118453388
curr_Factors:  [101.46245118]
mat_Sqrt:  [[0.15]]
grads:  [-0.11729203]
Stock Position:  -0.11729202527176986
Bond Position:  [-5.33592028]


portfolio before change:  [-17.13342775]
curr_Stock_Price:  100.57950599300284
curr_Factors:  [100.57950599]
mat_Sqrt:  [[0.15]]
grads:  [0.01429274]
Stock Position:  0.014292739549759308
Bond Position:  [-18.57098443]


portfolio before change:  [-17.13052892]
curr_Stock_Price:  100.86353454484825
curr_Factors:  [100.86353454]
mat_Sqrt:  [[0.15]]
grads:  [0.017468]
Stock Position:  0.017467997781162696
Bond Position:  [-18.89241292]


portfolio before change:  [-17.11682728]
curr_Stock_Price:  101.71551878587128
curr_Factors:  [101.71551879]
mat_Sqrt:  [[0.15]]
grads:  [-0.02399294]
Stock Position:  -0.02399294117726949
Bond Position:  [-14.67637282]


portfolio before change:  [-17.10060891]
curr_Stock_Price:  101.00132259254585
curr_Factors:  [101.00132259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456959]
Stock Position:  -0.024569594520179924
Bond Position:  [-14.61904737]


portfolio before change:  [-17.09110728]
curr_Stock_Price:  100.57741057260834
curr_Factors:  [100.57741057]
mat_Sqrt:  [[0.15]]
grads:  [0.05417706]
Stock Position:  0.054177058306799045
Bond Position:  [-22.54009552]


portfolio before change:  [-17.09513762]
curr_Stock_Price:  100.52902232923364
curr_Factors:  [100.52902233]
mat_Sqrt:  [[0.15]]
grads:  [0.01054767]
Stock Position:  0.010547666215744527
Bond Position:  [-18.15548419]


portfolio before change:  [-17.09369192]
curr_Stock_Price:  100.77366915624347
curr_Factors:  [100.77366916]
mat_Sqrt:  [[0.15]]
grads:  [0.04634394]
Stock Position:  0.0463439388689563
Bond Position:  [-21.76394068]


portfolio before change:  [-17.10374525]
curr_Stock_Price:  100.58609232409992
curr_Factors:  [100.58609232]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678571]
Stock Position:  -0.026785709389978703
Bond Position:  [-14.40947542]


portfolio before change:  [-17.09948151]
curr_Stock_Price:  100.3932892290585
curr_Factors:  [100.39328923]
mat_Sqrt:  [[0.15]]
grads:  [-0.0042293]
Stock Position:  -0.0042293017218750055
Bond Position:  [-16.674888]


portfolio before change:  [-17.10345802]
curr_Stock_Price:  101.08709261960935
curr_Factors:  [101.08709262]
mat_Sqrt:  [[0.15]]
grads:  [0.04744889]
Stock Position:  0.04744889279238056
Bond Position:  [-21.89992864]


portfolio before change:  [-17.04752189]
curr_Stock_Price:  102.29481138373822
curr_Factors:  [102.29481138]
mat_Sqrt:  [[0.15]]
grads:  [-0.11079992]
Stock Position:  -0.11079992486690655
Bond Position:  [-5.71326448]


portfolio before change:  [-17.02547782]
curr_Stock_Price:  102.0926346725056
curr_Factors:  [102.09263467]
mat_Sqrt:  [[0.15]]
grads:  [0.03060066]
Stock Position:  0.030600658829119613
Bond Position:  [-20.1495797]


portfolio before change:  [-17.04388752]
curr_Stock_Price:  101.53217915247562
curr_Factors:  [101.53217915]
mat_Sqrt:  [[0.15]]
grads:  [0.1699424]
Stock Position:  0.16994239543303977
Bond Position:  [-34.29850925]


portfolio before change:  [-16.95585745]
curr_Stock_Price:  102.06279303508559
curr_Factors:  [102.06279304]
mat_Sqrt:  [[0.15]]
grads:  [0.04014532]
Stock Position:  0.04014532092720226
Bond Position:  [-21.05320103]


portfolio before change:  [-16.95771143]
curr_Stock_Price:  102.04938877224333
curr_Factors:  [102.04938877]
mat_Sqrt:  [[0.15]]
grads:  [0.09504387]
Stock Position:  0.09504387046944851
Bond Position:  [-26.65688032]


portfolio before change:  [-17.02060921]
curr_Stock_Price:  101.40514231355122
curr_Factors:  [101.40514231]
mat_Sqrt:  [[0.15]]
grads:  [0.0182259]
Stock Position:  0.018225900280958152
Bond Position:  [-18.86880923]


portfolio before change:  [-17.0247896]
curr_Stock_Price:  101.24048383900154
curr_Factors:  [101.24048384]
mat_Sqrt:  [[0.15]]
grads:  [0.01976855]
Stock Position:  0.01976854757911114
Bond Position:  [-19.02616692]


portfolio before change:  [-17.03661565]
curr_Stock_Price:  100.70241327872647
curr_Factors:  [100.70241328]
mat_Sqrt:  [[0.15]]
grads:  [0.13304592]
Stock Position:  0.13304592231187004
Bond Position:  [-30.4346611]


portfolio before change:  [-17.07307742]
curr_Stock_Price:  100.4426567455288
curr_Factors:  [100.44265675]
mat_Sqrt:  [[0.15]]
grads:  [0.00253199]
Stock Position:  0.0025319924344604514
Bond Position:  [-17.32739747]


portfolio before change:  [-17.072791]
curr_Stock_Price:  100.98350152460958
curr_Factors:  [100.98350152]
mat_Sqrt:  [[0.15]]
grads:  [-0.10621246]
Stock Position:  -0.10621245773835997
Bond Position:  [-6.34708511]


portfolio before change:  [-17.15789375]
curr_Stock_Price:  101.78101669579438
curr_Factors:  [101.7810167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00035496]
Stock Position:  -0.0003549645365952837
Bond Position:  [-17.1217651]


portfolio before change:  [-17.15874733]
curr_Stock_Price:  101.1709065579525
curr_Factors:  [101.17090656]
mat_Sqrt:  [[0.15]]
grads:  [0.00929393]
Stock Position:  0.009293932494174772
Bond Position:  [-18.09902291]


portfolio before change:  [-17.15750514]
curr_Stock_Price:  101.4262789649724
curr_Factors:  [101.42627896]
mat_Sqrt:  [[0.15]]
grads:  [0.0065071]
Stock Position:  0.006507104737457619
Bond Position:  [-17.81749656]


portfolio before change:  [-17.16124467]
curr_Stock_Price:  101.02273482145019
curr_Factors:  [101.02273482]
mat_Sqrt:  [[0.15]]
grads:  [-0.07509886]
Stock Position:  -0.07509885846071834
Bond Position:  [-9.57455261]


portfolio before change:  [-17.15045804]
curr_Stock_Price:  100.87113386200124
curr_Factors:  [100.87113386]
mat_Sqrt:  [[0.15]]
grads:  [-0.02891902]
Stock Position:  -0.02891901714801073
Bond Position:  [-14.23336399]


portfolio before change:  [-17.13062721]
curr_Stock_Price:  100.15463491931452
curr_Factors:  [100.15463492]
mat_Sqrt:  [[0.15]]
grads:  [0.06601706]
Stock Position:  0.06601706002163442
Bond Position:  [-23.74254175]


portfolio before change:  [-17.12496397]
curr_Stock_Price:  100.26289778615873
curr_Factors:  [100.26289779]
mat_Sqrt:  [[0.15]]
grads:  [-0.13195967]
Stock Position:  -0.1319596713871683
Bond Position:  [-3.89430492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.34067273]
Stock Price:  101.89570996002607
PL:  [-19.23638269]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.01109477e-03]
 [ 4.93306328e-02]
 [ 2.16997623e-02]
 [-2.68562553e-02]
 [-4.64069370e-02]
 [-1.35346229e-03]
 [ 9.38566226e-03]
 [-6.31168852e-02]
 [ 1.78596180e-02]
 [-8.60641554e-03]
 [-1.44317695e-02]
 [ 2.18334647e-02]
 [-4.44884296e-03]
 [ 5.32686328e-03]
 [-1.55687087e-03]
 [ 1.37336668e-02]
 [ 3.43308341e-02]
 [-1.51708530e-02]
 [ 2.46160713e-02]
 [-4.51656887e-04]
 [-7.57953010e-03]
 [ 5.44487751e-03]
 [ 1.54471096e-02]
 [ 1.84719714e-02]
 [-5.70028364e-03]
 [ 4.66217770e-03]
 [ 1.01982218e-02]
 [ 8.25369082e-03]
 [ 1.57256911e-02]
 [ 1.82000545e-02]
 [-6.70899034e-03]
 [ 1.35108418e-02]
 [ 1.15429474e-02]
 [-2.02096381e-02]
 [-1.00155925e-02]
 [ 1.14008996e-03]
 [ 7.23788077e-03]
 [-5.34473896e-04]
 [-1.46444619e-02]
 [-1.35967773e-02]
 [ 7.05914416e-03]
 [ 3.39892621e-02]
 [-3.07400865e-03]
 [ 2.96349294e-03]
 [-1.64811641e-02]
 [ 2.06781115e-02]
 [ 9.68179379e-03]
 [ 5.33906305e-03]
 [-8.73702893e-03]
 [ 1.65732778e-04]
 [-5.89615422e-04]
 [-3.84324594e-03]
 [-9.53531948e-04]
 [ 5.95704918e-03]
 [-1.58469604e-02]
 [-5.33350046e-03]
 [-2.31771177e-03]
 [ 1.31515623e-02]
 [ 6.84807845e-03]
 [-2.67206465e-03]
 [-5.12043174e-03]
 [-2.33662354e-03]
 [-1.80330403e-03]
 [-4.16524162e-03]
 [ 1.83504215e-02]
 [ 5.78338408e-03]
 [ 1.40744182e-02]
 [-1.61719369e-03]
 [ 3.31812545e-03]
 [ 2.27643932e-02]
 [ 3.62546230e-03]
 [-1.55211243e-02]
 [-5.60197564e-03]
 [ 1.57555920e-03]
 [ 9.55787372e-03]
 [ 6.06575386e-05]
 [-1.45779102e-03]
 [ 3.33615456e-03]
 [-2.40362620e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.01283157]
curr_Stock_Price:  100.3171499182863
curr_Factors:  [100.31714992]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007397]
Stock Position:  -0.020073965161052455
Bond Position:  [11.02659454]


portfolio before change:  [8.99395656]
curr_Stock_Price:  101.29175522372302
curr_Factors:  [101.29175522]
mat_Sqrt:  [[0.15]]
grads:  [0.32887089]
Stock Position:  0.32887088525883096
Bond Position:  [-24.31795265]


portfolio before change:  [8.78001236]
curr_Stock_Price:  100.64583522309655
curr_Factors:  [100.64583522]
mat_Sqrt:  [[0.15]]
grads:  [0.14466508]
Stock Position:  0.14466508190806315
Bond Position:  [-5.77992564]


portfolio before change:  [8.86651512]
curr_Stock_Price:  101.2462843319385
curr_Factors:  [101.24628433]
mat_Sqrt:  [[0.15]]
grads:  [-0.1790417]
Stock Position:  -0.17904170176103815
Bond Position:  [26.99382217]


portfolio before change:  [8.74183411]
curr_Stock_Price:  101.95208738736282
curr_Factors:  [101.95208739]
mat_Sqrt:  [[0.15]]
grads:  [-0.30937958]
Stock Position:  -0.3093795798256641
Bond Position:  [40.28372807]


portfolio before change:  [8.72156574]
curr_Stock_Price:  102.02573858946678
curr_Factors:  [102.02573859]
mat_Sqrt:  [[0.15]]
grads:  [-0.00902308]
Stock Position:  -0.009023081958701596
Bond Position:  [9.64215234]


portfolio before change:  [8.72131189]
curr_Stock_Price:  102.12066254825055
curr_Factors:  [102.12066255]
mat_Sqrt:  [[0.15]]
grads:  [0.06257108]
Stock Position:  0.06257108174858719
Bond Position:  [2.33151157]


portfolio before change:  [8.78938542]
curr_Stock_Price:  103.20627270226407
curr_Factors:  [103.2062727]
mat_Sqrt:  [[0.15]]
grads:  [-0.42077923]
Stock Position:  -0.4207792349407982
Bond Position:  [52.21644188]


portfolio before change:  [8.79783614]
curr_Stock_Price:  103.19394534024515
curr_Factors:  [103.19394534]
mat_Sqrt:  [[0.15]]
grads:  [0.11906412]
Stock Position:  0.11906411999548223
Bond Position:  [-3.48886015]


portfolio before change:  [8.81283886]
curr_Stock_Price:  103.32178217043258
curr_Factors:  [103.32178217]
mat_Sqrt:  [[0.15]]
grads:  [-0.0573761]
Stock Position:  -0.05737610359469343
Bond Position:  [14.74104014]


portfolio before change:  [8.77257129]
curr_Stock_Price:  104.0396580141471
curr_Factors:  [104.03965801]
mat_Sqrt:  [[0.15]]
grads:  [-0.0962118]
Stock Position:  -0.09621179681588324
Bond Position:  [18.78241373]


portfolio before change:  [8.826093]
curr_Stock_Price:  103.49556911472318
curr_Factors:  [103.49556911]
mat_Sqrt:  [[0.15]]
grads:  [0.14555643]
Stock Position:  0.14555643117172187
Bond Position:  [-6.23835269]


portfolio before change:  [8.68285022]
curr_Stock_Price:  102.51414313513007
curr_Factors:  [102.51414314]
mat_Sqrt:  [[0.15]]
grads:  [-0.02965895]
Stock Position:  -0.029658953091491285
Bond Position:  [11.72331239]


portfolio before change:  [8.71634533]
curr_Stock_Price:  101.40950611486794
curr_Factors:  [101.40950611]
mat_Sqrt:  [[0.15]]
grads:  [0.03551242]
Stock Position:  0.03551242187624994
Bond Position:  [5.11504817]


portfolio before change:  [8.69719244]
curr_Stock_Price:  100.86117441534309
curr_Factors:  [100.86117442]
mat_Sqrt:  [[0.15]]
grads:  [-0.01037914]
Stock Position:  -0.010379139107650679
Bond Position:  [9.7440446]


portfolio before change:  [8.70394409]
curr_Stock_Price:  100.26935002955042
curr_Factors:  [100.26935003]
mat_Sqrt:  [[0.15]]
grads:  [0.09155778]
Stock Position:  0.09155777896224111
Bond Position:  [-0.47649489]


portfolio before change:  [8.67806345]
curr_Stock_Price:  99.98700527184606
curr_Factors:  [99.98700527]
mat_Sqrt:  [[0.15]]
grads:  [0.22887223]
Stock Position:  0.22887222722775794
Bond Position:  [-14.20618514]


portfolio before change:  [8.54745169]
curr_Stock_Price:  99.4202093458183
curr_Factors:  [99.42020935]
mat_Sqrt:  [[0.15]]
grads:  [-0.10113902]
Stock Position:  -0.10113901998665695
Bond Position:  [18.60271423]


portfolio before change:  [8.61247214]
curr_Stock_Price:  98.78882354845632
curr_Factors:  [98.78882355]
mat_Sqrt:  [[0.15]]
grads:  [0.16410714]
Stock Position:  0.16410714203054688
Bond Position:  [-7.59947936]


portfolio before change:  [8.57166697]
curr_Stock_Price:  98.54306831458332
curr_Factors:  [98.54306831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00301105]
Stock Position:  -0.0030110459147374554
Bond Position:  [8.86838467]


portfolio before change:  [8.5728607]
curr_Stock_Price:  98.33070256731014
curr_Factors:  [98.33070257]
mat_Sqrt:  [[0.15]]
grads:  [-0.0505302]
Stock Position:  -0.05053020066519543
Bond Position:  [13.54153084]


portfolio before change:  [8.56815839]
curr_Stock_Price:  98.44051180738961
curr_Factors:  [98.44051181]
mat_Sqrt:  [[0.15]]
grads:  [0.03629918]
Stock Position:  0.03629918343206463
Bond Position:  [4.9948482]


portfolio before change:  [8.56684757]
curr_Stock_Price:  98.39579989829508
curr_Factors:  [98.3957999]
mat_Sqrt:  [[0.15]]
grads:  [0.10298073]
Stock Position:  0.10298073094217576
Bond Position:  [-1.56602382]


portfolio before change:  [8.60104805]
curr_Stock_Price:  98.72885594227964
curr_Factors:  [98.72885594]
mat_Sqrt:  [[0.15]]
grads:  [0.12314648]
Stock Position:  0.12314647626918639
Bond Position:  [-3.55706267]


portfolio before change:  [8.62340671]
curr_Stock_Price:  98.91222283035651
curr_Factors:  [98.91222283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03800189]
Stock Position:  -0.03800189092057071
Bond Position:  [12.38225821]


portfolio before change:  [8.63595631]
curr_Stock_Price:  98.60235193262672
curr_Factors:  [98.60235193]
mat_Sqrt:  [[0.15]]
grads:  [0.03108118]
Stock Position:  0.03108118466969299
Bond Position:  [5.5712784]


portfolio before change:  [8.63787698]
curr_Stock_Price:  98.65294389150273
curr_Factors:  [98.65294389]
mat_Sqrt:  [[0.15]]
grads:  [0.06798815]
Stock Position:  0.06798814540583659
Bond Position:  [1.93064629]


portfolio before change:  [8.65105592]
curr_Stock_Price:  98.84501072241892
curr_Factors:  [98.84501072]
mat_Sqrt:  [[0.15]]
grads:  [0.05502461]
Stock Position:  0.055024605456372444
Bond Position:  [3.2121482]


portfolio before change:  [8.64216125]
curr_Stock_Price:  98.67971309036876
curr_Factors:  [98.67971309]
mat_Sqrt:  [[0.15]]
grads:  [0.10483794]
Stock Position:  0.10483794053144244
Bond Position:  [-1.70321665]


portfolio before change:  [8.566403]
curr_Stock_Price:  97.95810609762152
curr_Factors:  [97.9581061]
mat_Sqrt:  [[0.15]]
grads:  [0.1213337]
Stock Position:  0.12133369671705065
Bond Position:  [-3.31921614]


portfolio before change:  [8.53547619]
curr_Stock_Price:  97.70492536525956
curr_Factors:  [97.70492537]
mat_Sqrt:  [[0.15]]
grads:  [-0.0447266]
Stock Position:  -0.04472660229519645
Bond Position:  [12.90548553]


portfolio before change:  [8.50607938]
curr_Stock_Price:  98.3802153899971
curr_Factors:  [98.38021539]
mat_Sqrt:  [[0.15]]
grads:  [0.09007228]
Stock Position:  0.09007227859622163
Bond Position:  [-0.35525079]


portfolio before change:  [8.45035517]
curr_Stock_Price:  97.76180092040757
curr_Factors:  [97.76180092]
mat_Sqrt:  [[0.15]]
grads:  [0.07695298]
Stock Position:  0.07695298257141113
Bond Position:  [0.92729301]


portfolio before change:  [8.41946085]
curr_Stock_Price:  97.3595776515116
curr_Factors:  [97.35957765]
mat_Sqrt:  [[0.15]]
grads:  [-0.13473092]
Stock Position:  -0.1347309209832185
Bond Position:  [21.53680642]


portfolio before change:  [8.46164303]
curr_Stock_Price:  97.05648400659878
curr_Factors:  [97.05648401]
mat_Sqrt:  [[0.15]]
grads:  [-0.06677062]
Stock Position:  -0.06677061694372474
Bond Position:  [14.94216435]


portfolio before change:  [8.46629604]
curr_Stock_Price:  97.00078450067831
curr_Factors:  [97.0007845]
mat_Sqrt:  [[0.15]]
grads:  [0.0076006]
Stock Position:  0.007600599710537725
Bond Position:  [7.7290319]


portfolio before change:  [8.46804771]
curr_Stock_Price:  97.16769150904767
curr_Factors:  [97.16769151]
mat_Sqrt:  [[0.15]]
grads:  [0.04825254]
Stock Position:  0.04825253849341388
Bond Position:  [3.77945993]


portfolio before change:  [8.47884843]
curr_Stock_Price:  97.38663333654254
curr_Factors:  [97.38663334]
mat_Sqrt:  [[0.15]]
grads:  [-0.00356316]
Stock Position:  -0.0035631593090482486
Bond Position:  [8.82585252]


portfolio before change:  [8.48022936]
curr_Stock_Price:  97.15389288986277
curr_Factors:  [97.15389289]
mat_Sqrt:  [[0.15]]
grads:  [-0.09762975]
Stock Position:  -0.09762974596719279
Bond Position:  [17.96533924]


portfolio before change:  [8.47553903]
curr_Stock_Price:  97.21343611155429
curr_Factors:  [97.21343611]
mat_Sqrt:  [[0.15]]
grads:  [-0.09064518]
Stock Position:  -0.0906451821718256
Bond Position:  [17.28746866]


portfolio before change:  [8.48298259]
curr_Stock_Price:  97.14323868261266
curr_Factors:  [97.14323868]
mat_Sqrt:  [[0.15]]
grads:  [0.04706096]
Stock Position:  0.04706096104109512
Bond Position:  [3.91132842]


portfolio before change:  [8.47175121]
curr_Stock_Price:  96.89938787343753
curr_Factors:  [96.89938787]
mat_Sqrt:  [[0.15]]
grads:  [0.22659508]
Stock Position:  0.22659508090098027
Bond Position:  [-13.48517343]


portfolio before change:  [8.63479003]
curr_Stock_Price:  97.62262366124594
curr_Factors:  [97.62262366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02049339]
Stock Position:  -0.020493391009598728
Bond Position:  [10.63540863]


portfolio before change:  [8.63094358]
curr_Stock_Price:  97.84275242802184
curr_Factors:  [97.84275243]
mat_Sqrt:  [[0.15]]
grads:  [0.01975662]
Stock Position:  0.01975661959583229
Bond Position:  [6.69790154]


portfolio before change:  [8.62318327]
curr_Stock_Price:  97.42876784933244
curr_Factors:  [97.42876785]
mat_Sqrt:  [[0.15]]
grads:  [-0.10987443]
Stock Position:  -0.10987442765622304
Bond Position:  [19.32811338]


portfolio before change:  [8.74877577]
curr_Stock_Price:  96.29670778967375
curr_Factors:  [96.29670779]
mat_Sqrt:  [[0.15]]
grads:  [0.13785408]
Stock Position:  0.13785407680418998
Bond Position:  [-4.52611798]


portfolio before change:  [8.78856729]
curr_Stock_Price:  96.58740950096868
curr_Factors:  [96.5874095]
mat_Sqrt:  [[0.15]]
grads:  [0.06454529]
Stock Position:  0.0645452919554833
Bond Position:  [2.55430475]


portfolio before change:  [8.77213096]
curr_Stock_Price:  96.33028796400116
curr_Factors:  [96.33028796]
mat_Sqrt:  [[0.15]]
grads:  [0.03559375]
Stock Position:  0.0355937536613746
Bond Position:  [5.34337442]


portfolio before change:  [8.74334759]
curr_Stock_Price:  95.51224158399357
curr_Factors:  [95.51224158]
mat_Sqrt:  [[0.15]]
grads:  [-0.05824686]
Stock Position:  -0.05824685952177923
Bond Position:  [14.30663571]


portfolio before change:  [8.78188212]
curr_Stock_Price:  94.86602070105364
curr_Factors:  [94.8660207]
mat_Sqrt:  [[0.15]]
grads:  [0.00110489]
Stock Position:  0.0011048851865730117
Bond Position:  [8.67706606]


portfolio before change:  [8.7822824]
curr_Stock_Price:  94.73745466227554
curr_Factors:  [94.73745466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00393077]
Stock Position:  -0.003930769479018534
Bond Position:  [9.1546735]


portfolio before change:  [8.7827425]
curr_Stock_Price:  94.7659684052607
curr_Factors:  [94.76596841]
mat_Sqrt:  [[0.15]]
grads:  [-0.02562164]
Stock Position:  -0.02562163962239709
Bond Position:  [11.210802]


portfolio before change:  [8.78407467]
curr_Stock_Price:  94.74132235604517
curr_Factors:  [94.74132236]
mat_Sqrt:  [[0.15]]
grads:  [-0.00635688]
Stock Position:  -0.0063568796517101496
Bond Position:  [9.38633386]


portfolio before change:  [8.78138422]
curr_Stock_Price:  95.2568462386008
curr_Factors:  [95.25684624]
mat_Sqrt:  [[0.15]]
grads:  [0.03971366]
Stock Position:  0.039713661211962646
Bond Position:  [4.9983861]


portfolio before change:  [8.76417816]
curr_Stock_Price:  94.81572689305715
curr_Factors:  [94.81572689]
mat_Sqrt:  [[0.15]]
grads:  [-0.1056464]
Stock Position:  -0.1056464027257796
Bond Position:  [18.78111863]


portfolio before change:  [8.77090362]
curr_Stock_Price:  94.76317799058873
curr_Factors:  [94.76317799]
mat_Sqrt:  [[0.15]]
grads:  [-0.03555667]
Stock Position:  -0.035556669747274755
Bond Position:  [12.14036664]


portfolio before change:  [8.7444724]
curr_Stock_Price:  95.52787320798078
curr_Factors:  [95.52787321]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545141]
Stock Position:  -0.015451411767518282
Bond Position:  [10.2205129]


portfolio before change:  [8.74053739]
curr_Stock_Price:  95.8238857869432
curr_Factors:  [95.82388579]
mat_Sqrt:  [[0.15]]
grads:  [0.08767708]
Stock Position:  0.08767708191841883
Bond Position:  [0.33897871]


portfolio before change:  [8.72141536]
curr_Stock_Price:  95.60554806643874
curr_Factors:  [95.60554807]
mat_Sqrt:  [[0.15]]
grads:  [0.04565386]
Stock Position:  0.04565385634562522
Bond Position:  [4.35665341]


portfolio before change:  [8.71635049]
curr_Stock_Price:  95.48864294707705
curr_Factors:  [95.48864295]
mat_Sqrt:  [[0.15]]
grads:  [-0.01781376]
Stock Position:  -0.01781376430163169
Bond Position:  [10.41736267]


portfolio before change:  [8.71615958]
curr_Stock_Price:  95.5359108557325
curr_Factors:  [95.53591086]
mat_Sqrt:  [[0.15]]
grads:  [-0.03413621]
Stock Position:  -0.034136211628960675
Bond Position:  [11.97739365]


portfolio before change:  [8.71497914]
curr_Stock_Price:  95.59242106661716
curr_Factors:  [95.59242107]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557749]
Stock Position:  -0.015577490284291867
Bond Position:  [10.20406915]


portfolio before change:  [8.71385703]
curr_Stock_Price:  95.70539764635073
curr_Factors:  [95.70539765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01202203]
Stock Position:  -0.012022026884739013
Bond Position:  [9.86442989]


portfolio before change:  [8.716634]
curr_Stock_Price:  95.52569216176711
curr_Factors:  [95.52569216]
mat_Sqrt:  [[0.15]]
grads:  [-0.02776828]
Stock Position:  -0.027768277496499523
Bond Position:  [11.36921793]


portfolio before change:  [8.71565379]
curr_Stock_Price:  95.58658185511835
curr_Factors:  [95.58658186]
mat_Sqrt:  [[0.15]]
grads:  [0.12233614]
Stock Position:  0.12233614315564599
Bond Position:  [-2.97803997]


portfolio before change:  [8.75870691]
curr_Stock_Price:  95.9400280511044
curr_Factors:  [95.94002805]
mat_Sqrt:  [[0.15]]
grads:  [0.03855589]
Stock Position:  0.038555893857737486
Bond Position:  [5.05965337]


portfolio before change:  [8.80560325]
curr_Stock_Price:  97.14814705014398
curr_Factors:  [97.14814705]
mat_Sqrt:  [[0.15]]
grads:  [0.09382945]
Stock Position:  0.09382945470497318
Bond Position:  [-0.30975441]


portfolio before change:  [8.79968399]
curr_Stock_Price:  97.08526801640984
curr_Factors:  [97.08526802]
mat_Sqrt:  [[0.15]]
grads:  [-0.01078129]
Stock Position:  -0.010781291286896288
Bond Position:  [9.84638854]


portfolio before change:  [8.79480088]
curr_Stock_Price:  97.59527431966508
curr_Factors:  [97.59527432]
mat_Sqrt:  [[0.15]]
grads:  [0.02212084]
Stock Position:  0.022120836364253497
Bond Position:  [6.63591178]


portfolio before change:  [8.80249332]
curr_Stock_Price:  97.92427103240581
curr_Factors:  [97.92427103]
mat_Sqrt:  [[0.15]]
grads:  [0.15176262]
Stock Position:  0.15176262157147075
Bond Position:  [-6.05875077]


portfolio before change:  [8.75471893]
curr_Stock_Price:  97.6119694547275
curr_Factors:  [97.61196945]
mat_Sqrt:  [[0.15]]
grads:  [0.02416975]
Stock Position:  0.024169748657530764
Bond Position:  [6.39546216]


portfolio before change:  [8.74357985]
curr_Stock_Price:  97.1345624877737
curr_Factors:  [97.13456249]
mat_Sqrt:  [[0.15]]
grads:  [-0.10347416]
Stock Position:  -0.10347416217793143
Bond Position:  [18.79449732]


portfolio before change:  [8.7668531]
curr_Stock_Price:  96.92099652586502
curr_Factors:  [96.92099653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0373465]
Stock Position:  -0.03734650427836786
Bond Position:  [12.38651351]


portfolio before change:  [8.76101703]
curr_Stock_Price:  97.0979943092016
curr_Factors:  [97.09799431]
mat_Sqrt:  [[0.15]]
grads:  [0.01050373]
Stock Position:  0.01050372800217096
Bond Position:  [7.74112611]


portfolio before change:  [8.75989363]
curr_Stock_Price:  96.94497786568529
curr_Factors:  [96.94497787]
mat_Sqrt:  [[0.15]]
grads:  [0.06371916]
Stock Position:  0.06371915815185208
Bond Position:  [2.58264125]


portfolio before change:  [8.83463393]
curr_Stock_Price:  98.11540887568356
curr_Factors:  [98.11540888]
mat_Sqrt:  [[0.15]]
grads:  [0.00040438]
Stock Position:  0.00040438359079233066
Bond Position:  [8.79495766]


portfolio before change:  [8.83529723]
curr_Stock_Price:  98.39633242498317
curr_Factors:  [98.39633242]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971861]
Stock Position:  -0.009718606813244445
Bond Position:  [9.7915725]


portfolio before change:  [8.83116272]
curr_Stock_Price:  98.88472537964348
curr_Factors:  [98.88472538]
mat_Sqrt:  [[0.15]]
grads:  [0.02224103]
Stock Position:  0.022241030421853852
Bond Position:  [6.63186454]


portfolio before change:  [8.83437126]
curr_Stock_Price:  99.01035048147618
curr_Factors:  [99.01035048]
mat_Sqrt:  [[0.15]]
grads:  [-0.16024175]
Stock Position:  -0.1602417467893688
Bond Position:  [24.69996277]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.86476979]
Stock Price:  98.830280471654
PL:  [8.86476979]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38208609e-02]
 [-1.53669955e-02]
 [ 4.27555979e-02]
 [-1.20157346e-02]
 [ 1.09787252e-02]
 [-1.92215988e-02]
 [-1.40461560e-02]
 [ 9.05250950e-02]
 [-2.11277721e-02]
 [-1.35384890e-02]
 [-2.63072005e-03]
 [-5.67717257e-03]
 [ 2.64553312e-03]
 [-9.34401276e-03]
 [ 2.03937062e-03]
 [ 1.84970989e-03]
 [-4.08047864e-02]
 [-9.78576525e-03]
 [ 2.34488661e-02]
 [-3.85383792e-03]
 [-1.71129029e-02]
 [ 5.52638167e-03]
 [ 1.28854393e-02]
 [ 1.99928177e-02]
 [-3.15024424e-03]
 [ 4.51210835e-03]
 [ 7.69307740e-03]
 [ 8.96488123e-03]
 [ 1.58192155e-02]
 [ 2.79255782e-03]
 [-6.40415310e-03]
 [ 1.21380725e-02]
 [ 1.15086697e-02]
 [-1.70975057e-02]
 [-4.35671712e-03]
 [ 1.80715436e-02]
 [ 4.38041601e-03]
 [-3.04396575e-04]
 [-3.39444202e-02]
 [-1.59880646e-02]
 [ 7.17245209e-03]
 [ 1.57328516e-02]
 [-2.06634870e-03]
 [ 2.92897644e-04]
 [ 1.62092550e-02]
 [ 1.54294231e-02]
 [ 1.07234452e-02]
 [ 4.07830313e-03]
 [ 8.91047609e-03]
 [-1.79957811e-03]
 [ 1.04022786e-02]
 [-1.76605443e-02]
 [ 1.88828705e-03]
 [ 1.60198878e-03]
 [-3.88419413e-03]
 [-3.70286201e-03]
 [ 8.82323166e-03]
 [ 3.03875410e-03]
 [ 6.95353040e-03]
 [-4.01743328e-03]
 [-5.56976672e-04]
 [ 5.96307756e-03]
 [-7.93458372e-03]
 [ 7.41474299e-03]
 [ 2.53627230e-02]
 [ 5.55486778e-03]
 [ 8.79882408e-03]
 [ 2.43766374e-04]
 [ 2.95090545e-03]
 [ 2.17827582e-02]
 [ 1.75332102e-03]
 [-1.59508129e-02]
 [-6.16309711e-03]
 [ 9.97821410e-04]
 [ 7.67554906e-03]
 [ 7.75765526e-04]
 [-1.46291455e-03]
 [ 2.39149473e-04]
 [-2.36802006e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.9954619]
curr_Stock_Price:  99.68092193580776
curr_Factors:  [99.68092194]
mat_Sqrt:  [[0.15]]
grads:  [-0.09213907]
Stock Position:  -0.092139072871699
Bond Position:  [4.18904583]


portfolio before change:  [-4.9425148]
curr_Stock_Price:  99.10912024070286
curr_Factors:  [99.10912024]
mat_Sqrt:  [[0.15]]
grads:  [-0.10244664]
Stock Position:  -0.1024466366783975
Bond Position:  [5.21088123]


portfolio before change:  [-4.89498261]
curr_Stock_Price:  98.64832913728563
curr_Factors:  [98.64832914]
mat_Sqrt:  [[0.15]]
grads:  [0.28503732]
Stock Position:  0.28503731918147335
Bond Position:  [-33.01343789]


portfolio before change:  [-4.98591222]
curr_Stock_Price:  98.33655870905152
curr_Factors:  [98.33655871]
mat_Sqrt:  [[0.15]]
grads:  [-0.0801049]
Stock Position:  -0.08010489742676204
Bond Position:  [2.89132773]


portfolio before change:  [-4.99717157]
curr_Stock_Price:  98.47937222810026
curr_Factors:  [98.47937223]
mat_Sqrt:  [[0.15]]
grads:  [0.0731915]
Stock Position:  0.07319150106821927
Bond Position:  [-12.20502465]


portfolio before change:  [-5.12532353]
curr_Stock_Price:  96.73888159442266
curr_Factors:  [96.73888159]
mat_Sqrt:  [[0.15]]
grads:  [-0.12814399]
Stock Position:  -0.1281439921113153
Bond Position:  [7.27118295]


portfolio before change:  [-5.01002742]
curr_Stock_Price:  95.842689379991
curr_Factors:  [95.84268938]
mat_Sqrt:  [[0.15]]
grads:  [-0.09364104]
Stock Position:  -0.09364104025929532
Bond Position:  [3.96478172]


portfolio before change:  [-5.07928181]
curr_Stock_Price:  96.5849087594777
curr_Factors:  [96.58490876]
mat_Sqrt:  [[0.15]]
grads:  [0.60350063]
Stock Position:  0.6035006331846097
Bond Position:  [-63.3683354]


portfolio before change:  [-5.1777097]
curr_Stock_Price:  96.42837661457048
curr_Factors:  [96.42837661]
mat_Sqrt:  [[0.15]]
grads:  [-0.14085181]
Stock Position:  -0.14085181376945086
Bond Position:  [8.40440205]


portfolio before change:  [-5.1842481]
curr_Stock_Price:  96.47852643247663
curr_Factors:  [96.47852643]
mat_Sqrt:  [[0.15]]
grads:  [-0.09025659]
Stock Position:  -0.09025659338848034
Bond Position:  [3.52357503]


portfolio before change:  [-5.22097645]
curr_Stock_Price:  96.887899063828
curr_Factors:  [96.88789906]
mat_Sqrt:  [[0.15]]
grads:  [-0.01753813]
Stock Position:  -0.01753813363581038
Bond Position:  [-3.52174353]


portfolio before change:  [-5.22266813]
curr_Stock_Price:  96.9718058554351
curr_Factors:  [96.97180586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03784782]
Stock Position:  -0.037847817143214696
Bond Position:  [-1.55249696]


portfolio before change:  [-5.2199075]
curr_Stock_Price:  96.89630171317366
curr_Factors:  [96.89630171]
mat_Sqrt:  [[0.15]]
grads:  [0.01763689]
Stock Position:  0.01763688749416958
Bond Position:  [-6.92885667]


portfolio before change:  [-5.22709303]
curr_Stock_Price:  96.51344173393188
curr_Factors:  [96.51344173]
mat_Sqrt:  [[0.15]]
grads:  [-0.06229342]
Stock Position:  -0.06229341836921144
Bond Position:  [0.78505918]


portfolio before change:  [-5.2782581]
curr_Stock_Price:  97.33558543102309
curr_Factors:  [97.33558543]
mat_Sqrt:  [[0.15]]
grads:  [0.0135958]
Stock Position:  0.013595804126270197
Bond Position:  [-6.60161365]


portfolio before change:  [-5.28297562]
curr_Stock_Price:  97.01895089982486
curr_Factors:  [97.0189509]
mat_Sqrt:  [[0.15]]
grads:  [0.0123314]
Stock Position:  0.012331399250718189
Bond Position:  [-6.47935503]


portfolio before change:  [-5.28903436]
curr_Stock_Price:  96.56046524114613
curr_Factors:  [96.56046524]
mat_Sqrt:  [[0.15]]
grads:  [-0.27203191]
Stock Position:  -0.27203190908731323
Bond Position:  [20.97849334]


portfolio before change:  [-5.22536757]
curr_Stock_Price:  96.33124363788215
curr_Factors:  [96.33124364]
mat_Sqrt:  [[0.15]]
grads:  [-0.06523843]
Stock Position:  -0.06523843499554118
Bond Position:  [1.05913201]


portfolio before change:  [-5.23851977]
curr_Stock_Price:  96.53386039291757
curr_Factors:  [96.53386039]
mat_Sqrt:  [[0.15]]
grads:  [0.15632577]
Stock Position:  0.15632577416266707
Bond Position:  [-20.32925023]


portfolio before change:  [-5.20454691]
curr_Stock_Price:  96.75930935317831
curr_Factors:  [96.75930935]
mat_Sqrt:  [[0.15]]
grads:  [-0.02569225]
Stock Position:  -0.02569225278196959
Bond Position:  [-2.71858227]


portfolio before change:  [-5.21436507]
curr_Stock_Price:  97.13484084908671
curr_Factors:  [97.13484085]
mat_Sqrt:  [[0.15]]
grads:  [-0.11408602]
Stock Position:  -0.11408601930476643
Bond Position:  [5.86736225]


portfolio before change:  [-5.2926675]
curr_Stock_Price:  97.8244007645617
curr_Factors:  [97.82440076]
mat_Sqrt:  [[0.15]]
grads:  [0.03684254]
Stock Position:  0.03684254444963241
Bond Position:  [-8.89676733]


portfolio before change:  [-5.29773082]
curr_Stock_Price:  97.70206232079653
curr_Factors:  [97.70206232]
mat_Sqrt:  [[0.15]]
grads:  [0.08590293]
Stock Position:  0.08590292887284719
Bond Position:  [-13.69062413]


portfolio before change:  [-5.31827025]
curr_Stock_Price:  97.47292300579262
curr_Factors:  [97.47292301]
mat_Sqrt:  [[0.15]]
grads:  [0.13328545]
Stock Position:  0.13328545164628586
Bond Position:  [-18.30999282]


portfolio before change:  [-5.2179457]
curr_Stock_Price:  98.23421358587379
curr_Factors:  [98.23421359]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100163]
Stock Position:  -0.021001628272804412
Bond Position:  [-3.15486727]


portfolio before change:  [-5.21778401]
curr_Stock_Price:  98.21712564236377
curr_Factors:  [98.21712564]
mat_Sqrt:  [[0.15]]
grads:  [0.03008072]
Stock Position:  0.030080722333418342
Bond Position:  [-8.1722261]


portfolio before change:  [-5.21527832]
curr_Stock_Price:  98.3174049305947
curr_Factors:  [98.31740493]
mat_Sqrt:  [[0.15]]
grads:  [0.05128718]
Stock Position:  0.05128718265862643
Bond Position:  [-10.25770103]


portfolio before change:  [-5.22463404]
curr_Stock_Price:  98.1474873970989
curr_Factors:  [98.1474874]
mat_Sqrt:  [[0.15]]
grads:  [0.05976587]
Stock Position:  0.05976587483722801
Bond Position:  [-11.09050449]


portfolio before change:  [-5.21153726]
curr_Stock_Price:  98.37822036734138
curr_Factors:  [98.37822037]
mat_Sqrt:  [[0.15]]
grads:  [0.10546144]
Stock Position:  0.10546143657409981
Bond Position:  [-15.58664571]


portfolio before change:  [-5.17481144]
curr_Stock_Price:  98.73569711777606
curr_Factors:  [98.73569712]
mat_Sqrt:  [[0.15]]
grads:  [0.01861705]
Stock Position:  0.018617052143872007
Bond Position:  [-7.01297906]


portfolio before change:  [-5.18203265]
curr_Stock_Price:  98.37135985591176
curr_Factors:  [98.37135986]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269435]
Stock Position:  -0.04269435402584468
Bond Position:  [-0.98213099]


portfolio before change:  [-5.19135839]
curr_Stock_Price:  98.58835216183128
curr_Factors:  [98.58835216]
mat_Sqrt:  [[0.15]]
grads:  [0.08092048]
Stock Position:  0.08092048340097194
Bond Position:  [-13.1691755]


portfolio before change:  [-5.18541835]
curr_Stock_Price:  98.67192973776618
curr_Factors:  [98.67192974]
mat_Sqrt:  [[0.15]]
grads:  [0.07672446]
Stock Position:  0.07672446463284696
Bond Position:  [-12.75596933]


portfolio before change:  [-5.18415934]
curr_Stock_Price:  98.69873060522875
curr_Factors:  [98.69873061]
mat_Sqrt:  [[0.15]]
grads:  [-0.11398337]
Stock Position:  -0.11398337117409278
Bond Position:  [6.06585471]


portfolio before change:  [-5.12487419]
curr_Stock_Price:  98.18193578562853
curr_Factors:  [98.18193579]
mat_Sqrt:  [[0.15]]
grads:  [-0.02904478]
Stock Position:  -0.029044780824452998
Bond Position:  [-2.27320139]


portfolio before change:  [-5.12138095]
curr_Stock_Price:  98.05677292858852
curr_Factors:  [98.05677293]
mat_Sqrt:  [[0.15]]
grads:  [0.12047696]
Stock Position:  0.12047695707746892
Bond Position:  [-16.93496257]


portfolio before change:  [-5.15607519]
curr_Stock_Price:  97.77758447706493
curr_Factors:  [97.77758448]
mat_Sqrt:  [[0.15]]
grads:  [0.02920277]
Stock Position:  0.029202773374068756
Bond Position:  [-8.01145183]


portfolio before change:  [-5.1521033]
curr_Stock_Price:  97.93074169734801
curr_Factors:  [97.9307417]
mat_Sqrt:  [[0.15]]
grads:  [-0.00202931]
Stock Position:  -0.0020293104973363326
Bond Position:  [-4.95337142]


portfolio before change:  [-5.15188]
curr_Stock_Price:  97.66813936793842
curr_Factors:  [97.66813937]
mat_Sqrt:  [[0.15]]
grads:  [-0.22629613]
Stock Position:  -0.22629613463612683
Bond Position:  [16.95004242]


portfolio before change:  [-5.37029438]
curr_Stock_Price:  98.63799149404286
curr_Factors:  [98.63799149]
mat_Sqrt:  [[0.15]]
grads:  [-0.1065871]
Stock Position:  -0.10658709739271319
Bond Position:  [5.14324283]


portfolio before change:  [-5.38224809]
curr_Stock_Price:  98.75315714850505
curr_Factors:  [98.75315715]
mat_Sqrt:  [[0.15]]
grads:  [0.04781635]
Stock Position:  0.04781634725661492
Bond Position:  [-10.10426334]


portfolio before change:  [-5.37855603]
curr_Stock_Price:  98.84357796868338
curr_Factors:  [98.84357797]
mat_Sqrt:  [[0.15]]
grads:  [0.10488568]
Stock Position:  0.10488567706843702
Bond Position:  [-15.74583163]


portfolio before change:  [-5.34697156]
curr_Stock_Price:  99.1540933718724
curr_Factors:  [99.15409337]
mat_Sqrt:  [[0.15]]
grads:  [-0.01377566]
Stock Position:  -0.013775657989020642
Bond Position:  [-3.98105868]


portfolio before change:  [-5.34029907]
curr_Stock_Price:  98.65166265774207
curr_Factors:  [98.65166266]
mat_Sqrt:  [[0.15]]
grads:  [0.00195265]
Stock Position:  0.001952650963111379
Bond Position:  [-5.53293133]


portfolio before change:  [-5.33925599]
curr_Stock_Price:  99.36295004429923
curr_Factors:  [99.36295004]
mat_Sqrt:  [[0.15]]
grads:  [0.1080617]
Stock Position:  0.10806169974370976
Bond Position:  [-16.07658526]


portfolio before change:  [-5.30734582]
curr_Stock_Price:  99.66754443297192
curr_Factors:  [99.66754443]
mat_Sqrt:  [[0.15]]
grads:  [0.10286282]
Stock Position:  0.10286282068071369
Bond Position:  [-15.55943057]


portfolio before change:  [-5.34370268]
curr_Stock_Price:  99.32354870552123
curr_Factors:  [99.32354871]
mat_Sqrt:  [[0.15]]
grads:  [0.07148963]
Stock Position:  0.07148963490659319
Bond Position:  [-12.44430692]


portfolio before change:  [-5.28703097]
curr_Stock_Price:  100.12715480377
curr_Factors:  [100.1271548]
mat_Sqrt:  [[0.15]]
grads:  [0.02718869]
Stock Position:  0.027188687512739902
Bond Position:  [-8.00935689]


portfolio before change:  [-5.28832228]
curr_Stock_Price:  100.0980724972949
curr_Factors:  [100.0980725]
mat_Sqrt:  [[0.15]]
grads:  [0.05940317]
Stock Position:  0.05940317395860407
Bond Position:  [-11.2344655]


portfolio before change:  [-5.26920298]
curr_Stock_Price:  100.4317495130553
curr_Factors:  [100.43174951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199719]
Stock Position:  -0.011997187396534263
Bond Position:  [-4.06430446]


portfolio before change:  [-5.27872036]
curr_Stock_Price:  101.20387647362811
curr_Factors:  [101.20387647]
mat_Sqrt:  [[0.15]]
grads:  [0.06934852]
Stock Position:  0.06934852374292652
Bond Position:  [-12.29705979]


portfolio before change:  [-5.26288008]
curr_Stock_Price:  101.44337507627996
curr_Factors:  [101.44337508]
mat_Sqrt:  [[0.15]]
grads:  [-0.11773696]
Stock Position:  -0.11773696223210527
Bond Position:  [6.68075474]


portfolio before change:  [-5.24570411]
curr_Stock_Price:  101.30103734848612
curr_Factors:  [101.30103735]
mat_Sqrt:  [[0.15]]
grads:  [0.01258858]
Stock Position:  0.012588580305643565
Bond Position:  [-6.52094035]


portfolio before change:  [-5.24796444]
curr_Stock_Price:  101.15385940817953
curr_Factors:  [101.15385941]
mat_Sqrt:  [[0.15]]
grads:  [0.01067993]
Stock Position:  0.010679925185637686
Bond Position:  [-6.32828009]


portfolio before change:  [-5.25243963]
curr_Stock_Price:  100.7718656592202
curr_Factors:  [100.77186566]
mat_Sqrt:  [[0.15]]
grads:  [-0.02589463]
Stock Position:  -0.02589462751977427
Bond Position:  [-2.64298971]


portfolio before change:  [-5.25767006]
curr_Stock_Price:  100.96747521343802
curr_Factors:  [100.96747521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02468575]
Stock Position:  -0.024685746714020254
Bond Position:  [-2.76521254]


portfolio before change:  [-5.25182412]
curr_Stock_Price:  100.72365966519895
curr_Factors:  [100.72365967]
mat_Sqrt:  [[0.15]]
grads:  [0.05882154]
Stock Position:  0.05882154441351244
Bond Position:  [-11.17654535]


portfolio before change:  [-5.28554328]
curr_Stock_Price:  100.16229045065245
curr_Factors:  [100.16229045]
mat_Sqrt:  [[0.15]]
grads:  [0.02025836]
Stock Position:  0.020258360698037735
Bond Position:  [-7.31466709]


portfolio before change:  [-5.27406392]
curr_Stock_Price:  100.75150619852171
curr_Factors:  [100.7515062]
mat_Sqrt:  [[0.15]]
grads:  [0.04635687]
Stock Position:  0.04635686933017972
Bond Position:  [-9.94458833]


portfolio before change:  [-5.3272545]
curr_Stock_Price:  99.6174989620152
curr_Factors:  [99.61749896]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678289]
Stock Position:  -0.026782888553304313
Bond Position:  [-2.65921013]


portfolio before change:  [-5.34620863]
curr_Stock_Price:  100.31898858527444
curr_Factors:  [100.31898859]
mat_Sqrt:  [[0.15]]
grads:  [-0.00371318]
Stock Position:  -0.003713177810443005
Bond Position:  [-4.97370638]


portfolio before change:  [-5.34736546]
curr_Stock_Price:  100.54681823367717
curr_Factors:  [100.54681823]
mat_Sqrt:  [[0.15]]
grads:  [0.03975385]
Stock Position:  0.03975385039621237
Bond Position:  [-9.34448863]


portfolio before change:  [-5.36466101]
curr_Stock_Price:  100.12644395902547
curr_Factors:  [100.12644396]
mat_Sqrt:  [[0.15]]
grads:  [-0.05289722]
Stock Position:  -0.05289722481682249
Bond Position:  [-0.06824999]


portfolio before change:  [-5.36105418]
curr_Stock_Price:  100.05817769798578
curr_Factors:  [100.0581777]
mat_Sqrt:  [[0.15]]
grads:  [0.04943162]
Stock Position:  0.049431619959875016
Bond Position:  [-10.30709199]


portfolio before change:  [-5.31580015]
curr_Stock_Price:  100.98669762412793
curr_Factors:  [100.98669762]
mat_Sqrt:  [[0.15]]
grads:  [0.16908482]
Stock Position:  0.16908481976107473
Bond Position:  [-22.39111771]


portfolio before change:  [-5.31297572]
curr_Stock_Price:  101.01167869157912
curr_Factors:  [101.01167869]
mat_Sqrt:  [[0.15]]
grads:  [0.03703245]
Stock Position:  0.03703245183671016
Bond Position:  [-9.05368584]


portfolio before change:  [-5.33089572]
curr_Stock_Price:  100.54305917081298
curr_Factors:  [100.54305917]
mat_Sqrt:  [[0.15]]
grads:  [0.05865883]
Stock Position:  0.058658827208256346
Bond Position:  [-11.22863366]


portfolio before change:  [-5.31677127]
curr_Stock_Price:  100.79581339092445
curr_Factors:  [100.79581339]
mat_Sqrt:  [[0.15]]
grads:  [0.00162511]
Stock Position:  0.0016251091576496037
Bond Position:  [-5.48057547]


portfolio before change:  [-5.31819103]
curr_Stock_Price:  100.13295778144351
curr_Factors:  [100.13295778]
mat_Sqrt:  [[0.15]]
grads:  [0.0196727]
Stock Position:  0.019672702995346715
Bond Position:  [-7.28807696]


portfolio before change:  [-5.32426302]
curr_Stock_Price:  99.84746212904605
curr_Factors:  [99.84746213]
mat_Sqrt:  [[0.15]]
grads:  [0.14521839]
Stock Position:  0.14521838805253454
Bond Position:  [-19.82395052]


portfolio before change:  [-5.38332082]
curr_Stock_Price:  99.4493116638302
curr_Factors:  [99.44931166]
mat_Sqrt:  [[0.15]]
grads:  [0.01168881]
Stock Position:  0.01168880681569916
Bond Position:  [-6.54576461]


portfolio before change:  [-5.38571363]
curr_Stock_Price:  99.27960360313166
curr_Factors:  [99.2796036]
mat_Sqrt:  [[0.15]]
grads:  [-0.10633875]
Stock Position:  -0.10633875254649319
Bond Position:  [5.17155557]


portfolio before change:  [-5.28655851]
curr_Stock_Price:  98.35019748555432
curr_Factors:  [98.35019749]
mat_Sqrt:  [[0.15]]
grads:  [-0.04108731]
Stock Position:  -0.041087314039456826
Bond Position:  [-1.24561306]


portfolio before change:  [-5.28477399]
curr_Stock_Price:  98.30487042629882
curr_Factors:  [98.30487043]
mat_Sqrt:  [[0.15]]
grads:  [0.00665214]
Stock Position:  0.006652142736649443
Bond Position:  [-5.93871202]


portfolio before change:  [-5.28719626]
curr_Stock_Price:  97.99653584779458
curr_Factors:  [97.99653585]
mat_Sqrt:  [[0.15]]
grads:  [0.05117033]
Stock Position:  0.051170327078576015
Bond Position:  [-10.30171105]


portfolio before change:  [-5.30682234]
curr_Stock_Price:  97.62557468848631
curr_Factors:  [97.62557469]
mat_Sqrt:  [[0.15]]
grads:  [0.00517177]
Stock Position:  0.005171770170267534
Bond Position:  [-5.81171938]


portfolio before change:  [-5.30353893]
curr_Stock_Price:  98.33068239769453
curr_Factors:  [98.3306824]
mat_Sqrt:  [[0.15]]
grads:  [-0.00975276]
Stock Position:  -0.009752763656860145
Bond Position:  [-4.34454303]


portfolio before change:  [-5.30602016]
curr_Stock_Price:  98.55725238367913
curr_Factors:  [98.55725238]
mat_Sqrt:  [[0.15]]
grads:  [0.00159433]
Stock Position:  0.0015943298196714403
Bond Position:  [-5.46315292]


portfolio before change:  [-5.3066943]
curr_Stock_Price:  98.34858688938229
curr_Factors:  [98.34858689]
mat_Sqrt:  [[0.15]]
grads:  [-0.157868]
Stock Position:  -0.15786800370729165
Bond Position:  [10.21940078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.20185953]
Stock Price:  97.68856690718596
PL:  [-5.20185953]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38451635e-02]
 [ 1.27615906e-02]
 [ 2.01289593e-02]
 [-8.73760246e-03]
 [ 1.20526884e-02]
 [-9.13057908e-03]
 [ 9.38069665e-04]
 [-8.93752415e-03]
 [ 1.03734333e-02]
 [ 3.94484974e-04]
 [ 1.30563170e-02]
 [ 4.42181479e-03]
 [-3.76646673e-03]
 [ 5.46002641e-03]
 [ 4.31755553e-03]
 [ 1.16733343e-02]
 [ 5.45733687e-02]
 [-1.36720605e-02]
 [ 1.81697805e-02]
 [ 1.64943422e-03]
 [-4.15408609e-03]
 [ 4.74573714e-03]
 [ 1.85484070e-02]
 [ 1.72500753e-02]
 [-2.54308732e-03]
 [ 7.09784990e-03]
 [-8.26680383e-03]
 [ 7.48894472e-03]
 [ 3.13475172e-02]
 [ 8.54882319e-04]
 [-7.84064110e-03]
 [ 7.58993934e-03]
 [ 1.23576170e-02]
 [ 9.50052579e-03]
 [ 5.17715275e-03]
 [ 1.04081532e-02]
 [-2.14024836e-02]
 [ 3.32310144e-03]
 [-5.69575609e-02]
 [ 1.17593975e-02]
 [ 6.96662494e-03]
 [-1.53011467e-03]
 [-1.48344090e-03]
 [-3.10609804e-03]
 [ 2.18413364e-02]
 [ 1.46630242e-02]
 [ 1.07174741e-02]
 [ 3.39852251e-03]
 [ 1.51991615e-02]
 [-1.36874694e-03]
 [ 2.02333101e-02]
 [-1.25909338e-02]
 [ 1.52965460e-03]
 [-1.46247233e-03]
 [-4.28829437e-03]
 [-4.29682574e-03]
 [ 5.74770801e-03]
 [ 3.37984810e-03]
 [ 6.93753129e-03]
 [-4.01484599e-03]
 [-2.07380286e-03]
 [ 7.80846446e-03]
 [-1.79344222e-02]
 [ 4.65858779e-03]
 [ 2.54894613e-02]
 [ 5.43222007e-03]
 [ 9.53467471e-03]
 [ 4.45650423e-03]
 [ 4.52422255e-03]
 [ 1.99342298e-02]
 [ 3.30985247e-04]
 [-1.59560175e-02]
 [-2.64761014e-04]
 [ 1.29469602e-03]
 [ 1.03221285e-03]
 [-1.13570050e-02]
 [-4.24644470e-03]
 [ 1.59927251e-02]
 [-1.62632259e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.04160562]
curr_Stock_Price:  99.86049798557464
curr_Factors:  [99.86049799]
mat_Sqrt:  [[0.15]]
grads:  [-0.09230109]
Stock Position:  -0.09230109021759676
Bond Position:  [8.17562722]


portfolio before change:  [-1.06202974]
curr_Stock_Price:  100.08731123873858
curr_Factors:  [100.08731124]
mat_Sqrt:  [[0.15]]
grads:  [0.08507727]
Stock Position:  0.08507727045292661
Bond Position:  [-9.57718498]


portfolio before change:  [-0.98466695]
curr_Stock_Price:  101.00367087143697
curr_Factors:  [101.00367087]
mat_Sqrt:  [[0.15]]
grads:  [0.13419306]
Stock Position:  0.13419306179381493
Bond Position:  [-14.5386588]


portfolio before change:  [-1.07431433]
curr_Stock_Price:  100.34239461149834
curr_Factors:  [100.34239461]
mat_Sqrt:  [[0.15]]
grads:  [-0.05825068]
Stock Position:  -0.0582506830669778
Bond Position:  [4.77069869]


portfolio before change:  [-1.05252747]
curr_Stock_Price:  99.97349441130905
curr_Factors:  [99.97349441]
mat_Sqrt:  [[0.15]]
grads:  [0.08035126]
Stock Position:  0.08035125626235062
Bond Position:  [-9.08552333]


portfolio before change:  [-1.07434396]
curr_Stock_Price:  99.70904761511403
curr_Factors:  [99.70904762]
mat_Sqrt:  [[0.15]]
grads:  [-0.06087053]
Stock Position:  -0.0608705272077769
Bond Position:  [4.99499833]


portfolio before change:  [-1.10258184]
curr_Stock_Price:  100.17807723565201
curr_Factors:  [100.17807724]
mat_Sqrt:  [[0.15]]
grads:  [0.0062538]
Stock Position:  0.006253797768188836
Bond Position:  [-1.72907528]


portfolio before change:  [-1.10294252]
curr_Stock_Price:  100.13768536181482
curr_Factors:  [100.13768536]
mat_Sqrt:  [[0.15]]
grads:  [-0.05958349]
Stock Position:  -0.05958349430949092
Bond Position:  [4.86361069]


portfolio before change:  [-1.15937836]
curr_Stock_Price:  101.08995965981444
curr_Factors:  [101.08995966]
mat_Sqrt:  [[0.15]]
grads:  [0.06915622]
Stock Position:  0.06915622175846443
Bond Position:  [-8.15037803]


portfolio before change:  [-1.1765136]
curr_Stock_Price:  100.84955002479961
curr_Factors:  [100.84955002]
mat_Sqrt:  [[0.15]]
grads:  [0.0026299]
Stock Position:  0.002629899825526879
Bond Position:  [-1.44173781]


portfolio before change:  [-1.17871204]
curr_Stock_Price:  100.04787285663095
curr_Factors:  [100.04787286]
mat_Sqrt:  [[0.15]]
grads:  [0.08704211]
Stock Position:  0.08704211353384708
Bond Position:  [-9.88709035]


portfolio before change:  [-1.10873019]
curr_Stock_Price:  100.85897229904006
curr_Factors:  [100.8589723]
mat_Sqrt:  [[0.15]]
grads:  [0.02947877]
Stock Position:  0.029478765269653474
Bond Position:  [-4.08192816]


portfolio before change:  [-1.08723929]
curr_Stock_Price:  101.59665697770406
curr_Factors:  [101.59665698]
mat_Sqrt:  [[0.15]]
grads:  [-0.02510978]
Stock Position:  -0.025109778168472124
Bond Position:  [1.46383023]


portfolio before change:  [-1.07989076]
curr_Stock_Price:  101.30764441204857
curr_Factors:  [101.30764441]
mat_Sqrt:  [[0.15]]
grads:  [0.03640018]
Stock Position:  0.03640017607172715
Bond Position:  [-4.76750685]


portfolio before change:  [-1.05229025]
curr_Stock_Price:  102.07408244292029
curr_Factors:  [102.07408244]
mat_Sqrt:  [[0.15]]
grads:  [0.0287837]
Stock Position:  0.028783703521516817
Bond Position:  [-3.99036038]


portfolio before change:  [-1.05326625]
curr_Stock_Price:  102.04883946531601
curr_Factors:  [102.04883947]
mat_Sqrt:  [[0.15]]
grads:  [0.07782223]
Stock Position:  0.0778222286287482
Bond Position:  [-8.99493436]


portfolio before change:  [-1.13745389]
curr_Stock_Price:  100.97426929207305
curr_Factors:  [100.97426929]
mat_Sqrt:  [[0.15]]
grads:  [0.36382246]
Stock Position:  0.3638224579597516
Bond Position:  [-37.87416074]


portfolio before change:  [-0.95066181]
curr_Stock_Price:  101.49419125709055
curr_Factors:  [101.49419126]
mat_Sqrt:  [[0.15]]
grads:  [-0.09114707]
Stock Position:  -0.09114707032052491
Bond Position:  [8.30023637]


portfolio before change:  [-0.93332006]
curr_Stock_Price:  101.30962174494904
curr_Factors:  [101.30962174]
mat_Sqrt:  [[0.15]]
grads:  [0.12113187]
Stock Position:  0.12113186970221415
Bond Position:  [-13.20514396]


portfolio before change:  [-0.95089982]
curr_Stock_Price:  101.17130627826609
curr_Factors:  [101.17130628]
mat_Sqrt:  [[0.15]]
grads:  [0.01099623]
Stock Position:  0.01099622811713669
Bond Position:  [-2.06340258]


portfolio before change:  [-0.95587612]
curr_Stock_Price:  100.73048896498906
curr_Factors:  [100.73048896]
mat_Sqrt:  [[0.15]]
grads:  [-0.02769391]
Stock Position:  -0.02769390726411352
Bond Position:  [1.8337447]


portfolio before change:  [-0.922651]
curr_Stock_Price:  99.53490092065817
curr_Factors:  [99.53490092]
mat_Sqrt:  [[0.15]]
grads:  [0.03163825]
Stock Position:  0.031638247624891314
Bond Position:  [-4.07176084]


portfolio before change:  [-0.92839598]
curr_Stock_Price:  99.36136137689402
curr_Factors:  [99.36136138]
mat_Sqrt:  [[0.15]]
grads:  [0.12365605]
Stock Position:  0.12365604695240776
Bond Position:  [-13.21502915]


portfolio before change:  [-0.81446111]
curr_Stock_Price:  100.28942626632468
curr_Factors:  [100.28942627]
mat_Sqrt:  [[0.15]]
grads:  [0.1150005]
Stock Position:  0.11500050226331361
Bond Position:  [-12.3477955]


portfolio before change:  [-0.7158118]
curr_Stock_Price:  101.1539535092637
curr_Factors:  [101.15395351]
mat_Sqrt:  [[0.15]]
grads:  [-0.01695392]
Stock Position:  -0.016953915473168123
Bond Position:  [0.99914377]


portfolio before change:  [-0.7180131]
curr_Stock_Price:  101.28747699856206
curr_Factors:  [101.287477]
mat_Sqrt:  [[0.15]]
grads:  [0.047319]
Stock Position:  0.047318999318966916
Bond Position:  [-5.51083516]


portfolio before change:  [-0.7201461]
curr_Stock_Price:  101.24967897325277
curr_Factors:  [101.24967897]
mat_Sqrt:  [[0.15]]
grads:  [-0.05511203]
Stock Position:  -0.055112025543254256
Bond Position:  [4.85992879]


portfolio before change:  [-0.7086275]
curr_Stock_Price:  101.04618709600065
curr_Factors:  [101.0461871]
mat_Sqrt:  [[0.15]]
grads:  [0.0499263]
Stock Position:  0.04992629811312512
Bond Position:  [-5.75348956]


portfolio before change:  [-0.72714869]
curr_Stock_Price:  100.68241909374159
curr_Factors:  [100.68241909]
mat_Sqrt:  [[0.15]]
grads:  [0.20898345]
Stock Position:  0.2089834479381792
Bond Position:  [-21.76810778]


portfolio before change:  [-0.91262336]
curr_Stock_Price:  99.80142051003963
curr_Factors:  [99.80142051]
mat_Sqrt:  [[0.15]]
grads:  [0.00569922]
Stock Position:  0.005699215460977422
Bond Position:  [-1.48141316]


portfolio before change:  [-0.90960654]
curr_Stock_Price:  100.34700608796301
curr_Factors:  [100.34700609]
mat_Sqrt:  [[0.15]]
grads:  [-0.05227094]
Stock Position:  -0.052270940657118195
Bond Position:  [4.33562586]


portfolio before change:  [-0.91627862]
curr_Stock_Price:  100.47983436723727
curr_Factors:  [100.47983437]
mat_Sqrt:  [[0.15]]
grads:  [0.0505996]
Stock Position:  0.05059959558293624
Bond Position:  [-6.0005176]


portfolio before change:  [-0.91888609]
curr_Stock_Price:  100.43571485185274
curr_Factors:  [100.43571485]
mat_Sqrt:  [[0.15]]
grads:  [0.08238411]
Stock Position:  0.0823841131385234
Bond Position:  [-9.19319339]


portfolio before change:  [-0.88811722]
curr_Stock_Price:  100.81617005498182
curr_Factors:  [100.81617005]
mat_Sqrt:  [[0.15]]
grads:  [0.06333684]
Stock Position:  0.06333683861477353
Bond Position:  [-7.27349471]


portfolio before change:  [-0.88077784]
curr_Stock_Price:  100.93922618362467
curr_Factors:  [100.93922618]
mat_Sqrt:  [[0.15]]
grads:  [0.03451435]
Stock Position:  0.03451435164697432
Bond Position:  [-4.36462979]


portfolio before change:  [-0.88484054]
curr_Stock_Price:  100.82941966307136
curr_Factors:  [100.82941966]
mat_Sqrt:  [[0.15]]
grads:  [0.06938769]
Stock Position:  0.069387688284174
Bond Position:  [-7.88116088]


portfolio before change:  [-0.92385378]
curr_Stock_Price:  100.27426860350161
curr_Factors:  [100.2742686]
mat_Sqrt:  [[0.15]]
grads:  [-0.14268322]
Stock Position:  -0.14268322421083593
Bond Position:  [13.38360217]


portfolio before change:  [-0.84912967]
curr_Stock_Price:  99.75642490601763
curr_Factors:  [99.75642491]
mat_Sqrt:  [[0.15]]
grads:  [0.02215401]
Stock Position:  0.022154009623735604
Bond Position:  [-3.05913447]


portfolio before change:  [-0.84166508]
curr_Stock_Price:  100.10199635196881
curr_Factors:  [100.10199635]
mat_Sqrt:  [[0.15]]
grads:  [-0.37971707]
Stock Position:  -0.3797170723608582
Bond Position:  [37.16877192]


portfolio before change:  [-0.94671589]
curr_Stock_Price:  100.38476987127086
curr_Factors:  [100.38476987]
mat_Sqrt:  [[0.15]]
grads:  [0.07839598]
Stock Position:  0.07839598334375228
Bond Position:  [-8.81647864]


portfolio before change:  [-0.95666715]
curr_Stock_Price:  100.26486298824918
curr_Factors:  [100.26486299]
mat_Sqrt:  [[0.15]]
grads:  [0.04644417]
Stock Position:  0.04644416628493301
Bond Position:  [-5.61338512]


portfolio before change:  [-0.9635815]
curr_Stock_Price:  100.12354272564693
curr_Factors:  [100.12354273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01020076]
Stock Position:  -0.010200764440797655
Bond Position:  [0.05775517]


portfolio before change:  [-0.96085407]
curr_Stock_Price:  99.85652107787206
curr_Factors:  [99.85652108]
mat_Sqrt:  [[0.15]]
grads:  [-0.00988961]
Stock Position:  -0.009889606002505654
Bond Position:  [0.02668758]


portfolio before change:  [-0.96201039]
curr_Stock_Price:  99.97361228462756
curr_Factors:  [99.97361228]
mat_Sqrt:  [[0.15]]
grads:  [-0.02070732]
Stock Position:  -0.02070732025459435
Bond Position:  [1.10817522]


portfolio before change:  [-0.95886349]
curr_Stock_Price:  99.82498675487562
curr_Factors:  [99.82498675]
mat_Sqrt:  [[0.15]]
grads:  [0.14560891]
Stock Position:  0.1456089095522078
Bond Position:  [-15.49427095]


portfolio before change:  [-0.84283605]
curr_Stock_Price:  100.62848058623042
curr_Factors:  [100.62848059]
mat_Sqrt:  [[0.15]]
grads:  [0.09775349]
Stock Position:  0.09775349493670281
Bond Position:  [-10.67962172]


portfolio before change:  [-0.78169928]
curr_Stock_Price:  101.26072663620698
curr_Factors:  [101.26072664]
mat_Sqrt:  [[0.15]]
grads:  [0.07144983]
Stock Position:  0.07144982735556872
Bond Position:  [-8.01676072]


portfolio before change:  [-0.8034238]
curr_Stock_Price:  100.96368670239616
curr_Factors:  [100.9636867]
mat_Sqrt:  [[0.15]]
grads:  [0.02265682]
Stock Position:  0.022656816749044413
Bond Position:  [-3.09093955]


portfolio before change:  [-0.7846325]
curr_Stock_Price:  101.80160162042347
curr_Factors:  [101.80160162]
mat_Sqrt:  [[0.15]]
grads:  [0.10132774]
Stock Position:  0.10132774311238271
Bond Position:  [-11.09995904]


portfolio before change:  [-0.85202194]
curr_Stock_Price:  101.14338436221597
curr_Factors:  [101.14338436]
mat_Sqrt:  [[0.15]]
grads:  [-0.00912498]
Stock Position:  -0.009124979582066862
Bond Position:  [0.07090937]


portfolio before change:  [-0.86237541]
curr_Stock_Price:  102.27849916923881
curr_Factors:  [102.27849917]
mat_Sqrt:  [[0.15]]
grads:  [0.13488873]
Stock Position:  0.13488873382862646
Bond Position:  [-14.65859266]


portfolio before change:  [-0.88967606]
curr_Stock_Price:  102.08289749495303
curr_Factors:  [102.08289749]
mat_Sqrt:  [[0.15]]
grads:  [-0.08393956]
Stock Position:  -0.0839395583613535
Bond Position:  [7.67911727]


portfolio before change:  [-0.84442924]
curr_Stock_Price:  101.54957494507408
curr_Factors:  [101.54957495]
mat_Sqrt:  [[0.15]]
grads:  [0.0101977]
Stock Position:  0.010197697354858292
Bond Position:  [-1.88000108]


portfolio before change:  [-0.84509457]
curr_Stock_Price:  101.49585489566985
curr_Factors:  [101.4958549]
mat_Sqrt:  [[0.15]]
grads:  [-0.00974982]
Stock Position:  -0.009749815562500829
Bond Position:  [0.1444713]


portfolio before change:  [-0.83221534]
curr_Stock_Price:  100.17581001287869
curr_Factors:  [100.17581001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02858863]
Stock Position:  -0.028588629162238123
Bond Position:  [2.03167374]


portfolio before change:  [-0.82348725]
curr_Stock_Price:  99.87495207685403
curr_Factors:  [99.87495208]
mat_Sqrt:  [[0.15]]
grads:  [-0.0286455]
Stock Position:  -0.028645504946586693
Bond Position:  [2.03748119]


portfolio before change:  [-0.8287969]
curr_Stock_Price:  100.06475518766662
curr_Factors:  [100.06475519]
mat_Sqrt:  [[0.15]]
grads:  [0.03831805]
Stock Position:  0.038318053410446876
Bond Position:  [-4.66308354]


portfolio before change:  [-0.82839021]
curr_Stock_Price:  100.0829749744505
curr_Factors:  [100.08297497]
mat_Sqrt:  [[0.15]]
grads:  [0.02253232]
Stock Position:  0.022532320692723644
Bond Position:  [-3.0834919]


portfolio before change:  [-0.80940007]
curr_Stock_Price:  100.93432385795774
curr_Factors:  [100.93432386]
mat_Sqrt:  [[0.15]]
grads:  [0.04625021]
Stock Position:  0.046250208626948335
Bond Position:  [-5.4776336]


portfolio before change:  [-0.82357325]
curr_Stock_Price:  100.63528044849656
curr_Factors:  [100.63528045]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676564]
Stock Position:  -0.026765639965788183
Bond Position:  [1.86999443]


portfolio before change:  [-0.85674]
curr_Stock_Price:  101.87880132232858
curr_Factors:  [101.87880132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01382535]
Stock Position:  -0.013825352431016723
Bond Position:  [0.55177033]


portfolio before change:  [-0.86796905]
curr_Stock_Price:  102.69350275528086
curr_Factors:  [102.69350276]
mat_Sqrt:  [[0.15]]
grads:  [0.05205643]
Stock Position:  0.05205642972725701
Bond Position:  [-6.21382616]


portfolio before change:  [-0.87195748]
curr_Stock_Price:  102.62434604705416
curr_Factors:  [102.62434605]
mat_Sqrt:  [[0.15]]
grads:  [-0.11956281]
Stock Position:  -0.11956281467802223
Bond Position:  [11.39809819]


portfolio before change:  [-0.80442632]
curr_Stock_Price:  102.06548700672418
curr_Factors:  [102.06548701]
mat_Sqrt:  [[0.15]]
grads:  [0.03105725]
Stock Position:  0.031057251957262753
Bond Position:  [-3.97429986]


portfolio before change:  [-0.82298144]
curr_Stock_Price:  101.47603623031442
curr_Factors:  [101.47603623]
mat_Sqrt:  [[0.15]]
grads:  [0.16992974]
Stock Position:  0.1699297419593088
Bond Position:  [-18.06677809]


portfolio before change:  [-0.82992842]
curr_Stock_Price:  101.44179987403167
curr_Factors:  [101.44179987]
mat_Sqrt:  [[0.15]]
grads:  [0.0362148]
Stock Position:  0.03621480044678252
Bond Position:  [-4.50362296]


portfolio before change:  [-0.85548788]
curr_Stock_Price:  100.74379873370366
curr_Factors:  [100.74379873]
mat_Sqrt:  [[0.15]]
grads:  [0.0635645]
Stock Position:  0.0635644980776844
Bond Position:  [-7.25921688]


portfolio before change:  [-0.78602968]
curr_Stock_Price:  101.84365667904619
curr_Factors:  [101.84365668]
mat_Sqrt:  [[0.15]]
grads:  [0.02971003]
Stock Position:  0.02971002817279201
Bond Position:  [-3.81180759]


portfolio before change:  [-0.76545018]
curr_Stock_Price:  102.54435435551973
curr_Factors:  [102.54435436]
mat_Sqrt:  [[0.15]]
grads:  [0.03016148]
Stock Position:  0.030161483644738942
Bond Position:  [-3.85834004]


portfolio before change:  [-0.80844797]
curr_Stock_Price:  101.12676373823645
curr_Factors:  [101.12676374]
mat_Sqrt:  [[0.15]]
grads:  [0.13289487]
Stock Position:  0.1328948653542267
Bond Position:  [-14.24767562]


portfolio before change:  [-0.84087873]
curr_Stock_Price:  100.88943134962761
curr_Factors:  [100.88943135]
mat_Sqrt:  [[0.15]]
grads:  [0.00220657]
Stock Position:  0.0022065683116065443
Bond Position:  [-1.06349815]


portfolio before change:  [-0.84130255]
curr_Stock_Price:  100.72748420119578
curr_Factors:  [100.7274842]
mat_Sqrt:  [[0.15]]
grads:  [-0.10637345]
Stock Position:  -0.10637344994193138
Bond Position:  [9.87342745]


portfolio before change:  [-0.91285439]
curr_Stock_Price:  101.40593312724926
curr_Factors:  [101.40593313]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176507]
Stock Position:  -0.001765073427394103
Bond Position:  [-0.73386547]


portfolio before change:  [-0.91398679]
curr_Stock_Price:  102.02150679711256
curr_Factors:  [102.0215068]
mat_Sqrt:  [[0.15]]
grads:  [0.00863131]
Stock Position:  0.008631306792269247
Bond Position:  [-1.79456572]


portfolio before change:  [-0.91885523]
curr_Stock_Price:  101.47045709662912
curr_Factors:  [101.4704571]
mat_Sqrt:  [[0.15]]
grads:  [0.00688142]
Stock Position:  0.00688141900962526
Bond Position:  [-1.61711597]


portfolio before change:  [-0.92191225]
curr_Stock_Price:  101.04090290242523
curr_Factors:  [101.0409029]
mat_Sqrt:  [[0.15]]
grads:  [-0.07571337]
Stock Position:  -0.0757133666383223
Bond Position:  [6.72823468]


portfolio before change:  [-0.96251116]
curr_Stock_Price:  101.58267569504962
curr_Factors:  [101.5826757]
mat_Sqrt:  [[0.15]]
grads:  [-0.02830963]
Stock Position:  -0.028309631331276796
Bond Position:  [1.91325693]


portfolio before change:  [-0.9507319]
curr_Stock_Price:  101.1708131145489
curr_Factors:  [101.17081311]
mat_Sqrt:  [[0.15]]
grads:  [0.10661817]
Stock Position:  0.10661816748369485
Bond Position:  [-11.7373786]


portfolio before change:  [-1.00691648]
curr_Stock_Price:  100.65072383588777
curr_Factors:  [100.65072384]
mat_Sqrt:  [[0.15]]
grads:  [-0.10842151]
Stock Position:  -0.10842150584211194
Bond Position:  [9.90578656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.09065187]
Stock Price:  101.42874771232944
PL:  [-2.51939958]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-5.41438034e-03]
 [ 4.31859816e-02]
 [ 2.03964824e-02]
 [-3.24553061e-02]
 [-4.08275230e-02]
 [-1.23856228e-03]
 [ 7.96397705e-03]
 [-2.82008109e-02]
 [ 1.10747600e-02]
 [-4.00762070e-03]
 [-9.81283730e-03]
 [ 1.66937249e-02]
 [-4.11193947e-03]
 [ 4.10693679e-03]
 [-1.23191195e-03]
 [ 1.57657113e-02]
 [ 8.37305649e-02]
 [-1.41588169e-02]
 [ 2.03395950e-02]
 [ 1.38808845e-03]
 [-4.55620414e-03]
 [ 4.98331070e-03]
 [ 1.25917839e-02]
 [ 3.16087292e-02]
 [ 2.27884126e-03]
 [ 7.04207922e-03]
 [ 6.79958232e-02]
 [ 3.00138223e-02]
 [-5.03959202e-03]
 [-8.24236050e-03]
 [ 5.73973045e-03]
 [ 1.52910423e-02]
 [ 1.42519390e-02]
 [-3.91549435e-03]
 [ 4.71167603e-03]
 [ 2.59268545e-03]
 [-1.99939713e-02]
 [-4.65320686e-03]
 [-1.66193204e-02]
 [-1.61666645e-02]
 [ 3.70855305e-03]
 [ 8.31542924e-03]
 [-7.49546880e-03]
 [ 1.67767924e-03]
 [ 9.82593103e-03]
 [ 1.20399717e-02]
 [ 1.05917726e-02]
 [-1.39830731e-04]
 [ 1.63191065e-02]
 [-1.18617699e-03]
 [ 1.68069449e-02]
 [-1.76563483e-02]
 [ 1.21516036e-03]
 [-3.22584374e-03]
 [-2.45950363e-03]
 [-3.24711690e-03]
 [ 1.06180321e-02]
 [-7.28069424e-03]
 [ 6.34092623e-03]
 [-3.91385685e-03]
 [-2.38012574e-03]
 [ 6.79971715e-03]
 [-1.07786632e-02]
 [ 6.39137842e-03]
 [ 2.52539216e-02]
 [ 5.43403291e-03]
 [ 1.28889854e-02]
 [ 2.17714149e-03]
 [ 2.80762952e-03]
 [ 2.04403599e-02]
 [ 7.11671156e-04]
 [-1.59245497e-02]
 [-4.36631141e-03]
 [ 1.22701806e-03]
 [ 5.96731486e-03]
 [-8.26796643e-04]
 [-1.41514654e-03]
 [ 6.49705174e-03]
 [-2.55332098e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.45102737]
curr_Stock_Price:  100.74581343003901
curr_Factors:  [100.74581343]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609587]
Stock Position:  -0.036095868958813705
Bond Position:  [22.08753505]


portfolio before change:  [18.43954195]
curr_Stock_Price:  101.10225145643281
curr_Factors:  [101.10225146]
mat_Sqrt:  [[0.15]]
grads:  [0.28790654]
Stock Position:  0.2879065440982295
Bond Position:  [-10.66845787]


portfolio before change:  [18.39294729]
curr_Stock_Price:  100.94272795539278
curr_Factors:  [100.94272796]
mat_Sqrt:  [[0.15]]
grads:  [0.13597655]
Stock Position:  0.1359765493965606
Bond Position:  [4.66710345]


portfolio before change:  [18.48459951]
curr_Stock_Price:  101.61461235013917
curr_Factors:  [101.61461235]
mat_Sqrt:  [[0.15]]
grads:  [-0.21636871]
Stock Position:  -0.2163687076443549
Bond Position:  [40.47082186]


portfolio before change:  [18.46260825]
curr_Stock_Price:  101.72794095167988
curr_Factors:  [101.72794095]
mat_Sqrt:  [[0.15]]
grads:  [-0.27218349]
Stock Position:  -0.2721834867527837
Bond Position:  [46.15127392]


portfolio before change:  [18.51950916]
curr_Stock_Price:  101.52948525888512
curr_Factors:  [101.52948526]
mat_Sqrt:  [[0.15]]
grads:  [-0.00825708]
Stock Position:  -0.008257081851040678
Bond Position:  [19.35784643]


portfolio before change:  [18.51649032]
curr_Stock_Price:  102.04162124751507
curr_Factors:  [102.04162125]
mat_Sqrt:  [[0.15]]
grads:  [0.05309318]
Stock Position:  0.05309318033994751
Bond Position:  [13.09877612]


portfolio before change:  [18.46193779]
curr_Stock_Price:  100.99871477779473
curr_Factors:  [100.99871478]
mat_Sqrt:  [[0.15]]
grads:  [-0.18800541]
Stock Position:  -0.18800540587319503
Bond Position:  [37.45024216]


portfolio before change:  [18.43506713]
curr_Stock_Price:  101.15408997854067
curr_Factors:  [101.15408998]
mat_Sqrt:  [[0.15]]
grads:  [0.07383173]
Stock Position:  0.07383173318328005
Bond Position:  [10.96668535]


portfolio before change:  [18.45753923]
curr_Stock_Price:  101.44917536046108
curr_Factors:  [101.44917536]
mat_Sqrt:  [[0.15]]
grads:  [-0.02671747]
Stock Position:  -0.026717471338457838
Bond Position:  [21.16800467]


portfolio before change:  [18.44764396]
curr_Stock_Price:  101.86906240305731
curr_Factors:  [101.8690624]
mat_Sqrt:  [[0.15]]
grads:  [-0.06541892]
Stock Position:  -0.06541891532054384
Bond Position:  [25.11180752]


portfolio before change:  [18.45228293]
curr_Stock_Price:  101.82214272797692
curr_Factors:  [101.82214273]
mat_Sqrt:  [[0.15]]
grads:  [0.1112915]
Stock Position:  0.11129149933054949
Bond Position:  [7.120344]


portfolio before change:  [18.47932866]
curr_Stock_Price:  102.06116093576314
curr_Factors:  [102.06116094]
mat_Sqrt:  [[0.15]]
grads:  [-0.02741293]
Stock Position:  -0.02741292981881859
Bond Position:  [21.2771241]


portfolio before change:  [18.48978451]
curr_Stock_Price:  101.72825276454826
curr_Factors:  [101.72825276]
mat_Sqrt:  [[0.15]]
grads:  [0.02737958]
Stock Position:  0.02737957860651922
Bond Position:  [15.70450781]


portfolio before change:  [18.46952563]
curr_Stock_Price:  100.95247597180949
curr_Factors:  [100.95247597]
mat_Sqrt:  [[0.15]]
grads:  [-0.00821275]
Stock Position:  -0.008212746356481698
Bond Position:  [19.29862271]


portfolio before change:  [18.472105]
curr_Stock_Price:  100.78527586460208
curr_Factors:  [100.78527586]
mat_Sqrt:  [[0.15]]
grads:  [0.10510474]
Stock Position:  0.10510474177212811
Bond Position:  [7.87909461]


portfolio before change:  [18.57768457]
curr_Stock_Price:  101.78510809929374
curr_Factors:  [101.7851081]
mat_Sqrt:  [[0.15]]
grads:  [0.55820377]
Stock Position:  0.5582037663207583
Bond Position:  [-38.23914613]


portfolio before change:  [18.22810295]
curr_Stock_Price:  101.16312805896024
curr_Factors:  [101.16312806]
mat_Sqrt:  [[0.15]]
grads:  [-0.09439211]
Stock Position:  -0.09439211256365618
Bond Position:  [27.77710432]


portfolio before change:  [18.15143263]
curr_Stock_Price:  101.99377416223903
curr_Factors:  [101.99377416]
mat_Sqrt:  [[0.15]]
grads:  [0.1355973]
Stock Position:  0.13559730032896505
Bond Position:  [4.3213522]


portfolio before change:  [18.09764121]
curr_Stock_Price:  101.59508249644637
curr_Factors:  [101.5950825]
mat_Sqrt:  [[0.15]]
grads:  [0.00925392]
Stock Position:  0.009253922983663313
Bond Position:  [17.15748814]


portfolio before change:  [18.09943872]
curr_Stock_Price:  101.67344217287499
curr_Factors:  [101.67344217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03037469]
Stock Position:  -0.03037469426665261
Bond Position:  [21.18773844]


portfolio before change:  [18.09258783]
curr_Stock_Price:  101.94258626987636
curr_Factors:  [101.94258627]
mat_Sqrt:  [[0.15]]
grads:  [0.03322207]
Stock Position:  0.0332220713488989
Bond Position:  [14.70584395]


portfolio before change:  [18.08142678]
curr_Stock_Price:  101.57896687368823
curr_Factors:  [101.57896687]
mat_Sqrt:  [[0.15]]
grads:  [0.08394523]
Stock Position:  0.08394522582859389
Bond Position:  [9.55435747]


portfolio before change:  [18.13936766]
curr_Stock_Price:  102.26207552871006
curr_Factors:  [102.26207553]
mat_Sqrt:  [[0.15]]
grads:  [0.21072486]
Stock Position:  0.21072486126658307
Bond Position:  [-3.40979402]


portfolio before change:  [18.24379014]
curr_Stock_Price:  102.75862632853105
curr_Factors:  [102.75862633]
mat_Sqrt:  [[0.15]]
grads:  [0.01519228]
Stock Position:  0.015192275078393496
Bond Position:  [16.68265282]


portfolio before change:  [18.26169403]
curr_Stock_Price:  103.86847952325499
curr_Factors:  [103.86847952]
mat_Sqrt:  [[0.15]]
grads:  [0.04694719]
Stock Position:  0.04694719482354067
Bond Position:  [13.38536028]


portfolio before change:  [18.29114794]
curr_Stock_Price:  104.47804306555847
curr_Factors:  [104.47804307]
mat_Sqrt:  [[0.15]]
grads:  [0.45330549]
Stock Position:  0.4533054882057506
Bond Position:  [-29.06932238]


portfolio before change:  [18.2799293]
curr_Stock_Price:  104.45730263739547
curr_Factors:  [104.45730264]
mat_Sqrt:  [[0.15]]
grads:  [0.20009215]
Stock Position:  0.2000921485473758
Bond Position:  [-2.62115682]


portfolio before change:  [18.48557037]
curr_Stock_Price:  105.48585321100845
curr_Factors:  [105.48585321]
mat_Sqrt:  [[0.15]]
grads:  [-0.03359728]
Stock Position:  -0.03359728016185963
Bond Position:  [22.02960813]


portfolio before change:  [18.48758513]
curr_Stock_Price:  105.46686752975447
curr_Factors:  [105.46686753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05494907]
Stock Position:  -0.05494906997909247
Bond Position:  [24.28289141]


portfolio before change:  [18.52121081]
curr_Stock_Price:  104.88254552950983
curr_Factors:  [104.88254553]
mat_Sqrt:  [[0.15]]
grads:  [0.03826487]
Stock Position:  0.03826486967456627
Bond Position:  [14.50789387]


portfolio before change:  [18.50329062]
curr_Stock_Price:  104.39052882917362
curr_Factors:  [104.39052883]
mat_Sqrt:  [[0.15]]
grads:  [0.10194028]
Stock Position:  0.10194028219792263
Bond Position:  [7.86169065]


portfolio before change:  [18.37682118]
curr_Stock_Price:  103.14508582719643
curr_Factors:  [103.14508583]
mat_Sqrt:  [[0.15]]
grads:  [0.09501293]
Stock Position:  0.09501292693379756
Bond Position:  [8.57670468]


portfolio before change:  [18.37660591]
curr_Stock_Price:  103.1371781799632
curr_Factors:  [103.13717818]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261033]
Stock Position:  -0.026103295665141416
Bond Position:  [21.06882617]


portfolio before change:  [18.37088881]
curr_Stock_Price:  103.40664402656435
curr_Factors:  [103.40664403]
mat_Sqrt:  [[0.15]]
grads:  [0.03141117]
Stock Position:  0.031411173546145095
Bond Position:  [15.12276477]


portfolio before change:  [18.36931793]
curr_Stock_Price:  103.32654249562393
curr_Factors:  [103.3265425]
mat_Sqrt:  [[0.15]]
grads:  [0.01728457]
Stock Position:  0.017284569643170232
Bond Position:  [16.58336311]


portfolio before change:  [18.35968643]
curr_Stock_Price:  102.70934522831942
curr_Factors:  [102.70934523]
mat_Sqrt:  [[0.15]]
grads:  [-0.13329314]
Stock Position:  -0.13329314194737069
Bond Position:  [32.05013777]


portfolio before change:  [18.3490325]
curr_Stock_Price:  102.80430229175522
curr_Factors:  [102.80430229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03102138]
Stock Position:  -0.031021379087824794
Bond Position:  [21.53816374]


portfolio before change:  [18.33012955]
curr_Stock_Price:  103.45705001747032
curr_Factors:  [103.45705002]
mat_Sqrt:  [[0.15]]
grads:  [-0.11079547]
Stock Position:  -0.11079546918774041
Bond Position:  [29.79270194]


portfolio before change:  [18.36165458]
curr_Stock_Price:  103.18932309478721
curr_Factors:  [103.18932309]
mat_Sqrt:  [[0.15]]
grads:  [-0.10777776]
Stock Position:  -0.10777776323368389
Bond Position:  [29.48316901]


portfolio before change:  [18.33761924]
curr_Stock_Price:  103.4294291369403
curr_Factors:  [103.42942914]
mat_Sqrt:  [[0.15]]
grads:  [0.02472369]
Stock Position:  0.024723687014772483
Bond Position:  [15.78046241]


portfolio before change:  [18.34404299]
curr_Stock_Price:  103.64935730401773
curr_Factors:  [103.6493573]
mat_Sqrt:  [[0.15]]
grads:  [0.05543619]
Stock Position:  0.05543619496024091
Bond Position:  [12.59811701]


portfolio before change:  [18.28664714]
curr_Stock_Price:  102.59980380527816
curr_Factors:  [102.59980381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04996979]
Stock Position:  -0.04996979198689168
Bond Position:  [23.413538]


portfolio before change:  [18.26416428]
curr_Stock_Price:  103.07901847587989
curr_Factors:  [103.07901848]
mat_Sqrt:  [[0.15]]
grads:  [0.01118453]
Stock Position:  0.011184528282693392
Bond Position:  [17.11127408]


portfolio before change:  [18.25784854]
curr_Stock_Price:  102.4187113538856
curr_Factors:  [102.41871135]
mat_Sqrt:  [[0.15]]
grads:  [0.06550621]
Stock Position:  0.06550620687967383
Bond Position:  [11.54878725]


portfolio before change:  [18.29448063]
curr_Stock_Price:  102.96690777901291
curr_Factors:  [102.96690778]
mat_Sqrt:  [[0.15]]
grads:  [0.08026648]
Stock Position:  0.080266477784606
Bond Position:  [10.02968961]


portfolio before change:  [18.24094678]
curr_Stock_Price:  102.29214633774237
curr_Factors:  [102.29214634]
mat_Sqrt:  [[0.15]]
grads:  [0.07061182]
Stock Position:  0.07061181744642578
Bond Position:  [11.01791242]


portfolio before change:  [18.2386664]
curr_Stock_Price:  102.25009925708564
curr_Factors:  [102.25009926]
mat_Sqrt:  [[0.15]]
grads:  [-0.0009322]
Stock Position:  -0.0009322048758457447
Bond Position:  [18.33398444]


portfolio before change:  [18.2399872]
curr_Stock_Price:  102.06249218183136
curr_Factors:  [102.06249218]
mat_Sqrt:  [[0.15]]
grads:  [0.10879404]
Stock Position:  0.10879404350407301
Bond Position:  [7.13619599]


portfolio before change:  [18.22505595]
curr_Stock_Price:  101.9211492083131
curr_Factors:  [101.92114921]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790785]
Stock Position:  -0.00790784657015513
Bond Position:  [19.03103276]


portfolio before change:  [18.22636958]
curr_Stock_Price:  101.90544960715124
curr_Factors:  [101.90544961]
mat_Sqrt:  [[0.15]]
grads:  [0.1120463]
Stock Position:  0.11204629959882707
Bond Position:  [6.80824104]


portfolio before change:  [18.17534883]
curr_Stock_Price:  101.44629761284452
curr_Factors:  [101.44629761]
mat_Sqrt:  [[0.15]]
grads:  [-0.11770899]
Stock Position:  -0.11770898869427
Bond Position:  [30.11648992]


portfolio before change:  [18.13941992]
curr_Stock_Price:  101.76752411807342
curr_Factors:  [101.76752412]
mat_Sqrt:  [[0.15]]
grads:  [0.00810107]
Stock Position:  0.008101069041815546
Bond Position:  [17.31499418]


portfolio before change:  [18.13989556]
curr_Stock_Price:  101.69264808040906
curr_Factors:  [101.69264808]
mat_Sqrt:  [[0.15]]
grads:  [-0.02150562]
Stock Position:  -0.021505624900004287
Bond Position:  [20.32685951]


portfolio before change:  [18.12879822]
curr_Stock_Price:  102.26774464925414
curr_Factors:  [102.26774465]
mat_Sqrt:  [[0.15]]
grads:  [-0.01639669]
Stock Position:  -0.0163966908503752
Bond Position:  [19.80565081]


portfolio before change:  [18.12843935]
curr_Stock_Price:  102.36512808724588
curr_Factors:  [102.36512809]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164745]
Stock Position:  -0.021647446003332477
Bond Position:  [20.34438293]


portfolio before change:  [18.13162724]
curr_Stock_Price:  102.27660337875476
curr_Factors:  [102.27660338]
mat_Sqrt:  [[0.15]]
grads:  [0.07078688]
Stock Position:  0.07078688085918483
Bond Position:  [10.89178551]


portfolio before change:  [18.12278181]
curr_Stock_Price:  102.14202775707928
curr_Factors:  [102.14202776]
mat_Sqrt:  [[0.15]]
grads:  [-0.04853796]
Stock Position:  -0.0485379616325253
Bond Position:  [23.08054764]


portfolio before change:  [18.12818019]
curr_Stock_Price:  102.06052872520523
curr_Factors:  [102.06052873]
mat_Sqrt:  [[0.15]]
grads:  [0.04227284]
Stock Position:  0.04227284150417548
Bond Position:  [13.81379163]


portfolio before change:  [18.14207967]
curr_Stock_Price:  102.36890864160375
curr_Factors:  [102.36890864]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609238]
Stock Position:  -0.02609237898451596
Bond Position:  [20.81312803]


portfolio before change:  [18.14733782]
curr_Stock_Price:  102.21724425725913
curr_Factors:  [102.21724426]
mat_Sqrt:  [[0.15]]
grads:  [-0.0158675]
Stock Position:  -0.015867504962300424
Bond Position:  [19.76927045]


portfolio before change:  [18.1688651]
curr_Stock_Price:  100.93842529468199
curr_Factors:  [100.93842529]
mat_Sqrt:  [[0.15]]
grads:  [0.04533145]
Stock Position:  0.04533144766074231
Bond Position:  [13.59318016]


portfolio before change:  [18.17849109]
curr_Stock_Price:  101.13203012649359
curr_Factors:  [101.13203013]
mat_Sqrt:  [[0.15]]
grads:  [-0.07185775]
Stock Position:  -0.07185775434191549
Bond Position:  [25.44561167]


portfolio before change:  [18.16207619]
curr_Stock_Price:  101.38259885287509
curr_Factors:  [101.38259885]
mat_Sqrt:  [[0.15]]
grads:  [0.04260919]
Stock Position:  0.04260918944816459
Bond Position:  [13.84224582]


portfolio before change:  [18.14036271]
curr_Stock_Price:  100.85269802263316
curr_Factors:  [100.85269802]
mat_Sqrt:  [[0.15]]
grads:  [0.16835948]
Stock Position:  0.16835947710195215
Bond Position:  [1.1608552]


portfolio before change:  [18.23851945]
curr_Stock_Price:  101.4352858973777
curr_Factors:  [101.4352859]
mat_Sqrt:  [[0.15]]
grads:  [0.03622689]
Stock Position:  0.036226886046595186
Bond Position:  [14.56383491]


portfolio before change:  [18.24752884]
curr_Stock_Price:  101.65885247213046
curr_Factors:  [101.65885247]
mat_Sqrt:  [[0.15]]
grads:  [0.08592657]
Stock Position:  0.08592656962910233
Bond Position:  [9.51233238]


portfolio before change:  [18.21461678]
curr_Stock_Price:  101.26890786286788
curr_Factors:  [101.26890786]
mat_Sqrt:  [[0.15]]
grads:  [0.01451428]
Stock Position:  0.014514276598557984
Bond Position:  [16.74477184]


portfolio before change:  [18.21187314]
curr_Stock_Price:  101.0077707940593
curr_Factors:  [101.00777079]
mat_Sqrt:  [[0.15]]
grads:  [0.01871753]
Stock Position:  0.018717530159948502
Bond Position:  [16.32125715]


portfolio before change:  [18.20371187]
curr_Stock_Price:  100.51724743668309
curr_Factors:  [100.51724744]
mat_Sqrt:  [[0.15]]
grads:  [0.13626907]
Stock Position:  0.13626906629478416
Bond Position:  [4.50632041]


portfolio before change:  [18.15620769]
curr_Stock_Price:  100.16657476444017
curr_Factors:  [100.16657476]
mat_Sqrt:  [[0.15]]
grads:  [0.00474447]
Stock Position:  0.004744474374975243
Bond Position:  [17.68096994]


portfolio before change:  [18.1519442]
curr_Stock_Price:  99.03503150139947
curr_Factors:  [99.0350315]
mat_Sqrt:  [[0.15]]
grads:  [-0.10616366]
Stock Position:  -0.10616366488972628
Bond Position:  [28.6658661]


portfolio before change:  [18.08169772]
curr_Stock_Price:  99.7135890501561
curr_Factors:  [99.71358905]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910874]
Stock Position:  -0.029108742720000427
Bond Position:  [20.98423493]


portfolio before change:  [18.08192288]
curr_Stock_Price:  99.75091083967634
curr_Factors:  [99.75091084]
mat_Sqrt:  [[0.15]]
grads:  [0.00818012]
Stock Position:  0.008180120385762052
Bond Position:  [17.26594843]


portfolio before change:  [18.07212914]
curr_Stock_Price:  98.42172463166504
curr_Factors:  [98.42172463]
mat_Sqrt:  [[0.15]]
grads:  [0.0397821]
Stock Position:  0.039782099057156066
Bond Position:  [14.15670634]


portfolio before change:  [18.10370132]
curr_Stock_Price:  99.19311087357221
curr_Factors:  [99.19311087]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551198]
Stock Position:  -0.005511977617249364
Bond Position:  [18.65045153]


portfolio before change:  [18.10624697]
curr_Stock_Price:  98.94275516964375
curr_Factors:  [98.94275517]
mat_Sqrt:  [[0.15]]
grads:  [-0.00943431]
Stock Position:  -0.009434310263675619
Bond Position:  [19.03970362]


portfolio before change:  [18.10189766]
curr_Stock_Price:  99.5299015364058
curr_Factors:  [99.52990154]
mat_Sqrt:  [[0.15]]
grads:  [0.04331368]
Stock Position:  0.04331367829069799
Bond Position:  [13.79089153]


portfolio before change:  [18.10002641]
curr_Stock_Price:  99.46679881875184
curr_Factors:  [99.46679882]
mat_Sqrt:  [[0.15]]
grads:  [-0.1702214]
Stock Position:  -0.17022139870403163
Bond Position:  [35.03140403]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.14086865]
Stock Price:  99.23972567108525
PL:  [18.14086865]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37971438e-02]
 [ 7.44782147e-03]
 [ 6.05922287e-03]
 [-6.14895572e-03]
 [ 1.09308357e-02]
 [-1.54572283e-02]
 [-1.34960622e-02]
 [ 2.42982612e-02]
 [-1.82958023e-02]
 [-1.31810253e-02]
 [ 2.75928759e-03]
 [-6.12538169e-03]
 [ 2.11777609e-03]
 [-6.95327167e-03]
 [ 4.74369823e-03]
 [ 1.45732728e-03]
 [-4.25740556e-02]
 [-1.00797682e-02]
 [ 2.24117352e-02]
 [-5.30319014e-03]
 [-3.49272472e-02]
 [ 6.39063296e-03]
 [ 1.68283073e-02]
 [ 2.61994695e-03]
 [ 2.42667831e-02]
 [ 3.46615477e-03]
 [-3.10019931e-03]
 [ 2.59473786e-02]
 [-3.24590354e-02]
 [ 1.00851513e-01]
 [-5.46584254e-03]
 [ 3.74073419e-02]
 [ 1.46291549e-02]
 [-1.89239118e-02]
 [-2.25526869e-02]
 [-1.22315622e-01]
 [ 2.44590994e-02]
 [-1.31081277e-02]
 [ 1.08530853e-01]
 [ 4.41736227e-02]
 [ 6.30492534e-03]
 [ 3.51008213e-02]
 [-3.29454024e-03]
 [ 3.90018127e-02]
 [-7.73838872e-02]
 [ 2.64096058e-02]
 [ 8.32182073e-03]
 [ 5.47738707e-03]
 [-2.12943764e-02]
 [ 5.90191872e-04]
 [ 3.16063357e-03]
 [-4.72265173e-03]
 [-2.47770452e-03]
 [-2.40242466e-03]
 [-2.41519434e-02]
 [-5.79593242e-03]
 [-6.58677747e-03]
 [ 1.48661386e-02]
 [ 5.49008229e-03]
 [-2.12254320e-03]
 [-5.16138637e-03]
 [-4.24360550e-03]
 [ 1.83852890e-03]
 [-7.38598214e-03]
 [ 1.72288377e-02]
 [ 7.52495663e-03]
 [ 2.03617714e-02]
 [-3.83348606e-03]
 [ 6.52943366e-03]
 [ 2.75843337e-02]
 [ 3.03889328e-03]
 [-1.51769328e-02]
 [-5.88025112e-03]
 [ 3.13753353e-03]
 [ 1.20636377e-02]
 [ 1.52052967e-02]
 [ 4.63709561e-03]
 [-3.06676615e-02]
 [-2.85724693e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.78576073]
curr_Stock_Price:  99.87211793626885
curr_Factors:  [99.87211794]
mat_Sqrt:  [[0.15]]
grads:  [-0.09198096]
Stock Position:  -0.09198095872100977
Bond Position:  [8.40057243]


portfolio before change:  [-0.78296739]
curr_Stock_Price:  99.84745762328576
curr_Factors:  [99.84745762]
mat_Sqrt:  [[0.15]]
grads:  [0.04965214]
Stock Position:  0.049652143134095196
Bond Position:  [-5.74060765]


portfolio before change:  [-0.79700455]
curr_Stock_Price:  99.57197385893801
curr_Factors:  [99.57197386]
mat_Sqrt:  [[0.15]]
grads:  [0.04039482]
Stock Position:  0.04039481914063841
Bond Position:  [-4.81919643]


portfolio before change:  [-0.7744877]
curr_Stock_Price:  100.13684988365381
curr_Factors:  [100.13684988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099304]
Stock Position:  -0.040993038151381715
Bond Position:  [3.33042601]


portfolio before change:  [-0.72628855]
curr_Stock_Price:  98.96613924891163
curr_Factors:  [98.96613925]
mat_Sqrt:  [[0.15]]
grads:  [0.07287224]
Stock Position:  0.07287223773441487
Bond Position:  [-7.93817258]


portfolio before change:  [-0.78107759]
curr_Stock_Price:  98.22109715947406
curr_Factors:  [98.22109716]
mat_Sqrt:  [[0.15]]
grads:  [-0.10304819]
Stock Position:  -0.10304818861979413
Bond Position:  [9.34042856]


portfolio before change:  [-0.80951403]
curr_Stock_Price:  98.50271529744354
curr_Factors:  [98.5027153]
mat_Sqrt:  [[0.15]]
grads:  [-0.08997375]
Stock Position:  -0.089973748082659
Bond Position:  [8.05314446]


portfolio before change:  [-0.82702348]
curr_Stock_Price:  98.70291572143454
curr_Factors:  [98.70291572]
mat_Sqrt:  [[0.15]]
grads:  [0.16198841]
Stock Position:  0.16198840816276217
Bond Position:  [-16.81575168]


portfolio before change:  [-0.82611663]
curr_Stock_Price:  98.71500220463422
curr_Factors:  [98.7150022]
mat_Sqrt:  [[0.15]]
grads:  [-0.12197202]
Stock Position:  -0.12197201531912938
Bond Position:  [11.21435114]


portfolio before change:  [-0.7390131]
curr_Stock_Price:  98.00662165940956
curr_Factors:  [98.00662166]
mat_Sqrt:  [[0.15]]
grads:  [-0.0878735]
Stock Position:  -0.08787350177789968
Bond Position:  [7.87317194]


portfolio before change:  [-0.6776467]
curr_Stock_Price:  97.31387226979876
curr_Factors:  [97.31387227]
mat_Sqrt:  [[0.15]]
grads:  [0.01839525]
Stock Position:  0.018395250613827026
Bond Position:  [-2.46775977]


portfolio before change:  [-0.68101846]
curr_Stock_Price:  97.13896214111229
curr_Factors:  [97.13896214]
mat_Sqrt:  [[0.15]]
grads:  [-0.04083588]
Stock Position:  -0.040835877944862466
Bond Position:  [3.28573635]


portfolio before change:  [-0.66799984]
curr_Stock_Price:  96.82518777529285
curr_Factors:  [96.82518778]
mat_Sqrt:  [[0.15]]
grads:  [0.01411851]
Stock Position:  0.014118507258565859
Bond Position:  [-2.03502696]


portfolio before change:  [-0.66604669]
curr_Stock_Price:  96.97253618800804
curr_Factors:  [96.97253619]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635514]
Stock Position:  -0.046355144437322804
Bond Position:  [3.82912923]


portfolio before change:  [-0.6658206]
curr_Stock_Price:  96.97282179001034
curr_Factors:  [96.97282179]
mat_Sqrt:  [[0.15]]
grads:  [0.03162465]
Stock Position:  0.03162465483920724
Bond Position:  [-3.73255262]


portfolio before change:  [-0.66979592]
curr_Stock_Price:  96.85449573238873
curr_Factors:  [96.85449573]
mat_Sqrt:  [[0.15]]
grads:  [0.00971552]
Stock Position:  0.009715515181396284
Bond Position:  [-1.61078724]


portfolio before change:  [-0.67377347]
curr_Stock_Price:  96.4554558264621
curr_Factors:  [96.45545583]
mat_Sqrt:  [[0.15]]
grads:  [-0.28382704]
Stock Position:  -0.2838270373768054
Bond Position:  [26.70289279]


portfolio before change:  [-0.68579402]
curr_Stock_Price:  96.50368778343342
curr_Factors:  [96.50368778]
mat_Sqrt:  [[0.15]]
grads:  [-0.06719845]
Stock Position:  -0.06719845438045752
Bond Position:  [5.79910464]


portfolio before change:  [-0.62649772]
curr_Stock_Price:  95.62667589431159
curr_Factors:  [95.62667589]
mat_Sqrt:  [[0.15]]
grads:  [0.14941157]
Stock Position:  0.14941156772866168
Bond Position:  [-14.91422929]


portfolio before change:  [-0.59592011]
curr_Stock_Price:  95.8375684108817
curr_Factors:  [95.83756841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0353546]
Stock Position:  -0.0353546009312405
Bond Position:  [2.79237887]


portfolio before change:  [-0.56267661]
curr_Stock_Price:  94.90221721195547
curr_Factors:  [94.90221721]
mat_Sqrt:  [[0.15]]
grads:  [-0.23284831]
Stock Position:  -0.23284831445084903
Bond Position:  [21.5351447]


portfolio before change:  [-0.57784887]
curr_Stock_Price:  94.97315715657732
curr_Factors:  [94.97315716]
mat_Sqrt:  [[0.15]]
grads:  [0.04260422]
Stock Position:  0.04260421975345061
Bond Position:  [-4.62410613]


portfolio before change:  [-0.58596234]
curr_Stock_Price:  94.78950264946207
curr_Factors:  [94.78950265]
mat_Sqrt:  [[0.15]]
grads:  [0.11218872]
Stock Position:  0.11218871530947298
Bond Position:  [-11.22027487]


portfolio before change:  [-0.58967627]
curr_Stock_Price:  94.76264934281038
curr_Factors:  [94.76264934]
mat_Sqrt:  [[0.15]]
grads:  [0.01746631]
Stock Position:  0.01746631299965535
Bond Position:  [-2.24483036]


portfolio before change:  [-0.60062973]
curr_Stock_Price:  94.14356287452945
curr_Factors:  [94.14356287]
mat_Sqrt:  [[0.15]]
grads:  [0.16177855]
Stock Position:  0.16177855403577104
Bond Position:  [-15.83103921]


portfolio before change:  [-0.72077065]
curr_Stock_Price:  93.40705336709344
curr_Factors:  [93.40705337]
mat_Sqrt:  [[0.15]]
grads:  [0.0231077]
Stock Position:  0.023107698498008027
Bond Position:  [-2.87919268]


portfolio before change:  [-0.71524317]
curr_Stock_Price:  93.65404597146755
curr_Factors:  [93.65404597]
mat_Sqrt:  [[0.15]]
grads:  [-0.020668]
Stock Position:  -0.020667995405295275
Bond Position:  [1.22039822]


portfolio before change:  [-0.7289278]
curr_Stock_Price:  94.31985347495049
curr_Factors:  [94.31985347]
mat_Sqrt:  [[0.15]]
grads:  [0.17298252]
Stock Position:  0.17298252408353149
Bond Position:  [-17.04461413]


portfolio before change:  [-0.75822477]
curr_Stock_Price:  94.15664826744275
curr_Factors:  [94.15664827]
mat_Sqrt:  [[0.15]]
grads:  [-0.21639357]
Stock Position:  -0.21639356904523271
Bond Position:  [19.61666839]


portfolio before change:  [-0.7821086]
curr_Stock_Price:  94.27268638403903
curr_Factors:  [94.27268638]
mat_Sqrt:  [[0.15]]
grads:  [0.67234342]
Stock Position:  0.6723434169090439
Bond Position:  [-64.16572868]


portfolio before change:  [-1.150522]
curr_Stock_Price:  93.73069711067207
curr_Factors:  [93.73069711]
mat_Sqrt:  [[0.15]]
grads:  [-0.03643895]
Stock Position:  -0.03643895028782277
Bond Position:  [2.26492621]


portfolio before change:  [-1.13224188]
curr_Stock_Price:  93.23291769026369
curr_Factors:  [93.23291769]
mat_Sqrt:  [[0.15]]
grads:  [0.24938228]
Stock Position:  0.24938227909003433
Bond Position:  [-24.38287938]


portfolio before change:  [-0.96896472]
curr_Stock_Price:  93.8937550636273
curr_Factors:  [93.89375506]
mat_Sqrt:  [[0.15]]
grads:  [0.0975277]
Stock Position:  0.0975276994771483
Bond Position:  [-10.12620665]


portfolio before change:  [-0.97166884]
curr_Stock_Price:  93.87251789113355
curr_Factors:  [93.87251789]
mat_Sqrt:  [[0.15]]
grads:  [-0.12615941]
Stock Position:  -0.12615941221676485
Bond Position:  [10.87123284]


portfolio before change:  [-0.93301674]
curr_Stock_Price:  93.57152860644982
curr_Factors:  [93.57152861]
mat_Sqrt:  [[0.15]]
grads:  [-0.15035125]
Stock Position:  -0.15035124631787372
Bond Position:  [13.13557921]


portfolio before change:  [-0.79332529]
curr_Stock_Price:  92.6478884267154
curr_Factors:  [92.64788843]
mat_Sqrt:  [[0.15]]
grads:  [-0.81543748]
Stock Position:  -0.8154374771998398
Bond Position:  [74.75523512]


portfolio before change:  [-0.6810302]
curr_Stock_Price:  92.51590682721394
curr_Factors:  [92.51590683]
mat_Sqrt:  [[0.15]]
grads:  [0.16306066]
Stock Position:  0.16306066272381128
Bond Position:  [-15.76673528]


portfolio before change:  [-0.71409966]
curr_Stock_Price:  92.31914560826668
curr_Factors:  [92.31914561]
mat_Sqrt:  [[0.15]]
grads:  [-0.08738752]
Stock Position:  -0.08738751788195909
Bond Position:  [7.35344132]


portfolio before change:  [-0.71925065]
curr_Stock_Price:  92.38334918972838
curr_Factors:  [92.38334919]
mat_Sqrt:  [[0.15]]
grads:  [0.72353902]
Stock Position:  0.7235390185435897
Bond Position:  [-67.56220845]


portfolio before change:  [-0.07890152]
curr_Stock_Price:  93.27420909849327
curr_Factors:  [93.2742091]
mat_Sqrt:  [[0.15]]
grads:  [0.29449082]
Stock Position:  0.2944908179627025
Bond Position:  [-27.54729965]


portfolio before change:  [0.18570668]
curr_Stock_Price:  94.17858348763451
curr_Factors:  [94.17858349]
mat_Sqrt:  [[0.15]]
grads:  [0.04203284]
Stock Position:  0.04203283561273014
Bond Position:  [-3.77288624]


portfolio before change:  [0.19074661]
curr_Stock_Price:  94.30409841054791
curr_Factors:  [94.30409841]
mat_Sqrt:  [[0.15]]
grads:  [0.23400548]
Stock Position:  0.23400547542455746
Bond Position:  [-21.87692877]


portfolio before change:  [0.07091526]
curr_Stock_Price:  93.79785386023221
curr_Factors:  [93.79785386]
mat_Sqrt:  [[0.15]]
grads:  [-0.0219636]
Stock Position:  -0.021963601608418745
Bond Position:  [2.13105396]


portfolio before change:  [0.08153863]
curr_Stock_Price:  93.32023787225101
curr_Factors:  [93.32023787]
mat_Sqrt:  [[0.15]]
grads:  [0.26001208]
Stock Position:  0.2600120845392417
Bond Position:  [-24.18285095]


portfolio before change:  [0.276746]
curr_Stock_Price:  94.07681368132046
curr_Factors:  [94.07681368]
mat_Sqrt:  [[0.15]]
grads:  [-0.51589258]
Stock Position:  -0.5158925813567369
Bond Position:  [48.81027626]


portfolio before change:  [0.30015638]
curr_Stock_Price:  94.03734880860992
curr_Factors:  [94.03734881]
mat_Sqrt:  [[0.15]]
grads:  [0.17606404]
Stock Position:  0.17606403839115808
Bond Position:  [-16.25643901]


portfolio before change:  [0.19414408]
curr_Stock_Price:  93.44099623332654
curr_Factors:  [93.44099623]
mat_Sqrt:  [[0.15]]
grads:  [0.0554788]
Stock Position:  0.05547880488649254
Bond Position:  [-4.98985072]


portfolio before change:  [0.17126507]
curr_Stock_Price:  93.03422591317077
curr_Factors:  [93.03422591]
mat_Sqrt:  [[0.15]]
grads:  [0.03651591]
Stock Position:  0.036515913789782736
Bond Position:  [-3.2259647]


portfolio before change:  [0.15753105]
curr_Stock_Price:  92.66363719479719
curr_Factors:  [92.66363719]
mat_Sqrt:  [[0.15]]
grads:  [-0.14196251]
Stock Position:  -0.14196250915481962
Bond Position:  [13.3122935]


portfolio before change:  [0.13836731]
curr_Stock_Price:  92.80448982466437
curr_Factors:  [92.80448982]
mat_Sqrt:  [[0.15]]
grads:  [0.00393461]
Stock Position:  0.003934612478870065
Bond Position:  [-0.2267824]


portfolio before change:  [0.13895446]
curr_Stock_Price:  92.9573215565104
curr_Factors:  [92.95732156]
mat_Sqrt:  [[0.15]]
grads:  [0.02107089]
Stock Position:  0.021070890483852932
Bond Position:  [-1.81973908]


portfolio before change:  [0.12792372]
curr_Stock_Price:  92.43921319051296
curr_Factors:  [92.43921319]
mat_Sqrt:  [[0.15]]
grads:  [-0.03148434]
Stock Position:  -0.03148434487305479
Bond Position:  [3.03831179]


portfolio before change:  [0.12726908]
curr_Stock_Price:  92.46603750074532
curr_Factors:  [92.4660375]
mat_Sqrt:  [[0.15]]
grads:  [-0.01651803]
Stock Position:  -0.016518030133429222
Bond Position:  [1.65462587]


portfolio before change:  [0.13110805]
curr_Stock_Price:  92.23988750958124
curr_Factors:  [92.23988751]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601616]
Stock Position:  -0.01601616438962663
Bond Position:  [1.60843725]


portfolio before change:  [0.12212405]
curr_Stock_Price:  92.80709713728467
curr_Factors:  [92.80709714]
mat_Sqrt:  [[0.15]]
grads:  [-0.16101296]
Stock Position:  -0.16101295606607058
Bond Position:  [15.06526911]


portfolio before change:  [0.10153381]
curr_Stock_Price:  92.94082457029008
curr_Factors:  [92.94082457]
mat_Sqrt:  [[0.15]]
grads:  [-0.03863955]
Stock Position:  -0.03863954946678904
Bond Position:  [3.6927254]


portfolio before change:  [0.07717797]
curr_Stock_Price:  93.57713241831635
curr_Factors:  [93.57713242]
mat_Sqrt:  [[0.15]]
grads:  [-0.04391185]
Stock Position:  -0.043911849828193475
Bond Position:  [4.18632295]


portfolio before change:  [0.10454126]
curr_Stock_Price:  92.9599495227162
curr_Factors:  [92.95994952]
mat_Sqrt:  [[0.15]]
grads:  [0.09910759]
Stock Position:  0.09910759056748933
Bond Position:  [-9.10849535]


portfolio before change:  [0.15529317]
curr_Stock_Price:  93.4777828049442
curr_Factors:  [93.4777828]
mat_Sqrt:  [[0.15]]
grads:  [0.03660055]
Stock Position:  0.03660054860236034
Bond Position:  [-3.26604496]


portfolio before change:  [0.14746457]
curr_Stock_Price:  93.26946712120902
curr_Factors:  [93.26946712]
mat_Sqrt:  [[0.15]]
grads:  [-0.01415029]
Stock Position:  -0.014150288012925878
Bond Position:  [1.46725439]


portfolio before change:  [0.1434148]
curr_Stock_Price:  93.56214533059122
curr_Factors:  [93.56214533]
mat_Sqrt:  [[0.15]]
grads:  [-0.03440924]
Stock Position:  -0.03440924249269974
Bond Position:  [3.36281734]


portfolio before change:  [0.14805071]
curr_Stock_Price:  93.43352502536894
curr_Factors:  [93.43352503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0282907]
Stock Position:  -0.028290703340244066
Bond Position:  [2.79135085]


portfolio before change:  [0.1443021]
curr_Stock_Price:  93.57219508547364
curr_Factors:  [93.57219509]
mat_Sqrt:  [[0.15]]
grads:  [0.01225686]
Stock Position:  0.012256859330531285
Bond Position:  [-1.00259913]


portfolio before change:  [0.14168048]
curr_Stock_Price:  93.36341753210294
curr_Factors:  [93.36341753]
mat_Sqrt:  [[0.15]]
grads:  [-0.04923988]
Stock Position:  -0.04923988093791853
Bond Position:  [4.73888404]


portfolio before change:  [0.12156093]
curr_Stock_Price:  93.77803536904119
curr_Factors:  [93.77803537]
mat_Sqrt:  [[0.15]]
grads:  [0.11485892]
Stock Position:  0.11485891803514321
Bond Position:  [-10.64968274]


portfolio before change:  [0.20522513]
curr_Stock_Price:  94.5122389207498
curr_Factors:  [94.51223892]
mat_Sqrt:  [[0.15]]
grads:  [0.05016638]
Stock Position:  0.050166377503295695
Bond Position:  [-4.53611152]


portfolio before change:  [0.21339964]
curr_Stock_Price:  94.68083836584076
curr_Factors:  [94.68083837]
mat_Sqrt:  [[0.15]]
grads:  [0.13574514]
Stock Position:  0.13574514259455278
Bond Position:  [-12.63906426]


portfolio before change:  [0.27116391]
curr_Stock_Price:  95.11219255426728
curr_Factors:  [95.11219255]
mat_Sqrt:  [[0.15]]
grads:  [-0.02555657]
Stock Position:  -0.025556573713142492
Bond Position:  [2.70190567]


portfolio before change:  [0.26046589]
curr_Stock_Price:  95.53740183028809
curr_Factors:  [95.53740183]
mat_Sqrt:  [[0.15]]
grads:  [0.04352956]
Stock Position:  0.043529557721494236
Bond Position:  [-3.89823495]


portfolio before change:  [0.23794323]
curr_Stock_Price:  95.02558835072175
curr_Factors:  [95.02558835]
mat_Sqrt:  [[0.15]]
grads:  [0.18389556]
Stock Position:  0.18389555769081053
Bond Position:  [-17.23684033]


portfolio before change:  [0.19293824]
curr_Stock_Price:  94.78671553410517
curr_Factors:  [94.78671553]
mat_Sqrt:  [[0.15]]
grads:  [0.02025929]
Stock Position:  0.02025928852343881
Bond Position:  [-1.72737317]


portfolio before change:  [0.1886571]
curr_Stock_Price:  94.58072700307821
curr_Factors:  [94.580727]
mat_Sqrt:  [[0.15]]
grads:  [-0.10117955]
Stock Position:  -0.10117955201615188
Bond Position:  [9.75829269]


portfolio before change:  [0.25785418]
curr_Stock_Price:  93.90285119531259
curr_Factors:  [93.9028512]
mat_Sqrt:  [[0.15]]
grads:  [-0.03920167]
Stock Position:  -0.039201674135065784
Bond Position:  [3.93900316]


portfolio before change:  [0.26312379]
curr_Stock_Price:  93.77470844336817
curr_Factors:  [93.77470844]
mat_Sqrt:  [[0.15]]
grads:  [0.02091689]
Stock Position:  0.02091689023318234
Bond Position:  [-1.69835149]


portfolio before change:  [0.26388713]
curr_Stock_Price:  93.81627714311162
curr_Factors:  [93.81627714]
mat_Sqrt:  [[0.15]]
grads:  [0.08042425]
Stock Position:  0.08042425152734829
Bond Position:  [-7.28121674]


portfolio before change:  [0.2408523]
curr_Stock_Price:  93.53551933984252
curr_Factors:  [93.53551934]
mat_Sqrt:  [[0.15]]
grads:  [0.10136864]
Stock Position:  0.10136864445606944
Bond Position:  [-9.2407165]


portfolio before change:  [0.19950475]
curr_Stock_Price:  93.1333241155932
curr_Factors:  [93.13332412]
mat_Sqrt:  [[0.15]]
grads:  [0.03091397]
Stock Position:  0.03091397074680201
Bond Position:  [-2.67961611]


portfolio before change:  [0.21082271]
curr_Stock_Price:  93.50485308824938
curr_Factors:  [93.50485309]
mat_Sqrt:  [[0.15]]
grads:  [-0.20445108]
Stock Position:  -0.20445107692594514
Bond Position:  [19.32799062]


portfolio before change:  [0.22775305]
curr_Stock_Price:  93.4279530156233
curr_Factors:  [93.42795302]
mat_Sqrt:  [[0.15]]
grads:  [-0.19048313]
Stock Position:  -0.19048312891404676
Bond Position:  [18.02420186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.43259217]
Stock Price:  92.35850096858242
PL:  [0.43259217]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.29355703e-02]
 [ 1.00148510e-02]
 [ 5.35422469e-03]
 [-1.22192194e-02]
 [ 1.28144021e-02]
 [-4.61901191e-03]
 [-1.02471159e-02]
 [-3.08223974e-02]
 [-2.18043209e-03]
 [-4.85035335e-03]
 [ 1.47438106e-02]
 [-2.04434579e-03]
 [-2.39207386e-03]
 [ 8.68206032e-03]
 [-2.16040545e-03]
 [ 1.27362360e-02]
 [ 3.67235382e-02]
 [-1.46783508e-02]
 [ 1.78269149e-02]
 [ 1.35199980e-03]
 [-4.35567377e-03]
 [ 4.55881332e-03]
 [ 1.67083397e-02]
 [ 1.78381701e-02]
 [-5.64074415e-03]
 [ 4.69449815e-03]
 [ 6.18646920e-03]
 [ 9.44175725e-03]
 [ 1.59599243e-02]
 [ 1.97247496e-02]
 [-6.86030846e-03]
 [ 2.04402491e-02]
 [ 1.27321392e-02]
 [-1.96743481e-02]
 [-1.22337436e-02]
 [-1.95029057e-02]
 [ 1.12376764e-02]
 [-2.08382017e-03]
 [-8.14502174e-03]
 [-8.48181910e-03]
 [ 6.96989885e-03]
 [ 3.50317804e-02]
 [-3.37180381e-03]
 [ 1.71542168e-02]
 [-4.80447842e-02]
 [ 2.25072746e-02]
 [ 9.32626839e-03]
 [ 5.39089265e-03]
 [-1.18268436e-02]
 [ 3.42783799e-04]
 [ 7.73542655e-05]
 [-4.39869457e-03]
 [-1.19549233e-03]
 [ 4.73824266e-03]
 [-1.39229212e-02]
 [-5.32992804e-03]
 [-3.76264267e-03]
 [ 1.39542326e-02]
 [ 6.51353724e-03]
 [-2.29114943e-03]
 [-5.14723897e-03]
 [-3.47797522e-03]
 [ 9.47218124e-04]
 [-6.94857029e-03]
 [ 1.72918999e-02]
 [ 7.41504784e-03]
 [ 2.03113304e-02]
 [-3.44453179e-03]
 [ 7.23782095e-03]
 [ 2.76298840e-02]
 [ 3.07182537e-03]
 [-1.51700609e-02]
 [-5.70484390e-03]
 [ 2.77404814e-03]
 [ 1.15875817e-02]
 [ 9.65547827e-03]
 [ 1.43415468e-03]
 [-2.28893386e-02]
 [-3.18578857e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.69478707]
curr_Stock_Price:  99.42207026633284
curr_Factors:  [99.42207027]
mat_Sqrt:  [[0.15]]
grads:  [-0.08623714]
Stock Position:  -0.08623713547580243
Bond Position:  [-2.12091252]


portfolio before change:  [-10.74168927]
curr_Stock_Price:  99.96440789667187
curr_Factors:  [99.9644079]
mat_Sqrt:  [[0.15]]
grads:  [0.06676567]
Stock Position:  0.06676567331617457
Bond Position:  [-17.41588027]


portfolio before change:  [-10.76366316]
curr_Stock_Price:  99.65159195397655
curr_Factors:  [99.65159195]
mat_Sqrt:  [[0.15]]
grads:  [0.03569483]
Stock Position:  0.03569483124332233
Bond Position:  [-14.32070992]


portfolio before change:  [-10.79446184]
curr_Stock_Price:  98.81383478823034
curr_Factors:  [98.81383479]
mat_Sqrt:  [[0.15]]
grads:  [-0.08146146]
Stock Position:  -0.08146146292261174
Bond Position:  [-2.7449423]


portfolio before change:  [-10.83591774]
curr_Stock_Price:  99.32063068128895
curr_Factors:  [99.32063068]
mat_Sqrt:  [[0.15]]
grads:  [0.08542935]
Stock Position:  0.08542934752927756
Bond Position:  [-19.32081441]


portfolio before change:  [-10.7645002]
curr_Stock_Price:  100.17074979325474
curr_Factors:  [100.17074979]
mat_Sqrt:  [[0.15]]
grads:  [-0.03079341]
Stock Position:  -0.030793412716695785
Bond Position:  [-7.67990096]


portfolio before change:  [-10.78688525]
curr_Stock_Price:  100.88210458359143
curr_Factors:  [100.88210458]
mat_Sqrt:  [[0.15]]
grads:  [-0.06831411]
Stock Position:  -0.06831410576911034
Bond Position:  [-3.89521449]


portfolio before change:  [-10.80638692]
curr_Stock_Price:  101.16401129866468
curr_Factors:  [101.1640113]
mat_Sqrt:  [[0.15]]
grads:  [-0.20548265]
Stock Position:  -0.20548264939830493
Bond Position:  [9.98106215]


portfolio before change:  [-10.60414186]
curr_Stock_Price:  100.18280326506094
curr_Factors:  [100.18280327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453621]
Stock Position:  -0.014536213951402885
Bond Position:  [-9.14786319]


portfolio before change:  [-10.59840795]
curr_Stock_Price:  99.74901295270772
curr_Factors:  [99.74901295]
mat_Sqrt:  [[0.15]]
grads:  [-0.03233569]
Stock Position:  -0.03233568903095127
Bond Position:  [-7.37295488]


portfolio before change:  [-10.59855286]
curr_Stock_Price:  99.73924336554259
curr_Factors:  [99.73924337]
mat_Sqrt:  [[0.15]]
grads:  [0.09829207]
Stock Position:  0.09829207036163826
Bond Position:  [-20.40212959]


portfolio before change:  [-10.55337526]
curr_Stock_Price:  100.2118427856983
curr_Factors:  [100.21184279]
mat_Sqrt:  [[0.15]]
grads:  [-0.01362897]
Stock Position:  -0.013628971920490233
Bond Position:  [-9.18759087]


portfolio before change:  [-10.55423969]
curr_Stock_Price:  100.23313473000007
curr_Factors:  [100.23313473]
mat_Sqrt:  [[0.15]]
grads:  [-0.01594716]
Stock Position:  -0.015947159073755834
Bond Position:  [-8.95580595]


portfolio before change:  [-10.55581856]
curr_Stock_Price:  100.2970401210047
curr_Factors:  [100.29704012]
mat_Sqrt:  [[0.15]]
grads:  [0.0578804]
Stock Position:  0.05788040211946088
Bond Position:  [-16.36105157]


portfolio before change:  [-10.55605415]
curr_Stock_Price:  100.31063713492333
curr_Factors:  [100.31063713]
mat_Sqrt:  [[0.15]]
grads:  [-0.0144027]
Stock Position:  -0.014402703007522558
Bond Position:  [-9.11130984]


portfolio before change:  [-10.54988214]
curr_Stock_Price:  99.84256612762154
curr_Factors:  [99.84256613]
mat_Sqrt:  [[0.15]]
grads:  [0.08490824]
Stock Position:  0.08490823975079853
Bond Position:  [-19.02733868]


portfolio before change:  [-10.51559153]
curr_Stock_Price:  100.2604272911682
curr_Factors:  [100.26042729]
mat_Sqrt:  [[0.15]]
grads:  [0.24482359]
Stock Position:  0.24482358828572054
Bond Position:  [-35.0617091]


portfolio before change:  [-10.4769253]
curr_Stock_Price:  100.42731339350173
curr_Factors:  [100.42731339]
mat_Sqrt:  [[0.15]]
grads:  [-0.09785567]
Stock Position:  -0.09785567170721729
Bond Position:  [-0.64954309]


portfolio before change:  [-10.51825119]
curr_Stock_Price:  100.8492131848898
curr_Factors:  [100.84921318]
mat_Sqrt:  [[0.15]]
grads:  [0.1188461]
Stock Position:  0.11884609915664357
Bond Position:  [-22.50378678]


portfolio before change:  [-10.42389744]
curr_Stock_Price:  101.65496345160311
curr_Factors:  [101.65496345]
mat_Sqrt:  [[0.15]]
grads:  [0.00901333]
Stock Position:  0.009013332008165467
Bond Position:  [-11.34014738]


portfolio before change:  [-10.42569535]
curr_Stock_Price:  101.53412819836926
curr_Factors:  [101.5341282]
mat_Sqrt:  [[0.15]]
grads:  [-0.02903783]
Stock Position:  -0.029037825116007988
Bond Position:  [-7.47736509]


portfolio before change:  [-10.42193342]
curr_Stock_Price:  101.38848077126535
curr_Factors:  [101.38848077]
mat_Sqrt:  [[0.15]]
grads:  [0.03039209]
Stock Position:  0.030392088788692234
Bond Position:  [-13.50334113]


portfolio before change:  [-10.47219051]
curr_Stock_Price:  99.76262633731112
curr_Factors:  [99.76262634]
mat_Sqrt:  [[0.15]]
grads:  [0.11138893]
Stock Position:  0.1113889315890515
Bond Position:  [-21.58464287]


portfolio before change:  [-10.54119061]
curr_Stock_Price:  99.15528578724323
curr_Factors:  [99.15528579]
mat_Sqrt:  [[0.15]]
grads:  [0.11892113]
Stock Position:  0.11892113397187777
Bond Position:  [-22.33284964]


portfolio before change:  [-10.58191172]
curr_Stock_Price:  98.8246022312857
curr_Factors:  [98.82460223]
mat_Sqrt:  [[0.15]]
grads:  [-0.03760496]
Stock Position:  -0.037604961025117664
Bond Position:  [-6.86561641]


portfolio before change:  [-10.57623948]
curr_Stock_Price:  98.66235345602915
curr_Factors:  [98.66235346]
mat_Sqrt:  [[0.15]]
grads:  [0.03129665]
Stock Position:  0.031296654307134575
Bond Position:  [-13.66404105]


portfolio before change:  [-10.59388492]
curr_Stock_Price:  98.12582930943293
curr_Factors:  [98.12582931]
mat_Sqrt:  [[0.15]]
grads:  [0.04124313]
Stock Position:  0.041243127968424685
Bond Position:  [-14.64090105]


portfolio before change:  [-10.61319665]
curr_Stock_Price:  97.67977558813666
curr_Factors:  [97.67977559]
mat_Sqrt:  [[0.15]]
grads:  [0.06294505]
Stock Position:  0.06294504834784821
Bond Position:  [-16.76165485]


portfolio before change:  [-10.59883253]
curr_Stock_Price:  97.9246202030861
curr_Factors:  [97.9246202]
mat_Sqrt:  [[0.15]]
grads:  [0.1063995]
Stock Position:  0.10639949539197942
Bond Position:  [-21.01796271]


portfolio before change:  [-10.60424605]
curr_Stock_Price:  97.88608756079103
curr_Factors:  [97.88608756]
mat_Sqrt:  [[0.15]]
grads:  [0.13149833]
Stock Position:  0.13149833088923246
Bond Position:  [-23.47610318]


portfolio before change:  [-10.65085112]
curr_Stock_Price:  97.54283017858603
curr_Factors:  [97.54283018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04573539]
Stock Position:  -0.04573538975360637
Bond Position:  [-6.18969177]


portfolio before change:  [-10.61476535]
curr_Stock_Price:  96.74535938353989
curr_Factors:  [96.74535938]
mat_Sqrt:  [[0.15]]
grads:  [0.13626833]
Stock Position:  0.1362683270735889
Bond Position:  [-23.79809363]


portfolio before change:  [-10.68745253]
curr_Stock_Price:  96.22286267987405
curr_Factors:  [96.22286268]
mat_Sqrt:  [[0.15]]
grads:  [0.08488093]
Stock Position:  0.0848809281058279
Bond Position:  [-18.85493842]


portfolio before change:  [-10.68072327]
curr_Stock_Price:  96.31602535202116
curr_Factors:  [96.31602535]
mat_Sqrt:  [[0.15]]
grads:  [-0.13116232]
Stock Position:  -0.1311623208086067
Bond Position:  [1.95231015]


portfolio before change:  [-10.69684908]
curr_Stock_Price:  96.43990114271037
curr_Factors:  [96.43990114]
mat_Sqrt:  [[0.15]]
grads:  [-0.08155829]
Stock Position:  -0.08155829078968137
Bond Position:  [-2.83137558]


portfolio before change:  [-10.68223026]
curr_Stock_Price:  96.25848749310423
curr_Factors:  [96.25848749]
mat_Sqrt:  [[0.15]]
grads:  [-0.13001937]
Stock Position:  -0.1300193711275441
Bond Position:  [1.83323775]


portfolio before change:  [-10.64497471]
curr_Stock_Price:  95.97283025706061
curr_Factors:  [95.97283026]
mat_Sqrt:  [[0.15]]
grads:  [0.07491784]
Stock Position:  0.07491784284330098
Bond Position:  [-17.83505212]


portfolio before change:  [-10.59761978]
curr_Stock_Price:  96.61980099666347
curr_Factors:  [96.619801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01389213]
Stock Position:  -0.013892134470388574
Bond Position:  [-9.25536451]


portfolio before change:  [-10.60321213]
curr_Stock_Price:  96.98071561354183
curr_Factors:  [96.98071561]
mat_Sqrt:  [[0.15]]
grads:  [-0.05430014]
Stock Position:  -0.0543001449028912
Bond Position:  [-5.33714522]


portfolio before change:  [-10.59087306]
curr_Stock_Price:  96.74733396398528
curr_Factors:  [96.74733396]
mat_Sqrt:  [[0.15]]
grads:  [-0.05654546]
Stock Position:  -0.05654546066891783
Bond Position:  [-5.12025049]


portfolio before change:  [-10.57299011]
curr_Stock_Price:  96.42541643822221
curr_Factors:  [96.42541644]
mat_Sqrt:  [[0.15]]
grads:  [0.04646599]
Stock Position:  0.046465992315615205
Bond Position:  [-15.05349277]


portfolio before change:  [-10.58274597]
curr_Stock_Price:  96.23570813138076
curr_Factors:  [96.23570813]
mat_Sqrt:  [[0.15]]
grads:  [0.2335452]
Stock Position:  0.23354520296985118
Bond Position:  [-33.05813395]


portfolio before change:  [-10.6869944]
curr_Stock_Price:  95.79818155297755
curr_Factors:  [95.79818155]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247869]
Stock Position:  -0.02247869208032019
Bond Position:  [-8.53357657]


portfolio before change:  [-10.68650536]
curr_Stock_Price:  95.75269844426116
curr_Factors:  [95.75269844]
mat_Sqrt:  [[0.15]]
grads:  [0.11436145]
Stock Position:  0.11436144560311223
Bond Position:  [-21.63692238]


portfolio before change:  [-10.69536602]
curr_Stock_Price:  95.6870442662175
curr_Factors:  [95.68704427]
mat_Sqrt:  [[0.15]]
grads:  [-0.32029856]
Stock Position:  -0.3202985611988841
Bond Position:  [19.95305659]


portfolio before change:  [-10.65843963]
curr_Stock_Price:  95.57565044890136
curr_Factors:  [95.57565045]
mat_Sqrt:  [[0.15]]
grads:  [0.1500485]
Stock Position:  0.15004849722335747
Bond Position:  [-24.99942236]


portfolio before change:  [-10.63274561]
curr_Stock_Price:  95.75730194248588
curr_Factors:  [95.75730194]
mat_Sqrt:  [[0.15]]
grads:  [0.06217512]
Stock Position:  0.06217512259967916
Bond Position:  [-16.5864676]


portfolio before change:  [-10.67494464]
curr_Stock_Price:  95.09526317729942
curr_Factors:  [95.09526318]
mat_Sqrt:  [[0.15]]
grads:  [0.03593928]
Stock Position:  0.03593928435780223
Bond Position:  [-14.09260035]


portfolio before change:  [-10.68468588]
curr_Stock_Price:  94.84872441930048
curr_Factors:  [94.84872442]
mat_Sqrt:  [[0.15]]
grads:  [-0.07884562]
Stock Position:  -0.07884562380661331
Bond Position:  [-3.20627904]


portfolio before change:  [-10.61844997]
curr_Stock_Price:  94.00611181476188
curr_Factors:  [94.00611181]
mat_Sqrt:  [[0.15]]
grads:  [0.00228523]
Stock Position:  0.00228522532714391
Bond Position:  [-10.83327511]


portfolio before change:  [-10.61817926]
curr_Stock_Price:  94.42086373117833
curr_Factors:  [94.42086373]
mat_Sqrt:  [[0.15]]
grads:  [0.0005157]
Stock Position:  0.0005156951033139189
Bond Position:  [-10.66687164]


portfolio before change:  [-10.61885783]
curr_Stock_Price:  94.39786413357741
curr_Factors:  [94.39786413]
mat_Sqrt:  [[0.15]]
grads:  [-0.02932463]
Stock Position:  -0.029324630475711738
Bond Position:  [-7.85067534]


portfolio before change:  [-10.61882828]
curr_Stock_Price:  94.38012389754036
curr_Factors:  [94.3801239]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796995]
Stock Position:  -0.007969948838226869
Bond Position:  [-9.86662352]


portfolio before change:  [-10.62257174]
curr_Stock_Price:  94.77244442711972
curr_Factors:  [94.77244443]
mat_Sqrt:  [[0.15]]
grads:  [0.03158828]
Stock Position:  0.03158828441355192
Bond Position:  [-13.61627067]


portfolio before change:  [-10.60626493]
curr_Stock_Price:  95.31561579693725
curr_Factors:  [95.3156158]
mat_Sqrt:  [[0.15]]
grads:  [-0.09281947]
Stock Position:  -0.09281947457052764
Bond Position:  [-1.75911956]


portfolio before change:  [-10.55640462]
curr_Stock_Price:  94.77725619458786
curr_Factors:  [94.77725619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03553285]
Stock Position:  -0.03553285361528154
Bond Position:  [-7.18869825]


portfolio before change:  [-10.56006464]
curr_Stock_Price:  94.86761500691865
curr_Factors:  [94.86761501]
mat_Sqrt:  [[0.15]]
grads:  [-0.02508428]
Stock Position:  -0.025084284435656804
Bond Position:  [-8.1803784]


portfolio before change:  [-10.55093186]
curr_Stock_Price:  94.483148302551
curr_Factors:  [94.4831483]
mat_Sqrt:  [[0.15]]
grads:  [0.09302822]
Stock Position:  0.09302821755747079
Bond Position:  [-19.34053073]


portfolio before change:  [-10.50987351]
curr_Stock_Price:  94.93749616847943
curr_Factors:  [94.93749617]
mat_Sqrt:  [[0.15]]
grads:  [0.04342358]
Stock Position:  0.043423581577841035
Bond Position:  [-14.63239961]


portfolio before change:  [-10.54147788]
curr_Stock_Price:  94.2307415481207
curr_Factors:  [94.23074155]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527433]
Stock Position:  -0.015274329518009432
Bond Position:  [-9.10216648]


portfolio before change:  [-10.54224875]
curr_Stock_Price:  94.24396449090482
curr_Factors:  [94.24396449]
mat_Sqrt:  [[0.15]]
grads:  [-0.03431493]
Stock Position:  -0.0343149264901741
Bond Position:  [-7.30827404]


portfolio before change:  [-10.54463854]
curr_Stock_Price:  94.30029577081258
curr_Factors:  [94.30029577]
mat_Sqrt:  [[0.15]]
grads:  [-0.0231865]
Stock Position:  -0.023186501494971177
Bond Position:  [-8.35814459]


portfolio before change:  [-10.54038415]
curr_Stock_Price:  94.09428010841388
curr_Factors:  [94.09428011]
mat_Sqrt:  [[0.15]]
grads:  [0.00631479]
Stock Position:  0.006314787490222194
Bond Position:  [-11.13456954]


portfolio before change:  [-10.54384092]
curr_Stock_Price:  93.65707812016372
curr_Factors:  [93.65707812]
mat_Sqrt:  [[0.15]]
grads:  [-0.0463238]
Stock Position:  -0.04632380191321377
Bond Position:  [-6.20528899]


portfolio before change:  [-10.55454251]
curr_Stock_Price:  93.87972266594059
curr_Factors:  [93.87972267]
mat_Sqrt:  [[0.15]]
grads:  [0.11527933]
Stock Position:  0.1152793323383782
Bond Position:  [-21.37693426]


portfolio before change:  [-10.47576497]
curr_Stock_Price:  94.57467497291167
curr_Factors:  [94.57467497]
mat_Sqrt:  [[0.15]]
grads:  [0.04943365]
Stock Position:  0.049433652240276696
Bond Position:  [-15.15093656]


portfolio before change:  [-10.45061802]
curr_Stock_Price:  95.10253230478104
curr_Factors:  [95.1025323]
mat_Sqrt:  [[0.15]]
grads:  [0.13540887]
Stock Position:  0.135408869288142
Bond Position:  [-23.32834438]


portfolio before change:  [-10.40387994]
curr_Stock_Price:  95.45846280804696
curr_Factors:  [95.45846281]
mat_Sqrt:  [[0.15]]
grads:  [-0.02296355]
Stock Position:  -0.02296354526918902
Bond Position:  [-8.21181521]


portfolio before change:  [-10.39459824]
curr_Stock_Price:  95.0319192406408
curr_Factors:  [95.03191924]
mat_Sqrt:  [[0.15]]
grads:  [0.04825214]
Stock Position:  0.04825213963917045
Bond Position:  [-14.98009168]


portfolio before change:  [-10.39733991]
curr_Stock_Price:  94.99450353465278
curr_Factors:  [94.99450353]
mat_Sqrt:  [[0.15]]
grads:  [0.18419923]
Stock Position:  0.1841992265009977
Bond Position:  [-27.89525399]


portfolio before change:  [-10.3905942]
curr_Stock_Price:  95.04059071414193
curr_Factors:  [95.04059071]
mat_Sqrt:  [[0.15]]
grads:  [0.02047884]
Stock Position:  0.0204788358060287
Bond Position:  [-12.33691485]


portfolio before change:  [-10.40191979]
curr_Stock_Price:  94.52520463405664
curr_Factors:  [94.52520463]
mat_Sqrt:  [[0.15]]
grads:  [-0.10113374]
Stock Position:  -0.10113373904566192
Bond Position:  [-0.84223241]


portfolio before change:  [-10.40894828]
curr_Stock_Price:  94.59418115625006
curr_Factors:  [94.59418116]
mat_Sqrt:  [[0.15]]
grads:  [-0.03803229]
Stock Position:  -0.03803229269772818
Bond Position:  [-6.8113147]


portfolio before change:  [-10.41286259]
curr_Stock_Price:  94.68590808337417
curr_Factors:  [94.68590808]
mat_Sqrt:  [[0.15]]
grads:  [0.01849365]
Stock Position:  0.01849365424683152
Bond Position:  [-12.16395103]


portfolio before change:  [-10.41085494]
curr_Stock_Price:  94.8355766919333
curr_Factors:  [94.83557669]
mat_Sqrt:  [[0.15]]
grads:  [0.07725054]
Stock Position:  0.07725054469325551
Bond Position:  [-17.73695489]


portfolio before change:  [-10.4211205]
curr_Stock_Price:  94.71704069779769
curr_Factors:  [94.7170407]
mat_Sqrt:  [[0.15]]
grads:  [0.06436986]
Stock Position:  0.06436985511757613
Bond Position:  [-16.51804269]


portfolio before change:  [-10.42094746]
curr_Stock_Price:  94.73576763943491
curr_Factors:  [94.73576764]
mat_Sqrt:  [[0.15]]
grads:  [0.00956103]
Stock Position:  0.009561031228280427
Bond Position:  [-11.32671909]


portfolio before change:  [-10.42166886]
curr_Stock_Price:  94.73435969992579
curr_Factors:  [94.7343597]
mat_Sqrt:  [[0.15]]
grads:  [-0.15259559]
Stock Position:  -0.15259559044514798
Bond Position:  [4.03437669]


portfolio before change:  [-10.37572436]
curr_Stock_Price:  94.43492544364545
curr_Factors:  [94.43492544]
mat_Sqrt:  [[0.15]]
grads:  [-0.2123859]
Stock Position:  -0.212385904578721
Bond Position:  [9.6809227]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.43299573]
Stock Price:  94.70743147801784
PL:  [-10.43299573]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-3.46737118e-03]
 [ 1.69656990e-02]
 [ 2.10122578e-02]
 [-2.07650104e-02]
 [-2.50665149e-02]
 [-1.23177250e-03]
 [-3.27419278e-03]
 [-3.51107716e-02]
 [ 1.65548768e-02]
 [-6.82204923e-03]
 [-1.22834698e-02]
 [ 2.27721504e-02]
 [-5.09492239e-03]
 [ 5.37013353e-03]
 [ 1.31992121e-02]
 [ 8.70258734e-03]
 [ 9.68133122e-02]
 [-9.25637943e-03]
 [ 2.38857394e-02]
 [ 1.24882884e-03]
 [-4.99162408e-03]
 [ 4.68647434e-03]
 [ 1.20836655e-02]
 [ 3.38956380e-02]
 [ 1.87937292e-03]
 [ 8.27612876e-03]
 [ 1.88403280e-02]
 [ 1.90138623e-02]
 [ 1.72332506e-02]
 [-8.38499461e-03]
 [-1.59286238e-03]
 [ 1.39835547e-02]
 [ 1.32581537e-02]
 [ 9.04719412e-03]
 [ 5.17905782e-03]
 [ 1.02891500e-02]
 [-2.77620407e-02]
 [ 3.39661827e-03]
 [-5.29938906e-02]
 [ 1.33004029e-02]
 [ 4.98251138e-03]
 [ 1.88388643e-03]
 [-1.52880739e-03]
 [-4.30460459e-03]
 [ 1.97637277e-02]
 [ 1.21785525e-02]
 [ 1.05534306e-02]
 [-1.84010822e-03]
 [ 1.35404583e-02]
 [-1.17988798e-03]
 [ 2.18519579e-02]
 [-8.61823721e-06]
 [-2.13114332e-03]
 [-2.42800472e-02]
 [-2.43328121e-03]
 [-3.01828301e-03]
 [ 9.82156595e-03]
 [-1.81871669e-02]
 [ 5.60701636e-03]
 [-3.75128708e-03]
 [-2.09902657e-03]
 [ 8.07398967e-03]
 [-1.12673908e-02]
 [ 6.67380272e-03]
 [ 2.54235535e-02]
 [ 5.52088247e-03]
 [ 1.12260568e-02]
 [-1.41881638e-03]
 [ 2.63526933e-03]
 [ 2.07951321e-02]
 [ 3.31921265e-04]
 [-1.59713275e-02]
 [-2.09301658e-03]
 [ 1.37054888e-03]
 [-5.95088830e-04]
 [-6.59238442e-03]
 [-2.46123719e-03]
 [ 4.59269108e-03]
 [-2.40149320e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.08810172]
curr_Stock_Price:  100.41140443561977
curr_Factors:  [100.41140444]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311581]
Stock Position:  -0.023115807863249682
Bond Position:  [13.40919245]


portfolio before change:  [11.09166282]
curr_Stock_Price:  100.29360631345475
curr_Factors:  [100.29360631]
mat_Sqrt:  [[0.15]]
grads:  [0.11310466]
Stock Position:  0.11310466027029727
Bond Position:  [-0.25201145]


portfolio before change:  [11.14919985]
curr_Stock_Price:  100.80245169462673
curr_Factors:  [100.80245169]
mat_Sqrt:  [[0.15]]
grads:  [0.14008172]
Stock Position:  0.14008171843465536
Bond Position:  [-2.9713808]


portfolio before change:  [11.16175513]
curr_Stock_Price:  100.89340573050711
curr_Factors:  [100.89340573]
mat_Sqrt:  [[0.15]]
grads:  [-0.1384334]
Stock Position:  -0.13843340259526313
Bond Position:  [25.12877259]


portfolio before change:  [11.12746978]
curr_Stock_Price:  101.15241802428879
curr_Factors:  [101.15241802]
mat_Sqrt:  [[0.15]]
grads:  [-0.1671101]
Stock Position:  -0.1671100992468346
Bond Position:  [28.03106039]


portfolio before change:  [11.1620481]
curr_Stock_Price:  100.95598270906747
curr_Factors:  [100.95598271]
mat_Sqrt:  [[0.15]]
grads:  [-0.00821182]
Stock Position:  -0.0082118166774963
Bond Position:  [11.99108012]


portfolio before change:  [11.16648703]
curr_Stock_Price:  100.50669573613098
curr_Factors:  [100.50669574]
mat_Sqrt:  [[0.15]]
grads:  [-0.02182795]
Stock Position:  -0.02182795184610198
Bond Position:  [13.36034234]


portfolio before change:  [11.14705467]
curr_Stock_Price:  101.43520250452337
curr_Factors:  [101.4352025]
mat_Sqrt:  [[0.15]]
grads:  [-0.23407181]
Stock Position:  -0.234071810681786
Bond Position:  [34.89017619]


portfolio before change:  [11.06425988]
curr_Stock_Price:  101.79823423000121
curr_Factors:  [101.79823423]
mat_Sqrt:  [[0.15]]
grads:  [0.11036585]
Stock Position:  0.11036584512630737
Bond Position:  [-0.17078827]


portfolio before change:  [11.10531921]
curr_Stock_Price:  102.17036027941002
curr_Factors:  [102.17036028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04548033]
Stock Position:  -0.045480328173047015
Bond Position:  [15.75206073]


portfolio before change:  [11.06313606]
curr_Stock_Price:  103.11951103644945
curr_Factors:  [103.11951104]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818898]
Stock Position:  -0.08188979894649727
Bond Position:  [19.50757209]


portfolio before change:  [11.01783063]
curr_Stock_Price:  103.68764889503507
curr_Factors:  [103.6876489]
mat_Sqrt:  [[0.15]]
grads:  [0.15181434]
Stock Position:  0.15181433583317483
Bond Position:  [-4.72344092]


portfolio before change:  [10.971259]
curr_Stock_Price:  103.38282656608135
curr_Factors:  [103.38282657]
mat_Sqrt:  [[0.15]]
grads:  [-0.03396615]
Stock Position:  -0.03396614927983685
Bond Position:  [14.48277552]


portfolio before change:  [10.97637474]
curr_Stock_Price:  103.25886380032816
curr_Factors:  [103.2588638]
mat_Sqrt:  [[0.15]]
grads:  [0.03580089]
Stock Position:  0.03580089017285388
Bond Position:  [7.2796155]


portfolio before change:  [10.981949]
curr_Stock_Price:  103.4018563903644
curr_Factors:  [103.40185639]
mat_Sqrt:  [[0.15]]
grads:  [0.08799475]
Stock Position:  0.08799474711261328
Bond Position:  [1.88312879]


portfolio before change:  [11.00051866]
curr_Stock_Price:  103.61155028494183
curr_Factors:  [103.61155028]
mat_Sqrt:  [[0.15]]
grads:  [0.05801725]
Stock Position:  0.05801724896044491
Bond Position:  [4.98926155]


portfolio before change:  [10.96463057]
curr_Stock_Price:  102.98759924605882
curr_Factors:  [102.98759925]
mat_Sqrt:  [[0.15]]
grads:  [0.64542208]
Stock Position:  0.6454220811405339
Bond Position:  [-55.50584006]


portfolio before change:  [11.37471811]
curr_Stock_Price:  103.62835321466716
curr_Factors:  [103.62835321]
mat_Sqrt:  [[0.15]]
grads:  [-0.0617092]
Stock Position:  -0.061709196219455364
Bond Position:  [17.76954049]


portfolio before change:  [11.41195901]
curr_Stock_Price:  103.0428608049
curr_Factors:  [103.0428608]
mat_Sqrt:  [[0.15]]
grads:  [0.15923826]
Stock Position:  0.15923826242110173
Bond Position:  [-4.9964071]


portfolio before change:  [11.21790018]
curr_Stock_Price:  101.8261523524695
curr_Factors:  [101.82615235]
mat_Sqrt:  [[0.15]]
grads:  [0.00832553]
Stock Position:  0.008325525600501336
Bond Position:  [10.37014394]


portfolio before change:  [11.2197954]
curr_Stock_Price:  101.97594040201706
curr_Factors:  [101.9759404]
mat_Sqrt:  [[0.15]]
grads:  [-0.03327749]
Stock Position:  -0.03327749387523054
Bond Position:  [14.61329913]


portfolio before change:  [11.23200375]
curr_Stock_Price:  101.63652204509222
curr_Factors:  [101.63652205]
mat_Sqrt:  [[0.15]]
grads:  [0.03124316]
Stock Position:  0.031243162290527718
Bond Position:  [8.0565574]


portfolio before change:  [11.23309928]
curr_Stock_Price:  101.65546946905918
curr_Factors:  [101.65546947]
mat_Sqrt:  [[0.15]]
grads:  [0.08055777]
Stock Position:  0.08055776976496126
Bond Position:  [3.04396137]


portfolio before change:  [11.29751904]
curr_Stock_Price:  102.45277936024152
curr_Factors:  [102.45277936]
mat_Sqrt:  [[0.15]]
grads:  [0.22597092]
Stock Position:  0.22597091967605354
Bond Position:  [-11.85382974]


portfolio before change:  [11.33917418]
curr_Stock_Price:  102.64039656173065
curr_Factors:  [102.64039656]
mat_Sqrt:  [[0.15]]
grads:  [0.01252915]
Stock Position:  0.012529152819420766
Bond Position:  [10.05317697]


portfolio before change:  [11.33959186]
curr_Stock_Price:  102.6235826445574
curr_Factors:  [102.62358264]
mat_Sqrt:  [[0.15]]
grads:  [0.05517419]
Stock Position:  0.05517419173053808
Bond Position:  [5.67741864]


portfolio before change:  [11.35063415]
curr_Stock_Price:  102.81728619124986
curr_Factors:  [102.81728619]
mat_Sqrt:  [[0.15]]
grads:  [0.12560219]
Stock Position:  0.12560218677338753
Bond Position:  [-1.56344183]


portfolio before change:  [11.33199902]
curr_Stock_Price:  102.6696978758532
curr_Factors:  [102.66969788]
mat_Sqrt:  [[0.15]]
grads:  [0.12675908]
Stock Position:  0.12675908202124297
Bond Position:  [-1.68231764]


portfolio before change:  [11.39197453]
curr_Stock_Price:  103.14367312408922
curr_Factors:  [103.14367312]
mat_Sqrt:  [[0.15]]
grads:  [0.11488834]
Stock Position:  0.11488833751914988
Bond Position:  [-0.4580306]


portfolio before change:  [11.30902859]
curr_Stock_Price:  102.42195221843482
curr_Factors:  [102.42195222]
mat_Sqrt:  [[0.15]]
grads:  [-0.05589996]
Stock Position:  -0.05589996408483955
Bond Position:  [17.03441204]


portfolio before change:  [11.31518297]
curr_Stock_Price:  102.33090221058718
curr_Factors:  [102.33090221]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061908]
Stock Position:  -0.010619082505073988
Bond Position:  [12.40184326]


portfolio before change:  [11.3122281]
curr_Stock_Price:  102.68215767982818
curr_Factors:  [102.68215768]
mat_Sqrt:  [[0.15]]
grads:  [0.0932237]
Stock Position:  0.09322369829094584
Bond Position:  [1.73981761]


portfolio before change:  [11.25676742]
curr_Stock_Price:  102.08607088216453
curr_Factors:  [102.08607088]
mat_Sqrt:  [[0.15]]
grads:  [0.08838769]
Stock Position:  0.08838769140193362
Bond Position:  [2.23361529]


portfolio before change:  [11.16910534]
curr_Stock_Price:  101.09270083837323
curr_Factors:  [101.09270084]
mat_Sqrt:  [[0.15]]
grads:  [0.06031463]
Stock Position:  0.06031462748707158
Bond Position:  [5.07173675]


portfolio before change:  [11.16028418]
curr_Stock_Price:  100.94119264234676
curr_Factors:  [100.94119264]
mat_Sqrt:  [[0.15]]
grads:  [0.03452705]
Stock Position:  0.034527052151159796
Bond Position:  [7.67508235]


portfolio before change:  [11.16876533]
curr_Stock_Price:  101.17293701834997
curr_Factors:  [101.17293702]
mat_Sqrt:  [[0.15]]
grads:  [0.06859433]
Stock Position:  0.06859433332027612
Bond Position:  [4.22887517]


portfolio before change:  [11.16596939]
curr_Stock_Price:  101.1283232028261
curr_Factors:  [101.1283232]
mat_Sqrt:  [[0.15]]
grads:  [-0.18508027]
Stock Position:  -0.18508027159977086
Bond Position:  [29.88282692]


portfolio before change:  [11.23972282]
curr_Stock_Price:  100.73992040068464
curr_Factors:  [100.7399204]
mat_Sqrt:  [[0.15]]
grads:  [0.02264412]
Stock Position:  0.022644121830173863
Bond Position:  [8.95855579]


portfolio before change:  [11.24028649]
curr_Stock_Price:  100.74008574282225
curr_Factors:  [100.74008574]
mat_Sqrt:  [[0.15]]
grads:  [-0.3532926]
Stock Position:  -0.35329260410753693
Bond Position:  [46.83101372]


portfolio before change:  [11.19827952]
curr_Stock_Price:  100.86727210466937
curr_Factors:  [100.8672721]
mat_Sqrt:  [[0.15]]
grads:  [0.08866935]
Stock Position:  0.08866935288305393
Bond Position:  [2.25444378]


portfolio before change:  [11.24587122]
curr_Stock_Price:  101.40241519123829
curr_Factors:  [101.40241519]
mat_Sqrt:  [[0.15]]
grads:  [0.03321674]
Stock Position:  0.03321674251202274
Bond Position:  [7.87761331]


portfolio before change:  [11.21644495]
curr_Stock_Price:  100.50170573749011
curr_Factors:  [100.50170574]
mat_Sqrt:  [[0.15]]
grads:  [0.01255924]
Stock Position:  0.012559242899202808
Bond Position:  [9.95421962]


portfolio before change:  [11.21206757]
curr_Stock_Price:  100.10362869490825
curr_Factors:  [100.10362869]
mat_Sqrt:  [[0.15]]
grads:  [-0.01019205]
Stock Position:  -0.010192049270314753
Bond Position:  [12.23232868]


portfolio before change:  [11.20876282]
curr_Stock_Price:  100.5028895182645
curr_Factors:  [100.50288952]
mat_Sqrt:  [[0.15]]
grads:  [-0.02869736]
Stock Position:  -0.02869736391706361
Bond Position:  [14.09293082]


portfolio before change:  [11.19806535]
curr_Stock_Price:  100.90635193897515
curr_Factors:  [100.90635194]
mat_Sqrt:  [[0.15]]
grads:  [0.13175818]
Stock Position:  0.1317581844881335
Bond Position:  [-2.09717238]


portfolio before change:  [11.41248398]
curr_Stock_Price:  102.53471152305049
curr_Factors:  [102.53471152]
mat_Sqrt:  [[0.15]]
grads:  [0.08119035]
Stock Position:  0.081190350000443
Bond Position:  [3.08765486]


portfolio before change:  [11.42851548]
curr_Stock_Price:  102.72979030577267
curr_Factors:  [102.72979031]
mat_Sqrt:  [[0.15]]
grads:  [0.0703562]
Stock Position:  0.07035620369405264
Bond Position:  [4.20083742]


portfolio before change:  [11.46448847]
curr_Stock_Price:  103.2373565987911
curr_Factors:  [103.2373566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01226739]
Stock Position:  -0.012267388134180811
Bond Position:  [12.7309412]


portfolio before change:  [11.47335234]
curr_Stock_Price:  102.5796650570875
curr_Factors:  [102.57966506]
mat_Sqrt:  [[0.15]]
grads:  [0.09026972]
Stock Position:  0.0902697220594511
Bond Position:  [2.21351449]


portfolio before change:  [11.43720678]
curr_Stock_Price:  102.17771508264943
curr_Factors:  [102.17771508]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786592]
Stock Position:  -0.007865919885413648
Bond Position:  [12.2409285]


portfolio before change:  [11.43268853]
curr_Stock_Price:  102.84938840184064
curr_Factors:  [102.8493884]
mat_Sqrt:  [[0.15]]
grads:  [0.14567972]
Stock Position:  0.14567971941000266
Bond Position:  [-3.55038151]


portfolio before change:  [11.50290606]
curr_Stock_Price:  103.33291101008992
curr_Factors:  [103.33291101]
mat_Sqrt:  [[0.15]]
grads:  [-5.74549148e-05]
Stock Position:  -5.745491475929686e-05
Bond Position:  [11.50884305]


portfolio before change:  [11.50360615]
curr_Stock_Price:  103.66781158421719
curr_Factors:  [103.66781158]
mat_Sqrt:  [[0.15]]
grads:  [-0.01420762]
Stock Position:  -0.014207622141621622
Bond Position:  [12.97647924]


portfolio before change:  [11.49991824]
curr_Stock_Price:  103.98446961209834
curr_Factors:  [103.98446961]
mat_Sqrt:  [[0.15]]
grads:  [-0.16186698]
Stock Position:  -0.1618669813243282
Bond Position:  [28.33157044]


portfolio before change:  [11.65668676]
curr_Stock_Price:  103.02690720707878
curr_Factors:  [103.02690721]
mat_Sqrt:  [[0.15]]
grads:  [-0.01622187]
Stock Position:  -0.01622187475204092
Bond Position:  [13.32797634]


portfolio before change:  [11.65338563]
curr_Stock_Price:  103.28175766730232
curr_Factors:  [103.28175767]
mat_Sqrt:  [[0.15]]
grads:  [-0.02012189]
Stock Position:  -0.020121886720518185
Bond Position:  [13.73160946]


portfolio before change:  [11.64966432]
curr_Stock_Price:  103.50934882649914
curr_Factors:  [103.50934883]
mat_Sqrt:  [[0.15]]
grads:  [0.06547711]
Stock Position:  0.06547710630133631
Bond Position:  [4.87217168]


portfolio before change:  [11.67373947]
curr_Stock_Price:  103.87238603198831
curr_Factors:  [103.87238603]
mat_Sqrt:  [[0.15]]
grads:  [-0.12124778]
Stock Position:  -0.12124777948627652
Bond Position:  [24.26803562]


portfolio before change:  [11.82490351]
curr_Stock_Price:  102.63815934807741
curr_Factors:  [102.63815935]
mat_Sqrt:  [[0.15]]
grads:  [0.03738011]
Stock Position:  0.03738010903549703
Bond Position:  [7.98827792]


portfolio before change:  [11.84291629]
curr_Stock_Price:  103.1066839481954
curr_Factors:  [103.10668395]
mat_Sqrt:  [[0.15]]
grads:  [-0.02500858]
Stock Position:  -0.025008580515646132
Bond Position:  [14.4214681]


portfolio before change:  [11.87382831]
curr_Stock_Price:  101.90666990401894
curr_Factors:  [101.9066699]
mat_Sqrt:  [[0.15]]
grads:  [-0.01399351]
Stock Position:  -0.01399351045344355
Bond Position:  [13.29986036]


portfolio before change:  [11.87807102]
curr_Stock_Price:  101.66288273441357
curr_Factors:  [101.66288273]
mat_Sqrt:  [[0.15]]
grads:  [0.0538266]
Stock Position:  0.053826597796340823
Bond Position:  [6.40590392]


portfolio before change:  [11.85488037]
curr_Stock_Price:  101.22460437615753
curr_Factors:  [101.22460438]
mat_Sqrt:  [[0.15]]
grads:  [-0.07511594]
Stock Position:  -0.0751159389288729
Bond Position:  [19.45846157]


portfolio before change:  [11.85282295]
curr_Stock_Price:  101.26818505562359
curr_Factors:  [101.26818506]
mat_Sqrt:  [[0.15]]
grads:  [0.04449202]
Stock Position:  0.04449201813995809
Bond Position:  [7.34719703]


portfolio before change:  [11.84409151]
curr_Stock_Price:  101.06161643463312
curr_Factors:  [101.06161643]
mat_Sqrt:  [[0.15]]
grads:  [0.16949036]
Stock Position:  0.16949035685688643
Bond Position:  [-5.28487792]


portfolio before change:  [11.85549053]
curr_Stock_Price:  101.13081995504706
curr_Factors:  [101.13081996]
mat_Sqrt:  [[0.15]]
grads:  [0.03680588]
Stock Position:  0.036805883155330135
Bond Position:  [8.13328138]


portfolio before change:  [11.85873674]
curr_Stock_Price:  101.20520664859865
curr_Factors:  [101.20520665]
mat_Sqrt:  [[0.15]]
grads:  [0.07484038]
Stock Position:  0.07484037879810132
Bond Position:  [4.28450074]


portfolio before change:  [11.79266445]
curr_Stock_Price:  100.31878570829923
curr_Factors:  [100.31878571]
mat_Sqrt:  [[0.15]]
grads:  [-0.00945878]
Stock Position:  -0.00945877584451428
Bond Position:  [12.74155736]


portfolio before change:  [11.7893504]
curr_Stock_Price:  100.75334769826345
curr_Factors:  [100.7533477]
mat_Sqrt:  [[0.15]]
grads:  [0.01756846]
Stock Position:  0.017568462192636834
Bond Position:  [10.01926902]


portfolio before change:  [11.78414271]
curr_Stock_Price:  100.42128022308593
curr_Factors:  [100.42128022]
mat_Sqrt:  [[0.15]]
grads:  [0.13863421]
Stock Position:  0.1386342141725606
Bond Position:  [-2.13768256]


portfolio before change:  [11.82448178]
curr_Stock_Price:  100.71321882884375
curr_Factors:  [100.71321883]
mat_Sqrt:  [[0.15]]
grads:  [0.00221281]
Stock Position:  0.0022128084352382883
Bond Position:  [11.60162272]


portfolio before change:  [11.82468683]
curr_Stock_Price:  100.47819245116717
curr_Factors:  [100.47819245]
mat_Sqrt:  [[0.15]]
grads:  [-0.10647552]
Stock Position:  -0.10647551683818042
Bond Position:  [22.52315431]


portfolio before change:  [11.84011399]
curr_Stock_Price:  100.34652452438665
curr_Factors:  [100.34652452]
mat_Sqrt:  [[0.15]]
grads:  [-0.01395344]
Stock Position:  -0.013953443838186502
Bond Position:  [13.24029358]


portfolio before change:  [11.8322549]
curr_Stock_Price:  100.96906857012179
curr_Factors:  [100.96906857]
mat_Sqrt:  [[0.15]]
grads:  [0.00913699]
Stock Position:  0.009136992555243676
Bond Position:  [10.90970127]


portfolio before change:  [11.83124602]
curr_Stock_Price:  100.7840241629946
curr_Factors:  [100.78402416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00396726]
Stock Position:  -0.003967258864513677
Bond Position:  [12.23108234]


portfolio before change:  [11.83369673]
curr_Stock_Price:  100.35898509056044
curr_Factors:  [100.35898509]
mat_Sqrt:  [[0.15]]
grads:  [-0.04394923]
Stock Position:  -0.04394922945472896
Bond Position:  [16.2443968]


portfolio before change:  [11.87641095]
curr_Stock_Price:  99.4101877828285
curr_Factors:  [99.41018778]
mat_Sqrt:  [[0.15]]
grads:  [-0.01640825]
Stock Position:  -0.016408247909365736
Bond Position:  [13.50755795]


portfolio before change:  [11.88084907]
curr_Stock_Price:  99.19115958635638
curr_Factors:  [99.19115959]
mat_Sqrt:  [[0.15]]
grads:  [0.03061794]
Stock Position:  0.030617940550400017
Bond Position:  [8.84382004]


portfolio before change:  [11.87465202]
curr_Stock_Price:  98.97070718166674
curr_Factors:  [98.97070718]
mat_Sqrt:  [[0.15]]
grads:  [-0.16009955]
Stock Position:  -0.16009954644804292
Bond Position:  [27.71981736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.86552499]
Stock Price:  99.03853730328417
PL:  [11.86552499]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.37631901e-02]
 [ 1.28596815e-02]
 [ 1.89538550e-02]
 [-2.45044993e-02]
 [-4.15066585e-02]
 [-1.18380716e-03]
 [ 8.38930152e-03]
 [-4.96845675e-02]
 [ 1.77550487e-02]
 [-7.48975226e-03]
 [-1.16972202e-02]
 [ 2.12736687e-02]
 [-6.35461621e-03]
 [ 6.85615556e-03]
 [ 1.43367779e-02]
 [ 9.49610477e-03]
 [ 9.62420510e-02]
 [-9.68804888e-03]
 [ 2.36624326e-02]
 [ 4.53363551e-04]
 [-7.37086749e-03]
 [ 6.53586432e-03]
 [ 5.53909357e-04]
 [ 5.60617228e-02]
 [ 6.25593486e-03]
 [ 5.47207169e-03]
 [ 1.03041576e-01]
 [ 4.17828088e-02]
 [-9.70204424e-03]
 [-7.25571626e-03]
 [ 1.08610789e-02]
 [ 1.68394655e-02]
 [ 1.82458876e-02]
 [-1.36770731e-02]
 [ 3.62694486e-03]
 [-2.37196663e-02]
 [-8.86007173e-03]
 [-1.78278701e-02]
 [ 3.46473777e-02]
 [-9.33033575e-02]
 [ 3.03648986e-03]
 [-4.86975022e-03]
 [-1.87296541e-02]
 [ 2.44809466e-02]
 [-1.54074358e-02]
 [ 1.19674158e-02]
 [ 1.04179727e-02]
 [-3.41889120e-03]
 [ 1.40907828e-02]
 [-1.46714707e-03]
 [ 1.94327097e-02]
 [ 2.06220253e-02]
 [-5.33624934e-03]
 [-4.53536951e-02]
 [-1.37465897e-02]
 [-2.33364127e-03]
 [ 1.41727004e-04]
 [-1.47616250e-02]
 [-2.26483244e-04]
 [-3.00016797e-03]
 [-7.59473234e-03]
 [-5.25124585e-03]
 [-1.73777537e-02]
 [ 4.32180590e-05]
 [-2.44299868e-03]
 [ 2.21585295e-02]
 [-5.68230121e-04]
 [ 1.64465826e-02]
 [ 8.59974673e-03]
 [ 1.13809739e-02]
 [ 5.97848605e-03]
 [-1.47895681e-02]
 [-3.49148750e-02]
 [ 7.34971402e-04]
 [-3.53248699e-03]
 [-2.42341342e-02]
 [-5.38234221e-03]
 [ 1.74582369e-02]
 [ 1.82518824e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.60485848]
curr_Stock_Price:  99.8803341455336
curr_Factors:  [99.88033415]
mat_Sqrt:  [[0.15]]
grads:  [-0.0917546]
Stock Position:  -0.09175460084416469
Bond Position:  [8.55962171]


portfolio before change:  [-0.62392074]
curr_Stock_Price:  100.09391746655409
curr_Factors:  [100.09391747]
mat_Sqrt:  [[0.15]]
grads:  [0.08573121]
Stock Position:  0.085731209917288
Bond Position:  [-9.20509339]


portfolio before change:  [-0.5235521]
curr_Stock_Price:  101.27136466172178
curr_Factors:  [101.27136466]
mat_Sqrt:  [[0.15]]
grads:  [0.12635903]
Stock Position:  0.1263590330453569
Bond Position:  [-13.32010382]


portfolio before change:  [-0.54710251]
curr_Stock_Price:  101.09157639487336
curr_Factors:  [101.09157639]
mat_Sqrt:  [[0.15]]
grads:  [-0.16336333]
Stock Position:  -0.16336332870313827
Bond Position:  [15.96755392]


portfolio before change:  [-0.65452026]
curr_Stock_Price:  101.75522442546826
curr_Factors:  [101.75522443]
mat_Sqrt:  [[0.15]]
grads:  [-0.27671106]
Stock Position:  -0.2767110565412214
Bond Position:  [27.5022754]


portfolio before change:  [-0.5248981]
curr_Stock_Price:  101.29299783497648
curr_Factors:  [101.29299783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00789205]
Stock Position:  -0.007892047742428385
Bond Position:  [0.27451107]


portfolio before change:  [-0.53097574]
curr_Stock_Price:  102.06526797272663
curr_Factors:  [102.06526797]
mat_Sqrt:  [[0.15]]
grads:  [0.05592868]
Stock Position:  0.05592867682225441
Bond Position:  [-6.23935112]


portfolio before change:  [-0.51505901]
curr_Stock_Price:  102.3568304012007
curr_Factors:  [102.3568304]
mat_Sqrt:  [[0.15]]
grads:  [-0.33123045]
Stock Position:  -0.3312304500927941
Bond Position:  [33.38864]


portfolio before change:  [-0.75319864]
curr_Stock_Price:  103.08208523900495
curr_Factors:  [103.08208524]
mat_Sqrt:  [[0.15]]
grads:  [0.11836699]
Stock Position:  0.11836699155655273
Bond Position:  [-12.95471495]


portfolio before change:  [-0.81092715]
curr_Stock_Price:  102.60121793761832
curr_Factors:  [102.60121794]
mat_Sqrt:  [[0.15]]
grads:  [-0.04993168]
Stock Position:  -0.04993168173919295
Bond Position:  [4.31212421]


portfolio before change:  [-0.82172137]
curr_Stock_Price:  102.82279548232916
curr_Factors:  [102.82279548]
mat_Sqrt:  [[0.15]]
grads:  [-0.07798147]
Stock Position:  -0.07798146778325088
Bond Position:  [7.19655114]


portfolio before change:  [-0.86480275]
curr_Stock_Price:  103.3810201432466
curr_Factors:  [103.38102014]
mat_Sqrt:  [[0.15]]
grads:  [0.14182446]
Stock Position:  0.14182445823108075
Bond Position:  [-15.52675993]


portfolio before change:  [-0.7362357]
curr_Stock_Price:  104.29438520238583
curr_Factors:  [104.2943852]
mat_Sqrt:  [[0.15]]
grads:  [-0.04236411]
Stock Position:  -0.04236410807309626
Bond Position:  [3.68210291]


portfolio before change:  [-0.71280914]
curr_Stock_Price:  103.74683632127949
curr_Factors:  [103.74683632]
mat_Sqrt:  [[0.15]]
grads:  [0.0457077]
Stock Position:  0.045707703753791844
Bond Position:  [-5.4548388]


portfolio before change:  [-0.72119446]
curr_Stock_Price:  103.57084011961418
curr_Factors:  [103.57084012]
mat_Sqrt:  [[0.15]]
grads:  [0.09557852]
Stock Position:  0.0955785193283979
Bond Position:  [-10.62034201]


portfolio before change:  [-0.75902187]
curr_Stock_Price:  103.18201203352284
curr_Factors:  [103.18201203]
mat_Sqrt:  [[0.15]]
grads:  [0.06330737]
Stock Position:  0.06330736513856047
Bond Position:  [-7.29120318]


portfolio before change:  [-0.74141732]
curr_Stock_Price:  103.46729095368696
curr_Factors:  [103.46729095]
mat_Sqrt:  [[0.15]]
grads:  [0.64161367]
Stock Position:  0.6416136735025564
Bond Position:  [-67.12744596]


portfolio before change:  [-0.84267221]
curr_Stock_Price:  103.3160172349939
curr_Factors:  [103.31601723]
mat_Sqrt:  [[0.15]]
grads:  [-0.06458699]
Stock Position:  -0.06458699252837062
Bond Position:  [5.83019863]


portfolio before change:  [-0.81387681]
curr_Stock_Price:  102.87582028086445
curr_Factors:  [102.87582028]
mat_Sqrt:  [[0.15]]
grads:  [0.15774955]
Stock Position:  0.15774955082608538
Bond Position:  [-17.04249125]


portfolio before change:  [-0.81699399]
curr_Stock_Price:  102.86281238515431
curr_Factors:  [102.86281239]
mat_Sqrt:  [[0.15]]
grads:  [0.00302242]
Stock Position:  0.003022423675281808
Bond Position:  [-1.12788899]


portfolio before change:  [-0.81474915]
curr_Stock_Price:  103.6288663447009
curr_Factors:  [103.62886634]
mat_Sqrt:  [[0.15]]
grads:  [-0.04913912]
Stock Position:  -0.049139116579728914
Bond Position:  [4.2774818]


portfolio before change:  [-0.81567041]
curr_Stock_Price:  103.65305521054746
curr_Factors:  [103.65305521]
mat_Sqrt:  [[0.15]]
grads:  [0.04357243]
Stock Position:  0.04357242878934861
Bond Position:  [-5.33208578]


portfolio before change:  [-0.80987713]
curr_Stock_Price:  103.79366129675347
curr_Factors:  [103.7936613]
mat_Sqrt:  [[0.15]]
grads:  [0.00369273]
Stock Position:  0.003692729046615428
Bond Position:  [-1.193159]


portfolio before change:  [-0.80755983]
curr_Stock_Price:  104.44138822077728
curr_Factors:  [104.44138822]
mat_Sqrt:  [[0.15]]
grads:  [0.37374482]
Stock Position:  0.37374481867872755
Bond Position:  [-39.84198753]


portfolio before change:  [-0.76483294]
curr_Stock_Price:  104.56237206657714
curr_Factors:  [104.56237207]
mat_Sqrt:  [[0.15]]
grads:  [0.04170623]
Stock Position:  0.041706232425453515
Bond Position:  [-5.12573554]


portfolio before change:  [-0.73466148]
curr_Stock_Price:  105.29348179729973
curr_Factors:  [105.2934818]
mat_Sqrt:  [[0.15]]
grads:  [0.03648048]
Stock Position:  0.03648047791404425
Bond Position:  [-4.57581802]


portfolio before change:  [-0.69176637]
curr_Stock_Price:  106.47715887262838
curr_Factors:  [106.47715887]
mat_Sqrt:  [[0.15]]
grads:  [0.68694384]
Stock Position:  0.6869438397163254
Bond Position:  [-73.83559473]


portfolio before change:  [-0.75160098]
curr_Stock_Price:  106.39677422187506
curr_Factors:  [106.39677422]
mat_Sqrt:  [[0.15]]
grads:  [0.27855206]
Stock Position:  0.2785520588891553
Bond Position:  [-30.3886415]


portfolio before change:  [-0.56346134]
curr_Stock_Price:  107.07901291409496
curr_Factors:  [107.07901291]
mat_Sqrt:  [[0.15]]
grads:  [-0.06468029]
Stock Position:  -0.06468029490707844
Bond Position:  [6.3624408]


portfolio before change:  [-0.54205636]
curr_Stock_Price:  106.75422603359904
curr_Factors:  [106.75422603]
mat_Sqrt:  [[0.15]]
grads:  [-0.04837144]
Stock Position:  -0.04837144174956937
Bond Position:  [4.62179946]


portfolio before change:  [-0.54982194]
curr_Stock_Price:  106.9207385685443
curr_Factors:  [106.92073857]
mat_Sqrt:  [[0.15]]
grads:  [0.07240719]
Stock Position:  0.072407192800318
Bond Position:  [-8.29165247]


portfolio before change:  [-0.58705285]
curr_Stock_Price:  106.41370790208667
curr_Factors:  [106.4137079]
mat_Sqrt:  [[0.15]]
grads:  [0.1122631]
Stock Position:  0.11226310353252558
Bond Position:  [-12.53338596]


portfolio before change:  [-0.54887294]
curr_Stock_Price:  106.76077893060699
curr_Factors:  [106.76077893]
mat_Sqrt:  [[0.15]]
grads:  [0.12163925]
Stock Position:  0.12163925065416764
Bond Position:  [-13.53517409]


portfolio before change:  [-0.54006616]
curr_Stock_Price:  106.84013458989057
curr_Factors:  [106.84013459]
mat_Sqrt:  [[0.15]]
grads:  [-0.09118049]
Stock Position:  -0.09118048735479388
Bond Position:  [9.20166939]


portfolio before change:  [-0.49384284]
curr_Stock_Price:  106.33949909771334
curr_Factors:  [106.3394991]
mat_Sqrt:  [[0.15]]
grads:  [0.02417963]
Stock Position:  0.024179632372148513
Bond Position:  [-3.06509284]


portfolio before change:  [-0.49589896]
curr_Stock_Price:  106.26238724306084
curr_Factors:  [106.26238724]
mat_Sqrt:  [[0.15]]
grads:  [-0.15813111]
Stock Position:  -0.15813110840212194
Bond Position:  [16.30749012]


portfolio before change:  [-0.50924091]
curr_Stock_Price:  106.35320559080304
curr_Factors:  [106.35320559]
mat_Sqrt:  [[0.15]]
grads:  [-0.05906714]
Stock Position:  -0.05906714488796468
Bond Position:  [5.77273929]


portfolio before change:  [-0.520027]
curr_Stock_Price:  106.54192131571318
curr_Factors:  [106.54192132]
mat_Sqrt:  [[0.15]]
grads:  [-0.11885247]
Stock Position:  -0.11885246707172922
Bond Position:  [12.14274319]


portfolio before change:  [-0.64377446]
curr_Stock_Price:  107.5894923641417
curr_Factors:  [107.58949236]
mat_Sqrt:  [[0.15]]
grads:  [0.23098252]
Stock Position:  0.2309825182850953
Bond Position:  [-25.49506635]


portfolio before change:  [-0.56070702]
curr_Stock_Price:  107.95601763846692
curr_Factors:  [107.95601764]
mat_Sqrt:  [[0.15]]
grads:  [-0.62202238]
Stock Position:  -0.6220223832964056
Bond Position:  [66.59035236]


portfolio before change:  [-0.46007793]
curr_Stock_Price:  107.80093147204205
curr_Factors:  [107.80093147]
mat_Sqrt:  [[0.15]]
grads:  [0.02024327]
Stock Position:  0.02024326575350191
Bond Position:  [-2.64232083]


portfolio before change:  [-0.4819221]
curr_Stock_Price:  106.73000621418832
curr_Factors:  [106.73000621]
mat_Sqrt:  [[0.15]]
grads:  [-0.032465]
Stock Position:  -0.032465001464593815
Bond Position:  [2.98306771]


portfolio before change:  [-0.4728714]
curr_Stock_Price:  106.45696585674348
curr_Factors:  [106.45696586]
mat_Sqrt:  [[0.15]]
grads:  [-0.12486436]
Stock Position:  -0.12486436068172749
Bond Position:  [12.81980958]


portfolio before change:  [-0.53131513]
curr_Stock_Price:  106.93144069947982
curr_Factors:  [106.9314407]
mat_Sqrt:  [[0.15]]
grads:  [0.16320631]
Stock Position:  0.16320631047363562
Bond Position:  [-17.98320104]


portfolio before change:  [-0.39543376]
curr_Stock_Price:  107.77090187560557
curr_Factors:  [107.77090188]
mat_Sqrt:  [[0.15]]
grads:  [-0.10271624]
Stock Position:  -0.10271623864310726
Bond Position:  [10.67438792]


portfolio before change:  [-0.39807772]
curr_Stock_Price:  107.80313758355939
curr_Factors:  [107.80313758]
mat_Sqrt:  [[0.15]]
grads:  [0.07978277]
Stock Position:  0.0797827720998346
Bond Position:  [-8.99891088]


portfolio before change:  [-0.46061787]
curr_Stock_Price:  107.02630692758204
curr_Factors:  [107.02630693]
mat_Sqrt:  [[0.15]]
grads:  [0.06945315]
Stock Position:  0.06945315141944763
Bond Position:  [-7.89393217]


portfolio before change:  [-0.49165268]
curr_Stock_Price:  106.58656552699182
curr_Factors:  [106.58656553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02279261]
Stock Position:  -0.022792607969503494
Bond Position:  [1.93773312]


portfolio before change:  [-0.47058554]
curr_Stock_Price:  105.66758197171715
curr_Factors:  [105.66758197]
mat_Sqrt:  [[0.15]]
grads:  [0.09393855]
Stock Position:  0.09393855229397133
Bond Position:  [-10.39684521]


portfolio before change:  [-0.46780934]
curr_Stock_Price:  105.70405283390006
curr_Factors:  [105.70405283]
mat_Sqrt:  [[0.15]]
grads:  [-0.00978098]
Stock Position:  -0.009780980434422772
Bond Position:  [0.56607993]


portfolio before change:  [-0.47160244]
curr_Stock_Price:  106.09547349042657
curr_Factors:  [106.09547349]
mat_Sqrt:  [[0.15]]
grads:  [0.1295514]
Stock Position:  0.1295513982554256
Bond Position:  [-14.21641938]


portfolio before change:  [-0.43431257]
curr_Stock_Price:  106.39017059928368
curr_Factors:  [106.3901706]
mat_Sqrt:  [[0.15]]
grads:  [0.13748017]
Stock Position:  0.13748016834973148
Bond Position:  [-15.06085114]


portfolio before change:  [-0.5614483]
curr_Stock_Price:  105.47226080963782
curr_Factors:  [105.47226081]
mat_Sqrt:  [[0.15]]
grads:  [-0.035575]
Stock Position:  -0.03557499561842051
Bond Position:  [3.19072692]


portfolio before change:  [-0.56748691]
curr_Stock_Price:  105.64760984721316
curr_Factors:  [105.64760985]
mat_Sqrt:  [[0.15]]
grads:  [-0.30235797]
Stock Position:  -0.3023579672122672
Bond Position:  [31.37590964]


portfolio before change:  [-0.60377827]
curr_Stock_Price:  105.77412351332131
curr_Factors:  [105.77412351]
mat_Sqrt:  [[0.15]]
grads:  [-0.09164393]
Stock Position:  -0.09164393106322574
Bond Position:  [9.08977821]


portfolio before change:  [-0.65465515]
curr_Stock_Price:  106.33548104909396
curr_Factors:  [106.33548105]
mat_Sqrt:  [[0.15]]
grads:  [-0.01555761]
Stock Position:  -0.015557608441697299
Bond Position:  [0.99967063]


portfolio before change:  [-0.65364749]
curr_Stock_Price:  106.27472774988503
curr_Factors:  [106.27472775]
mat_Sqrt:  [[0.15]]
grads:  [0.00094485]
Stock Position:  0.0009448466937486341
Bond Position:  [-0.75406082]


portfolio before change:  [-0.65334672]
curr_Stock_Price:  106.64294379431391
curr_Factors:  [106.64294379]
mat_Sqrt:  [[0.15]]
grads:  [-0.09841083]
Stock Position:  -0.0984108330691923
Bond Position:  [9.84147422]


portfolio before change:  [-0.72534914]
curr_Stock_Price:  107.38084557870785
curr_Factors:  [107.38084558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00150989]
Stock Position:  -0.0015098882902084103
Bond Position:  [-0.56321605]


portfolio before change:  [-0.72535623]
curr_Stock_Price:  107.36223109951617
curr_Factors:  [107.3622311]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000112]
Stock Position:  -0.020001119805551876
Bond Position:  [1.42200862]


portfolio before change:  [-0.73291068]
curr_Stock_Price:  107.74437595518872
curr_Factors:  [107.74437596]
mat_Sqrt:  [[0.15]]
grads:  [-0.05063155]
Stock Position:  -0.05063154892139001
Bond Position:  [4.72235396]


portfolio before change:  [-0.74584833]
curr_Stock_Price:  108.0057310286305
curr_Factors:  [108.00573103]
mat_Sqrt:  [[0.15]]
grads:  [-0.03500831]
Stock Position:  -0.03500830569609868
Bond Position:  [3.03524931]


portfolio before change:  [-0.71865141]
curr_Stock_Price:  107.23427944333915
curr_Factors:  [107.23427944]
mat_Sqrt:  [[0.15]]
grads:  [-0.11585169]
Stock Position:  -0.11585169112066196
Bond Position:  [11.70462121]


portfolio before change:  [-0.67131292]
curr_Stock_Price:  106.83198121492198
curr_Factors:  [106.83198121]
mat_Sqrt:  [[0.15]]
grads:  [0.00028812]
Stock Position:  0.0002881203933046646
Bond Position:  [-0.70209339]


portfolio before change:  [-0.67121507]
curr_Stock_Price:  107.323890339326
curr_Factors:  [107.32389034]
mat_Sqrt:  [[0.15]]
grads:  [-0.01628666]
Stock Position:  -0.016286657835224566
Bond Position:  [1.07673241]


portfolio before change:  [-0.65585638]
curr_Stock_Price:  106.38499925280216
curr_Factors:  [106.38499925]
mat_Sqrt:  [[0.15]]
grads:  [0.14772353]
Stock Position:  0.14772353010615458
Bond Position:  [-16.37142402]


portfolio before change:  [-0.57982962]
curr_Stock_Price:  106.9065817442918
curr_Factors:  [106.90658174]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037882]
Stock Position:  -0.0037882008080098012
Bond Position:  [-0.17484602]


portfolio before change:  [-0.57799688]
curr_Stock_Price:  106.41989438412396
curr_Factors:  [106.41989438]
mat_Sqrt:  [[0.15]]
grads:  [0.10964388]
Stock Position:  0.10964388393153879
Bond Position:  [-12.24628742]


portfolio before change:  [-0.47992183]
curr_Stock_Price:  107.32136247866511
curr_Factors:  [107.32136248]
mat_Sqrt:  [[0.15]]
grads:  [0.05733164]
Stock Position:  0.05733164487693632
Bond Position:  [-6.63283207]


portfolio before change:  [-0.51178173]
curr_Stock_Price:  106.77288117781684
curr_Factors:  [106.77288118]
mat_Sqrt:  [[0.15]]
grads:  [0.07587316]
Stock Position:  0.07587315938583589
Bond Position:  [-8.61297756]


portfolio before change:  [-0.50776491]
curr_Stock_Price:  106.83291751126139
curr_Factors:  [106.83291751]
mat_Sqrt:  [[0.15]]
grads:  [0.03985657]
Stock Position:  0.039856573644755776
Bond Position:  [-4.76575896]


portfolio before change:  [-0.51141736]
curr_Stock_Price:  106.74875125770482
curr_Factors:  [106.74875126]
mat_Sqrt:  [[0.15]]
grads:  [-0.09859712]
Stock Position:  -0.09859712080845016
Bond Position:  [10.01370216]


portfolio before change:  [-0.52008627]
curr_Stock_Price:  106.84302161526828
curr_Factors:  [106.84302162]
mat_Sqrt:  [[0.15]]
grads:  [-0.23276583]
Stock Position:  -0.2327658334184984
Bond Position:  [24.3493187]


portfolio before change:  [-0.26865649]
curr_Stock_Price:  105.76937652194822
curr_Factors:  [105.76937652]
mat_Sqrt:  [[0.15]]
grads:  [0.00489981]
Stock Position:  0.004899809348689427
Bond Position:  [-0.78690627]


portfolio before change:  [-0.26696371]
curr_Stock_Price:  106.12489321605712
curr_Factors:  [106.12489322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02354991]
Stock Position:  -0.02354991323956108
Bond Position:  [2.23226831]


portfolio before change:  [-0.27528131]
curr_Stock_Price:  106.4840076674786
curr_Factors:  [106.48400767]
mat_Sqrt:  [[0.15]]
grads:  [-0.16156089]
Stock Position:  -0.16156089439279686
Bond Position:  [16.92837021]


portfolio before change:  [-0.36240101]
curr_Stock_Price:  107.029794199769
curr_Factors:  [107.0297942]
mat_Sqrt:  [[0.15]]
grads:  [-0.03588228]
Stock Position:  -0.035882281383399973
Bond Position:  [3.47807218]


portfolio before change:  [-0.36041385]
curr_Stock_Price:  106.98047266021646
curr_Factors:  [106.98047266]
mat_Sqrt:  [[0.15]]
grads:  [0.11638825]
Stock Position:  0.11638824600360927
Bond Position:  [-12.81168342]


portfolio before change:  [-0.50462614]
curr_Stock_Price:  105.74829039905917
curr_Factors:  [105.7482904]
mat_Sqrt:  [[0.15]]
grads:  [0.12167922]
Stock Position:  0.1216792156843614
Bond Position:  [-13.37199518]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.54958313]
Stock Price:  105.38568766702399
PL:  [-5.9352708]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.25920415e-02]
 [ 4.43474767e-02]
 [ 1.85331388e-02]
 [-1.43417100e-02]
 [-2.54454328e-02]
 [-2.70749151e-03]
 [ 1.15937102e-03]
 [ 2.96347076e-03]
 [-1.61787391e-02]
 [-6.31199174e-03]
 [ 1.35643759e-02]
 [-2.84351206e-03]
 [-1.95198032e-03]
 [ 8.97169238e-03]
 [-2.41139869e-03]
 [ 1.10663600e-02]
 [ 1.55548780e-02]
 [-1.42766611e-02]
 [ 2.49095593e-02]
 [-1.45427402e-03]
 [-9.90789417e-03]
 [ 5.44550169e-03]
 [ 1.63504139e-02]
 [ 1.78379098e-02]
 [-5.81185838e-03]
 [ 4.65913801e-03]
 [ 6.88672352e-03]
 [ 8.98233890e-03]
 [ 1.61321572e-02]
 [ 1.24802925e-02]
 [-6.85728930e-03]
 [ 1.12281154e-02]
 [ 1.15896179e-02]
 [-9.54129186e-03]
 [-2.20959004e-03]
 [ 1.80334803e-02]
 [ 5.73129329e-03]
 [ 1.86755168e-03]
 [-3.26575777e-02]
 [-1.41237654e-02]
 [ 7.19955963e-03]
 [ 1.81011866e-02]
 [-2.09537392e-03]
 [ 1.27317689e-03]
 [-2.90113974e-03]
 [ 1.54694232e-02]
 [ 1.06311072e-02]
 [ 4.67719826e-03]
 [ 5.56613384e-03]
 [-2.30241859e-03]
 [-6.29315980e-03]
 [-8.48137114e-04]
 [ 1.57966710e-03]
 [ 8.07936982e-03]
 [-8.31845179e-03]
 [-4.39675996e-03]
 [ 2.08629766e-03]
 [ 1.07052582e-02]
 [ 7.79089192e-03]
 [-3.93369662e-03]
 [-7.18975986e-04]
 [ 2.67862515e-03]
 [-6.39772800e-03]
 [ 7.24052029e-03]
 [ 1.98088811e-02]
 [ 4.96398136e-03]
 [ 9.85022979e-03]
 [-2.99902923e-04]
 [ 2.70437552e-03]
 [ 2.18149258e-02]
 [ 5.60645163e-04]
 [-1.59791932e-02]
 [-2.87175854e-03]
 [ 1.34654309e-03]
 [-4.58794909e-04]
 [-7.44129553e-03]
 [-4.29838441e-03]
 [ 1.63947966e-02]
 [-7.15350946e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.75094274]
curr_Stock_Price:  99.98732980911669
curr_Factors:  [99.98732981]
mat_Sqrt:  [[0.15]]
grads:  [-0.08394694]
Stock Position:  -0.08394694358788014
Bond Position:  [10.14457347]


portfolio before change:  [1.65497546]
curr_Stock_Price:  101.13807247844672
curr_Factors:  [101.13807248]
mat_Sqrt:  [[0.15]]
grads:  [0.29564984]
Stock Position:  0.2956498443369637
Bond Position:  [-28.24647992]


portfolio before change:  [1.72095317]
curr_Stock_Price:  101.36720559662058
curr_Factors:  [101.3672056]
mat_Sqrt:  [[0.15]]
grads:  [0.12355426]
Stock Position:  0.12355425883495232
Bond Position:  [-10.80339678]


portfolio before change:  [1.62463387]
curr_Stock_Price:  100.59309975788416
curr_Factors:  [100.59309976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0956114]
Stock Position:  -0.09561139976010727
Bond Position:  [11.24248094]


portfolio before change:  [1.57068917]
curr_Stock_Price:  101.1646568101555
curr_Factors:  [101.16465681]
mat_Sqrt:  [[0.15]]
grads:  [-0.16963622]
Stock Position:  -0.16963621853364333
Bond Position:  [18.731879]


portfolio before change:  [1.69625512]
curr_Stock_Price:  100.43135136109426
curr_Factors:  [100.43135136]
mat_Sqrt:  [[0.15]]
grads:  [-0.01804994]
Stock Position:  -0.018049943383441677
Bond Position:  [3.50903532]


portfolio before change:  [1.71073044]
curr_Stock_Price:  99.64154240057277
curr_Factors:  [99.6415424]
mat_Sqrt:  [[0.15]]
grads:  [0.00772914]
Stock Position:  0.007729140100198098
Bond Position:  [0.940587]


portfolio before change:  [1.70821001]
curr_Stock_Price:  99.3078407690394
curr_Factors:  [99.30784077]
mat_Sqrt:  [[0.15]]
grads:  [0.01975647]
Stock Position:  0.01975647173638485
Bond Position:  [-0.25376254]


portfolio before change:  [1.70247488]
curr_Stock_Price:  99.01835272550107
curr_Factors:  [99.01835273]
mat_Sqrt:  [[0.15]]
grads:  [-0.10785826]
Stock Position:  -0.1078582608515758
Bond Position:  [12.3824222]


portfolio before change:  [1.63883764]
curr_Stock_Price:  99.61553620143872
curr_Factors:  [99.6155362]
mat_Sqrt:  [[0.15]]
grads:  [-0.04207994]
Stock Position:  -0.04207994493174894
Bond Position:  [5.83065392]


portfolio before change:  [1.65158807]
curr_Stock_Price:  99.32119158481422
curr_Factors:  [99.32119158]
mat_Sqrt:  [[0.15]]
grads:  [0.09042917]
Stock Position:  0.09042917271781045
Bond Position:  [-7.32994512]


portfolio before change:  [1.71357095]
curr_Stock_Price:  100.01168790814349
curr_Factors:  [100.01168791]
mat_Sqrt:  [[0.15]]
grads:  [-0.01895675]
Stock Position:  -0.018956747093079627
Bond Position:  [3.60946722]


portfolio before change:  [1.71385301]
curr_Stock_Price:  100.00870928988472
curr_Factors:  [100.00870929]
mat_Sqrt:  [[0.15]]
grads:  [-0.0130132]
Stock Position:  -0.013013202108537505
Bond Position:  [3.01528656]


portfolio before change:  [1.71108107]
curr_Stock_Price:  100.23620107446075
curr_Factors:  [100.23620107]
mat_Sqrt:  [[0.15]]
grads:  [0.05981128]
Stock Position:  0.059811282521767914
Bond Position:  [-4.28417467]


portfolio before change:  [1.7241279]
curr_Stock_Price:  100.45881117582823
curr_Factors:  [100.45881118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607599]
Stock Position:  -0.016075991299368125
Bond Position:  [3.33910288]


portfolio before change:  [1.74409976]
curr_Stock_Price:  99.22945276463945
curr_Factors:  [99.22945276]
mat_Sqrt:  [[0.15]]
grads:  [0.07377573]
Stock Position:  0.07377573314109709
Bond Position:  [-5.57662587]


portfolio before change:  [1.73440996]
curr_Stock_Price:  99.10283596083158
curr_Factors:  [99.10283596]
mat_Sqrt:  [[0.15]]
grads:  [0.10369919]
Stock Position:  0.10369918676232863
Bond Position:  [-8.54247354]


portfolio before change:  [1.71527354]
curr_Stock_Price:  98.92344692867505
curr_Factors:  [98.92344693]
mat_Sqrt:  [[0.15]]
grads:  [-0.09517774]
Stock Position:  -0.09517774048888714
Bond Position:  [11.1305837]


portfolio before change:  [1.7950963]
curr_Stock_Price:  98.09208578140986
curr_Factors:  [98.09208578]
mat_Sqrt:  [[0.15]]
grads:  [0.16606373]
Stock Position:  0.16606372856609028
Bond Position:  [-14.49444121]


portfolio before change:  [1.81238649]
curr_Stock_Price:  98.2016588839737
curr_Factors:  [98.20165888]
mat_Sqrt:  [[0.15]]
grads:  [-0.00969516]
Stock Position:  -0.009695160152547722
Bond Position:  [2.7644673]


portfolio before change:  [1.81414767]
curr_Stock_Price:  98.0378251259134
curr_Factors:  [98.03782513]
mat_Sqrt:  [[0.15]]
grads:  [-0.06605263]
Stock Position:  -0.06605262782165881
Bond Position:  [8.28980364]


portfolio before change:  [1.78841108]
curr_Stock_Price:  98.43530688562099
curr_Factors:  [98.43530689]
mat_Sqrt:  [[0.15]]
grads:  [0.03630334]
Stock Position:  0.036303344620467796
Bond Position:  [-1.78511979]


portfolio before change:  [1.79348935]
curr_Stock_Price:  98.57826457097578
curr_Factors:  [98.57826457]
mat_Sqrt:  [[0.15]]
grads:  [0.10900276]
Stock Position:  0.10900275932084867
Bond Position:  [-8.9518135]


portfolio before change:  [1.85664958]
curr_Stock_Price:  99.16283452464081
curr_Factors:  [99.16283452]
mat_Sqrt:  [[0.15]]
grads:  [0.1189194]
Stock Position:  0.11891939852948173
Bond Position:  [-9.93573506]


portfolio before change:  [1.84562855]
curr_Stock_Price:  99.07538012013858
curr_Factors:  [99.07538012]
mat_Sqrt:  [[0.15]]
grads:  [-0.03874572]
Stock Position:  -0.03874572255219963
Bond Position:  [5.68437574]


portfolio before change:  [1.85375027]
curr_Stock_Price:  98.87493398256187
curr_Factors:  [98.87493398]
mat_Sqrt:  [[0.15]]
grads:  [0.03106092]
Stock Position:  0.03106092003730119
Bond Position:  [-1.21739615]


portfolio before change:  [1.83311074]
curr_Stock_Price:  98.21289820355153
curr_Factors:  [98.2128982]
mat_Sqrt:  [[0.15]]
grads:  [0.04591149]
Stock Position:  0.0459114901646481
Bond Position:  [-2.67598977]


portfolio before change:  [1.82915427]
curr_Stock_Price:  98.13036521186436
curr_Factors:  [98.13036521]
mat_Sqrt:  [[0.15]]
grads:  [0.05988226]
Stock Position:  0.05988225932164495
Bond Position:  [-4.04711371]


portfolio before change:  [1.78333279]
curr_Stock_Price:  97.36939645270645
curr_Factors:  [97.36939645]
mat_Sqrt:  [[0.15]]
grads:  [0.10754771]
Stock Position:  0.10754771485039602
Bond Position:  [-8.6885233]


portfolio before change:  [1.87516042]
curr_Stock_Price:  98.22827741620003
curr_Factors:  [98.22827742]
mat_Sqrt:  [[0.15]]
grads:  [0.08320195]
Stock Position:  0.08320194983597144
Bond Position:  [-6.29762379]


portfolio before change:  [1.97985102]
curr_Stock_Price:  99.49127922502635
curr_Factors:  [99.49127923]
mat_Sqrt:  [[0.15]]
grads:  [-0.04571526]
Stock Position:  -0.04571526200060283
Bond Position:  [6.52812092]


portfolio before change:  [2.01522944]
curr_Stock_Price:  98.7263181980138
curr_Factors:  [98.7263182]
mat_Sqrt:  [[0.15]]
grads:  [0.0748541]
Stock Position:  0.07485410264606746
Bond Position:  [-5.37484052]


portfolio before change:  [2.03396044]
curr_Stock_Price:  98.98103960448074
curr_Factors:  [98.9810396]
mat_Sqrt:  [[0.15]]
grads:  [0.07726412]
Stock Position:  0.07726411951485797
Bond Position:  [-5.61372243]


portfolio before change:  [2.06461745]
curr_Stock_Price:  99.38236271172914
curr_Factors:  [99.38236271]
mat_Sqrt:  [[0.15]]
grads:  [-0.06360861]
Stock Position:  -0.06360861236863372
Bond Position:  [8.38619164]


portfolio before change:  [2.1186698]
curr_Stock_Price:  98.54083830523534
curr_Factors:  [98.54083831]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147306]
Stock Position:  -0.0147306002444676
Bond Position:  [3.5702355]


portfolio before change:  [2.1269619]
curr_Stock_Price:  97.99307068561559
curr_Factors:  [97.99307069]
mat_Sqrt:  [[0.15]]
grads:  [0.1202232]
Stock Position:  0.12022320189006465
Bond Position:  [-9.65407882]


portfolio before change:  [2.13374477]
curr_Stock_Price:  98.05450870509152
curr_Factors:  [98.05450871]
mat_Sqrt:  [[0.15]]
grads:  [0.03820862]
Stock Position:  0.038208621901584486
Bond Position:  [-1.61278288]


portfolio before change:  [2.15817756]
curr_Stock_Price:  98.69660427383451
curr_Factors:  [98.69660427]
mat_Sqrt:  [[0.15]]
grads:  [0.01245034]
Stock Position:  0.01245034452543681
Bond Position:  [0.92937083]


portfolio before change:  [2.15620208]
curr_Stock_Price:  98.53326986265243
curr_Factors:  [98.53326986]
mat_Sqrt:  [[0.15]]
grads:  [-0.21771718]
Stock Position:  -0.217717184528542
Bond Position:  [23.60858817]


portfolio before change:  [2.0161768]
curr_Stock_Price:  99.18319952939115
curr_Factors:  [99.18319953]
mat_Sqrt:  [[0.15]]
grads:  [-0.09415844]
Stock Position:  -0.09415843587347254
Bond Position:  [11.35511173]


portfolio before change:  [1.99953369]
curr_Stock_Price:  99.36749340667883
curr_Factors:  [99.36749341]
mat_Sqrt:  [[0.15]]
grads:  [0.04799706]
Stock Position:  0.04799706417135885
Bond Position:  [-2.76981426]


portfolio before change:  [1.96915486]
curr_Stock_Price:  98.73816912613928
curr_Factors:  [98.73816913]
mat_Sqrt:  [[0.15]]
grads:  [0.12067458]
Stock Position:  0.12067457706925092
Bond Position:  [-9.94603194]


portfolio before change:  [2.01434395]
curr_Stock_Price:  99.11779127741048
curr_Factors:  [99.11779128]
mat_Sqrt:  [[0.15]]
grads:  [-0.01396916]
Stock Position:  -0.013969159489297995
Bond Position:  [3.39893619]


portfolio before change:  [2.02533918]
curr_Stock_Price:  98.34589203282272
curr_Factors:  [98.34589203]
mat_Sqrt:  [[0.15]]
grads:  [0.00848785]
Stock Position:  0.008487845939976549
Bond Position:  [1.1905944]


portfolio before change:  [2.02409629]
curr_Stock_Price:  98.19069361865529
curr_Factors:  [98.19069362]
mat_Sqrt:  [[0.15]]
grads:  [-0.01934093]
Stock Position:  -0.019340931575035844
Bond Position:  [3.92319578]


portfolio before change:  [2.02088422]
curr_Stock_Price:  98.36944818412026
curr_Factors:  [98.36944818]
mat_Sqrt:  [[0.15]]
grads:  [0.10312949]
Stock Position:  0.10312948803578073
Bond Position:  [-8.12390661]


portfolio before change:  [2.06515203]
curr_Stock_Price:  98.80361660104408
curr_Factors:  [98.8036166]
mat_Sqrt:  [[0.15]]
grads:  [0.07087405]
Stock Position:  0.07087404777078278
Bond Position:  [-4.93746022]


portfolio before change:  [2.09651418]
curr_Stock_Price:  99.2504762333018
curr_Factors:  [99.25047623]
mat_Sqrt:  [[0.15]]
grads:  [0.03118132]
Stock Position:  0.031181321719222443
Bond Position:  [-0.99824685]


portfolio before change:  [2.10261034]
curr_Stock_Price:  99.44798414824716
curr_Factors:  [99.44798415]
mat_Sqrt:  [[0.15]]
grads:  [0.03710756]
Stock Position:  0.037107558915239175
Bond Position:  [-1.58766159]


portfolio before change:  [2.10073884]
curr_Stock_Price:  99.40022394325935
curr_Factors:  [99.40022394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01534946]
Stock Position:  -0.015349457250529823
Bond Position:  [3.62647833]


portfolio before change:  [2.10233026]
curr_Stock_Price:  99.31131212345103
curr_Factors:  [99.31131212]
mat_Sqrt:  [[0.15]]
grads:  [-0.0419544]
Stock Position:  -0.04195439868126774
Bond Position:  [6.26887664]


portfolio before change:  [2.12024239]
curr_Stock_Price:  98.89370826419062
curr_Factors:  [98.89370826]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565425]
Stock Position:  -0.00565424742584002
Bond Position:  [2.67941189]


portfolio before change:  [2.1194507]
curr_Stock_Price:  99.06334418380986
curr_Factors:  [99.06334418]
mat_Sqrt:  [[0.15]]
grads:  [0.01053111]
Stock Position:  0.010531113979032513
Bond Position:  [1.07620333]


portfolio before change:  [2.11254252]
curr_Stock_Price:  98.40097932946186
curr_Factors:  [98.40097933]
mat_Sqrt:  [[0.15]]
grads:  [0.05386247]
Stock Position:  0.053862465454156336
Bond Position:  [-3.18757683]


portfolio before change:  [2.10081078]
curr_Stock_Price:  98.18686894120759
curr_Factors:  [98.18686894]
mat_Sqrt:  [[0.15]]
grads:  [-0.05545635]
Stock Position:  -0.05545634529082788
Bond Position:  [7.54589568]


portfolio before change:  [2.06239638]
curr_Stock_Price:  98.88806975547769
curr_Factors:  [98.88806976]
mat_Sqrt:  [[0.15]]
grads:  [-0.02931173]
Stock Position:  -0.029311733061581857
Bond Position:  [4.96097708]


portfolio before change:  [2.05362134]
curr_Stock_Price:  99.19801760038789
curr_Factors:  [99.1980176]
mat_Sqrt:  [[0.15]]
grads:  [0.01390865]
Stock Position:  0.013908651044439137
Bond Position:  [0.67391073]


portfolio before change:  [2.04239518]
curr_Stock_Price:  98.38785441823181
curr_Factors:  [98.38785442]
mat_Sqrt:  [[0.15]]
grads:  [0.07136839]
Stock Position:  0.07136838830441876
Bond Position:  [-4.97938742]


portfolio before change:  [2.04341556]
curr_Stock_Price:  98.40651258451831
curr_Factors:  [98.40651258]
mat_Sqrt:  [[0.15]]
grads:  [0.05193928]
Stock Position:  0.05193927949027999
Bond Position:  [-3.0677478]


portfolio before change:  [2.05339776]
curr_Stock_Price:  98.60239384225244
curr_Factors:  [98.60239384]
mat_Sqrt:  [[0.15]]
grads:  [-0.02622464]
Stock Position:  -0.026224644161669856
Bond Position:  [4.63921045]


portfolio before change:  [2.03477078]
curr_Stock_Price:  99.32373565214307
curr_Factors:  [99.32373565]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479317]
Stock Position:  -0.004793173240448829
Bond Position:  [2.51084665]


portfolio before change:  [2.03518662]
curr_Stock_Price:  99.26972038618298
curr_Factors:  [99.26972039]
mat_Sqrt:  [[0.15]]
grads:  [0.0178575]
Stock Position:  0.01785750102102678
Bond Position:  [0.26247749]


portfolio before change:  [2.03077492]
curr_Stock_Price:  99.02175171418611
curr_Factors:  [99.02175171]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265152]
Stock Position:  -0.042651520008801416
Bond Position:  [6.25420315]


portfolio before change:  [1.99620363]
curr_Stock_Price:  99.84146920013927
curr_Factors:  [99.8414692]
mat_Sqrt:  [[0.15]]
grads:  [0.04827014]
Stock Position:  0.04827013528922818
Bond Position:  [-2.8231576]


portfolio before change:  [1.97374726]
curr_Stock_Price:  99.37990201573955
curr_Factors:  [99.37990202]
mat_Sqrt:  [[0.15]]
grads:  [0.13205921]
Stock Position:  0.13205920704283972
Bond Position:  [-11.15028379]


portfolio before change:  [1.89982578]
curr_Stock_Price:  98.82541914892992
curr_Factors:  [98.82541915]
mat_Sqrt:  [[0.15]]
grads:  [0.03309321]
Stock Position:  0.033093209073630434
Bond Position:  [-1.37062448]


portfolio before change:  [1.8956836]
curr_Stock_Price:  98.70284052335738
curr_Factors:  [98.70284052]
mat_Sqrt:  [[0.15]]
grads:  [0.0656682]
Stock Position:  0.06566819859641002
Bond Position:  [-4.58595414]


portfolio before change:  [1.9028257]
curr_Stock_Price:  98.8159658478986
curr_Factors:  [98.81596585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00199935]
Stock Position:  -0.0019993528192971256
Bond Position:  [2.10039368]


portfolio before change:  [1.90354661]
curr_Stock_Price:  98.52105500784107
curr_Factors:  [98.52105501]
mat_Sqrt:  [[0.15]]
grads:  [0.01802917]
Stock Position:  0.018029170129200987
Bond Position:  [0.12729375]


portfolio before change:  [1.92830457]
curr_Stock_Price:  99.89383059139682
curr_Factors:  [99.89383059]
mat_Sqrt:  [[0.15]]
grads:  [0.14543284]
Stock Position:  0.14543283842537444
Bond Position:  [-12.59953875]


portfolio before change:  [1.98321959]
curr_Stock_Price:  100.27684256230704
curr_Factors:  [100.27684256]
mat_Sqrt:  [[0.15]]
grads:  [0.00373763]
Stock Position:  0.0037376344215568798
Bond Position:  [1.60842141]


portfolio before change:  [1.98354535]
curr_Stock_Price:  100.33710252031786
curr_Factors:  [100.33710252]
mat_Sqrt:  [[0.15]]
grads:  [-0.10652795]
Stock Position:  -0.10652795463559735
Bond Position:  [12.67225166]


portfolio before change:  [2.00643097]
curr_Stock_Price:  100.12970556696749
curr_Factors:  [100.12970557]
mat_Sqrt:  [[0.15]]
grads:  [-0.01914506]
Stock Position:  -0.01914505694365423
Bond Position:  [3.92341988]


portfolio before change:  [1.99454703]
curr_Stock_Price:  100.76324540820097
curr_Factors:  [100.76324541]
mat_Sqrt:  [[0.15]]
grads:  [0.00897695]
Stock Position:  0.008976953928176346
Bond Position:  [1.09000002]


portfolio before change:  [1.99341849]
curr_Stock_Price:  100.6299403740788
curr_Factors:  [100.62994037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305863]
Stock Position:  -0.003058632725669551
Bond Position:  [2.30120851]


portfolio before change:  [1.99405502]
curr_Stock_Price:  100.46885361070547
curr_Factors:  [100.46885361]
mat_Sqrt:  [[0.15]]
grads:  [-0.04960864]
Stock Position:  -0.049608636884766306
Bond Position:  [6.9781779]


portfolio before change:  [1.98391899]
curr_Stock_Price:  100.68196522451477
curr_Factors:  [100.68196522]
mat_Sqrt:  [[0.15]]
grads:  [-0.0286559]
Stock Position:  -0.02865589606144119
Bond Position:  [4.86905092]


portfolio before change:  [1.96241917]
curr_Stock_Price:  101.4428608374586
curr_Factors:  [101.44286084]
mat_Sqrt:  [[0.15]]
grads:  [0.10929864]
Stock Position:  0.10929864414221213
Bond Position:  [-9.12514797]


portfolio before change:  [2.00427636]
curr_Stock_Price:  101.83104064356795
curr_Factors:  [101.83104064]
mat_Sqrt:  [[0.15]]
grads:  [-0.04769006]
Stock Position:  -0.047690063052777044
Bond Position:  [6.86060511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.00724546]
Stock Price:  101.77777382487743
PL:  [0.22947163]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.27159393e-02]
 [-6.62098241e-04]
 [ 5.75394537e-03]
 [-9.06732846e-03]
 [ 1.52432655e-02]
 [-2.06750442e-03]
 [ 2.38860420e-03]
 [-1.69014081e-02]
 [ 1.16590959e-02]
 [-7.20773067e-03]
 [-1.06297894e-02]
 [ 1.54623743e-02]
 [-3.52132575e-03]
 [ 6.38668055e-03]
 [-2.33449925e-03]
 [ 1.30195643e-02]
 [ 3.47672701e-02]
 [-1.46789103e-02]
 [ 1.81818086e-02]
 [ 1.28371757e-03]
 [-5.36180630e-03]
 [ 4.68924358e-03]
 [ 1.45640816e-02]
 [ 2.01180452e-02]
 [-2.71485430e-03]
 [ 6.62713112e-03]
 [ 2.00538094e-04]
 [ 1.39895247e-02]
 [ 2.54510337e-02]
 [-8.38620390e-03]
 [-1.98363743e-03]
 [ 1.41458707e-02]
 [ 1.34137245e-02]
 [ 3.49225446e-03]
 [ 6.47928651e-03]
 [ 1.05097178e-02]
 [-2.60299355e-02]
 [ 2.80546120e-03]
 [-4.73665416e-02]
 [ 1.48173334e-02]
 [ 7.20188481e-03]
 [-1.89195166e-03]
 [-2.19773887e-03]
 [-2.24686356e-03]
 [ 1.75315219e-02]
 [ 1.54334453e-02]
 [ 1.07923806e-02]
 [ 4.16358892e-03]
 [ 8.70538380e-03]
 [-2.30375064e-03]
 [-7.12894012e-03]
 [-4.18689030e-03]
 [ 2.06140479e-03]
 [ 1.12820653e-03]
 [-3.63612541e-03]
 [-3.33976895e-03]
 [ 1.05506979e-02]
 [-7.73520887e-03]
 [ 5.57486585e-03]
 [-3.90651848e-03]
 [-2.84510874e-03]
 [ 7.06712208e-03]
 [-1.92852052e-02]
 [ 1.23503572e-03]
 [ 1.26156878e-02]
 [ 1.45882902e-02]
 [ 4.82340037e-03]
 [ 1.26271163e-02]
 [ 7.24808681e-03]
 [ 1.11829809e-02]
 [ 1.99919914e-03]
 [-1.52531639e-02]
 [-6.92845992e-03]
 [ 1.05004741e-03]
 [ 1.86810622e-03]
 [-1.95037964e-02]
 [-3.68140730e-03]
 [ 1.18339010e-02]
 [-5.25213162e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.10872811]
curr_Stock_Price:  99.35785196169239
curr_Factors:  [99.35785196]
mat_Sqrt:  [[0.15]]
grads:  [-0.08477293]
Stock Position:  -0.08477292852505115
Bond Position:  [-3.68587203]


portfolio before change:  [-12.1274726]
curr_Stock_Price:  99.57624852302841
curr_Factors:  [99.57624852]
mat_Sqrt:  [[0.15]]
grads:  [-0.00441399]
Stock Position:  -0.004413988274045745
Bond Position:  [-11.68794421]


portfolio before change:  [-12.13087352]
curr_Stock_Price:  100.1812339243013
curr_Factors:  [100.18123392]
mat_Sqrt:  [[0.15]]
grads:  [0.03835964]
Stock Position:  0.03835963581628928
Bond Position:  [-15.97378917]


portfolio before change:  [-12.14764128]
curr_Stock_Price:  99.77014115149771
curr_Factors:  [99.77014115]
mat_Sqrt:  [[0.15]]
grads:  [-0.06044886]
Stock Position:  -0.06044885642382817
Bond Position:  [-6.11665034]


portfolio before change:  [-12.13924313]
curr_Stock_Price:  99.62488693512877
curr_Factors:  [99.62488694]
mat_Sqrt:  [[0.15]]
grads:  [0.10162177]
Stock Position:  0.10162176976838598
Bond Position:  [-22.26330045]


portfolio before change:  [-12.04801546]
curr_Stock_Price:  100.53629763581097
curr_Factors:  [100.53629764]
mat_Sqrt:  [[0.15]]
grads:  [-0.01378336]
Stock Position:  -0.013783362768710467
Bond Position:  [-10.6622872]


portfolio before change:  [-12.03954363]
curr_Stock_Price:  99.87330658093809
curr_Factors:  [99.87330658]
mat_Sqrt:  [[0.15]]
grads:  [0.01592403]
Stock Position:  0.01592402800051977
Bond Position:  [-13.62992896]


portfolio before change:  [-12.03046672]
curr_Stock_Price:  100.4968175752673
curr_Factors:  [100.49681758]
mat_Sqrt:  [[0.15]]
grads:  [-0.11267605]
Stock Position:  -0.11267605433079231
Bond Position:  [-0.70688184]


portfolio before change:  [-12.11059033]
curr_Stock_Price:  101.20752249165909
curr_Factors:  [101.20752249]
mat_Sqrt:  [[0.15]]
grads:  [0.07772731]
Stock Position:  0.07772730598728092
Bond Position:  [-19.9771784]


portfolio before change:  [-12.01765586]
curr_Stock_Price:  102.4192340958471
curr_Factors:  [102.4192341]
mat_Sqrt:  [[0.15]]
grads:  [-0.04805154]
Stock Position:  -0.04805153778070397
Bond Position:  [-7.09625417]


portfolio before change:  [-12.01153114]
curr_Stock_Price:  102.28254221298509
curr_Factors:  [102.28254221]
mat_Sqrt:  [[0.15]]
grads:  [-0.07086526]
Stock Position:  -0.07086526285464967
Bond Position:  [-4.7632519]


portfolio before change:  [-11.97019325]
curr_Stock_Price:  101.69501031918006
curr_Factors:  [101.69501032]
mat_Sqrt:  [[0.15]]
grads:  [0.1030825]
Stock Position:  0.10308249557124538
Bond Position:  [-22.4531687]


portfolio before change:  [-12.01571145]
curr_Stock_Price:  101.26705368869175
curr_Factors:  [101.26705369]
mat_Sqrt:  [[0.15]]
grads:  [-0.0234755]
Stock Position:  -0.02347550499194154
Bond Position:  [-9.63841623]


portfolio before change:  [-12.00623498]
curr_Stock_Price:  100.83771737140334
curr_Factors:  [100.83771737]
mat_Sqrt:  [[0.15]]
grads:  [0.04257787]
Stock Position:  0.04257787035509212
Bond Position:  [-16.29969024]


portfolio before change:  [-12.02543558]
curr_Stock_Price:  100.41069184420849
curr_Factors:  [100.41069184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01556333]
Stock Position:  -0.01556332836616145
Bond Position:  [-10.46271102]


portfolio before change:  [-12.01915117]
curr_Stock_Price:  99.96487738014271
curr_Factors:  [99.96487738]
mat_Sqrt:  [[0.15]]
grads:  [0.0867971]
Stock Position:  0.08679709511431183
Bond Position:  [-20.69581214]


portfolio before change:  [-12.01090651]
curr_Stock_Price:  100.07476798735053
curr_Factors:  [100.07476799]
mat_Sqrt:  [[0.15]]
grads:  [0.2317818]
Stock Position:  0.23178180072559942
Bond Position:  [-35.20641644]


portfolio before change:  [-11.92553329]
curr_Stock_Price:  100.45259615645337
curr_Factors:  [100.45259616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0978594]
Stock Position:  -0.09785940231410231
Bond Position:  [-2.09530227]


portfolio before change:  [-12.01001877]
curr_Stock_Price:  101.31459328185126
curr_Factors:  [101.31459328]
mat_Sqrt:  [[0.15]]
grads:  [0.12121206]
Stock Position:  0.12121205705702308
Bond Position:  [-24.29056903]


portfolio before change:  [-11.95654681]
curr_Stock_Price:  101.76826239313246
curr_Factors:  [101.76826239]
mat_Sqrt:  [[0.15]]
grads:  [0.00855812]
Stock Position:  0.008558117110639746
Bond Position:  [-12.82749152]


portfolio before change:  [-11.95337028]
curr_Stock_Price:  102.23311619063251
curr_Factors:  [102.23311619]
mat_Sqrt:  [[0.15]]
grads:  [-0.03574538]
Stock Position:  -0.035745375358853526
Bond Position:  [-8.29900917]


portfolio before change:  [-11.93266557]
curr_Stock_Price:  101.63937736625061
curr_Factors:  [101.63937737]
mat_Sqrt:  [[0.15]]
grads:  [0.03126162]
Stock Position:  0.03126162384352005
Bond Position:  [-15.11007755]


portfolio before change:  [-11.95131757]
curr_Stock_Price:  101.07294508435302
curr_Factors:  [101.07294508]
mat_Sqrt:  [[0.15]]
grads:  [0.09709388]
Stock Position:  0.09709387742106265
Bond Position:  [-21.76488171]


portfolio before change:  [-11.95097297]
curr_Stock_Price:  101.09050486156254
curr_Factors:  [101.09050486]
mat_Sqrt:  [[0.15]]
grads:  [0.1341203]
Stock Position:  0.13412030100532266
Bond Position:  [-25.50926191]


portfolio before change:  [-11.96874605]
curr_Stock_Price:  100.96987656493832
curr_Factors:  [100.96987656]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809903]
Stock Position:  -0.018099028655410722
Bond Position:  [-10.14128937]


portfolio before change:  [-11.9669061]
curr_Stock_Price:  100.83319472876626
curr_Factors:  [100.83319473]
mat_Sqrt:  [[0.15]]
grads:  [0.04418087]
Stock Position:  0.044180874123839545
Bond Position:  [-16.42180478]


portfolio before change:  [-11.92180007]
curr_Stock_Price:  101.87736659218639
curr_Factors:  [101.87736659]
mat_Sqrt:  [[0.15]]
grads:  [0.00133692]
Stock Position:  0.0013369206269706522
Bond Position:  [-12.05800202]


portfolio before change:  [-11.92270148]
curr_Stock_Price:  101.76684122848836
curr_Factors:  [101.76684123]
mat_Sqrt:  [[0.15]]
grads:  [0.0932635]
Stock Position:  0.09326349783645356
Bond Position:  [-21.41383306]


portfolio before change:  [-11.87736282]
curr_Stock_Price:  102.26732711868658
curr_Factors:  [102.26732712]
mat_Sqrt:  [[0.15]]
grads:  [0.16967356]
Stock Position:  0.16967355768818962
Bond Position:  [-29.22942405]


portfolio before change:  [-11.84029757]
curr_Stock_Price:  102.49654460580962
curr_Factors:  [102.49654461]
mat_Sqrt:  [[0.15]]
grads:  [-0.05590803]
Stock Position:  -0.055908026002911816
Bond Position:  [-6.10991809]


portfolio before change:  [-11.8234911]
curr_Stock_Price:  102.1891048597583
curr_Factors:  [102.18910486]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322425]
Stock Position:  -0.013224249513191384
Bond Position:  [-10.47211688]


portfolio before change:  [-11.83347052]
curr_Stock_Price:  102.89424067186506
curr_Factors:  [102.89424067]
mat_Sqrt:  [[0.15]]
grads:  [0.0943058]
Stock Position:  0.09430580459790414
Bond Position:  [-21.53699468]


portfolio before change:  [-11.89539752]
curr_Stock_Price:  102.25185294810103
curr_Factors:  [102.25185295]
mat_Sqrt:  [[0.15]]
grads:  [0.08942483]
Stock Position:  0.08942482996068662
Bond Position:  [-21.03925208]


portfolio before change:  [-11.90823821]
curr_Stock_Price:  102.12296595869682
curr_Factors:  [102.12296596]
mat_Sqrt:  [[0.15]]
grads:  [0.0232817]
Stock Position:  0.023281696414952577
Bond Position:  [-14.2858341]


portfolio before change:  [-11.90994804]
curr_Stock_Price:  102.08787643709711
curr_Factors:  [102.08787644]
mat_Sqrt:  [[0.15]]
grads:  [0.04319524]
Stock Position:  0.043195243411890016
Bond Position:  [-16.31965872]


portfolio before change:  [-11.89374926]
curr_Stock_Price:  102.48650356425678
curr_Factors:  [102.48650356]
mat_Sqrt:  [[0.15]]
grads:  [0.07006479]
Stock Position:  0.0700647856083993
Bond Position:  [-19.07444416]


portfolio before change:  [-11.93516319]
curr_Stock_Price:  101.91243853366731
curr_Factors:  [101.91243853]
mat_Sqrt:  [[0.15]]
grads:  [-0.1735329]
Stock Position:  -0.17353290322962217
Bond Position:  [5.74999814]


portfolio before change:  [-11.81853338]
curr_Stock_Price:  101.24241907026332
curr_Factors:  [101.24241907]
mat_Sqrt:  [[0.15]]
grads:  [0.01870307]
Stock Position:  0.018703074679046364
Bond Position:  [-13.71207791]


portfolio before change:  [-11.81922844]
curr_Stock_Price:  101.2510792980168
curr_Factors:  [101.2510793]
mat_Sqrt:  [[0.15]]
grads:  [-0.31577694]
Stock Position:  -0.3157769439422187
Bond Position:  [20.15352795]


portfolio before change:  [-11.60138471]
curr_Stock_Price:  100.56520244554291
curr_Factors:  [100.56520245]
mat_Sqrt:  [[0.15]]
grads:  [0.09878222]
Stock Position:  0.09878222277635164
Bond Position:  [-21.53543894]


portfolio before change:  [-11.71583769]
curr_Stock_Price:  99.42018896923047
curr_Factors:  [99.42018897]
mat_Sqrt:  [[0.15]]
grads:  [0.04801257]
Stock Position:  0.04801256542064756
Bond Position:  [-16.48925602]


portfolio before change:  [-11.70657829]
curr_Stock_Price:  99.63450825507113
curr_Factors:  [99.63450826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01261301]
Stock Position:  -0.012613011033635671
Bond Position:  [-10.44988713]


portfolio before change:  [-11.69909924]
curr_Stock_Price:  98.98976256848104
curr_Factors:  [98.98976257]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465159]
Stock Position:  -0.014651592490027369
Bond Position:  [-10.24874158]


portfolio before change:  [-11.70885073]
curr_Stock_Price:  99.61160090838615
curr_Factors:  [99.61160091]
mat_Sqrt:  [[0.15]]
grads:  [-0.01497909]
Stock Position:  -0.014979090409031268
Bond Position:  [-10.21675955]


portfolio before change:  [-11.70687692]
curr_Stock_Price:  99.43719935440765
curr_Factors:  [99.43719935]
mat_Sqrt:  [[0.15]]
grads:  [0.11687681]
Stock Position:  0.11687681291944042
Bond Position:  [-23.32877987]


portfolio before change:  [-11.676464]
curr_Stock_Price:  99.70988826488438
curr_Factors:  [99.70988826]
mat_Sqrt:  [[0.15]]
grads:  [0.10288964]
Stock Position:  0.10288963535322798
Bond Position:  [-21.93557805]


portfolio before change:  [-11.67225772]
curr_Stock_Price:  99.76409491219931
curr_Factors:  [99.76409491]
mat_Sqrt:  [[0.15]]
grads:  [0.0719492]
Stock Position:  0.07194920406726714
Bond Position:  [-18.85020494]


portfolio before change:  [-11.65629642]
curr_Stock_Price:  100.00231119455866
curr_Factors:  [100.00231119]
mat_Sqrt:  [[0.15]]
grads:  [0.02775726]
Stock Position:  0.027757259485854075
Bond Position:  [-14.43208652]


portfolio before change:  [-11.6560133]
curr_Stock_Price:  100.0450082191723
curr_Factors:  [100.04500822]
mat_Sqrt:  [[0.15]]
grads:  [0.05803589]
Stock Position:  0.05803589198677737
Bond Position:  [-17.46221459]


portfolio before change:  [-11.69287454]
curr_Stock_Price:  99.4286686177768
curr_Factors:  [99.42866862]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535834]
Stock Position:  -0.015358337574965176
Bond Position:  [-10.16581549]


portfolio before change:  [-11.68902581]
curr_Stock_Price:  99.13670227952191
curr_Factors:  [99.13670228]
mat_Sqrt:  [[0.15]]
grads:  [-0.04752627]
Stock Position:  -0.04752626743920447
Bond Position:  [-6.97742838]


portfolio before change:  [-11.7092165]
curr_Stock_Price:  99.55235858433127
curr_Factors:  [99.55235858]
mat_Sqrt:  [[0.15]]
grads:  [-0.0279126]
Stock Position:  -0.02791260199818973
Bond Position:  [-8.93045114]


portfolio before change:  [-11.72068974]
curr_Stock_Price:  99.94340309956351
curr_Factors:  [99.9434031]
mat_Sqrt:  [[0.15]]
grads:  [0.0137427]
Stock Position:  0.013742698581916669
Bond Position:  [-13.09418181]


portfolio before change:  [-11.70414658]
curr_Stock_Price:  101.20673375869853
curr_Factors:  [101.20673376]
mat_Sqrt:  [[0.15]]
grads:  [0.00752138]
Stock Position:  0.007521376863095404
Bond Position:  [-12.46536057]


portfolio before change:  [-11.7054221]
curr_Stock_Price:  101.14073389870593
curr_Factors:  [101.1407339]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424084]
Stock Position:  -0.02424083609567199
Bond Position:  [-9.25368615]


portfolio before change:  [-11.72448121]
curr_Stock_Price:  101.90311423742642
curr_Factors:  [101.90311424]
mat_Sqrt:  [[0.15]]
grads:  [-0.02226513]
Stock Position:  -0.022265126315190918
Bond Position:  [-9.4555955]


portfolio before change:  [-11.72747286]
curr_Stock_Price:  102.0109354224054
curr_Factors:  [102.01093542]
mat_Sqrt:  [[0.15]]
grads:  [0.07033799]
Stock Position:  0.07033798573049907
Bond Position:  [-18.90271658]


portfolio before change:  [-11.71196184]
curr_Stock_Price:  102.24825356952456
curr_Factors:  [102.24825357]
mat_Sqrt:  [[0.15]]
grads:  [-0.05156806]
Stock Position:  -0.051568059109582745
Bond Position:  [-6.43921785]


portfolio before change:  [-11.73377588]
curr_Stock_Price:  102.66346370566781
curr_Factors:  [102.66346371]
mat_Sqrt:  [[0.15]]
grads:  [0.03716577]
Stock Position:  0.037165772317395165
Bond Position:  [-15.5493428]


portfolio before change:  [-11.74379502]
curr_Stock_Price:  102.42003340364245
curr_Factors:  [102.4200334]
mat_Sqrt:  [[0.15]]
grads:  [-0.02604346]
Stock Position:  -0.026043456540857386
Bond Position:  [-9.07642333]


portfolio before change:  [-11.75162653]
curr_Stock_Price:  102.69896002694614
curr_Factors:  [102.69896003]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896739]
Stock Position:  -0.018967391596492328
Bond Position:  [-9.80369514]


portfolio before change:  [-11.75940294]
curr_Stock_Price:  103.07664290021499
curr_Factors:  [103.0766429]
mat_Sqrt:  [[0.15]]
grads:  [0.04711415]
Stock Position:  0.047114147191157314
Bond Position:  [-16.61577106]


portfolio before change:  [-11.75143308]
curr_Stock_Price:  103.26784596634013
curr_Factors:  [103.26784597]
mat_Sqrt:  [[0.15]]
grads:  [-0.12856803]
Stock Position:  -0.12856803457746807
Bond Position:  [1.52551091]


portfolio before change:  [-11.79980069]
curr_Stock_Price:  103.64478996135827
curr_Factors:  [103.64478996]
mat_Sqrt:  [[0.15]]
grads:  [0.00823357]
Stock Position:  0.00823357148178159
Bond Position:  [-12.65316747]


portfolio before change:  [-11.79173123]
curr_Stock_Price:  104.72090897900738
curr_Factors:  [104.72090898]
mat_Sqrt:  [[0.15]]
grads:  [0.08410459]
Stock Position:  0.08410458502524326
Bond Position:  [-20.59923982]


portfolio before change:  [-11.81367604]
curr_Stock_Price:  104.47529430652418
curr_Factors:  [104.47529431]
mat_Sqrt:  [[0.15]]
grads:  [0.09725527]
Stock Position:  0.09725526828593223
Bond Position:  [-21.97444882]


portfolio before change:  [-11.78594858]
curr_Stock_Price:  104.77451620423102
curr_Factors:  [104.7745162]
mat_Sqrt:  [[0.15]]
grads:  [0.032156]
Stock Position:  0.03215600245895005
Bond Position:  [-15.15507818]


portfolio before change:  [-11.78249757]
curr_Stock_Price:  104.91129430501378
curr_Factors:  [104.91129431]
mat_Sqrt:  [[0.15]]
grads:  [0.08418078]
Stock Position:  0.08418077553280778
Bond Position:  [-20.61401169]


portfolio before change:  [-11.78247727]
curr_Stock_Price:  104.92684080312414
curr_Factors:  [104.9268408]
mat_Sqrt:  [[0.15]]
grads:  [0.04832058]
Stock Position:  0.04832057871842554
Bond Position:  [-16.85260294]


portfolio before change:  [-11.81447319]
curr_Stock_Price:  104.28648012674415
curr_Factors:  [104.28648013]
mat_Sqrt:  [[0.15]]
grads:  [0.07455321]
Stock Position:  0.07455320604414165
Bond Position:  [-19.58936463]


portfolio before change:  [-11.80242737]
curr_Stock_Price:  104.4644763523762
curr_Factors:  [104.46447635]
mat_Sqrt:  [[0.15]]
grads:  [0.01332799]
Stock Position:  0.013327994299291985
Bond Position:  [-13.19472932]


portfolio before change:  [-11.80533504]
curr_Stock_Price:  104.3081906417056
curr_Factors:  [104.30819064]
mat_Sqrt:  [[0.15]]
grads:  [-0.10168776]
Stock Position:  -0.10168775954119749
Bond Position:  [-1.19846883]


portfolio before change:  [-11.76108891]
curr_Stock_Price:  103.87233640819953
curr_Factors:  [103.87233641]
mat_Sqrt:  [[0.15]]
grads:  [-0.04618973]
Stock Position:  -0.04618973278913176
Bond Position:  [-6.96325345]


portfolio before change:  [-11.75348512]
curr_Stock_Price:  103.69829334305193
curr_Factors:  [103.69829334]
mat_Sqrt:  [[0.15]]
grads:  [0.00700032]
Stock Position:  0.007000316077735453
Bond Position:  [-12.47940595]


portfolio before change:  [-11.75049039]
curr_Stock_Price:  104.23751458798505
curr_Factors:  [104.23751459]
mat_Sqrt:  [[0.15]]
grads:  [0.01245404]
Stock Position:  0.012454041445862624
Bond Position:  [-13.04866872]


portfolio before change:  [-11.74994693]
curr_Stock_Price:  104.34663807567303
curr_Factors:  [104.34663808]
mat_Sqrt:  [[0.15]]
grads:  [-0.13002531]
Stock Position:  -0.13002530906321738
Bond Position:  [1.81775694]


portfolio before change:  [-11.70427595]
curr_Stock_Price:  103.99626502601353
curr_Factors:  [103.99626503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02454272]
Stock Position:  -0.024542715302107197
Bond Position:  [-9.15192523]


portfolio before change:  [-11.72434417]
curr_Stock_Price:  104.7906434871627
curr_Factors:  [104.79064349]
mat_Sqrt:  [[0.15]]
grads:  [0.07889267]
Stock Position:  0.07889267329082683
Bond Position:  [-19.99155817]


portfolio before change:  [-11.79832709]
curr_Stock_Price:  103.86871496947295
curr_Factors:  [103.86871497]
mat_Sqrt:  [[0.15]]
grads:  [-0.03501421]
Stock Position:  -0.03501421077389262
Bond Position:  [-8.16144601]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.79308108]
Stock Price:  103.70432125255795
PL:  [-15.49740233]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.38065185e-02]
 [ 1.43862375e-02]
 [ 2.14693966e-02]
 [-2.92616812e-02]
 [-2.72291159e-02]
 [-2.23135685e-03]
 [-4.70804229e-03]
 [-2.61550978e-02]
 [ 9.71561020e-03]
 [ 1.03269996e-03]
 [-4.63463845e-03]
 [-2.76500817e-03]
 [-1.61428029e-04]
 [ 8.05029378e-03]
 [-1.90444114e-05]
 [ 1.21505538e-02]
 [ 2.58910942e-02]
 [-1.48886793e-02]
 [ 2.22168704e-02]
 [-2.15395496e-03]
 [-1.78034454e-02]
 [ 5.77643975e-03]
 [ 1.23495595e-02]
 [ 2.08848381e-02]
 [-5.17110744e-03]
 [ 4.66371429e-03]
 [ 7.22097527e-03]
 [ 8.81034684e-03]
 [ 1.56555207e-02]
 [ 1.36984983e-03]
 [-6.68430650e-03]
 [ 1.00999908e-02]
 [ 1.20684723e-02]
 [-6.04530886e-03]
 [-3.25587533e-03]
 [ 1.81908233e-02]
 [-2.94141121e-03]
 [ 3.17730509e-03]
 [-5.40713651e-02]
 [ 8.78726414e-03]
 [ 7.20154213e-03]
 [-4.64524179e-04]
 [-2.11889109e-03]
 [-1.65995585e-03]
 [ 2.29559604e-03]
 [ 1.47146433e-02]
 [ 1.07986462e-02]
 [ 4.44619863e-03]
 [ 4.16099654e-03]
 [-2.19817930e-03]
 [-2.22900360e-03]
 [-7.80453222e-03]
 [ 1.77571295e-03]
 [ 8.66912312e-03]
 [-7.27541309e-03]
 [-4.38833403e-03]
 [ 1.36312691e-03]
 [ 1.01623906e-02]
 [ 7.64157301e-03]
 [-3.93429804e-03]
 [-1.66318993e-03]
 [ 4.81330678e-03]
 [-8.73137638e-03]
 [ 7.87187046e-03]
 [ 2.54862628e-02]
 [ 5.42041061e-03]
 [ 1.47785922e-02]
 [ 3.23050599e-03]
 [ 3.69259741e-03]
 [ 1.69142152e-02]
 [ 7.15351758e-04]
 [-1.55649737e-02]
 [-1.77370972e-03]
 [ 1.25882209e-03]
 [ 9.32161695e-04]
 [-1.37859187e-02]
 [-4.13743235e-03]
 [ 1.45704044e-02]
 [-4.75003642e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.83570842]
curr_Stock_Price:  99.86984941434997
curr_Factors:  [99.86984941]
mat_Sqrt:  [[0.15]]
grads:  [-0.09204346]
Stock Position:  -0.09204345686201292
Bond Position:  [8.35665776]


portfolio before change:  [-0.86579745]
curr_Stock_Price:  100.20242429423833
curr_Factors:  [100.20242429]
mat_Sqrt:  [[0.15]]
grads:  [0.09590825]
Stock Position:  0.09590825021819675
Bond Position:  [-10.47603664]


portfolio before change:  [-0.81889236]
curr_Stock_Price:  100.69831350185126
curr_Factors:  [100.6983135]
mat_Sqrt:  [[0.15]]
grads:  [0.14312931]
Stock Position:  0.1431293109662103
Bond Position:  [-15.23177259]


portfolio before change:  [-0.71876511]
curr_Stock_Price:  101.40452289715601
curr_Factors:  [101.4045229]
mat_Sqrt:  [[0.15]]
grads:  [-0.19507787]
Stock Position:  -0.1950778748539683
Bond Position:  [19.06301372]


portfolio before change:  [-0.68217545]
curr_Stock_Price:  101.2230661997448
curr_Factors:  [101.2230662]
mat_Sqrt:  [[0.15]]
grads:  [-0.18152744]
Stock Position:  -0.18152743943321217
Bond Position:  [17.69258857]


portfolio before change:  [-0.5503942]
curr_Stock_Price:  100.50320020142422
curr_Factors:  [100.5032002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487571]
Stock Position:  -0.014875712339311066
Bond Position:  [0.9446625]


portfolio before change:  [-0.55152928]
curr_Stock_Price:  100.58347387049349
curr_Factors:  [100.58347387]
mat_Sqrt:  [[0.15]]
grads:  [-0.03138695]
Stock Position:  -0.03138694861930475
Bond Position:  [2.60547904]


portfolio before change:  [-0.56039981]
curr_Stock_Price:  100.87128058950157
curr_Factors:  [100.87128059]
mat_Sqrt:  [[0.15]]
grads:  [-0.17436732]
Stock Position:  -0.17436731835182764
Bond Position:  [17.02825489]


portfolio before change:  [-0.5869774]
curr_Stock_Price:  101.02980737750727
curr_Factors:  [101.02980738]
mat_Sqrt:  [[0.15]]
grads:  [0.06477073]
Stock Position:  0.06477073469490396
Bond Position:  [-7.13075225]


portfolio before change:  [-0.60464751]
curr_Stock_Price:  100.76387833415818
curr_Factors:  [100.76387833]
mat_Sqrt:  [[0.15]]
grads:  [0.00688467]
Stock Position:  0.006884666398157847
Bond Position:  [-1.29837319]


portfolio before change:  [-0.60304465]
curr_Stock_Price:  101.00848089332771
curr_Factors:  [101.00848089]
mat_Sqrt:  [[0.15]]
grads:  [-0.03089759]
Stock Position:  -0.03089758967881863
Bond Position:  [2.51787395]


portfolio before change:  [-0.57269628]
curr_Stock_Price:  100.03134957140797
curr_Factors:  [100.03134957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01843339]
Stock Position:  -0.01843338776917971
Bond Position:  [1.27122038]


portfolio before change:  [-0.55124207]
curr_Stock_Price:  98.8717822005212
curr_Factors:  [98.8717822]
mat_Sqrt:  [[0.15]]
grads:  [-0.00107619]
Stock Position:  -0.0010761868633287742
Bond Position:  [-0.44483755]


portfolio before change:  [-0.55207567]
curr_Stock_Price:  99.6205353097203
curr_Factors:  [99.62053531]
mat_Sqrt:  [[0.15]]
grads:  [0.05366863]
Stock Position:  0.05366862519967428
Bond Position:  [-5.89857284]


portfolio before change:  [-0.56354002]
curr_Stock_Price:  99.41379114374651
curr_Factors:  [99.41379114]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012696]
Stock Position:  -0.0001269627428203991
Bond Position:  [-0.55091817]


portfolio before change:  [-0.56359921]
curr_Stock_Price:  99.60880282891128
curr_Factors:  [99.60880283]
mat_Sqrt:  [[0.15]]
grads:  [0.08100369]
Stock Position:  0.08100369173487153
Bond Position:  [-8.63227997]


portfolio before change:  [-0.57186014]
curr_Stock_Price:  99.51348126709416
curr_Factors:  [99.51348127]
mat_Sqrt:  [[0.15]]
grads:  [0.17260729]
Stock Position:  0.17260729476008163
Bond Position:  [-17.74861293]


portfolio before change:  [-0.52505222]
curr_Stock_Price:  99.79108973556893
curr_Factors:  [99.79108974]
mat_Sqrt:  [[0.15]]
grads:  [-0.09925786]
Stock Position:  -0.09925786223065773
Bond Position:  [9.37999802]


portfolio before change:  [-0.47223304]
curr_Stock_Price:  99.26485527933434
curr_Factors:  [99.26485528]
mat_Sqrt:  [[0.15]]
grads:  [0.14811247]
Stock Position:  0.148112469434727
Bond Position:  [-15.17459589]


portfolio before change:  [-0.68737642]
curr_Stock_Price:  97.81869117245719
curr_Factors:  [97.81869117]
mat_Sqrt:  [[0.15]]
grads:  [-0.0143597]
Stock Position:  -0.014359699715600185
Bond Position:  [0.71727061]


portfolio before change:  [-0.67626896]
curr_Stock_Price:  97.04829702087895
curr_Factors:  [97.04829702]
mat_Sqrt:  [[0.15]]
grads:  [-0.11868964]
Stock Position:  -0.11868963609791636
Bond Position:  [10.8423581]


portfolio before change:  [-0.65897076]
curr_Stock_Price:  96.90826345175279
curr_Factors:  [96.90826345]
mat_Sqrt:  [[0.15]]
grads:  [0.0385096]
Stock Position:  0.038509598318343545
Bond Position:  [-4.39086906]


portfolio before change:  [-0.64237427]
curr_Stock_Price:  97.34636017274828
curr_Factors:  [97.34636017]
mat_Sqrt:  [[0.15]]
grads:  [0.0823304]
Stock Position:  0.08233039634886308
Bond Position:  [-8.65693868]


portfolio before change:  [-0.60441399]
curr_Stock_Price:  97.81400462993192
curr_Factors:  [97.81400463]
mat_Sqrt:  [[0.15]]
grads:  [0.13923225]
Stock Position:  0.13923225412762666
Bond Position:  [-14.22327834]


portfolio before change:  [-0.50310739]
curr_Stock_Price:  98.54799822986716
curr_Factors:  [98.54799823]
mat_Sqrt:  [[0.15]]
grads:  [-0.03447405]
Stock Position:  -0.03447404960107045
Bond Position:  [2.89424119]


portfolio before change:  [-0.51349301]
curr_Stock_Price:  98.85450469309023
curr_Factors:  [98.85450469]
mat_Sqrt:  [[0.15]]
grads:  [0.03109143]
Stock Position:  0.03109142857690274
Bond Position:  [-3.58702079]


portfolio before change:  [-0.5323735]
curr_Stock_Price:  98.25445871734499
curr_Factors:  [98.25445872]
mat_Sqrt:  [[0.15]]
grads:  [0.04813984]
Stock Position:  0.0481398351254187
Bond Position:  [-5.26232694]


portfolio before change:  [-0.53055568]
curr_Stock_Price:  98.29905207038335
curr_Factors:  [98.29905207]
mat_Sqrt:  [[0.15]]
grads:  [0.05873565]
Stock Position:  0.05873564556950656
Bond Position:  [-6.30421397]


portfolio before change:  [-0.49530493]
curr_Stock_Price:  98.90591999924447
curr_Factors:  [98.90592]
mat_Sqrt:  [[0.15]]
grads:  [0.10437014]
Stock Position:  0.10437013782267561
Bond Position:  [-10.81812943]


portfolio before change:  [-0.42084829]
curr_Stock_Price:  99.6257886516124
curr_Factors:  [99.62578865]
mat_Sqrt:  [[0.15]]
grads:  [0.00913233]
Stock Position:  0.009132332186764144
Bond Position:  [-1.33066409]


portfolio before change:  [-0.42351279]
curr_Stock_Price:  99.34313070164004
curr_Factors:  [99.3431307]
mat_Sqrt:  [[0.15]]
grads:  [-0.04456204]
Stock Position:  -0.04456204333694811
Bond Position:  [4.00342011]


portfolio before change:  [-0.40630444]
curr_Stock_Price:  98.96257977836763
curr_Factors:  [98.96257978]
mat_Sqrt:  [[0.15]]
grads:  [0.06733327]
Stock Position:  0.06733327232193967
Bond Position:  [-7.06977878]


portfolio before change:  [-0.34767854]
curr_Stock_Price:  99.83982475564805
curr_Factors:  [99.83982476]
mat_Sqrt:  [[0.15]]
grads:  [0.08045648]
Stock Position:  0.08045648232439147
Bond Position:  [-8.38043964]


portfolio before change:  [-0.35967064]
curr_Stock_Price:  99.69728426684328
curr_Factors:  [99.69728427]
mat_Sqrt:  [[0.15]]
grads:  [-0.04030206]
Stock Position:  -0.04030205904318622
Bond Position:  [3.6583352]


portfolio before change:  [-0.30637519]
curr_Stock_Price:  98.3805574802861
curr_Factors:  [98.38055748]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170584]
Stock Position:  -0.021705835554728995
Bond Position:  [1.82905701]


portfolio before change:  [-0.3308182]
curr_Stock_Price:  99.51192741258251
curr_Factors:  [99.51192741]
mat_Sqrt:  [[0.15]]
grads:  [0.12127216]
Stock Position:  0.12127215502003011
Bond Position:  [-12.39884409]


portfolio before change:  [-0.35119908]
curr_Stock_Price:  99.35025852259905
curr_Factors:  [99.35025852]
mat_Sqrt:  [[0.15]]
grads:  [-0.01960941]
Stock Position:  -0.019609408082564724
Bond Position:  [1.59700068]


portfolio before change:  [-0.35650424]
curr_Stock_Price:  99.625889810527
curr_Factors:  [99.62588981]
mat_Sqrt:  [[0.15]]
grads:  [0.02118203]
Stock Position:  0.02118203390525283
Bond Position:  [-2.46678321]


portfolio before change:  [-0.35991693]
curr_Stock_Price:  99.47205575432591
curr_Factors:  [99.47205575]
mat_Sqrt:  [[0.15]]
grads:  [-0.36047577]
Stock Position:  -0.36047576723179925
Bond Position:  [35.49734868]


portfolio before change:  [-0.65219599]
curr_Stock_Price:  100.28902527171813
curr_Factors:  [100.28902527]
mat_Sqrt:  [[0.15]]
grads:  [0.05858176]
Stock Position:  0.05858176090257332
Bond Position:  [-6.52730369]


portfolio before change:  [-0.70395687]
curr_Stock_Price:  99.41242284917897
curr_Factors:  [99.41242285]
mat_Sqrt:  [[0.15]]
grads:  [0.04801028]
Stock Position:  0.048010280891228066
Bond Position:  [-5.47677522]


portfolio before change:  [-0.69783972]
curr_Stock_Price:  99.54696617754924
curr_Factors:  [99.54696618]
mat_Sqrt:  [[0.15]]
grads:  [-0.00309683]
Stock Position:  -0.0030968278611245154
Bond Position:  [-0.3895599]


portfolio before change:  [-0.6964439]
curr_Stock_Price:  99.08837816443426
curr_Factors:  [99.08837816]
mat_Sqrt:  [[0.15]]
grads:  [-0.01412594]
Stock Position:  -0.014125940566893758
Bond Position:  [0.70327264]


portfolio before change:  [-0.70029797]
curr_Stock_Price:  99.36432583383119
curr_Factors:  [99.36432583]
mat_Sqrt:  [[0.15]]
grads:  [-0.01106637]
Stock Position:  -0.01106637231482146
Bond Position:  [0.39930466]


portfolio before change:  [-0.69051178]
curr_Stock_Price:  98.48226355899006
curr_Factors:  [98.48226356]
mat_Sqrt:  [[0.15]]
grads:  [0.01530397]
Stock Position:  0.015303973628983104
Bond Position:  [-2.19768174]


portfolio before change:  [-0.68239894]
curr_Stock_Price:  99.02135230775477
curr_Factors:  [99.02135231]
mat_Sqrt:  [[0.15]]
grads:  [0.09809762]
Stock Position:  0.09809762211862866
Bond Position:  [-10.39615814]


portfolio before change:  [-0.60455967]
curr_Stock_Price:  99.82146394187048
curr_Factors:  [99.82146394]
mat_Sqrt:  [[0.15]]
grads:  [0.07199097]
Stock Position:  0.0719909749722684
Bond Position:  [-7.79080418]


portfolio before change:  [-0.6218093]
curr_Stock_Price:  99.58861961774326
curr_Factors:  [99.58861962]
mat_Sqrt:  [[0.15]]
grads:  [0.02964132]
Stock Position:  0.02964132417748285
Bond Position:  [-3.57374786]


portfolio before change:  [-0.632206]
curr_Stock_Price:  99.24540506809264
curr_Factors:  [99.24540507]
mat_Sqrt:  [[0.15]]
grads:  [0.02773998]
Stock Position:  0.027739976912536907
Bond Position:  [-3.38527125]


portfolio before change:  [-0.63528924]
curr_Stock_Price:  99.14188450947994
curr_Factors:  [99.14188451]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465453]
Stock Position:  -0.014654528682763249
Bond Position:  [0.81758835]


portfolio before change:  [-0.64648756]
curr_Stock_Price:  99.90952579837993
curr_Factors:  [99.9095258]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486002]
Stock Position:  -0.014860023969449193
Bond Position:  [0.83817038]


portfolio before change:  [-0.64893514]
curr_Stock_Price:  100.07775960399489
curr_Factors:  [100.0777596]
mat_Sqrt:  [[0.15]]
grads:  [-0.05203021]
Stock Position:  -0.05203021481735538
Bond Position:  [4.5581322]


portfolio before change:  [-0.61450435]
curr_Stock_Price:  99.42148909754916
curr_Factors:  [99.4214891]
mat_Sqrt:  [[0.15]]
grads:  [0.01183809]
Stock Position:  0.0118380863532416
Bond Position:  [-1.79146452]


portfolio before change:  [-0.62386172]
curr_Stock_Price:  98.64050099505876
curr_Factors:  [98.640501]
mat_Sqrt:  [[0.15]]
grads:  [0.05779415]
Stock Position:  0.057794154105440754
Bond Position:  [-6.32470604]


portfolio before change:  [-0.60989699]
curr_Stock_Price:  98.88896978312351
curr_Factors:  [98.88896978]
mat_Sqrt:  [[0.15]]
grads:  [-0.04850275]
Stock Position:  -0.04850275391956347
Bond Position:  [4.18649038]


portfolio before change:  [-0.61505247]
curr_Stock_Price:  99.00065719736041
curr_Factors:  [99.0006572]
mat_Sqrt:  [[0.15]]
grads:  [-0.02925556]
Stock Position:  -0.02925556020129576
Bond Position:  [2.28126722]


portfolio before change:  [-0.61273549]
curr_Stock_Price:  98.92633297573022
curr_Factors:  [98.92633298]
mat_Sqrt:  [[0.15]]
grads:  [0.00908751]
Stock Position:  0.009087512753746398
Bond Position:  [-1.5117298]


portfolio before change:  [-0.61642323]
curr_Stock_Price:  98.53092746045556
curr_Factors:  [98.53092746]
mat_Sqrt:  [[0.15]]
grads:  [0.06774927]
Stock Position:  0.06774927064572486
Bond Position:  [-7.2918217]


portfolio before change:  [-0.61439359]
curr_Stock_Price:  98.56761265221677
curr_Factors:  [98.56761265]
mat_Sqrt:  [[0.15]]
grads:  [0.05094382]
Stock Position:  0.05094382007558695
Bond Position:  [-5.63580431]


portfolio before change:  [-0.61268825]
curr_Stock_Price:  98.60800199184416
curr_Factors:  [98.60800199]
mat_Sqrt:  [[0.15]]
grads:  [-0.02622865]
Stock Position:  -0.02622865361860927
Bond Position:  [1.97366688]


portfolio before change:  [-0.62157153]
curr_Stock_Price:  98.95139137550984
curr_Factors:  [98.95139138]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108793]
Stock Position:  -0.011087932870319452
Bond Position:  [0.47559485]


portfolio before change:  [-0.6329704]
curr_Stock_Price:  99.982115368905
curr_Factors:  [99.98211537]
mat_Sqrt:  [[0.15]]
grads:  [0.03208871]
Stock Position:  0.032088711892237214
Bond Position:  [-3.8412677]


portfolio before change:  [-0.61233686]
curr_Stock_Price:  100.6326131056092
curr_Factors:  [100.63261311]
mat_Sqrt:  [[0.15]]
grads:  [-0.05820918]
Stock Position:  -0.05820917586839969
Bond Position:  [5.24540462]


portfolio before change:  [-0.61115887]
curr_Stock_Price:  100.61800822383316
curr_Factors:  [100.61800822]
mat_Sqrt:  [[0.15]]
grads:  [0.05247914]
Stock Position:  0.05247913639155537
Bond Position:  [-5.89150505]


portfolio before change:  [-0.57146365]
curr_Stock_Price:  101.3814250054928
curr_Factors:  [101.38142501]
mat_Sqrt:  [[0.15]]
grads:  [0.16990842]
Stock Position:  0.16990841851190241
Bond Position:  [-17.79702124]


portfolio before change:  [-0.55459371]
curr_Stock_Price:  101.48726015181933
curr_Factors:  [101.48726015]
mat_Sqrt:  [[0.15]]
grads:  [0.03613607]
Stock Position:  0.036136070740160155
Bond Position:  [-4.22194452]


portfolio before change:  [-0.52895057]
curr_Stock_Price:  102.20418974149356
curr_Factors:  [102.20418974]
mat_Sqrt:  [[0.15]]
grads:  [0.09852395]
Stock Position:  0.09852394815855257
Bond Position:  [-10.59851087]


portfolio before change:  [-0.59597887]
curr_Stock_Price:  101.53058830212947
curr_Factors:  [101.5305883]
mat_Sqrt:  [[0.15]]
grads:  [0.02153671]
Stock Position:  0.021536706568119134
Bond Position:  [-2.78261336]


portfolio before change:  [-0.58437667]
curr_Stock_Price:  102.0773812923888
curr_Factors:  [102.07738129]
mat_Sqrt:  [[0.15]]
grads:  [0.02461732]
Stock Position:  0.024617316078981818
Bond Position:  [-3.09724783]


portfolio before change:  [-0.57522638]
curr_Stock_Price:  102.45694664637146
curr_Factors:  [102.45694665]
mat_Sqrt:  [[0.15]]
grads:  [0.11276143]
Stock Position:  0.11276143464277417
Bond Position:  [-12.12841867]


portfolio before change:  [-0.55463645]
curr_Stock_Price:  102.6462664669565
curr_Factors:  [102.64626647]
mat_Sqrt:  [[0.15]]
grads:  [0.00476901]
Stock Position:  0.0047690117196729324
Bond Position:  [-1.0441577]


portfolio before change:  [-0.55687687]
curr_Stock_Price:  102.19016465810512
curr_Factors:  [102.19016466]
mat_Sqrt:  [[0.15]]
grads:  [-0.10376649]
Stock Position:  -0.10376649160398504
Bond Position:  [10.04703799]


portfolio before change:  [-0.57589167]
curr_Stock_Price:  102.37946240216439
curr_Factors:  [102.3794624]
mat_Sqrt:  [[0.15]]
grads:  [-0.01182473]
Stock Position:  -0.01182473147035873
Bond Position:  [0.63471798]


portfolio before change:  [-0.57467829]
curr_Stock_Price:  102.28020331529017
curr_Factors:  [102.28020332]
mat_Sqrt:  [[0.15]]
grads:  [0.00839215]
Stock Position:  0.008392147249886683
Bond Position:  [-1.43302882]


portfolio before change:  [-0.58222402]
curr_Stock_Price:  101.39173406470705
curr_Factors:  [101.39173406]
mat_Sqrt:  [[0.15]]
grads:  [0.00621441]
Stock Position:  0.006214411300341852
Bond Position:  [-1.21231396]


portfolio before change:  [-0.57860143]
curr_Stock_Price:  101.98686058244137
curr_Factors:  [101.98686058]
mat_Sqrt:  [[0.15]]
grads:  [-0.09190612]
Stock Position:  -0.09190612498812785
Bond Position:  [8.79461572]


portfolio before change:  [-0.579932]
curr_Stock_Price:  102.00731895298318
curr_Factors:  [102.00731895]
mat_Sqrt:  [[0.15]]
grads:  [-0.02758288]
Stock Position:  -0.027582882339094342
Bond Position:  [2.23372388]


portfolio before change:  [-0.59137859]
curr_Stock_Price:  102.4273692151724
curr_Factors:  [102.42736922]
mat_Sqrt:  [[0.15]]
grads:  [0.09713603]
Stock Position:  0.09713602941029838
Bond Position:  [-10.54076653]


portfolio before change:  [-0.60045865]
curr_Stock_Price:  102.3406737862381
curr_Factors:  [102.34067379]
mat_Sqrt:  [[0.15]]
grads:  [-0.03166691]
Stock Position:  -0.031666909452595565
Bond Position:  [2.6403542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.60841578]
Stock Price:  102.59716071994617
PL:  [-3.2055765]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 3.30265892e+00]
 [-1.32305386e-02]
 [-1.93069957e-02]
 [ 4.45888757e-03]
 [-7.51028490e-03]
 [-2.78140018e-02]
 [-1.28183140e-03]
 [ 5.44376471e-03]
 [-3.91216744e-02]
 [ 1.48664453e-02]
 [-6.55305542e-03]
 [-9.54902631e-03]
 [ 1.42535718e-02]
 [-3.56823169e-03]
 [ 5.43312942e-03]
 [ 5.55503422e-03]
 [ 1.17428825e-02]
 [ 8.69533938e-02]
 [-1.43670191e-02]
 [ 1.76016198e-02]
 [ 1.39939009e-03]
 [-5.59148728e-03]
 [ 5.73874749e-03]
 [ 5.46004759e-03]
 [ 4.34423915e-02]
 [ 3.19206887e-03]
 [ 8.36818215e-03]
 [ 4.69538426e-02]
 [ 2.84139547e-02]
 [ 3.91129238e-03]
 [-8.72020049e-03]
 [ 6.49732863e-03]
 [ 1.66087744e-02]
 [ 1.75797427e-02]
 [-1.16784703e-02]
 [ 3.85072411e-03]
 [-1.94832311e-02]
 [-9.08547097e-03]
 [-1.48397233e-02]
 [-5.33563860e-04]
 [-3.61474317e-02]
 [ 3.55267883e-03]
 [ 6.72497912e-03]
 [-9.34994112e-03]
 [ 8.54561013e-03]
 [ 2.41550270e-04]
 [ 1.16060323e-02]
 [ 1.05633226e-02]
 [-3.09875268e-03]
 [ 1.46197635e-02]
 [-1.51523395e-03]
 [ 1.88122017e-02]
 [ 2.18583479e-02]
 [-7.42857612e-03]
 [-5.25795139e-02]
 [-1.47633521e-02]
 [-2.19040987e-03]
 [-3.89816388e-03]
 [-1.36430280e-02]
 [ 3.22009908e-04]
 [-3.08207272e-03]
 [-7.52391994e-03]
 [-4.22689055e-03]
 [-1.70973888e-02]
 [-3.58500888e-04]
 [-9.55722671e-03]
 [ 3.07981136e-02]
 [-4.55204070e-03]
 [ 1.95939154e-02]
 [ 8.60124606e-03]
 [ 1.13996696e-02]
 [ 6.13621705e-03]
 [-1.47882461e-02]
 [-2.18444047e-02]
 [ 9.01803897e-04]
 [ 2.52361927e-03]
 [-1.81372919e-02]
 [-3.65629863e-03]
 [ 1.22417359e-02]
 [-4.86128724e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [3.30265892]
mat_Sqrt:  [[0.15]]
grads:  [22.01772613]
init_Out:  [2.16739115]
Stock Position:  22.017726125320124
Bond position:  [-2199.60522138]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.79584002]
curr_Stock_Price:  99.5083165496097
curr_Factors:  [99.50831655]
mat_Sqrt:  [[0.15]]
grads:  [-0.08820359]
Stock Position:  -0.08820359049446762
Bond Position:  [-0.01884922]


portfolio before change:  [-8.74672347]
curr_Stock_Price:  98.95144885816956
curr_Factors:  [98.95144886]
mat_Sqrt:  [[0.15]]
grads:  [-0.1287133]
Stock Position:  -0.12871330495179764
Bond Position:  [3.98964454]


portfolio before change:  [-8.85628324]
curr_Stock_Price:  99.80457845965523
curr_Factors:  [99.80457846]
mat_Sqrt:  [[0.15]]
grads:  [0.02972592]
Stock Position:  0.02972591715192388
Bond Position:  [-11.82306587]


portfolio before change:  [-8.84286099]
curr_Stock_Price:  100.28097146287452
curr_Factors:  [100.28097146]
mat_Sqrt:  [[0.15]]
grads:  [-0.05006857]
Stock Position:  -0.05006856598605755
Bond Position:  [-3.82193655]


portfolio before change:  [-8.89122816]
curr_Stock_Price:  101.2422191695252
curr_Factors:  [101.24221917]
mat_Sqrt:  [[0.15]]
grads:  [-0.18542668]
Stock Position:  -0.1854266788558937
Bond Position:  [9.8817803]


portfolio before change:  [-8.97852975]
curr_Stock_Price:  101.71636466246072
curr_Factors:  [101.71636466]
mat_Sqrt:  [[0.15]]
grads:  [-0.00854554]
Stock Position:  -0.008545542672231914
Bond Position:  [-8.10930822]


portfolio before change:  [-8.98061873]
curr_Stock_Price:  101.90150523587337
curr_Factors:  [101.90150524]
mat_Sqrt:  [[0.15]]
grads:  [0.03629176]
Stock Position:  0.03629176472867867
Bond Position:  [-12.67880418]


portfolio before change:  [-8.98912893]
curr_Stock_Price:  101.68884677869389
curr_Factors:  [101.68884678]
mat_Sqrt:  [[0.15]]
grads:  [-0.26081116]
Stock Position:  -0.26081116249789893
Bond Position:  [17.53245742]


portfolio before change:  [-8.93899027]
curr_Stock_Price:  101.50080711463349
curr_Factors:  [101.50080711]
mat_Sqrt:  [[0.15]]
grads:  [0.09910964]
Stock Position:  0.09910963547940874
Bond Position:  [-18.99869826]


portfolio before change:  [-8.89102173]
curr_Stock_Price:  101.99678305212193
curr_Factors:  [101.99678305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04368704]
Stock Position:  -0.04368703613106853
Bond Position:  [-4.43508459]


portfolio before change:  [-8.87988605]
curr_Stock_Price:  101.73554109508227
curr_Factors:  [101.7355411]
mat_Sqrt:  [[0.15]]
grads:  [-0.06366018]
Stock Position:  -0.06366017540391372
Bond Position:  [-2.40338366]


portfolio before change:  [-8.869511]
curr_Stock_Price:  101.57020591377963
curr_Factors:  [101.57020591]
mat_Sqrt:  [[0.15]]
grads:  [0.09502381]
Stock Position:  0.0950238121654525
Bond Position:  [-18.52109916]


portfolio before change:  [-8.8934824]
curr_Stock_Price:  101.33012087794563
curr_Factors:  [101.33012088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02378821]
Stock Position:  -0.023788211263853175
Bond Position:  [-6.48302007]


portfolio before change:  [-8.89384235]
curr_Stock_Price:  101.32821897834333
curr_Factors:  [101.32821898]
mat_Sqrt:  [[0.15]]
grads:  [0.03622086]
Stock Position:  0.0362208627769092
Bond Position:  [-12.56403787]


portfolio before change:  [-8.86044247]
curr_Stock_Price:  102.27201646576634
curr_Factors:  [102.27201647]
mat_Sqrt:  [[0.15]]
grads:  [0.03703356]
Stock Position:  0.03703356144420199
Bond Position:  [-12.64793948]


portfolio before change:  [-8.86994365]
curr_Stock_Price:  102.03680669302963
curr_Factors:  [102.03680669]
mat_Sqrt:  [[0.15]]
grads:  [0.07828588]
Stock Position:  0.07828588318746525
Bond Position:  [-16.85798518]


portfolio before change:  [-8.88633346]
curr_Stock_Price:  101.84090732281011
curr_Factors:  [101.84090732]
mat_Sqrt:  [[0.15]]
grads:  [0.57968929]
Stock Position:  0.5796892922463681
Bond Position:  [-67.92241695]


portfolio before change:  [-9.38151826]
curr_Stock_Price:  100.99400620131514
curr_Factors:  [100.9940062]
mat_Sqrt:  [[0.15]]
grads:  [-0.09578013]
Stock Position:  -0.09578012722045987
Bond Position:  [0.29170051]


portfolio before change:  [-9.37501527]
curr_Stock_Price:  100.9263015735722
curr_Factors:  [100.92630157]
mat_Sqrt:  [[0.15]]
grads:  [0.11734413]
Stock Position:  0.11734413186646522
Bond Position:  [-21.21812451]


portfolio before change:  [-9.30006442]
curr_Stock_Price:  101.57632996668674
curr_Factors:  [101.57632997]
mat_Sqrt:  [[0.15]]
grads:  [0.00932927]
Stock Position:  0.009329267296660877
Bond Position:  [-10.24769716]


portfolio before change:  [-9.29308896]
curr_Stock_Price:  102.39268189116778
curr_Factors:  [102.39268189]
mat_Sqrt:  [[0.15]]
grads:  [-0.03727658]
Stock Position:  -0.0372765818534167
Bond Position:  [-5.47623977]


portfolio before change:  [-9.30791083]
curr_Stock_Price:  102.7811187148362
curr_Factors:  [102.78111871]
mat_Sqrt:  [[0.15]]
grads:  [0.03825832]
Stock Position:  0.03825831658169768
Bond Position:  [-13.24014341]


portfolio before change:  [-9.30476067]
curr_Stock_Price:  102.88508816836644
curr_Factors:  [102.88508817]
mat_Sqrt:  [[0.15]]
grads:  [0.03640032]
Stock Position:  0.036400317238914556
Bond Position:  [-13.04981052]


portfolio before change:  [-9.29078908]
curr_Stock_Price:  103.29132712466416
curr_Factors:  [103.29132712]
mat_Sqrt:  [[0.15]]
grads:  [0.28961594]
Stock Position:  0.2896159434374966
Bond Position:  [-39.20560424]


portfolio before change:  [-9.32662915]
curr_Stock_Price:  103.17603775258121
curr_Factors:  [103.17603775]
mat_Sqrt:  [[0.15]]
grads:  [0.02128046]
Stock Position:  0.021280459115147164
Bond Position:  [-11.5222626]


portfolio before change:  [-9.34345032]
curr_Stock_Price:  102.41942791011299
curr_Factors:  [102.41942791]
mat_Sqrt:  [[0.15]]
grads:  [0.05578788]
Stock Position:  0.05578788102935562
Bond Position:  [-15.05721318]


portfolio before change:  [-9.2765703]
curr_Stock_Price:  103.63512421249611
curr_Factors:  [103.63512421]
mat_Sqrt:  [[0.15]]
grads:  [0.31302562]
Stock Position:  0.31302561704320153
Bond Position:  [-41.71701901]


portfolio before change:  [-9.10457867]
curr_Stock_Price:  104.19290292607782
curr_Factors:  [104.19290293]
mat_Sqrt:  [[0.15]]
grads:  [0.18942636]
Stock Position:  0.18942636484791378
Bond Position:  [-28.84146152]


portfolio before change:  [-9.0383269]
curr_Stock_Price:  104.55216875379274
curr_Factors:  [104.55216875]
mat_Sqrt:  [[0.15]]
grads:  [0.02607528]
Stock Position:  0.026075282503541936
Bond Position:  [-11.76455424]


portfolio before change:  [-9.02510091]
curr_Stock_Price:  105.08759157075248
curr_Factors:  [105.08759157]
mat_Sqrt:  [[0.15]]
grads:  [-0.05813467]
Stock Position:  -0.05813466995914135
Bond Position:  [-2.91586845]


portfolio before change:  [-9.03021946]
curr_Stock_Price:  105.17250311169661
curr_Factors:  [105.17250311]
mat_Sqrt:  [[0.15]]
grads:  [0.04331552]
Stock Position:  0.04331552423108887
Bond Position:  [-13.58582156]


portfolio before change:  [-8.99036143]
curr_Stock_Price:  106.11228550214659
curr_Factors:  [106.1122855]
mat_Sqrt:  [[0.15]]
grads:  [0.11072516]
Stock Position:  0.11072516276273053
Bond Position:  [-20.73966151]


portfolio before change:  [-8.98505837]
curr_Stock_Price:  106.17188648140731
curr_Factors:  [106.17188648]
mat_Sqrt:  [[0.15]]
grads:  [0.11719828]
Stock Position:  0.11719828490188586
Bond Position:  [-21.42822137]


portfolio before change:  [-9.01193356]
curr_Stock_Price:  105.95400030492439
curr_Factors:  [105.9540003]
mat_Sqrt:  [[0.15]]
grads:  [-0.07785647]
Stock Position:  -0.07785646897641131
Bond Position:  [-0.76272923]


portfolio before change:  [-8.99488808]
curr_Stock_Price:  105.73445322357647
curr_Factors:  [105.73445322]
mat_Sqrt:  [[0.15]]
grads:  [0.02567149]
Stock Position:  0.02567149407169845
Bond Position:  [-11.70924947]


portfolio before change:  [-8.99171543]
curr_Stock_Price:  105.88654780137217
curr_Factors:  [105.8865478]
mat_Sqrt:  [[0.15]]
grads:  [-0.12988821]
Stock Position:  -0.12988820747069546
Bond Position:  [4.76169846]


portfolio before change:  [-8.99446749]
curr_Stock_Price:  105.91002701642621
curr_Factors:  [105.91002702]
mat_Sqrt:  [[0.15]]
grads:  [-0.06056981]
Stock Position:  -0.06056980649707798
Bond Position:  [-2.57951765]


portfolio before change:  [-8.95294646]
curr_Stock_Price:  105.22185814099146
curr_Factors:  [105.22185814]
mat_Sqrt:  [[0.15]]
grads:  [-0.09893149]
Stock Position:  -0.0989314883428742
Bond Position:  [1.45680857]


portfolio before change:  [-8.90653693]
curr_Stock_Price:  104.75367070595007
curr_Factors:  [104.75367071]
mat_Sqrt:  [[0.15]]
grads:  [-0.00355709]
Stock Position:  -0.0035570924004139455
Bond Position:  [-8.53391844]


portfolio before change:  [-8.90578424]
curr_Stock_Price:  104.39211925783009
curr_Factors:  [104.39211926]
mat_Sqrt:  [[0.15]]
grads:  [-0.24098288]
Stock Position:  -0.2409828781318434
Bond Position:  [16.25092911]


portfolio before change:  [-8.79055549]
curr_Stock_Price:  103.91817256060236
curr_Factors:  [103.91817256]
mat_Sqrt:  [[0.15]]
grads:  [0.02368453]
Stock Position:  0.0236845255094425
Bond Position:  [-11.2518081]


portfolio before change:  [-8.78700484]
curr_Stock_Price:  104.09777959185648
curr_Factors:  [104.09777959]
mat_Sqrt:  [[0.15]]
grads:  [0.04483319]
Stock Position:  0.0448331941544967
Bond Position:  [-13.4540408]


portfolio before change:  [-8.82424421]
curr_Stock_Price:  103.28591532859633
curr_Factors:  [103.28591533]
mat_Sqrt:  [[0.15]]
grads:  [-0.06233294]
Stock Position:  -0.062332940832106956
Bond Position:  [-2.38612936]


portfolio before change:  [-8.88419919]
curr_Stock_Price:  104.24537344203594
curr_Factors:  [104.24537344]
mat_Sqrt:  [[0.15]]
grads:  [0.05697073]
Stock Position:  0.056970734177611296
Bond Position:  [-14.82313465]


portfolio before change:  [-8.87365989]
curr_Stock_Price:  104.44663086489523
curr_Factors:  [104.44663086]
mat_Sqrt:  [[0.15]]
grads:  [0.00161034]
Stock Position:  0.0016103351341188155
Bond Position:  [-9.04185397]


portfolio before change:  [-8.87339599]
curr_Stock_Price:  104.96144990199772
curr_Factors:  [104.9614499]
mat_Sqrt:  [[0.15]]
grads:  [0.07737355]
Stock Position:  0.07737354863334175
Bond Position:  [-16.99463584]


portfolio before change:  [-8.85069749]
curr_Stock_Price:  105.26854065159112
curr_Factors:  [105.26854065]
mat_Sqrt:  [[0.15]]
grads:  [0.07042215]
Stock Position:  0.07042215089312731
Bond Position:  [-16.26393454]


portfolio before change:  [-8.81607521]
curr_Stock_Price:  105.7746143886252
curr_Factors:  [105.77461439]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065835]
Stock Position:  -0.020658351183374744
Bond Position:  [-6.63094608]


portfolio before change:  [-8.8266916]
curr_Stock_Price:  106.26845561797035
curr_Factors:  [106.26845562]
mat_Sqrt:  [[0.15]]
grads:  [0.09746509]
Stock Position:  0.09746508984751596
Bond Position:  [-19.18415618]


portfolio before change:  [-8.81558329]
curr_Stock_Price:  106.39473021157704
curr_Factors:  [106.39473021]
mat_Sqrt:  [[0.15]]
grads:  [-0.01010156]
Stock Position:  -0.010101559641621176
Bond Position:  [-7.74083057]


portfolio before change:  [-8.81944351]
curr_Stock_Price:  106.72897605067959
curr_Factors:  [106.72897605]
mat_Sqrt:  [[0.15]]
grads:  [0.12541468]
Stock Position:  0.1254146781001712
Bond Position:  [-22.20482368]


portfolio before change:  [-8.83895374]
curr_Stock_Price:  106.5844763263195
curr_Factors:  [106.58447633]
mat_Sqrt:  [[0.15]]
grads:  [0.14572232]
Stock Position:  0.14572231959910514
Bond Position:  [-24.37069086]


portfolio before change:  [-8.83089603]
curr_Stock_Price:  106.65022415944252
curr_Factors:  [106.65022416]
mat_Sqrt:  [[0.15]]
grads:  [-0.04952384]
Stock Position:  -0.04952384077442129
Bond Position:  [-3.54916731]


portfolio before change:  [-8.80970623]
curr_Stock_Price:  106.21787419242577
curr_Factors:  [106.21787419]
mat_Sqrt:  [[0.15]]
grads:  [-0.35053009]
Stock Position:  -0.35053009267956237
Bond Position:  [28.42285506]


portfolio before change:  [-8.7301533]
curr_Stock_Price:  105.9959918460364
curr_Factors:  [105.99599185]
mat_Sqrt:  [[0.15]]
grads:  [-0.09842235]
Stock Position:  -0.09842234724278891
Bond Position:  [1.70222101]


portfolio before change:  [-8.82792295]
curr_Stock_Price:  106.99044116411366
curr_Factors:  [106.99044116]
mat_Sqrt:  [[0.15]]
grads:  [-0.01460273]
Stock Position:  -0.014602732454765373
Bond Position:  [-7.26557016]


portfolio before change:  [-8.83389522]
curr_Stock_Price:  107.36832649180374
curr_Factors:  [107.36832649]
mat_Sqrt:  [[0.15]]
grads:  [-0.02598776]
Stock Position:  -0.025987759175707423
Bond Position:  [-6.04363301]


portfolio before change:  [-8.83373803]
curr_Stock_Price:  107.34774274533815
curr_Factors:  [107.34774275]
mat_Sqrt:  [[0.15]]
grads:  [-0.09095352]
Stock Position:  -0.09095351984014398
Bond Position:  [0.92991702]


portfolio before change:  [-8.79388499]
curr_Stock_Price:  106.91021245786678
curr_Factors:  [106.91021246]
mat_Sqrt:  [[0.15]]
grads:  [0.00214673]
Stock Position:  0.0021467327167409038
Bond Position:  [-9.02339264]


portfolio before change:  [-8.79521618]
curr_Stock_Price:  106.5528302392192
curr_Factors:  [106.55283024]
mat_Sqrt:  [[0.15]]
grads:  [-0.02054715]
Stock Position:  -0.020547151453248286
Bond Position:  [-6.60585903]


portfolio before change:  [-8.81406669]
curr_Stock_Price:  107.450162935873
curr_Factors:  [107.45016294]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015947]
Stock Position:  -0.0501594662720322
Bond Position:  [-3.42442386]


portfolio before change:  [-8.82202019]
curr_Stock_Price:  107.60446026648054
curr_Factors:  [107.60446027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02817927]
Stock Position:  -0.02817927032023378
Bond Position:  [-5.78980502]


portfolio before change:  [-8.82150468]
curr_Stock_Price:  107.57332436706804
curr_Factors:  [107.57332437]
mat_Sqrt:  [[0.15]]
grads:  [-0.11398259]
Stock Position:  -0.11398259187276423
Bond Position:  [3.43998165]


portfolio before change:  [-8.88562539]
curr_Stock_Price:  108.13775899362342
curr_Factors:  [108.13775899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00239001]
Stock Position:  -0.0023900059232145917
Bond Position:  [-8.62717551]


portfolio before change:  [-8.88709004]
curr_Stock_Price:  108.52496823213167
curr_Factors:  [108.52496823]
mat_Sqrt:  [[0.15]]
grads:  [-0.06371484]
Stock Position:  -0.06371484475018332
Bond Position:  [-1.97243854]


portfolio before change:  [-8.88972968]
curr_Stock_Price:  108.56446226286494
curr_Factors:  [108.56446226]
mat_Sqrt:  [[0.15]]
grads:  [0.20532076]
Stock Position:  0.20532075738135105
Bond Position:  [-31.18026729]


portfolio before change:  [-8.91597267]
curr_Stock_Price:  108.44613927378393
curr_Factors:  [108.44613927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03034694]
Stock Position:  -0.030346938005077533
Bond Position:  [-5.62496441]


portfolio before change:  [-8.89255889]
curr_Stock_Price:  107.6630174392215
curr_Factors:  [107.66301744]
mat_Sqrt:  [[0.15]]
grads:  [0.1306261]
Stock Position:  0.13062610283980017
Bond Position:  [-22.95615928]


portfolio before change:  [-8.93820138]
curr_Stock_Price:  107.32458824273655
curr_Factors:  [107.32458824]
mat_Sqrt:  [[0.15]]
grads:  [0.05734164]
Stock Position:  0.05734164042773847
Bond Position:  [-15.09236933]


portfolio before change:  [-8.96505053]
curr_Stock_Price:  106.87280758783052
curr_Factors:  [106.87280759]
mat_Sqrt:  [[0.15]]
grads:  [0.0759978]
Stock Position:  0.07599779741987095
Bond Position:  [-17.08714851]


portfolio before change:  [-8.95999988]
curr_Stock_Price:  106.95331829639414
curr_Factors:  [106.9533183]
mat_Sqrt:  [[0.15]]
grads:  [0.04090811]
Stock Position:  0.04090811363468397
Bond Position:  [-13.33525837]


portfolio before change:  [-8.96891703]
curr_Stock_Price:  106.7557126117471
curr_Factors:  [106.75571261]
mat_Sqrt:  [[0.15]]
grads:  [-0.09858831]
Stock Position:  -0.09858830758823778
Bond Position:  [1.555948]


portfolio before change:  [-8.84064636]
curr_Stock_Price:  105.45562516578455
curr_Factors:  [105.45562517]
mat_Sqrt:  [[0.15]]
grads:  [-0.14562936]
Stock Position:  -0.14562936437904683
Bond Position:  [6.5167893]


portfolio before change:  [-8.71810353]
curr_Stock_Price:  104.61695145719573
curr_Factors:  [104.61695146]
mat_Sqrt:  [[0.15]]
grads:  [0.00601203]
Stock Position:  0.006012025982097804
Bond Position:  [-9.34706336]


portfolio before change:  [-8.72291073]
curr_Stock_Price:  103.91452712341521
curr_Factors:  [103.91452712]
mat_Sqrt:  [[0.15]]
grads:  [0.01682413]
Stock Position:  0.016824128443917123
Bond Position:  [-10.47118208]


portfolio before change:  [-8.72600457]
curr_Stock_Price:  103.76953470821903
curr_Factors:  [103.76953471]
mat_Sqrt:  [[0.15]]
grads:  [-0.12091528]
Stock Position:  -0.12091527923793317
Bond Position:  [3.82131769]


portfolio before change:  [-8.74776631]
curr_Stock_Price:  103.95148502589626
curr_Factors:  [103.95148503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02437532]
Stock Position:  -0.024375324206994873
Bond Position:  [-6.21391516]


portfolio before change:  [-8.73251902]
curr_Stock_Price:  103.31003007381872
curr_Factors:  [103.31003007]
mat_Sqrt:  [[0.15]]
grads:  [0.08161157]
Stock Position:  0.08161157292650978
Bond Position:  [-17.16381307]


portfolio before change:  [-8.70167204]
curr_Stock_Price:  103.7011479960061
curr_Factors:  [103.701148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03240858]
Stock Position:  -0.032408581622672926
Bond Position:  [-5.34086492]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.7296559]
Stock Price:  104.55431856364788
PL:  [-13.28397446]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.3004753911830617
FINAL STD P&L:  11.96192401143249
