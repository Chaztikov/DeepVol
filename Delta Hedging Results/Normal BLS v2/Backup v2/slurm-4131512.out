WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 14:27:59.091686: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 14:27:59.114573: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 14:27:59.115250: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:27:59.117489: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:27:59.119499: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:27:59.120190: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:27:59.122721: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:27:59.124824: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:27:59.130145: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:27:59.132312: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:27:59.132897: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 14:27:59.139849: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400125000 Hz
2019-12-18 14:27:59.140044: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55706f6e72a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:27:59.140062: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 14:27:59.141178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2019-12-18 14:27:59.141205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:27:59.141218: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:27:59.141229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:27:59.141240: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:27:59.141251: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:27:59.141263: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:27:59.141276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:27:59.143321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:27:59.143351: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:27:59.240572: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 14:27:59.240608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 14:27:59.240620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 14:27:59.243894: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2019-12-18 14:27:59.246034: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55706fd205b0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:27:59.246051: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 14:28:15.743364: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.2328e+02,   Y0: 2.2574e+00,  elapsed time  16
INFO   step:     1,    loss: 1.5271e+01,   Y0: 2.2524e+00,  elapsed time  23
INFO   step:     2,    loss: 1.8703e+01,   Y0: 2.2474e+00,  elapsed time  23
INFO   step:     3,    loss: 2.4482e+01,   Y0: 2.2424e+00,  elapsed time  23
INFO   step:     4,    loss: 2.6084e+01,   Y0: 2.2374e+00,  elapsed time  23
INFO   step:     5,    loss: 2.8349e+01,   Y0: 2.2323e+00,  elapsed time  23
INFO   step:     6,    loss: 2.6086e+01,   Y0: 2.2286e+00,  elapsed time  23
INFO   step:     7,    loss: 2.2214e+01,   Y0: 2.2246e+00,  elapsed time  23
INFO   step:     8,    loss: 1.5446e+01,   Y0: 2.2209e+00,  elapsed time  23
INFO   step:     9,    loss: 1.1653e+01,   Y0: 2.2172e+00,  elapsed time  23
INFO   step:    10,    loss: 1.0531e+01,   Y0: 2.2135e+00,  elapsed time  24
INFO   step:    11,    loss: 1.0098e+01,   Y0: 2.2094e+00,  elapsed time  24
INFO   step:    12,    loss: 1.0052e+01,   Y0: 2.2051e+00,  elapsed time  24
INFO   step:    13,    loss: 1.0137e+01,   Y0: 2.2008e+00,  elapsed time  24
INFO   step:    14,    loss: 1.0158e+01,   Y0: 2.1963e+00,  elapsed time  24
INFO   step:    15,    loss: 1.0616e+01,   Y0: 2.1923e+00,  elapsed time  24
INFO   step:    16,    loss: 1.1373e+01,   Y0: 2.1884e+00,  elapsed time  24
INFO   step:    17,    loss: 1.1650e+01,   Y0: 2.1842e+00,  elapsed time  24
INFO   step:    18,    loss: 1.0817e+01,   Y0: 2.1801e+00,  elapsed time  24
INFO   step:    19,    loss: 9.9174e+00,   Y0: 2.1762e+00,  elapsed time  24
INFO   step:    20,    loss: 9.8044e+00,   Y0: 2.1725e+00,  elapsed time  24
INFO   step:    21,    loss: 9.8370e+00,   Y0: 2.1689e+00,  elapsed time  24
INFO   step:    22,    loss: 1.0226e+01,   Y0: 2.1653e+00,  elapsed time  24
INFO   step:    23,    loss: 1.0068e+01,   Y0: 2.1618e+00,  elapsed time  25
INFO   step:    24,    loss: 9.7680e+00,   Y0: 2.1589e+00,  elapsed time  25
INFO   step:    25,    loss: 9.6407e+00,   Y0: 2.1565e+00,  elapsed time  25
INFO   step:    26,    loss: 9.7953e+00,   Y0: 2.1542e+00,  elapsed time  25
INFO   step:    27,    loss: 1.0309e+01,   Y0: 2.1526e+00,  elapsed time  25
INFO   step:    28,    loss: 1.0457e+01,   Y0: 2.1513e+00,  elapsed time  25
INFO   step:    29,    loss: 1.0593e+01,   Y0: 2.1500e+00,  elapsed time  25
INFO   step:    30,    loss: 1.0420e+01,   Y0: 2.1490e+00,  elapsed time  25
INFO   step:    31,    loss: 1.0448e+01,   Y0: 2.1479e+00,  elapsed time  25
INFO   step:    32,    loss: 1.0614e+01,   Y0: 2.1469e+00,  elapsed time  25
INFO   step:    33,    loss: 1.0642e+01,   Y0: 2.1460e+00,  elapsed time  25
INFO   step:    34,    loss: 9.9894e+00,   Y0: 2.1452e+00,  elapsed time  25
INFO   step:    35,    loss: 9.6908e+00,   Y0: 2.1444e+00,  elapsed time  25
INFO   step:    36,    loss: 9.4801e+00,   Y0: 2.1434e+00,  elapsed time  25
INFO   step:    37,    loss: 9.4196e+00,   Y0: 2.1423e+00,  elapsed time  26
INFO   step:    38,    loss: 9.3938e+00,   Y0: 2.1412e+00,  elapsed time  26
INFO   step:    39,    loss: 9.3776e+00,   Y0: 2.1401e+00,  elapsed time  26
INFO   step:    40,    loss: 9.3661e+00,   Y0: 2.1392e+00,  elapsed time  26
INFO   step:    41,    loss: 9.3562e+00,   Y0: 2.1389e+00,  elapsed time  26
INFO   step:    42,    loss: 9.3472e+00,   Y0: 2.1387e+00,  elapsed time  26
INFO   step:    43,    loss: 9.3395e+00,   Y0: 2.1386e+00,  elapsed time  26
INFO   step:    44,    loss: 9.3340e+00,   Y0: 2.1379e+00,  elapsed time  26
INFO   step:    45,    loss: 9.3262e+00,   Y0: 2.1370e+00,  elapsed time  26
INFO   step:    46,    loss: 9.3201e+00,   Y0: 2.1360e+00,  elapsed time  26
INFO   step:    47,    loss: 9.3134e+00,   Y0: 2.1358e+00,  elapsed time  26
INFO   step:    48,    loss: 9.3060e+00,   Y0: 2.1359e+00,  elapsed time  26
INFO   step:    49,    loss: 9.3004e+00,   Y0: 2.1358e+00,  elapsed time  26
INFO   step:    50,    loss: 9.2943e+00,   Y0: 2.1363e+00,  elapsed time  27
INFO   step:    51,    loss: 9.2896e+00,   Y0: 2.1369e+00,  elapsed time  27
INFO   step:    52,    loss: 9.2839e+00,   Y0: 2.1377e+00,  elapsed time  27
INFO   step:    53,    loss: 9.2784e+00,   Y0: 2.1380e+00,  elapsed time  27
INFO   step:    54,    loss: 9.2732e+00,   Y0: 2.1378e+00,  elapsed time  27
INFO   step:    55,    loss: 9.2678e+00,   Y0: 2.1381e+00,  elapsed time  27
INFO   step:    56,    loss: 9.2625e+00,   Y0: 2.1383e+00,  elapsed time  27
INFO   step:    57,    loss: 9.2574e+00,   Y0: 2.1390e+00,  elapsed time  27
INFO   step:    58,    loss: 9.2526e+00,   Y0: 2.1397e+00,  elapsed time  27
INFO   step:    59,    loss: 9.2487e+00,   Y0: 2.1406e+00,  elapsed time  27
INFO   step:    60,    loss: 9.2453e+00,   Y0: 2.1412e+00,  elapsed time  27
INFO   step:    61,    loss: 9.2424e+00,   Y0: 2.1417e+00,  elapsed time  27
INFO   step:    62,    loss: 9.2402e+00,   Y0: 2.1418e+00,  elapsed time  27
INFO   step:    63,    loss: 9.2382e+00,   Y0: 2.1417e+00,  elapsed time  28
INFO   step:    64,    loss: 9.2365e+00,   Y0: 2.1418e+00,  elapsed time  28
INFO   step:    65,    loss: 9.2350e+00,   Y0: 2.1415e+00,  elapsed time  28
INFO   step:    66,    loss: 9.2338e+00,   Y0: 2.1407e+00,  elapsed time  28
INFO   step:    67,    loss: 9.2327e+00,   Y0: 2.1396e+00,  elapsed time  28
INFO   step:    68,    loss: 9.2320e+00,   Y0: 2.1394e+00,  elapsed time  28
INFO   step:    69,    loss: 9.2314e+00,   Y0: 2.1395e+00,  elapsed time  28
INFO   step:    70,    loss: 9.2311e+00,   Y0: 2.1392e+00,  elapsed time  28
INFO   step:    71,    loss: 9.2306e+00,   Y0: 2.1390e+00,  elapsed time  28
INFO   step:    72,    loss: 9.2301e+00,   Y0: 2.1388e+00,  elapsed time  28
INFO   step:    73,    loss: 9.2298e+00,   Y0: 2.1390e+00,  elapsed time  28
INFO   step:    74,    loss: 9.2293e+00,   Y0: 2.1390e+00,  elapsed time  28
INFO   step:    75,    loss: 9.2289e+00,   Y0: 2.1386e+00,  elapsed time  28
INFO   step:    76,    loss: 9.2286e+00,   Y0: 2.1382e+00,  elapsed time  29
INFO   step:    77,    loss: 9.2282e+00,   Y0: 2.1387e+00,  elapsed time  29
INFO   step:    78,    loss: 9.2278e+00,   Y0: 2.1396e+00,  elapsed time  29
INFO   step:    79,    loss: 9.2274e+00,   Y0: 2.1407e+00,  elapsed time  29
INFO   step:    80,    loss: 9.2270e+00,   Y0: 2.1418e+00,  elapsed time  29
INFO   step:    81,    loss: 9.2267e+00,   Y0: 2.1427e+00,  elapsed time  29
INFO   step:    82,    loss: 9.2264e+00,   Y0: 2.1436e+00,  elapsed time  29
INFO   step:    83,    loss: 9.2260e+00,   Y0: 2.1441e+00,  elapsed time  29
INFO   step:    84,    loss: 9.2256e+00,   Y0: 2.1446e+00,  elapsed time  29
INFO   step:    85,    loss: 9.2252e+00,   Y0: 2.1446e+00,  elapsed time  29
INFO   step:    86,    loss: 9.2248e+00,   Y0: 2.1447e+00,  elapsed time  29
INFO   step:    87,    loss: 9.2245e+00,   Y0: 2.1448e+00,  elapsed time  29
INFO   step:    88,    loss: 9.2243e+00,   Y0: 2.1449e+00,  elapsed time  29
INFO   step:    89,    loss: 9.2241e+00,   Y0: 2.1447e+00,  elapsed time  29
INFO   step:    90,    loss: 9.2238e+00,   Y0: 2.1447e+00,  elapsed time  30
INFO   step:    91,    loss: 9.2237e+00,   Y0: 2.1453e+00,  elapsed time  30
INFO   step:    92,    loss: 9.2235e+00,   Y0: 2.1450e+00,  elapsed time  30
INFO   step:    93,    loss: 9.2233e+00,   Y0: 2.1445e+00,  elapsed time  30
INFO   step:    94,    loss: 9.2231e+00,   Y0: 2.1440e+00,  elapsed time  30
INFO   step:    95,    loss: 9.2229e+00,   Y0: 2.1438e+00,  elapsed time  30
INFO   step:    96,    loss: 9.2228e+00,   Y0: 2.1439e+00,  elapsed time  30
INFO   step:    97,    loss: 9.2227e+00,   Y0: 2.1446e+00,  elapsed time  30
INFO   step:    98,    loss: 9.2226e+00,   Y0: 2.1455e+00,  elapsed time  30
INFO   step:    99,    loss: 9.2225e+00,   Y0: 2.1467e+00,  elapsed time  30
INFO   step:   100,    loss: 9.2224e+00,   Y0: 2.1482e+00,  elapsed time  30
INFO   step:   101,    loss: 9.2224e+00,   Y0: 2.1495e+00,  elapsed time  30
INFO   step:   102,    loss: 9.2223e+00,   Y0: 2.1504e+00,  elapsed time  30
INFO   step:   103,    loss: 9.2222e+00,   Y0: 2.1517e+00,  elapsed time  31
INFO   step:   104,    loss: 9.2222e+00,   Y0: 2.1533e+00,  elapsed time  31
INFO   step:   105,    loss: 9.2222e+00,   Y0: 2.1550e+00,  elapsed time  31
INFO   step:   106,    loss: 9.2221e+00,   Y0: 2.1560e+00,  elapsed time  31
INFO   step:   107,    loss: 9.2220e+00,   Y0: 2.1566e+00,  elapsed time  31
INFO   step:   108,    loss: 9.2219e+00,   Y0: 2.1570e+00,  elapsed time  31
INFO   step:   109,    loss: 9.2218e+00,   Y0: 2.1573e+00,  elapsed time  31
INFO   step:   110,    loss: 9.2217e+00,   Y0: 2.1574e+00,  elapsed time  31
INFO   step:   111,    loss: 9.2216e+00,   Y0: 2.1573e+00,  elapsed time  31
INFO   step:   112,    loss: 9.2214e+00,   Y0: 2.1569e+00,  elapsed time  31
INFO   step:   113,    loss: 9.2213e+00,   Y0: 2.1564e+00,  elapsed time  31
INFO   step:   114,    loss: 9.2212e+00,   Y0: 2.1563e+00,  elapsed time  31
INFO   step:   115,    loss: 9.2211e+00,   Y0: 2.1566e+00,  elapsed time  31
INFO   step:   116,    loss: 9.2210e+00,   Y0: 2.1569e+00,  elapsed time  32
INFO   step:   117,    loss: 9.2208e+00,   Y0: 2.1564e+00,  elapsed time  32
INFO   step:   118,    loss: 9.2207e+00,   Y0: 2.1563e+00,  elapsed time  32
INFO   step:   119,    loss: 9.2205e+00,   Y0: 2.1556e+00,  elapsed time  32
INFO   step:   120,    loss: 9.2204e+00,   Y0: 2.1554e+00,  elapsed time  32
INFO   step:   121,    loss: 9.2203e+00,   Y0: 2.1559e+00,  elapsed time  32
INFO   step:   122,    loss: 9.2203e+00,   Y0: 2.1569e+00,  elapsed time  32
INFO   step:   123,    loss: 9.2202e+00,   Y0: 2.1575e+00,  elapsed time  32
INFO   step:   124,    loss: 9.2201e+00,   Y0: 2.1577e+00,  elapsed time  32
INFO   step:   125,    loss: 9.2200e+00,   Y0: 2.1574e+00,  elapsed time  32
INFO   step:   126,    loss: 9.2199e+00,   Y0: 2.1568e+00,  elapsed time  32
INFO   step:   127,    loss: 9.2197e+00,   Y0: 2.1562e+00,  elapsed time  32
INFO   step:   128,    loss: 9.2195e+00,   Y0: 2.1553e+00,  elapsed time  32
INFO   step:   129,    loss: 9.2193e+00,   Y0: 2.1539e+00,  elapsed time  33
INFO   step:   130,    loss: 9.2192e+00,   Y0: 2.1527e+00,  elapsed time  33
INFO   step:   131,    loss: 9.2190e+00,   Y0: 2.1516e+00,  elapsed time  33
INFO   step:   132,    loss: 9.2188e+00,   Y0: 2.1507e+00,  elapsed time  33
INFO   step:   133,    loss: 9.2187e+00,   Y0: 2.1500e+00,  elapsed time  33
INFO   step:   134,    loss: 9.2185e+00,   Y0: 2.1495e+00,  elapsed time  33
INFO   step:   135,    loss: 9.2184e+00,   Y0: 2.1486e+00,  elapsed time  33
INFO   step:   136,    loss: 9.2182e+00,   Y0: 2.1475e+00,  elapsed time  33
INFO   step:   137,    loss: 9.2181e+00,   Y0: 2.1465e+00,  elapsed time  33
INFO   step:   138,    loss: 9.2179e+00,   Y0: 2.1461e+00,  elapsed time  33
INFO   step:   139,    loss: 9.2178e+00,   Y0: 2.1457e+00,  elapsed time  33
INFO   step:   140,    loss: 9.2177e+00,   Y0: 2.1453e+00,  elapsed time  33
INFO   step:   141,    loss: 9.2176e+00,   Y0: 2.1458e+00,  elapsed time  33
INFO   step:   142,    loss: 9.2175e+00,   Y0: 2.1468e+00,  elapsed time  34
INFO   step:   143,    loss: 9.2175e+00,   Y0: 2.1473e+00,  elapsed time  34
INFO   step:   144,    loss: 9.2174e+00,   Y0: 2.1474e+00,  elapsed time  34
INFO   step:   145,    loss: 9.2173e+00,   Y0: 2.1476e+00,  elapsed time  34
INFO   step:   146,    loss: 9.2172e+00,   Y0: 2.1480e+00,  elapsed time  34
INFO   step:   147,    loss: 9.2171e+00,   Y0: 2.1485e+00,  elapsed time  34
INFO   step:   148,    loss: 9.2170e+00,   Y0: 2.1489e+00,  elapsed time  34
INFO   step:   149,    loss: 9.2170e+00,   Y0: 2.1492e+00,  elapsed time  34
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  20
# of dimensions:  1
Loss out:  11.088647324610594
Output_Z_Vals:  [[[ 2.29378849e+00]
  [ 2.29378849e+00]
  [ 2.29378849e+00]
  ...
  [ 2.29378849e+00]
  [ 2.29378849e+00]
  [ 2.29378849e+00]]

 [[-3.80667122e-02]
  [-3.95098482e-02]
  [ 3.86999954e-02]
  ...
  [-3.81989956e-02]
  [ 1.80606039e-02]
  [ 1.24351457e-02]]

 [[-6.34732276e-03]
  [-7.80294122e-03]
  [-6.99760883e-03]
  ...
  [-7.58232277e-03]
  [-6.11629583e-03]
  [ 4.17392948e-03]]

 ...

 [[-2.11080345e-02]
  [-1.33261146e-02]
  [-4.44594036e-02]
  ...
  [-4.84362186e-02]
  [ 4.95363103e-02]
  [ 4.51932841e-02]]

 [[-3.57711200e-03]
  [-1.03424413e-02]
  [-1.36199281e-02]
  ...
  [-2.69811990e-02]
  [ 2.05980906e-02]
  [ 1.57109260e-02]]

 [[ 4.99680253e-03]
  [ 4.77578766e-03]
  [ 4.57482543e-03]
  ...
  [ 4.66038894e-03]
  [ 3.90268207e-03]
  [ 7.79261445e-04]]]
Z_Vals dimensionality:  (20, 200, 1)
X_test:  [[[100.         101.99873038 102.58220994 ... 108.38091262 108.49858172
   107.96976149]]

 [[100.         101.66337287 101.29209952 ... 106.63357906 107.10333209
   107.82523294]]

 [[100.         100.40720014 102.2913216  ... 105.99830382 105.83467322
   106.60750266]]

 ...

 [[100.         101.96799022 101.70888752 ... 102.49281368 102.93189777
   104.01109928]]

 [[100.          99.33955337 100.30659704 ...  97.43634073  98.74033429
    97.35608276]]

 [[100.          99.50450592  99.56555807 ...  94.03526963  93.29085536
    94.27029742]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.80667122e-02]
 [-6.34732276e-03]
 [ 3.59413377e-02]
 [-1.20115935e-02]
 [ 4.39595664e-03]
 [-4.10836107e-02]
 [-1.37209590e-02]
 [ 1.20699337e-03]
 [ 3.70798275e-03]
 [ 8.85613584e-02]
 [-1.56207469e-02]
 [-1.76566064e-02]
 [-3.13471881e-03]
 [-2.42650528e-02]
 [ 1.41524169e-02]
 [ 3.29566838e-03]
 [-2.11080345e-02]
 [-3.57711200e-03]
 [ 4.99680253e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.332971]
curr_Stock_Price:  101.99873037529031
curr_Factors:  [101.99873038]
mat_Sqrt:  [[0.15]]
grads:  [-0.25377808]
Stock Position:  -0.2537780815570487
Bond Position:  [58.21801311]


portfolio before change:  [32.199453]
curr_Stock_Price:  102.58220994319628
curr_Factors:  [102.58220994]
mat_Sqrt:  [[0.15]]
grads:  [-0.04231549]
Stock Position:  -0.042315485046080334
Bond Position:  [36.54026897]


portfolio before change:  [32.14945109]
curr_Stock_Price:  103.97976248680082
curr_Factors:  [103.97976249]
mat_Sqrt:  [[0.15]]
grads:  [0.23960892]
Stock Position:  0.2396089182000021
Bond Position:  [7.23497269]


portfolio before change:  [32.40239549]
curr_Stock_Price:  105.0278680094405
curr_Factors:  [105.02786801]
mat_Sqrt:  [[0.15]]
grads:  [-0.08007729]
Stock Position:  -0.08007729023844587
Bond Position:  [40.81274256]


portfolio before change:  [32.37470189]
curr_Stock_Price:  105.50113653867177
curr_Factors:  [105.50113654]
mat_Sqrt:  [[0.15]]
grads:  [0.02930638]
Stock Position:  0.029306377627787962
Bond Position:  [29.28284574]


portfolio before change:  [32.35901221]
curr_Stock_Price:  104.71593856582427
curr_Factors:  [104.71593857]
mat_Sqrt:  [[0.15]]
grads:  [-0.27389074]
Stock Position:  -0.2738907379611317
Bond Position:  [61.0397379]


portfolio before change:  [32.11970183]
curr_Stock_Price:  105.64540489770958
curr_Factors:  [105.6454049]
mat_Sqrt:  [[0.15]]
grads:  [-0.09147306]
Stock Position:  -0.09147305976889969
Bond Position:  [41.78341027]


portfolio before change:  [32.22683978]
curr_Stock_Price:  104.58836371446645
curr_Factors:  [104.58836371]
mat_Sqrt:  [[0.15]]
grads:  [0.00804662]
Stock Position:  0.008046622496550807
Bond Position:  [31.3852567]


portfolio before change:  [32.23989228]
curr_Stock_Price:  105.235243990028
curr_Factors:  [105.23524399]
mat_Sqrt:  [[0.15]]
grads:  [0.02471988]
Stock Position:  0.024719884987698844
Bond Position:  [29.63848915]


portfolio before change:  [32.29792355]
curr_Stock_Price:  107.28301757488217
curr_Factors:  [107.28301757]
mat_Sqrt:  [[0.15]]
grads:  [0.59040906]
Stock Position:  0.590409056104316
Bond Position:  [-31.04294159]


portfolio before change:  [32.08140259]
curr_Stock_Price:  106.92943346306629
curr_Factors:  [106.92943346]
mat_Sqrt:  [[0.15]]
grads:  [-0.10413831]
Stock Position:  -0.1041383128626066
Bond Position:  [43.21685338]


portfolio before change:  [32.1170094]
curr_Stock_Price:  106.69127664022022
curr_Factors:  [106.69127664]
mat_Sqrt:  [[0.15]]
grads:  [-0.11771071]
Stock Position:  -0.11771070942150248
Bond Position:  [44.67571526]


portfolio before change:  [32.0339691]
curr_Stock_Price:  107.49163398229317
curr_Factors:  [107.49163398]
mat_Sqrt:  [[0.15]]
grads:  [-0.02089813]
Stock Position:  -0.02089812543186454
Bond Position:  [34.28034274]


portfolio before change:  [32.06492675]
curr_Stock_Price:  106.42041380017689
curr_Factors:  [106.4204138]
mat_Sqrt:  [[0.15]]
grads:  [-0.16176702]
Stock Position:  -0.16176701871418908
Bond Position:  [49.28023982]


portfolio before change:  [32.05812478]
curr_Stock_Price:  106.53863050762138
curr_Factors:  [106.53863051]
mat_Sqrt:  [[0.15]]
grads:  [0.09434945]
Stock Position:  0.09434944602901271
Bond Position:  [22.00626401]


portfolio before change:  [32.22373381]
curr_Stock_Price:  108.23558561986519
curr_Factors:  [108.23558562]
mat_Sqrt:  [[0.15]]
grads:  [0.02197112]
Stock Position:  0.02197112252623169
Bond Position:  [29.8456765]


portfolio before change:  [32.21387617]
curr_Stock_Price:  107.44727865844297
curr_Factors:  [107.44727866]
mat_Sqrt:  [[0.15]]
grads:  [-0.14072023]
Stock Position:  -0.14072023017452678
Bond Position:  [47.33388196]


portfolio before change:  [32.09432994]
curr_Stock_Price:  108.38091262037375
curr_Factors:  [108.38091262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02384741]
Stock Position:  -0.023847413342390537
Bond Position:  [34.67893436]


portfolio before change:  [32.10019465]
curr_Stock_Price:  108.49858171820787
curr_Factors:  [108.49858172]
mat_Sqrt:  [[0.15]]
grads:  [0.03331202]
Stock Position:  0.03331201684060865
Bond Position:  [28.48588807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.10019465]
Stock Price:  107.96976149232711
PL:  [24.13043316]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.95098482e-02]
 [-7.80294122e-03]
 [ 1.19556688e-02]
 [ 1.58908628e-03]
 [ 5.00885127e-03]
 [-3.10393468e-02]
 [-9.80070409e-03]
 [ 1.49275363e-03]
 [ 5.07338157e-03]
 [ 1.02374621e-01]
 [-1.91223544e-02]
 [-1.62936573e-02]
 [-4.37149072e-03]
 [-3.44820915e-02]
 [ 2.21473068e-02]
 [ 2.65949494e-03]
 [-1.33261146e-02]
 [-1.03424413e-02]
 [ 4.77578766e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.20470971]
curr_Stock_Price:  101.66337286726721
curr_Factors:  [101.66337287]
mat_Sqrt:  [[0.15]]
grads:  [-0.26339899]
Stock Position:  -0.2633989881290438
Bond Position:  [53.98273925]


portfolio before change:  [27.31600011]
curr_Stock_Price:  101.29209951581697
curr_Factors:  [101.29209952]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201961]
Stock Position:  -0.05201960813849994
Bond Position:  [32.58517543]


portfolio before change:  [27.26151279]
curr_Stock_Price:  102.49615754210942
curr_Factors:  [102.49615754]
mat_Sqrt:  [[0.15]]
grads:  [0.07970446]
Stock Position:  0.07970445884678003
Bond Position:  [19.09211202]


portfolio before change:  [27.2747634]
curr_Stock_Price:  102.60251271828622
curr_Factors:  [102.60251272]
mat_Sqrt:  [[0.15]]
grads:  [0.01059391]
Stock Position:  0.010593908521031448
Bond Position:  [26.18780177]


portfolio before change:  [27.29679651]
curr_Stock_Price:  104.06423397810508
curr_Factors:  [104.06423398]
mat_Sqrt:  [[0.15]]
grads:  [0.03339234]
Stock Position:  0.03339234177771816
Bond Position:  [23.82184804]


portfolio before change:  [27.30417328]
curr_Stock_Price:  104.1067755229678
curr_Factors:  [104.10677552]
mat_Sqrt:  [[0.15]]
grads:  [-0.20692898]
Stock Position:  -0.2069289786597388
Bond Position:  [48.84688201]


portfolio before change:  [27.23799249]
curr_Stock_Price:  104.48562065156612
curr_Factors:  [104.48562065]
mat_Sqrt:  [[0.15]]
grads:  [-0.06533803]
Stock Position:  -0.06533802725832367
Bond Position:  [34.06487682]


portfolio before change:  [27.18208532]
curr_Stock_Price:  105.47163840339539
curr_Factors:  [105.4716384]
mat_Sqrt:  [[0.15]]
grads:  [0.00995169]
Stock Position:  0.009951690895117972
Bond Position:  [26.13246417]


portfolio before change:  [27.19508321]
curr_Stock_Price:  106.12117224620074
curr_Factors:  [106.12117225]
mat_Sqrt:  [[0.15]]
grads:  [0.03382254]
Stock Position:  0.03382254382008607
Bond Position:  [23.60579521]


portfolio before change:  [27.30509817]
curr_Stock_Price:  109.19937859510517
curr_Factors:  [109.1993786]
mat_Sqrt:  [[0.15]]
grads:  [0.68249747]
Stock Position:  0.6824974731319992
Bond Position:  [-47.22320179]


portfolio before change:  [27.6145824]
curr_Stock_Price:  109.67013712421844
curr_Factors:  [109.67013712]
mat_Sqrt:  [[0.15]]
grads:  [-0.12748236]
Stock Position:  -0.12748236275871855
Bond Position:  [41.5955906]


portfolio before change:  [27.79643261]
curr_Stock_Price:  108.32524505000899
curr_Factors:  [108.32524505]
mat_Sqrt:  [[0.15]]
grads:  [-0.10862438]
Stock Position:  -0.10862438181136874
Bond Position:  [39.56319539]


portfolio before change:  [27.65832371]
curr_Stock_Price:  109.6877470574666
curr_Factors:  [109.68774706]
mat_Sqrt:  [[0.15]]
grads:  [-0.02914327]
Stock Position:  -0.029143271456056944
Bond Position:  [30.8549835]


portfolio before change:  [27.6618422]
curr_Stock_Price:  109.83173284088996
curr_Factors:  [109.83173284]
mat_Sqrt:  [[0.15]]
grads:  [-0.22988061]
Stock Position:  -0.22988061009425081
Bond Position:  [52.91002796]


portfolio before change:  [27.81655546]
curr_Stock_Price:  109.21626511294231
curr_Factors:  [109.21626511]
mat_Sqrt:  [[0.15]]
grads:  [0.14764871]
Stock Position:  0.14764871190021225
Bond Position:  [11.6909146]


portfolio before change:  [27.73816255]
curr_Stock_Price:  108.66552539200133
curr_Factors:  [108.66552539]
mat_Sqrt:  [[0.15]]
grads:  [0.01772997]
Stock Position:  0.01772996624135976
Bond Position:  [25.81152645]


portfolio before change:  [27.73976473]
curr_Stock_Price:  108.39189243609314
curr_Factors:  [108.39189244]
mat_Sqrt:  [[0.15]]
grads:  [-0.08884076]
Stock Position:  -0.0888407637442019
Bond Position:  [37.36938324]


portfolio before change:  [27.90531815]
curr_Stock_Price:  106.63357906259621
curr_Factors:  [106.63357906]
mat_Sqrt:  [[0.15]]
grads:  [-0.06894961]
Stock Position:  -0.06894960833798586
Bond Position:  [35.25766166]


portfolio before change:  [27.88174438]
curr_Stock_Price:  107.10333208520574
curr_Factors:  [107.10333209]
mat_Sqrt:  [[0.15]]
grads:  [0.03183858]
Stock Position:  0.03183858439047622
Bond Position:  [24.4717259]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.88174438]
Stock Price:  107.82523293683961
PL:  [20.05651144]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.86999954e-02]
 [-6.99760883e-03]
 [ 1.57710085e-04]
 [ 4.41146776e-05]
 [ 6.43326220e-03]
 [ 1.08952335e-02]
 [-7.38451708e-04]
 [-8.95154851e-04]
 [-1.01144431e-03]
 [ 2.35273419e-02]
 [-9.23170322e-03]
 [-2.17297695e-02]
 [-9.43469944e-04]
 [-2.12952125e-02]
 [ 8.55740220e-03]
 [ 7.95168158e-03]
 [-4.44594036e-02]
 [-1.36199281e-02]
 [ 4.57482543e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.99541275]
curr_Stock_Price:  100.40720014194682
curr_Factors:  [100.40720014]
mat_Sqrt:  [[0.15]]
grads:  [0.25799997]
Stock Position:  0.25799996929115376
Bond Position:  [-17.9096418]


portfolio before change:  [8.47703806]
curr_Stock_Price:  102.2913215996856
curr_Factors:  [102.2913216]
mat_Sqrt:  [[0.15]]
grads:  [-0.04665073]
Stock Position:  -0.046650725546304374
Bond Position:  [13.24900243]


portfolio before change:  [8.50545857]
curr_Stock_Price:  101.75311247846307
curr_Factors:  [101.75311248]
mat_Sqrt:  [[0.15]]
grads:  [0.0010514]
Stock Position:  0.0010514005649168527
Bond Position:  [8.39847529]


portfolio before change:  [8.50874118]
curr_Stock_Price:  102.87802137647517
curr_Factors:  [102.87802138]
mat_Sqrt:  [[0.15]]
grads:  [0.0002941]
Stock Position:  0.000294097850933862
Bond Position:  [8.47848498]


portfolio before change:  [8.51042593]
curr_Stock_Price:  101.39846135342232
curr_Factors:  [101.39846135]
mat_Sqrt:  [[0.15]]
grads:  [0.04288841]
Stock Position:  0.042888414690551574
Bond Position:  [4.16160667]


portfolio before change:  [8.48454153]
curr_Stock_Price:  100.77067099877851
curr_Factors:  [100.770671]
mat_Sqrt:  [[0.15]]
grads:  [0.07263489]
Stock Position:  0.07263489001375001
Bond Position:  [1.16507493]


portfolio before change:  [8.47922406]
curr_Stock_Price:  100.69345227591127
curr_Factors:  [100.69345228]
mat_Sqrt:  [[0.15]]
grads:  [-0.00492301]
Stock Position:  -0.004923011388477394
Bond Position:  [8.97493907]


portfolio before change:  [8.47860406]
curr_Stock_Price:  101.2752133116925
curr_Factors:  [101.27521331]
mat_Sqrt:  [[0.15]]
grads:  [-0.0059677]
Stock Position:  -0.005967699009564505
Bond Position:  [9.08298405]


portfolio before change:  [8.48007225]
curr_Stock_Price:  101.40974372552606
curr_Factors:  [101.40974373]
mat_Sqrt:  [[0.15]]
grads:  [-0.00674296]
Stock Position:  -0.006742962035387691
Bond Position:  [9.16387431]


portfolio before change:  [8.47945913]
curr_Stock_Price:  101.84047107760257
curr_Factors:  [101.84047108]
mat_Sqrt:  [[0.15]]
grads:  [0.15684895]
Stock Position:  0.15684894598401738
Bond Position:  [-7.49411142]


portfolio before change:  [8.60779651]
curr_Stock_Price:  102.67064010594841
curr_Factors:  [102.67064011]
mat_Sqrt:  [[0.15]]
grads:  [-0.06154469]
Stock Position:  -0.06154468813741275
Bond Position:  [14.92662903]


portfolio before change:  [8.64743311]
curr_Stock_Price:  102.08725128249242
curr_Factors:  [102.08725128]
mat_Sqrt:  [[0.15]]
grads:  [-0.14486513]
Stock Position:  -0.14486513019776173
Bond Position:  [23.43631606]


portfolio before change:  [8.46682776]
curr_Stock_Price:  103.37441515302102
curr_Factors:  [103.37441515]
mat_Sqrt:  [[0.15]]
grads:  [-0.0062898]
Stock Position:  -0.006289799628639975
Bond Position:  [9.11703212]


portfolio before change:  [8.46213947]
curr_Stock_Price:  104.48221395363899
curr_Factors:  [104.48221395]
mat_Sqrt:  [[0.15]]
grads:  [-0.14196808]
Stock Position:  -0.14196808350752166
Bond Position:  [23.29527915]


portfolio before change:  [8.41354308]
curr_Stock_Price:  104.86554620572949
curr_Factors:  [104.86554621]
mat_Sqrt:  [[0.15]]
grads:  [0.05704935]
Stock Position:  0.05704934800257202
Bond Position:  [2.43103204]


portfolio before change:  [8.38846014]
curr_Stock_Price:  104.41522088774686
curr_Factors:  [104.41522089]
mat_Sqrt:  [[0.15]]
grads:  [0.05301121]
Stock Position:  0.05301121054151007
Bond Position:  [2.85328289]


portfolio before change:  [8.34624441]
curr_Stock_Price:  103.60540839668799
curr_Factors:  [103.6054084]
mat_Sqrt:  [[0.15]]
grads:  [-0.29639602]
Stock Position:  -0.2963960241819262
Bond Position:  [39.05447555]


portfolio before change:  [7.64676456]
curr_Stock_Price:  105.9983038208419
curr_Factors:  [105.99830382]
mat_Sqrt:  [[0.15]]
grads:  [-0.09079952]
Stock Position:  -0.09079952061373588
Bond Position:  [17.27135974]


portfolio before change:  [7.66594052]
curr_Stock_Price:  105.83467321804355
curr_Factors:  [105.83467322]
mat_Sqrt:  [[0.15]]
grads:  [0.03049884]
Stock Position:  0.030498836220105574
Bond Position:  [4.43810616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.66594052]
Stock Price:  106.607502662194
PL:  [1.05843786]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.79819842e-02]
 [-7.36274323e-03]
 [ 1.19939895e-02]
 [-1.83626343e-03]
 [ 4.53481365e-03]
 [-5.44551590e-02]
 [-1.34512799e-02]
 [ 1.70833933e-03]
 [ 3.30300572e-03]
 [ 7.42389379e-02]
 [-1.59400131e-02]
 [-1.63507053e-02]
 [-4.15495301e-03]
 [-2.76367739e-02]
 [ 1.39830299e-02]
 [ 6.99806077e-03]
 [-2.88777226e-02]
 [-6.43086288e-03]
 [ 4.82741341e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.71816234]
curr_Stock_Price:  100.38906962885845
curr_Factors:  [100.38906963]
mat_Sqrt:  [[0.15]]
grads:  [0.25321323]
Stock Position:  0.25321322800498475
Bond Position:  [-17.70167804]


portfolio before change:  [8.10516783]
curr_Stock_Price:  101.93492673767344
curr_Factors:  [101.93492674]
mat_Sqrt:  [[0.15]]
grads:  [-0.04908495]
Stock Position:  -0.049084954843198296
Bond Position:  [13.10863911]


portfolio before change:  [8.08078132]
curr_Stock_Price:  102.4985226844862
curr_Factors:  [102.49852268]
mat_Sqrt:  [[0.15]]
grads:  [0.07995993]
Stock Position:  0.07995993033121636
Bond Position:  [-0.11499341]


portfolio before change:  [8.13790945]
curr_Stock_Price:  103.21334174749235
curr_Factors:  [103.21334175]
mat_Sqrt:  [[0.15]]
grads:  [-0.01224176]
Stock Position:  -0.012241756223513235
Bond Position:  [9.40142202]


portfolio before change:  [8.11627676]
curr_Stock_Price:  105.17248356013421
curr_Factors:  [105.17248356]
mat_Sqrt:  [[0.15]]
grads:  [0.03023209]
Stock Position:  0.030232090995738117
Bond Position:  [4.93669267]


portfolio before change:  [8.12822567]
curr_Stock_Price:  105.52689426514274
curr_Factors:  [105.52689427]
mat_Sqrt:  [[0.15]]
grads:  [-0.36303439]
Stock Position:  -0.3630343933070293
Bond Position:  [46.4381177]


portfolio before change:  [7.90857134]
curr_Stock_Price:  106.16392841931068
curr_Factors:  [106.16392842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0896752]
Stock Position:  -0.08967519964355741
Bond Position:  [17.42884282]


portfolio before change:  [7.91525369]
curr_Stock_Price:  106.13800602486808
curr_Factors:  [106.13800602]
mat_Sqrt:  [[0.15]]
grads:  [0.01138893]
Stock Position:  0.0113889288386566
Bond Position:  [6.70645549]


portfolio before change:  [7.9036564]
curr_Stock_Price:  104.97247784224777
curr_Factors:  [104.97247784]
mat_Sqrt:  [[0.15]]
grads:  [0.02202004]
Stock Position:  0.022020038155544305
Bond Position:  [5.59215843]


portfolio before change:  [7.92677784]
curr_Stock_Price:  105.95899872430215
curr_Factors:  [105.95899872]
mat_Sqrt:  [[0.15]]
grads:  [0.49492625]
Stock Position:  0.4949262528733944
Bond Position:  [-44.51511236]


portfolio before change:  [8.51961803]
curr_Stock_Price:  107.1793226720474
curr_Factors:  [107.17932267]
mat_Sqrt:  [[0.15]]
grads:  [-0.10626675]
Stock Position:  -0.10626675390701455
Bond Position:  [19.90921674]


portfolio before change:  [8.41009029]
curr_Stock_Price:  108.25685317008285
curr_Factors:  [108.25685317]
mat_Sqrt:  [[0.15]]
grads:  [-0.1090047]
Stock Position:  -0.10900470191006767
Bond Position:  [20.2105963]


portfolio before change:  [8.30108193]
curr_Stock_Price:  109.30324503219776
curr_Factors:  [109.30324503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02769969]
Stock Position:  -0.02769968670590061
Bond Position:  [11.32874758]


portfolio before change:  [8.32986535]
curr_Stock_Price:  108.3663797620944
curr_Factors:  [108.36637976]
mat_Sqrt:  [[0.15]]
grads:  [-0.18424516]
Stock Position:  -0.1842451596400446
Bond Position:  [28.29584629]


portfolio before change:  [8.68344425]
curr_Stock_Price:  106.485711348074
curr_Factors:  [106.48571135]
mat_Sqrt:  [[0.15]]
grads:  [0.0932202]
Stock Position:  0.09322019914691505
Bond Position:  [-1.24317497]


portfolio before change:  [8.60452508]
curr_Stock_Price:  105.64245705348493
curr_Factors:  [105.64245705]
mat_Sqrt:  [[0.15]]
grads:  [0.04665374]
Stock Position:  0.046653738470160876
Bond Position:  [3.67590952]


portfolio before change:  [8.64564536]
curr_Stock_Price:  106.50414965375823
curr_Factors:  [106.50414965]
mat_Sqrt:  [[0.15]]
grads:  [-0.19251815]
Stock Position:  -0.19251815086516366
Bond Position:  [29.14962731]


portfolio before change:  [8.45057637]
curr_Stock_Price:  107.55525730055571
curr_Factors:  [107.5552573]
mat_Sqrt:  [[0.15]]
grads:  [-0.04287242]
Stock Position:  -0.042872419189950786
Bond Position:  [13.06173045]


portfolio before change:  [8.45924482]
curr_Stock_Price:  107.4292414595827
curr_Factors:  [107.42924146]
mat_Sqrt:  [[0.15]]
grads:  [0.03218276]
Stock Position:  0.032182756097567905
Bond Position:  [5.00187574]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.45924482]
Stock Price:  109.49425146180913
PL:  [-1.03500664]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.76808178e-03]
 [ 8.49356722e-03]
 [ 2.49305310e-02]
 [-1.16560950e-03]
 [ 9.12347800e-03]
 [ 4.00079470e-02]
 [-1.04907061e-02]
 [ 8.23265218e-03]
 [ 7.49000609e-03]
 [-3.73136172e-02]
 [-6.01121639e-04]
 [-2.63881985e-02]
 [ 2.17180645e-03]
 [-1.82482514e-03]
 [-9.88449197e-04]
 [ 1.19442232e-02]
 [ 5.06151492e-02]
 [ 1.25137615e-02]
 [ 3.81854070e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.42585008]
curr_Stock_Price:  99.59492410648639
curr_Factors:  [99.59492411]
mat_Sqrt:  [[0.15]]
grads:  [0.05845388]
Stock Position:  0.05845387854239423
Bond Position:  [-10.24755967]


portfolio before change:  [-4.50157011]
curr_Stock_Price:  98.34337625441398
curr_Factors:  [98.34337625]
mat_Sqrt:  [[0.15]]
grads:  [0.05662378]
Stock Position:  0.05662378147026338
Bond Position:  [-10.07014396]


portfolio before change:  [-4.57036003]
curr_Stock_Price:  97.17298343974741
curr_Factors:  [97.17298344]
mat_Sqrt:  [[0.15]]
grads:  [0.16620354]
Stock Position:  0.16620354013941896
Bond Position:  [-20.72085388]


portfolio before change:  [-4.6216952]
curr_Stock_Price:  96.89528590727534
curr_Factors:  [96.89528591]
mat_Sqrt:  [[0.15]]
grads:  [-0.00777073]
Stock Position:  -0.0077707300004203365
Bond Position:  [-3.8687481]


portfolio before change:  [-4.61464467]
curr_Stock_Price:  95.86348539565651
curr_Factors:  [95.8634854]
mat_Sqrt:  [[0.15]]
grads:  [0.06082319]
Stock Position:  0.060823186634347576
Bond Position:  [-10.44536733]


portfolio before change:  [-4.59029524]
curr_Stock_Price:  96.30675539223745
curr_Factors:  [96.30675539]
mat_Sqrt:  [[0.15]]
grads:  [0.26671965]
Stock Position:  0.26671964652978614
Bond Position:  [-30.277199]


portfolio before change:  [-4.31645604]
curr_Stock_Price:  97.36183121712813
curr_Factors:  [97.36183122]
mat_Sqrt:  [[0.15]]
grads:  [-0.06993804]
Stock Position:  -0.06993804080562845
Bond Position:  [2.49283969]


portfolio before change:  [-4.14796222]
curr_Stock_Price:  94.96155619608328
curr_Factors:  [94.9615562]
mat_Sqrt:  [[0.15]]
grads:  [0.05488435]
Stock Position:  0.054884347841630265
Bond Position:  [-9.3598653]


portfolio before change:  [-4.13135965]
curr_Stock_Price:  95.3066970414847
curr_Factors:  [95.30669704]
mat_Sqrt:  [[0.15]]
grads:  [0.04993337]
Stock Position:  0.04993337392141208
Bond Position:  [-8.89034459]


portfolio before change:  [-4.19124725]
curr_Stock_Price:  94.151863307939
curr_Factors:  [94.15186331]
mat_Sqrt:  [[0.15]]
grads:  [-0.24875745]
Stock Position:  -0.24875744802658847
Bond Position:  [19.22972999]


portfolio before change:  [-4.50311667]
curr_Stock_Price:  95.42490035019681
curr_Factors:  [95.42490035]
mat_Sqrt:  [[0.15]]
grads:  [-0.00400748]
Stock Position:  -0.0040074775914673965
Bond Position:  [-4.12070352]


portfolio before change:  [-4.49962755]
curr_Stock_Price:  94.29715227880146
curr_Factors:  [94.29715228]
mat_Sqrt:  [[0.15]]
grads:  [-0.17592132]
Stock Position:  -0.17592132321752715
Bond Position:  [12.08925226]


portfolio before change:  [-4.53492619]
curr_Stock_Price:  94.51498448407088
curr_Factors:  [94.51498448]
mat_Sqrt:  [[0.15]]
grads:  [0.01447871]
Stock Position:  0.014478709667632964
Bond Position:  [-5.90338121]


portfolio before change:  [-4.51457097]
curr_Stock_Price:  96.02280147134343
curr_Factors:  [96.02280147]
mat_Sqrt:  [[0.15]]
grads:  [-0.0121655]
Stock Position:  -0.012165500951347483
Bond Position:  [-3.34640549]


portfolio before change:  [-4.51034976]
curr_Stock_Price:  95.60704221580438
curr_Factors:  [95.60704222]
mat_Sqrt:  [[0.15]]
grads:  [-0.00658966]
Stock Position:  -0.006589661310234116
Bond Position:  [-3.88033173]


portfolio before change:  [-4.52428591]
curr_Stock_Price:  97.57466196942387
curr_Factors:  [97.57466197]
mat_Sqrt:  [[0.15]]
grads:  [0.07962815]
Stock Position:  0.07962815488930146
Bond Position:  [-12.29397621]


portfolio before change:  [-4.52986818]
curr_Stock_Price:  97.5431605890028
curr_Factors:  [97.54316059]
mat_Sqrt:  [[0.15]]
grads:  [0.33743433]
Stock Position:  0.33743432804308005
Bond Position:  [-37.44427903]


portfolio before change:  [-3.50389327]
curr_Stock_Price:  100.61142325552389
curr_Factors:  [100.61142326]
mat_Sqrt:  [[0.15]]
grads:  [0.08342508]
Stock Position:  0.08342507635150687
Bond Position:  [-11.89740894]


portfolio before change:  [-3.4939292]
curr_Stock_Price:  100.76651809082676
curr_Factors:  [100.76651809]
mat_Sqrt:  [[0.15]]
grads:  [0.02545694]
Stock Position:  0.02545693799527744
Bond Position:  [-6.0591362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.4939292]
Stock Price:  100.76396338011295
PL:  [-4.25789258]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.24612963e-02]
 [ 8.74450363e-03]
 [ 2.18844218e-04]
 [ 3.60344122e-03]
 [ 7.46254209e-03]
 [ 9.22787119e-04]
 [-9.70147007e-03]
 [ 1.56615117e-05]
 [-1.96743010e-04]
 [-3.49311590e-02]
 [-1.03541985e-03]
 [-2.61452038e-02]
 [ 2.62480005e-03]
 [ 3.48974987e-03]
 [-2.56125187e-03]
 [ 1.19254648e-02]
 [ 4.49576032e-02]
 [ 2.04070521e-02]
 [ 3.80350663e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.34848519]
curr_Stock_Price:  98.55367933895303
curr_Factors:  [98.55367934]
mat_Sqrt:  [[0.15]]
grads:  [0.61640864]
Stock Position:  0.6164086421978832
Bond Position:  [-81.09782486]


portfolio before change:  [-20.61006833]
curr_Stock_Price:  98.16220827014979
curr_Factors:  [98.16220827]
mat_Sqrt:  [[0.15]]
grads:  [0.05829669]
Stock Position:  0.05829669089442752
Bond Position:  [-26.33260024]


portfolio before change:  [-20.54415853]
curr_Stock_Price:  99.40573979712269
curr_Factors:  [99.4057398]
mat_Sqrt:  [[0.15]]
grads:  [0.00145896]
Stock Position:  0.0014589614539445759
Bond Position:  [-20.68918767]


portfolio before change:  [-20.5489419]
curr_Stock_Price:  99.6727580860037
curr_Factors:  [99.67275809]
mat_Sqrt:  [[0.15]]
grads:  [0.02402294]
Stock Position:  0.024022941444804356
Bond Position:  [-22.94337474]


portfolio before change:  [-20.54509608]
curr_Stock_Price:  100.07164282863606
curr_Factors:  [100.07164283]
mat_Sqrt:  [[0.15]]
grads:  [0.04975028]
Stock Position:  0.049750280629440514
Bond Position:  [-25.52368839]


portfolio before change:  [-20.57992404]
curr_Stock_Price:  99.49986232532888
curr_Factors:  [99.49986233]
mat_Sqrt:  [[0.15]]
grads:  [0.00615191]
Stock Position:  0.00615191412719642
Bond Position:  [-21.19203865]


portfolio before change:  [-20.58178318]
curr_Stock_Price:  100.05896250559164
curr_Factors:  [100.05896251]
mat_Sqrt:  [[0.15]]
grads:  [-0.06467647]
Stock Position:  -0.06467646712395714
Bond Position:  [-14.11032298]


portfolio before change:  [-20.51959827]
curr_Stock_Price:  99.04293714710363
curr_Factors:  [99.04293715]
mat_Sqrt:  [[0.15]]
grads:  [0.00010441]
Stock Position:  0.00010441007810104302
Bond Position:  [-20.52993935]


portfolio before change:  [-20.52469823]
curr_Stock_Price:  99.36061941090217
curr_Factors:  [99.36061941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131162]
Stock Position:  -0.0013116200637870044
Bond Position:  [-20.39437484]


portfolio before change:  [-20.52947122]
curr_Stock_Price:  99.11188846683656
curr_Factors:  [99.11188847]
mat_Sqrt:  [[0.15]]
grads:  [-0.23287439]
Stock Position:  -0.23287439365801
Bond Position:  [2.55114972]


portfolio before change:  [-20.42576479]
curr_Stock_Price:  98.66929554316623
curr_Factors:  [98.66929554]
mat_Sqrt:  [[0.15]]
grads:  [-0.0069028]
Stock Position:  -0.0069027989907504556
Bond Position:  [-19.74467048]


portfolio before change:  [-20.43085048]
curr_Stock_Price:  98.6908671697503
curr_Factors:  [98.69086717]
mat_Sqrt:  [[0.15]]
grads:  [-0.17430136]
Stock Position:  -0.17430135882652392
Bond Position:  [-3.22889823]


portfolio before change:  [-20.35732313]
curr_Stock_Price:  98.26439503101706
curr_Factors:  [98.26439503]
mat_Sqrt:  [[0.15]]
grads:  [0.01749867]
Stock Position:  0.017498666984696196
Bond Position:  [-22.07681906]


portfolio before change:  [-20.36369172]
curr_Stock_Price:  98.21589460740746
curr_Factors:  [98.21589461]
mat_Sqrt:  [[0.15]]
grads:  [0.023265]
Stock Position:  0.023264999161704165
Bond Position:  [-22.64868442]


portfolio before change:  [-20.35445794]
curr_Stock_Price:  98.85619800091281
curr_Factors:  [98.856198]
mat_Sqrt:  [[0.15]]
grads:  [-0.01707501]
Stock Position:  -0.01707501247815838
Bond Position:  [-18.66648713]


portfolio before change:  [-20.34474593]
curr_Stock_Price:  98.01407774183275
curr_Factors:  [98.01407774]
mat_Sqrt:  [[0.15]]
grads:  [0.0795031]
Stock Position:  0.07950309881167486
Bond Position:  [-28.13716884]


portfolio before change:  [-20.50687465]
curr_Stock_Price:  96.0632915859533
curr_Factors:  [96.06329159]
mat_Sqrt:  [[0.15]]
grads:  [0.29971735]
Stock Position:  0.29971735488719814
Bond Position:  [-49.2987103]


portfolio before change:  [-20.37691344]
curr_Stock_Price:  96.53803028854685
curr_Factors:  [96.53803029]
mat_Sqrt:  [[0.15]]
grads:  [0.13604701]
Stock Position:  0.1360470140632785
Bond Position:  [-33.5106242]


portfolio before change:  [-20.34570153]
curr_Stock_Price:  96.82903713760207
curr_Factors:  [96.82903714]
mat_Sqrt:  [[0.15]]
grads:  [0.02535671]
Stock Position:  0.02535671085178392
Bond Position:  [-22.80096742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.34570153]
Stock Price:  97.20222082960363
PL:  [-20.34570153]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.13473380e-02]
 [ 6.16102105e-03]
 [ 1.05834038e-04]
 [ 2.74998136e-03]
 [ 8.57190000e-03]
 [ 1.45488212e-02]
 [-1.50145280e-02]
 [ 5.05096426e-03]
 [ 4.91332453e-03]
 [-3.72797263e-02]
 [-6.69237111e-04]
 [-2.63687268e-02]
 [ 2.72294386e-03]
 [-1.08111057e-03]
 [-4.33812254e-04]
 [ 5.54443073e-03]
 [ 1.09527641e-02]
 [ 1.67133804e-02]
 [ 5.46011778e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.8290103]
curr_Stock_Price:  100.78868240820088
curr_Factors:  [100.78868241]
mat_Sqrt:  [[0.15]]
grads:  [0.07564892]
Stock Position:  0.07564892025387646
Bond Position:  [6.20445531]


portfolio before change:  [13.71881409]
curr_Stock_Price:  99.31149648971855
curr_Factors:  [99.31149649]
mat_Sqrt:  [[0.15]]
grads:  [0.04107347]
Stock Position:  0.04107347365773004
Bond Position:  [9.63974596]


portfolio before change:  [13.72552463]
curr_Stock_Price:  99.41619411382848
curr_Factors:  [99.41619411]
mat_Sqrt:  [[0.15]]
grads:  [0.00070556]
Stock Position:  0.00070556025076837
Bond Position:  [13.65538051]


portfolio before change:  [13.72798284]
curr_Stock_Price:  98.06116496909696
curr_Factors:  [98.06116497]
mat_Sqrt:  [[0.15]]
grads:  [0.01833321]
Stock Position:  0.018333209061238538
Bond Position:  [11.930207]


portfolio before change:  [13.73627792]
curr_Stock_Price:  98.35092050363343
curr_Factors:  [98.3509205]
mat_Sqrt:  [[0.15]]
grads:  [0.057146]
Stock Position:  0.057146000007157464
Bond Position:  [8.11591621]


portfolio before change:  [13.72454429]
curr_Stock_Price:  98.11008376054
curr_Factors:  [98.11008376]
mat_Sqrt:  [[0.15]]
grads:  [0.09699214]
Stock Position:  0.09699214119786576
Bond Position:  [4.2086372]


portfolio before change:  [13.77221562]
curr_Stock_Price:  98.5907313404961
curr_Factors:  [98.59073134]
mat_Sqrt:  [[0.15]]
grads:  [-0.10009685]
Stock Position:  -0.1000968531650291
Bond Position:  [23.64083758]


portfolio before change:  [13.89365241]
curr_Stock_Price:  97.43659072496786
curr_Factors:  [97.43659072]
mat_Sqrt:  [[0.15]]
grads:  [0.0336731]
Stock Position:  0.03367309505296146
Bond Position:  [10.61266083]


portfolio before change:  [13.8677137]
curr_Stock_Price:  96.58747925475264
curr_Factors:  [96.58747925]
mat_Sqrt:  [[0.15]]
grads:  [0.0327555]
Stock Position:  0.03275549686794829
Bond Position:  [10.70394282]


portfolio before change:  [13.83998697]
curr_Stock_Price:  95.65929781392201
curr_Factors:  [95.65929781]
mat_Sqrt:  [[0.15]]
grads:  [-0.24853151]
Stock Position:  -0.24853150872313848
Bond Position:  [37.61433658]


portfolio before change:  [13.87951257]
curr_Stock_Price:  95.53810257933358
curr_Factors:  [95.53810258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00446158]
Stock Position:  -0.004461580737133905
Bond Position:  [14.30576353]


portfolio before change:  [13.88221554]
curr_Stock_Price:  95.73397906273499
curr_Factors:  [95.73397906]
mat_Sqrt:  [[0.15]]
grads:  [-0.17579151]
Stock Position:  -0.17579151176301389
Bond Position:  [30.71143644]


portfolio before change:  [13.69668713]
curr_Stock_Price:  96.83304932798822
curr_Factors:  [96.83304933]
mat_Sqrt:  [[0.15]]
grads:  [0.01815296]
Stock Position:  0.01815295908017132
Bond Position:  [11.93888075]


portfolio before change:  [13.69385722]
curr_Stock_Price:  96.51271549222497
curr_Factors:  [96.51271549]
mat_Sqrt:  [[0.15]]
grads:  [-0.0072074]
Stock Position:  -0.007207403780330341
Bond Position:  [14.38946333]


portfolio before change:  [13.70944322]
curr_Stock_Price:  94.84940057758486
curr_Factors:  [94.84940058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00289208]
Stock Position:  -0.0028920816935475643
Bond Position:  [13.98375543]


portfolio before change:  [13.71633574]
curr_Stock_Price:  93.67511039037612
curr_Factors:  [93.67511039]
mat_Sqrt:  [[0.15]]
grads:  [0.03696287]
Stock Position:  0.036962871544968294
Bond Position:  [10.25383466]


portfolio before change:  [13.72725179]
curr_Stock_Price:  93.9010743891026
curr_Factors:  [93.90107439]
mat_Sqrt:  [[0.15]]
grads:  [0.07301843]
Stock Position:  0.07301842724258693
Bond Position:  [6.87074303]


portfolio before change:  [13.77777849]
curr_Stock_Price:  94.56951922394765
curr_Factors:  [94.56951922]
mat_Sqrt:  [[0.15]]
grads:  [0.11142254]
Stock Position:  0.11142253606933208
Bond Position:  [3.24060282]


portfolio before change:  [13.60565206]
curr_Stock_Price:  93.01743932751991
curr_Factors:  [93.01743933]
mat_Sqrt:  [[0.15]]
grads:  [0.00364008]
Stock Position:  0.0036400785225598523
Bond Position:  [13.26706128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.60565206]
Stock Price:  92.04671786963024
PL:  [13.60565206]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.37492007e-02]
 [-7.93218124e-03]
 [-5.30832846e-03]
 [ 2.28758073e-03]
 [ 6.69213968e-03]
 [ 1.09164600e-02]
 [-3.40306168e-03]
 [-1.87294629e-03]
 [-4.12555594e-04]
 [ 2.85960594e-03]
 [-2.18092986e-03]
 [-2.39692846e-02]
 [ 4.31233773e-04]
 [-1.52478346e-02]
 [-8.27193198e-04]
 [ 8.77428392e-03]
 [-4.38209805e-02]
 [-2.67175923e-02]
 [ 4.21690479e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.30589128]
curr_Stock_Price:  99.73355668745705
curr_Factors:  [99.73355669]
mat_Sqrt:  [[0.15]]
grads:  [0.09166134]
Stock Position:  0.0916613382041255
Bond Position:  [-11.44760255]


portfolio before change:  [-2.19406266]
curr_Stock_Price:  100.98480262791519
curr_Factors:  [100.98480263]
mat_Sqrt:  [[0.15]]
grads:  [-0.05288121]
Stock Position:  -0.05288120829514762
Bond Position:  [3.14613572]


portfolio before change:  [-2.21509122]
curr_Stock_Price:  101.39733453709835
curr_Factors:  [101.39733454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03538886]
Stock Position:  -0.035388856375762535
Bond Position:  [1.37324449]


portfolio before change:  [-2.20209424]
curr_Stock_Price:  101.03977507382258
curr_Factors:  [101.03977507]
mat_Sqrt:  [[0.15]]
grads:  [0.01525054]
Stock Position:  0.015250538196817313
Bond Position:  [-3.74300519]


portfolio before change:  [-2.2025505]
curr_Stock_Price:  101.071223581503
curr_Factors:  [101.07122358]
mat_Sqrt:  [[0.15]]
grads:  [0.04461426]
Stock Position:  0.044614264560712366
Bond Position:  [-6.71176881]


portfolio before change:  [-2.21741113]
curr_Stock_Price:  100.77574698026656
curr_Factors:  [100.77574698]
mat_Sqrt:  [[0.15]]
grads:  [0.0727764]
Stock Position:  0.07277639972995893
Bond Position:  [-9.55150717]


portfolio before change:  [-2.23889659]
curr_Stock_Price:  100.51333648654901
curr_Factors:  [100.51333649]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268708]
Stock Position:  -0.02268707788022347
Bond Position:  [0.0414573]


portfolio before change:  [-2.2450598]
curr_Stock_Price:  100.78545505937166
curr_Factors:  [100.78545506]
mat_Sqrt:  [[0.15]]
grads:  [-0.01248631]
Stock Position:  -0.0124863086241527
Bond Position:  [-0.98662151]


portfolio before change:  [-2.26135751]
curr_Stock_Price:  102.07094501660863
curr_Factors:  [102.07094502]
mat_Sqrt:  [[0.15]]
grads:  [-0.00275037]
Stock Position:  -0.0027503706271985416
Bond Position:  [-1.98062458]


portfolio before change:  [-2.25859227]
curr_Stock_Price:  100.88548137755403
curr_Factors:  [100.88548138]
mat_Sqrt:  [[0.15]]
grads:  [0.01906404]
Stock Position:  0.01906403958748982
Bond Position:  [-4.18187708]


portfolio before change:  [-2.27421446]
curr_Stock_Price:  100.12086960124698
curr_Factors:  [100.1208696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01453953]
Stock Position:  -0.014539532412100662
Bond Position:  [-0.81850383]


portfolio before change:  [-2.27525594]
curr_Stock_Price:  100.17842561951585
curr_Factors:  [100.17842562]
mat_Sqrt:  [[0.15]]
grads:  [-0.15979523]
Stock Position:  -0.15979523078278046
Bond Position:  [13.7327787]


portfolio before change:  [-2.35295653]
curr_Stock_Price:  100.6861642238796
curr_Factors:  [100.68616422]
mat_Sqrt:  [[0.15]]
grads:  [0.00287489]
Stock Position:  0.002874891818993644
Bond Position:  [-2.64241836]


portfolio before change:  [-2.35075963]
curr_Stock_Price:  101.6801431094591
curr_Factors:  [101.68014311]
mat_Sqrt:  [[0.15]]
grads:  [-0.10165223]
Stock Position:  -0.10165223083312308
Bond Position:  [7.98525374]


portfolio before change:  [-2.37233759]
curr_Stock_Price:  101.9120565951068
curr_Factors:  [101.9120566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00551462]
Stock Position:  -0.005514621321971674
Bond Position:  [-1.81033119]


portfolio before change:  [-2.37641507]
curr_Stock_Price:  102.5693701794269
curr_Factors:  [102.56937018]
mat_Sqrt:  [[0.15]]
grads:  [0.05849523]
Stock Position:  0.0584952261196231
Bond Position:  [-8.37623357]


portfolio before change:  [-2.32530754]
curr_Stock_Price:  103.47887767858117
curr_Factors:  [103.47887768]
mat_Sqrt:  [[0.15]]
grads:  [-0.29213987]
Stock Position:  -0.2921398698305395
Bond Position:  [27.90499831]


portfolio before change:  [-2.10091195]
curr_Stock_Price:  102.7346503614633
curr_Factors:  [102.73465036]
mat_Sqrt:  [[0.15]]
grads:  [-0.17811728]
Stock Position:  -0.1781172822908497
Bond Position:  [16.19790477]


portfolio before change:  [-1.92506117]
curr_Stock_Price:  101.7701128822106
curr_Factors:  [101.77011288]
mat_Sqrt:  [[0.15]]
grads:  [0.0281127]
Stock Position:  0.028112698589037675
Bond Position:  [-4.78609368]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.92506117]
Stock Price:  100.48894288389153
PL:  [-2.41400406]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.91398595e-02]
 [ 4.65800762e-04]
 [ 1.61438594e-02]
 [-2.58734789e-03]
 [ 9.09905582e-03]
 [ 4.00346835e-02]
 [-8.73610364e-03]
 [ 6.10011169e-03]
 [ 4.46518967e-03]
 [-3.72227992e-02]
 [-1.03603566e-03]
 [-2.63493118e-02]
 [ 2.80611249e-03]
 [ 8.72174439e-04]
 [-2.37547204e-03]
 [ 1.17119820e-02]
 [ 3.71798071e-02]
 [ 1.93793612e-02]
 [ 3.83236434e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.06471008]
curr_Stock_Price:  99.8147224883557
curr_Factors:  [99.81472249]
mat_Sqrt:  [[0.15]]
grads:  [0.12759906]
Stock Position:  0.1275990632286302
Bond Position:  [-13.80097517]


portfolio before change:  [-1.07473717]
curr_Stock_Price:  99.76318283669501
curr_Factors:  [99.76318284]
mat_Sqrt:  [[0.15]]
grads:  [0.00310534]
Stock Position:  0.003105338413352243
Bond Position:  [-1.38453561]


portfolio before change:  [-1.08154399]
curr_Stock_Price:  97.6826870330932
curr_Factors:  [97.68268703]
mat_Sqrt:  [[0.15]]
grads:  [0.10762573]
Stock Position:  0.1076257294426247
Bond Position:  [-11.59471443]


portfolio before change:  [-1.2158281]
curr_Stock_Price:  96.46192809994533
curr_Factors:  [96.4619281]
mat_Sqrt:  [[0.15]]
grads:  [-0.01724899]
Stock Position:  -0.017248985962145594
Bond Position:  [0.44804234]


portfolio before change:  [-1.20733546]
curr_Stock_Price:  95.97606701601651
curr_Factors:  [95.97606702]
mat_Sqrt:  [[0.15]]
grads:  [0.06066037]
Stock Position:  0.060660372144234316
Bond Position:  [-7.02927941]


portfolio before change:  [-1.18914819]
curr_Stock_Price:  96.30486172867171
curr_Factors:  [96.30486173]
mat_Sqrt:  [[0.15]]
grads:  [0.26689789]
Stock Position:  0.2668978902905515
Bond Position:  [-26.89271261]


portfolio before change:  [-1.04707935]
curr_Stock_Price:  96.8623515635665
curr_Factors:  [96.86235156]
mat_Sqrt:  [[0.15]]
grads:  [-0.05824069]
Stock Position:  -0.05824069094702283
Bond Position:  [4.59425093]


portfolio before change:  [-1.03982755]
curr_Stock_Price:  96.75756060048263
curr_Factors:  [96.7575606]
mat_Sqrt:  [[0.15]]
grads:  [0.04066741]
Stock Position:  0.04066741124626852
Bond Position:  [-4.97470705]


portfolio before change:  [-1.03995945]
curr_Stock_Price:  96.7849025047345
curr_Factors:  [96.7849025]
mat_Sqrt:  [[0.15]]
grads:  [0.02976793]
Stock Position:  0.02976793111588572
Bond Position:  [-3.92104577]


portfolio before change:  [-0.99907242]
curr_Stock_Price:  98.19136304703449
curr_Factors:  [98.19136305]
mat_Sqrt:  [[0.15]]
grads:  [-0.24815199]
Stock Position:  -0.2481519943543256
Bond Position:  [23.36731015]


portfolio before change:  [-1.11480337]
curr_Stock_Price:  98.68127855050494
curr_Factors:  [98.68127855]
mat_Sqrt:  [[0.15]]
grads:  [-0.0069069]
Stock Position:  -0.006906904413518083
Bond Position:  [-0.43322121]


portfolio before change:  [-1.10445005]
curr_Stock_Price:  97.16661458708924
curr_Factors:  [97.16661459]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566208]
Stock Position:  -0.17566207897175234
Bond Position:  [15.96403948]


portfolio before change:  [-1.12974988]
curr_Stock_Price:  97.33336279865195
curr_Factors:  [97.3333628]
mat_Sqrt:  [[0.15]]
grads:  [0.01870742]
Stock Position:  0.01870741661240357
Bond Position:  [-2.95060565]


portfolio before change:  [-1.12662094]
curr_Stock_Price:  97.5400551517494
curr_Factors:  [97.54005515]
mat_Sqrt:  [[0.15]]
grads:  [0.0058145]
Stock Position:  0.005814496257540535
Bond Position:  [-1.69376723]


portfolio before change:  [-1.12241416]
curr_Stock_Price:  98.33638887648047
curr_Factors:  [98.33638888]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583648]
Stock Position:  -0.015836480252710887
Bond Position:  [0.43488812]


portfolio before change:  [-1.12220371]
curr_Stock_Price:  98.32996613681553
curr_Factors:  [98.32996614]
mat_Sqrt:  [[0.15]]
grads:  [0.07807988]
Stock Position:  0.07807988009118638
Bond Position:  [-8.79979567]


portfolio before change:  [-1.01348954]
curr_Stock_Price:  99.7504907010685
curr_Factors:  [99.7504907]
mat_Sqrt:  [[0.15]]
grads:  [0.24786538]
Stock Position:  0.2478653803976679
Bond Position:  [-25.73818287]


portfolio before change:  [-1.18016725]
curr_Stock_Price:  99.10400123249303
curr_Factors:  [99.10400123]
mat_Sqrt:  [[0.15]]
grads:  [0.12919574]
Stock Position:  0.1291957411951327
Bond Position:  [-13.98398215]


portfolio before change:  [-1.14324511]
curr_Stock_Price:  99.41684883077419
curr_Factors:  [99.41684883]
mat_Sqrt:  [[0.15]]
grads:  [0.0255491]
Stock Position:  0.025549095571716533
Bond Position:  [-3.68325568]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.14324511]
Stock Price:  102.68702131468133
PL:  [-3.83026642]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.77896543e-02]
 [-1.51673448e-03]
 [ 4.14482160e-03]
 [ 3.02124297e-03]
 [ 6.91411108e-03]
 [ 9.48325257e-03]
 [-1.19392141e-02]
 [-2.30379860e-03]
 [-2.18276835e-04]
 [-3.28488163e-02]
 [-9.96955811e-04]
 [-2.63671817e-02]
 [ 2.70619841e-03]
 [ 3.71560743e-03]
 [-1.99388091e-03]
 [ 1.12598643e-02]
 [ 5.07733711e-02]
 [ 1.58144212e-02]
 [ 3.83082430e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.06000592]
curr_Stock_Price:  99.35727212654683
curr_Factors:  [99.35727213]
mat_Sqrt:  [[0.15]]
grads:  [0.1185977]
Stock Position:  0.11859769524111465
Bond Position:  [-19.8435494]


portfolio before change:  [-7.9981497]
curr_Stock_Price:  99.92067037834059
curr_Factors:  [99.92067038]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011156]
Stock Position:  -0.01011156322856396
Bond Position:  [-6.98779552]


portfolio before change:  [-7.99061883]
curr_Stock_Price:  99.00310365468509
curr_Factors:  [99.00310365]
mat_Sqrt:  [[0.15]]
grads:  [0.02763214]
Stock Position:  0.027632143988742426
Bond Position:  [-10.72628685]


portfolio before change:  [-7.96138027]
curr_Stock_Price:  100.1582970500318
curr_Factors:  [100.15829705]
mat_Sqrt:  [[0.15]]
grads:  [0.02014162]
Stock Position:  0.020141619787073236
Bond Position:  [-9.9787306]


portfolio before change:  [-7.95179694]
curr_Stock_Price:  100.75796700851896
curr_Factors:  [100.75796701]
mat_Sqrt:  [[0.15]]
grads:  [0.04609407]
Stock Position:  0.04609407389742116
Bond Position:  [-12.59614211]


portfolio before change:  [-7.96961859]
curr_Stock_Price:  100.43965656377803
curr_Factors:  [100.43965656]
mat_Sqrt:  [[0.15]]
grads:  [0.06322168]
Stock Position:  0.06322168377347309
Bond Position:  [-14.3195828]


portfolio before change:  [-8.00780807]
curr_Stock_Price:  99.89223151915988
curr_Factors:  [99.89223152]
mat_Sqrt:  [[0.15]]
grads:  [-0.07959476]
Stock Position:  -0.07959476053423534
Bond Position:  [-0.05690982]


portfolio before change:  [-8.049396]
curr_Stock_Price:  100.41454860009969
curr_Factors:  [100.4145486]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535866]
Stock Position:  -0.01535865730123537
Bond Position:  [-6.50716336]


portfolio before change:  [-8.03527626]
curr_Stock_Price:  99.38928116021506
curr_Factors:  [99.38928116]
mat_Sqrt:  [[0.15]]
grads:  [-0.00145518]
Stock Position:  -0.0014551788988575662
Bond Position:  [-7.89064708]


portfolio before change:  [-8.03699763]
curr_Stock_Price:  99.21641990251241
curr_Factors:  [99.2164199]
mat_Sqrt:  [[0.15]]
grads:  [-0.21899211]
Stock Position:  -0.21899210837104796
Bond Position:  [13.69061535]


portfolio before change:  [-7.74985068]
curr_Stock_Price:  97.92083045764615
curr_Factors:  [97.92083046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00664637]
Stock Position:  -0.006646372075865005
Bond Position:  [-7.09903241]


portfolio before change:  [-7.73784881]
curr_Stock_Price:  95.84799216378228
curr_Factors:  [95.84799216]
mat_Sqrt:  [[0.15]]
grads:  [-0.17578121]
Stock Position:  -0.17578121114317163
Bond Position:  [9.11042734]


portfolio before change:  [-7.89578383]
curr_Stock_Price:  96.75942586307036
curr_Factors:  [96.75942586]
mat_Sqrt:  [[0.15]]
grads:  [0.01804132]
Stock Position:  0.018041322711368435
Bond Position:  [-9.64145186]


portfolio before change:  [-7.87099859]
curr_Stock_Price:  98.26684911955378
curr_Factors:  [98.26684912]
mat_Sqrt:  [[0.15]]
grads:  [0.02477072]
Stock Position:  0.02477071619608575
Bond Position:  [-10.30513882]


portfolio before change:  [-7.89249906]
curr_Stock_Price:  97.50288781242705
curr_Factors:  [97.50288781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01329254]
Stock Position:  -0.0132925393854786
Bond Position:  [-6.59643809]


portfolio before change:  [-7.88471156]
curr_Stock_Price:  96.79295448323096
curr_Factors:  [96.79295448]
mat_Sqrt:  [[0.15]]
grads:  [0.07506576]
Stock Position:  0.07506576210929138
Bond Position:  [-15.15054846]


portfolio before change:  [-7.84330547]
curr_Stock_Price:  97.395015970012
curr_Factors:  [97.39501597]
mat_Sqrt:  [[0.15]]
grads:  [0.33848914]
Stock Position:  0.33848914063876157
Bond Position:  [-40.81046073]


portfolio before change:  [-6.83430985]
curr_Stock_Price:  100.40604171083066
curr_Factors:  [100.40604171]
mat_Sqrt:  [[0.15]]
grads:  [0.10542947]
Stock Position:  0.10542947451229134
Bond Position:  [-17.42006606]


portfolio before change:  [-6.94139341]
curr_Stock_Price:  99.43166521794376
curr_Factors:  [99.43166522]
mat_Sqrt:  [[0.15]]
grads:  [0.02553883]
Stock Position:  0.025538828683926252
Bond Position:  [-9.48076167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.94139341]
Stock Price:  100.0521158163662
PL:  [-6.99350922]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.79329338e-03]
 [-8.04485399e-03]
 [-4.37013521e-04]
 [ 3.32620376e-03]
 [ 8.04844608e-03]
 [ 1.14024633e-02]
 [-5.86730052e-03]
 [-6.13130152e-04]
 [ 4.70740754e-04]
 [ 4.34859820e-02]
 [-1.12147184e-02]
 [-2.10124995e-02]
 [-1.20645828e-03]
 [-1.90278451e-02]
 [ 1.21584123e-02]
 [ 6.86743126e-03]
 [-2.94728456e-02]
 [-1.73304541e-02]
 [ 4.67214319e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.03528544]
curr_Stock_Price:  99.62046468957392
curr_Factors:  [99.62046469]
mat_Sqrt:  [[0.15]]
grads:  [0.05862196]
Stock Position:  0.05862195587755396
Bond Position:  [-9.87523192]


portfolio before change:  [-3.98130264]
curr_Stock_Price:  100.58344714214391
curr_Factors:  [100.58344714]
mat_Sqrt:  [[0.15]]
grads:  [-0.05363236]
Stock Position:  -0.05363235995159943
Bond Position:  [1.413225]


portfolio before change:  [-3.92104004]
curr_Stock_Price:  99.46641171612471
curr_Factors:  [99.46641172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00291342]
Stock Position:  -0.0029134234719674704
Bond Position:  [-3.63125226]


portfolio before change:  [-3.91917485]
curr_Stock_Price:  98.51457032463308
curr_Factors:  [98.51457032]
mat_Sqrt:  [[0.15]]
grads:  [0.02217469]
Stock Position:  0.022174691734622165
Bond Position:  [-6.10370508]


portfolio before change:  [-3.90008652]
curr_Stock_Price:  99.44420899304632
curr_Factors:  [99.44420899]
mat_Sqrt:  [[0.15]]
grads:  [0.05365631]
Stock Position:  0.053656307169657115
Bond Position:  [-9.23589554]


portfolio before change:  [-3.9573874]
curr_Stock_Price:  98.4193225606139
curr_Factors:  [98.41932256]
mat_Sqrt:  [[0.15]]
grads:  [0.07601642]
Stock Position:  0.07601642214717334
Bond Position:  [-11.43887217]


portfolio before change:  [-3.81389168]
curr_Stock_Price:  100.34464079036172
curr_Factors:  [100.34464079]
mat_Sqrt:  [[0.15]]
grads:  [-0.03911534]
Stock Position:  -0.03911533680047511
Bond Position:  [0.11112275]


portfolio before change:  [-3.85686007]
curr_Stock_Price:  101.44385616516006
curr_Factors:  [101.44385617]
mat_Sqrt:  [[0.15]]
grads:  [-0.00408753]
Stock Position:  -0.0040875343441998035
Bond Position:  [-3.44220482]


portfolio before change:  [-3.86481952]
curr_Stock_Price:  103.18054865582195
curr_Factors:  [103.18054866]
mat_Sqrt:  [[0.15]]
grads:  [0.00313827]
Stock Position:  0.003138271690159766
Bond Position:  [-4.18862811]


portfolio before change:  [-3.86607697]
curr_Stock_Price:  103.1135814446585
curr_Factors:  [103.11358144]
mat_Sqrt:  [[0.15]]
grads:  [0.28990655]
Stock Position:  0.28990654674367966
Bond Position:  [-33.75937929]


portfolio before change:  [-3.76804703]
curr_Stock_Price:  103.48084061667645
curr_Factors:  [103.48084062]
mat_Sqrt:  [[0.15]]
grads:  [-0.07476479]
Stock Position:  -0.0747647893333768
Bond Position:  [3.96867622]


portfolio before change:  [-3.71950623]
curr_Stock_Price:  102.8448660733124
curr_Factors:  [102.84486607]
mat_Sqrt:  [[0.15]]
grads:  [-0.14008333]
Stock Position:  -0.14008333014647462
Bond Position:  [10.68734509]


portfolio before change:  [-3.86478704]
curr_Stock_Price:  103.90104438313531
curr_Factors:  [103.90104438]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804306]
Stock Position:  -0.008043055229074324
Bond Position:  [-3.0291052]


portfolio before change:  [-3.85868265]
curr_Stock_Price:  103.0479153251048
curr_Factors:  [103.04791533]
mat_Sqrt:  [[0.15]]
grads:  [-0.1268523]
Stock Position:  -0.12685230095829494
Bond Position:  [9.21318252]


portfolio before change:  [-4.22096816]
curr_Stock_Price:  105.9220382021068
curr_Factors:  [105.9220382]
mat_Sqrt:  [[0.15]]
grads:  [0.08105608]
Stock Position:  0.08105608180024095
Bond Position:  [-12.80659356]


portfolio before change:  [-4.23320562]
curr_Stock_Price:  105.81056711963834
curr_Factors:  [105.81056712]
mat_Sqrt:  [[0.15]]
grads:  [0.04578288]
Stock Position:  0.0457828750778323
Bond Position:  [-9.0775176]


portfolio before change:  [-4.20702841]
curr_Stock_Price:  106.43191023141794
curr_Factors:  [106.43191023]
mat_Sqrt:  [[0.15]]
grads:  [-0.19648564]
Stock Position:  -0.19648563765703603
Bond Position:  [16.70531334]


portfolio before change:  [-3.97633945]
curr_Stock_Price:  105.27909260927758
curr_Factors:  [105.27909261]
mat_Sqrt:  [[0.15]]
grads:  [-0.11553636]
Stock Position:  -0.11553636040780661
Bond Position:  [8.18722373]


portfolio before change:  [-4.109463]
curr_Stock_Price:  106.449032621202
curr_Factors:  [106.44903262]
mat_Sqrt:  [[0.15]]
grads:  [0.03114762]
Stock Position:  0.031147621254157053
Bond Position:  [-7.42509715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.109463]
Stock Price:  105.94484930758993
PL:  [-10.05431231]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.19624834e-01]
 [ 6.13324169e-03]
 [-1.07119135e-02]
 [ 2.96109515e-03]
 [ 7.36531182e-03]
 [ 4.50855365e-03]
 [-1.32258643e-03]
 [-8.64978555e-05]
 [-3.67634731e-04]
 [ 1.04023031e-03]
 [-3.42280814e-03]
 [-2.17534657e-02]
 [-4.79523730e-04]
 [-8.38250585e-03]
 [-2.42717704e-03]
 [ 1.20360594e-02]
 [-5.74792673e-04]
 [-2.58950972e-02]
 [ 3.85343535e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.56444548]
curr_Stock_Price:  98.34337483845809
curr_Factors:  [98.34337484]
mat_Sqrt:  [[0.15]]
grads:  [0.79749889]
Stock Position:  0.7974988943636635
Bond Position:  [-101.99317818]


portfolio before change:  [-22.81387827]
curr_Stock_Price:  99.31650307306754
curr_Factors:  [99.31650307]
mat_Sqrt:  [[0.15]]
grads:  [0.04088828]
Stock Position:  0.04088827792396934
Bond Position:  [-26.87475905]


portfolio before change:  [-22.77535284]
curr_Stock_Price:  100.42305389414147
curr_Factors:  [100.42305389]
mat_Sqrt:  [[0.15]]
grads:  [-0.07141276]
Stock Position:  -0.07141275667698296
Bond Position:  [-15.60386573]


portfolio before change:  [-22.76318803]
curr_Stock_Price:  100.19807640253912
curr_Factors:  [100.1980764]
mat_Sqrt:  [[0.15]]
grads:  [0.01974063]
Stock Position:  0.01974063436575331
Bond Position:  [-24.74116162]


portfolio before change:  [-22.76995355]
curr_Stock_Price:  100.16872324769383
curr_Factors:  [100.16872325]
mat_Sqrt:  [[0.15]]
grads:  [0.04910208]
Stock Position:  0.04910207879058861
Bond Position:  [-27.68844609]


portfolio before change:  [-22.70685987]
curr_Stock_Price:  101.59466399067831
curr_Factors:  [101.59466399]
mat_Sqrt:  [[0.15]]
grads:  [0.03005702]
Stock Position:  0.030057024330573483
Bond Position:  [-25.76049316]


portfolio before change:  [-22.74160083]
curr_Stock_Price:  100.65311934438611
curr_Factors:  [100.65311934]
mat_Sqrt:  [[0.15]]
grads:  [-0.00881724]
Stock Position:  -0.008817242836472635
Bond Position:  [-21.85411783]


portfolio before change:  [-22.758833]
curr_Stock_Price:  101.98777172807405
curr_Factors:  [101.98777173]
mat_Sqrt:  [[0.15]]
grads:  [-0.00057665]
Stock Position:  -0.0005766523701621916
Bond Position:  [-22.70002151]


portfolio before change:  [-22.76458994]
curr_Stock_Price:  102.12863460302617
curr_Factors:  [102.1286346]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024509]
Stock Position:  -0.0024508982078202107
Bond Position:  [-22.51428305]


portfolio before change:  [-22.76692412]
curr_Stock_Price:  100.7841926360571
curr_Factors:  [100.78419264]
mat_Sqrt:  [[0.15]]
grads:  [0.00693487]
Stock Position:  0.006934868738988258
Bond Position:  [-23.46584927]


portfolio before change:  [-22.77497215]
curr_Stock_Price:  100.4697196531156
curr_Factors:  [100.46971965]
mat_Sqrt:  [[0.15]]
grads:  [-0.02281872]
Stock Position:  -0.022818720900122914
Bond Position:  [-20.48238166]


portfolio before change:  [-22.81643226]
curr_Stock_Price:  102.06222228971896
curr_Factors:  [102.06222229]
mat_Sqrt:  [[0.15]]
grads:  [-0.1450231]
Stock Position:  -0.14502310446169903
Bond Position:  [-8.01505193]


portfolio before change:  [-22.87085434]
curr_Stock_Price:  102.42366865635239
curr_Factors:  [102.42366866]
mat_Sqrt:  [[0.15]]
grads:  [-0.00319682]
Stock Position:  -0.0031968248689789756
Bond Position:  [-22.54342381]


portfolio before change:  [-22.87189767]
curr_Stock_Price:  100.98685879032607
curr_Factors:  [100.98685879]
mat_Sqrt:  [[0.15]]
grads:  [-0.05588337]
Stock Position:  -0.0558833723301199
Bond Position:  [-17.22841144]


portfolio before change:  [-22.73439948]
curr_Stock_Price:  98.44932696435451
curr_Factors:  [98.44932696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01618118]
Stock Position:  -0.016181180253227474
Bond Position:  [-21.14137317]


portfolio before change:  [-22.72999466]
curr_Stock_Price:  97.85043208722634
curr_Factors:  [97.85043209]
mat_Sqrt:  [[0.15]]
grads:  [0.0802404]
Stock Position:  0.08024039579016963
Bond Position:  [-30.58155206]


portfolio before change:  [-22.51456551]
curr_Stock_Price:  100.6305217096937
curr_Factors:  [100.63052171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383195]
Stock Position:  -0.00383195115229625
Bond Position:  [-22.12895427]


portfolio before change:  [-22.52562548]
curr_Stock_Price:  102.07287733340142
curr_Factors:  [102.07287733]
mat_Sqrt:  [[0.15]]
grads:  [-0.17263398]
Stock Position:  -0.17263398147455358
Bond Position:  [-4.90437826]


portfolio before change:  [-22.41167607]
curr_Stock_Price:  101.4057105531186
curr_Factors:  [101.40571055]
mat_Sqrt:  [[0.15]]
grads:  [0.02568957]
Stock Position:  0.025689568993235424
Bond Position:  [-25.01674506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.41167607]
Stock Price:  101.3735438471737
PL:  [-23.78521991]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.87409495e-02]
 [ 8.74867613e-03]
 [ 7.28489490e-03]
 [ 3.17455984e-03]
 [ 7.57810361e-03]
 [-2.84247196e-03]
 [-3.95185602e-03]
 [ 1.06705667e-03]
 [ 4.22069903e-03]
 [ 3.85660493e-02]
 [-1.28859066e-02]
 [-1.89150978e-02]
 [-2.65311200e-03]
 [-2.13578131e-02]
 [ 1.37263147e-02]
 [ 4.65655577e-03]
 [-1.21638559e-02]
 [-8.90334977e-03]
 [ 4.94736637e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.0113158]
curr_Stock_Price:  99.29506217070221
curr_Factors:  [99.29506217]
mat_Sqrt:  [[0.15]]
grads:  [0.12493966]
Stock Position:  0.12493966321512187
Bond Position:  [-21.41720742]


portfolio before change:  [-9.15960913]
curr_Stock_Price:  98.1510030548215
curr_Factors:  [98.15100305]
mat_Sqrt:  [[0.15]]
grads:  [0.05832451]
Stock Position:  0.058324507541374186
Bond Position:  [-14.88421805]


portfolio before change:  [-9.13834245]
curr_Stock_Price:  98.57943698417975
curr_Factors:  [98.57943698]
mat_Sqrt:  [[0.15]]
grads:  [0.04856597]
Stock Position:  0.048565965999739134
Bond Position:  [-13.92594803]


portfolio before change:  [-9.07006998]
curr_Stock_Price:  100.0568994189111
curr_Factors:  [100.05689942]
mat_Sqrt:  [[0.15]]
grads:  [0.02116373]
Stock Position:  0.02116373224675452
Bond Position:  [-11.18764741]


portfolio before change:  [-9.07499716]
curr_Stock_Price:  99.95625942424367
curr_Factors:  [99.95625942]
mat_Sqrt:  [[0.15]]
grads:  [0.05052069]
Stock Position:  0.050520690724761966
Bond Position:  [-14.12485643]


portfolio before change:  [-8.96917403]
curr_Stock_Price:  102.1208139227143
curr_Factors:  [102.12081392]
mat_Sqrt:  [[0.15]]
grads:  [-0.01894981]
Stock Position:  -0.018949813041071926
Bond Position:  [-7.0340037]


portfolio before change:  [-8.98741481]
curr_Stock_Price:  102.99058834811377
curr_Factors:  [102.99058835]
mat_Sqrt:  [[0.15]]
grads:  [-0.02634571]
Stock Position:  -0.026345706819581954
Bond Position:  [-6.27405497]


portfolio before change:  [-9.01968249]
curr_Stock_Price:  104.15582440555202
curr_Factors:  [104.15582441]
mat_Sqrt:  [[0.15]]
grads:  [0.00711371]
Stock Position:  0.007113711162308701
Bond Position:  [-9.76061694]


portfolio before change:  [-9.01207774]
curr_Stock_Price:  105.56791590168056
curr_Factors:  [105.5679159]
mat_Sqrt:  [[0.15]]
grads:  [0.02813799]
Stock Position:  0.02813799350133095
Bond Position:  [-11.98254707]


portfolio before change:  [-9.09576374]
curr_Stock_Price:  102.70026340024572
curr_Factors:  [102.7002634]
mat_Sqrt:  [[0.15]]
grads:  [0.257107]
Stock Position:  0.25710699554241234
Bond Position:  [-35.5007199]


portfolio before change:  [-8.56764274]
curr_Stock_Price:  104.78887743956601
curr_Factors:  [104.78887744]
mat_Sqrt:  [[0.15]]
grads:  [-0.08590604]
Stock Position:  -0.08590604378284501
Bond Position:  [0.43435515]


portfolio before change:  [-8.6013519]
curr_Stock_Price:  105.18253721885034
curr_Factors:  [105.18253722]
mat_Sqrt:  [[0.15]]
grads:  [-0.12610065]
Stock Position:  -0.12610065171093904
Bond Position:  [4.6622346]


portfolio before change:  [-8.783526]
curr_Stock_Price:  106.63645362987106
curr_Factors:  [106.63645363]
mat_Sqrt:  [[0.15]]
grads:  [-0.01768741]
Stock Position:  -0.01768741330485629
Bond Position:  [-6.89740297]


portfolio before change:  [-8.74784806]
curr_Stock_Price:  104.52181400131086
curr_Factors:  [104.521814]
mat_Sqrt:  [[0.15]]
grads:  [-0.14238542]
Stock Position:  -0.14238542038398427
Bond Position:  [6.13453437]


portfolio before change:  [-9.01452501]
curr_Stock_Price:  106.40550951287044
curr_Factors:  [106.40550951]
mat_Sqrt:  [[0.15]]
grads:  [0.09150876]
Stock Position:  0.0915087647039499
Bond Position:  [-18.75156175]


portfolio before change:  [-8.93608381]
curr_Stock_Price:  107.31394362399281
curr_Factors:  [107.31394362]
mat_Sqrt:  [[0.15]]
grads:  [0.03104371]
Stock Position:  0.031043705122282064
Bond Position:  [-12.26750623]


portfolio before change:  [-8.90130785]
curr_Stock_Price:  108.53297401071544
curr_Factors:  [108.53297401]
mat_Sqrt:  [[0.15]]
grads:  [-0.08109237]
Stock Position:  -0.081092372827479
Bond Position:  [-0.10011145]


portfolio before change:  [-8.76992627]
curr_Stock_Price:  106.91251814979144
curr_Factors:  [106.91251815]
mat_Sqrt:  [[0.15]]
grads:  [-0.05935567]
Stock Position:  -0.05935566513840085
Bond Position:  [-2.42406264]


portfolio before change:  [-8.84615011]
curr_Stock_Price:  108.18649513566912
curr_Factors:  [108.18649514]
mat_Sqrt:  [[0.15]]
grads:  [0.03298244]
Stock Position:  0.03298244248553492
Bond Position:  [-12.41440496]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.84615011]
Stock Price:  109.76441000950854
PL:  [-18.61056012]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.91025117e-02]
 [-7.80714877e-03]
 [-4.76787395e-04]
 [ 2.41819503e-03]
 [ 5.85305733e-03]
 [ 8.03943323e-03]
 [-7.09363283e-03]
 [-2.17570166e-03]
 [-1.13991419e-03]
 [ 3.52835062e-02]
 [-1.14410480e-02]
 [-1.94656656e-02]
 [-7.96288724e-04]
 [-1.96631040e-02]
 [ 5.35284874e-03]
 [ 8.71013727e-03]
 [-4.86288792e-02]
 [-2.69278860e-02]
 [ 4.57898059e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.6522021]
curr_Stock_Price:  101.75803018150509
curr_Factors:  [101.75803018]
mat_Sqrt:  [[0.15]]
grads:  [-0.26068341]
Stock Position:  -0.26068341100656656
Bond Position:  [55.1788325]


portfolio before change:  [28.7900669]
curr_Stock_Price:  101.28209513956699
curr_Factors:  [101.28209514]
mat_Sqrt:  [[0.15]]
grads:  [-0.05204766]
Stock Position:  -0.05204765844582025
Bond Position:  [34.0615628]


portfolio before change:  [28.77621751]
curr_Stock_Price:  101.71181379286162
curr_Factors:  [101.71181379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00317858]
Stock Position:  -0.003178582634312729
Bond Position:  [29.09951691]


portfolio before change:  [28.78496441]
curr_Stock_Price:  101.24899333825711
curr_Factors:  [101.24899334]
mat_Sqrt:  [[0.15]]
grads:  [0.0161213]
Stock Position:  0.016121300230104888
Bond Position:  [27.15269899]


portfolio before change:  [28.81013675]
curr_Stock_Price:  102.3893058781803
curr_Factors:  [102.38930588]
mat_Sqrt:  [[0.15]]
grads:  [0.03902038]
Stock Position:  0.03902038220221605
Bond Position:  [24.8148669]


portfolio before change:  [28.77547267]
curr_Stock_Price:  101.34194115292176
curr_Factors:  [101.34194115]
mat_Sqrt:  [[0.15]]
grads:  [0.05359622]
Stock Position:  0.053596221536415675
Bond Position:  [23.34392754]


portfolio before change:  [28.72296065]
curr_Stock_Price:  100.25326858914477
curr_Factors:  [100.25326859]
mat_Sqrt:  [[0.15]]
grads:  [-0.04729089]
Stock Position:  -0.0472908855480101
Bond Position:  [33.4640265]


portfolio before change:  [28.73707518]
curr_Stock_Price:  100.1317338972883
curr_Factors:  [100.1317339]
mat_Sqrt:  [[0.15]]
grads:  [-0.01450468]
Stock Position:  -0.014504677726397857
Bond Position:  [30.18945371]


portfolio before change:  [28.7286517]
curr_Stock_Price:  101.23288140822262
curr_Factors:  [101.23288141]
mat_Sqrt:  [[0.15]]
grads:  [-0.00759943]
Stock Position:  -0.0075994279617938604
Bond Position:  [29.49796369]


portfolio before change:  [28.72632136]
curr_Stock_Price:  102.51005077837398
curr_Factors:  [102.51005078]
mat_Sqrt:  [[0.15]]
grads:  [0.23522337]
Stock Position:  0.23522337442150942
Bond Position:  [4.6135613]


portfolio before change:  [28.99749668]
curr_Stock_Price:  103.65798853070687
curr_Factors:  [103.65798853]
mat_Sqrt:  [[0.15]]
grads:  [-0.07627365]
Stock Position:  -0.07627365357241671
Bond Position:  [36.90387019]


portfolio before change:  [28.9407851]
curr_Stock_Price:  104.52249019201075
curr_Factors:  [104.52249019]
mat_Sqrt:  [[0.15]]
grads:  [-0.1297711]
Stock Position:  -0.1297711042656091
Bond Position:  [42.50478408]


portfolio before change:  [29.1363369]
curr_Stock_Price:  103.0974867083445
curr_Factors:  [103.09748671]
mat_Sqrt:  [[0.15]]
grads:  [-0.00530859]
Stock Position:  -0.005308591494098515
Bond Position:  [29.68363935]


portfolio before change:  [29.14188862]
curr_Stock_Price:  103.44976942248093
curr_Factors:  [103.44976942]
mat_Sqrt:  [[0.15]]
grads:  [-0.13108736]
Stock Position:  -0.13108735984464479
Bond Position:  [42.70284577]


portfolio before change:  [29.0851677]
curr_Stock_Price:  103.96391480627754
curr_Factors:  [103.96391481]
mat_Sqrt:  [[0.15]]
grads:  [0.03568566]
Stock Position:  0.03568565829352349
Bond Position:  [25.37514696]


portfolio before change:  [29.04795073]
curr_Stock_Price:  102.74321291435481
curr_Factors:  [102.74321291]
mat_Sqrt:  [[0.15]]
grads:  [0.05806758]
Stock Position:  0.05806758182117122
Bond Position:  [23.08190081]


portfolio before change:  [29.02645034]
curr_Stock_Price:  102.27356028007986
curr_Factors:  [102.27356028]
mat_Sqrt:  [[0.15]]
grads:  [-0.32419253]
Stock Position:  -0.3241925282579533
Bond Position:  [62.18277442]


portfolio before change:  [28.95506136]
curr_Stock_Price:  102.54172380716422
curr_Factors:  [102.54172381]
mat_Sqrt:  [[0.15]]
grads:  [-0.17951924]
Stock Position:  -0.17951924011967116
Bond Position:  [47.3632737]


portfolio before change:  [28.98525958]
curr_Stock_Price:  102.4394733704424
curr_Factors:  [102.43947337]
mat_Sqrt:  [[0.15]]
grads:  [0.03052654]
Stock Position:  0.030526537264581283
Bond Position:  [25.85813718]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.98525958]
Stock Price:  101.25018763941043
PL:  [27.73507194]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.61330155e-02]
 [-7.81487821e-03]
 [-1.05016064e-02]
 [ 2.26554485e-03]
 [ 6.20245744e-03]
 [-9.24601071e-04]
 [-3.79046320e-03]
 [ 8.26908749e-04]
 [ 1.24698939e-03]
 [ 3.64754534e-02]
 [-6.14997707e-03]
 [-2.24764169e-02]
 [ 1.51962361e-04]
 [-1.88541600e-02]
 [-2.03427753e-03]
 [ 1.06532895e-02]
 [ 6.75072402e-03]
 [-4.17387079e-03]
 [ 3.75731605e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.75229657]
curr_Stock_Price:  100.52208979895943
curr_Factors:  [100.5220898]
mat_Sqrt:  [[0.15]]
grads:  [0.24088677]
Stock Position:  0.2408867703016406
Bond Position:  [-14.46214498]


portfolio before change:  [9.92732869]
curr_Stock_Price:  101.26371666275926
curr_Factors:  [101.26371666]
mat_Sqrt:  [[0.15]]
grads:  [-0.05209919]
Stock Position:  -0.05209918808741378
Bond Position:  [15.20308611]


portfolio before change:  [9.96737466]
curr_Stock_Price:  100.56802972887091
curr_Factors:  [100.56802973]
mat_Sqrt:  [[0.15]]
grads:  [-0.07001071]
Stock Position:  -0.07001070951000407
Bond Position:  [17.00821377]


portfolio before change:  [9.943561]
curr_Stock_Price:  100.96891476655972
curr_Factors:  [100.96891477]
mat_Sqrt:  [[0.15]]
grads:  [0.01510363]
Stock Position:  0.01510363235765881
Bond Position:  [8.41856363]


portfolio before change:  [9.95700136]
curr_Stock_Price:  101.71942726564225
curr_Factors:  [101.71942727]
mat_Sqrt:  [[0.15]]
grads:  [0.04134972]
Stock Position:  0.04134971625714907
Bond Position:  [5.75093191]


portfolio before change:  [9.96936036]
curr_Stock_Price:  101.98354224256725
curr_Factors:  [101.98354224]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616401]
Stock Position:  -0.006164007142233618
Bond Position:  [10.59798764]


portfolio before change:  [9.96605703]
curr_Stock_Price:  102.94933450071463
curr_Factors:  [102.9493345]
mat_Sqrt:  [[0.15]]
grads:  [-0.02526975]
Stock Position:  -0.025269754658947714
Bond Position:  [12.56756146]


portfolio before change:  [9.95746906]
curr_Stock_Price:  103.41353580192846
curr_Factors:  [103.4135358]
mat_Sqrt:  [[0.15]]
grads:  [0.00551272]
Stock Position:  0.005512724992202794
Bond Position:  [9.38737868]


portfolio before change:  [9.96106692]
curr_Stock_Price:  103.64041381635407
curr_Factors:  [103.64041382]
mat_Sqrt:  [[0.15]]
grads:  [0.00831326]
Stock Position:  0.00831326257383282
Bond Position:  [9.09947695]


portfolio before change:  [9.95451926]
curr_Stock_Price:  102.57912021616573
curr_Factors:  [102.57912022]
mat_Sqrt:  [[0.15]]
grads:  [0.24316969]
Stock Position:  0.24316968940731346
Bond Position:  [-14.98961354]


portfolio before change:  [9.65105007]
curr_Stock_Price:  101.34655985989643
curr_Factors:  [101.34655986]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099985]
Stock Position:  -0.0409998471294189
Bond Position:  [13.80624353]


portfolio before change:  [9.66175723]
curr_Stock_Price:  101.16960390154166
curr_Factors:  [101.1696039]
mat_Sqrt:  [[0.15]]
grads:  [-0.14984278]
Stock Position:  -0.14984277911073038
Bond Position:  [24.82129184]


portfolio before change:  [9.68079849]
curr_Stock_Price:  101.08394634017736
curr_Factors:  [101.08394634]
mat_Sqrt:  [[0.15]]
grads:  [0.00101308]
Stock Position:  0.0010130824039945546
Bond Position:  [9.57839213]


portfolio before change:  [9.68507175]
curr_Stock_Price:  102.93804502526129
curr_Factors:  [102.93804503]
mat_Sqrt:  [[0.15]]
grads:  [-0.1256944]
Stock Position:  -0.12569440013623948
Bond Position:  [22.62380757]


portfolio before change:  [9.88573818]
curr_Stock_Price:  101.38658551350684
curr_Factors:  [101.38658551]
mat_Sqrt:  [[0.15]]
grads:  [-0.01356185]
Stock Position:  -0.013561850178853358
Bond Position:  [11.26072786]


portfolio before change:  [9.89734719]
curr_Stock_Price:  100.73818749451576
curr_Factors:  [100.73818749]
mat_Sqrt:  [[0.15]]
grads:  [0.07102193]
Stock Position:  0.0710219296691576
Bond Position:  [2.74272672]


portfolio before change:  [9.87344793]
curr_Stock_Price:  100.3920264493151
curr_Factors:  [100.39202645]
mat_Sqrt:  [[0.15]]
grads:  [0.04500483]
Stock Position:  0.04500482682412368
Bond Position:  [5.35532217]


portfolio before change:  [9.90963212]
curr_Stock_Price:  101.1662810461859
curr_Factors:  [101.16628105]
mat_Sqrt:  [[0.15]]
grads:  [-0.02782581]
Stock Position:  -0.027825805285447265
Bond Position:  [12.72466536]


portfolio before change:  [9.94027414]
curr_Stock_Price:  100.17941107277477
curr_Factors:  [100.17941107]
mat_Sqrt:  [[0.15]]
grads:  [0.02504877]
Stock Position:  0.02504877363906682
Bond Position:  [7.43090275]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.94027414]
Stock Price:  101.82401742707015
PL:  [8.11625671]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.64014302e-02]
 [ 8.87720551e-03]
 [ 2.43299112e-02]
 [-4.34941055e-03]
 [ 9.10364824e-03]
 [ 6.38538422e-02]
 [ 4.16054003e-03]
 [ 9.04556050e-03]
 [ 1.15302812e-02]
 [-3.73282739e-02]
 [ 1.76637903e-03]
 [-2.64209793e-02]
 [ 1.42652796e-03]
 [-7.01052347e-03]
 [ 2.80007534e-04]
 [ 4.13108679e-03]
 [-2.62642343e-02]
 [ 1.12882111e-02]
 [-1.00076325e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.70814811]
curr_Stock_Price:  100.51920275431661
curr_Factors:  [100.51920275]
mat_Sqrt:  [[0.15]]
grads:  [0.2426762]
Stock Position:  0.24267620119070174
Bond Position:  [-14.68547016]


portfolio before change:  [9.04600728]
curr_Stock_Price:  97.8058381829563
curr_Factors:  [97.80583818]
mat_Sqrt:  [[0.15]]
grads:  [0.05918137]
Stock Position:  0.05918137009133292
Bond Position:  [3.25772377]


portfolio before change:  [9.01143055]
curr_Stock_Price:  97.20782463016376
curr_Factors:  [97.20782463]
mat_Sqrt:  [[0.15]]
grads:  [0.16219941]
Stock Position:  0.16219940777052103
Bond Position:  [-6.75562104]


portfolio before change:  [8.80164153]
curr_Stock_Price:  95.92483659959647
curr_Factors:  [95.9248366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899607]
Stock Position:  -0.028996070309231025
Bond Position:  [11.58308484]


portfolio before change:  [8.80366604]
curr_Stock_Price:  95.95489684084576
curr_Factors:  [95.95489684]
mat_Sqrt:  [[0.15]]
grads:  [0.06069099]
Stock Position:  0.060690988254261995
Bond Position:  [2.98006852]


portfolio before change:  [8.72326315]
curr_Stock_Price:  94.61782846868557
curr_Factors:  [94.61782847]
mat_Sqrt:  [[0.15]]
grads:  [0.42569228]
Stock Position:  0.4256922813507907
Bond Position:  [-31.55481611]


portfolio before change:  [8.10802033]
curr_Stock_Price:  93.19108631118526
curr_Factors:  [93.19108631]
mat_Sqrt:  [[0.15]]
grads:  [0.02773693]
Stock Position:  0.027736933516006083
Bond Position:  [5.52318537]


portfolio before change:  [8.13879868]
curr_Stock_Price:  94.25095025341982
curr_Factors:  [94.25095025]
mat_Sqrt:  [[0.15]]
grads:  [0.06030374]
Stock Position:  0.06030373667981731
Bond Position:  [2.45511419]


portfolio before change:  [8.08446154]
curr_Stock_Price:  93.33971329472588
curr_Factors:  [93.33971329]
mat_Sqrt:  [[0.15]]
grads:  [0.07686854]
Stock Position:  0.07686854142205389
Bond Position:  [0.90957392]


portfolio before change:  [8.09700583]
curr_Stock_Price:  93.49994625246532
curr_Factors:  [93.49994625]
mat_Sqrt:  [[0.15]]
grads:  [-0.24885516]
Stock Position:  -0.24885515952572024
Bond Position:  [31.36494987]


portfolio before change:  [8.58288119]
curr_Stock_Price:  91.57901707103129
curr_Factors:  [91.57901707]
mat_Sqrt:  [[0.15]]
grads:  [0.01177586]
Stock Position:  0.011775860220907739
Bond Position:  [7.50445948]


portfolio before change:  [8.58828117]
curr_Stock_Price:  91.87824185374619
curr_Factors:  [91.87824185]
mat_Sqrt:  [[0.15]]
grads:  [-0.17613986]
Stock Position:  -0.17613986193362363
Bond Position:  [24.771702]


portfolio before change:  [8.68138584]
curr_Stock_Price:  91.38482159235546
curr_Factors:  [91.38482159]
mat_Sqrt:  [[0.15]]
grads:  [0.00951019]
Stock Position:  0.009510186430009514
Bond Position:  [7.81229915]


portfolio before change:  [8.6949602]
curr_Stock_Price:  92.60677816862193
curr_Factors:  [92.60677817]
mat_Sqrt:  [[0.15]]
grads:  [-0.04673682]
Stock Position:  -0.04673682316596088
Bond Position:  [13.02310681]


portfolio before change:  [8.64687748]
curr_Stock_Price:  93.7052460938728
curr_Factors:  [93.70524609]
mat_Sqrt:  [[0.15]]
grads:  [0.00186672]
Stock Position:  0.0018667168901441117
Bond Position:  [8.47195631]


portfolio before change:  [8.64752657]
curr_Stock_Price:  92.91821291320286
curr_Factors:  [92.91821291]
mat_Sqrt:  [[0.15]]
grads:  [0.02754058]
Stock Position:  0.027540578604276708
Bond Position:  [6.08850522]


portfolio before change:  [8.6179232]
curr_Stock_Price:  91.78803763175495
curr_Factors:  [91.78803763]
mat_Sqrt:  [[0.15]]
grads:  [-0.1750949]
Stock Position:  -0.17509489566504166
Bond Position:  [24.68954007]


portfolio before change:  [8.64332466]
curr_Stock_Price:  91.67822114391278
curr_Factors:  [91.67822114]
mat_Sqrt:  [[0.15]]
grads:  [0.07525474]
Stock Position:  0.07525474040583298
Bond Position:  [1.74410393]


portfolio before change:  [8.60752864]
curr_Stock_Price:  91.19676172140619
curr_Factors:  [91.19676172]
mat_Sqrt:  [[0.15]]
grads:  [-0.00667175]
Stock Position:  -0.006671754978137302
Bond Position:  [9.21597109]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.60752864]
Stock Price:  93.5210949540913
PL:  [8.60752864]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.18488229e-02]
 [ 8.25168806e-03]
 [ 3.06352010e-03]
 [ 3.84775188e-03]
 [ 7.83276520e-03]
 [ 4.69894165e-03]
 [-7.88720785e-04]
 [ 7.57821704e-04]
 [-2.97226732e-04]
 [ 4.39461725e-02]
 [-1.36167842e-02]
 [-1.98436459e-02]
 [-2.17155291e-03]
 [-2.39780387e-02]
 [ 1.91132529e-02]
 [ 6.27170428e-03]
 [-2.32389196e-02]
 [-2.50475597e-03]
 [ 5.39946834e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.44098029]
curr_Stock_Price:  99.85551067315637
curr_Factors:  [99.85551067]
mat_Sqrt:  [[0.15]]
grads:  [0.14565882]
Stock Position:  0.1456588193498786
Bond Position:  [-14.98581608]


portfolio before change:  [-0.65117553]
curr_Stock_Price:  98.4381689393251
curr_Factors:  [98.43816894]
mat_Sqrt:  [[0.15]]
grads:  [0.05501125]
Stock Position:  0.055011253740881234
Bond Position:  [-6.06638262]


portfolio before change:  [-0.61541837]
curr_Stock_Price:  99.11573835947198
curr_Factors:  [99.11573836]
mat_Sqrt:  [[0.15]]
grads:  [0.02042347]
Stock Position:  0.020423467352182235
Bond Position:  [-2.63970542]


portfolio before change:  [-0.61241948]
curr_Stock_Price:  99.29489037164369
curr_Factors:  [99.29489037]
mat_Sqrt:  [[0.15]]
grads:  [0.02565168]
Stock Position:  0.025651679197152225
Bond Position:  [-3.15950015]


portfolio before change:  [-0.60314504]
curr_Stock_Price:  99.6872395357661
curr_Factors:  [99.68723954]
mat_Sqrt:  [[0.15]]
grads:  [0.05221843]
Stock Position:  0.05221843466486055
Bond Position:  [-5.80865664]


portfolio before change:  [-0.59323466]
curr_Stock_Price:  99.90483931011818
curr_Factors:  [99.90483931]
mat_Sqrt:  [[0.15]]
grads:  [0.03132628]
Stock Position:  0.03132627767241101
Bond Position:  [-3.7228814]


portfolio before change:  [-0.52282881]
curr_Stock_Price:  102.18205488868594
curr_Factors:  [102.18205489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00525814]
Stock Position:  -0.00525813856928254
Bond Position:  [0.01445859]


portfolio before change:  [-0.52817764]
curr_Stock_Price:  103.19999023123435
curr_Factors:  [103.19999023]
mat_Sqrt:  [[0.15]]
grads:  [0.00505214]
Stock Position:  0.005052144695402197
Bond Position:  [-1.04955893]


portfolio before change:  [-0.53339589]
curr_Stock_Price:  102.21905602594245
curr_Factors:  [102.21905603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198151]
Stock Position:  -0.0019815115478363588
Bond Position:  [-0.33084765]


portfolio before change:  [-0.53534037]
curr_Stock_Price:  103.15862064098374
curr_Factors:  [103.15862064]
mat_Sqrt:  [[0.15]]
grads:  [0.29297448]
Stock Position:  0.2929744835428149
Bond Position:  [-30.75818397]


portfolio before change:  [0.10219087]
curr_Stock_Price:  105.3609344439727
curr_Factors:  [105.36093444]
mat_Sqrt:  [[0.15]]
grads:  [-0.09077856]
Stock Position:  -0.09077856153935296
Bond Position:  [9.66670495]


portfolio before change:  [0.22185608]
curr_Stock_Price:  104.06934945016063
curr_Factors:  [104.06934945]
mat_Sqrt:  [[0.15]]
grads:  [-0.13229097]
Stock Position:  -0.13229097258698097
Bond Position:  [13.98929154]


portfolio before change:  [-0.00089899]
curr_Stock_Price:  105.77961604364774
curr_Factors:  [105.77961604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01447702]
Stock Position:  -0.014477019370093836
Bond Position:  [1.53047456]


portfolio before change:  [-0.006926]
curr_Stock_Price:  106.22236452174177
curr_Factors:  [106.22236452]
mat_Sqrt:  [[0.15]]
grads:  [-0.15985359]
Stock Position:  -0.15985359133678295
Bond Position:  [16.97310045]


portfolio before change:  [-0.31790127]
curr_Stock_Price:  108.19428814031214
curr_Factors:  [108.19428814]
mat_Sqrt:  [[0.15]]
grads:  [0.12742169]
Stock Position:  0.1274216862114288
Bond Position:  [-14.1041999]


portfolio before change:  [-0.57298127]
curr_Stock_Price:  106.22010682770579
curr_Factors:  [106.22010683]
mat_Sqrt:  [[0.15]]
grads:  [0.04181136]
Stock Position:  0.04181136189720973
Bond Position:  [-5.0141886]


portfolio before change:  [-0.53374013]
curr_Stock_Price:  107.18861968763241
curr_Factors:  [107.18861969]
mat_Sqrt:  [[0.15]]
grads:  [-0.15492613]
Stock Position:  -0.15492613073469885
Bond Position:  [16.07257797]


portfolio before change:  [-0.85424892]
curr_Stock_Price:  109.28334333179485
curr_Factors:  [109.28334333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01669837]
Stock Position:  -0.01669837312719589
Bond Position:  [0.97060513]


portfolio before change:  [-0.88334922]
curr_Stock_Price:  111.04057961782432
curr_Factors:  [111.04057962]
mat_Sqrt:  [[0.15]]
grads:  [0.03599646]
Stock Position:  0.03599645559971737
Bond Position:  [-4.88041651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.88334922]
Stock Price:  110.4607343141945
PL:  [-11.34408354]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.07458775e-02]
 [-7.96201222e-03]
 [ 6.13142348e-03]
 [ 3.20171121e-03]
 [ 5.45301550e-03]
 [-4.17586454e-02]
 [-1.36481226e-02]
 [ 2.32095648e-03]
 [ 5.11119317e-03]
 [ 8.47253132e-02]
 [-1.60385012e-02]
 [-1.72096643e-02]
 [-4.81400393e-03]
 [-4.38387195e-02]
 [ 3.33572239e-02]
 [-6.99960167e-03]
 [-3.06028948e-02]
 [ 2.08449808e-03]
 [ 5.97335611e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.1453924]
curr_Stock_Price:  98.56696038877031
curr_Factors:  [98.56696039]
mat_Sqrt:  [[0.15]]
grads:  [0.60497252]
Stock Position:  0.6049725166999664
Bond Position:  [-79.77569448]


portfolio before change:  [-18.74552127]
curr_Stock_Price:  100.91387285641947
curr_Factors:  [100.91387286]
mat_Sqrt:  [[0.15]]
grads:  [-0.05308008]
Stock Position:  -0.05308008145214241
Bond Position:  [-13.38900468]


portfolio before change:  [-18.81377602]
curr_Stock_Price:  102.13668703850647
curr_Factors:  [102.13668704]
mat_Sqrt:  [[0.15]]
grads:  [0.04087616]
Stock Position:  0.04087615655594902
Bond Position:  [-22.98873123]


portfolio before change:  [-18.83706706]
curr_Stock_Price:  101.70750908929963
curr_Factors:  [101.70750909]
mat_Sqrt:  [[0.15]]
grads:  [0.02134474]
Stock Position:  0.021344741409813857
Bond Position:  [-21.00798754]


portfolio before change:  [-18.8112842]
curr_Stock_Price:  103.16152118570501
curr_Factors:  [103.16152119]
mat_Sqrt:  [[0.15]]
grads:  [0.03635344]
Stock Position:  0.03635343664144801
Bond Position:  [-22.56156003]


portfolio before change:  [-18.7589286]
curr_Stock_Price:  104.75687797140586
curr_Factors:  [104.75687797]
mat_Sqrt:  [[0.15]]
grads:  [-0.27839097]
Stock Position:  -0.2783909693107589
Bond Position:  [10.4044402]


portfolio before change:  [-19.04267245]
curr_Stock_Price:  105.78545045922895
curr_Factors:  [105.78545046]
mat_Sqrt:  [[0.15]]
grads:  [-0.09098748]
Stock Position:  -0.09098748424474717
Bond Position:  [-9.41752045]


portfolio before change:  [-19.24939713]
curr_Stock_Price:  108.03158362729333
curr_Factors:  [108.03158363]
mat_Sqrt:  [[0.15]]
grads:  [0.01547304]
Stock Position:  0.015473043209678947
Bond Position:  [-20.9209745]


portfolio before change:  [-19.2838083]
curr_Stock_Price:  106.14570600207996
curr_Factors:  [106.145706]
mat_Sqrt:  [[0.15]]
grads:  [0.03407462]
Stock Position:  0.03407462112780199
Bond Position:  [-22.90068301]


portfolio before change:  [-19.26286422]
curr_Stock_Price:  106.92839900795506
curr_Factors:  [106.92839901]
mat_Sqrt:  [[0.15]]
grads:  [0.56483542]
Stock Position:  0.5648354210815982
Bond Position:  [-79.6598115]


portfolio before change:  [-19.0975099]
curr_Stock_Price:  107.2564091642893
curr_Factors:  [107.25640916]
mat_Sqrt:  [[0.15]]
grads:  [-0.10692334]
Stock Position:  -0.10692334109909873
Bond Position:  [-7.62929628]


portfolio before change:  [-19.09628279]
curr_Stock_Price:  107.22709209374153
curr_Factors:  [107.22709209]
mat_Sqrt:  [[0.15]]
grads:  [-0.1147311]
Stock Position:  -0.11473109566636479
Bond Position:  [-6.79400103]


portfolio before change:  [-19.47044654]
curr_Stock_Price:  110.47350960388148
curr_Factors:  [110.4735096]
mat_Sqrt:  [[0.15]]
grads:  [-0.03209336]
Stock Position:  -0.03209335950424192
Bond Position:  [-15.92498048]


portfolio before change:  [-19.5181126]
curr_Stock_Price:  111.8346733245475
curr_Factors:  [111.83467332]
mat_Sqrt:  [[0.15]]
grads:  [-0.29225813]
Stock Position:  -0.2922581302478288
Bond Position:  [13.16647993]


portfolio before change:  [-19.8531063]
curr_Stock_Price:  112.99216288955148
curr_Factors:  [112.99216289]
mat_Sqrt:  [[0.15]]
grads:  [0.22238149]
Stock Position:  0.222381492942367
Bond Position:  [-44.98047218]


portfolio before change:  [-19.63339711]
curr_Stock_Price:  114.03071927669824
curr_Factors:  [114.03071928]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666401]
Stock Position:  -0.0466640111387951
Bond Position:  [-14.31226635]


portfolio before change:  [-19.71160543]
curr_Stock_Price:  115.63002058743422
curr_Factors:  [115.63002059]
mat_Sqrt:  [[0.15]]
grads:  [-0.2040193]
Stock Position:  -0.20401929867198076
Bond Position:  [3.87915027]


portfolio before change:  [-19.4303662]
curr_Stock_Price:  114.25628132286704
curr_Factors:  [114.25628132]
mat_Sqrt:  [[0.15]]
grads:  [0.01389665]
Stock Position:  0.013896653884464538
Bond Position:  [-21.0181462]


portfolio before change:  [-19.42996258]
curr_Stock_Price:  114.66348837251803
curr_Factors:  [114.66348837]
mat_Sqrt:  [[0.15]]
grads:  [0.03982237]
Stock Position:  0.03982237405672385
Bond Position:  [-23.99613491]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.42996258]
Stock Price:  113.99613137126269
PL:  [-33.42609395]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.96913944e-02]
 [-6.21540819e-03]
 [ 1.30049639e-02]
 [ 1.65001553e-03]
 [ 5.20582545e-03]
 [-9.74693220e-03]
 [-4.34433094e-03]
 [ 7.18106183e-04]
 [-1.32900629e-05]
 [ 5.16162372e-02]
 [-1.28691907e-02]
 [-1.67403949e-02]
 [-3.13899488e-03]
 [-2.94421761e-02]
 [ 1.59210359e-02]
 [ 3.83141443e-03]
 [ 8.06060671e-04]
 [-1.32185299e-03]
 [ 5.41889538e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.17501918]
curr_Stock_Price:  100.09197533448697
curr_Factors:  [100.09197533]
mat_Sqrt:  [[0.15]]
grads:  [0.19794263]
Stock Position:  0.19794262909398713
Bond Position:  [-16.63744957]


portfolio before change:  [3.21557613]
curr_Stock_Price:  100.31788337696757
curr_Factors:  [100.31788338]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143605]
Stock Position:  -0.0414360545793413
Bond Position:  [7.37235342]


portfolio before change:  [3.12447687]
curr_Stock_Price:  102.5609196912131
curr_Factors:  [102.56091969]
mat_Sqrt:  [[0.15]]
grads:  [0.08669976]
Stock Position:  0.08669975964948387
Bond Position:  [-5.76753022]


portfolio before change:  [3.1256989]
curr_Stock_Price:  102.5916474465204
curr_Factors:  [102.59164745]
mat_Sqrt:  [[0.15]]
grads:  [0.0110001]
Stock Position:  0.01100010353066505
Bond Position:  [1.99718015]


portfolio before change:  [3.13799321]
curr_Stock_Price:  103.6639065614902
curr_Factors:  [103.66390656]
mat_Sqrt:  [[0.15]]
grads:  [0.0347055]
Stock Position:  0.0347055030258233
Bond Position:  [-0.45971481]


portfolio before change:  [3.10147547]
curr_Stock_Price:  102.61500092214106
curr_Factors:  [102.61500092]
mat_Sqrt:  [[0.15]]
grads:  [-0.06497955]
Stock Position:  -0.06497954798444122
Bond Position:  [9.76935185]


portfolio before change:  [3.0729938]
curr_Stock_Price:  103.09090941619355
curr_Factors:  [103.09090942]
mat_Sqrt:  [[0.15]]
grads:  [-0.02896221]
Stock Position:  -0.02896220629206205
Bond Position:  [6.05873398]


portfolio before change:  [3.07490483]
curr_Stock_Price:  103.07723098390566
curr_Factors:  [103.07723098]
mat_Sqrt:  [[0.15]]
grads:  [0.00478737]
Stock Position:  0.0047873745557740635
Bond Position:  [2.58143551]


portfolio before change:  [3.07318756]
curr_Stock_Price:  102.58370149258369
curr_Factors:  [102.58370149]
mat_Sqrt:  [[0.15]]
grads:  [-8.86004196e-05]
Stock Position:  -8.860041964693153e-05
Bond Position:  [3.08227652]


portfolio before change:  [3.07384446]
curr_Stock_Price:  103.86767050225048
curr_Factors:  [103.8676705]
mat_Sqrt:  [[0.15]]
grads:  [0.34410825]
Stock Position:  0.3441082482581628
Bond Position:  [-32.66787769]


portfolio before change:  [3.37816924]
curr_Stock_Price:  104.77579395277196
curr_Factors:  [104.77579395]
mat_Sqrt:  [[0.15]]
grads:  [-0.0857946]
Stock Position:  -0.08579460467585064
Bond Position:  [12.36736706]


portfolio before change:  [3.12268677]
curr_Stock_Price:  107.78967464750447
curr_Factors:  [107.78967465]
mat_Sqrt:  [[0.15]]
grads:  [-0.11160263]
Stock Position:  -0.11160263286340488
Bond Position:  [15.15229825]


portfolio before change:  [3.15889005]
curr_Stock_Price:  107.49922691832363
curr_Factors:  [107.49922692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02092663]
Stock Position:  -0.020926632555214025
Bond Position:  [5.40848687]


portfolio before change:  [3.1340081]
curr_Stock_Price:  108.75285586727205
curr_Factors:  [108.75285587]
mat_Sqrt:  [[0.15]]
grads:  [-0.19628117]
Stock Position:  -0.19628117430762607
Bond Position:  [24.48014636]


portfolio before change:  [3.46081695]
curr_Stock_Price:  107.1190362119295
curr_Factors:  [107.11903621]
mat_Sqrt:  [[0.15]]
grads:  [0.10614024]
Stock Position:  0.10614023960374651
Bond Position:  [-7.90882322]


portfolio before change:  [3.53883982]
curr_Stock_Price:  107.8727590822459
curr_Factors:  [107.87275908]
mat_Sqrt:  [[0.15]]
grads:  [0.02554276]
Stock Position:  0.025542762865248606
Bond Position:  [0.78347152]


portfolio before change:  [3.59611299]
curr_Stock_Price:  110.10733637451833
curr_Factors:  [110.10733637]
mat_Sqrt:  [[0.15]]
grads:  [0.00537374]
Stock Position:  0.0053737378037468
Bond Position:  [3.00442503]


portfolio before change:  [3.59873051]
curr_Stock_Price:  110.45464077928563
curr_Factors:  [110.45464078]
mat_Sqrt:  [[0.15]]
grads:  [-0.00881235]
Stock Position:  -0.008812353237167999
Bond Position:  [4.57209582]


portfolio before change:  [3.59362942]
curr_Stock_Price:  111.163221014184
curr_Factors:  [111.16322101]
mat_Sqrt:  [[0.15]]
grads:  [0.03612597]
Stock Position:  0.03612596920706886
Bond Position:  [-0.42224968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.59362942]
Stock Price:  111.50670491379914
PL:  [-7.91307549]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.59491553e-02]
 [ 6.24296187e-03]
 [-1.02646707e-02]
 [ 3.98144740e-03]
 [ 8.50567321e-03]
 [ 1.31128003e-02]
 [-1.48467780e-02]
 [ 1.49471481e-03]
 [-4.98297773e-04]
 [ 5.05078861e-03]
 [-3.18378913e-03]
 [-2.34108761e-02]
 [-4.76238335e-04]
 [-1.94157364e-02]
 [-4.83561892e-05]
 [ 9.64002383e-03]
 [-3.71991058e-02]
 [-2.48741920e-02]
 [ 4.56440043e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.93321264]
curr_Stock_Price:  100.33773863008142
curr_Factors:  [100.33773863]
mat_Sqrt:  [[0.15]]
grads:  [0.23966104]
Stock Position:  0.23966103508530262
Bond Position:  [-17.11383366]


portfolio before change:  [6.6794441]
curr_Stock_Price:  99.29672856388409
curr_Factors:  [99.29672856]
mat_Sqrt:  [[0.15]]
grads:  [0.04161975]
Stock Position:  0.041619745769939806
Bond Position:  [2.5467395]


portfolio before change:  [6.72044347]
curr_Stock_Price:  100.26652313909676
curr_Factors:  [100.26652314]
mat_Sqrt:  [[0.15]]
grads:  [-0.06843114]
Stock Position:  -0.06843113766934297
Bond Position:  [13.58179571]


portfolio before change:  [6.80546231]
curr_Stock_Price:  99.07374780081406
curr_Factors:  [99.0737478]
mat_Sqrt:  [[0.15]]
grads:  [0.02654298]
Stock Position:  0.026542982679281162
Bond Position:  [4.17574954]


portfolio before change:  [6.79327895]
curr_Stock_Price:  98.57540765735092
curr_Factors:  [98.57540766]
mat_Sqrt:  [[0.15]]
grads:  [0.05670449]
Stock Position:  0.05670448804041796
Bond Position:  [1.20361092]


portfolio before change:  [6.77369605]
curr_Stock_Price:  98.22475054930894
curr_Factors:  [98.22475055]
mat_Sqrt:  [[0.15]]
grads:  [0.08741867]
Stock Position:  0.08741866861599722
Bond Position:  [-1.81298086]


portfolio before change:  [6.89576075]
curr_Stock_Price:  99.62625899334763
curr_Factors:  [99.62625899]
mat_Sqrt:  [[0.15]]
grads:  [-0.09897852]
Stock Position:  -0.09897852010803265
Bond Position:  [16.75662043]


portfolio before change:  [7.00145882]
curr_Stock_Price:  98.60069928470554
curr_Factors:  [98.60069928]
mat_Sqrt:  [[0.15]]
grads:  [0.00996477]
Stock Position:  0.009964765398998269
Bond Position:  [6.01892598]


portfolio before change:  [7.01433481]
curr_Stock_Price:  99.74182747939295
curr_Factors:  [99.74182748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00332199]
Stock Position:  -0.003321985155039107
Bond Position:  [7.34567568]


portfolio before change:  [7.01196702]
curr_Stock_Price:  101.00746945510932
curr_Factors:  [101.00746946]
mat_Sqrt:  [[0.15]]
grads:  [0.03367192]
Stock Position:  0.0336719240599514
Bond Position:  [3.61085117]


portfolio before change:  [6.99260338]
curr_Stock_Price:  100.40558937788882
curr_Factors:  [100.40558938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02122526]
Stock Position:  -0.021225260876028655
Bond Position:  [9.12373821]


portfolio before change:  [6.99380939]
curr_Stock_Price:  100.45624633271689
curr_Factors:  [100.45624633]
mat_Sqrt:  [[0.15]]
grads:  [-0.15607251]
Stock Position:  -0.15607250721891355
Bond Position:  [22.67226762]


portfolio before change:  [6.69366277]
curr_Stock_Price:  102.41569072846447
curr_Factors:  [102.41569073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00317492]
Stock Position:  -0.003174922231521258
Bond Position:  [7.01882462]


portfolio before change:  [6.69435722]
curr_Stock_Price:  102.74970762717858
curr_Factors:  [102.74970763]
mat_Sqrt:  [[0.15]]
grads:  [-0.12943824]
Stock Position:  -0.12943824264950324
Bond Position:  [19.9940988]


portfolio before change:  [6.7586032]
curr_Stock_Price:  102.29198485987153
curr_Factors:  [102.29198486]
mat_Sqrt:  [[0.15]]
grads:  [-0.00032237]
Stock Position:  -0.00032237459473748035
Bond Position:  [6.79157953]


portfolio before change:  [6.76048485]
curr_Stock_Price:  101.72264021503344
curr_Factors:  [101.72264022]
mat_Sqrt:  [[0.15]]
grads:  [0.06426683]
Stock Position:  0.06426682550547444
Bond Position:  [0.22309368]


portfolio before change:  [6.76467732]
curr_Stock_Price:  101.78700761299145
curr_Factors:  [101.78700761]
mat_Sqrt:  [[0.15]]
grads:  [-0.24799404]
Stock Position:  -0.24799403875029102
Bond Position:  [32.00724843]


portfolio before change:  [6.32834399]
curr_Stock_Price:  103.57872866556076
curr_Factors:  [103.57872867]
mat_Sqrt:  [[0.15]]
grads:  [-0.16582795]
Stock Position:  -0.16582794671032816
Bond Position:  [23.50459188]


portfolio before change:  [6.2141782]
curr_Stock_Price:  104.30262759323368
curr_Factors:  [104.30262759]
mat_Sqrt:  [[0.15]]
grads:  [0.03042934]
Stock Position:  0.03042933616764087
Bond Position:  [3.04031848]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.2141782]
Stock Price:  104.8898207049719
PL:  [1.32435749]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.00864741e-02]
 [ 8.53868070e-03]
 [ 8.90834949e-03]
 [ 2.93155179e-03]
 [ 8.77505486e-03]
 [ 3.56252810e-02]
 [-4.36623813e-03]
 [ 8.65105832e-03]
 [ 4.23407398e-03]
 [-3.76773737e-02]
 [-9.93150016e-04]
 [-2.63456600e-02]
 [ 2.71691388e-03]
 [ 3.17979166e-03]
 [-2.33661121e-03]
 [ 1.15918751e-02]
 [ 3.96001384e-02]
 [ 2.05019080e-02]
 [ 3.48697080e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.35686114]
curr_Stock_Price:  99.20707158130358
curr_Factors:  [99.20707158]
mat_Sqrt:  [[0.15]]
grads:  [0.13390983]
Stock Position:  0.13390982711258498
Bond Position:  [-23.64166294]


portfolio before change:  [-10.48079711]
curr_Stock_Price:  98.32569623480708
curr_Factors:  [98.32569623]
mat_Sqrt:  [[0.15]]
grads:  [0.05692454]
Stock Position:  0.0569245380307405
Bond Position:  [-16.07794195]


portfolio before change:  [-10.48362187]
curr_Stock_Price:  98.34669307216933
curr_Factors:  [98.34669307]
mat_Sqrt:  [[0.15]]
grads:  [0.059389]
Stock Position:  0.059388996573559796
Bond Position:  [-16.32433329]


portfolio before change:  [-10.49833002]
curr_Stock_Price:  98.16776167178121
curr_Factors:  [98.16776167]
mat_Sqrt:  [[0.15]]
grads:  [0.01954368]
Stock Position:  0.019543678596393617
Bond Position:  [-12.4168892]


portfolio before change:  [-10.51507829]
curr_Stock_Price:  97.46965044123965
curr_Factors:  [97.46965044]
mat_Sqrt:  [[0.15]]
grads:  [0.05850037]
Stock Position:  0.058500365714750535
Bond Position:  [-16.21708849]


portfolio before change:  [-10.56900376]
curr_Stock_Price:  96.6171653206271
curr_Factors:  [96.61716532]
mat_Sqrt:  [[0.15]]
grads:  [0.23750187]
Stock Position:  0.2375018731006524
Bond Position:  [-33.5157615]


portfolio before change:  [-10.81459487]
curr_Stock_Price:  95.6183895035959
curr_Factors:  [95.6183895]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910825]
Stock Position:  -0.029108254174976533
Bond Position:  [-8.03131049]


portfolio before change:  [-10.78683731]
curr_Stock_Price:  94.59580536590654
curr_Factors:  [94.59580537]
mat_Sqrt:  [[0.15]]
grads:  [0.05767372]
Stock Position:  0.05767372215953709
Bond Position:  [-16.24252951]


portfolio before change:  [-10.65914424]
curr_Stock_Price:  96.88028097887361
curr_Factors:  [96.88028098]
mat_Sqrt:  [[0.15]]
grads:  [0.02822716]
Stock Position:  0.0282271598954539
Bond Position:  [-13.39379942]


portfolio before change:  [-10.61628342]
curr_Stock_Price:  98.51734584097713
curr_Factors:  [98.51734584]
mat_Sqrt:  [[0.15]]
grads:  [-0.25118249]
Stock Position:  -0.2511824910606813
Bond Position:  [14.12954892]


portfolio before change:  [-10.44431472]
curr_Stock_Price:  97.84677414648803
curr_Factors:  [97.84677415]
mat_Sqrt:  [[0.15]]
grads:  [-0.006621]
Stock Position:  -0.006621000108934956
Bond Position:  [-9.79647122]


portfolio before change:  [-10.444045]
curr_Stock_Price:  97.43608854004026
curr_Factors:  [97.43608854]
mat_Sqrt:  [[0.15]]
grads:  [-0.17563773]
Stock Position:  -0.17563773309639896
Bond Position:  [6.66940872]


portfolio before change:  [-10.3314477]
curr_Stock_Price:  96.8045059675209
curr_Factors:  [96.80450597]
mat_Sqrt:  [[0.15]]
grads:  [0.01811276]
Stock Position:  0.018112759208491574
Bond Position:  [-12.08484441]


portfolio before change:  [-10.31017174]
curr_Stock_Price:  98.14596659704317
curr_Factors:  [98.1459666]
mat_Sqrt:  [[0.15]]
grads:  [0.02119861]
Stock Position:  0.021198611084361347
Bond Position:  [-12.39072992]


portfolio before change:  [-10.31103252]
curr_Stock_Price:  98.25150603756016
curr_Factors:  [98.25150604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01557741]
Stock Position:  -0.015577408090515957
Bond Position:  [-8.78052871]


portfolio before change:  [-10.29638929]
curr_Stock_Price:  97.17054061541546
curr_Factors:  [97.17054062]
mat_Sqrt:  [[0.15]]
grads:  [0.07727917]
Stock Position:  0.0772791676397741
Bond Position:  [-17.80564778]


portfolio before change:  [-10.42603432]
curr_Stock_Price:  95.55053009916917
curr_Factors:  [95.5505301]
mat_Sqrt:  [[0.15]]
grads:  [0.26400092]
Stock Position:  0.26400092284271504
Bond Position:  [-35.65146244]


portfolio before change:  [-10.1609014]
curr_Stock_Price:  96.58858290880517
curr_Factors:  [96.58858291]
mat_Sqrt:  [[0.15]]
grads:  [0.13667939]
Stock Position:  0.13667938637119917
Bond Position:  [-23.36256964]


portfolio before change:  [-10.18448801]
curr_Stock_Price:  96.45875176271959
curr_Factors:  [96.45875176]
mat_Sqrt:  [[0.15]]
grads:  [0.02324647]
Stock Position:  0.023246471986254624
Bond Position:  [-12.42681368]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.18448801]
Stock Price:  95.66316524177813
PL:  [-10.18448801]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.98437391e-02]
 [ 8.42640542e-03]
 [ 1.03057046e-02]
 [ 3.97614659e-03]
 [ 8.35996156e-03]
 [ 1.12141222e-02]
 [-2.26668058e-03]
 [ 8.90019693e-04]
 [ 4.29630668e-04]
 [ 4.18999037e-02]
 [-1.12831827e-02]
 [-2.03674636e-02]
 [-1.02727904e-03]
 [-2.06228093e-02]
 [-8.06917477e-04]
 [ 1.06524234e-02]
 [ 4.48051233e-02]
 [ 1.93261932e-02]
 [ 3.78548050e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.1141224]
curr_Stock_Price:  99.2229452378762
curr_Factors:  [99.22294524]
mat_Sqrt:  [[0.15]]
grads:  [0.13229159]
Stock Position:  0.13229159382104067
Bond Position:  [-23.24048397]


portfolio before change:  [-10.23281081]
curr_Stock_Price:  98.36969703111332
curr_Factors:  [98.36969703]
mat_Sqrt:  [[0.15]]
grads:  [0.05617604]
Stock Position:  0.05617603613710515
Bond Position:  [-15.75883047]


portfolio before change:  [-10.249297]
curr_Stock_Price:  98.14636353788487
curr_Factors:  [98.14636354]
mat_Sqrt:  [[0.15]]
grads:  [0.0687047]
Stock Position:  0.06870469748995126
Bond Position:  [-16.99241322]


portfolio before change:  [-10.18828011]
curr_Stock_Price:  99.09630626460893
curr_Factors:  [99.09630626]
mat_Sqrt:  [[0.15]]
grads:  [0.02650764]
Stock Position:  0.026507643916688004
Bond Position:  [-12.81508971]


portfolio before change:  [-10.19431949]
curr_Stock_Price:  98.98934836537038
curr_Factors:  [98.98934837]
mat_Sqrt:  [[0.15]]
grads:  [0.05573308]
Stock Position:  0.0557330770382218
Bond Position:  [-15.71130046]


portfolio before change:  [-10.08946723]
curr_Stock_Price:  100.94116179129767
curr_Factors:  [100.94116179]
mat_Sqrt:  [[0.15]]
grads:  [0.07476081]
Stock Position:  0.07476081451762778
Bond Position:  [-17.63591071]


portfolio before change:  [-9.97286319]
curr_Stock_Price:  102.55983827608227
curr_Factors:  [102.55983828]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151112]
Stock Position:  -0.015111203860095856
Bond Position:  [-8.42306057]


portfolio before change:  [-9.99081741]
curr_Stock_Price:  103.6086094601598
curr_Factors:  [103.60860946]
mat_Sqrt:  [[0.15]]
grads:  [0.00593346]
Stock Position:  0.005933464617539504
Bond Position:  [-10.60557543]


portfolio before change:  [-9.99619004]
curr_Stock_Price:  103.1500407668141
curr_Factors:  [103.15004077]
mat_Sqrt:  [[0.15]]
grads:  [0.0028642]
Stock Position:  0.002864204451576306
Bond Position:  [-10.29163285]


portfolio before change:  [-9.99946003]
curr_Stock_Price:  102.90677704888802
curr_Factors:  [102.90677705]
mat_Sqrt:  [[0.15]]
grads:  [0.27933269]
Stock Position:  0.2793326910147593
Bond Position:  [-38.74468698]


portfolio before change:  [-9.83382412]
curr_Stock_Price:  103.53442751449779
curr_Factors:  [103.53442751]
mat_Sqrt:  [[0.15]]
grads:  [-0.07522122]
Stock Position:  -0.0752212178171455
Bond Position:  [-2.04583839]


portfolio before change:  [-9.82733588]
curr_Stock_Price:  103.44137181529233
curr_Factors:  [103.44137182]
mat_Sqrt:  [[0.15]]
grads:  [-0.13578309]
Stock Position:  -0.1357830906035025
Bond Position:  [4.21825328]


portfolio before change:  [-9.83860134]
curr_Stock_Price:  103.5321059403238
curr_Factors:  [103.53210594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00684853]
Stock Position:  -0.006848526932454787
Bond Position:  [-9.12955893]


portfolio before change:  [-9.83295703]
curr_Stock_Price:  102.37463262952001
curr_Factors:  [102.37463263]
mat_Sqrt:  [[0.15]]
grads:  [-0.1374854]
Stock Position:  -0.1374853950271834
Bond Position:  [4.24205978]


portfolio before change:  [-9.76973165]
curr_Stock_Price:  101.92247747973333
curr_Factors:  [101.92247748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00537945]
Stock Position:  -0.005379449846247959
Bond Position:  [-9.2214448]


portfolio before change:  [-9.76563146]
curr_Stock_Price:  100.73167825723155
curr_Factors:  [100.73167826]
mat_Sqrt:  [[0.15]]
grads:  [0.07101616]
Stock Position:  0.07101615579114906
Bond Position:  [-16.91920801]


portfolio before change:  [-9.86630236]
curr_Stock_Price:  99.37366929473454
curr_Factors:  [99.37366929]
mat_Sqrt:  [[0.15]]
grads:  [0.29870082]
Stock Position:  0.29870082186953445
Bond Position:  [-39.54929905]


portfolio before change:  [-9.97354778]
curr_Stock_Price:  99.04773496298083
curr_Factors:  [99.04773496]
mat_Sqrt:  [[0.15]]
grads:  [0.12884129]
Stock Position:  0.12884128804519868
Bond Position:  [-22.73498553]


portfolio before change:  [-9.87165156]
curr_Stock_Price:  99.88272095464363
curr_Factors:  [99.88272095]
mat_Sqrt:  [[0.15]]
grads:  [0.02523654]
Stock Position:  0.025236536689359254
Bond Position:  [-12.39234552]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.87165156]
Stock Price:  98.36533340827387
PL:  [-9.87165156]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.24698455e-02]
 [ 5.29084074e-03]
 [-2.34445388e-03]
 [ 1.13981429e-03]
 [ 8.60061033e-03]
 [ 1.24115496e-03]
 [-1.37136763e-02]
 [-4.82799386e-04]
 [ 1.17964988e-03]
 [-3.73948337e-02]
 [-1.17919808e-03]
 [-2.22969714e-02]
 [-1.14267833e-04]
 [-1.09486409e-02]
 [-3.16831576e-03]
 [ 8.75238856e-03]
 [-4.71988680e-02]
 [-2.67512720e-02]
 [ 4.65929166e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.79772109]
curr_Stock_Price:  98.78587799924114
curr_Factors:  [98.785878]
mat_Sqrt:  [[0.15]]
grads:  [0.41646564]
Stock Position:  0.4164656364839547
Bond Position:  [-57.93864464]


portfolio before change:  [-16.52794955]
curr_Stock_Price:  99.46842654057156
curr_Factors:  [99.46842654]
mat_Sqrt:  [[0.15]]
grads:  [0.03527227]
Stock Position:  0.03527227158732618
Bond Position:  [-20.0364269]


portfolio before change:  [-16.52397067]
curr_Stock_Price:  99.72326157551443
curr_Factors:  [99.72326158]
mat_Sqrt:  [[0.15]]
grads:  [-0.01562969]
Stock Position:  -0.0156296925080207
Bond Position:  [-14.96532676]


portfolio before change:  [-16.49449526]
curr_Stock_Price:  97.59799844602227
curr_Factors:  [97.59799845]
mat_Sqrt:  [[0.15]]
grads:  [0.00759876]
Stock Position:  0.007598761900034624
Bond Position:  [-17.23611921]


portfolio before change:  [-16.49382305]
curr_Stock_Price:  98.2536018829955
curr_Factors:  [98.25360188]
mat_Sqrt:  [[0.15]]
grads:  [0.0573374]
Stock Position:  0.05733740220940687
Bond Position:  [-22.12742934]


portfolio before change:  [-16.43625714]
curr_Stock_Price:  99.35407840420378
curr_Factors:  [99.3540784]
mat_Sqrt:  [[0.15]]
grads:  [0.00827437]
Stock Position:  0.008274366414472458
Bond Position:  [-17.25834919]


portfolio before change:  [-16.44954798]
curr_Stock_Price:  98.26931712030269
curr_Factors:  [98.26931712]
mat_Sqrt:  [[0.15]]
grads:  [-0.09142451]
Stock Position:  -0.09142450856163657
Bond Position:  [-7.46532395]


portfolio before change:  [-16.53710785]
curr_Stock_Price:  99.20662933216349
curr_Factors:  [99.20662933]
mat_Sqrt:  [[0.15]]
grads:  [-0.00321866]
Stock Position:  -0.003218662572111645
Bond Position:  [-16.21779518]


portfolio before change:  [-16.53800524]
curr_Stock_Price:  98.22561279493533
curr_Factors:  [98.22561279]
mat_Sqrt:  [[0.15]]
grads:  [0.00786433]
Stock Position:  0.007864332519234043
Bond Position:  [-17.31048413]


portfolio before change:  [-16.5410668]
curr_Stock_Price:  98.3866694427938
curr_Factors:  [98.38666944]
mat_Sqrt:  [[0.15]]
grads:  [-0.24929889]
Stock Position:  -0.2492988911638936
Bond Position:  [7.98662079]


portfolio before change:  [-16.87616737]
curr_Stock_Price:  99.73885145324532
curr_Factors:  [99.73885145]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786132]
Stock Position:  -0.007861320555948605
Bond Position:  [-16.09208829]


portfolio before change:  [-16.89382479]
curr_Stock_Price:  101.47315209622727
curr_Factors:  [101.4731521]
mat_Sqrt:  [[0.15]]
grads:  [-0.14864648]
Stock Position:  -0.1486464757728295
Bond Position:  [-1.81019835]


portfolio before change:  [-16.90372618]
curr_Stock_Price:  101.53671757117694
curr_Factors:  [101.53671757]
mat_Sqrt:  [[0.15]]
grads:  [-0.00076179]
Stock Position:  -0.000761785553733455
Bond Position:  [-16.82637698]


portfolio before change:  [-16.90770097]
curr_Stock_Price:  101.23173682092714
curr_Factors:  [101.23173682]
mat_Sqrt:  [[0.15]]
grads:  [-0.07299094]
Stock Position:  -0.07299093937100504
Bond Position:  [-9.51870141]


portfolio before change:  [-16.88936271]
curr_Stock_Price:  100.94789020358857
curr_Factors:  [100.9478902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02112211]
Stock Position:  -0.021122105075011346
Bond Position:  [-14.75713077]


portfolio before change:  [-16.92855488]
curr_Stock_Price:  102.62870841865596
curr_Factors:  [102.62870842]
mat_Sqrt:  [[0.15]]
grads:  [0.05834926]
Stock Position:  0.05834925706490818
Bond Position:  [-22.91686377]


portfolio before change:  [-16.84561486]
curr_Stock_Price:  104.14834985019445
curr_Factors:  [104.14834985]
mat_Sqrt:  [[0.15]]
grads:  [-0.31465912]
Stock Position:  -0.3146591200092867
Bond Position:  [15.92561325]


portfolio before change:  [-16.3870771]
curr_Stock_Price:  102.70375210050946
curr_Factors:  [102.7037521]
mat_Sqrt:  [[0.15]]
grads:  [-0.17834181]
Stock Position:  -0.1783418136364622
Bond Position:  [1.92929631]


portfolio before change:  [-16.5415955]
curr_Stock_Price:  103.57287401584819
curr_Factors:  [103.57287402]
mat_Sqrt:  [[0.15]]
grads:  [0.03106194]
Stock Position:  0.03106194437328307
Bond Position:  [-19.75877035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.5415955]
Stock Price:  102.13894780556907
PL:  [-18.6805433]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.01565359e-01]
 [ 6.28151907e-03]
 [-5.19892709e-03]
 [ 3.59199991e-03]
 [ 5.29784508e-03]
 [ 1.01719804e-02]
 [ 2.94500653e-03]
 [-8.60176295e-04]
 [-8.94303432e-04]
 [ 2.45566754e-02]
 [-7.46859882e-03]
 [-2.25615157e-02]
 [ 3.16356046e-04]
 [ 1.04496068e-03]
 [-2.81099028e-03]
 [ 1.08985731e-02]
 [ 6.41363195e-03]
 [ 1.89259227e-02]
 [ 3.88568687e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.4263383]
curr_Stock_Price:  98.48319421468183
curr_Factors:  [98.48319421]
mat_Sqrt:  [[0.15]]
grads:  [0.67710239]
Stock Position:  0.677102392917283
Bond Position:  [-88.10954477]


portfolio before change:  [-20.91698702]
curr_Stock_Price:  99.26798160966709
curr_Factors:  [99.26798161]
mat_Sqrt:  [[0.15]]
grads:  [0.04187679]
Stock Position:  0.04187679381942522
Bond Position:  [-25.07401182]


portfolio before change:  [-20.89470013]
curr_Stock_Price:  99.94989105324757
curr_Factors:  [99.94989105]
mat_Sqrt:  [[0.15]]
grads:  [-0.03465951]
Stock Position:  -0.03465951390355371
Bond Position:  [-17.43048549]


portfolio before change:  [-20.9730895]
curr_Stock_Price:  102.08584729362623
curr_Factors:  [102.08584729]
mat_Sqrt:  [[0.15]]
grads:  [0.02394667]
Stock Position:  0.023946666072162687
Bond Position:  [-23.41770519]


portfolio before change:  [-20.94563389]
curr_Stock_Price:  103.47688724705297
curr_Factors:  [103.47688725]
mat_Sqrt:  [[0.15]]
grads:  [0.03531897]
Stock Position:  0.035318967170854386
Bond Position:  [-24.60033067]


portfolio before change:  [-21.03339759]
curr_Stock_Price:  101.16614997589978
curr_Factors:  [101.16614998]
mat_Sqrt:  [[0.15]]
grads:  [0.0678132]
Stock Position:  0.0678132027587703
Bond Position:  [-27.89379823]


portfolio before change:  [-21.03852687]
curr_Stock_Price:  101.19335774707378
curr_Factors:  [101.19335775]
mat_Sqrt:  [[0.15]]
grads:  [0.01963338]
Stock Position:  0.01963337685843563
Bond Position:  [-23.02529419]


portfolio before change:  [-21.04233794]
curr_Stock_Price:  101.29247309836704
curr_Factors:  [101.2924731]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573451]
Stock Position:  -0.005734508634840957
Bond Position:  [-20.46147538]


portfolio before change:  [-21.04905122]
curr_Stock_Price:  101.57100957968692
curr_Factors:  [101.57100958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00596202]
Stock Position:  -0.005962022877248121
Bond Position:  [-20.44348254]


portfolio before change:  [-21.05605541]
curr_Stock_Price:  101.88846608135809
curr_Factors:  [101.88846608]
mat_Sqrt:  [[0.15]]
grads:  [0.16371117]
Stock Position:  0.16371116944691216
Bond Position:  [-37.73633535]


portfolio before change:  [-21.03161258]
curr_Stock_Price:  102.09540425834699
curr_Factors:  [102.09540426]
mat_Sqrt:  [[0.15]]
grads:  [-0.04979066]
Stock Position:  -0.04979065882492512
Bond Position:  [-15.94821514]


portfolio before change:  [-20.98233644]
curr_Stock_Price:  101.02565156814543
curr_Factors:  [101.02565157]
mat_Sqrt:  [[0.15]]
grads:  [-0.1504101]
Stock Position:  -0.15041010469512028
Bond Position:  [-5.78705762]


portfolio before change:  [-20.95304204]
curr_Stock_Price:  100.82126805455606
curr_Factors:  [100.82126805]
mat_Sqrt:  [[0.15]]
grads:  [0.00210904]
Stock Position:  0.0021090403071056564
Bond Position:  [-21.16567816]


portfolio before change:  [-20.96170783]
curr_Stock_Price:  99.221628847565
curr_Factors:  [99.22162885]
mat_Sqrt:  [[0.15]]
grads:  [0.0069664]
Stock Position:  0.00696640451438861
Bond Position:  [-21.65292583]


portfolio before change:  [-20.96566286]
curr_Stock_Price:  99.43104556185189
curr_Factors:  [99.43104556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01873994]
Stock Position:  -0.01873993517939036
Bond Position:  [-19.10233151]


portfolio before change:  [-20.96891919]
curr_Stock_Price:  99.34994335624309
curr_Factors:  [99.34994336]
mat_Sqrt:  [[0.15]]
grads:  [0.07265715]
Stock Position:  0.07265715418536918
Bond Position:  [-28.18740334]


portfolio before change:  [-20.89946893]
curr_Stock_Price:  100.40280572735354
curr_Factors:  [100.40280573]
mat_Sqrt:  [[0.15]]
grads:  [0.04275755]
Stock Position:  0.04275754635173573
Bond Position:  [-25.19244655]


portfolio before change:  [-20.93005119]
curr_Stock_Price:  99.83487428031684
curr_Factors:  [99.83487428]
mat_Sqrt:  [[0.15]]
grads:  [0.12617282]
Stock Position:  0.12617281795510485
Bond Position:  [-33.52649861]


portfolio before change:  [-21.05590481]
curr_Stock_Price:  98.90384214998902
curr_Factors:  [98.90384215]
mat_Sqrt:  [[0.15]]
grads:  [0.02590458]
Stock Position:  0.025904579129687084
Bond Position:  [-23.61796721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.05590481]
Stock Price:  96.9804471503677
PL:  [-21.05590481]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.53855915e-02]
 [-3.04000332e-03]
 [-1.04698010e-02]
 [ 3.54953317e-03]
 [ 6.99913294e-03]
 [ 7.22417126e-03]
 [-9.60915924e-04]
 [-1.35973060e-03]
 [-3.21029656e-04]
 [-1.79089450e-02]
 [-1.03683747e-03]
 [-2.38627638e-02]
 [ 1.81739000e-04]
 [-1.28547098e-02]
 [-2.54060511e-03]
 [ 1.01950966e-02]
 [-3.00710339e-02]
 [-2.65843259e-02]
 [ 4.64436415e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.52001792]
curr_Stock_Price:  100.63768816522003
curr_Factors:  [100.63768817]
mat_Sqrt:  [[0.15]]
grads:  [0.16923728]
Stock Position:  0.16923727647551734
Bond Position:  [-5.51163033]


portfolio before change:  [11.41777219]
curr_Stock_Price:  100.04167496826666
curr_Factors:  [100.04167497]
mat_Sqrt:  [[0.15]]
grads:  [-0.02026669]
Stock Position:  -0.02026668881222707
Bond Position:  [13.44528569]


portfolio before change:  [11.40982891]
curr_Stock_Price:  100.59948789740083
curr_Factors:  [100.5994879]
mat_Sqrt:  [[0.15]]
grads:  [-0.06979867]
Stock Position:  -0.0697986732797231
Bond Position:  [18.4315397]


portfolio before change:  [11.47337417]
curr_Stock_Price:  99.75510508781362
curr_Factors:  [99.75510509]
mat_Sqrt:  [[0.15]]
grads:  [0.02366355]
Stock Position:  0.023663554437739643
Bond Position:  [9.11281382]


portfolio before change:  [11.49606958]
curr_Stock_Price:  100.61790519747538
curr_Factors:  [100.6179052]
mat_Sqrt:  [[0.15]]
grads:  [0.04666089]
Stock Position:  0.04666088626175847
Bond Position:  [6.80114895]


portfolio before change:  [11.53427701]
curr_Stock_Price:  101.40029355907443
curr_Factors:  [101.40029356]
mat_Sqrt:  [[0.15]]
grads:  [0.04816114]
Stock Position:  0.048161141715151415
Bond Position:  [6.65072311]


portfolio before change:  [11.57571024]
curr_Stock_Price:  102.22606993101438
curr_Factors:  [102.22606993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00640611]
Stock Position:  -0.006406106162111225
Bond Position:  [12.23058129]


portfolio before change:  [11.58657457]
curr_Stock_Price:  101.00749656561656
curr_Factors:  [101.00749657]
mat_Sqrt:  [[0.15]]
grads:  [-0.00906487]
Stock Position:  -0.009064870668155945
Bond Position:  [12.50219447]


portfolio before change:  [11.60312967]
curr_Stock_Price:  99.52604625305916
curr_Factors:  [99.52604625]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021402]
Stock Position:  -0.0021401977088639397
Bond Position:  [11.81613509]


portfolio before change:  [11.60535575]
curr_Stock_Price:  99.8663518355256
curr_Factors:  [99.86635184]
mat_Sqrt:  [[0.15]]
grads:  [-0.11939297]
Stock Position:  -0.11939296682223227
Bond Position:  [23.52869578]


portfolio before change:  [11.75086529]
curr_Stock_Price:  98.69688072864741
curr_Factors:  [98.69688073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691225]
Stock Position:  -0.006912249777629246
Bond Position:  [12.43308278]


portfolio before change:  [11.74339233]
curr_Stock_Price:  100.22773031513567
curr_Factors:  [100.22773032]
mat_Sqrt:  [[0.15]]
grads:  [-0.15908509]
Stock Position:  -0.1590850920827187
Bond Position:  [27.68813004]


portfolio before change:  [11.62178373]
curr_Stock_Price:  101.03567211500676
curr_Factors:  [101.03567212]
mat_Sqrt:  [[0.15]]
grads:  [0.00121159]
Stock Position:  0.001211593335192545
Bond Position:  [11.49936958]


portfolio before change:  [11.62511686]
curr_Stock_Price:  101.41362685250571
curr_Factors:  [101.41362685]
mat_Sqrt:  [[0.15]]
grads:  [-0.08569807]
Stock Position:  -0.08569806504357605
Bond Position:  [20.31606845]


portfolio before change:  [11.64686663]
curr_Stock_Price:  101.21910532671004
curr_Factors:  [101.21910533]
mat_Sqrt:  [[0.15]]
grads:  [-0.01693737]
Stock Position:  -0.016937367414975694
Bond Position:  [13.36125181]


portfolio before change:  [11.64529755]
curr_Stock_Price:  101.50898583958055
curr_Factors:  [101.50898584]
mat_Sqrt:  [[0.15]]
grads:  [0.06796731]
Stock Position:  0.06796731083370693
Bond Position:  [4.74600476]


portfolio before change:  [11.6500823]
curr_Stock_Price:  101.56192449306843
curr_Factors:  [101.56192449]
mat_Sqrt:  [[0.15]]
grads:  [-0.20047356]
Stock Position:  -0.20047355943725792
Bond Position:  [32.0105628]


portfolio before change:  [11.52086284]
curr_Stock_Price:  102.24641921221469
curr_Factors:  [102.24641921]
mat_Sqrt:  [[0.15]]
grads:  [-0.17722884]
Stock Position:  -0.17722883961466263
Bond Position:  [29.64187708]


portfolio before change:  [11.42697721]
curr_Stock_Price:  102.81797988033618
curr_Factors:  [102.81797988]
mat_Sqrt:  [[0.15]]
grads:  [0.03096243]
Stock Position:  0.03096242765069379
Bond Position:  [8.24348294]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.42697721]
Stock Price:  104.04596072063153
PL:  [7.38101649]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-1.87995522e-02]
 [-4.23524121e-03]
 [-1.06306303e-02]
 [ 3.71357429e-03]
 [ 8.19644807e-03]
 [ 9.48896256e-03]
 [-1.54336099e-02]
 [ 4.14735274e-03]
 [ 1.54284073e-03]
 [-3.72343402e-02]
 [-9.73956350e-04]
 [-2.63411977e-02]
 [ 2.71291319e-03]
 [ 1.03921227e-03]
 [-1.46918527e-03]
 [ 1.14201186e-02]
 [ 4.81820774e-02]
 [ 2.07591122e-02]
 [ 3.37381122e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.78752884]
curr_Stock_Price:  101.11293975878513
curr_Factors:  [101.11293976]
mat_Sqrt:  [[0.15]]
grads:  [-0.12533035]
Stock Position:  -0.12533034779551946
Bond Position:  [31.46004874]


portfolio before change:  [18.91775713]
curr_Stock_Price:  100.13662161619841
curr_Factors:  [100.13662162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823494]
Stock Position:  -0.02823494137259512
Bond Position:  [21.74510877]


portfolio before change:  [18.91461651]
curr_Stock_Price:  100.44041456275373
curr_Factors:  [100.44041456]
mat_Sqrt:  [[0.15]]
grads:  [-0.07087087]
Stock Position:  -0.07087086889036777
Bond Position:  [26.03291596]


portfolio before change:  [18.98760213]
curr_Stock_Price:  99.5024186749822
curr_Factors:  [99.50241867]
mat_Sqrt:  [[0.15]]
grads:  [0.02475716]
Stock Position:  0.02475716196404961
Bond Position:  [16.52420464]


portfolio before change:  [18.98587774]
curr_Stock_Price:  99.26588260931206
curr_Factors:  [99.26588261]
mat_Sqrt:  [[0.15]]
grads:  [0.05464299]
Stock Position:  0.054642987151533935
Bond Position:  [13.56169339]


portfolio before change:  [19.05349776]
curr_Stock_Price:  100.44131566342459
curr_Factors:  [100.44131566]
mat_Sqrt:  [[0.15]]
grads:  [0.06325975]
Stock Position:  0.06325975042245426
Bond Position:  [12.6996052]


portfolio before change:  [18.94808501]
curr_Stock_Price:  98.72477328636869
curr_Factors:  [98.72477329]
mat_Sqrt:  [[0.15]]
grads:  [-0.10289073]
Stock Position:  -0.10289073262447995
Bond Position:  [29.10594927]


portfolio before change:  [19.04845926]
curr_Stock_Price:  97.81996051241076
curr_Factors:  [97.81996051]
mat_Sqrt:  [[0.15]]
grads:  [0.02764902]
Stock Position:  0.02764901828066434
Bond Position:  [16.34383338]


portfolio before change:  [19.05683166]
curr_Stock_Price:  97.97497237825172
curr_Factors:  [97.97497238]
mat_Sqrt:  [[0.15]]
grads:  [0.0102856]
Stock Position:  0.010285604876237
Bond Position:  [18.0490998]


portfolio before change:  [19.05829024]
curr_Stock_Price:  97.67802806172264
curr_Factors:  [97.67802806]
mat_Sqrt:  [[0.15]]
grads:  [-0.24822893]
Stock Position:  -0.2482289347113099
Bond Position:  [43.30480309]


portfolio before change:  [19.11994023]
curr_Stock_Price:  97.47328789045947
curr_Factors:  [97.47328789]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649304]
Stock Position:  -0.006493042332094875
Bond Position:  [19.75283842]


portfolio before change:  [19.1229826]
curr_Stock_Price:  97.76536280745326
curr_Factors:  [97.76536281]
mat_Sqrt:  [[0.15]]
grads:  [-0.17560798]
Stock Position:  -0.1756079845059185
Bond Position:  [36.29136092]


portfolio before change:  [19.30375464]
curr_Stock_Price:  96.78762789160714
curr_Factors:  [96.78762789]
mat_Sqrt:  [[0.15]]
grads:  [0.01808609]
Stock Position:  0.018086087932534408
Bond Position:  [17.55324509]


portfolio before change:  [19.32282245]
curr_Stock_Price:  97.59924389907329
curr_Factors:  [97.5992439]
mat_Sqrt:  [[0.15]]
grads:  [0.00692808]
Stock Position:  0.006928081813335029
Bond Position:  [18.64664691]


portfolio before change:  [19.31779762]
curr_Stock_Price:  96.2010103911667
curr_Factors:  [96.20101039]
mat_Sqrt:  [[0.15]]
grads:  [-0.00979457]
Stock Position:  -0.009794568461861419
Bond Position:  [20.260045]


portfolio before change:  [19.31528035]
curr_Stock_Price:  96.9752069862359
curr_Factors:  [96.97520699]
mat_Sqrt:  [[0.15]]
grads:  [0.07613412]
Stock Position:  0.07613412416952291
Bond Position:  [11.9321579]


portfolio before change:  [19.30192689]
curr_Stock_Price:  96.76062686446656
curr_Factors:  [96.76062686]
mat_Sqrt:  [[0.15]]
grads:  [0.32121385]
Stock Position:  0.3212138492377948
Bond Position:  [-11.77892652]


portfolio before change:  [19.45064979]
curr_Stock_Price:  97.2327983050505
curr_Factors:  [97.23279831]
mat_Sqrt:  [[0.15]]
grads:  [0.13839408]
Stock Position:  0.1383940812690555
Bond Position:  [5.994206]


portfolio before change:  [19.3267052]
curr_Stock_Price:  96.32637705935329
curr_Factors:  [96.32637706]
mat_Sqrt:  [[0.15]]
grads:  [0.02249207]
Stock Position:  0.022492074802879312
Bond Position:  [17.16012512]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.3267052]
Stock Price:  96.3678042276968
PL:  [19.3267052]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.93429639e-02]
 [ 5.47692323e-03]
 [-6.42276170e-03]
 [ 3.31516785e-03]
 [ 7.77646144e-03]
 [ 8.73933080e-03]
 [-5.80448138e-03]
 [-1.98218293e-03]
 [ 9.28881123e-04]
 [-3.02862794e-02]
 [-5.19988832e-03]
 [-2.12336600e-02]
 [-1.28800420e-03]
 [-1.96179577e-02]
 [ 2.11968627e-03]
 [ 9.52555511e-03]
 [-4.08889804e-02]
 [-1.86747242e-02]
 [ 4.65918946e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.01794598]
curr_Stock_Price:  99.81778058008972
curr_Factors:  [99.81778058]
mat_Sqrt:  [[0.15]]
grads:  [0.12895309]
Stock Position:  0.12895309237169048
Bond Position:  [-13.88975746]


portfolio before change:  [-1.07080677]
curr_Stock_Price:  99.43478920591903
curr_Factors:  [99.43478921]
mat_Sqrt:  [[0.15]]
grads:  [0.03651282]
Stock Position:  0.036512821521890323
Bond Position:  [-4.70145148]


portfolio before change:  [-1.05080228]
curr_Stock_Price:  100.0148593809043
curr_Factors:  [100.01485938]
mat_Sqrt:  [[0.15]]
grads:  [-0.04281841]
Stock Position:  -0.042818411349851676
Bond Position:  [3.23167511]


portfolio before change:  [-1.12531377]
curr_Stock_Price:  101.77390421737505
curr_Factors:  [101.77390422]
mat_Sqrt:  [[0.15]]
grads:  [0.02210112]
Stock Position:  0.02210111901588876
Bond Position:  [-3.37463094]


portfolio before change:  [-1.17078555]
curr_Stock_Price:  99.75463894537383
curr_Factors:  [99.75463895]
mat_Sqrt:  [[0.15]]
grads:  [0.05184308]
Stock Position:  0.0518430762677824
Bond Position:  [-6.34237291]


portfolio before change:  [-1.14745036]
curr_Stock_Price:  100.23533922243377
curr_Factors:  [100.23533922]
mat_Sqrt:  [[0.15]]
grads:  [0.05826221]
Stock Position:  0.058262205318686734
Bond Position:  [-6.98738228]


portfolio before change:  [-1.14255658]
curr_Stock_Price:  100.34932135120025
curr_Factors:  [100.34932135]
mat_Sqrt:  [[0.15]]
grads:  [-0.03869654]
Stock Position:  -0.038696542541482304
Bond Position:  [2.74061521]


portfolio before change:  [-1.12657393]
curr_Stock_Price:  99.95400414082108
curr_Factors:  [99.95400414]
mat_Sqrt:  [[0.15]]
grads:  [-0.01321455]
Stock Position:  -0.013214552883786104
Bond Position:  [0.19427354]


portfolio before change:  [-1.10597231]
curr_Stock_Price:  98.39866997601574
curr_Factors:  [98.39866998]
mat_Sqrt:  [[0.15]]
grads:  [0.00619254]
Stock Position:  0.006192540817499953
Bond Position:  [-1.71531009]


portfolio before change:  [-1.10023389]
curr_Stock_Price:  99.39459350322471
curr_Factors:  [99.3945935]
mat_Sqrt:  [[0.15]]
grads:  [-0.20190853]
Stock Position:  -0.2019085295520829
Bond Position:  [18.96838233]


portfolio before change:  [-1.40883865]
curr_Stock_Price:  100.94652124478812
curr_Factors:  [100.94652124]
mat_Sqrt:  [[0.15]]
grads:  [-0.03466592]
Stock Position:  -0.03466592213336082
Bond Position:  [2.09056559]


portfolio before change:  [-1.46602585]
curr_Stock_Price:  102.61126586809617
curr_Factors:  [102.61126587]
mat_Sqrt:  [[0.15]]
grads:  [-0.14155773]
Stock Position:  -0.14155773308424544
Bond Position:  [13.05939233]


portfolio before change:  [-1.66972154]
curr_Stock_Price:  104.07329083379753
curr_Factors:  [104.07329083]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858669]
Stock Position:  -0.008586694637444709
Bond Position:  [-0.77607597]


portfolio before change:  [-1.65801433]
curr_Stock_Price:  102.68728009332489
curr_Factors:  [102.68728009]
mat_Sqrt:  [[0.15]]
grads:  [-0.13078638]
Stock Position:  -0.13078638449910096
Bond Position:  [11.77208377]


portfolio before change:  [-1.7032562]
curr_Stock_Price:  103.05570729508645
curr_Factors:  [103.0557073]
mat_Sqrt:  [[0.15]]
grads:  [0.01413124]
Stock Position:  0.01413124178972902
Bond Position:  [-3.15956132]


portfolio before change:  [-1.72230189]
curr_Stock_Price:  101.76383913994616
curr_Factors:  [101.76383914]
mat_Sqrt:  [[0.15]]
grads:  [0.0635037]
Stock Position:  0.06350370074308073
Bond Position:  [-8.18468228]


portfolio before change:  [-1.71629904]
curr_Stock_Price:  101.89059204902537
curr_Factors:  [101.89059205]
mat_Sqrt:  [[0.15]]
grads:  [-0.2725932]
Stock Position:  -0.2725932025418191
Bond Position:  [26.05838376]


portfolio before change:  [-2.562439]
curr_Stock_Price:  105.01853273468907
curr_Factors:  [105.01853273]
mat_Sqrt:  [[0.15]]
grads:  [-0.12449816]
Stock Position:  -0.1244981615738925
Bond Position:  [10.51217526]


portfolio before change:  [-2.72772428]
curr_Stock_Price:  106.36725673025876
curr_Factors:  [106.36725673]
mat_Sqrt:  [[0.15]]
grads:  [0.03106126]
Stock Position:  0.031061263050933572
Bond Position:  [-6.03162563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.72772428]
Stock Price:  107.5566734870905
PL:  [-10.28439777]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.97344546e-02]
 [ 6.63480282e-03]
 [-9.93790333e-03]
 [ 2.95645606e-03]
 [ 8.60572999e-03]
 [ 4.96143733e-03]
 [-1.25257285e-02]
 [ 2.38597090e-03]
 [-9.32813776e-04]
 [-2.93107565e-04]
 [-5.47511862e-03]
 [-2.56665760e-02]
 [ 2.48904855e-03]
 [ 5.14506908e-03]
 [-2.60031659e-03]
 [ 1.06634943e-02]
 [ 4.83981634e-02]
 [ 1.94432362e-02]
 [ 3.89360938e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.00483623]
curr_Stock_Price:  99.2300918975692
curr_Factors:  [99.2300919]
mat_Sqrt:  [[0.15]]
grads:  [0.13156303]
Stock Position:  0.13156303058258362
Bond Position:  [-23.05984784]


portfolio before change:  [-10.02413286]
curr_Stock_Price:  99.1272442475456
curr_Factors:  [99.12724425]
mat_Sqrt:  [[0.15]]
grads:  [0.04423202]
Stock Position:  0.044232018824831985
Bond Position:  [-14.40873099]


portfolio before change:  [-9.97982535]
curr_Stock_Price:  100.21039940148492
curr_Factors:  [100.2103994]
mat_Sqrt:  [[0.15]]
grads:  [-0.06625269]
Stock Position:  -0.06625268886718967
Bond Position:  [-3.34061694]


portfolio before change:  [-9.84824154]
curr_Stock_Price:  98.21170211696467
curr_Factors:  [98.21170212]
mat_Sqrt:  [[0.15]]
grads:  [0.01970971]
Stock Position:  0.019709707076886955
Bond Position:  [-11.78396542]


portfolio before change:  [-9.85070411]
curr_Stock_Price:  98.23624791554197
curr_Factors:  [98.23624792]
mat_Sqrt:  [[0.15]]
grads:  [0.05737153]
Stock Position:  0.05737153326846419
Bond Position:  [-15.48666828]


portfolio before change:  [-9.81701346]
curr_Stock_Price:  98.89097686124008
curr_Factors:  [98.89097686]
mat_Sqrt:  [[0.15]]
grads:  [0.03307625]
Stock Position:  0.03307624886956883
Bond Position:  [-13.08795602]


portfolio before change:  [-9.85170298]
curr_Stock_Price:  97.94113752401738
curr_Factors:  [97.94113752]
mat_Sqrt:  [[0.15]]
grads:  [-0.08350486]
Stock Position:  -0.08350485678834257
Bond Position:  [-1.67314232]


portfolio before change:  [-9.88479516]
curr_Stock_Price:  98.33241825392398
curr_Factors:  [98.33241825]
mat_Sqrt:  [[0.15]]
grads:  [0.01590647]
Stock Position:  0.015906472676425386
Bond Position:  [-11.44891708]


portfolio before change:  [-9.85779445]
curr_Stock_Price:  100.20984882341344
curr_Factors:  [100.20984882]
mat_Sqrt:  [[0.15]]
grads:  [-0.00621876]
Stock Position:  -0.006218758505300767
Bond Position:  [-9.2346136]


portfolio before change:  [-9.86321348]
curr_Stock_Price:  100.70996271154125
curr_Factors:  [100.70996271]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195405]
Stock Position:  -0.0019540504362134097
Bond Position:  [-9.66642113]


portfolio before change:  [-9.86623693]
curr_Stock_Price:  101.02036723405506
curr_Factors:  [101.02036723]
mat_Sqrt:  [[0.15]]
grads:  [-0.03650079]
Stock Position:  -0.03650079078814894
Bond Position:  [-6.17891364]


portfolio before change:  [-9.79982902]
curr_Stock_Price:  99.15868597955432
curr_Factors:  [99.15868598]
mat_Sqrt:  [[0.15]]
grads:  [-0.17111051]
Stock Position:  -0.17111050687101143
Bond Position:  [7.167264]


portfolio before change:  [-9.68175346]
curr_Stock_Price:  98.47910459308709
curr_Factors:  [98.47910459]
mat_Sqrt:  [[0.15]]
grads:  [0.01659366]
Stock Position:  0.01659365697830978
Bond Position:  [-11.31588194]


portfolio before change:  [-9.68255489]
curr_Stock_Price:  98.60131383178764
curr_Factors:  [98.60131383]
mat_Sqrt:  [[0.15]]
grads:  [0.03430046]
Stock Position:  0.03430046051624299
Bond Position:  [-13.06462536]


portfolio before change:  [-9.67137032]
curr_Stock_Price:  99.02262403112762
curr_Factors:  [99.02262403]
mat_Sqrt:  [[0.15]]
grads:  [-0.01733544]
Stock Position:  -0.01733544391804719
Bond Position:  [-7.95476917]


portfolio before change:  [-9.68465002]
curr_Stock_Price:  99.67393471686869
curr_Factors:  [99.67393472]
mat_Sqrt:  [[0.15]]
grads:  [0.07108996]
Stock Position:  0.07108996225474856
Bond Position:  [-16.77046627]


portfolio before change:  [-9.73541386]
curr_Stock_Price:  99.01883940523129
curr_Factors:  [99.01883941]
mat_Sqrt:  [[0.15]]
grads:  [0.32265442]
Stock Position:  0.3226544225878863
Bond Position:  [-41.68428031]


portfolio before change:  [-9.69654785]
curr_Stock_Price:  99.17159845067359
curr_Factors:  [99.17159845]
mat_Sqrt:  [[0.15]]
grads:  [0.12962157]
Stock Position:  0.1296215744184606
Bond Position:  [-22.55132658]


portfolio before change:  [-9.74677327]
curr_Stock_Price:  98.82762109942183
curr_Factors:  [98.8276211]
mat_Sqrt:  [[0.15]]
grads:  [0.0259574]
Stock Position:  0.025957395849746878
Bond Position:  [-12.31208095]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.74677327]
Stock Price:  98.30689694969787
PL:  [-9.74677327]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.82367687e-02]
 [-4.76344234e-03]
 [ 2.59295835e-02]
 [ 2.80853976e-03]
 [ 6.22988565e-03]
 [ 9.82705487e-03]
 [-9.30647160e-03]
 [-2.32914211e-03]
 [-1.02816724e-03]
 [ 1.23190423e-02]
 [-6.13732736e-03]
 [-2.26481206e-02]
 [-1.02893016e-04]
 [-1.94287871e-02]
 [ 3.34288868e-03]
 [ 8.72165085e-03]
 [-4.48064825e-02]
 [-2.33992364e-02]
 [ 4.65891810e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.72866605]
curr_Stock_Price:  101.95921245894716
curr_Factors:  [101.95921246]
mat_Sqrt:  [[0.15]]
grads:  [-0.25491179]
Stock Position:  -0.25491179161858557
Bond Position:  [57.71927157]


portfolio before change:  [31.40441886]
curr_Stock_Price:  103.2878242768631
curr_Factors:  [103.28782428]
mat_Sqrt:  [[0.15]]
grads:  [-0.03175628]
Stock Position:  -0.03175628223556026
Bond Position:  [34.68445616]


portfolio before change:  [31.41079613]
curr_Stock_Price:  103.3600909984183
curr_Factors:  [103.360091]
mat_Sqrt:  [[0.15]]
grads:  [0.17286389]
Stock Position:  0.17286388980032988
Bond Position:  [13.54356875]


portfolio before change:  [31.08873733]
curr_Stock_Price:  101.47742410988096
curr_Factors:  [101.47742411]
mat_Sqrt:  [[0.15]]
grads:  [0.0187236]
Stock Position:  0.018723598398705892
Bond Position:  [29.18871479]


portfolio before change:  [31.09967484]
curr_Stock_Price:  101.67180024973082
curr_Factors:  [101.67180025]
mat_Sqrt:  [[0.15]]
grads:  [0.04153257]
Stock Position:  0.041532571004399686
Bond Position:  [26.87698357]


portfolio before change:  [31.08738097]
curr_Stock_Price:  101.21399206756176
curr_Factors:  [101.21399207]
mat_Sqrt:  [[0.15]]
grads:  [0.0655137]
Stock Position:  0.06551369911514093
Bond Position:  [24.45647795]


portfolio before change:  [31.01975371]
curr_Stock_Price:  100.08839325546822
curr_Factors:  [100.08839326]
mat_Sqrt:  [[0.15]]
grads:  [-0.06204314]
Stock Position:  -0.0620431440006447
Bond Position:  [37.22955231]


portfolio before change:  [31.00535501]
curr_Stock_Price:  100.47050247248852
curr_Factors:  [100.47050247]
mat_Sqrt:  [[0.15]]
grads:  [-0.01552761]
Stock Position:  -0.015527614090532861
Bond Position:  [32.5654222]


portfolio before change:  [30.99927069]
curr_Stock_Price:  101.38672154622712
curr_Factors:  [101.38672155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685445]
Stock Position:  -0.006854448260502144
Bond Position:  [31.69422072]


portfolio before change:  [31.00741497]
curr_Stock_Price:  101.35466378835622
curr_Factors:  [101.35466379]
mat_Sqrt:  [[0.15]]
grads:  [0.08212695]
Stock Position:  0.08212694859584635
Bond Position:  [22.68346571]


portfolio before change:  [31.01170356]
curr_Stock_Price:  101.33782413808181
curr_Factors:  [101.33782414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04091552]
Stock Position:  -0.040915515712001554
Bond Position:  [35.15799289]


portfolio before change:  [31.03727767]
curr_Stock_Price:  100.92762481496291
curr_Factors:  [100.92762481]
mat_Sqrt:  [[0.15]]
grads:  [-0.15098747]
Stock Position:  -0.15098747096459555
Bond Position:  [46.27608449]


portfolio before change:  [30.96105326]
curr_Stock_Price:  101.50909609745682
curr_Factors:  [101.5090961]
mat_Sqrt:  [[0.15]]
grads:  [-0.00068595]
Stock Position:  -0.0006859534412555039
Bond Position:  [31.03068377]


portfolio before change:  [30.96758236]
curr_Stock_Price:  103.30154447097094
curr_Factors:  [103.30154447]
mat_Sqrt:  [[0.15]]
grads:  [-0.12952525]
Stock Position:  -0.12952524712221697
Bond Position:  [44.34774044]


portfolio before change:  [30.96600765]
curr_Stock_Price:  103.39930945769666
curr_Factors:  [103.39930946]
mat_Sqrt:  [[0.15]]
grads:  [0.02228592]
Stock Position:  0.022285924539260336
Bond Position:  [28.66165844]


portfolio before change:  [30.95785686]
curr_Stock_Price:  102.71201016871298
curr_Factors:  [102.71201017]
mat_Sqrt:  [[0.15]]
grads:  [0.05814434]
Stock Position:  0.05814433899066298
Bond Position:  [24.98573492]


portfolio before change:  [30.92226592]
curr_Stock_Price:  101.99245329167896
curr_Factors:  [101.99245329]
mat_Sqrt:  [[0.15]]
grads:  [-0.29870988]
Stock Position:  -0.29870988301341506
Bond Position:  [61.38841971]


portfolio before change:  [30.33139922]
curr_Stock_Price:  104.0218997714167
curr_Factors:  [104.02189977]
mat_Sqrt:  [[0.15]]
grads:  [-0.15599491]
Stock Position:  -0.15599490929668733
Bond Position:  [46.55828604]


portfolio before change:  [30.41263783]
curr_Stock_Price:  103.57574682891246
curr_Factors:  [103.57574683]
mat_Sqrt:  [[0.15]]
grads:  [0.03105945]
Stock Position:  0.031059453991359565
Bond Position:  [27.19563169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.41263783]
Stock Price:  103.60965893076268
PL:  [26.8029789]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.16306935e-02]
 [ 6.27502294e-03]
 [ 2.76178392e-03]
 [ 3.63090107e-03]
 [ 7.60084765e-03]
 [ 1.03458303e-02]
 [-1.42433883e-02]
 [-1.07208542e-04]
 [ 3.56016428e-03]
 [-3.72596178e-02]
 [-4.40824037e-04]
 [-2.63817142e-02]
 [ 2.11788688e-03]
 [-5.94378171e-03]
 [ 8.46244863e-04]
 [ 4.91505283e-03]
 [ 2.65478101e-02]
 [ 1.49778164e-02]
 [-6.36201333e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.29294032]
curr_Stock_Price:  100.23047466540393
curr_Factors:  [100.23047467]
mat_Sqrt:  [[0.15]]
grads:  [0.21087129]
Stock Position:  0.21087128968697977
Bond Position:  [-15.84278914]


portfolio before change:  [5.08752573]
curr_Stock_Price:  99.27513646260242
curr_Factors:  [99.27513646]
mat_Sqrt:  [[0.15]]
grads:  [0.04183349]
Stock Position:  0.04183348629401218
Bond Position:  [0.93450067]


portfolio before change:  [5.0823965]
curr_Stock_Price:  99.14694057846141
curr_Factors:  [99.14694058]
mat_Sqrt:  [[0.15]]
grads:  [0.01841189]
Stock Position:  0.018411892800019293
Bond Position:  [3.25691366]


portfolio before change:  [5.09211015]
curr_Stock_Price:  99.63028677711219
curr_Factors:  [99.63028678]
mat_Sqrt:  [[0.15]]
grads:  [0.02420601]
Stock Position:  0.024206007162129242
Bond Position:  [2.68045872]


portfolio before change:  [5.10012115]
curr_Stock_Price:  99.93355043963354
curr_Factors:  [99.93355044]
mat_Sqrt:  [[0.15]]
grads:  [0.05067232]
Stock Position:  0.05067231765144417
Bond Position:  [0.03625654]


portfolio before change:  [5.02903846]
curr_Stock_Price:  98.53058016010851
curr_Factors:  [98.53058016]
mat_Sqrt:  [[0.15]]
grads:  [0.0689722]
Stock Position:  0.06897220175989689
Bond Position:  [-1.76683259]


portfolio before change:  [5.01959982]
curr_Stock_Price:  98.40013801272481
curr_Factors:  [98.40013801]
mat_Sqrt:  [[0.15]]
grads:  [-0.09495592]
Stock Position:  -0.09495592225045664
Bond Position:  [14.36327567]


portfolio before change:  [4.95873773]
curr_Stock_Price:  99.07890931460634
curr_Factors:  [99.07890931]
mat_Sqrt:  [[0.15]]
grads:  [-0.00071472]
Stock Position:  -0.0007147236137043934
Bond Position:  [5.02955177]


portfolio before change:  [4.96137124]
curr_Stock_Price:  97.1537397292841
curr_Factors:  [97.15373973]
mat_Sqrt:  [[0.15]]
grads:  [0.02373443]
Stock Position:  0.023734428516442897
Bond Position:  [2.65548275]


portfolio before change:  [4.94779368]
curr_Stock_Price:  96.5537035301957
curr_Factors:  [96.55370353]
mat_Sqrt:  [[0.15]]
grads:  [-0.24839745]
Stock Position:  -0.24839745221604867
Bond Position:  [28.93148763]


portfolio before change:  [5.30159267]
curr_Stock_Price:  95.15849911570676
curr_Factors:  [95.15849912]
mat_Sqrt:  [[0.15]]
grads:  [-0.00293883]
Stock Position:  -0.002938826916353855
Bond Position:  [5.58124703]


portfolio before change:  [5.30411334]
curr_Stock_Price:  94.77563228008732
curr_Factors:  [94.77563228]
mat_Sqrt:  [[0.15]]
grads:  [-0.17587809]
Stock Position:  -0.17587809449600214
Bond Position:  [21.97307095]


portfolio before change:  [5.39527918]
curr_Stock_Price:  94.2885227911167
curr_Factors:  [94.28852279]
mat_Sqrt:  [[0.15]]
grads:  [0.01411925]
Stock Position:  0.01411924588801539
Bond Position:  [4.06399634]


portfolio before change:  [5.382472]
curr_Stock_Price:  93.30948289401364
curr_Factors:  [93.30948289]
mat_Sqrt:  [[0.15]]
grads:  [-0.03962521]
Stock Position:  -0.039625211408542665
Bond Position:  [9.07987999]


portfolio before change:  [5.40502391]
curr_Stock_Price:  92.79764589794446
curr_Factors:  [92.7976459]
mat_Sqrt:  [[0.15]]
grads:  [0.00564163]
Stock Position:  0.00564163241809744
Bond Position:  [4.8814937]


portfolio before change:  [5.40929322]
curr_Stock_Price:  93.33805545825706
curr_Factors:  [93.33805546]
mat_Sqrt:  [[0.15]]
grads:  [0.03276702]
Stock Position:  0.03276701886569758
Bond Position:  [2.3508834]


portfolio before change:  [5.45728854]
curr_Stock_Price:  94.78486159393422
curr_Factors:  [94.78486159]
mat_Sqrt:  [[0.15]]
grads:  [0.1769854]
Stock Position:  0.1769854007424531
Bond Position:  [-11.31824817]


portfolio before change:  [5.25264279]
curr_Stock_Price:  93.6445650643001
curr_Factors:  [93.64456506]
mat_Sqrt:  [[0.15]]
grads:  [0.09985211]
Stock Position:  0.09985210918209873
Bond Position:  [-4.09796455]


portfolio before change:  [5.05062388]
curr_Stock_Price:  91.63164519641508
curr_Factors:  [91.6316452]
mat_Sqrt:  [[0.15]]
grads:  [-0.00424134]
Stock Position:  -0.004241342221108554
Bond Position:  [5.43926504]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.05062388]
Stock Price:  91.8075983835778
PL:  [5.05062388]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.04342935e-02]
 [-7.81420491e-03]
 [-1.06866240e-02]
 [ 3.47177940e-03]
 [ 6.28502772e-03]
 [-1.90607741e-03]
 [-3.29142709e-03]
 [ 5.04165187e-04]
 [-1.08497039e-03]
 [ 5.33663653e-03]
 [-5.17823283e-03]
 [-2.19705547e-02]
 [-1.29688352e-04]
 [-1.91425668e-02]
 [ 7.86984566e-04]
 [ 8.28706738e-03]
 [-4.71697597e-02]
 [-2.10957970e-02]
 [ 4.61966849e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.91964377]
curr_Stock_Price:  101.44854927229696
curr_Factors:  [101.44854927]
mat_Sqrt:  [[0.15]]
grads:  [-0.26956196]
Stock Position:  -0.26956195656488585
Bond Position:  [51.26631321]


portfolio before change:  [23.98185425]
curr_Stock_Price:  101.26531759175363
curr_Factors:  [101.26531759]
mat_Sqrt:  [[0.15]]
grads:  [-0.0520947]
Stock Position:  -0.05209469939674815
Bond Position:  [29.25724052]


portfolio before change:  [24.03724846]
curr_Stock_Price:  100.34240238311834
curr_Factors:  [100.34240238]
mat_Sqrt:  [[0.15]]
grads:  [-0.07124416]
Stock Position:  -0.07124415987568626
Bond Position:  [31.18605862]


portfolio before change:  [23.9359221]
curr_Stock_Price:  101.87409070154747
curr_Factors:  [101.8740907]
mat_Sqrt:  [[0.15]]
grads:  [0.0231452]
Stock Position:  0.02314519603215918
Bond Position:  [21.5780263]


portfolio before change:  [23.93484799]
curr_Stock_Price:  101.59458169364346
curr_Factors:  [101.59458169]
mat_Sqrt:  [[0.15]]
grads:  [0.04190018]
Stock Position:  0.041900184824782964
Bond Position:  [19.67801624]


portfolio before change:  [23.95900908]
curr_Stock_Price:  102.05379144831372
curr_Factors:  [102.05379145]
mat_Sqrt:  [[0.15]]
grads:  [-0.01270718]
Stock Position:  -0.012707182750337359
Bond Position:  [25.25582526]


portfolio before change:  [23.95556492]
curr_Stock_Price:  102.82177517697706
curr_Factors:  [102.82177518]
mat_Sqrt:  [[0.15]]
grads:  [-0.02194285]
Stock Position:  -0.021942847263944125
Bond Position:  [26.21176743]


portfolio before change:  [23.9695366]
curr_Stock_Price:  102.48371905964005
curr_Factors:  [102.48371906]
mat_Sqrt:  [[0.15]]
grads:  [0.0033611]
Stock Position:  0.0033611012461285746
Bond Position:  [23.62507844]


portfolio before change:  [23.97149365]
curr_Stock_Price:  101.30852160601808
curr_Factors:  [101.30852161]
mat_Sqrt:  [[0.15]]
grads:  [-0.00723314]
Stock Position:  -0.00723313596095303
Bond Position:  [24.70427196]


portfolio before change:  [23.97973293]
curr_Stock_Price:  101.02338325306707
curr_Factors:  [101.02338325]
mat_Sqrt:  [[0.15]]
grads:  [0.03557758]
Stock Position:  0.03557757686425592
Bond Position:  [20.38556575]


portfolio before change:  [23.98188868]
curr_Stock_Price:  100.94071094309248
curr_Factors:  [100.94071094]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452155]
Stock Position:  -0.03452155220126298
Bond Position:  [27.4665187]


portfolio before change:  [23.95795564]
curr_Stock_Price:  101.83292247316794
curr_Factors:  [101.83292247]
mat_Sqrt:  [[0.15]]
grads:  [-0.14647036]
Stock Position:  -0.14647036484762296
Bond Position:  [38.87346095]


portfolio before change:  [24.00557578]
curr_Stock_Price:  101.57416322509867
curr_Factors:  [101.57416323]
mat_Sqrt:  [[0.15]]
grads:  [-0.00086459]
Stock Position:  -0.0008645890126936605
Bond Position:  [24.09339569]


portfolio before change:  [24.01111512]
curr_Stock_Price:  102.13484601998925
curr_Factors:  [102.13484602]
mat_Sqrt:  [[0.15]]
grads:  [-0.12761711]
Stock Position:  -0.12761711206286439
Bond Position:  [37.04526921]


portfolio before change:  [23.95687698]
curr_Stock_Price:  102.63243301266108
curr_Factors:  [102.63243301]
mat_Sqrt:  [[0.15]]
grads:  [0.00524656]
Stock Position:  0.0052465637745249686
Bond Position:  [23.41840938]


portfolio before change:  [23.96849216]
curr_Stock_Price:  103.73026397707073
curr_Factors:  [103.73026398]
mat_Sqrt:  [[0.15]]
grads:  [0.05524712]
Stock Position:  0.05524711587072389
Bond Position:  [18.23769424]


portfolio before change:  [24.04420036]
curr_Stock_Price:  105.01808156346453
curr_Factors:  [105.01808156]
mat_Sqrt:  [[0.15]]
grads:  [-0.31446506]
Stock Position:  -0.3144650646759113
Bond Position:  [57.06871817]


portfolio before change:  [24.20589851]
curr_Stock_Price:  104.54925622461907
curr_Factors:  [104.54925622]
mat_Sqrt:  [[0.15]]
grads:  [-0.14063865]
Stock Position:  -0.140638646680449
Bond Position:  [38.90956442]


portfolio before change:  [24.31008894]
curr_Stock_Price:  103.87759287933423
curr_Factors:  [103.87759288]
mat_Sqrt:  [[0.15]]
grads:  [0.03079779]
Stock Position:  0.03079778992522148
Bond Position:  [21.11088866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.31008894]
Stock Price:  102.63276580289015
PL:  [21.67732314]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.15569106e-03]
 [ 4.57890629e-03]
 [ 3.45594637e-03]
 [ 2.33411036e-03]
 [ 6.12315608e-03]
 [ 2.54831088e-03]
 [ 1.14665994e-03]
 [ 7.01135899e-04]
 [-1.11410255e-03]
 [ 2.96725253e-02]
 [-3.74603413e-03]
 [-2.54523376e-02]
 [ 1.65150809e-03]
 [-1.29470813e-02]
 [-3.46725676e-03]
 [ 1.09058122e-02]
 [ 6.41335588e-03]
 [ 1.89481621e-02]
 [ 4.07178186e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.84384571]
curr_Stock_Price:  99.63298369874572
curr_Factors:  [99.6329837]
mat_Sqrt:  [[0.15]]
grads:  [0.06103794]
Stock Position:  0.06103794039192386
Bond Position:  [-9.92523783]


portfolio before change:  [-3.85167356]
curr_Stock_Price:  99.54539504222409
curr_Factors:  [99.54539504]
mat_Sqrt:  [[0.15]]
grads:  [0.03052604]
Stock Position:  0.030526041933034237
Bond Position:  [-6.89040046]


portfolio before change:  [-3.86775085]
curr_Stock_Price:  99.07515797543884
curr_Factors:  [99.07515798]
mat_Sqrt:  [[0.15]]
grads:  [0.02303964]
Stock Position:  0.023039642434653958
Bond Position:  [-6.15040707]


portfolio before change:  [-3.82057728]
curr_Stock_Price:  101.18939943475105
curr_Factors:  [101.18939943]
mat_Sqrt:  [[0.15]]
grads:  [0.01556074]
Stock Position:  0.015560735726997685
Bond Position:  [-5.39515878]


portfolio before change:  [-3.81128937]
curr_Stock_Price:  101.87297071883461
curr_Factors:  [101.87297072]
mat_Sqrt:  [[0.15]]
grads:  [0.04082104]
Stock Position:  0.04082104052125879
Bond Position:  [-7.96985003]


portfolio before change:  [-3.81891547]
curr_Stock_Price:  101.73496844027765
curr_Factors:  [101.73496844]
mat_Sqrt:  [[0.15]]
grads:  [0.01698874]
Stock Position:  0.016988739179559394
Bond Position:  [-5.54726432]


portfolio before change:  [-3.82111145]
curr_Stock_Price:  101.68734949158839
curr_Factors:  [101.68734949]
mat_Sqrt:  [[0.15]]
grads:  [0.0076444]
Stock Position:  0.007644399604547214
Bond Position:  [-4.59845018]


portfolio before change:  [-3.81203738]
curr_Stock_Price:  103.02477644578316
curr_Factors:  [103.02477645]
mat_Sqrt:  [[0.15]]
grads:  [0.00467424]
Stock Position:  0.004674239328204217
Bond Position:  [-4.29359984]


portfolio before change:  [-3.82132056]
curr_Stock_Price:  101.2684158673516
curr_Factors:  [101.26841587]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742735]
Stock Position:  -0.0074273503031876305
Bond Position:  [-3.06916456]


portfolio before change:  [-3.82889509]
curr_Stock_Price:  102.18491282058778
curr_Factors:  [102.18491282]
mat_Sqrt:  [[0.15]]
grads:  [0.19781684]
Stock Position:  0.19781683530648067
Bond Position:  [-24.04279116]


portfolio before change:  [-4.15704525]
curr_Stock_Price:  100.55644318316772
curr_Factors:  [100.55644318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02497356]
Stock Position:  -0.02497356083801011
Bond Position:  [-1.6457928]


portfolio before change:  [-4.12681888]
curr_Stock_Price:  99.32963076330188
curr_Factors:  [99.32963076]
mat_Sqrt:  [[0.15]]
grads:  [-0.16968225]
Stock Position:  -0.16968225057861236
Bond Position:  [12.72765642]


portfolio before change:  [-4.18788508]
curr_Stock_Price:  99.70827093017152
curr_Factors:  [99.70827093]
mat_Sqrt:  [[0.15]]
grads:  [0.01101005]
Stock Position:  0.011010053915347212
Bond Position:  [-5.28567852]


portfolio before change:  [-4.17033356]
curr_Stock_Price:  101.42244156863755
curr_Factors:  [101.42244157]
mat_Sqrt:  [[0.15]]
grads:  [-0.08631388]
Stock Position:  -0.08631387507276321
Bond Position:  [4.58383039]


portfolio before change:  [-4.09175946]
curr_Stock_Price:  100.52539007652827
curr_Factors:  [100.52539008]
mat_Sqrt:  [[0.15]]
grads:  [-0.02311505]
Stock Position:  -0.023115045084932888
Bond Position:  [-1.76811054]


portfolio before change:  [-4.06481455]
curr_Stock_Price:  99.34057728188472
curr_Factors:  [99.34057728]
mat_Sqrt:  [[0.15]]
grads:  [0.07270541]
Stock Position:  0.07270541469563915
Bond Position:  [-11.28741241]


portfolio before change:  [-3.99040635]
curr_Stock_Price:  100.4028145554694
curr_Factors:  [100.40281456]
mat_Sqrt:  [[0.15]]
grads:  [0.04275571]
Stock Position:  0.04275570585255702
Bond Position:  [-8.28319956]


portfolio before change:  [-4.01681058]
curr_Stock_Price:  99.83369345065954
curr_Factors:  [99.83369345]
mat_Sqrt:  [[0.15]]
grads:  [0.12632108]
Stock Position:  0.12632108049595392
Bond Position:  [-16.62791061]


portfolio before change:  [-4.2615996]
curr_Stock_Price:  97.92877374527924
curr_Factors:  [97.92877375]
mat_Sqrt:  [[0.15]]
grads:  [0.02714521]
Stock Position:  0.027145212382257856
Bond Position:  [-6.91989696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.2615996]
Stock Price:  96.84002422118935
PL:  [-4.2615996]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.32592210e-02]
 [-4.26546203e-04]
 [ 1.51738132e-02]
 [ 1.82205621e-03]
 [ 9.12487581e-03]
 [ 5.84427029e-02]
 [ 4.36254988e-05]
 [ 9.95048604e-03]
 [ 1.34435199e-02]
 [-3.73614410e-02]
 [ 1.97955362e-03]
 [-2.64220539e-02]
 [ 1.33254976e-03]
 [-1.06541445e-02]
 [ 2.55139101e-03]
 [-1.81341957e-03]
 [-8.82181059e-02]
 [ 8.47765505e-03]
 [-2.25974446e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.22497431]
curr_Stock_Price:  100.5530000855298
curr_Factors:  [100.55300009]
mat_Sqrt:  [[0.15]]
grads:  [0.22172814]
Stock Position:  0.22172813979129533
Bond Position:  [-12.07045535]


portfolio before change:  [10.06254897]
curr_Stock_Price:  99.83406860283246
curr_Factors:  [99.8340686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00284364]
Stock Position:  -0.0028436413539427267
Bond Position:  [10.34644126]


portfolio before change:  [10.07109365]
curr_Stock_Price:  97.73895817190105
curr_Factors:  [97.73895817]
mat_Sqrt:  [[0.15]]
grads:  [0.10115875]
Stock Position:  0.10115875498960601
Bond Position:  [0.18394233]


portfolio before change:  [10.0779166]
curr_Stock_Price:  97.80595151729209
curr_Factors:  [97.80595152]
mat_Sqrt:  [[0.15]]
grads:  [0.01214704]
Stock Position:  0.012147041414521961
Bond Position:  [8.88986366]


portfolio before change:  [10.05646586]
curr_Stock_Price:  95.85704173582981
curr_Factors:  [95.85704174]
mat_Sqrt:  [[0.15]]
grads:  [0.06083251]
Stock Position:  0.060832505395134566
Bond Position:  [4.22524185]


portfolio before change:  [10.00545212]
curr_Stock_Price:  95.00108180022988
curr_Factors:  [95.0010818]
mat_Sqrt:  [[0.15]]
grads:  [0.38961802]
Stock Position:  0.38961801959919545
Bond Position:  [-27.00868124]


portfolio before change:  [9.75010701]
curr_Stock_Price:  94.36304125103453
curr_Factors:  [94.36304125]
mat_Sqrt:  [[0.15]]
grads:  [0.00029084]
Stock Position:  0.00029083665863583374
Bond Position:  [9.72266277]


portfolio before change:  [9.75227726]
curr_Stock_Price:  93.4665940789355
curr_Factors:  [93.46659408]
mat_Sqrt:  [[0.15]]
grads:  [0.06633657]
Stock Position:  0.06633657362773707
Bond Position:  [3.55202366]


portfolio before change:  [9.68603373]
curr_Stock_Price:  92.4546087220351
curr_Factors:  [92.45460872]
mat_Sqrt:  [[0.15]]
grads:  [0.08962347]
Stock Position:  0.08962346608135621
Bond Position:  [1.39993124]


portfolio before change:  [9.64785444]
curr_Stock_Price:  92.02470659935462
curr_Factors:  [92.0247066]
mat_Sqrt:  [[0.15]]
grads:  [-0.24907627]
Stock Position:  -0.24907627335741553
Bond Position:  [32.56902542]


portfolio before change:  [9.84335837]
curr_Stock_Price:  91.27248459464793
curr_Factors:  [91.27248459]
mat_Sqrt:  [[0.15]]
grads:  [0.01319702]
Stock Position:  0.013197024144605263
Bond Position:  [8.63883319]


portfolio before change:  [9.8524661]
curr_Stock_Price:  91.79894832953171
curr_Factors:  [91.79894833]
mat_Sqrt:  [[0.15]]
grads:  [-0.17614703]
Stock Position:  -0.17614702578094807
Bond Position:  [26.02257782]


portfolio before change:  [10.00144632]
curr_Stock_Price:  90.99011398683068
curr_Factors:  [90.99011399]
mat_Sqrt:  [[0.15]]
grads:  [0.00888367]
Stock Position:  0.00888366507059171
Bond Position:  [9.19312063]


portfolio before change:  [9.99678425]
curr_Stock_Price:  90.20658180120768
curr_Factors:  [90.2065818]
mat_Sqrt:  [[0.15]]
grads:  [-0.07102763]
Stock Position:  -0.07102762994415686
Bond Position:  [16.40394396]


portfolio before change:  [10.01446354]
curr_Stock_Price:  90.0154196911105
curr_Factors:  [90.01541969]
mat_Sqrt:  [[0.15]]
grads:  [0.01700927]
Stock Position:  0.01700927338374956
Bond Position:  [8.48336666]


portfolio before change:  [10.01181001]
curr_Stock_Price:  89.73471190280726
curr_Factors:  [89.7347119]
mat_Sqrt:  [[0.15]]
grads:  [-0.01208946]
Stock Position:  -0.012089463774724793
Bond Position:  [11.09665456]


portfolio before change:  [10.03229023]
curr_Stock_Price:  88.27015549945905
curr_Factors:  [88.2701555]
mat_Sqrt:  [[0.15]]
grads:  [-0.58812071]
Stock Position:  -0.5881207061321957
Bond Position:  [61.94579641]


portfolio before change:  [8.92434831]
curr_Stock_Price:  90.18035911059417
curr_Factors:  [90.18035911]
mat_Sqrt:  [[0.15]]
grads:  [0.0565177]
Stock Position:  0.05651770034508406
Bond Position:  [3.8275618]


portfolio before change:  [8.87756544]
curr_Stock_Price:  89.33567010069287
curr_Factors:  [89.3356701]
mat_Sqrt:  [[0.15]]
grads:  [-0.01506496]
Stock Position:  -0.01506496306171509
Bond Position:  [10.22340401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.87756544]
Stock Price:  89.91617949154448
PL:  [8.87756544]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.38326648e-02]
 [-7.48480930e-03]
 [ 9.61151957e-03]
 [-1.19772366e-03]
 [ 5.39736722e-03]
 [-3.83587454e-02]
 [-5.02924775e-03]
 [ 2.94830660e-04]
 [-9.12771026e-04]
 [ 3.85635027e-02]
 [-1.11492789e-02]
 [-2.12422600e-02]
 [-1.43220112e-03]
 [-2.28867379e-02]
 [ 1.33354947e-02]
 [ 6.81416219e-03]
 [-4.99993834e-02]
 [-1.91720261e-02]
 [ 4.68467913e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.77544114]
curr_Stock_Price:  100.65439131073177
curr_Factors:  [100.65439131]
mat_Sqrt:  [[0.15]]
grads:  [0.15888443]
Stock Position:  0.1588844318814819
Bond Position:  [-4.21697464]


portfolio before change:  [11.95787896]
curr_Stock_Price:  101.80926967594054
curr_Factors:  [101.80926968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04989873]
Stock Position:  -0.0498987286890495
Bond Position:  [17.03803209]


portfolio before change:  [11.93508352]
curr_Stock_Price:  102.35147742258319
curr_Factors:  [102.35147742]
mat_Sqrt:  [[0.15]]
grads:  [0.0640768]
Stock Position:  0.06407679716068293
Bond Position:  [5.37672867]


portfolio before change:  [11.98435707]
curr_Stock_Price:  103.09947348226305
curr_Factors:  [103.09947348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00798482]
Stock Position:  -0.00798482440545884
Bond Position:  [12.80758826]


portfolio before change:  [11.98616085]
curr_Stock_Price:  103.27461991181175
curr_Factors:  [103.27461991]
mat_Sqrt:  [[0.15]]
grads:  [0.03598245]
Stock Position:  0.035982448150104304
Bond Position:  [8.27008719]


portfolio before change:  [12.03414444]
curr_Stock_Price:  104.55068133755547
curr_Factors:  [104.55068134]
mat_Sqrt:  [[0.15]]
grads:  [-0.25572497]
Stock Position:  -0.25572496958119206
Bond Position:  [38.77036425]


portfolio before change:  [12.37236795]
curr_Stock_Price:  103.2659819661681
curr_Factors:  [103.26598197]
mat_Sqrt:  [[0.15]]
grads:  [-0.03352832]
Stock Position:  -0.033528318310425125
Bond Position:  [15.83470267]


portfolio before change:  [12.40810113]
curr_Stock_Price:  102.31830522013406
curr_Factors:  [102.31830522]
mat_Sqrt:  [[0.15]]
grads:  [0.00196554]
Stock Position:  0.0019655377322855354
Bond Position:  [12.20699064]


portfolio before change:  [12.40963445]
curr_Stock_Price:  101.54558555592351
curr_Factors:  [101.54558556]
mat_Sqrt:  [[0.15]]
grads:  [-0.00608514]
Stock Position:  -0.006085140172087913
Bond Position:  [13.02755357]


portfolio before change:  [12.40586627]
curr_Stock_Price:  102.70011583071097
curr_Factors:  [102.70011583]
mat_Sqrt:  [[0.15]]
grads:  [0.25709002]
Stock Position:  0.2570900179320126
Bond Position:  [-13.99730835]


portfolio before change:  [12.58991506]
curr_Stock_Price:  103.42962121107368
curr_Factors:  [103.42962121]
mat_Sqrt:  [[0.15]]
grads:  [-0.07432853]
Stock Position:  -0.07432852605654465
Bond Position:  [20.27768635]


portfolio before change:  [12.65648744]
curr_Stock_Price:  102.60218205032838
curr_Factors:  [102.60218205]
mat_Sqrt:  [[0.15]]
grads:  [-0.14161507]
Stock Position:  -0.1416150669705347
Bond Position:  [27.18650233]


portfolio before change:  [12.41182036]
curr_Stock_Price:  104.3778727393999
curr_Factors:  [104.37787274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954801]
Stock Position:  -0.009548007490774212
Bond Position:  [13.40842107]


portfolio before change:  [12.40475164]
curr_Stock_Price:  105.46933070267052
curr_Factors:  [105.4693307]
mat_Sqrt:  [[0.15]]
grads:  [-0.15257825]
Stock Position:  -0.1525782529113747
Bond Position:  [28.49707785]


portfolio before change:  [12.28766581]
curr_Stock_Price:  106.28341123449421
curr_Factors:  [106.28341123]
mat_Sqrt:  [[0.15]]
grads:  [0.0889033]
Stock Position:  0.08890329815185119
Bond Position:  [2.83872002]


portfolio before change:  [12.25008703]
curr_Stock_Price:  105.85273477716034
curr_Factors:  [105.85273478]
mat_Sqrt:  [[0.15]]
grads:  [0.04542775]
Stock Position:  0.04542774796357937
Bond Position:  [7.44143567]


portfolio before change:  [12.20071473]
curr_Stock_Price:  104.72494635445476
curr_Factors:  [104.72494635]
mat_Sqrt:  [[0.15]]
grads:  [-0.33332922]
Stock Position:  -0.33332922243834784
Bond Position:  [47.10859967]


portfolio before change:  [12.1467627]
curr_Stock_Price:  104.92214072556513
curr_Factors:  [104.92214073]
mat_Sqrt:  [[0.15]]
grads:  [-0.12781351]
Stock Position:  -0.12781350712021852
Bond Position:  [25.55722949]


portfolio before change:  [12.3854625]
curr_Stock_Price:  103.10457308895072
curr_Factors:  [103.10457309]
mat_Sqrt:  [[0.15]]
grads:  [0.03123119]
Stock Position:  0.03123119417339856
Bond Position:  [9.16538356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.3854625]
Stock Price:  104.61511792216021
PL:  [7.77034458]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.24731340e-01]
 [ 9.16094012e-03]
 [ 4.06869806e-02]
 [-7.48764809e-03]
 [ 9.22517119e-03]
 [ 6.85428644e-02]
 [-1.08525908e-03]
 [ 9.50014442e-03]
 [ 1.09887288e-02]
 [-3.73663955e-02]
 [ 1.94595424e-03]
 [-2.64354313e-02]
 [ 1.25668696e-03]
 [-8.64682959e-03]
 [ 2.93571219e-03]
 [-3.06455262e-03]
 [-9.29721223e-02]
 [ 4.49202486e-03]
 [-2.29320503e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.1690177]
curr_Stock_Price:  98.30383944375579
curr_Factors:  [98.30383944]
mat_Sqrt:  [[0.15]]
grads:  [0.83154227]
Stock Position:  0.8315422675642531
Bond Position:  [-105.91281526]


portfolio before change:  [-25.24321654]
curr_Stock_Price:  97.04387062847898
curr_Factors:  [97.04387063]
mat_Sqrt:  [[0.15]]
grads:  [0.06107293]
Stock Position:  0.061072934137774024
Bond Position:  [-31.16997046]


portfolio before change:  [-25.29859594]
curr_Stock_Price:  96.26470508245389
curr_Factors:  [96.26470508]
mat_Sqrt:  [[0.15]]
grads:  [0.27124654]
Stock Position:  0.2712465375242537
Bond Position:  [-51.41006387]


portfolio before change:  [-25.66310211]
curr_Stock_Price:  94.96827542919598
curr_Factors:  [94.96827543]
mat_Sqrt:  [[0.15]]
grads:  [-0.04991765]
Stock Position:  -0.049917653958464994
Bond Position:  [-20.9225086]


portfolio before change:  [-25.68961945]
curr_Stock_Price:  95.39469892012015
curr_Factors:  [95.39469892]
mat_Sqrt:  [[0.15]]
grads:  [0.06150114]
Stock Position:  0.06150114126621709
Bond Position:  [-31.55650231]


portfolio before change:  [-25.76571301]
curr_Stock_Price:  94.2857203325469
curr_Factors:  [94.28572033]
mat_Sqrt:  [[0.15]]
grads:  [0.45695243]
Stock Position:  0.45695242926555296
Bond Position:  [-68.84980197]


portfolio before change:  [-25.60075049]
curr_Stock_Price:  94.6843988727627
curr_Factors:  [94.68439887]
mat_Sqrt:  [[0.15]]
grads:  [-0.00723506]
Stock Position:  -0.007235060551148825
Bond Position:  [-24.91570313]


portfolio before change:  [-25.60098646]
curr_Stock_Price:  93.85596957967275
curr_Factors:  [93.85596958]
mat_Sqrt:  [[0.15]]
grads:  [0.0633343]
Stock Position:  0.06333429616412055
Bond Position:  [-31.54528823]


portfolio before change:  [-25.62570313]
curr_Stock_Price:  93.59024685431586
curr_Factors:  [93.59024685]
mat_Sqrt:  [[0.15]]
grads:  [0.07325819]
Stock Position:  0.07325819211893989
Bond Position:  [-32.48195541]


portfolio before change:  [-25.76465736]
curr_Stock_Price:  91.80433426697563
curr_Factors:  [91.80433427]
mat_Sqrt:  [[0.15]]
grads:  [-0.2491093]
Stock Position:  -0.249109303496423
Bond Position:  [-2.89534359]


portfolio before change:  [-25.64492803]
curr_Stock_Price:  91.32079852183662
curr_Factors:  [91.32079852]
mat_Sqrt:  [[0.15]]
grads:  [0.01297303]
Stock Position:  0.012973028269379166
Bond Position:  [-26.82963533]


portfolio before change:  [-25.65823928]
curr_Stock_Price:  90.81181928206313
curr_Factors:  [90.81181928]
mat_Sqrt:  [[0.15]]
grads:  [-0.17623621]
Stock Position:  -0.1762362088744685
Bond Position:  [-9.65390853]


portfolio before change:  [-25.63592212]
curr_Stock_Price:  90.67149091977609
curr_Factors:  [90.67149092]
mat_Sqrt:  [[0.15]]
grads:  [0.00837791]
Stock Position:  0.008377913080210214
Bond Position:  [-26.39555999]


portfolio before change:  [-25.63533871]
curr_Stock_Price:  91.52887901657009
curr_Factors:  [91.52887902]
mat_Sqrt:  [[0.15]]
grads:  [-0.05764553]
Stock Position:  -0.05764553063020879
Bond Position:  [-20.35910792]


portfolio before change:  [-25.51628105]
curr_Stock_Price:  89.37523276558963
curr_Factors:  [89.37523277]
mat_Sqrt:  [[0.15]]
grads:  [0.01957141]
Stock Position:  0.019571414629193196
Bond Position:  [-27.26548078]


portfolio before change:  [-25.52917614]
curr_Stock_Price:  89.06468430013646
curr_Factors:  [89.0646843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02043035]
Stock Position:  -0.020430350805146873
Bond Position:  [-23.7095534]


portfolio before change:  [-25.51335672]
curr_Stock_Price:  88.0002116035941
curr_Factors:  [88.0002116]
mat_Sqrt:  [[0.15]]
grads:  [-0.61981415]
Stock Position:  -0.6198141489984905
Bond Position:  [29.03041955]


portfolio before change:  [-25.54083237]
curr_Stock_Price:  88.0562512384638
curr_Factors:  [88.05625124]
mat_Sqrt:  [[0.15]]
grads:  [0.02994683]
Stock Position:  0.02994683239586469
Bond Position:  [-28.17783816]


portfolio before change:  [-25.51110636]
curr_Stock_Price:  89.2841388424498
curr_Factors:  [89.28413884]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528803]
Stock Position:  -0.015288033503147806
Bond Position:  [-24.14612746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.51110636]
Stock Price:  89.88441244453549
PL:  [-25.51110636]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.97037227e-02]
 [-7.29652037e-03]
 [-1.03883800e-02]
 [ 3.98408809e-03]
 [ 8.66301154e-03]
 [ 1.96482186e-02]
 [-1.18640053e-02]
 [ 7.02822993e-03]
 [ 9.41407890e-03]
 [-3.73165319e-02]
 [-4.86257244e-04]
 [-2.63637024e-02]
 [ 2.02348817e-03]
 [-2.72030694e-03]
 [-8.43286394e-05]
 [ 7.64383284e-03]
 [ 3.27125768e-02]
 [ 1.99395082e-02]
 [ 2.29024175e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.80977771]
curr_Stock_Price:  100.59124271815465
curr_Factors:  [100.59124272]
mat_Sqrt:  [[0.15]]
grads:  [0.19802482]
Stock Position:  0.19802481803350577
Bond Position:  [-9.10978483]


portfolio before change:  [11.08708232]
curr_Stock_Price:  102.00309776168055
curr_Factors:  [102.00309776]
mat_Sqrt:  [[0.15]]
grads:  [-0.04864347]
Stock Position:  -0.04864346913903805
Bond Position:  [16.04886685]


portfolio before change:  [11.17453449]
curr_Stock_Price:  100.28777076511648
curr_Factors:  [100.28777077]
mat_Sqrt:  [[0.15]]
grads:  [-0.06925587]
Stock Position:  -0.0692558665170794
Bond Position:  [18.12005096]


portfolio before change:  [11.26455773]
curr_Stock_Price:  99.0533242623214
curr_Factors:  [99.05332426]
mat_Sqrt:  [[0.15]]
grads:  [0.02656059]
Stock Position:  0.026560587234601425
Bond Position:  [8.63364327]


portfolio before change:  [11.23837161]
curr_Stock_Price:  97.98614902290417
curr_Factors:  [97.98614902]
mat_Sqrt:  [[0.15]]
grads:  [0.05775341]
Stock Position:  0.05775341027967135
Bond Position:  [5.57933735]


portfolio before change:  [11.22605709]
curr_Stock_Price:  97.74876849387717
curr_Factors:  [97.74876849]
mat_Sqrt:  [[0.15]]
grads:  [0.13098812]
Stock Position:  0.1309881243322643
Bond Position:  [-1.57787076]


portfolio before change:  [11.22618618]
curr_Stock_Price:  97.75276590586564
curr_Factors:  [97.75276591]
mat_Sqrt:  [[0.15]]
grads:  [-0.07909337]
Stock Position:  -0.07909336834183536
Bond Position:  [18.9577817]


portfolio before change:  [11.36841903]
curr_Stock_Price:  96.0144050548592
curr_Factors:  [96.01440505]
mat_Sqrt:  [[0.15]]
grads:  [0.04685487]
Stock Position:  0.04685486622462879
Bond Position:  [6.86967693]


portfolio before change:  [11.29216547]
curr_Stock_Price:  94.35030480618103
curr_Factors:  [94.35030481]
mat_Sqrt:  [[0.15]]
grads:  [0.06276053]
Stock Position:  0.0627605260029634
Bond Position:  [5.37069072]


portfolio before change:  [11.27291764]
curr_Stock_Price:  94.02222165542908
curr_Factors:  [94.02222166]
mat_Sqrt:  [[0.15]]
grads:  [-0.24877688]
Stock Position:  -0.24877687914916907
Bond Position:  [34.66347252]


portfolio before change:  [10.98012084]
curr_Stock_Price:  95.23400531277946
curr_Factors:  [95.23400531]
mat_Sqrt:  [[0.15]]
grads:  [-0.00324171]
Stock Position:  -0.003241714959014222
Bond Position:  [11.28884234]


portfolio before change:  [10.98012077]
curr_Stock_Price:  96.10472860765182
curr_Factors:  [96.10472861]
mat_Sqrt:  [[0.15]]
grads:  [-0.17575802]
Stock Position:  -0.17575801604994395
Bond Position:  [27.8712972]


portfolio before change:  [11.37598563]
curr_Stock_Price:  93.89204904706871
curr_Factors:  [93.89204905]
mat_Sqrt:  [[0.15]]
grads:  [0.01348992]
Stock Position:  0.013489921128072832
Bond Position:  [10.10938929]


portfolio before change:  [11.39929942]
curr_Stock_Price:  95.43291241576468
curr_Factors:  [95.43291242]
mat_Sqrt:  [[0.15]]
grads:  [-0.01813538]
Stock Position:  -0.01813537960968077
Bond Position:  [13.13001151]


portfolio before change:  [11.42332351]
curr_Stock_Price:  94.2892266350416
curr_Factors:  [94.28922664]
mat_Sqrt:  [[0.15]]
grads:  [-0.00056219]
Stock Position:  -0.0005621909293675067
Bond Position:  [11.47633206]


portfolio before change:  [11.42590613]
curr_Stock_Price:  94.79941715965764
curr_Factors:  [94.79941716]
mat_Sqrt:  [[0.15]]
grads:  [0.05095889]
Stock Position:  0.05095888560877018
Bond Position:  [6.59503347]


portfolio before change:  [11.44461654]
curr_Stock_Price:  95.13422522552779
curr_Factors:  [95.13422523]
mat_Sqrt:  [[0.15]]
grads:  [0.21808385]
Stock Position:  0.2180838452878491
Bond Position:  [-9.30262112]


portfolio before change:  [11.69409707]
curr_Stock_Price:  96.28885672891487
curr_Factors:  [96.28885673]
mat_Sqrt:  [[0.15]]
grads:  [0.13293005]
Stock Position:  0.1329300547806135
Bond Position:  [-1.10558593]


portfolio before change:  [11.53031065]
curr_Stock_Price:  95.05881145897597
curr_Factors:  [95.05881146]
mat_Sqrt:  [[0.15]]
grads:  [0.01526828]
Stock Position:  0.01526827830437328
Bond Position:  [10.07892626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.53031065]
Stock Price:  94.93835396541132
PL:  [11.53031065]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.87610771e-01]
 [ 8.95570512e-03]
 [ 1.71427038e-02]
 [ 3.52165897e-04]
 [ 8.91731806e-03]
 [ 4.49287527e-02]
 [ 4.65215698e-04]
 [ 9.03641393e-03]
 [ 7.47339345e-03]
 [-3.72251349e-02]
 [-1.02332378e-03]
 [-2.58165443e-02]
 [ 1.67260487e-03]
 [-1.20408454e-03]
 [-2.28066819e-03]
 [ 1.08099715e-02]
 [ 4.97947721e-02]
 [ 2.03737289e-02]
 [ 3.88588695e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-31.6134733]
curr_Stock_Price:  97.81701672967836
curr_Factors:  [97.81701673]
mat_Sqrt:  [[0.15]]
grads:  [1.25073847]
Stock Position:  1.2507384704264242
Bond Position:  [-153.95697919]


portfolio before change:  [-31.92961723]
curr_Stock_Price:  97.59502798200326
curr_Factors:  [97.59502798]
mat_Sqrt:  [[0.15]]
grads:  [0.0597047]
Stock Position:  0.05970470076913276
Bond Position:  [-37.75649917]


portfolio before change:  [-31.93728327]
curr_Stock_Price:  97.62474534514062
curr_Factors:  [97.62474535]
mat_Sqrt:  [[0.15]]
grads:  [0.11428469]
Stock Position:  0.11428469216654746
Bond Position:  [-43.09429724]


portfolio before change:  [-31.97855263]
curr_Stock_Price:  97.35791659986312
curr_Factors:  [97.3579166]
mat_Sqrt:  [[0.15]]
grads:  [0.00234777]
Stock Position:  0.0023477726454968653
Bond Position:  [-32.20712688]


portfolio before change:  [-31.98788278]
curr_Stock_Price:  96.81384387469261
curr_Factors:  [96.81384387]
mat_Sqrt:  [[0.15]]
grads:  [0.05944879]
Stock Position:  0.059448787059227945
Bond Position:  [-37.74334836]


portfolio before change:  [-32.04818495]
curr_Stock_Price:  95.95823078395631
curr_Factors:  [95.95823078]
mat_Sqrt:  [[0.15]]
grads:  [0.29952502]
Stock Position:  0.29952501809783977
Bond Position:  [-60.79007576]


portfolio before change:  [-32.57713055]
curr_Stock_Price:  94.24302789811505
curr_Factors:  [94.2430279]
mat_Sqrt:  [[0.15]]
grads:  [0.00310144]
Stock Position:  0.0031014379850230365
Bond Position:  [-32.86941945]


portfolio before change:  [-32.58529956]
curr_Stock_Price:  94.25894575561001
curr_Factors:  [94.25894576]
mat_Sqrt:  [[0.15]]
grads:  [0.06024276]
Stock Position:  0.06024275951550767
Bond Position:  [-38.26371856]


portfolio before change:  [-32.5312498]
curr_Stock_Price:  95.314954630693
curr_Factors:  [95.31495463]
mat_Sqrt:  [[0.15]]
grads:  [0.04982262]
Stock Position:  0.0498226229672618
Bond Position:  [-37.28009084]


portfolio before change:  [-32.40243693]
curr_Stock_Price:  98.08747126189212
curr_Factors:  [98.08747126]
mat_Sqrt:  [[0.15]]
grads:  [-0.24816757]
Stock Position:  -0.24816756600103934
Bond Position:  [-8.06030794]


portfolio before change:  [-32.49042965]
curr_Stock_Price:  98.43392017721727
curr_Factors:  [98.43392018]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682216]
Stock Position:  -0.0068221585172026315
Bond Position:  [-31.81889784]


portfolio before change:  [-32.50251513]
curr_Stock_Price:  99.03926636329977
curr_Factors:  [99.03926636]
mat_Sqrt:  [[0.15]]
grads:  [-0.1721103]
Stock Position:  -0.17211029521700458
Bond Position:  [-15.45683776]


portfolio before change:  [-32.61816746]
curr_Stock_Price:  99.68877795477425
curr_Factors:  [99.68877795]
mat_Sqrt:  [[0.15]]
grads:  [0.0111507]
Stock Position:  0.011150699149262502
Bond Position:  [-33.72976703]


portfolio before change:  [-32.62690263]
curr_Stock_Price:  99.66172350087594
curr_Factors:  [99.6617235]
mat_Sqrt:  [[0.15]]
grads:  [-0.00802723]
Stock Position:  -0.008027230258599699
Bond Position:  [-31.82689503]


portfolio before change:  [-32.62255932]
curr_Stock_Price:  98.12931093859186
curr_Factors:  [98.12931094]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520445]
Stock Position:  -0.015204454630169732
Bond Position:  [-31.13055666]


portfolio before change:  [-32.65064494]
curr_Stock_Price:  99.46457802142677
curr_Factors:  [99.46457802]
mat_Sqrt:  [[0.15]]
grads:  [0.07206648]
Stock Position:  0.07206647689361255
Bond Position:  [-39.81870665]


portfolio before change:  [-32.74371446]
curr_Stock_Price:  98.31128731012538
curr_Factors:  [98.31128731]
mat_Sqrt:  [[0.15]]
grads:  [0.33196515]
Stock Position:  0.3319651470087696
Bond Position:  [-65.3796354]


portfolio before change:  [-32.95636498]
curr_Stock_Price:  97.71994941581204
curr_Factors:  [97.71994942]
mat_Sqrt:  [[0.15]]
grads:  [0.13582486]
Stock Position:  0.1358248596295411
Bond Position:  [-46.22916339]


portfolio before change:  [-32.80738311]
curr_Stock_Price:  98.90191718166098
curr_Factors:  [98.90191718]
mat_Sqrt:  [[0.15]]
grads:  [0.02590591]
Stock Position:  0.02590591301989911
Bond Position:  [-35.36952758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-32.80738311]
Stock Price:  98.72451896474999
PL:  [-32.80738311]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.95223718e-02]
 [ 8.00196628e-04]
 [ 4.10003957e-03]
 [ 1.75399343e-03]
 [ 8.41852910e-03]
 [ 5.92694408e-03]
 [-1.45222852e-02]
 [ 1.08074982e-03]
 [-2.49954496e-04]
 [-3.72484214e-02]
 [-9.79076051e-04]
 [-2.63495990e-02]
 [ 2.78356718e-03]
 [ 4.67595780e-03]
 [-2.31723623e-03]
 [ 1.17547542e-02]
 [ 4.71974741e-02]
 [ 1.96601568e-02]
 [ 3.91070686e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.99042854]
curr_Stock_Price:  100.07990421480571
curr_Factors:  [100.07990421]
mat_Sqrt:  [[0.15]]
grads:  [0.19681581]
Stock Position:  0.1968158120306665
Bond Position:  [-16.70687908]


portfolio before change:  [2.91868739]
curr_Stock_Price:  99.73661928232133
curr_Factors:  [99.73661928]
mat_Sqrt:  [[0.15]]
grads:  [0.00533464]
Stock Position:  0.005334644184132948
Bond Position:  [2.38662802]


portfolio before change:  [2.91539709]
curr_Stock_Price:  99.00797886724422
curr_Factors:  [99.00797887]
mat_Sqrt:  [[0.15]]
grads:  [0.0273336]
Stock Position:  0.02733359713387782
Bond Position:  [0.20915288]


portfolio before change:  [2.88202659]
curr_Stock_Price:  97.78520541077003
curr_Factors:  [97.78520541]
mat_Sqrt:  [[0.15]]
grads:  [0.01169329]
Stock Position:  0.011693289562128185
Bond Position:  [1.73859587]


portfolio before change:  [2.89515543]
curr_Stock_Price:  98.87079764055491
curr_Factors:  [98.87079764]
mat_Sqrt:  [[0.15]]
grads:  [0.05612353]
Stock Position:  0.05612352734721201
Bond Position:  [-2.65382248]


portfolio before change:  [2.89217162]
curr_Stock_Price:  98.82945529135301
curr_Factors:  [98.82945529]
mat_Sqrt:  [[0.15]]
grads:  [0.03951296]
Stock Position:  0.03951296051721498
Bond Position:  [-1.01287275]


portfolio before change:  [2.87767635]
curr_Stock_Price:  98.46901607079691
curr_Factors:  [98.46901607]
mat_Sqrt:  [[0.15]]
grads:  [-0.09681523]
Stock Position:  -0.09681523472441762
Bond Position:  [12.41097725]


portfolio before change:  [2.85596644]
curr_Stock_Price:  98.72530875964037
curr_Factors:  [98.72530876]
mat_Sqrt:  [[0.15]]
grads:  [0.007205]
Stock Position:  0.00720499881431023
Bond Position:  [2.14465071]


portfolio before change:  [2.86159038]
curr_Stock_Price:  99.43144446210052
curr_Factors:  [99.43144446]
mat_Sqrt:  [[0.15]]
grads:  [-0.00166636]
Stock Position:  -0.0016663633047822128
Bond Position:  [3.02727929]


portfolio before change:  [2.8663128]
curr_Stock_Price:  97.05170878668616
curr_Factors:  [97.05170879]
mat_Sqrt:  [[0.15]]
grads:  [-0.24832281]
Stock Position:  -0.24832280952986985
Bond Position:  [26.96646579]


portfolio before change:  [2.74362879]
curr_Stock_Price:  97.57291128416192
curr_Factors:  [97.57291128]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652717]
Stock Position:  -0.006527173676351012
Bond Position:  [3.38050413]


portfolio before change:  [2.74726431]
curr_Stock_Price:  97.14542285013259
curr_Factors:  [97.14542285]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566399]
Stock Position:  -0.17566399355897241
Bond Position:  [19.81221724]


portfolio before change:  [2.60424283]
curr_Stock_Price:  97.98779898247534
curr_Factors:  [97.98779898]
mat_Sqrt:  [[0.15]]
grads:  [0.01855711]
Stock Position:  0.01855711452011671
Bond Position:  [0.78587202]


portfolio before change:  [2.61871526]
curr_Stock_Price:  98.75709611822977
curr_Factors:  [98.75709612]
mat_Sqrt:  [[0.15]]
grads:  [0.03117305]
Stock Position:  0.031173051978907254
Bond Position:  [-0.45984483]


portfolio before change:  [2.60152024]
curr_Stock_Price:  98.20918568440148
curr_Factors:  [98.20918568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544824]
Stock Position:  -0.01544824151765932
Bond Position:  [4.11867946]


portfolio before change:  [2.60166191]
curr_Stock_Price:  98.26667652728392
curr_Factors:  [98.26667653]
mat_Sqrt:  [[0.15]]
grads:  [0.07836503]
Stock Position:  0.07836502813248344
Bond Position:  [-5.09900896]


portfolio before change:  [2.67070308]
curr_Stock_Price:  99.16396560658423
curr_Factors:  [99.16396561]
mat_Sqrt:  [[0.15]]
grads:  [0.31464983]
Stock Position:  0.3146498274384941
Bond Position:  [-28.53122159]


portfolio before change:  [2.73820253]
curr_Stock_Price:  99.40115991817194
curr_Factors:  [99.40115992]
mat_Sqrt:  [[0.15]]
grads:  [0.13106771]
Stock Position:  0.13106771232602202
Bond Position:  [-10.2900801]


portfolio before change:  [2.6388977]
curr_Stock_Price:  98.66312926763487
curr_Factors:  [98.66312927]
mat_Sqrt:  [[0.15]]
grads:  [0.02607138]
Stock Position:  0.02607137904686859
Bond Position:  [0.06661386]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.6388977]
Stock Price:  99.11054411071228
PL:  [2.6388977]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.66843182e-01]
 [ 7.03067320e-03]
 [ 5.48490469e-03]
 [ 3.60560085e-03]
 [ 8.78329638e-03]
 [ 2.47920788e-02]
 [-1.14244944e-02]
 [ 5.49152556e-03]
 [ 8.51905366e-03]
 [-3.73028204e-02]
 [-2.92353988e-04]
 [-2.63953229e-02]
 [ 1.86072901e-03]
 [-6.36669270e-03]
 [ 1.11650109e-03]
 [ 3.34581179e-03]
 [-7.74871568e-03]
 [ 1.41281543e-02]
 [ 2.73433457e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.1547457]
curr_Stock_Price:  97.97780275779708
curr_Factors:  [97.97780276]
mat_Sqrt:  [[0.15]]
grads:  [1.11228788]
Stock Position:  1.1122878794584388
Bond Position:  [-138.13426816]


portfolio before change:  [-28.13792481]
curr_Stock_Price:  98.92302457702144
curr_Factors:  [98.92302458]
mat_Sqrt:  [[0.15]]
grads:  [0.04687115]
Stock Position:  0.04687115467812936
Bond Position:  [-32.77456119]


portfolio before change:  [-28.14920404]
curr_Stock_Price:  98.85721499838095
curr_Factors:  [98.857215]
mat_Sqrt:  [[0.15]]
grads:  [0.03656603]
Stock Position:  0.036566031275043626
Bond Position:  [-31.76402006]


portfolio before change:  [-28.12744701]
curr_Stock_Price:  99.66941784124188
curr_Factors:  [99.66941784]
mat_Sqrt:  [[0.15]]
grads:  [0.02403734]
Stock Position:  0.0240373390303585
Bond Position:  [-30.52323459]


portfolio before change:  [-28.18886855]
curr_Stock_Price:  97.43165857779528
curr_Factors:  [97.43165858]
mat_Sqrt:  [[0.15]]
grads:  [0.05855531]
Stock Position:  0.058555309193582775
Bond Position:  [-33.89400944]


portfolio before change:  [-28.20010767]
curr_Stock_Price:  97.38444566746591
curr_Factors:  [97.38444567]
mat_Sqrt:  [[0.15]]
grads:  [0.16528053]
Stock Position:  0.1652805255204867
Bond Position:  [-44.29586003]


portfolio before change:  [-28.1709859]
curr_Stock_Price:  97.62765111421743
curr_Factors:  [97.62765111]
mat_Sqrt:  [[0.15]]
grads:  [-0.0761633]
Stock Position:  -0.07616329605568756
Bond Position:  [-20.7353422]


portfolio before change:  [-28.14266503]
curr_Stock_Price:  97.18773642979514
curr_Factors:  [97.18773643]
mat_Sqrt:  [[0.15]]
grads:  [0.03661017]
Stock Position:  0.03661017042060608
Bond Position:  [-31.70072462]


portfolio before change:  [-28.23818267]
curr_Stock_Price:  94.79519191275452
curr_Factors:  [94.79519191]
mat_Sqrt:  [[0.15]]
grads:  [0.05679369]
Stock Position:  0.05679369109518361
Bond Position:  [-33.62195151]


portfolio before change:  [-28.25585207]
curr_Stock_Price:  94.63209516056293
curr_Factors:  [94.63209516]
mat_Sqrt:  [[0.15]]
grads:  [-0.24868547]
Stock Position:  -0.24868546927736587
Bond Position:  [-4.72222508]


portfolio before change:  [-28.31025676]
curr_Stock_Price:  94.8461164680558
curr_Factors:  [94.84611647]
mat_Sqrt:  [[0.15]]
grads:  [-0.00194903]
Stock Position:  -0.0019490265883483188
Bond Position:  [-28.12539916]


portfolio before change:  [-28.31519441]
curr_Stock_Price:  93.7714367267959
curr_Factors:  [93.77143673]
mat_Sqrt:  [[0.15]]
grads:  [-0.17596882]
Stock Position:  -0.17596881947889234
Bond Position:  [-11.81434539]


portfolio before change:  [-28.21908238]
curr_Stock_Price:  93.20846204379137
curr_Factors:  [93.20846204]
mat_Sqrt:  [[0.15]]
grads:  [0.01240486]
Stock Position:  0.012404860053548607
Bond Position:  [-29.37532031]


portfolio before change:  [-28.22862982]
curr_Stock_Price:  93.03089480313108
curr_Factors:  [93.0308948]
mat_Sqrt:  [[0.15]]
grads:  [-0.04244462]
Stock Position:  -0.042444618011355614
Bond Position:  [-24.27996903]


portfolio before change:  [-28.20641411]
curr_Stock_Price:  92.36446251462245
curr_Factors:  [92.36446251]
mat_Sqrt:  [[0.15]]
grads:  [0.00744334]
Stock Position:  0.007443340579344653
Bond Position:  [-28.89391426]


portfolio before change:  [-28.21264699]
curr_Stock_Price:  92.49766937052901
curr_Factors:  [92.49766937]
mat_Sqrt:  [[0.15]]
grads:  [0.02230541]
Stock Position:  0.02230541192333092
Bond Position:  [-30.27584561]


portfolio before change:  [-28.21259465]
curr_Stock_Price:  92.83939101183378
curr_Factors:  [92.83939101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0516581]
Stock Position:  -0.051658104560547334
Bond Position:  [-23.41668769]


portfolio before change:  [-28.23665149]
curr_Stock_Price:  93.19174483750422
curr_Factors:  [93.19174484]
mat_Sqrt:  [[0.15]]
grads:  [0.0941877]
Stock Position:  0.09418769514324933
Bond Position:  [-37.01416714]


portfolio before change:  [-28.29241821]
curr_Stock_Price:  92.69792211501681
curr_Factors:  [92.69792212]
mat_Sqrt:  [[0.15]]
grads:  [0.00182289]
Stock Position:  0.0018228897135891496
Bond Position:  [-28.4613963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.29241821]
Stock Price:  92.06129953374713
PL:  [-28.29241821]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.05223197e-02]
 [ 6.97189544e-03]
 [ 6.80153658e-03]
 [ 2.63824371e-03]
 [ 6.49030657e-03]
 [ 1.07239189e-02]
 [-4.46295757e-03]
 [ 9.11137893e-04]
 [ 3.94729911e-03]
 [ 6.82123939e-02]
 [-1.41238393e-02]
 [-1.94182682e-02]
 [-1.07278351e-03]
 [-1.85004450e-02]
 [-2.53081827e-03]
 [ 1.01337833e-02]
 [-2.14272125e-02]
 [-2.13638673e-02]
 [ 4.45602901e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.79271351]
curr_Stock_Price:  99.1785694524443
curr_Factors:  [99.17856945]
mat_Sqrt:  [[0.15]]
grads:  [0.13681546]
Stock Position:  0.13681546473862854
Bond Position:  [-24.36187558]


portfolio before change:  [-10.82997138]
curr_Stock_Price:  98.95076884788774
curr_Factors:  [98.95076885]
mat_Sqrt:  [[0.15]]
grads:  [0.0464793]
Stock Position:  0.04647930294963366
Bond Position:  [-15.42913415]


portfolio before change:  [-10.84786757]
curr_Stock_Price:  98.64873285897512
curr_Factors:  [98.64873286]
mat_Sqrt:  [[0.15]]
grads:  [0.04534358]
Stock Position:  0.04534357721598249
Bond Position:  [-15.32095401]


portfolio before change:  [-10.77330722]
curr_Stock_Price:  100.37755700027162
curr_Factors:  [100.377557]
mat_Sqrt:  [[0.15]]
grads:  [0.01758829]
Stock Position:  0.01758829139776976
Bond Position:  [-12.53877694]


portfolio before change:  [-10.7597278]
curr_Stock_Price:  101.32787699056846
curr_Factors:  [101.32787699]
mat_Sqrt:  [[0.15]]
grads:  [0.04326871]
Stock Position:  0.04326871047063615
Bond Position:  [-15.14405437]


portfolio before change:  [-10.77566782]
curr_Stock_Price:  101.04699186233357
curr_Factors:  [101.04699186]
mat_Sqrt:  [[0.15]]
grads:  [0.07149279]
Stock Position:  0.07149279292231486
Bond Position:  [-17.99979949]


portfolio before change:  [-10.63187513]
curr_Stock_Price:  103.12123173609164
curr_Factors:  [103.12123174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02975305]
Stock Position:  -0.02975305048397817
Bond Position:  [-7.56370392]


portfolio before change:  [-10.65020942]
curr_Stock_Price:  103.67388505710942
curr_Factors:  [103.67388506]
mat_Sqrt:  [[0.15]]
grads:  [0.00607425]
Stock Position:  0.006074252617586469
Bond Position:  [-11.27995079]


portfolio before change:  [-10.64260247]
curr_Stock_Price:  105.39052252123535
curr_Factors:  [105.39052252]
mat_Sqrt:  [[0.15]]
grads:  [0.02631533]
Stock Position:  0.026315327376771006
Bond Position:  [-13.41598857]


portfolio before change:  [-10.64565795]
curr_Stock_Price:  105.40188214894596
curr_Factors:  [105.40188215]
mat_Sqrt:  [[0.15]]
grads:  [0.45474929]
Stock Position:  0.4547492929168839
Bond Position:  [-58.57708933]


portfolio before change:  [-10.49844802]
curr_Stock_Price:  105.75780581256683
curr_Factors:  [105.75780581]
mat_Sqrt:  [[0.15]]
grads:  [-0.09415893]
Stock Position:  -0.09415892883776619
Bond Position:  [-0.54040631]


portfolio before change:  [-10.38761748]
curr_Stock_Price:  104.57931255952225
curr_Factors:  [104.57931256]
mat_Sqrt:  [[0.15]]
grads:  [-0.12945512]
Stock Position:  -0.12945512101666748
Bond Position:  [3.15071009]


portfolio before change:  [-10.26247194]
curr_Stock_Price:  103.61868804221842
curr_Factors:  [103.61868804]
mat_Sqrt:  [[0.15]]
grads:  [-0.00715189]
Stock Position:  -0.007151890078585027
Bond Position:  [-9.52140247]


portfolio before change:  [-10.25370416]
curr_Stock_Price:  102.05987946160639
curr_Factors:  [102.05987946]
mat_Sqrt:  [[0.15]]
grads:  [-0.1233363]
Stock Position:  -0.12333629982362848
Bond Position:  [2.33398373]


portfolio before change:  [-10.14980758]
curr_Stock_Price:  101.22222652641825
curr_Factors:  [101.22222653]
mat_Sqrt:  [[0.15]]
grads:  [-0.01687212]
Stock Position:  -0.016872121787465628
Bond Position:  [-8.44197384]


portfolio before change:  [-10.15732673]
curr_Stock_Price:  101.54277883851955
curr_Factors:  [101.54277884]
mat_Sqrt:  [[0.15]]
grads:  [0.06755856]
Stock Position:  0.06755855533520927
Bond Position:  [-17.01741018]


portfolio before change:  [-10.178728]
curr_Stock_Price:  101.28897855314149
curr_Factors:  [101.28897855]
mat_Sqrt:  [[0.15]]
grads:  [-0.14284808]
Stock Position:  -0.14284808358500334
Bond Position:  [4.29020848]


portfolio before change:  [-10.25144516]
curr_Stock_Price:  101.80554023910996
curr_Factors:  [101.80554024]
mat_Sqrt:  [[0.15]]
grads:  [-0.14242578]
Stock Position:  -0.14242578183401017
Bond Position:  [4.24828851]


portfolio before change:  [-10.27941269]
curr_Stock_Price:  102.00936382593899
curr_Factors:  [102.00936383]
mat_Sqrt:  [[0.15]]
grads:  [0.02970686]
Stock Position:  0.029706860039612825
Bond Position:  [-13.30979058]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.27941269]
Stock Price:  103.46665090652937
PL:  [-13.74606359]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.69290560e-02]
 [-4.92169802e-03]
 [ 8.71959948e-03]
 [-2.57663452e-03]
 [ 5.34137619e-03]
 [-3.32253991e-02]
 [-1.31136448e-02]
 [ 1.58751320e-03]
 [ 2.18890655e-03]
 [ 4.34255799e-02]
 [-1.27141898e-02]
 [-2.03918004e-02]
 [-1.43455022e-03]
 [-2.28065244e-02]
 [ 7.01101861e-03]
 [ 7.24312492e-03]
 [-3.54561920e-02]
 [-1.37372697e-02]
 [ 4.68558256e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.31610878]
curr_Stock_Price:  99.40591853457025
curr_Factors:  [99.40591853]
mat_Sqrt:  [[0.15]]
grads:  [0.11286037]
Stock Position:  0.11286037326890172
Bond Position:  [-18.53509785]


portfolio before change:  [-7.23134965]
curr_Stock_Price:  100.19799008988436
curr_Factors:  [100.19799009]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281132]
Stock Position:  -0.03281132011337166
Bond Position:  [-3.94372132]


portfolio before change:  [-7.30118823]
curr_Stock_Price:  102.29642840808228
curr_Factors:  [102.29642841]
mat_Sqrt:  [[0.15]]
grads:  [0.05813066]
Stock Position:  0.058130663181873946
Bond Position:  [-13.24774746]


portfolio before change:  [-7.24352496]
curr_Stock_Price:  103.34536918700624
curr_Factors:  [103.34536919]
mat_Sqrt:  [[0.15]]
grads:  [-0.01717756]
Stock Position:  -0.017177563465252555
Bond Position:  [-5.46830332]


portfolio before change:  [-7.24563163]
curr_Stock_Price:  103.38841526407917
curr_Factors:  [103.38841526]
mat_Sqrt:  [[0.15]]
grads:  [0.03560917]
Stock Position:  0.03560917457300178
Bond Position:  [-10.92720776]


portfolio before change:  [-7.21806252]
curr_Stock_Price:  104.23935490106258
curr_Factors:  [104.2393549]
mat_Sqrt:  [[0.15]]
grads:  [-0.22150266]
Stock Position:  -0.22150266054740206
Bond Position:  [15.87123193]


portfolio before change:  [-7.78418871]
curr_Stock_Price:  106.81311404426191
curr_Factors:  [106.81311404]
mat_Sqrt:  [[0.15]]
grads:  [-0.0874243]
Stock Position:  -0.08742429896032265
Bond Position:  [1.5538729]


portfolio before change:  [-7.69212906]
curr_Stock_Price:  105.76453679978955
curr_Factors:  [105.7645368]
mat_Sqrt:  [[0.15]]
grads:  [0.01058342]
Stock Position:  0.010583421302380231
Bond Position:  [-8.81147972]


portfolio before change:  [-7.71036539]
curr_Stock_Price:  104.24960338225686
curr_Factors:  [104.24960338]
mat_Sqrt:  [[0.15]]
grads:  [0.01459271]
Stock Position:  0.01459271033063716
Bond Position:  [-9.23164965]


portfolio before change:  [-7.72937438]
curr_Stock_Price:  103.10514213288968
curr_Factors:  [103.10514213]
mat_Sqrt:  [[0.15]]
grads:  [0.28950387]
Stock Position:  0.2895038660777193
Bond Position:  [-37.57871164]


portfolio before change:  [-7.2902324]
curr_Stock_Price:  104.65447491758596
curr_Factors:  [104.65447492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08476127]
Stock Position:  -0.08476126508103296
Bond Position:  [1.58041329]


portfolio before change:  [-7.18454009]
curr_Stock_Price:  103.41219569162183
curr_Factors:  [103.41219569]
mat_Sqrt:  [[0.15]]
grads:  [-0.13594534]
Stock Position:  -0.13594533597891845
Bond Position:  [6.8738656]


portfolio before change:  [-7.31477525]
curr_Stock_Price:  104.38283465161948
curr_Factors:  [104.38283465]
mat_Sqrt:  [[0.15]]
grads:  [-0.00956367]
Stock Position:  -0.009563668138718263
Bond Position:  [-6.31649246]


portfolio before change:  [-7.32621611]
curr_Stock_Price:  105.41398072176113
curr_Factors:  [105.41398072]
mat_Sqrt:  [[0.15]]
grads:  [-0.1520435]
Stock Position:  -0.15204349626066718
Bond Position:  [8.70129408]


portfolio before change:  [-7.17438718]
curr_Stock_Price:  104.4297009633362
curr_Factors:  [104.42970096]
mat_Sqrt:  [[0.15]]
grads:  [0.04674012]
Stock Position:  0.04674012404857692
Bond Position:  [-12.05544435]


portfolio before change:  [-7.13545788]
curr_Stock_Price:  105.32707846165177
curr_Factors:  [105.32707846]
mat_Sqrt:  [[0.15]]
grads:  [0.0482875]
Stock Position:  0.04828749947350864
Bond Position:  [-12.22143912]


portfolio before change:  [-7.12043574]
curr_Stock_Price:  105.70145851416318
curr_Factors:  [105.70145851]
mat_Sqrt:  [[0.15]]
grads:  [-0.23637461]
Stock Position:  -0.23637461346128172
Bond Position:  [17.86470565]


portfolio before change:  [-7.18075952]
curr_Stock_Price:  105.97555949025842
curr_Factors:  [105.97555949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0915818]
Stock Position:  -0.09158179827128672
Bond Position:  [2.52467279]


portfolio before change:  [-6.91778635]
curr_Stock_Price:  103.11099549793009
curr_Factors:  [103.1109955]
mat_Sqrt:  [[0.15]]
grads:  [0.03123722]
Stock Position:  0.031237217095355166
Bond Position:  [-10.1386869]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.91778635]
Stock Price:  102.37072739983547
PL:  [-9.28851375]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.00072029e-03]
 [-7.81148480e-03]
 [ 3.75009324e-03]
 [ 2.35076718e-03]
 [ 8.71745831e-03]
 [ 1.25225193e-03]
 [-1.58299596e-02]
 [ 1.64784452e-03]
 [-3.00736832e-04]
 [-2.95617459e-02]
 [-4.91743032e-03]
 [-2.41139945e-02]
 [ 1.23897424e-03]
 [-3.00877269e-03]
 [-1.85004170e-03]
 [ 9.16113391e-03]
 [-4.59126519e-02]
 [-2.51144668e-02]
 [ 4.60792864e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.70841455]
curr_Stock_Price:  100.84619016749453
curr_Factors:  [100.84619017]
mat_Sqrt:  [[0.15]]
grads:  [0.0400048]
Stock Position:  0.040004801934980516
Bond Position:  [10.67408269]


portfolio before change:  [14.72810925]
curr_Stock_Price:  101.27178525081959
curr_Factors:  [101.27178525]
mat_Sqrt:  [[0.15]]
grads:  [-0.05207657]
Stock Position:  -0.05207656535021599
Bond Position:  [20.00199599]


portfolio before change:  [14.69586776]
curr_Stock_Price:  101.98693642150167
curr_Factors:  [101.98693642]
mat_Sqrt:  [[0.15]]
grads:  [0.02500062]
Stock Position:  0.025000621617030674
Bond Position:  [12.14613095]


portfolio before change:  [14.66960472]
curr_Stock_Price:  100.8149677658623
curr_Factors:  [100.81496777]
mat_Sqrt:  [[0.15]]
grads:  [0.01567178]
Stock Position:  0.01567178118638934
Bond Position:  [13.08965461]


portfolio before change:  [14.62461147]
curr_Stock_Price:  97.73515969251791
curr_Factors:  [97.73515969]
mat_Sqrt:  [[0.15]]
grads:  [0.05811639]
Stock Position:  0.05811638871007617
Bond Position:  [8.94459694]


portfolio before change:  [14.72063829]
curr_Stock_Price:  99.34899698789894
curr_Factors:  [99.34899699]
mat_Sqrt:  [[0.15]]
grads:  [0.00834835]
Stock Position:  0.008348346203022005
Bond Position:  [13.89123847]


portfolio before change:  [14.72296309]
curr_Stock_Price:  99.21143165022832
curr_Factors:  [99.21143165]
mat_Sqrt:  [[0.15]]
grads:  [-0.10553306]
Stock Position:  -0.10553306422908415
Bond Position:  [25.19304948]


portfolio before change:  [14.79857907]
curr_Stock_Price:  98.55460501779342
curr_Factors:  [98.55460502]
mat_Sqrt:  [[0.15]]
grads:  [0.01098563]
Stock Position:  0.010985630125667806
Bond Position:  [13.71589463]


portfolio before change:  [14.81238365]
curr_Stock_Price:  99.499036289488
curr_Factors:  [99.49903629]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200491]
Stock Position:  -0.0020049122151822706
Bond Position:  [15.01187048]


portfolio before change:  [14.81624548]
curr_Stock_Price:  99.44497043655589
curr_Factors:  [99.44497044]
mat_Sqrt:  [[0.15]]
grads:  [-0.19707831]
Stock Position:  -0.19707830606341536
Bond Position:  [34.4146918]


portfolio before change:  [14.54386276]
curr_Stock_Price:  100.8707360189859
curr_Factors:  [100.87073602]
mat_Sqrt:  [[0.15]]
grads:  [-0.03278287]
Stock Position:  -0.03278286881251117
Bond Position:  [17.85069487]


portfolio before change:  [14.57334611]
curr_Stock_Price:  100.10752899722259
curr_Factors:  [100.107529]
mat_Sqrt:  [[0.15]]
grads:  [-0.16075996]
Stock Position:  -0.16075996332058745
Bond Position:  [30.6666288]


portfolio before change:  [14.59489459]
curr_Stock_Price:  100.02118371164815
curr_Factors:  [100.02118371]
mat_Sqrt:  [[0.15]]
grads:  [0.00825983]
Stock Position:  0.008259828295628886
Bond Position:  [13.76873679]


portfolio before change:  [14.60043485]
curr_Stock_Price:  100.27514091157718
curr_Factors:  [100.27514091]
mat_Sqrt:  [[0.15]]
grads:  [-0.02005848]
Stock Position:  -0.020058484579298486
Bond Position:  [16.61180222]


portfolio before change:  [14.58089538]
curr_Stock_Price:  101.45633364880551
curr_Factors:  [101.45633365]
mat_Sqrt:  [[0.15]]
grads:  [-0.01233361]
Stock Position:  -0.012333611341009817
Bond Position:  [15.83221837]


portfolio before change:  [14.57879953]
curr_Stock_Price:  101.94722024178084
curr_Factors:  [101.94722024]
mat_Sqrt:  [[0.15]]
grads:  [0.06107423]
Stock Position:  0.06107422606342418
Bond Position:  [8.35245195]


portfolio before change:  [14.69975124]
curr_Stock_Price:  103.89343139240063
curr_Factors:  [103.89343139]
mat_Sqrt:  [[0.15]]
grads:  [-0.30608435]
Stock Position:  -0.30608434607595625
Bond Position:  [46.49990425]


portfolio before change:  [14.83884509]
curr_Stock_Price:  103.47698599676175
curr_Factors:  [103.476986]
mat_Sqrt:  [[0.15]]
grads:  [-0.16742978]
Stock Position:  -0.16742977855441035
Bond Position:  [32.16397394]


portfolio before change:  [14.76469727]
curr_Stock_Price:  103.96787723181691
curr_Factors:  [103.96787723]
mat_Sqrt:  [[0.15]]
grads:  [0.03071952]
Stock Position:  0.03071952429694425
Bond Position:  [11.57085354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.76469727]
Stock Price:  104.2013876503353
PL:  [10.56330962]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.00688401e-02]
 [-8.01260278e-03]
 [-5.63232832e-03]
 [ 3.88916657e-03]
 [ 7.72631269e-03]
 [ 4.96560658e-03]
 [-1.28164965e-02]
 [ 2.63645964e-03]
 [-2.53756761e-05]
 [-3.73723534e-02]
 [-1.35154666e-03]
 [-2.40957168e-02]
 [ 2.44438338e-03]
 [ 2.59130808e-03]
 [-2.15385269e-03]
 [ 1.20020101e-02]
 [ 4.73922937e-02]
 [ 1.93326800e-02]
 [ 3.89406057e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.21830214]
curr_Stock_Price:  101.53347373451797
curr_Factors:  [101.53347373]
mat_Sqrt:  [[0.15]]
grads:  [-0.2671256]
Stock Position:  -0.2671256004459451
Bond Position:  [52.34049227]


portfolio before change:  [25.42903278]
curr_Stock_Price:  100.79358253784544
curr_Factors:  [100.79358254]
mat_Sqrt:  [[0.15]]
grads:  [-0.05341735]
Stock Position:  -0.05341735189452887
Bond Position:  [30.81315904]


portfolio before change:  [25.4056127]
curr_Stock_Price:  101.37624577199722
curr_Factors:  [101.37624577]
mat_Sqrt:  [[0.15]]
grads:  [-0.03754886]
Stock Position:  -0.03754885543556507
Bond Position:  [29.2121747]


portfolio before change:  [25.50310237]
curr_Stock_Price:  98.97442261098732
curr_Factors:  [98.97442261]
mat_Sqrt:  [[0.15]]
grads:  [0.02592778]
Stock Position:  0.025927777123139237
Bond Position:  [22.9369156]


portfolio before change:  [25.53045735]
curr_Stock_Price:  99.80827877309723
curr_Factors:  [99.80827877]
mat_Sqrt:  [[0.15]]
grads:  [0.05150875]
Stock Position:  0.05150875125353396
Bond Position:  [20.38945755]


portfolio before change:  [25.48829326]
curr_Stock_Price:  98.8907242066174
curr_Factors:  [98.89072421]
mat_Sqrt:  [[0.15]]
grads:  [0.03310404]
Stock Position:  0.03310404388746635
Bond Position:  [22.21461039]


portfolio before change:  [25.46515255]
curr_Stock_Price:  98.0239099322879
curr_Factors:  [98.02390993]
mat_Sqrt:  [[0.15]]
grads:  [-0.08544331]
Stock Position:  -0.08544330975890052
Bond Position:  [33.84063985]


portfolio before change:  [25.45369629]
curr_Stock_Price:  98.25701750437321
curr_Factors:  [98.2570175]
mat_Sqrt:  [[0.15]]
grads:  [0.0175764]
Stock Position:  0.017576397609336627
Bond Position:  [23.72669188]


portfolio before change:  [25.47585685]
curr_Stock_Price:  99.18030974966554
curr_Factors:  [99.18030975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00016917]
Stock Position:  -0.00016917117389905208
Bond Position:  [25.4926353]


portfolio before change:  [25.48226368]
curr_Stock_Price:  98.98600904313795
curr_Factors:  [98.98600904]
mat_Sqrt:  [[0.15]]
grads:  [-0.24914902]
Stock Position:  -0.24914902233897707
Bond Position:  [50.14453106]


portfolio before change:  [25.28548837]
curr_Stock_Price:  99.82612075400316
curr_Factors:  [99.82612075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00901031]
Stock Position:  -0.009010311094858777
Bond Position:  [26.18495277]


portfolio before change:  [25.28941777]
curr_Stock_Price:  100.11663798302692
curr_Factors:  [100.11663798]
mat_Sqrt:  [[0.15]]
grads:  [-0.16063811]
Stock Position:  -0.16063811227875957
Bond Position:  [41.37196551]


portfolio before change:  [25.5514642]
curr_Stock_Price:  98.54974865871728
curr_Factors:  [98.54974866]
mat_Sqrt:  [[0.15]]
grads:  [0.01629589]
Stock Position:  0.016295889213936553
Bond Position:  [23.94550841]


portfolio before change:  [25.56557624]
curr_Stock_Price:  99.04833547890128
curr_Factors:  [99.04833548]
mat_Sqrt:  [[0.15]]
grads:  [0.01727539]
Stock Position:  0.01727538719334131
Bond Position:  [23.8544779]


portfolio before change:  [25.55087881]
curr_Stock_Price:  97.85231063184897
curr_Factors:  [97.85231063]
mat_Sqrt:  [[0.15]]
grads:  [-0.01435902]
Stock Position:  -0.014359017916349462
Bond Position:  [26.9559419]


portfolio before change:  [25.56062911]
curr_Stock_Price:  97.64265365498913
curr_Factors:  [97.64265365]
mat_Sqrt:  [[0.15]]
grads:  [0.0800134]
Stock Position:  0.08001340037683108
Bond Position:  [17.74790837]


portfolio before change:  [25.47470135]
curr_Stock_Price:  96.51327670640234
curr_Factors:  [96.51327671]
mat_Sqrt:  [[0.15]]
grads:  [0.31594862]
Stock Position:  0.31594862467829576
Bond Position:  [-5.01853569]


portfolio before change:  [26.27046825]
curr_Stock_Price:  99.03590738173854
curr_Factors:  [99.03590738]
mat_Sqrt:  [[0.15]]
grads:  [0.12888453]
Stock Position:  0.12888453329534658
Bond Position:  [13.50627155]


portfolio before change:  [26.52262824]
curr_Stock_Price:  100.96618551439165
curr_Factors:  [100.96618551]
mat_Sqrt:  [[0.15]]
grads:  [0.0259604]
Stock Position:  0.02596040377868345
Bond Position:  [23.9015053]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.52262824]
Stock Price:  101.78268060220557
PL:  [24.73994764]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.29054736e-02]
 [-2.99365064e-03]
 [-4.52749213e-03]
 [ 2.28282712e-03]
 [ 5.93662181e-03]
 [ 3.45025599e-03]
 [-5.30401918e-03]
 [-2.35761139e-03]
 [ 3.11139013e-04]
 [ 3.38809579e-02]
 [-9.43370642e-03]
 [-2.04658779e-02]
 [-1.35730293e-03]
 [-2.21553283e-02]
 [ 1.19989550e-02]
 [ 7.98086110e-03]
 [-4.74335466e-02]
 [-2.62365157e-02]
 [ 4.55404918e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.10765116]
curr_Stock_Price:  101.26466183331956
curr_Factors:  [101.26466183]
mat_Sqrt:  [[0.15]]
grads:  [-0.21936982]
Stock Position:  -0.2193698242543429
Bond Position:  [43.32206223]


portfolio before change:  [21.3875772]
curr_Stock_Price:  100.03799282930929
curr_Factors:  [100.03799283]
mat_Sqrt:  [[0.15]]
grads:  [-0.01995767]
Stock Position:  -0.019957670918347277
Bond Position:  [23.38410254]


portfolio before change:  [21.36528034]
curr_Stock_Price:  101.4481582438528
curr_Factors:  [101.44815824]
mat_Sqrt:  [[0.15]]
grads:  [-0.03018328]
Stock Position:  -0.03018328088194061
Bond Position:  [24.42731859]


portfolio before change:  [21.38417566]
curr_Stock_Price:  101.02448899551356
curr_Factors:  [101.024489]
mat_Sqrt:  [[0.15]]
grads:  [0.01521885]
Stock Position:  0.015218847476749188
Bond Position:  [19.84669937]


portfolio before change:  [21.40750576]
curr_Stock_Price:  102.2314007190432
curr_Factors:  [102.23140072]
mat_Sqrt:  [[0.15]]
grads:  [0.03957748]
Stock Position:  0.039577478707125344
Bond Position:  [17.36144467]


portfolio before change:  [21.38964413]
curr_Stock_Price:  101.67041168483617
curr_Factors:  [101.67041168]
mat_Sqrt:  [[0.15]]
grads:  [0.02300171]
Stock Position:  0.023001706629576422
Bond Position:  [19.05105115]


portfolio before change:  [21.36485497]
curr_Stock_Price:  100.38561505807577
curr_Factors:  [100.38561506]
mat_Sqrt:  [[0.15]]
grads:  [-0.03536013]
Stock Position:  -0.03536012786565517
Bond Position:  [24.91450316]


portfolio before change:  [21.36559203]
curr_Stock_Price:  100.54094114741514
curr_Factors:  [100.54094115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01571741]
Stock Position:  -0.01571740929040862
Bond Position:  [22.94583515]


portfolio before change:  [21.33267368]
curr_Stock_Price:  103.00034930330368
curr_Factors:  [103.0003493]
mat_Sqrt:  [[0.15]]
grads:  [0.00207426]
Stock Position:  0.0020742600834937025
Bond Position:  [21.11902416]


portfolio before change:  [21.33676851]
curr_Stock_Price:  102.42877770021022
curr_Factors:  [102.4287777]
mat_Sqrt:  [[0.15]]
grads:  [0.22587305]
Stock Position:  0.22587305249037665
Bond Position:  [-1.79913218]


portfolio before change:  [21.4078802]
curr_Stock_Price:  102.74559961780214
curr_Factors:  [102.74559962]
mat_Sqrt:  [[0.15]]
grads:  [-0.06289138]
Stock Position:  -0.06289137612661508
Bond Position:  [27.86969235]


portfolio before change:  [21.37758388]
curr_Stock_Price:  103.33812311563548
curr_Factors:  [103.33812312]
mat_Sqrt:  [[0.15]]
grads:  [-0.13643919]
Stock Position:  -0.1364391860051564
Bond Position:  [35.47695328]


portfolio before change:  [21.26617695]
curr_Stock_Price:  104.21966801695015
curr_Factors:  [104.21966802]
mat_Sqrt:  [[0.15]]
grads:  [-0.00904869]
Stock Position:  -0.009048686190490169
Bond Position:  [22.20922802]


portfolio before change:  [21.26487135]
curr_Stock_Price:  104.97763538162043
curr_Factors:  [104.97763538]
mat_Sqrt:  [[0.15]]
grads:  [-0.14770219]
Stock Position:  -0.14770218844664448
Bond Position:  [36.77029783]


portfolio before change:  [21.14148463]
curr_Stock_Price:  105.87525541475796
curr_Factors:  [105.87525541]
mat_Sqrt:  [[0.15]]
grads:  [0.07999303]
Stock Position:  0.07999303359348872
Bond Position:  [12.67220176]


portfolio before change:  [21.02378075]
curr_Stock_Price:  104.36421981769152
curr_Factors:  [104.36421982]
mat_Sqrt:  [[0.15]]
grads:  [0.05320574]
Stock Position:  0.05320574067208632
Bond Position:  [15.47100514]


portfolio before change:  [21.01863815]
curr_Stock_Price:  104.19486140763986
curr_Factors:  [104.19486141]
mat_Sqrt:  [[0.15]]
grads:  [-0.31622364]
Stock Position:  -0.316223644186286
Bond Position:  [53.96751693]


portfolio before change:  [21.40938625]
curr_Stock_Price:  103.00186226794592
curr_Factors:  [103.00186227]
mat_Sqrt:  [[0.15]]
grads:  [-0.1749101]
Stock Position:  -0.17491010443616797
Bond Position:  [39.42545273]


portfolio before change:  [21.54247867]
curr_Stock_Price:  102.29730131970331
curr_Factors:  [102.29730132]
mat_Sqrt:  [[0.15]]
grads:  [0.03036033]
Stock Position:  0.0303603278925812
Bond Position:  [18.43669906]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.54247867]
Stock Price:  101.27034009482014
PL:  [20.27213858]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.28587726e-02]
 [ 8.20605758e-03]
 [ 9.79396283e-03]
 [ 1.95207597e-03]
 [ 8.94200887e-03]
 [ 1.79350918e-02]
 [-1.20855246e-02]
 [ 1.70940394e-03]
 [ 1.50707982e-04]
 [-3.25056296e-02]
 [-1.06942749e-03]
 [-2.32423762e-02]
 [-4.81969752e-04]
 [-1.97500147e-02]
 [ 4.16026996e-04]
 [ 8.62831648e-03]
 [-4.59018996e-02]
 [-2.39643274e-02]
 [ 4.67362788e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.211618]
curr_Stock_Price:  98.62802362951474
curr_Factors:  [98.62802363]
mat_Sqrt:  [[0.15]]
grads:  [0.55239182]
Stock Position:  0.5523918175782477
Bond Position:  [-73.69293124]


portfolio before change:  [-19.3250395]
curr_Stock_Price:  98.4560515712708
curr_Factors:  [98.45605157]
mat_Sqrt:  [[0.15]]
grads:  [0.05470705]
Stock Position:  0.05470705052188964
Bond Position:  [-24.71127968]


portfolio before change:  [-19.34414662]
curr_Stock_Price:  98.21972856385722
curr_Factors:  [98.21972856]
mat_Sqrt:  [[0.15]]
grads:  [0.06529309]
Stock Position:  0.06529308550711056
Bond Position:  [-25.75721576]


portfolio before change:  [-19.37501587]
curr_Stock_Price:  97.84558263266447
curr_Factors:  [97.84558263]
mat_Sqrt:  [[0.15]]
grads:  [0.01301384]
Stock Position:  0.013013839818045795
Bond Position:  [-20.64836261]


portfolio before change:  [-19.39508673]
curr_Stock_Price:  96.70002387920474
curr_Factors:  [96.70002388]
mat_Sqrt:  [[0.15]]
grads:  [0.05961339]
Stock Position:  0.05961339247590957
Bond Position:  [-25.1597032]


portfolio before change:  [-19.33162501]
curr_Stock_Price:  97.87010367427268
curr_Factors:  [97.87010367]
mat_Sqrt:  [[0.15]]
grads:  [0.11956728]
Stock Position:  0.11956727890966228
Bond Position:  [-31.033687]


portfolio before change:  [-19.34587431]
curr_Stock_Price:  97.8158254461042
curr_Factors:  [97.81582545]
mat_Sqrt:  [[0.15]]
grads:  [-0.08057016]
Stock Position:  -0.08057016424099422
Bond Position:  [-11.46483718]


portfolio before change:  [-19.40677148]
curr_Stock_Price:  98.53607473789825
curr_Factors:  [98.53607474]
mat_Sqrt:  [[0.15]]
grads:  [0.01139603]
Stock Position:  0.011396026263572516
Bond Position:  [-20.52969117]


portfolio before change:  [-19.40663575]
curr_Stock_Price:  98.9984103663053
curr_Factors:  [98.99841037]
mat_Sqrt:  [[0.15]]
grads:  [0.00100472]
Stock Position:  0.0010047198783460273
Bond Position:  [-19.50610142]


portfolio before change:  [-19.41126987]
curr_Stock_Price:  99.24028172896294
curr_Factors:  [99.24028173]
mat_Sqrt:  [[0.15]]
grads:  [-0.2167042]
Stock Position:  -0.2167041970794623
Bond Position:  [2.0945157]


portfolio before change:  [-19.43041484]
curr_Stock_Price:  99.33104445899464
curr_Factors:  [99.33104446]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712952]
Stock Position:  -0.007129516624207929
Bond Position:  [-18.72223251]


portfolio before change:  [-19.44394503]
curr_Stock_Price:  100.57222822128087
curr_Factors:  [100.57222822]
mat_Sqrt:  [[0.15]]
grads:  [-0.15494917]
Stock Position:  -0.1549491744317268
Bond Position:  [-3.86036129]


portfolio before change:  [-19.73270975]
curr_Stock_Price:  102.42960833132177
curr_Factors:  [102.42960833]
mat_Sqrt:  [[0.15]]
grads:  [-0.00321313]
Stock Position:  -0.0032131316781276445
Bond Position:  [-19.40358993]


portfolio before change:  [-19.7382582]
curr_Stock_Price:  102.64651289474499
curr_Factors:  [102.64651289]
mat_Sqrt:  [[0.15]]
grads:  [-0.13166676]
Stock Position:  -0.1316667647272426
Bond Position:  [-6.22312394]


portfolio before change:  [-19.71805415]
curr_Stock_Price:  102.48124702204741
curr_Factors:  [102.48124702]
mat_Sqrt:  [[0.15]]
grads:  [0.00277351]
Stock Position:  0.002773513305239799
Bond Position:  [-20.00228726]


portfolio before change:  [-19.72171378]
curr_Stock_Price:  102.96495406406967
curr_Factors:  [102.96495406]
mat_Sqrt:  [[0.15]]
grads:  [0.05752211]
Stock Position:  0.057522109855103476
Bond Position:  [-25.64447518]


portfolio before change:  [-19.67484031]
curr_Stock_Price:  103.89130035860796
curr_Factors:  [103.89130036]
mat_Sqrt:  [[0.15]]
grads:  [-0.30601266]
Stock Position:  -0.30601266380871517
Bond Position:  [12.11721326]


portfolio before change:  [-19.07138623]
curr_Stock_Price:  101.92921033419329
curr_Factors:  [101.92921033]
mat_Sqrt:  [[0.15]]
grads:  [-0.15976218]
Stock Position:  -0.15976218269377768
Bond Position:  [-2.78695311]


portfolio before change:  [-19.24731039]
curr_Stock_Price:  103.02601142640617
curr_Factors:  [103.02601143]
mat_Sqrt:  [[0.15]]
grads:  [0.03115752]
Stock Position:  0.0311575192075399
Bond Position:  [-22.45734532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.24731039]
Stock Price:  103.9519320365498
PL:  [-23.19924243]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 5.23843409e-02]
 [-4.95158428e-04]
 [-1.99029272e-03]
 [ 3.90810992e-03]
 [ 8.21818647e-03]
 [ 9.91168812e-03]
 [-7.23103291e-03]
 [-4.90687049e-04]
 [-8.63991184e-04]
 [ 1.87641151e-03]
 [-2.98288658e-03]
 [-2.14745993e-02]
 [-1.88873966e-03]
 [-2.41431137e-02]
 [ 1.33894941e-02]
 [ 7.44963982e-03]
 [-4.73349383e-02]
 [-1.90978125e-02]
 [ 4.51492027e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.66070141]
curr_Stock_Price:  98.86023226159821
curr_Factors:  [98.86023226]
mat_Sqrt:  [[0.15]]
grads:  [0.34922894]
Stock Position:  0.3492289393092673
Bond Position:  [-50.18555546]


portfolio before change:  [-15.33125411]
curr_Stock_Price:  99.83951898292017
curr_Factors:  [99.83951898]
mat_Sqrt:  [[0.15]]
grads:  [-0.00330106]
Stock Position:  -0.0033010561867454456
Bond Position:  [-15.00167824]


portfolio before change:  [-15.33445375]
curr_Stock_Price:  99.67252797437078
curr_Factors:  [99.67252797]
mat_Sqrt:  [[0.15]]
grads:  [-0.01326862]
Stock Position:  -0.013268618101898907
Bond Position:  [-14.01193704]


portfolio before change:  [-15.33170776]
curr_Stock_Price:  99.20153645900182
curr_Factors:  [99.20153646]
mat_Sqrt:  [[0.15]]
grads:  [0.02605407]
Stock Position:  0.026054066159760872
Bond Position:  [-17.91631116]


portfolio before change:  [-15.33570505]
curr_Stock_Price:  99.22005001065577
curr_Factors:  [99.22005001]
mat_Sqrt:  [[0.15]]
grads:  [0.05478791]
Stock Position:  0.05478790981480177
Bond Position:  [-20.7717642]


portfolio before change:  [-15.26725859]
curr_Stock_Price:  100.56414301053084
curr_Factors:  [100.56414301]
mat_Sqrt:  [[0.15]]
grads:  [0.06607792]
Stock Position:  0.06607792081825857
Bond Position:  [-21.91232807]


portfolio before change:  [-15.29395577]
curr_Stock_Price:  100.24303111344622
curr_Factors:  [100.24303111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04820689]
Stock Position:  -0.04820688604389924
Bond Position:  [-10.46155139]


portfolio before change:  [-15.3597338]
curr_Stock_Price:  101.55326555108665
curr_Factors:  [101.55326555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327125]
Stock Position:  -0.0032712469942684057
Bond Position:  [-15.02752799]


portfolio before change:  [-15.36368571]
curr_Stock_Price:  101.61273993622196
curr_Factors:  [101.61273994]
mat_Sqrt:  [[0.15]]
grads:  [-0.00575994]
Stock Position:  -0.005759941229704602
Bond Position:  [-14.7784023]


portfolio before change:  [-15.36287653]
curr_Stock_Price:  100.83074472776902
curr_Factors:  [100.83074473]
mat_Sqrt:  [[0.15]]
grads:  [0.01250941]
Stock Position:  0.012509410049150595
Bond Position:  [-16.62420966]


portfolio before change:  [-15.37302675]
curr_Stock_Price:  100.35161281872695
curr_Factors:  [100.35161282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01988591]
Stock Position:  -0.01988591050617507
Bond Position:  [-13.37744356]


portfolio before change:  [-15.41624599]
curr_Stock_Price:  102.35677425014285
curr_Factors:  [102.35677425]
mat_Sqrt:  [[0.15]]
grads:  [-0.143164]
Stock Position:  -0.1431639953253301
Bond Position:  [-0.76244124]


portfolio before change:  [-15.83284769]
curr_Stock_Price:  105.26540403276564
curr_Factors:  [105.26540403]
mat_Sqrt:  [[0.15]]
grads:  [-0.0125916]
Stock Position:  -0.012591597757106885
Bond Position:  [-14.50738806]


portfolio before change:  [-15.84995893]
curr_Stock_Price:  106.33627176708991
curr_Factors:  [106.33627177]
mat_Sqrt:  [[0.15]]
grads:  [-0.16095409]
Stock Position:  -0.16095409139139674
Bond Position:  [1.26529908]


portfolio before change:  [-15.84384978]
curr_Stock_Price:  106.30028149879166
curr_Factors:  [106.3002815]
mat_Sqrt:  [[0.15]]
grads:  [0.08926329]
Stock Position:  0.08926329429542215
Bond Position:  [-25.33256309]


portfolio before change:  [-15.96077841]
curr_Stock_Price:  105.06130977632735
curr_Factors:  [105.06130978]
mat_Sqrt:  [[0.15]]
grads:  [0.04966427]
Stock Position:  0.049664265446969794
Bond Position:  [-21.17857119]


portfolio before change:  [-15.96864919]
curr_Stock_Price:  105.00945207974536
curr_Factors:  [105.00945208]
mat_Sqrt:  [[0.15]]
grads:  [-0.31556626]
Stock Position:  -0.315566255184774
Bond Position:  [17.16879036]


portfolio before change:  [-15.9413433]
curr_Stock_Price:  104.93652553876308
curr_Factors:  [104.93652554]
mat_Sqrt:  [[0.15]]
grads:  [-0.12731875]
Stock Position:  -0.1273187500671805
Bond Position:  [-2.58095603]


portfolio before change:  [-16.00819068]
curr_Stock_Price:  105.45649656199889
curr_Factors:  [105.45649656]
mat_Sqrt:  [[0.15]]
grads:  [0.03009947]
Stock Position:  0.030099468434070187
Bond Position:  [-19.18237517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.00819068]
Stock Price:  104.99453540723825
PL:  [-21.00272609]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 5.27587403e-02]
 [ 8.86161960e-03]
 [ 4.98959211e-03]
 [ 2.84082292e-03]
 [ 7.74761041e-03]
 [ 9.92973332e-03]
 [-1.46767014e-02]
 [-1.91808028e-03]
 [-1.28106736e-03]
 [-3.07366018e-04]
 [-4.34333890e-03]
 [-2.24513536e-02]
 [-5.50901886e-04]
 [-1.98858940e-02]
 [ 5.48775863e-03]
 [ 8.75104307e-03]
 [-4.64454520e-02]
 [-2.28559894e-02]
 [ 4.51145280e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.70145727]
curr_Stock_Price:  98.85756707282012
curr_Factors:  [98.85756707]
mat_Sqrt:  [[0.15]]
grads:  [0.35172494]
Stock Position:  0.3517249350669687
Bond Position:  [-50.47212863]


portfolio before change:  [-16.0692744]
curr_Stock_Price:  97.84769407057375
curr_Factors:  [97.84769407]
mat_Sqrt:  [[0.15]]
grads:  [0.05907746]
Stock Position:  0.059077463971334614
Bond Position:  [-21.84986802]


portfolio before change:  [-16.01191202]
curr_Stock_Price:  98.9111373916644
curr_Factors:  [98.91113739]
mat_Sqrt:  [[0.15]]
grads:  [0.03326395]
Stock Position:  0.03326394737074344
Bond Position:  [-19.30208688]


portfolio before change:  [-15.97179895]
curr_Stock_Price:  100.26212533381765
curr_Factors:  [100.26212533]
mat_Sqrt:  [[0.15]]
grads:  [0.01893882]
Stock Position:  0.01893881946555405
Bond Position:  [-17.87064524]


portfolio before change:  [-15.98526522]
curr_Stock_Price:  99.78701388119774
curr_Factors:  [99.78701388]
mat_Sqrt:  [[0.15]]
grads:  [0.05165074]
Stock Position:  0.05165073603446117
Bond Position:  [-21.13933793]


portfolio before change:  [-15.95017565]
curr_Stock_Price:  100.56870776714183
curr_Factors:  [100.56870777]
mat_Sqrt:  [[0.15]]
grads:  [0.06619822]
Stock Position:  0.0661982221549584
Bond Position:  [-22.60764531]


portfolio before change:  [-16.01708102]
curr_Stock_Price:  99.64341472382515
curr_Factors:  [99.64341472]
mat_Sqrt:  [[0.15]]
grads:  [-0.09784468]
Stock Position:  -0.09784467623051471
Bond Position:  [-6.26750337]


portfolio before change:  [-16.12848004]
curr_Stock_Price:  100.76592795149138
curr_Factors:  [100.76592795]
mat_Sqrt:  [[0.15]]
grads:  [-0.0127872]
Stock Position:  -0.012787201863449959
Bond Position:  [-14.83996577]


portfolio before change:  [-16.13223926]
curr_Stock_Price:  100.76974142713625
curr_Factors:  [100.76974143]
mat_Sqrt:  [[0.15]]
grads:  [-0.00854045]
Stock Position:  -0.008540449046918475
Bond Position:  [-15.27162041]


portfolio before change:  [-16.13554032]
curr_Stock_Price:  100.70916891134975
curr_Factors:  [100.70916891]
mat_Sqrt:  [[0.15]]
grads:  [-0.00204911]
Stock Position:  -0.002049106786997602
Bond Position:  [-15.92917648]


portfolio before change:  [-16.13953855]
curr_Stock_Price:  100.71670374378377
curr_Factors:  [100.71670374]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895559]
Stock Position:  -0.028955592661163022
Bond Position:  [-13.2232267]


portfolio before change:  [-16.15718639]
curr_Stock_Price:  101.21200069991818
curr_Factors:  [101.2120007]
mat_Sqrt:  [[0.15]]
grads:  [-0.14967569]
Stock Position:  -0.14967569054851151
Bond Position:  [-1.00821029]


portfolio before change:  [-16.36473864]
curr_Stock_Price:  102.59699626811187
curr_Factors:  [102.59699627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00367268]
Stock Position:  -0.00367267923807129
Bond Position:  [-15.98793278]


portfolio before change:  [-16.37238569]
curr_Stock_Price:  103.59070262950559
curr_Factors:  [103.59070263]
mat_Sqrt:  [[0.15]]
grads:  [-0.13257263]
Stock Position:  -0.13257262634979905
Bond Position:  [-2.63909418]


portfolio before change:  [-16.42754733]
curr_Stock_Price:  104.00181149973457
curr_Factors:  [104.0018115]
mat_Sqrt:  [[0.15]]
grads:  [0.03658506]
Stock Position:  0.03658505750000891
Bond Position:  [-20.23245958]


portfolio before change:  [-16.48270773]
curr_Stock_Price:  102.63235479565033
curr_Factors:  [102.6323548]
mat_Sqrt:  [[0.15]]
grads:  [0.05834029]
Stock Position:  0.05834028716270143
Bond Position:  [-22.47030878]


portfolio before change:  [-16.40859388]
curr_Stock_Price:  103.99902841300025
curr_Factors:  [103.99902841]
mat_Sqrt:  [[0.15]]
grads:  [-0.30963635]
Stock Position:  -0.30963634692952985
Bond Position:  [15.79328537]


portfolio before change:  [-16.45217031]
curr_Stock_Price:  104.15251571124006
curr_Factors:  [104.15251571]
mat_Sqrt:  [[0.15]]
grads:  [-0.15237326]
Stock Position:  -0.15237326266975465
Bond Position:  [-0.58211167]


portfolio before change:  [-16.5372337]
curr_Stock_Price:  104.70981719022456
curr_Factors:  [104.70981719]
mat_Sqrt:  [[0.15]]
grads:  [0.03007635]
Stock Position:  0.030076351970932374
Bond Position:  [-19.68652301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.5372337]
Stock Price:  104.90019062887225
PL:  [-21.43742433]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 7.08128508e-02]
 [ 9.10828848e-03]
 [ 3.45160872e-02]
 [-4.36790331e-03]
 [ 8.90762328e-03]
 [ 2.13622601e-02]
 [-9.22002619e-03]
 [ 6.22874936e-03]
 [ 1.92831613e-03]
 [-3.72295288e-02]
 [-9.47582339e-04]
 [-2.63565424e-02]
 [ 2.55004463e-03]
 [ 2.69120677e-03]
 [-2.35811513e-03]
 [ 1.19941166e-02]
 [ 4.90054019e-02]
 [ 1.94674376e-02]
 [ 4.17656911e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.78547069]
curr_Stock_Price:  98.72128510360568
curr_Factors:  [98.7212851]
mat_Sqrt:  [[0.15]]
grads:  [0.47208567]
Stock Position:  0.47208567186700134
Bond Position:  [-64.3903749]


portfolio before change:  [-18.52670278]
curr_Stock_Price:  97.18526627484967
curr_Factors:  [97.18526627]
mat_Sqrt:  [[0.15]]
grads:  [0.06072192]
Stock Position:  0.06072192323261406
Bond Position:  [-24.42797906]


portfolio before change:  [-18.56717314]
curr_Stock_Price:  96.61936528225804
curr_Factors:  [96.61936528]
mat_Sqrt:  [[0.15]]
grads:  [0.23010725]
Stock Position:  0.23010724809782576
Bond Position:  [-40.79998939]


portfolio before change:  [-18.73848755]
curr_Stock_Price:  95.91919985093307
curr_Factors:  [95.91919985]
mat_Sqrt:  [[0.15]]
grads:  [-0.02911936]
Stock Position:  -0.02911935537695096
Bond Position:  [-15.94538228]


portfolio before change:  [-18.76982723]
curr_Stock_Price:  96.85853497291855
curr_Factors:  [96.85853497]
mat_Sqrt:  [[0.15]]
grads:  [0.05938416]
Stock Position:  0.05938415520949092
Bond Position:  [-24.5216895]


portfolio before change:  [-18.73030188]
curr_Stock_Price:  97.6273685299969
curr_Factors:  [97.62736853]
mat_Sqrt:  [[0.15]]
grads:  [0.14241507]
Stock Position:  0.14241506759197103
Bond Position:  [-32.63391017]


portfolio before change:  [-18.82779259]
curr_Stock_Price:  97.00010895767063
curr_Factors:  [97.00010896]
mat_Sqrt:  [[0.15]]
grads:  [-0.06146684]
Stock Position:  -0.06146684124755133
Bond Position:  [-12.8655023]


portfolio before change:  [-18.8098437]
curr_Stock_Price:  96.65576600566331
curr_Factors:  [96.65576601]
mat_Sqrt:  [[0.15]]
grads:  [0.041525]
Stock Position:  0.04152499573701371
Bond Position:  [-22.82347397]


portfolio before change:  [-18.76752271]
curr_Stock_Price:  97.81236027670478
curr_Factors:  [97.81236028]
mat_Sqrt:  [[0.15]]
grads:  [0.01285544]
Stock Position:  0.012855440845947218
Bond Position:  [-20.02494372]


portfolio before change:  [-18.77150535]
curr_Stock_Price:  97.89203278833885
curr_Factors:  [97.89203279]
mat_Sqrt:  [[0.15]]
grads:  [-0.24819686]
Stock Position:  -0.24819685897025628
Bond Position:  [5.52498971]


portfolio before change:  [-18.53881631]
curr_Stock_Price:  96.9600805576396
curr_Factors:  [96.96008056]
mat_Sqrt:  [[0.15]]
grads:  [-0.00631722]
Stock Position:  -0.00631721559602187
Bond Position:  [-17.92629858]


portfolio before change:  [-18.54123263]
curr_Stock_Price:  96.63306723088158
curr_Factors:  [96.63306723]
mat_Sqrt:  [[0.15]]
grads:  [-0.17571028]
Stock Position:  -0.17571028280476517
Bond Position:  [-1.56180906]


portfolio before change:  [-18.84903947]
curr_Stock_Price:  98.38263094934445
curr_Factors:  [98.38263095]
mat_Sqrt:  [[0.15]]
grads:  [0.0170003]
Stock Position:  0.017000297521459776
Bond Position:  [-20.52157346]


portfolio before change:  [-18.84304365]
curr_Stock_Price:  99.03714020683046
curr_Factors:  [99.03714021]
mat_Sqrt:  [[0.15]]
grads:  [0.01794138]
Stock Position:  0.017941378435557993
Bond Position:  [-20.61990646]


portfolio before change:  [-18.86145191]
curr_Stock_Price:  98.2984765740703
curr_Factors:  [98.29847657]
mat_Sqrt:  [[0.15]]
grads:  [-0.01572077]
Stock Position:  -0.01572076755643294
Bond Position:  [-17.31612441]


portfolio before change:  [-18.85971355]
curr_Stock_Price:  97.91249434030638
curr_Factors:  [97.91249434]
mat_Sqrt:  [[0.15]]
grads:  [0.07996078]
Stock Position:  0.07996077753947711
Bond Position:  [-26.68887273]


portfolio before change:  [-18.78821119]
curr_Stock_Price:  98.89016631598813
curr_Factors:  [98.89016632]
mat_Sqrt:  [[0.15]]
grads:  [0.32670268]
Stock Position:  0.32670267924841345
Bond Position:  [-51.09589348]


portfolio before change:  [-18.70067472]
curr_Stock_Price:  99.197210143911
curr_Factors:  [99.19721014]
mat_Sqrt:  [[0.15]]
grads:  [0.12978292]
Stock Position:  0.1297829170029607
Bond Position:  [-31.57477801]


portfolio before change:  [-18.95927916]
curr_Stock_Price:  97.2654477102102
curr_Factors:  [97.26544771]
mat_Sqrt:  [[0.15]]
grads:  [0.02784379]
Stock Position:  0.027843794096532138
Bond Position:  [-21.66751826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.95927916]
Stock Price:  97.301777319117
PL:  [-18.95927916]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.34069710e-02]
 [-7.49770002e-03]
 [-5.03218910e-03]
 [ 2.41653802e-03]
 [ 5.87917187e-03]
 [ 1.04053993e-02]
 [-2.96889337e-03]
 [-2.13572184e-05]
 [ 8.47504120e-04]
 [ 4.78569807e-02]
 [-1.16319689e-02]
 [-2.07949285e-02]
 [-6.83656390e-04]
 [-1.76716950e-02]
 [ 4.66311747e-03]
 [ 8.38438584e-03]
 [-1.23024829e-02]
 [ 1.82170108e-02]
 [ 3.88385779e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.68345496]
curr_Stock_Price:  98.9241383141265
curr_Factors:  [98.92413831]
mat_Sqrt:  [[0.15]]
grads:  [0.28937981]
Stock Position:  0.2893798069277046
Bond Position:  [-43.310103]


portfolio before change:  [-14.24597904]
curr_Stock_Price:  100.47333003430545
curr_Factors:  [100.47333003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04998467]
Stock Position:  -0.04998466680406814
Bond Position:  [-9.22385311]


portfolio before change:  [-14.22162823]
curr_Stock_Price:  99.94002535268197
curr_Factors:  [99.94002535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03354793]
Stock Position:  -0.03354792730763996
Bond Position:  [-10.86884753]


portfolio before change:  [-14.26822642]
curr_Stock_Price:  101.24802365029308
curr_Factors:  [101.24802365]
mat_Sqrt:  [[0.15]]
grads:  [0.01611025]
Stock Position:  0.01611025348191495
Bond Position:  [-15.89935774]


portfolio before change:  [-14.25461039]
curr_Stock_Price:  102.33995931064833
curr_Factors:  [102.33995931]
mat_Sqrt:  [[0.15]]
grads:  [0.03919448]
Stock Position:  0.039194479112358536
Bond Position:  [-18.26577179]


portfolio before change:  [-14.30715937]
curr_Stock_Price:  101.11575712354522
curr_Factors:  [101.11575712]
mat_Sqrt:  [[0.15]]
grads:  [0.06936933]
Stock Position:  0.06936932880245479
Bond Position:  [-21.32149157]


portfolio before change:  [-14.19986412]
curr_Stock_Price:  102.73933187926197
curr_Factors:  [102.73933188]
mat_Sqrt:  [[0.15]]
grads:  [-0.01979262]
Stock Position:  -0.019792622499495763
Bond Position:  [-12.16638331]


portfolio before change:  [-14.18958065]
curr_Stock_Price:  102.06607869991147
curr_Factors:  [102.0660787]
mat_Sqrt:  [[0.15]]
grads:  [-0.00014238]
Stock Position:  -0.00014238145585591583
Bond Position:  [-14.17504833]


portfolio before change:  [-14.19331649]
curr_Stock_Price:  103.4119929492043
curr_Factors:  [103.41199295]
mat_Sqrt:  [[0.15]]
grads:  [0.00565003]
Stock Position:  0.005650027464815898
Bond Position:  [-14.77759709]


portfolio before change:  [-14.19640026]
curr_Stock_Price:  103.52015057302687
curr_Factors:  [103.52015057]
mat_Sqrt:  [[0.15]]
grads:  [0.31904654]
Stock Position:  0.3190465378404097
Bond Position:  [-47.22414589]


portfolio before change:  [-14.11655479]
curr_Stock_Price:  103.80742207658786
curr_Factors:  [103.80742208]
mat_Sqrt:  [[0.15]]
grads:  [-0.07754646]
Stock Position:  -0.07754645960418313
Bond Position:  [-6.06665673]


portfolio before change:  [-14.05953773]
curr_Stock_Price:  103.05259826540603
curr_Factors:  [103.05259827]
mat_Sqrt:  [[0.15]]
grads:  [-0.13863286]
Stock Position:  -0.13863285635378494
Bond Position:  [0.22693832]


portfolio before change:  [-14.0363245]
curr_Stock_Price:  102.88556363112366
curr_Factors:  [102.88556363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00455771]
Stock Position:  -0.004557709267070367
Bond Position:  [-13.56740201]


portfolio before change:  [-14.03551256]
curr_Stock_Price:  101.96312440484986
curr_Factors:  [101.9631244]
mat_Sqrt:  [[0.15]]
grads:  [-0.1178113]
Stock Position:  -0.117811299875572
Bond Position:  [-2.02310434]


portfolio before change:  [-14.2489084]
curr_Stock_Price:  103.77016669532496
curr_Factors:  [103.7701667]
mat_Sqrt:  [[0.15]]
grads:  [0.03108745]
Stock Position:  0.031087449812712206
Bond Position:  [-17.47485825]


portfolio before change:  [-14.26078176]
curr_Stock_Price:  103.52878017141857
curr_Factors:  [103.52878017]
mat_Sqrt:  [[0.15]]
grads:  [0.05589591]
Stock Position:  0.0558959056087957
Bond Position:  [-20.04761668]


portfolio before change:  [-14.4070954]
curr_Stock_Price:  101.00084697278277
curr_Factors:  [101.00084697]
mat_Sqrt:  [[0.15]]
grads:  [-0.08201655]
Stock Position:  -0.08201655251083693
Bond Position:  [-6.12335413]


portfolio before change:  [-14.32430199]
curr_Stock_Price:  99.97270762718155
curr_Factors:  [99.97270763]
mat_Sqrt:  [[0.15]]
grads:  [0.12144674]
Stock Position:  0.1214467384152664
Bond Position:  [-26.46566126]


portfolio before change:  [-14.45859232]
curr_Stock_Price:  98.92143944210332
curr_Factors:  [98.92143944]
mat_Sqrt:  [[0.15]]
grads:  [0.02589239]
Stock Position:  0.02589238523778318
Bond Position:  [-17.01990434]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.45859232]
Stock Price:  99.7738428198224
PL:  [-14.45859232]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.93645875e-02]
 [ 8.38409379e-03]
 [ 8.45884960e-03]
 [ 2.47795012e-03]
 [ 6.84807993e-03]
 [-9.07795778e-03]
 [-4.91107897e-03]
 [ 8.56595954e-04]
 [ 1.91733386e-03]
 [ 5.52980845e-02]
 [-1.25595012e-02]
 [-1.95064955e-02]
 [-2.80309151e-03]
 [-3.48937333e-02]
 [ 2.40785048e-02]
 [-3.20049730e-03]
 [-7.33605074e-03]
 [ 1.63822906e-03]
 [ 6.17295777e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.01296721]
curr_Stock_Price:  99.81810616150175
curr_Factors:  [99.81810616]
mat_Sqrt:  [[0.15]]
grads:  [0.12909725]
Stock Position:  0.12909724982629653
Bond Position:  [-13.8992102]


portfolio before change:  [-1.2012874]
curr_Stock_Price:  98.38627900278026
curr_Factors:  [98.386279]
mat_Sqrt:  [[0.15]]
grads:  [0.05589396]
Stock Position:  0.055893958578631504
Bond Position:  [-6.700486]


portfolio before change:  [-1.20157343]
curr_Stock_Price:  98.41113488888952
curr_Factors:  [98.41113489]
mat_Sqrt:  [[0.15]]
grads:  [0.05639233]
Stock Position:  0.056392330639011376
Bond Position:  [-6.75120669]


portfolio before change:  [-1.07992667]
curr_Stock_Price:  100.59821900707443
curr_Factors:  [100.59821901]
mat_Sqrt:  [[0.15]]
grads:  [0.01651967]
Stock Position:  0.016519667491678332
Bond Position:  [-2.7417758]


portfolio before change:  [-1.07611605]
curr_Stock_Price:  100.87038904996263
curr_Factors:  [100.87038905]
mat_Sqrt:  [[0.15]]
grads:  [0.04565387]
Stock Position:  0.04565386621502888
Bond Position:  [-5.68123929]


portfolio before change:  [-1.00007425]
curr_Stock_Price:  102.56711905309169
curr_Factors:  [102.56711905]
mat_Sqrt:  [[0.15]]
grads:  [-0.06051972]
Stock Position:  -0.06051971852010246
Bond Position:  [5.20725893]


portfolio before change:  [-1.03923924]
curr_Stock_Price:  103.23577667742128
curr_Factors:  [103.23577668]
mat_Sqrt:  [[0.15]]
grads:  [-0.03274053]
Stock Position:  -0.03274052643794144
Bond Position:  [2.34075443]


portfolio before change:  [-1.04747825]
curr_Stock_Price:  103.50529788631547
curr_Factors:  [103.50529789]
mat_Sqrt:  [[0.15]]
grads:  [0.00571064]
Stock Position:  0.0057106396945524876
Bond Position:  [-1.63855971]


portfolio before change:  [-1.04464374]
curr_Stock_Price:  104.07339558425296
curr_Factors:  [104.07339558]
mat_Sqrt:  [[0.15]]
grads:  [0.01278223]
Stock Position:  0.012782225725749585
Bond Position:  [-2.37493337]


portfolio before change:  [-1.04351656]
curr_Stock_Price:  104.20803442532518
curr_Factors:  [104.20803443]
mat_Sqrt:  [[0.15]]
grads:  [0.3686539]
Stock Position:  0.3686538968942138
Bond Position:  [-39.46021454]


portfolio before change:  [-0.93343542]
curr_Stock_Price:  104.53340036973576
curr_Factors:  [104.53340037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08373001]
Stock Position:  -0.0837300079165952
Bond Position:  [7.81914702]


portfolio before change:  [-0.9264684]
curr_Stock_Price:  104.47354142807735
curr_Factors:  [104.47354143]
mat_Sqrt:  [[0.15]]
grads:  [-0.1300433]
Stock Position:  -0.13004330322768534
Bond Position:  [12.65961602]


portfolio before change:  [-1.23920794]
curr_Stock_Price:  106.90276948479932
curr_Factors:  [106.90276948]
mat_Sqrt:  [[0.15]]
grads:  [-0.01868728]
Stock Position:  -0.01868727671683829
Bond Position:  [0.75851369]


portfolio before change:  [-1.29539934]
curr_Stock_Price:  109.91985155690863
curr_Factors:  [109.91985156]
mat_Sqrt:  [[0.15]]
grads:  [-0.23262489]
Stock Position:  -0.2326248888330398
Bond Position:  [24.27469391]


portfolio before change:  [-1.27697975]
curr_Stock_Price:  109.86676110281188
curr_Factors:  [109.8667611]
mat_Sqrt:  [[0.15]]
grads:  [0.16052337]
Stock Position:  0.1605233650968298
Bond Position:  [-18.91316195]


portfolio before change:  [-0.95203754]
curr_Stock_Price:  111.92048761043874
curr_Factors:  [111.92048761]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133665]
Stock Position:  -0.021336648679148133
Bond Position:  [1.43597059]


portfolio before change:  [-0.97348751]
curr_Stock_Price:  112.94262601558083
curr_Factors:  [112.94262602]
mat_Sqrt:  [[0.15]]
grads:  [-0.048907]
Stock Position:  -0.048907004933222795
Bond Position:  [4.55019806]


portfolio before change:  [-1.01223832]
curr_Stock_Price:  113.75822508365127
curr_Factors:  [113.75822508]
mat_Sqrt:  [[0.15]]
grads:  [0.01092153]
Stock Position:  0.01092152707969039
Bond Position:  [-2.25465186]


portfolio before change:  [-0.98915331]
curr_Stock_Price:  115.92355810585023
curr_Factors:  [115.92355811]
mat_Sqrt:  [[0.15]]
grads:  [0.04115305]
Stock Position:  0.04115305180112607
Bond Position:  [-5.75976151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.98915331]
Stock Price:  118.6268757690927
PL:  [-19.61602908]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.25267426e-02]
 [ 1.01662678e-02]
 [ 3.37003256e-02]
 [-2.87909267e-03]
 [ 8.52630119e-03]
 [ 9.23540538e-04]
 [-1.05895499e-02]
 [ 6.64884352e-03]
 [ 5.79857297e-03]
 [-3.72480067e-02]
 [-7.99852200e-04]
 [-2.63531211e-02]
 [ 2.61504768e-03]
 [-2.20892831e-03]
 [-1.53538337e-03]
 [ 9.74527218e-03]
 [ 4.71593937e-02]
 [ 1.90875130e-02]
 [ 2.76001820e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.35623354]
curr_Stock_Price:  98.55317264366398
curr_Factors:  [98.55317264]
mat_Sqrt:  [[0.15]]
grads:  [0.61684495]
Stock Position:  0.6168449503960038
Bond Position:  [-81.14826043]


portfolio before change:  [-21.53173786]
curr_Stock_Price:  96.68039290864502
curr_Factors:  [96.68039291]
mat_Sqrt:  [[0.15]]
grads:  [0.06777512]
Stock Position:  0.06777511894719908
Bond Position:  [-28.08426299]


portfolio before change:  [-21.53971837]
curr_Stock_Price:  96.6662496085003
curr_Factors:  [96.66624961]
mat_Sqrt:  [[0.15]]
grads:  [0.22466884]
Stock Position:  0.22466883728119633
Bond Position:  [-43.25761227]


portfolio before change:  [-21.61641776]
curr_Stock_Price:  96.37300184121129
curr_Factors:  [96.37300184]
mat_Sqrt:  [[0.15]]
grads:  [-0.01919395]
Stock Position:  -0.01919395113351904
Bond Position:  [-19.76663907]


portfolio before change:  [-21.66229082]
curr_Stock_Price:  98.50548554616685
curr_Factors:  [98.50548555]
mat_Sqrt:  [[0.15]]
grads:  [0.05684201]
Stock Position:  0.05684200793104967
Bond Position:  [-27.26154041]


portfolio before change:  [-21.6126043]
curr_Stock_Price:  99.4995173270144
curr_Factors:  [99.49951733]
mat_Sqrt:  [[0.15]]
grads:  [0.00615694]
Stock Position:  0.006156936920216696
Bond Position:  [-22.22521655]


portfolio before change:  [-21.61512423]
curr_Stock_Price:  99.9927929980277
curr_Factors:  [99.992793]
mat_Sqrt:  [[0.15]]
grads:  [-0.070597]
Stock Position:  -0.07059699905253558
Bond Position:  [-14.55593312]


portfolio before change:  [-21.35971085]
curr_Stock_Price:  96.32333372692311
curr_Factors:  [96.32333373]
mat_Sqrt:  [[0.15]]
grads:  [0.04432562]
Stock Position:  0.04432562348131255
Bond Position:  [-25.62930268]


portfolio before change:  [-21.37391505]
curr_Stock_Price:  96.14745186475257
curr_Factors:  [96.14745186]
mat_Sqrt:  [[0.15]]
grads:  [0.03865715]
Stock Position:  0.03865715315835795
Bond Position:  [-25.09070183]


portfolio before change:  [-21.34451947]
curr_Stock_Price:  97.07015404785021
curr_Factors:  [97.07015405]
mat_Sqrt:  [[0.15]]
grads:  [-0.24832004]
Stock Position:  -0.24832004489270323
Bond Position:  [2.75994554]


portfolio before change:  [-21.01729349]
curr_Stock_Price:  95.7551739558235
curr_Factors:  [95.75517396]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533235]
Stock Position:  -0.005332347997194937
Bond Position:  [-20.50669358]


portfolio before change:  [-21.02844824]
curr_Stock_Price:  96.88552711704293
curr_Factors:  [96.88552712]
mat_Sqrt:  [[0.15]]
grads:  [-0.17568747]
Stock Position:  -0.17568747408112823
Bond Position:  [-4.0068747]


portfolio before change:  [-20.94003684]
curr_Stock_Price:  96.37659364683692
curr_Factors:  [96.37659365]
mat_Sqrt:  [[0.15]]
grads:  [0.01743365]
Stock Position:  0.01743365121685906
Bond Position:  [-22.62023276]


portfolio before change:  [-20.95627163]
curr_Stock_Price:  95.76977761755421
curr_Factors:  [95.76977762]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472619]
Stock Position:  -0.014726188745942132
Bond Position:  [-19.54594781]


portfolio before change:  [-20.96992972]
curr_Stock_Price:  96.3653829764426
curr_Factors:  [96.36538298]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023589]
Stock Position:  -0.010235889138630543
Bond Position:  [-19.98354435]


portfolio before change:  [-20.97041663]
curr_Stock_Price:  95.92481494070557
curr_Factors:  [95.92481494]
mat_Sqrt:  [[0.15]]
grads:  [0.06496848]
Stock Position:  0.06496848121138692
Bond Position:  [-27.20250617]


portfolio before change:  [-20.94372552]
curr_Stock_Price:  96.4403353878276
curr_Factors:  [96.44033539]
mat_Sqrt:  [[0.15]]
grads:  [0.31439596]
Stock Position:  0.31439595770218537
Bond Position:  [-51.26417713]


portfolio before change:  [-21.14692323]
curr_Stock_Price:  95.83479306387211
curr_Factors:  [95.83479306]
mat_Sqrt:  [[0.15]]
grads:  [0.12725009]
Stock Position:  0.12725008633706672
Bond Position:  [-33.34190892]


portfolio before change:  [-21.18407356]
curr_Stock_Price:  95.60835856732108
curr_Factors:  [95.60835857]
mat_Sqrt:  [[0.15]]
grads:  [0.01840012]
Stock Position:  0.01840012132365821
Bond Position:  [-22.94327896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.18407356]
Stock Price:  97.81559556274598
PL:  [-21.18407356]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.18958283e-01]
 [ 7.16136211e-03]
 [-6.57578265e-03]
 [ 2.56787639e-03]
 [ 7.20051706e-03]
 [ 4.62771317e-04]
 [-1.50680959e-02]
 [ 4.11771725e-03]
 [ 3.93013989e-03]
 [-3.72726956e-02]
 [-9.24648667e-04]
 [-2.63673477e-02]
 [ 2.31815873e-03]
 [-1.74345548e-03]
 [-8.92581710e-04]
 [ 6.86842132e-03]
 [ 3.05212735e-03]
 [ 1.31617943e-02]
 [ 1.79862426e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.48553081]
curr_Stock_Price:  98.34853538435196
curr_Factors:  [98.34853538]
mat_Sqrt:  [[0.15]]
grads:  [0.79305522]
Stock Position:  0.7930552207616411
Bond Position:  [-101.48135025]


portfolio before change:  [-23.10094759]
curr_Stock_Price:  98.86546877271783
curr_Factors:  [98.86546877]
mat_Sqrt:  [[0.15]]
grads:  [0.04774241]
Stock Position:  0.04774241405402095
Bond Position:  [-27.82102374]


portfolio before change:  [-23.05265683]
curr_Stock_Price:  100.02265559590253
curr_Factors:  [100.0226556]
mat_Sqrt:  [[0.15]]
grads:  [-0.04383855]
Stock Position:  -0.04383855101965122
Bond Position:  [-18.66780854]


portfolio before change:  [-23.07663391]
curr_Stock_Price:  100.46312515106855
curr_Factors:  [100.46312515]
mat_Sqrt:  [[0.15]]
grads:  [0.01711918]
Stock Position:  0.017119175937572898
Bond Position:  [-24.79647982]


portfolio before change:  [-23.08455809]
curr_Stock_Price:  100.36240286078939
curr_Factors:  [100.36240286]
mat_Sqrt:  [[0.15]]
grads:  [0.04800345]
Stock Position:  0.048003447051696284
Bond Position:  [-27.90229938]


portfolio before change:  [-23.14814137]
curr_Stock_Price:  99.18317839034395
curr_Factors:  [99.18317839]
mat_Sqrt:  [[0.15]]
grads:  [0.00308514]
Stock Position:  0.00308514211560663
Bond Position:  [-23.45413557]


portfolio before change:  [-23.15579253]
curr_Stock_Price:  98.60398731165681
curr_Factors:  [98.60398731]
mat_Sqrt:  [[0.15]]
grads:  [-0.10045397]
Stock Position:  -0.10045397264217204
Bond Position:  [-13.25063028]


portfolio before change:  [-23.08154514]
curr_Stock_Price:  97.83188784764856
curr_Factors:  [97.83188785]
mat_Sqrt:  [[0.15]]
grads:  [0.02745145]
Stock Position:  0.02745144832441807
Bond Position:  [-25.76717215]


portfolio before change:  [-23.11070304]
curr_Stock_Price:  97.0044160672027
curr_Factors:  [97.00441607]
mat_Sqrt:  [[0.15]]
grads:  [0.02620093]
Stock Position:  0.026200932613618076
Bond Position:  [-25.65230921]


portfolio before change:  [-23.14416672]
curr_Stock_Price:  95.97201750023048
curr_Factors:  [95.9720175]
mat_Sqrt:  [[0.15]]
grads:  [-0.24848464]
Stock Position:  -0.24848463725521072
Bond Position:  [0.70340523]


portfolio before change:  [-23.27861999]
curr_Stock_Price:  96.51381817488779
curr_Factors:  [96.51381817]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616432]
Stock Position:  -0.006164324448188346
Bond Position:  [-22.6836775]


portfolio before change:  [-23.28011175]
curr_Stock_Price:  95.8357439316031
curr_Factors:  [95.83574393]
mat_Sqrt:  [[0.15]]
grads:  [-0.17578232]
Stock Position:  -0.1757823177211197
Bond Position:  [-6.43388256]


portfolio before change:  [-23.15760383]
curr_Stock_Price:  95.1296627181501
curr_Factors:  [95.12966272]
mat_Sqrt:  [[0.15]]
grads:  [0.01545439]
Stock Position:  0.015454391507631346
Bond Position:  [-24.62777488]


portfolio before change:  [-23.14913025]
curr_Stock_Price:  96.07640286419384
curr_Factors:  [96.07640286]
mat_Sqrt:  [[0.15]]
grads:  [-0.01162304]
Stock Position:  -0.011623036553663868
Bond Position:  [-22.03243071]


portfolio before change:  [-23.14793258]
curr_Stock_Price:  95.49940494784667
curr_Factors:  [95.49940495]
mat_Sqrt:  [[0.15]]
grads:  [-0.00595054]
Stock Position:  -0.005950544730084473
Bond Position:  [-22.5796591]


portfolio before change:  [-23.14694186]
curr_Stock_Price:  94.38415587436984
curr_Factors:  [94.38415587]
mat_Sqrt:  [[0.15]]
grads:  [0.04578948]
Stock Position:  0.045789475490609646
Bond Position:  [-27.46874285]


portfolio before change:  [-23.19646135]
curr_Stock_Price:  93.4526875141541
curr_Factors:  [93.45268751]
mat_Sqrt:  [[0.15]]
grads:  [0.02034752]
Stock Position:  0.020347515696606533
Bond Position:  [-25.09799138]


portfolio before change:  [-23.21852541]
curr_Stock_Price:  92.6767314635371
curr_Factors:  [92.67673146]
mat_Sqrt:  [[0.15]]
grads:  [0.0877453]
Stock Position:  0.08774529523912454
Bond Position:  [-31.35047258]


portfolio before change:  [-23.06780974]
curr_Stock_Price:  94.48371459338641
curr_Factors:  [94.48371459]
mat_Sqrt:  [[0.15]]
grads:  [0.01199083]
Stock Position:  0.01199082842508413
Bond Position:  [-24.20074775]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.06780974]
Stock Price:  94.22115750655787
PL:  [-23.06780974]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.98708498e-02]
 [-3.94662276e-03]
 [-4.78134918e-03]
 [ 3.27389485e-03]
 [ 7.95948864e-03]
 [ 5.82575169e-04]
 [-1.55906129e-02]
 [-1.19753163e-03]
 [-8.92261847e-04]
 [-3.71450370e-02]
 [-4.06056464e-03]
 [-2.36689924e-02]
 [-4.44208875e-04]
 [-1.13866598e-02]
 [-3.40047607e-03]
 [ 1.05875693e-02]
 [ 4.48571716e-02]
 [ 1.99010343e-02]
 [ 3.81707689e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.1412336]
curr_Stock_Price:  99.22117232851313
curr_Factors:  [99.22117233]
mat_Sqrt:  [[0.15]]
grads:  [0.13247233]
Stock Position:  0.13247233232579902
Bond Position:  [-23.28529371]


portfolio before change:  [-10.02882115]
curr_Stock_Price:  100.11369450338113
curr_Factors:  [100.1136945]
mat_Sqrt:  [[0.15]]
grads:  [-0.02631082]
Stock Position:  -0.026310818411039903
Bond Position:  [-7.39474792]


portfolio before change:  [-10.02571019]
curr_Stock_Price:  99.925183435047
curr_Factors:  [99.92518344]
mat_Sqrt:  [[0.15]]
grads:  [-0.03187566]
Stock Position:  -0.031875661198307925
Bond Position:  [-6.8405289]


portfolio before change:  [-10.02952496]
curr_Stock_Price:  99.99120322396344
curr_Factors:  [99.99120322]
mat_Sqrt:  [[0.15]]
grads:  [0.02182597]
Stock Position:  0.021825965660567777
Bond Position:  [-12.21192953]


portfolio before change:  [-10.0424441]
curr_Stock_Price:  99.53918299655177
curr_Factors:  [99.539183]
mat_Sqrt:  [[0.15]]
grads:  [0.05306326]
Stock Position:  0.053063257607651716
Bond Position:  [-15.32431741]


portfolio before change:  [-10.06437182]
curr_Stock_Price:  99.19815300491385
curr_Factors:  [99.198153]
mat_Sqrt:  [[0.15]]
grads:  [0.00388383]
Stock Position:  0.003883834458232964
Bond Position:  [-10.44964103]


portfolio before change:  [-10.06561328]
curr_Stock_Price:  99.55122790511241
curr_Factors:  [99.55122791]
mat_Sqrt:  [[0.15]]
grads:  [-0.10393742]
Stock Position:  -0.10393741941753808
Bond Position:  [0.28148445]


portfolio before change:  [-10.06315324]
curr_Stock_Price:  99.52823663660942
curr_Factors:  [99.52823664]
mat_Sqrt:  [[0.15]]
grads:  [-0.00798354]
Stock Position:  -0.007983544185835075
Bond Position:  [-9.26856517]


portfolio before change:  [-10.07056364]
curr_Stock_Price:  100.1661699532641
curr_Factors:  [100.16616995]
mat_Sqrt:  [[0.15]]
grads:  [-0.00594841]
Stock Position:  -0.0059484123156778295
Bond Position:  [-9.47473396]


portfolio before change:  [-10.06600466]
curr_Stock_Price:  99.0014956662229
curr_Factors:  [99.00149567]
mat_Sqrt:  [[0.15]]
grads:  [-0.24763358]
Stock Position:  -0.24763358007100705
Bond Position:  [14.45009015]


portfolio before change:  [-10.46834682]
curr_Stock_Price:  100.64083366405819
curr_Factors:  [100.64083366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02707043]
Stock Position:  -0.027070430954932806
Bond Position:  [-7.74395608]


portfolio before change:  [-10.46152811]
curr_Stock_Price:  100.31742021731043
curr_Factors:  [100.31742022]
mat_Sqrt:  [[0.15]]
grads:  [-0.15779328]
Stock Position:  -0.1577932826568953
Bond Position:  [5.36788693]


portfolio before change:  [-10.77900625]
curr_Stock_Price:  102.33791357422999
curr_Factors:  [102.33791357]
mat_Sqrt:  [[0.15]]
grads:  [-0.00296139]
Stock Position:  -0.0029613924985356053
Bond Position:  [-10.47594352]


portfolio before change:  [-10.77847352]
curr_Stock_Price:  101.27353556224402
curr_Factors:  [101.27353556]
mat_Sqrt:  [[0.15]]
grads:  [-0.07591107]
Stock Position:  -0.07591106563773421
Bond Position:  [-3.09069152]


portfolio before change:  [-10.70069202]
curr_Stock_Price:  100.23871578460823
curr_Factors:  [100.23871578]
mat_Sqrt:  [[0.15]]
grads:  [-0.02266984]
Stock Position:  -0.022669840435908924
Bond Position:  [-8.42829633]


portfolio before change:  [-10.70292488]
curr_Stock_Price:  100.24425266537972
curr_Factors:  [100.24425267]
mat_Sqrt:  [[0.15]]
grads:  [0.0705838]
Stock Position:  0.07058379547262017
Bond Position:  [-17.77854471]


portfolio before change:  [-10.76912242]
curr_Stock_Price:  99.36937270478164
curr_Factors:  [99.3693727]
mat_Sqrt:  [[0.15]]
grads:  [0.29904781]
Stock Position:  0.2990478107271936
Bond Position:  [-40.48531578]


portfolio before change:  [-10.69350755]
curr_Stock_Price:  99.65607421137166
curr_Factors:  [99.65607421]
mat_Sqrt:  [[0.15]]
grads:  [0.13267356]
Stock Position:  0.1326735620646234
Bond Position:  [-23.9152339]


portfolio before change:  [-10.71171266]
curr_Stock_Price:  99.56392660454149
curr_Factors:  [99.5639266]
mat_Sqrt:  [[0.15]]
grads:  [0.02544718]
Stock Position:  0.025447179296012014
Bond Position:  [-13.24533375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.71171266]
Stock Price:  97.5190583837597
PL:  [-10.71171266]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.88898332e-02]
 [ 8.20634083e-03]
 [ 1.90896098e-02]
 [ 1.34097475e-03]
 [ 8.77636144e-03]
 [ 6.19977485e-02]
 [ 1.61617093e-03]
 [ 8.06846682e-03]
 [ 7.04705546e-03]
 [-3.72898387e-02]
 [-4.23055290e-04]
 [-2.63663714e-02]
 [ 2.80737403e-03]
 [ 1.24001057e-03]
 [-2.26265336e-03]
 [ 1.20269195e-02]
 [ 4.28879168e-02]
 [ 2.08866832e-02]
 [ 3.99323498e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.16020179]
curr_Stock_Price:  99.28532592021135
curr_Factors:  [99.28532592]
mat_Sqrt:  [[0.15]]
grads:  [0.12593222]
Stock Position:  0.12593222120623435
Bond Position:  [-21.66342342]


portfolio before change:  [-9.27006466]
curr_Stock_Price:  98.45594056416824
curr_Factors:  [98.45594056]
mat_Sqrt:  [[0.15]]
grads:  [0.05470894]
Stock Position:  0.054708938874679834
Bond Position:  [-14.6564847]


portfolio before change:  [-9.32538174]
curr_Stock_Price:  97.51180781473428
curr_Factors:  [97.51180781]
mat_Sqrt:  [[0.15]]
grads:  [0.12726407]
Stock Position:  0.12726406559666154
Bond Position:  [-21.73513085]


portfolio before change:  [-9.31204399]
curr_Stock_Price:  97.65931384692281
curr_Factors:  [97.65931385]
mat_Sqrt:  [[0.15]]
grads:  [0.00893983]
Stock Position:  0.008939831691096644
Bond Position:  [-10.18510182]


portfolio before change:  [-9.31633999]
curr_Stock_Price:  97.46362732053144
curr_Factors:  [97.46362732]
mat_Sqrt:  [[0.15]]
grads:  [0.05850908]
Stock Position:  0.05850907629578377
Bond Position:  [-15.01884679]


portfolio before change:  [-9.47890857]
curr_Stock_Price:  94.74928952389455
curr_Factors:  [94.74928952]
mat_Sqrt:  [[0.15]]
grads:  [0.41331832]
Stock Position:  0.4133183236433911
Bond Position:  [-48.64052608]


portfolio before change:  [-9.83573722]
curr_Stock_Price:  93.91538746140802
curr_Factors:  [93.91538746]
mat_Sqrt:  [[0.15]]
grads:  [0.01077447]
Stock Position:  0.010774472889768585
Bond Position:  [-10.84762602]


portfolio before change:  [-9.82563116]
curr_Stock_Price:  95.10507925914236
curr_Factors:  [95.10507926]
mat_Sqrt:  [[0.15]]
grads:  [0.05378978]
Stock Position:  0.053789778771395
Bond Position:  [-14.94131234]


portfolio before change:  [-9.80667877]
curr_Stock_Price:  95.52687297990325
curr_Factors:  [95.52687298]
mat_Sqrt:  [[0.15]]
grads:  [0.04698037]
Stock Position:  0.046980369764183384
Bond Position:  [-14.29456658]


portfolio before change:  [-9.82516284]
curr_Stock_Price:  95.20950674687562
curr_Factors:  [95.20950675]
mat_Sqrt:  [[0.15]]
grads:  [-0.24859892]
Stock Position:  -0.24859892490605173
Bond Position:  [13.84381818]


portfolio before change:  [-9.80167984]
curr_Stock_Price:  95.12896894049904
curr_Factors:  [95.12896894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00282037]
Stock Position:  -0.002820368600151326
Bond Position:  [-9.53338108]


portfolio before change:  [-9.80626003]
curr_Stock_Price:  95.90778449954188
curr_Factors:  [95.9077845]
mat_Sqrt:  [[0.15]]
grads:  [-0.17577581]
Stock Position:  -0.17577580914888777
Bond Position:  [7.05200839]


portfolio before change:  [-10.0470965]
curr_Stock_Price:  97.28794989081418
curr_Factors:  [97.28794989]
mat_Sqrt:  [[0.15]]
grads:  [0.01871583]
Stock Position:  0.018715826890346357
Bond Position:  [-11.86792092]


portfolio before change:  [-10.04297241]
curr_Stock_Price:  97.6668506144938
curr_Factors:  [97.66685061]
mat_Sqrt:  [[0.15]]
grads:  [0.00826674]
Stock Position:  0.00826673714988923
Bond Position:  [-10.85035859]


portfolio before change:  [-10.04218759]
curr_Stock_Price:  98.08996154260437
curr_Factors:  [98.08996154]
mat_Sqrt:  [[0.15]]
grads:  [-0.01508436]
Stock Position:  -0.015084355759429693
Bond Position:  [-8.56256371]


portfolio before change:  [-10.04091935]
curr_Stock_Price:  97.86395630756108
curr_Factors:  [97.86395631]
mat_Sqrt:  [[0.15]]
grads:  [0.08017946]
Stock Position:  0.08017946311943502
Bond Position:  [-17.88759883]


portfolio before change:  [-10.21131879]
curr_Stock_Price:  95.79451145807748
curr_Factors:  [95.79451146]
mat_Sqrt:  [[0.15]]
grads:  [0.28591945]
Stock Position:  0.28591944524662266
Bond Position:  [-37.60083236]


portfolio before change:  [-9.85559297]
curr_Stock_Price:  97.07153969463133
curr_Factors:  [97.07153969]
mat_Sqrt:  [[0.15]]
grads:  [0.13924455]
Stock Position:  0.13924455477162062
Bond Position:  [-23.37227629]


portfolio before change:  [-9.86429926]
curr_Stock_Price:  97.05098242427084
curr_Factors:  [97.05098242]
mat_Sqrt:  [[0.15]]
grads:  [0.02662157]
Stock Position:  0.026621566559622962
Bond Position:  [-12.44794844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.86429926]
Stock Price:  96.00418665055697
PL:  [-9.86429926]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.90395190e-02]
 [-5.43863246e-03]
 [-1.04220883e-02]
 [ 2.53156641e-03]
 [ 7.20310802e-03]
 [ 1.01710212e-03]
 [-1.57608019e-02]
 [ 1.39928718e-03]
 [-5.19396335e-04]
 [-2.78314195e-02]
 [-3.88943908e-03]
 [-2.24174020e-02]
 [ 6.63665633e-04]
 [-1.93412908e-03]
 [-3.46233446e-03]
 [ 1.04772045e-02]
 [ 3.09901084e-02]
 [ 1.94258588e-02]
 [ 3.86676349e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46310188]
curr_Stock_Price:  100.04542021646546
curr_Factors:  [100.04542022]
mat_Sqrt:  [[0.15]]
grads:  [0.19359679]
Stock Position:  0.1935967935164335
Bond Position:  [-16.90537068]


portfolio before change:  [2.49749117]
curr_Stock_Price:  100.24488717563221
curr_Factors:  [100.24488718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03625755]
Stock Position:  -0.036257549714183566
Bond Position:  [6.13212516]


portfolio before change:  [2.48445639]
curr_Stock_Price:  100.64667968545345
curr_Factors:  [100.64667969]
mat_Sqrt:  [[0.15]]
grads:  [-0.06948059]
Stock Position:  -0.06948058836548632
Bond Position:  [9.47744691]


portfolio before change:  [2.4965117]
curr_Stock_Price:  100.50727885438707
curr_Factors:  [100.50727885]
mat_Sqrt:  [[0.15]]
grads:  [0.01687711]
Stock Position:  0.016877109413302584
Bond Position:  [0.80023935]


portfolio before change:  [2.49421016]
curr_Stock_Price:  100.35905334535438
curr_Factors:  [100.35905335]
mat_Sqrt:  [[0.15]]
grads:  [0.04802072]
Stock Position:  0.048020720126808566
Bond Position:  [-2.32510385]


portfolio before change:  [2.45029593]
curr_Stock_Price:  99.45667451448382
curr_Factors:  [99.45667451]
mat_Sqrt:  [[0.15]]
grads:  [0.00678068]
Stock Position:  0.006780680778574305
Bond Position:  [1.77591197]


portfolio before change:  [2.4480382]
curr_Stock_Price:  99.05822446692831
curr_Factors:  [99.05822447]
mat_Sqrt:  [[0.15]]
grads:  [-0.10507201]
Stock Position:  -0.10507201270234946
Bond Position:  [12.85628522]


portfolio before change:  [2.49630756]
curr_Stock_Price:  98.62942438898415
curr_Factors:  [98.62942439]
mat_Sqrt:  [[0.15]]
grads:  [0.00932858]
Stock Position:  0.00932858116845534
Bond Position:  [1.57623497]


portfolio before change:  [2.50729081]
curr_Stock_Price:  99.76455294228063
curr_Factors:  [99.76455294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00346264]
Stock Position:  -0.00346264223426519
Bond Position:  [2.85273976]


portfolio before change:  [2.50879346]
curr_Stock_Price:  99.53658322867426
curr_Factors:  [99.53658323]
mat_Sqrt:  [[0.15]]
grads:  [-0.1855428]
Stock Position:  -0.18554279687152497
Bond Position:  [20.97708951]


portfolio before change:  [2.3176717]
curr_Stock_Price:  100.59491961875663
curr_Factors:  [100.59491962]
mat_Sqrt:  [[0.15]]
grads:  [-0.02592959]
Stock Position:  -0.025929593878002023
Bond Position:  [4.92605711]


portfolio before change:  [2.30141351]
curr_Stock_Price:  101.26943288436621
curr_Factors:  [101.26943288]
mat_Sqrt:  [[0.15]]
grads:  [-0.14944935]
Stock Position:  -0.1494493465439647
Bond Position:  [17.43606408]


portfolio before change:  [2.43379496]
curr_Stock_Price:  100.4128089305203
curr_Factors:  [100.41280893]
mat_Sqrt:  [[0.15]]
grads:  [0.00442444]
Stock Position:  0.004424437554696475
Bond Position:  [1.98952476]


portfolio before change:  [2.43175067]
curr_Stock_Price:  99.83833280510459
curr_Factors:  [99.83833281]
mat_Sqrt:  [[0.15]]
grads:  [-0.01289419]
Stock Position:  -0.012894193858794846
Bond Position:  [3.71908549]


portfolio before change:  [2.42246185]
curr_Stock_Price:  100.63083746639686
curr_Factors:  [100.63083747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02308223]
Stock Position:  -0.02308222974714936
Bond Position:  [4.74524596]


portfolio before change:  [2.40732471]
curr_Stock_Price:  101.33803086075037
curr_Factors:  [101.33803086]
mat_Sqrt:  [[0.15]]
grads:  [0.06984803]
Stock Position:  0.06984802995045285
Bond Position:  [-4.67093711]


portfolio before change:  [2.30345956]
curr_Stock_Price:  99.86773496925278
curr_Factors:  [99.86773497]
mat_Sqrt:  [[0.15]]
grads:  [0.20660072]
Stock Position:  0.20660072255366022
Bond Position:  [-18.32928665]


portfolio before change:  [2.10268613]
curr_Stock_Price:  98.91812292877846
curr_Factors:  [98.91812293]
mat_Sqrt:  [[0.15]]
grads:  [0.12950573]
Stock Position:  0.12950572528004756
Bond Position:  [-10.70777712]


portfolio before change:  [2.12173703]
curr_Stock_Price:  99.08590066398604
curr_Factors:  [99.08590066]
mat_Sqrt:  [[0.15]]
grads:  [0.02577842]
Stock Position:  0.025778423251530756
Bond Position:  [-0.43254126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.12173703]
Stock Price:  97.85949908840249
PL:  [2.12173703]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.74892464e-02]
 [ 4.01239463e-03]
 [ 2.26089687e-03]
 [-1.15699200e-02]
 [ 4.03708667e-03]
 [-7.54816199e-02]
 [-1.29158883e-02]
 [ 1.49334119e-03]
 [ 1.93029145e-03]
 [ 2.52487303e-02]
 [-6.03968381e-03]
 [-2.09493897e-02]
 [-1.18690202e-03]
 [-1.03011509e-02]
 [ 7.92909268e-04]
 [ 8.56783861e-03]
 [-4.68547973e-02]
 [-2.59442949e-02]
 [ 4.26869641e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.52789824]
curr_Stock_Price:  100.37662749920379
curr_Factors:  [100.3766275]
mat_Sqrt:  [[0.15]]
grads:  [0.24992831]
Stock Position:  0.24992830962371257
Bond Position:  [-17.55906259]


portfolio before change:  [7.32280877]
curr_Stock_Price:  99.57360058317936
curr_Factors:  [99.57360058]
mat_Sqrt:  [[0.15]]
grads:  [0.0267493]
Stock Position:  0.026749297516447633
Bond Position:  [4.6592849]


portfolio before change:  [7.38593597]
curr_Stock_Price:  101.8900064022331
curr_Factors:  [101.8900064]
mat_Sqrt:  [[0.15]]
grads:  [0.01507265]
Stock Position:  0.015072645773832976
Bond Position:  [5.85018399]


portfolio before change:  [7.43350742]
curr_Stock_Price:  104.949106123919
curr_Factors:  [104.94910612]
mat_Sqrt:  [[0.15]]
grads:  [-0.0771328]
Stock Position:  -0.07713280016606924
Bond Position:  [15.52852585]


portfolio before change:  [7.32929459]
curr_Stock_Price:  106.35052606568073
curr_Factors:  [106.35052607]
mat_Sqrt:  [[0.15]]
grads:  [0.02691391]
Stock Position:  0.02691391113243526
Bond Position:  [4.46698599]


portfolio before change:  [7.34425653]
curr_Stock_Price:  106.86494609525761
curr_Factors:  [106.8649461]
mat_Sqrt:  [[0.15]]
grads:  [-0.5032108]
Stock Position:  -0.5032107990155237
Bond Position:  [61.11985145]


portfolio before change:  [8.15296724]
curr_Stock_Price:  105.28821357894917
curr_Factors:  [105.28821358]
mat_Sqrt:  [[0.15]]
grads:  [-0.08610592]
Stock Position:  -0.08610592203147395
Bond Position:  [17.21890595]


portfolio before change:  [8.14132216]
curr_Stock_Price:  105.47345452137603
curr_Factors:  [105.47345452]
mat_Sqrt:  [[0.15]]
grads:  [0.00995561]
Stock Position:  0.009955607942686875
Bond Position:  [7.0912698]


portfolio before change:  [8.12924046]
curr_Stock_Price:  104.08180301621447
curr_Factors:  [104.08180302]
mat_Sqrt:  [[0.15]]
grads:  [0.01286861]
Stock Position:  0.012868609678703749
Bond Position:  [6.78985236]


portfolio before change:  [8.103229]
curr_Stock_Price:  101.92856839637045
curr_Factors:  [101.9285684]
mat_Sqrt:  [[0.15]]
grads:  [0.16832487]
Stock Position:  0.16832486889107093
Bond Position:  [-9.05388391]


portfolio before change:  [7.98999118]
curr_Stock_Price:  101.26928337175676
curr_Factors:  [101.26928337]
mat_Sqrt:  [[0.15]]
grads:  [-0.04026456]
Stock Position:  -0.04026455875111849
Bond Position:  [12.06755419]


portfolio before change:  [7.92688428]
curr_Stock_Price:  102.91152572829493
curr_Factors:  [102.91152573]
mat_Sqrt:  [[0.15]]
grads:  [-0.1396626]
Stock Position:  -0.13966259767731404
Bond Position:  [22.2997753]


portfolio before change:  [7.80003036]
curr_Stock_Price:  103.85973638990617
curr_Factors:  [103.85973639]
mat_Sqrt:  [[0.15]]
grads:  [-0.00791268]
Stock Position:  -0.007912680101379566
Bond Position:  [8.62183923]


portfolio before change:  [7.82346952]
curr_Stock_Price:  101.16994892808339
curr_Factors:  [101.16994893]
mat_Sqrt:  [[0.15]]
grads:  [-0.06867434]
Stock Position:  -0.068674339320993
Bond Position:  [14.77124892]


portfolio before change:  [7.72656184]
curr_Stock_Price:  102.63484766064511
curr_Factors:  [102.63484766]
mat_Sqrt:  [[0.15]]
grads:  [0.00528606]
Stock Position:  0.0052860617882350075
Bond Position:  [7.18402769]


portfolio before change:  [7.73096942]
curr_Stock_Price:  103.12885410694292
curr_Factors:  [103.12885411]
mat_Sqrt:  [[0.15]]
grads:  [0.05711892]
Stock Position:  0.05711892407411687
Bond Position:  [1.84036023]


portfolio before change:  [7.785767]
curr_Stock_Price:  104.08015760633998
curr_Factors:  [104.08015761]
mat_Sqrt:  [[0.15]]
grads:  [-0.31236532]
Stock Position:  -0.31236531562917846
Bond Position:  [40.29679828]


portfolio before change:  [8.42013512]
curr_Stock_Price:  102.08155970450571
curr_Factors:  [102.0815597]
mat_Sqrt:  [[0.15]]
grads:  [-0.17296197]
Stock Position:  -0.17296196579681017
Bond Position:  [26.07636236]


portfolio before change:  [8.47156075]
curr_Stock_Price:  101.82193194744292
curr_Factors:  [101.82193195]
mat_Sqrt:  [[0.15]]
grads:  [0.02845798]
Stock Position:  0.02845797604086663
Bond Position:  [5.57391465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.47156075]
Stock Price:  101.39075981990806
PL:  [7.08080093]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.78931667e-02]
 [-6.63056855e-03]
 [ 1.56994989e-02]
 [ 3.46434139e-03]
 [ 5.83626804e-03]
 [-1.69175734e-02]
 [-3.08979731e-03]
 [-1.11341926e-03]
 [-8.99215348e-04]
 [ 2.92989486e-02]
 [-9.27899134e-03]
 [-2.02696226e-02]
 [-1.08201500e-03]
 [-1.96461669e-02]
 [-1.15220287e-03]
 [ 1.06990612e-02]
 [-3.18097286e-03]
 [-1.82862268e-02]
 [ 4.55136254e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.1861323]
curr_Stock_Price:  102.31609799528987
curr_Factors:  [102.316098]
mat_Sqrt:  [[0.15]]
grads:  [-0.25262111]
Stock Position:  -0.25262111133655973
Bond Position:  [63.03333868]


portfolio before change:  [37.16654416]
curr_Stock_Price:  102.456024728503
curr_Factors:  [102.45602473]
mat_Sqrt:  [[0.15]]
grads:  [-0.04420379]
Stock Position:  -0.04420379032853041
Bond Position:  [41.69548879]


portfolio before change:  [37.16498123]
curr_Stock_Price:  102.72722549955066
curr_Factors:  [102.7272255]
mat_Sqrt:  [[0.15]]
grads:  [0.10466333]
Stock Position:  0.10466332587850606
Bond Position:  [26.41320815]


portfolio before change:  [37.08094435]
curr_Stock_Price:  101.86120096935392
curr_Factors:  [101.86120097]
mat_Sqrt:  [[0.15]]
grads:  [0.02309561]
Stock Position:  0.023095609277356394
Bond Position:  [34.72839785]


portfolio before change:  [37.10255716]
curr_Stock_Price:  102.42103126365284
curr_Factors:  [102.42103126]
mat_Sqrt:  [[0.15]]
grads:  [0.03890845]
Stock Position:  0.038908453615080385
Bond Position:  [33.11751321]


portfolio before change:  [37.13835396]
curr_Stock_Price:  103.12823983132311
curr_Factors:  [103.12823983]
mat_Sqrt:  [[0.15]]
grads:  [-0.11278382]
Stock Position:  -0.1127838224385981
Bond Position:  [48.76955105]


portfolio before change:  [37.44309284]
curr_Stock_Price:  100.53438407637512
curr_Factors:  [100.53438408]
mat_Sqrt:  [[0.15]]
grads:  [-0.02059865]
Stock Position:  -0.02059864870175549
Bond Position:  [39.5139653]


portfolio before change:  [37.44019147]
curr_Stock_Price:  101.15486653875872
curr_Factors:  [101.15486654]
mat_Sqrt:  [[0.15]]
grads:  [-0.0074228]
Stock Position:  -0.0074227950594262775
Bond Position:  [38.19104331]


portfolio before change:  [37.44670167]
curr_Stock_Price:  101.56424742819513
curr_Factors:  [101.56424743]
mat_Sqrt:  [[0.15]]
grads:  [-0.00599477]
Stock Position:  -0.005994768984108
Bond Position:  [38.05555587]


portfolio before change:  [37.45262578]
curr_Stock_Price:  102.163265275048
curr_Factors:  [102.16326528]
mat_Sqrt:  [[0.15]]
grads:  [0.19532632]
Stock Position:  0.19532632400324318
Bond Position:  [17.49745072]


portfolio before change:  [37.55951219]
curr_Stock_Price:  102.68808702243872
curr_Factors:  [102.68808702]
mat_Sqrt:  [[0.15]]
grads:  [-0.06185994]
Stock Position:  -0.06185994229089076
Bond Position:  [43.91179132]


portfolio before change:  [37.51663741]
curr_Stock_Price:  103.55866820436707
curr_Factors:  [103.5586682]
mat_Sqrt:  [[0.15]]
grads:  [-0.13513082]
Stock Position:  -0.1351308176389618
Bond Position:  [51.51060491]


portfolio before change:  [37.51877118]
curr_Stock_Price:  103.63818738001304
curr_Factors:  [103.63818738]
mat_Sqrt:  [[0.15]]
grads:  [-0.00721343]
Stock Position:  -0.007213433340704489
Bond Position:  [38.26635833]


portfolio before change:  [37.5387591]
curr_Stock_Price:  102.19364041212921
curr_Factors:  [102.19364041]
mat_Sqrt:  [[0.15]]
grads:  [-0.13097445]
Stock Position:  -0.13097444577139258
Bond Position:  [50.92351452]


portfolio before change:  [37.60968293]
curr_Stock_Price:  101.74934489187287
curr_Factors:  [101.74934489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00768135]
Stock Position:  -0.007681352480545488
Bond Position:  [38.39125552]


portfolio before change:  [37.62360094]
curr_Stock_Price:  101.18707477253609
curr_Factors:  [101.18707477]
mat_Sqrt:  [[0.15]]
grads:  [0.07132707]
Stock Position:  0.07132707462385458
Bond Position:  [30.40622291]


portfolio before change:  [37.59737603]
curr_Stock_Price:  100.71281705929083
curr_Factors:  [100.71281706]
mat_Sqrt:  [[0.15]]
grads:  [-0.02120649]
Stock Position:  -0.021206485766118076
Bond Position:  [39.73314096]


portfolio before change:  [37.58724159]
curr_Stock_Price:  101.65917687563598
curr_Factors:  [101.65917688]
mat_Sqrt:  [[0.15]]
grads:  [-0.12190818]
Stock Position:  -0.12190817861991994
Bond Position:  [49.98032669]


portfolio before change:  [37.52381336]
curr_Stock_Price:  102.28198065602143
curr_Factors:  [102.28198066]
mat_Sqrt:  [[0.15]]
grads:  [0.03034242]
Stock Position:  0.030342416932755047
Bond Position:  [34.42033086]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [37.52381336]
Stock Price:  99.94182595444093
PL:  [37.52381336]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.67307924e-02]
 [ 8.72438605e-03]
 [-6.20522042e-03]
 [ 3.29176096e-03]
 [ 7.18217342e-03]
 [ 8.34695117e-03]
 [-9.53403815e-03]
 [-1.13480687e-03]
 [ 9.88283508e-04]
 [-3.29315745e-02]
 [-1.05195338e-03]
 [-2.61727505e-02]
 [ 2.29696790e-03]
 [ 4.55886215e-03]
 [-2.60361509e-03]
 [ 1.06397383e-02]
 [ 4.20546407e-02]
 [ 1.62370279e-02]
 [ 4.22334400e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.23503138]
curr_Stock_Price:  100.3574757639319
curr_Factors:  [100.35747576]
mat_Sqrt:  [[0.15]]
grads:  [0.24487195]
Stock Position:  0.24487194958134006
Bond Position:  [-17.33969937]


portfolio before change:  [6.70636584]
curr_Stock_Price:  98.21623391369218
curr_Factors:  [98.21623391]
mat_Sqrt:  [[0.15]]
grads:  [0.05816257]
Stock Position:  0.058162573681286855
Bond Position:  [0.9938569]


portfolio before change:  [6.81058238]
curr_Stock_Price:  100.00377594031313
curr_Factors:  [100.00377594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04136814]
Stock Position:  -0.04136813612944614
Bond Position:  [10.9475522]


portfolio before change:  [6.81432853]
curr_Stock_Price:  99.9793872918125
curr_Factors:  [99.97938729]
mat_Sqrt:  [[0.15]]
grads:  [0.02194507]
Stock Position:  0.021945073092770433
Bond Position:  [4.62027357]


portfolio before change:  [6.82443527]
curr_Stock_Price:  100.38729347449488
curr_Factors:  [100.38729347]
mat_Sqrt:  [[0.15]]
grads:  [0.04788116]
Stock Position:  0.04788115610666282
Bond Position:  [2.0177756]


portfolio before change:  [6.81289931]
curr_Stock_Price:  100.13582783915123
curr_Factors:  [100.13582784]
mat_Sqrt:  [[0.15]]
grads:  [0.05564634]
Stock Position:  0.05564634113967692
Bond Position:  [1.24070688]


portfolio before change:  [6.80962645]
curr_Stock_Price:  100.0714376096682
curr_Factors:  [100.07143761]
mat_Sqrt:  [[0.15]]
grads:  [-0.06356025]
Stock Position:  -0.06356025431360461
Bond Position:  [13.17019247]


portfolio before change:  [6.84923934]
curr_Stock_Price:  99.50001244280595
curr_Factors:  [99.50001244]
mat_Sqrt:  [[0.15]]
grads:  [-0.00756538]
Stock Position:  -0.0075653791122899505
Bond Position:  [7.60199465]


portfolio before change:  [6.85978228]
curr_Stock_Price:  98.35767599623762
curr_Factors:  [98.357676]
mat_Sqrt:  [[0.15]]
grads:  [0.00658856]
Stock Position:  0.006588556716905402
Bond Position:  [6.21174715]


portfolio before change:  [6.86695646]
curr_Stock_Price:  99.21082924634882
curr_Factors:  [99.21082925]
mat_Sqrt:  [[0.15]]
grads:  [-0.21954383]
Stock Position:  -0.2195438300201747
Bond Position:  [28.64808189]


portfolio before change:  [6.92237741]
curr_Stock_Price:  98.9910187566845
curr_Factors:  [98.99101876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00701302]
Stock Position:  -0.007013022557200745
Bond Position:  [7.61660366]


portfolio before change:  [6.92684378]
curr_Stock_Price:  98.62570190925696
curr_Factors:  [98.62570191]
mat_Sqrt:  [[0.15]]
grads:  [-0.174485]
Stock Position:  -0.17448500319821797
Bond Position:  [24.13554969]


portfolio before change:  [6.90194886]
curr_Stock_Price:  98.80296387311637
curr_Factors:  [98.80296387]
mat_Sqrt:  [[0.15]]
grads:  [0.01531312]
Stock Position:  0.01531311936607649
Bond Position:  [5.38896728]


portfolio before change:  [6.90318935]
curr_Stock_Price:  98.7959811945652
curr_Factors:  [98.79598119]
mat_Sqrt:  [[0.15]]
grads:  [0.03039241]
Stock Position:  0.030392414317952747
Bond Position:  [3.90054095]


portfolio before change:  [6.91147992]
curr_Stock_Price:  99.03667653977415
curr_Factors:  [99.03667654]
mat_Sqrt:  [[0.15]]
grads:  [-0.01735743]
Stock Position:  -0.017357433958043636
Bond Position:  [8.63050249]


portfolio before change:  [6.95922638]
curr_Stock_Price:  96.41021898996122
curr_Factors:  [96.41021899]
mat_Sqrt:  [[0.15]]
grads:  [0.07093159]
Stock Position:  0.07093158891160664
Bond Position:  [0.12069636]


portfolio before change:  [6.9111973]
curr_Stock_Price:  95.732675220956
curr_Factors:  [95.73267522]
mat_Sqrt:  [[0.15]]
grads:  [0.28036427]
Stock Position:  0.28036427105305
Bond Position:  [-19.92882441]


portfolio before change:  [6.50893155]
curr_Stock_Price:  94.3156511650173
curr_Factors:  [94.31565117]
mat_Sqrt:  [[0.15]]
grads:  [0.10824685]
Stock Position:  0.1082468524052054
Bond Position:  [-3.70044082]


portfolio before change:  [6.35178589]
curr_Stock_Price:  92.87246429445429
curr_Factors:  [92.87246429]
mat_Sqrt:  [[0.15]]
grads:  [0.00281556]
Stock Position:  0.002815562667519781
Bond Position:  [6.09029765]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.35178589]
Stock Price:  94.49415042796889
PL:  [6.35178589]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.31889156e-02]
 [-3.60428479e-03]
 [-8.85837738e-03]
 [ 3.96159000e-03]
 [ 7.87234692e-03]
 [ 5.03562559e-03]
 [-1.35504220e-02]
 [ 3.61100009e-03]
 [-7.45615992e-04]
 [-2.83273874e-02]
 [-1.00727501e-03]
 [-2.63491679e-02]
 [ 2.69196477e-03]
 [-1.01394868e-03]
 [-1.92818133e-03]
 [ 1.19884298e-02]
 [ 5.04498963e-02]
 [ 2.07759740e-02]
 [ 3.33102433e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.77751649]
curr_Stock_Price:  99.1141692485886
curr_Factors:  [99.11416925]
mat_Sqrt:  [[0.15]]
grads:  [0.15459277]
Stock Position:  0.1545927709603702
Bond Position:  [-27.09985055]


portfolio before change:  [-11.63397698]
curr_Stock_Price:  100.08650004837367
curr_Factors:  [100.08650005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02402857]
Stock Position:  -0.02402856526718141
Bond Position:  [-9.22904198]


portfolio before change:  [-11.63754485]
curr_Stock_Price:  100.1389507776843
curr_Factors:  [100.13895078]
mat_Sqrt:  [[0.15]]
grads:  [-0.05905585]
Stock Position:  -0.059055849204573733
Bond Position:  [-5.72375407]


portfolio before change:  [-11.5787313]
curr_Stock_Price:  99.11882049030635
curr_Factors:  [99.11882049]
mat_Sqrt:  [[0.15]]
grads:  [0.0264106]
Stock Position:  0.026410599983150655
Bond Position:  [-14.19651882]


portfolio before change:  [-11.56851998]
curr_Stock_Price:  99.6398575334489
curr_Factors:  [99.63985753]
mat_Sqrt:  [[0.15]]
grads:  [0.05248231]
Stock Position:  0.05248231282853661
Bond Position:  [-16.79785015]


portfolio before change:  [-11.55721285]
curr_Stock_Price:  99.93533074617622
curr_Factors:  [99.93533075]
mat_Sqrt:  [[0.15]]
grads:  [0.03357084]
Stock Position:  0.03357083724638009
Bond Position:  [-14.91212557]


portfolio before change:  [-11.61822433]
curr_Stock_Price:  98.22899884538427
curr_Factors:  [98.22899885]
mat_Sqrt:  [[0.15]]
grads:  [-0.09033615]
Stock Position:  -0.0903361464099928
Bond Position:  [-2.74459511]


portfolio before change:  [-11.59810951]
curr_Stock_Price:  97.99873601454028
curr_Factors:  [97.99873601]
mat_Sqrt:  [[0.15]]
grads:  [0.02407333]
Stock Position:  0.024073333963945467
Bond Position:  [-13.95726581]


portfolio before change:  [-11.55322437]
curr_Stock_Price:  100.00821629929482
curr_Factors:  [100.0082163]
mat_Sqrt:  [[0.15]]
grads:  [-0.00497077]
Stock Position:  -0.004970773280107154
Bond Position:  [-11.05610621]


portfolio before change:  [-11.5535258]
curr_Stock_Price:  99.51272989466179
curr_Factors:  [99.51272989]
mat_Sqrt:  [[0.15]]
grads:  [-0.18884925]
Stock Position:  -0.18884924934050032
Bond Position:  [7.23937854]


portfolio before change:  [-11.28900755]
curr_Stock_Price:  98.1216299566335
curr_Factors:  [98.12162996]
mat_Sqrt:  [[0.15]]
grads:  [-0.00671517]
Stock Position:  -0.006715166729125341
Bond Position:  [-10.63010444]


portfolio before change:  [-11.28532366]
curr_Stock_Price:  97.17723939957209
curr_Factors:  [97.1772394]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566112]
Stock Position:  -0.17566111906316925
Bond Position:  [5.78493896]


portfolio before change:  [-11.19998243]
curr_Stock_Price:  96.69964470646309
curr_Factors:  [96.69964471]
mat_Sqrt:  [[0.15]]
grads:  [0.01794643]
Stock Position:  0.01794643178203014
Bond Position:  [-12.93539601]


portfolio before change:  [-11.20577741]
curr_Stock_Price:  96.5569576640054
curr_Factors:  [96.55695766]
mat_Sqrt:  [[0.15]]
grads:  [-0.00675966]
Stock Position:  -0.006759657895553101
Bond Position:  [-10.55308541]


portfolio before change:  [-11.21371395]
curr_Stock_Price:  97.34071632434184
curr_Factors:  [97.34071632]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285454]
Stock Position:  -0.012854542197155809
Bond Position:  [-9.9624436]


portfolio before change:  [-11.21988074]
curr_Stock_Price:  97.62667516642695
curr_Factors:  [97.62667517]
mat_Sqrt:  [[0.15]]
grads:  [0.07992287]
Stock Position:  0.07992286518028527
Bond Position:  [-19.02248434]


portfolio before change:  [-11.21894539]
curr_Stock_Price:  97.69788838340718
curr_Factors:  [97.69788838]
mat_Sqrt:  [[0.15]]
grads:  [0.33633264]
Stock Position:  0.33633264222045944
Bond Position:  [-44.07793433]


portfolio before change:  [-11.39355999]
curr_Stock_Price:  97.2114837984862
curr_Factors:  [97.2114838]
mat_Sqrt:  [[0.15]]
grads:  [0.13850649]
Stock Position:  0.13850649339394072
Bond Position:  [-24.85798173]


portfolio before change:  [-11.52930087]
curr_Stock_Price:  96.27632472077244
curr_Factors:  [96.27632472]
mat_Sqrt:  [[0.15]]
grads:  [0.02220683]
Stock Position:  0.022206828888920487
Bond Position:  [-13.66729274]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.52930087]
Stock Price:  96.81527295511687
PL:  [-11.52930087]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.29378849]
 [-0.03884143]
 [-0.00748103]
 [ 0.03771589]
 [-0.00630955]
 [ 0.0049077 ]
 [-0.04107322]
 [-0.01282441]
 [ 0.00229995]
 [ 0.00524981]
 [ 0.07288796]
 [-0.01275552]
 [-0.01903141]
 [-0.00245333]
 [-0.02545307]
 [ 0.00672808]
 [ 0.00856192]
 [-0.04600715]
 [-0.02598841]
 [ 0.00402972]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.57995933]
curr_Stock_Price:  101.81869993579579
curr_Factors:  [101.81869994]
mat_Sqrt:  [[0.15]]
grads:  [-0.25894289]
Stock Position:  -0.25894288627158574
Bond Position:  [55.94518737]


portfolio before change:  [29.59538248]
curr_Stock_Price:  101.81315775218759
curr_Factors:  [101.81315775]
mat_Sqrt:  [[0.15]]
grads:  [-0.04987355]
Stock Position:  -0.0498735489282235
Bond Position:  [34.67316599]


portfolio before change:  [29.49051774]
curr_Stock_Price:  104.08959721933239
curr_Factors:  [104.08959722]
mat_Sqrt:  [[0.15]]
grads:  [0.25143925]
Stock Position:  0.25143925488569385
Bond Position:  [3.31830698]


portfolio before change:  [29.47159647]
curr_Stock_Price:  104.01104564717913
curr_Factors:  [104.01104565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04206368]
Stock Position:  -0.04206368338754897
Bond Position:  [33.84668417]


portfolio before change:  [29.46832874]
curr_Stock_Price:  104.28991950215087
curr_Factors:  [104.2899195]
mat_Sqrt:  [[0.15]]
grads:  [0.032718]
Stock Position:  0.03271799984154557
Bond Position:  [26.05617117]


portfolio before change:  [29.48876146]
curr_Stock_Price:  104.7153081311621
curr_Factors:  [104.71530813]
mat_Sqrt:  [[0.15]]
grads:  [-0.27382144]
Stock Position:  -0.2738214379361246
Bond Position:  [58.16205771]


portfolio before change:  [28.77660018]
curr_Stock_Price:  107.3692406288205
curr_Factors:  [107.36924063]
mat_Sqrt:  [[0.15]]
grads:  [-0.08549606]
Stock Position:  -0.08549605892998931
Bond Position:  [37.95624711]


portfolio before change:  [28.73501511]
curr_Stock_Price:  107.96664033072781
curr_Factors:  [107.96664033]
mat_Sqrt:  [[0.15]]
grads:  [0.01533297]
Stock Position:  0.015332971923207829
Bond Position:  [27.07956565]


portfolio before change:  [28.71524454]
curr_Stock_Price:  106.23564485148854
curr_Factors:  [106.23564485]
mat_Sqrt:  [[0.15]]
grads:  [0.03499872]
Stock Position:  0.03499871701958507
Bond Position:  [24.99713327]


portfolio before change:  [28.70744138]
curr_Stock_Price:  105.8341092238594
curr_Factors:  [105.83410922]
mat_Sqrt:  [[0.15]]
grads:  [0.48591973]
Stock Position:  0.4859197348837461
Bond Position:  [-22.71944092]


portfolio before change:  [28.144274]
curr_Stock_Price:  104.68682755847765
curr_Factors:  [104.68682756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08503683]
Stock Position:  -0.08503682995656156
Bond Position:  [37.04650996]


portfolio before change:  [28.12324039]
curr_Stock_Price:  105.04310136301014
curr_Factors:  [105.04310136]
mat_Sqrt:  [[0.15]]
grads:  [-0.12687604]
Stock Position:  -0.12687603993703536
Bond Position:  [41.45069312]


portfolio before change:  [27.9764544]
curr_Stock_Price:  106.2817116253908
curr_Factors:  [106.28171163]
mat_Sqrt:  [[0.15]]
grads:  [-0.01635556]
Stock Position:  -0.01635556037755498
Bond Position:  [29.71475135]


portfolio before change:  [27.97009726]
curr_Stock_Price:  107.12465174267611
curr_Factors:  [107.12465174]
mat_Sqrt:  [[0.15]]
grads:  [-0.16968716]
Stock Position:  -0.1696871630168569
Bond Position:  [46.1477755]


portfolio before change:  [28.45242089]
curr_Stock_Price:  104.35022120811698
curr_Factors:  [104.35022121]
mat_Sqrt:  [[0.15]]
grads:  [0.04485384]
Stock Position:  0.04485383735032207
Bond Position:  [23.77191304]


portfolio before change:  [28.40430056]
curr_Stock_Price:  103.14488286842366
curr_Factors:  [103.14488287]
mat_Sqrt:  [[0.15]]
grads:  [0.05707949]
Stock Position:  0.05707949413497486
Bond Position:  [22.51684282]


portfolio before change:  [28.39087017]
curr_Stock_Price:  102.81095724406005
curr_Factors:  [102.81095724]
mat_Sqrt:  [[0.15]]
grads:  [-0.30671431]
Stock Position:  -0.30671430667020577
Bond Position:  [59.92446164]


portfolio before change:  [28.62660045]
curr_Stock_Price:  102.0912409053238
curr_Factors:  [102.09124091]
mat_Sqrt:  [[0.15]]
grads:  [-0.17325606]
Stock Position:  -0.1732560552567195
Bond Position:  [46.31452613]


portfolio before change:  [28.72626615]
curr_Stock_Price:  101.58282798805247
curr_Factors:  [101.58282799]
mat_Sqrt:  [[0.15]]
grads:  [0.02686479]
Stock Position:  0.02686479396684786
Bond Position:  [25.9972644]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.72626615]
Stock Price:  101.35398613106665
PL:  [27.37228002]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.51596766e-01]
 [ 8.86874089e-03]
 [ 9.76417961e-03]
 [ 3.90924579e-03]
 [ 8.43443966e-03]
 [ 1.15208281e-02]
 [-1.58099025e-02]
 [-2.03714239e-03]
 [-8.75556770e-04]
 [-3.80109349e-02]
 [-9.28348265e-04]
 [-2.63627469e-02]
 [ 2.16507252e-03]
 [-6.50059844e-03]
 [-7.24789727e-04]
 [ 8.95715267e-03]
 [ 3.37777078e-02]
 [ 1.91201818e-02]
 [ 2.56313140e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.34968381]
curr_Stock_Price:  98.09584297080978
curr_Factors:  [98.09584297]
mat_Sqrt:  [[0.15]]
grads:  [1.01064511]
Stock Position:  1.0106451096182105
Bond Position:  [-126.48976779]


portfolio before change:  [-27.65142846]
curr_Stock_Price:  97.8285698687618
curr_Factors:  [97.82856987]
mat_Sqrt:  [[0.15]]
grads:  [0.05912494]
Stock Position:  0.05912493929013707
Bond Position:  [-33.43553672]


portfolio before change:  [-27.6364087]
curr_Stock_Price:  98.22399838644289
curr_Factors:  [98.22399839]
mat_Sqrt:  [[0.15]]
grads:  [0.06509453]
Stock Position:  0.06509453070930635
Bond Position:  [-34.03025378]


portfolio before change:  [-27.58139931]
curr_Stock_Price:  99.1997796486268
curr_Factors:  [99.19977965]
mat_Sqrt:  [[0.15]]
grads:  [0.02606164]
Stock Position:  0.026061638607135368
Bond Position:  [-30.16670811]


portfolio before change:  [-27.59892128]
curr_Stock_Price:  98.81686606032282
curr_Factors:  [98.81686606]
mat_Sqrt:  [[0.15]]
grads:  [0.0562296]
Stock Position:  0.056229597728805446
Bond Position:  [-33.15535391]


portfolio before change:  [-27.63038781]
curr_Stock_Price:  98.40468720852235
curr_Factors:  [98.40468721]
mat_Sqrt:  [[0.15]]
grads:  [0.07680552]
Stock Position:  0.07680552082949726
Bond Position:  [-35.18841106]


portfolio before change:  [-27.5806363]
curr_Stock_Price:  99.16699843070975
curr_Factors:  [99.16699843]
mat_Sqrt:  [[0.15]]
grads:  [-0.10539935]
Stock Position:  -0.10539934984797282
Bond Position:  [-17.12849914]


portfolio before change:  [-27.67136665]
curr_Stock_Price:  99.98719028773041
curr_Factors:  [99.98719029]
mat_Sqrt:  [[0.15]]
grads:  [-0.01358095]
Stock Position:  -0.013580949293384834
Bond Position:  [-26.31344569]


portfolio before change:  [-27.68013218]
curr_Stock_Price:  100.14817675488776
curr_Factors:  [100.14817675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00583705]
Stock Position:  -0.005837045135081305
Bond Position:  [-27.09556275]


portfolio before change:  [-27.67828819]
curr_Stock_Price:  98.67161984722614
curr_Factors:  [98.67161985]
mat_Sqrt:  [[0.15]]
grads:  [-0.25340623]
Stock Position:  -0.25340623235051757
Bond Position:  [-2.67428476]


portfolio before change:  [-27.15039913]
curr_Stock_Price:  96.58580801205552
curr_Factors:  [96.58580801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00618899]
Stock Position:  -0.006188988433463219
Bond Position:  [-26.55263068]


portfolio before change:  [-27.1544971]
curr_Stock_Price:  96.17523747191849
curr_Factors:  [96.17523747]
mat_Sqrt:  [[0.15]]
grads:  [-0.17575165]
Stock Position:  -0.17575164586090736
Bond Position:  [-10.25154082]


portfolio before change:  [-26.86029742]
curr_Stock_Price:  94.48670202859797
curr_Factors:  [94.48670203]
mat_Sqrt:  [[0.15]]
grads:  [0.01443382]
Stock Position:  0.014433816784388358
Bond Position:  [-28.22410117]


portfolio before change:  [-26.88964037]
curr_Stock_Price:  92.94268583026361
curr_Factors:  [92.94268583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04333732]
Stock Position:  -0.043337322935467555
Bond Position:  [-22.86175318]


portfolio before change:  [-26.99799348]
curr_Stock_Price:  95.31101291730428
curr_Factors:  [95.31101292]
mat_Sqrt:  [[0.15]]
grads:  [-0.00483193]
Stock Position:  -0.004831931515793275
Bond Position:  [-26.5374572]


portfolio before change:  [-27.00555513]
curr_Stock_Price:  95.50274805906722
curr_Factors:  [95.50274806]
mat_Sqrt:  [[0.15]]
grads:  [0.05971435]
Stock Position:  0.05971435113525966
Bond Position:  [-32.70843976]


portfolio before change:  [-27.03213488]
curr_Stock_Price:  95.19458728603774
curr_Factors:  [95.19458729]
mat_Sqrt:  [[0.15]]
grads:  [0.22518472]
Stock Position:  0.22518471833865786
Bond Position:  [-48.46850121]


portfolio before change:  [-26.89616836]
curr_Stock_Price:  95.85220366514228
curr_Factors:  [95.85220367]
mat_Sqrt:  [[0.15]]
grads:  [0.12746788]
Stock Position:  0.12746787884814037
Bond Position:  [-39.11424544]


portfolio before change:  [-26.96638887]
curr_Stock_Price:  95.37803929522164
curr_Factors:  [95.3780393]
mat_Sqrt:  [[0.15]]
grads:  [0.01708754]
Stock Position:  0.01708754266829303
Bond Position:  [-28.59616519]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.96638887]
Stock Price:  93.91051875865334
PL:  [-26.96638887]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.43953429e-02]
 [-3.14660227e-03]
 [ 1.77170528e-03]
 [ 2.50797159e-03]
 [ 6.65089537e-03]
 [ 1.09487318e-02]
 [-1.09047094e-03]
 [ 7.91138407e-04]
 [ 1.28833987e-03]
 [ 4.08445960e-02]
 [-7.48633158e-03]
 [-2.10368499e-02]
 [ 1.78734417e-05]
 [-2.00341114e-02]
 [-3.27137679e-03]
 [ 1.05692764e-02]
 [ 3.22231499e-02]
 [-6.50818155e-03]
 [ 3.84473706e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.50344554]
curr_Stock_Price:  99.45906183303383
curr_Factors:  [99.45906183]
mat_Sqrt:  [[0.15]]
grads:  [0.09596895]
Stock Position:  0.09596895256510206
Bond Position:  [-16.04842753]


portfolio before change:  [-6.45073272]
curr_Stock_Price:  100.05014291696547
curr_Factors:  [100.05014292]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097735]
Stock Position:  -0.02097734848658229
Bond Position:  [-4.351946]


portfolio before change:  [-6.43502177]
curr_Stock_Price:  99.24932356164364
curr_Factors:  [99.24932356]
mat_Sqrt:  [[0.15]]
grads:  [0.01181137]
Stock Position:  0.011811368535590179
Bond Position:  [-7.60729211]


portfolio before change:  [-6.42165015]
curr_Stock_Price:  100.54245768561415
curr_Factors:  [100.54245769]
mat_Sqrt:  [[0.15]]
grads:  [0.01671981]
Stock Position:  0.016719810608227508
Bond Position:  [-8.102701]


portfolio before change:  [-6.41395775]
curr_Stock_Price:  101.12370383997398
curr_Factors:  [101.12370384]
mat_Sqrt:  [[0.15]]
grads:  [0.0443393]
Stock Position:  0.044339302486580995
Bond Position:  [-10.89771224]


portfolio before change:  [-6.4317685]
curr_Stock_Price:  100.7834642901989
curr_Factors:  [100.78346429]
mat_Sqrt:  [[0.15]]
grads:  [0.07299155]
Stock Position:  0.07299154518330485
Bond Position:  [-13.78810929]


portfolio before change:  [-6.32750078]
curr_Stock_Price:  102.25918567145756
curr_Factors:  [102.25918567]
mat_Sqrt:  [[0.15]]
grads:  [-0.00726981]
Stock Position:  -0.007269806270760749
Bond Position:  [-5.58409631]


portfolio before change:  [-6.33648509]
curr_Stock_Price:  103.30297096271286
curr_Factors:  [103.30297096]
mat_Sqrt:  [[0.15]]
grads:  [0.00527426]
Stock Position:  0.005274256049503089
Bond Position:  [-6.88133141]


portfolio before change:  [-6.33629474]
curr_Stock_Price:  103.66527779454621
curr_Factors:  [103.66527779]
mat_Sqrt:  [[0.15]]
grads:  [0.00858893]
Stock Position:  0.008588932445797934
Bond Position:  [-7.22666881]


portfolio before change:  [-6.34525605]
curr_Stock_Price:  102.8322977130624
curr_Factors:  [102.83229771]
mat_Sqrt:  [[0.15]]
grads:  [0.27229731]
Stock Position:  0.2722973065123512
Bond Position:  [-34.34621374]


portfolio before change:  [-6.5524491]
curr_Stock_Price:  102.10292792470263
curr_Factors:  [102.10292792]
mat_Sqrt:  [[0.15]]
grads:  [-0.04990888]
Stock Position:  -0.04990887717786804
Bond Position:  [-1.45660661]


portfolio before change:  [-6.58855894]
curr_Stock_Price:  102.81914599269251
curr_Factors:  [102.81914599]
mat_Sqrt:  [[0.15]]
grads:  [-0.14024567]
Stock Position:  -0.14024566631561697
Bond Position:  [7.8313807]


portfolio before change:  [-6.37373413]
curr_Stock_Price:  101.30133281270365
curr_Factors:  [101.30133281]
mat_Sqrt:  [[0.15]]
grads:  [0.00011916]
Stock Position:  0.00011915627802285637
Bond Position:  [-6.38580482]


portfolio before change:  [-6.37518094]
curr_Stock_Price:  102.55880967515698
curr_Factors:  [102.55880968]
mat_Sqrt:  [[0.15]]
grads:  [-0.13356074]
Stock Position:  -0.13356074280666175
Bond Position:  [7.32264986]


portfolio before change:  [-5.99649626]
curr_Stock_Price:  99.73721868384146
curr_Factors:  [99.73721868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02180918]
Stock Position:  -0.021809178630178956
Bond Position:  [-3.82130944]


portfolio before change:  [-6.00551128]
curr_Stock_Price:  100.10676800923281
curr_Factors:  [100.10676801]
mat_Sqrt:  [[0.15]]
grads:  [0.07046184]
Stock Position:  0.07046184268491627
Bond Position:  [-13.05921862]


portfolio before change:  [-6.02726491]
curr_Stock_Price:  99.84437889628732
curr_Factors:  [99.8443789]
mat_Sqrt:  [[0.15]]
grads:  [0.214821]
Stock Position:  0.21482099953969325
Bond Position:  [-27.47593418]


portfolio before change:  [-5.73348908]
curr_Stock_Price:  101.24389604217421
curr_Factors:  [101.24389604]
mat_Sqrt:  [[0.15]]
grads:  [-0.04338788]
Stock Position:  -0.04338787700412426
Bond Position:  [-1.34073137]


portfolio before change:  [-5.71686991]
curr_Stock_Price:  100.8531326939336
curr_Factors:  [100.85313269]
mat_Sqrt:  [[0.15]]
grads:  [0.02563158]
Stock Position:  0.025631580374847435
Bond Position:  [-8.30189509]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.71686991]
Stock Price:  101.45478287440433
PL:  [-7.17165279]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.59729966e-02]
 [-5.18157061e-04]
 [-1.61140460e-03]
 [-2.02282852e-04]
 [ 8.80648252e-03]
 [ 1.29586556e-02]
 [-1.49788764e-02]
 [ 1.75292071e-03]
 [ 1.35192226e-03]
 [-3.79950035e-02]
 [-1.02354506e-03]
 [-2.63578389e-02]
 [ 2.59250207e-03]
 [-1.38438041e-03]
 [-1.85293862e-03]
 [ 1.11658325e-02]
 [ 4.82775129e-02]
 [ 2.05544188e-02]
 [ 4.11527080e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.42340234]
curr_Stock_Price:  100.63137008597958
curr_Factors:  [100.63137009]
mat_Sqrt:  [[0.15]]
grads:  [0.17315331]
Stock Position:  0.173153310881316
Bond Position:  [-6.00125257]


portfolio before change:  [11.28510654]
curr_Stock_Price:  99.8413459356283
curr_Factors:  [99.84134594]
mat_Sqrt:  [[0.15]]
grads:  [-0.00345438]
Stock Position:  -0.003454380405254395
Bond Position:  [11.62999653]


portfolio before change:  [11.28878506]
curr_Stock_Price:  99.6182522359729
curr_Factors:  [99.61825224]
mat_Sqrt:  [[0.15]]
grads:  [-0.0107427]
Stock Position:  -0.010742697333100225
Bond Position:  [12.35895379]


portfolio before change:  [11.3179728]
curr_Stock_Price:  97.18891596298498
curr_Factors:  [97.18891596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00134855]
Stock Position:  -0.001348552347226464
Bond Position:  [11.44903715]


portfolio before change:  [11.32065221]
curr_Stock_Price:  97.32477485392953
curr_Factors:  [97.32477485]
mat_Sqrt:  [[0.15]]
grads:  [0.05870988]
Stock Position:  0.05870988343888997
Bond Position:  [5.60672602]


portfolio before change:  [11.37561416]
curr_Stock_Price:  98.23705906043008
curr_Factors:  [98.23705906]
mat_Sqrt:  [[0.15]]
grads:  [0.08639104]
Stock Position:  0.08639103720670396
Bond Position:  [2.88881274]


portfolio before change:  [11.4061284]
curr_Stock_Price:  98.58190895673346
curr_Factors:  [98.58190896]
mat_Sqrt:  [[0.15]]
grads:  [-0.09985918]
Stock Position:  -0.0998591757411516
Bond Position:  [21.25043657]


portfolio before change:  [11.41732671]
curr_Stock_Price:  98.52297555821852
curr_Factors:  [98.52297556]
mat_Sqrt:  [[0.15]]
grads:  [0.01168614]
Stock Position:  0.011686138057927259
Bond Position:  [10.26597362]


portfolio before change:  [11.41502918]
curr_Stock_Price:  98.10672647927791
curr_Factors:  [98.10672648]
mat_Sqrt:  [[0.15]]
grads:  [0.00901282]
Stock Position:  0.00901281508855003
Bond Position:  [10.5308114]


portfolio before change:  [11.42450037]
curr_Stock_Price:  98.86544066527436
curr_Factors:  [98.86544067]
mat_Sqrt:  [[0.15]]
grads:  [-0.25330002]
Stock Position:  -0.2533000235587638
Bond Position:  [36.46711881]


portfolio before change:  [11.54183176]
curr_Stock_Price:  98.43822604959924
curr_Factors:  [98.43822605]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682363]
Stock Position:  -0.006823633725054259
Bond Position:  [12.21353816]


portfolio before change:  [11.55785605]
curr_Stock_Price:  96.53740157613329
curr_Factors:  [96.53740158]
mat_Sqrt:  [[0.15]]
grads:  [-0.17571893]
Stock Position:  -0.1757189258074769
Bond Position:  [28.52130456]


portfolio before change:  [11.60988333]
curr_Stock_Price:  96.28190227790436
curr_Factors:  [96.28190228]
mat_Sqrt:  [[0.15]]
grads:  [0.01728335]
Stock Position:  0.01728334713262465
Bond Position:  [9.94580979]


portfolio before change:  [11.61290653]
curr_Stock_Price:  96.3129397301562
curr_Factors:  [96.31293973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0092292]
Stock Position:  -0.009229202705310219
Bond Position:  [12.50179817]


portfolio before change:  [11.60827111]
curr_Stock_Price:  97.15388559911358
curr_Factors:  [97.1538856]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235292]
Stock Position:  -0.012352924108223192
Bond Position:  [12.80840568]


portfolio before change:  [11.61696605]
curr_Stock_Price:  96.7092590589075
curr_Factors:  [96.70925906]
mat_Sqrt:  [[0.15]]
grads:  [0.07443888]
Stock Position:  0.07443888319458562
Bond Position:  [4.41803681]


portfolio before change:  [11.62411937]
curr_Stock_Price:  96.79051604854224
curr_Factors:  [96.79051605]
mat_Sqrt:  [[0.15]]
grads:  [0.32185009]
Stock Position:  0.32185008600954546
Bond Position:  [-19.52791654]


portfolio before change:  [11.84486301]
curr_Stock_Price:  97.49154497832362
curr_Factors:  [97.49154498]
mat_Sqrt:  [[0.15]]
grads:  [0.13702946]
Stock Position:  0.13702945838830982
Bond Position:  [-1.5143506]


portfolio before change:  [11.88343939]
curr_Stock_Price:  97.77582708320416
curr_Factors:  [97.77582708]
mat_Sqrt:  [[0.15]]
grads:  [0.02743514]
Stock Position:  0.02743513867979606
Bond Position:  [9.20094602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.88343939]
Stock Price:  97.48521299773135
PL:  [11.88343939]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.87135238e-02]
 [ 1.63433440e-03]
 [ 3.30943658e-03]
 [ 3.77990923e-03]
 [ 7.66735978e-03]
 [ 9.51050078e-03]
 [-3.20093454e-04]
 [-4.15918280e-04]
 [-7.12351533e-04]
 [ 3.36010649e-02]
 [-1.26182684e-02]
 [-2.01810343e-02]
 [-2.56131094e-04]
 [-1.83898231e-02]
 [-3.28647536e-03]
 [ 1.19530948e-02]
 [ 5.04517435e-02]
 [ 2.00665411e-02]
 [ 3.92347272e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.10708034]
curr_Stock_Price:  100.02213854469508
curr_Factors:  [100.02213854]
mat_Sqrt:  [[0.15]]
grads:  [0.19142349]
Stock Position:  0.19142349180902657
Bond Position:  [-17.03950668]


portfolio before change:  [2.0396236]
curr_Stock_Price:  99.6919996906695
curr_Factors:  [99.69199969]
mat_Sqrt:  [[0.15]]
grads:  [0.01089556]
Stock Position:  0.010895562647428957
Bond Position:  [0.95342317]


portfolio before change:  [2.03330622]
curr_Stock_Price:  99.09030839677284
curr_Factors:  [99.0903084]
mat_Sqrt:  [[0.15]]
grads:  [0.02206291]
Stock Position:  0.022062910554773846
Bond Position:  [-0.15291439]


portfolio before change:  [2.04009673]
curr_Stock_Price:  99.39982049534612
curr_Factors:  [99.3998205]
mat_Sqrt:  [[0.15]]
grads:  [0.02519939]
Stock Position:  0.02519939484647109
Bond Position:  [-0.4647186]


portfolio before change:  [2.05175672]
curr_Stock_Price:  99.86714081787548
curr_Factors:  [99.86714082]
mat_Sqrt:  [[0.15]]
grads:  [0.05111573]
Stock Position:  0.05111573187811132
Bond Position:  [-3.05302527]


portfolio before change:  [2.12099681]
curr_Stock_Price:  101.23664943819799
curr_Factors:  [101.23664944]
mat_Sqrt:  [[0.15]]
grads:  [0.06340334]
Stock Position:  0.0634033385307732
Bond Position:  [-4.29774475]


portfolio before change:  [2.17226923]
curr_Stock_Price:  102.06226839551636
curr_Factors:  [102.0622684]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213396]
Stock Position:  -0.002133956359228623
Bond Position:  [2.39006566]


portfolio before change:  [2.17381044]
curr_Stock_Price:  101.62007539909578
curr_Factors:  [101.6200754]
mat_Sqrt:  [[0.15]]
grads:  [-0.00277279]
Stock Position:  -0.0027727885364422318
Bond Position:  [2.45558143]


portfolio before change:  [2.17386591]
curr_Stock_Price:  101.82149967193924
curr_Factors:  [101.82149967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474901]
Stock Position:  -0.004749010223182436
Bond Position:  [2.65741725]


portfolio before change:  [2.1717234]
curr_Stock_Price:  102.41255882051856
curr_Factors:  [102.41255882]
mat_Sqrt:  [[0.15]]
grads:  [0.2240071]
Stock Position:  0.22400709946010414
Bond Position:  [-20.76941685]


portfolio before change:  [2.65191762]
curr_Stock_Price:  104.57939737020453
curr_Factors:  [104.57939737]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412179]
Stock Position:  -0.08412178915483487
Bond Position:  [11.44932363]


portfolio before change:  [2.7317118]
curr_Stock_Price:  103.66487215631622
curr_Factors:  [103.66487216]
mat_Sqrt:  [[0.15]]
grads:  [-0.13454023]
Stock Position:  -0.13454022855834077
Bond Position:  [16.6788074]


portfolio before change:  [2.97585712]
curr_Stock_Price:  101.88120420048118
curr_Factors:  [101.8812042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00170754]
Stock Position:  -0.001707540624055389
Bond Position:  [3.14982342]


portfolio before change:  [2.97636163]
curr_Stock_Price:  102.04696455645036
curr_Factors:  [102.04696456]
mat_Sqrt:  [[0.15]]
grads:  [-0.12259882]
Stock Position:  -0.12259882053615617
Bond Position:  [15.48719913]


portfolio before change:  [3.25621541]
curr_Stock_Price:  99.79587034467693
curr_Factors:  [99.79587034]
mat_Sqrt:  [[0.15]]
grads:  [-0.02190984]
Stock Position:  -0.02190983573118019
Bond Position:  [5.44272654]


portfolio before change:  [3.30601387]
curr_Stock_Price:  97.58510016769802
curr_Factors:  [97.58510017]
mat_Sqrt:  [[0.15]]
grads:  [0.0796873]
Stock Position:  0.07968729842647998
Bond Position:  [-4.47027912]


portfolio before change:  [3.31374613]
curr_Stock_Price:  97.69615886789424
curr_Factors:  [97.69615887]
mat_Sqrt:  [[0.15]]
grads:  [0.33634496]
Stock Position:  0.3363449566383564
Bond Position:  [-29.54586419]


portfolio before change:  [3.44496557]
curr_Stock_Price:  98.1082561093994
curr_Factors:  [98.10825611]
mat_Sqrt:  [[0.15]]
grads:  [0.13377694]
Stock Position:  0.13377694074381008
Bond Position:  [-9.67965679]


portfolio before change:  [3.50034436]
curr_Stock_Price:  98.5403111906142
curr_Factors:  [98.54031119]
mat_Sqrt:  [[0.15]]
grads:  [0.02615648]
Stock Position:  0.026156484774801023
Bond Position:  [0.92287621]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.50034436]
Stock Price:  99.07400151930405
PL:  [3.50034436]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.03856354e-02]
 [-8.04660044e-03]
 [-1.03939350e-02]
 [ 3.52250181e-03]
 [ 5.66307137e-03]
 [-4.17026280e-03]
 [-5.74327271e-03]
 [ 9.33478491e-04]
 [ 2.41173850e-03]
 [ 6.25027335e-02]
 [-1.45510284e-02]
 [-1.91751109e-02]
 [-8.31467174e-04]
 [-1.90467654e-02]
 [ 1.46951612e-03]
 [ 8.58336316e-03]
 [-4.41734548e-02]
 [-1.88635296e-02]
 [ 4.53305758e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.7180836]
curr_Stock_Price:  100.45445847791741
curr_Factors:  [100.45445848]
mat_Sqrt:  [[0.15]]
grads:  [0.26923757]
Stock Position:  0.2692375694604575
Bond Position:  [-18.32803064]


portfolio before change:  [8.74935812]
curr_Stock_Price:  100.58763862165203
curr_Factors:  [100.58763862]
mat_Sqrt:  [[0.15]]
grads:  [-0.053644]
Stock Position:  -0.05364400295192115
Bond Position:  [14.1452817]


portfolio before change:  [8.74823392]
curr_Stock_Price:  100.67452550805403
curr_Factors:  [100.67452551]
mat_Sqrt:  [[0.15]]
grads:  [-0.0692929]
Stock Position:  -0.0692929002854365
Bond Position:  [15.72426378]


portfolio before change:  [8.66285332]
curr_Stock_Price:  101.96343323242503
curr_Factors:  [101.96343323]
mat_Sqrt:  [[0.15]]
grads:  [0.02348335]
Stock Position:  0.02348334541912061
Bond Position:  [6.2684108]


portfolio before change:  [8.68285209]
curr_Stock_Price:  102.74830726498404
curr_Factors:  [102.74830726]
mat_Sqrt:  [[0.15]]
grads:  [0.03775381]
Stock Position:  0.037753809159645
Bond Position:  [4.80371211]


portfolio before change:  [8.6639509]
curr_Stock_Price:  102.21585060189808
curr_Factors:  [102.2158506]
mat_Sqrt:  [[0.15]]
grads:  [-0.02780175]
Stock Position:  -0.027801751998999584
Bond Position:  [11.50573063]


portfolio before change:  [8.63255802]
curr_Stock_Price:  103.44849489381038
curr_Factors:  [103.44849489]
mat_Sqrt:  [[0.15]]
grads:  [-0.03828848]
Stock Position:  -0.0382884847244937
Bond Position:  [12.59344414]


portfolio before change:  [8.62443296]
curr_Stock_Price:  103.74293904277394
curr_Factors:  [103.74293904]
mat_Sqrt:  [[0.15]]
grads:  [0.00622319]
Stock Position:  0.006223189938595964
Bond Position:  [7.97882094]


portfolio before change:  [8.63048075]
curr_Stock_Price:  104.39418613353976
curr_Factors:  [104.39418613]
mat_Sqrt:  [[0.15]]
grads:  [0.01607826]
Stock Position:  0.016078256647515794
Bond Position:  [6.95200423]


portfolio before change:  [8.63993449]
curr_Stock_Price:  104.87405949065047
curr_Factors:  [104.87405949]
mat_Sqrt:  [[0.15]]
grads:  [0.41668489]
Stock Position:  0.4166848899812515
Bond Position:  [-35.05950145]


portfolio before change:  [9.13873517]
curr_Stock_Price:  106.09216617372357
curr_Factors:  [106.09216617]
mat_Sqrt:  [[0.15]]
grads:  [-0.09700686]
Stock Position:  -0.09700685620209974
Bond Position:  [19.43040268]


portfolio before change:  [9.26207222]
curr_Stock_Price:  104.87082109503407
curr_Factors:  [104.8708211]
mat_Sqrt:  [[0.15]]
grads:  [-0.12783407]
Stock Position:  -0.12783407250744133
Bond Position:  [22.66813637]


portfolio before change:  [9.48597119]
curr_Stock_Price:  103.16367662994467
curr_Factors:  [103.16367663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554311]
Stock Position:  -0.0055431144936214215
Bond Position:  [10.05781927]


portfolio before change:  [9.49023952]
curr_Stock_Price:  102.84732854374774
curr_Factors:  [102.84732854]
mat_Sqrt:  [[0.15]]
grads:  [-0.12697844]
Stock Position:  -0.1269784356843935
Bond Position:  [22.54963241]


portfolio before change:  [9.49260876]
curr_Stock_Price:  102.87307205344003
curr_Factors:  [102.87307205]
mat_Sqrt:  [[0.15]]
grads:  [0.00979677]
Stock Position:  0.009796774150768942
Bond Position:  [8.48478451]


portfolio before change:  [9.49682388]
curr_Stock_Price:  103.08678128835689
curr_Factors:  [103.08678129]
mat_Sqrt:  [[0.15]]
grads:  [0.05722242]
Stock Position:  0.057222421070960455
Bond Position:  [3.59794868]


portfolio before change:  [9.50344812]
curr_Stock_Price:  103.18682312539894
curr_Factors:  [103.18682313]
mat_Sqrt:  [[0.15]]
grads:  [-0.2944897]
Stock Position:  -0.2944896987887961
Bond Position:  [39.89090458]


portfolio before change:  [8.98477967]
curr_Stock_Price:  104.98193659292536
curr_Factors:  [104.98193659]
mat_Sqrt:  [[0.15]]
grads:  [-0.12575686]
Stock Position:  -0.12575686399862354
Bond Position:  [22.18697879]


portfolio before change:  [8.91624884]
curr_Stock_Price:  105.57099603293733
curr_Factors:  [105.57099603]
mat_Sqrt:  [[0.15]]
grads:  [0.03022038]
Stock Position:  0.03022038388318639
Bond Position:  [5.72585281]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.91624884]
Stock Price:  104.93792527606514
PL:  [3.97832356]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.52171361e-02]
 [-7.96965333e-03]
 [-1.02868375e-02]
 [ 2.98777651e-03]
 [ 5.10699382e-03]
 [-1.22840851e-02]
 [-7.80206766e-03]
 [ 1.02705460e-03]
 [ 2.70224783e-03]
 [ 5.11713047e-02]
 [-1.41525123e-02]
 [-2.04679357e-02]
 [-1.14471020e-03]
 [-2.01676459e-02]
 [ 5.84764111e-03]
 [ 8.65745461e-03]
 [-4.35574039e-02]
 [-1.99726676e-02]
 [ 4.51282509e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.54772522]
curr_Stock_Price:  100.6395000563378
curr_Factors:  [100.63950006]
mat_Sqrt:  [[0.15]]
grads:  [0.16811424]
Stock Position:  0.1681142408682152
Bond Position:  [-5.37120793]


portfolio before change:  [11.58945386]
curr_Stock_Price:  100.89570441874967
curr_Factors:  [100.89570442]
mat_Sqrt:  [[0.15]]
grads:  [-0.05313102]
Stock Position:  -0.05313102218522079
Bond Position:  [16.95014577]


portfolio before change:  [11.59678666]
curr_Stock_Price:  100.8374570872727
curr_Factors:  [100.83745709]
mat_Sqrt:  [[0.15]]
grads:  [-0.06857892]
Stock Position:  -0.0685789163984511
Bond Position:  [18.5121102]


portfolio before change:  [11.55033379]
curr_Stock_Price:  101.58231393304922
curr_Factors:  [101.58231393]
mat_Sqrt:  [[0.15]]
grads:  [0.01991851]
Stock Position:  0.019918510068422428
Bond Position:  [9.52696545]


portfolio before change:  [11.59817897]
curr_Stock_Price:  103.86477049847353
curr_Factors:  [103.8647705]
mat_Sqrt:  [[0.15]]
grads:  [0.03404663]
Stock Position:  0.03404662549897607
Bond Position:  [8.06193402]


portfolio before change:  [11.56382702]
curr_Stock_Price:  102.7965977356532
curr_Factors:  [102.79659774]
mat_Sqrt:  [[0.15]]
grads:  [-0.0818939]
Stock Position:  -0.08189390065300516
Bond Position:  [19.98224139]


portfolio before change:  [11.47234002]
curr_Stock_Price:  103.97474637473928
curr_Factors:  [103.97474637]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201378]
Stock Position:  -0.05201378439083352
Bond Position:  [16.88046006]


portfolio before change:  [11.47357335]
curr_Stock_Price:  104.03217944493103
curr_Factors:  [104.03217944]
mat_Sqrt:  [[0.15]]
grads:  [0.00684703]
Stock Position:  0.006847030694642637
Bond Position:  [10.76126183]


portfolio before change:  [11.4800333]
curr_Stock_Price:  104.58268081935837
curr_Factors:  [104.58268082]
mat_Sqrt:  [[0.15]]
grads:  [0.01801499]
Stock Position:  0.018014985501991262
Bond Position:  [9.59597782]


portfolio before change:  [11.46881072]
curr_Stock_Price:  103.82653924819745
curr_Factors:  [103.82653925]
mat_Sqrt:  [[0.15]]
grads:  [0.34114203]
Stock Position:  0.341142031096174
Bond Position:  [-23.95078576]


portfolio before change:  [12.12931449]
curr_Stock_Price:  105.78024813577746
curr_Factors:  [105.78024814]
mat_Sqrt:  [[0.15]]
grads:  [-0.09435008]
Stock Position:  -0.0943500821974815
Bond Position:  [22.1096896]


portfolio before change:  [12.36542577]
curr_Stock_Price:  103.33633749534913
curr_Factors:  [103.3363375]
mat_Sqrt:  [[0.15]]
grads:  [-0.1364529]
Stock Position:  -0.13645290481902836
Bond Position:  [26.4659692]


portfolio before change:  [12.31278451]
curr_Stock_Price:  103.77061616206551
curr_Factors:  [103.77061616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0076314]
Stock Position:  -0.007631401342073633
Bond Position:  [13.10469973]


portfolio before change:  [12.31607393]
curr_Stock_Price:  103.7689341701654
curr_Factors:  [103.76893417]
mat_Sqrt:  [[0.15]]
grads:  [-0.13445097]
Stock Position:  -0.1344509724336827
Bond Position:  [26.26790804]


portfolio before change:  [12.27773918]
curr_Stock_Price:  104.10290384387342
curr_Factors:  [104.10290384]
mat_Sqrt:  [[0.15]]
grads:  [0.03898427]
Stock Position:  0.038984274049160855
Bond Position:  [8.21936305]


portfolio before change:  [12.23235367]
curr_Stock_Price:  102.88598730641739
curr_Factors:  [102.88598731]
mat_Sqrt:  [[0.15]]
grads:  [0.05771636]
Stock Position:  0.057716364068207224
Bond Position:  [6.29414857]


portfolio before change:  [12.26513184]
curr_Stock_Price:  103.42663876737721
curr_Factors:  [103.42663877]
mat_Sqrt:  [[0.15]]
grads:  [-0.29038269]
Stock Position:  -0.29038269281803847
Bond Position:  [42.29843771]


portfolio before change:  [11.88650389]
curr_Stock_Price:  104.76695239074061
curr_Factors:  [104.76695239]
mat_Sqrt:  [[0.15]]
grads:  [-0.13315112]
Stock Position:  -0.13315111715011904
Bond Position:  [25.83634064]


portfolio before change:  [11.90197661]
curr_Stock_Price:  104.69926369562064
curr_Factors:  [104.6992637]
mat_Sqrt:  [[0.15]]
grads:  [0.0300855]
Stock Position:  0.030085500576011576
Bond Position:  [8.75204685]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.90197661]
Stock Price:  105.62240095472723
PL:  [6.27957566]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.51398837e-02]
 [-3.48195167e-03]
 [ 6.30889173e-02]
 [-3.03609812e-02]
 [ 3.78827240e-03]
 [-3.95571340e-02]
 [-8.11211757e-03]
 [ 1.01394524e-03]
 [ 3.09094042e-04]
 [ 4.22743611e-02]
 [-9.84823667e-03]
 [-2.12887461e-02]
 [-3.53897321e-04]
 [-1.91620156e-02]
 [ 1.34948207e-03]
 [ 1.05708497e-02]
 [ 4.98333230e-02]
 [ 1.96964031e-02]
 [ 3.76184931e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.61214065]
curr_Stock_Price:  101.29765241781637
curr_Factors:  [101.29765242]
mat_Sqrt:  [[0.15]]
grads:  [-0.23426589]
Stock Position:  -0.2342658912758749
Bond Position:  [45.34272548]


portfolio before change:  [21.02350584]
curr_Stock_Price:  103.85872481211084
curr_Factors:  [103.85872481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02321301]
Stock Position:  -0.023213011147246946
Bond Position:  [23.43437958]


portfolio before change:  [20.98755109]
curr_Stock_Price:  105.66004554075944
curr_Factors:  [105.66004554]
mat_Sqrt:  [[0.15]]
grads:  [0.42059278]
Stock Position:  0.4205927818415156
Bond Position:  [-23.45230139]


portfolio before change:  [22.09205055]
curr_Stock_Price:  108.30004154260585
curr_Factors:  [108.30004154]
mat_Sqrt:  [[0.15]]
grads:  [-0.20240654]
Stock Position:  -0.20240654149628512
Bond Position:  [44.0126874]


portfolio before change:  [22.3784516]
curr_Stock_Price:  106.939430822035
curr_Factors:  [106.93943082]
mat_Sqrt:  [[0.15]]
grads:  [0.02525515]
Stock Position:  0.025255149335014753
Bond Position:  [19.67768031]


portfolio before change:  [22.32487895]
curr_Stock_Price:  104.62336102992428
curr_Factors:  [104.62336103]
mat_Sqrt:  [[0.15]]
grads:  [-0.26371423]
Stock Position:  -0.26371422651916565
Bond Position:  [49.91554768]


portfolio before change:  [22.48750835]
curr_Stock_Price:  104.05399866918148
curr_Factors:  [104.05399867]
mat_Sqrt:  [[0.15]]
grads:  [-0.05408078]
Stock Position:  -0.054080783781589134
Bond Position:  [28.11483015]


portfolio before change:  [22.49790932]
curr_Stock_Price:  103.9916588857979
curr_Factors:  [103.99165889]
mat_Sqrt:  [[0.15]]
grads:  [0.00675963]
Stock Position:  0.006759634964113537
Bond Position:  [21.79496367]


portfolio before change:  [22.4966401]
curr_Stock_Price:  102.9977230510989
curr_Factors:  [102.99772305]
mat_Sqrt:  [[0.15]]
grads:  [0.00206063]
Stock Position:  0.0020606269453399997
Bond Position:  [22.28440022]


portfolio before change:  [22.50212416]
curr_Stock_Price:  102.95514426826826
curr_Factors:  [102.95514427]
mat_Sqrt:  [[0.15]]
grads:  [0.28182907]
Stock Position:  0.28182907378472294
Bond Position:  [-6.51362879]


portfolio before change:  [22.48367913]
curr_Stock_Price:  102.89547540431415
curr_Factors:  [102.8954754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06565491]
Stock Position:  -0.06565491116076602
Bond Position:  [29.23927242]


portfolio before change:  [22.51346971]
curr_Stock_Price:  102.55308130591538
curr_Factors:  [102.55308131]
mat_Sqrt:  [[0.15]]
grads:  [-0.14192497]
Stock Position:  -0.14192497372657645
Bond Position:  [37.06831308]


portfolio before change:  [22.58440028]
curr_Stock_Price:  102.11860998046964
curr_Factors:  [102.11860998]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235932]
Stock Position:  -0.0023593154711700564
Bond Position:  [22.8253303]


portfolio before change:  [22.58771456]
curr_Stock_Price:  103.13278929524411
curr_Factors:  [103.1327893]
mat_Sqrt:  [[0.15]]
grads:  [-0.12774677]
Stock Position:  -0.12774677052773706
Bond Position:  [35.76259533]


portfolio before change:  [22.63414173]
curr_Stock_Price:  102.83935403590353
curr_Factors:  [102.83935404]
mat_Sqrt:  [[0.15]]
grads:  [0.00899655]
Stock Position:  0.008996547126979112
Bond Position:  [21.70894264]


portfolio before change:  [22.61308795]
curr_Stock_Price:  99.89581399510004
curr_Factors:  [99.895814]
mat_Sqrt:  [[0.15]]
grads:  [0.07047233]
Stock Position:  0.0704723311276157
Bond Position:  [15.57319707]


portfolio before change:  [22.5027727]
curr_Stock_Price:  98.27519169250981
curr_Factors:  [98.27519169]
mat_Sqrt:  [[0.15]]
grads:  [0.33222215]
Stock Position:  0.3322221533878684
Bond Position:  [-10.14642311]


portfolio before change:  [22.6002162]
curr_Stock_Price:  98.57613616655982
curr_Factors:  [98.57613617]
mat_Sqrt:  [[0.15]]
grads:  [0.13130935]
Stock Position:  0.13130935411412054
Bond Position:  [9.65624743]


portfolio before change:  [22.36682129]
curr_Stock_Price:  96.78030617168842
curr_Factors:  [96.78030617]
mat_Sqrt:  [[0.15]]
grads:  [0.025079]
Stock Position:  0.02507899537825637
Bond Position:  [19.93966844]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.36682129]
Stock Price:  96.22508430496691
PL:  [22.36682129]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.87616823e-02]
 [-6.45927858e-03]
 [ 4.00350167e-03]
 [ 3.30486754e-03]
 [ 8.50268016e-03]
 [ 9.02896118e-03]
 [-1.00008588e-02]
 [-1.54709133e-03]
 [-9.26129940e-04]
 [ 3.93911198e-02]
 [-7.62635137e-03]
 [-2.32722163e-02]
 [ 1.36309699e-03]
 [-1.89445945e-03]
 [-3.36158413e-03]
 [ 1.06008083e-02]
 [-1.37486178e-02]
 [ 8.36641197e-03]
 [ 3.75152452e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.15967459]
curr_Stock_Price:  100.02557789265707
curr_Factors:  [100.02557789]
mat_Sqrt:  [[0.15]]
grads:  [0.19174455]
Stock Position:  0.1917445486846632
Bond Position:  [-17.0196847]


portfolio before change:  [2.21744832]
curr_Stock_Price:  100.34907697287905
curr_Factors:  [100.34907697]
mat_Sqrt:  [[0.15]]
grads:  [-0.04306186]
Stock Position:  -0.0430618571913806
Bond Position:  [6.53866594]


portfolio before change:  [2.2763808]
curr_Stock_Price:  99.01848850216226
curr_Factors:  [99.0184885]
mat_Sqrt:  [[0.15]]
grads:  [0.02669001]
Stock Position:  0.026690011154292655
Bond Position:  [-0.36642376]


portfolio before change:  [2.26237444]
curr_Stock_Price:  98.49714198136951
curr_Factors:  [98.49714198]
mat_Sqrt:  [[0.15]]
grads:  [0.02203245]
Stock Position:  0.0220324502749414
Bond Position:  [0.09224106]


portfolio before change:  [2.26434542]
curr_Stock_Price:  98.58555312013124
curr_Factors:  [98.58555312]
mat_Sqrt:  [[0.15]]
grads:  [0.05668453]
Stock Position:  0.05668453436756211
Bond Position:  [-3.32393076]


portfolio before change:  [2.26608867]
curr_Stock_Price:  98.63096825399035
curr_Factors:  [98.63096825]
mat_Sqrt:  [[0.15]]
grads:  [0.06019307]
Stock Position:  0.06019307454367378
Bond Position:  [-3.67081256]


portfolio before change:  [2.34978349]
curr_Stock_Price:  100.03665549265541
curr_Factors:  [100.03665549]
mat_Sqrt:  [[0.15]]
grads:  [-0.06667239]
Stock Position:  -0.06667239224388477
Bond Position:  [9.01946662]


portfolio before change:  [2.29271488]
curr_Stock_Price:  100.92643540571669
curr_Factors:  [100.92643541]
mat_Sqrt:  [[0.15]]
grads:  [-0.01031394]
Stock Position:  -0.01031394222206925
Bond Position:  [3.3336643]


portfolio before change:  [2.2873522]
curr_Stock_Price:  101.52719456518857
curr_Factors:  [101.52719457]
mat_Sqrt:  [[0.15]]
grads:  [-0.0061742]
Stock Position:  -0.006174199600673299
Bond Position:  [2.91420137]


portfolio before change:  [2.28054289]
curr_Stock_Price:  102.74807352852895
curr_Factors:  [102.74807353]
mat_Sqrt:  [[0.15]]
grads:  [0.26260747]
Stock Position:  0.2626074650843204
Bond Position:  [-24.70186824]


portfolio before change:  [2.12054751]
curr_Stock_Price:  102.1623356336868
curr_Factors:  [102.16233563]
mat_Sqrt:  [[0.15]]
grads:  [-0.05084234]
Stock Position:  -0.05084234248271322
Bond Position:  [7.31471997]


portfolio before change:  [2.20426549]
curr_Stock_Price:  100.55168863271554
curr_Factors:  [100.55168863]
mat_Sqrt:  [[0.15]]
grads:  [-0.15514811]
Stock Position:  -0.15514810888223826
Bond Position:  [17.80466982]


portfolio before change:  [2.30311185]
curr_Stock_Price:  99.94327231661786
curr_Factors:  [99.94327232]
mat_Sqrt:  [[0.15]]
grads:  [0.00908731]
Stock Position:  0.009087313244134967
Bond Position:  [1.39489603]


portfolio before change:  [2.30241979]
curr_Stock_Price:  99.82873609531049
curr_Factors:  [99.8287361]
mat_Sqrt:  [[0.15]]
grads:  [-0.01262973]
Stock Position:  -0.012629729665056625
Bond Position:  [3.56322974]


portfolio before change:  [2.30004087]
curr_Stock_Price:  100.08763676132124
curr_Factors:  [100.08763676]
mat_Sqrt:  [[0.15]]
grads:  [-0.02241056]
Stock Position:  -0.022410560881169155
Bond Position:  [4.54306094]


portfolio before change:  [2.29543705]
curr_Stock_Price:  100.34375350919038
curr_Factors:  [100.34375351]
mat_Sqrt:  [[0.15]]
grads:  [0.07067206]
Stock Position:  0.07067205554193752
Bond Position:  [-4.79606227]


portfolio before change:  [2.34390324]
curr_Stock_Price:  101.04651157510466
curr_Factors:  [101.04651158]
mat_Sqrt:  [[0.15]]
grads:  [-0.09165745]
Stock Position:  -0.09165745224031038
Bond Position:  [11.60556905]


portfolio before change:  [2.37404472]
curr_Stock_Price:  100.74932113909259
curr_Factors:  [100.74932114]
mat_Sqrt:  [[0.15]]
grads:  [0.05577608]
Stock Position:  0.05577607983190641
Bond Position:  [-3.24535746]


portfolio before change:  [2.34484877]
curr_Stock_Price:  100.24042013819732
curr_Factors:  [100.24042014]
mat_Sqrt:  [[0.15]]
grads:  [0.02501016]
Stock Position:  0.02501016349494953
Bond Position:  [-0.16218052]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.34484877]
Stock Price:  99.7987187399178
PL:  [2.34484877]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.97417491e-02]
 [-8.05334681e-03]
 [-9.40218761e-03]
 [ 2.33482764e-03]
 [ 6.84343771e-03]
 [ 2.56029167e-04]
 [ 3.47620549e-04]
 [ 7.66919870e-04]
 [ 2.73487787e-03]
 [ 7.99948278e-02]
 [-1.25611472e-02]
 [-1.85320707e-02]
 [-2.53303624e-03]
 [-2.68610727e-02]
 [ 2.20983243e-02]
 [ 3.87238253e-03]
 [-2.12791263e-04]
 [-4.79178992e-04]
 [ 5.47882195e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.80352318]
curr_Stock_Price:  100.5908337093661
curr_Factors:  [100.59083371]
mat_Sqrt:  [[0.15]]
grads:  [0.19827833]
Stock Position:  0.19827832743522467
Bond Position:  [-9.14145908]


portfolio before change:  [10.82222942]
curr_Stock_Price:  100.69670455582556
curr_Factors:  [100.69670456]
mat_Sqrt:  [[0.15]]
grads:  [-0.05368898]
Stock Position:  -0.05368897874065175
Bond Position:  [16.22853265]


portfolio before change:  [10.80207253]
curr_Stock_Price:  101.14771960250484
curr_Factors:  [101.1477196]
mat_Sqrt:  [[0.15]]
grads:  [-0.06268125]
Stock Position:  -0.06268125073769787
Bond Position:  [17.1421381]


portfolio before change:  [10.80360148]
curr_Stock_Price:  101.19170597255463
curr_Factors:  [101.19170597]
mat_Sqrt:  [[0.15]]
grads:  [0.01556552]
Stock Position:  0.015565517584213463
Bond Position:  [9.2285002]


portfolio before change:  [10.80103119]
curr_Stock_Price:  100.87834029462284
curr_Factors:  [100.87834029]
mat_Sqrt:  [[0.15]]
grads:  [0.04562292]
Stock Position:  0.04562291807069711
Bond Position:  [6.19866694]


portfolio before change:  [10.84914828]
curr_Stock_Price:  101.89903858923158
curr_Factors:  [101.89903859]
mat_Sqrt:  [[0.15]]
grads:  [0.00170686]
Stock Position:  0.0017068611106716334
Bond Position:  [10.67522078]


portfolio before change:  [10.85180472]
curr_Stock_Price:  101.89159307748977
curr_Factors:  [101.89159308]
mat_Sqrt:  [[0.15]]
grads:  [0.00231747]
Stock Position:  0.0023174703264080302
Bond Position:  [10.61567397]


portfolio before change:  [10.85755631]
curr_Stock_Price:  103.22811233356589
curr_Factors:  [103.22811233]
mat_Sqrt:  [[0.15]]
grads:  [0.0051128]
Stock Position:  0.005112799131813219
Bond Position:  [10.32977171]


portfolio before change:  [10.86717296]
curr_Stock_Price:  104.60385256438953
curr_Factors:  [104.60385256]
mat_Sqrt:  [[0.15]]
grads:  [0.01823252]
Stock Position:  0.018232519112147662
Bond Position:  [8.95998122]


portfolio before change:  [10.90382242]
curr_Stock_Price:  106.4910950061157
curr_Factors:  [106.49109501]
mat_Sqrt:  [[0.15]]
grads:  [0.53329885]
Stock Position:  0.5332988519901306
Bond Position:  [-45.8877563]


portfolio before change:  [9.84899983]
curr_Stock_Price:  104.53468874070505
curr_Factors:  [104.53468874]
mat_Sqrt:  [[0.15]]
grads:  [-0.08374098]
Stock Position:  -0.08374098166637249
Bond Position:  [18.60283728]


portfolio before change:  [9.76094654]
curr_Stock_Price:  105.64172825738109
curr_Factors:  [105.64172826]
mat_Sqrt:  [[0.15]]
grads:  [-0.12354714]
Stock Position:  -0.12354713832186
Bond Position:  [22.81267976]


portfolio before change:  [9.67009722]
curr_Stock_Price:  106.42323732250641
curr_Factors:  [106.42323732]
mat_Sqrt:  [[0.15]]
grads:  [-0.01688691]
Stock Position:  -0.0168869082630921
Bond Position:  [11.46725666]


portfolio before change:  [9.64744964]
curr_Stock_Price:  107.93415656634642
curr_Factors:  [107.93415657]
mat_Sqrt:  [[0.15]]
grads:  [-0.17907382]
Stock Position:  -0.17907381826353755
Bond Position:  [28.97563117]


portfolio before change:  [9.42805692]
curr_Stock_Price:  109.19976606052383
curr_Factors:  [109.19976606]
mat_Sqrt:  [[0.15]]
grads:  [0.14732216]
Stock Position:  0.14732216172731527
Bond Position:  [-6.65948867]


portfolio before change:  [9.22680684]
curr_Stock_Price:  107.84501400486201
curr_Factors:  [107.845014]
mat_Sqrt:  [[0.15]]
grads:  [0.02581588]
Stock Position:  0.025815883564312334
Bond Position:  [6.44269252]


portfolio before change:  [9.28362881]
curr_Stock_Price:  109.98366232260038
curr_Factors:  [109.98366232]
mat_Sqrt:  [[0.15]]
grads:  [-0.00141861]
Stock Position:  -0.001418608419214799
Bond Position:  [9.43965256]


portfolio before change:  [9.28398674]
curr_Stock_Price:  111.39510274386758
curr_Factors:  [111.39510274]
mat_Sqrt:  [[0.15]]
grads:  [-0.00319453]
Stock Position:  -0.0031945266156127817
Bond Position:  [9.63984136]


portfolio before change:  [9.28592923]
curr_Stock_Price:  111.54153277016889
curr_Factors:  [111.54153277]
mat_Sqrt:  [[0.15]]
grads:  [0.03652548]
Stock Position:  0.03652547966336997
Bond Position:  [5.21182124]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.28592923]
Stock Price:  111.08139654317287
PL:  [-1.79546732]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.88684398e-02]
 [ 9.10141382e-03]
 [ 4.41978764e-02]
 [-8.55736602e-03]
 [ 9.33117724e-03]
 [ 8.26383848e-02]
 [-8.28116513e-04]
 [ 8.24260902e-03]
 [ 7.24132429e-03]
 [-3.72538214e-02]
 [-9.42913105e-04]
 [-2.63497771e-02]
 [ 2.75815036e-03]
 [ 3.56081264e-03]
 [-1.92324882e-03]
 [ 1.15726773e-02]
 [ 4.69049140e-02]
 [ 1.95945456e-02]
 [ 3.85714031e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.55526694]
curr_Stock_Price:  98.73633904755867
curr_Factors:  [98.73633905]
mat_Sqrt:  [[0.15]]
grads:  [0.45912293]
Stock Position:  0.459122932124759
Bond Position:  [-62.88738443]


portfolio before change:  [-18.27464756]
curr_Stock_Price:  97.20372815049993
curr_Factors:  [97.20372815]
mat_Sqrt:  [[0.15]]
grads:  [0.06067609]
Stock Position:  0.06067609212077315
Bond Position:  [-24.17258992]


portfolio before change:  [-18.34991105]
curr_Stock_Price:  96.06292311770024
curr_Factors:  [96.06292312]
mat_Sqrt:  [[0.15]]
grads:  [0.29465251]
Stock Position:  0.29465250936326415
Bond Position:  [-46.65509241]


portfolio before change:  [-18.78019108]
curr_Stock_Price:  94.64221641690418
curr_Factors:  [94.64221642]
mat_Sqrt:  [[0.15]]
grads:  [-0.05704911]
Stock Position:  -0.05704910682456217
Bond Position:  [-13.38093716]


portfolio before change:  [-18.79903186]
curr_Stock_Price:  94.91382683309726
curr_Factors:  [94.91382683]
mat_Sqrt:  [[0.15]]
grads:  [0.06220785]
Stock Position:  0.062207848289193214
Bond Position:  [-24.7034168]


portfolio before change:  [-18.90638621]
curr_Stock_Price:  93.2873806310688
curr_Factors:  [93.28738063]
mat_Sqrt:  [[0.15]]
grads:  [0.55092257]
Stock Position:  0.5509225653189358
Bond Position:  [-70.30050926]


portfolio before change:  [-18.19464237]
curr_Stock_Price:  94.6111985421537
curr_Factors:  [94.61119854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00552078]
Stock Position:  -0.0055207767544149244
Bond Position:  [-17.67231507]


portfolio before change:  [-18.2009472]
curr_Stock_Price:  94.95285239608852
curr_Factors:  [94.9528524]
mat_Sqrt:  [[0.15]]
grads:  [0.05495073]
Stock Position:  0.054950726791916885
Bond Position:  [-23.41867545]


portfolio before change:  [-18.18056604]
curr_Stock_Price:  95.43030844624208
curr_Factors:  [95.43030845]
mat_Sqrt:  [[0.15]]
grads:  [0.0482755]
Stock Position:  0.0482754952506033
Bond Position:  [-22.78751144]


portfolio before change:  [-18.11958491]
curr_Stock_Price:  96.8115211093076
curr_Factors:  [96.81152111]
mat_Sqrt:  [[0.15]]
grads:  [-0.24835881]
Stock Position:  -0.24835880965876939
Bond Position:  [5.92440924]


portfolio before change:  [-18.13243432]
curr_Stock_Price:  96.86922273414059
curr_Factors:  [96.86922273]
mat_Sqrt:  [[0.15]]
grads:  [-0.00628609]
Stock Position:  -0.006286087368635208
Bond Position:  [-17.52350593]


portfolio before change:  [-18.13846936]
curr_Stock_Price:  97.13228144347707
curr_Factors:  [97.13228144]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566518]
Stock Position:  -0.1756651808316009
Bond Position:  [-1.07570957]


portfolio before change:  [-18.11544871]
curr_Stock_Price:  96.9997019011071
curr_Factors:  [96.9997019]
mat_Sqrt:  [[0.15]]
grads:  [0.01838767]
Stock Position:  0.018387669077340782
Bond Position:  [-19.89904713]


portfolio before change:  [-18.09776635]
curr_Stock_Price:  98.23192669718141
curr_Factors:  [98.2319267]
mat_Sqrt:  [[0.15]]
grads:  [0.02373875]
Stock Position:  0.023738750938583818
Bond Position:  [-20.42966959]


portfolio before change:  [-18.12432137]
curr_Stock_Price:  97.32846870300511
curr_Factors:  [97.3284687]
mat_Sqrt:  [[0.15]]
grads:  [-0.01282166]
Stock Position:  -0.012821658802835164
Bond Position:  [-16.87640896]


portfolio before change:  [-18.14384991]
curr_Stock_Price:  98.52245702083891
curr_Factors:  [98.52245702]
mat_Sqrt:  [[0.15]]
grads:  [0.07715118]
Stock Position:  0.07715118223235544
Bond Position:  [-25.74497395]


portfolio before change:  [-18.09806564]
curr_Stock_Price:  99.19932708023806
curr_Factors:  [99.19932708]
mat_Sqrt:  [[0.15]]
grads:  [0.31269943]
Stock Position:  0.3126994264919657
Bond Position:  [-49.11763832]


portfolio before change:  [-18.06894574]
curr_Stock_Price:  99.33172528920524
curr_Factors:  [99.33172529]
mat_Sqrt:  [[0.15]]
grads:  [0.1306303]
Stock Position:  0.1306303042098415
Bond Position:  [-31.04467923]


portfolio before change:  [-18.09672589]
curr_Stock_Price:  99.17848353039419
curr_Factors:  [99.17848353]
mat_Sqrt:  [[0.15]]
grads:  [0.02571427]
Stock Position:  0.025714268752202448
Bond Position:  [-20.64702807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.09672589]
Stock Price:  99.18399091670183
PL:  [-18.09672589]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.34008228e-02]
 [-7.30589031e-03]
 [-1.13588700e-03]
 [ 2.61367794e-03]
 [ 7.27405903e-03]
 [ 8.59926560e-03]
 [-1.58551212e-02]
 [ 5.76262213e-03]
 [ 5.91453784e-03]
 [-3.72566570e-02]
 [-9.54488554e-04]
 [-2.63462806e-02]
 [ 2.59676998e-03]
 [-3.47124389e-03]
 [-3.35347439e-03]
 [ 1.09412641e-02]
 [ 1.19315677e-02]
 [-1.13229715e-02]
 [ 3.88632190e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.94920815]
curr_Stock_Price:  100.27339064231356
curr_Factors:  [100.27339064]
mat_Sqrt:  [[0.15]]
grads:  [0.22267215]
Stock Position:  0.22267215185683933
Bond Position:  [-16.37888352]


portfolio before change:  [6.32812272]
curr_Stock_Price:  101.99345217916162
curr_Factors:  [101.99345218]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870594]
Stock Position:  -0.04870593536794458
Bond Position:  [11.29580921]


portfolio before change:  [6.34675397]
curr_Stock_Price:  101.66891378401625
curr_Factors:  [101.66891378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00757258]
Stock Position:  -0.007572580022363786
Bond Position:  [7.11664996]


portfolio before change:  [6.35808605]
curr_Stock_Price:  100.40742949733091
curr_Factors:  [100.4074295]
mat_Sqrt:  [[0.15]]
grads:  [0.01742452]
Stock Position:  0.01742451959629128
Bond Position:  [4.60853482]


portfolio before change:  [6.35679716]
curr_Stock_Price:  100.26733004890912
curr_Factors:  [100.26733005]
mat_Sqrt:  [[0.15]]
grads:  [0.04849373]
Stock Position:  0.04849372687055766
Bond Position:  [1.49446064]


portfolio before change:  [6.35389687]
curr_Stock_Price:  100.19981729343273
curr_Factors:  [100.19981729]
mat_Sqrt:  [[0.15]]
grads:  [0.05732844]
Stock Position:  0.057328437355887024
Bond Position:  [0.60959793]


portfolio before change:  [6.30058224]
curr_Stock_Price:  99.26717273772243
curr_Factors:  [99.26717274]
mat_Sqrt:  [[0.15]]
grads:  [-0.10570081]
Stock Position:  -0.10570080775740595
Bond Position:  [16.79320258]


portfolio before change:  [6.54182011]
curr_Stock_Price:  97.02462553964882
curr_Factors:  [97.02462554]
mat_Sqrt:  [[0.15]]
grads:  [0.03841748]
Stock Position:  0.03841748088152539
Bond Position:  [2.81437842]


portfolio before change:  [6.50661052]
curr_Stock_Price:  96.08980960679474
curr_Factors:  [96.08980961]
mat_Sqrt:  [[0.15]]
grads:  [0.03943025]
Stock Position:  0.03943025229264189
Bond Position:  [2.71776509]


portfolio before change:  [6.53077418]
curr_Stock_Price:  96.68539631397734
curr_Factors:  [96.68539631]
mat_Sqrt:  [[0.15]]
grads:  [-0.24837771]
Stock Position:  -0.24837771366308392
Bond Position:  [30.54527186]


portfolio before change:  [6.43680732]
curr_Stock_Price:  97.09446739554444
curr_Factors:  [97.0944674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00636326]
Stock Position:  -0.0063632570252239225
Bond Position:  [7.05464437]


portfolio before change:  [6.4366888]
curr_Stock_Price:  97.39029069270231
curr_Factors:  [97.39029069]
mat_Sqrt:  [[0.15]]
grads:  [-0.17564187]
Stock Position:  -0.1756418707455874
Bond Position:  [23.54250165]


portfolio before change:  [6.28125904]
curr_Stock_Price:  98.30872841707478
curr_Factors:  [98.30872842]
mat_Sqrt:  [[0.15]]
grads:  [0.0173118]
Stock Position:  0.017311799862373394
Bond Position:  [4.57935801]


portfolio before change:  [6.31931473]
curr_Stock_Price:  100.44084092034711
curr_Factors:  [100.44084092]
mat_Sqrt:  [[0.15]]
grads:  [-0.02314163]
Stock Position:  -0.02314162592742733
Bond Position:  [8.64367909]


portfolio before change:  [6.3143979]
curr_Stock_Price:  100.74669740310436
curr_Factors:  [100.7466974]
mat_Sqrt:  [[0.15]]
grads:  [-0.0223565]
Stock Position:  -0.022356495923195146
Bond Position:  [8.56674103]


portfolio before change:  [6.34900123]
curr_Stock_Price:  99.2947088517885
curr_Factors:  [99.29470885]
mat_Sqrt:  [[0.15]]
grads:  [0.07294176]
Stock Position:  0.07294176065628696
Bond Position:  [-0.89372966]


portfolio before change:  [6.41690755]
curr_Stock_Price:  100.22873875446794
curr_Factors:  [100.22873875]
mat_Sqrt:  [[0.15]]
grads:  [0.07954378]
Stock Position:  0.07954378486284627
Bond Position:  [-1.55566568]


portfolio before change:  [6.51000221]
curr_Stock_Price:  101.40398608346685
curr_Factors:  [101.40398608]
mat_Sqrt:  [[0.15]]
grads:  [-0.07548648]
Stock Position:  -0.07548647692438684
Bond Position:  [14.16463187]


portfolio before change:  [6.70273205]
curr_Stock_Price:  98.89773266211165
curr_Factors:  [98.89773266]
mat_Sqrt:  [[0.15]]
grads:  [0.02590881]
Stock Position:  0.025908812646655476
Bond Position:  [4.14040922]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.70273205]
Stock Price:  98.20752284076266
PL:  [6.70273205]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.06672023e-02]
 [ 5.85606783e-03]
 [ 1.57850582e-02]
 [ 3.58151853e-03]
 [ 8.71315471e-03]
 [ 1.98327535e-02]
 [-1.56060240e-02]
 [-2.17290795e-03]
 [-1.31407283e-03]
 [ 3.86420373e-02]
 [-1.03812188e-02]
 [-2.14977448e-02]
 [-9.33002366e-04]
 [-2.01308195e-02]
 [ 5.35197926e-03]
 [ 8.04844863e-03]
 [-4.36687311e-02]
 [-2.41672885e-02]
 [ 4.55018197e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.24070532]
curr_Stock_Price:  100.16166481196665
curr_Factors:  [100.16166481]
mat_Sqrt:  [[0.15]]
grads:  [0.20444802]
Stock Position:  0.20444801504258966
Bond Position:  [-16.23714823]


portfolio before change:  [4.07406691]
curr_Stock_Price:  99.36645721186082
curr_Factors:  [99.36645721]
mat_Sqrt:  [[0.15]]
grads:  [0.03904045]
Stock Position:  0.03904045222264552
Bond Position:  [0.19475548]


portfolio before change:  [4.00919303]
curr_Stock_Price:  97.70350063480626
curr_Factors:  [97.70350063]
mat_Sqrt:  [[0.15]]
grads:  [0.10523372]
Stock Position:  0.1052337211519587
Bond Position:  [-6.27250991]


portfolio before change:  [4.21842517]
curr_Stock_Price:  99.706665220861
curr_Factors:  [99.70666522]
mat_Sqrt:  [[0.15]]
grads:  [0.02387679]
Stock Position:  0.023876790216431805
Bond Position:  [1.83775004]


portfolio before change:  [4.17228513]
curr_Stock_Price:  97.75499847737112
curr_Factors:  [97.75499848]
mat_Sqrt:  [[0.15]]
grads:  [0.0580877]
Stock Position:  0.05808769804431729
Bond Position:  [-1.50607771]


portfolio before change:  [4.17078747]
curr_Stock_Price:  97.73569849071211
curr_Factors:  [97.73569849]
mat_Sqrt:  [[0.15]]
grads:  [0.13221836]
Stock Position:  0.13221835686115024
Bond Position:  [-8.75166599]


portfolio before change:  [4.40827875]
curr_Stock_Price:  99.54845338684312
curr_Factors:  [99.54845339]
mat_Sqrt:  [[0.15]]
grads:  [-0.10404016]
Stock Position:  -0.10404015981483898
Bond Position:  [14.76531575]


portfolio before change:  [4.35192766]
curr_Stock_Price:  100.12556589604222
curr_Factors:  [100.1255659]
mat_Sqrt:  [[0.15]]
grads:  [-0.01448605]
Stock Position:  -0.014486052997805986
Bond Position:  [5.80235192]


portfolio before change:  [4.34284155]
curr_Stock_Price:  100.85294706968192
curr_Factors:  [100.85294707]
mat_Sqrt:  [[0.15]]
grads:  [-0.00876049]
Stock Position:  -0.008760485564166313
Bond Position:  [5.22636234]


portfolio before change:  [4.32792634]
curr_Stock_Price:  102.70466665295504
curr_Factors:  [102.70466665]
mat_Sqrt:  [[0.15]]
grads:  [0.25761358]
Stock Position:  0.2576135818721841
Bond Position:  [-22.13019071]


portfolio before change:  [4.42149166]
curr_Stock_Price:  103.08934574672568
curr_Factors:  [103.08934575]
mat_Sqrt:  [[0.15]]
grads:  [-0.06920813]
Stock Position:  -0.06920812510981963
Bond Position:  [11.556112]


portfolio before change:  [4.47677291]
curr_Stock_Price:  102.33232683821424
curr_Factors:  [102.33232684]
mat_Sqrt:  [[0.15]]
grads:  [-0.1433183]
Stock Position:  -0.14331829885402378
Bond Position:  [19.14286791]


portfolio before change:  [4.33503159]
curr_Stock_Price:  103.35471990726748
curr_Factors:  [103.35471991]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622002]
Stock Position:  -0.006220015770330515
Bond Position:  [4.97789958]


portfolio before change:  [4.3338447]
curr_Stock_Price:  103.74563841165961
curr_Factors:  [103.74563841]
mat_Sqrt:  [[0.15]]
grads:  [-0.13420546]
Stock Position:  -0.13420546315626522
Bond Position:  [18.25707615]


portfolio before change:  [4.30914843]
curr_Stock_Price:  103.96367056545253
curr_Factors:  [103.96367057]
mat_Sqrt:  [[0.15]]
grads:  [0.03567986]
Stock Position:  0.035679861745482856
Bond Position:  [0.59973904]


portfolio before change:  [4.31859724]
curr_Stock_Price:  104.2242896168289
curr_Factors:  [104.22428962]
mat_Sqrt:  [[0.15]]
grads:  [0.05365632]
Stock Position:  0.05365632417219514
Bond Position:  [-1.27369503]


portfolio before change:  [4.26816327]
curr_Stock_Price:  103.29028025578621
curr_Factors:  [103.29028026]
mat_Sqrt:  [[0.15]]
grads:  [-0.29112487]
Stock Position:  -0.2911248739554969
Bond Position:  [34.33853309]


portfolio before change:  [4.11751752]
curr_Stock_Price:  103.83723266305553
curr_Factors:  [103.83723266]
mat_Sqrt:  [[0.15]]
grads:  [-0.16111526]
Stock Position:  -0.16111525686687034
Bond Position:  [20.84727994]


portfolio before change:  [4.03013048]
curr_Stock_Price:  104.41197351296488
curr_Factors:  [104.41197351]
mat_Sqrt:  [[0.15]]
grads:  [0.03033455]
Stock Position:  0.03033454646298019
Bond Position:  [0.86284061]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.03013048]
Stock Price:  104.41276160091665
PL:  [-0.38263113]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.38520317e-03]
 [-6.50414548e-03]
 [-2.65221234e-04]
 [ 3.01872997e-03]
 [ 5.06675087e-03]
 [-7.75187587e-04]
 [-3.66504515e-03]
 [ 1.14047187e-03]
 [ 2.31684586e-03]
 [ 6.13939443e-02]
 [-1.26808152e-02]
 [-2.07474170e-02]
 [-1.90972657e-04]
 [-1.60021874e-02]
 [-2.54945206e-03]
 [ 1.11909656e-02]
 [ 2.70499843e-02]
 [ 1.99347218e-02]
 [ 3.91247738e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.41667678]
curr_Stock_Price:  100.95790026434264
curr_Factors:  [100.95790026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02923469]
Stock Position:  -0.029234687803062025
Bond Position:  [19.36814948]


portfolio before change:  [16.37607569]
curr_Stock_Price:  102.51234585505873
curr_Factors:  [102.51234586]
mat_Sqrt:  [[0.15]]
grads:  [-0.04336097]
Stock Position:  -0.04336096986777166
Bond Position:  [20.82111043]


portfolio before change:  [16.41539636]
curr_Stock_Price:  101.72558438239105
curr_Factors:  [101.72558438]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176814]
Stock Position:  -0.0017681415632549275
Bond Position:  [16.59526159]


portfolio before change:  [16.41844594]
curr_Stock_Price:  102.34757002810127
curr_Factors:  [102.34757003]
mat_Sqrt:  [[0.15]]
grads:  [0.02012487]
Stock Position:  0.020124866487620977
Bond Position:  [14.35871475]


portfolio before change:  [16.45421552]
curr_Stock_Price:  103.94655967757473
curr_Factors:  [103.94655968]
mat_Sqrt:  [[0.15]]
grads:  [0.03377834]
Stock Position:  0.03377833915122055
Bond Position:  [12.94307337]


portfolio before change:  [16.39078299]
curr_Stock_Price:  101.97284796683789
curr_Factors:  [101.97284797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00516792]
Stock Position:  -0.005167917245485996
Bond Position:  [16.91777023]


portfolio before change:  [16.39013223]
curr_Stock_Price:  102.91727621705985
curr_Factors:  [102.91727622]
mat_Sqrt:  [[0.15]]
grads:  [-0.02443363]
Stock Position:  -0.024433634351649382
Bond Position:  [18.90477533]


portfolio before change:  [16.35905221]
curr_Stock_Price:  104.3827481238775
curr_Factors:  [104.38274812]
mat_Sqrt:  [[0.15]]
grads:  [0.00760315]
Stock Position:  0.007603145774310829
Bond Position:  [15.56541496]


portfolio before change:  [16.36256289]
curr_Stock_Price:  104.33261579365423
curr_Factors:  [104.33261579]
mat_Sqrt:  [[0.15]]
grads:  [0.01544564]
Stock Position:  0.015445639057697365
Bond Position:  [14.75107896]


portfolio before change:  [16.37303087]
curr_Stock_Price:  104.77155881078494
curr_Factors:  [104.77155881]
mat_Sqrt:  [[0.15]]
grads:  [0.40929296]
Stock Position:  0.4092929618056458
Bond Position:  [-26.50923075]


portfolio before change:  [16.30778949]
curr_Stock_Price:  104.62835270681784
curr_Factors:  [104.62835271]
mat_Sqrt:  [[0.15]]
grads:  [-0.08453877]
Stock Position:  -0.08453876813610192
Bond Position:  [25.15294154]


portfolio before change:  [16.44380558]
curr_Stock_Price:  103.09382507296628
curr_Factors:  [103.09382507]
mat_Sqrt:  [[0.15]]
grads:  [-0.13831611]
Stock Position:  -0.13831611325685014
Bond Position:  [30.70334277]


portfolio before change:  [16.64109235]
curr_Stock_Price:  101.72297993416306
curr_Factors:  [101.72297993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00127315]
Stock Position:  -0.0012731510443478586
Bond Position:  [16.77060107]


portfolio before change:  [16.64522794]
curr_Stock_Price:  101.76821243200794
curr_Factors:  [101.76821243]
mat_Sqrt:  [[0.15]]
grads:  [-0.10668125]
Stock Position:  -0.10668124966499729
Bond Position:  [27.50198802]


portfolio before change:  [16.96812453]
curr_Stock_Price:  98.80592767964436
curr_Factors:  [98.80592768]
mat_Sqrt:  [[0.15]]
grads:  [-0.01699635]
Stock Position:  -0.01699634706665561
Bond Position:  [18.64746437]


portfolio before change:  [16.96994959]
curr_Stock_Price:  98.97286898913414
curr_Factors:  [98.97286899]
mat_Sqrt:  [[0.15]]
grads:  [0.07460644]
Stock Position:  0.07460643733918465
Bond Position:  [9.58593644]


portfolio before change:  [17.04467725]
curr_Stock_Price:  99.94236816085794
curr_Factors:  [99.94236816]
mat_Sqrt:  [[0.15]]
grads:  [0.18033323]
Stock Position:  0.18033322851674524
Bond Position:  [-0.97825266]


portfolio before change:  [17.01538865]
curr_Stock_Price:  99.78131074368154
curr_Factors:  [99.78131074]
mat_Sqrt:  [[0.15]]
grads:  [0.13289815]
Stock Position:  0.13289814534613065
Bond Position:  [3.75463752]


portfolio before change:  [16.86545941]
curr_Stock_Price:  98.6460953415048
curr_Factors:  [98.64609534]
mat_Sqrt:  [[0.15]]
grads:  [0.02608318]
Stock Position:  0.026083182559169228
Bond Position:  [14.2924553]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.86545941]
Stock Price:  99.22348469572182
PL:  [16.86545941]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.90048867e-02]
 [ 5.07430241e-03]
 [-1.02879921e-02]
 [ 2.54964555e-03]
 [ 7.33149510e-03]
 [ 5.68810841e-03]
 [-1.44684464e-02]
 [-2.28262656e-03]
 [-1.11868347e-03]
 [ 7.58122648e-03]
 [-5.55096604e-03]
 [-2.62727533e-02]
 [ 2.72709436e-03]
 [ 6.88367966e-04]
 [-3.38147772e-03]
 [ 1.06064387e-02]
 [-4.29945952e-02]
 [-2.47826001e-02]
 [ 4.59762211e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.27525705]
curr_Stock_Price:  99.27780199658484
curr_Factors:  [99.277802]
mat_Sqrt:  [[0.15]]
grads:  [0.12669924]
Stock Position:  0.12669924445886305
Bond Position:  [-21.85367956]


portfolio before change:  [-9.25122126]
curr_Stock_Price:  99.5106360558143
curr_Factors:  [99.51063606]
mat_Sqrt:  [[0.15]]
grads:  [0.03382868]
Stock Position:  0.03382868275649972
Bond Position:  [-12.617535]


portfolio before change:  [-9.20891529]
curr_Stock_Price:  100.85448824687532
curr_Factors:  [100.85448825]
mat_Sqrt:  [[0.15]]
grads:  [-0.06858661]
Stock Position:  -0.06858661417486053
Bond Position:  [-2.29164741]


portfolio before change:  [-9.1841665]
curr_Stock_Price:  100.48529424091537
curr_Factors:  [100.48529424]
mat_Sqrt:  [[0.15]]
grads:  [0.01699764]
Stock Position:  0.01699763699243073
Bond Position:  [-10.89217906]


portfolio before change:  [-9.19169693]
curr_Stock_Price:  100.20248784291056
curr_Factors:  [100.20248784]
mat_Sqrt:  [[0.15]]
grads:  [0.04887663]
Stock Position:  0.048876634020984244
Bond Position:  [-14.08925726]


portfolio before change:  [-9.26147425]
curr_Stock_Price:  98.84694095787248
curr_Factors:  [98.84694096]
mat_Sqrt:  [[0.15]]
grads:  [0.03792072]
Stock Position:  0.037920722757058475
Bond Position:  [-13.0098217]


portfolio before change:  [-9.23375265]
curr_Stock_Price:  99.6637625392948
curr_Factors:  [99.66376254]
mat_Sqrt:  [[0.15]]
grads:  [-0.09645631]
Stock Position:  -0.09645630946128562
Bond Position:  [0.37944607]


portfolio before change:  [-9.30156708]
curr_Stock_Price:  100.36780461114219
curr_Factors:  [100.36780461]
mat_Sqrt:  [[0.15]]
grads:  [-0.01521751]
Stock Position:  -0.015217510425138397
Bond Position:  [-7.77421896]


portfolio before change:  [-9.30448286]
curr_Stock_Price:  100.43167772060951
curr_Factors:  [100.43167772]
mat_Sqrt:  [[0.15]]
grads:  [-0.00745789]
Stock Position:  -0.007457889795159734
Bond Position:  [-8.55547448]


portfolio before change:  [-9.31196682]
curr_Stock_Price:  101.14834463430115
curr_Factors:  [101.14834463]
mat_Sqrt:  [[0.15]]
grads:  [0.05054151]
Stock Position:  0.05054150987450985
Bond Position:  [-14.42415688]


portfolio before change:  [-9.32101295]
curr_Stock_Price:  101.0407175667968
curr_Factors:  [101.04071757]
mat_Sqrt:  [[0.15]]
grads:  [-0.03700644]
Stock Position:  -0.03700644028967241
Bond Position:  [-5.58185567]


portfolio before change:  [-9.22083929]
curr_Stock_Price:  98.2960791344203
curr_Factors:  [98.29607913]
mat_Sqrt:  [[0.15]]
grads:  [-0.17515169]
Stock Position:  -0.1751516885402227
Bond Position:  [7.99588495]


portfolio before change:  [-9.18439585]
curr_Stock_Price:  98.09942552232404
curr_Factors:  [98.09942552]
mat_Sqrt:  [[0.15]]
grads:  [0.01818063]
Stock Position:  0.018180629054052856
Bond Position:  [-10.96790512]


portfolio before change:  [-9.16600928]
curr_Stock_Price:  99.26159085877994
curr_Factors:  [99.26159086]
mat_Sqrt:  [[0.15]]
grads:  [0.00458912]
Stock Position:  0.004589119771136862
Bond Position:  [-9.62153261]


portfolio before change:  [-9.16173669]
curr_Stock_Price:  100.7168318019556
curr_Factors:  [100.7168318]
mat_Sqrt:  [[0.15]]
grads:  [-0.02254318]
Stock Position:  -0.022543184814718988
Bond Position:  [-6.89125853]


portfolio before change:  [-9.14274233]
curr_Stock_Price:  99.79782286470609
curr_Factors:  [99.79782286]
mat_Sqrt:  [[0.15]]
grads:  [0.07070959]
Stock Position:  0.07070959116680009
Bond Position:  [-16.19940558]


portfolio before change:  [-8.99494253]
curr_Stock_Price:  101.94534136121366
curr_Factors:  [101.94534136]
mat_Sqrt:  [[0.15]]
grads:  [-0.28663063]
Stock Position:  -0.2866306347899622
Bond Position:  [20.22571538]


portfolio before change:  [-9.46918098]
curr_Stock_Price:  103.61751261067356
curr_Factors:  [103.61751261]
mat_Sqrt:  [[0.15]]
grads:  [-0.16521733]
Stock Position:  -0.16521733408286138
Bond Position:  [7.65022822]


portfolio before change:  [-9.2901989]
curr_Stock_Price:  102.5457771468739
curr_Factors:  [102.54577715]
mat_Sqrt:  [[0.15]]
grads:  [0.03065081]
Stock Position:  0.03065081403930645
Bond Position:  [-12.43331045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.2901989]
Stock Price:  102.93441306576119
PL:  [-12.22461197]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 7.91104302e-03]
 [-6.47387912e-03]
 [-5.64932188e-03]
 [ 3.60006474e-03]
 [ 8.15804011e-03]
 [ 8.94290961e-03]
 [-2.55141261e-03]
 [ 5.60596952e-04]
 [ 5.91098683e-04]
 [ 2.09269045e-02]
 [-9.98507603e-03]
 [-2.22164708e-02]
 [-4.54819189e-04]
 [-2.12055349e-02]
 [ 9.59547785e-03]
 [ 7.71878529e-03]
 [-4.58054804e-02]
 [-1.88135196e-02]
 [ 4.11595223e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.39420733]
curr_Stock_Price:  100.82564290105167
curr_Factors:  [100.8256429]
mat_Sqrt:  [[0.15]]
grads:  [0.05274029]
Stock Position:  0.052740286767201015
Bond Position:  [9.07663401]


portfolio before change:  [14.37144104]
curr_Stock_Price:  100.35094453651845
curr_Factors:  [100.35094454]
mat_Sqrt:  [[0.15]]
grads:  [-0.04315919]
Stock Position:  -0.043159194152842494
Bond Position:  [18.70250694]


portfolio before change:  [14.39232314]
curr_Stock_Price:  99.97545364520742
curr_Factors:  [99.97545365]
mat_Sqrt:  [[0.15]]
grads:  [-0.03766215]
Stock Position:  -0.03766214587858878
Bond Position:  [18.15761326]


portfolio before change:  [14.40806659]
curr_Stock_Price:  99.67798038036382
curr_Factors:  [99.67798038]
mat_Sqrt:  [[0.15]]
grads:  [0.02400043]
Stock Position:  0.02400043158843146
Bond Position:  [12.01575204]


portfolio before change:  [14.40265209]
curr_Stock_Price:  99.32720264549849
curr_Factors:  [99.32720265]
mat_Sqrt:  [[0.15]]
grads:  [0.05438693]
Stock Position:  0.054386934084432736
Bond Position:  [9.00055006]


portfolio before change:  [14.45710124]
curr_Stock_Price:  100.2869688381582
curr_Factors:  [100.28696884]
mat_Sqrt:  [[0.15]]
grads:  [0.0596194]
Stock Position:  0.05961939740962733
Bond Position:  [8.47805259]


portfolio before change:  [14.59906727]
curr_Stock_Price:  102.63261903175523
curr_Factors:  [102.63261903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01700942]
Stock Position:  -0.01700941739061312
Bond Position:  [16.34478833]


portfolio before change:  [14.60387252]
curr_Stock_Price:  102.5903756138813
curr_Factors:  [102.59037561]
mat_Sqrt:  [[0.15]]
grads:  [0.00373731]
Stock Position:  0.0037373130157667784
Bond Position:  [14.22046017]


portfolio before change:  [14.60995079]
curr_Stock_Price:  103.26538340676912
curr_Factors:  [103.26538341]
mat_Sqrt:  [[0.15]]
grads:  [0.00394066]
Stock Position:  0.003940657889249435
Bond Position:  [14.20301724]


portfolio before change:  [14.60744852]
curr_Stock_Price:  101.72922672882888
curr_Factors:  [101.72922673]
mat_Sqrt:  [[0.15]]
grads:  [0.1395127]
Stock Position:  0.13951269688025192
Bond Position:  [0.41492975]


portfolio before change:  [14.77720299]
curr_Stock_Price:  102.94525023539532
curr_Factors:  [102.94525024]
mat_Sqrt:  [[0.15]]
grads:  [-0.06656717]
Stock Position:  -0.06656717356206708
Bond Position:  [21.62997733]


portfolio before change:  [14.87394638]
curr_Stock_Price:  101.5731742132436
curr_Factors:  [101.57317421]
mat_Sqrt:  [[0.15]]
grads:  [-0.14810981]
Stock Position:  -0.14810980517756114
Bond Position:  [29.91792942]


portfolio before change:  [14.76434535]
curr_Stock_Price:  102.36367860672797
curr_Factors:  [102.36367861]
mat_Sqrt:  [[0.15]]
grads:  [-0.00303213]
Stock Position:  -0.0030321279293161452
Bond Position:  [15.07472511]


portfolio before change:  [14.76186284]
curr_Stock_Price:  104.4254854148037
curr_Factors:  [104.42548541]
mat_Sqrt:  [[0.15]]
grads:  [-0.14137023]
Stock Position:  -0.14137023293421008
Bond Position:  [29.52451803]


portfolio before change:  [14.66397787]
curr_Stock_Price:  105.17010481450134
curr_Factors:  [105.17010481]
mat_Sqrt:  [[0.15]]
grads:  [0.06396985]
Stock Position:  0.06396985234301629
Bond Position:  [7.93626179]


portfolio before change:  [14.63684538]
curr_Stock_Price:  104.71494038328805
curr_Factors:  [104.71494038]
mat_Sqrt:  [[0.15]]
grads:  [0.05145857]
Stock Position:  0.05145856861704723
Bond Position:  [9.24836444]


portfolio before change:  [14.54330866]
curr_Stock_Price:  102.85229419515842
curr_Factors:  [102.8522942]
mat_Sqrt:  [[0.15]]
grads:  [-0.30536987]
Stock Position:  -0.30536986961624685
Bond Position:  [45.95130032]


portfolio before change:  [14.9114824]
curr_Stock_Price:  101.68425334140494
curr_Factors:  [101.68425334]
mat_Sqrt:  [[0.15]]
grads:  [-0.12542346]
Stock Position:  -0.12542346388289297
Bond Position:  [27.66507368]


portfolio before change:  [14.92029926]
curr_Stock_Price:  101.66910682129736
curr_Factors:  [101.66910682]
mat_Sqrt:  [[0.15]]
grads:  [0.02743968]
Stock Position:  0.027439681521380356
Bond Position:  [12.13053135]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.92029926]
Stock Price:  101.1257743792773
PL:  [13.79452488]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.55678505e-02]
 [-7.87382898e-03]
 [ 1.46556804e-02]
 [ 5.52276476e-04]
 [ 5.47335944e-03]
 [-2.94595561e-02]
 [-9.59616620e-03]
 [ 1.04944604e-03]
 [ 4.37192935e-03]
 [ 6.29304477e-02]
 [-1.19366385e-02]
 [-1.93258721e-02]
 [-2.15835471e-03]
 [-2.46785779e-02]
 [ 1.33740298e-02]
 [ 6.25298498e-03]
 [-2.25801289e-02]
 [-8.22728464e-03]
 [ 4.77200039e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.88715324]
curr_Stock_Price:  99.76093964208386
curr_Factors:  [99.76093964]
mat_Sqrt:  [[0.15]]
grads:  [0.10378567]
Stock Position:  0.10378566991576975
Bond Position:  [-12.24090919]


portfolio before change:  [-1.74879462]
curr_Stock_Price:  101.12354811003368
curr_Factors:  [101.12354811]
mat_Sqrt:  [[0.15]]
grads:  [-0.05249219]
Stock Position:  -0.05249219319661002
Bond Position:  [3.55940221]


portfolio before change:  [-1.82870343]
curr_Stock_Price:  102.66280136689518
curr_Factors:  [102.66280137]
mat_Sqrt:  [[0.15]]
grads:  [0.09770454]
Stock Position:  0.09770453601258003
Bond Position:  [-11.85932481]


portfolio before change:  [-1.8194945]
curr_Stock_Price:  102.78740289826422
curr_Factors:  [102.7874029]
mat_Sqrt:  [[0.15]]
grads:  [0.00368184]
Stock Position:  0.003681843175964986
Bond Position:  [-2.1979416]


portfolio before change:  [-1.81881884]
curr_Stock_Price:  103.12017446517525
curr_Factors:  [103.12017447]
mat_Sqrt:  [[0.15]]
grads:  [0.03648906]
Stock Position:  0.036489062903558626
Bond Position:  [-5.58157738]


portfolio before change:  [-1.78771031]
curr_Stock_Price:  104.01096461147806
curr_Factors:  [104.01096461]
mat_Sqrt:  [[0.15]]
grads:  [-0.19639704]
Stock Position:  -0.19639704099730645
Bond Position:  [18.63973537]


portfolio before change:  [-1.86600277]
curr_Stock_Price:  104.4333384325238
curr_Factors:  [104.43333843]
mat_Sqrt:  [[0.15]]
grads:  [-0.06397444]
Stock Position:  -0.06397444131209448
Bond Position:  [4.81506171]


portfolio before change:  [-1.84356267]
curr_Stock_Price:  104.10139056043626
curr_Factors:  [104.10139056]
mat_Sqrt:  [[0.15]]
grads:  [0.00699631]
Stock Position:  0.006996306917126224
Bond Position:  [-2.57188795]


portfolio before change:  [-1.83325895]
curr_Stock_Price:  105.66604050674614
curr_Factors:  [105.66604051]
mat_Sqrt:  [[0.15]]
grads:  [0.0291462]
Stock Position:  0.029146195685595205
Bond Position:  [-4.91302205]


portfolio before change:  [-1.85641817]
curr_Stock_Price:  104.91359901710439
curr_Factors:  [104.91359902]
mat_Sqrt:  [[0.15]]
grads:  [0.41953632]
Stock Position:  0.4195363182842472
Bond Position:  [-45.87148324]


portfolio before change:  [-2.23192438]
curr_Stock_Price:  104.04588651542693
curr_Factors:  [104.04588652]
mat_Sqrt:  [[0.15]]
grads:  [-0.07957759]
Stock Position:  -0.07957758972511242
Bond Position:  [6.04779649]


portfolio before change:  [-2.28167571]
curr_Stock_Price:  104.6900813469989
curr_Factors:  [104.69008135]
mat_Sqrt:  [[0.15]]
grads:  [-0.12883915]
Stock Position:  -0.1288391473626113
Bond Position:  [11.2065051]


portfolio before change:  [-2.41615671]
curr_Stock_Price:  105.75561904436066
curr_Factors:  [105.75561904]
mat_Sqrt:  [[0.15]]
grads:  [-0.01438903]
Stock Position:  -0.01438903141931624
Bond Position:  [-0.89443578]


portfolio before change:  [-2.4296722]
curr_Stock_Price:  106.67936806126248
curr_Factors:  [106.67936806]
mat_Sqrt:  [[0.15]]
grads:  [-0.16452385]
Stock Position:  -0.1645238529510174
Bond Position:  [15.12162847]


portfolio before change:  [-2.36272767]
curr_Stock_Price:  106.29545019957231
curr_Factors:  [106.2954502]
mat_Sqrt:  [[0.15]]
grads:  [0.0891602]
Stock Position:  0.0891601987506972
Bond Position:  [-11.84005114]


portfolio before change:  [-2.37127537]
curr_Stock_Price:  106.23278421883428
curr_Factors:  [106.23278422]
mat_Sqrt:  [[0.15]]
grads:  [0.04168657]
Stock Position:  0.04168656650091605
Bond Position:  [-6.79975539]


portfolio before change:  [-2.32979644]
curr_Stock_Price:  107.26858745351956
curr_Factors:  [107.26858745]
mat_Sqrt:  [[0.15]]
grads:  [-0.15053419]
Stock Position:  -0.1505341928612426
Bond Position:  [13.8177938]


portfolio before change:  [-2.29717199]
curr_Stock_Price:  107.07481377082443
curr_Factors:  [107.07481377]
mat_Sqrt:  [[0.15]]
grads:  [-0.05484856]
Stock Position:  -0.05484856429694478
Bond Position:  [3.57572782]


portfolio before change:  [-2.29653078]
curr_Stock_Price:  107.0794233501944
curr_Factors:  [107.07942335]
mat_Sqrt:  [[0.15]]
grads:  [0.03181334]
Stock Position:  0.031813335929430926
Bond Position:  [-5.70308444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29653078]
Stock Price:  106.36620170989481
PL:  [-8.66273249]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.27580025e-02]
 [ 9.00111557e-03]
 [ 1.06993987e-02]
 [-5.78583016e-04]
 [ 8.66840789e-03]
 [ 1.77520916e-02]
 [-6.63991304e-03]
 [ 7.78400158e-03]
 [ 7.71613675e-03]
 [-3.73064427e-02]
 [ 1.28742655e-03]
 [-2.64215326e-02]
 [ 1.65674336e-03]
 [-7.88324244e-03]
 [ 6.83218949e-04]
 [ 1.67539174e-03]
 [-3.57474914e-02]
 [ 1.06908845e-02]
 [-9.48253631e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.93025131]
curr_Stock_Price:  99.49654529515311
curr_Factors:  [99.4965453]
mat_Sqrt:  [[0.15]]
grads:  [0.08505335]
Stock Position:  0.08505335005451245
Bond Position:  [-14.39276581]


portfolio before change:  [-6.10595259]
curr_Stock_Price:  97.47307847218106
curr_Factors:  [97.47307847]
mat_Sqrt:  [[0.15]]
grads:  [0.06000744]
Stock Position:  0.060007437161126574
Bond Position:  [-11.95506222]


portfolio before change:  [-6.0720605]
curr_Stock_Price:  98.0876893176025
curr_Factors:  [98.08768932]
mat_Sqrt:  [[0.15]]
grads:  [0.07132932]
Stock Position:  0.07132932465364678
Bond Position:  [-13.06858914]


portfolio before change:  [-6.14761839]
curr_Stock_Price:  97.07421651162478
curr_Factors:  [97.07421651]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385722]
Stock Position:  -0.0038572201046152485
Bond Position:  [-5.77318177]


portfolio before change:  [-6.15248344]
curr_Stock_Price:  97.96127287543334
curr_Factors:  [97.96127288]
mat_Sqrt:  [[0.15]]
grads:  [0.05778939]
Stock Position:  0.05778938593230004
Bond Position:  [-11.81360524]


portfolio before change:  [-6.15995679]
curr_Stock_Price:  97.88306498344764
curr_Factors:  [97.88306498]
mat_Sqrt:  [[0.15]]
grads:  [0.11834728]
Stock Position:  0.11834727735628536
Bond Position:  [-17.74415103]


portfolio before change:  [-6.3558121]
curr_Stock_Price:  96.26563260963744
curr_Factors:  [96.26563261]
mat_Sqrt:  [[0.15]]
grads:  [-0.04426609]
Stock Position:  -0.044266086933431724
Bond Position:  [-2.09450924]


portfolio before change:  [-6.31597011]
curr_Stock_Price:  95.35374528684974
curr_Factors:  [95.35374529]
mat_Sqrt:  [[0.15]]
grads:  [0.05189334]
Stock Position:  0.051893343892251295
Bond Position:  [-11.26419481]


portfolio before change:  [-6.32706092]
curr_Stock_Price:  95.19429505188799
curr_Factors:  [95.19429505]
mat_Sqrt:  [[0.15]]
grads:  [0.05144091]
Stock Position:  0.051440911688454
Bond Position:  [-11.22394224]


portfolio before change:  [-6.3670753]
curr_Stock_Price:  94.47097887072101
curr_Factors:  [94.47097887]
mat_Sqrt:  [[0.15]]
grads:  [-0.24870962]
Stock Position:  -0.2487096179233977
Bond Position:  [17.12876576]


portfolio before change:  [-5.81482151]
curr_Stock_Price:  92.26772246854227
curr_Factors:  [92.26772247]
mat_Sqrt:  [[0.15]]
grads:  [0.00858284]
Stock Position:  0.008582843687891679
Bond Position:  [-6.60674095]


portfolio before change:  [-5.82016669]
curr_Stock_Price:  91.83741230452249
curr_Factors:  [91.8374123]
mat_Sqrt:  [[0.15]]
grads:  [-0.17614355]
Stock Position:  -0.17614355071728993
Bond Position:  [10.3564012]


portfolio before change:  [-5.90816999]
curr_Stock_Price:  92.35172418019093
curr_Factors:  [92.35172418]
mat_Sqrt:  [[0.15]]
grads:  [0.01104496]
Stock Position:  0.01104495575108658
Bond Position:  [-6.92819069]


portfolio before change:  [-5.91343487]
curr_Stock_Price:  92.03188388925996
curr_Factors:  [92.03188389]
mat_Sqrt:  [[0.15]]
grads:  [-0.05255495]
Stock Position:  -0.05255494956905859
Bond Position:  [-1.07670386]


portfolio before change:  [-5.9676817]
curr_Stock_Price:  93.05895391063606
curr_Factors:  [93.05895391]
mat_Sqrt:  [[0.15]]
grads:  [0.00455479]
Stock Position:  0.004554792993521115
Bond Position:  [-6.39154597]


portfolio before change:  [-5.9759109]
curr_Stock_Price:  91.60309821489223
curr_Factors:  [91.60309821]
mat_Sqrt:  [[0.15]]
grads:  [0.01116928]
Stock Position:  0.01116927824749697
Bond Position:  [-6.9990514]


portfolio before change:  [-5.98160969]
curr_Stock_Price:  91.2495566667811
curr_Factors:  [91.24955667]
mat_Sqrt:  [[0.15]]
grads:  [-0.23831661]
Stock Position:  -0.2383166093596691
Bond Position:  [15.76467526]


portfolio before change:  [-6.00396015]
curr_Stock_Price:  91.35988098746002
curr_Factors:  [91.35988099]
mat_Sqrt:  [[0.15]]
grads:  [0.07127256]
Stock Position:  0.07127256305456761
Bond Position:  [-12.51541302]


portfolio before change:  [-6.01402644]
curr_Stock_Price:  91.26254969221434
curr_Factors:  [91.26254969]
mat_Sqrt:  [[0.15]]
grads:  [-0.00632169]
Stock Position:  -0.0063216908764479034
Bond Position:  [-5.43709281]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.01402644]
Stock Price:  90.84265993808947
PL:  [-6.01402644]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.96799931e-03]
 [-7.95875465e-03]
 [-6.86969185e-03]
 [ 3.34813396e-03]
 [ 7.69821894e-03]
 [ 1.38012119e-03]
 [-1.58346065e-02]
 [-2.22197063e-03]
 [-1.09353012e-03]
 [ 2.09442142e-03]
 [-6.00005693e-03]
 [-2.44377673e-02]
 [-3.66756059e-04]
 [-2.02709163e-02]
 [-3.59494318e-05]
 [ 1.06379238e-02]
 [ 4.67169866e-02]
 [ 1.99830373e-02]
 [ 3.82624360e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.87827947]
curr_Stock_Price:  99.56533793960686
curr_Factors:  [99.56533794]
mat_Sqrt:  [[0.15]]
grads:  [0.06645333]
Stock Position:  0.06645332875326501
Bond Position:  [-11.4947276]


portfolio before change:  [-4.79102416]
curr_Stock_Price:  100.92161845376667
curr_Factors:  [100.92161845]
mat_Sqrt:  [[0.15]]
grads:  [-0.05305836]
Stock Position:  -0.05305836431750699
Bond Position:  [0.56371184]


portfolio before change:  [-4.74398022]
curr_Stock_Price:  100.0376298805316
curr_Factors:  [100.03762988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04579795]
Stock Position:  -0.045797945646455764
Bond Position:  [-0.16246229]


portfolio before change:  [-4.67508825]
curr_Stock_Price:  98.53248385558928
curr_Factors:  [98.53248386]
mat_Sqrt:  [[0.15]]
grads:  [0.02232089]
Stock Position:  0.0223208930546623
Bond Position:  [-6.87442128]


portfolio before change:  [-4.64770407]
curr_Stock_Price:  99.8363292248726
curr_Factors:  [99.83632922]
mat_Sqrt:  [[0.15]]
grads:  [0.05132146]
Stock Position:  0.05132145957723204
Bond Position:  [-9.77145021]


portfolio before change:  [-4.66205667]
curr_Stock_Price:  99.60427373199357
curr_Factors:  [99.60427373]
mat_Sqrt:  [[0.15]]
grads:  [0.00920081]
Stock Position:  0.00920080792735772
Bond Position:  [-5.57849646]


portfolio before change:  [-4.66697122]
curr_Stock_Price:  99.22172609959775
curr_Factors:  [99.2217261]
mat_Sqrt:  [[0.15]]
grads:  [-0.10556404]
Stock Position:  -0.10556404366161738
Bond Position:  [5.80727541]


portfolio before change:  [-4.81465212]
curr_Stock_Price:  100.63445054121968
curr_Factors:  [100.63445054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01481314]
Stock Position:  -0.014813137507048034
Bond Position:  [-3.32394017]


portfolio before change:  [-4.82529376]
curr_Stock_Price:  101.29673758021667
curr_Factors:  [101.29673758]
mat_Sqrt:  [[0.15]]
grads:  [-0.0072902]
Stock Position:  -0.007290200782497031
Bond Position:  [-4.0868202]


portfolio before change:  [-4.82300689]
curr_Stock_Price:  100.84288183098106
curr_Factors:  [100.84288183]
mat_Sqrt:  [[0.15]]
grads:  [0.01396281]
Stock Position:  0.013962809472314222
Bond Position:  [-6.23105684]


portfolio before change:  [-4.81923451]
curr_Stock_Price:  101.22463434157692
curr_Factors:  [101.22463434]
mat_Sqrt:  [[0.15]]
grads:  [-0.04000038]
Stock Position:  -0.04000037955161479
Bond Position:  [-0.77021072]


portfolio before change:  [-4.76828808]
curr_Stock_Price:  99.94617121375204
curr_Factors:  [99.94617121]
mat_Sqrt:  [[0.15]]
grads:  [-0.16291845]
Stock Position:  -0.16291844884743859
Bond Position:  [11.5147871]


portfolio before change:  [-5.12442648]
curr_Stock_Price:  102.14983486067199
curr_Factors:  [102.14983486]
mat_Sqrt:  [[0.15]]
grads:  [-0.00244504]
Stock Position:  -0.0024450403912669927
Bond Position:  [-4.87466601]


portfolio before change:  [-5.12646652]
curr_Stock_Price:  102.48570588083001
curr_Factors:  [102.48570588]
mat_Sqrt:  [[0.15]]
grads:  [-0.13513944]
Stock Position:  -0.13513944179431567
Bond Position:  [8.72339456]


portfolio before change:  [-5.09878938]
curr_Stock_Price:  102.2970413085142
curr_Factors:  [102.29704131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00023966]
Stock Position:  -0.00023966287893710043
Bond Position:  [-5.07427257]


portfolio before change:  [-5.09965683]
curr_Stock_Price:  100.62270310373846
curr_Factors:  [100.6227031]
mat_Sqrt:  [[0.15]]
grads:  [0.07091949]
Stock Position:  0.07091949174054604
Bond Position:  [-12.23576779]


portfolio before change:  [-5.20248981]
curr_Stock_Price:  99.2158449634926
curr_Factors:  [99.21584496]
mat_Sqrt:  [[0.15]]
grads:  [0.31144658]
Stock Position:  0.31144657722638047
Bond Position:  [-36.10292513]


portfolio before change:  [-5.5235968]
curr_Stock_Price:  98.21381075850563
curr_Factors:  [98.21381076]
mat_Sqrt:  [[0.15]]
grads:  [0.13322025]
Stock Position:  0.13322024841027158
Bond Position:  [-18.60766506]


portfolio before change:  [-5.36013538]
curr_Stock_Price:  99.47573539390065
curr_Factors:  [99.47573539]
mat_Sqrt:  [[0.15]]
grads:  [0.02550829]
Stock Position:  0.025508290635327023
Bond Position:  [-7.89759135]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.36013538]
Stock Price:  99.17418338761195
PL:  [-5.36013538]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-1.55685224e-02]
 [-7.78656066e-03]
 [-1.02913106e-02]
 [ 3.51424748e-03]
 [ 8.63323585e-03]
 [ 1.19424807e-02]
 [-1.39592574e-02]
 [-2.30794405e-03]
 [-1.08704213e-03]
 [ 2.50399762e-02]
 [-7.82342921e-03]
 [-2.10529488e-02]
 [-8.41081386e-04]
 [-2.14689832e-02]
 [ 6.76965957e-03]
 [ 8.00574761e-03]
 [-2.95591023e-02]
 [-1.84793715e-02]
 [ 4.68861727e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.25609355]
curr_Stock_Price:  101.07818708081733
curr_Factors:  [101.07818708]
mat_Sqrt:  [[0.15]]
grads:  [-0.10379015]
Stock Position:  -0.10379014903629502
Bond Position:  [28.74701365]


portfolio before change:  [18.23703674]
curr_Stock_Price:  101.33104793665922
curr_Factors:  [101.33104794]
mat_Sqrt:  [[0.15]]
grads:  [-0.0519104]
Stock Position:  -0.051910404411354936
Bond Position:  [23.49717242]


portfolio before change:  [18.26510932]
curr_Stock_Price:  100.9034350390719
curr_Factors:  [100.90343504]
mat_Sqrt:  [[0.15]]
grads:  [-0.06860874]
Stock Position:  -0.06860873724052963
Bond Position:  [25.18796658]


portfolio before change:  [18.34713842]
curr_Stock_Price:  99.7996205839468
curr_Factors:  [99.79962058]
mat_Sqrt:  [[0.15]]
grads:  [0.02342832]
Stock Position:  0.023428316516480134
Bond Position:  [16.00900132]


portfolio before change:  [18.31232962]
curr_Stock_Price:  98.14301206684316
curr_Factors:  [98.14301207]
mat_Sqrt:  [[0.15]]
grads:  [0.05755491]
Stock Position:  0.05755490564522586
Bond Position:  [12.66371782]


portfolio before change:  [18.32755597]
curr_Stock_Price:  98.35255149377096
curr_Factors:  [98.35255149]
mat_Sqrt:  [[0.15]]
grads:  [0.07961654]
Stock Position:  0.07961653784876241
Bond Position:  [10.49706633]


portfolio before change:  [18.32838249]
curr_Stock_Price:  98.32996732358927
curr_Factors:  [98.32996732]
mat_Sqrt:  [[0.15]]
grads:  [-0.09306172]
Stock Position:  -0.09306171615249191
Bond Position:  [27.479138]


portfolio before change:  [18.12494646]
curr_Stock_Price:  100.58982969943462
curr_Factors:  [100.5898297]
mat_Sqrt:  [[0.15]]
grads:  [-0.01538629]
Stock Position:  -0.015386293640525142
Bond Position:  [19.67265112]


portfolio before change:  [18.11885112]
curr_Stock_Price:  101.3056694776717
curr_Factors:  [101.30566948]
mat_Sqrt:  [[0.15]]
grads:  [-0.00724695]
Stock Position:  -0.007246947556230304
Bond Position:  [18.85300799]


portfolio before change:  [18.11913851]
curr_Stock_Price:  101.91647177576853
curr_Factors:  [101.91647178]
mat_Sqrt:  [[0.15]]
grads:  [0.16693317]
Stock Position:  0.16693317437842148
Bond Position:  [1.10589835]


portfolio before change:  [18.16995416]
curr_Stock_Price:  102.21922255416256
curr_Factors:  [102.21922255]
mat_Sqrt:  [[0.15]]
grads:  [-0.05215619]
Stock Position:  -0.052156194726044026
Bond Position:  [23.50131984]


portfolio before change:  [18.14542739]
curr_Stock_Price:  102.80214165960723
curr_Factors:  [102.80214166]
mat_Sqrt:  [[0.15]]
grads:  [-0.14035299]
Stock Position:  -0.14035299172927648
Bond Position:  [32.57401552]


portfolio before change:  [18.10029046]
curr_Stock_Price:  103.18176622533451
curr_Factors:  [103.18176623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00560721]
Stock Position:  -0.005607209238990766
Bond Position:  [18.67885222]


portfolio before change:  [18.09705251]
curr_Stock_Price:  104.59213835361855
curr_Factors:  [104.59213835]
mat_Sqrt:  [[0.15]]
grads:  [-0.14312655]
Stock Position:  -0.14312655447994585
Bond Position:  [33.0669649]


portfolio before change:  [18.13827318]
curr_Stock_Price:  104.36190230238088
curr_Factors:  [104.3619023]
mat_Sqrt:  [[0.15]]
grads:  [0.04513106]
Stock Position:  0.0451310638298235
Bond Position:  [13.4283095]


portfolio before change:  [18.13940994]
curr_Stock_Price:  104.31269590538827
curr_Factors:  [104.31269591]
mat_Sqrt:  [[0.15]]
grads:  [0.05337165]
Stock Position:  0.05337165070867435
Bond Position:  [12.57206917]


portfolio before change:  [18.2550991]
curr_Stock_Price:  106.42141367281005
curr_Factors:  [106.42141367]
mat_Sqrt:  [[0.15]]
grads:  [-0.19706068]
Stock Position:  -0.1970606822879729
Bond Position:  [39.22657548]


portfolio before change:  [18.53389789]
curr_Stock_Price:  105.05639795260272
curr_Factors:  [105.05639795]
mat_Sqrt:  [[0.15]]
grads:  [-0.12319581]
Stock Position:  -0.12319581003343133
Bond Position:  [31.47640594]


portfolio before change:  [18.75371412]
curr_Stock_Price:  103.33599738692305
curr_Factors:  [103.33599739]
mat_Sqrt:  [[0.15]]
grads:  [0.03125745]
Stock Position:  0.03125744844764046
Bond Position:  [15.52369451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.75371412]
Stock Price:  101.53483548272419
PL:  [17.21887864]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-2.64349212e-02]
 [-7.02381740e-03]
 [ 1.67762661e-02]
 [ 2.54586864e-03]
 [ 5.45528322e-03]
 [-2.54783750e-02]
 [-7.90607770e-03]
 [ 1.07051113e-03]
 [ 2.32873090e-03]
 [ 5.22411649e-02]
 [-1.18913697e-02]
 [-1.90776478e-02]
 [-2.07156930e-03]
 [-2.29356170e-02]
 [ 1.15939609e-02]
 [ 5.82198184e-03]
 [-2.76865418e-02]
 [-1.31065551e-02]
 [ 4.55576999e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.04338371]
curr_Stock_Price:  101.195065129561
curr_Factors:  [101.19506513]
mat_Sqrt:  [[0.15]]
grads:  [-0.17623281]
Stock Position:  -0.17623280806999125
Bond Position:  [37.8772742]


portfolio before change:  [19.86176959]
curr_Stock_Price:  102.2793389408052
curr_Factors:  [102.27933894]
mat_Sqrt:  [[0.15]]
grads:  [-0.04682545]
Stock Position:  -0.0468254493513498
Bond Position:  [24.6510456]


portfolio before change:  [19.84384872]
curr_Stock_Price:  102.7936832166272
curr_Factors:  [102.79368322]
mat_Sqrt:  [[0.15]]
grads:  [0.11184177]
Stock Position:  0.1118417739078795
Bond Position:  [8.34722084]


portfolio before change:  [19.80547259]
curr_Stock_Price:  102.4318935138925
curr_Factors:  [102.43189351]
mat_Sqrt:  [[0.15]]
grads:  [0.01697246]
Stock Position:  0.01697245761451419
Bond Position:  [18.06695161]


portfolio before change:  [19.82229524]
curr_Stock_Price:  103.15691229352723
curr_Factors:  [103.15691229]
mat_Sqrt:  [[0.15]]
grads:  [0.03636855]
Stock Position:  0.03636855481310787
Bond Position:  [16.07062742]


portfolio before change:  [19.84755508]
curr_Stock_Price:  103.74097952873498
curr_Factors:  [103.74097953]
mat_Sqrt:  [[0.15]]
grads:  [-0.16985583]
Stock Position:  -0.16985583342606528
Bond Position:  [37.46856562]


portfolio before change:  [19.81270092]
curr_Stock_Price:  104.00133252809631
curr_Factors:  [104.00133253]
mat_Sqrt:  [[0.15]]
grads:  [-0.05270718]
Stock Position:  -0.05270718466622366
Bond Position:  [25.29431835]


portfolio before change:  [19.81031967]
curr_Stock_Price:  104.16650201549088
curr_Factors:  [104.16650202]
mat_Sqrt:  [[0.15]]
grads:  [0.00713674]
Stock Position:  0.007136740891929234
Bond Position:  [19.06691033]


portfolio before change:  [19.81632754]
curr_Stock_Price:  104.34032731166694
curr_Factors:  [104.34032731]
mat_Sqrt:  [[0.15]]
grads:  [0.01552487]
Stock Position:  0.015524872694349552
Bond Position:  [18.19645724]


portfolio before change:  [19.81443617]
curr_Stock_Price:  103.92544118877301
curr_Factors:  [103.92544119]
mat_Sqrt:  [[0.15]]
grads:  [0.34827443]
Stock Position:  0.34827443297020727
Bond Position:  [-16.38013794]


portfolio before change:  [19.83994867]
curr_Stock_Price:  104.01045474944465
curr_Factors:  [104.01045475]
mat_Sqrt:  [[0.15]]
grads:  [-0.0792758]
Stock Position:  -0.07927579828201642
Bond Position:  [28.0854605]


portfolio before change:  [19.76950183]
curr_Stock_Price:  104.9876645108895
curr_Factors:  [104.98766451]
mat_Sqrt:  [[0.15]]
grads:  [-0.12718432]
Stock Position:  -0.1271843184796467
Bond Position:  [33.12228639]


portfolio before change:  [19.70018052]
curr_Stock_Price:  105.59782550845671
curr_Factors:  [105.59782551]
mat_Sqrt:  [[0.15]]
grads:  [-0.01381046]
Stock Position:  -0.013810462003031012
Bond Position:  [21.15853528]


portfolio before change:  [19.70677959]
curr_Stock_Price:  105.5030588982199
curr_Factors:  [105.5030589]
mat_Sqrt:  [[0.15]]
grads:  [-0.15290411]
Stock Position:  -0.15290411349145105
Bond Position:  [35.83863128]


portfolio before change:  [19.6769981]
curr_Stock_Price:  105.75643511065229
curr_Factors:  [105.75643511]
mat_Sqrt:  [[0.15]]
grads:  [0.07729307]
Stock Position:  0.0772930723820419
Bond Position:  [11.50275831]


portfolio before change:  [19.73925378]
curr_Stock_Price:  106.5246750804
curr_Factors:  [106.52467508]
mat_Sqrt:  [[0.15]]
grads:  [0.03881321]
Stock Position:  0.03881321224574179
Bond Position:  [15.60468896]


portfolio before change:  [19.74797087]
curr_Stock_Price:  106.64874197315477
curr_Factors:  [106.64874197]
mat_Sqrt:  [[0.15]]
grads:  [-0.18457695]
Stock Position:  -0.18457694509652134
Bond Position:  [39.43286987]


portfolio before change:  [19.8595195]
curr_Stock_Price:  106.0978108963534
curr_Factors:  [106.0978109]
mat_Sqrt:  [[0.15]]
grads:  [-0.08737703]
Stock Position:  -0.08737703422069047
Bond Position:  [29.13003155]


portfolio before change:  [19.90030617]
curr_Stock_Price:  105.71437768341471
curr_Factors:  [105.71437768]
mat_Sqrt:  [[0.15]]
grads:  [0.0303718]
Stock Position:  0.030371799924853664
Bond Position:  [16.68957025]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.90030617]
Stock Price:  105.10663628746399
PL:  [14.79366989]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.68308344e-02]
 [ 5.61823751e-03]
 [-8.31669001e-03]
 [ 3.52215877e-03]
 [ 7.62449796e-03]
 [ 3.37274967e-03]
 [-3.19965858e-03]
 [ 5.00618301e-04]
 [-9.24009460e-04]
 [ 3.06300376e-02]
 [-7.81761914e-03]
 [-2.35857975e-02]
 [ 2.14607354e-03]
 [-7.33327471e-04]
 [-2.79720578e-03]
 [ 1.14772934e-02]
 [ 4.57707955e-02]
 [ 2.08522570e-02]
 [ 3.86534017e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.59635541]
curr_Stock_Price:  99.77995607488215
curr_Factors:  [99.77995607]
mat_Sqrt:  [[0.15]]
grads:  [0.11220556]
Stock Position:  0.11220556259576012
Bond Position:  [-12.79222152]


portfolio before change:  [-1.64114123]
curr_Stock_Price:  99.40932059414227
curr_Factors:  [99.40932059]
mat_Sqrt:  [[0.15]]
grads:  [0.03745492]
Stock Position:  0.03745491674272728
Bond Position:  [-5.36450905]


portfolio before change:  [-1.61618797]
curr_Stock_Price:  100.11135252270763
curr_Factors:  [100.11135252]
mat_Sqrt:  [[0.15]]
grads:  [-0.0554446]
Stock Position:  -0.05544460006312955
Bond Position:  [3.93444593]


portfolio before change:  [-1.535546]
curr_Stock_Price:  98.67463482349852
curr_Factors:  [98.67463482]
mat_Sqrt:  [[0.15]]
grads:  [0.02348106]
Stock Position:  0.023481058473982935
Bond Position:  [-3.85253087]


portfolio before change:  [-1.50750306]
curr_Stock_Price:  99.9099365781752
curr_Factors:  [99.90993658]
mat_Sqrt:  [[0.15]]
grads:  [0.05082999]
Stock Position:  0.05082998640244711
Bond Position:  [-6.58592378]


portfolio before change:  [-1.41938284]
curr_Stock_Price:  101.67595920282668
curr_Factors:  [101.6759592]
mat_Sqrt:  [[0.15]]
grads:  [0.022485]
Stock Position:  0.0224849978068179
Bond Position:  [-3.70556656]


portfolio before change:  [-1.39507311]
curr_Stock_Price:  102.7983180992065
curr_Factors:  [102.7983181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02133106]
Stock Position:  -0.02133105721039502
Bond Position:  [0.79772369]


portfolio before change:  [-1.38810314]
curr_Stock_Price:  102.48091634933516
curr_Factors:  [102.48091635]
mat_Sqrt:  [[0.15]]
grads:  [0.00333746]
Stock Position:  0.0033374553392741765
Bond Position:  [-1.73012862]


portfolio before change:  [-1.39170899]
curr_Stock_Price:  101.53011379433899
curr_Factors:  [101.53011379]
mat_Sqrt:  [[0.15]]
grads:  [-0.00616006]
Stock Position:  -0.006160063065899639
Bond Position:  [-0.76627708]


portfolio before change:  [-1.39627597]
curr_Stock_Price:  102.2403975203357
curr_Factors:  [102.24039752]
mat_Sqrt:  [[0.15]]
grads:  [0.20420025]
Stock Position:  0.20420025053593446
Bond Position:  [-22.27379076]


portfolio before change:  [-1.4064852]
curr_Stock_Price:  102.2176743236701
curr_Factors:  [102.21767432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05211746]
Stock Position:  -0.05211746092206008
Bond Position:  [3.92084045]


portfolio before change:  [-1.30847539]
curr_Stock_Price:  100.35592819803107
curr_Factors:  [100.3559282]
mat_Sqrt:  [[0.15]]
grads:  [-0.15723865]
Stock Position:  -0.15723864973548313
Bond Position:  [14.47135526]


portfolio before change:  [-1.10414574]
curr_Stock_Price:  99.0794522226706
curr_Factors:  [99.07945222]
mat_Sqrt:  [[0.15]]
grads:  [0.01430716]
Stock Position:  0.01430715693327109
Bond Position:  [-2.52169101]


portfolio before change:  [-1.09807494]
curr_Stock_Price:  99.54783993137038
curr_Factors:  [99.54783993]
mat_Sqrt:  [[0.15]]
grads:  [-0.00488885]
Stock Position:  -0.004888849809933429
Bond Position:  [-0.6114005]


portfolio before change:  [-1.09761829]
curr_Stock_Price:  99.42316470786466
curr_Factors:  [99.42316471]
mat_Sqrt:  [[0.15]]
grads:  [-0.01864804]
Stock Position:  -0.018648038561053185
Bond Position:  [0.75642872]


portfolio before change:  [-1.05299211]
curr_Stock_Price:  97.04023022217544
curr_Factors:  [97.04023022]
mat_Sqrt:  [[0.15]]
grads:  [0.07651529]
Stock Position:  0.07651528962495371
Bond Position:  [-8.47805343]


portfolio before change:  [-1.12066315]
curr_Stock_Price:  96.18352212062183
curr_Factors:  [96.18352212]
mat_Sqrt:  [[0.15]]
grads:  [0.30513864]
Stock Position:  0.3051386368864733
Bond Position:  [-30.46997199]


portfolio before change:  [-0.84403439]
curr_Stock_Price:  97.1150567724109
curr_Factors:  [97.11505677]
mat_Sqrt:  [[0.15]]
grads:  [0.13901505]
Stock Position:  0.13901504689316035
Bond Position:  [-14.34448856]


portfolio before change:  [-0.87732658]
curr_Stock_Price:  96.90137035873742
curr_Factors:  [96.90137036]
mat_Sqrt:  [[0.15]]
grads:  [0.02576893]
Stock Position:  0.025768934463254296
Bond Position:  [-3.37437165]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.87732658]
Stock Price:  96.13475465744798
PL:  [-0.87732658]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.87194812e-02]
 [-7.16681299e-03]
 [-3.24002134e-03]
 [ 3.37357829e-03]
 [ 7.10060847e-03]
 [ 5.29741334e-03]
 [-1.46313456e-02]
 [-2.22022071e-03]
 [-1.09026417e-03]
 [-1.38937620e-02]
 [-1.05462193e-03]
 [-2.61587039e-02]
 [ 1.37642028e-03]
 [-3.04431400e-03]
 [-7.55846845e-04]
 [ 8.86687570e-03]
 [-4.78282361e-02]
 [-2.67123045e-02]
 [ 4.68430230e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.11358646]
curr_Stock_Price:  100.0225640058646
curr_Factors:  [100.02256401]
mat_Sqrt:  [[0.15]]
grads:  [0.19146321]
Stock Position:  0.19146320783523113
Bond Position:  [-17.0370545]


portfolio before change:  [2.18916952]
curr_Stock_Price:  100.43957808887816
curr_Factors:  [100.43957809]
mat_Sqrt:  [[0.15]]
grads:  [-0.04777875]
Stock Position:  -0.047778753287664004
Bond Position:  [6.98804734]


portfolio before change:  [2.21985124]
curr_Stock_Price:  99.83398478848025
curr_Factors:  [99.83398479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02160014]
Stock Position:  -0.02160014225112498
Bond Position:  [4.37627952]


portfolio before change:  [2.21897353]
curr_Stock_Price:  99.92527659486255
curr_Factors:  [99.92527659]
mat_Sqrt:  [[0.15]]
grads:  [0.02249052]
Stock Position:  0.022490521905955598
Bond Position:  [-0.02839809]


portfolio before change:  [2.23159141]
curr_Stock_Price:  100.48662303725081
curr_Factors:  [100.48662304]
mat_Sqrt:  [[0.15]]
grads:  [0.04733739]
Stock Position:  0.04733738980899565
Bond Position:  [-2.52518304]


portfolio before change:  [2.2059856]
curr_Stock_Price:  99.95903928652275
curr_Factors:  [99.95903929]
mat_Sqrt:  [[0.15]]
grads:  [0.03531609]
Stock Position:  0.03531608896618554
Bond Position:  [-1.32417673]


portfolio before change:  [2.19466946]
curr_Stock_Price:  99.64798979672577
curr_Factors:  [99.6479898]
mat_Sqrt:  [[0.15]]
grads:  [-0.0975423]
Stock Position:  -0.09754230388884336
Bond Position:  [11.91456396]


portfolio before change:  [2.14087553]
curr_Stock_Price:  100.23002384690874
curr_Factors:  [100.23002385]
mat_Sqrt:  [[0.15]]
grads:  [-0.01480147]
Stock Position:  -0.014801471381583785
Bond Position:  [3.62442736]


portfolio before change:  [2.13957017]
curr_Stock_Price:  100.3794401492028
curr_Factors:  [100.37944015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00726843]
Stock Position:  -0.007268427797649662
Bond Position:  [2.86917088]


portfolio before change:  [2.14308097]
curr_Stock_Price:  99.99511755697408
curr_Factors:  [99.99511756]
mat_Sqrt:  [[0.15]]
grads:  [-0.09262508]
Stock Position:  -0.09262507988627883
Bond Position:  [11.40513672]


portfolio before change:  [2.23412762]
curr_Stock_Price:  99.04294554843023
curr_Factors:  [99.04294555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703081]
Stock Position:  -0.0070308128686859496
Bond Position:  [2.93048004]


portfolio before change:  [2.23746837]
curr_Stock_Price:  98.67200145883751
curr_Factors:  [98.67200146]
mat_Sqrt:  [[0.15]]
grads:  [-0.17439136]
Stock Position:  -0.17439135908924502
Bond Position:  [19.44501281]


portfolio before change:  [2.02230793]
curr_Stock_Price:  99.93365974878564
curr_Factors:  [99.93365975]
mat_Sqrt:  [[0.15]]
grads:  [0.00917614]
Stock Position:  0.009176135205765152
Bond Position:  [1.10530316]


portfolio before change:  [2.02600638]
curr_Stock_Price:  100.30659375597233
curr_Factors:  [100.30659376]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029543]
Stock Position:  -0.020295426686049892
Bond Position:  [4.0617715]


portfolio before change:  [1.99369418]
curr_Stock_Price:  101.94872567838797
curr_Factors:  [101.94872568]
mat_Sqrt:  [[0.15]]
grads:  [-0.00503898]
Stock Position:  -0.005038978967393334
Bond Position:  [2.50741167]


portfolio before change:  [1.99245814]
curr_Stock_Price:  102.31843877106162
curr_Factors:  [102.31843877]
mat_Sqrt:  [[0.15]]
grads:  [0.0591125]
Stock Position:  0.05911250463939792
Bond Position:  [-4.05584105]


portfolio before change:  [1.99849236]
curr_Stock_Price:  102.43767429868299
curr_Factors:  [102.4376743]
mat_Sqrt:  [[0.15]]
grads:  [-0.31885491]
Stock Position:  -0.3188549075137703
Bond Position:  [34.66124753]


portfolio before change:  [1.91091967]
curr_Stock_Price:  102.73950151929661
curr_Factors:  [102.73950152]
mat_Sqrt:  [[0.15]]
grads:  [-0.17808203]
Stock Position:  -0.17808202991862968
Bond Position:  [20.20697865]


portfolio before change:  [1.8514364]
curr_Stock_Price:  103.10189430609937
curr_Factors:  [103.10189431]
mat_Sqrt:  [[0.15]]
grads:  [0.03122868]
Stock Position:  0.031228682016339715
Bond Position:  [-1.36829987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.8514364]
Stock Price:  101.76517759825401
PL:  [0.0862588]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.00586669e-01]
 [ 8.77059942e-03]
 [ 1.37531245e-02]
 [ 6.75500751e-04]
 [ 8.74959292e-03]
 [ 2.22284032e-02]
 [-1.57317157e-02]
 [ 7.29398806e-04]
 [-1.31752036e-03]
 [ 3.75256445e-02]
 [-1.02757786e-02]
 [-2.05000508e-02]
 [-1.22836629e-03]
 [-1.98022370e-02]
 [ 9.06892932e-04]
 [ 8.74285378e-03]
 [-4.33154111e-02]
 [-2.55958219e-02]
 [ 4.64784761e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.31046873]
curr_Stock_Price:  98.49077138913904
curr_Factors:  [98.49077139]
mat_Sqrt:  [[0.15]]
grads:  [0.67057779]
Stock Position:  0.6705777943950063
Bond Position:  [-87.35619298]


portfolio before change:  [-21.59963178]
curr_Stock_Price:  98.09212819959761
curr_Factors:  [98.0921282]
mat_Sqrt:  [[0.15]]
grads:  [0.05847066]
Stock Position:  0.0584706627926404
Bond Position:  [-27.33514353]


portfolio before change:  [-21.6222978]
curr_Stock_Price:  97.82137051230723
curr_Factors:  [97.82137051]
mat_Sqrt:  [[0.15]]
grads:  [0.0916875]
Stock Position:  0.09168749652014206
Bond Position:  [-30.59129437]


portfolio before change:  [-21.66340323]
curr_Stock_Price:  97.4564717800246
curr_Factors:  [97.45647178]
mat_Sqrt:  [[0.15]]
grads:  [0.00450334]
Stock Position:  0.004503338342304631
Bond Position:  [-22.1022827]


portfolio before change:  [-21.66834157]
curr_Stock_Price:  97.58702517425897
curr_Factors:  [97.58702517]
mat_Sqrt:  [[0.15]]
grads:  [0.05833062]
Stock Position:  0.0583306194697808
Bond Position:  [-27.3606532]


portfolio before change:  [-21.67640769]
curr_Stock_Price:  97.56602244316531
curr_Factors:  [97.56602244]
mat_Sqrt:  [[0.15]]
grads:  [0.14818935]
Stock Position:  0.1481893547583282
Bond Position:  [-36.1346536]


portfolio before change:  [-21.4738627]
curr_Stock_Price:  98.99378886293157
curr_Factors:  [98.99378886]
mat_Sqrt:  [[0.15]]
grads:  [-0.1048781]
Stock Position:  -0.10487810447325187
Bond Position:  [-11.09158177]


portfolio before change:  [-21.45957035]
curr_Stock_Price:  98.83107051944467
curr_Factors:  [98.83107052]
mat_Sqrt:  [[0.15]]
grads:  [0.00486266]
Stock Position:  0.004862658708966389
Bond Position:  [-21.94015212]


portfolio before change:  [-21.45496208]
curr_Stock_Price:  100.90688906229335
curr_Factors:  [100.90688906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00878347]
Stock Position:  -0.008783469092558548
Bond Position:  [-20.56864954]


portfolio before change:  [-21.47532739]
curr_Stock_Price:  102.63997534910499
curr_Factors:  [102.63997535]
mat_Sqrt:  [[0.15]]
grads:  [0.25017096]
Stock Position:  0.25017096334697214
Bond Position:  [-47.1528689]


portfolio before change:  [-21.38429259]
curr_Stock_Price:  103.05099226045587
curr_Factors:  [103.05099226]
mat_Sqrt:  [[0.15]]
grads:  [-0.06850519]
Stock Position:  -0.0685051906603645
Bond Position:  [-14.32476471]


portfolio before change:  [-21.40551282]
curr_Stock_Price:  103.30847048761562
curr_Factors:  [103.30847049]
mat_Sqrt:  [[0.15]]
grads:  [-0.13666701]
Stock Position:  -0.13666700537287105
Bond Position:  [-7.28665353]


portfolio before change:  [-21.49464434]
curr_Stock_Price:  103.947319855703
curr_Factors:  [103.94731986]
mat_Sqrt:  [[0.15]]
grads:  [-0.00818911]
Stock Position:  -0.008189108575497673
Bond Position:  [-20.64340845]


portfolio before change:  [-21.49645209]
curr_Stock_Price:  103.53778267219417
curr_Factors:  [103.53778267]
mat_Sqrt:  [[0.15]]
grads:  [-0.13201491]
Stock Position:  -0.13201491364526183
Bond Position:  [-7.82792066]


portfolio before change:  [-21.38534115]
curr_Stock_Price:  102.68130238880012
curr_Factors:  [102.68130239]
mat_Sqrt:  [[0.15]]
grads:  [0.00604595]
Stock Position:  0.006045952878659042
Bond Position:  [-22.00614746]


portfolio before change:  [-21.39100513]
curr_Stock_Price:  102.6545484606801
curr_Factors:  [102.65454846]
mat_Sqrt:  [[0.15]]
grads:  [0.05828569]
Stock Position:  0.058285691873944265
Bond Position:  [-27.37429651]


portfolio before change:  [-21.35564319]
curr_Stock_Price:  103.37867759953353
curr_Factors:  [103.3786776]
mat_Sqrt:  [[0.15]]
grads:  [-0.28876941]
Stock Position:  -0.28876940763109427
Bond Position:  [8.49695631]


portfolio before change:  [-21.3230483]
curr_Stock_Price:  103.27315955665543
curr_Factors:  [103.27315956]
mat_Sqrt:  [[0.15]]
grads:  [-0.17063881]
Stock Position:  -0.17063881254459623
Bond Position:  [-3.70063899]


portfolio before change:  [-21.25052786]
curr_Stock_Price:  102.84274330091381
curr_Factors:  [102.8427433]
mat_Sqrt:  [[0.15]]
grads:  [0.03098565]
Stock Position:  0.0309856507356758
Bond Position:  [-24.43717718]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.25052786]
Stock Price:  102.8607590542279
PL:  [-24.11128691]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.36809764e-02]
 [-6.75989763e-03]
 [-6.68163841e-03]
 [ 2.28478705e-03]
 [ 8.71185727e-03]
 [ 4.24918608e-02]
 [-8.10355256e-03]
 [ 5.30105327e-03]
 [-6.17246673e-04]
 [-3.09790483e-02]
 [-1.03671210e-03]
 [-2.63371142e-02]
 [ 2.73674241e-03]
 [-9.77464514e-04]
 [-1.35471724e-03]
 [ 8.79365452e-03]
 [ 4.88636449e-02]
 [ 2.06006302e-02]
 [ 4.13146513e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.05738571]
curr_Stock_Price:  100.28046480590851
curr_Factors:  [100.28046481]
mat_Sqrt:  [[0.15]]
grads:  [0.22453984]
Stock Position:  0.22453984257138404
Bond Position:  [-16.45957407]


portfolio before change:  [6.07731056]
curr_Stock_Price:  100.38752932059305
curr_Factors:  [100.38752932]
mat_Sqrt:  [[0.15]]
grads:  [-0.04506598]
Stock Position:  -0.04506598417724959
Bond Position:  [10.60137336]


portfolio before change:  [6.09616157]
curr_Stock_Price:  100.02804880669088
curr_Factors:  [100.02804881]
mat_Sqrt:  [[0.15]]
grads:  [-0.04454426]
Stock Position:  -0.04454425606678073
Bond Position:  [10.55183659]


portfolio before change:  [6.05413344]
curr_Stock_Price:  101.03079149365605
curr_Factors:  [101.03079149]
mat_Sqrt:  [[0.15]]
grads:  [0.01523191]
Stock Position:  0.015231913660261014
Bond Position:  [4.51524114]


portfolio before change:  [6.00545689]
curr_Stock_Price:  97.760979421275
curr_Factors:  [97.76097942]
mat_Sqrt:  [[0.15]]
grads:  [0.05807905]
Stock Position:  0.05807904845898539
Bond Position:  [0.32759223]


portfolio before change:  [5.91086115]
curr_Stock_Price:  96.13082788348218
curr_Factors:  [96.13082788]
mat_Sqrt:  [[0.15]]
grads:  [0.28327907]
Stock Position:  0.28327907205277086
Bond Position:  [-21.32099057]


portfolio before change:  [6.06174631]
curr_Stock_Price:  96.682284341885
curr_Factors:  [96.68228434]
mat_Sqrt:  [[0.15]]
grads:  [-0.05402368]
Stock Position:  -0.054023683757528085
Bond Position:  [11.28487946]


portfolio before change:  [6.03196034]
curr_Stock_Price:  97.28586301900506
curr_Factors:  [97.28586302]
mat_Sqrt:  [[0.15]]
grads:  [0.03534036]
Stock Position:  0.035340355126129784
Bond Position:  [2.59384339]


portfolio before change:  [6.12393138]
curr_Stock_Price:  99.86994847799812
curr_Factors:  [99.86994848]
mat_Sqrt:  [[0.15]]
grads:  [-0.00411498]
Stock Position:  -0.004114977823236969
Bond Position:  [6.534894]


portfolio before change:  [6.12771959]
curr_Stock_Price:  99.34642516918026
curr_Factors:  [99.34642517]
mat_Sqrt:  [[0.15]]
grads:  [-0.20652699]
Stock Position:  -0.20652698889699694
Bond Position:  [26.64543764]


portfolio before change:  [6.26903407]
curr_Stock_Price:  98.69444118892187
curr_Factors:  [98.69444119]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691141]
Stock Position:  -0.006911413982269253
Bond Position:  [6.95115221]


portfolio before change:  [6.27511078]
curr_Stock_Price:  98.06668266923651
curr_Factors:  [98.06668267]
mat_Sqrt:  [[0.15]]
grads:  [-0.17558076]
Stock Position:  -0.17558076148226018
Bond Position:  [23.4937336]


portfolio before change:  [6.27858439]
curr_Stock_Price:  98.08035478112124
curr_Factors:  [98.08035478]
mat_Sqrt:  [[0.15]]
grads:  [0.01824495]
Stock Position:  0.018244949393101687
Bond Position:  [4.48911328]


portfolio before change:  [6.25235099]
curr_Stock_Price:  96.58099122122675
curr_Factors:  [96.58099122]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651643]
Stock Position:  -0.006516430090286076
Bond Position:  [6.88171427]


portfolio before change:  [6.25773852]
curr_Stock_Price:  96.01827748018445
curr_Factors:  [96.01827748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00903145]
Stock Position:  -0.009031448256283154
Bond Position:  [7.12492262]


portfolio before change:  [6.26496674]
curr_Stock_Price:  95.41518880883689
curr_Factors:  [95.41518881]
mat_Sqrt:  [[0.15]]
grads:  [0.05862436]
Stock Position:  0.058624363481424954
Bond Position:  [0.67131203]


portfolio before change:  [6.35583929]
curr_Stock_Price:  96.96240737751471
curr_Factors:  [96.96240738]
mat_Sqrt:  [[0.15]]
grads:  [0.32575763]
Stock Position:  0.32575763245487754
Bond Position:  [-25.23040497]


portfolio before change:  [6.24489387]
curr_Stock_Price:  96.64119608658615
curr_Factors:  [96.64119609]
mat_Sqrt:  [[0.15]]
grads:  [0.13733753]
Stock Position:  0.1373375345837012
Bond Position:  [-7.02756974]


portfolio before change:  [6.32162361]
curr_Stock_Price:  97.21268481880203
curr_Factors:  [97.21268482]
mat_Sqrt:  [[0.15]]
grads:  [0.0275431]
Stock Position:  0.027543100870010315
Bond Position:  [3.64408483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.32162361]
Stock Price:  96.83528765658666
PL:  [6.32162361]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.93932872e-02]
 [-7.37803769e-03]
 [ 3.09623396e-04]
 [ 2.33780540e-03]
 [ 6.65668915e-03]
 [-5.86365714e-03]
 [ 1.47391465e-03]
 [ 9.13884241e-04]
 [ 6.67845367e-04]
 [ 3.74599146e-02]
 [-6.08472636e-03]
 [-2.14051725e-02]
 [-1.76763746e-04]
 [-1.55111998e-02]
 [-3.27152881e-03]
 [ 1.06534806e-02]
 [ 9.15008365e-03]
 [ 1.99621987e-02]
 [ 3.85067991e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.61891554]
curr_Stock_Price:  101.69045944224698
curr_Factors:  [101.69045944]
mat_Sqrt:  [[0.15]]
grads:  [-0.26262191]
Stock Position:  -0.26262191470441143
Bond Position:  [54.3250587]


portfolio before change:  [27.57243086]
curr_Stock_Price:  101.91918233338554
curr_Factors:  [101.91918233]
mat_Sqrt:  [[0.15]]
grads:  [-0.04918692]
Stock Position:  -0.049186917950176476
Bond Position:  [32.58552131]


portfolio before change:  [27.58826037]
curr_Stock_Price:  101.7630003350734
curr_Factors:  [101.76300034]
mat_Sqrt:  [[0.15]]
grads:  [0.00206416]
Stock Position:  0.0020641559765972295
Bond Position:  [27.37820566]


portfolio before change:  [27.5939463]
curr_Stock_Price:  101.20128151193352
curr_Factors:  [101.20128151]
mat_Sqrt:  [[0.15]]
grads:  [0.01558537]
Stock Position:  0.015585369355990905
Bond Position:  [26.01668695]


portfolio before change:  [27.59912731]
curr_Stock_Price:  101.11633169535541
curr_Factors:  [101.1163317]
mat_Sqrt:  [[0.15]]
grads:  [0.04437793]
Stock Position:  0.0443779276807812
Bond Position:  [23.11179405]


portfolio before change:  [27.65907917]
curr_Stock_Price:  102.33705536471209
curr_Factors:  [102.33705536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03909105]
Stock Position:  -0.0390910475747081
Bond Position:  [31.65954187]


portfolio before change:  [27.69566659]
curr_Stock_Price:  101.60359963092927
curr_Factors:  [101.60359963]
mat_Sqrt:  [[0.15]]
grads:  [0.0098261]
Stock Position:  0.009826097641877965
Bond Position:  [26.6972997]


portfolio before change:  [27.72276799]
curr_Stock_Price:  103.6823739226199
curr_Factors:  [103.68237392]
mat_Sqrt:  [[0.15]]
grads:  [0.00609256]
Stock Position:  0.006092561609824499
Bond Position:  [27.09107674]


portfolio before change:  [27.72726843]
curr_Stock_Price:  103.30926623653653
curr_Factors:  [103.30926624]
mat_Sqrt:  [[0.15]]
grads:  [0.0044523]
Stock Position:  0.004452302444223443
Bond Position:  [27.26730433]


portfolio before change:  [27.73108926]
curr_Stock_Price:  102.6361665160076
curr_Factors:  [102.63616652]
mat_Sqrt:  [[0.15]]
grads:  [0.24973276]
Stock Position:  0.24973276392784002
Bond Position:  [2.09947572]


portfolio before change:  [27.39830389]
curr_Stock_Price:  101.30149859332643
curr_Factors:  [101.30149859]
mat_Sqrt:  [[0.15]]
grads:  [-0.04056484]
Stock Position:  -0.040564842379826944
Bond Position:  [31.50758321]


portfolio before change:  [27.36039998]
curr_Stock_Price:  102.43010618319724
curr_Factors:  [102.43010618]
mat_Sqrt:  [[0.15]]
grads:  [-0.14270115]
Stock Position:  -0.1427011497664928
Bond Position:  [41.9772939]


portfolio before change:  [27.47672703]
curr_Stock_Price:  101.68847642966924
curr_Factors:  [101.68847643]
mat_Sqrt:  [[0.15]]
grads:  [-0.00117842]
Stock Position:  -0.0011784249750522316
Bond Position:  [27.59655927]


portfolio before change:  [27.48360062]
curr_Stock_Price:  101.7108905140685
curr_Factors:  [101.71089051]
mat_Sqrt:  [[0.15]]
grads:  [-0.103408]
Stock Position:  -0.10340799858898557
Bond Position:  [38.00132024]


portfolio before change:  [27.58353878]
curr_Stock_Price:  100.83632915438142
curr_Factors:  [100.83632915]
mat_Sqrt:  [[0.15]]
grads:  [-0.02181019]
Stock Position:  -0.021810192098893046
Bond Position:  [29.78279849]


portfolio before change:  [27.59309457]
curr_Stock_Price:  100.73962386182885
curr_Factors:  [100.73962386]
mat_Sqrt:  [[0.15]]
grads:  [0.0710232]
Stock Position:  0.07102320376768541
Bond Position:  [20.43824374]


portfolio before change:  [27.56806804]
curr_Stock_Price:  100.31530152247419
curr_Factors:  [100.31530152]
mat_Sqrt:  [[0.15]]
grads:  [0.06100056]
Stock Position:  0.06100055763466843
Bond Position:  [21.44877871]


portfolio before change:  [27.53716615]
curr_Stock_Price:  99.72080289675682
curr_Factors:  [99.7208029]
mat_Sqrt:  [[0.15]]
grads:  [0.13308132]
Stock Position:  0.13308132477263435
Bond Position:  [14.2661896]


portfolio before change:  [27.47683216]
curr_Stock_Price:  99.24063791176799
curr_Factors:  [99.24063791]
mat_Sqrt:  [[0.15]]
grads:  [0.0256712]
Stock Position:  0.025671199409322932
Bond Position:  [24.92920595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.47683216]
Stock Price:  99.21701941818043
PL:  [27.47683216]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 7.28177951e-02]
 [ 7.65571674e-03]
 [ 8.38893242e-03]
 [-3.48872803e-05]
 [ 9.11816178e-03]
 [ 3.60602935e-02]
 [-1.15070118e-02]
 [-5.59065652e-04]
 [-2.67780431e-04]
 [-3.72239808e-02]
 [-9.12622728e-04]
 [-2.63597725e-02]
 [ 2.54850887e-03]
 [-4.07629827e-05]
 [-1.66970553e-03]
 [ 1.16051340e-02]
 [ 4.82770845e-02]
 [ 2.03661428e-02]
 [ 4.06905052e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.02284114]
curr_Stock_Price:  98.70576250086805
curr_Factors:  [98.7057625]
mat_Sqrt:  [[0.15]]
grads:  [0.48545197]
Stock Position:  0.4854519671075125
Bond Position:  [-65.93974771]


portfolio before change:  [-18.05584895]
curr_Stock_Price:  98.67173069752769
curr_Factors:  [98.6717307]
mat_Sqrt:  [[0.15]]
grads:  [0.05103811]
Stock Position:  0.05103811159412321
Bond Position:  [-23.09186775]


portfolio before change:  [-18.07441137]
curr_Stock_Price:  98.42115845086475
curr_Factors:  [98.42115845]
mat_Sqrt:  [[0.15]]
grads:  [0.05592622]
Stock Position:  0.055926216115201766
Bond Position:  [-23.57873435]


portfolio before change:  [-18.1463679]
curr_Stock_Price:  97.23993953963536
curr_Factors:  [97.23993954]
mat_Sqrt:  [[0.15]]
grads:  [-0.00023258]
Stock Position:  -0.00023258186880242723
Bond Position:  [-18.12375165]


portfolio before change:  [-18.15058496]
curr_Stock_Price:  95.88799216430401
curr_Factors:  [95.88799216]
mat_Sqrt:  [[0.15]]
grads:  [0.06078775]
Stock Position:  0.060787745173930624
Bond Position:  [-23.97939979]


portfolio before change:  [-18.11412867]
curr_Stock_Price:  96.58635480494982
curr_Factors:  [96.5863548]
mat_Sqrt:  [[0.15]]
grads:  [0.24040196]
Stock Position:  0.2404019564548272
Bond Position:  [-41.33367733]


portfolio before change:  [-17.86848665]
curr_Stock_Price:  97.65114118971141
curr_Factors:  [97.65114119]
mat_Sqrt:  [[0.15]]
grads:  [-0.07671341]
Stock Position:  -0.07671341181976109
Bond Position:  [-10.37733444]


portfolio before change:  [-17.99304072]
curr_Stock_Price:  99.2409467824684
curr_Factors:  [99.24094678]
mat_Sqrt:  [[0.15]]
grads:  [-0.0037271]
Stock Position:  -0.0037271043448179196
Bond Position:  [-17.62315936]


portfolio before change:  [-17.9982455]
curr_Stock_Price:  99.45517097088639
curr_Factors:  [99.45517097]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017852]
Stock Position:  -0.0017852028747054305
Bond Position:  [-17.82069784]


portfolio before change:  [-18.00035124]
curr_Stock_Price:  98.13880230964004
curr_Factors:  [98.13880231]
mat_Sqrt:  [[0.15]]
grads:  [-0.24815987]
Stock Position:  -0.24815987233267173
Bond Position:  [6.35376141]


portfolio before change:  [-17.53743469]
curr_Stock_Price:  96.27980748409861
curr_Factors:  [96.27980748]
mat_Sqrt:  [[0.15]]
grads:  [-0.00608415]
Stock Position:  -0.00608415151741285
Bond Position:  [-16.95165375]


portfolio before change:  [-17.54237226]
curr_Stock_Price:  96.39471747277194
curr_Factors:  [96.39471747]
mat_Sqrt:  [[0.15]]
grads:  [-0.17573182]
Stock Position:  -0.1757318167357366
Bond Position:  [-0.60275343]


portfolio before change:  [-17.49022759]
curr_Stock_Price:  96.09713122379027
curr_Factors:  [96.09713122]
mat_Sqrt:  [[0.15]]
grads:  [0.01699006]
Stock Position:  0.016990059112874566
Bond Position:  [-19.12292353]


portfolio before change:  [-17.47744559]
curr_Stock_Price:  97.13087303738342
curr_Factors:  [97.13087304]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027175]
Stock Position:  -0.00027175321811111555
Bond Position:  [-17.45104996]


portfolio before change:  [-17.48169151]
curr_Stock_Price:  96.69891036735434
curr_Factors:  [96.69891037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01113137]
Stock Position:  -0.011131370180260199
Bond Position:  [-16.40530014]


portfolio before change:  [-17.49121109]
curr_Stock_Price:  97.18561955218746
curr_Factors:  [97.18561955]
mat_Sqrt:  [[0.15]]
grads:  [0.07736756]
Stock Position:  0.07736756019236032
Bond Position:  [-25.01022536]


portfolio before change:  [-17.528043]
curr_Stock_Price:  96.79038186954769
curr_Factors:  [96.79038187]
mat_Sqrt:  [[0.15]]
grads:  [0.32184723]
Stock Position:  0.32184722980543784
Bond Position:  [-48.67975928]


portfolio before change:  [-17.23794939]
curr_Stock_Price:  97.7295388520946
curr_Factors:  [97.72953885]
mat_Sqrt:  [[0.15]]
grads:  [0.13577429]
Stock Position:  0.13577428520476198
Bond Position:  [-30.50710767]


portfolio before change:  [-17.21722191]
curr_Stock_Price:  97.93837960282434
curr_Factors:  [97.9383796]
mat_Sqrt:  [[0.15]]
grads:  [0.027127]
Stock Position:  0.027127003480703953
Bond Position:  [-19.87399668]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.21722191]
Stock Price:  98.28194883879452
PL:  [-17.21722191]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.30859018e-02]
 [ 7.03569619e-03]
 [ 6.30659880e-04]
 [ 2.96201757e-04]
 [ 5.24404355e-03]
 [-7.61191028e-03]
 [-1.03031269e-02]
 [ 8.93758322e-04]
 [ 2.98053869e-03]
 [ 4.21090104e-02]
 [-1.11386193e-02]
 [-2.03721737e-02]
 [-3.47653600e-04]
 [-2.00730291e-02]
 [ 4.29133896e-03]
 [ 8.06762468e-03]
 [-4.87269340e-02]
 [-2.08390223e-02]
 [ 4.72787384e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.87065756]
curr_Stock_Price:  98.78110839184372
curr_Factors:  [98.78110839]
mat_Sqrt:  [[0.15]]
grads:  [0.42057268]
Stock Position:  0.4205726784364361
Bond Position:  [-58.41529289]


portfolio before change:  [-16.82657429]
curr_Stock_Price:  98.92065362845243
curr_Factors:  [98.92065363]
mat_Sqrt:  [[0.15]]
grads:  [0.04690464]
Stock Position:  0.04690464124187422
Bond Position:  [-21.46641206]


portfolio before change:  [-16.6976422]
curr_Stock_Price:  101.78389621759256
curr_Factors:  [101.78389622]
mat_Sqrt:  [[0.15]]
grads:  [0.0042044]
Stock Position:  0.004204399199880307
Bond Position:  [-17.12558233]


portfolio before change:  [-16.697513]
curr_Stock_Price:  102.8330676873551
curr_Factors:  [102.83306769]
mat_Sqrt:  [[0.15]]
grads:  [0.00197468]
Stock Position:  0.0019746783811537116
Bond Position:  [-16.90057523]


portfolio before change:  [-16.70025141]
curr_Stock_Price:  103.58623266057626
curr_Factors:  [103.58623266]
mat_Sqrt:  [[0.15]]
grads:  [0.03496029]
Stock Position:  0.03496029036347764
Bond Position:  [-20.32165618]


portfolio before change:  [-16.74462943]
curr_Stock_Price:  102.46218664894563
curr_Factors:  [102.46218665]
mat_Sqrt:  [[0.15]]
grads:  [-0.05074607]
Stock Position:  -0.05074606855477361
Bond Position:  [-11.54507629]


portfolio before change:  [-16.85671445]
curr_Stock_Price:  104.61404565952297
curr_Factors:  [104.61404566]
mat_Sqrt:  [[0.15]]
grads:  [-0.06868751]
Stock Position:  -0.06868751278518341
Bond Position:  [-9.67103585]


portfolio before change:  [-16.79086535]
curr_Stock_Price:  103.62016542892738
curr_Factors:  [103.62016543]
mat_Sqrt:  [[0.15]]
grads:  [0.00595839]
Stock Position:  0.00595838881291155
Bond Position:  [-17.40827458]


portfolio before change:  [-16.78840703]
curr_Stock_Price:  104.76324765449381
curr_Factors:  [104.76324765]
mat_Sqrt:  [[0.15]]
grads:  [0.01987026]
Stock Position:  0.019870257963648993
Bond Position:  [-18.87007979]


portfolio before change:  [-16.82947701]
curr_Stock_Price:  102.93378655586385
curr_Factors:  [102.93378656]
mat_Sqrt:  [[0.15]]
grads:  [0.28072674]
Stock Position:  0.28072673575629326
Bond Position:  [-45.72574291]


portfolio before change:  [-16.704058]
curr_Stock_Price:  103.42127795854917
curr_Factors:  [103.42127796]
mat_Sqrt:  [[0.15]]
grads:  [-0.07425746]
Stock Position:  -0.07425746207907444
Bond Position:  [-9.02425638]


portfolio before change:  [-16.70738715]
curr_Stock_Price:  103.43572508284667
curr_Factors:  [103.43572508]
mat_Sqrt:  [[0.15]]
grads:  [-0.13581449]
Stock Position:  -0.13581449149266328
Bond Position:  [-2.65931675]


portfolio before change:  [-16.52710958]
curr_Stock_Price:  102.10344835088773
curr_Factors:  [102.10344835]
mat_Sqrt:  [[0.15]]
grads:  [-0.00231769]
Stock Position:  -0.002317690668255729
Bond Position:  [-16.29046537]


portfolio before change:  [-16.53490407]
curr_Stock_Price:  103.70908117996824
curr_Factors:  [103.70908118]
mat_Sqrt:  [[0.15]]
grads:  [-0.13382019]
Stock Position:  -0.13382019390071773
Bond Position:  [-2.65653471]


portfolio before change:  [-16.52976738]
curr_Stock_Price:  103.66573271267133
curr_Factors:  [103.66573271]
mat_Sqrt:  [[0.15]]
grads:  [0.02860893]
Stock Position:  0.028608926422926263
Bond Position:  [-19.4955327]


portfolio before change:  [-16.51979797]
curr_Stock_Price:  104.18458837286316
curr_Factors:  [104.18458837]
mat_Sqrt:  [[0.15]]
grads:  [0.05378416]
Stock Position:  0.053784164519414514
Bond Position:  [-22.12327901]


portfolio before change:  [-16.51098994]
curr_Stock_Price:  104.45120116195893
curr_Factors:  [104.45120116]
mat_Sqrt:  [[0.15]]
grads:  [-0.32484623]
Stock Position:  -0.32484622672673846
Bond Position:  [17.41958864]


portfolio before change:  [-16.55465512]
curr_Stock_Price:  104.59902687035868
curr_Factors:  [104.59902687]
mat_Sqrt:  [[0.15]]
grads:  [-0.13892682]
Stock Position:  -0.1389268150650454
Bond Position:  [-2.02304546]


portfolio before change:  [-16.86105404]
curr_Stock_Price:  106.80085588882208
curr_Factors:  [106.80085589]
mat_Sqrt:  [[0.15]]
grads:  [0.03151916]
Stock Position:  0.03151915893957302
Bond Position:  [-20.22732719]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.86105404]
Stock Price:  107.21402436426467
PL:  [-24.0750784]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.11116307e-01]
 [ 4.24103755e-03]
 [-9.32171651e-03]
 [ 3.68401443e-03]
 [ 8.44015772e-03]
 [ 1.14235875e-03]
 [-1.50927112e-02]
 [-1.33667501e-03]
 [ 5.59936935e-04]
 [-3.44484987e-02]
 [-1.07883804e-03]
 [-2.63397081e-02]
 [ 2.36084432e-03]
 [-2.38910002e-03]
 [-1.57789062e-03]
 [ 7.85219915e-03]
 [ 3.79800800e-02]
 [ 2.07258997e-02]
 [ 4.09798956e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.55709935]
curr_Stock_Price:  98.4092492291271
curr_Factors:  [98.40924923]
mat_Sqrt:  [[0.15]]
grads:  [0.74077538]
Stock Position:  0.7407753816026879
Bond Position:  [-95.4562485]


portfolio before change:  [-21.72687634]
curr_Stock_Price:  99.56221688584607
curr_Factors:  [99.56221689]
mat_Sqrt:  [[0.15]]
grads:  [0.02827358]
Stock Position:  0.028273583663337015
Bond Position:  [-24.54185701]


portfolio before change:  [-21.7160388]
curr_Stock_Price:  100.16255729350537
curr_Factors:  [100.16255729]
mat_Sqrt:  [[0.15]]
grads:  [-0.06214478]
Stock Position:  -0.06214477674957362
Bond Position:  [-15.49145904]


portfolio before change:  [-21.63566174]
curr_Stock_Price:  98.8068455028595
curr_Factors:  [98.8068455]
mat_Sqrt:  [[0.15]]
grads:  [0.0245601]
Stock Position:  0.024560096207707265
Bond Position:  [-24.06236737]


portfolio before change:  [-21.64190801]
curr_Stock_Price:  98.79748372210537
curr_Factors:  [98.79748372]
mat_Sqrt:  [[0.15]]
grads:  [0.05626772]
Stock Position:  0.05626771810284328
Bond Position:  [-27.20101697]


portfolio before change:  [-21.61484526]
curr_Stock_Price:  99.39931820712243
curr_Factors:  [99.39931821]
mat_Sqrt:  [[0.15]]
grads:  [0.00761573]
Stock Position:  0.007615725033176419
Bond Position:  [-22.37184314]


portfolio before change:  [-21.61889953]
curr_Stock_Price:  99.60145156298098
curr_Factors:  [99.60145156]
mat_Sqrt:  [[0.15]]
grads:  [-0.10061807]
Stock Position:  -0.10061807448754735
Bond Position:  [-11.59719326]


portfolio before change:  [-21.62073216]
curr_Stock_Price:  99.59084683411814
curr_Factors:  [99.59084683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00891117]
Stock Position:  -0.008911166708137226
Bond Position:  [-20.73326152]


portfolio before change:  [-21.61756132]
curr_Stock_Price:  98.65328080666578
curr_Factors:  [98.65328081]
mat_Sqrt:  [[0.15]]
grads:  [0.00373291]
Stock Position:  0.003732912900328512
Bond Position:  [-21.98582542]


portfolio before change:  [-21.62125737]
curr_Stock_Price:  99.13577082394961
curr_Factors:  [99.13577082]
mat_Sqrt:  [[0.15]]
grads:  [-0.22965666]
Stock Position:  -0.22965665792875425
Bond Position:  [1.14593244]


portfolio before change:  [-21.70787106]
curr_Stock_Price:  99.51416267394993
curr_Factors:  [99.51416267]
mat_Sqrt:  [[0.15]]
grads:  [-0.00719225]
Stock Position:  -0.007192253603966615
Bond Position:  [-20.99213996]


portfolio before change:  [-21.70133247]
curr_Stock_Price:  97.87527713610316
curr_Factors:  [97.87527714]
mat_Sqrt:  [[0.15]]
grads:  [-0.17559805]
Stock Position:  -0.1755980541934873
Bond Position:  [-4.51462425]


portfolio before change:  [-21.25181778]
curr_Stock_Price:  95.30894183801233
curr_Factors:  [95.30894184]
mat_Sqrt:  [[0.15]]
grads:  [0.01573896]
Stock Position:  0.01573896215263318
Bond Position:  [-22.75188161]


portfolio before change:  [-21.25212138]
curr_Stock_Price:  95.65109143528382
curr_Factors:  [95.65109144]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592733]
Stock Position:  -0.015927333435565308
Bond Position:  [-19.72865456]


portfolio before change:  [-21.27011201]
curr_Stock_Price:  96.47093020371267
curr_Factors:  [96.4709302]
mat_Sqrt:  [[0.15]]
grads:  [-0.01051927]
Stock Position:  -0.0105192707846134
Bond Position:  [-20.25530817]


portfolio before change:  [-21.25876719]
curr_Stock_Price:  94.91100495206992
curr_Factors:  [94.91100495]
mat_Sqrt:  [[0.15]]
grads:  [0.05234799]
Stock Position:  0.05234799430634476
Bond Position:  [-26.22716794]


portfolio before change:  [-21.23801302]
curr_Stock_Price:  95.43274002115376
curr_Factors:  [95.43274002]
mat_Sqrt:  [[0.15]]
grads:  [0.25320053]
Stock Position:  0.25320053364506345
Bond Position:  [-45.40163372]


portfolio before change:  [-20.78295904]
curr_Stock_Price:  97.2747812005859
curr_Factors:  [97.2747812]
mat_Sqrt:  [[0.15]]
grads:  [0.13817266]
Stock Position:  0.13817266462580913
Bond Position:  [-34.22367476]


portfolio before change:  [-20.80550688]
curr_Stock_Price:  97.17352491012227
curr_Factors:  [97.17352491]
mat_Sqrt:  [[0.15]]
grads:  [0.02731993]
Stock Position:  0.02731993039968633
Bond Position:  [-23.46028081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.80550688]
Stock Price:  98.90294498757565
PL:  [-20.80550688]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-5.95818866e-03]
 [-8.03255445e-03]
 [-5.60731124e-03]
 [ 3.29456352e-03]
 [ 8.48558804e-03]
 [ 1.85037310e-03]
 [-1.01259552e-02]
 [-1.02942626e-03]
 [-3.61309931e-04]
 [ 2.77564463e-02]
 [-6.30553543e-03]
 [-2.28513694e-02]
 [ 1.98167896e-03]
 [-2.77489720e-03]
 [-2.54892241e-03]
 [ 1.05528168e-02]
 [ 4.96043812e-02]
 [ 2.05359337e-02]
 [ 2.49563573e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.67539924]
curr_Stock_Price:  100.97481916057234
curr_Factors:  [100.97481916]
mat_Sqrt:  [[0.15]]
grads:  [-0.03972126]
Stock Position:  -0.039721257727600295
Bond Position:  [20.68624606]


portfolio before change:  [16.68965476]
curr_Stock_Price:  100.74614302396914
curr_Factors:  [100.74614302]
mat_Sqrt:  [[0.15]]
grads:  [-0.05355036]
Stock Position:  -0.05355036297988752
Bond Position:  [22.08464728]


portfolio before change:  [16.73656192]
curr_Stock_Price:  99.97331325837693
curr_Factors:  [99.97331326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03738207]
Stock Position:  -0.0373820749063284
Bond Position:  [20.47377181]


portfolio before change:  [16.79717799]
curr_Stock_Price:  98.48872521453143
curr_Factors:  [98.48872521]
mat_Sqrt:  [[0.15]]
grads:  [0.02196376]
Stock Position:  0.021963756814941435
Bond Position:  [14.63399558]


portfolio before change:  [16.80423615]
curr_Stock_Price:  98.64348978663799
curr_Factors:  [98.64348979]
mat_Sqrt:  [[0.15]]
grads:  [0.05657059]
Stock Position:  0.0565705869494042
Bond Position:  [11.22391604]


portfolio before change:  [16.86380382]
curr_Stock_Price:  99.64686161501369
curr_Factors:  [99.64686162]
mat_Sqrt:  [[0.15]]
grads:  [0.01233582]
Stock Position:  0.012335820669492395
Bond Position:  [15.634578]


portfolio before change:  [16.8724064]
curr_Stock_Price:  100.02733474581058
curr_Factors:  [100.02733475]
mat_Sqrt:  [[0.15]]
grads:  [-0.06750637]
Stock Position:  -0.06750636821445843
Bond Position:  [23.62488849]


portfolio before change:  [16.79861033]
curr_Stock_Price:  101.20800894674814
curr_Factors:  [101.20800895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00686284]
Stock Position:  -0.006862841743781882
Bond Position:  [17.49318488]


portfolio before change:  [16.79661032]
curr_Stock_Price:  102.13675722332351
curr_Factors:  [102.13675722]
mat_Sqrt:  [[0.15]]
grads:  [-0.00240873]
Stock Position:  -0.002408732872563087
Bond Position:  [17.04263049]


portfolio before change:  [16.80102296]
curr_Stock_Price:  102.073882322089
curr_Factors:  [102.07388232]
mat_Sqrt:  [[0.15]]
grads:  [0.18504298]
Stock Position:  0.18504297551682536
Bond Position:  [-2.08703195]


portfolio before change:  [16.68579375]
curr_Stock_Price:  101.45398637617816
curr_Factors:  [101.45398638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0420369]
Stock Position:  -0.04203690286201983
Bond Position:  [20.95060512]


portfolio before change:  [16.71864637]
curr_Stock_Price:  100.79707996381218
curr_Factors:  [100.79707996]
mat_Sqrt:  [[0.15]]
grads:  [-0.15234246]
Stock Position:  -0.1523424629116921
Bond Position:  [32.07432178]


portfolio before change:  [16.9424442]
curr_Stock_Price:  99.38067742339699
curr_Factors:  [99.38067742]
mat_Sqrt:  [[0.15]]
grads:  [0.01321119]
Stock Position:  0.013211193084401534
Bond Position:  [15.62950688]


portfolio before change:  [16.95508533]
curr_Stock_Price:  100.04172789241821
curr_Factors:  [100.04172789]
mat_Sqrt:  [[0.15]]
grads:  [-0.01849931]
Stock Position:  -0.018499314669035167
Bond Position:  [18.80578873]


portfolio before change:  [16.98269056]
curr_Stock_Price:  98.803671231047
curr_Factors:  [98.80367123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01699282]
Stock Position:  -0.0169928160675896
Bond Position:  [18.66164318]


portfolio before change:  [16.96795425]
curr_Stock_Price:  99.94546579740238
curr_Factors:  [99.9454658]
mat_Sqrt:  [[0.15]]
grads:  [0.07035211]
Stock Position:  0.07035211220053067
Bond Position:  [9.93657963]


portfolio before change:  [16.8680121]
curr_Stock_Price:  98.4895520118921
curr_Factors:  [98.48955201]
mat_Sqrt:  [[0.15]]
grads:  [0.33069587]
Stock Position:  0.33069587476607987
Bond Position:  [-15.70207646]


portfolio before change:  [16.24144019]
curr_Stock_Price:  96.60671661568416
curr_Factors:  [96.60671662]
mat_Sqrt:  [[0.15]]
grads:  [0.13690622]
Stock Position:  0.13690622434738342
Bond Position:  [3.01537937]


portfolio before change:  [16.06317088]
curr_Stock_Price:  95.2990824853587
curr_Factors:  [95.29908249]
mat_Sqrt:  [[0.15]]
grads:  [0.01663757]
Stock Position:  0.016637571537448735
Bond Position:  [14.47762558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.06317088]
Stock Price:  96.59070760814569
PL:  [16.06317088]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.22228583e-02]
 [ 7.91213590e-03]
 [ 3.39465016e-02]
 [-2.60395877e-03]
 [ 9.24062441e-03]
 [ 6.68711624e-02]
 [ 2.23498002e-03]
 [ 1.09088811e-02]
 [ 1.23485576e-02]
 [-3.73238815e-02]
 [ 2.72003902e-04]
 [-2.64051354e-02]
 [ 1.87588798e-03]
 [-7.72570908e-03]
 [ 5.18079592e-04]
 [ 6.09723092e-03]
 [-1.63535016e-02]
 [ 1.21204198e-02]
 [-3.51704928e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.65732653]
curr_Stock_Price:  99.71057493163948
curr_Factors:  [99.71057493]
mat_Sqrt:  [[0.15]]
grads:  [0.08148572]
Stock Position:  0.08148572221798235
Bond Position:  [-10.78231474]


portfolio before change:  [-2.75286199]
curr_Stock_Price:  98.57123977283158
curr_Factors:  [98.57123977]
mat_Sqrt:  [[0.15]]
grads:  [0.05274757]
Stock Position:  0.05274757264352281
Bond Position:  [-7.95225562]


portfolio before change:  [-2.85608021]
curr_Stock_Price:  96.65210111529943
curr_Factors:  [96.65210112]
mat_Sqrt:  [[0.15]]
grads:  [0.22631001]
Stock Position:  0.22631001088077002
Bond Position:  [-24.72941827]


portfolio before change:  [-2.90644723]
curr_Stock_Price:  96.45686496692092
curr_Factors:  [96.45686497]
mat_Sqrt:  [[0.15]]
grads:  [-0.01735973]
Stock Position:  -0.01735972510186314
Bond Position:  [-1.23198257]


portfolio before change:  [-2.88707971]
curr_Stock_Price:  95.32346250643609
curr_Factors:  [95.32346251]
mat_Sqrt:  [[0.15]]
grads:  [0.06160416]
Stock Position:  0.06160416270376951
Bond Position:  [-8.75940181]


portfolio before change:  [-2.94590507]
curr_Stock_Price:  94.40412152778444
curr_Factors:  [94.40412153]
mat_Sqrt:  [[0.15]]
grads:  [0.44580775]
Stock Position:  0.44580774934459966
Bond Position:  [-45.03199401]


portfolio before change:  [-3.25357731]
curr_Stock_Price:  93.73923214871444
curr_Factors:  [93.73923215]
mat_Sqrt:  [[0.15]]
grads:  [0.01489987]
Stock Position:  0.014899866801884298
Bond Position:  [-4.65027938]


portfolio before change:  [-3.27114907]
curr_Stock_Price:  92.63794411978229
curr_Factors:  [92.63794412]
mat_Sqrt:  [[0.15]]
grads:  [0.07272587]
Stock Position:  0.07272587416894223
Bond Position:  [-10.00832454]


portfolio before change:  [-3.25014521]
curr_Stock_Price:  92.96116138607916
curr_Factors:  [92.96116139]
mat_Sqrt:  [[0.15]]
grads:  [0.08232372]
Stock Position:  0.08232371725483192
Bond Position:  [-10.90305357]


portfolio before change:  [-3.1924329]
curr_Stock_Price:  93.69531688221791
curr_Factors:  [93.69531688]
mat_Sqrt:  [[0.15]]
grads:  [-0.24882588]
Stock Position:  -0.24882587672515707
Bond Position:  [20.12138647]


portfolio before change:  [-3.1954946]
curr_Stock_Price:  93.72784030952347
curr_Factors:  [93.72784031]
mat_Sqrt:  [[0.15]]
grads:  [0.00181336]
Stock Position:  0.0018133593434186321
Bond Position:  [-3.36545685]


portfolio before change:  [-3.19757001]
curr_Stock_Price:  93.04736856859682
curr_Factors:  [93.04736857]
mat_Sqrt:  [[0.15]]
grads:  [-0.17603424]
Stock Position:  -0.1760342360912729
Bond Position:  [13.18195244]


portfolio before change:  [-3.23383974]
curr_Stock_Price:  93.2721296092696
curr_Factors:  [93.27212961]
mat_Sqrt:  [[0.15]]
grads:  [0.01250592]
Stock Position:  0.012505919899155586
Bond Position:  [-4.40029353]


portfolio before change:  [-3.24915259]
curr_Stock_Price:  92.13565729939076
curr_Factors:  [92.1356573]
mat_Sqrt:  [[0.15]]
grads:  [-0.05150473]
Stock Position:  -0.051504727225410406
Bond Position:  [1.49626931]


portfolio before change:  [-3.30996569]
curr_Stock_Price:  93.32364948035384
curr_Factors:  [93.32364948]
mat_Sqrt:  [[0.15]]
grads:  [0.00345386]
Stock Position:  0.0034538639492230744
Bond Position:  [-3.63229287]


portfolio before change:  [-3.30863748]
curr_Stock_Price:  93.97115514847225
curr_Factors:  [93.97115515]
mat_Sqrt:  [[0.15]]
grads:  [0.04064821]
Stock Position:  0.04064820610937394
Bond Position:  [-7.12839636]


portfolio before change:  [-3.37628467]
curr_Stock_Price:  92.3507916407276
curr_Factors:  [92.35079164]
mat_Sqrt:  [[0.15]]
grads:  [-0.10902334]
Stock Position:  -0.10902334411539483
Bond Position:  [6.69210747]


portfolio before change:  [-3.34963943]
curr_Stock_Price:  92.12173974888468
curr_Factors:  [92.12173975]
mat_Sqrt:  [[0.15]]
grads:  [0.0808028]
Stock Position:  0.08080279869437433
Bond Position:  [-10.79333382]


portfolio before change:  [-3.36499238]
curr_Stock_Price:  91.96513282640628
curr_Factors:  [91.96513283]
mat_Sqrt:  [[0.15]]
grads:  [-0.0023447]
Stock Position:  -0.002344699519443901
Bond Position:  [-3.14936177]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.36499238]
Stock Price:  91.5346112739652
PL:  [-3.36499238]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.74769036e-02]
 [-3.81500235e-03]
 [-1.02930217e-02]
 [ 2.47631815e-03]
 [ 6.76422896e-03]
 [ 1.07028723e-02]
 [-1.57265329e-02]
 [-1.11846559e-03]
 [-1.29989183e-03]
 [ 1.08556034e-02]
 [-1.06900667e-03]
 [-2.17674250e-02]
 [-4.73644143e-04]
 [-1.51124915e-02]
 [-8.82021080e-04]
 [ 1.02864317e-02]
 [-4.78288137e-02]
 [-2.38203233e-02]
 [ 4.59930809e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.26172191]
curr_Stock_Price:  102.25564710437973
curr_Factors:  [102.2556471]
mat_Sqrt:  [[0.15]]
grads:  [-0.24984602]
Stock Position:  -0.24984602403910966
Bond Position:  [61.80988878]


portfolio before change:  [36.81494695]
curr_Stock_Price:  100.103238913799
curr_Factors:  [100.10323891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02543335]
Stock Position:  -0.02543334900824593
Bond Position:  [39.36090756]


portfolio before change:  [36.80379483]
curr_Stock_Price:  100.92867362687514
curr_Factors:  [100.92867363]
mat_Sqrt:  [[0.15]]
grads:  [-0.06862014]
Stock Position:  -0.06862014462618861
Bond Position:  [43.72953501]


portfolio before change:  [36.79041417]
curr_Stock_Price:  101.28300714110271
curr_Factors:  [101.28300714]
mat_Sqrt:  [[0.15]]
grads:  [0.01650879]
Stock Position:  0.016508787678591215
Bond Position:  [35.11835451]


portfolio before change:  [36.79418424]
curr_Stock_Price:  100.97949544448076
curr_Factors:  [100.97949544]
mat_Sqrt:  [[0.15]]
grads:  [0.04509486]
Stock Position:  0.045094859732052496
Bond Position:  [32.24052806]


portfolio before change:  [36.80549402]
curr_Stock_Price:  101.05153561992182
curr_Factors:  [101.05153562]
mat_Sqrt:  [[0.15]]
grads:  [0.07135248]
Stock Position:  0.07135248216019639
Bond Position:  [29.59521613]


portfolio before change:  [36.66524917]
curr_Stock_Price:  98.98230721621984
curr_Factors:  [98.98230722]
mat_Sqrt:  [[0.15]]
grads:  [-0.10484355]
Stock Position:  -0.1048435523678488
Bond Position:  [47.04290588]


portfolio before change:  [36.62350423]
curr_Stock_Price:  99.49265937434784
curr_Factors:  [99.49265937]
mat_Sqrt:  [[0.15]]
grads:  [-0.00745644]
Stock Position:  -0.0074564372436938635
Bond Position:  [37.365365]


portfolio before change:  [36.62162508]
curr_Stock_Price:  100.99762222065965
curr_Factors:  [100.99762222]
mat_Sqrt:  [[0.15]]
grads:  [-0.00866595]
Stock Position:  -0.008665945550398187
Bond Position:  [37.49686498]


portfolio before change:  [36.62843476]
curr_Stock_Price:  101.29369014502997
curr_Factors:  [101.29369015]
mat_Sqrt:  [[0.15]]
grads:  [0.07237069]
Stock Position:  0.07237068928091574
Bond Position:  [29.29774059]


portfolio before change:  [36.49312947]
curr_Stock_Price:  99.32285571996414
curr_Factors:  [99.32285572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00712671]
Stock Position:  -0.007126711131838273
Bond Position:  [37.20097477]


portfolio before change:  [36.48301328]
curr_Stock_Price:  102.04747782487362
curr_Factors:  [102.04747782]
mat_Sqrt:  [[0.15]]
grads:  [-0.14511617]
Stock Position:  -0.14511616637602273
Bond Position:  [51.29175205]


portfolio before change:  [36.44331833]
curr_Stock_Price:  102.40939125024363
curr_Factors:  [102.40939125]
mat_Sqrt:  [[0.15]]
grads:  [-0.00315763]
Stock Position:  -0.003157627616981965
Bond Position:  [36.76668905]


portfolio before change:  [36.45486374]
curr_Stock_Price:  101.66434204172745
curr_Factors:  [101.66434204]
mat_Sqrt:  [[0.15]]
grads:  [-0.10074994]
Stock Position:  -0.10074994312514135
Bond Position:  [46.69754042]


portfolio before change:  [36.44442142]
curr_Stock_Price:  101.88387732475658
curr_Factors:  [101.88387732]
mat_Sqrt:  [[0.15]]
grads:  [-0.00588014]
Stock Position:  -0.005880140535989464
Bond Position:  [37.04351293]


portfolio before change:  [36.45618387]
curr_Stock_Price:  101.4586463006203
curr_Factors:  [101.4586463]
mat_Sqrt:  [[0.15]]
grads:  [0.06857621]
Stock Position:  0.06857621101977725
Bond Position:  [29.49853433]


portfolio before change:  [36.65657088]
curr_Stock_Price:  104.27320039929647
curr_Factors:  [104.2732004]
mat_Sqrt:  [[0.15]]
grads:  [-0.31885876]
Stock Position:  -0.31885875797692664
Bond Position:  [69.90499405]


portfolio before change:  [36.78646135]
curr_Stock_Price:  103.92065547797692
curr_Factors:  [103.92065548]
mat_Sqrt:  [[0.15]]
grads:  [-0.15880216]
Stock Position:  -0.15880215513764856
Bond Position:  [53.2892854]


portfolio before change:  [36.78175852]
curr_Stock_Price:  104.03417290967198
curr_Factors:  [104.03417291]
mat_Sqrt:  [[0.15]]
grads:  [0.03066205]
Stock Position:  0.03066205395200948
Bond Position:  [33.5918571]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.78175852]
Stock Price:  102.67050399078367
PL:  [34.11125453]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.29378849]
 [-0.03353833]
 [-0.00600205]
 [ 0.04411835]
 [-0.01073345]
 [ 0.00376023]
 [-0.06411142]
 [-0.01310012]
 [ 0.00257524]
 [ 0.00909343]
 [ 0.10132008]
 [-0.01677758]
 [-0.01611439]
 [-0.00268133]
 [-0.02375958]
 [ 0.0152125 ]
 [ 0.0038838 ]
 [-0.01291816]
 [-0.00337074]
 [ 0.00499105]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.2348819]
curr_Stock_Price:  101.27298196016233
curr_Factors:  [101.27298196]
mat_Sqrt:  [[0.15]]
grads:  [-0.22358888]
Stock Position:  -0.22358888148993802
Bond Position:  [43.87839467]


portfolio before change:  [20.91873213]
curr_Stock_Price:  102.73602761369754
curr_Factors:  [102.73602761]
mat_Sqrt:  [[0.15]]
grads:  [-0.04001367]
Stock Position:  -0.04001367242526227
Bond Position:  [25.02957789]


portfolio before change:  [20.85497254]
curr_Stock_Price:  104.48587380607582
curr_Factors:  [104.48587381]
mat_Sqrt:  [[0.15]]
grads:  [0.29412234]
Stock Position:  0.29412234186353065
Bond Position:  [-9.87665736]


portfolio before change:  [20.94487755]
curr_Stock_Price:  104.79994204817
curr_Factors:  [104.79994205]
mat_Sqrt:  [[0.15]]
grads:  [-0.07155634]
Stock Position:  -0.07155634478679332
Bond Position:  [28.44397834]


portfolio before change:  [20.79414571]
curr_Stock_Price:  107.00580826223795
curr_Factors:  [107.00580826]
mat_Sqrt:  [[0.15]]
grads:  [0.02506818]
Stock Position:  0.025068184701377175
Bond Position:  [18.11170435]


portfolio before change:  [20.77653576]
curr_Stock_Price:  106.12267926588883
curr_Factors:  [106.12267927]
mat_Sqrt:  [[0.15]]
grads:  [-0.42740948]
Stock Position:  -0.4274094812053007
Bond Position:  [66.13437505]


portfolio before change:  [20.48685557]
curr_Stock_Price:  106.83912535396473
curr_Factors:  [106.83912535]
mat_Sqrt:  [[0.15]]
grads:  [-0.08733411]
Stock Position:  -0.08733411077295127
Bond Position:  [29.81755558]


portfolio before change:  [20.32152698]
curr_Stock_Price:  108.81754953409005
curr_Factors:  [108.81754953]
mat_Sqrt:  [[0.15]]
grads:  [0.01716823]
Stock Position:  0.01716823365287542
Bond Position:  [18.45332186]


portfolio before change:  [20.3244574]
curr_Stock_Price:  108.71949121470023
curr_Factors:  [108.71949121]
mat_Sqrt:  [[0.15]]
grads:  [0.06062284]
Stock Position:  0.060622843740477037
Bond Position:  [13.73357267]


portfolio before change:  [20.33310661]
curr_Stock_Price:  108.80552127495875
curr_Factors:  [108.80552127]
mat_Sqrt:  [[0.15]]
grads:  [0.6754672]
Stock Position:  0.6754671988778643
Bond Position:  [-53.16145407]


portfolio before change:  [19.66418357]
curr_Stock_Price:  107.83488789418811
curr_Factors:  [107.83488789]
mat_Sqrt:  [[0.15]]
grads:  [-0.11185056]
Stock Position:  -0.11185055615193687
Bond Position:  [31.72557575]


portfolio before change:  [19.59323142]
curr_Stock_Price:  108.54015516833357
curr_Factors:  [108.54015517]
mat_Sqrt:  [[0.15]]
grads:  [-0.10742929]
Stock Position:  -0.10742928909713309
Bond Position:  [31.25362313]


portfolio before change:  [19.80017714]
curr_Stock_Price:  106.68655135897221
curr_Factors:  [106.68655136]
mat_Sqrt:  [[0.15]]
grads:  [-0.0178755]
Stock Position:  -0.017875501567063308
Bond Position:  [21.70725276]


portfolio before change:  [19.81659677]
curr_Stock_Price:  106.07162354968918
curr_Factors:  [106.07162355]
mat_Sqrt:  [[0.15]]
grads:  [-0.15839723]
Stock Position:  -0.15839722701623973
Bond Position:  [36.61804781]


portfolio before change:  [19.69764849]
curr_Stock_Price:  106.88037472626823
curr_Factors:  [106.88037473]
mat_Sqrt:  [[0.15]]
grads:  [0.10141664]
Stock Position:  0.1014166380641055
Bond Position:  [8.85820021]


portfolio before change:  [19.79690989]
curr_Stock_Price:  107.83728449700682
curr_Factors:  [107.8372845]
mat_Sqrt:  [[0.15]]
grads:  [0.02589197]
Stock Position:  0.025891972326279614
Bond Position:  [17.0047899]


portfolio before change:  [19.81680369]
curr_Stock_Price:  108.44141269640922
curr_Factors:  [108.4414127]
mat_Sqrt:  [[0.15]]
grads:  [-0.08612104]
Stock Position:  -0.08612104406249349
Bond Position:  [29.15589137]


portfolio before change:  [19.81434754]
curr_Stock_Price:  108.55457932403516
curr_Factors:  [108.55457932]
mat_Sqrt:  [[0.15]]
grads:  [-0.02247163]
Stock Position:  -0.022471628772115435
Bond Position:  [22.25374575]


portfolio before change:  [19.82198658]
curr_Stock_Price:  108.46224502322256
curr_Factors:  [108.46224502]
mat_Sqrt:  [[0.15]]
grads:  [0.03327364]
Stock Position:  0.033273644018817036
Bond Position:  [16.21305245]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.82198658]
Stock Price:  108.53105897362975
PL:  [11.2909276]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.53948738e-02]
 [ 8.28606888e-03]
 [ 1.83756983e-02]
 [-7.95161411e-04]
 [ 8.78483509e-03]
 [ 2.47449525e-02]
 [-6.61898939e-03]
 [ 8.03055684e-03]
 [ 8.49734789e-03]
 [-3.73151727e-02]
 [-3.32005372e-04]
 [-2.63863268e-02]
 [ 2.32232943e-03]
 [-2.21951647e-03]
 [-1.69563396e-03]
 [ 1.18858755e-02]
 [ 5.00244646e-02]
 [ 2.07872261e-02]
 [ 3.10026934e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.16327726]
curr_Stock_Price:  100.74514746307773
curr_Factors:  [100.74514746]
mat_Sqrt:  [[0.15]]
grads:  [0.10263249]
Stock Position:  0.10263249175860287
Bond Position:  [2.82355175]


portfolio before change:  [12.92582943]
curr_Stock_Price:  98.42469506225446
curr_Factors:  [98.42469506]
mat_Sqrt:  [[0.15]]
grads:  [0.05524046]
Stock Position:  0.05524045919506924
Bond Position:  [7.48880408]


portfolio before change:  [12.87956123]
curr_Stock_Price:  97.55322091272434
curr_Factors:  [97.55322091]
mat_Sqrt:  [[0.15]]
grads:  [0.12250466]
Stock Position:  0.12250465513517182
Bond Position:  [0.92883755]


portfolio before change:  [12.81302607]
curr_Stock_Price:  97.00820159710953
curr_Factors:  [97.0082016]
mat_Sqrt:  [[0.15]]
grads:  [-0.00530108]
Stock Position:  -0.005301076074170553
Bond Position:  [13.32727392]


portfolio before change:  [12.81415112]
curr_Stock_Price:  97.42456540141676
curr_Factors:  [97.4245654]
mat_Sqrt:  [[0.15]]
grads:  [0.05856557]
Stock Position:  0.05856556727915357
Bond Position:  [7.10842618]


portfolio before change:  [12.8137743]
curr_Stock_Price:  97.3877834710343
curr_Factors:  [97.38778347]
mat_Sqrt:  [[0.15]]
grads:  [0.16496635]
Stock Position:  0.1649663500399599
Bond Position:  [-3.25193288]


portfolio before change:  [12.62686149]
curr_Stock_Price:  96.25967630898684
curr_Factors:  [96.25967631]
mat_Sqrt:  [[0.15]]
grads:  [-0.0441266]
Stock Position:  -0.044126595900962136
Bond Position:  [16.87447333]


portfolio before change:  [12.68056676]
curr_Stock_Price:  95.13821836208383
curr_Factors:  [95.13821836]
mat_Sqrt:  [[0.15]]
grads:  [0.05353705]
Stock Position:  0.05353704561254255
Bond Position:  [7.58714762]


portfolio before change:  [12.66467678]
curr_Stock_Price:  94.80598112771979
curr_Factors:  [94.80598113]
mat_Sqrt:  [[0.15]]
grads:  [0.05664899]
Stock Position:  0.05664898592497056
Bond Position:  [7.29401409]


portfolio before change:  [12.62552609]
curr_Stock_Price:  94.08267732800125
curr_Factors:  [94.08267733]
mat_Sqrt:  [[0.15]]
grads:  [-0.24876782]
Stock Position:  -0.2487678178516487
Bond Position:  [36.03026843]


portfolio before change:  [12.41715014]
curr_Stock_Price:  94.9565228371474
curr_Factors:  [94.95652284]
mat_Sqrt:  [[0.15]]
grads:  [-0.00221337]
Stock Position:  -0.0022133691450452442
Bond Position:  [12.62732398]


portfolio before change:  [12.42146111]
curr_Stock_Price:  94.43526337276543
curr_Factors:  [94.43526337]
mat_Sqrt:  [[0.15]]
grads:  [-0.17590885]
Stock Position:  -0.17590884544206234
Bond Position:  [29.03345926]


portfolio before change:  [12.30348801]
curr_Stock_Price:  95.14717962170808
curr_Factors:  [95.14717962]
mat_Sqrt:  [[0.15]]
grads:  [0.0154822]
Stock Position:  0.015482196176394602
Bond Position:  [10.83040071]


portfolio before change:  [12.31572715]
curr_Stock_Price:  95.76280277886292
curr_Factors:  [95.76280278]
mat_Sqrt:  [[0.15]]
grads:  [-0.01479678]
Stock Position:  -0.014796776495036093
Bond Position:  [13.73270794]


portfolio before change:  [12.30435675]
curr_Stock_Price:  96.76329171443683
curr_Factors:  [96.76329171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130423]
Stock Position:  -0.011304226375337236
Bond Position:  [13.3981909]


portfolio before change:  [12.29290534]
curr_Stock_Price:  98.07265772260797
curr_Factors:  [98.07265772]
mat_Sqrt:  [[0.15]]
grads:  [0.07923917]
Stock Position:  0.07923916975758684
Bond Position:  [4.52170937]


portfolio before change:  [12.29590329]
curr_Stock_Price:  98.09622408347568
curr_Factors:  [98.09622408]
mat_Sqrt:  [[0.15]]
grads:  [0.33349643]
Stock Position:  0.33349643043899707
Bond Position:  [-20.41883728]


portfolio before change:  [11.99099677]
curr_Stock_Price:  97.19726042922393
curr_Factors:  [97.19726043]
mat_Sqrt:  [[0.15]]
grads:  [0.13858151]
Stock Position:  0.1385815070545668
Bond Position:  [-1.47874606]


portfolio before change:  [11.8255939]
curr_Stock_Price:  96.0063862470336
curr_Factors:  [96.00638625]
mat_Sqrt:  [[0.15]]
grads:  [0.02066846]
Stock Position:  0.02066846227434353
Bond Position:  [9.84128953]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.8255939]
Stock Price:  96.36477137117306
PL:  [11.8255939]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.35321793e-02]
 [-7.88698275e-03]
 [ 8.54886176e-03]
 [ 2.33370024e-03]
 [ 6.81982987e-03]
 [ 9.87687822e-03]
 [ 2.82845343e-03]
 [-2.16256248e-03]
 [-9.75186903e-04]
 [-3.75957048e-02]
 [-9.77922238e-04]
 [-2.62699605e-02]
 [ 1.96974994e-03]
 [ 1.76149906e-03]
 [-2.45757266e-03]
 [ 1.17304372e-02]
 [ 4.48777760e-02]
 [ 1.85370165e-02]
 [ 1.67356675e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.18007851]
curr_Stock_Price:  100.55006416972357
curr_Factors:  [100.55006417]
mat_Sqrt:  [[0.15]]
grads:  [0.22354786]
Stock Position:  0.22354786171502278
Bond Position:  [-12.29767333]


portfolio before change:  [10.29821313]
curr_Stock_Price:  101.09227210236467
curr_Factors:  [101.0922721]
mat_Sqrt:  [[0.15]]
grads:  [-0.05257988]
Stock Position:  -0.05257988498317795
Bond Position:  [15.61363317]


portfolio before change:  [10.2393567]
curr_Stock_Price:  102.28589053265975
curr_Factors:  [102.28589053]
mat_Sqrt:  [[0.15]]
grads:  [0.05699241]
Stock Position:  0.056992411758436834
Bond Position:  [4.40983711]


portfolio before change:  [10.15828554]
curr_Stock_Price:  100.84405372827972
curr_Factors:  [100.84405373]
mat_Sqrt:  [[0.15]]
grads:  [0.015558]
Stock Position:  0.015558001576541613
Bond Position:  [8.5893536]


portfolio before change:  [10.16143966]
curr_Stock_Price:  100.9087475042218
curr_Factors:  [100.9087475]
mat_Sqrt:  [[0.15]]
grads:  [0.04546553]
Stock Position:  0.045465532456632964
Bond Position:  [5.57356972]


portfolio before change:  [10.14670574]
curr_Stock_Price:  100.55402862833117
curr_Factors:  [100.55402863]
mat_Sqrt:  [[0.15]]
grads:  [0.06584585]
Stock Position:  0.06584585480723981
Bond Position:  [3.52563977]


portfolio before change:  [10.18809816]
curr_Stock_Price:  101.1692670838503
curr_Factors:  [101.16926708]
mat_Sqrt:  [[0.15]]
grads:  [0.01885636]
Stock Position:  0.01885635619471762
Bond Position:  [8.28041443]


portfolio before change:  [10.18056849]
curr_Stock_Price:  100.66015332844758
curr_Factors:  [100.66015333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01441708]
Stock Position:  -0.014417083213939915
Bond Position:  [11.6317943]


portfolio before change:  [10.18931088]
curr_Stock_Price:  100.25548932464014
curr_Factors:  [100.25548932]
mat_Sqrt:  [[0.15]]
grads:  [-0.00650125]
Stock Position:  -0.006501246022879246
Bond Position:  [10.84109648]


portfolio before change:  [10.20356716]
curr_Stock_Price:  98.4795735372086
curr_Factors:  [98.47957354]
mat_Sqrt:  [[0.15]]
grads:  [-0.25063803]
Stock Position:  -0.250638032317793
Bond Position:  [34.88629369]


portfolio before change:  [10.44516116]
curr_Stock_Price:  97.55045942028052
curr_Factors:  [97.55045942]
mat_Sqrt:  [[0.15]]
grads:  [-0.00651948]
Stock Position:  -0.006519481584495354
Bond Position:  [11.08113958]


portfolio before change:  [10.44301072]
curr_Stock_Price:  98.30528439598594
curr_Factors:  [98.3052844]
mat_Sqrt:  [[0.15]]
grads:  [-0.17513307]
Stock Position:  -0.17513307024857652
Bond Position:  [27.659517]


portfolio before change:  [10.25776154]
curr_Stock_Price:  99.40253532963168
curr_Factors:  [99.40253533]
mat_Sqrt:  [[0.15]]
grads:  [0.01313167]
Stock Position:  0.013131666288544412
Bond Position:  [8.95244062]


portfolio before change:  [10.25656986]
curr_Stock_Price:  99.14132907163841
curr_Factors:  [99.14132907]
mat_Sqrt:  [[0.15]]
grads:  [0.01174333]
Stock Position:  0.011743327056401218
Bond Position:  [9.0923208]


portfolio before change:  [10.25149648]
curr_Stock_Price:  98.51571944379647
curr_Factors:  [98.51571944]
mat_Sqrt:  [[0.15]]
grads:  [-0.01638382]
Stock Position:  -0.016383817717069288
Bond Position:  [11.86556007]


portfolio before change:  [10.2739206]
curr_Stock_Price:  97.32812316641437
curr_Factors:  [97.32812317]
mat_Sqrt:  [[0.15]]
grads:  [0.07820291]
Stock Position:  0.07820291472728141
Bond Position:  [2.66257769]


portfolio before change:  [10.17474983]
curr_Stock_Price:  96.0514891227343
curr_Factors:  [96.05148912]
mat_Sqrt:  [[0.15]]
grads:  [0.29918517]
Stock Position:  0.2991851732615182
Bond Position:  [-18.56243159]


portfolio before change:  [10.01750072]
curr_Stock_Price:  95.5414106335485
curr_Factors:  [95.54141063]
mat_Sqrt:  [[0.15]]
grads:  [0.12358011]
Stock Position:  0.1235801099121244
Bond Position:  [-1.78951731]


portfolio before change:  [9.86826419]
curr_Stock_Price:  94.33742161958293
curr_Factors:  [94.33742162]
mat_Sqrt:  [[0.15]]
grads:  [0.01115711]
Stock Position:  0.011157111675747414
Bond Position:  [8.81573104]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.86826419]
Stock Price:  94.14802746452978
PL:  [9.86826419]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.74239935e-02]
 [-4.32160747e-03]
 [-4.43231167e-03]
 [ 2.37015433e-03]
 [ 6.74430145e-03]
 [ 9.62637969e-03]
 [ 8.93273512e-04]
 [-1.23143289e-03]
 [-4.31336470e-04]
 [-2.66867168e-03]
 [-3.43850963e-03]
 [-2.24007721e-02]
 [ 4.31148528e-04]
 [-7.11396122e-03]
 [-3.32535776e-03]
 [ 1.06804975e-02]
 [-1.25403203e-03]
 [ 1.56030520e-02]
 [ 3.92570519e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.61690645]
curr_Stock_Price:  102.14808604570509
curr_Factors:  [102.14808605]
mat_Sqrt:  [[0.15]]
grads:  [-0.24949329]
Stock Position:  -0.2494932902025075
Bond Position:  [60.10216853]


portfolio before change:  [34.29846752]
curr_Stock_Price:  103.48466048278105
curr_Factors:  [103.48466048]
mat_Sqrt:  [[0.15]]
grads:  [-0.02881072]
Stock Position:  -0.028810716478781875
Bond Position:  [37.27993473]


portfolio before change:  [34.36628327]
curr_Stock_Price:  101.45435342703749
curr_Factors:  [101.45435343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02954874]
Stock Position:  -0.029548744445595083
Bond Position:  [37.36413203]


portfolio before change:  [34.39549481]
curr_Stock_Price:  100.7819276420276
curr_Factors:  [100.78192764]
mat_Sqrt:  [[0.15]]
grads:  [0.01580103]
Stock Position:  0.01580102884012984
Bond Position:  [32.80303666]


portfolio before change:  [34.40721902]
curr_Stock_Price:  101.00485168463841
curr_Factors:  [101.00485168]
mat_Sqrt:  [[0.15]]
grads:  [0.04496201]
Stock Position:  0.04496200969302738
Bond Position:  [29.8658379]


portfolio before change:  [34.39114395]
curr_Stock_Price:  100.48124365171128
curr_Factors:  [100.48124365]
mat_Sqrt:  [[0.15]]
grads:  [0.06417586]
Stock Position:  0.06417586460390153
Bond Position:  [27.94267326]


portfolio before change:  [34.42210484]
curr_Stock_Price:  100.85481638138693
curr_Factors:  [100.85481638]
mat_Sqrt:  [[0.15]]
grads:  [0.00595516]
Stock Position:  0.005955156744600806
Bond Position:  [33.8214986]


portfolio before change:  [34.42275212]
curr_Stock_Price:  99.5434911500126
curr_Factors:  [99.54349115]
mat_Sqrt:  [[0.15]]
grads:  [-0.00820955]
Stock Position:  -0.008209552580036075
Bond Position:  [35.23995965]


portfolio before change:  [34.43052707]
curr_Stock_Price:  99.66970281935804
curr_Factors:  [99.66970282]
mat_Sqrt:  [[0.15]]
grads:  [-0.00287558]
Stock Position:  -0.0028755764692918696
Bond Position:  [34.71713493]


portfolio before change:  [34.43656078]
curr_Stock_Price:  100.59009565657371
curr_Factors:  [100.59009566]
mat_Sqrt:  [[0.15]]
grads:  [-0.01779114]
Stock Position:  -0.017791144513724582
Bond Position:  [36.22617371]


portfolio before change:  [34.44768514]
curr_Stock_Price:  100.47393246187193
curr_Factors:  [100.47393246]
mat_Sqrt:  [[0.15]]
grads:  [-0.0229234]
Stock Position:  -0.022923397549624483
Bond Position:  [36.75088903]


portfolio before change:  [34.43799358]
curr_Stock_Price:  101.2975638832821
curr_Factors:  [101.29756388]
mat_Sqrt:  [[0.15]]
grads:  [-0.14933848]
Stock Position:  -0.1493384804327811
Bond Position:  [49.56561784]


portfolio before change:  [34.54167705]
curr_Stock_Price:  100.68626447708453
curr_Factors:  [100.68626448]
mat_Sqrt:  [[0.15]]
grads:  [0.00287432]
Stock Position:  0.0028743235222385595
Bond Position:  [34.25227216]


portfolio before change:  [34.55075725]
curr_Stock_Price:  100.86580564898996
curr_Factors:  [100.86580565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04742641]
Stock Position:  -0.047426408159696086
Bond Position:  [39.33446012]


portfolio before change:  [34.6041719]
curr_Stock_Price:  99.94691235488155
curr_Factors:  [99.94691235]
mat_Sqrt:  [[0.15]]
grads:  [-0.02216905]
Stock Position:  -0.02216905176462294
Bond Position:  [36.81990018]


portfolio before change:  [34.6201738]
curr_Stock_Price:  99.64036910840694
curr_Factors:  [99.64036911]
mat_Sqrt:  [[0.15]]
grads:  [0.07120332]
Stock Position:  0.07120331636293002
Bond Position:  [27.52544908]


portfolio before change:  [34.69908537]
curr_Stock_Price:  100.65197005026866
curr_Factors:  [100.65197005]
mat_Sqrt:  [[0.15]]
grads:  [-0.00836021]
Stock Position:  -0.008360213533499528
Bond Position:  [35.54055733]


portfolio before change:  [34.70970892]
curr_Stock_Price:  100.44416451923523
curr_Factors:  [100.44416452]
mat_Sqrt:  [[0.15]]
grads:  [0.10402035]
Stock Position:  0.10402034676079516
Bond Position:  [24.26147209]


portfolio before change:  [34.51550138]
curr_Stock_Price:  98.518832947513
curr_Factors:  [98.51883295]
mat_Sqrt:  [[0.15]]
grads:  [0.02617137]
Stock Position:  0.026171367938242273
Bond Position:  [31.93712876]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.51550138]
Stock Price:  98.38968489013634
PL:  [34.51550138]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.79151504e-02]
 [-5.66150160e-03]
 [ 1.62496954e-02]
 [-2.85465503e-03]
 [ 5.19343183e-03]
 [-3.52516228e-02]
 [-1.05480655e-02]
 [ 1.49788605e-03]
 [ 5.07612624e-03]
 [ 7.69718658e-02]
 [-1.45533037e-02]
 [-1.80278841e-02]
 [-3.46852847e-03]
 [-2.88591334e-02]
 [ 2.34007969e-02]
 [ 2.28380291e-03]
 [-8.59361123e-03]
 [-1.24728797e-03]
 [ 5.26134486e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.69235535]
curr_Stock_Price:  100.38738200684475
curr_Factors:  [100.38738201]
mat_Sqrt:  [[0.15]]
grads:  [0.25276767]
Stock Position:  0.2527676691876955
Bond Position:  [-17.68232922]


portfolio before change:  [7.65702685]
curr_Stock_Price:  100.26510620629895
curr_Factors:  [100.26510621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03774334]
Stock Position:  -0.03774334399909975
Bond Position:  [11.44136724]


portfolio before change:  [7.56567724]
curr_Stock_Price:  102.76118344813251
curr_Factors:  [102.76118345]
mat_Sqrt:  [[0.15]]
grads:  [0.1083313]
Stock Position:  0.10833130274864494
Bond Position:  [-3.56657563]


portfolio before change:  [7.63344197]
curr_Stock_Price:  103.39494748136768
curr_Factors:  [103.39494748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903103]
Stock Position:  -0.019031033510897608
Bond Position:  [9.60115468]


portfolio before change:  [7.63024463]
curr_Stock_Price:  103.6890951756422
curr_Factors:  [103.68909518]
mat_Sqrt:  [[0.15]]
grads:  [0.03462288]
Stock Position:  0.03462287887712627
Bond Position:  [4.04022964]


portfolio before change:  [7.65456106]
curr_Stock_Price:  104.3622410205675
curr_Factors:  [104.36224102]
mat_Sqrt:  [[0.15]]
grads:  [-0.23501082]
Stock Position:  -0.23501081875277202
Bond Position:  [32.18081677]


portfolio before change:  [7.58987391]
curr_Stock_Price:  104.6717304074193
curr_Factors:  [104.67173041]
mat_Sqrt:  [[0.15]]
grads:  [-0.07032044]
Stock Position:  -0.0703204366673566
Bond Position:  [14.9504357]


portfolio before change:  [7.53624654]
curr_Stock_Price:  105.48750250247905
curr_Factors:  [105.4875025]
mat_Sqrt:  [[0.15]]
grads:  [0.00998591]
Stock Position:  0.009985906971062204
Bond Position:  [6.48285815]


portfolio before change:  [7.54421301]
curr_Stock_Price:  106.12295310023828
curr_Factors:  [106.1229531]
mat_Sqrt:  [[0.15]]
grads:  [0.03384084]
Stock Position:  0.033840841584742494
Bond Position:  [3.95292296]


portfolio before change:  [7.54820263]
curr_Stock_Price:  106.21164094094668
curr_Factors:  [106.21164094]
mat_Sqrt:  [[0.15]]
grads:  [0.51314577]
Stock Position:  0.513145772217191
Bond Position:  [-46.95385188]


portfolio before change:  [7.47606857]
curr_Stock_Price:  106.09394702514007
curr_Factors:  [106.09394703]
mat_Sqrt:  [[0.15]]
grads:  [-0.09702202]
Stock Position:  -0.09702202467321673
Bond Position:  [17.76951811]


portfolio before change:  [7.4657424]
curr_Stock_Price:  106.24617120639051
curr_Factors:  [106.24617121]
mat_Sqrt:  [[0.15]]
grads:  [-0.12018589]
Stock Position:  -0.12018589423450021
Bond Position:  [20.2350335]


portfolio before change:  [7.24987579]
curr_Stock_Price:  108.08437363406401
curr_Factors:  [108.08437363]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312352]
Stock Position:  -0.023123523130384
Bond Position:  [9.7491673]


portfolio before change:  [7.23974177]
curr_Stock_Price:  108.62804595724991
curr_Factors:  [108.62804596]
mat_Sqrt:  [[0.15]]
grads:  [-0.19239422]
Stock Position:  -0.1923942227275397
Bond Position:  [28.13915024]


portfolio before change:  [7.05237479]
curr_Stock_Price:  109.63848504113601
curr_Factors:  [109.63848504]
mat_Sqrt:  [[0.15]]
grads:  [0.15600531]
Stock Position:  0.15600531245248406
Bond Position:  [-10.05181132]


portfolio before change:  [6.93062984]
curr_Stock_Price:  108.87420541868323
curr_Factors:  [108.87420542]
mat_Sqrt:  [[0.15]]
grads:  [0.01522535]
Stock Position:  0.015225352762959245
Bond Position:  [5.27298166]


portfolio before change:  [6.9333512]
curr_Stock_Price:  108.96635065099345
curr_Factors:  [108.96635065]
mat_Sqrt:  [[0.15]]
grads:  [-0.05729074]
Stock Position:  -0.05729074152275508
Bond Position:  [13.17611423]


portfolio before change:  [6.84661278]
curr_Stock_Price:  110.53785868129745
curr_Factors:  [110.53785868]
mat_Sqrt:  [[0.15]]
grads:  [-0.00831525]
Stock Position:  -0.008315253127947203
Bond Position:  [7.76576305]


portfolio before change:  [6.8516248]
curr_Stock_Price:  110.1686168383768
curr_Factors:  [110.16861684]
mat_Sqrt:  [[0.15]]
grads:  [0.03507563]
Stock Position:  0.035075632383458094
Bond Position:  [2.9873909]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.8516248]
Stock Price:  108.76091388099817
PL:  [-1.90928908]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.98906215e-02]
 [-7.41435019e-03]
 [ 1.77459779e-02]
 [-9.79430807e-03]
 [ 4.89149853e-03]
 [-2.31758070e-02]
 [-1.36432760e-02]
 [ 1.24787503e-03]
 [ 5.85484474e-03]
 [ 9.13059689e-02]
 [-1.57915692e-02]
 [-1.80507179e-02]
 [-2.57824371e-03]
 [-2.60702454e-02]
 [ 2.31672151e-02]
 [-1.78007994e-03]
 [-2.38992518e-03]
 [ 1.03938487e-03]
 [ 6.13459376e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.85161145]
curr_Stock_Price:  101.57488836270755
curr_Factors:  [101.57488836]
mat_Sqrt:  [[0.15]]
grads:  [-0.26593748]
Stock Position:  -0.26593747655131333
Bond Position:  [52.86418095]


portfolio before change:  [25.78320942]
curr_Stock_Price:  101.88180158039616
curr_Factors:  [101.88180158]
mat_Sqrt:  [[0.15]]
grads:  [-0.049429]
Stock Position:  -0.04942900127363997
Bond Position:  [30.81912512]


portfolio before change:  [25.74288154]
curr_Stock_Price:  102.85357167204526
curr_Factors:  [102.85357167]
mat_Sqrt:  [[0.15]]
grads:  [0.11830652]
Stock Position:  0.11830651955243221
Bond Position:  [13.57463346]


portfolio before change:  [25.95673069]
curr_Stock_Price:  104.63246828562852
curr_Factors:  [104.63246829]
mat_Sqrt:  [[0.15]]
grads:  [-0.06529539]
Stock Position:  -0.06529538711771402
Bond Position:  [32.78874822]


portfolio before change:  [25.98479192]
curr_Stock_Price:  104.32826580170386
curr_Factors:  [104.3282658]
mat_Sqrt:  [[0.15]]
grads:  [0.03260999]
Stock Position:  0.03260999022524571
Bond Position:  [22.5826482]


portfolio before change:  [25.96591256]
curr_Stock_Price:  103.57617313975834
curr_Factors:  [103.57617314]
mat_Sqrt:  [[0.15]]
grads:  [-0.15450538]
Stock Position:  -0.1545053802365485
Bond Position:  [41.96898857]


portfolio before change:  [25.63362107]
curr_Stock_Price:  105.7947693033148
curr_Factors:  [105.7947693]
mat_Sqrt:  [[0.15]]
grads:  [-0.09095517]
Stock Position:  -0.09095517331284483
Bond Position:  [35.25620265]


portfolio before change:  [25.74067162]
curr_Stock_Price:  104.71472743103351
curr_Factors:  [104.71472743]
mat_Sqrt:  [[0.15]]
grads:  [0.00831917]
Stock Position:  0.008319166843371518
Bond Position:  [24.86953233]


portfolio before change:  [25.76280843]
curr_Stock_Price:  106.62821845629242
curr_Factors:  [106.62821846]
mat_Sqrt:  [[0.15]]
grads:  [0.0390323]
Stock Position:  0.039032298256250576
Bond Position:  [21.60086401]


portfolio before change:  [25.803671]
curr_Stock_Price:  107.5367397747925
curr_Factors:  [107.53673977]
mat_Sqrt:  [[0.15]]
grads:  [0.60870646]
Stock Position:  0.6087064594069511
Bond Position:  [-39.65463713]


portfolio before change:  [25.50547031]
curr_Stock_Price:  107.06313581918207
curr_Factors:  [107.06313582]
mat_Sqrt:  [[0.15]]
grads:  [-0.10527713]
Stock Position:  -0.10527712787447195
Bond Position:  [36.77676975]


portfolio before change:  [25.60355522]
curr_Stock_Price:  106.2187970141967
curr_Factors:  [106.21879701]
mat_Sqrt:  [[0.15]]
grads:  [-0.12033812]
Stock Position:  -0.12033811925723989
Bond Position:  [38.38572548]


portfolio before change:  [25.57889086]
curr_Stock_Price:  106.50351138981709
curr_Factors:  [106.50351139]
mat_Sqrt:  [[0.15]]
grads:  [-0.01718829]
Stock Position:  -0.01718829138148194
Bond Position:  [27.40950424]


portfolio before change:  [25.56896879]
curr_Stock_Price:  107.47948373129549
curr_Factors:  [107.47948373]
mat_Sqrt:  [[0.15]]
grads:  [-0.17380164]
Stock Position:  -0.17380163577881344
Bond Position:  [44.24907888]


portfolio before change:  [25.21846896]
curr_Stock_Price:  109.55980639875311
curr_Factors:  [109.5598064]
mat_Sqrt:  [[0.15]]
grads:  [0.1544481]
Stock Position:  0.1544481003398261
Bond Position:  [8.29716499]


portfolio before change:  [25.46329009]
curr_Stock_Price:  111.13150962897662
curr_Factors:  [111.13150963]
mat_Sqrt:  [[0.15]]
grads:  [-0.0118672]
Stock Position:  -0.011867199599847472
Bond Position:  [26.7821099]


portfolio before change:  [25.45527323]
curr_Stock_Price:  112.37133276430073
curr_Factors:  [112.37133276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01593283]
Stock Position:  -0.015932834511194576
Bond Position:  [27.24566708]


portfolio before change:  [25.45063687]
curr_Stock_Price:  113.08988811248766
curr_Factors:  [113.08988811]
mat_Sqrt:  [[0.15]]
grads:  [0.00692923]
Stock Position:  0.006929232473239649
Bond Position:  [24.66701075]


portfolio before change:  [25.47476137]
curr_Stock_Price:  115.68136908179919
curr_Factors:  [115.68136908]
mat_Sqrt:  [[0.15]]
grads:  [0.04089729]
Stock Position:  0.040897291714427575
Bond Position:  [20.74370667]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.47476137]
Stock Price:  113.75187267190908
PL:  [11.7228887]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.31631563e-02]
 [ 1.43360781e-03]
 [ 5.65805393e-03]
 [ 3.81405922e-03]
 [ 7.84224949e-03]
 [ 4.28959918e-03]
 [-1.23225373e-02]
 [-2.25325771e-03]
 [-9.91875320e-05]
 [-2.93320344e-02]
 [-9.91359967e-04]
 [-2.63233783e-02]
 [ 1.57493439e-03]
 [ 1.90434431e-03]
 [-3.29064744e-03]
 [ 1.09081817e-02]
 [ 5.00654380e-02]
 [ 2.09638900e-02]
 [ 2.43250160e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.1618852]
curr_Stock_Price:  99.87376181640626
curr_Factors:  [99.87376182]
mat_Sqrt:  [[0.15]]
grads:  [0.15442104]
Stock Position:  0.154421041795309
Bond Position:  [-15.58449555]


portfolio before change:  [-0.19230646]
curr_Stock_Price:  99.70199348688541
curr_Factors:  [99.70199349]
mat_Sqrt:  [[0.15]]
grads:  [0.00955739]
Stock Position:  0.00955738536804911
Bond Position:  [-1.14519683]


portfolio before change:  [-0.20084682]
curr_Stock_Price:  98.8383650405202
curr_Factors:  [98.83836504]
mat_Sqrt:  [[0.15]]
grads:  [0.03772036]
Stock Position:  0.03772035953568952
Bond Position:  [-3.92906549]


portfolio before change:  [-0.18264325]
curr_Stock_Price:  99.34700175690857
curr_Factors:  [99.34700176]
mat_Sqrt:  [[0.15]]
grads:  [0.02542706]
Stock Position:  0.02542706148761387
Bond Position:  [-2.70874558]


portfolio before change:  [-0.17495796]
curr_Stock_Price:  99.67588619807583
curr_Factors:  [99.6758862]
mat_Sqrt:  [[0.15]]
grads:  [0.05228166]
Stock Position:  0.052281663269706076
Bond Position:  [-5.38617908]


portfolio before change:  [-0.21521249]
curr_Stock_Price:  98.93168991629382
curr_Factors:  [98.93168992]
mat_Sqrt:  [[0.15]]
grads:  [0.02859733]
Stock Position:  0.028597327875463215
Bond Position:  [-3.04439447]


portfolio before change:  [-0.18941084]
curr_Stock_Price:  99.86054756258164
curr_Factors:  [99.86054756]
mat_Sqrt:  [[0.15]]
grads:  [-0.08215025]
Stock Position:  -0.08215024897349249
Bond Position:  [8.01415801]


portfolio before change:  [-0.22375163]
curr_Stock_Price:  100.3029635272744
curr_Factors:  [100.30296353]
mat_Sqrt:  [[0.15]]
grads:  [-0.01502172]
Stock Position:  -0.015021718054080821
Bond Position:  [1.28297121]


portfolio before change:  [-0.20763095]
curr_Stock_Price:  99.25116013648667
curr_Factors:  [99.25116014]
mat_Sqrt:  [[0.15]]
grads:  [-0.00066125]
Stock Position:  -0.0006612502135460666
Bond Position:  [-0.1420011]


portfolio before change:  [-0.20780518]
curr_Stock_Price:  99.460942314325
curr_Factors:  [99.46094231]
mat_Sqrt:  [[0.15]]
grads:  [-0.1955469]
Stock Position:  -0.1955468960696535
Bond Position:  [19.24147337]


portfolio before change:  [0.11946271]
curr_Stock_Price:  97.81194189231785
curr_Factors:  [97.81194189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00660907]
Stock Position:  -0.006609066449438777
Bond Position:  [0.76590833]


portfolio before change:  [0.11755735]
curr_Stock_Price:  98.12921219042241
curr_Factors:  [98.12921219]
mat_Sqrt:  [[0.15]]
grads:  [-0.17548919]
Stock Position:  -0.17548918871958263
Bond Position:  [17.33817318]


portfolio before change:  [-0.16763159]
curr_Stock_Price:  99.77902337845143
curr_Factors:  [99.77902338]
mat_Sqrt:  [[0.15]]
grads:  [0.01049956]
Stock Position:  0.010499562600624445
Bond Position:  [-1.2152677]


portfolio before change:  [-0.17479904]
curr_Stock_Price:  99.12532093910016
curr_Factors:  [99.12532094]
mat_Sqrt:  [[0.15]]
grads:  [0.01269563]
Stock Position:  0.012695628707247697
Bond Position:  [-1.43325731]


portfolio before change:  [-0.1664386]
curr_Stock_Price:  99.81207715248624
curr_Factors:  [99.81207715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02193765]
Stock Position:  -0.021937649611764882
Bond Position:  [2.02320378]


portfolio before change:  [-0.15552188]
curr_Stock_Price:  99.33751154080728
curr_Factors:  [99.33751154]
mat_Sqrt:  [[0.15]]
grads:  [0.07272121]
Stock Position:  0.07272121151969706
Bond Position:  [-7.37946607]


portfolio before change:  [-0.25042477]
curr_Stock_Price:  98.05786028303572
curr_Factors:  [98.05786028]
mat_Sqrt:  [[0.15]]
grads:  [0.33376959]
Stock Position:  0.33376958663054845
Bond Position:  [-32.97915626]


portfolio before change:  [-0.65454614]
curr_Stock_Price:  96.87178590100791
curr_Factors:  [96.8717859]
mat_Sqrt:  [[0.15]]
grads:  [0.13975927]
Stock Position:  0.13975926638164657
Bond Position:  [-14.19327587]


portfolio before change:  [-0.88821665]
curr_Stock_Price:  95.2252278336093
curr_Factors:  [95.22522783]
mat_Sqrt:  [[0.15]]
grads:  [0.01621668]
Stock Position:  0.016216677364755145
Bond Position:  [-2.43245345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.88821665]
Stock Price:  94.55408993409796
PL:  [-0.88821665]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.31745031e-02]
 [ 8.77193384e-03]
 [ 2.44655527e-02]
 [ 2.71832222e-03]
 [ 8.73517370e-03]
 [ 2.90364717e-02]
 [-1.53987302e-02]
 [-1.30661910e-03]
 [ 3.08759347e-04]
 [-3.80041416e-02]
 [-9.11470925e-04]
 [-2.63425782e-02]
 [ 2.57149637e-03]
 [ 1.27910567e-03]
 [-2.34915711e-03]
 [ 1.17705772e-02]
 [ 4.80831921e-02]
 [ 2.01845537e-02]
 [ 4.16747220e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.77265238]
curr_Stock_Price:  99.11448733177447
curr_Factors:  [99.11448733]
mat_Sqrt:  [[0.15]]
grads:  [0.15449669]
Stock Position:  0.15449668718266563
Bond Position:  [-27.08551233]


portfolio before change:  [-11.93792935]
curr_Stock_Price:  98.08854463328953
curr_Factors:  [98.08854463]
mat_Sqrt:  [[0.15]]
grads:  [0.05847956]
Stock Position:  0.05847955890002199
Bond Position:  [-17.67410418]


portfolio before change:  [-11.99431269]
curr_Stock_Price:  97.19995623528588
curr_Factors:  [97.19995624]
mat_Sqrt:  [[0.15]]
grads:  [0.16310368]
Stock Position:  0.16310368498508618
Bond Position:  [-27.84798373]


portfolio before change:  [-11.86212643]
curr_Stock_Price:  98.05308914701995
curr_Factors:  [98.05308915]
mat_Sqrt:  [[0.15]]
grads:  [0.01812215]
Stock Position:  0.018122148106571312
Bond Position:  [-13.63905904]


portfolio before change:  [-11.87277813]
curr_Stock_Price:  97.6534950805763
curr_Factors:  [97.65349508]
mat_Sqrt:  [[0.15]]
grads:  [0.05823449]
Stock Position:  0.058234491310758696
Bond Position:  [-17.55957974]


portfolio before change:  [-11.91034278]
curr_Stock_Price:  97.08382917134236
curr_Factors:  [97.08382917]
mat_Sqrt:  [[0.15]]
grads:  [0.19357648]
Stock Position:  0.19357647828966762
Bond Position:  [-30.70348853]


portfolio before change:  [-11.60297081]
curr_Stock_Price:  98.71134507746716
curr_Factors:  [98.71134508]
mat_Sqrt:  [[0.15]]
grads:  [-0.1026582]
Stock Position:  -0.1026582010765135
Bond Position:  [-1.4694417]


portfolio before change:  [-11.69223791]
curr_Stock_Price:  99.57732260867235
curr_Factors:  [99.57732261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00871079]
Stock Position:  -0.00871079397942198
Bond Position:  [-10.82484037]


portfolio before change:  [-11.68848969]
curr_Stock_Price:  98.83631388343485
curr_Factors:  [98.83631388]
mat_Sqrt:  [[0.15]]
grads:  [0.0020584]
Stock Position:  0.002058395645723593
Bond Position:  [-11.89193393]


portfolio before change:  [-11.6914176]
curr_Stock_Price:  98.85839224439445
curr_Factors:  [98.85839224]
mat_Sqrt:  [[0.15]]
grads:  [-0.25336094]
Stock Position:  -0.25336094411333854
Bond Position:  [13.355438]


portfolio before change:  [-11.02908714]
curr_Stock_Price:  96.25739474611142
curr_Factors:  [96.25739475]
mat_Sqrt:  [[0.15]]
grads:  [-0.00607647]
Stock Position:  -0.006076472830233796
Bond Position:  [-10.44418169]


portfolio before change:  [-11.04024263]
curr_Stock_Price:  97.66349332292037
curr_Factors:  [97.66349332]
mat_Sqrt:  [[0.15]]
grads:  [-0.17561719]
Stock Position:  -0.17561718799941234
Bond Position:  [6.11114544]


portfolio before change:  [-11.15904909]
curr_Stock_Price:  98.34870209360275
curr_Factors:  [98.34870209]
mat_Sqrt:  [[0.15]]
grads:  [0.01714331]
Stock Position:  0.017143309102571645
Bond Position:  [-12.84507129]


portfolio before change:  [-11.14774574]
curr_Stock_Price:  99.1953890936351
curr_Factors:  [99.19538909]
mat_Sqrt:  [[0.15]]
grads:  [0.00852737]
Stock Position:  0.00852737116215636
Bond Position:  [-11.99362164]


portfolio before change:  [-11.15855968]
curr_Stock_Price:  98.27890976950906
curr_Factors:  [98.27890977]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566105]
Stock Position:  -0.01566104742419652
Bond Position:  [-9.61940901]


portfolio before change:  [-11.16040657]
curr_Stock_Price:  98.2432633486402
curr_Factors:  [98.24326335]
mat_Sqrt:  [[0.15]]
grads:  [0.07847051]
Stock Position:  0.07847051499012399
Bond Position:  [-18.86960604]


portfolio before change:  [-11.10127732]
curr_Stock_Price:  99.05690969811617
curr_Factors:  [99.0569097]
mat_Sqrt:  [[0.15]]
grads:  [0.32055461]
Stock Position:  0.32055461373930266
Bond Position:  [-42.85442674]


portfolio before change:  [-11.46390664]
curr_Stock_Price:  97.95907998599397
curr_Factors:  [97.95907999]
mat_Sqrt:  [[0.15]]
grads:  [0.13456369]
Stock Position:  0.13456369154019632
Bond Position:  [-24.64564207]


portfolio before change:  [-11.51943223]
curr_Stock_Price:  97.59223952625574
curr_Factors:  [97.59223953]
mat_Sqrt:  [[0.15]]
grads:  [0.02778315]
Stock Position:  0.027783147978841807
Bond Position:  [-14.23085186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.51943223]
Stock Price:  99.13133443945252
PL:  [-11.51943223]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.76923768e-03]
 [ 9.13553017e-03]
 [ 5.72809182e-02]
 [-8.21833893e-03]
 [ 9.32311092e-03]
 [ 4.32693669e-02]
 [-4.81157659e-04]
 [ 8.07187289e-03]
 [ 8.08444782e-03]
 [-3.73205204e-02]
 [ 1.91997399e-03]
 [-2.64569890e-02]
 [ 1.04759981e-03]
 [-1.18200483e-02]
 [ 3.81276801e-03]
 [-4.60301826e-03]
 [-1.00717251e-01]
 [ 4.12698695e-03]
 [-3.57227273e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.42628591]
curr_Stock_Price:  99.59489560576657
curr_Factors:  [99.59489561]
mat_Sqrt:  [[0.15]]
grads:  [0.05846158]
Stock Position:  0.05846158451154775
Bond Position:  [-10.24876131]


portfolio before change:  [-4.57399606]
curr_Stock_Price:  97.11210888551312
curr_Factors:  [97.11210889]
mat_Sqrt:  [[0.15]]
grads:  [0.06090353]
Stock Position:  0.06090353449229073
Bond Position:  [-10.48846674]


portfolio before change:  [-4.68631237]
curr_Stock_Price:  95.31100051536473
curr_Factors:  [95.31100052]
mat_Sqrt:  [[0.15]]
grads:  [0.38187279]
Stock Position:  0.38187278832558996
Bond Position:  [-41.0829899]


portfolio before change:  [-4.91251277]
curr_Stock_Price:  94.74555472226139
curr_Factors:  [94.74555472]
mat_Sqrt:  [[0.15]]
grads:  [-0.05478893]
Stock Position:  -0.05478892622492966
Bond Position:  [0.27849444]


portfolio before change:  [-4.92361442]
curr_Stock_Price:  94.94945153151137
curr_Factors:  [94.94945153]
mat_Sqrt:  [[0.15]]
grads:  [0.06215407]
Stock Position:  0.06215407278239246
Bond Position:  [-10.82510954]


portfolio before change:  [-4.8563164]
curr_Stock_Price:  96.07575966417713
curr_Factors:  [96.07575966]
mat_Sqrt:  [[0.15]]
grads:  [0.28846245]
Stock Position:  0.2884624460612874
Bond Position:  [-32.57056504]


portfolio before change:  [-5.31542185]
curr_Stock_Price:  94.51243036505764
curr_Factors:  [94.51243037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00320772]
Stock Position:  -0.003207717725581191
Bond Position:  [-5.01225265]


portfolio before change:  [-5.31856657]
curr_Stock_Price:  95.10210183252657
curr_Factors:  [95.10210183]
mat_Sqrt:  [[0.15]]
grads:  [0.05381249]
Stock Position:  0.053812485916944014
Bond Position:  [-10.43624709]


portfolio before change:  [-5.32606654]
curr_Stock_Price:  95.01121994077818
curr_Factors:  [95.01121994]
mat_Sqrt:  [[0.15]]
grads:  [0.05389632]
Stock Position:  0.053896318796403574
Bond Position:  [-10.44682154]


portfolio before change:  [-5.39154337]
curr_Stock_Price:  93.84481749834222
curr_Factors:  [93.8448175]
mat_Sqrt:  [[0.15]]
grads:  [-0.24880347]
Stock Position:  -0.24880346907498158
Bond Position:  [17.95737278]


portfolio before change:  [-4.7683636]
curr_Stock_Price:  91.35815658495797
curr_Factors:  [91.35815658]
mat_Sqrt:  [[0.15]]
grads:  [0.01279983]
Stock Position:  0.012799826616511321
Bond Position:  [-5.93773217]


portfolio before change:  [-4.79738846]
curr_Stock_Price:  89.20654661003806
curr_Factors:  [89.20654661]
mat_Sqrt:  [[0.15]]
grads:  [-0.17637993]
Stock Position:  -0.17637992637847297
Bond Position:  [10.93685567]


portfolio before change:  [-4.89815014]
curr_Stock_Price:  89.79332675808581
curr_Factors:  [89.79332676]
mat_Sqrt:  [[0.15]]
grads:  [0.006984]
Stock Position:  0.006983998707461701
Bond Position:  [-5.52526662]


portfolio before change:  [-4.90200935]
curr_Stock_Price:  89.43855513919826
curr_Factors:  [89.43855514]
mat_Sqrt:  [[0.15]]
grads:  [-0.07880032]
Stock Position:  -0.07880032200412876
Bond Position:  [2.14577759]


portfolio before change:  [-4.78135854]
curr_Stock_Price:  87.91426812578742
curr_Factors:  [87.91426813]
mat_Sqrt:  [[0.15]]
grads:  [0.02541845]
Stock Position:  0.025418453380767904
Bond Position:  [-7.01600326]


portfolio before change:  [-4.77481334]
curr_Stock_Price:  88.24077956764091
curr_Factors:  [88.24077957]
mat_Sqrt:  [[0.15]]
grads:  [-0.03068679]
Stock Position:  -0.03068678840590016
Bond Position:  [-2.06698721]


portfolio before change:  [-4.75445227]
curr_Stock_Price:  87.56042552386128
curr_Factors:  [87.56042552]
mat_Sqrt:  [[0.15]]
grads:  [-0.67144834]
Stock Position:  -0.6714483411580989
Bond Position:  [54.0378502]


portfolio before change:  [-4.87019735]
curr_Stock_Price:  87.75292914214053
curr_Factors:  [87.75292914]
mat_Sqrt:  [[0.15]]
grads:  [0.02751325]
Stock Position:  0.027513246311486862
Bond Position:  [-7.28456531]


portfolio before change:  [-4.88408687]
curr_Stock_Price:  87.31429865714205
curr_Factors:  [87.31429866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02381515]
Stock Position:  -0.023815151502401453
Bond Position:  [-2.80468362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.88408687]
Stock Price:  87.70125268608126
PL:  [-4.88408687]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.05197835e-02]
 [-7.99918597e-03]
 [-1.04210585e-02]
 [ 2.46810304e-03]
 [ 7.04540033e-03]
 [ 5.58941192e-03]
 [-1.30010730e-02]
 [ 2.71708889e-03]
 [ 2.30080407e-04]
 [-3.36765929e-02]
 [-1.11621647e-03]
 [-2.57094995e-02]
 [ 2.17879542e-03]
 [-6.51778323e-04]
 [-1.99119948e-04]
 [ 1.02936423e-02]
 [-1.18405595e-02]
 [ 1.22639035e-02]
 [ 4.54547223e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.96512532]
curr_Stock_Price:  100.79758351321682
curr_Factors:  [100.79758351]
mat_Sqrt:  [[0.15]]
grads:  [0.07013189]
Stock Position:  0.07013189013039606
Bond Position:  [6.89600027]


portfolio before change:  [13.96880625]
curr_Stock_Price:  100.82548399152981
curr_Factors:  [100.82548399]
mat_Sqrt:  [[0.15]]
grads:  [-0.05332791]
Stock Position:  -0.05332790648009814
Bond Position:  [19.34561823]


portfolio before change:  [13.9831242]
curr_Stock_Price:  100.64769822112692
curr_Factors:  [100.64769822]
mat_Sqrt:  [[0.15]]
grads:  [-0.06947372]
Stock Position:  -0.06947372317038199
Bond Position:  [20.97549452]


portfolio before change:  [13.94456545]
curr_Stock_Price:  101.27819963540162
curr_Factors:  [101.27819964]
mat_Sqrt:  [[0.15]]
grads:  [0.01645402]
Stock Position:  0.016454020261782283
Bond Position:  [12.2781319]


portfolio before change:  [13.93566187]
curr_Stock_Price:  100.55050521235763
curr_Factors:  [100.55050521]
mat_Sqrt:  [[0.15]]
grads:  [0.04696934]
Stock Position:  0.04696933553060273
Bond Position:  [9.21287145]


portfolio before change:  [13.91100601]
curr_Stock_Price:  99.9765271538136
curr_Factors:  [99.97652715]
mat_Sqrt:  [[0.15]]
grads:  [0.03726275]
Stock Position:  0.03726274612651434
Bond Position:  [10.18560606]


portfolio before change:  [13.84275074]
curr_Stock_Price:  98.076453021666
curr_Factors:  [98.07645302]
mat_Sqrt:  [[0.15]]
grads:  [-0.08667382]
Stock Position:  -0.08667382014050452
Bond Position:  [22.34341159]


portfolio before change:  [13.83479071]
curr_Stock_Price:  98.2327469293566
curr_Factors:  [98.23274693]
mat_Sqrt:  [[0.15]]
grads:  [0.01811393]
Stock Position:  0.018113925930975387
Bond Position:  [12.05541]


portfolio before change:  [13.85017795]
curr_Stock_Price:  98.91581331983949
curr_Factors:  [98.91581332]
mat_Sqrt:  [[0.15]]
grads:  [0.00153387]
Stock Position:  0.0015338693779519581
Bond Position:  [13.69845401]


portfolio before change:  [13.85399896]
curr_Stock_Price:  99.17396523973632
curr_Factors:  [99.17396524]
mat_Sqrt:  [[0.15]]
grads:  [-0.22451062]
Stock Position:  -0.22451061912893372
Bond Position:  [36.1196073]


portfolio before change:  [13.74949987]
curr_Stock_Price:  99.67964344224556
curr_Factors:  [99.67964344]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744144]
Stock Position:  -0.00744144311333338
Bond Position:  [14.49126026]


portfolio before change:  [13.75725416]
curr_Stock_Price:  99.12450608562324
curr_Factors:  [99.12450609]
mat_Sqrt:  [[0.15]]
grads:  [-0.17139666]
Stock Position:  -0.1713966630377399
Bond Position:  [30.74686373]


portfolio before change:  [13.7829404]
curr_Stock_Price:  99.01949491483575
curr_Factors:  [99.01949491]
mat_Sqrt:  [[0.15]]
grads:  [0.0145253]
Stock Position:  0.014525302831104555
Bond Position:  [12.34465225]


portfolio before change:  [13.79341476]
curr_Stock_Price:  99.52811190442466
curr_Factors:  [99.5281119]
mat_Sqrt:  [[0.15]]
grads:  [-0.00434519]
Stock Position:  -0.004345188820679061
Bond Position:  [14.2258832]


portfolio before change:  [13.78522912]
curr_Stock_Price:  102.23054018256161
curr_Factors:  [102.23054018]
mat_Sqrt:  [[0.15]]
grads:  [-0.00132747]
Stock Position:  -0.001327466319437382
Bond Position:  [13.92093672]


portfolio before change:  [13.78973973]
curr_Stock_Price:  101.45467213433297
curr_Factors:  [101.45467213]
mat_Sqrt:  [[0.15]]
grads:  [0.06862428]
Stock Position:  0.06862428199225366
Bond Position:  [6.8274857]


portfolio before change:  [13.75930242]
curr_Stock_Price:  100.98626081808118
curr_Factors:  [100.98626082]
mat_Sqrt:  [[0.15]]
grads:  [-0.07893706]
Stock Position:  -0.0789370631959957
Bond Position:  [21.73086127]


portfolio before change:  [13.79366861]
curr_Stock_Price:  100.61973094124646
curr_Factors:  [100.61973094]
mat_Sqrt:  [[0.15]]
grads:  [0.08175936]
Stock Position:  0.0817593569968327
Bond Position:  [5.5670641]


portfolio before change:  [13.92821875]
curr_Stock_Price:  102.24839099088189
curr_Factors:  [102.24839099]
mat_Sqrt:  [[0.15]]
grads:  [0.03030315]
Stock Position:  0.030303148193790437
Bond Position:  [10.8297706]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.92821875]
Stock Price:  101.34968521314866
PL:  [12.57853353]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-2.17000439e-02]
 [-6.54889050e-03]
 [-1.02962935e-02]
 [ 2.66937787e-03]
 [ 6.87776409e-03]
 [ 7.02805473e-03]
 [ 1.62268998e-03]
 [ 3.36836079e-04]
 [ 1.40400738e-03]
 [ 8.15709727e-02]
 [-1.53763175e-02]
 [-1.91795696e-02]
 [-1.60211368e-03]
 [-2.42630076e-02]
 [ 1.39580653e-02]
 [ 3.50665399e-03]
 [-1.51150386e-02]
 [-2.42549109e-03]
 [ 4.67079294e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.26459768]
curr_Stock_Price:  101.14413719767069
curr_Factors:  [101.1441372]
mat_Sqrt:  [[0.15]]
grads:  [-0.14466696]
Stock Position:  -0.14466695935092808
Bond Position:  [33.89681246]


portfolio before change:  [19.07802212]
curr_Stock_Price:  102.49241207237566
curr_Factors:  [102.49241207]
mat_Sqrt:  [[0.15]]
grads:  [-0.04365927]
Stock Position:  -0.04365927000722258
Bond Position:  [23.55276601]


portfolio before change:  [19.15007577]
curr_Stock_Price:  100.97693268596063
curr_Factors:  [100.97693269]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864196]
Stock Position:  -0.06864195684891772
Bond Position:  [26.08133002]


portfolio before change:  [19.19924381]
curr_Stock_Price:  100.35563779789162
curr_Factors:  [100.3556378]
mat_Sqrt:  [[0.15]]
grads:  [0.01779585]
Stock Position:  0.017795852459199787
Bond Position:  [17.41332969]


portfolio before change:  [19.21185333]
curr_Stock_Price:  100.81954572790069
curr_Factors:  [100.81954573]
mat_Sqrt:  [[0.15]]
grads:  [0.04585176]
Stock Position:  0.045851760574556144
Bond Position:  [14.58909965]


portfolio before change:  [19.18019706]
curr_Stock_Price:  100.04958619646364
curr_Factors:  [100.0495862]
mat_Sqrt:  [[0.15]]
grads:  [0.0468537]
Stock Position:  0.04685369818762297
Bond Position:  [14.49250394]


portfolio before change:  [19.22705939]
curr_Stock_Price:  100.97243232774044
curr_Factors:  [100.97243233]
mat_Sqrt:  [[0.15]]
grads:  [0.01081793]
Stock Position:  0.010817933189601453
Bond Position:  [18.13474636]


portfolio before change:  [19.24651228]
curr_Stock_Price:  102.35149744041705
curr_Factors:  [102.35149744]
mat_Sqrt:  [[0.15]]
grads:  [0.00224557]
Stock Position:  0.002245573862930385
Bond Position:  [19.01667443]


portfolio before change:  [19.25438576]
curr_Stock_Price:  103.74032775000151
curr_Factors:  [103.74032775]
mat_Sqrt:  [[0.15]]
grads:  [0.00936005]
Stock Position:  0.00936004922092666
Bond Position:  [18.28337119]


portfolio before change:  [19.2860683]
curr_Stock_Price:  106.63679982033594
curr_Factors:  [106.63679982]
mat_Sqrt:  [[0.15]]
grads:  [0.54380648]
Stock Position:  0.543806484944068
Bond Position:  [-38.70371498]


portfolio before change:  [19.33148912]
curr_Stock_Price:  106.73811887434798
curr_Factors:  [106.73811887]
mat_Sqrt:  [[0.15]]
grads:  [-0.10250878]
Stock Position:  -0.10250878342161011
Bond Position:  [30.27308383]


portfolio before change:  [19.5310207]
curr_Stock_Price:  104.86547580199887
curr_Factors:  [104.8654758]
mat_Sqrt:  [[0.15]]
grads:  [-0.1278638]
Stock Position:  -0.12786379712353493
Bond Position:  [32.93951862]


portfolio before change:  [19.55571306]
curr_Stock_Price:  104.73677281898779
curr_Factors:  [104.73677282]
mat_Sqrt:  [[0.15]]
grads:  [-0.01068076]
Stock Position:  -0.01068075783878482
Bond Position:  [20.67438116]


portfolio before change:  [19.54291481]
curr_Stock_Price:  106.41900251551681
curr_Factors:  [106.41900252]
mat_Sqrt:  [[0.15]]
grads:  [-0.16175338]
Stock Position:  -0.1617533837707686
Bond Position:  [36.75654857]


portfolio before change:  [19.54257629]
curr_Stock_Price:  106.47791201378385
curr_Factors:  [106.47791201]
mat_Sqrt:  [[0.15]]
grads:  [0.09305377]
Stock Position:  0.09305376842494352
Bond Position:  [9.63440532]


portfolio before change:  [19.69524716]
curr_Stock_Price:  108.09269855770248
curr_Factors:  [108.09269856]
mat_Sqrt:  [[0.15]]
grads:  [0.02337769]
Stock Position:  0.02337769327624526
Bond Position:  [17.16828921]


portfolio before change:  [19.70145777]
curr_Stock_Price:  108.17474264416032
curr_Factors:  [108.17474264]
mat_Sqrt:  [[0.15]]
grads:  [-0.10076692]
Stock Position:  -0.10076692405170276
Bond Position:  [30.60189385]


portfolio before change:  [19.59067731]
curr_Stock_Price:  109.3500479141336
curr_Factors:  [109.35004791]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616994]
Stock Position:  -0.016169940599754032
Bond Position:  [21.35886108]


portfolio before change:  [19.64306477]
curr_Stock_Price:  106.44050861246723
curr_Factors:  [106.44050861]
mat_Sqrt:  [[0.15]]
grads:  [0.03113862]
Stock Position:  0.031138619602568713
Bond Position:  [16.32865426]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.64306477]
Stock Price:  106.50591138473004
PL:  [13.13715338]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.92264691e-02]
 [-3.72051415e-03]
 [ 4.47210928e-03]
 [ 2.23835004e-03]
 [ 6.14699546e-03]
 [ 1.07443212e-02]
 [ 1.46187427e-03]
 [-1.95645894e-03]
 [-2.15887216e-04]
 [-2.99509038e-02]
 [-1.80593495e-03]
 [-2.30199123e-02]
 [ 3.03143299e-04]
 [-1.90717585e-03]
 [-3.40241801e-03]
 [ 8.86526015e-03]
 [-4.80744685e-02]
 [-2.67190226e-02]
 [ 4.64068422e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.21171276]
curr_Stock_Price:  101.7292248223174
curr_Factors:  [101.72922482]
mat_Sqrt:  [[0.15]]
grads:  [-0.26150979]
Stock Position:  -0.261509793785802
Bond Position:  [54.81490136]


portfolio before change:  [27.69632607]
curr_Stock_Price:  103.75244588810514
curr_Factors:  [103.75244589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02480343]
Stock Position:  -0.02480342769565777
Bond Position:  [30.26974236]


portfolio before change:  [27.7465195]
curr_Stock_Price:  102.0339315860722
curr_Factors:  [102.03393159]
mat_Sqrt:  [[0.15]]
grads:  [0.02981406]
Stock Position:  0.029814061892024433
Bond Position:  [24.70447355]


portfolio before change:  [27.76619621]
curr_Stock_Price:  102.48673208579301
curr_Factors:  [102.48673209]
mat_Sqrt:  [[0.15]]
grads:  [0.01492233]
Stock Position:  0.0149223336303669
Bond Position:  [26.236855]


portfolio before change:  [27.76290871]
curr_Stock_Price:  101.82681285968914
curr_Factors:  [101.82681286]
mat_Sqrt:  [[0.15]]
grads:  [0.04097997]
Stock Position:  0.04097996973408748
Bond Position:  [23.590049]


portfolio before change:  [27.7240474]
curr_Stock_Price:  100.7345826378043
curr_Factors:  [100.73458264]
mat_Sqrt:  [[0.15]]
grads:  [0.07162881]
Stock Position:  0.07162880799159839
Bond Position:  [20.50854932]


portfolio before change:  [27.79164454]
curr_Stock_Price:  101.606708919644
curr_Factors:  [101.60670892]
mat_Sqrt:  [[0.15]]
grads:  [0.00974583]
Stock Position:  0.009745828435828233
Bond Position:  [26.80140299]


portfolio before change:  [27.78208737]
curr_Stock_Price:  99.93847123467225
curr_Factors:  [99.93847123]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304306]
Stock Position:  -0.013043059608019127
Bond Position:  [29.08559081]


portfolio before change:  [27.79656428]
curr_Stock_Price:  99.38610055225833
curr_Factors:  [99.38610055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143925]
Stock Position:  -0.0014392481066334056
Bond Position:  [27.93960554]


portfolio before change:  [27.80350427]
curr_Stock_Price:  99.41791222730251
curr_Factors:  [99.41791223]
mat_Sqrt:  [[0.15]]
grads:  [-0.19967269]
Stock Position:  -0.1996726918121022
Bond Position:  [47.65454642]


portfolio before change:  [27.69896833]
curr_Stock_Price:  100.00112198973756
curr_Factors:  [100.00112199]
mat_Sqrt:  [[0.15]]
grads:  [-0.01203957]
Stock Position:  -0.012039566365074339
Bond Position:  [28.90293848]


portfolio before change:  [27.69774332]
curr_Stock_Price:  100.70311157984685
curr_Factors:  [100.70311158]
mat_Sqrt:  [[0.15]]
grads:  [-0.15346608]
Stock Position:  -0.1534660820439885
Bond Position:  [43.15225531]


portfolio before change:  [27.68770148]
curr_Stock_Price:  100.83885009142702
curr_Factors:  [100.83885009]
mat_Sqrt:  [[0.15]]
grads:  [0.00202096]
Stock Position:  0.0020209553299840406
Bond Position:  [27.48391066]


portfolio before change:  [27.69253813]
curr_Stock_Price:  99.83181239429561
curr_Factors:  [99.83181239]
mat_Sqrt:  [[0.15]]
grads:  [-0.01271451]
Stock Position:  -0.01271450569228472
Bond Position:  [28.96185028]


portfolio before change:  [27.68881008]
curr_Stock_Price:  100.69456097500465
curr_Factors:  [100.69456098]
mat_Sqrt:  [[0.15]]
grads:  [-0.02268279]
Stock Position:  -0.022682786758625447
Bond Position:  [29.97284334]


portfolio before change:  [27.65937084]
curr_Stock_Price:  102.32281703496365
curr_Factors:  [102.32281703]
mat_Sqrt:  [[0.15]]
grads:  [0.05910173]
Stock Position:  0.059101734332570856
Bond Position:  [21.61191489]


portfolio before change:  [27.66857977]
curr_Stock_Price:  102.3872021518338
curr_Factors:  [102.38720215]
mat_Sqrt:  [[0.15]]
grads:  [-0.32049646]
Stock Position:  -0.32049645636083834
Bond Position:  [60.48331524]


portfolio before change:  [27.5727671]
curr_Stock_Price:  102.73333823409085
curr_Factors:  [102.73333823]
mat_Sqrt:  [[0.15]]
grads:  [-0.17812682]
Stock Position:  -0.17812681725221818
Bond Position:  [45.87232967]


portfolio before change:  [27.57381947]
curr_Stock_Price:  102.7918198410057
curr_Factors:  [102.79181984]
mat_Sqrt:  [[0.15]]
grads:  [0.03093789]
Stock Position:  0.03093789481951238
Bond Position:  [24.39365696]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.57381947]
Stock Price:  103.23689064562676
PL:  [24.33692883]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.91652031e-02]
 [ 8.75241261e-03]
 [ 3.82262656e-03]
 [ 3.71350510e-03]
 [ 8.37203578e-03]
 [ 1.02323150e-03]
 [-5.92216487e-03]
 [-1.62324258e-03]
 [-7.29649240e-04]
 [ 1.81909320e-02]
 [-7.50485286e-03]
 [-2.22174495e-02]
 [-3.96501397e-04]
 [-1.88937864e-02]
 [-3.22060824e-03]
 [ 1.06383203e-02]
 [-4.72744551e-02]
 [-2.67159165e-02]
 [ 4.53499925e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.14217776]
curr_Stock_Price:  98.50177660890415
curr_Factors:  [98.50177661]
mat_Sqrt:  [[0.15]]
grads:  [0.66110135]
Stock Position:  0.6611013541965621
Bond Position:  [-86.26183566]


portfolio before change:  [-21.40227647]
curr_Stock_Price:  98.14096876024921
curr_Factors:  [98.14096876]
mat_Sqrt:  [[0.15]]
grads:  [0.05834942]
Stock Position:  0.05834941740890338
Bond Position:  [-27.12874482]


portfolio before change:  [-21.3567626]
curr_Stock_Price:  99.03723996484827
curr_Factors:  [99.03723996]
mat_Sqrt:  [[0.15]]
grads:  [0.02548418]
Stock Position:  0.025484177074913454
Bond Position:  [-23.88064516]


portfolio before change:  [-21.36799103]
curr_Stock_Price:  98.83093475449552
curr_Factors:  [98.83093475]
mat_Sqrt:  [[0.15]]
grads:  [0.0247567]
Stock Position:  0.02475670068488007
Bond Position:  [-23.8147189]


portfolio before change:  [-21.37048116]
curr_Stock_Price:  98.9708683106776
curr_Factors:  [98.97086831]
mat_Sqrt:  [[0.15]]
grads:  [0.05581357]
Stock Position:  0.05581357186643673
Bond Position:  [-26.89439883]


portfolio before change:  [-21.35024767]
curr_Stock_Price:  99.45386780781227
curr_Factors:  [99.45386781]
mat_Sqrt:  [[0.15]]
grads:  [0.00682154]
Stock Position:  0.006821543316423545
Bond Position:  [-22.02867654]


portfolio before change:  [-21.34970697]
curr_Stock_Price:  100.34055292932243
curr_Factors:  [100.34055293]
mat_Sqrt:  [[0.15]]
grads:  [-0.0394811]
Stock Position:  -0.03948109910842844
Bond Position:  [-17.38815165]


portfolio before change:  [-21.37588506]
curr_Stock_Price:  100.89348875690021
curr_Factors:  [100.89348876]
mat_Sqrt:  [[0.15]]
grads:  [-0.01082162]
Stock Position:  -0.010821617190997135
Bond Position:  [-20.28405435]


portfolio before change:  [-21.37119052]
curr_Stock_Price:  99.99101835814083
curr_Factors:  [99.99101836]
mat_Sqrt:  [[0.15]]
grads:  [-0.00486433]
Stock Position:  -0.004864328268035155
Bond Position:  [-20.88480138]


portfolio before change:  [-21.38429826]
curr_Stock_Price:  101.61218431083148
curr_Factors:  [101.61218431]
mat_Sqrt:  [[0.15]]
grads:  [0.12127288]
Stock Position:  0.12127288032797254
Bond Position:  [-33.70710053]


portfolio before change:  [-21.3322592]
curr_Stock_Price:  102.11078614856113
curr_Factors:  [102.11078615]
mat_Sqrt:  [[0.15]]
grads:  [-0.05003235]
Stock Position:  -0.05003235238765233
Bond Position:  [-16.22341637]


portfolio before change:  [-21.30936585]
curr_Stock_Price:  101.57214040375534
curr_Factors:  [101.5721404]
mat_Sqrt:  [[0.15]]
grads:  [-0.14811633]
Stock Position:  -0.14811633022211393
Bond Position:  [-6.26487316]


portfolio before change:  [-21.40719678]
curr_Stock_Price:  102.22206548197641
curr_Factors:  [102.22206548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00264334]
Stock Position:  -0.002643342648945693
Bond Position:  [-21.13698884]


portfolio before change:  [-21.41421855]
curr_Stock_Price:  102.87913408626031
curr_Factors:  [102.87913409]
mat_Sqrt:  [[0.15]]
grads:  [-0.12595858]
Stock Position:  -0.12595857589994053
Bond Position:  [-8.45570933]


portfolio before change:  [-21.16603942]
curr_Stock_Price:  100.8920258792569
curr_Factors:  [100.89202588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02147072]
Stock Position:  -0.021470721616981728
Bond Position:  [-18.99981482]


portfolio before change:  [-21.1650714]
curr_Stock_Price:  100.62568345914566
curr_Factors:  [100.62568346]
mat_Sqrt:  [[0.15]]
grads:  [0.07092214]
Stock Position:  0.07092213540028547
Bond Position:  [-28.30165975]


portfolio before change:  [-21.06958188]
curr_Stock_Price:  102.07185856566579
curr_Factors:  [102.07185857]
mat_Sqrt:  [[0.15]]
grads:  [-0.31516303]
Stock Position:  -0.3151630339052855
Bond Position:  [11.09969474]


portfolio before change:  [-21.13344234]
curr_Stock_Price:  102.28329116100359
curr_Factors:  [102.28329116]
mat_Sqrt:  [[0.15]]
grads:  [-0.17810611]
Stock Position:  -0.1781061100257586
Bond Position:  [-2.91616324]


portfolio before change:  [-21.11731861]
curr_Stock_Price:  102.18866854716796
curr_Factors:  [102.18866855]
mat_Sqrt:  [[0.15]]
grads:  [0.03023333]
Stock Position:  0.03023332835358698
Bond Position:  [-24.20682218]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.11731861]
Stock Price:  103.09026857858123
PL:  [-24.20758719]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 5.92292755e-02]
 [ 8.79785838e-03]
 [ 2.47634768e-02]
 [-2.50596281e-03]
 [ 9.31309940e-03]
 [ 4.51551967e-02]
 [-2.37469254e-03]
 [ 7.51368687e-03]
 [ 9.50326323e-03]
 [-3.73024658e-02]
 [-4.57135349e-04]
 [-2.63865188e-02]
 [ 1.87599230e-03]
 [-6.33118336e-03]
 [ 4.97520521e-04]
 [ 6.69976038e-03]
 [ 6.39860568e-03]
 [ 1.65500535e-02]
 [ 1.92289439e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.41406178]
curr_Stock_Price:  98.81096701540706
curr_Factors:  [98.81096702]
mat_Sqrt:  [[0.15]]
grads:  [0.39486184]
Stock Position:  0.3948618369771193
Bond Position:  [-55.43074173]


portfolio before change:  [-16.74066858]
curr_Stock_Price:  98.01892443495707
curr_Factors:  [98.01892443]
mat_Sqrt:  [[0.15]]
grads:  [0.05865239]
Stock Position:  0.05865238917776667
Bond Position:  [-22.48971269]


portfolio before change:  [-16.7953398]
curr_Stock_Price:  97.18267404322572
curr_Factors:  [97.18267404]
mat_Sqrt:  [[0.15]]
grads:  [0.16508985]
Stock Position:  0.16508984515374514
Bond Position:  [-32.83921241]


portfolio before change:  [-16.9184431]
curr_Stock_Price:  96.48673495736614
curr_Factors:  [96.48673496]
mat_Sqrt:  [[0.15]]
grads:  [-0.01670642]
Stock Position:  -0.016706418734179596
Bond Position:  [-15.30649531]


portfolio before change:  [-16.89732639]
curr_Stock_Price:  94.99366709389614
curr_Factors:  [94.99366709]
mat_Sqrt:  [[0.15]]
grads:  [0.06208733]
Stock Position:  0.0620873293605091
Bond Position:  [-22.79522948]


portfolio before change:  [-16.8441345]
curr_Stock_Price:  95.94219249851817
curr_Factors:  [95.9421925]
mat_Sqrt:  [[0.15]]
grads:  [0.30103464]
Stock Position:  0.301034644392832
Bond Position:  [-45.7260583]


portfolio before change:  [-17.12370888]
curr_Stock_Price:  95.05145966479932
curr_Factors:  [95.05145966]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583128]
Stock Position:  -0.015831283586887752
Bond Position:  [-15.61892227]


portfolio before change:  [-17.13614055]
curr_Stock_Price:  95.59004160247763
curr_Factors:  [95.5900416]
mat_Sqrt:  [[0.15]]
grads:  [0.05009125]
Stock Position:  0.05009124579746386
Bond Position:  [-21.92436482]


portfolio before change:  [-17.20594286]
curr_Stock_Price:  94.30597425915103
curr_Factors:  [94.30597426]
mat_Sqrt:  [[0.15]]
grads:  [0.06335509]
Stock Position:  0.06335508819995957
Bond Position:  [-23.18070617]


portfolio before change:  [-17.190078]
curr_Stock_Price:  94.64786872980741
curr_Factors:  [94.64786873]
mat_Sqrt:  [[0.15]]
grads:  [-0.24868311]
Stock Position:  -0.24868310508228256
Bond Position:  [6.34724788]


portfolio before change:  [-17.32221745]
curr_Stock_Price:  95.18560715398166
curr_Factors:  [95.18560715]
mat_Sqrt:  [[0.15]]
grads:  [-0.00304757]
Stock Position:  -0.0030475689927895663
Bond Position:  [-17.03213275]


portfolio before change:  [-17.32414613]
curr_Stock_Price:  94.42110037353935
curr_Factors:  [94.42110037]
mat_Sqrt:  [[0.15]]
grads:  [-0.17591013]
Stock Position:  -0.1759101250114233
Bond Position:  [-0.71451856]


portfolio before change:  [-17.12228627]
curr_Stock_Price:  93.27256774633962
curr_Factors:  [93.27256775]
mat_Sqrt:  [[0.15]]
grads:  [0.01250662]
Stock Position:  0.012506615356321442
Bond Position:  [-18.28881039]


portfolio before change:  [-17.129589]
curr_Stock_Price:  93.05428620009737
curr_Factors:  [93.0542862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04220789]
Stock Position:  -0.04220788908713315
Bond Position:  [-13.20196401]


portfolio before change:  [-17.14565005]
curr_Stock_Price:  93.35660283059006
curr_Factors:  [93.35660283]
mat_Sqrt:  [[0.15]]
grads:  [0.0033168]
Stock Position:  0.0033168034747290288
Bond Position:  [-17.45529556]


portfolio before change:  [-17.14690582]
curr_Stock_Price:  94.29383175995183
curr_Factors:  [94.29383176]
mat_Sqrt:  [[0.15]]
grads:  [0.04466507]
Stock Position:  0.04466506922513555
Bond Position:  [-21.35854634]


portfolio before change:  [-17.1813286]
curr_Stock_Price:  93.64270818595753
curr_Factors:  [93.64270819]
mat_Sqrt:  [[0.15]]
grads:  [0.04265737]
Stock Position:  0.04265737117942657
Bond Position:  [-21.17588036]


portfolio before change:  [-17.15080097]
curr_Stock_Price:  94.48247550593501
curr_Factors:  [94.48247551]
mat_Sqrt:  [[0.15]]
grads:  [0.11033369]
Stock Position:  0.11033368970353934
Bond Position:  [-27.5754011]


portfolio before change:  [-17.14151955]
curr_Stock_Price:  94.62908647583671
curr_Factors:  [94.62908648]
mat_Sqrt:  [[0.15]]
grads:  [0.0128193]
Stock Position:  0.012819295918295578
Bond Position:  [-18.35459781]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.14151955]
Stock Price:  95.29503348995908
PL:  [-17.14151955]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.24835247e-02]
 [ 8.19753090e-03]
 [ 8.68910310e-05]
 [ 3.71004908e-03]
 [ 7.23780909e-03]
 [ 1.04437110e-02]
 [-1.58820934e-02]
 [-4.68333326e-04]
 [ 2.34188696e-04]
 [-3.73732133e-02]
 [-9.95341600e-04]
 [-2.63494845e-02]
 [ 2.35412495e-03]
 [-5.13062583e-03]
 [-6.38564513e-04]
 [ 8.03643892e-03]
 [ 2.77808491e-02]
 [ 1.62173593e-02]
 [-3.61674134e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.82675932]
curr_Stock_Price:  99.50331305000726
curr_Factors:  [99.50331305]
mat_Sqrt:  [[0.15]]
grads:  [0.0832235]
Stock Position:  0.0832234976706058
Bond Position:  [-14.10777307]


portfolio before change:  [-5.91716537]
curr_Stock_Price:  98.45939318437044
curr_Factors:  [98.45939318]
mat_Sqrt:  [[0.15]]
grads:  [0.05465021]
Stock Position:  0.05465020601127177
Bond Position:  [-11.29799149]


portfolio before change:  [-5.86760509]
curr_Stock_Price:  99.41794648861362
curr_Factors:  [99.41794649]
mat_Sqrt:  [[0.15]]
grads:  [0.00057927]
Stock Position:  0.0005792735398629095
Bond Position:  [-5.92519527]


portfolio before change:  [-5.86903448]
curr_Stock_Price:  99.50787101961384
curr_Factors:  [99.50787102]
mat_Sqrt:  [[0.15]]
grads:  [0.02473366]
Stock Position:  0.02473366051313725
Bond Position:  [-8.33022838]


portfolio before change:  [-5.85117401]
curr_Stock_Price:  100.31419286727129
curr_Factors:  [100.31419287]
mat_Sqrt:  [[0.15]]
grads:  [0.04825206]
Stock Position:  0.04825206057665578
Bond Position:  [-10.69154052]


portfolio before change:  [-5.8155692]
curr_Stock_Price:  101.10748601508377
curr_Factors:  [101.10748602]
mat_Sqrt:  [[0.15]]
grads:  [0.06962474]
Stock Position:  0.06962473977217777
Bond Position:  [-12.8551516]


portfolio before change:  [-5.94134954]
curr_Stock_Price:  99.34710384946119
curr_Factors:  [99.34710385]
mat_Sqrt:  [[0.15]]
grads:  [-0.10588062]
Stock Position:  -0.1058806224109553
Bond Position:  [4.57758365]


portfolio before change:  [-5.92464226]
curr_Stock_Price:  99.20012005465578
curr_Factors:  [99.20012005]
mat_Sqrt:  [[0.15]]
grads:  [-0.00312222]
Stock Position:  -0.0031222221732577055
Bond Position:  [-5.61491745]


portfolio before change:  [-5.92514515]
curr_Stock_Price:  98.91153812499341
curr_Factors:  [98.91153812]
mat_Sqrt:  [[0.15]]
grads:  [0.00156126]
Stock Position:  0.0015612579748851738
Bond Position:  [-6.07957158]


portfolio before change:  [-5.9275003]
curr_Stock_Price:  98.37666988856158
curr_Factors:  [98.37666989]
mat_Sqrt:  [[0.15]]
grads:  [-0.24915476]
Stock Position:  -0.24915475527109737
Bond Position:  [18.58351481]


portfolio before change:  [-5.80145316]
curr_Stock_Price:  97.88941978973195
curr_Factors:  [97.88941979]
mat_Sqrt:  [[0.15]]
grads:  [-0.00663561]
Stock Position:  -0.0066356106645131556
Bond Position:  [-5.15189708]


portfolio before change:  [-5.79786051]
curr_Stock_Price:  97.15387613494504
curr_Factors:  [97.15387613]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566323]
Stock Position:  -0.17566322983907998
Bond Position:  [11.26850316]


portfolio before change:  [-5.46599847]
curr_Stock_Price:  95.2807205284496
curr_Factors:  [95.28072053]
mat_Sqrt:  [[0.15]]
grads:  [0.01569417]
Stock Position:  0.01569416632659816
Bond Position:  [-6.96134995]


portfolio before change:  [-5.49026926]
curr_Stock_Price:  93.84514062942026
curr_Factors:  [93.84514063]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420417]
Stock Position:  -0.034204172227475384
Bond Position:  [-2.2803739]


portfolio before change:  [-5.53641476]
curr_Stock_Price:  95.17759015653863
curr_Factors:  [95.17759016]
mat_Sqrt:  [[0.15]]
grads:  [-0.0042571]
Stock Position:  -0.004257096755535112
Bond Position:  [-5.13123455]


portfolio before change:  [-5.53698288]
curr_Stock_Price:  95.00967210515256
curr_Factors:  [95.00967211]
mat_Sqrt:  [[0.15]]
grads:  [0.05357626]
Stock Position:  0.05357625949153302
Bond Position:  [-10.62724573]


portfolio before change:  [-5.54794075]
curr_Stock_Price:  94.85473917282053
curr_Factors:  [94.85473917]
mat_Sqrt:  [[0.15]]
grads:  [0.18520566]
Stock Position:  0.18520566049795703
Bond Position:  [-23.11557537]


portfolio before change:  [-5.65550388]
curr_Stock_Price:  94.30516896038628
curr_Factors:  [94.30516896]
mat_Sqrt:  [[0.15]]
grads:  [0.10811573]
Stock Position:  0.10811572852081087
Bond Position:  [-15.85137593]


portfolio before change:  [-5.91372537]
curr_Stock_Price:  91.95344689042491
curr_Factors:  [91.95344689]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241116]
Stock Position:  -0.002411160890715142
Bond Position:  [-5.69201081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.91372537]
Stock Price:  92.2352310979007
PL:  [-5.91372537]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.25809353e-02]
 [ 6.18197984e-03]
 [ 7.03623474e-03]
 [-3.92584576e-03]
 [ 9.12006622e-03]
 [ 3.27302637e-02]
 [-9.16194570e-03]
 [ 6.26660339e-03]
 [ 9.95979415e-03]
 [-3.73022115e-02]
 [-7.94896022e-04]
 [-2.63700767e-02]
 [ 2.36317682e-03]
 [-7.52542962e-04]
 [-1.82144083e-03]
 [ 1.03325737e-02]
 [ 2.61891205e-02]
 [ 1.92032001e-02]
 [ 2.26762795e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.57232893]
curr_Stock_Price:  99.12758728347146
curr_Factors:  [99.12758728]
mat_Sqrt:  [[0.15]]
grads:  [0.15053957]
Stock Position:  0.15053956872217875
Bond Position:  [-26.49495316]


portfolio before change:  [-11.55183652]
curr_Stock_Price:  99.30771915523299
curr_Factors:  [99.30771916]
mat_Sqrt:  [[0.15]]
grads:  [0.0412132]
Stock Position:  0.04121319893202253
Bond Position:  [-15.6446253]


portfolio before change:  [-11.5842938]
curr_Stock_Price:  98.61508574195777
curr_Factors:  [98.61508574]
mat_Sqrt:  [[0.15]]
grads:  [0.04690823]
Stock Position:  0.04690823157387343
Bond Position:  [-16.21015308]


portfolio before change:  [-11.70848554]
curr_Stock_Price:  96.05394270589693
curr_Factors:  [96.05394271]
mat_Sqrt:  [[0.15]]
grads:  [-0.02617231]
Stock Position:  -0.026172305048656055
Bond Position:  [-9.19453245]


portfolio before change:  [-11.70621138]
curr_Stock_Price:  95.87921305558412
curr_Factors:  [95.87921306]
mat_Sqrt:  [[0.15]]
grads:  [0.06080044]
Stock Position:  0.06080044143914075
Bond Position:  [-17.53570986]


portfolio before change:  [-11.65326123]
curr_Stock_Price:  96.82220994573721
curr_Factors:  [96.82220995]
mat_Sqrt:  [[0.15]]
grads:  [0.21820176]
Stock Position:  0.21820175782918377
Bond Position:  [-32.78003763]


portfolio before change:  [-11.62624706]
curr_Stock_Price:  96.98357528555668
curr_Factors:  [96.98357529]
mat_Sqrt:  [[0.15]]
grads:  [-0.06107964]
Stock Position:  -0.061079637993554696
Bond Position:  [-5.70252539]


portfolio before change:  [-11.60582076]
curr_Stock_Price:  96.62581105224757
curr_Factors:  [96.62581105]
mat_Sqrt:  [[0.15]]
grads:  [0.04177736]
Stock Position:  0.041777355928789395
Bond Position:  [-15.64259166]


portfolio before change:  [-11.71612892]
curr_Stock_Price:  94.0790480103197
curr_Factors:  [94.07904801]
mat_Sqrt:  [[0.15]]
grads:  [0.06639863]
Stock Position:  0.06639862765752465
Bond Position:  [-17.9628486]


portfolio before change:  [-11.68210021]
curr_Stock_Price:  94.6591802770219
curr_Factors:  [94.65918028]
mat_Sqrt:  [[0.15]]
grads:  [-0.24868141]
Stock Position:  -0.24868140966991845
Bond Position:  [11.85787818]


portfolio before change:  [-11.9496403]
curr_Stock_Price:  95.746937202257
curr_Factors:  [95.7469372]
mat_Sqrt:  [[0.15]]
grads:  [-0.00529931]
Stock Position:  -0.0052993068129961185
Bond Position:  [-11.4422479]


portfolio before change:  [-11.95190466]
curr_Stock_Price:  95.63436399601488
curr_Factors:  [95.634364]
mat_Sqrt:  [[0.15]]
grads:  [-0.17580051]
Stock Position:  -0.17580051157902993
Bond Position:  [4.86066546]


portfolio before change:  [-11.89520218]
curr_Stock_Price:  95.31873831748402
curr_Factors:  [95.31873832]
mat_Sqrt:  [[0.15]]
grads:  [0.01575451]
Stock Position:  0.015754512153571106
Bond Position:  [-13.3969024]


portfolio before change:  [-11.87633139]
curr_Stock_Price:  96.72915588714345
curr_Factors:  [96.72915589]
mat_Sqrt:  [[0.15]]
grads:  [-0.00501695]
Stock Position:  -0.005016953080821269
Bond Position:  [-11.39104575]


portfolio before change:  [-11.88091797]
curr_Stock_Price:  97.07567530917338
curr_Factors:  [97.07567531]
mat_Sqrt:  [[0.15]]
grads:  [-0.01214294]
Stock Position:  -0.012142938860203931
Bond Position:  [-10.70213398]


portfolio before change:  [-11.87343823]
curr_Stock_Price:  96.23933644593147
curr_Factors:  [96.23933645]
mat_Sqrt:  [[0.15]]
grads:  [0.06888382]
Stock Position:  0.06888382489763283
Bond Position:  [-18.50277183]


portfolio before change:  [-11.97965452]
curr_Stock_Price:  94.76453428807977
curr_Factors:  [94.76453429]
mat_Sqrt:  [[0.15]]
grads:  [0.17459414]
Stock Position:  0.1745941368074913
Bond Position:  [-28.52498658]


portfolio before change:  [-11.78916123]
curr_Stock_Price:  95.89644756797358
curr_Factors:  [95.89644757]
mat_Sqrt:  [[0.15]]
grads:  [0.12802133]
Stock Position:  0.12802133421409317
Bond Position:  [-24.0659524]


portfolio before change:  [-11.90580041]
curr_Stock_Price:  95.03235772069388
curr_Factors:  [95.03235772]
mat_Sqrt:  [[0.15]]
grads:  [0.01511752]
Stock Position:  0.015117519699124194
Bond Position:  [-13.34245395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.90580041]
Stock Price:  94.55750727903812
PL:  [-11.90580041]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.28125470e-02]
 [ 7.03988651e-03]
 [ 1.57169926e-03]
 [ 1.26516260e-03]
 [ 8.83301997e-03]
 [ 3.15560601e-02]
 [-8.75141824e-03]
 [ 8.43511361e-03]
 [ 3.73381573e-03]
 [-3.72525046e-02]
 [-9.94011986e-04]
 [-2.56744153e-02]
 [-1.27026900e-04]
 [-1.93111324e-02]
 [ 6.68406584e-03]
 [ 8.48218531e-03]
 [-4.06047372e-02]
 [-9.30444728e-03]
 [ 4.62483985e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.65049565]
curr_Stock_Price:  99.12247564874392
curr_Factors:  [99.12247565]
mat_Sqrt:  [[0.15]]
grads:  [0.15208365]
Stock Position:  0.1520836464876022
Bond Position:  [-26.7254032]


portfolio before change:  [-11.68817248]
curr_Stock_Price:  98.91867571049562
curr_Factors:  [98.91867571]
mat_Sqrt:  [[0.15]]
grads:  [0.04693258]
Stock Position:  0.046932576759586495
Bond Position:  [-16.33068082]


portfolio before change:  [-11.67576682]
curr_Stock_Price:  99.27000597206059
curr_Factors:  [99.27000597]
mat_Sqrt:  [[0.15]]
grads:  [0.010478]
Stock Position:  0.010477995082688828
Bond Position:  [-12.71591746]


portfolio before change:  [-11.69606515]
curr_Stock_Price:  97.63620566534631
curr_Factors:  [97.63620567]
mat_Sqrt:  [[0.15]]
grads:  [0.00843442]
Stock Position:  0.008434417328905888
Bond Position:  [-12.51956965]


portfolio before change:  [-11.70285398]
curr_Stock_Price:  97.20244218116774
curr_Factors:  [97.20244218]
mat_Sqrt:  [[0.15]]
grads:  [0.0588868]
Stock Position:  0.058886799810107665
Bond Position:  [-17.42679473]


portfolio before change:  [-11.72470456]
curr_Stock_Price:  96.90537494950493
curr_Factors:  [96.90537495]
mat_Sqrt:  [[0.15]]
grads:  [0.21037373]
Stock Position:  0.2103737342542784
Bond Position:  [-32.11105015]


portfolio before change:  [-11.74086717]
curr_Stock_Price:  96.86671114329755
curr_Factors:  [96.86671114]
mat_Sqrt:  [[0.15]]
grads:  [-0.05834279]
Stock Position:  -0.058342788257667845
Bond Position:  [-6.08939316]


portfolio before change:  [-11.62091203]
curr_Stock_Price:  94.7845740059972
curr_Factors:  [94.78457401]
mat_Sqrt:  [[0.15]]
grads:  [0.05623409]
Stock Position:  0.056234090713066676
Bond Position:  [-16.95103636]


portfolio before change:  [-11.49586368]
curr_Stock_Price:  97.0836532969584
curr_Factors:  [97.0836533]
mat_Sqrt:  [[0.15]]
grads:  [0.0248921]
Stock Position:  0.024892104869126217
Bond Position:  [-13.91248016]


portfolio before change:  [-11.50465816]
curr_Stock_Price:  96.87009475557068
curr_Factors:  [96.87009476]
mat_Sqrt:  [[0.15]]
grads:  [-0.24835003]
Stock Position:  -0.24835003044562007
Bond Position:  [12.55303282]


portfolio before change:  [-11.74824342]
curr_Stock_Price:  97.86354705796526
curr_Factors:  [97.86354706]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662675]
Stock Position:  -0.006626746570629593
Bond Position:  [-11.09972649]


portfolio before change:  [-11.75955989]
curr_Stock_Price:  99.15244361151615
curr_Factors:  [99.15244361]
mat_Sqrt:  [[0.15]]
grads:  [-0.17116277]
Stock Position:  -0.1711627683587948
Bond Position:  [5.21164685]


portfolio before change:  [-12.17165885]
curr_Stock_Price:  101.56770041941473
curr_Factors:  [101.56770042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00084685]
Stock Position:  -0.0008468459982363183
Bond Position:  [-12.08564665]


portfolio before change:  [-12.17608591]
curr_Stock_Price:  103.22711807189056
curr_Factors:  [103.22711807]
mat_Sqrt:  [[0.15]]
grads:  [-0.12874088]
Stock Position:  -0.12874088238670048
Bond Position:  [1.11346435]


portfolio before change:  [-12.31880524]
curr_Stock_Price:  104.3378586988735
curr_Factors:  [104.3378587]
mat_Sqrt:  [[0.15]]
grads:  [0.04456044]
Stock Position:  0.04456043890340061
Bond Position:  [-16.96814602]


portfolio before change:  [-12.36812328]
curr_Stock_Price:  103.32630051067838
curr_Factors:  [103.32630051]
mat_Sqrt:  [[0.15]]
grads:  [0.0565479]
Stock Position:  0.056547902058988284
Bond Position:  [-18.21100881]


portfolio before change:  [-12.2565494]
curr_Stock_Price:  105.37990816518224
curr_Factors:  [105.37990817]
mat_Sqrt:  [[0.15]]
grads:  [-0.27069825]
Stock Position:  -0.27069824786300045
Bond Position:  [16.2696071]


portfolio before change:  [-12.64631097]
curr_Stock_Price:  106.83477342444137
curr_Factors:  [106.83477342]
mat_Sqrt:  [[0.15]]
grads:  [-0.06202965]
Stock Position:  -0.062029648503643495
Bond Position:  [-6.01938752]


portfolio before change:  [-12.6053652]
curr_Stock_Price:  106.15041033681578
curr_Factors:  [106.15041034]
mat_Sqrt:  [[0.15]]
grads:  [0.03083227]
Stock Position:  0.030832265669220964
Bond Position:  [-15.87822285]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.6053652]
Stock Price:  106.67138084820549
PL:  [-19.27674605]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.43360439e-03]
 [-7.93760868e-03]
 [-7.55443041e-03]
 [ 2.52479193e-03]
 [ 8.45604080e-03]
 [ 9.64556963e-03]
 [-1.27964492e-02]
 [ 1.98520179e-03]
 [ 1.59976410e-04]
 [-3.80315148e-02]
 [-1.08090217e-03]
 [-2.42713691e-02]
 [ 1.80118378e-05]
 [-6.55330540e-03]
 [-2.24170696e-03]
 [ 1.06613689e-02]
 [-4.39633906e-02]
 [-2.34874601e-02]
 [ 4.64187938e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.63721437]
curr_Stock_Price:  100.84153410346278
curr_Factors:  [100.8415341]
mat_Sqrt:  [[0.15]]
grads:  [0.0428907]
Stock Position:  0.04289069593061646
Bond Position:  [10.3120508]


portfolio before change:  [14.62586798]
curr_Stock_Price:  100.51687788846586
curr_Factors:  [100.51687789]
mat_Sqrt:  [[0.15]]
grads:  [-0.05291739]
Stock Position:  -0.05291739120521006
Bond Position:  [19.94495893]


portfolio before change:  [14.59218035]
curr_Stock_Price:  101.24772437724552
curr_Factors:  [101.24772438]
mat_Sqrt:  [[0.15]]
grads:  [-0.05036287]
Stock Position:  -0.05036286936821755
Bond Position:  [19.69130627]


portfolio before change:  [14.63397987]
curr_Stock_Price:  100.51551676254141
curr_Factors:  [100.51551676]
mat_Sqrt:  [[0.15]]
grads:  [0.01683195]
Stock Position:  0.016831946230051683
Bond Position:  [12.9421081]


portfolio before change:  [14.60739176]
curr_Stock_Price:  98.74364526274893
curr_Factors:  [98.74364526]
mat_Sqrt:  [[0.15]]
grads:  [0.05637361]
Stock Position:  0.05637360533818414
Bond Position:  [9.04085647]


portfolio before change:  [14.60099948]
curr_Stock_Price:  98.59015549212832
curr_Factors:  [98.59015549]
mat_Sqrt:  [[0.15]]
grads:  [0.0643038]
Stock Position:  0.06430379751093027
Bond Position:  [8.26127809]


portfolio before change:  [14.68196152]
curr_Stock_Price:  99.81708870579672
curr_Factors:  [99.81708871]
mat_Sqrt:  [[0.15]]
grads:  [-0.08530966]
Stock Position:  -0.08530966132871678
Bond Position:  [23.19732356]


portfolio before change:  [14.80412678]
curr_Stock_Price:  98.45305557769372
curr_Factors:  [98.45305558]
mat_Sqrt:  [[0.15]]
grads:  [0.01323468]
Stock Position:  0.013234678615981234
Bond Position:  [13.50113223]


portfolio before change:  [14.81459244]
curr_Stock_Price:  98.9887653948988
curr_Factors:  [98.98876539]
mat_Sqrt:  [[0.15]]
grads:  [0.00106651]
Stock Position:  0.0010665093976065336
Bond Position:  [14.70901999]


portfolio before change:  [14.81810859]
curr_Stock_Price:  98.83727863222953
curr_Factors:  [98.83727863]
mat_Sqrt:  [[0.15]]
grads:  [-0.25354343]
Stock Position:  -0.25354343221727754
Bond Position:  [39.87765144]


portfolio before change:  [14.64627606]
curr_Stock_Price:  99.55432813590565
curr_Factors:  [99.55432814]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720601]
Stock Position:  -0.007206014440234738
Bond Position:  [15.36366598]


portfolio before change:  [14.64669625]
curr_Stock_Price:  100.02909862303103
curr_Factors:  [100.02909862]
mat_Sqrt:  [[0.15]]
grads:  [-0.16180913]
Stock Position:  -0.16180912763058744
Bond Position:  [30.83231744]


portfolio before change:  [14.44858249]
curr_Stock_Price:  101.30110844345965
curr_Factors:  [101.30110844]
mat_Sqrt:  [[0.15]]
grads:  [0.00012008]
Stock Position:  0.0001200789183635282
Bond Position:  [14.43641837]


portfolio before change:  [14.4521337]
curr_Stock_Price:  100.81522695068745
curr_Factors:  [100.81522695]
mat_Sqrt:  [[0.15]]
grads:  [-0.0436887]
Stock Position:  -0.0436887026354064
Bond Position:  [18.85662018]


portfolio before change:  [14.43503895]
curr_Stock_Price:  101.31442929682014
curr_Factors:  [101.3144293]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494471]
Stock Position:  -0.014944713042295468
Bond Position:  [15.94915402]


portfolio before change:  [14.44048899]
curr_Stock_Price:  101.21658465464368
curr_Factors:  [101.21658465]
mat_Sqrt:  [[0.15]]
grads:  [0.07107579]
Stock Position:  0.07107579289066501
Bond Position:  [7.24643999]


portfolio before change:  [14.58539751]
curr_Stock_Price:  103.22988162293038
curr_Factors:  [103.22988162]
mat_Sqrt:  [[0.15]]
grads:  [-0.29308927]
Stock Position:  -0.29308927040618393
Bond Position:  [44.8409682]


portfolio before change:  [14.37069417]
curr_Stock_Price:  104.000687653233
curr_Factors:  [104.00068765]
mat_Sqrt:  [[0.15]]
grads:  [-0.15658307]
Stock Position:  -0.1565830671920715
Bond Position:  [30.65544084]


portfolio before change:  [14.56631687]
curr_Stock_Price:  102.80031600491685
curr_Factors:  [102.800316]
mat_Sqrt:  [[0.15]]
grads:  [0.03094586]
Stock Position:  0.030945862504586884
Bond Position:  [11.38507242]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.56631687]
Stock Price:  103.53422926766667
PL:  [11.0320876]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.87139939e-02]
 [ 5.97601498e-03]
 [-1.75569478e-03]
 [ 3.57140300e-03]
 [ 8.49564189e-03]
 [ 2.66255944e-02]
 [-1.01441782e-02]
 [ 2.27234319e-03]
 [-2.64023091e-04]
 [-3.72235218e-02]
 [-9.71302844e-04]
 [-2.63607328e-02]
 [ 2.79045286e-03]
 [ 4.45940302e-03]
 [-1.96493098e-03]
 [ 1.18580587e-02]
 [ 4.89829334e-02]
 [ 1.97400146e-02]
 [ 2.75566894e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.16276421]
curr_Stock_Price:  99.80831033699602
curr_Factors:  [99.80831034]
mat_Sqrt:  [[0.15]]
grads:  [0.12475996]
Stock Position:  0.12475995944565083
Bond Position:  [-13.61484496]


portfolio before change:  [-1.22399094]
curr_Stock_Price:  99.34483952871255
curr_Factors:  [99.34483953]
mat_Sqrt:  [[0.15]]
grads:  [0.0398401]
Stock Position:  0.03984009988927351
Bond Position:  [-5.18189927]


portfolio before change:  [-1.21357031]
curr_Stock_Price:  99.63892180971887
curr_Factors:  [99.63892181]
mat_Sqrt:  [[0.15]]
grads:  [-0.01170463]
Stock Position:  -0.011704631839166327
Bond Position:  [-0.04733342]


portfolio before change:  [-1.20276634]
curr_Stock_Price:  98.71485963508333
curr_Factors:  [98.71485964]
mat_Sqrt:  [[0.15]]
grads:  [0.02380935]
Stock Position:  0.023809353357132648
Bond Position:  [-3.55310331]


portfolio before change:  [-1.2061654]
curr_Stock_Price:  98.60941054475538
curr_Factors:  [98.60941054]
mat_Sqrt:  [[0.15]]
grads:  [0.05663761]
Stock Position:  0.056637612580311865
Bond Position:  [-6.79116699]


portfolio before change:  [-1.28459756]
curr_Stock_Price:  97.25458374085815
curr_Factors:  [97.25458374]
mat_Sqrt:  [[0.15]]
grads:  [0.17750396]
Stock Position:  0.17750396298713075
Bond Position:  [-18.54767159]


portfolio before change:  [-1.28770818]
curr_Stock_Price:  97.26318569901778
curr_Factors:  [97.2631857]
mat_Sqrt:  [[0.15]]
grads:  [-0.06762785]
Stock Position:  -0.06762785433638625
Bond Position:  [5.28999238]


portfolio before change:  [-1.36100853]
curr_Stock_Price:  98.36662184584529
curr_Factors:  [98.36662185]
mat_Sqrt:  [[0.15]]
grads:  [0.01514895]
Stock Position:  0.01514895459756237
Bond Position:  [-2.85116002]


portfolio before change:  [-1.34530679]
curr_Stock_Price:  99.45016991138435
curr_Factors:  [99.45016991]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176015]
Stock Position:  -0.0017601539403786137
Bond Position:  [-1.17025918]


portfolio before change:  [-1.34332712]
curr_Stock_Price:  98.15922101262889
curr_Factors:  [98.15922101]
mat_Sqrt:  [[0.15]]
grads:  [-0.24815681]
Stock Position:  -0.24815681190947403
Bond Position:  [23.01555222]


portfolio before change:  [-1.15454018]
curr_Stock_Price:  97.42165376985486
curr_Factors:  [97.42165377]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647535]
Stock Position:  -0.006475352290828326
Bond Position:  [-0.52370065]


portfolio before change:  [-1.1475625]
curr_Stock_Price:  96.32385619597957
curr_Factors:  [96.3238562]
mat_Sqrt:  [[0.15]]
grads:  [-0.17573822]
Stock Position:  -0.17573821876381124
Bond Position:  [15.78022042]


portfolio before change:  [-1.28661187]
curr_Stock_Price:  97.13753763858273
curr_Factors:  [97.13753764]
mat_Sqrt:  [[0.15]]
grads:  [0.01860302]
Stock Position:  0.018603019071661224
Bond Position:  [-3.09366334]


portfolio before change:  [-1.2559189]
curr_Stock_Price:  98.82900954252352
curr_Factors:  [98.82900954]
mat_Sqrt:  [[0.15]]
grads:  [0.02972935]
Stock Position:  0.029729353454371946
Bond Position:  [-4.19404146]


portfolio before change:  [-1.29850071]
curr_Stock_Price:  97.43196719559697
curr_Factors:  [97.4319672]
mat_Sqrt:  [[0.15]]
grads:  [-0.01309954]
Stock Position:  -0.013099539841930385
Bond Position:  [-0.02218677]


portfolio before change:  [-1.29904745]
curr_Stock_Price:  97.47328120131934
curr_Factors:  [97.4732812]
mat_Sqrt:  [[0.15]]
grads:  [0.07905372]
Stock Position:  0.07905372460257121
Bond Position:  [-9.00467338]


portfolio before change:  [-1.33984935]
curr_Stock_Price:  96.98563245388239
curr_Factors:  [96.98563245]
mat_Sqrt:  [[0.15]]
grads:  [0.32655289]
Stock Position:  0.3265528892845705
Bond Position:  [-33.01078785]


portfolio before change:  [-1.6103558]
curr_Stock_Price:  96.18253830177963
curr_Factors:  [96.1825383]
mat_Sqrt:  [[0.15]]
grads:  [0.1316001]
Stock Position:  0.13160009742531958
Bond Position:  [-14.26798721]


portfolio before change:  [-1.6901549]
curr_Stock_Price:  95.60327077547178
curr_Factors:  [95.60327078]
mat_Sqrt:  [[0.15]]
grads:  [0.01837113]
Stock Position:  0.018371126238169052
Bond Position:  [-3.44649466]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.6901549]
Stock Price:  94.67742134534728
PL:  [-1.6901549]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.91500592e-02]
 [-7.96619347e-03]
 [ 6.34607377e-04]
 [ 3.75250295e-03]
 [ 8.73290219e-03]
 [ 1.35247855e-02]
 [-1.11046190e-02]
 [ 6.03257950e-03]
 [ 8.44083413e-03]
 [-3.73116389e-02]
 [ 3.70814696e-04]
 [-2.64279640e-02]
 [ 1.07963821e-03]
 [-1.09094343e-02]
 [ 3.15086501e-03]
 [-2.66203120e-03]
 [-8.75933384e-02]
 [ 5.33696377e-03]
 [-1.93682125e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [28.48323926]
curr_Stock_Price:  101.74698102585111
curr_Factors:  [101.74698103]
mat_Sqrt:  [[0.15]]
grads:  [-0.26100039]
Stock Position:  -0.2610003947976071
Bond Position:  [55.03924148]


portfolio before change:  [28.71703718]
curr_Stock_Price:  100.90393100026171
curr_Factors:  [100.903931]
mat_Sqrt:  [[0.15]]
grads:  [-0.05310796]
Stock Position:  -0.05310795646539578
Bond Position:  [34.07583875]


portfolio before change:  [28.80718527]
curr_Stock_Price:  99.36690965115078
curr_Factors:  [99.36690965]
mat_Sqrt:  [[0.15]]
grads:  [0.00423072]
Stock Position:  0.004230715844801119
Bond Position:  [28.38679211]


portfolio before change:  [28.81215006]
curr_Stock_Price:  98.86278987863452
curr_Factors:  [98.86278988]
mat_Sqrt:  [[0.15]]
grads:  [0.02501669]
Stock Position:  0.02501668634658759
Bond Position:  [26.33893066]


portfolio before change:  [28.78874503]
curr_Stock_Price:  97.66396628428318
curr_Factors:  [97.66396628]
mat_Sqrt:  [[0.15]]
grads:  [0.05821935]
Stock Position:  0.05821934795354856
Bond Position:  [23.10281259]


portfolio before change:  [28.82525469]
curr_Stock_Price:  98.1918533786193
curr_Factors:  [98.19185338]
mat_Sqrt:  [[0.15]]
grads:  [0.09016524]
Stock Position:  0.09016523686822991
Bond Position:  [19.97176297]


portfolio before change:  [28.77116653]
curr_Stock_Price:  97.53659273544805
curr_Factors:  [97.53659274]
mat_Sqrt:  [[0.15]]
grads:  [-0.07403079]
Stock Position:  -0.07403079334726406
Bond Position:  [35.99187787]


portfolio before change:  [28.83388177]
curr_Stock_Price:  96.81100071534395
curr_Factors:  [96.81100072]
mat_Sqrt:  [[0.15]]
grads:  [0.0402172]
Stock Position:  0.04021719663742754
Bond Position:  [24.94041472]


portfolio before change:  [28.76061114]
curr_Stock_Price:  94.83407222820217
curr_Factors:  [94.83407223]
mat_Sqrt:  [[0.15]]
grads:  [0.05627223]
Stock Position:  0.056272227514848734
Bond Position:  [23.42408665]


portfolio before change:  [28.73303002]
curr_Stock_Price:  94.23985606538068
curr_Factors:  [94.23985607]
mat_Sqrt:  [[0.15]]
grads:  [-0.24874426]
Stock Position:  -0.24874425937909123
Bond Position:  [52.17465322]


portfolio before change:  [28.9087789]
curr_Stock_Price:  93.58575621970218
curr_Factors:  [93.58575622]
mat_Sqrt:  [[0.15]]
grads:  [0.0024721]
Stock Position:  0.0024720979702938404
Bond Position:  [28.67742574]


portfolio before change:  [28.91045387]
curr_Stock_Price:  91.36283475139638
curr_Factors:  [91.36283475]
mat_Sqrt:  [[0.15]]
grads:  [-0.17618643]
Stock Position:  -0.1761864268685001
Bond Position:  [45.00734527]


portfolio before change:  [29.17452529]
curr_Stock_Price:  89.92788778061562
curr_Factors:  [89.92788778]
mat_Sqrt:  [[0.15]]
grads:  [0.00719759]
Stock Position:  0.007197588092565994
Bond Position:  [28.5272614]


portfolio before change:  [29.18245351]
curr_Stock_Price:  90.03841236490933
curr_Factors:  [90.03841236]
mat_Sqrt:  [[0.15]]
grads:  [-0.07272956]
Stock Position:  -0.07272956206045367
Bond Position:  [35.73090781]


portfolio before change:  [29.26568588]
curr_Stock_Price:  89.0168397710219
curr_Factors:  [89.01683977]
mat_Sqrt:  [[0.15]]
grads:  [0.02100577]
Stock Position:  0.02100576674863529
Bond Position:  [27.39581891]


portfolio before change:  [29.27806881]
curr_Stock_Price:  89.28024927493018
curr_Factors:  [89.28024927]
mat_Sqrt:  [[0.15]]
grads:  [-0.01774687]
Stock Position:  -0.017746874638936372
Bond Position:  [30.8625142]


portfolio before change:  [29.30308183]
curr_Stock_Price:  88.30563122488638
curr_Factors:  [88.30563122]
mat_Sqrt:  [[0.15]]
grads:  [-0.58395559]
Stock Position:  -0.5839555892534858
Bond Position:  [80.86964874]


portfolio before change:  [29.20597163]
curr_Stock_Price:  88.50655428064735
curr_Factors:  [88.50655428]
mat_Sqrt:  [[0.15]]
grads:  [0.03557976]
Stock Position:  0.035579758495321745
Bond Position:  [26.0569298]


portfolio before change:  [29.25968097]
curr_Stock_Price:  89.83299100458568
curr_Factors:  [89.832991]
mat_Sqrt:  [[0.15]]
grads:  [-0.01291214]
Stock Position:  -0.012912141699546055
Bond Position:  [30.41961728]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.25968097]
Stock Price:  90.74781359121843
PL:  [29.25968097]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.91354801e-02]
 [-8.00296454e-04]
 [-1.05094105e-02]
 [ 2.48494887e-03]
 [ 6.53394700e-03]
 [ 1.12709165e-02]
 [ 7.66369771e-05]
 [-1.69574639e-03]
 [ 1.16298258e-05]
 [-3.72239034e-02]
 [-1.04315105e-03]
 [-2.44744507e-02]
 [ 1.67646902e-03]
 [ 5.09297921e-03]
 [-2.27220192e-03]
 [ 1.19275452e-02]
 [ 4.80429112e-02]
 [ 2.09324933e-02]
 [ 3.17451603e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.06571843]
curr_Stock_Price:  99.81465654846794
curr_Factors:  [99.81465655]
mat_Sqrt:  [[0.15]]
grads:  [0.12756987]
Stock Position:  0.12756986707053886
Bond Position:  [-13.7990609]


portfolio before change:  [-1.06290471]
curr_Stock_Price:  99.86375836917512
curr_Factors:  [99.86375837]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533531]
Stock Position:  -0.005335309694321558
Bond Position:  [-0.53010063]


portfolio before change:  [-1.06675358]
curr_Stock_Price:  100.56031088193947
curr_Factors:  [100.56031088]
mat_Sqrt:  [[0.15]]
grads:  [-0.07006274]
Stock Position:  -0.07006273654406
Bond Position:  [5.97877699]


portfolio before change:  [-1.06706934]
curr_Stock_Price:  100.58615400550086
curr_Factors:  [100.58615401]
mat_Sqrt:  [[0.15]]
grads:  [0.01656633]
Stock Position:  0.01656632581799179
Bond Position:  [-2.73341234]


portfolio before change:  [-1.05638235]
curr_Stock_Price:  101.27251178121581
curr_Factors:  [101.27251178]
mat_Sqrt:  [[0.15]]
grads:  [0.04355965]
Stock Position:  0.04355964664335214
Bond Position:  [-5.46777718]


portfolio before change:  [-1.07569612]
curr_Stock_Price:  100.86050981853128
curr_Factors:  [100.86050982]
mat_Sqrt:  [[0.15]]
grads:  [0.07513944]
Stock Position:  0.07513944325486781
Bond Position:  [-8.65429868]


portfolio before change:  [-1.08612975]
curr_Stock_Price:  100.75045074118968
curr_Factors:  [100.75045074]
mat_Sqrt:  [[0.15]]
grads:  [0.00051091]
Stock Position:  0.0005109131803870844
Bond Position:  [-1.13760448]


portfolio before change:  [-1.08691306]
curr_Stock_Price:  99.77400372020894
curr_Factors:  [99.77400372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01130498]
Stock Position:  -0.011304975920813764
Bond Position:  [0.04102965]


portfolio before change:  [-1.07977089]
curr_Stock_Price:  99.14313877690302
curr_Factors:  [99.14313878]
mat_Sqrt:  [[0.15]]
grads:  [7.75321722e-05]
Stock Position:  7.753217220618474e-05
Bond Position:  [-1.08745767]


portfolio before change:  [-1.08012039]
curr_Stock_Price:  98.14224680323588
curr_Factors:  [98.1422468]
mat_Sqrt:  [[0.15]]
grads:  [-0.24815936]
Stock Position:  -0.248159356060502
Bond Position:  [23.27479638]


portfolio before change:  [-1.24242616]
curr_Stock_Price:  98.8197356595844
curr_Factors:  [98.81973566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695434]
Stock Position:  -0.006954340332724074
Bond Position:  [-0.55520009]


portfolio before change:  [-1.25027146]
curr_Stock_Price:  99.92788943082826
curr_Factors:  [99.92788943]
mat_Sqrt:  [[0.15]]
grads:  [-0.163163]
Stock Position:  -0.16316300453602867
Bond Position:  [15.05426322]


portfolio before change:  [-1.20691072]
curr_Stock_Price:  99.68520756439827
curr_Factors:  [99.68520756]
mat_Sqrt:  [[0.15]]
grads:  [0.01117646]
Stock Position:  0.011176460141587474
Bond Position:  [-2.32103847]


portfolio before change:  [-1.21985619]
curr_Stock_Price:  98.57885175697743
curr_Factors:  [98.57885176]
mat_Sqrt:  [[0.15]]
grads:  [0.03395319]
Stock Position:  0.033953194741697335
Bond Position:  [-4.56692314]


portfolio before change:  [-1.2368893]
curr_Stock_Price:  98.11081825243066
curr_Factors:  [98.11081825]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514801]
Stock Position:  -0.015148012830513702
Bond Position:  [0.24929463]


portfolio before change:  [-1.23531491]
curr_Stock_Price:  98.0109994743923
curr_Factors:  [98.01099947]
mat_Sqrt:  [[0.15]]
grads:  [0.07951697]
Stock Position:  0.07951696778539302
Bond Position:  [-9.0288524]


portfolio before change:  [-1.340464]
curr_Stock_Price:  96.71704180485838
curr_Factors:  [96.7170418]
mat_Sqrt:  [[0.15]]
grads:  [0.32028607]
Stock Position:  0.32028607491142236
Bond Position:  [-32.31758569]


portfolio before change:  [-1.25355052]
curr_Stock_Price:  97.01363255372966
curr_Factors:  [97.01363255]
mat_Sqrt:  [[0.15]]
grads:  [0.13954996]
Stock Position:  0.13954995544956325
Bond Position:  [-14.79179862]


portfolio before change:  [-1.38568961]
curr_Stock_Price:  96.09324043175829
curr_Factors:  [96.09324043]
mat_Sqrt:  [[0.15]]
grads:  [0.02116344]
Stock Position:  0.021163440171588443
Bond Position:  [-3.41935315]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.38568961]
Stock Price:  97.83072421516684
PL:  [-1.38568961]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.31288043e-02]
 [ 8.73813382e-03]
 [ 1.95122665e-02]
 [ 3.96406434e-03]
 [ 8.98754010e-03]
 [ 4.95031188e-02]
 [-5.36333662e-03]
 [ 6.43473232e-03]
 [ 6.44156133e-03]
 [-3.72901967e-02]
 [-5.21736660e-04]
 [-2.63801505e-02]
 [ 2.27390485e-03]
 [-6.57838356e-03]
 [ 3.33691025e-05]
 [ 9.33981971e-03]
 [ 4.67919172e-02]
 [ 2.08148486e-02]
 [ 4.15863316e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.24358774]
curr_Stock_Price:  98.62593300071251
curr_Factors:  [98.625933]
mat_Sqrt:  [[0.15]]
grads:  [0.55419203]
Stock Position:  0.5541920286820999
Bond Position:  [-73.90129363]


portfolio before change:  [-19.50957786]
curr_Stock_Price:  98.17931436043038
curr_Factors:  [98.17931436]
mat_Sqrt:  [[0.15]]
grads:  [0.05825423]
Stock Position:  0.05825422548345435
Bond Position:  [-25.22893778]


portfolio before change:  [-19.55619922]
curr_Stock_Price:  97.48729003989779
curr_Factors:  [97.48729004]
mat_Sqrt:  [[0.15]]
grads:  [0.13008178]
Stock Position:  0.13008177689363706
Bond Position:  [-32.23751914]


portfolio before change:  [-19.35252505]
curr_Stock_Price:  99.11499349543234
curr_Factors:  [99.1149935]
mat_Sqrt:  [[0.15]]
grads:  [0.0264271]
Stock Position:  0.026427095626447152
Bond Position:  [-21.97184646]


portfolio before change:  [-19.42738613]
curr_Stock_Price:  96.4901335099887
curr_Factors:  [96.49013351]
mat_Sqrt:  [[0.15]]
grads:  [0.05991693]
Stock Position:  0.05991693397170893
Bond Position:  [-25.20877909]


portfolio before change:  [-19.48497142]
curr_Stock_Price:  95.63424336616146
curr_Factors:  [95.63424337]
mat_Sqrt:  [[0.15]]
grads:  [0.33002079]
Stock Position:  0.3300207919158006
Bond Position:  [-51.04626015]


portfolio before change:  [-19.40929283]
curr_Stock_Price:  95.90223180667802
curr_Factors:  [95.90223181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575558]
Stock Position:  -0.03575557744460039
Bond Position:  [-15.98025315]


portfolio before change:  [-19.43440328]
curr_Stock_Price:  96.49276592016655
curr_Factors:  [96.49276592]
mat_Sqrt:  [[0.15]]
grads:  [0.04289822]
Stock Position:  0.04289821546012619
Bond Position:  [-23.57377074]


portfolio before change:  [-19.46882143]
curr_Stock_Price:  95.82784385959278
curr_Factors:  [95.82784386]
mat_Sqrt:  [[0.15]]
grads:  [0.04294374]
Stock Position:  0.04294374221390822
Bond Position:  [-23.58402765]


portfolio before change:  [-19.50195567]
curr_Stock_Price:  95.19358392048991
curr_Factors:  [95.19358392]
mat_Sqrt:  [[0.15]]
grads:  [-0.24860131]
Stock Position:  -0.24860131147229303
Bond Position:  [4.16329414]


portfolio before change:  [-19.52562201]
curr_Stock_Price:  95.2929691409111
curr_Factors:  [95.29296914]
mat_Sqrt:  [[0.15]]
grads:  [-0.00347824]
Stock Position:  -0.0034782443987548795
Bond Position:  [-19.19416977]


portfolio before change:  [-19.52902307]
curr_Stock_Price:  94.89101884634354
curr_Factors:  [94.89101885]
mat_Sqrt:  [[0.15]]
grads:  [-0.17586767]
Stock Position:  -0.17586766978916588
Bond Position:  [-2.8407607]


portfolio before change:  [-19.53901529]
curr_Stock_Price:  94.94379684732316
curr_Factors:  [94.94379685]
mat_Sqrt:  [[0.15]]
grads:  [0.01515937]
Stock Position:  0.015159365679829005
Bond Position:  [-20.97830303]


portfolio before change:  [-19.57537287]
curr_Stock_Price:  92.89144571427508
curr_Factors:  [92.89144571]
mat_Sqrt:  [[0.15]]
grads:  [-0.04385589]
Stock Position:  -0.04385589040505796
Bond Position:  [-15.5015358]


portfolio before change:  [-19.63227611]
curr_Stock_Price:  94.10057341834049
curr_Factors:  [94.10057342]
mat_Sqrt:  [[0.15]]
grads:  [0.00022246]
Stock Position:  0.00022246068300342488
Bond Position:  [-19.65320978]


portfolio before change:  [-19.6368325]
curr_Stock_Price:  95.70768028107774
curr_Factors:  [95.70768028]
mat_Sqrt:  [[0.15]]
grads:  [0.06226546]
Stock Position:  0.06226546471008801
Bond Position:  [-25.59611569]


portfolio before change:  [-19.60420342]
curr_Stock_Price:  96.334495026193
curr_Factors:  [96.33449503]
mat_Sqrt:  [[0.15]]
grads:  [0.31194611]
Stock Position:  0.3119461146840864
Bond Position:  [-49.65537486]


portfolio before change:  [-19.485331]
curr_Stock_Price:  96.75536198974451
curr_Factors:  [96.75536199]
mat_Sqrt:  [[0.15]]
grads:  [0.13876566]
Stock Position:  0.13876565750388245
Bond Position:  [-32.91165243]


portfolio before change:  [-19.3731164]
curr_Stock_Price:  97.62332560024325
curr_Factors:  [97.6233256]
mat_Sqrt:  [[0.15]]
grads:  [0.02772422]
Stock Position:  0.027724221094044783
Bond Position:  [-22.07964707]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.3731164]
Stock Price:  98.68232943317274
PL:  [-19.3731164]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.44915112e-02]
 [ 4.89247172e-03]
 [ 2.70421353e-02]
 [ 1.75741241e-03]
 [ 8.93443277e-03]
 [ 5.04685386e-02]
 [-2.07150287e-03]
 [ 9.27743409e-03]
 [ 9.01703673e-03]
 [-3.72816350e-02]
 [-6.26128346e-04]
 [-2.63998594e-02]
 [ 1.88248704e-03]
 [-5.82180785e-03]
 [ 8.86056750e-06]
 [ 5.94670776e-03]
 [-1.59308107e-03]
 [ 1.29857385e-02]
 [-5.75869629e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.11845372]
curr_Stock_Price:  99.89209429951117
curr_Factors:  [99.8920943]
mat_Sqrt:  [[0.15]]
grads:  [0.16327674]
Stock Position:  0.1632767410318486
Bond Position:  [-16.19160189]


portfolio before change:  [0.05524834]
curr_Stock_Price:  99.52978321407628
curr_Factors:  [99.52978321]
mat_Sqrt:  [[0.15]]
grads:  [0.03261648]
Stock Position:  0.03261647816623612
Bond Position:  [-3.19106266]


portfolio before change:  [-0.02641527]
curr_Stock_Price:  97.05049197198402
curr_Factors:  [97.05049197]
mat_Sqrt:  [[0.15]]
grads:  [0.1802809]
Stock Position:  0.18028090216764578
Bond Position:  [-17.52276552]


portfolio before change:  [0.10184617]
curr_Stock_Price:  97.78624754412331
curr_Factors:  [97.78624754]
mat_Sqrt:  [[0.15]]
grads:  [0.01171608]
Stock Position:  0.01171608275173193
Bond Position:  [-1.0438256]


portfolio before change:  [0.08926807]
curr_Stock_Price:  96.73494827670702
curr_Factors:  [96.73494828]
mat_Sqrt:  [[0.15]]
grads:  [0.05956289]
Stock Position:  0.05956288513773427
Bond Position:  [-5.67254454]


portfolio before change:  [0.01821583]
curr_Stock_Price:  95.56586583522756
curr_Factors:  [95.56586584]
mat_Sqrt:  [[0.15]]
grads:  [0.33645692]
Stock Position:  0.33645692370074387
Bond Position:  [-32.1355814]


portfolio before change:  [-0.19193367]
curr_Stock_Price:  94.96515118655395
curr_Factors:  [94.96515119]
mat_Sqrt:  [[0.15]]
grads:  [-0.01381002]
Stock Position:  -0.013810019139775382
Bond Position:  [1.11953688]


portfolio before change:  [-0.17899519]
curr_Stock_Price:  94.04852994440695
curr_Factors:  [94.04852994]
mat_Sqrt:  [[0.15]]
grads:  [0.06184956]
Stock Position:  0.061849560626489844
Bond Position:  [-5.99585545]


portfolio before change:  [-0.1496233]
curr_Stock_Price:  94.54766118694879
curr_Factors:  [94.54766119]
mat_Sqrt:  [[0.15]]
grads:  [0.06011358]
Stock Position:  0.06011357821634871
Bond Position:  [-5.83322152]


portfolio before change:  [-0.08936088]
curr_Stock_Price:  95.57439937794344
curr_Factors:  [95.57439938]
mat_Sqrt:  [[0.15]]
grads:  [-0.24854423]
Stock Position:  -0.24854423358342922
Bond Position:  [23.66510496]


portfolio before change:  [-0.05661601]
curr_Stock_Price:  95.46645941014764
curr_Factors:  [95.46645941]
mat_Sqrt:  [[0.15]]
grads:  [-0.00417419]
Stock Position:  -0.0041741889716099875
Bond Position:  [0.34187904]


portfolio before change:  [-0.04805786]
curr_Stock_Price:  93.4366847564781
curr_Factors:  [93.43668476]
mat_Sqrt:  [[0.15]]
grads:  [-0.17599906]
Stock Position:  -0.17599906295754544
Bond Position:  [16.3967111]


portfolio before change:  [-0.01987461]
curr_Stock_Price:  93.29984559661325
curr_Factors:  [93.2998456]
mat_Sqrt:  [[0.15]]
grads:  [0.01254991]
Stock Position:  0.012549913624700903
Bond Position:  [-1.19077961]


portfolio before change:  [-0.01904302]
curr_Stock_Price:  93.38983186728524
curr_Factors:  [93.38983187]
mat_Sqrt:  [[0.15]]
grads:  [-0.03881205]
Stock Position:  -0.03881205236411443
Bond Position:  [3.60560802]


portfolio before change:  [-0.04725153]
curr_Stock_Price:  94.1398572132776
curr_Factors:  [94.13985721]
mat_Sqrt:  [[0.15]]
grads:  [5.907045e-05]
Stock Position:  5.9070449979815604e-05
Bond Position:  [-0.05281241]


portfolio before change:  [-0.04727946]
curr_Stock_Price:  93.89054447940929
curr_Factors:  [93.89054448]
mat_Sqrt:  [[0.15]]
grads:  [0.03964472]
Stock Position:  0.039644718370330345
Bond Position:  [-3.76954365]


portfolio before change:  [-0.07603759]
curr_Stock_Price:  93.18892198528218
curr_Factors:  [93.18892199]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062054]
Stock Position:  -0.010620540434521005
Bond Position:  [0.91367912]


portfolio before change:  [-0.0693729]
curr_Stock_Price:  92.58290401015368
curr_Factors:  [92.58290401]
mat_Sqrt:  [[0.15]]
grads:  [0.08657159]
Stock Position:  0.08657158984187382
Bond Position:  [-8.0844221]


portfolio before change:  [-0.14762382]
curr_Stock_Price:  91.7023662196774
curr_Factors:  [91.70236622]
mat_Sqrt:  [[0.15]]
grads:  [-0.00383913]
Stock Position:  -0.0038391308628392003
Bond Position:  [0.20443357]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.14762382]
Stock Price:  90.2392006254093
PL:  [-0.14762382]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.91012882e-02]
 [-7.32146001e-03]
 [ 2.86957725e-02]
 [-3.45842453e-03]
 [ 5.20086209e-03]
 [-4.33703234e-02]
 [-1.29605743e-02]
 [ 1.19603200e-03]
 [ 3.98893274e-03]
 [ 6.90270278e-02]
 [-1.17393137e-02]
 [-1.90755568e-02]
 [-1.90440454e-03]
 [-2.21097348e-02]
 [ 3.54496685e-03]
 [ 8.40865003e-03]
 [-4.40283091e-02]
 [-2.68857051e-02]
 [ 4.57686171e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.86905115]
curr_Stock_Price:  102.49154478486216
curr_Factors:  [102.49154478]
mat_Sqrt:  [[0.15]]
grads:  [-0.26067525]
Stock Position:  -0.2606752549528053
Bond Position:  [66.58606072]


portfolio before change:  [40.0197182]
curr_Stock_Price:  101.97742443389998
curr_Factors:  [101.97742443]
mat_Sqrt:  [[0.15]]
grads:  [-0.04880973]
Stock Position:  -0.048809733433265924
Bond Position:  [44.9972091]


portfolio before change:  [39.95512453]
curr_Stock_Price:  103.53130259783569
curr_Factors:  [103.5313026]
mat_Sqrt:  [[0.15]]
grads:  [0.19130515]
Stock Position:  0.19130514985457922
Bond Position:  [20.14905317]


portfolio before change:  [39.95467439]
curr_Stock_Price:  103.50261530157778
curr_Factors:  [103.5026153]
mat_Sqrt:  [[0.15]]
grads:  [-0.02305616]
Stock Position:  -0.02305616350396479
Bond Position:  [42.34104761]


portfolio before change:  [39.96130964]
curr_Stock_Price:  103.67399402721168
curr_Factors:  [103.67399403]
mat_Sqrt:  [[0.15]]
grads:  [0.03467241]
Stock Position:  0.03467241393792362
Bond Position:  [36.36668201]


portfolio before change:  [40.0113377]
curr_Stock_Price:  104.85462278501038
curr_Factors:  [104.85462279]
mat_Sqrt:  [[0.15]]
grads:  [-0.28913549]
Stock Position:  -0.289135489613327
Bond Position:  [70.3285304]


portfolio before change:  [39.90015301]
curr_Stock_Price:  105.29998151391402
curr_Factors:  [105.29998151]
mat_Sqrt:  [[0.15]]
grads:  [-0.08640383]
Stock Position:  -0.08640382858630463
Bond Position:  [48.99847457]


portfolio before change:  [39.97681813]
curr_Stock_Price:  104.55448249485407
curr_Factors:  [104.55448249]
mat_Sqrt:  [[0.15]]
grads:  [0.00797355]
Stock Position:  0.007973546655481771
Bond Position:  [39.14314809]


portfolio before change:  [39.99348674]
curr_Stock_Price:  105.41753617291397
curr_Factors:  [105.41753617]
mat_Sqrt:  [[0.15]]
grads:  [0.02659288]
Stock Position:  0.026592884902828084
Bond Position:  [37.19013034]


portfolio before change:  [40.0043718]
curr_Stock_Price:  105.4771899945629
curr_Factors:  [105.47718999]
mat_Sqrt:  [[0.15]]
grads:  [0.46018019]
Stock Position:  0.46018018553720924
Bond Position:  [-8.53414106]


portfolio before change:  [39.2725076]
curr_Stock_Price:  103.89144070411889
curr_Factors:  [103.8914407]
mat_Sqrt:  [[0.15]]
grads:  [-0.07826209]
Stock Position:  -0.07826209152787036
Bond Position:  [47.40326904]


portfolio before change:  [39.19837095]
curr_Stock_Price:  104.99017122402563
curr_Factors:  [104.99017122]
mat_Sqrt:  [[0.15]]
grads:  [-0.12717038]
Stock Position:  -0.12717037890979754
Bond Position:  [52.55001081]


portfolio before change:  [39.17288658]
curr_Stock_Price:  105.2938859699407
curr_Factors:  [105.29388597]
mat_Sqrt:  [[0.15]]
grads:  [-0.01269603]
Stock Position:  -0.012696030284533553
Bond Position:  [40.50970094]


portfolio before change:  [39.18730978]
curr_Stock_Price:  104.95562978724094
curr_Factors:  [104.95562979]
mat_Sqrt:  [[0.15]]
grads:  [-0.14739823]
Stock Position:  -0.14739823213911027
Bond Position:  [54.65758406]


portfolio before change:  [39.42200776]
curr_Stock_Price:  103.45607397738347
curr_Factors:  [103.45607398]
mat_Sqrt:  [[0.15]]
grads:  [0.02363311]
Stock Position:  0.023633112362407532
Bond Position:  [36.97701874]


portfolio before change:  [39.43178422]
curr_Stock_Price:  103.47854466858793
curr_Factors:  [103.47854467]
mat_Sqrt:  [[0.15]]
grads:  [0.05605767]
Stock Position:  0.056057666890889264
Bond Position:  [33.63101843]


portfolio before change:  [39.44251516]
curr_Stock_Price:  103.51996867548678
curr_Factors:  [103.51996868]
mat_Sqrt:  [[0.15]]
grads:  [-0.29352206]
Stock Position:  -0.2935220608739436
Bond Position:  [69.82790971]


portfolio before change:  [39.73575221]
curr_Stock_Price:  102.58042125336563
curr_Factors:  [102.58042125]
mat_Sqrt:  [[0.15]]
grads:  [-0.17923803]
Stock Position:  -0.17923803368930394
Bond Position:  [58.12206522]


portfolio before change:  [39.77771349]
curr_Stock_Price:  102.42739042288255
curr_Factors:  [102.42739042]
mat_Sqrt:  [[0.15]]
grads:  [0.03051241]
Stock Position:  0.03051241142820633
Bond Position:  [36.65240681]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.77771349]
Stock Price:  101.47426788670231
PL:  [38.30344561]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.98953196e-02]
 [-7.77291345e-03]
 [-1.04700440e-02]
 [ 2.38998155e-03]
 [ 6.00173418e-03]
 [ 8.39055763e-03]
 [-5.46940378e-04]
 [-2.21796030e-03]
 [-1.31445963e-03]
 [ 1.53585367e-02]
 [-6.60346268e-03]
 [-2.16907681e-02]
 [-1.11347316e-03]
 [-1.93918501e-02]
 [ 5.64695896e-03]
 [ 7.49070100e-03]
 [-4.97604808e-02]
 [-1.96989415e-02]
 [ 4.49743558e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.79530319]
curr_Stock_Price:  101.37502414617907
curr_Factors:  [101.37502415]
mat_Sqrt:  [[0.15]]
grads:  [-0.2659688]
Stock Position:  -0.26596879747128
Bond Position:  [49.75789645]


portfolio before change:  [22.81081002]
curr_Stock_Price:  101.36349722211959
curr_Factors:  [101.36349722]
mat_Sqrt:  [[0.15]]
grads:  [-0.05181942]
Stock Position:  -0.05181942298415416
Bond Position:  [28.06340795]


portfolio before change:  [22.85742972]
curr_Stock_Price:  100.59924753715207
curr_Factors:  [100.59924754]
mat_Sqrt:  [[0.15]]
grads:  [-0.06980029]
Stock Position:  -0.06980029337025713
Bond Position:  [29.87928671]


portfolio before change:  [22.82070048]
curr_Stock_Price:  101.23248273420099
curr_Factors:  [101.23248273]
mat_Sqrt:  [[0.15]]
grads:  [0.01593321]
Stock Position:  0.015933210357657563
Bond Position:  [21.20774203]


portfolio before change:  [22.83995396]
curr_Stock_Price:  102.10806803730017
curr_Factors:  [102.10806804]
mat_Sqrt:  [[0.15]]
grads:  [0.04001156]
Stock Position:  0.04001156121581493
Bond Position:  [18.75445074]


portfolio before change:  [22.81298367]
curr_Stock_Price:  101.31680941110608
curr_Factors:  [101.31680941]
mat_Sqrt:  [[0.15]]
grads:  [0.05593705]
Stock Position:  0.05593705084957802
Bond Position:  [17.14562015]


portfolio before change:  [22.86221287]
curr_Stock_Price:  102.1202530577801
curr_Factors:  [102.12025306]
mat_Sqrt:  [[0.15]]
grads:  [-0.00364627]
Stock Position:  -0.0036462691877203286
Bond Position:  [23.23457081]


portfolio before change:  [22.87343355]
curr_Stock_Price:  100.63618559930644
curr_Factors:  [100.6361856]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147864]
Stock Position:  -0.014786401993970529
Bond Position:  [24.36148065]


portfolio before change:  [22.87628922]
curr_Stock_Price:  100.85499899223716
curr_Factors:  [100.85499899]
mat_Sqrt:  [[0.15]]
grads:  [-0.00876306]
Stock Position:  -0.008763064183012146
Bond Position:  [23.76008805]


portfolio before change:  [22.87667936]
curr_Stock_Price:  101.48841082772515
curr_Factors:  [101.48841083]
mat_Sqrt:  [[0.15]]
grads:  [0.10239024]
Stock Position:  0.10239024473564991
Bond Position:  [12.48525614]


portfolio before change:  [22.89734257]
curr_Stock_Price:  101.65973093655697
curr_Factors:  [101.65973094]
mat_Sqrt:  [[0.15]]
grads:  [-0.04402308]
Stock Position:  -0.04402308451602329
Bond Position:  [27.3727175]


portfolio before change:  [22.8835523]
curr_Stock_Price:  102.12844645494248
curr_Factors:  [102.12844645]
mat_Sqrt:  [[0.15]]
grads:  [-0.14460512]
Stock Position:  -0.1446051206518535
Bond Position:  [37.65184862]


portfolio before change:  [22.66504146]
curr_Stock_Price:  103.70463529806534
curr_Factors:  [103.7046353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00742315]
Stock Position:  -0.007423154392827893
Bond Position:  [23.43485698]


portfolio before change:  [22.67793475]
curr_Stock_Price:  102.75708153631717
curr_Factors:  [102.75708154]
mat_Sqrt:  [[0.15]]
grads:  [-0.129279]
Stock Position:  -0.12927900080714266
Bond Position:  [35.96226757]


portfolio before change:  [22.52022764]
curr_Stock_Price:  104.046531473515
curr_Factors:  [104.04653147]
mat_Sqrt:  [[0.15]]
grads:  [0.03764639]
Stock Position:  0.03764639307478077
Bond Position:  [18.60325102]


portfolio before change:  [22.56109244]
curr_Stock_Price:  105.00846721628405
curr_Factors:  [105.00846722]
mat_Sqrt:  [[0.15]]
grads:  [0.04993801]
Stock Position:  0.04993800664612335
Bond Position:  [17.31717891]


portfolio before change:  [22.54789878]
curr_Stock_Price:  104.65756223368918
curr_Factors:  [104.65756223]
mat_Sqrt:  [[0.15]]
grads:  [-0.33173654]
Stock Position:  -0.33173653865623454
Bond Position:  [57.26663622]


portfolio before change:  [22.5083278]
curr_Stock_Price:  104.82000872215082
curr_Factors:  [104.82000872]
mat_Sqrt:  [[0.15]]
grads:  [-0.13132628]
Stock Position:  -0.13132627633972532
Bond Position:  [36.27394923]


portfolio before change:  [22.51771171]
curr_Stock_Price:  104.81761547956637
curr_Factors:  [104.81761548]
mat_Sqrt:  [[0.15]]
grads:  [0.0299829]
Stock Position:  0.0299829038748831
Bond Position:  [19.37497522]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.51771171]
Stock Price:  104.60455467577304
PL:  [17.91315704]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.17204960e-02]
 [ 6.93882309e-03]
 [ 4.30648434e-03]
 [ 3.71555743e-03]
 [ 8.76913119e-03]
 [ 3.75018432e-02]
 [-6.77352504e-03]
 [ 8.96578658e-03]
 [ 9.30382553e-03]
 [-3.73425612e-02]
 [ 1.42384288e-03]
 [-2.64134376e-02]
 [ 1.98961895e-03]
 [-7.93099286e-03]
 [ 1.31934064e-03]
 [ 2.68058523e-03]
 [-3.48573741e-02]
 [ 7.73095727e-03]
 [-1.92094141e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.47052713]
curr_Stock_Price:  99.85357848712503
curr_Factors:  [99.85357849]
mat_Sqrt:  [[0.15]]
grads:  [0.14480331]
Stock Position:  0.14480330668910607
Bond Position:  [-14.92965548]


portfolio before change:  [-0.60272933]
curr_Stock_Price:  98.96637965395436
curr_Factors:  [98.96637965]
mat_Sqrt:  [[0.15]]
grads:  [0.04625882]
Stock Position:  0.04625882062483366
Bond Position:  [-5.18079734]


portfolio before change:  [-0.60314002]
curr_Stock_Price:  98.9855041783659
curr_Factors:  [98.98550418]
mat_Sqrt:  [[0.15]]
grads:  [0.0287099]
Stock Position:  0.02870989562287841
Bond Position:  [-3.44500351]


portfolio before change:  [-0.60839092]
curr_Stock_Price:  98.83261118345214
curr_Factors:  [98.83261118]
mat_Sqrt:  [[0.15]]
grads:  [0.02477038]
Stock Position:  0.024770382863285482
Bond Position:  [-3.05651253]


portfolio before change:  [-0.64223979]
curr_Stock_Price:  97.49695744498602
curr_Factors:  [97.49695744]
mat_Sqrt:  [[0.15]]
grads:  [0.05846087]
Stock Position:  0.058460874580431546
Bond Position:  [-6.3419972]


portfolio before change:  [-0.70302899]
curr_Stock_Price:  96.48425454157615
curr_Factors:  [96.48425454]
mat_Sqrt:  [[0.15]]
grads:  [0.25001229]
Stock Position:  0.25001228811458853
Bond Position:  [-24.82527823]


portfolio before change:  [-0.75438501]
curr_Stock_Price:  96.30366770539787
curr_Factors:  [96.30366771]
mat_Sqrt:  [[0.15]]
grads:  [-0.04515683]
Stock Position:  -0.04515683357114304
Bond Position:  [3.59438368]


portfolio before change:  [-0.66394108]
curr_Stock_Price:  94.32068483594153
curr_Factors:  [94.32068484]
mat_Sqrt:  [[0.15]]
grads:  [0.05977191]
Stock Position:  0.0597719105361499
Bond Position:  [-6.30166861]


portfolio before change:  [-0.66047055]
curr_Stock_Price:  94.40510806629143
curr_Factors:  [94.40510807]
mat_Sqrt:  [[0.15]]
grads:  [0.0620255]
Stock Position:  0.06202550356546144
Bond Position:  [-6.51599492]


portfolio before change:  [-0.75765896]
curr_Stock_Price:  92.86446429275428
curr_Factors:  [92.86446429]
mat_Sqrt:  [[0.15]]
grads:  [-0.24895041]
Stock Position:  -0.24895040767797066
Bond Position:  [22.36098728]


portfolio before change:  [-0.55467513]
curr_Stock_Price:  92.0715638455075
curr_Factors:  [92.07156385]
mat_Sqrt:  [[0.15]]
grads:  [0.00949229]
Stock Position:  0.009492285850980973
Bond Position:  [-1.42864473]


portfolio before change:  [-0.55158492]
curr_Stock_Price:  92.43474377414773
curr_Factors:  [92.43474377]
mat_Sqrt:  [[0.15]]
grads:  [-0.17608958]
Stock Position:  -0.17608958424912152
Bond Position:  [15.72521068]


portfolio before change:  [-0.77922059]
curr_Stock_Price:  93.74979862064541
curr_Factors:  [93.74979862]
mat_Sqrt:  [[0.15]]
grads:  [0.01326413]
Stock Position:  0.013264126313650685
Bond Position:  [-2.02272976]


portfolio before change:  [-0.8029302]
curr_Stock_Price:  92.00042880542306
curr_Factors:  [92.00042881]
mat_Sqrt:  [[0.15]]
grads:  [-0.05287329]
Stock Position:  -0.052873285757733396
Bond Position:  [4.06143476]


portfolio before change:  [-0.80397201]
curr_Stock_Price:  92.0393387377579
curr_Factors:  [92.03933874]
mat_Sqrt:  [[0.15]]
grads:  [0.0087956]
Stock Position:  0.008795604273533777
Bond Position:  [-1.61351361]


portfolio before change:  [-0.80347761]
curr_Stock_Price:  92.14141617082903
curr_Factors:  [92.14141617]
mat_Sqrt:  [[0.15]]
grads:  [0.01787057]
Stock Position:  0.01787056822274393
Bond Position:  [-2.45009707]


portfolio before change:  [-0.81912501]
curr_Stock_Price:  91.30009955824765
curr_Factors:  [91.30009956]
mat_Sqrt:  [[0.15]]
grads:  [-0.23238249]
Stock Position:  -0.23238249391001453
Bond Position:  [20.39741982]


portfolio before change:  [-0.4613412]
curr_Stock_Price:  89.78241285044021
curr_Factors:  [89.78241285]
mat_Sqrt:  [[0.15]]
grads:  [0.05153972]
Stock Position:  0.05153971515507799
Bond Position:  [-5.08870118]


portfolio before change:  [-0.4587463]
curr_Stock_Price:  89.85744691542155
curr_Factors:  [89.85744692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01280628]
Stock Position:  -0.0128062760364165
Bond Position:  [0.69199297]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.4587463]
Stock Price:  89.11779912549498
PL:  [-0.4587463]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.60337490e-02]
 [-1.09072653e-03]
 [-2.57918178e-03]
 [ 2.44267655e-03]
 [ 6.72450315e-03]
 [-2.50700423e-02]
 [-1.02078602e-02]
 [ 1.46544640e-03]
 [ 5.43095352e-03]
 [ 8.51263508e-02]
 [-1.75426213e-02]
 [-1.78219155e-02]
 [-1.69070693e-03]
 [-2.30940119e-02]
 [ 1.23704352e-02]
 [ 7.04872206e-03]
 [-4.33401324e-02]
 [-2.41605268e-02]
 [ 4.65682660e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.83398873]
curr_Stock_Price:  101.31215995084095
curr_Factors:  [101.31215995]
mat_Sqrt:  [[0.15]]
grads:  [-0.24022499]
Stock Position:  -0.24022499328914038
Bond Position:  [46.17170168]


portfolio before change:  [22.18793312]
curr_Stock_Price:  99.88682939367975
curr_Factors:  [99.88682939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727151]
Stock Position:  -0.007271510224660465
Bond Position:  [22.91426123]


portfolio before change:  [22.18138706]
curr_Stock_Price:  101.5749714455125
curr_Factors:  [101.57497145]
mat_Sqrt:  [[0.15]]
grads:  [-0.01719455]
Stock Position:  -0.017194545171616966
Bond Position:  [23.9279225]


portfolio before change:  [22.1927285]
curr_Stock_Price:  101.26331998402593
curr_Factors:  [101.26331998]
mat_Sqrt:  [[0.15]]
grads:  [0.01628451]
Stock Position:  0.01628451030806998
Bond Position:  [20.54370492]


portfolio before change:  [22.19406627]
curr_Stock_Price:  101.03004353118102
curr_Factors:  [101.03004353]
mat_Sqrt:  [[0.15]]
grads:  [0.04483002]
Stock Position:  0.044830020968536104
Bond Position:  [17.6648873]


portfolio before change:  [22.31870414]
curr_Stock_Price:  103.71175309916786
curr_Factors:  [103.7117531]
mat_Sqrt:  [[0.15]]
grads:  [-0.16713362]
Stock Position:  -0.1671336153024074
Bond Position:  [39.65242439]


portfolio before change:  [22.18188498]
curr_Stock_Price:  104.5896944044998
curr_Factors:  [104.5896944]
mat_Sqrt:  [[0.15]]
grads:  [-0.0680524]
Stock Position:  -0.068052401465678
Bond Position:  [29.29946486]


portfolio before change:  [22.13493637]
curr_Stock_Price:  105.38723273022357
curr_Factors:  [105.38723273]
mat_Sqrt:  [[0.15]]
grads:  [0.00976964]
Stock Position:  0.00976964267995353
Bond Position:  [21.10534076]


portfolio before change:  [22.14965032]
curr_Stock_Price:  106.3531799823928
curr_Factors:  [106.35317998]
mat_Sqrt:  [[0.15]]
grads:  [0.03620636]
Stock Position:  0.03620635679175292
Bond Position:  [18.29898914]


portfolio before change:  [22.17639452]
curr_Stock_Price:  106.96547245204644
curr_Factors:  [106.96547245]
mat_Sqrt:  [[0.15]]
grads:  [0.56750901]
Stock Position:  0.5675090056500658
Bond Position:  [-38.52747439]


portfolio before change:  [22.99998363]
curr_Stock_Price:  108.43368207836711
curr_Factors:  [108.43368208]
mat_Sqrt:  [[0.15]]
grads:  [-0.11695081]
Stock Position:  -0.11695080887575741
Bond Position:  [35.68139046]


portfolio before change:  [23.23585818]
curr_Stock_Price:  106.49309620107626
curr_Factors:  [106.4930962]
mat_Sqrt:  [[0.15]]
grads:  [-0.11881277]
Stock Position:  -0.11881277013772831
Bond Position:  [35.88859794]


portfolio before change:  [23.43347714]
curr_Stock_Price:  104.90534023663348
curr_Factors:  [104.90534024]
mat_Sqrt:  [[0.15]]
grads:  [-0.01127138]
Stock Position:  -0.011271379541827988
Bond Position:  [24.61590505]


portfolio before change:  [23.43166283]
curr_Stock_Price:  105.61235664179524
curr_Factors:  [105.61235664]
mat_Sqrt:  [[0.15]]
grads:  [-0.15396008]
Stock Position:  -0.15396007944345158
Bond Position:  [39.69174965]


portfolio before change:  [23.38433134]
curr_Stock_Price:  105.98424312233244
curr_Factors:  [105.98424312]
mat_Sqrt:  [[0.15]]
grads:  [0.08246957]
Stock Position:  0.08246956809818022
Bond Position:  [14.64385658]


portfolio before change:  [23.35442903]
curr_Stock_Price:  105.57725989545827
curr_Factors:  [105.5772599]
mat_Sqrt:  [[0.15]]
grads:  [0.04699148]
Stock Position:  0.04699148040024535
Bond Position:  [18.39319729]


portfolio before change:  [23.25594351]
curr_Stock_Price:  103.38357717744636
curr_Factors:  [103.38357718]
mat_Sqrt:  [[0.15]]
grads:  [-0.28893422]
Stock Position:  -0.28893421630495464
Bond Position:  [53.12699636]


portfolio before change:  [23.13768058]
curr_Stock_Price:  103.83885843101905
curr_Factors:  [103.83885843]
mat_Sqrt:  [[0.15]]
grads:  [-0.16107018]
Stock Position:  -0.1610701784708551
Bond Position:  [39.86302404]


portfolio before change:  [23.18743628]
curr_Stock_Price:  103.59183137059624
curr_Factors:  [103.59183137]
mat_Sqrt:  [[0.15]]
grads:  [0.03104551]
Stock Position:  0.031045510636549836
Bond Position:  [19.97137498]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.18743628]
Stock Price:  104.79939771132383
PL:  [18.38803857]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.88729575e-02]
 [ 7.02592163e-03]
 [-3.28311109e-03]
 [ 2.31386743e-03]
 [ 6.84485595e-03]
 [ 9.06803679e-03]
 [-6.95062655e-03]
 [-4.02241398e-04]
 [-7.22347186e-05]
 [-3.72225212e-02]
 [-9.34962898e-04]
 [-2.63508473e-02]
 [ 2.48211260e-03]
 [-2.92283107e-03]
 [ 2.27877803e-04]
 [ 6.30443947e-03]
 [ 2.81626992e-02]
 [ 1.57522480e-02]
 [ 8.97602324e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.28119895]
curr_Stock_Price:  100.03352485625874
curr_Factors:  [100.03352486]
mat_Sqrt:  [[0.15]]
grads:  [0.19248638]
Stock Position:  0.19248638328032758
Bond Position:  [-16.97389246]


portfolio before change:  [2.06363048]
curr_Stock_Price:  98.92526741316576
curr_Factors:  [98.92526741]
mat_Sqrt:  [[0.15]]
grads:  [0.04683948]
Stock Position:  0.04683947753569815
Bond Position:  [-2.56997736]


portfolio before change:  [2.10567117]
curr_Stock_Price:  99.83653436116201
curr_Factors:  [99.83653436]
mat_Sqrt:  [[0.15]]
grads:  [-0.02188741]
Stock Position:  -0.021887407286133153
Bond Position:  [4.29083406]


portfolio before change:  [2.07855806]
curr_Stock_Price:  101.12430465572962
curr_Factors:  [101.12430466]
mat_Sqrt:  [[0.15]]
grads:  [0.01542578]
Stock Position:  0.015425782838612585
Bond Position:  [0.5186365]


portfolio before change:  [2.07485607]
curr_Stock_Price:  100.87591111889783
curr_Factors:  [100.87591112]
mat_Sqrt:  [[0.15]]
grads:  [0.04563237]
Stock Position:  0.04563237300312066
Bond Position:  [-2.52835113]


portfolio before change:  [2.04881124]
curr_Stock_Price:  100.3190112638673
curr_Factors:  [100.31901126]
mat_Sqrt:  [[0.15]]
grads:  [0.06045358]
Stock Position:  0.060453578619274605
Bond Position:  [-4.01583199]


portfolio before change:  [2.04447692]
curr_Stock_Price:  100.26392377524046
curr_Factors:  [100.26392378]
mat_Sqrt:  [[0.15]]
grads:  [-0.04633751]
Stock Position:  -0.04633751031813543
Bond Position:  [6.69045752]


portfolio before change:  [2.09682181]
curr_Stock_Price:  99.17038074053013
curr_Factors:  [99.17038074]
mat_Sqrt:  [[0.15]]
grads:  [-0.00268161]
Stock Position:  -0.0026816093229802287
Bond Position:  [2.36275802]


portfolio before change:  [2.09726533]
curr_Stock_Price:  99.2252887201704
curr_Factors:  [99.22528872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00048156]
Stock Position:  -0.00048156479097579617
Bond Position:  [2.14504873]


portfolio before change:  [2.09829361]
curr_Stock_Price:  98.20372628530731
curr_Factors:  [98.20372629]
mat_Sqrt:  [[0.15]]
grads:  [-0.24815014]
Stock Position:  -0.2481501413110043
Bond Position:  [26.46756216]


portfolio before change:  [2.47445782]
curr_Stock_Price:  96.7145210215756
curr_Factors:  [96.71452102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00623309]
Stock Position:  -0.006233085988012338
Bond Position:  [3.07728775]


portfolio before change:  [2.47311554]
curr_Stock_Price:  97.0533093196397
curr_Factors:  [97.05330932]
mat_Sqrt:  [[0.15]]
grads:  [-0.17567232]
Stock Position:  -0.17567231564170877
Bond Position:  [19.52269513]


portfolio before change:  [2.69495948]
curr_Stock_Price:  95.81826749220603
curr_Factors:  [95.81826749]
mat_Sqrt:  [[0.15]]
grads:  [0.01654742]
Stock Position:  0.016547417314847514
Bond Position:  [1.10941462]


portfolio before change:  [2.68665264]
curr_Stock_Price:  95.29950181176683
curr_Factors:  [95.29950181]
mat_Sqrt:  [[0.15]]
grads:  [-0.01948554]
Stock Position:  -0.01948554047479619
Bond Position:  [4.54361494]


portfolio before change:  [2.71722547]
curr_Stock_Price:  93.78880284847719
curr_Factors:  [93.78880285]
mat_Sqrt:  [[0.15]]
grads:  [0.00151919]
Stock Position:  0.0015191853538613453
Bond Position:  [2.5747429]


portfolio before change:  [2.71831484]
curr_Stock_Price:  94.08212292451334
curr_Factors:  [94.08212292]
mat_Sqrt:  [[0.15]]
grads:  [0.0420296]
Stock Position:  0.04202959648834713
Bond Position:  [-1.23591882]


portfolio before change:  [2.75138809]
curr_Stock_Price:  94.87637900716811
curr_Factors:  [94.87637901]
mat_Sqrt:  [[0.15]]
grads:  [0.18775133]
Stock Position:  0.1877513276810267
Bond Position:  [-15.06177804]


portfolio before change:  [2.59383747]
curr_Stock_Price:  94.0572918293585
curr_Factors:  [94.05729183]
mat_Sqrt:  [[0.15]]
grads:  [0.10501499]
Stock Position:  0.10501498650926719
Bond Position:  [-7.28358776]


portfolio before change:  [2.52609666]
curr_Stock_Price:  93.42957493199712
curr_Factors:  [93.42957493]
mat_Sqrt:  [[0.15]]
grads:  [0.00598402]
Stock Position:  0.005984015496619168
Bond Position:  [1.96701264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.52609666]
Stock Price:  93.01789313621187
PL:  [2.52609666]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.89159064e-02]
 [-7.95029058e-03]
 [-3.98768214e-03]
 [ 3.58529573e-03]
 [ 5.66232080e-03]
 [-2.33842464e-02]
 [-3.74094039e-03]
 [ 8.99425838e-04]
 [ 1.82417741e-03]
 [ 3.93645760e-02]
 [-8.80407068e-03]
 [-2.24034193e-02]
 [-1.71701837e-04]
 [-2.00236356e-02]
 [ 1.99197555e-03]
 [ 9.76671130e-03]
 [-4.70709611e-02]
 [-2.24696684e-02]
 [ 4.61653056e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.32810373]
curr_Stock_Price:  100.03659214786839
curr_Factors:  [100.03659215]
mat_Sqrt:  [[0.15]]
grads:  [0.19277271]
Stock Position:  0.192772709372293
Bond Position:  [-16.95622117]


portfolio before change:  [2.49835266]
curr_Stock_Price:  100.9417436456072
curr_Factors:  [100.94174365]
mat_Sqrt:  [[0.15]]
grads:  [-0.05300194]
Stock Position:  -0.05300193722981083
Bond Position:  [7.84846062]


portfolio before change:  [2.47161181]
curr_Stock_Price:  101.48329383339859
curr_Factors:  [101.48329383]
mat_Sqrt:  [[0.15]]
grads:  [-0.02658455]
Stock Position:  -0.026584547621808296
Bond Position:  [5.16949926]


portfolio before change:  [2.45719966]
curr_Stock_Price:  102.07403854668576
curr_Factors:  [102.07403855]
mat_Sqrt:  [[0.15]]
grads:  [0.02390197]
Stock Position:  0.023901971563293416
Bond Position:  [0.0174289]


portfolio before change:  [2.47335427]
curr_Stock_Price:  102.74972556319261
curr_Factors:  [102.74972556]
mat_Sqrt:  [[0.15]]
grads:  [0.03774881]
Stock Position:  0.037748805339762076
Bond Position:  [-1.40532512]


portfolio before change:  [2.50476348]
curr_Stock_Price:  103.59109219391202
curr_Factors:  [103.59109219]
mat_Sqrt:  [[0.15]]
grads:  [-0.15589498]
Stock Position:  -0.1558949758938508
Bond Position:  [18.6540943]


portfolio before change:  [2.6114478]
curr_Stock_Price:  102.93667590574468
curr_Factors:  [102.93667591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0249396]
Stock Position:  -0.024939602601207537
Bond Position:  [5.17864759]


portfolio before change:  [2.59525977]
curr_Stock_Price:  103.63768351631356
curr_Factors:  [103.63768352]
mat_Sqrt:  [[0.15]]
grads:  [0.00599617]
Stock Position:  0.005996172251179366
Bond Position:  [1.97383037]


portfolio before change:  [2.59800346]
curr_Stock_Price:  104.01295175533464
curr_Factors:  [104.01295176]
mat_Sqrt:  [[0.15]]
grads:  [0.01216118]
Stock Position:  0.01216118271314315
Bond Position:  [1.33308295]


portfolio before change:  [2.58293566]
curr_Stock_Price:  102.7465354052655
curr_Factors:  [102.74653541]
mat_Sqrt:  [[0.15]]
grads:  [0.26243051]
Stock Position:  0.2624305067605079
Bond Position:  [-24.3808897]


portfolio before change:  [2.51551754]
curr_Stock_Price:  102.51286541114341
curr_Factors:  [102.51286541]
mat_Sqrt:  [[0.15]]
grads:  [-0.0586938]
Stock Position:  -0.05869380455127122
Bond Position:  [8.53238762]


portfolio before change:  [2.58924441]
curr_Stock_Price:  101.29308582128361
curr_Factors:  [101.29308582]
mat_Sqrt:  [[0.15]]
grads:  [-0.14935613]
Stock Position:  -0.1493561287687288
Bond Position:  [17.71798758]


portfolio before change:  [2.53645631]
curr_Stock_Price:  101.67618459199647
curr_Factors:  [101.67618459]
mat_Sqrt:  [[0.15]]
grads:  [-0.00114468]
Stock Position:  -0.0011446789111597736
Bond Position:  [2.65284289]


portfolio before change:  [2.53647371]
curr_Stock_Price:  102.24044166309137
curr_Factors:  [102.24044166]
mat_Sqrt:  [[0.15]]
grads:  [-0.1334909]
Stock Position:  -0.13349090414348755
Bond Position:  [16.18464271]


portfolio before change:  [2.43647874]
curr_Stock_Price:  103.01983287221877
curr_Factors:  [103.01983287]
mat_Sqrt:  [[0.15]]
grads:  [0.01327984]
Stock Position:  0.013279836970020935
Bond Position:  [1.06839215]


portfolio before change:  [2.41891385]
curr_Stock_Price:  101.67704358372221
curr_Factors:  [101.67704358]
mat_Sqrt:  [[0.15]]
grads:  [0.06511141]
Stock Position:  0.06511140867139563
Bond Position:  [-4.20142169]


portfolio before change:  [2.577123]
curr_Stock_Price:  104.12299965915616
curr_Factors:  [104.12299966]
mat_Sqrt:  [[0.15]]
grads:  [-0.31380641]
Stock Position:  -0.3138064075019189
Bond Position:  [35.25158747]


portfolio before change:  [3.29666798]
curr_Stock_Price:  101.85812882983548
curr_Factors:  [101.85812883]
mat_Sqrt:  [[0.15]]
grads:  [-0.14979779]
Stock Position:  -0.14979778950371792
Bond Position:  [18.55479052]


portfolio before change:  [3.18214697]
curr_Stock_Price:  102.653603135791
curr_Factors:  [102.65360314]
mat_Sqrt:  [[0.15]]
grads:  [0.03077687]
Stock Position:  0.03077687039011543
Bond Position:  [0.02279033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.18214697]
Stock Price:  103.17878375294208
PL:  [0.00336321]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.03791920e-02]
 [-6.67845712e-03]
 [ 2.76522655e-02]
 [-5.10189972e-03]
 [ 4.77222699e-03]
 [-1.86680113e-02]
 [-1.22837722e-02]
 [ 1.45757797e-03]
 [ 1.21816249e-03]
 [ 4.32147504e-02]
 [-7.68077398e-03]
 [-2.05807017e-02]
 [-5.78169019e-04]
 [-2.02483471e-02]
 [ 8.86462716e-03]
 [ 6.31245497e-03]
 [-4.96332220e-02]
 [-1.60078821e-02]
 [ 4.92692799e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.98824962]
curr_Stock_Price:  100.7990957034036
curr_Factors:  [100.7990957]
mat_Sqrt:  [[0.15]]
grads:  [0.06919461]
Stock Position:  0.06919461337678526
Bond Position:  [7.01349516]


portfolio before change:  [14.10317756]
curr_Stock_Price:  102.43469050509503
curr_Factors:  [102.43469051]
mat_Sqrt:  [[0.15]]
grads:  [-0.04452305]
Stock Position:  -0.04452304743687005
Bond Position:  [18.66388214]


portfolio before change:  [14.06189522]
curr_Stock_Price:  103.46671536049953
curr_Factors:  [103.46671536]
mat_Sqrt:  [[0.15]]
grads:  [0.18434844]
Stock Position:  0.18434843638449602
Bond Position:  [-5.01203197]


portfolio before change:  [14.12128796]
curr_Stock_Price:  103.79568971498878
curr_Factors:  [103.79568971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03401266]
Stock Position:  -0.034012664799517686
Bond Position:  [17.65165597]


portfolio before change:  [14.09798542]
curr_Stock_Price:  104.61056302912571
curr_Factors:  [104.61056303]
mat_Sqrt:  [[0.15]]
grads:  [0.03181485]
Stock Position:  0.031814846611083095
Bond Position:  [10.7698164]


portfolio before change:  [14.05750433]
curr_Stock_Price:  103.2535274935144
curr_Factors:  [103.25352749]
mat_Sqrt:  [[0.15]]
grads:  [-0.12445341]
Stock Position:  -0.12445340882801788
Bond Position:  [26.9077578]


portfolio before change:  [13.83172576]
curr_Stock_Price:  105.12174748492502
curr_Factors:  [105.12174748]
mat_Sqrt:  [[0.15]]
grads:  [-0.08189181]
Stock Position:  -0.08189181473779902
Bond Position:  [22.44033643]


portfolio before change:  [13.81758718]
curr_Stock_Price:  105.3629116857963
curr_Factors:  [105.36291169]
mat_Sqrt:  [[0.15]]
grads:  [0.00971719]
Stock Position:  0.009717186457965892
Bond Position:  [12.79375612]


portfolio before change:  [13.80388801]
curr_Stock_Price:  103.62393094295747
curr_Factors:  [103.62393094]
mat_Sqrt:  [[0.15]]
grads:  [0.00812108]
Stock Position:  0.008121083252936936
Bond Position:  [12.96234944]


portfolio before change:  [13.80268417]
curr_Stock_Price:  103.07661073535266
curr_Factors:  [103.07661074]
mat_Sqrt:  [[0.15]]
grads:  [0.28809834]
Stock Position:  0.2880983363026713
Bond Position:  [-15.89351589]


portfolio before change:  [13.54074646]
curr_Stock_Price:  102.18120869962192
curr_Factors:  [102.1812087]
mat_Sqrt:  [[0.15]]
grads:  [-0.05120516]
Stock Position:  -0.051205159852604126
Bond Position:  [18.77295159]


portfolio before change:  [13.49130214]
curr_Stock_Price:  103.23848785467396
curr_Factors:  [103.23848785]
mat_Sqrt:  [[0.15]]
grads:  [-0.13720468]
Stock Position:  -0.13720467775648218
Bond Position:  [27.6561056]


portfolio before change:  [13.57714797]
curr_Stock_Price:  102.66320906194768
curr_Factors:  [102.66320906]
mat_Sqrt:  [[0.15]]
grads:  [-0.00385446]
Stock Position:  -0.0038544601263944328
Bond Position:  [13.97285922]


portfolio before change:  [13.57618288]
curr_Stock_Price:  103.81998441013069
curr_Factors:  [103.81998441]
mat_Sqrt:  [[0.15]]
grads:  [-0.13498898]
Stock Position:  -0.13498898056605463
Bond Position:  [27.59073674]


portfolio before change:  [13.42977473]
curr_Stock_Price:  104.95568222549528
curr_Factors:  [104.95568223]
mat_Sqrt:  [[0.15]]
grads:  [0.05909751]
Stock Position:  0.05909751442457807
Bond Position:  [7.22715479]


portfolio before change:  [13.50467514]
curr_Stock_Price:  106.1925089922411
curr_Factors:  [106.19250899]
mat_Sqrt:  [[0.15]]
grads:  [0.04208303]
Stock Position:  0.04208303315660008
Bond Position:  [9.03577226]


portfolio before change:  [13.44121378]
curr_Stock_Price:  104.63082070072747
curr_Factors:  [104.6308207]
mat_Sqrt:  [[0.15]]
grads:  [-0.33088815]
Stock Position:  -0.3308881467676752
Bond Position:  [48.06231214]


portfolio before change:  [13.15390083]
curr_Stock_Price:  105.53544671793459
curr_Factors:  [105.53544672]
mat_Sqrt:  [[0.15]]
grads:  [-0.10671921]
Stock Position:  -0.10671921404741075
Bond Position:  [24.41656076]


portfolio before change:  [12.89085748]
curr_Stock_Price:  108.05746919246315
curr_Factors:  [108.05746919]
mat_Sqrt:  [[0.15]]
grads:  [0.03284619]
Stock Position:  0.03284618657323659
Bond Position:  [9.34158169]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.89085748]
Stock Price:  106.64552823502112
PL:  [6.24532925]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.03399073e-02]
 [-7.30566244e-03]
 [-2.52495364e-03]
 [ 2.43235030e-03]
 [ 7.54735037e-03]
 [ 8.38888556e-03]
 [ 1.17037201e-03]
 [-1.64790021e-03]
 [-1.23424571e-03]
 [-2.75344901e-03]
 [-1.00476955e-03]
 [-2.63410091e-02]
 [ 2.80783058e-03]
 [-1.08739815e-03]
 [-1.58652459e-03]
 [ 1.01413164e-02]
 [ 4.49788942e-02]
 [ 1.69189755e-02]
 [-6.35447032e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.2550502]
curr_Stock_Price:  101.47048283949422
curr_Factors:  [101.47048284]
mat_Sqrt:  [[0.15]]
grads:  [-0.26893272]
Stock Position:  -0.26893271524555723
Bond Position:  [51.54378267]


portfolio before change:  [24.12723111]
curr_Stock_Price:  101.99368675214949
curr_Factors:  [101.99368675]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870442]
Stock Position:  -0.04870441623834001
Bond Position:  [29.09477408]


portfolio before change:  [24.15472709]
curr_Stock_Price:  101.57850109031233
curr_Factors:  [101.57850109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01683302]
Stock Position:  -0.01683302426641126
Bond Position:  [25.86460046]


portfolio before change:  [24.16660122]
curr_Stock_Price:  101.25727703843383
curr_Factors:  [101.25727704]
mat_Sqrt:  [[0.15]]
grads:  [0.01621567]
Stock Position:  0.016215668679880134
Bond Position:  [22.52464676]


portfolio before change:  [24.15163413]
curr_Stock_Price:  99.98696525980209
curr_Factors:  [99.98696526]
mat_Sqrt:  [[0.15]]
grads:  [0.05031567]
Stock Position:  0.05031566916361052
Bond Position:  [19.12072306]


portfolio before change:  [24.22333293]
curr_Stock_Price:  101.31692908946037
curr_Factors:  [101.31692909]
mat_Sqrt:  [[0.15]]
grads:  [0.0559259]
Stock Position:  0.055925903727265296
Bond Position:  [18.5570921]


portfolio before change:  [24.2483499]
curr_Stock_Price:  101.68128841693934
curr_Factors:  [101.68128842]
mat_Sqrt:  [[0.15]]
grads:  [0.00780248]
Stock Position:  0.007802480044931763
Bond Position:  [23.45498368]


portfolio before change:  [24.24798436]
curr_Stock_Price:  100.88282069234593
curr_Factors:  [100.88282069]
mat_Sqrt:  [[0.15]]
grads:  [-0.010986]
Stock Position:  -0.010986001416272533
Bond Position:  [25.35628317]


portfolio before change:  [24.25676085]
curr_Stock_Price:  100.66102663417304
curr_Factors:  [100.66102663]
mat_Sqrt:  [[0.15]]
grads:  [-0.0082283]
Stock Position:  -0.008228304714315387
Bond Position:  [25.08503045]


portfolio before change:  [24.26365133]
curr_Stock_Price:  100.5858660111062
curr_Factors:  [100.58586601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01835633]
Stock Position:  -0.01835632674555988
Bond Position:  [26.11003836]


portfolio before change:  [24.31630892]
curr_Stock_Price:  98.07287657669904
curr_Factors:  [98.07287658]
mat_Sqrt:  [[0.15]]
grads:  [-0.00669846]
Stock Position:  -0.006698463640299052
Bond Position:  [24.97324651]


portfolio before change:  [24.32451965]
curr_Stock_Price:  97.77927982149257
curr_Factors:  [97.77927982]
mat_Sqrt:  [[0.15]]
grads:  [-0.17560673]
Stock Position:  -0.17560672716031836
Bond Position:  [41.49521897]


portfolio before change:  [24.42406163]
curr_Stock_Price:  97.27151523850428
curr_Factors:  [97.27151524]
mat_Sqrt:  [[0.15]]
grads:  [0.01871887]
Stock Position:  0.01871887051825764
Bond Position:  [22.60324873]


portfolio before change:  [24.41543175]
curr_Stock_Price:  96.50857361687072
curr_Factors:  [96.50857362]
mat_Sqrt:  [[0.15]]
grads:  [-0.00724932]
Stock Position:  -0.007249320973146366
Bond Position:  [25.11505337]


portfolio before change:  [24.42182877]
curr_Stock_Price:  96.49236870642892
curr_Factors:  [96.49236871]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057683]
Stock Position:  -0.010576830593092243
Bond Position:  [25.44241221]


portfolio before change:  [24.43194978]
curr_Stock_Price:  96.13691114523067
curr_Factors:  [96.13691115]
mat_Sqrt:  [[0.15]]
grads:  [0.06760878]
Stock Position:  0.06760877614024266
Bond Position:  [17.93225088]


portfolio before change:  [24.4316689]
curr_Stock_Price:  96.06643945296985
curr_Factors:  [96.06643945]
mat_Sqrt:  [[0.15]]
grads:  [0.29985929]
Stock Position:  0.29985929449380494
Bond Position:  [-4.37474586]


portfolio before change:  [24.01456527]
curr_Stock_Price:  94.67908939875991
curr_Factors:  [94.6790894]
mat_Sqrt:  [[0.15]]
grads:  [0.11279317]
Stock Position:  0.11279317015261586
Bond Position:  [13.33541063]


portfolio before change:  [23.67426838]
curr_Stock_Price:  91.6325293902457
curr_Factors:  [91.63252939]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423631]
Stock Position:  -0.0042363135495031
Bond Position:  [24.0624525]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.67426838]
Stock Price:  93.10645385705315
PL:  [23.67426838]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.86985195e-01]
 [ 9.04589384e-03]
 [ 3.02622250e-02]
 [ 3.00973330e-03]
 [ 8.44765156e-03]
 [ 1.96427690e-03]
 [-1.58666304e-02]
 [-1.03054424e-03]
 [-8.15749180e-05]
 [-1.15878349e-02]
 [-1.32199738e-03]
 [-2.19586490e-02]
 [-3.41572405e-04]
 [-2.06672720e-02]
 [-3.34521593e-04]
 [ 8.68607233e-03]
 [-4.64554058e-02]
 [-2.39601278e-02]
 [ 4.61187997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-31.5394098]
curr_Stock_Price:  97.82186003802802
curr_Factors:  [97.82186004]
mat_Sqrt:  [[0.15]]
grads:  [1.24656797]
Stock Position:  1.2465679656189064
Bond Position:  [-153.48100687]


portfolio before change:  [-32.16246678]
curr_Stock_Price:  97.3528267038294
curr_Factors:  [97.3528267]
mat_Sqrt:  [[0.15]]
grads:  [0.06030596]
Stock Position:  0.06030595895539328
Bond Position:  [-38.03342235]


portfolio before change:  [-32.20146467]
curr_Stock_Price:  96.86384781193829
curr_Factors:  [96.86384781]
mat_Sqrt:  [[0.15]]
grads:  [0.20174817]
Stock Position:  0.20174816649302704
Bond Position:  [-51.74356836]


portfolio before change:  [-31.93352519]
curr_Stock_Price:  98.25606361430138
curr_Factors:  [98.25606361]
mat_Sqrt:  [[0.15]]
grads:  [0.02006489]
Stock Position:  0.020064888682273924
Bond Position:  [-33.90502217]


portfolio before change:  [-31.93164865]
curr_Stock_Price:  98.7720820401274
curr_Factors:  [98.77208204]
mat_Sqrt:  [[0.15]]
grads:  [0.05631768]
Stock Position:  0.05631767707101968
Bond Position:  [-37.49426287]


portfolio before change:  [-31.92409873]
curr_Stock_Price:  99.07260328073075
curr_Factors:  [99.07260328]
mat_Sqrt:  [[0.15]]
grads:  [0.01309518]
Stock Position:  0.01309517935102154
Bond Position:  [-33.22147224]


portfolio before change:  [-31.92860432]
curr_Stock_Price:  99.36284876478078
curr_Factors:  [99.36284876]
mat_Sqrt:  [[0.15]]
grads:  [-0.10577754]
Stock Position:  -0.10577753625421599
Bond Position:  [-21.41824699]


portfolio before change:  [-31.94350584]
curr_Stock_Price:  99.4530974990275
curr_Factors:  [99.4530975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00687029]
Stock Position:  -0.00687029492132641
Bond Position:  [-31.26023373]


portfolio before change:  [-31.94981836]
curr_Stock_Price:  99.23425417337687
curr_Factors:  [99.23425417]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054383]
Stock Position:  -0.0005438327869852145
Bond Position:  [-31.89585152]


portfolio before change:  [-31.95824467]
curr_Stock_Price:  100.0641970545212
curr_Factors:  [100.06419705]
mat_Sqrt:  [[0.15]]
grads:  [-0.07725223]
Stock Position:  -0.07725223247238978
Bond Position:  [-24.22806206]


portfolio before change:  [-31.94477256]
curr_Stock_Price:  99.81139029260028
curr_Factors:  [99.81139029]
mat_Sqrt:  [[0.15]]
grads:  [-0.00881332]
Stock Position:  -0.008813315899738779
Bond Position:  [-31.06510324]


portfolio before change:  [-31.97046704]
curr_Stock_Price:  101.84549790119803
curr_Factors:  [101.8454979]
mat_Sqrt:  [[0.15]]
grads:  [-0.14639099]
Stock Position:  -0.14639099313639473
Bond Position:  [-17.06120345]


portfolio before change:  [-32.01033274]
curr_Stock_Price:  102.08868138188713
curr_Factors:  [102.08868138]
mat_Sqrt:  [[0.15]]
grads:  [-0.00227715]
Stock Position:  -0.0022771493681947265
Bond Position:  [-31.77786156]


portfolio before change:  [-32.01888841]
curr_Stock_Price:  102.35665488995046
curr_Factors:  [102.35665489]
mat_Sqrt:  [[0.15]]
grads:  [-0.13778181]
Stock Position:  -0.13778181351807264
Bond Position:  [-17.91600288]


portfolio before change:  [-31.99699855]
curr_Stock_Price:  102.1652694830685
curr_Factors:  [102.16526948]
mat_Sqrt:  [[0.15]]
grads:  [-0.00223014]
Stock Position:  -0.0022301439513148836
Bond Position:  [-31.76915529]


portfolio before change:  [-32.00637617]
curr_Stock_Price:  102.80843091384348
curr_Factors:  [102.80843091]
mat_Sqrt:  [[0.15]]
grads:  [0.05790715]
Stock Position:  0.057907148854850675
Bond Position:  [-37.95971928]


portfolio before change:  [-31.94680894]
curr_Stock_Price:  104.00100118191561
curr_Factors:  [104.00100118]
mat_Sqrt:  [[0.15]]
grads:  [-0.30970271]
Stock Position:  -0.30970270559032725
Bond Position:  [0.26258251]


portfolio before change:  [-31.91144966]
curr_Stock_Price:  103.88704148569063
curr_Factors:  [103.88704149]
mat_Sqrt:  [[0.15]]
grads:  [-0.15973419]
Stock Position:  -0.15973418534733086
Bond Position:  [-15.31713772]


portfolio before change:  [-31.92333776]
curr_Stock_Price:  103.93748986932485
curr_Factors:  [103.93748987]
mat_Sqrt:  [[0.15]]
grads:  [0.03074587]
Stock Position:  0.0307458664697763
Bond Position:  [-35.11898594]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.92333776]
Stock Price:  104.78081213616282
PL:  [-36.70414989]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-2.91020269e-02]
 [-7.77700079e-03]
 [-8.42519876e-04]
 [ 1.33883655e-03]
 [ 5.42806184e-03]
 [-1.86962497e-02]
 [ 3.82886155e-05]
 [ 1.11486714e-04]
 [-2.62385346e-04]
 [ 2.86869592e-02]
 [-6.50207704e-03]
 [-2.19248357e-02]
 [ 3.72097695e-04]
 [-9.56531807e-03]
 [-3.19108404e-03]
 [ 9.51351266e-03]
 [-4.79277000e-02]
 [-2.24105222e-02]
 [ 4.67307709e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.48206555]
curr_Stock_Price:  101.22375228882335
curr_Factors:  [101.22375229]
mat_Sqrt:  [[0.15]]
grads:  [-0.19401351]
Stock Position:  -0.19401351299641312
Bond Position:  [40.12084133]


portfolio before change:  [20.46687014]
curr_Stock_Price:  101.35377865920283
curr_Factors:  [101.35377866]
mat_Sqrt:  [[0.15]]
grads:  [-0.05184667]
Stock Position:  -0.05184667192698802
Bond Position:  [25.72172625]


portfolio before change:  [20.45597266]
curr_Stock_Price:  101.68800870105397
curr_Factors:  [101.6880087]
mat_Sqrt:  [[0.15]]
grads:  [-0.0056168]
Stock Position:  -0.005616799176461051
Bond Position:  [21.02713378]


portfolio before change:  [20.45584286]
curr_Stock_Price:  102.64713876041739
curr_Factors:  [102.64713876]
mat_Sqrt:  [[0.15]]
grads:  [0.00892558]
Stock Position:  0.008925576977739158
Bond Position:  [19.53965792]


portfolio before change:  [20.46577221]
curr_Stock_Price:  103.21223662079132
curr_Factors:  [103.21223662]
mat_Sqrt:  [[0.15]]
grads:  [0.03618708]
Stock Position:  0.03618707895203639
Bond Position:  [16.73082285]


portfolio before change:  [20.47152277]
curr_Stock_Price:  103.2555486584117
curr_Factors:  [103.25554866]
mat_Sqrt:  [[0.15]]
grads:  [-0.12464166]
Stock Position:  -0.1246416648618829
Bond Position:  [33.34146626]


portfolio before change:  [20.64000961]
curr_Stock_Price:  101.97066184928262
curr_Factors:  [101.97066185]
mat_Sqrt:  [[0.15]]
grads:  [0.00025526]
Stock Position:  0.00025525743687700164
Bond Position:  [20.61398084]


portfolio before change:  [20.64521551]
curr_Stock_Price:  102.17342885178465
curr_Factors:  [102.17342885]
mat_Sqrt:  [[0.15]]
grads:  [0.00074324]
Stock Position:  0.0007432447591560777
Bond Position:  [20.56927564]


portfolio before change:  [20.65042564]
curr_Stock_Price:  102.26380105194856
curr_Factors:  [102.26380105]
mat_Sqrt:  [[0.15]]
grads:  [-0.00174924]
Stock Position:  -0.001749235637653689
Bond Position:  [20.82930912]


portfolio before change:  [20.65587151]
curr_Stock_Price:  102.12780249556847
curr_Factors:  [102.1278025]
mat_Sqrt:  [[0.15]]
grads:  [0.19124639]
Stock Position:  0.19124639480407687
Bond Position:  [1.12429747]


portfolio before change:  [20.5532454]
curr_Stock_Price:  101.58971537681968
curr_Factors:  [101.58971538]
mat_Sqrt:  [[0.15]]
grads:  [-0.04334718]
Stock Position:  -0.0433471802783173
Bond Position:  [24.95687311]


portfolio before change:  [20.54684979]
curr_Stock_Price:  101.88121305819791
curr_Factors:  [101.88121306]
mat_Sqrt:  [[0.15]]
grads:  [-0.14616557]
Stock Position:  -0.1461655715347534
Bond Position:  [35.43837553]


portfolio before change:  [20.72021998]
curr_Stock_Price:  100.75571217581192
curr_Factors:  [100.75571218]
mat_Sqrt:  [[0.15]]
grads:  [0.00248065]
Stock Position:  0.0024806513013903094
Bond Position:  [20.47028019]


portfolio before change:  [20.72619158]
curr_Stock_Price:  101.09973076320884
curr_Factors:  [101.09973076]
mat_Sqrt:  [[0.15]]
grads:  [-0.06376879]
Stock Position:  -0.0637687871155515
Bond Position:  [27.17319878]


portfolio before change:  [20.7441715]
curr_Stock_Price:  100.92431933246716
curr_Factors:  [100.92431933]
mat_Sqrt:  [[0.15]]
grads:  [-0.02127389]
Stock Position:  -0.021273893632062064
Bond Position:  [22.89122473]


portfolio before change:  [20.73194296]
curr_Stock_Price:  101.76817339110428
curr_Factors:  [101.76817339]
mat_Sqrt:  [[0.15]]
grads:  [0.06342342]
Stock Position:  0.06342341771646767
Bond Position:  [14.27745759]


portfolio before change:  [20.77668174]
curr_Stock_Price:  102.41728641936349
curr_Factors:  [102.41728642]
mat_Sqrt:  [[0.15]]
grads:  [-0.319518]
Stock Position:  -0.31951799996932173
Bond Position:  [53.50084826]


portfolio before change:  [20.20139927]
curr_Stock_Price:  104.25962189352094
curr_Factors:  [104.25962189]
mat_Sqrt:  [[0.15]]
grads:  [-0.14940348]
Stock Position:  -0.1494034816131253
Bond Position:  [35.77814978]


portfolio before change:  [20.32927769]
curr_Stock_Price:  103.4635711034487
curr_Factors:  [103.4635711]
mat_Sqrt:  [[0.15]]
grads:  [0.03115385]
Stock Position:  0.031153847233864624
Bond Position:  [17.1059894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.32927769]
Stock Price:  103.22023526929506
PL:  [17.10904242]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.25241804e-02]
 [-7.34590448e-03]
 [-1.02915292e-02]
 [ 3.29450816e-03]
 [ 6.20077769e-03]
 [ 2.47248432e-03]
 [-1.01379025e-03]
 [ 8.63389553e-04]
 [ 3.69714719e-03]
 [ 8.19581380e-02]
 [-1.52462227e-02]
 [-1.55510778e-02]
 [-4.41687883e-03]
 [-2.69014931e-02]
 [ 1.76744920e-02]
 [ 4.59243359e-03]
 [-1.53585017e-02]
 [-4.24019963e-03]
 [ 5.03585034e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.63401057]
curr_Stock_Price:  100.25277861240835
curr_Factors:  [100.25277861]
mat_Sqrt:  [[0.15]]
grads:  [0.21682787]
Stock Position:  0.2168278694159186
Bond Position:  [-16.10358582]


portfolio before change:  [5.99847928]
curr_Stock_Price:  101.95226085682476
curr_Factors:  [101.95226086]
mat_Sqrt:  [[0.15]]
grads:  [-0.0489727]
Stock Position:  -0.04897269650600933
Bond Position:  [10.99135641]


portfolio before change:  [6.05243339]
curr_Stock_Price:  100.90665936267504
curr_Factors:  [100.90665936]
mat_Sqrt:  [[0.15]]
grads:  [-0.06861019]
Stock Position:  -0.0686101945765393
Bond Position:  [12.97565892]


portfolio before change:  [5.99700538]
curr_Stock_Price:  101.76181410981394
curr_Factors:  [101.76181411]
mat_Sqrt:  [[0.15]]
grads:  [0.02196339]
Stock Position:  0.021963387726269646
Bond Position:  [3.7619712]


portfolio before change:  [5.99708646]
curr_Stock_Price:  101.72267960027948
curr_Factors:  [101.7226796]
mat_Sqrt:  [[0.15]]
grads:  [0.04133852]
Stock Position:  0.04133851792617534
Bond Position:  [1.79202165]


portfolio before change:  [5.99826688]
curr_Stock_Price:  101.74039572872744
curr_Factors:  [101.74039573]
mat_Sqrt:  [[0.15]]
grads:  [0.01648323]
Stock Position:  0.016483228817904955
Bond Position:  [4.32125666]


portfolio before change:  [6.00757558]
curr_Stock_Price:  102.2395852126457
curr_Factors:  [102.23958521]
mat_Sqrt:  [[0.15]]
grads:  [-0.0067586]
Stock Position:  -0.006758601684094881
Bond Position:  [6.69857222]


portfolio before change:  [6.00055407]
curr_Stock_Price:  103.52629665661942
curr_Factors:  [103.52629666]
mat_Sqrt:  [[0.15]]
grads:  [0.00575593]
Stock Position:  0.005755930354656522
Bond Position:  [5.40466391]


portfolio before change:  [6.01170151]
curr_Stock_Price:  105.22821342437452
curr_Factors:  [105.22821342]
mat_Sqrt:  [[0.15]]
grads:  [0.02464765]
Stock Position:  0.02464764794130548
Bond Position:  [3.41807356]


portfolio before change:  [6.04815665]
curr_Stock_Price:  106.67259084483513
curr_Factors:  [106.67259084]
mat_Sqrt:  [[0.15]]
grads:  [0.54638759]
Stock Position:  0.546387586677017
Bond Position:  [-52.23642283]


portfolio before change:  [6.01526368]
curr_Stock_Price:  106.63629385818935
curr_Factors:  [106.63629386]
mat_Sqrt:  [[0.15]]
grads:  [-0.10164148]
Stock Position:  -0.10164148489110034
Bond Position:  [16.85393494]


portfolio before change:  [5.7573249]
curr_Stock_Price:  109.21548477250099
curr_Factors:  [109.21548477]
mat_Sqrt:  [[0.15]]
grads:  [-0.10367385]
Stock Position:  -0.10367385172666375
Bond Position:  [17.08011488]


portfolio before change:  [5.70427864]
curr_Stock_Price:  109.76834188474932
curr_Factors:  [109.76834188]
mat_Sqrt:  [[0.15]]
grads:  [-0.02944586]
Stock Position:  -0.029445858844317028
Bond Position:  [8.93650174]


portfolio before change:  [5.75983791]
curr_Stock_Price:  107.9573955841602
curr_Factors:  [107.95739558]
mat_Sqrt:  [[0.15]]
grads:  [-0.17934329]
Stock Position:  -0.17934328750215214
Bond Position:  [25.12127215]


portfolio before change:  [5.8105483]
curr_Stock_Price:  107.70966240575513
curr_Factors:  [107.70966241]
mat_Sqrt:  [[0.15]]
grads:  [0.11782995]
Stock Position:  0.11782994643171302
Bond Position:  [-6.88087545]


portfolio before change:  [5.76731721]
curr_Stock_Price:  107.35736947576565
curr_Factors:  [107.35736948]
mat_Sqrt:  [[0.15]]
grads:  [0.03061622]
Stock Position:  0.0306162239215801
Bond Position:  [2.48043994]


portfolio before change:  [5.79205747]
curr_Stock_Price:  108.14518971082907
curr_Factors:  [108.14518971]
mat_Sqrt:  [[0.15]]
grads:  [-0.10239001]
Stock Position:  -0.1023900111259644
Bond Position:  [16.86504465]


portfolio before change:  [5.79668905]
curr_Stock_Price:  108.14113863706368
curr_Factors:  [108.14113864]
mat_Sqrt:  [[0.15]]
grads:  [-0.028268]
Stock Position:  -0.02826799751020931
Bond Position:  [8.85362249]


portfolio before change:  [5.78183031]
curr_Stock_Price:  108.74508750444852
curr_Factors:  [108.7450875]
mat_Sqrt:  [[0.15]]
grads:  [0.03357234]
Stock Position:  0.033572335579278224
Bond Position:  [2.13100374]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.78183031]
Stock Price:  108.63078664259572
PL:  [-2.84895633]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.20103322e-02]
 [ 8.82585386e-03]
 [ 1.75424418e-02]
 [ 1.82051706e-03]
 [ 8.72321177e-03]
 [ 7.16464836e-03]
 [-1.27342276e-02]
 [ 2.98404434e-03]
 [ 1.04150893e-03]
 [-3.72312621e-02]
 [-9.73808531e-04]
 [-2.63382188e-02]
 [ 2.30015929e-03]
 [ 4.89274583e-03]
 [-1.54452497e-03]
 [ 1.19647117e-02]
 [ 4.99217150e-02]
 [ 2.00555922e-02]
 [ 3.90631340e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.40517973]
curr_Stock_Price:  99.8578518146776
curr_Factors:  [99.85785181]
mat_Sqrt:  [[0.15]]
grads:  [0.14673555]
Stock Position:  0.14673554772691177
Bond Position:  [-15.05787631]


portfolio before change:  [-0.68981251]
curr_Stock_Price:  97.94374273752267
curr_Factors:  [97.94374274]
mat_Sqrt:  [[0.15]]
grads:  [0.05883903]
Stock Position:  0.05883902572807711
Bond Position:  [-6.45272691]


portfolio before change:  [-0.71155977]
curr_Stock_Price:  97.60155705528365
curr_Factors:  [97.60155706]
mat_Sqrt:  [[0.15]]
grads:  [0.11694961]
Stock Position:  0.1169496120756034
Bond Position:  [-12.126024]


portfolio before change:  [-0.69074267]
curr_Stock_Price:  97.80548237222322
curr_Factors:  [97.80548237]
mat_Sqrt:  [[0.15]]
grads:  [0.01213678]
Stock Position:  0.012136780431632835
Bond Position:  [-1.87778633]


portfolio before change:  [-0.69238756]
curr_Stock_Price:  97.70863730920756
curr_Factors:  [97.70863731]
mat_Sqrt:  [[0.15]]
grads:  [0.05815475]
Stock Position:  0.058154745133633175
Bond Position:  [-6.37460846]


portfolio before change:  [-0.63430038]
curr_Stock_Price:  98.73488256302151
curr_Factors:  [98.73488256]
mat_Sqrt:  [[0.15]]
grads:  [0.04776432]
Stock Position:  0.047764322378196514
Bond Position:  [-5.35030514]


portfolio before change:  [-0.67071586]
curr_Stock_Price:  98.00049060964537
curr_Factors:  [98.00049061]
mat_Sqrt:  [[0.15]]
grads:  [-0.08489485]
Stock Position:  -0.08489485096093351
Bond Position:  [7.64902119]


portfolio before change:  [-0.68169879]
curr_Stock_Price:  98.15238946198178
curr_Factors:  [98.15238946]
mat_Sqrt:  [[0.15]]
grads:  [0.01989363]
Stock Position:  0.019893628906267887
Bond Position:  [-2.63430601]


portfolio before change:  [-0.67900428]
curr_Stock_Price:  98.32094477822716
curr_Factors:  [98.32094478]
mat_Sqrt:  [[0.15]]
grads:  [0.00694339]
Stock Position:  0.006943392876151096
Bond Position:  [-1.36168522]


portfolio before change:  [-0.68285813]
curr_Stock_Price:  97.81494052698991
curr_Factors:  [97.81494053]
mat_Sqrt:  [[0.15]]
grads:  [-0.24820841]
Stock Position:  -0.24820841381510178
Bond Position:  [23.59563311]


portfolio before change:  [-0.59144348]
curr_Stock_Price:  97.47041151182363
curr_Factors:  [97.47041151]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649206]
Stock Position:  -0.006492056874103751
Bond Position:  [0.04133998]


portfolio before change:  [-0.59477502]
curr_Stock_Price:  97.98517587130642
curr_Factors:  [97.98517587]
mat_Sqrt:  [[0.15]]
grads:  [-0.17558813]
Stock Position:  -0.17558812528986067
Bond Position:  [16.61025831]


portfolio before change:  [-0.73318902]
curr_Stock_Price:  98.79711619868888
curr_Factors:  [98.7971162]
mat_Sqrt:  [[0.15]]
grads:  [0.0153344]
Stock Position:  0.015334395274456732
Bond Position:  [-2.24818305]


portfolio before change:  [-0.73805457]
curr_Stock_Price:  98.51647658488886
curr_Factors:  [98.51647658]
mat_Sqrt:  [[0.15]]
grads:  [0.03261831]
Stock Position:  0.032618305562597295
Bond Position:  [-3.95149511]


portfolio before change:  [-0.8084672]
curr_Stock_Price:  96.38808194593733
curr_Factors:  [96.38808195]
mat_Sqrt:  [[0.15]]
grads:  [-0.01029683]
Stock Position:  -0.010296833149230435
Bond Position:  [0.1840248]


portfolio before change:  [-0.82456582]
curr_Stock_Price:  97.95600445640532
curr_Factors:  [97.95600446]
mat_Sqrt:  [[0.15]]
grads:  [0.07976474]
Stock Position:  0.0797647449762484
Bond Position:  [-8.63800154]


portfolio before change:  [-0.80786722]
curr_Stock_Price:  98.19242940816073
curr_Factors:  [98.19242941]
mat_Sqrt:  [[0.15]]
grads:  [0.33281143]
Stock Position:  0.3328114336504488
Bond Position:  [-33.48743042]


portfolio before change:  [-0.83964778]
curr_Stock_Price:  98.12209631671338
curr_Factors:  [98.12209632]
mat_Sqrt:  [[0.15]]
grads:  [0.13370395]
Stock Position:  0.1337039478688265
Bond Position:  [-13.95895943]


portfolio before change:  [-0.76514822]
curr_Stock_Price:  98.7053979849549
curr_Factors:  [98.70539798]
mat_Sqrt:  [[0.15]]
grads:  [0.02604209]
Stock Position:  0.02604208930350551
Bond Position:  [-3.33564301]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.76514822]
Stock Price:  99.61595459214116
PL:  [-0.76514822]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.94476760e-02]
 [-6.56033140e-03]
 [ 5.51592334e-03]
 [ 3.06814904e-03]
 [ 5.74012819e-03]
 [ 1.67823348e-03]
 [-9.23674902e-04]
 [-2.19943666e-03]
 [-2.13363803e-04]
 [-5.39570243e-03]
 [-9.61022126e-03]
 [-2.27777037e-02]
 [ 1.20503026e-03]
 [ 6.93876407e-04]
 [-1.92864979e-03]
 [ 1.17240110e-02]
 [ 5.07290752e-02]
 [ 2.08671341e-02]
 [ 4.17392309e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.85189192]
curr_Stock_Price:  100.59399673488178
curr_Factors:  [100.59399673]
mat_Sqrt:  [[0.15]]
grads:  [0.19631784]
Stock Position:  0.19631783971823114
Bond Position:  [-8.89650421]


portfolio before change:  [11.22135971]
curr_Stock_Price:  102.4873151845078
curr_Factors:  [102.48731518]
mat_Sqrt:  [[0.15]]
grads:  [-0.04373554]
Stock Position:  -0.043735542653810223
Bond Position:  [15.70369805]


portfolio before change:  [11.24228248]
curr_Stock_Price:  102.09869857265235
curr_Factors:  [102.09869857]
mat_Sqrt:  [[0.15]]
grads:  [0.03677282]
Stock Position:  0.036772822288006525
Bond Position:  [7.48782518]


portfolio before change:  [11.25298231]
curr_Stock_Price:  102.33875732228178
curr_Factors:  [102.33875732]
mat_Sqrt:  [[0.15]]
grads:  [0.02045433]
Stock Position:  0.02045432691920453
Bond Position:  [9.15971191]


portfolio before change:  [11.26067127]
curr_Stock_Price:  102.60269912333773
curr_Factors:  [102.60269912]
mat_Sqrt:  [[0.15]]
grads:  [0.03826752]
Stock Position:  0.038267521233656836
Bond Position:  [7.33432031]


portfolio before change:  [11.23168232]
curr_Stock_Price:  101.79724426223335
curr_Factors:  [101.79724426]
mat_Sqrt:  [[0.15]]
grads:  [0.01118822]
Stock Position:  0.011188223218341458
Bond Position:  [10.09275203]


portfolio before change:  [11.22171144]
curr_Stock_Price:  100.6804997739967
curr_Factors:  [100.68049977]
mat_Sqrt:  [[0.15]]
grads:  [-0.00615783]
Stock Position:  -0.006157832677754667
Bond Position:  [11.84168511]


portfolio before change:  [11.22489576]
curr_Stock_Price:  100.6441998077156
curr_Factors:  [100.64419981]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466291]
Stock Position:  -0.014662911042652143
Bond Position:  [12.70063271]


portfolio before change:  [11.20340013]
curr_Stock_Price:  102.32675693350153
curr_Factors:  [102.32675693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142243]
Stock Position:  -0.001422425352929038
Bond Position:  [11.3489523]


portfolio before change:  [11.20895388]
curr_Stock_Price:  100.4172290816516
curr_Factors:  [100.41722908]
mat_Sqrt:  [[0.15]]
grads:  [-0.03597135]
Stock Position:  -0.035971349523618294
Bond Position:  [14.82109713]


portfolio before change:  [11.12659294]
curr_Stock_Price:  102.80987446316132
curr_Factors:  [102.80987446]
mat_Sqrt:  [[0.15]]
grads:  [-0.06406814]
Stock Position:  -0.06406814171168003
Bond Position:  [17.71343054]


portfolio before change:  [11.25735179]
curr_Stock_Price:  100.83806858042381
curr_Factors:  [100.83806858]
mat_Sqrt:  [[0.15]]
grads:  [-0.15185136]
Stock Position:  -0.15185135783958623
Bond Position:  [26.56974942]


portfolio before change:  [11.38495523]
curr_Stock_Price:  100.04149896166014
curr_Factors:  [100.04149896]
mat_Sqrt:  [[0.15]]
grads:  [0.00803354]
Stock Position:  0.008033535063212062
Bond Position:  [10.58126834]


portfolio before change:  [11.3813305]
curr_Stock_Price:  99.26097354842187
curr_Factors:  [99.26097355]
mat_Sqrt:  [[0.15]]
grads:  [0.00462584]
Stock Position:  0.00462584271003356
Bond Position:  [10.92216485]


portfolio before change:  [11.37518396]
curr_Stock_Price:  97.34187951828712
curr_Factors:  [97.34187952]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285767]
Stock Position:  -0.012857665233386427
Bond Position:  [12.62677326]


portfolio before change:  [11.37861189]
curr_Stock_Price:  97.32081478184156
curr_Factors:  [97.32081478]
mat_Sqrt:  [[0.15]]
grads:  [0.07816007]
Stock Position:  0.07816007306162275
Bond Position:  [3.7720099]


portfolio before change:  [11.38859624]
curr_Stock_Price:  97.43649060895221
curr_Factors:  [97.43649061]
mat_Sqrt:  [[0.15]]
grads:  [0.33819383]
Stock Position:  0.338193834796042
Bond Position:  [-21.56382417]


portfolio before change:  [11.26813773]
curr_Stock_Price:  97.09625116796407
curr_Factors:  [97.09625117]
mat_Sqrt:  [[0.15]]
grads:  [0.13911423]
Stock Position:  0.13911422713687183
Bond Position:  [-2.23933221]


portfolio before change:  [11.33342075]
curr_Stock_Price:  97.56955232071415
curr_Factors:  [97.56955232]
mat_Sqrt:  [[0.15]]
grads:  [0.02782615]
Stock Position:  0.027826153935395035
Bond Position:  [8.61843537]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.33342075]
Stock Price:  97.62602898474144
PL:  [11.33342075]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.33079515e-02]
 [-2.14944501e-03]
 [ 6.70941723e-03]
 [ 3.68902031e-03]
 [ 8.81706516e-03]
 [ 1.08939596e-03]
 [-1.22565524e-02]
 [ 4.66978688e-03]
 [ 1.29760314e-03]
 [-3.79413406e-02]
 [-8.60424128e-04]
 [-2.63543428e-02]
 [ 2.49051617e-03]
 [-4.63302707e-04]
 [-7.53899307e-04]
 [ 8.72940083e-03]
 [ 4.59901453e-02]
 [ 2.04490584e-02]
 [ 4.21929717e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [49.21093907]
curr_Stock_Price:  103.10244818436554
curr_Factors:  [103.10244818]
mat_Sqrt:  [[0.15]]
grads:  [-0.28871968]
Stock Position:  -0.28871967643950885
Bond Position:  [78.97864455]


portfolio before change:  [50.13481675]
curr_Stock_Price:  99.97093128846362
curr_Factors:  [99.97093129]
mat_Sqrt:  [[0.15]]
grads:  [-0.01432963]
Stock Position:  -0.014329633423755712
Bond Position:  [51.56736355]


portfolio before change:  [50.16646757]
curr_Stock_Price:  98.66193939913236
curr_Factors:  [98.6619394]
mat_Sqrt:  [[0.15]]
grads:  [0.04472945]
Stock Position:  0.044729448207572846
Bond Position:  [45.75337346]


portfolio before change:  [50.18457182]
curr_Stock_Price:  98.81093452068791
curr_Factors:  [98.81093452]
mat_Sqrt:  [[0.15]]
grads:  [0.02459347]
Stock Position:  0.024593468735191807
Bond Position:  [47.75446819]


portfolio before change:  [50.15876234]
curr_Stock_Price:  97.27599087751489
curr_Factors:  [97.27599088]
mat_Sqrt:  [[0.15]]
grads:  [0.05878043]
Stock Position:  0.058780434370918185
Bond Position:  [44.44083734]


portfolio before change:  [50.29610959]
curr_Stock_Price:  99.42357041871352
curr_Factors:  [99.42357042]
mat_Sqrt:  [[0.15]]
grads:  [0.00726264]
Stock Position:  0.007262639716456946
Bond Position:  [49.57403202]


portfolio before change:  [50.29718177]
curr_Stock_Price:  97.86451161342283
curr_Factors:  [97.86451161]
mat_Sqrt:  [[0.15]]
grads:  [-0.08171035]
Stock Position:  -0.08171034908804461
Bond Position:  [58.29372518]


portfolio before change:  [50.33257797]
curr_Stock_Price:  97.60969753442832
curr_Factors:  [97.60969753]
mat_Sqrt:  [[0.15]]
grads:  [0.03113191]
Stock Position:  0.031131912534240015
Bond Position:  [47.2938014]


portfolio before change:  [50.36104337]
curr_Stock_Price:  98.14421246849784
curr_Factors:  [98.14421247]
mat_Sqrt:  [[0.15]]
grads:  [0.00865069]
Stock Position:  0.008650687580648136
Bond Position:  [49.51202845]


portfolio before change:  [50.37770691]
curr_Stock_Price:  98.63943211962807
curr_Factors:  [98.63943212]
mat_Sqrt:  [[0.15]]
grads:  [-0.25294227]
Stock Position:  -0.2529422709831687
Bond Position:  [75.32778888]


portfolio before change:  [51.10062947]
curr_Stock_Price:  95.85583944474494
curr_Factors:  [95.85583944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573616]
Stock Position:  -0.005736160850774545
Bond Position:  [51.65047398]


portfolio before change:  [51.10815435]
curr_Stock_Price:  96.795378967983
curr_Factors:  [96.79537897]
mat_Sqrt:  [[0.15]]
grads:  [-0.17569562]
Stock Position:  -0.17569561859964786
Bond Position:  [68.11467834]


portfolio before change:  [51.29065819]
curr_Stock_Price:  95.85356243776086
curr_Factors:  [95.85356244]
mat_Sqrt:  [[0.15]]
grads:  [0.01660344]
Stock Position:  0.016603441158726112
Bond Position:  [49.6991592]


portfolio before change:  [51.32078591]
curr_Stock_Price:  96.91968981126158
curr_Factors:  [96.91968981]
mat_Sqrt:  [[0.15]]
grads:  [-0.00308868]
Stock Position:  -0.0030886847115000594
Bond Position:  [51.62014028]


portfolio before change:  [51.33856031]
curr_Stock_Price:  95.34369631988197
curr_Factors:  [95.34369632]
mat_Sqrt:  [[0.15]]
grads:  [-0.005026]
Stock Position:  -0.00502599538307124
Bond Position:  [51.81775729]


portfolio before change:  [51.35132999]
curr_Stock_Price:  95.38077860439778
curr_Factors:  [95.3807786]
mat_Sqrt:  [[0.15]]
grads:  [0.05819601]
Stock Position:  0.05819600556486113
Bond Position:  [45.80054967]


portfolio before change:  [51.41138537]
curr_Stock_Price:  96.21595299365278
curr_Factors:  [96.21595299]
mat_Sqrt:  [[0.15]]
grads:  [0.30660097]
Stock Position:  0.30660096847027696
Bond Position:  [21.911481]


portfolio before change:  [51.52247698]
curr_Stock_Price:  96.56041716495291
curr_Factors:  [96.56041716]
mat_Sqrt:  [[0.15]]
grads:  [0.13632706]
Stock Position:  0.13632705574316922
Bond Position:  [38.35867961]


portfolio before change:  [51.64788568]
curr_Stock_Price:  97.40997582032684
curr_Factors:  [97.40997582]
mat_Sqrt:  [[0.15]]
grads:  [0.02812865]
Stock Position:  0.028128647780659065
Bond Position:  [48.90787478]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [51.64788568]
Stock Price:  96.92476736382194
PL:  [51.64788568]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.20149307e-02]
 [-7.77481725e-03]
 [-3.23410341e-03]
 [ 3.70207564e-03]
 [ 8.10445440e-03]
 [ 5.84880895e-03]
 [-1.56511986e-02]
 [ 4.46152754e-03]
 [ 1.03175178e-03]
 [-3.72302336e-02]
 [-1.81776834e-03]
 [-2.51737256e-02]
 [ 2.11132003e-03]
 [ 4.55463389e-03]
 [-2.43427467e-03]
 [ 1.12258044e-02]
 [ 5.01002199e-02]
 [ 1.95350178e-02]
 [ 2.99085456e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.9611759]
curr_Stock_Price:  101.25508323052952
curr_Factors:  [101.25508323]
mat_Sqrt:  [[0.15]]
grads:  [-0.21343287]
Stock Position:  -0.21343287147837306
Bond Position:  [42.57233907]


portfolio before change:  [20.94964736]
curr_Stock_Price:  101.35897050474605
curr_Factors:  [101.3589705]
mat_Sqrt:  [[0.15]]
grads:  [-0.05183212]
Stock Position:  -0.051832115011153784
Bond Position:  [26.20329718]


portfolio before change:  [21.03526039]
curr_Stock_Price:  99.83363463119404
curr_Factors:  [99.83363463]
mat_Sqrt:  [[0.15]]
grads:  [-0.02156069]
Stock Position:  -0.021560689386809214
Bond Position:  [23.18774237]


portfolio before change:  [21.04781584]
curr_Stock_Price:  99.52020328953736
curr_Factors:  [99.52020329]
mat_Sqrt:  [[0.15]]
grads:  [0.0246805]
Stock Position:  0.024680504255449067
Bond Position:  [18.59160704]


portfolio before change:  [21.04911294]
curr_Stock_Price:  99.38441258655675
curr_Factors:  [99.38441259]
mat_Sqrt:  [[0.15]]
grads:  [0.0540297]
Stock Position:  0.05402969600627791
Bond Position:  [15.67940334]


portfolio before change:  [21.0233847]
curr_Stock_Price:  98.83566655446246
curr_Factors:  [98.83566655]
mat_Sqrt:  [[0.15]]
grads:  [0.03899206]
Stock Position:  0.03899205969198238
Bond Position:  [17.16957849]


portfolio before change:  [21.02688806]
curr_Stock_Price:  98.81541701395405
curr_Factors:  [98.81541701]
mat_Sqrt:  [[0.15]]
grads:  [-0.10434132]
Stock Position:  -0.10434132407218862
Bond Position:  [31.33741951]


portfolio before change:  [21.15178411]
curr_Stock_Price:  97.69351523640744
curr_Factors:  [97.69351524]
mat_Sqrt:  [[0.15]]
grads:  [0.02974352]
Stock Position:  0.029743516938533384
Bond Position:  [18.24603539]


portfolio before change:  [21.17520843]
curr_Stock_Price:  98.32767825423956
curr_Factors:  [98.32767825]
mat_Sqrt:  [[0.15]]
grads:  [0.00687835]
Stock Position:  0.006878345189305268
Bond Position:  [20.49887672]


portfolio before change:  [21.17712166]
curr_Stock_Price:  97.86068660501594
curr_Factors:  [97.86068661]
mat_Sqrt:  [[0.15]]
grads:  [-0.24820156]
Stock Position:  -0.24820155724059514
Bond Position:  [45.46629647]


portfolio before change:  [20.65616104]
curr_Stock_Price:  100.00542984461696
curr_Factors:  [100.00542984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01211846]
Stock Position:  -0.01211845557426516
Bond Position:  [21.8680724]


portfolio before change:  [20.66710033]
curr_Stock_Price:  99.55392179572449
curr_Factors:  [99.5539218]
mat_Sqrt:  [[0.15]]
grads:  [-0.16782484]
Stock Position:  -0.1678248374312964
Bond Position:  [37.37472107]


portfolio before change:  [20.74538588]
curr_Stock_Price:  99.14313214282976
curr_Factors:  [99.14313214]
mat_Sqrt:  [[0.15]]
grads:  [0.01407547]
Stock Position:  0.014075466854801403
Bond Position:  [19.34990001]


portfolio before change:  [20.74535741]
curr_Stock_Price:  98.79738531321176
curr_Factors:  [98.79738531]
mat_Sqrt:  [[0.15]]
grads:  [0.03036423]
Stock Position:  0.030364225922834127
Bond Position:  [17.74545129]


portfolio before change:  [20.73969655]
curr_Stock_Price:  98.46483015653465
curr_Factors:  [98.46483016]
mat_Sqrt:  [[0.15]]
grads:  [-0.0162285]
Stock Position:  -0.016228497774296732
Bond Position:  [22.33763283]


portfolio before change:  [20.73770409]
curr_Stock_Price:  98.93175993672
curr_Factors:  [98.93175994]
mat_Sqrt:  [[0.15]]
grads:  [0.0748387]
Stock Position:  0.07483869593477643
Bond Position:  [13.33378019]


portfolio before change:  [20.6731992]
curr_Stock_Price:  98.02529367764645
curr_Factors:  [98.02529368]
mat_Sqrt:  [[0.15]]
grads:  [0.33400147]
Stock Position:  0.3340014658968841
Bond Position:  [-12.06739259]


portfolio before change:  [20.01820888]
curr_Stock_Price:  96.07328699131634
curr_Factors:  [96.07328699]
mat_Sqrt:  [[0.15]]
grads:  [0.13023345]
Stock Position:  0.13023345207661238
Bond Position:  [7.50625306]


portfolio before change:  [19.99470386]
curr_Stock_Price:  95.87839222341398
curr_Factors:  [95.87839222]
mat_Sqrt:  [[0.15]]
grads:  [0.01993903]
Stock Position:  0.019939030377976192
Bond Position:  [18.08298168]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.99470386]
Stock Price:  96.09599615992926
PL:  [19.99470386]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.92083741e-02]
 [ 6.82675501e-03]
 [-1.00349157e-02]
 [ 3.66612932e-03]
 [ 8.81231282e-03]
 [ 1.45860143e-02]
 [-1.57930182e-02]
 [-8.66675529e-04]
 [ 2.20766029e-04]
 [-3.41963699e-02]
 [-1.07639729e-03]
 [-2.24925594e-02]
 [-1.99776775e-04]
 [-1.93093509e-02]
 [ 2.47329411e-03]
 [ 7.63052324e-03]
 [-4.52594331e-02]
 [-2.24880093e-02]
 [ 4.67552869e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.19171639]
curr_Stock_Price:  100.42003722195079
curr_Factors:  [100.42003722]
mat_Sqrt:  [[0.15]]
grads:  [0.26138916]
Stock Position:  0.2613891607911072
Bond Position:  [-18.05699286]


portfolio before change:  [7.82105831]
curr_Stock_Price:  99.01927801671373
curr_Factors:  [99.01927802]
mat_Sqrt:  [[0.15]]
grads:  [0.0455117]
Stock Position:  0.045511700075813136
Bond Position:  [3.31452263]


portfolio before change:  [7.87685533]
curr_Stock_Price:  100.22706169858075
curr_Factors:  [100.2270617]
mat_Sqrt:  [[0.15]]
grads:  [-0.06689944]
Stock Position:  -0.06689943768852734
Bond Position:  [14.5819894]


portfolio before change:  [7.97649031]
curr_Stock_Price:  98.7922361722034
curr_Factors:  [98.79223617]
mat_Sqrt:  [[0.15]]
grads:  [0.02444086]
Stock Position:  0.024440862125267148
Bond Position:  [5.56192288]


portfolio before change:  [7.94135805]
curr_Stock_Price:  97.29789823726176
curr_Factors:  [97.29789824]
mat_Sqrt:  [[0.15]]
grads:  [0.05874875]
Stock Position:  0.05874875215142704
Bond Position:  [2.22522794]


portfolio before change:  [7.98946624]
curr_Stock_Price:  98.107307907441
curr_Factors:  [98.10730791]
mat_Sqrt:  [[0.15]]
grads:  [0.0972401]
Stock Position:  0.0972400950560448
Bond Position:  [-1.55049771]


portfolio before change:  [8.11495464]
curr_Stock_Price:  99.40179530313539
curr_Factors:  [99.4017953]
mat_Sqrt:  [[0.15]]
grads:  [-0.10528679]
Stock Position:  -0.1052867878181176
Bond Position:  [18.58065037]


portfolio before change:  [8.12196235]
curr_Stock_Price:  99.37936167064522
curr_Factors:  [99.37936167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00577784]
Stock Position:  -0.005777836858109519
Bond Position:  [8.69616009]


portfolio before change:  [8.12675897]
curr_Stock_Price:  98.9255061076439
curr_Factors:  [98.92550611]
mat_Sqrt:  [[0.15]]
grads:  [0.00147177]
Stock Position:  0.0014717735278465863
Bond Position:  [7.98116302]


portfolio before change:  [8.12908233]
curr_Stock_Price:  99.14824632361162
curr_Factors:  [99.14824632]
mat_Sqrt:  [[0.15]]
grads:  [-0.2279758]
Stock Position:  -0.22797579951043614
Bond Position:  [30.73248305]


portfolio before change:  [8.06417385]
curr_Stock_Price:  99.4666685383701
curr_Factors:  [99.46666854]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717598]
Stock Position:  -0.007175981936927619
Bond Position:  [8.77794487]


portfolio before change:  [8.05434433]
curr_Stock_Price:  101.1422972929
curr_Factors:  [101.14229729]
mat_Sqrt:  [[0.15]]
grads:  [-0.1499504]
Stock Position:  -0.14995039624579057
Bond Position:  [23.22067189]


portfolio before change:  [7.96987084]
curr_Stock_Price:  101.74435897955614
curr_Factors:  [101.74435898]
mat_Sqrt:  [[0.15]]
grads:  [-0.00133185]
Stock Position:  -0.0013318451673098412
Bond Position:  [8.10537857]


portfolio before change:  [7.96992413]
curr_Stock_Price:  103.22599114554262
curr_Factors:  [103.22599115]
mat_Sqrt:  [[0.15]]
grads:  [-0.12872901]
Stock Position:  -0.12872900593832
Bond Position:  [21.25810336]


portfolio before change:  [7.98437317]
curr_Stock_Price:  103.15503706777713
curr_Factors:  [103.15503707]
mat_Sqrt:  [[0.15]]
grads:  [0.01648863]
Stock Position:  0.016488627371130292
Bond Position:  [6.2834882]


portfolio before change:  [8.01353778]
curr_Stock_Price:  104.82852681895766
curr_Factors:  [104.82852682]
mat_Sqrt:  [[0.15]]
grads:  [0.05087015]
Stock Position:  0.05087015490124108
Bond Position:  [2.68089439]


portfolio before change:  [7.96005383]
curr_Stock_Price:  103.76396828084343
curr_Factors:  [103.76396828]
mat_Sqrt:  [[0.15]]
grads:  [-0.30172955]
Stock Position:  -0.30172955386547584
Bond Position:  [39.26870969]


portfolio before change:  [7.82594032]
curr_Stock_Price:  104.24099123229355
curr_Factors:  [104.24099123]
mat_Sqrt:  [[0.15]]
grads:  [-0.14992006]
Stock Position:  -0.14992006229602647
Bond Position:  [23.45375622]


portfolio before change:  [8.01192853]
curr_Stock_Price:  103.0395240265214
curr_Factors:  [103.03952403]
mat_Sqrt:  [[0.15]]
grads:  [0.03117019]
Stock Position:  0.031170191296188567
Bond Position:  [4.80016685]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.01192853]
Stock Price:  103.46461579771069
PL:  [4.54731273]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.03386334e-02]
 [-7.66686798e-03]
 [ 9.54647738e-04]
 [ 2.83354795e-03]
 [ 6.61075847e-03]
 [ 2.28977149e-03]
 [-1.56672890e-02]
 [-2.14616788e-03]
 [-1.30279210e-03]
 [-1.10777243e-02]
 [-1.07621689e-03]
 [-2.26692285e-02]
 [ 1.25187420e-04]
 [-1.73378834e-02]
 [-1.73257579e-03]
 [ 1.05741393e-02]
 [-1.62455711e-02]
 [ 1.95787721e-02]
 [ 3.80455822e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.25957692]
curr_Stock_Price:  101.47077886001787
curr_Factors:  [101.47077886]
mat_Sqrt:  [[0.15]]
grads:  [-0.26892422]
Stock Position:  -0.26892422285837847
Bond Position:  [51.54752727]


portfolio before change:  [24.2335077]
curr_Stock_Price:  101.61564389105594
curr_Factors:  [101.61564389]
mat_Sqrt:  [[0.15]]
grads:  [-0.05111245]
Stock Position:  -0.05111245321645745
Bond Position:  [29.42733255]


portfolio before change:  [24.23118781]
curr_Stock_Price:  101.80498420156466
curr_Factors:  [101.8049842]
mat_Sqrt:  [[0.15]]
grads:  [0.00636432]
Stock Position:  0.0063643182532029455
Bond Position:  [23.58326849]


portfolio before change:  [24.23509281]
curr_Stock_Price:  101.49205896799204
curr_Factors:  [101.49205897]
mat_Sqrt:  [[0.15]]
grads:  [0.01889032]
Stock Position:  0.018890319651668014
Bond Position:  [22.31787537]


portfolio before change:  [24.23467938]
curr_Stock_Price:  101.17477500226397
curr_Factors:  [101.174775]
mat_Sqrt:  [[0.15]]
grads:  [0.04407172]
Stock Position:  0.04407172315064239
Bond Position:  [19.7757327]


portfolio before change:  [24.17403993]
curr_Stock_Price:  99.68665528060468
curr_Factors:  [99.68665528]
mat_Sqrt:  [[0.15]]
grads:  [0.01526514]
Stock Position:  0.01526514328045625
Bond Position:  [22.65230885]


portfolio before change:  [24.16694827]
curr_Stock_Price:  98.85106254398245
curr_Factors:  [98.85106254]
mat_Sqrt:  [[0.15]]
grads:  [-0.10444859]
Stock Position:  -0.10444859336392064
Bond Position:  [34.4918027]


portfolio before change:  [24.04861857]
curr_Stock_Price:  100.06652870189464
curr_Factors:  [100.0665287]
mat_Sqrt:  [[0.15]]
grads:  [-0.01430779]
Stock Position:  -0.014307785894092345
Bond Position:  [25.48034903]


portfolio before change:  [24.04180297]
curr_Stock_Price:  100.98815825352925
curr_Factors:  [100.98815825]
mat_Sqrt:  [[0.15]]
grads:  [-0.00868528]
Stock Position:  -0.008685280666529627
Bond Position:  [24.91891347]


portfolio before change:  [24.05592826]
curr_Stock_Price:  100.07917425708834
curr_Factors:  [100.07917426]
mat_Sqrt:  [[0.15]]
grads:  [-0.0738515]
Stock Position:  -0.07385149561942236
Bond Position:  [31.44692496]


portfolio before change:  [24.10928469]
curr_Stock_Price:  99.46315809233988
curr_Factors:  [99.46315809]
mat_Sqrt:  [[0.15]]
grads:  [-0.00717478]
Stock Position:  -0.007174779245094909
Bond Position:  [24.82291089]


portfolio before change:  [24.10511124]
curr_Stock_Price:  100.90988541582328
curr_Factors:  [100.90988542]
mat_Sqrt:  [[0.15]]
grads:  [-0.15112819]
Stock Position:  -0.15112818999152616
Bond Position:  [39.35543958]


portfolio before change:  [24.08208567]
curr_Stock_Price:  101.1273541771507
curr_Factors:  [101.12735418]
mat_Sqrt:  [[0.15]]
grads:  [0.00083458]
Stock Position:  0.0008345827986996597
Bond Position:  [23.99768652]


portfolio before change:  [24.08875084]
curr_Stock_Price:  101.92415250402136
curr_Factors:  [101.9241525]
mat_Sqrt:  [[0.15]]
grads:  [-0.11558589]
Stock Position:  -0.11558588905704575
Bond Position:  [35.86974462]


portfolio before change:  [24.14624258]
curr_Stock_Price:  101.50435056002735
curr_Factors:  [101.50435056]
mat_Sqrt:  [[0.15]]
grads:  [-0.01155051]
Stock Position:  -0.011550505257692288
Bond Position:  [25.31866911]


portfolio before change:  [24.15523246]
curr_Stock_Price:  101.27410771914742
curr_Factors:  [101.27410772]
mat_Sqrt:  [[0.15]]
grads:  [0.07049426]
Stock Position:  0.07049426227666555
Bond Position:  [17.01598895]


portfolio before change:  [24.14900098]
curr_Stock_Price:  101.12535786469395
curr_Factors:  [101.12535786]
mat_Sqrt:  [[0.15]]
grads:  [-0.10830381]
Stock Position:  -0.10830380703856918
Bond Position:  [35.10126222]


portfolio before change:  [24.41776371]
curr_Stock_Price:  98.7248298659658
curr_Factors:  [98.72482987]
mat_Sqrt:  [[0.15]]
grads:  [0.13052515]
Stock Position:  0.13052514760871733
Bond Position:  [11.53169072]


portfolio before change:  [24.54589066]
curr_Stock_Price:  99.68436657945993
curr_Factors:  [99.68436658]
mat_Sqrt:  [[0.15]]
grads:  [0.02536372]
Stock Position:  0.025363721453435087
Bond Position:  [22.01752416]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.54589066]
Stock Price:  97.78191721886687
PL:  [24.54589066]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.78651236e-02]
 [-8.00748699e-04]
 [-1.04056426e-02]
 [ 2.51500276e-03]
 [ 6.50538293e-03]
 [ 1.11057975e-02]
 [-1.57740109e-02]
 [-1.13219425e-03]
 [-3.98318118e-04]
 [-1.65412336e-02]
 [-1.09406212e-03]
 [-2.54677158e-02]
 [ 1.06808195e-03]
 [-4.90087908e-04]
 [-2.17239500e-03]
 [ 1.13924128e-02]
 [ 3.83958473e-02]
 [-9.10222736e-03]
 [ 4.60021462e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.18053705]
curr_Stock_Price:  99.96154817441948
curr_Factors:  [99.96154817]
mat_Sqrt:  [[0.15]]
grads:  [0.18576749]
Stock Position:  0.18576749096548203
Bond Position:  [-17.38906895]


portfolio before change:  [1.15802974]
curr_Stock_Price:  99.86379429439054
curr_Factors:  [99.86379429]
mat_Sqrt:  [[0.15]]
grads:  [-0.00533832]
Stock Position:  -0.005338324663212213
Bond Position:  [1.6911351]


portfolio before change:  [1.15418645]
curr_Stock_Price:  100.66294577840692
curr_Factors:  [100.66294578]
mat_Sqrt:  [[0.15]]
grads:  [-0.06937095]
Stock Position:  -0.0693709506722439
Bond Position:  [8.1372707]


portfolio before change:  [1.11163633]
curr_Stock_Price:  101.30564547932516
curr_Factors:  [101.30564548]
mat_Sqrt:  [[0.15]]
grads:  [0.01676669]
Stock Position:  0.016766685096166172
Bond Position:  [-0.58692352]


portfolio before change:  [1.11154344]
curr_Stock_Price:  101.30885738565316
curr_Factors:  [101.30885739]
mat_Sqrt:  [[0.15]]
grads:  [0.04336922]
Stock Position:  0.043369219555665896
Bond Position:  [-3.28214264]


portfolio before change:  [1.08956585]
curr_Stock_Price:  100.82102413797813
curr_Factors:  [100.82102414]
mat_Sqrt:  [[0.15]]
grads:  [0.07403865]
Stock Position:  0.07403864975068708
Bond Position:  [-6.37508664]


portfolio before change:  [0.95962311]
curr_Stock_Price:  99.08748672344335
curr_Factors:  [99.08748672]
mat_Sqrt:  [[0.15]]
grads:  [-0.10516007]
Stock Position:  -0.10516007259452533
Bond Position:  [11.37967041]


portfolio before change:  [0.91921078]
curr_Stock_Price:  99.49883684560724
curr_Factors:  [99.49883685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00754796]
Stock Position:  -0.0075479616550375005
Bond Position:  [1.67022418]


portfolio before change:  [0.91864654]
curr_Stock_Price:  99.62891801348496
curr_Factors:  [99.62891801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00265545]
Stock Position:  -0.0026554541200189703
Bond Position:  [1.18320656]


portfolio before change:  [0.91819541]
curr_Stock_Price:  99.9102139339216
curr_Factors:  [99.91021393]
mat_Sqrt:  [[0.15]]
grads:  [-0.11027489]
Stock Position:  -0.11027489038519439
Bond Position:  [11.9357833]


portfolio before change:  [0.95091751]
curr_Stock_Price:  99.64054435606911
curr_Factors:  [99.64054436]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729375]
Stock Position:  -0.0072937474857462615
Bond Position:  [1.67767048]


portfolio before change:  [0.953695]
curr_Stock_Price:  99.31725082742487
curr_Factors:  [99.31725083]
mat_Sqrt:  [[0.15]]
grads:  [-0.16978477]
Stock Position:  -0.16978477209011691
Bond Position:  [17.8162518]


portfolio before change:  [0.82126731]
curr_Stock_Price:  100.12346161552642
curr_Factors:  [100.12346162]
mat_Sqrt:  [[0.15]]
grads:  [0.00712055]
Stock Position:  0.007120546354241731
Bond Position:  [0.10833356]


portfolio before change:  [0.81677665]
curr_Stock_Price:  99.48899643946378
curr_Factors:  [99.48899644]
mat_Sqrt:  [[0.15]]
grads:  [-0.00326725]
Stock Position:  -0.0032672527232534337
Bond Position:  [1.14183235]


portfolio before change:  [0.82227728]
curr_Stock_Price:  97.8928122040556
curr_Factors:  [97.8928122]
mat_Sqrt:  [[0.15]]
grads:  [-0.01448263]
Stock Position:  -0.014482633361088607
Bond Position:  [2.24002299]


portfolio before change:  [0.81063787]
curr_Stock_Price:  98.73516539528627
curr_Factors:  [98.7351654]
mat_Sqrt:  [[0.15]]
grads:  [0.07594942]
Stock Position:  0.07594941898512567
Bond Position:  [-6.68824058]


portfolio before change:  [0.88432954]
curr_Stock_Price:  99.72745666441934
curr_Factors:  [99.72745666]
mat_Sqrt:  [[0.15]]
grads:  [0.25597232]
Stock Position:  0.25597231522539426
Bond Position:  [-24.64313843]


portfolio before change:  [1.28841238]
curr_Stock_Price:  101.3301471353956
curr_Factors:  [101.33014714]
mat_Sqrt:  [[0.15]]
grads:  [-0.06068152]
Stock Position:  -0.06068151570672182
Bond Position:  [7.4372793]


portfolio before change:  [1.21560855]
curr_Stock_Price:  102.56056102585555
curr_Factors:  [102.56056103]
mat_Sqrt:  [[0.15]]
grads:  [0.0306681]
Stock Position:  0.030668097459138205
Bond Position:  [-1.92972873]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.21560855]
Stock Price:  101.05587027520065
PL:  [0.15973828]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.79607308e-02]
 [-8.06157127e-03]
 [-5.39314478e-03]
 [ 2.37523598e-03]
 [ 6.99182195e-03]
 [ 1.09307597e-02]
 [-3.18643706e-03]
 [ 7.47770219e-04]
 [-1.82691368e-04]
 [ 3.03340292e-02]
 [-1.10433173e-02]
 [-1.97311932e-02]
 [-1.13043323e-03]
 [-2.03292683e-02]
 [ 9.73091143e-05]
 [ 8.83565124e-03]
 [-4.41134370e-02]
 [-2.38325025e-02]
 [ 3.83805780e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.74124867]
curr_Stock_Price:  100.71754932612178
curr_Factors:  [100.71754933]
mat_Sqrt:  [[0.15]]
grads:  [0.11973821]
Stock Position:  0.11973820533745706
Bond Position:  [0.68151007]


portfolio before change:  [12.73016599]
curr_Stock_Price:  100.62356861081307
curr_Factors:  [100.62356861]
mat_Sqrt:  [[0.15]]
grads:  [-0.05374381]
Stock Position:  -0.05374380849183777
Bond Position:  [18.13805979]


portfolio before change:  [12.77028946]
curr_Stock_Price:  99.96138269729231
curr_Factors:  [99.9613827]
mat_Sqrt:  [[0.15]]
grads:  [-0.0359543]
Stock Position:  -0.03595429853645302
Bond Position:  [16.36433086]


portfolio before change:  [12.7289898]
curr_Stock_Price:  101.22385358701055
curr_Factors:  [101.22385359]
mat_Sqrt:  [[0.15]]
grads:  [0.01583491]
Stock Position:  0.015834906553092994
Bond Position:  [11.12611954]


portfolio before change:  [12.7223721]
curr_Stock_Price:  100.63025510139983
curr_Factors:  [100.6302551]
mat_Sqrt:  [[0.15]]
grads:  [0.04661215]
Stock Position:  0.04661214630368603
Bond Position:  [8.03177993]


portfolio before change:  [12.73132138]
curr_Stock_Price:  100.77916654513899
curr_Factors:  [100.77916655]
mat_Sqrt:  [[0.15]]
grads:  [0.07287173]
Stock Position:  0.07287173137287269
Bond Position:  [5.38736903]


portfolio before change:  [12.87956118]
curr_Stock_Price:  102.79493852816711
curr_Factors:  [102.79493853]
mat_Sqrt:  [[0.15]]
grads:  [-0.02124291]
Stock Position:  -0.02124291375248518
Bond Position:  [15.0632252]


portfolio before change:  [12.87538297]
curr_Stock_Price:  103.16892145012163
curr_Factors:  [103.16892145]
mat_Sqrt:  [[0.15]]
grads:  [0.00498513]
Stock Position:  0.004985134790305065
Bond Position:  [12.361072]


portfolio before change:  [12.8744717]
curr_Stock_Price:  102.36614798582842
curr_Factors:  [102.36614799]
mat_Sqrt:  [[0.15]]
grads:  [-0.00121794]
Stock Position:  -0.0012179424561924775
Bond Position:  [12.99914777]


portfolio before change:  [12.87789594]
curr_Stock_Price:  102.22324480290786
curr_Factors:  [102.2232448]
mat_Sqrt:  [[0.15]]
grads:  [0.20222686]
Stock Position:  0.20222686114835775
Bond Position:  [-7.79439]


portfolio before change:  [13.10313692]
curr_Stock_Price:  103.3466852111216
curr_Factors:  [103.34668521]
mat_Sqrt:  [[0.15]]
grads:  [-0.07362212]
Stock Position:  -0.07362211545531543
Bond Position:  [20.71173851]


portfolio before change:  [13.04518617]
curr_Stock_Price:  104.20416313223637
curr_Factors:  [104.20416313]
mat_Sqrt:  [[0.15]]
grads:  [-0.13154129]
Stock Position:  -0.131541287786265
Bond Position:  [26.75233598]


portfolio before change:  [13.11287127]
curr_Stock_Price:  103.74045944546978
curr_Factors:  [103.74045945]
mat_Sqrt:  [[0.15]]
grads:  [-0.00753622]
Stock Position:  -0.0075362215603976684
Bond Position:  [13.89468235]


portfolio before change:  [13.11536028]
curr_Stock_Price:  103.87117379349404
curr_Factors:  [103.87117379]
mat_Sqrt:  [[0.15]]
grads:  [-0.13552846]
Stock Position:  -0.1355284551024975
Bond Position:  [27.19285999]


portfolio before change:  [13.32813849]
curr_Stock_Price:  102.35135163108839
curr_Factors:  [102.35135163]
mat_Sqrt:  [[0.15]]
grads:  [0.00064873]
Stock Position:  0.0006487274288153815
Bond Position:  [13.26174036]


portfolio before change:  [13.33148789]
curr_Stock_Price:  102.40305963040656
curr_Factors:  [102.40305963]
mat_Sqrt:  [[0.15]]
grads:  [0.05890434]
Stock Position:  0.05890434162330189
Bond Position:  [7.29950308]


portfolio before change:  [13.38020472]
curr_Stock_Price:  103.19912543571631
curr_Factors:  [103.19912544]
mat_Sqrt:  [[0.15]]
grads:  [-0.29408958]
Stock Position:  -0.29408958021690285
Bond Position:  [43.7299922]


portfolio before change:  [13.76645109]
curr_Stock_Price:  101.92294113705117
curr_Factors:  [101.92294114]
mat_Sqrt:  [[0.15]]
grads:  [-0.15888335]
Stock Position:  -0.1588833500653107
Bond Position:  [29.96030943]


portfolio before change:  [13.86680035]
curr_Stock_Price:  101.33849824839855
curr_Factors:  [101.33849825]
mat_Sqrt:  [[0.15]]
grads:  [0.02558705]
Stock Position:  0.025587051984438315
Bond Position:  [11.27384693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.86680035]
Stock Price:  101.8918044224513
PL:  [11.97499593]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.46901894e-02]
 [-7.97836125e-03]
 [-1.04230269e-03]
 [ 2.52402444e-03]
 [ 8.19055675e-03]
 [ 1.21673120e-02]
 [-1.50735588e-02]
 [ 1.82113553e-03]
 [ 5.33205025e-04]
 [-1.58602640e-04]
 [-4.60009678e-03]
 [-2.24369547e-02]
 [ 1.66332330e-04]
 [-6.27606709e-04]
 [-2.23367800e-03]
 [ 8.79223261e-03]
 [ 4.88866789e-02]
 [ 1.95085215e-02]
 [ 3.88810236e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.28418203]
curr_Stock_Price:  99.08103636275388
curr_Factors:  [99.08103636]
mat_Sqrt:  [[0.15]]
grads:  [0.16460126]
Stock Position:  0.16460126238221348
Bond Position:  [-28.5930457]


portfolio before change:  [-12.05189481]
curr_Stock_Price:  100.53568123251202
curr_Factors:  [100.53568123]
mat_Sqrt:  [[0.15]]
grads:  [-0.05318908]
Stock Position:  -0.053189075015342105
Bond Position:  [-6.70449492]


portfolio before change:  [-12.11417072]
curr_Stock_Price:  101.6750050758253
curr_Factors:  [101.67500508]
mat_Sqrt:  [[0.15]]
grads:  [-0.00694868]
Stock Position:  -0.006948684572940697
Bond Position:  [-11.40766318]


portfolio before change:  [-12.12230944]
curr_Stock_Price:  102.43578890315374
curr_Factors:  [102.4357889]
mat_Sqrt:  [[0.15]]
grads:  [0.01682683]
Stock Position:  0.016826829625395674
Bond Position:  [-13.84597901]


portfolio before change:  [-12.17890183]
curr_Stock_Price:  99.27830369297268
curr_Factors:  [99.27830369]
mat_Sqrt:  [[0.15]]
grads:  [0.05460371]
Stock Position:  0.0546037116887074
Bond Position:  [-17.59986571]


portfolio before change:  [-12.23536981]
curr_Stock_Price:  98.32475196813817
curr_Factors:  [98.32475197]
mat_Sqrt:  [[0.15]]
grads:  [0.08111541]
Stock Position:  0.08111541323685105
Bond Position:  [-20.2110227]


portfolio before change:  [-12.21766325]
curr_Stock_Price:  98.60533916855921
curr_Factors:  [98.60533917]
mat_Sqrt:  [[0.15]]
grads:  [-0.10049039]
Stock Position:  -0.10049039203568953
Bond Position:  [-2.30877406]


portfolio before change:  [-12.20790033]
curr_Stock_Price:  98.50244190670007
curr_Factors:  [98.50244191]
mat_Sqrt:  [[0.15]]
grads:  [0.0121409]
Stock Position:  0.01214090351899576
Bond Position:  [-13.40380898]


portfolio before change:  [-12.20918448]
curr_Stock_Price:  98.67271151094981
curr_Factors:  [98.67271151]
mat_Sqrt:  [[0.15]]
grads:  [0.0035547]
Stock Position:  0.003554700165616818
Bond Position:  [-12.55993638]


portfolio before change:  [-12.20505642]
curr_Stock_Price:  100.71745090389122
curr_Factors:  [100.7174509]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105735]
Stock Position:  -0.0010573509312430808
Bond Position:  [-12.09856273]


portfolio before change:  [-12.20815349]
curr_Stock_Price:  100.78559347020983
curr_Factors:  [100.78559347]
mat_Sqrt:  [[0.15]]
grads:  [-0.03066731]
Stock Position:  -0.03066731188804196
Bond Position:  [-9.11733026]


portfolio before change:  [-12.22425684]
curr_Stock_Price:  101.23635774844776
curr_Factors:  [101.23635775]
mat_Sqrt:  [[0.15]]
grads:  [-0.1495797]
Stock Position:  -0.14957969782324582
Bond Position:  [2.91864697]


portfolio before change:  [-12.19724471]
curr_Stock_Price:  101.0606495829615
curr_Factors:  [101.06064958]
mat_Sqrt:  [[0.15]]
grads:  [0.00110888]
Stock Position:  0.0011088822009352526
Bond Position:  [-12.30930906]


portfolio before change:  [-12.20202831]
curr_Stock_Price:  99.52226440921062
curr_Factors:  [99.52226441]
mat_Sqrt:  [[0.15]]
grads:  [-0.00418404]
Stock Position:  -0.0041840447264685525
Bond Position:  [-11.7856227]


portfolio before change:  [-12.19871745]
curr_Stock_Price:  98.02667129905205
curr_Factors:  [98.0266713]
mat_Sqrt:  [[0.15]]
grads:  [-0.01489119]
Stock Position:  -0.014891186675413335
Bond Position:  [-10.73898399]


portfolio before change:  [-12.16250312]
curr_Stock_Price:  95.41442732430365
curr_Factors:  [95.41442732]
mat_Sqrt:  [[0.15]]
grads:  [0.05861488]
Stock Position:  0.05861488408618515
Bond Position:  [-17.75520872]


portfolio before change:  [-12.07594494]
curr_Stock_Price:  96.96689203090743
curr_Factors:  [96.96689203]
mat_Sqrt:  [[0.15]]
grads:  [0.32591119]
Stock Position:  0.32591119282139297
Bond Position:  [-43.67854039]


portfolio before change:  [-11.48499285]
curr_Stock_Price:  98.8136315870249
curr_Factors:  [98.81363159]
mat_Sqrt:  [[0.15]]
grads:  [0.13005681]
Stock Position:  0.13005680975967782
Bond Position:  [-24.33637853]


portfolio before change:  [-11.4823676]
curr_Stock_Price:  98.88060311079134
curr_Factors:  [98.88060311]
mat_Sqrt:  [[0.15]]
grads:  [0.02592068]
Stock Position:  0.025920682421607406
Bond Position:  [-14.04542031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.4823676]
Stock Price:  98.50901607882793
PL:  [-11.4823676]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.73486122e-02]
 [ 9.09324925e-03]
 [ 4.16684036e-03]
 [ 3.37681425e-03]
 [ 8.42410669e-03]
 [ 2.97202392e-03]
 [-1.25883528e-02]
 [-6.51736675e-04]
 [-1.90132931e-04]
 [-4.99280919e-03]
 [-1.31082865e-03]
 [-2.52672223e-02]
 [ 2.29060177e-03]
 [-6.05836429e-04]
 [-2.36375236e-03]
 [ 1.16413067e-02]
 [ 4.91998872e-02]
 [ 1.93275665e-02]
 [ 4.13779635e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.11252884]
curr_Stock_Price:  98.89607945792699
curr_Factors:  [98.89607946]
mat_Sqrt:  [[0.15]]
grads:  [0.31565741]
Stock Position:  0.31565741495891425
Bond Position:  [-46.32980963]


portfolio before change:  [-15.6513949]
curr_Stock_Price:  97.22565405925039
curr_Factors:  [97.22565406]
mat_Sqrt:  [[0.15]]
grads:  [0.06062166]
Stock Position:  0.06062166163953544
Bond Position:  [-21.5453756]


portfolio before change:  [-15.54917528]
curr_Stock_Price:  99.00070657427064
curr_Factors:  [99.00070657]
mat_Sqrt:  [[0.15]]
grads:  [0.02777894]
Stock Position:  0.02777893570498275
Bond Position:  [-18.29930955]


portfolio before change:  [-15.56610663]
curr_Stock_Price:  98.55591115767955
curr_Factors:  [98.55591116]
mat_Sqrt:  [[0.15]]
grads:  [0.0225121]
Stock Position:  0.022512095029245147
Bond Position:  [-17.78480666]


portfolio before change:  [-15.56389025]
curr_Stock_Price:  98.85189145142643
curr_Factors:  [98.85189145]
mat_Sqrt:  [[0.15]]
grads:  [0.05616071]
Stock Position:  0.05616071125108994
Bond Position:  [-21.11548278]


portfolio before change:  [-15.51881882]
curr_Stock_Price:  99.74844277350604
curr_Factors:  [99.74844277]
mat_Sqrt:  [[0.15]]
grads:  [0.01981349]
Stock Position:  0.01981349280651218
Bond Position:  [-17.49518387]


portfolio before change:  [-15.52145494]
curr_Stock_Price:  99.83617164268844
curr_Factors:  [99.83617164]
mat_Sqrt:  [[0.15]]
grads:  [-0.08392235]
Stock Position:  -0.08392235224951033
Bond Position:  [-7.14296858]


portfolio before change:  [-15.47678772]
curr_Stock_Price:  99.28264586402902
curr_Factors:  [99.28264586]
mat_Sqrt:  [[0.15]]
grads:  [-0.00434491]
Stock Position:  -0.0043449111678924126
Bond Position:  [-15.04541345]


portfolio before change:  [-15.48085011]
curr_Stock_Price:  99.35182132653917
curr_Factors:  [99.35182133]
mat_Sqrt:  [[0.15]]
grads:  [-0.00126755]
Stock Position:  -0.001267552874160257
Bond Position:  [-15.35491642]


portfolio before change:  [-15.4860822]
curr_Stock_Price:  100.4506989628243
curr_Factors:  [100.45069896]
mat_Sqrt:  [[0.15]]
grads:  [-0.03328539]
Stock Position:  -0.03328539459194326
Bond Position:  [-12.14254105]


portfolio before change:  [-15.46765326]
curr_Stock_Price:  99.8058226228486
curr_Factors:  [99.80582262]
mat_Sqrt:  [[0.15]]
grads:  [-0.00873886]
Stock Position:  -0.008738857662545941
Bond Position:  [-14.59546438]


portfolio before change:  [-15.4684435]
curr_Stock_Price:  99.47865413360385
curr_Factors:  [99.47865413]
mat_Sqrt:  [[0.15]]
grads:  [-0.16844815]
Stock Position:  -0.16844814877674147
Bond Position:  [1.28855163]


portfolio before change:  [-15.35626747]
curr_Stock_Price:  98.81462873996979
curr_Factors:  [98.81462874]
mat_Sqrt:  [[0.15]]
grads:  [0.01527068]
Stock Position:  0.015270678453621638
Bond Position:  [-16.86523389]


portfolio before change:  [-15.34975866]
curr_Stock_Price:  99.51699783459651
curr_Factors:  [99.51699783]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403891]
Stock Position:  -0.004038909525033892
Bond Position:  [-14.9478185]


portfolio before change:  [-15.34862431]
curr_Stock_Price:  98.31078984132236
curr_Factors:  [98.31078984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01575835]
Stock Position:  -0.015758349060671605
Bond Position:  [-13.79940857]


portfolio before change:  [-15.35402475]
curr_Stock_Price:  98.43454377091876
curr_Factors:  [98.43454377]
mat_Sqrt:  [[0.15]]
grads:  [0.07760871]
Stock Position:  0.07760871100436949
Bond Position:  [-22.99340281]


portfolio before change:  [-15.33236756]
curr_Stock_Price:  98.78767761493863
curr_Factors:  [98.78767761]
mat_Sqrt:  [[0.15]]
grads:  [0.32799925]
Stock Position:  0.32799924791973656
Bond Position:  [-47.73465152]


portfolio before change:  [-15.26076343]
curr_Stock_Price:  99.04237114471198
curr_Factors:  [99.04237114]
mat_Sqrt:  [[0.15]]
grads:  [0.12885044]
Stock Position:  0.12885044358614303
Bond Position:  [-28.02241688]


portfolio before change:  [-15.44117224]
curr_Stock_Price:  97.69660679217759
curr_Factors:  [97.69660679]
mat_Sqrt:  [[0.15]]
grads:  [0.02758531]
Stock Position:  0.027585308976784684
Bond Position:  [-18.13616333]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.44117224]
Stock Price:  98.98828914237471
PL:  [-15.44117224]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.77850739e-02]
 [-3.02026810e-03]
 [-1.03520928e-02]
 [ 2.30340148e-03]
 [ 7.07907403e-03]
 [ 8.88309820e-03]
 [-1.56315130e-02]
 [-2.26957371e-03]
 [ 7.33475074e-04]
 [-3.60740572e-02]
 [-1.02288176e-03]
 [-2.63424831e-02]
 [ 2.53975020e-03]
 [-1.01448590e-03]
 [-1.68248653e-03]
 [ 1.14975350e-02]
 [ 7.22649619e-03]
 [ 5.54145664e-03]
 [ 3.83948018e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.09311422]
curr_Stock_Price:  99.95583124625837
curr_Factors:  [99.95583125]
mat_Sqrt:  [[0.15]]
grads:  [0.18523383]
Stock Position:  0.18523382612147155
Bond Position:  [-17.42208684]


portfolio before change:  [1.10436892]
curr_Stock_Price:  100.04010725279603
curr_Factors:  [100.04010725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02013512]
Stock Position:  -0.020135120683336862
Bond Position:  [3.11868856]


portfolio before change:  [1.09155752]
curr_Stock_Price:  100.71510563016011
curr_Factors:  [100.71510563]
mat_Sqrt:  [[0.15]]
grads:  [-0.06901395]
Stock Position:  -0.0690139522845487
Bond Position:  [8.04230501]


portfolio before change:  [1.06765058]
curr_Stock_Price:  101.09064952734073
curr_Factors:  [101.09064953]
mat_Sqrt:  [[0.15]]
grads:  [0.01535601]
Stock Position:  0.01535600985753289
Bond Position:  [-0.48469843]


portfolio before change:  [1.05863659]
curr_Stock_Price:  100.5115408695299
curr_Factors:  [100.51154087]
mat_Sqrt:  [[0.15]]
grads:  [0.04719383]
Stock Position:  0.047193826839149015
Bond Position:  [-3.68488767]


portfolio before change:  [1.04640097]
curr_Stock_Price:  100.27180006865343
curr_Factors:  [100.27180007]
mat_Sqrt:  [[0.15]]
grads:  [0.05922065]
Stock Position:  0.0592206546781095
Bond Position:  [-4.89176068]


portfolio before change:  [1.0009032]
curr_Stock_Price:  99.52417795718391
curr_Factors:  [99.52417796]
mat_Sqrt:  [[0.15]]
grads:  [-0.10421009]
Stock Position:  -0.10421008658045959
Bond Position:  [11.3723264]


portfolio before change:  [0.89019128]
curr_Stock_Price:  100.61385518351163
curr_Factors:  [100.61385518]
mat_Sqrt:  [[0.15]]
grads:  [-0.01513049]
Stock Position:  -0.015130491409799402
Bond Position:  [2.41252835]


portfolio before change:  [0.92227097]
curr_Stock_Price:  98.53352098601897
curr_Factors:  [98.53352099]
mat_Sqrt:  [[0.15]]
grads:  [0.00488983]
Stock Position:  0.004889833827322497
Bond Position:  [0.44045842]


portfolio before change:  [0.92493269]
curr_Stock_Price:  99.05533710133037
curr_Factors:  [99.0553371]
mat_Sqrt:  [[0.15]]
grads:  [-0.24049371]
Stock Position:  -0.2404937148358198
Bond Position:  [24.74711868]


portfolio before change:  [1.08263561]
curr_Stock_Price:  98.42531910956836
curr_Factors:  [98.42531911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00681921]
Stock Position:  -0.006819211759518639
Bond Position:  [1.7538187]


portfolio before change:  [1.08822133]
curr_Stock_Price:  97.67050873630893
curr_Factors:  [97.67050874]
mat_Sqrt:  [[0.15]]
grads:  [-0.17561655]
Stock Position:  -0.17561655418535338
Bond Position:  [18.24077952]


portfolio before change:  [0.96486225]
curr_Stock_Price:  98.39891299639073
curr_Factors:  [98.398913]
mat_Sqrt:  [[0.15]]
grads:  [0.01693167]
Stock Position:  0.016931667995325576
Bond Position:  [-0.70119548]


portfolio before change:  [0.93349356]
curr_Stock_Price:  96.55660378161753
curr_Factors:  [96.55660378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00676324]
Stock Position:  -0.0067632393061508745
Bond Position:  [1.58652898]


portfolio before change:  [0.93271315]
curr_Stock_Price:  96.73064610980293
curr_Factors:  [96.73064611]
mat_Sqrt:  [[0.15]]
grads:  [-0.01121658]
Stock Position:  -0.011216576842379021
Bond Position:  [2.01769988]


portfolio before change:  [0.91212512]
curr_Stock_Price:  98.61112337428939
curr_Factors:  [98.61112337]
mat_Sqrt:  [[0.15]]
grads:  [0.07665023]
Stock Position:  0.07665023362081387
Bond Position:  [-6.64644052]


portfolio before change:  [1.04580379]
curr_Stock_Price:  100.37681256282286
curr_Factors:  [100.37681256]
mat_Sqrt:  [[0.15]]
grads:  [0.04817664]
Stock Position:  0.048176641290842474
Bond Position:  [-3.7900139]


portfolio before change:  [1.06732756]
curr_Stock_Price:  100.84324989151028
curr_Factors:  [100.84324989]
mat_Sqrt:  [[0.15]]
grads:  [0.03694304]
Stock Position:  0.036943044244429096
Bond Position:  [-2.65812909]


portfolio before change:  [1.06638593]
curr_Stock_Price:  100.83575157616806
curr_Factors:  [100.83575158]
mat_Sqrt:  [[0.15]]
grads:  [0.02559653]
Stock Position:  0.025596534555120964
Bond Position:  [-1.51465987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.06638593]
Stock Price:  99.18493153892094
PL:  [1.06638593]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.66952758e-02]
 [-4.43022753e-03]
 [ 7.53326942e-03]
 [ 3.95619516e-03]
 [ 6.44118949e-03]
 [ 1.33328897e-03]
 [ 1.64597736e-03]
 [-2.06938214e-03]
 [-1.10173329e-03]
 [ 3.59040001e-02]
 [-3.96382984e-03]
 [-2.23552246e-02]
 [-6.88901220e-05]
 [-1.20762014e-02]
 [-3.42050009e-03]
 [ 1.05880096e-02]
 [ 1.63886403e-02]
 [-6.91501035e-03]
 [ 4.52213661e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.86427571]
curr_Stock_Price:  99.04310171798787
curr_Factors:  [99.04310172]
mat_Sqrt:  [[0.15]]
grads:  [0.17796851]
Stock Position:  0.17796850510913173
Bond Position:  [-30.49082847]


portfolio before change:  [-12.67453068]
curr_Stock_Price:  100.15211083234784
curr_Factors:  [100.15211083]
mat_Sqrt:  [[0.15]]
grads:  [-0.02953485]
Stock Position:  -0.029534850204863784
Bond Position:  [-9.71655309]


portfolio before change:  [-12.62945976]
curr_Stock_Price:  98.54382917783126
curr_Factors:  [98.54382918]
mat_Sqrt:  [[0.15]]
grads:  [0.0502218]
Stock Position:  0.05022179610694765
Bond Position:  [-17.57850786]


portfolio before change:  [-12.60948003]
curr_Stock_Price:  99.02917445221667
curr_Factors:  [99.02917445]
mat_Sqrt:  [[0.15]]
grads:  [0.02637463]
Stock Position:  0.02637463438885259
Bond Position:  [-15.2213383]


portfolio before change:  [-12.55105547]
curr_Stock_Price:  101.38865245826497
curr_Factors:  [101.38865246]
mat_Sqrt:  [[0.15]]
grads:  [0.04294126]
Stock Position:  0.04294126324347203
Bond Position:  [-16.90481228]


portfolio before change:  [-12.53667656]
curr_Stock_Price:  101.8219336786882
curr_Factors:  [101.82193368]
mat_Sqrt:  [[0.15]]
grads:  [0.00888859]
Stock Position:  0.00888859312559875
Bond Position:  [-13.4417303]


portfolio before change:  [-12.54237304]
curr_Stock_Price:  101.55916643090373
curr_Factors:  [101.55916643]
mat_Sqrt:  [[0.15]]
grads:  [0.01097318]
Stock Position:  0.01097318239839588
Bond Position:  [-13.6568003]


portfolio before change:  [-12.56282363]
curr_Stock_Price:  100.00665759848525
curr_Factors:  [100.0066576]
mat_Sqrt:  [[0.15]]
grads:  [-0.01379588]
Stock Position:  -0.013795880926894325
Bond Position:  [-11.18314369]


portfolio before change:  [-12.5710192]
curr_Stock_Price:  100.39803778876167
curr_Factors:  [100.39803779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00734489]
Stock Position:  -0.007344888582412371
Bond Position:  [-11.8336068]


portfolio before change:  [-12.58975456]
curr_Stock_Price:  102.54600637104856
curr_Factors:  [102.54600637]
mat_Sqrt:  [[0.15]]
grads:  [0.23936]
Stock Position:  0.23936000089521686
Bond Position:  [-37.13516674]


portfolio before change:  [-13.06127413]
curr_Stock_Price:  100.61487911923757
curr_Factors:  [100.61487912]
mat_Sqrt:  [[0.15]]
grads:  [-0.02642553]
Stock Position:  -0.026425532278465617
Bond Position:  [-10.4024724]


portfolio before change:  [-13.08395141]
curr_Stock_Price:  101.37461153749611
curr_Factors:  [101.37461154]
mat_Sqrt:  [[0.15]]
grads:  [-0.14903483]
Stock Position:  -0.14903483057576536
Bond Position:  [2.02439664]


portfolio before change:  [-13.09379636]
curr_Stock_Price:  101.44406583418697
curr_Factors:  [101.44406583]
mat_Sqrt:  [[0.15]]
grads:  [-0.00045927]
Stock Position:  -0.0004592674799903564
Bond Position:  [-13.0472064]


portfolio before change:  [-13.09701047]
curr_Stock_Price:  101.33933629903058
curr_Factors:  [101.3393363]
mat_Sqrt:  [[0.15]]
grads:  [-0.08050801]
Stock Position:  -0.08050800932089294
Bond Position:  [-4.93838224]


portfolio before change:  [-13.01589877]
curr_Stock_Price:  100.31650079443644
curr_Factors:  [100.31650079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280333]
Stock Position:  -0.02280333390359823
Bond Position:  [-10.7283481]


portfolio before change:  [-13.01700916]
curr_Stock_Price:  100.2475620547219
curr_Factors:  [100.24756205]
mat_Sqrt:  [[0.15]]
grads:  [0.07058673]
Stock Position:  0.07058673099478821
Bond Position:  [-20.09315685]


portfolio before change:  [-13.02932104]
curr_Stock_Price:  100.14431360871515
curr_Factors:  [100.14431361]
mat_Sqrt:  [[0.15]]
grads:  [0.1092576]
Stock Position:  0.10925760206577684
Bond Position:  [-23.97084861]


portfolio before change:  [-12.91369885]
curr_Stock_Price:  101.25742295385628
curr_Factors:  [101.25742295]
mat_Sqrt:  [[0.15]]
grads:  [-0.04610007]
Stock Position:  -0.046100068985168156
Bond Position:  [-8.24572466]


portfolio before change:  [-12.9549387]
curr_Stock_Price:  102.10727341351463
curr_Factors:  [102.10727341]
mat_Sqrt:  [[0.15]]
grads:  [0.03014758]
Stock Position:  0.03014757737557855
Bond Position:  [-16.03322563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.9549387]
Stock Price:  102.80336398151564
PL:  [-15.75830268]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.43591394e-02]
 [ 6.00555929e-03]
 [ 1.04980602e-02]
 [ 2.50882359e-03]
 [ 8.95207082e-03]
 [ 2.63092848e-02]
 [-1.20621478e-02]
 [ 5.76040184e-03]
 [ 6.88946024e-03]
 [-3.72578466e-02]
 [-5.11863008e-04]
 [-2.63896587e-02]
 [ 2.05912306e-03]
 [-5.76026249e-03]
 [ 7.39282069e-05]
 [ 5.44292321e-03]
 [ 2.07477846e-02]
 [ 1.78539207e-02]
 [ 2.86728628e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.3192493]
curr_Stock_Price:  100.2975891124064
curr_Factors:  [100.29758911]
mat_Sqrt:  [[0.15]]
grads:  [0.22906093]
Stock Position:  0.22906092945463827
Bond Position:  [-16.65500969]


portfolio before change:  [6.09562764]
curr_Stock_Price:  99.33951485526971
curr_Factors:  [99.33951486]
mat_Sqrt:  [[0.15]]
grads:  [0.04003706]
Stock Position:  0.04003706191637675
Bond Position:  [2.11836534]


portfolio before change:  [6.0472705]
curr_Stock_Price:  98.11847623698308
curr_Factors:  [98.11847624]
mat_Sqrt:  [[0.15]]
grads:  [0.06998707]
Stock Position:  0.06998706769606534
Bond Position:  [-0.81975394]


portfolio before change:  [6.03874916]
curr_Stock_Price:  97.99964886100213
curr_Factors:  [97.99964886]
mat_Sqrt:  [[0.15]]
grads:  [0.01672549]
Stock Position:  0.01672549056792879
Bond Position:  [4.39965696]


portfolio before change:  [6.01733655]
curr_Stock_Price:  96.65364018763576
curr_Factors:  [96.65364019]
mat_Sqrt:  [[0.15]]
grads:  [0.05968047]
Stock Position:  0.05968047213836445
Bond Position:  [0.24900167]


portfolio before change:  [6.05460044]
curr_Stock_Price:  97.27698691738487
curr_Factors:  [97.27698692]
mat_Sqrt:  [[0.15]]
grads:  [0.17539523]
Stock Position:  0.17539523231847387
Bond Position:  [-11.00731928]


portfolio before change:  [6.14519078]
curr_Stock_Price:  97.80917081415627
curr_Factors:  [97.80917081]
mat_Sqrt:  [[0.15]]
grads:  [-0.08041432]
Stock Position:  -0.08041431893774711
Bond Position:  [14.01044864]


portfolio before change:  [6.21164122]
curr_Stock_Price:  97.0263825192556
curr_Factors:  [97.02638252]
mat_Sqrt:  [[0.15]]
grads:  [0.03840268]
Stock Position:  0.03840267893193274
Bond Position:  [2.48556821]


portfolio before change:  [6.15768579]
curr_Stock_Price:  95.60520829349774
curr_Factors:  [95.60520829]
mat_Sqrt:  [[0.15]]
grads:  [0.04592973]
Stock Position:  0.045929734947482315
Bond Position:  [1.76656392]


portfolio before change:  [6.20531001]
curr_Stock_Price:  96.63248440970065
curr_Factors:  [96.63248441]
mat_Sqrt:  [[0.15]]
grads:  [-0.24838564]
Stock Position:  -0.2483856442754906
Bond Position:  [30.20743191]


portfolio before change:  [6.54965498]
curr_Stock_Price:  95.27655995540216
curr_Factors:  [95.27655996]
mat_Sqrt:  [[0.15]]
grads:  [-0.00341242]
Stock Position:  -0.003412420052235794
Bond Position:  [6.87477862]


portfolio before change:  [6.55508374]
curr_Stock_Price:  94.18939954448709
curr_Factors:  [94.18939954]
mat_Sqrt:  [[0.15]]
grads:  [-0.17593106]
Stock Position:  -0.17593105823870414
Bond Position:  [23.12592448]


portfolio before change:  [6.58684819]
curr_Stock_Price:  94.04171528017493
curr_Factors:  [94.04171528]
mat_Sqrt:  [[0.15]]
grads:  [0.01372749]
Stock Position:  0.013727487089590085
Bond Position:  [5.29589176]


portfolio before change:  [6.57978015]
curr_Stock_Price:  93.43037421777342
curr_Factors:  [93.43037422]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840175]
Stock Position:  -0.038401749934108276
Bond Position:  [10.16767002]


portfolio before change:  [6.55908209]
curr_Stock_Price:  94.03556277834483
curr_Factors:  [94.03556278]
mat_Sqrt:  [[0.15]]
grads:  [0.00049285]
Stock Position:  0.0004928547127785836
Bond Position:  [6.51273622]


portfolio before change:  [6.56050603]
curr_Stock_Price:  93.62074939144634
curr_Factors:  [93.62074939]
mat_Sqrt:  [[0.15]]
grads:  [0.03628615]
Stock Position:  0.036286154721471876
Bond Position:  [3.16336904]


portfolio before change:  [6.59161111]
curr_Stock_Price:  94.45616821574278
curr_Factors:  [94.45616822]
mat_Sqrt:  [[0.15]]
grads:  [0.13831856]
Stock Position:  0.13831856380117613
Bond Position:  [-6.47343042]


portfolio before change:  [6.68974683]
curr_Stock_Price:  95.17736050545153
curr_Factors:  [95.17736051]
mat_Sqrt:  [[0.15]]
grads:  [0.11902614]
Stock Position:  0.11902613786226836
Bond Position:  [-4.6388468]


portfolio before change:  [6.75482274]
curr_Stock_Price:  95.73384136198992
curr_Factors:  [95.73384136]
mat_Sqrt:  [[0.15]]
grads:  [0.01911524]
Stock Position:  0.019115241844822325
Bond Position:  [4.92484721]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75482274]
Stock Price:  93.34512254625811
PL:  [6.75482274]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.04499084e-02]
 [-6.77203003e-03]
 [ 2.38985899e-02]
 [-3.85487710e-04]
 [ 5.75546684e-03]
 [-2.36874967e-02]
 [-1.35972087e-02]
 [ 1.93148559e-03]
 [ 5.65852124e-03]
 [ 6.98360218e-02]
 [-1.55359183e-02]
 [-1.84420407e-02]
 [-1.02583714e-03]
 [-1.70790440e-02]
 [ 2.20519003e-03]
 [ 8.62585675e-03]
 [-4.33442306e-02]
 [-2.25511676e-02]
 [ 4.57326158e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.68008743]
curr_Stock_Price:  100.45197375667514
curr_Factors:  [100.45197376]
mat_Sqrt:  [[0.15]]
grads:  [0.26966606]
Stock Position:  0.269666056331034
Bond Position:  [-18.40840018]


portfolio before change:  [9.19891474]
curr_Stock_Price:  102.39300403234685
curr_Factors:  [102.39300403]
mat_Sqrt:  [[0.15]]
grads:  [-0.04514687]
Stock Position:  -0.04514686685096264
Bond Position:  [13.82163806]


portfolio before change:  [9.16438492]
curr_Stock_Price:  103.23438387560284
curr_Factors:  [103.23438388]
mat_Sqrt:  [[0.15]]
grads:  [0.15932393]
Stock Position:  0.15932393251706176
Bond Position:  [-7.28332309]


portfolio before change:  [9.11799248]
curr_Stock_Price:  102.95463066654509
curr_Factors:  [102.95463067]
mat_Sqrt:  [[0.15]]
grads:  [-0.00256992]
Stock Position:  -0.0025699180695719793
Bond Position:  [9.38257744]


portfolio before change:  [9.12131734]
curr_Stock_Price:  102.5737148844325
curr_Factors:  [102.57371488]
mat_Sqrt:  [[0.15]]
grads:  [0.03836978]
Stock Position:  0.03836977893239072
Bond Position:  [5.18558657]


portfolio before change:  [9.16248326]
curr_Stock_Price:  103.61279734569524
curr_Factors:  [103.61279735]
mat_Sqrt:  [[0.15]]
grads:  [-0.15791664]
Stock Position:  -0.1579166445833276
Bond Position:  [25.52466855]


portfolio before change:  [8.81030797]
curr_Stock_Price:  105.88334491857152
curr_Factors:  [105.88334492]
mat_Sqrt:  [[0.15]]
grads:  [-0.09064806]
Stock Position:  -0.09064805789741293
Bond Position:  [18.40842755]


portfolio before change:  [8.72930279]
curr_Stock_Price:  106.82774311387458
curr_Factors:  [106.82774311]
mat_Sqrt:  [[0.15]]
grads:  [0.01287657]
Stock Position:  0.012876570619923308
Bond Position:  [7.35372781]


portfolio before change:  [8.726932]
curr_Stock_Price:  106.50083550381227
curr_Factors:  [106.5008355]
mat_Sqrt:  [[0.15]]
grads:  [0.03772347]
Stock Position:  0.03772347494080718
Bond Position:  [4.7093504]


portfolio before change:  [8.69231523]
curr_Stock_Price:  105.55197646489829
curr_Factors:  [105.55197646]
mat_Sqrt:  [[0.15]]
grads:  [0.46557348]
Stock Position:  0.4655734787129374
Bond Position:  [-40.44988564]


portfolio before change:  [9.29259707]
curr_Stock_Price:  106.86303820745013
curr_Factors:  [106.86303821]
mat_Sqrt:  [[0.15]]
grads:  [-0.10357279]
Stock Position:  -0.10357278869378177
Bond Position:  [20.36069994]


portfolio before change:  [9.41300351]
curr_Stock_Price:  105.74966051620237
curr_Factors:  [105.74966052]
mat_Sqrt:  [[0.15]]
grads:  [-0.12294694]
Stock Position:  -0.1229469383072962
Bond Position:  [22.4146005]


portfolio before change:  [9.69158296]
curr_Stock_Price:  103.52939293969953
curr_Factors:  [103.52939294]
mat_Sqrt:  [[0.15]]
grads:  [-0.00683891]
Stock Position:  -0.006838914274987862
Bond Position:  [10.39961161]


portfolio before change:  [9.70536796]
curr_Stock_Price:  101.89393347478284
curr_Factors:  [101.89393347]
mat_Sqrt:  [[0.15]]
grads:  [-0.11386029]
Stock Position:  -0.11386029309782676
Bond Position:  [21.30704109]


portfolio before change:  [9.57568074]
curr_Stock_Price:  103.07972562270918
curr_Factors:  [103.07972562]
mat_Sqrt:  [[0.15]]
grads:  [0.01470127]
Stock Position:  0.014701266845595218
Bond Position:  [8.06027819]


portfolio before change:  [9.57610678]
curr_Stock_Price:  102.97162014530626
curr_Factors:  [102.97162015]
mat_Sqrt:  [[0.15]]
grads:  [0.05750571]
Stock Position:  0.05750571163383176
Bond Position:  [3.65465048]


portfolio before change:  [9.60075714]
curr_Stock_Price:  103.38438939727905
curr_Factors:  [103.3843894]
mat_Sqrt:  [[0.15]]
grads:  [-0.28896154]
Stock Position:  -0.2889615372039974
Bond Position:  [39.47486923]


portfolio before change:  [9.36749013]
curr_Stock_Price:  104.225805744184
curr_Factors:  [104.22580574]
mat_Sqrt:  [[0.15]]
grads:  [-0.15034112]
Stock Position:  -0.15034111712183612
Bond Position:  [25.0369142]


portfolio before change:  [9.37244581]
curr_Stock_Price:  104.23448157548746
curr_Factors:  [104.23448158]
mat_Sqrt:  [[0.15]]
grads:  [0.03048841]
Stock Position:  0.03048841053376121
Bond Position:  [6.19450214]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.37244581]
Stock Price:  105.8321587716839
PL:  [3.54028704]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.84087048e-02]
 [ 7.40170921e-03]
 [ 5.18998447e-03]
 [ 2.93858687e-03]
 [ 7.37880013e-03]
 [ 9.75349820e-03]
 [-6.25572229e-03]
 [-2.15180915e-03]
 [-6.33177970e-04]
 [-3.37689178e-02]
 [-1.01534937e-03]
 [-2.57783992e-02]
 [ 2.05100115e-03]
 [ 4.98691714e-03]
 [-2.00765906e-03]
 [ 1.09691665e-02]
 [ 4.20952451e-02]
 [ 2.03287505e-02]
 [ 3.87701755e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.30288594]
curr_Stock_Price:  100.49270104118884
curr_Factors:  [100.49270104]
mat_Sqrt:  [[0.15]]
grads:  [0.25605803]
Stock Position:  0.2560580321574698
Bond Position:  [-16.42907733]


portfolio before change:  [8.85799358]
curr_Stock_Price:  98.7712765026028
curr_Factors:  [98.7712765]
mat_Sqrt:  [[0.15]]
grads:  [0.04934473]
Stock Position:  0.04934472806797964
Bond Position:  [3.9841518]


portfolio before change:  [8.86481465]
curr_Stock_Price:  98.88932160005773
curr_Factors:  [98.8893216]
mat_Sqrt:  [[0.15]]
grads:  [0.0345999]
Stock Position:  0.03459989649943481
Bond Position:  [5.44325436]


portfolio before change:  [8.91197347]
curr_Stock_Price:  100.21296247678431
curr_Factors:  [100.21296248]
mat_Sqrt:  [[0.15]]
grads:  [0.01959058]
Stock Position:  0.019590579164329183
Bond Position:  [6.94874349]


portfolio before change:  [8.91258036]
curr_Stock_Price:  100.15525572865131
curr_Factors:  [100.15525573]
mat_Sqrt:  [[0.15]]
grads:  [0.049192]
Stock Position:  0.04919200084379828
Bond Position:  [3.98574294]


portfolio before change:  [8.93142986]
curr_Stock_Price:  100.51817926880328
curr_Factors:  [100.51817927]
mat_Sqrt:  [[0.15]]
grads:  [0.06502332]
Stock Position:  0.06502332133965118
Bond Position:  [2.39540399]


portfolio before change:  [8.91886291]
curr_Stock_Price:  100.31570006049013
curr_Factors:  [100.31570006]
mat_Sqrt:  [[0.15]]
grads:  [-0.04170482]
Stock Position:  -0.04170481527098637
Bond Position:  [13.10251065]


portfolio before change:  [8.90757956]
curr_Stock_Price:  100.66480573177893
curr_Factors:  [100.66480573]
mat_Sqrt:  [[0.15]]
grads:  [-0.01434539]
Stock Position:  -0.014345394322913688
Bond Position:  [10.3516559]


portfolio before change:  [8.92132418]
curr_Stock_Price:  99.88710823023858
curr_Factors:  [99.88710823]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422119]
Stock Position:  -0.004221186468680877
Bond Position:  [9.34296629]


portfolio before change:  [8.9266898]
curr_Stock_Price:  99.16939694227344
curr_Factors:  [99.16939694]
mat_Sqrt:  [[0.15]]
grads:  [-0.22512612]
Stock Position:  -0.22512611842402452
Bond Position:  [31.2523112]


portfolio before change:  [9.13501232]
curr_Stock_Price:  98.27874745509216
curr_Factors:  [98.27874746]
mat_Sqrt:  [[0.15]]
grads:  [-0.006769]
Stock Position:  -0.006768995766957247
Bond Position:  [9.80026075]


portfolio before change:  [9.13210914]
curr_Stock_Price:  99.06964124275643
curr_Factors:  [99.06964124]
mat_Sqrt:  [[0.15]]
grads:  [-0.17185599]
Stock Position:  -0.17185599486464886
Bond Position:  [26.15782089]


portfolio before change:  [9.10702532]
curr_Stock_Price:  99.25365625937678
curr_Factors:  [99.25365626]
mat_Sqrt:  [[0.15]]
grads:  [0.01367334]
Stock Position:  0.013673341017150127
Bond Position:  [7.74989624]


portfolio before change:  [9.10076145]
curr_Stock_Price:  98.65383286317557
curr_Factors:  [98.65383286]
mat_Sqrt:  [[0.15]]
grads:  [0.03324611]
Stock Position:  0.03324611428159429
Bond Position:  [5.82090485]


portfolio before change:  [9.06495296]
curr_Stock_Price:  97.53298311635719
curr_Factors:  [97.53298312]
mat_Sqrt:  [[0.15]]
grads:  [-0.01338439]
Stock Position:  -0.013384393705624732
Bond Position:  [10.37037281]


portfolio before change:  [9.08006714]
curr_Stock_Price:  96.59747106215907
curr_Factors:  [96.59747106]
mat_Sqrt:  [[0.15]]
grads:  [0.07312778]
Stock Position:  0.07312777661517973
Bond Position:  [2.01610885]


portfolio before change:  [9.01755098]
curr_Stock_Price:  95.7356884194158
curr_Factors:  [95.73568842]
mat_Sqrt:  [[0.15]]
grads:  [0.28063497]
Stock Position:  0.28063496738101434
Bond Position:  [-17.84923082]


portfolio before change:  [9.22654235]
curr_Stock_Price:  96.49630008806001
curr_Factors:  [96.49630009]
mat_Sqrt:  [[0.15]]
grads:  [0.135525]
Stock Position:  0.13552500307637166
Bond Position:  [-3.85111902]


portfolio before change:  [9.2823279]
curr_Stock_Price:  96.91503062585419
curr_Factors:  [96.91503063]
mat_Sqrt:  [[0.15]]
grads:  [0.02584678]
Stock Position:  0.025846783680476177
Bond Position:  [6.77738607]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.2823279]
Stock Price:  98.97033867164667
PL:  [9.2823279]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.86206509e-03]
 [-8.04312980e-03]
 [-1.34795943e-03]
 [ 2.67973998e-03]
 [ 8.22943674e-03]
 [ 1.32913010e-02]
 [-1.04776007e-02]
 [ 2.52078327e-03]
 [ 3.76161519e-03]
 [-3.72423096e-02]
 [-1.01444086e-03]
 [-2.63483384e-02]
 [ 2.55493581e-03]
 [-8.03138257e-04]
 [-1.95747254e-03]
 [ 1.19109360e-02]
 [ 5.05826824e-02]
 [ 2.03348132e-02]
 [ 3.84874639e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.99895618]
curr_Stock_Price:  99.6228404047026
curr_Factors:  [99.6228404]
mat_Sqrt:  [[0.15]]
grads:  [0.05908043]
Stock Position:  0.05908043393141651
Bond Position:  [-9.88471683]


portfolio before change:  [-3.93654806]
curr_Stock_Price:  100.7209977826456
curr_Factors:  [100.72099778]
mat_Sqrt:  [[0.15]]
grads:  [-0.05362087]
Stock Position:  -0.05362086530098583
Bond Position:  [1.464199]


portfolio before change:  [-3.87502822]
curr_Stock_Price:  99.58051370413438
curr_Factors:  [99.5805137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0089864]
Stock Position:  -0.00898639619066247
Bond Position:  [-2.98015827]


portfolio before change:  [-3.88267475]
curr_Stock_Price:  100.34849666227318
curr_Factors:  [100.34849666]
mat_Sqrt:  [[0.15]]
grads:  [0.01786493]
Stock Position:  0.017864933233042633
Bond Position:  [-5.67539394]


portfolio before change:  [-3.90467715]
curr_Stock_Price:  99.19633027248989
curr_Factors:  [99.19633027]
mat_Sqrt:  [[0.15]]
grads:  [0.05486291]
Stock Position:  0.054862911619800704
Bond Position:  [-9.34687665]


portfolio before change:  [-3.96109984]
curr_Stock_Price:  98.21049720538467
curr_Factors:  [98.21049721]
mat_Sqrt:  [[0.15]]
grads:  [0.08860867]
Stock Position:  0.08860867313887484
Bond Position:  [-12.66340168]


portfolio before change:  [-4.03979582]
curr_Stock_Price:  97.3581005333145
curr_Factors:  [97.35810053]
mat_Sqrt:  [[0.15]]
grads:  [-0.06985067]
Stock Position:  -0.06985067165361451
Bond Position:  [2.76073289]


portfolio before change:  [-4.10432772]
curr_Stock_Price:  98.29183777213706
curr_Factors:  [98.29183777]
mat_Sqrt:  [[0.15]]
grads:  [0.01680522]
Stock Position:  0.016805221809945453
Bond Position:  [-5.75614386]


portfolio before change:  [-4.1262593]
curr_Stock_Price:  97.07243332156182
curr_Factors:  [97.07243332]
mat_Sqrt:  [[0.15]]
grads:  [0.02507743]
Stock Position:  0.025077434607897478
Bond Position:  [-6.5605869]


portfolio before change:  [-4.12160215]
curr_Stock_Price:  97.3235558472418
curr_Factors:  [97.32355585]
mat_Sqrt:  [[0.15]]
grads:  [-0.24828206]
Stock Position:  -0.24828206418719367
Bond Position:  [20.04209119]


portfolio before change:  [-4.34935869]
curr_Stock_Price:  98.26106895080343
curr_Factors:  [98.26106895]
mat_Sqrt:  [[0.15]]
grads:  [-0.00676294]
Stock Position:  -0.006762939045805826
Bond Position:  [-3.68482507]


portfolio before change:  [-4.34336409]
curr_Stock_Price:  97.23844912453922
curr_Factors:  [97.23844912]
mat_Sqrt:  [[0.15]]
grads:  [-0.17565559]
Stock Position:  -0.1756555890135368
Bond Position:  [12.73711296]


portfolio before change:  [-4.14444204]
curr_Stock_Price:  96.12412432678204
curr_Factors:  [96.12412433]
mat_Sqrt:  [[0.15]]
grads:  [0.01703291]
Stock Position:  0.017032905400467264
Bond Position:  [-5.78171515]


portfolio before change:  [-4.13614989]
curr_Stock_Price:  96.69582677776583
curr_Factors:  [96.69582678]
mat_Sqrt:  [[0.15]]
grads:  [-0.00535426]
Stock Position:  -0.005354255047848866
Bond Position:  [-3.61841577]


portfolio before change:  [-4.14089693]
curr_Stock_Price:  97.4134475914077
curr_Factors:  [97.41344759]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304982]
Stock Position:  -0.01304981692590646
Bond Position:  [-2.86966928]


portfolio before change:  [-4.14320715]
curr_Stock_Price:  97.53549636004506
curr_Factors:  [97.53549636]
mat_Sqrt:  [[0.15]]
grads:  [0.07940624]
Stock Position:  0.07940623989845981
Bond Position:  [-11.88813418]


portfolio before change:  [-4.1431571]
curr_Stock_Price:  97.57355958755022
curr_Factors:  [97.57355959]
mat_Sqrt:  [[0.15]]
grads:  [0.33721788]
Stock Position:  0.33721788247264806
Bond Position:  [-37.04670625]


portfolio before change:  [-4.0864662]
curr_Stock_Price:  97.76914155917324
curr_Factors:  [97.76914156]
mat_Sqrt:  [[0.15]]
grads:  [0.13556542]
Stock Position:  0.13556542161036028
Bond Position:  [-17.34058109]


portfolio before change:  [-3.88879607]
curr_Stock_Price:  99.25923993468085
curr_Factors:  [99.25923993]
mat_Sqrt:  [[0.15]]
grads:  [0.02565831]
Stock Position:  0.025658309297871818
Bond Position:  [-6.43562035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.88879607]
Stock Price:  99.3742973904534
PL:  [-3.88879607]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.77602447e-02]
 [-8.00898978e-03]
 [ 3.84484149e-03]
 [ 3.82412388e-03]
 [ 7.19722134e-03]
 [ 8.37612466e-03]
 [-1.22476764e-02]
 [-2.02158128e-03]
 [-1.30098067e-03]
 [-1.31316178e-03]
 [-4.40643488e-03]
 [-2.49239179e-02]
 [ 2.78673423e-03]
 [ 4.67091342e-03]
 [-2.58164904e-03]
 [ 1.05816213e-02]
 [ 5.05334819e-02]
 [ 2.05471158e-02]
 [ 4.17599920e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.03059592]
curr_Stock_Price:  99.35919536393448
curr_Factors:  [99.35919536]
mat_Sqrt:  [[0.15]]
grads:  [0.11840163]
Stock Position:  0.11840163160864943
Bond Position:  [-19.79488677]


portfolio before change:  [-7.89457416]
curr_Stock_Price:  100.54981331695696
curr_Factors:  [100.54981332]
mat_Sqrt:  [[0.15]]
grads:  [-0.05339327]
Stock Position:  -0.05339326521351567
Bond Position:  [-2.52589131]


portfolio before change:  [-7.81432182]
curr_Stock_Price:  99.03494274225544
curr_Factors:  [99.03494274]
mat_Sqrt:  [[0.15]]
grads:  [0.02563228]
Stock Position:  0.02563227662225497
Bond Position:  [-10.35281287]


portfolio before change:  [-7.81982345]
curr_Stock_Price:  98.92129293857339
curr_Factors:  [98.92129294]
mat_Sqrt:  [[0.15]]
grads:  [0.02549416]
Stock Position:  0.02549415919157621
Bond Position:  [-10.34173864]


portfolio before change:  [-7.7855607]
curr_Stock_Price:  100.36666346702808
curr_Factors:  [100.36666347]
mat_Sqrt:  [[0.15]]
grads:  [0.04798148]
Stock Position:  0.04798147558358006
Bond Position:  [-12.60130132]


portfolio before change:  [-7.74307245]
curr_Stock_Price:  101.3178424515263
curr_Factors:  [101.31784245]
mat_Sqrt:  [[0.15]]
grads:  [0.05584083]
Stock Position:  0.05584083104455468
Bond Position:  [-13.40074497]


portfolio before change:  [-7.82741627]
curr_Stock_Price:  99.86741249460245
curr_Factors:  [99.86741249]
mat_Sqrt:  [[0.15]]
grads:  [-0.08165118]
Stock Position:  -0.08165117576612166
Bond Position:  [0.32687538]


portfolio before change:  [-7.89704309]
curr_Stock_Price:  100.7211484995889
curr_Factors:  [100.7211485]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347721]
Stock Position:  -0.013477208515714502
Bond Position:  [-6.53960317]


portfolio before change:  [-7.9023564]
curr_Stock_Price:  100.99406918506003
curr_Factors:  [100.99406919]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086732]
Stock Position:  -0.008673204488958636
Bond Position:  [-7.02641419]


portfolio before change:  [-7.90119603]
curr_Stock_Price:  100.65772371181185
curr_Factors:  [100.65772371]
mat_Sqrt:  [[0.15]]
grads:  [-0.00875441]
Stock Position:  -0.008754411887332654
Bond Position:  [-7.01999686]


portfolio before change:  [-7.90361579]
curr_Stock_Price:  100.73363278535588
curr_Factors:  [100.73363279]
mat_Sqrt:  [[0.15]]
grads:  [-0.02937623]
Stock Position:  -0.029376232536728834
Bond Position:  [-4.94444117]


portfolio before change:  [-7.87460208]
curr_Stock_Price:  99.70388968820441
curr_Factors:  [99.70388969]
mat_Sqrt:  [[0.15]]
grads:  [-0.16615945]
Stock Position:  -0.16615945250446648
Bond Position:  [8.69214164]


portfolio before change:  [-7.58105846]
curr_Stock_Price:  97.95033117905245
curr_Factors:  [97.95033118]
mat_Sqrt:  [[0.15]]
grads:  [0.01857823]
Stock Position:  0.018578228224110857
Bond Position:  [-9.40080206]


portfolio before change:  [-7.56838957]
curr_Stock_Price:  98.75877125265295
curr_Factors:  [98.75877125]
mat_Sqrt:  [[0.15]]
grads:  [0.03113942]
Stock Position:  0.031139422804398152
Bond Position:  [-10.6436807]


portfolio before change:  [-7.56531107]
curr_Stock_Price:  98.94309534677818
curr_Factors:  [98.94309535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01721099]
Stock Position:  -0.017210993615706528
Bond Position:  [-5.86240209]


portfolio before change:  [-7.58840167]
curr_Stock_Price:  100.1995486864061
curr_Factors:  [100.19954869]
mat_Sqrt:  [[0.15]]
grads:  [0.07054414]
Stock Position:  0.07054414177590901
Bond Position:  [-14.65689284]


portfolio before change:  [-7.77406475]
curr_Stock_Price:  97.61962641015897
curr_Factors:  [97.61962641]
mat_Sqrt:  [[0.15]]
grads:  [0.33688988]
Stock Position:  0.3368898795720916
Bond Position:  [-40.66112894]


portfolio before change:  [-7.82427064]
curr_Stock_Price:  97.50077648348802
curr_Factors:  [97.50077648]
mat_Sqrt:  [[0.15]]
grads:  [0.13698077]
Stock Position:  0.13698077168246264
Bond Position:  [-21.18000224]


portfolio before change:  [-7.8211455]
curr_Stock_Price:  97.56225082630674
curr_Factors:  [97.56225083]
mat_Sqrt:  [[0.15]]
grads:  [0.02783999]
Stock Position:  0.027839994677071416
Bond Position:  [-10.53727804]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.8211455]
Stock Price:  97.82361367921865
PL:  [-7.8211455]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.69280585e-02]
 [-7.50067154e-03]
 [-4.86302579e-03]
 [ 2.30207087e-03]
 [ 6.08261649e-03]
 [-2.38663360e-04]
 [ 1.42279131e-03]
 [-1.92170516e-03]
 [-1.31949086e-03]
 [-4.81814320e-03]
 [-3.34702879e-03]
 [-2.43266673e-02]
 [ 1.72777625e-03]
 [-8.03789866e-03]
 [-1.59406000e-03]
 [ 8.98444469e-03]
 [-4.65992891e-02]
 [-2.65919223e-02]
 [ 4.69554245e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.31120301]
curr_Stock_Price:  100.36245693182721
curr_Factors:  [100.36245693]
mat_Sqrt:  [[0.15]]
grads:  [0.24618706]
Stock Position:  0.24618705643471916
Bond Position:  [-17.39673483]


portfolio before change:  [7.6590199]
curr_Stock_Price:  101.79294079794035
curr_Factors:  [101.7929408]
mat_Sqrt:  [[0.15]]
grads:  [-0.05000448]
Stock Position:  -0.05000447693483376
Bond Position:  [12.74912266]


portfolio before change:  [7.68054032]
curr_Stock_Price:  101.42631875781628
curr_Factors:  [101.42631876]
mat_Sqrt:  [[0.15]]
grads:  [-0.03242017]
Stock Position:  -0.03242017190326399
Bond Position:  [10.96879901]


portfolio before change:  [7.69430404]
curr_Stock_Price:  101.08637072311801
curr_Factors:  [101.08637072]
mat_Sqrt:  [[0.15]]
grads:  [0.01534714]
Stock Position:  0.015347139146281294
Bond Position:  [6.14291744]


portfolio before change:  [7.70911666]
curr_Stock_Price:  101.95146354899818
curr_Factors:  [101.95146355]
mat_Sqrt:  [[0.15]]
grads:  [0.04055078]
Stock Position:  0.040550776606477316
Bond Position:  [3.57490564]


portfolio before change:  [7.70932043]
curr_Stock_Price:  101.93444622528546
curr_Factors:  [101.93444623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00159109]
Stock Position:  -0.001591089066934707
Bond Position:  [7.87150721]


portfolio before change:  [7.71179401]
curr_Stock_Price:  101.61676716294865
curr_Factors:  [101.61676716]
mat_Sqrt:  [[0.15]]
grads:  [0.00948528]
Stock Position:  0.009485275396513723
Bond Position:  [6.74793099]


portfolio before change:  [7.70539588]
curr_Stock_Price:  100.76435965451032
curr_Factors:  [100.76435965]
mat_Sqrt:  [[0.15]]
grads:  [-0.01281137]
Stock Position:  -0.012811367754359333
Bond Position:  [8.99632515]


portfolio before change:  [7.70554467]
curr_Stock_Price:  100.92832194538708
curr_Factors:  [100.92832195]
mat_Sqrt:  [[0.15]]
grads:  [-0.00879661]
Stock Position:  -0.008796605748212838
Bond Position:  [8.59337132]


portfolio before change:  [7.7117671]
curr_Stock_Price:  100.46520913434324
curr_Factors:  [100.46520913]
mat_Sqrt:  [[0.15]]
grads:  [-0.03212095]
Stock Position:  -0.03212095464219799
Bond Position:  [10.93880552]


portfolio before change:  [7.71501034]
curr_Stock_Price:  100.4493875862871
curr_Factors:  [100.44938759]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231353]
Stock Position:  -0.02231352525603976
Bond Position:  [9.95639029]


portfolio before change:  [7.72749281]
curr_Stock_Price:  100.00153984790278
curr_Factors:  [100.00153985]
mat_Sqrt:  [[0.15]]
grads:  [-0.16217778]
Stock Position:  -0.16217778178517883
Bond Position:  [23.94552072]


portfolio before change:  [7.79247034]
curr_Stock_Price:  99.63780079144284
curr_Factors:  [99.63780079]
mat_Sqrt:  [[0.15]]
grads:  [0.01151851]
Stock Position:  0.01151850831717918
Bond Position:  [6.6447915]


portfolio before change:  [7.80929209]
curr_Stock_Price:  100.9539740321173
curr_Factors:  [100.95397403]
mat_Sqrt:  [[0.15]]
grads:  [-0.05358599]
Stock Position:  -0.05358599104075344
Bond Position:  [13.21901084]


portfolio before change:  [7.77997151]
curr_Stock_Price:  101.56282259056132
curr_Factors:  [101.56282259]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062707]
Stock Position:  -0.01062706667190223
Bond Position:  [8.85928639]


portfolio before change:  [7.77578891]
curr_Stock_Price:  102.16484170297268
curr_Factors:  [102.1648417]
mat_Sqrt:  [[0.15]]
grads:  [0.0598963]
Stock Position:  0.059896297902335624
Bond Position:  [1.65649311]


portfolio before change:  [7.80763303]
curr_Stock_Price:  102.68958109447694
curr_Factors:  [102.68958109]
mat_Sqrt:  [[0.15]]
grads:  [-0.31066193]
Stock Position:  -0.3106619271073737
Bond Position:  [39.70937619]


portfolio before change:  [7.76774361]
curr_Stock_Price:  102.8499419160616
curr_Factors:  [102.84994192]
mat_Sqrt:  [[0.15]]
grads:  [-0.17727948]
Stock Position:  -0.17727948213340952
Bond Position:  [26.00092805]


portfolio before change:  [7.69815547]
curr_Stock_Price:  103.2791466218416
curr_Factors:  [103.27914662]
mat_Sqrt:  [[0.15]]
grads:  [0.03130362]
Stock Position:  0.03130361632944971
Bond Position:  [4.46514469]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.69815547]
Stock Price:  102.00488161009481
PL:  [5.69327386]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.73952350e-02]
 [-6.60643032e-03]
 [ 1.88985692e-02]
 [ 2.75722552e-03]
 [ 6.86733442e-03]
 [ 1.10940351e-02]
 [-3.67014688e-03]
 [-2.18409845e-03]
 [-9.91875442e-04]
 [-2.24339750e-02]
 [-1.02803423e-03]
 [-2.45756641e-02]
 [ 8.40199287e-04]
 [-5.27609241e-03]
 [-4.91268340e-04]
 [ 8.78716159e-03]
 [-4.39903510e-02]
 [-2.56302822e-02]
 [ 4.58695159e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.71910137]
curr_Stock_Price:  102.15476898008961
curr_Factors:  [102.15476898]
mat_Sqrt:  [[0.15]]
grads:  [-0.24930157]
Stock Position:  -0.24930156678555218
Bond Position:  [60.18644534]


portfolio before change:  [34.65636547]
curr_Stock_Price:  102.46677824422707
curr_Factors:  [102.46677824]
mat_Sqrt:  [[0.15]]
grads:  [-0.04404287]
Stock Position:  -0.044042868776856516
Bond Position:  [39.16929634]


portfolio before change:  [34.64598155]
curr_Stock_Price:  102.92491061139162
curr_Factors:  [102.92491061]
mat_Sqrt:  [[0.15]]
grads:  [0.12599046]
Stock Position:  0.1259904611601124
Bond Position:  [21.6784246]


portfolio before change:  [34.58453775]
curr_Stock_Price:  102.39420308017476
curr_Factors:  [102.39420308]
mat_Sqrt:  [[0.15]]
grads:  [0.0183815]
Stock Position:  0.01838150346417505
Bond Position:  [32.70237835]


portfolio before change:  [34.56409816]
curr_Stock_Price:  100.83740976982595
curr_Factors:  [100.83740977]
mat_Sqrt:  [[0.15]]
grads:  [0.04578223]
Stock Position:  0.04578222945440121
Bond Position:  [29.94753673]


portfolio before change:  [34.57070704]
curr_Stock_Price:  100.81821135888718
curr_Factors:  [100.81821136]
mat_Sqrt:  [[0.15]]
grads:  [0.07396023]
Stock Position:  0.0739602342616124
Bond Position:  [27.11416851]


portfolio before change:  [34.5536106]
curr_Stock_Price:  100.49539158119931
curr_Factors:  [100.49539158]
mat_Sqrt:  [[0.15]]
grads:  [-0.02446765]
Stock Position:  -0.024467645833455832
Bond Position:  [37.01249625]


portfolio before change:  [34.57130913]
curr_Stock_Price:  100.15027247531816
curr_Factors:  [100.15027248]
mat_Sqrt:  [[0.15]]
grads:  [-0.01456066]
Stock Position:  -0.014560656311763913
Bond Position:  [36.02956283]


portfolio before change:  [34.57852389]
curr_Stock_Price:  100.27346470970348
curr_Factors:  [100.27346471]
mat_Sqrt:  [[0.15]]
grads:  [-0.0066125]
Stock Position:  -0.006612502949678465
Bond Position:  [35.24158247]


portfolio before change:  [34.59098701]
curr_Stock_Price:  99.721235473538
curr_Factors:  [99.72123547]
mat_Sqrt:  [[0.15]]
grads:  [-0.14955983]
Stock Position:  -0.14955983364474718
Bond Position:  [49.50527839]


portfolio before change:  [34.78218691]
curr_Stock_Price:  98.5255799970165
curr_Factors:  [98.52558]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685356]
Stock Position:  -0.006853561511496921
Bond Position:  [35.45743803]


portfolio before change:  [34.78178726]
curr_Stock_Price:  99.87744796422349
curr_Factors:  [99.87744796]
mat_Sqrt:  [[0.15]]
grads:  [-0.16383776]
Stock Position:  -0.16383776080298865
Bond Position:  [51.14548469]


portfolio before change:  [34.73234859]
curr_Stock_Price:  100.25725447791804
curr_Factors:  [100.25725448]
mat_Sqrt:  [[0.15]]
grads:  [0.00560133]
Stock Position:  0.005601328581351507
Bond Position:  [34.17077476]


portfolio before change:  [34.74339877]
curr_Stock_Price:  100.70472325965815
curr_Factors:  [100.70472326]
mat_Sqrt:  [[0.15]]
grads:  [-0.03517395]
Stock Position:  -0.03517394939521238
Bond Position:  [38.28558161]


portfolio before change:  [34.70443184]
curr_Stock_Price:  102.08470811893777
curr_Factors:  [102.08470812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00327512]
Stock Position:  -0.00327512226804527
Bond Position:  [35.03877174]


portfolio before change:  [34.7117196]
curr_Stock_Price:  102.53447062045343
curr_Factors:  [102.53447062]
mat_Sqrt:  [[0.15]]
grads:  [0.05858108]
Stock Position:  0.058581077262149554
Bond Position:  [28.70513986]


portfolio before change:  [34.75931097]
curr_Stock_Price:  103.22435533239786
curr_Factors:  [103.22435533]
mat_Sqrt:  [[0.15]]
grads:  [-0.29326901]
Stock Position:  -0.29326900668487005
Bond Position:  [65.03181513]


portfolio before change:  [34.76553756]
curr_Stock_Price:  103.25856759447052
curr_Factors:  [103.25856759]
mat_Sqrt:  [[0.15]]
grads:  [-0.17086855]
Stock Position:  -0.17086854771835705
Bond Position:  [52.40917905]


portfolio before change:  [34.62987786]
curr_Stock_Price:  104.12919963593814
curr_Factors:  [104.12919964]
mat_Sqrt:  [[0.15]]
grads:  [0.03057968]
Stock Position:  0.030579677258486898
Bond Position:  [31.44564055]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [34.62987786]
Stock Price:  103.32166549828398
PL:  [31.30821237]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.88122828e-02]
 [ 6.21219063e-03]
 [-1.06292401e-02]
 [ 3.16325852e-03]
 [ 8.19152231e-03]
 [ 8.92948414e-03]
 [ 7.65719387e-04]
 [-1.63266611e-04]
 [-1.31789119e-03]
 [ 1.48973000e-02]
 [-1.08024507e-03]
 [-2.46061860e-02]
 [ 1.84566096e-03]
 [-9.94160523e-03]
 [-5.44774204e-04]
 [ 1.07054000e-02]
 [-4.23089773e-02]
 [-2.52718602e-02]
 [ 4.53777161e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.21493575]
curr_Stock_Price:  100.02919164123188
curr_Factors:  [100.02919164]
mat_Sqrt:  [[0.15]]
grads:  [0.19208189]
Stock Position:  0.1920818855402452
Bond Position:  [-16.99885999]


portfolio before change:  [2.07105787]
curr_Stock_Price:  99.30227436282021
curr_Factors:  [99.30227436]
mat_Sqrt:  [[0.15]]
grads:  [0.0414146]
Stock Position:  0.041414604212978774
Bond Position:  [-2.04150652]


portfolio before change:  [2.11774]
curr_Stock_Price:  100.44178961939323
curr_Factors:  [100.44178962]
mat_Sqrt:  [[0.15]]
grads:  [-0.0708616]
Stock Position:  -0.07086160065130956
Bond Position:  [9.23520598]


portfolio before change:  [2.14679339]
curr_Stock_Price:  100.06437365467465
curr_Factors:  [100.06437365]
mat_Sqrt:  [[0.15]]
grads:  [0.02108839]
Stock Position:  0.021088390156253103
Bond Position:  [0.03659684]


portfolio before change:  [2.13018266]
curr_Stock_Price:  99.27626793606088
curr_Factors:  [99.27626794]
mat_Sqrt:  [[0.15]]
grads:  [0.05461015]
Stock Position:  0.05461014875145477
Bond Position:  [-3.2913091]


portfolio before change:  [2.23868749]
curr_Stock_Price:  101.27823572560003
curr_Factors:  [101.27823573]
mat_Sqrt:  [[0.15]]
grads:  [0.05952989]
Stock Position:  0.05952989429080896
Bond Position:  [-3.79039518]


portfolio before change:  [2.26789086]
curr_Stock_Price:  101.78472224386117
curr_Factors:  [101.78472224]
mat_Sqrt:  [[0.15]]
grads:  [0.0051048]
Stock Position:  0.005104795911800945
Bond Position:  [1.74830062]


portfolio before change:  [2.26889342]
curr_Stock_Price:  101.89548634273905
curr_Factors:  [101.89548634]
mat_Sqrt:  [[0.15]]
grads:  [-0.00108844]
Stock Position:  -0.0010884440756281956
Bond Position:  [2.37980096]


portfolio before change:  [2.27053085]
curr_Stock_Price:  100.9377783208326
curr_Factors:  [100.93777832]
mat_Sqrt:  [[0.15]]
grads:  [-0.00878594]
Stock Position:  -0.008785941238024324
Bond Position:  [3.15736424]


portfolio before change:  [2.26666283]
curr_Stock_Price:  101.46788278828453
curr_Factors:  [101.46788279]
mat_Sqrt:  [[0.15]]
grads:  [0.09931533]
Stock Position:  0.09931533356673526
Bond Position:  [-7.8106538]


portfolio before change:  [2.07339472]
curr_Stock_Price:  99.54154180498799
curr_Factors:  [99.5415418]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720163]
Stock Position:  -0.0072016337958287725
Bond Position:  [2.79025645]


portfolio before change:  [2.07178284]
curr_Stock_Price:  99.86223684711577
curr_Factors:  [99.86223685]
mat_Sqrt:  [[0.15]]
grads:  [-0.16404124]
Stock Position:  -0.1640412401481934
Bond Position:  [18.45330802]


portfolio before change:  [2.13108137]
curr_Stock_Price:  99.52887785400313
curr_Factors:  [99.52887785]
mat_Sqrt:  [[0.15]]
grads:  [0.01230441]
Stock Position:  0.012304406401116562
Bond Position:  [0.90643761]


portfolio before change:  [2.15107825]
curr_Stock_Price:  101.13563863890965
curr_Factors:  [101.13563864]
mat_Sqrt:  [[0.15]]
grads:  [-0.06627737]
Stock Position:  -0.06627736818074285
Bond Position:  [8.8540822]


portfolio before change:  [2.09221283]
curr_Stock_Price:  102.05720831141655
curr_Factors:  [102.05720831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00363183]
Stock Position:  -0.003631828027487293
Bond Position:  [2.46286706]


portfolio before change:  [2.09619668]
curr_Stock_Price:  101.12983655355791
curr_Factors:  [101.12983655]
mat_Sqrt:  [[0.15]]
grads:  [0.07136933]
Stock Position:  0.07136933348781146
Bond Position:  [-5.12137235]


portfolio before change:  [2.1518459]
curr_Stock_Price:  101.92751421330313
curr_Factors:  [101.92751421]
mat_Sqrt:  [[0.15]]
grads:  [-0.28205985]
Stock Position:  -0.2820598489486528
Bond Position:  [30.90150516]


portfolio before change:  [1.74132695]
curr_Stock_Price:  103.41033885478039
curr_Factors:  [103.41033885]
mat_Sqrt:  [[0.15]]
grads:  [-0.16847907]
Stock Position:  -0.16847906805706453
Bond Position:  [19.16380446]


portfolio before change:  [1.56128423]
curr_Stock_Price:  104.5074143792257
curr_Factors:  [104.50741438]
mat_Sqrt:  [[0.15]]
grads:  [0.03025181]
Stock Position:  0.03025181076010566
Bond Position:  [-1.60025429]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.56128423]
Stock Price:  103.8501712966821
PL:  [-2.28888706]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.06490473e-02]
 [ 7.83646715e-03]
 [ 6.49558576e-03]
 [ 3.40331779e-03]
 [ 8.72794744e-03]
 [ 1.02068773e-02]
 [-1.00262730e-02]
 [ 5.95629009e-03]
 [ 4.75115094e-03]
 [-3.72685327e-02]
 [-6.28536711e-04]
 [-2.63782762e-02]
 [ 2.41986344e-03]
 [-3.01543219e-03]
 [-1.46103767e-03]
 [ 1.19456692e-02]
 [ 5.03562918e-02]
 [ 2.08792954e-02]
 [ 3.11348790e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.91944301]
curr_Stock_Price:  99.17028210342725
curr_Factors:  [99.1702821]
mat_Sqrt:  [[0.15]]
grads:  [0.13766032]
Stock Position:  0.13766031507394755
Bond Position:  [-24.57125529]


portfolio before change:  [-11.00396868]
curr_Stock_Price:  98.60089443068802
curr_Factors:  [98.60089443]
mat_Sqrt:  [[0.15]]
grads:  [0.05224311]
Stock Position:  0.052243114328584146
Bond Position:  [-16.15518648]


portfolio before change:  [-11.00321726]
curr_Stock_Price:  98.69259499780144
curr_Factors:  [98.692595]
mat_Sqrt:  [[0.15]]
grads:  [0.04330391]
Stock Position:  0.04330390509115702
Bond Position:  [-15.27699203]


portfolio before change:  [-11.01201843]
curr_Stock_Price:  98.57756039095268
curr_Factors:  [98.57756039]
mat_Sqrt:  [[0.15]]
grads:  [0.02268879]
Stock Position:  0.022688785291490373
Bond Position:  [-13.24862354]


portfolio before change:  [-11.03554112]
curr_Stock_Price:  97.68680674074808
curr_Factors:  [97.68680674]
mat_Sqrt:  [[0.15]]
grads:  [0.05818632]
Stock Position:  0.0581863162982802
Bond Position:  [-16.71957656]


portfolio before change:  [-10.98989554]
curr_Stock_Price:  98.543124821778
curr_Factors:  [98.54312482]
mat_Sqrt:  [[0.15]]
grads:  [0.06804585]
Stock Position:  0.0680458485527553
Bond Position:  [-17.69534609]


portfolio before change:  [-11.08369836]
curr_Stock_Price:  97.22962184905381
curr_Factors:  [97.22962185]
mat_Sqrt:  [[0.15]]
grads:  [-0.06684182]
Stock Position:  -0.06684182012492049
Bond Position:  [-4.58469346]


portfolio before change:  [-11.06089851]
curr_Stock_Price:  96.87137066183557
curr_Factors:  [96.87137066]
mat_Sqrt:  [[0.15]]
grads:  [0.0397086]
Stock Position:  0.03970860057778203
Bond Position:  [-14.90752508]


portfolio before change:  [-11.0727455]
curr_Stock_Price:  96.66688995836425
curr_Factors:  [96.66688996]
mat_Sqrt:  [[0.15]]
grads:  [0.03167434]
Stock Position:  0.03167433962931984
Bond Position:  [-14.13460541]


portfolio before change:  [-11.09242441]
curr_Stock_Price:  96.15717734060662
curr_Factors:  [96.15717734]
mat_Sqrt:  [[0.15]]
grads:  [-0.24845688]
Stock Position:  -0.24845688488175988
Bond Position:  [12.79848834]


portfolio before change:  [-10.91860521]
curr_Stock_Price:  95.4704619119489
curr_Factors:  [95.47046191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00419024]
Stock Position:  -0.004190244738995081
Bond Position:  [-10.51856061]


portfolio before change:  [-10.91938668]
curr_Stock_Price:  95.02932001214721
curr_Factors:  [95.02932001]
mat_Sqrt:  [[0.15]]
grads:  [-0.17585517]
Stock Position:  -0.17585517484148352
Bond Position:  [5.792011]


portfolio before change:  [-11.01070239]
curr_Stock_Price:  95.55682161325728
curr_Factors:  [95.55682161]
mat_Sqrt:  [[0.15]]
grads:  [0.01613242]
Stock Position:  0.016132422961558143
Bond Position:  [-12.55226545]


portfolio before change:  [-11.01897611]
curr_Stock_Price:  95.23850181673153
curr_Factors:  [95.23850182]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010288]
Stock Position:  -0.020102881252821246
Bond Position:  [-9.10440782]


portfolio before change:  [-11.040195]
curr_Stock_Price:  96.18077958229482
curr_Factors:  [96.18077958]
mat_Sqrt:  [[0.15]]
grads:  [-0.00974025]
Stock Position:  -0.009740251166505011
Bond Position:  [-10.10337005]


portfolio before change:  [-11.05631449]
curr_Stock_Price:  97.57636327735591
curr_Factors:  [97.57636328]
mat_Sqrt:  [[0.15]]
grads:  [0.07963779]
Stock Position:  0.0796377946150749
Bond Position:  [-18.82708087]


portfolio before change:  [-11.04436418]
curr_Stock_Price:  97.78553121251268
curr_Factors:  [97.78553121]
mat_Sqrt:  [[0.15]]
grads:  [0.33570861]
Stock Position:  0.33570861172450556
Bond Position:  [-43.87180911]


portfolio before change:  [-11.29189151]
curr_Stock_Price:  97.08087843797951
curr_Factors:  [97.08087844]
mat_Sqrt:  [[0.15]]
grads:  [0.1391953]
Stock Position:  0.13919530249452103
Bond Position:  [-24.80509375]


portfolio before change:  [-11.44550542]
curr_Stock_Price:  96.02184938815013
curr_Factors:  [96.02184939]
mat_Sqrt:  [[0.15]]
grads:  [0.02075659]
Stock Position:  0.020756585985353137
Bond Position:  [-13.4385912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.44550542]
Stock Price:  96.06978294605696
PL:  [-11.44550542]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.20310176e-02]
 [ 9.54213483e-03]
 [ 2.33542513e-02]
 [-1.62574943e-03]
 [ 8.90472291e-03]
 [ 5.53636440e-02]
 [ 4.86103064e-03]
 [ 1.03691952e-02]
 [ 1.15192134e-02]
 [-3.73046436e-02]
 [ 1.31356369e-04]
 [-2.63856662e-02]
 [ 2.21595858e-03]
 [-3.44906158e-03]
 [-3.31013384e-04]
 [ 7.21597132e-03]
 [-1.03192347e-02]
 [ 9.46941229e-03]
 [-1.73653494e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.38673694]
curr_Stock_Price:  99.13972388549244
curr_Factors:  [99.13972389]
mat_Sqrt:  [[0.15]]
grads:  [0.14687345]
Stock Position:  0.14687345047870629
Bond Position:  [-25.94773026]


portfolio before change:  [-11.72501981]
curr_Stock_Price:  96.88066939592792
curr_Factors:  [96.8806694]
mat_Sqrt:  [[0.15]]
grads:  [0.06361423]
Stock Position:  0.06361423219619708
Bond Position:  [-17.88800921]


portfolio before change:  [-11.70508028]
curr_Stock_Price:  97.26442141087855
curr_Factors:  [97.26442141]
mat_Sqrt:  [[0.15]]
grads:  [0.15569501]
Stock Position:  0.15569500884133722
Bond Position:  [-26.84866523]


portfolio before change:  [-11.79110277]
curr_Stock_Price:  96.75503139088994
curr_Factors:  [96.75503139]
mat_Sqrt:  [[0.15]]
grads:  [-0.01083833]
Stock Position:  -0.010838329530423537
Bond Position:  [-10.74243986]


portfolio before change:  [-11.79505543]
curr_Stock_Price:  96.87190516039226
curr_Factors:  [96.87190516]
mat_Sqrt:  [[0.15]]
grads:  [0.05936482]
Stock Position:  0.05936481936897549
Bond Position:  [-17.54583858]


portfolio before change:  [-11.89755727]
curr_Stock_Price:  95.21916149678322
curr_Factors:  [95.2191615]
mat_Sqrt:  [[0.15]]
grads:  [0.36909096]
Stock Position:  0.36909095979654927
Bond Position:  [-47.04208898]


portfolio before change:  [-12.73146297]
curr_Stock_Price:  92.99167885954157
curr_Factors:  [92.99167886]
mat_Sqrt:  [[0.15]]
grads:  [0.03240687]
Stock Position:  0.03240687093919589
Bond Position:  [-15.7450323]


portfolio before change:  [-12.73174131]
curr_Stock_Price:  93.10456874844773
curr_Factors:  [93.10456875]
mat_Sqrt:  [[0.15]]
grads:  [0.06912797]
Stock Position:  0.06912796776764529
Bond Position:  [-19.16787094]


portfolio before change:  [-12.71992486]
curr_Stock_Price:  93.3448334856725
curr_Factors:  [93.34483349]
mat_Sqrt:  [[0.15]]
grads:  [0.07679476]
Stock Position:  0.0767947561860712
Bond Position:  [-19.88831859]


portfolio before change:  [-12.63227037]
curr_Stock_Price:  94.55099905162781
curr_Factors:  [94.55099905]
mat_Sqrt:  [[0.15]]
grads:  [-0.24869762]
Stock Position:  -0.24869762423221917
Bond Position:  [10.88233846]


portfolio before change:  [-12.47512914]
curr_Stock_Price:  93.93008316057245
curr_Factors:  [93.93008316]
mat_Sqrt:  [[0.15]]
grads:  [0.00087571]
Stock Position:  0.000875709124010619
Bond Position:  [-12.55738457]


portfolio before change:  [-12.4777838]
curr_Stock_Price:  94.48401396020171
curr_Factors:  [94.48401396]
mat_Sqrt:  [[0.15]]
grads:  [-0.17590444]
Stock Position:  -0.1759044410248185
Bond Position:  [4.14237386]


portfolio before change:  [-12.51481539]
curr_Stock_Price:  94.7004230175011
curr_Factors:  [94.70042302]
mat_Sqrt:  [[0.15]]
grads:  [0.01477306]
Stock Position:  0.014773057180644871
Bond Position:  [-13.91383015]


portfolio before change:  [-12.51456512]
curr_Stock_Price:  94.95285309456742
curr_Factors:  [94.95285309]
mat_Sqrt:  [[0.15]]
grads:  [-0.02299374]
Stock Position:  -0.022993743855035203
Bond Position:  [-10.33124353]


portfolio before change:  [-12.51098076]
curr_Stock_Price:  94.68462819298797
curr_Factors:  [94.68462819]
mat_Sqrt:  [[0.15]]
grads:  [-0.00220676]
Stock Position:  -0.0022067558904207336
Bond Position:  [-12.3020349]


portfolio before change:  [-12.51380431]
curr_Stock_Price:  94.57028163522516
curr_Factors:  [94.57028164]
mat_Sqrt:  [[0.15]]
grads:  [0.04810648]
Stock Position:  0.04810647547472561
Bond Position:  [-17.06324725]


portfolio before change:  [-12.60835932]
curr_Stock_Price:  92.69343108205324
curr_Factors:  [92.69343108]
mat_Sqrt:  [[0.15]]
grads:  [-0.0687949]
Stock Position:  -0.0687948976724855
Bond Position:  [-6.23152422]


portfolio before change:  [-12.47339232]
curr_Stock_Price:  90.70890773322996
curr_Factors:  [90.70890773]
mat_Sqrt:  [[0.15]]
grads:  [0.06312942]
Stock Position:  0.06312941524010558
Bond Position:  [-18.19979262]


portfolio before change:  [-12.5137665]
curr_Stock_Price:  90.14144381187279
curr_Factors:  [90.14144381]
mat_Sqrt:  [[0.15]]
grads:  [-0.0115769]
Stock Position:  -0.01157689963038942
Bond Position:  [-11.47020805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.5137665]
Stock Price:  88.88320911406997
PL:  [-12.5137665]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.20567178e-02]
 [ 7.16228367e-03]
 [-1.04677065e-02]
 [ 2.72031310e-03]
 [ 5.26770298e-03]
 [-1.08051349e-02]
 [-4.28519791e-03]
 [ 1.02620928e-03]
 [ 3.20690457e-03]
 [ 7.87247525e-02]
 [-1.33522946e-02]
 [-1.99711605e-02]
 [-1.40833133e-03]
 [-2.04411819e-02]
 [ 5.42680519e-03]
 [ 6.94892289e-03]
 [-2.34297327e-02]
 [-8.22883920e-03]
 [ 4.61126626e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.3953904]
curr_Stock_Price:  99.85849197821882
curr_Factors:  [99.85849198]
mat_Sqrt:  [[0.15]]
grads:  [0.14704479]
Stock Position:  0.14704478547451563
Bond Position:  [-15.07906093]


portfolio before change:  [-0.54523263]
curr_Stock_Price:  98.86510761333432
curr_Factors:  [98.86510761]
mat_Sqrt:  [[0.15]]
grads:  [0.04774856]
Stock Position:  0.04774855777197897
Bond Position:  [-5.26589893]


portfolio before change:  [-0.46363619]
curr_Stock_Price:  100.60155952906001
curr_Factors:  [100.60155953]
mat_Sqrt:  [[0.15]]
grads:  [-0.06978471]
Stock Position:  -0.06978470994402831
Bond Position:  [6.55681446]


portfolio before change:  [-0.58755525]
curr_Stock_Price:  102.40078552641299
curr_Factors:  [102.40078553]
mat_Sqrt:  [[0.15]]
grads:  [0.01813542]
Stock Position:  0.018135420635252426
Bond Position:  [-2.44463657]


portfolio before change:  [-0.56753994]
curr_Stock_Price:  103.5381475901346
curr_Factors:  [103.53814759]
mat_Sqrt:  [[0.15]]
grads:  [0.03511802]
Stock Position:  0.035118019883105187
Bond Position:  [-4.20359467]


portfolio before change:  [-0.59835019]
curr_Stock_Price:  102.69074182335811
curr_Factors:  [102.69074182]
mat_Sqrt:  [[0.15]]
grads:  [-0.07203423]
Stock Position:  -0.07203423297501454
Bond Position:  [6.79889864]


portfolio before change:  [-0.62438721]
curr_Stock_Price:  103.07579433734257
curr_Factors:  [103.07579434]
mat_Sqrt:  [[0.15]]
grads:  [-0.02856799]
Stock Position:  -0.028567986049025697
Bond Position:  [2.32028064]


portfolio before change:  [-0.65105442]
curr_Stock_Price:  104.0295665891304
curr_Factors:  [104.02956659]
mat_Sqrt:  [[0.15]]
grads:  [0.0068414]
Stock Position:  0.006841395223505338
Bond Position:  [-1.3627618]


portfolio before change:  [-0.64537092]
curr_Stock_Price:  104.91012337008753
curr_Factors:  [104.91012337]
mat_Sqrt:  [[0.15]]
grads:  [0.02137936]
Stock Position:  0.02137936383141782
Bond Position:  [-2.88828261]


portfolio before change:  [-0.61480307]
curr_Stock_Price:  106.37368442713851
curr_Factors:  [106.37368443]
mat_Sqrt:  [[0.15]]
grads:  [0.52483168]
Stock Position:  0.5248316831089653
Bond Position:  [-56.44308291]


portfolio before change:  [-1.26908728]
curr_Stock_Price:  105.15391874895259
curr_Factors:  [105.15391875]
mat_Sqrt:  [[0.15]]
grads:  [-0.0890153]
Stock Position:  -0.08901529731552378
Bond Position:  [8.09122006]


portfolio before change:  [-1.15691314]
curr_Stock_Price:  103.91647880729869
curr_Factors:  [103.91647881]
mat_Sqrt:  [[0.15]]
grads:  [-0.13314107]
Stock Position:  -0.13314107026004118
Bond Position:  [12.67863807]


portfolio before change:  [-1.20846069]
curr_Stock_Price:  104.3274534512201
curr_Factors:  [104.32745345]
mat_Sqrt:  [[0.15]]
grads:  [-0.00938888]
Stock Position:  -0.009388875549935062
Bond Position:  [-0.22894321]


portfolio before change:  [-1.20489866]
curr_Stock_Price:  103.94196848432792
curr_Factors:  [103.94196848]
mat_Sqrt:  [[0.15]]
grads:  [-0.13627455]
Stock Position:  -0.13627454600086122
Bond Position:  [12.95974591]


portfolio before change:  [-1.2074801]
curr_Stock_Price:  103.98468944898416
curr_Factors:  [103.98468945]
mat_Sqrt:  [[0.15]]
grads:  [0.0361787]
Stock Position:  0.036178701233708484
Bond Position:  [-4.96951111]


portfolio before change:  [-1.14645893]
curr_Stock_Price:  105.70569370804513
curr_Factors:  [105.70569371]
mat_Sqrt:  [[0.15]]
grads:  [0.04632615]
Stock Position:  0.0463261525690314
Bond Position:  [-6.04339703]


portfolio before change:  [-1.08034472]
curr_Stock_Price:  107.16545771023522
curr_Factors:  [107.16545771]
mat_Sqrt:  [[0.15]]
grads:  [-0.15619822]
Stock Position:  -0.156198217864137
Bond Position:  [15.65870879]


portfolio before change:  [-1.06220619]
curr_Stock_Price:  107.07439801430196
curr_Factors:  [107.07439801]
mat_Sqrt:  [[0.15]]
grads:  [-0.05485893]
Stock Position:  -0.054858927971620786
Bond Position:  [4.8117805]


portfolio before change:  [-1.00561332]
curr_Stock_Price:  106.06472131891162
curr_Factors:  [106.06472132]
mat_Sqrt:  [[0.15]]
grads:  [0.03074178]
Stock Position:  0.030741775066956238
Bond Position:  [-4.26623112]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.00561332]
Stock Price:  108.2360412964111
PL:  [-9.24165461]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.02078404e-02]
 [ 7.38108203e-03]
 [ 1.25358808e-02]
 [ 2.16308628e-03]
 [ 8.48981305e-03]
 [ 1.61985940e-02]
 [-1.15058081e-02]
 [-7.19051614e-04]
 [ 4.00620866e-03]
 [-3.72446466e-02]
 [-4.92487066e-04]
 [-2.63644536e-02]
 [ 2.40727430e-03]
 [-4.13142613e-03]
 [-9.94101467e-04]
 [ 9.60245060e-03]
 [ 3.49185866e-02]
 [ 1.70558009e-02]
 [ 2.90668292e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.24664175]
curr_Stock_Price:  99.01809727390109
curr_Factors:  [99.01809727]
mat_Sqrt:  [[0.15]]
grads:  [0.2013856]
Stock Position:  0.2013856029437199
Bond Position:  [-33.18746097]


portfolio before change:  [-13.30301784]
curr_Stock_Price:  98.7793603160985
curr_Factors:  [98.77936032]
mat_Sqrt:  [[0.15]]
grads:  [0.04920721]
Stock Position:  0.04920721351785109
Bond Position:  [-18.16367492]


portfolio before change:  [-13.35122478]
curr_Stock_Price:  97.89198126109055
curr_Factors:  [97.89198126]
mat_Sqrt:  [[0.15]]
grads:  [0.08357254]
Stock Position:  0.08357253886752326
Bond Position:  [-21.53230619]


portfolio before change:  [-13.35511098]
curr_Stock_Price:  97.90990034747001
curr_Factors:  [97.90990035]
mat_Sqrt:  [[0.15]]
grads:  [0.01442058]
Stock Position:  0.014420575207344589
Bond Position:  [-14.76702807]


portfolio before change:  [-13.34843094]
curr_Stock_Price:  98.62916837851998
curr_Factors:  [98.62916838]
mat_Sqrt:  [[0.15]]
grads:  [0.05659875]
Stock Position:  0.05659875369730024
Bond Position:  [-18.93071895]


portfolio before change:  [-13.38916522]
curr_Stock_Price:  97.99309414854585
curr_Factors:  [97.99309415]
mat_Sqrt:  [[0.15]]
grads:  [0.10799063]
Stock Position:  0.10799062661023989
Bond Position:  [-23.97150086]


portfolio before change:  [-13.43212357]
curr_Stock_Price:  97.65079854110672
curr_Factors:  [97.65079854]
mat_Sqrt:  [[0.15]]
grads:  [-0.07670539]
Stock Position:  -0.07670538730749263
Bond Position:  [-5.94178124]


portfolio before change:  [-13.56110406]
curr_Stock_Price:  99.31293549513639
curr_Factors:  [99.3129355]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479368]
Stock Position:  -0.004793677425234371
Bond Position:  [-13.08502988]


portfolio before change:  [-13.55316225]
curr_Stock_Price:  96.97371440375645
curr_Factors:  [96.9737144]
mat_Sqrt:  [[0.15]]
grads:  [0.02670806]
Stock Position:  0.026708057724432653
Bond Position:  [-16.14314181]


portfolio before change:  [-13.5506311]
curr_Stock_Price:  97.2196117308133
curr_Factors:  [97.21961173]
mat_Sqrt:  [[0.15]]
grads:  [-0.24829764]
Stock Position:  -0.24829764367749327
Bond Position:  [10.58876941]


portfolio before change:  [-13.05753292]
curr_Stock_Price:  95.24435875777307
curr_Factors:  [95.24435876]
mat_Sqrt:  [[0.15]]
grads:  [-0.00328325]
Stock Position:  -0.0032832471088308527
Bond Position:  [-12.74482215]


portfolio before change:  [-13.06336232]
curr_Stock_Price:  96.04929411886991
curr_Factors:  [96.04929412]
mat_Sqrt:  [[0.15]]
grads:  [-0.17576302]
Stock Position:  -0.1757630243304824
Bond Position:  [3.81855209]


portfolio before change:  [-12.96655576]
curr_Stock_Price:  95.50394731428968
curr_Factors:  [95.50394731]
mat_Sqrt:  [[0.15]]
grads:  [0.0160485]
Stock Position:  0.016048495321949054
Bond Position:  [-14.49925041]


portfolio before change:  [-12.98623907]
curr_Stock_Price:  94.50335274647655
curr_Factors:  [94.50335275]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754284]
Stock Position:  -0.027542840858281736
Bond Position:  [-10.38334826]


portfolio before change:  [-13.01940876]
curr_Stock_Price:  95.61338842339423
curr_Factors:  [95.61338842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00662734]
Stock Position:  -0.006627343114767922
Bond Position:  [-12.38574603]


portfolio before change:  [-13.02406262]
curr_Stock_Price:  95.84832875151778
curr_Factors:  [95.84832875]
mat_Sqrt:  [[0.15]]
grads:  [0.06401634]
Stock Position:  0.06401633735811905
Bond Position:  [-19.15992157]


portfolio before change:  [-13.06656437]
curr_Stock_Price:  95.25924205608858
curr_Factors:  [95.25924206]
mat_Sqrt:  [[0.15]]
grads:  [0.23279058]
Stock Position:  0.23279057722388063
Bond Position:  [-35.24201831]


portfolio before change:  [-13.19345498]
curr_Stock_Price:  94.75200930393697
curr_Factors:  [94.7520093]
mat_Sqrt:  [[0.15]]
grads:  [0.11370534]
Stock Position:  0.11370533906679757
Bond Position:  [-23.96726433]


portfolio before change:  [-13.08256773]
curr_Stock_Price:  95.77992777689138
curr_Factors:  [95.77992778]
mat_Sqrt:  [[0.15]]
grads:  [0.01937789]
Stock Position:  0.01937788614701453
Bond Position:  [-14.93858026]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.08256773]
Stock Price:  95.1789562764768
PL:  [-13.08256773]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.86464330e-02]
 [-7.68050885e-03]
 [-1.05570566e-02]
 [ 9.87602679e-04]
 [ 9.33654643e-03]
 [ 6.90628462e-02]
 [-2.45081182e-03]
 [ 8.83274728e-03]
 [ 1.11697568e-02]
 [-3.73631964e-02]
 [ 2.43178772e-03]
 [-2.64377438e-02]
 [ 1.03694980e-03]
 [-1.43510074e-02]
 [ 3.74701111e-03]
 [-4.07713071e-03]
 [-7.46130614e-02]
 [ 8.23380711e-03]
 [-2.31798983e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.03381008]
curr_Stock_Price:  100.0173471091769
curr_Factors:  [100.01734711]
mat_Sqrt:  [[0.15]]
grads:  [0.19097622]
Stock Position:  0.19097622001964187
Bond Position:  [-17.06712481]


portfolio before change:  [2.32858528]
curr_Stock_Price:  101.58320969616312
curr_Factors:  [101.5832097]
mat_Sqrt:  [[0.15]]
grads:  [-0.05120339]
Stock Position:  -0.051203392332669
Bond Position:  [7.52999022]


portfolio before change:  [2.38525691]
curr_Stock_Price:  100.51318497905935
curr_Factors:  [100.51318498]
mat_Sqrt:  [[0.15]]
grads:  [-0.07038038]
Stock Position:  -0.07038037737511338
Bond Position:  [9.4594128]


portfolio before change:  [2.59605931]
curr_Stock_Price:  97.5516030696521
curr_Factors:  [97.55160307]
mat_Sqrt:  [[0.15]]
grads:  [0.00658402]
Stock Position:  0.006584017858877425
Bond Position:  [1.95377781]


portfolio before change:  [2.57902453]
curr_Stock_Price:  94.89011399122435
curr_Factors:  [94.89011399]
mat_Sqrt:  [[0.15]]
grads:  [0.06224364]
Stock Position:  0.06224364284033802
Bond Position:  [-3.32728184]


portfolio before change:  [2.53828059]
curr_Stock_Price:  94.24889171802701
curr_Factors:  [94.24889172]
mat_Sqrt:  [[0.15]]
grads:  [0.46041897]
Stock Position:  0.4604189746828776
Bond Position:  [-40.8556975]


portfolio before change:  [2.9075596]
curr_Stock_Price:  95.07312840828904
curr_Factors:  [95.07312841]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633875]
Stock Position:  -0.016338745446020885
Bond Position:  [4.46093525]


portfolio before change:  [2.91906882]
curr_Stock_Price:  94.43698148485619
curr_Factors:  [94.43698148]
mat_Sqrt:  [[0.15]]
grads:  [0.05888498]
Stock Position:  0.05888498189791709
Bond Position:  [-2.64185113]


portfolio before change:  [2.86361686]
curr_Stock_Price:  93.50649947789782
curr_Factors:  [93.50649948]
mat_Sqrt:  [[0.15]]
grads:  [0.07446505]
Stock Position:  0.0744650455344398
Bond Position:  [-4.09934889]


portfolio before change:  [2.74643599]
curr_Stock_Price:  91.94662799868873
curr_Factors:  [91.946628]
mat_Sqrt:  [[0.15]]
grads:  [-0.24908798]
Stock Position:  -0.24908797603808278
Bond Position:  [25.64923546]


portfolio before change:  [3.08274853]
curr_Stock_Price:  90.62219864873283
curr_Factors:  [90.62219865]
mat_Sqrt:  [[0.15]]
grads:  [0.01621192]
Stock Position:  0.016211918152985335
Bond Position:  [1.61358886]


portfolio before change:  [3.08345971]
curr_Stock_Price:  90.64118095173596
curr_Factors:  [90.64118095]
mat_Sqrt:  [[0.15]]
grads:  [-0.17625163]
Stock Position:  -0.1762516253534089
Bond Position:  [19.05911518]


portfolio before change:  [3.24554449]
curr_Stock_Price:  89.748596830488
curr_Factors:  [89.74859683]
mat_Sqrt:  [[0.15]]
grads:  [0.006913]
Stock Position:  0.006912998669324644
Bond Position:  [2.62511256]


portfolio before change:  [3.23253189]
curr_Stock_Price:  87.77131291432444
curr_Factors:  [87.77131291]
mat_Sqrt:  [[0.15]]
grads:  [-0.09567338]
Stock Position:  -0.09567338259478729
Bond Position:  [11.62991029]


portfolio before change:  [3.21128312]
curr_Stock_Price:  88.02380334981429
curr_Factors:  [88.02380335]
mat_Sqrt:  [[0.15]]
grads:  [0.02498007]
Stock Position:  0.02498007405104351
Bond Position:  [1.01244199]


portfolio before change:  [3.22399153]
curr_Stock_Price:  88.52241162209415
curr_Factors:  [88.52241162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02718087]
Stock Position:  -0.027180871424306367
Bond Position:  [5.63010782]


portfolio before change:  [3.21125786]
curr_Stock_Price:  89.04268095718069
curr_Factors:  [89.04268096]
mat_Sqrt:  [[0.15]]
grads:  [-0.49742041]
Stock Position:  -0.49742040939605797
Bond Position:  [47.50290467]


portfolio before change:  [2.72187385]
curr_Stock_Price:  90.0504024123603
curr_Factors:  [90.05040241]
mat_Sqrt:  [[0.15]]
grads:  [0.05489205]
Stock Position:  0.05489204737651315
Bond Position:  [-2.2211771]


portfolio before change:  [2.67716148]
curr_Stock_Price:  89.24596877515532
curr_Factors:  [89.24596878]
mat_Sqrt:  [[0.15]]
grads:  [-0.01545327]
Stock Position:  -0.015453265520591244
Bond Position:  [4.05630313]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.67716148]
Stock Price:  89.84746298491248
PL:  [2.67716148]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.72282500e-02]
 [-7.29739837e-03]
 [ 4.63676858e-03]
 [ 2.66827460e-04]
 [ 5.88199639e-03]
 [-4.28033518e-03]
 [ 1.17963869e-03]
 [ 8.49647917e-05]
 [-5.77322593e-05]
 [ 5.00277507e-02]
 [-1.11122994e-02]
 [-2.01878980e-02]
 [-9.18348373e-04]
 [-1.81337742e-02]
 [-3.21412193e-03]
 [ 9.17011783e-03]
 [ 1.25451390e-02]
 [ 1.60891944e-02]
 [ 3.74844129e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.70952799]
curr_Stock_Price:  102.21953693615701
curr_Factors:  [102.21953694]
mat_Sqrt:  [[0.15]]
grads:  [-0.24818833]
Stock Position:  -0.2481883335132161
Bond Position:  [61.07922451]


portfolio before change:  [35.7787417]
curr_Stock_Price:  102.00219393557808
curr_Factors:  [102.00219394]
mat_Sqrt:  [[0.15]]
grads:  [-0.04864932]
Stock Position:  -0.04864932245148404
Bond Position:  [40.74107933]


portfolio before change:  [35.78687313]
curr_Stock_Price:  102.0444374305878
curr_Factors:  [102.04443743]
mat_Sqrt:  [[0.15]]
grads:  [0.03091179]
Stock Position:  0.030911790560478037
Bond Position:  [32.63249685]


portfolio before change:  [35.81957217]
curr_Stock_Price:  102.8383058893129
curr_Factors:  [102.83830589]
mat_Sqrt:  [[0.15]]
grads:  [0.00177885]
Stock Position:  0.00177884973180488
Bond Position:  [35.63663827]


portfolio before change:  [35.82758646]
curr_Stock_Price:  102.33462203258019
curr_Factors:  [102.33462203]
mat_Sqrt:  [[0.15]]
grads:  [0.03921331]
Stock Position:  0.03921330926948407
Bond Position:  [31.81470728]


portfolio before change:  [35.83119265]
curr_Stock_Price:  102.22372903684263
curr_Factors:  [102.22372904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853557]
Stock Position:  -0.028535567887895595
Bond Position:  [38.74820481]


portfolio before change:  [35.85642736]
curr_Stock_Price:  101.67891974691432
curr_Factors:  [101.67891975]
mat_Sqrt:  [[0.15]]
grads:  [0.00786426]
Stock Position:  0.007864257934557528
Bond Position:  [35.05679811]


portfolio before change:  [35.86891679]
curr_Stock_Price:  102.15247152076637
curr_Factors:  [102.15247152]
mat_Sqrt:  [[0.15]]
grads:  [0.00056643]
Stock Position:  0.0005664319446782171
Bond Position:  [35.81105436]


portfolio before change:  [35.8780826]
curr_Stock_Price:  102.52662663330838
curr_Factors:  [102.52662663]
mat_Sqrt:  [[0.15]]
grads:  [-0.00038488]
Stock Position:  -0.0003848817288792317
Bond Position:  [35.91754323]


portfolio before change:  [35.88660349]
curr_Stock_Price:  103.7208247857254
curr_Factors:  [103.72082479]
mat_Sqrt:  [[0.15]]
grads:  [0.33351834]
Stock Position:  0.3335183381144164
Bond Position:  [1.29380637]


portfolio before change:  [35.78015196]
curr_Stock_Price:  103.40067742421851
curr_Factors:  [103.40067742]
mat_Sqrt:  [[0.15]]
grads:  [-0.074082]
Stock Position:  -0.07408199622768828
Bond Position:  [43.44028056]


portfolio before change:  [35.7720509]
curr_Stock_Price:  103.6566436297044
curr_Factors:  [103.65664363]
mat_Sqrt:  [[0.15]]
grads:  [-0.13458599]
Stock Position:  -0.13458598653511425
Bond Position:  [49.72278255]


portfolio before change:  [35.82882868]
curr_Stock_Price:  103.32714772562771
curr_Factors:  [103.32714773]
mat_Sqrt:  [[0.15]]
grads:  [-0.00612232]
Stock Position:  -0.006122322487346933
Bond Position:  [36.4614308]


portfolio before change:  [35.84596589]
curr_Stock_Price:  102.017071316098
curr_Factors:  [102.01707132]
mat_Sqrt:  [[0.15]]
grads:  [-0.12089183]
Stock Position:  -0.1208918280860392
Bond Position:  [48.17899614]


portfolio before change:  [35.99316325]
curr_Stock_Price:  100.8991205827156
curr_Factors:  [100.89912058]
mat_Sqrt:  [[0.15]]
grads:  [-0.02142748]
Stock Position:  -0.021427479533941442
Bond Position:  [38.15517709]


portfolio before change:  [35.9804822]
curr_Stock_Price:  101.93615508820523
curr_Factors:  [101.93615509]
mat_Sqrt:  [[0.15]]
grads:  [0.06113412]
Stock Position:  0.06113411885125902
Bond Position:  [29.74870518]


portfolio before change:  [35.88282841]
curr_Stock_Price:  100.21711658667364
curr_Factors:  [100.21711659]
mat_Sqrt:  [[0.15]]
grads:  [0.08363426]
Stock Position:  0.0836342601147668
Bond Position:  [27.50124401]


portfolio before change:  [35.90136041]
curr_Stock_Price:  100.35648326987395
curr_Factors:  [100.35648327]
mat_Sqrt:  [[0.15]]
grads:  [0.1072613]
Stock Position:  0.10726129586532032
Bond Position:  [25.13699396]


portfolio before change:  [35.91134362]
curr_Stock_Price:  100.39096147610684
curr_Factors:  [100.39096148]
mat_Sqrt:  [[0.15]]
grads:  [0.02498961]
Stock Position:  0.024989608627093114
Bond Position:  [33.40261278]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.91134362]
Stock Price:  100.27105771789995
PL:  [35.6402859]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 6.46173724e-02]
 [ 8.94842606e-03]
 [ 3.30631338e-02]
 [-7.31032293e-03]
 [ 9.09065261e-03]
 [ 3.85538831e-02]
 [-1.22117673e-02]
 [ 5.62996880e-03]
 [ 5.51420556e-03]
 [-3.73057980e-02]
 [ 3.38478997e-04]
 [-2.63950688e-02]
 [ 1.85795441e-03]
 [-7.35791658e-03]
 [ 1.42206183e-03]
 [ 5.40319509e-03]
 [ 3.11462572e-02]
 [ 1.75869323e-02]
 [ 3.02143363e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.05197226]
curr_Stock_Price:  98.76925149843466
curr_Factors:  [98.7692515]
mat_Sqrt:  [[0.15]]
grads:  [0.43078248]
Stock Position:  0.4307824828500195
Bond Position:  [-59.60003565]


portfolio before change:  [-17.56428818]
curr_Stock_Price:  97.61457583570198
curr_Factors:  [97.61457584]
mat_Sqrt:  [[0.15]]
grads:  [0.05965617]
Stock Position:  0.05965617374586883
Bond Position:  [-23.38760028]


portfolio before change:  [-17.62452464]
curr_Stock_Price:  96.7028709776875
curr_Factors:  [96.70287098]
mat_Sqrt:  [[0.15]]
grads:  [0.22042089]
Stock Position:  0.22042089204511783
Bond Position:  [-38.93985772]


portfolio before change:  [-18.00468812]
curr_Stock_Price:  95.0223256275843
curr_Factors:  [95.02232563]
mat_Sqrt:  [[0.15]]
grads:  [-0.04873549]
Stock Position:  -0.048735486229071444
Bond Position:  [-13.37372888]


portfolio before change:  [-18.0564009]
curr_Stock_Price:  96.01480425951705
curr_Factors:  [96.01480426]
mat_Sqrt:  [[0.15]]
grads:  [0.06060435]
Stock Position:  0.06060435070371175
Bond Position:  [-23.87531577]


portfolio before change:  [-18.03843553]
curr_Stock_Price:  96.40974199011195
curr_Factors:  [96.40974199]
mat_Sqrt:  [[0.15]]
grads:  [0.25702589]
Stock Position:  0.25702588738185916
Bond Position:  [-42.81823502]


portfolio before change:  [-17.67850477]
curr_Stock_Price:  97.85176271950563
curr_Factors:  [97.85176272]
mat_Sqrt:  [[0.15]]
grads:  [-0.08141178]
Stock Position:  -0.08141178182630236
Bond Position:  [-9.71221842]


portfolio before change:  [-17.62106708]
curr_Stock_Price:  97.11641391652152
curr_Factors:  [97.11641392]
mat_Sqrt:  [[0.15]]
grads:  [0.03753313]
Stock Position:  0.037533125339599224
Bond Position:  [-21.26614961]


portfolio before change:  [-17.65744716]
curr_Stock_Price:  96.2888013923311
curr_Factors:  [96.28880139]
mat_Sqrt:  [[0.15]]
grads:  [0.03676137]
Stock Position:  0.03676137042406029
Bond Position:  [-21.19715546]


portfolio before change:  [-17.72851865]
curr_Stock_Price:  94.49965314526004
curr_Factors:  [94.49965315]
mat_Sqrt:  [[0.15]]
grads:  [-0.24870532]
Stock Position:  -0.24870532012764476
Bond Position:  [5.77404783]


portfolio before change:  [-17.51134794]
curr_Stock_Price:  93.63225304606095
curr_Factors:  [93.63225305]
mat_Sqrt:  [[0.15]]
grads:  [0.00225653]
Stock Position:  0.00225652664497406
Bond Position:  [-17.72263162]


portfolio before change:  [-17.51542278]
curr_Stock_Price:  93.79018507335428
curr_Factors:  [93.79018507]
mat_Sqrt:  [[0.15]]
grads:  [-0.17596713]
Stock Position:  -0.17596712564205427
Bond Position:  [-1.0114335]


portfolio before change:  [-17.41126094]
curr_Stock_Price:  93.19680874624666
curr_Factors:  [93.19680875]
mat_Sqrt:  [[0.15]]
grads:  [0.01238636]
Stock Position:  0.012386362715982233
Bond Position:  [-18.56563042]


portfolio before change:  [-17.42604577]
curr_Stock_Price:  92.3779366797365
curr_Factors:  [92.37793668]
mat_Sqrt:  [[0.15]]
grads:  [-0.04905278]
Stock Position:  -0.04905277717073226
Bond Position:  [-12.89465143]


portfolio before change:  [-17.40458424]
curr_Stock_Price:  91.8746908628907
curr_Factors:  [91.87469086]
mat_Sqrt:  [[0.15]]
grads:  [0.00948041]
Stock Position:  0.009480412212391676
Bond Position:  [-18.27559418]


portfolio before change:  [-17.39280205]
curr_Stock_Price:  93.59947352851142
curr_Factors:  [93.59947353]
mat_Sqrt:  [[0.15]]
grads:  [0.0360213]
Stock Position:  0.0360213006042572
Bond Position:  [-20.76437683]


portfolio before change:  [-17.34590747]
curr_Stock_Price:  95.0454602915339
curr_Factors:  [95.04546029]
mat_Sqrt:  [[0.15]]
grads:  [0.20764171]
Stock Position:  0.2076417145466419
Bond Position:  [-37.08130981]


portfolio before change:  [-17.35733615]
curr_Stock_Price:  95.03507131283739
curr_Factors:  [95.03507131]
mat_Sqrt:  [[0.15]]
grads:  [0.11724622]
Stock Position:  0.11724621538415021
Bond Position:  [-28.49983859]


portfolio before change:  [-17.26139173]
curr_Stock_Price:  95.91416379807566
curr_Factors:  [95.9141638]
mat_Sqrt:  [[0.15]]
grads:  [0.02014289]
Stock Position:  0.02014289089273786
Bond Position:  [-19.19338027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.26139173]
Stock Price:  96.3843181191833
PL:  [-17.26139173]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.44636816e-02]
 [ 8.72336580e-03]
 [ 1.60788634e-02]
 [ 3.36181436e-03]
 [ 8.55098309e-03]
 [ 3.70310153e-02]
 [-7.77054309e-03]
 [ 4.07774762e-03]
 [ 2.66895617e-03]
 [-3.09669871e-02]
 [-1.03371272e-03]
 [-2.29888204e-02]
 [ 2.59509939e-04]
 [-7.04833794e-04]
 [-3.35288099e-03]
 [ 1.10250161e-02]
 [ 4.61351771e-02]
 [ 1.58553821e-02]
 [ 3.80656479e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.52536451]
curr_Stock_Price:  99.45762846370378
curr_Factors:  [99.45762846]
mat_Sqrt:  [[0.15]]
grads:  [0.09642454]
Stock Position:  0.0964245442404045
Bond Position:  [-16.11552101]


portfolio before change:  [-6.64883061]
curr_Stock_Price:  98.21897378315624
curr_Factors:  [98.21897378]
mat_Sqrt:  [[0.15]]
grads:  [0.05815577]
Stock Position:  0.05815577202872408
Bond Position:  [-12.36083086]


portfolio before change:  [-6.68289011]
curr_Stock_Price:  97.68645736702939
curr_Factors:  [97.68645737]
mat_Sqrt:  [[0.15]]
grads:  [0.10719242]
Stock Position:  0.1071924228886567
Bond Position:  [-17.15413816]


portfolio before change:  [-6.5952937]
curr_Stock_Price:  98.5436586010459
curr_Factors:  [98.5436586]
mat_Sqrt:  [[0.15]]
grads:  [0.0224121]
Stock Position:  0.022412095762875794
Bond Position:  [-8.80386361]


portfolio before change:  [-6.60022556]
curr_Stock_Price:  98.42182197491186
curr_Factors:  [98.42182197]
mat_Sqrt:  [[0.15]]
grads:  [0.05700655]
Stock Position:  0.057006553951957965
Bond Position:  [-12.21091446]


portfolio before change:  [-6.7118317]
curr_Stock_Price:  96.51760174463006
curr_Factors:  [96.51760174]
mat_Sqrt:  [[0.15]]
grads:  [0.24687344]
Stock Position:  0.24687343547421342
Bond Position:  [-30.53946363]


portfolio before change:  [-6.70221468]
curr_Stock_Price:  96.58748711195787
curr_Factors:  [96.58748711]
mat_Sqrt:  [[0.15]]
grads:  [-0.05180362]
Stock Position:  -0.05180362062547233
Bond Position:  [-1.69863314]


portfolio before change:  [-6.76793719]
curr_Stock_Price:  97.84797434105003
curr_Factors:  [97.84797434]
mat_Sqrt:  [[0.15]]
grads:  [0.02718498]
Stock Position:  0.027184984128172947
Bond Position:  [-9.42793282]


portfolio before change:  [-6.77938892]
curr_Stock_Price:  97.51343494438976
curr_Factors:  [97.51343494]
mat_Sqrt:  [[0.15]]
grads:  [0.01779304]
Stock Position:  0.017793041133987976
Bond Position:  [-8.51444948]


portfolio before change:  [-6.74888841]
curr_Stock_Price:  99.34726379170459
curr_Factors:  [99.34726379]
mat_Sqrt:  [[0.15]]
grads:  [-0.20644658]
Stock Position:  -0.2064465803856549
Bond Position:  [13.76101447]


portfolio before change:  [-6.59862559]
curr_Stock_Price:  98.63607676413804
curr_Factors:  [98.63607676]
mat_Sqrt:  [[0.15]]
grads:  [-0.00689142]
Stock Position:  -0.006891418113823405
Bond Position:  [-5.91888315]


portfolio before change:  [-6.61446976]
curr_Stock_Price:  100.72044639447203
curr_Factors:  [100.72044639]
mat_Sqrt:  [[0.15]]
grads:  [-0.1532588]
Stock Position:  -0.1532588024405119
Bond Position:  [8.82182524]


portfolio before change:  [-6.6412518]
curr_Stock_Price:  100.90958898947945
curr_Factors:  [100.90958899]
mat_Sqrt:  [[0.15]]
grads:  [0.00173007]
Stock Position:  0.0017300662587522405
Bond Position:  [-6.81583207]


portfolio before change:  [-6.64532381]
curr_Stock_Price:  99.54094686079436
curr_Factors:  [99.54094686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00469889]
Stock Position:  -0.0046988919606934364
Bond Position:  [-6.17759165]


portfolio before change:  [-6.64927838]
curr_Stock_Price:  100.05382866401828
curr_Factors:  [100.05382866]
mat_Sqrt:  [[0.15]]
grads:  [-0.02235254]
Stock Position:  -0.022352539931439677
Bond Position:  [-4.41282118]


portfolio before change:  [-6.63099134]
curr_Stock_Price:  99.18634866932115
curr_Factors:  [99.18634867]
mat_Sqrt:  [[0.15]]
grads:  [0.07350011]
Stock Position:  0.07350010746186697
Bond Position:  [-13.92119862]


portfolio before change:  [-6.628774]
curr_Stock_Price:  99.26387333765686
curr_Factors:  [99.26387334]
mat_Sqrt:  [[0.15]]
grads:  [0.30756785]
Stock Position:  0.30756784761309675
Bond Position:  [-37.15914987]


portfolio before change:  [-6.28904292]
curr_Stock_Price:  100.39865395166397
curr_Factors:  [100.39865395]
mat_Sqrt:  [[0.15]]
grads:  [0.10570255]
Stock Position:  0.10570254716613844
Bond Position:  [-16.90143637]


portfolio before change:  [-6.37081138]
curr_Stock_Price:  99.6650616668557
curr_Factors:  [99.66506167]
mat_Sqrt:  [[0.15]]
grads:  [0.0253771]
Stock Position:  0.02537709862623986
Bond Position:  [-8.90002148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.37081138]
Stock Price:  101.31133935215155
PL:  [-7.68215073]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.96911046e-02]
 [-6.59676940e-03]
 [-2.28851338e-03]
 [ 3.58155141e-03]
 [ 6.10719151e-03]
 [ 4.31920521e-03]
 [-1.18733872e-02]
 [-1.67011670e-03]
 [-1.30776781e-03]
 [-3.79326114e-02]
 [-9.70526681e-04]
 [-2.63465205e-02]
 [ 2.78744511e-03]
 [-3.58501190e-04]
 [-2.54950821e-03]
 [ 1.13166000e-02]
 [ 5.04105734e-02]
 [ 1.95977267e-02]
 [ 3.91709023e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.56060557]
curr_Stock_Price:  101.62125232243422
curr_Factors:  [101.62125232]
mat_Sqrt:  [[0.15]]
grads:  [-0.26460736]
Stock Position:  -0.2646073637189898
Bond Position:  [53.45033724]


portfolio before change:  [26.34909859]
curr_Stock_Price:  102.47108215499507
curr_Factors:  [102.47108215]
mat_Sqrt:  [[0.15]]
grads:  [-0.04397846]
Stock Position:  -0.04397846267778913
Bond Position:  [30.85561925]


portfolio before change:  [26.39539099]
curr_Stock_Price:  101.59389070545869
curr_Factors:  [101.59389071]
mat_Sqrt:  [[0.15]]
grads:  [-0.01525676]
Stock Position:  -0.015256755855836407
Bond Position:  [27.94538418]


portfolio before change:  [26.39515334]
curr_Stock_Price:  102.06744328960737
curr_Factors:  [102.06744329]
mat_Sqrt:  [[0.15]]
grads:  [0.02387701]
Stock Position:  0.02387700940791231
Bond Position:  [23.95808803]


portfolio before change:  [26.39723824]
curr_Stock_Price:  101.90388135271705
curr_Factors:  [101.90388135]
mat_Sqrt:  [[0.15]]
grads:  [0.04071461]
Stock Position:  0.04071461004978727
Bond Position:  [22.24826145]


portfolio before change:  [26.32001059]
curr_Stock_Price:  99.8704488682453
curr_Factors:  [99.87044887]
mat_Sqrt:  [[0.15]]
grads:  [0.0287947]
Stock Position:  0.028794701415658458
Bond Position:  [23.44427083]


portfolio before change:  [26.32664084]
curr_Stock_Price:  99.89713618431327
curr_Factors:  [99.89713618]
mat_Sqrt:  [[0.15]]
grads:  [-0.07915591]
Stock Position:  -0.07915591449005743
Bond Position:  [34.23409001]


portfolio before change:  [26.25793851]
curr_Stock_Price:  100.87320878311247
curr_Factors:  [100.87320878]
mat_Sqrt:  [[0.15]]
grads:  [-0.01113411]
Stock Position:  -0.011134111342371928
Bond Position:  [27.38107205]


portfolio before change:  [26.26368556]
curr_Stock_Price:  100.97192183494383
curr_Factors:  [100.97192183]
mat_Sqrt:  [[0.15]]
grads:  [-0.00871845]
Stock Position:  -0.00871845206649147
Bond Position:  [27.14400442]


portfolio before change:  [26.28841809]
curr_Stock_Price:  98.91356519943257
curr_Factors:  [98.9135652]
mat_Sqrt:  [[0.15]]
grads:  [-0.25288408]
Stock Position:  -0.2528840760210865
Bond Position:  [51.30208363]


portfolio before change:  [26.68234522]
curr_Stock_Price:  97.4065505504501
curr_Factors:  [97.40655055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647018]
Stock Position:  -0.006470177871831772
Bond Position:  [27.31258293]


portfolio before change:  [26.68939396]
curr_Stock_Price:  97.37258880101642
curr_Factors:  [97.3725888]
mat_Sqrt:  [[0.15]]
grads:  [-0.17564347]
Stock Position:  -0.17564347003948502
Bond Position:  [43.79225334]


portfolio before change:  [26.60064216]
curr_Stock_Price:  97.94022292825258
curr_Factors:  [97.94022293]
mat_Sqrt:  [[0.15]]
grads:  [0.01858297]
Stock Position:  0.018582967417531793
Bond Position:  [24.78062219]


portfolio before change:  [26.63502735]
curr_Stock_Price:  99.45716353397233
curr_Factors:  [99.45716353]
mat_Sqrt:  [[0.15]]
grads:  [-0.00239001]
Stock Position:  -0.002390007931469598
Bond Position:  [26.87273076]


portfolio before change:  [26.64330226]
curr_Stock_Price:  98.8061668825387
curr_Factors:  [98.80616688]
mat_Sqrt:  [[0.15]]
grads:  [-0.01699672]
Stock Position:  -0.016996721382825538
Bond Position:  [28.32268315]


portfolio before change:  [26.65007012]
curr_Stock_Price:  98.82462296347924
curr_Factors:  [98.82462296]
mat_Sqrt:  [[0.15]]
grads:  [0.075444]
Stock Position:  0.07544400015561252
Bond Position:  [19.19434525]


portfolio before change:  [26.57264167]
curr_Stock_Price:  97.734706791176
curr_Factors:  [97.73470679]
mat_Sqrt:  [[0.15]]
grads:  [0.33607049]
Stock Position:  0.33607048946369955
Bond Position:  [-6.27310908]


portfolio before change:  [26.89577215]
curr_Stock_Price:  98.70087001337248
curr_Factors:  [98.70087001]
mat_Sqrt:  [[0.15]]
grads:  [0.13065151]
Stock Position:  0.13065151121623525
Bond Position:  [14.00035432]


portfolio before change:  [26.88631805]
curr_Stock_Price:  98.60171600066751
curr_Factors:  [98.601716]
mat_Sqrt:  [[0.15]]
grads:  [0.02611393]
Stock Position:  0.02611393484090771
Bond Position:  [24.31143926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.88631805]
Stock Price:  98.40022229441418
PL:  [26.88631805]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.89179147e-02]
 [-4.63242258e-03]
 [ 3.49894508e-02]
 [ 1.13448972e-03]
 [ 5.17734330e-03]
 [-3.68135707e-02]
 [-1.36985967e-02]
 [ 2.51766304e-03]
 [ 7.25036561e-03]
 [ 9.60996205e-02]
 [-1.57355750e-02]
 [-1.68553283e-02]
 [-4.49110236e-03]
 [-2.67533406e-02]
 [ 2.08534708e-02]
 [ 3.79406011e-03]
 [-5.21112741e-03]
 [-2.10440258e-03]
 [ 5.20406741e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [39.46182695]
curr_Stock_Price:  102.46491476649734
curr_Factors:  [102.46491477]
mat_Sqrt:  [[0.15]]
grads:  [-0.25945276]
Stock Position:  -0.2594527646870324
Bond Position:  [66.04663237]


portfolio before change:  [39.24969054]
curr_Stock_Price:  103.3461932156895
curr_Factors:  [103.34619322]
mat_Sqrt:  [[0.15]]
grads:  [-0.03088282]
Stock Position:  -0.030882817180365417
Bond Position:  [42.44131213]


portfolio before change:  [39.2425553]
curr_Stock_Price:  103.92084601698897
curr_Factors:  [103.92084602]
mat_Sqrt:  [[0.15]]
grads:  [0.23326301]
Stock Position:  0.23326300504355912
Bond Position:  [15.00166647]


portfolio before change:  [38.95769759]
curr_Stock_Price:  102.68357911984772
curr_Factors:  [102.68357912]
mat_Sqrt:  [[0.15]]
grads:  [0.00756326]
Stock Position:  0.007563264789985011
Bond Position:  [38.18107449]


portfolio before change:  [38.97509634]
curr_Stock_Price:  103.72179327009347
curr_Factors:  [103.72179327]
mat_Sqrt:  [[0.15]]
grads:  [0.03451562]
Stock Position:  0.034515621995038756
Bond Position:  [35.39507413]


portfolio before change:  [39.00932129]
curr_Stock_Price:  104.45696980602051
curr_Factors:  [104.45696981]
mat_Sqrt:  [[0.15]]
grads:  [-0.2454238]
Stock Position:  -0.2454238045778374
Bond Position:  [64.64554823]


portfolio before change:  [38.72326196]
curr_Stock_Price:  105.68840185648793
curr_Factors:  [105.68840186]
mat_Sqrt:  [[0.15]]
grads:  [-0.09132398]
Stock Position:  -0.09132397778037217
Bond Position:  [48.37514722]


portfolio before change:  [38.46584242]
curr_Stock_Price:  108.63959653960642
curr_Factors:  [108.63959654]
mat_Sqrt:  [[0.15]]
grads:  [0.01678442]
Stock Position:  0.01678442029280705
Bond Position:  [36.64238977]


portfolio before change:  [38.45644218]
curr_Stock_Price:  107.53369116639158
curr_Factors:  [107.53369117]
mat_Sqrt:  [[0.15]]
grads:  [0.04833577]
Stock Position:  0.048335770749244916
Bond Position:  [33.25871834]


portfolio before change:  [38.48632493]
curr_Stock_Price:  107.97988310352476
curr_Factors:  [107.9798831]
mat_Sqrt:  [[0.15]]
grads:  [0.64066414]
Stock Position:  0.6406641367783128
Bond Position:  [-30.69251367]


portfolio before change:  [37.8632456]
curr_Stock_Price:  107.01930921270619
curr_Factors:  [107.01930921]
mat_Sqrt:  [[0.15]]
grads:  [-0.10490383]
Stock Position:  -0.10490383305137528
Bond Position:  [49.08998135]


portfolio before change:  [37.8091598]
curr_Stock_Price:  107.6518870075479
curr_Factors:  [107.65188701]
mat_Sqrt:  [[0.15]]
grads:  [-0.11236886]
Stock Position:  -0.11236885553317755
Bond Position:  [49.90587913]


portfolio before change:  [37.56900429]
curr_Stock_Price:  109.90013924936763
curr_Factors:  [109.90013925]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994068]
Stock Position:  -0.029940682416548563
Bond Position:  [40.85948946]


portfolio before change:  [37.6399378]
curr_Stock_Price:  107.8722177972389
curr_Factors:  [107.8722178]
mat_Sqrt:  [[0.15]]
grads:  [-0.1783556]
Stock Position:  -0.1783556040478644
Bond Position:  [56.87955236]


portfolio before change:  [37.49217022]
curr_Stock_Price:  108.7804552577744
curr_Factors:  [108.78045526]
mat_Sqrt:  [[0.15]]
grads:  [0.13902314]
Stock Position:  0.13902313874936184
Bond Position:  [22.3691699]


portfolio before change:  [37.3750894]
curr_Stock_Price:  107.89805677239184
curr_Factors:  [107.89805677]
mat_Sqrt:  [[0.15]]
grads:  [0.02529373]
Stock Position:  0.025293734083610804
Bond Position:  [34.64594465]


portfolio before change:  [37.42115835]
curr_Stock_Price:  109.376935806315
curr_Factors:  [109.37693581]
mat_Sqrt:  [[0.15]]
grads:  [-0.03474085]
Stock Position:  -0.03474084940146986
Bond Position:  [41.221006]


portfolio before change:  [37.42301171]
curr_Stock_Price:  109.6202568054799
curr_Factors:  [109.62025681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01402935]
Stock Position:  -0.014029350517557188
Bond Position:  [38.96091271]


portfolio before change:  [37.43013286]
curr_Stock_Price:  109.8070287800135
curr_Factors:  [109.80702878]
mat_Sqrt:  [[0.15]]
grads:  [0.03469378]
Stock Position:  0.03469378273722202
Bond Position:  [33.62051167]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [37.43013286]
Stock Price:  110.59657933905615
PL:  [26.83355353]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-1.64865182e-02]
 [-7.65779416e-03]
 [ 1.14896945e-02]
 [ 1.91053108e-03]
 [ 6.86691104e-03]
 [ 8.81288474e-03]
 [-1.53449967e-02]
 [ 1.62319779e-03]
 [ 1.62752439e-03]
 [-3.72217031e-02]
 [-1.02879511e-03]
 [-2.43233376e-02]
 [ 1.70016640e-04]
 [-4.29151770e-03]
 [-3.41432124e-03]
 [ 1.05725945e-02]
 [-1.73256996e-02]
 [-2.70405675e-02]
 [ 4.63019449e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.40708423]
curr_Stock_Price:  101.08806096518066
curr_Factors:  [101.08806097]
mat_Sqrt:  [[0.15]]
grads:  [-0.10991012]
Stock Position:  -0.10991012148586483
Bond Position:  [29.5176853]


portfolio before change:  [18.35476855]
curr_Stock_Price:  101.63119588858429
curr_Factors:  [101.63119589]
mat_Sqrt:  [[0.15]]
grads:  [-0.05105196]
Stock Position:  -0.05105196105644492
Bond Position:  [23.54324041]


portfolio before change:  [18.31796535]
curr_Stock_Price:  102.4673977616741
curr_Factors:  [102.46739776]
mat_Sqrt:  [[0.15]]
grads:  [0.07659796]
Stock Position:  0.07659796349495769
Bond Position:  [10.46917136]


portfolio before change:  [18.32654176]
curr_Stock_Price:  102.54519074173436
curr_Factors:  [102.54519074]
mat_Sqrt:  [[0.15]]
grads:  [0.01273687]
Stock Position:  0.012736873862305435
Bond Position:  [17.0204366]


portfolio before change:  [18.30905484]
curr_Stock_Price:  100.83813493671352
curr_Factors:  [100.83813494]
mat_Sqrt:  [[0.15]]
grads:  [0.04577941]
Stock Position:  0.045779406931581126
Bond Position:  [13.69274483]


portfolio before change:  [18.2857368]
curr_Stock_Price:  100.2539932349473
curr_Factors:  [100.25399323]
mat_Sqrt:  [[0.15]]
grads:  [0.05875256]
Stock Position:  0.05875256492900797
Bond Position:  [12.39555755]


portfolio before change:  [18.19698615]
curr_Stock_Price:  98.69065846250844
curr_Factors:  [98.69065846]
mat_Sqrt:  [[0.15]]
grads:  [-0.10229998]
Stock Position:  -0.10229997827600443
Bond Position:  [28.29303836]


portfolio before change:  [18.21721959]
curr_Stock_Price:  98.56202403981423
curr_Factors:  [98.56202404]
mat_Sqrt:  [[0.15]]
grads:  [0.01082132]
Stock Position:  0.010821318631098044
Bond Position:  [17.15064852]


portfolio before change:  [18.21470915]
curr_Stock_Price:  97.93376104546535
curr_Factors:  [97.93376105]
mat_Sqrt:  [[0.15]]
grads:  [0.01085016]
Stock Position:  0.010850162584120701
Bond Position:  [17.15211192]


portfolio before change:  [18.2223217]
curr_Stock_Price:  98.24011432268857
curr_Factors:  [98.24011432]
mat_Sqrt:  [[0.15]]
grads:  [-0.24814469]
Stock Position:  -0.2481446873507914
Bond Position:  [42.60008415]


portfolio before change:  [18.15846224]
curr_Stock_Price:  98.54038595375704
curr_Factors:  [98.54038595]
mat_Sqrt:  [[0.15]]
grads:  [-0.00685863]
Stock Position:  -0.00685863408720199
Bond Position:  [18.83431469]


portfolio before change:  [18.15313851]
curr_Stock_Price:  100.0031992242451
curr_Factors:  [100.00319922]
mat_Sqrt:  [[0.15]]
grads:  [-0.16215558]
Stock Position:  -0.1621555842825766
Bond Position:  [34.36921571]


portfolio before change:  [17.99122897]
curr_Stock_Price:  101.05467653845828
curr_Factors:  [101.05467654]
mat_Sqrt:  [[0.15]]
grads:  [0.00113344]
Stock Position:  0.0011334442653129283
Bond Position:  [17.87668912]


portfolio before change:  [17.9951848]
curr_Stock_Price:  100.60128340277046
curr_Factors:  [100.6012834]
mat_Sqrt:  [[0.15]]
grads:  [-0.02861012]
Stock Position:  -0.028610117993589704
Bond Position:  [20.87339939]


portfolio before change:  [18.00923818]
curr_Stock_Price:  100.29249853905628
curr_Factors:  [100.29249854]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276214]
Stock Position:  -0.02276214159276431
Bond Position:  [20.29211023]


portfolio before change:  [18.02345058]
curr_Stock_Price:  99.89100989221566
curr_Factors:  [99.89100989]
mat_Sqrt:  [[0.15]]
grads:  [0.07048396]
Stock Position:  0.07048396301342028
Bond Position:  [10.98273633]


portfolio before change:  [18.11560236]
curr_Stock_Price:  101.15946508429872
curr_Factors:  [101.15946508]
mat_Sqrt:  [[0.15]]
grads:  [-0.11550466]
Stock Position:  -0.11550466432279194
Bond Position:  [29.79999241]


portfolio before change:  [17.97843774]
curr_Stock_Price:  102.41149718637354
curr_Factors:  [102.41149719]
mat_Sqrt:  [[0.15]]
grads:  [-0.18027045]
Stock Position:  -0.18027045012947038
Bond Position:  [36.44020443]


portfolio before change:  [17.73784797]
curr_Stock_Price:  103.79664352109357
curr_Factors:  [103.79664352]
mat_Sqrt:  [[0.15]]
grads:  [0.03086796]
Stock Position:  0.030867963241052263
Bond Position:  [14.533857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.73784797]
Stock Price:  106.20749094837788
PL:  [11.53035703]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.12043479e-02]
 [-5.86783431e-03]
 [ 2.97306455e-03]
 [ 2.97804713e-03]
 [ 8.53980038e-03]
 [ 1.41805977e-02]
 [-1.01080468e-02]
 [ 4.95417062e-03]
 [ 1.04909820e-03]
 [ 6.55513320e-03]
 [-5.63613143e-03]
 [-2.17094951e-02]
 [-2.42467150e-04]
 [-1.84751491e-02]
 [-1.09465607e-03]
 [ 8.75428691e-03]
 [-4.67770105e-02]
 [-2.64250760e-02]
 [ 4.61103769e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.89183515]
curr_Stock_Price:  99.69523947544297
curr_Factors:  [99.69523948]
mat_Sqrt:  [[0.15]]
grads:  [0.07469565]
Stock Position:  0.07469565297929656
Bond Position:  [-10.33863616]


portfolio before change:  [-2.85045535]
curr_Stock_Price:  100.2838250265614
curr_Factors:  [100.28382503]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391189]
Stock Position:  -0.03911889541028043
Bond Position:  [1.07253711]


portfolio before change:  [-2.80485884]
curr_Stock_Price:  99.12509227190293
curr_Factors:  [99.12509227]
mat_Sqrt:  [[0.15]]
grads:  [0.01982043]
Stock Position:  0.01982043036254908
Bond Position:  [-4.76956082]


portfolio before change:  [-2.82379303]
curr_Stock_Price:  98.22997290523264
curr_Factors:  [98.22997291]
mat_Sqrt:  [[0.15]]
grads:  [0.01985365]
Stock Position:  0.019853647543868272
Bond Position:  [-4.77401629]


portfolio before change:  [-2.82042521]
curr_Stock_Price:  98.45972771895137
curr_Factors:  [98.45972772]
mat_Sqrt:  [[0.15]]
grads:  [0.056932]
Stock Position:  0.05693200251627686
Bond Position:  [-8.42593467]


portfolio before change:  [-2.84076393]
curr_Stock_Price:  98.13948653568957
curr_Factors:  [98.13948654]
mat_Sqrt:  [[0.15]]
grads:  [0.09453732]
Stock Position:  0.09453731827357058
Bond Position:  [-12.1186078]


portfolio before change:  [-2.92760945]
curr_Stock_Price:  97.25290025538752
curr_Factors:  [97.25290026]
mat_Sqrt:  [[0.15]]
grads:  [-0.06738698]
Stock Position:  -0.06738697879373624
Bond Position:  [3.62596968]


portfolio before change:  [-2.94303353]
curr_Stock_Price:  97.49524220190138
curr_Factors:  [97.4952422]
mat_Sqrt:  [[0.15]]
grads:  [0.0330278]
Stock Position:  0.03302780416373305
Bond Position:  [-6.1630873]


portfolio before change:  [-2.91747633]
curr_Stock_Price:  98.3157073748366
curr_Factors:  [98.31570737]
mat_Sqrt:  [[0.15]]
grads:  [0.00699399]
Stock Position:  0.006993987988542821
Bond Position:  [-3.60509521]


portfolio before change:  [-2.89896582]
curr_Stock_Price:  101.0912197090169
curr_Factors:  [101.09121971]
mat_Sqrt:  [[0.15]]
grads:  [0.04370089]
Stock Position:  0.04370088802216221
Bond Position:  [-7.31674189]


portfolio before change:  [-2.90200364]
curr_Stock_Price:  101.06356796641799
curr_Factors:  [101.06356797]
mat_Sqrt:  [[0.15]]
grads:  [-0.03757421]
Stock Position:  -0.037574209540657
Bond Position:  [0.89538004]


portfolio before change:  [-2.94104851]
curr_Stock_Price:  102.1086661507201
curr_Factors:  [102.10866615]
mat_Sqrt:  [[0.15]]
grads:  [-0.14472997]
Stock Position:  -0.14472996702614702
Bond Position:  [11.83713538]


portfolio before change:  [-2.90036613]
curr_Stock_Price:  101.84802403803823
curr_Factors:  [101.84802404]
mat_Sqrt:  [[0.15]]
grads:  [-0.00161645]
Stock Position:  -0.0016164476637048806
Bond Position:  [-2.73573413]


portfolio before change:  [-2.90138783]
curr_Stock_Price:  102.05692621005991
curr_Factors:  [102.05692621]
mat_Sqrt:  [[0.15]]
grads:  [-0.12316766]
Stock Position:  -0.1231676604244292
Bond Position:  [9.66872501]


portfolio before change:  [-2.86419586]
curr_Stock_Price:  101.77459171139509
curr_Factors:  [101.77459171]
mat_Sqrt:  [[0.15]]
grads:  [-0.00729771]
Stock Position:  -0.007297707101868613
Bond Position:  [-2.1214747]


portfolio before change:  [-2.87092185]
curr_Stock_Price:  102.62356371864287
curr_Factors:  [102.62356372]
mat_Sqrt:  [[0.15]]
grads:  [0.05836191]
Stock Position:  0.05836191276564114
Bond Position:  [-8.86022932]


portfolio before change:  [-2.87141034]
curr_Stock_Price:  102.65315215925558
curr_Factors:  [102.65315216]
mat_Sqrt:  [[0.15]]
grads:  [-0.31184674]
Stock Position:  -0.311846736558639
Bond Position:  [29.14064016]


portfolio before change:  [-2.94796912]
curr_Stock_Price:  102.92201770929856
curr_Factors:  [102.92201771]
mat_Sqrt:  [[0.15]]
grads:  [-0.17616717]
Stock Position:  -0.17616717345281327
Bond Position:  [15.18351183]


portfolio before change:  [-2.8913688]
curr_Stock_Price:  102.62227990664081
curr_Factors:  [102.62227991]
mat_Sqrt:  [[0.15]]
grads:  [0.03074025]
Stock Position:  0.030740251278138057
Bond Position:  [-6.04600347]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.8913688]
Stock Price:  104.35385500960047
PL:  [-7.24522381]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 5.39070364e-02]
 [ 9.03936315e-03]
 [ 1.90668563e-02]
 [ 7.36301096e-04]
 [ 8.62368313e-03]
 [ 1.25215342e-03]
 [-5.72576335e-03]
 [-2.22051191e-03]
 [ 3.13679434e-04]
 [-3.30155680e-02]
 [-9.36761331e-04]
 [-2.63405367e-02]
 [ 2.66862644e-03]
 [-1.95838254e-03]
 [-5.53908799e-04]
 [ 6.80573579e-03]
 [-3.16521589e-03]
 [ 1.64816507e-02]
 [ 1.66891488e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.82645695]
curr_Stock_Price:  98.84939284418415
curr_Factors:  [98.84939284]
mat_Sqrt:  [[0.15]]
grads:  [0.35938024]
Stock Position:  0.3593802427005394
Bond Position:  [-51.35097574]


portfolio before change:  [-16.37082974]
curr_Stock_Price:  97.37036484757809
curr_Factors:  [97.37036485]
mat_Sqrt:  [[0.15]]
grads:  [0.06026242]
Stock Position:  0.06026242098325668
Bond Position:  [-22.23860366]


portfolio before change:  [-16.36778685]
curr_Stock_Price:  97.51312771982329
curr_Factors:  [97.51312772]
mat_Sqrt:  [[0.15]]
grads:  [0.12711238]
Stock Position:  0.1271123751800138
Bond Position:  [-28.76291213]


portfolio before change:  [-16.37982444]
curr_Stock_Price:  97.4750042357638
curr_Factors:  [97.47500424]
mat_Sqrt:  [[0.15]]
grads:  [0.00490867]
Stock Position:  0.004908673970564679
Bond Position:  [-16.85829746]


portfolio before change:  [-16.38060157]
curr_Stock_Price:  98.17539266043384
curr_Factors:  [98.17539266]
mat_Sqrt:  [[0.15]]
grads:  [0.05749122]
Stock Position:  0.05749122084489912
Bond Position:  [-22.02482475]


portfolio before change:  [-16.33204573]
curr_Stock_Price:  99.11575760656437
curr_Factors:  [99.11575761]
mat_Sqrt:  [[0.15]]
grads:  [0.00834769]
Stock Position:  0.008347689492851224
Bond Position:  [-17.1594333]


portfolio before change:  [-16.32598976]
curr_Stock_Price:  100.35518651472792
curr_Factors:  [100.35518651]
mat_Sqrt:  [[0.15]]
grads:  [-0.03817176]
Stock Position:  -0.038171755684055717
Bond Position:  [-12.4952561]


portfolio before change:  [-16.32436083]
curr_Stock_Price:  100.23066676446807
curr_Factors:  [100.23066676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01480341]
Stock Position:  -0.014803412717937642
Bond Position:  [-14.8406049]


portfolio before change:  [-16.30737717]
curr_Stock_Price:  98.83272754578086
curr_Factors:  [98.83272755]
mat_Sqrt:  [[0.15]]
grads:  [0.0020912]
Stock Position:  0.002091196228991678
Bond Position:  [-16.5140558]


portfolio before change:  [-16.31072421]
curr_Stock_Price:  99.20667319197324
curr_Factors:  [99.20667319]
mat_Sqrt:  [[0.15]]
grads:  [-0.22010379]
Stock Position:  -0.2201037866690833
Bond Position:  [5.52504023]


portfolio before change:  [-15.76851326]
curr_Stock_Price:  96.74951642185519
curr_Factors:  [96.74951642]
mat_Sqrt:  [[0.15]]
grads:  [-0.00624508]
Stock Position:  -0.006245075541970908
Bond Position:  [-15.16430523]


portfolio before change:  [-15.77895343]
curr_Stock_Price:  97.81413308081837
curr_Factors:  [97.81413308]
mat_Sqrt:  [[0.15]]
grads:  [-0.17560358]
Stock Position:  -0.17560357831013113
Bond Position:  [1.39755835]


portfolio before change:  [-15.56568305]
curr_Stock_Price:  96.60162395012388
curr_Factors:  [96.60162395]
mat_Sqrt:  [[0.15]]
grads:  [0.01779084]
Stock Position:  0.017790842944487635
Bond Position:  [-17.28430737]


portfolio before change:  [-15.58186764]
curr_Stock_Price:  95.93482196294227
curr_Factors:  [95.93482196]
mat_Sqrt:  [[0.15]]
grads:  [-0.01305588]
Stock Position:  -0.013055883616710657
Bond Position:  [-14.32935377]


portfolio before change:  [-15.57379252]
curr_Stock_Price:  95.04189874380656
curr_Factors:  [95.04189874]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369273]
Stock Position:  -0.0036927253249975293
Bond Position:  [-15.2228289]


portfolio before change:  [-15.57504587]
curr_Stock_Price:  94.35058547235964
curr_Factors:  [94.35058547]
mat_Sqrt:  [[0.15]]
grads:  [0.04537157]
Stock Position:  0.04537157191526901
Bond Position:  [-19.85588025]


portfolio before change:  [-15.63676726]
curr_Stock_Price:  93.09965258432298
curr_Factors:  [93.09965258]
mat_Sqrt:  [[0.15]]
grads:  [-0.02110144]
Stock Position:  -0.021101439252193266
Bond Position:  [-13.67223059]


portfolio before change:  [-15.66859605]
curr_Stock_Price:  94.44602082627372
curr_Factors:  [94.44602083]
mat_Sqrt:  [[0.15]]
grads:  [0.10987767]
Stock Position:  0.10987767120649325
Bond Position:  [-26.04610487]


portfolio before change:  [-15.8809079]
curr_Stock_Price:  92.57303326514943
curr_Factors:  [92.57303327]
mat_Sqrt:  [[0.15]]
grads:  [0.00111261]
Stock Position:  0.001112609918124148
Bond Position:  [-15.98390558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.8809079]
Stock Price:  92.77568185863448
PL:  [-15.8809079]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.03211519e-02]
 [-7.75755941e-03]
 [-2.70867014e-03]
 [ 2.35425334e-03]
 [ 6.37629486e-03]
 [ 1.09711870e-02]
 [-4.71259627e-03]
 [ 5.99255044e-04]
 [-5.49543933e-04]
 [ 2.56884675e-02]
 [-6.85619509e-03]
 [-2.14514223e-02]
 [-1.88653605e-05]
 [-8.82476550e-03]
 [-3.46563099e-03]
 [ 1.06600594e-02]
 [-1.11900154e-02]
 [-1.75717612e-03]
 [ 3.77805803e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.3216984]
curr_Stock_Price:  101.47484123155107
curr_Factors:  [101.47484123]
mat_Sqrt:  [[0.15]]
grads:  [-0.26880768]
Stock Position:  -0.26880767947990625
Bond Position:  [51.598915]


portfolio before change:  [24.35471633]
curr_Stock_Price:  101.40000485498824
curr_Factors:  [101.40000485]
mat_Sqrt:  [[0.15]]
grads:  [-0.05171706]
Stock Position:  -0.05171706274740274
Bond Position:  [29.59882675]


portfolio before change:  [24.44613492]
curr_Stock_Price:  99.77543557034178
curr_Factors:  [99.77543557]
mat_Sqrt:  [[0.15]]
grads:  [-0.0180578]
Stock Position:  -0.018057800922860988
Bond Position:  [26.24785987]


portfolio before change:  [24.43403332]
curr_Stock_Price:  100.80902655775647
curr_Factors:  [100.80902656]
mat_Sqrt:  [[0.15]]
grads:  [0.01569502]
Stock Position:  0.015695022237539862
Bond Position:  [22.85183341]


portfolio before change:  [24.45014118]
curr_Stock_Price:  101.47128662966392
curr_Factors:  [101.47128663]
mat_Sqrt:  [[0.15]]
grads:  [0.04250863]
Stock Position:  0.0425086324311761
Bond Position:  [20.13673555]


portfolio before change:  [24.42616587]
curr_Stock_Price:  100.78883412340691
curr_Factors:  [100.78883412]
mat_Sqrt:  [[0.15]]
grads:  [0.07314125]
Stock Position:  0.07314124698484645
Bond Position:  [17.05434486]


portfolio before change:  [24.40384442]
curr_Stock_Price:  100.4253515480734
curr_Factors:  [100.42535155]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141731]
Stock Position:  -0.031417308481271035
Bond Position:  [27.55893867]


portfolio before change:  [24.33896171]
curr_Stock_Price:  102.70986638644466
curr_Factors:  [102.70986639]
mat_Sqrt:  [[0.15]]
grads:  [0.00399503]
Stock Position:  0.003995033629279286
Bond Position:  [23.92863234]


portfolio before change:  [24.34190743]
curr_Stock_Price:  101.94962713550582
curr_Factors:  [101.94962714]
mat_Sqrt:  [[0.15]]
grads:  [-0.00366363]
Stock Position:  -0.0036636262194167787
Bond Position:  [24.71541276]


portfolio before change:  [24.34807086]
curr_Stock_Price:  101.95404972275338
curr_Factors:  [101.95404972]
mat_Sqrt:  [[0.15]]
grads:  [0.17125645]
Stock Position:  0.17125644980686414
Bond Position:  [6.88778226]


portfolio before change:  [24.32675686]
curr_Stock_Price:  101.81953710627536
curr_Factors:  [101.81953711]
mat_Sqrt:  [[0.15]]
grads:  [-0.04570797]
Stock Position:  -0.04570796725113448
Bond Position:  [28.98072093]


portfolio before change:  [24.30832797]
curr_Stock_Price:  102.38125488223803
curr_Factors:  [102.38125488]
mat_Sqrt:  [[0.15]]
grads:  [-0.14300948]
Stock Position:  -0.1430094821225433
Bond Position:  [38.94981821]


portfolio before change:  [24.46391786]
curr_Stock_Price:  101.36138393314823
curr_Factors:  [101.36138393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00012577]
Stock Position:  -0.00012576906991493305
Bond Position:  [24.47666599]


portfolio before change:  [24.47007959]
curr_Stock_Price:  101.02906220937271
curr_Factors:  [101.02906221]
mat_Sqrt:  [[0.15]]
grads:  [-0.05883177]
Stock Position:  -0.05883177002395448
Bond Position:  [30.41379814]


portfolio before change:  [24.50833791]
curr_Stock_Price:  100.50801860719565
curr_Factors:  [100.50801861]
mat_Sqrt:  [[0.15]]
grads:  [-0.02310421]
Stock Position:  -0.02310420657097447
Bond Position:  [26.83049593]


portfolio before change:  [24.49865556]
curr_Stock_Price:  101.21744820601175
curr_Factors:  [101.21744821]
mat_Sqrt:  [[0.15]]
grads:  [0.07106706]
Stock Position:  0.071067062800194
Bond Position:  [17.30542881]


portfolio before change:  [24.48509277]
curr_Stock_Price:  100.96571858680043
curr_Factors:  [100.96571859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0746001]
Stock Position:  -0.07460010235702244
Bond Position:  [32.01714571]


portfolio before change:  [24.48413051]
curr_Stock_Price:  101.08592681465612
curr_Factors:  [101.08592681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01171451]
Stock Position:  -0.011714507487353584
Bond Position:  [25.66830236]


portfolio before change:  [24.5037274]
curr_Stock_Price:  99.96091082958503
curr_Factors:  [99.96091083]
mat_Sqrt:  [[0.15]]
grads:  [0.02518705]
Stock Position:  0.025187053513062496
Bond Position:  [21.98600659]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.5037274]
Stock Price:  100.03315718886743
PL:  [24.47057021]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.62542927e-01]
 [ 1.00458464e-02]
 [ 3.02114767e-02]
 [-2.07256126e-03]
 [ 9.00268992e-03]
 [ 2.20363752e-02]
 [-1.51281338e-02]
 [ 2.77071860e-03]
 [ 4.24132483e-04]
 [-3.72263905e-02]
 [-9.04750470e-04]
 [-2.63412634e-02]
 [ 2.77299268e-03]
 [ 3.02545074e-06]
 [-1.61763292e-03]
 [ 1.00334955e-02]
 [ 2.60535273e-02]
 [ 1.47067604e-02]
 [ 2.13003419e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-40.48504012]
curr_Stock_Price:  97.23686950784945
curr_Factors:  [97.23686951]
mat_Sqrt:  [[0.15]]
grads:  [1.75028618]
Stock Position:  1.750286178599115
Bond Position:  [-210.67738887]


portfolio before change:  [-41.44407525]
curr_Stock_Price:  96.71903464670262
curr_Factors:  [96.71903465]
mat_Sqrt:  [[0.15]]
grads:  [0.06697231]
Stock Position:  0.06697230930088953
Bond Position:  [-47.92157235]


portfolio before change:  [-41.44616333]
curr_Stock_Price:  96.86676446869548
curr_Factors:  [96.86676447]
mat_Sqrt:  [[0.15]]
grads:  [0.20140984]
Stock Position:  0.20140984494874922
Bond Position:  [-60.95608335]


portfolio before change:  [-41.51133881]
curr_Stock_Price:  96.61883939127495
curr_Factors:  [96.61883939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01381708]
Stock Position:  -0.013817075062304545
Bond Position:  [-40.17634906]


portfolio before change:  [-41.51864086]
curr_Stock_Price:  96.42029568185983
curr_Factors:  [96.42029568]
mat_Sqrt:  [[0.15]]
grads:  [0.06001793]
Stock Position:  0.0600179327878661
Bond Position:  [-47.30558769]


portfolio before change:  [-41.4608883]
curr_Stock_Price:  97.57962316119813
curr_Factors:  [97.57962316]
mat_Sqrt:  [[0.15]]
grads:  [0.14690917]
Stock Position:  0.1469091679420788
Bond Position:  [-55.79622954]


portfolio before change:  [-41.32216798]
curr_Stock_Price:  98.61884434604727
curr_Factors:  [98.61884435]
mat_Sqrt:  [[0.15]]
grads:  [-0.10085423]
Stock Position:  -0.10085422519923452
Bond Position:  [-31.37604084]


portfolio before change:  [-41.28944529]
curr_Stock_Price:  98.2166036079723
curr_Factors:  [98.21660361]
mat_Sqrt:  [[0.15]]
grads:  [0.01847146]
Stock Position:  0.018471457322111702
Bond Position:  [-43.10364909]


portfolio before change:  [-41.290329]
curr_Stock_Price:  98.75221639072174
curr_Factors:  [98.75221639]
mat_Sqrt:  [[0.15]]
grads:  [0.00282755]
Stock Position:  0.0028275498856464936
Bond Position:  [-41.56955582]


portfolio before change:  [-41.30276021]
curr_Stock_Price:  98.0316220525212
curr_Factors:  [98.03162205]
mat_Sqrt:  [[0.15]]
grads:  [-0.24817594]
Stock Position:  -0.24817593686651568
Bond Position:  [-16.97367056]


portfolio before change:  [-40.83422913]
curr_Stock_Price:  96.12662258521794
curr_Factors:  [96.12662259]
mat_Sqrt:  [[0.15]]
grads:  [-0.00603167]
Stock Position:  -0.006031669802785226
Bond Position:  [-40.25442508]


portfolio before change:  [-40.85414908]
curr_Stock_Price:  97.76051328865837
curr_Factors:  [97.76051329]
mat_Sqrt:  [[0.15]]
grads:  [-0.17560842]
Stock Position:  -0.17560842264021242
Bond Position:  [-23.68657955]


portfolio before change:  [-40.73828619]
curr_Stock_Price:  97.06700852241907
curr_Factors:  [97.06700852]
mat_Sqrt:  [[0.15]]
grads:  [0.01848662]
Stock Position:  0.01848661789465823
Bond Position:  [-42.53272689]


portfolio before change:  [-40.74737724]
curr_Stock_Price:  97.1504991841143
curr_Factors:  [97.15049918]
mat_Sqrt:  [[0.15]]
grads:  [2.01696716e-05]
Stock Position:  2.0169671614874107e-05
Bond Position:  [-40.74933673]


portfolio before change:  [-40.75757756]
curr_Stock_Price:  96.56961197091915
curr_Factors:  [96.56961197]
mat_Sqrt:  [[0.15]]
grads:  [-0.01078422]
Stock Position:  -0.010784219493762454
Bond Position:  [-39.71614967]


portfolio before change:  [-40.7622188]
curr_Stock_Price:  96.07916911189186
curr_Factors:  [96.07916911]
mat_Sqrt:  [[0.15]]
grads:  [0.06688997]
Stock Position:  0.06688997026558006
Bond Position:  [-47.18895156]


portfolio before change:  [-40.86246739]
curr_Stock_Price:  94.75685008208536
curr_Factors:  [94.75685008]
mat_Sqrt:  [[0.15]]
grads:  [0.17369018]
Stock Position:  0.17369018205840794
Bond Position:  [-57.32080193]


portfolio before change:  [-41.09508313]
curr_Stock_Price:  93.50010808715832
curr_Factors:  [93.50010809]
mat_Sqrt:  [[0.15]]
grads:  [0.09804507]
Stock Position:  0.09804506947647229
Bond Position:  [-50.26230772]


portfolio before change:  [-40.97320189]
curr_Stock_Price:  94.87139977001709
curr_Factors:  [94.87139977]
mat_Sqrt:  [[0.15]]
grads:  [0.01420023]
Stock Position:  0.014200227939108266
Bond Position:  [-42.32039739]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-40.97320189]
Stock Price:  95.7551733058682
PL:  [-40.97320189]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.01152889e-01]
 [ 8.05869685e-03]
 [ 2.62805827e-03]
 [ 3.85517025e-03]
 [ 7.69793443e-03]
 [ 5.25088505e-03]
 [ 1.55252613e-03]
 [-2.30841610e-03]
 [-1.24904574e-03]
 [ 2.31892815e-02]
 [-6.49080266e-03]
 [-2.19982801e-02]
 [ 2.74991873e-04]
 [-1.91474027e-02]
 [ 3.13801537e-04]
 [ 8.76569460e-03]
 [-4.90287639e-02]
 [-1.36958069e-02]
 [ 4.40579717e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.21675914]
curr_Stock_Price:  97.71217145924984
curr_Factors:  [97.71217146]
mat_Sqrt:  [[0.15]]
grads:  [1.34101926]
Stock Position:  1.3410192604979818
Bond Position:  [-164.25066305]


portfolio before change:  [-32.18282442]
curr_Stock_Price:  98.51380238696356
curr_Factors:  [98.51380239]
mat_Sqrt:  [[0.15]]
grads:  [0.05372465]
Stock Position:  0.05372464568984731
Bond Position:  [-37.47544355]


portfolio before change:  [-32.1574364]
curr_Stock_Price:  99.16076900631755
curr_Factors:  [99.16076901]
mat_Sqrt:  [[0.15]]
grads:  [0.01752039]
Stock Position:  0.01752038846241955
Bond Position:  [-33.8947716]


portfolio before change:  [-32.16376232]
curr_Stock_Price:  99.28341661167222
curr_Factors:  [99.28341661]
mat_Sqrt:  [[0.15]]
grads:  [0.02570113]
Stock Position:  0.02570113498635228
Bond Position:  [-34.71545881]


portfolio before change:  [-32.15822449]
curr_Stock_Price:  99.83661328801702
curr_Factors:  [99.83661329]
mat_Sqrt:  [[0.15]]
grads:  [0.05131956]
Stock Position:  0.05131956289966977
Bond Position:  [-37.28179584]


portfolio before change:  [-32.08005044]
curr_Stock_Price:  101.54153159305301
curr_Factors:  [101.54153159]
mat_Sqrt:  [[0.15]]
grads:  [0.0350059]
Stock Position:  0.03500590032778757
Bond Position:  [-35.63460317]


portfolio before change:  [-32.08749809]
curr_Stock_Price:  101.58329912738365
curr_Factors:  [101.58329913]
mat_Sqrt:  [[0.15]]
grads:  [0.01035017]
Stock Position:  0.010350174191697144
Bond Position:  [-33.13890293]


portfolio before change:  [-32.10777511]
curr_Stock_Price:  100.42474321579095
curr_Factors:  [100.42474322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01538944]
Stock Position:  -0.015389440685151327
Bond Position:  [-30.56229448]


portfolio before change:  [-32.12554133]
curr_Stock_Price:  101.08264185982786
curr_Factors:  [101.08264186]
mat_Sqrt:  [[0.15]]
grads:  [-0.00832697]
Stock Position:  -0.008326971601166216
Bond Position:  [-31.28382904]


portfolio before change:  [-32.13955327]
curr_Stock_Price:  101.82600916066937
curr_Factors:  [101.82600916]
mat_Sqrt:  [[0.15]]
grads:  [0.15459521]
Stock Position:  0.1545952099764296
Bond Position:  [-47.88136653]


portfolio before change:  [-32.18925866]
curr_Stock_Price:  101.58192944308338
curr_Factors:  [101.58192944]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327202]
Stock Position:  -0.04327201776263354
Bond Position:  [-27.7936036]


portfolio before change:  [-32.20580169]
curr_Stock_Price:  101.80363761759136
curr_Factors:  [101.80363762]
mat_Sqrt:  [[0.15]]
grads:  [-0.1466552]
Stock Position:  -0.1466552006317112
Bond Position:  [-17.27576879]


portfolio before change:  [-32.07532332]
curr_Stock_Price:  100.88448950279093
curr_Factors:  [100.8844895]
mat_Sqrt:  [[0.15]]
grads:  [0.00183328]
Stock Position:  0.0018332791525381537
Bond Position:  [-32.26027275]


portfolio before change:  [-32.07928458]
curr_Stock_Price:  103.12354545796885
curr_Factors:  [103.12354546]
mat_Sqrt:  [[0.15]]
grads:  [-0.12764935]
Stock Position:  -0.12764935160019028
Bond Position:  [-18.91563087]


portfolio before change:  [-31.9967069]
curr_Stock_Price:  102.43958442083444
curr_Factors:  [102.43958442]
mat_Sqrt:  [[0.15]]
grads:  [0.00209201]
Stock Position:  0.0020920102435926457
Bond Position:  [-32.21101156]


portfolio before change:  [-32.00444045]
curr_Stock_Price:  102.59264795114807
curr_Factors:  [102.59264795]
mat_Sqrt:  [[0.15]]
grads:  [0.05843796]
Stock Position:  0.058437963983466734
Bond Position:  [-37.99974591]


portfolio before change:  [-32.03944463]
curr_Stock_Price:  102.15623549537425
curr_Factors:  [102.1562355]
mat_Sqrt:  [[0.15]]
grads:  [-0.32685843]
Stock Position:  -0.32685842599051185
Bond Position:  [1.35118171]


portfolio before change:  [-31.81901553]
curr_Stock_Price:  101.4828820084605
curr_Factors:  [101.48288201]
mat_Sqrt:  [[0.15]]
grads:  [-0.09130538]
Stock Position:  -0.09130537928247938
Bond Position:  [-22.55308249]


portfolio before change:  [-31.86813626]
curr_Stock_Price:  101.95910536530747
curr_Factors:  [101.95910537]
mat_Sqrt:  [[0.15]]
grads:  [0.02937198]
Stock Position:  0.029371981107661795
Bond Position:  [-34.86287717]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.86813626]
Stock Price:  102.76555260737577
PL:  [-34.63368886]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.41896207e-02]
 [-8.05314348e-03]
 [-1.06096017e-02]
 [ 2.91610418e-03]
 [ 8.76601241e-03]
 [ 1.12200595e-02]
 [-1.16821828e-02]
 [ 4.26464301e-03]
 [ 3.79181860e-03]
 [-3.72224550e-02]
 [-9.23707891e-04]
 [-2.63838729e-02]
 [ 2.03680015e-03]
 [-7.04154168e-03]
 [ 7.72361546e-04]
 [ 3.98980399e-03]
 [-3.45898543e-02]
 [ 9.57550063e-03]
 [-1.09195831e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.07194346]
curr_Stock_Price:  100.54299278647963
curr_Factors:  [100.54299279]
mat_Sqrt:  [[0.15]]
grads:  [0.2279308]
Stock Position:  0.22793080454084652
Bond Position:  [-12.84490178]


portfolio before change:  [10.08248725]
curr_Stock_Price:  100.60334191570678
curr_Factors:  [100.60334192]
mat_Sqrt:  [[0.15]]
grads:  [-0.05368762]
Stock Position:  -0.05368762321950817
Bond Position:  [15.48364157]


portfolio before change:  [10.09398918]
curr_Stock_Price:  100.4612136021971
curr_Factors:  [100.4612136]
mat_Sqrt:  [[0.15]]
grads:  [-0.07073068]
Stock Position:  -0.07073067795990033
Bond Position:  [17.19967893]


portfolio before change:  [10.26504944]
curr_Stock_Price:  98.10354066902056
curr_Factors:  [98.10354067]
mat_Sqrt:  [[0.15]]
grads:  [0.01944069]
Stock Position:  0.01944069454014939
Bond Position:  [8.35784847]


portfolio before change:  [10.25562626]
curr_Stock_Price:  97.5113343987393
curr_Factors:  [97.5113344]
mat_Sqrt:  [[0.15]]
grads:  [0.05844008]
Stock Position:  0.05844008276390559
Bond Position:  [4.55705581]


portfolio before change:  [10.3111466]
curr_Stock_Price:  98.44187608969747
curr_Factors:  [98.44187609]
mat_Sqrt:  [[0.15]]
grads:  [0.0748004]
Stock Position:  0.07480039673348637
Bond Position:  [2.94765522]


portfolio before change:  [10.25646629]
curr_Stock_Price:  97.70100681586653
curr_Factors:  [97.70100682]
mat_Sqrt:  [[0.15]]
grads:  [-0.07788122]
Stock Position:  -0.077881218497962
Bond Position:  [17.86553975]


portfolio before change:  [10.25534541]
curr_Stock_Price:  97.77275494385961
curr_Factors:  [97.77275494]
mat_Sqrt:  [[0.15]]
grads:  [0.02843095]
Stock Position:  0.028430953384129452
Bond Position:  [7.47557277]


portfolio before change:  [10.23695714]
curr_Stock_Price:  97.06024310466337
curr_Factors:  [97.0602431]
mat_Sqrt:  [[0.15]]
grads:  [0.02527879]
Stock Position:  0.025278790638859686
Bond Position:  [7.78339158]


portfolio before change:  [10.26788358]
curr_Stock_Price:  98.20667250871752
curr_Factors:  [98.20667251]
mat_Sqrt:  [[0.15]]
grads:  [-0.2481497]
Stock Position:  -0.24814969972122913
Bond Position:  [34.63783988]


portfolio before change:  [10.70116815]
curr_Stock_Price:  96.49551177677203
curr_Factors:  [96.49551178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00615805]
Stock Position:  -0.006158052608282531
Bond Position:  [11.29539258]


portfolio before change:  [10.7155644]
curr_Stock_Price:  94.61633826009398
curr_Factors:  [94.61633826]
mat_Sqrt:  [[0.15]]
grads:  [-0.17589249]
Stock Position:  -0.17589248606265565
Bond Position:  [27.35786736]


portfolio before change:  [10.83996757]
curr_Stock_Price:  93.94795922729422
curr_Factors:  [93.94795923]
mat_Sqrt:  [[0.15]]
grads:  [0.01357867]
Stock Position:  0.013578667637209888
Bond Position:  [9.56427945]


portfolio before change:  [10.82387003]
curr_Stock_Price:  92.5863452586763
curr_Factors:  [92.58634526]
mat_Sqrt:  [[0.15]]
grads:  [-0.04694361]
Stock Position:  -0.04694361119136725
Bond Position:  [15.17020743]


portfolio before change:  [10.81218456]
curr_Stock_Price:  92.91607064557084
curr_Factors:  [92.91607065]
mat_Sqrt:  [[0.15]]
grads:  [0.00514908]
Stock Position:  0.00514907697274353
Bond Position:  [10.33375256]


portfolio before change:  [10.81438976]
curr_Stock_Price:  92.84255079563947
curr_Factors:  [92.8425508]
mat_Sqrt:  [[0.15]]
grads:  [0.02659869]
Stock Position:  0.026598693266175283
Bond Position:  [8.34489923]


portfolio before change:  [10.7758531]
curr_Stock_Price:  91.31528993990679
curr_Factors:  [91.31528994]
mat_Sqrt:  [[0.15]]
grads:  [-0.23059903]
Stock Position:  -0.23059902889892847
Bond Position:  [31.83307029]


portfolio before change:  [10.9106057]
curr_Stock_Price:  90.76544661625978
curr_Factors:  [90.76544662]
mat_Sqrt:  [[0.15]]
grads:  [0.06383667]
Stock Position:  0.06383667084359756
Bond Position:  [5.11644176]


portfolio before change:  [10.93212497]
curr_Stock_Price:  91.08250573152094
curr_Factors:  [91.08250573]
mat_Sqrt:  [[0.15]]
grads:  [-0.00727972]
Stock Position:  -0.007279722057384342
Bond Position:  [11.5951803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.93212497]
Stock Price:  91.40763391971731
PL:  [10.93212497]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.05608322e-02]
 [ 8.72759672e-03]
 [-9.93175658e-03]
 [ 3.21369846e-03]
 [ 6.51054700e-03]
 [ 1.98769298e-03]
 [-5.98366101e-04]
 [-1.38513599e-03]
 [-1.00691310e-03]
 [-3.05077996e-02]
 [-1.07476054e-03]
 [-2.45331423e-02]
 [ 1.38569955e-03]
 [ 2.09100586e-03]
 [-2.13621716e-03]
 [ 1.11130402e-02]
 [ 4.78235060e-02]
 [ 1.96866003e-02]
 [ 3.76532036e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.10156768]
curr_Stock_Price:  99.68152422673995
curr_Factors:  [99.68152423]
mat_Sqrt:  [[0.15]]
grads:  [0.07040555]
Stock Position:  0.07040554787142768
Bond Position:  [-10.11970001]


portfolio before change:  [-3.20786954]
curr_Stock_Price:  98.20761168116071
curr_Factors:  [98.20761168]
mat_Sqrt:  [[0.15]]
grads:  [0.05818398]
Stock Position:  0.05818397814261881
Bond Position:  [-8.92197907]


portfolio before change:  [-3.09363158]
curr_Stock_Price:  100.2093436700987
curr_Factors:  [100.20934367]
mat_Sqrt:  [[0.15]]
grads:  [-0.06621171]
Stock Position:  -0.06621171054194663
Bond Position:  [3.54140047]


portfolio before change:  [-3.08093866]
curr_Stock_Price:  100.03101469984257
curr_Factors:  [100.0310147]
mat_Sqrt:  [[0.15]]
grads:  [0.02142466]
Stock Position:  0.02142465642794965
Bond Position:  [-5.22406878]


portfolio before change:  [-3.05500828]
curr_Stock_Price:  101.30228650127458
curr_Factors:  [101.3022865]
mat_Sqrt:  [[0.15]]
grads:  [0.04340365]
Stock Position:  0.04340364667264757
Bond Position:  [-7.45189693]


portfolio before change:  [-3.03634988]
curr_Stock_Price:  101.77509468737047
curr_Factors:  [101.77509469]
mat_Sqrt:  [[0.15]]
grads:  [0.01325129]
Stock Position:  0.01325128651468462
Bond Position:  [-4.38500082]


portfolio before change:  [-3.03269829]
curr_Stock_Price:  102.1333980592159
curr_Factors:  [102.13339806]
mat_Sqrt:  [[0.15]]
grads:  [-0.00398911]
Stock Position:  -0.003989107337082539
Bond Position:  [-2.6252772]


portfolio before change:  [-3.0288195]
curr_Stock_Price:  100.99650498743286
curr_Factors:  [100.99650499]
mat_Sqrt:  [[0.15]]
grads:  [-0.00923424]
Stock Position:  -0.009234239915510116
Bond Position:  [-2.09619355]


portfolio before change:  [-3.02281646]
curr_Stock_Price:  100.28966191118485
curr_Factors:  [100.28966191]
mat_Sqrt:  [[0.15]]
grads:  [-0.00671275]
Stock Position:  -0.006712753979251212
Bond Position:  [-2.34959663]


portfolio before change:  [-3.01729217]
curr_Stock_Price:  99.3791911702232
curr_Factors:  [99.37919117]
mat_Sqrt:  [[0.15]]
grads:  [-0.20338533]
Stock Position:  -0.20338533065379322
Bond Position:  [17.19497749]


portfolio before change:  [-3.02430682]
curr_Stock_Price:  99.43481925906032
curr_Factors:  [99.43481926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00716507]
Stock Position:  -0.0071650702556845525
Bond Position:  [-2.31184935]


portfolio before change:  [-3.02820816]
curr_Stock_Price:  99.8986394478313
curr_Factors:  [99.89863945]
mat_Sqrt:  [[0.15]]
grads:  [-0.16355428]
Stock Position:  -0.16355428200403563
Bond Position:  [13.31064209]


portfolio before change:  [-3.02951283]
curr_Stock_Price:  99.92696488533781
curr_Factors:  [99.92696489]
mat_Sqrt:  [[0.15]]
grads:  [0.009238]
Stock Position:  0.009237997021948103
Bond Position:  [-3.95263783]


portfolio before change:  [-3.03809994]
curr_Stock_Price:  99.1044024773762
curr_Factors:  [99.10440248]
mat_Sqrt:  [[0.15]]
grads:  [0.01394004]
Stock Position:  0.01394003904588653
Bond Position:  [-4.41961918]


portfolio before change:  [-3.05719618]
curr_Stock_Price:  97.81378972983707
curr_Factors:  [97.81378973]
mat_Sqrt:  [[0.15]]
grads:  [-0.01424145]
Stock Position:  -0.01424144770426816
Bond Position:  [-1.66418621]


portfolio before change:  [-3.07553758]
curr_Stock_Price:  99.07246114684067
curr_Factors:  [99.07246115]
mat_Sqrt:  [[0.15]]
grads:  [0.07408693]
Stock Position:  0.0740869349562892
Bond Position:  [-10.41551256]


portfolio before change:  [-3.0769685]
curr_Stock_Price:  99.08829771050823
curr_Factors:  [99.08829771]
mat_Sqrt:  [[0.15]]
grads:  [0.31882337]
Stock Position:  0.3188233734160511
Bond Position:  [-34.66863384]


portfolio before change:  [-3.24497512]
curr_Stock_Price:  98.58852765126584
curr_Factors:  [98.58852765]
mat_Sqrt:  [[0.15]]
grads:  [0.131244]
Stock Position:  0.13124400176256237
Bond Position:  [-16.18412801]


portfolio before change:  [-3.05129412]
curr_Stock_Price:  100.09509201317857
curr_Factors:  [100.09509201]
mat_Sqrt:  [[0.15]]
grads:  [0.02510214]
Stock Position:  0.025102135725837037
Bond Position:  [-5.56389471]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.05129412]
Stock Price:  100.26244477930717
PL:  [-3.3137389]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.03741594e-01]
 [ 6.13429906e-03]
 [ 5.88522213e-03]
 [ 3.77526555e-03]
 [ 7.07395288e-03]
 [ 2.79861962e-03]
 [-1.02840268e-02]
 [ 6.65553275e-03]
 [ 3.73893689e-03]
 [-3.78384364e-02]
 [-1.03741598e-03]
 [-2.63538955e-02]
 [ 2.30128641e-03]
 [-4.16888570e-03]
 [-4.03547365e-04]
 [ 5.82271361e-03]
 [ 3.52169421e-02]
 [ 1.90217802e-02]
 [ 2.15737650e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.68398834]
curr_Stock_Price:  98.46634544894407
curr_Factors:  [98.46634545]
mat_Sqrt:  [[0.15]]
grads:  [0.69161063]
Stock Position:  0.6916106284945119
Bond Position:  [-89.7843594]


portfolio before change:  [-21.11859098]
curr_Stock_Price:  99.31631250633754
curr_Factors:  [99.31631251]
mat_Sqrt:  [[0.15]]
grads:  [0.04089533]
Stock Position:  0.04089532707164961
Bond Position:  [-25.18016407]


portfolio before change:  [-21.14576199]
curr_Stock_Price:  98.80585860879873
curr_Factors:  [98.80585861]
mat_Sqrt:  [[0.15]]
grads:  [0.03923481]
Stock Position:  0.03923481420598246
Bond Position:  [-25.02239149]


portfolio before change:  [-21.12843259]
curr_Stock_Price:  99.40700272443765
curr_Factors:  [99.40700272]
mat_Sqrt:  [[0.15]]
grads:  [0.02516844]
Stock Position:  0.025168437007992626
Bond Position:  [-23.63035148]


portfolio before change:  [-21.10639228]
curr_Stock_Price:  100.51746662050982
curr_Factors:  [100.51746662]
mat_Sqrt:  [[0.15]]
grads:  [0.04715969]
Stock Position:  0.04715968589142447
Bond Position:  [-25.84676443]


portfolio before change:  [-21.18337851]
curr_Stock_Price:  99.02204253042245
curr_Factors:  [99.02204253]
mat_Sqrt:  [[0.15]]
grads:  [0.01865746]
Stock Position:  0.018657464120236666
Bond Position:  [-23.03087871]


portfolio before change:  [-21.22120999]
curr_Stock_Price:  97.30299618602578
curr_Factors:  [97.30299619]
mat_Sqrt:  [[0.15]]
grads:  [-0.06856018]
Stock Position:  -0.06856017898915856
Bond Position:  [-14.55009916]


portfolio before change:  [-21.15731922]
curr_Stock_Price:  96.31804035613739
curr_Factors:  [96.31804036]
mat_Sqrt:  [[0.15]]
grads:  [0.04437022]
Stock Position:  0.044370218311692806
Bond Position:  [-25.4309717]


portfolio before change:  [-21.12979906]
curr_Stock_Price:  97.08158637720194
curr_Factors:  [97.08158638]
mat_Sqrt:  [[0.15]]
grads:  [0.02492625]
Stock Position:  0.02492624591533935
Bond Position:  [-23.54967855]


portfolio before change:  [-21.0980423]
curr_Stock_Price:  98.59183831227531
curr_Factors:  [98.59183831]
mat_Sqrt:  [[0.15]]
grads:  [-0.25225624]
Stock Position:  -0.25225624281080006
Bond Position:  [3.7723644]


portfolio before change:  [-21.12643641]
curr_Stock_Price:  98.70813796772153
curr_Factors:  [98.70813797]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691611]
Stock Position:  -0.006916106549497073
Bond Position:  [-20.44376041]


portfolio before change:  [-21.11854743]
curr_Stock_Price:  96.82838678647097
curr_Factors:  [96.82838679]
mat_Sqrt:  [[0.15]]
grads:  [-0.17569264]
Stock Position:  -0.1756926364775325
Bond Position:  [-4.10651287]


portfolio before change:  [-20.80867066]
curr_Stock_Price:  95.05879914001969
curr_Factors:  [95.05879914]
mat_Sqrt:  [[0.15]]
grads:  [0.01534191]
Stock Position:  0.015341909395095343
Bond Position:  [-22.26705415]


portfolio before change:  [-20.82313831]
curr_Stock_Price:  94.47867665621978
curr_Factors:  [94.47867666]
mat_Sqrt:  [[0.15]]
grads:  [-0.02779257]
Stock Position:  -0.027792571317258333
Bond Position:  [-18.19733295]


portfolio before change:  [-20.83664335]
curr_Stock_Price:  94.80089014168497
curr_Factors:  [94.80089014]
mat_Sqrt:  [[0.15]]
grads:  [-0.00269032]
Stock Position:  -0.0026903157633860414
Bond Position:  [-20.58159902]


portfolio before change:  [-20.83916163]
curr_Stock_Price:  93.82414107178914
curr_Factors:  [93.82414107]
mat_Sqrt:  [[0.15]]
grads:  [0.03881809]
Stock Position:  0.038818090752024845
Bond Position:  [-24.48123566]


portfolio before change:  [-20.78891849]
curr_Stock_Price:  95.2761501667483
curr_Factors:  [95.27615017]
mat_Sqrt:  [[0.15]]
grads:  [0.23477961]
Stock Position:  0.23477961381920653
Bond Position:  [-43.15781623]


portfolio before change:  [-20.67677605]
curr_Stock_Price:  95.79976135935294
curr_Factors:  [95.79976136]
mat_Sqrt:  [[0.15]]
grads:  [0.12681187]
Stock Position:  0.12681186810576656
Bond Position:  [-32.82532276]


portfolio before change:  [-20.79865458]
curr_Stock_Price:  94.90338495099762
curr_Factors:  [94.90338495]
mat_Sqrt:  [[0.15]]
grads:  [0.01438251]
Stock Position:  0.014382509975085334
Bond Position:  [-22.16360346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.79865458]
Stock Price:  95.74914139167328
PL:  [-20.79865458]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.77544885e-02]
 [-2.84856672e-03]
 [-1.98830340e-03]
 [ 3.06296777e-03]
 [ 8.12728356e-03]
 [ 1.11901699e-02]
 [-1.41309061e-02]
 [ 5.22911321e-03]
 [ 6.74509062e-03]
 [-3.72469765e-02]
 [-1.03904390e-03]
 [-2.63598178e-02]
 [ 2.45318864e-03]
 [-1.12602312e-03]
 [-1.99688111e-03]
 [ 1.04637318e-02]
 [ 4.17731161e-02]
 [ 2.02799030e-02]
 [ 3.80470547e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.02483959]
curr_Stock_Price:  99.35957179350308
curr_Factors:  [99.35957179]
mat_Sqrt:  [[0.15]]
grads:  [0.11836326]
Stock Position:  0.11836325665344746
Bond Position:  [-19.78536209]


portfolio before change:  [-7.95085058]
curr_Stock_Price:  100.0264677333282
curr_Factors:  [100.02646773]
mat_Sqrt:  [[0.15]]
grads:  [-0.01899044]
Stock Position:  -0.018990444822848493
Bond Position:  [-6.05130346]


portfolio before change:  [-7.94563671]
curr_Stock_Price:  99.67224300482778
curr_Factors:  [99.672243]
mat_Sqrt:  [[0.15]]
grads:  [-0.01325536]
Stock Position:  -0.013255355997900665
Bond Position:  [-6.62444564]


portfolio before change:  [-7.95337006]
curr_Stock_Price:  100.13070193713992
curr_Factors:  [100.13070194]
mat_Sqrt:  [[0.15]]
grads:  [0.02041979]
Stock Position:  0.020419785148545335
Bond Position:  [-9.99801748]


portfolio before change:  [-7.97160664]
curr_Stock_Price:  99.36003939066872
curr_Factors:  [99.36003939]
mat_Sqrt:  [[0.15]]
grads:  [0.05418189]
Stock Position:  0.05418189042382972
Bond Position:  [-13.35512141]


portfolio before change:  [-8.02449342]
curr_Stock_Price:  98.44557182661673
curr_Factors:  [98.44557183]
mat_Sqrt:  [[0.15]]
grads:  [0.07460113]
Stock Position:  0.07460113257400802
Bond Position:  [-15.36864458]


portfolio before change:  [-8.03379784]
curr_Stock_Price:  98.37235871154297
curr_Factors:  [98.37235871]
mat_Sqrt:  [[0.15]]
grads:  [-0.09420604]
Stock Position:  -0.09420604046442779
Bond Position:  [1.23347256]


portfolio before change:  [-7.93462642]
curr_Stock_Price:  97.32292474897811
curr_Factors:  [97.32292475]
mat_Sqrt:  [[0.15]]
grads:  [0.03486075]
Stock Position:  0.03486075472486818
Bond Position:  [-11.32737703]


portfolio before change:  [-7.99483785]
curr_Stock_Price:  95.67696960520844
curr_Factors:  [95.67696961]
mat_Sqrt:  [[0.15]]
grads:  [0.04496727]
Stock Position:  0.04496727077754627
Bond Position:  [-12.29717005]


portfolio before change:  [-7.93320429]
curr_Stock_Price:  97.11597713516467
curr_Factors:  [97.11597714]
mat_Sqrt:  [[0.15]]
grads:  [-0.24831318]
Stock Position:  -0.2483131767757875
Bond Position:  [16.18197251]


portfolio before change:  [-8.33237871]
curr_Stock_Price:  98.7398153162748
curr_Factors:  [98.73981532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00692696]
Stock Position:  -0.006926959326625174
Bond Position:  [-7.64841202]


portfolio before change:  [-8.31802353]
curr_Stock_Price:  96.3913786867847
curr_Factors:  [96.39137869]
mat_Sqrt:  [[0.15]]
grads:  [-0.17573212]
Stock Position:  -0.17573211838146743
Bond Position:  [8.62103764]


portfolio before change:  [-8.19380595]
curr_Stock_Price:  95.69678711410074
curr_Factors:  [95.69678711]
mat_Sqrt:  [[0.15]]
grads:  [0.01635459]
Stock Position:  0.016354590902161854
Bond Position:  [-9.75888775]


portfolio before change:  [-8.18338566]
curr_Stock_Price:  96.48312982607032
curr_Factors:  [96.48312983]
mat_Sqrt:  [[0.15]]
grads:  [-0.00750682]
Stock Position:  -0.007506820823753614
Bond Position:  [-7.45910409]


portfolio before change:  [-8.19295501]
curr_Stock_Price:  97.50944109225141
curr_Factors:  [97.50944109]
mat_Sqrt:  [[0.15]]
grads:  [-0.01331254]
Stock Position:  -0.013312540747298788
Bond Position:  [-6.8948566]


portfolio before change:  [-8.17871365]
curr_Stock_Price:  96.31017413379125
curr_Factors:  [96.31017413]
mat_Sqrt:  [[0.15]]
grads:  [0.06975821]
Stock Position:  0.0697582118677783
Bond Position:  [-14.89713918]


portfolio before change:  [-8.22418104]
curr_Stock_Price:  95.7117836819841
curr_Factors:  [95.71178368]
mat_Sqrt:  [[0.15]]
grads:  [0.27848744]
Stock Position:  0.27848744051543606
Bond Position:  [-34.87871071]


portfolio before change:  [-8.02167366]
curr_Stock_Price:  96.47026726019268
curr_Factors:  [96.47026726]
mat_Sqrt:  [[0.15]]
grads:  [0.13519935]
Stock Position:  0.1351993534986425
Bond Position:  [-21.06439143]


portfolio before change:  [-7.97824536]
curr_Stock_Price:  96.83043955549334
curr_Factors:  [96.83043956]
mat_Sqrt:  [[0.15]]
grads:  [0.0253647]
Stock Position:  0.025364703165120107
Bond Position:  [-10.43432071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.97824536]
Stock Price:  95.21178555771625
PL:  [-7.97824536]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.02057901e-02]
 [ 3.48806830e-03]
 [-9.97317258e-03]
 [ 3.85867379e-03]
 [ 8.06575668e-03]
 [ 9.10073481e-04]
 [ 1.81856199e-03]
 [-1.10439462e-04]
 [ 1.90089804e-03]
 [-3.72492480e-02]
 [-9.74443237e-04]
 [-2.63526349e-02]
 [ 2.63642882e-03]
 [ 9.57102357e-05]
 [-3.40421205e-03]
 [ 1.19163156e-02]
 [ 4.99241176e-02]
 [ 1.93449759e-02]
 [ 4.17478777e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.24641856]
curr_Stock_Price:  99.018111869273
curr_Factors:  [99.01811187]
mat_Sqrt:  [[0.15]]
grads:  [0.20137193]
Stock Position:  0.20137193412347118
Bond Position:  [-33.18588726]


portfolio before change:  [-13.13759938]
curr_Stock_Price:  99.59970579613403
curr_Factors:  [99.5997058]
mat_Sqrt:  [[0.15]]
grads:  [0.02325379]
Stock Position:  0.023253788693316752
Bond Position:  [-15.45366989]


portfolio before change:  [-13.12712147]
curr_Stock_Price:  100.21645705158006
curr_Factors:  [100.21645705]
mat_Sqrt:  [[0.15]]
grads:  [-0.06648782]
Stock Position:  -0.06648781719532915
Bond Position:  [-6.463948]


portfolio before change:  [-13.04450144]
curr_Stock_Price:  98.94951479804368
curr_Factors:  [98.9495148]
mat_Sqrt:  [[0.15]]
grads:  [0.02572449]
Stock Position:  0.02572449195615704
Bond Position:  [-15.58992744]


portfolio before change:  [-13.03614907]
curr_Stock_Price:  99.42572759738134
curr_Factors:  [99.4257276]
mat_Sqrt:  [[0.15]]
grads:  [0.05377171]
Stock Position:  0.053771711208655364
Bond Position:  [-18.38244059]


portfolio before change:  [-13.03644586]
curr_Stock_Price:  99.5056840312602
curr_Factors:  [99.50568403]
mat_Sqrt:  [[0.15]]
grads:  [0.00606716]
Stock Position:  0.006067156542309225
Bond Position:  [-13.64016243]


portfolio before change:  [-13.03076572]
curr_Stock_Price:  101.00401602932924
curr_Factors:  [101.00401603]
mat_Sqrt:  [[0.15]]
grads:  [0.01212375]
Stock Position:  0.012123746600907644
Bond Position:  [-14.25531281]


portfolio before change:  [-13.05765803]
curr_Stock_Price:  99.0798552178809
curr_Factors:  [99.07985522]
mat_Sqrt:  [[0.15]]
grads:  [-0.00073626]
Stock Position:  -0.0007362630786623622
Bond Position:  [-12.98470919]


portfolio before change:  [-13.05997955]
curr_Stock_Price:  97.82342632629603
curr_Factors:  [97.82342633]
mat_Sqrt:  [[0.15]]
grads:  [0.01267265]
Stock Position:  0.012672653628731165
Bond Position:  [-14.29966195]


portfolio before change:  [-13.07380054]
curr_Stock_Price:  97.01494295092427
curr_Factors:  [97.01494295]
mat_Sqrt:  [[0.15]]
grads:  [-0.24832832]
Stock Position:  -0.24832832011576148
Bond Position:  [11.01775727]


portfolio before change:  [-13.18721851]
curr_Stock_Price:  97.48276215204552
curr_Factors:  [97.48276215]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649629]
Stock Position:  -0.006496288249261013
Bond Position:  [-12.55394239]


portfolio before change:  [-13.18671066]
curr_Stock_Price:  96.92140624265868
curr_Factors:  [96.92140624]
mat_Sqrt:  [[0.15]]
grads:  [-0.17568423]
Stock Position:  -0.17568423254809523
Bond Position:  [3.84085221]


portfolio before change:  [-13.41846101]
curr_Stock_Price:  98.24600253197198
curr_Factors:  [98.24600253]
mat_Sqrt:  [[0.15]]
grads:  [0.01757619]
Stock Position:  0.017576192156457435
Bond Position:  [-15.14525163]


portfolio before change:  [-13.40289149]
curr_Stock_Price:  99.34728261654034
curr_Factors:  [99.34728262]
mat_Sqrt:  [[0.15]]
grads:  [0.00063807]
Stock Position:  0.0006380682383196924
Bond Position:  [-13.46628183]


portfolio before change:  [-13.40568042]
curr_Stock_Price:  100.25322853374612
curr_Factors:  [100.25322853]
mat_Sqrt:  [[0.15]]
grads:  [-0.02269475]
Stock Position:  -0.022694746998399573
Bond Position:  [-11.13045877]


portfolio before change:  [-13.35795367]
curr_Stock_Price:  98.02761578537745
curr_Factors:  [98.02761579]
mat_Sqrt:  [[0.15]]
grads:  [0.0794421]
Stock Position:  0.07944210386118705
Bond Position:  [-21.1454737]


portfolio before change:  [-13.35032626]
curr_Stock_Price:  98.19017992128516
curr_Factors:  [98.19017992]
mat_Sqrt:  [[0.15]]
grads:  [0.33282745]
Stock Position:  0.3328274503448547
Bond Position:  [-46.03071349]


portfolio before change:  [-13.06980184]
curr_Stock_Price:  99.06761215374715
curr_Factors:  [99.06761215]
mat_Sqrt:  [[0.15]]
grads:  [0.12896651]
Stock Position:  0.1289665057456096
Bond Position:  [-25.84620562]


portfolio before change:  [-13.26985593]
curr_Stock_Price:  97.56651132598442
curr_Factors:  [97.56651133]
mat_Sqrt:  [[0.15]]
grads:  [0.02783192]
Stock Position:  0.027831918457031948
Bond Position:  [-15.98531912]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.26985593]
Stock Price:  96.61449514360933
PL:  [-13.26985593]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 8.39948059e-03]
 [ 6.52766593e-03]
 [ 2.10583231e-02]
 [ 1.33319906e-03]
 [ 8.88284202e-03]
 [ 3.53965255e-02]
 [-2.56276618e-03]
 [ 9.22482026e-03]
 [ 1.43076542e-02]
 [-3.73522563e-02]
 [ 1.70187804e-03]
 [-2.64258539e-02]
 [ 1.91876093e-03]
 [-3.91895929e-03]
 [-1.63769141e-03]
 [ 1.03589546e-02]
 [ 4.77749000e-02]
 [ 1.98170274e-02]
 [ 3.32200795e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.24332047]
curr_Stock_Price:  99.60686044686467
curr_Factors:  [99.60686045]
mat_Sqrt:  [[0.15]]
grads:  [0.05599654]
Stock Position:  0.05599653726299725
Bond Position:  [-9.82095975]


portfolio before change:  [-4.27066361]
curr_Stock_Price:  99.16241164294229
curr_Factors:  [99.16241164]
mat_Sqrt:  [[0.15]]
grads:  [0.04351777]
Stock Position:  0.04351777287320675
Bond Position:  [-8.58599092]


portfolio before change:  [-4.34961082]
curr_Stock_Price:  97.39760527219266
curr_Factors:  [97.39760527]
mat_Sqrt:  [[0.15]]
grads:  [0.14038882]
Stock Position:  0.140388820857229
Bond Position:  [-18.02314578]


portfolio before change:  [-4.31770895]
curr_Stock_Price:  97.65694375100036
curr_Factors:  [97.65694375]
mat_Sqrt:  [[0.15]]
grads:  [0.00888799]
Stock Position:  0.008887993751576631
Bond Position:  [-5.18568326]


portfolio before change:  [-4.32508645]
curr_Stock_Price:  96.97277190350917
curr_Factors:  [96.9727719]
mat_Sqrt:  [[0.15]]
grads:  [0.05921895]
Stock Position:  0.05921894682514951
Bond Position:  [-10.06771187]


portfolio before change:  [-4.34770287]
curr_Stock_Price:  96.63336732231723
curr_Factors:  [96.63336732]
mat_Sqrt:  [[0.15]]
grads:  [0.23597684]
Stock Position:  0.2359768367819488
Bond Position:  [-27.15093922]


portfolio before change:  [-4.71515115]
curr_Stock_Price:  95.10499826394062
curr_Factors:  [95.10499826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01708511]
Stock Position:  -0.01708510788309206
Bond Position:  [-3.090272]


portfolio before change:  [-4.69865507]
curr_Stock_Price:  94.09424986965158
curr_Factors:  [94.09424987]
mat_Sqrt:  [[0.15]]
grads:  [0.0614988]
Stock Position:  0.06149880170777123
Bond Position:  [-10.48533869]


portfolio before change:  [-4.82669788]
curr_Stock_Price:  92.05484196487026
curr_Factors:  [92.05484196]
mat_Sqrt:  [[0.15]]
grads:  [0.09538436]
Stock Position:  0.09538436148994035
Bond Position:  [-13.6072902]


portfolio before change:  [-4.79400748]
curr_Stock_Price:  92.43323361553182
curr_Factors:  [92.43323362]
mat_Sqrt:  [[0.15]]
grads:  [-0.24901504]
Stock Position:  -0.2490150419678533
Bond Position:  [18.22325807]


portfolio before change:  [-4.59983413]
curr_Stock_Price:  91.67176568797578
curr_Factors:  [91.67176569]
mat_Sqrt:  [[0.15]]
grads:  [0.01134585]
Stock Position:  0.011345853619553273
Bond Position:  [-5.63992856]


portfolio before change:  [-4.60298272]
curr_Stock_Price:  91.51854321045228
curr_Factors:  [91.51854321]
mat_Sqrt:  [[0.15]]
grads:  [-0.17617236]
Stock Position:  -0.1761723592426901
Bond Position:  [11.52005495]


portfolio before change:  [-4.94075845]
curr_Stock_Price:  93.45219558851413
curr_Factors:  [93.45219559]
mat_Sqrt:  [[0.15]]
grads:  [0.01279174]
Stock Position:  0.01279173952999636
Bond Position:  [-6.1361746]


portfolio before change:  [-4.92705622]
curr_Stock_Price:  94.64331300311706
curr_Factors:  [94.643313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0261264]
Stock Position:  -0.02612639527206334
Bond Position:  [-2.45436762]


portfolio before change:  [-4.97929839]
curr_Stock_Price:  96.61941800781983
curr_Factors:  [96.61941801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01091794]
Stock Position:  -0.010917942729150507
Bond Position:  [-3.92441312]


portfolio before change:  [-4.97628416]
curr_Stock_Price:  96.2534643429875
curr_Factors:  [96.25346434]
mat_Sqrt:  [[0.15]]
grads:  [0.0690597]
Stock Position:  0.06905969704506665
Bond Position:  [-11.62351924]


portfolio before change:  [-4.95297259]
curr_Stock_Price:  96.63310410169075
curr_Factors:  [96.6331041]
mat_Sqrt:  [[0.15]]
grads:  [0.31849933]
Stock Position:  0.3184993331537258
Bond Position:  [-35.73055181]


portfolio before change:  [-5.09233899]
curr_Stock_Price:  96.22358161988798
curr_Factors:  [96.22358162]
mat_Sqrt:  [[0.15]]
grads:  [0.13211352]
Stock Position:  0.13211351607037136
Bond Position:  [-17.80477468]


portfolio before change:  [-5.09121612]
curr_Stock_Price:  96.26577730279132
curr_Factors:  [96.2657773]
mat_Sqrt:  [[0.15]]
grads:  [0.02214672]
Stock Position:  0.022146719651925165
Bond Position:  [-7.2231873]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.09121612]
Stock Price:  94.79819144918396
PL:  [-5.09121612]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.82226945e-02]
 [-2.56982614e-03]
 [-6.31593316e-03]
 [ 3.23491436e-03]
 [ 7.02116007e-03]
 [ 1.14988217e-02]
 [-1.24787709e-02]
 [ 1.02031520e-03]
 [ 6.67801935e-04]
 [-3.72291250e-02]
 [-9.70996956e-04]
 [-2.63704806e-02]
 [ 2.29230907e-03]
 [-5.92038884e-03]
 [-1.09528677e-03]
 [ 1.01213480e-02]
 [ 5.05792330e-02]
 [ 2.05245873e-02]
 [ 3.43715808e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.27588427]
curr_Stock_Price:  99.80091296396063
curr_Factors:  [99.80091296]
mat_Sqrt:  [[0.15]]
grads:  [0.12148463]
Stock Position:  0.12148462974882951
Bond Position:  [-13.40016123]


portfolio before change:  [-1.25452326]
curr_Stock_Price:  100.00432529231139
curr_Factors:  [100.00432529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01713217]
Stock Position:  -0.01713217424491505
Bond Position:  [0.45876827]


portfolio before change:  [-1.27713486]
curr_Stock_Price:  101.33085369775037
curr_Factors:  [101.3308537]
mat_Sqrt:  [[0.15]]
grads:  [-0.04210622]
Stock Position:  -0.04210622109083357
Bond Position:  [2.98952446]


portfolio before change:  [-1.22106528]
curr_Stock_Price:  100.01698335626206
curr_Factors:  [100.01698336]
mat_Sqrt:  [[0.15]]
grads:  [0.0215661]
Stock Position:  0.021566095739116848
Bond Position:  [-3.37804111]


portfolio before change:  [-1.2097528]
curr_Stock_Price:  100.5806964426627
curr_Factors:  [100.58069644]
mat_Sqrt:  [[0.15]]
grads:  [0.04680773]
Stock Position:  0.04680773381300998
Bond Position:  [-5.91770727]


portfolio before change:  [-1.31295911]
curr_Stock_Price:  98.40740822244082
curr_Factors:  [98.40740822]
mat_Sqrt:  [[0.15]]
grads:  [0.07665881]
Stock Position:  0.0766588111033344
Bond Position:  [-8.85675403]


portfolio before change:  [-1.35194206]
curr_Stock_Price:  97.92777016840292
curr_Factors:  [97.92777017]
mat_Sqrt:  [[0.15]]
grads:  [-0.08319181]
Stock Position:  -0.08319180572772052
Bond Position:  [6.79484597]


portfolio before change:  [-1.41810521]
curr_Stock_Price:  98.74350045870501
curr_Factors:  [98.74350046]
mat_Sqrt:  [[0.15]]
grads:  [0.0068021]
Stock Position:  0.006802101336220813
Bond Position:  [-2.08976851]


portfolio before change:  [-1.41974774]
curr_Stock_Price:  98.57884245459081
curr_Factors:  [98.57884245]
mat_Sqrt:  [[0.15]]
grads:  [0.00445201]
Stock Position:  0.004452012902494129
Bond Position:  [-1.85862202]


portfolio before change:  [-1.42319017]
curr_Stock_Price:  97.90999366607737
curr_Factors:  [97.90999367]
mat_Sqrt:  [[0.15]]
grads:  [-0.24819417]
Stock Position:  -0.24819416693409257
Bond Position:  [22.87749914]


portfolio before change:  [-1.29478966]
curr_Stock_Price:  97.41570154587502
curr_Factors:  [97.41570155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00647331]
Stock Position:  -0.006473313036811796
Bond Position:  [-0.66418733]


portfolio before change:  [-1.28323168]
curr_Stock_Price:  95.60456565215453
curr_Factors:  [95.60456565]
mat_Sqrt:  [[0.15]]
grads:  [-0.1758032]
Stock Position:  -0.17580320373816968
Bond Position:  [15.52435725]


portfolio before change:  [-1.17677399]
curr_Stock_Price:  95.02109437684997
curr_Factors:  [95.02109438]
mat_Sqrt:  [[0.15]]
grads:  [0.01528206]
Stock Position:  0.01528206043564548
Bond Position:  [-2.62889209]


portfolio before change:  [-1.20335275]
curr_Stock_Price:  93.32489269843809
curr_Factors:  [93.3248927]
mat_Sqrt:  [[0.15]]
grads:  [-0.03946926]
Stock Position:  -0.03946925892613525
Bond Position:  [2.4801116]


portfolio before change:  [-1.2975419]
curr_Stock_Price:  95.726996383173
curr_Factors:  [95.72699638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00730191]
Stock Position:  -0.007301911803747653
Bond Position:  [-0.59855181]


portfolio before change:  [-1.30060663]
curr_Stock_Price:  96.1262172979437
curr_Factors:  [96.1262173]
mat_Sqrt:  [[0.15]]
grads:  [0.06747565]
Stock Position:  0.0674756530095155
Bond Position:  [-7.78678591]


portfolio before change:  [-1.20467528]
curr_Stock_Price:  97.57678921964158
curr_Factors:  [97.57678922]
mat_Sqrt:  [[0.15]]
grads:  [0.33719489]
Stock Position:  0.3371948869927407
Bond Position:  [-34.10706969]


portfolio before change:  [-1.54234563]
curr_Stock_Price:  96.6006696725909
curr_Factors:  [96.60066967]
mat_Sqrt:  [[0.15]]
grads:  [0.13683058]
Stock Position:  0.13683058199016673
Bond Position:  [-14.76027149]


portfolio before change:  [-1.57342816]
curr_Stock_Price:  96.40048056898605
curr_Factors:  [96.40048057]
mat_Sqrt:  [[0.15]]
grads:  [0.02291439]
Stock Position:  0.02291438720489839
Bond Position:  [-3.78238609]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.57342816]
Stock Price:  94.41353559600752
PL:  [-1.57342816]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.03226890e-02]
 [-8.06324844e-03]
 [-9.63293577e-03]
 [ 2.50943401e-03]
 [ 6.45486149e-03]
 [ 1.06032549e-02]
 [-1.54213325e-03]
 [ 1.13624695e-03]
 [-1.05378837e-03]
 [-1.86421035e-02]
 [-6.63935570e-03]
 [-2.19631254e-02]
 [-1.73775250e-04]
 [-1.30495948e-02]
 [-2.27089061e-03]
 [ 1.16443787e-02]
 [ 4.66687678e-02]
 [ 1.97413339e-02]
 [ 1.88268965e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.75529553]
curr_Stock_Price:  100.45689191475746
curr_Factors:  [100.45689191]
mat_Sqrt:  [[0.15]]
grads:  [0.26881793]
Stock Position:  0.268817926516768
Bond Position:  [-18.24931786]


portfolio before change:  [8.8088697]
curr_Stock_Price:  100.67316123320774
curr_Factors:  [100.67316123]
mat_Sqrt:  [[0.15]]
grads:  [-0.05375499]
Stock Position:  -0.0537549895961278
Bond Position:  [14.22055443]


portfolio before change:  [8.83902044]
curr_Stock_Price:  100.17841350300971
curr_Factors:  [100.1784135]
mat_Sqrt:  [[0.15]]
grads:  [-0.06421957]
Stock Position:  -0.06421957180482282
Bond Position:  [15.27243526]


portfolio before change:  [8.81965018]
curr_Stock_Price:  100.53950047636182
curr_Factors:  [100.53950048]
mat_Sqrt:  [[0.15]]
grads:  [0.01672956]
Stock Position:  0.016729560071327403
Bond Position:  [7.13766856]


portfolio before change:  [8.83535774]
curr_Stock_Price:  101.37173527908675
curr_Factors:  [101.37173528]
mat_Sqrt:  [[0.15]]
grads:  [0.04303241]
Stock Position:  0.043032409944983266
Bond Position:  [4.47308767]


portfolio before change:  [8.82362266]
curr_Stock_Price:  101.07304205241677
curr_Factors:  [101.07304205]
mat_Sqrt:  [[0.15]]
grads:  [0.07068837]
Stock Position:  0.07068836575978422
Bond Position:  [1.6789345]


portfolio before change:  [8.91604998]
curr_Stock_Price:  102.37463571057722
curr_Factors:  [102.37463571]
mat_Sqrt:  [[0.15]]
grads:  [-0.01028089]
Stock Position:  -0.010280888312014479
Bond Position:  [9.96855217]


portfolio before change:  [8.89803151]
curr_Stock_Price:  104.36968906210873
curr_Factors:  [104.36968906]
mat_Sqrt:  [[0.15]]
grads:  [0.00757498]
Stock Position:  0.0075749796712825355
Bond Position:  [8.10743323]


portfolio before change:  [8.87719551]
curr_Stock_Price:  101.35144937412252
curr_Factors:  [101.35144937]
mat_Sqrt:  [[0.15]]
grads:  [-0.00702526]
Stock Position:  -0.00702525577913303
Bond Position:  [9.58921537]


portfolio before change:  [8.89019149]
curr_Stock_Price:  99.84283966178178
curr_Factors:  [99.84283966]
mat_Sqrt:  [[0.15]]
grads:  [-0.12428069]
Stock Position:  -0.12428069005566442
Bond Position:  [21.2987285]


portfolio before change:  [8.66663176]
curr_Stock_Price:  101.68451817544887
curr_Factors:  [101.68451818]
mat_Sqrt:  [[0.15]]
grads:  [-0.04426237]
Stock Position:  -0.04426237132414051
Bond Position:  [13.16742966]


portfolio before change:  [8.66300796]
curr_Stock_Price:  101.84076971151597
curr_Factors:  [101.84076971]
mat_Sqrt:  [[0.15]]
grads:  [-0.14642084]
Stock Position:  -0.14642083581890047
Bond Position:  [23.57461858]


portfolio before change:  [8.69226383]
curr_Stock_Price:  101.6812194629001
curr_Factors:  [101.68121946]
mat_Sqrt:  [[0.15]]
grads:  [-0.0011585]
Stock Position:  -0.0011585016673437872
Bond Position:  [8.8100617]


portfolio before change:  [8.69475509]
curr_Stock_Price:  101.43222410213849
curr_Factors:  [101.4322241]
mat_Sqrt:  [[0.15]]
grads:  [-0.0869973]
Stock Position:  -0.08699729835612666
Bond Position:  [17.51908455]


portfolio before change:  [8.98833792]
curr_Stock_Price:  98.10795398766744
curr_Factors:  [98.10795399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01513927]
Stock Position:  -0.015139270765866254
Bond Position:  [10.4736208]


portfolio before change:  [8.98608114]
curr_Stock_Price:  98.42999805641843
curr_Factors:  [98.42999806]
mat_Sqrt:  [[0.15]]
grads:  [0.07762919]
Stock Position:  0.07762919148443026
Bond Position:  [1.34503998]


portfolio before change:  [8.8223318]
curr_Stock_Price:  96.31628737969575
curr_Factors:  [96.31628738]
mat_Sqrt:  [[0.15]]
grads:  [0.31112512]
Stock Position:  0.3111251186993578
Bond Position:  [-21.14408455]


portfolio before change:  [8.77565116]
curr_Stock_Price:  96.183241378501
curr_Factors:  [96.18324138]
mat_Sqrt:  [[0.15]]
grads:  [0.13160889]
Stock Position:  0.13160889234527892
Bond Position:  [-3.8829187]


portfolio before change:  [8.56394991]
curr_Stock_Price:  94.58205474560933
curr_Factors:  [94.58205475]
mat_Sqrt:  [[0.15]]
grads:  [0.01255126]
Stock Position:  0.012551264308701442
Bond Position:  [7.37682554]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.56394991]
Stock Price:  93.46024726108098
PL:  [8.56394991]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.94343038e-02]
 [-8.02309980e-03]
 [-4.48370713e-03]
 [ 3.47918022e-03]
 [ 6.06818351e-03]
 [-7.58293179e-03]
 [-5.45330442e-03]
 [ 1.76363292e-03]
 [ 4.78374798e-03]
 [ 7.57794201e-02]
 [-1.48819494e-02]
 [-1.87041401e-02]
 [-2.46603846e-03]
 [-2.51073652e-02]
 [ 1.70907149e-02]
 [ 4.10732689e-03]
 [-2.20161913e-02]
 [-1.56774037e-02]
 [ 4.65130739e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.47316079]
curr_Stock_Price:  101.68092795635873
curr_Factors:  [101.68092796]
mat_Sqrt:  [[0.15]]
grads:  [-0.26289536]
Stock Position:  -0.26289535881414267
Bond Position:  [54.20460483]


portfolio before change:  [27.72655423]
curr_Stock_Price:  100.7686235432425
curr_Factors:  [100.76862354]
mat_Sqrt:  [[0.15]]
grads:  [-0.05348733]
Stock Position:  -0.053487332016379396
Bond Position:  [33.11639905]


portfolio before change:  [27.7808897]
curr_Stock_Price:  99.90757228727516
curr_Factors:  [99.90757229]
mat_Sqrt:  [[0.15]]
grads:  [-0.02989138]
Stock Position:  -0.02989138084521269
Bond Position:  [30.76726499]


portfolio before change:  [27.79048691]
curr_Stock_Price:  99.84386050877336
curr_Factors:  [99.84386051]
mat_Sqrt:  [[0.15]]
grads:  [0.02319453]
Stock Position:  0.02319453482567884
Bond Position:  [25.47465501]


portfolio before change:  [27.84638941]
curr_Stock_Price:  101.97940871310887
curr_Factors:  [101.97940871]
mat_Sqrt:  [[0.15]]
grads:  [0.04045456]
Stock Position:  0.040454556742369654
Bond Position:  [23.72085764]


portfolio before change:  [27.87176703]
curr_Stock_Price:  102.46011251200757
curr_Factors:  [102.46011251]
mat_Sqrt:  [[0.15]]
grads:  [-0.05055288]
Stock Position:  -0.05055287858092392
Bond Position:  [33.05142066]


portfolio before change:  [27.83381228]
curr_Stock_Price:  103.37437569137794
curr_Factors:  [103.37437569]
mat_Sqrt:  [[0.15]]
grads:  [-0.03635536]
Stock Position:  -0.036355362821216854
Bond Position:  [31.59202522]


portfolio before change:  [27.73502498]
curr_Stock_Price:  106.30891653296976
curr_Factors:  [106.30891653]
mat_Sqrt:  [[0.15]]
grads:  [0.01175755]
Stock Position:  0.01175755279227911
Bond Position:  [26.48509228]


portfolio before change:  [27.73723011]
curr_Stock_Price:  105.93324577195848
curr_Factors:  [105.93324577]
mat_Sqrt:  [[0.15]]
grads:  [0.03189165]
Stock Position:  0.03189165317664872
Bond Position:  [24.35884378]


portfolio before change:  [27.74868351]
curr_Stock_Price:  106.10140673699544
curr_Factors:  [106.10140674]
mat_Sqrt:  [[0.15]]
grads:  [0.50519613]
Stock Position:  0.5051961340375065
Bond Position:  [-25.85333699]


portfolio before change:  [27.86840266]
curr_Stock_Price:  106.3511776210636
curr_Factors:  [106.35117762]
mat_Sqrt:  [[0.15]]
grads:  [-0.099213]
Stock Position:  -0.09921299626608175
Bond Position:  [38.41982164]


portfolio before change:  [27.96886156]
curr_Stock_Price:  105.43544329137828
curr_Factors:  [105.43544329]
mat_Sqrt:  [[0.15]]
grads:  [-0.12469427]
Stock Position:  -0.12469426746518844
Bond Position:  [41.11605693]


portfolio before change:  [27.87080407]
curr_Stock_Price:  106.30427059668176
curr_Factors:  [106.3042706]
mat_Sqrt:  [[0.15]]
grads:  [-0.01644026]
Stock Position:  -0.016440256386404586
Bond Position:  [29.61847354]


portfolio before change:  [27.86799]
curr_Stock_Price:  106.92589207541509
curr_Factors:  [106.92589208]
mat_Sqrt:  [[0.15]]
grads:  [-0.16738243]
Stock Position:  -0.1673824349671031
Bond Position:  [45.76550618]


portfolio before change:  [27.78115697]
curr_Stock_Price:  107.5130255901263
curr_Factors:  [107.51302559]
mat_Sqrt:  [[0.15]]
grads:  [0.1139381]
Stock Position:  0.11393809952360832
Bond Position:  [15.53132716]


portfolio before change:  [27.80473741]
curr_Stock_Price:  107.68590121516888
curr_Factors:  [107.68590122]
mat_Sqrt:  [[0.15]]
grads:  [0.02738218]
Stock Position:  0.027382179298495492
Bond Position:  [24.85606275]


portfolio before change:  [27.80139966]
curr_Stock_Price:  107.33704141026423
curr_Factors:  [107.33704141]
mat_Sqrt:  [[0.15]]
grads:  [-0.14677461]
Stock Position:  -0.14677460896041117
Bond Position:  [43.55575194]


portfolio before change:  [28.06731643]
curr_Stock_Price:  105.59950335253451
curr_Factors:  [105.59950335]
mat_Sqrt:  [[0.15]]
grads:  [-0.10451602]
Stock Position:  -0.10451602438300171
Bond Position:  [39.10415669]


portfolio before change:  [28.2824914]
curr_Stock_Price:  103.63427637163896
curr_Factors:  [103.63427637]
mat_Sqrt:  [[0.15]]
grads:  [0.03100872]
Stock Position:  0.03100871594752027
Bond Position:  [25.06892556]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.2824914]
Stock Price:  105.41510438957785
PL:  [22.86738701]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-2.82125443e-02]
 [-8.07052071e-03]
 [ 1.28688185e-02]
 [-3.69135410e-03]
 [ 4.56057344e-03]
 [-5.45693904e-02]
 [-1.25842668e-02]
 [ 3.09620361e-03]
 [ 1.42520431e-02]
 [ 1.05770267e-01]
 [-2.27576382e-02]
 [-1.24563371e-02]
 [-5.82922690e-03]
 [-4.77558154e-02]
 [ 3.31199325e-02]
 [-4.84767842e-03]
 [ 7.97761105e-03]
 [ 2.43605066e-04]
 [ 5.38378997e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.33576467]
curr_Stock_Price:  101.21418508976645
curr_Factors:  [101.21418509]
mat_Sqrt:  [[0.15]]
grads:  [-0.18808363]
Stock Position:  -0.1880836284146938
Bond Position:  [39.37249585]


portfolio before change:  [20.450619]
curr_Stock_Price:  100.65586978171706
curr_Factors:  [100.65586978]
mat_Sqrt:  [[0.15]]
grads:  [-0.05380347]
Stock Position:  -0.05380347143209659
Bond Position:  [25.86625421]


portfolio before change:  [20.35504017]
curr_Stock_Price:  102.55251683824305
curr_Factors:  [102.55251684]
mat_Sqrt:  [[0.15]]
grads:  [0.08579212]
Stock Position:  0.08579212324550464
Bond Position:  [11.55684201]


portfolio before change:  [20.44300429]
curr_Stock_Price:  103.54415270830809
curr_Factors:  [103.54415271]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460903]
Stock Position:  -0.024609027315437047
Bond Position:  [22.99112517]


portfolio before change:  [20.41018155]
curr_Stock_Price:  105.11151412746474
curr_Factors:  [105.11151413]
mat_Sqrt:  [[0.15]]
grads:  [0.03040382]
Stock Position:  0.03040382295176539
Bond Position:  [17.21438968]


portfolio before change:  [20.42732546]
curr_Stock_Price:  105.53382215515786
curr_Factors:  [105.53382216]
mat_Sqrt:  [[0.15]]
grads:  [-0.36379594]
Stock Position:  -0.3637959360649155
Bond Position:  [58.82010108]


portfolio before change:  [19.6063385]
curr_Stock_Price:  107.8309721265608
curr_Factors:  [107.83097213]
mat_Sqrt:  [[0.15]]
grads:  [-0.08389511]
Stock Position:  -0.08389511198386326
Bond Position:  [28.65282999]


portfolio before change:  [19.3956377]
curr_Stock_Price:  110.42784462009577
curr_Factors:  [110.42784462]
mat_Sqrt:  [[0.15]]
grads:  [0.02064136]
Stock Position:  0.020641357381165907
Bond Position:  [17.11625709]


portfolio before change:  [19.42104833]
curr_Stock_Price:  111.45156763958263
curr_Factors:  [111.45156764]
mat_Sqrt:  [[0.15]]
grads:  [0.09501362]
Stock Position:  0.09501362043583601
Bond Position:  [8.83163139]


portfolio before change:  [19.32976695]
curr_Stock_Price:  110.46760802083551
curr_Factors:  [110.46760802]
mat_Sqrt:  [[0.15]]
grads:  [0.70513511]
Stock Position:  0.7051351142877674
Bond Position:  [-58.56482246]


portfolio before change:  [20.75914266]
curr_Stock_Price:  112.51546908431288
curr_Factors:  [112.51546908]
mat_Sqrt:  [[0.15]]
grads:  [-0.15171759]
Stock Position:  -0.15171758825534293
Bond Position:  [37.82971827]


portfolio before change:  [20.70637608]
curr_Stock_Price:  112.92560738297473
curr_Factors:  [112.92560738]
mat_Sqrt:  [[0.15]]
grads:  [-0.08304225]
Stock Position:  -0.08304224752270786
Bond Position:  [30.08397232]


portfolio before change:  [20.7678244]
curr_Stock_Price:  112.27622233059716
curr_Factors:  [112.27622233]
mat_Sqrt:  [[0.15]]
grads:  [-0.03886151]
Stock Position:  -0.038861512674254375
Bond Position:  [25.13104824]


portfolio before change:  [20.7586811]
curr_Stock_Price:  112.67319227348459
curr_Factors:  [112.67319227]
mat_Sqrt:  [[0.15]]
grads:  [-0.3183721]
Stock Position:  -0.3183721027114374
Bond Position:  [56.63068224]


portfolio before change:  [20.6967361]
curr_Stock_Price:  112.91223470954374
curr_Factors:  [112.91223471]
mat_Sqrt:  [[0.15]]
grads:  [0.22079955]
Stock Position:  0.22079954991079986
Bond Position:  [-4.23423451]


portfolio before change:  [20.67871734]
curr_Stock_Price:  112.83542266098567
curr_Factors:  [112.83542266]
mat_Sqrt:  [[0.15]]
grads:  [-0.03231786]
Stock Position:  -0.032317856109000065
Bond Position:  [24.32531629]


portfolio before change:  [20.74483187]
curr_Stock_Price:  110.97786001426662
curr_Factors:  [110.97786001]
mat_Sqrt:  [[0.15]]
grads:  [0.05318407]
Stock Position:  0.05318407364012623
Bond Position:  [14.84257719]


portfolio before change:  [20.81363508]
curr_Stock_Price:  112.20176216502765
curr_Factors:  [112.20176217]
mat_Sqrt:  [[0.15]]
grads:  [0.00162403]
Stock Position:  0.0016240337742653758
Bond Position:  [20.63141563]


portfolio before change:  [20.81674704]
curr_Stock_Price:  110.94160330150638
curr_Factors:  [110.9416033]
mat_Sqrt:  [[0.15]]
grads:  [0.03589193]
Stock Position:  0.03589193314523473
Bond Position:  [16.83483843]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.81674704]
Stock Price:  110.45050805221798
PL:  [10.36623899]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.73095772e-02]
 [-1.91082525e-03]
 [ 6.06787009e-03]
 [ 1.39899787e-03]
 [ 8.82561528e-03]
 [ 2.49220995e-02]
 [-5.20697473e-03]
 [ 7.33318022e-03]
 [ 4.92138593e-03]
 [-3.72649136e-02]
 [-9.62374809e-04]
 [-2.63612267e-02]
 [ 2.48243083e-03]
 [ 4.58379137e-04]
 [-2.48185489e-03]
 [ 1.07544995e-02]
 [-1.05391050e-02]
 [ 1.10409450e-02]
 [ 4.40374266e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.90566497]
curr_Stock_Price:  99.94357319015421
curr_Factors:  [99.94357319]
mat_Sqrt:  [[0.15]]
grads:  [0.18206385]
Stock Position:  0.1820638478978604
Bond Position:  [-17.29044654]


portfolio before change:  [0.90287165]
curr_Stock_Price:  99.9519759430897
curr_Factors:  [99.95197594]
mat_Sqrt:  [[0.15]]
grads:  [-0.01273883]
Stock Position:  -0.012738834984858066
Bond Position:  [2.17614338]


portfolio before change:  [0.91847745]
curr_Stock_Price:  98.76963159139717
curr_Factors:  [98.76963159]
mat_Sqrt:  [[0.15]]
grads:  [0.04045247]
Stock Position:  0.040452467293853406
Bond Position:  [-3.07699784]


portfolio before change:  [0.87350845]
curr_Stock_Price:  97.67699977910787
curr_Factors:  [97.67699978]
mat_Sqrt:  [[0.15]]
grads:  [0.00932665]
Stock Position:  0.009326652441378326
Bond Position:  [-0.03749098]


portfolio before change:  [0.8693914]
curr_Stock_Price:  97.2365764350768
curr_Factors:  [97.23657644]
mat_Sqrt:  [[0.15]]
grads:  [0.05883744]
Stock Position:  0.0588374351702328
Bond Position:  [-4.85175936]


portfolio before change:  [0.87633672]
curr_Stock_Price:  97.37523672533281
curr_Factors:  [97.37523673]
mat_Sqrt:  [[0.15]]
grads:  [0.16614733]
Stock Position:  0.166147330220203
Bond Position:  [-15.30229889]


portfolio before change:  [0.62037941]
curr_Stock_Price:  95.85772053946653
curr_Factors:  [95.85772054]
mat_Sqrt:  [[0.15]]
grads:  [-0.03471316]
Stock Position:  -0.03471316488282694
Bond Position:  [3.94790427]


portfolio before change:  [0.62518109]
curr_Stock_Price:  95.74783196505916
curr_Factors:  [95.74783197]
mat_Sqrt:  [[0.15]]
grads:  [0.04888787]
Stock Position:  0.048887868118770716
Bond Position:  [-4.05572629]


portfolio before change:  [0.6650197]
curr_Stock_Price:  96.58347220330053
curr_Factors:  [96.5834722]
mat_Sqrt:  [[0.15]]
grads:  [0.03280924]
Stock Position:  0.0328092395233958
Bond Position:  [-2.50381057]


portfolio before change:  [0.65568875]
curr_Stock_Price:  96.31815304146544
curr_Factors:  [96.31815304]
mat_Sqrt:  [[0.15]]
grads:  [-0.24843276]
Stock Position:  -0.24843275730767303
Bond Position:  [24.58427309]


portfolio before change:  [0.43084985]
curr_Stock_Price:  97.24792468107232
curr_Factors:  [97.24792468]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641583]
Stock Position:  -0.006415832060527339
Bond Position:  [1.05477621]


portfolio before change:  [0.43727606]
curr_Stock_Price:  96.28741274497527
curr_Factors:  [96.28741274]
mat_Sqrt:  [[0.15]]
grads:  [-0.17574151]
Stock Position:  -0.17574151128134724
Bond Position:  [17.3589715]


portfolio before change:  [0.52382975]
curr_Stock_Price:  95.81960405751421
curr_Factors:  [95.81960406]
mat_Sqrt:  [[0.15]]
grads:  [0.01654954]
Stock Position:  0.01654953885165637
Bond Position:  [-1.06194051]


portfolio before change:  [0.54896755]
curr_Stock_Price:  97.35459048287184
curr_Factors:  [97.35459048]
mat_Sqrt:  [[0.15]]
grads:  [0.00305586]
Stock Position:  0.003055860911376993
Bond Position:  [0.25146547]


portfolio before change:  [0.55274076]
curr_Stock_Price:  98.56875858390441
curr_Factors:  [98.56875858]
mat_Sqrt:  [[0.15]]
grads:  [-0.0165457]
Stock Position:  -0.016545699257360675
Bond Position:  [2.18362979]


portfolio before change:  [0.53727727]
curr_Stock_Price:  99.53634900442502
curr_Factors:  [99.536349]
mat_Sqrt:  [[0.15]]
grads:  [0.07169666]
Stock Position:  0.07169666301753759
Bond Position:  [-6.5991468]


portfolio before change:  [0.63663467]
curr_Stock_Price:  100.94516479154149
curr_Factors:  [100.94516479]
mat_Sqrt:  [[0.15]]
grads:  [-0.0702607]
Stock Position:  -0.0702607000831391
Bond Position:  [7.72911262]


portfolio before change:  [0.65857539]
curr_Stock_Price:  100.66039387329178
curr_Factors:  [100.66039387]
mat_Sqrt:  [[0.15]]
grads:  [0.0736063]
Stock Position:  0.07360630027469883
Bond Position:  [-6.75066378]


portfolio before change:  [0.75232956]
curr_Stock_Price:  101.95704977334111
curr_Factors:  [101.95704977]
mat_Sqrt:  [[0.15]]
grads:  [0.02935828]
Stock Position:  0.02935828441990879
Bond Position:  [-2.24095451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.75232956]
Stock Price:  100.43812789962907
PL:  [0.31420166]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-4.00367444e-02]
 [-7.80281543e-03]
 [-1.05439417e-02]
 [ 2.41031416e-03]
 [ 6.92712796e-03]
 [ 6.03887676e-03]
 [ 7.83439040e-04]
 [-1.94608250e-03]
 [-1.31214242e-03]
 [-5.99656475e-03]
 [-5.56776079e-03]
 [-2.25388111e-02]
 [-8.13017614e-05]
 [ 3.83286651e-03]
 [-2.51500124e-03]
 [ 1.18282127e-02]
 [ 5.00311659e-02]
 [ 1.89190100e-02]
 [ 1.95919838e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.33235596]
curr_Stock_Price:  101.5409321702126
curr_Factors:  [101.54093217]
mat_Sqrt:  [[0.15]]
grads:  [-0.26691163]
Stock Position:  -0.26691162905340376
Bond Position:  [52.43481158]


portfolio before change:  [25.4118028]
curr_Stock_Price:  101.29239861611437
curr_Factors:  [101.29239862]
mat_Sqrt:  [[0.15]]
grads:  [-0.05201877]
Stock Position:  -0.05201876951997412
Bond Position:  [30.68090874]


portfolio before change:  [25.45933295]
curr_Stock_Price:  100.52615667989446
curr_Factors:  [100.52615668]
mat_Sqrt:  [[0.15]]
grads:  [-0.07029294]
Stock Position:  -0.07029294474079446
Bond Position:  [32.52561253]


portfolio before change:  [25.45429743]
curr_Stock_Price:  100.71348612994798
curr_Factors:  [100.71348613]
mat_Sqrt:  [[0.15]]
grads:  [0.01606876]
Stock Position:  0.01606876103444607
Bond Position:  [23.83595649]


portfolio before change:  [25.46063148]
curr_Stock_Price:  100.7367805771158
curr_Factors:  [100.73678058]
mat_Sqrt:  [[0.15]]
grads:  [0.04618085]
Stock Position:  0.046180853063447845
Bond Position:  [20.80852102]


portfolio before change:  [25.4317792]
curr_Stock_Price:  99.99935246559366
curr_Factors:  [99.99935247]
mat_Sqrt:  [[0.15]]
grads:  [0.04025918]
Stock Position:  0.040259178369831755
Bond Position:  [21.40588743]


portfolio before change:  [25.47085861]
curr_Stock_Price:  100.83710594310882
curr_Factors:  [100.83710594]
mat_Sqrt:  [[0.15]]
grads:  [0.00522293]
Stock Position:  0.00522292693427869
Bond Position:  [24.94419377]


portfolio before change:  [25.47236921]
curr_Stock_Price:  99.93220563185804
curr_Factors:  [99.93220563]
mat_Sqrt:  [[0.15]]
grads:  [-0.01297388]
Stock Position:  -0.012973883322463457
Bond Position:  [26.76887798]


portfolio before change:  [25.46717981]
curr_Stock_Price:  100.84808057048035
curr_Factors:  [100.84808057]
mat_Sqrt:  [[0.15]]
grads:  [-0.00874762]
Stock Position:  -0.00874761615407891
Bond Position:  [26.34936011]


portfolio before change:  [25.47797354]
curr_Stock_Price:  100.36731315253192
curr_Factors:  [100.36731315]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399771]
Stock Position:  -0.03997709831299378
Bond Position:  [29.49036748]


portfolio before change:  [25.45824616]
curr_Stock_Price:  101.04522370003914
curr_Factors:  [101.0452237]
mat_Sqrt:  [[0.15]]
grads:  [-0.03711841]
Stock Position:  -0.03711840524163194
Bond Position:  [29.20888372]


portfolio before change:  [25.46485018]
curr_Stock_Price:  101.06405843019643
curr_Factors:  [101.06405843]
mat_Sqrt:  [[0.15]]
grads:  [-0.15025874]
Stock Position:  -0.15025874073356724
Bond Position:  [40.65060833]


portfolio before change:  [25.41483223]
curr_Stock_Price:  101.46458003367368
curr_Factors:  [101.46458003]
mat_Sqrt:  [[0.15]]
grads:  [-0.00054201]
Stock Position:  -0.0005420117423601317
Bond Position:  [25.46982722]


portfolio before change:  [25.42258785]
curr_Stock_Price:  98.90490170220077
curr_Factors:  [98.9049017]
mat_Sqrt:  [[0.15]]
grads:  [0.02555244]
Stock Position:  0.025552443377198468
Bond Position:  [22.89532595]


portfolio before change:  [25.42203305]
curr_Stock_Price:  98.65915807652482
curr_Factors:  [98.65915808]
mat_Sqrt:  [[0.15]]
grads:  [-0.01676667]
Stock Position:  -0.0167666749473183
Bond Position:  [27.07621909]


portfolio before change:  [25.44925557]
curr_Stock_Price:  97.43932035103593
curr_Factors:  [97.43932035]
mat_Sqrt:  [[0.15]]
grads:  [0.07885475]
Stock Position:  0.0788547513347105
Bond Position:  [17.7657022]


portfolio before change:  [25.50500276]
curr_Stock_Price:  98.0899495737876
curr_Factors:  [98.08994957]
mat_Sqrt:  [[0.15]]
grads:  [0.33354111]
Stock Position:  0.3335411059182408
Bond Position:  [-7.2120275]


portfolio before change:  [24.72105941]
curr_Stock_Price:  95.74499086805447
curr_Factors:  [95.74499087]
mat_Sqrt:  [[0.15]]
grads:  [0.12612673]
Stock Position:  0.1261267336496035
Bond Position:  [12.64505645]


portfolio before change:  [24.58883212]
curr_Stock_Price:  94.67155508360688
curr_Factors:  [94.67155508]
mat_Sqrt:  [[0.15]]
grads:  [0.01306132]
Stock Position:  0.013061322508489688
Bond Position:  [23.35229641]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.58883212]
Stock Price:  95.15543431198121
PL:  [24.58883212]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.15912687e-02]
 [-7.39112415e-03]
 [-7.98378717e-03]
 [ 3.79634813e-03]
 [ 8.41403403e-03]
 [ 6.26085690e-03]
 [-1.26717770e-02]
 [-7.05605989e-04]
 [-7.47914170e-04]
 [ 1.74775615e-03]
 [-1.50845216e-03]
 [-2.34281503e-02]
 [ 6.45754386e-04]
 [-4.34667568e-03]
 [-3.16356067e-03]
 [ 1.05864191e-02]
 [ 3.64734259e-02]
 [ 1.85114107e-02]
 [ 3.82833926e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.24988424]
curr_Stock_Price:  100.22765905606768
curr_Factors:  [100.22765906]
mat_Sqrt:  [[0.15]]
grads:  [0.21060846]
Stock Position:  0.21060845767739186
Bond Position:  [-15.85890845]


portfolio before change:  [5.59933093]
curr_Stock_Price:  101.9057108985826
curr_Factors:  [101.9057109]
mat_Sqrt:  [[0.15]]
grads:  [-0.04927416]
Stock Position:  -0.049274160968257
Bond Position:  [10.62064933]


portfolio before change:  [5.69123766]
curr_Stock_Price:  100.09439156365382
curr_Factors:  [100.09439156]
mat_Sqrt:  [[0.15]]
grads:  [-0.05322525]
Stock Position:  -0.053225247829703434
Bond Position:  [11.01878646]


portfolio before change:  [5.7323147]
curr_Stock_Price:  99.3743949563394
curr_Factors:  [99.37439496]
mat_Sqrt:  [[0.15]]
grads:  [0.02530899]
Stock Position:  0.025308987525814407
Bond Position:  [3.21724938]


portfolio before change:  [5.7207592]
curr_Stock_Price:  98.88603447333423
curr_Factors:  [98.88603447]
mat_Sqrt:  [[0.15]]
grads:  [0.05609356]
Stock Position:  0.05609356018029008
Bond Position:  [0.17388948]


portfolio before change:  [5.78388499]
curr_Stock_Price:  100.01062535196289
curr_Factors:  [100.01062535]
mat_Sqrt:  [[0.15]]
grads:  [0.04173905]
Stock Position:  0.04173904600614092
Bond Position:  [1.60953689]


portfolio before change:  [5.77668658]
curr_Stock_Price:  99.82852144873745
curr_Factors:  [99.82852145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08447851]
Stock Position:  -0.08447851315839604
Bond Position:  [14.21005164]


portfolio before change:  [5.65012381]
curr_Stock_Price:  101.3687441285111
curr_Factors:  [101.36874413]
mat_Sqrt:  [[0.15]]
grads:  [-0.00470404]
Stock Position:  -0.004704039925394623
Bond Position:  [6.12696643]


portfolio before change:  [5.64975627]
curr_Stock_Price:  101.77254119335001
curr_Factors:  [101.77254119]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498609]
Stock Position:  -0.004986094466788771
Bond Position:  [6.15720377]


portfolio before change:  [5.65602736]
curr_Stock_Price:  100.82358219416741
curr_Factors:  [100.82358219]
mat_Sqrt:  [[0.15]]
grads:  [0.01165171]
Stock Position:  0.011651707677908496
Bond Position:  [4.48126045]


portfolio before change:  [5.64630291]
curr_Stock_Price:  99.89282557928453
curr_Factors:  [99.89282558]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005635]
Stock Position:  -0.010056347705662614
Bond Position:  [6.6508599]


portfolio before change:  [5.64243171]
curr_Stock_Price:  100.44313682114057
curr_Factors:  [100.44313682]
mat_Sqrt:  [[0.15]]
grads:  [-0.15618767]
Stock Position:  -0.15618766865300948
Bond Position:  [21.33041109]


portfolio before change:  [5.64921176]
curr_Stock_Price:  100.43387374570301
curr_Factors:  [100.43387375]
mat_Sqrt:  [[0.15]]
grads:  [0.00430503]
Stock Position:  0.004305029241293789
Bond Position:  [5.216841]


portfolio before change:  [5.65128759]
curr_Stock_Price:  100.61307173502043
curr_Factors:  [100.61307174]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897784]
Stock Position:  -0.028977837835009075
Bond Position:  [8.56683686]


portfolio before change:  [5.68184103]
curr_Stock_Price:  99.63261669230263
curr_Factors:  [99.63261669]
mat_Sqrt:  [[0.15]]
grads:  [-0.0210904]
Stock Position:  -0.021090404465189724
Bond Position:  [7.78313322]


portfolio before change:  [5.67106972]
curr_Stock_Price:  100.23560828925905
curr_Factors:  [100.23560829]
mat_Sqrt:  [[0.15]]
grads:  [0.07057613]
Stock Position:  0.07057612766593231
Bond Position:  [-1.40317137]


portfolio before change:  [5.63742548]
curr_Stock_Price:  99.76387085749454
curr_Factors:  [99.76387086]
mat_Sqrt:  [[0.15]]
grads:  [0.24315617]
Stock Position:  0.24315617298505565
Bond Position:  [-18.62077556]


portfolio before change:  [5.66473784]
curr_Stock_Price:  99.89534246246376
curr_Factors:  [99.89534246]
mat_Sqrt:  [[0.15]]
grads:  [0.1234094]
Stock Position:  0.12340940450625079
Bond Position:  [-6.66328689]


portfolio before change:  [5.83592864]
curr_Stock_Price:  101.29602040361948
curr_Factors:  [101.2960204]
mat_Sqrt:  [[0.15]]
grads:  [0.02552226]
Stock Position:  0.02552226174096965
Bond Position:  [3.2506251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.83592864]
Stock Price:  100.7490876401224
PL:  [5.086841]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.16308193e-01]
 [ 6.96180383e-03]
 [ 8.66609523e-03]
 [ 2.93041423e-03]
 [ 8.66550128e-03]
 [ 1.24168037e-02]
 [-1.53478348e-02]
 [-1.95164165e-03]
 [-2.92550810e-05]
 [ 2.80080737e-02]
 [-7.04122333e-03]
 [-2.00672196e-02]
 [-5.83657985e-04]
 [-1.01677152e-02]
 [-1.84937178e-03]
 [ 8.02431388e-03]
 [-4.50581016e-02]
 [-2.55226525e-02]
 [ 4.66246864e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-23.17177994]
curr_Stock_Price:  98.36905280812057
curr_Factors:  [98.36905281]
mat_Sqrt:  [[0.15]]
grads:  [0.77538796]
Stock Position:  0.7753879552713338
Bond Position:  [-99.44595866]


portfolio before change:  [-22.74189541]
curr_Stock_Price:  98.95553228911844
curr_Factors:  [98.95553229]
mat_Sqrt:  [[0.15]]
grads:  [0.04641203]
Stock Position:  0.04641202553986353
Bond Position:  [-27.3346221]


portfolio before change:  [-22.77537547]
curr_Stock_Price:  98.38142345743424
curr_Factors:  [98.38142346]
mat_Sqrt:  [[0.15]]
grads:  [0.05777397]
Stock Position:  0.057773968200461906
Bond Position:  [-28.4592607]


portfolio before change:  [-22.79522828]
curr_Stock_Price:  98.16095906003397
curr_Factors:  [98.16095906]
mat_Sqrt:  [[0.15]]
grads:  [0.01953609]
Stock Position:  0.019536094894914854
Bond Position:  [-24.71291009]


portfolio before change:  [-22.80504661]
curr_Stock_Price:  97.97467178039923
curr_Factors:  [97.97467178]
mat_Sqrt:  [[0.15]]
grads:  [0.05777001]
Stock Position:  0.057770008560815045
Bond Position:  [-28.46504423]


portfolio before change:  [-22.79372175]
curr_Stock_Price:  98.29390327737315
curr_Factors:  [98.29390328]
mat_Sqrt:  [[0.15]]
grads:  [0.08277869]
Stock Position:  0.08277869137883329
Bond Position:  [-30.93036243]


portfolio before change:  [-22.69534844]
curr_Stock_Price:  99.57571708454452
curr_Factors:  [99.57571708]
mat_Sqrt:  [[0.15]]
grads:  [-0.1023189]
Stock Position:  -0.10231889864391588
Bond Position:  [-12.50687073]


portfolio before change:  [-22.81877092]
curr_Stock_Price:  100.75140770852468
curr_Factors:  [100.75140771]
mat_Sqrt:  [[0.15]]
grads:  [-0.01301094]
Stock Position:  -0.013010944312583416
Bond Position:  [-21.50789996]


portfolio before change:  [-22.84772167]
curr_Stock_Price:  102.56319842938072
curr_Factors:  [102.56319843]
mat_Sqrt:  [[0.15]]
grads:  [-0.00019503]
Stock Position:  -0.00019503387364368588
Bond Position:  [-22.82771837]


portfolio before change:  [-22.85333673]
curr_Stock_Price:  102.08846330189508
curr_Factors:  [102.0884633]
mat_Sqrt:  [[0.15]]
grads:  [0.18672049]
Stock Position:  0.18672049110179478
Bond Position:  [-41.91534473]


portfolio before change:  [-22.89792008]
curr_Stock_Price:  101.90582018405914
curr_Factors:  [101.90582018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04694149]
Stock Position:  -0.046941488861770166
Bond Position:  [-18.11430916]


portfolio before change:  [-22.99142675]
curr_Stock_Price:  103.80131860635467
curr_Factors:  [103.80131861]
mat_Sqrt:  [[0.15]]
grads:  [-0.13378146]
Stock Position:  -0.13378146410557554
Bond Position:  [-9.10473437]


portfolio before change:  [-22.84322841]
curr_Stock_Price:  102.67653792143031
curr_Factors:  [102.67653792]
mat_Sqrt:  [[0.15]]
grads:  [-0.00389105]
Stock Position:  -0.003891053234413751
Bond Position:  [-22.44370853]


portfolio before change:  [-22.84292827]
curr_Stock_Price:  101.15721558369366
curr_Factors:  [101.15721558]
mat_Sqrt:  [[0.15]]
grads:  [-0.06778477]
Stock Position:  -0.06778476771562236
Bond Position:  [-15.98600991]


portfolio before change:  [-22.86721811]
curr_Stock_Price:  101.45658726855724
curr_Factors:  [101.45658727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01232915]
Stock Position:  -0.012329145191086462
Bond Position:  [-21.61634512]


portfolio before change:  [-22.90736234]
curr_Stock_Price:  104.27425712923022
curr_Factors:  [104.27425713]
mat_Sqrt:  [[0.15]]
grads:  [0.05349543]
Stock Position:  0.05349542583509041
Bond Position:  [-28.48555813]


portfolio before change:  [-22.98235784]
curr_Stock_Price:  103.0054902268506
curr_Factors:  [103.00549023]
mat_Sqrt:  [[0.15]]
grads:  [-0.30038734]
Stock Position:  -0.30038734390853067
Bond Position:  [7.95918777]


portfolio before change:  [-23.07007919]
curr_Stock_Price:  103.30414260135932
curr_Factors:  [103.3041426]
mat_Sqrt:  [[0.15]]
grads:  [-0.17015102]
Stock Position:  -0.1701510169302372
Bond Position:  [-5.49277427]


portfolio before change:  [-23.59616688]
curr_Stock_Price:  106.38795796271866
curr_Factors:  [106.38795796]
mat_Sqrt:  [[0.15]]
grads:  [0.03108312]
Stock Position:  0.03108312427701292
Bond Position:  [-26.90303699]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.59616688]
Stock Price:  106.69490787410805
PL:  [-30.29107475]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.93374758e-02]
 [-8.02872968e-03]
 [-7.62335563e-04]
 [ 3.98051975e-03]
 [ 8.20164439e-03]
 [ 9.93266757e-03]
 [-1.11818866e-02]
 [-7.29233088e-04]
 [-1.19988324e-03]
 [ 7.30945473e-03]
 [-9.10570946e-03]
 [-1.97504337e-02]
 [-1.23401204e-03]
 [-1.56035279e-02]
 [ 7.87593897e-04]
 [ 8.50786117e-03]
 [-4.80319057e-02]
 [-2.60225225e-02]
 [ 4.69711422e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.08306155]
curr_Stock_Price:  100.4783258452683
curr_Factors:  [100.47832585]
mat_Sqrt:  [[0.15]]
grads:  [0.26224984]
Stock Position:  0.26224983846281463
Bond Position:  [-17.26736317]


portfolio before change:  [9.09988033]
curr_Stock_Price:  100.55892135879596
curr_Factors:  [100.55892136]
mat_Sqrt:  [[0.15]]
grads:  [-0.05352486]
Stock Position:  -0.05352486454518739
Bond Position:  [14.48228298]


portfolio before change:  [9.16036073]
curr_Stock_Price:  99.49662306079354
curr_Factors:  [99.49662306]
mat_Sqrt:  [[0.15]]
grads:  [-0.00508224]
Stock Position:  -0.005082237084267106
Bond Position:  [9.66602615]


portfolio before change:  [9.16489022]
curr_Stock_Price:  99.08092246650565
curr_Factors:  [99.08092247]
mat_Sqrt:  [[0.15]]
grads:  [0.0265368]
Stock Position:  0.026536798305348223
Bond Position:  [6.53559977]


portfolio before change:  [9.17114185]
curr_Stock_Price:  99.25492684262676
curr_Factors:  [99.25492684]
mat_Sqrt:  [[0.15]]
grads:  [0.05467763]
Stock Position:  0.05467762928252198
Bond Position:  [3.74411775]


portfolio before change:  [9.2439379]
curr_Stock_Price:  100.56917370507811
curr_Factors:  [100.56917371]
mat_Sqrt:  [[0.15]]
grads:  [0.06621778]
Stock Position:  0.06621778378859638
Bond Position:  [2.5844701]


portfolio before change:  [9.20349498]
curr_Stock_Price:  99.94865886719961
curr_Factors:  [99.94865887]
mat_Sqrt:  [[0.15]]
grads:  [-0.07454591]
Stock Position:  -0.07454591057277236
Bond Position:  [16.65425876]


portfolio before change:  [9.25470812]
curr_Stock_Price:  99.3175168422396
curr_Factors:  [99.31751684]
mat_Sqrt:  [[0.15]]
grads:  [-0.00486155]
Stock Position:  -0.004861553920190674
Bond Position:  [9.73754558]


portfolio before change:  [9.25094281]
curr_Stock_Price:  100.59282966339646
curr_Factors:  [100.59282966]
mat_Sqrt:  [[0.15]]
grads:  [-0.00799922]
Stock Position:  -0.007999221598502209
Bond Position:  [10.05560714]


portfolio before change:  [9.24913437]
curr_Stock_Price:  101.13321448835697
curr_Factors:  [101.13321449]
mat_Sqrt:  [[0.15]]
grads:  [0.0487297]
Stock Position:  0.0487296981923071
Bond Position:  [4.32094335]


portfolio before change:  [9.32286781]
curr_Stock_Price:  102.62415480461942
curr_Factors:  [102.6241548]
mat_Sqrt:  [[0.15]]
grads:  [-0.06070473]
Stock Position:  -0.06070472972253864
Bond Position:  [15.55263939]


portfolio before change:  [9.23224272]
curr_Stock_Price:  104.18109664163492
curr_Factors:  [104.18109664]
mat_Sqrt:  [[0.15]]
grads:  [-0.13166956]
Stock Position:  -0.13166955813051737
Bond Position:  [22.94972168]


portfolio before change:  [9.26719195]
curr_Stock_Price:  103.9592451742728
curr_Factors:  [103.95924517]
mat_Sqrt:  [[0.15]]
grads:  [-0.00822675]
Stock Position:  -0.00822674693092953
Bond Position:  [10.12243836]


portfolio before change:  [9.28813085]
curr_Stock_Price:  101.72166965324324
curr_Factors:  [101.72166965]
mat_Sqrt:  [[0.15]]
grads:  [-0.10402352]
Stock Position:  -0.10402351932120397
Bond Position:  [19.86957692]


portfolio before change:  [9.19833222]
curr_Stock_Price:  102.63268134909775
curr_Factors:  [102.63268135]
mat_Sqrt:  [[0.15]]
grads:  [0.00525063]
Stock Position:  0.00525062597988351
Bond Position:  [8.6594464]


portfolio before change:  [9.20386017]
curr_Stock_Price:  103.27314235425216
curr_Factors:  [103.27314235]
mat_Sqrt:  [[0.15]]
grads:  [0.05671907]
Stock Position:  0.056719074458043015
Bond Position:  [3.34630312]


portfolio before change:  [9.15494199]
curr_Stock_Price:  102.39592656348819
curr_Factors:  [102.39592656]
mat_Sqrt:  [[0.15]]
grads:  [-0.3202127]
Stock Position:  -0.32021270485061587
Bond Position:  [41.9434186]


portfolio before change:  [8.94238511]
curr_Stock_Price:  103.09247618239174
curr_Factors:  [103.09247618]
mat_Sqrt:  [[0.15]]
grads:  [-0.17348348]
Stock Position:  -0.173483483182867
Bond Position:  [26.82722697]


portfolio before change:  [8.92770651]
curr_Stock_Price:  103.21575160470483
curr_Factors:  [103.2157516]
mat_Sqrt:  [[0.15]]
grads:  [0.03131409]
Stock Position:  0.031314094817798475
Bond Position:  [5.69559868]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.92770651]
Stock Price:  103.00555359398551
PL:  [5.92215292]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.03445962e-02]
 [-7.67917152e-03]
 [-1.02971041e-02]
 [ 2.30296054e-03]
 [ 7.43798256e-03]
 [ 1.11226391e-02]
 [ 2.70407412e-03]
 [-1.56157340e-03]
 [ 2.13414381e-03]
 [-3.72506208e-02]
 [-3.78386127e-04]
 [-2.63882621e-02]
 [ 1.88826822e-03]
 [-6.29096676e-03]
 [-5.54792351e-04]
 [ 9.41077219e-03]
 [ 4.24305638e-02]
 [ 1.69619465e-02]
 [ 1.35804326e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.63045334]
curr_Stock_Price:  100.44872798512048
curr_Factors:  [100.44872799]
mat_Sqrt:  [[0.15]]
grads:  [0.26896397]
Stock Position:  0.2689639745830113
Bond Position:  [-18.38663578]


portfolio before change:  [8.93184607]
curr_Stock_Price:  101.58638948480126
curr_Factors:  [101.58638948]
mat_Sqrt:  [[0.15]]
grads:  [-0.05119448]
Stock Position:  -0.05119447682946472
Bond Position:  [14.13250813]


portfolio before change:  [8.96596837]
curr_Stock_Price:  100.9888889081684
curr_Factors:  [100.98888891]
mat_Sqrt:  [[0.15]]
grads:  [-0.06864736]
Stock Position:  -0.06864736084532251
Bond Position:  [15.89858907]


portfolio before change:  [8.96305525]
curr_Stock_Price:  101.08923159742415
curr_Factors:  [101.0892316]
mat_Sqrt:  [[0.15]]
grads:  [0.01535307]
Stock Position:  0.015353070240244873
Bond Position:  [7.41102518]


portfolio before change:  [8.94966161]
curr_Stock_Price:  100.09616451226934
curr_Factors:  [100.09616451]
mat_Sqrt:  [[0.15]]
grads:  [0.04958655]
Stock Position:  0.04958655038829499
Bond Position:  [3.9862381]


portfolio before change:  [8.98680129]
curr_Stock_Price:  100.82505154826904
curr_Factors:  [100.82505155]
mat_Sqrt:  [[0.15]]
grads:  [0.07415093]
Stock Position:  0.07415092708831435
Bond Position:  [1.51053024]


portfolio before change:  [9.02135318]
curr_Stock_Price:  101.28592521544778
curr_Factors:  [101.28592522]
mat_Sqrt:  [[0.15]]
grads:  [0.01802716]
Stock Position:  0.01802716079567247
Bond Position:  [7.19545552]


portfolio before change:  [8.99451304]
curr_Stock_Price:  99.6972543579643
curr_Factors:  [99.69725436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01041049]
Stock Position:  -0.010410489348431069
Bond Position:  [10.03241025]


portfolio before change:  [9.01750896]
curr_Stock_Price:  97.72928738827214
curr_Factors:  [97.72928739]
mat_Sqrt:  [[0.15]]
grads:  [0.01422763]
Stock Position:  0.014227625380047293
Bond Position:  [7.62705327]


portfolio before change:  [9.0083838]
curr_Stock_Price:  96.9538835177784
curr_Factors:  [96.95388352]
mat_Sqrt:  [[0.15]]
grads:  [-0.24833747]
Stock Position:  -0.2483374719069273
Bond Position:  [33.08566613]


portfolio before change:  [9.48828661]
curr_Stock_Price:  95.0547325203812
curr_Factors:  [95.05473252]
mat_Sqrt:  [[0.15]]
grads:  [-0.00252257]
Stock Position:  -0.002522574182536065
Bond Position:  [9.72806922]


portfolio before change:  [9.49264182]
curr_Stock_Price:  94.2924611506041
curr_Factors:  [94.29246115]
mat_Sqrt:  [[0.15]]
grads:  [-0.17592175]
Stock Position:  -0.175921747041875
Bond Position:  [26.08073632]


portfolio before change:  [9.66951394]
curr_Stock_Price:  93.32412647333973
curr_Factors:  [93.32412647]
mat_Sqrt:  [[0.15]]
grads:  [0.01258845]
Stock Position:  0.012588454781956564
Bond Position:  [8.4947074]


portfolio before change:  [9.66857451]
curr_Stock_Price:  93.0807784580049
curr_Factors:  [93.08077846]
mat_Sqrt:  [[0.15]]
grads:  [-0.04193978]
Stock Position:  -0.041939778391406016
Bond Position:  [13.57236173]


portfolio before change:  [9.58965968]
curr_Stock_Price:  95.04331495639534
curr_Factors:  [95.04331496]
mat_Sqrt:  [[0.15]]
grads:  [-0.00369862]
Stock Position:  -0.0036986156750836814
Bond Position:  [9.94118837]


portfolio before change:  [9.58954752]
curr_Stock_Price:  95.74567793866248
curr_Factors:  [95.74567794]
mat_Sqrt:  [[0.15]]
grads:  [0.06273848]
Stock Position:  0.06273848129637728
Bond Position:  [3.58260909]


portfolio before change:  [9.59137771]
curr_Stock_Price:  95.76057194340447
curr_Factors:  [95.76057194]
mat_Sqrt:  [[0.15]]
grads:  [0.28287043]
Stock Position:  0.2828704253704059
Bond Position:  [-17.49645601]


portfolio before change:  [9.28756165]
curr_Stock_Price:  94.70199043553885
curr_Factors:  [94.70199044]
mat_Sqrt:  [[0.15]]
grads:  [0.11307964]
Stock Position:  0.1130796435620562
Bond Position:  [-1.42130568]


portfolio before change:  [9.20424314]
curr_Stock_Price:  93.9683204809839
curr_Factors:  [93.96832048]
mat_Sqrt:  [[0.15]]
grads:  [0.00905362]
Stock Position:  0.009053621716874726
Bond Position:  [8.35348951]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20424314]
Stock Price:  94.34347355018203
PL:  [9.20424314]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.99973735e-02]
 [-6.66080391e-03]
 [-4.92364137e-03]
 [ 2.63530362e-03]
 [ 7.00818834e-03]
 [ 7.82933519e-03]
 [-1.57461300e-02]
 [ 3.95857188e-03]
 [ 1.30238846e-04]
 [-3.06903577e-02]
 [-1.98290344e-03]
 [-2.24487950e-02]
 [-4.96979173e-04]
 [-8.09864916e-03]
 [-3.43683397e-03]
 [ 1.15582193e-02]
 [ 4.22940387e-02]
 [ 1.98038725e-02]
 [ 3.89534063e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.47226253]
curr_Stock_Price:  101.55008121983539
curr_Factors:  [101.55008122]
mat_Sqrt:  [[0.15]]
grads:  [-0.26664916]
Stock Position:  -0.26664915646955417
Bond Position:  [52.55050602]


portfolio before change:  [25.24742443]
curr_Stock_Price:  102.44255495893289
curr_Factors:  [102.44255496]
mat_Sqrt:  [[0.15]]
grads:  [-0.04440536]
Stock Position:  -0.04440535940375404
Bond Position:  [29.7964229]


portfolio before change:  [25.30017599]
curr_Stock_Price:  101.42237336175046
curr_Factors:  [101.42237336]
mat_Sqrt:  [[0.15]]
grads:  [-0.03282428]
Stock Position:  -0.03282427578283602
Bond Position:  [28.62929195]


portfolio before change:  [25.3415122]
curr_Stock_Price:  100.3811322160777
curr_Factors:  [100.38113222]
mat_Sqrt:  [[0.15]]
grads:  [0.01756869]
Stock Position:  0.01756869077542893
Bond Position:  [23.57794713]


portfolio before change:  [25.35129847]
curr_Stock_Price:  100.60260860192507
curr_Factors:  [100.6026086]
mat_Sqrt:  [[0.15]]
grads:  [0.04672126]
Stock Position:  0.046721255591781856
Bond Position:  [20.65101828]


portfolio before change:  [25.33252514]
curr_Stock_Price:  100.09027787014352
curr_Factors:  [100.09027787]
mat_Sqrt:  [[0.15]]
grads:  [0.05219557]
Stock Position:  0.0521955679602605
Bond Position:  [20.10825624]


portfolio before change:  [25.2819877]
curr_Stock_Price:  99.0257214050735
curr_Factors:  [99.02572141]
mat_Sqrt:  [[0.15]]
grads:  [-0.1049742]
Stock Position:  -0.10497420014572566
Bond Position:  [35.6771336]


portfolio before change:  [25.40950613]
curr_Stock_Price:  97.89593875337223
curr_Factors:  [97.89593875]
mat_Sqrt:  [[0.15]]
grads:  [0.02639048]
Stock Position:  0.026390479181766926
Bond Position:  [22.8259854]


portfolio before change:  [25.44487023]
curr_Stock_Price:  99.01971109059427
curr_Factors:  [99.01971109]
mat_Sqrt:  [[0.15]]
grads:  [0.00086826]
Stock Position:  0.000868258974705581
Bond Position:  [25.35889548]


portfolio before change:  [25.45151185]
curr_Stock_Price:  99.36649787523483
curr_Factors:  [99.36649788]
mat_Sqrt:  [[0.15]]
grads:  [-0.20460238]
Stock Position:  -0.2046023847209446
Bond Position:  [45.78213427]


portfolio before change:  [25.32027023]
curr_Stock_Price:  100.0638923950667
curr_Factors:  [100.0638924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01321936]
Stock Position:  -0.01321935628596918
Bond Position:  [26.64305047]


portfolio before change:  [25.31169736]
curr_Stock_Price:  101.21632878493608
curr_Factors:  [101.21632878]
mat_Sqrt:  [[0.15]]
grads:  [-0.14965863]
Stock Position:  -0.1496586332816778
Bond Position:  [40.45959479]


portfolio before change:  [25.1347811]
curr_Stock_Price:  102.46605571680239
curr_Factors:  [102.46605572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00331319]
Stock Position:  -0.003313194486625915
Bond Position:  [25.47427107]


portfolio before change:  [25.14614107]
curr_Stock_Price:  100.9597712574405
curr_Factors:  [100.95977126]
mat_Sqrt:  [[0.15]]
grads:  [-0.05399099]
Stock Position:  -0.053990994383127044
Bond Position:  [30.59705952]


portfolio before change:  [25.18509636]
curr_Stock_Price:  100.37995115996299
curr_Factors:  [100.37995116]
mat_Sqrt:  [[0.15]]
grads:  [-0.02291223]
Stock Position:  -0.02291222646964658
Bond Position:  [27.48502453]


portfolio before change:  [25.23413691]
curr_Stock_Price:  98.53951722961952
curr_Factors:  [98.53951723]
mat_Sqrt:  [[0.15]]
grads:  [0.0770548]
Stock Position:  0.07705479518621361
Bond Position:  [17.64119459]


portfolio before change:  [25.31879587]
curr_Stock_Price:  99.58095935030595
curr_Factors:  [99.58095935]
mat_Sqrt:  [[0.15]]
grads:  [0.28196026]
Stock Position:  0.28196025775353833
Bond Position:  [-2.75907709]


portfolio before change:  [25.31029321]
curr_Stock_Price:  99.5532504640749
curr_Factors:  [99.55325046]
mat_Sqrt:  [[0.15]]
grads:  [0.13202582]
Stock Position:  0.13202581695136908
Bond Position:  [12.16669399]


portfolio before change:  [24.96785203]
curr_Stock_Price:  96.93646506385558
curr_Factors:  [96.93646506]
mat_Sqrt:  [[0.15]]
grads:  [0.02596894]
Stock Position:  0.02596893753045108
Bond Position:  [22.45051503]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.96785203]
Stock Price:  98.87876271882176
PL:  [24.96785203]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.96948370e-03]
 [-7.78816580e-03]
 [ 3.32591965e-03]
 [ 2.58016659e-03]
 [ 8.54649327e-03]
 [ 5.64285999e-03]
 [-1.15980851e-03]
 [ 2.20285050e-04]
 [-3.57960764e-04]
 [ 3.15141544e-02]
 [-7.09887689e-03]
 [-2.08617498e-02]
 [-1.08496532e-03]
 [-1.98100081e-02]
 [ 3.95956250e-03]
 [ 8.76081484e-03]
 [-4.35646077e-02]
 [-2.57393258e-02]
 [ 4.62711818e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.20698812]
curr_Stock_Price:  100.87879388682894
curr_Factors:  [100.87879389]
mat_Sqrt:  [[0.15]]
grads:  [0.01979656]
Stock Position:  0.01979655797162236
Bond Position:  [13.20993523]


portfolio before change:  [15.21916854]
curr_Stock_Price:  101.32723136943254
curr_Factors:  [101.32723137]
mat_Sqrt:  [[0.15]]
grads:  [-0.05192111]
Stock Position:  -0.05192110531673304
Bond Position:  [20.48019039]


portfolio before change:  [15.34052124]
curr_Stock_Price:  99.08860390015853
curr_Factors:  [99.0886039]
mat_Sqrt:  [[0.15]]
grads:  [0.0221728]
Stock Position:  0.022172797675774104
Bond Position:  [13.14344967]


portfolio before change:  [15.32006585]
curr_Stock_Price:  98.01784750363971
curr_Factors:  [98.0178475]
mat_Sqrt:  [[0.15]]
grads:  [0.01720111]
Stock Position:  0.017201110616526002
Bond Position:  [13.63405001]


portfolio before change:  [15.33068538]
curr_Stock_Price:  98.43704101256235
curr_Factors:  [98.43704101]
mat_Sqrt:  [[0.15]]
grads:  [0.05697662]
Stock Position:  0.056976621783752894
Bond Position:  [9.72207532]


portfolio before change:  [15.42098557]
curr_Stock_Price:  99.97924142365076
curr_Factors:  [99.97924142]
mat_Sqrt:  [[0.15]]
grads:  [0.03761907]
Stock Position:  0.03761906658931994
Bond Position:  [11.65985983]


portfolio before change:  [15.51033702]
curr_Stock_Price:  102.27690914591136
curr_Factors:  [102.27690915]
mat_Sqrt:  [[0.15]]
grads:  [-0.00773206]
Stock Position:  -0.0077320567476199765
Bond Position:  [16.30114788]


portfolio before change:  [15.51454819]
curr_Stock_Price:  102.25940009937862
curr_Factors:  [102.2594001]
mat_Sqrt:  [[0.15]]
grads:  [0.00146857]
Stock Position:  0.0014685669978517458
Bond Position:  [15.36437341]


portfolio before change:  [15.51821597]
curr_Stock_Price:  102.14105838858399
curr_Factors:  [102.14105839]
mat_Sqrt:  [[0.15]]
grads:  [-0.00238641]
Stock Position:  -0.002386405093033254
Bond Position:  [15.76196592]


portfolio before change:  [15.52179764]
curr_Stock_Price:  102.29162919523104
curr_Factors:  [102.2916292]
mat_Sqrt:  [[0.15]]
grads:  [0.21009436]
Stock Position:  0.21009436288119623
Bond Position:  [-5.96909703]


portfolio before change:  [15.44489731]
curr_Stock_Price:  101.9327054112224
curr_Factors:  [101.93270541]
mat_Sqrt:  [[0.15]]
grads:  [-0.04732585]
Stock Position:  -0.04732584590563725
Bond Position:  [20.26894882]


portfolio before change:  [15.39970937]
curr_Stock_Price:  102.99461585276335
curr_Factors:  [102.99461585]
mat_Sqrt:  [[0.15]]
grads:  [-0.13907833]
Stock Position:  -0.13907833176250675
Bond Position:  [29.72402873]


portfolio before change:  [15.31676774]
curr_Stock_Price:  103.64441922058569
curr_Factors:  [103.64441922]
mat_Sqrt:  [[0.15]]
grads:  [-0.0072331]
Stock Position:  -0.007233102100838388
Bond Position:  [16.06643841]


portfolio before change:  [15.32813677]
curr_Stock_Price:  102.62799240444888
curr_Factors:  [102.6279924]
mat_Sqrt:  [[0.15]]
grads:  [-0.13206672]
Stock Position:  -0.13206672042790799
Bond Position:  [28.88187915]


portfolio before change:  [15.21061544]
curr_Stock_Price:  103.5725354540907
curr_Factors:  [103.57253545]
mat_Sqrt:  [[0.15]]
grads:  [0.02639708]
Stock Position:  0.02639708331030519
Bond Position:  [12.47660259]


portfolio before change:  [15.1882179]
curr_Stock_Price:  102.60587248998027
curr_Factors:  [102.60587249]
mat_Sqrt:  [[0.15]]
grads:  [0.05840543]
Stock Position:  0.05840543228961381
Bond Position:  [9.19547756]


portfolio before change:  [15.23173673]
curr_Stock_Price:  103.31162322585979
curr_Factors:  [103.31162323]
mat_Sqrt:  [[0.15]]
grads:  [-0.29043072]
Stock Position:  -0.2904307182655882
Bond Position:  [45.23660567]


portfolio before change:  [15.27186656]
curr_Stock_Price:  103.21239384404362
curr_Factors:  [103.21239384]
mat_Sqrt:  [[0.15]]
grads:  [-0.17159551]
Stock Position:  -0.1715955050968845
Bond Position:  [32.98264941]


portfolio before change:  [15.17579901]
curr_Stock_Price:  103.82030162785854
curr_Factors:  [103.82030163]
mat_Sqrt:  [[0.15]]
grads:  [0.03084745]
Stock Position:  0.030847454520117855
Bond Position:  [11.97320697]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.17579901]
Stock Price:  105.94157194043926
PL:  [9.23422707]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.58798323e-02]
 [-7.99412295e-03]
 [-9.66688879e-03]
 [ 3.40211659e-03]
 [ 7.22960468e-03]
 [-6.48205541e-03]
 [-7.06962113e-04]
 [ 5.05957434e-04]
 [-3.59451104e-04]
 [ 1.92676614e-02]
 [-6.68715905e-03]
 [-2.29120959e-02]
 [ 7.42124196e-04]
 [ 4.62847526e-03]
 [-2.53583987e-03]
 [ 1.06449392e-02]
 [-5.67801140e-03]
 [ 1.97827286e-02]
 [ 3.79929664e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.90644452]
curr_Stock_Price:  100.33598815565419
curr_Factors:  [100.33598816]
mat_Sqrt:  [[0.15]]
grads:  [0.23919888]
Stock Position:  0.23919888223996563
Bond Position:  [-17.0938117]


portfolio before change:  [6.95167646]
curr_Stock_Price:  100.54295372141168
curr_Factors:  [100.54295372]
mat_Sqrt:  [[0.15]]
grads:  [-0.05329415]
Stock Position:  -0.053294152999798276
Bond Position:  [12.31002802]


portfolio before change:  [6.97409003]
curr_Stock_Price:  100.18014336442751
curr_Factors:  [100.18014336]
mat_Sqrt:  [[0.15]]
grads:  [-0.06444593]
Stock Position:  -0.06444592526684825
Bond Position:  [13.43029206]


portfolio before change:  [6.9950895]
curr_Stock_Price:  99.90640250247245
curr_Factors:  [99.9064025]
mat_Sqrt:  [[0.15]]
grads:  [0.02268078]
Stock Position:  0.022680777287505303
Bond Position:  [4.72913464]


portfolio before change:  [7.0057615]
curr_Stock_Price:  100.32479927301128
curr_Factors:  [100.32479927]
mat_Sqrt:  [[0.15]]
grads:  [0.04819736]
Stock Position:  0.04819736453283282
Bond Position:  [2.17037058]


portfolio before change:  [7.10542291]
curr_Stock_Price:  102.38131724398157
curr_Factors:  [102.38131724]
mat_Sqrt:  [[0.15]]
grads:  [-0.0432137]
Stock Position:  -0.043213702709776924
Bond Position:  [11.52969871]


portfolio before change:  [7.11781965]
curr_Stock_Price:  102.16115643922925
curr_Factors:  [102.16115644]
mat_Sqrt:  [[0.15]]
grads:  [-0.00471308]
Stock Position:  -0.004713080756145819
Bond Position:  [7.59931343]


portfolio before change:  [7.11819278]
curr_Stock_Price:  102.48513527377783
curr_Factors:  [102.48513527]
mat_Sqrt:  [[0.15]]
grads:  [0.00337305]
Stock Position:  0.0033730495618460813
Bond Position:  [6.77250534]


portfolio before change:  [7.11871907]
curr_Stock_Price:  102.13914442063428
curr_Factors:  [102.13914442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00239634]
Stock Position:  -0.0023963406922999832
Bond Position:  [7.36347926]


portfolio before change:  [7.12171257]
curr_Stock_Price:  101.65824581563513
curr_Factors:  [101.65824582]
mat_Sqrt:  [[0.15]]
grads:  [0.12845108]
Stock Position:  0.12845107616599105
Bond Position:  [-5.9363985]


portfolio before change:  [7.12784347]
curr_Stock_Price:  101.71753053167201
curr_Factors:  [101.71753053]
mat_Sqrt:  [[0.15]]
grads:  [-0.04458106]
Stock Position:  -0.04458106036342835
Bond Position:  [11.66251884]


portfolio before change:  [7.17330351]
curr_Stock_Price:  100.76322291091462
curr_Factors:  [100.76322291]
mat_Sqrt:  [[0.15]]
grads:  [-0.15274731]
Stock Position:  -0.15274730580451976
Bond Position:  [22.56461434]


portfolio before change:  [7.24656453]
curr_Stock_Price:  100.32053645323336
curr_Factors:  [100.32053645]
mat_Sqrt:  [[0.15]]
grads:  [0.00494749]
Stock Position:  0.004947494642582321
Bond Position:  [6.75022922]


portfolio before change:  [7.23906346]
curr_Stock_Price:  98.4632643405525
curr_Factors:  [98.46326434]
mat_Sqrt:  [[0.15]]
grads:  [0.0308565]
Stock Position:  0.030856501708842514
Bond Position:  [4.20083157]


portfolio before change:  [7.24889777]
curr_Stock_Price:  98.74793614029248
curr_Factors:  [98.74793614]
mat_Sqrt:  [[0.15]]
grads:  [-0.0169056]
Stock Position:  -0.016905599122507185
Bond Position:  [8.9182908]


portfolio before change:  [7.2185422]
curr_Stock_Price:  100.67542910894461
curr_Factors:  [100.67542911]
mat_Sqrt:  [[0.15]]
grads:  [0.07096626]
Stock Position:  0.07096626120195042
Bond Position:  [0.0739834]


portfolio before change:  [7.2268096]
curr_Stock_Price:  100.79166604303414
curr_Factors:  [100.79166604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03785341]
Stock Position:  -0.03785340936531545
Bond Position:  [11.0421178]


portfolio before change:  [7.27729574]
curr_Stock_Price:  99.53087442343988
curr_Factors:  [99.53087442]
mat_Sqrt:  [[0.15]]
grads:  [0.13188486]
Stock Position:  0.13188485757810772
Bond Position:  [-5.84931946]


portfolio before change:  [7.42630161]
curr_Stock_Price:  100.67178161914208
curr_Factors:  [100.67178162]
mat_Sqrt:  [[0.15]]
grads:  [0.02532864]
Stock Position:  0.02532864426507124
Bond Position:  [4.87642186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.42630161]
Stock Price:  102.78562991262528
PL:  [4.64067169]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.24715683e-02]
 [ 6.67969957e-03]
 [-8.96898172e-03]
 [ 3.76394918e-03]
 [ 8.58427000e-03]
 [ 8.88298421e-03]
 [ 2.09092694e-03]
 [-1.99914523e-03]
 [-7.86061365e-04]
 [ 1.10400117e-02]
 [-9.17212786e-03]
 [-2.04611610e-02]
 [-1.60561365e-03]
 [-2.43341409e-02]
 [ 1.30560719e-02]
 [ 6.88073934e-03]
 [-4.07739573e-02]
 [-1.90276120e-02]
 [ 4.51955180e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.82225116]
curr_Stock_Price:  99.5036078566717
curr_Factors:  [99.50360786]
mat_Sqrt:  [[0.15]]
grads:  [0.08314379]
Stock Position:  0.08314378841852613
Bond Position:  [-14.09535808]


portfolio before change:  [-5.85829305]
curr_Stock_Price:  99.11250701205697
curr_Factors:  [99.11250701]
mat_Sqrt:  [[0.15]]
grads:  [0.04453133]
Stock Position:  0.044531330464696595
Bond Position:  [-10.27190485]


portfolio before change:  [-5.8149015]
curr_Stock_Price:  100.14458592264235
curr_Factors:  [100.14458592]
mat_Sqrt:  [[0.15]]
grads:  [-0.05979321]
Stock Position:  -0.0597932114910258
Bond Position:  [0.17306491]


portfolio before change:  [-5.7718023]
curr_Stock_Price:  99.42450540339806
curr_Factors:  [99.4245054]
mat_Sqrt:  [[0.15]]
grads:  [0.02509299]
Stock Position:  0.02509299453723711
Bond Position:  [-8.26666087]


portfolio before change:  [-5.80186084]
curr_Stock_Price:  98.3089902644307
curr_Factors:  [98.30899026]
mat_Sqrt:  [[0.15]]
grads:  [0.05722847]
Stock Position:  0.0572284666519952
Bond Position:  [-11.42793361]


portfolio before change:  [-5.69239124]
curr_Stock_Price:  100.27177115821588
curr_Factors:  [100.27177116]
mat_Sqrt:  [[0.15]]
grads:  [0.05921989]
Stock Position:  0.05921989470698359
Bond Position:  [-11.63047497]


portfolio before change:  [-5.64933494]
curr_Stock_Price:  101.04793395869942
curr_Factors:  [101.04793396]
mat_Sqrt:  [[0.15]]
grads:  [0.01393951]
Stock Position:  0.01393951290705663
Bond Position:  [-7.05789392]


portfolio before change:  [-5.65551956]
curr_Stock_Price:  100.73085540061405
curr_Factors:  [100.7308554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01332763]
Stock Position:  -0.013327634860931714
Bond Position:  [-4.3130155]


portfolio before change:  [-5.66978123]
curr_Stock_Price:  101.72002459635786
curr_Factors:  [101.7200246]
mat_Sqrt:  [[0.15]]
grads:  [-0.00524041]
Stock Position:  -0.005240409103057022
Bond Position:  [-5.13672669]


portfolio before change:  [-5.66887167]
curr_Stock_Price:  101.30137345070435
curr_Factors:  [101.30137345]
mat_Sqrt:  [[0.15]]
grads:  [0.07360008]
Stock Position:  0.07360007821793531
Bond Position:  [-13.12466068]


portfolio before change:  [-5.57299286]
curr_Stock_Price:  102.64865982350109
curr_Factors:  [102.64865982]
mat_Sqrt:  [[0.15]]
grads:  [-0.06114752]
Stock Position:  -0.061147519082354516
Bond Position:  [0.70371802]


portfolio before change:  [-5.61522616]
curr_Stock_Price:  103.34221610797916
curr_Factors:  [103.34221611]
mat_Sqrt:  [[0.15]]
grads:  [-0.13640774]
Stock Position:  -0.13640773978975954
Bond Position:  [8.48145197]


portfolio before change:  [-5.8043423]
curr_Stock_Price:  104.74416568267769
curr_Factors:  [104.74416568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01070409]
Stock Position:  -0.01070409098746268
Bond Position:  [-4.68315122]


portfolio before change:  [-5.82396625]
curr_Stock_Price:  106.46808691570955
curr_Factors:  [106.46808692]
mat_Sqrt:  [[0.15]]
grads:  [-0.16222761]
Stock Position:  -0.16222760632726768
Bond Position:  [11.44809664]


portfolio before change:  [-5.77698254]
curr_Stock_Price:  106.19611516943719
curr_Factors:  [106.19611517]
mat_Sqrt:  [[0.15]]
grads:  [0.08704048]
Stock Position:  0.08704047927626488
Bond Position:  [-15.0203433]


portfolio before change:  [-5.81578708]
curr_Stock_Price:  105.7934406590466
curr_Factors:  [105.79344066]
mat_Sqrt:  [[0.15]]
grads:  [0.0458716]
Stock Position:  0.04587159556858443
Bond Position:  [-10.668701]


portfolio before change:  [-5.83789999]
curr_Stock_Price:  105.36953114841437
curr_Factors:  [105.36953115]
mat_Sqrt:  [[0.15]]
grads:  [-0.27182638]
Stock Position:  -0.27182638218560745
Bond Position:  [22.80431845]


portfolio before change:  [-5.71819458]
curr_Stock_Price:  104.95013251070749
curr_Factors:  [104.95013251]
mat_Sqrt:  [[0.15]]
grads:  [-0.12685075]
Stock Position:  -0.1268507463991912
Bond Position:  [7.59480806]


portfolio before change:  [-5.78423723]
curr_Stock_Price:  105.48573507855201
curr_Factors:  [105.48573508]
mat_Sqrt:  [[0.15]]
grads:  [0.03013035]
Stock Position:  0.030130345330981013
Bond Position:  [-8.96255886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.78423723]
Stock Price:  105.1480696461045
PL:  [-10.93230688]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.79046148e-02]
 [-7.23796477e-03]
 [-1.05448577e-02]
 [ 3.95556879e-03]
 [ 7.57124988e-03]
 [ 1.03269406e-02]
 [-1.29705686e-02]
 [-6.32601490e-04]
 [-2.37407642e-04]
 [-3.09024992e-02]
 [-9.86180925e-04]
 [-2.63475247e-02]
 [ 2.61307699e-03]
 [-2.67011077e-03]
 [-8.07452505e-04]
 [ 9.39439625e-03]
 [ 5.35820177e-03]
 [ 1.70002920e-02]
 [ 1.90955110e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.90899298]
curr_Stock_Price:  102.0363987555824
curr_Factors:  [102.03639876]
mat_Sqrt:  [[0.15]]
grads:  [-0.25269743]
Stock Position:  -0.25269743192542454
Bond Position:  [58.69332891]


portfolio before change:  [32.91685107]
curr_Stock_Price:  102.06337597517363
curr_Factors:  [102.06337598]
mat_Sqrt:  [[0.15]]
grads:  [-0.0482531]
Stock Position:  -0.048253098451240345
Bond Position:  [37.8417252]


portfolio before change:  [33.000532]
curr_Stock_Price:  100.52525073809554
curr_Factors:  [100.52525074]
mat_Sqrt:  [[0.15]]
grads:  [-0.07029905]
Stock Position:  -0.07029905102392855
Bond Position:  [40.06736173]


portfolio before change:  [33.10876612]
curr_Stock_Price:  99.12813330342136
curr_Factors:  [99.1281333]
mat_Sqrt:  [[0.15]]
grads:  [0.02637046]
Stock Position:  0.026370458606355143
Bond Position:  [30.49471178]


portfolio before change:  [33.13840927]
curr_Stock_Price:  99.96310259232737
curr_Factors:  [99.96310259]
mat_Sqrt:  [[0.15]]
grads:  [0.050475]
Stock Position:  0.05047499918182795
Bond Position:  [28.09277175]


portfolio before change:  [33.17933588]
curr_Stock_Price:  100.63477246245267
curr_Factors:  [100.63477246]
mat_Sqrt:  [[0.15]]
grads:  [0.06884627]
Stock Position:  0.06884627034404915
Bond Position:  [26.25100713]


portfolio before change:  [33.12850569]
curr_Stock_Price:  99.80112154100448
curr_Factors:  [99.80112154]
mat_Sqrt:  [[0.15]]
grads:  [-0.08647046]
Stock Position:  -0.08647045711246605
Bond Position:  [41.75835429]


portfolio before change:  [33.18452395]
curr_Stock_Price:  99.27403562508472
curr_Factors:  [99.27403563]
mat_Sqrt:  [[0.15]]
grads:  [-0.00421734]
Stock Position:  -0.004217343265459115
Bond Position:  [33.60319663]


portfolio before change:  [33.19233238]
curr_Stock_Price:  99.41474446640638
curr_Factors:  [99.41474447]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158272]
Stock Position:  -0.001582717610258772
Bond Position:  [33.34967785]


portfolio before change:  [33.20077055]
curr_Stock_Price:  99.35174764397361
curr_Factors:  [99.35174764]
mat_Sqrt:  [[0.15]]
grads:  [-0.20601666]
Stock Position:  -0.206016661231839
Bond Position:  [53.66888589]


portfolio before change:  [33.55217705]
curr_Stock_Price:  97.71116380497311
curr_Factors:  [97.7111638]
mat_Sqrt:  [[0.15]]
grads:  [-0.00657454]
Stock Position:  -0.006574539502857251
Bond Position:  [34.19458296]


portfolio before change:  [33.5634399]
curr_Stock_Price:  97.29849165116549
curr_Factors:  [97.29849165]
mat_Sqrt:  [[0.15]]
grads:  [-0.17565016]
Stock Position:  -0.175650164415526
Bond Position:  [50.65393595]


portfolio before change:  [33.73949034]
curr_Stock_Price:  96.36831675173434
curr_Factors:  [96.36831675]
mat_Sqrt:  [[0.15]]
grads:  [0.01742051]
Stock Position:  0.017420513259802053
Bond Position:  [32.0607048]


portfolio before change:  [33.73178732]
curr_Stock_Price:  95.46597860459885
curr_Factors:  [95.4659786]
mat_Sqrt:  [[0.15]]
grads:  [-0.01780074]
Stock Position:  -0.01780073848832675
Bond Position:  [35.43115224]


portfolio before change:  [33.74175261]
curr_Stock_Price:  95.40382431533776
curr_Factors:  [95.40382432]
mat_Sqrt:  [[0.15]]
grads:  [-0.00538302]
Stock Position:  -0.005383016696934916
Bond Position:  [34.25531299]


portfolio before change:  [33.74852451]
curr_Stock_Price:  95.7369080216135
curr_Factors:  [95.73690802]
mat_Sqrt:  [[0.15]]
grads:  [0.06262931]
Stock Position:  0.06262930835024759
Bond Position:  [27.75258818]


portfolio before change:  [33.62060532]
curr_Stock_Price:  93.58363167896161
curr_Factors:  [93.58363168]
mat_Sqrt:  [[0.15]]
grads:  [0.03572135]
Stock Position:  0.035721345109208755
Bond Position:  [30.27767212]


portfolio before change:  [33.66885496]
curr_Stock_Price:  94.72242634065525
curr_Factors:  [94.72242634]
mat_Sqrt:  [[0.15]]
grads:  [0.11333528]
Stock Position:  0.11333528017232211
Bond Position:  [22.93346223]


portfolio before change:  [33.66224129]
curr_Stock_Price:  94.61347741885001
curr_Factors:  [94.61347742]
mat_Sqrt:  [[0.15]]
grads:  [0.01273034]
Stock Position:  0.012730340639632354
Bond Position:  [32.45777949]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.66224129]
Stock Price:  94.46815075216692
PL:  [33.66224129]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.84891210e-02]
 [ 6.28379173e-03]
 [ 9.53016117e-04]
 [ 3.54809905e-03]
 [ 6.73470203e-03]
 [ 2.50927940e-03]
 [-1.67838005e-03]
 [ 7.13982266e-04]
 [ 2.10642120e-04]
 [ 2.25375856e-02]
 [-4.92978473e-03]
 [-2.58501663e-02]
 [ 2.16042994e-03]
 [-1.86169030e-03]
 [-3.44074190e-03]
 [ 1.06400049e-02]
 [ 4.96394933e-02]
 [ 1.94680161e-02]
 [ 3.99031373e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.21454044]
curr_Stock_Price:  99.80492448205946
curr_Factors:  [99.80492448]
mat_Sqrt:  [[0.15]]
grads:  [0.12326081]
Stock Position:  0.1232608068181204
Bond Position:  [-13.51657596]


portfolio before change:  [-1.28441255]
curr_Stock_Price:  99.26547850358757
curr_Factors:  [99.2654785]
mat_Sqrt:  [[0.15]]
grads:  [0.04189194]
Stock Position:  0.04189194484085736
Bond Position:  [-5.4428365]


portfolio before change:  [-1.28290363]
curr_Stock_Price:  99.33398334069065
curr_Factors:  [99.33398334]
mat_Sqrt:  [[0.15]]
grads:  [0.00635344]
Stock Position:  0.006353440777941907
Bond Position:  [-1.91401621]


portfolio before change:  [-1.28069513]
curr_Stock_Price:  99.75691432901891
curr_Factors:  [99.75691433]
mat_Sqrt:  [[0.15]]
grads:  [0.02365399]
Stock Position:  0.02365399367402449
Bond Position:  [-3.64034455]


portfolio before change:  [-1.2517977]
curr_Stock_Price:  101.01706621891843
curr_Factors:  [101.01706622]
mat_Sqrt:  [[0.15]]
grads:  [0.04489801]
Stock Position:  0.04489801355851827
Bond Position:  [-5.78726331]


portfolio before change:  [-1.22088689]
curr_Stock_Price:  101.7377621195203
curr_Factors:  [101.73776212]
mat_Sqrt:  [[0.15]]
grads:  [0.01672853]
Stock Position:  0.01672852934966845
Bond Position:  [-2.92281003]


portfolio before change:  [-1.21038113]
curr_Stock_Price:  102.40946194919546
curr_Factors:  [102.40946195]
mat_Sqrt:  [[0.15]]
grads:  [-0.0111892]
Stock Position:  -0.011189200361688759
Bond Position:  [-0.06450114]


portfolio before change:  [-1.21772643]
curr_Stock_Price:  103.06448410444469
curr_Factors:  [103.0644841]
mat_Sqrt:  [[0.15]]
grads:  [0.00475988]
Stock Position:  0.004759881775163585
Bond Position:  [-1.70830119]


portfolio before change:  [-1.21907316]
curr_Stock_Price:  102.87128624006976
curr_Factors:  [102.87128624]
mat_Sqrt:  [[0.15]]
grads:  [0.00140428]
Stock Position:  0.0014042807995498364
Bond Position:  [-1.36353333]


portfolio before change:  [-1.2209211]
curr_Stock_Price:  101.79813020422408
curr_Factors:  [101.7981302]
mat_Sqrt:  [[0.15]]
grads:  [0.15025057]
Stock Position:  0.15025057099910913
Bond Position:  [-16.51614829]


portfolio before change:  [-1.36389411]
curr_Stock_Price:  100.87405078298619
curr_Factors:  [100.87405078]
mat_Sqrt:  [[0.15]]
grads:  [-0.03286523]
Stock Position:  -0.032865231532850384
Bond Position:  [1.95135492]


portfolio before change:  [-1.30222569]
curr_Stock_Price:  99.0124931914173
curr_Factors:  [99.01249319]
mat_Sqrt:  [[0.15]]
grads:  [-0.17233444]
Stock Position:  -0.17233444185281616
Bond Position:  [15.76103706]


portfolio before change:  [-1.30529091]
curr_Stock_Price:  99.05314655040749
curr_Factors:  [99.05314655]
mat_Sqrt:  [[0.15]]
grads:  [0.01440287]
Stock Position:  0.014402866275487645
Bond Position:  [-2.73194014]


portfolio before change:  [-1.29491745]
curr_Stock_Price:  99.82080872116485
curr_Factors:  [99.82080872]
mat_Sqrt:  [[0.15]]
grads:  [-0.01241127]
Stock Position:  -0.0124112686865681
Bond Position:  [-0.05601457]


portfolio before change:  [-1.30205953]
curr_Stock_Price:  100.39513183342864
curr_Factors:  [100.39513183]
mat_Sqrt:  [[0.15]]
grads:  [-0.02293828]
Stock Position:  -0.022938279313854764
Bond Position:  [1.00083204]


portfolio before change:  [-1.30738817]
curr_Stock_Price:  100.63834448277495
curr_Factors:  [100.63834448]
mat_Sqrt:  [[0.15]]
grads:  [0.07093337]
Stock Position:  0.0709333660871858
Bond Position:  [-8.4460047]


portfolio before change:  [-1.46425301]
curr_Stock_Price:  98.45667626082282
curr_Factors:  [98.45667626]
mat_Sqrt:  [[0.15]]
grads:  [0.33092996]
Stock Position:  0.3309299551974617
Bond Position:  [-34.04651647]


portfolio before change:  [-1.22749824]
curr_Stock_Price:  99.19782241418572
curr_Factors:  [99.19782241]
mat_Sqrt:  [[0.15]]
grads:  [0.12978677]
Stock Position:  0.12978677404074232
Bond Position:  [-14.1020636]


portfolio before change:  [-1.36011688]
curr_Stock_Price:  98.20317032706299
curr_Factors:  [98.20317033]
mat_Sqrt:  [[0.15]]
grads:  [0.02660209]
Stock Position:  0.02660209153298974
Bond Position:  [-3.97252661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.36011688]
Stock Price:  97.48250162193685
PL:  [-1.36011688]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.43537577e-02]
 [-7.24742223e-03]
 [ 1.45565728e-02]
 [ 3.55321797e-03]
 [ 7.11457741e-03]
 [-1.49808153e-05]
 [-3.37415972e-03]
 [-2.35080286e-03]
 [-1.18917932e-03]
 [ 7.07612902e-03]
 [-7.02312599e-03]
 [-2.04514663e-02]
 [-1.27446615e-03]
 [-2.14048393e-02]
 [ 9.51078125e-03]
 [ 7.60031856e-03]
 [-4.37376134e-02]
 [-2.49327254e-02]
 [ 4.68721593e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.42696215]
curr_Stock_Price:  101.28554285550054
curr_Factors:  [101.28554286]
mat_Sqrt:  [[0.15]]
grads:  [-0.22902505]
Stock Position:  -0.2290250515167297
Bond Position:  [44.62388882]


portfolio before change:  [21.26220596]
curr_Stock_Price:  102.0536402938724
curr_Factors:  [102.05364029]
mat_Sqrt:  [[0.15]]
grads:  [-0.04831615]
Stock Position:  -0.04831614817327934
Bond Position:  [26.19304477]


portfolio before change:  [21.23961827]
curr_Stock_Price:  102.65668447652932
curr_Factors:  [102.65668448]
mat_Sqrt:  [[0.15]]
grads:  [0.09704382]
Stock Position:  0.09704381846879248
Bond Position:  [11.27742162]


portfolio before change:  [21.18041264]
curr_Stock_Price:  102.01753672406187
curr_Factors:  [102.01753672]
mat_Sqrt:  [[0.15]]
grads:  [0.02368812]
Stock Position:  0.02368811981211964
Bond Position:  [18.76380901]


portfolio before change:  [21.14845683]
curr_Stock_Price:  100.47045936453367
curr_Factors:  [100.47045936]
mat_Sqrt:  [[0.15]]
grads:  [0.04743052]
Stock Position:  0.047430516082297085
Bond Position:  [16.38309109]


portfolio before change:  [21.2212314]
curr_Stock_Price:  101.91843613879873
curr_Factors:  [101.91843614]
mat_Sqrt:  [[0.15]]
grads:  [-9.9872102e-05]
Stock Position:  -9.987210198049434e-05
Bond Position:  [21.2314102]


portfolio before change:  [21.22644758]
curr_Stock_Price:  102.84292258139706
curr_Factors:  [102.84292258]
mat_Sqrt:  [[0.15]]
grads:  [-0.0224944]
Stock Position:  -0.022494398135244897
Bond Position:  [23.53983723]


portfolio before change:  [21.28462369]
curr_Stock_Price:  100.51832545387147
curr_Factors:  [100.51832545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01567202]
Stock Position:  -0.01567201906277401
Bond Position:  [22.8599488]


portfolio before change:  [21.28020377]
curr_Stock_Price:  101.16505893890678
curr_Factors:  [101.16505894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00792786]
Stock Position:  -0.007927862163603467
Bond Position:  [22.08222642]


portfolio before change:  [21.28608046]
curr_Stock_Price:  101.12022472005256
curr_Factors:  [101.12022472]
mat_Sqrt:  [[0.15]]
grads:  [0.04717419]
Stock Position:  0.04717419343710808
Bond Position:  [16.51581542]


portfolio before change:  [21.32687165]
curr_Stock_Price:  101.89738096145575
curr_Factors:  [101.89738096]
mat_Sqrt:  [[0.15]]
grads:  [-0.04682084]
Stock Position:  -0.04682083990341556
Bond Position:  [26.09779261]


portfolio before change:  [21.26535465]
curr_Stock_Price:  103.35062835516236
curr_Factors:  [103.35062836]
mat_Sqrt:  [[0.15]]
grads:  [-0.13634311]
Stock Position:  -0.13634310899774166
Bond Position:  [35.35650063]


portfolio before change:  [21.17956368]
curr_Stock_Price:  104.04469491966854
curr_Factors:  [104.04469492]
mat_Sqrt:  [[0.15]]
grads:  [-0.00849644]
Stock Position:  -0.008496441016664002
Bond Position:  [22.0635733]


portfolio before change:  [21.1807737]
curr_Stock_Price:  104.5515620382237
curr_Factors:  [104.55156204]
mat_Sqrt:  [[0.15]]
grads:  [-0.14269893]
Stock Position:  -0.14269892891581645
Bond Position:  [36.10016962]


portfolio before change:  [21.1050804]
curr_Stock_Price:  105.14525587559436
curr_Factors:  [105.14525588]
mat_Sqrt:  [[0.15]]
grads:  [0.06340521]
Stock Position:  0.06340520834804053
Bond Position:  [14.43832354]


portfolio before change:  [21.09107279]
curr_Stock_Price:  104.86739789785226
curr_Factors:  [104.8673979]
mat_Sqrt:  [[0.15]]
grads:  [0.05066879]
Stock Position:  0.05066879039997005
Bond Position:  [15.77756858]


portfolio before change:  [21.01439162]
curr_Stock_Price:  103.27616092620637
curr_Factors:  [103.27616093]
mat_Sqrt:  [[0.15]]
grads:  [-0.29158409]
Stock Position:  -0.2915840890006285
Bond Position:  [51.12807692]


portfolio before change:  [20.94617837]
curr_Stock_Price:  103.55394310302519
curr_Factors:  [103.5539431]
mat_Sqrt:  [[0.15]]
grads:  [-0.16621817]
Stock Position:  -0.16621816945376156
Bond Position:  [38.15872524]


portfolio before change:  [21.02741517]
curr_Stock_Price:  103.12260683154385
curr_Factors:  [103.12260683]
mat_Sqrt:  [[0.15]]
grads:  [0.03124811]
Stock Position:  0.031248106180181794
Bond Position:  [17.805029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.02741517]
Stock Price:  102.59706038100116
PL:  [18.43035479]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.01050987e-02]
 [ 6.76300022e-03]
 [ 1.07827883e-02]
 [-4.54281856e-03]
 [ 9.20625650e-03]
 [ 4.09202284e-02]
 [-1.07755278e-02]
 [ 2.83618768e-03]
 [-3.01371038e-04]
 [-3.05459624e-02]
 [-1.06678631e-03]
 [-2.63408569e-02]
 [ 2.69773130e-03]
 [-2.57399220e-03]
 [-2.03539037e-03]
 [ 1.05900437e-02]
 [-1.49674899e-02]
 [ 1.94742275e-02]
 [ 3.75219029e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.88392796]
curr_Stock_Price:  100.46530370366082
curr_Factors:  [100.4653037]
mat_Sqrt:  [[0.15]]
grads:  [0.26736732]
Stock Position:  0.26736732471810803
Bond Position:  [-17.97721152]


portfolio before change:  [8.50301646]
curr_Stock_Price:  99.05744044360783
curr_Factors:  [99.05744044]
mat_Sqrt:  [[0.15]]
grads:  [0.04508667]
Stock Position:  0.04508666815106634
Bond Position:  [4.03684652]


portfolio before change:  [8.45972804]
curr_Stock_Price:  98.07493810700996
curr_Factors:  [98.07493811]
mat_Sqrt:  [[0.15]]
grads:  [0.07188526]
Stock Position:  0.0718852555970391
Bond Position:  [1.40958605]


portfolio before change:  [8.30128208]
curr_Stock_Price:  95.86588421166333
curr_Factors:  [95.86588421]
mat_Sqrt:  [[0.15]]
grads:  [-0.03028546]
Stock Position:  -0.030285457076779876
Bond Position:  [11.2046242]


portfolio before change:  [8.31571296]
curr_Stock_Price:  95.4818920734852
curr_Factors:  [95.48189207]
mat_Sqrt:  [[0.15]]
grads:  [0.06137504]
Stock Position:  0.06137504334045354
Bond Position:  [2.4555077]


portfolio before change:  [8.36298726]
curr_Stock_Price:  96.24214147920038
curr_Factors:  [96.24214148]
mat_Sqrt:  [[0.15]]
grads:  [0.27280152]
Stock Position:  0.27280152245843486
Bond Position:  [-17.89201546]


portfolio before change:  [8.68608542]
curr_Stock_Price:  97.44291089803019
curr_Factors:  [97.4429109]
mat_Sqrt:  [[0.15]]
grads:  [-0.07183685]
Stock Position:  -0.07183685167244296
Bond Position:  [15.68607736]


portfolio before change:  [8.63584348]
curr_Stock_Price:  98.19689646417162
curr_Factors:  [98.19689646]
mat_Sqrt:  [[0.15]]
grads:  [0.01890792]
Stock Position:  0.018907917847840322
Bond Position:  [6.77914463]


portfolio before change:  [8.66217519]
curr_Stock_Price:  99.49988042467989
curr_Factors:  [99.49988042]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200914]
Stock Position:  -0.002009140256655446
Bond Position:  [8.86208441]


portfolio before change:  [8.6646388]
curr_Stock_Price:  99.37653770692049
curr_Factors:  [99.37653771]
mat_Sqrt:  [[0.15]]
grads:  [-0.20363975]
Stock Position:  -0.20363974909341273
Bond Position:  [28.90165201]


portfolio before change:  [8.69159529]
curr_Stock_Price:  99.27965009566844
curr_Factors:  [99.2796501]
mat_Sqrt:  [[0.15]]
grads:  [-0.00711191]
Stock Position:  -0.007111908724674338
Bond Position:  [9.3976631]


portfolio before change:  [8.70453565]
curr_Stock_Price:  97.79050686592237
curr_Factors:  [97.79050687]
mat_Sqrt:  [[0.15]]
grads:  [-0.17560571]
Stock Position:  -0.17560571284252893
Bond Position:  [25.87710732]


portfolio before change:  [8.8983143]
curr_Stock_Price:  96.72386408570007
curr_Factors:  [96.72386409]
mat_Sqrt:  [[0.15]]
grads:  [0.01798488]
Stock Position:  0.017984875324012644
Bond Position:  [7.15874766]


portfolio before change:  [8.87862005]
curr_Stock_Price:  95.52929568476588
curr_Factors:  [95.52929568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715995]
Stock Position:  -0.017159948017606137
Bond Position:  [10.51789779]


portfolio before change:  [8.84582725]
curr_Stock_Price:  97.5935560154856
curr_Factors:  [97.59355602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01356927]
Stock Position:  -0.013569269142723873
Bond Position:  [10.17010048]


portfolio before change:  [8.81784726]
curr_Stock_Price:  99.84296485216936
curr_Factors:  [99.84296485]
mat_Sqrt:  [[0.15]]
grads:  [0.07060029]
Stock Position:  0.07060029158354865
Bond Position:  [1.76890483]


portfolio before change:  [8.90597758]
curr_Stock_Price:  101.08499989720835
curr_Factors:  [101.0849999]
mat_Sqrt:  [[0.15]]
grads:  [-0.09978327]
Stock Position:  -0.09978326600612034
Bond Position:  [18.99256901]


portfolio before change:  [9.09837913]
curr_Stock_Price:  99.20439580463572
curr_Factors:  [99.2043958]
mat_Sqrt:  [[0.15]]
grads:  [0.12982818]
Stock Position:  0.12982818355608963
Bond Position:  [-3.78114738]


portfolio before change:  [9.23102836]
curr_Stock_Price:  100.23340682266894
curr_Factors:  [100.23340682]
mat_Sqrt:  [[0.15]]
grads:  [0.0250146]
Stock Position:  0.025014601935719184
Bond Position:  [6.72372958]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.23102836]
Stock Price:  100.65464121101076
PL:  [8.57638715]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.94488159e-02]
 [ 7.93818350e-03]
 [-1.07112599e-02]
 [ 3.33062063e-03]
 [ 8.10792289e-03]
 [ 8.06567884e-03]
 [-1.48997723e-02]
 [ 1.64203385e-03]
 [ 3.26208482e-03]
 [-3.72465582e-02]
 [-9.05280149e-04]
 [-2.63500627e-02]
 [ 2.79963355e-03]
 [-1.90357115e-03]
 [ 3.13364323e-04]
 [ 2.17857573e-03]
 [-1.66520383e-02]
 [ 1.29652491e-02]
 [ 6.02360530e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.16401688]
curr_Stock_Price:  99.02350044471581
curr_Factors:  [99.02350044]
mat_Sqrt:  [[0.15]]
grads:  [0.19632544]
Stock Position:  0.19632543927257626
Bond Position:  [-32.6048491]


portfolio before change:  [-13.26296349]
curr_Stock_Price:  98.5610316912224
curr_Factors:  [98.56103169]
mat_Sqrt:  [[0.15]]
grads:  [0.05292122]
Stock Position:  0.05292122332842491
Bond Position:  [-18.47893386]


portfolio before change:  [-13.1725153]
curr_Stock_Price:  100.35744722395309
curr_Factors:  [100.35744722]
mat_Sqrt:  [[0.15]]
grads:  [-0.0714084]
Stock Position:  -0.07140839956651146
Bond Position:  [-6.0061506]


portfolio before change:  [-13.04267776]
curr_Stock_Price:  98.51817821147351
curr_Factors:  [98.51817821]
mat_Sqrt:  [[0.15]]
grads:  [0.02220414]
Stock Position:  0.022204137510550802
Bond Position:  [-15.23018894]


portfolio before change:  [-13.02733402]
curr_Stock_Price:  99.38070951109297
curr_Factors:  [99.38070951]
mat_Sqrt:  [[0.15]]
grads:  [0.05405282]
Stock Position:  0.05405281925264855
Bond Position:  [-18.39914155]


portfolio before change:  [-12.99293145]
curr_Stock_Price:  100.10228018247196
curr_Factors:  [100.10228018]
mat_Sqrt:  [[0.15]]
grads:  [0.05377119]
Stock Position:  0.05377119224972588
Bond Position:  [-18.37555041]


portfolio before change:  [-13.02340958]
curr_Stock_Price:  99.62091342998694
curr_Factors:  [99.62091343]
mat_Sqrt:  [[0.15]]
grads:  [-0.09933182]
Stock Position:  -0.09933181513655676
Bond Position:  [-3.12788342]


portfolio before change:  [-12.91844704]
curr_Stock_Price:  98.55635411388477
curr_Factors:  [98.55635411]
mat_Sqrt:  [[0.15]]
grads:  [0.01094689]
Stock Position:  0.010946892325441654
Bond Position:  [-13.99733284]


portfolio before change:  [-12.9359841]
curr_Stock_Price:  97.27404581038371
curr_Factors:  [97.27404581]
mat_Sqrt:  [[0.15]]
grads:  [0.02174723]
Stock Position:  0.021747232128334397
Bond Position:  [-15.05142536]


portfolio before change:  [-12.94278037]
curr_Stock_Price:  97.13458250713617
curr_Factors:  [97.13458251]
mat_Sqrt:  [[0.15]]
grads:  [-0.24831039]
Stock Position:  -0.24831038814068088
Bond Position:  [11.17674551]


portfolio before change:  [-12.69225823]
curr_Stock_Price:  96.1369295143185
curr_Factors:  [96.13692951]
mat_Sqrt:  [[0.15]]
grads:  [-0.0060352]
Stock Position:  -0.006035200994930756
Bond Position:  [-12.11205254]


portfolio before change:  [-12.7011666]
curr_Stock_Price:  97.11121031970518
curr_Factors:  [97.11121032]
mat_Sqrt:  [[0.15]]
grads:  [-0.17566708]
Stock Position:  -0.17566708452191035
Bond Position:  [4.35807659]


portfolio before change:  [-12.78007241]
curr_Stock_Price:  97.56659137957978
curr_Factors:  [97.56659138]
mat_Sqrt:  [[0.15]]
grads:  [0.01866422]
Stock Position:  0.018664223668299916
Bond Position:  [-14.6010771]


portfolio before change:  [-12.81350495]
curr_Stock_Price:  95.97092838430139
curr_Factors:  [95.97092838]
mat_Sqrt:  [[0.15]]
grads:  [-0.01269047]
Stock Position:  -0.01269047430412532
Bond Position:  [-11.59558835]


portfolio before change:  [-12.78697311]
curr_Stock_Price:  93.65177976977455
curr_Factors:  [93.65177977]
mat_Sqrt:  [[0.15]]
grads:  [0.0020891]
Stock Position:  0.0020890954858810273
Bond Position:  [-12.98262062]


portfolio before change:  [-12.79393611]
curr_Stock_Price:  91.87257168474217
curr_Factors:  [91.87257168]
mat_Sqrt:  [[0.15]]
grads:  [0.01452384]
Stock Position:  0.014523838210034138
Bond Position:  [-14.12827848]


portfolio before change:  [-12.79076923]
curr_Stock_Price:  92.33384004727714
curr_Factors:  [92.33384005]
mat_Sqrt:  [[0.15]]
grads:  [-0.11101359]
Stock Position:  -0.11101358863192107
Bond Position:  [-2.5404583]


portfolio before change:  [-12.81784168]
curr_Stock_Price:  92.57198437643468
curr_Factors:  [92.57198438]
mat_Sqrt:  [[0.15]]
grads:  [0.08643499]
Stock Position:  0.08643499407411315
Bond Position:  [-20.8193006]


portfolio before change:  [-12.77883504]
curr_Stock_Price:  93.08349152088299
curr_Factors:  [93.08349152]
mat_Sqrt:  [[0.15]]
grads:  [0.00401574]
Stock Position:  0.004015736865492399
Bond Position:  [-13.15263385]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.77883504]
Stock Price:  92.44036683594173
PL:  [-12.77883504]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-1.30668120e-02]
 [-6.51285473e-03]
 [ 1.50685308e-02]
 [ 2.50641851e-03]
 [ 7.74471856e-03]
 [ 3.20288753e-03]
 [-9.34753298e-03]
 [-4.51644205e-04]
 [-2.36443511e-04]
 [ 2.04832190e-02]
 [-1.12331859e-02]
 [-1.90130568e-02]
 [-1.65677251e-03]
 [-2.28854677e-02]
 [ 2.53198800e-03]
 [ 8.82994307e-03]
 [-4.60738069e-02]
 [-2.62520317e-02]
 [ 4.60177352e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.84461572]
curr_Stock_Price:  101.0512789004736
curr_Factors:  [101.0512789]
mat_Sqrt:  [[0.15]]
grads:  [-0.08711208]
Stock Position:  -0.08711208027307726
Bond Position:  [26.64740284]


portfolio before change:  [17.72433981]
curr_Stock_Price:  102.50846590927449
curr_Factors:  [102.50846591]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341903]
Stock Position:  -0.04341903152053969
Bond Position:  [22.17515813]


portfolio before change:  [17.72207684]
curr_Stock_Price:  102.68828235500634
curr_Factors:  [102.68828236]
mat_Sqrt:  [[0.15]]
grads:  [0.10045687]
Stock Position:  0.10045687173729996
Bond Position:  [7.40633323]


portfolio before change:  [17.58452863]
curr_Stock_Price:  101.30062195124968
curr_Factors:  [101.30062195]
mat_Sqrt:  [[0.15]]
grads:  [0.01670946]
Stock Position:  0.016709456738454944
Bond Position:  [15.89185027]


portfolio before change:  [17.56325877]
curr_Stock_Price:  99.78990126629402
curr_Factors:  [99.78990127]
mat_Sqrt:  [[0.15]]
grads:  [0.05163146]
Stock Position:  0.05163145708668715
Bond Position:  [12.41096076]


portfolio before change:  [17.56530084]
curr_Stock_Price:  99.76935069977185
curr_Factors:  [99.7693507]
mat_Sqrt:  [[0.15]]
grads:  [0.02135258]
Stock Position:  0.02135258351980128
Bond Position:  [15.43496745]


portfolio before change:  [17.57590712]
curr_Stock_Price:  100.08533383277039
curr_Factors:  [100.08533383]
mat_Sqrt:  [[0.15]]
grads:  [-0.06231689]
Stock Position:  -0.0623168865511399
Bond Position:  [23.81291352]


portfolio before change:  [17.63749284]
curr_Stock_Price:  99.1926104689015
curr_Factors:  [99.19261047]
mat_Sqrt:  [[0.15]]
grads:  [-0.00301096]
Stock Position:  -0.003010961369810488
Bond Position:  [17.93615795]


portfolio before change:  [17.64131246]
curr_Stock_Price:  99.41346119851703
curr_Factors:  [99.4134612]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157629]
Stock Position:  -0.0015762900736395406
Bond Position:  [17.79801691]


portfolio before change:  [17.64214212]
curr_Stock_Price:  101.71024626455755
curr_Factors:  [101.71024626]
mat_Sqrt:  [[0.15]]
grads:  [0.13655479]
Stock Position:  0.13655479330726034
Bond Position:  [3.75312047]


portfolio before change:  [17.8868375]
curr_Stock_Price:  103.49529510225764
curr_Factors:  [103.4952951]
mat_Sqrt:  [[0.15]]
grads:  [-0.07488791]
Stock Position:  -0.07488790597579702
Bond Position:  [25.63738342]


portfolio before change:  [17.7756883]
curr_Stock_Price:  105.06509922086349
curr_Factors:  [105.06509922]
mat_Sqrt:  [[0.15]]
grads:  [-0.12675371]
Stock Position:  -0.12675371214784475
Bond Position:  [31.09307964]


portfolio before change:  [17.81153325]
curr_Stock_Price:  104.84364055184403
curr_Factors:  [104.84364055]
mat_Sqrt:  [[0.15]]
grads:  [-0.01104515]
Stock Position:  -0.011045150055245251
Bond Position:  [18.96954699]


portfolio before change:  [17.80937507]
curr_Stock_Price:  105.46845419979904
curr_Factors:  [105.4684542]
mat_Sqrt:  [[0.15]]
grads:  [-0.15256978]
Stock Position:  -0.15256978469273774
Bond Position:  [33.90067442]


portfolio before change:  [18.16829338]
curr_Stock_Price:  103.17152440495333
curr_Factors:  [103.1715244]
mat_Sqrt:  [[0.15]]
grads:  [0.01687992]
Stock Position:  0.016879920030743064
Bond Position:  [16.4267663]


portfolio before change:  [18.15969009]
curr_Stock_Price:  102.41852926221584
curr_Factors:  [102.41852926]
mat_Sqrt:  [[0.15]]
grads:  [0.05886629]
Stock Position:  0.0588662871147535
Bond Position:  [12.13069154]


portfolio before change:  [18.18501957]
curr_Stock_Price:  102.79729325168367
curr_Factors:  [102.79729325]
mat_Sqrt:  [[0.15]]
grads:  [-0.30715871]
Stock Position:  -0.3071587123936028
Bond Position:  [49.7601038]


portfolio before change:  [18.13664407]
curr_Stock_Price:  102.99529212440953
curr_Factors:  [102.99529212]
mat_Sqrt:  [[0.15]]
grads:  [-0.17501354]
Stock Position:  -0.17501354447033465
Bond Position:  [36.16221521]


portfolio before change:  [17.96718584]
curr_Stock_Price:  104.01521272182895
curr_Factors:  [104.01521272]
mat_Sqrt:  [[0.15]]
grads:  [0.03067849]
Stock Position:  0.03067849014469385
Bond Position:  [14.77615616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.96718584]
Stock Price:  104.4289434997447
PL:  [13.53824234]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 3.35194848e-02]
 [ 2.10312530e-03]
 [-1.06805989e-02]
 [ 2.32375106e-03]
 [ 6.23099973e-03]
 [-6.97769561e-03]
 [ 2.41178196e-03]
 [-2.77160222e-04]
 [ 1.04444750e-04]
 [ 4.81128425e-02]
 [-1.13035654e-02]
 [-2.04361162e-02]
 [-1.04135015e-03]
 [-2.08333021e-02]
 [ 1.32237776e-02]
 [ 5.77638970e-03]
 [-7.83927232e-03]
 [-2.23082152e-03]
 [ 5.22334765e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.60713628]
curr_Stock_Price:  98.99452309569277
curr_Factors:  [98.9945231]
mat_Sqrt:  [[0.15]]
grads:  [0.22346323]
Stock Position:  0.22346323184675623
Bond Position:  [-35.72877234]


portfolio before change:  [-13.46542489]
curr_Stock_Price:  99.66865948084094
curr_Factors:  [99.66865948]
mat_Sqrt:  [[0.15]]
grads:  [0.01402084]
Stock Position:  0.014020835347986092
Bond Position:  [-14.86286276]


portfolio before change:  [-13.45974386]
curr_Stock_Price:  100.33889124921286
curr_Factors:  [100.33889125]
mat_Sqrt:  [[0.15]]
grads:  [-0.07120399]
Stock Position:  -0.07120399238853817
Bond Position:  [-6.31521421]


portfolio before change:  [-13.51951048]
curr_Stock_Price:  101.15608724311691
curr_Factors:  [101.15608724]
mat_Sqrt:  [[0.15]]
grads:  [0.01549167]
Stock Position:  0.015491673713929226
Bond Position:  [-15.08658758]


portfolio before change:  [-13.51531751]
curr_Stock_Price:  101.67024014175423
curr_Factors:  [101.67024014]
mat_Sqrt:  [[0.15]]
grads:  [0.04154]
Stock Position:  0.04153999819913822
Bond Position:  [-17.7386991]


portfolio before change:  [-13.48874095]
curr_Stock_Price:  102.41679271009605
curr_Factors:  [102.41679271]
mat_Sqrt:  [[0.15]]
grads:  [-0.04651797]
Stock Position:  -0.04651797073814658
Bond Position:  [-8.72451958]


portfolio before change:  [-13.42965251]
curr_Stock_Price:  101.09967074902094
curr_Factors:  [101.09967075]
mat_Sqrt:  [[0.15]]
grads:  [0.01607855]
Stock Position:  0.016078546372460836
Bond Position:  [-15.05518825]


portfolio before change:  [-13.4228226]
curr_Stock_Price:  101.75857236502377
curr_Factors:  [101.75857237]
mat_Sqrt:  [[0.15]]
grads:  [-0.00184773]
Stock Position:  -0.001847734811671159
Bond Position:  [-13.23479974]


portfolio before change:  [-13.42793571]
curr_Stock_Price:  102.73490234278765
curr_Factors:  [102.73490234]
mat_Sqrt:  [[0.15]]
grads:  [0.0006963]
Stock Position:  0.0006962983330485468
Bond Position:  [-13.49946985]


portfolio before change:  [-13.43074776]
curr_Stock_Price:  103.54380340547003
curr_Factors:  [103.54380341]
mat_Sqrt:  [[0.15]]
grads:  [0.32075228]
Stock Position:  0.3207522830003338
Bond Position:  [-46.64265909]


portfolio before change:  [-13.44030009]
curr_Stock_Price:  103.5503810406856
curr_Factors:  [103.55038104]
mat_Sqrt:  [[0.15]]
grads:  [-0.0753571]
Stock Position:  -0.07535710259616282
Bond Position:  [-5.63704341]


portfolio before change:  [-13.42766048]
curr_Stock_Price:  103.36394803380118
curr_Factors:  [103.36394803]
mat_Sqrt:  [[0.15]]
grads:  [-0.13624077]
Stock Position:  -0.136240774703337
Bond Position:  [0.65472388]


portfolio before change:  [-13.45401378]
curr_Stock_Price:  103.55858140121771
curr_Factors:  [103.5585814]
mat_Sqrt:  [[0.15]]
grads:  [-0.00694233]
Stock Position:  -0.006942334333226427
Bond Position:  [-12.73507548]


portfolio before change:  [-13.46158158]
curr_Stock_Price:  104.19001714939918
curr_Factors:  [104.19001715]
mat_Sqrt:  [[0.15]]
grads:  [-0.13888868]
Stock Position:  -0.13888868060871085
Bond Position:  [1.00923243]


portfolio before change:  [-13.74723047]
curr_Stock_Price:  106.24850904800739
curr_Factors:  [106.24850905]
mat_Sqrt:  [[0.15]]
grads:  [0.08815852]
Stock Position:  0.08815851713859015
Bond Position:  [-23.11394147]


portfolio before change:  [-13.72594125]
curr_Stock_Price:  106.55555171864778
curr_Factors:  [106.55555172]
mat_Sqrt:  [[0.15]]
grads:  [0.03850926]
Stock Position:  0.03850926466951811
Bond Position:  [-17.82931719]


portfolio before change:  [-13.6340349]
curr_Stock_Price:  109.05791660548178
curr_Factors:  [109.05791661]
mat_Sqrt:  [[0.15]]
grads:  [-0.05226182]
Stock Position:  -0.05226181544266397
Bond Position:  [-7.93447019]


portfolio before change:  [-13.65984773]
curr_Stock_Price:  109.51387018088118
curr_Factors:  [109.51387018]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487214]
Stock Position:  -0.014872143485470737
Bond Position:  [-12.03114174]


portfolio before change:  [-13.66902595]
curr_Stock_Price:  109.92874341656476
curr_Factors:  [109.92874342]
mat_Sqrt:  [[0.15]]
grads:  [0.03482232]
Stock Position:  0.03482231765377656
Bond Position:  [-17.49699957]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.66902595]
Stock Price:  109.60093300300755
PL:  [-23.26995895]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 9.92267461e-03]
 [ 6.29220474e-03]
 [ 5.40943857e-03]
 [ 2.99602096e-03]
 [ 6.23657785e-03]
 [ 1.05277483e-02]
 [-9.52324695e-03]
 [-2.10726827e-03]
 [-1.19807574e-03]
 [ 2.84163111e-02]
 [-1.05904886e-02]
 [-2.12413569e-02]
 [-3.45865758e-04]
 [-1.68403860e-02]
 [-2.33788627e-03]
 [ 1.05677553e-02]
 [-3.59206556e-02]
 [-2.69900922e-02]
 [ 4.57434205e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.86118977]
curr_Stock_Price:  99.566455503155
curr_Factors:  [99.5664555]
mat_Sqrt:  [[0.15]]
grads:  [0.06615116]
Stock Position:  0.06615116409647441
Bond Position:  [-11.44762671]


portfolio before change:  [-4.88457498]
curr_Stock_Price:  99.25621239109576
curr_Factors:  [99.25621239]
mat_Sqrt:  [[0.15]]
grads:  [0.04194803]
Stock Position:  0.04194803158447797
Bond Position:  [-9.04817771]


portfolio before change:  [-4.90322983]
curr_Stock_Price:  98.86543064645639
curr_Factors:  [98.86543065]
mat_Sqrt:  [[0.15]]
grads:  [0.03606292]
Stock Position:  0.036062923797401385
Bond Position:  [-8.46860633]


portfolio before change:  [-4.85812115]
curr_Stock_Price:  100.17497787335405
curr_Factors:  [100.17497787]
mat_Sqrt:  [[0.15]]
grads:  [0.01997347]
Stock Position:  0.019973473084167435
Bond Position:  [-6.85896337]


portfolio before change:  [-4.83012654]
curr_Stock_Price:  101.66242879227237
curr_Factors:  [101.66242879]
mat_Sqrt:  [[0.15]]
grads:  [0.04157719]
Stock Position:  0.04157718563400984
Bond Position:  [-9.05696422]


portfolio before change:  [-4.87312158]
curr_Stock_Price:  100.68279254314233
curr_Factors:  [100.68279254]
mat_Sqrt:  [[0.15]]
grads:  [0.07018499]
Stock Position:  0.0701849883844351
Bond Position:  [-11.93954221]


portfolio before change:  [-4.91895835]
curr_Stock_Price:  100.07224164546875
curr_Factors:  [100.07224165]
mat_Sqrt:  [[0.15]]
grads:  [-0.06348831]
Stock Position:  -0.06348831302517481
Bond Position:  [1.43445945]


portfolio before change:  [-4.95744404]
curr_Stock_Price:  100.68407623292315
curr_Factors:  [100.68407623]
mat_Sqrt:  [[0.15]]
grads:  [-0.01404846]
Stock Position:  -0.014048455137259106
Bond Position:  [-3.54298831]


portfolio before change:  [-4.95699763]
curr_Stock_Price:  100.58924243600208
curr_Factors:  [100.58924244]
mat_Sqrt:  [[0.15]]
grads:  [-0.00798717]
Stock Position:  -0.007987171602449938
Bond Position:  [-4.15357409]


portfolio before change:  [-4.97019963]
curr_Stock_Price:  102.11211932214246
curr_Factors:  [102.11211932]
mat_Sqrt:  [[0.15]]
grads:  [0.18944207]
Stock Position:  0.1894420738192188
Bond Position:  [-24.31453128]


portfolio before change:  [-4.77673067]
curr_Stock_Price:  103.16546689065574
curr_Factors:  [103.16546689]
mat_Sqrt:  [[0.15]]
grads:  [-0.07060326]
Stock Position:  -0.07060325706794046
Bond Position:  [2.50708731]


portfolio before change:  [-4.73640143]
curr_Stock_Price:  102.6031360474044
curr_Factors:  [102.60313605]
mat_Sqrt:  [[0.15]]
grads:  [-0.14160905]
Stock Position:  -0.14160904567406277
Bond Position:  [9.79313074]


portfolio before change:  [-4.66257776]
curr_Stock_Price:  102.0991069318793
curr_Factors:  [102.09910693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230577]
Stock Position:  -0.002305771717880406
Bond Position:  [-4.42716053]


portfolio before change:  [-4.66314736]
curr_Stock_Price:  101.86607058632822
curr_Factors:  [101.86607059]
mat_Sqrt:  [[0.15]]
grads:  [-0.11226924]
Stock Position:  -0.11226923974697343
Bond Position:  [6.77327894]


portfolio before change:  [-4.59607782]
curr_Stock_Price:  101.2837559927994
curr_Factors:  [101.28375599]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558591]
Stock Position:  -0.015585908465764376
Bond Position:  [-3.01747847]


portfolio before change:  [-4.57533274]
curr_Stock_Price:  99.90433414241095
curr_Factors:  [99.90433414]
mat_Sqrt:  [[0.15]]
grads:  [0.0704517]
Stock Position:  0.07045170180660766
Bond Position:  [-11.61376309]


portfolio before change:  [-4.4484431]
curr_Stock_Price:  101.74663799280415
curr_Factors:  [101.74663799]
mat_Sqrt:  [[0.15]]
grads:  [-0.23947104]
Stock Position:  -0.2394710375512636
Bond Position:  [19.91692987]


portfolio before change:  [-4.62019692]
curr_Stock_Price:  102.48465488769335
curr_Factors:  [102.48465489]
mat_Sqrt:  [[0.15]]
grads:  [-0.17993395]
Stock Position:  -0.17993394829048373
Bond Position:  [13.82027168]


portfolio before change:  [-4.60385222]
curr_Stock_Price:  102.41302196855004
curr_Factors:  [102.41302197]
mat_Sqrt:  [[0.15]]
grads:  [0.03049561]
Stock Position:  0.03049561366972424
Bond Position:  [-7.72700017]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.60385222]
Stock Price:  103.54629367534584
PL:  [-8.1501459]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.08674774e-02]
 [ 8.61555898e-03]
 [ 6.12000997e-03]
 [ 3.94090347e-03]
 [ 7.01340097e-03]
 [ 9.72851062e-03]
 [ 9.12079539e-04]
 [-1.71512785e-03]
 [-7.84032927e-04]
 [-3.77978102e-02]
 [-7.53765085e-03]
 [-2.20590499e-02]
 [-2.95913828e-04]
 [-1.35077226e-02]
 [-2.31422855e-03]
 [ 9.12582697e-03]
 [ 3.88932449e-02]
 [ 1.94126128e-02]
 [ 3.81749252e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.66693181]
curr_Stock_Price:  99.84073479961907
curr_Factors:  [99.8407348]
mat_Sqrt:  [[0.15]]
grads:  [0.13911652]
Stock Position:  0.1391165161347167
Bond Position:  [-14.55642701]


portfolio before change:  [-0.88552966]
curr_Stock_Price:  98.29556756170646
curr_Factors:  [98.29556756]
mat_Sqrt:  [[0.15]]
grads:  [0.05743706]
Stock Position:  0.057437059865834174
Bond Position:  [-6.53133805]


portfolio before change:  [-0.86052784]
curr_Stock_Price:  98.75928999092606
curr_Factors:  [98.75928999]
mat_Sqrt:  [[0.15]]
grads:  [0.04080007]
Stock Position:  0.04080006647949916
Bond Position:  [-4.88991344]


portfolio before change:  [-0.8512488]
curr_Stock_Price:  99.01668354376886
curr_Factors:  [99.01668354]
mat_Sqrt:  [[0.15]]
grads:  [0.02627269]
Stock Position:  0.02627268981365771
Bond Position:  [-3.45268341]


portfolio before change:  [-0.8106769]
curr_Stock_Price:  100.59380329425107
curr_Factors:  [100.59380329]
mat_Sqrt:  [[0.15]]
grads:  [0.04675601]
Stock Position:  0.046756006495875586
Bond Position:  [-5.51404142]


portfolio before change:  [-0.81593093]
curr_Stock_Price:  100.5109188636599
curr_Factors:  [100.51091886]
mat_Sqrt:  [[0.15]]
grads:  [0.06485674]
Stock Position:  0.06485673743697243
Bond Position:  [-7.3347412]


portfolio before change:  [-0.7952641]
curr_Stock_Price:  100.85784878984083
curr_Factors:  [100.85784879]
mat_Sqrt:  [[0.15]]
grads:  [0.00608053]
Stock Position:  0.006080530257789226
Bond Position:  [-1.4085333]


portfolio before change:  [-0.79564129]
curr_Stock_Price:  100.8537348198108
curr_Factors:  [100.85373482]
mat_Sqrt:  [[0.15]]
grads:  [-0.01143419]
Stock Position:  -0.011434185676764906
Bond Position:  [0.35753904]


portfolio before change:  [-0.78635722]
curr_Stock_Price:  100.04959554704723
curr_Factors:  [100.04959555]
mat_Sqrt:  [[0.15]]
grads:  [-0.00522689]
Stock Position:  -0.005226886176825464
Bond Position:  [-0.26340937]


portfolio before change:  [-0.77870533]
curr_Stock_Price:  98.57304846562899
curr_Factors:  [98.57304847]
mat_Sqrt:  [[0.15]]
grads:  [-0.2519854]
Stock Position:  -0.2519854016053823
Bond Position:  [24.06026387]


portfolio before change:  [-1.66765428]
curr_Stock_Price:  102.12470170524975
curr_Factors:  [102.12470171]
mat_Sqrt:  [[0.15]]
grads:  [-0.05025101]
Stock Position:  -0.05025100564980532
Bond Position:  [3.46421468]


portfolio before change:  [-1.64742882]
curr_Stock_Price:  101.73944970092776
curr_Factors:  [101.7394497]
mat_Sqrt:  [[0.15]]
grads:  [-0.14706033]
Stock Position:  -0.14706033235156815
Bond Position:  [13.31440846]


portfolio before change:  [-1.67915295]
curr_Stock_Price:  101.97780863598763
curr_Factors:  [101.97780864]
mat_Sqrt:  [[0.15]]
grads:  [-0.00197276]
Stock Position:  -0.0019727588558350537
Bond Position:  [-1.47797532]


portfolio before change:  [-1.67853449]
curr_Stock_Price:  101.47698819250667
curr_Factors:  [101.47698819]
mat_Sqrt:  [[0.15]]
grads:  [-0.09005148]
Stock Position:  -0.09005148413071468
Bond Position:  [7.4596189]


portfolio before change:  [-1.65994793]
curr_Stock_Price:  101.2913008619783
curr_Factors:  [101.29130086]
mat_Sqrt:  [[0.15]]
grads:  [-0.01542819]
Stock Position:  -0.015428190354115572
Bond Position:  [-0.09720646]


portfolio before change:  [-1.6707628]
curr_Stock_Price:  101.99070647356234
curr_Factors:  [101.99070647]
mat_Sqrt:  [[0.15]]
grads:  [0.06083885]
Stock Position:  0.06083884644252402
Bond Position:  [-7.87575973]


portfolio before change:  [-1.81099869]
curr_Stock_Price:  99.71803504002362
curr_Factors:  [99.71803504]
mat_Sqrt:  [[0.15]]
grads:  [0.2592883]
Stock Position:  0.259288299136973
Bond Position:  [-27.66671839]


portfolio before change:  [-2.02098261]
curr_Stock_Price:  98.93486674409642
curr_Factors:  [98.93486674]
mat_Sqrt:  [[0.15]]
grads:  [0.12941742]
Stock Position:  0.1294174188558328
Bond Position:  [-14.8248777]


portfolio before change:  [-1.94379549]
curr_Stock_Price:  99.55992795885159
curr_Factors:  [99.55992796]
mat_Sqrt:  [[0.15]]
grads:  [0.02544995]
Stock Position:  0.025449950123079473
Bond Position:  [-4.47759069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.94379549]
Stock Price:  98.9004422963345
PL:  [-1.94379549]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.41191920e-02]
 [ 7.28200600e-03]
 [ 2.13123121e-02]
 [ 5.93735092e-04]
 [ 8.16800630e-03]
 [ 2.84374547e-03]
 [-1.28370388e-02]
 [ 4.53162493e-03]
 [ 9.85699973e-05]
 [-3.80988380e-02]
 [-1.02428675e-03]
 [-2.63467590e-02]
 [ 2.79323512e-03]
 [ 3.22942816e-03]
 [-2.57517623e-03]
 [ 1.06221409e-02]
 [ 2.97559800e-02]
 [ 1.99309759e-02]
 [ 4.21397929e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.22070203]
curr_Stock_Price:  99.73912755295433
curr_Factors:  [99.73912755]
mat_Sqrt:  [[0.15]]
grads:  [0.09412795]
Stock Position:  0.09412794643287453
Bond Position:  [-11.60894129]


portfolio before change:  [-2.31029075]
curr_Stock_Price:  98.81818831192139
curr_Factors:  [98.81818831]
mat_Sqrt:  [[0.15]]
grads:  [0.04854671]
Stock Position:  0.04854670664435961
Bond Position:  [-7.10758835]


portfolio before change:  [-2.38174777]
curr_Stock_Price:  97.38287169382106
curr_Factors:  [97.38287169]
mat_Sqrt:  [[0.15]]
grads:  [0.14208208]
Stock Position:  0.14208208097154945
Bond Position:  [-16.21810883]


portfolio before change:  [-2.37888664]
curr_Stock_Price:  97.43154892022234
curr_Factors:  [97.43154892]
mat_Sqrt:  [[0.15]]
grads:  [0.00395823]
Stock Position:  0.003958233949333322
Bond Position:  [-2.7645435]


portfolio before change:  [-2.37211654]
curr_Stock_Price:  99.31656240506956
curr_Factors:  [99.31656241]
mat_Sqrt:  [[0.15]]
grads:  [0.05445338]
Stock Position:  0.05445337531775028
Bond Position:  [-7.78023858]


portfolio before change:  [-2.3511771]
curr_Stock_Price:  99.73682536721779
curr_Factors:  [99.73682537]
mat_Sqrt:  [[0.15]]
grads:  [0.0189583]
Stock Position:  0.01895830315721677
Bond Position:  [-4.24201807]


portfolio before change:  [-2.38460085]
curr_Stock_Price:  98.02975769603489
curr_Factors:  [98.0297577]
mat_Sqrt:  [[0.15]]
grads:  [-0.08558026]
Stock Position:  -0.0855802589578339
Bond Position:  [6.0048112]


portfolio before change:  [-2.35190935]
curr_Stock_Price:  97.66530328622171
curr_Factors:  [97.66530329]
mat_Sqrt:  [[0.15]]
grads:  [0.03021083]
Stock Position:  0.03021083286893093
Bond Position:  [-5.30245951]


portfolio before change:  [-2.31132173]
curr_Stock_Price:  99.05266653302718
curr_Factors:  [99.05266653]
mat_Sqrt:  [[0.15]]
grads:  [0.00065713]
Stock Position:  0.0006571333156314581
Bond Position:  [-2.37641254]


portfolio before change:  [-2.31213959]
curr_Stock_Price:  98.71227556859853
curr_Factors:  [98.71227557]
mat_Sqrt:  [[0.15]]
grads:  [-0.25399225]
Stock Position:  -0.25399225334317954
Bond Position:  [22.76001371]


portfolio before change:  [-2.24050815]
curr_Stock_Price:  98.45265849530281
curr_Factors:  [98.4526585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00682858]
Stock Position:  -0.006828578334492387
Bond Position:  [-1.56821646]


portfolio before change:  [-2.23340474]
curr_Stock_Price:  97.35498964915804
curr_Factors:  [97.35498965]
mat_Sqrt:  [[0.15]]
grads:  [-0.17564506]
Stock Position:  -0.17564506005125718
Bond Position:  [14.86651827]


portfolio before change:  [-2.30731081]
curr_Stock_Price:  97.79692158713222
curr_Factors:  [97.79692159]
mat_Sqrt:  [[0.15]]
grads:  [0.01862157]
Stock Position:  0.018621567490653877
Bond Position:  [-4.12844278]


portfolio before change:  [-2.30163475]
curr_Stock_Price:  98.15716482090993
curr_Factors:  [98.15716482]
mat_Sqrt:  [[0.15]]
grads:  [0.02152952]
Stock Position:  0.021529521061138222
Bond Position:  [-4.4149115]


portfolio before change:  [-2.28641161]
curr_Stock_Price:  98.91551945764671
curr_Factors:  [98.91551946]
mat_Sqrt:  [[0.15]]
grads:  [-0.01716784]
Stock Position:  -0.017167841540857126
Bond Position:  [-0.58824564]


portfolio before change:  [-2.30098054]
curr_Stock_Price:  99.75556989525876
curr_Factors:  [99.7555699]
mat_Sqrt:  [[0.15]]
grads:  [0.07081427]
Stock Position:  0.07081427284327324
Bond Position:  [-9.36509868]


portfolio before change:  [-2.29372382]
curr_Stock_Price:  99.89111162930044
curr_Factors:  [99.89111163]
mat_Sqrt:  [[0.15]]
grads:  [0.1983732]
Stock Position:  0.19837319984964122
Bond Position:  [-22.10944327]


portfolio before change:  [-2.61892863]
curr_Stock_Price:  98.27961996718912
curr_Factors:  [98.27961997]
mat_Sqrt:  [[0.15]]
grads:  [0.13287317]
Stock Position:  0.13287317244289065
Bond Position:  [-15.67765352]


portfolio before change:  [-2.73591585]
curr_Stock_Price:  97.42867831617788
curr_Factors:  [97.42867832]
mat_Sqrt:  [[0.15]]
grads:  [0.0280932]
Stock Position:  0.028093195255554898
Bond Position:  [-5.47299873]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.73591585]
Stock Price:  97.75269564292942
PL:  [-2.73591585]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-2.68712698e-02]
 [-7.77723582e-03]
 [-1.80279493e-03]
 [ 2.27820273e-03]
 [ 6.98015676e-03]
 [ 5.10266801e-03]
 [-3.53227833e-04]
 [-2.26464040e-04]
 [-6.52609158e-04]
 [ 2.32884036e-02]
 [-1.02568862e-02]
 [-2.09714617e-02]
 [-2.36417091e-04]
 [-6.98645414e-03]
 [-3.10342336e-03]
 [ 9.09063409e-03]
 [-4.55966445e-02]
 [ 9.08537554e-04]
 [ 4.33850417e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.11515372]
curr_Stock_Price:  101.19975845787555
curr_Factors:  [101.19975846]
mat_Sqrt:  [[0.15]]
grads:  [-0.1791418]
Stock Position:  -0.17914179899240001
Bond Position:  [38.24426051]


portfolio before change:  [20.09722464]
curr_Stock_Price:  101.35321982354193
curr_Factors:  [101.35321982]
mat_Sqrt:  [[0.15]]
grads:  [-0.05184824]
Stock Position:  -0.051848238792491556
Bond Position:  [25.35221058]


portfolio before change:  [20.08944595]
curr_Stock_Price:  101.62550554112948
curr_Factors:  [101.62550554]
mat_Sqrt:  [[0.15]]
grads:  [-0.01201863]
Stock Position:  -0.012018632855401029
Bond Position:  [21.31084559]


portfolio before change:  [20.10302958]
curr_Stock_Price:  100.93863414402568
curr_Factors:  [100.93863414]
mat_Sqrt:  [[0.15]]
grads:  [0.01518802]
Stock Position:  0.01518801819251664
Bond Position:  [18.56997177]


portfolio before change:  [20.10328827]
curr_Stock_Price:  100.64996020813261
curr_Factors:  [100.64996021]
mat_Sqrt:  [[0.15]]
grads:  [0.04653438]
Stock Position:  0.04653437840509802
Bond Position:  [15.41960494]


portfolio before change:  [20.07417136]
curr_Stock_Price:  99.94140237503795
curr_Factors:  [99.94140238]
mat_Sqrt:  [[0.15]]
grads:  [0.03401779]
Stock Position:  0.03401778676575626
Bond Position:  [16.67438604]


portfolio before change:  [20.15077576]
curr_Stock_Price:  102.07073792083493
curr_Factors:  [102.07073792]
mat_Sqrt:  [[0.15]]
grads:  [-0.00235485]
Stock Position:  -0.0023548522184172727
Bond Position:  [20.39113726]


portfolio before change:  [20.15646577]
curr_Stock_Price:  101.81951534450378
curr_Factors:  [101.81951534]
mat_Sqrt:  [[0.15]]
grads:  [-0.00150976]
Stock Position:  -0.0015097602635773285
Bond Position:  [20.31018883]


portfolio before change:  [20.16144732]
curr_Stock_Price:  101.88352275761402
curr_Factors:  [101.88352276]
mat_Sqrt:  [[0.15]]
grads:  [-0.00435073]
Stock Position:  -0.004350727721443496
Bond Position:  [20.60471478]


portfolio before change:  [20.16683092]
curr_Stock_Price:  101.83024951545194
curr_Factors:  [101.83024952]
mat_Sqrt:  [[0.15]]
grads:  [0.15525602]
Stock Position:  0.15525602418954837
Bond Position:  [4.35707123]


portfolio before change:  [20.35638106]
curr_Stock_Price:  103.04412021226683
curr_Factors:  [103.04412021]
mat_Sqrt:  [[0.15]]
grads:  [-0.06837924]
Stock Position:  -0.06837924123880716
Bond Position:  [27.40245981]


portfolio before change:  [20.3738934]
curr_Stock_Price:  102.88821220667113
curr_Factors:  [102.88821221]
mat_Sqrt:  [[0.15]]
grads:  [-0.13980974]
Stock Position:  -0.13980974448628236
Bond Position:  [34.75866806]


portfolio before change:  [20.53006659]
curr_Stock_Price:  101.83333267744544
curr_Factors:  [101.83333268]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157611]
Stock Position:  -0.0015761139392911306
Bond Position:  [20.69056753]


portfolio before change:  [20.53678399]
curr_Stock_Price:  100.85363805758246
curr_Factors:  [100.85363806]
mat_Sqrt:  [[0.15]]
grads:  [-0.04657636]
Stock Position:  -0.04657636095366857
Bond Position:  [25.23417944]


portfolio before change:  [20.5360182]
curr_Stock_Price:  101.00554185477233
curr_Factors:  [101.00554185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02068949]
Stock Position:  -0.02068948904775316
Bond Position:  [22.62577125]


portfolio before change:  [20.52039599]
curr_Stock_Price:  102.03405221055775
curr_Factors:  [102.03405221]
mat_Sqrt:  [[0.15]]
grads:  [0.06060423]
Stock Position:  0.06060422728322611
Bond Position:  [14.3367011]


portfolio before change:  [20.57616381]
curr_Stock_Price:  102.89510090922059
curr_Factors:  [102.89510091]
mat_Sqrt:  [[0.15]]
grads:  [-0.30397763]
Stock Position:  -0.3039776302029813
Bond Position:  [51.85397274]


portfolio before change:  [21.16602014]
curr_Stock_Price:  100.997292790396
curr_Factors:  [100.99729279]
mat_Sqrt:  [[0.15]]
grads:  [0.00605692]
Stock Position:  0.0060569170252304984
Bond Position:  [20.55428791]


portfolio before change:  [21.17657716]
curr_Stock_Price:  101.89177670352107
curr_Factors:  [101.8917767]
mat_Sqrt:  [[0.15]]
grads:  [0.02892336]
Stock Position:  0.028923361112831114
Bond Position:  [18.22952451]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.17657716]
Stock Price:  99.97674579621345
PL:  [21.17657716]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.80760844e-02]
 [ 7.43494599e-03]
 [ 5.64589617e-03]
 [ 3.50788971e-03]
 [ 8.03884229e-03]
 [ 1.67155532e-02]
 [-1.15083309e-02]
 [ 5.15982077e-03]
 [ 7.74479755e-03]
 [-3.73154880e-02]
 [ 4.67524047e-04]
 [-2.63781154e-02]
 [ 2.29308901e-03]
 [-3.54377213e-03]
 [-9.68450522e-04]
 [ 9.59926799e-03]
 [ 8.54562405e-04]
 [ 1.46045595e-02]
 [ 1.14172989e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.34644041]
curr_Stock_Price:  99.3385410300169
curr_Factors:  [99.33854103]
mat_Sqrt:  [[0.15]]
grads:  [0.12050723]
Stock Position:  0.12050722905604555
Bond Position:  [-20.31745273]


portfolio before change:  [-8.42144956]
curr_Stock_Price:  98.75825097713967
curr_Factors:  [98.75825098]
mat_Sqrt:  [[0.15]]
grads:  [0.04956631]
Stock Position:  0.049566306568672336
Bond Position:  [-13.3165313]


portfolio before change:  [-8.42074255]
curr_Stock_Price:  98.83968859973142
curr_Factors:  [98.8396886]
mat_Sqrt:  [[0.15]]
grads:  [0.03763931]
Stock Position:  0.03763930780000743
Bond Position:  [-12.14100001]


portfolio before change:  [-8.3873451]
curr_Stock_Price:  99.80764137507835
curr_Factors:  [99.80764138]
mat_Sqrt:  [[0.15]]
grads:  [0.02338593]
Stock Position:  0.023385931405753808
Bond Position:  [-10.72143976]


portfolio before change:  [-8.39828522]
curr_Stock_Price:  99.45446232472634
curr_Factors:  [99.45446232]
mat_Sqrt:  [[0.15]]
grads:  [0.05359228]
Stock Position:  0.053592281924458425
Bond Position:  [-13.7282768]


portfolio before change:  [-8.48199803]
curr_Stock_Price:  97.95647961770243
curr_Factors:  [97.95647962]
mat_Sqrt:  [[0.15]]
grads:  [0.11143702]
Stock Position:  0.11143702109880123
Bond Position:  [-19.39797631]


portfolio before change:  [-8.52083229]
curr_Stock_Price:  97.65151671273472
curr_Factors:  [97.65151671]
mat_Sqrt:  [[0.15]]
grads:  [-0.07672221]
Stock Position:  -0.07672220622039796
Bond Position:  [-1.02879248]


portfolio before change:  [-8.49861803]
curr_Stock_Price:  97.35862249274238
curr_Factors:  [97.35862249]
mat_Sqrt:  [[0.15]]
grads:  [0.03439881]
Stock Position:  0.03439880510066183
Bond Position:  [-11.84763831]


portfolio before change:  [-8.57652064]
curr_Stock_Price:  95.18004873066505
curr_Factors:  [95.18004873]
mat_Sqrt:  [[0.15]]
grads:  [0.05163198]
Stock Position:  0.05163198363799912
Bond Position:  [-13.49085536]


portfolio before change:  [-8.63727745]
curr_Stock_Price:  94.06865089216332
curr_Factors:  [94.06865089]
mat_Sqrt:  [[0.15]]
grads:  [-0.24876992]
Stock Position:  -0.24876992018055868
Bond Position:  [14.76417332]


portfolio before change:  [-8.47886175]
curr_Stock_Price:  93.44669387966331
curr_Factors:  [93.44669388]
mat_Sqrt:  [[0.15]]
grads:  [0.00311683]
Stock Position:  0.003116826982827714
Bond Position:  [-8.77011893]


portfolio before change:  [-8.47608479]
curr_Stock_Price:  95.04118884717414
curr_Factors:  [95.04118885]
mat_Sqrt:  [[0.15]]
grads:  [-0.1758541]
Stock Position:  -0.17585410254052453
Bond Position:  [8.23729818]


portfolio before change:  [-8.47106757]
curr_Stock_Price:  95.0243701548758
curr_Factors:  [95.02437015]
mat_Sqrt:  [[0.15]]
grads:  [0.01528726]
Stock Position:  0.015287260094514902
Bond Position:  [-9.92372983]


portfolio before change:  [-8.47559588]
curr_Stock_Price:  94.89046353320859
curr_Factors:  [94.89046353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362515]
Stock Position:  -0.02362514751871805
Bond Position:  [-6.23379468]


portfolio before change:  [-8.49355332]
curr_Stock_Price:  95.58458827743031
curr_Factors:  [95.58458828]
mat_Sqrt:  [[0.15]]
grads:  [-0.00645634]
Stock Position:  -0.006456336816062091
Bond Position:  [-7.87642703]


portfolio before change:  [-8.49721447]
curr_Stock_Price:  95.84662434563661
curr_Factors:  [95.84662435]
mat_Sqrt:  [[0.15]]
grads:  [0.06399512]
Stock Position:  0.06399511993834074
Bond Position:  [-14.63093069]


portfolio before change:  [-8.66205842]
curr_Stock_Price:  93.32790476412897
curr_Factors:  [93.32790476]
mat_Sqrt:  [[0.15]]
grads:  [0.00569708]
Stock Position:  0.005697082702189604
Bond Position:  [-9.19375521]


portfolio before change:  [-8.66368639]
curr_Stock_Price:  93.4456409561878
curr_Factors:  [93.44564096]
mat_Sqrt:  [[0.15]]
grads:  [0.09736373]
Stock Position:  0.09736372981214339
Bond Position:  [-17.76190253]


portfolio before change:  [-8.64187476]
curr_Stock_Price:  93.7152759044328
curr_Factors:  [93.7152759]
mat_Sqrt:  [[0.15]]
grads:  [0.00761153]
Stock Position:  0.007611532624592777
Bond Position:  [-9.35519164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.64187476]
Stock Price:  95.47980533055858
PL:  [-8.64187476]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 4.04104718e-02]
 [ 6.63394643e-03]
 [ 3.08154792e-03]
 [-1.08889397e-03]
 [ 8.69063476e-03]
 [ 9.84726680e-03]
 [-1.23056464e-02]
 [ 5.28283261e-04]
 [-1.14313056e-03]
 [-1.66688789e-02]
 [-1.06403161e-03]
 [-2.63482888e-02]
 [ 2.77009311e-03]
 [-1.29773539e-03]
 [-1.13730623e-03]
 [ 1.10465856e-02]
 [ 4.83110441e-02]
 [ 2.00919210e-02]
 [ 3.06136009e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.35726608]
curr_Stock_Price:  98.94546910909345
curr_Factors:  [98.94546911]
mat_Sqrt:  [[0.15]]
grads:  [0.26940315]
Stock Position:  0.2694031455431301
Bond Position:  [-41.01348669]


portfolio before change:  [-14.31847421]
curr_Stock_Price:  99.12752535794323
curr_Factors:  [99.12752536]
mat_Sqrt:  [[0.15]]
grads:  [0.04422631]
Stock Position:  0.04422630950342197
Bond Position:  [-18.70251882]


portfolio before change:  [-14.32375416]
curr_Stock_Price:  99.11387412210627
curr_Factors:  [99.11387412]
mat_Sqrt:  [[0.15]]
grads:  [0.02054365]
Stock Position:  0.020543652793009806
Bond Position:  [-16.35991518]


portfolio before change:  [-14.37294218]
curr_Stock_Price:  96.91866944460718
curr_Factors:  [96.91866944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00725929]
Stock Position:  -0.007259293149917162
Bond Position:  [-13.66938114]


portfolio before change:  [-14.38318471]
curr_Stock_Price:  97.85881119997697
curr_Factors:  [97.8588112]
mat_Sqrt:  [[0.15]]
grads:  [0.05793757]
Stock Position:  0.0579375650524107
Bond Position:  [-20.05288595]


portfolio before change:  [-14.34675375]
curr_Stock_Price:  98.57414697633807
curr_Factors:  [98.57414698]
mat_Sqrt:  [[0.15]]
grads:  [0.06564845]
Stock Position:  0.06564844531209608
Bond Position:  [-20.81799325]


portfolio before change:  [-14.39762788]
curr_Stock_Price:  97.87848713826804
curr_Factors:  [97.87848714]
mat_Sqrt:  [[0.15]]
grads:  [-0.08203764]
Stock Position:  -0.08203764290753507
Bond Position:  [-6.36790751]


portfolio before change:  [-14.48233421]
curr_Stock_Price:  98.89160922015901
curr_Factors:  [98.89160922]
mat_Sqrt:  [[0.15]]
grads:  [0.00352189]
Stock Position:  0.003521888407195491
Bond Position:  [-14.83061942]


portfolio before change:  [-14.4804475]
curr_Stock_Price:  100.48019627912416
curr_Factors:  [100.48019628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00762087]
Stock Position:  -0.00762087038553979
Bond Position:  [-13.71470095]


portfolio before change:  [-14.47950165]
curr_Stock_Price:  99.90612038700743
curr_Factors:  [99.90612039]
mat_Sqrt:  [[0.15]]
grads:  [-0.11112586]
Stock Position:  -0.11112585910367587
Bond Position:  [-3.37734819]


portfolio before change:  [-14.40477233]
curr_Stock_Price:  99.22604686428417
curr_Factors:  [99.22604686]
mat_Sqrt:  [[0.15]]
grads:  [-0.00709354]
Stock Position:  -0.0070935440587498125
Bond Position:  [-13.700908]


portfolio before change:  [-14.39412482]
curr_Stock_Price:  97.24210682654379
curr_Factors:  [97.24210683]
mat_Sqrt:  [[0.15]]
grads:  [-0.17565526]
Stock Position:  -0.17565525855504133
Bond Position:  [2.68696259]


portfolio before change:  [-14.36063868]
curr_Stock_Price:  97.05529589186034
curr_Factors:  [97.05529589]
mat_Sqrt:  [[0.15]]
grads:  [0.01846729]
Stock Position:  0.018467287381857458
Bond Position:  [-16.15298672]


portfolio before change:  [-14.37733268]
curr_Stock_Price:  96.37001620449736
curr_Factors:  [96.3700162]
mat_Sqrt:  [[0.15]]
grads:  [-0.00865157]
Stock Position:  -0.008651569296384103
Bond Position:  [-13.54358081]


portfolio before change:  [-14.37556404]
curr_Stock_Price:  95.77417462995022
curr_Factors:  [95.77417463]
mat_Sqrt:  [[0.15]]
grads:  [-0.00758204]
Stock Position:  -0.0075820415423578395
Bond Position:  [-13.64940027]


portfolio before change:  [-14.38555274]
curr_Stock_Price:  96.64147726972404
curr_Factors:  [96.64147727]
mat_Sqrt:  [[0.15]]
grads:  [0.0736439]
Stock Position:  0.07364390383770225
Bond Position:  [-21.5026084]


portfolio before change:  [-14.37917989]
curr_Stock_Price:  96.8010175969839
curr_Factors:  [96.8010176]
mat_Sqrt:  [[0.15]]
grads:  [0.32207363]
Stock Position:  0.3220736274505552
Bond Position:  [-45.55623477]


portfolio before change:  [-14.52936277]
curr_Stock_Price:  96.37008385360859
curr_Factors:  [96.37008385]
mat_Sqrt:  [[0.15]]
grads:  [0.13394614]
Stock Position:  0.13394614027817525
Bond Position:  [-27.43776354]


portfolio before change:  [-14.59103568]
curr_Stock_Price:  95.96086998366803
curr_Factors:  [95.96086998]
mat_Sqrt:  [[0.15]]
grads:  [0.02040907]
Stock Position:  0.020409067238830195
Bond Position:  [-16.54950753]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.59103568]
Stock Price:  95.38977704563725
PL:  [-14.59103568]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 2.08016659e-02]
 [-7.39235804e-03]
 [ 3.23873731e-03]
 [ 3.41541863e-03]
 [ 6.12855945e-03]
 [ 1.74063939e-03]
 [-4.24622415e-03]
 [ 7.83236648e-04]
 [ 1.66925209e-03]
 [ 2.86677566e-02]
 [-6.87791620e-03]
 [-2.23554560e-02]
 [ 5.85187850e-04]
 [ 5.35341079e-04]
 [-3.07548657e-03]
 [ 1.14366570e-02]
 [ 4.47363371e-02]
 [ 1.94976229e-02]
 [ 3.78849640e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.27397562]
curr_Stock_Price:  100.68699247302546
curr_Factors:  [100.68699247]
mat_Sqrt:  [[0.15]]
grads:  [0.13867777]
Stock Position:  0.1386777728079484
Bond Position:  [-1.68907225]


portfolio before change:  [12.4423863]
curr_Stock_Price:  101.90444069967374
curr_Factors:  [101.9044407]
mat_Sqrt:  [[0.15]]
grads:  [-0.04928239]
Stock Position:  -0.04928238696556097
Bond Position:  [17.46448038]


portfolio before change:  [12.44432768]
curr_Stock_Price:  101.953652872435
curr_Factors:  [101.95365287]
mat_Sqrt:  [[0.15]]
grads:  [0.02159158]
Stock Position:  0.02159158204803747
Bond Position:  [10.24298702]


portfolio before change:  [12.40249542]
curr_Stock_Price:  99.8976050697215
curr_Factors:  [99.89760507]
mat_Sqrt:  [[0.15]]
grads:  [0.02276946]
Stock Position:  0.0227694575212403
Bond Position:  [10.12788114]


portfolio before change:  [12.4497675]
curr_Stock_Price:  101.86250869219928
curr_Factors:  [101.86250869]
mat_Sqrt:  [[0.15]]
grads:  [0.04085706]
Stock Position:  0.04085706302508646
Bond Position:  [8.28796456]


portfolio before change:  [12.44899074]
curr_Stock_Price:  101.79277755688689
curr_Factors:  [101.79277756]
mat_Sqrt:  [[0.15]]
grads:  [0.01160426]
Stock Position:  0.011604262619229571
Bond Position:  [11.26776061]


portfolio before change:  [12.46658089]
curr_Stock_Price:  103.06583220042282
curr_Factors:  [103.0658322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02830816]
Stock Position:  -0.02830816100435453
Bond Position:  [15.38418506]


portfolio before change:  [12.46440585]
curr_Stock_Price:  103.27854690930285
curr_Factors:  [103.27854691]
mat_Sqrt:  [[0.15]]
grads:  [0.00522158]
Stock Position:  0.005221577655228287
Bond Position:  [11.9251289]


portfolio before change:  [12.47069738]
curr_Stock_Price:  103.91242968709335
curr_Factors:  [103.91242969]
mat_Sqrt:  [[0.15]]
grads:  [0.01112835]
Stock Position:  0.011128347282112426
Bond Position:  [11.31432377]


portfolio before change:  [12.45365398]
curr_Stock_Price:  102.12668976869638
curr_Factors:  [102.12668977]
mat_Sqrt:  [[0.15]]
grads:  [0.19111838]
Stock Position:  0.19111837757241237
Bond Position:  [-7.06463328]


portfolio before change:  [12.39512093]
curr_Stock_Price:  101.82966618002253
curr_Factors:  [101.82966618]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585277]
Stock Position:  -0.04585277468827962
Bond Position:  [17.06429367]


portfolio before change:  [12.42027101]
curr_Stock_Price:  101.37422002300735
curr_Factors:  [101.37422002]
mat_Sqrt:  [[0.15]]
grads:  [-0.14903637]
Stock Position:  -0.14903637356003596
Bond Position:  [27.52871713]


portfolio before change:  [12.55668395]
curr_Stock_Price:  100.50510401224388
curr_Factors:  [100.50510401]
mat_Sqrt:  [[0.15]]
grads:  [0.00390125]
Stock Position:  0.0039012523309768714
Bond Position:  [12.16458818]


portfolio before change:  [12.55494112]
curr_Stock_Price:  99.27874000946667
curr_Factors:  [99.27874001]
mat_Sqrt:  [[0.15]]
grads:  [0.00356894]
Stock Position:  0.0035689405297062555
Bond Position:  [12.2006212]


portfolio before change:  [12.55907491]
curr_Stock_Price:  99.58226307158513
curr_Factors:  [99.58226307]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050324]
Stock Position:  -0.020503243800561836
Bond Position:  [14.60083433]


portfolio before change:  [12.58116424]
curr_Stock_Price:  98.68295823164647
curr_Factors:  [98.68295823]
mat_Sqrt:  [[0.15]]
grads:  [0.07624438]
Stock Position:  0.07624437987073923
Bond Position:  [5.05714329]


portfolio before change:  [12.63552446]
curr_Stock_Price:  99.37934759105258
curr_Factors:  [99.37934759]
mat_Sqrt:  [[0.15]]
grads:  [0.29824225]
Stock Position:  0.29824224761077595
Bond Position:  [-17.00359553]


portfolio before change:  [12.58647912]
curr_Stock_Price:  99.22915453467407
curr_Factors:  [99.22915453]
mat_Sqrt:  [[0.15]]
grads:  [0.12998415]
Stock Position:  0.12998415284153628
Bond Position:  [-0.31173847]


portfolio before change:  [12.66722484]
curr_Stock_Price:  99.85095085629676
curr_Factors:  [99.85095086]
mat_Sqrt:  [[0.15]]
grads:  [0.02525664]
Stock Position:  0.02525664268618606
Bond Position:  [10.14532505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.66722484]
Stock Price:  100.29521309487635
PL:  [12.37201174]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.21922728e-02]
 [-4.51068478e-03]
 [ 9.86776094e-03]
 [ 3.81361111e-03]
 [ 8.86382953e-03]
 [ 4.94031977e-03]
 [-1.46085913e-02]
 [-2.23698955e-03]
 [-6.75860299e-04]
 [-3.15874902e-02]
 [-1.04103496e-03]
 [-2.57750501e-02]
 [ 2.34961180e-03]
 [ 6.98845728e-04]
 [-2.58559981e-03]
 [ 1.05662004e-02]
 [ 2.32128574e-02]
 [ 1.77402684e-02]
 [ 3.79199557e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.66436873]
curr_Stock_Price:  99.71011441361836
curr_Factors:  [99.71011441]
mat_Sqrt:  [[0.15]]
grads:  [0.08128182]
Stock Position:  0.0812818189751285
Bond Position:  [-10.7689882]


portfolio before change:  [-2.63061555]
curr_Stock_Price:  100.15850215124031
curr_Factors:  [100.15850215]
mat_Sqrt:  [[0.15]]
grads:  [-0.03007123]
Stock Position:  -0.030071231891194563
Bond Position:  [0.381274]


portfolio before change:  [-2.57190075]
curr_Stock_Price:  98.20914861764842
curr_Factors:  [98.20914862]
mat_Sqrt:  [[0.15]]
grads:  [0.06578507]
Stock Position:  0.06578507294643
Bond Position:  [-9.03259676]


portfolio before change:  [-2.52787564]
curr_Stock_Price:  98.91270565948437
curr_Factors:  [98.91270566]
mat_Sqrt:  [[0.15]]
grads:  [0.02542407]
Stock Position:  0.025424074095486745
Bond Position:  [-5.04263959]


portfolio before change:  [-2.5762292]
curr_Stock_Price:  97.0604159413878
curr_Factors:  [97.06041594]
mat_Sqrt:  [[0.15]]
grads:  [0.0590922]
Stock Position:  0.05909219683440461
Bond Position:  [-8.31174241]


portfolio before change:  [-2.47005991]
curr_Stock_Price:  98.8922565746086
curr_Factors:  [98.89225657]
mat_Sqrt:  [[0.15]]
grads:  [0.03293547]
Stock Position:  0.03293546515621252
Bond Position:  [-5.72712238]


portfolio before change:  [-2.44652585]
curr_Stock_Price:  99.6502850305708
curr_Factors:  [99.65028503]
mat_Sqrt:  [[0.15]]
grads:  [-0.09739061]
Stock Position:  -0.09739060898747659
Bond Position:  [7.25847609]


portfolio before change:  [-2.50477777]
curr_Stock_Price:  100.2670463928506
curr_Factors:  [100.26704639]
mat_Sqrt:  [[0.15]]
grads:  [-0.01491326]
Stock Position:  -0.014913263653090524
Bond Position:  [-1.00946887]


portfolio before change:  [-2.50004967]
curr_Stock_Price:  99.93308177498623
curr_Factors:  [99.93308177]
mat_Sqrt:  [[0.15]]
grads:  [-0.00450574]
Stock Position:  -0.004505735327282158
Bond Position:  [-2.04977765]


portfolio before change:  [-2.49772824]
curr_Stock_Price:  99.30412010705257
curr_Factors:  [99.30412011]
mat_Sqrt:  [[0.15]]
grads:  [-0.21058327]
Stock Position:  -0.21058326805625552
Bond Position:  [18.4140579]


portfolio before change:  [-2.3824498]
curr_Stock_Price:  98.77855911142379
curr_Factors:  [98.77855911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00694023]
Stock Position:  -0.006940233094571315
Bond Position:  [-1.69690357]


portfolio before change:  [-2.38491276]
curr_Stock_Price:  99.07230816917908
curr_Factors:  [99.07230817]
mat_Sqrt:  [[0.15]]
grads:  [-0.17183367]
Stock Position:  -0.17183366719319426
Bond Position:  [14.63904527]


portfolio before change:  [-2.31839488]
curr_Stock_Price:  98.70650286346512
curr_Factors:  [98.70650286]
mat_Sqrt:  [[0.15]]
grads:  [0.01566408]
Stock Position:  0.015664078645540126
Bond Position:  [-3.8645413]


portfolio before change:  [-2.33884935]
curr_Stock_Price:  97.46236854723495
curr_Factors:  [97.46236855]
mat_Sqrt:  [[0.15]]
grads:  [0.00465897]
Stock Position:  0.004658971518332814
Bond Position:  [-2.79292375]


portfolio before change:  [-2.33257059]
curr_Stock_Price:  98.95992666220076
curr_Factors:  [98.95992666]
mat_Sqrt:  [[0.15]]
grads:  [-0.01723733]
Stock Position:  -0.017237332065918067
Bond Position:  [-0.62676547]


portfolio before change:  [-2.35209729]
curr_Stock_Price:  100.08364996937658
curr_Factors:  [100.08364997]
mat_Sqrt:  [[0.15]]
grads:  [0.07044134]
Stock Position:  0.07044133632816553
Bond Position:  [-9.40212334]


portfolio before change:  [-2.35928036]
curr_Stock_Price:  100.0150503951272
curr_Factors:  [100.0150504]
mat_Sqrt:  [[0.15]]
grads:  [0.15475238]
Stock Position:  0.15475238286085996
Bond Position:  [-17.83684773]


portfolio before change:  [-2.35698626]
curr_Stock_Price:  100.05869348791393
curr_Factors:  [100.05869349]
mat_Sqrt:  [[0.15]]
grads:  [0.11826846]
Stock Position:  0.1182684557108992
Bond Position:  [-14.19077342]


portfolio before change:  [-2.29279353]
curr_Stock_Price:  100.63146556714874
curr_Factors:  [100.63146557]
mat_Sqrt:  [[0.15]]
grads:  [0.02527997]
Stock Position:  0.025279970483124557
Bond Position:  [-4.83675401]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.29279353]
Stock Price:  100.2991869676809
PL:  [-2.59198049]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.78773437e-02]
 [-3.10869370e-03]
 [ 1.77970089e-02]
 [-7.71093023e-03]
 [ 4.70871229e-03]
 [-1.34605577e-02]
 [-5.76594731e-06]
 [-2.29740080e-04]
 [-8.56752952e-04]
 [ 4.25886284e-02]
 [-1.12973337e-02]
 [-1.96106969e-02]
 [-8.49665080e-04]
 [-1.93602999e-02]
 [ 7.04724925e-03]
 [ 7.46685334e-03]
 [-4.58525819e-02]
 [-2.62771154e-02]
 [ 4.59142369e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.00590235]
curr_Stock_Price:  102.04273604637561
curr_Factors:  [102.04273605]
mat_Sqrt:  [[0.15]]
grads:  [-0.25251562]
Stock Position:  -0.2525156245074217
Bond Position:  [58.77328756]


portfolio before change:  [32.52004231]
curr_Stock_Price:  104.02501020477837
curr_Factors:  [104.0250102]
mat_Sqrt:  [[0.15]]
grads:  [-0.02072462]
Stock Position:  -0.02072462464228607
Bond Position:  [34.6759216]


portfolio before change:  [32.55292454]
curr_Stock_Price:  102.85673020490293
curr_Factors:  [102.8567302]
mat_Sqrt:  [[0.15]]
grads:  [0.11864673]
Stock Position:  0.11864672620908498
Bond Position:  [20.34931023]


portfolio before change:  [32.72461832]
curr_Stock_Price:  104.26094777846949
curr_Factors:  [104.26094778]
mat_Sqrt:  [[0.15]]
grads:  [-0.0514062]
Stock Position:  -0.0514062015329465
Bond Position:  [38.08427761]


portfolio before change:  [32.70844032]
curr_Stock_Price:  104.7608924716421
curr_Factors:  [104.76089247]
mat_Sqrt:  [[0.15]]
grads:  [0.03139142]
Stock Position:  0.03139141526062604
Bond Position:  [29.41984764]


portfolio before change:  [32.65677756]
curr_Stock_Price:  102.88080380799622
curr_Factors:  [102.88080381]
mat_Sqrt:  [[0.15]]
grads:  [-0.08973705]
Stock Position:  -0.08973705151506146
Bond Position:  [41.88899755]


portfolio before change:  [32.74791406]
curr_Stock_Price:  101.98192269822664
curr_Factors:  [101.9819227]
mat_Sqrt:  [[0.15]]
grads:  [-3.84396487e-05]
Stock Position:  -3.843964874673117e-05
Bond Position:  [32.7518342]


portfolio before change:  [32.75610943]
curr_Stock_Price:  101.8155771451009
curr_Factors:  [101.81557715]
mat_Sqrt:  [[0.15]]
grads:  [-0.0015316]
Stock Position:  -0.0015316005341852069
Bond Position:  [32.91205022]


portfolio before change:  [32.76463388]
curr_Stock_Price:  101.62270468776057
curr_Factors:  [101.62270469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00571169]
Stock Position:  -0.005711686348234895
Bond Position:  [33.34507089]


portfolio before change:  [32.76512886]
curr_Stock_Price:  102.99573696630715
curr_Factors:  [102.99573697]
mat_Sqrt:  [[0.15]]
grads:  [0.28392419]
Stock Position:  0.2839241893044729
Bond Position:  [3.52214774]


portfolio before change:  [32.92210152]
curr_Stock_Price:  103.54550349427734
curr_Factors:  [103.54550349]
mat_Sqrt:  [[0.15]]
grads:  [-0.07531556]
Stock Position:  -0.07531555790516264
Bond Position:  [40.72068888]


portfolio before change:  [32.87179581]
curr_Stock_Price:  104.34861980514032
curr_Factors:  [104.34861981]
mat_Sqrt:  [[0.15]]
grads:  [-0.13073798]
Stock Position:  -0.1307379793210513
Bond Position:  [46.51412351]


portfolio before change:  [33.03386637]
curr_Stock_Price:  103.19791685229504
curr_Factors:  [103.19791685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00566443]
Stock Position:  -0.005664433864543897
Bond Position:  [33.61842415]


portfolio before change:  [33.04471394]
curr_Stock_Price:  102.76682138005499
curr_Factors:  [102.76682138]
mat_Sqrt:  [[0.15]]
grads:  [-0.12906867]
Stock Position:  -0.12906866587732974
Bond Position:  [46.30869048]


portfolio before change:  [32.84035334]
curr_Stock_Price:  104.43987828802473
curr_Factors:  [104.43987829]
mat_Sqrt:  [[0.15]]
grads:  [0.04698166]
Stock Position:  0.04698166168455527
Bond Position:  [27.93359431]


portfolio before change:  [32.87549274]
curr_Stock_Price:  105.03915730020803
curr_Factors:  [105.0391573]
mat_Sqrt:  [[0.15]]
grads:  [0.04977902]
Stock Position:  0.04977902229016873
Bond Position:  [27.64674618]


portfolio before change:  [32.82477953]
curr_Stock_Price:  103.88152595471182
curr_Factors:  [103.88152595]
mat_Sqrt:  [[0.15]]
grads:  [-0.30568388]
Stock Position:  -0.3056838790495926
Bond Position:  [64.57968734]


portfolio before change:  [33.11508069]
curr_Stock_Price:  102.98467059810575
curr_Factors:  [102.9846706]
mat_Sqrt:  [[0.15]]
grads:  [-0.17518077]
Stock Position:  -0.17518076928630413
Bond Position:  [51.15601451]


portfolio before change:  [33.21094904]
curr_Stock_Price:  102.51043049189775
curr_Factors:  [102.51043049]
mat_Sqrt:  [[0.15]]
grads:  [0.03060949]
Stock Position:  0.030609491252617037
Bond Position:  [30.07315692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.21094904]
Stock Price:  104.63511476199267
PL:  [28.57583428]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [-3.81989956e-02]
 [-7.58232277e-03]
 [-1.07791563e-02]
 [ 3.30790508e-03]
 [ 6.54269555e-03]
 [ 1.38600745e-02]
 [-1.58578908e-02]
 [-2.14080052e-03]
 [-1.22669761e-03]
 [ 3.91672116e-02]
 [-6.12484028e-03]
 [-2.50559795e-02]
 [ 8.93700554e-06]
 [-7.86152596e-03]
 [-2.58924352e-03]
 [ 9.93656534e-03]
 [-4.84362186e-02]
 [-2.69811990e-02]
 [ 4.66038894e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.86289483]
curr_Stock_Price:  101.96799021545195
curr_Factors:  [101.96799022]
mat_Sqrt:  [[0.15]]
grads:  [-0.25465997]
Stock Position:  -0.2546599708803468
Bond Position:  [57.83006025]


portfolio before change:  [31.94333724]
curr_Stock_Price:  101.70888751860225
curr_Factors:  [101.70888752]
mat_Sqrt:  [[0.15]]
grads:  [-0.05054882]
Stock Position:  -0.05054881848985724
Bond Position:  [37.08460133]


portfolio before change:  [32.01877425]
curr_Stock_Price:  100.39996075821756
curr_Factors:  [100.39996076]
mat_Sqrt:  [[0.15]]
grads:  [-0.07186104]
Stock Position:  -0.07186104232248239
Bond Position:  [39.23362008]


portfolio before change:  [32.059574]
curr_Stock_Price:  99.9687102188606
curr_Factors:  [99.96871022]
mat_Sqrt:  [[0.15]]
grads:  [0.0220527]
Stock Position:  0.022052700550892
Bond Position:  [29.85499396]


portfolio before change:  [32.09554553]
curr_Stock_Price:  101.26137991455431
curr_Factors:  [101.26137991]
mat_Sqrt:  [[0.15]]
grads:  [0.04361797]
Stock Position:  0.04361797031086767
Bond Position:  [27.67872967]


portfolio before change:  [31.96741178]
curr_Stock_Price:  98.16508043218772
curr_Factors:  [98.16508043]
mat_Sqrt:  [[0.15]]
grads:  [0.0924005]
Stock Position:  0.09240049671417483
Bond Position:  [22.89690959]


portfolio before change:  [32.08423837]
curr_Stock_Price:  99.36747270824041
curr_Factors:  [99.36747271]
mat_Sqrt:  [[0.15]]
grads:  [-0.10571927]
Stock Position:  -0.10571927194839344
Bond Position:  [42.58929524]


portfolio before change:  [32.02223612]
curr_Stock_Price:  100.05467854621791
curr_Factors:  [100.05467855]
mat_Sqrt:  [[0.15]]
grads:  [-0.014272]
Stock Position:  -0.01427200348672124
Bond Position:  [33.45021684]


portfolio before change:  [32.02215972]
curr_Stock_Price:  100.6460464102037
curr_Factors:  [100.64604641]
mat_Sqrt:  [[0.15]]
grads:  [-0.00817798]
Stock Position:  -0.008177984057204126
Bond Position:  [32.84524148]


portfolio before change:  [32.01328782]
curr_Stock_Price:  102.73509878432668
curr_Factors:  [102.73509878]
mat_Sqrt:  [[0.15]]
grads:  [0.26111474]
Stock Position:  0.261114744025807
Bond Position:  [5.1876388]


portfolio before change:  [31.64748418]
curr_Stock_Price:  101.32920072850217
curr_Factors:  [101.32920073]
mat_Sqrt:  [[0.15]]
grads:  [-0.04083227]
Stock Position:  -0.04083226851523226
Bond Position:  [35.78498531]


portfolio before change:  [31.72554622]
curr_Stock_Price:  99.63655219582695
curr_Factors:  [99.6365522]
mat_Sqrt:  [[0.15]]
grads:  [-0.16703986]
Stock Position:  -0.16703986300788792
Bond Position:  [48.36882225]


portfolio before change:  [31.45713517]
curr_Stock_Price:  101.31582066412898
curr_Factors:  [101.31582066]
mat_Sqrt:  [[0.15]]
grads:  [5.95800369e-05]
Stock Position:  5.9580036926611124e-05
Bond Position:  [31.45109877]


portfolio before change:  [31.46497636]
curr_Stock_Price:  100.93714335225184
curr_Factors:  [100.93714335]
mat_Sqrt:  [[0.15]]
grads:  [-0.05241017]
Stock Position:  -0.05241017308993366
Bond Position:  [36.75510952]


portfolio before change:  [31.46020158]
curr_Stock_Price:  101.20359366869008
curr_Factors:  [101.20359367]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726162]
Stock Position:  -0.017261623456192716
Bond Position:  [33.20713991]


portfolio before change:  [31.46138714]
curr_Stock_Price:  101.61591068866556
curr_Factors:  [101.61591069]
mat_Sqrt:  [[0.15]]
grads:  [0.06624377]
Stock Position:  0.06624376894811097
Bond Position:  [24.72996623]


portfolio before change:  [31.51375164]
curr_Stock_Price:  102.31305142591577
curr_Factors:  [102.31305143]
mat_Sqrt:  [[0.15]]
grads:  [-0.32290812]
Stock Position:  -0.3229081239089587
Bond Position:  [64.55146712]


portfolio before change:  [31.47184483]
curr_Stock_Price:  102.49281368202688
curr_Factors:  [102.49281368]
mat_Sqrt:  [[0.15]]
grads:  [-0.17987466]
Stock Position:  -0.1798746600000192
Bond Position:  [49.90770484]


portfolio before change:  [31.40534321]
curr_Stock_Price:  102.93189777341681
curr_Factors:  [102.93189777]
mat_Sqrt:  [[0.15]]
grads:  [0.03106926]
Stock Position:  0.031069259616968027
Bond Position:  [28.20732536]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.40534321]
Stock Price:  104.01109928466921
PL:  [27.39424393]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.80606039e-02]
 [-6.11629583e-03]
 [-8.01082834e-03]
 [ 2.24321220e-03]
 [ 5.36866765e-03]
 [-1.64192489e-02]
 [-2.84546164e-03]
 [ 7.37891490e-04]
 [-6.93549969e-04]
 [ 9.67534681e-03]
 [-2.86540389e-03]
 [-2.32895542e-02]
 [-2.27394838e-04]
 [-1.98269090e-02]
 [ 1.50596196e-04]
 [ 1.06511568e-02]
 [ 4.95363103e-02]
 [ 2.05980906e-02]
 [ 3.90268207e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.33095972]
curr_Stock_Price:  99.3395533742431
curr_Factors:  [99.33955337]
mat_Sqrt:  [[0.15]]
grads:  [0.12040403]
Stock Position:  0.12040402604659306
Bond Position:  [-20.2918419]


portfolio before change:  [-8.21959737]
curr_Stock_Price:  100.30659703819508
curr_Factors:  [100.30659704]
mat_Sqrt:  [[0.15]]
grads:  [-0.04077531]
Stock Position:  -0.040775305503143
Bond Position:  [-4.12956523]


portfolio before change:  [-8.21203332]
curr_Stock_Price:  100.09576927519976
curr_Factors:  [100.09576928]
mat_Sqrt:  [[0.15]]
grads:  [-0.05340552]
Stock Position:  -0.05340552225798323
Bond Position:  [-2.86636649]


portfolio before change:  [-8.34039432]
curr_Stock_Price:  102.4858650365357
curr_Factors:  [102.48586504]
mat_Sqrt:  [[0.15]]
grads:  [0.01495475]
Stock Position:  0.014954748013459496
Bond Position:  [-9.8730446]


portfolio before change:  [-8.33019497]
curr_Stock_Price:  103.3329485021336
curr_Factors:  [103.3329485]
mat_Sqrt:  [[0.15]]
grads:  [0.03579112]
Stock Position:  0.03579111765089713
Bond Position:  [-12.02859668]


portfolio before change:  [-8.34180583]
curr_Stock_Price:  103.09257224054433
curr_Factors:  [103.09257224]
mat_Sqrt:  [[0.15]]
grads:  [-0.10946166]
Stock Position:  -0.10946165946886972
Bond Position:  [2.94287821]


portfolio before change:  [-8.29895016]
curr_Stock_Price:  102.70778131860558
curr_Factors:  [102.70778132]
mat_Sqrt:  [[0.15]]
grads:  [-0.01896974]
Stock Position:  -0.018969744245765145
Bond Position:  [-6.35060982]


portfolio before change:  [-8.30870649]
curr_Stock_Price:  103.13838665543028
curr_Factors:  [103.13838666]
mat_Sqrt:  [[0.15]]
grads:  [0.00491928]
Stock Position:  0.004919276600149313
Bond Position:  [-8.81607274]


portfolio before change:  [-8.31726158]
curr_Stock_Price:  101.84738346679597
curr_Factors:  [101.84738347]
mat_Sqrt:  [[0.15]]
grads:  [-0.00462367]
Stock Position:  -0.004623666460424559
Bond Position:  [-7.84635325]


portfolio before change:  [-8.31643595]
curr_Stock_Price:  101.24451518885897
curr_Factors:  [101.24451519]
mat_Sqrt:  [[0.15]]
grads:  [0.06450231]
Stock Position:  0.06450231209312632
Bond Position:  [-14.84694127]


portfolio before change:  [-8.37992277]
curr_Stock_Price:  100.31781007944414
curr_Factors:  [100.31781008]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910269]
Stock Position:  -0.019102692577626583
Bond Position:  [-6.46358249]


portfolio before change:  [-8.38577861]
curr_Stock_Price:  100.5397546041806
curr_Factors:  [100.5397546]
mat_Sqrt:  [[0.15]]
grads:  [-0.15526369]
Stock Position:  -0.15526369490780234
Bond Position:  [7.22439517]


portfolio before change:  [-8.58141636]
curr_Stock_Price:  101.81142393583387
curr_Factors:  [101.81142394]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151597]
Stock Position:  -0.0015159655860578643
Bond Position:  [-8.42707375]


portfolio before change:  [-8.58616416]
curr_Stock_Price:  103.55338974191338
curr_Factors:  [103.55338974]
mat_Sqrt:  [[0.15]]
grads:  [-0.13217939]
Stock Position:  -0.1321793933898649
Bond Position:  [5.10146008]


portfolio before change:  [-8.42887457]
curr_Stock_Price:  102.3730691020675
curr_Factors:  [102.3730691]
mat_Sqrt:  [[0.15]]
grads:  [0.00100397]
Stock Position:  0.0010039746417256632
Bond Position:  [-8.53165453]


portfolio before change:  [-8.43266522]
curr_Stock_Price:  100.7221592029217
curr_Factors:  [100.7221592]
mat_Sqrt:  [[0.15]]
grads:  [0.07100771]
Stock Position:  0.07100771212011023
Bond Position:  [-15.5847153]


portfolio before change:  [-8.59056851]
curr_Stock_Price:  98.55328739645086
curr_Factors:  [98.5532874]
mat_Sqrt:  [[0.15]]
grads:  [0.33024207]
Stock Position:  0.33024206897224617
Bond Position:  [-41.13701004]


portfolio before change:  [-8.96971682]
curr_Stock_Price:  97.43634073023227
curr_Factors:  [97.43634073]
mat_Sqrt:  [[0.15]]
grads:  [0.1373206]
Stock Position:  0.1373206040834665
Bond Position:  [-22.34973399]


portfolio before change:  [-8.79623977]
curr_Stock_Price:  98.74033428571614
curr_Factors:  [98.74033429]
mat_Sqrt:  [[0.15]]
grads:  [0.02601788]
Stock Position:  0.02601788049500054
Bond Position:  [-11.36525399]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.79623977]
Stock Price:  97.35608276334708
PL:  [-8.79623977]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.29378849e+00]
 [ 1.24351457e-02]
 [ 4.17392948e-03]
 [-9.99637800e-03]
 [ 3.17818969e-03]
 [ 8.55553838e-03]
 [ 4.10218239e-03]
 [-1.45717176e-02]
 [ 6.75847165e-04]
 [ 2.37840661e-04]
 [-3.72335778e-02]
 [-9.64985382e-04]
 [-2.63549336e-02]
 [ 2.55185011e-03]
 [ 1.84456105e-03]
 [-2.47075948e-03]
 [ 1.18539988e-02]
 [ 4.51932841e-02]
 [ 1.57109260e-02]
 [ 7.79261445e-04]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.29378849]
mat_Sqrt:  [[0.15]]
grads:  [15.29192329]
init_Out:  [2.15034764]
Stock Position:  15.291923293232184
Bond position:  [-1527.04198169]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.80851801]
curr_Stock_Price:  99.50450592255761
curr_Factors:  [99.50450592]
mat_Sqrt:  [[0.15]]
grads:  [0.08290097]
Stock Position:  0.08290097111239214
Bond Position:  [-14.05753818]


portfolio before change:  [-5.80697155]
curr_Stock_Price:  99.56555806940513
curr_Factors:  [99.56555807]
mat_Sqrt:  [[0.15]]
grads:  [0.0278262]
Stock Position:  0.027826196521516744
Bond Position:  [-8.57750234]


portfolio before change:  [-5.79089325]
curr_Stock_Price:  100.22044268553692
curr_Factors:  [100.22044269]
mat_Sqrt:  [[0.15]]
grads:  [-0.06664252]
Stock Position:  -0.06664251999825377
Bond Position:  [0.88804961]


portfolio before change:  [-5.77961229]
curr_Stock_Price:  100.05449877862328
curr_Factors:  [100.05449878]
mat_Sqrt:  [[0.15]]
grads:  [0.02118793]
Stock Position:  0.021187931277069662
Bond Position:  [-7.89956013]


portfolio before change:  [-5.81650763]
curr_Stock_Price:  98.40638103206453
curr_Factors:  [98.40638103]
mat_Sqrt:  [[0.15]]
grads:  [0.05703692]
Stock Position:  0.057036922554044744
Bond Position:  [-11.42930476]


portfolio before change:  [-5.78875552]
curr_Stock_Price:  98.9430472799907
curr_Factors:  [98.94304728]
mat_Sqrt:  [[0.15]]
grads:  [0.02734788]
Stock Position:  0.027347882589855793
Bond Position:  [-8.49463836]


portfolio before change:  [-5.80350933]
curr_Stock_Price:  98.48122420131847
curr_Factors:  [98.4812242]
mat_Sqrt:  [[0.15]]
grads:  [-0.09714478]
Stock Position:  -0.09714478422098909
Bond Position:  [3.76342795]


portfolio before change:  [-5.83812006]
curr_Stock_Price:  98.84719034140794
curr_Factors:  [98.84719034]
mat_Sqrt:  [[0.15]]
grads:  [0.00450565]
Stock Position:  0.004505647767152867
Bond Position:  [-6.28349068]


portfolio before change:  [-5.83941832]
curr_Stock_Price:  98.90773779417371
curr_Factors:  [98.90773779]
mat_Sqrt:  [[0.15]]
grads:  [0.0015856]
Stock Position:  0.0015856044041779975
Bond Position:  [-5.99624686]


portfolio before change:  [-5.84281363]
curr_Stock_Price:  97.71194101619368
curr_Factors:  [97.71194102]
mat_Sqrt:  [[0.15]]
grads:  [-0.24822385]
Stock Position:  -0.24822385172476527
Bond Position:  [18.41162073]


portfolio before change:  [-5.73563967]
curr_Stock_Price:  97.29872336541173
curr_Factors:  [97.29872337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00643324]
Stock Position:  -0.0064332358782303225
Bond Position:  [-5.10969403]


portfolio before change:  [-5.73339867]
curr_Stock_Price:  96.75178498124562
curr_Factors:  [96.75178498]
mat_Sqrt:  [[0.15]]
grads:  [-0.17569956]
Stock Position:  -0.17569955713899696
Bond Position:  [11.2658471]


portfolio before change:  [-6.01661904]
curr_Stock_Price:  98.37977532845238
curr_Factors:  [98.37977533]
mat_Sqrt:  [[0.15]]
grads:  [0.01701233]
Stock Position:  0.01701233408590921
Bond Position:  [-7.69028865]


portfolio before change:  [-6.02764418]
curr_Stock_Price:  97.84473237662328
curr_Factors:  [97.84473238]
mat_Sqrt:  [[0.15]]
grads:  [0.01229707]
Stock Position:  0.012297073655791364
Bond Position:  [-7.23084806]


portfolio before change:  [-6.02084674]
curr_Stock_Price:  98.54452312596322
curr_Factors:  [98.54452313]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647173]
Stock Position:  -0.01647172985941792
Bond Position:  [-4.39764798]


portfolio before change:  [-6.00422473]
curr_Stock_Price:  97.46864606825834
curr_Factors:  [97.46864607]
mat_Sqrt:  [[0.15]]
grads:  [0.07902666]
Stock Position:  0.07902665834917068
Bond Position:  [-13.70684613]


portfolio before change:  [-6.11595862]
curr_Stock_Price:  96.09813702213796
curr_Factors:  [96.09813702]
mat_Sqrt:  [[0.15]]
grads:  [0.30128856]
Stock Position:  0.3012885608746428
Bond Position:  [-35.06922803]


portfolio before change:  [-6.74624538]
curr_Stock_Price:  94.0352696251334
curr_Factors:  [94.03526963]
mat_Sqrt:  [[0.15]]
grads:  [0.10473951]
Stock Position:  0.10473950658280186
Bond Position:  [-16.59545312]


portfolio before change:  [-6.82836434]
curr_Stock_Price:  93.29085536103975
curr_Factors:  [93.29085536]
mat_Sqrt:  [[0.15]]
grads:  [0.00519508]
Stock Position:  0.005195076303158691
Bond Position:  [-7.31301745]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.82836434]
Stock Price:  94.27029742305946
PL:  [-6.82836434]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.8852082977657869
FINAL STD P&L:  16.95764055629079
