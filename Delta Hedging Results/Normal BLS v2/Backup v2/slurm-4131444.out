WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 13:41:50.440375: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 13:41:50.468276: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 13:41:50.477325: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 13:41:50.479506: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 13:41:50.481446: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 13:41:50.482153: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 13:41:50.484575: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 13:41:50.486561: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 13:41:50.491626: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 13:41:50.493679: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 13:41:50.494116: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 13:41:50.500649: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399940000 Hz
2019-12-18 13:41:50.500866: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559377a717d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 13:41:50.500883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 13:41:50.501976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 13:41:50.502007: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 13:41:50.502020: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 13:41:50.502032: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 13:41:50.502043: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 13:41:50.502053: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 13:41:50.502064: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 13:41:50.502075: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 13:41:50.503973: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 13:41:50.504002: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 13:41:50.598482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 13:41:50.598525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 13:41:50.598554: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 13:41:50.601649: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-18 13:41:50.603889: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5593780b0510 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 13:41:50.603907: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 13:41:58.105154: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 2.8924e+02,   Y0: 2.3778e+00,  elapsed time   7
INFO   step:     1,    loss: 1.2151e+01,   Y0: 2.3728e+00,  elapsed time  10
INFO   step:     2,    loss: 9.1172e+00,   Y0: 2.3678e+00,  elapsed time  10
INFO   step:     3,    loss: 9.1440e+00,   Y0: 2.3629e+00,  elapsed time  10
INFO   step:     4,    loss: 9.1235e+00,   Y0: 2.3580e+00,  elapsed time  10
INFO   step:     5,    loss: 9.1304e+00,   Y0: 2.3532e+00,  elapsed time  10
INFO   step:     6,    loss: 9.1368e+00,   Y0: 2.3483e+00,  elapsed time  10
INFO   step:     7,    loss: 9.1313e+00,   Y0: 2.3435e+00,  elapsed time  10
INFO   step:     8,    loss: 9.1199e+00,   Y0: 2.3388e+00,  elapsed time  10
INFO   step:     9,    loss: 9.1135e+00,   Y0: 2.3341e+00,  elapsed time  10
INFO   step:    10,    loss: 9.0993e+00,   Y0: 2.3294e+00,  elapsed time  10
INFO   step:    11,    loss: 9.0839e+00,   Y0: 2.3246e+00,  elapsed time  10
INFO   step:    12,    loss: 9.0707e+00,   Y0: 2.3199e+00,  elapsed time  10
INFO   step:    13,    loss: 9.0651e+00,   Y0: 2.3151e+00,  elapsed time  11
INFO   step:    14,    loss: 9.0605e+00,   Y0: 2.3104e+00,  elapsed time  11
INFO   step:    15,    loss: 9.0564e+00,   Y0: 2.3057e+00,  elapsed time  11
INFO   step:    16,    loss: 9.0518e+00,   Y0: 2.3011e+00,  elapsed time  11
INFO   step:    17,    loss: 9.0454e+00,   Y0: 2.2965e+00,  elapsed time  11
INFO   step:    18,    loss: 9.0367e+00,   Y0: 2.2920e+00,  elapsed time  11
INFO   step:    19,    loss: 9.0296e+00,   Y0: 2.2874e+00,  elapsed time  11
INFO   step:    20,    loss: 9.0243e+00,   Y0: 2.2829e+00,  elapsed time  11
INFO   step:    21,    loss: 9.0193e+00,   Y0: 2.2786e+00,  elapsed time  11
INFO   step:    22,    loss: 9.0151e+00,   Y0: 2.2744e+00,  elapsed time  11
INFO   step:    23,    loss: 9.0110e+00,   Y0: 2.2701e+00,  elapsed time  11
INFO   step:    24,    loss: 9.0071e+00,   Y0: 2.2659e+00,  elapsed time  11
INFO   step:    25,    loss: 9.0039e+00,   Y0: 2.2618e+00,  elapsed time  11
INFO   step:    26,    loss: 9.0012e+00,   Y0: 2.2579e+00,  elapsed time  11
INFO   step:    27,    loss: 8.9986e+00,   Y0: 2.2539e+00,  elapsed time  11
INFO   step:    28,    loss: 8.9963e+00,   Y0: 2.2504e+00,  elapsed time  11
INFO   step:    29,    loss: 8.9942e+00,   Y0: 2.2467e+00,  elapsed time  11
INFO   step:    30,    loss: 8.9924e+00,   Y0: 2.2431e+00,  elapsed time  11
INFO   step:    31,    loss: 8.9906e+00,   Y0: 2.2394e+00,  elapsed time  11
INFO   step:    32,    loss: 8.9889e+00,   Y0: 2.2356e+00,  elapsed time  11
INFO   step:    33,    loss: 8.9873e+00,   Y0: 2.2321e+00,  elapsed time  11
INFO   step:    34,    loss: 8.9859e+00,   Y0: 2.2286e+00,  elapsed time  12
INFO   step:    35,    loss: 8.9845e+00,   Y0: 2.2254e+00,  elapsed time  12
INFO   step:    36,    loss: 8.9830e+00,   Y0: 2.2220e+00,  elapsed time  12
INFO   step:    37,    loss: 8.9818e+00,   Y0: 2.2186e+00,  elapsed time  12
INFO   step:    38,    loss: 8.9806e+00,   Y0: 2.2153e+00,  elapsed time  12
INFO   step:    39,    loss: 8.9794e+00,   Y0: 2.2123e+00,  elapsed time  12
INFO   step:    40,    loss: 8.9781e+00,   Y0: 2.2091e+00,  elapsed time  12
INFO   step:    41,    loss: 8.9769e+00,   Y0: 2.2059e+00,  elapsed time  12
INFO   step:    42,    loss: 8.9757e+00,   Y0: 2.2027e+00,  elapsed time  12
INFO   step:    43,    loss: 8.9747e+00,   Y0: 2.1995e+00,  elapsed time  12
INFO   step:    44,    loss: 8.9735e+00,   Y0: 2.1962e+00,  elapsed time  12
INFO   step:    45,    loss: 8.9723e+00,   Y0: 2.1930e+00,  elapsed time  12
INFO   step:    46,    loss: 8.9711e+00,   Y0: 2.1901e+00,  elapsed time  12
INFO   step:    47,    loss: 8.9701e+00,   Y0: 2.1875e+00,  elapsed time  12
INFO   step:    48,    loss: 8.9691e+00,   Y0: 2.1849e+00,  elapsed time  12
INFO   step:    49,    loss: 8.9682e+00,   Y0: 2.1822e+00,  elapsed time  12
INFO   step:    50,    loss: 8.9672e+00,   Y0: 2.1796e+00,  elapsed time  12
INFO   step:    51,    loss: 8.9662e+00,   Y0: 2.1770e+00,  elapsed time  12
INFO   step:    52,    loss: 8.9654e+00,   Y0: 2.1745e+00,  elapsed time  12
INFO   step:    53,    loss: 8.9645e+00,   Y0: 2.1722e+00,  elapsed time  12
INFO   step:    54,    loss: 8.9638e+00,   Y0: 2.1702e+00,  elapsed time  12
INFO   step:    55,    loss: 8.9631e+00,   Y0: 2.1683e+00,  elapsed time  13
INFO   step:    56,    loss: 8.9625e+00,   Y0: 2.1666e+00,  elapsed time  13
INFO   step:    57,    loss: 8.9618e+00,   Y0: 2.1648e+00,  elapsed time  13
INFO   step:    58,    loss: 8.9612e+00,   Y0: 2.1631e+00,  elapsed time  13
INFO   step:    59,    loss: 8.9606e+00,   Y0: 2.1615e+00,  elapsed time  13
INFO   step:    60,    loss: 8.9600e+00,   Y0: 2.1601e+00,  elapsed time  13
INFO   step:    61,    loss: 8.9595e+00,   Y0: 2.1590e+00,  elapsed time  13
INFO   step:    62,    loss: 8.9590e+00,   Y0: 2.1580e+00,  elapsed time  13
INFO   step:    63,    loss: 8.9585e+00,   Y0: 2.1569e+00,  elapsed time  13
INFO   step:    64,    loss: 8.9580e+00,   Y0: 2.1559e+00,  elapsed time  13
INFO   step:    65,    loss: 8.9575e+00,   Y0: 2.1549e+00,  elapsed time  13
INFO   step:    66,    loss: 8.9570e+00,   Y0: 2.1539e+00,  elapsed time  13
INFO   step:    67,    loss: 8.9566e+00,   Y0: 2.1530e+00,  elapsed time  13
INFO   step:    68,    loss: 8.9561e+00,   Y0: 2.1522e+00,  elapsed time  13
INFO   step:    69,    loss: 8.9557e+00,   Y0: 2.1513e+00,  elapsed time  13
INFO   step:    70,    loss: 8.9553e+00,   Y0: 2.1505e+00,  elapsed time  13
INFO   step:    71,    loss: 8.9548e+00,   Y0: 2.1498e+00,  elapsed time  13
INFO   step:    72,    loss: 8.9544e+00,   Y0: 2.1493e+00,  elapsed time  13
INFO   step:    73,    loss: 8.9541e+00,   Y0: 2.1489e+00,  elapsed time  13
INFO   step:    74,    loss: 8.9537e+00,   Y0: 2.1485e+00,  elapsed time  13
INFO   step:    75,    loss: 8.9533e+00,   Y0: 2.1480e+00,  elapsed time  14
INFO   step:    76,    loss: 8.9530e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    77,    loss: 8.9527e+00,   Y0: 2.1475e+00,  elapsed time  14
INFO   step:    78,    loss: 8.9524e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    79,    loss: 8.9521e+00,   Y0: 2.1478e+00,  elapsed time  14
INFO   step:    80,    loss: 8.9518e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    81,    loss: 8.9515e+00,   Y0: 2.1479e+00,  elapsed time  14
INFO   step:    82,    loss: 8.9513e+00,   Y0: 2.1479e+00,  elapsed time  14
INFO   step:    83,    loss: 8.9510e+00,   Y0: 2.1478e+00,  elapsed time  14
INFO   step:    84,    loss: 8.9507e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    85,    loss: 8.9504e+00,   Y0: 2.1476e+00,  elapsed time  14
INFO   step:    86,    loss: 8.9501e+00,   Y0: 2.1479e+00,  elapsed time  14
INFO   step:    87,    loss: 8.9498e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    88,    loss: 8.9495e+00,   Y0: 2.1475e+00,  elapsed time  14
INFO   step:    89,    loss: 8.9493e+00,   Y0: 2.1476e+00,  elapsed time  14
INFO   step:    90,    loss: 8.9490e+00,   Y0: 2.1477e+00,  elapsed time  14
INFO   step:    91,    loss: 8.9487e+00,   Y0: 2.1474e+00,  elapsed time  14
INFO   step:    92,    loss: 8.9484e+00,   Y0: 2.1470e+00,  elapsed time  14
INFO   step:    93,    loss: 8.9481e+00,   Y0: 2.1466e+00,  elapsed time  14
INFO   step:    94,    loss: 8.9477e+00,   Y0: 2.1461e+00,  elapsed time  14
INFO   step:    95,    loss: 8.9474e+00,   Y0: 2.1455e+00,  elapsed time  14
INFO   step:    96,    loss: 8.9470e+00,   Y0: 2.1450e+00,  elapsed time  15
INFO   step:    97,    loss: 8.9467e+00,   Y0: 2.1446e+00,  elapsed time  15
INFO   step:    98,    loss: 8.9464e+00,   Y0: 2.1440e+00,  elapsed time  15
INFO   step:    99,    loss: 8.9461e+00,   Y0: 2.1437e+00,  elapsed time  15
INFO   step:   100,    loss: 8.9458e+00,   Y0: 2.1435e+00,  elapsed time  15
INFO   step:   101,    loss: 8.9456e+00,   Y0: 2.1436e+00,  elapsed time  15
INFO   step:   102,    loss: 8.9453e+00,   Y0: 2.1434e+00,  elapsed time  15
INFO   step:   103,    loss: 8.9450e+00,   Y0: 2.1432e+00,  elapsed time  15
INFO   step:   104,    loss: 8.9447e+00,   Y0: 2.1428e+00,  elapsed time  15
INFO   step:   105,    loss: 8.9444e+00,   Y0: 2.1427e+00,  elapsed time  15
INFO   step:   106,    loss: 8.9442e+00,   Y0: 2.1428e+00,  elapsed time  15
INFO   step:   107,    loss: 8.9440e+00,   Y0: 2.1430e+00,  elapsed time  15
INFO   step:   108,    loss: 8.9437e+00,   Y0: 2.1431e+00,  elapsed time  15
INFO   step:   109,    loss: 8.9434e+00,   Y0: 2.1427e+00,  elapsed time  15
INFO   step:   110,    loss: 8.9431e+00,   Y0: 2.1426e+00,  elapsed time  15
INFO   step:   111,    loss: 8.9429e+00,   Y0: 2.1423e+00,  elapsed time  15
INFO   step:   112,    loss: 8.9427e+00,   Y0: 2.1426e+00,  elapsed time  15
INFO   step:   113,    loss: 8.9424e+00,   Y0: 2.1428e+00,  elapsed time  15
INFO   step:   114,    loss: 8.9422e+00,   Y0: 2.1428e+00,  elapsed time  15
INFO   step:   115,    loss: 8.9419e+00,   Y0: 2.1426e+00,  elapsed time  15
INFO   step:   116,    loss: 8.9416e+00,   Y0: 2.1422e+00,  elapsed time  15
INFO   step:   117,    loss: 8.9413e+00,   Y0: 2.1415e+00,  elapsed time  16
INFO   step:   118,    loss: 8.9410e+00,   Y0: 2.1409e+00,  elapsed time  16
INFO   step:   119,    loss: 8.9406e+00,   Y0: 2.1401e+00,  elapsed time  16
INFO   step:   120,    loss: 8.9403e+00,   Y0: 2.1393e+00,  elapsed time  16
INFO   step:   121,    loss: 8.9400e+00,   Y0: 2.1388e+00,  elapsed time  16
INFO   step:   122,    loss: 8.9397e+00,   Y0: 2.1382e+00,  elapsed time  16
INFO   step:   123,    loss: 8.9394e+00,   Y0: 2.1379e+00,  elapsed time  16
INFO   step:   124,    loss: 8.9392e+00,   Y0: 2.1376e+00,  elapsed time  16
INFO   step:   125,    loss: 8.9389e+00,   Y0: 2.1377e+00,  elapsed time  16
INFO   step:   126,    loss: 8.9388e+00,   Y0: 2.1382e+00,  elapsed time  16
INFO   step:   127,    loss: 8.9386e+00,   Y0: 2.1384e+00,  elapsed time  16
INFO   step:   128,    loss: 8.9383e+00,   Y0: 2.1385e+00,  elapsed time  16
INFO   step:   129,    loss: 8.9381e+00,   Y0: 2.1382e+00,  elapsed time  16
INFO   step:   130,    loss: 8.9378e+00,   Y0: 2.1380e+00,  elapsed time  16
INFO   step:   131,    loss: 8.9376e+00,   Y0: 2.1381e+00,  elapsed time  16
INFO   step:   132,    loss: 8.9374e+00,   Y0: 2.1382e+00,  elapsed time  16
INFO   step:   133,    loss: 8.9372e+00,   Y0: 2.1384e+00,  elapsed time  16
INFO   step:   134,    loss: 8.9370e+00,   Y0: 2.1391e+00,  elapsed time  16
INFO   step:   135,    loss: 8.9369e+00,   Y0: 2.1395e+00,  elapsed time  16
INFO   step:   136,    loss: 8.9367e+00,   Y0: 2.1398e+00,  elapsed time  16
INFO   step:   137,    loss: 8.9365e+00,   Y0: 2.1401e+00,  elapsed time  16
INFO   step:   138,    loss: 8.9363e+00,   Y0: 2.1404e+00,  elapsed time  17
INFO   step:   139,    loss: 8.9361e+00,   Y0: 2.1404e+00,  elapsed time  17
INFO   step:   140,    loss: 8.9359e+00,   Y0: 2.1405e+00,  elapsed time  17
INFO   step:   141,    loss: 8.9357e+00,   Y0: 2.1409e+00,  elapsed time  17
INFO   step:   142,    loss: 8.9355e+00,   Y0: 2.1411e+00,  elapsed time  17
INFO   step:   143,    loss: 8.9354e+00,   Y0: 2.1417e+00,  elapsed time  17
INFO   step:   144,    loss: 8.9352e+00,   Y0: 2.1422e+00,  elapsed time  17
INFO   step:   145,    loss: 8.9351e+00,   Y0: 2.1426e+00,  elapsed time  17
INFO   step:   146,    loss: 8.9349e+00,   Y0: 2.1435e+00,  elapsed time  17
INFO   step:   147,    loss: 8.9348e+00,   Y0: 2.1444e+00,  elapsed time  17
INFO   step:   148,    loss: 8.9347e+00,   Y0: 2.1452e+00,  elapsed time  17
INFO   step:   149,    loss: 8.9346e+00,   Y0: 2.1462e+00,  elapsed time  17
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  10
# of dimensions:  1
Loss out:  9.448977904732862
Output_Z_Vals:  [[[ 2.31242175e+00]
  [ 2.31242175e+00]
  [ 2.31242175e+00]
  ...
  [ 2.31242175e+00]
  [ 2.31242175e+00]
  [ 2.31242175e+00]]

 [[ 1.72123147e-02]
  [ 4.00939154e-03]
  [-3.57595363e-03]
  ...
  [-2.84590231e-03]
  [ 1.84029122e-02]
  [ 1.84230474e-02]]

 [[-1.86154418e-02]
  [-1.84143808e-02]
  [-4.97696858e-03]
  ...
  [-1.46256829e-02]
  [-1.86257533e-02]
  [-1.86446616e-02]]

 ...

 [[ 2.95313767e-03]
  [-2.48197596e-02]
  [-3.17405092e-02]
  ...
  [-3.03590990e-02]
  [-2.70216932e-02]
  [ 7.81987644e-04]]

 [[ 5.53054317e-03]
  [-2.23121643e-03]
  [ 2.89259401e-03]
  ...
  [ 2.17245050e-03]
  [ 1.85241039e-03]
  [ 1.25157092e-02]]

 [[ 8.48363330e-03]
  [ 8.54429491e-03]
  [ 8.46436647e-03]
  ...
  [ 8.52418732e-03]
  [ 8.35101278e-03]
  [ 7.58911610e-03]]]
Z_Vals dimensionality:  (10, 200, 1)
X_test:  [[[100.          99.08907389  98.75462909 ...  99.20718712  98.03928102
    98.20720452]]

 [[100.          99.31440376  98.63712059 ...  95.94917353  95.33240515
    93.3823071 ]]

 [[100.          99.60662669 100.6735661  ...  98.33215806  97.32185439
    96.65909191]]

 ...

 [[100.          99.46480206  97.41682988 ...  97.68089119  96.6135028
    98.1008569 ]]

 [[100.          98.58697432  98.76065559 ...  97.44112791 100.52139875
   102.36155142]]

 [[100.          98.59370775  98.7717064  ... 101.45073585 101.7124348
   102.15710766]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.72123147e-02]
 [-1.86154418e-02]
 [-1.51880589e-02]
 [ 4.65244153e-05]
 [ 6.56876460e-03]
 [ 1.85709992e-02]
 [ 2.95313767e-03]
 [ 5.53054317e-03]
 [ 8.48363330e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.66553039]
curr_Stock_Price:  99.08907389306283
curr_Factors:  [99.08907389]
mat_Sqrt:  [[0.15]]
grads:  [0.11474876]
Stock Position:  0.11474876453981853
Bond Position:  [-24.0358792]


portfolio before change:  [-12.71592846]
curr_Stock_Price:  98.75462909402101
curr_Factors:  [98.75462909]
mat_Sqrt:  [[0.15]]
grads:  [-0.12410295]
Stock Position:  -0.12410294531274162
Bond Position:  [-0.46018813]


portfolio before change:  [-12.62686955]
curr_Stock_Price:  98.03515333117458
curr_Factors:  [98.03515333]
mat_Sqrt:  [[0.15]]
grads:  [-0.10125373]
Stock Position:  -0.10125372619596706
Bond Position:  [-2.70044498]


portfolio before change:  [-12.59732359]
curr_Stock_Price:  97.73001366812625
curr_Factors:  [97.73001367]
mat_Sqrt:  [[0.15]]
grads:  [0.00031016]
Stock Position:  0.0003101627683461082
Bond Position:  [-12.6276358]


portfolio before change:  [-12.60345343]
curr_Stock_Price:  98.32824756100025
curr_Factors:  [98.32824756]
mat_Sqrt:  [[0.15]]
grads:  [0.04379176]
Stock Position:  0.04379176399751087
Bond Position:  [-16.90942085]


portfolio before change:  [-12.5884032]
curr_Stock_Price:  98.86503934358316
curr_Factors:  [98.86503934]
mat_Sqrt:  [[0.15]]
grads:  [0.12380666]
Stock Position:  0.12380666140150971
Bond Position:  [-24.82855365]


portfolio before change:  [-12.37284997]
curr_Stock_Price:  100.70638303110736
curr_Factors:  [100.70638303]
mat_Sqrt:  [[0.15]]
grads:  [0.01968758]
Stock Position:  0.01968758446514727
Bond Position:  [-14.35551539]


portfolio before change:  [-12.40954506]
curr_Stock_Price:  99.20718712215579
curr_Factors:  [99.20718712]
mat_Sqrt:  [[0.15]]
grads:  [0.03687029]
Stock Position:  0.03687028777698657
Bond Position:  [-16.0673426]


portfolio before change:  [-12.46064178]
curr_Stock_Price:  98.0392810177679
curr_Factors:  [98.03928102]
mat_Sqrt:  [[0.15]]
grads:  [0.05655756]
Stock Position:  0.05655755531251007
Bond Position:  [-18.00550384]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.46064178]
Stock Price:  98.20720451565576
PL:  [-12.46064178]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.00939154e-03]
 [-1.84143808e-02]
 [-1.15479212e-02]
 [ 4.91310297e-03]
 [ 7.84470830e-03]
 [ 1.83345658e-02]
 [-2.48197596e-02]
 [-2.23121643e-03]
 [ 8.54429491e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.19181253]
curr_Stock_Price:  99.31440375757907
curr_Factors:  [99.31440376]
mat_Sqrt:  [[0.15]]
grads:  [0.02672928]
Stock Position:  0.02672927693060479
Bond Position:  [-11.84641473]


portfolio before change:  [-9.2158405]
curr_Stock_Price:  98.63712058979954
curr_Factors:  [98.63712059]
mat_Sqrt:  [[0.15]]
grads:  [-0.12276254]
Stock Position:  -0.12276253848324352
Bond Position:  [2.89310281]


portfolio before change:  [-9.34185]
curr_Stock_Price:  99.67535593193719
curr_Factors:  [99.67535593]
mat_Sqrt:  [[0.15]]
grads:  [-0.07698614]
Stock Position:  -0.07698614115425434
Bond Position:  [-1.66822898]


portfolio before change:  [-9.38001846]
curr_Stock_Price:  100.1603021238559
curr_Factors:  [100.16030212]
mat_Sqrt:  [[0.15]]
grads:  [0.03275402]
Stock Position:  0.03275401977630732
Bond Position:  [-12.66067097]


portfolio before change:  [-9.43151454]
curr_Stock_Price:  98.78141271710984
curr_Factors:  [98.78141272]
mat_Sqrt:  [[0.15]]
grads:  [0.05229806]
Stock Position:  0.052298055365350475
Bond Position:  [-14.59759034]


portfolio before change:  [-9.37743966]
curr_Stock_Price:  99.95498417579545
curr_Factors:  [99.95498418]
mat_Sqrt:  [[0.15]]
grads:  [0.12223044]
Stock Position:  0.12223043877772731
Bond Position:  [-21.59498123]


portfolio before change:  [-9.68170171]
curr_Stock_Price:  97.55409398922367
curr_Factors:  [97.55409399]
mat_Sqrt:  [[0.15]]
grads:  [-0.16546506]
Stock Position:  -0.16546506368122121
Bond Position:  [6.46009266]


portfolio before change:  [-9.41291259]
curr_Stock_Price:  95.94917353139554
curr_Factors:  [95.94917353]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487478]
Stock Position:  -0.01487477622510828
Bond Position:  [-7.98569011]


portfolio before change:  [-9.40773214]
curr_Stock_Price:  95.33240515443066
curr_Factors:  [95.33240515]
mat_Sqrt:  [[0.15]]
grads:  [0.05696197]
Stock Position:  0.05696196609930083
Bond Position:  [-14.83805337]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.40773214]
Stock Price:  93.38230710174737
PL:  [-9.40773214]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00357595]
 [-0.00497697]
 [-0.03101551]
 [-0.00235534]
 [-0.00810375]
 [ 0.01715446]
 [-0.03174051]
 [ 0.00289259]
 [ 0.00846437]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.68686149]
curr_Stock_Price:  99.60662668563074
curr_Factors:  [99.60662669]
mat_Sqrt:  [[0.15]]
grads:  [-0.02383969]
Stock Position:  -0.023839690897695297
Bond Position:  [-2.3122703]


portfolio before change:  [-4.71345342]
curr_Stock_Price:  100.67356609618636
curr_Factors:  [100.6735661]
mat_Sqrt:  [[0.15]]
grads:  [-0.03317979]
Stock Position:  -0.033179790509729155
Bond Position:  [-1.37312559]


portfolio before change:  [-4.58080092]
curr_Stock_Price:  96.65487777695014
curr_Factors:  [96.65487778]
mat_Sqrt:  [[0.15]]
grads:  [-0.20677004]
Stock Position:  -0.20677003904146893
Bond Position:  [15.40453193]


portfolio before change:  [-4.59261893]
curr_Stock_Price:  96.74929280358523
curr_Factors:  [96.7492928]
mat_Sqrt:  [[0.15]]
grads:  [-0.01570225]
Stock Position:  -0.015702251390562694
Bond Position:  [-3.07343721]


portfolio before change:  [-4.57299434]
curr_Stock_Price:  95.40160785053733
curr_Factors:  [95.40160785]
mat_Sqrt:  [[0.15]]
grads:  [-0.05402503]
Stock Position:  -0.054025026118187894
Bond Position:  [0.58108001]


portfolio before change:  [-4.58310434]
curr_Stock_Price:  95.59412262770053
curr_Factors:  [95.59412263]
mat_Sqrt:  [[0.15]]
grads:  [0.11436306]
Stock Position:  0.11436305610450898
Bond Position:  [-15.51554035]


portfolio before change:  [-4.49714068]
curr_Stock_Price:  96.41364756754574
curr_Factors:  [96.41364757]
mat_Sqrt:  [[0.15]]
grads:  [-0.21160339]
Stock Position:  -0.21160339464102693
Bond Position:  [15.90431444]


portfolio before change:  [-4.89514986]
curr_Stock_Price:  98.33215805644481
curr_Factors:  [98.33215806]
mat_Sqrt:  [[0.15]]
grads:  [0.01928396]
Stock Position:  0.019283960086147155
Bond Position:  [-6.79138328]


portfolio before change:  [-4.91802906]
curr_Stock_Price:  97.32185439010537
curr_Factors:  [97.32185439]
mat_Sqrt:  [[0.15]]
grads:  [0.05642911]
Stock Position:  0.056429109774572925
Bond Position:  [-10.40981467]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.91802906]
Stock Price:  96.65909190932564
PL:  [-4.91802906]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.74214329e-02]
 [-2.01053643e-02]
 [ 2.91760057e-02]
 [ 7.89231151e-03]
 [ 2.30163479e-03]
 [ 1.64294710e-02]
 [ 9.12442516e-03]
 [ 1.22739507e-02]
 [ 7.12611862e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.46806939]
curr_Stock_Price:  98.32347789003626
curr_Factors:  [98.32347789]
mat_Sqrt:  [[0.15]]
grads:  [0.11614289]
Stock Position:  0.11614288611901447
Bond Position:  [-35.88764189]


portfolio before change:  [-24.39527375]
curr_Stock_Price:  99.10479089821908
curr_Factors:  [99.1047909]
mat_Sqrt:  [[0.15]]
grads:  [-0.13403576]
Stock Position:  -0.13403576219501956
Bond Position:  [-11.11168757]


portfolio before change:  [-24.77828961]
curr_Stock_Price:  101.92089472991157
curr_Factors:  [101.92089473]
mat_Sqrt:  [[0.15]]
grads:  [0.1945067]
Stock Position:  0.1945067044198067
Bond Position:  [-44.60258696]


portfolio before change:  [-24.23897846]
curr_Stock_Price:  104.80829142980113
curr_Factors:  [104.80829143]
mat_Sqrt:  [[0.15]]
grads:  [0.05261541]
Stock Position:  0.05261541007890937
Bond Position:  [-29.7535097]


portfolio before change:  [-24.23044116]
curr_Stock_Price:  105.25336587693586
curr_Factors:  [105.25336588]
mat_Sqrt:  [[0.15]]
grads:  [0.01534423]
Stock Position:  0.015344231906847562
Bond Position:  [-25.84547322]


portfolio before change:  [-24.26062408]
curr_Stock_Price:  104.12871203130099
curr_Factors:  [104.12871203]
mat_Sqrt:  [[0.15]]
grads:  [0.10952981]
Stock Position:  0.10952980689057978
Bond Position:  [-35.6658218]


portfolio before change:  [-24.55265526]
curr_Stock_Price:  101.6253404304794
curr_Factors:  [101.62534043]
mat_Sqrt:  [[0.15]]
grads:  [0.0608295]
Stock Position:  0.06082950104902944
Bond Position:  [-30.73447401]


portfolio before change:  [-24.56060512]
curr_Stock_Price:  101.7473408184883
curr_Factors:  [101.74734082]
mat_Sqrt:  [[0.15]]
grads:  [0.08182634]
Stock Position:  0.08182633784606086
Bond Position:  [-32.8862174]


portfolio before change:  [-24.46817953]
curr_Stock_Price:  103.07787580145596
curr_Factors:  [103.0778758]
mat_Sqrt:  [[0.15]]
grads:  [0.04750746]
Stock Position:  0.04750745747228279
Bond Position:  [-29.36514733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.46817953]
Stock Price:  103.4356385979815
PL:  [-27.90381813]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [2.34571504e-02]
 [1.10265215e-03]
 [9.77290721e-03]
 [2.42974897e-03]
 [1.11330290e-02]
 [1.67154773e-02]
 [3.08131706e-02]
 [3.38558891e-03]
 [5.38857003e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.85317286]
curr_Stock_Price:  101.26333362091474
curr_Factors:  [101.26333362]
mat_Sqrt:  [[0.15]]
grads:  [0.156381]
Stock Position:  0.15638100265213772
Bond Position:  [5.01751122]


portfolio before change:  [21.19301574]
curr_Stock_Price:  103.42045941280705
curr_Factors:  [103.42045941]
mat_Sqrt:  [[0.15]]
grads:  [0.00735101]
Stock Position:  0.0073510143053249
Bond Position:  [20.43277046]


portfolio before change:  [21.18685783]
curr_Stock_Price:  101.19262381059016
curr_Factors:  [101.19262381]
mat_Sqrt:  [[0.15]]
grads:  [0.06515271]
Stock Position:  0.06515271473722697
Bond Position:  [14.59388367]


portfolio before change:  [21.2161011]
curr_Stock_Price:  101.52944029595443
curr_Factors:  [101.5294403]
mat_Sqrt:  [[0.15]]
grads:  [0.01619833]
Stock Position:  0.01619832644120654
Bond Position:  [19.57149408]


portfolio before change:  [21.25323562]
curr_Stock_Price:  103.21765950154683
curr_Factors:  [103.2176595]
mat_Sqrt:  [[0.15]]
grads:  [0.07422019]
Stock Position:  0.07422019343276835
Bond Position:  [13.59240097]


portfolio before change:  [21.26829206]
curr_Stock_Price:  103.32893028910308
curr_Factors:  [103.32893029]
mat_Sqrt:  [[0.15]]
grads:  [0.11143652]
Stock Position:  0.11143651524771647
Bond Position:  [9.75367614]


portfolio before change:  [21.51369372]
curr_Stock_Price:  105.48732159340746
curr_Factors:  [105.48732159]
mat_Sqrt:  [[0.15]]
grads:  [0.20542114]
Stock Position:  0.2054211374435443
Bond Position:  [-0.15563187]


portfolio before change:  [21.5183669]
curr_Stock_Price:  105.5104497603644
curr_Factors:  [105.51044976]
mat_Sqrt:  [[0.15]]
grads:  [0.02257059]
Stock Position:  0.022570592704881817
Bond Position:  [19.13693351]


portfolio before change:  [21.57882856]
curr_Stock_Price:  107.76518896987189
curr_Factors:  [107.76518897]
mat_Sqrt:  [[0.15]]
grads:  [0.0359238]
Stock Position:  0.0359238001966904
Bond Position:  [17.70749344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [21.57882856]
Stock Price:  108.77320103978994
PL:  [12.80562752]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 5.31672739e-02]
 [ 2.56339697e-04]
 [-1.54693397e-02]
 [ 4.72130409e-03]
 [ 7.14967929e-03]
 [ 1.80244325e-02]
 [-1.04518454e-02]
 [ 1.25001852e-02]
 [ 8.41218563e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [33.02775635]
curr_Stock_Price:  102.05306305576507
curr_Factors:  [102.05306306]
mat_Sqrt:  [[0.15]]
grads:  [0.35444849]
Stock Position:  0.3544484923847264
Bond Position:  [-3.144798]


portfolio before change:  [32.6270826]
curr_Stock_Price:  100.92708576727118
curr_Factors:  [100.92708577]
mat_Sqrt:  [[0.15]]
grads:  [0.00170893]
Stock Position:  0.0017089313164558168
Bond Position:  [32.45460514]


portfolio before change:  [32.64199608]
curr_Stock_Price:  100.15591152956344
curr_Factors:  [100.15591153]
mat_Sqrt:  [[0.15]]
grads:  [-0.10312893]
Stock Position:  -0.10312893163098204
Bond Position:  [42.97096823]


portfolio before change:  [32.62640684]
curr_Stock_Price:  100.51546241548988
curr_Factors:  [100.51546242]
mat_Sqrt:  [[0.15]]
grads:  [0.03147536]
Stock Position:  0.03147536058462602
Bond Position:  [29.46264641]


portfolio before change:  [32.57855886]
curr_Stock_Price:  98.52714566910458
curr_Factors:  [98.52714567]
mat_Sqrt:  [[0.15]]
grads:  [0.04766453]
Stock Position:  0.0476645286186087
Bond Position:  [27.8823089]


portfolio before change:  [32.53127211]
curr_Stock_Price:  97.2425136002179
curr_Factors:  [97.2425136]
mat_Sqrt:  [[0.15]]
grads:  [0.12016288]
Stock Position:  0.12016288331738463
Bond Position:  [20.8463313]


portfolio before change:  [32.7760424]
curr_Stock_Price:  99.19273740164938
curr_Factors:  [99.1927374]
mat_Sqrt:  [[0.15]]
grads:  [-0.06967897]
Stock Position:  -0.06967896955101308
Bond Position:  [39.68769013]


portfolio before change:  [32.64474262]
curr_Stock_Price:  101.36195121248727
curr_Factors:  [101.36195121]
mat_Sqrt:  [[0.15]]
grads:  [0.08333457]
Stock Position:  0.08333456800436405
Bond Position:  [24.19778821]


portfolio before change:  [32.54104214]
curr_Stock_Price:  99.97234293458563
curr_Factors:  [99.97234293]
mat_Sqrt:  [[0.15]]
grads:  [0.05608124]
Stock Position:  0.056081237553427636
Bond Position:  [26.93446943]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [32.54104214]
Stock Price:  100.03105965811518
PL:  [32.50998248]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.84261752e-03]
 [-1.88114735e-03]
 [-2.12107685e-02]
 [ 1.93983113e-03]
 [ 7.00692607e-03]
 [ 1.85540812e-02]
 [-1.19679453e-02]
 [ 1.24964968e-02]
 [ 8.39986070e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.42615082]
curr_Stock_Price:  100.00315982057329
curr_Factors:  [100.00315982]
mat_Sqrt:  [[0.15]]
grads:  [-0.01895078]
Stock Position:  -0.018950783490581463
Bond Position:  [3.32128905]


portfolio before change:  [1.41310698]
curr_Stock_Price:  100.77911173036922
curr_Factors:  [100.77911173]
mat_Sqrt:  [[0.15]]
grads:  [-0.01254098]
Stock Position:  -0.012540982366644922
Bond Position:  [2.67697604]


portfolio before change:  [1.45573039]
curr_Stock_Price:  97.48713794390262
curr_Factors:  [97.48713794]
mat_Sqrt:  [[0.15]]
grads:  [-0.14140512]
Stock Position:  -0.14140512352255363
Bond Position:  [15.24091117]


portfolio before change:  [1.29170557]
curr_Stock_Price:  98.70100614479898
curr_Factors:  [98.70100614]
mat_Sqrt:  [[0.15]]
grads:  [0.01293221]
Stock Position:  0.012932207520900484
Bond Position:  [0.01528367]


portfolio before change:  [1.28878943]
curr_Stock_Price:  98.47492131660131
curr_Factors:  [98.47492132]
mat_Sqrt:  [[0.15]]
grads:  [0.04671284]
Stock Position:  0.04671284047791749
Bond Position:  [-3.31125386]


portfolio before change:  [1.32046946]
curr_Stock_Price:  99.18855939773754
curr_Factors:  [99.1885594]
mat_Sqrt:  [[0.15]]
grads:  [0.12369387]
Stock Position:  0.12369387436605223
Bond Position:  [-10.94854775]


portfolio before change:  [1.29238696]
curr_Stock_Price:  99.00579483188615
curr_Factors:  [99.00579483]
mat_Sqrt:  [[0.15]]
grads:  [-0.0797863]
Stock Position:  -0.0797863016775254
Bond Position:  [9.19169317]


portfolio before change:  [1.11067802]
curr_Stock_Price:  101.34085639802419
curr_Factors:  [101.3408564]
mat_Sqrt:  [[0.15]]
grads:  [0.08330998]
Stock Position:  0.08330997852517205
Bond Position:  [-7.33202655]


portfolio before change:  [1.02003423]
curr_Stock_Price:  100.29684144813096
curr_Factors:  [100.29684145]
mat_Sqrt:  [[0.15]]
grads:  [0.05599907]
Stock Position:  0.05599907135780733
Bond Position:  [-4.59649575]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.02003423]
Stock Price:  100.78886629003746
PL:  [0.23116794]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.19292012e-03]
 [-1.86475950e-02]
 [-1.29827818e-02]
 [ 2.10445608e-03]
 [ 4.72149658e-03]
 [ 1.76085599e-02]
 [-3.09678285e-02]
 [-4.29130281e-03]
 [ 8.55838974e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.22519043]
curr_Stock_Price:  99.83117510940924
curr_Factors:  [99.83117511]
mat_Sqrt:  [[0.15]]
grads:  [-0.0279528]
Stock Position:  -0.02795280083048127
Bond Position:  [1.56537053]


portfolio before change:  [-1.19484035]
curr_Stock_Price:  98.77342078398078
curr_Factors:  [98.77342078]
mat_Sqrt:  [[0.15]]
grads:  [-0.1243173]
Stock Position:  -0.12431730009265138
Bond Position:  [11.08440464]


portfolio before change:  [-1.1510049]
curr_Stock_Price:  98.46540361014824
curr_Factors:  [98.46540361]
mat_Sqrt:  [[0.15]]
grads:  [-0.08655188]
Stock Position:  -0.08655187847349514
Bond Position:  [7.37136075]


portfolio before change:  [-1.17620246]
curr_Stock_Price:  98.79912439152051
curr_Factors:  [98.79912439]
mat_Sqrt:  [[0.15]]
grads:  [0.01402971]
Stock Position:  0.014029707172853133
Bond Position:  [-2.56232524]


portfolio before change:  [-1.19170134]
curr_Stock_Price:  97.78574635095138
curr_Factors:  [97.78574635]
mat_Sqrt:  [[0.15]]
grads:  [0.03147664]
Stock Position:  0.03147664384914568
Bond Position:  [-4.26966845]


portfolio before change:  [-1.23575039]
curr_Stock_Price:  96.45416598142855
curr_Factors:  [96.45416598]
mat_Sqrt:  [[0.15]]
grads:  [0.1173904]
Stock Position:  0.117390399318303
Bond Position:  [-12.55854345]


portfolio before change:  [-1.23254106]
curr_Stock_Price:  96.53500880562368
curr_Factors:  [96.53500881]
mat_Sqrt:  [[0.15]]
grads:  [-0.20645219]
Stock Position:  -0.2064521897711364
Bond Position:  [18.6973229]


portfolio before change:  [-0.95254656]
curr_Stock_Price:  95.22408302426149
curr_Factors:  [95.22408302]
mat_Sqrt:  [[0.15]]
grads:  [-0.02860869]
Stock Position:  -0.02860868538329772
Bond Position:  [1.77168927]


portfolio before change:  [-0.92906853]
curr_Stock_Price:  94.43439382907431
curr_Factors:  [94.43439383]
mat_Sqrt:  [[0.15]]
grads:  [0.05705593]
Stock Position:  0.05705593162197075
Bond Position:  [-6.31711084]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.92906853]
Stock Price:  94.60526149008162
PL:  [-0.92906853]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00363611]
 [-0.01814773]
 [-0.0323648 ]
 [-0.00535391]
 [-0.01100162]
 [ 0.01701416]
 [-0.03765819]
 [-0.00461968]
 [ 0.00855036]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.60368953]
curr_Stock_Price:  99.61202180638965
curr_Factors:  [99.61202181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02424073]
Stock Position:  -0.024240729165610243
Bond Position:  [-2.18902149]


portfolio before change:  [-4.57737421]
curr_Stock_Price:  98.4812759255401
curr_Factors:  [98.48127593]
mat_Sqrt:  [[0.15]]
grads:  [-0.12098484]
Stock Position:  -0.12098483521233448
Bond Position:  [7.33736673]


portfolio before change:  [-4.33888139]
curr_Stock_Price:  96.54034488754822
curr_Factors:  [96.54034489]
mat_Sqrt:  [[0.15]]
grads:  [-0.21576534]
Stock Position:  -0.21576534235786898
Bond Position:  [16.49117918]


portfolio before change:  [-4.05345757]
curr_Stock_Price:  95.2557263142377
curr_Factors:  [95.25572631]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569277]
Stock Position:  -0.035692765424695044
Bond Position:  [-0.65351727]


portfolio before change:  [-4.04112019]
curr_Stock_Price:  94.90091455055097
curr_Factors:  [94.90091455]
mat_Sqrt:  [[0.15]]
grads:  [-0.07334414]
Stock Position:  -0.07334413560816995
Bond Position:  [2.91930535]


portfolio before change:  [-4.07115387]
curr_Stock_Price:  95.33031070642295
curr_Factors:  [95.33031071]
mat_Sqrt:  [[0.15]]
grads:  [0.11342771]
Stock Position:  0.1134277064962428
Bond Position:  [-14.88425237]


portfolio before change:  [-4.19047579]
curr_Stock_Price:  94.34397379549459
curr_Factors:  [94.3439738]
mat_Sqrt:  [[0.15]]
grads:  [-0.25105462]
Stock Position:  -0.25105462084716235
Bond Position:  [19.49501478]


portfolio before change:  [-4.37266507]
curr_Stock_Price:  95.10850553201244
curr_Factors:  [95.10850553]
mat_Sqrt:  [[0.15]]
grads:  [-0.03079783]
Stock Position:  -0.03079783386015995
Bond Position:  [-1.44352912]


portfolio before change:  [-4.33622197]
curr_Stock_Price:  93.90176343860483
curr_Factors:  [93.90176344]
mat_Sqrt:  [[0.15]]
grads:  [0.05700237]
Stock Position:  0.057002370207831096
Bond Position:  [-9.68884505]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.33622197]
Stock Price:  92.80907061931197
PL:  [-4.33622197]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 8.31843114e-04]
 [-2.32170850e-02]
 [-1.33008988e-02]
 [ 4.50810469e-03]
 [ 6.80975055e-03]
 [ 1.76440071e-02]
 [-3.34234579e-02]
 [-1.83199564e-03]
 [ 8.53210702e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.27549783]
curr_Stock_Price:  100.51232388246176
curr_Factors:  [100.51232388]
mat_Sqrt:  [[0.15]]
grads:  [0.00554562]
Stock Position:  0.00554562075769538
Bond Position:  [8.7180946]


portfolio before change:  [9.27416446]
curr_Stock_Price:  99.48565742404492
curr_Factors:  [99.48565742]
mat_Sqrt:  [[0.15]]
grads:  [-0.15478057]
Stock Position:  -0.15478056651512886
Bond Position:  [24.67261088]


portfolio before change:  [9.4551149]
curr_Stock_Price:  98.39630202074687
curr_Factors:  [98.39630202]
mat_Sqrt:  [[0.15]]
grads:  [-0.08867266]
Stock Position:  -0.08867265868467229
Bond Position:  [18.1801766]


portfolio before change:  [9.35011453]
curr_Stock_Price:  99.68297516440194
curr_Factors:  [99.68297516]
mat_Sqrt:  [[0.15]]
grads:  [0.03005403]
Stock Position:  0.03005403124434067
Bond Position:  [6.35423928]


portfolio before change:  [9.31481764]
curr_Stock_Price:  98.40278729492468
curr_Factors:  [98.40278729]
mat_Sqrt:  [[0.15]]
grads:  [0.04539834]
Stock Position:  0.04539833700052633
Bond Position:  [4.84749474]


portfolio before change:  [9.23182838]
curr_Stock_Price:  96.5213613453406
curr_Factors:  [96.52136135]
mat_Sqrt:  [[0.15]]
grads:  [0.11762671]
Stock Position:  0.11762671394248456
Bond Position:  [-2.12166218]


portfolio before change:  [9.1431728]
curr_Stock_Price:  95.77667941774197
curr_Factors:  [95.77667942]
mat_Sqrt:  [[0.15]]
grads:  [-0.22282305]
Stock Position:  -0.2228230528770824
Bond Position:  [30.4844249]


portfolio before change:  [9.08867338]
curr_Stock_Price:  96.08968764200796
curr_Factors:  [96.08968764]
mat_Sqrt:  [[0.15]]
grads:  [-0.0122133]
Stock Position:  -0.01221330429628302
Bond Position:  [10.26224597]


portfolio before change:  [9.09357087]
curr_Stock_Price:  96.1089220104941
curr_Factors:  [96.10892201]
mat_Sqrt:  [[0.15]]
grads:  [0.05688071]
Stock Position:  0.05688071343557407
Bond Position:  [3.62682681]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.09357087]
Stock Price:  96.47254992487906
PL:  [9.09357087]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00328105]
 [-0.01837147]
 [-0.0146955 ]
 [ 0.00307701]
 [ 0.01145205]
 [ 0.01703855]
 [ 0.01065738]
 [ 0.01243561]
 [ 0.00745672]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.51283666]
curr_Stock_Price:  99.5530481053004
curr_Factors:  [99.55304811]
mat_Sqrt:  [[0.15]]
grads:  [-0.02187367]
Stock Position:  -0.0218736652149314
Bond Position:  [-3.33524661]


portfolio before change:  [-5.49392145]
curr_Stock_Price:  98.61204221625056
curr_Factors:  [98.61204222]
mat_Sqrt:  [[0.15]]
grads:  [-0.12247647]
Stock Position:  -0.12247647218191068
Bond Position:  [6.5837336]


portfolio before change:  [-5.66383414]
curr_Stock_Price:  100.02623531196174
curr_Factors:  [100.02623531]
mat_Sqrt:  [[0.15]]
grads:  [-0.09796998]
Stock Position:  -0.09796998211003195
Bond Position:  [4.13573434]


portfolio before change:  [-5.95923488]
curr_Stock_Price:  103.06256461995216
curr_Factors:  [103.06256462]
mat_Sqrt:  [[0.15]]
grads:  [0.0205134]
Stock Position:  0.0205133983468045
Bond Position:  [-8.07339833]


portfolio before change:  [-5.96335864]
curr_Stock_Price:  103.05837009591455
curr_Factors:  [103.0583701]
mat_Sqrt:  [[0.15]]
grads:  [0.07634701]
Stock Position:  0.07634700710299487
Bond Position:  [-13.83155675]


portfolio before change:  [-6.00580026]
curr_Stock_Price:  102.59307200705807
curr_Factors:  [102.59307201]
mat_Sqrt:  [[0.15]]
grads:  [0.11359031]
Stock Position:  0.11359031287109606
Bond Position:  [-17.65937941]


portfolio before change:  [-6.09296279]
curr_Stock_Price:  101.90348299087545
curr_Factors:  [101.90348299]
mat_Sqrt:  [[0.15]]
grads:  [0.07104921]
Stock Position:  0.07104920895025953
Bond Position:  [-13.33312465]


portfolio before change:  [-6.16434718]
curr_Stock_Price:  100.99261905451499
curr_Factors:  [100.99261905]
mat_Sqrt:  [[0.15]]
grads:  [0.08290405]
Stock Position:  0.0829040505694144
Bond Position:  [-14.53704438]


portfolio before change:  [-6.09169856]
curr_Stock_Price:  101.95661252747767
curr_Factors:  [101.95661253]
mat_Sqrt:  [[0.15]]
grads:  [0.04971146]
Stock Position:  0.04971145631968251
Bond Position:  [-11.16011025]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.09169856]
Stock Price:  102.61140158438789
PL:  [-8.70310014]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [4.86737696e-03]
 [1.57090648e-03]
 [4.73826595e-02]
 [4.23212310e-03]
 [1.16269787e-02]
 [1.76983020e-02]
 [5.44298724e-04]
 [1.24704772e-02]
 [7.17891924e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.41755036]
curr_Stock_Price:  99.29976080792491
curr_Factors:  [99.29976081]
mat_Sqrt:  [[0.15]]
grads:  [0.03244918]
Stock Position:  0.032449179742485276
Bond Position:  [-12.63974615]


portfolio before change:  [-9.30560747]
curr_Stock_Price:  102.94436270904527
curr_Factors:  [102.94436271]
mat_Sqrt:  [[0.15]]
grads:  [0.01047271]
Stock Position:  0.010472709845502996
Bond Position:  [-10.38371391]


portfolio before change:  [-9.31308979]
curr_Stock_Price:  102.72577885049441
curr_Factors:  [102.72577885]
mat_Sqrt:  [[0.15]]
grads:  [0.3158844]
Stock Position:  0.31588439648732236
Bond Position:  [-41.76256045]


portfolio before change:  [-9.09530746]
curr_Stock_Price:  103.48133637042949
curr_Factors:  [103.48133637]
mat_Sqrt:  [[0.15]]
grads:  [0.02821415]
Stock Position:  0.028214154026933298
Bond Position:  [-12.01494583]


portfolio before change:  [-9.11794047]
curr_Stock_Price:  102.89212751029746
curr_Factors:  [102.89212751]
mat_Sqrt:  [[0.15]]
grads:  [0.07751319]
Stock Position:  0.07751319131825914
Bond Position:  [-17.09343763]


portfolio before change:  [-9.2339749]
curr_Stock_Price:  101.50545291850797
curr_Factors:  [101.50545292]
mat_Sqrt:  [[0.15]]
grads:  [0.11798868]
Stock Position:  0.11798868018481158
Bond Position:  [-21.21046932]


portfolio before change:  [-9.37685692]
curr_Stock_Price:  100.38437810889795
curr_Factors:  [100.38437811]
mat_Sqrt:  [[0.15]]
grads:  [0.00362866]
Stock Position:  0.003628658158802793
Bond Position:  [-9.74111751]


portfolio before change:  [-9.37879795]
curr_Stock_Price:  101.19204540078832
curr_Factors:  [101.1920454]
mat_Sqrt:  [[0.15]]
grads:  [0.08313651]
Stock Position:  0.08313651480846226
Bond Position:  [-17.79155193]


portfolio before change:  [-9.24184725]
curr_Stock_Price:  102.94637321604016
curr_Factors:  [102.94637322]
mat_Sqrt:  [[0.15]]
grads:  [0.04785946]
Stock Position:  0.0478594616025218
Bond Position:  [-14.16880524]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.24184725]
Stock Price:  105.65437713401356
PL:  [-14.89622438]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.02055978]
 [-0.0107137 ]
 [ 0.0625473 ]
 [ 0.01027669]
 [-0.00351442]
 [ 0.01669079]
 [ 0.02482913]
 [ 0.00470128]
 [ 0.00728068]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.73104189]
curr_Stock_Price:  101.19054428416818
curr_Factors:  [101.19054428]
mat_Sqrt:  [[0.15]]
grads:  [0.13706522]
Stock Position:  0.13706521546607658
Bond Position:  [5.86133813]


portfolio before change:  [19.6363061]
curr_Stock_Price:  100.47798423402821
curr_Factors:  [100.47798423]
mat_Sqrt:  [[0.15]]
grads:  [-0.07142464]
Stock Position:  -0.07142463654814234
Bond Position:  [26.8129096]


portfolio before change:  [19.43912892]
curr_Stock_Price:  103.42636440737336
curr_Factors:  [103.42636441]
mat_Sqrt:  [[0.15]]
grads:  [0.41698198]
Stock Position:  0.4169819792086189
Bond Position:  [-23.68780121]


portfolio before change:  [20.36397138]
curr_Stock_Price:  105.67271885306135
curr_Factors:  [105.67271885]
mat_Sqrt:  [[0.15]]
grads:  [0.06851129]
Stock Position:  0.0685112874444253
Bond Position:  [13.12419736]


portfolio before change:  [20.41677054]
curr_Stock_Price:  106.34757729550516
curr_Factors:  [106.3475773]
mat_Sqrt:  [[0.15]]
grads:  [-0.02342945]
Stock Position:  -0.023429453133261835
Bond Position:  [22.90843612]


portfolio before change:  [20.49733574]
curr_Stock_Price:  103.39795138142169
curr_Factors:  [103.39795138]
mat_Sqrt:  [[0.15]]
grads:  [0.11127197]
Stock Position:  0.11127196648822502
Bond Position:  [8.99204236]


portfolio before change:  [20.61837743]
curr_Stock_Price:  104.44533590601033
curr_Factors:  [104.44533591]
mat_Sqrt:  [[0.15]]
grads:  [0.16552755]
Stock Position:  0.1655275511571078
Bond Position:  [3.32979674]


portfolio before change:  [20.65774946]
curr_Stock_Price:  104.67313317599572
curr_Factors:  [104.67313318]
mat_Sqrt:  [[0.15]]
grads:  [0.03134185]
Stock Position:  0.03134185010140071
Bond Position:  [17.37709982]


portfolio before change:  [20.60437684]
curr_Stock_Price:  102.69292635687965
curr_Factors:  [102.69292636]
mat_Sqrt:  [[0.15]]
grads:  [0.04853788]
Stock Position:  0.04853788431899166
Bond Position:  [15.61987946]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.60437684]
Stock Price:  101.92979330632302
PL:  [18.67458354]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.05679897e-04]
 [-1.75201078e-02]
 [-2.43617408e-02]
 [-3.91546337e-03]
 [-2.42686544e-02]
 [ 1.59287239e-02]
 [-5.02053819e-02]
 [-1.68582051e-02]
 [ 8.33235137e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.0301976]
curr_Stock_Price:  99.38975430214298
curr_Factors:  [99.3897543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00270453]
Stock Position:  -0.0027045326437660664
Bond Position:  [-7.76139477]


portfolio before change:  [-8.03063022]
curr_Stock_Price:  98.11446994084068
curr_Factors:  [98.11446994]
mat_Sqrt:  [[0.15]]
grads:  [-0.11680072]
Stock Position:  -0.11680071892007599
Bond Position:  [3.4292104]


portfolio before change:  [-7.9244022]
curr_Stock_Price:  97.21967246717658
curr_Factors:  [97.21967247]
mat_Sqrt:  [[0.15]]
grads:  [-0.16241161]
Stock Position:  -0.16241160561149331
Bond Position:  [7.8652009]


portfolio before change:  [-7.71075886]
curr_Stock_Price:  95.92844851205028
curr_Factors:  [95.92844851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02610309]
Stock Position:  -0.0261030891487044
Bond Position:  [-5.20673002]


portfolio before change:  [-7.62670553]
curr_Stock_Price:  92.60863668447749
curr_Factors:  [92.60863668]
mat_Sqrt:  [[0.15]]
grads:  [-0.16179103]
Stock Position:  -0.1617910293000618
Bond Position:  [7.35654112]


portfolio before change:  [-7.52064243]
curr_Stock_Price:  91.97582094179326
curr_Factors:  [91.97582094]
mat_Sqrt:  [[0.15]]
grads:  [0.10619149]
Stock Position:  0.10619149241152868
Bond Position:  [-17.28769213]


portfolio before change:  [-7.67951896]
curr_Stock_Price:  90.56110758265105
curr_Factors:  [90.56110758]
mat_Sqrt:  [[0.15]]
grads:  [-0.33470255]
Stock Position:  -0.334702546021324
Bond Position:  [22.63151431]


portfolio before change:  [-7.7484591]
curr_Stock_Price:  90.80089878587901
curr_Factors:  [90.80089879]
mat_Sqrt:  [[0.15]]
grads:  [-0.11238803]
Stock Position:  -0.11238803419864635
Bond Position:  [2.45647541]


portfolio before change:  [-7.59212689]
curr_Stock_Price:  89.42082599409541
curr_Factors:  [89.42082599]
mat_Sqrt:  [[0.15]]
grads:  [0.05554901]
Stock Position:  0.05554900915616622
Bond Position:  [-12.55936517]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.59212689]
Stock Price:  91.23771967986325
PL:  [-7.59212689]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00391362]
 [ 0.00326488]
 [ 0.02062724]
 [ 0.00714284]
 [ 0.00378027]
 [ 0.01567551]
 [ 0.04093499]
 [ 0.00336229]
 [ 0.00633334]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.37460929]
curr_Stock_Price:  100.32415177248578
curr_Factors:  [100.32415177]
mat_Sqrt:  [[0.15]]
grads:  [-0.02609079]
Stock Position:  -0.02609079488926247
Bond Position:  [8.99214616]


portfolio before change:  [6.34935657]
curr_Stock_Price:  101.46439758223514
curr_Factors:  [101.46439758]
mat_Sqrt:  [[0.15]]
grads:  [0.02176585]
Stock Position:  0.021765850363639542
Bond Position:  [4.14089768]


portfolio before change:  [6.35437964]
curr_Stock_Price:  101.60002741504086
curr_Factors:  [101.60002742]
mat_Sqrt:  [[0.15]]
grads:  [0.13751491]
Stock Position:  0.13751490887215798
Bond Position:  [-7.61713887]


portfolio before change:  [6.7543899]
curr_Stock_Price:  104.53658016587845
curr_Factors:  [104.53658017]
mat_Sqrt:  [[0.15]]
grads:  [0.04761894]
Stock Position:  0.047618936327700936
Bond Position:  [1.77646915]


portfolio before change:  [6.77616406]
curr_Stock_Price:  104.97518085900616
curr_Factors:  [104.97518086]
mat_Sqrt:  [[0.15]]
grads:  [0.0252018]
Stock Position:  0.025201795157454798
Bond Position:  [4.13060105]


portfolio before change:  [6.80678893]
curr_Stock_Price:  106.1083961063625
curr_Factors:  [106.10839611]
mat_Sqrt:  [[0.15]]
grads:  [0.10450337]
Stock Position:  0.10450336765634378
Bond Position:  [-4.2818958]


portfolio before change:  [6.92392885]
curr_Stock_Price:  107.24980812287902
curr_Factors:  [107.24980812]
mat_Sqrt:  [[0.15]]
grads:  [0.2728999]
Stock Position:  0.272899903507782
Bond Position:  [-22.34453344]


portfolio before change:  [6.4421951]
curr_Stock_Price:  105.52551770919773
curr_Factors:  [105.52551771]
mat_Sqrt:  [[0.15]]
grads:  [0.02241525]
Stock Position:  0.022415253369718637
Bond Position:  [4.07681388]


portfolio before change:  [6.43416804]
curr_Stock_Price:  105.07644936048675
curr_Factors:  [105.07644936]
mat_Sqrt:  [[0.15]]
grads:  [0.04222227]
Stock Position:  0.042222268902481895
Bond Position:  [1.99760193]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.43416804]
Stock Price:  105.86079089021995
PL:  [0.57337714]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-5.12890355e-03]
 [-2.08172412e-02]
 [-1.06616257e-03]
 [ 2.49294808e-03]
 [ 1.02135821e-02]
 [ 1.71193370e-02]
 [ 1.85492673e-02]
 [ 8.78160781e-03]
 [ 6.82889058e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.67245554]
curr_Stock_Price:  100.21373806338025
curr_Factors:  [100.21373806]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419269]
Stock Position:  -0.03419269035757991
Bond Position:  [8.09903286]


portfolio before change:  [4.7115591]
curr_Stock_Price:  99.18857674973306
curr_Factors:  [99.18857675]
mat_Sqrt:  [[0.15]]
grads:  [-0.13878161]
Stock Position:  -0.13878160778878912
Bond Position:  [18.47710925]


portfolio before change:  [4.49828908]
curr_Stock_Price:  100.79189355218136
curr_Factors:  [100.79189355]
mat_Sqrt:  [[0.15]]
grads:  [-0.00710775]
Stock Position:  -0.007107750471454215
Bond Position:  [5.21469271]


portfolio before change:  [4.49599509]
curr_Stock_Price:  101.48156096021442
curr_Factors:  [101.48156096]
mat_Sqrt:  [[0.15]]
grads:  [0.01661965]
Stock Position:  0.016619653852558217
Bond Position:  [2.80940668]


portfolio before change:  [4.46958491]
curr_Stock_Price:  99.80792582551652
curr_Factors:  [99.80792583]
mat_Sqrt:  [[0.15]]
grads:  [0.06809055]
Stock Position:  0.06809054706386808
Bond Position:  [-2.32639136]


portfolio before change:  [4.64780087]
curr_Stock_Price:  102.44235089305208
curr_Factors:  [102.44235089]
mat_Sqrt:  [[0.15]]
grads:  [0.11412891]
Stock Position:  0.11412891352404085
Bond Position:  [-7.04383334]


portfolio before change:  [4.74620104]
curr_Stock_Price:  103.33540217957251
curr_Factors:  [103.33540218]
mat_Sqrt:  [[0.15]]
grads:  [0.12366178]
Stock Position:  0.12366178225012651
Bond Position:  [-8.03243896]


portfolio before change:  [4.69465686]
curr_Stock_Price:  102.95107197548292
curr_Factors:  [102.95107198]
mat_Sqrt:  [[0.15]]
grads:  [0.05854405]
Stock Position:  0.05854405209253624
Bond Position:  [-1.33251606]


portfolio before change:  [4.74475194]
curr_Stock_Price:  103.81813710246449
curr_Factors:  [103.8181371]
mat_Sqrt:  [[0.15]]
grads:  [0.04552594]
Stock Position:  0.045525937226219275
Bond Position:  [0.01833395]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.74475194]
Stock Price:  102.89082460316922
PL:  [1.85392734]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.84616699e-02]
 [-1.74862730e-02]
 [-3.61685306e-02]
 [-2.00614183e-03]
 [ 7.89417053e-05]
 [ 1.71259795e-02]
 [-2.65916236e-02]
 [ 7.49450814e-03]
 [ 8.48270917e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.18727056]
curr_Stock_Price:  98.79576190298431
curr_Factors:  [98.7957619]
mat_Sqrt:  [[0.15]]
grads:  [0.1230778]
Stock Position:  0.12307779958873384
Bond Position:  [-29.34683555]


portfolio before change:  [-17.28823337]
curr_Stock_Price:  98.09469546912639
curr_Factors:  [98.09469547]
mat_Sqrt:  [[0.15]]
grads:  [-0.11657515]
Stock Position:  -0.11657515365472641
Bond Position:  [-5.85282917]


portfolio before change:  [-17.0723228]
curr_Stock_Price:  96.21747113385202
curr_Factors:  [96.21747113]
mat_Sqrt:  [[0.15]]
grads:  [-0.24112354]
Stock Position:  -0.2411235373930915
Bond Position:  [6.1279742]


portfolio before change:  [-17.22996453]
curr_Stock_Price:  96.88396139495391
curr_Factors:  [96.88396139]
mat_Sqrt:  [[0.15]]
grads:  [-0.01337428]
Stock Position:  -0.013374278872353592
Bond Position:  [-15.93421141]


portfolio before change:  [-17.23701686]
curr_Stock_Price:  96.81541382898975
curr_Factors:  [96.81541383]
mat_Sqrt:  [[0.15]]
grads:  [0.00052628]
Stock Position:  0.0005262780355877693
Bond Position:  [-17.28796868]


portfolio before change:  [-17.24633392]
curr_Stock_Price:  95.54057342334175
curr_Factors:  [95.54057342]
mat_Sqrt:  [[0.15]]
grads:  [0.1141732]
Stock Position:  0.1141731964989332
Bond Position:  [-28.15450659]


portfolio before change:  [-17.06416744]
curr_Stock_Price:  97.25942919284651
curr_Factors:  [97.25942919]
mat_Sqrt:  [[0.15]]
grads:  [-0.17727749]
Stock Position:  -0.17727749046524643
Bond Position:  [0.17774009]


portfolio before change:  [-17.4906038]
curr_Stock_Price:  99.66540442620307
curr_Factors:  [99.66540443]
mat_Sqrt:  [[0.15]]
grads:  [0.04996339]
Stock Position:  0.049963387605330686
Bond Position:  [-22.47022503]


portfolio before change:  [-17.55474312]
curr_Stock_Price:  98.60660103196624
curr_Factors:  [98.60660103]
mat_Sqrt:  [[0.15]]
grads:  [0.05655139]
Stock Position:  0.05655139447340489
Bond Position:  [-23.13108392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.55474312]
Stock Price:  98.73891974499482
PL:  [-17.55474312]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.43020855e-03]
 [-2.01057153e-02]
 [-1.14680054e-02]
 [-3.28938990e-04]
 [ 5.78037116e-03]
 [ 1.84784488e-02]
 [-3.28571475e-02]
 [-2.57378869e-03]
 [ 8.53517555e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.61105636]
curr_Stock_Price:  100.40435645822865
curr_Factors:  [100.40435646]
mat_Sqrt:  [[0.15]]
grads:  [-0.01620139]
Stock Position:  -0.0162013903416831
Bond Position:  [9.23774653]


portfolio before change:  [7.61962491]
curr_Stock_Price:  100.16064162664223
curr_Factors:  [100.16064163]
mat_Sqrt:  [[0.15]]
grads:  [-0.1340381]
Stock Position:  -0.13403810180688203
Bond Position:  [21.04496719]


portfolio before change:  [7.81327252]
curr_Stock_Price:  98.79444431712875
curr_Factors:  [98.79444432]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645337]
Stock Position:  -0.07645336950891649
Bond Position:  [15.36644067]


portfolio before change:  [7.91524203]
curr_Stock_Price:  97.5612171667591
curr_Factors:  [97.56121717]
mat_Sqrt:  [[0.15]]
grads:  [-0.00219293]
Stock Position:  -0.002192926602913673
Bond Position:  [8.12918662]


portfolio before change:  [7.91793836]
curr_Stock_Price:  98.18562521826301
curr_Factors:  [98.18562522]
mat_Sqrt:  [[0.15]]
grads:  [0.03853581]
Stock Position:  0.03853580771280761
Bond Position:  [4.13427598]


portfolio before change:  [7.91689592]
curr_Stock_Price:  98.10491860909791
curr_Factors:  [98.10491861]
mat_Sqrt:  [[0.15]]
grads:  [0.12318966]
Stock Position:  0.12318965873819462
Bond Position:  [-4.16861553]


portfolio before change:  [7.6568929]
curr_Stock_Price:  96.01125103214122
curr_Factors:  [96.01125103]
mat_Sqrt:  [[0.15]]
grads:  [-0.21904765]
Stock Position:  -0.21904764988990513
Bond Position:  [28.6879318]


portfolio before change:  [7.71125015]
curr_Stock_Price:  95.82859805651415
curr_Factors:  [95.82859806]
mat_Sqrt:  [[0.15]]
grads:  [-0.01715859]
Stock Position:  -0.01715859128327478
Bond Position:  [9.3555339]


portfolio before change:  [7.71447367]
curr_Stock_Price:  95.91341937816195
curr_Factors:  [95.91341938]
mat_Sqrt:  [[0.15]]
grads:  [0.05690117]
Stock Position:  0.05690117031235472
Bond Position:  [2.25688786]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.71447367]
Stock Price:  96.40699776122224
PL:  [7.71447367]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [9.58157905e-02]
 [4.89481654e-04]
 [1.97719518e-02]
 [2.00035821e-03]
 [1.21002559e-02]
 [1.64365074e-02]
 [1.48158697e-02]
 [1.07838624e-02]
 [8.40992987e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [51.35615523]
curr_Stock_Price:  103.24197240217154
curr_Factors:  [103.2419724]
mat_Sqrt:  [[0.15]]
grads:  [0.63877194]
Stock Position:  0.6387719368842695
Bond Position:  [-14.59191945]


portfolio before change:  [51.86110588]
curr_Stock_Price:  104.04389934828733
curr_Factors:  [104.04389935]
mat_Sqrt:  [[0.15]]
grads:  [0.00326321]
Stock Position:  0.003263211027587527
Bond Position:  [51.52158868]


portfolio before change:  [51.87879349]
curr_Stock_Price:  101.56792538499253
curr_Factors:  [101.56792538]
mat_Sqrt:  [[0.15]]
grads:  [0.13181301]
Stock Position:  0.1318130120182659
Bond Position:  [38.49081932]


portfolio before change:  [51.93585022]
curr_Stock_Price:  101.85474462015219
curr_Factors:  [101.85474462]
mat_Sqrt:  [[0.15]]
grads:  [0.01333572]
Stock Position:  0.013335721380016454
Bond Position:  [50.57754372]


portfolio before change:  [51.97137608]
curr_Stock_Price:  102.62191498188808
curr_Factors:  [102.62191498]
mat_Sqrt:  [[0.15]]
grads:  [0.08066837]
Stock Position:  0.08066837240215388
Bond Position:  [43.69303323]


portfolio before change:  [52.11319167]
curr_Stock_Price:  104.10903574061547
curr_Factors:  [104.10903574]
mat_Sqrt:  [[0.15]]
grads:  [0.10957672]
Stock Position:  0.1095767158732535
Bond Position:  [40.70526544]


portfolio before change:  [51.97455045]
curr_Stock_Price:  102.65800722158191
curr_Factors:  [102.65800722]
mat_Sqrt:  [[0.15]]
grads:  [0.09877246]
Stock Position:  0.09877246436014862
Bond Position:  [41.8347661]


portfolio before change:  [51.77972147]
curr_Stock_Price:  100.473677796054
curr_Factors:  [100.4736778]
mat_Sqrt:  [[0.15]]
grads:  [0.07189242]
Stock Position:  0.07189241590520809
Bond Position:  [44.55642604]


portfolio before change:  [51.76463055]
curr_Stock_Price:  99.95380787123435
curr_Factors:  [99.95380787]
mat_Sqrt:  [[0.15]]
grads:  [0.0560662]
Stock Position:  0.05606619914231798
Bond Position:  [46.16060045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [51.76463055]
Stock Price:  96.86017970649556
PL:  [51.76463055]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01758179]
 [-0.0205513 ]
 [-0.01436558]
 [-0.00311223]
 [-0.01534994]
 [ 0.01684855]
 [-0.01655045]
 [ 0.00295623]
 [ 0.00846017]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.87935598]
curr_Stock_Price:  99.01033659597205
curr_Factors:  [99.0103366]
mat_Sqrt:  [[0.15]]
grads:  [0.11721192]
Stock Position:  0.1172119151515263
Bond Position:  [-25.48454715]


portfolio before change:  [-13.8750683]
curr_Stock_Price:  99.15565575901437
curr_Factors:  [99.15565576]
mat_Sqrt:  [[0.15]]
grads:  [-0.13700868]
Stock Position:  -0.13700868340399502
Bond Position:  [-0.28988246]


portfolio before change:  [-13.73948904]
curr_Stock_Price:  98.16503066145421
curr_Factors:  [98.16503066]
mat_Sqrt:  [[0.15]]
grads:  [-0.09577055]
Stock Position:  -0.09577055218392697
Bond Position:  [-4.33816985]


portfolio before change:  [-13.56822034]
curr_Stock_Price:  96.35405297201387
curr_Factors:  [96.35405297]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074819]
Stock Position:  -0.020748191733664795
Bond Position:  [-11.56904797]


portfolio before change:  [-13.52826814]
curr_Stock_Price:  94.14961179419979
curr_Factors:  [94.14961179]
mat_Sqrt:  [[0.15]]
grads:  [-0.10233294]
Stock Position:  -0.10233294015272697
Bond Position:  [-3.89366155]


portfolio before change:  [-13.61917354]
curr_Stock_Price:  95.0189123604815
curr_Factors:  [95.01891236]
mat_Sqrt:  [[0.15]]
grads:  [0.11232364]
Stock Position:  0.11232363841819483
Bond Position:  [-24.29204349]


portfolio before change:  [-13.24898768]
curr_Stock_Price:  98.4227810937523
curr_Factors:  [98.42278109]
mat_Sqrt:  [[0.15]]
grads:  [-0.11033635]
Stock Position:  -0.11033634893507105
Bond Position:  [-2.38937736]


portfolio before change:  [-13.24859159]
curr_Stock_Price:  98.40836091567357
curr_Factors:  [98.40836092]
mat_Sqrt:  [[0.15]]
grads:  [0.0197082]
Stock Position:  0.01970820263853168
Bond Position:  [-15.18804351]


portfolio before change:  [-13.27356317]
curr_Stock_Price:  97.52671487930739
curr_Factors:  [97.52671488]
mat_Sqrt:  [[0.15]]
grads:  [0.05640116]
Stock Position:  0.05640116157935928
Bond Position:  [-18.77418318]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.27356317]
Stock Price:  97.52897500267365
PL:  [-13.27356317]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.62404525e-03]
 [-2.07398196e-02]
 [-5.23295386e-03]
 [ 2.62588447e-03]
 [ 1.09810673e-02]
 [ 1.80133554e-02]
 [-2.18295379e-02]
 [-4.08858491e-04]
 [ 8.47656819e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.79685458]
curr_Stock_Price:  100.09207334332837
curr_Factors:  [100.09207334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03082697]
Stock Position:  -0.030826968305662332
Bond Position:  [5.88238975]


portfolio before change:  [2.79825649]
curr_Stock_Price:  100.14203027309567
curr_Factors:  [100.14203027]
mat_Sqrt:  [[0.15]]
grads:  [-0.13826546]
Stock Position:  -0.13826546429332134
Bond Position:  [16.6444408]


portfolio before change:  [2.74097226]
curr_Stock_Price:  100.6165415911014
curr_Factors:  [100.61654159]
mat_Sqrt:  [[0.15]]
grads:  [-0.03488636]
Stock Position:  -0.034886359074335675
Bond Position:  [6.25111706]


portfolio before change:  [2.7174347]
curr_Stock_Price:  101.3808490017061
curr_Factors:  [101.380849]
mat_Sqrt:  [[0.15]]
grads:  [0.0175059]
Stock Position:  0.01750589648969251
Bond Position:  [0.94267205]


portfolio before change:  [2.75138943]
curr_Stock_Price:  103.29353481654582
curr_Factors:  [103.29353482]
mat_Sqrt:  [[0.15]]
grads:  [0.07320712]
Stock Position:  0.07320711502663073
Bond Position:  [-4.81043225]


portfolio before change:  [2.57289817]
curr_Stock_Price:  100.88822972391786
curr_Factors:  [100.88822972]
mat_Sqrt:  [[0.15]]
grads:  [0.12008904]
Stock Position:  0.1200890363103564
Bond Position:  [-9.54267212]


portfolio before change:  [2.2103921]
curr_Stock_Price:  97.90932712730003
curr_Factors:  [97.90932713]
mat_Sqrt:  [[0.15]]
grads:  [-0.14553025]
Stock Position:  -0.145530252374817
Bond Position:  [16.45916118]


portfolio before change:  [2.4105398]
curr_Stock_Price:  96.59059054257523
curr_Factors:  [96.59059054]
mat_Sqrt:  [[0.15]]
grads:  [-0.00272572]
Stock Position:  -0.0027257232760110224
Bond Position:  [2.67381902]


portfolio before change:  [2.40840145]
curr_Stock_Price:  97.86569953976138
curr_Factors:  [97.86569954]
mat_Sqrt:  [[0.15]]
grads:  [0.05651045]
Stock Position:  0.056510454619533745
Bond Position:  [-3.12203372]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.40840145]
Stock Price:  99.74165590425677
PL:  [2.40840145]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01205221]
 [-0.02356349]
 [ 0.04035225]
 [ 0.00388301]
 [ 0.01320166]
 [ 0.01789024]
 [ 0.00407828]
 [ 0.00858027]
 [ 0.0060504 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.30789502]
curr_Stock_Price:  99.17713970808867
curr_Factors:  [99.17713971]
mat_Sqrt:  [[0.15]]
grads:  [0.08034805]
Stock Position:  0.08034805191744138
Bond Position:  [-19.27658499]


portfolio before change:  [-11.28943213]
curr_Stock_Price:  99.52691284519331
curr_Factors:  [99.52691285]
mat_Sqrt:  [[0.15]]
grads:  [-0.15708992]
Stock Position:  -0.15708992057366197
Bond Position:  [4.3452427]


portfolio before change:  [-11.73874651]
curr_Stock_Price:  102.40098361226667
curr_Factors:  [102.40098361]
mat_Sqrt:  [[0.15]]
grads:  [0.26901501]
Stock Position:  0.2690150125244356
Bond Position:  [-39.2861484]


portfolio before change:  [-12.19146878]
curr_Stock_Price:  100.79113188757776
curr_Factors:  [100.79113189]
mat_Sqrt:  [[0.15]]
grads:  [0.02588672]
Stock Position:  0.02588671782468991
Bond Position:  [-14.80062037]


portfolio before change:  [-12.2153038]
curr_Stock_Price:  100.156333135945
curr_Factors:  [100.15633314]
mat_Sqrt:  [[0.15]]
grads:  [0.08801103]
Stock Position:  0.08801103364998088
Bond Position:  [-21.0301662]


portfolio before change:  [-12.13322037]
curr_Stock_Price:  101.20848689222309
curr_Factors:  [101.20848689]
mat_Sqrt:  [[0.15]]
grads:  [0.1192683]
Stock Position:  0.11926829779030076
Bond Position:  [-24.20418432]


portfolio before change:  [-12.18524993]
curr_Stock_Price:  100.87374214348092
curr_Factors:  [100.87374214]
mat_Sqrt:  [[0.15]]
grads:  [0.02718852]
Stock Position:  0.02718851722921696
Bond Position:  [-14.9278574]


portfolio before change:  [-12.13433794]
curr_Stock_Price:  103.02089032994925
curr_Factors:  [103.02089033]
mat_Sqrt:  [[0.15]]
grads:  [0.05720179]
Stock Position:  0.05720179077029279
Bond Position:  [-18.02731736]


portfolio before change:  [-11.97971152]
curr_Stock_Price:  105.88168079258816
curr_Factors:  [105.88168079]
mat_Sqrt:  [[0.15]]
grads:  [0.04033599]
Stock Position:  0.04033598547127596
Bond Position:  [-16.25055346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.97971152]
Stock Price:  103.51706664896892
PL:  [-15.49677817]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.31659340e-02]
 [ 3.51837078e-03]
 [ 5.04617971e-02]
 [ 8.00767556e-03]
 [-2.36581568e-04]
 [ 1.48819548e-02]
 [ 4.18196144e-02]
 [-7.19092358e-04]
 [ 4.55559947e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.61603358]
curr_Stock_Price:  100.98848285417866
curr_Factors:  [100.98848285]
mat_Sqrt:  [[0.15]]
grads:  [0.08777289]
Stock Position:  0.08777289345911451
Bond Position:  [7.75198224]


portfolio before change:  [16.6527837]
curr_Stock_Price:  101.36300799618714
curr_Factors:  [101.363008]
mat_Sqrt:  [[0.15]]
grads:  [0.02345581]
Stock Position:  0.023455805214023427
Bond Position:  [14.27523273]


portfolio before change:  [16.69522462]
curr_Stock_Price:  102.86803080807287
curr_Factors:  [102.86803081]
mat_Sqrt:  [[0.15]]
grads:  [0.33641198]
Stock Position:  0.33641198074501605
Bond Position:  [-17.91081338]


portfolio before change:  [17.35306392]
curr_Stock_Price:  104.85011520675627
curr_Factors:  [104.85011521]
mat_Sqrt:  [[0.15]]
grads:  [0.0533845]
Stock Position:  0.05338450371424798
Bond Position:  [11.75569255]


portfolio before change:  [17.40596332]
curr_Stock_Price:  105.73089684744932
curr_Factors:  [105.73089685]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157721]
Stock Position:  -0.001577210451884567
Bond Position:  [17.5727232]


portfolio before change:  [17.41109896]
curr_Stock_Price:  108.04696274585697
curr_Factors:  [108.04696275]
mat_Sqrt:  [[0.15]]
grads:  [0.09921303]
Stock Position:  0.0992130316870066
Bond Position:  [6.69143222]


portfolio before change:  [17.35063998]
curr_Stock_Price:  107.4038463485079
curr_Factors:  [107.40384635]
mat_Sqrt:  [[0.15]]
grads:  [0.27879743]
Stock Position:  0.2787974290878942
Bond Position:  [-12.59327625]


portfolio before change:  [17.13430512]
curr_Stock_Price:  106.6504798395595
curr_Factors:  [106.65047984]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479395]
Stock Position:  -0.004793949051100593
Bond Position:  [17.64558209]


portfolio before change:  [17.12642189]
curr_Stock_Price:  110.13575558351664
curr_Factors:  [110.13575558]
mat_Sqrt:  [[0.15]]
grads:  [0.03037066]
Stock Position:  0.030370663113828703
Bond Position:  [13.78152596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.12642189]
Stock Price:  111.61469575236289
PL:  [5.51172613]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.29242518e-03]
 [-2.17806511e-02]
 [ 3.65244872e-02]
 [ 2.20070831e-03]
 [ 1.63453262e-02]
 [ 1.69445574e-02]
 [ 2.04339915e-02]
 [ 5.74612199e-03]
 [ 6.31023360e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.04123819]
curr_Stock_Price:  100.62686226833297
curr_Factors:  [100.62686227]
mat_Sqrt:  [[0.15]]
grads:  [0.02861617]
Stock Position:  0.0286161678837274
Bond Position:  [8.16168301]


portfolio before change:  [11.03057183]
curr_Stock_Price:  100.11148122977204
curr_Factors:  [100.11148123]
mat_Sqrt:  [[0.15]]
grads:  [-0.14520434]
Stock Position:  -0.14520434057762263
Bond Position:  [25.56719344]


portfolio before change:  [10.73659051]
curr_Stock_Price:  102.2241461064588
curr_Factors:  [102.22414611]
mat_Sqrt:  [[0.15]]
grads:  [0.24349658]
Stock Position:  0.2434965812691838
Bond Position:  [-14.15463959]


portfolio before change:  [10.75348827]
curr_Stock_Price:  102.32261505762357
curr_Factors:  [102.32261506]
mat_Sqrt:  [[0.15]]
grads:  [0.01467139]
Stock Position:  0.01467138874939058
Bond Position:  [9.25227341]


portfolio before change:  [10.74661327]
curr_Stock_Price:  101.53861972782892
curr_Factors:  [101.53861973]
mat_Sqrt:  [[0.15]]
grads:  [0.10896884]
Stock Position:  0.10896884151034461
Bond Position:  [-0.31793249]


portfolio before change:  [10.88046394]
curr_Stock_Price:  102.76841792397728
curr_Factors:  [102.76841792]
mat_Sqrt:  [[0.15]]
grads:  [0.11296372]
Stock Position:  0.11296371568883176
Bond Position:  [-0.7286384]


portfolio before change:  [10.98277816]
curr_Stock_Price:  103.67737020056293
curr_Factors:  [103.6773702]
mat_Sqrt:  [[0.15]]
grads:  [0.13622661]
Stock Position:  0.1362266097296305
Bond Position:  [-3.14083849]


portfolio before change:  [11.03693182]
curr_Stock_Price:  104.08642737782289
curr_Factors:  [104.08642738]
mat_Sqrt:  [[0.15]]
grads:  [0.03830748]
Stock Position:  0.0383074799150945
Bond Position:  [7.0496431]


portfolio before change:  [11.08090187]
curr_Stock_Price:  105.14220926214814
curr_Factors:  [105.14220926]
mat_Sqrt:  [[0.15]]
grads:  [0.04206822]
Stock Position:  0.042068223980740706
Bond Position:  [6.65775586]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.08090187]
Stock Price:  107.0243668194492
PL:  [4.05653505]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.01065976e-02]
 [-1.09205907e-02]
 [ 5.41079006e-02]
 [ 2.57212641e-03]
 [ 9.94864710e-03]
 [ 1.80972092e-02]
 [-1.41502288e-03]
 [ 1.25066742e-02]
 [ 7.54906287e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.459474]
curr_Stock_Price:  100.84859317495476
curr_Factors:  [100.84859317]
mat_Sqrt:  [[0.15]]
grads:  [0.06737732]
Stock Position:  0.06737731757556928
Bond Position:  [7.66456631]


portfolio before change:  [14.43786135]
curr_Stock_Price:  100.47093056945249
curr_Factors:  [100.47093057]
mat_Sqrt:  [[0.15]]
grads:  [-0.07280394]
Stock Position:  -0.07280393784289298
Bond Position:  [21.75254074]


portfolio before change:  [14.26195855]
curr_Stock_Price:  103.03647581604616
curr_Factors:  [103.03647582]
mat_Sqrt:  [[0.15]]
grads:  [0.36071934]
Stock Position:  0.3607193375843885
Bond Position:  [-22.90529076]


portfolio before change:  [13.66797739]
curr_Stock_Price:  101.42157584342968
curr_Factors:  [101.42157584]
mat_Sqrt:  [[0.15]]
grads:  [0.01714751]
Stock Position:  0.017147509420809663
Bond Position:  [11.92884996]


portfolio before change:  [13.64341869]
curr_Stock_Price:  99.6414563923202
curr_Factors:  [99.64145639]
mat_Sqrt:  [[0.15]]
grads:  [0.06632431]
Stock Position:  0.06632431396949842
Bond Position:  [7.03476745]


portfolio before change:  [13.716724]
curr_Stock_Price:  100.69366552500196
curr_Factors:  [100.69366553]
mat_Sqrt:  [[0.15]]
grads:  [0.12064806]
Stock Position:  0.12064806148758725
Bond Position:  [1.56822845]


portfolio before change:  [13.64955509]
curr_Stock_Price:  100.1304304607792
curr_Factors:  [100.13043046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00943349]
Stock Position:  -0.009433485833405763
Bond Position:  [14.59413409]


portfolio before change:  [13.64488636]
curr_Stock_Price:  101.39906312853806
curr_Factors:  [101.39906313]
mat_Sqrt:  [[0.15]]
grads:  [0.08337783]
Stock Position:  0.0833778280524247
Bond Position:  [5.19045271]


portfolio before change:  [13.67910487]
curr_Stock_Price:  101.77833233371068
curr_Factors:  [101.77833233]
mat_Sqrt:  [[0.15]]
grads:  [0.05032709]
Stock Position:  0.05032708580865689
Bond Position:  [8.55689801]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.67910487]
Stock Price:  101.10512029213584
PL:  [12.57398458]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.81036264e-02]
 [-1.86806103e-02]
 [-1.35711536e-02]
 [ 2.26412483e-03]
 [ 1.56007436e-02]
 [ 1.72108553e-02]
 [ 1.72660517e-02]
 [ 1.20046038e-02]
 [ 7.36071429e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.94888787]
curr_Stock_Price:  98.48688978878312
curr_Factors:  [98.48688979]
mat_Sqrt:  [[0.15]]
grads:  [0.12069084]
Stock Position:  0.12069084280402756
Bond Position:  [-33.8353536]


portfolio before change:  [-21.92889931]
curr_Stock_Price:  98.79271633138055
curr_Factors:  [98.79271633]
mat_Sqrt:  [[0.15]]
grads:  [-0.1245374]
Stock Position:  -0.12453740232001692
Bond Position:  [-9.62551105]


portfolio before change:  [-22.07196513]
curr_Stock_Price:  99.90283957612795
curr_Factors:  [99.90283958]
mat_Sqrt:  [[0.15]]
grads:  [-0.09047436]
Stock Position:  -0.09047435759349298
Bond Position:  [-13.0333199]


portfolio before change:  [-22.23700144]
curr_Stock_Price:  101.65491632312968
curr_Factors:  [101.65491632]
mat_Sqrt:  [[0.15]]
grads:  [0.01509417]
Stock Position:  0.01509416555636201
Bond Position:  [-23.77139758]


portfolio before change:  [-22.25759355]
curr_Stock_Price:  101.07830660894967
curr_Factors:  [101.07830661]
mat_Sqrt:  [[0.15]]
grads:  [0.10400496]
Stock Position:  0.10400495738204689
Bond Position:  [-32.77023853]


portfolio before change:  [-22.14987273]
curr_Stock_Price:  102.27161546755976
curr_Factors:  [102.27161547]
mat_Sqrt:  [[0.15]]
grads:  [0.11473904]
Stock Position:  0.1147390351533655
Bond Position:  [-33.88441922]


portfolio before change:  [-22.07147591]
curr_Stock_Price:  103.10257303543077
curr_Factors:  [103.10257304]
mat_Sqrt:  [[0.15]]
grads:  [0.11510701]
Stock Position:  0.11510701148568918
Bond Position:  [-33.93930497]


portfolio before change:  [-22.23376026]
curr_Stock_Price:  101.84017855084731
curr_Factors:  [101.84017855]
mat_Sqrt:  [[0.15]]
grads:  [0.08003069]
Stock Position:  0.08003069219800081
Bond Position:  [-30.38410025]


portfolio before change:  [-22.20653707]
curr_Stock_Price:  102.37021320020736
curr_Factors:  [102.3702132]
mat_Sqrt:  [[0.15]]
grads:  [0.04907143]
Stock Position:  0.04907142860636783
Bond Position:  [-27.22998968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.20653707]
Stock Price:  100.02866380882168
PL:  [-22.23520088]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01825346]
 [-0.0186702 ]
 [-0.03610794]
 [-0.01254152]
 [-0.02553448]
 [ 0.01608014]
 [-0.04809647]
 [-0.01167817]
 [ 0.00846223]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.40451225]
curr_Stock_Price:  98.84653713323428
curr_Factors:  [98.84653713]
mat_Sqrt:  [[0.15]]
grads:  [0.12168974]
Stock Position:  0.1216897438549878
Bond Position:  [-28.43312204]


portfolio before change:  [-16.42602231]
curr_Stock_Price:  98.78663115858235
curr_Factors:  [98.78663116]
mat_Sqrt:  [[0.15]]
grads:  [-0.12446799]
Stock Position:  -0.12446798941044557
Bond Position:  [-4.13024895]


portfolio before change:  [-16.10894988]
curr_Stock_Price:  96.22261390297086
curr_Factors:  [96.2226139]
mat_Sqrt:  [[0.15]]
grads:  [-0.24071963]
Stock Position:  -0.24071962923752338
Bond Position:  [7.05372206]


portfolio before change:  [-15.49637722]
curr_Stock_Price:  93.69251313614464
curr_Factors:  [93.69251314]
mat_Sqrt:  [[0.15]]
grads:  [-0.08361016]
Stock Position:  -0.08361016082154218
Bond Position:  [-7.66273113]


portfolio before change:  [-15.39130013]
curr_Stock_Price:  92.38992734139477
curr_Factors:  [92.38992734]
mat_Sqrt:  [[0.15]]
grads:  [-0.17022987]
Stock Position:  -0.1702298674982404
Bond Position:  [0.33622496]


portfolio before change:  [-15.4179307]
curr_Stock_Price:  92.54735400734353
curr_Factors:  [92.54735401]
mat_Sqrt:  [[0.15]]
grads:  [0.1072009]
Stock Position:  0.10720090270667607
Bond Position:  [-25.33909059]


portfolio before change:  [-15.5741817]
curr_Stock_Price:  91.20801556838326
curr_Factors:  [91.20801557]
mat_Sqrt:  [[0.15]]
grads:  [-0.32064312]
Stock Position:  -0.32064311656900796
Bond Position:  [13.67104067]


portfolio before change:  [-16.0214093]
curr_Stock_Price:  92.62412216345892
curr_Factors:  [92.62412216]
mat_Sqrt:  [[0.15]]
grads:  [-0.07785444]
Stock Position:  -0.07785443598379482
Bond Position:  [-8.81021051]


portfolio before change:  [-15.98426929]
curr_Stock_Price:  92.0904823721974
curr_Factors:  [92.09048237]
mat_Sqrt:  [[0.15]]
grads:  [0.05641489]
Stock Position:  0.05641489372815824
Bond Position:  [-21.17954406]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.98426929]
Stock Price:  91.98392291736522
PL:  [-15.98426929]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01533092]
 [-0.01809409]
 [-0.01347152]
 [ 0.00277574]
 [ 0.01669605]
 [ 0.01819196]
 [-0.02737222]
 [ 0.00652127]
 [ 0.00848169]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-26.45480155]
curr_Stock_Price:  98.19460441621212
curr_Factors:  [98.19460442]
mat_Sqrt:  [[0.15]]
grads:  [0.10220613]
Stock Position:  0.102206132101929
Bond Position:  [-36.49089226]


portfolio before change:  [-26.44695562]
curr_Stock_Price:  98.44993103913613
curr_Factors:  [98.44993104]
mat_Sqrt:  [[0.15]]
grads:  [-0.12062729]
Stock Position:  -0.12062728747496726
Bond Position:  [-14.57120748]


portfolio before change:  [-26.44330312]
curr_Stock_Price:  98.35923915435343
curr_Factors:  [98.35923915]
mat_Sqrt:  [[0.15]]
grads:  [-0.08981015]
Stock Position:  -0.08981014617660536
Bond Position:  [-17.60964548]


portfolio before change:  [-26.52704178]
curr_Stock_Price:  99.19357284009432
curr_Factors:  [99.19357284]
mat_Sqrt:  [[0.15]]
grads:  [0.01850496]
Stock Position:  0.01850496144414491
Bond Position:  [-28.36261502]


portfolio before change:  [-26.51076341]
curr_Stock_Price:  100.83979182189074
curr_Factors:  [100.83979182]
mat_Sqrt:  [[0.15]]
grads:  [0.11130701]
Stock Position:  0.11130700697468426
Bond Position:  [-37.73493883]


portfolio before change:  [-26.57367089]
curr_Stock_Price:  100.44417172318069
curr_Factors:  [100.44417172]
mat_Sqrt:  [[0.15]]
grads:  [0.12127971]
Stock Position:  0.1212797052482485
Bond Position:  [-38.75551043]


portfolio before change:  [-26.99504207]
curr_Stock_Price:  97.12961404341318
curr_Factors:  [97.12961404]
mat_Sqrt:  [[0.15]]
grads:  [-0.18248148]
Stock Position:  -0.1824814780707959
Bond Position:  [-9.27068653]


portfolio before change:  [-27.4222378]
curr_Stock_Price:  99.44524211438073
curr_Factors:  [99.44524211]
mat_Sqrt:  [[0.15]]
grads:  [0.04347515]
Stock Position:  0.04347514906617624
Bond Position:  [-31.74563453]


portfolio before change:  [-27.50131529]
curr_Stock_Price:  97.99152207218287
curr_Factors:  [97.99152207]
mat_Sqrt:  [[0.15]]
grads:  [0.0565446]
Stock Position:  0.05654459609901156
Bond Position:  [-33.04220632]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.50131529]
Stock Price:  98.2042783894636
PL:  [-27.50131529]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01659766]
 [-0.01687366]
 [-0.01701204]
 [-0.00385466]
 [-0.00629455]
 [ 0.01691463]
 [-0.03312787]
 [-0.00725165]
 [ 0.00853736]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.25094423]
curr_Stock_Price:  98.27269510112218
curr_Factors:  [98.2726951]
mat_Sqrt:  [[0.15]]
grads:  [0.11065109]
Stock Position:  0.11065108694269471
Bond Position:  [-36.12492476]


portfolio before change:  [-25.32281046]
curr_Stock_Price:  97.78648884517942
curr_Factors:  [97.78648885]
mat_Sqrt:  [[0.15]]
grads:  [-0.11249109]
Stock Position:  -0.11249108533546548
Bond Position:  [-14.3227022]


portfolio before change:  [-25.33911108]
curr_Stock_Price:  97.86771733613116
curr_Factors:  [97.86771734]
mat_Sqrt:  [[0.15]]
grads:  [-0.1134136]
Stock Position:  -0.11341360414467243
Bond Position:  [-14.23958053]


portfolio before change:  [-25.12994692]
curr_Stock_Price:  95.96066450772852
curr_Factors:  [95.96066451]
mat_Sqrt:  [[0.15]]
grads:  [-0.02569775]
Stock Position:  -0.02569775187381964
Bond Position:  [-22.66397357]


portfolio before change:  [-25.13494823]
curr_Stock_Price:  95.71420273081284
curr_Factors:  [95.71420273]
mat_Sqrt:  [[0.15]]
grads:  [-0.04196364]
Stock Position:  -0.04196364099836504
Bond Position:  [-21.11843178]


portfolio before change:  [-25.12154732]
curr_Stock_Price:  95.14316644224684
curr_Factors:  [95.14316644]
mat_Sqrt:  [[0.15]]
grads:  [0.11276418]
Stock Position:  0.11276418335695974
Bond Position:  [-35.85028879]


portfolio before change:  [-25.05423311]
curr_Stock_Price:  95.89911427786683
curr_Factors:  [95.89911428]
mat_Sqrt:  [[0.15]]
grads:  [-0.22085248]
Stock Position:  -0.2208524779725532
Bond Position:  [-3.87467608]


portfolio before change:  [-24.67697028]
curr_Stock_Price:  94.18212813190488
curr_Factors:  [94.18212813]
mat_Sqrt:  [[0.15]]
grads:  [-0.04834431]
Stock Position:  -0.04834430969193525
Bond Position:  [-20.12380031]


portfolio before change:  [-24.76400066]
curr_Stock_Price:  95.77416567032017
curr_Factors:  [95.77416567]
mat_Sqrt:  [[0.15]]
grads:  [0.05691574]
Stock Position:  0.05691574145090453
Bond Position:  [-30.21505831]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-24.76400066]
Stock Price:  97.32815821345241
PL:  [-24.76400066]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.75595822e-02]
 [-2.22639156e-02]
 [-1.10835697e-02]
 [ 3.03259886e-03]
 [ 7.53151110e-03]
 [ 1.79266510e-02]
 [-3.20518399e-02]
 [-6.58108896e-04]
 [ 8.50334983e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.79587601]
curr_Stock_Price:  99.01575169643084
curr_Factors:  [99.0157517]
mat_Sqrt:  [[0.15]]
grads:  [0.11706388]
Stock Position:  0.11706388113565364
Bond Position:  [-25.3870442]


portfolio before change:  [-13.7673766]
curr_Stock_Price:  99.36766298864575
curr_Factors:  [99.36766299]
mat_Sqrt:  [[0.15]]
grads:  [-0.1484261]
Stock Position:  -0.14842610368693707
Bond Position:  [0.98137845]


portfolio before change:  [-13.69419985]
curr_Stock_Price:  98.87795170647146
curr_Factors:  [98.87795171]
mat_Sqrt:  [[0.15]]
grads:  [-0.07389046]
Stock Position:  -0.07389046436680115
Bond Position:  [-6.38806209]


portfolio before change:  [-13.73134192]
curr_Stock_Price:  99.33737819074068
curr_Factors:  [99.33737819]
mat_Sqrt:  [[0.15]]
grads:  [0.02021733]
Stock Position:  0.020217325707381238
Bond Position:  [-15.73967805]


portfolio before change:  [-13.75277034]
curr_Stock_Price:  98.66683371652519
curr_Factors:  [98.66683372]
mat_Sqrt:  [[0.15]]
grads:  [0.05021007]
Stock Position:  0.05021007397732171
Bond Position:  [-18.70683936]


portfolio before change:  [-13.84294822]
curr_Stock_Price:  97.0571543769647
curr_Factors:  [97.05715438]
mat_Sqrt:  [[0.15]]
grads:  [0.11951101]
Stock Position:  0.11951100657125976
Bond Position:  [-25.44234643]


portfolio before change:  [-13.94080464]
curr_Stock_Price:  96.34481772009012
curr_Factors:  [96.34481772]
mat_Sqrt:  [[0.15]]
grads:  [-0.21367893]
Stock Position:  -0.21367893265048035
Bond Position:  [6.64605317]


portfolio before change:  [-13.97125144]
curr_Stock_Price:  96.50286164710496
curr_Factors:  [96.50286165]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438739]
Stock Position:  -0.004387392638776201
Bond Position:  [-13.5478555]


portfolio before change:  [-13.98013997]
curr_Stock_Price:  96.98444822118317
curr_Factors:  [96.98444822]
mat_Sqrt:  [[0.15]]
grads:  [0.056689]
Stock Position:  0.05668899886826171
Bond Position:  [-19.47809125]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.98013997]
Stock Price:  96.87459768536499
PL:  [-13.98013997]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [4.68658104e-02]
 [7.69412696e-04]
 [5.42602453e-02]
 [4.91197065e-03]
 [1.47989775e-02]
 [1.79246906e-02]
 [1.76636933e-02]
 [1.10665594e-02]
 [7.69667255e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.31967306]
curr_Stock_Price:  101.87739765507813
curr_Factors:  [101.87739766]
mat_Sqrt:  [[0.15]]
grads:  [0.31243874]
Stock Position:  0.31243873617104667
Bond Position:  [-1.51077231]


portfolio before change:  [30.90689042]
curr_Stock_Price:  103.75927999141673
curr_Factors:  [103.75927999]
mat_Sqrt:  [[0.15]]
grads:  [0.00512942]
Stock Position:  0.005129417976661432
Bond Position:  [30.3746657]


portfolio before change:  [30.91841009]
curr_Stock_Price:  103.04351393279964
curr_Factors:  [103.04351393]
mat_Sqrt:  [[0.15]]
grads:  [0.36173497]
Stock Position:  0.3617349688427006
Bond Position:  [-6.35603221]


portfolio before change:  [31.16276383]
curr_Stock_Price:  103.7278065083059
curr_Factors:  [103.72780651]
mat_Sqrt:  [[0.15]]
grads:  [0.03274647]
Stock Position:  0.03274647100407031
Bond Position:  [27.76604422]


portfolio before change:  [31.06581655]
curr_Stock_Price:  100.34320441103054
curr_Factors:  [100.34320441]
mat_Sqrt:  [[0.15]]
grads:  [0.09865985]
Stock Position:  0.09865985024556578
Bond Position:  [21.16597103]


portfolio before change:  [31.15022617]
curr_Stock_Price:  101.09147220966423
curr_Factors:  [101.09147221]
mat_Sqrt:  [[0.15]]
grads:  [0.11949794]
Stock Position:  0.1194979374750847
Bond Position:  [19.07000374]


portfolio before change:  [31.4087076]
curr_Stock_Price:  103.17472189014674
curr_Factors:  [103.17472189]
mat_Sqrt:  [[0.15]]
grads:  [0.11775796]
Stock Position:  0.11775795501463213
Bond Position:  [19.25906334]


portfolio before change:  [31.29926025]
curr_Stock_Price:  102.16350112654713
curr_Factors:  [102.16350113]
mat_Sqrt:  [[0.15]]
grads:  [0.07377706]
Stock Position:  0.07377706276067403
Bond Position:  [23.76193721]


portfolio before change:  [31.26481046]
curr_Stock_Price:  101.53547766020264
curr_Factors:  [101.53547766]
mat_Sqrt:  [[0.15]]
grads:  [0.05131115]
Stock Position:  0.051311150323238665
Bond Position:  [26.0549083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.26481046]
Stock Price:  100.7555342872838
PL:  [30.50927617]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [8.84330444e-03]
 [2.23052647e-03]
 [9.86996593e-03]
 [3.90481146e-03]
 [1.01464012e-02]
 [1.82059147e-02]
 [4.91370692e-03]
 [6.74461001e-03]
 [8.39760653e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.58459053]
curr_Stock_Price:  100.7918420560981
curr_Factors:  [100.79184206]
mat_Sqrt:  [[0.15]]
grads:  [0.05895536]
Stock Position:  0.05895536295199786
Bond Position:  [7.6423709]


portfolio before change:  [13.67577587]
curr_Stock_Price:  102.27369533567901
curr_Factors:  [102.27369534]
mat_Sqrt:  [[0.15]]
grads:  [0.01487018]
Stock Position:  0.014870176435458106
Bond Position:  [12.15494797]


portfolio before change:  [13.66583331]
curr_Stock_Price:  101.19626678750991
curr_Factors:  [101.19626679]
mat_Sqrt:  [[0.15]]
grads:  [0.06579977]
Stock Position:  0.06579977283935694
Bond Position:  [7.00714194]


portfolio before change:  [13.64220818]
curr_Stock_Price:  100.78396182536461
curr_Factors:  [100.78396183]
mat_Sqrt:  [[0.15]]
grads:  [0.02603208]
Stock Position:  0.02603207638025405
Bond Position:  [11.01859239]


portfolio before change:  [13.62161489]
curr_Stock_Price:  99.78120044278315
curr_Factors:  [99.78120044]
mat_Sqrt:  [[0.15]]
grads:  [0.06764267]
Stock Position:  0.06764267499849831
Bond Position:  [6.87214758]


portfolio before change:  [13.66663933]
curr_Stock_Price:  100.39601210119031
curr_Factors:  [100.3960121]
mat_Sqrt:  [[0.15]]
grads:  [0.12137276]
Stock Position:  0.12137276450909242
Bond Position:  [1.4812978]


portfolio before change:  [13.74111676]
curr_Stock_Price:  101.00353383682592
curr_Factors:  [101.00353384]
mat_Sqrt:  [[0.15]]
grads:  [0.03275805]
Stock Position:  0.03275804610268417
Bond Position:  [10.43243834]


portfolio before change:  [13.69708777]
curr_Stock_Price:  99.50019279946329
curr_Factors:  [99.5001928]
mat_Sqrt:  [[0.15]]
grads:  [0.04496407]
Stock Position:  0.044964066733599824
Bond Position:  [9.22315446]


portfolio before change:  [13.7426255]
curr_Stock_Price:  100.41036402084592
curr_Factors:  [100.41036402]
mat_Sqrt:  [[0.15]]
grads:  [0.05598404]
Stock Position:  0.055984043519725406
Bond Position:  [8.12124731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.7426255]
Stock Price:  100.49288824383441
PL:  [13.24973725]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-1.27744665e-03]
 [-2.28699420e-02]
 [ 1.56087928e-02]
 [ 3.10062364e-03]
 [-9.73386728e-04]
 [ 1.83649433e-02]
 [-1.60433451e-02]
 [ 9.21019436e-03]
 [ 8.44449201e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.80083387]
curr_Stock_Price:  99.40463245321176
curr_Factors:  [99.40463245]
mat_Sqrt:  [[0.15]]
grads:  [-0.00851631]
Stock Position:  -0.008516311017921219
Bond Position:  [-6.9542731]


portfolio before change:  [-7.80463593]
curr_Stock_Price:  99.44268402078139
curr_Factors:  [99.44268402]
mat_Sqrt:  [[0.15]]
grads:  [-0.15246628]
Stock Position:  -0.15246628031413043
Bond Position:  [7.3570202]


portfolio before change:  [-8.10115993]
curr_Stock_Price:  101.41166644422904
curr_Factors:  [101.41166644]
mat_Sqrt:  [[0.15]]
grads:  [0.10405862]
Stock Position:  0.10405861887269537
Bond Position:  [-18.65391788]


portfolio before change:  [-8.13967944]
curr_Stock_Price:  101.1311494041547
curr_Factors:  [101.1311494]
mat_Sqrt:  [[0.15]]
grads:  [0.02067082]
Stock Position:  0.020670824237325205
Bond Position:  [-10.23014365]


portfolio before change:  [-8.237764]
curr_Stock_Price:  96.63359254434884
curr_Factors:  [96.63359254]
mat_Sqrt:  [[0.15]]
grads:  [-0.00648924]
Stock Position:  -0.006489244851741345
Bond Position:  [-7.61068495]


portfolio before change:  [-8.24959124]
curr_Stock_Price:  97.86962980233228
curr_Factors:  [97.8696298]
mat_Sqrt:  [[0.15]]
grads:  [0.12243296]
Stock Position:  0.12243295556039291
Bond Position:  [-20.23205927]


portfolio before change:  [-8.18402634]
curr_Stock_Price:  98.48779229208465
curr_Factors:  [98.48779229]
mat_Sqrt:  [[0.15]]
grads:  [-0.10695563]
Stock Position:  -0.10695563396420481
Bond Position:  [2.34979793]


portfolio before change:  [-8.34543123]
curr_Stock_Price:  100.00786263725928
curr_Factors:  [100.00786264]
mat_Sqrt:  [[0.15]]
grads:  [0.0614013]
Stock Position:  0.061401295723299026
Bond Position:  [-14.48604358]


portfolio before change:  [-8.40496589]
curr_Stock_Price:  99.1562547696154
curr_Factors:  [99.15625477]
mat_Sqrt:  [[0.15]]
grads:  [0.05629661]
Stock Position:  0.05629661338798629
Bond Position:  [-13.98712723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.40496589]
Stock Price:  99.1044000439313
PL:  [-8.40496589]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 5.85946822e-02]
 [-7.31116754e-04]
 [ 9.72190694e-02]
 [ 8.77324326e-03]
 [ 1.15260067e-02]
 [ 1.80672993e-02]
 [ 4.87193471e-04]
 [ 4.26040769e-03]
 [ 8.41866796e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.36021038]
curr_Stock_Price:  102.20436249099791
curr_Factors:  [102.20436249]
mat_Sqrt:  [[0.15]]
grads:  [0.39063121]
Stock Position:  0.3906312145630496
Bond Position:  [-4.56400387]


portfolio before change:  [36.56129772]
curr_Stock_Price:  105.2849404665122
curr_Factors:  [105.28494047]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487411]
Stock Position:  -0.0048741116913675105
Bond Position:  [37.07446828]


portfolio before change:  [36.5810912]
curr_Stock_Price:  105.02815299208305
curr_Factors:  [105.02815299]
mat_Sqrt:  [[0.15]]
grads:  [0.64812713]
Stock Position:  0.6481271296541009
Bond Position:  [-31.49050413]


portfolio before change:  [36.62983657]
curr_Stock_Price:  105.12766210385217
curr_Factors:  [105.1276621]
mat_Sqrt:  [[0.15]]
grads:  [0.05848829]
Stock Position:  0.05848828839379498
Bond Position:  [30.48109955]


portfolio before change:  [36.52068211]
curr_Stock_Price:  103.00076069002615
curr_Factors:  [103.00076069]
mat_Sqrt:  [[0.15]]
grads:  [0.07684004]
Stock Position:  0.07684004494855225
Bond Position:  [28.60609903]


portfolio before change:  [36.36304409]
curr_Stock_Price:  100.76306496266051
curr_Factors:  [100.76306496]
mat_Sqrt:  [[0.15]]
grads:  [0.12044866]
Stock Position:  0.1204486618387672
Bond Position:  [24.22626775]


portfolio before change:  [36.32865149]
curr_Stock_Price:  100.37693556052929
curr_Factors:  [100.37693556]
mat_Sqrt:  [[0.15]]
grads:  [0.00324796]
Stock Position:  0.003247956475756278
Bond Position:  [36.00263157]


portfolio before change:  [36.34195527]
curr_Stock_Price:  98.9292455326471
curr_Factors:  [98.92924553]
mat_Sqrt:  [[0.15]]
grads:  [0.02840272]
Stock Position:  0.028402717943451946
Bond Position:  [33.53209581]


portfolio before change:  [36.38029795]
curr_Stock_Price:  99.68876595584781
curr_Factors:  [99.68876596]
mat_Sqrt:  [[0.15]]
grads:  [0.05612445]
Stock Position:  0.05612445309695728
Bond Position:  [30.78532048]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.38029795]
Stock Price:  100.73980425497803
PL:  [35.6404937]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.21113509e-02]
 [-1.59250240e-02]
 [-1.30711680e-02]
 [ 2.20680836e-03]
 [ 1.18374017e-02]
 [ 1.66355643e-02]
 [ 2.17254251e-02]
 [ 8.32272291e-03]
 [ 7.37994052e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.8693832]
curr_Stock_Price:  100.94004983929095
curr_Factors:  [100.94004984]
mat_Sqrt:  [[0.15]]
grads:  [0.08074234]
Stock Position:  0.08074233914808152
Bond Position:  [7.71924747]


portfolio before change:  [15.82159008]
curr_Stock_Price:  100.30031474452944
curr_Factors:  [100.30031474]
mat_Sqrt:  [[0.15]]
grads:  [-0.10616683]
Stock Position:  -0.10616682683421766
Bond Position:  [26.47015623]


portfolio before change:  [15.83710457]
curr_Stock_Price:  100.2788758967731
curr_Factors:  [100.2788759]
mat_Sqrt:  [[0.15]]
grads:  [-0.08714112]
Stock Position:  -0.08714111986168006
Bond Position:  [24.57551811]


portfolio before change:  [15.97302673]
curr_Stock_Price:  98.8601274566244
curr_Factors:  [98.86012746]
mat_Sqrt:  [[0.15]]
grads:  [0.01471206]
Stock Position:  0.014712055716132398
Bond Position:  [14.51859102]


portfolio before change:  [15.99740687]
curr_Stock_Price:  100.02373325045299
curr_Factors:  [100.02373325]
mat_Sqrt:  [[0.15]]
grads:  [0.07891601]
Stock Position:  0.07891601113060066
Bond Position:  [8.10393282]


portfolio before change:  [16.27992794]
curr_Stock_Price:  103.55239724352693
curr_Factors:  [103.55239724]
mat_Sqrt:  [[0.15]]
grads:  [0.11090376]
Stock Position:  0.11090376201384936
Bond Position:  [4.79557752]


portfolio before change:  [16.32141965]
curr_Stock_Price:  103.90489500163284
curr_Factors:  [103.904895]
mat_Sqrt:  [[0.15]]
grads:  [0.14483617]
Stock Position:  0.14483616728084767
Bond Position:  [1.2722329]


portfolio before change:  [16.20708298]
curr_Stock_Price:  103.11108120828374
curr_Factors:  [103.11108121]
mat_Sqrt:  [[0.15]]
grads:  [0.05548482]
Stock Position:  0.055484819422044834
Bond Position:  [10.48598326]


portfolio before change:  [16.165757]
curr_Stock_Price:  102.27174746168586
curr_Factors:  [102.27174746]
mat_Sqrt:  [[0.15]]
grads:  [0.0491996]
Stock Position:  0.049199603477799586
Bond Position:  [11.13402758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.165757]
Stock Price:  100.67065176568637
PL:  [15.49510524]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.24980926e-02]
 [-1.46120239e-02]
 [-1.49128507e-02]
 [-2.27829838e-04]
 [ 1.21744666e-02]
 [ 1.76668313e-02]
 [ 7.37498022e-04]
 [ 1.08364475e-02]
 [ 7.79254938e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.14319838]
curr_Stock_Price:  100.95781142493382
curr_Factors:  [100.95781142]
mat_Sqrt:  [[0.15]]
grads:  [0.08332062]
Stock Position:  0.08332061747334689
Bond Position:  [7.7313312]


portfolio before change:  [16.09601175]
curr_Stock_Price:  100.34507877266762
curr_Factors:  [100.34507877]
mat_Sqrt:  [[0.15]]
grads:  [-0.09741349]
Stock Position:  -0.09741349283221407
Bond Position:  [25.87097636]


portfolio before change:  [16.13771223]
curr_Stock_Price:  100.04982441428143
curr_Factors:  [100.04982441]
mat_Sqrt:  [[0.15]]
grads:  [-0.099419]
Stock Position:  -0.09941900469639996
Bond Position:  [26.0845662]


portfolio before change:  [16.39365349]
curr_Stock_Price:  97.60667265178972
curr_Factors:  [97.60667265]
mat_Sqrt:  [[0.15]]
grads:  [-0.00151887]
Stock Position:  -0.0015188655855109638
Bond Position:  [16.54190491]


portfolio before change:  [16.39820521]
curr_Stock_Price:  100.05672616033448
curr_Factors:  [100.05672616]
mat_Sqrt:  [[0.15]]
grads:  [0.08116311]
Stock Position:  0.08116311060223128
Bond Position:  [8.27729008]


portfolio before change:  [16.52307612]
curr_Stock_Price:  101.54423968690081
curr_Factors:  [101.54423969]
mat_Sqrt:  [[0.15]]
grads:  [0.11777888]
Stock Position:  0.11777887501884614
Bond Position:  [4.5633098]


portfolio before change:  [16.39171679]
curr_Stock_Price:  100.40955784390995
curr_Factors:  [100.40955784]
mat_Sqrt:  [[0.15]]
grads:  [0.00491665]
Stock Position:  0.004916653482836981
Bond Position:  [15.89803779]


portfolio before change:  [16.40868129]
curr_Stock_Price:  102.24281548507591
curr_Factors:  [102.24281549]
mat_Sqrt:  [[0.15]]
grads:  [0.07224298]
Stock Position:  0.07224298303789368
Bond Position:  [9.02235531]


portfolio before change:  [16.3506977]
curr_Stock_Price:  101.3777364030322
curr_Factors:  [101.3777364]
mat_Sqrt:  [[0.15]]
grads:  [0.05195033]
Stock Position:  0.051950329184508544
Bond Position:  [11.08409093]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.3506977]
Stock Price:  101.42798073749692
PL:  [14.92271697]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01844906]
 [-0.01691681]
 [-0.00991795]
 [ 0.00465846]
 [ 0.00468053]
 [ 0.01856728]
 [-0.02360302]
 [ 0.00285695]
 [ 0.00845504]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.16806379]
curr_Stock_Price:  98.60240661072876
curr_Factors:  [98.60240661]
mat_Sqrt:  [[0.15]]
grads:  [0.12299373]
Stock Position:  0.1229937323620677
Bond Position:  [-32.2955418]


portfolio before change:  [-20.40684758]
curr_Stock_Price:  96.79229820983772
curr_Factors:  [96.79229821]
mat_Sqrt:  [[0.15]]
grads:  [-0.11277876]
Stock Position:  -0.112778760726467
Bond Position:  [-9.49073214]


portfolio before change:  [-20.68714056]
curr_Stock_Price:  99.23554564459361
curr_Factors:  [99.23554564]
mat_Sqrt:  [[0.15]]
grads:  [-0.06611968]
Stock Position:  -0.06611967609193385
Bond Position:  [-14.12571842]


portfolio before change:  [-20.72616366]
curr_Stock_Price:  99.71888858401147
curr_Factors:  [99.71888858]
mat_Sqrt:  [[0.15]]
grads:  [0.0310564]
Stock Position:  0.03105640380776752
Bond Position:  [-23.82307373]


portfolio before change:  [-20.79918391]
curr_Stock_Price:  97.75131576844998
curr_Factors:  [97.75131577]
mat_Sqrt:  [[0.15]]
grads:  [0.03120356]
Stock Position:  0.03120355743384911
Bond Position:  [-23.84937271]


portfolio before change:  [-20.77338465]
curr_Stock_Price:  98.96037424756686
curr_Factors:  [98.96037425]
mat_Sqrt:  [[0.15]]
grads:  [0.12378187]
Stock Position:  0.12378187210015941
Bond Position:  [-33.02288504]


portfolio before change:  [-20.94005359]
curr_Stock_Price:  97.7473261656269
curr_Factors:  [97.74732617]
mat_Sqrt:  [[0.15]]
grads:  [-0.15735349]
Stock Position:  -0.15735349371490504
Bond Position:  [-5.55917031]


portfolio before change:  [-21.02814205]
curr_Stock_Price:  98.28946973068373
curr_Factors:  [98.28946973]
mat_Sqrt:  [[0.15]]
grads:  [0.0190463]
Stock Position:  0.01904630228089948
Bond Position:  [-22.900193]


portfolio before change:  [-21.02722699]
curr_Stock_Price:  98.93883545148921
curr_Factors:  [98.93883545]
mat_Sqrt:  [[0.15]]
grads:  [0.0563669]
Stock Position:  0.056366904818573434
Bond Position:  [-26.60410291]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.02722699]
Stock Price:  100.18223629718484
PL:  [-21.20946329]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01477427]
 [-0.02575373]
 [-0.01548408]
 [ 0.00491425]
 [ 0.01646987]
 [ 0.01851723]
 [-0.00860743]
 [ 0.003776  ]
 [ 0.00848187]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.49035223]
curr_Stock_Price:  101.0451973338353
curr_Factors:  [101.04519733]
mat_Sqrt:  [[0.15]]
grads:  [0.09849513]
Stock Position:  0.09849513245312316
Bond Position:  [7.53789213]


portfolio before change:  [17.38839719]
curr_Stock_Price:  99.97179476772371
curr_Factors:  [99.97179477]
mat_Sqrt:  [[0.15]]
grads:  [-0.17169153]
Stock Position:  -0.17169152655501851
Bond Position:  [34.55270724]


portfolio before change:  [17.37456526]
curr_Stock_Price:  100.1530069591172
curr_Factors:  [100.15300696]
mat_Sqrt:  [[0.15]]
grads:  [-0.10322721]
Stock Position:  -0.10322720573410978
Bond Position:  [27.71308032]


portfolio before change:  [17.38725576]
curr_Stock_Price:  100.16433645892039
curr_Factors:  [100.16433646]
mat_Sqrt:  [[0.15]]
grads:  [0.03276169]
Stock Position:  0.03276168703876987
Bond Position:  [14.10570311]


portfolio before change:  [17.41198854]
curr_Stock_Price:  100.70393533250804
curr_Factors:  [100.70393533]
mat_Sqrt:  [[0.15]]
grads:  [0.10979912]
Stock Position:  0.10979912219126224
Bond Position:  [6.35478484]


portfolio before change:  [17.26469118]
curr_Stock_Price:  99.33347312434094
curr_Factors:  [99.33347312]
mat_Sqrt:  [[0.15]]
grads:  [0.12344822]
Stock Position:  0.12344821727375659
Bond Position:  [5.00215101]


portfolio before change:  [17.26408886]
curr_Stock_Price:  99.30832879863186
curr_Factors:  [99.3083288]
mat_Sqrt:  [[0.15]]
grads:  [-0.05738286]
Stock Position:  -0.05738286163495538
Bond Position:  [22.96268495]


portfolio before change:  [17.30340861]
curr_Stock_Price:  98.82324428334823
curr_Factors:  [98.82324428]
mat_Sqrt:  [[0.15]]
grads:  [0.02517336]
Stock Position:  0.025173359636670115
Bond Position:  [14.81569554]


portfolio before change:  [17.30637135]
curr_Stock_Price:  98.64659079327217
curr_Factors:  [98.64659079]
mat_Sqrt:  [[0.15]]
grads:  [0.05654577]
Stock Position:  0.05654577476034912
Bond Position:  [11.72832344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.30637135]
Stock Price:  97.89448884500476
PL:  [17.30637135]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01752469]
 [-0.0182437 ]
 [-0.01312529]
 [ 0.00343309]
 [ 0.00957807]
 [ 0.01835254]
 [-0.00291535]
 [ 0.01247568]
 [ 0.00837967]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.66468526]
curr_Stock_Price:  99.02426165482422
curr_Factors:  [99.02426165]
mat_Sqrt:  [[0.15]]
grads:  [0.11683124]
Stock Position:  0.11683124217993289
Bond Position:  [-25.23381275]


portfolio before change:  [-13.73418978]
curr_Stock_Price:  98.53736736508783
curr_Factors:  [98.53736737]
mat_Sqrt:  [[0.15]]
grads:  [-0.12162466]
Stock Position:  -0.12162466421147189
Bond Position:  [-1.74961556]


portfolio before change:  [-13.72254725]
curr_Stock_Price:  98.434447836517
curr_Factors:  [98.43444784]
mat_Sqrt:  [[0.15]]
grads:  [-0.08750193]
Stock Position:  -0.08750193465465718
Bond Position:  [-5.10934263]


portfolio before change:  [-13.94426303]
curr_Stock_Price:  100.93908353694913
curr_Factors:  [100.93908354]
mat_Sqrt:  [[0.15]]
grads:  [0.0228873]
Stock Position:  0.022887296424063244
Bond Position:  [-16.25448576]


portfolio before change:  [-13.98726208]
curr_Stock_Price:  99.41554099982956
curr_Factors:  [99.415541]
mat_Sqrt:  [[0.15]]
grads:  [0.06385382]
Stock Position:  0.0638538207777315
Bond Position:  [-20.33532422]


portfolio before change:  [-13.96676126]
curr_Stock_Price:  99.89587282405536
curr_Factors:  [99.89587282]
mat_Sqrt:  [[0.15]]
grads:  [0.12235025]
Stock Position:  0.12235025123491022
Bond Position:  [-26.1890464]


portfolio before change:  [-13.97474951]
curr_Stock_Price:  99.93763446979194
curr_Factors:  [99.93763447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01943566]
Stock Position:  -0.019435663537055774
Bond Position:  [-12.03239527]


portfolio before change:  [-14.00572552]
curr_Stock_Price:  101.2217846490542
curr_Factors:  [101.22178465]
mat_Sqrt:  [[0.15]]
grads:  [0.08317118]
Stock Position:  0.08317118079842384
Bond Position:  [-22.42446087]


portfolio before change:  [-14.07987014]
curr_Stock_Price:  100.46515733199811
curr_Factors:  [100.46515733]
mat_Sqrt:  [[0.15]]
grads:  [0.05586449]
Stock Position:  0.05586448507351665
Bond Position:  [-19.69230443]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.07987014]
Stock Price:  99.3009652662963
PL:  [-14.07987014]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [1.54175566e-02]
 [2.05310902e-03]
 [5.80835821e-02]
 [2.79092688e-03]
 [1.24240588e-02]
 [1.71383503e-02]
 [1.98284413e-02]
 [2.80501946e-03]
 [5.90227584e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.73949281]
curr_Stock_Price:  101.06135835072041
curr_Factors:  [101.06135835]
mat_Sqrt:  [[0.15]]
grads:  [0.10278371]
Stock Position:  0.10278371065448623
Bond Position:  [7.35203139]


portfolio before change:  [17.88631927]
curr_Stock_Price:  102.45408418350102
curr_Factors:  [102.45408418]
mat_Sqrt:  [[0.15]]
grads:  [0.01368739]
Stock Position:  0.013687393489693531
Bond Position:  [16.48398991]


portfolio before change:  [17.90504873]
curr_Stock_Price:  103.22014687303472
curr_Factors:  [103.22014687]
mat_Sqrt:  [[0.15]]
grads:  [0.38722388]
Stock Position:  0.3872238803844603
Bond Position:  [-22.06425708]


portfolio before change:  [17.13337712]
curr_Stock_Price:  101.25581369058412
curr_Factors:  [101.25581369]
mat_Sqrt:  [[0.15]]
grads:  [0.01860618]
Stock Position:  0.01860617917215616
Bond Position:  [15.24939331]


portfolio before change:  [17.16520237]
curr_Stock_Price:  102.55638391074031
curr_Factors:  [102.55638391]
mat_Sqrt:  [[0.15]]
grads:  [0.08282706]
Stock Position:  0.08282705873862867
Bond Position:  [8.67075874]


portfolio before change:  [17.15715585]
curr_Stock_Price:  102.4068798507699
curr_Factors:  [102.40687985]
mat_Sqrt:  [[0.15]]
grads:  [0.11425567]
Stock Position:  0.11425566899993962
Bond Position:  [5.45658928]


portfolio before change:  [17.29249203]
curr_Stock_Price:  103.56749800024173
curr_Factors:  [103.567498]
mat_Sqrt:  [[0.15]]
grads:  [0.13218961]
Stock Position:  0.13218960873219482
Bond Position:  [3.60194499]


portfolio before change:  [17.60076019]
curr_Stock_Price:  105.88588549986049
curr_Factors:  [105.8858855]
mat_Sqrt:  [[0.15]]
grads:  [0.01870013]
Stock Position:  0.018700129723163306
Bond Position:  [15.6206804]


portfolio before change:  [17.61637677]
curr_Stock_Price:  106.30322392276177
curr_Factors:  [106.30322392]
mat_Sqrt:  [[0.15]]
grads:  [0.03934851]
Stock Position:  0.03934850561109451
Bond Position:  [13.43350376]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.61637677]
Stock Price:  109.22647458984945
PL:  [8.38990218]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 2.44491638e-03]
 [ 1.56313368e-03]
 [ 6.48086628e-02]
 [ 1.05099937e-02]
 [-8.32646452e-03]
 [ 1.43033232e-02]
 [ 5.39530592e-02]
 [-1.63679190e-02]
 [ 3.67906670e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.09855838]
curr_Stock_Price:  100.56571340025147
curr_Factors:  [100.5657134]
mat_Sqrt:  [[0.15]]
grads:  [0.01629944]
Stock Position:  0.016299442516531377
Bond Position:  [8.45939331]


portfolio before change:  [10.1416886]
curr_Stock_Price:  102.9522656866718
curr_Factors:  [102.95226569]
mat_Sqrt:  [[0.15]]
grads:  [0.01042089]
Stock Position:  0.010420891192241521
Bond Position:  [9.06883424]


portfolio before change:  [10.15225338]
curr_Stock_Price:  103.53083642720095
curr_Factors:  [103.53083643]
mat_Sqrt:  [[0.15]]
grads:  [0.43205775]
Stock Position:  0.43205775198594026
Bond Position:  [-34.57904707]


portfolio before change:  [11.09691995]
curr_Stock_Price:  105.75729901802997
curr_Factors:  [105.75729902]
mat_Sqrt:  [[0.15]]
grads:  [0.07006662]
Stock Position:  0.07006662441514006
Bond Position:  [3.686863]


portfolio before change:  [11.20355546]
curr_Stock_Price:  107.25289856866789
curr_Factors:  [107.25289857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05550976]
Stock Position:  -0.05550976349194904
Bond Position:  [17.15713849]


portfolio before change:  [11.08959254]
curr_Stock_Price:  109.46050357146866
curr_Factors:  [109.46050357]
mat_Sqrt:  [[0.15]]
grads:  [0.09535549]
Stock Position:  0.09535548780818989
Bond Position:  [0.65193283]


portfolio before change:  [11.09618875]
curr_Stock_Price:  109.52625921909866
curr_Factors:  [109.52625922]
mat_Sqrt:  [[0.15]]
grads:  [0.35968706]
Stock Position:  0.3596870612731828
Bond Position:  [-28.29898956]


portfolio before change:  [11.53855054]
curr_Stock_Price:  110.79545922539599
curr_Factors:  [110.79545923]
mat_Sqrt:  [[0.15]]
grads:  [-0.10911946]
Stock Position:  -0.10911945979553242
Bond Position:  [23.6284912]


portfolio before change:  [11.35015126]
curr_Stock_Price:  112.63029670036957
curr_Factors:  [112.6302967]
mat_Sqrt:  [[0.15]]
grads:  [0.02452711]
Stock Position:  0.02452711132288331
Bond Position:  [8.58765544]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.35015126]
Stock Price:  115.45625949854374
PL:  [-4.10610824]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.89169993e-03]
 [-2.40589619e-02]
 [-1.30770207e-02]
 [ 1.83616668e-03]
 [ 9.90758369e-03]
 [ 1.73487479e-02]
 [ 1.03546234e-03]
 [ 2.78561048e-03]
 [ 8.48473593e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.40530995]
curr_Stock_Price:  100.32614323356445
curr_Factors:  [100.32614323]
mat_Sqrt:  [[0.15]]
grads:  [-0.02594467]
Stock Position:  -0.02594466620995975
Bond Position:  [9.00823825]


portfolio before change:  [6.42957344]
curr_Stock_Price:  99.56459002520693
curr_Factors:  [99.56459003]
mat_Sqrt:  [[0.15]]
grads:  [-0.16039308]
Stock Position:  -0.16039307937309424
Bond Position:  [22.39904463]


portfolio before change:  [6.620361]
curr_Stock_Price:  98.44493297706329
curr_Factors:  [98.44493298]
mat_Sqrt:  [[0.15]]
grads:  [-0.08718014]
Stock Position:  -0.08718013773544353
Bond Position:  [15.20280382]


portfolio before change:  [6.61102625]
curr_Stock_Price:  98.63922101259908
curr_Factors:  [98.63922101]
mat_Sqrt:  [[0.15]]
grads:  [0.01224111]
Stock Position:  0.012241111182034126
Bond Position:  [5.40357257]


portfolio before change:  [6.62564197]
curr_Stock_Price:  99.61243871575908
curr_Factors:  [99.61243872]
mat_Sqrt:  [[0.15]]
grads:  [0.06605056]
Stock Position:  0.0660505579576783
Bond Position:  [0.04618482]


portfolio before change:  [6.78431361]
curr_Stock_Price:  102.01436445083448
curr_Factors:  [102.01436445]
mat_Sqrt:  [[0.15]]
grads:  [0.11565832]
Stock Position:  0.11565831953162088
Bond Position:  [-5.01449635]


portfolio before change:  [6.60068795]
curr_Stock_Price:  100.44839164198525
curr_Factors:  [100.44839164]
mat_Sqrt:  [[0.15]]
grads:  [0.00690308]
Stock Position:  0.006903082264223051
Bond Position:  [5.90728444]


portfolio before change:  [6.58814944]
curr_Stock_Price:  98.20404815156614
curr_Factors:  [98.20404815]
mat_Sqrt:  [[0.15]]
grads:  [0.01857074]
Stock Position:  0.01857073654596057
Bond Position:  [4.76442794]


portfolio before change:  [6.5879755]
curr_Stock_Price:  98.06637153568927
curr_Factors:  [98.06637154]
mat_Sqrt:  [[0.15]]
grads:  [0.05656491]
Stock Position:  0.056564906224495816
Bond Position:  [1.04086039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.5879755]
Stock Price:  97.02669317462858
PL:  [6.5879755]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 7.36034413e-02]
 [ 1.61066727e-03]
 [ 1.22901883e-01]
 [ 1.31411727e-02]
 [ 1.84957533e-03]
 [ 1.53033535e-02]
 [ 5.56202565e-02]
 [-1.46568455e-02]
 [ 4.10641929e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [41.81029458]
curr_Stock_Price:  102.62276048818406
curr_Factors:  [102.62276049]
mat_Sqrt:  [[0.15]]
grads:  [0.49068961]
Stock Position:  0.4906896084946281
Bond Position:  [-8.54562759]


portfolio before change:  [41.94399059]
curr_Stock_Price:  102.90393599833337
curr_Factors:  [102.903936]
mat_Sqrt:  [[0.15]]
grads:  [0.01073778]
Stock Position:  0.010737781797348807
Bond Position:  [40.83903058]


portfolio before change:  [41.99996509]
curr_Stock_Price:  106.21466395057688
curr_Factors:  [106.21466395]
mat_Sqrt:  [[0.15]]
grads:  [0.81934589]
Stock Position:  0.8193458888738002
Bond Position:  [-45.02658316]


portfolio before change:  [42.38428071]
curr_Stock_Price:  106.7111997211309
curr_Factors:  [106.71119972]
mat_Sqrt:  [[0.15]]
grads:  [0.08760782]
Stock Position:  0.0876078177962842
Bond Position:  [33.03554537]


portfolio before change:  [42.28053592]
curr_Stock_Price:  105.33841472964644
curr_Factors:  [105.33841473]
mat_Sqrt:  [[0.15]]
grads:  [0.0123305]
Stock Position:  0.012330502227134894
Bond Position:  [40.98166036]


portfolio before change:  [42.32173616]
curr_Stock_Price:  107.0175265831319
curr_Factors:  [107.01752658]
mat_Sqrt:  [[0.15]]
grads:  [0.10202236]
Stock Position:  0.10202235639571056
Bond Position:  [31.40355593]


portfolio before change:  [42.62327973]
curr_Stock_Price:  109.81924446597925
curr_Factors:  [109.81924447]
mat_Sqrt:  [[0.15]]
grads:  [0.37080171]
Stock Position:  0.37080170992247863
Bond Position:  [1.9021161]


portfolio before change:  [42.79526431]
curr_Stock_Price:  110.28049715431706
curr_Factors:  [110.28049715]
mat_Sqrt:  [[0.15]]
grads:  [-0.0977123]
Stock Position:  -0.09771230322125336
Bond Position:  [53.57102569]


portfolio before change:  [42.71129095]
curr_Stock_Price:  111.41408590963647
curr_Factors:  [111.41408591]
mat_Sqrt:  [[0.15]]
grads:  [0.02737613]
Stock Position:  0.027376128601588903
Bond Position:  [39.66120461]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [42.71129095]
Stock Price:  110.4438499333036
PL:  [32.26744102]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.06170035]
 [-0.00670552]
 [-0.01064781]
 [ 0.00281126]
 [ 0.01067589]
 [ 0.0185102 ]
 [-0.00375311]
 [ 0.01003119]
 [ 0.00736901]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.6948857]
curr_Stock_Price:  102.29093895475339
curr_Factors:  [102.29093895]
mat_Sqrt:  [[0.15]]
grads:  [0.41133567]
Stock Position:  0.4113356681548648
Bond Position:  [-5.38102602]


portfolio before change:  [36.00267082]
curr_Stock_Price:  100.61463479569916
curr_Factors:  [100.6146348]
mat_Sqrt:  [[0.15]]
grads:  [-0.04470345]
Stock Position:  -0.044703448629694366
Bond Position:  [40.50049198]


portfolio before change:  [36.09633037]
curr_Stock_Price:  98.9726083903536
curr_Factors:  [98.97260839]
mat_Sqrt:  [[0.15]]
grads:  [-0.07098538]
Stock Position:  -0.07098537891548107
Bond Position:  [43.12193848]


portfolio before change:  [36.10079983]
curr_Stock_Price:  99.21345952594741
curr_Factors:  [99.21345953]
mat_Sqrt:  [[0.15]]
grads:  [0.01874176]
Stock Position:  0.01874176243948997
Bond Position:  [34.24136474]


portfolio before change:  [36.13097995]
curr_Stock_Price:  99.91004103824561
curr_Factors:  [99.91004104]
mat_Sqrt:  [[0.15]]
grads:  [0.0711726]
Stock Position:  0.07117259865508978
Bond Position:  [29.0201227]


portfolio before change:  [36.10642576]
curr_Stock_Price:  99.36112356387045
curr_Factors:  [99.36112356]
mat_Sqrt:  [[0.15]]
grads:  [0.12340134]
Stock Position:  0.12340134437403397
Bond Position:  [23.84512953]


portfolio before change:  [36.17620876]
curr_Stock_Price:  99.82997948433008
curr_Factors:  [99.82997948]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502076]
Stock Position:  -0.025020760456132784
Bond Position:  [38.67403076]


portfolio before change:  [36.12823499]
curr_Stock_Price:  102.52037013599994
curr_Factors:  [102.52037014]
mat_Sqrt:  [[0.15]]
grads:  [0.06687459]
Stock Position:  0.06687458606861776
Bond Position:  [29.27222767]


portfolio before change:  [36.12999101]
curr_Stock_Price:  102.32771472749435
curr_Factors:  [102.32771473]
mat_Sqrt:  [[0.15]]
grads:  [0.04912675]
Stock Position:  0.04912674973997054
Bond Position:  [31.10296298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.12999101]
Stock Price:  105.45563274563392
PL:  [30.67435827]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01742289]
 [-0.02025174]
 [-0.00989235]
 [ 0.00424691]
 [ 0.01319593]
 [ 0.01833776]
 [ 0.01182827]
 [ 0.00881574]
 [ 0.00737441]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.28196538]
curr_Stock_Price:  99.04908756806113
curr_Factors:  [99.04908757]
mat_Sqrt:  [[0.15]]
grads:  [0.11615257]
Stock Position:  0.11615256970431083
Bond Position:  [-24.78677142]


portfolio before change:  [-13.28605427]
curr_Stock_Price:  99.12061066516405
curr_Factors:  [99.12061067]
mat_Sqrt:  [[0.15]]
grads:  [-0.13501163]
Stock Position:  -0.1350116298109663
Bond Position:  [0.09638092]


portfolio before change:  [-13.31592374]
curr_Stock_Price:  99.34220393728039
curr_Factors:  [99.34220394]
mat_Sqrt:  [[0.15]]
grads:  [-0.06594898]
Stock Position:  -0.06594897680691664
Bond Position:  [-6.76440703]


portfolio before change:  [-13.40697013]
curr_Stock_Price:  100.67146404300763
curr_Factors:  [100.67146404]
mat_Sqrt:  [[0.15]]
grads:  [0.02831274]
Stock Position:  0.02831274210691733
Bond Position:  [-16.25725533]


portfolio before change:  [-13.42970113]
curr_Stock_Price:  100.15578320435604
curr_Factors:  [100.1557832]
mat_Sqrt:  [[0.15]]
grads:  [0.08797284]
Stock Position:  0.08797284489968504
Bond Position:  [-22.24069031]


portfolio before change:  [-13.45941305]
curr_Stock_Price:  99.94448168103956
curr_Factors:  [99.94448168]
mat_Sqrt:  [[0.15]]
grads:  [0.12225173]
Stock Position:  0.1222517262236444
Bond Position:  [-25.67779846]


portfolio before change:  [-13.20679163]
curr_Stock_Price:  102.11593182856117
curr_Factors:  [102.11593183]
mat_Sqrt:  [[0.15]]
grads:  [0.07885515]
Stock Position:  0.07885515228382349
Bond Position:  [-21.25915899]


portfolio before change:  [-13.15249651]
curr_Stock_Price:  102.93930677251998
curr_Factors:  [102.93930677]
mat_Sqrt:  [[0.15]]
grads:  [0.05877161]
Stock Position:  0.058771611889206134
Bond Position:  [-19.2024055]


portfolio before change:  [-13.19967027]
curr_Stock_Price:  102.30004998534237
curr_Factors:  [102.30004999]
mat_Sqrt:  [[0.15]]
grads:  [0.04916276]
Stock Position:  0.049162761502252184
Bond Position:  [-18.22902323]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.19967027]
Stock Price:  100.62789208069191
PL:  [-13.82756235]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-1.92770568e-03]
 [-1.99823403e-02]
 [-5.56675193e-02]
 [-8.58857655e-03]
 [-1.16742923e-02]
 [ 1.75087710e-02]
 [-3.07116297e-02]
 [ 2.77941095e-03]
 [ 8.52189367e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-48.70035189]
curr_Stock_Price:  96.75160097250556
curr_Factors:  [96.75160097]
mat_Sqrt:  [[0.15]]
grads:  [-0.01285137]
Stock Position:  -0.012851371211892403
Bond Position:  [-47.45696115]


portfolio before change:  [-48.71787146]
curr_Stock_Price:  96.26800745374618
curr_Factors:  [96.26800745]
mat_Sqrt:  [[0.15]]
grads:  [-0.1332156]
Stock Position:  -0.13321560208173341
Bond Position:  [-35.89347089]


portfolio before change:  [-48.50859974]
curr_Stock_Price:  94.56232923075127
curr_Factors:  [94.56232923]
mat_Sqrt:  [[0.15]]
grads:  [-0.3711168]
Stock Position:  -0.37111679546785153
Bond Position:  [-13.41493114]


portfolio before change:  [-48.51156041]
curr_Stock_Price:  94.55222871971527
curr_Factors:  [94.55222872]
mat_Sqrt:  [[0.15]]
grads:  [-0.05725718]
Stock Position:  -0.05725717702886504
Bond Position:  [-43.09776671]


portfolio before change:  [-48.54642478]
curr_Stock_Price:  94.78469030288522
curr_Factors:  [94.7846903]
mat_Sqrt:  [[0.15]]
grads:  [-0.07782862]
Stock Position:  -0.07782861536075772
Bond Position:  [-41.16946357]


portfolio before change:  [-48.68222523]
curr_Stock_Price:  96.26500154561467
curr_Factors:  [96.26500155]
mat_Sqrt:  [[0.15]]
grads:  [0.11672514]
Stock Position:  0.11672514028917744
Bond Position:  [-59.91877104]


portfolio before change:  [-48.67597846]
curr_Stock_Price:  96.57524871825126
curr_Factors:  [96.57524872]
mat_Sqrt:  [[0.15]]
grads:  [-0.2047442]
Stock Position:  -0.20474419768755162
Bond Position:  [-28.90275664]


portfolio before change:  [-49.02240071]
curr_Stock_Price:  98.19662438190961
curr_Factors:  [98.19662438]
mat_Sqrt:  [[0.15]]
grads:  [0.01852941]
Stock Position:  0.018529406351538973
Bond Position:  [-50.84192587]


portfolio before change:  [-49.07517693]
curr_Stock_Price:  96.72065161584054
curr_Factors:  [96.72065162]
mat_Sqrt:  [[0.15]]
grads:  [0.05681262]
Stock Position:  0.05681262445820621
Bond Position:  [-54.57013099]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-49.07517693]
Stock Price:  98.61344345979678
PL:  [-49.07517693]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.19851980e-02]
 [-2.54894333e-02]
 [ 8.74942608e-03]
 [ 2.28575905e-03]
 [ 1.64229193e-02]
 [ 1.78845949e-02]
 [-2.95740159e-03]
 [ 1.23524750e-02]
 [ 7.31227572e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.78006631]
curr_Stock_Price:  100.9342561148811
curr_Factors:  [100.93425611]
mat_Sqrt:  [[0.15]]
grads:  [0.07990132]
Stock Position:  0.07990131997508197
Bond Position:  [7.71528601]


portfolio before change:  [15.68253883]
curr_Stock_Price:  99.66536491638527
curr_Factors:  [99.66536492]
mat_Sqrt:  [[0.15]]
grads:  [-0.16992956]
Stock Position:  -0.16992955557085979
Bond Position:  [32.61863]


portfolio before change:  [15.44585366]
curr_Stock_Price:  101.15420873243029
curr_Factors:  [101.15420873]
mat_Sqrt:  [[0.15]]
grads:  [0.05832951]
Stock Position:  0.05832950720262218
Bond Position:  [9.54557851]


portfolio before change:  [15.47887765]
curr_Stock_Price:  101.63852634444869
curr_Factors:  [101.63852634]
mat_Sqrt:  [[0.15]]
grads:  [0.01523839]
Stock Position:  0.015238393691173082
Bond Position:  [13.93006977]


portfolio before change:  [15.48939967]
curr_Stock_Price:  101.87183484897342
curr_Factors:  [101.87183485]
mat_Sqrt:  [[0.15]]
grads:  [0.10948613]
Stock Position:  0.1094861289120325
Bond Position:  [4.33584683]


portfolio before change:  [15.42204299]
curr_Stock_Price:  101.23682156715756
curr_Factors:  [101.23682157]
mat_Sqrt:  [[0.15]]
grads:  [0.11923063]
Stock Position:  0.11923063238410399
Bond Position:  [3.35151274]


portfolio before change:  [15.26817197]
curr_Stock_Price:  99.93223066745493
curr_Factors:  [99.93223067]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971601]
Stock Position:  -0.01971601060741479
Bond Position:  [17.23843689]


portfolio before change:  [15.24154024]
curr_Stock_Price:  101.72027526369928
curr_Factors:  [101.72027526]
mat_Sqrt:  [[0.15]]
grads:  [0.08234983]
Stock Position:  0.08234983345969013
Bond Position:  [6.86489251]


portfolio before change:  [15.31692998]
curr_Stock_Price:  102.59406494258536
curr_Factors:  [102.59406494]
mat_Sqrt:  [[0.15]]
grads:  [0.0487485]
Stock Position:  0.04874850481771726
Bond Position:  [10.31562271]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.31692998]
Stock Price:  102.11900254259584
PL:  [13.19792743]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01825681]
 [-0.01753365]
 [-0.02653833]
 [-0.0030418 ]
 [-0.01574645]
 [ 0.01694885]
 [-0.04037547]
 [-0.00404275]
 [ 0.00854807]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.41711686]
curr_Stock_Price:  98.84571950906835
curr_Factors:  [98.84571951]
mat_Sqrt:  [[0.15]]
grads:  [0.1217121]
Stock Position:  0.12171209546040493
Bond Position:  [-28.44783651]


portfolio before change:  [-16.69411072]
curr_Stock_Price:  96.68680192590871
curr_Factors:  [96.68680193]
mat_Sqrt:  [[0.15]]
grads:  [-0.116891]
Stock Position:  -0.11689100339559264
Bond Position:  [-5.39229343]


portfolio before change:  [-16.73749893]
curr_Stock_Price:  97.03491588135913
curr_Factors:  [97.03491588]
mat_Sqrt:  [[0.15]]
grads:  [-0.17692221]
Stock Position:  -0.17692221071199019
Bond Position:  [0.4301329]


portfolio before change:  [-16.62342638]
curr_Stock_Price:  96.39137072717915
curr_Factors:  [96.39137073]
mat_Sqrt:  [[0.15]]
grads:  [-0.02027866]
Stock Position:  -0.020278664814969313
Bond Position:  [-14.66873808]


portfolio before change:  [-16.58391345]
curr_Stock_Price:  94.08110364258664
curr_Factors:  [94.08110364]
mat_Sqrt:  [[0.15]]
grads:  [-0.10497631]
Stock Position:  -0.10497630782312822
Bond Position:  [-6.70762656]


portfolio before change:  [-16.70551413]
curr_Stock_Price:  95.20751043780535
curr_Factors:  [95.20751044]
mat_Sqrt:  [[0.15]]
grads:  [0.11299232]
Stock Position:  0.11299231607646869
Bond Position:  [-27.46323124]


portfolio before change:  [-16.90952606]
curr_Stock_Price:  93.52352970316626
curr_Factors:  [93.5235297]
mat_Sqrt:  [[0.15]]
grads:  [-0.2691698]
Stock Position:  -0.2691697978382186
Bond Position:  [8.26418352]


portfolio before change:  [-17.38667799]
curr_Stock_Price:  95.31156480788819
curr_Factors:  [95.31156481]
mat_Sqrt:  [[0.15]]
grads:  [-0.0269517]
Stock Position:  -0.026951696555690206
Bond Position:  [-14.81786961]


portfolio before change:  [-17.38815988]
curr_Stock_Price:  95.09158256825766
curr_Factors:  [95.09158257]
mat_Sqrt:  [[0.15]]
grads:  [0.05698717]
Stock Position:  0.056987165135817995
Bond Position:  [-22.8071596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.38815988]
Stock Price:  94.61247024895147
PL:  [-17.38815988]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.05769542]
 [0.00266043]
 [0.04820238]
 [0.00317286]
 [0.01135381]
 [0.01681699]
 [0.02530869]
 [0.00482568]
 [0.00585957]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [34.97375016]
curr_Stock_Price:  102.17929395290992
curr_Factors:  [102.17929395]
mat_Sqrt:  [[0.15]]
grads:  [0.38463616]
Stock Position:  0.38463616277942136
Bond Position:  [-4.32810138]


portfolio before change:  [34.83976862]
curr_Stock_Price:  101.83658841111435
curr_Factors:  [101.83658841]
mat_Sqrt:  [[0.15]]
grads:  [0.01773622]
Stock Position:  0.01773622177081239
Bond Position:  [33.03357231]


portfolio before change:  [34.87273209]
curr_Stock_Price:  102.76364881455689
curr_Factors:  [102.76364881]
mat_Sqrt:  [[0.15]]
grads:  [0.3213492]
Stock Position:  0.32134919916112537
Bond Position:  [1.84971584]


portfolio before change:  [34.98088069]
curr_Stock_Price:  103.09731546583812
curr_Factors:  [103.09731547]
mat_Sqrt:  [[0.15]]
grads:  [0.02115243]
Stock Position:  0.02115242849518599
Bond Position:  [32.8001221]


portfolio before change:  [34.99749859]
curr_Stock_Price:  103.10742017167165
curr_Factors:  [103.10742017]
mat_Sqrt:  [[0.15]]
grads:  [0.0756921]
Stock Position:  0.0756920961801262
Bond Position:  [27.19308183]


portfolio before change:  [35.00637761]
curr_Stock_Price:  103.04505010605324
curr_Factors:  [103.04505011]
mat_Sqrt:  [[0.15]]
grads:  [0.1121133]
Stock Position:  0.11211329578531558
Bond Position:  [23.45365743]


portfolio before change:  [35.18445991]
curr_Stock_Price:  104.52883963174632
curr_Factors:  [104.52883963]
mat_Sqrt:  [[0.15]]
grads:  [0.16872458]
Stock Position:  0.1687245845983341
Bond Position:  [17.54787486]


portfolio before change:  [35.20579599]
curr_Stock_Price:  104.6032802225599
curr_Factors:  [104.60328022]
mat_Sqrt:  [[0.15]]
grads:  [0.03217118]
Stock Position:  0.03217117515075638
Bond Position:  [31.84058555]


portfolio before change:  [35.28031956]
curr_Stock_Price:  106.42476447215414
curr_Factors:  [106.42476447]
mat_Sqrt:  [[0.15]]
grads:  [0.03906379]
Stock Position:  0.03906379252688195
Bond Position:  [31.12296464]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [35.28031956]
Stock Price:  104.37857349234783
PL:  [30.90174606]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [5.77796248e-02]
 [3.66154682e-04]
 [9.47080069e-02]
 [2.13593801e-03]
 [9.52536677e-03]
 [1.63250652e-02]
 [2.76876852e-02]
 [5.40711233e-03]
 [6.28348842e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.00993569]
curr_Stock_Price:  102.18164120172011
curr_Factors:  [102.1816412]
mat_Sqrt:  [[0.15]]
grads:  [0.3851975]
Stock Position:  0.3851974989896495
Bond Position:  [-4.35017694]


portfolio before change:  [35.7733981]
curr_Stock_Price:  104.1692918139179
curr_Factors:  [104.16929181]
mat_Sqrt:  [[0.15]]
grads:  [0.00244103]
Stock Position:  0.002441031210675612
Bond Position:  [35.51911761]


portfolio before change:  [35.79297543]
curr_Stock_Price:  104.91214533049529
curr_Factors:  [104.91214533]
mat_Sqrt:  [[0.15]]
grads:  [0.63138671]
Stock Position:  0.6313867129433725
Bond Position:  [-30.44715916]


portfolio before change:  [33.78249323]
curr_Stock_Price:  101.7520300277415
curr_Factors:  [101.75203003]
mat_Sqrt:  [[0.15]]
grads:  [0.01423959]
Stock Position:  0.014239586746140722
Bond Position:  [32.33358637]


portfolio before change:  [33.82916937]
curr_Stock_Price:  103.89431871043497
curr_Factors:  [103.89431871]
mat_Sqrt:  [[0.15]]
grads:  [0.06350245]
Stock Position:  0.0635024451134495
Bond Position:  [27.2316261]


portfolio before change:  [33.87621319]
curr_Stock_Price:  104.42067013023353
curr_Factors:  [104.42067013]
mat_Sqrt:  [[0.15]]
grads:  [0.10883377]
Stock Position:  0.10883376831180624
Bond Position:  [22.51171817]


portfolio before change:  [33.94432863]
curr_Stock_Price:  104.94308856282133
curr_Factors:  [104.94308856]
mat_Sqrt:  [[0.15]]
grads:  [0.18458457]
Stock Position:  0.18458456777832055
Bond Position:  [14.57345399]


portfolio before change:  [33.82862868]
curr_Stock_Price:  104.27678961301447
curr_Factors:  [104.27678961]
mat_Sqrt:  [[0.15]]
grads:  [0.03604742]
Stock Position:  0.03604741556089596
Bond Position:  [30.06971991]


portfolio before change:  [33.87760717]
curr_Stock_Price:  105.21832387803849
curr_Factors:  [105.21832388]
mat_Sqrt:  [[0.15]]
grads:  [0.04188992]
Stock Position:  0.04188992277055089
Bond Position:  [29.47001971]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.87760717]
Stock Price:  107.02746616894841
PL:  [26.850141]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.84820916e-02]
 [-2.15916272e-02]
 [-1.93051477e-02]
 [-2.97260439e-04]
 [ 2.24120435e-03]
 [ 1.71558121e-02]
 [-2.91413859e-02]
 [-4.18929950e-03]
 [ 8.54898689e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.99777403]
curr_Stock_Price:  98.61345280661796
curr_Factors:  [98.61345281]
mat_Sqrt:  [[0.15]]
grads:  [0.12321394]
Stock Position:  0.1232139441783293
Bond Position:  [-32.1483265]


portfolio before change:  [-19.93117732]
curr_Stock_Price:  99.28443929433247
curr_Factors:  [99.28443929]
mat_Sqrt:  [[0.15]]
grads:  [-0.14394418]
Stock Position:  -0.1439441815509522
Bond Position:  [-5.63975997]


portfolio before change:  [-19.69976873]
curr_Stock_Price:  97.6572170546238
curr_Factors:  [97.65721705]
mat_Sqrt:  [[0.15]]
grads:  [-0.12870098]
Stock Position:  -0.1287009844396541
Bond Position:  [-7.13118876]


portfolio before change:  [-19.69281286]
curr_Stock_Price:  97.57545884398976
curr_Factors:  [97.57545884]
mat_Sqrt:  [[0.15]]
grads:  [-0.00198174]
Stock Position:  -0.0019817362606008226
Bond Position:  [-19.49944403]


portfolio before change:  [-19.70179918]
curr_Stock_Price:  97.18900952280647
curr_Factors:  [97.18900952]
mat_Sqrt:  [[0.15]]
grads:  [0.01494136]
Stock Position:  0.014941362307791448
Bond Position:  [-21.15393538]


portfolio before change:  [-19.73617054]
curr_Stock_Price:  95.59666795272845
curr_Factors:  [95.59666795]
mat_Sqrt:  [[0.15]]
grads:  [0.11437208]
Stock Position:  0.11437208059724704
Bond Position:  [-30.66976035]


portfolio before change:  [-19.60983309]
curr_Stock_Price:  96.83539823765686
curr_Factors:  [96.83539824]
mat_Sqrt:  [[0.15]]
grads:  [-0.19427591]
Stock Position:  -0.19427590586444135
Bond Position:  [-0.79704838]


portfolio before change:  [-19.30416693]
curr_Stock_Price:  95.25998522284802
curr_Factors:  [95.25998522]
mat_Sqrt:  [[0.15]]
grads:  [-0.02792866]
Stock Position:  -0.027928663332098553
Bond Position:  [-16.64368287]


portfolio before change:  [-19.30616457]
curr_Stock_Price:  95.03346942399135
curr_Factors:  [95.03346942]
mat_Sqrt:  [[0.15]]
grads:  [0.05699325]
Stock Position:  0.0569932459410604
Bond Position:  [-24.72243046]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.30616457]
Stock Price:  95.34848879289501
PL:  [-19.30616457]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.85299485e-02]
 [-1.73171342e-02]
 [-1.50074937e-02]
 [ 5.19607641e-04]
 [ 4.15768860e-03]
 [ 1.77748381e-02]
 [-2.68646102e-02]
 [ 2.19267055e-03]
 [ 8.41351057e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.44396345]
curr_Stock_Price:  98.77911099033166
curr_Factors:  [98.77911099]
mat_Sqrt:  [[0.15]]
grads:  [0.12353299]
Stock Position:  0.12353298993776615
Bond Position:  [-29.64644237]


portfolio before change:  [-17.55554974]
curr_Stock_Price:  97.99584361055979
curr_Factors:  [97.99584361]
mat_Sqrt:  [[0.15]]
grads:  [-0.11544756]
Stock Position:  -0.11544756116932144
Bond Position:  [-6.24216859]


portfolio before change:  [-17.5651234]
curr_Stock_Price:  98.05172867074529
curr_Factors:  [98.05172867]
mat_Sqrt:  [[0.15]]
grads:  [-0.10004996]
Stock Position:  -0.10004995811679056
Bond Position:  [-7.75505205]


portfolio before change:  [-17.55809327]
curr_Stock_Price:  97.94269696063537
curr_Factors:  [97.94269696]
mat_Sqrt:  [[0.15]]
grads:  [0.00346405]
Stock Position:  0.003464050939086024
Bond Position:  [-17.89737176]


portfolio before change:  [-17.56850515]
curr_Stock_Price:  97.52095082236659
curr_Factors:  [97.52095082]
mat_Sqrt:  [[0.15]]
grads:  [0.02771792]
Stock Position:  0.02771792400902199
Bond Position:  [-20.27158345]


portfolio before change:  [-17.59947571]
curr_Stock_Price:  96.7693707606719
curr_Factors:  [96.76937076]
mat_Sqrt:  [[0.15]]
grads:  [0.11849892]
Stock Position:  0.11849892071934222
Bond Position:  [-29.06654171]


portfolio before change:  [-17.56132087]
curr_Stock_Price:  97.21403093565687
curr_Factors:  [97.21403094]
mat_Sqrt:  [[0.15]]
grads:  [-0.1790974]
Stock Position:  -0.17909740107475333
Bond Position:  [-0.15054058]


portfolio before change:  [-17.6468108]
curr_Stock_Price:  97.69094823939992
curr_Factors:  [97.69094824]
mat_Sqrt:  [[0.15]]
grads:  [0.0146178]
Stock Position:  0.014617803660550483
Bond Position:  [-19.07483791]


portfolio before change:  [-17.62559231]
curr_Stock_Price:  99.7951154043204
curr_Factors:  [99.7951154]
mat_Sqrt:  [[0.15]]
grads:  [0.05609007]
Stock Position:  0.05609007043519697
Bond Position:  [-23.22310736]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.62559231]
Stock Price:  100.83143170275511
PL:  [-18.45702401]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.33334769e-03]
 [-1.54804842e-02]
 [-3.19040916e-02]
 [-1.77870293e-03]
 [ 2.57285778e-03]
 [ 1.75767860e-02]
 [-3.47369845e-02]
 [-5.25205615e-03]
 [ 8.55058859e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-45.66932179]
curr_Stock_Price:  96.94821498338322
curr_Factors:  [96.94821498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01555565]
Stock Position:  -0.015555651275707752
Bond Position:  [-44.16122916]


portfolio before change:  [-45.7008841]
curr_Stock_Price:  97.55739384438549
curr_Factors:  [97.55739384]
mat_Sqrt:  [[0.15]]
grads:  [-0.10320323]
Stock Position:  -0.10320322810193305
Bond Position:  [-35.63264613]


portfolio before change:  [-45.61777807]
curr_Stock_Price:  96.57945153527362
curr_Factors:  [96.57945154]
mat_Sqrt:  [[0.15]]
grads:  [-0.21269394]
Stock Position:  -0.21269394374202677
Bond Position:  [-25.07591364]


portfolio before change:  [-45.71374251]
curr_Stock_Price:  96.97167398911348
curr_Factors:  [96.97167399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01185802]
Stock Position:  -0.01185801953802041
Bond Position:  [-44.5638505]


portfolio before change:  [-45.73928667]
curr_Stock_Price:  97.24631259659314
curr_Factors:  [97.2463126]
mat_Sqrt:  [[0.15]]
grads:  [0.01715239]
Stock Position:  0.017152385216680964
Bond Position:  [-47.40729289]


portfolio before change:  [-45.77761657]
curr_Stock_Price:  96.39393386196124
curr_Factors:  [96.39393386]
mat_Sqrt:  [[0.15]]
grads:  [0.11717857]
Stock Position:  0.11717857323616132
Bond Position:  [-57.07292021]


portfolio before change:  [-45.93346188]
curr_Stock_Price:  95.30754316105019
curr_Factors:  [95.30754316]
mat_Sqrt:  [[0.15]]
grads:  [-0.2315799]
Stock Position:  -0.23157989676659285
Bond Position:  [-23.86215087]


portfolio before change:  [-45.84775783]
curr_Stock_Price:  94.8859257813712
curr_Factors:  [94.88592578]
mat_Sqrt:  [[0.15]]
grads:  [-0.03501371]
Stock Position:  -0.03501370766582051
Bond Position:  [-42.52544976]


portfolio before change:  [-45.83473443]
curr_Stock_Price:  93.90655382846943
curr_Factors:  [93.90655383]
mat_Sqrt:  [[0.15]]
grads:  [0.05700392]
Stock Position:  0.05700392393763374
Bond Position:  [-51.18777648]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-45.83473443]
Stock Price:  91.58806184435639
PL:  [-45.83473443]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.77711457e-02]
 [ 2.08382345e-03]
 [ 3.56765396e-02]
 [ 4.82581238e-03]
 [ 8.90808912e-03]
 [ 1.83057642e-02]
 [-4.15819443e-03]
 [ 7.36489882e-03]
 [ 8.49468589e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.65102187]
curr_Stock_Price:  101.12048656125152
curr_Factors:  [101.12048656]
mat_Sqrt:  [[0.15]]
grads:  [0.1184743]
Stock Position:  0.11847430466674129
Bond Position:  [6.67084254]


portfolio before change:  [18.80865537]
curr_Stock_Price:  102.42285535011843
curr_Factors:  [102.42285535]
mat_Sqrt:  [[0.15]]
grads:  [0.01389216]
Stock Position:  0.01389215632280158
Bond Position:  [17.38578105]


portfolio before change:  [18.81405162]
curr_Stock_Price:  102.18539683021768
curr_Factors:  [102.18539683]
mat_Sqrt:  [[0.15]]
grads:  [0.2378436]
Stock Position:  0.2378435970205548
Bond Position:  [-5.49009073]


portfolio before change:  [18.275542]
curr_Stock_Price:  99.93280775204175
curr_Factors:  [99.93280775]
mat_Sqrt:  [[0.15]]
grads:  [0.03217208]
Stock Position:  0.03217208250827399
Bond Position:  [15.06049546]


portfolio before change:  [18.25854705]
curr_Stock_Price:  99.17043633350822
curr_Factors:  [99.17043633]
mat_Sqrt:  [[0.15]]
grads:  [0.05938726]
Stock Position:  0.05938726077296117
Bond Position:  [12.36908649]


portfolio before change:  [18.18102395]
curr_Stock_Price:  97.760888278251
curr_Factors:  [97.76088828]
mat_Sqrt:  [[0.15]]
grads:  [0.12203843]
Stock Position:  0.12203842781952387
Bond Position:  [6.25043884]


portfolio before change:  [18.43030601]
curr_Stock_Price:  99.77792557387653
curr_Factors:  [99.77792557]
mat_Sqrt:  [[0.15]]
grads:  [-0.0277213]
Stock Position:  -0.027721296187504785
Bond Position:  [21.19627943]


portfolio before change:  [18.44467528]
curr_Stock_Price:  99.64198385702828
curr_Factors:  [99.64198386]
mat_Sqrt:  [[0.15]]
grads:  [0.04909933]
Stock Position:  0.04909932547272094
Bond Position:  [13.55232108]


portfolio before change:  [18.3860944]
curr_Stock_Price:  98.31083048482176
curr_Factors:  [98.31083048]
mat_Sqrt:  [[0.15]]
grads:  [0.05663124]
Stock Position:  0.05663123925749358
Bond Position:  [12.81863024]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.3860944]
Stock Price:  99.46398013716927
PL:  [18.3860944]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.79661570e-02]
 [-1.84195269e-02]
 [-1.52025496e-02]
 [-1.68946002e-03]
 [-2.20012472e-02]
 [ 1.61329032e-02]
 [-4.01051421e-02]
 [-3.58195789e-03]
 [ 8.52799073e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.32439214]
curr_Stock_Price:  98.91660134882734
curr_Factors:  [98.91660135]
mat_Sqrt:  [[0.15]]
grads:  [0.11977438]
Stock Position:  0.11977438008990288
Bond Position:  [-27.17206675]


portfolio before change:  [-15.18243436]
curr_Stock_Price:  100.21526981739002
curr_Factors:  [100.21526982]
mat_Sqrt:  [[0.15]]
grads:  [-0.12279685]
Stock Position:  -0.12279684614635716
Bond Position:  [-2.87631529]


portfolio before change:  [-15.16741752]
curr_Stock_Price:  100.0812650880063
curr_Factors:  [100.08126509]
mat_Sqrt:  [[0.15]]
grads:  [-0.10135033]
Stock Position:  -0.10135033068501244
Bond Position:  [-5.02414821]


portfolio before change:  [-14.8582603]
curr_Stock_Price:  97.00609082421602
curr_Factors:  [97.00609082]
mat_Sqrt:  [[0.15]]
grads:  [-0.01126307]
Stock Position:  -0.011263066806517329
Bond Position:  [-13.76567422]


portfolio before change:  [-14.82002848]
curr_Stock_Price:  93.00039924379782
curr_Factors:  [93.00039924]
mat_Sqrt:  [[0.15]]
grads:  [-0.14667498]
Stock Position:  -0.14667498165614204
Bond Position:  [-1.17919663]


portfolio before change:  [-14.78307321]
curr_Stock_Price:  92.74442499820255
curr_Factors:  [92.744425]
mat_Sqrt:  [[0.15]]
grads:  [0.10755269]
Stock Position:  0.10755268825343688
Bond Position:  [-24.75798544]


portfolio before change:  [-14.70302729]
curr_Stock_Price:  93.60379921079607
curr_Factors:  [93.60379921]
mat_Sqrt:  [[0.15]]
grads:  [-0.26736761]
Stock Position:  -0.26736761378480445
Bond Position:  [10.32359714]


portfolio before change:  [-15.19782897]
curr_Stock_Price:  95.47375181084928
curr_Factors:  [95.47375181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02387972]
Stock Position:  -0.02387971927369425
Bond Position:  [-12.91794258]


portfolio before change:  [-15.22571987]
curr_Stock_Price:  96.37117942076662
curr_Factors:  [96.37117942]
mat_Sqrt:  [[0.15]]
grads:  [0.05685327]
Stock Position:  0.05685327151592954
Bond Position:  [-20.7047367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.22571987]
Stock Price:  96.73926598190828
PL:  [-15.22571987]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 5.26641164e-02]
 [-2.03590665e-02]
 [ 4.05447395e-03]
 [ 4.90226446e-03]
 [ 5.38857003e-03]
 [ 1.77007908e-02]
 [-3.32401128e-02]
 [-1.35749111e-03]
 [ 8.43445486e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.81152209]
curr_Stock_Price:  102.03903657540891
curr_Factors:  [102.03903658]
mat_Sqrt:  [[0.15]]
grads:  [0.35109411]
Stock Position:  0.3510941094613187
Bond Position:  [-3.01378259]


portfolio before change:  [32.14791068]
curr_Stock_Price:  100.15320561280934
curr_Factors:  [100.15320561]
mat_Sqrt:  [[0.15]]
grads:  [-0.13572711]
Stock Position:  -0.13572710985495928
Bond Position:  [45.74141582]


portfolio before change:  [32.05443414]
curr_Stock_Price:  101.01046222477221
curr_Factors:  [101.01046222]
mat_Sqrt:  [[0.15]]
grads:  [0.02702983]
Stock Position:  0.027029826322582547
Bond Position:  [29.32413889]


portfolio before change:  [32.04509253]
curr_Stock_Price:  100.12228232912405
curr_Factors:  [100.12228233]
mat_Sqrt:  [[0.15]]
grads:  [0.03268176]
Stock Position:  0.03268176307468954
Bond Position:  [28.77291982]


portfolio before change:  [31.99457199]
curr_Stock_Price:  98.13614099466658
curr_Factors:  [98.13614099]
mat_Sqrt:  [[0.15]]
grads:  [0.0359238]
Stock Position:  0.03592380020971472
Bond Position:  [28.46914887]


portfolio before change:  [31.95466801]
curr_Stock_Price:  96.62900327095639
curr_Factors:  [96.62900327]
mat_Sqrt:  [[0.15]]
grads:  [0.11800527]
Stock Position:  0.1180052722196801
Bond Position:  [20.55193617]


portfolio before change:  [31.87332956]
curr_Stock_Price:  95.85262286938209
curr_Factors:  [95.85262287]
mat_Sqrt:  [[0.15]]
grads:  [-0.22160075]
Stock Position:  -0.22160075181174255
Bond Position:  [53.11434286]


portfolio before change:  [31.8103497]
curr_Stock_Price:  96.2566994415462
curr_Factors:  [96.25669944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00904994]
Stock Position:  -0.009049940742855592
Bond Position:  [32.68146713]


portfolio before change:  [31.79858062]
curr_Stock_Price:  99.36322828562042
curr_Factors:  [99.36322829]
mat_Sqrt:  [[0.15]]
grads:  [0.0562297]
Stock Position:  0.05622969907393624
Bond Position:  [26.2114162]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [31.79858062]
Stock Price:  97.55210043411437
PL:  [31.79858062]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00462471]
 [-0.02531529]
 [ 0.04430318]
 [ 0.00336606]
 [ 0.01314413]
 [ 0.01740914]
 [ 0.01495188]
 [ 0.01245118]
 [ 0.00840124]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.38780222]
curr_Stock_Price:  99.75575990071384
curr_Factors:  [99.7557599]
mat_Sqrt:  [[0.15]]
grads:  [-0.0308314]
Stock Position:  -0.030831404038708817
Bond Position:  [0.68780792]


portfolio before change:  [-2.39470209]
curr_Stock_Price:  99.99071046848856
curr_Factors:  [99.99071047]
mat_Sqrt:  [[0.15]]
grads:  [-0.16876863]
Stock Position:  -0.1687686290454088
Bond Position:  [14.48059303]


portfolio before change:  [-2.82504337]
curr_Stock_Price:  102.58351100187438
curr_Factors:  [102.583511]
mat_Sqrt:  [[0.15]]
grads:  [0.29535452]
Stock Position:  0.2953545190823146
Bond Position:  [-33.12354693]


portfolio before change:  [-2.66916746]
curr_Stock_Price:  103.16735793451436
curr_Factors:  [103.16735793]
mat_Sqrt:  [[0.15]]
grads:  [0.02244043]
Stock Position:  0.022440433089321223
Bond Position:  [-4.98428765]


portfolio before change:  [-2.68864095]
curr_Stock_Price:  102.41065555733596
curr_Factors:  [102.41065556]
mat_Sqrt:  [[0.15]]
grads:  [0.08762756]
Stock Position:  0.0876275571864794
Bond Position:  [-11.66263653]


portfolio before change:  [-2.73907318]
curr_Stock_Price:  101.90168954558841
curr_Factors:  [101.90168955]
mat_Sqrt:  [[0.15]]
grads:  [0.11606096]
Stock Position:  0.11606096237258087
Bond Position:  [-14.56588133]


portfolio before change:  [-2.65571475]
curr_Stock_Price:  102.68268594875559
curr_Factors:  [102.68268595]
mat_Sqrt:  [[0.15]]
grads:  [0.09967923]
Stock Position:  0.09967922736229418
Bond Position:  [-12.89104554]


portfolio before change:  [-2.82174977]
curr_Stock_Price:  101.08167144696074
curr_Factors:  [101.08167145]
mat_Sqrt:  [[0.15]]
grads:  [0.08300786]
Stock Position:  0.08300785579391028
Bond Position:  [-11.21232258]


portfolio before change:  [-2.90194275]
curr_Stock_Price:  100.18313704790629
curr_Factors:  [100.18313705]
mat_Sqrt:  [[0.15]]
grads:  [0.05600824]
Stock Position:  0.05600824312308523
Bond Position:  [-8.51302424]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.90194275]
Stock Price:  99.36885692184542
PL:  [-2.90194275]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.49243524e-03]
 [-2.18873759e-02]
 [-2.39121612e-02]
 [-3.04076832e-03]
 [ 1.60456370e-03]
 [ 1.82436406e-02]
 [-2.90341892e-02]
 [ 1.83575901e-03]
 [ 8.48131675e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.92532509]
curr_Stock_Price:  99.78575943268653
curr_Factors:  [99.78575943]
mat_Sqrt:  [[0.15]]
grads:  [-0.02994957]
Stock Position:  -0.029949568291643656
Bond Position:  [1.06321533]


portfolio before change:  [-1.80968019]
curr_Stock_Price:  95.94219306420597
curr_Factors:  [95.94219306]
mat_Sqrt:  [[0.15]]
grads:  [-0.14591584]
Stock Position:  -0.14591583933164176
Bond Position:  [12.18980543]


portfolio before change:  [-1.99555667]
curr_Stock_Price:  97.2578343514005
curr_Factors:  [97.25783435]
mat_Sqrt:  [[0.15]]
grads:  [-0.15941441]
Stock Position:  -0.15941440781519198
Bond Position:  [13.5087434]


portfolio before change:  [-1.85076094]
curr_Stock_Price:  96.39191722668679
curr_Factors:  [96.39191723]
mat_Sqrt:  [[0.15]]
grads:  [-0.02027179]
Stock Position:  -0.02027178883251124
Bond Position:  [0.10327565]


portfolio before change:  [-1.86463791]
curr_Stock_Price:  97.07901076555457
curr_Factors:  [97.07901077]
mat_Sqrt:  [[0.15]]
grads:  [0.01069709]
Stock Position:  0.010697091343571836
Bond Position:  [-2.90310095]


portfolio before change:  [-1.86001681]
curr_Stock_Price:  97.64673638741809
curr_Factors:  [97.64673639]
mat_Sqrt:  [[0.15]]
grads:  [0.12162427]
Stock Position:  0.12162427059681859
Bond Position:  [-13.7362299]


portfolio before change:  [-1.96339685]
curr_Stock_Price:  96.8532252689027
curr_Factors:  [96.85322527]
mat_Sqrt:  [[0.15]]
grads:  [-0.19356126]
Stock Position:  -0.19356126161797133
Bond Position:  [16.78363562]


portfolio before change:  [-2.06254794]
curr_Stock_Price:  97.40883752188705
curr_Factors:  [97.40883752]
mat_Sqrt:  [[0.15]]
grads:  [0.01223839]
Stock Position:  0.012238393397565364
Bond Position:  [-3.25467562]


portfolio before change:  [-2.04978339]
curr_Stock_Price:  98.58483306218658
curr_Factors:  [98.58483306]
mat_Sqrt:  [[0.15]]
grads:  [0.05654211]
Stock Position:  0.056542111691066516
Bond Position:  [-7.62397803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.04978339]
Stock Price:  99.19241958474613
PL:  [-2.04978339]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.82196747e-02]
 [-1.13059204e-02]
 [ 9.36230329e-04]
 [ 4.76935649e-03]
 [ 8.24429160e-03]
 [ 1.76617720e-02]
 [ 9.17177441e-03]
 [ 1.17108345e-02]
 [ 6.49103450e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.2774906]
curr_Stock_Price:  98.85477665440222
curr_Factors:  [98.85477665]
mat_Sqrt:  [[0.15]]
grads:  [0.1214645]
Stock Position:  0.12146449791234387
Bond Position:  [-28.28483641]


portfolio before change:  [-16.09692691]
curr_Stock_Price:  100.45779354714462
curr_Factors:  [100.45779355]
mat_Sqrt:  [[0.15]]
grads:  [-0.0753728]
Stock Position:  -0.07537280281852929
Bond Position:  [-8.52514145]


portfolio before change:  [-16.13525991]
curr_Stock_Price:  100.90980483386758
curr_Factors:  [100.90980483]
mat_Sqrt:  [[0.15]]
grads:  [0.00624154]
Stock Position:  0.006241535528003541
Bond Position:  [-16.76509204]


portfolio before change:  [-16.15019925]
curr_Stock_Price:  99.85963064488442
curr_Factors:  [99.85963064]
mat_Sqrt:  [[0.15]]
grads:  [0.03179571]
Stock Position:  0.0317957099287337
Bond Position:  [-19.3253071]


portfolio before change:  [-16.18949905]
curr_Stock_Price:  98.9275949099591
curr_Factors:  [98.92759491]
mat_Sqrt:  [[0.15]]
grads:  [0.05496194]
Stock Position:  0.05496194400439398
Bond Position:  [-21.62675199]


portfolio before change:  [-16.05615654]
curr_Stock_Price:  101.55047511949567
curr_Factors:  [101.55047512]
mat_Sqrt:  [[0.15]]
grads:  [0.11774515]
Stock Position:  0.11774514635248291
Bond Position:  [-28.01323209]


portfolio before change:  [-16.06034007]
curr_Stock_Price:  101.6339315703602
curr_Factors:  [101.63393157]
mat_Sqrt:  [[0.15]]
grads:  [0.06114516]
Stock Position:  0.06114516270108089
Bond Position:  [-22.27476335]


portfolio before change:  [-16.05267794]
curr_Stock_Price:  101.94143416854796
curr_Factors:  [101.94143417]
mat_Sqrt:  [[0.15]]
grads:  [0.07807223]
Stock Position:  0.07807222978572767
Bond Position:  [-24.01147301]


portfolio before change:  [-15.85247461]
curr_Stock_Price:  104.6595845999224
curr_Factors:  [104.6595846]
mat_Sqrt:  [[0.15]]
grads:  [0.04327356]
Stock Position:  0.043273563301038126
Bond Position:  [-20.38146777]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.85247461]
Stock Price:  105.24151724739491
PL:  [-21.09399186]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.06599862]
 [ 0.00351018]
 [-0.01076775]
 [ 0.0025131 ]
 [ 0.00743299]
 [ 0.01838268]
 [-0.01575269]
 [ 0.00282349]
 [ 0.00759573]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.54208641]
curr_Stock_Price:  102.41076143369357
curr_Factors:  [102.41076143]
mat_Sqrt:  [[0.15]]
grads:  [0.43999079]
Stock Position:  0.4399907881131007
Bond Position:  [-6.51770522]


portfolio before change:  [38.07926659]
curr_Stock_Price:  101.36628466784025
curr_Factors:  [101.36628467]
mat_Sqrt:  [[0.15]]
grads:  [0.02340119]
Stock Position:  0.023401189869695974
Bond Position:  [35.70717491]


portfolio before change:  [38.04050005]
curr_Stock_Price:  98.94655332819794
curr_Factors:  [98.94655333]
mat_Sqrt:  [[0.15]]
grads:  [-0.07178503]
Stock Position:  -0.07178502854292639
Bond Position:  [45.1433812]


portfolio before change:  [38.05617694]
curr_Stock_Price:  99.04267982535893
curr_Factors:  [99.04267983]
mat_Sqrt:  [[0.15]]
grads:  [0.01675399]
Stock Position:  0.016753991521588334
Bond Position:  [36.39681672]


portfolio before change:  [38.06747913]
curr_Stock_Price:  98.63079209613055
curr_Factors:  [98.6307921]
mat_Sqrt:  [[0.15]]
grads:  [0.04955328]
Stock Position:  0.04955328493051226
Bond Position:  [33.17999939]


portfolio before change:  [38.14184982]
curr_Stock_Price:  99.79673973201346
curr_Factors:  [99.79673973]
mat_Sqrt:  [[0.15]]
grads:  [0.12255118]
Stock Position:  0.12255118352618828
Bond Position:  [25.91164125]


portfolio before change:  [37.99931479]
curr_Stock_Price:  98.52793039111492
curr_Factors:  [98.52793039]
mat_Sqrt:  [[0.15]]
grads:  [-0.10501792]
Stock Position:  -0.10501792484124572
Bond Position:  [48.34651358]


portfolio before change:  [38.05274423]
curr_Stock_Price:  98.24940514351555
curr_Factors:  [98.24940514]
mat_Sqrt:  [[0.15]]
grads:  [0.01882325]
Stock Position:  0.018823251559542054
Bond Position:  [36.20337097]


portfolio before change:  [38.1358311]
curr_Stock_Price:  101.70155345955098
curr_Factors:  [101.70155346]
mat_Sqrt:  [[0.15]]
grads:  [0.0506382]
Stock Position:  0.05063819930068361
Bond Position:  [32.98584757]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.1358311]
Stock Price:  105.67051632257036
PL:  [32.46531478]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01204925]
 [ 0.00312564]
 [-0.00991344]
 [ 0.00244115]
 [ 0.00801962]
 [ 0.01760557]
 [ 0.00702242]
 [ 0.01249882]
 [ 0.00839856]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.82541446]
curr_Stock_Price:  100.9371977163268
curr_Factors:  [100.93719772]
mat_Sqrt:  [[0.15]]
grads:  [0.08032832]
Stock Position:  0.08032832392627974
Bond Position:  [7.71729855]


portfolio before change:  [15.87609683]
curr_Stock_Price:  101.52008987418743
curr_Factors:  [101.52008987]
mat_Sqrt:  [[0.15]]
grads:  [0.02083757]
Stock Position:  0.020837574959995133
Bond Position:  [13.76066434]


portfolio before change:  [15.83576648]
curr_Stock_Price:  99.25435619206759
curr_Factors:  [99.25435619]
mat_Sqrt:  [[0.15]]
grads:  [-0.06608957]
Stock Position:  -0.06608957110034243
Bond Position:  [22.39544431]


portfolio before change:  [15.86379071]
curr_Stock_Price:  98.99979703037646
curr_Factors:  [98.99979703]
mat_Sqrt:  [[0.15]]
grads:  [0.01627433]
Stock Position:  0.016274326890996563
Bond Position:  [14.25263565]


portfolio before change:  [15.86840611]
curr_Stock_Price:  98.84540039443347
curr_Factors:  [98.84540039]
mat_Sqrt:  [[0.15]]
grads:  [0.05346411]
Stock Position:  0.05346410742229898
Bond Position:  [10.58372501]


portfolio before change:  [16.02202678]
curr_Stock_Price:  101.61973803197128
curr_Factors:  [101.61973803]
mat_Sqrt:  [[0.15]]
grads:  [0.11737049]
Stock Position:  0.1173704898020838
Bond Position:  [4.09486835]


portfolio before change:  [15.98871512]
curr_Stock_Price:  101.31847316289328
curr_Factors:  [101.31847316]
mat_Sqrt:  [[0.15]]
grads:  [0.04681613]
Stock Position:  0.0468161325622863
Bond Position:  [11.24537605]


portfolio before change:  [15.99600803]
curr_Stock_Price:  101.35411935085986
curr_Factors:  [101.35411935]
mat_Sqrt:  [[0.15]]
grads:  [0.08332544]
Stock Position:  0.08332543868024223
Bond Position:  [7.55063158]


portfolio before change:  [15.92066713]
curr_Stock_Price:  100.40462342109238
curr_Factors:  [100.40462342]
mat_Sqrt:  [[0.15]]
grads:  [0.05599038]
Stock Position:  0.05599037731469873
Bond Position:  [10.29897438]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.92066713]
Stock Price:  100.23942114887379
PL:  [15.68124598]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [7.25269389e-02]
 [1.52209616e-03]
 [1.65860272e-02]
 [2.11844016e-03]
 [1.55407040e-02]
 [1.66205095e-02]
 [7.77169048e-03]
 [5.63653850e-03]
 [7.11219516e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [41.34766267]
curr_Stock_Price:  102.59275091646336
curr_Factors:  [102.59275092]
mat_Sqrt:  [[0.15]]
grads:  [0.48351293]
Stock Position:  0.4835129260794614
Bond Position:  [-8.25725852]


portfolio before change:  [40.60953056]
curr_Stock_Price:  101.07468924082514
curr_Factors:  [101.07468924]
mat_Sqrt:  [[0.15]]
grads:  [0.01014731]
Stock Position:  0.010147307715372053
Bond Position:  [39.58389459]


portfolio before change:  [40.63311907]
curr_Stock_Price:  101.44834570843032
curr_Factors:  [101.44834571]
mat_Sqrt:  [[0.15]]
grads:  [0.11057351]
Stock Position:  0.11057351468575274
Bond Position:  [29.41561892]


portfolio before change:  [40.68287579]
curr_Stock_Price:  101.76528631567882
curr_Factors:  [101.76528632]
mat_Sqrt:  [[0.15]]
grads:  [0.01412293]
Stock Position:  0.014122934386737077
Bond Position:  [39.24565133]


portfolio before change:  [40.69475846]
curr_Stock_Price:  101.2168830893814
curr_Factors:  [101.21688309]
mat_Sqrt:  [[0.15]]
grads:  [0.10360469]
Stock Position:  0.10360469338597135
Bond Position:  [30.20821432]


portfolio before change:  [40.95619823]
curr_Stock_Price:  103.59449628696721
curr_Factors:  [103.59449629]
mat_Sqrt:  [[0.15]]
grads:  [0.1108034]
Stock Position:  0.11080339638442842
Bond Position:  [29.47757619]


portfolio before change:  [40.72925777]
curr_Stock_Price:  101.41330927722835
curr_Factors:  [101.41330928]
mat_Sqrt:  [[0.15]]
grads:  [0.05181127]
Stock Position:  0.05181126984425785
Bond Position:  [35.47490544]


portfolio before change:  [40.88868545]
curr_Stock_Price:  104.14796119152868
curr_Factors:  [104.14796119]
mat_Sqrt:  [[0.15]]
grads:  [0.03757692]
Stock Position:  0.03757692335909252
Bond Position:  [36.97512549]


portfolio before change:  [40.86827018]
curr_Stock_Price:  103.11255287839141
curr_Factors:  [103.11255288]
mat_Sqrt:  [[0.15]]
grads:  [0.04741463]
Stock Position:  0.04741463439760863
Bond Position:  [35.97922618]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [40.86827018]
Stock Price:  104.00749306961745
PL:  [36.86077711]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [6.63916478e-02]
 [1.15702048e-03]
 [7.58088224e-02]
 [7.22987181e-03]
 [2.30162720e-03]
 [1.55229324e-02]
 [2.99554382e-02]
 [3.37155188e-03]
 [7.41668221e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.71099271]
curr_Stock_Price:  102.42171788903471
curr_Factors:  [102.42171789]
mat_Sqrt:  [[0.15]]
grads:  [0.44261099]
Stock Position:  0.44261098546583955
Bond Position:  [-6.62198477]


portfolio before change:  [39.12526782]
curr_Stock_Price:  103.36518051435257
curr_Factors:  [103.36518051]
mat_Sqrt:  [[0.15]]
grads:  [0.00771347]
Stock Position:  0.007713469851451787
Bond Position:  [38.32796361]


portfolio before change:  [39.1496343]
curr_Stock_Price:  104.03902879376064
curr_Factors:  [104.03902879]
mat_Sqrt:  [[0.15]]
grads:  [0.50539215]
Stock Position:  0.5053921496367859
Bond Position:  [-13.43087411]


portfolio before change:  [39.41032193]
curr_Stock_Price:  104.56813228570876
curr_Factors:  [104.56813229]
mat_Sqrt:  [[0.15]]
grads:  [0.04819915]
Stock Position:  0.048199145393203816
Bond Position:  [34.37022732]


portfolio before change:  [39.46053909]
curr_Stock_Price:  105.25336730498863
curr_Factors:  [105.2533673]
mat_Sqrt:  [[0.15]]
grads:  [0.01534418]
Stock Position:  0.015344181303402066
Bond Position:  [37.84551234]


portfolio before change:  [39.49830538]
curr_Stock_Price:  106.4811165784467
curr_Factors:  [106.48111658]
mat_Sqrt:  [[0.15]]
grads:  [0.10348622]
Stock Position:  0.10348621587017173
Bond Position:  [28.47897757]


portfolio before change:  [39.39424818]
curr_Stock_Price:  105.33796677983526
curr_Factors:  [105.33796678]
mat_Sqrt:  [[0.15]]
grads:  [0.19970292]
Stock Position:  0.19970292152695018
Bond Position:  [18.35794847]


portfolio before change:  [39.43968757]
curr_Stock_Price:  105.51952705652603
curr_Factors:  [105.51952706]
mat_Sqrt:  [[0.15]]
grads:  [0.02247701]
Stock Position:  0.02247701253903284
Bond Position:  [37.06792384]


portfolio before change:  [39.38117276]
curr_Stock_Price:  102.09142882700966
curr_Factors:  [102.09142883]
mat_Sqrt:  [[0.15]]
grads:  [0.04944455]
Stock Position:  0.049444548083047865
Bond Position:  [34.3333082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.38117276]
Stock Price:  104.72644302148431
PL:  [34.65472974]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.00859078]
 [0.00266079]
 [0.07189279]
 [0.00754872]
 [0.01123412]
 [0.01639469]
 [0.01538173]
 [0.01251196]
 [0.0083996 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.4097044]
curr_Stock_Price:  100.78049770726992
curr_Factors:  [100.78049771]
mat_Sqrt:  [[0.15]]
grads:  [0.05727184]
Stock Position:  0.05727184387801358
Bond Position:  [7.63781947]


portfolio before change:  [13.47398751]
curr_Stock_Price:  101.83622143892768
curr_Factors:  [101.83622144]
mat_Sqrt:  [[0.15]]
grads:  [0.01773863]
Stock Position:  0.017738627953064967
Bond Position:  [11.66755267]


portfolio before change:  [13.51568834]
curr_Stock_Price:  103.85811348239112
curr_Factors:  [103.85811348]
mat_Sqrt:  [[0.15]]
grads:  [0.47928527]
Stock Position:  0.4792852730716895
Bond Position:  [-36.26197595]


portfolio before change:  [13.89325702]
curr_Stock_Price:  104.68372659291786
curr_Factors:  [104.68372659]
mat_Sqrt:  [[0.15]]
grads:  [0.0503248]
Stock Position:  0.05032479860838937
Bond Position:  [8.62506956]


portfolio before change:  [13.82125107]
curr_Stock_Price:  103.1671867208275
curr_Factors:  [103.16718672]
mat_Sqrt:  [[0.15]]
grads:  [0.0748941]
Stock Position:  0.07489410014729218
Bond Position:  [6.09463745]


portfolio before change:  [13.90359624]
curr_Stock_Price:  104.22597621868871
curr_Factors:  [104.22597622]
mat_Sqrt:  [[0.15]]
grads:  [0.10929793]
Stock Position:  0.10929792557952028
Bond Position:  [2.51191324]


portfolio before change:  [13.74469838]
curr_Stock_Price:  102.76067736014853
curr_Factors:  [102.76067736]
mat_Sqrt:  [[0.15]]
grads:  [0.10254484]
Stock Position:  0.10254484218264213
Bond Position:  [3.20712094]


portfolio before change:  [13.6097741]
curr_Stock_Price:  101.42927700525877
curr_Factors:  [101.42927701]
mat_Sqrt:  [[0.15]]
grads:  [0.08341305]
Stock Position:  0.08341304729999065
Bond Position:  [5.14924902]


portfolio before change:  [13.51972032]
curr_Stock_Price:  100.31879067254474
curr_Factors:  [100.31879067]
mat_Sqrt:  [[0.15]]
grads:  [0.0559973]
Stock Position:  0.055997300862259604
Bond Position:  [7.90213882]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.51972032]
Stock Price:  101.03800267805217
PL:  [12.48171764]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 2.68598935e-02]
 [-2.65492603e-02]
 [-1.49700323e-02]
 [ 1.72209517e-03]
 [ 4.74083425e-03]
 [ 1.75182826e-02]
 [-2.51999896e-02]
 [ 2.08970962e-03]
 [ 8.37178712e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.17103214]
curr_Stock_Price:  101.34881927761741
curr_Factors:  [101.34881928]
mat_Sqrt:  [[0.15]]
grads:  [0.17906596]
Stock Position:  0.17906595660464644
Bond Position:  [4.02290887]


portfolio before change:  [21.88915905]
curr_Stock_Price:  99.7634534639296
curr_Factors:  [99.76345346]
mat_Sqrt:  [[0.15]]
grads:  [-0.17699507]
Stock Position:  -0.1769950688373875
Bond Position:  [39.54679837]


portfolio before change:  [21.85715274]
curr_Stock_Price:  100.05603026093499
curr_Factors:  [100.05603026]
mat_Sqrt:  [[0.15]]
grads:  [-0.09980022]
Stock Position:  -0.09980021513190943
Bond Position:  [31.84276609]


portfolio before change:  [22.02126118]
curr_Stock_Price:  98.57123316337788
curr_Factors:  [98.57123316]
mat_Sqrt:  [[0.15]]
grads:  [0.01148063]
Stock Position:  0.011480634478154377
Bond Position:  [20.88960088]


portfolio before change:  [22.02287731]
curr_Stock_Price:  97.80200023658603
curr_Factors:  [97.80200024]
mat_Sqrt:  [[0.15]]
grads:  [0.03160556]
Stock Position:  0.031605561661163996
Bond Position:  [18.93179016]


portfolio before change:  [21.98433773]
curr_Stock_Price:  96.28303216998495
curr_Factors:  [96.28303217]
mat_Sqrt:  [[0.15]]
grads:  [0.11678855]
Stock Position:  0.11678855091713977
Bond Position:  [10.73958193]


portfolio before change:  [22.13076943]
curr_Stock_Price:  97.49086090862275
curr_Factors:  [97.49086091]
mat_Sqrt:  [[0.15]]
grads:  [-0.16799993]
Stock Position:  -0.16799993090699833
Bond Position:  [38.50922733]


portfolio before change:  [22.1250176]
curr_Stock_Price:  97.63973754004616
curr_Factors:  [97.63973754]
mat_Sqrt:  [[0.15]]
grads:  [0.0139314]
Stock Position:  0.013931397491337254
Bond Position:  [20.7647596]


portfolio before change:  [22.17510027]
curr_Stock_Price:  100.48925045565423
curr_Factors:  [100.48925046]
mat_Sqrt:  [[0.15]]
grads:  [0.05581191]
Stock Position:  0.05581191412337571
Bond Position:  [16.56660285]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.17510027]
Stock Price:  101.01357107202357
PL:  [21.1615292]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [3.57869858e-02]
 [1.11502697e-03]
 [6.68941166e-02]
 [5.08502681e-03]
 [1.16489364e-02]
 [1.65707340e-02]
 [1.08406889e-02]
 [5.12713893e-03]
 [6.59543392e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.62843436]
curr_Stock_Price:  101.57309079381392
curr_Factors:  [101.57309079]
mat_Sqrt:  [[0.15]]
grads:  [0.23857991]
Stock Position:  0.2385799056577874
Bond Position:  [1.39513594]


portfolio before change:  [26.0668753]
curr_Stock_Price:  103.40787733503544
curr_Factors:  [103.40787734]
mat_Sqrt:  [[0.15]]
grads:  [0.00743351]
Stock Position:  0.007433513124903562
Bond Position:  [25.29819148]


portfolio before change:  [26.08115776]
curr_Stock_Price:  103.62718154643444
curr_Factors:  [103.62718155]
mat_Sqrt:  [[0.15]]
grads:  [0.44596078]
Stock Position:  0.4459607771994392
Bond Position:  [-20.13250066]


portfolio before change:  [26.14394305]
curr_Stock_Price:  103.79054583126641
curr_Factors:  [103.79054583]
mat_Sqrt:  [[0.15]]
grads:  [0.03390018]
Stock Position:  0.03390017871502439
Bond Position:  [22.625425]


portfolio before change:  [26.12400121]
curr_Stock_Price:  102.86850381399047
curr_Factors:  [102.86850381]
mat_Sqrt:  [[0.15]]
grads:  [0.07765958]
Stock Position:  0.07765957574194846
Bond Position:  [18.13527684]


portfolio before change:  [26.2002609]
curr_Stock_Price:  103.73368733898698
curr_Factors:  [103.73368734]
mat_Sqrt:  [[0.15]]
grads:  [0.11047156]
Stock Position:  0.11047155992440198
Bond Position:  [14.74063864]


portfolio before change:  [26.00912178]
curr_Stock_Price:  101.93674267401198
curr_Factors:  [101.93674267]
mat_Sqrt:  [[0.15]]
grads:  [0.07227126]
Stock Position:  0.07227125941984151
Bond Position:  [18.642025]


portfolio before change:  [26.19892517]
curr_Stock_Price:  104.43400154383986
curr_Factors:  [104.43400154]
mat_Sqrt:  [[0.15]]
grads:  [0.03418093]
Stock Position:  0.03418092623040686
Bond Position:  [22.62927426]


portfolio before change:  [26.20906582]
curr_Stock_Price:  104.39957260835618
curr_Factors:  [104.39957261]
mat_Sqrt:  [[0.15]]
grads:  [0.04396956]
Stock Position:  0.04396955946456285
Bond Position:  [21.6186626]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.20906582]
Stock Price:  102.58289673260086
PL:  [23.62616909]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.85748966e-02]
 [-1.43265354e-02]
 [-9.89906430e-03]
 [ 5.31894316e-04]
 [ 4.65629395e-03]
 [ 1.84950064e-02]
 [ 4.19475078e-03]
 [ 1.21284379e-02]
 [ 8.11507638e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.61294579]
curr_Stock_Price:  98.76814960291291
curr_Factors:  [98.7681496]
mat_Sqrt:  [[0.15]]
grads:  [0.12383264]
Stock Position:  0.12383264424916218
Bond Position:  [-29.84366692]


portfolio before change:  [-17.81768714]
curr_Stock_Price:  97.23530835204983
curr_Factors:  [97.23530835]
mat_Sqrt:  [[0.15]]
grads:  [-0.09551024]
Stock Position:  -0.09551023579069345
Bond Position:  [-8.53071991]


portfolio before change:  [-18.02051097]
curr_Stock_Price:  99.3142207348216
curr_Factors:  [99.31422073]
mat_Sqrt:  [[0.15]]
grads:  [-0.06599376]
Stock Position:  -0.0659937620039424
Bond Position:  [-11.46639193]


portfolio before change:  [-17.93609812]
curr_Stock_Price:  97.94822066230029
curr_Factors:  [97.94822066]
mat_Sqrt:  [[0.15]]
grads:  [0.00354596]
Stock Position:  0.003545962109137181
Bond Position:  [-18.2834188]


portfolio before change:  [-17.94601258]
curr_Stock_Price:  97.73094161135664
curr_Factors:  [97.73094161]
mat_Sqrt:  [[0.15]]
grads:  [0.03104196]
Stock Position:  0.031041959658816114
Bond Position:  [-20.97977253]


portfolio before change:  [-17.94305384]
curr_Stock_Price:  98.16426638830599
curr_Factors:  [98.16426639]
mat_Sqrt:  [[0.15]]
grads:  [0.12330004]
Stock Position:  0.12330004250914399
Bond Position:  [-30.04671206]


portfolio before change:  [-17.62177134]
curr_Stock_Price:  100.89183733454719
curr_Factors:  [100.89183733]
mat_Sqrt:  [[0.15]]
grads:  [0.02796501]
Stock Position:  0.027965005204041646
Bond Position:  [-20.44321209]


portfolio before change:  [-17.63288478]
curr_Stock_Price:  100.8600375346722
curr_Factors:  [100.86003753]
mat_Sqrt:  [[0.15]]
grads:  [0.08085625]
Stock Position:  0.0808562529429569
Bond Position:  [-25.78804949]


portfolio before change:  [-17.64485647]
curr_Stock_Price:  100.8714844945642
curr_Factors:  [100.87148449]
mat_Sqrt:  [[0.15]]
grads:  [0.05410051]
Stock Position:  0.05410050922989897
Bond Position:  [-23.10205515]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.64485647]
Stock Price:  101.03053637866968
PL:  [-18.67539285]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.44533374e-03]
 [-1.43498978e-02]
 [-2.35613570e-02]
 [ 2.20098543e-03]
 [-9.07649640e-03]
 [ 1.75500494e-02]
 [-3.27343002e-02]
 [-8.98523893e-03]
 [ 8.55529083e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.7606431]
curr_Stock_Price:  99.79644186898749
curr_Factors:  [99.79644187]
mat_Sqrt:  [[0.15]]
grads:  [-0.02963556]
Stock Position:  -0.029635558252937184
Bond Position:  [1.19688017]


portfolio before change:  [-1.68402548]
curr_Stock_Price:  97.23131271510087
curr_Factors:  [97.23131272]
mat_Sqrt:  [[0.15]]
grads:  [-0.09566599]
Stock Position:  -0.09566598562509397
Bond Position:  [7.61770389]


portfolio before change:  [-1.68560158]
curr_Stock_Price:  97.2876118279416
curr_Factors:  [97.28761183]
mat_Sqrt:  [[0.15]]
grads:  [-0.15707571]
Stock Position:  -0.15707571335910314
Bond Position:  [13.59591945]


portfolio before change:  [-1.9252608]
curr_Stock_Price:  98.85665692858578
curr_Factors:  [98.85665693]
mat_Sqrt:  [[0.15]]
grads:  [0.01467324]
Stock Position:  0.014673236195383332
Bond Position:  [-3.37580788]


portfolio before change:  [-1.98011202]
curr_Stock_Price:  95.23353742420039
curr_Factors:  [95.23353742]
mat_Sqrt:  [[0.15]]
grads:  [-0.06050998]
Stock Position:  -0.06050997602368838
Bond Position:  [3.78246705]


portfolio before change:  [-2.04536904]
curr_Stock_Price:  96.34325080103224
curr_Factors:  [96.3432508]
mat_Sqrt:  [[0.15]]
grads:  [0.11700033]
Stock Position:  0.1170003295628108
Bond Position:  [-13.31756113]


portfolio before change:  [-2.08492005]
curr_Stock_Price:  96.06213563980057
curr_Factors:  [96.06213564]
mat_Sqrt:  [[0.15]]
grads:  [-0.21822867]
Stock Position:  -0.21822866801841803
Bond Position:  [18.87859186]


portfolio before change:  [-1.53204937]
curr_Stock_Price:  93.57195398478515
curr_Factors:  [93.57195398]
mat_Sqrt:  [[0.15]]
grads:  [-0.05990159]
Stock Position:  -0.059901592851441234
Bond Position:  [4.07305972]


portfolio before change:  [-1.59350074]
curr_Stock_Price:  94.63183243175376
curr_Factors:  [94.63183243]
mat_Sqrt:  [[0.15]]
grads:  [0.05703527]
Stock Position:  0.057035272170389104
Bond Position:  [-6.99085306]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.59350074]
Stock Price:  96.92071111982676
PL:  [-1.59350074]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.0037397 ]
 [-0.01770571]
 [-0.01024492]
 [ 0.00390285]
 [ 0.00975243]
 [ 0.01855154]
 [ 0.00810198]
 [ 0.01251609]
 [ 0.00784978]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.61820303]
curr_Stock_Price:  100.33995298211877
curr_Factors:  [100.33995298]
mat_Sqrt:  [[0.15]]
grads:  [-0.02493134]
Stock Position:  -0.024931339693374466
Bond Position:  [9.11981249]


portfolio before change:  [6.67554389]
curr_Stock_Price:  98.22294654233747
curr_Factors:  [98.22294654]
mat_Sqrt:  [[0.15]]
grads:  [-0.1180381]
Stock Position:  -0.11803809980965896
Bond Position:  [18.26959385]


portfolio before change:  [6.58531284]
curr_Stock_Price:  99.06477749726741
curr_Factors:  [99.0647775]
mat_Sqrt:  [[0.15]]
grads:  [-0.06829947]
Stock Position:  -0.06829947378210253
Bond Position:  [13.35138502]


portfolio before change:  [6.55742308]
curr_Stock_Price:  99.57088858148306
curr_Factors:  [99.57088858]
mat_Sqrt:  [[0.15]]
grads:  [0.02601902]
Stock Position:  0.02601901772062463
Bond Position:  [3.96668637]


portfolio before change:  [6.55763536]
curr_Stock_Price:  99.50280156976947
curr_Factors:  [99.50280157]
mat_Sqrt:  [[0.15]]
grads:  [0.06501623]
Stock Position:  0.06501622883865871
Bond Position:  [0.08833845]


portfolio before change:  [6.53789956]
curr_Stock_Price:  99.19857005438479
curr_Factors:  [99.19857005]
mat_Sqrt:  [[0.15]]
grads:  [0.1236769]
Stock Position:  0.12367690434629236
Bond Position:  [-5.7306725]


portfolio before change:  [6.81411512]
curr_Stock_Price:  101.4551078796472
curr_Factors:  [101.45510788]
mat_Sqrt:  [[0.15]]
grads:  [0.0540132]
Stock Position:  0.05401320415524438
Bond Position:  [1.33419966]


portfolio before change:  [6.8146649]
curr_Stock_Price:  101.45293278815207
curr_Factors:  [101.45293279]
mat_Sqrt:  [[0.15]]
grads:  [0.08344062]
Stock Position:  0.08344062200951191
Bond Position:  [-1.65063091]


portfolio before change:  [6.79970767]
curr_Stock_Price:  101.28357036288755
curr_Factors:  [101.28357036]
mat_Sqrt:  [[0.15]]
grads:  [0.0523319]
Stock Position:  0.05233189671724938
Bond Position:  [1.49934633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.79970767]
Stock Price:  102.64277552408548
PL:  [4.15693215]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 7.38560654e-03]
 [-1.88958864e-02]
 [-1.55784169e-02]
 [ 4.23683448e-03]
 [ 1.57893700e-02]
 [ 1.80889747e-02]
 [-2.04094334e-03]
 [ 2.69670881e-03]
 [ 8.08765823e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.61951465]
curr_Stock_Price:  100.72924042127023
curr_Factors:  [100.72924042]
mat_Sqrt:  [[0.15]]
grads:  [0.04923738]
Stock Position:  0.049237376957435464
Bond Position:  [7.65987106]


portfolio before change:  [12.53419104]
curr_Stock_Price:  98.91853271975263
curr_Factors:  [98.91853272]
mat_Sqrt:  [[0.15]]
grads:  [-0.12597258]
Stock Position:  -0.1259725762876723
Bond Position:  [24.99521345]


portfolio before change:  [12.39508065]
curr_Stock_Price:  100.12205750953493
curr_Factors:  [100.12205751]
mat_Sqrt:  [[0.15]]
grads:  [-0.10385611]
Stock Position:  -0.10385611235260528
Bond Position:  [22.79336831]


portfolio before change:  [12.45729894]
curr_Stock_Price:  99.63273865231115
curr_Factors:  [99.63273865]
mat_Sqrt:  [[0.15]]
grads:  [0.02824556]
Stock Position:  0.028245563179814324
Bond Position:  [9.64311613]


portfolio before change:  [12.4882286]
curr_Stock_Price:  100.55702160247385
curr_Factors:  [100.5570216]
mat_Sqrt:  [[0.15]]
grads:  [0.10526247]
Stock Position:  0.10526246649037507
Bond Position:  [1.90334848]


portfolio before change:  [12.50557518]
curr_Stock_Price:  100.7127719691548
curr_Factors:  [100.71277197]
mat_Sqrt:  [[0.15]]
grads:  [0.12059316]
Stock Position:  0.1205931645261303
Bond Position:  [0.3603033]


portfolio before change:  [12.42582937]
curr_Stock_Price:  100.04999800563488
curr_Factors:  [100.04999801]
mat_Sqrt:  [[0.15]]
grads:  [-0.01360629]
Stock Position:  -0.01360628893670078
Bond Position:  [13.78713855]


portfolio before change:  [12.45928968]
curr_Stock_Price:  98.09759079226181
curr_Factors:  [98.09759079]
mat_Sqrt:  [[0.15]]
grads:  [0.01797806]
Stock Position:  0.01797805876078952
Bond Position:  [10.69568542]


portfolio before change:  [12.51523949]
curr_Stock_Price:  100.91216794598287
curr_Factors:  [100.91216795]
mat_Sqrt:  [[0.15]]
grads:  [0.05391772]
Stock Position:  0.05391772150194012
Bond Position:  [7.07428532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.51523949]
Stock Price:  103.03435275733077
PL:  [9.48088673]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.60386479e-02]
 [-2.19069032e-02]
 [-1.27415624e-02]
 [ 7.58022008e-04]
 [ 1.57168268e-02]
 [ 1.83723171e-02]
 [-2.48243456e-02]
 [ 3.14141981e-05]
 [ 8.46792936e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.78220777]
curr_Stock_Price:  98.23823359752842
curr_Factors:  [98.2382336]
mat_Sqrt:  [[0.15]]
grads:  [0.10692432]
Stock Position:  0.10692431925037027
Bond Position:  [-36.28626402]


portfolio before change:  [-25.6843175]
curr_Stock_Price:  99.3234678330873
curr_Factors:  [99.32346783]
mat_Sqrt:  [[0.15]]
grads:  [-0.14604602]
Stock Position:  -0.14604602133616917
Bond Position:  [-11.1785202]


portfolio before change:  [-25.57224379]
curr_Stock_Price:  98.51780144559935
curr_Factors:  [98.51780145]
mat_Sqrt:  [[0.15]]
grads:  [-0.08494375]
Stock Position:  -0.08494374914541498
Bond Position:  [-17.20377238]


portfolio before change:  [-25.54110087]
curr_Stock_Price:  98.04988053828393
curr_Factors:  [98.04988054]
mat_Sqrt:  [[0.15]]
grads:  [0.00505348]
Stock Position:  0.005053480055287385
Bond Position:  [-26.03659399]


portfolio before change:  [-25.54153178]
curr_Stock_Price:  100.5413601585649
curr_Factors:  [100.54136016]
mat_Sqrt:  [[0.15]]
grads:  [0.10477885]
Stock Position:  0.10477884539670818
Bond Position:  [-36.07613941]


portfolio before change:  [-25.63402432]
curr_Stock_Price:  99.83081635637998
curr_Factors:  [99.83081636]
mat_Sqrt:  [[0.15]]
grads:  [0.12248211]
Stock Position:  0.12248211381322004
Bond Position:  [-37.86151373]


portfolio before change:  [-25.93191099]
curr_Stock_Price:  97.55333132543721
curr_Factors:  [97.55333133]
mat_Sqrt:  [[0.15]]
grads:  [-0.16549564]
Stock Position:  -0.16549563709972595
Bond Position:  [-9.78726027]


portfolio before change:  [-25.80312218]
curr_Stock_Price:  96.74555372846781
curr_Factors:  [96.74555373]
mat_Sqrt:  [[0.15]]
grads:  [0.00020943]
Stock Position:  0.00020942798713886185
Bond Position:  [-25.8233834]


portfolio before change:  [-25.81592286]
curr_Stock_Price:  97.29101708827739
curr_Factors:  [97.29101709]
mat_Sqrt:  [[0.15]]
grads:  [0.05645286]
Stock Position:  0.05645286238837213
Bond Position:  [-31.30827926]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.81592286]
Stock Price:  98.24958017858664
PL:  [-25.81592286]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.75813810e-02]
 [-1.75109703e-02]
 [-2.92419928e-02]
 [-5.73937720e-03]
 [ 1.40051440e-03]
 [ 1.85653681e-02]
 [-9.54386643e-03]
 [ 9.21624578e-03]
 [ 8.11588450e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-24.31606177]
curr_Stock_Price:  98.33333817731906
curr_Factors:  [98.33333818]
mat_Sqrt:  [[0.15]]
grads:  [0.11720921]
Stock Position:  0.11720920639672684
Bond Position:  [-35.8416343]


portfolio before change:  [-24.36026638]
curr_Stock_Price:  98.10912960329358
curr_Factors:  [98.1091296]
mat_Sqrt:  [[0.15]]
grads:  [-0.1167398]
Stock Position:  -0.11673980226585316
Bond Position:  [-12.90702599]


portfolio before change:  [-24.21452668]
curr_Stock_Price:  96.80541972806118
curr_Factors:  [96.80541973]
mat_Sqrt:  [[0.15]]
grads:  [-0.19494662]
Stock Position:  -0.19494661854489884
Bond Position:  [-5.34263744]


portfolio before change:  [-23.89874818]
curr_Stock_Price:  95.17189317178541
curr_Factors:  [95.17189317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03826251]
Stock Position:  -0.03826251463775351
Bond Position:  [-20.25723223]


portfolio before change:  [-23.98050148]
curr_Stock_Price:  97.0437551320821
curr_Factors:  [97.04375513]
mat_Sqrt:  [[0.15]]
grads:  [0.00933676]
Stock Position:  0.00933676268886034
Bond Position:  [-24.88657599]


portfolio before change:  [-23.97465019]
curr_Stock_Price:  99.00350171186639
curr_Factors:  [99.00350171]
mat_Sqrt:  [[0.15]]
grads:  [0.12376912]
Stock Position:  0.12376912072772035
Bond Position:  [-36.22822654]


portfolio before change:  [-23.96223239]
curr_Stock_Price:  99.2502226870473
curr_Factors:  [99.25022269]
mat_Sqrt:  [[0.15]]
grads:  [-0.06362578]
Stock Position:  -0.06362577618348102
Bond Position:  [-17.64735994]


portfolio before change:  [-24.01939906]
curr_Stock_Price:  100.00998988315716
curr_Factors:  [100.00998988]
mat_Sqrt:  [[0.15]]
grads:  [0.06144164]
Stock Position:  0.06144163853693653
Bond Position:  [-30.16417671]


portfolio before change:  [-23.98162695]
curr_Stock_Price:  100.87028540603875
curr_Factors:  [100.87028541]
mat_Sqrt:  [[0.15]]
grads:  [0.0541059]
Stock Position:  0.054105896645655176
Bond Position:  [-29.43930419]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-23.98162695]
Stock Price:  101.24102354135978
PL:  [-25.22265049]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 3.71964539e-02]
 [ 3.19462589e-03]
 [-9.87250779e-03]
 [ 2.25720045e-03]
 [ 1.61191923e-02]
 [ 1.82518073e-02]
 [-5.19148881e-03]
 [ 6.04718955e-03]
 [ 8.54699063e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.17431176]
curr_Stock_Price:  101.60850025604826
curr_Factors:  [101.60850026]
mat_Sqrt:  [[0.15]]
grads:  [0.24797636]
Stock Position:  0.24797635941684437
Bond Position:  [0.97780578]


portfolio before change:  [26.09861278]
curr_Stock_Price:  101.30126128558712
curr_Factors:  [101.30126129]
mat_Sqrt:  [[0.15]]
grads:  [0.02129751]
Stock Position:  0.021297505909259874
Bond Position:  [23.94114857]


portfolio before change:  [26.07062332]
curr_Stock_Price:  99.42484302435967
curr_Factors:  [99.42484302]
mat_Sqrt:  [[0.15]]
grads:  [-0.06581672]
Stock Position:  -0.06581671861373421
Bond Position:  [32.61444024]


portfolio before change:  [25.93981325]
curr_Stock_Price:  101.66016220446478
curr_Factors:  [101.6601622]
mat_Sqrt:  [[0.15]]
grads:  [0.015048]
Stock Position:  0.01504800297768321
Bond Position:  [24.41003082]


portfolio before change:  [25.95588735]
curr_Stock_Price:  101.91707599350183
curr_Factors:  [101.91707599]
mat_Sqrt:  [[0.15]]
grads:  [0.10746128]
Stock Position:  0.10746128168102602
Bond Position:  [15.00374774]


portfolio before change:  [25.78292083]
curr_Stock_Price:  100.23767784940146
curr_Factors:  [100.23767785]
mat_Sqrt:  [[0.15]]
grads:  [0.12167872]
Stock Position:  0.12167871517541377
Bond Position:  [13.58612897]


portfolio before change:  [25.71787311]
curr_Stock_Price:  99.64725022465252
curr_Factors:  [99.64725022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03460993]
Stock Position:  -0.03460992537785137
Bond Position:  [29.16665701]


portfolio before change:  [25.74348864]
curr_Stock_Price:  99.32859731660335
curr_Factors:  [99.32859732]
mat_Sqrt:  [[0.15]]
grads:  [0.0403146]
Stock Position:  0.04031459701913835
Bond Position:  [21.73909627]


portfolio before change:  [25.58633202]
curr_Stock_Price:  95.160655600649
curr_Factors:  [95.1606556]
mat_Sqrt:  [[0.15]]
grads:  [0.05697994]
Stock Position:  0.05697993751695865
Bond Position:  [20.16408381]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [25.58633202]
Stock Price:  96.31901508692556
PL:  [25.58633202]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.84137124e-02]
 [-1.44088906e-02]
 [-2.48289761e-02]
 [ 1.37969882e-03]
 [ 6.52012006e-03]
 [ 1.85637517e-02]
 [-1.46224651e-02]
 [ 4.35491685e-03]
 [ 8.48094660e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.00697456]
curr_Stock_Price:  98.80745717461915
curr_Factors:  [98.80745717]
mat_Sqrt:  [[0.15]]
grads:  [0.12275808]
Stock Position:  0.12275808289280729
Bond Position:  [-29.13638858]


portfolio before change:  [-17.21626943]
curr_Stock_Price:  97.22122329523884
curr_Factors:  [97.2212233]
mat_Sqrt:  [[0.15]]
grads:  [-0.09605927]
Stock Position:  -0.09605927097428504
Bond Position:  [-7.87726959]


portfolio before change:  [-17.21625031]
curr_Stock_Price:  97.18001191863192
curr_Factors:  [97.18001192]
mat_Sqrt:  [[0.15]]
grads:  [-0.16552651]
Stock Position:  -0.1655265070665865
Bond Position:  [-1.13038238]


portfolio before change:  [-17.41332033]
curr_Stock_Price:  98.36716123809494
curr_Factors:  [98.36716124]
mat_Sqrt:  [[0.15]]
grads:  [0.00919799]
Stock Position:  0.009197992110859211
Bond Position:  [-18.3181007]


portfolio before change:  [-17.42292093]
curr_Stock_Price:  98.31940439519136
curr_Factors:  [98.3194044]
mat_Sqrt:  [[0.15]]
grads:  [0.04346747]
Stock Position:  0.04346746709255985
Bond Position:  [-21.69661641]


portfolio before change:  [-17.4024517]
curr_Stock_Price:  99.03994899782786
curr_Factors:  [99.039949]
mat_Sqrt:  [[0.15]]
grads:  [0.12375834]
Stock Position:  0.12375834446425954
Bond Position:  [-29.65947183]


portfolio before change:  [-17.46202002]
curr_Stock_Price:  98.67847946759157
curr_Factors:  [98.67847947]
mat_Sqrt:  [[0.15]]
grads:  [-0.0974831]
Stock Position:  -0.09748310075986316
Bond Position:  [-7.84253586]


portfolio before change:  [-17.4924038]
curr_Stock_Price:  98.94992681234747
curr_Factors:  [98.94992681]
mat_Sqrt:  [[0.15]]
grads:  [0.02903278]
Stock Position:  0.029032779030816806
Bond Position:  [-20.36519516]


portfolio before change:  [-17.51335663]
curr_Stock_Price:  98.5790463005722
curr_Factors:  [98.5790463]
mat_Sqrt:  [[0.15]]
grads:  [0.05653964]
Stock Position:  0.05653964397133639
Bond Position:  [-23.08698081]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.51335663]
Stock Price:  98.08143441266746
PL:  [-17.51335663]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.67294864e-03]
 [ 1.80197838e-03]
 [ 9.38855228e-02]
 [ 9.88712091e-03]
 [-7.83518898e-03]
 [ 1.60816293e-02]
 [ 2.88902746e-02]
 [-8.49112159e-03]
 [ 5.33114648e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.20421792]
curr_Stock_Price:  99.89740259417665
curr_Factors:  [99.89740259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02448632]
Stock Position:  -0.024486324291845506
Bond Position:  [2.24190228]


portfolio before change:  [-0.27195268]
curr_Stock_Price:  102.70942078655315
curr_Factors:  [102.70942079]
mat_Sqrt:  [[0.15]]
grads:  [0.01201319]
Stock Position:  0.012013189218389592
Bond Position:  [-1.50582038]


portfolio before change:  [-0.2467005]
curr_Stock_Price:  104.87414768728203
curr_Factors:  [104.87414769]
mat_Sqrt:  [[0.15]]
grads:  [0.62590349]
Stock Position:  0.6259034856055422
Bond Position:  [-65.88779509]


portfolio before change:  [0.13177668]
curr_Stock_Price:  105.53148437234319
curr_Factors:  [105.53148437]
mat_Sqrt:  [[0.15]]
grads:  [0.06591414]
Stock Position:  0.06591413940762332
Bond Position:  [-6.82424029]


portfolio before change:  [0.23573701]
curr_Stock_Price:  107.16047173978961
curr_Factors:  [107.16047174]
mat_Sqrt:  [[0.15]]
grads:  [-0.05223459]
Stock Position:  -0.05223459318083254
Bond Position:  [5.83322066]


portfolio before change:  [0.34620865]
curr_Stock_Price:  105.10140916265249
curr_Factors:  [105.10140916]
mat_Sqrt:  [[0.15]]
grads:  [0.10721086]
Stock Position:  0.10721086204418458
Bond Position:  [-10.92180403]


portfolio before change:  [0.34622307]
curr_Stock_Price:  105.15249247105253
curr_Factors:  [105.15249247]
mat_Sqrt:  [[0.15]]
grads:  [0.19260183]
Stock Position:  0.192601830378737
Bond Position:  [-19.90633945]


portfolio before change:  [0.96706594]
curr_Stock_Price:  108.42763545375097
curr_Factors:  [108.42763545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05660748]
Stock Position:  -0.05660747725902786
Bond Position:  [7.10488085]


portfolio before change:  [0.99886774]
curr_Stock_Price:  107.92861173635093
curr_Factors:  [107.92861174]
mat_Sqrt:  [[0.15]]
grads:  [0.03554098]
Stock Position:  0.03554097652090967
Bond Position:  [-2.83702051]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.99886774]
Stock Price:  107.40928901532857
PL:  [-6.41042127]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.73143829e-03]
 [-1.95309645e-02]
 [-1.24068153e-02]
 [ 2.27145095e-03]
 [ 1.00692033e-02]
 [ 1.82691214e-02]
 [ 1.95130559e-02]
 [ 7.56042829e-03]
 [ 7.28311771e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.6297759]
curr_Stock_Price:  100.3407036799053
curr_Factors:  [100.34070368]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487626]
Stock Position:  -0.02487625527456625
Bond Position:  [9.12587686]


portfolio before change:  [6.66662911]
curr_Stock_Price:  99.04271368782419
curr_Factors:  [99.04271369]
mat_Sqrt:  [[0.15]]
grads:  [-0.13020643]
Stock Position:  -0.1302064302255052
Bond Position:  [19.5626273]


portfolio before change:  [6.73529199]
curr_Stock_Price:  98.59051543245077
curr_Factors:  [98.59051543]
mat_Sqrt:  [[0.15]]
grads:  [-0.0827121]
Stock Position:  -0.08271210171550394
Bond Position:  [14.88992073]


portfolio before change:  [6.71725193]
curr_Stock_Price:  98.89865514124543
curr_Factors:  [98.89865514]
mat_Sqrt:  [[0.15]]
grads:  [0.01514301]
Stock Position:  0.015143006348404675
Bond Position:  [5.21962897]


portfolio before change:  [6.7324007]
curr_Stock_Price:  99.7266480749081
curr_Factors:  [99.72664807]
mat_Sqrt:  [[0.15]]
grads:  [0.06712802]
Stock Position:  0.06712802184791421
Bond Position:  [0.03794809]


portfolio before change:  [6.76271418]
curr_Stock_Price:  100.17794246164316
curr_Factors:  [100.17794246]
mat_Sqrt:  [[0.15]]
grads:  [0.12179414]
Stock Position:  0.12179414239018971
Bond Position:  [-5.43837241]


portfolio before change:  [7.16585276]
curr_Stock_Price:  103.51027386299033
curr_Factors:  [103.51027386]
mat_Sqrt:  [[0.15]]
grads:  [0.13008704]
Stock Position:  0.13008703957925233
Bond Position:  [-6.29949234]


portfolio before change:  [7.14543009]
curr_Stock_Price:  103.37750021071729
curr_Factors:  [103.37750021]
mat_Sqrt:  [[0.15]]
grads:  [0.05040286]
Stock Position:  0.05040285529004518
Bond Position:  [1.93490891]


portfolio before change:  [7.11158763]
curr_Stock_Price:  102.68686170969764
curr_Factors:  [102.68686171]
mat_Sqrt:  [[0.15]]
grads:  [0.04855412]
Stock Position:  0.04855411807477497
Bond Position:  [2.12571763]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.11158763]
Stock Price:  103.1917507544041
PL:  [3.91983688]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.86879122e-02]
 [-1.93563096e-02]
 [-1.13559282e-02]
 [ 8.60679954e-04]
 [ 5.08339928e-03]
 [ 1.82230801e-02]
 [-2.53120218e-02]
 [-2.77697810e-03]
 [ 8.52691538e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.03782711]
curr_Stock_Price:  98.74058880051813
curr_Factors:  [98.7405888]
mat_Sqrt:  [[0.15]]
grads:  [0.12458608]
Stock Position:  0.12458608110414808
Bond Position:  [-30.33953012]


portfolio before change:  [-18.01771174]
curr_Stock_Price:  99.02383817299321
curr_Factors:  [99.02383817]
mat_Sqrt:  [[0.15]]
grads:  [-0.12904206]
Stock Position:  -0.12904206391581546
Bond Position:  [-5.23947129]


portfolio before change:  [-17.99387227]
curr_Stock_Price:  98.8187898057026
curr_Factors:  [98.81878981]
mat_Sqrt:  [[0.15]]
grads:  [-0.07570619]
Stock Position:  -0.07570618799187585
Bond Position:  [-10.51267839]


portfolio before change:  [-17.94441271]
curr_Stock_Price:  98.09603231167945
curr_Factors:  [98.09603231]
mat_Sqrt:  [[0.15]]
grads:  [0.00573787]
Stock Position:  0.005737866357819812
Bond Position:  [-18.50727463]


portfolio before change:  [-17.95370364]
curr_Stock_Price:  98.0899362837101
curr_Factors:  [98.08993628]
mat_Sqrt:  [[0.15]]
grads:  [0.03388933]
Stock Position:  0.03388932851119037
Bond Position:  [-21.27790571]


portfolio before change:  [-17.88820089]
curr_Stock_Price:  100.33678977048766
curr_Factors:  [100.33678977]
mat_Sqrt:  [[0.15]]
grads:  [0.1214872]
Stock Position:  0.12148720033921048
Bond Position:  [-30.07783657]


portfolio before change:  [-18.25125095]
curr_Stock_Price:  97.47222971457528
curr_Factors:  [97.47222971]
mat_Sqrt:  [[0.15]]
grads:  [-0.16874681]
Stock Position:  -0.16874681217103335
Bond Position:  [-1.80312291]


portfolio before change:  [-17.96272691]
curr_Stock_Price:  95.75708129284237
curr_Factors:  [95.75708129]
mat_Sqrt:  [[0.15]]
grads:  [-0.01851319]
Stock Position:  -0.01851318733148188
Bond Position:  [-16.18995813]


portfolio before change:  [-17.98346122]
curr_Stock_Price:  96.43969237437034
curr_Factors:  [96.43969237]
mat_Sqrt:  [[0.15]]
grads:  [0.0568461]
Stock Position:  0.05684610250222863
Bond Position:  [-23.46568186]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.98346122]
Stock Price:  96.93674307985067
PL:  [-17.98346122]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-9.82695835e-04]
 [-1.75272329e-02]
 [-4.06733574e-02]
 [-2.45411842e-03]
 [-1.37067863e-03]
 [ 1.66386746e-02]
 [-3.87459006e-02]
 [-1.17886944e-02]
 [ 8.43866767e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-43.00787586]
curr_Stock_Price:  97.12085515522328
curr_Factors:  [97.12085516]
mat_Sqrt:  [[0.15]]
grads:  [-0.00655131]
Stock Position:  -0.006551305564114219
Bond Position:  [-42.37160747]


portfolio before change:  [-43.03560372]
curr_Stock_Price:  98.11863410201549
curr_Factors:  [98.1186341]
mat_Sqrt:  [[0.15]]
grads:  [-0.11684822]
Stock Position:  -0.11684821905732057
Bond Position:  [-31.57061607]


portfolio before change:  [-42.78456442]
curr_Stock_Price:  95.835085783156
curr_Factors:  [95.83508578]
mat_Sqrt:  [[0.15]]
grads:  [-0.27115572]
Stock Position:  -0.271155716195353
Bond Position:  [-16.7983331]


portfolio before change:  [-43.0282409]
curr_Stock_Price:  96.70276142024478
curr_Factors:  [96.70276142]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636079]
Stock Position:  -0.016360789477133215
Bond Position:  [-41.44610738]


portfolio before change:  [-43.0467144]
curr_Stock_Price:  96.5649484585973
curr_Factors:  [96.56494846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00913786]
Stock Position:  -0.009137857502459861
Bond Position:  [-42.16431766]


portfolio before change:  [-43.05006837]
curr_Stock_Price:  94.62428974669912
curr_Factors:  [94.62428975]
mat_Sqrt:  [[0.15]]
grads:  [0.1109245]
Stock Position:  0.11092449729740383
Bond Position:  [-53.54622014]


portfolio before change:  [-43.14527587]
curr_Stock_Price:  94.00740446629807
curr_Factors:  [94.00740447]
mat_Sqrt:  [[0.15]]
grads:  [-0.258306]
Stock Position:  -0.25830600400523057
Bond Position:  [-18.86259887]


portfolio before change:  [-42.78735052]
curr_Stock_Price:  92.58521916303728
curr_Factors:  [92.58521916]
mat_Sqrt:  [[0.15]]
grads:  [-0.0785913]
Stock Position:  -0.07859129609782886
Bond Position:  [-35.51095815]


portfolio before change:  [-42.72815942]
curr_Stock_Price:  91.60609017201749
curr_Factors:  [91.60609017]
mat_Sqrt:  [[0.15]]
grads:  [0.05625778]
Stock Position:  0.0562577844700644
Bond Position:  [-47.8817151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-42.72815942]
Stock Price:  90.56871450900856
PL:  [-42.72815942]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00462758]
 [ 0.00292287]
 [ 0.04873848]
 [ 0.00275433]
 [ 0.00468534]
 [ 0.01797149]
 [-0.03848762]
 [-0.00732114]
 [ 0.00854002]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.23287]
curr_Stock_Price:  99.70094283882909
curr_Factors:  [99.70094284]
mat_Sqrt:  [[0.15]]
grads:  [-0.03085054]
Stock Position:  -0.03085054170258679
Bond Position:  [-0.1570419]


portfolio before change:  [-3.29157218]
curr_Stock_Price:  101.6011896984458
curr_Factors:  [101.6011897]
mat_Sqrt:  [[0.15]]
grads:  [0.01948581]
Stock Position:  0.01948580850435734
Bond Position:  [-5.27135351]


portfolio before change:  [-3.27107446]
curr_Stock_Price:  102.78841575555275
curr_Factors:  [102.78841576]
mat_Sqrt:  [[0.15]]
grads:  [0.32492318]
Stock Position:  0.32492317787292785
Bond Position:  [-36.66941316]


portfolio before change:  [-4.46135768]
curr_Stock_Price:  99.18158187174772
curr_Factors:  [99.18158187]
mat_Sqrt:  [[0.15]]
grads:  [0.01836218]
Stock Position:  0.018362178817586877
Bond Position:  [-6.28254762]


portfolio before change:  [-4.4906884]
curr_Stock_Price:  97.75535338327734
curr_Factors:  [97.75535338]
mat_Sqrt:  [[0.15]]
grads:  [0.03123558]
Stock Position:  0.03123558180519119
Bond Position:  [-7.54413374]


portfolio before change:  [-4.51361527]
curr_Stock_Price:  97.14214709013105
curr_Factors:  [97.14214709]
mat_Sqrt:  [[0.15]]
grads:  [0.11980991]
Stock Position:  0.11980991143464237
Bond Position:  [-16.1522073]


portfolio before change:  [-4.88807809]
curr_Stock_Price:  94.0840970530377
curr_Factors:  [94.08409705]
mat_Sqrt:  [[0.15]]
grads:  [-0.25658413]
Stock Position:  -0.2565841277795207
Bond Position:  [19.25240789]


portfolio before change:  [-4.89732628]
curr_Stock_Price:  94.15766669984747
curr_Factors:  [94.1576667]
mat_Sqrt:  [[0.15]]
grads:  [-0.04880763]
Stock Position:  -0.04880763265982721
Bond Position:  [-0.30171348]


portfolio before change:  [-4.87461651]
curr_Stock_Price:  93.68928371713791
curr_Factors:  [93.68928372]
mat_Sqrt:  [[0.15]]
grads:  [0.05693345]
Stock Position:  0.0569334538805507
Bond Position:  [-10.20867103]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.87461651]
Stock Price:  93.86575609264642
PL:  [-4.87461651]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00540745]
 [-0.01881349]
 [-0.0195427 ]
 [ 0.0042215 ]
 [ 0.00471992]
 [ 0.01825094]
 [-0.03167074]
 [ 0.0049738 ]
 [ 0.00846325]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.18545418]
curr_Stock_Price:  100.18214771701615
curr_Factors:  [100.18214772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03604969]
Stock Position:  -0.03604969385565762
Bond Position:  [7.79698994]


portfolio before change:  [4.23664267]
curr_Stock_Price:  98.87037477470332
curr_Factors:  [98.87037477]
mat_Sqrt:  [[0.15]]
grads:  [-0.12542324]
Stock Position:  -0.12542324380432227
Bond Position:  [16.63728579]


portfolio before change:  [4.39985666]
curr_Stock_Price:  97.6354101657379
curr_Factors:  [97.63541017]
mat_Sqrt:  [[0.15]]
grads:  [-0.13028469]
Stock Position:  -0.1302846887514119
Bond Position:  [17.12025568]


portfolio before change:  [4.14856759]
curr_Stock_Price:  99.62989885391409
curr_Factors:  [99.62989885]
mat_Sqrt:  [[0.15]]
grads:  [0.02814333]
Stock Position:  0.028143333058792044
Bond Position:  [1.34465016]


portfolio before change:  [4.0973021]
curr_Stock_Price:  97.78441816397469
curr_Factors:  [97.78441816]
mat_Sqrt:  [[0.15]]
grads:  [0.03146611]
Stock Position:  0.031466109324489226
Bond Position:  [1.02040691]


portfolio before change:  [4.09390199]
curr_Stock_Price:  97.66014335827774
curr_Factors:  [97.66014336]
mat_Sqrt:  [[0.15]]
grads:  [0.12167291]
Stock Position:  0.121672912750493
Bond Position:  [-7.78869211]


portfolio before change:  [3.93967515]
curr_Stock_Price:  96.42460523191032
curr_Factors:  [96.42460523]
mat_Sqrt:  [[0.15]]
grads:  [-0.21113829]
Stock Position:  -0.21113829412844648
Bond Position:  [24.29860181]


portfolio before change:  [3.39004111]
curr_Stock_Price:  99.08535598154309
curr_Factors:  [99.08535598]
mat_Sqrt:  [[0.15]]
grads:  [0.03315867]
Stock Position:  0.03315866731435345
Bond Position:  [0.10450276]


portfolio before change:  [3.33999496]
curr_Stock_Price:  97.57448672207154
curr_Factors:  [97.57448672]
mat_Sqrt:  [[0.15]]
grads:  [0.05642167]
Stock Position:  0.056421668409163454
Bond Position:  [-2.16532037]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.33999496]
Stock Price:  96.0687560195341
PL:  [3.33999496]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.15284496e-03]
 [ 3.01897248e-03]
 [ 3.43595701e-02]
 [ 3.95262156e-03]
 [ 1.28716029e-02]
 [ 1.85145311e-02]
 [-2.08974512e-02]
 [ 1.89240349e-03]
 [ 8.54100078e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.55025684]
curr_Stock_Price:  100.07607727307952
curr_Factors:  [100.07607727]
mat_Sqrt:  [[0.15]]
grads:  [-0.02768563]
Stock Position:  -0.02768563306515922
Bond Position:  [5.32092639]


portfolio before change:  [2.51965676]
curr_Stock_Price:  101.27746610272423
curr_Factors:  [101.2774661]
mat_Sqrt:  [[0.15]]
grads:  [0.02012648]
Stock Position:  0.020126483220827645
Bond Position:  [0.48129753]


portfolio before change:  [2.53703617]
curr_Stock_Price:  102.12901582108614
curr_Factors:  [102.12901582]
mat_Sqrt:  [[0.15]]
grads:  [0.2290638]
Stock Position:  0.22906380086814926
Bond Position:  [-20.85702438]


portfolio before change:  [2.2149005]
curr_Stock_Price:  100.76823971700354
curr_Factors:  [100.76823972]
mat_Sqrt:  [[0.15]]
grads:  [0.02635081]
Stock Position:  0.026350810429394852
Bond Position:  [-0.44042428]


portfolio before change:  [2.19772105]
curr_Stock_Price:  100.12464734653835
curr_Factors:  [100.12464735]
mat_Sqrt:  [[0.15]]
grads:  [0.08581069]
Stock Position:  0.0858106859633512
Bond Position:  [-6.39404362]


portfolio before change:  [2.03230688]
curr_Stock_Price:  98.23424935032037
curr_Factors:  [98.23424935]
mat_Sqrt:  [[0.15]]
grads:  [0.12343021]
Stock Position:  0.12343020716488062
Bond Position:  [-10.09276686]


portfolio before change:  [1.99766317]
curr_Stock_Price:  97.99446956379582
curr_Factors:  [97.99446956]
mat_Sqrt:  [[0.15]]
grads:  [-0.13931634]
Stock Position:  -0.1393163412685118
Bond Position:  [15.64989413]


portfolio before change:  [2.07200837]
curr_Stock_Price:  97.51700729382536
curr_Factors:  [97.51700729]
mat_Sqrt:  [[0.15]]
grads:  [0.01261602]
Stock Position:  0.0126160232964088
Bond Position:  [0.84173153]


portfolio before change:  [2.04751615]
curr_Stock_Price:  95.54228154902071
curr_Factors:  [95.54228155]
mat_Sqrt:  [[0.15]]
grads:  [0.05694001]
Stock Position:  0.05694000519017097
Bond Position:  [-3.39266185]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.04751615]
Stock Price:  95.05302350974544
PL:  [2.04751615]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.07054040e-03]
 [-2.72302511e-02]
 [ 4.99484959e-02]
 [ 2.26663984e-03]
 [ 1.65121282e-02]
 [ 1.85652511e-02]
 [-1.21143760e-02]
 [ 8.83210756e-04]
 [ 8.52586461e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.41859438]
curr_Stock_Price:  99.36456014502798
curr_Factors:  [99.36456015]
mat_Sqrt:  [[0.15]]
grads:  [0.00713694]
Stock Position:  0.007136936017165333
Bond Position:  [-9.12775289]


portfolio before change:  [-8.41998622]
curr_Stock_Price:  99.80917412443294
curr_Factors:  [99.80917412]
mat_Sqrt:  [[0.15]]
grads:  [-0.18153501]
Stock Position:  -0.18153500732844202
Bond Position:  [9.69887294]


portfolio before change:  [-8.96612025]
curr_Stock_Price:  102.84431699108289
curr_Factors:  [102.84431699]
mat_Sqrt:  [[0.15]]
grads:  [0.33298997]
Stock Position:  0.3329899724674498
Bond Position:  [-43.21224654]


portfolio before change:  [-9.13356155]
curr_Stock_Price:  102.40637655188694
curr_Factors:  [102.40637655]
mat_Sqrt:  [[0.15]]
grads:  [0.01511093]
Stock Position:  0.015110932244544089
Bond Position:  [-10.68101737]


portfolio before change:  [-9.14718161]
curr_Stock_Price:  101.85854688946495
curr_Factors:  [101.85854689]
mat_Sqrt:  [[0.15]]
grads:  [0.11008085]
Stock Position:  0.11008085498045847
Bond Position:  [-20.35985754]


portfolio before change:  [-9.47135954]
curr_Stock_Price:  99.00613945504048
curr_Factors:  [99.00613946]
mat_Sqrt:  [[0.15]]
grads:  [0.12376834]
Stock Position:  0.12376834083383699
Bond Position:  [-21.72518515]


portfolio before change:  [-9.48450222]
curr_Stock_Price:  98.98773919402664
curr_Factors:  [98.98773919]
mat_Sqrt:  [[0.15]]
grads:  [-0.08076251]
Stock Position:  -0.08076250698396381
Bond Position:  [-1.49000424]


portfolio before change:  [-9.3283761]
curr_Stock_Price:  97.04536135106459
curr_Factors:  [97.04536135]
mat_Sqrt:  [[0.15]]
grads:  [0.00588807]
Stock Position:  0.005888071705633579
Bond Position:  [-9.89978615]


portfolio before change:  [-9.33649927]
curr_Stock_Price:  96.5066386816501
curr_Factors:  [96.50663868]
mat_Sqrt:  [[0.15]]
grads:  [0.0568391]
Stock Position:  0.05683909741824279
Bond Position:  [-14.82184951]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.33649927]
Stock Price:  94.1222684314483
PL:  [-9.33649927]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 8.08620574e-03]
 [-1.57884327e-05]
 [ 9.90958396e-02]
 [ 1.13040546e-02]
 [-3.06039022e-03]
 [ 1.65443208e-02]
 [ 1.47882641e-02]
 [ 9.89248475e-03]
 [ 7.83819782e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.06026794]
curr_Stock_Price:  100.75783079181345
curr_Factors:  [100.75783079]
mat_Sqrt:  [[0.15]]
grads:  [0.05390804]
Stock Position:  0.05390803824251812
Bond Position:  [7.62861095]


portfolio before change:  [13.26892302]
curr_Stock_Price:  104.5576317516616
curr_Factors:  [104.55763175]
mat_Sqrt:  [[0.15]]
grads:  [-0.00010526]
Stock Position:  -0.00010525621821966258
Bond Position:  [13.27992836]


portfolio before change:  [13.27550599]
curr_Stock_Price:  105.11485721115392
curr_Factors:  [105.11485721]
mat_Sqrt:  [[0.15]]
grads:  [0.66063893]
Stock Position:  0.6606389304951749
Bond Position:  [-56.16746086]


portfolio before change:  [13.86201991]
curr_Stock_Price:  106.0451757888231
curr_Factors:  [106.04517579]
mat_Sqrt:  [[0.15]]
grads:  [0.07536036]
Stock Position:  0.0753603642037846
Bond Position:  [5.87041684]


portfolio before change:  [13.88130772]
curr_Stock_Price:  106.26215813514847
curr_Factors:  [106.26215814]
mat_Sqrt:  [[0.15]]
grads:  [-0.0204026]
Stock Position:  -0.02040260149942313
Bond Position:  [16.04933219]


portfolio before change:  [13.93941481]
curr_Stock_Price:  103.80754874318743
curr_Factors:  [103.80754874]
mat_Sqrt:  [[0.15]]
grads:  [0.11029547]
Stock Position:  0.11029547168778907
Bond Position:  [2.48991226]


portfolio before change:  [13.81331841]
curr_Stock_Price:  102.65299842358192
curr_Factors:  [102.65299842]
mat_Sqrt:  [[0.15]]
grads:  [0.09858843]
Stock Position:  0.09858842761142755
Bond Position:  [3.6929207]


portfolio before change:  [13.80680301]
curr_Stock_Price:  102.5681779609561
curr_Factors:  [102.56817796]
mat_Sqrt:  [[0.15]]
grads:  [0.0659499]
Stock Position:  0.06594989832965173
Bond Position:  [7.0424421]


portfolio before change:  [13.72686258]
curr_Stock_Price:  101.30263335709002
curr_Factors:  [101.30263336]
mat_Sqrt:  [[0.15]]
grads:  [0.05225465]
Stock Position:  0.052254652100683655
Bond Position:  [8.43332871]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.72686258]
Stock Price:  99.94037934081315
PL:  [13.72686258]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.77855026e-03]
 [ 2.32648650e-03]
 [-1.22233115e-02]
 [-2.84766888e-03]
 [ 7.61536590e-03]
 [ 1.84935814e-02]
 [-2.90204257e-02]
 [ 1.86532551e-03]
 [ 8.48697759e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.92567503]
curr_Stock_Price:  99.72086967304948
curr_Factors:  [99.72086967]
mat_Sqrt:  [[0.15]]
grads:  [-0.031857]
Stock Position:  -0.031857001704888165
Bond Position:  [0.25113288]


portfolio before change:  [-2.97214946]
curr_Stock_Price:  101.18365732770724
curr_Factors:  [101.18365733]
mat_Sqrt:  [[0.15]]
grads:  [0.01550991]
Stock Position:  0.015509910002961907
Bond Position:  [-4.54149888]


portfolio before change:  [-2.99663784]
curr_Stock_Price:  99.7512145422556
curr_Factors:  [99.75121454]
mat_Sqrt:  [[0.15]]
grads:  [-0.08148874]
Stock Position:  -0.0814887430251302
Bond Position:  [5.13196325]


portfolio before change:  [-2.72866393]
curr_Stock_Price:  96.49423351467352
curr_Factors:  [96.49423351]
mat_Sqrt:  [[0.15]]
grads:  [-0.01898446]
Stock Position:  -0.018984459216408497
Bond Position:  [-0.89677308]


portfolio before change:  [-2.77094045]
curr_Stock_Price:  98.69751087130685
curr_Factors:  [98.69751087]
mat_Sqrt:  [[0.15]]
grads:  [0.05076911]
Stock Position:  0.05076910598052435
Bond Position:  [-7.78172484]


portfolio before change:  [-2.80216395]
curr_Stock_Price:  98.15915862893843
curr_Factors:  [98.15915863]
mat_Sqrt:  [[0.15]]
grads:  [0.12329054]
Stock Position:  0.12329054234338185
Bond Position:  [-14.90425985]


portfolio before change:  [-2.97034498]
curr_Stock_Price:  96.85551417393155
curr_Factors:  [96.85551417]
mat_Sqrt:  [[0.15]]
grads:  [-0.1934695]
Stock Position:  -0.19346950473557042
Bond Position:  [15.76824338]


portfolio before change:  [-3.08060273]
curr_Stock_Price:  97.46617292810728
curr_Factors:  [97.46617293]
mat_Sqrt:  [[0.15]]
grads:  [0.0124355]
Stock Position:  0.012435503383798747
Bond Position:  [-4.29264365]


portfolio before change:  [-3.07460093]
curr_Stock_Price:  98.12144644639616
curr_Factors:  [98.12144645]
mat_Sqrt:  [[0.15]]
grads:  [0.05657985]
Stock Position:  0.05657985059811044
Bond Position:  [-8.62629771]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.07460093]
Stock Price:  96.93231088659127
PL:  [-3.07460093]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01811405]
 [-0.01914012]
 [-0.01326584]
 [ 0.00312582]
 [ 0.01627683]
 [ 0.01739485]
 [ 0.01069817]
 [ 0.01006482]
 [ 0.0073005 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.89514283]
curr_Stock_Price:  98.49037607126253
curr_Factors:  [98.49037607]
mat_Sqrt:  [[0.15]]
grads:  [0.12076034]
Stock Position:  0.12076034370773125
Bond Position:  [-33.7888745]


portfolio before change:  [-22.16302082]
curr_Stock_Price:  96.41205031089451
curr_Factors:  [96.41205031]
mat_Sqrt:  [[0.15]]
grads:  [-0.12760081]
Stock Position:  -0.1276008148940959
Bond Position:  [-9.86076464]


portfolio before change:  [-22.42211635]
curr_Stock_Price:  98.40391776435476
curr_Factors:  [98.40391776]
mat_Sqrt:  [[0.15]]
grads:  [-0.08843893]
Stock Position:  -0.08843892573472348
Bond Position:  [-13.71937957]


portfolio before change:  [-22.51614781]
curr_Stock_Price:  99.38957038701945
curr_Factors:  [99.38957039]
mat_Sqrt:  [[0.15]]
grads:  [0.02083881]
Stock Position:  0.020838805028740855
Bond Position:  [-24.58730769]


portfolio before change:  [-22.50192323]
curr_Stock_Price:  100.66225915541119
curr_Factors:  [100.66225916]
mat_Sqrt:  [[0.15]]
grads:  [0.10851217]
Stock Position:  0.10851217326978559
Bond Position:  [-33.42500374]


portfolio before change:  [-22.38125341]
curr_Stock_Price:  101.92835214368627
curr_Factors:  [101.92835214]
mat_Sqrt:  [[0.15]]
grads:  [0.11596568]
Stock Position:  0.11596568379904178
Bond Position:  [-34.20144446]


portfolio before change:  [-22.40038417]
curr_Stock_Price:  101.91088351549338
curr_Factors:  [101.91088352]
mat_Sqrt:  [[0.15]]
grads:  [0.07132112]
Stock Position:  0.07132112418611346
Bond Position:  [-29.66878295]


portfolio before change:  [-22.37257974]
curr_Stock_Price:  102.50877824456335
curr_Factors:  [102.50877824]
mat_Sqrt:  [[0.15]]
grads:  [0.06709879]
Stock Position:  0.06709879371438825
Bond Position:  [-29.25079511]


portfolio before change:  [-22.37844452]
curr_Stock_Price:  102.63939575186713
curr_Factors:  [102.63939575]
mat_Sqrt:  [[0.15]]
grads:  [0.04867001]
Stock Position:  0.048670006637299895
Bond Position:  [-27.37390459]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.37844452]
Stock Price:  99.19404320435287
PL:  [-22.37844452]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01784882]
 [-0.02576281]
 [-0.01540625]
 [ 0.00399271]
 [ 0.00848553]
 [ 0.01536232]
 [ 0.03703277]
 [ 0.00481866]
 [ 0.00641345]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.88324813]
curr_Stock_Price:  98.94521706380898
curr_Factors:  [98.94521706]
mat_Sqrt:  [[0.15]]
grads:  [0.1189921]
Stock Position:  0.11899210481394576
Bond Position:  [-26.65694777]


portfolio before change:  [-14.77447194]
curr_Stock_Price:  99.97140280950534
curr_Factors:  [99.97140281]
mat_Sqrt:  [[0.15]]
grads:  [-0.17175209]
Stock Position:  -0.17175209283879436
Bond Position:  [2.39582572]


portfolio before change:  [-14.80709839]
curr_Stock_Price:  100.16834167088099
curr_Factors:  [100.16834167]
mat_Sqrt:  [[0.15]]
grads:  [-0.10270837]
Stock Position:  -0.10270836652080857
Bond Position:  [-4.51897164]


portfolio before change:  [-15.14071594]
curr_Stock_Price:  103.39453941560753
curr_Factors:  [103.39453942]
mat_Sqrt:  [[0.15]]
grads:  [0.02661805]
Stock Position:  0.026618052708968876
Bond Position:  [-17.89287724]


portfolio before change:  [-15.13115415]
curr_Stock_Price:  104.0899497221931
curr_Factors:  [104.08994972]
mat_Sqrt:  [[0.15]]
grads:  [0.05657021]
Stock Position:  0.05657020596362817
Bond Position:  [-21.01954404]


portfolio before change:  [-14.98420217]
curr_Stock_Price:  106.87347111475758
curr_Factors:  [106.87347111]
mat_Sqrt:  [[0.15]]
grads:  [0.10241548]
Stock Position:  0.10241548284821107
Bond Position:  [-25.92970031]


portfolio before change:  [-15.02821704]
curr_Stock_Price:  106.57032574927574
curr_Factors:  [106.57032575]
mat_Sqrt:  [[0.15]]
grads:  [0.24688516]
Stock Position:  0.24688516162666496
Bond Position:  [-41.33884913]


portfolio before change:  [-15.53355289]
curr_Stock_Price:  104.60722172184649
curr_Factors:  [104.60722172]
mat_Sqrt:  [[0.15]]
grads:  [0.03212438]
Stock Position:  0.03212437993409638
Bond Position:  [-18.89399502]


portfolio before change:  [-15.53511269]
curr_Stock_Price:  104.85281579465902
curr_Factors:  [104.85281579]
mat_Sqrt:  [[0.15]]
grads:  [0.04275632]
Stock Position:  0.04275632496368347
Bond Position:  [-20.01823375]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.53511269]
Stock Price:  106.84794634095185
PL:  [-22.38305903]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00381344]
 [ 0.00340775]
 [ 0.01851056]
 [ 0.00235447]
 [ 0.01667788]
 [ 0.0185711 ]
 [-0.0150752 ]
 [ 0.00337404]
 [ 0.00849714]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.48007873]
curr_Stock_Price:  99.8795083145649
curr_Factors:  [99.87950831]
mat_Sqrt:  [[0.15]]
grads:  [-0.02542295]
Stock Position:  -0.025422946008158028
Bond Position:  [2.05915262]


portfolio before change:  [-0.5178887]
curr_Stock_Price:  101.40725416514552
curr_Factors:  [101.40725417]
mat_Sqrt:  [[0.15]]
grads:  [0.02271831]
Stock Position:  0.022718313024177886
Bond Position:  [-2.82169044]


portfolio before change:  [-0.51672531]
curr_Stock_Price:  101.52058047872438
curr_Factors:  [101.52058048]
mat_Sqrt:  [[0.15]]
grads:  [0.12340371]
Stock Position:  0.12340370669732834
Bond Position:  [-13.04474125]


portfolio before change:  [-0.51511823]
curr_Stock_Price:  101.58647058366726
curr_Factors:  [101.58647058]
mat_Sqrt:  [[0.15]]
grads:  [0.01569647]
Stock Position:  0.015696472705783567
Bond Position:  [-2.10966749]


portfolio before change:  [-0.51401905]
curr_Stock_Price:  101.7237162445153
curr_Factors:  [101.72371624]
mat_Sqrt:  [[0.15]]
grads:  [0.11118585]
Stock Position:  0.11118585040744353
Bond Position:  [-11.82425695]


portfolio before change:  [-0.84234199]
curr_Stock_Price:  98.82398284778692
curr_Factors:  [98.82398285]
mat_Sqrt:  [[0.15]]
grads:  [0.1238073]
Stock Position:  0.12380730345526968
Bond Position:  [-13.07747282]


portfolio before change:  [-0.87395267]
curr_Stock_Price:  98.6214882630831
curr_Factors:  [98.62148826]
mat_Sqrt:  [[0.15]]
grads:  [-0.10050132]
Stock Position:  -0.10050131975985746
Bond Position:  [9.03763706]


portfolio before change:  [-0.88086916]
curr_Stock_Price:  98.73528225805276
curr_Factors:  [98.73528226]
mat_Sqrt:  [[0.15]]
grads:  [0.02249357]
Stock Position:  0.022493571436548194
Bond Position:  [-3.10177829]


portfolio before change:  [-0.89061304]
curr_Stock_Price:  98.37106249124945
curr_Factors:  [98.37106249]
mat_Sqrt:  [[0.15]]
grads:  [0.05664758]
Stock Position:  0.05664758298998554
Bond Position:  [-6.46309597]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.89061304]
Stock Price:  96.97830112781652
PL:  [-0.89061304]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 9.96098216e-03]
 [-1.94139939e-02]
 [-1.34376005e-02]
 [ 1.34964016e-03]
 [ 4.60074679e-03]
 [ 1.74792127e-02]
 [-2.75900827e-02]
 [ 3.00157903e-03]
 [ 8.42543165e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-31.55815528]
curr_Stock_Price:  97.86356486463644
curr_Factors:  [97.86356486]
mat_Sqrt:  [[0.15]]
grads:  [0.06640655]
Stock Position:  0.06640654772405426
Bond Position:  [-38.05693678]


portfolio before change:  [-31.49972478]
curr_Stock_Price:  99.03007230437456
curr_Factors:  [99.0300723]
mat_Sqrt:  [[0.15]]
grads:  [-0.12942663]
Stock Position:  -0.12942662627692855
Bond Position:  [-18.68259662]


portfolio before change:  [-31.66874409]
curr_Stock_Price:  100.26378809207499
curr_Factors:  [100.26378809]
mat_Sqrt:  [[0.15]]
grads:  [-0.089584]
Stock Position:  -0.08958400338547064
Bond Position:  [-22.68671255]


portfolio before change:  [-31.50857793]
curr_Stock_Price:  98.3492459539786
curr_Factors:  [98.34924595]
mat_Sqrt:  [[0.15]]
grads:  [0.0089976]
Stock Position:  0.008997601064960253
Bond Position:  [-32.39348521]


portfolio before change:  [-31.53076207]
curr_Stock_Price:  97.68425258209963
curr_Factors:  [97.68425258]
mat_Sqrt:  [[0.15]]
grads:  [0.03067165]
Stock Position:  0.030671645284002305
Bond Position:  [-34.52689881]


portfolio before change:  [-31.5932792]
curr_Stock_Price:  96.2089692819507
curr_Factors:  [96.20896928]
mat_Sqrt:  [[0.15]]
grads:  [0.11652808]
Stock Position:  0.11652808438295267
Bond Position:  [-42.80432609]


portfolio before change:  [-31.51162764]
curr_Stock_Price:  97.09338328465888
curr_Factors:  [97.09338328]
mat_Sqrt:  [[0.15]]
grads:  [-0.18393388]
Stock Position:  -0.1839338849764616
Bond Position:  [-13.65286445]


portfolio before change:  [-31.77031303]
curr_Stock_Price:  98.46266468361637
curr_Factors:  [98.46266468]
mat_Sqrt:  [[0.15]]
grads:  [0.02001053]
Stock Position:  0.020010526847220527
Bond Position:  [-33.74060282]


portfolio before change:  [-31.76544353]
curr_Stock_Price:  99.5492936901003
curr_Factors:  [99.54929369]
mat_Sqrt:  [[0.15]]
grads:  [0.05616954]
Stock Position:  0.056169544329747065
Bond Position:  [-37.357082]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-31.76544353]
Stock Price:  98.99659017210904
PL:  [-31.76544353]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01757413]
 [-0.02634286]
 [ 0.01621941]
 [ 0.0042379 ]
 [ 0.0024061 ]
 [ 0.01612168]
 [ 0.02022426]
 [ 0.00420208]
 [ 0.00680463]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.85057798]
curr_Stock_Price:  99.01220334028194
curr_Factors:  [99.01220334]
mat_Sqrt:  [[0.15]]
grads:  [0.11716088]
Stock Position:  0.11716088347466264
Bond Position:  [-25.4509352]


portfolio before change:  [-13.75385797]
curr_Stock_Price:  99.9463774422235
curr_Factors:  [99.94637744]
mat_Sqrt:  [[0.15]]
grads:  [-0.17561907]
Stock Position:  -0.1756190700454306
Bond Position:  [3.79863189]


portfolio before change:  [-14.01331584]
curr_Stock_Price:  101.43458522131735
curr_Factors:  [101.43458522]
mat_Sqrt:  [[0.15]]
grads:  [0.10812941]
Stock Position:  0.10812940513693553
Bond Position:  [-24.9813772]


portfolio before change:  [-14.10800518]
curr_Stock_Price:  100.67442636480746
curr_Factors:  [100.67442636]
mat_Sqrt:  [[0.15]]
grads:  [0.02825269]
Stock Position:  0.028252687004864278
Bond Position:  [-16.95232824]


portfolio before change:  [-13.98767141]
curr_Stock_Price:  105.23371126731918
curr_Factors:  [105.23371127]
mat_Sqrt:  [[0.15]]
grads:  [0.0160407]
Stock Position:  0.01604069844880677
Bond Position:  [-15.67569364]


portfolio before change:  [-13.99942984]
curr_Stock_Price:  104.98941875400583
curr_Factors:  [104.98941875]
mat_Sqrt:  [[0.15]]
grads:  [0.10747785]
Stock Position:  0.10747785119487331
Bond Position:  [-25.28346697]


portfolio before change:  [-14.15718085]
curr_Stock_Price:  103.63931624284646
curr_Factors:  [103.63931624]
mat_Sqrt:  [[0.15]]
grads:  [0.1348284]
Stock Position:  0.13482840468041235
Bond Position:  [-28.13070453]


portfolio before change:  [-13.99015693]
curr_Stock_Price:  104.98245157890462
curr_Factors:  [104.98245158]
mat_Sqrt:  [[0.15]]
grads:  [0.02801386]
Stock Position:  0.028013860888400195
Bond Position:  [-16.93112072]


portfolio before change:  [-14.02954882]
curr_Stock_Price:  103.87856164719125
curr_Factors:  [103.87856165]
mat_Sqrt:  [[0.15]]
grads:  [0.04536419]
Stock Position:  0.04536419371947092
Bond Position:  [-18.74191602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.02954882]
Stock Price:  102.00972767716434
PL:  [-16.0392765]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.66148339e-03]
 [-1.85147571e-02]
 [-3.95510973e-02]
 [-8.16853233e-03]
 [-1.83201732e-02]
 [ 1.64387502e-02]
 [-3.30892915e-02]
 [ 2.05190585e-03]
 [ 8.45567613e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.72775626]
curr_Stock_Price:  100.34705937781263
curr_Factors:  [100.34705938]
mat_Sqrt:  [[0.15]]
grads:  [-0.02440989]
Stock Position:  -0.0244098892726386
Bond Position:  [9.17721687]


portfolio before change:  [6.77265345]
curr_Stock_Price:  98.69578472984217
curr_Factors:  [98.69578473]
mat_Sqrt:  [[0.15]]
grads:  [-0.12343171]
Stock Position:  -0.12343171399935515
Bond Position:  [18.95484332]


portfolio before change:  [7.12347594]
curr_Stock_Price:  95.930347118634
curr_Factors:  [95.93034712]
mat_Sqrt:  [[0.15]]
grads:  [-0.26367398]
Stock Position:  -0.2636739822460527
Bond Position:  [32.41781259]


portfolio before change:  [7.47897513]
curr_Stock_Price:  94.64358297205912
curr_Factors:  [94.64358297]
mat_Sqrt:  [[0.15]]
grads:  [-0.05445688]
Stock Position:  -0.05445688216691828
Bond Position:  [12.63296957]


portfolio before change:  [7.54014041]
curr_Stock_Price:  93.6364151377868
curr_Factors:  [93.63641514]
mat_Sqrt:  [[0.15]]
grads:  [-0.12213449]
Stock Position:  -0.1221344881171299
Bond Position:  [18.97637605]


portfolio before change:  [7.51938376]
curr_Stock_Price:  93.88407010268666
curr_Factors:  [93.8840701]
mat_Sqrt:  [[0.15]]
grads:  [0.10959167]
Stock Position:  0.10959166794772156
Bond Position:  [-2.76952807]


portfolio before change:  [7.74058201]
curr_Stock_Price:  95.91509458660232
curr_Factors:  [95.91509459]
mat_Sqrt:  [[0.15]]
grads:  [-0.22059528]
Stock Position:  -0.22059527675282956
Bond Position:  [28.89899885]


portfolio before change:  [7.37873485]
curr_Stock_Price:  97.62093469966825
curr_Factors:  [97.6209347]
mat_Sqrt:  [[0.15]]
grads:  [0.01367937]
Stock Position:  0.013679372313064077
Bond Position:  [6.04334174]


portfolio before change:  [7.3791182]
curr_Stock_Price:  97.42801062538734
curr_Factors:  [97.42801063]
mat_Sqrt:  [[0.15]]
grads:  [0.05637117]
Stock Position:  0.05637117416944311
Bond Position:  [1.88698684]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.3791182]
Stock Price:  95.77126892968306
PL:  [7.3791182]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.57958781e-03]
 [-2.07659573e-02]
 [-1.16166425e-02]
 [ 3.02677786e-03]
 [ 1.61493653e-02]
 [ 1.81327597e-02]
 [ 1.83626307e-03]
 [ 1.13680568e-02]
 [ 8.41137738e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.44183917]
curr_Stock_Price:  100.26364571693875
curr_Factors:  [100.26364572]
mat_Sqrt:  [[0.15]]
grads:  [-0.03053059]
Stock Position:  -0.030530585393660645
Bond Position:  [8.50294697]


portfolio before change:  [5.47910801]
curr_Stock_Price:  99.18222823134496
curr_Factors:  [99.18222823]
mat_Sqrt:  [[0.15]]
grads:  [-0.13843972]
Stock Position:  -0.13843971519042428
Bond Position:  [19.20986744]


portfolio before change:  [5.54686985]
curr_Stock_Price:  98.76215727689991
curr_Factors:  [98.76215728]
mat_Sqrt:  [[0.15]]
grads:  [-0.07744428]
Stock Position:  -0.07744428327208767
Bond Position:  [13.19543434]


portfolio before change:  [5.50917404]
curr_Stock_Price:  99.33411918444419
curr_Factors:  [99.33411918]
mat_Sqrt:  [[0.15]]
grads:  [0.02017852]
Stock Position:  0.02017851904343759
Bond Position:  [3.50475862]


portfolio before change:  [5.53717149]
curr_Stock_Price:  100.63474148398275
curr_Factors:  [100.63474148]
mat_Sqrt:  [[0.15]]
grads:  [0.10766244]
Stock Position:  0.10766243512120022
Bond Position:  [-5.29740984]


portfolio before change:  [5.53198527]
curr_Stock_Price:  100.61117842788464
curr_Factors:  [100.61117843]
mat_Sqrt:  [[0.15]]
grads:  [0.12088506]
Stock Position:  0.12088506482295011
Bond Position:  [-6.63040356]


portfolio before change:  [5.52160735]
curr_Stock_Price:  100.55276029311983
curr_Factors:  [100.55276029]
mat_Sqrt:  [[0.15]]
grads:  [0.01224175]
Stock Position:  0.012241753801992342
Bond Position:  [4.29066522]


portfolio before change:  [5.52471043]
curr_Stock_Price:  100.6309521698684
curr_Factors:  [100.63095217]
mat_Sqrt:  [[0.15]]
grads:  [0.07578705]
Stock Position:  0.07578704505754953
Bond Position:  [-2.10181208]


portfolio before change:  [5.47324189]
curr_Stock_Price:  99.96570169440234
curr_Factors:  [99.96570169]
mat_Sqrt:  [[0.15]]
grads:  [0.05607585]
Stock Position:  0.05607584918769828
Bond Position:  [-0.13241972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.47324189]
Stock Price:  103.13039724926433
PL:  [2.34284464]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [6.39655303e-02]
 [1.17875178e-03]
 [5.27771241e-02]
 [6.46739712e-03]
 [1.17049148e-02]
 [1.58513374e-02]
 [3.53448025e-02]
 [4.06833738e-03]
 [7.35783843e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [37.66835741]
curr_Stock_Price:  102.35408520218074
curr_Factors:  [102.3540852]
mat_Sqrt:  [[0.15]]
grads:  [0.42643687]
Stock Position:  0.42643686878890263
Bond Position:  [-5.97919819]


portfolio before change:  [38.08711315]
curr_Stock_Price:  103.34308525787814
curr_Factors:  [103.34308526]
mat_Sqrt:  [[0.15]]
grads:  [0.00785835]
Stock Position:  0.007858345174154615
Bond Position:  [37.27500751]


portfolio before change:  [38.10286274]
curr_Stock_Price:  102.97499575396066
curr_Factors:  [102.97499575]
mat_Sqrt:  [[0.15]]
grads:  [0.35184749]
Stock Position:  0.3518474937369534
Bond Position:  [1.87136856]


portfolio before change:  [38.56708011]
curr_Stock_Price:  104.29170672022693
curr_Factors:  [104.29170672]
mat_Sqrt:  [[0.15]]
grads:  [0.04311598]
Stock Position:  0.04311598077885091
Bond Position:  [34.07044089]


portfolio before change:  [38.5201601]
curr_Stock_Price:  102.8082780065463
curr_Factors:  [102.80827801]
mat_Sqrt:  [[0.15]]
grads:  [0.07803277]
Stock Position:  0.07803276544094224
Bond Position:  [30.49774586]


portfolio before change:  [38.75941184]
curr_Stock_Price:  105.67885489508312
curr_Factors:  [105.6788549]
mat_Sqrt:  [[0.15]]
grads:  [0.10567558]
Stock Position:  0.10567558287662457
Bond Position:  [27.59173725]


portfolio before change:  [38.83635745]
curr_Stock_Price:  106.27640341175471
curr_Factors:  [106.27640341]
mat_Sqrt:  [[0.15]]
grads:  [0.23563202]
Stock Position:  0.23563201652570265
Bond Position:  [13.7942342]


portfolio before change:  [38.55873881]
curr_Stock_Price:  105.06893810371815
curr_Factors:  [105.0689381]
mat_Sqrt:  [[0.15]]
grads:  [0.02712225]
Stock Position:  0.027122249202316442
Bond Position:  [35.70903288]


portfolio before change:  [38.50379388]
curr_Stock_Price:  102.38465095883315
curr_Factors:  [102.38465096]
mat_Sqrt:  [[0.15]]
grads:  [0.04905226]
Stock Position:  0.04905225618099808
Bond Position:  [33.48159575]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [38.50379388]
Stock Price:  101.5128332159719
PL:  [36.99096067]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-1.06143894e-03]
 [ 2.00242703e-03]
 [ 4.82564555e-02]
 [ 2.17172674e-03]
 [ 1.17322323e-02]
 [ 1.64891968e-02]
 [ 2.04927814e-02]
 [ 6.63529663e-03]
 [ 6.95116963e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.3094625]
curr_Stock_Price:  100.44966001099283
curr_Factors:  [100.44966001]
mat_Sqrt:  [[0.15]]
grads:  [-0.00707626]
Stock Position:  -0.007076259573747928
Bond Position:  [9.02027037]


portfolio before change:  [8.30909045]
curr_Stock_Price:  101.13975806762849
curr_Factors:  [101.13975807]
mat_Sqrt:  [[0.15]]
grads:  [0.01334951]
Stock Position:  0.013349513512046288
Bond Position:  [6.95892388]


portfolio before change:  [8.33428228]
curr_Stock_Price:  102.76614703403784
curr_Factors:  [102.76614703]
mat_Sqrt:  [[0.15]]
grads:  [0.3217097]
Stock Position:  0.3217097032396786
Bond Position:  [-24.72658438]


portfolio before change:  [8.16738229]
curr_Stock_Price:  102.2857959460481
curr_Factors:  [102.28579595]
mat_Sqrt:  [[0.15]]
grads:  [0.01447818]
Stock Position:  0.014478178239804356
Bond Position:  [6.68647031]


portfolio before change:  [8.17786544]
curr_Stock_Price:  102.77888777192449
curr_Factors:  [102.77888777]
mat_Sqrt:  [[0.15]]
grads:  [0.07821488]
Stock Position:  0.0782148822655619
Bond Position:  [0.13902683]


portfolio before change:  [8.27044819]
curr_Stock_Price:  103.9616962265151
curr_Factors:  [103.96169623]
mat_Sqrt:  [[0.15]]
grads:  [0.10992798]
Stock Position:  0.10992797855912026
Bond Position:  [-3.15785092]


portfolio before change:  [8.23878608]
curr_Stock_Price:  103.68803715384183
curr_Factors:  [103.68803715]
mat_Sqrt:  [[0.15]]
grads:  [0.13661854]
Stock Position:  0.13661854236500692
Bond Position:  [-5.92692241]


portfolio before change:  [8.23414779]
curr_Stock_Price:  103.67578338731222
curr_Factors:  [103.67578339]
mat_Sqrt:  [[0.15]]
grads:  [0.04423531]
Stock Position:  0.04423531088502876
Bond Position:  [3.64801728]


portfolio before change:  [8.2287978]
curr_Stock_Price:  103.51359502662673
curr_Factors:  [103.51359503]
mat_Sqrt:  [[0.15]]
grads:  [0.04634113]
Stock Position:  0.04634113084532186
Bond Position:  [3.43186075]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.2287978]
Stock Price:  103.87086875244165
PL:  [4.35792905]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01805733]
 [-0.02289833]
 [-0.05981676]
 [-0.01216044]
 [-0.01210775]
 [ 0.01671588]
 [-0.03807767]
 [-0.00783154]
 [ 0.00854095]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.1875416]
curr_Stock_Price:  98.47140902275771
curr_Factors:  [98.47140902]
mat_Sqrt:  [[0.15]]
grads:  [0.12038223]
Stock Position:  0.12038222546302269
Bond Position:  [-34.04174896]


portfolio before change:  [-22.52985362]
curr_Stock_Price:  95.76929173130765
curr_Factors:  [95.76929173]
mat_Sqrt:  [[0.15]]
grads:  [-0.15265553]
Stock Position:  -0.15265552922604034
Bond Position:  [-7.91014171]


portfolio before change:  [-22.29579463]
curr_Stock_Price:  94.21012742183171
curr_Factors:  [94.21012742]
mat_Sqrt:  [[0.15]]
grads:  [-0.39877839]
Stock Position:  -0.3987783878397856
Bond Position:  [15.2731681]


portfolio before change:  [-22.11479369]
curr_Stock_Price:  93.77539361986861
curr_Factors:  [93.77539362]
mat_Sqrt:  [[0.15]]
grads:  [-0.08106961]
Stock Position:  -0.08106961359168315
Bond Position:  [-14.51245877]


portfolio before change:  [-22.19780344]
curr_Stock_Price:  94.70979676369397
curr_Factors:  [94.70979676]
mat_Sqrt:  [[0.15]]
grads:  [-0.08071836]
Stock Position:  -0.0807183614064259
Bond Position:  [-14.55298383]


portfolio before change:  [-22.20989742]
curr_Stock_Price:  94.76945694418514
curr_Factors:  [94.76945694]
mat_Sqrt:  [[0.15]]
grads:  [0.11143919]
Stock Position:  0.11143919004003684
Bond Position:  [-32.77092894]


portfolio before change:  [-22.28909754]
curr_Stock_Price:  94.20582618615005
curr_Factors:  [94.20582619]
mat_Sqrt:  [[0.15]]
grads:  [-0.25385111]
Stock Position:  -0.2538511061252364
Bond Position:  [1.62515564]


portfolio before change:  [-22.23045639]
curr_Stock_Price:  93.9780219271963
curr_Factors:  [93.97802193]
mat_Sqrt:  [[0.15]]
grads:  [-0.05221028]
Stock Position:  -0.05221027683191398
Bond Position:  [-17.32383785]


portfolio before change:  [-22.3209734]
curr_Stock_Price:  95.5457769280033
curr_Factors:  [95.54577693]
mat_Sqrt:  [[0.15]]
grads:  [0.05693964]
Stock Position:  0.056939639442987446
Bond Position:  [-27.76131549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.3209734]
Stock Price:  96.4128882826896
PL:  [-22.3209734]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.10330232]
 [0.00265616]
 [0.04618469]
 [0.00234459]
 [0.00974205]
 [0.01701512]
 [0.0084294 ]
 [0.01205244]
 [0.00788729]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [54.57352765]
curr_Stock_Price:  103.45067389081643
curr_Factors:  [103.45067389]
mat_Sqrt:  [[0.15]]
grads:  [0.68868216]
Stock Position:  0.6886821561142293
Bond Position:  [-16.6711055]


portfolio before change:  [53.4565877]
curr_Stock_Price:  101.84092939744926
curr_Factors:  [101.8409294]
mat_Sqrt:  [[0.15]]
grads:  [0.01770776]
Stock Position:  0.017707758566647414
Bond Position:  [51.65321311]


portfolio before change:  [53.49710943]
curr_Stock_Price:  102.67043409747198
curr_Factors:  [102.6704341]
mat_Sqrt:  [[0.15]]
grads:  [0.3078979]
Stock Position:  0.3078979047705918
Bond Position:  [21.88509789]


portfolio before change:  [53.45724322]
curr_Stock_Price:  102.50540699334579
curr_Factors:  [102.50540699]
mat_Sqrt:  [[0.15]]
grads:  [0.0156306]
Stock Position:  0.01563060046140448
Bond Position:  [51.85502216]


portfolio before change:  [53.50424953]
curr_Stock_Price:  103.8535521203665
curr_Factors:  [103.85355212]
mat_Sqrt:  [[0.15]]
grads:  [0.06494702]
Stock Position:  0.06494702053703716
Bond Position:  [46.75927075]


portfolio before change:  [53.44860906]
curr_Stock_Price:  102.63677647690889
curr_Factors:  [102.63677648]
mat_Sqrt:  [[0.15]]
grads:  [0.11343414]
Stock Position:  0.11343413530995275
Bond Position:  [41.80609507]


portfolio before change:  [53.34048109]
curr_Stock_Price:  101.49923314520301
curr_Factors:  [101.49923315]
mat_Sqrt:  [[0.15]]
grads:  [0.05619598]
Stock Position:  0.056195979239542226
Bond Position:  [47.63663229]


portfolio before change:  [53.32667545]
curr_Stock_Price:  100.82961389025223
curr_Factors:  [100.82961389]
mat_Sqrt:  [[0.15]]
grads:  [0.08034958]
Stock Position:  0.08034958117243647
Bond Position:  [45.22505821]


portfolio before change:  [53.38081109]
curr_Stock_Price:  101.22186802175985
curr_Factors:  [101.22186802]
mat_Sqrt:  [[0.15]]
grads:  [0.05258192]
Stock Position:  0.05258191901862536
Bond Position:  [48.05837102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [53.38081109]
Stock Price:  104.38776195076203
PL:  [48.99304914]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 2.14000230e-02]
 [ 2.04279645e-03]
 [ 2.06732410e-02]
 [ 2.16508030e-03]
 [ 1.17388569e-02]
 [ 1.78995999e-02]
 [-4.18127015e-04]
 [ 1.04859697e-02]
 [ 8.42923446e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.05646138]
curr_Stock_Price:  101.21165328974324
curr_Factors:  [101.21165329]
mat_Sqrt:  [[0.15]]
grads:  [0.14266682]
Stock Position:  0.14266681973425394
Bond Position:  [5.61691669]


portfolio before change:  [20.23802011]
curr_Stock_Price:  102.46456947548451
curr_Factors:  [102.46456948]
mat_Sqrt:  [[0.15]]
grads:  [0.01361864]
Stock Position:  0.013618642983834115
Bond Position:  [18.84259172]


portfolio before change:  [20.23569339]
curr_Stock_Price:  101.60175414137807
curr_Factors:  [101.60175414]
mat_Sqrt:  [[0.15]]
grads:  [0.13782161]
Stock Position:  0.13782160646900354
Bond Position:  [6.23277641]


portfolio before change:  [20.33192255]
curr_Stock_Price:  102.27735210460439
curr_Factors:  [102.2773521]
mat_Sqrt:  [[0.15]]
grads:  [0.01443387]
Stock Position:  0.01443386867234355
Bond Position:  [18.85566468]


portfolio before change:  [20.34848897]
curr_Stock_Price:  102.77176057842497
curr_Factors:  [102.77176058]
mat_Sqrt:  [[0.15]]
grads:  [0.07825905]
Stock Position:  0.07825904597726067
Bond Position:  [12.30566903]


portfolio before change:  [20.22863128]
curr_Stock_Price:  101.1615689401609
curr_Factors:  [101.16156894]
mat_Sqrt:  [[0.15]]
grads:  [0.11933067]
Stock Position:  0.11933066602732599
Bond Position:  [8.15695388]


portfolio before change:  [20.12500004]
curr_Stock_Price:  100.25894481150483
curr_Factors:  [100.25894481]
mat_Sqrt:  [[0.15]]
grads:  [-0.00278751]
Stock Position:  -0.00278751343488493
Bond Position:  [20.40447319]


portfolio before change:  [20.13484357]
curr_Stock_Price:  100.38854328768693
curr_Factors:  [100.38854329]
mat_Sqrt:  [[0.15]]
grads:  [0.06990646]
Stock Position:  0.06990646472309595
Bond Position:  [13.11703541]


portfolio before change:  [20.07725291]
curr_Stock_Price:  99.47087687829367
curr_Factors:  [99.47087688]
mat_Sqrt:  [[0.15]]
grads:  [0.0561949]
Stock Position:  0.05619489640025982
Bond Position:  [14.48749729]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.07725291]
Stock Price:  101.16165921107066
PL:  [18.9155937]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [1.85374781e-02]
 [4.87855983e-04]
 [6.81600649e-02]
 [2.43626359e-03]
 [3.53273749e-04]
 [1.74075454e-02]
 [1.44533733e-02]
 [7.98946070e-03]
 [7.65801447e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.94781721]
curr_Stock_Price:  101.13973880211424
curr_Factors:  [101.1397388]
mat_Sqrt:  [[0.15]]
grads:  [0.12358319]
Stock Position:  0.12358318742320486
Bond Position:  [6.44864592]


portfolio before change:  [18.92746383]
curr_Stock_Price:  100.94894823560459
curr_Factors:  [100.94894824]
mat_Sqrt:  [[0.15]]
grads:  [0.00325237]
Stock Position:  0.0032523732203443177
Bond Position:  [18.59914018]


portfolio before change:  [18.94566656]
curr_Stock_Price:  103.68566663374946
curr_Factors:  [103.68566663]
mat_Sqrt:  [[0.15]]
grads:  [0.45440043]
Stock Position:  0.45440043299128063
Bond Position:  [-28.16914525]


portfolio before change:  [18.47810942]
curr_Stock_Price:  102.68771634372432
curr_Factors:  [102.68771634]
mat_Sqrt:  [[0.15]]
grads:  [0.01624176]
Stock Position:  0.016241757261872772
Bond Position:  [16.81028046]


portfolio before change:  [18.53414086]
curr_Stock_Price:  105.61992357225203
curr_Factors:  [105.61992357]
mat_Sqrt:  [[0.15]]
grads:  [0.00235516]
Stock Position:  0.0023551583274461266
Bond Position:  [18.28538922]


portfolio before change:  [18.53453584]
curr_Stock_Price:  101.9046725003896
curr_Factors:  [101.9046725]
mat_Sqrt:  [[0.15]]
grads:  [0.1160503]
Stock Position:  0.11605030280829735
Bond Position:  [6.70846774]


portfolio before change:  [18.61768277]
curr_Stock_Price:  102.5922351818987
curr_Factors:  [102.59223518]
mat_Sqrt:  [[0.15]]
grads:  [0.09635582]
Stock Position:  0.09635582221565485
Bond Position:  [8.73232359]


portfolio before change:  [18.68328919]
curr_Stock_Price:  103.22778753176608
curr_Factors:  [103.22778753]
mat_Sqrt:  [[0.15]]
grads:  [0.05326307]
Stock Position:  0.05326307131093957
Bond Position:  [13.18506018]


portfolio before change:  [18.60313339]
curr_Stock_Price:  101.5990798322828
curr_Factors:  [101.59907983]
mat_Sqrt:  [[0.15]]
grads:  [0.05105343]
Stock Position:  0.051053429770900466
Bond Position:  [13.41615191]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.60313339]
Stock Price:  101.03578482225177
PL:  [17.56734857]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00292941]
 [-0.01973928]
 [-0.01558058]
 [ 0.00256737]
 [ 0.01585329]
 [ 0.01657742]
 [ 0.01185133]
 [ 0.0119233 ]
 [ 0.00744913]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.25574173]
curr_Stock_Price:  99.99210588435507
curr_Factors:  [99.99210588]
mat_Sqrt:  [[0.15]]
grads:  [-0.01952937]
Stock Position:  -0.019529368208007852
Bond Position:  [3.20852439]


portfolio before change:  [1.25384496]
curr_Stock_Price:  100.17139685852072
curr_Factors:  [100.17139686]
mat_Sqrt:  [[0.15]]
grads:  [-0.13159517]
Stock Position:  -0.1315951702026649
Bond Position:  [14.43591698]


portfolio before change:  [1.26598687]
curr_Stock_Price:  100.13399314273646
curr_Factors:  [100.13399314]
mat_Sqrt:  [[0.15]]
grads:  [-0.10387052]
Stock Position:  -0.10387052487077367
Bond Position:  [11.66695729]


portfolio before change:  [1.13770564]
curr_Stock_Price:  101.42517909331504
curr_Factors:  [101.42517909]
mat_Sqrt:  [[0.15]]
grads:  [0.0171158]
Stock Position:  0.01711580163031516
Bond Position:  [-0.5982676]


portfolio before change:  [1.13578771]
curr_Stock_Price:  101.33060401070301
curr_Factors:  [101.33060401]
mat_Sqrt:  [[0.15]]
grads:  [0.10568859]
Stock Position:  0.10568858699279932
Bond Position:  [-9.57370065]


portfolio before change:  [1.3830011]
curr_Stock_Price:  103.71498106517545
curr_Factors:  [103.71498107]
mat_Sqrt:  [[0.15]]
grads:  [0.11051616]
Stock Position:  0.11051615635205898
Bond Position:  [-10.07917996]


portfolio before change:  [1.20170187]
curr_Stock_Price:  102.12011574600743
curr_Factors:  [102.12011575]
mat_Sqrt:  [[0.15]]
grads:  [0.07900888]
Stock Position:  0.07900888069605434
Bond Position:  [-6.86669418]


portfolio before change:  [1.09278152]
curr_Stock_Price:  100.78499824343618
curr_Factors:  [100.78499824]
mat_Sqrt:  [[0.15]]
grads:  [0.07948869]
Stock Position:  0.07948869109778664
Bond Position:  [-6.91848607]


portfolio before change:  [1.18434872]
curr_Stock_Price:  101.9804803617393
curr_Factors:  [101.98048036]
mat_Sqrt:  [[0.15]]
grads:  [0.04966086]
Stock Position:  0.0496608630066754
Bond Position:  [-3.88008994]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.18434872]
Stock Price:  100.96327594566904
PL:  [0.22107278]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01408549]
 [-0.02453196]
 [-0.06762531]
 [-0.00721023]
 [ 0.00686704]
 [ 0.01723453]
 [ 0.01424424]
 [ 0.00987638]
 [ 0.00753611]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.63840062]
curr_Stock_Price:  98.11782782491946
curr_Factors:  [98.11782782]
mat_Sqrt:  [[0.15]]
grads:  [0.09390329]
Stock Position:  0.0939032871846207
Bond Position:  [-36.85198718]


portfolio before change:  [-27.90360274]
curr_Stock_Price:  95.48989509556068
curr_Factors:  [95.4898951]
mat_Sqrt:  [[0.15]]
grads:  [-0.1635464]
Stock Position:  -0.16354640352358157
Bond Position:  [-12.28657383]


portfolio before change:  [-27.59204488]
curr_Stock_Price:  93.54731075816301
curr_Factors:  [93.54731076]
mat_Sqrt:  [[0.15]]
grads:  [-0.45083537]
Stock Position:  -0.4508353730778032
Bond Position:  [14.58239186]


portfolio before change:  [-28.17295227]
curr_Stock_Price:  94.8520007573694
curr_Factors:  [94.85200076]
mat_Sqrt:  [[0.15]]
grads:  [-0.04806822]
Stock Position:  -0.04806822221547661
Bond Position:  [-23.61358522]


portfolio before change:  [-28.3564494]
curr_Stock_Price:  98.42374493716957
curr_Factors:  [98.42374494]
mat_Sqrt:  [[0.15]]
grads:  [0.04578025]
Stock Position:  0.04578024962605973
Bond Position:  [-32.86231302]


portfolio before change:  [-28.19875039]
curr_Stock_Price:  102.22744370324229
curr_Factors:  [102.2274437]
mat_Sqrt:  [[0.15]]
grads:  [0.11489688]
Stock Position:  0.11489688258741626
Bond Position:  [-39.94436499]


portfolio before change:  [-28.18117403]
curr_Stock_Price:  102.55428921892651
curr_Factors:  [102.55428922]
mat_Sqrt:  [[0.15]]
grads:  [0.09496159]
Stock Position:  0.09496158518463539
Bond Position:  [-37.91989191]


portfolio before change:  [-28.19829281]
curr_Stock_Price:  102.57372773680227
curr_Factors:  [102.57372774]
mat_Sqrt:  [[0.15]]
grads:  [0.06584256]
Stock Position:  0.06584255586670452
Bond Position:  [-34.95200921]


portfolio before change:  [-28.26674116]
curr_Stock_Price:  101.79963901169961
curr_Factors:  [101.79963901]
mat_Sqrt:  [[0.15]]
grads:  [0.05024075]
Stock Position:  0.05024074962484102
Bond Position:  [-33.38123134]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-28.26674116]
Stock Price:  101.29636465519118
PL:  [-29.56310582]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.41506067e-03]
 [-1.72125577e-02]
 [-1.54082837e-02]
 [ 4.95151506e-03]
 [ 9.55275637e-03]
 [ 1.74589404e-02]
 [-1.53421645e-03]
 [ 6.42584456e-03]
 [ 7.37683358e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.66136702]
curr_Stock_Price:  99.80288161649187
curr_Factors:  [99.80288162]
mat_Sqrt:  [[0.15]]
grads:  [-0.02943374]
Stock Position:  -0.029433737781939057
Bond Position:  [1.27620483]


portfolio before change:  [-1.60574192]
curr_Stock_Price:  97.93472473280443
curr_Factors:  [97.93472473]
mat_Sqrt:  [[0.15]]
grads:  [-0.11475038]
Stock Position:  -0.11475038472496767
Bond Position:  [9.63230542]


portfolio before change:  [-1.84980305]
curr_Stock_Price:  100.10359316352543
curr_Factors:  [100.10359316]
mat_Sqrt:  [[0.15]]
grads:  [-0.10272189]
Stock Position:  -0.10272189138702167
Bond Position:  [8.43302738]


portfolio before change:  [-1.87738289]
curr_Stock_Price:  100.41314169391299
curr_Factors:  [100.41314169]
mat_Sqrt:  [[0.15]]
grads:  [0.0330101]
Stock Position:  0.03301010036750339
Bond Position:  [-5.19203078]


portfolio before change:  [-1.91321619]
curr_Stock_Price:  99.4062792058367
curr_Factors:  [99.40627921]
mat_Sqrt:  [[0.15]]
grads:  [0.06368504]
Stock Position:  0.06368504243808647
Bond Position:  [-8.2439093]


portfolio before change:  [-1.76433514]
curr_Stock_Price:  101.80879052896275
curr_Factors:  [101.80879053]
mat_Sqrt:  [[0.15]]
grads:  [0.11639294]
Stock Position:  0.11639293623929813
Bond Position:  [-13.6141592]


portfolio before change:  [-1.96827593]
curr_Stock_Price:  100.11511376786022
curr_Factors:  [100.11511377]
mat_Sqrt:  [[0.15]]
grads:  [-0.01022811]
Stock Position:  -0.010228109640795721
Bond Position:  [-0.94428757]


portfolio before change:  [-2.00585783]
curr_Stock_Price:  103.74331542817816
curr_Factors:  [103.74331543]
mat_Sqrt:  [[0.15]]
grads:  [0.04283896]
Stock Position:  0.042838963744178594
Bond Position:  [-6.45011396]


portfolio before change:  [-2.07144249]
curr_Stock_Price:  102.28765944818548
curr_Factors:  [102.28765945]
mat_Sqrt:  [[0.15]]
grads:  [0.04917889]
Stock Position:  0.04917889051860753
Bond Position:  [-7.1018361]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.07144249]
Stock Price:  103.11844169094225
PL:  [-5.18988418]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.97562983e-03]
 [-2.70918459e-02]
 [-4.14950085e-03]
 [ 2.28304637e-03]
 [ 1.61776192e-02]
 [ 1.80374523e-02]
 [ 1.14832310e-02]
 [ 8.54161420e-03]
 [ 7.02787828e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.46767971]
curr_Stock_Price:  99.4911102435737
curr_Factors:  [99.49111024]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983753]
Stock Position:  -0.01983753218471527
Bond Position:  [-4.49402161]


portfolio before change:  [-6.47791881]
curr_Stock_Price:  99.89395904932739
curr_Factors:  [99.89395905]
mat_Sqrt:  [[0.15]]
grads:  [-0.18061231]
Stock Position:  -0.1806123057450886
Bond Position:  [11.56415946]


portfolio before change:  [-6.61109896]
curr_Stock_Price:  100.66336220474597
curr_Factors:  [100.6633622]
mat_Sqrt:  [[0.15]]
grads:  [-0.02766334]
Stock Position:  -0.02766333899759993
Bond Position:  [-3.82641425]


portfolio before change:  [-6.66180684]
curr_Stock_Price:  102.4272199250106
curr_Factors:  [102.42721993]
mat_Sqrt:  [[0.15]]
grads:  [0.01522031]
Stock Position:  0.015220309102659313
Bond Position:  [-8.22078079]


portfolio before change:  [-6.67381527]
curr_Stock_Price:  101.90837311514785
curr_Factors:  [101.90837312]
mat_Sqrt:  [[0.15]]
grads:  [0.10785079]
Stock Position:  0.10785079435406952
Bond Position:  [-17.66471426]


portfolio before change:  [-6.79870322]
curr_Stock_Price:  100.83231819210856
curr_Factors:  [100.83231819]
mat_Sqrt:  [[0.15]]
grads:  [0.12024968]
Stock Position:  0.12024968227787303
Bond Position:  [-18.92375744]


portfolio before change:  [-6.66134157]
curr_Stock_Price:  102.05332677194465
curr_Factors:  [102.05332677]
mat_Sqrt:  [[0.15]]
grads:  [0.07655487]
Stock Position:  0.07655487363948457
Bond Position:  [-14.4740211]


portfolio before change:  [-6.59347239]
curr_Stock_Price:  103.03442686317734
curr_Factors:  [103.03442686]
mat_Sqrt:  [[0.15]]
grads:  [0.05694409]
Stock Position:  0.056944094646954595
Bond Position:  [-12.46067455]


portfolio before change:  [-6.58329747]
curr_Stock_Price:  103.32254829465529
curr_Factors:  [103.32254829]
mat_Sqrt:  [[0.15]]
grads:  [0.04685252]
Stock Position:  0.04685252184581038
Bond Position:  [-11.42421942]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.58329747]
Stock Price:  103.55479492407764
PL:  [-10.1380924]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [6.19328277e-02]
 [2.04160955e-03]
 [1.00621636e-02]
 [2.04884235e-03]
 [1.16575617e-02]
 [1.73131143e-02]
 [6.29536360e-04]
 [1.24753163e-02]
 [7.65518167e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [36.79479398]
curr_Stock_Price:  102.29741971132336
curr_Factors:  [102.29741971]
mat_Sqrt:  [[0.15]]
grads:  [0.41288552]
Stock Position:  0.4128855180542768
Bond Position:  [-5.44232915]


portfolio before change:  [36.86158411]
curr_Stock_Price:  102.46577625166847
curr_Factors:  [102.46577625]
mat_Sqrt:  [[0.15]]
grads:  [0.01361073]
Stock Position:  0.013610730331210796
Bond Position:  [35.46695007]


portfolio before change:  [36.86214126]
curr_Stock_Price:  101.20348068426047
curr_Factors:  [101.20348068]
mat_Sqrt:  [[0.15]]
grads:  [0.06708109]
Stock Position:  0.06708109041099826
Bond Position:  [30.07330142]


portfolio before change:  [36.91840519]
curr_Stock_Price:  101.81801327578408
curr_Factors:  [101.81801328]
mat_Sqrt:  [[0.15]]
grads:  [0.01365895]
Stock Position:  0.013658948968680518
Bond Position:  [35.52767814]


portfolio before change:  [36.95039531]
curr_Stock_Price:  102.85922405027387
curr_Factors:  [102.85922405]
mat_Sqrt:  [[0.15]]
grads:  [0.07771708]
Stock Position:  0.07771707787226567
Bond Position:  [28.95647699]


portfolio before change:  [36.9043836]
curr_Stock_Price:  102.08084215202109
curr_Factors:  [102.08084215]
mat_Sqrt:  [[0.15]]
grads:  [0.11542076]
Stock Position:  0.11542076201685919
Bond Position:  [25.12213502]


portfolio before change:  [36.72242285]
curr_Stock_Price:  100.39548716113678
curr_Factors:  [100.39548716]
mat_Sqrt:  [[0.15]]
grads:  [0.00419691]
Stock Position:  0.00419690906895899
Bond Position:  [36.30107212]


portfolio before change:  [36.74403716]
curr_Stock_Price:  101.2197210817769
curr_Factors:  [101.21972108]
mat_Sqrt:  [[0.15]]
grads:  [0.08316878]
Stock Position:  0.08316877537102774
Bond Position:  [28.32571692]


portfolio before change:  [36.79014199]
curr_Stock_Price:  101.6037404931939
curr_Factors:  [101.60374049]
mat_Sqrt:  [[0.15]]
grads:  [0.05103454]
Stock Position:  0.05103454443939391
Bond Position:  [31.60484138]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.79014199]
Stock Price:  99.92844268584395
PL:  [36.79014199]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 2.05367668e-02]
 [ 2.54850497e-03]
 [ 4.03080184e-02]
 [ 2.04952688e-03]
 [-1.08073623e-03]
 [ 1.64025765e-02]
 [ 3.73831532e-02]
 [ 2.59653780e-03]
 [ 4.94465734e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.72212813]
curr_Stock_Price:  101.1899660748458
curr_Factors:  [101.18996607]
mat_Sqrt:  [[0.15]]
grads:  [0.13691178]
Stock Position:  0.1369117785930513
Bond Position:  [5.8680299]


portfolio before change:  [19.82917405]
curr_Stock_Price:  101.95039129666107
curr_Factors:  [101.9503913]
mat_Sqrt:  [[0.15]]
grads:  [0.01699003]
Stock Position:  0.016990033113207723
Bond Position:  [18.09703353]


portfolio before change:  [19.84584569]
curr_Stock_Price:  102.3989400844785
curr_Factors:  [102.39894008]
mat_Sqrt:  [[0.15]]
grads:  [0.26872012]
Stock Position:  0.268720122460576
Bond Position:  [-7.67081003]


portfolio before change:  [19.76980806]
curr_Stock_Price:  102.1302543386495
curr_Factors:  [102.13025434]
mat_Sqrt:  [[0.15]]
grads:  [0.01366351]
Stock Position:  0.013663512520215516
Bond Position:  [18.37435005]


portfolio before change:  [19.83036494]
curr_Stock_Price:  105.88971309411909
curr_Factors:  [105.88971309]
mat_Sqrt:  [[0.15]]
grads:  [-0.00720491]
Stock Position:  -0.007204908192123249
Bond Position:  [20.5932906]


portfolio before change:  [19.85281015]
curr_Stock_Price:  104.20391942799246
curr_Factors:  [104.20391943]
mat_Sqrt:  [[0.15]]
grads:  [0.10935051]
Stock Position:  0.10935050975959494
Bond Position:  [8.45805844]


portfolio before change:  [20.12247952]
curr_Stock_Price:  106.63133636843042
curr_Factors:  [106.63133637]
mat_Sqrt:  [[0.15]]
grads:  [0.24922102]
Stock Position:  0.2492210213501478
Bond Position:  [-6.45229104]


portfolio before change:  [19.94576694]
curr_Stock_Price:  105.93522484212544
curr_Factors:  [105.93522484]
mat_Sqrt:  [[0.15]]
grads:  [0.01731025]
Stock Position:  0.017310252003821868
Bond Position:  [18.1120015]


portfolio before change:  [20.00837107]
curr_Stock_Price:  109.02852846545748
curr_Factors:  [109.02852847]
mat_Sqrt:  [[0.15]]
grads:  [0.03296438]
Stock Position:  0.03296438224116888
Bond Position:  [16.41431298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.00837107]
Stock Price:  110.38479063748574
PL:  [9.62358043]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 6.54779354e-02]
 [-1.60915878e-03]
 [ 9.46095245e-02]
 [ 2.94936651e-03]
 [ 1.15516645e-02]
 [ 1.64809061e-02]
 [ 2.89307791e-02]
 [ 1.35708477e-04]
 [ 5.55479637e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [38.31832053]
curr_Stock_Price:  102.39624639867219
curr_Factors:  [102.3962464]
mat_Sqrt:  [[0.15]]
grads:  [0.43651957]
Stock Position:  0.43651956907795536
Bond Position:  [-6.37964483]


portfolio before change:  [39.96580318]
curr_Stock_Price:  106.177688032384
curr_Factors:  [106.17768803]
mat_Sqrt:  [[0.15]]
grads:  [-0.01072773]
Stock Position:  -0.010727725196496136
Bond Position:  [41.10484824]


portfolio before change:  [39.99998594]
curr_Stock_Price:  104.90759557686033
curr_Factors:  [104.90759558]
mat_Sqrt:  [[0.15]]
grads:  [0.63073016]
Stock Position:  0.6307301634470889
Bond Position:  [-26.16839896]


portfolio before change:  [38.7928633]
curr_Stock_Price:  103.01449573077534
curr_Factors:  [103.01449573]
mat_Sqrt:  [[0.15]]
grads:  [0.01966244]
Stock Position:  0.019662443432625434
Bond Position:  [36.7673466]


portfolio before change:  [38.81043873]
curr_Stock_Price:  102.97315615536564
curr_Factors:  [102.97315616]
mat_Sqrt:  [[0.15]]
grads:  [0.0770111]
Stock Position:  0.07701109666903497
Bond Position:  [30.88036305]


portfolio before change:  [38.90379674]
curr_Stock_Price:  103.98488002379247
curr_Factors:  [103.98488002]
mat_Sqrt:  [[0.15]]
grads:  [0.10987271]
Stock Position:  0.10987270755493678
Bond Position:  [27.47869642]


portfolio before change:  [39.04660319]
curr_Stock_Price:  105.15954542480216
curr_Factors:  [105.15954542]
mat_Sqrt:  [[0.15]]
grads:  [0.19287186]
Stock Position:  0.19287186059353584
Bond Position:  [18.764286]


portfolio before change:  [39.3079815]
curr_Stock_Price:  106.46608033182073
curr_Factors:  [106.46608033]
mat_Sqrt:  [[0.15]]
grads:  [0.00090472]
Stock Position:  0.0009047231820315018
Bond Position:  [39.21165917]


portfolio before change:  [39.32833957]
curr_Stock_Price:  107.29212229328209
curr_Factors:  [107.29212229]
mat_Sqrt:  [[0.15]]
grads:  [0.03703198]
Stock Position:  0.037031975807245356
Bond Position:  [35.35510029]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [39.32833957]
Stock Price:  107.60200329504677
PL:  [31.72633627]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-7.48278029e-04]
 [-2.12698593e-02]
 [-3.13459046e-02]
 [-6.02657911e-04]
 [ 4.65808226e-03]
 [ 1.85353113e-02]
 [-3.08950997e-02]
 [ 5.97035674e-03]
 [ 8.47557115e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.46925089]
curr_Stock_Price:  100.46002501436149
curr_Factors:  [100.46002501]
mat_Sqrt:  [[0.15]]
grads:  [-0.00498852]
Stock Position:  -0.004988520193984353
Bond Position:  [8.97039776]


portfolio before change:  [8.47980035]
curr_Stock_Price:  99.24460710054866
curr_Factors:  [99.2446071]
mat_Sqrt:  [[0.15]]
grads:  [-0.14179906]
Stock Position:  -0.14179906179247878
Bond Position:  [22.55259253]


portfolio before change:  [8.86227747]
curr_Stock_Price:  96.6268323806375
curr_Factors:  [96.62683238]
mat_Sqrt:  [[0.15]]
grads:  [-0.2089727]
Stock Position:  -0.2089726975771809
Bond Position:  [29.05464729]


portfolio before change:  [8.70726273]
curr_Stock_Price:  97.43816177584445
curr_Factors:  [97.43816178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00401772]
Stock Position:  -0.00401771940714845
Bond Position:  [9.09874192]


portfolio before change:  [8.71063089]
curr_Stock_Price:  97.73244474349521
curr_Factors:  [97.73244474]
mat_Sqrt:  [[0.15]]
grads:  [0.03105388]
Stock Position:  0.031053881762295316
Bond Position:  [5.67565911]


portfolio before change:  [8.73336992]
curr_Stock_Price:  98.37328224563714
curr_Factors:  [98.37328225]
mat_Sqrt:  [[0.15]]
grads:  [0.12356874]
Stock Position:  0.12356874190610032
Bond Position:  [-3.4224928]


portfolio before change:  [8.50591666]
curr_Stock_Price:  96.54643195867982
curr_Factors:  [96.54643196]
mat_Sqrt:  [[0.15]]
grads:  [-0.20596733]
Stock Position:  -0.20596733148702376
Bond Position:  [28.39132761]


portfolio before change:  [7.95097434]
curr_Stock_Price:  99.30969313347362
curr_Factors:  [99.30969313]
mat_Sqrt:  [[0.15]]
grads:  [0.03980238]
Stock Position:  0.03980237825047714
Bond Position:  [3.99821237]


portfolio before change:  [7.89452456]
curr_Stock_Price:  97.84120337648541
curr_Factors:  [97.84120338]
mat_Sqrt:  [[0.15]]
grads:  [0.05650381]
Stock Position:  0.0565038076760994
Bond Position:  [2.36612402]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.89452456]
Stock Price:  96.92744277550362
PL:  [7.89452456]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.64302065e-03]
 [-2.17048806e-03]
 [-1.51835458e-02]
 [ 2.22608049e-03]
 [ 1.56243517e-02]
 [ 1.69452870e-02]
 [ 2.00980742e-02]
 [ 1.24408591e-02]
 [ 8.40124737e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.14545382]
curr_Stock_Price:  99.90121444856072
curr_Factors:  [99.90121445]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242868]
Stock Position:  -0.024286804351786723
Bond Position:  [2.28082743]


portfolio before change:  [-0.16539486]
curr_Stock_Price:  100.7692472562882
curr_Factors:  [100.76924726]
mat_Sqrt:  [[0.15]]
grads:  [-0.01446992]
Stock Position:  -0.014469920399630179
Bond Position:  [1.29272812]


portfolio before change:  [-0.15476345]
curr_Stock_Price:  100.07920262700486
curr_Factors:  [100.07920263]
mat_Sqrt:  [[0.15]]
grads:  [-0.10122364]
Stock Position:  -0.10122363859922909
Bond Position:  [9.97561759]


portfolio before change:  [-0.38012356]
curr_Stock_Price:  102.35484867102937
curr_Factors:  [102.35484867]
mat_Sqrt:  [[0.15]]
grads:  [0.01484054]
Stock Position:  0.014840536580651608
Bond Position:  [-1.89912444]


portfolio before change:  [-0.39750976]
curr_Stock_Price:  101.24731487104067
curr_Factors:  [101.24731487]
mat_Sqrt:  [[0.15]]
grads:  [0.10416234]
Stock Position:  0.104162344471692
Bond Position:  [-10.94366745]


portfolio before change:  [-0.24468309]
curr_Stock_Price:  102.76705670337819
curr_Factors:  [102.7670567]
mat_Sqrt:  [[0.15]]
grads:  [0.11296858]
Stock Position:  0.11296857999937185
Bond Position:  [-11.85413156]


portfolio before change:  [-0.15466019]
curr_Stock_Price:  103.61642072418834
curr_Factors:  [103.61642072]
mat_Sqrt:  [[0.15]]
grads:  [0.13398716]
Stock Position:  0.13398716156896684
Bond Position:  [-14.0379303]


portfolio before change:  [-0.50921241]
curr_Stock_Price:  101.02265359625956
curr_Factors:  [101.0226536]
mat_Sqrt:  [[0.15]]
grads:  [0.08293906]
Stock Position:  0.08293906077254085
Bond Position:  [-8.88793641]


portfolio before change:  [-0.58336095]
curr_Stock_Price:  100.18223574072087
curr_Factors:  [100.18223574]
mat_Sqrt:  [[0.15]]
grads:  [0.05600832]
Stock Position:  0.05600831582544267
Bond Position:  [-6.19439925]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.58336095]
Stock Price:  100.24456082921613
PL:  [-0.82792178]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01413749]
 [-0.01214661]
 [-0.00999947]
 [ 0.00384582]
 [ 0.01059088]
 [ 0.01705461]
 [ 0.01927028]
 [ 0.0059869 ]
 [ 0.00644627]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.24373294]
curr_Stock_Price:  101.02919986604097
curr_Factors:  [101.02919987]
mat_Sqrt:  [[0.15]]
grads:  [0.09424995]
Stock Position:  0.09424995455698205
Bond Position:  [7.72173545]


portfolio before change:  [17.19103842]
curr_Stock_Price:  100.4291320813464
curr_Factors:  [100.42913208]
mat_Sqrt:  [[0.15]]
grads:  [-0.08097738]
Stock Position:  -0.08097737849130826
Bond Position:  [25.32352626]


portfolio before change:  [17.28320449]
curr_Stock_Price:  99.44736232285975
curr_Factors:  [99.44736232]
mat_Sqrt:  [[0.15]]
grads:  [-0.06666315]
Stock Position:  -0.0666631463488897
Bond Position:  [23.91267855]


portfolio before change:  [17.28763321]
curr_Stock_Price:  99.56032736550371
curr_Factors:  [99.56032737]
mat_Sqrt:  [[0.15]]
grads:  [0.02563882]
Stock Position:  0.025638823693883556
Bond Position:  [14.73502353]


portfolio before change:  [17.30354332]
curr_Stock_Price:  99.89344530220195
curr_Factors:  [99.8934453]
mat_Sqrt:  [[0.15]]
grads:  [0.07060586]
Stock Position:  0.07060586191957054
Bond Position:  [10.25048051]


portfolio before change:  [17.49716283]
curr_Stock_Price:  102.56309602636951
curr_Factors:  [102.56309603]
mat_Sqrt:  [[0.15]]
grads:  [0.11369743]
Stock Position:  0.11369743178988853
Bond Position:  [5.83600221]


portfolio before change:  [17.6027649]
curr_Stock_Price:  103.46622409581525
curr_Factors:  [103.4662241]
mat_Sqrt:  [[0.15]]
grads:  [0.12846853]
Stock Position:  0.12846853231806396
Bond Position:  [4.31061095]


portfolio before change:  [17.6672282]
curr_Stock_Price:  103.9512257554155
curr_Factors:  [103.95122576]
mat_Sqrt:  [[0.15]]
grads:  [0.03991265]
Stock Position:  0.03991265316348163
Bond Position:  [13.51825898]


portfolio before change:  [17.70671149]
curr_Stock_Price:  104.77107789520406
curr_Factors:  [104.7710779]
mat_Sqrt:  [[0.15]]
grads:  [0.04297512]
Stock Position:  0.0429751197357728
Bond Position:  [13.20416187]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.70671149]
Stock Price:  105.56865916961783
PL:  [12.13805232]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.66310961e-03]
 [ 3.34875872e-03]
 [ 6.74549998e-02]
 [ 3.20158539e-03]
 [ 7.32116319e-03]
 [ 1.56695380e-02]
 [ 4.16809715e-02]
 [ 1.15404423e-03]
 [ 6.40103832e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.32485672]
curr_Stock_Price:  100.25605740922614
curr_Factors:  [100.25605741]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310874]
Stock Position:  -0.031087397372601192
Bond Position:  [8.44155661]


portfolio before change:  [5.29255738]
curr_Stock_Price:  101.43084766387919
curr_Factors:  [101.43084766]
mat_Sqrt:  [[0.15]]
grads:  [0.02232506]
Stock Position:  0.022325058162641125
Bond Position:  [3.02810781]


portfolio before change:  [5.34368358]
curr_Stock_Price:  103.65309358546497
curr_Factors:  [103.65309359]
mat_Sqrt:  [[0.15]]
grads:  [0.4497]
Stock Position:  0.4496999986030853
Bond Position:  [-41.26911246]


portfolio before change:  [5.07779294]
curr_Stock_Price:  103.10772794464745
curr_Factors:  [103.10772794]
mat_Sqrt:  [[0.15]]
grads:  [0.0213439]
Stock Position:  0.021343902622186744
Bond Position:  [2.87707163]


portfolio before change:  [5.10487187]
curr_Stock_Price:  104.30900970869781
curr_Factors:  [104.30900971]
mat_Sqrt:  [[0.15]]
grads:  [0.04880775]
Stock Position:  0.04880775459684416
Bond Position:  [0.01378333]


portfolio before change:  [5.19341426]
curr_Stock_Price:  106.12297336994247
curr_Factors:  [106.12297337]
mat_Sqrt:  [[0.15]]
grads:  [0.10446359]
Stock Position:  0.10446358639720084
Bond Position:  [-5.89257214]


portfolio before change:  [5.32174991]
curr_Stock_Price:  107.3797048090854
curr_Factors:  [107.37970481]
mat_Sqrt:  [[0.15]]
grads:  [0.27787314]
Stock Position:  0.27787314327697815
Bond Position:  [-24.51618619]


portfolio before change:  [4.99457454]
curr_Stock_Price:  106.24640271281694
curr_Factors:  [106.24640271]
mat_Sqrt:  [[0.15]]
grads:  [0.00769363]
Stock Position:  0.007693628223095862
Bond Position:  [4.17715421]


portfolio before change:  [4.98618017]
curr_Stock_Price:  104.88378638061116
curr_Factors:  [104.88378638]
mat_Sqrt:  [[0.15]]
grads:  [0.04267359]
Stock Position:  0.042673588824007694
Bond Position:  [0.5104126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.98618017]
Stock Price:  104.8919967549167
PL:  [0.09418342]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.00423837e-02]
 [ 2.54578265e-03]
 [-2.14018352e-02]
 [ 1.21262950e-03]
 [ 8.02113752e-03]
 [ 1.81293493e-02]
 [-2.55370043e-02]
 [ 7.10263074e-05]
 [ 8.52475651e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.41500318]
curr_Stock_Price:  100.84570848315188
curr_Factors:  [100.84570848]
mat_Sqrt:  [[0.15]]
grads:  [0.06694922]
Stock Position:  0.06694922480918443
Bond Position:  [7.66346117]


portfolio before change:  [14.44345016]
curr_Stock_Price:  101.21336464820554
curr_Factors:  [101.21336465]
mat_Sqrt:  [[0.15]]
grads:  [0.01697188]
Stock Position:  0.01697188432425645
Bond Position:  [12.72566864]


portfolio before change:  [14.38629824]
curr_Stock_Price:  97.47091954343142
curr_Factors:  [97.47091954]
mat_Sqrt:  [[0.15]]
grads:  [-0.1426789]
Stock Position:  -0.14267890114492324
Bond Position:  [28.29334193]


portfolio before change:  [14.28678094]
curr_Stock_Price:  98.2675861205756
curr_Factors:  [98.26758612]
mat_Sqrt:  [[0.15]]
grads:  [0.0080842]
Stock Position:  0.008084196660245487
Bond Position:  [13.49236645]


portfolio before change:  [14.29820447]
curr_Stock_Price:  98.84595698229103
curr_Factors:  [98.84595698]
mat_Sqrt:  [[0.15]]
grads:  [0.05347425]
Stock Position:  0.05347425016295423
Bond Position:  [9.01249104]


portfolio before change:  [14.39752888]
curr_Stock_Price:  100.6190915180734
curr_Factors:  [100.61909152]
mat_Sqrt:  [[0.15]]
grads:  [0.12086233]
Stock Position:  0.12086232879715572
Bond Position:  [2.23647116]


portfolio before change:  [14.01378828]
curr_Stock_Price:  97.43481463824781
curr_Factors:  [97.43481464]
mat_Sqrt:  [[0.15]]
grads:  [-0.1702467]
Stock Position:  -0.17024669561544384
Bond Position:  [30.60174351]


portfolio before change:  [14.14406374]
curr_Stock_Price:  96.75949603924623
curr_Factors:  [96.75949604]
mat_Sqrt:  [[0.15]]
grads:  [0.00047351]
Stock Position:  0.00047350871609920205
Bond Position:  [14.09824727]


portfolio before change:  [14.15102832]
curr_Stock_Price:  96.57723828102478
curr_Factors:  [96.57723828]
mat_Sqrt:  [[0.15]]
grads:  [0.05683171]
Stock Position:  0.05683171006346429
Bond Position:  [8.66237872]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.15102832]
Stock Price:  95.17886673326358
PL:  [14.15102832]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.52060110e-03]
 [ 2.96113827e-03]
 [-1.34452966e-02]
 [ 1.52824883e-03]
 [ 1.54518588e-02]
 [ 1.78664246e-02]
 [-8.87648790e-03]
 [ 1.24933451e-02]
 [ 8.15112680e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.02380198]
curr_Stock_Price:  99.77937152649842
curr_Factors:  [99.77937153]
mat_Sqrt:  [[0.15]]
grads:  [-0.03013734]
Stock Position:  -0.030137340688583248
Bond Position:  [0.98328294]


portfolio before change:  [-2.07775369]
curr_Stock_Price:  101.58588406198932
curr_Factors:  [101.58588406]
mat_Sqrt:  [[0.15]]
grads:  [0.01974092]
Stock Position:  0.019740921830843514
Bond Position:  [-4.08315269]


portfolio before change:  [-2.14338027]
curr_Stock_Price:  98.36493583666706
curr_Factors:  [98.36493584]
mat_Sqrt:  [[0.15]]
grads:  [-0.08963531]
Stock Position:  -0.0896353106739088
Bond Position:  [6.67359131]


portfolio before change:  [-2.14817819]
curr_Stock_Price:  98.45569865108466
curr_Factors:  [98.45569865]
mat_Sqrt:  [[0.15]]
grads:  [0.01018833]
Stock Position:  0.01018832554207837
Bond Position:  [-3.1512769]


portfolio before change:  [-2.12908764]
curr_Stock_Price:  100.48415584888959
curr_Factors:  [100.48415585]
mat_Sqrt:  [[0.15]]
grads:  [0.10301239]
Stock Position:  0.10301239199889752
Bond Position:  [-12.48020089]


portfolio before change:  [-2.05146783]
curr_Stock_Price:  101.29824700054154
curr_Factors:  [101.298247]
mat_Sqrt:  [[0.15]]
grads:  [0.1191095]
Stock Position:  0.11910949725231393
Bond Position:  [-14.1170511]


portfolio before change:  [-2.29753482]
curr_Stock_Price:  99.29163365607363
curr_Factors:  [99.29163366]
mat_Sqrt:  [[0.15]]
grads:  [-0.05917659]
Stock Position:  -0.05917658600446155
Bond Position:  [3.57820508]


portfolio before change:  [-2.41594463]
curr_Stock_Price:  101.32283152941919
curr_Factors:  [101.32283153]
mat_Sqrt:  [[0.15]]
grads:  [0.08328897]
Stock Position:  0.08328896757329679
Bond Position:  [-10.85501866]


portfolio before change:  [-2.46342103]
curr_Stock_Price:  100.81799238600289
curr_Factors:  [100.81799239]
mat_Sqrt:  [[0.15]]
grads:  [0.05434085]
Stock Position:  0.054340845303823125
Bond Position:  [-7.94195595]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.46342103]
Stock Price:  100.18808826811879
PL:  [-2.65150929]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-5.01966823e-03]
 [ 1.50617796e-03]
 [ 8.29839193e-02]
 [ 1.17464471e-02]
 [-4.07676232e-03]
 [ 1.53798037e-02]
 [ 4.25898799e-02]
 [-1.03103025e-02]
 [ 4.56061767e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.3169809]
curr_Stock_Price:  100.12581240890428
curr_Factors:  [100.12581241]
mat_Sqrt:  [[0.15]]
grads:  [-0.03346445]
Stock Position:  -0.0334644548443486
Bond Position:  [6.66763663]


portfolio before change:  [3.22379192]
curr_Stock_Price:  103.0101753061996
curr_Factors:  [103.01017531]
mat_Sqrt:  [[0.15]]
grads:  [0.01004119]
Stock Position:  0.010041186397848866
Bond Position:  [2.18944755]


portfolio before change:  [3.23854628]
curr_Stock_Price:  104.37050847803192
curr_Factors:  [104.37050848]
mat_Sqrt:  [[0.15]]
grads:  [0.55322613]
Stock Position:  0.5532261286162249
Bond Position:  [-54.50194607]


portfolio before change:  [4.22648672]
curr_Stock_Price:  106.20555958834366
curr_Factors:  [106.20555959]
mat_Sqrt:  [[0.15]]
grads:  [0.07830965]
Stock Position:  0.0783096473246038
Bond Position:  [-4.0904332]


portfolio before change:  [4.24384731]
curr_Stock_Price:  106.45337475476315
curr_Factors:  [106.45337475]
mat_Sqrt:  [[0.15]]
grads:  [-0.02717842]
Stock Position:  -0.027178415439537466
Bond Position:  [7.13708135]


portfolio before change:  [4.23715984]
curr_Stock_Price:  106.83076596562906
curr_Factors:  [106.83076597]
mat_Sqrt:  [[0.15]]
grads:  [0.10253202]
Stock Position:  0.10253202492724398
Bond Position:  [-6.71641491]


portfolio before change:  [4.30631194]
curr_Stock_Price:  107.53797077495875
curr_Factors:  [107.53797077]
mat_Sqrt:  [[0.15]]
grads:  [0.28393253]
Stock Position:  0.2839325326161414
Bond Position:  [-26.22721646]


portfolio before change:  [4.70089754]
curr_Stock_Price:  108.97388404541383
curr_Factors:  [108.97388405]
mat_Sqrt:  [[0.15]]
grads:  [-0.06873535]
Stock Position:  -0.06873534984956352
Bond Position:  [12.19125559]


portfolio before change:  [4.62811468]
curr_Stock_Price:  110.12147419241754
curr_Factors:  [110.12147419]
mat_Sqrt:  [[0.15]]
grads:  [0.03040412]
Stock Position:  0.030404117783295003
Bond Position:  [1.27996841]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.62811468]
Stock Price:  112.21463699811981
PL:  [-7.58652231]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.00449734]
 [-0.01797704]
 [-0.01114509]
 [ 0.00491133]
 [ 0.01620282]
 [ 0.0168303 ]
 [ 0.01528886]
 [ 0.01246481]
 [ 0.00849572]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.14579511]
curr_Stock_Price:  100.63364456768798
curr_Factors:  [100.63364457]
mat_Sqrt:  [[0.15]]
grads:  [0.02998227]
Stock Position:  0.029982271969293085
Bond Position:  [8.1285698]


portfolio before change:  [11.13776888]
curr_Stock_Price:  100.2303553660139
curr_Factors:  [100.23035537]
mat_Sqrt:  [[0.15]]
grads:  [-0.11984696]
Stock Position:  -0.11984695867643387
Bond Position:  [23.15007214]


portfolio before change:  [11.22137788]
curr_Stock_Price:  99.62932990114224
curr_Factors:  [99.6293299]
mat_Sqrt:  [[0.15]]
grads:  [-0.07430058]
Stock Position:  -0.07430057853870867
Bond Position:  [18.62389474]


portfolio before change:  [11.19170167]
curr_Stock_Price:  100.15409690681098
curr_Factors:  [100.15409691]
mat_Sqrt:  [[0.15]]
grads:  [0.03274223]
Stock Position:  0.03274222674797429
Bond Position:  [7.91243352]


portfolio before change:  [11.23839418]
curr_Stock_Price:  101.4593016057933
curr_Factors:  [101.45930161]
mat_Sqrt:  [[0.15]]
grads:  [0.1080188]
Stock Position:  0.1080188021179118
Bond Position:  [0.27888196]


portfolio before change:  [11.40580612]
curr_Stock_Price:  103.00785114636963
curr_Factors:  [103.00785115]
mat_Sqrt:  [[0.15]]
grads:  [0.11220198]
Stock Position:  0.11220197943932173
Bond Position:  [-0.15187867]


portfolio before change:  [11.37610629]
curr_Stock_Price:  102.74382838307272
curr_Factors:  [102.74382838]
mat_Sqrt:  [[0.15]]
grads:  [0.10192577]
Stock Position:  0.10192576531823093
Bond Position:  [0.90386295]


portfolio before change:  [11.21508685]
curr_Stock_Price:  101.15962166381416
curr_Factors:  [101.15962166]
mat_Sqrt:  [[0.15]]
grads:  [0.08309872]
Stock Position:  0.08309871960495166
Bond Position:  [2.80885182]


portfolio before change:  [10.87502944]
curr_Stock_Price:  97.05050678527826
curr_Factors:  [97.05050679]
mat_Sqrt:  [[0.15]]
grads:  [0.05663812]
Stock Position:  0.05663811686925174
Bond Position:  [5.3782715]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.87502944]
Stock Price:  96.73356256713262
PL:  [10.87502944]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.02736674]
 [-0.00559425]
 [-0.01269244]
 [ 0.00310976]
 [ 0.0166548 ]
 [ 0.01794965]
 [ 0.00903303]
 [ 0.00374773]
 [ 0.00849656]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.36733018]
curr_Stock_Price:  101.36155255447281
curr_Factors:  [101.36155255]
mat_Sqrt:  [[0.15]]
grads:  [0.18244493]
Stock Position:  0.18244493046143936
Bond Position:  [3.87442878]


portfolio before change:  [22.23990872]
curr_Stock_Price:  100.65252126634026
curr_Factors:  [100.65252127]
mat_Sqrt:  [[0.15]]
grads:  [-0.03729498]
Stock Position:  -0.037294979252120386
Bond Position:  [25.99374241]


portfolio before change:  [22.33212523]
curr_Stock_Price:  98.52847160602578
curr_Factors:  [98.52847161]
mat_Sqrt:  [[0.15]]
grads:  [-0.08461627]
Stock Position:  -0.0846162738256927
Bond Position:  [30.66923736]


portfolio before change:  [22.13063867]
curr_Stock_Price:  101.09092207865497
curr_Factors:  [101.09092208]
mat_Sqrt:  [[0.15]]
grads:  [0.02073175]
Stock Position:  0.020731751594471888
Bond Position:  [20.03484678]


portfolio before change:  [22.1334634]
curr_Stock_Price:  100.74386054203393
curr_Factors:  [100.74386054]
mat_Sqrt:  [[0.15]]
grads:  [0.111032]
Stock Position:  0.11103200171424947
Bond Position:  [10.94767091]


portfolio before change:  [22.17138072]
curr_Stock_Price:  101.03604762980491
curr_Factors:  [101.03604763]
mat_Sqrt:  [[0.15]]
grads:  [0.11966432]
Stock Position:  0.11966432338014192
Bond Position:  [10.08097045]


portfolio before change:  [22.24495531]
curr_Stock_Price:  101.60875670681673
curr_Factors:  [101.60875671]
mat_Sqrt:  [[0.15]]
grads:  [0.06022017]
Stock Position:  0.060220170310483656
Bond Position:  [16.12605868]


portfolio before change:  [22.08490377]
curr_Stock_Price:  98.81705769428422
curr_Factors:  [98.81705769]
mat_Sqrt:  [[0.15]]
grads:  [0.02498488]
Stock Position:  0.024984883435524557
Bond Position:  [19.6159711]


portfolio before change:  [22.08321924]
curr_Stock_Price:  98.35698062379718
curr_Factors:  [98.35698062]
mat_Sqrt:  [[0.15]]
grads:  [0.05664376]
Stock Position:  0.0566437619272603
Bond Position:  [16.51190984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.08321924]
Stock Price:  98.38845048428948
PL:  [22.08321924]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.03083160e-03]
 [-2.35940876e-02]
 [-1.42538862e-02]
 [ 1.40269554e-03]
 [ 5.38353299e-03]
 [ 1.85342164e-02]
 [-6.72560710e-03]
 [ 1.05686796e-02]
 [ 7.63399549e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.29510085]
curr_Stock_Price:  99.50230492727809
curr_Factors:  [99.50230493]
mat_Sqrt:  [[0.15]]
grads:  [-0.02020554]
Stock Position:  -0.020205544005238385
Bond Position:  [-4.28460265]


portfolio before change:  [-6.29778792]
curr_Stock_Price:  99.52923971745666
curr_Factors:  [99.52923972]
mat_Sqrt:  [[0.15]]
grads:  [-0.15729392]
Stock Position:  -0.15729391749139965
Bond Position:  [9.3575561]


portfolio before change:  [-6.08234257]
curr_Stock_Price:  98.1892934650499
curr_Factors:  [98.18929347]
mat_Sqrt:  [[0.15]]
grads:  [-0.09502591]
Stock Position:  -0.09502590833160421
Bond Position:  [3.24818423]


portfolio before change:  [-6.09892257]
curr_Stock_Price:  98.3808675338169
curr_Factors:  [98.38086753]
mat_Sqrt:  [[0.15]]
grads:  [0.0093513]
Stock Position:  0.00935130360272757
Bond Position:  [-7.01891193]


portfolio before change:  [-6.10472705]
curr_Stock_Price:  98.13553839285011
curr_Factors:  [98.13553839]
mat_Sqrt:  [[0.15]]
grads:  [0.03589022]
Stock Position:  0.03589021994237911
Bond Position:  [-9.62683311]


portfolio before change:  [-6.06894471]
curr_Stock_Price:  99.26668111516197
curr_Factors:  [99.26668112]
mat_Sqrt:  [[0.15]]
grads:  [0.12356144]
Stock Position:  0.12356144278488015
Bond Position:  [-18.33447905]


portfolio before change:  [-6.05509706]
curr_Stock_Price:  99.45296237728151
curr_Factors:  [99.45296238]
mat_Sqrt:  [[0.15]]
grads:  [-0.04483738]
Stock Position:  -0.04483738068025832
Bond Position:  [-1.59588673]


portfolio before change:  [-6.09890405]
curr_Stock_Price:  100.41218088720775
curr_Factors:  [100.41218089]
mat_Sqrt:  [[0.15]]
grads:  [0.07045786]
Stock Position:  0.07045786414515254
Bond Position:  [-13.17373185]


portfolio before change:  [-6.0190819]
curr_Stock_Price:  101.63859703097252
curr_Factors:  [101.63859703]
mat_Sqrt:  [[0.15]]
grads:  [0.0508933]
Stock Position:  0.050893303254146614
Bond Position:  [-11.19180584]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.0190819]
Stock Price:  102.33078654866222
PL:  [-8.34986845]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.87304172e-02]
 [ 1.38747682e-03]
 [ 7.83591250e-02]
 [ 1.46120825e-02]
 [-1.37877649e-02]
 [ 1.53256015e-02]
 [ 4.71180836e-02]
 [-1.06780449e-02]
 [ 4.80632122e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.71757346]
curr_Stock_Price:  98.69649565370278
curr_Factors:  [98.69649565]
mat_Sqrt:  [[0.15]]
grads:  [0.12486945]
Stock Position:  0.12486944769894602
Bond Position:  [-31.04175036]


portfolio before change:  [-18.43841167]
curr_Stock_Price:  101.0564528070014
curr_Factors:  [101.05645281]
mat_Sqrt:  [[0.15]]
grads:  [0.00924985]
Stock Position:  0.009249845490064516
Bond Position:  [-19.37316824]


portfolio before change:  [-18.41942249]
curr_Stock_Price:  104.15684929303616
curr_Factors:  [104.15684929]
mat_Sqrt:  [[0.15]]
grads:  [0.52239417]
Stock Position:  0.5223941668134393
Bond Position:  [-72.83035299]


portfolio before change:  [-16.84333302]
curr_Stock_Price:  107.24362523508549
curr_Factors:  [107.24362524]
mat_Sqrt:  [[0.15]]
grads:  [0.09741388]
Stock Position:  0.09741388332556965
Bond Position:  [-27.29035102]


portfolio before change:  [-16.75598846]
curr_Stock_Price:  108.28036814026552
curr_Factors:  [108.28036814]
mat_Sqrt:  [[0.15]]
grads:  [-0.09191843]
Stock Position:  -0.0919184326772086
Bond Position:  [-6.80302673]


portfolio before change:  [-16.63831665]
curr_Stock_Price:  106.96317669807549
curr_Factors:  [106.9631767]
mat_Sqrt:  [[0.15]]
grads:  [0.10217068]
Stock Position:  0.1021706768846664
Bond Position:  [-27.56681681]


portfolio before change:  [-16.51281637]
curr_Stock_Price:  108.32645565285176
curr_Factors:  [108.32645565]
mat_Sqrt:  [[0.15]]
grads:  [0.31412056]
Stock Position:  0.314120557166028
Bond Position:  [-50.54038297]


portfolio before change:  [-16.30003629]
curr_Stock_Price:  109.08430669451948
curr_Factors:  [109.08430669]
mat_Sqrt:  [[0.15]]
grads:  [-0.07118697]
Stock Position:  -0.07118696590844673
Bond Position:  [-8.53465546]


portfolio before change:  [-16.32835983]
curr_Stock_Price:  109.42222182302248
curr_Factors:  [109.42222182]
mat_Sqrt:  [[0.15]]
grads:  [0.03204214]
Stock Position:  0.03204214146945347
Bond Position:  [-19.83448215]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.32835983]
Stock Price:  109.13750416005801
PL:  [-25.46586399]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 3.82056225e-02]
 [-9.79259954e-03]
 [-1.29426079e-02]
 [-4.59536405e-04]
 [ 7.83953389e-03]
 [ 1.83299084e-02]
 [-4.32769630e-03]
 [ 1.20572513e-02]
 [ 7.50510774e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.56515589]
curr_Stock_Price:  101.63385316547406
curr_Factors:  [101.63385317]
mat_Sqrt:  [[0.15]]
grads:  [0.25470415]
Stock Position:  0.2547041498447394
Bond Position:  [0.67859172]


portfolio before change:  [26.2790891]
curr_Stock_Price:  100.50938709902094
curr_Factors:  [100.5093871]
mat_Sqrt:  [[0.15]]
grads:  [-0.065284]
Stock Position:  -0.06528399690211396
Bond Position:  [32.84074361]


portfolio before change:  [26.42838328]
curr_Stock_Price:  98.47413019398405
curr_Factors:  [98.47413019]
mat_Sqrt:  [[0.15]]
grads:  [-0.08628405]
Stock Position:  -0.0862840529940729
Bond Position:  [34.92513035]


portfolio before change:  [26.529686]
curr_Stock_Price:  97.50250468939716
curr_Factors:  [97.50250469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00306358]
Stock Position:  -0.0030635760349499545
Bond Position:  [26.82839233]


portfolio before change:  [26.53919131]
curr_Stock_Price:  98.77951972516377
curr_Factors:  [98.77951973]
mat_Sqrt:  [[0.15]]
grads:  [0.05226356]
Stock Position:  0.05226355923664511
Bond Position:  [21.37662203]


portfolio before change:  [26.61211686]
curr_Stock_Price:  99.97030276013189
curr_Factors:  [99.97030276]
mat_Sqrt:  [[0.15]]
grads:  [0.12219939]
Stock Position:  0.12219938962767601
Bond Position:  [14.39580688]


portfolio before change:  [26.59314651]
curr_Stock_Price:  99.75614412939797
curr_Factors:  [99.75614413]
mat_Sqrt:  [[0.15]]
grads:  [-0.02885131]
Stock Position:  -0.028851308679990383
Bond Position:  [29.47124181]


portfolio before change:  [26.5768592]
curr_Stock_Price:  100.83154101906965
curr_Factors:  [100.83154102]
mat_Sqrt:  [[0.15]]
grads:  [0.08038168]
Stock Position:  0.08038167534749528
Bond Position:  [18.47185101]


portfolio before change:  [26.66801508]
curr_Stock_Price:  101.85064947658768
curr_Factors:  [101.85064948]
mat_Sqrt:  [[0.15]]
grads:  [0.05003405]
Stock Position:  0.050034051571047955
Bond Position:  [21.57201444]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.66801508]
Stock Price:  101.51442282268896
PL:  [25.15359226]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [1.19938688e-02]
 [2.70481646e-03]
 [4.70882143e-02]
 [6.43440397e-03]
 [2.29604202e-03]
 [1.65268133e-02]
 [1.99815305e-02]
 [3.28278359e-03]
 [6.54098322e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.78620529]
curr_Stock_Price:  100.93465433241174
curr_Factors:  [100.93465433]
mat_Sqrt:  [[0.15]]
grads:  [0.07995913]
Stock Position:  0.07995912537875655
Bond Position:  [7.71555861]


portfolio before change:  [15.85857361]
curr_Stock_Price:  101.79146188741166
curr_Factors:  [101.79146189]
mat_Sqrt:  [[0.15]]
grads:  [0.01803211]
Stock Position:  0.01803210970003798
Bond Position:  [14.02305881]


portfolio before change:  [15.88218931]
curr_Stock_Price:  102.71217588753689
curr_Factors:  [102.71217589]
mat_Sqrt:  [[0.15]]
grads:  [0.31392143]
Stock Position:  0.31392142899627246
Bond Position:  [-16.36136372]


portfolio before change:  [16.36610027]
curr_Stock_Price:  104.27974547289239
curr_Factors:  [104.27974547]
mat_Sqrt:  [[0.15]]
grads:  [0.04289603]
Stock Position:  0.042896026488123344
Bond Position:  [11.89291355]


portfolio before change:  [16.41385779]
curr_Stock_Price:  105.25441807998722
curr_Factors:  [105.25441808]
mat_Sqrt:  [[0.15]]
grads:  [0.01530695]
Stock Position:  0.015306946799948686
Bond Position:  [14.80273402]


portfolio before change:  [16.39986325]
curr_Stock_Price:  103.8565062596176
curr_Factors:  [103.85650626]
mat_Sqrt:  [[0.15]]
grads:  [0.11017876]
Stock Position:  0.11017875521278478
Bond Position:  [4.95708267]


portfolio before change:  [16.37356025]
curr_Stock_Price:  103.59527479388115
curr_Factors:  [103.59527479]
mat_Sqrt:  [[0.15]]
grads:  [0.1332102]
Stock Position:  0.1332102030526881
Bond Position:  [2.57361266]


portfolio before change:  [16.63882417]
curr_Stock_Price:  105.5769306808291
curr_Factors:  [105.57693068]
mat_Sqrt:  [[0.15]]
grads:  [0.02188522]
Stock Position:  0.021885223906496897
Bond Position:  [14.3282494]


portfolio before change:  [16.62319124]
curr_Stock_Price:  104.53518480284811
curr_Factors:  [104.5351848]
mat_Sqrt:  [[0.15]]
grads:  [0.04360655]
Stock Position:  0.04360655479495123
Bond Position:  [12.06477198]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.62319124]
Stock Price:  104.763046656321
PL:  [11.86014458]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.18578653e-03]
 [-1.79060118e-02]
 [-2.08484577e-02]
 [ 1.64596306e-03]
 [ 1.14437487e-02]
 [ 1.85710589e-02]
 [-5.93333588e-03]
 [ 2.73666913e-03]
 [ 8.48448175e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.81066087]
curr_Stock_Price:  99.53372912443089
curr_Factors:  [99.53372912]
mat_Sqrt:  [[0.15]]
grads:  [-0.02123858]
Stock Position:  -0.0212385768544048
Bond Position:  [-3.69670611]


portfolio before change:  [-5.78715675]
curr_Stock_Price:  98.3400084050487
curr_Factors:  [98.34000841]
mat_Sqrt:  [[0.15]]
grads:  [-0.11937341]
Stock Position:  -0.11937341184763861
Bond Position:  [5.95202557]


portfolio before change:  [-5.68604117]
curr_Stock_Price:  97.51789214186769
curr_Factors:  [97.51789214]
mat_Sqrt:  [[0.15]]
grads:  [-0.13898972]
Stock Position:  -0.13898971830233378
Bond Position:  [7.86794319]


portfolio before change:  [-5.82220305]
curr_Stock_Price:  98.5258576043214
curr_Factors:  [98.5258576]
mat_Sqrt:  [[0.15]]
grads:  [0.01097309]
Stock Position:  0.01097308708574106
Bond Position:  [-6.90333587]


portfolio before change:  [-5.80964208]
curr_Stock_Price:  99.98520133397503
curr_Factors:  [99.98520133]
mat_Sqrt:  [[0.15]]
grads:  [0.07629166]
Stock Position:  0.07629165791442316
Bond Position:  [-13.43767885]


portfolio before change:  [-5.90376341]
curr_Stock_Price:  98.83958698771703
curr_Factors:  [98.83958699]
mat_Sqrt:  [[0.15]]
grads:  [0.12380706]
Stock Position:  0.12380705943306275
Bond Position:  [-18.14080204]


portfolio before change:  [-5.82434373]
curr_Stock_Price:  99.5543471754363
curr_Factors:  [99.55434718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03955557]
Stock Position:  -0.039555572509538325
Bond Position:  [-1.88641453]


portfolio before change:  [-5.76955713]
curr_Stock_Price:  98.14544220168199
curr_Factors:  [98.1454422]
mat_Sqrt:  [[0.15]]
grads:  [0.01824446]
Stock Position:  0.018244460891537324
Bond Position:  [-7.56016781]


portfolio before change:  [-5.76607036]
curr_Stock_Price:  98.54379850990347
curr_Factors:  [98.54379851]
mat_Sqrt:  [[0.15]]
grads:  [0.05656321]
Stock Position:  0.05656321164061057
Bond Position:  [-11.34002409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.76607036]
Stock Price:  100.4697077619408
PL:  [-6.23577812]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.35128974e-03]
 [-1.94489129e-02]
 [-1.41427927e-02]
 [-3.39882670e-03]
 [ 2.69696506e-04]
 [ 1.82762225e-02]
 [-1.37362713e-02]
 [-1.56794430e-03]
 [ 8.49779419e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.54054222]
curr_Stock_Price:  100.52951653287072
curr_Factors:  [100.52951653]
mat_Sqrt:  [[0.15]]
grads:  [0.0090086]
Stock Position:  0.009008598243054566
Bond Position:  [8.63491219]


portfolio before change:  [9.53138686]
curr_Stock_Price:  99.0338461078294
curr_Factors:  [99.03384611]
mat_Sqrt:  [[0.15]]
grads:  [-0.12965942]
Stock Position:  -0.12965941937643158
Bond Position:  [22.37205785]


portfolio before change:  [9.64895098]
curr_Stock_Price:  98.2134252887403
curr_Factors:  [98.21342529]
mat_Sqrt:  [[0.15]]
grads:  [-0.09428528]
Stock Position:  -0.09428528435195897
Bond Position:  [18.90903171]


portfolio before change:  [9.84803725]
curr_Stock_Price:  96.2021952703622
curr_Factors:  [96.20219527]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265884]
Stock Position:  -0.02265884467677056
Bond Position:  [12.02786785]


portfolio before change:  [9.83941106]
curr_Stock_Price:  96.84837243939522
curr_Factors:  [96.84837244]
mat_Sqrt:  [[0.15]]
grads:  [0.00179798]
Stock Position:  0.0017979767043702541
Bond Position:  [9.66527994]


portfolio before change:  [9.84578799]
curr_Stock_Price:  97.7066055668154
curr_Factors:  [97.70660557]
mat_Sqrt:  [[0.15]]
grads:  [0.12184148]
Stock Position:  0.12184148340760875
Bond Position:  [-2.05892977]


portfolio before change:  [9.9764867]
curr_Stock_Price:  98.78775152289472
curr_Factors:  [98.78775152]
mat_Sqrt:  [[0.15]]
grads:  [-0.09157514]
Stock Position:  -0.09157514220074851
Bond Position:  [19.02298909]


portfolio before change:  [10.2245653]
curr_Stock_Price:  96.18262603697572
curr_Factors:  [96.18262604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01045296]
Stock Position:  -0.010452962020060803
Bond Position:  [11.22995864]


portfolio before change:  [10.26531647]
curr_Stock_Price:  92.8213983449076
curr_Factors:  [92.82139834]
mat_Sqrt:  [[0.15]]
grads:  [0.05665196]
Stock Position:  0.05665196126590717
Bond Position:  [5.00680221]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.26531647]
Stock Price:  89.77045540970016
PL:  [10.26531647]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00280616]
 [-0.01763119]
 [-0.0399106 ]
 [-0.00895758]
 [-0.01340375]
 [ 0.01742942]
 [-0.03282117]
 [-0.00628304]
 [ 0.00854045]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.9975009]
curr_Stock_Price:  99.4567423011141
curr_Factors:  [99.4567423]
mat_Sqrt:  [[0.15]]
grads:  [-0.01870773]
Stock Position:  -0.018707727233887077
Bond Position:  [-5.13689129]


portfolio before change:  [-6.97617362]
curr_Stock_Price:  98.17938962242805
curr_Factors:  [98.17938962]
mat_Sqrt:  [[0.15]]
grads:  [-0.11754125]
Stock Position:  -0.11754125072366904
Bond Position:  [4.56395463]


portfolio before change:  [-6.70594895]
curr_Stock_Price:  95.89983141626655
curr_Factors:  [95.89983142]
mat_Sqrt:  [[0.15]]
grads:  [-0.26607066]
Stock Position:  -0.26607065625071163
Bond Position:  [18.81018213]


portfolio before change:  [-6.31663066]
curr_Stock_Price:  94.4719744131991
curr_Factors:  [94.47197441]
mat_Sqrt:  [[0.15]]
grads:  [-0.05971722]
Stock Position:  -0.05971722367607115
Bond Position:  [-0.67502663]


portfolio before change:  [-6.31779836]
curr_Stock_Price:  94.4858749249837
curr_Factors:  [94.48587492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08935832]
Stock Position:  -0.08935832227540445
Bond Position:  [2.12530091]


portfolio before change:  [-6.46227432]
curr_Stock_Price:  96.11458589445529
curr_Factors:  [96.11458589]
mat_Sqrt:  [[0.15]]
grads:  [0.11619615]
Stock Position:  0.11619615412100553
Bond Position:  [-17.63041955]


portfolio before change:  [-6.48136737]
curr_Stock_Price:  96.02615233950618
curr_Factors:  [96.02615234]
mat_Sqrt:  [[0.15]]
grads:  [-0.21880782]
Stock Position:  -0.2188078150723694
Bond Position:  [14.52990521]


portfolio before change:  [-6.14520984]
curr_Stock_Price:  94.52304899086703
curr_Factors:  [94.52304899]
mat_Sqrt:  [[0.15]]
grads:  [-0.04188694]
Stock Position:  -0.041886941872261885
Bond Position:  [-2.18592838]


portfolio before change:  [-6.11175197]
curr_Stock_Price:  93.69818315088982
curr_Factors:  [93.69818315]
mat_Sqrt:  [[0.15]]
grads:  [0.05693634]
Stock Position:  0.056936340350303316
Bond Position:  [-11.44658362]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.11175197]
Stock Price:  93.19143797240741
PL:  [-6.11175197]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.73325673e-03]
 [-2.17026398e-02]
 [ 3.72243524e-02]
 [ 3.18407335e-03]
 [ 1.68333832e-02]
 [ 1.82751167e-02]
 [ 1.16561009e-03]
 [ 1.09352420e-02]
 [ 8.48897454e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.65939244]
curr_Stock_Price:  100.01828951905023
curr_Factors:  [100.01828952]
mat_Sqrt:  [[0.15]]
grads:  [-0.01822171]
Stock Position:  -0.018221711533914824
Bond Position:  [3.48189686]


portfolio before change:  [1.65939399]
curr_Stock_Price:  100.11377090910679
curr_Factors:  [100.11377091]
mat_Sqrt:  [[0.15]]
grads:  [-0.14468427]
Stock Position:  -0.14468426531810324
Bond Position:  [16.14428138]


portfolio before change:  [1.35745202]
curr_Stock_Price:  102.25647892311201
curr_Factors:  [102.25647892]
mat_Sqrt:  [[0.15]]
grads:  [0.24816235]
Stock Position:  0.24816234917449462
Bond Position:  [-24.01875601]


portfolio before change:  [0.6400708]
curr_Stock_Price:  99.41411044989836
curr_Factors:  [99.41411045]
mat_Sqrt:  [[0.15]]
grads:  [0.02122716]
Stock Position:  0.021227155680759908
Bond Position:  [-1.470208]


portfolio before change:  [0.66839547]
curr_Stock_Price:  100.78310977890455
curr_Factors:  [100.78310978]
mat_Sqrt:  [[0.15]]
grads:  [0.11222255]
Stock Position:  0.11222255489715029
Bond Position:  [-10.6417426]


portfolio before change:  [0.59283856]
curr_Stock_Price:  100.15725773759381
curr_Factors:  [100.15725774]
mat_Sqrt:  [[0.15]]
grads:  [0.12183411]
Stock Position:  0.12183411166426703
Bond Position:  [-11.60973197]


portfolio before change:  [0.62456885]
curr_Stock_Price:  100.46535384624768
curr_Factors:  [100.46535385]
mat_Sqrt:  [[0.15]]
grads:  [0.00777073]
Stock Position:  0.00777073395971925
Bond Position:  [-0.15612068]


portfolio before change:  [0.62489164]
curr_Stock_Price:  100.51694044269622
curr_Factors:  [100.51694044]
mat_Sqrt:  [[0.15]]
grads:  [0.07290161]
Stock Position:  0.07290161306730303
Bond Position:  [-6.70295546]


portfolio before change:  [0.45048071]
curr_Stock_Price:  98.17050928055818
curr_Factors:  [98.17050928]
mat_Sqrt:  [[0.15]]
grads:  [0.05659316]
Stock Position:  0.05659316361695869
Bond Position:  [-5.10529899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.45048071]
Stock Price:  97.27741258476061
PL:  [0.45048071]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 7.84128170e-03]
 [ 9.50921271e-04]
 [ 1.58191884e-01]
 [ 1.63112626e-02]
 [-1.62689672e-02]
 [ 1.52222903e-02]
 [ 5.06020512e-02]
 [-1.49033413e-02]
 [ 4.78705634e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.89064778]
curr_Stock_Price:  100.74682803065795
curr_Factors:  [100.74682803]
mat_Sqrt:  [[0.15]]
grads:  [0.05227521]
Stock Position:  0.05227521131236411
Bond Position:  [7.62408606]


portfolio before change:  [13.04229003]
curr_Stock_Price:  103.57473149253302
curr_Factors:  [103.57473149]
mat_Sqrt:  [[0.15]]
grads:  [0.00633948]
Stock Position:  0.006339475138073663
Bond Position:  [12.38568059]


portfolio before change:  [13.0756347]
curr_Stock_Price:  107.85746434673771
curr_Factors:  [107.85746435]
mat_Sqrt:  [[0.15]]
grads:  [1.05461256]
Stock Position:  1.0546125596227671
Bond Position:  [-100.67220185]


portfolio before change:  [13.02505061]
curr_Stock_Price:  107.8572411367097
curr_Factors:  [107.85724114]
mat_Sqrt:  [[0.15]]
grads:  [0.10874175]
Stock Position:  0.1087417508863506
Bond Position:  [1.29646536]


portfolio before change:  [13.12247172]
curr_Stock_Price:  108.74717268968699
curr_Factors:  [108.74717269]
mat_Sqrt:  [[0.15]]
grads:  [-0.10845978]
Stock Position:  -0.10845978133012565
Bond Position:  [24.91716629]


portfolio before change:  [13.30105223]
curr_Stock_Price:  107.21555599674481
curr_Factors:  [107.215556]
mat_Sqrt:  [[0.15]]
grads:  [0.10148194]
Stock Position:  0.10148193539161425
Bond Position:  [2.4206101]


portfolio before change:  [13.47699577]
curr_Stock_Price:  108.93736917397334
curr_Factors:  [108.93736917]
mat_Sqrt:  [[0.15]]
grads:  [0.33734701]
Stock Position:  0.3373470082694096
Bond Position:  [-23.27269981]


portfolio before change:  [13.9434828]
curr_Stock_Price:  110.35468214582605
curr_Factors:  [110.35468215]
mat_Sqrt:  [[0.15]]
grads:  [-0.09935561]
Stock Position:  -0.09935560835211776
Bond Position:  [24.90783938]


portfolio before change:  [14.0431377]
curr_Stock_Price:  109.47704809524191
curr_Factors:  [109.4770481]
mat_Sqrt:  [[0.15]]
grads:  [0.03191371]
Stock Position:  0.031913708965754
Bond Position:  [10.54931905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.0431377]
Stock Price:  111.28175556013282
PL:  [2.76138214]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.21405147e-02]
 [-1.73855582e-02]
 [-3.83525169e-02]
 [ 1.40152649e-03]
 [ 9.78534441e-03]
 [ 1.79468124e-02]
 [-3.68894415e-02]
 [-2.90721948e-03]
 [ 8.52109367e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-29.48682295]
curr_Stock_Price:  97.99792610281153
curr_Factors:  [97.9979261]
mat_Sqrt:  [[0.15]]
grads:  [0.08093676]
Stock Position:  0.08093676461285186
Bond Position:  [-37.41845803]


portfolio before change:  [-29.60960505]
curr_Stock_Price:  96.71212986167691
curr_Factors:  [96.71212986]
mat_Sqrt:  [[0.15]]
grads:  [-0.11590372]
Stock Position:  -0.11590372105437795
Bond Position:  [-18.40030933]


portfolio before change:  [-29.53998798]
curr_Stock_Price:  96.03208679429564
curr_Factors:  [96.03208679]
mat_Sqrt:  [[0.15]]
grads:  [-0.25568345]
Stock Position:  -0.25568344567033613
Bond Position:  [-4.98617313]


portfolio before change:  [-30.14284789]
curr_Stock_Price:  98.38017076730446
curr_Factors:  [98.38017077]
mat_Sqrt:  [[0.15]]
grads:  [0.00934351]
Stock Position:  0.00934350993508244
Bond Position:  [-31.062064]


portfolio before change:  [-30.1476762]
curr_Stock_Price:  99.52605765958256
curr_Factors:  [99.52605766]
mat_Sqrt:  [[0.15]]
grads:  [0.06523563]
Stock Position:  0.0652356293955698
Bond Position:  [-36.64032121]


portfolio before change:  [-30.32456817]
curr_Stock_Price:  97.09537331757082
curr_Factors:  [97.09537332]
mat_Sqrt:  [[0.15]]
grads:  [0.11964542]
Stock Position:  0.11964541606114319
Bond Position:  [-41.9415845]


portfolio before change:  [-30.64439745]
curr_Stock_Price:  94.5975488134791
curr_Factors:  [94.59754881]
mat_Sqrt:  [[0.15]]
grads:  [-0.24592961]
Stock Position:  -0.2459296099392799
Bond Position:  [-7.38005917]


portfolio before change:  [-30.92197807]
curr_Stock_Price:  95.7112401134044
curr_Factors:  [95.71124011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01938146]
Stock Position:  -0.019381463205887472
Bond Position:  [-29.06695419]


portfolio before change:  [-30.95642599]
curr_Stock_Price:  96.73855179485157
curr_Factors:  [96.73855179]
mat_Sqrt:  [[0.15]]
grads:  [0.05680729]
Stock Position:  0.056807291100077775
Bond Position:  [-36.45188106]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-30.95642599]
Stock Price:  98.47979946782995
PL:  [-30.95642599]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.0072157 ]
 [-0.01461277]
 [-0.03064921]
 [-0.00248603]
 [ 0.00694194]
 [ 0.01857103]
 [-0.01806005]
 [ 0.00752231]
 [ 0.00847118]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-34.1671539]
curr_Stock_Price:  97.69432679558055
curr_Factors:  [97.6943268]
mat_Sqrt:  [[0.15]]
grads:  [0.04810465]
Stock Position:  0.048104648436562696
Bond Position:  [-38.86670514]


portfolio before change:  [-34.20004318]
curr_Stock_Price:  97.41470575052612
curr_Factors:  [97.41470575]
mat_Sqrt:  [[0.15]]
grads:  [-0.09741844]
Stock Position:  -0.09741843733784951
Bond Position:  [-24.71005477]


portfolio before change:  [-34.141409]
curr_Stock_Price:  96.68597002629656
curr_Factors:  [96.68597003]
mat_Sqrt:  [[0.15]]
grads:  [-0.20432808]
Stock Position:  -0.20432808358989293
Bond Position:  [-14.38575004]


portfolio before change:  [-34.14857964]
curr_Stock_Price:  96.68585237057484
curr_Factors:  [96.68585237]
mat_Sqrt:  [[0.15]]
grads:  [-0.01657354]
Stock Position:  -0.016573536839734233
Bond Position:  [-32.5461531]


portfolio before change:  [-34.19411393]
curr_Stock_Price:  98.45114555093896
curr_Factors:  [98.45114555]
mat_Sqrt:  [[0.15]]
grads:  [0.04627957]
Stock Position:  0.04627957298617903
Bond Position:  [-38.75039091]


portfolio before change:  [-34.19496618]
curr_Stock_Price:  98.8514905865061
curr_Factors:  [98.85149059]
mat_Sqrt:  [[0.15]]
grads:  [0.12380687]
Stock Position:  0.1238068732810249
Bond Position:  [-46.43346015]


portfolio before change:  [-34.29173864]
curr_Stock_Price:  98.25742076812288
curr_Factors:  [98.25742077]
mat_Sqrt:  [[0.15]]
grads:  [-0.12040034]
Stock Position:  -0.12040033888305088
Bond Position:  [-22.46151188]


portfolio before change:  [-34.47309881]
curr_Stock_Price:  99.67042850763285
curr_Factors:  [99.67042851]
mat_Sqrt:  [[0.15]]
grads:  [0.05014874]
Stock Position:  0.05014874255901401
Bond Position:  [-39.47144547]


portfolio before change:  [-34.53850185]
curr_Stock_Price:  98.75988954726571
curr_Factors:  [98.75988955]
mat_Sqrt:  [[0.15]]
grads:  [0.05647454]
Stock Position:  0.05647454112922766
Bond Position:  [-40.1159213]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.53850185]
Stock Price:  99.47870787213768
PL:  [-34.53850185]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [4.68178627e-02]
 [9.72147425e-04]
 [7.60056943e-02]
 [2.78445289e-03]
 [1.15851743e-02]
 [1.73567957e-02]
 [9.17485250e-03]
 [1.12479881e-02]
 [8.42546124e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.29906731]
curr_Stock_Price:  101.8760610210801
curr_Factors:  [101.87606102]
mat_Sqrt:  [[0.15]]
grads:  [0.31211908]
Stock Position:  0.31211908490116375
Bond Position:  [-1.49839563]


portfolio before change:  [30.82176936]
curr_Stock_Price:  103.55314984065903
curr_Factors:  [103.55314984]
mat_Sqrt:  [[0.15]]
grads:  [0.00648098]
Stock Position:  0.0064809828315162575
Bond Position:  [30.15064317]


portfolio before change:  [30.84005637]
curr_Stock_Price:  104.04812400605304
curr_Factors:  [104.04812401]
mat_Sqrt:  [[0.15]]
grads:  [0.50670463]
Stock Position:  0.5067046288451734
Bond Position:  [-21.88160969]


portfolio before change:  [29.41672148]
curr_Stock_Price:  101.260718348769
curr_Factors:  [101.26071835]
mat_Sqrt:  [[0.15]]
grads:  [0.01856302]
Stock Position:  0.01856301928063591
Bond Position:  [27.53701681]


portfolio before change:  [29.4616122]
curr_Stock_Price:  102.93710383030088
curr_Factors:  [102.93710383]
mat_Sqrt:  [[0.15]]
grads:  [0.0772345]
Stock Position:  0.07723449519053216
Bond Position:  [21.51131695]


portfolio before change:  [29.39994365]
curr_Stock_Price:  101.99935060749088
curr_Factors:  [101.99935061]
mat_Sqrt:  [[0.15]]
grads:  [0.11571197]
Stock Position:  0.11571197137649605
Bond Position:  [17.59739772]


portfolio before change:  [29.36652582]
curr_Stock_Price:  101.6344900662891
curr_Factors:  [101.63449007]
mat_Sqrt:  [[0.15]]
grads:  [0.06116568]
Stock Position:  0.06116568334793654
Bond Position:  [23.14998278]


portfolio before change:  [29.3146841]
curr_Stock_Price:  100.5976406780034
curr_Factors:  [100.59764068]
mat_Sqrt:  [[0.15]]
grads:  [0.07498659]
Stock Position:  0.07498658744703997
Bond Position:  [21.77121032]


portfolio before change:  [29.24691472]
curr_Stock_Price:  99.54868356477353
curr_Factors:  [99.54868356]
mat_Sqrt:  [[0.15]]
grads:  [0.05616974]
Stock Position:  0.05616974158260585
Bond Position:  [23.65529089]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.24691472]
Stock Price:  96.93625249134897
PL:  [29.24691472]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.56416557e-02]
 [-1.86380175e-02]
 [-9.74884731e-04]
 [ 2.02281125e-03]
 [ 1.25906390e-02]
 [ 1.69126139e-02]
 [ 1.57098021e-02]
 [ 1.01202042e-02]
 [ 8.42678576e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.79358684]
curr_Stock_Price:  101.84327198901784
curr_Factors:  [101.84327199]
mat_Sqrt:  [[0.15]]
grads:  [0.3042777]
Stock Position:  0.3042777044242383
Bond Position:  [-1.19505017]


portfolio before change:  [28.85719869]
curr_Stock_Price:  98.76782326836052
curr_Factors:  [98.76782327]
mat_Sqrt:  [[0.15]]
grads:  [-0.12425345]
Stock Position:  -0.12425344983589558
Bond Position:  [41.12944146]


portfolio before change:  [28.62560298]
curr_Stock_Price:  100.7972684649191
curr_Factors:  [100.79726846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00649923]
Stock Position:  -0.0064992315381345
Bond Position:  [29.28070777]


portfolio before change:  [28.63180968]
curr_Stock_Price:  102.09547034650535
curr_Factors:  [102.09547035]
mat_Sqrt:  [[0.15]]
grads:  [0.01348541]
Stock Position:  0.013485408357370192
Bond Position:  [27.25501058]


portfolio before change:  [28.65120158]
curr_Stock_Price:  102.5226715035668
curr_Factors:  [102.5226715]
mat_Sqrt:  [[0.15]]
grads:  [0.08393759]
Stock Position:  0.08393759319900676
Bond Position:  [20.04569528]


portfolio before change:  [28.68685641]
curr_Stock_Price:  102.82801118544344
curr_Factors:  [102.82801119]
mat_Sqrt:  [[0.15]]
grads:  [0.11275076]
Stock Position:  0.11275075966240866
Bond Position:  [17.09292003]


portfolio before change:  [28.69452475]
curr_Stock_Price:  102.82020407697183
curr_Factors:  [102.82020408]
mat_Sqrt:  [[0.15]]
grads:  [0.10473201]
Stock Position:  0.10473201431979058
Bond Position:  [17.92595766]


portfolio before change:  [28.66887438]
curr_Stock_Price:  102.48968824090022
curr_Factors:  [102.48968824]
mat_Sqrt:  [[0.15]]
grads:  [0.06746803]
Stock Position:  0.06746802808847432
Bond Position:  [21.75409722]


portfolio before change:  [28.47948763]
curr_Stock_Price:  99.52137081872797
curr_Factors:  [99.52137082]
mat_Sqrt:  [[0.15]]
grads:  [0.05617857]
Stock Position:  0.05617857176388574
Bond Position:  [22.88851915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [28.47948763]
Stock Price:  100.42745077157299
PL:  [28.05203685]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.02561693]
 [0.00354286]
 [0.00779967]
 [0.00278907]
 [0.01542074]
 [0.01855909]
 [0.01517597]
 [0.01245724]
 [0.00707784]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [21.68964164]
curr_Stock_Price:  101.31759289142192
curr_Factors:  [101.31759289]
mat_Sqrt:  [[0.15]]
grads:  [0.17077955]
Stock Position:  0.17077954739553375
Bond Position:  [4.38666899]


portfolio before change:  [21.69710288]
curr_Stock_Price:  101.34843590195868
curr_Factors:  [101.3484359]
mat_Sqrt:  [[0.15]]
grads:  [0.02361909]
Stock Position:  0.023619091181690408
Bond Position:  [19.30334493]


portfolio before change:  [21.70132753]
curr_Stock_Price:  101.11856100091254
curr_Factors:  [101.118561]
mat_Sqrt:  [[0.15]]
grads:  [0.05199783]
Stock Position:  0.05199783011293253
Bond Position:  [16.44338177]


portfolio before change:  [21.71676143]
curr_Stock_Price:  101.25722363227139
curr_Factors:  [101.25722363]
mat_Sqrt:  [[0.15]]
grads:  [0.01859377]
Stock Position:  0.018593772001670568
Bond Position:  [19.8340077]


portfolio before change:  [21.71218176]
curr_Stock_Price:  100.47743797788638
curr_Factors:  [100.47743798]
mat_Sqrt:  [[0.15]]
grads:  [0.10280495]
Stock Position:  0.10280494598430599
Bond Position:  [11.38260418]


portfolio before change:  [21.58090421]
curr_Stock_Price:  99.14510636212775
curr_Factors:  [99.14510636]
mat_Sqrt:  [[0.15]]
grads:  [0.12372725]
Stock Position:  0.12372725289097385
Bond Position:  [9.31395256]


portfolio before change:  [22.02828798]
curr_Stock_Price:  102.72334499113828
curr_Factors:  [102.72334499]
mat_Sqrt:  [[0.15]]
grads:  [0.10117315]
Stock Position:  0.10117315024882813
Bond Position:  [11.63544356]


portfolio before change:  [21.87151886]
curr_Stock_Price:  101.11631488076993
curr_Factors:  [101.11631488]
mat_Sqrt:  [[0.15]]
grads:  [0.08304824]
Stock Position:  0.08304823841952086
Bond Position:  [13.47398703]


portfolio before change:  [22.05114734]
curr_Stock_Price:  103.19811458022195
curr_Factors:  [103.19811458]
mat_Sqrt:  [[0.15]]
grads:  [0.0471856]
Stock Position:  0.04718560412919682
Bond Position:  [17.18168195]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.05114734]
Stock Price:  103.30658271341976
PL:  [18.74456462]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.00270732]
 [0.00257282]
 [0.03392264]
 [0.00359489]
 [0.01577422]
 [0.0166832 ]
 [0.01528463]
 [0.00998135]
 [0.00782182]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.23244908]
curr_Stock_Price:  100.57439849660477
curr_Factors:  [100.5743985]
mat_Sqrt:  [[0.15]]
grads:  [0.01804881]
Stock Position:  0.018048811718733116
Bond Position:  [8.4172007]


portfolio before change:  [10.26104764]
curr_Stock_Price:  101.92567308729288
curr_Factors:  [101.92567309]
mat_Sqrt:  [[0.15]]
grads:  [0.01715211]
Stock Position:  0.017152106749373973
Bond Position:  [8.51280761]


portfolio before change:  [10.26847202]
curr_Stock_Price:  102.11031037678404
curr_Factors:  [102.11031038]
mat_Sqrt:  [[0.15]]
grads:  [0.22615094]
Stock Position:  0.22615094083881937
Bond Position:  [-12.82387074]


portfolio before change:  [10.51987137]
curr_Stock_Price:  103.25031397218709
curr_Factors:  [103.25031397]
mat_Sqrt:  [[0.15]]
grads:  [0.0239659]
Stock Position:  0.023965904130720368
Bond Position:  [8.04538424]


portfolio before change:  [10.49317431]
curr_Stock_Price:  101.96846134631892
curr_Factors:  [101.96846135]
mat_Sqrt:  [[0.15]]
grads:  [0.10516144]
Stock Position:  0.10516143956936774
Bond Position:  [-0.22997588]


portfolio before change:  [10.64562025]
curr_Stock_Price:  103.41919234229054
curr_Factors:  [103.41919234]
mat_Sqrt:  [[0.15]]
grads:  [0.11122133]
Stock Position:  0.11122132727571815
Bond Position:  [-0.85679959]


portfolio before change:  [10.56999149]
curr_Stock_Price:  102.74306074098335
curr_Factors:  [102.74306074]
mat_Sqrt:  [[0.15]]
grads:  [0.10189756]
Stock Position:  0.10189756007731104
Bond Position:  [0.10072429]


portfolio before change:  [10.54910047]
curr_Stock_Price:  102.53754652319414
curr_Factors:  [102.53754652]
mat_Sqrt:  [[0.15]]
grads:  [0.06654236]
Stock Position:  0.06654236441551453
Bond Position:  [3.72600968]


portfolio before change:  [10.4705834]
curr_Stock_Price:  101.32958613636981
curr_Factors:  [101.32958614]
mat_Sqrt:  [[0.15]]
grads:  [0.05214544]
Stock Position:  0.052145437510428994
Bond Position:  [5.1867078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.4705834]
Stock Price:  99.96898767605977
PL:  [10.4705834]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00503815]
 [-0.02421349]
 [ 0.01373299]
 [ 0.00464909]
 [ 0.008339  ]
 [ 0.01812689]
 [ 0.00272526]
 [ 0.01245108]
 [ 0.00690716]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.35837357]
curr_Stock_Price:  100.12849742917469
curr_Factors:  [100.12849743]
mat_Sqrt:  [[0.15]]
grads:  [-0.03358767]
Stock Position:  -0.03358767098324477
Bond Position:  [6.72145659]


portfolio before change:  [3.38028079]
curr_Stock_Price:  99.57634070300817
curr_Factors:  [99.5763407]
mat_Sqrt:  [[0.15]]
grads:  [-0.16142326]
Stock Position:  -0.1614232614293006
Bond Position:  [19.45421847]


portfolio before change:  [3.10511121]
curr_Stock_Price:  101.3412605848023
curr_Factors:  [101.34126058]
mat_Sqrt:  [[0.15]]
grads:  [0.09155327]
Stock Position:  0.09155327426499779
Bond Position:  [-6.17301301]


portfolio before change:  [3.0285936]
curr_Stock_Price:  100.5392103123146
curr_Factors:  [100.53921031]
mat_Sqrt:  [[0.15]]
grads:  [0.03099392]
Stock Position:  0.030993919855451746
Bond Position:  [-0.08751062]


portfolio before change:  [2.97967347]
curr_Stock_Price:  98.96224407712427
curr_Factors:  [98.96224408]
mat_Sqrt:  [[0.15]]
grads:  [0.05559336]
Stock Position:  0.05559335827561629
Bond Position:  [-2.52197002]


portfolio before change:  [3.07083924]
curr_Stock_Price:  100.62479998934805
curr_Factors:  [100.62479999]
mat_Sqrt:  [[0.15]]
grads:  [0.12084593]
Stock Position:  0.12084592712005474
Bond Position:  [-9.08925801]


portfolio before change:  [3.07194981]
curr_Stock_Price:  100.67160615183062
curr_Factors:  [100.67160615]
mat_Sqrt:  [[0.15]]
grads:  [0.01816842]
Stock Position:  0.01816841962513231
Bond Position:  [1.24290582]


portfolio before change:  [3.08001175]
curr_Stock_Price:  101.08112637979352
curr_Factors:  [101.08112638]
mat_Sqrt:  [[0.15]]
grads:  [0.08300722]
Stock Position:  0.08300722042838998
Bond Position:  [-5.31045159]


portfolio before change:  [3.28836637]
curr_Stock_Price:  103.62320049465187
curr_Factors:  [103.62320049]
mat_Sqrt:  [[0.15]]
grads:  [0.04604774]
Stock Position:  0.04604774058748294
Bond Position:  [-1.48324789]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.28836637]
Stock Price:  100.43468355841449
PL:  [2.85368281]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.59440408e-02]
 [-7.37069805e-04]
 [ 5.39576324e-02]
 [ 2.05891494e-03]
 [ 1.60916925e-02]
 [ 1.80798179e-02]
 [ 7.86024821e-04]
 [ 1.08047616e-02]
 [ 7.05406582e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [29.92353825]
curr_Stock_Price:  101.85170155463956
curr_Factors:  [101.85170155]
mat_Sqrt:  [[0.15]]
grads:  [0.30629361]
Stock Position:  0.3062936050818023
Bond Position:  [-1.27298661]


portfolio before change:  [29.6109645]
curr_Stock_Price:  100.83327645388422
curr_Factors:  [100.83327645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0049138]
Stock Position:  -0.00491379869957879
Bond Position:  [30.10643892]


portfolio before change:  [29.61522952]
curr_Stock_Price:  103.02953362918858
curr_Factors:  [103.02953363]
mat_Sqrt:  [[0.15]]
grads:  [0.35971755]
Stock Position:  0.3597175494327364
Bond Position:  [-7.44630184]


portfolio before change:  [29.29241533]
curr_Stock_Price:  102.14247627252472
curr_Factors:  [102.14247627]
mat_Sqrt:  [[0.15]]
grads:  [0.0137261]
Stock Position:  0.013726099605358585
Bond Position:  [27.89039753]


portfolio before change:  [29.2964107]
curr_Stock_Price:  101.41733770458099
curr_Factors:  [101.4173377]
mat_Sqrt:  [[0.15]]
grads:  [0.10727795]
Stock Position:  0.10727794968937522
Bond Position:  [18.41656664]


portfolio before change:  [29.23231618]
curr_Stock_Price:  100.73401834291606
curr_Factors:  [100.73401834]
mat_Sqrt:  [[0.15]]
grads:  [0.12053212]
Stock Position:  0.12053211908239717
Bond Position:  [17.09063149]


portfolio before change:  [29.20251803]
curr_Stock_Price:  100.41588235932194
curr_Factors:  [100.41588236]
mat_Sqrt:  [[0.15]]
grads:  [0.00524017]
Stock Position:  0.0052401654766507984
Bond Position:  [28.67632219]


portfolio before change:  [29.22649044]
curr_Stock_Price:  102.25373688180709
curr_Factors:  [102.25373688]
mat_Sqrt:  [[0.15]]
grads:  [0.07203174]
Stock Position:  0.07203174394347832
Bond Position:  [21.86097545]


portfolio before change:  [29.309714]
curr_Stock_Price:  103.25732691068065
curr_Factors:  [103.25732691]
mat_Sqrt:  [[0.15]]
grads:  [0.04702711]
Stock Position:  0.04702710545925331
Bond Position:  [24.4538208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [29.309714]
Stock Price:  104.60263811746813
PL:  [24.70707588]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01447586]
 [-0.01170106]
 [-0.02375837]
 [ 0.00313543]
 [ 0.00447225]
 [ 0.01783354]
 [-0.02206573]
 [ 0.00383968]
 [ 0.00847125]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.26741585]
curr_Stock_Price:  98.1418925163662
curr_Factors:  [98.14189252]
mat_Sqrt:  [[0.15]]
grads:  [0.09650571]
Stock Position:  0.0965057132327328
Bond Position:  [-36.73866918]


portfolio before change:  [-27.06359218]
curr_Stock_Price:  100.44432195474347
curr_Factors:  [100.44432195]
mat_Sqrt:  [[0.15]]
grads:  [-0.07800709]
Stock Position:  -0.07800709094519422
Bond Position:  [-19.22822282]


portfolio before change:  [-26.82565839]
curr_Stock_Price:  97.27088863287355
curr_Factors:  [97.27088863]
mat_Sqrt:  [[0.15]]
grads:  [-0.15838914]
Stock Position:  -0.15838913706509672
Bond Position:  [-11.41900628]


portfolio before change:  [-27.16779756]
curr_Stock_Price:  99.39494995685718
curr_Factors:  [99.39494996]
mat_Sqrt:  [[0.15]]
grads:  [0.02090286]
Stock Position:  0.020902862333286462
Bond Position:  [-29.24543652]


portfolio before change:  [-27.22043996]
curr_Stock_Price:  97.57625033870286
curr_Factors:  [97.57625034]
mat_Sqrt:  [[0.15]]
grads:  [0.02981502]
Stock Position:  0.02981502470571242
Bond Position:  [-30.12967828]


portfolio before change:  [-27.25624805]
curr_Stock_Price:  96.88064523873007
curr_Factors:  [96.88064524]
mat_Sqrt:  [[0.15]]
grads:  [0.11889025]
Stock Position:  0.11889025406337662
Bond Position:  [-38.77441258]


portfolio before change:  [-27.15590494]
curr_Stock_Price:  97.88775191355131
curr_Factors:  [97.88775191]
mat_Sqrt:  [[0.15]]
grads:  [-0.14710487]
Stock Position:  -0.14710486623192345
Bond Position:  [-12.75614029]


portfolio before change:  [-27.30194998]
curr_Stock_Price:  98.83717920678183
curr_Factors:  [98.83717921]
mat_Sqrt:  [[0.15]]
grads:  [0.02559789]
Stock Position:  0.025597891055330644
Bond Position:  [-29.83197333]


portfolio before change:  [-27.35718378]
curr_Stock_Price:  97.26228042073714
curr_Factors:  [97.26228042]
mat_Sqrt:  [[0.15]]
grads:  [0.056475]
Stock Position:  0.056474996976208884
Bond Position:  [-32.85007078]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-27.35718378]
Stock Price:  97.13537986296106
PL:  [-27.35718378]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.07446073]
 [-0.00579946]
 [-0.01203558]
 [ 0.00480261]
 [ 0.01652344]
 [ 0.0171203 ]
 [ 0.00850847]
 [ 0.01055694]
 [ 0.00793707]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [42.17871927]
curr_Stock_Price:  102.64665911468514
curr_Factors:  [102.64665911]
mat_Sqrt:  [[0.15]]
grads:  [0.49640488]
Stock Position:  0.4964048800804194
Bond Position:  [-8.77558324]


portfolio before change:  [41.18095763]
curr_Stock_Price:  100.64552498142068
curr_Factors:  [100.64552498]
mat_Sqrt:  [[0.15]]
grads:  [-0.03866306]
Stock Position:  -0.038663060303387675
Bond Position:  [45.07222163]


portfolio before change:  [41.27983458]
curr_Stock_Price:  98.6711545822096
curr_Factors:  [98.67115458]
mat_Sqrt:  [[0.15]]
grads:  [-0.08023723]
Stock Position:  -0.08023722502256093
Bond Position:  [49.19693421]


portfolio before change:  [41.20562115]
curr_Stock_Price:  99.90272818581528
curr_Factors:  [99.90272819]
mat_Sqrt:  [[0.15]]
grads:  [0.03201737]
Stock Position:  0.03201737396113545
Bond Position:  [38.00699814]


portfolio before change:  [41.28018047]
curr_Stock_Price:  101.63775723090636
curr_Factors:  [101.63775723]
mat_Sqrt:  [[0.15]]
grads:  [0.11015627]
Stock Position:  0.11015626918480059
Bond Position:  [30.08414433]


portfolio before change:  [41.38365896]
curr_Stock_Price:  102.44055001791207
curr_Factors:  [102.44055002]
mat_Sqrt:  [[0.15]]
grads:  [0.11413535]
Stock Position:  0.11413534893644262
Bond Position:  [29.69157104]


portfolio before change:  [41.29270851]
curr_Stock_Price:  101.51358086767749
curr_Factors:  [101.51358087]
mat_Sqrt:  [[0.15]]
grads:  [0.05672315]
Stock Position:  0.0567231532632814
Bond Position:  [35.53453811]


portfolio before change:  [41.35730937]
curr_Stock_Price:  102.33915468369248
curr_Factors:  [102.33915468]
mat_Sqrt:  [[0.15]]
grads:  [0.07037961]
Stock Position:  0.07037961285060292
Bond Position:  [34.15471929]


portfolio before change:  [41.28999198]
curr_Stock_Price:  101.13995767167988
curr_Factors:  [101.13995767]
mat_Sqrt:  [[0.15]]
grads:  [0.05291383]
Stock Position:  0.052913825618265055
Bond Position:  [35.9382899]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [41.28999198]
Stock Price:  101.11436735906165
PL:  [40.17562462]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00386745]
 [-0.02332835]
 [ 0.01740713]
 [ 0.00312702]
 [ 0.01606192]
 [ 0.01682984]
 [ 0.0307878 ]
 [ 0.00621667]
 [ 0.00704178]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.43926941]
curr_Stock_Price:  100.32834608382882
curr_Factors:  [100.32834608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02578303]
Stock Position:  -0.025783026294779802
Bond Position:  [9.02603779]


portfolio before change:  [6.46515549]
curr_Stock_Price:  99.49943109918206
curr_Factors:  [99.4994311]
mat_Sqrt:  [[0.15]]
grads:  [-0.15552233]
Stock Position:  -0.15552233290750628
Bond Position:  [21.93953914]


portfolio before change:  [6.16823519]
curr_Stock_Price:  101.4791648466935
curr_Factors:  [101.47916485]
mat_Sqrt:  [[0.15]]
grads:  [0.11604755]
Stock Position:  0.11604754692726228
Bond Position:  [-5.60817295]


portfolio before change:  [5.923016]
curr_Stock_Price:  99.3902417598244
curr_Factors:  [99.39024176]
mat_Sqrt:  [[0.15]]
grads:  [0.0208468]
Stock Position:  0.02084679940998797
Bond Position:  [3.85104757]


portfolio before change:  [5.96697466]
curr_Stock_Price:  101.40650563451607
curr_Factors:  [101.40650563]
mat_Sqrt:  [[0.15]]
grads:  [0.10707946]
Stock Position:  0.10707945603231873
Bond Position:  [-4.8915788]


portfolio before change:  [6.13613767]
curr_Stock_Price:  103.00914185413495
curr_Factors:  [103.00914185]
mat_Sqrt:  [[0.15]]
grads:  [0.1121989]
Stock Position:  0.11219890234571868
Bond Position:  [-5.42137498]


portfolio before change:  [6.41097976]
curr_Stock_Price:  105.48290452364219
curr_Factors:  [105.48290452]
mat_Sqrt:  [[0.15]]
grads:  [0.20525202]
Stock Position:  0.20525202499224518
Bond Position:  [-15.23959999]


portfolio before change:  [6.06249561]
curr_Stock_Price:  103.82220254854333
curr_Factors:  [103.82220255]
mat_Sqrt:  [[0.15]]
grads:  [0.04144447]
Stock Position:  0.04144447353963293
Bond Position:  [1.75963909]


portfolio before change:  [6.04123315]
curr_Stock_Price:  103.28793327879526
curr_Factors:  [103.28793328]
mat_Sqrt:  [[0.15]]
grads:  [0.04694518]
Stock Position:  0.04694517879633719
Bond Position:  [1.19236265]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.04123315]
Stock Price:  106.03381904410038
PL:  [0.0074141]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.85720725e-02]
 [-1.52775133e-02]
 [-4.01982063e-02]
 [-1.12446969e-03]
 [-1.17487737e-02]
 [ 1.66320660e-02]
 [-4.01622594e-02]
 [-7.24386442e-03]
 [ 8.53519311e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.6023286]
curr_Stock_Price:  98.76883830861323
curr_Factors:  [98.76883831]
mat_Sqrt:  [[0.15]]
grads:  [0.12381382]
Stock Position:  0.12381381692151537
Bond Position:  [-29.83127546]


portfolio before change:  [-17.82725772]
curr_Stock_Price:  97.07266450950394
curr_Factors:  [97.07266451]
mat_Sqrt:  [[0.15]]
grads:  [-0.10185009]
Stock Position:  -0.10185008895213432
Bond Position:  [-7.9403982]


portfolio before change:  [-17.70928927]
curr_Stock_Price:  95.87541826050028
curr_Factors:  [95.87541826]
mat_Sqrt:  [[0.15]]
grads:  [-0.26798804]
Stock Position:  -0.26798804209660204
Bond Position:  [7.98417635]


portfolio before change:  [-18.06669495]
curr_Stock_Price:  97.22398128728373
curr_Factors:  [97.22398129]
mat_Sqrt:  [[0.15]]
grads:  [-0.00749646]
Stock Position:  -0.007496464625220678
Bond Position:  [-17.33785882]


portfolio before change:  [-18.05698352]
curr_Stock_Price:  94.77182141505467
curr_Factors:  [94.77182142]
mat_Sqrt:  [[0.15]]
grads:  [-0.07832516]
Stock Position:  -0.07832515776110431
Bond Position:  [-10.63396566]


portfolio before change:  [-18.04909769]
curr_Stock_Price:  94.60324031342775
curr_Factors:  [94.60324031]
mat_Sqrt:  [[0.15]]
grads:  [0.11088044]
Stock Position:  0.11088044009590434
Bond Position:  [-28.53874661]


portfolio before change:  [-18.17606964]
curr_Stock_Price:  93.58683911377963
curr_Factors:  [93.58683911]
mat_Sqrt:  [[0.15]]
grads:  [-0.2677484]
Stock Position:  -0.26774839619259405
Bond Position:  [6.88165643]


portfolio before change:  [-18.33274901]
curr_Stock_Price:  94.18486717999996
curr_Factors:  [94.18486718]
mat_Sqrt:  [[0.15]]
grads:  [-0.04829243]
Stock Position:  -0.04829242949581154
Bond Position:  [-13.78433295]


portfolio before change:  [-18.42306485]
curr_Stock_Price:  95.91230053537157
curr_Factors:  [95.91230054]
mat_Sqrt:  [[0.15]]
grads:  [0.05690129]
Stock Position:  0.05690128738509603
Bond Position:  [-23.88059823]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-18.42306485]
Stock Price:  95.43922933082986
PL:  [-18.42306485]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01797052]
 [-0.01716699]
 [-0.02553048]
 [-0.00327489]
 [ 0.00470434]
 [ 0.01854038]
 [-0.00488324]
 [ 0.00857941]
 [ 0.00844314]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.34080965]
curr_Stock_Price:  98.9155363936902
curr_Factors:  [98.91553639]
mat_Sqrt:  [[0.15]]
grads:  [0.11980349]
Stock Position:  0.11980349304669331
Bond Position:  [-27.19123642]


portfolio before change:  [-15.47510362]
curr_Stock_Price:  97.90809536291333
curr_Factors:  [97.90809536]
mat_Sqrt:  [[0.15]]
grads:  [-0.11444663]
Stock Position:  -0.11444662637569834
Bond Position:  [-4.26985241]


portfolio before change:  [-15.38709757]
curr_Stock_Price:  97.12046612181521
curr_Factors:  [97.12046612]
mat_Sqrt:  [[0.15]]
grads:  [-0.17020318]
Stock Position:  -0.17020317685445088
Bond Position:  [1.1431143]


portfolio before change:  [-15.24141004]
curr_Stock_Price:  96.26786259114975
curr_Factors:  [96.26786259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02183263]
Stock Position:  -0.021832627380156677
Bond Position:  [-13.13962967]


portfolio before change:  [-15.28080601]
curr_Stock_Price:  97.77132418863947
curr_Factors:  [97.77132419]
mat_Sqrt:  [[0.15]]
grads:  [0.03136225]
Stock Position:  0.0313622543639713
Bond Position:  [-18.34713515]


portfolio before change:  [-15.27002077]
curr_Stock_Price:  98.40779340959566
curr_Factors:  [98.40779341]
mat_Sqrt:  [[0.15]]
grads:  [0.12360255]
Stock Position:  0.12360255015460751
Bond Position:  [-27.43347499]


portfolio before change:  [-15.12581545]
curr_Stock_Price:  99.68548135175035
curr_Factors:  [99.68548135]
mat_Sqrt:  [[0.15]]
grads:  [-0.03255494]
Stock Position:  -0.03255494403353638
Bond Position:  [-11.88056018]


portfolio before change:  [-15.13783494]
curr_Stock_Price:  99.87217291604738
curr_Factors:  [99.87217292]
mat_Sqrt:  [[0.15]]
grads:  [0.05719608]
Stock Position:  0.057196076210923284
Bond Position:  [-20.85013136]


portfolio before change:  [-15.18761161]
curr_Stock_Price:  99.184206209828
curr_Factors:  [99.18420621]
mat_Sqrt:  [[0.15]]
grads:  [0.05628758]
Stock Position:  0.05628757671757242
Bond Position:  [-20.77045023]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.18761161]
Stock Price:  97.79378968191362
PL:  [-15.18761161]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.88392279e-03]
 [-1.39873218e-02]
 [-1.31053708e-02]
 [ 1.65732404e-04]
 [ 4.69293095e-03]
 [ 1.78147410e-02]
 [-1.60777420e-02]
 [ 6.66950009e-03]
 [ 8.44470277e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.0129696]
curr_Stock_Price:  100.10609208935249
curr_Factors:  [100.10609209]
mat_Sqrt:  [[0.15]]
grads:  [-0.03255949]
Stock Position:  -0.03255948527678078
Bond Position:  [6.27237243]


portfolio before change:  [3.10708541]
curr_Stock_Price:  97.31185745524854
curr_Factors:  [97.31185746]
mat_Sqrt:  [[0.15]]
grads:  [-0.09324881]
Stock Position:  -0.09324881216078344
Bond Position:  [12.18130053]


portfolio before change:  [3.00809389]
curr_Stock_Price:  98.43877474796372
curr_Factors:  [98.43877475]
mat_Sqrt:  [[0.15]]
grads:  [-0.08736914]
Stock Position:  -0.08736913845921139
Bond Position:  [11.60860483]


portfolio before change:  [3.07114118]
curr_Stock_Price:  97.78360581873044
curr_Factors:  [97.78360582]
mat_Sqrt:  [[0.15]]
grads:  [0.00110488]
Stock Position:  0.0011048826912932997
Bond Position:  [2.96310177]


portfolio before change:  [3.07259894]
curr_Stock_Price:  97.76173609214709
curr_Factors:  [97.76173609]
mat_Sqrt:  [[0.15]]
grads:  [0.03128621]
Stock Position:  0.031286206306970515
Bond Position:  [0.0140051]


portfolio before change:  [3.04392514]
curr_Stock_Price:  96.8450124633878
curr_Factors:  [96.84501246]
mat_Sqrt:  [[0.15]]
grads:  [0.11876494]
Stock Position:  0.11876493967525047
Bond Position:  [-8.45786692]


portfolio before change:  [3.23423566]
curr_Stock_Price:  98.48304226551926
curr_Factors:  [98.48304227]
mat_Sqrt:  [[0.15]]
grads:  [-0.10718495]
Stock Position:  -0.10718494651343917
Bond Position:  [13.79013528]


portfolio before change:  [3.13409003]
curr_Stock_Price:  99.48171252192944
curr_Factors:  [99.48171252]
mat_Sqrt:  [[0.15]]
grads:  [0.04446333]
Stock Position:  0.04446333390965556
Bond Position:  [-1.28919857]


portfolio before change:  [3.1187811]
curr_Stock_Price:  99.15190879144738
curr_Factors:  [99.15190879]
mat_Sqrt:  [[0.15]]
grads:  [0.05629802]
Stock Position:  0.05629801843803135
Bond Position:  [-2.46327489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.1187811]
Stock Price:  97.77823642410495
PL:  [3.1187811]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.58998186e-02]
 [-2.20812333e-02]
 [-1.55048557e-02]
 [ 1.91932322e-03]
 [ 9.79424342e-03]
 [ 1.85171172e-02]
 [ 1.70777226e-03]
 [ 5.39701573e-03]
 [ 8.46762433e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.32020982]
curr_Stock_Price:  99.11147382342489
curr_Factors:  [99.11147382]
mat_Sqrt:  [[0.15]]
grads:  [0.10599879]
Stock Position:  0.10599879081936553
Bond Position:  [-22.8259062]


portfolio before change:  [-12.306867]
curr_Stock_Price:  99.34504844366889
curr_Factors:  [99.34504844]
mat_Sqrt:  [[0.15]]
grads:  [-0.14720822]
Stock Position:  -0.14720822180169477
Bond Position:  [2.31754093]


portfolio before change:  [-12.41891482]
curr_Stock_Price:  100.11407400785485
curr_Factors:  [100.11407401]
mat_Sqrt:  [[0.15]]
grads:  [-0.1033657]
Stock Position:  -0.10336570478660491
Bond Position:  [-2.070553]


portfolio before change:  [-12.27262417]
curr_Stock_Price:  98.68878320843697
curr_Factors:  [98.68878321]
mat_Sqrt:  [[0.15]]
grads:  [0.01279549]
Stock Position:  0.012795488114965645
Bond Position:  [-13.53539532]


portfolio before change:  [-12.26859976]
curr_Stock_Price:  99.53234619285077
curr_Factors:  [99.53234619]
mat_Sqrt:  [[0.15]]
grads:  [0.06529496]
Stock Position:  0.06529495612298965
Bond Position:  [-18.76755994]


portfolio before change:  [-12.29094167]
curr_Stock_Price:  99.33392689106167
curr_Factors:  [99.33392689]
mat_Sqrt:  [[0.15]]
grads:  [0.12344745]
Stock Position:  0.12344744805046902
Bond Position:  [-24.55346145]


portfolio before change:  [-12.15482688]
curr_Stock_Price:  100.53601403852898
curr_Factors:  [100.53601404]
mat_Sqrt:  [[0.15]]
grads:  [0.01138515]
Stock Position:  0.011385148377120343
Bond Position:  [-13.29944431]


portfolio before change:  [-12.17693982]
curr_Stock_Price:  99.17796753965946
curr_Factors:  [99.17796754]
mat_Sqrt:  [[0.15]]
grads:  [0.0359801]
Stock Position:  0.03598010485858361
Bond Position:  [-15.74537349]


portfolio before change:  [-12.2399363]
curr_Stock_Price:  97.64595899191028
curr_Factors:  [97.64595899]
mat_Sqrt:  [[0.15]]
grads:  [0.05645083]
Stock Position:  0.056450828833432325
Bond Position:  [-17.75213162]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.2399363]
Stock Price:  95.75011308222992
PL:  [-12.2399363]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.11940979e-04]
 [-3.56063924e-04]
 [ 6.08011615e-05]
 [ 2.10310004e-03]
 [ 1.07904759e-02]
 [ 1.66273057e-02]
 [ 1.68491472e-02]
 [ 1.06135115e-02]
 [ 6.68112419e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.90817227]
curr_Stock_Price:  100.48849655316377
curr_Factors:  [100.48849655]
mat_Sqrt:  [[0.15]]
grads:  [0.00074627]
Stock Position:  0.0007462731915901244
Bond Position:  [8.83318039]


portfolio before change:  [8.91287411]
curr_Stock_Price:  100.86925547363585
curr_Factors:  [100.86925547]
mat_Sqrt:  [[0.15]]
grads:  [-0.00237376]
Stock Position:  -0.002373759491811865
Bond Position:  [9.15231346]


portfolio before change:  [8.91747752]
curr_Stock_Price:  100.85825502304415
curr_Factors:  [100.85825502]
mat_Sqrt:  [[0.15]]
grads:  [0.00040534]
Stock Position:  0.0004053410768969634
Bond Position:  [8.87659553]


portfolio before change:  [8.92246023]
curr_Stock_Price:  102.19861042564186
curr_Factors:  [102.19861043]
mat_Sqrt:  [[0.15]]
grads:  [0.01402067]
Stock Position:  0.014020666960867033
Bond Position:  [7.48956755]


portfolio before change:  [8.94289177]
curr_Stock_Price:  103.38869808476352
curr_Factors:  [103.38869808]
mat_Sqrt:  [[0.15]]
grads:  [0.07193651]
Stock Position:  0.0719365061060596
Bond Position:  [1.50547006]


portfolio before change:  [8.95708195]
curr_Stock_Price:  103.57549134290927
curr_Factors:  [103.57549134]
mat_Sqrt:  [[0.15]]
grads:  [0.1108487]
Stock Position:  0.11084870485266451
Bond Position:  [-2.52412712]


portfolio before change:  [8.89501216]
curr_Stock_Price:  103.02692907095954
curr_Factors:  [103.02692907]
mat_Sqrt:  [[0.15]]
grads:  [0.11232765]
Stock Position:  0.11232764819699952
Bond Position:  [-2.67776049]


portfolio before change:  [8.81422667]
curr_Stock_Price:  102.31965644444233
curr_Factors:  [102.31965644]
mat_Sqrt:  [[0.15]]
grads:  [0.07075674]
Stock Position:  0.07075674322167858
Bond Position:  [1.57442101]


portfolio before change:  [8.94708156]
curr_Stock_Price:  104.18615668938334
curr_Factors:  [104.18615669]
mat_Sqrt:  [[0.15]]
grads:  [0.04454083]
Stock Position:  0.044540827966240266
Bond Position:  [4.30654387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.94708156]
Stock Price:  104.30798155010724
PL:  [4.63910001]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 7.18922647e-03]
 [-1.71573997e-02]
 [-4.92390948e-02]
 [-3.30935169e-03]
 [-3.32602048e-03]
 [ 1.79388601e-02]
 [-2.72361286e-02]
 [-3.01606644e-04]
 [ 8.54382404e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-34.19231059]
curr_Stock_Price:  97.69269495505779
curr_Factors:  [97.69269496]
mat_Sqrt:  [[0.15]]
grads:  [0.04792818]
Stock Position:  0.04792817643432754
Bond Position:  [-38.87454331]


portfolio before change:  [-34.20169772]
curr_Stock_Price:  97.90248806527745
curr_Factors:  [97.90248807]
mat_Sqrt:  [[0.15]]
grads:  [-0.11438266]
Stock Position:  -0.1143826645365465
Bond Position:  [-23.00335027]


portfolio before change:  [-33.89356085]
curr_Stock_Price:  95.10799623421171
curr_Factors:  [95.10799623]
mat_Sqrt:  [[0.15]]
grads:  [-0.32826063]
Stock Position:  -0.328260632216334
Bond Position:  [-2.67334988]


portfolio before change:  [-34.269643]
curr_Stock_Price:  96.24960478546322
curr_Factors:  [96.24960479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02206234]
Stock Position:  -0.022062344607470138
Bond Position:  [-32.14615105]


portfolio before change:  [-34.28522369]
curr_Stock_Price:  96.22710453383972
curr_Factors:  [96.22710453]
mat_Sqrt:  [[0.15]]
grads:  [-0.02217347]
Stock Position:  -0.022173469868542555
Bond Position:  [-32.15153489]


portfolio before change:  [-34.32022175]
curr_Stock_Price:  97.08029848655826
curr_Factors:  [97.08029849]
mat_Sqrt:  [[0.15]]
grads:  [0.1195924]
Stock Position:  0.11959240045384632
Bond Position:  [-45.93028768]


portfolio before change:  [-34.33458818]
curr_Stock_Price:  97.1522466131935
curr_Factors:  [97.15224661]
mat_Sqrt:  [[0.15]]
grads:  [-0.18157419]
Stock Position:  -0.1815741909542101
Bond Position:  [-16.6942476]


portfolio before change:  [-34.24780949]
curr_Stock_Price:  96.62834007441509
curr_Factors:  [96.62834007]
mat_Sqrt:  [[0.15]]
grads:  [-0.00201071]
Stock Position:  -0.002010710962441491
Bond Position:  [-34.05351783]


portfolio before change:  [-34.26229508]
curr_Stock_Price:  95.36240584967216
curr_Factors:  [95.36240585]
mat_Sqrt:  [[0.15]]
grads:  [0.05695883]
Stock Position:  0.05695882690614233
Bond Position:  [-39.69402584]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-34.26229508]
Stock Price:  95.85665244354256
PL:  [-34.26229508]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.92760419e-02]
 [ 2.30929712e-03]
 [ 4.19263598e-02]
 [ 2.22190254e-03]
 [ 1.33987434e-02]
 [ 1.80923177e-02]
 [-4.95689347e-03]
 [ 1.24298959e-02]
 [ 8.40022054e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.23385794]
curr_Stock_Price:  101.1582934229408
curr_Factors:  [101.15829342]
mat_Sqrt:  [[0.15]]
grads:  [0.12850695]
Stock Position:  0.1285069458090214
Bond Position:  [6.23431461]


portfolio before change:  [19.37002066]
curr_Stock_Price:  102.1936054194619
curr_Factors:  [102.19360542]
mat_Sqrt:  [[0.15]]
grads:  [0.01539531]
Stock Position:  0.015395314148643202
Bond Position:  [17.796718]


portfolio before change:  [19.38323346]
curr_Stock_Price:  102.47370525146806
curr_Factors:  [102.47370525]
mat_Sqrt:  [[0.15]]
grads:  [0.27950907]
Stock Position:  0.279509065481428
Bond Position:  [-9.25909613]


portfolio before change:  [19.1586846]
curr_Stock_Price:  101.68690372814444
curr_Factors:  [101.68690373]
mat_Sqrt:  [[0.15]]
grads:  [0.01481268]
Stock Position:  0.014812683569562843
Bond Position:  [17.65242867]


portfolio before change:  [19.14512143]
curr_Stock_Price:  100.1752540817222
curr_Factors:  [100.17525408]
mat_Sqrt:  [[0.15]]
grads:  [0.08932496]
Stock Position:  0.08932495575984017
Bond Position:  [10.1969713]


portfolio before change:  [18.89952419]
curr_Stock_Price:  97.36868111584391
curr_Factors:  [97.36868112]
mat_Sqrt:  [[0.15]]
grads:  [0.12061545]
Stock Position:  0.12061545157338002
Bond Position:  [7.15535675]


portfolio before change:  [19.18144286]
curr_Stock_Price:  99.67634649612872
curr_Factors:  [99.6763465]
mat_Sqrt:  [[0.15]]
grads:  [-0.03304596]
Stock Position:  -0.03304595644437715
Bond Position:  [22.47534307]


portfolio before change:  [19.1495793]
curr_Stock_Price:  100.98071327082425
curr_Factors:  [100.98071327]
mat_Sqrt:  [[0.15]]
grads:  [0.08286597]
Stock Position:  0.082865972358914
Bond Position:  [10.7817143]


portfolio before change:  [19.09583741]
curr_Stock_Price:  100.26710199593359
curr_Factors:  [100.267102]
mat_Sqrt:  [[0.15]]
grads:  [0.05600147]
Stock Position:  0.05600147023836524
Bond Position:  [13.48073228]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.09583741]
Stock Price:  97.12386112906887
PL:  [19.09583741]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.55330721e-02]
 [ 2.67573128e-03]
 [ 1.09926562e-03]
 [ 4.46951335e-03]
 [ 1.56301689e-02]
 [ 1.83031945e-02]
 [-5.76398304e-03]
 [ 1.17896295e-02]
 [ 7.99432205e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.78423117]
curr_Stock_Price:  101.0642603968677
curr_Factors:  [101.0642604]
mat_Sqrt:  [[0.15]]
grads:  [0.10355381]
Stock Position:  0.10355381391810536
Bond Position:  [7.31864156]


portfolio before change:  [17.86625822]
curr_Stock_Price:  101.82103418875379
curr_Factors:  [101.82103419]
mat_Sqrt:  [[0.15]]
grads:  [0.01783821]
Stock Position:  0.0178382085020602
Bond Position:  [16.04995338]


portfolio before change:  [17.85820176]
curr_Stock_Price:  100.91940519745803
curr_Factors:  [100.9194052]
mat_Sqrt:  [[0.15]]
grads:  [0.00732844]
Stock Position:  0.007328437454901977
Bond Position:  [17.11862021]


portfolio before change:  [17.88616887]
curr_Stock_Price:  103.5673992051751
curr_Factors:  [103.56739921]
mat_Sqrt:  [[0.15]]
grads:  [0.02979676]
Stock Position:  0.029796755677497535
Bond Position:  [14.80019638]


portfolio before change:  [17.82450289]
curr_Stock_Price:  101.24943121512399
curr_Factors:  [101.24943122]
mat_Sqrt:  [[0.15]]
grads:  [0.10420113]
Stock Position:  0.10420112569025596
Bond Position:  [7.27419818]


portfolio before change:  [17.70424111]
curr_Stock_Price:  100.06038661059814
curr_Factors:  [100.06038661]
mat_Sqrt:  [[0.15]]
grads:  [0.1220213]
Stock Position:  0.12202129659435498
Bond Position:  [5.494743]


portfolio before change:  [17.64788598]
curr_Stock_Price:  99.57601879808635
curr_Factors:  [99.5760188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03842655]
Stock Position:  -0.038426553606615184
Bond Position:  [21.4742492]


portfolio before change:  [17.61359397]
curr_Stock_Price:  100.74791208793755
curr_Factors:  [100.74791209]
mat_Sqrt:  [[0.15]]
grads:  [0.07859753]
Stock Position:  0.07859753030757853
Bond Position:  [9.6950569]


portfolio before change:  [17.64223806]
curr_Stock_Price:  101.05066147873508
curr_Factors:  [101.05066148]
mat_Sqrt:  [[0.15]]
grads:  [0.05329548]
Stock Position:  0.053295480337387784
Bond Position:  [12.25669452]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.64223806]
Stock Price:  100.70199745701183
PL:  [16.94024061]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 9.84511009e-03]
 [-2.71217466e-02]
 [ 4.49314814e-02]
 [ 2.12322814e-03]
 [ 1.54535011e-02]
 [ 1.72859460e-02]
 [ 1.60310421e-02]
 [ 9.64538451e-03]
 [ 8.42006064e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.27838292]
curr_Stock_Price:  100.83684632867292
curr_Factors:  [100.83684633]
mat_Sqrt:  [[0.15]]
grads:  [0.06563407]
Stock Position:  0.06563406725119124
Bond Position:  [7.66005057]


portfolio before change:  [14.21999184]
curr_Stock_Price:  99.88883167163505
curr_Factors:  [99.88883167]
mat_Sqrt:  [[0.15]]
grads:  [-0.18081164]
Stock Position:  -0.18081164405826478
Bond Position:  [32.28105572]


portfolio before change:  [13.74365863]
curr_Stock_Price:  102.6125377689586
curr_Factors:  [102.61253777]
mat_Sqrt:  [[0.15]]
grads:  [0.29954321]
Stock Position:  0.29954320946797086
Bond Position:  [-16.99323026]


portfolio before change:  [13.61883049]
curr_Stock_Price:  102.22418179021633
curr_Factors:  [102.22418179]
mat_Sqrt:  [[0.15]]
grads:  [0.01415485]
Stock Position:  0.014154854239398152
Bond Position:  [12.1718621]


portfolio before change:  [13.61021071]
curr_Stock_Price:  101.18515787674153
curr_Factors:  [101.18515788]
mat_Sqrt:  [[0.15]]
grads:  [0.10302334]
Stock Position:  0.1030233406583718
Bond Position:  [3.18577773]


portfolio before change:  [13.70930212]
curr_Stock_Price:  102.13152711520905
curr_Factors:  [102.13152712]
mat_Sqrt:  [[0.15]]
grads:  [0.11523964]
Stock Position:  0.11523963972057338
Bond Position:  [1.93970173]


portfolio before change:  [13.796352]
curr_Stock_Price:  102.87849047741439
curr_Factors:  [102.87849048]
mat_Sqrt:  [[0.15]]
grads:  [0.10687361]
Stock Position:  0.10687361388761213
Bond Position:  [2.80135594]


portfolio before change:  [13.77369122]
curr_Stock_Price:  102.65334779357306
curr_Factors:  [102.65334779]
mat_Sqrt:  [[0.15]]
grads:  [0.06430256]
Stock Position:  0.06430256340021567
Bond Position:  [7.17281782]


portfolio before change:  [13.58480168]
curr_Stock_Price:  99.6600479804029
curr_Factors:  [99.66004798]
mat_Sqrt:  [[0.15]]
grads:  [0.05613374]
Stock Position:  0.056133737587383374
Bond Position:  [7.99051069]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.58480168]
Stock Price:  98.67381250040793
PL:  [13.58480168]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.04064403e-02]
 [-6.12833902e-04]
 [ 1.44462207e-01]
 [ 1.92303493e-02]
 [-1.57130447e-02]
 [ 1.52777761e-02]
 [ 2.94517047e-02]
 [ 1.22401812e-03]
 [ 6.16946516e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.66712763]
curr_Stock_Price:  100.86206305505168
curr_Factors:  [100.86206306]
mat_Sqrt:  [[0.15]]
grads:  [0.06937627]
Stock Position:  0.06937626880766655
Bond Position:  [7.66969403]


portfolio before change:  [14.96946271]
curr_Stock_Price:  105.16467660110212
curr_Factors:  [105.1646766]
mat_Sqrt:  [[0.15]]
grads:  [-0.00408556]
Stock Position:  -0.004085559346162794
Bond Position:  [15.39911924]


portfolio before change:  [14.96880496]
curr_Stock_Price:  107.21072146491406
curr_Factors:  [107.21072146]
mat_Sqrt:  [[0.15]]
grads:  [0.96308138]
Stock Position:  0.963081376941065
Bond Position:  [-88.2838443]


portfolio before change:  [16.56253942]
curr_Stock_Price:  108.911395425827
curr_Factors:  [108.91139543]
mat_Sqrt:  [[0.15]]
grads:  [0.12820233]
Stock Position:  0.12820232898437936
Bond Position:  [2.59984487]


portfolio before change:  [16.52937734]
curr_Stock_Price:  108.64258340764437
curr_Factors:  [108.64258341]
mat_Sqrt:  [[0.15]]
grads:  [-0.10475363]
Stock Position:  -0.1047536311185013
Bond Position:  [27.91008244]


portfolio before change:  [16.70702115]
curr_Stock_Price:  107.08000956849062
curr_Factors:  [107.08000957]
mat_Sqrt:  [[0.15]]
grads:  [0.10185184]
Stock Position:  0.1018518407280102
Bond Position:  [5.80072507]


portfolio before change:  [16.52355816]
curr_Stock_Price:  105.25025291087678
curr_Factors:  [105.25025291]
mat_Sqrt:  [[0.15]]
grads:  [0.1963447]
Stock Position:  0.19634469804832172
Bond Position:  [-4.14177097]


portfolio before change:  [16.71411168]
curr_Stock_Price:  106.23130779303334
curr_Factors:  [106.23130779]
mat_Sqrt:  [[0.15]]
grads:  [0.00816012]
Stock Position:  0.008160120792880783
Bond Position:  [15.84725137]


portfolio before change:  [16.71641918]
curr_Stock_Price:  105.54282479679857
curr_Factors:  [105.5428248]
mat_Sqrt:  [[0.15]]
grads:  [0.04112977]
Stock Position:  0.041129767761610314
Bond Position:  [12.37546731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.71641918]
Stock Price:  105.01553816714045
PL:  [11.70088101]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.81561199e-02]
 [-1.71146764e-02]
 [ 2.68229181e-02]
 [ 1.96094657e-03]
 [ 1.19001647e-02]
 [ 1.66012081e-02]
 [ 3.16007746e-02]
 [ 2.45040911e-03]
 [ 5.35404366e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-21.67826636]
curr_Stock_Price:  98.50444421001285
curr_Factors:  [98.50444421]
mat_Sqrt:  [[0.15]]
grads:  [0.1210408]
Stock Position:  0.12104079956934198
Bond Position:  [-33.60132305]


portfolio before change:  [-21.77095478]
curr_Stock_Price:  97.87751876583985
curr_Factors:  [97.87751877]
mat_Sqrt:  [[0.15]]
grads:  [-0.11409784]
Stock Position:  -0.11409784243183323
Bond Position:  [-10.60334107]


portfolio before change:  [-22.22752111]
curr_Stock_Price:  101.83257454489382
curr_Factors:  [101.83257454]
mat_Sqrt:  [[0.15]]
grads:  [0.17881945]
Stock Position:  0.17881945397707869
Bond Position:  [-40.43716649]


portfolio before change:  [-22.21513748]
curr_Stock_Price:  102.01492195255777
curr_Factors:  [102.01492195]
mat_Sqrt:  [[0.15]]
grads:  [0.01307298]
Stock Position:  0.01307297713863265
Bond Position:  [-23.54877623]


portfolio before change:  [-22.21845023]
curr_Stock_Price:  102.66240933370993
curr_Factors:  [102.66240933]
mat_Sqrt:  [[0.15]]
grads:  [0.07933443]
Stock Position:  0.07933443107552561
Bond Position:  [-30.36311407]


portfolio before change:  [-22.155407]
curr_Stock_Price:  103.64847030492662
curr_Factors:  [103.6484703]
mat_Sqrt:  [[0.15]]
grads:  [0.11067472]
Stock Position:  0.11067472038986441
Bond Position:  [-33.62667247]


portfolio before change:  [-21.95353186]
curr_Stock_Price:  105.62446512764818
curr_Factors:  [105.62446513]
mat_Sqrt:  [[0.15]]
grads:  [0.21067183]
Stock Position:  0.21067183088687325
Bond Position:  [-44.20563132]


portfolio before change:  [-21.90353084]
curr_Stock_Price:  105.96674804417619
curr_Factors:  [105.96674804]
mat_Sqrt:  [[0.15]]
grads:  [0.01633606]
Stock Position:  0.016336060703482497
Bond Position:  [-23.63461006]


portfolio before change:  [-21.88436649]
curr_Stock_Price:  107.86344822630774
curr_Factors:  [107.86344823]
mat_Sqrt:  [[0.15]]
grads:  [0.03569362]
Stock Position:  0.0356936243739535
Bond Position:  [-25.73440389]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-21.88436649]
Stock Price:  110.97687370593857
PL:  [-32.86124019]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01751004]
 [-0.01812026]
 [ 0.00997009]
 [ 0.00310331]
 [ 0.01572826]
 [ 0.0171368 ]
 [ 0.01490917]
 [ 0.01246373]
 [ 0.00693974]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.60961313]
curr_Stock_Price:  99.0278340215952
curr_Factors:  [99.02783402]
mat_Sqrt:  [[0.15]]
grads:  [0.11673358]
Stock Position:  0.11673358345627756
Bond Position:  [-25.16948706]


portfolio before change:  [-13.68787618]
curr_Stock_Price:  98.46522677152701
curr_Factors:  [98.46522677]
mat_Sqrt:  [[0.15]]
grads:  [-0.12080176]
Stock Position:  -0.12080176424407309
Bond Position:  [-1.79310307]


portfolio before change:  [-14.01914141]
curr_Stock_Price:  101.20002500624813
curr_Factors:  [101.20002501]
mat_Sqrt:  [[0.15]]
grads:  [0.0664673]
Stock Position:  0.06646729995734275
Bond Position:  [-20.74563383]


portfolio before change:  [-14.03487953]
curr_Stock_Price:  101.11934310842408
curr_Factors:  [101.11934311]
mat_Sqrt:  [[0.15]]
grads:  [0.02068871]
Stock Position:  0.020688705774007544
Bond Position:  [-16.12690787]


portfolio before change:  [-14.04417766]
curr_Stock_Price:  101.05976169842697
curr_Factors:  [101.0597617]
mat_Sqrt:  [[0.15]]
grads:  [0.10485506]
Stock Position:  0.10485506176746642
Bond Position:  [-24.64080521]


portfolio before change:  [-13.91494649]
curr_Stock_Price:  102.40976476978311
curr_Factors:  [102.40976477]
mat_Sqrt:  [[0.15]]
grads:  [0.11424536]
Stock Position:  0.11424535976573269
Bond Position:  [-25.61478691]


portfolio before change:  [-13.89746254]
curr_Stock_Price:  102.67493565571353
curr_Factors:  [102.67493566]
mat_Sqrt:  [[0.15]]
grads:  [0.09939446]
Stock Position:  0.09939446069110915
Bond Position:  [-24.1027824]


portfolio before change:  [-14.06074186]
curr_Stock_Price:  101.1534734354008
curr_Factors:  [101.15347344]
mat_Sqrt:  [[0.15]]
grads:  [0.08309155]
Stock Position:  0.08309155283252503
Bond Position:  [-22.46574104]


portfolio before change:  [-13.8735058]
curr_Stock_Price:  103.5420645609801
curr_Factors:  [103.54206456]
mat_Sqrt:  [[0.15]]
grads:  [0.04626492]
Stock Position:  0.04626492402667508
Bond Position:  [-18.66387155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.8735058]
Stock Price:  103.81525111884329
PL:  [-17.68875691]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.00565944]
 [-0.00353389]
 [-0.01335053]
 [ 0.00250554]
 [ 0.01570718]
 [ 0.01856338]
 [-0.00809618]
 [ 0.01218533]
 [ 0.00738393]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.62594328]
curr_Stock_Price:  99.2862429718872
curr_Factors:  [99.28624297]
mat_Sqrt:  [[0.15]]
grads:  [0.03772959]
Stock Position:  0.03772958500158552
Bond Position:  [-13.37197203]


portfolio before change:  [-9.57843156]
curr_Stock_Price:  100.7227650299975
curr_Factors:  [100.72276503]
mat_Sqrt:  [[0.15]]
grads:  [-0.02355924]
Stock Position:  -0.0235592376215507
Bond Position:  [-7.20548]


portfolio before change:  [-9.57130652]
curr_Stock_Price:  100.26737340484766
curr_Factors:  [100.2673734]
mat_Sqrt:  [[0.15]]
grads:  [-0.0890035]
Stock Position:  -0.08900350133926359
Bond Position:  [-0.64715922]


portfolio before change:  [-9.67884795]
curr_Stock_Price:  101.47202002273731
curr_Factors:  [101.47202002]
mat_Sqrt:  [[0.15]]
grads:  [0.01670361]
Stock Position:  0.01670361196156217
Bond Position:  [-11.37379719]


portfolio before change:  [-9.70011645]
curr_Stock_Price:  100.53927671748562
curr_Factors:  [100.53927672]
mat_Sqrt:  [[0.15]]
grads:  [0.10471451]
Stock Position:  0.10471450930744322
Bond Position:  [-20.22803748]


portfolio before change:  [-9.86636593]
curr_Stock_Price:  99.04824230194792
curr_Factors:  [99.0482423]
mat_Sqrt:  [[0.15]]
grads:  [0.12375589]
Stock Position:  0.12375589240705419
Bond Position:  [-22.12416955]


portfolio before change:  [-9.84131761]
curr_Stock_Price:  99.34005204962986
curr_Factors:  [99.34005205]
mat_Sqrt:  [[0.15]]
grads:  [-0.05397452]
Stock Position:  -0.053974518867194954
Bond Position:  [-4.4794861]


portfolio before change:  [-9.92682769]
curr_Stock_Price:  100.88281302621814
curr_Factors:  [100.88281303]
mat_Sqrt:  [[0.15]]
grads:  [0.08123555]
Stock Position:  0.08123555328142894
Bond Position:  [-18.12209883]


portfolio before change:  [-9.82471824]
curr_Stock_Price:  102.25133657982794
curr_Factors:  [102.25133658]
mat_Sqrt:  [[0.15]]
grads:  [0.04922617]
Stock Position:  0.04922617274135495
Bond Position:  [-14.8581602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.82471824]
Stock Price:  101.53653915444694
PL:  [-11.3612574]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.0146787 ]
 [-0.0244553 ]
 [-0.01535139]
 [ 0.00375579]
 [ 0.00942127]
 [ 0.01843021]
 [-0.01876279]
 [ 0.00260328]
 [ 0.00843249]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.9989315]
curr_Stock_Price:  99.13231420308304
curr_Factors:  [99.1323142]
mat_Sqrt:  [[0.15]]
grads:  [0.09785802]
Stock Position:  0.09785801665687273
Bond Position:  [-21.69982316]


portfolio before change:  [-11.96453318]
curr_Stock_Price:  99.59472854789139
curr_Factors:  [99.59472855]
mat_Sqrt:  [[0.15]]
grads:  [-0.16303532]
Stock Position:  -0.16303532399891593
Bond Position:  [4.27292566]


portfolio before change:  [-12.0576779]
curr_Stock_Price:  100.17915232191501
curr_Factors:  [100.17915232]
mat_Sqrt:  [[0.15]]
grads:  [-0.1023426]
Stock Position:  -0.10234259572809946
Bond Position:  [-1.80508341]


portfolio before change:  [-12.12549376]
curr_Stock_Price:  100.83296702191446
curr_Factors:  [100.83296702]
mat_Sqrt:  [[0.15]]
grads:  [0.02503859]
Stock Position:  0.025038594821258017
Bond Position:  [-14.65020957]


portfolio before change:  [-12.16974737]
curr_Stock_Price:  99.35817693341085
curr_Factors:  [99.35817693]
mat_Sqrt:  [[0.15]]
grads:  [0.06280847]
Stock Position:  0.06280847125982035
Bond Position:  [-18.41028257]


portfolio before change:  [-12.16122925]
curr_Stock_Price:  99.64039297885877
curr_Factors:  [99.64039298]
mat_Sqrt:  [[0.15]]
grads:  [0.12286808]
Stock Position:  0.12286808185648526
Bond Position:  [-24.40385321]


portfolio before change:  [-12.35170723]
curr_Stock_Price:  98.18946287852035
curr_Factors:  [98.18946288]
mat_Sqrt:  [[0.15]]
grads:  [-0.12508523]
Stock Position:  -0.1250852342683959
Bond Position:  [-0.06965526]


portfolio before change:  [-12.32072891]
curr_Stock_Price:  97.94152671709186
curr_Factors:  [97.94152672]
mat_Sqrt:  [[0.15]]
grads:  [0.0173552]
Stock Position:  0.017355204569934297
Bond Position:  [-14.02052414]


portfolio before change:  [-12.30236318]
curr_Stock_Price:  99.40378244957927
curr_Factors:  [99.40378245]
mat_Sqrt:  [[0.15]]
grads:  [0.05621659]
Stock Position:  0.056216587956554855
Bond Position:  [-17.89050466]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.30236318]
Stock Price:  97.1557574121548
PL:  [-12.30236318]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-6.75131087e-04]
 [-1.78375119e-02]
 [-1.04385306e-02]
 [ 2.42496440e-03]
 [ 1.53850416e-02]
 [ 1.83745202e-02]
 [ 8.94580464e-03]
 [ 7.56232186e-04]
 [ 8.53690179e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.50657366]
curr_Stock_Price:  100.46244603271018
curr_Factors:  [100.46244603]
mat_Sqrt:  [[0.15]]
grads:  [-0.00450087]
Stock Position:  -0.004500873912946617
Bond Position:  [8.95874247]


portfolio before change:  [8.51207736]
curr_Stock_Price:  100.23511241798175
curr_Factors:  [100.23511242]
mat_Sqrt:  [[0.15]]
grads:  [-0.11891675]
Stock Position:  -0.11891674603759325
Bond Position:  [20.43171076]


portfolio before change:  [8.60760817]
curr_Stock_Price:  99.51769950318896
curr_Factors:  [99.5176995]
mat_Sqrt:  [[0.15]]
grads:  [-0.0695902]
Stock Position:  -0.06959020380055529
Bond Position:  [15.53306517]


portfolio before change:  [8.39975178]
curr_Stock_Price:  102.61619403129637
curr_Factors:  [102.61619403]
mat_Sqrt:  [[0.15]]
grads:  [0.01616643]
Stock Position:  0.01616642933918409
Bond Position:  [6.74081433]


portfolio before change:  [8.36842238]
curr_Stock_Price:  100.4697305951126
curr_Factors:  [100.4697306]
mat_Sqrt:  [[0.15]]
grads:  [0.10256694]
Stock Position:  0.10256694411755306
Bond Position:  [-1.93645086]


portfolio before change:  [8.3011792]
curr_Stock_Price:  99.82356996606794
curr_Factors:  [99.82356997]
mat_Sqrt:  [[0.15]]
grads:  [0.1224968]
Stock Position:  0.12249680147985996
Bond Position:  [-3.92688884]


portfolio before change:  [8.51595635]
curr_Stock_Price:  101.59293117501984
curr_Factors:  [101.59293118]
mat_Sqrt:  [[0.15]]
grads:  [0.0596387]
Stock Position:  0.05963869758615295
Bond Position:  [2.45708625]


portfolio before change:  [8.24330864]
curr_Stock_Price:  97.00066858643989
curr_Factors:  [97.00066859]
mat_Sqrt:  [[0.15]]
grads:  [0.00504155]
Stock Position:  0.005041547908473255
Bond Position:  [7.75427512]


portfolio before change:  [8.24115085]
curr_Stock_Price:  95.80343704493278
curr_Factors:  [95.80343704]
mat_Sqrt:  [[0.15]]
grads:  [0.05691268]
Stock Position:  0.05691267857192174
Bond Position:  [2.78872063]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.24115085]
Stock Price:  98.32101715851307
PL:  [8.24115085]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.83318350e-02]
 [-2.72446581e-02]
 [-1.63954584e-02]
 [ 2.66628955e-03]
 [ 1.44163823e-02]
 [ 1.67986383e-02]
 [ 1.59613981e-03]
 [ 7.00540205e-03]
 [ 8.43134630e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.77239694]
curr_Stock_Price:  98.56320529605959
curr_Factors:  [98.5632053]
mat_Sqrt:  [[0.15]]
grads:  [0.12221223]
Stock Position:  0.1222122332116185
Bond Position:  [-32.81802637]


portfolio before change:  [-21.22110618]
curr_Stock_Price:  95.0259479013524
curr_Factors:  [95.0259479]
mat_Sqrt:  [[0.15]]
grads:  [-0.18163105]
Stock Position:  -0.18163105425429218
Bond Position:  [-3.96144308]


portfolio before change:  [-21.74952136]
curr_Stock_Price:  97.92431772021541
curr_Factors:  [97.92431772]
mat_Sqrt:  [[0.15]]
grads:  [-0.10930306]
Stock Position:  -0.1093030557399778
Bond Position:  [-11.04609421]


portfolio before change:  [-22.12950938]
curr_Stock_Price:  101.35023831252737
curr_Factors:  [101.35023831]
mat_Sqrt:  [[0.15]]
grads:  [0.01777526]
Stock Position:  0.017775263686042313
Bond Position:  [-23.93103659]


portfolio before change:  [-22.1268937]
curr_Stock_Price:  102.1707151196751
curr_Factors:  [102.17071512]
mat_Sqrt:  [[0.15]]
grads:  [0.09610922]
Stock Position:  0.09610921515705319
Bond Position:  [-31.94644094]


portfolio before change:  [-22.05390594]
curr_Stock_Price:  103.09638049427909
curr_Factors:  [103.09638049]
mat_Sqrt:  [[0.15]]
grads:  [0.11199092]
Stock Position:  0.11199092229884869
Bond Position:  [-33.59976468]


portfolio before change:  [-22.35907719]
curr_Stock_Price:  100.52146494126042
curr_Factors:  [100.52146494]
mat_Sqrt:  [[0.15]]
grads:  [0.01064093]
Stock Position:  0.01064093207611842
Bond Position:  [-23.42871927]


portfolio before change:  [-22.38097898]
curr_Stock_Price:  99.5643588783111
curr_Factors:  [99.56435888]
mat_Sqrt:  [[0.15]]
grads:  [0.04670268]
Stock Position:  0.04670268033418106
Bond Position:  [-27.03090141]


portfolio before change:  [-22.40089747]
curr_Stock_Price:  99.42732915175138
curr_Factors:  [99.42732915]
mat_Sqrt:  [[0.15]]
grads:  [0.05620898]
Stock Position:  0.05620897533318932
Bond Position:  [-27.98960576]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.40089747]
Stock Price:  98.08894081895671
PL:  [-22.40089747]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00531165]
 [ 0.00232396]
 [ 0.00314181]
 [ 0.00241084]
 [ 0.01641432]
 [ 0.01722932]
 [-0.00984146]
 [ 0.00274866]
 [ 0.0084211 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.41649678]
curr_Stock_Price:  100.19713477076029
curr_Factors:  [100.19713477]
mat_Sqrt:  [[0.15]]
grads:  [-0.035411]
Stock Position:  -0.03541100049611658
Bond Position:  [7.96457757]


portfolio before change:  [4.35031111]
curr_Stock_Price:  102.17869286078742
curr_Factors:  [102.17869286]
mat_Sqrt:  [[0.15]]
grads:  [0.01549309]
Stock Position:  0.015493093586178957
Bond Position:  [2.76724706]


portfolio before change:  [4.33320539]
curr_Stock_Price:  100.98527820496682
curr_Factors:  [100.9852782]
mat_Sqrt:  [[0.15]]
grads:  [0.02094542]
Stock Position:  0.02094541917786379
Bond Position:  [2.21802641]


portfolio before change:  [4.36791727]
curr_Stock_Price:  102.58957112045097
curr_Factors:  [102.58957112]
mat_Sqrt:  [[0.15]]
grads:  [0.01607226]
Stock Position:  0.01607225679668969
Bond Position:  [2.71907134]


portfolio before change:  [4.35776208]
curr_Stock_Price:  101.87311533013072
curr_Factors:  [101.87311533]
mat_Sqrt:  [[0.15]]
grads:  [0.10942882]
Stock Position:  0.10942881871900498
Bond Position:  [-6.79009259]


portfolio before change:  [4.3942032]
curr_Stock_Price:  102.23716030708087
curr_Factors:  [102.23716031]
mat_Sqrt:  [[0.15]]
grads:  [0.11486216]
Stock Position:  0.1148621603840516
Bond Position:  [-7.3489779]


portfolio before change:  [4.04532065]
curr_Stock_Price:  99.23175680440825
curr_Factors:  [99.2317568]
mat_Sqrt:  [[0.15]]
grads:  [-0.06560975]
Stock Position:  -0.06560974868198284
Bond Position:  [10.55589128]


portfolio before change:  [4.12093085]
curr_Stock_Price:  98.15979828222736
curr_Factors:  [98.15979828]
mat_Sqrt:  [[0.15]]
grads:  [0.01832439]
Stock Position:  0.01832438519246836
Bond Position:  [2.32221289]


portfolio before change:  [4.14919167]
curr_Stock_Price:  99.6386704797476
curr_Factors:  [99.63867048]
mat_Sqrt:  [[0.15]]
grads:  [0.05614065]
Stock Position:  0.056140648910242764
Bond Position:  [-1.44458795]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.14919167]
Stock Price:  99.3074966668766
PL:  [4.14919167]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00362006]
 [-0.02188075]
 [-0.01301928]
 [ 0.00489566]
 [ 0.00987237]
 [ 0.01677615]
 [ 0.00866535]
 [ 0.01181898]
 [ 0.00846321]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.7857687]
curr_Stock_Price:  100.3508224740317
curr_Factors:  [100.35082247]
mat_Sqrt:  [[0.15]]
grads:  [-0.02413376]
Stock Position:  -0.024133762218751232
Bond Position:  [9.20761159]


portfolio before change:  [6.81524571]
curr_Stock_Price:  99.3202308616031
curr_Factors:  [99.32023086]
mat_Sqrt:  [[0.15]]
grads:  [-0.1458717]
Stock Position:  -0.14587169773435846
Bond Position:  [21.3032564]


portfolio before change:  [6.95175164]
curr_Stock_Price:  98.45747511262466
curr_Factors:  [98.45747511]
mat_Sqrt:  [[0.15]]
grads:  [-0.08679521]
Stock Position:  -0.08679521007842766
Bond Position:  [15.49738888]


portfolio before change:  [6.81701727]
curr_Stock_Price:  100.09909801488419
curr_Factors:  [100.09909801]
mat_Sqrt:  [[0.15]]
grads:  [0.0326377]
Stock Position:  0.032637701235638146
Bond Position:  [3.55001282]


portfolio before change:  [6.80209721]
curr_Stock_Price:  99.58755741960435
curr_Factors:  [99.58755742]
mat_Sqrt:  [[0.15]]
grads:  [0.06581583]
Stock Position:  0.0658158250220527
Bond Position:  [0.24765996]


portfolio before change:  [7.03729624]
curr_Stock_Price:  103.15926932630562
curr_Factors:  [103.15926933]
mat_Sqrt:  [[0.15]]
grads:  [0.11184099]
Stock Position:  0.11184099306782372
Bond Position:  [-4.50013889]


portfolio before change:  [6.85417357]
curr_Stock_Price:  101.54204447804317
curr_Factors:  [101.54204448]
mat_Sqrt:  [[0.15]]
grads:  [0.05776898]
Stock Position:  0.057768983082843915
Bond Position:  [0.98819293]


portfolio before change:  [6.80926199]
curr_Stock_Price:  100.7560552225631
curr_Factors:  [100.75605522]
mat_Sqrt:  [[0.15]]
grads:  [0.07879321]
Stock Position:  0.0787932055451467
Bond Position:  [-1.12963057]


portfolio before change:  [6.65807242]
curr_Stock_Price:  98.84441051574628
curr_Factors:  [98.84441052]
mat_Sqrt:  [[0.15]]
grads:  [0.0564214]
Stock Position:  0.05642140077879524
Bond Position:  [1.08113232]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.65807242]
Stock Price:  99.3856731297137
PL:  [6.65807242]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.71398021e-02]
 [-1.18023940e-02]
 [-9.91968520e-03]
 [ 4.71621946e-03]
 [ 7.29453389e-03]
 [ 1.80872697e-02]
 [-1.64308260e-02]
 [ 2.07873217e-03]
 [ 8.52504192e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.43742227]
curr_Stock_Price:  101.88503570013201
curr_Factors:  [101.8850357]
mat_Sqrt:  [[0.15]]
grads:  [0.31426535]
Stock Position:  0.31426534749808366
Bond Position:  [-1.58151388]


portfolio before change:  [29.98277923]
curr_Stock_Price:  100.44086730678683
curr_Factors:  [100.44086731]
mat_Sqrt:  [[0.15]]
grads:  [-0.07868263]
Stock Position:  -0.07868262638473231
Bond Position:  [37.88573047]


portfolio before change:  [30.09713296]
curr_Stock_Price:  99.22832348016057
curr_Factors:  [99.22832348]
mat_Sqrt:  [[0.15]]
grads:  [-0.06613123]
Stock Position:  -0.0661312346709619
Bond Position:  [36.65922451]


portfolio before change:  [30.07827284]
curr_Stock_Price:  99.79075538552861
curr_Factors:  [99.79075539]
mat_Sqrt:  [[0.15]]
grads:  [0.03144146]
Stock Position:  0.031441463087921624
Bond Position:  [26.94070549]


portfolio before change:  [30.05368301]
curr_Stock_Price:  98.58013878098399
curr_Factors:  [98.58013878]
mat_Sqrt:  [[0.15]]
grads:  [0.04863023]
Stock Position:  0.048630225916833476
Bond Position:  [25.25970859]


portfolio before change:  [30.00695147]
curr_Stock_Price:  97.35940528967643
curr_Factors:  [97.35940529]
mat_Sqrt:  [[0.15]]
grads:  [0.1205818]
Stock Position:  0.12058179772519771
Bond Position:  [18.26717936]


portfolio before change:  [30.14589119]
curr_Stock_Price:  98.43588487882737
curr_Factors:  [98.43588488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10953884]
Stock Position:  -0.10953883985437746
Bond Position:  [40.92844382]


portfolio before change:  [30.25416766]
curr_Stock_Price:  97.6342775722709
curr_Factors:  [97.63427757]
mat_Sqrt:  [[0.15]]
grads:  [0.01385821]
Stock Position:  0.013858214433657189
Bond Position:  [28.90113091]


portfolio before change:  [30.25372116]
curr_Stock_Price:  96.55905399349389
curr_Factors:  [96.55905399]
mat_Sqrt:  [[0.15]]
grads:  [0.05683361]
Stock Position:  0.056833612819068756
Bond Position:  [24.76592128]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.25372116]
Stock Price:  96.54965286325353
PL:  [30.25372116]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.00496914]
 [ 0.00308124]
 [ 0.00900854]
 [ 0.00250222]
 [ 0.0133813 ]
 [ 0.01802593]
 [-0.00937248]
 [ 0.01249632]
 [ 0.00730327]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.38652787]
curr_Stock_Price:  100.64926019418803
curr_Factors:  [100.64926019]
mat_Sqrt:  [[0.15]]
grads:  [0.0331276]
Stock Position:  0.03312760219488976
Bond Position:  [8.05225921]


portfolio before change:  [11.41164539]
curr_Stock_Price:  101.28590115048051
curr_Factors:  [101.28590115]
mat_Sqrt:  [[0.15]]
grads:  [0.02054159]
Stock Position:  0.020541593806762938
Bond Position:  [9.33107155]


portfolio before change:  [11.4138067]
curr_Stock_Price:  101.16393429600969
curr_Factors:  [101.1639343]
mat_Sqrt:  [[0.15]]
grads:  [0.06005694]
Stock Position:  0.06005694189420433
Bond Position:  [5.33821018]


portfolio before change:  [11.43513052]
curr_Stock_Price:  101.4745402638449
curr_Factors:  [101.47454026]
mat_Sqrt:  [[0.15]]
grads:  [0.01668143]
Stock Position:  0.016681434405306762
Bond Position:  [9.74238963]


portfolio before change:  [11.45481801]
curr_Stock_Price:  102.36265823625486
curr_Factors:  [102.36265824]
mat_Sqrt:  [[0.15]]
grads:  [0.08920866]
Stock Position:  0.08920865695168013
Bond Position:  [2.32318275]


portfolio before change:  [11.32184594]
curr_Stock_Price:  100.85906026522211
curr_Factors:  [100.85906027]
mat_Sqrt:  [[0.15]]
grads:  [0.12017285]
Stock Position:  0.12017284649695792
Bond Position:  [-0.79867443]


portfolio before change:  [11.1293859]
curr_Stock_Price:  99.26085727327958
curr_Factors:  [99.26085727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0624832]
Stock Position:  -0.062483197351467956
Bond Position:  [17.33152163]


portfolio before change:  [11.00815262]
curr_Stock_Price:  101.33983545253513
curr_Factors:  [101.33983545]
mat_Sqrt:  [[0.15]]
grads:  [0.08330879]
Stock Position:  0.08330878844512161
Bond Position:  [2.56565371]


portfolio before change:  [11.11681094]
curr_Stock_Price:  102.62871709190988
curr_Factors:  [102.62871709]
mat_Sqrt:  [[0.15]]
grads:  [0.0486885]
Stock Position:  0.04868849859429827
Bond Position:  [6.11997279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.11681094]
Stock Price:  101.04584299827023
PL:  [10.07096794]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00338844]
 [-0.00549377]
 [ 0.03663876]
 [ 0.00440233]
 [ 0.01166683]
 [ 0.0163922 ]
 [ 0.01434985]
 [ 0.01245321]
 [ 0.00745622]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.35442413]
curr_Stock_Price:  99.93364006161075
curr_Factors:  [99.93364006]
mat_Sqrt:  [[0.15]]
grads:  [-0.02258958]
Stock Position:  -0.022589584122397408
Bond Position:  [2.6118835]


portfolio before change:  [0.33941379]
curr_Stock_Price:  100.6559468665478
curr_Factors:  [100.65594687]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662512]
Stock Position:  -0.036625123923612626
Bond Position:  [4.02595032]


portfolio before change:  [0.28379843]
curr_Stock_Price:  102.22942520802677
curr_Factors:  [102.22942521]
mat_Sqrt:  [[0.15]]
grads:  [0.24425838]
Stock Position:  0.24425837888579416
Bond Position:  [-24.68659525]


portfolio before change:  [-0.12157679]
curr_Stock_Price:  100.6203551783558
curr_Factors:  [100.62035518]
mat_Sqrt:  [[0.15]]
grads:  [0.02934887]
Stock Position:  0.029348871295404266
Bond Position:  [-3.07467065]


portfolio before change:  [-0.05769899]
curr_Stock_Price:  102.849249145884
curr_Factors:  [102.84924915]
mat_Sqrt:  [[0.15]]
grads:  [0.07777889]
Stock Position:  0.07777888744734186
Bond Position:  [-8.05719916]


portfolio before change:  [0.04589383]
curr_Stock_Price:  104.23294635775471
curr_Factors:  [104.23294636]
mat_Sqrt:  [[0.15]]
grads:  [0.10928131]
Stock Position:  0.10928130851800671
Bond Position:  [-11.34481893]


portfolio before change:  [-0.14113176]
curr_Stock_Price:  102.57345155853055
curr_Factors:  [102.57345156]
mat_Sqrt:  [[0.15]]
grads:  [0.09566566]
Stock Position:  0.09566566122815269
Bond Position:  [-9.95388883]


portfolio before change:  [-0.23105116]
curr_Stock_Price:  101.68555495724247
curr_Factors:  [101.68555496]
mat_Sqrt:  [[0.15]]
grads:  [0.08302139]
Stock Position:  0.08302138548497404
Bond Position:  [-8.67312682]


portfolio before change:  [-0.21275399]
curr_Stock_Price:  101.95819335877262
curr_Factors:  [101.95819336]
mat_Sqrt:  [[0.15]]
grads:  [0.04970811]
Stock Position:  0.049708105387560236
Bond Position:  [-5.28090261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.21275399]
Stock Price:  101.79729993044843
PL:  [-2.01005392]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.99955933e-03]
 [-1.63078517e-02]
 [ 4.54384311e-02]
 [ 1.94929637e-03]
 [ 7.37072418e-03]
 [ 1.67651037e-02]
 [ 2.46358026e-02]
 [ 7.50711089e-03]
 [ 6.60337313e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.10117977]
curr_Stock_Price:  99.64461813703522
curr_Factors:  [99.64461814]
mat_Sqrt:  [[0.15]]
grads:  [-0.02666373]
Stock Position:  -0.02666372886601649
Bond Position:  [-1.44428269]


portfolio before change:  [-4.1190374]
curr_Stock_Price:  100.2872630240142
curr_Factors:  [100.28726302]
mat_Sqrt:  [[0.15]]
grads:  [-0.10871901]
Stock Position:  -0.10871901156205302
Bond Position:  [6.78409471]


portfolio before change:  [-4.37099232]
curr_Stock_Price:  102.63595815376843
curr_Factors:  [102.63595815]
mat_Sqrt:  [[0.15]]
grads:  [0.30292287]
Stock Position:  0.3029228741890409
Bond Position:  [-35.46177176]


portfolio before change:  [-4.58144864]
curr_Stock_Price:  101.99975328367196
curr_Factors:  [101.99975328]
mat_Sqrt:  [[0.15]]
grads:  [0.01299531]
Stock Position:  0.012995309139451107
Bond Position:  [-5.90696697]


portfolio before change:  [-4.55451454]
curr_Stock_Price:  104.29968548029564
curr_Factors:  [104.29968548]
mat_Sqrt:  [[0.15]]
grads:  [0.04913816]
Stock Position:  0.04913816121586907
Bond Position:  [-9.6796093]


portfolio before change:  [-4.61387578]
curr_Stock_Price:  103.1901561473629
curr_Factors:  [103.19015615]
mat_Sqrt:  [[0.15]]
grads:  [0.11176736]
Stock Position:  0.11176735777868414
Bond Position:  [-16.14716688]


portfolio before change:  [-4.4854258]
curr_Stock_Price:  104.41167182804054
curr_Factors:  [104.41167183]
mat_Sqrt:  [[0.15]]
grads:  [0.16423868]
Stock Position:  0.16423868431806732
Bond Position:  [-21.63386141]


portfolio before change:  [-4.66327304]
curr_Stock_Price:  103.39469093477541
curr_Factors:  [103.39469093]
mat_Sqrt:  [[0.15]]
grads:  [0.05004741]
Stock Position:  0.050047405964363176
Bond Position:  [-9.83790911]


portfolio before change:  [-4.61889109]
curr_Stock_Price:  104.3797995992904
curr_Factors:  [104.3797996]
mat_Sqrt:  [[0.15]]
grads:  [0.04402249]
Stock Position:  0.04402248755594905
Bond Position:  [-9.21394952]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.61889109]
Stock Price:  108.44775018842067
PL:  [-13.06664128]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01861617]
 [-0.01497902]
 [-0.03553082]
 [-0.0128411 ]
 [-0.00264867]
 [ 0.0170934 ]
 [-0.0303571 ]
 [ 0.00469732]
 [ 0.00845593]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.30655067]
curr_Stock_Price:  98.65829043368319
curr_Factors:  [98.65829043]
mat_Sqrt:  [[0.15]]
grads:  [0.12410781]
Stock Position:  0.12410780622748088
Bond Position:  [-31.55081466]


portfolio before change:  [-19.51278288]
curr_Stock_Price:  97.123714471792
curr_Factors:  [97.12371447]
mat_Sqrt:  [[0.15]]
grads:  [-0.09986016]
Stock Position:  -0.09986016262146455
Bond Position:  [-9.81399296]


portfolio before change:  [-19.43259899]
curr_Stock_Price:  96.27160181234791
curr_Factors:  [96.27160181]
mat_Sqrt:  [[0.15]]
grads:  [-0.23687217]
Stock Position:  -0.2368721658059823
Bond Position:  [3.37146383]


portfolio before change:  [-18.80456556]
curr_Stock_Price:  93.62736003909427
curr_Factors:  [93.62736004]
mat_Sqrt:  [[0.15]]
grads:  [-0.08560731]
Stock Position:  -0.08560730795185252
Bond Position:  [-10.78937932]


portfolio before change:  [-19.04253759]
curr_Stock_Price:  96.34413726617598
curr_Factors:  [96.34413727]
mat_Sqrt:  [[0.15]]
grads:  [-0.01765779]
Stock Position:  -0.017657794963411324
Bond Position:  [-17.34131256]


portfolio before change:  [-19.03593963]
curr_Stock_Price:  95.47931925452576
curr_Factors:  [95.47931925]
mat_Sqrt:  [[0.15]]
grads:  [0.11395602]
Stock Position:  0.11395601881215828
Bond Position:  [-29.91638273]


portfolio before change:  [-18.91940727]
curr_Stock_Price:  96.63322312003568
curr_Factors:  [96.63322312]
mat_Sqrt:  [[0.15]]
grads:  [-0.20238064]
Stock Position:  -0.20238063640508977
Bond Position:  [0.63728592]


portfolio before change:  [-19.40310833]
curr_Stock_Price:  99.02485401491
curr_Factors:  [99.02485401]
mat_Sqrt:  [[0.15]]
grads:  [0.03131546]
Stock Position:  0.03131545763696288
Bond Position:  [-22.50411695]


portfolio before change:  [-19.46334464]
curr_Stock_Price:  97.46072433118495
curr_Factors:  [97.46072433]
mat_Sqrt:  [[0.15]]
grads:  [0.05637283]
Stock Position:  0.05637283407803778
Bond Position:  [-24.95748188]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.46334464]
Stock Price:  95.28791028946486
PL:  [-19.46334464]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00465018]
 [ 0.00281304]
 [ 0.02321611]
 [ 0.00246524]
 [ 0.01052044]
 [ 0.01751961]
 [-0.00292521]
 [ 0.00833694]
 [ 0.00693931]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.47685316]
curr_Stock_Price:  99.74998342791646
curr_Factors:  [99.74998343]
mat_Sqrt:  [[0.15]]
grads:  [-0.0310012]
Stock Position:  -0.031001203361222217
Bond Position:  [0.61551636]


portfolio before change:  [-2.5364224]
curr_Stock_Price:  101.68142673863649
curr_Factors:  [101.68142674]
mat_Sqrt:  [[0.15]]
grads:  [0.01875359]
Stock Position:  0.018753593865922978
Bond Position:  [-4.44331458]


portfolio before change:  [-2.53834885]
curr_Stock_Price:  101.6971974109059
curr_Factors:  [101.69719741]
mat_Sqrt:  [[0.15]]
grads:  [0.15477404]
Stock Position:  0.15477404459914149
Bond Position:  [-18.27843542]


portfolio before change:  [-2.57761638]
curr_Stock_Price:  101.50255219298872
curr_Factors:  [101.50255219]
mat_Sqrt:  [[0.15]]
grads:  [0.01643494]
Stock Position:  0.01643493571415521
Bond Position:  [-4.2458043]


portfolio before change:  [-2.54652524]
curr_Stock_Price:  103.52352610226441
curr_Factors:  [103.5235261]
mat_Sqrt:  [[0.15]]
grads:  [0.0701363]
Stock Position:  0.07013629805322477
Bond Position:  [-9.80728212]


portfolio before change:  [-2.6775243]
curr_Stock_Price:  101.72568105917118
curr_Factors:  [101.72568106]
mat_Sqrt:  [[0.15]]
grads:  [0.11679742]
Stock Position:  0.11679742338470597
Bond Position:  [-14.55882174]


portfolio before change:  [-2.89379275]
curr_Stock_Price:  99.93636744330294
curr_Factors:  [99.93636744]
mat_Sqrt:  [[0.15]]
grads:  [-0.0195014]
Stock Position:  -0.019501396356670933
Bond Position:  [-0.94489404]


portfolio before change:  [-2.95607957]
curr_Stock_Price:  103.10610188038216
curr_Factors:  [103.10610188]
mat_Sqrt:  [[0.15]]
grads:  [0.05557961]
Stock Position:  0.05557961130674984
Bond Position:  [-8.68667663]


portfolio before change:  [-2.9361335]
curr_Stock_Price:  103.54314145863343
curr_Factors:  [103.54314146]
mat_Sqrt:  [[0.15]]
grads:  [0.04626204]
Stock Position:  0.0462620414033364
Bond Position:  [-7.7262506]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.9361335]
Stock Price:  103.07162679583267
PL:  [-6.0077603]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.39157771e-03]
 [-1.87314526e-02]
 [-9.87466120e-03]
 [ 1.40446443e-03]
 [ 7.89593519e-03]
 [ 1.85657563e-02]
 [-1.38068589e-02]
 [ 6.62869283e-03]
 [ 8.49128115e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.3482585]
curr_Stock_Price:  99.93324011547998
curr_Factors:  [99.93324012]
mat_Sqrt:  [[0.15]]
grads:  [-0.02261052]
Stock Position:  -0.022610518087864233
Bond Position:  [2.60780084]


portfolio before change:  [0.37467871]
curr_Stock_Price:  98.82243065056457
curr_Factors:  [98.82243065]
mat_Sqrt:  [[0.15]]
grads:  [-0.12487635]
Stock Position:  -0.12487635035303031
Bond Position:  [12.71526318]


portfolio before change:  [0.30693103]
curr_Stock_Price:  99.41587290696957
curr_Factors:  [99.41587291]
mat_Sqrt:  [[0.15]]
grads:  [-0.06583107]
Stock Position:  -0.06583107467163155
Bond Position:  [6.85158478]


portfolio before change:  [0.37842379]
curr_Stock_Price:  98.38192180900946
curr_Factors:  [98.38192181]
mat_Sqrt:  [[0.15]]
grads:  [0.0093631]
Stock Position:  0.009363096176439057
Bond Position:  [-0.54273561]


portfolio before change:  [0.38206829]
curr_Stock_Price:  98.80015338487156
curr_Factors:  [98.80015338]
mat_Sqrt:  [[0.15]]
grads:  [0.05263957]
Stock Position:  0.052639567905048
Bond Position:  [-4.81872909]


portfolio before change:  [0.38990174]
curr_Stock_Price:  98.99474875176797
curr_Factors:  [98.99474875]
mat_Sqrt:  [[0.15]]
grads:  [0.12377171]
Stock Position:  0.12377170869007734
Bond Position:  [-11.86284746]


portfolio before change:  [0.35727115]
curr_Stock_Price:  98.77904772344793
curr_Factors:  [98.77904772]
mat_Sqrt:  [[0.15]]
grads:  [-0.09204573]
Stock Position:  -0.09204572625168288
Bond Position:  [9.44946034]


portfolio before change:  [0.29824394]
curr_Stock_Price:  99.47167217925586
curr_Factors:  [99.47167218]
mat_Sqrt:  [[0.15]]
grads:  [0.04419129]
Stock Position:  0.0441912855526387
Bond Position:  [-4.09753713]


portfolio before change:  [0.24119895]
curr_Stock_Price:  98.22718004872637
curr_Factors:  [98.22718005]
mat_Sqrt:  [[0.15]]
grads:  [0.05660854]
Stock Position:  0.05660854102060152
Bond Position:  [-5.3192984]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.24119895]
Stock Price:  97.02046214299953
PL:  [0.24119895]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00382821]
 [ 0.00340078]
 [ 0.09393818]
 [ 0.00578091]
 [ 0.01003785]
 [ 0.01817125]
 [ 0.00596365]
 [ 0.01214829]
 [ 0.00805123]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.49422896]
curr_Stock_Price:  100.3319111485306
curr_Factors:  [100.33191115]
mat_Sqrt:  [[0.15]]
grads:  [-0.02552143]
Stock Position:  -0.025521430322815487
Bond Position:  [9.05484284]


portfolio before change:  [6.47330556]
curr_Stock_Price:  101.32918880851548
curr_Factors:  [101.32918881]
mat_Sqrt:  [[0.15]]
grads:  [0.02267189]
Stock Position:  0.022671891774219678
Bond Position:  [4.17598116]


portfolio before change:  [6.55582015]
curr_Stock_Price:  104.87658028770495
curr_Factors:  [104.87658029]
mat_Sqrt:  [[0.15]]
grads:  [0.62625452]
Stock Position:  0.6262545205648994
Bond Position:  [-59.12361236]


portfolio before change:  [6.00410983]
curr_Stock_Price:  104.04282802594088
curr_Factors:  [104.04282803]
mat_Sqrt:  [[0.15]]
grads:  [0.03853937]
Stock Position:  0.03853937307667963
Bond Position:  [1.99436446]


portfolio before change:  [5.8379104]
curr_Stock_Price:  99.70448901801478
curr_Factors:  [99.70448902]
mat_Sqrt:  [[0.15]]
grads:  [0.06691897]
Stock Position:  0.06691897082248045
Bond Position:  [-0.8342114]


portfolio before change:  [5.89177345]
curr_Stock_Price:  100.5156232620307
curr_Factors:  [100.51562326]
mat_Sqrt:  [[0.15]]
grads:  [0.12114164]
Stock Position:  0.12114163881174554
Bond Position:  [-6.28485387]


portfolio before change:  [5.9674969]
curr_Stock_Price:  101.16665175349165
curr_Factors:  [101.16665175]
mat_Sqrt:  [[0.15]]
grads:  [0.03975765]
Stock Position:  0.03975764617905213
Bond Position:  [1.94534895]


portfolio before change:  [5.95659552]
curr_Stock_Price:  100.86798461896792
curr_Factors:  [100.86798462]
mat_Sqrt:  [[0.15]]
grads:  [0.0809886]
Stock Position:  0.08098860274349368
Bond Position:  [-2.21256162]


portfolio before change:  [5.96344484]
curr_Stock_Price:  100.96621921544732
curr_Factors:  [100.96621922]
mat_Sqrt:  [[0.15]]
grads:  [0.05367487]
Stock Position:  0.05367487315957552
Bond Position:  [0.54409583]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.96344484]
Stock Price:  100.0276759199233
PL:  [5.93576892]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.0048602 ]
 [-0.02608349]
 [-0.01153635]
 [ 0.00238516]
 [ 0.00789141]
 [ 0.01818925]
 [-0.02285889]
 [ 0.00516389]
 [ 0.00760055]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.95984266]
curr_Stock_Price:  100.1026459007034
curr_Factors:  [100.1026459]
mat_Sqrt:  [[0.15]]
grads:  [-0.03240134]
Stock Position:  -0.032401338962605435
Bond Position:  [6.20330242]


portfolio before change:  [2.9754858]
curr_Stock_Price:  99.71560275831395
curr_Factors:  [99.71560276]
mat_Sqrt:  [[0.15]]
grads:  [-0.17388992]
Stock Position:  -0.17388991535680756
Bond Position:  [20.31502352]


portfolio before change:  [2.87670919]
curr_Stock_Price:  100.34207186547303
curr_Factors:  [100.34207187]
mat_Sqrt:  [[0.15]]
grads:  [-0.07690899]
Stock Position:  -0.07690898909143788
Bond Position:  [10.5939165]


portfolio before change:  [2.98780697]
curr_Stock_Price:  98.96642639825909
curr_Factors:  [98.9664264]
mat_Sqrt:  [[0.15]]
grads:  [0.01590106]
Stock Position:  0.015901060364554947
Bond Position:  [1.41413585]


portfolio before change:  [2.985844]
curr_Stock_Price:  98.79849957562088
curr_Factors:  [98.79849958]
mat_Sqrt:  [[0.15]]
grads:  [0.05260943]
Stock Position:  0.05260943041984449
Bond Position:  [-2.21188878]


portfolio before change:  [3.07180597]
curr_Stock_Price:  100.45349161863177
curr_Factors:  [100.45349162]
mat_Sqrt:  [[0.15]]
grads:  [0.1212617]
Stock Position:  0.1212616963323564
Bond Position:  [-9.10935482]


portfolio before change:  [2.74733857]
curr_Stock_Price:  97.8153000176061
curr_Factors:  [97.81530002]
mat_Sqrt:  [[0.15]]
grads:  [-0.15239259]
Stock Position:  -0.15239258948035375
Bond Position:  [17.65366543]


portfolio before change:  [2.55628142]
curr_Stock_Price:  99.12695293511226
curr_Factors:  [99.12695294]
mat_Sqrt:  [[0.15]]
grads:  [0.03442593]
Stock Position:  0.03442593037430783
Bond Position:  [-0.85625616]


portfolio before change:  [2.64421332]
curr_Stock_Price:  101.69362669107967
curr_Factors:  [101.69362669]
mat_Sqrt:  [[0.15]]
grads:  [0.05067032]
Stock Position:  0.050670319133731226
Bond Position:  [-2.5086352]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.64421332]
Stock Price:  102.52993636559313
PL:  [0.11427695]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.01368738]
 [0.0027293 ]
 [0.04803107]
 [0.01024238]
 [0.0051788 ]
 [0.01632324]
 [0.02235693]
 [0.00451141]
 [0.00675881]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.00708213]
curr_Stock_Price:  101.01384902378645
curr_Factors:  [101.01384902]
mat_Sqrt:  [[0.15]]
grads:  [0.09124919]
Stock Position:  0.09124918743800284
Bond Position:  [7.78965049]


portfolio before change:  [17.07966294]
curr_Stock_Price:  101.76656814890029
curr_Factors:  [101.76656815]
mat_Sqrt:  [[0.15]]
grads:  [0.01819533]
Stock Position:  0.018195334254786494
Bond Position:  [15.22798622]


portfolio before change:  [17.10527705]
curr_Stock_Price:  102.75573439824142
curr_Factors:  [102.7557344]
mat_Sqrt:  [[0.15]]
grads:  [0.32020711]
Stock Position:  0.32020711401493673
Bond Position:  [-15.79784011]


portfolio before change:  [18.0274325]
curr_Stock_Price:  105.66028056484795
curr_Factors:  [105.66028056]
mat_Sqrt:  [[0.15]]
grads:  [0.06828256]
Stock Position:  0.06828256089230895
Bond Position:  [10.81267796]


portfolio before change:  [17.9680937]
curr_Stock_Price:  104.71206640375803
curr_Factors:  [104.7120664]
mat_Sqrt:  [[0.15]]
grads:  [0.03452533]
Stock Position:  0.03452532884039681
Bond Position:  [14.35287517]


portfolio before change:  [17.96538796]
curr_Stock_Price:  104.42578463596831
curr_Factors:  [104.42578464]
mat_Sqrt:  [[0.15]]
grads:  [0.10882158]
Stock Position:  0.1088215751467056
Bond Position:  [6.60160959]


portfolio before change:  [17.9239718]
curr_Stock_Price:  104.01485699985138
curr_Factors:  [104.014857]
mat_Sqrt:  [[0.15]]
grads:  [0.14904619]
Stock Position:  0.1490461852467546
Bond Position:  [2.42095415]


portfolio before change:  [18.03958497]
curr_Stock_Price:  104.78242037871301
curr_Factors:  [104.78242038]
mat_Sqrt:  [[0.15]]
grads:  [0.03007603]
Stock Position:  0.03007603364949526
Bond Position:  [14.88814537]


portfolio before change:  [18.02327849]
curr_Stock_Price:  103.99267476484879
curr_Factors:  [103.99267476]
mat_Sqrt:  [[0.15]]
grads:  [0.04505874]
Stock Position:  0.045058737453323026
Bond Position:  [13.33749986]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.02327849]
Stock Price:  103.29014950364714
PL:  [14.73312898]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.80521277e-02]
 [-1.75031083e-02]
 [ 2.94027845e-02]
 [ 1.89912891e-03]
 [ 1.54345035e-02]
 [ 1.83073467e-02]
 [-2.88709811e-02]
 [-1.11763134e-03]
 [ 8.47585725e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.6475986]
curr_Stock_Price:  98.8956358964746
curr_Factors:  [98.8956359]
mat_Sqrt:  [[0.15]]
grads:  [0.12034752]
Stock Position:  0.12034751813783533
Bond Position:  [-27.54944293]


portfolio before change:  [-15.49880203]
curr_Stock_Price:  100.24651321827794
curr_Factors:  [100.24651322]
mat_Sqrt:  [[0.15]]
grads:  [-0.11668739]
Stock Position:  -0.11668738873814496
Bond Position:  [-3.80129817]


portfolio before change:  [-15.69707559]
curr_Stock_Price:  101.92940658808445
curr_Factors:  [101.92940659]
mat_Sqrt:  [[0.15]]
grads:  [0.19601856]
Stock Position:  0.1960185632419317
Bond Position:  [-35.67713142]


portfolio before change:  [-15.713933]
curr_Stock_Price:  101.93443477826598
curr_Factors:  [101.93443478]
mat_Sqrt:  [[0.15]]
grads:  [0.01266086]
Stock Position:  0.012660859382349477
Bond Position:  [-17.00451054]


portfolio before change:  [-15.73201137]
curr_Stock_Price:  101.17824639353987
curr_Factors:  [101.17824639]
mat_Sqrt:  [[0.15]]
grads:  [0.10289669]
Stock Position:  0.10289669029808404
Bond Position:  [-26.14291806]


portfolio before change:  [-15.86158422]
curr_Stock_Price:  100.04606110245771
curr_Factors:  [100.0460611]
mat_Sqrt:  [[0.15]]
grads:  [0.12204898]
Stock Position:  0.12204897789964073
Bond Position:  [-28.07210372]


portfolio before change:  [-16.26199349]
curr_Stock_Price:  96.880367142029
curr_Factors:  [96.88036714]
mat_Sqrt:  [[0.15]]
grads:  [-0.19247321]
Stock Position:  -0.19247320701142367
Bond Position:  [2.38488147]


portfolio before change:  [-16.15701072]
curr_Stock_Price:  96.341123105516
curr_Factors:  [96.34112311]
mat_Sqrt:  [[0.15]]
grads:  [-0.00745088]
Stock Position:  -0.007450875632562577
Bond Position:  [-15.439185]


portfolio before change:  [-16.18238474]
curr_Stock_Price:  98.71030674053739
curr_Factors:  [98.71030674]
mat_Sqrt:  [[0.15]]
grads:  [0.05650572]
Stock Position:  0.0565057150233788
Bond Position:  [-21.7600812]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.18238474]
Stock Price:  99.92541011146163
PL:  [-16.18238474]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01803595]
 [-0.02554972]
 [-0.00991458]
 [ 0.00398627]
 [ 0.01460926]
 [ 0.01852953]
 [-0.00738527]
 [ 0.00241686]
 [ 0.00851406]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-22.29779198]
curr_Stock_Price:  98.46425740473174
curr_Factors:  [98.4642574]
mat_Sqrt:  [[0.15]]
grads:  [0.12023965]
Stock Position:  0.12023965413706673
Bond Position:  [-34.13710024]


portfolio before change:  [-22.16997805]
curr_Stock_Price:  99.66924047806428
curr_Factors:  [99.66924048]
mat_Sqrt:  [[0.15]]
grads:  [-0.17033148]
Stock Position:  -0.17033148272538753
Bond Position:  [-5.19316854]


portfolio before change:  [-22.10109276]
curr_Stock_Price:  99.24957337992059
curr_Factors:  [99.24957338]
mat_Sqrt:  [[0.15]]
grads:  [-0.06609723]
Stock Position:  -0.06609722566327625
Bond Position:  [-15.54097132]


portfolio before change:  [-22.13112427]
curr_Stock_Price:  99.5863360269401
curr_Factors:  [99.58633603]
mat_Sqrt:  [[0.15]]
grads:  [0.02657511]
Stock Position:  0.0265751114983348
Bond Position:  [-24.77764225]


portfolio before change:  [-22.12449078]
curr_Stock_Price:  100.30224669028276
curr_Factors:  [100.30224669]
mat_Sqrt:  [[0.15]]
grads:  [0.09739509]
Stock Position:  0.09739508705915273
Bond Position:  [-31.89343683]


portfolio before change:  [-22.33214169]
curr_Stock_Price:  98.333972867466
curr_Factors:  [98.33397287]
mat_Sqrt:  [[0.15]]
grads:  [0.12353023]
Stock Position:  0.12353023317230419
Bond Position:  [-34.47936029]


portfolio before change:  [-22.21965533]
curr_Stock_Price:  99.38416399553589
curr_Factors:  [99.384164]
mat_Sqrt:  [[0.15]]
grads:  [-0.04923514]
Stock Position:  -0.04923513601484588
Bond Position:  [-17.32646249]


portfolio before change:  [-22.15044514]
curr_Stock_Price:  97.80245649970003
curr_Factors:  [97.8024565]
mat_Sqrt:  [[0.15]]
grads:  [0.01611241]
Stock Position:  0.016112412380097786
Bond Position:  [-23.72627865]


portfolio before change:  [-22.1769847]
curr_Stock_Price:  96.89176392536675
curr_Factors:  [96.89176393]
mat_Sqrt:  [[0.15]]
grads:  [0.05676039]
Stock Position:  0.056760389494330744
Bond Position:  [-27.67659896]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-22.1769847]
Stock Price:  96.73160056341464
PL:  [-22.1769847]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.36852813e-02]
 [ 2.78863052e-03]
 [ 2.99796965e-02]
 [ 5.45519053e-03]
 [ 6.67906179e-04]
 [ 1.52003829e-02]
 [ 3.89400687e-02]
 [-9.96168406e-05]
 [ 6.13338733e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.00408575]
curr_Stock_Price:  101.01365465734682
curr_Factors:  [101.01365466]
mat_Sqrt:  [[0.15]]
grads:  [0.09123521]
Stock Position:  0.09123520854807661
Bond Position:  [7.7880839]


portfolio before change:  [17.07116931]
curr_Stock_Price:  101.70624409478404
curr_Factors:  [101.70624409]
mat_Sqrt:  [[0.15]]
grads:  [0.01859087]
Stock Position:  0.01859087013901469
Bond Position:  [15.18036173]


portfolio before change:  [17.08331273]
curr_Stock_Price:  101.95106025497256
curr_Factors:  [101.95106025]
mat_Sqrt:  [[0.15]]
grads:  [0.19986464]
Stock Position:  0.19986464322250436
Bond Position:  [-3.29309955]


portfolio before change:  [17.47613537]
curr_Stock_Price:  103.92474401181697
curr_Factors:  [103.92474401]
mat_Sqrt:  [[0.15]]
grads:  [0.03636794]
Stock Position:  0.036367936867191836
Bond Position:  [13.69660684]


portfolio before change:  [17.54248281]
curr_Stock_Price:  105.56072974921435
curr_Factors:  [105.56072975]
mat_Sqrt:  [[0.15]]
grads:  [0.00445271]
Stock Position:  0.004452707861140731
Bond Position:  [17.07245172]


portfolio before change:  [17.55862793]
curr_Stock_Price:  107.26907358515672
curr_Factors:  [107.26907359]
mat_Sqrt:  [[0.15]]
grads:  [0.10133589]
Stock Position:  0.10133588623488184
Bond Position:  [6.68842129]


portfolio before change:  [17.52481966]
curr_Stock_Price:  106.90243820494224
curr_Factors:  [106.9024382]
mat_Sqrt:  [[0.15]]
grads:  [0.25960046]
Stock Position:  0.2596004580718859
Bond Position:  [-10.22710227]


portfolio before change:  [17.41960471]
curr_Stock_Price:  106.51684522465938
curr_Factors:  [106.51684522]
mat_Sqrt:  [[0.15]]
grads:  [-0.00066411]
Stock Position:  -0.00066411227086638
Bond Position:  [17.49034386]


portfolio before change:  [17.42893074]
curr_Stock_Price:  105.64549939254722
curr_Factors:  [105.64549939]
mat_Sqrt:  [[0.15]]
grads:  [0.04088925]
Stock Position:  0.040889248848605377
Bond Position:  [13.10916563]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.42893074]
Stock Price:  104.33483800382488
PL:  [13.09409274]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[2.31242175e+00]
 [4.95470078e-02]
 [1.60977650e-03]
 [8.75697502e-02]
 [3.96131381e-03]
 [5.31830802e-03]
 [1.59243491e-02]
 [3.96985085e-02]
 [5.20983864e-03]
 [6.24626866e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [31.47193013]
curr_Stock_Price:  101.9521411835141
curr_Factors:  [101.95214118]
mat_Sqrt:  [[0.15]]
grads:  [0.33031339]
Stock Position:  0.3303133853385366
Bond Position:  [-2.20422677]


portfolio before change:  [31.78551747]
curr_Stock_Price:  102.90484168340888
curr_Factors:  [102.90484168]
mat_Sqrt:  [[0.15]]
grads:  [0.01073184]
Stock Position:  0.010731843354509982
Bond Position:  [30.68115883]


portfolio before change:  [31.81886483]
curr_Stock_Price:  104.58236760671042
curr_Factors:  [104.58236761]
mat_Sqrt:  [[0.15]]
grads:  [0.58379833]
Stock Position:  0.5837983343611635
Bond Position:  [-29.23614718]


portfolio before change:  [31.10414646]
curr_Stock_Price:  103.38315788260363
curr_Factors:  [103.38315788]
mat_Sqrt:  [[0.15]]
grads:  [0.02640876]
Stock Position:  0.02640875873240884
Bond Position:  [28.37392559]


portfolio before change:  [31.15273865]
curr_Stock_Price:  104.68581973538984
curr_Factors:  [104.68581974]
mat_Sqrt:  [[0.15]]
grads:  [0.03545539]
Stock Position:  0.03545538681218384
Bond Position:  [27.44106242]


portfolio before change:  [31.19534722]
curr_Stock_Price:  105.50049445222729
curr_Factors:  [105.50049445]
mat_Sqrt:  [[0.15]]
grads:  [0.10616233]
Stock Position:  0.1061623273852339
Bond Position:  [19.99516919]


portfolio before change:  [31.36820127]
curr_Stock_Price:  107.034503449001
curr_Factors:  [107.03450345]
mat_Sqrt:  [[0.15]]
grads:  [0.26465672]
Stock Position:  0.26465672350146
Bond Position:  [3.04080029]


portfolio before change:  [30.66919163]
curr_Stock_Price:  104.387563632403
curr_Factors:  [104.38756363]
mat_Sqrt:  [[0.15]]
grads:  [0.03473226]
Stock Position:  0.034732257581482066
Bond Position:  [27.04357588]


portfolio before change:  [30.71524997]
curr_Stock_Price:  105.32424828804643
curr_Factors:  [105.32424829]
mat_Sqrt:  [[0.15]]
grads:  [0.04164179]
Stock Position:  0.04164179105140421
Bond Position:  [26.32935963]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.71524997]
Stock Price:  104.63944867667126
PL:  [26.0758013]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.75424762e-03]
 [ 3.25107902e-03]
 [ 1.56105645e-02]
 [ 6.78527116e-03]
 [ 8.14238172e-04]
 [ 1.60083586e-02]
 [ 4.38629389e-02]
 [ 1.02127984e-03]
 [ 5.38702097e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.34165509]
curr_Stock_Price:  100.06254589108198
curr_Factors:  [100.06254589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02502832]
Stock Position:  -0.025028317458243694
Bond Position:  [4.84605226]


portfolio before change:  [2.3088546]
curr_Stock_Price:  101.46991657659709
curr_Factors:  [101.46991658]
mat_Sqrt:  [[0.15]]
grads:  [0.02167386]
Stock Position:  0.021673860134121883
Bond Position:  [0.10960982]


portfolio before change:  [2.30764836]
curr_Stock_Price:  101.41173294102228
curr_Factors:  [101.41173294]
mat_Sqrt:  [[0.15]]
grads:  [0.10407043]
Stock Position:  0.1040704298969696
Bond Position:  [-8.24631429]


portfolio before change:  [2.61523748]
curr_Stock_Price:  104.40694793764312
curr_Factors:  [104.40694794]
mat_Sqrt:  [[0.15]]
grads:  [0.04523514]
Stock Position:  0.04523514105790745
Bond Position:  [-2.10762553]


portfolio before change:  [2.66512955]
curr_Stock_Price:  105.53319937003432
curr_Factors:  [105.53319937]
mat_Sqrt:  [[0.15]]
grads:  [0.00542825]
Stock Position:  0.0054282544815156125
Bond Position:  [2.09226849]


portfolio before change:  [2.66488439]
curr_Stock_Price:  105.29526742496934
curr_Factors:  [105.29526742]
mat_Sqrt:  [[0.15]]
grads:  [0.10672239]
Stock Position:  0.10672239063096575
Bond Position:  [-8.57247827]


portfolio before change:  [2.92360139]
curr_Stock_Price:  107.75964538828559
curr_Factors:  [107.75964539]
mat_Sqrt:  [[0.15]]
grads:  [0.29241959]
Stock Position:  0.29241959287160135
Bond Position:  [-28.58743025]


portfolio before change:  [2.47517725]
curr_Stock_Price:  106.27504293864185
curr_Factors:  [106.27504294]
mat_Sqrt:  [[0.15]]
grads:  [0.00680853]
Stock Position:  0.006808532261287859
Bond Position:  [1.75160019]


portfolio before change:  [2.48622899]
curr_Stock_Price:  107.76959745651554
curr_Factors:  [107.76959746]
mat_Sqrt:  [[0.15]]
grads:  [0.03591347]
Stock Position:  0.035913473159044945
Bond Position:  [-1.38415155]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.48622899]
Stock Price:  106.66338490426546
PL:  [-4.17715591]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.60708567e-03]
 [-1.97775022e-02]
 [-1.80023740e-02]
 [-3.42348317e-03]
 [ 6.77319320e-03]
 [ 1.83613509e-02]
 [ 2.67089673e-04]
 [ 1.12210941e-02]
 [ 6.99618450e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.3261798]
curr_Stock_Price:  99.7597571659085
curr_Factors:  [99.75975717]
mat_Sqrt:  [[0.15]]
grads:  [-0.0307139]
Stock Position:  -0.030713904494304018
Bond Position:  [0.73783185]


portfolio before change:  [-2.30460593]
curr_Stock_Price:  99.06935779440694
curr_Factors:  [99.06935779]
mat_Sqrt:  [[0.15]]
grads:  [-0.13185001]
Stock Position:  -0.13185001453748416
Bond Position:  [10.75769033]


portfolio before change:  [-2.128803]
curr_Stock_Price:  97.77680772771718
curr_Factors:  [97.77680773]
mat_Sqrt:  [[0.15]]
grads:  [-0.12001583]
Stock Position:  -0.12001582693668125
Bond Position:  [9.60596144]


portfolio before change:  [-1.93345245]
curr_Stock_Price:  96.18913071548532
curr_Factors:  [96.18913072]
mat_Sqrt:  [[0.15]]
grads:  [-0.02282322]
Stock Position:  -0.02282322112889916
Bond Position:  [0.26189335]


portfolio before change:  [-1.983539]
curr_Stock_Price:  98.38941327712791
curr_Factors:  [98.38941328]
mat_Sqrt:  [[0.15]]
grads:  [0.04515462]
Stock Position:  0.04515462131003917
Bond Position:  [-6.4262757]


portfolio before change:  [-1.92003825]
curr_Stock_Price:  99.8668853639816
curr_Factors:  [99.86688536]
mat_Sqrt:  [[0.15]]
grads:  [0.12240901]
Stock Position:  0.12240900575018843
Bond Position:  [-14.1446444]


portfolio before change:  [-1.86818906]
curr_Stock_Price:  100.34824935229445
curr_Factors:  [100.34824935]
mat_Sqrt:  [[0.15]]
grads:  [0.0017806]
Stock Position:  0.0017805978219348948
Bond Position:  [-2.04686893]


portfolio before change:  [-1.86607536]
curr_Stock_Price:  102.11023651787855
curr_Factors:  [102.11023652]
mat_Sqrt:  [[0.15]]
grads:  [0.07480729]
Stock Position:  0.07480729433054387
Bond Position:  [-9.50466587]


portfolio before change:  [-1.7742342]
curr_Stock_Price:  103.40148323561215
curr_Factors:  [103.40148324]
mat_Sqrt:  [[0.15]]
grads:  [0.04664123]
Stock Position:  0.04664122999060362
Bond Position:  [-6.59700656]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.7742342]
Stock Price:  105.83731323760155
PL:  [-7.61154744]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 9.28815141e-02]
 [-1.84382024e-03]
 [ 1.98476489e-01]
 [ 2.42481177e-02]
 [-3.17506061e-02]
 [ 1.35503379e-02]
 [ 6.02215481e-02]
 [-2.22419076e-02]
 [ 4.24300922e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [50.09513624]
curr_Stock_Price:  103.16017380791966
curr_Factors:  [103.16017381]
mat_Sqrt:  [[0.15]]
grads:  [0.61921009]
Stock Position:  0.6192100938024471
Bond Position:  [-13.78268466]


portfolio before change:  [52.10445676]
curr_Stock_Price:  106.41627962277765
curr_Factors:  [106.41627962]
mat_Sqrt:  [[0.15]]
grads:  [-0.01229213]
Stock Position:  -0.012292134901017635
Bond Position:  [53.41254003]


portfolio before change:  [52.08999651]
curr_Stock_Price:  109.76583587013417
curr_Factors:  [109.76583587]
mat_Sqrt:  [[0.15]]
grads:  [1.32317659]
Stock Position:  1.323176591554654
Bond Position:  [-93.14958806]


portfolio before change:  [53.31048345]
curr_Stock_Price:  110.72343547249297
curr_Factors:  [110.72343547]
mat_Sqrt:  [[0.15]]
grads:  [0.16165412]
Stock Position:  0.16165411797669738
Bond Position:  [35.41158415]


portfolio before change:  [53.47956619]
curr_Stock_Price:  111.65983301473698
curr_Factors:  [111.65983301]
mat_Sqrt:  [[0.15]]
grads:  [-0.21167071]
Stock Position:  -0.2116707076244016
Bond Position:  [77.11468206]


portfolio before change:  [53.59430486]
curr_Stock_Price:  111.29997365899101
curr_Factors:  [111.29997366]
mat_Sqrt:  [[0.15]]
grads:  [0.09033559]
Stock Position:  0.09033558569583482
Bond Position:  [43.53995655]


portfolio before change:  [53.5553639]
curr_Stock_Price:  110.62785335826176
curr_Factors:  [110.62785336]
mat_Sqrt:  [[0.15]]
grads:  [0.40147699]
Stock Position:  0.40147698735745263
Bond Position:  [9.14082661]


portfolio before change:  [54.33696709]
curr_Stock_Price:  112.5632859134831
curr_Factors:  [112.56328591]
mat_Sqrt:  [[0.15]]
grads:  [-0.14827938]
Stock Position:  -0.1482793843021043
Bond Position:  [71.02778182]


portfolio before change:  [54.60053226]
curr_Stock_Price:  111.0253620543836
curr_Factors:  [111.02536205]
mat_Sqrt:  [[0.15]]
grads:  [0.02828673]
Stock Position:  0.02828672813638902
Bond Position:  [51.45998803]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [54.60053226]
Stock Price:  110.34284671513242
PL:  [44.25768554]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 3.99817166e-02]
 [ 1.55171003e-03]
 [ 9.77318393e-03]
 [ 4.94753181e-03]
 [ 1.15909097e-02]
 [ 1.83081245e-02]
 [-2.32601596e-02]
 [ 2.24174728e-03]
 [ 8.46682660e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [27.29975429]
curr_Stock_Price:  101.68150440399035
curr_Factors:  [101.6815044]
mat_Sqrt:  [[0.15]]
grads:  [0.26654478]
Stock Position:  0.26654477744534094
Bond Position:  [0.19708033]


portfolio before change:  [27.64166355]
curr_Stock_Price:  102.96388065747055
curr_Factors:  [102.96388066]
mat_Sqrt:  [[0.15]]
grads:  [0.01034473]
Stock Position:  0.010344733549782319
Bond Position:  [26.57652964]


portfolio before change:  [27.63663206]
curr_Stock_Price:  101.1926341969602
curr_Factors:  [101.1926342]
mat_Sqrt:  [[0.15]]
grads:  [0.06515456]
Stock Position:  0.06515455954301078
Bond Position:  [21.04347055]


portfolio before change:  [27.59331066]
curr_Stock_Price:  100.36620284810219
curr_Factors:  [100.36620285]
mat_Sqrt:  [[0.15]]
grads:  [0.03298355]
Stock Position:  0.03298354539245311
Bond Position:  [24.28287745]


portfolio before change:  [27.59336347]
curr_Stock_Price:  99.99960589256789
curr_Factors:  [99.99960589]
mat_Sqrt:  [[0.15]]
grads:  [0.07727273]
Stock Position:  0.07727273160932763
Bond Position:  [19.86612076]


portfolio before change:  [27.60668138]
curr_Stock_Price:  100.04337770878712
curr_Factors:  [100.04337771]
mat_Sqrt:  [[0.15]]
grads:  [0.12205416]
Stock Position:  0.1220541630448146
Bond Position:  [15.39597064]


portfolio before change:  [27.33796129]
curr_Stock_Price:  97.77864547619052
curr_Factors:  [97.77864548]
mat_Sqrt:  [[0.15]]
grads:  [-0.15506773]
Stock Position:  -0.1550677309418058
Bond Position:  [42.50027398]


portfolio before change:  [27.36903058]
curr_Stock_Price:  97.71535801960304
curr_Factors:  [97.71535802]
mat_Sqrt:  [[0.15]]
grads:  [0.01494498]
Stock Position:  0.014944981846593748
Bond Position:  [25.90867633]


portfolio before change:  [27.37578904]
curr_Stock_Price:  97.30056156373857
curr_Factors:  [97.30056156]
mat_Sqrt:  [[0.15]]
grads:  [0.05644551]
Stock Position:  0.05644551069979672
Bond Position:  [21.88360915]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [27.37578904]
Stock Price:  95.47016776036983
PL:  [27.37578904]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00429306]
 [-0.01884427]
 [-0.01043587]
 [ 0.00453341]
 [ 0.00476787]
 [ 0.01817342]
 [-0.00855257]
 [ 0.00951507]
 [ 0.00847855]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.69537686]
curr_Stock_Price:  99.67094137840905
curr_Factors:  [99.67094138]
mat_Sqrt:  [[0.15]]
grads:  [-0.02862043]
Stock Position:  -0.02862042781645953
Bond Position:  [-0.84275188]


portfolio before change:  [-3.6734007]
curr_Stock_Price:  98.88836605137706
curr_Factors:  [98.88836605]
mat_Sqrt:  [[0.15]]
grads:  [-0.12562847]
Stock Position:  -0.12562846835623556
Bond Position:  [8.74979326]


portfolio before change:  [-3.85734404]
curr_Stock_Price:  100.38738397699409
curr_Factors:  [100.38738398]
mat_Sqrt:  [[0.15]]
grads:  [-0.06957245]
Stock Position:  -0.06957245386463377
Bond Position:  [3.1268526]


portfolio before change:  [-3.86898962]
curr_Stock_Price:  100.5772493398136
curr_Factors:  [100.57724934]
mat_Sqrt:  [[0.15]]
grads:  [0.03022276]
Stock Position:  0.030222755264692546
Bond Position:  [-6.90871121]


portfolio before change:  [-3.95563374]
curr_Stock_Price:  97.8247238402205
curr_Factors:  [97.82472384]
mat_Sqrt:  [[0.15]]
grads:  [0.03178579]
Stock Position:  0.031785794088510295
Bond Position:  [-7.06507027]


portfolio before change:  [-3.96892615]
curr_Stock_Price:  97.51770030852337
curr_Factors:  [97.51770031]
mat_Sqrt:  [[0.15]]
grads:  [0.12115611]
Stock Position:  0.12115611169315188
Bond Position:  [-15.78379154]


portfolio before change:  [-3.759462]
curr_Stock_Price:  99.31173297891347
curr_Factors:  [99.31173298]
mat_Sqrt:  [[0.15]]
grads:  [-0.05701712]
Stock Position:  -0.0570171168617067
Bond Position:  [1.90300669]


portfolio before change:  [-3.80408624]
curr_Stock_Price:  100.11107157083978
curr_Factors:  [100.11107157]
mat_Sqrt:  [[0.15]]
grads:  [0.06343382]
Stock Position:  0.06343382167100645
Bond Position:  [-10.1545141]


portfolio before change:  [-3.9485112]
curr_Stock_Price:  97.91435010937587
curr_Factors:  [97.91435011]
mat_Sqrt:  [[0.15]]
grads:  [0.05652366]
Stock Position:  0.05652365577191965
Bond Position:  [-9.48298822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.9485112]
Stock Price:  99.28555132663024
PL:  [-3.9485112]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00301803]
 [-0.02030396]
 [-0.0105938 ]
 [ 0.00494728]
 [ 0.00947476]
 [ 0.01856408]
 [-0.03575328]
 [-0.0026315 ]
 [ 0.00853314]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.33513428]
curr_Stock_Price:  99.49970807637577
curr_Factors:  [99.49970808]
mat_Sqrt:  [[0.15]]
grads:  [-0.02012018]
Stock Position:  -0.020120175641697956
Bond Position:  [-4.33318267]


portfolio before change:  [-6.35048244]
curr_Stock_Price:  100.15482308189976
curr_Factors:  [100.15482308]
mat_Sqrt:  [[0.15]]
grads:  [-0.13535972]
Stock Position:  -0.13535971969503935
Bond Position:  [7.20644634]


portfolio before change:  [-6.37747748]
curr_Stock_Price:  100.38088121127646
curr_Factors:  [100.38088121]
mat_Sqrt:  [[0.15]]
grads:  [-0.07062532]
Stock Position:  -0.07062532401695322
Bond Position:  [0.71195478]


portfolio before change:  [-6.37587356]
curr_Stock_Price:  100.3632125953163
curr_Factors:  [100.3632126]
mat_Sqrt:  [[0.15]]
grads:  [0.03298185]
Stock Position:  0.03298185370006585
Bond Position:  [-9.68603836]


portfolio before change:  [-6.41322032]
curr_Stock_Price:  99.3777454537499
curr_Factors:  [99.37774545]
mat_Sqrt:  [[0.15]]
grads:  [0.06316507]
Stock Position:  0.06316506981671736
Bond Position:  [-12.69042255]


portfolio before change:  [-6.47064734]
curr_Stock_Price:  98.5690672772186
curr_Factors:  [98.56906728]
mat_Sqrt:  [[0.15]]
grads:  [0.12376054]
Stock Position:  0.12376053923318121
Bond Position:  [-18.66960825]


portfolio before change:  [-6.92512045]
curr_Stock_Price:  94.97231523290519
curr_Factors:  [94.97231523]
mat_Sqrt:  [[0.15]]
grads:  [-0.2383552]
Stock Position:  -0.23835519664441762
Bond Position:  [15.71202443]


portfolio before change:  [-7.11652062]
curr_Stock_Price:  95.80828671397236
curr_Factors:  [95.80828671]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754331]
Stock Position:  -0.01754330757814438
Bond Position:  [-5.43572637]


portfolio before change:  [-7.1233546]
curr_Stock_Price:  96.04287441668701
curr_Factors:  [96.04287442]
mat_Sqrt:  [[0.15]]
grads:  [0.05688762]
Stock Position:  0.0568876244805664
Bond Position:  [-12.58700558]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.1233546]
Stock Price:  96.87947098621022
PL:  [-7.1233546]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.02732544]
 [ 0.00323249]
 [ 0.03868857]
 [ 0.00430431]
 [ 0.01555016]
 [ 0.01856804]
 [-0.02168996]
 [ 0.00334317]
 [ 0.00840148]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.35133638]
curr_Stock_Price:  101.36051508373778
curr_Factors:  [101.36051508]
mat_Sqrt:  [[0.15]]
grads:  [0.18216962]
Stock Position:  0.18216962140072926
Bond Position:  [3.88652973]


portfolio before change:  [22.37456389]
curr_Stock_Price:  101.4773498886048
curr_Factors:  [101.47734989]
mat_Sqrt:  [[0.15]]
grads:  [0.02154996]
Stock Position:  0.021549962185905942
Bond Position:  [20.18773083]


portfolio before change:  [22.40290822]
curr_Stock_Price:  102.32412391914575
curr_Factors:  [102.32412392]
mat_Sqrt:  [[0.15]]
grads:  [0.25792382]
Stock Position:  0.2579238201540953
Bond Position:  [-3.98892071]


portfolio before change:  [22.70613563]
curr_Stock_Price:  103.50750575335981
curr_Factors:  [103.50750575]
mat_Sqrt:  [[0.15]]
grads:  [0.02869538]
Stock Position:  0.028695380432525928
Bond Position:  [19.73594837]


portfolio before change:  [22.62985885]
curr_Stock_Price:  100.5053772558979
curr_Factors:  [100.50537726]
mat_Sqrt:  [[0.15]]
grads:  [0.1036677]
Stock Position:  0.10366770322857491
Bond Position:  [12.21069723]


portfolio before change:  [22.47402583]
curr_Stock_Price:  98.9432717026538
curr_Factors:  [98.9432717]
mat_Sqrt:  [[0.15]]
grads:  [0.12378693]
Stock Position:  0.12378692876007169
Bond Position:  [10.22614211]


portfolio before change:  [22.35272961]
curr_Stock_Price:  97.922076889763
curr_Factors:  [97.92207689]
mat_Sqrt:  [[0.15]]
grads:  [-0.14459974]
Stock Position:  -0.14459974235147058
Bond Position:  [36.5122367]


portfolio before change:  [22.2543778]
curr_Stock_Price:  98.72852714222785
curr_Factors:  [98.72852714]
mat_Sqrt:  [[0.15]]
grads:  [0.02228777]
Stock Position:  0.022287774905405858
Bond Position:  [20.05393861]


portfolio before change:  [22.29637701]
curr_Stock_Price:  100.16293398671623
curr_Factors:  [100.16293399]
mat_Sqrt:  [[0.15]]
grads:  [0.05600987]
Stock Position:  0.05600987276745048
Bond Position:  [16.68626382]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.29637701]
Stock Price:  101.02053725133878
PL:  [21.27583976]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01534007]
 [-0.01424401]
 [-0.01665714]
 [ 0.00477025]
 [ 0.00982334]
 [ 0.01855918]
 [-0.02482274]
 [ 0.00778982]
 [ 0.0084109 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.17293842]
curr_Stock_Price:  99.12102688589482
curr_Factors:  [99.12102689]
mat_Sqrt:  [[0.15]]
grads:  [0.10226713]
Stock Position:  0.10226712539850703
Bond Position:  [-22.30976091]


portfolio before change:  [-12.37549967]
curr_Stock_Price:  97.24942273432268
curr_Factors:  [97.24942273]
mat_Sqrt:  [[0.15]]
grads:  [-0.09496006]
Stock Position:  -0.09496005750128747
Bond Position:  [-3.14068889]


portfolio before change:  [-12.43887735]
curr_Stock_Price:  97.90029582159576
curr_Factors:  [97.90029582]
mat_Sqrt:  [[0.15]]
grads:  [-0.11104762]
Stock Position:  -0.11104762300124797
Bond Position:  [-1.56728221]


portfolio before change:  [-12.65736969]
curr_Stock_Price:  99.86079254243899
curr_Factors:  [99.86079254]
mat_Sqrt:  [[0.15]]
grads:  [0.03180169]
Stock Position:  0.0318016859285615
Bond Position:  [-15.83311125]


portfolio before change:  [-12.67507958]
curr_Stock_Price:  99.5529046698904
curr_Factors:  [99.55290467]
mat_Sqrt:  [[0.15]]
grads:  [0.06548891]
Stock Position:  0.06548890709875453
Bond Position:  [-19.1946905]


portfolio before change:  [-12.75129553]
curr_Stock_Price:  98.53569098526854
curr_Factors:  [98.53569099]
mat_Sqrt:  [[0.15]]
grads:  [0.12372784]
Stock Position:  0.12372784274187042
Bond Position:  [-24.94290401]


portfolio before change:  [-12.88528221]
curr_Stock_Price:  97.55359912736365
curr_Factors:  [97.55359913]
mat_Sqrt:  [[0.15]]
grads:  [-0.1654849]
Stock Position:  -0.1654849015429596
Bond Position:  [3.25836554]


portfolio before change:  [-13.24232981]
curr_Stock_Price:  99.72103063281037
curr_Factors:  [99.72103063]
mat_Sqrt:  [[0.15]]
grads:  [0.05193215]
Stock Position:  0.05193214780760525
Bond Position:  [-18.42105711]


portfolio before change:  [-13.23489394]
curr_Stock_Price:  100.04161621631145
curr_Factors:  [100.04161622]
mat_Sqrt:  [[0.15]]
grads:  [0.0560727]
Stock Position:  0.056072699072250536
Bond Position:  [-18.84449738]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.23489394]
Stock Price:  101.81362484077266
PL:  [-15.04851878]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-4.34255506e-03]
 [-2.80792104e-03]
 [ 1.86978038e-02]
 [ 2.47321779e-03]
 [ 1.38383514e-02]
 [ 1.70361884e-02]
 [ 5.51629205e-03]
 [ 7.74534035e-04]
 [ 8.46028947e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.51900108]
curr_Stock_Price:  99.81211647627161
curr_Factors:  [99.81211648]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895037]
Stock Position:  -0.028950367095637045
Bond Position:  [1.37059633]


portfolio before change:  [-1.54539575]
curr_Stock_Price:  100.74751529464679
curr_Factors:  [100.74751529]
mat_Sqrt:  [[0.15]]
grads:  [-0.01871947]
Stock Position:  -0.01871947359396374
Bond Position:  [0.3405447]


portfolio before change:  [-1.55982837]
curr_Stock_Price:  101.5276085878942
curr_Factors:  [101.52760859]
mat_Sqrt:  [[0.15]]
grads:  [0.12465203]
Stock Position:  0.12465202505924797
Bond Position:  [-14.21545038]


portfolio before change:  [-1.57081456]
curr_Stock_Price:  101.49650852699406
curr_Factors:  [101.49650853]
mat_Sqrt:  [[0.15]]
grads:  [0.01648812]
Stock Position:  0.016488118618830584
Bond Position:  [-3.24430103]


portfolio before change:  [-1.55968106]
curr_Stock_Price:  102.27016012508858
curr_Factors:  [102.27016013]
mat_Sqrt:  [[0.15]]
grads:  [0.09225568]
Stock Position:  0.09225567579674299
Bond Position:  [-10.99468379]


portfolio before change:  [-1.53498339]
curr_Stock_Price:  102.59747203432786
curr_Factors:  [102.59747203]
mat_Sqrt:  [[0.15]]
grads:  [0.11357459]
Stock Position:  0.11357458941007918
Bond Position:  [-13.18744915]


portfolio before change:  [-1.71197711]
curr_Stock_Price:  101.0971510248853
curr_Factors:  [101.09715102]
mat_Sqrt:  [[0.15]]
grads:  [0.03677528]
Stock Position:  0.036775280322470634
Bond Position:  [-5.42985318]


portfolio before change:  [-1.86510511]
curr_Stock_Price:  97.00711030508694
curr_Factors:  [97.00711031]
mat_Sqrt:  [[0.15]]
grads:  [0.00516356]
Stock Position:  0.005163560233625663
Bond Position:  [-2.36600716]


portfolio before change:  [-1.86359616]
curr_Stock_Price:  97.52850456445
curr_Factors:  [97.52850456]
mat_Sqrt:  [[0.15]]
grads:  [0.05640193]
Stock Position:  0.05640192983041469
Bond Position:  [-7.36439203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.86359616]
Stock Price:  97.36787638454423
PL:  [-1.86359616]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-5.17439820e-04]
 [-2.28962363e-02]
 [ 1.11990607e-02]
 [ 2.47685145e-03]
 [ 5.80651975e-03]
 [ 1.56932257e-02]
 [ 3.69502454e-02]
 [ 1.60635219e-03]
 [ 5.08868508e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.58703465]
curr_Stock_Price:  100.4676653001093
curr_Factors:  [100.4676653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0034496]
Stock Position:  -0.0034495988004220927
Bond Position:  [8.93360779]


portfolio before change:  [8.59502711]
curr_Stock_Price:  99.44593903301407
curr_Factors:  [99.44593903]
mat_Sqrt:  [[0.15]]
grads:  [-0.15264158]
Stock Position:  -0.15264157548095658
Bond Position:  [23.77461192]


portfolio before change:  [8.33212994]
curr_Stock_Price:  101.24615269057001
curr_Factors:  [101.24615269]
mat_Sqrt:  [[0.15]]
grads:  [0.0746604]
Stock Position:  0.07466040480823223
Bond Position:  [0.7730512]


portfolio before change:  [8.35100271]
curr_Stock_Price:  101.49375568353858
curr_Factors:  [101.49375568]
mat_Sqrt:  [[0.15]]
grads:  [0.01651234]
Stock Position:  0.016512343023556218
Bond Position:  [6.675103]


portfolio before change:  [8.40553288]
curr_Stock_Price:  104.59396932301907
curr_Factors:  [104.59396932]
mat_Sqrt:  [[0.15]]
grads:  [0.03871013]
Stock Position:  0.038710131644517136
Bond Position:  [4.35668656]


portfolio before change:  [8.46465968]
curr_Stock_Price:  106.06510647448258
curr_Factors:  [106.06510647]
mat_Sqrt:  [[0.15]]
grads:  [0.1046215]
Stock Position:  0.10462150478506976
Bond Position:  [-2.63203136]


portfolio before change:  [8.51469667]
curr_Stock_Price:  106.55595520624883
curr_Factors:  [106.55595521]
mat_Sqrt:  [[0.15]]
grads:  [0.24633497]
Stock Position:  0.24633496933020554
Bond Position:  [-17.73376129]


portfolio before change:  [8.40553836]
curr_Stock_Price:  106.14882985095976
curr_Factors:  [106.14882985]
mat_Sqrt:  [[0.15]]
grads:  [0.01070901]
Stock Position:  0.01070901457304446
Bond Position:  [7.268789]


portfolio before change:  [8.43562287]
curr_Stock_Price:  108.61863718576716
curr_Factors:  [108.61863719]
mat_Sqrt:  [[0.15]]
grads:  [0.03392457]
Stock Position:  0.033924567224829935
Bond Position:  [4.75078261]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.43562287]
Stock Price:  109.03835204352266
PL:  [-0.60272918]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.85754459e-02]
 [-1.67345437e-02]
 [-2.11387158e-02]
 [-7.48551651e-04]
 [ 4.85223551e-03]
 [ 1.78554656e-02]
 [-1.53506458e-02]
 [ 7.98664183e-03]
 [ 8.48330786e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.61501076]
curr_Stock_Price:  98.76801565402496
curr_Factors:  [98.76801565]
mat_Sqrt:  [[0.15]]
grads:  [0.12383631]
Stock Position:  0.1238363060449029
Bond Position:  [-29.84607698]


portfolio before change:  [-17.75431917]
curr_Stock_Price:  97.76361202531575
curr_Factors:  [97.76361203]
mat_Sqrt:  [[0.15]]
grads:  [-0.11156362]
Stock Position:  -0.11156362451740005
Bond Position:  [-6.84745626]


portfolio before change:  [-17.72758163]
curr_Stock_Price:  97.49325402788587
curr_Factors:  [97.49325403]
mat_Sqrt:  [[0.15]]
grads:  [-0.14092477]
Stock Position:  -0.14092477215077745
Bond Position:  [-3.98836702]


portfolio before change:  [-17.71256931]
curr_Stock_Price:  97.37257255314474
curr_Factors:  [97.37257255]
mat_Sqrt:  [[0.15]]
grads:  [-0.00499034]
Stock Position:  -0.004990344342375985
Bond Position:  [-17.22664664]


portfolio before change:  [-17.72379505]
curr_Stock_Price:  97.89563629432581
curr_Factors:  [97.89563629]
mat_Sqrt:  [[0.15]]
grads:  [0.03234824]
Stock Position:  0.03234823673352498
Bond Position:  [-20.89054627]


portfolio before change:  [-17.7657315]
curr_Stock_Price:  96.92221199886266
curr_Factors:  [96.922212]
mat_Sqrt:  [[0.15]]
grads:  [0.11903644]
Stock Position:  0.11903643726303953
Bond Position:  [-29.3030063]


portfolio before change:  [-17.58263876]
curr_Stock_Price:  98.58345037962144
curr_Factors:  [98.58345038]
mat_Sqrt:  [[0.15]]
grads:  [-0.10233764]
Stock Position:  -0.10233763875807751
Bond Position:  [-7.49384123]


portfolio before change:  [-17.70665947]
curr_Stock_Price:  99.75870562944874
curr_Factors:  [99.75870563]
mat_Sqrt:  [[0.15]]
grads:  [0.05324428]
Stock Position:  0.053244278871476355
Bond Position:  [-23.01823981]


portfolio before change:  [-17.77901611]
curr_Stock_Price:  98.61596041159397
curr_Factors:  [98.61596041]
mat_Sqrt:  [[0.15]]
grads:  [0.05655539]
Stock Position:  0.05655538570845279
Bond Position:  [-23.35627979]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.77901611]
Stock Price:  100.6332824991156
PL:  [-18.41229861]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00492217]
 [-0.02293456]
 [-0.01377178]
 [ 0.00387919]
 [ 0.01472395]
 [ 0.01826608]
 [ 0.00331951]
 [ 0.01242782]
 [ 0.0070764 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.09862358]
curr_Stock_Price:  100.11164821137409
curr_Factors:  [100.11164821]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281446]
Stock Position:  -0.03281445687245174
Bond Position:  [6.38373294]


portfolio before change:  [3.10294582]
curr_Stock_Price:  100.07722506647207
curr_Factors:  [100.07722507]
mat_Sqrt:  [[0.15]]
grads:  [-0.15289707]
Stock Position:  -0.15289707125800522
Bond Position:  [18.40446044]


portfolio before change:  [3.13527452]
curr_Stock_Price:  99.9259849900415
curr_Factors:  [99.92598499]
mat_Sqrt:  [[0.15]]
grads:  [-0.09181184]
Stock Position:  -0.09181184269528841
Bond Position:  [12.30966333]


portfolio before change:  [3.06188489]
curr_Stock_Price:  100.79238732393927
curr_Factors:  [100.79238732]
mat_Sqrt:  [[0.15]]
grads:  [0.02586127]
Stock Position:  0.025861266383588856
Bond Position:  [0.45526612]


portfolio before change:  [3.05007722]
curr_Stock_Price:  100.32700562544741
curr_Factors:  [100.32700563]
mat_Sqrt:  [[0.15]]
grads:  [0.09815964]
Stock Position:  0.09815963618833629
Bond Position:  [-6.79798515]


portfolio before change:  [3.03307586]
curr_Stock_Price:  100.18844031834614
curr_Factors:  [100.18844032]
mat_Sqrt:  [[0.15]]
grads:  [0.12177386]
Stock Position:  0.12177385728941756
Bond Position:  [-9.16725697]


portfolio before change:  [3.09758803]
curr_Stock_Price:  100.7558605205979
curr_Factors:  [100.75586052]
mat_Sqrt:  [[0.15]]
grads:  [0.02213006]
Stock Position:  0.022130064832321408
Bond Position:  [0.86785431]


portfolio before change:  [3.11878991]
curr_Stock_Price:  101.69430533056592
curr_Factors:  [101.69430533]
mat_Sqrt:  [[0.15]]
grads:  [0.08285214]
Stock Position:  0.08285213781618805
Bond Position:  [-5.30680069]


portfolio before change:  [3.24102619]
curr_Stock_Price:  103.20169357447263
curr_Factors:  [103.20169357]
mat_Sqrt:  [[0.15]]
grads:  [0.04717602]
Stock Position:  0.047176023931557697
Bond Position:  [-1.62761938]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.24102619]
Stock Price:  101.67791169849072
PL:  [1.56311449]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.02207699]
 [-0.01724933]
 [-0.01228633]
 [ 0.00452099]
 [ 0.01042608]
 [ 0.01857116]
 [-0.0262583 ]
 [ 0.00447965]
 [ 0.0084999 ]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [20.31864728]
curr_Stock_Price:  101.22866051836942
curr_Factors:  [101.22866052]
mat_Sqrt:  [[0.15]]
grads:  [0.14717995]
Stock Position:  0.14717995343557852
Bond Position:  [5.41981774]


portfolio before change:  [20.17807889]
curr_Stock_Price:  100.25516532082776
curr_Factors:  [100.25516532]
mat_Sqrt:  [[0.15]]
grads:  [-0.11499552]
Stock Position:  -0.11499552259945738
Bond Position:  [31.70697402]


portfolio before change:  [20.1874936]
curr_Stock_Price:  100.31119133745005
curr_Factors:  [100.31119134]
mat_Sqrt:  [[0.15]]
grads:  [-0.08190889]
Stock Position:  -0.08190889031117664
Bond Position:  [28.40387197]


portfolio before change:  [20.17957194]
curr_Stock_Price:  100.5813347251886
curr_Factors:  [100.58133473]
mat_Sqrt:  [[0.15]]
grads:  [0.03013993]
Stock Position:  0.03013993231289976
Bond Position:  [17.14805732]


portfolio before change:  [20.16628931]
curr_Stock_Price:  99.856090772394
curr_Factors:  [99.85609077]
mat_Sqrt:  [[0.15]]
grads:  [0.06950718]
Stock Position:  0.06950718349688383
Bond Position:  [13.22557369]


portfolio before change:  [20.09914407]
curr_Stock_Price:  98.7949099981807
curr_Factors:  [98.79491]
mat_Sqrt:  [[0.15]]
grads:  [0.12380776]
Stock Position:  0.12380775810518656
Bond Position:  [7.86756775]


portfolio before change:  [19.91983745]
curr_Stock_Price:  97.31486234517672
curr_Factors:  [97.31486235]
mat_Sqrt:  [[0.15]]
grads:  [-0.1750553]
Stock Position:  -0.17505530423411544
Bond Position:  [36.95532029]


portfolio before change:  [19.6473148]
curr_Stock_Price:  98.97722233443109
curr_Factors:  [98.97722233]
mat_Sqrt:  [[0.15]]
grads:  [0.02986434]
Stock Position:  0.029864344899726142
Bond Position:  [16.69142489]


portfolio before change:  [19.63958563]
curr_Stock_Price:  98.43888898923808
curr_Factors:  [98.43888899]
mat_Sqrt:  [[0.15]]
grads:  [0.05666599]
Stock Position:  0.056665987459714184
Bond Position:  [14.06144878]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.63958563]
Stock Price:  97.87716844036854
PL:  [19.63958563]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00359591]
 [-0.00548179]
 [-0.01528441]
 [ 0.00257361]
 [ 0.01674968]
 [ 0.01739388]
 [ 0.01316691]
 [ 0.00744313]
 [ 0.00727914]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.65926503]
curr_Stock_Price:  99.60841678719625
curr_Factors:  [99.60841679]
mat_Sqrt:  [[0.15]]
grads:  [-0.02397276]
Stock Position:  -0.023972755431985286
Bond Position:  [-2.27137681]


portfolio before change:  [-4.68552297]
curr_Stock_Price:  100.65635530899802
curr_Factors:  [100.65635531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03654526]
Stock Position:  -0.03654525548155875
Bond Position:  [-1.00701075]


portfolio before change:  [-4.66533445]
curr_Stock_Price:  100.09014902769556
curr_Factors:  [100.09014903]
mat_Sqrt:  [[0.15]]
grads:  [-0.10189605]
Stock Position:  -0.1018960500214749
Bond Position:  [5.53345638]


portfolio before change:  [-4.79811965]
curr_Stock_Price:  101.42045204799406
curr_Factors:  [101.42045205]
mat_Sqrt:  [[0.15]]
grads:  [0.0171574]
Stock Position:  0.01715739856848588
Bond Position:  [-6.53823077]


portfolio before change:  [-4.81173201]
curr_Stock_Price:  100.81765511986396
curr_Factors:  [100.81765512]
mat_Sqrt:  [[0.15]]
grads:  [0.11166457]
Stock Position:  0.11166456662643871
Bond Position:  [-16.06949178]


portfolio before change:  [-4.69554084]
curr_Stock_Price:  101.93016496597001
curr_Factors:  [101.93016497]
mat_Sqrt:  [[0.15]]
grads:  [0.11595921]
Stock Position:  0.11595920569362081
Bond Position:  [-16.5152818]


portfolio before change:  [-4.65409442]
curr_Stock_Price:  102.35881680522955
curr_Factors:  [102.35881681]
mat_Sqrt:  [[0.15]]
grads:  [0.0877794]
Stock Position:  0.08777940145882686
Bond Position:  [-13.63909009]


portfolio before change:  [-4.56817658]
curr_Stock_Price:  103.41531854717788
curr_Factors:  [103.41531855]
mat_Sqrt:  [[0.15]]
grads:  [0.04962089]
Stock Position:  0.04962089275328002
Bond Position:  [-9.69973701]


portfolio before change:  [-4.60868336]
curr_Stock_Price:  102.69675635225524
curr_Factors:  [102.69675635]
mat_Sqrt:  [[0.15]]
grads:  [0.04852763]
Stock Position:  0.04852763224534051
Bond Position:  [-9.59231378]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.60868336]
Stock Price:  103.48850887996409
PL:  [-8.09719224]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 7.64704685e-03]
 [ 3.01333462e-03]
 [ 9.28875462e-03]
 [ 2.41914643e-03]
 [ 1.58766463e-02]
 [ 1.76891614e-02]
 [ 2.57245203e-02]
 [-1.16859232e-03]
 [ 6.32545836e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.75613201]
curr_Stock_Price:  100.73810238823442
curr_Factors:  [100.73810239]
mat_Sqrt:  [[0.15]]
grads:  [0.05098031]
Stock Position:  0.050980312356484446
Bond Position:  [7.62047209]


portfolio before change:  [12.7874012]
curr_Stock_Price:  101.27670235975306
curr_Factors:  [101.27670236]
mat_Sqrt:  [[0.15]]
grads:  [0.0200889]
Stock Position:  0.02008889744758402
Bond Position:  [10.75286391]


portfolio before change:  [12.79072487]
curr_Stock_Price:  101.17445175133889
curr_Factors:  [101.17445175]
mat_Sqrt:  [[0.15]]
grads:  [0.06192503]
Stock Position:  0.061925030777128305
Bond Position:  [6.52549383]


portfolio before change:  [12.81646852]
curr_Stock_Price:  101.53747272265392
curr_Factors:  [101.53747272]
mat_Sqrt:  [[0.15]]
grads:  [0.01612764]
Stock Position:  0.016127642888565878
Bond Position:  [11.17890842]


portfolio before change:  [12.80655089]
curr_Stock_Price:  100.57586380373989
curr_Factors:  [100.5758638]
mat_Sqrt:  [[0.15]]
grads:  [0.10584431]
Stock Position:  0.10584430849908916
Bond Position:  [2.16116813]


portfolio before change:  [12.90721586]
curr_Stock_Price:  101.51671851411757
curr_Factors:  [101.51671851]
mat_Sqrt:  [[0.15]]
grads:  [0.11792774]
Stock Position:  0.11792774238941105
Bond Position:  [0.93557843]


portfolio before change:  [13.27143531]
curr_Stock_Price:  104.60124752519542
curr_Factors:  [104.60124753]
mat_Sqrt:  [[0.15]]
grads:  [0.1714968]
Stock Position:  0.17149680170272263
Bond Position:  [-4.6673441]


portfolio before change:  [13.63716739]
curr_Stock_Price:  106.74744695658028
curr_Factors:  [106.74744696]
mat_Sqrt:  [[0.15]]
grads:  [-0.00779062]
Stock Position:  -0.007790615495980714
Bond Position:  [14.4687957]


portfolio before change:  [13.65724694]
curr_Stock_Price:  105.09888082292501
curr_Factors:  [105.09888082]
mat_Sqrt:  [[0.15]]
grads:  [0.04216972]
Stock Position:  0.042169722399392
Bond Position:  [9.22525631]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.65724694]
Stock Price:  103.40838744601865
PL:  [10.24885949]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.11239412e-02]
 [ 2.02732447e-06]
 [ 4.21105868e-02]
 [ 2.04926366e-03]
 [ 1.57381281e-02]
 [ 1.85715478e-02]
 [-1.70079438e-02]
 [ 2.05599094e-03]
 [ 8.42008811e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.17029201]
curr_Stock_Price:  100.89470184914492
curr_Factors:  [100.89470185]
mat_Sqrt:  [[0.15]]
grads:  [0.07415961]
Stock Position:  0.07415960816680499
Bond Position:  [7.68798046]


portfolio before change:  [15.17475759]
curr_Stock_Price:  100.90307062644638
curr_Factors:  [100.90307063]
mat_Sqrt:  [[0.15]]
grads:  [1.35154965e-05]
Stock Position:  1.3515496456161884e-05
Bond Position:  [15.17339383]


portfolio before change:  [15.18236753]
curr_Stock_Price:  102.48221628683278
curr_Factors:  [102.48221629]
mat_Sqrt:  [[0.15]]
grads:  [0.28073725]
Stock Position:  0.2807372453851956
Bond Position:  [-13.58820758]


portfolio before change:  [14.98901559]
curr_Stock_Price:  101.81769408887047
curr_Factors:  [101.81769409]
mat_Sqrt:  [[0.15]]
grads:  [0.01366176]
Stock Position:  0.013661757741901167
Bond Position:  [13.59800692]


portfolio before change:  [14.99794948]
curr_Stock_Price:  101.97383674505953
curr_Factors:  [101.97383675]
mat_Sqrt:  [[0.15]]
grads:  [0.10492085]
Stock Position:  0.10492085411625954
Bond Position:  [4.29876743]


portfolio before change:  [14.64938218]
curr_Stock_Price:  98.63115314006758
curr_Factors:  [98.63115314]
mat_Sqrt:  [[0.15]]
grads:  [0.12381032]
Stock Position:  0.1238103189839081
Bond Position:  [2.43782765]


portfolio before change:  [14.61859825]
curr_Stock_Price:  98.37266781573207
curr_Factors:  [98.37266782]
mat_Sqrt:  [[0.15]]
grads:  [-0.11338629]
Stock Position:  -0.11338629168485842
Bond Position:  [25.77271026]


portfolio before change:  [14.71649367]
curr_Stock_Price:  97.62296654538594
curr_Factors:  [97.62296655]
mat_Sqrt:  [[0.15]]
grads:  [0.01370661]
Stock Position:  0.013706606298405193
Bond Position:  [13.3784141]


portfolio before change:  [14.75109826]
curr_Stock_Price:  99.65948145881082
curr_Factors:  [99.65948146]
mat_Sqrt:  [[0.15]]
grads:  [0.05613392]
Stock Position:  0.05613392074320185
Bond Position:  [9.15682083]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.75109826]
Stock Price:  103.06117723763612
PL:  [11.68992102]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.21060265e-03]
 [ 3.52948084e-03]
 [ 4.66085541e-02]
 [ 1.49945481e-03]
 [ 9.76885251e-03]
 [ 1.80663168e-02]
 [ 7.81393519e-03]
 [ 6.72093753e-03]
 [ 6.72513263e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.73307753]
curr_Stock_Price:  99.53876172761271
curr_Factors:  [99.53876173]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140402]
Stock Position:  -0.021404017657183385
Bond Position:  [-3.60254811]


portfolio before change:  [-5.77383034]
curr_Stock_Price:  101.35856431221106
curr_Factors:  [101.35856431]
mat_Sqrt:  [[0.15]]
grads:  [0.02352987]
Stock Position:  0.023529872241828793
Bond Position:  [-8.15878441]


portfolio before change:  [-5.74658186]
curr_Stock_Price:  102.69001623881789
curr_Factors:  [102.69001624]
mat_Sqrt:  [[0.15]]
grads:  [0.31072369]
Stock Position:  0.31072369404806033
Bond Position:  [-37.65480304]


portfolio before change:  [-7.08644927]
curr_Stock_Price:  98.43853710420053
curr_Factors:  [98.4385371]
mat_Sqrt:  [[0.15]]
grads:  [0.00999637]
Stock Position:  0.009996365408651928
Bond Position:  [-8.07047685]


portfolio before change:  [-7.07973076]
curr_Stock_Price:  99.5144035697072
curr_Factors:  [99.51440357]
mat_Sqrt:  [[0.15]]
grads:  [0.06512568]
Stock Position:  0.06512568340596055
Bond Position:  [-13.5606743]


portfolio before change:  [-7.00504441]
curr_Stock_Price:  100.7653444913351
curr_Factors:  [100.76534449]
mat_Sqrt:  [[0.15]]
grads:  [0.12044211]
Stock Position:  0.12044211225807135
Bond Position:  [-19.14143534]


portfolio before change:  [-6.93593138]
curr_Stock_Price:  101.41865539482964
curr_Factors:  [101.41865539]
mat_Sqrt:  [[0.15]]
grads:  [0.0520929]
Stock Position:  0.05209290126482293
Bond Position:  [-12.21912338]


portfolio before change:  [-6.82590054]
curr_Stock_Price:  103.64817084255786
curr_Factors:  [103.64817084]
mat_Sqrt:  [[0.15]]
grads:  [0.04480625]
Stock Position:  0.04480625021138359
Bond Position:  [-11.46998641]


portfolio before change:  [-6.81244283]
curr_Stock_Price:  104.07655147553231
curr_Factors:  [104.07655148]
mat_Sqrt:  [[0.15]]
grads:  [0.04483422]
Stock Position:  0.044834217543709795
Bond Position:  [-11.47863358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.81244283]
Stock Price:  104.19594394028832
PL:  [-11.00838677]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.31144794e-03]
 [-1.80711688e-02]
 [ 2.34920331e-02]
 [ 7.18554818e-03]
 [ 1.64416136e-03]
 [ 1.60575575e-02]
 [ 2.81010348e-02]
 [ 3.72270745e-03]
 [ 7.27352010e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.10992051]
curr_Stock_Price:  100.04751395030647
curr_Factors:  [100.04751395]
mat_Sqrt:  [[0.15]]
grads:  [-0.02207632]
Stock Position:  -0.02207631958897626
Bond Position:  [4.31860141]


portfolio before change:  [2.10811473]
curr_Stock_Price:  100.22714636996245
curr_Factors:  [100.22714637]
mat_Sqrt:  [[0.15]]
grads:  [-0.12047446]
Stock Position:  -0.12047445837692175
Bond Position:  [14.1829259]


portfolio before change:  [1.93685666]
curr_Stock_Price:  101.7075539623474
curr_Factors:  [101.70755396]
mat_Sqrt:  [[0.15]]
grads:  [0.15661355]
Stock Position:  0.1566135540629537
Bond Position:  [-13.99192484]


portfolio before change:  [2.37534767]
curr_Stock_Price:  104.55206331427077
curr_Factors:  [104.55206331]
mat_Sqrt:  [[0.15]]
grads:  [0.04790365]
Stock Position:  0.04790365453706542
Bond Position:  [-2.63307825]


portfolio before change:  [2.41355119]
curr_Stock_Price:  105.37706058196675
curr_Factors:  [105.37706058]
mat_Sqrt:  [[0.15]]
grads:  [0.01096108]
Stock Position:  0.0109610757337309
Bond Position:  [1.25850525]


portfolio before change:  [2.41189699]
curr_Stock_Price:  105.16872292019684
curr_Factors:  [105.16872292]
mat_Sqrt:  [[0.15]]
grads:  [0.10705038]
Stock Position:  0.10705038363202758
Bond Position:  [-8.84645514]


portfolio before change:  [2.39102342]
curr_Stock_Price:  105.01506411271038
curr_Factors:  [105.01506411]
mat_Sqrt:  [[0.15]]
grads:  [0.18734023]
Stock Position:  0.18734023212644135
Bond Position:  [-17.28252306]


portfolio before change:  [2.43434478]
curr_Stock_Price:  105.29244595569354
curr_Factors:  [105.29244596]
mat_Sqrt:  [[0.15]]
grads:  [0.02481805]
Stock Position:  0.02481804963848342
Bond Position:  [-0.17880837]


portfolio before change:  [2.37018307]
curr_Stock_Price:  102.7107650337437
curr_Factors:  [102.71076503]
mat_Sqrt:  [[0.15]]
grads:  [0.04849013]
Stock Position:  0.04849013401876534
Bond Position:  [-2.61027569]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.37018307]
Stock Price:  100.4150914243257
PL:  [1.95509165]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01678633]
 [-0.01597263]
 [-0.03670504]
 [-0.01222466]
 [-0.01427092]
 [ 0.01608611]
 [-0.04337013]
 [-0.00369118]
 [ 0.00847775]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-25.07163897]
curr_Stock_Price:  98.28432610623292
curr_Factors:  [98.28432611]
mat_Sqrt:  [[0.15]]
grads:  [0.1119089]
Stock Position:  0.1119088978202149
Bond Position:  [-36.07052958]


portfolio before change:  [-25.23857861]
curr_Stock_Price:  96.95378075039463
curr_Factors:  [96.95378075]
mat_Sqrt:  [[0.15]]
grads:  [-0.10648418]
Stock Position:  -0.10648417508927496
Bond Position:  [-14.91453524]


portfolio before change:  [-25.16278305]
curr_Stock_Price:  96.17193041869912
curr_Factors:  [96.17193042]
mat_Sqrt:  [[0.15]]
grads:  [-0.24470026]
Stock Position:  -0.2447002614955336
Bond Position:  [-1.62948653]


portfolio before change:  [-24.5737471]
curr_Stock_Price:  93.76142666533855
curr_Factors:  [93.76142667]
mat_Sqrt:  [[0.15]]
grads:  [-0.08149774]
Stock Position:  -0.08149774463106096
Bond Position:  [-16.93240229]


portfolio before change:  [-24.62904552]
curr_Stock_Price:  94.33604507772685
curr_Factors:  [94.33604508]
mat_Sqrt:  [[0.15]]
grads:  [-0.09513946]
Stock Position:  -0.09513946459167108
Bond Position:  [-15.6539647]


portfolio before change:  [-24.46882368]
curr_Stock_Price:  92.56968253493847
curr_Factors:  [92.56968253]
mat_Sqrt:  [[0.15]]
grads:  [0.10724076]
Stock Position:  0.10724076069518118
Bond Position:  [-34.39606685]


portfolio before change:  [-24.47909507]
curr_Stock_Price:  92.63431226478406
curr_Factors:  [92.63431226]
mat_Sqrt:  [[0.15]]
grads:  [-0.28913421]
Stock Position:  -0.2891342094160351
Bond Position:  [2.30465357]


portfolio before change:  [-25.28780609]
curr_Stock_Price:  95.43530782862328
curr_Factors:  [95.43530783]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460789]
Stock Position:  -0.024607885143163276
Bond Position:  [-22.939345]


portfolio before change:  [-25.22481799]
curr_Stock_Price:  92.4094223570606
curr_Factors:  [92.40942236]
mat_Sqrt:  [[0.15]]
grads:  [0.05651834]
Stock Position:  0.05651833970515727
Bond Position:  [-30.44764512]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-25.22481799]
Stock Price:  93.89637739019994
PL:  [-25.22481799]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.96691020e-03]
 [-7.31661833e-03]
 [ 2.43726046e-02]
 [ 2.01956243e-03]
 [ 8.69606019e-03]
 [ 1.58378603e-02]
 [ 4.39564009e-02]
 [-1.57164018e-02]
 [ 4.94577620e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.2999688]
curr_Stock_Price:  100.31931006297965
curr_Factors:  [100.31931006]
mat_Sqrt:  [[0.15]]
grads:  [-0.02644607]
Stock Position:  -0.02644606802177883
Bond Position:  [8.9530201]


portfolio before change:  [6.29718723]
curr_Stock_Price:  100.59380056746431
curr_Factors:  [100.59380057]
mat_Sqrt:  [[0.15]]
grads:  [-0.04877746]
Stock Position:  -0.04877745550527424
Bond Position:  [11.20389687]


portfolio before change:  [6.24685238]
curr_Stock_Price:  101.74060510598206
curr_Factors:  [101.74060511]
mat_Sqrt:  [[0.15]]
grads:  [0.16248403]
Stock Position:  0.16248403052890725
Bond Position:  [-10.28437121]


portfolio before change:  [6.29868153]
curr_Stock_Price:  102.09124034291251
curr_Factors:  [102.09124034]
mat_Sqrt:  [[0.15]]
grads:  [0.01346375]
Stock Position:  0.013463749507931333
Bond Position:  [4.92415064]


portfolio before change:  [6.32752107]
curr_Stock_Price:  104.0503414912061
curr_Factors:  [104.05034149]
mat_Sqrt:  [[0.15]]
grads:  [0.05797373]
Stock Position:  0.057973734611953154
Bond Position:  [0.29533418]


portfolio before change:  [6.42398846]
curr_Stock_Price:  105.71177816290488
curr_Factors:  [105.71177816]
mat_Sqrt:  [[0.15]]
grads:  [0.10558574]
Stock Position:  0.10558573548915949
Bond Position:  [-4.73766739]


portfolio before change:  [6.63956294]
curr_Stock_Price:  107.77591968936474
curr_Factors:  [107.77591969]
mat_Sqrt:  [[0.15]]
grads:  [0.29304267]
Stock Position:  0.29304267267222195
Bond Position:  [-24.94338062]


portfolio before change:  [7.45448237]
curr_Stock_Price:  110.59937961985023
curr_Factors:  [110.59937962]
mat_Sqrt:  [[0.15]]
grads:  [-0.10477601]
Stock Position:  -0.1047760122154085
Bond Position:  [19.04264432]


portfolio before change:  [7.62892722]
curr_Stock_Price:  109.02534426470953
curr_Factors:  [109.02534426]
mat_Sqrt:  [[0.15]]
grads:  [0.03297184]
Stock Position:  0.032971841345313384
Bond Position:  [4.03416087]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.62892722]
Stock Price:  110.04812007964009
PL:  [-2.41919286]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.03119627e-05]
 [-1.91449919e-02]
 [-3.77742149e-02]
 [-9.77400863e-05]
 [ 8.54013993e-03]
 [ 1.82809158e-02]
 [ 8.56991887e-03]
 [ 1.12208826e-02]
 [ 8.48019700e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-41.11150811]
curr_Stock_Price:  97.24386695593189
curr_Factors:  [97.24386696]
mat_Sqrt:  [[0.15]]
grads:  [-0.00013541]
Stock Position:  -0.0001354130845106332
Bond Position:  [-41.09834002]


portfolio before change:  [-41.13194966]
curr_Stock_Price:  96.4112174565062
curr_Factors:  [96.41121746]
mat_Sqrt:  [[0.15]]
grads:  [-0.12763328]
Stock Position:  -0.127633279538586
Bond Position:  [-28.8266698]


portfolio before change:  [-41.10424221]
curr_Stock_Price:  96.08117507716612
curr_Factors:  [96.08117508]
mat_Sqrt:  [[0.15]]
grads:  [-0.2518281]
Stock Position:  -0.25182809900085984
Bond Position:  [-16.90830254]


portfolio before change:  [-41.51158961]
curr_Stock_Price:  97.66515689974963
curr_Factors:  [97.6651569]
mat_Sqrt:  [[0.15]]
grads:  [-0.0006516]
Stock Position:  -0.0006516005754611184
Bond Position:  [-41.44795094]


portfolio before change:  [-41.53321189]
curr_Stock_Price:  99.03582705469853
curr_Factors:  [99.03582705]
mat_Sqrt:  [[0.15]]
grads:  [0.05693427]
Stock Position:  0.0569342661807899
Bond Position:  [-47.17174403]


portfolio before change:  [-41.49409493]
curr_Stock_Price:  100.13725053242878
curr_Factors:  [100.13725053]
mat_Sqrt:  [[0.15]]
grads:  [0.12187277]
Stock Position:  0.12187277176264949
Bond Position:  [-53.69809921]


portfolio before change:  [-41.35185475]
curr_Stock_Price:  101.52472972836847
curr_Factors:  [101.52472973]
mat_Sqrt:  [[0.15]]
grads:  [0.05713279]
Stock Position:  0.05713279247682379
Bond Position:  [-47.15224607]


portfolio before change:  [-41.42880409]
curr_Stock_Price:  100.5906371868236
curr_Factors:  [100.59063719]
mat_Sqrt:  [[0.15]]
grads:  [0.07480588]
Stock Position:  0.07480588394127562
Bond Position:  [-48.95357562]


portfolio before change:  [-41.59738908]
curr_Stock_Price:  98.66429028536045
curr_Factors:  [98.66429029]
mat_Sqrt:  [[0.15]]
grads:  [0.05653465]
Stock Position:  0.056534646667179396
Bond Position:  [-47.17533987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-41.59738908]
Stock Price:  99.36842502699213
PL:  [-41.59738908]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00427841]
 [ 0.00280304]
 [ 0.03341612]
 [ 0.00280462]
 [ 0.01546759]
 [ 0.01787838]
 [ 0.00300309]
 [ 0.01083821]
 [ 0.00689085]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.86368193]
curr_Stock_Price:  100.29100941623881
curr_Factors:  [100.29100942]
mat_Sqrt:  [[0.15]]
grads:  [-0.0285227]
Stock Position:  -0.028522702195538444
Bond Position:  [8.72425252]


portfolio before change:  [5.82809661]
curr_Stock_Price:  101.69159648542771
curr_Factors:  [101.69159649]
mat_Sqrt:  [[0.15]]
grads:  [0.01868691]
Stock Position:  0.018686912343130815
Bond Position:  [3.92779466]


portfolio before change:  [5.83748025]
curr_Stock_Price:  102.08862557214007
curr_Factors:  [102.08862557]
mat_Sqrt:  [[0.15]]
grads:  [0.22277413]
Stock Position:  0.22277412713307937
Bond Position:  [-16.9052242]


portfolio before change:  [5.64118587]
curr_Stock_Price:  101.24544121919662
curr_Factors:  [101.24544122]
mat_Sqrt:  [[0.15]]
grads:  [0.01869745]
Stock Position:  0.018697454592992015
Bond Position:  [3.74815383]


portfolio before change:  [5.64202912]
curr_Stock_Price:  101.19028431075353
curr_Factors:  [101.19028431]
mat_Sqrt:  [[0.15]]
grads:  [0.10311728]
Stock Position:  0.10311728065586094
Bond Position:  [-4.79243783]


portfolio before change:  [5.64764345]
curr_Stock_Price:  101.26797400714139
curr_Factors:  [101.26797401]
mat_Sqrt:  [[0.15]]
grads:  [0.11918922]
Stock Position:  0.11918922131061448
Bond Position:  [-6.42240752]


portfolio before change:  [5.57826028]
curr_Stock_Price:  100.71279658764058
curr_Factors:  [100.71279659]
mat_Sqrt:  [[0.15]]
grads:  [0.02002058]
Stock Position:  0.020020579259553188
Bond Position:  [3.56193175]


portfolio before change:  [5.61066138]
curr_Stock_Price:  102.2422071975776
curr_Factors:  [102.2422072]
mat_Sqrt:  [[0.15]]
grads:  [0.07225475]
Stock Position:  0.07225474839203748
Bond Position:  [-1.77682358]


portfolio before change:  [5.71249081]
curr_Stock_Price:  103.66381713047296
curr_Factors:  [103.66381713]
mat_Sqrt:  [[0.15]]
grads:  [0.04593902]
Stock Position:  0.045939018591483895
Bond Position:  [0.95027679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.71249081]
Stock Price:  104.42212079761995
PL:  [1.29037001]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.00765219]
 [-0.02144594]
 [-0.04578616]
 [-0.00937112]
 [-0.0226686 ]
 [ 0.01628391]
 [-0.04676708]
 [-0.01347873]
 [ 0.00850475]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-33.75232926]
curr_Stock_Price:  97.72123525015397
curr_Factors:  [97.72123525]
mat_Sqrt:  [[0.15]]
grads:  [0.05101461]
Stock Position:  0.05101460733843692
Bond Position:  [-38.73753971]


portfolio before change:  [-33.85860855]
curr_Stock_Price:  96.01769033717376
curr_Factors:  [96.01769034]
mat_Sqrt:  [[0.15]]
grads:  [-0.14297296]
Stock Position:  -0.14297295740501742
Bond Position:  [-20.1306754]


portfolio before change:  [-33.78051967]
curr_Stock_Price:  95.40109307305784
curr_Factors:  [95.40109307]
mat_Sqrt:  [[0.15]]
grads:  [-0.30524109]
Stock Position:  -0.305241087522528
Bond Position:  [-4.66018627]


portfolio before change:  [-33.47179182]
curr_Stock_Price:  94.38203455866943
curr_Factors:  [94.38203456]
mat_Sqrt:  [[0.15]]
grads:  [-0.06247416]
Stock Position:  -0.062474162801092324
Bond Position:  [-27.57535322]


portfolio before change:  [-33.39206281]
curr_Stock_Price:  92.8850937054196
curr_Factors:  [92.88509371]
mat_Sqrt:  [[0.15]]
grads:  [-0.15112401]
Stock Position:  -0.1511240132704869
Bond Position:  [-19.35489468]


portfolio before change:  [-33.46566155]
curr_Stock_Price:  93.30805011581921
curr_Factors:  [93.30805012]
mat_Sqrt:  [[0.15]]
grads:  [0.10855942]
Stock Position:  0.1085594248086371
Bond Position:  [-43.5951298]


portfolio before change:  [-33.67117379]
curr_Stock_Price:  91.61580441113232
curr_Factors:  [91.61580441]
mat_Sqrt:  [[0.15]]
grads:  [-0.31178053]
Stock Position:  -0.3117805293193196
Bond Position:  [-5.10714979]


portfolio before change:  [-33.79051251]
curr_Stock_Price:  91.99037722771044
curr_Factors:  [91.99037723]
mat_Sqrt:  [[0.15]]
grads:  [-0.08985817]
Stock Position:  -0.08985817247102935
Bond Position:  [-25.52442533]


portfolio before change:  [-33.89079318]
curr_Stock_Price:  92.96430382206015
curr_Factors:  [92.96430382]
mat_Sqrt:  [[0.15]]
grads:  [0.05669831]
Stock Position:  0.056698311668503705
Bond Position:  [-39.16171225]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-33.89079318]
Stock Price:  92.6085423145043
PL:  [-33.89079318]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [-0.00371496]
 [-0.02730009]
 [-0.01911624]
 [-0.00435977]
 [-0.00359892]
 [ 0.01652587]
 [-0.04143969]
 [-0.00726335]
 [ 0.00855756]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.49467502]
curr_Stock_Price:  99.61909325687304
curr_Factors:  [99.61909326]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476637]
Stock Position:  -0.02476637490742667
Bond Position:  [-2.02747121]


portfolio before change:  [-4.50161206]
curr_Stock_Price:  99.85825009534655
curr_Factors:  [99.8582501]
mat_Sqrt:  [[0.15]]
grads:  [-0.18200057]
Stock Position:  -0.18200057145885365
Bond Position:  [13.67264652]


portfolio before change:  [-4.09734082]
curr_Stock_Price:  97.67455804059372
curr_Factors:  [97.67455804]
mat_Sqrt:  [[0.15]]
grads:  [-0.12744161]
Stock Position:  -0.12744161202782722
Bond Position:  [8.35046231]


portfolio before change:  [-3.84063481]
curr_Stock_Price:  95.69302520979001
curr_Factors:  [95.69302521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02906515]
Stock Position:  -0.029065153110208384
Bond Position:  [-1.05930238]


portfolio before change:  [-3.85531721]
curr_Stock_Price:  96.17995261980337
curr_Factors:  [96.17995262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02399281]
Stock Position:  -0.023992813147063335
Bond Position:  [-1.54768958]


portfolio before change:  [-3.808783]
curr_Stock_Price:  94.2081848848717
curr_Factors:  [94.20818488]
mat_Sqrt:  [[0.15]]
grads:  [0.11017249]
Stock Position:  0.11017249025912396
Bond Position:  [-14.18793333]


portfolio before change:  [-3.92612371]
curr_Stock_Price:  93.20752695585891
curr_Factors:  [93.20752696]
mat_Sqrt:  [[0.15]]
grads:  [-0.27626459]
Stock Position:  -0.27626458549605254
Bond Position:  [21.82381509]


portfolio before change:  [-4.18331903]
curr_Stock_Price:  94.17800946411599
curr_Factors:  [94.17800946]
mat_Sqrt:  [[0.15]]
grads:  [-0.04842232]
Stock Position:  -0.04842232120733782
Bond Position:  [0.3769988]


portfolio before change:  [-4.1980907]
curr_Stock_Price:  94.48696242842847
curr_Factors:  [94.48696243]
mat_Sqrt:  [[0.15]]
grads:  [0.05705043]
Stock Position:  0.05705043098319831
Bond Position:  [-9.58861263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.1980907]
Stock Price:  94.64790212050268
PL:  [-4.1980907]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-3.97587448e-03]
 [-1.81626376e-02]
 [-1.15324115e-02]
 [-3.67163765e-03]
 [ 3.61742958e-03]
 [ 1.78198481e-02]
 [-3.00856856e-02]
 [-2.08449935e-04]
 [ 8.53884415e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.28741324]
curr_Stock_Price:  100.31849562071515
curr_Factors:  [100.31849562]
mat_Sqrt:  [[0.15]]
grads:  [-0.02650583]
Stock Position:  -0.02650582985883075
Bond Position:  [8.94643822]


portfolio before change:  [6.3403536]
curr_Stock_Price:  98.4899913274065
curr_Factors:  [98.48999133]
mat_Sqrt:  [[0.15]]
grads:  [-0.12108425]
Stock Position:  -0.12108425086110787
Bond Position:  [18.26594042]


portfolio before change:  [6.3143184]
curr_Stock_Price:  98.78045398857532
curr_Factors:  [98.78045399]
mat_Sqrt:  [[0.15]]
grads:  [-0.07688274]
Stock Position:  -0.07688274330771047
Bond Position:  [13.90883069]


portfolio before change:  [6.53061175]
curr_Stock_Price:  96.05764278994822
curr_Factors:  [96.05764279]
mat_Sqrt:  [[0.15]]
grads:  [-0.02447758]
Stock Position:  -0.0244775843200828
Bond Position:  [8.8818708]


portfolio before change:  [6.50153926]
curr_Stock_Price:  97.4268357103292
curr_Factors:  [97.42683571]
mat_Sqrt:  [[0.15]]
grads:  [0.0241162]
Stock Position:  0.024116197194115584
Bond Position:  [4.15197448]


portfolio before change:  [6.48981788]
curr_Stock_Price:  96.85469372405205
curr_Factors:  [96.85469372]
mat_Sqrt:  [[0.15]]
grads:  [0.11879899]
Stock Position:  0.11879898701635082
Bond Position:  [-5.01642163]


portfolio before change:  [6.46636067]
curr_Stock_Price:  96.67835915633765
curr_Factors:  [96.67835916]
mat_Sqrt:  [[0.15]]
grads:  [-0.20057124]
Stock Position:  -0.2005712376214773
Bond Position:  [25.85725882]


portfolio before change:  [6.4827485]
curr_Stock_Price:  96.6611285277018
curr_Factors:  [96.66112853]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138967]
Stock Position:  -0.0013896662315467637
Bond Position:  [6.61707521]


portfolio before change:  [6.48742175]
curr_Stock_Price:  95.67968522432594
curr_Factors:  [95.67968522]
mat_Sqrt:  [[0.15]]
grads:  [0.05692563]
Stock Position:  0.056925627634117654
Bond Position:  [1.04079561]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.48742175]
Stock Price:  96.53663600386263
PL:  [6.48742175]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.0175222 ]
 [-0.02568052]
 [-0.03637617]
 [-0.00300308]
 [-0.00359402]
 [ 0.01852924]
 [-0.00688151]
 [ 0.00272911]
 [ 0.00846386]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.65533043]
curr_Stock_Price:  99.02486847477813
curr_Factors:  [99.02486847]
mat_Sqrt:  [[0.15]]
grads:  [0.11681465]
Stock Position:  0.11681465338432842
Bond Position:  [-25.22288612]


portfolio before change:  [-14.10382828]
curr_Stock_Price:  95.2934594088898
curr_Factors:  [95.29345941]
mat_Sqrt:  [[0.15]]
grads:  [-0.17120346]
Stock Position:  -0.17120346197514116
Bond Position:  [2.21074187]


portfolio before change:  [-14.25789909]
curr_Stock_Price:  96.19984557230474
curr_Factors:  [96.19984557]
mat_Sqrt:  [[0.15]]
grads:  [-0.24250783]
Stock Position:  -0.24250783209714943
Bond Position:  [9.07131691]


portfolio before change:  [-14.30478366]
curr_Stock_Price:  96.41188558929596
curr_Factors:  [96.41188559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02002055]
Stock Position:  -0.020020549610705273
Bond Position:  [-12.37456472]


portfolio before change:  [-14.30634602]
curr_Stock_Price:  96.18079947123603
curr_Factors:  [96.18079947]
mat_Sqrt:  [[0.15]]
grads:  [-0.02396014]
Stock Position:  -0.023960137623844406
Bond Position:  [-12.00184082]


portfolio before change:  [-14.36389077]
curr_Stock_Price:  98.33196950489801
curr_Factors:  [98.3319695]
mat_Sqrt:  [[0.15]]
grads:  [0.12352827]
Stock Position:  0.12352827061376428
Bond Position:  [-26.51066891]


portfolio before change:  [-14.2411395]
curr_Stock_Price:  99.43301235225063
curr_Factors:  [99.43301235]
mat_Sqrt:  [[0.15]]
grads:  [-0.04587671]
Stock Position:  -0.04587671011753056
Bond Position:  [-9.67948001]


portfolio before change:  [-14.18649587]
curr_Stock_Price:  98.13639422282576
curr_Factors:  [98.13639422]
mat_Sqrt:  [[0.15]]
grads:  [0.01819409]
Stock Position:  0.01819408827189103
Bond Position:  [-15.97199809]


portfolio before change:  [-14.18172679]
curr_Stock_Price:  98.83756019869551
curr_Factors:  [98.8375602]
mat_Sqrt:  [[0.15]]
grads:  [0.05642571]
Stock Position:  0.056425707736644806
Bond Position:  [-19.75870608]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.18172679]
Stock Price:  98.04499990409958
PL:  [-14.18172679]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.01860199]
 [-0.01939804]
 [-0.0137063 ]
 [ 0.00469673]
 [ 0.00828104]
 [ 0.01845573]
 [-0.02271331]
 [ 0.00294735]
 [ 0.00846747]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.37965871]
curr_Stock_Price:  98.65354813013113
curr_Factors:  [98.65354813]
mat_Sqrt:  [[0.15]]
grads:  [0.12401327]
Stock Position:  0.1240132658726889
Bond Position:  [-31.6140074]


portfolio before change:  [-19.34898946]
curr_Stock_Price:  99.02834842646614
curr_Factors:  [99.02834843]
mat_Sqrt:  [[0.15]]
grads:  [-0.12932029]
Stock Position:  -0.12932028611208762
Bond Position:  [-6.5426151]


portfolio before change:  [-19.25913691]
curr_Stock_Price:  98.30823964799984
curr_Factors:  [98.30823965]
mat_Sqrt:  [[0.15]]
grads:  [-0.09137536]
Stock Position:  -0.09137535972366669
Bond Position:  [-10.27618615]


portfolio before change:  [-19.39743333]
curr_Stock_Price:  99.76549297449706
curr_Factors:  [99.76549297]
mat_Sqrt:  [[0.15]]
grads:  [0.03131153]
Stock Position:  0.03131153066540989
Bond Position:  [-22.52124363]


portfolio before change:  [-19.43451164]
curr_Stock_Price:  98.94104051762187
curr_Factors:  [98.94104052]
mat_Sqrt:  [[0.15]]
grads:  [0.05520696]
Stock Position:  0.05520696428217113
Bond Position:  [-24.89674613]


portfolio before change:  [-19.49690275]
curr_Stock_Price:  98.03645125586345
curr_Factors:  [98.03645126]
mat_Sqrt:  [[0.15]]
grads:  [0.1230382]
Stock Position:  0.12303820449125163
Bond Position:  [-31.55913169]


portfolio before change:  [-19.53826014]
curr_Stock_Price:  97.82859813964906
curr_Factors:  [97.82859814]
mat_Sqrt:  [[0.15]]
grads:  [-0.15142206]
Stock Position:  -0.1514220587831287
Bond Position:  [-4.7248524]


portfolio before change:  [-19.6268023]
curr_Stock_Price:  98.39773016909659
curr_Factors:  [98.39773017]
mat_Sqrt:  [[0.15]]
grads:  [0.01964902]
Stock Position:  0.019649018309922345
Bond Position:  [-21.5602211]


portfolio before change:  [-19.62969597]
curr_Stock_Price:  98.79923274209916
curr_Factors:  [98.79923274]
mat_Sqrt:  [[0.15]]
grads:  [0.05644981]
Stock Position:  0.05644980512349836
Bond Position:  [-25.20689341]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.62969597]
Stock Price:  100.56896276414189
PL:  [-20.19865874]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[2.31242175]
 [0.03862704]
 [0.00268004]
 [0.03636148]
 [0.00456978]
 [0.016015  ]
 [0.0175729 ]
 [0.02503017]
 [0.00357935]
 [0.00695113]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [26.72836966]
curr_Stock_Price:  101.64444036307594
curr_Factors:  [101.64444036]
mat_Sqrt:  [[0.15]]
grads:  [0.25751363]
Stock Position:  0.25751362805837724
Bond Position:  [0.55354105]


portfolio before change:  [26.77299336]
curr_Stock_Price:  101.81665206640008
curr_Factors:  [101.81665207]
mat_Sqrt:  [[0.15]]
grads:  [0.01786694]
Stock Position:  0.017866941429005592
Bond Position:  [24.9538412]


portfolio before change:  [26.79261952]
curr_Stock_Price:  102.21661536516844
curr_Factors:  [102.21661537]
mat_Sqrt:  [[0.15]]
grads:  [0.24240986]
Stock Position:  0.24240986211963797
Bond Position:  [2.01430389]


portfolio before change:  [26.39332963]
curr_Stock_Price:  100.5652910474678
curr_Factors:  [100.56529105]
mat_Sqrt:  [[0.15]]
grads:  [0.03046519]
Stock Position:  0.03046518553248203
Bond Position:  [23.32958938]


portfolio before change:  [26.40622943]
curr_Stock_Price:  100.6057338193187
curr_Factors:  [100.60573382]
mat_Sqrt:  [[0.15]]
grads:  [0.10676669]
Stock Position:  0.10676668639004422
Bond Position:  [15.6648886]


portfolio before change:  [26.52662554]
curr_Stock_Price:  101.66001120368635
curr_Factors:  [101.6600112]
mat_Sqrt:  [[0.15]]
grads:  [0.11715264]
Stock Position:  0.11715264439176104
Bond Position:  [14.6168864]


portfolio before change:  [26.86434509]
curr_Stock_Price:  104.48034254960793
curr_Factors:  [104.48034255]
mat_Sqrt:  [[0.15]]
grads:  [0.16686782]
Stock Position:  0.1668678196213016
Bond Position:  [9.42993813]


portfolio before change:  [27.02004434]
curr_Stock_Price:  105.38514917781025
curr_Factors:  [105.38514918]
mat_Sqrt:  [[0.15]]
grads:  [0.02386235]
Stock Position:  0.023862348431213418
Bond Position:  [24.50530719]


portfolio before change:  [26.98764291]
curr_Stock_Price:  103.5137007471268
curr_Factors:  [103.51370075]
mat_Sqrt:  [[0.15]]
grads:  [0.04634085]
Stock Position:  0.046340847854287444
Bond Position:  [22.19073025]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.98764291]
Stock Price:  104.2743735057307
PL:  [22.7132694]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 5.24920824e-02]
 [ 1.58266160e-03]
 [-5.23411570e-03]
 [ 3.63592499e-03]
 [ 1.65392151e-02]
 [ 1.85660289e-02]
 [ 1.05067858e-02]
 [ 1.09629841e-02]
 [ 7.49190527e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [32.73758966]
curr_Stock_Price:  102.0342407960132
curr_Factors:  [102.0342408]
mat_Sqrt:  [[0.15]]
grads:  [0.34994722]
Stock Position:  0.349947215864281
Bond Position:  [-2.96900883]


portfolio before change:  [33.05041685]
curr_Stock_Price:  102.93241071164152
curr_Factors:  [102.93241071]
mat_Sqrt:  [[0.15]]
grads:  [0.01055108]
Stock Position:  0.010551077321472325
Bond Position:  [31.96436902]


portfolio before change:  [33.04196746]
curr_Stock_Price:  100.61648009295672
curr_Factors:  [100.61648009]
mat_Sqrt:  [[0.15]]
grads:  [-0.0348941]
Stock Position:  -0.034894104663689585
Bond Position:  [36.55288945]


portfolio before change:  [33.05131895]
curr_Stock_Price:  100.87238376042967
curr_Factors:  [100.87238376]
mat_Sqrt:  [[0.15]]
grads:  [0.0242395]
Stock Position:  0.024239499917295973
Bond Position:  [30.60622281]


portfolio before change:  [33.06290568]
curr_Stock_Price:  100.71890670941121
curr_Factors:  [100.71890671]
mat_Sqrt:  [[0.15]]
grads:  [0.11026143]
Stock Position:  0.11026143420500052
Bond Position:  [21.95749457]


portfolio before change:  [32.83830452]
curr_Stock_Price:  98.5823241567556
curr_Factors:  [98.58232416]
mat_Sqrt:  [[0.15]]
grads:  [0.12377353]
Stock Position:  0.1237735260996444
Bond Position:  [20.63642264]


portfolio before change:  [33.25631482]
curr_Stock_Price:  101.87615863569255
curr_Factors:  [101.87615864]
mat_Sqrt:  [[0.15]]
grads:  [0.07004524]
Stock Position:  0.07004523843901857
Bond Position:  [26.12037499]


portfolio before change:  [33.29200586]
curr_Stock_Price:  102.19920117070507
curr_Factors:  [102.19920117]
mat_Sqrt:  [[0.15]]
grads:  [0.07308656]
Stock Position:  0.07308656087853165
Bond Position:  [25.82261772]


portfolio before change:  [33.28103349]
curr_Stock_Price:  101.8723708168906
curr_Factors:  [101.87237082]
mat_Sqrt:  [[0.15]]
grads:  [0.04994604]
Stock Position:  0.04994603514586457
Bond Position:  [28.19291248]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [33.28103349]
Stock Price:  101.64862789238313
PL:  [31.6324056]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 2.80517160e-02]
 [-1.57738596e-02]
 [-1.15401184e-02]
 [ 1.06699018e-03]
 [ 6.28149637e-03]
 [ 1.84625633e-02]
 [-3.44144854e-02]
 [-4.66424633e-04]
 [ 8.47046267e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.63261689]
curr_Stock_Price:  101.37876092326516
curr_Factors:  [101.37876092]
mat_Sqrt:  [[0.15]]
grads:  [0.18701144]
Stock Position:  0.18701143984686994
Bond Position:  [3.67362884]


portfolio before change:  [22.43373618]
curr_Stock_Price:  100.30546838222294
curr_Factors:  [100.30546838]
mat_Sqrt:  [[0.15]]
grads:  [-0.10515906]
Stock Position:  -0.10515906426384841
Bond Position:  [32.98176538]


portfolio before change:  [22.61077632]
curr_Stock_Price:  98.77877988349164
curr_Factors:  [98.77877988]
mat_Sqrt:  [[0.15]]
grads:  [-0.07693412]
Stock Position:  -0.07693412286299488
Bond Position:  [30.21023511]


portfolio before change:  [22.67127612]
curr_Stock_Price:  98.188782878884
curr_Factors:  [98.18878288]
mat_Sqrt:  [[0.15]]
grads:  [0.00711327]
Stock Position:  0.007113267844625771
Bond Position:  [21.97283301]


portfolio before change:  [22.68288586]
curr_Stock_Price:  98.27602462296842
curr_Factors:  [98.27602462]
mat_Sqrt:  [[0.15]]
grads:  [0.04187664]
Stock Position:  0.04187664247461799
Bond Position:  [18.56741591]


portfolio before change:  [22.68266511]
curr_Stock_Price:  98.04900617991723
curr_Factors:  [98.04900618]
mat_Sqrt:  [[0.15]]
grads:  [0.12308376]
Stock Position:  0.12308375531340135
Bond Position:  [10.61442523]


portfolio before change:  [22.36363741]
curr_Stock_Price:  95.41392045936675
curr_Factors:  [95.41392046]
mat_Sqrt:  [[0.15]]
grads:  [-0.2294299]
Stock Position:  -0.2294299025812156
Bond Position:  [44.25444388]


portfolio before change:  [22.12045548]
curr_Stock_Price:  96.57032893433387
curr_Factors:  [96.57032893]
mat_Sqrt:  [[0.15]]
grads:  [-0.0031095]
Stock Position:  -0.0031094975555632865
Bond Position:  [22.42074068]


portfolio before change:  [22.12949585]
curr_Stock_Price:  97.26909091623271
curr_Factors:  [97.26909092]
mat_Sqrt:  [[0.15]]
grads:  [0.05646975]
Stock Position:  0.056469751151843654
Bond Position:  [16.6367345]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.12949585]
Stock Price:  99.09304731137769
PL:  [22.12949585]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.31242175]
 [ 0.00268486]
 [ 0.00297776]
 [-0.01549898]
 [ 0.00487598]
 [ 0.00696101]
 [ 0.01716864]
 [-0.00273219]
 [ 0.00575752]
 [ 0.00730502]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.22098929]
curr_Stock_Price:  100.57365513347713
curr_Factors:  [100.57365513]
mat_Sqrt:  [[0.15]]
grads:  [0.01789908]
Stock Position:  0.01789908205441338
Bond Position:  [8.42081318]


portfolio before change:  [10.23769838]
curr_Stock_Price:  101.27188271181777
curr_Factors:  [101.27188271]
mat_Sqrt:  [[0.15]]
grads:  [0.01985171]
Stock Position:  0.01985171006747401
Bond Position:  [8.22727833]


portfolio before change:  [10.21954319]
curr_Stock_Price:  100.15007214950676
curr_Factors:  [100.15007215]
mat_Sqrt:  [[0.15]]
grads:  [-0.1033265]
Stock Position:  -0.10332650295814141
Bond Position:  [20.56769992]


portfolio before change:  [10.24222948]
curr_Stock_Price:  100.03006553042353
curr_Factors:  [100.03006553]
mat_Sqrt:  [[0.15]]
grads:  [0.0325065]
Stock Position:  0.03250650485052382
Bond Position:  [6.99060167]


portfolio before change:  [10.19462731]
curr_Stock_Price:  98.45812348049645
curr_Factors:  [98.45812348]
mat_Sqrt:  [[0.15]]
grads:  [0.04640673]
Stock Position:  0.04640673229956713
Bond Position:  [5.62550753]


portfolio before change:  [10.37806713]
curr_Stock_Price:  102.35036836839798
curr_Factors:  [102.35036837]
mat_Sqrt:  [[0.15]]
grads:  [0.11445761]
Stock Position:  0.11445761231428628
Bond Position:  [-1.33671165]


portfolio before change:  [10.10393678]
curr_Stock_Price:  99.96117100591894
curr_Factors:  [99.96117101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0182146]
Stock Position:  -0.018214597602722003
Bond Position:  [11.92468929]


portfolio before change:  [10.12272086]
curr_Stock_Price:  99.2573268130193
curr_Factors:  [99.25732681]
mat_Sqrt:  [[0.15]]
grads:  [0.03838349]
Stock Position:  0.03838348529972956
Bond Position:  [6.31287871]


portfolio before change:  [10.25502634]
curr_Stock_Price:  102.62200955750957
curr_Factors:  [102.62200956]
mat_Sqrt:  [[0.15]]
grads:  [0.04870011]
Stock Position:  0.0487001138567181
Bond Position:  [5.25732279]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.25502634]
Stock Price:  105.75933474082314
PL:  [4.4956916]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 4.02141347e-03]
 [-1.65814479e-02]
 [-1.09949310e-02]
 [ 2.66388331e-04]
 [ 7.98290972e-03]
 [ 1.81917551e-02]
 [-3.07523809e-02]
 [-1.03686543e-03]
 [ 8.53548198e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.90295616]
curr_Stock_Price:  100.61789231958605
curr_Factors:  [100.61789232]
mat_Sqrt:  [[0.15]]
grads:  [0.02680942]
Stock Position:  0.02680942315173516
Bond Position:  [8.20544851]


portfolio before change:  [10.89794586]
curr_Stock_Price:  100.27793532771966
curr_Factors:  [100.27793533]
mat_Sqrt:  [[0.15]]
grads:  [-0.11054299]
Stock Position:  -0.11054298595692144
Bond Position:  [21.98296826]


portfolio before change:  [11.06157005]
curr_Stock_Price:  98.89720585595482
curr_Factors:  [98.89720586]
mat_Sqrt:  [[0.15]]
grads:  [-0.07329954]
Stock Position:  -0.07329953990961915
Bond Position:  [18.31068974]


portfolio before change:  [11.14903713]
curr_Stock_Price:  97.8288575481171
curr_Factors:  [97.82885755]
mat_Sqrt:  [[0.15]]
grads:  [0.00177592]
Stock Position:  0.0017759222089463143
Bond Position:  [10.97530069]


portfolio before change:  [11.1563076]
curr_Stock_Price:  98.83197185357143
curr_Factors:  [98.83197185]
mat_Sqrt:  [[0.15]]
grads:  [0.0532194]
Stock Position:  0.05321939815406354
Bond Position:  [5.89652954]


portfolio before change:  [11.09110518]
curr_Stock_Price:  97.55139696671897
curr_Factors:  [97.55139697]
mat_Sqrt:  [[0.15]]
grads:  [0.12127837]
Stock Position:  0.12127836734981172
Bond Position:  [-0.73976898]


portfolio before change:  [10.97157328]
curr_Stock_Price:  96.56884811851735
curr_Factors:  [96.56884812]
mat_Sqrt:  [[0.15]]
grads:  [-0.20501587]
Stock Position:  -0.20501587257355072
Bond Position:  [30.76971994]


portfolio before change:  [11.02782119]
curr_Stock_Price:  96.3695503585877
curr_Factors:  [96.36955036]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691244]
Stock Position:  -0.006912436213673237
Bond Position:  [11.69396956]


portfolio before change:  [11.03695757]
curr_Stock_Price:  95.89389577205772
curr_Factors:  [95.89389577]
mat_Sqrt:  [[0.15]]
grads:  [0.05690321]
Stock Position:  0.05690321321070151
Bond Position:  [5.58028678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.03695757]
Stock Price:  95.41972067423873
PL:  [11.03695757]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [-2.84590231e-03]
 [-1.46256829e-02]
 [-3.68805660e-02]
 [-4.46156996e-03]
 [-5.84465387e-03]
 [ 1.81711243e-02]
 [-3.03590990e-02]
 [ 2.17245050e-03]
 [ 8.52418732e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.87325052]
curr_Stock_Price:  99.46480205804929
curr_Factors:  [99.46480206]
mat_Sqrt:  [[0.15]]
grads:  [-0.01897268]
Stock Position:  -0.01897268209112188
Bond Position:  [-4.98613645]


portfolio before change:  [-6.83688868]
curr_Stock_Price:  97.41682988212449
curr_Factors:  [97.41682988]
mat_Sqrt:  [[0.15]]
grads:  [-0.09750455]
Stock Position:  -0.09750455283998814
Bond Position:  [2.66169575]


portfolio before change:  [-6.71272138]
curr_Stock_Price:  96.15703109264165
curr_Factors:  [96.15703109]
mat_Sqrt:  [[0.15]]
grads:  [-0.24587044]
Stock Position:  -0.245870440278211
Bond Position:  [16.92945019]


portfolio before change:  [-6.57690733]
curr_Stock_Price:  95.6390867275276
curr_Factors:  [95.63908673]
mat_Sqrt:  [[0.15]]
grads:  [-0.0297438]
Stock Position:  -0.02974379975611688
Bond Position:  [-3.73223749]


portfolio before change:  [-6.58332021]
curr_Stock_Price:  95.79193510889108
curr_Factors:  [95.79193511]
mat_Sqrt:  [[0.15]]
grads:  [-0.03896436]
Stock Position:  -0.03896435915646484
Bond Position:  [-2.85084885]


portfolio before change:  [-6.6518252]
curr_Stock_Price:  97.5134879477125
curr_Factors:  [97.51348795]
mat_Sqrt:  [[0.15]]
grads:  [0.12114083]
Stock Position:  0.12114082872550477
Bond Position:  [-18.46468994]


portfolio before change:  [-6.76773622]
curr_Stock_Price:  96.63288993397872
curr_Factors:  [96.63288993]
mat_Sqrt:  [[0.15]]
grads:  [-0.20239399]
Stock Position:  -0.2023939930596738
Bond Position:  [12.79018023]


portfolio before change:  [-6.97344869]
curr_Stock_Price:  97.68089119258052
curr_Factors:  [97.68089119]
mat_Sqrt:  [[0.15]]
grads:  [0.014483]
Stock Position:  0.014483003334290308
Bond Position:  [-8.38816136]


portfolio before change:  [-6.99310281]
curr_Stock_Price:  96.61350280227607
curr_Factors:  [96.6135028]
mat_Sqrt:  [[0.15]]
grads:  [0.05682792]
Stock Position:  0.05682791544016997
Bond Position:  [-12.48344678]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.99310281]
Stock Price:  98.10085689962914
PL:  [-6.99310281]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.84029122e-02]
 [-1.86257533e-02]
 [-1.54065393e-02]
 [ 4.15929132e-04]
 [ 1.05207645e-02]
 [ 1.83138078e-02]
 [-2.70216932e-02]
 [ 1.85241039e-03]
 [ 8.35101278e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.40597025]
curr_Stock_Price:  98.58697431823784
curr_Factors:  [98.58697432]
mat_Sqrt:  [[0.15]]
grads:  [0.12268608]
Stock Position:  0.1226860813668689
Bond Position:  [-32.5012198]


portfolio before change:  [-20.40091665]
curr_Stock_Price:  98.7606555894391
curr_Factors:  [98.76065559]
mat_Sqrt:  [[0.15]]
grads:  [-0.12417169]
Stock Position:  -0.12417168889576904
Bond Position:  [-8.13763924]


portfolio before change:  [-20.31240927]
curr_Stock_Price:  98.0150974966422
curr_Factors:  [98.0150975]
mat_Sqrt:  [[0.15]]
grads:  [-0.10271026]
Stock Position:  -0.10271026187104601
Bond Position:  [-10.24525294]


portfolio before change:  [-20.30530952]
curr_Stock_Price:  97.89608637421378
curr_Factors:  [97.89608637]
mat_Sqrt:  [[0.15]]
grads:  [0.00277286]
Stock Position:  0.0027728608817381532
Bond Position:  [-20.57676175]


portfolio before change:  [-20.31010614]
curr_Stock_Price:  99.87755285015515
curr_Factors:  [99.87755285]
mat_Sqrt:  [[0.15]]
grads:  [0.07013843]
Stock Position:  0.07013843014524034
Bond Position:  [-27.3153609]


portfolio before change:  [-20.4711901]
curr_Stock_Price:  97.77566850796514
curr_Factors:  [97.77566851]
mat_Sqrt:  [[0.15]]
grads:  [0.12209205]
Stock Position:  0.12209205232670182
Bond Position:  [-32.40882214]


portfolio before change:  [-20.55915949]
curr_Stock_Price:  97.1879076959183
curr_Factors:  [97.1879077]
mat_Sqrt:  [[0.15]]
grads:  [-0.18014462]
Stock Position:  -0.1801446210364433
Bond Position:  [-3.05128069]


portfolio before change:  [-20.60630177]
curr_Stock_Price:  97.44112791119633
curr_Factors:  [97.44112791]
mat_Sqrt:  [[0.15]]
grads:  [0.0123494]
Stock Position:  0.012349402608309972
Bond Position:  [-21.80964149]


portfolio before change:  [-20.57916982]
curr_Stock_Price:  100.52139874567234
curr_Factors:  [100.52139875]
mat_Sqrt:  [[0.15]]
grads:  [0.05567342]
Stock Position:  0.05567341851854739
Bond Position:  [-26.17553972]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.57916982]
Stock Price:  102.36155141609751
PL:  [-22.94072123]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.31242175e+00]
 [ 1.84230474e-02]
 [-1.86446616e-02]
 [-1.44779258e-02]
 [ 3.07780767e-03]
 [ 1.64751575e-02]
 [ 1.68559007e-02]
 [ 7.81987644e-04]
 [ 1.25157092e-02]
 [ 7.58911610e-03]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.31242175]
mat_Sqrt:  [[0.15]]
grads:  [15.41614501]
init_Out:  [2.1473646]
Stock Position:  15.41614500938417
Bond position:  [-1539.46713634]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.30216667]
curr_Stock_Price:  98.59370775092955
curr_Factors:  [98.59370775]
mat_Sqrt:  [[0.15]]
grads:  [0.12282032]
Stock Position:  0.12282031594477902
Bond Position:  [-32.41147701]


portfolio before change:  [-20.29651461]
curr_Stock_Price:  98.77170640078975
curr_Factors:  [98.7717064]
mat_Sqrt:  [[0.15]]
grads:  [-0.12429774]
Stock Position:  -0.12429774430855917
Bond Position:  [-8.01941431]


portfolio before change:  [-20.22208363]
curr_Stock_Price:  98.1406274465075
curr_Factors:  [98.14062745]
mat_Sqrt:  [[0.15]]
grads:  [-0.09651951]
Stock Position:  -0.0965195053671539
Bond Position:  [-10.74959881]


portfolio before change:  [-20.34541258]
curr_Stock_Price:  99.36268927629857
curr_Factors:  [99.36268928]
mat_Sqrt:  [[0.15]]
grads:  [0.02051872]
Stock Position:  0.020518717819553996
Bond Position:  [-22.38420756]


portfolio before change:  [-20.3290634]
curr_Stock_Price:  100.70507721555909
curr_Factors:  [100.70507722]
mat_Sqrt:  [[0.15]]
grads:  [0.10983438]
Stock Position:  0.1098343832267834
Bond Position:  [-31.38994344]


portfolio before change:  [-20.09970245]
curr_Stock_Price:  102.93625331577118
curr_Factors:  [102.93625332]
mat_Sqrt:  [[0.15]]
grads:  [0.11237267]
Stock Position:  0.11237267123528565
Bond Position:  [-31.6669242]


portfolio before change:  [-20.39881981]
curr_Stock_Price:  100.41535619251512
curr_Factors:  [100.41535619]
mat_Sqrt:  [[0.15]]
grads:  [0.00521325]
Stock Position:  0.00521325096041296
Bond Position:  [-20.92231026]


portfolio before change:  [-20.40388589]
curr_Stock_Price:  101.45073584840722
curr_Factors:  [101.45073585]
mat_Sqrt:  [[0.15]]
grads:  [0.08343806]
Stock Position:  0.08343806111454712
Bond Position:  [-28.86873859]


portfolio before change:  [-20.39648821]
curr_Stock_Price:  101.71243480438687
curr_Factors:  [101.7124348]
mat_Sqrt:  [[0.15]]
grads:  [0.05059411]
Stock Position:  0.0505941073127912
Bond Position:  [-25.54253805]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.39648821]
Stock Price:  102.15710765916377
PL:  [-22.55359587]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  0.6593431118437816
FINAL STD P&L:  19.537958374332206
