WARNING:tensorflow:From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING From main.py:92: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

WARNING:tensorflow:From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING From main.py:93: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2019-12-18 14:43:13.497522: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2019-12-18 14:43:13.516046: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 14:43:13.516816: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:43:13.518916: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:43:13.520842: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:43:13.521929: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:43:13.524300: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:43:13.526165: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:43:13.530981: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:43:13.533097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:43:13.533542: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-12-18 14:43:13.540231: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399855000 Hz
2019-12-18 14:43:13.540415: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b8358b3e40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:43:13.540433: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2019-12-18 14:43:13.541543: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2019-12-18 14:43:13.541568: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:43:13.541581: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2019-12-18 14:43:13.541592: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2019-12-18 14:43:13.541604: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2019-12-18 14:43:13.541615: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2019-12-18 14:43:13.541626: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2019-12-18 14:43:13.541638: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2019-12-18 14:43:13.543621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2019-12-18 14:43:13.543651: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2019-12-18 14:43:13.638547: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-12-18 14:43:13.638582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2019-12-18 14:43:13.638593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2019-12-18 14:43:13.641783: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15216 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2019-12-18 14:43:13.643832: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b835eed110 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2019-12-18 14:43:13.643849: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING From /home/dz4/DeepBSDE/solver.py:229: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING From /home/dz4/DeepBSDE/solver.py:234: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING From /home/dz4/DeepBSDE/solver.py:308: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING From /home/dz4/DeepBSDE/solver.py:314: calling reduce_sum_v1 (from tensorflow.python.ops.math_ops) with keep_dims is deprecated and will be removed in a future version.
Instructions for updating:
keep_dims is deprecated, use keepdims instead
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING From /home/dz4/DeepBSDE/solver.py:484: The name tf.get_variable is deprecated. Please use tf.compat.v1.get_variable instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:486: calling RandomNormal.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:489: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING From /home/dz4/DeepBSDE/solver.py:491: calling Constant.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING From /home/dz4/DeepBSDE/solver.py:327: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING From /home/dz4/DeepBSDE/solver.py:334: The name tf.train.piecewise_constant is deprecated. Please use tf.compat.v1.train.piecewise_constant instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING From /home/dz4/DeepBSDE/solver.py:337: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:339: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING From /home/dz4/DeepBSDE/solver.py:192: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2019-12-18 14:43:46.405640: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
INFO   step:     0,    loss: 1.0576e+02,   Y0: 2.2585e+00,  elapsed time  32
INFO   step:     1,    loss: 9.0914e+00,   Y0: 2.2535e+00,  elapsed time  48
INFO   step:     2,    loss: 9.1651e+00,   Y0: 2.2490e+00,  elapsed time  48
INFO   step:     3,    loss: 9.2682e+00,   Y0: 2.2443e+00,  elapsed time  48
INFO   step:     4,    loss: 9.1646e+00,   Y0: 2.2396e+00,  elapsed time  48
INFO   step:     5,    loss: 9.0169e+00,   Y0: 2.2347e+00,  elapsed time  48
INFO   step:     6,    loss: 8.9757e+00,   Y0: 2.2304e+00,  elapsed time  48
INFO   step:     7,    loss: 8.9552e+00,   Y0: 2.2263e+00,  elapsed time  48
INFO   step:     8,    loss: 8.9493e+00,   Y0: 2.2220e+00,  elapsed time  49
INFO   step:     9,    loss: 8.9502e+00,   Y0: 2.2177e+00,  elapsed time  49
INFO   step:    10,    loss: 8.9474e+00,   Y0: 2.2133e+00,  elapsed time  49
INFO   step:    11,    loss: 8.9439e+00,   Y0: 2.2089e+00,  elapsed time  49
INFO   step:    12,    loss: 8.9424e+00,   Y0: 2.2049e+00,  elapsed time  49
INFO   step:    13,    loss: 8.9445e+00,   Y0: 2.2010e+00,  elapsed time  49
INFO   step:    14,    loss: 8.9418e+00,   Y0: 2.1975e+00,  elapsed time  49
INFO   step:    15,    loss: 8.9378e+00,   Y0: 2.1938e+00,  elapsed time  49
INFO   step:    16,    loss: 8.9356e+00,   Y0: 2.1903e+00,  elapsed time  50
INFO   step:    17,    loss: 8.9355e+00,   Y0: 2.1870e+00,  elapsed time  50
INFO   step:    18,    loss: 8.9356e+00,   Y0: 2.1839e+00,  elapsed time  50
INFO   step:    19,    loss: 8.9365e+00,   Y0: 2.1805e+00,  elapsed time  50
INFO   step:    20,    loss: 8.9309e+00,   Y0: 2.1772e+00,  elapsed time  50
INFO   step:    21,    loss: 8.9278e+00,   Y0: 2.1735e+00,  elapsed time  50
INFO   step:    22,    loss: 8.9271e+00,   Y0: 2.1702e+00,  elapsed time  50
INFO   step:    23,    loss: 8.9264e+00,   Y0: 2.1671e+00,  elapsed time  50
INFO   step:    24,    loss: 8.9257e+00,   Y0: 2.1645e+00,  elapsed time  51
INFO   step:    25,    loss: 8.9252e+00,   Y0: 2.1618e+00,  elapsed time  51
INFO   step:    26,    loss: 8.9248e+00,   Y0: 2.1596e+00,  elapsed time  51
INFO   step:    27,    loss: 8.9244e+00,   Y0: 2.1578e+00,  elapsed time  51
INFO   step:    28,    loss: 8.9239e+00,   Y0: 2.1566e+00,  elapsed time  51
INFO   step:    29,    loss: 8.9235e+00,   Y0: 2.1554e+00,  elapsed time  51
INFO   step:    30,    loss: 8.9230e+00,   Y0: 2.1545e+00,  elapsed time  51
INFO   step:    31,    loss: 8.9226e+00,   Y0: 2.1536e+00,  elapsed time  52
INFO   step:    32,    loss: 8.9223e+00,   Y0: 2.1528e+00,  elapsed time  52
INFO   step:    33,    loss: 8.9219e+00,   Y0: 2.1518e+00,  elapsed time  52
INFO   step:    34,    loss: 8.9216e+00,   Y0: 2.1512e+00,  elapsed time  52
INFO   step:    35,    loss: 8.9213e+00,   Y0: 2.1509e+00,  elapsed time  52
INFO   step:    36,    loss: 8.9211e+00,   Y0: 2.1506e+00,  elapsed time  52
INFO   step:    37,    loss: 8.9208e+00,   Y0: 2.1501e+00,  elapsed time  52
INFO   step:    38,    loss: 8.9205e+00,   Y0: 2.1496e+00,  elapsed time  52
INFO   step:    39,    loss: 8.9203e+00,   Y0: 2.1494e+00,  elapsed time  53
INFO   step:    40,    loss: 8.9200e+00,   Y0: 2.1492e+00,  elapsed time  53
INFO   step:    41,    loss: 8.9199e+00,   Y0: 2.1498e+00,  elapsed time  53
INFO   step:    42,    loss: 8.9197e+00,   Y0: 2.1505e+00,  elapsed time  53
INFO   step:    43,    loss: 8.9195e+00,   Y0: 2.1519e+00,  elapsed time  53
INFO   step:    44,    loss: 8.9193e+00,   Y0: 2.1526e+00,  elapsed time  53
INFO   step:    45,    loss: 8.9192e+00,   Y0: 2.1540e+00,  elapsed time  53
INFO   step:    46,    loss: 8.9190e+00,   Y0: 2.1551e+00,  elapsed time  53
INFO   step:    47,    loss: 8.9189e+00,   Y0: 2.1561e+00,  elapsed time  54
INFO   step:    48,    loss: 8.9187e+00,   Y0: 2.1572e+00,  elapsed time  54
INFO   step:    49,    loss: 8.9186e+00,   Y0: 2.1579e+00,  elapsed time  54
INFO   step:    50,    loss: 8.9184e+00,   Y0: 2.1587e+00,  elapsed time  54
INFO   step:    51,    loss: 8.9183e+00,   Y0: 2.1592e+00,  elapsed time  54
INFO   step:    52,    loss: 8.9181e+00,   Y0: 2.1596e+00,  elapsed time  54
INFO   step:    53,    loss: 8.9180e+00,   Y0: 2.1602e+00,  elapsed time  54
INFO   step:    54,    loss: 8.9179e+00,   Y0: 2.1605e+00,  elapsed time  55
INFO   step:    55,    loss: 8.9177e+00,   Y0: 2.1610e+00,  elapsed time  55
INFO   step:    56,    loss: 8.9176e+00,   Y0: 2.1617e+00,  elapsed time  55
INFO   step:    57,    loss: 8.9175e+00,   Y0: 2.1619e+00,  elapsed time  55
INFO   step:    58,    loss: 8.9174e+00,   Y0: 2.1622e+00,  elapsed time  55
INFO   step:    59,    loss: 8.9173e+00,   Y0: 2.1629e+00,  elapsed time  55
INFO   step:    60,    loss: 8.9172e+00,   Y0: 2.1637e+00,  elapsed time  55
INFO   step:    61,    loss: 8.9171e+00,   Y0: 2.1638e+00,  elapsed time  55
INFO   step:    62,    loss: 8.9170e+00,   Y0: 2.1638e+00,  elapsed time  56
INFO   step:    63,    loss: 8.9168e+00,   Y0: 2.1630e+00,  elapsed time  56
INFO   step:    64,    loss: 8.9166e+00,   Y0: 2.1619e+00,  elapsed time  56
INFO   step:    65,    loss: 8.9164e+00,   Y0: 2.1607e+00,  elapsed time  56
INFO   step:    66,    loss: 8.9162e+00,   Y0: 2.1597e+00,  elapsed time  56
INFO   step:    67,    loss: 8.9160e+00,   Y0: 2.1586e+00,  elapsed time  56
INFO   step:    68,    loss: 8.9159e+00,   Y0: 2.1577e+00,  elapsed time  56
INFO   step:    69,    loss: 8.9157e+00,   Y0: 2.1568e+00,  elapsed time  56
INFO   step:    70,    loss: 8.9155e+00,   Y0: 2.1558e+00,  elapsed time  57
INFO   step:    71,    loss: 8.9154e+00,   Y0: 2.1543e+00,  elapsed time  57
INFO   step:    72,    loss: 8.9152e+00,   Y0: 2.1533e+00,  elapsed time  57
INFO   step:    73,    loss: 8.9151e+00,   Y0: 2.1523e+00,  elapsed time  57
INFO   step:    74,    loss: 8.9150e+00,   Y0: 2.1522e+00,  elapsed time  57
INFO   step:    75,    loss: 8.9149e+00,   Y0: 2.1520e+00,  elapsed time  57
INFO   step:    76,    loss: 8.9147e+00,   Y0: 2.1514e+00,  elapsed time  57
INFO   step:    77,    loss: 8.9146e+00,   Y0: 2.1511e+00,  elapsed time  58
INFO   step:    78,    loss: 8.9145e+00,   Y0: 2.1506e+00,  elapsed time  58
INFO   step:    79,    loss: 8.9144e+00,   Y0: 2.1491e+00,  elapsed time  58
INFO   step:    80,    loss: 8.9142e+00,   Y0: 2.1477e+00,  elapsed time  58
INFO   step:    81,    loss: 8.9140e+00,   Y0: 2.1460e+00,  elapsed time  58
INFO   step:    82,    loss: 8.9139e+00,   Y0: 2.1445e+00,  elapsed time  58
INFO   step:    83,    loss: 8.9138e+00,   Y0: 2.1440e+00,  elapsed time  58
INFO   step:    84,    loss: 8.9137e+00,   Y0: 2.1431e+00,  elapsed time  58
INFO   step:    85,    loss: 8.9136e+00,   Y0: 2.1423e+00,  elapsed time  59
INFO   step:    86,    loss: 8.9135e+00,   Y0: 2.1419e+00,  elapsed time  59
INFO   step:    87,    loss: 8.9134e+00,   Y0: 2.1415e+00,  elapsed time  59
INFO   step:    88,    loss: 8.9133e+00,   Y0: 2.1410e+00,  elapsed time  59
INFO   step:    89,    loss: 8.9132e+00,   Y0: 2.1403e+00,  elapsed time  59
INFO   step:    90,    loss: 8.9131e+00,   Y0: 2.1401e+00,  elapsed time  59
INFO   step:    91,    loss: 8.9130e+00,   Y0: 2.1399e+00,  elapsed time  59
INFO   step:    92,    loss: 8.9130e+00,   Y0: 2.1399e+00,  elapsed time  60
INFO   step:    93,    loss: 8.9129e+00,   Y0: 2.1402e+00,  elapsed time  60
INFO   step:    94,    loss: 8.9128e+00,   Y0: 2.1406e+00,  elapsed time  60
INFO   step:    95,    loss: 8.9128e+00,   Y0: 2.1413e+00,  elapsed time  60
INFO   step:    96,    loss: 8.9127e+00,   Y0: 2.1413e+00,  elapsed time  60
INFO   step:    97,    loss: 8.9127e+00,   Y0: 2.1424e+00,  elapsed time  60
INFO   step:    98,    loss: 8.9126e+00,   Y0: 2.1434e+00,  elapsed time  60
INFO   step:    99,    loss: 8.9126e+00,   Y0: 2.1442e+00,  elapsed time  60
INFO   step:   100,    loss: 8.9125e+00,   Y0: 2.1449e+00,  elapsed time  61
INFO   step:   101,    loss: 8.9125e+00,   Y0: 2.1459e+00,  elapsed time  61
INFO   step:   102,    loss: 8.9125e+00,   Y0: 2.1463e+00,  elapsed time  61
INFO   step:   103,    loss: 8.9124e+00,   Y0: 2.1473e+00,  elapsed time  61
INFO   step:   104,    loss: 8.9124e+00,   Y0: 2.1487e+00,  elapsed time  61
INFO   step:   105,    loss: 8.9124e+00,   Y0: 2.1499e+00,  elapsed time  61
INFO   step:   106,    loss: 8.9124e+00,   Y0: 2.1507e+00,  elapsed time  61
INFO   step:   107,    loss: 8.9124e+00,   Y0: 2.1510e+00,  elapsed time  62
INFO   step:   108,    loss: 8.9123e+00,   Y0: 2.1512e+00,  elapsed time  62
INFO   step:   109,    loss: 8.9122e+00,   Y0: 2.1510e+00,  elapsed time  62
INFO   step:   110,    loss: 8.9121e+00,   Y0: 2.1501e+00,  elapsed time  62
INFO   step:   111,    loss: 8.9120e+00,   Y0: 2.1492e+00,  elapsed time  62
INFO   step:   112,    loss: 8.9119e+00,   Y0: 2.1483e+00,  elapsed time  62
INFO   step:   113,    loss: 8.9118e+00,   Y0: 2.1476e+00,  elapsed time  62
INFO   step:   114,    loss: 8.9117e+00,   Y0: 2.1470e+00,  elapsed time  62
INFO   step:   115,    loss: 8.9116e+00,   Y0: 2.1460e+00,  elapsed time  63
INFO   step:   116,    loss: 8.9115e+00,   Y0: 2.1441e+00,  elapsed time  63
INFO   step:   117,    loss: 8.9114e+00,   Y0: 2.1427e+00,  elapsed time  63
INFO   step:   118,    loss: 8.9113e+00,   Y0: 2.1418e+00,  elapsed time  63
INFO   step:   119,    loss: 8.9112e+00,   Y0: 2.1404e+00,  elapsed time  63
INFO   step:   120,    loss: 8.9111e+00,   Y0: 2.1392e+00,  elapsed time  63
INFO   step:   121,    loss: 8.9110e+00,   Y0: 2.1382e+00,  elapsed time  63
INFO   step:   122,    loss: 8.9109e+00,   Y0: 2.1376e+00,  elapsed time  63
INFO   step:   123,    loss: 8.9109e+00,   Y0: 2.1384e+00,  elapsed time  64
INFO   step:   124,    loss: 8.9108e+00,   Y0: 2.1389e+00,  elapsed time  64
INFO   step:   125,    loss: 8.9108e+00,   Y0: 2.1391e+00,  elapsed time  64
INFO   step:   126,    loss: 8.9107e+00,   Y0: 2.1385e+00,  elapsed time  64
INFO   step:   127,    loss: 8.9106e+00,   Y0: 2.1377e+00,  elapsed time  64
INFO   step:   128,    loss: 8.9106e+00,   Y0: 2.1375e+00,  elapsed time  64
INFO   step:   129,    loss: 8.9105e+00,   Y0: 2.1368e+00,  elapsed time  64
INFO   step:   130,    loss: 8.9104e+00,   Y0: 2.1361e+00,  elapsed time  65
INFO   step:   131,    loss: 8.9104e+00,   Y0: 2.1354e+00,  elapsed time  65
INFO   step:   132,    loss: 8.9103e+00,   Y0: 2.1351e+00,  elapsed time  65
INFO   step:   133,    loss: 8.9102e+00,   Y0: 2.1354e+00,  elapsed time  65
INFO   step:   134,    loss: 8.9102e+00,   Y0: 2.1363e+00,  elapsed time  65
INFO   step:   135,    loss: 8.9102e+00,   Y0: 2.1372e+00,  elapsed time  65
INFO   step:   136,    loss: 8.9101e+00,   Y0: 2.1378e+00,  elapsed time  65
INFO   step:   137,    loss: 8.9101e+00,   Y0: 2.1383e+00,  elapsed time  65
INFO   step:   138,    loss: 8.9100e+00,   Y0: 2.1389e+00,  elapsed time  66
INFO   step:   139,    loss: 8.9099e+00,   Y0: 2.1383e+00,  elapsed time  66
INFO   step:   140,    loss: 8.9099e+00,   Y0: 2.1375e+00,  elapsed time  66
INFO   step:   141,    loss: 8.9098e+00,   Y0: 2.1374e+00,  elapsed time  66
INFO   step:   142,    loss: 8.9098e+00,   Y0: 2.1371e+00,  elapsed time  66
INFO   step:   143,    loss: 8.9097e+00,   Y0: 2.1371e+00,  elapsed time  66
INFO   step:   144,    loss: 8.9096e+00,   Y0: 2.1366e+00,  elapsed time  66
INFO   step:   145,    loss: 8.9096e+00,   Y0: 2.1359e+00,  elapsed time  67
INFO   step:   146,    loss: 8.9095e+00,   Y0: 2.1347e+00,  elapsed time  67
INFO   step:   147,    loss: 8.9094e+00,   Y0: 2.1348e+00,  elapsed time  67
INFO   step:   148,    loss: 8.9094e+00,   Y0: 2.1344e+00,  elapsed time  67
INFO   step:   149,    loss: 8.9093e+00,   Y0: 2.1340e+00,  elapsed time  67
all_one_vec:  Tensor("ones:0", shape=(?, 1), dtype=float64)
y:  Tensor("mul:0", shape=(?, 1), dtype=float64)
z output:  [<tf.Tensor 'MatMul:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_1:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_2:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_3:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_4:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_5:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_6:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_7:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_8:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_9:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_10:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_11:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_12:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_13:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_14:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_15:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_16:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_17:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_18:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_19:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_20:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_21:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_22:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_23:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_24:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_25:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_26:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_27:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_28:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_29:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_30:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_31:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_32:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_33:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_34:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_35:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_36:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_37:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_38:0' shape=(?, 1) dtype=float64>, <tf.Tensor 'MatMul_39:0' shape=(?, 1) dtype=float64>]
num_iterations:  150
total time intervals:  40
# of dimensions:  1
Loss out:  10.333262255107009
Output_Z_Vals:  [[[ 2.32839458e+00]
  [ 2.32839458e+00]
  [ 2.32839458e+00]
  ...
  [ 2.32839458e+00]
  [ 2.32839458e+00]
  [ 2.32839458e+00]]

 [[-1.55191654e-03]
  [-5.98009637e-03]
  [-5.18868911e-03]
  ...
  [-2.82468483e-03]
  [-1.44803488e-03]
  [-1.51401837e-03]]

 [[-2.03410203e-03]
  [-1.61933396e-02]
  [-8.14215342e-04]
  ...
  [ 3.42055686e-03]
  [-1.53655646e-02]
  [-1.43308059e-02]]

 ...

 [[ 2.33013949e-02]
  [ 1.90903880e-02]
  [ 2.07160243e-02]
  ...
  [ 2.45949105e-02]
  [ 2.36439756e-02]
  [ 2.27777842e-02]]

 [[-2.83951749e-04]
  [ 1.00287008e-02]
  [ 8.89341713e-03]
  ...
  [ 5.58963046e-03]
  [-2.30672656e-04]
  [ 7.05159399e-03]]

 [[ 2.20737271e-02]
  [ 1.93116961e-02]
  [ 2.25269500e-02]
  ...
  [ 1.93330225e-02]
  [ 2.22529633e-02]
  [ 2.37616260e-02]]]
Z_Vals dimensionality:  (40, 200, 1)
X_test:  [[[100.         100.3754903  101.58684005 ... 103.12504444 102.37358415
   101.78318987]]

 [[100.          98.64226483  96.85111673 ...  95.15299173  94.99260346
    95.57607634]]

 [[100.          99.20552296  99.08764262 ...  97.04332502  97.67794033
    97.96256585]]

 ...

 [[100.          99.64488325  99.31667658 ... 106.41041391 106.3858448
   106.30247021]]

 [[100.         100.19057812 100.35575109 ... 102.98169187 102.18213785
   102.27887538]]

 [[100.         100.30861296 100.41815705 ... 100.27747979 100.69005859
   101.54994613]]]
X_test type:  <class 'numpy.ndarray'>
first element:  100.0
first element type:  <class 'float'>
---------------------------- TESTING DELTA HEDGING ----------------------------

Test sample:  0
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.55191654e-03]
 [-2.03410203e-03]
 [-3.12851278e-03]
 [ 7.02924021e-02]
 [-1.42320690e-02]
 [ 3.49314802e-02]
 [-3.92966703e-04]
 [ 2.36630188e-03]
 [ 1.19994839e-02]
 [ 1.32559243e-02]
 [ 1.44301442e-02]
 [-7.45629130e-03]
 [-1.27627261e-02]
 [ 2.24838095e-03]
 [-3.36641446e-03]
 [-2.88004927e-02]
 [ 4.76699288e-03]
 [-6.06538458e-03]
 [ 5.23852526e-03]
 [-3.20669141e-03]
 [-1.59191935e-03]
 [-7.31318510e-03]
 [ 4.78684792e-03]
 [ 6.90417576e-03]
 [-3.39390236e-03]
 [-7.55395446e-03]
 [ 7.49070739e-03]
 [-1.96822184e-02]
 [-1.76350293e-02]
 [ 2.16804704e-02]
 [ 9.28541995e-03]
 [-7.13368605e-04]
 [-1.25297782e-02]
 [-5.65528124e-03]
 [-6.13191947e-03]
 [-6.22368890e-03]
 [ 2.33013949e-02]
 [-2.83951749e-04]
 [ 2.20737271e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.76854433]
curr_Stock_Price:  100.3754902956421
curr_Factors:  [100.3754903]
mat_Sqrt:  [[0.15]]
grads:  [-0.01034611]
Stock Position:  -0.010346110283636642
Bond Position:  [8.80704022]


portfolio before change:  [7.75711252]
curr_Stock_Price:  101.58684005165628
curr_Factors:  [101.58684005]
mat_Sqrt:  [[0.15]]
grads:  [-0.01356068]
Stock Position:  -0.013560680184008982
Bond Position:  [9.13469917]


portfolio before change:  [7.75542663]
curr_Stock_Price:  101.79536952898772
curr_Factors:  [101.79536953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02085675]
Stock Position:  -0.020856751842775082
Bond Position:  [9.87854739]


portfolio before change:  [7.7387565]
curr_Stock_Price:  102.65384559166344
curr_Factors:  [102.65384559]
mat_Sqrt:  [[0.15]]
grads:  [0.46861601]
Stock Position:  0.4686160143300867
Bond Position:  [-40.36647947]


portfolio before change:  [7.62950151]
curr_Stock_Price:  102.43146977147303
curr_Factors:  [102.43146977]
mat_Sqrt:  [[0.15]]
grads:  [-0.09488046]
Stock Position:  -0.0948804603178185
Bond Position:  [17.34824651]


portfolio before change:  [7.60254979]
curr_Stock_Price:  102.73838633944928
curr_Factors:  [102.73838634]
mat_Sqrt:  [[0.15]]
grads:  [0.23287653]
Stock Position:  0.2328765346189822
Bond Position:  [-16.3228096]


portfolio before change:  [7.87968433]
curr_Stock_Price:  103.93719764939917
curr_Factors:  [103.93719765]
mat_Sqrt:  [[0.15]]
grads:  [-0.00261978]
Stock Position:  -0.002619778022671012
Bond Position:  [8.15197672]


portfolio before change:  [7.88062195]
curr_Stock_Price:  103.96828534449111
curr_Factors:  [103.96828534]
mat_Sqrt:  [[0.15]]
grads:  [0.01577535]
Stock Position:  0.015775345894373096
Bond Position:  [6.24048629]


portfolio before change:  [7.87208403]
curr_Stock_Price:  103.3776147472456
curr_Factors:  [103.37761475]
mat_Sqrt:  [[0.15]]
grads:  [0.07999656]
Stock Position:  0.07999655926773258
Bond Position:  [-0.39776946]


portfolio before change:  [7.90363279]
curr_Stock_Price:  103.77261280784558
curr_Factors:  [103.77261281]
mat_Sqrt:  [[0.15]]
grads:  [0.08837283]
Stock Position:  0.0883728287717262
Bond Position:  [-1.26704655]


portfolio before change:  [7.99020677]
curr_Stock_Price:  104.75404987849657
curr_Factors:  [104.75404988]
mat_Sqrt:  [[0.15]]
grads:  [0.09620096]
Stock Position:  0.09620096139783561
Bond Position:  [-2.08723354]


portfolio before change:  [7.89373783]
curr_Stock_Price:  103.75397649362044
curr_Factors:  [103.75397649]
mat_Sqrt:  [[0.15]]
grads:  [-0.04970861]
Stock Position:  -0.04970860867281233
Bond Position:  [13.05120364]


portfolio before change:  [7.88272859]
curr_Stock_Price:  104.00827317034614
curr_Factors:  [104.00827317]
mat_Sqrt:  [[0.15]]
grads:  [-0.08508484]
Stock Position:  -0.0850848403471295
Bond Position:  [16.73225591]


portfolio before change:  [7.90982425]
curr_Stock_Price:  103.71440188348838
curr_Factors:  [103.71440188]
mat_Sqrt:  [[0.15]]
grads:  [0.01498921]
Stock Position:  0.0149892063584406
Bond Position:  [6.35522768]


portfolio before change:  [7.89132236]
curr_Stock_Price:  102.42705301781457
curr_Factors:  [102.42705302]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244276]
Stock Position:  -0.022442763073362206
Bond Position:  [10.19006845]


portfolio before change:  [7.86559267]
curr_Stock_Price:  103.63027075392527
curr_Factors:  [103.63027075]
mat_Sqrt:  [[0.15]]
grads:  [-0.19200328]
Stock Position:  -0.19200328450202975
Bond Position:  [27.76294503]


portfolio before change:  [7.57031222]
curr_Stock_Price:  105.18623914359647
curr_Factors:  [105.18623914]
mat_Sqrt:  [[0.15]]
grads:  [0.03177995]
Stock Position:  0.03177995252990033
Bond Position:  [4.22749853]


portfolio before change:  [7.53445695]
curr_Stock_Price:  104.041374778071
curr_Factors:  [104.04137478]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404359]
Stock Position:  -0.04043589722136055
Bond Position:  [11.74146329]


portfolio before change:  [7.52338729]
curr_Stock_Price:  104.35143186854984
curr_Factors:  [104.35143187]
mat_Sqrt:  [[0.15]]
grads:  [0.0349235]
Stock Position:  0.03492350170619619
Bond Position:  [3.87906988]


portfolio before change:  [7.50805072]
curr_Stock_Price:  103.89839930538122
curr_Factors:  [103.89839931]
mat_Sqrt:  [[0.15]]
grads:  [-0.02137794]
Stock Position:  -0.021377942711238683
Bond Position:  [9.72918475]


portfolio before change:  [7.50949274]
curr_Stock_Price:  103.8878371243842
curr_Factors:  [103.88783712]
mat_Sqrt:  [[0.15]]
grads:  [-0.0106128]
Stock Position:  -0.0106127956846342
Bond Position:  [8.61203313]


portfolio before change:  [7.53769907]
curr_Stock_Price:  101.33151148304864
curr_Factors:  [101.33151148]
mat_Sqrt:  [[0.15]]
grads:  [-0.04875457]
Stock Position:  -0.04875456734743317
Bond Position:  [12.47807308]


portfolio before change:  [7.51545117]
curr_Stock_Price:  101.81982995452105
curr_Factors:  [101.81982995]
mat_Sqrt:  [[0.15]]
grads:  [0.03191232]
Stock Position:  0.03191231946529291
Bond Position:  [4.26614423]


portfolio before change:  [7.47769975]
curr_Stock_Price:  100.620145188166
curr_Factors:  [100.62014519]
mat_Sqrt:  [[0.15]]
grads:  [0.04602784]
Stock Position:  0.0460278383822285
Bond Position:  [2.84637197]


portfolio before change:  [7.41289522]
curr_Stock_Price:  99.20447262469399
curr_Factors:  [99.20447262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02262602]
Stock Position:  -0.022626015700456446
Bond Position:  [9.65749718]


portfolio before change:  [7.41119157]
curr_Stock_Price:  99.33312615731292
curr_Factors:  [99.33312616]
mat_Sqrt:  [[0.15]]
grads:  [-0.0503597]
Stock Position:  -0.050359696416741165
Bond Position:  [12.41357765]


portfolio before change:  [7.32343309]
curr_Stock_Price:  101.10657366929226
curr_Factors:  [101.10657367]
mat_Sqrt:  [[0.15]]
grads:  [0.04993805]
Stock Position:  0.04993804928049256
Bond Position:  [2.27436803]


portfolio before change:  [7.30562926]
curr_Stock_Price:  100.74436213346664
curr_Factors:  [100.74436213]
mat_Sqrt:  [[0.15]]
grads:  [-0.13121479]
Stock Position:  -0.1312147893649202
Bond Position:  [20.52477952]


portfolio before change:  [7.38366323]
curr_Stock_Price:  100.16921194278649
curr_Factors:  [100.16921194]
mat_Sqrt:  [[0.15]]
grads:  [-0.11756686]
Stock Position:  -0.11756686177265552
Bond Position:  [19.16024312]


portfolio before change:  [7.33605273]
curr_Stock_Price:  100.5945501787733
curr_Factors:  [100.59455018]
mat_Sqrt:  [[0.15]]
grads:  [0.14453647]
Stock Position:  0.14453646959080668
Bond Position:  [-7.20352841]


portfolio before change:  [7.20160432]
curr_Stock_Price:  99.67057635576823
curr_Factors:  [99.67057636]
mat_Sqrt:  [[0.15]]
grads:  [0.0619028]
Stock Position:  0.06190279966056604
Bond Position:  [1.0317166]


portfolio before change:  [7.16640999]
curr_Stock_Price:  99.09995108755437
curr_Factors:  [99.09995109]
mat_Sqrt:  [[0.15]]
grads:  [-0.00475579]
Stock Position:  -0.004755790700057523
Bond Position:  [7.63770861]


portfolio before change:  [7.16585178]
curr_Stock_Price:  99.4180848894671
curr_Factors:  [99.41808489]
mat_Sqrt:  [[0.15]]
grads:  [-0.08353185]
Stock Position:  -0.08353185497618229
Bond Position:  [15.47042883]


portfolio before change:  [7.1064815]
curr_Stock_Price:  100.15198706178505
curr_Factors:  [100.15198706]
mat_Sqrt:  [[0.15]]
grads:  [-0.03770187]
Stock Position:  -0.03770187495821603
Bond Position:  [10.88239919]


portfolio before change:  [7.09839015]
curr_Stock_Price:  100.40268363030752
curr_Factors:  [100.40268363]
mat_Sqrt:  [[0.15]]
grads:  [-0.04087946]
Stock Position:  -0.04087946312874117
Bond Position:  [11.20279796]


portfolio before change:  [7.06116531]
curr_Stock_Price:  101.34754139503222
curr_Factors:  [101.3475414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04149126]
Stock Position:  -0.04149125934807088
Bond Position:  [11.26620244]


portfolio before change:  [7.01512734]
curr_Stock_Price:  102.49106735379888
curr_Factors:  [102.49106735]
mat_Sqrt:  [[0.15]]
grads:  [0.15534263]
Stock Position:  0.15534263250623734
Bond Position:  [-8.90610487]


portfolio before change:  [7.11249768]
curr_Stock_Price:  103.12504443633472
curr_Factors:  [103.12504444]
mat_Sqrt:  [[0.15]]
grads:  [-0.00189301]
Stock Position:  -0.001893011660785425
Bond Position:  [7.30771459]


portfolio before change:  [7.11483372]
curr_Stock_Price:  102.37358415197421
curr_Factors:  [102.37358415]
mat_Sqrt:  [[0.15]]
grads:  [0.14715818]
Stock Position:  0.14715818092156926
Bond Position:  [-7.95027669]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.11483372]
Stock Price:  101.78318986573692
PL:  [5.33164386]
Settle:  Tensor("sub:0", shape=(), dtype=float64)
PL:  Tensor("sub_1:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  1
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.98009637e-03]
 [-1.61933396e-02]
 [-8.28513124e-02]
 [-3.34576486e-02]
 [-1.16278098e-02]
 [ 2.47745360e-02]
 [-1.65773679e-03]
 [-1.13068092e-02]
 [-4.88297801e-03]
 [ 8.41993067e-04]
 [-6.57675652e-02]
 [-1.44456852e-02]
 [ 1.19767782e-02]
 [ 4.27751750e-03]
 [ 9.26190395e-03]
 [-1.20770014e-02]
 [-3.24842200e-03]
 [-1.95454844e-04]
 [-7.57823181e-03]
 [-2.42778290e-03]
 [ 6.27249504e-04]
 [ 1.35586913e-02]
 [ 4.75649942e-03]
 [ 5.46239906e-03]
 [ 3.23628002e-03]
 [-1.21968080e-03]
 [ 5.00286370e-03]
 [-1.87385515e-02]
 [-2.05973442e-02]
 [ 2.14049971e-02]
 [ 2.54407079e-03]
 [-1.39656331e-02]
 [-1.22248511e-02]
 [-7.33455532e-03]
 [-6.63171709e-03]
 [-6.47422857e-03]
 [ 1.90903880e-02]
 [ 1.00287008e-02]
 [ 1.93116961e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.13567415]
curr_Stock_Price:  98.6422648336202
curr_Factors:  [98.64226483]
mat_Sqrt:  [[0.15]]
grads:  [-0.03986731]
Stock Position:  -0.039867309105883
Bond Position:  [-15.20307249]


portfolio before change:  [-19.0661664]
curr_Stock_Price:  96.85111673337511
curr_Factors:  [96.85111673]
mat_Sqrt:  [[0.15]]
grads:  [-0.1079556]
Stock Position:  -0.10795559755122307
Bond Position:  [-8.61054622]


portfolio before change:  [-18.85247343]
curr_Stock_Price:  94.861693697735
curr_Factors:  [94.8616937]
mat_Sqrt:  [[0.15]]
grads:  [-0.55234208]
Stock Position:  -0.5523420828803619
Bond Position:  [33.54363205]


portfolio before change:  [-19.64915727]
curr_Stock_Price:  96.31165936491512
curr_Factors:  [96.31165936]
mat_Sqrt:  [[0.15]]
grads:  [-0.22305099]
Stock Position:  -0.2230509907959914
Bond Position:  [1.83325377]


portfolio before change:  [-19.70248999]
curr_Stock_Price:  96.55179227078548
curr_Factors:  [96.55179227]
mat_Sqrt:  [[0.15]]
grads:  [-0.07751873]
Stock Position:  -0.07751873177632299
Bond Position:  [-12.2179175]


portfolio before change:  [-19.69636738]
curr_Stock_Price:  96.45310725588888
curr_Factors:  [96.45310726]
mat_Sqrt:  [[0.15]]
grads:  [0.16516357]
Stock Position:  0.16516357302493065
Bond Position:  [-35.62690721]


portfolio before change:  [-19.82602082]
curr_Stock_Price:  95.69507207626002
curr_Factors:  [95.69507208]
mat_Sqrt:  [[0.15]]
grads:  [-0.01105158]
Stock Position:  -0.011051578593811996
Bond Position:  [-18.76843921]


portfolio before change:  [-19.83451004]
curr_Stock_Price:  96.25092116799351
curr_Factors:  [96.25092117]
mat_Sqrt:  [[0.15]]
grads:  [-0.07537873]
Stock Position:  -0.07537872787394428
Bond Position:  [-12.57923804]


portfolio before change:  [-19.82496726]
curr_Stock_Price:  96.10346211029528
curr_Factors:  [96.10346211]
mat_Sqrt:  [[0.15]]
grads:  [-0.03255319]
Stock Position:  -0.0325531867275627
Bond Position:  [-16.69649332]


portfolio before change:  [-19.85285256]
curr_Stock_Price:  96.8959531837165
curr_Factors:  [96.89595318]
mat_Sqrt:  [[0.15]]
grads:  [0.00561329]
Stock Position:  0.005613287116408595
Bond Position:  [-20.39675737]


portfolio before change:  [-19.85820401]
curr_Stock_Price:  96.39683503607198
curr_Factors:  [96.39683504]
mat_Sqrt:  [[0.15]]
grads:  [-0.43845043]
Stock Position:  -0.4384504348733485
Bond Position:  [22.40703023]


portfolio before change:  [-19.80253889]
curr_Stock_Price:  96.27626480304755
curr_Factors:  [96.2762648]
mat_Sqrt:  [[0.15]]
grads:  [-0.09630457]
Stock Position:  -0.09630456767007779
Bond Position:  [-10.53069483]


portfolio before change:  [-19.79389779]
curr_Stock_Price:  96.17286871751446
curr_Factors:  [96.17286872]
mat_Sqrt:  [[0.15]]
grads:  [0.07984519]
Stock Position:  0.07984518821244321
Bond Position:  [-27.47283859]


portfolio before change:  [-19.78510303]
curr_Stock_Price:  96.32602864384508
curr_Factors:  [96.32602864]
mat_Sqrt:  [[0.15]]
grads:  [0.02851678]
Stock Position:  0.028516783344408998
Bond Position:  [-22.53201152]


portfolio before change:  [-19.77747364]
curr_Stock_Price:  96.69234135259843
curr_Factors:  [96.69234135]
mat_Sqrt:  [[0.15]]
grads:  [0.06174603]
Stock Position:  0.06174602630690995
Bond Position:  [-25.7478415]


portfolio before change:  [-19.70765504]
curr_Stock_Price:  97.87520746155518
curr_Factors:  [97.87520746]
mat_Sqrt:  [[0.15]]
grads:  [-0.08051334]
Stock Position:  -0.08051334262332968
Bond Position:  [-11.82739493]


portfolio before change:  [-19.7622817]
curr_Stock_Price:  98.53532332364804
curr_Factors:  [98.53532332]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165615]
Stock Position:  -0.02165614665170614
Bond Position:  [-17.62838628]


portfolio before change:  [-19.7372195]
curr_Stock_Price:  97.27628674330899
curr_Factors:  [97.27628674]
mat_Sqrt:  [[0.15]]
grads:  [-0.00130303]
Stock Position:  -0.0013030322916451494
Bond Position:  [-19.61046536]


portfolio before change:  [-19.73995225]
curr_Stock_Price:  97.49215708193279
curr_Factors:  [97.49215708]
mat_Sqrt:  [[0.15]]
grads:  [-0.05052155]
Stock Position:  -0.05052154540419743
Bond Position:  [-14.81449781]


portfolio before change:  [-19.74660306]
curr_Stock_Price:  97.58714386015443
curr_Factors:  [97.58714386]
mat_Sqrt:  [[0.15]]
grads:  [-0.01618522]
Stock Position:  -0.016185219301014495
Bond Position:  [-18.16713373]


portfolio before change:  [-19.73501286]
curr_Stock_Price:  96.73073100751235
curr_Factors:  [96.73073101]
mat_Sqrt:  [[0.15]]
grads:  [0.00418166]
Stock Position:  0.004181663357707654
Bond Position:  [-20.13950821]


portfolio before change:  [-19.73918209]
curr_Stock_Price:  96.33575929793547
curr_Factors:  [96.3357593]
mat_Sqrt:  [[0.15]]
grads:  [0.09039128]
Stock Position:  0.0903912751712168
Bond Position:  [-28.44709422]


portfolio before change:  [-19.79197842]
curr_Stock_Price:  95.7910140367344
curr_Factors:  [95.79101404]
mat_Sqrt:  [[0.15]]
grads:  [0.03171]
Stock Position:  0.03170999616284933
Bond Position:  [-22.82951111]


portfolio before change:  [-19.80057138]
curr_Stock_Price:  95.61002727691587
curr_Factors:  [95.61002728]
mat_Sqrt:  [[0.15]]
grads:  [0.03641599]
Stock Position:  0.0364159937374137
Bond Position:  [-23.28230553]


portfolio before change:  [-19.8304561]
curr_Stock_Price:  94.8693017529353
curr_Factors:  [94.86930175]
mat_Sqrt:  [[0.15]]
grads:  [0.0215752]
Stock Position:  0.02157520014525056
Bond Position:  [-21.87728028]


portfolio before change:  [-19.84283417]
curr_Stock_Price:  94.42234246827542
curr_Factors:  [94.42234247]
mat_Sqrt:  [[0.15]]
grads:  [-0.00813121]
Stock Position:  -0.00813120535768488
Bond Position:  [-19.07506671]


portfolio before change:  [-19.85052049]
curr_Stock_Price:  95.0743726203526
curr_Factors:  [95.07437262]
mat_Sqrt:  [[0.15]]
grads:  [0.03335242]
Stock Position:  0.03335242467368836
Bond Position:  [-23.02148135]


portfolio before change:  [-19.86017456]
curr_Stock_Price:  94.8712029223924
curr_Factors:  [94.87120292]
mat_Sqrt:  [[0.15]]
grads:  [-0.12492368]
Stock Position:  -0.124923676662411
Bond Position:  [-8.00851508]


portfolio before change:  [-19.73062018]
curr_Stock_Price:  93.82612072486326
curr_Factors:  [93.82612072]
mat_Sqrt:  [[0.15]]
grads:  [-0.13731563]
Stock Position:  -0.13731562794107546
Bond Position:  [-6.84682749]


portfolio before change:  [-19.70127228]
curr_Stock_Price:  93.60616172484943
curr_Factors:  [93.60616172]
mat_Sqrt:  [[0.15]]
grads:  [0.14269998]
Stock Position:  0.1426999809809938
Bond Position:  [-33.05886977]


portfolio before change:  [-19.90388689]
curr_Stock_Price:  92.2152575675333
curr_Factors:  [92.21525757]
mat_Sqrt:  [[0.15]]
grads:  [0.01696047]
Stock Position:  0.016960471902005274
Bond Position:  [-21.46790118]


portfolio before change:  [-19.89606501]
curr_Stock_Price:  92.83467034364635
curr_Factors:  [92.83467034]
mat_Sqrt:  [[0.15]]
grads:  [-0.09310422]
Stock Position:  -0.09310422069378062
Bond Position:  [-11.25276538]


portfolio before change:  [-19.93680853]
curr_Stock_Price:  93.2571735415131
curr_Factors:  [93.25717354]
mat_Sqrt:  [[0.15]]
grads:  [-0.08149901]
Stock Position:  -0.08149900701001306
Bond Position:  [-12.33644149]


portfolio before change:  [-20.0673991]
curr_Stock_Price:  94.84060903867346
curr_Factors:  [94.84060904]
mat_Sqrt:  [[0.15]]
grads:  [-0.04889704]
Stock Position:  -0.048897035491188394
Bond Position:  [-15.42997447]


portfolio before change:  [-20.14195943]
curr_Stock_Price:  96.32600497620227
curr_Factors:  [96.32600498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04421145]
Stock Position:  -0.044211447241083265
Bond Position:  [-15.88324734]


portfolio before change:  [-20.17734164]
curr_Stock_Price:  97.08139040595637
curr_Factors:  [97.08139041]
mat_Sqrt:  [[0.15]]
grads:  [-0.04316152]
Stock Position:  -0.043161523784499396
Bond Position:  [-15.9871609]


portfolio before change:  [-20.10887002]
curr_Stock_Price:  95.44868298055172
curr_Factors:  [95.44868298]
mat_Sqrt:  [[0.15]]
grads:  [0.12726925]
Stock Position:  0.12726925333382583
Bond Position:  [-32.25655263]


portfolio before change:  [-20.15053474]
curr_Stock_Price:  95.15299172532725
curr_Factors:  [95.15299173]
mat_Sqrt:  [[0.15]]
grads:  [0.06685801]
Stock Position:  0.06685800558768752
Bond Position:  [-26.512274]


portfolio before change:  [-20.16457223]
curr_Stock_Price:  94.99260345557055
curr_Factors:  [94.99260346]
mat_Sqrt:  [[0.15]]
grads:  [0.12874464]
Stock Position:  0.128744640975829
Bond Position:  [-32.39436085]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.16457223]
Stock Price:  95.57607633689533
PL:  [-20.16457223]
Settle:  Tensor("sub_2:0", shape=(), dtype=float64)
PL:  Tensor("sub_3:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  2
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.18868911e-03]
 [-8.14215342e-04]
 [-2.48736748e-02]
 [-2.68534157e-02]
 [-1.90409661e-03]
 [ 2.45079719e-02]
 [ 7.10472817e-03]
 [-7.58891289e-03]
 [ 9.02701638e-03]
 [-3.72358249e-03]
 [ 7.29454534e-03]
 [ 6.53681921e-03]
 [-4.58396939e-03]
 [ 7.14546683e-03]
 [ 9.60369946e-03]
 [-1.21039356e-02]
 [-9.24281604e-03]
 [-6.36477992e-05]
 [-7.66010140e-03]
 [-2.70538899e-03]
 [ 1.02520848e-03]
 [ 1.32659606e-02]
 [ 4.76305079e-03]
 [ 5.72860320e-03]
 [-3.10974017e-03]
 [-5.71948774e-03]
 [-6.05515702e-03]
 [-2.43864719e-02]
 [-3.74175990e-02]
 [ 2.15444552e-02]
 [ 7.35399886e-03]
 [-4.55357035e-03]
 [-1.25335104e-02]
 [-1.03896849e-02]
 [-8.12508574e-03]
 [-7.39025924e-03]
 [ 2.07160243e-02]
 [ 8.89341713e-03]
 [ 2.25269500e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.39242639]
curr_Stock_Price:  99.2055229582625
curr_Factors:  [99.20552296]
mat_Sqrt:  [[0.15]]
grads:  [-0.03459126]
Stock Position:  -0.034591260752925575
Bond Position:  [-6.96078227]


portfolio before change:  [-10.38921891]
curr_Stock_Price:  99.08764261563829
curr_Factors:  [99.08764262]
mat_Sqrt:  [[0.15]]
grads:  [-0.0054281]
Stock Position:  -0.0054281022768580605
Bond Position:  [-9.85136105]


portfolio before change:  [-10.38761654]
curr_Stock_Price:  98.56556949737971
curr_Factors:  [98.5655695]
mat_Sqrt:  [[0.15]]
grads:  [-0.1658245]
Stock Position:  -0.16582449895561793
Bond Position:  [5.95696964]


portfolio before change:  [-10.33046755]
curr_Stock_Price:  98.22542482783251
curr_Factors:  [98.22542483]
mat_Sqrt:  [[0.15]]
grads:  [-0.17902277]
Stock Position:  -0.17902277145399229
Bond Position:  [7.25412023]


portfolio before change:  [-10.14104701]
curr_Stock_Price:  97.17240950948938
curr_Factors:  [97.17240951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01269398]
Stock Position:  -0.012693977414394663
Bond Position:  [-8.90754264]


portfolio before change:  [-10.13971059]
curr_Stock_Price:  96.97940968187139
curr_Factors:  [96.97940968]
mat_Sqrt:  [[0.15]]
grads:  [0.16338648]
Stock Position:  0.1633864790964527
Bond Position:  [-25.98483488]


portfolio before change:  [-9.95779696]
curr_Stock_Price:  98.11268545603558
curr_Factors:  [98.11268546]
mat_Sqrt:  [[0.15]]
grads:  [0.04736485]
Stock Position:  0.047364854434600055
Bond Position:  [-14.60489002]


portfolio before change:  [-9.99033996]
curr_Stock_Price:  97.4641606674811
curr_Factors:  [97.46416067]
mat_Sqrt:  [[0.15]]
grads:  [-0.05059275]
Stock Position:  -0.05059275258178358
Bond Position:  [-5.0593598]


portfolio before change:  [-10.00352543]
curr_Stock_Price:  97.71227940852715
curr_Factors:  [97.71227941]
mat_Sqrt:  [[0.15]]
grads:  [0.06018011]
Stock Position:  0.06018010920659405
Bond Position:  [-15.88386108]


portfolio before change:  [-9.91187081]
curr_Stock_Price:  99.26827914067258
curr_Factors:  [99.26827914]
mat_Sqrt:  [[0.15]]
grads:  [-0.02482388]
Stock Position:  -0.024823883269408844
Bond Position:  [-7.44764663]


portfolio before change:  [-9.91370732]
curr_Stock_Price:  99.30475598609496
curr_Factors:  [99.30475599]
mat_Sqrt:  [[0.15]]
grads:  [0.0486303]
Stock Position:  0.04863030224053329
Bond Position:  [-14.74292762]


portfolio before change:  [-9.9196993]
curr_Stock_Price:  99.21943885154315
curr_Factors:  [99.21943885]
mat_Sqrt:  [[0.15]]
grads:  [0.04357879]
Stock Position:  0.04357879474612406
Bond Position:  [-14.24356286]


portfolio before change:  [-9.92157633]
curr_Stock_Price:  99.2172249570412
curr_Factors:  [99.21722496]
mat_Sqrt:  [[0.15]]
grads:  [-0.0305598]
Stock Position:  -0.030559795948149112
Bond Position:  [-6.88951818]


portfolio before change:  [-9.85799739]
curr_Stock_Price:  97.10856593371543
curr_Factors:  [97.10856593]
mat_Sqrt:  [[0.15]]
grads:  [0.04763645]
Stock Position:  0.04763644552439751
Bond Position:  [-14.4839043]


portfolio before change:  [-9.88249662]
curr_Stock_Price:  96.63227869102072
curr_Factors:  [96.63227869]
mat_Sqrt:  [[0.15]]
grads:  [0.06402466]
Stock Position:  0.06402466305392629
Bond Position:  [-16.0693457]


portfolio before change:  [-9.84831382]
curr_Stock_Price:  97.19755441981182
curr_Factors:  [97.19755442]
mat_Sqrt:  [[0.15]]
grads:  [-0.0806929]
Stock Position:  -0.08069290414966934
Bond Position:  [-2.00516088]


portfolio before change:  [-9.77844364]
curr_Stock_Price:  96.32857032034835
curr_Factors:  [96.32857032]
mat_Sqrt:  [[0.15]]
grads:  [-0.06161877]
Stock Position:  -0.061618773571522234
Bond Position:  [-3.84279527]


portfolio before change:  [-9.82471004]
curr_Stock_Price:  97.07162352305745
curr_Factors:  [97.07162352]
mat_Sqrt:  [[0.15]]
grads:  [-0.00042432]
Stock Position:  -0.0004243186611738712
Bond Position:  [-9.78352074]


portfolio before change:  [-9.82553356]
curr_Stock_Price:  96.13011266216351
curr_Factors:  [96.13011266]
mat_Sqrt:  [[0.15]]
grads:  [-0.05106734]
Stock Position:  -0.05106734265841057
Bond Position:  [-4.91642415]


portfolio before change:  [-9.81208851]
curr_Stock_Price:  95.85479706402695
curr_Factors:  [95.85479706]
mat_Sqrt:  [[0.15]]
grads:  [-0.01803593]
Stock Position:  -0.018035926626081306
Bond Position:  [-8.08325843]


portfolio before change:  [-9.79622082]
curr_Stock_Price:  94.91898913277615
curr_Factors:  [94.91898913]
mat_Sqrt:  [[0.15]]
grads:  [0.00683472]
Stock Position:  0.006834723173235291
Bond Position:  [-10.44496583]


portfolio before change:  [-9.786088]
curr_Stock_Price:  96.59257826982069
curr_Factors:  [96.59257827]
mat_Sqrt:  [[0.15]]
grads:  [0.08843974]
Stock Position:  0.08843973736191907
Bond Position:  [-18.32871026]


portfolio before change:  [-9.67232446]
curr_Stock_Price:  97.90482518965003
curr_Factors:  [97.90482519]
mat_Sqrt:  [[0.15]]
grads:  [0.03175367]
Stock Position:  0.031753671904935034
Bond Position:  [-12.78116216]


portfolio before change:  [-9.6665872]
curr_Stock_Price:  98.13582225195482
curr_Factors:  [98.13582225]
mat_Sqrt:  [[0.15]]
grads:  [0.03819069]
Stock Position:  0.03819068797590634
Bond Position:  [-13.41446177]


portfolio before change:  [-9.66568435]
curr_Stock_Price:  98.20337190245111
curr_Factors:  [98.2033719]
mat_Sqrt:  [[0.15]]
grads:  [-0.0207316]
Stock Position:  -0.020731601149643928
Bond Position:  [-7.62977121]


portfolio before change:  [-9.66731543]
curr_Stock_Price:  98.2360419988058
curr_Factors:  [98.236042]
mat_Sqrt:  [[0.15]]
grads:  [-0.03812992]
Stock Position:  -0.03812991827006397
Bond Position:  [-5.92158318]


portfolio before change:  [-9.65294264]
curr_Stock_Price:  97.83968551056253
curr_Factors:  [97.83968551]
mat_Sqrt:  [[0.15]]
grads:  [-0.04036771]
Stock Position:  -0.04036771344789623
Bond Position:  [-5.70337825]


portfolio before change:  [-9.69487528]
curr_Stock_Price:  98.86079059281363
curr_Factors:  [98.86079059]
mat_Sqrt:  [[0.15]]
grads:  [-0.16257648]
Stock Position:  -0.16257647924499824
Bond Position:  [6.37756399]


portfolio before change:  [-9.70608691]
curr_Stock_Price:  98.93465659017133
curr_Factors:  [98.93465659]
mat_Sqrt:  [[0.15]]
grads:  [-0.24945066]
Stock Position:  -0.2494506600854074
Bond Position:  [14.97322848]


portfolio before change:  [-9.9337055]
curr_Stock_Price:  99.85463958498752
curr_Factors:  [99.85463958]
mat_Sqrt:  [[0.15]]
grads:  [0.1436297]
Stock Position:  0.14362970106564357
Bond Position:  [-24.27579754]


portfolio before change:  [-10.06486579]
curr_Stock_Price:  98.96258436695925
curr_Factors:  [98.96258437]
mat_Sqrt:  [[0.15]]
grads:  [0.04902666]
Stock Position:  0.04902665904272017
Bond Position:  [-14.91667067]


portfolio before change:  [-10.14084708]
curr_Stock_Price:  97.45082349308638
curr_Factors:  [97.45082349]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035714]
Stock Position:  -0.030357135679428562
Bond Position:  [-7.18251921]


portfolio before change:  [-10.14518929]
curr_Stock_Price:  97.56428413443848
curr_Factors:  [97.56428413]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355674]
Stock Position:  -0.08355673629966923
Bond Position:  [-1.99303613]


portfolio before change:  [-10.13442112]
curr_Stock_Price:  97.43242979238015
curr_Factors:  [97.43242979]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926457]
Stock Position:  -0.06926456600410426
Bond Position:  [-3.38580615]


portfolio before change:  [-10.19288066]
curr_Stock_Price:  98.27032281738634
curr_Factors:  [98.27032282]
mat_Sqrt:  [[0.15]]
grads:  [-0.05416724]
Stock Position:  -0.05416723823870751
Bond Position:  [-4.86984868]


portfolio before change:  [-10.17227882]
curr_Stock_Price:  97.87874636632763
curr_Factors:  [97.87874637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04926839]
Stock Position:  -0.049268394922567404
Bond Position:  [-5.34995009]


portfolio before change:  [-10.14456613]
curr_Stock_Price:  97.30268795982896
curr_Factors:  [97.30268796]
mat_Sqrt:  [[0.15]]
grads:  [0.13810683]
Stock Position:  0.1381068284473929
Bond Position:  [-23.58273176]


portfolio before change:  [-10.18333395]
curr_Stock_Price:  97.04332501787799
curr_Factors:  [97.04332502]
mat_Sqrt:  [[0.15]]
grads:  [0.05928945]
Stock Position:  0.059289447530144576
Bond Position:  [-15.93697908]


portfolio before change:  [-10.14770021]
curr_Stock_Price:  97.67794032723002
curr_Factors:  [97.67794033]
mat_Sqrt:  [[0.15]]
grads:  [0.15017967]
Stock Position:  0.1501796664848631
Bond Position:  [-24.81694071]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.14770021]
Stock Price:  97.96256585065005
PL:  [-10.14770021]
Settle:  Tensor("sub_4:0", shape=(), dtype=float64)
PL:  Tensor("sub_5:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  3
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.45041143e-03]
 [ 5.46890036e-03]
 [-2.57622999e-02]
 [-1.82743409e-02]
 [ 1.44192485e-02]
 [ 2.21666834e-02]
 [ 1.26007470e-02]
 [-9.45946113e-03]
 [ 4.13961512e-03]
 [ 4.30595180e-05]
 [-7.27541678e-03]
 [-6.28748187e-03]
 [ 6.95193411e-03]
 [ 1.04222535e-02]
 [ 1.86796913e-03]
 [-9.28052589e-03]
 [-1.88558620e-03]
 [-3.91889909e-04]
 [-7.56434369e-03]
 [-2.59044737e-03]
 [ 7.74546975e-04]
 [ 1.45106639e-02]
 [ 4.75635988e-03]
 [ 5.47751764e-03]
 [ 1.77316652e-03]
 [-2.06741630e-03]
 [ 1.35101706e-03]
 [-1.96001449e-02]
 [-3.03448307e-02]
 [ 2.18702228e-02]
 [ 3.22838743e-03]
 [-3.70013139e-03]
 [-1.25334995e-02]
 [-6.68993000e-03]
 [-8.61540893e-03]
 [-7.51746651e-03]
 [ 2.10731901e-02]
 [ 8.82848240e-03]
 [ 2.23156311e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.03599625]
curr_Stock_Price:  98.97079664341568
curr_Factors:  [98.97079664]
mat_Sqrt:  [[0.15]]
grads:  [-0.03633608]
Stock Position:  -0.03633607617054332
Bond Position:  [-10.43978584]


portfolio before change:  [-14.05502156]
curr_Stock_Price:  99.45847318423431
curr_Factors:  [99.45847318]
mat_Sqrt:  [[0.15]]
grads:  [0.03645934]
Stock Position:  0.036459335754800135
Bond Position:  [-17.68121142]


portfolio before change:  [-14.09125187]
curr_Stock_Price:  98.52537806523468
curr_Factors:  [98.52537807]
mat_Sqrt:  [[0.15]]
grads:  [-0.17174867]
Stock Position:  -0.17174866628020558
Bond Position:  [2.8303504]


portfolio before change:  [-14.13034645]
curr_Stock_Price:  98.7550648098872
curr_Factors:  [98.75506481]
mat_Sqrt:  [[0.15]]
grads:  [-0.12182894]
Stock Position:  -0.1218289392471768
Bond Position:  [-2.09912166]


portfolio before change:  [-14.07237612]
curr_Stock_Price:  98.27707709662721
curr_Factors:  [98.2770771]
mat_Sqrt:  [[0.15]]
grads:  [0.09612832]
Stock Position:  0.0961283230259114
Bond Position:  [-23.51958673]


portfolio before change:  [-14.04375336]
curr_Stock_Price:  98.60541831752951
curr_Factors:  [98.60541832]
mat_Sqrt:  [[0.15]]
grads:  [0.14777789]
Stock Position:  0.14777788906393685
Bond Position:  [-28.61545393]


portfolio before change:  [-14.06129382]
curr_Stock_Price:  98.51092989754463
curr_Factors:  [98.5109299]
mat_Sqrt:  [[0.15]]
grads:  [0.08400498]
Stock Position:  0.08400498016298466
Bond Position:  [-22.33670253]


portfolio before change:  [-14.20229982]
curr_Stock_Price:  96.86562575902465
curr_Factors:  [96.86562576]
mat_Sqrt:  [[0.15]]
grads:  [-0.06306307]
Stock Position:  -0.06306307422570988
Bond Position:  [-8.09365567]


portfolio before change:  [-14.21444892]
curr_Stock_Price:  97.04223200670502
curr_Factors:  [97.04223201]
mat_Sqrt:  [[0.15]]
grads:  [0.02759743]
Stock Position:  0.027597434126877252
Bond Position:  [-16.89256553]


portfolio before change:  [-14.19941157]
curr_Stock_Price:  97.66363224520168
curr_Factors:  [97.66363225]
mat_Sqrt:  [[0.15]]
grads:  [0.00028706]
Stock Position:  0.0002870634533893845
Bond Position:  [-14.22744723]


portfolio before change:  [-14.20112551]
curr_Stock_Price:  97.88870011564676
curr_Factors:  [97.88870012]
mat_Sqrt:  [[0.15]]
grads:  [-0.04850278]
Stock Position:  -0.04850277850063585
Bond Position:  [-9.45325157]


portfolio before change:  [-14.17731134]
curr_Stock_Price:  97.37335019535561
curr_Factors:  [97.3733502]
mat_Sqrt:  [[0.15]]
grads:  [-0.04191655]
Stock Position:  -0.0419165458280853
Bond Position:  [-10.09575684]


portfolio before change:  [-14.20343947]
curr_Stock_Price:  97.9665785806488
curr_Factors:  [97.96657858]
mat_Sqrt:  [[0.15]]
grads:  [0.04634623]
Stock Position:  0.04634622739331954
Bond Position:  [-18.7438208]


portfolio before change:  [-14.19691892]
curr_Stock_Price:  98.15782771242122
curr_Factors:  [98.15782771]
mat_Sqrt:  [[0.15]]
grads:  [0.06948169]
Stock Position:  0.06948169019668038
Bond Position:  [-21.01709069]


portfolio before change:  [-14.21322639]
curr_Stock_Price:  97.96093883936153
curr_Factors:  [97.96093884]
mat_Sqrt:  [[0.15]]
grads:  [0.01245313]
Stock Position:  0.012453127513269447
Bond Position:  [-15.43314645]


portfolio before change:  [-14.20387719]
curr_Stock_Price:  98.8666121585115
curr_Factors:  [98.86661216]
mat_Sqrt:  [[0.15]]
grads:  [-0.06187017]
Stock Position:  -0.061870172586336016
Bond Position:  [-8.08698283]


portfolio before change:  [-14.21619331]
curr_Stock_Price:  99.04933647553726
curr_Factors:  [99.04933648]
mat_Sqrt:  [[0.15]]
grads:  [-0.01257057]
Stock Position:  -0.012570574647063364
Bond Position:  [-12.97108623]


portfolio before change:  [-14.19676011]
curr_Stock_Price:  97.37441794671403
curr_Factors:  [97.37441795]
mat_Sqrt:  [[0.15]]
grads:  [-0.0026126]
Stock Position:  -0.002612599391701477
Bond Position:  [-13.94235976]


portfolio before change:  [-14.19920263]
curr_Stock_Price:  97.64220345315476
curr_Factors:  [97.64220345]
mat_Sqrt:  [[0.15]]
grads:  [-0.05042896]
Stock Position:  -0.05042895791804655
Bond Position:  [-9.27520806]


portfolio before change:  [-14.14538821]
curr_Stock_Price:  96.55207799659624
curr_Factors:  [96.552078]
mat_Sqrt:  [[0.15]]
grads:  [-0.01726965]
Stock Position:  -0.01726964914908797
Bond Position:  [-12.4779677]


portfolio before change:  [-14.13803004]
curr_Stock_Price:  96.03568020091019
curr_Factors:  [96.0356802]
mat_Sqrt:  [[0.15]]
grads:  [0.00516365]
Stock Position:  0.005163646497041179
Bond Position:  [-14.63392435]


portfolio before change:  [-14.1426225]
curr_Stock_Price:  95.50057300985644
curr_Factors:  [95.50057301]
mat_Sqrt:  [[0.15]]
grads:  [0.09673776]
Stock Position:  0.09673775965025856
Bond Position:  [-23.38113398]


portfolio before change:  [-14.12719455]
curr_Stock_Price:  95.69026911425539
curr_Factors:  [95.69026911]
mat_Sqrt:  [[0.15]]
grads:  [0.03170907]
Stock Position:  0.03170906589411559
Bond Position:  [-17.1614436]


portfolio before change:  [-14.13819361]
curr_Stock_Price:  95.41105106564319
curr_Factors:  [95.41105107]
mat_Sqrt:  [[0.15]]
grads:  [0.03651678]
Stock Position:  0.036516784293947446
Bond Position:  [-17.62229838]


portfolio before change:  [-14.13649066]
curr_Stock_Price:  95.51801213979896
curr_Factors:  [95.51801214]
mat_Sqrt:  [[0.15]]
grads:  [0.01182111]
Stock Position:  0.011821110102039843
Bond Position:  [-15.2656196]


portfolio before change:  [-14.1435184]
curr_Stock_Price:  95.08493768533177
curr_Factors:  [95.08493769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01378278]
Stock Position:  -0.013782775315157904
Bond Position:  [-12.83298407]


portfolio before change:  [-14.15401213]
curr_Stock_Price:  95.72990977067533
curr_Factors:  [95.72990977]
mat_Sqrt:  [[0.15]]
grads:  [0.00900678]
Stock Position:  0.009006780422655982
Bond Position:  [-15.01623041]


portfolio before change:  [-14.14334825]
curr_Stock_Price:  97.1223081361519
curr_Factors:  [97.12230814]
mat_Sqrt:  [[0.15]]
grads:  [-0.13066763]
Stock Position:  -0.13066763266526432
Bond Position:  [-1.45260617]


portfolio before change:  [-14.16603689]
curr_Stock_Price:  97.2945546874292
curr_Factors:  [97.29455469]
mat_Sqrt:  [[0.15]]
grads:  [-0.20229887]
Stock Position:  -0.2022988711256128
Bond Position:  [5.51654169]


portfolio before change:  [-14.00085338]
curr_Stock_Price:  96.48143150570091
curr_Factors:  [96.48143151]
mat_Sqrt:  [[0.15]]
grads:  [0.14580149]
Stock Position:  0.1458014850690938
Bond Position:  [-28.06798937]


portfolio before change:  [-13.928701]
curr_Stock_Price:  97.0003637896159
curr_Factors:  [97.00036379]
mat_Sqrt:  [[0.15]]
grads:  [0.02152258]
Stock Position:  0.021522582863831286
Bond Position:  [-16.01639936]


portfolio before change:  [-13.91283296]
curr_Stock_Price:  97.83066429484707
curr_Factors:  [97.83066429]
mat_Sqrt:  [[0.15]]
grads:  [-0.02466754]
Stock Position:  -0.02466754262929718
Bond Position:  [-11.49959088]


portfolio before change:  [-13.91838206]
curr_Stock_Price:  97.99734341639882
curr_Factors:  [97.99734342]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355666]
Stock Position:  -0.08355666315524948
Bond Position:  [-5.73005105]


portfolio before change:  [-14.04025233]
curr_Stock_Price:  99.44730514543123
curr_Factors:  [99.44730515]
mat_Sqrt:  [[0.15]]
grads:  [-0.04459953]
Stock Position:  -0.04459953334050067
Bond Position:  [-9.60494893]


portfolio before change:  [-14.01796793]
curr_Stock_Price:  98.92072815883742
curr_Factors:  [98.92072816]
mat_Sqrt:  [[0.15]]
grads:  [-0.05743606]
Stock Position:  -0.05743605956380196
Bond Position:  [-8.3363511]


portfolio before change:  [-14.02449841]
curr_Stock_Price:  99.01628428931734
curr_Factors:  [99.01628429]
mat_Sqrt:  [[0.15]]
grads:  [-0.05011644]
Stock Position:  -0.05011644337609743
Bond Position:  [-9.0621544]


portfolio before change:  [-13.95718138]
curr_Stock_Price:  97.65046774324072
curr_Factors:  [97.65046774]
mat_Sqrt:  [[0.15]]
grads:  [0.14048793]
Stock Position:  0.1404879338600196
Bond Position:  [-27.67589384]


portfolio before change:  [-14.0159271]
curr_Stock_Price:  97.25693916874151
curr_Factors:  [97.25693917]
mat_Sqrt:  [[0.15]]
grads:  [0.05885655]
Stock Position:  0.05885654933882767
Bond Position:  [-19.74013494]


portfolio before change:  [-14.00835237]
curr_Stock_Price:  97.4275643061075
curr_Factors:  [97.42756431]
mat_Sqrt:  [[0.15]]
grads:  [0.14877087]
Stock Position:  0.14877087429587235
Bond Position:  [-28.50273629]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.00835237]
Stock Price:  97.13727539080915
PL:  [-14.00835237]
Settle:  Tensor("sub_6:0", shape=(), dtype=float64)
PL:  Tensor("sub_7:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  4
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.92884237e-03]
 [ 4.47529723e-03]
 [ 1.52904255e-02]
 [ 3.27014237e-02]
 [ 1.93550017e-02]
 [ 1.92893816e-02]
 [ 2.66652129e-02]
 [-3.53908074e-03]
 [ 1.62839202e-02]
 [-3.71503234e-03]
 [ 5.87365251e-03]
 [ 2.06015845e-03]
 [ 6.01377597e-03]
 [ 9.60652766e-03]
 [ 6.69749106e-03]
 [-1.18783521e-02]
 [-5.26193293e-03]
 [-1.33858452e-03]
 [-7.42843434e-03]
 [-2.36561811e-03]
 [ 4.07725438e-04]
 [ 1.06420055e-02]
 [ 4.75851873e-03]
 [ 5.47464927e-03]
 [-2.56767568e-03]
 [-5.17835899e-03]
 [-7.27947871e-03]
 [-1.92349379e-02]
 [-2.82020996e-02]
 [ 2.18844513e-02]
 [ 3.20874135e-03]
 [-7.90043367e-03]
 [-1.24481039e-02]
 [-8.98269095e-03]
 [-6.58807864e-03]
 [-3.54372597e-03]
 [ 1.86078815e-02]
 [ 1.15010034e-02]
 [ 1.83712069e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.25972964]
curr_Stock_Price:  99.47175983984144
curr_Factors:  [99.47175984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02619228]
Stock Position:  -0.0261922824697424
Bond Position:  [-3.65433721]


portfolio before change:  [-6.26283953]
curr_Stock_Price:  99.57305191820741
curr_Factors:  [99.57305192]
mat_Sqrt:  [[0.15]]
grads:  [0.02983531]
Stock Position:  0.029835314848366146
Bond Position:  [-9.23363289]


portfolio before change:  [-6.23585294]
curr_Stock_Price:  100.51625849662958
curr_Factors:  [100.5162585]
mat_Sqrt:  [[0.15]]
grads:  [0.10193617]
Stock Position:  0.10193616988731329
Bond Position:  [-16.48209534]


portfolio before change:  [-6.13959175]
curr_Stock_Price:  101.48079915203009
curr_Factors:  [101.48079915]
mat_Sqrt:  [[0.15]]
grads:  [0.21800949]
Stock Position:  0.2180094910330646
Bond Position:  [-28.26336913]


portfolio before change:  [-6.25044929]
curr_Stock_Price:  100.98850684222356
curr_Factors:  [100.98850684]
mat_Sqrt:  [[0.15]]
grads:  [0.12903334]
Stock Position:  0.12903334499873084
Bond Position:  [-19.28133413]


portfolio before change:  [-6.32116724]
curr_Stock_Price:  100.4591271852592
curr_Factors:  [100.45912719]
mat_Sqrt:  [[0.15]]
grads:  [0.12859588]
Stock Position:  0.12859587719202517
Bond Position:  [-19.23979682]


portfolio before change:  [-6.41628573]
curr_Stock_Price:  99.7381602687424
curr_Factors:  [99.73816027]
mat_Sqrt:  [[0.15]]
grads:  [0.17776809]
Stock Position:  0.17776808585694912
Bond Position:  [-24.14654757]


portfolio before change:  [-6.63739213]
curr_Stock_Price:  98.51134902309323
curr_Factors:  [98.51134902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02359387]
Stock Position:  -0.02359387160364636
Bond Position:  [-4.31312801]


portfolio before change:  [-6.64561215]
curr_Stock_Price:  98.83689300806097
curr_Factors:  [98.83689301]
mat_Sqrt:  [[0.15]]
grads:  [0.10855947]
Stock Position:  0.10855946821327674
Bond Position:  [-17.37529269]


portfolio before change:  [-6.60115713]
curr_Stock_Price:  99.26640009475794
curr_Factors:  [99.26640009]
mat_Sqrt:  [[0.15]]
grads:  [-0.02476688]
Stock Position:  -0.024766882290331173
Bond Position:  [-4.14263789]


portfolio before change:  [-6.57622909]
curr_Stock_Price:  98.23898363443519
curr_Factors:  [98.23898363]
mat_Sqrt:  [[0.15]]
grads:  [0.03915768]
Stock Position:  0.039157683405325744
Bond Position:  [-10.42304011]


portfolio before change:  [-6.56485287]
curr_Stock_Price:  98.56278171779189
curr_Factors:  [98.56278172]
mat_Sqrt:  [[0.15]]
grads:  [0.01373439]
Stock Position:  0.013734389673949864
Bond Position:  [-7.91855252]


portfolio before change:  [-6.56925026]
curr_Stock_Price:  98.31468083432782
curr_Factors:  [98.31468083]
mat_Sqrt:  [[0.15]]
grads:  [0.04009184]
Stock Position:  0.04009183979628316
Bond Position:  [-10.5108667]


portfolio before change:  [-6.58621306]
curr_Stock_Price:  97.92435575208378
curr_Factors:  [97.92435575]
mat_Sqrt:  [[0.15]]
grads:  [0.06404352]
Stock Position:  0.06404351776022077
Bond Position:  [-12.85763327]


portfolio before change:  [-6.63786256]
curr_Stock_Price:  97.14297764815352
curr_Factors:  [97.14297765]
mat_Sqrt:  [[0.15]]
grads:  [0.04464994]
Stock Position:  0.044649940392328426
Bond Position:  [-10.97529072]


portfolio before change:  [-6.64078311]
curr_Stock_Price:  97.10829569153604
curr_Factors:  [97.10829569]
mat_Sqrt:  [[0.15]]
grads:  [-0.07918901]
Stock Position:  -0.07918901431139144
Bond Position:  [1.04912711]


portfolio before change:  [-6.69651332]
curr_Stock_Price:  97.81371373929082
curr_Factors:  [97.81371374]
mat_Sqrt:  [[0.15]]
grads:  [-0.03507955]
Stock Position:  -0.035079552850917954
Bond Position:  [-3.26525198]


portfolio before change:  [-6.70025825]
curr_Stock_Price:  97.90883317237346
curr_Factors:  [97.90883317]
mat_Sqrt:  [[0.15]]
grads:  [-0.0089239]
Stock Position:  -0.008923896785245399
Bond Position:  [-5.82652993]


portfolio before change:  [-6.70914906]
curr_Stock_Price:  98.82350645556006
curr_Factors:  [98.82350646]
mat_Sqrt:  [[0.15]]
grads:  [-0.0495229]
Stock Position:  -0.049522895629267066
Bond Position:  [-1.81512286]


portfolio before change:  [-6.72003933]
curr_Stock_Price:  99.03882830572287
curr_Factors:  [99.03882831]
mat_Sqrt:  [[0.15]]
grads:  [-0.01577079]
Stock Position:  -0.01577078738992977
Bond Position:  [-5.15811902]


portfolio before change:  [-6.70062003]
curr_Stock_Price:  97.76659657764573
curr_Factors:  [97.76659658]
mat_Sqrt:  [[0.15]]
grads:  [0.00271817]
Stock Position:  0.00271816958887107
Bond Position:  [-6.96636622]


portfolio before change:  [-6.70217864]
curr_Stock_Price:  97.51357397239414
curr_Factors:  [97.51357397]
mat_Sqrt:  [[0.15]]
grads:  [0.0709467]
Stock Position:  0.07094670329143007
Bond Position:  [-13.62044524]


portfolio before change:  [-6.72265861]
curr_Stock_Price:  97.24890615236731
curr_Factors:  [97.24890615]
mat_Sqrt:  [[0.15]]
grads:  [0.03172346]
Stock Position:  0.03172345819566418
Bond Position:  [-9.80773022]


portfolio before change:  [-6.72226208]
curr_Stock_Price:  97.30005363453643
curr_Factors:  [97.30005363]
mat_Sqrt:  [[0.15]]
grads:  [0.03649766]
Stock Position:  0.03649766180435157
Bond Position:  [-10.27348653]


portfolio before change:  [-6.69946743]
curr_Stock_Price:  97.95979242140109
curr_Factors:  [97.95979242]
mat_Sqrt:  [[0.15]]
grads:  [-0.01711784]
Stock Position:  -0.017117837836137257
Bond Position:  [-5.02260758]


portfolio before change:  [-6.69683176]
curr_Stock_Price:  97.76914173311907
curr_Factors:  [97.76914173]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452239]
Stock Position:  -0.03452239329358165
Bond Position:  [-3.321607]


portfolio before change:  [-6.68866148]
curr_Stock_Price:  97.52044769481911
curr_Factors:  [97.52044769]
mat_Sqrt:  [[0.15]]
grads:  [-0.04852986]
Stock Position:  -0.04852985803693621
Bond Position:  [-1.95600799]


portfolio before change:  [-6.65486154]
curr_Stock_Price:  96.81893218477772
curr_Factors:  [96.81893218]
mat_Sqrt:  [[0.15]]
grads:  [-0.12823292]
Stock Position:  -0.12823291937209202
Bond Position:  [5.76051278]


portfolio before change:  [-6.52490254]
curr_Stock_Price:  95.8110872500567
curr_Factors:  [95.81108725]
mat_Sqrt:  [[0.15]]
grads:  [-0.188014]
Stock Position:  -0.18801399706687466
Bond Position:  [11.48892294]


portfolio before change:  [-6.68421143]
curr_Stock_Price:  96.66605068705199
curr_Factors:  [96.66605069]
mat_Sqrt:  [[0.15]]
grads:  [0.14589634]
Stock Position:  0.14589634178653557
Bond Position:  [-20.7874346]


portfolio before change:  [-6.64086922]
curr_Stock_Price:  96.98093723550099
curr_Factors:  [96.98093724]
mat_Sqrt:  [[0.15]]
grads:  [0.02139161]
Stock Position:  0.02139160901056008
Bond Position:  [-8.71544751]


portfolio before change:  [-6.67069987]
curr_Stock_Price:  95.63736603576622
curr_Factors:  [95.63736604]
mat_Sqrt:  [[0.15]]
grads:  [-0.05266956]
Stock Position:  -0.05266955778213351
Bond Position:  [-1.63352209]


portfolio before change:  [-6.68614442]
curr_Stock_Price:  95.9267237673848
curr_Factors:  [95.92672377]
mat_Sqrt:  [[0.15]]
grads:  [-0.08298736]
Stock Position:  -0.08298735927139933
Bond Position:  [1.27456107]


portfolio before change:  [-6.67055413]
curr_Stock_Price:  95.74078035567109
curr_Factors:  [95.74078036]
mat_Sqrt:  [[0.15]]
grads:  [-0.05988461]
Stock Position:  -0.05988460633533581
Bond Position:  [-0.93715519]


portfolio before change:  [-6.70231484]
curr_Stock_Price:  96.26918912451434
curr_Factors:  [96.26918912]
mat_Sqrt:  [[0.15]]
grads:  [-0.04392052]
Stock Position:  -0.04392052425885493
Bond Position:  [-2.47412158]


portfolio before change:  [-6.62857509]
curr_Stock_Price:  94.58321126866656
curr_Factors:  [94.58321127]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362484]
Stock Position:  -0.02362483978535416
Bond Position:  [-4.39406188]


portfolio before change:  [-6.62918847]
curr_Stock_Price:  94.58592403666667
curr_Factors:  [94.58592404]
mat_Sqrt:  [[0.15]]
grads:  [0.12405254]
Stock Position:  0.12405254304547376
Bond Position:  [-18.36281288]


portfolio before change:  [-6.69771917]
curr_Stock_Price:  94.05199537483165
curr_Factors:  [94.05199537]
mat_Sqrt:  [[0.15]]
grads:  [0.07667336]
Stock Position:  0.07667335622692915
Bond Position:  [-13.90900132]


portfolio before change:  [-6.68108297]
curr_Stock_Price:  94.29164762142462
curr_Factors:  [94.29164762]
mat_Sqrt:  [[0.15]]
grads:  [0.12247471]
Stock Position:  0.12247471240525963
Bond Position:  [-18.22942539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.68108297]
Stock Price:  94.83165320633974
PL:  [-6.68108297]
Settle:  Tensor("sub_8:0", shape=(), dtype=float64)
PL:  Tensor("sub_9:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  5
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44527292e-03]
 [-5.12945723e-03]
 [-4.32217241e-03]
 [ 4.32271636e-02]
 [-2.59812840e-02]
 [ 3.17514726e-02]
 [ 5.56888713e-03]
 [ 1.25596328e-03]
 [ 1.28108830e-02]
 [ 1.26393850e-02]
 [ 2.56561282e-02]
 [-1.03435063e-02]
 [-1.25672203e-02]
 [-9.13193128e-03]
 [ 5.24542120e-03]
 [-3.55518092e-02]
 [ 4.86063335e-03]
 [-1.51869988e-02]
 [ 1.96353439e-02]
 [-5.50505813e-03]
 [-3.32133270e-03]
 [-3.91068438e-02]
 [ 4.85468716e-03]
 [ 1.38272146e-02]
 [-6.32996231e-03]
 [ 2.27865559e-02]
 [-1.65554336e-02]
 [ 1.02438606e-02]
 [ 7.02387240e-02]
 [ 2.66485717e-02]
 [-2.97137402e-02]
 [ 4.37218594e-03]
 [-1.31511356e-02]
 [ 3.86773869e-03]
 [-6.24034125e-03]
 [ 1.40683628e-03]
 [ 2.42345812e-02]
 [ 5.01017553e-03]
 [ 1.92254961e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.88227357]
curr_Stock_Price:  100.12512868665023
curr_Factors:  [100.12512869]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963515]
Stock Position:  -0.009635152825444306
Bond Position:  [4.84699449]


portfolio before change:  [3.87315637]
curr_Stock_Price:  101.13425851359466
curr_Factors:  [101.13425851]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419638]
Stock Position:  -0.03419638156136755
Bond Position:  [7.33158206]


portfolio before change:  [3.85800197]
curr_Stock_Price:  101.60421768565362
curr_Factors:  [101.60421769]
mat_Sqrt:  [[0.15]]
grads:  [-0.02881448]
Stock Position:  -0.028814482733287423
Bond Position:  [6.78567494]


portfolio before change:  [3.85465248]
curr_Stock_Price:  101.74989971952945
curr_Factors:  [101.74989972]
mat_Sqrt:  [[0.15]]
grads:  [0.28818109]
Stock Position:  0.2881810907849596
Bond Position:  [-25.46774461]


portfolio before change:  [4.17355292]
curr_Stock_Price:  102.86754456663881
curr_Factors:  [102.86754457]
mat_Sqrt:  [[0.15]]
grads:  [-0.17320856]
Stock Position:  -0.1732085601004099
Bond Position:  [21.9910922]


portfolio before change:  [4.29912719]
curr_Stock_Price:  102.1584271488916
curr_Factors:  [102.15842715]
mat_Sqrt:  [[0.15]]
grads:  [0.21167648]
Stock Position:  0.21167648372374778
Bond Position:  [-17.32540945]


portfolio before change:  [4.42816291]
curr_Stock_Price:  102.77824817995955
curr_Factors:  [102.77824818]
mat_Sqrt:  [[0.15]]
grads:  [0.03712591]
Stock Position:  0.0371259141948572
Bond Position:  [0.61242649]


portfolio before change:  [4.43436318]
curr_Stock_Price:  102.94319261903755
curr_Factors:  [102.94319262]
mat_Sqrt:  [[0.15]]
grads:  [0.00837309]
Stock Position:  0.008373088546026782
Bond Position:  [3.57241072]


portfolio before change:  [4.44068858]
curr_Stock_Price:  103.64530164046826
curr_Factors:  [103.64530164]
mat_Sqrt:  [[0.15]]
grads:  [0.08540589]
Stock Position:  0.08540588642979628
Bond Position:  [-4.41123028]


portfolio before change:  [4.39322149]
curr_Stock_Price:  103.09597584899262
curr_Factors:  [103.09597585]
mat_Sqrt:  [[0.15]]
grads:  [0.08426257]
Stock Position:  0.08426256693320379
Bond Position:  [-4.29391008]


portfolio before change:  [4.36344188]
curr_Stock_Price:  102.74893166666523
curr_Factors:  [102.74893167]
mat_Sqrt:  [[0.15]]
grads:  [0.17104085]
Stock Position:  0.1710408545461963
Bond Position:  [-13.21082319]


portfolio before change:  [4.61132376]
curr_Stock_Price:  104.20784236926896
curr_Factors:  [104.20784237]
mat_Sqrt:  [[0.15]]
grads:  [-0.06895671]
Stock Position:  -0.06895670887340657
Bond Position:  [11.79715361]


portfolio before change:  [4.60358177]
curr_Stock_Price:  104.34150193170156
curr_Factors:  [104.34150193]
mat_Sqrt:  [[0.15]]
grads:  [-0.08378147]
Stock Position:  -0.08378146899911813
Bond Position:  [13.34546608]


portfolio before change:  [4.54051408]
curr_Stock_Price:  105.11417847677443
curr_Factors:  [105.11417848]
mat_Sqrt:  [[0.15]]
grads:  [-0.06087954]
Stock Position:  -0.060879541835698964
Bond Position:  [10.93981711]


portfolio before change:  [4.50242174]
curr_Stock_Price:  105.76234221180789
curr_Factors:  [105.76234221]
mat_Sqrt:  [[0.15]]
grads:  [0.03496947]
Stock Position:  0.034969474678634545
Bond Position:  [0.80396819]


portfolio before change:  [4.51939657]
curr_Stock_Price:  106.24488687772671
curr_Factors:  [106.24488688]
mat_Sqrt:  [[0.15]]
grads:  [-0.23701206]
Stock Position:  -0.23701206133419422
Bond Position:  [29.70071622]


portfolio before change:  [4.33071412]
curr_Stock_Price:  107.05663997373807
curr_Factors:  [107.05663997]
mat_Sqrt:  [[0.15]]
grads:  [0.03240422]
Stock Position:  0.032404222357020805
Bond Position:  [0.86162695]


portfolio before change:  [4.33276834]
curr_Stock_Price:  107.1167096885295
curr_Factors:  [107.11670969]
mat_Sqrt:  [[0.15]]
grads:  [-0.10124666]
Stock Position:  -0.10124665879539556
Bond Position:  [15.1779773]


portfolio before change:  [4.29086058]
curr_Stock_Price:  107.54936720891584
curr_Factors:  [107.54936721]
mat_Sqrt:  [[0.15]]
grads:  [0.13090229]
Stock Position:  0.1309022927726975
Bond Position:  [-9.78759818]


portfolio before change:  [4.30942858]
curr_Stock_Price:  107.7005603647863
curr_Factors:  [107.70056036]
mat_Sqrt:  [[0.15]]
grads:  [-0.03670039]
Stock Position:  -0.03670038753660186
Bond Position:  [8.26208089]


portfolio before change:  [4.31866263]
curr_Stock_Price:  107.47709622608791
curr_Factors:  [107.47709623]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214222]
Stock Position:  -0.022142217999736476
Bond Position:  [6.69844392]


portfolio before change:  [4.3183976]
curr_Stock_Price:  107.52688261914165
curr_Factors:  [107.52688262]
mat_Sqrt:  [[0.15]]
grads:  [-0.26071229]
Stock Position:  -0.26071229213983144
Bond Position:  [32.35197764]


portfolio before change:  [4.21571817]
curr_Stock_Price:  107.93623685067456
curr_Factors:  [107.93623685]
mat_Sqrt:  [[0.15]]
grads:  [0.03236458]
Stock Position:  0.03236458107493709
Bond Position:  [0.72240709]


portfolio before change:  [4.20775899]
curr_Stock_Price:  107.68752372913325
curr_Factors:  [107.68752373]
mat_Sqrt:  [[0.15]]
grads:  [0.09218143]
Stock Position:  0.09218143061618325
Bond Position:  [-5.71903101]


portfolio before change:  [4.28239727]
curr_Stock_Price:  108.50496829883114
curr_Factors:  [108.5049683]
mat_Sqrt:  [[0.15]]
grads:  [-0.04219975]
Stock Position:  -0.04219974870817665
Bond Position:  [8.86127967]


portfolio before change:  [4.29342299]
curr_Stock_Price:  108.26994336001404
curr_Factors:  [108.26994336]
mat_Sqrt:  [[0.15]]
grads:  [0.15191037]
Stock Position:  0.15191037250767211
Bond Position:  [-12.15390443]


portfolio before change:  [4.19599099]
curr_Stock_Price:  107.63856662589527
curr_Factors:  [107.63856663]
mat_Sqrt:  [[0.15]]
grads:  [-0.11036956]
Stock Position:  -0.11036955752880578
Bond Position:  [16.07601196]


portfolio before change:  [4.24696887]
curr_Stock_Price:  107.19489125769901
curr_Factors:  [107.19489126]
mat_Sqrt:  [[0.15]]
grads:  [0.0682924]
Stock Position:  0.06829240431305272
Bond Position:  [-3.07362799]


portfolio before change:  [4.25088698]
curr_Stock_Price:  107.25789001691719
curr_Factors:  [107.25789002]
mat_Sqrt:  [[0.15]]
grads:  [0.46825816]
Stock Position:  0.46825816029593426
Bond Position:  [-45.97349528]


portfolio before change:  [3.7762125]
curr_Stock_Price:  106.25646074717277
curr_Factors:  [106.25646075]
mat_Sqrt:  [[0.15]]
grads:  [0.17765714]
Stock Position:  0.1776571448640903
Bond Position:  [-15.10100694]


portfolio before change:  [3.85016893]
curr_Stock_Price:  106.68337386508674
curr_Factors:  [106.68337387]
mat_Sqrt:  [[0.15]]
grads:  [-0.1980916]
Stock Position:  -0.19809160154413724
Bond Position:  [24.98324931]


portfolio before change:  [3.83674251]
curr_Stock_Price:  106.76691861299248
curr_Factors:  [106.76691861]
mat_Sqrt:  [[0.15]]
grads:  [0.02914791]
Stock Position:  0.029147906256213284
Bond Position:  [0.72471038]


portfolio before change:  [3.82049767]
curr_Stock_Price:  106.20648594025224
curr_Factors:  [106.20648594]
mat_Sqrt:  [[0.15]]
grads:  [-0.08767424]
Stock Position:  -0.08767423755985557
Bond Position:  [13.13207035]


portfolio before change:  [3.82279616]
curr_Stock_Price:  106.19899366616325
curr_Factors:  [106.19899367]
mat_Sqrt:  [[0.15]]
grads:  [0.02578492]
Stock Position:  0.02578492461010085
Bond Position:  [1.08446311]


portfolio before change:  [3.79106541]
curr_Stock_Price:  104.96314298215268
curr_Factors:  [104.96314298]
mat_Sqrt:  [[0.15]]
grads:  [-0.04160228]
Stock Position:  -0.04160227500765662
Bond Position:  [8.15777095]


portfolio before change:  [3.79103411]
curr_Stock_Price:  104.98840806752176
curr_Factors:  [104.98840807]
mat_Sqrt:  [[0.15]]
grads:  [0.00937891]
Stock Position:  0.00937890853968247
Bond Position:  [2.80635743]


portfolio before change:  [3.79557049]
curr_Stock_Price:  105.43468171051603
curr_Factors:  [105.43468171]
mat_Sqrt:  [[0.15]]
grads:  [0.16156387]
Stock Position:  0.1615638744093102
Bond Position:  [-13.23886519]


portfolio before change:  [3.91151914]
curr_Stock_Price:  106.16258959760496
curr_Factors:  [106.1625896]
mat_Sqrt:  [[0.15]]
grads:  [0.03340117]
Stock Position:  0.03340117020439495
Bond Position:  [0.36556442]


portfolio before change:  [3.92508433]
curr_Stock_Price:  106.56735043617526
curr_Factors:  [106.56735044]
mat_Sqrt:  [[0.15]]
grads:  [0.12816997]
Stock Position:  0.1281699739708389
Bond Position:  [-9.7336502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.92508433]
Stock Price:  105.46950066236097
PL:  [-1.54441634]
Settle:  Tensor("sub_10:0", shape=(), dtype=float64)
PL:  Tensor("sub_11:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  6
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.19059194e-03]
 [-1.06949762e-02]
 [-3.72754219e-03]
 [ 4.52549741e-02]
 [ 5.53783402e-03]
 [ 2.88676775e-02]
 [ 1.64214529e-02]
 [-1.98531431e-03]
 [ 3.45865808e-03]
 [ 1.11329738e-02]
 [ 2.12389512e-02]
 [ 1.06565007e-02]
 [-1.09929038e-02]
 [ 1.17522998e-02]
 [-6.48305412e-03]
 [-2.72167356e-02]
 [ 4.63906922e-03]
 [-2.01639121e-03]
 [-1.16188379e-02]
 [-2.21696373e-03]
 [-6.96402943e-04]
 [-3.96551816e-02]
 [ 4.79635335e-03]
 [ 7.79033606e-03]
 [-5.31752253e-03]
 [-7.17505274e-03]
 [-3.29570491e-03]
 [-1.64086782e-02]
 [-6.95030194e-03]
 [ 2.37302652e-02]
 [-1.78208725e-03]
 [ 6.62192333e-03]
 [-1.28360774e-02]
 [ 2.51474504e-04]
 [-6.15370333e-03]
 [-1.30438450e-03]
 [ 2.33564380e-02]
 [ 9.57862482e-04]
 [ 2.23072335e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.90310496]
curr_Stock_Price:  101.15722381703205
curr_Factors:  [101.15722382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02127061]
Stock Position:  -0.021270612936644843
Bond Position:  [22.05478112]


portfolio before change:  [19.91691826]
curr_Stock_Price:  100.63743274053202
curr_Factors:  [100.63743274]
mat_Sqrt:  [[0.15]]
grads:  [-0.07129984]
Stock Position:  -0.0712998414578456
Bond Position:  [27.09235126]


portfolio before change:  [19.84458397]
curr_Stock_Price:  101.69944136540117
curr_Factors:  [101.69944137]
mat_Sqrt:  [[0.15]]
grads:  [-0.02485028]
Stock Position:  -0.02485028126591816
Bond Position:  [22.37184369]


portfolio before change:  [19.84450067]
curr_Stock_Price:  101.81533351567754
curr_Factors:  [101.81533352]
mat_Sqrt:  [[0.15]]
grads:  [0.30169983]
Stock Position:  0.3016998273813198
Bond Position:  [-10.87316788]


portfolio before change:  [19.83162045]
curr_Stock_Price:  101.77714660929786
curr_Factors:  [101.77714661]
mat_Sqrt:  [[0.15]]
grads:  [0.03691889]
Stock Position:  0.03691889345422914
Bond Position:  [16.07412082]


portfolio before change:  [19.82526724]
curr_Stock_Price:  101.55063365677438
curr_Factors:  [101.55063366]
mat_Sqrt:  [[0.15]]
grads:  [0.19245118]
Stock Position:  0.19245118307732956
Bond Position:  [0.28172765]


portfolio before change:  [19.80264441]
curr_Stock_Price:  101.43289967732278
curr_Factors:  [101.43289968]
mat_Sqrt:  [[0.15]]
grads:  [0.10947635]
Stock Position:  0.10947635239350574
Bond Position:  [8.69814054]


portfolio before change:  [19.75773597]
curr_Stock_Price:  101.0127561598387
curr_Factors:  [101.01275616]
mat_Sqrt:  [[0.15]]
grads:  [-0.01323543]
Stock Position:  -0.013235428727755748
Bond Position:  [21.0946831]


portfolio before change:  [19.75752361]
curr_Stock_Price:  101.22803909701966
curr_Factors:  [101.2280391]
mat_Sqrt:  [[0.15]]
grads:  [0.02305772]
Stock Position:  0.023057720524033844
Bond Position:  [17.42343577]


portfolio before change:  [19.77212723]
curr_Stock_Price:  101.7669283302521
curr_Factors:  [101.76692833]
mat_Sqrt:  [[0.15]]
grads:  [0.07421983]
Stock Position:  0.0742198251555081
Bond Position:  [12.2190036]


portfolio before change:  [19.72614944]
curr_Stock_Price:  101.12686675501692
curr_Factors:  [101.12686676]
mat_Sqrt:  [[0.15]]
grads:  [0.14159301]
Stock Position:  0.14159300825500515
Bond Position:  [5.40729216]


portfolio before change:  [19.74661237]
curr_Stock_Price:  101.26661214782
curr_Factors:  [101.26661215]
mat_Sqrt:  [[0.15]]
grads:  [0.07104334]
Stock Position:  0.07104333780998176
Bond Position:  [12.55229423]


portfolio before change:  [19.74076512]
curr_Stock_Price:  101.16221982340628
curr_Factors:  [101.16221982]
mat_Sqrt:  [[0.15]]
grads:  [-0.07328603]
Stock Position:  -0.07328602530205552
Bond Position:  [27.15454212]


portfolio before change:  [19.75789022]
curr_Stock_Price:  100.974863925021
curr_Factors:  [100.97486393]
mat_Sqrt:  [[0.15]]
grads:  [0.07834867]
Stock Position:  0.0783486653589056
Bond Position:  [11.8466444]


portfolio before change:  [19.73191026]
curr_Stock_Price:  100.62436806160864
curr_Factors:  [100.62436806]
mat_Sqrt:  [[0.15]]
grads:  [-0.04322036]
Stock Position:  -0.04322036076856195
Bond Position:  [24.08093175]


portfolio before change:  [19.67966116]
curr_Stock_Price:  101.90291838358712
curr_Factors:  [101.90291838]
mat_Sqrt:  [[0.15]]
grads:  [-0.1814449]
Stock Position:  -0.1814449043020986
Bond Position:  [38.16942643]


portfolio before change:  [19.85893987]
curr_Stock_Price:  100.94115405109966
curr_Factors:  [100.94115405]
mat_Sqrt:  [[0.15]]
grads:  [0.03092713]
Stock Position:  0.030927128151115927
Bond Position:  [16.73711987]


portfolio before change:  [19.8559903]
curr_Stock_Price:  100.7781306834313
curr_Factors:  [100.77813068]
mat_Sqrt:  [[0.15]]
grads:  [-0.01344261]
Stock Position:  -0.013442608080866213
Bond Position:  [21.21071121]


portfolio before change:  [19.86290351]
curr_Stock_Price:  100.46110094897814
curr_Factors:  [100.46110095]
mat_Sqrt:  [[0.15]]
grads:  [-0.07745892]
Stock Position:  -0.07745891926065286
Bond Position:  [27.64451182]


portfolio before change:  [19.85152718]
curr_Stock_Price:  100.65258446193175
curr_Factors:  [100.65258446]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477976]
Stock Position:  -0.014779758177799428
Bond Position:  [21.33914804]


portfolio before change:  [19.82985093]
curr_Stock_Price:  102.29968926057644
curr_Factors:  [102.29968926]
mat_Sqrt:  [[0.15]]
grads:  [-0.00464269]
Stock Position:  -0.00464268628933151
Bond Position:  [20.3047963]


portfolio before change:  [19.8239509]
curr_Stock_Price:  104.11723438011356
curr_Factors:  [104.11723438]
mat_Sqrt:  [[0.15]]
grads:  [-0.26436788]
Stock Position:  -0.2643678773817408
Bond Position:  [47.34920315]


portfolio before change:  [20.21414319]
curr_Stock_Price:  102.66367929113196
curr_Factors:  [102.66367929]
mat_Sqrt:  [[0.15]]
grads:  [0.03197569]
Stock Position:  0.03197568900373774
Bond Position:  [16.93140131]


portfolio before change:  [20.19307801]
curr_Stock_Price:  101.93869897310704
curr_Factors:  [101.93869897]
mat_Sqrt:  [[0.15]]
grads:  [0.05193557]
Stock Position:  0.05193557374191437
Bond Position:  [14.89883319]


portfolio before change:  [20.24274593]
curr_Stock_Price:  102.85917513374397
curr_Factors:  [102.85917513]
mat_Sqrt:  [[0.15]]
grads:  [-0.03545015]
Stock Position:  -0.03545015022615384
Bond Position:  [23.88911914]


portfolio before change:  [20.29592814]
curr_Stock_Price:  101.44321839027744
curr_Factors:  [101.44321839]
mat_Sqrt:  [[0.15]]
grads:  [-0.04783368]
Stock Position:  -0.04783368491580036
Bond Position:  [25.14833109]


portfolio before change:  [20.21309712]
curr_Stock_Price:  103.24058687687862
curr_Factors:  [103.24058688]
mat_Sqrt:  [[0.15]]
grads:  [-0.02197137]
Stock Position:  -0.0219713660629439
Bond Position:  [22.48143385]


portfolio before change:  [20.24911822]
curr_Stock_Price:  101.7290400400388
curr_Factors:  [101.72904004]
mat_Sqrt:  [[0.15]]
grads:  [-0.10939119]
Stock Position:  -0.10939118819253124
Bond Position:  [31.37737879]


portfolio before change:  [20.21189392]
curr_Stock_Price:  102.10518299199451
curr_Factors:  [102.10518299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04633535]
Stock Position:  -0.0463353462402633
Bond Position:  [24.94297292]


portfolio before change:  [20.18440049]
curr_Stock_Price:  102.76583402871113
curr_Factors:  [102.76583403]
mat_Sqrt:  [[0.15]]
grads:  [0.15820177]
Stock Position:  0.15820176794733867
Bond Position:  [3.92666386]


portfolio before change:  [20.08147693]
curr_Stock_Price:  102.11214710817077
curr_Factors:  [102.11214711]
mat_Sqrt:  [[0.15]]
grads:  [-0.01188058]
Stock Position:  -0.011880581699017009
Bond Position:  [21.29462863]


portfolio before change:  [20.08604828]
curr_Stock_Price:  101.95143441949057
curr_Factors:  [101.95143442]
mat_Sqrt:  [[0.15]]
grads:  [0.04414616]
Stock Position:  0.04414615551439849
Bond Position:  [15.5852844]


portfolio before change:  [20.1307721]
curr_Stock_Price:  102.9203871648598
curr_Factors:  [102.92038716]
mat_Sqrt:  [[0.15]]
grads:  [-0.08557385]
Stock Position:  -0.08557384917031022
Bond Position:  [28.93806579]


portfolio before change:  [20.05526229]
curr_Stock_Price:  103.84505400042583
curr_Factors:  [103.845054]
mat_Sqrt:  [[0.15]]
grads:  [0.0016765]
Stock Position:  0.0016764966960170456
Bond Position:  [19.8811664]


portfolio before change:  [20.05925335]
curr_Stock_Price:  104.74321249813063
curr_Factors:  [104.7432125]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102469]
Stock Position:  -0.041024688883903274
Bond Position:  [24.35631105]


portfolio before change:  [20.10794411]
curr_Stock_Price:  103.63056450449741
curr_Factors:  [103.6305645]
mat_Sqrt:  [[0.15]]
grads:  [-0.0086959]
Stock Position:  -0.008695896684237902
Bond Position:  [21.0091048]


portfolio before change:  [20.11806357]
curr_Stock_Price:  102.76887640582495
curr_Factors:  [102.76887641]
mat_Sqrt:  [[0.15]]
grads:  [0.15570959]
Stock Position:  0.15570958684156577
Bond Position:  [4.11596428]


portfolio before change:  [20.03368607]
curr_Stock_Price:  102.22368179204666
curr_Factors:  [102.22368179]
mat_Sqrt:  [[0.15]]
grads:  [0.00638575]
Stock Position:  0.00638574988219599
Bond Position:  [19.3809112]


portfolio before change:  [20.03547338]
curr_Stock_Price:  102.12417066676404
curr_Factors:  [102.12417067]
mat_Sqrt:  [[0.15]]
grads:  [0.14871489]
Stock Position:  0.14871488996868937
Bond Position:  [4.84808857]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.03547338]
Stock Price:  101.57074108972539
PL:  [18.46473229]
Settle:  Tensor("sub_12:0", shape=(), dtype=float64)
PL:  Tensor("sub_13:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  7
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.06342001e-03]
 [-1.53581067e-03]
 [-7.66741788e-04]
 [ 6.96546283e-02]
 [-1.38250890e-02]
 [ 2.81762669e-02]
 [ 1.09217409e-02]
 [ 1.29042381e-03]
 [ 9.97897538e-03]
 [ 1.31544423e-02]
 [ 2.16624761e-02]
 [-6.72652605e-03]
 [-1.26399144e-02]
 [ 1.21577783e-03]
 [ 3.78681995e-04]
 [-2.64828294e-02]
 [ 4.41219821e-03]
 [ 2.13796596e-03]
 [-6.39636143e-03]
 [-2.53041997e-03]
 [-6.33773129e-04]
 [-3.08456192e-02]
 [ 4.80346318e-03]
 [ 8.95829373e-03]
 [-5.24665055e-03]
 [-2.49493159e-03]
 [-9.87436865e-03]
 [ 6.71705415e-04]
 [ 4.22604403e-02]
 [ 2.59045118e-02]
 [-1.86036739e-02]
 [ 5.82108852e-03]
 [-1.32341127e-02]
 [ 6.43837810e-03]
 [-6.77686488e-03]
 [ 4.20739397e-03]
 [ 2.45016129e-02]
 [ 5.03244766e-03]
 [ 1.88300221e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.57805806]
curr_Stock_Price:  100.81417326950334
curr_Factors:  [100.81417327]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375613]
Stock Position:  -0.013756133430412945
Bond Position:  [15.96487128]


portfolio before change:  [14.56842266]
curr_Stock_Price:  101.65969678562226
curr_Factors:  [101.65969679]
mat_Sqrt:  [[0.15]]
grads:  [-0.01023874]
Stock Position:  -0.010238737773607785
Bond Position:  [15.60928963]


portfolio before change:  [14.5651124]
curr_Stock_Price:  102.1735819315733
curr_Factors:  [102.17358193]
mat_Sqrt:  [[0.15]]
grads:  [-0.00511161]
Stock Position:  -0.005111611922938702
Bond Position:  [15.0873841]


portfolio before change:  [14.56465488]
curr_Stock_Price:  102.63205989552425
curr_Factors:  [102.6320599]
mat_Sqrt:  [[0.15]]
grads:  [0.46436419]
Stock Position:  0.46436418834213755
Bond Position:  [-33.09399831]


portfolio before change:  [14.46035671]
curr_Stock_Price:  102.4163646136549
curr_Factors:  [102.41636461]
mat_Sqrt:  [[0.15]]
grads:  [-0.09216726]
Stock Position:  -0.09216725991750498
Bond Position:  [23.89979241]


portfolio before change:  [14.57158211]
curr_Stock_Price:  101.24200253901739
curr_Factors:  [101.24200254]
mat_Sqrt:  [[0.15]]
grads:  [0.18784178]
Stock Position:  0.18784177948343453
Bond Position:  [-4.44589581]


portfolio before change:  [14.67863369]
curr_Stock_Price:  101.81486421134792
curr_Factors:  [101.81486421]
mat_Sqrt:  [[0.15]]
grads:  [0.07281161]
Stock Position:  0.07281160593365084
Bond Position:  [7.26532992]


portfolio before change:  [14.76383249]
curr_Stock_Price:  102.9725173134319
curr_Factors:  [102.97251731]
mat_Sqrt:  [[0.15]]
grads:  [0.00860283]
Stock Position:  0.008602825405841561
Bond Position:  [13.87797791]


portfolio before change:  [14.76331785]
curr_Stock_Price:  102.71103320484015
curr_Factors:  [102.7110332]
mat_Sqrt:  [[0.15]]
grads:  [0.0665265]
Stock Position:  0.06652650251726969
Bond Position:  [7.93031204]


portfolio before change:  [14.82673865]
curr_Stock_Price:  103.64944801564634
curr_Factors:  [103.64944802]
mat_Sqrt:  [[0.15]]
grads:  [0.08769628]
Stock Position:  0.0876962822524628
Bond Position:  [5.73706741]


portfolio before change:  [14.83319806]
curr_Stock_Price:  103.71492661359693
curr_Factors:  [103.71492661]
mat_Sqrt:  [[0.15]]
grads:  [0.14441651]
Stock Position:  0.14441650753150587
Bond Position:  [-0.14494942]


portfolio before change:  [14.82142385]
curr_Stock_Price:  103.63352256239122
curr_Factors:  [103.63352256]
mat_Sqrt:  [[0.15]]
grads:  [-0.04484351]
Stock Position:  -0.04484350698976428
Bond Position:  [19.46871445]


portfolio before change:  [14.81716234]
curr_Stock_Price:  103.78282515696104
curr_Factors:  [103.78282516]
mat_Sqrt:  [[0.15]]
grads:  [-0.0842661]
Stock Position:  -0.08426609586124871
Bond Position:  [23.56253584]


portfolio before change:  [14.81492062]
curr_Stock_Price:  103.84438278033271
curr_Factors:  [103.84438278]
mat_Sqrt:  [[0.15]]
grads:  [0.00810519]
Stock Position:  0.0081051855350606
Bond Position:  [13.97324263]


portfolio before change:  [14.81430816]
curr_Stock_Price:  103.5533067593468
curr_Factors:  [103.55330676]
mat_Sqrt:  [[0.15]]
grads:  [0.00252455]
Stock Position:  0.0025245466313526233
Bond Position:  [14.55288301]


portfolio before change:  [14.81400251]
curr_Stock_Price:  102.71161941969575
curr_Factors:  [102.71161942]
mat_Sqrt:  [[0.15]]
grads:  [-0.1765522]
Stock Position:  -0.176552195702635
Bond Position:  [32.94796444]


portfolio before change:  [14.83603695]
curr_Stock_Price:  102.6101440930112
curr_Factors:  [102.61014409]
mat_Sqrt:  [[0.15]]
grads:  [0.02941465]
Stock Position:  0.029414654758372894
Bond Position:  [11.81779499]


portfolio before change:  [14.81641235]
curr_Stock_Price:  101.8927493246219
curr_Factors:  [101.89274932]
mat_Sqrt:  [[0.15]]
grads:  [0.01425311]
Stock Position:  0.014253106411792983
Bond Position:  [13.36412415]


portfolio before change:  [14.81703215]
curr_Stock_Price:  101.81902346143502
curr_Factors:  [101.81902346]
mat_Sqrt:  [[0.15]]
grads:  [-0.04264241]
Stock Position:  -0.04264240955082727
Bond Position:  [19.15884065]


portfolio before change:  [14.7995028]
curr_Stock_Price:  102.28626613064948
curr_Factors:  [102.28626613]
mat_Sqrt:  [[0.15]]
grads:  [-0.01686947]
Stock Position:  -0.016869466459412254
Bond Position:  [16.52501754]


portfolio before change:  [14.80279723]
curr_Stock_Price:  102.21343207369077
curr_Factors:  [102.21343207]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422515]
Stock Position:  -0.004225154190551613
Bond Position:  [15.23466474]


portfolio before change:  [14.80345697]
curr_Stock_Price:  102.50802714050498
curr_Factors:  [102.50802714]
mat_Sqrt:  [[0.15]]
grads:  [-0.20563746]
Stock Position:  -0.2056374612806928
Bond Position:  [35.88294743]


portfolio before change:  [14.65806384]
curr_Stock_Price:  103.23687672489815
curr_Factors:  [103.23687672]
mat_Sqrt:  [[0.15]]
grads:  [0.03202309]
Stock Position:  0.03202308784736779
Bond Position:  [11.35210027]


portfolio before change:  [14.65920781]
curr_Stock_Price:  103.22828491167253
curr_Factors:  [103.22828491]
mat_Sqrt:  [[0.15]]
grads:  [0.05972196]
Stock Position:  0.059721958215536004
Bond Position:  [8.49421249]


portfolio before change:  [14.63452747]
curr_Stock_Price:  102.79725118713291
curr_Factors:  [102.79725119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03497767]
Stock Position:  -0.034977670341019076
Bond Position:  [18.23013583]


portfolio before change:  [14.62045649]
curr_Stock_Price:  103.26468899542475
curr_Factors:  [103.264689]
mat_Sqrt:  [[0.15]]
grads:  [-0.01663288]
Stock Position:  -0.016632877289883757
Bond Position:  [16.33804539]


portfolio before change:  [14.5866067]
curr_Stock_Price:  105.42259455713695
curr_Factors:  [105.42259456]
mat_Sqrt:  [[0.15]]
grads:  [-0.06582912]
Stock Position:  -0.06582912433083578
Bond Position:  [21.52648378]


portfolio before change:  [14.63911707]
curr_Stock_Price:  104.665795938674
curr_Factors:  [104.66579594]
mat_Sqrt:  [[0.15]]
grads:  [0.00447804]
Stock Position:  0.00447803610276333
Bond Position:  [14.17041985]


portfolio before change:  [14.64374824]
curr_Stock_Price:  105.30441491705179
curr_Factors:  [105.30441492]
mat_Sqrt:  [[0.15]]
grads:  [0.28173627]
Stock Position:  0.28173626839478877
Bond Position:  [-15.02432466]


portfolio before change:  [14.58790119]
curr_Stock_Price:  105.11285672045689
curr_Factors:  [105.11285672]
mat_Sqrt:  [[0.15]]
grads:  [0.17269675]
Stock Position:  0.17269674565377124
Bond Position:  [-3.56474709]


portfolio before change:  [14.52213166]
curr_Stock_Price:  104.73459882745436
curr_Factors:  [104.73459883]
mat_Sqrt:  [[0.15]]
grads:  [-0.12402449]
Stock Position:  -0.12402449247372457
Bond Position:  [27.51178713]


portfolio before change:  [14.38512527]
curr_Stock_Price:  105.86700084275158
curr_Factors:  [105.86700084]
mat_Sqrt:  [[0.15]]
grads:  [0.03880726]
Stock Position:  0.038807256770272615
Bond Position:  [10.27671738]


portfolio before change:  [14.44329402]
curr_Stock_Price:  107.33281124134666
curr_Factors:  [107.33281124]
mat_Sqrt:  [[0.15]]
grads:  [-0.08822742]
Stock Position:  -0.08822741777477555
Bond Position:  [23.91299079]


portfolio before change:  [14.39868533]
curr_Stock_Price:  107.8723033985005
curr_Factors:  [107.8723034]
mat_Sqrt:  [[0.15]]
grads:  [0.04292252]
Stock Position:  0.0429225206356768
Bond Position:  [9.76853416]


portfolio before change:  [14.33349699]
curr_Stock_Price:  106.32510899924283
curr_Factors:  [106.325109]
mat_Sqrt:  [[0.15]]
grads:  [-0.0451791]
Stock Position:  -0.045179099184590864
Bond Position:  [19.13716963]


portfolio before change:  [14.33210065]
curr_Stock_Price:  106.4089669586116
curr_Factors:  [106.40896696]
mat_Sqrt:  [[0.15]]
grads:  [0.02804929]
Stock Position:  0.028049293102658607
Bond Position:  [11.34740435]


portfolio before change:  [14.33446203]
curr_Stock_Price:  106.44258133550906
curr_Factors:  [106.44258134]
mat_Sqrt:  [[0.15]]
grads:  [0.16334409]
Stock Position:  0.16334408601145764
Bond Position:  [-3.05230413]


portfolio before change:  [14.2899014]
curr_Stock_Price:  106.17211505745102
curr_Factors:  [106.17211506]
mat_Sqrt:  [[0.15]]
grads:  [0.03354965]
Stock Position:  0.03354965105230823
Bond Position:  [10.72786399]


portfolio before change:  [14.32689902]
curr_Stock_Price:  107.23491454735
curr_Factors:  [107.23491455]
mat_Sqrt:  [[0.15]]
grads:  [0.12553348]
Stock Position:  0.12553348087582952
Bond Position:  [0.86532692]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.32689902]
Stock Price:  106.75169470413735
PL:  [7.57520431]
Settle:  Tensor("sub_14:0", shape=(), dtype=float64)
PL:  Tensor("sub_15:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  8
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.52074712e-03]
 [-1.99564269e-03]
 [ 8.53531729e-03]
 [-7.67745193e-03]
 [ 5.27217499e-03]
 [ 1.65565328e-02]
 [ 2.66904825e-02]
 [-3.14695301e-03]
 [ 8.52183442e-03]
 [ 4.27052965e-03]
 [ 6.12323323e-03]
 [ 1.13747336e-02]
 [-1.02476959e-02]
 [ 9.81444603e-03]
 [-4.03104881e-03]
 [-1.67262899e-02]
 [ 4.63957616e-03]
 [ 2.29943949e-03]
 [-1.19399348e-02]
 [-2.21802696e-03]
 [ 3.87627877e-04]
 [ 1.05821439e-02]
 [ 4.76694512e-03]
 [ 5.99496435e-03]
 [-3.46461755e-03]
 [-5.51877260e-03]
 [ 5.87308531e-03]
 [-2.55632475e-02]
 [-3.13934754e-02]
 [ 2.18949514e-02]
 [ 3.11668899e-03]
 [-7.84735391e-03]
 [-1.24881875e-02]
 [-9.79500053e-03]
 [-6.46700428e-03]
 [-5.33109513e-03]
 [ 1.97625713e-02]
 [ 9.49291111e-03]
 [ 2.13439994e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.06589373]
curr_Stock_Price:  100.33022408888046
curr_Factors:  [100.33022409]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013831]
Stock Position:  -0.010138314161313364
Bond Position:  [8.08307306]


portfolio before change:  [7.0723335]
curr_Stock_Price:  99.79469868821269
curr_Factors:  [99.79469869]
mat_Sqrt:  [[0.15]]
grads:  [-0.01330428]
Stock Position:  -0.013304284580855601
Bond Position:  [8.40003057]


portfolio before change:  [7.07528298]
curr_Stock_Price:  99.65193196796626
curr_Factors:  [99.65193197]
mat_Sqrt:  [[0.15]]
grads:  [0.05690212]
Stock Position:  0.05690211527727036
Bond Position:  [1.40487726]


portfolio before change:  [7.06571594]
curr_Stock_Price:  99.48071404042535
curr_Factors:  [99.48071404]
mat_Sqrt:  [[0.15]]
grads:  [-0.05118301]
Stock Position:  -0.05118301285161001
Bond Position:  [12.1574386]


portfolio before change:  [7.03690499]
curr_Stock_Price:  100.07330747268921
curr_Factors:  [100.07330747]
mat_Sqrt:  [[0.15]]
grads:  [0.03514783]
Stock Position:  0.035147833292403334
Bond Position:  [3.51954507]


portfolio before change:  [7.04391585]
curr_Stock_Price:  100.260257549835
curr_Factors:  [100.26025755]
mat_Sqrt:  [[0.15]]
grads:  [0.11037689]
Stock Position:  0.11037688518123492
Bond Position:  [-4.02249908]


portfolio before change:  [6.98611666]
curr_Stock_Price:  99.7411601800007
curr_Factors:  [99.74116018]
mat_Sqrt:  [[0.15]]
grads:  [0.17793655]
Stock Position:  0.1779365502886842
Bond Position:  [-10.7614813]


portfolio before change:  [7.0288488]
curr_Stock_Price:  99.98887438187475
curr_Factors:  [99.98887438]
mat_Sqrt:  [[0.15]]
grads:  [-0.02097969]
Stock Position:  -0.02097968675775257
Bond Position:  [9.12658407]


portfolio before change:  [7.0309145]
curr_Stock_Price:  99.94479357972592
curr_Factors:  [99.94479358]
mat_Sqrt:  [[0.15]]
grads:  [0.05681223]
Stock Position:  0.0568122294562515
Bond Position:  [1.35282795]


portfolio before change:  [7.06369009]
curr_Stock_Price:  100.51872777719677
curr_Factors:  [100.51872778]
mat_Sqrt:  [[0.15]]
grads:  [0.0284702]
Stock Position:  0.028470197644682883
Bond Position:  [4.20190205]


portfolio before change:  [7.03245998]
curr_Stock_Price:  99.40333745681932
curr_Factors:  [99.40333746]
mat_Sqrt:  [[0.15]]
grads:  [0.04082155]
Stock Position:  0.040821554889546495
Bond Position:  [2.97466118]


portfolio before change:  [7.07249192]
curr_Stock_Price:  100.37488497778634
curr_Factors:  [100.37488498]
mat_Sqrt:  [[0.15]]
grads:  [0.07583156]
Stock Position:  0.07583155710034917
Bond Position:  [-0.5390919]


portfolio before change:  [7.10613267]
curr_Stock_Price:  100.81939836412671
curr_Factors:  [100.81939836]
mat_Sqrt:  [[0.15]]
grads:  [-0.06831797]
Stock Position:  -0.0683179728797207
Bond Position:  [13.99390959]


portfolio before change:  [7.19605935]
curr_Stock_Price:  99.52870825910239
curr_Factors:  [99.52870826]
mat_Sqrt:  [[0.15]]
grads:  [0.06542964]
Stock Position:  0.0654296402246697
Bond Position:  [0.68393177]


portfolio before change:  [7.18186962]
curr_Stock_Price:  99.31053149393182
curr_Factors:  [99.31053149]
mat_Sqrt:  [[0.15]]
grads:  [-0.02687366]
Stock Position:  -0.02687365871513605
Bond Position:  [9.85070695]


portfolio before change:  [7.16183313]
curr_Stock_Price:  100.10193490826383
curr_Factors:  [100.10193491]
mat_Sqrt:  [[0.15]]
grads:  [-0.1115086]
Stock Position:  -0.11150859917848227
Bond Position:  [18.32405966]


portfolio before change:  [7.07072267]
curr_Stock_Price:  100.939548428241
curr_Factors:  [100.93954843]
mat_Sqrt:  [[0.15]]
grads:  [0.03093051]
Stock Position:  0.030930507766595308
Bond Position:  [3.94861118]


portfolio before change:  [7.09631548]
curr_Stock_Price:  101.75101937208666
curr_Factors:  [101.75101937]
mat_Sqrt:  [[0.15]]
grads:  [0.0153296]
Stock Position:  0.015329596593665
Bond Position:  [5.5365134]


portfolio before change:  [7.08190942]
curr_Stock_Price:  100.7661160593359
curr_Factors:  [100.76611606]
mat_Sqrt:  [[0.15]]
grads:  [-0.07959957]
Stock Position:  -0.07959956529334195
Bond Position:  [15.10284846]


portfolio before change:  [7.11739918]
curr_Stock_Price:  100.34398075377369
curr_Factors:  [100.34398075]
mat_Sqrt:  [[0.15]]
grads:  [-0.01478685]
Stock Position:  -0.014786846430401082
Bond Position:  [8.60117021]


portfolio before change:  [7.11367285]
curr_Stock_Price:  100.66869816574713
curr_Factors:  [100.66869817]
mat_Sqrt:  [[0.15]]
grads:  [0.00258419]
Stock Position:  0.002584185849958166
Bond Position:  [6.85352622]


portfolio before change:  [7.11240611]
curr_Stock_Price:  99.84697639379125
curr_Factors:  [99.84697639]
mat_Sqrt:  [[0.15]]
grads:  [0.07054763]
Stock Position:  0.07054762603881397
Bond Position:  [0.06843896]


portfolio before change:  [7.08948566]
curr_Stock_Price:  99.52196189451585
curr_Factors:  [99.52196189]
mat_Sqrt:  [[0.15]]
grads:  [0.03177963]
Stock Position:  0.03177963410399738
Bond Position:  [3.92671413]


portfolio before change:  [7.07359849]
curr_Stock_Price:  99.0065989109447
curr_Factors:  [99.00659891]
mat_Sqrt:  [[0.15]]
grads:  [0.03996643]
Stock Position:  0.03996642900186859
Bond Position:  [3.11665828]


portfolio before change:  [7.07099172]
curr_Stock_Price:  98.93162672069508
curr_Factors:  [98.93162672]
mat_Sqrt:  [[0.15]]
grads:  [-0.02309745]
Stock Position:  -0.023097450337302365
Bond Position:  [9.35606006]


portfolio before change:  [7.09222761]
curr_Stock_Price:  98.06285964260793
curr_Factors:  [98.06285964]
mat_Sqrt:  [[0.15]]
grads:  [-0.03679182]
Stock Position:  -0.036791817349194025
Bond Position:  [10.70013843]


portfolio before change:  [7.05775873]
curr_Stock_Price:  99.03607816774866
curr_Factors:  [99.03607817]
mat_Sqrt:  [[0.15]]
grads:  [0.0391539]
Stock Position:  0.03915390205250279
Bond Position:  [3.18010983]


portfolio before change:  [7.08273658]
curr_Stock_Price:  99.66386517460168
curr_Factors:  [99.66386517]
mat_Sqrt:  [[0.15]]
grads:  [-0.17042165]
Stock Position:  -0.1704216498560129
Bond Position:  [24.06761692]


portfolio before change:  [7.40807255]
curr_Stock_Price:  97.7725131785766
curr_Factors:  [97.77251318]
mat_Sqrt:  [[0.15]]
grads:  [-0.20928984]
Stock Position:  -0.20928983611315918
Bond Position:  [27.87086581]


portfolio before change:  [7.61461383]
curr_Stock_Price:  96.80229305702714
curr_Factors:  [96.80229306]
mat_Sqrt:  [[0.15]]
grads:  [0.14596634]
Stock Position:  0.14596634266021377
Bond Position:  [-6.51526284]


portfolio before change:  [7.62658901]
curr_Stock_Price:  96.88991346461758
curr_Factors:  [96.88991346]
mat_Sqrt:  [[0.15]]
grads:  [0.02077793]
Stock Position:  0.020777926628117505
Bond Position:  [5.61341749]


portfolio before change:  [7.6018827]
curr_Stock_Price:  95.66707598273852
curr_Factors:  [95.66707598]
mat_Sqrt:  [[0.15]]
grads:  [-0.05231569]
Stock Position:  -0.05231569273484051
Bond Position:  [12.60677205]


portfolio before change:  [7.56480004]
curr_Stock_Price:  96.40602446187991
curr_Factors:  [96.40602446]
mat_Sqrt:  [[0.15]]
grads:  [-0.08325458]
Stock Position:  -0.08325458341486075
Bond Position:  [15.59104345]


portfolio before change:  [7.56408393]
curr_Stock_Price:  96.4380361485856
curr_Factors:  [96.43803615]
mat_Sqrt:  [[0.15]]
grads:  [-0.0653]
Stock Position:  -0.06530000353319533
Bond Position:  [13.86148803]


portfolio before change:  [7.59649954]
curr_Stock_Price:  95.9681614388898
curr_Factors:  [95.96816144]
mat_Sqrt:  [[0.15]]
grads:  [-0.04311336]
Stock Position:  -0.04311336188158739
Bond Position:  [11.73400961]


portfolio before change:  [7.59198498]
curr_Stock_Price:  96.1068981484327
curr_Factors:  [96.10689815]
mat_Sqrt:  [[0.15]]
grads:  [-0.03554063]
Stock Position:  -0.03554063422911406
Bond Position:  [11.00768509]


portfolio before change:  [7.58948161]
curr_Stock_Price:  96.21605241251112
curr_Factors:  [96.21605241]
mat_Sqrt:  [[0.15]]
grads:  [0.13175048]
Stock Position:  0.13175047541863816
Bond Position:  [-5.08702904]


portfolio before change:  [7.52458666]
curr_Stock_Price:  95.72831958547512
curr_Factors:  [95.72831959]
mat_Sqrt:  [[0.15]]
grads:  [0.06328607]
Stock Position:  0.0632860740597152
Bond Position:  [1.46631714]


portfolio before change:  [7.5740685]
curr_Stock_Price:  96.50729885769452
curr_Factors:  [96.50729886]
mat_Sqrt:  [[0.15]]
grads:  [0.14229333]
Stock Position:  0.14229332908833836
Bond Position:  [-6.15827633]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.5740685]
Stock Price:  95.49519171312518
PL:  [7.5740685]
Settle:  Tensor("sub_16:0", shape=(), dtype=float64)
PL:  Tensor("sub_17:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  9
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.76357689e-03]
 [-6.70875968e-03]
 [-4.50315690e-03]
 [-6.52444460e-03]
 [ 5.07029805e-03]
 [ 1.48464568e-02]
 [ 1.79122673e-02]
 [-3.32689435e-03]
 [ 1.41323829e-02]
 [-3.69536924e-03]
 [ 6.94215464e-03]
 [ 1.09556261e-02]
 [-9.69387183e-03]
 [ 1.02763615e-02]
 [ 4.71421857e-03]
 [-1.16520287e-02]
 [-6.20150243e-03]
 [ 2.42184785e-05]
 [-7.53748768e-03]
 [-2.38169648e-03]
 [ 3.57114092e-04]
 [ 8.64744574e-03]
 [ 4.76714224e-03]
 [ 5.46114320e-03]
 [-1.20699583e-03]
 [-3.36716704e-03]
 [-1.19118796e-03]
 [-1.96339597e-02]
 [-3.62260409e-02]
 [ 2.20472941e-02]
 [ 3.80245740e-03]
 [-5.34434926e-03]
 [-1.25252826e-02]
 [-1.03743783e-02]
 [-7.43585332e-03]
 [-7.52183186e-03]
 [ 2.24787317e-02]
 [ 8.22675295e-03]
 [ 2.28833716e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.35828426]
curr_Stock_Price:  99.65867695902563
curr_Factors:  [99.65867696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01842385]
Stock Position:  -0.01842384590962886
Bond Position:  [-1.52218815]


portfolio before change:  [-3.3633058]
curr_Stock_Price:  99.92090560136289
curr_Factors:  [99.9209056]
mat_Sqrt:  [[0.15]]
grads:  [-0.04472506]
Stock Position:  -0.04472506451877527
Bond Position:  [1.10566315]


portfolio before change:  [-3.33674427]
curr_Stock_Price:  99.33011118524102
curr_Factors:  [99.33011119]
mat_Sqrt:  [[0.15]]
grads:  [-0.03002105]
Stock Position:  -0.030021045970397987
Bond Position:  [-0.35475043]


portfolio before change:  [-3.34516713]
curr_Stock_Price:  99.60919929508864
curr_Factors:  [99.6091993]
mat_Sqrt:  [[0.15]]
grads:  [-0.0434963]
Stock Position:  -0.0434962973540174
Bond Position:  [0.98746422]


portfolio before change:  [-3.36032212]
curr_Stock_Price:  99.96045753545394
curr_Factors:  [99.96045754]
mat_Sqrt:  [[0.15]]
grads:  [0.03380199]
Stock Position:  0.03380198696799102
Bond Position:  [-6.73918421]


portfolio before change:  [-3.35929057]
curr_Stock_Price:  100.01589827935992
curr_Factors:  [100.01589828]
mat_Sqrt:  [[0.15]]
grads:  [0.09897638]
Stock Position:  0.09897637878190399
Bond Position:  [-13.258502]


portfolio before change:  [-3.47028454]
curr_Stock_Price:  98.91122504164872
curr_Factors:  [98.91122504]
mat_Sqrt:  [[0.15]]
grads:  [0.11941512]
Stock Position:  0.119415115137864
Bond Position:  [-15.28177987]


portfolio before change:  [-3.46266604]
curr_Stock_Price:  98.9910210073166
curr_Factors:  [98.99102101]
mat_Sqrt:  [[0.15]]
grads:  [-0.0221793]
Stock Position:  -0.022179295698525038
Bond Position:  [-1.26711491]


portfolio before change:  [-3.4514153]
curr_Stock_Price:  98.4766160905204
curr_Factors:  [98.47661609]
mat_Sqrt:  [[0.15]]
grads:  [0.09421589]
Stock Position:  0.09421588580489067
Bond Position:  [-12.72947691]


portfolio before change:  [-3.37900352]
curr_Stock_Price:  99.26207877934472
curr_Factors:  [99.26207878]
mat_Sqrt:  [[0.15]]
grads:  [-0.02463579]
Stock Position:  -0.024635794908412865
Bond Position:  [-0.9336033]


portfolio before change:  [-3.38090227]
curr_Stock_Price:  99.33441434332899
curr_Factors:  [99.33441434]
mat_Sqrt:  [[0.15]]
grads:  [0.04628103]
Stock Position:  0.04628103095472086
Bond Position:  [-7.97820138]


portfolio before change:  [-3.36303881]
curr_Stock_Price:  99.74194196496494
curr_Factors:  [99.74194196]
mat_Sqrt:  [[0.15]]
grads:  [0.07303751]
Stock Position:  0.07303750745457581
Bond Position:  [-10.64794164]


portfolio before change:  [-3.33616677]
curr_Stock_Price:  100.1280875546462
curr_Factors:  [100.12808755]
mat_Sqrt:  [[0.15]]
grads:  [-0.06462581]
Stock Position:  -0.0646258121764421
Bond Position:  [3.13469221]


portfolio before change:  [-3.26493423]
curr_Stock_Price:  99.03192056484832
curr_Factors:  [99.03192056]
mat_Sqrt:  [[0.15]]
grads:  [0.06850908]
Stock Position:  0.06850907647285266
Bond Position:  [-10.04951965]


portfolio before change:  [-3.37241576]
curr_Stock_Price:  97.48139230088415
curr_Factors:  [97.4813923]
mat_Sqrt:  [[0.15]]
grads:  [0.03142812]
Stock Position:  0.03142812380369224
Bond Position:  [-6.43607303]


portfolio before change:  [-3.38776048]
curr_Stock_Price:  97.01874418327054
curr_Factors:  [97.01874418]
mat_Sqrt:  [[0.15]]
grads:  [-0.07768019]
Stock Position:  -0.07768019152302676
Bond Position:  [4.14867415]


portfolio before change:  [-3.42400052]
curr_Stock_Price:  97.49194915088674
curr_Factors:  [97.49194915]
mat_Sqrt:  [[0.15]]
grads:  [-0.04134335]
Stock Position:  -0.041343349508206416
Bond Position:  [0.60664321]


portfolio before change:  [-3.38950545]
curr_Stock_Price:  96.65942745574831
curr_Factors:  [96.65942746]
mat_Sqrt:  [[0.15]]
grads:  [0.00016146]
Stock Position:  0.00016145652300320854
Bond Position:  [-3.40511174]


portfolio before change:  [-3.38972559]
curr_Stock_Price:  97.93235398678692
curr_Factors:  [97.93235399]
mat_Sqrt:  [[0.15]]
grads:  [-0.05024992]
Stock Position:  -0.05024991787665435
Bond Position:  [1.53136716]


portfolio before change:  [-3.39388146]
curr_Stock_Price:  98.01886764451874
curr_Factors:  [98.01886764]
mat_Sqrt:  [[0.15]]
grads:  [-0.01587798]
Stock Position:  -0.015877976553442533
Bond Position:  [-1.83754018]


portfolio before change:  [-3.39389758]
curr_Stock_Price:  98.00541573049394
curr_Factors:  [98.00541573]
mat_Sqrt:  [[0.15]]
grads:  [0.00238076]
Stock Position:  0.0023807606121182276
Bond Position:  [-3.62722501]


portfolio before change:  [-3.39304966]
curr_Stock_Price:  98.55202597496071
curr_Factors:  [98.55202597]
mat_Sqrt:  [[0.15]]
grads:  [0.05764964]
Stock Position:  0.057649638279144114
Bond Position:  [-9.07453831]


portfolio before change:  [-3.40388777]
curr_Stock_Price:  98.3837036163387
curr_Factors:  [98.38370362]
mat_Sqrt:  [[0.15]]
grads:  [0.03178095]
Stock Position:  0.03178094828613139
Bond Position:  [-6.53061517]


portfolio before change:  [-3.4405562]
curr_Stock_Price:  97.25560481247607
curr_Factors:  [97.25560481]
mat_Sqrt:  [[0.15]]
grads:  [0.03640762]
Stock Position:  0.03640762131051786
Bond Position:  [-6.98140143]


portfolio before change:  [-3.44195271]
curr_Stock_Price:  97.24121829296985
curr_Factors:  [97.24121829]
mat_Sqrt:  [[0.15]]
grads:  [-0.00804664]
Stock Position:  -0.00804663886678712
Bond Position:  [-2.65948774]


portfolio before change:  [-3.43395833]
curr_Stock_Price:  96.20639716962293
curr_Factors:  [96.20639717]
mat_Sqrt:  [[0.15]]
grads:  [-0.02244778]
Stock Position:  -0.02244778023594706
Bond Position:  [-1.27433827]


portfolio before change:  [-3.43360288]
curr_Stock_Price:  96.18346586421025
curr_Factors:  [96.18346586]
mat_Sqrt:  [[0.15]]
grads:  [-0.00794125]
Stock Position:  -0.007941253083042275
Bond Position:  [-2.66978563]


portfolio before change:  [-3.44161528]
curr_Stock_Price:  97.15039793042146
curr_Factors:  [97.15039793]
mat_Sqrt:  [[0.15]]
grads:  [-0.13089306]
Stock Position:  -0.13089306449399274
Bond Position:  [9.27469803]


portfolio before change:  [-3.60124266]
curr_Stock_Price:  98.37878078976459
curr_Factors:  [98.37878079]
mat_Sqrt:  [[0.15]]
grads:  [-0.24150694]
Stock Position:  -0.2415069395670964
Bond Position:  [20.1579156]


portfolio before change:  [-3.42929384]
curr_Stock_Price:  97.67723191023045
curr_Factors:  [97.67723191]
mat_Sqrt:  [[0.15]]
grads:  [0.14698196]
Stock Position:  0.1469819609542895
Bond Position:  [-17.78608493]


portfolio before change:  [-3.39231274]
curr_Stock_Price:  97.94396194096684
curr_Factors:  [97.94396194]
mat_Sqrt:  [[0.15]]
grads:  [0.02534972]
Stock Position:  0.025349716016158597
Bond Position:  [-5.87516436]


portfolio before change:  [-3.41525093]
curr_Stock_Price:  97.06806459645321
curr_Factors:  [97.0680646]
mat_Sqrt:  [[0.15]]
grads:  [-0.035629]
Stock Position:  -0.03562899509410661
Bond Position:  [0.04318667]


portfolio before change:  [-3.40746148]
curr_Stock_Price:  96.8495893373825
curr_Factors:  [96.84958934]
mat_Sqrt:  [[0.15]]
grads:  [-0.08350188]
Stock Position:  -0.08350188379495015
Bond Position:  [4.67966168]


portfolio before change:  [-3.45614578]
curr_Stock_Price:  97.4396274407867
curr_Factors:  [97.43962744]
mat_Sqrt:  [[0.15]]
grads:  [-0.06916252]
Stock Position:  -0.06916252209379375
Bond Position:  [3.28302461]


portfolio before change:  [-3.45112479]
curr_Stock_Price:  97.372964433284
curr_Factors:  [97.37296443]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957236]
Stock Position:  -0.049572355481962246
Bond Position:  [1.37588242]


portfolio before change:  [-3.49097382]
curr_Stock_Price:  98.1802898708275
curr_Factors:  [98.18028987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014555]
Stock Position:  -0.050145545734936035
Bond Position:  [1.4323304]


portfolio before change:  [-3.54828263]
curr_Stock_Price:  99.32671010807483
curr_Factors:  [99.32671011]
mat_Sqrt:  [[0.15]]
grads:  [0.14985821]
Stock Position:  0.14985821142831737
Bond Position:  [-18.43320576]


portfolio before change:  [-3.6331108]
curr_Stock_Price:  98.77603044400641
curr_Factors:  [98.77603044]
mat_Sqrt:  [[0.15]]
grads:  [0.05484502]
Stock Position:  0.05484501963606707
Bond Position:  [-9.05048413]


portfolio before change:  [-3.66715038]
curr_Stock_Price:  98.17600883553138
curr_Factors:  [98.17600884]
mat_Sqrt:  [[0.15]]
grads:  [0.15255581]
Stock Position:  0.15255581033983373
Bond Position:  [-18.64447096]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.66715038]
Stock Price:  98.21418876703785
PL:  [-3.66715038]
Settle:  Tensor("sub_18:0", shape=(), dtype=float64)
PL:  Tensor("sub_19:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  10
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.41595624e-03]
 [-3.54913837e-03]
 [ 2.27847671e-02]
 [-1.59459044e-02]
 [ 1.37866910e-02]
 [ 1.78266973e-02]
 [ 9.69835075e-03]
 [-4.27800138e-03]
 [ 1.50257319e-02]
 [-2.91802356e-03]
 [ 6.89951759e-03]
 [ 1.01254669e-02]
 [-2.01426110e-03]
 [ 1.04567703e-02]
 [-1.28750786e-03]
 [-1.26862541e-02]
 [-6.29077430e-03]
 [-7.19894342e-04]
 [-7.64829898e-03]
 [-2.60290725e-03]
 [ 8.84180857e-04]
 [ 1.37741594e-02]
 [ 4.75729336e-03]
 [ 5.41468188e-03]
 [ 2.51769221e-03]
 [-1.18015657e-03]
 [ 9.66709407e-03]
 [-1.79155596e-02]
 [-2.83289662e-02]
 [ 2.19274439e-02]
 [ 3.39366369e-03]
 [-3.94040052e-03]
 [-1.25335174e-02]
 [-1.03339247e-02]
 [-6.70795040e-03]
 [-7.29135371e-03]
 [ 2.06132923e-02]
 [ 8.15531662e-03]
 [ 2.28335228e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.42847686]
curr_Stock_Price:  99.00993430037802
curr_Factors:  [99.0099343]
mat_Sqrt:  [[0.15]]
grads:  [-0.03610637]
Stock Position:  -0.03610637494576657
Bond Position:  [-9.85358705]


portfolio before change:  [-13.45954491]
curr_Stock_Price:  99.83627785649571
curr_Factors:  [99.83627786]
mat_Sqrt:  [[0.15]]
grads:  [-0.02366092]
Stock Position:  -0.023660922464911537
Bond Position:  [-11.09732648]


portfolio before change:  [-13.46908431]
curr_Stock_Price:  100.18081856856637
curr_Factors:  [100.18081857]
mat_Sqrt:  [[0.15]]
grads:  [0.15189845]
Stock Position:  0.1518984470166782
Bond Position:  [-28.68639507]


portfolio before change:  [-13.66545382]
curr_Stock_Price:  98.91165823767615
curr_Factors:  [98.91165824]
mat_Sqrt:  [[0.15]]
grads:  [-0.10630603]
Stock Position:  -0.10630602929499393
Bond Position:  [-3.15054818]


portfolio before change:  [-13.68030325]
curr_Stock_Price:  99.04763916285545
curr_Factors:  [99.04763916]
mat_Sqrt:  [[0.15]]
grads:  [0.09191127]
Stock Position:  0.09191127343503601
Bond Position:  [-22.7838979]


portfolio before change:  [-13.65657948]
curr_Stock_Price:  99.33674342468605
curr_Factors:  [99.33674342]
mat_Sqrt:  [[0.15]]
grads:  [0.11884465]
Stock Position:  0.11884464866155685
Bond Position:  [-25.46221985]


portfolio before change:  [-13.78296908]
curr_Stock_Price:  98.30004026350785
curr_Factors:  [98.30004026]
mat_Sqrt:  [[0.15]]
grads:  [0.06465567]
Stock Position:  0.06465567166427183
Bond Position:  [-20.1386242]


portfolio before change:  [-13.78320747]
curr_Stock_Price:  98.33528987154445
curr_Factors:  [98.33528987]
mat_Sqrt:  [[0.15]]
grads:  [-0.02852001]
Stock Position:  -0.028520009212181993
Bond Position:  [-10.9786841]


portfolio before change:  [-13.79313517]
curr_Stock_Price:  98.63526438507806
curr_Factors:  [98.63526439]
mat_Sqrt:  [[0.15]]
grads:  [0.10017155]
Stock Position:  0.10017154625319306
Bond Position:  [-23.67358212]


portfolio before change:  [-13.75041844]
curr_Stock_Price:  99.09124332644167
curr_Factors:  [99.09124333]
mat_Sqrt:  [[0.15]]
grads:  [-0.01945349]
Stock Position:  -0.019453490420410172
Bond Position:  [-11.82274789]


portfolio before change:  [-13.77197546]
curr_Stock_Price:  100.12340165150916
curr_Factors:  [100.12340165]
mat_Sqrt:  [[0.15]]
grads:  [0.04599678]
Stock Position:  0.04599678392594402
Bond Position:  [-18.37732993]


portfolio before change:  [-13.79908283]
curr_Stock_Price:  99.58401476733088
curr_Factors:  [99.58401477]
mat_Sqrt:  [[0.15]]
grads:  [0.06750311]
Stock Position:  0.06750311281892915
Bond Position:  [-20.52131381]


portfolio before change:  [-13.84228143]
curr_Stock_Price:  98.98206799117906
curr_Factors:  [98.98206799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01342841]
Stock Position:  -0.01342840733292527
Bond Position:  [-12.51310991]


portfolio before change:  [-13.8329101]
curr_Stock_Price:  98.1677069006646
curr_Factors:  [98.1677069]
mat_Sqrt:  [[0.15]]
grads:  [0.0697118]
Stock Position:  0.06971180232287352
Bond Position:  [-20.67635788]


portfolio before change:  [-13.81496469]
curr_Stock_Price:  98.46220672257418
curr_Factors:  [98.46220672]
mat_Sqrt:  [[0.15]]
grads:  [-0.00858339]
Stock Position:  -0.008583385741839887
Bond Position:  [-12.96982559]


portfolio before change:  [-13.80798185]
curr_Stock_Price:  97.4597851615568
curr_Factors:  [97.45978516]
mat_Sqrt:  [[0.15]]
grads:  [-0.08457503]
Stock Position:  -0.08457502707627379
Bond Position:  [-5.56531788]


portfolio before change:  [-13.8088122]
curr_Stock_Price:  97.46137714165407
curr_Factors:  [97.46137714]
mat_Sqrt:  [[0.15]]
grads:  [-0.0419385]
Stock Position:  -0.04193849532642066
Bond Position:  [-9.72142869]


portfolio before change:  [-13.81401081]
curr_Stock_Price:  97.55635803383913
curr_Factors:  [97.55635803]
mat_Sqrt:  [[0.15]]
grads:  [-0.0047993]
Stock Position:  -0.004799295614477626
Bond Position:  [-13.34580901]


portfolio before change:  [-13.80981639]
curr_Stock_Price:  96.33477300335593
curr_Factors:  [96.334773]
mat_Sqrt:  [[0.15]]
grads:  [-0.05098866]
Stock Position:  -0.05098865989761956
Bond Position:  [-8.89783542]


portfolio before change:  [-13.81815473]
curr_Stock_Price:  96.47649147325433
curr_Factors:  [96.47649147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01735272]
Stock Position:  -0.017352715023537874
Bond Position:  [-12.14402566]


portfolio before change:  [-13.80304651]
curr_Stock_Price:  95.51835211481698
curr_Factors:  [95.51835211]
mat_Sqrt:  [[0.15]]
grads:  [0.00589454]
Stock Position:  0.0058945390493866205
Bond Position:  [-14.36608316]


portfolio before change:  [-13.80113841]
curr_Stock_Price:  96.1467243986864
curr_Factors:  [96.1467244]
mat_Sqrt:  [[0.15]]
grads:  [0.09182773]
Stock Position:  0.09182772961402205
Bond Position:  [-22.63007382]


portfolio before change:  [-13.78399571]
curr_Stock_Price:  96.36421466159267
curr_Factors:  [96.36421466]
mat_Sqrt:  [[0.15]]
grads:  [0.03171529]
Stock Position:  0.031715289041203354
Bond Position:  [-16.84021463]


portfolio before change:  [-13.7901027]
curr_Stock_Price:  96.2380348172758
curr_Factors:  [96.23803482]
mat_Sqrt:  [[0.15]]
grads:  [0.03609788]
Stock Position:  0.03609787917942012
Bond Position:  [-17.26409165]


portfolio before change:  [-13.83016824]
curr_Stock_Price:  95.18790681920743
curr_Factors:  [95.18790682]
mat_Sqrt:  [[0.15]]
grads:  [0.01678461]
Stock Position:  0.016784614750639956
Bond Position:  [-15.42786059]


portfolio before change:  [-13.84545215]
curr_Stock_Price:  94.39221965480812
curr_Factors:  [94.39221965]
mat_Sqrt:  [[0.15]]
grads:  [-0.00786771]
Stock Position:  -0.007867710478181208
Bond Position:  [-13.10280149]


portfolio before change:  [-13.84585289]
curr_Stock_Price:  94.23496831852854
curr_Factors:  [94.23496832]
mat_Sqrt:  [[0.15]]
grads:  [0.06444729]
Stock Position:  0.06444729379488377
Bond Position:  [-19.91904158]


portfolio before change:  [-13.75821908]
curr_Stock_Price:  95.6333800275579
curr_Factors:  [95.63338003]
mat_Sqrt:  [[0.15]]
grads:  [-0.11943706]
Stock Position:  -0.11943706369544019
Bond Position:  [-2.33604897]


portfolio before change:  [-13.79022644]
curr_Stock_Price:  95.89892024655856
curr_Factors:  [95.89892025]
mat_Sqrt:  [[0.15]]
grads:  [-0.18885977]
Stock Position:  -0.18885977450803973
Bond Position:  [4.32122201]


portfolio before change:  [-14.02152043]
curr_Stock_Price:  97.1264668352307
curr_Factors:  [97.12646684]
mat_Sqrt:  [[0.15]]
grads:  [0.14618296]
Stock Position:  0.14618295966432188
Bond Position:  [-28.21975481]


portfolio before change:  [-14.01959163]
curr_Stock_Price:  97.16379326384315
curr_Factors:  [97.16379326]
mat_Sqrt:  [[0.15]]
grads:  [0.02262442]
Stock Position:  0.02262442459299471
Bond Position:  [-16.21786655]


portfolio before change:  [-14.0089508]
curr_Stock_Price:  97.72372751026916
curr_Factors:  [97.72372751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02626934]
Stock Position:  -0.026269336811274767
Bond Position:  [-11.44181329]


portfolio before change:  [-13.99896503]
curr_Stock_Price:  97.28914907538959
curr_Factors:  [97.28914908]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355678]
Stock Position:  -0.0835567827704299
Bond Position:  [-5.86979674]


portfolio before change:  [-13.99483117]
curr_Stock_Price:  97.23089372991899
curr_Factors:  [97.23089373]
mat_Sqrt:  [[0.15]]
grads:  [-0.06889283]
Stock Position:  -0.06889283159000967
Bond Position:  [-7.29631958]


portfolio before change:  [-13.94024076]
curr_Stock_Price:  96.42525829749763
curr_Factors:  [96.4252583]
mat_Sqrt:  [[0.15]]
grads:  [-0.04471967]
Stock Position:  -0.04471966935462149
Bond Position:  [-9.62813509]


portfolio before change:  [-14.00193712]
curr_Stock_Price:  97.77796886155235
curr_Factors:  [97.77796886]
mat_Sqrt:  [[0.15]]
grads:  [-0.04860902]
Stock Position:  -0.04860902471205705
Bond Position:  [-9.24904542]


portfolio before change:  [-13.97475114]
curr_Stock_Price:  97.19490461515842
curr_Factors:  [97.19490462]
mat_Sqrt:  [[0.15]]
grads:  [0.13742195]
Stock Position:  0.1374219489448923
Bond Position:  [-27.33146436]


portfolio before change:  [-13.80661469]
curr_Stock_Price:  98.44327212773129
curr_Factors:  [98.44327213]
mat_Sqrt:  [[0.15]]
grads:  [0.05436878]
Stock Position:  0.05436877746321056
Bond Position:  [-19.15885505]


portfolio before change:  [-13.82810121]
curr_Stock_Price:  98.09212364944
curr_Factors:  [98.09212365]
mat_Sqrt:  [[0.15]]
grads:  [0.15222349]
Stock Position:  0.15222348535888577
Bond Position:  [-28.76002616]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.82810121]
Stock Price:  98.69289878390761
PL:  [-13.82810121]
Settle:  Tensor("sub_20:0", shape=(), dtype=float64)
PL:  Tensor("sub_21:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  11
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44565610e-03]
 [-8.07805368e-03]
 [-4.43978666e-03]
 [-6.32407552e-03]
 [ 8.80876529e-03]
 [ 2.61793735e-02]
 [ 2.00073858e-02]
 [-8.47517551e-04]
 [ 6.68534568e-03]
 [ 1.19911437e-02]
 [ 1.56937478e-02]
 [ 1.10126324e-02]
 [-8.50114121e-03]
 [ 1.17793921e-02]
 [-6.62596923e-03]
 [-1.17442507e-02]
 [-2.57746132e-04]
 [-2.22213883e-03]
 [-9.38345518e-03]
 [-2.41137603e-03]
 [ 3.20366132e-04]
 [ 1.06048891e-02]
 [ 4.76699387e-03]
 [ 5.75033249e-03]
 [-3.34134290e-03]
 [-7.59883627e-03]
 [ 6.05867633e-03]
 [-2.09801458e-02]
 [-1.57347010e-02]
 [ 2.16952036e-02]
 [ 6.11042513e-03]
 [ 6.62874071e-03]
 [-1.28547398e-02]
 [-1.79771877e-03]
 [-5.75439579e-03]
 [-1.31466688e-03]
 [ 2.34282176e-02]
 [ 4.35569558e-04]
 [ 2.04651600e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.0232197]
curr_Stock_Price:  100.13420872810168
curr_Factors:  [100.13420873]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963771]
Stock Position:  -0.009637707338584761
Bond Position:  [4.9882839]


portfolio before change:  [4.02552512]
curr_Stock_Price:  99.9597018507321
curr_Factors:  [99.95970185]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385369]
Stock Position:  -0.05385369119580695
Bond Position:  [9.40872404]


portfolio before change:  [4.06052283]
curr_Stock_Price:  99.33167531452709
curr_Factors:  [99.33167531]
mat_Sqrt:  [[0.15]]
grads:  [-0.02959858]
Stock Position:  -0.029598577722718206
Bond Position:  [7.00059915]


portfolio before change:  [4.04962867]
curr_Stock_Price:  99.72930584327004
curr_Factors:  [99.72930584]
mat_Sqrt:  [[0.15]]
grads:  [-0.0421605]
Stock Position:  -0.04216050347416861
Bond Position:  [8.25426641]


portfolio before change:  [4.02351259]
curr_Stock_Price:  100.37322421860257
curr_Factors:  [100.37322422]
mat_Sqrt:  [[0.15]]
grads:  [0.0587251]
Stock Position:  0.05872510192969906
Bond Position:  [-1.87091523]


portfolio before change:  [4.05883362]
curr_Stock_Price:  100.97867067045978
curr_Factors:  [100.97867067]
mat_Sqrt:  [[0.15]]
grads:  [0.17452916]
Stock Position:  0.17452915650078818
Bond Position:  [-13.5648886]


portfolio before change:  [4.09294775]
curr_Stock_Price:  101.18385041564137
curr_Factors:  [101.18385042]
mat_Sqrt:  [[0.15]]
grads:  [0.13338257]
Stock Position:  0.13338257200854906
Bond Position:  [-9.40321447]


portfolio before change:  [4.13209469]
curr_Stock_Price:  101.48615691072278
curr_Factors:  [101.48615691]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565012]
Stock Position:  -0.005650117006514767
Bond Position:  [4.70550335]


portfolio before change:  [4.13016154]
curr_Stock_Price:  101.93240928167783
curr_Factors:  [101.93240928]
mat_Sqrt:  [[0.15]]
grads:  [0.04456897]
Stock Position:  0.04456897118276816
Bond Position:  [-0.41286108]


portfolio before change:  [4.14966266]
curr_Stock_Price:  102.37111659261673
curr_Factors:  [102.37111659]
mat_Sqrt:  [[0.15]]
grads:  [0.07994096]
Stock Position:  0.0799409579051085
Bond Position:  [-4.03398246]


portfolio before change:  [4.01468036]
curr_Stock_Price:  100.68889985241819
curr_Factors:  [100.68889985]
mat_Sqrt:  [[0.15]]
grads:  [0.10462499]
Stock Position:  0.10462498544109188
Bond Position:  [-6.51989432]


portfolio before change:  [4.00108177]
curr_Stock_Price:  100.56671531215075
curr_Factors:  [100.56671531]
mat_Sqrt:  [[0.15]]
grads:  [0.07341755]
Stock Position:  0.07341754956545726
Bond Position:  [-3.38228004]


portfolio before change:  [3.94859998]
curr_Stock_Price:  99.85763452116218
curr_Factors:  [99.85763452]
mat_Sqrt:  [[0.15]]
grads:  [-0.05667427]
Stock Position:  -0.056674274700243624
Bond Position:  [9.60795899]


portfolio before change:  [3.88895545]
curr_Stock_Price:  100.93123635424558
curr_Factors:  [100.93123635]
mat_Sqrt:  [[0.15]]
grads:  [0.07852928]
Stock Position:  0.07852928060656547
Bond Position:  [-4.03710193]


portfolio before change:  [3.92443187]
curr_Stock_Price:  101.38942324137268
curr_Factors:  [101.38942324]
mat_Sqrt:  [[0.15]]
grads:  [-0.04417313]
Stock Position:  -0.04417312821909768
Bond Position:  [8.40311986]


portfolio before change:  [4.00416958]
curr_Stock_Price:  99.60808541941715
curr_Factors:  [99.60808542]
mat_Sqrt:  [[0.15]]
grads:  [-0.078295]
Stock Position:  -0.0782950046385221
Bond Position:  [11.80298509]


portfolio before change:  [4.00860721]
curr_Stock_Price:  99.57025214640922
curr_Factors:  [99.57025215]
mat_Sqrt:  [[0.15]]
grads:  [-0.00171831]
Stock Position:  -0.001718307548796978
Bond Position:  [4.17969952]


portfolio before change:  [4.01121895]
curr_Stock_Price:  98.35437685644679
curr_Factors:  [98.35437686]
mat_Sqrt:  [[0.15]]
grads:  [-0.01481426]
Stock Position:  -0.014814258834957093
Bond Position:  [5.46826615]


portfolio before change:  [3.99577654]
curr_Stock_Price:  99.44292176178753
curr_Factors:  [99.44292176]
mat_Sqrt:  [[0.15]]
grads:  [-0.06255637]
Stock Position:  -0.06255636788868948
Bond Position:  [10.21656454]


portfolio before change:  [4.05214256]
curr_Stock_Price:  98.56229403663292
curr_Factors:  [98.56229404]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607584]
Stock Position:  -0.016075840205028006
Bond Position:  [5.63661425]


portfolio before change:  [4.0531963]
curr_Stock_Price:  98.54057714787352
curr_Factors:  [98.54057715]
mat_Sqrt:  [[0.15]]
grads:  [0.00213577]
Stock Position:  0.002135774210586193
Bond Position:  [3.84273588]


portfolio before change:  [4.05150117]
curr_Stock_Price:  97.52197618326898
curr_Factors:  [97.52197618]
mat_Sqrt:  [[0.15]]
grads:  [0.07069926]
Stock Position:  0.07069926075110201
Bond Position:  [-2.84323045]


portfolio before change:  [4.12919843]
curr_Stock_Price:  98.62598606293268
curr_Factors:  [98.62598606]
mat_Sqrt:  [[0.15]]
grads:  [0.03177996]
Stock Position:  0.031779959110630494
Bond Position:  [0.99486862]


portfolio before change:  [4.11601804]
curr_Stock_Price:  98.2073338814859
curr_Factors:  [98.20733388]
mat_Sqrt:  [[0.15]]
grads:  [0.03833555]
Stock Position:  0.03833554991238424
Bond Position:  [0.35118589]


portfolio before change:  [4.16206203]
curr_Stock_Price:  99.40726681744299
curr_Factors:  [99.40726682]
mat_Sqrt:  [[0.15]]
grads:  [-0.02227562]
Stock Position:  -0.022275619358741564
Bond Position:  [6.37642047]


portfolio before change:  [4.16310192]
curr_Stock_Price:  99.39636761523285
curr_Factors:  [99.39636762]
mat_Sqrt:  [[0.15]]
grads:  [-0.05065891]
Stock Position:  -0.05065890845536668
Bond Position:  [9.19841341]


portfolio before change:  [4.18182569]
curr_Stock_Price:  99.04946130938343
curr_Factors:  [99.04946131]
mat_Sqrt:  [[0.15]]
grads:  [0.04039118]
Stock Position:  0.040391175501941275
Bond Position:  [0.18110152]


portfolio before change:  [4.22839284]
curr_Stock_Price:  100.2018048352802
curr_Factors:  [100.20180484]
mat_Sqrt:  [[0.15]]
grads:  [-0.13986764]
Stock Position:  -0.13986763880653416
Bond Position:  [18.24338269]


portfolio before change:  [4.18422915]
curr_Stock_Price:  100.53386343014951
curr_Factors:  [100.53386343]
mat_Sqrt:  [[0.15]]
grads:  [-0.10489801]
Stock Position:  -0.10489800680860001
Bond Position:  [14.73003104]


portfolio before change:  [4.17741953]
curr_Stock_Price:  100.61633389746741
curr_Factors:  [100.6163339]
mat_Sqrt:  [[0.15]]
grads:  [0.14463469]
Stock Position:  0.14463469035109236
Bond Position:  [-10.37519276]


portfolio before change:  [4.25969898]
curr_Stock_Price:  101.19417887844193
curr_Factors:  [101.19417888]
mat_Sqrt:  [[0.15]]
grads:  [0.04073617]
Stock Position:  0.04073616752789005
Bond Position:  [0.13743596]


portfolio before change:  [4.28814116]
curr_Stock_Price:  101.89196165526569
curr_Factors:  [101.89196166]
mat_Sqrt:  [[0.15]]
grads:  [0.0441916]
Stock Position:  0.04419160474633753
Bond Position:  [-0.21462814]


portfolio before change:  [4.33790669]
curr_Stock_Price:  103.0186997383146
curr_Factors:  [103.01869974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08569827]
Stock Position:  -0.08569826539863909
Bond Position:  [13.16643057]


portfolio before change:  [4.31586372]
curr_Stock_Price:  103.29512171158594
curr_Factors:  [103.29512171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01198479]
Stock Position:  -0.011984791778644645
Bond Position:  [5.55383424]


portfolio before change:  [4.31366818]
curr_Stock_Price:  103.53624495812798
curr_Factors:  [103.53624496]
mat_Sqrt:  [[0.15]]
grads:  [-0.03836264]
Stock Position:  -0.03836263859757966
Bond Position:  [8.28559173]


portfolio before change:  [4.31128315]
curr_Stock_Price:  103.62541484576879
curr_Factors:  [103.62541485]
mat_Sqrt:  [[0.15]]
grads:  [-0.00876445]
Stock Position:  -0.008764445875782564
Bond Position:  [5.21950249]


portfolio before change:  [4.31626753]
curr_Stock_Price:  103.13115589051303
curr_Factors:  [103.13115589]
mat_Sqrt:  [[0.15]]
grads:  [0.15618812]
Stock Position:  0.1561881170641677
Bond Position:  [-11.79159351]


portfolio before change:  [4.48268671]
curr_Stock_Price:  104.20609818859731
curr_Factors:  [104.20609819]
mat_Sqrt:  [[0.15]]
grads:  [0.0029038]
Stock Position:  0.0029037970550025065
Bond Position:  [4.18009335]


portfolio before change:  [4.48398946]
curr_Stock_Price:  104.47478503083481
curr_Factors:  [104.47478503]
mat_Sqrt:  [[0.15]]
grads:  [0.1364344]
Stock Position:  0.1364344000382125
Bond Position:  [-9.76996515]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.48398946]
Stock Price:  105.89895610520703
PL:  [-1.41496664]
Settle:  Tensor("sub_22:0", shape=(), dtype=float64)
PL:  Tensor("sub_23:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  12
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.47561058e-03]
 [-1.43560535e-02]
 [ 1.13542178e-03]
 [ 1.84557845e-02]
 [ 2.06606173e-02]
 [ 1.77488113e-02]
 [ 2.65526501e-02]
 [-3.02190460e-03]
 [ 4.64364046e-03]
 [-4.05024259e-03]
 [ 9.75742739e-03]
 [ 1.16080874e-02]
 [-5.43714191e-03]
 [ 1.01379250e-02]
 [ 7.82323426e-04]
 [-1.09795245e-02]
 [-2.82590922e-03]
 [-3.16826032e-03]
 [-8.52051954e-03]
 [-2.38224294e-03]
 [ 3.15763285e-04]
 [ 1.06449950e-02]
 [ 4.77189467e-03]
 [ 5.73702540e-03]
 [-8.85244938e-04]
 [-2.87285060e-03]
 [ 3.67289838e-03]
 [-1.88695279e-02]
 [-2.48727373e-02]
 [ 2.15209299e-02]
 [ 2.61820922e-03]
 [-1.14356295e-02]
 [-1.22017145e-02]
 [-3.08786337e-03]
 [-6.60364840e-03]
 [-2.20006119e-03]
 [ 1.82436203e-02]
 [ 1.14245080e-02]
 [ 1.79945507e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.04743776]
curr_Stock_Price:  100.07134683460225
curr_Factors:  [100.07134683]
mat_Sqrt:  [[0.15]]
grads:  [-0.0098374]
Stock Position:  -0.009837403850938646
Bond Position:  [4.03188001]


portfolio before change:  [3.04724815]
curr_Stock_Price:  100.14185566285703
curr_Factors:  [100.14185566]
mat_Sqrt:  [[0.15]]
grads:  [-0.09570702]
Stock Position:  -0.09570702353973912
Bond Position:  [12.63152708]


portfolio before change:  [3.11319694]
curr_Stock_Price:  99.46928481676038
curr_Factors:  [99.46928482]
mat_Sqrt:  [[0.15]]
grads:  [0.00756948]
Stock Position:  0.0075694785182248035
Bond Position:  [2.36026633]


portfolio before change:  [3.12545985]
curr_Stock_Price:  101.05035256462577
curr_Factors:  [101.05035256]
mat_Sqrt:  [[0.15]]
grads:  [0.12303856]
Stock Position:  0.12303856302859693
Bond Position:  [-9.30763032]


portfolio before change:  [3.13586385]
curr_Stock_Price:  101.14436799777312
curr_Factors:  [101.144368]
mat_Sqrt:  [[0.15]]
grads:  [0.13773745]
Stock Position:  0.13773744897491294
Bond Position:  [-10.79550338]


portfolio before change:  [3.02523137]
curr_Stock_Price:  100.35095299368336
curr_Factors:  [100.35095299]
mat_Sqrt:  [[0.15]]
grads:  [0.11832541]
Stock Position:  0.11832540861750811
Bond Position:  [-8.84883615]


portfolio before change:  [2.95003506]
curr_Stock_Price:  99.72479728073596
curr_Factors:  [99.72479728]
mat_Sqrt:  [[0.15]]
grads:  [0.17701767]
Stock Position:  0.17701766759889526
Bond Position:  [-14.70301595]


portfolio before change:  [2.89166728]
curr_Stock_Price:  99.40545180023683
curr_Factors:  [99.4054518]
mat_Sqrt:  [[0.15]]
grads:  [-0.02014603]
Stock Position:  -0.020146030657967967
Bond Position:  [4.89429256]


portfolio before change:  [2.87061987]
curr_Stock_Price:  100.48056367517802
curr_Factors:  [100.48056368]
mat_Sqrt:  [[0.15]]
grads:  [0.0309576]
Stock Position:  0.030957603039064932
Bond Position:  [-0.24001754]


portfolio before change:  [2.84834644]
curr_Stock_Price:  99.76205113451566
curr_Factors:  [99.76205113]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700162]
Stock Position:  -0.02700161724534567
Bond Position:  [5.54208316]


portfolio before change:  [2.83444147]
curr_Stock_Price:  100.30267694513897
curr_Factors:  [100.30267695]
mat_Sqrt:  [[0.15]]
grads:  [0.06504952]
Stock Position:  0.06504951594812713
Bond Position:  [-3.69019911]


portfolio before change:  [2.83063559]
curr_Stock_Price:  100.25126108458171
curr_Factors:  [100.25126108]
mat_Sqrt:  [[0.15]]
grads:  [0.07738725]
Stock Position:  0.07738724958599001
Bond Position:  [-4.92753377]


portfolio before change:  [2.75650582]
curr_Stock_Price:  99.30131410434532
curr_Factors:  [99.3013141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03624761]
Stock Position:  -0.0362476127574794
Bond Position:  [6.3559414]


portfolio before change:  [2.76485497]
curr_Stock_Price:  99.09289749601237
curr_Factors:  [99.0928975]
mat_Sqrt:  [[0.15]]
grads:  [0.06758617]
Stock Position:  0.06758616666505192
Bond Position:  [-3.93245411]


portfolio before change:  [2.70022106]
curr_Stock_Price:  98.1438524061935
curr_Factors:  [98.14385241]
mat_Sqrt:  [[0.15]]
grads:  [0.00521549]
Stock Position:  0.005215489508155226
Bond Position:  [2.18835283]


portfolio before change:  [2.70084334]
curr_Stock_Price:  98.21071376740464
curr_Factors:  [98.21071377]
mat_Sqrt:  [[0.15]]
grads:  [-0.07319683]
Stock Position:  -0.07319683011496295
Bond Position:  [9.88955627]


portfolio before change:  [2.66526682]
curr_Stock_Price:  98.71364257235128
curr_Factors:  [98.71364257]
mat_Sqrt:  [[0.15]]
grads:  [-0.01883939]
Stock Position:  -0.018839394778589688
Bond Position:  [4.5249721]


portfolio before change:  [2.65967229]
curr_Stock_Price:  99.04062653722261
curr_Factors:  [99.04062654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02112174]
Stock Position:  -0.021121735497148603
Bond Position:  [4.75158221]


portfolio before change:  [2.65598232]
curr_Stock_Price:  99.24344908620137
curr_Factors:  [99.24344909]
mat_Sqrt:  [[0.15]]
grads:  [-0.05680346]
Stock Position:  -0.056803463566934796
Bond Position:  [8.29335396]


portfolio before change:  [2.67790832]
curr_Stock_Price:  98.87570273171553
curr_Factors:  [98.87570273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588162]
Stock Position:  -0.015881619579475363
Bond Position:  [4.24821461]


portfolio before change:  [2.68018484]
curr_Stock_Price:  98.76579787820715
curr_Factors:  [98.76579788]
mat_Sqrt:  [[0.15]]
grads:  [0.00210509]
Stock Position:  0.0021050885633564992
Bond Position:  [2.47227409]


portfolio before change:  [2.68268796]
curr_Stock_Price:  99.80806369715525
curr_Factors:  [99.8080637]
mat_Sqrt:  [[0.15]]
grads:  [0.07096663]
Stock Position:  0.07096663300416788
Bond Position:  [-4.40035427]


portfolio before change:  [2.70653686]
curr_Stock_Price:  100.15187292730499
curr_Factors:  [100.15187293]
mat_Sqrt:  [[0.15]]
grads:  [0.03181263]
Stock Position:  0.03181263116235106
Bond Position:  [-0.47955773]


portfolio before change:  [2.64322281]
curr_Stock_Price:  98.16353993825517
curr_Factors:  [98.16353994]
mat_Sqrt:  [[0.15]]
grads:  [0.03824684]
Stock Position:  0.0382468360141833
Bond Position:  [-1.111222]


portfolio before change:  [2.59912774]
curr_Stock_Price:  97.01426427130043
curr_Factors:  [97.01426427]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590163]
Stock Position:  -0.005901632921441058
Bond Position:  [3.17167032]


portfolio before change:  [2.60680906]
curr_Stock_Price:  95.77988781157306
curr_Factors:  [95.77988781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01915234]
Stock Position:  -0.019152337343865518
Bond Position:  [4.44121778]


portfolio before change:  [2.61629242]
curr_Stock_Price:  95.31372156349707
curr_Factors:  [95.31372156]
mat_Sqrt:  [[0.15]]
grads:  [0.02448599]
Stock Position:  0.024485989220354797
Bond Position:  [0.28244166]


portfolio before change:  [2.60268594]
curr_Stock_Price:  94.75659512245063
curr_Factors:  [94.75659512]
mat_Sqrt:  [[0.15]]
grads:  [-0.12579685]
Stock Position:  -0.1257968523843557
Bond Position:  [14.52276735]


portfolio before change:  [2.58549072]
curr_Stock_Price:  94.90771720099978
curr_Factors:  [94.9077172]
mat_Sqrt:  [[0.15]]
grads:  [-0.16581825]
Stock Position:  -0.1658182485170504
Bond Position:  [18.32292215]


portfolio before change:  [2.66050675]
curr_Stock_Price:  94.46913140159792
curr_Factors:  [94.4691314]
mat_Sqrt:  [[0.15]]
grads:  [0.14347287]
Stock Position:  0.14347286601185627
Bond Position:  [-10.89325028]


portfolio before change:  [2.67829567]
curr_Stock_Price:  94.60261068735696
curr_Factors:  [94.60261069]
mat_Sqrt:  [[0.15]]
grads:  [0.01745473]
Stock Position:  0.017454728147291706
Bond Position:  [1.02703282]


portfolio before change:  [2.66364117]
curr_Stock_Price:  93.7556837546515
curr_Factors:  [93.75568375]
mat_Sqrt:  [[0.15]]
grads:  [-0.07623753]
Stock Position:  -0.07623753004489085
Bond Position:  [9.81134293]


portfolio before change:  [2.72396437]
curr_Stock_Price:  92.98051826293374
curr_Factors:  [92.98051826]
mat_Sqrt:  [[0.15]]
grads:  [-0.08134476]
Stock Position:  -0.08134476360769476
Bond Position:  [10.28744265]


portfolio before change:  [2.7296867]
curr_Stock_Price:  92.92598099060639
curr_Factors:  [92.92598099]
mat_Sqrt:  [[0.15]]
grads:  [-0.02058576]
Stock Position:  -0.020585755822558872
Bond Position:  [4.64263826]


portfolio before change:  [2.72992352]
curr_Stock_Price:  92.94266969817247
curr_Factors:  [92.9426697]
mat_Sqrt:  [[0.15]]
grads:  [-0.04402432]
Stock Position:  -0.044024322699031844
Bond Position:  [6.8216616]


portfolio before change:  [2.70897978]
curr_Stock_Price:  93.43777112682545
curr_Factors:  [93.43777113]
mat_Sqrt:  [[0.15]]
grads:  [-0.01466707]
Stock Position:  -0.01466707460468606
Bond Position:  [4.07943854]


portfolio before change:  [2.70540007]
curr_Stock_Price:  93.71660470085907
curr_Factors:  [93.7166047]
mat_Sqrt:  [[0.15]]
grads:  [0.12162414]
Stock Position:  0.12162413527158802
Bond Position:  [-8.69280094]


portfolio before change:  [2.75206235]
curr_Stock_Price:  94.1091990957491
curr_Factors:  [94.1091991]
mat_Sqrt:  [[0.15]]
grads:  [0.07616339]
Stock Position:  0.0761633867084822
Bond Position:  [-4.41561297]


portfolio before change:  [2.74402526]
curr_Stock_Price:  94.01092214237919
curr_Factors:  [94.01092214]
mat_Sqrt:  [[0.15]]
grads:  [0.11996367]
Stock Position:  0.11996367160095808
Bond Position:  [-8.53387013]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.74402526]
Stock Price:  93.72537955412756
PL:  [2.74402526]
Settle:  Tensor("sub_24:0", shape=(), dtype=float64)
PL:  Tensor("sub_25:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  13
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.52319208e-03]
 [ 1.81596012e-03]
 [ 1.46718254e-02]
 [-2.04879529e-02]
 [ 1.34297027e-02]
 [ 2.36172891e-02]
 [ 4.72681847e-03]
 [-1.17057274e-02]
 [-6.20123952e-03]
 [ 3.36825480e-03]
 [-1.09983125e-01]
 [-2.54021143e-02]
 [ 1.17353348e-02]
 [ 6.44796404e-03]
 [ 5.84250652e-03]
 [-6.92861566e-03]
 [-1.04288233e-02]
 [-2.57871575e-04]
 [-7.54107009e-03]
 [-2.58390462e-03]
 [ 5.20294022e-04]
 [ 9.40900494e-03]
 [ 4.75732386e-03]
 [ 5.40538063e-03]
 [-2.34250176e-03]
 [-5.83183734e-03]
 [ 6.48637667e-04]
 [-2.62045684e-02]
 [-1.58946775e-02]
 [ 2.19521947e-02]
 [ 7.96366449e-03]
 [ 4.65279004e-03]
 [-1.25240805e-02]
 [-5.21777631e-03]
 [-6.49153680e-03]
 [-7.46177247e-03]
 [ 2.23142239e-02]
 [ 7.35861700e-03]
 [ 2.32276026e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.51064444]
curr_Stock_Price:  100.48771999199504
curr_Factors:  [100.48771999]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015461]
Stock Position:  -0.010154613899715151
Bond Position:  [10.53105844]


portfolio before change:  [9.52473365]
curr_Stock_Price:  99.2298933606782
curr_Factors:  [99.22989336]
mat_Sqrt:  [[0.15]]
grads:  [0.0121064]
Stock Position:  0.012106400786299803
Bond Position:  [8.32341679]


portfolio before change:  [9.53275221]
curr_Stock_Price:  99.80628801526935
curr_Factors:  [99.80628802]
mat_Sqrt:  [[0.15]]
grads:  [0.09781217]
Stock Position:  0.09781216943068667
Bond Position:  [-0.22951735]


portfolio before change:  [9.41626786]
curr_Stock_Price:  98.61568298797786
curr_Factors:  [98.61568299]
mat_Sqrt:  [[0.15]]
grads:  [-0.13658635]
Stock Position:  -0.13658635249798523
Bond Position:  [22.88582429]


portfolio before change:  [9.34003667]
curr_Stock_Price:  99.19474591210079
curr_Factors:  [99.19474591]
mat_Sqrt:  [[0.15]]
grads:  [0.08953135]
Stock Position:  0.08953135155473273
Bond Position:  [0.458997]


portfolio before change:  [9.22903874]
curr_Stock_Price:  97.9543389992487
curr_Factors:  [97.954339]
mat_Sqrt:  [[0.15]]
grads:  [0.15744859]
Stock Position:  0.15744859410877185
Bond Position:  [-6.19373422]


portfolio before change:  [9.20229054]
curr_Stock_Price:  97.78937130952768
curr_Factors:  [97.78937131]
mat_Sqrt:  [[0.15]]
grads:  [0.03151212]
Stock Position:  0.03151212311881513
Bond Position:  [6.12073984]


portfolio before change:  [9.15021838]
curr_Stock_Price:  96.1126417945468
curr_Factors:  [96.11264179]
mat_Sqrt:  [[0.15]]
grads:  [-0.07803818]
Stock Position:  -0.07803818278674614
Bond Position:  [16.65067429]


portfolio before change:  [9.16396713]
curr_Stock_Price:  95.96313442501008
curr_Factors:  [95.96313443]
mat_Sqrt:  [[0.15]]
grads:  [-0.0413416]
Stock Position:  -0.04134159681826136
Bond Position:  [13.13123634]


portfolio before change:  [9.20852614]
curr_Stock_Price:  94.92501524187303
curr_Factors:  [94.92501524]
mat_Sqrt:  [[0.15]]
grads:  [0.02245503]
Stock Position:  0.022455032024437414
Bond Position:  [7.07698188]


portfolio before change:  [9.21716844]
curr_Stock_Price:  95.27048916463757
curr_Factors:  [95.27048916]
mat_Sqrt:  [[0.15]]
grads:  [-0.73322083]
Stock Position:  -0.7332208344711371
Bond Position:  [79.07147601]


portfolio before change:  [9.49526975]
curr_Stock_Price:  94.90468292531556
curr_Factors:  [94.90468293]
mat_Sqrt:  [[0.15]]
grads:  [-0.16934743]
Stock Position:  -0.16934742844383788
Bond Position:  [25.56713375]


portfolio before change:  [9.26775745]
curr_Stock_Price:  96.26702068427853
curr_Factors:  [96.26702068]
mat_Sqrt:  [[0.15]]
grads:  [0.07823557]
Stock Position:  0.07823556521059684
Bond Position:  [1.73625267]


portfolio before change:  [9.3138303]
curr_Stock_Price:  96.8531455384838
curr_Factors:  [96.85314554]
mat_Sqrt:  [[0.15]]
grads:  [0.04298643]
Stock Position:  0.0429864269543077
Bond Position:  [5.15045964]


portfolio before change:  [9.3333086]
curr_Stock_Price:  97.29129421242713
curr_Factors:  [97.29129421]
mat_Sqrt:  [[0.15]]
grads:  [0.03895004]
Stock Position:  0.03895004343789796
Bond Position:  [5.54380846]


portfolio before change:  [9.26279527]
curr_Stock_Price:  95.46314864404886
curr_Factors:  [95.46314864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04619077]
Stock Position:  -0.0461907710558975
Bond Position:  [13.67231171]


portfolio before change:  [9.25734831]
curr_Stock_Price:  95.6180734689442
curr_Factors:  [95.61807347]
mat_Sqrt:  [[0.15]]
grads:  [-0.06952549]
Stock Position:  -0.06952548865291594
Bond Position:  [15.9052416]


portfolio before change:  [9.14188064]
curr_Stock_Price:  97.30746767821644
curr_Factors:  [97.30746768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00171914]
Stock Position:  -0.0017191438350372488
Bond Position:  [9.30916617]


portfolio before change:  [9.14203662]
curr_Stock_Price:  97.89364991940013
curr_Factors:  [97.89364992]
mat_Sqrt:  [[0.15]]
grads:  [-0.0502738]
Stock Position:  -0.050273800575542524
Bond Position:  [14.06352246]


portfolio before change:  [9.20924518]
curr_Stock_Price:  96.59176891930684
curr_Factors:  [96.59176892]
mat_Sqrt:  [[0.15]]
grads:  [-0.01722603]
Stock Position:  -0.017226030775640985
Bond Position:  [10.87313796]


portfolio before change:  [9.19951684]
curr_Stock_Price:  97.23542055236966
curr_Factors:  [97.23542055]
mat_Sqrt:  [[0.15]]
grads:  [0.00346863]
Stock Position:  0.0034686268157164586
Bond Position:  [8.86224346]


portfolio before change:  [9.20255767]
curr_Stock_Price:  97.79269414346193
curr_Factors:  [97.79269414]
mat_Sqrt:  [[0.15]]
grads:  [0.0627267]
Stock Position:  0.06272669962636243
Bond Position:  [3.06834472]


portfolio before change:  [9.114719]
curr_Stock_Price:  96.38623985579498
curr_Factors:  [96.38623986]
mat_Sqrt:  [[0.15]]
grads:  [0.03171549]
Stock Position:  0.031715492419686526
Bond Position:  [6.05778194]


portfolio before change:  [9.11465829]
curr_Stock_Price:  96.36044887258058
curr_Factors:  [96.36044887]
mat_Sqrt:  [[0.15]]
grads:  [0.03603587]
Stock Position:  0.03603587085851182
Bond Position:  [5.6422256]


portfolio before change:  [9.16935113]
curr_Stock_Price:  97.8586093593581
curr_Factors:  [97.85860936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01561668]
Stock Position:  -0.015616678395354446
Bond Position:  [10.69757757]


portfolio before change:  [9.16328032]
curr_Stock_Price:  98.33298022292968
curr_Factors:  [98.33298022]
mat_Sqrt:  [[0.15]]
grads:  [-0.03887892]
Stock Position:  -0.038878915626465935
Bond Position:  [12.98635996]


portfolio before change:  [9.15228914]
curr_Stock_Price:  98.65743813028168
curr_Factors:  [98.65743813]
mat_Sqrt:  [[0.15]]
grads:  [0.00432425]
Stock Position:  0.004324251116140106
Bond Position:  [8.72566961]


portfolio before change:  [9.15627024]
curr_Stock_Price:  99.32583706941695
curr_Factors:  [99.32583707]
mat_Sqrt:  [[0.15]]
grads:  [-0.17469712]
Stock Position:  -0.17469712296815584
Bond Position:  [26.50820822]


portfolio before change:  [8.92991933]
curr_Stock_Price:  100.64048177968832
curr_Factors:  [100.64048178]
mat_Sqrt:  [[0.15]]
grads:  [-0.10596452]
Stock Position:  -0.1059645166985226
Bond Position:  [19.59423934]


portfolio before change:  [8.89406409]
curr_Stock_Price:  101.00196766168983
curr_Factors:  [101.00196766]
mat_Sqrt:  [[0.15]]
grads:  [0.14634796]
Stock Position:  0.14634796450580373
Bond Position:  [-5.88736829]


portfolio before change:  [8.84591794]
curr_Stock_Price:  100.67801252796191
curr_Factors:  [100.67801253]
mat_Sqrt:  [[0.15]]
grads:  [0.0530911]
Stock Position:  0.05309109657061038
Bond Position:  [3.50081186]


portfolio before change:  [8.85484203]
curr_Stock_Price:  100.83785956214543
curr_Factors:  [100.83785956]
mat_Sqrt:  [[0.15]]
grads:  [0.0310186]
Stock Position:  0.031018600238515034
Bond Position:  [5.72699277]


portfolio before change:  [8.87653607]
curr_Stock_Price:  101.51416748382462
curr_Factors:  [101.51416748]
mat_Sqrt:  [[0.15]]
grads:  [-0.08349387]
Stock Position:  -0.08349386997001698
Bond Position:  [17.35234677]


portfolio before change:  [8.97270887]
curr_Stock_Price:  100.38829298944755
curr_Factors:  [100.38829299]
mat_Sqrt:  [[0.15]]
grads:  [-0.03478518]
Stock Position:  -0.034785175404439844
Bond Position:  [12.46473325]


portfolio before change:  [8.97953511]
curr_Stock_Price:  100.23684765917962
curr_Factors:  [100.23684766]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327691]
Stock Position:  -0.043276911974916114
Bond Position:  [13.31747634]


portfolio before change:  [8.9895547]
curr_Stock_Price:  100.04379314369574
curr_Factors:  [100.04379314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974515]
Stock Position:  -0.049745149823244135
Bond Position:  [13.96624818]


portfolio before change:  [9.04499828]
curr_Stock_Price:  98.96433731402803
curr_Factors:  [98.96433731]
mat_Sqrt:  [[0.15]]
grads:  [0.14876149]
Stock Position:  0.14876149298717525
Bond Position:  [-5.67708429]


portfolio before change:  [9.19549983]
curr_Stock_Price:  99.98080486275335
curr_Factors:  [99.98080486]
mat_Sqrt:  [[0.15]]
grads:  [0.04905745]
Stock Position:  0.049057446662124145
Bond Position:  [4.29069683]


portfolio before change:  [9.13639871]
curr_Stock_Price:  98.76513840646315
curr_Factors:  [98.76513841]
mat_Sqrt:  [[0.15]]
grads:  [0.15485068]
Stock Position:  0.15485068367501365
Bond Position:  [-6.15745049]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.13639871]
Stock Price:  98.5923571035224
PL:  [9.13639871]
Settle:  Tensor("sub_26:0", shape=(), dtype=float64)
PL:  Tensor("sub_27:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  14
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44922301e-03]
 [-8.83728480e-03]
 [-6.24370240e-03]
 [ 8.80605478e-04]
 [ 1.24672780e-02]
 [ 2.97941659e-02]
 [ 1.80259089e-02]
 [ 8.15038666e-04]
 [ 3.98395823e-03]
 [ 1.06461219e-02]
 [ 1.14335885e-02]
 [ 1.10140719e-02]
 [-1.19047191e-02]
 [ 1.02752712e-02]
 [ 1.73319430e-04]
 [-2.63740322e-02]
 [ 4.09931587e-03]
 [ 5.17816286e-04]
 [-1.12677753e-02]
 [-2.21508346e-03]
 [ 3.58970505e-04]
 [ 8.62358106e-03]
 [ 4.76670363e-03]
 [ 6.03698235e-03]
 [-4.63969083e-03]
 [-7.78832892e-03]
 [ 2.55051039e-03]
 [-2.25335440e-02]
 [-3.61654374e-02]
 [ 2.19188004e-02]
 [ 3.04069690e-03]
 [-3.59125432e-03]
 [-1.25335110e-02]
 [-9.82359330e-03]
 [-6.50628006e-03]
 [-5.38598984e-03]
 [ 1.97974194e-02]
 [ 9.62551470e-03]
 [ 1.96640928e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.33525513]
curr_Stock_Price:  100.21873276672137
curr_Factors:  [100.21873277]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966149]
Stock Position:  -0.009661486719824747
Bond Position:  [6.30351708]


portfolio before change:  [5.33097907]
curr_Stock_Price:  100.7428805683143
curr_Factors:  [100.74288057]
mat_Sqrt:  [[0.15]]
grads:  [-0.05891523]
Stock Position:  -0.05891523202247853
Bond Position:  [11.26626925]


portfolio before change:  [5.3040233]
curr_Stock_Price:  101.22432036057812
curr_Factors:  [101.22432036]
mat_Sqrt:  [[0.15]]
grads:  [-0.04162468]
Stock Position:  -0.041624682665985895
Bond Position:  [9.51745352]


portfolio before change:  [5.33531527]
curr_Stock_Price:  100.50113852242166
curr_Factors:  [100.50113852]
mat_Sqrt:  [[0.15]]
grads:  [0.0058707]
Stock Position:  0.005870703188812244
Bond Position:  [4.74530292]


portfolio before change:  [5.34221009]
curr_Stock_Price:  101.5745400389944
curr_Factors:  [101.57454004]
mat_Sqrt:  [[0.15]]
grads:  [0.08311519]
Stock Position:  0.08311518634953831
Bond Position:  [-3.10017673]


portfolio before change:  [5.36061715]
curr_Stock_Price:  101.80066715727808
curr_Factors:  [101.80066716]
mat_Sqrt:  [[0.15]]
grads:  [0.19862777]
Stock Position:  0.19862777286554473
Bond Position:  [-14.85982265]


portfolio before change:  [5.26357718]
curr_Stock_Price:  101.32146742574398
curr_Factors:  [101.32146743]
mat_Sqrt:  [[0.15]]
grads:  [0.12017273]
Stock Position:  0.12017272571522004
Bond Position:  [-6.91249974]


portfolio before change:  [5.41251003]
curr_Stock_Price:  102.56798132637005
curr_Factors:  [102.56798133]
mat_Sqrt:  [[0.15]]
grads:  [0.00543359]
Stock Position:  0.005433591104540974
Bond Position:  [4.85519756]


portfolio before change:  [5.40645934]
curr_Stock_Price:  101.34270956216075
curr_Factors:  [101.34270956]
mat_Sqrt:  [[0.15]]
grads:  [0.02655972]
Stock Position:  0.02655972156344546
Bond Position:  [2.7148252]


portfolio before change:  [5.41413587]
curr_Stock_Price:  101.61896078651786
curr_Factors:  [101.61896079]
mat_Sqrt:  [[0.15]]
grads:  [0.07097415]
Stock Position:  0.07097414580923231
Bond Position:  [-1.79818307]


portfolio before change:  [5.32649851]
curr_Stock_Price:  100.3873491999287
curr_Factors:  [100.3873492]
mat_Sqrt:  [[0.15]]
grads:  [0.07622392]
Stock Position:  0.07622392308620052
Bond Position:  [-2.32541908]


portfolio before change:  [5.40075594]
curr_Stock_Price:  101.36536405415704
curr_Factors:  [101.36536405]
mat_Sqrt:  [[0.15]]
grads:  [0.07342715]
Stock Position:  0.07342714568580314
Bond Position:  [-2.04221341]


portfolio before change:  [5.47890963]
curr_Stock_Price:  102.43321141996496
curr_Factors:  [102.43321142]
mat_Sqrt:  [[0.15]]
grads:  [-0.07936479]
Stock Position:  -0.07936479383315327
Bond Position:  [13.60850034]


portfolio before change:  [5.4605489]
curr_Stock_Price:  102.68599222459142
curr_Factors:  [102.68599222]
mat_Sqrt:  [[0.15]]
grads:  [0.06850181]
Stock Position:  0.06850180820422512
Bond Position:  [-1.57362724]


portfolio before change:  [5.51218936]
curr_Stock_Price:  103.4427192858833
curr_Factors:  [103.44271929]
mat_Sqrt:  [[0.15]]
grads:  [0.00115546]
Stock Position:  0.0011554628654325955
Bond Position:  [5.39266514]


portfolio before change:  [5.51196395]
curr_Stock_Price:  102.66421095287815
curr_Factors:  [102.66421095]
mat_Sqrt:  [[0.15]]
grads:  [-0.17582688]
Stock Position:  -0.1758268813664359
Bond Position:  [23.56309199]


portfolio before change:  [5.57036328]
curr_Stock_Price:  102.34882255961594
curr_Factors:  [102.34882256]
mat_Sqrt:  [[0.15]]
grads:  [0.02732877]
Stock Position:  0.027328772471452944
Bond Position:  [2.77329559]


portfolio before change:  [5.57543426]
curr_Stock_Price:  102.5216917600287
curr_Factors:  [102.52169176]
mat_Sqrt:  [[0.15]]
grads:  [0.00345211]
Stock Position:  0.0034521085755148564
Bond Position:  [5.22151825]


portfolio before change:  [5.57072014]
curr_Stock_Price:  100.9670314287964
curr_Factors:  [100.96703143]
mat_Sqrt:  [[0.15]]
grads:  [-0.0751185]
Stock Position:  -0.07511850200148973
Bond Position:  [13.15521229]


portfolio before change:  [5.61215579]
curr_Stock_Price:  100.43731976618375
curr_Factors:  [100.43731977]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476722]
Stock Position:  -0.014767223061112975
Bond Position:  [7.09533609]


portfolio before change:  [5.60879412]
curr_Stock_Price:  100.7250273141852
curr_Factors:  [100.72502731]
mat_Sqrt:  [[0.15]]
grads:  [0.00239314]
Stock Position:  0.002393136698006666
Bond Position:  [5.36774536]


portfolio before change:  [5.60577272]
curr_Stock_Price:  99.18211166023403
curr_Factors:  [99.18211166]
mat_Sqrt:  [[0.15]]
grads:  [0.05749054]
Stock Position:  0.05749054039551107
Bond Position:  [-0.09626047]


portfolio before change:  [5.59964676]
curr_Stock_Price:  99.07576498837874
curr_Factors:  [99.07576499]
mat_Sqrt:  [[0.15]]
grads:  [0.03177802]
Stock Position:  0.031778024196349904
Bond Position:  [2.4512147]


portfolio before change:  [5.6136425]
curr_Stock_Price:  99.5065443049944
curr_Factors:  [99.5065443]
mat_Sqrt:  [[0.15]]
grads:  [0.04024655]
Stock Position:  0.04024654898797171
Bond Position:  [1.60884749]


portfolio before change:  [5.6418927]
curr_Stock_Price:  100.20347582449907
curr_Factors:  [100.20347582]
mat_Sqrt:  [[0.15]]
grads:  [-0.03093127]
Stock Position:  -0.030931272171393524
Bond Position:  [8.74131369]


portfolio before change:  [5.66270437]
curr_Stock_Price:  99.5659678971779
curr_Factors:  [99.5659679]
mat_Sqrt:  [[0.15]]
grads:  [-0.05192219]
Stock Position:  -0.05192219280794495
Bond Position:  [10.83238775]


portfolio before change:  [5.70401178]
curr_Stock_Price:  98.79648418643986
curr_Factors:  [98.79648419]
mat_Sqrt:  [[0.15]]
grads:  [0.0170034]
Stock Position:  0.01700340258019554
Bond Position:  [4.02413539]


portfolio before change:  [5.69825652]
curr_Stock_Price:  98.42842202121184
curr_Factors:  [98.42842202]
mat_Sqrt:  [[0.15]]
grads:  [-0.15022363]
Stock Position:  -0.1502236268025744
Bond Position:  [20.48453106]


portfolio before change:  [5.70941668]
curr_Stock_Price:  98.37117779942315
curr_Factors:  [98.3711778]
mat_Sqrt:  [[0.15]]
grads:  [-0.24110292]
Stock Position:  -0.2411029161261778
Bond Position:  [29.42699451]


portfolio before change:  [6.02277552]
curr_Stock_Price:  97.08674606626923
curr_Factors:  [97.08674607]
mat_Sqrt:  [[0.15]]
grads:  [0.14612534]
Stock Position:  0.14612533628353877
Bond Position:  [-8.16405789]


portfolio before change:  [5.98201243]
curr_Stock_Price:  96.81477050493251
curr_Factors:  [96.8147705]
mat_Sqrt:  [[0.15]]
grads:  [0.02027131]
Stock Position:  0.020271312695561417
Bond Position:  [4.01944995]


portfolio before change:  [6.0040907]
curr_Stock_Price:  97.87912230520811
curr_Factors:  [97.87912231]
mat_Sqrt:  [[0.15]]
grads:  [-0.0239417]
Stock Position:  -0.023941695490982236
Bond Position:  [8.34748284]


portfolio before change:  [6.01317465]
curr_Stock_Price:  97.54328789267589
curr_Factors:  [97.54328789]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355674]
Stock Position:  -0.08355673984596874
Bond Position:  [14.16357378]


portfolio before change:  [6.10497284]
curr_Stock_Price:  96.46584477146646
curr_Factors:  [96.46584477]
mat_Sqrt:  [[0.15]]
grads:  [-0.06549062]
Stock Position:  -0.06549062199346065
Bond Position:  [12.42258102]


portfolio before change:  [6.12637955]
curr_Stock_Price:  96.16269001598451
curr_Factors:  [96.16269002]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433752]
Stock Position:  -0.04337520042162128
Bond Position:  [10.29745551]


portfolio before change:  [6.128057]
curr_Stock_Price:  96.15369449511837
curr_Factors:  [96.1536945]
mat_Sqrt:  [[0.15]]
grads:  [-0.0359066]
Stock Position:  -0.035906598952726396
Bond Position:  [9.58060915]


portfolio before change:  [6.12558712]
curr_Stock_Price:  96.25583521586191
curr_Factors:  [96.25583522]
mat_Sqrt:  [[0.15]]
grads:  [0.1319828]
Stock Position:  0.1319827958233174
Bond Position:  [-6.57852712]


portfolio before change:  [6.03630268]
curr_Stock_Price:  95.58558062407064
curr_Factors:  [95.58558062]
mat_Sqrt:  [[0.15]]
grads:  [0.0641701]
Stock Position:  0.06417009799925218
Bond Position:  [-0.09743339]


portfolio before change:  [6.01509303]
curr_Stock_Price:  95.25524809795483
curr_Factors:  [95.2552481]
mat_Sqrt:  [[0.15]]
grads:  [0.13109395]
Stock Position:  0.1310939518267738
Bond Position:  [-6.47229387]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.01509303]
Stock Price:  93.87660042650107
PL:  [6.01509303]
Settle:  Tensor("sub_28:0", shape=(), dtype=float64)
PL:  Tensor("sub_29:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  15
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.36365929e-03]
 [-2.87077108e-03]
 [-3.37634839e-03]
 [ 7.69204548e-02]
 [-9.74752493e-03]
 [ 2.79695008e-02]
 [ 1.67963873e-02]
 [ 9.81260900e-04]
 [ 1.13395080e-02]
 [ 1.22375544e-02]
 [ 2.34829948e-02]
 [ 3.01459335e-03]
 [-1.20316407e-02]
 [ 5.05575002e-03]
 [ 7.35047592e-04]
 [-2.98873084e-02]
 [ 4.90113095e-03]
 [-5.60352194e-03]
 [ 4.47761168e-03]
 [-3.38301127e-03]
 [-1.79924870e-03]
 [-3.95767958e-02]
 [ 4.83773486e-03]
 [ 1.12516546e-02]
 [-5.57297077e-03]
 [ 1.01235003e-02]
 [-1.06864693e-02]
 [ 8.06298588e-04]
 [ 4.63264346e-02]
 [ 2.60693831e-02]
 [-1.74274146e-02]
 [ 6.26265984e-03]
 [-1.29813354e-02]
 [-1.36117021e-03]
 [-5.88328157e-03]
 [-1.49476767e-03]
 [ 2.33524027e-02]
 [ 2.64801787e-03]
 [ 2.30505521e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.95685266]
curr_Stock_Price:  100.64530979067703
curr_Factors:  [100.64530979]
mat_Sqrt:  [[0.15]]
grads:  [-0.00909106]
Stock Position:  -0.009091061955365359
Bond Position:  [12.87182541]


portfolio before change:  [11.95101436]
curr_Stock_Price:  101.4645080608601
curr_Factors:  [101.46450806]
mat_Sqrt:  [[0.15]]
grads:  [-0.01913847]
Stock Position:  -0.019138473838119688
Bond Position:  [13.89289019]


portfolio before change:  [11.94717847]
curr_Stock_Price:  101.75568130180693
curr_Factors:  [101.7556813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02250899]
Stock Position:  -0.02250898927830002
Bond Position:  [14.23759601]


portfolio before change:  [11.92361476]
curr_Stock_Price:  102.88161020118861
curr_Factors:  [102.8816102]
mat_Sqrt:  [[0.15]]
grads:  [0.51280303]
Stock Position:  0.512803031837194
Bond Position:  [-40.83438687]


portfolio before change:  [11.60232333]
curr_Stock_Price:  102.26502489288461
curr_Factors:  [102.26502489]
mat_Sqrt:  [[0.15]]
grads:  [-0.0649835]
Stock Position:  -0.06498349951452856
Bond Position:  [18.24786252]


portfolio before change:  [11.67708174]
curr_Stock_Price:  101.14970647933536
curr_Factors:  [101.14970648]
mat_Sqrt:  [[0.15]]
grads:  [0.18646334]
Stock Position:  0.1864633384749825
Bond Position:  [-7.18363021]


portfolio before change:  [11.72413341]
curr_Stock_Price:  101.40685982773822
curr_Factors:  [101.40685983]
mat_Sqrt:  [[0.15]]
grads:  [0.11197592]
Stock Position:  0.11197591556710708
Bond Position:  [0.36900743]


portfolio before change:  [11.87003609]
curr_Stock_Price:  102.70943058317972
curr_Factors:  [102.70943058]
mat_Sqrt:  [[0.15]]
grads:  [0.00654174]
Stock Position:  0.006541739330933784
Bond Position:  [11.19813777]


portfolio before change:  [11.87438269]
curr_Stock_Price:  103.15988354084813
curr_Factors:  [103.15988354]
mat_Sqrt:  [[0.15]]
grads:  [0.07559672]
Stock Position:  0.07559671990833919
Bond Position:  [4.07583387]


portfolio before change:  [11.83430324]
curr_Stock_Price:  102.62296926331076
curr_Factors:  [102.62296926]
mat_Sqrt:  [[0.15]]
grads:  [0.0815837]
Stock Position:  0.08158369590729023
Bond Position:  [3.46194212]


portfolio before change:  [11.89157417]
curr_Stock_Price:  103.31965449915657
curr_Factors:  [103.3196545]
mat_Sqrt:  [[0.15]]
grads:  [0.1565533]
Stock Position:  0.1565532984029458
Bond Position:  [-4.28345853]


portfolio before change:  [11.74484551]
curr_Stock_Price:  102.38583075596225
curr_Factors:  [102.38583076]
mat_Sqrt:  [[0.15]]
grads:  [0.02009729]
Stock Position:  0.0200972890256912
Bond Position:  [9.68716788]


portfolio before change:  [11.75169123]
curr_Stock_Price:  102.66620418809721
curr_Factors:  [102.66620419]
mat_Sqrt:  [[0.15]]
grads:  [-0.08021094]
Stock Position:  -0.08021093810071228
Bond Position:  [19.98664378]


portfolio before change:  [11.69845798]
curr_Stock_Price:  103.36101892312223
curr_Factors:  [103.36101892]
mat_Sqrt:  [[0.15]]
grads:  [0.033705]
Stock Position:  0.0337050001162099
Bond Position:  [8.21467482]


portfolio before change:  [11.71204241]
curr_Stock_Price:  103.73359084003916
curr_Factors:  [103.73359084]
mat_Sqrt:  [[0.15]]
grads:  [0.00490032]
Stock Position:  0.004900317278009175
Bond Position:  [11.2037149]


portfolio before change:  [11.71499919]
curr_Stock_Price:  104.05116731050586
curr_Factors:  [104.05116731]
mat_Sqrt:  [[0.15]]
grads:  [-0.19924872]
Stock Position:  -0.1992487225654264
Bond Position:  [32.44706136]


portfolio before change:  [11.71721202]
curr_Stock_Price:  104.06041858230718
curr_Factors:  [104.06041858]
mat_Sqrt:  [[0.15]]
grads:  [0.03267421]
Stock Position:  0.03267420635430309
Bond Position:  [8.31712043]


portfolio before change:  [11.71419184]
curr_Stock_Price:  103.93616504314684
curr_Factors:  [103.93616504]
mat_Sqrt:  [[0.15]]
grads:  [-0.03735681]
Stock Position:  -0.03735681290076795
Bond Position:  [15.59691571]


portfolio before change:  [11.70693492]
curr_Stock_Price:  104.18261683617541
curr_Factors:  [104.18261684]
mat_Sqrt:  [[0.15]]
grads:  [0.02985074]
Stock Position:  0.029850744531811694
Bond Position:  [8.59700624]


portfolio before change:  [11.71059897]
curr_Stock_Price:  104.26936026210593
curr_Factors:  [104.26936026]
mat_Sqrt:  [[0.15]]
grads:  [-0.02255341]
Stock Position:  -0.022553408445528212
Bond Position:  [14.06222844]


portfolio before change:  [11.71125688]
curr_Stock_Price:  104.31813261351795
curr_Factors:  [104.31813261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199499]
Stock Position:  -0.011994991361773137
Bond Position:  [12.96255198]


portfolio before change:  [11.70952523]
curr_Stock_Price:  104.59758861295497
curr_Factors:  [104.59758861]
mat_Sqrt:  [[0.15]]
grads:  [-0.26384531]
Stock Position:  -0.26384530520533506
Bond Position:  [39.30710792]


portfolio before change:  [11.25505567]
curr_Stock_Price:  106.33869691541955
curr_Factors:  [106.33869692]
mat_Sqrt:  [[0.15]]
grads:  [0.03225157]
Stock Position:  0.032251565762932435
Bond Position:  [7.82546619]


portfolio before change:  [11.22595526]
curr_Stock_Price:  105.40607077274204
curr_Factors:  [105.40607077]
mat_Sqrt:  [[0.15]]
grads:  [0.07501103]
Stock Position:  0.07501103060099562
Bond Position:  [3.31933726]


portfolio before change:  [11.18795683]
curr_Stock_Price:  104.89396771385339
curr_Factors:  [104.89396771]
mat_Sqrt:  [[0.15]]
grads:  [-0.03715314]
Stock Position:  -0.0371531384826073
Bond Position:  [15.08509693]


portfolio before change:  [11.15790241]
curr_Stock_Price:  105.75365753329112
curr_Factors:  [105.75365753]
mat_Sqrt:  [[0.15]]
grads:  [0.06749]
Stock Position:  0.06749000217071566
Bond Position:  [4.02058783]


portfolio before change:  [11.15424048]
curr_Stock_Price:  105.69195166328461
curr_Factors:  [105.69195166]
mat_Sqrt:  [[0.15]]
grads:  [-0.07124313]
Stock Position:  -0.07124312857841242
Bond Position:  [18.68406578]


portfolio before change:  [11.22784067]
curr_Stock_Price:  104.69165122317362
curr_Factors:  [104.69165122]
mat_Sqrt:  [[0.15]]
grads:  [0.00537532]
Stock Position:  0.005375323917916527
Bond Position:  [10.66508913]


portfolio before change:  [11.2339937]
curr_Stock_Price:  105.58830719314824
curr_Factors:  [105.58830719]
mat_Sqrt:  [[0.15]]
grads:  [0.3088429]
Stock Position:  0.30884289721093267
Bond Position:  [-21.376205]


portfolio before change:  [11.16274389]
curr_Stock_Price:  105.36626025556518
curr_Factors:  [105.36626026]
mat_Sqrt:  [[0.15]]
grads:  [0.17379589]
Stock Position:  0.17379588719759118
Bond Position:  [-7.14947879]


portfolio before change:  [11.01621187]
curr_Stock_Price:  104.52827560940663
curr_Factors:  [104.52827561]
mat_Sqrt:  [[0.15]]
grads:  [-0.11618276]
Stock Position:  -0.11618276420863674
Bond Position:  [23.16059586]


portfolio before change:  [11.12398178]
curr_Stock_Price:  103.62560596441763
curr_Factors:  [103.62560596]
mat_Sqrt:  [[0.15]]
grads:  [0.04175107]
Stock Position:  0.0417510655879609
Bond Position:  [6.79750231]


portfolio before change:  [11.13635574]
curr_Stock_Price:  103.90162810291565
curr_Factors:  [103.9016281]
mat_Sqrt:  [[0.15]]
grads:  [-0.08654224]
Stock Position:  -0.08654223621656781
Bond Position:  [20.12823498]


portfolio before change:  [11.18134829]
curr_Stock_Price:  103.41081150270787
curr_Factors:  [103.4108115]
mat_Sqrt:  [[0.15]]
grads:  [-0.00907447]
Stock Position:  -0.009074468079976375
Bond Position:  [12.1197464]


portfolio before change:  [11.17736838]
curr_Stock_Price:  104.01635363071196
curr_Factors:  [104.01635363]
mat_Sqrt:  [[0.15]]
grads:  [-0.03922188]
Stock Position:  -0.0392218771621669
Bond Position:  [15.25708502]


portfolio before change:  [11.19814675]
curr_Stock_Price:  103.53521610857986
curr_Factors:  [103.53521611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00996512]
Stock Position:  -0.009965117772405472
Bond Position:  [12.22988737]


portfolio before change:  [11.20751521]
curr_Stock_Price:  102.74850940349762
curr_Factors:  [102.7485094]
mat_Sqrt:  [[0.15]]
grads:  [0.15568268]
Stock Position:  0.15568268433516022
Bond Position:  [-4.78864855]


portfolio before change:  [11.05542321]
curr_Stock_Price:  101.77541863615333
curr_Factors:  [101.77541864]
mat_Sqrt:  [[0.15]]
grads:  [0.01765345]
Stock Position:  0.017653452464266226
Bond Position:  [9.25873569]


portfolio before change:  [11.04626144]
curr_Stock_Price:  101.19087704100993
curr_Factors:  [101.19087704]
mat_Sqrt:  [[0.15]]
grads:  [0.15367035]
Stock Position:  0.15367034763700335
Bond Position:  [-4.50377581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.04626144]
Stock Price:  101.95150887201362
PL:  [9.09475257]
Settle:  Tensor("sub_30:0", shape=(), dtype=float64)
PL:  Tensor("sub_31:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  16
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.29504768e-03]
 [-4.91010092e-03]
 [-3.53807199e-02]
 [-3.09796130e-02]
 [-2.12895186e-02]
 [ 2.57603543e-02]
 [-5.50420366e-03]
 [-1.42690378e-02]
 [-1.61293404e-02]
 [ 3.95549057e-03]
 [-1.11791444e-01]
 [-2.11640296e-02]
 [ 1.31727809e-02]
 [ 4.84238559e-04]
 [ 1.42513305e-02]
 [-1.15517241e-02]
 [-8.84042675e-03]
 [ 3.38651574e-04]
 [-7.65559597e-03]
 [-2.79888241e-03]
 [ 7.92992561e-04]
 [ 1.36670956e-02]
 [ 4.75615033e-03]
 [ 5.47553051e-03]
 [ 2.38591328e-03]
 [-3.22255292e-03]
 [-3.67732679e-04]
 [-1.80566915e-02]
 [-3.00082658e-02]
 [ 2.19038326e-02]
 [ 3.50837216e-03]
 [-5.84263762e-03]
 [-1.25371228e-02]
 [-1.03762851e-02]
 [-8.15336306e-03]
 [-7.52522147e-03]
 [ 2.03989157e-02]
 [ 9.41425495e-03]
 [ 1.98158456e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.29659753]
curr_Stock_Price:  99.14727438083554
curr_Factors:  [99.14727438]
mat_Sqrt:  [[0.15]]
grads:  [-0.03530032]
Stock Position:  -0.035300317886132415
Bond Position:  [-7.79666723]


portfolio before change:  [-11.27900991]
curr_Stock_Price:  98.62143588736342
curr_Factors:  [98.62143589]
mat_Sqrt:  [[0.15]]
grads:  [-0.03273401]
Stock Position:  -0.0327340061310518
Bond Position:  [-8.05073523]


portfolio before change:  [-11.25851848]
curr_Stock_Price:  97.96469275982103
curr_Factors:  [97.96469276]
mat_Sqrt:  [[0.15]]
grads:  [-0.23587147]
Stock Position:  -0.23587146571585016
Bond Position:  [11.84855719]


portfolio before change:  [-11.0365089]
curr_Stock_Price:  97.02974109344802
curr_Factors:  [97.02974109]
mat_Sqrt:  [[0.15]]
grads:  [-0.20653075]
Stock Position:  -0.20653075335731724
Bond Position:  [9.00311662]


portfolio before change:  [-10.8093131]
curr_Stock_Price:  95.93513246796546
curr_Factors:  [95.93513247]
mat_Sqrt:  [[0.15]]
grads:  [-0.14193012]
Stock Position:  -0.14193012377401254
Bond Position:  [2.80677213]


portfolio before change:  [-10.60622659]
curr_Stock_Price:  94.50671377187918
curr_Factors:  [94.50671377]
mat_Sqrt:  [[0.15]]
grads:  [0.1717357]
Stock Position:  0.17173569557672308
Bond Position:  [-26.83640281]


portfolio before change:  [-10.61164697]
curr_Stock_Price:  94.49468586007355
curr_Factors:  [94.49468586]
mat_Sqrt:  [[0.15]]
grads:  [-0.03669469]
Stock Position:  -0.03669469106320372
Bond Position:  [-7.14419366]


portfolio before change:  [-10.63930591]
curr_Stock_Price:  95.2241064393882
curr_Factors:  [95.22410644]
mat_Sqrt:  [[0.15]]
grads:  [-0.09512692]
Stock Position:  -0.09512691884748135
Bond Position:  [-1.58093007]


portfolio before change:  [-10.60927136]
curr_Stock_Price:  94.90629752256802
curr_Factors:  [94.90629752]
mat_Sqrt:  [[0.15]]
grads:  [-0.10752894]
Stock Position:  -0.10752893596498779
Bond Position:  [-0.40409817]


portfolio before change:  [-10.68690491]
curr_Stock_Price:  95.62780598357347
curr_Factors:  [95.62780598]
mat_Sqrt:  [[0.15]]
grads:  [0.02636994]
Stock Position:  0.026369937103438747
Bond Position:  [-13.20860414]


portfolio before change:  [-10.69919879]
curr_Stock_Price:  95.22421371760947
curr_Factors:  [95.22421372]
mat_Sqrt:  [[0.15]]
grads:  [-0.74527629]
Stock Position:  -0.7452762948746191
Bond Position:  [60.26915039]


portfolio before change:  [-10.84892866]
curr_Stock_Price:  95.43522805584918
curr_Factors:  [95.43522806]
mat_Sqrt:  [[0.15]]
grads:  [-0.14109353]
Stock Position:  -0.1410935307123778
Bond Position:  [2.61636462]


portfolio before change:  [-10.88687378]
curr_Stock_Price:  95.70648207510567
curr_Factors:  [95.70648208]
mat_Sqrt:  [[0.15]]
grads:  [0.08781854]
Stock Position:  0.08781853909587237
Bond Position:  [-19.29167722]


portfolio before change:  [-10.91577964]
curr_Stock_Price:  95.40478899179205
curr_Factors:  [95.40478899]
mat_Sqrt:  [[0.15]]
grads:  [0.00322826]
Stock Position:  0.003228257060976433
Bond Position:  [-11.22377082]


portfolio before change:  [-10.91585661]
curr_Stock_Price:  95.81556494971025
curr_Factors:  [95.81556495]
mat_Sqrt:  [[0.15]]
grads:  [0.09500887]
Stock Position:  0.0950088701113373
Bond Position:  [-20.01918517]


portfolio before change:  [-10.80781722]
curr_Stock_Price:  96.97905571272561
curr_Factors:  [96.97905571]
mat_Sqrt:  [[0.15]]
grads:  [-0.07701149]
Stock Position:  -0.07701149403313184
Bond Position:  [-3.33931525]


portfolio before change:  [-10.77670403]
curr_Stock_Price:  96.56962813890021
curr_Factors:  [96.56962814]
mat_Sqrt:  [[0.15]]
grads:  [-0.05893618]
Stock Position:  -0.05893617830644099
Bond Position:  [-5.08525921]


portfolio before change:  [-10.70695392]
curr_Stock_Price:  95.37535644192126
curr_Factors:  [95.37535644]
mat_Sqrt:  [[0.15]]
grads:  [0.00225768]
Stock Position:  0.002257677158022102
Bond Position:  [-10.92228068]


portfolio before change:  [-10.70643891]
curr_Stock_Price:  96.20823934051495
curr_Factors:  [96.20823934]
mat_Sqrt:  [[0.15]]
grads:  [-0.05103731]
Stock Position:  -0.051037306439823675
Bond Position:  [-5.79622951]


portfolio before change:  [-10.66017803]
curr_Stock_Price:  95.28762932823308
curr_Factors:  [95.28762933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01865922]
Stock Position:  -0.018659216094236885
Bond Position:  [-8.88218556]


portfolio before change:  [-10.67362233]
curr_Stock_Price:  95.94864123517945
curr_Factors:  [95.94864124]
mat_Sqrt:  [[0.15]]
grads:  [0.00528662]
Stock Position:  0.005286617071279422
Bond Position:  [-11.18086606]


portfolio before change:  [-10.67347627]
curr_Stock_Price:  96.24065379265824
curr_Factors:  [96.24065379]
mat_Sqrt:  [[0.15]]
grads:  [0.09111397]
Stock Position:  0.09111397095984297
Bond Position:  [-19.4423444]


portfolio before change:  [-10.73983906]
curr_Stock_Price:  95.5389793780669
curr_Factors:  [95.53897938]
mat_Sqrt:  [[0.15]]
grads:  [0.03170767]
Stock Position:  0.031707668899529175
Bond Position:  [-13.76915738]


portfolio before change:  [-10.74478737]
curr_Stock_Price:  95.4372038689991
curr_Factors:  [95.43720387]
mat_Sqrt:  [[0.15]]
grads:  [0.03650354]
Stock Position:  0.03650353670224643
Bond Position:  [-14.22858285]


portfolio before change:  [-10.75353346]
curr_Stock_Price:  95.24633452404264
curr_Factors:  [95.24633452]
mat_Sqrt:  [[0.15]]
grads:  [0.01590609]
Stock Position:  0.015906088515325018
Bond Position:  [-12.26853009]


portfolio before change:  [-10.741781]
curr_Stock_Price:  96.08162026769872
curr_Factors:  [96.08162027]
mat_Sqrt:  [[0.15]]
grads:  [-0.02148369]
Stock Position:  -0.021483686138640067
Bond Position:  [-8.67759362]


portfolio before change:  [-10.74189755]
curr_Stock_Price:  96.03655278764406
curr_Factors:  [96.03655279]
mat_Sqrt:  [[0.15]]
grads:  [-0.00245155]
Stock Position:  -0.0024515511926688494
Bond Position:  [-10.50645902]


portfolio before change:  [-10.74181673]
curr_Stock_Price:  95.46784854657734
curr_Factors:  [95.46784855]
mat_Sqrt:  [[0.15]]
grads:  [-0.12037794]
Stock Position:  -0.12037794352812425
Bond Position:  [0.75040655]


portfolio before change:  [-10.93356849]
curr_Stock_Price:  97.06154223810843
curr_Factors:  [97.06154224]
mat_Sqrt:  [[0.15]]
grads:  [-0.20005511]
Stock Position:  -0.20005510533149434
Bond Position:  [8.48408856]


portfolio before change:  [-10.90369729]
curr_Stock_Price:  96.9175287700487
curr_Factors:  [96.91752877]
mat_Sqrt:  [[0.15]]
grads:  [0.14602555]
Stock Position:  0.14602555038386028
Bond Position:  [-25.05613277]


portfolio before change:  [-10.85430539]
curr_Stock_Price:  97.27721999415483
curr_Factors:  [97.27721999]
mat_Sqrt:  [[0.15]]
grads:  [0.02338915]
Stock Position:  0.02338914775722736
Bond Position:  [-13.12953666]


portfolio before change:  [-10.86736196]
curr_Stock_Price:  96.78916127577278
curr_Factors:  [96.78916128]
mat_Sqrt:  [[0.15]]
grads:  [-0.03895092]
Stock Position:  -0.03895091744067782
Bond Position:  [-7.09733533]


portfolio before change:  [-10.87781554]
curr_Stock_Price:  97.03476163656674
curr_Factors:  [97.03476164]
mat_Sqrt:  [[0.15]]
grads:  [-0.08358082]
Stock Position:  -0.0835808189879807
Bond Position:  [-2.76757069]


portfolio before change:  [-10.90735099]
curr_Stock_Price:  97.38399823829907
curr_Factors:  [97.38399824]
mat_Sqrt:  [[0.15]]
grads:  [-0.06917523]
Stock Position:  -0.0691752337269915
Bond Position:  [-4.17079015]


portfolio before change:  [-10.97173085]
curr_Stock_Price:  98.30713897607605
curr_Factors:  [98.30713898]
mat_Sqrt:  [[0.15]]
grads:  [-0.05435575]
Stock Position:  -0.05435575370335337
Bond Position:  [-5.62817222]


portfolio before change:  [-10.97436093]
curr_Stock_Price:  98.34258169178993
curr_Factors:  [98.34258169]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016814]
Stock Position:  -0.05016814315321606
Bond Position:  [-6.04069621]


portfolio before change:  [-10.90492409]
curr_Stock_Price:  96.94344727500346
curr_Factors:  [96.94344728]
mat_Sqrt:  [[0.15]]
grads:  [0.13599277]
Stock Position:  0.1359927714818152
Bond Position:  [-24.08853216]


portfolio before change:  [-11.06181323]
curr_Stock_Price:  95.81193205243873
curr_Factors:  [95.81193205]
mat_Sqrt:  [[0.15]]
grads:  [0.0627617]
Stock Position:  0.0627616996739176
Bond Position:  [-17.07513294]


portfolio before change:  [-11.09178766]
curr_Stock_Price:  95.36835099309394
curr_Factors:  [95.36835099]
mat_Sqrt:  [[0.15]]
grads:  [0.13210564]
Stock Position:  0.13210563764077515
Bond Position:  [-23.69048448]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.09178766]
Stock Price:  95.65228046320505
PL:  [-11.09178766]
Settle:  Tensor("sub_32:0", shape=(), dtype=float64)
PL:  Tensor("sub_33:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  17
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.23702223e-03]
 [ 5.44187285e-03]
 [ 1.25710191e-02]
 [-7.30535171e-03]
 [ 2.10868523e-02]
 [ 1.76416843e-02]
 [ 2.14300750e-02]
 [-3.07650727e-03]
 [ 1.78143796e-02]
 [-3.10358303e-04]
 [ 1.15017063e-02]
 [ 9.29750021e-04]
 [-6.31905029e-03]
 [ 1.05899330e-02]
 [-2.31430406e-03]
 [-1.13682259e-02]
 [ 8.25837155e-04]
 [-3.39659364e-03]
 [-7.89733422e-03]
 [-2.36061873e-03]
 [-7.73761791e-04]
 [ 4.76127410e-03]
 [ 4.78538792e-03]
 [ 7.03401479e-03]
 [-4.60004589e-03]
 [-6.37972605e-03]
 [ 2.23209319e-03]
 [-1.82467046e-02]
 [-1.57778317e-02]
 [ 2.21262978e-02]
 [ 8.78653301e-03]
 [ 1.03851436e-03]
 [-1.24759416e-02]
 [-6.34010956e-03]
 [-8.65347444e-03]
 [-7.52593069e-03]
 [ 2.25886983e-02]
 [ 8.33295424e-03]
 [ 2.29709932e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.46082145]
curr_Stock_Price:  99.78091544164975
curr_Factors:  [99.78091544]
mat_Sqrt:  [[0.15]]
grads:  [-0.01491348]
Stock Position:  -0.014913481560342843
Bond Position:  [0.02725939]


portfolio before change:  [-1.4561059]
curr_Stock_Price:  99.46495017271424
curr_Factors:  [99.46495017]
mat_Sqrt:  [[0.15]]
grads:  [0.03627915]
Stock Position:  0.03627915233191454
Bond Position:  [-5.06460998]


portfolio before change:  [-1.44627428]
curr_Stock_Price:  99.75340068971937
curr_Factors:  [99.75340069]
mat_Sqrt:  [[0.15]]
grads:  [0.08380679]
Stock Position:  0.08380679430622727
Bond Position:  [-9.80628701]


portfolio before change:  [-1.46787591]
curr_Stock_Price:  99.5102728480906
curr_Factors:  [99.51027285]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870234]
Stock Position:  -0.0487023447087183
Bond Position:  [3.3785077]


portfolio before change:  [-1.54472296]
curr_Stock_Price:  101.09683691742607
curr_Factors:  [101.09683692]
mat_Sqrt:  [[0.15]]
grads:  [0.14057902]
Stock Position:  0.14057901500797065
Bond Position:  [-15.75681671]


portfolio before change:  [-1.78961565]
curr_Stock_Price:  99.368819639896
curr_Factors:  [99.36881964]
mat_Sqrt:  [[0.15]]
grads:  [0.11761123]
Stock Position:  0.11761122857863782
Bond Position:  [-13.47650461]


portfolio before change:  [-1.79500347]
curr_Stock_Price:  99.33733322274837
curr_Factors:  [99.33733322]
mat_Sqrt:  [[0.15]]
grads:  [0.14286717]
Stock Position:  0.14286716647671718
Bond Position:  [-15.9870468]


portfolio before change:  [-1.79426603]
curr_Stock_Price:  99.35648350616779
curr_Factors:  [99.35648351]
mat_Sqrt:  [[0.15]]
grads:  [-0.02051005]
Stock Position:  -0.020510048482591428
Bond Position:  [0.24354026]


portfolio before change:  [-1.78880263]
curr_Stock_Price:  99.09159081889257
curr_Factors:  [99.09159082]
mat_Sqrt:  [[0.15]]
grads:  [0.11876253]
Stock Position:  0.1187625309778703
Bond Position:  [-13.55717075]


portfolio before change:  [-1.88862945]
curr_Stock_Price:  98.26530265979645
curr_Factors:  [98.26530266]
mat_Sqrt:  [[0.15]]
grads:  [-0.00206906]
Stock Position:  -0.002069055355799424
Bond Position:  [-1.6853131]


portfolio before change:  [-1.88912792]
curr_Stock_Price:  98.40439420713489
curr_Factors:  [98.40439421]
mat_Sqrt:  [[0.15]]
grads:  [0.07667804]
Stock Position:  0.07667804180868486
Bond Position:  [-9.43458417]


portfolio before change:  [-1.8905129]
curr_Stock_Price:  98.4017130364307
curr_Factors:  [98.40171304]
mat_Sqrt:  [[0.15]]
grads:  [0.00619833]
Stock Position:  0.006198333475044577
Bond Position:  [-2.50043953]


portfolio before change:  [-1.88444342]
curr_Stock_Price:  99.43135443807599
curr_Factors:  [99.43135444]
mat_Sqrt:  [[0.15]]
grads:  [-0.042127]
Stock Position:  -0.04212700195209458
Bond Position:  [2.30430145]


portfolio before change:  [-1.85578618]
curr_Stock_Price:  98.75793418073059
curr_Factors:  [98.75793418]
mat_Sqrt:  [[0.15]]
grads:  [0.07059955]
Stock Position:  0.07059955313306363
Bond Position:  [-8.8280522]


portfolio before change:  [-1.86684341]
curr_Stock_Price:  98.61694677973547
curr_Factors:  [98.61694678]
mat_Sqrt:  [[0.15]]
grads:  [-0.01542869]
Stock Position:  -0.015428693763324583
Bond Position:  [-0.34531273]


portfolio before change:  [-1.88085246]
curr_Stock_Price:  99.52213571547387
curr_Factors:  [99.52213572]
mat_Sqrt:  [[0.15]]
grads:  [-0.07578817]
Stock Position:  -0.07578817264828366
Bond Position:  [5.66174835]


portfolio before change:  [-1.8962955]
curr_Stock_Price:  99.73524024556635
curr_Factors:  [99.73524025]
mat_Sqrt:  [[0.15]]
grads:  [0.00550558]
Stock Position:  0.005505581034293711
Bond Position:  [-2.44539594]


portfolio before change:  [-1.89403329]
curr_Stock_Price:  100.2016578045274
curr_Factors:  [100.2016578]
mat_Sqrt:  [[0.15]]
grads:  [-0.02264396]
Stock Position:  -0.022643957598596737
Bond Position:  [0.3749288]


portfolio before change:  [-1.92403813]
curr_Stock_Price:  101.5287979413683
curr_Factors:  [101.52879794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05264889]
Stock Position:  -0.05264889477958528
Bond Position:  [3.42134087]


portfolio before change:  [-1.93473679]
curr_Stock_Price:  101.74012924997773
curr_Factors:  [101.74012925]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573746]
Stock Position:  -0.0157374581745161
Bond Position:  [-0.33360576]


portfolio before change:  [-1.94526126]
curr_Stock_Price:  102.40623207198884
curr_Factors:  [102.40623207]
mat_Sqrt:  [[0.15]]
grads:  [-0.00515841]
Stock Position:  -0.005158411937999933
Bond Position:  [-1.41700773]


portfolio before change:  [-1.93769712]
curr_Stock_Price:  100.90552206411641
curr_Factors:  [100.90552206]
mat_Sqrt:  [[0.15]]
grads:  [0.03174183]
Stock Position:  0.031741827332585446
Bond Position:  [-5.14062277]


portfolio before change:  [-1.91430817]
curr_Stock_Price:  101.66261662877513
curr_Factors:  [101.66261663]
mat_Sqrt:  [[0.15]]
grads:  [0.03190259]
Stock Position:  0.03190258610263411
Bond Position:  [-5.15760855]


portfolio before change:  [-1.94071525]
curr_Stock_Price:  100.85508538691738
curr_Factors:  [100.85508539]
mat_Sqrt:  [[0.15]]
grads:  [0.04689343]
Stock Position:  0.04689343192339288
Bond Position:  [-6.67015633]


portfolio before change:  [-1.97409369]
curr_Stock_Price:  100.16107298950463
curr_Factors:  [100.16107299]
mat_Sqrt:  [[0.15]]
grads:  [-0.03066697]
Stock Position:  -0.03066697260058704
Bond Position:  [1.09754319]


portfolio before change:  [-2.02046542]
curr_Stock_Price:  101.67765328870505
curr_Factors:  [101.67765329]
mat_Sqrt:  [[0.15]]
grads:  [-0.04253151]
Stock Position:  -0.04253150702435678
Bond Position:  [2.30403841]


portfolio before change:  [-2.0316919]
curr_Stock_Price:  101.94838206785046
curr_Factors:  [101.94838207]
mat_Sqrt:  [[0.15]]
grads:  [0.01488062]
Stock Position:  0.014880621248394114
Bond Position:  [-3.54874716]


portfolio before change:  [-2.04052723]
curr_Stock_Price:  101.3844463369794
curr_Factors:  [101.38444634]
mat_Sqrt:  [[0.15]]
grads:  [-0.1216447]
Stock Position:  -0.12164469763058987
Bond Position:  [10.29235309]


portfolio before change:  [-1.9996215]
curr_Stock_Price:  101.05875101032096
curr_Factors:  [101.05875101]
mat_Sqrt:  [[0.15]]
grads:  [-0.10518554]
Stock Position:  -0.1051855445651378
Bond Position:  [8.63029826]


portfolio before change:  [-2.01923203]
curr_Stock_Price:  101.25544520560001
curr_Factors:  [101.25544521]
mat_Sqrt:  [[0.15]]
grads:  [0.14750865]
Stock Position:  0.1475086519667478
Bond Position:  [-16.95528625]


portfolio before change:  [-2.16606898]
curr_Stock_Price:  100.27436775581646
curr_Factors:  [100.27436776]
mat_Sqrt:  [[0.15]]
grads:  [0.05857689]
Stock Position:  0.058576886756802955
Bond Position:  [-8.03982927]


portfolio before change:  [-2.19741267]
curr_Stock_Price:  99.75643918295701
curr_Factors:  [99.75643918]
mat_Sqrt:  [[0.15]]
grads:  [0.00692343]
Stock Position:  0.006923429056660211
Bond Position:  [-2.8880693]


portfolio before change:  [-2.1935464]
curr_Stock_Price:  100.36701779803414
curr_Factors:  [100.3670178]
mat_Sqrt:  [[0.15]]
grads:  [-0.08317294]
Stock Position:  -0.08317294370321453
Bond Position:  [6.15427392]


portfolio before change:  [-2.26790353]
curr_Stock_Price:  101.27027383648182
curr_Factors:  [101.27027384]
mat_Sqrt:  [[0.15]]
grads:  [-0.0422674]
Stock Position:  -0.04226739706777233
Bond Position:  [2.01252734]


portfolio before change:  [-2.19284147]
curr_Stock_Price:  99.50034045829312
curr_Factors:  [99.50034046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05768983]
Stock Position:  -0.057689829592642954
Bond Position:  [3.54731621]


portfolio before change:  [-2.15537599]
curr_Stock_Price:  98.8585975542228
curr_Factors:  [98.85859755]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017287]
Stock Position:  -0.05017287129090242
Bond Position:  [2.8046437]


portfolio before change:  [-2.19066537]
curr_Stock_Price:  99.56894111546653
curr_Factors:  [99.56894112]
mat_Sqrt:  [[0.15]]
grads:  [0.15059132]
Stock Position:  0.1505913216871095
Bond Position:  [-17.18488381]


portfolio before change:  [-2.41458164]
curr_Stock_Price:  98.0962929977699
curr_Factors:  [98.096293]
mat_Sqrt:  [[0.15]]
grads:  [0.05555303]
Stock Position:  0.055553028265176954
Bond Position:  [-7.86412778]


portfolio before change:  [-2.40294501]
curr_Stock_Price:  98.32345808942716
curr_Factors:  [98.32345809]
mat_Sqrt:  [[0.15]]
grads:  [0.15313995]
Stock Position:  0.15313995484466122
Bond Position:  [-17.46019494]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.40294501]
Stock Price:  98.79245944660357
PL:  [-2.40294501]
Settle:  Tensor("sub_34:0", shape=(), dtype=float64)
PL:  Tensor("sub_35:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  18
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45051450e-03]
 [ 5.11121381e-03]
 [ 1.21641214e-02]
 [-8.18602270e-03]
 [ 1.34201677e-02]
 [ 2.44486177e-02]
 [ 7.69865555e-03]
 [-3.53763615e-03]
 [ 4.77819362e-03]
 [-1.72909584e-04]
 [-4.43316991e-02]
 [-1.30950669e-02]
 [ 1.32910663e-02]
 [ 3.82563006e-03]
 [ 2.00058333e-02]
 [-8.21207970e-03]
 [-1.13740802e-02]
 [ 6.85210175e-04]
 [-7.72498297e-03]
 [-2.79952952e-03]
 [ 9.12769756e-04]
 [ 1.43611374e-02]
 [ 4.75834258e-03]
 [ 5.38582514e-03]
 [ 1.90170851e-03]
 [-1.26368382e-03]
 [ 5.18262146e-03]
 [-1.86762140e-02]
 [-2.85342791e-02]
 [ 2.17969440e-02]
 [ 2.63504068e-03]
 [-7.96783327e-03]
 [-1.24346602e-02]
 [-7.59506161e-03]
 [-6.37441121e-03]
 [-2.86558625e-03]
 [ 1.81422969e-02]
 [ 1.35357461e-02]
 [ 1.65451584e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.81031079]
curr_Stock_Price:  100.24933683600727
curr_Factors:  [100.24933684]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096701]
Stock Position:  -0.009670096647165146
Bond Position:  [6.77973156]


portfolio before change:  [5.81929302]
curr_Stock_Price:  99.40811320679768
curr_Factors:  [99.40811321]
mat_Sqrt:  [[0.15]]
grads:  [0.03407476]
Stock Position:  0.034074758714879964
Bond Position:  [2.43198555]


portfolio before change:  [5.83101358]
curr_Stock_Price:  99.74315713102162
curr_Factors:  [99.74315713]
mat_Sqrt:  [[0.15]]
grads:  [0.08109414]
Stock Position:  0.08109414282159347
Bond Position:  [-2.25757225]


portfolio before change:  [5.80617258]
curr_Stock_Price:  99.44031431835764
curr_Factors:  [99.44031432]
mat_Sqrt:  [[0.15]]
grads:  [-0.05457348]
Stock Position:  -0.05457348464093299
Bond Position:  [11.23297705]


portfolio before change:  [5.87768859]
curr_Stock_Price:  98.15559156938104
curr_Factors:  [98.15559157]
mat_Sqrt:  [[0.15]]
grads:  [0.08946778]
Stock Position:  0.08946778452434564
Bond Position:  [-2.90407472]


portfolio before change:  [5.78257977]
curr_Stock_Price:  97.09659825410384
curr_Factors:  [97.09659825]
mat_Sqrt:  [[0.15]]
grads:  [0.16299078]
Stock Position:  0.16299078435913025
Bond Position:  [-10.04327093]


portfolio before change:  [5.95392999]
curr_Stock_Price:  98.15558882651894
curr_Factors:  [98.15558883]
mat_Sqrt:  [[0.15]]
grads:  [0.05132437]
Stock Position:  0.05132437032625728
Bond Position:  [0.9161562]


portfolio before change:  [5.97232135]
curr_Stock_Price:  98.51169321890734
curr_Factors:  [98.51169322]
mat_Sqrt:  [[0.15]]
grads:  [-0.02358424]
Stock Position:  -0.023584240999785983
Bond Position:  [8.29564487]


portfolio before change:  [6.006573]
curr_Stock_Price:  97.10335318098988
curr_Factors:  [97.10335318]
mat_Sqrt:  [[0.15]]
grads:  [0.03185462]
Stock Position:  0.0318546241249409
Bond Position:  [2.91338219]


portfolio before change:  [6.03649676]
curr_Stock_Price:  98.03130532614466
curr_Factors:  [98.03130533]
mat_Sqrt:  [[0.15]]
grads:  [-0.00115273]
Stock Position:  -0.0011527305611223142
Bond Position:  [6.14950045]


portfolio before change:  [6.03852076]
curr_Stock_Price:  96.94236457828833
curr_Factors:  [96.94236458]
mat_Sqrt:  [[0.15]]
grads:  [-0.29554466]
Stock Position:  -0.2955446608637077
Bond Position:  [34.68931902]


portfolio before change:  [6.18974953]
curr_Stock_Price:  96.44534211161233
curr_Factors:  [96.44534211]
mat_Sqrt:  [[0.15]]
grads:  [-0.08730045]
Stock Position:  -0.0873004458527786
Bond Position:  [14.60947089]


portfolio before change:  [6.26010545]
curr_Stock_Price:  95.6603561471726
curr_Factors:  [95.66035615]
mat_Sqrt:  [[0.15]]
grads:  [0.08860711]
Stock Position:  0.0886071084389713
Bond Position:  [-2.2160821]


portfolio before change:  [6.30908748]
curr_Stock_Price:  96.21628279140363
curr_Factors:  [96.21628279]
mat_Sqrt:  [[0.15]]
grads:  [0.0255042]
Stock Position:  0.02550420038863032
Bond Position:  [3.85516812]


portfolio before change:  [6.27355903]
curr_Stock_Price:  94.80434408246607
curr_Factors:  [94.80434408]
mat_Sqrt:  [[0.15]]
grads:  [0.13337222]
Stock Position:  0.1333722220995062
Bond Position:  [-6.370707]


portfolio before change:  [6.41201851]
curr_Stock_Price:  95.84845850433425
curr_Factors:  [95.8484585]
mat_Sqrt:  [[0.15]]
grads:  [-0.0547472]
Stock Position:  -0.05474719798209534
Bond Position:  [11.65945304]


portfolio before change:  [6.45709074]
curr_Stock_Price:  95.05180202931443
curr_Factors:  [95.05180203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0758272]
Stock Position:  -0.0758272012122816
Bond Position:  [13.66460286]


portfolio before change:  [6.54140132]
curr_Stock_Price:  93.96245154178463
curr_Factors:  [93.96245154]
mat_Sqrt:  [[0.15]]
grads:  [0.00456807]
Stock Position:  0.004568067833204435
Bond Position:  [6.11217447]


portfolio before change:  [6.54692796]
curr_Stock_Price:  95.00503054018093
curr_Factors:  [95.00503054]
mat_Sqrt:  [[0.15]]
grads:  [-0.05149989]
Stock Position:  -0.05149988648667938
Bond Position:  [11.43967625]


portfolio before change:  [6.53400637]
curr_Stock_Price:  95.28370373409977
curr_Factors:  [95.28370373]
mat_Sqrt:  [[0.15]]
grads:  [-0.01866353]
Stock Position:  -0.01866353012926589
Bond Position:  [8.31233665]


portfolio before change:  [6.53318386]
curr_Stock_Price:  95.38345002113283
curr_Factors:  [95.38345002]
mat_Sqrt:  [[0.15]]
grads:  [0.00608513]
Stock Position:  0.006085131708513579
Bond Position:  [5.952763]


portfolio before change:  [6.53543898]
curr_Stock_Price:  95.63175592393061
curr_Factors:  [95.63175592]
mat_Sqrt:  [[0.15]]
grads:  [0.09574092]
Stock Position:  0.09574091578443972
Bond Position:  [-2.62043291]


portfolio before change:  [6.67776259]
curr_Stock_Price:  97.12172694366657
curr_Factors:  [97.12172694]
mat_Sqrt:  [[0.15]]
grads:  [0.03172228]
Stock Position:  0.03172228383532398
Bond Position:  [3.5968396]


portfolio before change:  [6.66222713]
curr_Stock_Price:  96.61781933853516
curr_Factors:  [96.61781934]
mat_Sqrt:  [[0.15]]
grads:  [0.0359055]
Stock Position:  0.03590550093975125
Bond Position:  [3.19311592]


portfolio before change:  [6.62109082]
curr_Stock_Price:  95.46101961949961
curr_Factors:  [95.46101962]
mat_Sqrt:  [[0.15]]
grads:  [0.01267806]
Stock Position:  0.012678056724209994
Bond Position:  [5.41083059]


portfolio before change:  [6.60902398]
curr_Stock_Price:  94.45587872330726
curr_Factors:  [94.45587872]
mat_Sqrt:  [[0.15]]
grads:  [-0.00842456]
Stock Position:  -0.008424558815130536
Bond Position:  [7.40477308]


portfolio before change:  [6.60501163]
curr_Stock_Price:  95.04202228001722
curr_Factors:  [95.04202228]
mat_Sqrt:  [[0.15]]
grads:  [0.03455081]
Stock Position:  0.03455080976245806
Bond Position:  [3.3212328]


portfolio before change:  [6.60140951]
curr_Stock_Price:  94.92574985919865
curr_Factors:  [94.92574986]
mat_Sqrt:  [[0.15]]
grads:  [-0.12450809]
Stock Position:  -0.12450809359607627
Bond Position:  [18.42043365]


portfolio before change:  [6.46484661]
curr_Stock_Price:  96.04106362436805
curr_Factors:  [96.04106362]
mat_Sqrt:  [[0.15]]
grads:  [-0.19022853]
Stock Position:  -0.19022852733613535
Bond Position:  [24.73459671]


portfolio before change:  [6.56503999]
curr_Stock_Price:  95.53061779172174
curr_Factors:  [95.53061779]
mat_Sqrt:  [[0.15]]
grads:  [0.14531296]
Stock Position:  0.14531296016530745
Bond Position:  [-7.31679687]


portfolio before change:  [6.50803273]
curr_Stock_Price:  95.14460541082842
curr_Factors:  [95.14460541]
mat_Sqrt:  [[0.15]]
grads:  [0.01756694]
Stock Position:  0.017566937889019613
Bond Position:  [4.83663336]


portfolio before change:  [6.51663093]
curr_Stock_Price:  95.59964094461677
curr_Factors:  [95.59964094]
mat_Sqrt:  [[0.15]]
grads:  [-0.05311889]
Stock Position:  -0.05311888847855567
Bond Position:  [11.5947776]


portfolio before change:  [6.50924514]
curr_Stock_Price:  95.76597030422134
curr_Factors:  [95.7659703]
mat_Sqrt:  [[0.15]]
grads:  [-0.08289773]
Stock Position:  -0.08289773451809584
Bond Position:  [14.44802712]


portfolio before change:  [6.57568536]
curr_Stock_Price:  94.98628542557952
curr_Factors:  [94.98628543]
mat_Sqrt:  [[0.15]]
grads:  [-0.05063374]
Stock Position:  -0.050633744034602385
Bond Position:  [11.38519663]


portfolio before change:  [6.60614513]
curr_Stock_Price:  94.41282342388071
curr_Factors:  [94.41282342]
mat_Sqrt:  [[0.15]]
grads:  [-0.04249607]
Stock Position:  -0.042496074719523005
Bond Position:  [10.61831953]


portfolio before change:  [6.62479854]
curr_Stock_Price:  94.00511435983891
curr_Factors:  [94.00511436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910391]
Stock Position:  -0.019103908335697896
Bond Position:  [8.42066363]


portfolio before change:  [6.63607227]
curr_Stock_Price:  93.47008876899659
curr_Factors:  [93.47008877]
mat_Sqrt:  [[0.15]]
grads:  [0.12094865]
Stock Position:  0.12094864600464379
Bond Position:  [-4.66900841]


portfolio before change:  [6.5218349]
curr_Stock_Price:  92.53040311466863
curr_Factors:  [92.53040311]
mat_Sqrt:  [[0.15]]
grads:  [0.09023831]
Stock Position:  0.09023830724310046
Bond Position:  [-1.82795205]


portfolio before change:  [6.55772632]
curr_Stock_Price:  92.93067587493358
curr_Factors:  [92.93067587]
mat_Sqrt:  [[0.15]]
grads:  [0.11030106]
Stock Position:  0.11030105577615293
Bond Position:  [-3.69262534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.55772632]
Stock Price:  91.5707922729516
PL:  [6.55772632]
Settle:  Tensor("sub_36:0", shape=(), dtype=float64)
PL:  Tensor("sub_37:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  19
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.88346258e-03]
 [-8.27879930e-04]
 [ 2.26029832e-02]
 [-5.01326522e-03]
 [ 1.89596118e-02]
 [ 2.59427936e-02]
 [ 2.33059795e-02]
 [-3.20389813e-04]
 [ 1.01676002e-02]
 [ 1.22407314e-02]
 [ 2.19489989e-02]
 [-1.04905879e-02]
 [-1.21050909e-02]
 [-1.02190668e-02]
 [ 2.16919093e-03]
 [-3.28636606e-02]
 [ 4.62952014e-03]
 [-1.52734445e-02]
 [ 1.42720991e-02]
 [-4.98438821e-03]
 [-2.53794800e-03]
 [-3.93722825e-02]
 [ 4.84281596e-03]
 [ 1.28949979e-02]
 [-5.76131429e-03]
 [ 1.29726503e-02]
 [-1.32182931e-02]
 [ 9.23497812e-03]
 [ 7.52867575e-02]
 [ 2.77570541e-02]
 [-3.43326172e-02]
 [ 1.89485613e-03]
 [-1.33333814e-02]
 [ 5.04537762e-03]
 [-6.94688399e-03]
 [ 3.99070372e-03]
 [ 2.44088301e-02]
 [ 7.09402684e-03]
 [ 1.87372828e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.33358887]
curr_Stock_Price:  99.89651507003516
curr_Factors:  [99.89651507]
mat_Sqrt:  [[0.15]]
grads:  [-0.01255642]
Stock Position:  -0.012556417226918146
Bond Position:  [1.58793119]


portfolio before change:  [0.34395319]
curr_Stock_Price:  99.08690357829431
curr_Factors:  [99.08690358]
mat_Sqrt:  [[0.15]]
grads:  [-0.0055192]
Stock Position:  -0.005519199533102782
Bond Position:  [0.89083358]


portfolio before change:  [0.33808409]
curr_Stock_Price:  100.17047744863198
curr_Factors:  [100.17047745]
mat_Sqrt:  [[0.15]]
grads:  [0.15068655]
Stock Position:  0.15068655439627665
Bond Position:  [-14.75626001]


portfolio before change:  [0.30602289]
curr_Stock_Price:  99.96995157864889
curr_Factors:  [99.96995158]
mat_Sqrt:  [[0.15]]
grads:  [-0.03342177]
Stock Position:  -0.03342176810667656
Bond Position:  [3.64719543]


portfolio before change:  [0.26314976]
curr_Stock_Price:  101.26638397227975
curr_Factors:  [101.26638397]
mat_Sqrt:  [[0.15]]
grads:  [0.12639741]
Stock Position:  0.12639741228975804
Bond Position:  [-12.53665913]


portfolio before change:  [0.22273434]
curr_Stock_Price:  100.9590340661959
curr_Factors:  [100.95903407]
mat_Sqrt:  [[0.15]]
grads:  [0.17295196]
Stock Position:  0.17295195747690442
Bond Position:  [-17.23832822]


portfolio before change:  [0.21778462]
curr_Stock_Price:  100.94287465771643
curr_Factors:  [100.94287466]
mat_Sqrt:  [[0.15]]
grads:  [0.1553732]
Stock Position:  0.1553731968119632
Bond Position:  [-15.46603251]


portfolio before change:  [0.34073787]
curr_Stock_Price:  101.74665955558558
curr_Factors:  [101.74665956]
mat_Sqrt:  [[0.15]]
grads:  [-0.00213593]
Stock Position:  -0.0021359320871592448
Bond Position:  [0.55806183]


portfolio before change:  [0.33861488]
curr_Stock_Price:  102.77326199496649
curr_Factors:  [102.77326199]
mat_Sqrt:  [[0.15]]
grads:  [0.067784]
Stock Position:  0.06778400108449627
Bond Position:  [-6.62776802]


portfolio before change:  [0.32789242]
curr_Stock_Price:  102.62729930576126
curr_Factors:  [102.62729931]
mat_Sqrt:  [[0.15]]
grads:  [0.08160488]
Stock Position:  0.08160487595441096
Bond Position:  [-8.04699561]


portfolio before change:  [0.41056554]
curr_Stock_Price:  103.6527166240218
curr_Factors:  [103.65271662]
mat_Sqrt:  [[0.15]]
grads:  [0.14632666]
Stock Position:  0.1463266590600467
Bond Position:  [-14.75659019]


portfolio before change:  [0.49330049]
curr_Stock_Price:  104.23073598027376
curr_Factors:  [104.23073598]
mat_Sqrt:  [[0.15]]
grads:  [-0.06993725]
Stock Position:  -0.06993725251835284
Bond Position:  [7.78291179]


portfolio before change:  [0.43630058]
curr_Stock_Price:  105.05966234451428
curr_Factors:  [105.05966234]
mat_Sqrt:  [[0.15]]
grads:  [-0.08070061]
Stock Position:  -0.08070060595585615
Bond Position:  [8.91467899]


portfolio before change:  [0.42227005]
curr_Stock_Price:  105.24733048285434
curr_Factors:  [105.24733048]
mat_Sqrt:  [[0.15]]
grads:  [-0.06812711]
Stock Position:  -0.06812711193363888
Bond Position:  [7.59246672]


portfolio before change:  [0.48294385]
curr_Stock_Price:  104.37066517410939
curr_Factors:  [104.37066517]
mat_Sqrt:  [[0.15]]
grads:  [0.01446127]
Stock Position:  0.014461272861033837
Bond Position:  [-1.02638882]


portfolio before change:  [0.49486422]
curr_Stock_Price:  105.20383412300616
curr_Factors:  [105.20383412]
mat_Sqrt:  [[0.15]]
grads:  [-0.21909107]
Stock Position:  -0.2190910706842925
Bond Position:  [23.54408488]


portfolio before change:  [0.24887321]
curr_Stock_Price:  106.34004751038216
curr_Factors:  [106.34004751]
mat_Sqrt:  [[0.15]]
grads:  [0.03086347]
Stock Position:  0.030863467629815892
Bond Position:  [-3.0331494]


portfolio before change:  [0.27338505]
curr_Stock_Price:  107.14653533754775
curr_Factors:  [107.14653534]
mat_Sqrt:  [[0.15]]
grads:  [-0.10182296]
Stock Position:  -0.10182296341026241
Bond Position:  [11.1833628]


portfolio before change:  [0.35531786]
curr_Stock_Price:  106.35560567953037
curr_Factors:  [106.35560568]
mat_Sqrt:  [[0.15]]
grads:  [0.09514733]
Stock Position:  0.09514732736537627
Bond Position:  [-9.76413377]


portfolio before change:  [0.40516567]
curr_Stock_Price:  106.8923354000298
curr_Factors:  [106.8923354]
mat_Sqrt:  [[0.15]]
grads:  [-0.03322925]
Stock Position:  -0.03322925476164327
Bond Position:  [3.95711831]


portfolio before change:  [0.44025503]
curr_Stock_Price:  105.85124392160141
curr_Factors:  [105.85124392]
mat_Sqrt:  [[0.15]]
grads:  [-0.01691965]
Stock Position:  -0.016919653311801525
Bond Position:  [2.23122138]


portfolio before change:  [0.44054042]
curr_Stock_Price:  105.85086163963943
curr_Factors:  [105.85086164]
mat_Sqrt:  [[0.15]]
grads:  [-0.26248188]
Stock Position:  -0.26248188302976394
Bond Position:  [28.22447391]


portfolio before change:  [0.1903368]
curr_Stock_Price:  106.81752607779036
curr_Factors:  [106.81752608]
mat_Sqrt:  [[0.15]]
grads:  [0.03228544]
Stock Position:  0.03228543973752802
Bond Position:  [-3.258314]


portfolio before change:  [0.19135754]
curr_Stock_Price:  106.86175826637415
curr_Factors:  [106.86175827]
mat_Sqrt:  [[0.15]]
grads:  [0.08596665]
Stock Position:  0.08596665275956347
Bond Position:  [-8.99519012]


portfolio before change:  [0.1239685]
curr_Stock_Price:  106.09094105955012
curr_Factors:  [106.09094106]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840876]
Stock Position:  -0.03840876191353223
Bond Position:  [4.19879019]


portfolio before change:  [0.11570671]
curr_Stock_Price:  106.31970831250234
curr_Factors:  [106.31970831]
mat_Sqrt:  [[0.15]]
grads:  [0.08648434]
Stock Position:  0.08648433556373732
Bond Position:  [-9.07928262]


portfolio before change:  [0.13290618]
curr_Stock_Price:  106.53170562558083
curr_Factors:  [106.53170563]
mat_Sqrt:  [[0.15]]
grads:  [-0.08812195]
Stock Position:  -0.0881219538071725
Bond Position:  [9.52068822]


portfolio before change:  [0.10274508]
curr_Stock_Price:  106.88747688837488
curr_Factors:  [106.88747689]
mat_Sqrt:  [[0.15]]
grads:  [0.06156652]
Stock Position:  0.06156652079017891
Bond Position:  [-6.47794499]


portfolio before change:  [0.14644003]
curr_Stock_Price:  107.61034936547105
curr_Factors:  [107.61034937]
mat_Sqrt:  [[0.15]]
grads:  [0.50191172]
Stock Position:  0.5019117167272621
Bond Position:  [-53.86445516]


portfolio before change:  [0.31528777]
curr_Stock_Price:  107.96017426710931
curr_Factors:  [107.96017427]
mat_Sqrt:  [[0.15]]
grads:  [0.18504703]
Stock Position:  0.18504702720227365
Bond Position:  [-19.66242154]


portfolio before change:  [0.22648307]
curr_Stock_Price:  107.49355374430061
curr_Factors:  [107.49355374]
mat_Sqrt:  [[0.15]]
grads:  [-0.22888411]
Stock Position:  -0.2288841149546599
Bond Position:  [24.83004998]


portfolio before change:  [0.04372353]
curr_Stock_Price:  108.30559564215471
curr_Factors:  [108.30559564]
mat_Sqrt:  [[0.15]]
grads:  [0.01263237]
Stock Position:  0.012632374233069905
Bond Position:  [-1.32443329]


portfolio before change:  [0.04829112]
curr_Stock_Price:  108.68027980347551
curr_Factors:  [108.6802798]
mat_Sqrt:  [[0.15]]
grads:  [-0.08888921]
Stock Position:  -0.08888920966391463
Bond Position:  [9.70879529]


portfolio before change:  [0.20192526]
curr_Stock_Price:  106.96555574292383
curr_Factors:  [106.96555574]
mat_Sqrt:  [[0.15]]
grads:  [0.03363585]
Stock Position:  0.033635850799180744
Bond Position:  [-3.39595222]


portfolio before change:  [0.19447579]
curr_Stock_Price:  106.75670276443195
curr_Factors:  [106.75670276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04631256]
Stock Position:  -0.046312559927789675
Bond Position:  [5.13865198]


portfolio before change:  [0.21665452]
curr_Stock_Price:  106.29168086177464
curr_Factors:  [106.29168086]
mat_Sqrt:  [[0.15]]
grads:  [0.02660469]
Stock Position:  0.026604691463780496
Bond Position:  [-2.61120286]


portfolio before change:  [0.21102567]
curr_Stock_Price:  106.09237672754291
curr_Factors:  [106.09237673]
mat_Sqrt:  [[0.15]]
grads:  [0.16272553]
Stock Position:  0.16272553403389226
Bond Position:  [-17.05291299]


portfolio before change:  [0.36534562]
curr_Stock_Price:  107.05382202331407
curr_Factors:  [107.05382202]
mat_Sqrt:  [[0.15]]
grads:  [0.04729351]
Stock Position:  0.04729351224308261
Bond Position:  [-4.69760562]


portfolio before change:  [0.38072645]
curr_Stock_Price:  107.39145946952391
curr_Factors:  [107.39145947]
mat_Sqrt:  [[0.15]]
grads:  [0.12491522]
Stock Position:  0.12491521875019784
Bond Position:  [-13.03410121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.38072645]
Stock Price:  107.48836999394123
PL:  [-7.10764355]
Settle:  Tensor("sub_38:0", shape=(), dtype=float64)
PL:  Tensor("sub_39:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  20
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.33722737e-03]
 [-1.35963723e-02]
 [-5.69959534e-02]
 [-3.35918194e-02]
 [-2.36455281e-02]
 [ 2.51394250e-02]
 [-5.66631527e-04]
 [-1.57013126e-02]
 [-2.74218290e-02]
 [ 1.68283390e-03]
 [-2.08453051e-01]
 [-4.30777034e-02]
 [ 1.75232385e-02]
 [-8.01448592e-04]
 [ 2.78078499e-02]
 [-3.74801027e-04]
 [-1.54689321e-02]
 [ 6.94510776e-04]
 [-7.77607620e-03]
 [-2.86427173e-03]
 [ 9.70970740e-04]
 [ 1.35851819e-02]
 [ 4.75684460e-03]
 [ 5.48443299e-03]
 [ 3.02207674e-03]
 [-1.32406428e-03]
 [ 1.25132489e-02]
 [-2.00891817e-02]
 [-2.34923295e-02]
 [ 2.14187102e-02]
 [ 2.57511406e-03]
 [-1.45858267e-02]
 [-1.22540923e-02]
 [-8.38719767e-03]
 [-6.49646865e-03]
 [-4.18091749e-03]
 [ 1.93958645e-02]
 [ 9.59435088e-03]
 [ 1.95569302e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.04031658]
curr_Stock_Price:  99.09936246027068
curr_Factors:  [99.09936246]
mat_Sqrt:  [[0.15]]
grads:  [-0.03558152]
Stock Position:  -0.0355815157832304
Bond Position:  [-8.51421105]


portfolio before change:  [-11.98307994]
curr_Stock_Price:  97.46084368689259
curr_Factors:  [97.46084369]
mat_Sqrt:  [[0.15]]
grads:  [-0.09064248]
Stock Position:  -0.09064248208675711
Bond Position:  [-3.14898716]


portfolio before change:  [-11.89596399]
curr_Stock_Price:  96.49540680610144
curr_Factors:  [96.49540681]
mat_Sqrt:  [[0.15]]
grads:  [-0.37997302]
Stock Position:  -0.37997302275056416
Bond Position:  [24.76968742]


portfolio before change:  [-11.80827523]
curr_Stock_Price:  96.272779539375
curr_Factors:  [96.27277954]
mat_Sqrt:  [[0.15]]
grads:  [-0.22394546]
Stock Position:  -0.22394546272582255
Bond Position:  [9.75157693]


portfolio before change:  [-11.69776641]
curr_Stock_Price:  95.78475985700999
curr_Factors:  [95.78475986]
mat_Sqrt:  [[0.15]]
grads:  [-0.15763685]
Stock Position:  -0.15763685404194244
Bond Position:  [3.4014418]


portfolio before change:  [-11.68913035]
curr_Stock_Price:  95.73267271060229
curr_Factors:  [95.73267271]
mat_Sqrt:  [[0.15]]
grads:  [0.16759617]
Stock Position:  0.16759616651697948
Bond Position:  [-27.73355931]


portfolio before change:  [-11.64183137]
curr_Stock_Price:  96.03557877005233
curr_Factors:  [96.03557877]
mat_Sqrt:  [[0.15]]
grads:  [-0.00377754]
Stock Position:  -0.003777543514305257
Bond Position:  [-11.27905279]


portfolio before change:  [-11.6383005]
curr_Stock_Price:  94.72762861625084
curr_Factors:  [94.72762862]
mat_Sqrt:  [[0.15]]
grads:  [-0.10467542]
Stock Position:  -0.10467541731785247
Bond Position:  [-1.72264644]


portfolio before change:  [-11.49372049]
curr_Stock_Price:  93.344349125869
curr_Factors:  [93.34434913]
mat_Sqrt:  [[0.15]]
grads:  [-0.18281219]
Stock Position:  -0.18281219339403437
Bond Position:  [5.57076472]


portfolio before change:  [-11.41324335]
curr_Stock_Price:  92.90794086915977
curr_Factors:  [92.90794087]
mat_Sqrt:  [[0.15]]
grads:  [0.01121889]
Stock Position:  0.01121889267611315
Bond Position:  [-12.45556756]


portfolio before change:  [-11.41669883]
curr_Stock_Price:  92.73872256422253
curr_Factors:  [92.73872256]
mat_Sqrt:  [[0.15]]
grads:  [-1.38968701]
Stock Position:  -1.3896870081859896
Bond Position:  [117.46109907]


portfolio before change:  [-11.33703301]
curr_Stock_Price:  92.69196220245075
curr_Factors:  [92.6919622]
mat_Sqrt:  [[0.15]]
grads:  [-0.28718469]
Stock Position:  -0.2871846894308985
Bond Position:  [15.28267937]


portfolio before change:  [-11.71364324]
curr_Stock_Price:  94.0100014313391
curr_Factors:  [94.01000143]
mat_Sqrt:  [[0.15]]
grads:  [0.11682159]
Stock Position:  0.11682158980469105
Bond Position:  [-22.69604107]


portfolio before change:  [-11.63781944]
curr_Stock_Price:  94.6833442820021
curr_Factors:  [94.68334428]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534299]
Stock Position:  -0.005342990612914404
Bond Position:  [-11.13192722]


portfolio before change:  [-11.63253215]
curr_Stock_Price:  93.43331998906541
curr_Factors:  [93.43331999]
mat_Sqrt:  [[0.15]]
grads:  [0.18538567]
Stock Position:  0.1853856660296435
Bond Position:  [-28.95373041]


portfolio before change:  [-11.64616368]
curr_Stock_Price:  93.3793131911366
curr_Factors:  [93.37931319]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249867]
Stock Position:  -0.002498673514252879
Bond Position:  [-11.41283926]


portfolio before change:  [-11.64563991]
curr_Stock_Price:  92.5987147167932
curr_Factors:  [92.59871472]
mat_Sqrt:  [[0.15]]
grads:  [-0.10312621]
Stock Position:  -0.10312621374352014
Bond Position:  [-2.09628507]


portfolio before change:  [-11.78262862]
curr_Stock_Price:  93.92453337959068
curr_Factors:  [93.92453338]
mat_Sqrt:  [[0.15]]
grads:  [0.00463007]
Stock Position:  0.004630071842352137
Bond Position:  [-12.21750596]


portfolio before change:  [-11.7832553]
curr_Stock_Price:  94.11904596606016
curr_Factors:  [94.11904597]
mat_Sqrt:  [[0.15]]
grads:  [-0.05184051]
Stock Position:  -0.05184050798620345
Bond Position:  [-6.90407615]


portfolio before change:  [-11.82413437]
curr_Stock_Price:  94.89095211525375
curr_Factors:  [94.89095212]
mat_Sqrt:  [[0.15]]
grads:  [-0.01909514]
Stock Position:  -0.019095144856583143
Bond Position:  [-10.0121779]


portfolio before change:  [-11.8301093]
curr_Stock_Price:  95.13830956344876
curr_Factors:  [95.13830956]
mat_Sqrt:  [[0.15]]
grads:  [0.00647314]
Stock Position:  0.0064731382671391145
Bond Position:  [-12.44595273]


portfolio before change:  [-11.82406432]
curr_Stock_Price:  96.31251845639943
curr_Factors:  [96.31251846]
mat_Sqrt:  [[0.15]]
grads:  [0.09056788]
Stock Position:  0.09056787965119158
Bond Position:  [-20.5468849]


portfolio before change:  [-11.85129435]
curr_Stock_Price:  96.04021985947425
curr_Factors:  [96.04021986]
mat_Sqrt:  [[0.15]]
grads:  [0.0317123]
Stock Position:  0.03171229730497597
Bond Position:  [-14.89695036]


portfolio before change:  [-11.87599521]
curr_Stock_Price:  95.32003801663701
curr_Factors:  [95.32003802]
mat_Sqrt:  [[0.15]]
grads:  [0.03656289]
Stock Position:  0.03656288656819668
Bond Position:  [-15.36117094]


portfolio before change:  [-11.89092321]
curr_Stock_Price:  94.96427448818942
curr_Factors:  [94.96427449]
mat_Sqrt:  [[0.15]]
grads:  [0.02014718]
Stock Position:  0.02014717828822806
Bond Position:  [-13.80418538]


portfolio before change:  [-11.90196445]
curr_Stock_Price:  94.50189680690474
curr_Factors:  [94.50189681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0088271]
Stock Position:  -0.008827095231779502
Bond Position:  [-11.06778721]


portfolio before change:  [-11.89647046]
curr_Stock_Price:  93.72275635657813
curr_Factors:  [93.72275636]
mat_Sqrt:  [[0.15]]
grads:  [0.08342166]
Stock Position:  0.08342165916869537
Bond Position:  [-19.7149783]


portfolio before change:  [-11.90172051]
curr_Stock_Price:  93.68936552318532
curr_Factors:  [93.68936552]
mat_Sqrt:  [[0.15]]
grads:  [-0.13392788]
Stock Position:  -0.13392787816351764
Bond Position:  [0.64589742]


portfolio before change:  [-12.01838878]
curr_Stock_Price:  94.56109598965416
curr_Factors:  [94.56109599]
mat_Sqrt:  [[0.15]]
grads:  [-0.15661553]
Stock Position:  -0.15661553025210395
Bond Position:  [2.79134741]


portfolio before change:  [-11.95031591]
curr_Stock_Price:  94.12867443696106
curr_Factors:  [94.12867444]
mat_Sqrt:  [[0.15]]
grads:  [0.1427914]
Stock Position:  0.14279140101010476
Bond Position:  [-25.39108121]


portfolio before change:  [-12.08397041]
curr_Stock_Price:  93.2148910039073
curr_Factors:  [93.214891]
mat_Sqrt:  [[0.15]]
grads:  [0.01716743]
Stock Position:  0.017167427071235742
Bond Position:  [-13.68423025]


portfolio before change:  [-12.09621664]
curr_Stock_Price:  92.60119419169966
curr_Factors:  [92.60119419]
mat_Sqrt:  [[0.15]]
grads:  [-0.09723884]
Stock Position:  -0.09723884493834334
Bond Position:  [-3.09178348]


portfolio before change:  [-12.19438967]
curr_Stock_Price:  93.60682660983555
curr_Factors:  [93.60682661]
mat_Sqrt:  [[0.15]]
grads:  [-0.08169395]
Stock Position:  -0.08169394881327822
Bond Position:  [-4.54727837]


portfolio before change:  [-12.34283777]
curr_Stock_Price:  95.41699312485515
curr_Factors:  [95.41699312]
mat_Sqrt:  [[0.15]]
grads:  [-0.05591465]
Stock Position:  -0.055914651114231176
Bond Position:  [-7.00762989]


portfolio before change:  [-12.3846949]
curr_Stock_Price:  96.14991587707817
curr_Factors:  [96.14991588]
mat_Sqrt:  [[0.15]]
grads:  [-0.04330979]
Stock Position:  -0.04330979102484872
Bond Position:  [-8.22046213]


portfolio before change:  [-12.3413943]
curr_Stock_Price:  95.12640087877789
curr_Factors:  [95.12640088]
mat_Sqrt:  [[0.15]]
grads:  [-0.02787278]
Stock Position:  -0.027872783259846774
Bond Position:  [-9.68995674]


portfolio before change:  [-12.36130871]
curr_Stock_Price:  95.79741720461185
curr_Factors:  [95.7974172]
mat_Sqrt:  [[0.15]]
grads:  [0.12930576]
Stock Position:  0.12930576331389862
Bond Position:  [-24.74846686]


portfolio before change:  [-12.38729255]
curr_Stock_Price:  95.62039427236378
curr_Factors:  [95.62039427]
mat_Sqrt:  [[0.15]]
grads:  [0.06396234]
Stock Position:  0.06396233916860394
Bond Position:  [-18.50339664]


portfolio before change:  [-12.41806984]
curr_Stock_Price:  95.17537882224038
curr_Factors:  [95.17537882]
mat_Sqrt:  [[0.15]]
grads:  [0.13037953]
Stock Position:  0.13037953498434482
Bond Position:  [-24.82699148]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.41806984]
Stock Price:  95.81140426459795
PL:  [-12.41806984]
Settle:  Tensor("sub_40:0", shape=(), dtype=float64)
PL:  Tensor("sub_41:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  21
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.19409593e-03]
 [-1.31331099e-02]
 [ 2.29341890e-02]
 [ 1.65533714e-02]
 [ 6.40201819e-03]
 [ 2.34112500e-02]
 [ 1.92108756e-02]
 [ 4.33190156e-04]
 [ 4.88253150e-03]
 [ 1.11200371e-02]
 [ 2.69642453e-02]
 [ 1.12998014e-03]
 [-1.24736344e-02]
 [ 3.30418107e-03]
 [ 3.65624183e-04]
 [-3.05977880e-02]
 [ 4.94147876e-03]
 [-8.70750954e-03]
 [ 5.56774961e-03]
 [-3.29787584e-03]
 [-1.88782079e-03]
 [-3.95800772e-02]
 [ 4.81325590e-03]
 [ 1.01222922e-02]
 [-5.67624525e-03]
 [ 1.66144198e-02]
 [-1.64562965e-02]
 [ 1.50093131e-02]
 [ 8.00882331e-02]
 [ 2.72175174e-02]
 [-4.33458797e-02]
 [ 3.47487286e-04]
 [-1.33382842e-02]
 [ 1.00436143e-02]
 [-8.43987702e-03]
 [ 1.11612300e-02]
 [ 2.50926427e-02]
 [ 1.35195289e-02]
 [ 1.78455294e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-10.42089067]
curr_Stock_Price:  99.20368923040208
curr_Factors:  [99.20368923]
mat_Sqrt:  [[0.15]]
grads:  [-0.03462731]
Stock Position:  -0.03462730617480154
Bond Position:  [-6.98573415]


portfolio before change:  [-10.46631891]
curr_Stock_Price:  100.49038969635671
curr_Factors:  [100.4903897]
mat_Sqrt:  [[0.15]]
grads:  [-0.08755407]
Stock Position:  -0.0875540661610159
Bond Position:  [-1.66797668]


portfolio before change:  [-10.44016743]
curr_Stock_Price:  100.18931871982684
curr_Factors:  [100.18931872]
mat_Sqrt:  [[0.15]]
grads:  [0.15289459]
Stock Position:  0.1528945935317803
Bond Position:  [-25.75857259]


portfolio before change:  [-10.3204608]
curr_Stock_Price:  100.99331481118882
curr_Factors:  [100.99331481]
mat_Sqrt:  [[0.15]]
grads:  [0.11035581]
Stock Position:  0.1103558095618461
Bond Position:  [-21.46565982]


portfolio before change:  [-10.46077885]
curr_Stock_Price:  99.74612470384709
curr_Factors:  [99.7461247]
mat_Sqrt:  [[0.15]]
grads:  [0.04268012]
Stock Position:  0.042680121243058394
Bond Position:  [-14.71795554]


portfolio before change:  [-10.4195499]
curr_Stock_Price:  100.7552316725614
curr_Factors:  [100.75523167]
mat_Sqrt:  [[0.15]]
grads:  [0.156075]
Stock Position:  0.15607499982443784
Bond Position:  [-26.14492267]


portfolio before change:  [-10.34728763]
curr_Stock_Price:  101.23916943099275
curr_Factors:  [101.23916943]
mat_Sqrt:  [[0.15]]
grads:  [0.1280725]
Stock Position:  0.12807250394832057
Bond Position:  [-23.31324156]


portfolio before change:  [-10.22163353]
curr_Stock_Price:  102.24304171653375
curr_Factors:  [102.24304172]
mat_Sqrt:  [[0.15]]
grads:  [0.00288793]
Stock Position:  0.0028879343761395336
Bond Position:  [-10.51690473]


portfolio before change:  [-10.22498185]
curr_Stock_Price:  101.53886372938834
curr_Factors:  [101.53886373]
mat_Sqrt:  [[0.15]]
grads:  [0.03255021]
Stock Position:  0.03255021001808638
Bond Position:  [-13.53009319]


portfolio before change:  [-10.21937765]
curr_Stock_Price:  101.76299651775521
curr_Factors:  [101.76299652]
mat_Sqrt:  [[0.15]]
grads:  [0.07413358]
Stock Position:  0.07413358054880267
Bond Position:  [-17.76343295]


portfolio before change:  [-10.20882017]
curr_Stock_Price:  101.93536161246332
curr_Factors:  [101.93536161]
mat_Sqrt:  [[0.15]]
grads:  [0.17976164]
Stock Position:  0.1797616353694771
Bond Position:  [-28.53288748]


portfolio before change:  [-10.09753446]
curr_Stock_Price:  102.57427740799567
curr_Factors:  [102.57427741]
mat_Sqrt:  [[0.15]]
grads:  [0.0075332]
Stock Position:  0.007533200914625847
Bond Position:  [-10.8702471]


portfolio before change:  [-10.09208855]
curr_Stock_Price:  103.47758152626585
curr_Factors:  [103.47758153]
mat_Sqrt:  [[0.15]]
grads:  [-0.08315756]
Stock Position:  -0.0831575629638883
Bond Position:  [-1.48714505]


portfolio before change:  [-10.10091615]
curr_Stock_Price:  103.5815010202553
curr_Factors:  [103.58150102]
mat_Sqrt:  [[0.15]]
grads:  [0.02202787]
Stock Position:  0.022027873825379504
Bond Position:  [-12.38259639]


portfolio before change:  [-10.10324002]
curr_Stock_Price:  103.54627514483083
curr_Factors:  [103.54627514]
mat_Sqrt:  [[0.15]]
grads:  [0.00243749]
Stock Position:  0.002437494554110321
Bond Position:  [-10.3556335]


portfolio before change:  [-10.10263321]
curr_Stock_Price:  104.32631829085204
curr_Factors:  [104.32631829]
mat_Sqrt:  [[0.15]]
grads:  [-0.20398525]
Stock Position:  -0.20398525308584062
Bond Position:  [11.17839723]


portfolio before change:  [-9.97791882]
curr_Stock_Price:  103.72177950278774
curr_Factors:  [103.7217795]
mat_Sqrt:  [[0.15]]
grads:  [0.03294319]
Stock Position:  0.03294319175247871
Bond Position:  [-13.39484529]


portfolio before change:  [-9.9414001]
curr_Stock_Price:  104.8811445848276
curr_Factors:  [104.88114458]
mat_Sqrt:  [[0.15]]
grads:  [-0.05805006]
Stock Position:  -0.058050063632921596
Bond Position:  [-3.85304298]


portfolio before change:  [-9.91537194]
curr_Stock_Price:  104.42447304042821
curr_Factors:  [104.42447304]
mat_Sqrt:  [[0.15]]
grads:  [0.03711833]
Stock Position:  0.03711833070607882
Bond Position:  [-13.79143407]


portfolio before change:  [-9.92950204]
curr_Stock_Price:  104.0902430707334
curr_Factors:  [104.09024307]
mat_Sqrt:  [[0.15]]
grads:  [-0.02198584]
Stock Position:  -0.02198583895589901
Bond Position:  [-7.64099072]


portfolio before change:  [-9.9395091]
curr_Stock_Price:  104.50195688736646
curr_Factors:  [104.50195689]
mat_Sqrt:  [[0.15]]
grads:  [-0.01258547]
Stock Position:  -0.01258547191079806
Bond Position:  [-8.62430265]


portfolio before change:  [-9.9415377]
curr_Stock_Price:  104.57748003603322
curr_Factors:  [104.57748004]
mat_Sqrt:  [[0.15]]
grads:  [-0.26386718]
Stock Position:  -0.26386718110875834
Bond Position:  [17.65302717]


portfolio before change:  [-9.79536054]
curr_Stock_Price:  104.03186315303978
curr_Factors:  [104.03186315]
mat_Sqrt:  [[0.15]]
grads:  [0.03208837]
Stock Position:  0.03208837263602222
Bond Position:  [-13.13357373]


portfolio before change:  [-9.78500742]
curr_Stock_Price:  104.4056720040568
curr_Factors:  [104.405672]
mat_Sqrt:  [[0.15]]
grads:  [0.06748195]
Stock Position:  0.06748194831818675
Bond Position:  [-16.83050559]


portfolio before change:  [-9.69775625]
curr_Stock_Price:  105.72980557897962
curr_Factors:  [105.72980558]
mat_Sqrt:  [[0.15]]
grads:  [-0.03784163]
Stock Position:  -0.03784163499149799
Bond Position:  [-5.69676754]


portfolio before change:  [-9.7481772]
curr_Stock_Price:  107.04340657381096
curr_Factors:  [107.04340657]
mat_Sqrt:  [[0.15]]
grads:  [0.1107628]
Stock Position:  0.11076279842956038
Bond Position:  [-21.60460447]


portfolio before change:  [-9.68859843]
curr_Stock_Price:  107.6056848809055
curr_Factors:  [107.60568488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10970864]
Stock Position:  -0.1097086434375149
Bond Position:  [2.11667528]


portfolio before change:  [-9.79290833]
curr_Stock_Price:  108.55888688519451
curr_Factors:  [108.55888689]
mat_Sqrt:  [[0.15]]
grads:  [0.10006209]
Stock Position:  0.1000620871575238
Bond Position:  [-20.65553713]


portfolio before change:  [-9.85685782]
curr_Stock_Price:  107.9455937658859
curr_Factors:  [107.94559377]
mat_Sqrt:  [[0.15]]
grads:  [0.53392155]
Stock Position:  0.5339215538728458
Bond Position:  [-67.49133698]


portfolio before change:  [-10.30026768]
curr_Stock_Price:  107.13091807300412
curr_Factors:  [107.13091807]
mat_Sqrt:  [[0.15]]
grads:  [0.18145012]
Stock Position:  0.1814501163185264
Bond Position:  [-29.73918522]


portfolio before change:  [-9.95131556]
curr_Stock_Price:  109.07453627325285
curr_Factors:  [109.07453627]
mat_Sqrt:  [[0.15]]
grads:  [-0.28897253]
Stock Position:  -0.28897253108738497
Bond Position:  [21.56822927]


portfolio before change:  [-10.00414105]
curr_Stock_Price:  109.26667111177855
curr_Factors:  [109.26667111]
mat_Sqrt:  [[0.15]]
grads:  [0.00231658]
Stock Position:  0.0023165819034264533
Bond Position:  [-10.25726625]


portfolio before change:  [-10.00662755]
curr_Stock_Price:  108.74682899589807
curr_Factors:  [108.746829]
mat_Sqrt:  [[0.15]]
grads:  [-0.08892189]
Stock Position:  -0.08892189444559473
Bond Position:  [-0.3366535]


portfolio before change:  [-10.13758361]
curr_Stock_Price:  110.21906459265563
curr_Factors:  [110.21906459]
mat_Sqrt:  [[0.15]]
grads:  [0.06695743]
Stock Position:  0.06695742854107277
Bond Position:  [-17.51756875]


portfolio before change:  [-10.12818415]
curr_Stock_Price:  110.39214910877078
curr_Factors:  [110.39214911]
mat_Sqrt:  [[0.15]]
grads:  [-0.05626585]
Stock Position:  -0.0562658468044308
Bond Position:  [-3.9168764]


portfolio before change:  [-10.09252906]
curr_Stock_Price:  109.74975714600119
curr_Factors:  [109.74975715]
mat_Sqrt:  [[0.15]]
grads:  [0.0744082]
Stock Position:  0.07440819994018025
Bond Position:  [-18.25881093]


portfolio before change:  [-10.1319041]
curr_Stock_Price:  109.25125634729271
curr_Factors:  [109.25125635]
mat_Sqrt:  [[0.15]]
grads:  [0.16728428]
Stock Position:  0.16728428479073762
Bond Position:  [-28.40792238]


portfolio before change:  [-10.04333889]
curr_Stock_Price:  109.80191434502268
curr_Factors:  [109.80191435]
mat_Sqrt:  [[0.15]]
grads:  [0.09013019]
Stock Position:  0.09013019253632021
Bond Position:  [-19.93980657]


portfolio before change:  [-10.1274143]
curr_Stock_Price:  108.89674838648038
curr_Factors:  [108.89674839]
mat_Sqrt:  [[0.15]]
grads:  [0.1189702]
Stock Position:  0.11897019598891423
Bond Position:  [-23.0828818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.1274143]
Stock Price:  109.65470840952766
PL:  [-19.78212271]
Settle:  Tensor("sub_42:0", shape=(), dtype=float64)
PL:  Tensor("sub_43:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  22
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44432685e-03]
 [-3.35247649e-03]
 [ 1.52359681e-02]
 [ 3.55369282e-02]
 [ 1.26401949e-02]
 [ 2.81956265e-02]
 [ 2.72722547e-02]
 [-3.95195948e-03]
 [ 1.42442257e-02]
 [ 4.48658970e-05]
 [-4.34951338e-02]
 [-3.40415783e-03]
 [ 9.40771939e-03]
 [ 6.02263027e-03]
 [ 1.52195609e-02]
 [-2.28072931e-03]
 [-1.41195066e-02]
 [ 8.57962177e-04]
 [-7.86941672e-03]
 [-3.21318053e-03]
 [ 1.46812035e-03]
 [ 5.17076678e-04]
 [ 4.75687075e-03]
 [ 5.61245393e-03]
 [ 3.10246424e-03]
 [ 1.47674879e-04]
 [ 1.19059465e-02]
 [-1.95675518e-02]
 [-2.52415290e-02]
 [ 2.18053909e-02]
 [ 2.65952694e-03]
 [-6.95102718e-03]
 [-1.24184316e-02]
 [-9.10925014e-03]
 [-6.39820006e-03]
 [-2.22566836e-03]
 [ 1.76721475e-02]
 [ 1.38064878e-02]
 [ 1.53549286e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.53427505]
curr_Stock_Price:  100.10270990115467
curr_Factors:  [100.1027099]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962885]
Stock Position:  -0.009628845686600187
Bond Position:  [4.4981486]


portfolio before change:  [3.53745351]
curr_Stock_Price:  99.83101043682922
curr_Factors:  [99.83101044]
mat_Sqrt:  [[0.15]]
grads:  [-0.02234984]
Stock Position:  -0.022349843264037283
Bond Position:  [5.76866094]


portfolio before change:  [3.5228333]
curr_Stock_Price:  100.51742858870399
curr_Factors:  [100.51742859]
mat_Sqrt:  [[0.15]]
grads:  [0.10157312]
Stock Position:  0.1015731204149315
Bond Position:  [-6.68703558]


portfolio before change:  [3.62721319]
curr_Stock_Price:  101.55329152770337
curr_Factors:  [101.55329153]
mat_Sqrt:  [[0.15]]
grads:  [0.23691285]
Stock Position:  0.2369128549987376
Bond Position:  [-20.43206704]


portfolio before change:  [3.62849528]
curr_Stock_Price:  101.56948420664426
curr_Factors:  [101.56948421]
mat_Sqrt:  [[0.15]]
grads:  [0.08426797]
Stock Position:  0.08426796590514013
Bond Position:  [-4.93055855]


portfolio before change:  [3.60101093]
curr_Stock_Price:  101.25064425940202
curr_Factors:  [101.25064426]
mat_Sqrt:  [[0.15]]
grads:  [0.18797084]
Stock Position:  0.1879708435171842
Bond Position:  [-15.43115808]


portfolio before change:  [3.36263571]
curr_Stock_Price:  99.99275662845592
curr_Factors:  [99.99275663]
mat_Sqrt:  [[0.15]]
grads:  [0.18181503]
Stock Position:  0.1818150312866834
Bond Position:  [-14.81755046]


portfolio before change:  [3.07355524]
curr_Stock_Price:  98.41297434499957
curr_Factors:  [98.41297434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0263464]
Stock Position:  -0.026346396520537826
Bond Position:  [5.66638248]


portfolio before change:  [3.07206356]
curr_Stock_Price:  98.49647806264191
curr_Factors:  [98.49647806]
mat_Sqrt:  [[0.15]]
grads:  [0.0949615]
Stock Position:  0.09496150467283733
Bond Position:  [-6.2813102]


portfolio before change:  [2.99189802]
curr_Stock_Price:  97.66055700470521
curr_Factors:  [97.660557]
mat_Sqrt:  [[0.15]]
grads:  [0.00029911]
Stock Position:  0.00029910597999619046
Bond Position:  [2.96268717]


portfolio before change:  [2.99205994]
curr_Stock_Price:  96.96365464830745
curr_Factors:  [96.96365465]
mat_Sqrt:  [[0.15]]
grads:  [-0.28996756]
Stock Position:  -0.2899675588016609
Bond Position:  [31.10837417]


portfolio before change:  [2.75802101]
curr_Stock_Price:  97.78418683535251
curr_Factors:  [97.78418684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02269439]
Stock Position:  -0.02269438555818617
Bond Position:  [4.97717305]


portfolio before change:  [2.77473393]
curr_Stock_Price:  97.07516852396131
curr_Factors:  [97.07516852]
mat_Sqrt:  [[0.15]]
grads:  [0.06271813]
Stock Position:  0.06271812929032182
Bond Position:  [-3.31363904]


portfolio before change:  [2.75391624]
curr_Stock_Price:  96.74984853864765
curr_Factors:  [96.74984854]
mat_Sqrt:  [[0.15]]
grads:  [0.04015087]
Stock Position:  0.040150868487478786
Bond Position:  [-1.13067421]


portfolio before change:  [2.70943117]
curr_Stock_Price:  95.64542084206632
curr_Factors:  [95.64542084]
mat_Sqrt:  [[0.15]]
grads:  [0.10146374]
Stock Position:  0.10146373917277746
Bond Position:  [-6.99511087]


portfolio before change:  [2.54079806]
curr_Stock_Price:  93.99203542644649
curr_Factors:  [93.99203543]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520486]
Stock Position:  -0.015204862043396637
Bond Position:  [3.96993399]


portfolio before change:  [2.55018804]
curr_Stock_Price:  93.407109872433
curr_Factors:  [93.40710987]
mat_Sqrt:  [[0.15]]
grads:  [-0.09413004]
Stock Position:  -0.0941300441529148
Bond Position:  [11.34260342]


portfolio before change:  [2.56562766]
curr_Stock_Price:  93.25814886548552
curr_Factors:  [93.25814887]
mat_Sqrt:  [[0.15]]
grads:  [0.00571975]
Stock Position:  0.005719747847669673
Bond Position:  [2.03221456]


portfolio before change:  [2.56154797]
curr_Stock_Price:  92.50047012710112
curr_Factors:  [92.50047013]
mat_Sqrt:  [[0.15]]
grads:  [-0.05246278]
Stock Position:  -0.052462778108577336
Bond Position:  [7.41437961]


portfolio before change:  [2.54810714]
curr_Stock_Price:  92.77433455121638
curr_Factors:  [92.77433455]
mat_Sqrt:  [[0.15]]
grads:  [-0.0214212]
Stock Position:  -0.021421203538202375
Bond Position:  [4.53544504]


portfolio before change:  [2.54251331]
curr_Stock_Price:  93.06193732198905
curr_Factors:  [93.06193732]
mat_Sqrt:  [[0.15]]
grads:  [0.00978747]
Stock Position:  0.009787469005240157
Bond Position:  [1.63167248]


portfolio before change:  [2.55086767]
curr_Stock_Price:  93.8946745803635
curr_Factors:  [93.89467458]
mat_Sqrt:  [[0.15]]
grads:  [0.00344718]
Stock Position:  0.0034471778518599164
Bond Position:  [2.22719603]


portfolio before change:  [2.55018868]
curr_Stock_Price:  93.61693740118123
curr_Factors:  [93.6169374]
mat_Sqrt:  [[0.15]]
grads:  [0.03171247]
Stock Position:  0.031712471664245546
Bond Position:  [-0.4186358]


portfolio before change:  [2.55071391]
curr_Stock_Price:  93.63514984506334
curr_Factors:  [93.63514985]
mat_Sqrt:  [[0.15]]
grads:  [0.03741636]
Stock Position:  0.037416359530737284
Bond Position:  [-0.95277253]


portfolio before change:  [2.59899222]
curr_Stock_Price:  94.92863254646512
curr_Factors:  [94.92863255]
mat_Sqrt:  [[0.15]]
grads:  [0.02068309]
Stock Position:  0.02068309495602629
Bond Position:  [0.63557429]


portfolio before change:  [2.56704596]
curr_Stock_Price:  93.3802323965841
curr_Factors:  [93.3802324]
mat_Sqrt:  [[0.15]]
grads:  [0.0009845]
Stock Position:  0.0009844991918925988
Bond Position:  [2.4751132]


portfolio before change:  [2.56780018]
curr_Stock_Price:  93.83205031377796
curr_Factors:  [93.83205031]
mat_Sqrt:  [[0.15]]
grads:  [0.07937298]
Stock Position:  0.07937297692167668
Bond Position:  [-4.87992898]


portfolio before change:  [2.59209384]
curr_Stock_Price:  94.14580556144595
curr_Factors:  [94.14580556]
mat_Sqrt:  [[0.15]]
grads:  [-0.13045035]
Stock Position:  -0.13045034556856924
Bond Position:  [14.87344671]


portfolio before change:  [2.4824813]
curr_Stock_Price:  95.00032102698201
curr_Factors:  [95.00032103]
mat_Sqrt:  [[0.15]]
grads:  [-0.16827686]
Stock Position:  -0.16827686008747794
Bond Position:  [18.46883703]


portfolio before change:  [2.37711004]
curr_Stock_Price:  95.64021893144901
curr_Factors:  [95.64021893]
mat_Sqrt:  [[0.15]]
grads:  [0.14536927]
Stock Position:  0.14536927286405482
Bond Position:  [-11.52603904]


portfolio before change:  [2.4182443]
curr_Stock_Price:  95.9330945149157
curr_Factors:  [95.93309451]
mat_Sqrt:  [[0.15]]
grads:  [0.01773018]
Stock Position:  0.017730179623474323
Bond Position:  [0.71733331]


portfolio before change:  [2.42251255]
curr_Stock_Price:  96.16877043555013
curr_Factors:  [96.16877044]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634018]
Stock Position:  -0.04634018118524718
Bond Position:  [6.8789908]


portfolio before change:  [2.45103078]
curr_Stock_Price:  95.57191705527465
curr_Factors:  [95.57191706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08278954]
Stock Position:  -0.08278954416112107
Bond Position:  [10.36338622]


portfolio before change:  [2.43264909]
curr_Stock_Price:  95.80959431345453
curr_Factors:  [95.80959431]
mat_Sqrt:  [[0.15]]
grads:  [-0.06072833]
Stock Position:  -0.060728334268333004
Bond Position:  [8.25100616]


portfolio before change:  [2.49423737]
curr_Stock_Price:  94.81241825086107
curr_Factors:  [94.81241825]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265467]
Stock Position:  -0.04265466709901994
Bond Position:  [6.53842951]


portfolio before change:  [2.55275871]
curr_Stock_Price:  93.45960058979877
curr_Factors:  [93.45960059]
mat_Sqrt:  [[0.15]]
grads:  [-0.01483779]
Stock Position:  -0.014837789071721215
Bond Position:  [3.93949255]


portfolio before change:  [2.57006784]
curr_Stock_Price:  92.32623330407758
curr_Factors:  [92.3262333]
mat_Sqrt:  [[0.15]]
grads:  [0.11781432]
Stock Position:  0.1178143167803591
Bond Position:  [-8.30728425]


portfolio before change:  [2.56923055]
curr_Stock_Price:  92.32794092865846
curr_Factors:  [92.32794093]
mat_Sqrt:  [[0.15]]
grads:  [0.09204325]
Stock Position:  0.0920432517790044
Bond Position:  [-5.92893336]


portfolio before change:  [2.54231644]
curr_Stock_Price:  92.04358601823715
curr_Factors:  [92.04358602]
mat_Sqrt:  [[0.15]]
grads:  [0.10236619]
Stock Position:  0.10236619060174408
Bond Position:  [-6.87983483]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.54231644]
Stock Price:  92.3344935457545
PL:  [2.54231644]
Settle:  Tensor("sub_44:0", shape=(), dtype=float64)
PL:  Tensor("sub_45:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  23
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.30078240e-03]
 [ 5.15914690e-03]
 [ 1.49196270e-02]
 [-6.91729637e-04]
 [ 1.10927642e-02]
 [ 2.09113339e-02]
 [ 1.64551538e-02]
 [ 3.03186286e-04]
 [ 1.09822434e-02]
 [ 1.17450298e-02]
 [ 2.69545750e-02]
 [ 9.12238101e-03]
 [-1.15713825e-02]
 [ 1.17158029e-02]
 [-7.15492803e-03]
 [-2.74148051e-02]
 [ 4.52105981e-03]
 [ 5.98914934e-04]
 [-1.10512252e-02]
 [-2.21489843e-03]
 [-2.27745613e-04]
 [-3.14561941e-02]
 [ 4.78652047e-03]
 [ 7.96010703e-03]
 [-4.54528509e-03]
 [-7.20654844e-03]
 [ 1.44689353e-02]
 [-1.99181378e-02]
 [-1.63394855e-02]
 [ 2.15514105e-02]
 [ 6.77911060e-03]
 [ 4.06931910e-03]
 [-1.25312003e-02]
 [-6.31496917e-03]
 [-8.84676127e-03]
 [-7.46735681e-03]
 [ 2.27548874e-02]
 [ 4.84830006e-03]
 [ 2.38860522e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.39771306]
curr_Stock_Price:  99.1407603091103
curr_Factors:  [99.14076031]
mat_Sqrt:  [[0.15]]
grads:  [-0.03533855]
Stock Position:  -0.03533854935857361
Bond Position:  [-7.89422241]


portfolio before change:  [-11.41145423]
curr_Stock_Price:  99.50167858487633
curr_Factors:  [99.50167858]
mat_Sqrt:  [[0.15]]
grads:  [0.03439431]
Stock Position:  0.03439431269357348
Bond Position:  [-14.83374608]


portfolio before change:  [-11.37813876]
curr_Stock_Price:  100.52422560769371
curr_Factors:  [100.52422561]
mat_Sqrt:  [[0.15]]
grads:  [0.09946418]
Stock Position:  0.0994641802623265
Bond Position:  [-21.37669846]


portfolio before change:  [-11.3997323]
curr_Stock_Price:  100.33399346340923
curr_Factors:  [100.33399346]
mat_Sqrt:  [[0.15]]
grads:  [-0.00461153]
Stock Position:  -0.004611530915133005
Bond Position:  [-10.93703899]


portfolio before change:  [-11.40183452]
curr_Stock_Price:  100.49337666053661
curr_Factors:  [100.49337666]
mat_Sqrt:  [[0.15]]
grads:  [0.07395176]
Stock Position:  0.07395176134462256
Bond Position:  [-18.83349672]


portfolio before change:  [-11.39806528]
curr_Stock_Price:  100.57618165444781
curr_Factors:  [100.57618165]
mat_Sqrt:  [[0.15]]
grads:  [0.13940889]
Stock Position:  0.1394088929694717
Bond Position:  [-25.41927942]


portfolio before change:  [-11.28213507]
curr_Stock_Price:  101.43055909080311
curr_Factors:  [101.43055909]
mat_Sqrt:  [[0.15]]
grads:  [0.10970103]
Stock Position:  0.10970102511483504
Bond Position:  [-22.40917138]


portfolio before change:  [-11.2079423]
curr_Stock_Price:  102.1324130092024
curr_Factors:  [102.13241301]
mat_Sqrt:  [[0.15]]
grads:  [0.00202124]
Stock Position:  0.0020212419057621706
Bond Position:  [-11.41437661]


portfolio before change:  [-11.20753065]
curr_Stock_Price:  103.04201917404943
curr_Factors:  [103.04201917]
mat_Sqrt:  [[0.15]]
grads:  [0.07321496]
Stock Position:  0.07321495622507436
Bond Position:  [-18.75174757]


portfolio before change:  [-11.27711861]
curr_Stock_Price:  102.12357512974461
curr_Factors:  [102.12357513]
mat_Sqrt:  [[0.15]]
grads:  [0.0783002]
Stock Position:  0.07830019853013097
Bond Position:  [-19.27341481]


portfolio before change:  [-11.29467532]
curr_Stock_Price:  101.93012246744355
curr_Factors:  [101.93012247]
mat_Sqrt:  [[0.15]]
grads:  [0.17969717]
Stock Position:  0.1796971666965528
Bond Position:  [-29.61122952]


portfolio before change:  [-11.33135016]
curr_Stock_Price:  101.74662925296956
curr_Factors:  [101.74662925]
mat_Sqrt:  [[0.15]]
grads:  [0.06081587]
Stock Position:  0.060815873403599965
Bond Position:  [-17.51916029]


portfolio before change:  [-11.32710886]
curr_Stock_Price:  101.85238016137984
curr_Factors:  [101.85238016]
mat_Sqrt:  [[0.15]]
grads:  [-0.07714255]
Stock Position:  -0.07714254969097184
Bond Position:  [-3.46995656]


portfolio before change:  [-11.28734669]
curr_Stock_Price:  101.33131959589072
curr_Factors:  [101.3313196]
mat_Sqrt:  [[0.15]]
grads:  [0.07810535]
Stock Position:  0.07810535245342583
Bond Position:  [-19.20186512]


portfolio before change:  [-11.3004883]
curr_Stock_Price:  101.19379735803656
curr_Factors:  [101.19379736]
mat_Sqrt:  [[0.15]]
grads:  [-0.04769952]
Stock Position:  -0.047699520175958965
Bond Position:  [-6.47359272]


portfolio before change:  [-11.32995599]
curr_Stock_Price:  101.79460935420146
curr_Factors:  [101.79460935]
mat_Sqrt:  [[0.15]]
grads:  [-0.18276537]
Stock Position:  -0.18276536744209704
Bond Position:  [7.27457319]


portfolio before change:  [-11.20714024]
curr_Stock_Price:  101.12759910912084
curr_Factors:  [101.12759911]
mat_Sqrt:  [[0.15]]
grads:  [0.0301404]
Stock Position:  0.03014039871097312
Bond Position:  [-14.2551664]


portfolio before change:  [-11.20257136]
curr_Stock_Price:  101.33830930406909
curr_Factors:  [101.3383093]
mat_Sqrt:  [[0.15]]
grads:  [0.00399277]
Stock Position:  0.003992766223382078
Bond Position:  [-11.60719154]


portfolio before change:  [-11.20530401]
curr_Stock_Price:  101.01731243322469
curr_Factors:  [101.01731243]
mat_Sqrt:  [[0.15]]
grads:  [-0.07367483]
Stock Position:  -0.07367483473385769
Bond Position:  [-3.76287021]


portfolio before change:  [-11.17507736]
curr_Stock_Price:  100.60065667023538
curr_Factors:  [100.60065667]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476599]
Stock Position:  -0.014765989556447373
Bond Position:  [-9.68960911]


portfolio before change:  [-11.1925151]
curr_Stock_Price:  101.69956491598418
curr_Factors:  [101.69956492]
mat_Sqrt:  [[0.15]]
grads:  [-0.0015183]
Stock Position:  -0.0015183040886672886
Bond Position:  [-11.03810424]


portfolio before change:  [-11.19559496]
curr_Stock_Price:  102.81924382799431
curr_Factors:  [102.81924383]
mat_Sqrt:  [[0.15]]
grads:  [-0.20970796]
Stock Position:  -0.20970796088249058
Bond Position:  [10.366419]


portfolio before change:  [-10.97731974]
curr_Stock_Price:  101.78456998353482
curr_Factors:  [101.78456998]
mat_Sqrt:  [[0.15]]
grads:  [0.03191014]
Stock Position:  0.0319101364564206
Bond Position:  [-14.22527926]


portfolio before change:  [-10.96880499]
curr_Stock_Price:  102.10713279115114
curr_Factors:  [102.10713279]
mat_Sqrt:  [[0.15]]
grads:  [0.05306738]
Stock Position:  0.05306738022462778
Bond Position:  [-16.38736303]


portfolio before change:  [-10.96762497]
curr_Stock_Price:  102.16797171470643
curr_Factors:  [102.16797171]
mat_Sqrt:  [[0.15]]
grads:  [-0.0303019]
Stock Position:  -0.03030190059744464
Bond Position:  [-7.87174125]


portfolio before change:  [-10.94636628]
curr_Stock_Price:  101.4339345427856
curr_Factors:  [101.43393454]
mat_Sqrt:  [[0.15]]
grads:  [-0.04804366]
Stock Position:  -0.04804365626071957
Bond Position:  [-6.0731092]


portfolio before change:  [-10.87269329]
curr_Stock_Price:  99.88467329298777
curr_Factors:  [99.88467329]
mat_Sqrt:  [[0.15]]
grads:  [0.09645957]
Stock Position:  0.09645956851177534
Bond Position:  [-20.50752578]


portfolio before change:  [-10.81990752]
curr_Stock_Price:  100.45848235879872
curr_Factors:  [100.45848236]
mat_Sqrt:  [[0.15]]
grads:  [-0.13278759]
Stock Position:  -0.13278758547721833
Bond Position:  [2.5197318]


portfolio before change:  [-10.79112043]
curr_Stock_Price:  100.24406394440584
curr_Factors:  [100.24406394]
mat_Sqrt:  [[0.15]]
grads:  [-0.1089299]
Stock Position:  -0.1089299030625615
Bond Position:  [0.12845574]


portfolio before change:  [-10.73706956]
curr_Stock_Price:  99.74801275675028
curr_Factors:  [99.74801276]
mat_Sqrt:  [[0.15]]
grads:  [0.14367607]
Stock Position:  0.14367607000194932
Bond Position:  [-25.06847202]


portfolio before change:  [-10.54652708]
curr_Stock_Price:  101.0960189655758
curr_Factors:  [101.09601897]
mat_Sqrt:  [[0.15]]
grads:  [0.04519407]
Stock Position:  0.045194070642866915
Bond Position:  [-15.1154677]


portfolio before change:  [-10.56623795]
curr_Stock_Price:  100.70169025132495
curr_Factors:  [100.70169025]
mat_Sqrt:  [[0.15]]
grads:  [0.02712879]
Stock Position:  0.0271287939800774
Bond Position:  [-13.29815336]


portfolio before change:  [-10.60551727]
curr_Stock_Price:  99.31508449982736
curr_Factors:  [99.3150845]
mat_Sqrt:  [[0.15]]
grads:  [-0.08354134]
Stock Position:  -0.08354133558156754
Bond Position:  [-2.30860247]


portfolio before change:  [-10.6400561]
curr_Stock_Price:  99.72506404187365
curr_Factors:  [99.72506404]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209979]
Stock Position:  -0.042099794472222174
Bond Position:  [-6.4416514]


portfolio before change:  [-10.62514022]
curr_Stock_Price:  99.35163854174998
curr_Factors:  [99.35163854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05897841]
Stock Position:  -0.058978408483772025
Bond Position:  [-4.7655387]


portfolio before change:  [-10.66250421]
curr_Stock_Price:  99.97505748918528
curr_Factors:  [99.97505749]
mat_Sqrt:  [[0.15]]
grads:  [-0.04978238]
Stock Position:  -0.04978237872342326
Bond Position:  [-5.68550803]


portfolio before change:  [-10.68543336]
curr_Stock_Price:  100.42136848725349
curr_Factors:  [100.42136849]
mat_Sqrt:  [[0.15]]
grads:  [0.15169925]
Stock Position:  0.15169924954609917
Bond Position:  [-25.9192796]


portfolio before change:  [-10.56994971]
curr_Stock_Price:  101.2039943784432
curr_Factors:  [101.20399438]
mat_Sqrt:  [[0.15]]
grads:  [0.032322]
Stock Position:  0.032322000385109136
Bond Position:  [-13.84106526]


portfolio before change:  [-10.6152974]
curr_Stock_Price:  99.85452837565084
curr_Factors:  [99.85452838]
mat_Sqrt:  [[0.15]]
grads:  [0.15924035]
Stock Position:  0.15924034813126414
Bond Position:  [-26.51616726]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.6152974]
Stock Price:  100.04733688922994
PL:  [-10.66263429]
Settle:  Tensor("sub_46:0", shape=(), dtype=float64)
PL:  Tensor("sub_47:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  24
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.73881516e-03]
 [-6.22831689e-03]
 [ 1.97156954e-02]
 [-8.64399377e-03]
 [ 7.30522216e-03]
 [ 1.87582526e-02]
 [ 6.17888999e-03]
 [-3.33446428e-03]
 [ 1.40925235e-02]
 [-7.54526481e-05]
 [-3.02869969e-02]
 [-4.07893566e-03]
 [ 6.00098040e-03]
 [ 1.08086782e-02]
 [-4.96892085e-03]
 [-2.28025618e-02]
 [ 4.46272224e-03]
 [-8.02168298e-04]
 [-5.10094125e-03]
 [-2.52734550e-03]
 [ 4.04370841e-04]
 [ 1.02527290e-02]
 [ 4.77846177e-03]
 [ 6.20202172e-03]
 [-4.22543900e-03]
 [-8.77467532e-03]
 [-4.92936307e-04]
 [-1.64781511e-02]
 [-5.58848662e-03]
 [ 2.24973656e-02]
 [-1.19739031e-02]
 [ 6.19859821e-03]
 [-1.29751568e-02]
 [ 1.59875015e-03]
 [-6.22113719e-03]
 [ 1.71579752e-03]
 [ 2.41526109e-02]
 [ 1.11540456e-03]
 [ 2.02203625e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.4043817]
curr_Stock_Price:  100.73856260822625
curr_Factors:  [100.73856261]
mat_Sqrt:  [[0.15]]
grads:  [-0.0115921]
Stock Position:  -0.011592101089456701
Bond Position:  [14.5721533]


portfolio before change:  [13.40347886]
curr_Stock_Price:  100.97359081667688
curr_Factors:  [100.97359082]
mat_Sqrt:  [[0.15]]
grads:  [-0.04152211]
Stock Position:  -0.04152211258606467
Bond Position:  [17.59611567]


portfolio before change:  [13.44514756]
curr_Stock_Price:  100.02303581240984
curr_Factors:  [100.02303581]
mat_Sqrt:  [[0.15]]
grads:  [0.13143797]
Stock Position:  0.1314379693381623
Bond Position:  [0.29832285]


portfolio before change:  [13.36381139]
curr_Stock_Price:  99.40393412300836
curr_Factors:  [99.40393412]
mat_Sqrt:  [[0.15]]
grads:  [-0.05762663]
Stock Position:  -0.05762662510103422
Bond Position:  [19.09212463]


portfolio before change:  [13.34947628]
curr_Stock_Price:  99.69410859919175
curr_Factors:  [99.6941086]
mat_Sqrt:  [[0.15]]
grads:  [0.04870148]
Stock Position:  0.048701481080497405
Bond Position:  [8.49422553]


portfolio before change:  [13.32672591]
curr_Stock_Price:  99.20516631349176
curr_Factors:  [99.20516631]
mat_Sqrt:  [[0.15]]
grads:  [0.12505502]
Stock Position:  0.12505501700525368
Bond Position:  [0.92062215]


portfolio before change:  [13.18178137]
curr_Stock_Price:  98.0451998807384
curr_Factors:  [98.04519988]
mat_Sqrt:  [[0.15]]
grads:  [0.0411926]
Stock Position:  0.04119259994444133
Bond Position:  [9.14304468]


portfolio before change:  [13.2210532]
curr_Stock_Price:  98.97082424849894
curr_Factors:  [98.97082425]
mat_Sqrt:  [[0.15]]
grads:  [-0.02222976]
Stock Position:  -0.022229761866906846
Bond Position:  [15.42115105]


portfolio before change:  [13.23412445]
curr_Stock_Price:  98.46953753479586
curr_Factors:  [98.46953753]
mat_Sqrt:  [[0.15]]
grads:  [0.09395016]
Stock Position:  0.0939501566681402
Bond Position:  [3.98289597]


portfolio before change:  [13.17786271]
curr_Stock_Price:  97.86539135241368
curr_Factors:  [97.86539135]
mat_Sqrt:  [[0.15]]
grads:  [-0.00050302]
Stock Position:  -0.0005030176539676361
Bond Position:  [13.22709073]


portfolio before change:  [13.17980071]
curr_Stock_Price:  97.29979356759236
curr_Factors:  [97.29979357]
mat_Sqrt:  [[0.15]]
grads:  [-0.20191331]
Stock Position:  -0.2019133129398972
Bond Position:  [32.82592437]


portfolio before change:  [13.10551215]
curr_Stock_Price:  97.68803966185314
curr_Factors:  [97.68803966]
mat_Sqrt:  [[0.15]]
grads:  [-0.0271929]
Stock Position:  -0.027192904430594286
Bond Position:  [15.76193367]


portfolio before change:  [13.090327]
curr_Stock_Price:  98.31892143379822
curr_Factors:  [98.31892143]
mat_Sqrt:  [[0.15]]
grads:  [0.04000654]
Stock Position:  0.04000653600872327
Bond Position:  [9.15692753]


portfolio before change:  [13.15169756]
curr_Stock_Price:  99.82432226519163
curr_Factors:  [99.82432227]
mat_Sqrt:  [[0.15]]
grads:  [0.07205785]
Stock Position:  0.07205785434069249
Bond Position:  [5.95857109]


portfolio before change:  [13.1631401]
curr_Stock_Price:  99.97278164961463
curr_Factors:  [99.97278165]
mat_Sqrt:  [[0.15]]
grads:  [-0.03312614]
Stock Position:  -0.03312613900164653
Bond Position:  [16.47485236]


portfolio before change:  [13.1431827]
curr_Stock_Price:  100.63741931838537
curr_Factors:  [100.63741932]
mat_Sqrt:  [[0.15]]
grads:  [-0.15201708]
Stock Position:  -0.15201707880311857
Bond Position:  [28.44178921]


portfolio before change:  [13.19658473]
curr_Stock_Price:  100.30951813765739
curr_Factors:  [100.30951814]
mat_Sqrt:  [[0.15]]
grads:  [0.02975148]
Stock Position:  0.029751481585735193
Bond Position:  [10.21222795]


portfolio before change:  [13.21990489]
curr_Stock_Price:  101.05044110496279
curr_Factors:  [101.0504411]
mat_Sqrt:  [[0.15]]
grads:  [-0.00534779]
Stock Position:  -0.005347788656650494
Bond Position:  [13.76030129]


portfolio before change:  [13.21602082]
curr_Stock_Price:  102.09839175270085
curr_Factors:  [102.09839175]
mat_Sqrt:  [[0.15]]
grads:  [-0.03400627]
Stock Position:  -0.034006274980201194
Bond Position:  [16.6880068]


portfolio before change:  [13.21199134]
curr_Stock_Price:  102.27822932671245
curr_Factors:  [102.27822933]
mat_Sqrt:  [[0.15]]
grads:  [-0.01684897]
Stock Position:  -0.016848970031716027
Bond Position:  [14.93527416]


portfolio before change:  [13.24228205]
curr_Stock_Price:  100.59126068122069
curr_Factors:  [100.59126068]
mat_Sqrt:  [[0.15]]
grads:  [0.00269581]
Stock Position:  0.0026958056056421206
Bond Position:  [12.97110757]


portfolio before change:  [13.24244691]
curr_Stock_Price:  100.05092564459298
curr_Factors:  [100.05092564]
mat_Sqrt:  [[0.15]]
grads:  [0.06835153]
Stock Position:  0.06835152646072656
Bond Position:  [6.40381341]


portfolio before change:  [13.29182816]
curr_Stock_Price:  100.76167392364616
curr_Factors:  [100.76167392]
mat_Sqrt:  [[0.15]]
grads:  [0.03185641]
Stock Position:  0.03185641182092077
Bond Position:  [10.08192278]


portfolio before change:  [13.26081403]
curr_Stock_Price:  99.74855134585373
curr_Factors:  [99.74855135]
mat_Sqrt:  [[0.15]]
grads:  [0.04134681]
Stock Position:  0.041346811498103375
Bond Position:  [9.13652948]


portfolio before change:  [13.2711236]
curr_Stock_Price:  99.9702718116018
curr_Factors:  [99.97027181]
mat_Sqrt:  [[0.15]]
grads:  [-0.02816959]
Stock Position:  -0.028169593344458944
Bond Position:  [16.08724551]


portfolio before change:  [13.26471668]
curr_Stock_Price:  100.26910316888392
curr_Factors:  [100.26910317]
mat_Sqrt:  [[0.15]]
grads:  [-0.05849784]
Stock Position:  -0.058497835495965336
Bond Position:  [19.13024218]


portfolio before change:  [13.14931063]
curr_Stock_Price:  102.28280980561402
curr_Factors:  [102.28280981]
mat_Sqrt:  [[0.15]]
grads:  [-0.00328624]
Stock Position:  -0.003286242045848872
Bond Position:  [13.4854367]


portfolio before change:  [13.15285904]
curr_Stock_Price:  101.71601524764584
curr_Factors:  [101.71601525]
mat_Sqrt:  [[0.15]]
grads:  [-0.10985434]
Stock Position:  -0.10985434063872739
Bond Position:  [24.32680482]


portfolio before change:  [13.10167338]
curr_Stock_Price:  102.2096388838701
curr_Factors:  [102.20963888]
mat_Sqrt:  [[0.15]]
grads:  [-0.03725658]
Stock Position:  -0.037256577456612996
Bond Position:  [16.90965471]


portfolio before change:  [13.11983786]
curr_Stock_Price:  101.77882527784651
curr_Factors:  [101.77882528]
mat_Sqrt:  [[0.15]]
grads:  [0.14998244]
Stock Position:  0.14998243705915273
Bond Position:  [-2.1451984]


portfolio before change:  [13.38846875]
curr_Stock_Price:  103.5716956140165
curr_Factors:  [103.57169561]
mat_Sqrt:  [[0.15]]
grads:  [-0.07982602]
Stock Position:  -0.07982602036445531
Bond Position:  [21.65618504]


portfolio before change:  [13.36212536]
curr_Stock_Price:  103.9356193233475
curr_Factors:  [103.93561932]
mat_Sqrt:  [[0.15]]
grads:  [0.04132399]
Stock Position:  0.04132398806032944
Bond Position:  [9.06709107]


portfolio before change:  [13.35838838]
curr_Stock_Price:  103.81775930844417
curr_Factors:  [103.81775931]
mat_Sqrt:  [[0.15]]
grads:  [-0.08650105]
Stock Position:  -0.08650104513464348
Bond Position:  [22.33873306]


portfolio before change:  [13.28295985]
curr_Stock_Price:  104.72203793181818
curr_Factors:  [104.72203793]
mat_Sqrt:  [[0.15]]
grads:  [0.01065833]
Stock Position:  0.010658334335920488
Bond Position:  [12.16679735]


portfolio before change:  [13.28653098]
curr_Stock_Price:  104.91439344485778
curr_Factors:  [104.91439344]
mat_Sqrt:  [[0.15]]
grads:  [-0.04147425]
Stock Position:  -0.041474247933983174
Bond Position:  [17.63777654]


portfolio before change:  [13.27924862]
curr_Stock_Price:  105.14314316916982
curr_Factors:  [105.14314317]
mat_Sqrt:  [[0.15]]
grads:  [0.01143865]
Stock Position:  0.011438650103256197
Bond Position:  [12.07655299]


portfolio before change:  [13.27866926]
curr_Stock_Price:  104.96051458652731
curr_Factors:  [104.96051459]
mat_Sqrt:  [[0.15]]
grads:  [0.16101741]
Stock Position:  0.16101740598998932
Bond Position:  [-3.62180053]


portfolio before change:  [13.20355901]
curr_Stock_Price:  104.49685357771753
curr_Factors:  [104.49685358]
mat_Sqrt:  [[0.15]]
grads:  [0.00743603]
Stock Position:  0.007436030396979721
Bond Position:  [12.42651723]


portfolio before change:  [13.20802104]
curr_Stock_Price:  104.88800571639727
curr_Factors:  [104.88800572]
mat_Sqrt:  [[0.15]]
grads:  [0.13480242]
Stock Position:  0.13480241673359275
Bond Position:  [-0.93113562]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.20802104]
Stock Price:  104.12582676607688
PL:  [9.08219427]
Settle:  Tensor("sub_48:0", shape=(), dtype=float64)
PL:  Tensor("sub_49:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  25
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.78961885e-03]
 [-7.23850975e-03]
 [-1.35115140e-03]
 [-1.26422888e-02]
 [ 1.47698224e-02]
 [ 1.94829278e-02]
 [ 1.40354045e-02]
 [-3.00006676e-03]
 [ 1.70132334e-02]
 [ 3.68309228e-03]
 [ 4.16076041e-03]
 [ 7.45839093e-03]
 [-1.92472388e-04]
 [ 1.05588411e-02]
 [-9.81591161e-04]
 [-1.03742520e-02]
 [-5.06200889e-03]
 [ 1.22841068e-05]
 [-7.60346316e-03]
 [-2.61495229e-03]
 [ 7.63343138e-04]
 [ 1.37806583e-02]
 [ 4.75708606e-03]
 [ 5.41475432e-03]
 [ 2.41169562e-03]
 [-2.24371553e-03]
 [ 6.42238581e-03]
 [-1.83530055e-02]
 [-2.25272427e-02]
 [ 2.14264645e-02]
 [ 2.62774342e-03]
 [-7.96811870e-03]
 [-1.24538399e-02]
 [-7.50225804e-03]
 [-6.42695300e-03]
 [-3.78250402e-03]
 [ 1.86227865e-02]
 [ 1.01228568e-02]
 [ 2.06005856e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.98668333]
curr_Stock_Price:  101.0337639672092
curr_Factors:  [101.03376397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01859746]
Stock Position:  -0.01859745901711219
Bond Position:  [19.86565461]


portfolio before change:  [17.99303267]
curr_Stock_Price:  100.82588736728822
curr_Factors:  [100.82588737]
mat_Sqrt:  [[0.15]]
grads:  [-0.04825673]
Stock Position:  -0.04825673169369622
Bond Position:  [22.85856046]


portfolio before change:  [18.06431711]
curr_Stock_Price:  99.40791023295274
curr_Factors:  [99.40791023]
mat_Sqrt:  [[0.15]]
grads:  [-0.00900768]
Stock Position:  -0.00900767600748124
Bond Position:  [18.95975135]


portfolio before change:  [18.06922858]
curr_Stock_Price:  99.12577759485096
curr_Factors:  [99.12577759]
mat_Sqrt:  [[0.15]]
grads:  [-0.08428193]
Stock Position:  -0.08428192517973002
Bond Position:  [26.42373995]


portfolio before change:  [18.12201467]
curr_Stock_Price:  98.53866576806239
curr_Factors:  [98.53866577]
mat_Sqrt:  [[0.15]]
grads:  [0.09846548]
Stock Position:  0.09846548252416115
Bond Position:  [8.4193574]


portfolio before change:  [18.17930197]
curr_Stock_Price:  99.10977773472788
curr_Factors:  [99.10977773]
mat_Sqrt:  [[0.15]]
grads:  [0.12988619]
Stock Position:  0.12988618511311173
Bond Position:  [5.30631104]


portfolio before change:  [18.115738]
curr_Stock_Price:  98.61528864982748
curr_Factors:  [98.61528865]
mat_Sqrt:  [[0.15]]
grads:  [0.09356936]
Stock Position:  0.09356936356450159
Bond Position:  [8.88836821]


portfolio before change:  [18.19568031]
curr_Stock_Price:  99.45777799870235
curr_Factors:  [99.457778]
mat_Sqrt:  [[0.15]]
grads:  [-0.02000045]
Stock Position:  -0.020000445061475518
Bond Position:  [20.18488013]


portfolio before change:  [18.19937723]
curr_Stock_Price:  99.39909662231173
curr_Factors:  [99.39909662]
mat_Sqrt:  [[0.15]]
grads:  [0.11342156]
Stock Position:  0.11342155622637805
Bond Position:  [6.925377]


portfolio before change:  [18.32074211]
curr_Stock_Price:  100.461497452415
curr_Factors:  [100.46149745]
mat_Sqrt:  [[0.15]]
grads:  [0.02455395]
Stock Position:  0.024553948505430894
Bond Position:  [15.85401568]


portfolio before change:  [18.30330795]
curr_Stock_Price:  99.67074736227507
curr_Factors:  [99.67074736]
mat_Sqrt:  [[0.15]]
grads:  [0.0277384]
Stock Position:  0.027738402756294682
Bond Position:  [15.53860062]


portfolio before change:  [18.29556198]
curr_Stock_Price:  99.3214691231783
curr_Factors:  [99.32146912]
mat_Sqrt:  [[0.15]]
grads:  [0.04972261]
Stock Position:  0.04972260619881674
Bond Position:  [13.35703968]


portfolio before change:  [18.27308029]
curr_Stock_Price:  98.8357459269298
curr_Factors:  [98.83574593]
mat_Sqrt:  [[0.15]]
grads:  [-0.00128315]
Stock Position:  -0.001283149251698979
Bond Position:  [18.3999013]


portfolio before change:  [18.2754132]
curr_Stock_Price:  98.81019772787238
curr_Factors:  [98.81019773]
mat_Sqrt:  [[0.15]]
grads:  [0.07039227]
Stock Position:  0.07039227407099695
Bond Position:  [11.31993868]


portfolio before change:  [18.24908717]
curr_Stock_Price:  98.41610451885843
curr_Factors:  [98.41610452]
mat_Sqrt:  [[0.15]]
grads:  [-0.00654394]
Stock Position:  -0.006543941071254951
Bond Position:  [18.89311635]


portfolio before change:  [18.25158215]
curr_Stock_Price:  98.39574979051358
curr_Factors:  [98.39574979]
mat_Sqrt:  [[0.15]]
grads:  [-0.06916168]
Stock Position:  -0.06916167979447307
Bond Position:  [25.05679749]


portfolio before change:  [18.29023382]
curr_Stock_Price:  97.88217964351045
curr_Factors:  [97.88217964]
mat_Sqrt:  [[0.15]]
grads:  [-0.03374673]
Stock Position:  -0.03374672594129336
Bond Position:  [21.59343691]


portfolio before change:  [18.3323077]
curr_Stock_Price:  96.71541367921576
curr_Factors:  [96.71541368]
mat_Sqrt:  [[0.15]]
grads:  [8.18940454e-05]
Stock Position:  8.189404542520819e-05
Bond Position:  [18.32438729]


portfolio before change:  [18.33463089]
curr_Stock_Price:  97.11225080238478
curr_Factors:  [97.1122508]
mat_Sqrt:  [[0.15]]
grads:  [-0.05068975]
Stock Position:  -0.05068975440706446
Bond Position:  [23.25722704]


portfolio before change:  [18.37346861]
curr_Stock_Price:  96.40342156458077
curr_Factors:  [96.40342156]
mat_Sqrt:  [[0.15]]
grads:  [-0.01743302]
Stock Position:  -0.017433015262146485
Bond Position:  [20.05407093]


portfolio before change:  [18.38146473]
curr_Stock_Price:  96.08854761058092
curr_Factors:  [96.08854761]
mat_Sqrt:  [[0.15]]
grads:  [0.00508895]
Stock Position:  0.005088954252353795
Bond Position:  [17.8924745]


portfolio before change:  [18.38396847]
curr_Stock_Price:  96.1410228131611
curr_Factors:  [96.14102281]
mat_Sqrt:  [[0.15]]
grads:  [0.09187106]
Stock Position:  0.09187105530621595
Bond Position:  [9.55139124]


portfolio before change:  [18.39191755]
curr_Stock_Price:  96.21455064985065
curr_Factors:  [96.21455065]
mat_Sqrt:  [[0.15]]
grads:  [0.03171391]
Stock Position:  0.03171390705839704
Bond Position:  [15.34057823]


portfolio before change:  [18.39454978]
curr_Stock_Price:  96.23708142797638
curr_Factors:  [96.23708143]
mat_Sqrt:  [[0.15]]
grads:  [0.03609836]
Stock Position:  0.036098362114729166
Bond Position:  [14.92054876]


portfolio before change:  [18.36023797]
curr_Stock_Price:  95.23490323362482
curr_Factors:  [95.23490323]
mat_Sqrt:  [[0.15]]
grads:  [0.01607797]
Stock Position:  0.01607797081951415
Bond Position:  [16.82905398]


portfolio before change:  [18.3623763]
curr_Stock_Price:  95.2370533516404
curr_Factors:  [95.23705335]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149581]
Stock Position:  -0.01495810355086907
Bond Position:  [19.78694201]


portfolio before change:  [18.37110451]
curr_Stock_Price:  94.81890647215901
curr_Factors:  [94.81890647]
mat_Sqrt:  [[0.15]]
grads:  [0.04281591]
Stock Position:  0.042815905413200905
Bond Position:  [14.31134718]


portfolio before change:  [18.38957716]
curr_Stock_Price:  95.2085659308564
curr_Factors:  [95.20856593]
mat_Sqrt:  [[0.15]]
grads:  [-0.12235337]
Stock Position:  -0.12235337002863263
Bond Position:  [30.03866606]


portfolio before change:  [18.50220273]
curr_Stock_Price:  94.31876211585823
curr_Factors:  [94.31876212]
mat_Sqrt:  [[0.15]]
grads:  [-0.15018162]
Stock Position:  -0.1501816182651852
Bond Position:  [32.66714705]


portfolio before change:  [18.53111399]
curr_Stock_Price:  94.15344482186072
curr_Factors:  [94.15344482]
mat_Sqrt:  [[0.15]]
grads:  [0.1428431]
Stock Position:  0.14284309634951659
Bond Position:  [5.0819444]


portfolio before change:  [18.63976428]
curr_Stock_Price:  94.90962420770771
curr_Factors:  [94.90962421]
mat_Sqrt:  [[0.15]]
grads:  [0.01751829]
Stock Position:  0.01751828948162505
Bond Position:  [16.97711001]


portfolio before change:  [18.65397167]
curr_Stock_Price:  95.59948118260061
curr_Factors:  [95.59948118]
mat_Sqrt:  [[0.15]]
grads:  [-0.05312079]
Stock Position:  -0.05312079134945118
Bond Position:  [23.73229176]


portfolio before change:  [18.63591151]
curr_Stock_Price:  95.99531269958798
curr_Factors:  [95.9953127]
mat_Sqrt:  [[0.15]]
grads:  [-0.0830256]
Stock Position:  -0.08302559960543063
Bond Position:  [26.6059799]


portfolio before change:  [18.72720203]
curr_Stock_Price:  94.93582539345103
curr_Factors:  [94.93582539]
mat_Sqrt:  [[0.15]]
grads:  [-0.05001505]
Stock Position:  -0.050015053583157235
Bond Position:  [23.47542242]


portfolio before change:  [18.71215263]
curr_Stock_Price:  95.2953974394001
curr_Factors:  [95.29539744]
mat_Sqrt:  [[0.15]]
grads:  [-0.04284635]
Stock Position:  -0.042846353311118135
Bond Position:  [22.79521289]


portfolio before change:  [18.73679532]
curr_Stock_Price:  94.78676350330014
curr_Factors:  [94.7867635]
mat_Sqrt:  [[0.15]]
grads:  [-0.02521669]
Stock Position:  -0.025216693478308464
Bond Position:  [21.12700408]


portfolio before change:  [18.74372705]
curr_Stock_Price:  94.61661055614222
curr_Factors:  [94.61661056]
mat_Sqrt:  [[0.15]]
grads:  [0.12415191]
Stock Position:  0.12415191031879325
Bond Position:  [6.9968941]


portfolio before change:  [18.80245288]
curr_Stock_Price:  95.08258136561146
curr_Factors:  [95.08258137]
mat_Sqrt:  [[0.15]]
grads:  [0.06748571]
Stock Position:  0.06748571190927032
Bond Position:  [12.38573719]


portfolio before change:  [18.86275723]
curr_Stock_Price:  95.95322533068646
curr_Factors:  [95.95322533]
mat_Sqrt:  [[0.15]]
grads:  [0.13733724]
Stock Position:  0.13733723732341746
Bond Position:  [5.68480635]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.86275723]
Stock Price:  96.44257805730123
PL:  [18.86275723]
Settle:  Tensor("sub_50:0", shape=(), dtype=float64)
PL:  Tensor("sub_51:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  26
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44914987e-03]
 [-1.63505403e-02]
 [ 3.02784274e-03]
 [ 2.29223173e-02]
 [ 7.65969542e-03]
 [ 1.60008863e-02]
 [ 2.72398769e-02]
 [-3.01253965e-03]
 [ 3.77911168e-03]
 [ 2.42481061e-03]
 [ 9.70122735e-03]
 [-1.65428010e-03]
 [ 7.99533128e-03]
 [ 5.77571299e-03]
 [ 9.13582949e-03]
 [-1.13246342e-02]
 [-5.43560879e-03]
 [-1.88377172e-03]
 [-7.51962152e-03]
 [-2.36206086e-03]
 [ 3.72237321e-04]
 [ 8.65893095e-03]
 [ 4.76592601e-03]
 [ 5.64958362e-03]
 [-5.72786509e-04]
 [-3.96413799e-03]
 [-5.52887798e-03]
 [-1.81346072e-02]
 [-2.91102018e-02]
 [ 2.19113846e-02]
 [ 4.91065382e-03]
 [-2.53477041e-03]
 [-1.25335046e-02]
 [-7.54191654e-03]
 [-8.68015389e-03]
 [-7.51839411e-03]
 [ 2.23509224e-02]
 [ 6.85331328e-03]
 [ 2.37617585e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.30835368]
curr_Stock_Price:  100.21699971959028
curr_Factors:  [100.21699972]
mat_Sqrt:  [[0.15]]
grads:  [-0.009661]
Stock Position:  -0.009660999156888572
Bond Position:  [6.27655003]


portfolio before change:  [5.30841699]
curr_Stock_Price:  100.29166150330227
curr_Factors:  [100.2916615]
mat_Sqrt:  [[0.15]]
grads:  [-0.1090036]
Stock Position:  -0.10900360232491818
Bond Position:  [16.24056937]


portfolio before change:  [5.25724521]
curr_Stock_Price:  100.77973683723219
curr_Factors:  [100.77973684]
mat_Sqrt:  [[0.15]]
grads:  [0.02018562]
Stock Position:  0.020185618258861945
Bond Position:  [3.22294392]


portfolio before change:  [5.26586098]
curr_Stock_Price:  101.18660413015967
curr_Factors:  [101.18660413]
mat_Sqrt:  [[0.15]]
grads:  [0.15281545]
Stock Position:  0.15281544867957905
Bond Position:  [-10.19701534]


portfolio before change:  [5.13166208]
curr_Stock_Price:  100.31676937867927
curr_Factors:  [100.31676938]
mat_Sqrt:  [[0.15]]
grads:  [0.05106464]
Stock Position:  0.051064636152195315
Bond Position:  [0.00902275]


portfolio before change:  [5.10092231]
curr_Stock_Price:  99.71476965398523
curr_Factors:  [99.71476965]
mat_Sqrt:  [[0.15]]
grads:  [0.10667258]
Stock Position:  0.10667257505040502
Bond Position:  [-5.53590894]


portfolio before change:  [5.1405787]
curr_Stock_Price:  100.09301511201043
curr_Factors:  [100.09301511]
mat_Sqrt:  [[0.15]]
grads:  [0.18159918]
Stock Position:  0.18159917940252404
Bond Position:  [-13.03623071]


portfolio before change:  [5.07835613]
curr_Stock_Price:  99.75935205860593
curr_Factors:  [99.75935206]
mat_Sqrt:  [[0.15]]
grads:  [-0.0200836]
Stock Position:  -0.02008359765198083
Bond Position:  [7.08188282]


portfolio before change:  [5.04833998]
curr_Stock_Price:  101.29799255748696
curr_Factors:  [101.29799256]
mat_Sqrt:  [[0.15]]
grads:  [0.02519408]
Stock Position:  0.025194077876082036
Bond Position:  [2.49623047]


portfolio before change:  [5.02448886]
curr_Stock_Price:  100.33891099105517
curr_Factors:  [100.33891099]
mat_Sqrt:  [[0.15]]
grads:  [0.0161654]
Stock Position:  0.016165404047313547
Bond Position:  [3.40246982]


portfolio before change:  [5.00492229]
curr_Stock_Price:  99.10220172934255
curr_Factors:  [99.10220173]
mat_Sqrt:  [[0.15]]
grads:  [0.06467485]
Stock Position:  0.06467484899180911
Bond Position:  [-1.40449765]


portfolio before change:  [4.93563001]
curr_Stock_Price:  98.03352193556935
curr_Factors:  [98.03352194]
mat_Sqrt:  [[0.15]]
grads:  [-0.01102853]
Stock Position:  -0.01102853399899789
Bond Position:  [6.01679604]


portfolio before change:  [4.94129735]
curr_Stock_Price:  97.58784240210376
curr_Factors:  [97.5878424]
mat_Sqrt:  [[0.15]]
grads:  [0.05330221]
Stock Position:  0.0533022085531316
Bond Position:  [-0.26035018]


portfolio before change:  [4.89340153]
curr_Stock_Price:  96.6898819517274
curr_Factors:  [96.68988195]
mat_Sqrt:  [[0.15]]
grads:  [0.03850475]
Stock Position:  0.038504753270791656
Bond Position:  [1.17038148]


portfolio before change:  [4.89449559]
curr_Stock_Price:  96.71449602425842
curr_Factors:  [96.71449602]
mat_Sqrt:  [[0.15]]
grads:  [0.06090553]
Stock Position:  0.06090552993801028
Bond Position:  [-0.99595204]


portfolio before change:  [4.90501159]
curr_Stock_Price:  96.88920093785867
curr_Factors:  [96.88920094]
mat_Sqrt:  [[0.15]]
grads:  [-0.07549756]
Stock Position:  -0.07549756160933986
Bond Position:  [12.21991]


portfolio before change:  [4.84123107]
curr_Stock_Price:  97.75423677529777
curr_Factors:  [97.75423678]
mat_Sqrt:  [[0.15]]
grads:  [-0.03623739]
Stock Position:  -0.03623739190988069
Bond Position:  [8.38358966]


portfolio before change:  [4.82655555]
curr_Stock_Price:  98.18814034534732
curr_Factors:  [98.18814035]
mat_Sqrt:  [[0.15]]
grads:  [-0.01255848]
Stock Position:  -0.012558478160662936
Bond Position:  [6.05964917]


portfolio before change:  [4.82810125]
curr_Stock_Price:  98.12537884088609
curr_Factors:  [98.12537884]
mat_Sqrt:  [[0.15]]
grads:  [-0.05013081]
Stock Position:  -0.050130810124429964
Bond Position:  [9.74720598]


portfolio before change:  [4.81778838]
curr_Stock_Price:  98.35540393063928
curr_Factors:  [98.35540393]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574707]
Stock Position:  -0.015747072409041368
Bond Position:  [6.36659805]


portfolio before change:  [4.82521928]
curr_Stock_Price:  97.93405393122558
curr_Factors:  [97.93405393]
mat_Sqrt:  [[0.15]]
grads:  [0.00248158]
Stock Position:  0.002481582139132395
Bond Position:  [4.58218788]


portfolio before change:  [4.82723303]
curr_Stock_Price:  98.51470825721395
curr_Factors:  [98.51470826]
mat_Sqrt:  [[0.15]]
grads:  [0.05772621]
Stock Position:  0.05772620635370651
Bond Position:  [-0.85964734]


portfolio before change:  [4.80949909]
curr_Stock_Price:  98.20936195132991
curr_Factors:  [98.20936195]
mat_Sqrt:  [[0.15]]
grads:  [0.03177284]
Stock Position:  0.03177284007491552
Bond Position:  [1.68910874]


portfolio before change:  [4.79911098]
curr_Stock_Price:  97.87576688924864
curr_Factors:  [97.87576689]
mat_Sqrt:  [[0.15]]
grads:  [0.03766389]
Stock Position:  0.03766389081466011
Bond Position:  [1.11272878]


portfolio before change:  [4.75850144]
curr_Stock_Price:  96.79386489087773
curr_Factors:  [96.79386489]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381858]
Stock Position:  -0.0038185767240673527
Bond Position:  [5.12811624]


portfolio before change:  [4.7594189]
curr_Stock_Price:  96.7214795781938
curr_Factors:  [96.72147958]
mat_Sqrt:  [[0.15]]
grads:  [-0.02642759]
Stock Position:  -0.02642758661094015
Bond Position:  [7.31553418]


portfolio before change:  [4.75409977]
curr_Stock_Price:  96.95735534905533
curr_Factors:  [96.95735535]
mat_Sqrt:  [[0.15]]
grads:  [-0.03685919]
Stock Position:  -0.03685918651138472
Bond Position:  [8.32786902]


portfolio before change:  [4.79393377]
curr_Stock_Price:  95.90489195251071
curr_Factors:  [95.90489195]
mat_Sqrt:  [[0.15]]
grads:  [-0.12089738]
Stock Position:  -0.12089738109387824
Bond Position:  [16.38858404]


portfolio before change:  [4.73131474]
curr_Stock_Price:  96.43978958056223
curr_Factors:  [96.43978958]
mat_Sqrt:  [[0.15]]
grads:  [-0.19406801]
Stock Position:  -0.19406801172567598
Bond Position:  [23.44719296]


portfolio before change:  [4.6225153]
curr_Stock_Price:  97.01551829444968
curr_Factors:  [97.01551829]
mat_Sqrt:  [[0.15]]
grads:  [0.1460759]
Stock Position:  0.14607589707351804
Bond Position:  [-9.54911357]


portfolio before change:  [4.83379308]
curr_Stock_Price:  98.47004637783463
curr_Factors:  [98.47004638]
mat_Sqrt:  [[0.15]]
grads:  [0.03273769]
Stock Position:  0.03273769213683589
Bond Position:  [1.61011102]


portfolio before change:  [4.83004246]
curr_Stock_Price:  98.34933249999037
curr_Factors:  [98.3493325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01689847]
Stock Position:  -0.016898469371162888
Bond Position:  [6.49199565]


portfolio before change:  [4.84018832]
curr_Stock_Price:  97.79695647876655
curr_Factors:  [97.79695648]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835567]
Stock Position:  -0.08355669700093041
Bond Position:  [13.01177898]


portfolio before change:  [4.75665186]
curr_Stock_Price:  98.81618098246234
curr_Factors:  [98.81618098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027944]
Stock Position:  -0.05027944358312417
Bond Position:  [9.72507446]


portfolio before change:  [4.74814544]
curr_Stock_Price:  99.00954306299415
curr_Factors:  [99.00954306]
mat_Sqrt:  [[0.15]]
grads:  [-0.05786769]
Stock Position:  -0.057867692633028725
Bond Position:  [10.47759924]


portfolio before change:  [4.75006514]
curr_Stock_Price:  98.99900313645013
curr_Factors:  [98.99900314]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012263]
Stock Position:  -0.050122627405598315
Bond Position:  [9.71215529]


portfolio before change:  [4.74896495]
curr_Stock_Price:  99.04517566646228
curr_Factors:  [99.04517567]
mat_Sqrt:  [[0.15]]
grads:  [0.14900615]
Stock Position:  0.14900614963172115
Bond Position:  [-10.00937532]


portfolio before change:  [4.96070178]
curr_Stock_Price:  100.47456691321361
curr_Factors:  [100.47456691]
mat_Sqrt:  [[0.15]]
grads:  [0.04568876]
Stock Position:  0.045688755195576344
Bond Position:  [0.37014389]


portfolio before change:  [4.92814928]
curr_Stock_Price:  99.76107031130456
curr_Factors:  [99.76107031]
mat_Sqrt:  [[0.15]]
grads:  [0.15841172]
Stock Position:  0.15841172320394567
Bond Position:  [-10.87517378]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.92814928]
Stock Price:  99.91148334342064
PL:  [4.92814928]
Settle:  Tensor("sub_52:0", shape=(), dtype=float64)
PL:  Tensor("sub_53:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  27
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51920064e-03]
 [-3.79770995e-03]
 [ 2.10833474e-02]
 [ 1.44637238e-02]
 [ 1.22225795e-02]
 [ 1.61791916e-02]
 [ 1.76071716e-02]
 [-3.21143864e-03]
 [ 1.73839080e-02]
 [-2.63161600e-03]
 [ 4.98034547e-03]
 [ 1.12371317e-02]
 [-1.02421883e-02]
 [ 1.24903132e-02]
 [-6.87884780e-03]
 [-2.64981046e-02]
 [ 3.92043045e-03]
 [-3.12583610e-03]
 [-2.47863625e-03]
 [-2.84756891e-03]
 [-8.75492202e-04]
 [-3.48954260e-02]
 [ 4.78992194e-03]
 [ 7.37645915e-03]
 [-3.84318664e-03]
 [-8.92151866e-03]
 [-8.32208337e-04]
 [-7.68858945e-03]
 [ 5.48970529e-02]
 [ 2.68728090e-02]
 [-3.25643255e-02]
 [ 2.83257797e-03]
 [-1.33004602e-02]
 [ 6.41419399e-03]
 [-7.49884523e-03]
 [ 8.43849187e-03]
 [ 2.51576339e-02]
 [ 1.55799949e-02]
 [ 1.61292796e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.88115077]
curr_Stock_Price:  100.31832256484326
curr_Factors:  [100.31832256]
mat_Sqrt:  [[0.15]]
grads:  [-0.010128]
Stock Position:  -0.010128004277837974
Bond Position:  [7.89717517]


portfolio before change:  [6.87190206]
curr_Stock_Price:  101.3289774378097
curr_Factors:  [101.32897744]
mat_Sqrt:  [[0.15]]
grads:  [-0.02531807]
Stock Position:  -0.025318066308316827
Bond Position:  [9.43735583]


portfolio before change:  [6.89839656]
curr_Stock_Price:  100.3291079986928
curr_Factors:  [100.329108]
mat_Sqrt:  [[0.15]]
grads:  [0.14055565]
Stock Position:  0.14055564904414616
Bond Position:  [-7.20342633]


portfolio before change:  [6.98204809]
curr_Stock_Price:  100.93066342861421
curr_Factors:  [100.93066343]
mat_Sqrt:  [[0.15]]
grads:  [0.09642483]
Stock Position:  0.09642482540372413
Bond Position:  [-2.75017351]


portfolio before change:  [6.94594347]
curr_Stock_Price:  100.5597960278327
curr_Factors:  [100.55979603]
mat_Sqrt:  [[0.15]]
grads:  [0.08148386]
Stock Position:  0.08148386344781026
Bond Position:  [-1.24805721]


portfolio before change:  [6.87374635]
curr_Stock_Price:  99.67568098314035
curr_Factors:  [99.67568098]
mat_Sqrt:  [[0.15]]
grads:  [0.10786128]
Stock Position:  0.10786127752572947
Bond Position:  [-3.87739994]


portfolio before change:  [6.78796663]
curr_Stock_Price:  98.88489664714025
curr_Factors:  [98.88489665]
mat_Sqrt:  [[0.15]]
grads:  [0.11738114]
Stock Position:  0.11738114403488596
Bond Position:  [-4.81925566]


portfolio before change:  [6.82861806]
curr_Stock_Price:  99.23634888467431
curr_Factors:  [99.23634888]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140959]
Stock Position:  -0.02140959094893931
Bond Position:  [8.95322769]


portfolio before change:  [6.82882048]
curr_Stock_Price:  99.2791706878174
curr_Factors:  [99.27917069]
mat_Sqrt:  [[0.15]]
grads:  [0.11589272]
Stock Position:  0.11589271987925011
Bond Position:  [-4.67691264]


portfolio before change:  [6.79916177]
curr_Stock_Price:  99.02830020143708
curr_Factors:  [99.0283002]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754411]
Stock Position:  -0.017544106661611204
Bond Position:  [8.53652483]


portfolio before change:  [6.78479069]
curr_Stock_Price:  99.90826579744382
curr_Factors:  [99.9082658]
mat_Sqrt:  [[0.15]]
grads:  [0.0332023]
Stock Position:  0.033202303128966354
Bond Position:  [3.46760616]


portfolio before change:  [6.78214569]
curr_Stock_Price:  99.81554710044429
curr_Factors:  [99.8155471]
mat_Sqrt:  [[0.15]]
grads:  [0.07491421]
Stock Position:  0.07491421138338467
Bond Position:  [-0.6954573]


portfolio before change:  [6.85713587]
curr_Stock_Price:  100.81772160730799
curr_Factors:  [100.81772161]
mat_Sqrt:  [[0.15]]
grads:  [-0.06828126]
Stock Position:  -0.06828125550351734
Bond Position:  [13.74109648]


portfolio before change:  [6.89437104]
curr_Stock_Price:  100.29755796024367
curr_Factors:  [100.29755796]
mat_Sqrt:  [[0.15]]
grads:  [0.08326875]
Stock Position:  0.08326875477581033
Bond Position:  [-1.45728172]


portfolio before change:  [6.97731962]
curr_Stock_Price:  101.29590065775005
curr_Factors:  [101.29590066]
mat_Sqrt:  [[0.15]]
grads:  [-0.04585899]
Stock Position:  -0.045858985330883846
Bond Position:  [11.62264684]


portfolio before change:  [6.93291438]
curr_Stock_Price:  102.29588266216705
curr_Factors:  [102.29588266]
mat_Sqrt:  [[0.15]]
grads:  [-0.17665403]
Stock Position:  -0.1766540309266807
Bond Position:  [25.0038944]


portfolio before change:  [6.95308126]
curr_Stock_Price:  102.19941619400802
curr_Factors:  [102.19941619]
mat_Sqrt:  [[0.15]]
grads:  [0.0261362]
Stock Position:  0.026136202967035924
Bond Position:  [4.28197657]


portfolio before change:  [6.9842572]
curr_Stock_Price:  103.37176203026465
curr_Factors:  [103.37176203]
mat_Sqrt:  [[0.15]]
grads:  [-0.02083891]
Stock Position:  -0.020838907321846744
Bond Position:  [9.13841177]


portfolio before change:  [7.00015036]
curr_Stock_Price:  102.66391394736976
curr_Factors:  [102.66391395]
mat_Sqrt:  [[0.15]]
grads:  [-0.01652424]
Stock Position:  -0.01652424166243558
Bond Position:  [8.69659368]


portfolio before change:  [6.99839422]
curr_Stock_Price:  102.83598135494408
curr_Factors:  [102.83598135]
mat_Sqrt:  [[0.15]]
grads:  [-0.01898379]
Stock Position:  -0.018983792762514145
Bond Position:  [8.95061118]


portfolio before change:  [7.00501159]
curr_Stock_Price:  102.54634072710905
curr_Factors:  [102.54634073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00583661]
Stock Position:  -0.00583661468193023
Bond Position:  [7.60353507]


portfolio before change:  [7.00123115]
curr_Stock_Price:  103.35690325656884
curr_Factors:  [103.35690326]
mat_Sqrt:  [[0.15]]
grads:  [-0.23263617]
Stock Position:  -0.23263617331557934
Bond Position:  [31.04578561]


portfolio before change:  [7.28700375]
curr_Stock_Price:  102.14517584533547
curr_Factors:  [102.14517585]
mat_Sqrt:  [[0.15]]
grads:  [0.03193281]
Stock Position:  0.031932812915497995
Bond Position:  [4.02522095]


portfolio before change:  [7.26192621]
curr_Stock_Price:  101.34409647705672
curr_Factors:  [101.34409648]
mat_Sqrt:  [[0.15]]
grads:  [0.04917639]
Stock Position:  0.04917639435587303
Bond Position:  [2.27818896]


portfolio before change:  [7.26758551]
curr_Stock_Price:  101.45338691661154
curr_Factors:  [101.45338692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02562124]
Stock Position:  -0.025621244240184214
Bond Position:  [9.86694752]


portfolio before change:  [7.29681447]
curr_Stock_Price:  100.36071895773426
curr_Factors:  [100.36071896]
mat_Sqrt:  [[0.15]]
grads:  [-0.05947679]
Stock Position:  -0.05947679107317487
Bond Position:  [13.26594798]


portfolio before change:  [7.17785163]
curr_Stock_Price:  102.38875693197323
curr_Factors:  [102.38875693]
mat_Sqrt:  [[0.15]]
grads:  [-0.00554806]
Stock Position:  -0.005548055582918199
Bond Position:  [7.74591014]


portfolio before change:  [7.17405503]
curr_Stock_Price:  103.24759690551447
curr_Factors:  [103.24759691]
mat_Sqrt:  [[0.15]]
grads:  [-0.05125726]
Stock Position:  -0.05125726299135437
Bond Position:  [12.46624426]


portfolio before change:  [7.02496214]
curr_Stock_Price:  106.18671736089604
curr_Factors:  [106.18671736]
mat_Sqrt:  [[0.15]]
grads:  [0.36598035]
Stock Position:  0.3659803527274608
Bond Position:  [-31.83729013]


portfolio before change:  [7.17264131]
curr_Stock_Price:  106.60110866122268
curr_Factors:  [106.60110866]
mat_Sqrt:  [[0.15]]
grads:  [0.17915206]
Stock Position:  0.1791520602375529
Bond Position:  [-11.92516693]


portfolio before change:  [7.27546645]
curr_Stock_Price:  107.18338433067571
curr_Factors:  [107.18338433]
mat_Sqrt:  [[0.15]]
grads:  [-0.2170955]
Stock Position:  -0.21709550347019968
Bond Position:  [30.54449724]


portfolio before change:  [7.16209889]
curr_Stock_Price:  107.72317377501506
curr_Factors:  [107.72317378]
mat_Sqrt:  [[0.15]]
grads:  [0.01888385]
Stock Position:  0.018883853143469426
Bond Position:  [5.1278703]


portfolio before change:  [7.17237511]
curr_Stock_Price:  108.23340831796082
curr_Factors:  [108.23340832]
mat_Sqrt:  [[0.15]]
grads:  [-0.08866973]
Stock Position:  -0.08866973446952946
Bond Position:  [16.76940269]


portfolio before change:  [7.20788635]
curr_Stock_Price:  107.85656120796133
curr_Factors:  [107.85656121]
mat_Sqrt:  [[0.15]]
grads:  [0.04276129]
Stock Position:  0.04276129328080996
Bond Position:  [2.5958003]


portfolio before change:  [7.21865365]
curr_Stock_Price:  108.10077270245291
curr_Factors:  [108.1007727]
mat_Sqrt:  [[0.15]]
grads:  [-0.0499923]
Stock Position:  -0.04999230151522906
Bond Position:  [12.62286007]


portfolio before change:  [7.19945264]
curr_Stock_Price:  108.5164158766246
curr_Factors:  [108.51641588]
mat_Sqrt:  [[0.15]]
grads:  [0.05625661]
Stock Position:  0.056256612462476825
Bond Position:  [1.09468669]


portfolio before change:  [7.25934714]
curr_Stock_Price:  109.5786492303888
curr_Factors:  [109.57864923]
mat_Sqrt:  [[0.15]]
grads:  [0.16771756]
Stock Position:  0.16771755906650085
Bond Position:  [-11.11891644]


portfolio before change:  [7.44320056]
curr_Stock_Price:  110.68314524615764
curr_Factors:  [110.68314525]
mat_Sqrt:  [[0.15]]
grads:  [0.10386663]
Stock Position:  0.10386663293107723
Bond Position:  [-4.05308506]


portfolio before change:  [7.55805342]
curr_Stock_Price:  111.7937956955491
curr_Factors:  [111.7937957]
mat_Sqrt:  [[0.15]]
grads:  [0.10752853]
Stock Position:  0.10752853053923303
Bond Position:  [-4.46296916]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.55805342]
Stock Price:  113.39942620617197
PL:  [-5.84137279]
Settle:  Tensor("sub_54:0", shape=(), dtype=float64)
PL:  Tensor("sub_55:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  28
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44513266e-03]
 [ 2.69028334e-03]
 [-1.59637454e-02]
 [-1.64919224e-02]
 [ 1.50371895e-02]
 [ 2.37911115e-02]
 [ 2.91910689e-03]
 [-8.65972538e-03]
 [-7.27438237e-03]
 [ 5.78744634e-04]
 [-4.39558176e-02]
 [-8.42772126e-03]
 [ 1.14227747e-02]
 [ 8.68627225e-03]
 [ 2.48050281e-03]
 [-1.23901170e-02]
 [-7.40198529e-03]
 [ 1.42396239e-04]
 [-7.65158779e-03]
 [-2.75224415e-03]
 [ 9.22230944e-04]
 [ 1.40471211e-02]
 [ 4.75499602e-03]
 [ 5.59892041e-03]
 [ 8.46735826e-03]
 [ 9.27534705e-05]
 [ 2.04503145e-02]
 [-2.23791884e-02]
 [-8.66744977e-03]
 [ 2.16013849e-02]
 [ 2.46841723e-03]
 [-2.25725335e-02]
 [-1.19051333e-02]
 [ 5.25548316e-03]
 [-7.63044546e-03]
 [ 3.67807720e-03]
 [ 1.61168790e-02]
 [ 1.88204632e-02]
 [ 1.04176701e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.83068082]
curr_Stock_Price:  100.12180497493463
curr_Factors:  [100.12180497]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963422]
Stock Position:  -0.00963421775644718
Bond Position:  [4.7952761]


portfolio before change:  [3.83941757]
curr_Stock_Price:  99.27718036952055
curr_Factors:  [99.27718037]
mat_Sqrt:  [[0.15]]
grads:  [0.01793522]
Stock Position:  0.01793522228850851
Bond Position:  [2.05885927]


portfolio before change:  [3.83508302]
curr_Stock_Price:  99.02115224181836
curr_Factors:  [99.02115224]
mat_Sqrt:  [[0.15]]
grads:  [-0.10642497]
Stock Position:  -0.10642496936828709
Bond Position:  [14.37340612]


portfolio before change:  [3.85244075]
curr_Stock_Price:  98.8749371020142
curr_Factors:  [98.8749371]
mat_Sqrt:  [[0.15]]
grads:  [-0.10994615]
Stock Position:  -0.109946149383498
Bond Position:  [14.72335936]


portfolio before change:  [3.90405968]
curr_Stock_Price:  98.42218457692034
curr_Factors:  [98.42218458]
mat_Sqrt:  [[0.15]]
grads:  [0.10024793]
Stock Position:  0.10024793017090877
Bond Position:  [-5.9625606]


portfolio before change:  [3.8485927]
curr_Stock_Price:  97.87632181780906
curr_Factors:  [97.87632182]
mat_Sqrt:  [[0.15]]
grads:  [0.15860741]
Stock Position:  0.1586074101377065
Bond Position:  [-11.67531721]


portfolio before change:  [3.74367021]
curr_Stock_Price:  97.22400053332895
curr_Factors:  [97.22400053]
mat_Sqrt:  [[0.15]]
grads:  [0.01946071]
Stock Position:  0.019460712587172094
Bond Position:  [1.85162188]


portfolio before change:  [3.74190741]
curr_Stock_Price:  97.12152387202968
curr_Factors:  [97.12152387]
mat_Sqrt:  [[0.15]]
grads:  [-0.0577315]
Stock Position:  -0.05773150252928863
Bond Position:  [9.34887891]


portfolio before change:  [3.81654661]
curr_Stock_Price:  95.84889938862851
curr_Factors:  [95.84889939]
mat_Sqrt:  [[0.15]]
grads:  [-0.04849588]
Stock Position:  -0.048495882477624534
Bond Position:  [8.46482357]


portfolio before change:  [3.75822504]
curr_Stock_Price:  97.07332785694041
curr_Factors:  [97.07332786]
mat_Sqrt:  [[0.15]]
grads:  [0.0038583]
Stock Position:  0.0038582975623703266
Bond Position:  [3.38368726]


portfolio before change:  [3.75817964]
curr_Stock_Price:  96.9519305296695
curr_Factors:  [96.95193053]
mat_Sqrt:  [[0.15]]
grads:  [-0.29303878]
Stock Position:  -0.29303878431537267
Bond Position:  [32.1688555]


portfolio before change:  [3.72911204]
curr_Stock_Price:  97.06484718206417
curr_Factors:  [97.06484718]
mat_Sqrt:  [[0.15]]
grads:  [-0.05618481]
Stock Position:  -0.056184808403463876
Bond Position:  [9.18268189]


portfolio before change:  [3.76892617]
curr_Stock_Price:  96.37665015527914
curr_Factors:  [96.37665016]
mat_Sqrt:  [[0.15]]
grads:  [0.07615183]
Stock Position:  0.07615183161283823
Bond Position:  [-3.57033226]


portfolio before change:  [3.86628285]
curr_Stock_Price:  97.66096599778625
curr_Factors:  [97.660966]
mat_Sqrt:  [[0.15]]
grads:  [0.05790848]
Stock Position:  0.057908481673673046
Bond Position:  [-1.78911541]


portfolio before change:  [3.87745391]
curr_Stock_Price:  97.85773691879453
curr_Factors:  [97.85773692]
mat_Sqrt:  [[0.15]]
grads:  [0.01653669]
Stock Position:  0.01653668542224946
Bond Position:  [2.25921129]


portfolio before change:  [3.86869164]
curr_Stock_Price:  97.31079049774092
curr_Factors:  [97.3107905]
mat_Sqrt:  [[0.15]]
grads:  [-0.08260078]
Stock Position:  -0.08260078016598302
Bond Position:  [11.90663886]


portfolio before change:  [3.88917479]
curr_Stock_Price:  97.08083227742802
curr_Factors:  [97.08083228]
mat_Sqrt:  [[0.15]]
grads:  [-0.04934657]
Stock Position:  -0.04934656860232119
Bond Position:  [8.67978074]


portfolio before change:  [3.9349358]
curr_Stock_Price:  96.17548121972247
curr_Factors:  [96.17548122]
mat_Sqrt:  [[0.15]]
grads:  [0.00094931]
Stock Position:  0.0009493082611236126
Bond Position:  [3.84363562]


portfolio before change:  [3.93551337]
curr_Stock_Price:  96.27774331355644
curr_Factors:  [96.27774331]
mat_Sqrt:  [[0.15]]
grads:  [-0.05101059]
Stock Position:  -0.05101058526632722
Bond Position:  [8.8466974]


portfolio before change:  [3.97269334]
curr_Stock_Price:  95.5705553476256
curr_Factors:  [95.57055535]
mat_Sqrt:  [[0.15]]
grads:  [-0.01834829]
Stock Position:  -0.018348294303335476
Bond Position:  [5.72625002]


portfolio before change:  [3.97766138]
curr_Stock_Price:  95.33880562787749
curr_Factors:  [95.33880563]
mat_Sqrt:  [[0.15]]
grads:  [0.00614821]
Stock Position:  0.006148206293890779
Bond Position:  [3.39149874]


portfolio before change:  [3.98158025]
curr_Stock_Price:  95.90724920211562
curr_Factors:  [95.9072492]
mat_Sqrt:  [[0.15]]
grads:  [0.09364747]
Stock Position:  0.09364747407085164
Bond Position:  [-4.99989138]


portfolio before change:  [3.86842276]
curr_Stock_Price:  94.70558873596926
curr_Factors:  [94.70558874]
mat_Sqrt:  [[0.15]]
grads:  [0.03169997]
Stock Position:  0.03169997345207377
Bond Position:  [0.86625811]


portfolio before change:  [3.84024441]
curr_Stock_Price:  93.81326502374824
curr_Factors:  [93.81326502]
mat_Sqrt:  [[0.15]]
grads:  [0.03732614]
Stock Position:  0.03732613604184919
Bond Position:  [0.33855772]


portfolio before change:  [3.7948608]
curr_Stock_Price:  92.59626439882238
curr_Factors:  [92.5962644]
mat_Sqrt:  [[0.15]]
grads:  [0.05644906]
Stock Position:  0.05644905509540585
Bond Position:  [-1.43211083]


portfolio before change:  [3.84129885]
curr_Stock_Price:  93.42208994214252
curr_Factors:  [93.42208994]
mat_Sqrt:  [[0.15]]
grads:  [0.00061836]
Stock Position:  0.0006183564696926371
Bond Position:  [3.7835307]


portfolio before change:  [3.8409528]
curr_Stock_Price:  92.09757478211812
curr_Factors:  [92.09757478]
mat_Sqrt:  [[0.15]]
grads:  [0.13633543]
Stock Position:  0.1363354301611387
Bond Position:  [-8.71520968]


portfolio before change:  [3.78368958]
curr_Stock_Price:  91.68554872454908
curr_Factors:  [91.68554872]
mat_Sqrt:  [[0.15]]
grads:  [-0.14919459]
Stock Position:  -0.14919458933573845
Bond Position:  [17.46267737]


portfolio before change:  [3.92710754]
curr_Stock_Price:  90.73889921877634
curr_Factors:  [90.73889922]
mat_Sqrt:  [[0.15]]
grads:  [-0.057783]
Stock Position:  -0.05778299843632688
Bond Position:  [9.17027321]


portfolio before change:  [3.89845248]
curr_Stock_Price:  91.25464635451169
curr_Factors:  [91.25464635]
mat_Sqrt:  [[0.15]]
grads:  [0.14400923]
Stock Position:  0.14400923272798608
Bond Position:  [-9.24305913]


portfolio before change:  [3.68480697]
curr_Stock_Price:  89.77911557656586
curr_Factors:  [89.77911558]
mat_Sqrt:  [[0.15]]
grads:  [0.01645611]
Stock Position:  0.01645611484504504
Bond Position:  [2.20739153]


portfolio before change:  [3.68168691]
curr_Stock_Price:  89.57274877948608
curr_Factors:  [89.57274878]
mat_Sqrt:  [[0.15]]
grads:  [-0.15048356]
Stock Position:  -0.15048355674681305
Bond Position:  [17.16091273]


portfolio before change:  [3.70469013]
curr_Stock_Price:  89.4341424515105
curr_Factors:  [89.43414245]
mat_Sqrt:  [[0.15]]
grads:  [-0.07936756]
Stock Position:  -0.07936755545948175
Bond Position:  [10.80285939]


portfolio before change:  [3.80543451]
curr_Stock_Price:  88.18181795290964
curr_Factors:  [88.18181795]
mat_Sqrt:  [[0.15]]
grads:  [0.03503655]
Stock Position:  0.035036554376358144
Bond Position:  [0.71584745]


portfolio before change:  [3.79234612]
curr_Stock_Price:  87.80570019510415
curr_Factors:  [87.8057002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05086964]
Stock Position:  -0.050869636399009814
Bond Position:  [8.25899017]


portfolio before change:  [3.76178307]
curr_Stock_Price:  88.42680723797805
curr_Factors:  [88.42680724]
mat_Sqrt:  [[0.15]]
grads:  [0.02452051]
Stock Position:  0.024520514694352537
Bond Position:  [1.59351225]


portfolio before change:  [3.76481482]
curr_Stock_Price:  88.54232439376983
curr_Factors:  [88.54232439]
mat_Sqrt:  [[0.15]]
grads:  [0.10744586]
Stock Position:  0.10744585971271
Bond Position:  [-5.74869135]


portfolio before change:  [3.76797894]
curr_Stock_Price:  88.5784612850517
curr_Factors:  [88.57846129]
mat_Sqrt:  [[0.15]]
grads:  [0.12546975]
Stock Position:  0.125469754419211
Bond Position:  [-7.34593884]


portfolio before change:  [3.74012704]
curr_Stock_Price:  88.36379916338062
curr_Factors:  [88.36379916]
mat_Sqrt:  [[0.15]]
grads:  [0.06945113]
Stock Position:  0.06945113431580555
Bond Position:  [-2.39683904]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.74012704]
Stock Price:  88.01207617632848
PL:  [3.74012704]
Settle:  Tensor("sub_56:0", shape=(), dtype=float64)
PL:  Tensor("sub_57:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  29
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.54129574e-03]
 [ 4.87875819e-03]
 [ 1.51558872e-02]
 [-6.19923280e-03]
 [ 4.99990642e-03]
 [ 1.73747917e-02]
 [ 2.70309569e-02]
 [-5.72505431e-04]
 [ 5.44749157e-03]
 [ 1.18309505e-02]
 [ 2.72314139e-02]
 [-6.20627544e-03]
 [-1.21783166e-02]
 [ 9.65024705e-03]
 [ 3.17061541e-04]
 [-2.94707270e-02]
 [ 4.90568937e-03]
 [-4.71996545e-03]
 [-2.03852904e-03]
 [-3.48819390e-03]
 [-2.29123041e-03]
 [-3.94291514e-02]
 [ 4.83535656e-03]
 [ 1.19734966e-02]
 [-5.65476801e-03]
 [ 1.99514416e-02]
 [-1.72256807e-02]
 [ 1.07001498e-02]
 [ 7.28470574e-02]
 [ 2.79145833e-02]
 [-3.59022550e-02]
 [ 4.42275553e-03]
 [-1.32242372e-02]
 [ 5.22544917e-03]
 [-7.40373839e-03]
 [ 7.90655874e-03]
 [ 2.50657882e-02]
 [ 1.02379902e-02]
 [ 1.77461862e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.52912003]
curr_Stock_Price:  100.36006608632921
curr_Factors:  [100.36006609]
mat_Sqrt:  [[0.15]]
grads:  [-0.0102753]
Stock Position:  -0.010275304905532086
Bond Position:  [8.56035031]


portfolio before change:  [7.54010092]
curr_Stock_Price:  99.39554202362943
curr_Factors:  [99.39554202]
mat_Sqrt:  [[0.15]]
grads:  [0.03252505]
Stock Position:  0.03252505458554166
Bond Position:  [4.30725549]


portfolio before change:  [7.55439525]
curr_Stock_Price:  99.81847416242927
curr_Factors:  [99.81847416]
mat_Sqrt:  [[0.15]]
grads:  [0.10103925]
Stock Position:  0.1010392481404098
Bond Position:  [-2.53118833]


portfolio before change:  [7.55263051]
curr_Stock_Price:  99.80413988666302
curr_Factors:  [99.80413989]
mat_Sqrt:  [[0.15]]
grads:  [-0.04132822]
Stock Position:  -0.04132821865138186
Bond Position:  [11.67735782]


portfolio before change:  [7.54680788]
curr_Stock_Price:  99.98034855018795
curr_Factors:  [99.98034855]
mat_Sqrt:  [[0.15]]
grads:  [0.03333271]
Stock Position:  0.033332709439369654
Bond Position:  [4.21419197]


portfolio before change:  [7.55873958]
curr_Stock_Price:  100.3225016920703
curr_Factors:  [100.32250169]
mat_Sqrt:  [[0.15]]
grads:  [0.11583194]
Stock Position:  0.11583194446905641
Bond Position:  [-4.06181087]


portfolio before change:  [7.5717738]
curr_Stock_Price:  100.43941230139971
curr_Factors:  [100.4394123]
mat_Sqrt:  [[0.15]]
grads:  [0.18020638]
Stock Position:  0.18020637952118876
Bond Position:  [-10.52804905]


portfolio before change:  [7.78352449]
curr_Stock_Price:  101.62176097857224
curr_Factors:  [101.62176098]
mat_Sqrt:  [[0.15]]
grads:  [-0.0038167]
Stock Position:  -0.0038167028764450476
Bond Position:  [8.17138455]


portfolio before change:  [7.78439166]
curr_Stock_Price:  101.66219175922234
curr_Factors:  [101.66219176]
mat_Sqrt:  [[0.15]]
grads:  [0.03631661]
Stock Position:  0.03631661044330382
Bond Position:  [4.09236545]


portfolio before change:  [7.80479757]
curr_Stock_Price:  102.20999418354921
curr_Factors:  [102.20999418]
mat_Sqrt:  [[0.15]]
grads:  [0.078873]
Stock Position:  0.07887300306582959
Bond Position:  [-0.25681162]


portfolio before change:  [7.7945209]
curr_Stock_Price:  102.08010735546702
curr_Factors:  [102.08010736]
mat_Sqrt:  [[0.15]]
grads:  [0.18154276]
Stock Position:  0.18154275918407997
Bond Position:  [-10.73738345]


portfolio before change:  [8.05960053]
curr_Stock_Price:  103.54765079714366
curr_Factors:  [103.5476508]
mat_Sqrt:  [[0.15]]
grads:  [-0.04137517]
Stock Position:  -0.04137516963149885
Bond Position:  [12.34390214]


portfolio before change:  [8.0864731]
curr_Stock_Price:  102.93546023457596
curr_Factors:  [102.93546023]
mat_Sqrt:  [[0.15]]
grads:  [-0.08118878]
Stock Position:  -0.0811887772931471
Bond Position:  [16.44367726]


portfolio before change:  [8.10188035]
curr_Stock_Price:  102.77100820324672
curr_Factors:  [102.7710082]
mat_Sqrt:  [[0.15]]
grads:  [0.06433498]
Stock Position:  0.06433498036142049
Bond Position:  [1.49010955]


portfolio before change:  [8.15026099]
curr_Stock_Price:  103.52012422548614
curr_Factors:  [103.52012423]
mat_Sqrt:  [[0.15]]
grads:  [0.00211374]
Stock Position:  0.0021137436082085325
Bond Position:  [7.93144599]


portfolio before change:  [8.15203396]
curr_Stock_Price:  103.88983577115661
curr_Factors:  [103.88983577]
mat_Sqrt:  [[0.15]]
grads:  [-0.19647151]
Stock Position:  -0.1964715136342729
Bond Position:  [28.56342724]


portfolio before change:  [8.1296067]
curr_Stock_Price:  104.02215980085153
curr_Factors:  [104.0221598]
mat_Sqrt:  [[0.15]]
grads:  [0.0327046]
Stock Position:  0.03270459579895348
Bond Position:  [4.72760401]


portfolio before change:  [8.12080284]
curr_Stock_Price:  103.73489580331547
curr_Factors:  [103.7348958]
mat_Sqrt:  [[0.15]]
grads:  [-0.03146644]
Stock Position:  -0.031466436301786777
Bond Position:  [11.38497033]


portfolio before change:  [8.15293946]
curr_Stock_Price:  102.75882678063154
curr_Factors:  [102.75882678]
mat_Sqrt:  [[0.15]]
grads:  [-0.01359019]
Stock Position:  -0.0135901935755392
Bond Position:  [9.54945181]


portfolio before change:  [8.13059734]
curr_Stock_Price:  104.49065495967389
curr_Factors:  [104.49065496]
mat_Sqrt:  [[0.15]]
grads:  [-0.02325463]
Stock Position:  -0.023254625998091683
Bond Position:  [10.56048844]


portfolio before change:  [8.11218485]
curr_Stock_Price:  105.33920130422298
curr_Factors:  [105.3392013]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527487]
Stock Position:  -0.0152748694130063
Bond Position:  [9.7212274]


portfolio before change:  [8.11090779]
curr_Stock_Price:  105.50236457558398
curr_Factors:  [105.50236458]
mat_Sqrt:  [[0.15]]
grads:  [-0.26286101]
Stock Position:  -0.2628610092178652
Bond Position:  [35.84336581]


portfolio before change:  [7.95446302]
curr_Stock_Price:  106.11457203988014
curr_Factors:  [106.11457204]
mat_Sqrt:  [[0.15]]
grads:  [0.03223571]
Stock Position:  0.03223571042049115
Bond Position:  [4.5337844]


portfolio before change:  [7.95280269]
curr_Stock_Price:  106.04548452938538
curr_Factors:  [106.04548453]
mat_Sqrt:  [[0.15]]
grads:  [0.07982331]
Stock Position:  0.07982331040103435
Bond Position:  [-0.51209894]


portfolio before change:  [7.92026222]
curr_Stock_Price:  105.63863029511975
curr_Factors:  [105.6386303]
mat_Sqrt:  [[0.15]]
grads:  [-0.03769845]
Stock Position:  -0.037698453385472286
Bond Position:  [11.9026752]


portfolio before change:  [7.84379297]
curr_Stock_Price:  107.70654489539285
curr_Factors:  [107.7065449]
mat_Sqrt:  [[0.15]]
grads:  [0.13300961]
Stock Position:  0.1330096103623644
Bond Position:  [-6.4822126]


portfolio before change:  [7.86350987]
curr_Stock_Price:  107.8608738099658
curr_Factors:  [107.86087381]
mat_Sqrt:  [[0.15]]
grads:  [-0.11483787]
Stock Position:  -0.11483787119625648
Bond Position:  [20.250023]


portfolio before change:  [7.92655483]
curr_Stock_Price:  107.33392613367998
curr_Factors:  [107.33392613]
mat_Sqrt:  [[0.15]]
grads:  [0.07133433]
Stock Position:  0.07133433232546518
Bond Position:  [0.26996087]


portfolio before change:  [7.93415577]
curr_Stock_Price:  107.44000677238282
curr_Factors:  [107.44000677]
mat_Sqrt:  [[0.15]]
grads:  [0.48564705]
Stock Position:  0.4856470493473945
Bond Position:  [-44.2437665]


portfolio before change:  [8.29882713]
curr_Stock_Price:  108.20229326256535
curr_Factors:  [108.20229326]
mat_Sqrt:  [[0.15]]
grads:  [0.18609722]
Stock Position:  0.1860972218901259
Bond Position:  [-11.83731904]


portfolio before change:  [8.21669]
curr_Stock_Price:  107.76887801925395
curr_Factors:  [107.76887802]
mat_Sqrt:  [[0.15]]
grads:  [-0.23934837]
Stock Position:  -0.2393483669636942
Bond Position:  [34.01099497]


portfolio before change:  [8.46827667]
curr_Stock_Price:  106.73550968707451
curr_Factors:  [106.73550969]
mat_Sqrt:  [[0.15]]
grads:  [0.02948504]
Stock Position:  0.029485036863858307
Bond Position:  [5.32117623]


portfolio before change:  [8.48260089]
curr_Stock_Price:  107.19876285971174
curr_Factors:  [107.19876286]
mat_Sqrt:  [[0.15]]
grads:  [-0.08816158]
Stock Position:  -0.08816158163268552
Bond Position:  [17.93341338]


portfolio before change:  [8.49506883]
curr_Stock_Price:  107.0827699599286
curr_Factors:  [107.08276996]
mat_Sqrt:  [[0.15]]
grads:  [0.03483633]
Stock Position:  0.03483632783021869
Bond Position:  [4.76469835]


portfolio before change:  [8.52344994]
curr_Stock_Price:  107.88037081020522
curr_Factors:  [107.88037081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04935826]
Stock Position:  -0.049358255929410795
Bond Position:  [13.84823689]


portfolio before change:  [8.50568008]
curr_Stock_Price:  108.27546171515833
curr_Factors:  [108.27546172]
mat_Sqrt:  [[0.15]]
grads:  [0.05271039]
Stock Position:  0.05271039160003626
Bond Position:  [2.79843809]


portfolio before change:  [8.55033379]
curr_Stock_Price:  109.11597692817512
curr_Factors:  [109.11597693]
mat_Sqrt:  [[0.15]]
grads:  [0.16710525]
Stock Position:  0.16710525496031028
Bond Position:  [-9.68351936]


portfolio before change:  [8.42922054]
curr_Stock_Price:  108.39844872482497
curr_Factors:  [108.39844872]
mat_Sqrt:  [[0.15]]
grads:  [0.06825327]
Stock Position:  0.06825326809675829
Bond Position:  [1.03067216]


portfolio before change:  [8.47480551]
curr_Stock_Price:  109.0644406509963
curr_Factors:  [109.06444065]
mat_Sqrt:  [[0.15]]
grads:  [0.11830791]
Stock Position:  0.11830790829237423
Bond Position:  [-4.42838033]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.47480551]
Stock Price:  108.31824618006323
PL:  [0.15655933]
Settle:  Tensor("sub_58:0", shape=(), dtype=float64)
PL:  Tensor("sub_59:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  30
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.73842653e-03]
 [ 3.40733060e-03]
 [ 2.76244858e-03]
 [ 7.56108664e-03]
 [ 2.09372062e-02]
 [ 2.88915711e-02]
 [ 1.00102650e-02]
 [-6.19059943e-04]
 [ 4.07679920e-03]
 [ 2.58824741e-03]
 [ 1.25146498e-02]
 [ 1.14596767e-02]
 [-1.06932101e-02]
 [ 1.17377502e-02]
 [-6.26388663e-03]
 [-2.66789552e-02]
 [ 4.89131624e-03]
 [-4.01782146e-03]
 [-5.37480278e-03]
 [-2.80382974e-03]
 [-3.69495017e-04]
 [-1.17139084e-04]
 [ 4.78451530e-03]
 [ 6.99315346e-03]
 [-4.63955598e-03]
 [-8.63330288e-03]
 [ 1.36059492e-02]
 [-2.33432741e-02]
 [-3.44392759e-02]
 [ 2.19381903e-02]
 [ 6.59044815e-03]
 [ 5.63259970e-04]
 [-1.25031864e-02]
 [-8.28482449e-03]
 [-7.38103978e-03]
 [-7.49779844e-03]
 [ 2.24536853e-02]
 [ 7.82630013e-03]
 [ 2.43040748e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.26243029]
curr_Stock_Price:  99.34274171737366
curr_Factors:  [99.34274172]
mat_Sqrt:  [[0.15]]
grads:  [-0.03158951]
Stock Position:  -0.031589510176297325
Bond Position:  [-5.12424174]


portfolio before change:  [-8.26222488]
curr_Stock_Price:  99.31596124485111
curr_Factors:  [99.31596124]
mat_Sqrt:  [[0.15]]
grads:  [0.02271554]
Stock Position:  0.022715537337716498
Bond Position:  [-10.5182403]


portfolio before change:  [-8.23015976]
curr_Stock_Price:  100.78543919331815
curr_Factors:  [100.78543919]
mat_Sqrt:  [[0.15]]
grads:  [0.01841632]
Stock Position:  0.018416323847248908
Bond Position:  [-10.08625704]


portfolio before change:  [-8.23222424]
curr_Stock_Price:  100.74180278910782
curr_Factors:  [100.74180279]
mat_Sqrt:  [[0.15]]
grads:  [0.05040724]
Stock Position:  0.050407244272661175
Bond Position:  [-13.3103409]


portfolio before change:  [-8.21646369]
curr_Stock_Price:  101.0874763101751
curr_Factors:  [101.08747631]
mat_Sqrt:  [[0.15]]
grads:  [0.13958137]
Stock Position:  0.13958137439705406
Bond Position:  [-22.32639256]


portfolio before change:  [-8.1531178]
curr_Stock_Price:  101.56129925924783
curr_Factors:  [101.56129926]
mat_Sqrt:  [[0.15]]
grads:  [0.19261047]
Stock Position:  0.1926104737759782
Bond Position:  [-27.71488777]


portfolio before change:  [-8.09007531]
curr_Stock_Price:  101.90659234980335
curr_Factors:  [101.90659235]
mat_Sqrt:  [[0.15]]
grads:  [0.0667351]
Stock Position:  0.06673509991088487
Bond Position:  [-14.89082194]


portfolio before change:  [-8.11248416]
curr_Stock_Price:  101.59869778135268
curr_Factors:  [101.59869778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00412707]
Stock Position:  -0.004127066285869993
Bond Position:  [-7.6931796]


portfolio before change:  [-8.11247303]
curr_Stock_Price:  101.36297629186039
curr_Factors:  [101.36297629]
mat_Sqrt:  [[0.15]]
grads:  [0.02717866]
Stock Position:  0.027178661308621555
Bond Position:  [-10.86738303]


portfolio before change:  [-8.1412315]
curr_Stock_Price:  100.35483360989646
curr_Factors:  [100.35483361]
mat_Sqrt:  [[0.15]]
grads:  [0.01725498]
Stock Position:  0.017254982737800763
Bond Position:  [-9.87285242]


portfolio before change:  [-8.14096233]
curr_Stock_Price:  100.44195964223009
curr_Factors:  [100.44195964]
mat_Sqrt:  [[0.15]]
grads:  [0.083431]
Stock Position:  0.08343099838827223
Bond Position:  [-16.5209353]


portfolio before change:  [-8.1523781]
curr_Stock_Price:  100.32988467106144
curr_Factors:  [100.32988467]
mat_Sqrt:  [[0.15]]
grads:  [0.07639784]
Stock Position:  0.07639784438680113
Bond Position:  [-15.81736502]


portfolio before change:  [-8.10659546]
curr_Stock_Price:  100.95503241480169
curr_Factors:  [100.95503241]
mat_Sqrt:  [[0.15]]
grads:  [-0.07128807]
Stock Position:  -0.07128806753448068
Bond Position:  [-0.90970629]


portfolio before change:  [-8.11825308]
curr_Stock_Price:  101.11696559885974
curr_Factors:  [101.1169656]
mat_Sqrt:  [[0.15]]
grads:  [0.07825167]
Stock Position:  0.07825166824548936
Bond Position:  [-16.03082433]


portfolio before change:  [-8.08845813]
curr_Stock_Price:  101.52333296925943
curr_Factors:  [101.52333297]
mat_Sqrt:  [[0.15]]
grads:  [-0.04175924]
Stock Position:  -0.04175924423139468
Bond Position:  [-3.84892048]


portfolio before change:  [-8.11707066]
curr_Stock_Price:  102.19698932389237
curr_Factors:  [102.19698932]
mat_Sqrt:  [[0.15]]
grads:  [-0.1778597]
Stock Position:  -0.17785970148548794
Bond Position:  [10.05965536]


portfolio before change:  [-8.46189326]
curr_Stock_Price:  104.14279341722428
curr_Factors:  [104.14279342]
mat_Sqrt:  [[0.15]]
grads:  [0.03260877]
Stock Position:  0.03260877495813569
Bond Position:  [-11.85786217]


portfolio before change:  [-8.48189222]
curr_Stock_Price:  103.57495131932697
curr_Factors:  [103.57495132]
mat_Sqrt:  [[0.15]]
grads:  [-0.02678548]
Stock Position:  -0.0267854763776009
Bond Position:  [-5.70758781]


portfolio before change:  [-8.4414734]
curr_Stock_Price:  102.03933120377444
curr_Factors:  [102.0393312]
mat_Sqrt:  [[0.15]]
grads:  [-0.03583202]
Stock Position:  -0.03583201850332033
Bond Position:  [-4.78519819]


portfolio before change:  [-8.46681077]
curr_Stock_Price:  102.72975244705431
curr_Factors:  [102.72975245]
mat_Sqrt:  [[0.15]]
grads:  [-0.0186922]
Stock Position:  -0.01869219828646383
Bond Position:  [-6.54656587]


portfolio before change:  [-8.45141255]
curr_Stock_Price:  101.86219300560957
curr_Factors:  [101.86219301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024633]
Stock Position:  -0.0024633001158854144
Bond Position:  [-8.2004954]


portfolio before change:  [-8.45062703]
curr_Stock_Price:  101.12714383422903
curr_Factors:  [101.12714383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00078093]
Stock Position:  -0.0007809272298273136
Bond Position:  [-8.37165409]


portfolio before change:  [-8.45201834]
curr_Stock_Price:  101.56865357009072
curr_Factors:  [101.56865357]
mat_Sqrt:  [[0.15]]
grads:  [0.03189677]
Stock Position:  0.03189676867893695
Bond Position:  [-11.69173018]


portfolio before change:  [-8.47856708]
curr_Stock_Price:  100.78214167072296
curr_Factors:  [100.78214167]
mat_Sqrt:  [[0.15]]
grads:  [0.04662102]
Stock Position:  0.046621023072624404
Bond Position:  [-13.17713363]


portfolio before change:  [-8.50229227]
curr_Stock_Price:  100.30857980596386
curr_Factors:  [100.30857981]
mat_Sqrt:  [[0.15]]
grads:  [-0.03093037]
Stock Position:  -0.030930373174144564
Bond Position:  [-5.39971046]


portfolio before change:  [-8.49901811]
curr_Stock_Price:  100.18090068061205
curr_Factors:  [100.18090068]
mat_Sqrt:  [[0.15]]
grads:  [-0.05755535]
Stock Position:  -0.05755535255824192
Bond Position:  [-2.73307105]


portfolio before change:  [-8.49704616]
curr_Stock_Price:  100.14070280157708
curr_Factors:  [100.1407028]
mat_Sqrt:  [[0.15]]
grads:  [0.09070633]
Stock Position:  0.09070632793116964
Bond Position:  [-17.58044159]


portfolio before change:  [-8.50432016]
curr_Stock_Price:  100.08473860167783
curr_Factors:  [100.0847386]
mat_Sqrt:  [[0.15]]
grads:  [-0.15562183]
Stock Position:  -0.1556218273161897
Bond Position:  [7.07104975]


portfolio before change:  [-8.39334552]
curr_Stock_Price:  99.37731406141253
curr_Factors:  [99.37731406]
mat_Sqrt:  [[0.15]]
grads:  [-0.22959517]
Stock Position:  -0.22959517286897588
Bond Position:  [14.42320608]


portfolio before change:  [-8.19759834]
curr_Stock_Price:  98.53259171311012
curr_Factors:  [98.53259171]
mat_Sqrt:  [[0.15]]
grads:  [0.1462546]
Stock Position:  0.14625460228026643
Bond Position:  [-22.60844335]


portfolio before change:  [-8.16004756]
curr_Stock_Price:  98.80866516127409
curr_Factors:  [98.80866516]
mat_Sqrt:  [[0.15]]
grads:  [0.04393632]
Stock Position:  0.04393632103236365
Bond Position:  [-12.50133679]


portfolio before change:  [-8.12728815]
curr_Stock_Price:  99.5898451701583
curr_Factors:  [99.58984517]
mat_Sqrt:  [[0.15]]
grads:  [0.00375507]
Stock Position:  0.003755066465006337
Bond Position:  [-8.50125463]


portfolio before change:  [-8.12696322]
curr_Stock_Price:  99.95938615892159
curr_Factors:  [99.95938616]
mat_Sqrt:  [[0.15]]
grads:  [-0.08335458]
Stock Position:  -0.08335457610198153
Bond Position:  [0.20510904]


portfolio before change:  [-7.98577432]
curr_Stock_Price:  98.2658587211451
curr_Factors:  [98.26585872]
mat_Sqrt:  [[0.15]]
grads:  [-0.05523216]
Stock Position:  -0.05523216324148016
Bond Position:  [-2.55833837]


portfolio before change:  [-7.93283598]
curr_Stock_Price:  97.30159897203136
curr_Factors:  [97.30159897]
mat_Sqrt:  [[0.15]]
grads:  [-0.04920693]
Stock Position:  -0.049206931886277214
Bond Position:  [-3.14492282]


portfolio before change:  [-8.03658248]
curr_Stock_Price:  99.40198110218056
curr_Factors:  [99.4019811]
mat_Sqrt:  [[0.15]]
grads:  [-0.04998532]
Stock Position:  -0.04998532291611776
Bond Position:  [-3.06794235]


portfolio before change:  [-8.03044578]
curr_Stock_Price:  99.27153858940792
curr_Factors:  [99.27153859]
mat_Sqrt:  [[0.15]]
grads:  [0.14969124]
Stock Position:  0.14969123525642516
Bond Position:  [-22.89052502]


portfolio before change:  [-7.9753803]
curr_Stock_Price:  99.65851502478394
curr_Factors:  [99.65851502]
mat_Sqrt:  [[0.15]]
grads:  [0.05217533]
Stock Position:  0.052175334179175234
Bond Position:  [-13.17509662]


portfolio before change:  [-7.94855267]
curr_Stock_Price:  100.20426357944599
curr_Factors:  [100.20426358]
mat_Sqrt:  [[0.15]]
grads:  [0.16202717]
Stock Position:  0.162027165351917
Bond Position:  [-24.18436546]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.94855267]
Stock Price:  99.042331050915
PL:  [-7.94855267]
Settle:  Tensor("sub_60:0", shape=(), dtype=float64)
PL:  Tensor("sub_61:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  31
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.48881931e-03]
 [-1.15726138e-02]
 [ 5.13575133e-03]
 [-1.95118022e-03]
 [ 1.10386231e-02]
 [ 1.98193538e-02]
 [ 2.49638167e-02]
 [-1.39850999e-03]
 [ 6.19573321e-03]
 [ 1.25739569e-02]
 [ 2.13263677e-02]
 [-5.84659485e-03]
 [-1.18824632e-02]
 [ 1.06538793e-02]
 [-1.25927063e-03]
 [-2.61897237e-02]
 [ 4.41131007e-03]
 [-1.86250737e-04]
 [ 3.90687072e-03]
 [-4.14004971e-03]
 [-2.82137127e-03]
 [-3.93208266e-02]
 [ 4.85840028e-03]
 [ 1.41400765e-02]
 [-6.21923250e-03]
 [ 2.24736406e-02]
 [-1.72340227e-02]
 [ 1.86978952e-02]
 [ 1.18982695e-01]
 [ 2.99122826e-02]
 [-5.79645207e-02]
 [-8.21553877e-03]
 [-1.38158066e-02]
 [ 1.79055057e-02]
 [-1.02550209e-02]
 [ 2.40923350e-02]
 [ 2.67201425e-02]
 [ 2.83474217e-02]
 [ 1.40971167e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.40874377]
curr_Stock_Price:  100.28788912818838
curr_Factors:  [100.28788913]
mat_Sqrt:  [[0.15]]
grads:  [-0.00992546]
Stock Position:  -0.009925462090658312
Bond Position:  [7.40414742]


portfolio before change:  [6.41192088]
curr_Stock_Price:  100.0610453010752
curr_Factors:  [100.0610453]
mat_Sqrt:  [[0.15]]
grads:  [-0.07715076]
Stock Position:  -0.07715075837597482
Bond Position:  [14.13170641]


portfolio before change:  [6.36173411]
curr_Stock_Price:  100.734445541798
curr_Factors:  [100.73444554]
mat_Sqrt:  [[0.15]]
grads:  [0.03423834]
Stock Position:  0.034238342202865715
Bond Position:  [2.9127537]


portfolio before change:  [6.34494265]
curr_Stock_Price:  100.23338201863622
curr_Factors:  [100.23338202]
mat_Sqrt:  [[0.15]]
grads:  [-0.01300787]
Stock Position:  -0.013007868127761097
Bond Position:  [7.64876526]


portfolio before change:  [6.34255689]
curr_Stock_Price:  100.49029688318004
curr_Factors:  [100.49029688]
mat_Sqrt:  [[0.15]]
grads:  [0.07359082]
Stock Position:  0.07359082041396707
Bond Position:  [-1.0526065]


portfolio before change:  [6.34299008]
curr_Stock_Price:  100.4979713980168
curr_Factors:  [100.4979714]
mat_Sqrt:  [[0.15]]
grads:  [0.13212903]
Stock Position:  0.13212902500538745
Bond Position:  [-6.9357089]


portfolio before change:  [6.37887984]
curr_Stock_Price:  100.77615990061271
curr_Factors:  [100.7761599]
mat_Sqrt:  [[0.15]]
grads:  [0.16642544]
Stock Position:  0.16642544444031343
Bond Position:  [-10.39283736]


portfolio before change:  [6.45758914]
curr_Stock_Price:  101.25690662333594
curr_Factors:  [101.25690662]
mat_Sqrt:  [[0.15]]
grads:  [-0.0093234]
Stock Position:  -0.009323399925407164
Bond Position:  [7.40164777]


portfolio before change:  [6.4532129]
curr_Stock_Price:  101.82552926518497
curr_Factors:  [101.82552927]
mat_Sqrt:  [[0.15]]
grads:  [0.04130489]
Stock Position:  0.041304888069563554
Bond Position:  [2.24732082]


portfolio before change:  [6.50306543]
curr_Stock_Price:  103.02566785828954
curr_Factors:  [103.02566786]
mat_Sqrt:  [[0.15]]
grads:  [0.08382638]
Stock Position:  0.08382637946201955
Bond Position:  [-2.1332033]


portfolio before change:  [6.56669415]
curr_Stock_Price:  103.78790268379913
curr_Factors:  [103.78790268]
mat_Sqrt:  [[0.15]]
grads:  [0.14217578]
Stock Position:  0.14217578457052016
Bond Position:  [-8.18943235]


portfolio before change:  [6.52307166]
curr_Stock_Price:  103.48828247035549
curr_Factors:  [103.48828247]
mat_Sqrt:  [[0.15]]
grads:  [-0.0389773]
Stock Position:  -0.03897729897979469
Bond Position:  [10.55676539]


portfolio before change:  [6.5671076]
curr_Stock_Price:  102.39235581148111
curr_Factors:  [102.39235581]
mat_Sqrt:  [[0.15]]
grads:  [-0.07921642]
Stock Position:  -0.07921642124977493
Bond Position:  [14.67826359]


portfolio before change:  [6.55684389]
curr_Stock_Price:  102.54508433169217
curr_Factors:  [102.54508433]
mat_Sqrt:  [[0.15]]
grads:  [0.07102586]
Stock Position:  0.07102586174624559
Bond Position:  [-0.72650909]


portfolio before change:  [6.58856366]
curr_Stock_Price:  102.99295760124194
curr_Factors:  [102.9929576]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839514]
Stock Position:  -0.008395137562112923
Bond Position:  [7.45320371]


portfolio before change:  [6.59292948]
curr_Stock_Price:  102.5838983549506
curr_Factors:  [102.58389835]
mat_Sqrt:  [[0.15]]
grads:  [-0.17459816]
Stock Position:  -0.17459815825926767
Bond Position:  [24.5038892]


portfolio before change:  [6.80682562]
curr_Stock_Price:  101.37636576071272
curr_Factors:  [101.37636576]
mat_Sqrt:  [[0.15]]
grads:  [0.02940873]
Stock Position:  0.02940873378404366
Bond Position:  [3.82547507]


portfolio before change:  [6.8461946]
curr_Stock_Price:  102.69878815168236
curr_Factors:  [102.69878815]
mat_Sqrt:  [[0.15]]
grads:  [-0.00124167]
Stock Position:  -0.0012416715814751321
Bond Position:  [6.97371277]


portfolio before change:  [6.84538117]
curr_Stock_Price:  104.05599318786373
curr_Factors:  [104.05599319]
mat_Sqrt:  [[0.15]]
grads:  [0.0260458]
Stock Position:  0.026045804821258067
Bond Position:  [4.13515908]


portfolio before change:  [6.88563601]
curr_Stock_Price:  105.58168649032297
curr_Factors:  [105.58168649]
mat_Sqrt:  [[0.15]]
grads:  [-0.02760033]
Stock Position:  -0.02760033139830995
Bond Position:  [9.79972554]


portfolio before change:  [6.86318604]
curr_Stock_Price:  106.43946626497035
curr_Factors:  [106.43946626]
mat_Sqrt:  [[0.15]]
grads:  [-0.01880914]
Stock Position:  -0.018809141816172912
Bond Position:  [8.86522106]


portfolio before change:  [6.86943441]
curr_Stock_Price:  106.16618703772549
curr_Factors:  [106.16618704]
mat_Sqrt:  [[0.15]]
grads:  [-0.26213884]
Stock Position:  -0.26213884393842984
Bond Position:  [34.69971595]


portfolio before change:  [6.31804712]
curr_Stock_Price:  108.28615146460575
curr_Factors:  [108.28615146]
mat_Sqrt:  [[0.15]]
grads:  [0.03238934]
Stock Position:  0.03238933520370452
Bond Position:  [2.81073067]


portfolio before change:  [6.30798558]
curr_Stock_Price:  107.96465946852439
curr_Factors:  [107.96465947]
mat_Sqrt:  [[0.15]]
grads:  [0.09426718]
Stock Position:  0.09426717667135429
Bond Position:  [-3.86953805]


portfolio before change:  [6.314123]
curr_Stock_Price:  108.03489759979776
curr_Factors:  [108.0348976]
mat_Sqrt:  [[0.15]]
grads:  [-0.04146155]
Stock Position:  -0.04146154999045376
Bond Position:  [10.79341731]


portfolio before change:  [6.30830511]
curr_Stock_Price:  108.20776033424744
curr_Factors:  [108.20776033]
mat_Sqrt:  [[0.15]]
grads:  [0.14982427]
Stock Position:  0.1498242706573939
Bond Position:  [-9.90384366]


portfolio before change:  [6.25550958]
curr_Stock_Price:  107.86364069126367
curr_Factors:  [107.86364069]
mat_Sqrt:  [[0.15]]
grads:  [-0.11489348]
Stock Position:  -0.11489348475445615
Bond Position:  [18.64833913]


portfolio before change:  [6.06081933]
curr_Stock_Price:  109.5784588336476
curr_Factors:  [109.57845883]
mat_Sqrt:  [[0.15]]
grads:  [0.12465263]
Stock Position:  0.12465263497330524
Bond Position:  [-7.5984243]


portfolio before change:  [6.19484208]
curr_Stock_Price:  110.66124867267305
curr_Factors:  [110.66124867]
mat_Sqrt:  [[0.15]]
grads:  [0.79321797]
Stock Position:  0.79321796927096
Bond Position:  [-81.58364887]


portfolio before change:  [6.66966882]
curr_Stock_Price:  111.27271406611287
curr_Factors:  [111.27271407]
mat_Sqrt:  [[0.15]]
grads:  [0.19941522]
Stock Position:  0.19941521708204746
Bond Position:  [-15.51980361]


portfolio before change:  [6.76067145]
curr_Stock_Price:  111.73879044711633
curr_Factors:  [111.73879045]
mat_Sqrt:  [[0.15]]
grads:  [-0.38643014]
Stock Position:  -0.3864301380709335
Bond Position:  [49.93990767]


portfolio before change:  [5.60553878]
curr_Stock_Price:  114.74418632146207
curr_Factors:  [114.74418632]
mat_Sqrt:  [[0.15]]
grads:  [-0.05477026]
Stock Position:  -0.054770258497938096
Bond Position:  [11.89010753]


portfolio before change:  [5.58048871]
curr_Stock_Price:  115.22869061767652
curr_Factors:  [115.22869062]
mat_Sqrt:  [[0.15]]
grads:  [-0.09210538]
Stock Position:  -0.09210537758455381
Bond Position:  [16.19367077]


portfolio before change:  [5.57257253]
curr_Stock_Price:  115.33661606997451
curr_Factors:  [115.33661607]
mat_Sqrt:  [[0.15]]
grads:  [0.11937004]
Stock Position:  0.11937003821129721
Bond Position:  [-8.19516373]


portfolio before change:  [5.49684377]
curr_Stock_Price:  114.71079484393339
curr_Factors:  [114.71079484]
mat_Sqrt:  [[0.15]]
grads:  [-0.06836681]
Stock Position:  -0.06836680588904234
Bond Position:  [13.33925441]


portfolio before change:  [5.44001217]
curr_Stock_Price:  115.56646028530342
curr_Factors:  [115.56646029]
mat_Sqrt:  [[0.15]]
grads:  [0.16061557]
Stock Position:  0.1606155664097361
Bond Position:  [-13.12176031]


portfolio before change:  [5.43784163]
curr_Stock_Price:  115.56315911413702
curr_Factors:  [115.56315911]
mat_Sqrt:  [[0.15]]
grads:  [0.17813428]
Stock Position:  0.1781342833778483
Bond Position:  [-15.14791891]


portfolio before change:  [5.53934178]
curr_Stock_Price:  116.14358509214736
curr_Factors:  [116.14358509]
mat_Sqrt:  [[0.15]]
grads:  [0.18898281]
Stock Position:  0.188982811196037
Bond Position:  [-16.40979943]


portfolio before change:  [5.36352496]
curr_Stock_Price:  115.22410745512545
curr_Factors:  [115.22410746]
mat_Sqrt:  [[0.15]]
grads:  [0.09398078]
Stock Position:  0.09398077817139311
Bond Position:  [-5.46532632]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.36352496]
Stock Price:  114.03311275968015
PL:  [-8.6695878]
Settle:  Tensor("sub_62:0", shape=(), dtype=float64)
PL:  Tensor("sub_63:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  32
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.46280517e-03]
 [ 4.13585155e-04]
 [-2.82296540e-03]
 [ 1.33335855e-02]
 [-1.97282105e-02]
 [ 3.93503545e-02]
 [ 1.83092237e-03]
 [ 4.44735587e-04]
 [ 6.94507302e-03]
 [ 1.12585550e-02]
 [ 2.59763369e-02]
 [ 5.82279821e-03]
 [-1.14507107e-02]
 [ 1.17489376e-02]
 [-7.01969552e-03]
 [-2.76929419e-02]
 [ 4.41160582e-03]
 [-1.30070782e-03]
 [-1.17572702e-02]
 [-2.25698370e-03]
 [-2.07282298e-04]
 [-2.81427256e-02]
 [ 4.78921975e-03]
 [ 8.18127852e-03]
 [-5.53099010e-03]
 [ 2.51360256e-03]
 [-8.75531789e-03]
 [ 3.64638715e-03]
 [ 3.69476928e-02]
 [ 2.56349374e-02]
 [-2.39379439e-02]
 [ 6.15214228e-03]
 [-1.29882201e-02]
 [ 2.11338145e-03]
 [-6.42535243e-03]
 [ 3.05436009e-03]
 [ 2.44920689e-02]
 [ 6.91750770e-03]
 [ 1.96901168e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.45268832]
curr_Stock_Price:  100.93494083242294
curr_Factors:  [100.93494083]
mat_Sqrt:  [[0.15]]
grads:  [-0.0164187]
Stock Position:  -0.01641870110069359
Bond Position:  [18.10990894]


portfolio before change:  [16.43837287]
curr_Stock_Price:  101.94472402803063
curr_Factors:  [101.94472403]
mat_Sqrt:  [[0.15]]
grads:  [0.00275723]
Stock Position:  0.0027572343642351454
Bond Position:  [16.15728737]


portfolio before change:  [16.44011576]
curr_Stock_Price:  101.84429967891074
curr_Factors:  [101.84429968]
mat_Sqrt:  [[0.15]]
grads:  [-0.01881977]
Stock Position:  -0.018819769312403926
Bond Position:  [18.35680199]


portfolio before change:  [16.46020897]
curr_Stock_Price:  100.89856749678954
curr_Factors:  [100.8985675]
mat_Sqrt:  [[0.15]]
grads:  [0.08889057]
Stock Position:  0.0888905702068728
Bond Position:  [7.49127777]


portfolio before change:  [16.61553883]
curr_Stock_Price:  102.6354603145083
curr_Factors:  [102.63546031]
mat_Sqrt:  [[0.15]]
grads:  [-0.1315214]
Stock Position:  -0.13152140307970578
Bond Position:  [30.11429858]


portfolio before change:  [16.49977334]
curr_Stock_Price:  103.54428589572046
curr_Factors:  [103.5442859]
mat_Sqrt:  [[0.15]]
grads:  [0.2623357]
Stock Position:  0.2623356963799469
Bond Position:  [-10.66358901]


portfolio before change:  [16.48479803]
curr_Stock_Price:  103.49228276811593
curr_Factors:  [103.49228277]
mat_Sqrt:  [[0.15]]
grads:  [0.01220615]
Stock Position:  0.01220614915271105
Bond Position:  [15.22155579]


portfolio before change:  [16.47157234]
curr_Stock_Price:  102.25286647078937
curr_Factors:  [102.25286647]
mat_Sqrt:  [[0.15]]
grads:  [0.0029649]
Stock Position:  0.002964903914535601
Bond Position:  [16.16840242]


portfolio before change:  [16.47281149]
curr_Stock_Price:  101.98910649542515
curr_Factors:  [101.9891065]
mat_Sqrt:  [[0.15]]
grads:  [0.04630049]
Stock Position:  0.046300486802161034
Bond Position:  [11.75066621]


portfolio before change:  [16.46576064]
curr_Stock_Price:  101.80509586976092
curr_Factors:  [101.80509587]
mat_Sqrt:  [[0.15]]
grads:  [0.07505703]
Stock Position:  0.07505703304282955
Bond Position:  [8.82457219]


portfolio before change:  [16.5273892]
curr_Stock_Price:  102.61148822464618
curr_Factors:  [102.61148822]
mat_Sqrt:  [[0.15]]
grads:  [0.17317558]
Stock Position:  0.17317557908553427
Bond Position:  [-1.2424147]


portfolio before change:  [16.43952806]
curr_Stock_Price:  102.1050321291097
curr_Factors:  [102.10503213]
mat_Sqrt:  [[0.15]]
grads:  [0.03881865]
Stock Position:  0.03881865473409318
Bond Position:  [12.47594807]


portfolio before change:  [16.42569136]
curr_Stock_Price:  101.70841134196874
curr_Factors:  [101.70841134]
mat_Sqrt:  [[0.15]]
grads:  [-0.07633807]
Stock Position:  -0.07633807103180595
Bond Position:  [24.18991529]


portfolio before change:  [16.4822061]
curr_Stock_Price:  101.00770192403662
curr_Factors:  [101.00770192]
mat_Sqrt:  [[0.15]]
grads:  [0.07832625]
Stock Position:  0.07832625048490154
Bond Position:  [8.57065153]


portfolio before change:  [16.50177101]
curr_Stock_Price:  101.24381066513058
curr_Factors:  [101.24381067]
mat_Sqrt:  [[0.15]]
grads:  [-0.04679797]
Stock Position:  -0.04679797013122644
Bond Position:  [21.23977583]


portfolio before change:  [16.48576747]
curr_Stock_Price:  101.64251761724866
curr_Factors:  [101.64251762]
mat_Sqrt:  [[0.15]]
grads:  [-0.18461961]
Stock Position:  -0.1846196129623806
Bond Position:  [35.25096973]


portfolio before change:  [16.53998407]
curr_Stock_Price:  101.37271986647025
curr_Factors:  [101.37271987]
mat_Sqrt:  [[0.15]]
grads:  [0.02941071]
Stock Position:  0.029410705467082684
Bond Position:  [13.55854087]


portfolio before change:  [16.52878793]
curr_Stock_Price:  100.93440770808225
curr_Factors:  [100.93440771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00867139]
Stock Position:  -0.008671385481103274
Bond Position:  [17.40402908]


portfolio before change:  [16.53166623]
curr_Stock_Price:  100.85337507396962
curr_Factors:  [100.85337507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0783818]
Stock Position:  -0.07838180115566233
Bond Position:  [24.43673542]


portfolio before change:  [16.50046071]
curr_Stock_Price:  101.29047014936312
curr_Factors:  [101.29047015]
mat_Sqrt:  [[0.15]]
grads:  [-0.01504656]
Stock Position:  -0.015046558015636615
Bond Position:  [18.02453365]


portfolio before change:  [16.49690816]
curr_Stock_Price:  101.67632354561448
curr_Factors:  [101.67632355]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138188]
Stock Position:  -0.001381881983596139
Bond Position:  [16.63741284]


portfolio before change:  [16.49831275]
curr_Stock_Price:  102.16494130771918
curr_Factors:  [102.16494131]
mat_Sqrt:  [[0.15]]
grads:  [-0.18761817]
Stock Position:  -0.18761817063002592
Bond Position:  [35.66631214]


portfolio before change:  [16.51960301]
curr_Stock_Price:  102.07522884323907
curr_Factors:  [102.07522884]
mat_Sqrt:  [[0.15]]
grads:  [0.03192813]
Stock Position:  0.031928131674561745
Bond Position:  [13.26053166]


portfolio before change:  [16.52866493]
curr_Stock_Price:  102.30713271076857
curr_Factors:  [102.30713271]
mat_Sqrt:  [[0.15]]
grads:  [0.05454186]
Stock Position:  0.05454185680468903
Bond Position:  [10.94864395]


portfolio before change:  [16.6238892]
curr_Stock_Price:  104.02793217397728
curr_Factors:  [104.02793217]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687327]
Stock Position:  -0.03687326734781115
Bond Position:  [20.45973895]


portfolio before change:  [16.61816201]
curr_Stock_Price:  104.25261554583547
curr_Factors:  [104.25261555]
mat_Sqrt:  [[0.15]]
grads:  [0.01675735]
Stock Position:  0.016757350369389693
Bond Position:  [14.87116441]


portfolio before change:  [16.63340701]
curr_Stock_Price:  105.05142839913265
curr_Factors:  [105.0514284]
mat_Sqrt:  [[0.15]]
grads:  [-0.05836879]
Stock Position:  -0.058368785954278114
Bond Position:  [22.76513135]


portfolio before change:  [16.62540777]
curr_Stock_Price:  105.23723088749708
curr_Factors:  [105.23723089]
mat_Sqrt:  [[0.15]]
grads:  [0.02430925]
Stock Position:  0.02430924765794755
Bond Position:  [14.06716986]


portfolio before change:  [16.61991664]
curr_Stock_Price:  104.93900547722176
curr_Factors:  [104.93900548]
mat_Sqrt:  [[0.15]]
grads:  [0.24631795]
Stock Position:  0.24631795187898797
Bond Position:  [-9.22844426]


portfolio before change:  [16.56542066]
curr_Stock_Price:  104.72244655197323
curr_Factors:  [104.72244655]
mat_Sqrt:  [[0.15]]
grads:  [0.17089958]
Stock Position:  0.170899582503356
Bond Position:  [-1.33160174]


portfolio before change:  [16.72723565]
curr_Stock_Price:  105.67026310609157
curr_Factors:  [105.67026311]
mat_Sqrt:  [[0.15]]
grads:  [-0.15958629]
Stock Position:  -0.15958629249724454
Bond Position:  [33.59076117]


portfolio before change:  [16.97238288]
curr_Stock_Price:  104.1604334489897
curr_Factors:  [104.16043345]
mat_Sqrt:  [[0.15]]
grads:  [0.04101428]
Stock Position:  0.04101428185512797
Bond Position:  [12.7003175]


portfolio before change:  [16.96718868]
curr_Stock_Price:  103.99508036847774
curr_Factors:  [103.99508037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08658813]
Stock Position:  -0.08658813409731163
Bond Position:  [25.97192864]


portfolio before change:  [16.87848335]
curr_Stock_Price:  105.05702756917982
curr_Factors:  [105.05702757]
mat_Sqrt:  [[0.15]]
grads:  [0.01408921]
Stock Position:  0.014089209664566092
Bond Position:  [15.39831286]


portfolio before change:  [16.88570251]
curr_Stock_Price:  105.4327941351246
curr_Factors:  [105.43279414]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283568]
Stock Position:  -0.042835682873635546
Bond Position:  [21.40198824]


portfolio before change:  [16.87206897]
curr_Stock_Price:  105.81352699900768
curr_Factors:  [105.813527]
mat_Sqrt:  [[0.15]]
grads:  [0.0203624]
Stock Position:  0.020362400584936526
Bond Position:  [14.71745155]


portfolio before change:  [16.8859843]
curr_Stock_Price:  106.40655775667987
curr_Factors:  [106.40655776]
mat_Sqrt:  [[0.15]]
grads:  [0.16328046]
Stock Position:  0.16328045904762872
Bond Position:  [-0.4881273]


portfolio before change:  [16.97928209]
curr_Stock_Price:  106.97832739690341
curr_Factors:  [106.9783274]
mat_Sqrt:  [[0.15]]
grads:  [0.04611672]
Stock Position:  0.04611671801755226
Bond Position:  [12.04579273]


portfolio before change:  [16.92566637]
curr_Stock_Price:  105.78306595090008
curr_Factors:  [105.78306595]
mat_Sqrt:  [[0.15]]
grads:  [0.13126745]
Stock Position:  0.1312674452029461
Bond Position:  [3.03979356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.92566637]
Stock Price:  106.49692783230661
PL:  [10.42873854]
Settle:  Tensor("sub_64:0", shape=(), dtype=float64)
PL:  Tensor("sub_65:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  33
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.97467518e-03]
 [-4.87668308e-03]
 [-2.46242854e-02]
 [-2.71977299e-02]
 [ 6.58476319e-03]
 [ 2.31000339e-02]
 [ 1.15514345e-02]
 [-7.54083788e-03]
 [ 9.20105897e-03]
 [-2.91560012e-03]
 [ 6.85655108e-03]
 [ 2.37766016e-03]
 [ 6.60932245e-03]
 [ 1.06319147e-02]
 [ 3.78008552e-04]
 [-1.07709781e-02]
 [-6.31899174e-03]
 [-1.68443436e-03]
 [-7.60169013e-03]
 [-2.49922768e-03]
 [ 3.68522162e-04]
 [ 8.67045243e-03]
 [ 4.76138723e-03]
 [ 5.55450862e-03]
 [-3.14796861e-03]
 [-5.09471171e-03]
 [-6.19465654e-03]
 [-2.03610989e-02]
 [-2.99674206e-02]
 [ 2.18080088e-02]
 [ 2.64189645e-03]
 [-8.96419365e-03]
 [-1.24084535e-02]
 [-8.49466674e-03]
 [-7.09011657e-03]
 [-7.49388639e-03]
 [ 2.13329272e-02]
 [ 8.35432531e-03]
 [ 2.35493490e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.09794637]
curr_Stock_Price:  99.61102639392037
curr_Factors:  [99.61102639]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983117]
Stock Position:  -0.01983116784967882
Bond Position:  [-2.12254339]


portfolio before change:  [-4.07866982]
curr_Stock_Price:  98.62561346464688
curr_Factors:  [98.62561346]
mat_Sqrt:  [[0.15]]
grads:  [-0.03251122]
Stock Position:  -0.03251122050351606
Bond Position:  [-0.87223075]


portfolio before change:  [-4.07719347]
curr_Stock_Price:  98.57684908040876
curr_Factors:  [98.57684908]
mat_Sqrt:  [[0.15]]
grads:  [-0.1641619]
Stock Position:  -0.16416190238591696
Bond Position:  [12.10536961]


portfolio before change:  [-4.00161049]
curr_Stock_Price:  98.12564994057901
curr_Factors:  [98.12564994]
mat_Sqrt:  [[0.15]]
grads:  [-0.1813182]
Stock Position:  -0.1813181993452053
Bond Position:  [13.79035567]


portfolio before change:  [-3.92528542]
curr_Stock_Price:  97.71421207496141
curr_Factors:  [97.71421207]
mat_Sqrt:  [[0.15]]
grads:  [0.04389842]
Stock Position:  0.04389842129617519
Bond Position:  [-8.21478506]


portfolio before change:  [-3.90557963]
curr_Stock_Price:  98.18650006304448
curr_Factors:  [98.18650006]
mat_Sqrt:  [[0.15]]
grads:  [0.15400023]
Stock Position:  0.15400022597938168
Bond Position:  [-19.02632283]


portfolio before change:  [-3.86975037]
curr_Stock_Price:  98.43460161354834
curr_Factors:  [98.43460161]
mat_Sqrt:  [[0.15]]
grads:  [0.07700956]
Stock Position:  0.07700956332873662
Bond Position:  [-11.45015606]


portfolio before change:  [-3.94473033]
curr_Stock_Price:  97.47954362813836
curr_Factors:  [97.47954363]
mat_Sqrt:  [[0.15]]
grads:  [-0.05027225]
Stock Position:  -0.050272252533212256
Bond Position:  [0.9557859]


portfolio before change:  [-3.95761416]
curr_Stock_Price:  97.73820138263576
curr_Factors:  [97.73820138]
mat_Sqrt:  [[0.15]]
grads:  [0.06134039]
Stock Position:  0.06134039311943971
Bond Position:  [-9.95291386]


portfolio before change:  [-3.8758949]
curr_Stock_Price:  99.09071073155796
curr_Factors:  [99.09071073]
mat_Sqrt:  [[0.15]]
grads:  [-0.01943733]
Stock Position:  -0.019437334120243524
Bond Position:  [-1.94983564]


portfolio before change:  [-3.88101563]
curr_Stock_Price:  99.34161902049362
curr_Factors:  [99.34161902]
mat_Sqrt:  [[0.15]]
grads:  [0.04571034]
Stock Position:  0.045710340506397926
Bond Position:  [-8.42195486]


portfolio before change:  [-3.91560143]
curr_Stock_Price:  98.60802163236892
curr_Factors:  [98.60802163]
mat_Sqrt:  [[0.15]]
grads:  [0.01585107]
Stock Position:  0.015851067701017966
Bond Position:  [-5.47864385]


portfolio before change:  [-3.92448258]
curr_Stock_Price:  98.0909410311307
curr_Factors:  [98.09094103]
mat_Sqrt:  [[0.15]]
grads:  [0.04406215]
Stock Position:  0.04406214968555115
Bond Position:  [-8.24658031]


portfolio before change:  [-3.89923373]
curr_Stock_Price:  98.68736539518947
curr_Factors:  [98.6873654]
mat_Sqrt:  [[0.15]]
grads:  [0.07087943]
Stock Position:  0.07087943141301388
Bond Position:  [-10.89413807]


portfolio before change:  [-3.93434518]
curr_Stock_Price:  98.21121036688159
curr_Factors:  [98.21121037]
mat_Sqrt:  [[0.15]]
grads:  [0.00252006]
Stock Position:  0.0025200570156817814
Bond Position:  [-4.18184303]


portfolio before change:  [-3.93470853]
curr_Stock_Price:  98.27446784680097
curr_Factors:  [98.27446785]
mat_Sqrt:  [[0.15]]
grads:  [-0.07180652]
Stock Position:  -0.07180652086822116
Bond Position:  [3.1220391]


portfolio before change:  [-3.87523914]
curr_Stock_Price:  97.45171380696539
curr_Factors:  [97.45171381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04212661]
Stock Position:  -0.042126611625424956
Bond Position:  [0.23007136]


portfolio before change:  [-3.90210797]
curr_Stock_Price:  98.09020780801224
curr_Factors:  [98.09020781]
mat_Sqrt:  [[0.15]]
grads:  [-0.01122956]
Stock Position:  -0.011229562366869917
Bond Position:  [-2.80059786]


portfolio before change:  [-3.89182129]
curr_Stock_Price:  97.14299608585745
curr_Factors:  [97.14299609]
mat_Sqrt:  [[0.15]]
grads:  [-0.05067793]
Stock Position:  -0.05067793421869359
Bond Position:  [1.03118507]


portfolio before change:  [-3.89016823]
curr_Stock_Price:  97.11292068910504
curr_Factors:  [97.11292069]
mat_Sqrt:  [[0.15]]
grads:  [-0.01666152]
Stock Position:  -0.016661517891413232
Bond Position:  [-2.27211956]


portfolio before change:  [-3.90442568]
curr_Stock_Price:  97.95158460790601
curr_Factors:  [97.95158461]
mat_Sqrt:  [[0.15]]
grads:  [0.00245681]
Stock Position:  0.0024568144117119123
Bond Position:  [-4.14507454]


portfolio before change:  [-3.90365232]
curr_Stock_Price:  98.47727271690981
curr_Factors:  [98.47727272]
mat_Sqrt:  [[0.15]]
grads:  [0.05780302]
Stock Position:  0.05780301617527036
Bond Position:  [-9.59593571]


portfolio before change:  [-3.94752104]
curr_Stock_Price:  97.73909058664378
curr_Factors:  [97.73909059]
mat_Sqrt:  [[0.15]]
grads:  [0.03174258]
Stock Position:  0.03174258154698639
Bond Position:  [-7.0500121]


portfolio before change:  [-3.95399596]
curr_Stock_Price:  97.56287272047904
curr_Factors:  [97.56287272]
mat_Sqrt:  [[0.15]]
grads:  [0.03703006]
Stock Position:  0.03703005747177846
Bond Position:  [-7.56675475]


portfolio before change:  [-3.93058804]
curr_Stock_Price:  98.2205500470628
curr_Factors:  [98.22055005]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098646]
Stock Position:  -0.020986457381885898
Bond Position:  [-1.86928665]


portfolio before change:  [-3.91983359]
curr_Stock_Price:  97.6969686322573
curr_Factors:  [97.69696863]
mat_Sqrt:  [[0.15]]
grads:  [-0.03396474]
Stock Position:  -0.03396474472680257
Bond Position:  [-0.60158099]


portfolio before change:  [-3.9237643]
curr_Stock_Price:  97.81048363282477
curr_Factors:  [97.81048363]
mat_Sqrt:  [[0.15]]
grads:  [-0.04129771]
Stock Position:  -0.041297710275794944
Bond Position:  [0.11558471]


portfolio before change:  [-3.92143494]
curr_Stock_Price:  97.75442947192828
curr_Factors:  [97.75442947]
mat_Sqrt:  [[0.15]]
grads:  [-0.13574066]
Stock Position:  -0.13574065909382996
Bond Position:  [9.34781574]


portfolio before change:  [-3.82237493]
curr_Stock_Price:  97.03326408298082
curr_Factors:  [97.03326408]
mat_Sqrt:  [[0.15]]
grads:  [-0.1997828]
Stock Position:  -0.19978280418457686
Bond Position:  [15.56320267]


portfolio before change:  [-3.54890898]
curr_Stock_Price:  95.6741860371588
curr_Factors:  [95.67418604]
mat_Sqrt:  [[0.15]]
grads:  [0.14538673]
Stock Position:  0.14538672504927763
Bond Position:  [-17.45866556]


portfolio before change:  [-3.59598922]
curr_Stock_Price:  95.36536990403505
curr_Factors:  [95.3653699]
mat_Sqrt:  [[0.15]]
grads:  [0.01761264]
Stock Position:  0.017612642995900627
Bond Position:  [-5.27562543]


portfolio before change:  [-3.6023449]
curr_Stock_Price:  95.04195538315928
curr_Factors:  [95.04195538]
mat_Sqrt:  [[0.15]]
grads:  [-0.05976129]
Stock Position:  -0.059761291030257825
Bond Position:  [2.07748506]


portfolio before change:  [-3.62662605]
curr_Stock_Price:  95.4526033934838
curr_Factors:  [95.45260339]
mat_Sqrt:  [[0.15]]
grads:  [-0.08272302]
Stock Position:  -0.08272302330805013
Bond Position:  [4.26950188]


portfolio before change:  [-3.62798039]
curr_Stock_Price:  95.47542722554068
curr_Factors:  [95.47542723]
mat_Sqrt:  [[0.15]]
grads:  [-0.05663111]
Stock Position:  -0.056631111619861535
Bond Position:  [1.77889919]


portfolio before change:  [-3.70972583]
curr_Stock_Price:  96.92282632540714
curr_Factors:  [96.92282633]
mat_Sqrt:  [[0.15]]
grads:  [-0.04726744]
Stock Position:  -0.04726744379151633
Bond Position:  [0.87156841]


portfolio before change:  [-3.76108969]
curr_Stock_Price:  98.01179589683208
curr_Factors:  [98.0117959]
mat_Sqrt:  [[0.15]]
grads:  [-0.04995924]
Stock Position:  -0.049959242569762
Bond Position:  [1.1355054]


portfolio before change:  [-3.75553132]
curr_Stock_Price:  97.90337920983033
curr_Factors:  [97.90337921]
mat_Sqrt:  [[0.15]]
grads:  [0.14221951]
Stock Position:  0.1422195148510252
Bond Position:  [-17.67930242]


portfolio before change:  [-3.735079]
curr_Stock_Price:  98.0627270849408
curr_Factors:  [98.06272708]
mat_Sqrt:  [[0.15]]
grads:  [0.0556955]
Stock Position:  0.055695502049124594
Bond Position:  [-9.19673181]


portfolio before change:  [-3.66152065]
curr_Stock_Price:  99.40409225065318
curr_Factors:  [99.40409225]
mat_Sqrt:  [[0.15]]
grads:  [0.15699566]
Stock Position:  0.15699565984813355
Bond Position:  [-19.26753171]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.66152065]
Stock Price:  99.60222102680348
PL:  [-3.66152065]
Settle:  Tensor("sub_66:0", shape=(), dtype=float64)
PL:  Tensor("sub_67:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  34
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.40608490e-03]
 [-1.61292820e-02]
 [ 1.23145791e-02]
 [ 2.45032453e-02]
 [ 1.62062107e-02]
 [ 1.92064830e-02]
 [ 2.54158636e-02]
 [-2.39902457e-03]
 [ 8.45841288e-03]
 [-3.53121810e-03]
 [ 1.73104488e-02]
 [ 1.08482460e-02]
 [-1.13132870e-02]
 [ 1.25657972e-02]
 [-6.38951668e-03]
 [-2.31504180e-02]
 [ 4.67614026e-03]
 [-2.97748987e-03]
 [-1.16101585e-02]
 [-2.27567758e-03]
 [ 3.82951413e-04]
 [ 1.00230322e-02]
 [ 4.77297010e-03]
 [ 6.54363066e-03]
 [-4.50353686e-03]
 [-6.90752356e-03]
 [ 5.05194069e-03]
 [-2.60137700e-02]
 [-3.72327011e-02]
 [ 2.18925576e-02]
 [ 9.35880933e-03]
 [-2.59655216e-04]
 [-1.25335039e-02]
 [-7.76405969e-03]
 [-7.20745863e-03]
 [-7.52084703e-03]
 [ 2.24852689e-02]
 [ 8.27023230e-03]
 [ 2.33600336e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.18645529]
curr_Stock_Price:  100.91778954947164
curr_Factors:  [100.91778955]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604057]
Stock Position:  -0.01604056602546342
Bond Position:  [17.80523376]


portfolio before change:  [16.19846169]
curr_Stock_Price:  100.30804765678427
curr_Factors:  [100.30804766]
mat_Sqrt:  [[0.15]]
grads:  [-0.10752855]
Stock Position:  -0.10752854697633282
Bond Position:  [26.9844403]


portfolio before change:  [16.26216952]
curr_Stock_Price:  99.74694486822303
curr_Factors:  [99.74694487]
mat_Sqrt:  [[0.15]]
grads:  [0.08209719]
Stock Position:  0.08209719373836548
Bond Position:  [8.07322526]


portfolio before change:  [16.38547129]
curr_Stock_Price:  101.2365519008972
curr_Factors:  [101.2365519]
mat_Sqrt:  [[0.15]]
grads:  [0.16335497]
Stock Position:  0.16335496884380618
Bond Position:  [-0.15202249]


portfolio before change:  [16.31346814]
curr_Stock_Price:  100.79589098698825
curr_Factors:  [100.79589099]
mat_Sqrt:  [[0.15]]
grads:  [0.1080414]
Stock Position:  0.10804140487824822
Bond Position:  [5.42333847]


portfolio before change:  [16.27709603]
curr_Stock_Price:  100.45296628690528
curr_Factors:  [100.45296629]
mat_Sqrt:  [[0.15]]
grads:  [0.12804322]
Stock Position:  0.12804321988743636
Bond Position:  [3.41477478]


portfolio before change:  [16.31271427]
curr_Stock_Price:  100.72780601411156
curr_Factors:  [100.72780601]
mat_Sqrt:  [[0.15]]
grads:  [0.16943909]
Stock Position:  0.16943909035424234
Bond Position:  [-0.75451355]


portfolio before change:  [16.32508655]
curr_Stock_Price:  100.80138170015539
curr_Factors:  [100.8013817]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159935]
Stock Position:  -0.01599349713373806
Bond Position:  [17.93725316]


portfolio before change:  [16.33953246]
curr_Stock_Price:  100.03834558523711
curr_Factors:  [100.03834559]
mat_Sqrt:  [[0.15]]
grads:  [0.05638942]
Stock Position:  0.056389419169011794
Bond Position:  [10.69842826]


portfolio before change:  [16.33322791]
curr_Stock_Price:  99.90282480771212
curr_Factors:  [99.90282481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02354145]
Stock Position:  -0.02354145402935928
Bond Position:  [18.68508567]


portfolio before change:  [16.31405236]
curr_Stock_Price:  100.81658886331827
curr_Factors:  [100.81658886]
mat_Sqrt:  [[0.15]]
grads:  [0.11540299]
Stock Position:  0.11540299227227303
Bond Position:  [4.67951633]


portfolio before change:  [16.29585128]
curr_Stock_Price:  100.65380233903122
curr_Factors:  [100.65380234]
mat_Sqrt:  [[0.15]]
grads:  [0.07232164]
Stock Position:  0.07232163978780233
Bond Position:  [9.01640324]


portfolio before change:  [16.36139197]
curr_Stock_Price:  101.54445652816985
curr_Factors:  [101.54445653]
mat_Sqrt:  [[0.15]]
grads:  [-0.07542191]
Stock Position:  -0.07542191328800951
Bond Position:  [24.02006917]


portfolio before change:  [16.43774582]
curr_Stock_Price:  100.57191229127807
curr_Factors:  [100.57191229]
mat_Sqrt:  [[0.15]]
grads:  [0.08377198]
Stock Position:  0.08377198161016113
Bond Position:  [8.01263743]


portfolio before change:  [16.43997634]
curr_Stock_Price:  100.58658160868796
curr_Factors:  [100.58658161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04259678]
Stock Position:  -0.0425967778401429
Bond Position:  [20.72464061]


portfolio before change:  [16.43910199]
curr_Stock_Price:  100.66792783691196
curr_Factors:  [100.66792784]
mat_Sqrt:  [[0.15]]
grads:  [-0.15433612]
Stock Position:  -0.1543361201322385
Bond Position:  [31.9757994]


portfolio before change:  [16.41905176]
curr_Stock_Price:  100.823740083273
curr_Factors:  [100.82374008]
mat_Sqrt:  [[0.15]]
grads:  [0.03117427]
Stock Position:  0.031174268418847087
Bond Position:  [13.27594542]


portfolio before change:  [16.3893609]
curr_Stock_Price:  99.81808826450857
curr_Factors:  [99.81808826]
mat_Sqrt:  [[0.15]]
grads:  [-0.01984993]
Stock Position:  -0.019849932489307765
Bond Position:  [18.37074321]


portfolio before change:  [16.37961519]
curr_Stock_Price:  100.42474974851086
curr_Factors:  [100.42474975]
mat_Sqrt:  [[0.15]]
grads:  [-0.07740106]
Stock Position:  -0.07740105641331282
Bond Position:  [24.15259691]


portfolio before change:  [16.41942759]
curr_Stock_Price:  99.94939276309827
curr_Factors:  [99.94939276]
mat_Sqrt:  [[0.15]]
grads:  [-0.01517118]
Stock Position:  -0.015171183875749374
Bond Position:  [17.9357782]


portfolio before change:  [16.4231361]
curr_Stock_Price:  99.85273610873625
curr_Factors:  [99.85273611]
mat_Sqrt:  [[0.15]]
grads:  [0.00255301]
Stock Position:  0.002553009422825302
Bond Position:  [16.16821112]


portfolio before change:  [16.4260263]
curr_Stock_Price:  100.19313684085925
curr_Factors:  [100.19313684]
mat_Sqrt:  [[0.15]]
grads:  [0.06682021]
Stock Position:  0.06682021439710367
Bond Position:  [9.73109941]


portfolio before change:  [16.43189175]
curr_Stock_Price:  100.26271145782516
curr_Factors:  [100.26271146]
mat_Sqrt:  [[0.15]]
grads:  [0.0318198]
Stock Position:  0.03181980069979429
Bond Position:  [13.24155225]


portfolio before change:  [16.43086117]
curr_Stock_Price:  100.17830260364589
curr_Factors:  [100.1783026]
mat_Sqrt:  [[0.15]]
grads:  [0.0436242]
Stock Position:  0.04362420438583388
Bond Position:  [12.06066243]


portfolio before change:  [16.44082064]
curr_Stock_Price:  100.372043425439
curr_Factors:  [100.37204343]
mat_Sqrt:  [[0.15]]
grads:  [-0.03002358]
Stock Position:  -0.030023579088698217
Bond Position:  [19.45434863]


portfolio before change:  [16.40872447]
curr_Stock_Price:  101.52207677281777
curr_Factors:  [101.52207677]
mat_Sqrt:  [[0.15]]
grads:  [-0.04605016]
Stock Position:  -0.04605015705683088
Bond Position:  [21.08383205]


portfolio before change:  [16.40704175]
curr_Stock_Price:  101.61585196186176
curr_Factors:  [101.61585196]
mat_Sqrt:  [[0.15]]
grads:  [0.0336796]
Stock Position:  0.03367960457504218
Bond Position:  [12.98466004]


portfolio before change:  [16.33612191]
curr_Stock_Price:  99.46193651738879
curr_Factors:  [99.46193652]
mat_Sqrt:  [[0.15]]
grads:  [-0.17342513]
Stock Position:  -0.17342513339277854
Bond Position:  [33.58532152]


portfolio before change:  [16.42119696]
curr_Stock_Price:  98.99558763645494
curr_Factors:  [98.99558764]
mat_Sqrt:  [[0.15]]
grads:  [-0.24821801]
Stock Position:  -0.2482180075214054
Bond Position:  [40.99368448]


portfolio before change:  [16.51120023]
curr_Stock_Price:  98.65363523508769
curr_Factors:  [98.65363524]
mat_Sqrt:  [[0.15]]
grads:  [0.14595038]
Stock Position:  0.14595038398846485
Bond Position:  [2.11266429]


portfolio before change:  [16.63745159]
curr_Stock_Price:  99.51685502941021
curr_Factors:  [99.51685503]
mat_Sqrt:  [[0.15]]
grads:  [0.06239206]
Stock Position:  0.06239206217977841
Bond Position:  [10.42838979]


portfolio before change:  [16.62270551]
curr_Stock_Price:  99.2596153175805
curr_Factors:  [99.25961532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00173103]
Stock Position:  -0.0017310347766568736
Bond Position:  [16.79452735]


portfolio before change:  [16.62729207]
curr_Stock_Price:  97.82283591817426
curr_Factors:  [97.82283592]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355669]
Stock Position:  -0.08355669262985084
Bond Position:  [24.8010447]


portfolio before change:  [16.56114156]
curr_Stock_Price:  98.65162449926468
curr_Factors:  [98.6516245]
mat_Sqrt:  [[0.15]]
grads:  [-0.0517604]
Stock Position:  -0.05176039790122172
Bond Position:  [21.6673889]


portfolio before change:  [16.64542571]
curr_Stock_Price:  97.075601904309
curr_Factors:  [97.0756019]
mat_Sqrt:  [[0.15]]
grads:  [-0.04804972]
Stock Position:  -0.04804972418871806
Bond Position:  [21.30988161]


portfolio before change:  [16.55786647]
curr_Stock_Price:  98.95330556076384
curr_Factors:  [98.95330556]
mat_Sqrt:  [[0.15]]
grads:  [-0.05013898]
Stock Position:  -0.05013898020094331
Bond Position:  [21.5192843]


portfolio before change:  [16.54111243]
curr_Stock_Price:  99.34110997517183
curr_Factors:  [99.34110998]
mat_Sqrt:  [[0.15]]
grads:  [0.14990179]
Stock Position:  0.14990179251402444
Bond Position:  [1.64970198]


portfolio before change:  [16.48697208]
curr_Stock_Price:  98.97856209711355
curr_Factors:  [98.9785621]
mat_Sqrt:  [[0.15]]
grads:  [0.05513488]
Stock Position:  0.055134882007134636
Bond Position:  [11.02980074]


portfolio before change:  [16.49108394]
curr_Stock_Price:  99.02813232940284
curr_Factors:  [99.02813233]
mat_Sqrt:  [[0.15]]
grads:  [0.15573356]
Stock Position:  0.15573355761576915
Bond Position:  [1.06908059]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.49108394]
Stock Price:  99.74689990871266
PL:  [16.49108394]
Settle:  Tensor("sub_68:0", shape=(), dtype=float64)
PL:  Tensor("sub_69:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  35
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.47691909e-03]
 [ 1.64131293e-06]
 [-3.15101840e-03]
 [ 6.50954139e-02]
 [ 4.40285599e-03]
 [ 2.52837230e-02]
 [ 2.57893769e-02]
 [-1.72922368e-03]
 [ 9.51888154e-03]
 [-4.39722909e-03]
 [ 1.22347671e-02]
 [-3.30549977e-03]
 [ 6.66697928e-03]
 [ 8.49445427e-03]
 [ 9.32969651e-03]
 [-1.02224619e-02]
 [-6.61087536e-03]
 [-1.98259374e-03]
 [-7.57146761e-03]
 [-2.44748076e-03]
 [ 6.95824235e-04]
 [ 1.12814866e-02]
 [ 4.75704503e-03]
 [ 5.38333956e-03]
 [ 1.41919885e-03]
 [-2.52909691e-03]
 [ 1.93779295e-03]
 [-1.79183556e-02]
 [-2.81928811e-02]
 [ 2.16603550e-02]
 [ 2.64318173e-03]
 [-8.57647185e-03]
 [-1.23322435e-02]
 [-6.46850028e-03]
 [-6.42557687e-03]
 [-3.03753714e-03]
 [ 1.84814750e-02]
 [ 1.07446189e-02]
 [ 1.79815044e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.51893613]
curr_Stock_Price:  100.93920865373822
curr_Factors:  [100.93920865]
mat_Sqrt:  [[0.15]]
grads:  [-0.01651279]
Stock Position:  -0.01651279394136935
Bond Position:  [18.18572448]


portfolio before change:  [16.50560021]
curr_Stock_Price:  101.88449243423
curr_Factors:  [101.88449243]
mat_Sqrt:  [[0.15]]
grads:  [1.09420862e-05]
Stock Position:  1.094208621780536e-05
Bond Position:  [16.50448538]


portfolio before change:  [16.5076529]
curr_Stock_Price:  100.92463275085174
curr_Factors:  [100.92463275]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100679]
Stock Position:  -0.021006789332673494
Bond Position:  [18.6277554]


portfolio before change:  [16.47738551]
curr_Stock_Price:  102.47632185381606
curr_Factors:  [102.47632185]
mat_Sqrt:  [[0.15]]
grads:  [0.43396943]
Stock Position:  0.4339694261635107
Bond Position:  [-27.99420508]


portfolio before change:  [16.18486663]
curr_Stock_Price:  101.81033166836244
curr_Factors:  [101.81033167]
mat_Sqrt:  [[0.15]]
grads:  [0.02935237]
Stock Position:  0.029352373247112113
Bond Position:  [13.19649178]


portfolio before change:  [16.159923]
curr_Stock_Price:  100.90432987651187
curr_Factors:  [100.90432988]
mat_Sqrt:  [[0.15]]
grads:  [0.16855815]
Stock Position:  0.16855815326245996
Bond Position:  [-0.8483245]


portfolio before change:  [16.12291303]
curr_Stock_Price:  100.68539110578735
curr_Factors:  [100.68539111]
mat_Sqrt:  [[0.15]]
grads:  [0.17192918]
Stock Position:  0.17192917937193886
Bond Position:  [-1.18784363]


portfolio before change:  [16.19736739]
curr_Stock_Price:  101.11930725788018
curr_Factors:  [101.11930726]
mat_Sqrt:  [[0.15]]
grads:  [-0.01152816]
Stock Position:  -0.011528157897754533
Bond Position:  [17.36308673]


portfolio before change:  [16.21362643]
curr_Stock_Price:  99.89721138622323
curr_Factors:  [99.89721139]
mat_Sqrt:  [[0.15]]
grads:  [0.06345921]
Stock Position:  0.06345921025877466
Bond Position:  [9.87422829]


portfolio before change:  [16.1960399]
curr_Stock_Price:  99.60062907130639
curr_Factors:  [99.60062907]
mat_Sqrt:  [[0.15]]
grads:  [-0.02931486]
Stock Position:  -0.029314860570406904
Bond Position:  [19.11581846]


portfolio before change:  [16.23245391]
curr_Stock_Price:  98.43997599833219
curr_Factors:  [98.439976]
mat_Sqrt:  [[0.15]]
grads:  [0.08156511]
Stock Position:  0.08156511422156287
Bond Position:  [8.20318603]


portfolio before change:  [16.18113646]
curr_Stock_Price:  97.79824434275925
curr_Factors:  [97.79824434]
mat_Sqrt:  [[0.15]]
grads:  [-0.02203667]
Stock Position:  -0.022036665106647098
Bond Position:  [18.33628362]


portfolio before change:  [16.17743977]
curr_Stock_Price:  98.07001254203112
curr_Factors:  [98.07001254]
mat_Sqrt:  [[0.15]]
grads:  [0.04444653]
Stock Position:  0.04444652853322069
Bond Position:  [11.81856816]


portfolio before change:  [16.15829633]
curr_Stock_Price:  97.60606505279092
curr_Factors:  [97.60606505]
mat_Sqrt:  [[0.15]]
grads:  [0.0566297]
Stock Position:  0.056629695110276004
Bond Position:  [10.63089463]


portfolio before change:  [16.10720675]
curr_Stock_Price:  96.68042837678516
curr_Factors:  [96.68042838]
mat_Sqrt:  [[0.15]]
grads:  [0.06219798]
Stock Position:  0.06219797671572331
Bond Position:  [10.09387972]


portfolio before change:  [16.09432884]
curr_Stock_Price:  96.45309408672823
curr_Factors:  [96.45309409]
mat_Sqrt:  [[0.15]]
grads:  [-0.06814975]
Stock Position:  -0.06814974616890447
Bond Position:  [22.66758271]


portfolio before change:  [16.03591892]
curr_Stock_Price:  97.35175546343021
curr_Factors:  [97.35175546]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440725]
Stock Position:  -0.044072502381176666
Bond Position:  [20.32645439]


portfolio before change:  [15.99945857]
curr_Stock_Price:  98.23669065477269
curr_Factors:  [98.23669065]
mat_Sqrt:  [[0.15]]
grads:  [-0.01321729]
Stock Position:  -0.013217291612704173
Bond Position:  [17.29788156]


portfolio before change:  [16.01049574]
curr_Stock_Price:  97.56523706390047
curr_Factors:  [97.56523706]
mat_Sqrt:  [[0.15]]
grads:  [-0.05047645]
Stock Position:  -0.050476450732708664
Bond Position:  [20.93524262]


portfolio before change:  [16.01860667]
curr_Stock_Price:  97.45639696638598
curr_Factors:  [97.45639697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01631654]
Stock Position:  -0.016316538403501855
Bond Position:  [17.60875772]


portfolio before change:  [16.03792801]
curr_Stock_Price:  96.40714824817837
curr_Factors:  [96.40714825]
mat_Sqrt:  [[0.15]]
grads:  [0.00463883]
Stock Position:  0.00463882823087478
Bond Position:  [15.59071181]


portfolio before change:  [16.04433796]
curr_Stock_Price:  97.36881161046284
curr_Factors:  [97.36881161]
mat_Sqrt:  [[0.15]]
grads:  [0.07520991]
Stock Position:  0.07520991057267791
Bond Position:  [8.72123835]


portfolio before change:  [15.95638866]
curr_Stock_Price:  96.18493133923289
curr_Factors:  [96.18493134]
mat_Sqrt:  [[0.15]]
grads:  [0.03171363]
Stock Position:  0.03171363355658767
Bond Position:  [12.90601499]


portfolio before change:  [15.97276791]
curr_Stock_Price:  96.65053221961742
curr_Factors:  [96.65053222]
mat_Sqrt:  [[0.15]]
grads:  [0.03588893]
Stock Position:  0.035888930368480405
Bond Position:  [12.50408368]


portfolio before change:  [15.93931852]
curr_Stock_Price:  95.674953142514
curr_Factors:  [95.67495314]
mat_Sqrt:  [[0.15]]
grads:  [0.00946133]
Stock Position:  0.00946132566979804
Bond Position:  [15.03410663]


portfolio before change:  [15.9393845]
curr_Stock_Price:  95.4832879934769
curr_Factors:  [95.48328799]
mat_Sqrt:  [[0.15]]
grads:  [-0.01686065]
Stock Position:  -0.016860646097495848
Bond Position:  [17.54929443]


portfolio before change:  [15.93918519]
curr_Stock_Price:  95.62522278569756
curr_Factors:  [95.62522279]
mat_Sqrt:  [[0.15]]
grads:  [0.01291862]
Stock Position:  0.01291861967320039
Bond Position:  [14.7038393]


portfolio before change:  [15.94231553]
curr_Stock_Price:  95.72525266847533
curr_Factors:  [95.72525267]
mat_Sqrt:  [[0.15]]
grads:  [-0.1194557]
Stock Position:  -0.11945570402344559
Bond Position:  [27.37724298]


portfolio before change:  [15.93624686]
curr_Stock_Price:  95.80470505760903
curr_Factors:  [95.80470506]
mat_Sqrt:  [[0.15]]
grads:  [-0.18795254]
Stock Position:  -0.1879525405002953
Bond Position:  [33.94298456]


portfolio before change:  [16.10094026]
curr_Stock_Price:  94.95103066838603
curr_Factors:  [94.95103067]
mat_Sqrt:  [[0.15]]
grads:  [0.14440237]
Stock Position:  0.1444023666450505
Bond Position:  [2.38978672]


portfolio before change:  [16.16704705]
curr_Stock_Price:  95.40675753992934
curr_Factors:  [95.40675754]
mat_Sqrt:  [[0.15]]
grads:  [0.01762121]
Stock Position:  0.017621211522000788
Bond Position:  [14.48586439]


portfolio before change:  [16.16625373]
curr_Stock_Price:  95.25897209492022
curr_Factors:  [95.25897209]
mat_Sqrt:  [[0.15]]
grads:  [-0.05717648]
Stock Position:  -0.05717647897918821
Bond Position:  [21.61282635]


portfolio before change:  [16.20998825]
curr_Stock_Price:  94.54132122675247
curr_Factors:  [94.54132123]
mat_Sqrt:  [[0.15]]
grads:  [-0.08221496]
Stock Position:  -0.08221495687031428
Bond Position:  [23.9826989]


portfolio before change:  [16.23999945]
curr_Stock_Price:  94.21275366116807
curr_Factors:  [94.21275366]
mat_Sqrt:  [[0.15]]
grads:  [-0.04312334]
Stock Position:  -0.04312333518022918
Bond Position:  [20.3027676]


portfolio before change:  [16.2588902]
curr_Stock_Price:  93.8335448946489
curr_Factors:  [93.83354489]
mat_Sqrt:  [[0.15]]
grads:  [-0.04283718]
Stock Position:  -0.04283717915384083
Bond Position:  [20.27845457]


portfolio before change:  [16.24779638]
curr_Stock_Price:  94.15169813274989
curr_Factors:  [94.15169813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02025025]
Stock Position:  -0.02025024760657619
Bond Position:  [18.15439158]


portfolio before change:  [16.24715792]
curr_Stock_Price:  94.2952960563831
curr_Factors:  [94.29529606]
mat_Sqrt:  [[0.15]]
grads:  [0.12320983]
Stock Position:  0.12320983318805363
Bond Position:  [4.62905023]


portfolio before change:  [16.28745057]
curr_Stock_Price:  94.61762405909579
curr_Factors:  [94.61762406]
mat_Sqrt:  [[0.15]]
grads:  [0.07163079]
Stock Position:  0.07163079285679055
Bond Position:  [9.50991514]


portfolio before change:  [16.24448434]
curr_Stock_Price:  94.0011985501082
curr_Factors:  [94.00119855]
mat_Sqrt:  [[0.15]]
grads:  [0.1198767]
Stock Position:  0.11987669575166979
Bond Position:  [4.97593126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.24448434]
Stock Price:  93.97674362991016
PL:  [16.24448434]
Settle:  Tensor("sub_70:0", shape=(), dtype=float64)
PL:  Tensor("sub_71:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  36
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.12257879e-03]
 [-6.21143345e-03]
 [ 9.04658312e-03]
 [-6.09585917e-03]
 [ 5.64257280e-03]
 [ 1.62336708e-02]
 [ 2.71860571e-02]
 [-3.15043732e-03]
 [ 1.73875003e-02]
 [-9.94951841e-04]
 [ 9.99367008e-04]
 [-2.03291324e-03]
 [ 6.74244544e-03]
 [ 1.07476939e-02]
 [-3.41417281e-03]
 [-1.42176682e-02]
 [ 4.74346008e-03]
 [ 1.94938182e-04]
 [-3.99513576e-03]
 [-2.30716486e-03]
 [-2.60490402e-04]
 [ 6.81208976e-03]
 [ 4.77761541e-03]
 [ 7.00246041e-03]
 [-3.63322436e-03]
 [-5.80000993e-03]
 [ 6.65959925e-03]
 [-1.28251127e-02]
 [ 8.15455664e-03]
 [ 2.41960311e-02]
 [-1.03381022e-02]
 [ 6.43711415e-03]
 [-1.26413004e-02]
 [-5.22040227e-03]
 [-5.75626722e-03]
 [-6.95770424e-03]
 [ 2.28082504e-02]
 [ 6.75798077e-03]
 [ 2.33319812e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.69123739]
curr_Stock_Price:  99.44396121723459
curr_Factors:  [99.44396122]
mat_Sqrt:  [[0.15]]
grads:  [-0.02748386]
Stock Position:  -0.027483858572043142
Bond Position:  [-3.95813362]


portfolio before change:  [-6.73384015]
curr_Stock_Price:  100.9760593969204
curr_Factors:  [100.9760594]
mat_Sqrt:  [[0.15]]
grads:  [-0.04140956]
Stock Position:  -0.04140955632725384
Bond Position:  [-2.55246634]


portfolio before change:  [-6.67985534]
curr_Stock_Price:  99.66467380499208
curr_Factors:  [99.6646738]
mat_Sqrt:  [[0.15]]
grads:  [0.06031055]
Stock Position:  0.06031055411431094
Bond Position:  [-12.69068704]


portfolio before change:  [-6.66929336]
curr_Stock_Price:  99.86610478357
curr_Factors:  [99.86610478]
mat_Sqrt:  [[0.15]]
grads:  [-0.04063906]
Stock Position:  -0.04063906113826436
Bond Position:  [-2.61082862]


portfolio before change:  [-6.6805597]
curr_Stock_Price:  100.13530310752458
curr_Factors:  [100.13530311]
mat_Sqrt:  [[0.15]]
grads:  [0.03761715]
Stock Position:  0.03761715200007818
Bond Position:  [-10.44736462]


portfolio before change:  [-6.69960464]
curr_Stock_Price:  99.66373788480198
curr_Factors:  [99.66373788]
mat_Sqrt:  [[0.15]]
grads:  [0.10822447]
Stock Position:  0.1082244720332686
Bond Position:  [-17.48566006]


portfolio before change:  [-6.63729614]
curr_Stock_Price:  100.25966916391859
curr_Factors:  [100.25966916]
mat_Sqrt:  [[0.15]]
grads:  [0.18124038]
Stock Position:  0.18124038092650682
Bond Position:  [-24.80839677]


portfolio before change:  [-6.68245474]
curr_Stock_Price:  100.02761624793294
curr_Factors:  [100.02761625]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100292]
Stock Position:  -0.021002915463720552
Bond Position:  [-4.58158317]


portfolio before change:  [-6.66728287]
curr_Stock_Price:  99.27797735023793
curr_Factors:  [99.27797735]
mat_Sqrt:  [[0.15]]
grads:  [0.11591667]
Stock Position:  0.11591666883879852
Bond Position:  [-18.1752553]


portfolio before change:  [-6.74991052]
curr_Stock_Price:  98.58475865953181
curr_Factors:  [98.58475866]
mat_Sqrt:  [[0.15]]
grads:  [-0.00663301]
Stock Position:  -0.006633012276354867
Bond Position:  [-6.09599661]


portfolio before change:  [-6.74751776]
curr_Stock_Price:  98.10913551815227
curr_Factors:  [98.10913552]
mat_Sqrt:  [[0.15]]
grads:  [0.00666245]
Stock Position:  0.006662446717199909
Bond Position:  [-7.40116464]


portfolio before change:  [-6.74930617]
curr_Stock_Price:  97.979571576962
curr_Factors:  [97.97957158]
mat_Sqrt:  [[0.15]]
grads:  [-0.01355275]
Stock Position:  -0.01355275491507028
Bond Position:  [-5.42141305]


portfolio before change:  [-6.75083836]
curr_Stock_Price:  98.04261955564361
curr_Factors:  [98.04261956]
mat_Sqrt:  [[0.15]]
grads:  [0.04494964]
Stock Position:  0.044949636258378084
Bond Position:  [-11.15781845]


portfolio before change:  [-6.73200009]
curr_Stock_Price:  98.49274753247245
curr_Factors:  [98.49274753]
mat_Sqrt:  [[0.15]]
grads:  [0.07165129]
Stock Position:  0.07165129268633927
Bond Position:  [-13.78913277]


portfolio before change:  [-6.71236813]
curr_Stock_Price:  98.79079816462294
curr_Factors:  [98.79079816]
mat_Sqrt:  [[0.15]]
grads:  [-0.02276115]
Stock Position:  -0.02276115209222421
Bond Position:  [-4.46377574]


portfolio before change:  [-6.73794687]
curr_Stock_Price:  99.89007184144036
curr_Factors:  [99.89007184]
mat_Sqrt:  [[0.15]]
grads:  [-0.09478445]
Stock Position:  -0.09478445458204877
Bond Position:  [2.73007911]


portfolio before change:  [-6.80589288]
curr_Stock_Price:  100.6105200978227
curr_Factors:  [100.6105201]
mat_Sqrt:  [[0.15]]
grads:  [0.03162307]
Stock Position:  0.031623067188407565
Bond Position:  [-9.98750612]


portfolio before change:  [-6.7861415]
curr_Stock_Price:  101.27458907673885
curr_Factors:  [101.27458908]
mat_Sqrt:  [[0.15]]
grads:  [0.00129959]
Stock Position:  0.0012995878799873582
Bond Position:  [-6.91775673]


portfolio before change:  [-6.78562575]
curr_Stock_Price:  102.3368680353516
curr_Factors:  [102.33686804]
mat_Sqrt:  [[0.15]]
grads:  [-0.02663424]
Stock Position:  -0.026634238377397607
Bond Position:  [-4.05996121]


portfolio before change:  [-6.76408261]
curr_Stock_Price:  101.5089611465374
curr_Factors:  [101.50896115]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153811]
Stock Position:  -0.01538109904853035
Bond Position:  [-5.20276322]


portfolio before change:  [-6.76823671]
curr_Stock_Price:  101.73675506516139
curr_Factors:  [101.73675507]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017366]
Stock Position:  -0.001736602681132355
Bond Position:  [-6.59156039]


portfolio before change:  [-6.76732073]
curr_Stock_Price:  100.73480765383064
curr_Factors:  [100.73480765]
mat_Sqrt:  [[0.15]]
grads:  [0.04541393]
Stock Position:  0.045413931725460266
Bond Position:  [-11.3420844]


portfolio before change:  [-6.77190935]
curr_Stock_Price:  100.66498826067959
curr_Factors:  [100.66498826]
mat_Sqrt:  [[0.15]]
grads:  [0.03185077]
Stock Position:  0.03185076939812183
Bond Position:  [-9.97816668]


portfolio before change:  [-6.76888557]
curr_Stock_Price:  100.79908627838998
curr_Factors:  [100.79908628]
mat_Sqrt:  [[0.15]]
grads:  [0.04668307]
Stock Position:  0.04668306936952042
Bond Position:  [-11.47449631]


portfolio before change:  [-6.75735467]
curr_Stock_Price:  101.07681660628585
curr_Factors:  [101.07681661]
mat_Sqrt:  [[0.15]]
grads:  [-0.0242215]
Stock Position:  -0.024221495715306175
Bond Position:  [-4.30912299]


portfolio before change:  [-6.77904961]
curr_Stock_Price:  101.95026646334853
curr_Factors:  [101.95026646]
mat_Sqrt:  [[0.15]]
grads:  [-0.03866673]
Stock Position:  -0.03866673284662623
Bond Position:  [-2.83696589]


portfolio before change:  [-6.75349229]
curr_Stock_Price:  101.28013079280952
curr_Factors:  [101.28013079]
mat_Sqrt:  [[0.15]]
grads:  [0.04439733]
Stock Position:  0.04439732834831656
Bond Position:  [-11.25005951]


portfolio before change:  [-6.70514002]
curr_Stock_Price:  102.40088790021237
curr_Factors:  [102.4008879]
mat_Sqrt:  [[0.15]]
grads:  [-0.08550075]
Stock Position:  -0.08550075136073063
Bond Position:  [2.05021284]


portfolio before change:  [-6.76788895]
curr_Stock_Price:  103.13778468971002
curr_Factors:  [103.13778469]
mat_Sqrt:  [[0.15]]
grads:  [0.05436371]
Stock Position:  0.05436371096390609
Bond Position:  [-12.37484167]


portfolio before change:  [-6.76848236]
curr_Stock_Price:  103.15532471970991
curr_Factors:  [103.15532472]
mat_Sqrt:  [[0.15]]
grads:  [0.16130687]
Stock Position:  0.161306874224423
Bond Position:  [-23.40814535]


portfolio before change:  [-6.75052881]
curr_Stock_Price:  103.28476592491145
curr_Factors:  [103.28476592]
mat_Sqrt:  [[0.15]]
grads:  [-0.06892068]
Stock Position:  -0.0689206812831915
Bond Position:  [0.36792763]


portfolio before change:  [-6.69888823]
curr_Stock_Price:  102.53615774925706
curr_Factors:  [102.53615775]
mat_Sqrt:  [[0.15]]
grads:  [0.04291409]
Stock Position:  0.04291409434906433
Bond Position:  [-11.09913458]


portfolio before change:  [-6.72731509]
curr_Stock_Price:  101.90607620768651
curr_Factors:  [101.90607621]
mat_Sqrt:  [[0.15]]
grads:  [-0.08427534]
Stock Position:  -0.08427533586345096
Bond Position:  [1.86085371]


portfolio before change:  [-6.62953144]
curr_Stock_Price:  100.74854858191003
curr_Factors:  [100.74854858]
mat_Sqrt:  [[0.15]]
grads:  [-0.03480268]
Stock Position:  -0.034802681789552196
Bond Position:  [-3.12321176]


portfolio before change:  [-6.6324806]
curr_Stock_Price:  100.82206986274483
curr_Factors:  [100.82206986]
mat_Sqrt:  [[0.15]]
grads:  [-0.03837511]
Stock Position:  -0.03837511482280491
Bond Position:  [-2.76342209]


portfolio before change:  [-6.63341883]
curr_Stock_Price:  100.83751691000045
curr_Factors:  [100.83751691]
mat_Sqrt:  [[0.15]]
grads:  [-0.04638469]
Stock Position:  -0.04638469492035894
Bond Position:  [-1.95610137]


portfolio before change:  [-6.63941299]
curr_Stock_Price:  100.96147231677551
curr_Factors:  [100.96147232]
mat_Sqrt:  [[0.15]]
grads:  [0.152055]
Stock Position:  0.15205500279673434
Bond Position:  [-21.99110995]


portfolio before change:  [-6.6859569]
curr_Stock_Price:  100.67345252874888
curr_Factors:  [100.67345253]
mat_Sqrt:  [[0.15]]
grads:  [0.04505321]
Stock Position:  0.04505320513036088
Bond Position:  [-11.22161861]


portfolio before change:  [-6.67375393]
curr_Stock_Price:  100.97544567519198
curr_Factors:  [100.97544568]
mat_Sqrt:  [[0.15]]
grads:  [0.15554654]
Stock Position:  0.1555465415624456
Bond Position:  [-22.38013529]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.67375393]
Stock Price:  101.5030414128546
PL:  [-8.17679535]
Settle:  Tensor("sub_72:0", shape=(), dtype=float64)
PL:  Tensor("sub_73:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  37
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45909209e-03]
 [-1.63438395e-03]
 [ 1.10185403e-03]
 [ 6.77689130e-02]
 [-1.39831933e-02]
 [ 3.16610360e-02]
 [ 1.17645192e-02]
 [-6.59822558e-04]
 [ 4.54257878e-03]
 [ 5.81388227e-03]
 [ 4.84758930e-03]
 [ 3.87614962e-03]
 [ 6.59826953e-03]
 [ 9.89884469e-03]
 [-1.13051547e-03]
 [-1.10337976e-02]
 [-5.76270894e-03]
 [-2.10687964e-03]
 [-7.56758340e-03]
 [-2.38277707e-03]
 [ 3.93509089e-04]
 [ 1.03433150e-02]
 [ 4.75735055e-03]
 [ 5.47371902e-03]
 [ 2.70526317e-03]
 [-6.05139749e-04]
 [ 9.59548755e-03]
 [-2.10282323e-02]
 [-1.56116848e-02]
 [ 2.15494065e-02]
 [ 2.50508006e-03]
 [-1.63761489e-02]
 [-1.21040798e-02]
 [-1.82175252e-04]
 [-6.88783734e-03]
 [ 3.96498488e-04]
 [ 1.70545473e-02]
 [ 1.69302582e-02]
 [ 1.30278002e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.02924926]
curr_Stock_Price:  100.2634413057366
curr_Factors:  [100.26344131]
mat_Sqrt:  [[0.15]]
grads:  [-0.00972728]
Stock Position:  -0.00972728059503715
Bond Position:  [7.00453989]


portfolio before change:  [6.01668331]
curr_Stock_Price:  101.645284077845
curr_Factors:  [101.64528408]
mat_Sqrt:  [[0.15]]
grads:  [-0.01089589]
Stock Position:  -0.010895893023475201
Bond Position:  [7.12419945]


portfolio before change:  [6.00210236]
curr_Stock_Price:  103.06522546174652
curr_Factors:  [103.06522546]
mat_Sqrt:  [[0.15]]
grads:  [0.00734569]
Stock Position:  0.007345693538419393
Bond Position:  [5.2450168]


portfolio before change:  [5.99910296]
curr_Stock_Price:  102.56764581542828
curr_Factors:  [102.56764582]
mat_Sqrt:  [[0.15]]
grads:  [0.45179275]
Stock Position:  0.4517927534891131
Bond Position:  [-40.34021616]


portfolio before change:  [5.92836352]
curr_Stock_Price:  102.42223269066643
curr_Factors:  [102.42223269]
mat_Sqrt:  [[0.15]]
grads:  [-0.09322129]
Stock Position:  -0.09322128855384583
Bond Position:  [15.47629603]


portfolio before change:  [5.95642802]
curr_Stock_Price:  102.14193362982964
curr_Factors:  [102.14193363]
mat_Sqrt:  [[0.15]]
grads:  [0.21107357]
Stock Position:  0.21107357329617207
Bond Position:  [-15.6030349]


portfolio before change:  [5.87308716]
curr_Stock_Price:  101.75633179440737
curr_Factors:  [101.75633179]
mat_Sqrt:  [[0.15]]
grads:  [0.07843013]
Stock Position:  0.07843012816709628
Bond Position:  [-2.10767498]


portfolio before change:  [5.85887662]
curr_Stock_Price:  101.57850390088393
curr_Factors:  [101.5785039]
mat_Sqrt:  [[0.15]]
grads:  [-0.00439882]
Stock Position:  -0.004398817055380881
Bond Position:  [6.30570188]


portfolio before change:  [5.86016569]
curr_Stock_Price:  101.46465370575422
curr_Factors:  [101.46465371]
mat_Sqrt:  [[0.15]]
grads:  [0.03028386]
Stock Position:  0.030283858524859677
Bond Position:  [2.78742447]


portfolio before change:  [5.83642131]
curr_Stock_Price:  100.66908690676269
curr_Factors:  [100.66908691]
mat_Sqrt:  [[0.15]]
grads:  [0.03875922]
Stock Position:  0.038759215119012196
Bond Position:  [1.93456651]


portfolio before change:  [5.80660212]
curr_Stock_Price:  99.89350315947748
curr_Factors:  [99.89350316]
mat_Sqrt:  [[0.15]]
grads:  [0.03231726]
Stock Position:  0.032317262002095684
Bond Position:  [2.57831761]


portfolio before change:  [5.77562077]
curr_Stock_Price:  98.92486726735146
curr_Factors:  [98.92486727]
mat_Sqrt:  [[0.15]]
grads:  [0.025841]
Stock Position:  0.02584099748663979
Bond Position:  [3.21930353]


portfolio before change:  [5.7545774]
curr_Stock_Price:  98.09495306197975
curr_Factors:  [98.09495306]
mat_Sqrt:  [[0.15]]
grads:  [0.04398846]
Stock Position:  0.04398846353519209
Bond Position:  [1.43953114]


portfolio before change:  [5.80194477]
curr_Stock_Price:  99.16767550626378
curr_Factors:  [99.16767551]
mat_Sqrt:  [[0.15]]
grads:  [0.0659923]
Stock Position:  0.06599229794072407
Bond Position:  [-0.74235802]


portfolio before change:  [5.75373515]
curr_Stock_Price:  98.43854768284822
curr_Factors:  [98.43854768]
mat_Sqrt:  [[0.15]]
grads:  [-0.00753677]
Stock Position:  -0.007536769775762584
Bond Position:  [6.49564382]


portfolio before change:  [5.75638933]
curr_Stock_Price:  98.19412212008146
curr_Factors:  [98.19412212]
mat_Sqrt:  [[0.15]]
grads:  [-0.07355865]
Stock Position:  -0.07355865042372642
Bond Position:  [12.97941643]


portfolio before change:  [5.79860917]
curr_Stock_Price:  97.64221818855148
curr_Factors:  [97.64221819]
mat_Sqrt:  [[0.15]]
grads:  [-0.03841806]
Stock Position:  -0.038418059623179325
Bond Position:  [9.54983373]


portfolio before change:  [5.77461867]
curr_Stock_Price:  98.29775112239236
curr_Factors:  [98.29775112]
mat_Sqrt:  [[0.15]]
grads:  [-0.01404586]
Stock Position:  -0.014045864240394942
Bond Position:  [7.15529554]


portfolio before change:  [5.7852125]
curr_Stock_Price:  97.60720185830577
curr_Factors:  [97.60720186]
mat_Sqrt:  [[0.15]]
grads:  [-0.05045056]
Stock Position:  -0.05045055597238098
Bond Position:  [10.7095501]


portfolio before change:  [5.76671687]
curr_Stock_Price:  98.00034734420356
curr_Factors:  [98.00034734]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588518]
Stock Position:  -0.01588518048409367
Bond Position:  [7.32347007]


portfolio before change:  [5.77027991]
curr_Stock_Price:  97.83367909334757
curr_Factors:  [97.83367909]
mat_Sqrt:  [[0.15]]
grads:  [0.00262339]
Stock Position:  0.0026233939282466153
Bond Position:  [5.51362363]


portfolio before change:  [5.77030678]
curr_Stock_Price:  97.5811899588593
curr_Factors:  [97.58118996]
mat_Sqrt:  [[0.15]]
grads:  [0.06895543]
Stock Position:  0.06895543317134352
Bond Position:  [-0.95844644]


portfolio before change:  [5.68911705]
curr_Stock_Price:  96.40550421871657
curr_Factors:  [96.40550422]
mat_Sqrt:  [[0.15]]
grads:  [0.03171567]
Stock Position:  0.031715670304924413
Bond Position:  [2.63155186]


portfolio before change:  [5.65949185]
curr_Stock_Price:  95.46104484278031
curr_Factors:  [95.46104484]
mat_Sqrt:  [[0.15]]
grads:  [0.03649146]
Stock Position:  0.03649146015801864
Bond Position:  [2.17597894]


portfolio before change:  [5.64676186]
curr_Stock_Price:  95.10474223202645
curr_Factors:  [95.10474223]
mat_Sqrt:  [[0.15]]
grads:  [0.01803509]
Stock Position:  0.01803508782490562
Bond Position:  [3.93153948]


portfolio before change:  [5.62649922]
curr_Stock_Price:  93.9539790202334
curr_Factors:  [93.95397902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00403426]
Stock Position:  -0.004034264995863904
Bond Position:  [6.00553447]


portfolio before change:  [5.62606438]
curr_Stock_Price:  94.24785507937278
curr_Factors:  [94.24785508]
mat_Sqrt:  [[0.15]]
grads:  [0.06396992]
Stock Position:  0.06396991699209999
Bond Position:  [-0.40296308]


portfolio before change:  [5.53772376]
curr_Stock_Price:  92.86767123802206
curr_Factors:  [92.86767124]
mat_Sqrt:  [[0.15]]
grads:  [-0.14018822]
Stock Position:  -0.1401882156015458
Bond Position:  [18.55667688]


portfolio before change:  [5.58797318]
curr_Stock_Price:  92.52577597656955
curr_Factors:  [92.52577598]
mat_Sqrt:  [[0.15]]
grads:  [-0.1040779]
Stock Position:  -0.10407789838786898
Bond Position:  [15.21786149]


portfolio before change:  [5.65732168]
curr_Stock_Price:  91.8777407185492
curr_Factors:  [91.87774072]
mat_Sqrt:  [[0.15]]
grads:  [0.14366271]
Stock Position:  0.14366271015958687
Bond Position:  [-7.54208355]


portfolio before change:  [5.5244915]
curr_Stock_Price:  90.95970598134117
curr_Factors:  [90.95970598]
mat_Sqrt:  [[0.15]]
grads:  [0.01670053]
Stock Position:  0.016700533727127993
Bond Position:  [4.00541587]


portfolio before change:  [5.54106854]
curr_Stock_Price:  91.92232954093376
curr_Factors:  [91.92232954]
mat_Sqrt:  [[0.15]]
grads:  [-0.10917433]
Stock Position:  -0.10917432594163712
Bond Position:  [15.5766269]


portfolio before change:  [5.55494633]
curr_Stock_Price:  91.81304931789144
curr_Factors:  [91.81304932]
mat_Sqrt:  [[0.15]]
grads:  [-0.08069387]
Stock Position:  -0.08069386555467738
Bond Position:  [12.96369619]


portfolio before change:  [5.61295724]
curr_Stock_Price:  91.11423106031526
curr_Factors:  [91.11423106]
mat_Sqrt:  [[0.15]]
grads:  [-0.0012145]
Stock Position:  -0.0012145016796396026
Bond Position:  [5.72361563]


portfolio before change:  [5.61317884]
curr_Stock_Price:  91.52089907536424
curr_Factors:  [91.52089908]
mat_Sqrt:  [[0.15]]
grads:  [-0.04591892]
Stock Position:  -0.04591891559406892
Bond Position:  [9.81571928]


portfolio before change:  [5.62802677]
curr_Stock_Price:  91.22426986000414
curr_Factors:  [91.22426986]
mat_Sqrt:  [[0.15]]
grads:  [0.00264332]
Stock Position:  0.0026433232511337743
Bond Position:  [5.38689154]


portfolio before change:  [5.62764117]
curr_Stock_Price:  90.82363552035991
curr_Factors:  [90.82363552]
mat_Sqrt:  [[0.15]]
grads:  [0.11369698]
Stock Position:  0.11369698177581374
Bond Position:  [-4.69873206]


portfolio before change:  [5.53249564]
curr_Stock_Price:  89.99196743522889
curr_Factors:  [89.99196744]
mat_Sqrt:  [[0.15]]
grads:  [0.11286839]
Stock Position:  0.11286838794922381
Bond Position:  [-4.62475265]


portfolio before change:  [5.56771791]
curr_Stock_Price:  90.3091545251955
curr_Factors:  [90.30915453]
mat_Sqrt:  [[0.15]]
grads:  [0.086852]
Stock Position:  0.0868520012018266
Bond Position:  [-2.27581289]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.56771791]
Stock Price:  90.75847672844547
PL:  [5.56771791]
Settle:  Tensor("sub_74:0", shape=(), dtype=float64)
PL:  Tensor("sub_75:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  38
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45028306e-03]
 [-3.08586936e-03]
 [ 1.13786259e-02]
 [-1.04132835e-02]
 [ 1.14477259e-02]
 [ 2.80509229e-02]
 [ 2.14142944e-02]
 [-3.10309264e-04]
 [ 8.80639099e-03]
 [ 1.31332663e-02]
 [ 2.38462967e-02]
 [-5.40776440e-03]
 [-1.27293273e-02]
 [-5.87430420e-03]
 [ 4.57956138e-03]
 [-3.54083752e-02]
 [ 4.63702442e-03]
 [-1.28793560e-02]
 [ 1.22347836e-02]
 [-4.42601312e-03]
 [-2.87577775e-03]
 [-3.93797856e-02]
 [ 4.85545419e-03]
 [ 1.35026521e-02]
 [-5.88394677e-03]
 [ 6.79291237e-03]
 [-8.71300134e-03]
 [ 6.07556716e-03]
 [ 4.49398585e-02]
 [ 2.63773115e-02]
 [-2.76517002e-02]
 [ 3.39466311e-03]
 [-1.32794054e-02]
 [ 5.95764332e-03]
 [-7.64041932e-03]
 [ 7.82503084e-03]
 [ 2.46647583e-02]
 [ 6.42196520e-03]
 [ 1.86187144e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.29157377]
curr_Stock_Price:  100.5380290761564
curr_Factors:  [100.53802908]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966855]
Stock Position:  -0.009668553737829991
Bond Position:  [11.26363111]


portfolio before change:  [10.2998867]
curr_Stock_Price:  99.82386959355809
curr_Factors:  [99.82386959]
mat_Sqrt:  [[0.15]]
grads:  [-0.02057246]
Stock Position:  -0.020572462367458775
Bond Position:  [12.3535095]


portfolio before change:  [10.30349825]
curr_Stock_Price:  99.72338245875825
curr_Factors:  [99.72338246]
mat_Sqrt:  [[0.15]]
grads:  [0.07585751]
Stock Position:  0.07585750625259319
Bond Position:  [2.73873114]


portfolio before change:  [10.26894641]
curr_Stock_Price:  99.26338571428319
curr_Factors:  [99.26338571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06942189]
Stock Position:  -0.06942188978177172
Bond Position:  [17.15999823]


portfolio before change:  [10.18428033]
curr_Stock_Price:  100.51387334603571
curr_Factors:  [100.51387335]
mat_Sqrt:  [[0.15]]
grads:  [0.07631817]
Stock Position:  0.07631817279188752
Bond Position:  [2.51324518]


portfolio before change:  [10.23589392]
curr_Stock_Price:  101.18605162282026
curr_Factors:  [101.18605162]
mat_Sqrt:  [[0.15]]
grads:  [0.18700615]
Stock Position:  0.1870061529397635
Bond Position:  [-8.68652032]


portfolio before change:  [10.21612361]
curr_Stock_Price:  101.08613817582152
curr_Factors:  [101.08613818]
mat_Sqrt:  [[0.15]]
grads:  [0.14276196]
Stock Position:  0.14276196244898148
Bond Position:  [-4.21513185]


portfolio before change:  [10.31060696]
curr_Stock_Price:  101.75165347962228
curr_Factors:  [101.75165348]
mat_Sqrt:  [[0.15]]
grads:  [-0.00206873]
Stock Position:  -0.00206872842603275
Bond Position:  [10.52110349]


portfolio before change:  [10.31058247]
curr_Stock_Price:  102.39925421694524
curr_Factors:  [102.39925422]
mat_Sqrt:  [[0.15]]
grads:  [0.05870927]
Stock Position:  0.05870927328759393
Bond Position:  [4.29879667]


portfolio before change:  [10.38318186]
curr_Stock_Price:  103.62669257679244
curr_Factors:  [103.62669258]
mat_Sqrt:  [[0.15]]
grads:  [0.08755511]
Stock Position:  0.08755510857888599
Bond Position:  [1.31013554]


portfolio before change:  [10.34955651]
curr_Stock_Price:  103.24077416433609
curr_Factors:  [103.24077416]
mat_Sqrt:  [[0.15]]
grads:  [0.15897531]
Stock Position:  0.1589753112204726
Bond Position:  [-6.06317769]


portfolio before change:  [10.37663127]
curr_Stock_Price:  103.41584979184557
curr_Factors:  [103.41584979]
mat_Sqrt:  [[0.15]]
grads:  [-0.03605176]
Stock Position:  -0.0360517626977478
Bond Position:  [14.10495495]


portfolio before change:  [10.35924695]
curr_Stock_Price:  103.94696243620098
curr_Factors:  [103.94696244]
mat_Sqrt:  [[0.15]]
grads:  [-0.08486218]
Stock Position:  -0.08486218225068877
Bond Position:  [19.18041302]


portfolio before change:  [10.29645158]
curr_Stock_Price:  104.71518536700053
curr_Factors:  [104.71518537]
mat_Sqrt:  [[0.15]]
grads:  [-0.03916203]
Stock Position:  -0.03916202801960358
Bond Position:  [14.3973106]


portfolio before change:  [10.26981137]
curr_Stock_Price:  105.441398557714
curr_Factors:  [105.44139856]
mat_Sqrt:  [[0.15]]
grads:  [0.03053041]
Stock Position:  0.030530409183793288
Bond Position:  [7.05064233]


portfolio before change:  [10.29352767]
curr_Stock_Price:  106.18933848976748
curr_Factors:  [106.18933849]
mat_Sqrt:  [[0.15]]
grads:  [-0.23605583]
Stock Position:  -0.2360558349213443
Bond Position:  [35.36014063]


portfolio before change:  [10.27723981]
curr_Stock_Price:  106.27706415245564
curr_Factors:  [106.27706415]
mat_Sqrt:  [[0.15]]
grads:  [0.0309135]
Stock Position:  0.030913496125151707
Bond Position:  [6.9918442]


portfolio before change:  [10.2794573]
curr_Stock_Price:  106.3205225880699
curr_Factors:  [106.32052259]
mat_Sqrt:  [[0.15]]
grads:  [-0.08586237]
Stock Position:  -0.08586237327618321
Bond Position:  [19.4083897]


portfolio before change:  [10.31768058]
curr_Stock_Price:  105.9036102204321
curr_Factors:  [105.90361022]
mat_Sqrt:  [[0.15]]
grads:  [0.08156522]
Stock Position:  0.08156522406758028
Bond Position:  [1.67962889]


portfolio before change:  [10.32783916]
curr_Stock_Price:  106.02558147890348
curr_Factors:  [106.02558148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02950675]
Stock Position:  -0.029506754127983835
Bond Position:  [13.45630993]


portfolio before change:  [10.31397712]
curr_Stock_Price:  106.55238255740892
curr_Factors:  [106.55238256]
mat_Sqrt:  [[0.15]]
grads:  [-0.01917185]
Stock Position:  -0.01917185166377402
Bond Position:  [12.35678359]


portfolio before change:  [10.32985279]
curr_Stock_Price:  105.80488181334267
curr_Factors:  [105.80488181]
mat_Sqrt:  [[0.15]]
grads:  [-0.2625319]
Stock Position:  -0.2625319039856676
Bond Position:  [38.10700986]


portfolio before change:  [9.75609124]
curr_Stock_Price:  108.00851959410589
curr_Factors:  [108.00851959]
mat_Sqrt:  [[0.15]]
grads:  [0.03236969]
Stock Position:  0.032369694597686134
Bond Position:  [6.25988844]


portfolio before change:  [9.73717694]
curr_Stock_Price:  107.4000235070189
curr_Factors:  [107.40002351]
mat_Sqrt:  [[0.15]]
grads:  [0.09001768]
Stock Position:  0.09001768062329862
Bond Position:  [0.06927593]


portfolio before change:  [9.66620824]
curr_Stock_Price:  106.61154105491154
curr_Factors:  [106.61154105]
mat_Sqrt:  [[0.15]]
grads:  [-0.03922631]
Stock Position:  -0.03922631180509613
Bond Position:  [13.84818579]


portfolio before change:  [9.72736086]
curr_Stock_Price:  105.0967035880866
curr_Factors:  [105.09670359]
mat_Sqrt:  [[0.15]]
grads:  [0.04528608]
Stock Position:  0.04528608247353019
Bond Position:  [4.96794287]


portfolio before change:  [9.72529594]
curr_Stock_Price:  105.0373928657442
curr_Factors:  [105.03739287]
mat_Sqrt:  [[0.15]]
grads:  [-0.05808668]
Stock Position:  -0.05808667556755438
Bond Position:  [15.8265689]


portfolio before change:  [9.67572903]
curr_Stock_Price:  105.92477974661125
curr_Factors:  [105.92477975]
mat_Sqrt:  [[0.15]]
grads:  [0.04050378]
Stock Position:  0.04050378108304766
Bond Position:  [5.38537494]


portfolio before change:  [9.65885257]
curr_Stock_Price:  105.49149489974346
curr_Factors:  [105.4914949]
mat_Sqrt:  [[0.15]]
grads:  [0.29959906]
Stock Position:  0.2995990567717104
Bond Position:  [-21.9462998]


portfolio before change:  [9.76038296]
curr_Stock_Price:  105.83953954421179
curr_Factors:  [105.83953954]
mat_Sqrt:  [[0.15]]
grads:  [0.17584874]
Stock Position:  0.17584874304176376
Bond Position:  [-8.85136704]


portfolio before change:  [9.84406011]
curr_Stock_Price:  106.32167916436512
curr_Factors:  [106.32167916]
mat_Sqrt:  [[0.15]]
grads:  [-0.18434467]
Stock Position:  -0.1843446680442678
Bond Position:  [29.44389476]


portfolio before change:  [9.65373985]
curr_Stock_Price:  107.37406099355753
curr_Factors:  [107.37406099]
mat_Sqrt:  [[0.15]]
grads:  [0.02263109]
Stock Position:  0.022631087431480044
Bond Position:  [7.22374809]


portfolio before change:  [9.66762296]
curr_Stock_Price:  107.94761212231448
curr_Factors:  [107.94761212]
mat_Sqrt:  [[0.15]]
grads:  [-0.08852937]
Stock Position:  -0.08852936933631496
Bond Position:  [19.22415698]


portfolio before change:  [9.70439625]
curr_Stock_Price:  107.55937806891804
curr_Factors:  [107.55937807]
mat_Sqrt:  [[0.15]]
grads:  [0.03971762]
Stock Position:  0.03971762211574529
Bond Position:  [5.43239351]


portfolio before change:  [9.73960903]
curr_Stock_Price:  108.42885845579839
curr_Factors:  [108.42885846]
mat_Sqrt:  [[0.15]]
grads:  [-0.05093613]
Stock Position:  -0.050936128818874854
Bond Position:  [15.26255533]


portfolio before change:  [9.7512115]
curr_Stock_Price:  108.238531345189
curr_Factors:  [108.23853135]
mat_Sqrt:  [[0.15]]
grads:  [0.05216687]
Stock Position:  0.05216687225326147
Bond Position:  [4.10474586]


portfolio before change:  [9.6921113]
curr_Stock_Price:  107.09578837195102
curr_Factors:  [107.09578837]
mat_Sqrt:  [[0.15]]
grads:  [0.16443172]
Stock Position:  0.16443172178718368
Bond Position:  [-7.91783358]


portfolio before change:  [9.63695816]
curr_Stock_Price:  106.7663911865766
curr_Factors:  [106.76639119]
mat_Sqrt:  [[0.15]]
grads:  [0.0428131]
Stock Position:  0.04281310131857434
Bond Position:  [5.06595784]


portfolio before change:  [9.67292137]
curr_Stock_Price:  107.59160422292675
curr_Factors:  [107.59160422]
mat_Sqrt:  [[0.15]]
grads:  [0.12412476]
Stock Position:  0.1241247624456785
Bond Position:  [-3.68186094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.67292137]
Stock Price:  107.3687797636205
PL:  [2.30414161]
Settle:  Tensor("sub_76:0", shape=(), dtype=float64)
PL:  Tensor("sub_77:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  39
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.59168199e-03]
 [-1.65381556e-02]
 [-3.50637810e-03]
 [ 4.88525899e-02]
 [ 8.69896328e-03]
 [ 3.08168922e-02]
 [ 2.33430858e-02]
 [-4.58067443e-04]
 [ 8.29238759e-03]
 [ 1.86171585e-03]
 [ 2.11603579e-02]
 [ 4.87536067e-03]
 [-1.13414048e-02]
 [ 4.76536599e-03]
 [ 2.95941954e-04]
 [-3.04173448e-02]
 [ 4.67254406e-03]
 [-1.47662775e-02]
 [ 1.01957946e-02]
 [-4.54330778e-03]
 [-2.39311436e-03]
 [-3.94298266e-02]
 [ 4.81566914e-03]
 [ 1.01090277e-02]
 [-5.56150978e-03]
 [ 5.39604148e-03]
 [-1.04503227e-02]
 [ 2.00415032e-04]
 [ 3.77390617e-02]
 [ 2.59568559e-02]
 [-2.24096717e-02]
 [ 6.19458619e-03]
 [-1.31222538e-02]
 [ 3.08250526e-03]
 [-6.79004724e-03]
 [ 4.55589311e-03]
 [ 2.45211742e-02]
 [ 4.76064998e-03]
 [ 1.90765082e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.56507701]
curr_Stock_Price:  100.42680458036432
curr_Factors:  [100.42680458]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061121]
Stock Position:  -0.010611213234986266
Bond Position:  [9.63072725]


portfolio before change:  [8.56787119]
curr_Stock_Price:  100.27693900790784
curr_Factors:  [100.27693901]
mat_Sqrt:  [[0.15]]
grads:  [-0.11025437]
Stock Position:  -0.11025437065112387
Bond Position:  [19.62384199]


portfolio before change:  [8.40958233]
curr_Stock_Price:  101.73485843185496
curr_Factors:  [101.73485843]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337585]
Stock Position:  -0.02337585403124056
Bond Position:  [10.78772153]


portfolio before change:  [8.40656835]
curr_Stock_Price:  101.9214838001564
curr_Factors:  [101.9214838]
mat_Sqrt:  [[0.15]]
grads:  [0.32568393]
Stock Position:  0.32568393275635094
Bond Position:  [-24.78762132]


portfolio before change:  [8.32635952]
curr_Stock_Price:  101.68471992063242
curr_Factors:  [101.68471992]
mat_Sqrt:  [[0.15]]
grads:  [0.05799309]
Stock Position:  0.05799308850395878
Bond Position:  [2.42934855]


portfolio before change:  [8.34425028]
curr_Stock_Price:  101.98798149602436
curr_Factors:  [101.9879815]
mat_Sqrt:  [[0.15]]
grads:  [0.20544595]
Stock Position:  0.20544594789555912
Bond Position:  [-12.60876725]


portfolio before change:  [8.12721331]
curr_Stock_Price:  100.93923472077384
curr_Factors:  [100.93923472]
mat_Sqrt:  [[0.15]]
grads:  [0.15562057]
Stock Position:  0.15562057180072333
Bond Position:  [-7.58100812]


portfolio before change:  [8.24130332]
curr_Stock_Price:  101.678453784881
curr_Factors:  [101.67845378]
mat_Sqrt:  [[0.15]]
grads:  [-0.00305378]
Stock Position:  -0.003053782953056291
Bond Position:  [8.55180725]


portfolio before change:  [8.24686373]
curr_Stock_Price:  100.20769575204105
curr_Factors:  [100.20769575]
mat_Sqrt:  [[0.15]]
grads:  [0.05528258]
Stock Position:  0.055282583964554405
Bond Position:  [2.70712338]


portfolio before change:  [8.25156226]
curr_Stock_Price:  100.28656531077905
curr_Factors:  [100.28656531]
mat_Sqrt:  [[0.15]]
grads:  [0.01241144]
Stock Position:  0.012411439008948352
Bond Position:  [7.00686167]


portfolio before change:  [8.26279048]
curr_Stock_Price:  101.12065935971168
curr_Factors:  [101.12065936]
mat_Sqrt:  [[0.15]]
grads:  [0.14106905]
Stock Position:  0.14106905283760418
Bond Position:  [-6.00220516]


portfolio before change:  [8.41426906]
curr_Stock_Price:  102.19976850812368
curr_Factors:  [102.19976851]
mat_Sqrt:  [[0.15]]
grads:  [0.0325024]
Stock Position:  0.03250240448283321
Bond Position:  [5.09253085]


portfolio before change:  [8.39469679]
curr_Stock_Price:  101.57800283736972
curr_Factors:  [101.57800284]
mat_Sqrt:  [[0.15]]
grads:  [-0.07560937]
Stock Position:  -0.07560936561244665
Bond Position:  [16.07494514]


portfolio before change:  [8.25912985]
curr_Stock_Price:  103.3975715687158
curr_Factors:  [103.39757157]
mat_Sqrt:  [[0.15]]
grads:  [0.03176911]
Stock Position:  0.03176910661551275
Bond Position:  [4.97428137]


portfolio before change:  [8.26328375]
curr_Stock_Price:  103.50875135503837
curr_Factors:  [103.50875136]
mat_Sqrt:  [[0.15]]
grads:  [0.00197295]
Stock Position:  0.001972946356817099
Bond Position:  [8.05906654]


portfolio before change:  [8.26576634]
curr_Stock_Price:  104.25643715258643
curr_Factors:  [104.25643715]
mat_Sqrt:  [[0.15]]
grads:  [-0.2027823]
Stock Position:  -0.2027822984615112
Bond Position:  [29.4071263]


portfolio before change:  [7.92014778]
curr_Stock_Price:  105.97894787652577
curr_Factors:  [105.97894788]
mat_Sqrt:  [[0.15]]
grads:  [0.03115029]
Stock Position:  0.031150293736630606
Bond Position:  [4.61887242]


portfolio before change:  [7.95164507]
curr_Stock_Price:  106.97155165369753
curr_Factors:  [106.97155165]
mat_Sqrt:  [[0.15]]
grads:  [-0.09844185]
Stock Position:  -0.09844184991068271
Bond Position:  [18.48212251]


portfolio before change:  [8.10361743]
curr_Stock_Price:  105.45124346776079
curr_Factors:  [105.45124347]
mat_Sqrt:  [[0.15]]
grads:  [0.06797196]
Stock Position:  0.06797196369384202
Bond Position:  [0.93588934]


portfolio before change:  [8.15514924]
curr_Stock_Price:  106.20765551710458
curr_Factors:  [106.20765552]
mat_Sqrt:  [[0.15]]
grads:  [-0.03028872]
Stock Position:  -0.030288718542630932
Bond Position:  [11.37204302]


portfolio before change:  [8.17647059]
curr_Stock_Price:  105.55065328971013
curr_Factors:  [105.55065329]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159541]
Stock Position:  -0.01595409572990584
Bond Position:  [9.86043582]


portfolio before change:  [8.17853964]
curr_Stock_Price:  105.49822673024849
curr_Factors:  [105.49822673]
mat_Sqrt:  [[0.15]]
grads:  [-0.26286551]
Stock Position:  -0.2628655107350694
Bond Position:  [35.91038489]


portfolio before change:  [8.50870493]
curr_Stock_Price:  104.25928057228796
curr_Factors:  [104.25928057]
mat_Sqrt:  [[0.15]]
grads:  [0.03210446]
Stock Position:  0.03210446090400503
Bond Position:  [5.16151694]


portfolio before change:  [8.51367276]
curr_Stock_Price:  104.39392214951201
curr_Factors:  [104.39392215]
mat_Sqrt:  [[0.15]]
grads:  [0.06739352]
Stock Position:  0.06739351795976585
Bond Position:  [1.47819909]


portfolio before change:  [8.53162331]
curr_Stock_Price:  104.65753453233776
curr_Factors:  [104.65753453]
mat_Sqrt:  [[0.15]]
grads:  [-0.03707673]
Stock Position:  -0.03707673189215276
Bond Position:  [12.41198266]


portfolio before change:  [8.52710774]
curr_Stock_Price:  104.82117270329132
curr_Factors:  [104.8211727]
mat_Sqrt:  [[0.15]]
grads:  [0.03597361]
Stock Position:  0.035973609834091945
Bond Position:  [4.75631177]


portfolio before change:  [8.55620974]
curr_Stock_Price:  105.61362668114141
curr_Factors:  [105.61362668]
mat_Sqrt:  [[0.15]]
grads:  [-0.06966882]
Stock Position:  -0.0696688178350305
Bond Position:  [15.91418626]


portfolio before change:  [8.63054083]
curr_Stock_Price:  104.57526127979996
curr_Factors:  [104.57526128]
mat_Sqrt:  [[0.15]]
grads:  [0.0013361]
Stock Position:  0.0013361002150382348
Bond Position:  [8.4908178]


portfolio before change:  [8.63215468]
curr_Stock_Price:  104.9887272038828
curr_Factors:  [104.9887272]
mat_Sqrt:  [[0.15]]
grads:  [0.25159374]
Stock Position:  0.2515937446870219
Bond Position:  [-17.78235235]


portfolio before change:  [8.68140308]
curr_Stock_Price:  105.19330834931016
curr_Factors:  [105.19330835]
mat_Sqrt:  [[0.15]]
grads:  [0.17304571]
Stock Position:  0.1730457057718802
Bond Position:  [-9.5218472]


portfolio before change:  [8.71635965]
curr_Stock_Price:  105.40219462228127
curr_Factors:  [105.40219462]
mat_Sqrt:  [[0.15]]
grads:  [-0.14939781]
Stock Position:  -0.14939781140255706
Bond Position:  [24.46321684]


portfolio before change:  [8.83133891]
curr_Stock_Price:  104.65304599718598
curr_Factors:  [104.653046]
mat_Sqrt:  [[0.15]]
grads:  [0.04129724]
Stock Position:  0.04129724123569106
Bond Position:  [4.50945682]


portfolio before change:  [8.87986524]
curr_Stock_Price:  105.81444602606888
curr_Factors:  [105.81444603]
mat_Sqrt:  [[0.15]]
grads:  [-0.08748169]
Stock Position:  -0.08748169218795064
Bond Position:  [18.13669204]


portfolio before change:  [8.89320638]
curr_Stock_Price:  105.68786062377569
curr_Factors:  [105.68786062]
mat_Sqrt:  [[0.15]]
grads:  [0.02055004]
Stock Position:  0.020550035081593546
Bond Position:  [6.72131713]


portfolio before change:  [8.90782975]
curr_Stock_Price:  106.35857245512999
curr_Factors:  [106.35857246]
mat_Sqrt:  [[0.15]]
grads:  [-0.04526698]
Stock Position:  -0.04526698162553215
Bond Position:  [13.72236129]


portfolio before change:  [8.89872527]
curr_Stock_Price:  106.5975961455995
curr_Factors:  [106.59759615]
mat_Sqrt:  [[0.15]]
grads:  [0.03037262]
Stock Position:  0.03037262076051176
Bond Position:  [5.66107691]


portfolio before change:  [8.89696725]
curr_Stock_Price:  106.51641474462707
curr_Factors:  [106.51641474]
mat_Sqrt:  [[0.15]]
grads:  [0.16347449]
Stock Position:  0.16347449492151034
Bond Position:  [-8.51574985]


portfolio before change:  [8.8206156]
curr_Stock_Price:  106.05587120707489
curr_Factors:  [106.05587121]
mat_Sqrt:  [[0.15]]
grads:  [0.03173767]
Stock Position:  0.031737666565731064
Bond Position:  [5.45464972]


portfolio before change:  [8.84551243]
curr_Stock_Price:  106.81884359484789
curr_Factors:  [106.81884359]
mat_Sqrt:  [[0.15]]
grads:  [0.12717672]
Stock Position:  0.1271767210904291
Bond Position:  [-4.73935785]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.84551243]
Stock Price:  107.02010837350363
PL:  [1.82540406]
Settle:  Tensor("sub_78:0", shape=(), dtype=float64)
PL:  Tensor("sub_79:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  40
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.84884062e-03]
 [-8.44720992e-03]
 [ 2.50428547e-03]
 [-3.70178003e-04]
 [ 5.50093692e-03]
 [ 2.55148593e-02]
 [ 2.69105515e-02]
 [-3.24559591e-03]
 [ 1.49937079e-02]
 [-6.58258737e-04]
 [-6.03585164e-03]
 [-7.54710949e-03]
 [ 1.18929013e-02]
 [ 4.92510072e-03]
 [ 2.28116098e-03]
 [-9.32726418e-03]
 [-3.43753770e-04]
 [-3.06031799e-03]
 [-7.45560596e-03]
 [-2.36097898e-03]
 [ 3.18283091e-04]
 [ 8.55378565e-03]
 [ 4.76680177e-03]
 [ 5.99829613e-03]
 [-3.46984632e-03]
 [-5.36836604e-03]
 [-3.52568841e-03]
 [-2.25799862e-02]
 [-3.63563662e-02]
 [ 2.17911256e-02]
 [ 9.33196670e-03]
 [-2.21351160e-03]
 [-1.25335136e-02]
 [-1.03642861e-02]
 [-8.75862681e-03]
 [-7.48173880e-03]
 [ 2.19400464e-02]
 [ 8.21524089e-03]
 [ 2.33549623e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.0815423]
curr_Stock_Price:  99.48323903695592
curr_Factors:  [99.48323904]
mat_Sqrt:  [[0.15]]
grads:  [-0.02565894]
Stock Position:  -0.025658937459223156
Bond Position:  [-3.5289081]


portfolio before change:  [-6.09448134]
curr_Stock_Price:  99.97031666420126
curr_Factors:  [99.97031666]
mat_Sqrt:  [[0.15]]
grads:  [-0.05631473]
Stock Position:  -0.05631473277416574
Bond Position:  [-0.46467967]


portfolio before change:  [-6.14075521]
curr_Stock_Price:  100.79098618035154
curr_Factors:  [100.79098618]
mat_Sqrt:  [[0.15]]
grads:  [0.01669524]
Stock Position:  0.016695236456091205
Bond Position:  [-7.82348456]


portfolio before change:  [-6.14879213]
curr_Stock_Price:  100.36817559565792
curr_Factors:  [100.3681756]
mat_Sqrt:  [[0.15]]
grads:  [-0.00246785]
Stock Position:  -0.0024678533543382015
Bond Position:  [-5.90109819]


portfolio before change:  [-6.14889662]
curr_Stock_Price:  100.11159668671031
curr_Factors:  [100.11159669]
mat_Sqrt:  [[0.15]]
grads:  [0.03667291]
Stock Position:  0.03667291280381712
Bond Position:  [-9.82028047]


portfolio before change:  [-6.12034883]
curr_Stock_Price:  100.9235146595178
curr_Factors:  [100.92351466]
mat_Sqrt:  [[0.15]]
grads:  [0.17009906]
Stock Position:  0.17009906230272845
Bond Position:  [-23.28734404]


portfolio before change:  [-6.31993336]
curr_Stock_Price:  99.76728586683612
curr_Factors:  [99.76728587]
mat_Sqrt:  [[0.15]]
grads:  [0.17940368]
Stock Position:  0.17940367668257612
Bond Position:  [-24.21855126]


portfolio before change:  [-6.42631693]
curr_Stock_Price:  99.19117697036297
curr_Factors:  [99.19117697]
mat_Sqrt:  [[0.15]]
grads:  [-0.02163731]
Stock Position:  -0.021637306062792048
Bond Position:  [-4.28008707]


portfolio before change:  [-6.41470047]
curr_Stock_Price:  98.62957728478726
curr_Factors:  [98.62957728]
mat_Sqrt:  [[0.15]]
grads:  [0.09995805]
Stock Position:  0.09995805238386692
Bond Position:  [-16.27352092]


portfolio before change:  [-6.43443715]
curr_Stock_Price:  98.45247932455062
curr_Factors:  [98.45247932]
mat_Sqrt:  [[0.15]]
grads:  [-0.00438839]
Stock Position:  -0.004388391582002509
Bond Position:  [-6.00238912]


portfolio before change:  [-6.43285832]
curr_Stock_Price:  97.92172140618615
curr_Factors:  [97.92172141]
mat_Sqrt:  [[0.15]]
grads:  [-0.04023901]
Stock Position:  -0.04023901093479165
Bond Position:  [-2.4925851]


portfolio before change:  [-6.40380328]
curr_Stock_Price:  97.19191624074803
curr_Factors:  [97.19191624]
mat_Sqrt:  [[0.15]]
grads:  [-0.05031406]
Stock Position:  -0.05031406329631111
Bond Position:  [-1.51368305]


portfolio before change:  [-6.35436576]
curr_Stock_Price:  96.20557690852885
curr_Factors:  [96.20557691]
mat_Sqrt:  [[0.15]]
grads:  [0.07928601]
Stock Position:  0.07928600863908959
Bond Position:  [-13.98212196]


portfolio before change:  [-6.33409397]
curr_Stock_Price:  96.48330137405858
curr_Factors:  [96.48330137]
mat_Sqrt:  [[0.15]]
grads:  [0.032834]
Stock Position:  0.03283400477838611
Bond Position:  [-9.50202715]


portfolio before change:  [-6.28905082]
curr_Stock_Price:  97.89132276068372
curr_Factors:  [97.89132276]
mat_Sqrt:  [[0.15]]
grads:  [0.01520774]
Stock Position:  0.015207739899502718
Bond Position:  [-7.77775659]


portfolio before change:  [-6.2765653]
curr_Stock_Price:  98.77625323570679
curr_Factors:  [98.77625324]
mat_Sqrt:  [[0.15]]
grads:  [-0.06218176]
Stock Position:  -0.06218176122539052
Bond Position:  [-0.13448391]


portfolio before change:  [-6.32497543]
curr_Stock_Price:  99.5545090735522
curr_Factors:  [99.55450907]
mat_Sqrt:  [[0.15]]
grads:  [-0.00229169]
Stock Position:  -0.0022916917983962525
Bond Position:  [-6.09682718]


portfolio before change:  [-6.32540747]
curr_Stock_Price:  99.41046167113318
curr_Factors:  [99.41046167]
mat_Sqrt:  [[0.15]]
grads:  [-0.02040212]
Stock Position:  -0.020402119907929974
Bond Position:  [-4.29722331]


portfolio before change:  [-6.31044605]
curr_Stock_Price:  98.6508047116848
curr_Factors:  [98.65080471]
mat_Sqrt:  [[0.15]]
grads:  [-0.04970404]
Stock Position:  -0.04970403973138072
Bond Position:  [-1.40710253]


portfolio before change:  [-6.33217081]
curr_Stock_Price:  99.08434817823994
curr_Factors:  [99.08434818]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573986]
Stock Position:  -0.015739859884113434
Bond Position:  [-4.77259705]


portfolio before change:  [-6.32581282]
curr_Stock_Price:  98.64250189270504
curr_Factors:  [98.64250189]
mat_Sqrt:  [[0.15]]
grads:  [0.00212189]
Stock Position:  0.002121887270608502
Bond Position:  [-6.53512109]


portfolio before change:  [-6.32618428]
curr_Stock_Price:  98.85245013554972
curr_Factors:  [98.85245014]
mat_Sqrt:  [[0.15]]
grads:  [0.05702524]
Stock Position:  0.0570252376499885
Bond Position:  [-11.96326874]


portfolio before change:  [-6.32282428]
curr_Stock_Price:  98.93759653616532
curr_Factors:  [98.93759654]
mat_Sqrt:  [[0.15]]
grads:  [0.03177868]
Stock Position:  0.03177867846579824
Bond Position:  [-9.46693035]


portfolio before change:  [-6.32055513]
curr_Stock_Price:  99.04624169142419
curr_Factors:  [99.04624169]
mat_Sqrt:  [[0.15]]
grads:  [0.03998864]
Stock Position:  0.03998864089790599
Bond Position:  [-10.28127972]


portfolio before change:  [-6.32723042]
curr_Stock_Price:  98.91145213978491
curr_Factors:  [98.91145214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313231]
Stock Position:  -0.023132308827334778
Bond Position:  [-4.03918016]


portfolio before change:  [-6.30510345]
curr_Stock_Price:  97.93308486180568
curr_Factors:  [97.93308486]
mat_Sqrt:  [[0.15]]
grads:  [-0.03578911]
Stock Position:  -0.035789106925859786
Bond Position:  [-2.80016581]


portfolio before change:  [-6.3160668]
curr_Stock_Price:  98.22963603537922
curr_Factors:  [98.22963604]
mat_Sqrt:  [[0.15]]
grads:  [-0.02350459]
Stock Position:  -0.023504589424734417
Bond Position:  [-4.00721953]


portfolio before change:  [-6.32149483]
curr_Stock_Price:  98.43925900741817
curr_Factors:  [98.43925901]
mat_Sqrt:  [[0.15]]
grads:  [-0.15053324]
Stock Position:  -0.15053324156257275
Bond Position:  [8.49688592]


portfolio before change:  [-6.31378988]
curr_Stock_Price:  98.39513069255376
curr_Factors:  [98.39513069]
mat_Sqrt:  [[0.15]]
grads:  [-0.24237577]
Stock Position:  -0.24237577455003168
Bond Position:  [17.53480614]


portfolio before change:  [-6.43946539]
curr_Stock_Price:  98.9226895976939
curr_Factors:  [98.9226896]
mat_Sqrt:  [[0.15]]
grads:  [0.14527417]
Stock Position:  0.14527417053022634
Bond Position:  [-20.81037706]


portfolio before change:  [-6.36619701]
curr_Stock_Price:  99.44494235944983
curr_Factors:  [99.44494236]
mat_Sqrt:  [[0.15]]
grads:  [0.06221311]
Stock Position:  0.06221311131332497
Bond Position:  [-12.55297628]


portfolio before change:  [-6.42703212]
curr_Stock_Price:  98.49231542818718
curr_Factors:  [98.49231543]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475674]
Stock Position:  -0.014756744019949652
Bond Position:  [-4.97360623]


portfolio before change:  [-6.41210918]
curr_Stock_Price:  97.43892059359574
curr_Factors:  [97.43892059]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355676]
Stock Position:  -0.08355675747377596
Bond Position:  [1.72957108]


portfolio before change:  [-6.40368012]
curr_Stock_Price:  97.34062991729506
curr_Factors:  [97.34062992]
mat_Sqrt:  [[0.15]]
grads:  [-0.06909524]
Stock Position:  -0.06909524061210275
Bond Position:  [0.32209413]


portfolio before change:  [-6.52639166]
curr_Stock_Price:  99.11718950008228
curr_Factors:  [99.1171895]
mat_Sqrt:  [[0.15]]
grads:  [-0.05839085]
Stock Position:  -0.05839084539069745
Bond Position:  [-0.73885518]


portfolio before change:  [-6.56367776]
curr_Stock_Price:  99.75416838308792
curr_Factors:  [99.75416838]
mat_Sqrt:  [[0.15]]
grads:  [-0.04987826]
Stock Position:  -0.04987825865626061
Bond Position:  [-1.58811355]


portfolio before change:  [-6.50105153]
curr_Stock_Price:  98.49460630455374
curr_Factors:  [98.4946063]
mat_Sqrt:  [[0.15]]
grads:  [0.14626698]
Stock Position:  0.14626697628626253
Bond Position:  [-20.90755977]


portfolio before change:  [-6.53488288]
curr_Stock_Price:  98.28117641700968
curr_Factors:  [98.28117642]
mat_Sqrt:  [[0.15]]
grads:  [0.05476827]
Stock Position:  0.05476827259765206
Bond Position:  [-11.91757314]


portfolio before change:  [-6.49601476]
curr_Stock_Price:  99.01806120341222
curr_Factors:  [99.0180612]
mat_Sqrt:  [[0.15]]
grads:  [0.15569975]
Stock Position:  0.15569974871786071
Bond Position:  [-21.91310201]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.49601476]
Stock Price:  97.84515724468085
PL:  [-6.49601476]
Settle:  Tensor("sub_80:0", shape=(), dtype=float64)
PL:  Tensor("sub_81:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  41
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44670421e-03]
 [-2.65262982e-04]
 [ 2.08512010e-02]
 [-9.84199597e-03]
 [ 1.45104587e-02]
 [ 2.16583224e-02]
 [ 1.33402491e-02]
 [-3.45263918e-03]
 [ 1.58945841e-02]
 [ 2.17981085e-03]
 [ 5.09562317e-03]
 [ 1.13065772e-02]
 [-1.09423348e-02]
 [ 1.09932533e-02]
 [-4.80198848e-03]
 [-2.43565513e-02]
 [ 1.03683259e-03]
 [-7.19467011e-04]
 [-1.09164062e-02]
 [-2.23171471e-03]
 [ 3.35609092e-04]
 [-4.93082502e-03]
 [ 4.78091759e-03]
 [ 6.05423201e-03]
 [-3.39122404e-03]
 [-7.08086771e-03]
 [-3.13459518e-03]
 [-2.35455655e-02]
 [-3.83887855e-02]
 [ 2.16740151e-02]
 [ 6.43074796e-03]
 [-2.90377054e-03]
 [-1.25334776e-02]
 [-5.59342463e-03]
 [-5.40109092e-03]
 [-6.61980303e-03]
 [ 2.26039136e-02]
 [ 8.25111013e-03]
 [ 2.25504948e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.40875177]
curr_Stock_Price:  100.15904550224657
curr_Factors:  [100.1590455]
mat_Sqrt:  [[0.15]]
grads:  [-0.00964469]
Stock Position:  -0.009644694736854031
Bond Position:  [5.37475519]


portfolio before change:  [4.41344642]
curr_Stock_Price:  99.74194943903652
curr_Factors:  [99.74194944]
mat_Sqrt:  [[0.15]]
grads:  [-0.00176842]
Stock Position:  -0.001768419877099229
Bond Position:  [4.58983207]


portfolio before change:  [4.4129559]
curr_Stock_Price:  100.34377599058739
curr_Factors:  [100.34377599]
mat_Sqrt:  [[0.15]]
grads:  [0.13900801]
Stock Position:  0.1390080069697394
Bond Position:  [-9.53563241]


portfolio before change:  [4.26788941]
curr_Stock_Price:  99.30876751296897
curr_Factors:  [99.30876751]
mat_Sqrt:  [[0.15]]
grads:  [-0.06561331]
Stock Position:  -0.06561330644708988
Bond Position:  [10.78386601]


portfolio before change:  [4.33620239]
curr_Stock_Price:  98.28816801431205
curr_Factors:  [98.28816801]
mat_Sqrt:  [[0.15]]
grads:  [0.09673639]
Stock Position:  0.09673639121256744
Bond Position:  [-5.17184029]


portfolio before change:  [4.38831776]
curr_Stock_Price:  98.833587361688
curr_Factors:  [98.83358736]
mat_Sqrt:  [[0.15]]
grads:  [0.14438882]
Stock Position:  0.1443888157752253
Bond Position:  [-9.88214687]


portfolio before change:  [4.3482613]
curr_Stock_Price:  98.56472218865619
curr_Factors:  [98.56472219]
mat_Sqrt:  [[0.15]]
grads:  [0.08893499]
Stock Position:  0.08893499403324008
Bond Position:  [-4.41759168]


portfolio before change:  [4.3557851]
curr_Stock_Price:  98.65553050999307
curr_Factors:  [98.65553051]
mat_Sqrt:  [[0.15]]
grads:  [-0.02301759]
Stock Position:  -0.023017594560301915
Bond Position:  [6.6265981]


portfolio before change:  [4.33415385]
curr_Stock_Price:  99.63128975240919
curr_Factors:  [99.63128975]
mat_Sqrt:  [[0.15]]
grads:  [0.10596389]
Stock Position:  0.10596389385925917
Bond Position:  [-6.22316557]


portfolio before change:  [4.40582897]
curr_Stock_Price:  100.3150422069091
curr_Factors:  [100.31504221]
mat_Sqrt:  [[0.15]]
grads:  [0.01453207]
Stock Position:  0.014532072317614605
Bond Position:  [2.94804353]


portfolio before change:  [4.40047248]
curr_Stock_Price:  99.92108480945912
curr_Factors:  [99.92108481]
mat_Sqrt:  [[0.15]]
grads:  [0.03397082]
Stock Position:  0.033970821117772595
Bond Position:  [1.00607119]


portfolio before change:  [4.41724081]
curr_Stock_Price:  100.41099220131211
curr_Factors:  [100.4109922]
mat_Sqrt:  [[0.15]]
grads:  [0.07537718]
Stock Position:  0.07537718105005423
Bond Position:  [-3.15145673]


portfolio before change:  [4.46892463]
curr_Stock_Price:  101.10188797241726
curr_Factors:  [101.10188797]
mat_Sqrt:  [[0.15]]
grads:  [-0.0729489]
Stock Position:  -0.07294889892436358
Bond Position:  [11.84419603]


portfolio before change:  [4.55961098]
curr_Stock_Price:  99.87903562125884
curr_Factors:  [99.87903562]
mat_Sqrt:  [[0.15]]
grads:  [0.07328836]
Stock Position:  0.07328835500431902
Bond Position:  [-2.76035924]


portfolio before change:  [4.56002791]
curr_Stock_Price:  99.88943287976393
curr_Factors:  [99.88943288]
mat_Sqrt:  [[0.15]]
grads:  [-0.03201326]
Stock Position:  -0.032013256534294335
Bond Position:  [7.75781395]


portfolio before change:  [4.53271178]
curr_Stock_Price:  100.77300174324301
curr_Factors:  [100.77300174]
mat_Sqrt:  [[0.15]]
grads:  [-0.16237701]
Stock Position:  -0.16237700897642257
Bond Position:  [20.89593039]


portfolio before change:  [4.69901024]
curr_Stock_Price:  99.76493840518971
curr_Factors:  [99.76493841]
mat_Sqrt:  [[0.15]]
grads:  [0.00691222]
Stock Position:  0.006912217294915172
Bond Position:  [4.00941331]


portfolio before change:  [4.70854107]
curr_Stock_Price:  101.07126583309916
curr_Factors:  [101.07126583]
mat_Sqrt:  [[0.15]]
grads:  [-0.00479645]
Stock Position:  -0.004796446739307154
Bond Position:  [5.19332401]


portfolio before change:  [4.70929891]
curr_Stock_Price:  101.04861619724471
curr_Factors:  [101.0486162]
mat_Sqrt:  [[0.15]]
grads:  [-0.07277604]
Stock Position:  -0.07277604164125313
Bond Position:  [12.06321721]


portfolio before change:  [4.712637]
curr_Stock_Price:  101.02346926817162
curr_Factors:  [101.02346927]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148781]
Stock Position:  -0.014878098051218081
Bond Position:  [6.21567409]


portfolio before change:  [4.71709531]
curr_Stock_Price:  100.7760384735491
curr_Factors:  [100.77603847]
mat_Sqrt:  [[0.15]]
grads:  [0.00223739]
Stock Position:  0.0022373939492659456
Bond Position:  [4.49161961]


portfolio before change:  [4.71874823]
curr_Stock_Price:  101.26385247582584
curr_Factors:  [101.26385248]
mat_Sqrt:  [[0.15]]
grads:  [-0.03287217]
Stock Position:  -0.03287216677195785
Bond Position:  [8.04751048]


portfolio before change:  [4.72349693]
curr_Stock_Price:  101.14999626285216
curr_Factors:  [101.14999626]
mat_Sqrt:  [[0.15]]
grads:  [0.03187278]
Stock Position:  0.03187278390241869
Bond Position:  [1.49956496]


portfolio before change:  [4.67250993]
curr_Stock_Price:  99.54441149347778
curr_Factors:  [99.54441149]
mat_Sqrt:  [[0.15]]
grads:  [0.04036155]
Stock Position:  0.04036154672057999
Bond Position:  [0.65474352]


portfolio before change:  [4.65928842]
curr_Stock_Price:  99.21480657779335
curr_Factors:  [99.21480658]
mat_Sqrt:  [[0.15]]
grads:  [-0.02260816]
Stock Position:  -0.02260816026134166
Bond Position:  [6.90235267]


portfolio before change:  [4.66531624]
curr_Stock_Price:  98.98635023378878
curr_Factors:  [98.98635023]
mat_Sqrt:  [[0.15]]
grads:  [-0.04720578]
Stock Position:  -0.0472057847642521
Bond Position:  [9.33804459]


portfolio before change:  [4.70031281]
curr_Stock_Price:  98.26971687730128
curr_Factors:  [98.26971688]
mat_Sqrt:  [[0.15]]
grads:  [-0.0208973]
Stock Position:  -0.02089730121393804
Bond Position:  [6.75388469]


portfolio before change:  [4.69290572]
curr_Stock_Price:  98.66457059255049
curr_Factors:  [98.66457059]
mat_Sqrt:  [[0.15]]
grads:  [-0.15697044]
Stock Position:  -0.156970436464129
Bond Position:  [20.18032643]


portfolio before change:  [4.69287813]
curr_Stock_Price:  98.68081752665782
curr_Factors:  [98.68081753]
mat_Sqrt:  [[0.15]]
grads:  [-0.25592524]
Stock Position:  -0.25592523665376643
Bond Position:  [29.94778971]


portfolio before change:  [4.55521944]
curr_Stock_Price:  99.23333203084971
curr_Factors:  [99.23333203]
mat_Sqrt:  [[0.15]]
grads:  [0.14449343]
Stock Position:  0.14449343390895344
Bond Position:  [-9.78334547]


portfolio before change:  [4.4879832]
curr_Stock_Price:  98.77647223968947
curr_Factors:  [98.77647224]
mat_Sqrt:  [[0.15]]
grads:  [0.04287165]
Stock Position:  0.042871653035428926
Bond Position:  [0.25327256]


portfolio before change:  [4.46266181]
curr_Stock_Price:  98.18510129580675
curr_Factors:  [98.1851013]
mat_Sqrt:  [[0.15]]
grads:  [-0.01935847]
Stock Position:  -0.01935847028103494
Bond Position:  [6.36337518]


portfolio before change:  [4.45041459]
curr_Stock_Price:  98.85884746800056
curr_Factors:  [98.85884747]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355652]
Stock Position:  -0.08355651764580867
Bond Position:  [12.71071562]


portfolio before change:  [4.34116165]
curr_Stock_Price:  100.18539716657634
curr_Factors:  [100.18539717]
mat_Sqrt:  [[0.15]]
grads:  [-0.0372895]
Stock Position:  -0.03728949750031517
Bond Position:  [8.07702477]


portfolio before change:  [4.30456186]
curr_Stock_Price:  101.1939784054182
curr_Factors:  [101.19397841]
mat_Sqrt:  [[0.15]]
grads:  [-0.03600727]
Stock Position:  -0.03600727283165898
Bond Position:  [7.94828105]


portfolio before change:  [4.30909454]
curr_Stock_Price:  101.09569047728488
curr_Factors:  [101.09569048]
mat_Sqrt:  [[0.15]]
grads:  [-0.04413202]
Stock Position:  -0.044132020226155096
Bond Position:  [8.77065159]


portfolio before change:  [4.37609034]
curr_Stock_Price:  99.60245703244782
curr_Factors:  [99.60245703]
mat_Sqrt:  [[0.15]]
grads:  [0.15069276]
Stock Position:  0.1506927573490274
Bond Position:  [-10.63327855]


portfolio before change:  [4.16716409]
curr_Stock_Price:  98.22483933139463
curr_Factors:  [98.22483933]
mat_Sqrt:  [[0.15]]
grads:  [0.0550074]
Stock Position:  0.05500740084079051
Bond Position:  [-1.23592902]


portfolio before change:  [4.13857074]
curr_Stock_Price:  97.70783896352914
curr_Factors:  [97.70783896]
mat_Sqrt:  [[0.15]]
grads:  [0.15033663]
Stock Position:  0.15033663174740958
Bond Position:  [-10.55049666]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.13857074]
Stock Price:  96.61840418983259
PL:  [4.13857074]
Settle:  Tensor("sub_82:0", shape=(), dtype=float64)
PL:  Tensor("sub_83:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  42
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51559756e-03]
 [-6.18151442e-03]
 [ 1.35183893e-02]
 [-1.62043308e-02]
 [ 1.47596370e-02]
 [ 2.39139787e-02]
 [ 1.04861088e-02]
 [-3.26012368e-03]
 [ 1.54162455e-02]
 [-3.68950580e-03]
 [ 1.27975017e-02]
 [-2.08503424e-03]
 [ 3.84940042e-03]
 [ 9.73493455e-03]
 [-4.24901213e-03]
 [-1.55266282e-02]
 [ 1.17897047e-03]
 [-3.11582495e-03]
 [-1.11954532e-02]
 [-2.26493701e-03]
 [ 3.18962662e-04]
 [ 8.64800514e-03]
 [ 4.76694820e-03]
 [ 5.89010179e-03]
 [-4.06465209e-03]
 [-7.55026055e-03]
 [ 1.44987520e-02]
 [-1.98838815e-02]
 [-2.11407361e-02]
 [ 2.17636551e-02]
 [ 4.30968125e-03]
 [-3.45051898e-03]
 [-1.24520432e-02]
 [-8.82663387e-03]
 [-6.41416512e-03]
 [-4.24242525e-03]
 [ 1.90056342e-02]
 [ 9.38123852e-03]
 [ 1.98761995e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.750592]
curr_Stock_Price:  100.309911699009
curr_Factors:  [100.3099117]
mat_Sqrt:  [[0.15]]
grads:  [-0.01010398]
Stock Position:  -0.010103983757823898
Bond Position:  [7.76412172]


portfolio before change:  [6.75563578]
curr_Stock_Price:  99.90678378968215
curr_Factors:  [99.90678379]
mat_Sqrt:  [[0.15]]
grads:  [-0.0412101]
Stock Position:  -0.04121009613851491
Bond Position:  [10.87280394]


portfolio before change:  [6.76233304]
curr_Stock_Price:  99.77725052075878
curr_Factors:  [99.77725052]
mat_Sqrt:  [[0.15]]
grads:  [0.0901226]
Stock Position:  0.0901225954341649
Bond Position:  [-2.22985174]


portfolio before change:  [6.68247855]
curr_Stock_Price:  98.89427838943395
curr_Factors:  [98.89427839]
mat_Sqrt:  [[0.15]]
grads:  [-0.10802887]
Stock Position:  -0.10802887183733795
Bond Position:  [17.36591588]


portfolio before change:  [6.72258649]
curr_Stock_Price:  98.54310314509335
curr_Factors:  [98.54310315]
mat_Sqrt:  [[0.15]]
grads:  [0.09839758]
Stock Position:  0.0983975797823619
Bond Position:  [-2.97381636]


portfolio before change:  [6.65117876]
curr_Stock_Price:  97.82117499007582
curr_Factors:  [97.82117499]
mat_Sqrt:  [[0.15]]
grads:  [0.15942652]
Stock Position:  0.15942652493707518
Bond Position:  [-8.94411123]


portfolio before change:  [6.7355027]
curr_Stock_Price:  98.35710851391055
curr_Factors:  [98.35710851]
mat_Sqrt:  [[0.15]]
grads:  [0.06990739]
Stock Position:  0.06990739221520202
Bond Position:  [-0.14038627]


portfolio before change:  [6.79225403]
curr_Stock_Price:  99.1691669240737
curr_Factors:  [99.16916692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02173416]
Stock Position:  -0.02173415784681499
Bond Position:  [8.94761236]


portfolio before change:  [6.80354923]
curr_Stock_Price:  98.7009325971417
curr_Factors:  [98.7009326]
mat_Sqrt:  [[0.15]]
grads:  [0.10277497]
Stock Position:  0.1027749702349356
Bond Position:  [-3.34043618]


portfolio before change:  [6.860671]
curr_Stock_Price:  99.26079018543368
curr_Factors:  [99.26079019]
mat_Sqrt:  [[0.15]]
grads:  [-0.02459671]
Stock Position:  -0.024596705328966354
Bond Position:  [9.30215941]


portfolio before change:  [6.88135132]
curr_Stock_Price:  98.46729037943507
curr_Factors:  [98.46729038]
mat_Sqrt:  [[0.15]]
grads:  [0.08531668]
Stock Position:  0.08531667798131122
Bond Position:  [-1.51955078]


portfolio before change:  [6.83891721]
curr_Stock_Price:  97.97214500378864
curr_Factors:  [97.972145]
mat_Sqrt:  [[0.15]]
grads:  [-0.01390023]
Stock Position:  -0.01390022825580153
Bond Position:  [8.20075239]


portfolio before change:  [6.83245061]
curr_Stock_Price:  98.51111158914608
curr_Factors:  [98.51111159]
mat_Sqrt:  [[0.15]]
grads:  [0.02566267]
Stock Position:  0.025662669443798376
Bond Position:  [4.30439251]


portfolio before change:  [6.85828817]
curr_Stock_Price:  99.49695926903406
curr_Factors:  [99.49695927]
mat_Sqrt:  [[0.15]]
grads:  [0.06489956]
Stock Position:  0.06489956366558364
Bond Position:  [0.40097893]


portfolio before change:  [6.86531214]
curr_Stock_Price:  99.60441521332056
curr_Factors:  [99.60441521]
mat_Sqrt:  [[0.15]]
grads:  [-0.02832675]
Stock Position:  -0.028326747536127468
Bond Position:  [9.68678127]


portfolio before change:  [6.85542473]
curr_Stock_Price:  99.9962121687887
curr_Factors:  [99.99621217]
mat_Sqrt:  [[0.15]]
grads:  [-0.10351085]
Stock Position:  -0.10351085478678897
Bond Position:  [17.20611813]


portfolio before change:  [6.87944411]
curr_Stock_Price:  99.78494468224774
curr_Factors:  [99.78494468]
mat_Sqrt:  [[0.15]]
grads:  [0.0078598]
Stock Position:  0.007859803108540417
Bond Position:  [6.09515409]


portfolio before change:  [6.87227644]
curr_Stock_Price:  98.77606287428526
curr_Factors:  [98.77606287]
mat_Sqrt:  [[0.15]]
grads:  [-0.02077217]
Stock Position:  -0.020772166333660025
Bond Position:  [8.92406925]


portfolio before change:  [6.8455288]
curr_Stock_Price:  100.11743579173489
curr_Factors:  [100.11743579]
mat_Sqrt:  [[0.15]]
grads:  [-0.07463635]
Stock Position:  -0.07463635474305078
Bond Position:  [14.31792925]


portfolio before change:  [6.87048932]
curr_Stock_Price:  99.80698824587958
curr_Factors:  [99.80698825]
mat_Sqrt:  [[0.15]]
grads:  [-0.01509958]
Stock Position:  -0.015099580050320697
Bond Position:  [8.37753293]


portfolio before change:  [6.87741509]
curr_Stock_Price:  99.41767226768819
curr_Factors:  [99.41767227]
mat_Sqrt:  [[0.15]]
grads:  [0.00212642]
Stock Position:  0.002126417745556729
Bond Position:  [6.66601158]


portfolio before change:  [6.8764038]
curr_Stock_Price:  98.55020838187221
curr_Factors:  [98.55020838]
mat_Sqrt:  [[0.15]]
grads:  [0.05765337]
Stock Position:  0.05765336759624931
Bond Position:  [1.19465241]


portfolio before change:  [6.88608464]
curr_Stock_Price:  98.7155326700236
curr_Factors:  [98.71553267]
mat_Sqrt:  [[0.15]]
grads:  [0.03177965]
Stock Position:  0.03177965466061107
Bond Position:  [3.74893911]


portfolio before change:  [6.88952384]
curr_Stock_Price:  98.80900604114149
curr_Factors:  [98.80900604]
mat_Sqrt:  [[0.15]]
grads:  [0.03926735]
Stock Position:  0.03926734528996791
Bond Position:  [3.00955648]


portfolio before change:  [6.93254155]
curr_Stock_Price:  99.89493359584552
curr_Factors:  [99.8949336]
mat_Sqrt:  [[0.15]]
grads:  [-0.02709768]
Stock Position:  -0.027097680599838688
Bond Position:  [9.63946256]


portfolio before change:  [6.94911128]
curr_Stock_Price:  99.32792118872064
curr_Factors:  [99.32792119]
mat_Sqrt:  [[0.15]]
grads:  [-0.05033507]
Stock Position:  -0.0503350703357699
Bond Position:  [11.94878918]


portfolio before change:  [6.93003284]
curr_Stock_Price:  99.73662503979644
curr_Factors:  [99.73662504]
mat_Sqrt:  [[0.15]]
grads:  [0.09665835]
Stock Position:  0.09665834680523612
Bond Position:  [-2.71034446]


portfolio before change:  [7.00347991]
curr_Stock_Price:  100.49999306460597
curr_Factors:  [100.49999306]
mat_Sqrt:  [[0.15]]
grads:  [-0.13255921]
Stock Position:  -0.13255921018628283
Bond Position:  [20.32567962]


portfolio before change:  [7.06932177]
curr_Stock_Price:  100.02246318245841
curr_Factors:  [100.02246318]
mat_Sqrt:  [[0.15]]
grads:  [-0.14093824]
Stock Position:  -0.1409382407858195
Bond Position:  [21.16631177]


portfolio before change:  [7.21669813]
curr_Stock_Price:  98.99555658501448
curr_Factors:  [98.99555659]
mat_Sqrt:  [[0.15]]
grads:  [0.14509103]
Stock Position:  0.14509103416696437
Bond Position:  [-7.14666955]


portfolio before change:  [7.10699331]
curr_Stock_Price:  98.24560380157006
curr_Factors:  [98.2456038]
mat_Sqrt:  [[0.15]]
grads:  [0.02873121]
Stock Position:  0.028731208337945936
Bond Position:  [4.2842784]


portfolio before change:  [7.09879907]
curr_Stock_Price:  97.9417595034788
curr_Factors:  [97.9417595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02300346]
Stock Position:  -0.023003459876722695
Bond Position:  [9.3517984]


portfolio before change:  [7.14523734]
curr_Stock_Price:  95.9738282466001
curr_Factors:  [95.97382825]
mat_Sqrt:  [[0.15]]
grads:  [-0.08301362]
Stock Position:  -0.08301362139506424
Bond Position:  [15.11237239]


portfolio before change:  [7.1735166]
curr_Stock_Price:  95.65592752641889
curr_Factors:  [95.65592753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05884423]
Stock Position:  -0.05884422580004912
Bond Position:  [12.8023156]


portfolio before change:  [7.20897215]
curr_Stock_Price:  95.08059227390716
curr_Factors:  [95.08059227]
mat_Sqrt:  [[0.15]]
grads:  [-0.0427611]
Stock Position:  -0.042761100800265614
Bond Position:  [11.27472294]


portfolio before change:  [7.20618062]
curr_Stock_Price:  95.17883468387134
curr_Factors:  [95.17883468]
mat_Sqrt:  [[0.15]]
grads:  [-0.02828283]
Stock Position:  -0.028282834991403175
Bond Position:  [9.8981079]


portfolio before change:  [7.20252241]
curr_Stock_Price:  95.35192742409814
curr_Factors:  [95.35192742]
mat_Sqrt:  [[0.15]]
grads:  [0.12670423]
Stock Position:  0.12670422804307244
Bond Position:  [-4.87896995]


portfolio before change:  [7.26464395]
curr_Stock_Price:  95.84702892958592
curr_Factors:  [95.84702893]
mat_Sqrt:  [[0.15]]
grads:  [0.06254159]
Stock Position:  0.06254159011291781
Bond Position:  [1.27021836]


portfolio before change:  [7.23767873]
curr_Stock_Price:  95.41333332900562
curr_Factors:  [95.41333333]
mat_Sqrt:  [[0.15]]
grads:  [0.132508]
Stock Position:  0.13250799684711112
Bond Position:  [-5.40535094]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.23767873]
Stock Price:  96.08543053524342
PL:  [7.23767873]
Settle:  Tensor("sub_84:0", shape=(), dtype=float64)
PL:  Tensor("sub_85:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  43
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.48013855e-03]
 [-4.42174136e-03]
 [ 3.88277644e-04]
 [ 1.02932807e-01]
 [-6.16834679e-02]
 [ 3.97576398e-02]
 [-1.51976174e-03]
 [ 1.34923473e-03]
 [ 1.01945680e-02]
 [ 1.23732703e-02]
 [ 2.69636563e-02]
 [-3.95351212e-03]
 [-1.24937373e-02]
 [ 7.86945847e-03]
 [ 4.01121312e-04]
 [-2.86356024e-02]
 [ 4.98385300e-03]
 [-1.81466983e-03]
 [ 1.54774891e-03]
 [-3.17282727e-03]
 [-1.44992462e-03]
 [-3.18688120e-02]
 [ 4.79596031e-03]
 [ 8.62239899e-03]
 [-4.62102536e-03]
 [-7.82528460e-03]
 [ 8.68948151e-03]
 [-1.99544450e-02]
 [-1.68586593e-02]
 [ 2.15392626e-02]
 [ 9.21365548e-03]
 [ 1.54691224e-03]
 [-1.25300559e-02]
 [-1.02352517e-02]
 [-6.60533909e-03]
 [-5.19849732e-03]
 [ 1.94731722e-02]
 [ 9.98009559e-03]
 [ 1.90111195e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.02466222]
curr_Stock_Price:  100.06987958743365
curr_Factors:  [100.06987959]
mat_Sqrt:  [[0.15]]
grads:  [-0.00986759]
Stock Position:  -0.009867590322658631
Bond Position:  [4.01211079]


portfolio before change:  [3.01363984]
curr_Stock_Price:  101.2377358593033
curr_Factors:  [101.23773586]
mat_Sqrt:  [[0.15]]
grads:  [-0.02947828]
Stock Position:  -0.029478275704664353
Bond Position:  [5.99795373]


portfolio before change:  [2.97742647]
curr_Stock_Price:  102.49164751104247
curr_Factors:  [102.49164751]
mat_Sqrt:  [[0.15]]
grads:  [0.00258852]
Stock Position:  0.002588517627599221
Bond Position:  [2.71212504]


portfolio before change:  [2.98132512]
curr_Stock_Price:  103.86680078977913
curr_Factors:  [103.86680079]
mat_Sqrt:  [[0.15]]
grads:  [0.68621871]
Stock Position:  0.6862187145233329
Bond Position:  [-68.2940174]


portfolio before change:  [3.23761201]
curr_Stock_Price:  104.2527188196947
curr_Factors:  [104.25271882]
mat_Sqrt:  [[0.15]]
grads:  [-0.41122312]
Stock Position:  -0.4112231193231377
Bond Position:  [46.10874024]


portfolio before change:  [3.50415458]
curr_Stock_Price:  103.61856523223796
curr_Factors:  [103.61856523]
mat_Sqrt:  [[0.15]]
grads:  [0.26505093]
Stock Position:  0.265050931762493
Bond Position:  [-23.96004268]


portfolio before change:  [3.64536323]
curr_Stock_Price:  104.16262610508686
curr_Factors:  [104.16262611]
mat_Sqrt:  [[0.15]]
grads:  [-0.01013174]
Stock Position:  -0.010131744935634075
Bond Position:  [4.70071239]


portfolio before change:  [3.65750168]
curr_Stock_Price:  103.022563333475
curr_Factors:  [103.02256333]
mat_Sqrt:  [[0.15]]
grads:  [0.0089949]
Stock Position:  0.008994898221207557
Bond Position:  [2.73082421]


portfolio before change:  [3.65568064]
curr_Stock_Price:  102.7821588900514
curr_Factors:  [102.78215889]
mat_Sqrt:  [[0.15]]
grads:  [0.06796379]
Stock Position:  0.06796378656320035
Bond Position:  [-3.32978407]


portfolio before change:  [3.65701662]
curr_Stock_Price:  102.80794078545424
curr_Factors:  [102.80794079]
mat_Sqrt:  [[0.15]]
grads:  [0.08248847]
Stock Position:  0.08248846892043571
Bond Position:  [-4.823453]


portfolio before change:  [3.58440961]
curr_Stock_Price:  101.93504250607708
curr_Factors:  [101.93504251]
mat_Sqrt:  [[0.15]]
grads:  [0.17975771]
Stock Position:  0.17975770870488486
Bond Position:  [-14.73920006]


portfolio before change:  [3.80560518]
curr_Stock_Price:  103.17581314381607
curr_Factors:  [103.17581314]
mat_Sqrt:  [[0.15]]
grads:  [-0.02635675]
Stock Position:  -0.026356747446653433
Bond Position:  [6.52498403]


portfolio before change:  [3.79749458]
curr_Stock_Price:  103.51448480153593
curr_Factors:  [103.5144848]
mat_Sqrt:  [[0.15]]
grads:  [-0.08329158]
Stock Position:  -0.08329158212282739
Bond Position:  [12.41937979]


portfolio before change:  [3.8413298]
curr_Stock_Price:  103.0068379800429
curr_Factors:  [103.00683798]
mat_Sqrt:  [[0.15]]
grads:  [0.05246306]
Stock Position:  0.05246305646600358
Bond Position:  [-1.56272376]


portfolio before change:  [3.87043781]
curr_Stock_Price:  103.56539030262606
curr_Factors:  [103.5653903]
mat_Sqrt:  [[0.15]]
grads:  [0.00267414]
Stock Position:  0.002674142082088269
Bond Position:  [3.59348924]


portfolio before change:  [3.87088976]
curr_Stock_Price:  103.56641285924839
curr_Factors:  [103.56641286]
mat_Sqrt:  [[0.15]]
grads:  [-0.19090402]
Stock Position:  -0.19090401577790653
Bond Position:  [23.64213387]


portfolio before change:  [3.91207952]
curr_Stock_Price:  103.36613260355423
curr_Factors:  [103.3661326]
mat_Sqrt:  [[0.15]]
grads:  [0.03322569]
Stock Position:  0.033225686681699146
Bond Position:  [0.47766878]


portfolio before change:  [3.90240254]
curr_Stock_Price:  103.07308566837041
curr_Factors:  [103.07308567]
mat_Sqrt:  [[0.15]]
grads:  [-0.0120978]
Stock Position:  -0.01209779887306088
Bond Position:  [5.14936]


portfolio before change:  [3.89748711]
curr_Stock_Price:  103.53260230874562
curr_Factors:  [103.53260231]
mat_Sqrt:  [[0.15]]
grads:  [0.01031833]
Stock Position:  0.010318326055235664
Bond Position:  [2.82920397]


portfolio before change:  [3.90088005]
curr_Stock_Price:  103.82715224377532
curr_Factors:  [103.82715224]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115218]
Stock Position:  -0.021152181810884147
Bond Position:  [6.09705085]


portfolio before change:  [3.90659213]
curr_Stock_Price:  103.59313841902359
curr_Factors:  [103.59313842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966616]
Stock Position:  -0.009666164156081828
Bond Position:  [4.90794041]


portfolio before change:  [3.91406274]
curr_Stock_Price:  102.88374889015996
curr_Factors:  [102.88374889]
mat_Sqrt:  [[0.15]]
grads:  [-0.21245875]
Stock Position:  -0.21245874639789744
Bond Position:  [25.77261505]


portfolio before change:  [3.97077248]
curr_Stock_Price:  102.63199195452738
curr_Factors:  [102.63199195]
mat_Sqrt:  [[0.15]]
grads:  [0.03197307]
Stock Position:  0.03197306871441979
Bond Position:  [0.68931275]


portfolio before change:  [3.97744912]
curr_Stock_Price:  102.83811783012615
curr_Factors:  [102.83811783]
mat_Sqrt:  [[0.15]]
grads:  [0.05748266]
Stock Position:  0.057482659917119434
Bond Position:  [-1.93395943]


portfolio before change:  [3.94254626]
curr_Stock_Price:  102.23513413340012
curr_Factors:  [102.23513413]
mat_Sqrt:  [[0.15]]
grads:  [-0.03080684]
Stock Position:  -0.030806835738939314
Bond Position:  [7.09208724]


portfolio before change:  [3.97382762]
curr_Stock_Price:  101.24850892722954
curr_Factors:  [101.24850893]
mat_Sqrt:  [[0.15]]
grads:  [-0.05216856]
Stock Position:  -0.052168563990497414
Bond Position:  [9.25581694]


portfolio before change:  [3.99544887]
curr_Stock_Price:  100.85623827047684
curr_Factors:  [100.85623827]
mat_Sqrt:  [[0.15]]
grads:  [0.05792988]
Stock Position:  0.057929876732870464
Bond Position:  [-1.84714058]


portfolio before change:  [3.96962734]
curr_Stock_Price:  100.41448648484757
curr_Factors:  [100.41448648]
mat_Sqrt:  [[0.15]]
grads:  [-0.13302963]
Stock Position:  -0.13302963316872748
Bond Position:  [17.32772964]


portfolio before change:  [4.00009892]
curr_Stock_Price:  100.20171076156788
curr_Factors:  [100.20171076]
mat_Sqrt:  [[0.15]]
grads:  [-0.11239106]
Stock Position:  -0.11239106192588491
Bond Position:  [15.26187559]


portfolio before change:  [4.03206785]
curr_Stock_Price:  99.93424217224714
curr_Factors:  [99.93424217]
mat_Sqrt:  [[0.15]]
grads:  [0.14359508]
Stock Position:  0.14359508419332892
Bond Position:  [-10.31799807]


portfolio before change:  [4.0145018]
curr_Stock_Price:  99.82089414379581
curr_Factors:  [99.82089414]
mat_Sqrt:  [[0.15]]
grads:  [0.06142437]
Stock Position:  0.061424369885105724
Bond Position:  [-2.11693373]


portfolio before change:  [4.02122462]
curr_Stock_Price:  99.93465119943892
curr_Factors:  [99.9346512]
mat_Sqrt:  [[0.15]]
grads:  [0.01031275]
Stock Position:  0.010312748257984722
Bond Position:  [2.99062372]


portfolio before change:  [4.01606386]
curr_Stock_Price:  99.39797477024665
curr_Factors:  [99.39797477]
mat_Sqrt:  [[0.15]]
grads:  [-0.08353371]
Stock Position:  -0.08353370599932158
Bond Position:  [12.31914506]


portfolio before change:  [4.22841943]
curr_Stock_Price:  96.87425601798611
curr_Factors:  [96.87425602]
mat_Sqrt:  [[0.15]]
grads:  [-0.06823501]
Stock Position:  -0.06823501130082517
Bond Position:  [10.83863539]


portfolio before change:  [4.26952768]
curr_Stock_Price:  96.29166167885592
curr_Factors:  [96.29166168]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403559]
Stock Position:  -0.044035593950377865
Bond Position:  [8.50978819]


portfolio before change:  [4.28370526]
curr_Stock_Price:  95.9938618762919
curr_Factors:  [95.99386188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03465665]
Stock Position:  -0.03465664881097778
Bond Position:  [7.61053082]


portfolio before change:  [4.28840612]
curr_Stock_Price:  95.8856722571086
curr_Factors:  [95.88567226]
mat_Sqrt:  [[0.15]]
grads:  [0.12982115]
Stock Position:  0.1298211480476049
Bond Position:  [-8.15958193]


portfolio before change:  [4.19700462]
curr_Stock_Price:  95.18947216758919
curr_Factors:  [95.18947217]
mat_Sqrt:  [[0.15]]
grads:  [0.06653397]
Stock Position:  0.06653397061138204
Bond Position:  [-2.13632893]


portfolio before change:  [4.16873398]
curr_Stock_Price:  94.76858072952005
curr_Factors:  [94.76858073]
mat_Sqrt:  [[0.15]]
grads:  [0.1267408]
Stock Position:  0.1267407964793604
Bond Position:  [-7.84231142]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.16873398]
Stock Price:  95.76581371544012
PL:  [4.16873398]
Settle:  Tensor("sub_86:0", shape=(), dtype=float64)
PL:  Tensor("sub_87:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  44
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.95970132e-03]
 [-3.73806455e-04]
 [-1.48241645e-02]
 [-6.58621993e-03]
 [ 8.57613608e-03]
 [ 1.72118447e-02]
 [ 2.10876228e-02]
 [-2.97206425e-03]
 [ 6.89580976e-03]
 [ 8.70719071e-03]
 [ 1.47352686e-02]
 [ 8.37576510e-03]
 [-9.94311317e-03]
 [ 1.17238250e-02]
 [-6.42446884e-03]
 [-2.72663961e-02]
 [ 3.86966138e-03]
 [ 5.41056332e-04]
 [ 5.52866230e-03]
 [-3.23184904e-03]
 [-1.87634532e-03]
 [-3.56368694e-02]
 [ 4.81737448e-03]
 [ 1.03816406e-02]
 [-5.56018140e-03]
 [ 6.84550592e-03]
 [-1.17556013e-02]
 [ 4.29720886e-03]
 [ 3.99520834e-02]
 [ 2.62667627e-02]
 [-2.23140634e-02]
 [ 6.17399512e-03]
 [-1.30217602e-02]
 [ 3.03521559e-03]
 [-6.31862735e-03]
 [ 1.30949063e-03]
 [ 2.41597095e-02]
 [ 4.75187998e-03]
 [ 2.01382425e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.18691544]
curr_Stock_Price:  99.28318446955528
curr_Factors:  [99.28318447]
mat_Sqrt:  [[0.15]]
grads:  [-0.03306468]
Stock Position:  -0.03306467548447985
Bond Position:  [-5.90414917]


portfolio before change:  [-9.18197555]
curr_Stock_Price:  99.11146174601987
curr_Factors:  [99.11146175]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249204]
Stock Position:  -0.002492043034985619
Bond Position:  [-8.93498552]


portfolio before change:  [-9.18301771]
curr_Stock_Price:  99.081454893558
curr_Factors:  [99.08145489]
mat_Sqrt:  [[0.15]]
grads:  [-0.09882776]
Stock Position:  -0.09882776342260961
Bond Position:  [0.60898087]


portfolio before change:  [-9.23143782]
curr_Stock_Price:  99.57216952532427
curr_Factors:  [99.57216953]
mat_Sqrt:  [[0.15]]
grads:  [-0.04390813]
Stock Position:  -0.04390813284985415
Bond Position:  [-4.85940977]


portfolio before change:  [-9.26671626]
curr_Stock_Price:  100.3617949355755
curr_Factors:  [100.36179494]
mat_Sqrt:  [[0.15]]
grads:  [0.05717424]
Stock Position:  0.057174240540148795
Bond Position:  [-15.00482566]


portfolio before change:  [-9.27154723]
curr_Stock_Price:  100.31010647775454
curr_Factors:  [100.31010648]
mat_Sqrt:  [[0.15]]
grads:  [0.11474563]
Stock Position:  0.11474563133902563
Bond Position:  [-20.78169372]


portfolio before change:  [-9.38863941]
curr_Stock_Price:  99.3122967213662
curr_Factors:  [99.31229672]
mat_Sqrt:  [[0.15]]
grads:  [0.14058415]
Stock Position:  0.14058415175504335
Bond Position:  [-23.3503744]


portfolio before change:  [-9.3598567]
curr_Stock_Price:  99.53779647092063
curr_Factors:  [99.53779647]
mat_Sqrt:  [[0.15]]
grads:  [-0.01981376]
Stock Position:  -0.019813761683902514
Bond Position:  [-7.38763852]


portfolio before change:  [-9.37557093]
curr_Stock_Price:  100.28428341281072
curr_Factors:  [100.28428341]
mat_Sqrt:  [[0.15]]
grads:  [0.04597207]
Stock Position:  0.04597206509234618
Bond Position:  [-13.98584653]


portfolio before change:  [-9.34315853]
curr_Stock_Price:  101.02735938301683
curr_Factors:  [101.02735938]
mat_Sqrt:  [[0.15]]
grads:  [0.05804794]
Stock Position:  0.058047938038350615
Bond Position:  [-15.20758843]


portfolio before change:  [-9.36910081]
curr_Stock_Price:  100.61319799591446
curr_Factors:  [100.613198]
mat_Sqrt:  [[0.15]]
grads:  [0.09823512]
Stock Position:  0.09823512369199752
Bond Position:  [-19.25285076]


portfolio before change:  [-9.25189998]
curr_Stock_Price:  101.83076238723507
curr_Factors:  [101.83076239]
mat_Sqrt:  [[0.15]]
grads:  [0.05583843]
Stock Position:  0.05583843401458881
Bond Position:  [-14.93797029]


portfolio before change:  [-9.31687541]
curr_Stock_Price:  100.70057194404968
curr_Factors:  [100.70057194]
mat_Sqrt:  [[0.15]]
grads:  [-0.06628742]
Stock Position:  -0.06628742113982648
Bond Position:  [-2.64169419]


portfolio before change:  [-9.35382266]
curr_Stock_Price:  101.25296973154884
curr_Factors:  [101.25296973]
mat_Sqrt:  [[0.15]]
grads:  [0.07815883]
Stock Position:  0.0781588332497627
Bond Position:  [-17.26763664]


portfolio before change:  [-9.40694077]
curr_Stock_Price:  100.60097028131511
curr_Factors:  [100.60097028]
mat_Sqrt:  [[0.15]]
grads:  [-0.04282979]
Stock Position:  -0.042829792239068
Bond Position:  [-5.09822211]


portfolio before change:  [-9.46217719]
curr_Stock_Price:  101.87576285844806
curr_Factors:  [101.87576286]
mat_Sqrt:  [[0.15]]
grads:  [-0.18177597]
Stock Position:  -0.18177597429872536
Bond Position:  [9.05638886]


portfolio before change:  [-9.49969762]
curr_Stock_Price:  102.08840122327628
curr_Factors:  [102.08840122]
mat_Sqrt:  [[0.15]]
grads:  [0.02579774]
Stock Position:  0.0257977425087041
Bond Position:  [-12.1333479]


portfolio before change:  [-9.49018727]
curr_Stock_Price:  102.51584611179622
curr_Factors:  [102.51584611]
mat_Sqrt:  [[0.15]]
grads:  [0.00360704]
Stock Position:  0.0036070422103684774
Bond Position:  [-9.85996625]


portfolio before change:  [-9.48456662]
curr_Stock_Price:  104.41580119595945
curr_Factors:  [104.4158012]
mat_Sqrt:  [[0.15]]
grads:  [0.03685775]
Stock Position:  0.03685774869140111
Bond Position:  [-13.33309798]


portfolio before change:  [-9.50335277]
curr_Stock_Price:  103.95132868623482
curr_Factors:  [103.95132869]
mat_Sqrt:  [[0.15]]
grads:  [-0.02154566]
Stock Position:  -0.021545660290144795
Bond Position:  [-7.26365276]


portfolio before change:  [-9.51561129]
curr_Stock_Price:  104.47814048018952
curr_Factors:  [104.47814048]
mat_Sqrt:  [[0.15]]
grads:  [-0.01250897]
Stock Position:  -0.012508968819605486
Bond Position:  [-8.20869749]


portfolio before change:  [-9.50406185]
curr_Stock_Price:  103.4728140258598
curr_Factors:  [103.47281403]
mat_Sqrt:  [[0.15]]
grads:  [-0.23757913]
Stock Position:  -0.2375791290238628
Bond Position:  [15.07891919]


portfolio before change:  [-9.72720553]
curr_Stock_Price:  104.41998757670858
curr_Factors:  [104.41998758]
mat_Sqrt:  [[0.15]]
grads:  [0.03211583]
Stock Position:  0.03211582985437999
Bond Position:  [-13.08074009]


portfolio before change:  [-9.72192242]
curr_Stock_Price:  104.63540497523876
curr_Factors:  [104.63540498]
mat_Sqrt:  [[0.15]]
grads:  [0.06921094]
Stock Position:  0.06921093729462878
Bond Position:  [-16.96383687]


portfolio before change:  [-9.72440807]
curr_Stock_Price:  104.63013070785777
curr_Factors:  [104.63013071]
mat_Sqrt:  [[0.15]]
grads:  [-0.03706788]
Stock Position:  -0.03706787597446616
Bond Position:  [-5.84599136]


portfolio before change:  [-9.74281827]
curr_Stock_Price:  105.1070775941408
curr_Factors:  [105.10707759]
mat_Sqrt:  [[0.15]]
grads:  [0.04563671]
Stock Position:  0.045636706134514926
Bond Position:  [-14.53955908]


portfolio before change:  [-9.70176091]
curr_Stock_Price:  106.0465608142471
curr_Factors:  [106.04656081]
mat_Sqrt:  [[0.15]]
grads:  [-0.07837068]
Stock Position:  -0.07837067563665848
Bond Position:  [-1.39082029]


portfolio before change:  [-9.64992323]
curr_Stock_Price:  105.38290011139688
curr_Factors:  [105.38290011]
mat_Sqrt:  [[0.15]]
grads:  [0.02864806]
Stock Position:  0.02864805905586301
Bond Position:  [-12.66893878]


portfolio before change:  [-9.65837267]
curr_Stock_Price:  105.14324285491946
curr_Factors:  [105.14324285]
mat_Sqrt:  [[0.15]]
grads:  [0.26634722]
Stock Position:  0.26634722250799925
Bond Position:  [-37.66298337]


portfolio before change:  [-9.52287947]
curr_Stock_Price:  105.66962854437172
curr_Factors:  [105.66962854]
mat_Sqrt:  [[0.15]]
grads:  [0.17511175]
Stock Position:  0.17511175159215198
Bond Position:  [-28.02687321]


portfolio before change:  [-9.57615054]
curr_Stock_Price:  105.3854243253209
curr_Factors:  [105.38542433]
mat_Sqrt:  [[0.15]]
grads:  [-0.14876042]
Stock Position:  -0.14876042258644367
Bond Position:  [6.10102971]


portfolio before change:  [-9.45253031]
curr_Stock_Price:  104.5595490311349
curr_Factors:  [104.55954903]
mat_Sqrt:  [[0.15]]
grads:  [0.04115997]
Stock Position:  0.04115996748735952
Bond Position:  [-13.75619795]


portfolio before change:  [-9.45874453]
curr_Stock_Price:  104.4503508950051
curr_Factors:  [104.4503509]
mat_Sqrt:  [[0.15]]
grads:  [-0.08681173]
Stock Position:  -0.08681173437288606
Bond Position:  [-0.39122842]


portfolio before change:  [-9.56355154]
curr_Stock_Price:  105.65707829376127
curr_Factors:  [105.65707829]
mat_Sqrt:  [[0.15]]
grads:  [0.02023477]
Stock Position:  0.02023477059330504
Bond Position:  [-11.70149828]


portfolio before change:  [-9.5750347]
curr_Stock_Price:  105.16187236626425
curr_Factors:  [105.16187237]
mat_Sqrt:  [[0.15]]
grads:  [-0.04212418]
Stock Position:  -0.04212418235103967
Bond Position:  [-5.14517681]


portfolio before change:  [-9.56631716]
curr_Stock_Price:  104.93965505905811
curr_Factors:  [104.93965506]
mat_Sqrt:  [[0.15]]
grads:  [0.00872994]
Stock Position:  0.008729937512344256
Bond Position:  [-10.48243379]


portfolio before change:  [-9.56581308]
curr_Stock_Price:  105.14749962516888
curr_Factors:  [105.14749963]
mat_Sqrt:  [[0.15]]
grads:  [0.16106473]
Stock Position:  0.1610647300513306
Bond Position:  [-26.50136672]


portfolio before change:  [-9.42342345]
curr_Stock_Price:  106.05212040592039
curr_Factors:  [106.05212041]
mat_Sqrt:  [[0.15]]
grads:  [0.0316792]
Stock Position:  0.031679199872807755
Bond Position:  [-12.78306977]


portfolio before change:  [-9.45750831]
curr_Stock_Price:  105.02662508560235
curr_Factors:  [105.02662509]
mat_Sqrt:  [[0.15]]
grads:  [0.13425495]
Stock Position:  0.1342549502002277
Bond Position:  [-23.55785263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.45750831]
Stock Price:  103.81865302862711
PL:  [-13.27616134]
Settle:  Tensor("sub_88:0", shape=(), dtype=float64)
PL:  Tensor("sub_89:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  45
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.07918483e-03]
 [-1.85700025e-03]
 [ 5.63587830e-04]
 [-6.48596009e-03]
 [ 9.77334209e-03]
 [ 2.41004159e-02]
 [ 1.22757911e-02]
 [-6.35978540e-04]
 [ 2.76237617e-03]
 [ 1.21471600e-02]
 [ 2.59702532e-02]
 [-1.85582393e-03]
 [-1.23935076e-02]
 [ 3.08489749e-03]
 [ 2.54732167e-03]
 [-2.90158556e-02]
 [ 4.94284888e-03]
 [-3.47855019e-03]
 [-1.17128773e-03]
 [-2.44876366e-03]
 [-2.07266190e-04]
 [-3.16568716e-02]
 [ 4.79194541e-03]
 [ 7.53170831e-03]
 [-4.01303126e-03]
 [-6.01473081e-03]
 [ 4.34779045e-03]
 [-1.97057380e-02]
 [-1.61432878e-02]
 [ 2.22437247e-02]
 [-1.41444234e-04]
 [ 6.37514512e-03]
 [-1.24762727e-02]
 [-6.68329218e-03]
 [-6.40378109e-03]
 [-7.50367945e-03]
 [ 2.22749680e-02]
 [ 8.20743829e-03]
 [ 2.31376971e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.6597542]
curr_Stock_Price:  99.8325218529165
curr_Factors:  [99.83252185]
mat_Sqrt:  [[0.15]]
grads:  [-0.01386123]
Stock Position:  -0.013861232231587904
Bond Position:  [0.72404757]


portfolio before change:  [-0.64797764]
curr_Stock_Price:  98.9894474208437
curr_Factors:  [98.98944742]
mat_Sqrt:  [[0.15]]
grads:  [-0.01238]
Stock Position:  -0.01238000168127326
Bond Position:  [0.57751189]


portfolio before change:  [-0.6536711]
curr_Stock_Price:  99.45517058484256
curr_Factors:  [99.45517058]
mat_Sqrt:  [[0.15]]
grads:  [0.00375725]
Stock Position:  0.0037572522024133135
Bond Position:  [-1.02734926]


portfolio before change:  [-0.65313412]
curr_Stock_Price:  99.63226793331263
curr_Factors:  [99.63226793]
mat_Sqrt:  [[0.15]]
grads:  [-0.04323973]
Stock Position:  -0.04323973394242566
Bond Position:  [3.65493863]


portfolio before change:  [-0.68666601]
curr_Stock_Price:  100.41832234201362
curr_Factors:  [100.41832234]
mat_Sqrt:  [[0.15]]
grads:  [0.06515561]
Stock Position:  0.06515561394791801
Bond Position:  [-7.22948346]


portfolio before change:  [-0.66230301]
curr_Stock_Price:  100.80611300536037
curr_Factors:  [100.80611301]
mat_Sqrt:  [[0.15]]
grads:  [0.16066944]
Stock Position:  0.16066943934698907
Bond Position:  [-16.85876467]


portfolio before change:  [-0.51744454]
curr_Stock_Price:  101.72082307572678
curr_Factors:  [101.72082308]
mat_Sqrt:  [[0.15]]
grads:  [0.08183861]
Stock Position:  0.0818386073623195
Bond Position:  [-8.84213504]


portfolio before change:  [-0.52923037]
curr_Stock_Price:  101.59031627477933
curr_Factors:  [101.59031627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00423986]
Stock Position:  -0.004239856933734675
Bond Position:  [-0.09850196]


portfolio before change:  [-0.52692377]
curr_Stock_Price:  101.043383714199
curr_Factors:  [101.04338371]
mat_Sqrt:  [[0.15]]
grads:  [0.01841584]
Stock Position:  0.018415841127185247
Bond Position:  [-2.38772267]


portfolio before change:  [-0.4998811]
curr_Stock_Price:  102.52803781207822
curr_Factors:  [102.52803781]
mat_Sqrt:  [[0.15]]
grads:  [0.08098107]
Stock Position:  0.08098106633372106
Bond Position:  [-8.80271093]


portfolio before change:  [-0.49401214]
curr_Stock_Price:  102.61409950528338
curr_Factors:  [102.61409951]
mat_Sqrt:  [[0.15]]
grads:  [0.17313502]
Stock Position:  0.17313502156766733
Bond Position:  [-18.26010647]


portfolio before change:  [-0.45149869]
curr_Stock_Price:  102.87283457370286
curr_Factors:  [102.87283457]
mat_Sqrt:  [[0.15]]
grads:  [-0.01237216]
Stock Position:  -0.012372159545001328
Bond Position:  [0.82126043]


portfolio before change:  [-0.45705823]
curr_Stock_Price:  103.33049102541916
curr_Factors:  [103.33049103]
mat_Sqrt:  [[0.15]]
grads:  [-0.08262338]
Stock Position:  -0.0826233842204813
Bond Position:  [8.08045664]


portfolio before change:  [-0.47906803]
curr_Stock_Price:  103.60910376188039
curr_Factors:  [103.60910376]
mat_Sqrt:  [[0.15]]
grads:  [0.02056598]
Stock Position:  0.020565983249588658
Bond Position:  [-2.60989112]


portfolio before change:  [-0.4602775]
curr_Stock_Price:  104.53863819485845
curr_Factors:  [104.53863819]
mat_Sqrt:  [[0.15]]
grads:  [0.01698214]
Stock Position:  0.0169821444526861
Bond Position:  [-2.23556775]


portfolio before change:  [-0.4745666]
curr_Stock_Price:  103.71367541401249
curr_Factors:  [103.71367541]
mat_Sqrt:  [[0.15]]
grads:  [-0.19343904]
Stock Position:  -0.19343903703887655
Bond Position:  [19.5877069]


portfolio before change:  [-0.47146119]
curr_Stock_Price:  103.7102800849213
curr_Factors:  [103.71028008]
mat_Sqrt:  [[0.15]]
grads:  [0.03295233]
Stock Position:  0.03295232588873337
Bond Position:  [-3.88895614]


portfolio before change:  [-0.4804547]
curr_Stock_Price:  103.45210833190495
curr_Factors:  [103.45210833]
mat_Sqrt:  [[0.15]]
grads:  [-0.02319033]
Stock Position:  -0.023190334571203616
Bond Position:  [1.9186343]


portfolio before change:  [-0.46847467]
curr_Stock_Price:  102.94585468545606
curr_Factors:  [102.94585469]
mat_Sqrt:  [[0.15]]
grads:  [-0.00780858]
Stock Position:  -0.007808584835304727
Bond Position:  [0.33538677]


portfolio before change:  [-0.46127782]
curr_Stock_Price:  102.02956596932694
curr_Factors:  [102.02956597]
mat_Sqrt:  [[0.15]]
grads:  [-0.01632509]
Stock Position:  -0.01632509107055988
Bond Position:  [1.20436413]


portfolio before change:  [-0.45536026]
curr_Stock_Price:  101.67630525136347
curr_Factors:  [101.67630525]
mat_Sqrt:  [[0.15]]
grads:  [-0.00138177]
Stock Position:  -0.0013817746000729734
Bond Position:  [-0.31486652]


portfolio before change:  [-0.45702225]
curr_Stock_Price:  102.85061598630404
curr_Factors:  [102.85061599]
mat_Sqrt:  [[0.15]]
grads:  [-0.21104581]
Stock Position:  -0.21104581059177147
Bond Position:  [21.24916937]


portfolio before change:  [-0.33991431]
curr_Stock_Price:  102.3083089377417
curr_Factors:  [102.30830894]
mat_Sqrt:  [[0.15]]
grads:  [0.0319463]
Stock Position:  0.031946302717584245
Bond Position:  [-3.60828651]


portfolio before change:  [-0.363133]
curr_Stock_Price:  101.59562462482076
curr_Factors:  [101.59562462]
mat_Sqrt:  [[0.15]]
grads:  [0.05021139]
Stock Position:  0.05021138872987235
Bond Position:  [-5.4643904]


portfolio before change:  [-0.35869596]
curr_Stock_Price:  101.69759616845663
curr_Factors:  [101.69759617]
mat_Sqrt:  [[0.15]]
grads:  [-0.02675354]
Stock Position:  -0.02675354176195574
Bond Position:  [2.36207493]


portfolio before change:  [-0.3624417]
curr_Stock_Price:  101.84864248339751
curr_Factors:  [101.84864248]
mat_Sqrt:  [[0.15]]
grads:  [-0.04009821]
Stock Position:  -0.04009820540664359
Bond Position:  [3.72150608]


portfolio before change:  [-0.35613248]
curr_Stock_Price:  101.702900093765
curr_Factors:  [101.70290009]
mat_Sqrt:  [[0.15]]
grads:  [0.02898527]
Stock Position:  0.028985269677181322
Bond Position:  [-3.30401846]


portfolio before change:  [-0.38515508]
curr_Stock_Price:  100.7158618174501
curr_Factors:  [100.71586182]
mat_Sqrt:  [[0.15]]
grads:  [-0.13137159]
Stock Position:  -0.13137158669793245
Bond Position:  [12.8460475]


portfolio before change:  [-0.40638808]
curr_Stock_Price:  100.88971110028713
curr_Factors:  [100.8897111]
mat_Sqrt:  [[0.15]]
grads:  [-0.10762192]
Stock Position:  -0.10762191839254953
Bond Position:  [10.45155618]


portfolio before change:  [-0.46226767]
curr_Stock_Price:  101.42107238005242
curr_Factors:  [101.42107238]
mat_Sqrt:  [[0.15]]
grads:  [0.1482915]
Stock Position:  0.148291498041301
Bond Position:  [-15.50215043]


portfolio before change:  [-0.38318891]
curr_Stock_Price:  101.96740611457588
curr_Factors:  [101.96740611]
mat_Sqrt:  [[0.15]]
grads:  [-0.00094296]
Stock Position:  -0.0009429615613060275
Bond Position:  [-0.28703757]


portfolio before change:  [-0.38355358]
curr_Stock_Price:  102.31607359403365
curr_Factors:  [102.31607359]
mat_Sqrt:  [[0.15]]
grads:  [0.04250097]
Stock Position:  0.04250096744924918
Bond Position:  [-4.73208569]


portfolio before change:  [-0.46716785]
curr_Stock_Price:  100.3626420348568
curr_Factors:  [100.36264203]
mat_Sqrt:  [[0.15]]
grads:  [-0.08317515]
Stock Position:  -0.08317515112184404
Bond Position:  [7.88051006]


portfolio before change:  [-0.55429918]
curr_Stock_Price:  101.42205042043453
curr_Factors:  [101.42205042]
mat_Sqrt:  [[0.15]]
grads:  [-0.04455528]
Stock Position:  -0.044555281180193265
Bond Position:  [3.96458879]


portfolio before change:  [-0.50249943]
curr_Stock_Price:  100.27057878874504
curr_Factors:  [100.27057879]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269187]
Stock Position:  -0.04269187395520445
Bond Position:  [3.77823948]


portfolio before change:  [-0.4594444]
curr_Stock_Price:  99.27313544862449
curr_Factors:  [99.27313545]
mat_Sqrt:  [[0.15]]
grads:  [-0.05002453]
Stock Position:  -0.05002452965027732
Bond Position:  [4.50664751]


portfolio before change:  [-0.43910783]
curr_Stock_Price:  98.87786537526098
curr_Factors:  [98.87786538]
mat_Sqrt:  [[0.15]]
grads:  [0.14849979]
Stock Position:  0.1484997863374347
Bond Position:  [-15.12244972]


portfolio before change:  [-0.46948122]
curr_Stock_Price:  98.68606061949413
curr_Factors:  [98.68606062]
mat_Sqrt:  [[0.15]]
grads:  [0.05471626]
Stock Position:  0.05471625523673698
Bond Position:  [-5.8692129]


portfolio before change:  [-0.47470571]
curr_Stock_Price:  98.60398640667894
curr_Factors:  [98.60398641]
mat_Sqrt:  [[0.15]]
grads:  [0.15425131]
Stock Position:  0.15425131397766112
Bond Position:  [-15.68450018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.47470571]
Stock Price:  98.38176334977335
PL:  [-0.47470571]
Settle:  Tensor("sub_90:0", shape=(), dtype=float64)
PL:  Tensor("sub_91:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  46
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.42469571e-03]
 [ 1.95397362e-03]
 [ 3.39721439e-04]
 [ 8.43836147e-02]
 [-3.78062254e-02]
 [ 3.79037326e-02]
 [ 8.12371427e-03]
 [ 1.19672533e-04]
 [ 8.26924824e-03]
 [ 1.31891655e-02]
 [ 1.11970170e-02]
 [-1.48620928e-02]
 [-1.26858615e-02]
 [ 5.76196705e-03]
 [ 1.94165318e-03]
 [-2.82287014e-02]
 [ 4.99641125e-03]
 [ 2.15376609e-03]
 [-5.65808079e-03]
 [-2.52310912e-03]
 [-3.74111023e-04]
 [-3.32922624e-02]
 [ 4.80285158e-03]
 [ 7.82719674e-03]
 [-4.53161378e-03]
 [-8.48853393e-03]
 [ 8.35474204e-03]
 [-1.95228838e-02]
 [-1.49666767e-02]
 [ 2.34230178e-02]
 [-1.58396907e-03]
 [ 6.62766534e-03]
 [-1.28770747e-02]
 [-5.85531061e-03]
 [-5.43507880e-03]
 [-5.43293830e-03]
 [ 2.32757411e-02]
 [ 3.65940286e-03]
 [ 2.32301450e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.27381052]
curr_Stock_Price:  100.92341715444988
curr_Factors:  [100.92341715]
mat_Sqrt:  [[0.15]]
grads:  [-0.01616464]
Stock Position:  -0.01616463807522481
Bond Position:  [17.90520103]


portfolio before change:  [16.25567826]
curr_Stock_Price:  102.18360949474894
curr_Factors:  [102.18360949]
mat_Sqrt:  [[0.15]]
grads:  [0.01302649]
Stock Position:  0.013026490769380544
Bond Position:  [14.92458441]


portfolio before change:  [16.26135766]
curr_Stock_Price:  102.47637498715278
curr_Factors:  [102.47637499]
mat_Sqrt:  [[0.15]]
grads:  [0.00226481]
Stock Position:  0.00226480959593148
Bond Position:  [16.02926818]


portfolio before change:  [16.26491939]
curr_Stock_Price:  103.16426956323811
curr_Factors:  [103.16426956]
mat_Sqrt:  [[0.15]]
grads:  [0.56255743]
Stock Position:  0.5625574314478997
Bond Position:  [-41.77090711]


portfolio before change:  [16.34988821]
curr_Stock_Price:  103.32459188057993
curr_Factors:  [103.32459188]
mat_Sqrt:  [[0.15]]
grads:  [-0.2520415]
Stock Position:  -0.25204150240070083
Bond Position:  [42.39197358]


portfolio before change:  [16.36631165]
curr_Stock_Price:  103.2804558324392
curr_Factors:  [103.28045583]
mat_Sqrt:  [[0.15]]
grads:  [0.25269155]
Stock Position:  0.25269155096364976
Bond Position:  [-9.73178691]


portfolio before change:  [16.11749302]
curr_Stock_Price:  102.3005968419384
curr_Factors:  [102.30059684]
mat_Sqrt:  [[0.15]]
grads:  [0.0541581]
Stock Position:  0.054158095122843294
Bond Position:  [10.57708756]


portfolio before change:  [16.10124919]
curr_Stock_Price:  101.97624927982775
curr_Factors:  [101.97624928]
mat_Sqrt:  [[0.15]]
grads:  [0.00079782]
Stock Position:  0.0007978168865254049
Bond Position:  [16.01989082]


portfolio before change:  [16.10348761]
curr_Stock_Price:  102.27181473622889
curr_Factors:  [102.27181474]
mat_Sqrt:  [[0.15]]
grads:  [0.05512832]
Stock Position:  0.055128321611732915
Bond Position:  [10.46541411]


portfolio before change:  [16.18279948]
curr_Stock_Price:  103.68676099525993
curr_Factors:  [103.686761]
mat_Sqrt:  [[0.15]]
grads:  [0.08792777]
Stock Position:  0.08792777022498553
Bond Position:  [7.06585378]


portfolio before change:  [16.31253862]
curr_Stock_Price:  105.15223494615235
curr_Factors:  [105.15223495]
mat_Sqrt:  [[0.15]]
grads:  [0.07464678]
Stock Position:  0.07464678000116019
Bond Position:  [8.46326287]


portfolio before change:  [16.295602]
curr_Stock_Price:  104.91117167086034
curr_Factors:  [104.91117167]
mat_Sqrt:  [[0.15]]
grads:  [-0.09908062]
Stock Position:  -0.0990806188514088
Bond Position:  [26.69026581]


portfolio before change:  [16.40237869]
curr_Stock_Price:  103.86717135142598
curr_Factors:  [103.86717135]
mat_Sqrt:  [[0.15]]
grads:  [-0.08457241]
Stock Position:  -0.08457241029971407
Bond Position:  [25.18667572]


portfolio before change:  [16.45585194]
curr_Stock_Price:  103.27212250125251
curr_Factors:  [103.2721225]
mat_Sqrt:  [[0.15]]
grads:  [0.03841311]
Stock Position:  0.038413113647754064
Bond Position:  [12.48884816]


portfolio before change:  [16.49572891]
curr_Stock_Price:  104.26958848440448
curr_Factors:  [104.26958848]
mat_Sqrt:  [[0.15]]
grads:  [0.01294435]
Stock Position:  0.012944354521892156
Bond Position:  [15.14602639]


portfolio before change:  [16.48648033]
curr_Stock_Price:  103.40883028907285
curr_Factors:  [103.40883029]
mat_Sqrt:  [[0.15]]
grads:  [-0.18819134]
Stock Position:  -0.18819134271316718
Bond Position:  [35.94712695]


portfolio before change:  [16.51884495]
curr_Stock_Price:  103.26073126859576
curr_Factors:  [103.26073127]
mat_Sqrt:  [[0.15]]
grads:  [0.03330941]
Stock Position:  0.03330940832449463
Bond Position:  [13.07929109]


portfolio before change:  [16.47458814]
curr_Stock_Price:  101.88298753325282
curr_Factors:  [101.88298753]
mat_Sqrt:  [[0.15]]
grads:  [0.01435844]
Stock Position:  0.014358440570764085
Bond Position:  [15.01170731]


portfolio before change:  [16.47783239]
curr_Stock_Price:  101.9782399111094
curr_Factors:  [101.97823991]
mat_Sqrt:  [[0.15]]
grads:  [-0.03772054]
Stock Position:  -0.03772053857178718
Bond Position:  [20.32450652]


portfolio before change:  [16.46947507]
curr_Stock_Price:  102.26715520259602
curr_Factors:  [102.2671552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01682073]
Stock Position:  -0.0168207274633978
Bond Position:  [18.18968302]


portfolio before change:  [16.47847125]
curr_Stock_Price:  101.86750990193379
curr_Factors:  [101.8675099]
mat_Sqrt:  [[0.15]]
grads:  [-0.00249407]
Stock Position:  -0.0024940734895735504
Bond Position:  [16.73253631]


portfolio before change:  [16.47747337]
curr_Stock_Price:  103.1062786769753
curr_Factors:  [103.10627868]
mat_Sqrt:  [[0.15]]
grads:  [-0.22194842]
Stock Position:  -0.22194841579385344
Bond Position:  [39.36174858]


portfolio before change:  [16.46435148]
curr_Stock_Price:  103.18756969275408
curr_Factors:  [103.18756969]
mat_Sqrt:  [[0.15]]
grads:  [0.03201901]
Stock Position:  0.03201901055014212
Bond Position:  [13.1603876]


portfolio before change:  [16.42718369]
curr_Stock_Price:  101.97538518982152
curr_Factors:  [101.97538519]
mat_Sqrt:  [[0.15]]
grads:  [0.05218131]
Stock Position:  0.05218131156685141
Bond Position:  [11.10597434]


portfolio before change:  [16.43798884]
curr_Stock_Price:  102.15584873037352
curr_Factors:  [102.15584873]
mat_Sqrt:  [[0.15]]
grads:  [-0.03021076]
Stock Position:  -0.030210758543174756
Bond Position:  [19.52419452]


portfolio before change:  [16.4751677]
curr_Stock_Price:  101.00598734228016
curr_Factors:  [101.00598734]
mat_Sqrt:  [[0.15]]
grads:  [-0.05659023]
Stock Position:  -0.0565902261730166
Bond Position:  [22.19111937]


portfolio before change:  [16.48246031]
curr_Stock_Price:  100.92614062917269
curr_Factors:  [100.92614063]
mat_Sqrt:  [[0.15]]
grads:  [0.05569828]
Stock Position:  0.05569828027525754
Bond Position:  [10.86104784]


portfolio before change:  [16.48977659]
curr_Stock_Price:  101.03311989302215
curr_Factors:  [101.03311989]
mat_Sqrt:  [[0.15]]
grads:  [-0.13015256]
Stock Position:  -0.13015255840303766
Bond Position:  [29.63949563]


portfolio before change:  [16.4386136]
curr_Stock_Price:  101.45468795373142
curr_Factors:  [101.45468795]
mat_Sqrt:  [[0.15]]
grads:  [-0.09977784]
Stock Position:  -0.09977784475159762
Bond Position:  [26.5615437]


portfolio before change:  [16.33576815]
curr_Stock_Price:  102.5187101859063
curr_Factors:  [102.51871019]
mat_Sqrt:  [[0.15]]
grads:  [0.15615345]
Stock Position:  0.15615345225129443
Bond Position:  [0.32711763]


portfolio before change:  [16.26929198]
curr_Stock_Price:  102.09273776729903
curr_Factors:  [102.09273777]
mat_Sqrt:  [[0.15]]
grads:  [-0.01055979]
Stock Position:  -0.010559793805917584
Bond Position:  [17.34737024]


portfolio before change:  [16.27359186]
curr_Stock_Price:  101.89090415773346
curr_Factors:  [101.89090416]
mat_Sqrt:  [[0.15]]
grads:  [0.04418444]
Stock Position:  0.04418443562281664
Bond Position:  [11.77159976]


portfolio before change:  [16.33003165]
curr_Stock_Price:  103.13496788210976
curr_Factors:  [103.13496788]
mat_Sqrt:  [[0.15]]
grads:  [-0.08584716]
Stock Position:  -0.08584716482351049
Bond Position:  [25.18387624]


portfolio before change:  [16.42642431]
curr_Stock_Price:  102.04879950195684
curr_Factors:  [102.0487995]
mat_Sqrt:  [[0.15]]
grads:  [-0.0390354]
Stock Position:  -0.03903540403336247
Bond Position:  [20.40994043]


portfolio before change:  [16.44671065]
curr_Stock_Price:  101.59446997596996
curr_Factors:  [101.59446998]
mat_Sqrt:  [[0.15]]
grads:  [-0.03623386]
Stock Position:  -0.03623385867292606
Bond Position:  [20.12787032]


portfolio before change:  [16.4458829]
curr_Stock_Price:  101.68675619800086
curr_Factors:  [101.6867562]
mat_Sqrt:  [[0.15]]
grads:  [-0.03621959]
Stock Position:  -0.03621958867653232
Bond Position:  [20.12893539]


portfolio before change:  [16.42395698]
curr_Stock_Price:  102.36158984020314
curr_Factors:  [102.36158984]
mat_Sqrt:  [[0.15]]
grads:  [0.15517161]
Stock Position:  0.1551716073557068
Bond Position:  [0.54034455]


portfolio before change:  [16.29133663]
curr_Stock_Price:  101.50648563213065
curr_Factors:  [101.50648563]
mat_Sqrt:  [[0.15]]
grads:  [0.02439602]
Stock Position:  0.02439601903893404
Bond Position:  [13.81498248]


portfolio before change:  [16.28159564]
curr_Stock_Price:  101.03640983471257
curr_Factors:  [101.03640983]
mat_Sqrt:  [[0.15]]
grads:  [0.15486763]
Stock Position:  0.15486763302515683
Bond Position:  [0.634326]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.28159564]
Stock Price:  100.97180646695332
PL:  [15.30978917]
Settle:  Tensor("sub_92:0", shape=(), dtype=float64)
PL:  Tensor("sub_93:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  47
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-6.14091567e-03]
 [ 7.05646918e-04]
 [-3.45939100e-02]
 [-2.94677964e-02]
 [ 1.06789277e-02]
 [ 2.00804949e-02]
 [ 2.72127853e-02]
 [-2.00801946e-03]
 [ 2.97047335e-03]
 [ 9.38218911e-03]
 [ 2.37273435e-02]
 [ 6.57259982e-03]
 [-4.71255544e-03]
 [ 1.00205756e-02]
 [-4.20309633e-03]
 [-2.40895240e-02]
 [ 4.45078053e-03]
 [ 1.65909909e-03]
 [-2.66457999e-03]
 [-2.86576228e-03]
 [-1.21925718e-03]
 [-3.55690019e-02]
 [ 4.80118314e-03]
 [ 8.69974038e-03]
 [-4.75000908e-03]
 [-7.49301745e-03]
 [ 9.70681042e-03]
 [-2.40847733e-02]
 [-1.58929861e-02]
 [ 2.16359360e-02]
 [ 8.92846264e-03]
 [-1.88441593e-03]
 [-1.25334935e-02]
 [-9.91741224e-03]
 [-7.18981679e-03]
 [-6.59252677e-03]
 [ 2.01683884e-02]
 [ 9.04434904e-03]
 [ 2.19326860e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.42287734]
curr_Stock_Price:  98.55934053879822
curr_Factors:  [98.55934054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04093944]
Stock Position:  -0.040939437819560304
Bond Position:  [-16.38791335]


portfolio before change:  [-20.44991959]
curr_Stock_Price:  99.16984303993333
curr_Factors:  [99.16984304]
mat_Sqrt:  [[0.15]]
grads:  [0.00470431]
Stock Position:  0.004704312784937692
Bond Position:  [-20.91644555]


portfolio before change:  [-20.45795211]
curr_Stock_Price:  98.018175809496
curr_Factors:  [98.01817581]
mat_Sqrt:  [[0.15]]
grads:  [-0.23062607]
Stock Position:  -0.23062606694672944
Bond Position:  [2.14759426]


portfolio before change:  [-20.3307603]
curr_Stock_Price:  97.46783322048032
curr_Factors:  [97.46783322]
mat_Sqrt:  [[0.15]]
grads:  [-0.19645198]
Stock Position:  -0.19645197587139826
Bond Position:  [-1.18301188]


portfolio before change:  [-20.43064478]
curr_Stock_Price:  97.97552264963063
curr_Factors:  [97.97552265]
mat_Sqrt:  [[0.15]]
grads:  [0.07119285]
Stock Position:  0.07119285135500203
Bond Position:  [-27.4058016]


portfolio before change:  [-20.35888459]
curr_Stock_Price:  99.03161359644595
curr_Factors:  [99.0316136]
mat_Sqrt:  [[0.15]]
grads:  [0.13386997]
Stock Position:  0.13386996628541487
Bond Position:  [-33.61624336]


portfolio before change:  [-20.20976678]
curr_Stock_Price:  100.17690483304993
curr_Factors:  [100.17690483]
mat_Sqrt:  [[0.15]]
grads:  [0.18141857]
Stock Position:  0.18141856870798728
Bond Position:  [-38.38371748]


portfolio before change:  [-20.06463994]
curr_Stock_Price:  101.00330927258149
curr_Factors:  [101.00330927]
mat_Sqrt:  [[0.15]]
grads:  [-0.0133868]
Stock Position:  -0.013386796431561676
Bond Position:  [-18.7125292]


portfolio before change:  [-20.0684335]
curr_Stock_Price:  101.11194972328647
curr_Factors:  [101.11194972]
mat_Sqrt:  [[0.15]]
grads:  [0.01980316]
Stock Position:  0.019803155686634988
Bond Position:  [-22.07076918]


portfolio before change:  [-20.06875935]
curr_Stock_Price:  101.23481722050944
curr_Factors:  [101.23481722]
mat_Sqrt:  [[0.15]]
grads:  [0.06254793]
Stock Position:  0.06254792741881615
Bond Position:  [-26.40078735]


portfolio before change:  [-20.06476307]
curr_Stock_Price:  101.35147311490539
curr_Factors:  [101.35147311]
mat_Sqrt:  [[0.15]]
grads:  [0.15818229]
Stock Position:  0.1581822898511412
Bond Position:  [-36.09677117]


portfolio before change:  [-20.40589889]
curr_Stock_Price:  99.22340024223324
curr_Factors:  [99.22340024]
mat_Sqrt:  [[0.15]]
grads:  [0.04381733]
Stock Position:  0.04381733216350367
Bond Position:  [-24.75360358]


portfolio before change:  [-20.40870855]
curr_Stock_Price:  99.22989846820929
curr_Factors:  [99.22989847]
mat_Sqrt:  [[0.15]]
grads:  [-0.03141704]
Stock Position:  -0.03141703629563813
Bond Position:  [-17.29119923]


portfolio before change:  [-20.42220559]
curr_Stock_Price:  99.5907060619399
curr_Factors:  [99.59070606]
mat_Sqrt:  [[0.15]]
grads:  [0.06680384]
Stock Position:  0.06680383751924264
Bond Position:  [-27.07524694]


portfolio before change:  [-20.42985576]
curr_Stock_Price:  99.52685411063253
curr_Factors:  [99.52685411]
mat_Sqrt:  [[0.15]]
grads:  [-0.02802064]
Stock Position:  -0.028020642196987505
Bond Position:  [-17.6410494]


portfolio before change:  [-20.46632706]
curr_Stock_Price:  100.74973929749791
curr_Factors:  [100.7497393]
mat_Sqrt:  [[0.15]]
grads:  [-0.16059683]
Stock Position:  -0.16059682636961084
Bond Position:  [-4.28623867]


portfolio before change:  [-20.5392166]
curr_Stock_Price:  101.20026953835641
curr_Factors:  [101.20026954]
mat_Sqrt:  [[0.15]]
grads:  [0.02967187]
Stock Position:  0.029671870214359585
Bond Position:  [-23.54201786]


portfolio before change:  [-20.5128337]
curr_Stock_Price:  102.18860767265612
curr_Factors:  [102.18860767]
mat_Sqrt:  [[0.15]]
grads:  [0.01106066]
Stock Position:  0.011060660569994062
Bond Position:  [-21.6431072]


portfolio before change:  [-20.51072559]
curr_Stock_Price:  102.62381361138547
curr_Factors:  [102.62381361]
mat_Sqrt:  [[0.15]]
grads:  [-0.01776387]
Stock Position:  -0.017763866590227193
Bond Position:  [-18.68772985]


portfolio before change:  [-20.51786581]
curr_Stock_Price:  102.89425616332299
curr_Factors:  [102.89425616]
mat_Sqrt:  [[0.15]]
grads:  [-0.01910508]
Stock Position:  -0.019105081887565125
Bond Position:  [-18.55206262]


portfolio before change:  [-20.52436085]
curr_Stock_Price:  103.11283086329954
curr_Factors:  [103.11283086]
mat_Sqrt:  [[0.15]]
grads:  [-0.00812838]
Stock Position:  -0.008128381212627751
Bond Position:  [-19.68622045]


portfolio before change:  [-20.52966162]
curr_Stock_Price:  103.46220421906013
curr_Factors:  [103.46220422]
mat_Sqrt:  [[0.15]]
grads:  [-0.23712668]
Stock Position:  -0.2371266792178189
Bond Position:  [4.00398729]


portfolio before change:  [-20.43214192]
curr_Stock_Price:  103.05305933698638
curr_Factors:  [103.05305934]
mat_Sqrt:  [[0.15]]
grads:  [0.03200789]
Stock Position:  0.03200788761946575
Bond Position:  [-23.73065266]


portfolio before change:  [-20.43911274]
curr_Stock_Price:  102.92795569414703
curr_Factors:  [102.92795569]
mat_Sqrt:  [[0.15]]
grads:  [0.05799827]
Stock Position:  0.05799826921772472
Bond Position:  [-26.40875603]


portfolio before change:  [-20.47596289]
curr_Stock_Price:  102.34950999107674
curr_Factors:  [102.34950999]
mat_Sqrt:  [[0.15]]
grads:  [-0.03166673]
Stock Position:  -0.03166672719316012
Bond Position:  [-17.23488888]


portfolio before change:  [-20.44645013]
curr_Stock_Price:  101.34949335085257
curr_Factors:  [101.34949335]
mat_Sqrt:  [[0.15]]
grads:  [-0.04995345]
Stock Position:  -0.04995344965751052
Bond Position:  [-15.38369332]


portfolio before change:  [-20.41592172]
curr_Stock_Price:  100.69985869142587
curr_Factors:  [100.69985869]
mat_Sqrt:  [[0.15]]
grads:  [0.06471207]
Stock Position:  0.06471206948865309
Bond Position:  [-26.93241798]


portfolio before change:  [-20.46425402]
curr_Stock_Price:  100.00500318330593
curr_Factors:  [100.00500318]
mat_Sqrt:  [[0.15]]
grads:  [-0.16056516]
Stock Position:  -0.16056515534274743
Bond Position:  [-4.40693515]


portfolio before change:  [-20.56665964]
curr_Stock_Price:  100.63935451673872
curr_Factors:  [100.63935452]
mat_Sqrt:  [[0.15]]
grads:  [-0.10595324]
Stock Position:  -0.10595324061809705
Bond Position:  [-9.9035939]


portfolio before change:  [-20.55345655]
curr_Stock_Price:  100.50305744270264
curr_Factors:  [100.50305744]
mat_Sqrt:  [[0.15]]
grads:  [0.14423957]
Stock Position:  0.14423957325832887
Bond Position:  [-35.04997467]


portfolio before change:  [-20.6085451]
curr_Stock_Price:  100.15151017707008
curr_Factors:  [100.15151018]
mat_Sqrt:  [[0.15]]
grads:  [0.05952308]
Stock Position:  0.05952308423994022
Bond Position:  [-26.56987188]


portfolio before change:  [-20.70190853]
curr_Stock_Price:  98.63878631698755
curr_Factors:  [98.63878632]
mat_Sqrt:  [[0.15]]
grads:  [-0.01256277]
Stock Position:  -0.012562772895462497
Bond Position:  [-19.46273186]


portfolio before change:  [-20.69924279]
curr_Stock_Price:  98.23292548836977
curr_Factors:  [98.23292549]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355662]
Stock Position:  -0.08355662336505291
Bond Position:  [-12.49123123]


portfolio before change:  [-20.5607772]
curr_Stock_Price:  96.5570907653937
curr_Factors:  [96.55709077]
mat_Sqrt:  [[0.15]]
grads:  [-0.06611608]
Stock Position:  -0.06611608161950243
Bond Position:  [-14.17680071]


portfolio before change:  [-20.59531271]
curr_Stock_Price:  97.05263279787977
curr_Factors:  [97.0526328]
mat_Sqrt:  [[0.15]]
grads:  [-0.04793211]
Stock Position:  -0.047932111924833994
Bond Position:  [-15.94337505]


portfolio before change:  [-20.60351794]
curr_Stock_Price:  97.18223662502612
curr_Factors:  [97.18223663]
mat_Sqrt:  [[0.15]]
grads:  [-0.04395018]
Stock Position:  -0.04395017848306177
Bond Position:  [-16.3323413]


portfolio before change:  [-20.58345705]
curr_Stock_Price:  96.67933616513066
curr_Factors:  [96.67933617]
mat_Sqrt:  [[0.15]]
grads:  [0.13445592]
Stock Position:  0.1344559224918587
Bond Position:  [-33.58256638]


portfolio before change:  [-20.60547431]
curr_Stock_Price:  96.54680810268128
curr_Factors:  [96.5468081]
mat_Sqrt:  [[0.15]]
grads:  [0.06029566]
Stock Position:  0.0602956602444147
Bond Position:  [-26.42682785]


portfolio before change:  [-20.58117781]
curr_Stock_Price:  97.0045535726529
curr_Factors:  [97.00455357]
mat_Sqrt:  [[0.15]]
grads:  [0.14621791]
Stock Position:  0.14621790642823077
Bond Position:  [-34.76498054]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-20.58117781]
Stock Price:  97.36639573999892
PL:  [-20.58117781]
Settle:  Tensor("sub_94:0", shape=(), dtype=float64)
PL:  Tensor("sub_95:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  48
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.77646886e-03]
 [ 1.51987270e-03]
 [ 2.73557112e-03]
 [-7.31793389e-04]
 [ 6.95750524e-04]
 [ 2.83139102e-02]
 [ 1.13117541e-02]
 [-2.34921643e-04]
 [ 4.95580623e-03]
 [ 1.20760367e-02]
 [ 2.40992795e-02]
 [ 3.39882077e-03]
 [-1.19310688e-02]
 [ 1.11252389e-02]
 [-1.76253214e-03]
 [-2.72808276e-02]
 [ 3.92034868e-03]
 [ 1.68060219e-03]
 [-1.17448881e-02]
 [-2.22937213e-03]
 [ 2.58323982e-04]
 [-1.83778587e-03]
 [ 4.78217963e-03]
 [ 8.15592061e-03]
 [-5.50076603e-03]
 [-2.10582179e-03]
 [-2.71863963e-03]
 [-9.33129745e-03]
 [-9.08642956e-03]
 [ 2.33438443e-02]
 [-9.53890924e-03]
 [ 6.42982021e-03]
 [-1.26741492e-02]
 [-6.46749817e-03]
 [-5.44143293e-03]
 [-4.87269172e-03]
 [ 2.32880777e-02]
 [-1.74687139e-04]
 [ 2.08196473e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.4857298]
curr_Stock_Price:  100.74380322115985
curr_Factors:  [100.74380322]
mat_Sqrt:  [[0.15]]
grads:  [-0.01184313]
Stock Position:  -0.011843125709966918
Bond Position:  [14.67885132]


portfolio before change:  [13.47142644]
curr_Stock_Price:  102.10647778045531
curr_Factors:  [102.10647778]
mat_Sqrt:  [[0.15]]
grads:  [0.01013248]
Stock Position:  0.010132484680453012
Bond Position:  [12.43683412]


portfolio before change:  [13.45960159]
curr_Stock_Price:  100.78601669226659
curr_Factors:  [100.78601669]
mat_Sqrt:  [[0.15]]
grads:  [0.01823714]
Stock Position:  0.01823714077857266
Bond Position:  [11.62155282]


portfolio before change:  [13.45273309]
curr_Stock_Price:  100.3297345378604
curr_Factors:  [100.32973454]
mat_Sqrt:  [[0.15]]
grads:  [-0.00487862]
Stock Position:  -0.004878622595244446
Bond Position:  [13.942204]


portfolio before change:  [13.44672391]
curr_Stock_Price:  101.91872188419094
curr_Factors:  [101.91872188]
mat_Sqrt:  [[0.15]]
grads:  [0.00463834]
Stock Position:  0.004638336827167805
Bond Position:  [12.97399055]


portfolio before change:  [13.44549189]
curr_Stock_Price:  101.30344358290446
curr_Factors:  [101.30344358]
mat_Sqrt:  [[0.15]]
grads:  [0.1887594]
Stock Position:  0.1887594010459132
Bond Position:  [-5.67648544]


portfolio before change:  [13.53620479]
curr_Stock_Price:  101.78777711588762
curr_Factors:  [101.78777712]
mat_Sqrt:  [[0.15]]
grads:  [0.07541169]
Stock Position:  0.0754116941589107
Bond Position:  [5.86021608]


portfolio before change:  [13.53702964]
curr_Stock_Price:  101.78900065629576
curr_Factors:  [101.78900066]
mat_Sqrt:  [[0.15]]
grads:  [-0.00156614]
Stock Position:  -0.0015661442884378747
Bond Position:  [13.6964459]


portfolio before change:  [13.5391085]
curr_Stock_Price:  101.55485924645912
curr_Factors:  [101.55485925]
mat_Sqrt:  [[0.15]]
grads:  [0.03303871]
Stock Position:  0.033038708231979734
Bond Position:  [10.18386713]


portfolio before change:  [13.57017067]
curr_Stock_Price:  102.45650201188951
curr_Factors:  [102.45650201]
mat_Sqrt:  [[0.15]]
grads:  [0.08050691]
Stock Position:  0.08050691128331317
Bond Position:  [5.32171415]


portfolio before change:  [13.62955319]
curr_Stock_Price:  103.18584638402245
curr_Factors:  [103.18584638]
mat_Sqrt:  [[0.15]]
grads:  [0.16066186]
Stock Position:  0.16066186323956133
Bond Position:  [-2.94847715]


portfolio before change:  [13.49448002]
curr_Stock_Price:  102.34741100516023
curr_Factors:  [102.34741101]
mat_Sqrt:  [[0.15]]
grads:  [0.02265881]
Stock Position:  0.022658805131564253
Bond Position:  [11.17540998]


portfolio before change:  [13.49891719]
curr_Stock_Price:  102.48158217297645
curr_Factors:  [102.48158217]
mat_Sqrt:  [[0.15]]
grads:  [-0.07954046]
Stock Position:  -0.07954045866475422
Bond Position:  [21.65034924]


portfolio before change:  [13.52446069]
curr_Stock_Price:  102.19446996535166
curr_Factors:  [102.19446997]
mat_Sqrt:  [[0.15]]
grads:  [0.07416826]
Stock Position:  0.0741682591481392
Bond Position:  [5.94487476]


portfolio before change:  [13.57440183]
curr_Stock_Price:  102.8577992941602
curr_Factors:  [102.85779929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01175021]
Stock Position:  -0.011750214262710515
Bond Position:  [14.78300301]


portfolio before change:  [13.58788168]
curr_Stock_Price:  101.86787141390568
curr_Factors:  [101.86787141]
mat_Sqrt:  [[0.15]]
grads:  [-0.18187218]
Stock Position:  -0.18187218383636766
Bond Position:  [32.11481392]


portfolio before change:  [13.53160993]
curr_Stock_Price:  102.19934790455527
curr_Factors:  [102.1993479]
mat_Sqrt:  [[0.15]]
grads:  [0.02613566]
Stock Position:  0.026135657877015966
Bond Position:  [10.86056274]


portfolio before change:  [13.51573229]
curr_Stock_Price:  101.53989255727423
curr_Factors:  [101.53989256]
mat_Sqrt:  [[0.15]]
grads:  [0.01120401]
Stock Position:  0.01120401460163655
Bond Position:  [12.37807785]


portfolio before change:  [13.50644405]
curr_Stock_Price:  100.57277581615764
curr_Factors:  [100.57277582]
mat_Sqrt:  [[0.15]]
grads:  [-0.07829925]
Stock Position:  -0.07829925388320057
Bond Position:  [21.38121736]


portfolio before change:  [13.4784397]
curr_Stock_Price:  100.96456980070606
curr_Factors:  [100.9645698]
mat_Sqrt:  [[0.15]]
grads:  [-0.01486248]
Stock Position:  -0.014862480894414805
Bond Position:  [14.97902369]


portfolio before change:  [13.48038304]
curr_Stock_Price:  100.95980268923788
curr_Factors:  [100.95980269]
mat_Sqrt:  [[0.15]]
grads:  [0.00172216]
Stock Position:  0.001722159883218667
Bond Position:  [13.30651412]


portfolio before change:  [13.4824188]
curr_Stock_Price:  101.17601018904813
curr_Factors:  [101.17601019]
mat_Sqrt:  [[0.15]]
grads:  [-0.01225191]
Stock Position:  -0.012251905799532543
Bond Position:  [14.72201775]


portfolio before change:  [13.48264454]
curr_Stock_Price:  101.30779610925913
curr_Factors:  [101.30779611]
mat_Sqrt:  [[0.15]]
grads:  [0.0318812]
Stock Position:  0.03188119753724432
Bond Position:  [10.25283068]


portfolio before change:  [13.51505522]
curr_Stock_Price:  102.28420218023334
curr_Factors:  [102.28420218]
mat_Sqrt:  [[0.15]]
grads:  [0.0543728]
Stock Position:  0.05437280408553155
Bond Position:  [7.95357634]


portfolio before change:  [13.5769593]
curr_Stock_Price:  103.40442805428259
curr_Factors:  [103.40442805]
mat_Sqrt:  [[0.15]]
grads:  [-0.03667177]
Stock Position:  -0.036671773532033144
Bond Position:  [17.36898307]


portfolio before change:  [13.58144043]
curr_Stock_Price:  103.34144037416907
curr_Factors:  [103.34144037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01403881]
Stock Position:  -0.0140388119634985
Bond Position:  [15.03223148]


portfolio before change:  [13.58742248]
curr_Stock_Price:  103.04918617138729
curr_Factors:  [103.04918617]
mat_Sqrt:  [[0.15]]
grads:  [-0.01812426]
Stock Position:  -0.018124264171557575
Bond Position:  [15.45511315]


portfolio before change:  [13.5903675]
curr_Stock_Price:  102.99329356663702
curr_Factors:  [102.99329357]
mat_Sqrt:  [[0.15]]
grads:  [-0.06220865]
Stock Position:  -0.06220864969716305
Bond Position:  [19.99744122]


portfolio before change:  [13.65830828]
curr_Stock_Price:  101.94133469856575
curr_Factors:  [101.9413347]
mat_Sqrt:  [[0.15]]
grads:  [-0.0605762]
Stock Position:  -0.06057619704270027
Bond Position:  [19.83352666]


portfolio before change:  [13.62928282]
curr_Stock_Price:  102.46142031255472
curr_Factors:  [102.46142031]
mat_Sqrt:  [[0.15]]
grads:  [0.15562563]
Stock Position:  0.1556256286193925
Bond Position:  [-2.31634013]


portfolio before change:  [13.7353108]
curr_Stock_Price:  103.14458248879994
curr_Factors:  [103.14458249]
mat_Sqrt:  [[0.15]]
grads:  [-0.06359273]
Stock Position:  -0.06359272826048148
Bond Position:  [20.2945562]


portfolio before change:  [13.75870082]
curr_Stock_Price:  102.81666697095498
curr_Factors:  [102.81666697]
mat_Sqrt:  [[0.15]]
grads:  [0.04286547]
Stock Position:  0.04286546809798578
Bond Position:  [9.35141626]


portfolio before change:  [13.72777454]
curr_Stock_Price:  102.0679225586008
curr_Factors:  [102.06792256]
mat_Sqrt:  [[0.15]]
grads:  [-0.08449433]
Stock Position:  -0.08449432789892096
Bond Position:  [22.35193506]


portfolio before change:  [13.7729859]
curr_Stock_Price:  101.56591017847074
curr_Factors:  [101.56591018]
mat_Sqrt:  [[0.15]]
grads:  [-0.04311665]
Stock Position:  -0.04311665446250059
Bond Position:  [18.15216816]


portfolio before change:  [13.77094801]
curr_Stock_Price:  101.66580335025988
curr_Factors:  [101.66580335]
mat_Sqrt:  [[0.15]]
grads:  [-0.03627622]
Stock Position:  -0.03627621955704473
Bond Position:  [17.45899901]


portfolio before change:  [13.76382015]
curr_Stock_Price:  101.92245541255961
curr_Factors:  [101.92245541]
mat_Sqrt:  [[0.15]]
grads:  [-0.03248461]
Stock Position:  -0.03248461146755782
Bond Position:  [17.07473152]


portfolio before change:  [13.74966688]
curr_Stock_Price:  102.42385417813273
curr_Factors:  [102.42385418]
mat_Sqrt:  [[0.15]]
grads:  [0.15525385]
Stock Position:  0.1552538515035234
Bond Position:  [-2.15203096]


portfolio before change:  [13.80060861]
curr_Stock_Price:  102.75370587273868
curr_Factors:  [102.75370587]
mat_Sqrt:  [[0.15]]
grads:  [-0.00116458]
Stock Position:  -0.0011645809291750213
Bond Position:  [13.92027362]


portfolio before change:  [13.80099457]
curr_Stock_Price:  103.91651111219394
curr_Factors:  [103.91651111]
mat_Sqrt:  [[0.15]]
grads:  [0.13879765]
Stock Position:  0.13879764852847792
Bond Position:  [-0.62237281]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.80099457]
Stock Price:  103.17216563946675
PL:  [10.62882893]
Settle:  Tensor("sub_96:0", shape=(), dtype=float64)
PL:  Tensor("sub_97:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  49
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.32107106e-03]
 [-1.63083565e-03]
 [ 2.58671261e-03]
 [-2.80338168e-02]
 [ 1.10511597e-02]
 [ 2.40989336e-02]
 [ 1.56919259e-03]
 [-7.42815509e-03]
 [ 6.19464225e-03]
 [-1.97903303e-04]
 [-5.77374499e-03]
 [-5.12914689e-03]
 [ 6.63246764e-03]
 [ 1.08068700e-02]
 [ 3.76624496e-03]
 [-1.15508322e-02]
 [-5.37817459e-03]
 [-8.91705949e-04]
 [-7.54301242e-03]
 [-2.68303144e-03]
 [ 8.84205538e-04]
 [ 1.35031941e-02]
 [ 4.75847338e-03]
 [ 5.40067929e-03]
 [-1.05538359e-03]
 [-4.05049474e-03]
 [ 2.96477572e-03]
 [-1.95242411e-02]
 [-3.08383426e-02]
 [ 2.20295248e-02]
 [ 2.66106890e-03]
 [-7.25647986e-03]
 [-1.24560188e-02]
 [-8.65196763e-03]
 [-6.40390349e-03]
 [-3.67694680e-03]
 [ 1.81283026e-02]
 [ 1.09656981e-02]
 [ 1.93928215e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.75544599]
curr_Stock_Price:  99.1177144130108
curr_Factors:  [99.11771441]
mat_Sqrt:  [[0.15]]
grads:  [-0.03547381]
Stock Position:  -0.035473807086577804
Bond Position:  [-8.23936331]


portfolio before change:  [-11.75279324]
curr_Stock_Price:  99.01389857948372
curr_Factors:  [99.01389858]
mat_Sqrt:  [[0.15]]
grads:  [-0.01087224]
Stock Position:  -0.010872237659063158
Bond Position:  [-10.6762906]


portfolio before change:  [-11.75946838]
curr_Stock_Price:  99.5051061518188
curr_Factors:  [99.50510615]
mat_Sqrt:  [[0.15]]
grads:  [0.01724475]
Stock Position:  0.017244750752111987
Bond Position:  [-13.47540913]


portfolio before change:  [-11.78911935]
curr_Stock_Price:  97.88336983050696
curr_Factors:  [97.88336983]
mat_Sqrt:  [[0.15]]
grads:  [-0.18689211]
Stock Position:  -0.18689211215487284
Bond Position:  [6.50451038]


portfolio before change:  [-11.80996901]
curr_Stock_Price:  97.99928040592872
curr_Factors:  [97.99928041]
mat_Sqrt:  [[0.15]]
grads:  [0.0736744]
Stock Position:  0.0736743981444988
Bond Position:  [-19.03000701]


portfolio before change:  [-11.83158571]
curr_Stock_Price:  97.73816121189556
curr_Factors:  [97.73816121]
mat_Sqrt:  [[0.15]]
grads:  [0.16065956]
Stock Position:  0.1606595571359136
Bond Position:  [-27.5341554]


portfolio before change:  [-11.99248795]
curr_Stock_Price:  96.758074755775
curr_Factors:  [96.75807476]
mat_Sqrt:  [[0.15]]
grads:  [0.01046128]
Stock Position:  0.010461283960189194
Bond Position:  [-13.00470164]


portfolio before change:  [-11.98618895]
curr_Stock_Price:  97.51559967904655
curr_Factors:  [97.51559968]
mat_Sqrt:  [[0.15]]
grads:  [-0.04952103]
Stock Position:  -0.04952103393980652
Bond Position:  [-7.15711563]


portfolio before change:  [-11.97593274]
curr_Stock_Price:  97.29042444676476
curr_Factors:  [97.29042445]
mat_Sqrt:  [[0.15]]
grads:  [0.04129762]
Stock Position:  0.041297615009358836
Bond Position:  [-15.99379523]


portfolio before change:  [-11.94557826]
curr_Stock_Price:  98.07385547642137
curr_Factors:  [98.07385548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00131936]
Stock Position:  -0.0013193553559746655
Bond Position:  [-11.81618399]


portfolio before change:  [-11.94686386]
curr_Stock_Price:  97.92870377401164
curr_Factors:  [97.92870377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849163]
Stock Position:  -0.03849163329368535
Bond Position:  [-8.17742811]


portfolio before change:  [-11.9328626]
curr_Stock_Price:  97.53839805141783
curr_Factors:  [97.53839805]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419431]
Stock Position:  -0.034194312627426754
Bond Position:  [-8.59760413]


portfolio before change:  [-11.95254392]
curr_Stock_Price:  98.0825397068829
curr_Factors:  [98.08253971]
mat_Sqrt:  [[0.15]]
grads:  [0.04421645]
Stock Position:  0.044216450902323776
Bond Position:  [-16.28940572]


portfolio before change:  [-11.9463838]
curr_Stock_Price:  98.26791022528364
curr_Factors:  [98.26791023]
mat_Sqrt:  [[0.15]]
grads:  [0.0720458]
Stock Position:  0.07204579976392521
Bond Position:  [-19.02617398]


portfolio before change:  [-11.99392051]
curr_Stock_Price:  97.64111036881658
curr_Factors:  [97.64111037]
mat_Sqrt:  [[0.15]]
grads:  [0.0251083]
Stock Position:  0.025108299754593305
Bond Position:  [-14.44552278]


portfolio before change:  [-11.98580978]
curr_Stock_Price:  98.03606105209366
curr_Factors:  [98.03606105]
mat_Sqrt:  [[0.15]]
grads:  [-0.07700555]
Stock Position:  -0.07700554772746107
Bond Position:  [-4.4364892]


portfolio before change:  [-11.96617695]
curr_Stock_Price:  97.77390566600866
curr_Factors:  [97.77390567]
mat_Sqrt:  [[0.15]]
grads:  [-0.0358545]
Stock Position:  -0.03585449728341325
Bond Position:  [-8.46054272]


portfolio before change:  [-11.96285389]
curr_Stock_Price:  97.65172580001096
curr_Factors:  [97.6517258]
mat_Sqrt:  [[0.15]]
grads:  [-0.00594471]
Stock Position:  -0.00594470632420227
Bond Position:  [-11.38234306]


portfolio before change:  [-11.96559019]
curr_Stock_Price:  97.87266503796852
curr_Factors:  [97.87266504]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028675]
Stock Position:  -0.05028674948862258
Bond Position:  [-7.043892]


portfolio before change:  [-11.87181909]
curr_Stock_Price:  95.99042676095083
curr_Factors:  [95.99042676]
mat_Sqrt:  [[0.15]]
grads:  [-0.01788688]
Stock Position:  -0.017886876254689047
Bond Position:  [-10.1548502]


portfolio before change:  [-11.8646425]
curr_Stock_Price:  95.5182356541862
curr_Factors:  [95.51823565]
mat_Sqrt:  [[0.15]]
grads:  [0.0058947]
Stock Position:  0.005894703587539444
Bond Position:  [-12.42769418]


portfolio before change:  [-11.86108999]
curr_Stock_Price:  96.38444818266484
curr_Factors:  [96.38444818]
mat_Sqrt:  [[0.15]]
grads:  [0.09002129]
Stock Position:  0.09002129393990616
Bond Position:  [-20.53774273]


portfolio before change:  [-11.78878542]
curr_Stock_Price:  97.21616194598754
curr_Factors:  [97.21616195]
mat_Sqrt:  [[0.15]]
grads:  [0.03172316]
Stock Position:  0.03172315583887382
Bond Position:  [-14.87278888]


portfolio before change:  [-11.8158277]
curr_Stock_Price:  96.42232331917752
curr_Factors:  [96.42232332]
mat_Sqrt:  [[0.15]]
grads:  [0.03600453]
Stock Position:  0.03600452861981991
Bond Position:  [-15.287468]


portfolio before change:  [-11.79210526]
curr_Stock_Price:  97.13427528484581
curr_Factors:  [97.13427528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00703589]
Stock Position:  -0.0070358905815086446
Bond Position:  [-11.10867913]


portfolio before change:  [-11.7911138]
curr_Stock_Price:  96.79599047625398
curr_Factors:  [96.79599048]
mat_Sqrt:  [[0.15]]
grads:  [-0.0270033]
Stock Position:  -0.027003298268282693
Bond Position:  [-9.17730279]


portfolio before change:  [-11.75567613]
curr_Stock_Price:  95.44115978222332
curr_Factors:  [95.44115978]
mat_Sqrt:  [[0.15]]
grads:  [0.01976517]
Stock Position:  0.01976517146457278
Bond Position:  [-13.64208702]


portfolio before change:  [-11.72539957]
curr_Stock_Price:  97.05925520191269
curr_Factors:  [97.0592552]
mat_Sqrt:  [[0.15]]
grads:  [-0.13016161]
Stock Position:  -0.13016160766074306
Bond Position:  [0.90798913]


portfolio before change:  [-11.80038546]
curr_Stock_Price:  97.63622561228033
curr_Factors:  [97.63622561]
mat_Sqrt:  [[0.15]]
grads:  [-0.20558895]
Stock Position:  -0.20558895084564796
Bond Position:  [8.27254373]


portfolio before change:  [-11.79099375]
curr_Stock_Price:  97.59557374027526
curr_Factors:  [97.59557374]
mat_Sqrt:  [[0.15]]
grads:  [0.1468635]
Stock Position:  0.14686349849889394
Bond Position:  [-26.12422115]


portfolio before change:  [-12.03112479]
curr_Stock_Price:  95.98274749460667
curr_Factors:  [95.98274749]
mat_Sqrt:  [[0.15]]
grads:  [0.01774046]
Stock Position:  0.017740459332455945
Bond Position:  [-13.73390281]


portfolio before change:  [-12.03257456]
curr_Stock_Price:  95.99780162247343
curr_Factors:  [95.99780162]
mat_Sqrt:  [[0.15]]
grads:  [-0.04837653]
Stock Position:  -0.048376532417425774
Bond Position:  [-7.3885338]


portfolio before change:  [-12.03463817]
curr_Stock_Price:  96.02136632341193
curr_Factors:  [96.02136632]
mat_Sqrt:  [[0.15]]
grads:  [-0.08304013]
Stock Position:  -0.08304012526205994
Bond Position:  [-4.06101188]


portfolio before change:  [-11.99691332]
curr_Stock_Price:  95.56095634973829
curr_Factors:  [95.56095635]
mat_Sqrt:  [[0.15]]
grads:  [-0.05767978]
Stock Position:  -0.05767978420744057
Bond Position:  [-6.48497798]


portfolio before change:  [-11.96007441]
curr_Stock_Price:  94.90822181632784
curr_Factors:  [94.90822182]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269269]
Stock Position:  -0.04269268990208392
Bond Position:  [-7.90818713]


portfolio before change:  [-11.95203592]
curr_Stock_Price:  94.69677864720646
curr_Factors:  [94.69677865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02451298]
Stock Position:  -0.024512978651789617
Bond Position:  [-9.6307358]


portfolio before change:  [-11.9223354]
curr_Stock_Price:  93.43604119264543
curr_Factors:  [93.43604119]
mat_Sqrt:  [[0.15]]
grads:  [0.12085535]
Stock Position:  0.12085535072665943
Bond Position:  [-23.21458093]


portfolio before change:  [-11.80241712]
curr_Stock_Price:  94.45229975844161
curr_Factors:  [94.45229976]
mat_Sqrt:  [[0.15]]
grads:  [0.07310465]
Stock Position:  0.07310465421825445
Bond Position:  [-18.70731984]


portfolio before change:  [-11.7608368]
curr_Stock_Price:  95.05306696744762
curr_Factors:  [95.05306697]
mat_Sqrt:  [[0.15]]
grads:  [0.12928548]
Stock Position:  0.12928547662071221
Bond Position:  [-24.04981787]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.7608368]
Stock Price:  94.73132615827345
PL:  [-11.7608368]
Settle:  Tensor("sub_98:0", shape=(), dtype=float64)
PL:  Tensor("sub_99:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  50
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.25205017e-03]
 [-3.91465512e-03]
 [ 1.70798434e-02]
 [ 1.24726048e-02]
 [ 2.04638847e-02]
 [ 2.63763876e-02]
 [ 2.72522394e-02]
 [-3.06976451e-03]
 [ 1.23899055e-02]
 [ 2.38639901e-03]
 [ 7.92377852e-03]
 [ 1.17485582e-02]
 [ 3.42410365e-04]
 [ 1.25151088e-02]
 [-4.23879652e-03]
 [-9.52287840e-03]
 [-3.47978019e-03]
 [-6.83887891e-04]
 [-7.62497043e-03]
 [-2.36149377e-03]
 [ 3.34085710e-04]
 [ 7.36595102e-03]
 [ 4.77349241e-03]
 [ 7.43017529e-03]
 [-3.64999750e-03]
 [-6.02584975e-03]
 [ 6.43346269e-03]
 [-1.87185968e-02]
 [-1.11297997e-02]
 [ 2.23860109e-02]
 [-1.40078548e-02]
 [ 6.27400169e-03]
 [-1.30000745e-02]
 [-3.82691406e-03]
 [-5.52814447e-03]
 [-7.11232414e-04]
 [ 2.35737394e-02]
 [-1.79269409e-04]
 [ 2.20915683e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.00519139]
curr_Stock_Price:  99.42373565063819
curr_Factors:  [99.42373565]
mat_Sqrt:  [[0.15]]
grads:  [-0.028347]
Stock Position:  -0.02834700112785056
Bond Position:  [-4.18682664]


portfolio before change:  [-7.01768662]
curr_Stock_Price:  99.84606790888348
curr_Factors:  [99.84606791]
mat_Sqrt:  [[0.15]]
grads:  [-0.0260977]
Stock Position:  -0.026097700787840683
Bond Position:  [-4.41193382]


portfolio before change:  [-7.03462144]
curr_Stock_Price:  100.47383536693114
curr_Factors:  [100.47383537]
mat_Sqrt:  [[0.15]]
grads:  [0.11386562]
Stock Position:  0.11386562254027142
Bond Position:  [-18.47513725]


portfolio before change:  [-6.99124322]
curr_Stock_Price:  100.87507807655447
curr_Factors:  [100.87507808]
mat_Sqrt:  [[0.15]]
grads:  [0.0831507]
Stock Position:  0.08315069840753031
Bond Position:  [-15.37907642]


portfolio before change:  [-6.97796651]
curr_Stock_Price:  101.05786928047272
curr_Factors:  [101.05786928]
mat_Sqrt:  [[0.15]]
grads:  [0.1364259]
Stock Position:  0.1364258980045698
Bond Position:  [-20.76487708]


portfolio before change:  [-6.98913611]
curr_Stock_Price:  100.9950232399628
curr_Factors:  [100.99502324]
mat_Sqrt:  [[0.15]]
grads:  [0.17584258]
Stock Position:  0.17584258403192288
Bond Position:  [-24.74836197]


portfolio before change:  [-7.15757267]
curr_Stock_Price:  100.05473439476158
curr_Factors:  [100.05473439]
mat_Sqrt:  [[0.15]]
grads:  [0.1816816]
Stock Position:  0.18168159601857745
Bond Position:  [-25.3356765]


portfolio before change:  [-7.13491146]
curr_Stock_Price:  100.196897227929
curr_Factors:  [100.19689723]
mat_Sqrt:  [[0.15]]
grads:  [-0.0204651]
Stock Position:  -0.020465096713256945
Bond Position:  [-5.08437226]


portfolio before change:  [-7.12728959]
curr_Stock_Price:  99.79340767252685
curr_Factors:  [99.79340767]
mat_Sqrt:  [[0.15]]
grads:  [0.08259937]
Stock Position:  0.08259937020695547
Bond Position:  [-15.37016222]


portfolio before change:  [-7.08446185]
curr_Stock_Price:  100.33516879078333
curr_Factors:  [100.33516879]
mat_Sqrt:  [[0.15]]
grads:  [0.01590933]
Stock Position:  0.01590932672031272
Bond Position:  [-8.68072684]


portfolio before change:  [-7.087702]
curr_Stock_Price:  100.19971427835195
curr_Factors:  [100.19971428]
mat_Sqrt:  [[0.15]]
grads:  [0.05282519]
Stock Position:  0.05282519013962953
Bond Position:  [-12.38077096]


portfolio before change:  [-7.10156387]
curr_Stock_Price:  99.96660244062883
curr_Factors:  [99.96660244]
mat_Sqrt:  [[0.15]]
grads:  [0.07832372]
Stock Position:  0.07832372120699291
Bond Position:  [-14.93132017]


portfolio before change:  [-7.19536813]
curr_Stock_Price:  98.79278532017051
curr_Factors:  [98.79278532]
mat_Sqrt:  [[0.15]]
grads:  [0.00228274]
Stock Position:  0.002282735764308442
Bond Position:  [-7.42088595]


portfolio before change:  [-7.19284623]
curr_Stock_Price:  100.30394000394232
curr_Factors:  [100.30394]
mat_Sqrt:  [[0.15]]
grads:  [0.08343406]
Stock Position:  0.0834340586797424
Bond Position:  [-15.56161105]


portfolio before change:  [-7.2545955]
curr_Stock_Price:  99.58715897159229
curr_Factors:  [99.58715897]
mat_Sqrt:  [[0.15]]
grads:  [-0.02825864]
Stock Position:  -0.02825864345375314
Bond Position:  [-4.44039749]


portfolio before change:  [-7.23934]
curr_Stock_Price:  99.0276633381638
curr_Factors:  [99.02766334]
mat_Sqrt:  [[0.15]]
grads:  [-0.06348586]
Stock Position:  -0.06348585601086566
Bond Position:  [-0.95248403]


portfolio before change:  [-7.20200346]
curr_Stock_Price:  98.43767984060882
curr_Factors:  [98.43767984]
mat_Sqrt:  [[0.15]]
grads:  [-0.02319853]
Stock Position:  -0.023198534620186596
Bond Position:  [-4.91839354]


portfolio before change:  [-7.18170928]
curr_Stock_Price:  97.53637187042987
curr_Factors:  [97.53637187]
mat_Sqrt:  [[0.15]]
grads:  [-0.00455925]
Stock Position:  -0.004559252604829921
Bond Position:  [-6.73701632]


portfolio before change:  [-7.17891742]
curr_Stock_Price:  96.73930287447524
curr_Factors:  [96.73930287]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083314]
Stock Position:  -0.050833136229005274
Bond Position:  [-2.26135525]


portfolio before change:  [-7.26322854]
curr_Stock_Price:  98.392327688669
curr_Factors:  [98.39232769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01574329]
Stock Position:  -0.01574329177347111
Bond Position:  [-5.71420942]


portfolio before change:  [-7.26125788]
curr_Stock_Price:  98.22178038159228
curr_Factors:  [98.22178038]
mat_Sqrt:  [[0.15]]
grads:  [0.00222724]
Stock Position:  0.0022272380692863235
Bond Position:  [-7.48002117]


portfolio before change:  [-7.25670943]
curr_Stock_Price:  100.68380411448139
curr_Factors:  [100.68380411]
mat_Sqrt:  [[0.15]]
grads:  [0.04910634]
Stock Position:  0.0491063401055704
Bond Position:  [-12.20092256]


portfolio before change:  [-7.27693453]
curr_Stock_Price:  100.30300008938028
curr_Factors:  [100.30300009]
mat_Sqrt:  [[0.15]]
grads:  [0.03182328]
Stock Position:  0.031823282707425515
Bond Position:  [-10.46890526]


portfolio before change:  [-7.24234259]
curr_Stock_Price:  101.43112509344667
curr_Factors:  [101.43112509]
mat_Sqrt:  [[0.15]]
grads:  [0.0495345]
Stock Position:  0.04953450190423785
Bond Position:  [-12.26668285]


portfolio before change:  [-7.25993637]
curr_Stock_Price:  101.10689946648057
curr_Factors:  [101.10689947]
mat_Sqrt:  [[0.15]]
grads:  [-0.02433332]
Stock Position:  -0.02433331663699606
Bond Position:  [-4.79967018]


portfolio before change:  [-7.27845739]
curr_Stock_Price:  101.84338006626784
curr_Factors:  [101.84338007]
mat_Sqrt:  [[0.15]]
grads:  [-0.04017233]
Stock Position:  -0.04017233166822209
Bond Position:  [-3.18717134]


portfolio before change:  [-7.25812584]
curr_Stock_Price:  101.32735402411083
curr_Factors:  [101.32735402]
mat_Sqrt:  [[0.15]]
grads:  [0.04288975]
Stock Position:  0.04288975124140452
Bond Position:  [-11.60403085]


portfolio before change:  [-7.26092223]
curr_Stock_Price:  101.29597586209894
curr_Factors:  [101.29597586]
mat_Sqrt:  [[0.15]]
grads:  [-0.12479065]
Stock Position:  -0.12479064542160487
Bond Position:  [5.37986797]


portfolio before change:  [-7.32125093]
curr_Stock_Price:  101.78480429860173
curr_Factors:  [101.7848043]
mat_Sqrt:  [[0.15]]
grads:  [-0.07419866]
Stock Position:  -0.07419866438719952
Bond Position:  [0.23104561]


portfolio before change:  [-7.30912458]
curr_Stock_Price:  101.62176281055086
curr_Factors:  [101.62176281]
mat_Sqrt:  [[0.15]]
grads:  [0.14924007]
Stock Position:  0.14924007255049926
Bond Position:  [-22.47516384]


portfolio before change:  [-6.96768198]
curr_Stock_Price:  103.92846346198317
curr_Factors:  [103.92846346]
mat_Sqrt:  [[0.15]]
grads:  [-0.0933857]
Stock Position:  -0.09338569893067286
Bond Position:  [2.73775022]


portfolio before change:  [-6.93393156]
curr_Stock_Price:  103.57071937230093
curr_Factors:  [103.57071937]
mat_Sqrt:  [[0.15]]
grads:  [0.04182668]
Stock Position:  0.041826677910417484
Bond Position:  [-11.26595068]


portfolio before change:  [-6.91085993]
curr_Stock_Price:  104.15599086461198
curr_Factors:  [104.15599086]
mat_Sqrt:  [[0.15]]
grads:  [-0.08666716]
Stock Position:  -0.08666716322215501
Bond Position:  [2.11604433]


portfolio before change:  [-6.78938042]
curr_Stock_Price:  102.75736439330537
curr_Factors:  [102.75736439]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551276]
Stock Position:  -0.025512760429521907
Bond Position:  [-4.1677564]


portfolio before change:  [-6.78688807]
curr_Stock_Price:  102.63925274659475
curr_Factors:  [102.63925275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0368543]
Stock Position:  -0.03685429647383147
Bond Position:  [-3.00419061]


portfolio before change:  [-6.83474582]
curr_Stock_Price:  103.92762911466012
curr_Factors:  [103.92762911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474155]
Stock Position:  -0.004741549428172957
Bond Position:  [-6.34196783]


portfolio before change:  [-6.83356392]
curr_Stock_Price:  103.51116318963678
curr_Factors:  [103.51116319]
mat_Sqrt:  [[0.15]]
grads:  [0.15715826]
Stock Position:  0.1571582626571596
Bond Position:  [-23.10119849]


portfolio before change:  [-6.95135564]
curr_Stock_Price:  102.78002831405189
curr_Factors:  [102.78002831]
mat_Sqrt:  [[0.15]]
grads:  [-0.00119513]
Stock Position:  -0.0011951293947968491
Bond Position:  [-6.8285202]


portfolio before change:  [-6.95170073]
curr_Stock_Price:  102.35452756702668
curr_Factors:  [102.35452757]
mat_Sqrt:  [[0.15]]
grads:  [0.14727712]
Stock Position:  0.14727712219761951
Bond Position:  [-22.02618099]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.95170073]
Stock Price:  101.70305548566441
PL:  [-8.65475621]
Settle:  Tensor("sub_100:0", shape=(), dtype=float64)
PL:  Tensor("sub_101:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  51
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.40678113e-03]
 [ 2.53616406e-03]
 [ 2.24588070e-02]
 [ 2.11848977e-02]
 [-1.19520227e-03]
 [ 3.35796421e-02]
 [ 5.44264194e-03]
 [ 2.07363431e-03]
 [ 1.42181824e-02]
 [ 1.35232452e-02]
 [ 1.85264716e-02]
 [-1.52586431e-02]
 [-1.13055361e-02]
 [-2.99575816e-02]
 [ 6.61710301e-03]
 [-3.70873675e-02]
 [ 4.87564494e-03]
 [-1.38899311e-02]
 [ 1.59993030e-02]
 [-5.13709461e-03]
 [-2.99782932e-03]
 [-3.94064590e-02]
 [ 4.81985322e-03]
 [ 9.96929234e-03]
 [-5.57223754e-03]
 [ 9.40532337e-03]
 [-7.06771306e-03]
 [-9.44798879e-03]
 [ 1.12066050e-03]
 [ 2.25069844e-02]
 [ 5.14323006e-03]
 [ 6.59600156e-03]
 [-1.27835245e-02]
 [-6.39859719e-03]
 [-5.53771271e-03]
 [-5.56157105e-03]
 [ 2.27616177e-02]
 [ 7.30768574e-03]
 [ 2.34360603e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.10811638]
curr_Stock_Price:  99.73921536243667
curr_Factors:  [99.73921536]
mat_Sqrt:  [[0.15]]
grads:  [-0.01604521]
Stock Position:  -0.016045207547489827
Bond Position:  [-0.50777997]


portfolio before change:  [-2.10697689]
curr_Stock_Price:  99.66424222178928
curr_Factors:  [99.66424222]
mat_Sqrt:  [[0.15]]
grads:  [0.01690776]
Stock Position:  0.01690776036844977
Bond Position:  [-3.79207602]


portfolio before change:  [-2.09751495]
curr_Stock_Price:  100.25190007530273
curr_Factors:  [100.25190008]
mat_Sqrt:  [[0.15]]
grads:  [0.14972538]
Stock Position:  0.14972537992171583
Bond Position:  [-17.10776878]


portfolio before change:  [-1.96785387]
curr_Stock_Price:  101.13217627210767
curr_Factors:  [101.13217627]
mat_Sqrt:  [[0.15]]
grads:  [0.14123265]
Stock Position:  0.1412326511052884
Bond Position:  [-16.25101924]


portfolio before change:  [-1.85099089]
curr_Stock_Price:  101.97401051394993
curr_Factors:  [101.97401051]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796802]
Stock Position:  -0.00796801513023177
Bond Position:  [-1.03846044]


portfolio before change:  [-1.8552468]
curr_Stock_Price:  102.491842622215
curr_Factors:  [102.49184262]
mat_Sqrt:  [[0.15]]
grads:  [0.22386428]
Stock Position:  0.2238642809322336
Bond Position:  [-24.79950945]


portfolio before change:  [-1.78894713]
curr_Stock_Price:  102.8018510222898
curr_Factors:  [102.80185102]
mat_Sqrt:  [[0.15]]
grads:  [0.03628428]
Stock Position:  0.03628427961962693
Bond Position:  [-5.51903824]


portfolio before change:  [-1.75787911]
curr_Stock_Price:  103.67710450990509
curr_Factors:  [103.67710451]
mat_Sqrt:  [[0.15]]
grads:  [0.01382423]
Stock Position:  0.013824228759505067
Bond Position:  [-3.19113512]


portfolio before change:  [-1.75229938]
curr_Stock_Price:  104.10958071141053
curr_Factors:  [104.10958071]
mat_Sqrt:  [[0.15]]
grads:  [0.09478788]
Stock Position:  0.09478788253349382
Bond Position:  [-11.62062608]


portfolio before change:  [-1.74376095]
curr_Stock_Price:  104.21498546868386
curr_Factors:  [104.21498547]
mat_Sqrt:  [[0.15]]
grads:  [0.09015497]
Stock Position:  0.09015496829339646
Bond Position:  [-11.13925966]


portfolio before change:  [-1.74203684]
curr_Stock_Price:  104.24955491158296
curr_Factors:  [104.24955491]
mat_Sqrt:  [[0.15]]
grads:  [0.12350981]
Stock Position:  0.12350981075922529
Bond Position:  [-14.61787964]


portfolio before change:  [-1.6545245]
curr_Stock_Price:  104.97289570889271
curr_Factors:  [104.97289571]
mat_Sqrt:  [[0.15]]
grads:  [-0.10172429]
Stock Position:  -0.10172428713162761
Bond Position:  [9.02376848]


portfolio before change:  [-1.78744841]
curr_Stock_Price:  106.29069258637938
curr_Factors:  [106.29069259]
mat_Sqrt:  [[0.15]]
grads:  [-0.07537024]
Stock Position:  -0.07537024039472254
Bond Position:  [6.22370664]


portfolio before change:  [-1.91453781]
curr_Stock_Price:  107.98721651740917
curr_Factors:  [107.98721652]
mat_Sqrt:  [[0.15]]
grads:  [-0.19971721]
Stock Position:  -0.19971721050307809
Bond Position:  [19.65236784]


portfolio before change:  [-1.59530475]
curr_Stock_Price:  106.40109201643257
curr_Factors:  [106.40109202]
mat_Sqrt:  [[0.15]]
grads:  [0.04411402]
Stock Position:  0.044114020074953984
Bond Position:  [-6.28908466]


portfolio before change:  [-1.5767479]
curr_Stock_Price:  106.83957022486103
curr_Factors:  [106.83957022]
mat_Sqrt:  [[0.15]]
grads:  [-0.24724912]
Stock Position:  -0.24724911671426283
Bond Position:  [24.83924147]


portfolio before change:  [-1.63432304]
curr_Stock_Price:  107.08499167576039
curr_Factors:  [107.08499168]
mat_Sqrt:  [[0.15]]
grads:  [0.0325043]
Stock Position:  0.03250429960958981
Bond Position:  [-5.11504569]


portfolio before change:  [-1.6484777]
curr_Stock_Price:  106.66919304772871
curr_Factors:  [106.66919305]
mat_Sqrt:  [[0.15]]
grads:  [-0.09259954]
Stock Position:  -0.09259954083442364
Bond Position:  [8.22904059]


portfolio before change:  [-1.65389461]
curr_Stock_Price:  106.73880030036959
curr_Factors:  [106.7388003]
mat_Sqrt:  [[0.15]]
grads:  [0.10666202]
Stock Position:  0.10666202030893147
Bond Position:  [-13.03887069]


portfolio before change:  [-1.61386473]
curr_Stock_Price:  107.1293783216115
curr_Factors:  [107.12937832]
mat_Sqrt:  [[0.15]]
grads:  [-0.0342473]
Stock Position:  -0.034247297373605975
Bond Position:  [2.05502695]


portfolio before change:  [-1.60252241]
curr_Stock_Price:  106.80569083229894
curr_Factors:  [106.80569083]
mat_Sqrt:  [[0.15]]
grads:  [-0.01998553]
Stock Position:  -0.019985528802805533
Bond Position:  [0.5320458]


portfolio before change:  [-1.57918744]
curr_Stock_Price:  105.64142530408763
curr_Factors:  [105.6414253]
mat_Sqrt:  [[0.15]]
grads:  [-0.26270973]
Stock Position:  -0.26270972655482333
Bond Position:  [26.17384251]


portfolio before change:  [-1.31639844]
curr_Stock_Price:  104.65357811246581
curr_Factors:  [104.65357811]
mat_Sqrt:  [[0.15]]
grads:  [0.03213235]
Stock Position:  0.0321323548292475
Bond Position:  [-4.67916435]


portfolio before change:  [-1.32930403]
curr_Stock_Price:  104.27014338006782
curr_Factors:  [104.27014338]
mat_Sqrt:  [[0.15]]
grads:  [0.06646195]
Stock Position:  0.06646194890032482
Bond Position:  [-8.25930097]


portfolio before change:  [-1.28988124]
curr_Stock_Price:  104.87884161529834
curr_Factors:  [104.87884162]
mat_Sqrt:  [[0.15]]
grads:  [-0.03714825]
Stock Position:  -0.03714825027863295
Bond Position:  [2.60618422]


portfolio before change:  [-1.31679093]
curr_Stock_Price:  105.61199810447422
curr_Factors:  [105.6119981]
mat_Sqrt:  [[0.15]]
grads:  [0.06270216]
Stock Position:  0.06270215577028058
Bond Position:  [-7.93889088]


portfolio before change:  [-1.38802943]
curr_Stock_Price:  104.49168452845193
curr_Factors:  [104.49168453]
mat_Sqrt:  [[0.15]]
grads:  [-0.04711809]
Stock Position:  -0.047118087070696715
Bond Position:  [3.53541886]


portfolio before change:  [-1.31613498]
curr_Stock_Price:  102.97522888519073
curr_Factors:  [102.97522889]
mat_Sqrt:  [[0.15]]
grads:  [-0.06298659]
Stock Position:  -0.06298659194954856
Bond Position:  [5.16992374]


portfolio before change:  [-1.29801208]
curr_Stock_Price:  102.69776315493843
curr_Factors:  [102.69776315]
mat_Sqrt:  [[0.15]]
grads:  [0.00747107]
Stock Position:  0.007471069995638319
Bond Position:  [-2.06527426]


portfolio before change:  [-1.30503434]
curr_Stock_Price:  101.79239243776111
curr_Factors:  [101.79239244]
mat_Sqrt:  [[0.15]]
grads:  [0.15004656]
Stock Position:  0.15004656299692287
Bond Position:  [-16.57863297]


portfolio before change:  [-1.3711912]
curr_Stock_Price:  101.36529571261009
curr_Factors:  [101.36529571]
mat_Sqrt:  [[0.15]]
grads:  [0.0342882]
Stock Position:  0.03428820040580881
Bond Position:  [-4.84682477]


portfolio before change:  [-1.35076415]
curr_Stock_Price:  101.97871193526852
curr_Factors:  [101.97871194]
mat_Sqrt:  [[0.15]]
grads:  [0.04397334]
Stock Position:  0.043973343760713775
Bond Position:  [-5.83510911]


portfolio before change:  [-1.32248944]
curr_Stock_Price:  102.6382967621578
curr_Factors:  [102.63829676]
mat_Sqrt:  [[0.15]]
grads:  [-0.0852235]
Stock Position:  -0.08522349678514005
Bond Position:  [7.42470512]


portfolio before change:  [-1.23408333]
curr_Stock_Price:  101.61184323203194
curr_Factors:  [101.61184323]
mat_Sqrt:  [[0.15]]
grads:  [-0.04265731]
Stock Position:  -0.042657314623616056
Bond Position:  [3.10040504]


portfolio before change:  [-1.20955584]
curr_Stock_Price:  101.04593988035413
curr_Factors:  [101.04593988]
mat_Sqrt:  [[0.15]]
grads:  [-0.03691808]
Stock Position:  -0.03691808476055373
Bond Position:  [2.52086674]


portfolio before change:  [-1.23090054]
curr_Stock_Price:  101.63263960284237
curr_Factors:  [101.6326396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03707714]
Stock Position:  -0.03707714032311997
Bond Position:  [2.5373471]


portfolio before change:  [-1.18740872]
curr_Stock_Price:  100.46818528449982
curr_Factors:  [100.46818528]
mat_Sqrt:  [[0.15]]
grads:  [0.15174412]
Stock Position:  0.1517441182140308
Bond Position:  [-16.4328649]


portfolio before change:  [-1.25702788]
curr_Stock_Price:  100.02292963971826
curr_Factors:  [100.02292964]
mat_Sqrt:  [[0.15]]
grads:  [0.0487179]
Stock Position:  0.048717904928596276
Bond Position:  [-6.12993545]


portfolio before change:  [-1.21442504]
curr_Stock_Price:  100.91313890301609
curr_Factors:  [100.9131389]
mat_Sqrt:  [[0.15]]
grads:  [0.1562404]
Stock Position:  0.15624040169098255
Bond Position:  [-16.98113439]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.21442504]
Stock Price:  102.14553312121595
PL:  [-3.35995816]
Settle:  Tensor("sub_102:0", shape=(), dtype=float64)
PL:  Tensor("sub_103:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  52
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.52419173e-03]
 [-7.18666615e-03]
 [-3.55228828e-02]
 [-2.50607571e-02]
 [ 1.43816411e-02]
 [ 2.35889207e-02]
 [ 1.41644783e-03]
 [-5.84093836e-03]
 [ 1.28255722e-02]
 [-2.04741172e-04]
 [-3.78760766e-02]
 [-1.16994940e-02]
 [ 1.28437160e-02]
 [-2.94491283e-04]
 [ 1.25853634e-02]
 [-1.13699134e-02]
 [-9.28690728e-03]
 [ 2.38250700e-05]
 [-7.63428873e-03]
 [-2.49751159e-03]
 [ 4.27246885e-04]
 [ 9.99929439e-03]
 [ 4.76113201e-03]
 [ 5.66402153e-03]
 [-3.64199613e-03]
 [-7.33539220e-03]
 [ 1.45019541e-02]
 [-2.09083687e-02]
 [-2.20473342e-02]
 [ 2.15463964e-02]
 [ 9.20820080e-03]
 [ 1.96482478e-03]
 [-1.25140074e-02]
 [-6.52693589e-03]
 [-7.71801903e-03]
 [-7.43569874e-03]
 [ 2.26895611e-02]
 [ 8.24745008e-03]
 [ 2.37502952e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.49978074]
curr_Stock_Price:  100.48702013006712
curr_Factors:  [100.48702013]
mat_Sqrt:  [[0.15]]
grads:  [-0.01016128]
Stock Position:  -0.01016127818922555
Bond Position:  [10.52085731]


portfolio before change:  [9.5229445]
curr_Stock_Price:  98.33684161044434
curr_Factors:  [98.33684161]
mat_Sqrt:  [[0.15]]
grads:  [-0.04791111]
Stock Position:  -0.047911107660170565
Bond Position:  [14.2343715]


portfolio before change:  [9.54301695]
curr_Stock_Price:  97.9550292951399
curr_Factors:  [97.9550293]
mat_Sqrt:  [[0.15]]
grads:  [-0.23681922]
Stock Position:  -0.23681921880868803
Bond Position:  [32.74065047]


portfolio before change:  [9.43626849]
curr_Stock_Price:  98.42307114088966
curr_Factors:  [98.42307114]
mat_Sqrt:  [[0.15]]
grads:  [-0.16707171]
Stock Position:  -0.16707171400134205
Bond Position:  [25.87997968]


portfolio before change:  [9.39088977]
curr_Stock_Price:  98.71404747833756
curr_Factors:  [98.71404748]
mat_Sqrt:  [[0.15]]
grads:  [0.09587761]
Stock Position:  0.0958776073805349
Bond Position:  [-0.07357692]


portfolio before change:  [9.31926232]
curr_Stock_Price:  97.96707165839567
curr_Factors:  [97.96707166]
mat_Sqrt:  [[0.15]]
grads:  [0.15725947]
Stock Position:  0.15725947154322553
Bond Position:  [-6.0869876]


portfolio before change:  [9.12008444]
curr_Stock_Price:  96.70535457803217
curr_Factors:  [96.70535458]
mat_Sqrt:  [[0.15]]
grads:  [0.00944299]
Stock Position:  0.009442985553757832
Bond Position:  [8.20689717]


portfolio before change:  [9.13297868]
curr_Stock_Price:  97.96219405484611
curr_Factors:  [97.96219405]
mat_Sqrt:  [[0.15]]
grads:  [-0.03893959]
Stock Position:  -0.03893958908621443
Bond Position:  [12.94758626]


portfolio before change:  [9.1222984]
curr_Stock_Price:  98.27803786641832
curr_Factors:  [98.27803787]
mat_Sqrt:  [[0.15]]
grads:  [0.08550381]
Stock Position:  0.08550381466578118
Bond Position:  [0.71915127]


portfolio before change:  [9.10592528]
curr_Stock_Price:  98.08549649478995
curr_Factors:  [98.08549649]
mat_Sqrt:  [[0.15]]
grads:  [-0.00136494]
Stock Position:  -0.0013649411479144807
Bond Position:  [9.23980621]


portfolio before change:  [9.10841639]
curr_Stock_Price:  97.10665618142136
curr_Factors:  [97.10665618]
mat_Sqrt:  [[0.15]]
grads:  [-0.25250718]
Stock Position:  -0.2525071772956812
Bond Position:  [33.62854404]


portfolio before change:  [9.23549251]
curr_Stock_Price:  96.62004707090875
curr_Factors:  [96.62004707]
mat_Sqrt:  [[0.15]]
grads:  [-0.07799663]
Stock Position:  -0.07799662649969973
Bond Position:  [16.77153023]


portfolio before change:  [9.29883552]
curr_Stock_Price:  95.83480241305604
curr_Factors:  [95.83480241]
mat_Sqrt:  [[0.15]]
grads:  [0.08562477]
Stock Position:  0.08562477326528611
Bond Position:  [1.09300229]


portfolio before change:  [9.2257225]
curr_Stock_Price:  94.97932978598021
curr_Factors:  [94.97932979]
mat_Sqrt:  [[0.15]]
grads:  [-0.00196328]
Stock Position:  -0.0019632752222327582
Bond Position:  [9.41219307]


portfolio before change:  [9.22468258]
curr_Stock_Price:  96.10832016651413
curr_Factors:  [96.10832017]
mat_Sqrt:  [[0.15]]
grads:  [0.08390242]
Stock Position:  0.08390242265517685
Bond Position:  [1.16096168]


portfolio before change:  [9.29184869]
curr_Stock_Price:  96.90711694953112
curr_Factors:  [96.90711695]
mat_Sqrt:  [[0.15]]
grads:  [-0.07579942]
Stock Position:  -0.07579942237317897
Bond Position:  [16.63735218]


portfolio before change:  [9.33978413]
curr_Stock_Price:  96.30215674820404
curr_Factors:  [96.30215675]
mat_Sqrt:  [[0.15]]
grads:  [-0.06191272]
Stock Position:  -0.06191271518268364
Bond Position:  [15.30211213]


portfolio before change:  [9.31946315]
curr_Stock_Price:  96.66127300335985
curr_Factors:  [96.661273]
mat_Sqrt:  [[0.15]]
grads:  [0.00015883]
Stock Position:  0.00015883380028024777
Bond Position:  [9.30411007]


portfolio before change:  [9.32061296]
curr_Stock_Price:  96.57771842813452
curr_Factors:  [96.57771843]
mat_Sqrt:  [[0.15]]
grads:  [-0.05089526]
Stock Position:  -0.0508952582320514
Bond Position:  [14.23596088]


portfolio before change:  [9.29457358]
curr_Stock_Price:  97.12431146621971
curr_Factors:  [97.12431147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01665008]
Stock Position:  -0.016650077263003462
Bond Position:  [10.91170087]


portfolio before change:  [9.28677726]
curr_Stock_Price:  97.6744809608302
curr_Factors:  [97.67448096]
mat_Sqrt:  [[0.15]]
grads:  [0.00284831]
Stock Position:  0.002848312567949629
Bond Position:  [9.00856981]


portfolio before change:  [9.2878595]
curr_Stock_Price:  97.65906752655869
curr_Factors:  [97.65906753]
mat_Sqrt:  [[0.15]]
grads:  [0.06666196]
Stock Position:  0.06666196262255969
Bond Position:  [2.77771439]


portfolio before change:  [9.29184621]
curr_Stock_Price:  97.71366354752544
curr_Factors:  [97.71366355]
mat_Sqrt:  [[0.15]]
grads:  [0.03174088]
Stock Position:  0.031740880061839165
Bond Position:  [6.19032854]


portfolio before change:  [9.29927354]
curr_Stock_Price:  97.92328241194224
curr_Factors:  [97.92328241]
mat_Sqrt:  [[0.15]]
grads:  [0.03776014]
Stock Position:  0.03776014355949735
Bond Position:  [5.60167634]


portfolio before change:  [9.31958118]
curr_Stock_Price:  98.44254386397911
curr_Factors:  [98.44254386]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427997]
Stock Position:  -0.024279974175414467
Bond Position:  [11.7097636]


portfolio before change:  [9.30497922]
curr_Stock_Price:  99.1042320993775
curr_Factors:  [99.1042321]
mat_Sqrt:  [[0.15]]
grads:  [-0.04890261]
Stock Position:  -0.04890261468134727
Bond Position:  [14.15143529]


portfolio before change:  [9.27571519]
curr_Stock_Price:  99.7388212812823
curr_Factors:  [99.73882128]
mat_Sqrt:  [[0.15]]
grads:  [0.09667969]
Stock Position:  0.09667969389498447
Bond Position:  [-0.36700352]


portfolio before change:  [9.32077408]
curr_Stock_Price:  100.20535943909425
curr_Factors:  [100.20535944]
mat_Sqrt:  [[0.15]]
grads:  [-0.13938912]
Stock Position:  -0.13938912493743544
Bond Position:  [23.28831144]


portfolio before change:  [9.35446889]
curr_Stock_Price:  99.9845130202748
curr_Factors:  [99.98451302]
mat_Sqrt:  [[0.15]]
grads:  [-0.14698223]
Stock Position:  -0.146982227951508
Bond Position:  [24.05041537]


portfolio before change:  [9.38093857]
curr_Stock_Price:  99.82488012964328
curr_Factors:  [99.82488013]
mat_Sqrt:  [[0.15]]
grads:  [0.14364264]
Stock Position:  0.14364264259557716
Bond Position:  [-4.958171]


portfolio before change:  [9.38138738]
curr_Stock_Price:  99.8323195157787
curr_Factors:  [99.83231952]
mat_Sqrt:  [[0.15]]
grads:  [0.06138801]
Stock Position:  0.06138800533887299
Bond Position:  [3.25288041]


portfolio before change:  [9.3970689]
curr_Stock_Price:  100.08114480067952
curr_Factors:  [100.0811448]
mat_Sqrt:  [[0.15]]
grads:  [0.01309883]
Stock Position:  0.013098831853006466
Bond Position:  [8.08612281]


portfolio before change:  [9.39415202]
curr_Stock_Price:  99.78129296315417
curr_Factors:  [99.78129296]
mat_Sqrt:  [[0.15]]
grads:  [-0.08342672]
Stock Position:  -0.08342671615776313
Bond Position:  [17.71857763]


portfolio before change:  [9.41415748]
curr_Stock_Price:  99.56804592588603
curr_Factors:  [99.56804593]
mat_Sqrt:  [[0.15]]
grads:  [-0.04351291]
Stock Position:  -0.0435129059605863
Bond Position:  [13.7466525]


portfolio before change:  [9.40395557]
curr_Stock_Price:  99.84199564685142
curr_Factors:  [99.84199565]
mat_Sqrt:  [[0.15]]
grads:  [-0.05145346]
Stock Position:  -0.05145346019010437
Bond Position:  [14.54117172]


portfolio before change:  [9.38105401]
curr_Stock_Price:  100.32241671137174
curr_Factors:  [100.32241671]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957132]
Stock Position:  -0.049571324900881515
Bond Position:  [14.35416912]


portfolio before change:  [9.39745256]
curr_Stock_Price:  100.0278074672238
curr_Factors:  [100.02780747]
mat_Sqrt:  [[0.15]]
grads:  [0.15126374]
Stock Position:  0.15126374075700694
Bond Position:  [-5.73312778]


portfolio before change:  [9.22197067]
curr_Stock_Price:  98.87244000031541
curr_Factors:  [98.87244]
mat_Sqrt:  [[0.15]]
grads:  [0.054983]
Stock Position:  0.05498300054994678
Bond Position:  [3.78566725]


portfolio before change:  [9.27069301]
curr_Stock_Price:  99.74996764920185
curr_Factors:  [99.74996765]
mat_Sqrt:  [[0.15]]
grads:  [0.1583353]
Stock Position:  0.15833530141585303
Bond Position:  [-6.52324818]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.27069301]
Stock Price:  98.5733535109372
PL:  [9.27069301]
Settle:  Tensor("sub_104:0", shape=(), dtype=float64)
PL:  Tensor("sub_105:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  53
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.72910235e-03]
 [-1.60139935e-03]
 [ 2.17275436e-02]
 [-6.40448649e-04]
 [ 5.53322910e-03]
 [ 2.16783436e-02]
 [ 2.60516292e-02]
 [-2.83143652e-03]
 [ 4.85837858e-03]
 [ 7.58912124e-03]
 [ 1.31928754e-02]
 [ 1.02267554e-02]
 [-1.22680056e-02]
 [ 1.11931621e-02]
 [-7.06237910e-03]
 [-2.32051394e-02]
 [ 3.48203607e-03]
 [-3.21141742e-03]
 [-8.57101055e-03]
 [-2.40188369e-03]
 [ 3.16473494e-04]
 [ 8.90916279e-03]
 [ 4.76718199e-03]
 [ 5.71919756e-03]
 [-2.03438725e-03]
 [-4.98289206e-03]
 [-2.15659943e-03]
 [-1.88255728e-02]
 [-2.89676212e-02]
 [ 2.17379652e-02]
 [ 2.67305030e-03]
 [-6.22295537e-03]
 [-1.25301015e-02]
 [-1.00487366e-02]
 [-6.49070917e-03]
 [-4.55354828e-03]
 [ 1.88886658e-02]
 [ 1.15387643e-02]
 [ 1.74685749e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.23832813]
curr_Stock_Price:  99.34429442843745
curr_Factors:  [99.34429443]
mat_Sqrt:  [[0.15]]
grads:  [-0.03152735]
Stock Position:  -0.031527348981365444
Bond Position:  [-5.10626589]


portfolio before change:  [-8.22865028]
curr_Stock_Price:  99.01708100360003
curr_Factors:  [99.017081]
mat_Sqrt:  [[0.15]]
grads:  [-0.010676]
Stock Position:  -0.010675995646296479
Bond Position:  [-7.17154435]


portfolio before change:  [-8.24311943]
curr_Stock_Price:  100.28840493897454
curr_Factors:  [100.28840494]
mat_Sqrt:  [[0.15]]
grads:  [0.14485029]
Stock Position:  0.14485029061675012
Bond Position:  [-22.76992403]


portfolio before change:  [-8.2385727]
curr_Stock_Price:  100.33944482280273
curr_Factors:  [100.33944482]
mat_Sqrt:  [[0.15]]
grads:  [-0.00426966]
Stock Position:  -0.00426965766033813
Bond Position:  [-7.81015762]


portfolio before change:  [-8.23753806]
curr_Stock_Price:  99.86845383739146
curr_Factors:  [99.86845384]
mat_Sqrt:  [[0.15]]
grads:  [0.03688819]
Stock Position:  0.03688819403250325
Bond Position:  [-11.92150497]


portfolio before change:  [-8.27753418]
curr_Stock_Price:  98.82460117603094
curr_Factors:  [98.82460118]
mat_Sqrt:  [[0.15]]
grads:  [0.14452229]
Stock Position:  0.14452229068147254
Bond Position:  [-22.55989192]


portfolio before change:  [-8.01845483]
curr_Stock_Price:  100.63677501659743
curr_Factors:  [100.63677502]
mat_Sqrt:  [[0.15]]
grads:  [0.17367753]
Stock Position:  0.17367752803442174
Bond Position:  [-25.49680115]


portfolio before change:  [-8.05754374]
curr_Stock_Price:  100.4300608317753
curr_Factors:  [100.43006083]
mat_Sqrt:  [[0.15]]
grads:  [-0.01887624]
Stock Position:  -0.0188762434453994
Bond Position:  [-6.16180146]


portfolio before change:  [-8.07914452]
curr_Stock_Price:  101.53359126475728
curr_Factors:  [101.53359126]
mat_Sqrt:  [[0.15]]
grads:  [0.03238919]
Stock Position:  0.03238919055596482
Bond Position:  [-11.36773536]


portfolio before change:  [-8.10296445]
curr_Stock_Price:  100.84203726350341
curr_Factors:  [100.84203726]
mat_Sqrt:  [[0.15]]
grads:  [0.05059414]
Stock Position:  0.05059414159028259
Bond Position:  [-13.20498076]


portfolio before change:  [-8.12235649]
curr_Stock_Price:  100.4913779137075
curr_Factors:  [100.49137791]
mat_Sqrt:  [[0.15]]
grads:  [0.0879525]
Stock Position:  0.08795250290148038
Bond Position:  [-16.96082469]


portfolio before change:  [-8.08123298]
curr_Stock_Price:  100.98304945279932
curr_Factors:  [100.98304945]
mat_Sqrt:  [[0.15]]
grads:  [0.06817837]
Stock Position:  0.06817836903705735
Bond Position:  [-14.96609259]


portfolio before change:  [-7.93876651]
curr_Stock_Price:  103.10010432426537
curr_Factors:  [103.10010432]
mat_Sqrt:  [[0.15]]
grads:  [-0.0817867]
Stock Position:  -0.0817867042322318
Bond Position:  [0.49345123]


portfolio before change:  [-7.8605038]
curr_Stock_Price:  102.14394621019773
curr_Factors:  [102.14394621]
mat_Sqrt:  [[0.15]]
grads:  [0.07462108]
Stock Position:  0.07462108063000457
Bond Position:  [-15.48259545]


portfolio before change:  [-7.95614244]
curr_Stock_Price:  100.88822609801768
curr_Factors:  [100.8882261]
mat_Sqrt:  [[0.15]]
grads:  [-0.04708253]
Stock Position:  -0.04708252733401138
Bond Position:  [-3.20606978]


portfolio before change:  [-7.94639547]
curr_Stock_Price:  100.67269496407879
curr_Factors:  [100.67269496]
mat_Sqrt:  [[0.15]]
grads:  [-0.15470093]
Stock Position:  -0.15470092944592057
Bond Position:  [7.62776401]


portfolio before change:  [-7.86502108]
curr_Stock_Price:  100.15284762374218
curr_Factors:  [100.15284762]
mat_Sqrt:  [[0.15]]
grads:  [0.02321357]
Stock Position:  0.023213573773048314
Bond Position:  [-10.18992659]


portfolio before change:  [-7.89671512]
curr_Stock_Price:  98.84239769639589
curr_Factors:  [98.8423977]
mat_Sqrt:  [[0.15]]
grads:  [-0.02140945]
Stock Position:  -0.021409449494068335
Bond Position:  [-5.7805538]


portfolio before change:  [-7.90632841]
curr_Stock_Price:  99.2576664459955
curr_Factors:  [99.25766645]
mat_Sqrt:  [[0.15]]
grads:  [-0.05714007]
Stock Position:  -0.05714007030100793
Bond Position:  [-2.23473838]


portfolio before change:  [-7.8737704]
curr_Stock_Price:  98.68298439803823
curr_Factors:  [98.6829844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601256]
Stock Position:  -0.01601255793795787
Bond Position:  [-6.2936034]


portfolio before change:  [-7.87532675]
curr_Stock_Price:  98.73104677603598
curr_Factors:  [98.73104678]
mat_Sqrt:  [[0.15]]
grads:  [0.00210982]
Stock Position:  0.0021098232965246566
Bond Position:  [-8.08363181]


portfolio before change:  [-7.875279]
curr_Stock_Price:  99.23263941700243
curr_Factors:  [99.23263942]
mat_Sqrt:  [[0.15]]
grads:  [0.05939442]
Stock Position:  0.05939441861116329
Bond Position:  [-13.76914392]


portfolio before change:  [-7.93045603]
curr_Stock_Price:  98.33262578430227
curr_Factors:  [98.33262578]
mat_Sqrt:  [[0.15]]
grads:  [0.03178121]
Stock Position:  0.03178121328908151
Bond Position:  [-11.05558619]


portfolio before change:  [-7.93907649]
curr_Stock_Price:  98.10486808707135
curr_Factors:  [98.10486809]
mat_Sqrt:  [[0.15]]
grads:  [0.03812798]
Stock Position:  0.038127983765465646
Bond Position:  [-11.6796173]


portfolio before change:  [-7.95520481]
curr_Stock_Price:  97.72015651141946
curr_Factors:  [97.72015651]
mat_Sqrt:  [[0.15]]
grads:  [-0.01356258]
Stock Position:  -0.013562581636570885
Bond Position:  [-6.6298672]


portfolio before change:  [-7.95441057]
curr_Stock_Price:  97.60048766801873
curr_Factors:  [97.60048767]
mat_Sqrt:  [[0.15]]
grads:  [-0.03321928]
Stock Position:  -0.03321928040856369
Bond Position:  [-4.7121926]


portfolio before change:  [-7.91364886]
curr_Stock_Price:  96.35570541558349
curr_Factors:  [96.35570542]
mat_Sqrt:  [[0.15]]
grads:  [-0.01437733]
Stock Position:  -0.014377329522736501
Bond Position:  [-6.52831113]


portfolio before change:  [-7.91623579]
curr_Stock_Price:  96.47887427433395
curr_Factors:  [96.47887427]
mat_Sqrt:  [[0.15]]
grads:  [-0.12550382]
Stock Position:  -0.12550381869270158
Bond Position:  [4.19223135]


portfolio before change:  [-7.8984177]
curr_Stock_Price:  96.34107740752913
curr_Factors:  [96.34107741]
mat_Sqrt:  [[0.15]]
grads:  [-0.19311747]
Stock Position:  -0.19311747454210323
Bond Position:  [10.70672787]


portfolio before change:  [-7.68044002]
curr_Stock_Price:  95.21927705254802
curr_Factors:  [95.21927705]
mat_Sqrt:  [[0.15]]
grads:  [0.14491977]
Stock Position:  0.1449197676894482
Bond Position:  [-21.47959553]


portfolio before change:  [-7.51657076]
curr_Stock_Price:  96.36856387740507
curr_Factors:  [96.36856388]
mat_Sqrt:  [[0.15]]
grads:  [0.01782034]
Stock Position:  0.017820335306876694
Bond Position:  [-9.23389088]


portfolio before change:  [-7.51402334]
curr_Stock_Price:  96.57628878047565
curr_Factors:  [96.57628878]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148637]
Stock Position:  -0.04148636914262534
Bond Position:  [-3.50742377]


portfolio before change:  [-7.52819058]
curr_Stock_Price:  96.90721158627885
curr_Factors:  [96.90721159]
mat_Sqrt:  [[0.15]]
grads:  [-0.08353401]
Stock Position:  -0.08353400988256592
Bond Position:  [0.56685739]


portfolio before change:  [-7.50954192]
curr_Stock_Price:  96.68481360735156
curr_Factors:  [96.68481361]
mat_Sqrt:  [[0.15]]
grads:  [-0.06699158]
Stock Position:  -0.06699157738134008
Bond Position:  [-1.03247375]


portfolio before change:  [-7.473335]
curr_Stock_Price:  96.14241722059104
curr_Factors:  [96.14241722]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327139]
Stock Position:  -0.043271394495656174
Bond Position:  [-3.31311854]


portfolio before change:  [-7.44353024]
curr_Stock_Price:  95.44405917514274
curr_Factors:  [95.44405918]
mat_Sqrt:  [[0.15]]
grads:  [-0.03035699]
Stock Position:  -0.03035698852085121
Bond Position:  [-4.54613603]


portfolio before change:  [-7.43559683]
curr_Stock_Price:  95.16400121349545
curr_Factors:  [95.16400121]
mat_Sqrt:  [[0.15]]
grads:  [0.12592444]
Stock Position:  0.12592443838621023
Bond Position:  [-19.41907023]


portfolio before change:  [-7.5816089]
curr_Stock_Price:  94.0237575616909
curr_Factors:  [94.02375756]
mat_Sqrt:  [[0.15]]
grads:  [0.0769251]
Stock Position:  0.07692509551483616
Bond Position:  [-14.81439543]


portfolio before change:  [-7.61460397]
curr_Stock_Price:  93.61890724452265
curr_Factors:  [93.61890724]
mat_Sqrt:  [[0.15]]
grads:  [0.11645717]
Stock Position:  0.11645716621441779
Bond Position:  [-18.51719661]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.61460397]
Stock Price:  92.5506159155151
PL:  [-7.61460397]
Settle:  Tensor("sub_106:0", shape=(), dtype=float64)
PL:  Tensor("sub_107:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  54
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.50115929e-03]
 [-9.57952256e-03]
 [-1.95226590e-02]
 [-1.30820357e-02]
 [ 1.17458542e-02]
 [ 2.46971346e-02]
 [ 4.86360463e-03]
 [-7.88694242e-03]
 [ 2.54472584e-03]
 [ 2.37224333e-03]
 [-7.40630790e-02]
 [-2.77873598e-02]
 [ 1.68601412e-02]
 [-1.95367847e-03]
 [ 2.14518262e-02]
 [-8.29678593e-03]
 [-1.06680530e-02]
 [ 1.58314306e-04]
 [-7.50819857e-03]
 [-2.39654023e-03]
 [ 3.05254011e-04]
 [ 1.09025562e-02]
 [ 4.76715146e-03]
 [ 5.69074276e-03]
 [-3.11063750e-03]
 [-5.58048483e-03]
 [-6.48432132e-03]
 [-2.05337919e-02]
 [-2.94427686e-02]
 [ 2.18428686e-02]
 [ 2.64377437e-03]
 [-8.70148433e-03]
 [-1.23343950e-02]
 [-8.39100528e-03]
 [-6.67012754e-03]
 [-6.30358241e-03]
 [ 2.06848144e-02]
 [ 9.04790755e-03]
 [ 2.10196227e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.93079077]
curr_Stock_Price:  98.91315212790813
curr_Factors:  [98.91315213]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366744]
Stock Position:  -0.03667439524330965
Bond Position:  [-11.30321073]


portfolio before change:  [-14.90009744]
curr_Stock_Price:  98.03770972970241
curr_Factors:  [98.03770973]
mat_Sqrt:  [[0.15]]
grads:  [-0.06386348]
Stock Position:  -0.06386348370147649
Bond Position:  [-8.63906776]


portfolio before change:  [-14.95193768]
curr_Stock_Price:  98.8325346527982
curr_Factors:  [98.83253465]
mat_Sqrt:  [[0.15]]
grads:  [-0.13015106]
Stock Position:  -0.13015105989631623
Bond Position:  [-2.08877854]


portfolio before change:  [-14.98685913]
curr_Stock_Price:  99.09884322987111
curr_Factors:  [99.09884323]
mat_Sqrt:  [[0.15]]
grads:  [-0.08721357]
Stock Position:  -0.08721357133884093
Bond Position:  [-6.3440951]


portfolio before change:  [-14.89562235]
curr_Stock_Price:  98.04361936719158
curr_Factors:  [98.04361937]
mat_Sqrt:  [[0.15]]
grads:  [0.07830569]
Stock Position:  0.07830569436587738
Bond Position:  [-22.57299605]


portfolio before change:  [-15.01102357]
curr_Stock_Price:  96.60592807166931
curr_Factors:  [96.60592807]
mat_Sqrt:  [[0.15]]
grads:  [0.16464756]
Stock Position:  0.16464756372977776
Bond Position:  [-30.91695427]


portfolio before change:  [-14.81414145]
curr_Stock_Price:  97.82518074464642
curr_Factors:  [97.82518074]
mat_Sqrt:  [[0.15]]
grads:  [0.03242403]
Stock Position:  0.03242403084576012
Bond Position:  [-17.98602813]


portfolio before change:  [-14.83118762]
curr_Stock_Price:  97.36879767450223
curr_Factors:  [97.36879767]
mat_Sqrt:  [[0.15]]
grads:  [-0.05257962]
Stock Position:  -0.052579616135725205
Bond Position:  [-9.71157361]


portfolio before change:  [-14.80720446]
curr_Stock_Price:  96.88957809561127
curr_Factors:  [96.8895781]
mat_Sqrt:  [[0.15]]
grads:  [0.01696484]
Stock Position:  0.016964838940720536
Bond Position:  [-16.45092055]


portfolio before change:  [-14.81928803]
curr_Stock_Price:  96.29852788745407
curr_Factors:  [96.29852789]
mat_Sqrt:  [[0.15]]
grads:  [0.01581496]
Stock Position:  0.015814955553292744
Bond Position:  [-16.34224496]


portfolio before change:  [-14.823115]
curr_Stock_Price:  96.18571933864726
curr_Factors:  [96.18571934]
mat_Sqrt:  [[0.15]]
grads:  [-0.49375386]
Stock Position:  -0.4937538599151808
Bond Position:  [32.6689552]


portfolio before change:  [-14.03908091]
curr_Stock_Price:  94.60608568242299
curr_Factors:  [94.60608568]
mat_Sqrt:  [[0.15]]
grads:  [-0.18524907]
Stock Position:  -0.1852490652284358
Bond Position:  [3.48660803]


portfolio before change:  [-13.97612229]
curr_Stock_Price:  94.26857920695794
curr_Factors:  [94.26857921]
mat_Sqrt:  [[0.15]]
grads:  [0.11240094]
Stock Position:  0.11240094146661321
Bond Position:  [-24.57199935]


portfolio before change:  [-14.00818903]
curr_Stock_Price:  94.01061832220525
curr_Factors:  [94.01061832]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302452]
Stock Position:  -0.013024523152444477
Bond Position:  [-12.78374556]


portfolio before change:  [-14.01681547]
curr_Stock_Price:  94.55024425103065
curr_Factors:  [94.55024425]
mat_Sqrt:  [[0.15]]
grads:  [0.14301217]
Stock Position:  0.14301217474413236
Bond Position:  [-27.53865152]


portfolio before change:  [-13.83096081]
curr_Stock_Price:  95.87388823728394
curr_Factors:  [95.87388824]
mat_Sqrt:  [[0.15]]
grads:  [-0.05531191]
Stock Position:  -0.05531190621866978
Bond Position:  [-8.5279933]


portfolio before change:  [-13.80995028]
curr_Stock_Price:  95.47475902915761
curr_Factors:  [95.47475903]
mat_Sqrt:  [[0.15]]
grads:  [-0.07112035]
Stock Position:  -0.07112035348617002
Bond Position:  [-7.01975167]


portfolio before change:  [-13.8560479]
curr_Stock_Price:  96.11058392669327
curr_Factors:  [96.11058393]
mat_Sqrt:  [[0.15]]
grads:  [0.00105543]
Stock Position:  0.001055428708893808
Bond Position:  [-13.95748577]


portfolio before change:  [-13.85553597]
curr_Stock_Price:  98.24879164650525
curr_Factors:  [98.24879165]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005466]
Stock Position:  -0.050054657123607314
Bond Position:  [-8.93772639]


portfolio before change:  [-13.88101103]
curr_Stock_Price:  98.73541530198894
curr_Factors:  [98.7354153]
mat_Sqrt:  [[0.15]]
grads:  [-0.01597693]
Stock Position:  -0.015976934879341334
Bond Position:  [-12.30352173]


portfolio before change:  [-13.89125025]
curr_Stock_Price:  99.28002444715254
curr_Factors:  [99.28002445]
mat_Sqrt:  [[0.15]]
grads:  [0.00203503]
Stock Position:  0.0020350267397071923
Bond Position:  [-14.09328776]


portfolio before change:  [-13.89236637]
curr_Stock_Price:  99.59729675111747
curr_Factors:  [99.59729675]
mat_Sqrt:  [[0.15]]
grads:  [0.07268371]
Stock Position:  0.07268370829150543
Bond Position:  [-21.13146723]


portfolio before change:  [-13.984077]
curr_Stock_Price:  98.3718634181651
curr_Factors:  [98.37186342]
mat_Sqrt:  [[0.15]]
grads:  [0.03178101]
Stock Position:  0.03178100971566591
Bond Position:  [-17.11043415]


portfolio before change:  [-13.99767747]
curr_Stock_Price:  98.01122261190996
curr_Factors:  [98.01122261]
mat_Sqrt:  [[0.15]]
grads:  [0.03793829]
Stock Position:  0.037938285041450824
Bond Position:  [-17.71605517]


portfolio before change:  [-13.992587]
curr_Stock_Price:  98.20377511925972
curr_Factors:  [98.20377512]
mat_Sqrt:  [[0.15]]
grads:  [-0.02073758]
Stock Position:  -0.02073758330423276
Bond Position:  [-11.95607804]


portfolio before change:  [-13.99226357]
curr_Stock_Price:  98.11610659649166
curr_Factors:  [98.1161066]
mat_Sqrt:  [[0.15]]
grads:  [-0.03720323]
Stock Position:  -0.037203232227646876
Bond Position:  [-10.34202727]


portfolio before change:  [-13.97993037]
curr_Stock_Price:  97.74984718637465
curr_Factors:  [97.74984719]
mat_Sqrt:  [[0.15]]
grads:  [-0.04322881]
Stock Position:  -0.04322880879486942
Bond Position:  [-9.75432092]


portfolio before change:  [-13.98754923]
curr_Stock_Price:  97.8978848800271
curr_Factors:  [97.89788488]
mat_Sqrt:  [[0.15]]
grads:  [-0.13689195]
Stock Position:  -0.13689194609431118
Bond Position:  [-0.58611725]


portfolio before change:  [-13.81953962]
curr_Stock_Price:  96.67003407520875
curr_Factors:  [96.67003408]
mat_Sqrt:  [[0.15]]
grads:  [-0.19628512]
Stock Position:  -0.1962851238279594
Bond Position:  [5.15534999]


portfolio before change:  [-13.71220801]
curr_Stock_Price:  96.126502580858
curr_Factors:  [96.12650258]
mat_Sqrt:  [[0.15]]
grads:  [0.14561912]
Stock Position:  0.1456191237754875
Bond Position:  [-27.71006509]


portfolio before change:  [-13.81770166]
curr_Stock_Price:  95.42584137863615
curr_Factors:  [95.42584138]
mat_Sqrt:  [[0.15]]
grads:  [0.01762516]
Stock Position:  0.01762516246934326
Bond Position:  [-15.49959761]


portfolio before change:  [-13.8238136]
curr_Stock_Price:  95.18899976322945
curr_Factors:  [95.18899976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0580099]
Stock Position:  -0.05800989556138659
Bond Position:  [-8.30190966]


portfolio before change:  [-13.78877202]
curr_Stock_Price:  94.56704755002572
curr_Factors:  [94.56704755]
mat_Sqrt:  [[0.15]]
grads:  [-0.0822293]
Stock Position:  -0.0822293000473221
Bond Position:  [-6.01258989]


portfolio before change:  [-13.85958431]
curr_Stock_Price:  95.41906343720434
curr_Factors:  [95.41906344]
mat_Sqrt:  [[0.15]]
grads:  [-0.05594004]
Stock Position:  -0.05594003521384259
Bond Position:  [-8.52183854]


portfolio before change:  [-13.91418146]
curr_Stock_Price:  96.37601415095796
curr_Factors:  [96.37601415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04446752]
Stock Position:  -0.044467516943929815
Bond Position:  [-9.62857942]


portfolio before change:  [-13.94028268]
curr_Stock_Price:  96.93591888309818
curr_Factors:  [96.93591888]
mat_Sqrt:  [[0.15]]
grads:  [-0.04202388]
Stock Position:  -0.04202388272004076
Bond Position:  [-9.866659]


portfolio before change:  [-13.95565206]
curr_Stock_Price:  97.27229826940783
curr_Factors:  [97.27229827]
mat_Sqrt:  [[0.15]]
grads:  [0.13789876]
Stock Position:  0.1378987627121165
Bond Position:  [-27.36938164]


portfolio before change:  [-14.06073193]
curr_Stock_Price:  96.53510176370148
curr_Factors:  [96.53510176]
mat_Sqrt:  [[0.15]]
grads:  [0.06031938]
Stock Position:  0.06031938363984903
Bond Position:  [-19.88366977]


portfolio before change:  [-14.07947748]
curr_Stock_Price:  96.2655377574206
curr_Factors:  [96.26553776]
mat_Sqrt:  [[0.15]]
grads:  [0.14013082]
Stock Position:  0.14013081790572346
Bond Position:  [-27.56924602]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.07947748]
Stock Price:  96.65068126781443
PL:  [-14.07947748]
Settle:  Tensor("sub_108:0", shape=(), dtype=float64)
PL:  Tensor("sub_109:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  55
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.41539521e-03]
 [-5.98519539e-03]
 [ 4.67568707e-03]
 [-1.26755091e-02]
 [ 1.42641699e-02]
 [ 1.80037778e-02]
 [ 2.35520956e-02]
 [-3.49100912e-03]
 [ 1.19098009e-02]
 [-4.22426365e-06]
 [-1.84836706e-02]
 [-7.39057227e-03]
 [ 6.02405262e-03]
 [ 8.68456127e-03]
 [ 8.44928187e-03]
 [-7.71853632e-03]
 [-9.77795029e-03]
 [ 3.32241576e-04]
 [-7.72534753e-03]
 [-3.04499776e-03]
 [ 1.51082678e-03]
 [-1.32801244e-02]
 [ 4.76205804e-03]
 [ 5.78723780e-03]
 [ 9.54363884e-03]
 [ 2.75573842e-03]
 [ 1.62700874e-02]
 [-2.07291592e-02]
 [-1.61015020e-02]
 [ 2.15654443e-02]
 [ 2.51955821e-03]
 [-1.78963967e-02]
 [-1.19843569e-02]
 [-5.55412836e-04]
 [-6.80272189e-03]
 [-1.25949998e-03]
 [ 1.78238117e-02]
 [ 1.37782698e-02]
 [ 1.56549926e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.65025185]
curr_Stock_Price:  100.56113586105606
curr_Factors:  [100.56113586]
mat_Sqrt:  [[0.15]]
grads:  [-0.00943597]
Stock Position:  -0.009435968043571465
Bond Position:  [11.59914352]


portfolio before change:  [10.6474745]
curr_Stock_Price:  101.00913836908394
curr_Factors:  [101.00913837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399013]
Stock Position:  -0.039901302600509884
Bond Position:  [14.6778707]


portfolio before change:  [10.70726485]
curr_Stock_Price:  99.55666704662855
curr_Factors:  [99.55666705]
mat_Sqrt:  [[0.15]]
grads:  [0.03117125]
Stock Position:  0.031171247156937573
Bond Position:  [7.60395937]


portfolio before change:  [10.69472061]
curr_Stock_Price:  99.12374285772214
curr_Factors:  [99.12374286]
mat_Sqrt:  [[0.15]]
grads:  [-0.08450339]
Stock Position:  -0.08450339426923621
Bond Position:  [19.07101334]


portfolio before change:  [10.72615933]
curr_Stock_Price:  98.7799141910393
curr_Factors:  [98.77991419]
mat_Sqrt:  [[0.15]]
grads:  [0.09509447]
Stock Position:  0.09509446622147164
Bond Position:  [1.33273612]


portfolio before change:  [10.77635782]
curr_Stock_Price:  99.30604249344056
curr_Factors:  [99.30604249]
mat_Sqrt:  [[0.15]]
grads:  [0.12002519]
Stock Position:  0.12002518523404967
Bond Position:  [-1.14286832]


portfolio before change:  [10.79833461]
curr_Stock_Price:  99.49033425319304
curr_Factors:  [99.49033425]
mat_Sqrt:  [[0.15]]
grads:  [0.15701397]
Stock Position:  0.1570139707143783
Bond Position:  [-4.82303782]


portfolio before change:  [10.650582]
curr_Stock_Price:  98.55315850923378
curr_Factors:  [98.55315851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02327339]
Stock Position:  -0.023273394150451345
Bond Position:  [12.94424851]


portfolio before change:  [10.66177751]
curr_Stock_Price:  98.14164250832107
curr_Factors:  [98.14164251]
mat_Sqrt:  [[0.15]]
grads:  [0.07939867]
Stock Position:  0.0793986723983022
Bond Position:  [2.86946139]


portfolio before change:  [10.63057423]
curr_Stock_Price:  97.7441297492611
curr_Factors:  [97.74412975]
mat_Sqrt:  [[0.15]]
grads:  [-2.81617576e-05]
Stock Position:  -2.8161757634441224e-05
Bond Position:  [10.63332688]


portfolio before change:  [10.63190753]
curr_Stock_Price:  97.60018092697354
curr_Factors:  [97.60018093]
mat_Sqrt:  [[0.15]]
grads:  [-0.12322447]
Stock Position:  -0.12322447068090797
Bond Position:  [22.65863817]


portfolio before change:  [10.68226488]
curr_Stock_Price:  97.21450398973161
curr_Factors:  [97.21450399]
mat_Sqrt:  [[0.15]]
grads:  [-0.04927048]
Stock Position:  -0.049270481812349186
Bond Position:  [15.47207033]


portfolio before change:  [10.63019536]
curr_Stock_Price:  98.31056895772637
curr_Factors:  [98.31056896]
mat_Sqrt:  [[0.15]]
grads:  [0.04016035]
Stock Position:  0.0401603507995657
Bond Position:  [6.68200842]


portfolio before change:  [10.60492271]
curr_Stock_Price:  97.66047629227
curr_Factors:  [97.66047629]
mat_Sqrt:  [[0.15]]
grads:  [0.05789708]
Stock Position:  0.057897075151722134
Bond Position:  [4.95066678]


portfolio before change:  [10.55775708]
curr_Stock_Price:  96.83514090147038
curr_Factors:  [96.8351409]
mat_Sqrt:  [[0.15]]
grads:  [0.05632855]
Stock Position:  0.056328545779579166
Bond Position:  [5.10317441]


portfolio before change:  [10.49447059]
curr_Stock_Price:  95.70029141678518
curr_Factors:  [95.70029142]
mat_Sqrt:  [[0.15]]
grads:  [-0.05145691]
Stock Position:  -0.051456908819647824
Bond Position:  [15.41891176]


portfolio before change:  [10.48056489]
curr_Stock_Price:  96.00798948265569
curr_Factors:  [96.00798948]
mat_Sqrt:  [[0.15]]
grads:  [-0.06518634]
Stock Position:  -0.06518633525625181
Bond Position:  [16.73897388]


portfolio before change:  [10.52219288]
curr_Stock_Price:  95.40148973543506
curr_Factors:  [95.40148974]
mat_Sqrt:  [[0.15]]
grads:  [0.00221494]
Stock Position:  0.00221494383772556
Bond Position:  [10.31088394]


portfolio before change:  [10.52258969]
curr_Stock_Price:  94.99870890114258
curr_Factors:  [94.9987089]
mat_Sqrt:  [[0.15]]
grads:  [-0.05150232]
Stock Position:  -0.051502316874556996
Bond Position:  [15.4152433]


portfolio before change:  [10.58653126]
curr_Stock_Price:  93.79459715189368
curr_Factors:  [93.79459715]
mat_Sqrt:  [[0.15]]
grads:  [-0.02029999]
Stock Position:  -0.020299985080905775
Bond Position:  [12.49056018]


portfolio before change:  [10.60660059]
curr_Stock_Price:  92.88287676764818
curr_Factors:  [92.88287677]
mat_Sqrt:  [[0.15]]
grads:  [0.01007218]
Stock Position:  0.010072178512231425
Bond Position:  [9.67106767]


portfolio before change:  [10.60291135]
curr_Stock_Price:  92.39656746308448
curr_Factors:  [92.39656746]
mat_Sqrt:  [[0.15]]
grads:  [-0.08853416]
Stock Position:  -0.0885341627960818
Bond Position:  [18.7831641]


portfolio before change:  [10.63673305]
curr_Stock_Price:  92.0410701253361
curr_Factors:  [92.04107013]
mat_Sqrt:  [[0.15]]
grads:  [0.03174705]
Stock Position:  0.03174705361156876
Bond Position:  [7.71470027]


portfolio before change:  [10.61527588]
curr_Stock_Price:  91.33481321508401
curr_Factors:  [91.33481322]
mat_Sqrt:  [[0.15]]
grads:  [0.03858159]
Stock Position:  0.03858158530153446
Bond Position:  [7.09143399]


portfolio before change:  [10.64690681]
curr_Stock_Price:  92.1316816568501
curr_Factors:  [92.13168166]
mat_Sqrt:  [[0.15]]
grads:  [0.06362426]
Stock Position:  0.06362425893085707
Bond Position:  [4.78509684]


portfolio before change:  [10.60292403]
curr_Stock_Price:  91.43099049823849
curr_Factors:  [91.4309905]
mat_Sqrt:  [[0.15]]
grads:  [0.01837159]
Stock Position:  0.01837158946755426
Bond Position:  [8.9231914]


portfolio before change:  [10.63372176]
curr_Stock_Price:  93.04665200347956
curr_Factors:  [93.046652]
mat_Sqrt:  [[0.15]]
grads:  [0.10846725]
Stock Position:  0.10846724962633959
Bond Position:  [0.54120734]


portfolio before change:  [10.64276142]
curr_Stock_Price:  93.12936818642636
curr_Factors:  [93.12936819]
mat_Sqrt:  [[0.15]]
grads:  [-0.13819439]
Stock Position:  -0.1381943947449388
Bond Position:  [23.51271809]


portfolio before change:  [10.7116959]
curr_Stock_Price:  92.65181476885154
curr_Factors:  [92.65181477]
mat_Sqrt:  [[0.15]]
grads:  [-0.10734335]
Stock Position:  -0.10734334646830292
Bond Position:  [20.65725175]


portfolio before change:  [10.81797493]
curr_Stock_Price:  91.68578637779794
curr_Factors:  [91.68578638]
mat_Sqrt:  [[0.15]]
grads:  [0.14376963]
Stock Position:  0.14376962858057651
Bond Position:  [-2.36365652]


portfolio before change:  [10.78031872]
curr_Stock_Price:  91.42592109635078
curr_Factors:  [91.4259211]
mat_Sqrt:  [[0.15]]
grads:  [0.01679705]
Stock Position:  0.016797054736243513
Bond Position:  [9.24463252]


portfolio before change:  [10.78012981]
curr_Stock_Price:  91.3458732295141
curr_Factors:  [91.34587323]
mat_Sqrt:  [[0.15]]
grads:  [-0.11930931]
Stock Position:  -0.1193093113859608
Bond Position:  [21.67854304]


portfolio before change:  [10.89790332]
curr_Stock_Price:  90.3814596109429
curr_Factors:  [90.38145961]
mat_Sqrt:  [[0.15]]
grads:  [-0.07989571]
Stock Position:  -0.07989571245867469
Bond Position:  [18.11899443]


portfolio before change:  [10.82338278]
curr_Stock_Price:  91.34253187814737
curr_Factors:  [91.34253188]
mat_Sqrt:  [[0.15]]
grads:  [-0.00370275]
Stock Position:  -0.0037027522418398365
Bond Position:  [11.16160155]


portfolio before change:  [10.8225409]
curr_Stock_Price:  91.94672370659963
curr_Factors:  [91.94672371]
mat_Sqrt:  [[0.15]]
grads:  [-0.04535148]
Stock Position:  -0.045351479252419905
Bond Position:  [14.99246083]


portfolio before change:  [10.79315689]
curr_Stock_Price:  92.63596654697938
curr_Factors:  [92.63596655]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839667]
Stock Position:  -0.008396666501561014
Bond Position:  [11.5709902]


portfolio before change:  [10.79410577]
curr_Stock_Price:  92.69522656152155
curr_Factors:  [92.69522656]
mat_Sqrt:  [[0.15]]
grads:  [0.11882541]
Stock Position:  0.11882541161343972
Bond Position:  [-0.22044269]


portfolio before change:  [10.75294274]
curr_Stock_Price:  92.34904245150692
curr_Factors:  [92.34904245]
mat_Sqrt:  [[0.15]]
grads:  [0.09185513]
Stock Position:  0.09185513231277152
Bond Position:  [2.27020923]


portfolio before change:  [10.74571133]
curr_Stock_Price:  92.26722666314856
curr_Factors:  [92.26722666]
mat_Sqrt:  [[0.15]]
grads:  [0.10436662]
Stock Position:  0.10436661744857828
Bond Position:  [1.11609298]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.74571133]
Stock Price:  92.87168025568656
PL:  [10.74571133]
Settle:  Tensor("sub_110:0", shape=(), dtype=float64)
PL:  Tensor("sub_111:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  56
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.22735768e-03]
 [-3.55962787e-03]
 [-1.74313306e-02]
 [-2.06366164e-02]
 [ 1.23732850e-02]
 [ 2.34140870e-02]
 [ 1.71106180e-03]
 [-7.81585355e-03]
 [ 1.32965584e-02]
 [-2.68847900e-04]
 [ 1.07706826e-02]
 [ 4.66393547e-03]
 [ 3.21923318e-03]
 [ 1.05821667e-02]
 [-4.20948245e-03]
 [-1.97789161e-02]
 [ 4.73936570e-03]
 [-1.97372491e-03]
 [-2.49589255e-03]
 [-2.30291857e-03]
 [-9.33980255e-04]
 [-1.99216093e-02]
 [ 4.78402255e-03]
 [ 7.19440161e-03]
 [-3.57064625e-03]
 [-9.17261542e-03]
 [ 8.16969801e-03]
 [-1.99118723e-02]
 [-2.76080408e-02]
 [ 2.15566827e-02]
 [ 8.84355362e-03]
 [ 1.45852054e-03]
 [-1.24686722e-02]
 [-5.10424112e-03]
 [-8.55121620e-03]
 [-7.52359607e-03]
 [ 2.22443800e-02]
 [ 8.29557468e-03]
 [ 2.33175674e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.41177126]
curr_Stock_Price:  99.7840753566762
curr_Factors:  [99.78407536]
mat_Sqrt:  [[0.15]]
grads:  [-0.01484905]
Stock Position:  -0.01484905122341602
Bond Position:  [0.06992759]


portfolio before change:  [-1.39700529]
curr_Stock_Price:  98.79025903222681
curr_Factors:  [98.79025903]
mat_Sqrt:  [[0.15]]
grads:  [-0.02373085]
Stock Position:  -0.023730852456301865
Bond Position:  [0.94737177]


portfolio before change:  [-1.40052323]
curr_Stock_Price:  98.9434927459644
curr_Factors:  [98.94349275]
mat_Sqrt:  [[0.15]]
grads:  [-0.11620887]
Stock Position:  -0.11620887051723139
Bond Position:  [10.09758831]


portfolio before change:  [-1.36065951]
curr_Stock_Price:  98.61131981988107
curr_Factors:  [98.61131982]
mat_Sqrt:  [[0.15]]
grads:  [-0.13757744]
Stock Position:  -0.13757744247860232
Bond Position:  [12.20603367]


portfolio before change:  [-1.46511077]
curr_Stock_Price:  99.38162857650167
curr_Factors:  [99.38162858]
mat_Sqrt:  [[0.15]]
grads:  [0.08248857]
Stock Position:  0.08248856690088616
Bond Position:  [-9.66295889]


portfolio before change:  [-1.57653052]
curr_Stock_Price:  98.04554273980294
curr_Factors:  [98.04554274]
mat_Sqrt:  [[0.15]]
grads:  [0.15609391]
Stock Position:  0.15609391358195832
Bond Position:  [-16.880843]


portfolio before change:  [-1.77196331]
curr_Stock_Price:  96.80704121190364
curr_Factors:  [96.80704121]
mat_Sqrt:  [[0.15]]
grads:  [0.01140708]
Stock Position:  0.011407078651694606
Bond Position:  [-2.87624884]


portfolio before change:  [-1.76565539]
curr_Stock_Price:  97.39154457216559
curr_Factors:  [97.39154457]
mat_Sqrt:  [[0.15]]
grads:  [-0.05210569]
Stock Position:  -0.05210569034417058
Bond Position:  [3.30899828]


portfolio before change:  [-1.81508823]
curr_Stock_Price:  98.34818673634257
curr_Factors:  [98.34818674]
mat_Sqrt:  [[0.15]]
grads:  [0.08864372]
Stock Position:  0.0886437223339377
Bond Position:  [-10.53303759]


portfolio before change:  [-1.83001644]
curr_Stock_Price:  98.19463394902763
curr_Factors:  [98.19463395]
mat_Sqrt:  [[0.15]]
grads:  [-0.00179232]
Stock Position:  -0.0017923193311840738
Bond Position:  [-1.6540203]


portfolio before change:  [-1.83168853]
curr_Stock_Price:  99.0121928630695
curr_Factors:  [99.01219286]
mat_Sqrt:  [[0.15]]
grads:  [0.07180455]
Stock Position:  0.07180455086083767
Bond Position:  [-8.94121457]


portfolio before change:  [-1.83281395]
curr_Stock_Price:  99.01208565983252
curr_Factors:  [99.01208566]
mat_Sqrt:  [[0.15]]
grads:  [0.0310929]
Stock Position:  0.0310929031223188
Bond Position:  [-4.91138714]


portfolio before change:  [-1.84743092]
curr_Stock_Price:  98.56172523637785
curr_Factors:  [98.56172524]
mat_Sqrt:  [[0.15]]
grads:  [0.02146155]
Stock Position:  0.021461554518198943
Bond Position:  [-3.96271876]


portfolio before change:  [-1.84343517]
curr_Stock_Price:  98.77098880439122
curr_Factors:  [98.7709888]
mat_Sqrt:  [[0.15]]
grads:  [0.07054778]
Stock Position:  0.07054777803749522
Bond Position:  [-8.81150897]


portfolio before change:  [-1.79045103]
curr_Stock_Price:  99.5376415621515
curr_Factors:  [99.53764156]
mat_Sqrt:  [[0.15]]
grads:  [-0.02806322]
Stock Position:  -0.028063216327463086
Bond Position:  [1.00289534]


portfolio before change:  [-1.81371109]
curr_Stock_Price:  100.37095410065287
curr_Factors:  [100.3709541]
mat_Sqrt:  [[0.15]]
grads:  [-0.13185944]
Stock Position:  -0.13185944089776627
Bond Position:  [11.4211468]


portfolio before change:  [-1.84558235]
curr_Stock_Price:  100.62348810439883
curr_Factors:  [100.6234881]
mat_Sqrt:  [[0.15]]
grads:  [0.03159577]
Stock Position:  0.03159577131657478
Bond Position:  [-5.02485907]


portfolio before change:  [-1.84095349]
curr_Stock_Price:  100.78987134406269
curr_Factors:  [100.78987134]
mat_Sqrt:  [[0.15]]
grads:  [-0.01315817]
Stock Position:  -0.013158166064438412
Bond Position:  [-0.51474363]


portfolio before change:  [-1.86562784]
curr_Stock_Price:  102.6601924816365
curr_Factors:  [102.66019248]
mat_Sqrt:  [[0.15]]
grads:  [-0.01663928]
Stock Position:  -0.016639283633472845
Bond Position:  [-0.15743577]


portfolio before change:  [-1.84618422]
curr_Stock_Price:  101.49047264148527
curr_Factors:  [101.49047264]
mat_Sqrt:  [[0.15]]
grads:  [-0.01535279]
Stock Position:  -0.015352790497346136
Bond Position:  [-0.28802225]


portfolio before change:  [-1.86369037]
curr_Stock_Price:  102.62838656744113
curr_Factors:  [102.62838657]
mat_Sqrt:  [[0.15]]
grads:  [-0.00622654]
Stock Position:  -0.006226535030906331
Bond Position:  [-1.22467113]


portfolio before change:  [-1.85871031]
curr_Stock_Price:  101.80398596534363
curr_Factors:  [101.80398597]
mat_Sqrt:  [[0.15]]
grads:  [-0.13281073]
Stock Position:  -0.13281072837992733
Bond Position:  [11.66195122]


portfolio before change:  [-1.81895096]
curr_Stock_Price:  101.5155942367939
curr_Factors:  [101.51559424]
mat_Sqrt:  [[0.15]]
grads:  [0.03189348]
Stock Position:  0.03189348367920196
Bond Position:  [-5.05663691]


portfolio before change:  [-1.83416976]
curr_Stock_Price:  101.05823793549312
curr_Factors:  [101.05823794]
mat_Sqrt:  [[0.15]]
grads:  [0.04796268]
Stock Position:  0.04796267742677301
Bond Position:  [-6.68119343]


portfolio before change:  [-1.84318864]
curr_Stock_Price:  100.88761209958399
curr_Factors:  [100.8876121]
mat_Sqrt:  [[0.15]]
grads:  [-0.02380431]
Stock Position:  -0.023804308316030982
Bond Position:  [0.55837119]


portfolio before change:  [-1.83427288]
curr_Stock_Price:  100.51600054759516
curr_Factors:  [100.51600055]
mat_Sqrt:  [[0.15]]
grads:  [-0.06115077]
Stock Position:  -0.06115076943659633
Bond Position:  [4.31235789]


portfolio before change:  [-1.86117717]
curr_Stock_Price:  100.9647826631019
curr_Factors:  [100.96478266]
mat_Sqrt:  [[0.15]]
grads:  [0.05446465]
Stock Position:  0.05446465343289927
Bond Position:  [-7.36018907]


portfolio before change:  [-1.88925921]
curr_Stock_Price:  100.46607466678755
curr_Factors:  [100.46607467]
mat_Sqrt:  [[0.15]]
grads:  [-0.13274582]
Stock Position:  -0.13274581563707466
Bond Position:  [11.44719181]


portfolio before change:  [-1.79339111]
curr_Stock_Price:  99.75466151617545
curr_Factors:  [99.75466152]
mat_Sqrt:  [[0.15]]
grads:  [-0.18405361]
Stock Position:  -0.18405360547353683
Bond Position:  [16.56681401]


portfolio before change:  [-1.77522044]
curr_Stock_Price:  99.66718872008859
curr_Factors:  [99.66718872]
mat_Sqrt:  [[0.15]]
grads:  [0.14371122]
Stock Position:  0.14371121804742618
Bond Position:  [-16.09851353]


portfolio before change:  [-1.83008852]
curr_Stock_Price:  99.29939812392587
curr_Factors:  [99.29939812]
mat_Sqrt:  [[0.15]]
grads:  [0.05895702]
Stock Position:  0.0589570241046261
Bond Position:  [-7.68448552]


portfolio before change:  [-1.79542326]
curr_Stock_Price:  99.90366668302869
curr_Factors:  [99.90366668]
mat_Sqrt:  [[0.15]]
grads:  [0.00972347]
Stock Position:  0.009723470281751074
Bond Position:  [-2.76683359]


portfolio before change:  [-1.79032965]
curr_Stock_Price:  100.4630844241352
curr_Factors:  [100.46308442]
mat_Sqrt:  [[0.15]]
grads:  [-0.08312448]
Stock Position:  -0.08312448146896324
Bond Position:  [6.56061215]


portfolio before change:  [-1.78838996]
curr_Stock_Price:  100.44961581661737
curr_Factors:  [100.44961582]
mat_Sqrt:  [[0.15]]
grads:  [-0.03402827]
Stock Position:  -0.034028274109530444
Bond Position:  [1.62973711]


portfolio before change:  [-1.75764521]
curr_Stock_Price:  99.55209707334822
curr_Factors:  [99.55209707]
mat_Sqrt:  [[0.15]]
grads:  [-0.05700811]
Stock Position:  -0.05700810798779456
Bond Position:  [3.91763149]


portfolio before change:  [-1.68376677]
curr_Stock_Price:  98.26475899614381
curr_Factors:  [98.264759]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015731]
Stock Position:  -0.05015730716656705
Bond Position:  [3.24492893]


portfolio before change:  [-1.71163055]
curr_Stock_Price:  98.82837427840563
curr_Factors:  [98.82837428]
mat_Sqrt:  [[0.15]]
grads:  [0.14829587]
Stock Position:  0.14829586655023233
Bond Position:  [-16.36746996]


portfolio before change:  [-1.67389841]
curr_Stock_Price:  99.09660972365516
curr_Factors:  [99.09660972]
mat_Sqrt:  [[0.15]]
grads:  [0.05530383]
Stock Position:  0.05530383122768011
Bond Position:  [-7.15432059]


portfolio before change:  [-1.68324377]
curr_Stock_Price:  98.9437989470398
curr_Factors:  [98.94379895]
mat_Sqrt:  [[0.15]]
grads:  [0.15545045]
Stock Position:  0.15545044937968583
Bond Position:  [-17.06410178]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.68324377]
Stock Price:  99.75976227939975
PL:  [-1.68324377]
Settle:  Tensor("sub_112:0", shape=(), dtype=float64)
PL:  Tensor("sub_113:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  57
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.01327449e-03]
 [ 5.41975311e-03]
 [ 2.02109683e-02]
 [-1.61148912e-02]
 [ 9.53258475e-03]
 [ 2.36369239e-02]
 [ 3.83319203e-03]
 [-4.17173938e-03]
 [ 1.08951103e-02]
 [-3.01347841e-04]
 [ 4.95113499e-04]
 [-1.38360258e-02]
 [ 1.06314014e-02]
 [ 7.92030777e-03]
 [-6.84361789e-04]
 [-1.17355494e-02]
 [-4.55933581e-03]
 [-3.08243746e-03]
 [-7.88848930e-03]
 [-2.27304768e-03]
 [ 4.02750373e-04]
 [ 1.03941130e-02]
 [ 4.77745557e-03]
 [ 7.39180721e-03]
 [-4.10093095e-03]
 [-8.87084036e-03]
 [ 1.35023804e-02]
 [-2.00370932e-02]
 [-2.54880809e-02]
 [ 2.15618664e-02]
 [ 3.78060382e-03]
 [-3.13207300e-03]
 [-1.25334750e-02]
 [-7.54346343e-03]
 [-8.82077518e-03]
 [-7.52850607e-03]
 [ 2.22512858e-02]
 [ 8.24729285e-03]
 [ 2.35754434e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.46895247]
curr_Stock_Price:  99.2650150599687
curr_Factors:  [99.26501506]
mat_Sqrt:  [[0.15]]
grads:  [-0.03342183]
Stock Position:  -0.033421829917216296
Bond Position:  [-6.15133402]


portfolio before change:  [-9.4765808]
curr_Stock_Price:  99.47025104252565
curr_Factors:  [99.47025104]
mat_Sqrt:  [[0.15]]
grads:  [0.03613169]
Stock Position:  0.03613168736886169
Bond Position:  [-13.07060881]


portfolio before change:  [-9.45738116]
curr_Stock_Price:  100.0468521236583
curr_Factors:  [100.04685212]
mat_Sqrt:  [[0.15]]
grads:  [0.13473979]
Stock Position:  0.13473978834089487
Bond Position:  [-22.93767284]


portfolio before change:  [-9.61473562]
curr_Stock_Price:  98.90029343326036
curr_Factors:  [98.90029343]
mat_Sqrt:  [[0.15]]
grads:  [-0.10743261]
Stock Position:  -0.1074326080924667
Bond Position:  [1.01038084]


portfolio before change:  [-9.50739842]
curr_Stock_Price:  97.90235716357819
curr_Factors:  [97.90235716]
mat_Sqrt:  [[0.15]]
grads:  [0.06355056]
Stock Position:  0.0635505649901808
Bond Position:  [-15.72914853]


portfolio before change:  [-9.50662127]
curr_Stock_Price:  97.94552626288913
curr_Factors:  [97.94552626]
mat_Sqrt:  [[0.15]]
grads:  [0.15757949]
Stock Position:  0.1575794927129481
Bond Position:  [-24.94082761]


portfolio before change:  [-9.57372064]
curr_Stock_Price:  97.53949895558998
curr_Factors:  [97.53949896]
mat_Sqrt:  [[0.15]]
grads:  [0.02555461]
Stock Position:  0.02555461352557896
Bond Position:  [-12.06630484]


portfolio before change:  [-9.55424589]
curr_Stock_Price:  98.36060841936887
curr_Factors:  [98.36060842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278116]
Stock Position:  -0.02781159587760557
Bond Position:  [-6.8186804]


portfolio before change:  [-9.54480536]
curr_Stock_Price:  97.99051408091479
curr_Factors:  [97.99051408]
mat_Sqrt:  [[0.15]]
grads:  [0.07263407]
Stock Position:  0.07263406865483803
Bond Position:  [-16.66225509]


portfolio before change:  [-9.52804345]
curr_Stock_Price:  98.24996294509705
curr_Factors:  [98.24996295]
mat_Sqrt:  [[0.15]]
grads:  [-0.00200899]
Stock Position:  -0.002008985607555274
Bond Position:  [-9.33066069]


portfolio before change:  [-9.52889995]
curr_Stock_Price:  98.09570249947998
curr_Factors:  [98.0957025]
mat_Sqrt:  [[0.15]]
grads:  [0.00330076]
Stock Position:  0.0033007566620218975
Bond Position:  [-9.85268999]


portfolio before change:  [-9.53588522]
curr_Stock_Price:  96.35258508157565
curr_Factors:  [96.35258508]
mat_Sqrt:  [[0.15]]
grads:  [-0.09224017]
Stock Position:  -0.09224017197540706
Bond Position:  [-0.6483062]


portfolio before change:  [-9.56336204]
curr_Stock_Price:  96.64958998890506
curr_Factors:  [96.64958999]
mat_Sqrt:  [[0.15]]
grads:  [0.07087601]
Stock Position:  0.07087600955613896
Bond Position:  [-16.41349931]


portfolio before change:  [-9.50926968]
curr_Stock_Price:  97.4417364285736
curr_Factors:  [97.44173643]
mat_Sqrt:  [[0.15]]
grads:  [0.05280205]
Stock Position:  0.05280205176737367
Bond Position:  [-14.65439329]


portfolio before change:  [-9.46201812]
curr_Stock_Price:  98.37131151137554
curr_Factors:  [98.37131151]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456241]
Stock Position:  -0.004562411924542292
Bond Position:  [-9.01320768]


portfolio before change:  [-9.46135766]
curr_Stock_Price:  97.97959171432392
curr_Factors:  [97.97959171]
mat_Sqrt:  [[0.15]]
grads:  [-0.078237]
Stock Position:  -0.07823699586696915
Bond Position:  [-1.79572874]


portfolio before change:  [-9.46742903]
curr_Stock_Price:  98.05432486226589
curr_Factors:  [98.05432486]
mat_Sqrt:  [[0.15]]
grads:  [-0.03039557]
Stock Position:  -0.030395572070829893
Bond Position:  [-6.48701174]


portfolio before change:  [-9.48947337]
curr_Stock_Price:  98.75289417337633
curr_Factors:  [98.75289417]
mat_Sqrt:  [[0.15]]
grads:  [-0.02054958]
Stock Position:  -0.020549583043798086
Bond Position:  [-7.46014258]


portfolio before change:  [-9.49651817]
curr_Stock_Price:  99.05033199699092
curr_Factors:  [99.050332]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258993]
Stock Position:  -0.052589928692153266
Bond Position:  [-4.28746828]


portfolio before change:  [-9.54250194]
curr_Stock_Price:  99.91452408742302
curr_Factors:  [99.91452409]
mat_Sqrt:  [[0.15]]
grads:  [-0.01515365]
Stock Position:  -0.015153651211654576
Bond Position:  [-8.02843209]


portfolio before change:  [-9.55430049]
curr_Stock_Price:  100.62688910524928
curr_Factors:  [100.62688911]
mat_Sqrt:  [[0.15]]
grads:  [0.002685]
Stock Position:  0.0026850024834339397
Bond Position:  [-9.82448394]


portfolio before change:  [-9.55731012]
curr_Stock_Price:  99.96339112776637
curr_Factors:  [99.96339113]
mat_Sqrt:  [[0.15]]
grads:  [0.06929409]
Stock Position:  0.06929408699828851
Bond Position:  [-16.48418204]


portfolio before change:  [-9.51218276]
curr_Stock_Price:  100.64437294451542
curr_Factors:  [100.64437294]
mat_Sqrt:  [[0.15]]
grads:  [0.0318497]
Stock Position:  0.031849703794630604
Bond Position:  [-12.71767623]


portfolio before change:  [-9.4906946]
curr_Stock_Price:  101.36896275805582
curr_Factors:  [101.36896276]
mat_Sqrt:  [[0.15]]
grads:  [0.04927871]
Stock Position:  0.04927871475685059
Bond Position:  [-14.4860268]


portfolio before change:  [-9.53237549]
curr_Stock_Price:  100.55989076524352
curr_Factors:  [100.55989077]
mat_Sqrt:  [[0.15]]
grads:  [-0.02733954]
Stock Position:  -0.027339539664059383
Bond Position:  [-6.78311437]


portfolio before change:  [-9.54053417]
curr_Stock_Price:  100.82729616124071
curr_Factors:  [100.82729616]
mat_Sqrt:  [[0.15]]
grads:  [-0.05913894]
Stock Position:  -0.05913893570348868
Bond Position:  [-3.57771519]


portfolio before change:  [-9.50219416]
curr_Stock_Price:  100.17142944307943
curr_Factors:  [100.17142944]
mat_Sqrt:  [[0.15]]
grads:  [0.09001587]
Stock Position:  0.09001586939078086
Bond Position:  [-18.51921247]


portfolio before change:  [-9.49164535]
curr_Stock_Price:  100.31433589905585
curr_Factors:  [100.3143359]
mat_Sqrt:  [[0.15]]
grads:  [-0.13358062]
Stock Position:  -0.13358062161189588
Bond Position:  [3.90840599]


portfolio before change:  [-9.42785927]
curr_Stock_Price:  99.84048349067464
curr_Factors:  [99.84048349]
mat_Sqrt:  [[0.15]]
grads:  [-0.16992054]
Stock Position:  -0.16992053910212418
Bond Position:  [7.53708951]


portfolio before change:  [-9.38396764]
curr_Stock_Price:  99.58772162029784
curr_Factors:  [99.58772162]
mat_Sqrt:  [[0.15]]
grads:  [0.14374578]
Stock Position:  0.14374577600014327
Bond Position:  [-23.69928197]


portfolio before change:  [-9.62508189]
curr_Stock_Price:  97.93096579380031
curr_Factors:  [97.93096579]
mat_Sqrt:  [[0.15]]
grads:  [0.02520403]
Stock Position:  0.02520402545527775
Bond Position:  [-12.09333645]


portfolio before change:  [-9.62274942]
curr_Stock_Price:  98.08349052784621
curr_Factors:  [98.08349053]
mat_Sqrt:  [[0.15]]
grads:  [-0.02088049]
Stock Position:  -0.02088048665349133
Bond Position:  [-7.5747184]


portfolio before change:  [-9.64207863]
curr_Stock_Price:  98.96384896435715
curr_Factors:  [98.96384896]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835565]
Stock Position:  -0.0835564999108845
Bond Position:  [-1.37300579]


portfolio before change:  [-9.6298159]
curr_Stock_Price:  98.81503509736935
curr_Factors:  [98.8150351]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028976]
Stock Position:  -0.05028975617271984
Bond Position:  [-4.66043188]


portfolio before change:  [-9.651305]
curr_Stock_Price:  99.23075625129961
curr_Factors:  [99.23075625]
mat_Sqrt:  [[0.15]]
grads:  [-0.05880517]
Stock Position:  -0.05880516786225666
Bond Position:  [-3.81602373]


portfolio before change:  [-9.62707577]
curr_Stock_Price:  98.81061857259067
curr_Factors:  [98.81061857]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019004]
Stock Position:  -0.05019004048326565
Bond Position:  [-4.66776682]


portfolio before change:  [-9.62893056]
curr_Stock_Price:  98.83594797519453
curr_Factors:  [98.83594798]
mat_Sqrt:  [[0.15]]
grads:  [0.14834191]
Stock Position:  0.14834190511858245
Bond Position:  [-24.29044338]


portfolio before change:  [-9.62666241]
curr_Stock_Price:  98.87170758369491
curr_Factors:  [98.87170758]
mat_Sqrt:  [[0.15]]
grads:  [0.05498195]
Stock Position:  0.054981952318645784
Bond Position:  [-15.06282192]


portfolio before change:  [-9.59578162]
curr_Stock_Price:  99.46760776907965
curr_Factors:  [99.46760777]
mat_Sqrt:  [[0.15]]
grads:  [0.15716962]
Stock Position:  0.15716962247003843
Bond Position:  [-25.22906798]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-9.59578162]
Stock Price:  100.05621400448885
PL:  [-9.65199563]
Settle:  Tensor("sub_114:0", shape=(), dtype=float64)
PL:  Tensor("sub_115:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  58
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.41901409e-03]
 [-1.21078646e-02]
 [-8.23543977e-03]
 [-2.43180286e-02]
 [ 9.07024778e-03]
 [ 2.28670775e-02]
 [ 2.43418726e-02]
 [-2.90903721e-03]
 [ 3.41680496e-03]
 [ 1.18586005e-02]
 [ 2.57940617e-02]
 [ 5.54651425e-03]
 [-1.21909643e-02]
 [-8.58310301e-03]
 [ 2.83734528e-03]
 [-3.07894589e-02]
 [ 4.80201869e-03]
 [-8.28751767e-03]
 [ 7.87772172e-03]
 [-3.20347614e-03]
 [-1.72469466e-03]
 [-3.96320463e-02]
 [ 4.79818258e-03]
 [ 9.15413945e-03]
 [-5.42015307e-03]
 [-4.17755001e-03]
 [-9.68853989e-04]
 [-1.65400974e-02]
 [-8.07841739e-03]
 [ 2.25526741e-02]
 [-1.46270474e-03]
 [ 6.43688801e-03]
 [-1.27683907e-02]
 [-5.91560922e-03]
 [-5.45274472e-03]
 [-2.90823996e-03]
 [ 2.36019727e-02]
 [-1.56891804e-04]
 [ 2.21621837e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.61304656]
curr_Stock_Price:  100.5587390190217
curr_Factors:  [100.55873902]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946009]
Stock Position:  -0.00946009390837752
Bond Position:  [11.56434167]


portfolio before change:  [10.61905342]
curr_Stock_Price:  100.07658499793193
curr_Factors:  [100.076585]
mat_Sqrt:  [[0.15]]
grads:  [-0.0807191]
Stock Position:  -0.08071909700334765
Bond Position:  [18.69714499]


portfolio before change:  [10.68832295]
curr_Stock_Price:  99.24738536670168
curr_Factors:  [99.24738537]
mat_Sqrt:  [[0.15]]
grads:  [-0.05490293]
Stock Position:  -0.05490293177269754
Bond Position:  [16.13729538]


portfolio before change:  [10.73314855]
curr_Stock_Price:  98.46767628828616
curr_Factors:  [98.46767629]
mat_Sqrt:  [[0.15]]
grads:  [-0.16212019]
Stock Position:  -0.16212019089180998
Bond Position:  [26.69674703]


portfolio before change:  [10.83291946]
curr_Stock_Price:  97.87284844698475
curr_Factors:  [97.87284845]
mat_Sqrt:  [[0.15]]
grads:  [0.06046832]
Stock Position:  0.06046831850166367
Bond Position:  [4.91471289]


portfolio before change:  [10.8588223]
curr_Stock_Price:  98.29105851730883
curr_Factors:  [98.29105852]
mat_Sqrt:  [[0.15]]
grads:  [0.15244718]
Stock Position:  0.1524471832966502
Bond Position:  [-4.12537272]


portfolio before change:  [11.04966481]
curr_Stock_Price:  99.54630122822122
curr_Factors:  [99.54630123]
mat_Sqrt:  [[0.15]]
grads:  [0.16227915]
Stock Position:  0.16227915054997868
Bond Position:  [-5.1046244]


portfolio before change:  [11.18030195]
curr_Stock_Price:  100.35524839679647
curr_Factors:  [100.3552484]
mat_Sqrt:  [[0.15]]
grads:  [-0.01939358]
Stock Position:  -0.019393581431617336
Bond Position:  [13.12654963]


portfolio before change:  [11.17373813]
curr_Stock_Price:  100.77831308024581
curr_Factors:  [100.77831308]
mat_Sqrt:  [[0.15]]
grads:  [0.0227787]
Stock Position:  0.02277869970823727
Bond Position:  [8.8781392]


portfolio before change:  [11.20809329]
curr_Stock_Price:  102.23780462171815
curr_Factors:  [102.23780462]
mat_Sqrt:  [[0.15]]
grads:  [0.07905734]
Stock Position:  0.0790573367795374
Bond Position:  [3.12544473]


portfolio before change:  [11.16153057]
curr_Stock_Price:  101.64388857120336
curr_Factors:  [101.64388857]
mat_Sqrt:  [[0.15]]
grads:  [0.17196041]
Stock Position:  0.1719604114547217
Bond Position:  [-6.31719433]


portfolio before change:  [11.24478993]
curr_Stock_Price:  102.13265837447716
curr_Factors:  [102.13265837]
mat_Sqrt:  [[0.15]]
grads:  [0.03697676]
Stock Position:  0.03697676167189506
Bond Position:  [7.46825496]


portfolio before change:  [11.27626705]
curr_Stock_Price:  102.95867798329397
curr_Factors:  [102.95867798]
mat_Sqrt:  [[0.15]]
grads:  [-0.0812731]
Stock Position:  -0.08127309563976726
Bond Position:  [19.64403753]


portfolio before change:  [11.10900171]
curr_Stock_Price:  105.04695816793077
curr_Factors:  [105.04695817]
mat_Sqrt:  [[0.15]]
grads:  [-0.05722069]
Stock Position:  -0.05722068670694357
Bond Position:  [17.11986079]


portfolio before change:  [11.13285627]
curr_Stock_Price:  104.66747231635587
curr_Factors:  [104.66747232]
mat_Sqrt:  [[0.15]]
grads:  [0.01891564]
Stock Position:  0.018915635173219668
Bond Position:  [9.15300455]


portfolio before change:  [11.12895142]
curr_Stock_Price:  104.40054765905741
curr_Factors:  [104.40054766]
mat_Sqrt:  [[0.15]]
grads:  [-0.20526306]
Stock Position:  -0.2052630594290109
Bond Position:  [32.55852724]


portfolio before change:  [11.03208955]
curr_Stock_Price:  104.89226756486825
curr_Factors:  [104.89226756]
mat_Sqrt:  [[0.15]]
grads:  [0.03201346]
Stock Position:  0.03201345795481678
Bond Position:  [7.67412536]


portfolio before change:  [11.02805384]
curr_Stock_Price:  104.73623822731831
curr_Factors:  [104.73623823]
mat_Sqrt:  [[0.15]]
grads:  [-0.05525012]
Stock Position:  -0.05525011777071782
Bond Position:  [16.81474334]


portfolio before change:  [11.01906593]
curr_Stock_Price:  104.93695964870409
curr_Factors:  [104.93695965]
mat_Sqrt:  [[0.15]]
grads:  [0.05251814]
Stock Position:  0.05251814482418203
Bond Position:  [5.50797149]


portfolio before change:  [10.96485594]
curr_Stock_Price:  103.8916346677374
curr_Factors:  [103.89163467]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135651]
Stock Position:  -0.02135650757201165
Bond Position:  [13.18361843]


portfolio before change:  [10.96070001]
curr_Stock_Price:  104.1634016631311
curr_Factors:  [104.16340166]
mat_Sqrt:  [[0.15]]
grads:  [-0.01149796]
Stock Position:  -0.011497964420647516
Bond Position:  [12.15836709]


portfolio before change:  [10.9611206]
curr_Stock_Price:  104.25900951121665
curr_Factors:  [104.25900951]
mat_Sqrt:  [[0.15]]
grads:  [-0.26421364]
Stock Position:  -0.26421364174946055
Bond Position:  [38.50777319]


portfolio before change:  [11.34847792]
curr_Stock_Price:  102.81115259097915
curr_Factors:  [102.81115259]
mat_Sqrt:  [[0.15]]
grads:  [0.03198788]
Stock Position:  0.03198788386621843
Bond Position:  [8.05976671]


portfolio before change:  [11.37010555]
curr_Stock_Price:  103.4557744793406
curr_Factors:  [103.45577448]
mat_Sqrt:  [[0.15]]
grads:  [0.0610276]
Stock Position:  0.06102759630209014
Bond Position:  [5.05644831]


portfolio before change:  [11.34061172]
curr_Stock_Price:  102.96213023551859
curr_Factors:  [102.96213024]
mat_Sqrt:  [[0.15]]
grads:  [-0.03613435]
Stock Position:  -0.03613435381329545
Bond Position:  [15.06108176]


portfolio before change:  [11.34985409]
curr_Stock_Price:  102.75845656812149
curr_Factors:  [102.75845657]
mat_Sqrt:  [[0.15]]
grads:  [-0.02785033]
Stock Position:  -0.027850333411180234
Bond Position:  [14.21171137]


portfolio before change:  [11.36031839]
curr_Stock_Price:  102.44651315152517
curr_Factors:  [102.44651315]
mat_Sqrt:  [[0.15]]
grads:  [-0.00645903]
Stock Position:  -0.0064590265916622544
Bond Position:  [12.02202315]


portfolio before change:  [11.36661456]
curr_Stock_Price:  101.70440152848427
curr_Factors:  [101.70440153]
mat_Sqrt:  [[0.15]]
grads:  [-0.11026732]
Stock Position:  -0.11026731631441168
Bond Position:  [22.58128597]


portfolio before change:  [11.33478577]
curr_Stock_Price:  102.01865267867912
curr_Factors:  [102.01865268]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385612]
Stock Position:  -0.05385611594756969
Bond Position:  [16.82911415]


portfolio before change:  [11.34560434]
curr_Stock_Price:  101.85683627820806
curr_Factors:  [101.85683628]
mat_Sqrt:  [[0.15]]
grads:  [0.15035116]
Stock Position:  0.15035116040184648
Bond Position:  [-3.96868919]


portfolio before change:  [11.37897427]
curr_Stock_Price:  102.08208259932584
curr_Factors:  [102.0820826]
mat_Sqrt:  [[0.15]]
grads:  [-0.00975136]
Stock Position:  -0.009751364941072179
Bond Position:  [12.37441391]


portfolio before change:  [11.37369149]
curr_Stock_Price:  102.78246381634078
curr_Factors:  [102.78246382]
mat_Sqrt:  [[0.15]]
grads:  [0.04291259]
Stock Position:  0.04291258670848777
Bond Position:  [6.9630301]


portfolio before change:  [11.36459525]
curr_Stock_Price:  102.55020857619087
curr_Factors:  [102.55020858]
mat_Sqrt:  [[0.15]]
grads:  [-0.0851226]
Stock Position:  -0.085122604345213
Bond Position:  [20.09393608]


portfolio before change:  [11.41496652]
curr_Stock_Price:  101.9879681113384
curr_Factors:  [101.98796811]
mat_Sqrt:  [[0.15]]
grads:  [-0.03943739]
Stock Position:  -0.03943739481119033
Bond Position:  [15.43710629]


portfolio before change:  [11.42459349]
curr_Stock_Price:  101.79279283307312
curr_Factors:  [101.79279283]
mat_Sqrt:  [[0.15]]
grads:  [-0.03635163]
Stock Position:  -0.03635163147775205
Bond Position:  [15.12492758]


portfolio before change:  [11.38887763]
curr_Stock_Price:  102.82731571880794
curr_Factors:  [102.82731572]
mat_Sqrt:  [[0.15]]
grads:  [-0.01938827]
Stock Position:  -0.01938826636734806
Bond Position:  [13.38252101]


portfolio before change:  [11.37635184]
curr_Stock_Price:  103.55965058524326
curr_Factors:  [103.55965059]
mat_Sqrt:  [[0.15]]
grads:  [0.15734648]
Stock Position:  0.15734648462743575
Bond Position:  [-4.91839513]


portfolio before change:  [11.2328399]
curr_Stock_Price:  102.6514821522535
curr_Factors:  [102.65148215]
mat_Sqrt:  [[0.15]]
grads:  [-0.00104595]
Stock Position:  -0.0010459453598597283
Bond Position:  [11.34020774]


portfolio before change:  [11.234647]
curr_Stock_Price:  102.27910167273713
curr_Factors:  [102.27910167]
mat_Sqrt:  [[0.15]]
grads:  [0.14774789]
Stock Position:  0.14774789133798388
Bond Position:  [-3.8768746]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.234647]
Stock Price:  101.36130102641349
PL:  [9.87334597]
Settle:  Tensor("sub_116:0", shape=(), dtype=float64)
PL:  Tensor("sub_117:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  59
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.64177616e-03]
 [-5.12963594e-03]
 [-1.92846901e-02]
 [-9.98672399e-03]
 [ 1.34564886e-02]
 [ 1.74653454e-02]
 [ 2.71795420e-02]
 [-3.08325682e-03]
 [ 4.42849034e-03]
 [ 1.08997069e-02]
 [ 1.76710859e-02]
 [ 1.06132167e-02]
 [-1.15703711e-02]
 [ 1.17460902e-02]
 [-5.93287150e-03]
 [-2.34175251e-02]
 [ 4.98470652e-03]
 [-5.28217503e-03]
 [ 3.49379767e-03]
 [-3.01757015e-03]
 [-1.28665598e-03]
 [-3.17114148e-02]
 [ 4.80809540e-03]
 [ 1.08291266e-02]
 [-5.57914618e-03]
 [ 1.38948139e-02]
 [-1.56292613e-02]
 [ 9.47185359e-03]
 [ 7.61109154e-02]
 [ 2.73169893e-02]
 [-3.00015137e-02]
 [ 4.74223429e-03]
 [-1.30993245e-02]
 [ 2.57793476e-03]
 [-6.23614360e-03]
 [-5.94059937e-04]
 [ 2.38615154e-02]
 [ 1.18382151e-03]
 [ 2.05311441e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.06448769]
curr_Stock_Price:  100.0080231564095
curr_Factors:  [100.00802316]
mat_Sqrt:  [[0.15]]
grads:  [-0.01094517]
Stock Position:  -0.010945174418636983
Bond Position:  [3.15909295]


portfolio before change:  [2.06629905]
curr_Stock_Price:  99.878610127349
curr_Factors:  [99.87861013]
mat_Sqrt:  [[0.15]]
grads:  [-0.03419757]
Stock Position:  -0.03419757292293885
Bond Position:  [5.48190511]


portfolio before change:  [2.10231695]
curr_Stock_Price:  98.8454194144455
curr_Factors:  [98.84541941]
mat_Sqrt:  [[0.15]]
grads:  [-0.1285646]
Stock Position:  -0.12856460075185958
Bond Position:  [14.81033883]


portfolio before change:  [2.04607628]
curr_Stock_Price:  99.29727064337256
curr_Factors:  [99.29727064]
mat_Sqrt:  [[0.15]]
grads:  [-0.06657816]
Stock Position:  -0.06657815991729028
Bond Position:  [8.65710585]


portfolio before change:  [2.05457762]
curr_Stock_Price:  99.1858357059051
curr_Factors:  [99.18583571]
mat_Sqrt:  [[0.15]]
grads:  [0.08970992]
Stock Position:  0.08970992392916019
Bond Position:  [-6.84337615]


portfolio before change:  [2.15631032]
curr_Stock_Price:  100.32939002103481
curr_Factors:  [100.32939002]
mat_Sqrt:  [[0.15]]
grads:  [0.11643564]
Stock Position:  0.11643563570080825
Bond Position:  [-9.52560599]


portfolio before change:  [2.14935055]
curr_Stock_Price:  100.27984338441709
curr_Factors:  [100.27984338]
mat_Sqrt:  [[0.15]]
grads:  [0.18119695]
Stock Position:  0.18119694676161954
Bond Position:  [-16.02105089]


portfolio before change:  [2.07490296]
curr_Stock_Price:  99.8800307127964
curr_Factors:  [99.88003071]
mat_Sqrt:  [[0.15]]
grads:  [-0.02055505]
Stock Position:  -0.020555045485893444
Bond Position:  [4.12794153]


portfolio before change:  [2.06200169]
curr_Stock_Price:  100.53277998249143
curr_Factors:  [100.53277998]
mat_Sqrt:  [[0.15]]
grads:  [0.02952327]
Stock Position:  0.02952326892272268
Bond Position:  [-0.90605461]


portfolio before change:  [2.09623144]
curr_Stock_Price:  101.69603218601738
curr_Factors:  [101.69603219]
mat_Sqrt:  [[0.15]]
grads:  [0.07266471]
Stock Position:  0.07266471282975044
Bond Position:  [-5.29348154]


portfolio before change:  [2.03373496]
curr_Stock_Price:  100.84507241413476
curr_Factors:  [100.84507241]
mat_Sqrt:  [[0.15]]
grads:  [0.11780724]
Stock Position:  0.11780723914608353
Bond Position:  [-9.8465446]


portfolio before change:  [2.08075624]
curr_Stock_Price:  101.25465823374802
curr_Factors:  [101.25465823]
mat_Sqrt:  [[0.15]]
grads:  [0.07075478]
Stock Position:  0.07075477796776043
Bond Position:  [-5.08349462]


portfolio before change:  [2.12232707]
curr_Stock_Price:  101.85117355990246
curr_Factors:  [101.85117356]
mat_Sqrt:  [[0.15]]
grads:  [-0.07713581]
Stock Position:  -0.07713580736202394
Bond Position:  [9.97869958]


portfolio before change:  [2.18649125]
curr_Stock_Price:  101.03551138249293
curr_Factors:  [101.03551138]
mat_Sqrt:  [[0.15]]
grads:  [0.07830727]
Stock Position:  0.07830726803998647
Bond Position:  [-5.72532362]


portfolio before change:  [2.1359004]
curr_Stock_Price:  100.39859557266954
curr_Factors:  [100.39859557]
mat_Sqrt:  [[0.15]]
grads:  [-0.03955248]
Stock Position:  -0.03955247665098948
Bond Position:  [6.10691351]


portfolio before change:  [2.12509069]
curr_Stock_Price:  100.69119722348503
curr_Factors:  [100.69119722]
mat_Sqrt:  [[0.15]]
grads:  [-0.15611683]
Stock Position:  -0.15611683389305409
Bond Position:  [17.84468161]


portfolio before change:  [1.71083733]
curr_Stock_Price:  103.35896903772503
curr_Factors:  [103.35896904]
mat_Sqrt:  [[0.15]]
grads:  [0.03323138]
Stock Position:  0.03323137679463513
Bond Position:  [-1.72392352]


portfolio before change:  [1.72737027]
curr_Stock_Price:  103.86296401132027
curr_Factors:  [103.86296401]
mat_Sqrt:  [[0.15]]
grads:  [-0.0352145]
Stock Position:  -0.03521450021923853
Bond Position:  [5.38485264]


portfolio before change:  [1.72447318]
curr_Stock_Price:  103.96434948131055
curr_Factors:  [103.96434948]
mat_Sqrt:  [[0.15]]
grads:  [0.02329198]
Stock Position:  0.02329198448093493
Bond Position:  [-0.69706283]


portfolio before change:  [1.71078724]
curr_Stock_Price:  103.38050884423122
curr_Factors:  [103.38050884]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011713]
Stock Position:  -0.020117134331179887
Bond Position:  [3.79050682]


portfolio before change:  [1.71380572]
curr_Stock_Price:  103.25401761554114
curr_Factors:  [103.25401762]
mat_Sqrt:  [[0.15]]
grads:  [-0.00857771]
Stock Position:  -0.008577706524378538
Bond Position:  [2.59948838]


portfolio before change:  [1.7175178]
curr_Stock_Price:  102.85914278777143
curr_Factors:  [102.85914279]
mat_Sqrt:  [[0.15]]
grads:  [-0.21140943]
Stock Position:  -0.21140943169656215
Bond Position:  [23.46291072]


portfolio before change:  [1.56190093]
curr_Stock_Price:  103.60910890927967
curr_Factors:  [103.60910891]
mat_Sqrt:  [[0.15]]
grads:  [0.03205397]
Stock Position:  0.03205396931310024
Bond Position:  [-1.75918226]


portfolio before change:  [1.60728366]
curr_Stock_Price:  105.03179191052928
curr_Factors:  [105.03179191]
mat_Sqrt:  [[0.15]]
grads:  [0.07219418]
Stock Position:  0.07219417752347781
Bond Position:  [-5.97540017]


portfolio before change:  [1.60578374]
curr_Stock_Price:  105.02136249472655
curr_Factors:  [105.02136249]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719431]
Stock Position:  -0.037194307834496794
Bond Position:  [5.51198063]


portfolio before change:  [1.55136571]
curr_Stock_Price:  106.5029621419031
curr_Factors:  [106.50296214]
mat_Sqrt:  [[0.15]]
grads:  [0.09263209]
Stock Position:  0.09263209289575268
Bond Position:  [-8.31422657]


portfolio before change:  [1.62706392]
curr_Stock_Price:  107.33137428286274
curr_Factors:  [107.33137428]
mat_Sqrt:  [[0.15]]
grads:  [-0.10419508]
Stock Position:  -0.10419507535609741
Bond Position:  [12.81046455]


portfolio before change:  [1.66739668]
curr_Stock_Price:  106.95965469140909
curr_Factors:  [106.95965469]
mat_Sqrt:  [[0.15]]
grads:  [0.06314569]
Stock Position:  0.06314569061627541
Bond Position:  [-5.08664459]


portfolio before change:  [1.711483]
curr_Stock_Price:  107.66789299450477
curr_Factors:  [107.66789299]
mat_Sqrt:  [[0.15]]
grads:  [0.5074061]
Stock Position:  0.507406102888093
Bond Position:  [-52.91986299]


portfolio before change:  [1.50997862]
curr_Stock_Price:  107.28380422348481
curr_Factors:  [107.28380422]
mat_Sqrt:  [[0.15]]
grads:  [0.18211326]
Stock Position:  0.18211326223476715
Bond Position:  [-18.02782495]


portfolio before change:  [1.40757125]
curr_Stock_Price:  106.73385113580174
curr_Factors:  [106.73385114]
mat_Sqrt:  [[0.15]]
grads:  [-0.20001009]
Stock Position:  -0.20001009159220676
Bond Position:  [22.75541859]


portfolio before change:  [1.44977198]
curr_Stock_Price:  106.53708046630848
curr_Factors:  [106.53708047]
mat_Sqrt:  [[0.15]]
grads:  [0.0316149]
Stock Position:  0.031614895234248756
Bond Position:  [-1.91838666]


portfolio before change:  [1.41684629]
curr_Stock_Price:  105.50320474389615
curr_Factors:  [105.50320474]
mat_Sqrt:  [[0.15]]
grads:  [-0.08732883]
Stock Position:  -0.0873288300270838
Bond Position:  [10.63031773]


portfolio before change:  [1.43073173]
curr_Stock_Price:  105.35941987732623
curr_Factors:  [105.35941988]
mat_Sqrt:  [[0.15]]
grads:  [0.01718623]
Stock Position:  0.017186231762809243
Bond Position:  [-0.37999968]


portfolio before change:  [1.42369059]
curr_Stock_Price:  104.95248723426644
curr_Factors:  [104.95248723]
mat_Sqrt:  [[0.15]]
grads:  [-0.04157429]
Stock Position:  -0.04157429065548883
Bond Position:  [5.7870158]


portfolio before change:  [1.46458206]
curr_Stock_Price:  103.98631186556982
curr_Factors:  [103.98631187]
mat_Sqrt:  [[0.15]]
grads:  [-0.0039604]
Stock Position:  -0.003960399580296356
Bond Position:  [1.87640941]


portfolio before change:  [1.46474109]
curr_Stock_Price:  104.0053848607273
curr_Factors:  [104.00538486]
mat_Sqrt:  [[0.15]]
grads:  [0.15907677]
Stock Position:  0.15907676901375514
Bond Position:  [-15.08009949]


portfolio before change:  [1.54569195]
curr_Stock_Price:  104.52611449891192
curr_Factors:  [104.5261145]
mat_Sqrt:  [[0.15]]
grads:  [0.00789214]
Stock Position:  0.007892143430878972
Bond Position:  [0.72075686]


portfolio before change:  [1.54449791]
curr_Stock_Price:  104.36340314300793
curr_Factors:  [104.36340314]
mat_Sqrt:  [[0.15]]
grads:  [0.13687429]
Stock Position:  0.13687429423451358
Bond Position:  [-12.74016924]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.54449791]
Stock Price:  104.61391490125955
PL:  [-3.06941699]
Settle:  Tensor("sub_118:0", shape=(), dtype=float64)
PL:  Tensor("sub_119:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  60
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.89876034e-03]
 [-4.06795353e-03]
 [ 2.04382736e-02]
 [-1.65813820e-02]
 [ 9.82088290e-03]
 [ 2.26802718e-02]
 [ 1.39294944e-02]
 [-2.99582768e-03]
 [ 2.77546259e-03]
 [ 1.16696530e-02]
 [ 2.72303095e-02]
 [ 9.29353866e-03]
 [-1.16361701e-02]
 [ 1.05163882e-02]
 [-2.94201498e-03]
 [-2.78976012e-02]
 [ 4.66166360e-03]
 [-1.23070622e-03]
 [-1.19024935e-02]
 [-2.22830315e-03]
 [ 4.05570165e-04]
 [-2.79125365e-02]
 [ 4.81496990e-03]
 [ 9.53005889e-03]
 [-5.55042023e-03]
 [-1.85607159e-03]
 [-7.70935324e-03]
 [ 1.65850650e-03]
 [ 5.96181199e-02]
 [ 2.71680065e-02]
 [-2.13467559e-02]
 [ 4.20792839e-03]
 [-1.32155468e-02]
 [ 5.61615879e-03]
 [-7.46202344e-03]
 [ 6.16775905e-03]
 [ 2.50136189e-02]
 [ 7.86014274e-03]
 [ 1.83425894e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.64212079]
curr_Stock_Price:  101.39809895852446
curr_Factors:  [101.39809896]
mat_Sqrt:  [[0.15]]
grads:  [-0.02599174]
Stock Position:  -0.025991735568501595
Bond Position:  [26.27763336]


portfolio before change:  [23.6482293]
curr_Stock_Price:  101.28946427997346
curr_Factors:  [101.28946428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02711969]
Stock Position:  -0.027119690230223426
Bond Position:  [26.3951682]


portfolio before change:  [23.68493173]
curr_Stock_Price:  100.05778261399433
curr_Factors:  [100.05778261]
mat_Sqrt:  [[0.15]]
grads:  [0.13625516]
Stock Position:  0.13625515738038205
Bond Position:  [10.05154281]


portfolio before change:  [23.52419969]
curr_Stock_Price:  98.86892071162977
curr_Factors:  [98.86892071]
mat_Sqrt:  [[0.15]]
grads:  [-0.11054255]
Stock Position:  -0.11054254661097807
Bond Position:  [34.45342196]


portfolio before change:  [23.63331897]
curr_Stock_Price:  97.92075782982262
curr_Factors:  [97.92075783]
mat_Sqrt:  [[0.15]]
grads:  [0.06547255]
Stock Position:  0.06547255264215464
Bond Position:  [17.222197]


portfolio before change:  [23.66520593]
curr_Stock_Price:  98.37490301446464
curr_Factors:  [98.37490301]
mat_Sqrt:  [[0.15]]
grads:  [0.15120181]
Stock Position:  0.15120181214315184
Bond Position:  [8.79074232]


portfolio before change:  [23.70148672]
curr_Stock_Price:  98.60758461431361
curr_Factors:  [98.60758461]
mat_Sqrt:  [[0.15]]
grads:  [0.0928633]
Stock Position:  0.09286329581472846
Bond Position:  [14.54446142]


portfolio before change:  [23.80761345]
curr_Stock_Price:  99.73083313541885
curr_Factors:  [99.73083314]
mat_Sqrt:  [[0.15]]
grads:  [-0.01997218]
Stock Position:  -0.019972184538765057
Bond Position:  [25.79945605]


portfolio before change:  [23.78637116]
curr_Stock_Price:  100.95590813968762
curr_Factors:  [100.95590814]
mat_Sqrt:  [[0.15]]
grads:  [0.01850308]
Stock Position:  0.01850308392096143
Bond Position:  [21.91837552]


portfolio before change:  [23.80931377]
curr_Stock_Price:  102.04776117372947
curr_Factors:  [102.04776117]
mat_Sqrt:  [[0.15]]
grads:  [0.07779769]
Stock Position:  0.07779768691998394
Bond Position:  [15.870234]


portfolio before change:  [23.81376759]
curr_Stock_Price:  102.07950903430255
curr_Factors:  [102.07950903]
mat_Sqrt:  [[0.15]]
grads:  [0.1815354]
Stock Position:  0.18153539672869645
Bond Position:  [5.28272342]


portfolio before change:  [23.75049722]
curr_Stock_Price:  101.72734218766747
curr_Factors:  [101.72734219]
mat_Sqrt:  [[0.15]]
grads:  [0.06195692]
Stock Position:  0.06195692442197696
Bond Position:  [17.44778397]


portfolio before change:  [23.76586823]
curr_Stock_Price:  101.94023037929244
curr_Factors:  [101.94023038]
mat_Sqrt:  [[0.15]]
grads:  [-0.07757447]
Stock Position:  -0.07757446752850337
Bond Position:  [31.67382732]


portfolio before change:  [23.71497287]
curr_Stock_Price:  102.64735518587271
curr_Factors:  [102.64735519]
mat_Sqrt:  [[0.15]]
grads:  [0.07010925]
Stock Position:  0.07010925450672784
Bond Position:  [16.51844332]


portfolio before change:  [23.70958355]
curr_Stock_Price:  102.54103176462652
curr_Factors:  [102.54103176]
mat_Sqrt:  [[0.15]]
grads:  [-0.01961343]
Stock Position:  -0.019613433185700337
Bond Position:  [25.72076523]


portfolio before change:  [23.73405502]
curr_Stock_Price:  101.45727615972315
curr_Factors:  [101.45727616]
mat_Sqrt:  [[0.15]]
grads:  [-0.18598401]
Stock Position:  -0.18598400786260966
Bond Position:  [42.60348586]


portfolio before change:  [23.84868072]
curr_Stock_Price:  100.86959158837716
curr_Factors:  [100.86959159]
mat_Sqrt:  [[0.15]]
grads:  [0.03107776]
Stock Position:  0.031077757301327797
Bond Position:  [20.71388003]


portfolio before change:  [23.85375956]
curr_Stock_Price:  100.9496954325474
curr_Factors:  [100.94969543]
mat_Sqrt:  [[0.15]]
grads:  [-0.00820471]
Stock Position:  -0.008204708137273338
Bond Position:  [24.68202235]


portfolio before change:  [23.85879189]
curr_Stock_Price:  100.71240724560052
curr_Factors:  [100.71240725]
mat_Sqrt:  [[0.15]]
grads:  [-0.07934996]
Stock Position:  -0.07934995694218075
Bond Position:  [31.85031707]


portfolio before change:  [23.8996936]
curr_Stock_Price:  100.24712437204403
curr_Factors:  [100.24712437]
mat_Sqrt:  [[0.15]]
grads:  [-0.01485535]
Stock Position:  -0.014855354324181672
Bond Position:  [25.38890015]


portfolio before change:  [23.89847203]
curr_Stock_Price:  100.54300336887646
curr_Factors:  [100.54300337]
mat_Sqrt:  [[0.15]]
grads:  [0.0027038]
Stock Position:  0.002703801099045829
Bond Position:  [23.62662374]


portfolio before change:  [23.90578361]
curr_Stock_Price:  102.15483465367431
curr_Factors:  [102.15483465]
mat_Sqrt:  [[0.15]]
grads:  [-0.18608358]
Stock Position:  -0.18608357675406356
Bond Position:  [42.91512062]


portfolio before change:  [23.53180728]
curr_Stock_Price:  104.19338669679851
curr_Factors:  [104.1933867]
mat_Sqrt:  [[0.15]]
grads:  [0.0320998]
Stock Position:  0.03209979935111781
Bond Position:  [20.18722047]


portfolio before change:  [23.52430543]
curr_Stock_Price:  103.88106665929739
curr_Factors:  [103.88106666]
mat_Sqrt:  [[0.15]]
grads:  [0.06353373]
Stock Position:  0.06353372593893919
Bond Position:  [16.92435421]


portfolio before change:  [23.56121835]
curr_Stock_Price:  104.42876386585044
curr_Factors:  [104.42876387]
mat_Sqrt:  [[0.15]]
grads:  [-0.0370028]
Stock Position:  -0.03700280154739229
Bond Position:  [27.42537517]


portfolio before change:  [23.60305789]
curr_Stock_Price:  103.39070326247194
curr_Factors:  [103.39070326]
mat_Sqrt:  [[0.15]]
grads:  [-0.01237381]
Stock Position:  -0.012373810597858127
Bond Position:  [24.88239487]


portfolio before change:  [23.58991167]
curr_Stock_Price:  104.70450340099366
curr_Factors:  [104.7045034]
mat_Sqrt:  [[0.15]]
grads:  [-0.05139569]
Stock Position:  -0.051395688268541906
Bond Position:  [28.97127168]


portfolio before change:  [23.58577992]
curr_Stock_Price:  104.85535995838156
curr_Factors:  [104.85535996]
mat_Sqrt:  [[0.15]]
grads:  [0.01105671]
Stock Position:  0.011056709993490673
Bond Position:  [22.42642462]


portfolio before change:  [23.60694846]
curr_Stock_Price:  106.51634754377041
curr_Factors:  [106.51634754]
mat_Sqrt:  [[0.15]]
grads:  [0.39745413]
Stock Position:  0.39745413262958695
Bond Position:  [-18.72841406]


portfolio before change:  [23.81862567]
curr_Stock_Price:  107.054820763114
curr_Factors:  [107.05482076]
mat_Sqrt:  [[0.15]]
grads:  [0.18112004]
Stock Position:  0.18112004312267518
Bond Position:  [4.42885192]


portfolio before change:  [23.4860872]
curr_Stock_Price:  105.21575255249253
curr_Factors:  [105.21575255]
mat_Sqrt:  [[0.15]]
grads:  [-0.14231171]
Stock Position:  -0.14231170610477278
Bond Position:  [38.45952045]


portfolio before change:  [23.25562709]
curr_Stock_Price:  106.86893947316565
curr_Factors:  [106.86893947]
mat_Sqrt:  [[0.15]]
grads:  [0.02805286]
Stock Position:  0.028052855929676743
Bond Position:  [20.25764812]


portfolio before change:  [23.26410272]
curr_Stock_Price:  107.08079911107846
curr_Factors:  [107.08079911]
mat_Sqrt:  [[0.15]]
grads:  [-0.08810365]
Stock Position:  -0.08810364525164327
Bond Position:  [32.69831146]


portfolio before change:  [23.24560965]
curr_Stock_Price:  107.33709508879141
curr_Factors:  [107.33709509]
mat_Sqrt:  [[0.15]]
grads:  [0.03744106]
Stock Position:  0.03744105858231608
Bond Position:  [19.22679519]


portfolio before change:  [23.27341116]
curr_Stock_Price:  108.0154413906754
curr_Factors:  [108.01544139]
mat_Sqrt:  [[0.15]]
grads:  [-0.04974682]
Stock Position:  -0.049746822944183915
Bond Position:  [28.64683619]


portfolio before change:  [23.30412436]
curr_Stock_Price:  107.47003719031089
curr_Factors:  [107.47003719]
mat_Sqrt:  [[0.15]]
grads:  [0.04111839]
Stock Position:  0.041118393678222474
Bond Position:  [18.88512906]


portfolio before change:  [23.36335751]
curr_Stock_Price:  108.85317395289864
curr_Factors:  [108.85317395]
mat_Sqrt:  [[0.15]]
grads:  [0.16675746]
Stock Position:  0.1667574594685314
Bond Position:  [5.21127877]


portfolio before change:  [23.11859276]
curr_Stock_Price:  107.38147848132212
curr_Factors:  [107.38147848]
mat_Sqrt:  [[0.15]]
grads:  [0.05240095]
Stock Position:  0.052400951620875685
Bond Position:  [17.4917011]


portfolio before change:  [23.15621433]
curr_Stock_Price:  108.05770599814434
curr_Factors:  [108.057706]
mat_Sqrt:  [[0.15]]
grads:  [0.12228393]
Stock Position:  0.12228392934611247
Bond Position:  [9.94249344]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.15621433]
Stock Price:  108.41558291495481
PL:  [14.74063141]
Settle:  Tensor("sub_120:0", shape=(), dtype=float64)
PL:  Tensor("sub_121:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  61
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.74684888e-03]
 [ 2.42430908e-03]
 [-3.20966401e-02]
 [-2.81213723e-02]
 [ 1.36135540e-02]
 [ 2.24795661e-02]
 [ 2.72762361e-02]
 [-2.30440105e-03]
 [ 5.11451862e-03]
 [ 1.55936176e-03]
 [ 4.56077463e-03]
 [ 1.04727801e-02]
 [-1.08782297e-02]
 [ 1.17443720e-02]
 [-6.62241412e-03]
 [-1.98442442e-02]
 [ 4.52995572e-03]
 [ 1.73062223e-03]
 [-6.72431795e-03]
 [-2.27477909e-03]
 [-5.32302841e-04]
 [-3.08719301e-02]
 [ 4.81308449e-03]
 [ 9.44077254e-03]
 [-5.54111102e-03]
 [ 4.22732676e-03]
 [-6.82706740e-03]
 [-1.43384374e-03]
 [ 3.10796657e-02]
 [ 2.43117699e-02]
 [-9.95850961e-03]
 [ 6.41492861e-03]
 [-1.29554774e-02]
 [ 3.29058939e-04]
 [-5.86953551e-03]
 [-8.86230925e-04]
 [ 2.34345912e-02]
 [ 1.48855106e-03]
 [ 2.04021351e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.26875337]
curr_Stock_Price:  98.76253573593225
curr_Factors:  [98.76253574]
mat_Sqrt:  [[0.15]]
grads:  [-0.03831233]
Stock Position:  -0.03831232587611449
Bond Position:  [-13.48493092]


portfolio before change:  [-17.2896052]
curr_Stock_Price:  99.26279538378535
curr_Factors:  [99.26279538]
mat_Sqrt:  [[0.15]]
grads:  [0.01616206]
Stock Position:  0.016162060563647454
Bond Position:  [-18.89389652]


portfolio before change:  [-17.30933918]
curr_Stock_Price:  98.18792662777783
curr_Factors:  [98.18792663]
mat_Sqrt:  [[0.15]]
grads:  [-0.2139776]
Stock Position:  -0.21397760096200938
Bond Position:  [3.7006778]


portfolio before change:  [-17.23827926]
curr_Stock_Price:  97.85799812637977
curr_Factors:  [97.85799813]
mat_Sqrt:  [[0.15]]
grads:  [-0.18747582]
Stock Position:  -0.18747581531810723
Bond Position:  [1.10772872]


portfolio before change:  [-17.2983409]
curr_Stock_Price:  98.17910682287383
curr_Factors:  [98.17910682]
mat_Sqrt:  [[0.15]]
grads:  [0.09075703]
Stock Position:  0.09075702658315639
Bond Position:  [-26.20878471]


portfolio before change:  [-17.27567163]
curr_Stock_Price:  98.4649863177714
curr_Factors:  [98.46498632]
mat_Sqrt:  [[0.15]]
grads:  [0.14986377]
Stock Position:  0.1498637738561355
Bond Position:  [-32.03200607]


portfolio before change:  [-17.05256605]
curr_Stock_Price:  99.98042814914125
curr_Factors:  [99.98042815]
mat_Sqrt:  [[0.15]]
grads:  [0.18184157]
Stock Position:  0.18184157393319644
Bond Position:  [-35.23316447]


portfolio before change:  [-16.89482128]
curr_Stock_Price:  100.87213397447884
curr_Factors:  [100.87213397]
mat_Sqrt:  [[0.15]]
grads:  [-0.01536267]
Stock Position:  -0.015362673637452218
Bond Position:  [-15.34515561]


portfolio before change:  [-16.8895308]
curr_Stock_Price:  100.40289612473265
curr_Factors:  [100.40289612]
mat_Sqrt:  [[0.15]]
grads:  [0.03409679]
Stock Position:  0.03409679082015558
Bond Position:  [-20.31294734]


portfolio before change:  [-16.89681084]
curr_Stock_Price:  100.26385765862396
curr_Factors:  [100.26385766]
mat_Sqrt:  [[0.15]]
grads:  [0.01039575]
Stock Position:  0.010395745086281227
Bond Position:  [-17.93912834]


portfolio before change:  [-16.90662108]
curr_Stock_Price:  99.53589561008548
curr_Factors:  [99.53589561]
mat_Sqrt:  [[0.15]]
grads:  [0.03040516]
Stock Position:  0.03040516418905295
Bond Position:  [-19.93302633]


portfolio before change:  [-16.86907481]
curr_Stock_Price:  100.85271292079906
curr_Factors:  [100.85271292]
mat_Sqrt:  [[0.15]]
grads:  [0.06981853]
Stock Position:  0.06981853388044791
Bond Position:  [-23.91046337]


portfolio before change:  [-16.85982536]
curr_Stock_Price:  101.02800238324228
curr_Factors:  [101.02800238]
mat_Sqrt:  [[0.15]]
grads:  [-0.07252153]
Stock Position:  -0.07252153151385846
Bond Position:  [-9.5331199]


portfolio before change:  [-16.8627786]
curr_Stock_Price:  101.0522921869346
curr_Factors:  [101.05229219]
mat_Sqrt:  [[0.15]]
grads:  [0.07829581]
Stock Position:  0.07829581363872773
Bond Position:  [-24.77475004]


portfolio before change:  [-16.83937675]
curr_Stock_Price:  101.39073803568196
curr_Factors:  [101.39073804]
mat_Sqrt:  [[0.15]]
grads:  [-0.04414943]
Stock Position:  -0.04414942746949246
Bond Position:  [-12.36303371]


portfolio before change:  [-16.79615352]
curr_Stock_Price:  100.37671127930399
curr_Factors:  [100.37671128]
mat_Sqrt:  [[0.15]]
grads:  [-0.13229496]
Stock Position:  -0.13229496161447807
Bond Position:  [-3.51682036]


portfolio before change:  [-16.8947149]
curr_Stock_Price:  101.11840052272352
curr_Factors:  [101.11840052]
mat_Sqrt:  [[0.15]]
grads:  [0.0301997]
Stock Position:  0.030199704812519993
Bond Position:  [-19.94846075]


portfolio before change:  [-16.88411086]
curr_Stock_Price:  101.55210523603442
curr_Factors:  [101.55210524]
mat_Sqrt:  [[0.15]]
grads:  [0.01153748]
Stock Position:  0.011537481542099524
Bond Position:  [-18.0557664]


portfolio before change:  [-16.88410442]
curr_Stock_Price:  101.74829687131488
curr_Factors:  [101.74829687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04482879]
Stock Position:  -0.044828786348392664
Bond Position:  [-12.32285176]


portfolio before change:  [-16.86859447]
curr_Stock_Price:  101.3679520490626
curr_Factors:  [101.36795205]
mat_Sqrt:  [[0.15]]
grads:  [-0.01516519]
Stock Position:  -0.015165193909523646
Bond Position:  [-15.33132982]


portfolio before change:  [-16.88121354]
curr_Stock_Price:  102.07368167512632
curr_Factors:  [102.07368168]
mat_Sqrt:  [[0.15]]
grads:  [-0.00354869]
Stock Position:  -0.0035486856048640722
Bond Position:  [-16.51898613]


portfolio before change:  [-16.88560017]
curr_Stock_Price:  102.72790510543871
curr_Factors:  [102.72790511]
mat_Sqrt:  [[0.15]]
grads:  [-0.20581287]
Stock Position:  -0.20581286758956147
Bond Position:  [4.25712456]


portfolio before change:  [-17.15011483]
curr_Stock_Price:  104.01571008462396
curr_Factors:  [104.01571008]
mat_Sqrt:  [[0.15]]
grads:  [0.03208723]
Stock Position:  0.03208722991399909
Bond Position:  [-20.48769084]


portfolio before change:  [-17.15995942]
curr_Stock_Price:  103.78872043411859
curr_Factors:  [103.78872043]
mat_Sqrt:  [[0.15]]
grads:  [0.06293848]
Stock Position:  0.06293848357388165
Bond Position:  [-23.6922641]


portfolio before change:  [-17.1347247]
curr_Stock_Price:  104.23672050200553
curr_Factors:  [104.2367205]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694074]
Stock Position:  -0.036940740128784864
Bond Position:  [-13.28414309]


portfolio before change:  [-17.14945956]
curr_Stock_Price:  104.59064531441577
curr_Factors:  [104.59064531]
mat_Sqrt:  [[0.15]]
grads:  [0.02818218]
Stock Position:  0.02818217838298579
Bond Position:  [-20.09705179]


portfolio before change:  [-17.15701021]
curr_Stock_Price:  104.41186730450612
curr_Factors:  [104.4118673]
mat_Sqrt:  [[0.15]]
grads:  [-0.04551378]
Stock Position:  -0.04551378267474948
Bond Position:  [-12.40483117]


portfolio before change:  [-17.15170897]
curr_Stock_Price:  104.26132094574014
curr_Factors:  [104.26132095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00955896]
Stock Position:  -0.009558958257090133
Bond Position:  [-16.15507936]


portfolio before change:  [-17.15669746]
curr_Stock_Price:  104.57191755901592
curr_Factors:  [104.57191756]
mat_Sqrt:  [[0.15]]
grads:  [0.20719777]
Stock Position:  0.2071977711788522
Bond Position:  [-38.82376571]


portfolio before change:  [-17.43501197]
curr_Stock_Price:  103.2521097621509
curr_Factors:  [103.25210976]
mat_Sqrt:  [[0.15]]
grads:  [0.16207847]
Stock Position:  0.16207846607438672
Bond Position:  [-34.16995554]


portfolio before change:  [-17.44478228]
curr_Stock_Price:  103.21818301454601
curr_Factors:  [103.21818301]
mat_Sqrt:  [[0.15]]
grads:  [-0.06639006]
Stock Position:  -0.06639006405491843
Bond Position:  [-10.5921205]


portfolio before change:  [-17.4242341]
curr_Stock_Price:  102.88873190344034
curr_Factors:  [102.8887319]
mat_Sqrt:  [[0.15]]
grads:  [0.04276619]
Stock Position:  0.042766190720710716
Bond Position:  [-21.82439323]


portfolio before change:  [-17.39865536]
curr_Stock_Price:  103.55063213929616
curr_Factors:  [103.55063214]
mat_Sqrt:  [[0.15]]
grads:  [-0.08636985]
Stock Position:  -0.08636984905417128
Bond Position:  [-8.4550029]


portfolio before change:  [-17.42950334]
curr_Stock_Price:  103.89555613997975
curr_Factors:  [103.89555614]
mat_Sqrt:  [[0.15]]
grads:  [0.00219373]
Stock Position:  0.0021937262616953763
Bond Position:  [-17.65742175]


portfolio before change:  [-17.43155799]
curr_Stock_Price:  103.96514856653381
curr_Factors:  [103.96514857]
mat_Sqrt:  [[0.15]]
grads:  [-0.03913024]
Stock Position:  -0.03913023673083031
Bond Position:  [-13.36337711]


portfolio before change:  [-17.42833086]
curr_Stock_Price:  103.83998571678133
curr_Factors:  [103.83998572]
mat_Sqrt:  [[0.15]]
grads:  [-0.00590821]
Stock Position:  -0.005908206169022654
Bond Position:  [-16.81482282]


portfolio before change:  [-17.42694305]
curr_Stock_Price:  103.24931620651553
curr_Factors:  [103.24931621]
mat_Sqrt:  [[0.15]]
grads:  [0.15623061]
Stock Position:  0.15623060796089616
Bond Position:  [-33.55764649]


portfolio before change:  [-17.21130177]
curr_Stock_Price:  104.65644282666031
curr_Factors:  [104.65644283]
mat_Sqrt:  [[0.15]]
grads:  [0.00992367]
Stock Position:  0.009923673763687786
Bond Position:  [-18.24987817]


portfolio before change:  [-17.21433011]
curr_Stock_Price:  104.58117172454344
curr_Factors:  [104.58117172]
mat_Sqrt:  [[0.15]]
grads:  [0.13601423]
Stock Position:  0.1360142339767535
Bond Position:  [-31.43885807]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.21433011]
Stock Price:  105.32665833617328
PL:  [-22.54098845]
Settle:  Tensor("sub_122:0", shape=(), dtype=float64)
PL:  Tensor("sub_123:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  62
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.72472939e-03]
 [-9.19078334e-03]
 [ 1.93981206e-02]
 [-6.38898580e-03]
 [ 5.60738980e-03]
 [ 2.77651270e-02]
 [ 1.63532387e-02]
 [-8.38145422e-04]
 [ 7.84224413e-03]
 [ 1.16148965e-02]
 [ 2.67220012e-02]
 [ 2.13268527e-03]
 [-1.26794064e-02]
 [-5.39421142e-03]
 [-6.78371712e-07]
 [-2.75938333e-02]
 [ 4.99870575e-03]
 [ 1.80655016e-03]
 [-2.58134687e-03]
 [-2.53566166e-03]
 [-1.66870969e-04]
 [-1.06933501e-02]
 [ 4.77088301e-03]
 [ 7.63251220e-03]
 [-3.65935006e-03]
 [-8.98442917e-03]
 [ 1.23275250e-02]
 [-1.99464696e-02]
 [-3.40989954e-02]
 [ 2.16032147e-02]
 [ 8.71486959e-03]
 [ 6.04490609e-03]
 [-1.24556203e-02]
 [-4.97254301e-03]
 [-5.42759137e-03]
 [-6.49496760e-03]
 [ 2.33175594e-02]
 [ 3.77404974e-03]
 [ 2.33900599e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.42507381]
curr_Stock_Price:  99.96683079025996
curr_Factors:  [99.96683079]
mat_Sqrt:  [[0.15]]
grads:  [-0.0114982]
Stock Position:  -0.011498195951910862
Bond Position:  [2.57451202]


portfolio before change:  [1.42510746]
curr_Stock_Price:  99.9918946840439
curr_Factors:  [99.99189468]
mat_Sqrt:  [[0.15]]
grads:  [-0.06127189]
Stock Position:  -0.06127188891447024
Bond Position:  [7.55179972]


portfolio before change:  [1.42507912]
curr_Stock_Price:  100.00776451469758
curr_Factors:  [100.00776451]
mat_Sqrt:  [[0.15]]
grads:  [0.1293208]
Stock Position:  0.12932080432227155
Bond Position:  [-11.50800543]


portfolio before change:  [1.38259829]
curr_Stock_Price:  99.69039689651964
curr_Factors:  [99.6903969]
mat_Sqrt:  [[0.15]]
grads:  [-0.04259324]
Stock Position:  -0.042593238689088354
Bond Position:  [5.62873516]


portfolio before change:  [1.37631955]
curr_Stock_Price:  99.85432850133822
curr_Factors:  [99.8543285]
mat_Sqrt:  [[0.15]]
grads:  [0.0373826]
Stock Position:  0.037382598652472974
Bond Position:  [-2.35649474]


portfolio before change:  [1.42366125]
curr_Stock_Price:  101.12861887090838
curr_Factors:  [101.12861887]
mat_Sqrt:  [[0.15]]
grads:  [0.18510085]
Stock Position:  0.18510084638774058
Bond Position:  [-17.29533169]


portfolio before change:  [1.47869877]
curr_Stock_Price:  101.43763726632302
curr_Factors:  [101.43763727]
mat_Sqrt:  [[0.15]]
grads:  [0.10902159]
Stock Position:  0.10902159158706529
Bond Position:  [-9.58019389]


portfolio before change:  [1.48322754]
curr_Stock_Price:  101.49016240076871
curr_Factors:  [101.4901624]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558764]
Stock Position:  -0.005587636147046842
Bond Position:  [2.05031764]


portfolio before change:  [1.47966404]
curr_Stock_Price:  102.17378012664625
curr_Factors:  [102.17378013]
mat_Sqrt:  [[0.15]]
grads:  [0.05228163]
Stock Position:  0.05228162753678577
Bond Position:  [-3.86214747]


portfolio before change:  [1.4697134]
curr_Stock_Price:  101.99268705104063
curr_Factors:  [101.99268705]
mat_Sqrt:  [[0.15]]
grads:  [0.07743264]
Stock Position:  0.07743264349626039
Bond Position:  [-6.42784997]


portfolio before change:  [1.493371]
curr_Stock_Price:  102.3085890071911
curr_Factors:  [102.30858901]
mat_Sqrt:  [[0.15]]
grads:  [0.17814667]
Stock Position:  0.17814667433620346
Bond Position:  [-16.73256389]


portfolio before change:  [1.52074933]
curr_Stock_Price:  102.47401469999825
curr_Factors:  [102.4740147]
mat_Sqrt:  [[0.15]]
grads:  [0.0142179]
Stock Position:  0.014217901777924669
Bond Position:  [0.06378386]


portfolio before change:  [1.54039659]
curr_Stock_Price:  103.85532152170188
curr_Factors:  [103.85532152]
mat_Sqrt:  [[0.15]]
grads:  [-0.08452938]
Stock Position:  -0.08452937606490524
Bond Position:  [10.31922212]


portfolio before change:  [1.47397328]
curr_Stock_Price:  104.65638375816887
curr_Factors:  [104.65638376]
mat_Sqrt:  [[0.15]]
grads:  [-0.03596141]
Stock Position:  -0.03596140946021566
Bond Position:  [5.23756435]


portfolio before change:  [1.5216426]
curr_Stock_Price:  103.34902169659986
curr_Factors:  [103.3490217]
mat_Sqrt:  [[0.15]]
grads:  [-4.52247808e-06]
Stock Position:  -4.522478080990165e-06
Bond Position:  [1.52210999]


portfolio before change:  [1.52183372]
curr_Stock_Price:  103.16296174631508
curr_Factors:  [103.16296175]
mat_Sqrt:  [[0.15]]
grads:  [-0.18395889]
Stock Position:  -0.18395888875164768
Bond Position:  [20.49957752]


portfolio before change:  [1.53597595]
curr_Stock_Price:  103.10001492968374
curr_Factors:  [103.10001493]
mat_Sqrt:  [[0.15]]
grads:  [0.03332471]
Stock Position:  0.033324705030493645
Bond Position:  [-1.89980163]


portfolio before change:  [1.50233021]
curr_Stock_Price:  102.09750796535891
curr_Factors:  [102.09750797]
mat_Sqrt:  [[0.15]]
grads:  [0.01204367]
Stock Position:  0.012043667754622933
Bond Position:  [0.27270175]


portfolio before change:  [1.50891914]
curr_Stock_Price:  102.64176353545382
curr_Factors:  [102.64176354]
mat_Sqrt:  [[0.15]]
grads:  [-0.01720898]
Stock Position:  -0.017208979136520645
Bond Position:  [3.2752791]


portfolio before change:  [1.51521052]
curr_Stock_Price:  102.299968164577
curr_Factors:  [102.29996816]
mat_Sqrt:  [[0.15]]
grads:  [-0.01690441]
Stock Position:  -0.016904411040602366
Bond Position:  [3.24453123]


portfolio before change:  [1.52693433]
curr_Stock_Price:  101.63042606420754
curr_Factors:  [101.63042606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00111247]
Stock Position:  -0.0011124731263988704
Bond Position:  [1.63999545]


portfolio before change:  [1.52736508]
curr_Stock_Price:  101.42750814061151
curr_Factors:  [101.42750814]
mat_Sqrt:  [[0.15]]
grads:  [-0.071289]
Stock Position:  -0.07128900040967688
Bond Position:  [8.75803075]


portfolio before change:  [1.62716669]
curr_Stock_Price:  100.04290760726784
curr_Factors:  [100.04290761]
mat_Sqrt:  [[0.15]]
grads:  [0.03180589]
Stock Position:  0.031805886742670424
Bond Position:  [-1.5547867]


portfolio before change:  [1.68155235]
curr_Stock_Price:  101.7589428494805
curr_Factors:  [101.75894285]
mat_Sqrt:  [[0.15]]
grads:  [0.05088341]
Stock Position:  0.05088341468480818
Bond Position:  [-3.49629013]


portfolio before change:  [1.63050183]
curr_Stock_Price:  100.76424817179134
curr_Factors:  [100.76424817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02439567]
Stock Position:  -0.02439566709392819
Bond Position:  [4.08871288]


portfolio before change:  [1.63068578]
curr_Stock_Price:  100.77765925799552
curr_Factors:  [100.77765926]
mat_Sqrt:  [[0.15]]
grads:  [-0.05989619]
Stock Position:  -0.0598961944542821
Bond Position:  [7.66688405]


portfolio before change:  [1.65607173]
curr_Stock_Price:  100.36982809835773
curr_Factors:  [100.3698281]
mat_Sqrt:  [[0.15]]
grads:  [0.0821835]
Stock Position:  0.0821834997286401
Bond Position:  [-6.59267201]


portfolio before change:  [1.65971202]
curr_Stock_Price:  100.42415073750419
curr_Factors:  [100.42415074]
mat_Sqrt:  [[0.15]]
grads:  [-0.13297646]
Stock Position:  -0.13297646431820545
Bond Position:  [15.01376052]


portfolio before change:  [1.79807701]
curr_Stock_Price:  99.39774242262312
curr_Factors:  [99.39774242]
mat_Sqrt:  [[0.15]]
grads:  [-0.22732664]
Stock Position:  -0.2273266358997894
Bond Position:  [24.39383141]


portfolio before change:  [1.79580887]
curr_Stock_Price:  99.4211341304668
curr_Factors:  [99.42113413]
mat_Sqrt:  [[0.15]]
grads:  [0.14402143]
Stock Position:  0.14402143150015997
Bond Position:  [-12.52296519]


portfolio before change:  [1.92328847]
curr_Stock_Price:  100.31714712880999
curr_Factors:  [100.31714713]
mat_Sqrt:  [[0.15]]
grads:  [0.05809913]
Stock Position:  0.05809913059788393
Bond Position:  [-3.90505056]


portfolio before change:  [1.98300145]
curr_Stock_Price:  101.35332689201061
curr_Factors:  [101.35332689]
mat_Sqrt:  [[0.15]]
grads:  [0.04029937]
Stock Position:  0.04029937390349261
Bond Position:  [-2.10147416]


portfolio before change:  [1.96790579]
curr_Stock_Price:  100.98525752902418
curr_Factors:  [100.98525753]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303747]
Stock Position:  -0.08303746879405523
Bond Position:  [10.35346596]


portfolio before change:  [2.00777168]
curr_Stock_Price:  100.52074882721135
curr_Factors:  [100.52074883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03315029]
Stock Position:  -0.03315028673819986
Bond Position:  [5.34006333]


portfolio before change:  [1.97562678]
curr_Stock_Price:  101.51055762262602
curr_Factors:  [101.51055762]
mat_Sqrt:  [[0.15]]
grads:  [-0.03618394]
Stock Position:  -0.036183942435428156
Bond Position:  [5.64867896]


portfolio before change:  [1.9878932]
curr_Stock_Price:  101.19107104371501
curr_Factors:  [101.19107104]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329978]
Stock Position:  -0.04329978402716708
Bond Position:  [6.36944472]


portfolio before change:  [1.92886729]
curr_Stock_Price:  102.57265166448575
curr_Factors:  [102.57265166]
mat_Sqrt:  [[0.15]]
grads:  [0.1554504]
Stock Position:  0.15545039615282477
Bond Position:  [-14.01609205]


portfolio before change:  [1.75655874]
curr_Stock_Price:  101.47547580679793
curr_Factors:  [101.47547581]
mat_Sqrt:  [[0.15]]
grads:  [0.02516033]
Stock Position:  0.02516033162747889
Bond Position:  [-0.79659788]


portfolio before change:  [1.74300345]
curr_Stock_Price:  100.94067696786693
curr_Factors:  [100.94067697]
mat_Sqrt:  [[0.15]]
grads:  [0.15593373]
Stock Position:  0.1559337325352906
Bond Position:  [-13.99705308]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.74300345]
Stock Price:  99.27143481458374
PL:  [1.74300345]
Settle:  Tensor("sub_124:0", shape=(), dtype=float64)
PL:  Tensor("sub_125:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  63
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.53815770e-03]
 [ 1.75091776e-03]
 [-2.04821805e-02]
 [-2.52914617e-02]
 [ 1.43846945e-02]
 [ 2.35027352e-02]
 [ 4.28268781e-03]
 [-9.40196824e-03]
 [-1.27990825e-03]
 [ 1.70359322e-03]
 [-3.08401290e-02]
 [-3.50593380e-03]
 [ 9.72698535e-03]
 [ 8.98026287e-03]
 [ 4.52331456e-03]
 [-1.18612554e-02]
 [-8.98735329e-03]
 [-2.58239597e-05]
 [-7.55634046e-03]
 [-2.46347462e-03]
 [ 5.42144139e-04]
 [ 1.28015815e-02]
 [ 4.75756854e-03]
 [ 5.42632264e-03]
 [ 8.36954687e-04]
 [-2.17933043e-03]
 [ 2.79966153e-03]
 [-1.81340674e-02]
 [-2.45194200e-02]
 [ 2.15072450e-02]
 [ 2.63645232e-03]
 [-9.57093457e-03]
 [-1.23991048e-02]
 [-1.02337753e-02]
 [-7.47470805e-03]
 [-7.53270898e-03]
 [ 2.06194917e-02]
 [ 8.84392692e-03]
 [ 2.19657384e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.45837944]
curr_Stock_Price:  100.35550883087086
curr_Factors:  [100.35550883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025438]
Stock Position:  -0.010254384663249301
Bond Position:  [8.48746343]


portfolio before change:  [7.46628082]
curr_Stock_Price:  99.68843962232854
curr_Factors:  [99.68843962]
mat_Sqrt:  [[0.15]]
grads:  [0.01167279]
Stock Position:  0.011672785048103549
Bond Position:  [6.30263909]


portfolio before change:  [7.45641976]
curr_Stock_Price:  98.7761517104535
curr_Factors:  [98.77615171]
mat_Sqrt:  [[0.15]]
grads:  [-0.13654787]
Stock Position:  -0.13654787007086122
Bond Position:  [20.94409289]


portfolio before change:  [7.50914222]
curr_Stock_Price:  98.40921599446253
curr_Factors:  [98.40921599]
mat_Sqrt:  [[0.15]]
grads:  [-0.16860974]
Stock Position:  -0.1686097445140557
Bond Position:  [24.10189499]


portfolio before change:  [7.46104626]
curr_Stock_Price:  98.71233542299488
curr_Factors:  [98.71233542]
mat_Sqrt:  [[0.15]]
grads:  [0.09589796]
Stock Position:  0.09589796335323297
Bond Position:  [-2.00526567]


portfolio before change:  [7.39303592]
curr_Stock_Price:  98.00575453574032
curr_Factors:  [98.00575454]
mat_Sqrt:  [[0.15]]
grads:  [0.1566849]
Stock Position:  0.1566849014615448
Bond Position:  [-7.96298607]


portfolio before change:  [7.33991881]
curr_Stock_Price:  97.67310173807044
curr_Factors:  [97.67310174]
mat_Sqrt:  [[0.15]]
grads:  [0.02855125]
Stock Position:  0.02855125204478427
Bond Position:  [4.55122947]


portfolio before change:  [7.31795854]
curr_Stock_Price:  96.88402224028273
curr_Factors:  [96.88402224]
mat_Sqrt:  [[0.15]]
grads:  [-0.06267979]
Stock Position:  -0.06267978824662397
Bond Position:  [13.39062854]


portfolio before change:  [7.3445174]
curr_Stock_Price:  96.48700546151338
curr_Factors:  [96.48700546]
mat_Sqrt:  [[0.15]]
grads:  [-0.00853272]
Stock Position:  -0.008532721690919828
Bond Position:  [8.16781417]


portfolio before change:  [7.34491922]
curr_Stock_Price:  96.55957570437629
curr_Factors:  [96.5595757]
mat_Sqrt:  [[0.15]]
grads:  [0.01135729]
Stock Position:  0.011357288141026258
Bond Position:  [6.2482643]


portfolio before change:  [7.3539473]
curr_Stock_Price:  97.28571669927598
curr_Factors:  [97.2857167]
mat_Sqrt:  [[0.15]]
grads:  [-0.20560086]
Stock Position:  -0.20560085982179593
Bond Position:  [27.3559743]


portfolio before change:  [7.25786269]
curr_Stock_Price:  97.76968506785744
curr_Factors:  [97.76968507]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337289]
Stock Position:  -0.0233728919810535
Bond Position:  [9.54302298]


portfolio before change:  [7.27794486]
curr_Stock_Price:  96.96151758757779
curr_Factors:  [96.96151759]
mat_Sqrt:  [[0.15]]
grads:  [0.06484657]
Stock Position:  0.06484656898929879
Bond Position:  [0.99032312]


portfolio before change:  [7.32888195]
curr_Stock_Price:  97.74511015508601
curr_Factors:  [97.74511016]
mat_Sqrt:  [[0.15]]
grads:  [0.05986842]
Stock Position:  0.059868419116504146
Bond Position:  [1.47703672]


portfolio before change:  [7.31520384]
curr_Stock_Price:  97.51355650785109
curr_Factors:  [97.51355651]
mat_Sqrt:  [[0.15]]
grads:  [0.03015543]
Stock Position:  0.03015543041751969
Bond Position:  [4.37464057]


portfolio before change:  [7.30332589]
curr_Stock_Price:  97.10153087468453
curr_Factors:  [97.10153087]
mat_Sqrt:  [[0.15]]
grads:  [-0.07907504]
Stock Position:  -0.07907503622188349
Bond Position:  [14.98163296]


portfolio before change:  [7.35421902]
curr_Stock_Price:  96.48160941112414
curr_Factors:  [96.48160941]
mat_Sqrt:  [[0.15]]
grads:  [-0.05991569]
Stock Position:  -0.05991568863217535
Bond Position:  [13.13498109]


portfolio before change:  [7.33114123]
curr_Stock_Price:  96.89418528056112
curr_Factors:  [96.89418528]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017216]
Stock Position:  -0.00017215973142749294
Bond Position:  [7.34782251]


portfolio before change:  [7.3319161]
curr_Stock_Price:  97.72866979203059
curr_Factors:  [97.72866979]
mat_Sqrt:  [[0.15]]
grads:  [-0.0503756]
Stock Position:  -0.05037560307255456
Bond Position:  [12.25505678]


portfolio before change:  [7.35251192]
curr_Stock_Price:  97.35023583197736
curr_Factors:  [97.35023583]
mat_Sqrt:  [[0.15]]
grads:  [-0.01642316]
Stock Position:  -0.01642316414800541
Bond Position:  [8.95131082]


portfolio before change:  [7.35720982]
curr_Stock_Price:  97.13231666758666
curr_Factors:  [97.13231667]
mat_Sqrt:  [[0.15]]
grads:  [0.00361429]
Stock Position:  0.0036142942626066327
Bond Position:  [7.00614505]


portfolio before change:  [7.35760737]
curr_Stock_Price:  96.99998812491499
curr_Factors:  [96.99998812]
mat_Sqrt:  [[0.15]]
grads:  [0.08534388]
Stock Position:  0.08534387676306805
Bond Position:  [-0.92074766]


portfolio before change:  [7.32018872]
curr_Stock_Price:  96.56289107992275
curr_Factors:  [96.56289108]
mat_Sqrt:  [[0.15]]
grads:  [0.03171712]
Stock Position:  0.03171712359976528
Bond Position:  [4.25749156]


portfolio before change:  [7.33905719]
curr_Stock_Price:  97.14100951654576
curr_Factors:  [97.14100952]
mat_Sqrt:  [[0.15]]
grads:  [0.03617548]
Stock Position:  0.03617548429184596
Bond Position:  [3.82493413]


portfolio before change:  [7.29583886]
curr_Stock_Price:  95.93310661781982
curr_Factors:  [95.93310662]
mat_Sqrt:  [[0.15]]
grads:  [0.0055797]
Stock Position:  0.005579697914036836
Bond Position:  [6.76056111]


portfolio before change:  [7.29249025]
curr_Stock_Price:  95.18150017429028
curr_Factors:  [95.18150017]
mat_Sqrt:  [[0.15]]
grads:  [-0.01452887]
Stock Position:  -0.014528869537650552
Bond Position:  [8.67536985]


portfolio before change:  [7.28937045]
curr_Stock_Price:  95.47087477217507
curr_Factors:  [95.47087477]
mat_Sqrt:  [[0.15]]
grads:  [0.01866441]
Stock Position:  0.01866441022058172
Bond Position:  [5.50746288]


portfolio before change:  [7.29815124]
curr_Stock_Price:  95.90444360218896
curr_Factors:  [95.9044436]
mat_Sqrt:  [[0.15]]
grads:  [-0.12089378]
Stock Position:  -0.12089378290330514
Bond Position:  [18.89240222]


portfolio before change:  [7.43173644]
curr_Stock_Price:  94.81899901583003
curr_Factors:  [94.81899902]
mat_Sqrt:  [[0.15]]
grads:  [-0.1634628]
Stock Position:  -0.1634627998706005
Bond Position:  [22.9311155]


portfolio before change:  [7.49952503]
curr_Stock_Price:  94.42183201862134
curr_Factors:  [94.42183202]
mat_Sqrt:  [[0.15]]
grads:  [0.14338163]
Stock Position:  0.14338163365385861
Bond Position:  [-6.03883149]


portfolio before change:  [7.6089202]
curr_Stock_Price:  95.19006196207312
curr_Factors:  [95.19006196]
mat_Sqrt:  [[0.15]]
grads:  [0.01757635]
Stock Position:  0.017576348806975322
Bond Position:  [5.93582647]


portfolio before change:  [7.60109]
curr_Stock_Price:  94.70234869947896
curr_Factors:  [94.7023487]
mat_Sqrt:  [[0.15]]
grads:  [-0.06380623]
Stock Position:  -0.06380623043366977
Bond Position:  [13.64368989]


portfolio before change:  [7.56205738]
curr_Stock_Price:  95.34081591380028
curr_Factors:  [95.34081591]
mat_Sqrt:  [[0.15]]
grads:  [-0.0826607]
Stock Position:  -0.08266069852143658
Bond Position:  [15.44299583]


portfolio before change:  [7.43767373]
curr_Stock_Price:  96.86891994040106
curr_Factors:  [96.86891994]
mat_Sqrt:  [[0.15]]
grads:  [-0.06822517]
Stock Position:  -0.06822516887535346
Bond Position:  [14.04657216]


portfolio before change:  [7.4015898]
curr_Stock_Price:  97.42355203184368
curr_Factors:  [97.42355203]
mat_Sqrt:  [[0.15]]
grads:  [-0.04983139]
Stock Position:  -0.04983138697756659
Bond Position:  [12.25634052]


portfolio before change:  [7.33946109]
curr_Stock_Price:  98.7010771801787
curr_Factors:  [98.70107718]
mat_Sqrt:  [[0.15]]
grads:  [-0.05021806]
Stock Position:  -0.05021805985545392
Bond Position:  [12.29603769]


portfolio before change:  [7.41627008]
curr_Stock_Price:  97.20217623640053
curr_Factors:  [97.20217624]
mat_Sqrt:  [[0.15]]
grads:  [0.13746328]
Stock Position:  0.13746327777304604
Bond Position:  [-5.94545967]


portfolio before change:  [7.41607059]
curr_Stock_Price:  97.20613173436693
curr_Factors:  [97.20613173]
mat_Sqrt:  [[0.15]]
grads:  [0.05895951]
Stock Position:  0.05895951277246394
Bond Position:  [1.68484442]


portfolio before change:  [7.40654891]
curr_Stock_Price:  97.04106416075658
curr_Factors:  [97.04106416]
mat_Sqrt:  [[0.15]]
grads:  [0.14643826]
Stock Position:  0.146438256293815
Bond Position:  [-6.80397532]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.40654891]
Stock Price:  97.90220272684688
PL:  [7.40654891]
Settle:  Tensor("sub_126:0", shape=(), dtype=float64)
PL:  Tensor("sub_127:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  64
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.79083002e-03]
 [-5.14911585e-03]
 [-6.76858171e-03]
 [ 2.44036724e-02]
 [ 4.53030657e-03]
 [ 3.17154975e-02]
 [ 8.76300743e-03]
 [ 1.78093552e-03]
 [ 1.30193118e-02]
 [ 1.39602708e-02]
 [ 1.66548765e-02]
 [-1.38322636e-02]
 [-1.22549383e-02]
 [ 3.47098142e-03]
 [ 2.24709699e-03]
 [-3.15428306e-02]
 [ 4.93230845e-03]
 [-5.55652717e-03]
 [ 4.22537392e-03]
 [-3.31150121e-03]
 [-1.61107966e-03]
 [-3.95101336e-02]
 [ 4.81862044e-03]
 [ 1.15929189e-02]
 [-5.58245712e-03]
 [ 1.10361397e-04]
 [-9.32325335e-04]
 [-1.93154143e-03]
 [ 2.23202965e-02]
 [ 2.49540700e-02]
 [-1.56331618e-02]
 [ 6.13660259e-03]
 [-1.30730503e-02]
 [ 3.40839064e-03]
 [-6.69830564e-03]
 [ 5.38740640e-03]
 [ 2.46032133e-02]
 [ 5.77151094e-03]
 [ 1.96986076e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.95233572]
curr_Stock_Price:  99.49156279282433
curr_Factors:  [99.49156279]
mat_Sqrt:  [[0.15]]
grads:  [-0.0252722]
Stock Position:  -0.025272200162449028
Bond Position:  [-3.43796503]


portfolio before change:  [-5.99420738]
curr_Stock_Price:  101.1313841665274
curr_Factors:  [101.13138417]
mat_Sqrt:  [[0.15]]
grads:  [-0.03432744]
Stock Position:  -0.03432743897919575
Bond Position:  [-2.52262596]


portfolio before change:  [-5.99279303]
curr_Stock_Price:  101.08099581713607
curr_Factors:  [101.08099582]
mat_Sqrt:  [[0.15]]
grads:  [-0.04512388]
Stock Position:  -0.045123878033466895
Bond Position:  [-1.4316265]


portfolio before change:  [-5.99984933]
curr_Stock_Price:  101.23340599823
curr_Factors:  [101.233406]
mat_Sqrt:  [[0.15]]
grads:  [0.16269115]
Stock Position:  0.16269114933582624
Bond Position:  [-22.4696285]


portfolio before change:  [-5.90940377]
curr_Stock_Price:  101.80660520396783
curr_Factors:  [101.8066052]
mat_Sqrt:  [[0.15]]
grads:  [0.03020204]
Stock Position:  0.030202043819881938
Bond Position:  [-8.98417132]


portfolio before change:  [-5.90009928]
curr_Stock_Price:  102.15186614660269
curr_Factors:  [102.15186615]
mat_Sqrt:  [[0.15]]
grads:  [0.21143665]
Stock Position:  0.21143665032734013
Bond Position:  [-27.49874768]


portfolio before change:  [-5.89736115]
curr_Stock_Price:  102.18107437809263
curr_Factors:  [102.18107438]
mat_Sqrt:  [[0.15]]
grads:  [0.05842005]
Stock Position:  0.058420049538408216
Bond Position:  [-11.86678457]


portfolio before change:  [-5.82822345]
curr_Stock_Price:  103.38992546858825
curr_Factors:  [103.38992547]
mat_Sqrt:  [[0.15]]
grads:  [0.0118729]
Stock Position:  0.011872903434182645
Bond Position:  [-7.05576205]


portfolio before change:  [-5.82525701]
curr_Stock_Price:  103.71406395358795
curr_Factors:  [103.71406395]
mat_Sqrt:  [[0.15]]
grads:  [0.08679541]
Stock Position:  0.08679541224335684
Bond Position:  [-14.82716194]


portfolio before change:  [-5.72086185]
curr_Stock_Price:  104.93819166885324
curr_Factors:  [104.93819167]
mat_Sqrt:  [[0.15]]
grads:  [0.09306847]
Stock Position:  0.09306847191994606
Bond Position:  [-15.48729899]


portfolio before change:  [-5.76543581]
curr_Stock_Price:  104.48005658123598
curr_Factors:  [104.48005658]
mat_Sqrt:  [[0.15]]
grads:  [0.11103251]
Stock Position:  0.11103251011812441
Bond Position:  [-17.36611875]


portfolio before change:  [-5.73753694]
curr_Stock_Price:  104.75087616628659
curr_Factors:  [104.75087617]
mat_Sqrt:  [[0.15]]
grads:  [-0.09221509]
Stock Position:  -0.09221509037316632
Bond Position:  [3.92207458]


portfolio before change:  [-5.74424628]
curr_Stock_Price:  104.8289505536358
curr_Factors:  [104.82895055]
mat_Sqrt:  [[0.15]]
grads:  [-0.08169959]
Stock Position:  -0.08169958887505954
Bond Position:  [2.82023588]


portfolio before change:  [-5.64026223]
curr_Stock_Price:  103.56050470711119
curr_Factors:  [103.56050471]
mat_Sqrt:  [[0.15]]
grads:  [0.02313988]
Stock Position:  0.0231398761303907
Bond Position:  [-8.03663948]


portfolio before change:  [-5.62171905]
curr_Stock_Price:  104.40527256188943
curr_Factors:  [104.40527256]
mat_Sqrt:  [[0.15]]
grads:  [0.01498065]
Stock Position:  0.014980646629077003
Bond Position:  [-7.18577754]


portfolio before change:  [-5.61831732]
curr_Stock_Price:  104.69230966888308
curr_Factors:  [104.69230967]
mat_Sqrt:  [[0.15]]
grads:  [-0.21028554]
Stock Position:  -0.21028553713378945
Bond Position:  [16.39696125]


portfolio before change:  [-5.42836404]
curr_Stock_Price:  103.79874589584713
curr_Factors:  [103.7987459]
mat_Sqrt:  [[0.15]]
grads:  [0.03288206]
Stock Position:  0.03288205635158903
Bond Position:  [-8.84148025]


portfolio before change:  [-5.42530267]
curr_Stock_Price:  103.92545989851263
curr_Factors:  [103.9254599]
mat_Sqrt:  [[0.15]]
grads:  [-0.03704351]
Stock Position:  -0.03704351448768293
Bond Position:  [-1.57553839]


portfolio before change:  [-5.43295263]
curr_Stock_Price:  104.12665578184505
curr_Factors:  [104.12665578]
mat_Sqrt:  [[0.15]]
grads:  [0.02816916]
Stock Position:  0.02816915945110042
Bond Position:  [-8.366113]


portfolio before change:  [-5.43421666]
curr_Stock_Price:  104.11890960746874
curr_Factors:  [104.11890961]
mat_Sqrt:  [[0.15]]
grads:  [-0.02207667]
Stock Position:  -0.022076674746141365
Bond Position:  [-3.13561736]


portfolio before change:  [-5.43038522]
curr_Stock_Price:  103.92760281197197
curr_Factors:  [103.92760281]
mat_Sqrt:  [[0.15]]
grads:  [-0.01074053]
Stock Position:  -0.010740531073152754
Bond Position:  [-4.31414758]


portfolio before change:  [-5.43254337]
curr_Stock_Price:  104.07832628260148
curr_Factors:  [104.07832628]
mat_Sqrt:  [[0.15]]
grads:  [-0.26340089]
Stock Position:  -0.2634008907480419
Bond Position:  [21.98178048]


portfolio before change:  [-5.55071682]
curr_Stock_Price:  104.53740346206985
curr_Factors:  [104.53740346]
mat_Sqrt:  [[0.15]]
grads:  [0.03212414]
Stock Position:  0.0321241362463678
Bond Position:  [-8.90889061]


portfolio before change:  [-5.51421435]
curr_Stock_Price:  105.70836560496572
curr_Factors:  [105.7083656]
mat_Sqrt:  [[0.15]]
grads:  [0.07728613]
Stock Position:  0.07728612602966266
Bond Position:  [-13.68400442]


portfolio before change:  [-5.56374192]
curr_Stock_Price:  105.0896652033649
curr_Factors:  [105.0896652]
mat_Sqrt:  [[0.15]]
grads:  [-0.03721638]
Stock Position:  -0.03721638078150208
Bond Position:  [-1.65268492]


portfolio before change:  [-5.51515465]
curr_Stock_Price:  103.77857949516789
curr_Factors:  [103.7785795]
mat_Sqrt:  [[0.15]]
grads:  [0.00073574]
Stock Position:  0.000735742645705378
Bond Position:  [-5.59150898]


portfolio before change:  [-5.51684505]
curr_Stock_Price:  102.4310735312529
curr_Factors:  [102.43107353]
mat_Sqrt:  [[0.15]]
grads:  [-0.0062155]
Stock Position:  -0.006215502230767933
Bond Position:  [-4.88018448]


portfolio before change:  [-5.52823677]
curr_Stock_Price:  104.16571345565482
curr_Factors:  [104.16571346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01287694]
Stock Position:  -0.012876942860669758
Bond Position:  [-4.18690083]


portfolio before change:  [-5.52693475]
curr_Stock_Price:  104.02395509703214
curr_Factors:  [104.0239551]
mat_Sqrt:  [[0.15]]
grads:  [0.14880198]
Stock Position:  0.14880197696566377
Bond Position:  [-21.00590492]


portfolio before change:  [-5.54307901]
curr_Stock_Price:  103.93310714142213
curr_Factors:  [103.93310714]
mat_Sqrt:  [[0.15]]
grads:  [0.16636047]
Stock Position:  0.16636046660066334
Bond Position:  [-22.83343921]


portfolio before change:  [-5.49927835]
curr_Stock_Price:  104.21355246186457
curr_Factors:  [104.21355246]
mat_Sqrt:  [[0.15]]
grads:  [-0.10422108]
Stock Position:  -0.10422107892129748
Bond Position:  [5.36197052]


portfolio before change:  [-5.51697285]
curr_Stock_Price:  104.3897623363514
curr_Factors:  [104.38976234]
mat_Sqrt:  [[0.15]]
grads:  [0.04091068]
Stock Position:  0.04091068393309929
Bond Position:  [-9.78762942]


portfolio before change:  [-5.48723528]
curr_Stock_Price:  105.14655974233227
curr_Factors:  [105.14655974]
mat_Sqrt:  [[0.15]]
grads:  [-0.08715367]
Stock Position:  -0.08715366841220792
Bond Position:  [3.67667312]


portfolio before change:  [-5.55243984]
curr_Stock_Price:  105.89998962549936
curr_Factors:  [105.89998963]
mat_Sqrt:  [[0.15]]
grads:  [0.0227226]
Stock Position:  0.0227226042518998
Bond Position:  [-7.9587634]


portfolio before change:  [-5.54830634]
curr_Stock_Price:  106.1256862557294
curr_Factors:  [106.12568626]
mat_Sqrt:  [[0.15]]
grads:  [-0.04465537]
Stock Position:  -0.04465537092597151
Bond Position:  [-0.80922445]


portfolio before change:  [-5.58957868]
curr_Stock_Price:  107.04766231106873
curr_Factors:  [107.04766231]
mat_Sqrt:  [[0.15]]
grads:  [0.03591604]
Stock Position:  0.03591604268156218
Bond Position:  [-9.43430709]


portfolio before change:  [-5.59871685]
curr_Stock_Price:  106.82606745636855
curr_Factors:  [106.82606746]
mat_Sqrt:  [[0.15]]
grads:  [0.16402142]
Stock Position:  0.16402142175470805
Bond Position:  [-23.12048031]


portfolio before change:  [-5.65702434]
curr_Stock_Price:  106.48820150878745
curr_Factors:  [106.48820151]
mat_Sqrt:  [[0.15]]
grads:  [0.03847674]
Stock Position:  0.03847673961988037
Bond Position:  [-9.75434315]


portfolio before change:  [-5.6859265]
curr_Stock_Price:  105.76873329912779
curr_Factors:  [105.7687333]
mat_Sqrt:  [[0.15]]
grads:  [0.13132405]
Stock Position:  0.1313240509083732
Bond Position:  [-19.57590502]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.6859265]
Stock Price:  107.63310819936099
PL:  [-13.3190347]
Settle:  Tensor("sub_128:0", shape=(), dtype=float64)
PL:  Tensor("sub_129:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  65
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.59414077e-03]
 [-4.91675883e-03]
 [ 1.74228926e-02]
 [-7.46854028e-03]
 [ 1.49210116e-02]
 [ 2.42338132e-02]
 [ 9.64539093e-03]
 [-4.63710360e-03]
 [ 1.07694675e-02]
 [ 4.01274095e-04]
 [ 7.67240494e-04]
 [ 3.22847219e-03]
 [ 7.65419950e-03]
 [ 8.33951837e-03]
 [ 1.06138899e-02]
 [-1.07133142e-02]
 [-8.42296797e-03]
 [-4.57273176e-04]
 [-7.59602623e-03]
 [-2.42757991e-03]
 [ 3.81275717e-04]
 [ 1.08398917e-02]
 [ 4.76042895e-03]
 [ 5.63057002e-03]
 [-3.47566100e-03]
 [-7.42855298e-03]
 [-1.17256226e-03]
 [-1.97767410e-02]
 [-2.95994665e-02]
 [ 2.18895062e-02]
 [ 2.67004079e-03]
 [-7.72400646e-03]
 [-1.24427884e-02]
 [-7.96682993e-03]
 [-6.45032140e-03]
 [-4.69912895e-03]
 [ 1.93470315e-02]
 [ 9.82464750e-03]
 [ 1.88070367e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.09182306]
curr_Stock_Price:  100.718426933372
curr_Factors:  [100.71842693]
mat_Sqrt:  [[0.15]]
grads:  [-0.01062761]
Stock Position:  -0.010627605103389134
Bond Position:  [14.16221872]


portfolio before change:  [13.08884364]
curr_Stock_Price:  101.16535780994774
curr_Factors:  [101.16535781]
mat_Sqrt:  [[0.15]]
grads:  [-0.03277839]
Stock Position:  -0.03277839222990622
Bond Position:  [16.40488142]


portfolio before change:  [13.13189269]
curr_Stock_Price:  99.91458542754349
curr_Factors:  [99.91458543]
mat_Sqrt:  [[0.15]]
grads:  [0.11615262]
Stock Position:  0.11615261714908023
Bond Position:  [1.5265521]


portfolio before change:  [13.08361583]
curr_Stock_Price:  99.49730951389846
curr_Factors:  [99.49730951]
mat_Sqrt:  [[0.15]]
grads:  [-0.04979027]
Stock Position:  -0.04979026850186653
Bond Position:  [18.03761358]


portfolio before change:  [13.13688134]
curr_Stock_Price:  98.4727986400767
curr_Factors:  [98.47279864]
mat_Sqrt:  [[0.15]]
grads:  [0.09947341]
Stock Position:  0.0994734109813223
Bond Position:  [3.34145617]


portfolio before change:  [13.04259123]
curr_Stock_Price:  97.52070687276277
curr_Factors:  [97.52070687]
mat_Sqrt:  [[0.15]]
grads:  [0.16155875]
Stock Position:  0.16155875438163783
Bond Position:  [-2.7127327]


portfolio before change:  [13.16754219]
curr_Stock_Price:  98.29621461971821
curr_Factors:  [98.29621462]
mat_Sqrt:  [[0.15]]
grads:  [0.06430261]
Stock Position:  0.06430260622418661
Bond Position:  [6.8468394]


portfolio before change:  [13.1654089]
curr_Stock_Price:  98.24972827279225
curr_Factors:  [98.24972827]
mat_Sqrt:  [[0.15]]
grads:  [-0.03091402]
Stock Position:  -0.030914023983648356
Bond Position:  [16.20270336]


portfolio before change:  [13.17602622]
curr_Stock_Price:  97.97180078892663
curr_Factors:  [97.97180079]
mat_Sqrt:  [[0.15]]
grads:  [0.07179645]
Stock Position:  0.07179644990098921
Bond Position:  [6.14199874]


portfolio before change:  [13.12204609]
curr_Stock_Price:  97.20925712867388
curr_Factors:  [97.20925713]
mat_Sqrt:  [[0.15]]
grads:  [0.00267516]
Stock Position:  0.002675160634611652
Bond Position:  [12.86199571]


portfolio before change:  [13.12604472]
curr_Stock_Price:  98.10295180353891
curr_Factors:  [98.1029518]
mat_Sqrt:  [[0.15]]
grads:  [0.00511494]
Stock Position:  0.005114936628297836
Bond Position:  [12.62425434]


portfolio before change:  [13.13135306]
curr_Stock_Price:  98.83223017521762
curr_Factors:  [98.83223018]
mat_Sqrt:  [[0.15]]
grads:  [0.02152315]
Stock Position:  0.02152314790795877
Bond Position:  [11.00417235]


portfolio before change:  [13.10861064]
curr_Stock_Price:  97.711667682233
curr_Factors:  [97.71166768]
mat_Sqrt:  [[0.15]]
grads:  [0.051028]
Stock Position:  0.051027996675627865
Bond Position:  [8.12257998]


portfolio before change:  [13.10197451]
curr_Stock_Price:  97.5617202682703
curr_Factors:  [97.56172027]
mat_Sqrt:  [[0.15]]
grads:  [0.05559679]
Stock Position:  0.05559678912648205
Bond Position:  [7.67785612]


portfolio before change:  [13.04139092]
curr_Stock_Price:  96.45476106938862
curr_Factors:  [96.45476107]
mat_Sqrt:  [[0.15]]
grads:  [0.07075927]
Stock Position:  0.07075926597142153
Bond Position:  [6.21632283]


portfolio before change:  [13.05579293]
curr_Stock_Price:  96.64731420643231
curr_Factors:  [96.64731421]
mat_Sqrt:  [[0.15]]
grads:  [-0.07142209]
Stock Position:  -0.07142209465576198
Bond Position:  [19.95854655]


portfolio before change:  [13.05245556]
curr_Stock_Price:  96.72897446305953
curr_Factors:  [96.72897446]
mat_Sqrt:  [[0.15]]
grads:  [-0.05615312]
Stock Position:  -0.056153119823134486
Bond Position:  [18.48408925]


portfolio before change:  [13.01649169]
curr_Stock_Price:  97.41058444802385
curr_Factors:  [97.41058445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00304849]
Stock Position:  -0.003048487840633606
Bond Position:  [13.31344667]


portfolio before change:  [13.0186723]
curr_Stock_Price:  97.24121123888874
curr_Factors:  [97.24121124]
mat_Sqrt:  [[0.15]]
grads:  [-0.05064017]
Stock Position:  -0.050640174878769796
Bond Position:  [17.94298425]


portfolio before change:  [13.003329]
curr_Stock_Price:  97.58849117793304
curr_Factors:  [97.58849118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01618387]
Stock Position:  -0.01618386608675182
Bond Position:  [14.58268807]


portfolio before change:  [13.00024964]
curr_Stock_Price:  97.89140456101346
curr_Factors:  [97.89140456]
mat_Sqrt:  [[0.15]]
grads:  [0.00254184]
Stock Position:  0.002541838111866577
Bond Position:  [12.75142554]


portfolio before change:  [13.00076942]
curr_Stock_Price:  97.46877753645187
curr_Factors:  [97.46877754]
mat_Sqrt:  [[0.15]]
grads:  [0.07226594]
Stock Position:  0.072265944628303
Bond Position:  [5.95709614]


portfolio before change:  [13.01414926]
curr_Stock_Price:  97.6436200251939
curr_Factors:  [97.64362003]
mat_Sqrt:  [[0.15]]
grads:  [0.03173619]
Stock Position:  0.03173619300361144
Bond Position:  [9.91531249]


portfolio before change:  [13.02077034]
curr_Stock_Price:  97.81319264960693
curr_Factors:  [97.81319265]
mat_Sqrt:  [[0.15]]
grads:  [0.03753713]
Stock Position:  0.03753713345243009
Bond Position:  [9.34914347]


portfolio before change:  [13.06232242]
curr_Stock_Price:  98.88901691932539
curr_Factors:  [98.88901692]
mat_Sqrt:  [[0.15]]
grads:  [-0.02317107]
Stock Position:  -0.02317107334552936
Bond Position:  [15.35368708]


portfolio before change:  [13.05804557]
curr_Stock_Price:  99.15642709850869
curr_Factors:  [99.1564271]
mat_Sqrt:  [[0.15]]
grads:  [-0.04952369]
Stock Position:  -0.049523686505727235
Bond Position:  [17.96863738]


portfolio before change:  [13.09424686]
curr_Stock_Price:  98.47079407583458
curr_Factors:  [98.47079408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00781708]
Stock Position:  -0.007817081736132374
Bond Position:  [13.86400111]


portfolio before change:  [13.10537445]
curr_Stock_Price:  97.26900575354209
curr_Factors:  [97.26900575]
mat_Sqrt:  [[0.15]]
grads:  [-0.13184494]
Stock Position:  -0.1318449396914762
Bond Position:  [25.92980064]


portfolio before change:  [13.17328394]
curr_Stock_Price:  96.77852002743501
curr_Factors:  [96.77852003]
mat_Sqrt:  [[0.15]]
grads:  [-0.19732978]
Stock Position:  -0.1973297764611441
Bond Position:  [32.27056766]


portfolio before change:  [13.18656872]
curr_Stock_Price:  96.73164060109264
curr_Factors:  [96.7316406]
mat_Sqrt:  [[0.15]]
grads:  [0.14593004]
Stock Position:  0.14593004166483453
Bond Position:  [-0.92948363]


portfolio before change:  [13.11932663]
curr_Stock_Price:  96.27165378283729
curr_Factors:  [96.27165378]
mat_Sqrt:  [[0.15]]
grads:  [0.01780027]
Stock Position:  0.01780027190734281
Bond Position:  [11.40566501]


portfolio before change:  [13.11121971]
curr_Stock_Price:  95.73611635380287
curr_Factors:  [95.73611635]
mat_Sqrt:  [[0.15]]
grads:  [-0.05149338]
Stock Position:  -0.05149337641786481
Bond Position:  [18.04099559]


portfolio before change:  [13.10693286]
curr_Stock_Price:  95.86316410002547
curr_Factors:  [95.8631641]
mat_Sqrt:  [[0.15]]
grads:  [-0.08295192]
Stock Position:  -0.08295192289948529
Bond Position:  [21.05896666]


portfolio before change:  [13.16553615]
curr_Stock_Price:  95.18842681110941
curr_Factors:  [95.18842681]
mat_Sqrt:  [[0.15]]
grads:  [-0.0531122]
Stock Position:  -0.053112199552639294
Bond Position:  [18.22120287]


portfolio before change:  [13.14128425]
curr_Stock_Price:  95.68792972445247
curr_Factors:  [95.68792972]
mat_Sqrt:  [[0.15]]
grads:  [-0.04300214]
Stock Position:  -0.0430021426880384
Bond Position:  [17.25607025]


portfolio before change:  [13.14859161]
curr_Stock_Price:  95.56816300675143
curr_Factors:  [95.56816301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03132753]
Stock Position:  -0.0313275263437924
Bond Position:  [16.14250576]


portfolio before change:  [13.14517404]
curr_Stock_Price:  95.74166910796052
curr_Factors:  [95.74166911]
mat_Sqrt:  [[0.15]]
grads:  [0.12898021]
Stock Position:  0.12898021007774446
Bond Position:  [0.79639344]


portfolio before change:  [13.09644901]
curr_Stock_Price:  95.36312592402787
curr_Factors:  [95.36312592]
mat_Sqrt:  [[0.15]]
grads:  [0.06549765]
Stock Position:  0.06549764999736334
Bond Position:  [6.85038837]


portfolio before change:  [13.04840154]
curr_Stock_Price:  94.61647581472566
curr_Factors:  [94.61647581]
mat_Sqrt:  [[0.15]]
grads:  [0.12538024]
Stock Position:  0.1253802443524844
Bond Position:  [1.18536468]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.04840154]
Stock Price:  94.73831071531043
PL:  [13.04840154]
Settle:  Tensor("sub_130:0", shape=(), dtype=float64)
PL:  Tensor("sub_131:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  66
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.71833628e-03]
 [-4.47050557e-03]
 [-3.04585311e-03]
 [-1.19705175e-02]
 [ 1.40074268e-02]
 [ 2.14563225e-02]
 [ 2.11537289e-02]
 [-3.14252261e-03]
 [ 8.29252760e-03]
 [-4.46260622e-03]
 [ 4.34643546e-03]
 [ 5.61807784e-03]
 [-9.58841888e-03]
 [ 1.28510363e-02]
 [-4.17667200e-03]
 [-9.35936540e-03]
 [-1.59721242e-03]
 [-3.05587701e-03]
 [-7.92583680e-03]
 [-2.28339414e-03]
 [ 3.06034279e-04]
 [ 8.60758298e-03]
 [ 4.76516482e-03]
 [ 5.42757737e-03]
 [-3.45534097e-03]
 [-4.94498459e-03]
 [-7.66399242e-03]
 [-1.89496084e-02]
 [-2.97425917e-02]
 [ 2.18769094e-02]
 [ 3.32345105e-03]
 [-4.79888128e-03]
 [-1.25335059e-02]
 [-7.49044152e-03]
 [-8.72156100e-03]
 [-7.49483759e-03]
 [ 2.24120564e-02]
 [ 7.35102918e-03]
 [ 2.39817228e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.47463995]
curr_Stock_Price:  99.97002394355412
curr_Factors:  [99.97002394]
mat_Sqrt:  [[0.15]]
grads:  [-0.01145558]
Stock Position:  -0.011455575212022942
Bond Position:  [2.61985408]


portfolio before change:  [1.47621689]
curr_Stock_Price:  99.86095588626189
curr_Factors:  [99.86095589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02980337]
Stock Position:  -0.029803370493275985
Bond Position:  [4.45240996]


portfolio before change:  [1.49152242]
curr_Stock_Price:  99.36608093431452
curr_Factors:  [99.36608093]
mat_Sqrt:  [[0.15]]
grads:  [-0.02030569]
Stock Position:  -0.020305687402571975
Bond Position:  [3.509219]


portfolio before change:  [1.49600513]
curr_Stock_Price:  99.1669233829488
curr_Factors:  [99.16692338]
mat_Sqrt:  [[0.15]]
grads:  [-0.07980345]
Stock Position:  -0.07980344975508895
Bond Position:  [9.40986772]


portfolio before change:  [1.51657782]
curr_Stock_Price:  98.92387141221494
curr_Factors:  [98.92387141]
mat_Sqrt:  [[0.15]]
grads:  [0.09338285]
Stock Position:  0.09338284557998625
Bond Position:  [-7.72121479]


portfolio before change:  [1.51184423]
curr_Stock_Price:  98.88351734008067
curr_Factors:  [98.88351734]
mat_Sqrt:  [[0.15]]
grads:  [0.14304215]
Stock Position:  0.14304214974115909
Bond Position:  [-12.63266666]


portfolio before change:  [1.5722899]
curr_Stock_Price:  99.31712970861486
curr_Factors:  [99.31712971]
mat_Sqrt:  [[0.15]]
grads:  [0.14102486]
Stock Position:  0.14102485953884888
Bond Position:  [-12.43389437]


portfolio before change:  [1.57006407]
curr_Stock_Price:  99.31236820508869
curr_Factors:  [99.31236821]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095015]
Stock Position:  -0.020950150735709376
Bond Position:  [3.65067316]


portfolio before change:  [1.55176335]
curr_Stock_Price:  100.20768807414748
curr_Factors:  [100.20768807]
mat_Sqrt:  [[0.15]]
grads:  [0.05528352]
Stock Position:  0.055283517341710095
Bond Position:  [-3.98807011]


portfolio before change:  [1.51201836]
curr_Stock_Price:  99.49777577146705
curr_Factors:  [99.49777577]
mat_Sqrt:  [[0.15]]
grads:  [-0.02975071]
Stock Position:  -0.029750708145767874
Bond Position:  [4.47214765]


portfolio before change:  [1.51052941]
curr_Stock_Price:  99.56661456307
curr_Factors:  [99.56661456]
mat_Sqrt:  [[0.15]]
grads:  [0.02897624]
Stock Position:  0.028976236426343553
Bond Position:  [-1.37453635]


portfolio before change:  [1.49735036]
curr_Stock_Price:  99.11772193693704
curr_Factors:  [99.11772194]
mat_Sqrt:  [[0.15]]
grads:  [0.03745385]
Stock Position:  0.03745385226705234
Bond Position:  [-2.21499015]


portfolio before change:  [1.53353985]
curr_Stock_Price:  100.0913567578619
curr_Factors:  [100.09135676]
mat_Sqrt:  [[0.15]]
grads:  [-0.06392279]
Stock Position:  -0.06392279253178847
Bond Position:  [7.93165888]


portfolio before change:  [1.50854051]
curr_Stock_Price:  100.4979543642744
curr_Factors:  [100.49795436]
mat_Sqrt:  [[0.15]]
grads:  [0.08567358]
Stock Position:  0.08567357514427465
Bond Position:  [-7.10147853]


portfolio before change:  [1.42063101]
curr_Stock_Price:  99.48221805231111
curr_Factors:  [99.48221805]
mat_Sqrt:  [[0.15]]
grads:  [-0.02784448]
Stock Position:  -0.02784447998040198
Bond Position:  [4.19066164]


portfolio before change:  [1.44254016]
curr_Stock_Price:  98.7141921007579
curr_Factors:  [98.7141921]
mat_Sqrt:  [[0.15]]
grads:  [-0.06239577]
Stock Position:  -0.06239576936068768
Bond Position:  [7.60188812]


portfolio before change:  [1.41534985]
curr_Stock_Price:  99.16519387398125
curr_Factors:  [99.16519387]
mat_Sqrt:  [[0.15]]
grads:  [-0.01064808]
Stock Position:  -0.010648082799726673
Bond Position:  [2.47126905]


portfolio before change:  [1.41288513]
curr_Stock_Price:  99.4256774704873
curr_Factors:  [99.42567747]
mat_Sqrt:  [[0.15]]
grads:  [-0.02037251]
Stock Position:  -0.020372513401101328
Bond Position:  [3.43843608]


portfolio before change:  [1.4207024]
curr_Stock_Price:  99.0630592306634
curr_Factors:  [99.06305923]
mat_Sqrt:  [[0.15]]
grads:  [-0.05283891]
Stock Position:  -0.05283891201189762
Bond Position:  [6.65508668]


portfolio before change:  [1.40177559]
curr_Stock_Price:  99.43700254073835
curr_Factors:  [99.43700254]
mat_Sqrt:  [[0.15]]
grads:  [-0.01522263]
Stock Position:  -0.015222627606045923
Bond Position:  [2.91546805]


portfolio before change:  [1.40511085]
curr_Stock_Price:  99.24184533249685
curr_Factors:  [99.24184533]
mat_Sqrt:  [[0.15]]
grads:  [0.00204023]
Stock Position:  0.002040228529267744
Bond Position:  [1.2026348]


portfolio before change:  [1.40411805]
curr_Stock_Price:  98.6815479525393
curr_Factors:  [98.68154795]
mat_Sqrt:  [[0.15]]
grads:  [0.05738389]
Stock Position:  0.05738388653880396
Bond Position:  [-4.2586127]


portfolio before change:  [1.37166071]
curr_Stock_Price:  98.12520737710807
curr_Factors:  [98.12520738]
mat_Sqrt:  [[0.15]]
grads:  [0.03176777]
Stock Position:  0.031767765487997944
Bond Position:  [-1.74555787]


portfolio before change:  [1.34030791]
curr_Stock_Price:  97.14513883589285
curr_Factors:  [97.14513884]
mat_Sqrt:  [[0.15]]
grads:  [0.03618385]
Stock Position:  0.0361838491018898
Bond Position:  [-2.17477713]


portfolio before change:  [1.40597317]
curr_Stock_Price:  98.96741928589317
curr_Factors:  [98.96741929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02303561]
Stock Position:  -0.02303560643666605
Bond Position:  [3.68574769]


portfolio before change:  [1.43867545]
curr_Stock_Price:  97.56778009336617
curr_Factors:  [97.56778009]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296656]
Stock Position:  -0.03296656392679914
Bond Position:  [4.65514991]


portfolio before change:  [1.44679852]
curr_Stock_Price:  97.33902892522367
curr_Factors:  [97.33902893]
mat_Sqrt:  [[0.15]]
grads:  [-0.05109328]
Stock Position:  -0.051093282807217116
Bond Position:  [6.42016906]


portfolio before change:  [1.48628478]
curr_Stock_Price:  96.58191016736079
curr_Factors:  [96.58191017]
mat_Sqrt:  [[0.15]]
grads:  [-0.12633072]
Stock Position:  -0.12633072292584885
Bond Position:  [13.68754731]


portfolio before change:  [1.45063994]
curr_Stock_Price:  96.87760929734846
curr_Factors:  [96.8776093]
mat_Sqrt:  [[0.15]]
grads:  [-0.19828394]
Stock Position:  -0.19828394485448117
Bond Position:  [20.65991448]


portfolio before change:  [1.51457483]
curr_Stock_Price:  96.56819325369723
curr_Factors:  [96.56819325]
mat_Sqrt:  [[0.15]]
grads:  [0.14584606]
Stock Position:  0.14584606296481525
Bond Position:  [-12.56951597]


portfolio before change:  [1.58974364]
curr_Stock_Price:  97.09436518000638
curr_Factors:  [97.09436518]
mat_Sqrt:  [[0.15]]
grads:  [0.02215634]
Stock Position:  0.022156340360888496
Bond Position:  [-0.56151216]


portfolio before change:  [1.59515222]
curr_Stock_Price:  97.34164274982692
curr_Factors:  [97.34164275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03199254]
Stock Position:  -0.031992541868489204
Bond Position:  [4.7093588]


portfolio before change:  [1.58283983]
curr_Stock_Price:  97.74489577081933
curr_Factors:  [97.74489577]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355671]
Stock Position:  -0.08355670579406897
Bond Position:  [9.75008133]


portfolio before change:  [1.4913595]
curr_Stock_Price:  98.8543120153317
curr_Factors:  [98.85431202]
mat_Sqrt:  [[0.15]]
grads:  [-0.04993628]
Stock Position:  -0.049936276807290965
Bond Position:  [6.42777579]


portfolio before change:  [1.48157494]
curr_Stock_Price:  99.06634389707031
curr_Factors:  [99.0663439]
mat_Sqrt:  [[0.15]]
grads:  [-0.05814374]
Stock Position:  -0.05814373997643033
Bond Position:  [7.24166268]


portfolio before change:  [1.45918965]
curr_Stock_Price:  99.46691245669383
curr_Factors:  [99.46691246]
mat_Sqrt:  [[0.15]]
grads:  [-0.04996558]
Stock Position:  -0.04996558390852334
Bond Position:  [6.42911201]


portfolio before change:  [1.4743371]
curr_Stock_Price:  99.17983977801654
curr_Factors:  [99.17983978]
mat_Sqrt:  [[0.15]]
grads:  [0.14941371]
Stock Position:  0.14941370951736335
Bond Position:  [-13.34449068]


portfolio before change:  [1.59312537]
curr_Stock_Price:  99.98603378042782
curr_Factors:  [99.98603378]
mat_Sqrt:  [[0.15]]
grads:  [0.04900686]
Stock Position:  0.04900686121007368
Bond Position:  [-3.30687631]


portfolio before change:  [1.6190249]
curr_Stock_Price:  100.52295701865859
curr_Factors:  [100.52295702]
mat_Sqrt:  [[0.15]]
grads:  [0.15987815]
Stock Position:  0.15987815186108165
Bond Position:  [-14.45239968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.6190249]
Stock Price:  100.79870495526463
PL:  [0.82031995]
Settle:  Tensor("sub_132:0", shape=(), dtype=float64)
PL:  Tensor("sub_133:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  67
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.50464961e-03]
 [ 2.04977737e-03]
 [ 1.43497901e-03]
 [-1.91199739e-02]
 [ 5.21700254e-03]
 [ 2.41642340e-02]
 [ 5.46567010e-03]
 [-3.32193185e-03]
 [ 1.08322876e-02]
 [ 9.66774683e-05]
 [ 9.66487646e-03]
 [ 2.78387547e-04]
 [-3.21598840e-03]
 [ 1.06587098e-02]
 [-1.78860781e-03]
 [-1.06611637e-02]
 [-1.20980039e-03]
 [-2.96107659e-03]
 [-7.88775982e-03]
 [-2.21398626e-03]
 [ 3.18122475e-04]
 [ 1.04137732e-02]
 [ 4.76686969e-03]
 [ 5.87425653e-03]
 [-2.96866964e-03]
 [-5.01655858e-03]
 [-1.75106015e-03]
 [-2.03969554e-02]
 [-2.99780169e-02]
 [ 2.19186399e-02]
 [ 2.66998400e-03]
 [-6.14036376e-03]
 [-1.25337154e-02]
 [-1.02804973e-02]
 [-6.43976707e-03]
 [-4.85522545e-03]
 [ 2.05800568e-02]
 [ 8.54299111e-03]
 [ 2.30832084e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.99233276]
curr_Stock_Price:  98.9091874652444
curr_Factors:  [98.90918747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03669766]
Stock Position:  -0.03669766408310145
Bond Position:  [-11.36259662]


portfolio before change:  [-15.0059864]
curr_Stock_Price:  99.24253916269042
curr_Factors:  [99.24253916]
mat_Sqrt:  [[0.15]]
grads:  [0.01366518]
Stock Position:  0.013665182457756043
Bond Position:  [-16.36215381]


portfolio before change:  [-15.00483224]
curr_Stock_Price:  99.47667860687908
curr_Factors:  [99.47667861]
mat_Sqrt:  [[0.15]]
grads:  [0.00956653]
Stock Position:  0.009566526705340861
Bond Position:  [-15.95647854]


portfolio before change:  [-15.01427432]
curr_Stock_Price:  98.69819378651086
curr_Factors:  [98.69819379]
mat_Sqrt:  [[0.15]]
grads:  [-0.12746649]
Stock Position:  -0.12746649241415423
Bond Position:  [-2.43356175]


portfolio before change:  [-14.87802633]
curr_Stock_Price:  97.62691457594767
curr_Factors:  [97.62691458]
mat_Sqrt:  [[0.15]]
grads:  [0.03478002]
Stock Position:  0.03478001694473403
Bond Position:  [-18.27349208]


portfolio before change:  [-14.8792266]
curr_Stock_Price:  97.65808355863737
curr_Factors:  [97.65808356]
mat_Sqrt:  [[0.15]]
grads:  [0.16109489]
Stock Position:  0.16109489318258213
Bond Position:  [-30.61144514]


portfolio before change:  [-14.83074371]
curr_Stock_Price:  97.98279628559749
curr_Factors:  [97.98279629]
mat_Sqrt:  [[0.15]]
grads:  [0.0364378]
Stock Position:  0.036437800658194595
Bond Position:  [-18.40102131]


portfolio before change:  [-14.79582405]
curr_Stock_Price:  99.00426110687904
curr_Factors:  [99.00426111]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214621]
Stock Position:  -0.022146212316189146
Bond Position:  [-12.60325466]


portfolio before change:  [-14.77474168]
curr_Stock_Price:  97.9811572449368
curr_Factors:  [97.98115724]
mat_Sqrt:  [[0.15]]
grads:  [0.07221525]
Stock Position:  0.07221525077411195
Bond Position:  [-21.85047552]


portfolio before change:  [-14.80699519]
curr_Stock_Price:  97.57235123882081
curr_Factors:  [97.57235124]
mat_Sqrt:  [[0.15]]
grads:  [0.00064452]
Stock Position:  0.0006445164556286888
Bond Position:  [-14.86988218]


portfolio before change:  [-14.80786606]
curr_Stock_Price:  99.10526113963023
curr_Factors:  [99.10526114]
mat_Sqrt:  [[0.15]]
grads:  [0.06443251]
Stock Position:  0.06443250971847517
Bond Position:  [-21.19346676]


portfolio before change:  [-14.86182681]
curr_Stock_Price:  98.30890225043122
curr_Factors:  [98.30890225]
mat_Sqrt:  [[0.15]]
grads:  [0.00185592]
Stock Position:  0.0018559169776476668
Bond Position:  [-15.04427997]


portfolio before change:  [-14.86227192]
curr_Stock_Price:  99.08239600722688
curr_Factors:  [99.08239601]
mat_Sqrt:  [[0.15]]
grads:  [-0.02143992]
Stock Position:  -0.021439922674078137
Bond Position:  [-12.73795301]


portfolio before change:  [-14.85442916]
curr_Stock_Price:  98.6423244624414
curr_Factors:  [98.64232446]
mat_Sqrt:  [[0.15]]
grads:  [0.07105807]
Stock Position:  0.0710580653329293
Bond Position:  [-21.8637619]


portfolio before change:  [-14.86459505]
curr_Stock_Price:  98.53772339673378
curr_Factors:  [98.5377234]
mat_Sqrt:  [[0.15]]
grads:  [-0.01192405]
Stock Position:  -0.011924052049347312
Bond Position:  [-13.68962611]


portfolio before change:  [-14.87514751]
curr_Stock_Price:  99.27917811629366
curr_Factors:  [99.27917812]
mat_Sqrt:  [[0.15]]
grads:  [-0.07107442]
Stock Position:  -0.07107442493627328
Bond Position:  [-7.81893702]


portfolio before change:  [-14.8790861]
curr_Stock_Price:  99.32084100227922
curr_Factors:  [99.320841]
mat_Sqrt:  [[0.15]]
grads:  [-0.00806534]
Stock Position:  -0.00806533591232045
Bond Position:  [-14.07803016]


portfolio before change:  [-14.88431119]
curr_Stock_Price:  99.75048537417696
curr_Factors:  [99.75048537]
mat_Sqrt:  [[0.15]]
grads:  [-0.01974051]
Stock Position:  -0.019740510625905046
Bond Position:  [-12.91518568]


portfolio before change:  [-14.8720994]
curr_Stock_Price:  99.05008340559033
curr_Factors:  [99.05008341]
mat_Sqrt:  [[0.15]]
grads:  [-0.05258507]
Stock Position:  -0.052585065489844506
Bond Position:  [-9.66354428]


portfolio before change:  [-14.95346192]
curr_Stock_Price:  100.57436606996383
curr_Factors:  [100.57436607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01475991]
Stock Position:  -0.014759908420707693
Bond Position:  [-13.46899349]


portfolio before change:  [-14.92674751]
curr_Stock_Price:  98.65036091406186
curr_Factors:  [98.65036091]
mat_Sqrt:  [[0.15]]
grads:  [0.00212082]
Stock Position:  0.0021208165025820734
Bond Position:  [-15.13596682]


portfolio before change:  [-14.92588074]
curr_Stock_Price:  99.95121904482978
curr_Factors:  [99.95121904]
mat_Sqrt:  [[0.15]]
grads:  [0.06942515]
Stock Position:  0.06942515443833293
Bond Position:  [-21.86500956]


portfolio before change:  [-15.005624]
curr_Stock_Price:  98.84196748196304
curr_Factors:  [98.84196748]
mat_Sqrt:  [[0.15]]
grads:  [0.03177913]
Stock Position:  0.03177913129831923
Bond Position:  [-18.14673586]


portfolio before change:  [-15.01051092]
curr_Stock_Price:  98.75957268828076
curr_Factors:  [98.75957269]
mat_Sqrt:  [[0.15]]
grads:  [0.03916171]
Stock Position:  0.03916171021990485
Bond Position:  [-18.87810469]


portfolio before change:  [-15.0371351]
curr_Stock_Price:  98.13998113019828
curr_Factors:  [98.13998113]
mat_Sqrt:  [[0.15]]
grads:  [-0.01979113]
Stock Position:  -0.019791130933537692
Bond Position:  [-13.09483388]


portfolio before change:  [-15.02866977]
curr_Stock_Price:  97.62953603505663
curr_Factors:  [97.62953604]
mat_Sqrt:  [[0.15]]
grads:  [-0.03344372]
Stock Position:  -0.03344372386537161
Bond Position:  [-11.76357452]


portfolio before change:  [-15.05629233]
curr_Stock_Price:  98.41150723432202
curr_Factors:  [98.41150723]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167373]
Stock Position:  -0.011673734329201465
Bond Position:  [-13.90746254]


portfolio before change:  [-15.05070804]
curr_Stock_Price:  97.7842153357136
curr_Factors:  [97.78421534]
mat_Sqrt:  [[0.15]]
grads:  [-0.1359797]
Stock Position:  -0.13597970255847627
Bond Position:  [-1.75403952]


portfolio before change:  [-14.94981073]
curr_Stock_Price:  97.040600143705
curr_Factors:  [97.04060014]
mat_Sqrt:  [[0.15]]
grads:  [-0.19985345]
Stock Position:  -0.19985344591279575
Bond Position:  [4.4440876]


portfolio before change:  [-14.95833014]
curr_Stock_Price:  97.0860081784535
curr_Factors:  [97.08600818]
mat_Sqrt:  [[0.15]]
grads:  [0.14612427]
Stock Position:  0.1461242658211159
Bond Position:  [-29.14495181]


portfolio before change:  [-15.08123762]
curr_Stock_Price:  96.26982526082725
curr_Factors:  [96.26982526]
mat_Sqrt:  [[0.15]]
grads:  [0.01779989]
Stock Position:  0.017799893346494317
Bond Position:  [-16.79483024]


portfolio before change:  [-15.07705922]
curr_Stock_Price:  96.62251718365275
curr_Factors:  [96.62251718]
mat_Sqrt:  [[0.15]]
grads:  [-0.04093576]
Stock Position:  -0.040935758396271886
Bond Position:  [-11.1217432]


portfolio before change:  [-15.10326133]
curr_Stock_Price:  97.22863280516866
curr_Factors:  [97.22863281]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835581]
Stock Position:  -0.083558102838352
Bond Position:  [-6.97902123]


portfolio before change:  [-15.08818721]
curr_Stock_Price:  97.03778894967382
curr_Factors:  [97.03778895]
mat_Sqrt:  [[0.15]]
grads:  [-0.06853665]
Stock Position:  -0.0685366487239429
Bond Position:  [-8.43754236]


portfolio before change:  [-14.98457648]
curr_Stock_Price:  95.51064258457686
curr_Factors:  [95.51064258]
mat_Sqrt:  [[0.15]]
grads:  [-0.04293178]
Stock Position:  -0.04293178044241188
Bond Position:  [-10.88413454]


portfolio before change:  [-14.99411939]
curr_Stock_Price:  95.70123131055595
curr_Factors:  [95.70123131]
mat_Sqrt:  [[0.15]]
grads:  [-0.03236817]
Stock Position:  -0.032368169651922615
Bond Position:  [-11.8964457]


portfolio before change:  [-15.04269216]
curr_Stock_Price:  97.15592036798067
curr_Factors:  [97.15592037]
mat_Sqrt:  [[0.15]]
grads:  [0.13720038]
Stock Position:  0.13720037892650622
Bond Position:  [-28.37252125]


portfolio before change:  [-14.96248036]
curr_Stock_Price:  97.76640403846712
curr_Factors:  [97.76640404]
mat_Sqrt:  [[0.15]]
grads:  [0.05695327]
Stock Position:  0.05695327406077744
Bond Position:  [-20.53059716]


portfolio before change:  [-14.92256602]
curr_Stock_Price:  98.51229305713404
curr_Factors:  [98.51229306]
mat_Sqrt:  [[0.15]]
grads:  [0.15388806]
Stock Position:  0.15388805567115427
Bond Position:  [-30.08243126]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.92256602]
Stock Price:  97.61153288155225
PL:  [-14.92256602]
Settle:  Tensor("sub_134:0", shape=(), dtype=float64)
PL:  Tensor("sub_135:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  68
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.30685481e-03]
 [ 3.20538144e-03]
 [-2.11659886e-02]
 [-8.32441712e-03]
 [ 1.30543363e-02]
 [ 2.16581362e-02]
 [ 2.06236406e-02]
 [-1.52294076e-03]
 [ 4.78046591e-03]
 [ 5.27687187e-03]
 [ 8.20099766e-03]
 [ 1.07454877e-02]
 [-1.06536096e-02]
 [ 1.27842459e-02]
 [-3.56267132e-03]
 [-9.58767272e-03]
 [-2.90155687e-03]
 [-2.88482961e-03]
 [-8.30308023e-03]
 [-2.26211187e-03]
 [ 3.12926041e-04]
 [ 9.80072841e-03]
 [ 4.76701065e-03]
 [ 5.83056560e-03]
 [-3.33540811e-03]
 [-7.45015462e-03]
 [ 1.45123583e-02]
 [-2.53021097e-02]
 [-3.72160430e-02]
 [ 2.16752536e-02]
 [ 6.54791625e-03]
 [-1.63634918e-03]
 [-1.25282972e-02]
 [-9.60376092e-03]
 [-7.86447070e-03]
 [-7.53159688e-03]
 [ 2.08986559e-02]
 [ 8.85819578e-03]
 [ 2.15215490e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.50478275]
curr_Stock_Price:  99.13386265813975
curr_Factors:  [99.13386266]
mat_Sqrt:  [[0.15]]
grads:  [-0.03537903]
Stock Position:  -0.035379032080304865
Bond Position:  [-7.99752264]


portfolio before change:  [-11.52371755]
curr_Stock_Price:  99.64080276201493
curr_Factors:  [99.64080276]
mat_Sqrt:  [[0.15]]
grads:  [0.02136921]
Stock Position:  0.021369209580444356
Bond Position:  [-13.65296275]


portfolio before change:  [-11.54475984]
curr_Stock_Price:  98.7359701109026
curr_Factors:  [98.73597011]
mat_Sqrt:  [[0.15]]
grads:  [-0.14110659]
Stock Position:  -0.14110659038852927
Bond Position:  [2.38753625]


portfolio before change:  [-11.6422977]
curr_Stock_Price:  99.42932057550028
curr_Factors:  [99.42932058]
mat_Sqrt:  [[0.15]]
grads:  [-0.05549611]
Stock Position:  -0.05549611413215626
Bond Position:  [-6.12435678]


portfolio before change:  [-11.63671579]
curr_Stock_Price:  99.31494320769008
curr_Factors:  [99.31494321]
mat_Sqrt:  [[0.15]]
grads:  [0.08702891]
Stock Position:  0.08702890880055185
Bond Position:  [-20.27998693]


portfolio before change:  [-11.68113555]
curr_Stock_Price:  98.83367091712014
curr_Factors:  [98.83367092]
mat_Sqrt:  [[0.15]]
grads:  [0.14438757]
Stock Position:  0.14438757469765348
Bond Position:  [-25.95148959]


portfolio before change:  [-11.62397798]
curr_Stock_Price:  99.25200128305259
curr_Factors:  [99.25200128]
mat_Sqrt:  [[0.15]]
grads:  [0.13749094]
Stock Position:  0.13749093761755746
Bond Position:  [-25.2702287]


portfolio before change:  [-11.35859878]
curr_Stock_Price:  101.20513496968964
curr_Factors:  [101.20513497]
mat_Sqrt:  [[0.15]]
grads:  [-0.01015294]
Stock Position:  -0.010152938388322279
Bond Position:  [-10.33106928]


portfolio before change:  [-11.36305236]
curr_Stock_Price:  101.51658330733767
curr_Factors:  [101.51658331]
mat_Sqrt:  [[0.15]]
grads:  [0.03186977]
Stock Position:  0.031869772722536785
Bond Position:  [-14.59836279]


portfolio before change:  [-11.39355413]
curr_Stock_Price:  100.61676936429365
curr_Factors:  [100.61676936]
mat_Sqrt:  [[0.15]]
grads:  [0.03517915]
Stock Position:  0.03517914578612921
Bond Position:  [-14.93316613]


portfolio before change:  [-11.40943182]
curr_Stock_Price:  100.21849575916308
curr_Factors:  [100.21849576]
mat_Sqrt:  [[0.15]]
grads:  [0.05467332]
Stock Position:  0.05467331771242893
Bond Position:  [-16.88870948]


portfolio before change:  [-11.38476707]
curr_Stock_Price:  100.70824059809024
curr_Factors:  [100.7082406]
mat_Sqrt:  [[0.15]]
grads:  [0.07163658]
Stock Position:  0.07163658459050894
Bond Position:  [-18.59916146]


portfolio before change:  [-11.37027644]
curr_Stock_Price:  100.94297628557906
curr_Factors:  [100.94297629]
mat_Sqrt:  [[0.15]]
grads:  [-0.07102406]
Stock Position:  -0.07102406417556724
Bond Position:  [-4.20089602]


portfolio before change:  [-11.33073704]
curr_Stock_Price:  100.37887806363572
curr_Factors:  [100.37887806]
mat_Sqrt:  [[0.15]]
grads:  [0.08522831]
Stock Position:  0.08522830614006781
Bond Position:  [-19.88585879]


portfolio before change:  [-11.45492644]
curr_Stock_Price:  98.95090745155389
curr_Factors:  [98.95090745]
mat_Sqrt:  [[0.15]]
grads:  [-0.02375114]
Stock Position:  -0.02375114215992773
Bond Position:  [-9.10472937]


portfolio before change:  [-11.45861907]
curr_Stock_Price:  99.05845875839142
curr_Factors:  [99.05845876]
mat_Sqrt:  [[0.15]]
grads:  [-0.06391782]
Stock Position:  -0.06391781812013385
Bond Position:  [-5.12701852]


portfolio before change:  [-11.43517941]
curr_Stock_Price:  98.6817158871194
curr_Factors:  [98.68171589]
mat_Sqrt:  [[0.15]]
grads:  [-0.01934371]
Stock Position:  -0.0193437124620888
Bond Position:  [-9.52630867]


portfolio before change:  [-11.43509458]
curr_Stock_Price:  98.61576746212688
curr_Factors:  [98.61576746]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192322]
Stock Position:  -0.019232197376046957
Bond Position:  [-9.53849668]


portfolio before change:  [-11.44718114]
curr_Stock_Price:  99.18222209180607
curr_Factors:  [99.18222209]
mat_Sqrt:  [[0.15]]
grads:  [-0.05535387]
Stock Position:  -0.0553538682187878
Bond Position:  [-5.95706149]


portfolio before change:  [-11.46544493]
curr_Stock_Price:  99.49871517322869
curr_Factors:  [99.49871517]
mat_Sqrt:  [[0.15]]
grads:  [-0.01508075]
Stock Position:  -0.015080745830001869
Bond Position:  [-9.9649301]


portfolio before change:  [-11.45773132]
curr_Stock_Price:  98.90462633441534
curr_Factors:  [98.90462633]
mat_Sqrt:  [[0.15]]
grads:  [0.00208617]
Stock Position:  0.0020861736036796585
Bond Position:  [-11.66406354]


portfolio before change:  [-11.4616941]
curr_Stock_Price:  97.70401784717284
curr_Factors:  [97.70401785]
mat_Sqrt:  [[0.15]]
grads:  [0.06533819]
Stock Position:  0.06533818942916839
Bond Position:  [-17.84549773]


portfolio before change:  [-11.40583594]
curr_Stock_Price:  98.59306896580546
curr_Factors:  [98.59306897]
mat_Sqrt:  [[0.15]]
grads:  [0.03178007]
Stock Position:  0.031780071025656484
Bond Position:  [-14.53913067]


portfolio before change:  [-11.40669373]
curr_Stock_Price:  98.62326763241894
curr_Factors:  [98.62326763]
mat_Sqrt:  [[0.15]]
grads:  [0.03887044]
Stock Position:  0.03887043735871592
Bond Position:  [-15.24022327]


portfolio before change:  [-11.3772344]
curr_Stock_Price:  99.43016549726788
curr_Factors:  [99.4301655]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223605]
Stock Position:  -0.022236054055948733
Bond Position:  [-9.16629986]


portfolio before change:  [-11.37297022]
curr_Stock_Price:  99.18686525919271
curr_Factors:  [99.18686526]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496677]
Stock Position:  -0.04966769748222636
Bond Position:  [-6.446587]


portfolio before change:  [-11.40779476]
curr_Stock_Price:  99.87179060558648
curr_Factors:  [99.87179061]
mat_Sqrt:  [[0.15]]
grads:  [0.09674906]
Stock Position:  0.09674905545549821
Bond Position:  [-21.07029617]


portfolio before change:  [-11.42292433]
curr_Stock_Price:  99.74263565050369
curr_Factors:  [99.74263565]
mat_Sqrt:  [[0.15]]
grads:  [-0.16868073]
Stock Position:  -0.16868073121814842
Bond Position:  [5.40173638]


portfolio before change:  [-11.29716244]
curr_Stock_Price:  99.00107715130358
curr_Factors:  [99.00107715]
mat_Sqrt:  [[0.15]]
grads:  [-0.24810695]
Stock Position:  -0.24810695305958336
Bond Position:  [13.26569316]


portfolio before change:  [-11.35231307]
curr_Stock_Price:  99.2300467383428
curr_Factors:  [99.23004674]
mat_Sqrt:  [[0.15]]
grads:  [0.14450169]
Stock Position:  0.14450169082397202
Bond Position:  [-25.69122261]


portfolio before change:  [-11.41765395]
curr_Stock_Price:  98.80009143148685
curr_Factors:  [98.80009143]
mat_Sqrt:  [[0.15]]
grads:  [0.04365277]
Stock Position:  0.0436527749834335
Bond Position:  [-15.73055211]


portfolio before change:  [-11.42184222]
curr_Stock_Price:  98.74919359847682
curr_Factors:  [98.7491936]
mat_Sqrt:  [[0.15]]
grads:  [-0.01090899]
Stock Position:  -0.010908994526910406
Bond Position:  [-10.34458781]


portfolio before change:  [-11.40280584]
curr_Stock_Price:  96.8856368472285
curr_Factors:  [96.88563685]
mat_Sqrt:  [[0.15]]
grads:  [-0.08352198]
Stock Position:  -0.08352198133508132
Bond Position:  [-3.31072549]


portfolio before change:  [-11.47912891]
curr_Stock_Price:  97.79448976094989
curr_Factors:  [97.79448976]
mat_Sqrt:  [[0.15]]
grads:  [-0.06402507]
Stock Position:  -0.06402507281589431
Bond Position:  [-5.21782958]


portfolio before change:  [-11.48852192]
curr_Stock_Price:  97.93101044348846
curr_Factors:  [97.93101044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0524298]
Stock Position:  -0.05242980467415314
Bond Position:  [-6.35401817]


portfolio before change:  [-11.52689897]
curr_Stock_Price:  98.64783064124002
curr_Factors:  [98.64783064]
mat_Sqrt:  [[0.15]]
grads:  [-0.05021065]
Stock Position:  -0.05021064583849838
Bond Position:  [-6.57372768]


portfolio before change:  [-11.46910932]
curr_Stock_Price:  97.48052021147271
curr_Factors:  [97.48052021]
mat_Sqrt:  [[0.15]]
grads:  [0.13932437]
Stock Position:  0.13932437287385308
Bond Position:  [-25.05052167]


portfolio before change:  [-11.51700971]
curr_Stock_Price:  97.15919181444484
curr_Factors:  [97.15919181]
mat_Sqrt:  [[0.15]]
grads:  [0.05905464]
Stock Position:  0.0590546385230413
Bond Position:  [-17.25471066]


portfolio before change:  [-11.54984932]
curr_Stock_Price:  96.63962833812302
curr_Factors:  [96.63962834]
mat_Sqrt:  [[0.15]]
grads:  [0.14347699]
Stock Position:  0.14347699337879713
Bond Position:  [-25.41541263]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.54984932]
Stock Price:  96.23829476880324
PL:  [-11.54984932]
Settle:  Tensor("sub_136:0", shape=(), dtype=float64)
PL:  Tensor("sub_137:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  69
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.55638845e-03]
 [-1.10336790e-02]
 [-9.52567860e-04]
 [-5.94765342e-03]
 [ 1.04657489e-02]
 [ 1.62331581e-02]
 [ 2.61019100e-02]
 [-3.27252432e-03]
 [ 1.56781416e-02]
 [-2.94985804e-03]
 [ 8.40591875e-03]
 [ 4.13772765e-03]
 [ 6.69718520e-03]
 [-1.39566326e-03]
 [ 1.90544713e-02]
 [-5.95477282e-03]
 [-1.15966437e-02]
 [ 4.26593253e-04]
 [-7.75028440e-03]
 [-3.10700328e-03]
 [ 1.51460773e-03]
 [-1.47814230e-02]
 [ 4.76154677e-03]
 [ 5.68742921e-03]
 [ 1.24664428e-02]
 [ 7.33586841e-03]
 [ 2.75151185e-02]
 [-2.23674716e-02]
 [-7.93998436e-03]
 [ 2.16281599e-02]
 [ 2.48923642e-03]
 [-1.86871310e-02]
 [-1.21440444e-02]
 [-2.28390580e-03]
 [-6.79995264e-03]
 [-4.07068294e-04]
 [ 1.75091237e-02]
 [ 1.41869620e-02]
 [ 1.54656158e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.14988048]
curr_Stock_Price:  100.46447883045735
curr_Factors:  [100.46447883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01037592]
Stock Position:  -0.01037592302208544
Bond Position:  [10.19229218]


portfolio before change:  [9.14957199]
curr_Stock_Price:  100.61700568437932
curr_Factors:  [100.61700568]
mat_Sqrt:  [[0.15]]
grads:  [-0.07355786]
Stock Position:  -0.07355786027534608
Bond Position:  [16.55074363]


portfolio before change:  [9.1333798]
curr_Stock_Price:  100.86526139606666
curr_Factors:  [100.8652614]
mat_Sqrt:  [[0.15]]
grads:  [-0.00635045]
Stock Position:  -0.006350452396912595
Bond Position:  [9.77391984]


portfolio before change:  [9.14081752]
curr_Stock_Price:  99.8864496514004
curr_Factors:  [99.88644965]
mat_Sqrt:  [[0.15]]
grads:  [-0.03965102]
Stock Position:  -0.039651022798093113
Bond Position:  [13.10141741]


portfolio before change:  [9.11980426]
curr_Stock_Price:  100.45770937614105
curr_Factors:  [100.45770938]
mat_Sqrt:  [[0.15]]
grads:  [0.06977166]
Stock Position:  0.06977165956024023
Bond Position:  [2.11070316]


portfolio before change:  [9.10407368]
curr_Stock_Price:  100.22846968519512
curr_Factors:  [100.22846969]
mat_Sqrt:  [[0.15]]
grads:  [0.10822105]
Stock Position:  0.10822105373062328
Bond Position:  [-1.74275692]


portfolio before change:  [9.04355695]
curr_Stock_Price:  99.67128725204593
curr_Factors:  [99.67128725]
mat_Sqrt:  [[0.15]]
grads:  [0.17401273]
Stock Position:  0.17401273318612165
Bond Position:  [-8.30051616]


portfolio before change:  [8.94938674]
curr_Stock_Price:  99.13608169652012
curr_Factors:  [99.1360817]
mat_Sqrt:  [[0.15]]
grads:  [-0.02181683]
Stock Position:  -0.021816828768409118
Bond Position:  [11.11222166]


portfolio before change:  [8.93920834]
curr_Stock_Price:  99.66629268010412
curr_Factors:  [99.66629268]
mat_Sqrt:  [[0.15]]
grads:  [0.10452094]
Stock Position:  0.10452094406655464
Bond Position:  [-1.47800667]


portfolio before change:  [8.87965012]
curr_Stock_Price:  99.09823951486865
curr_Factors:  [99.09823951]
mat_Sqrt:  [[0.15]]
grads:  [-0.01966572]
Stock Position:  -0.019665720247814874
Bond Position:  [10.82848838]


portfolio before change:  [8.87878194]
curr_Stock_Price:  99.21121915245406
curr_Factors:  [99.21121915]
mat_Sqrt:  [[0.15]]
grads:  [0.05603946]
Stock Position:  0.05603945830755128
Bond Position:  [3.31903896]


portfolio before change:  [8.86477275]
curr_Stock_Price:  98.95382744132003
curr_Factors:  [98.95382744]
mat_Sqrt:  [[0.15]]
grads:  [0.02758485]
Stock Position:  0.02758485100823264
Bond Position:  [6.13514617]


portfolio before change:  [8.84085735]
curr_Stock_Price:  98.05904828407009
curr_Factors:  [98.05904828]
mat_Sqrt:  [[0.15]]
grads:  [0.0446479]
Stock Position:  0.04464790135189714
Bond Position:  [4.46272663]


portfolio before change:  [8.67520741]
curr_Stock_Price:  94.33641383137042
curr_Factors:  [94.33641383]
mat_Sqrt:  [[0.15]]
grads:  [-0.00930442]
Stock Position:  -0.00930442172267315
Bond Position:  [9.55295318]


portfolio before change:  [8.67049227]
curr_Stock_Price:  94.97152396451854
curr_Factors:  [94.97152396]
mat_Sqrt:  [[0.15]]
grads:  [0.12702981]
Stock Position:  0.12702980881644368
Bond Position:  [-3.39372227]


portfolio before change:  [8.69538081]
curr_Stock_Price:  95.17079043415652
curr_Factors:  [95.17079043]
mat_Sqrt:  [[0.15]]
grads:  [-0.03969849]
Stock Position:  -0.0396984854513587
Bond Position:  [12.47351705]


portfolio before change:  [8.70695676]
curr_Stock_Price:  94.91847173340467
curr_Factors:  [94.91847173]
mat_Sqrt:  [[0.15]]
grads:  [-0.07731096]
Stock Position:  -0.07731095819078618
Bond Position:  [16.04519476]


portfolio before change:  [8.70135899]
curr_Stock_Price:  95.01682190059341
curr_Factors:  [95.0168219]
mat_Sqrt:  [[0.15]]
grads:  [0.00284396]
Stock Position:  0.002843955017865699
Bond Position:  [8.43113543]


portfolio before change:  [8.70113166]
curr_Stock_Price:  94.56628996318173
curr_Factors:  [94.56628996]
mat_Sqrt:  [[0.15]]
grads:  [-0.05166856]
Stock Position:  -0.051668562643809784
Bond Position:  [13.58723594]


portfolio before change:  [8.76213755]
curr_Stock_Price:  93.41844736700934
curr_Factors:  [93.41844737]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071336]
Stock Position:  -0.020713355208596955
Bond Position:  [10.69714703]


portfolio before change:  [8.7748966]
curr_Stock_Price:  92.8670238845462
curr_Factors:  [92.86702388]
mat_Sqrt:  [[0.15]]
grads:  [0.01009738]
Stock Position:  0.010097384881936762
Bond Position:  [7.83718252]


portfolio before change:  [8.76947994]
curr_Stock_Price:  92.23355569975143
curr_Factors:  [92.2335557]
mat_Sqrt:  [[0.15]]
grads:  [-0.09854282]
Stock Position:  -0.09854281996072511
Bond Position:  [17.85843461]


portfolio before change:  [8.77052016]
curr_Stock_Price:  92.24565425410212
curr_Factors:  [92.24565425]
mat_Sqrt:  [[0.15]]
grads:  [0.03174365]
Stock Position:  0.03174364510116731
Bond Position:  [5.84230685]


portfolio before change:  [8.78403503]
curr_Stock_Price:  92.64839749311747
curr_Factors:  [92.64839749]
mat_Sqrt:  [[0.15]]
grads:  [0.03791619]
Stock Position:  0.0379161947526336
Bond Position:  [5.27116035]


portfolio before change:  [8.71726528]
curr_Stock_Price:  90.87003642329846
curr_Factors:  [90.87003642]
mat_Sqrt:  [[0.15]]
grads:  [0.08310962]
Stock Position:  0.0831096183747476
Bond Position:  [1.16509123]


portfolio before change:  [8.56303124]
curr_Stock_Price:  89.01249339149967
curr_Factors:  [89.01249339]
mat_Sqrt:  [[0.15]]
grads:  [0.04890579]
Stock Position:  0.04890578937893515
Bond Position:  [4.20980498]


portfolio before change:  [8.62708066]
curr_Stock_Price:  90.31138183333452
curr_Factors:  [90.31138183]
mat_Sqrt:  [[0.15]]
grads:  [0.18343412]
Stock Position:  0.18343412311950003
Bond Position:  [-7.93910848]


portfolio before change:  [8.60066812]
curr_Stock_Price:  90.172802978658
curr_Factors:  [90.17280298]
mat_Sqrt:  [[0.15]]
grads:  [-0.14911648]
Stock Position:  -0.14911647742194006
Bond Position:  [22.04691886]


portfolio before change:  [8.54692298]
curr_Stock_Price:  90.55170926502595
curr_Factors:  [90.55170927]
mat_Sqrt:  [[0.15]]
grads:  [-0.05293323]
Stock Position:  -0.052933229059109466
Bond Position:  [13.34011735]


portfolio before change:  [8.54593832]
curr_Stock_Price:  90.60181545188057
curr_Factors:  [90.60181545]
mat_Sqrt:  [[0.15]]
grads:  [0.14418773]
Stock Position:  0.1441877328437208
Bond Position:  [-4.51773204]


portfolio before change:  [8.52341448]
curr_Stock_Price:  90.44952033564222
curr_Factors:  [90.44952034]
mat_Sqrt:  [[0.15]]
grads:  [0.01659491]
Stock Position:  0.016594909452466926
Bond Position:  [7.02241288]


portfolio before change:  [8.53419149]
curr_Stock_Price:  91.0460380508961
curr_Factors:  [91.04603805]
mat_Sqrt:  [[0.15]]
grads:  [-0.12458087]
Stock Position:  -0.12458087336002566
Bond Position:  [19.87678643]


portfolio before change:  [8.38158691]
curr_Stock_Price:  92.29092685832961
curr_Factors:  [92.29092686]
mat_Sqrt:  [[0.15]]
grads:  [-0.0809603]
Stock Position:  -0.08096029624816418
Bond Position:  [15.85348769]


portfolio before change:  [8.372487]
curr_Stock_Price:  92.42780538163392
curr_Factors:  [92.42780538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01522604]
Stock Position:  -0.015226038635565495
Bond Position:  [9.77979633]


portfolio before change:  [8.38082357]
curr_Stock_Price:  91.96057801790327
curr_Factors:  [91.96057802]
mat_Sqrt:  [[0.15]]
grads:  [-0.04533302]
Stock Position:  -0.04533301756855865
Bond Position:  [12.54967407]


portfolio before change:  [8.38471741]
curr_Stock_Price:  91.90929015942001
curr_Factors:  [91.90929016]
mat_Sqrt:  [[0.15]]
grads:  [-0.00271379]
Stock Position:  -0.002713788624040386
Bond Position:  [8.6341398]


portfolio before change:  [8.38574162]
curr_Stock_Price:  91.9296027067721
curr_Factors:  [91.92960271]
mat_Sqrt:  [[0.15]]
grads:  [0.11672749]
Stock Position:  0.11672749164334931
Bond Position:  [-2.34497031]


portfolio before change:  [8.3987341]
curr_Stock_Price:  92.04342010657918
curr_Factors:  [92.04342011]
mat_Sqrt:  [[0.15]]
grads:  [0.09457975]
Stock Position:  0.09457974668347562
Bond Position:  [-0.30670926]


portfolio before change:  [8.40651393]
curr_Stock_Price:  92.12608230628759
curr_Factors:  [92.12608231]
mat_Sqrt:  [[0.15]]
grads:  [0.10310411]
Stock Position:  0.10310410561466858
Bond Position:  [-1.09206339]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.40651393]
Stock Price:  91.92738161407449
PL:  [8.40651393]
Settle:  Tensor("sub_138:0", shape=(), dtype=float64)
PL:  Tensor("sub_139:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  70
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.46750058e-03]
 [-1.02503149e-02]
 [ 1.02254062e-02]
 [ 8.81668143e-04]
 [ 6.37842584e-03]
 [ 2.16030250e-02]
 [ 6.98874512e-03]
 [-5.27925490e-03]
 [ 1.47554650e-02]
 [-2.36137036e-04]
 [ 4.95520308e-03]
 [ 4.80935374e-03]
 [ 2.52388381e-03]
 [ 1.05168545e-02]
 [-3.64398389e-03]
 [-9.56452235e-03]
 [-5.70914634e-04]
 [-3.01789218e-03]
 [-8.43097547e-03]
 [-2.27092505e-03]
 [ 3.07485944e-04]
 [ 1.00402130e-02]
 [ 4.76644215e-03]
 [ 6.12662662e-03]
 [-3.33889359e-03]
 [-9.30265416e-03]
 [ 1.34708575e-02]
 [-2.22270226e-02]
 [-3.24887126e-02]
 [ 2.19080547e-02]
 [ 2.66792150e-03]
 [-4.29569327e-03]
 [-1.25335138e-02]
 [-7.89173413e-03]
 [-7.65148053e-03]
 [-7.53138468e-03]
 [ 2.19770841e-02]
 [ 8.15872892e-03]
 [ 2.29952663e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.11456241]
curr_Stock_Price:  100.5266256376421
curr_Factors:  [100.52662564]
mat_Sqrt:  [[0.15]]
grads:  [-0.00978334]
Stock Position:  -0.009783337195385862
Bond Position:  [11.09804828]


portfolio before change:  [10.12088026]
curr_Stock_Price:  100.02265558968269
curr_Factors:  [100.02265559]
mat_Sqrt:  [[0.15]]
grads:  [-0.06833543]
Stock Position:  -0.06833543261263934
Bond Position:  [16.9559717]


portfolio before change:  [10.14543476]
curr_Stock_Price:  99.69435041191662
curr_Factors:  [99.69435041]
mat_Sqrt:  [[0.15]]
grads:  [0.06816937]
Stock Position:  0.06816937488237167
Bond Position:  [3.34933322]


portfolio before change:  [10.2008594]
curr_Stock_Price:  100.5012514876472
curr_Factors:  [100.50125149]
mat_Sqrt:  [[0.15]]
grads:  [0.00587779]
Stock Position:  0.005877787621620066
Bond Position:  [9.61013439]


portfolio before change:  [10.19764036]
curr_Stock_Price:  99.74920306114166
curr_Factors:  [99.74920306]
mat_Sqrt:  [[0.15]]
grads:  [0.04252284]
Stock Position:  0.04252283895323219
Bond Position:  [5.95602106]


portfolio before change:  [10.16050571]
curr_Stock_Price:  98.85840661972523
curr_Factors:  [98.85840662]
mat_Sqrt:  [[0.15]]
grads:  [0.14402017]
Stock Position:  0.14402016679933194
Bond Position:  [-4.0770985]


portfolio before change:  [10.05139052]
curr_Stock_Price:  98.10430722063404
curr_Factors:  [98.10430722]
mat_Sqrt:  [[0.15]]
grads:  [0.04659163]
Stock Position:  0.04659163415277531
Bond Position:  [5.48055053]


portfolio before change:  [10.05172241]
curr_Stock_Price:  98.09672589795603
curr_Factors:  [98.0967259]
mat_Sqrt:  [[0.15]]
grads:  [-0.03519503]
Stock Position:  -0.035195032646053455
Bond Position:  [13.50423988]


portfolio before change:  [10.03614589]
curr_Stock_Price:  98.58726814982558
curr_Factors:  [98.58726815]
mat_Sqrt:  [[0.15]]
grads:  [0.09836977]
Stock Position:  0.0983697665318474
Bond Position:  [0.33813934]


portfolio before change:  [9.99208681]
curr_Stock_Price:  98.13894587170441
curr_Factors:  [98.13894587]
mat_Sqrt:  [[0.15]]
grads:  [-0.00157425]
Stock Position:  -0.0015742469060727772
Bond Position:  [10.14658174]


portfolio before change:  [9.99057426]
curr_Stock_Price:  99.90546993543346
curr_Factors:  [99.90546994]
mat_Sqrt:  [[0.15]]
grads:  [0.03303469]
Stock Position:  0.03303468722794132
Bond Position:  [6.69022831]


portfolio before change:  [9.96242977]
curr_Stock_Price:  99.02818540092413
curr_Factors:  [99.0281854]
mat_Sqrt:  [[0.15]]
grads:  [0.03206236]
Stock Position:  0.032062358286152545
Bond Position:  [6.78735261]


portfolio before change:  [9.95011308]
curr_Stock_Price:  98.61757416853484
curr_Factors:  [98.61757417]
mat_Sqrt:  [[0.15]]
grads:  [0.01682589]
Stock Position:  0.01682589209716972
Bond Position:  [8.29078442]


portfolio before change:  [9.95515502]
curr_Stock_Price:  98.85563158404845
curr_Factors:  [98.85563158]
mat_Sqrt:  [[0.15]]
grads:  [0.07011236]
Stock Position:  0.07011236343403511
Bond Position:  [3.02415305]


portfolio before change:  [9.96659037]
curr_Stock_Price:  99.0133399020014
curr_Factors:  [99.0133399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02429323]
Stock Position:  -0.024293225939464837
Bond Position:  [12.37194381]


portfolio before change:  [9.96730817]
curr_Stock_Price:  99.04745586164096
curr_Factors:  [99.04745586]
mat_Sqrt:  [[0.15]]
grads:  [-0.06376348]
Stock Position:  -0.06376348236328234
Bond Position:  [16.28291888]


portfolio before change:  [9.93966348]
curr_Stock_Price:  99.5129289284997
curr_Factors:  [99.51292893]
mat_Sqrt:  [[0.15]]
grads:  [-0.0038061]
Stock Position:  -0.0038060975618500895
Bond Position:  [10.3184194]


portfolio before change:  [9.94079011]
curr_Stock_Price:  99.55582219626653
curr_Factors:  [99.5558222]
mat_Sqrt:  [[0.15]]
grads:  [-0.02011928]
Stock Position:  -0.020119281176961146
Bond Position:  [11.94378169]


portfolio before change:  [9.94907518]
curr_Stock_Price:  99.21823508862434
curr_Factors:  [99.21823509]
mat_Sqrt:  [[0.15]]
grads:  [-0.0562065]
Stock Position:  -0.05620650312559961
Bond Position:  [15.52578522]


portfolio before change:  [9.91346188]
curr_Stock_Price:  99.88638111002133
curr_Factors:  [99.88638111]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151395]
Stock Position:  -0.015139500362508256
Bond Position:  [11.42569178]


portfolio before change:  [9.9257235]
curr_Stock_Price:  99.17081430253288
curr_Factors:  [99.1708143]
mat_Sqrt:  [[0.15]]
grads:  [0.00204991]
Stock Position:  0.0020499062934975615
Bond Position:  [9.72243262]


portfolio before change:  [9.92901274]
curr_Stock_Price:  100.18249971878772
curr_Factors:  [100.18249972]
mat_Sqrt:  [[0.15]]
grads:  [0.06693475]
Stock Position:  0.066934753573891
Bond Position:  [3.22332181]


portfolio before change:  [9.87100406]
curr_Stock_Price:  99.30983467175076
curr_Factors:  [99.30983467]
mat_Sqrt:  [[0.15]]
grads:  [0.03177628]
Stock Position:  0.031776281017279535
Bond Position:  [6.71530685]


portfolio before change:  [9.88247506]
curr_Stock_Price:  99.64440914375743
curr_Factors:  [99.64440914]
mat_Sqrt:  [[0.15]]
grads:  [0.04084418]
Stock Position:  0.04084417743432325
Bond Position:  [5.81258113]


portfolio before change:  [9.87390179]
curr_Stock_Price:  99.41671720681259
curr_Factors:  [99.41671721]
mat_Sqrt:  [[0.15]]
grads:  [-0.02225929]
Stock Position:  -0.022259290578227654
Bond Position:  [12.08684738]


portfolio before change:  [9.84919127]
curr_Stock_Price:  100.59471810055597
curr_Factors:  [100.5947181]
mat_Sqrt:  [[0.15]]
grads:  [-0.06201769]
Stock Position:  -0.06201769439188877
Bond Position:  [16.08784376]


portfolio before change:  [9.87687377]
curr_Stock_Price:  100.18078161590803
curr_Factors:  [100.18078162]
mat_Sqrt:  [[0.15]]
grads:  [0.08980572]
Stock Position:  0.08980571666061005
Bond Position:  [0.88006688]


portfolio before change:  [9.71318854]
curr_Stock_Price:  98.35689725145741
curr_Factors:  [98.35689725]
mat_Sqrt:  [[0.15]]
grads:  [-0.14818015]
Stock Position:  -0.1481801505076122
Bond Position:  [24.28772838]


portfolio before change:  [9.78245848]
curr_Stock_Price:  97.90991572713368
curr_Factors:  [97.90991573]
mat_Sqrt:  [[0.15]]
grads:  [-0.21659142]
Stock Position:  -0.21659141719716984
Bond Position:  [30.98890589]


portfolio before change:  [9.9894093]
curr_Stock_Price:  96.97231181885667
curr_Factors:  [96.97231182]
mat_Sqrt:  [[0.15]]
grads:  [0.1460537]
Stock Position:  0.1460536977309742
Bond Position:  [-4.17375542]


portfolio before change:  [9.87658658]
curr_Stock_Price:  96.20340991649716
curr_Factors:  [96.20340992]
mat_Sqrt:  [[0.15]]
grads:  [0.01778614]
Stock Position:  0.017786143307404672
Bond Position:  [8.16549895]


portfolio before change:  [9.90183539]
curr_Stock_Price:  97.56559706676158
curr_Factors:  [97.56559707]
mat_Sqrt:  [[0.15]]
grads:  [-0.02863796]
Stock Position:  -0.028637955106687922
Bond Position:  [12.69591458]


portfolio before change:  [9.90722506]
curr_Stock_Price:  97.43281570850971
curr_Factors:  [97.43281571]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355676]
Stock Position:  -0.083556758504901
Bond Position:  [18.04839532]


portfolio before change:  [9.8155441]
curr_Stock_Price:  98.55704738485386
curr_Factors:  [98.55704738]
mat_Sqrt:  [[0.15]]
grads:  [-0.05261156]
Stock Position:  -0.052611560877351235
Bond Position:  [15.0007842]


portfolio before change:  [9.86494561]
curr_Stock_Price:  97.65370410852827
curr_Factors:  [97.65370411]
mat_Sqrt:  [[0.15]]
grads:  [-0.05100987]
Stock Position:  -0.051009870209374836
Bond Position:  [14.84624839]


portfolio before change:  [9.81660949]
curr_Stock_Price:  98.63767098193183
curr_Factors:  [98.63767098]
mat_Sqrt:  [[0.15]]
grads:  [-0.05020923]
Stock Position:  -0.050209231213475335
Bond Position:  [14.76913112]


portfolio before change:  [9.82359942]
curr_Stock_Price:  98.53522618429052
curr_Factors:  [98.53522618]
mat_Sqrt:  [[0.15]]
grads:  [0.14651389]
Stock Position:  0.1465138941602888
Bond Position:  [-4.61318028]


portfolio before change:  [9.79880535]
curr_Stock_Price:  98.3699354714288
curr_Factors:  [98.36993547]
mat_Sqrt:  [[0.15]]
grads:  [0.05439153]
Stock Position:  0.054391526152319306
Bond Position:  [4.44831443]


portfolio before change:  [9.79905516]
curr_Stock_Price:  98.36430472214822
curr_Factors:  [98.36430472]
mat_Sqrt:  [[0.15]]
grads:  [0.15330178]
Stock Position:  0.15330177550779975
Bond Position:  [-5.2803674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.79905516]
Stock Price:  99.34224970503949
PL:  [9.79905516]
Settle:  Tensor("sub_140:0", shape=(), dtype=float64)
PL:  Tensor("sub_141:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  71
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.36778151e-03]
 [-1.28902171e-02]
 [ 1.69904874e-02]
 [-6.16086369e-03]
 [ 9.73293238e-03]
 [ 2.24528233e-02]
 [ 1.67193168e-02]
 [-3.43452667e-03]
 [ 1.74848190e-02]
 [-4.44546298e-03]
 [ 2.17465952e-02]
 [ 1.05075570e-02]
 [-1.22200181e-02]
 [ 1.00691230e-02]
 [-3.49295404e-03]
 [-2.70717928e-02]
 [ 5.00990373e-03]
 [-3.47901528e-03]
 [ 1.19087840e-03]
 [-2.62859680e-03]
 [-1.18292682e-03]
 [-3.07792524e-02]
 [ 4.78429179e-03]
 [ 7.62223758e-03]
 [-3.89857211e-03]
 [-8.48092710e-03]
 [ 7.28174232e-03]
 [-1.96867088e-02]
 [-1.58609641e-02]
 [ 2.15467988e-02]
 [ 9.15393766e-03]
 [-2.74041721e-03]
 [-1.25334850e-02]
 [-6.33888818e-03]
 [-5.97373272e-03]
 [-6.85904139e-03]
 [ 2.26742945e-02]
 [ 7.81552514e-03]
 [ 2.33149175e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.07494143]
curr_Stock_Price:  100.65291731341203
curr_Factors:  [100.65291731]
mat_Sqrt:  [[0.15]]
grads:  [-0.00911854]
Stock Position:  -0.009118543387102222
Bond Position:  [12.99274942]


portfolio before change:  [12.07791406]
curr_Stock_Price:  100.50503848554864
curr_Factors:  [100.50503849]
mat_Sqrt:  [[0.15]]
grads:  [-0.08593478]
Stock Position:  -0.08593478037643157
Bond Position:  [20.71479247]


portfolio before change:  [12.13294693]
curr_Stock_Price:  99.89476917263644
curr_Factors:  [99.89476917]
mat_Sqrt:  [[0.15]]
grads:  [0.11326992]
Stock Position:  0.11326991609509982
Bond Position:  [0.81787481]


portfolio before change:  [12.12538875]
curr_Stock_Price:  99.82713934862456
curr_Factors:  [99.82713935]
mat_Sqrt:  [[0.15]]
grads:  [-0.04107242]
Stock Position:  -0.041072424600239646
Bond Position:  [16.2255314]


portfolio before change:  [12.13809019]
curr_Stock_Price:  99.56727826670546
curr_Factors:  [99.56727827]
mat_Sqrt:  [[0.15]]
grads:  [0.06488622]
Stock Position:  0.06488621587620841
Bond Position:  [5.67754628]


portfolio before change:  [12.06805521]
curr_Stock_Price:  98.47698936193437
curr_Factors:  [98.47698936]
mat_Sqrt:  [[0.15]]
grads:  [0.14968549]
Stock Position:  0.14968548851288938
Bond Position:  [-2.67252105]


portfolio before change:  [12.11764578]
curr_Stock_Price:  98.81051973194185
curr_Factors:  [98.81051973]
mat_Sqrt:  [[0.15]]
grads:  [0.11146211]
Stock Position:  0.11146211218776884
Bond Position:  [1.10401654]


portfolio before change:  [12.10589473]
curr_Stock_Price:  98.70385517702803
curr_Factors:  [98.70385518]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289684]
Stock Position:  -0.02289684445353487
Bond Position:  [14.36590155]


portfolio before change:  [12.09528521]
curr_Stock_Price:  99.24564914084661
curr_Factors:  [99.24564914]
mat_Sqrt:  [[0.15]]
grads:  [0.11656546]
Stock Position:  0.11656546008800939
Bond Position:  [0.52667046]


portfolio before change:  [12.12788411]
curr_Stock_Price:  99.52474603495492
curr_Factors:  [99.52474603]
mat_Sqrt:  [[0.15]]
grads:  [-0.02963642]
Stock Position:  -0.029636419892824062
Bond Position:  [15.07744127]


portfolio before change:  [12.08109953]
curr_Stock_Price:  101.1669610905365
curr_Factors:  [101.16696109]
mat_Sqrt:  [[0.15]]
grads:  [0.1449773]
Stock Position:  0.14497730122646413
Bond Position:  [-2.58581346]


portfolio before change:  [12.0325464]
curr_Stock_Price:  100.83428914286503
curr_Factors:  [100.83428914]
mat_Sqrt:  [[0.15]]
grads:  [0.07005038]
Stock Position:  0.07005038010487968
Bond Position:  [4.96906612]


portfolio before change:  [12.18571793]
curr_Stock_Price:  103.01201253238447
curr_Factors:  [103.01201253]
mat_Sqrt:  [[0.15]]
grads:  [-0.08146679]
Stock Position:  -0.08146678715791006
Bond Position:  [20.57777563]


portfolio before change:  [12.21256578]
curr_Stock_Price:  102.71403257435826
curr_Factors:  [102.71403257]
mat_Sqrt:  [[0.15]]
grads:  [0.06712749]
Stock Position:  0.06712748643579589
Bond Position:  [5.31763095]


portfolio before change:  [12.19168504]
curr_Stock_Price:  102.39306894439318
curr_Factors:  [102.39306894]
mat_Sqrt:  [[0.15]]
grads:  [-0.02328636]
Stock Position:  -0.0232863602993812
Bond Position:  [14.57604694]


portfolio before change:  [12.20307535]
curr_Stock_Price:  101.98217651165238
curr_Factors:  [101.98217651]
mat_Sqrt:  [[0.15]]
grads:  [-0.18047862]
Stock Position:  -0.18047861887558236
Bond Position:  [30.60867772]


portfolio before change:  [11.99658771]
curr_Stock_Price:  103.1474888943345
curr_Factors:  [103.14748889]
mat_Sqrt:  [[0.15]]
grads:  [0.03339936]
Stock Position:  0.03339935820616275
Bond Position:  [8.55152778]


portfolio before change:  [12.00783435]
curr_Stock_Price:  103.45221427834083
curr_Factors:  [103.45221428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02319344]
Stock Position:  -0.023193435215927777
Bond Position:  [14.40724658]


portfolio before change:  [12.00956436]
curr_Stock_Price:  103.45527573676542
curr_Factors:  [103.45527574]
mat_Sqrt:  [[0.15]]
grads:  [0.00793919]
Stock Position:  0.007939189302852874
Bond Position:  [11.18821334]


portfolio before change:  [12.00327243]
curr_Stock_Price:  102.48659479617075
curr_Factors:  [102.4865948]
mat_Sqrt:  [[0.15]]
grads:  [-0.01752398]
Stock Position:  -0.017523978698165806
Bond Position:  [13.79924533]


portfolio before change:  [11.99535695]
curr_Stock_Price:  103.03672614655575
curr_Factors:  [103.03672615]
mat_Sqrt:  [[0.15]]
grads:  [-0.00788618]
Stock Position:  -0.007886178774837499
Bond Position:  [12.807923]


portfolio before change:  [12.0029072]
curr_Stock_Price:  102.28234858539581
curr_Factors:  [102.28234859]
mat_Sqrt:  [[0.15]]
grads:  [-0.20519502]
Stock Position:  -0.2051950157173748
Bond Position:  [32.99073533]


portfolio before change:  [12.15841648]
curr_Stock_Price:  101.544586121239
curr_Factors:  [101.54458612]
mat_Sqrt:  [[0.15]]
grads:  [0.03189528]
Stock Position:  0.03189527861944718
Bond Position:  [8.91962361]


portfolio before change:  [12.16583753]
curr_Stock_Price:  101.74229633147027
curr_Factors:  [101.74229633]
mat_Sqrt:  [[0.15]]
grads:  [0.05081492]
Stock Position:  0.05081491717214248
Bond Position:  [6.99581116]


portfolio before change:  [12.11142597]
curr_Stock_Price:  100.65430708609873
curr_Factors:  [100.65430709]
mat_Sqrt:  [[0.15]]
grads:  [-0.02599048]
Stock Position:  -0.025990480753944098
Bond Position:  [14.7274798]


portfolio before change:  [12.10403324]
curr_Stock_Price:  101.00958262859592
curr_Factors:  [101.00958263]
mat_Sqrt:  [[0.15]]
grads:  [-0.05653951]
Stock Position:  -0.0565395140290291
Bond Position:  [17.81506596]


portfolio before change:  [12.0983092]
curr_Stock_Price:  101.15021104353295
curr_Factors:  [101.15021104]
mat_Sqrt:  [[0.15]]
grads:  [0.04854495]
Stock Position:  0.048544948795875495
Bond Position:  [7.18797739]


portfolio before change:  [12.0974729]
curr_Stock_Price:  101.11447395625663
curr_Factors:  [101.11447396]
mat_Sqrt:  [[0.15]]
grads:  [-0.13124473]
Stock Position:  -0.13124472539032989
Bond Position:  [25.36821427]


portfolio before change:  [12.165802]
curr_Stock_Price:  100.61801304141925
curr_Factors:  [100.61801304]
mat_Sqrt:  [[0.15]]
grads:  [-0.10573976]
Stock Position:  -0.10573976053148643
Bond Position:  [22.80512661]


portfolio before change:  [12.25317077]
curr_Stock_Price:  99.81871154637169
curr_Factors:  [99.81871155]
mat_Sqrt:  [[0.15]]
grads:  [0.14364533]
Stock Position:  0.1436453251347612
Bond Position:  [-2.08532051]


portfolio before change:  [12.27119147]
curr_Stock_Price:  99.94597903804146
curr_Factors:  [99.94597904]
mat_Sqrt:  [[0.15]]
grads:  [0.06102625]
Stock Position:  0.06102625108191827
Bond Position:  [6.17186306]


portfolio before change:  [12.16894007]
curr_Stock_Price:  98.2578051035517
curr_Factors:  [98.2578051]
mat_Sqrt:  [[0.15]]
grads:  [-0.01826945]
Stock Position:  -0.018269448045018313
Bond Position:  [13.96405594]


portfolio before change:  [12.16498561]
curr_Stock_Price:  98.56980542941835
curr_Factors:  [98.56980543]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355657]
Stock Position:  -0.08355656646548087
Bond Position:  [20.40114011]


portfolio before change:  [12.07248697]
curr_Stock_Price:  99.70734561044948
curr_Factors:  [99.70734561]
mat_Sqrt:  [[0.15]]
grads:  [-0.04225925]
Stock Position:  -0.042259254537347635
Bond Position:  [16.28604506]


portfolio before change:  [12.03767527]
curr_Stock_Price:  100.57928671658803
curr_Factors:  [100.57928672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03982488]
Stock Position:  -0.03982488478128477
Bond Position:  [16.04323377]


portfolio before change:  [12.02639467]
curr_Stock_Price:  100.91290030447375
curr_Factors:  [100.9129003]
mat_Sqrt:  [[0.15]]
grads:  [-0.04572694]
Stock Position:  -0.04572694259164699
Bond Position:  [16.64083307]


portfolio before change:  [12.0726179]
curr_Stock_Price:  99.94753973187001
curr_Factors:  [99.94753973]
mat_Sqrt:  [[0.15]]
grads:  [0.15116196]
Stock Position:  0.15116196347305805
Bond Position:  [-3.03564845]


portfolio before change:  [12.02967129]
curr_Stock_Price:  99.66594028604045
curr_Factors:  [99.66594029]
mat_Sqrt:  [[0.15]]
grads:  [0.0521035]
Stock Position:  0.052103500920241644
Bond Position:  [6.83672688]


portfolio before change:  [11.99262565]
curr_Stock_Price:  98.93853649058686
curr_Factors:  [98.93853649]
mat_Sqrt:  [[0.15]]
grads:  [0.15543278]
Stock Position:  0.15543278324651144
Bond Position:  [-3.38566645]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.99262565]
Stock Price:  98.07534706062056
PL:  [11.99262565]
Settle:  Tensor("sub_142:0", shape=(), dtype=float64)
PL:  Tensor("sub_143:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  72
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.28537172e-03]
 [ 3.28150709e-03]
 [-2.11475783e-02]
 [-1.74085873e-02]
 [ 1.41215335e-02]
 [ 1.67866709e-02]
 [ 1.90761200e-02]
 [-3.43484890e-03]
 [ 1.21237945e-02]
 [-2.48395283e-04]
 [ 1.28021483e-02]
 [ 3.67095777e-03]
 [-5.80112120e-03]
 [ 1.10999564e-02]
 [-4.34608758e-03]
 [-1.13752704e-02]
 [ 9.49652403e-04]
 [-3.33466125e-03]
 [-9.13501866e-03]
 [-2.27279837e-03]
 [ 3.16682627e-04]
 [ 8.49759946e-03]
 [ 4.76409667e-03]
 [ 5.76154958e-03]
 [-3.60864727e-03]
 [-6.88667484e-03]
 [-1.91999018e-03]
 [-1.98267723e-02]
 [-3.37199802e-02]
 [ 2.20601767e-02]
 [ 3.87785219e-03]
 [-3.87698982e-03]
 [-1.25350121e-02]
 [-9.66810729e-03]
 [-7.29369414e-03]
 [-7.52052056e-03]
 [ 2.10319574e-02]
 [ 8.17156148e-03]
 [ 2.27702599e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.12598938]
curr_Stock_Price:  99.15826531131707
curr_Factors:  [99.15826531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03523581]
Stock Position:  -0.035235811464721635
Bond Position:  [-7.63206744]


portfolio before change:  [-11.1438521]
curr_Stock_Price:  99.63813644726731
curr_Factors:  [99.63813645]
mat_Sqrt:  [[0.15]]
grads:  [0.02187671]
Stock Position:  0.02187671393183056
Bond Position:  [-13.32360711]


portfolio before change:  [-11.16523042]
curr_Stock_Price:  98.73705192327687
curr_Factors:  [98.73705192]
mat_Sqrt:  [[0.15]]
grads:  [-0.14098386]
Stock Position:  -0.14098385560182064
Bond Position:  [2.75509985]


portfolio before change:  [-11.17563421]
curr_Stock_Price:  98.81328899471349
curr_Factors:  [98.81328899]
mat_Sqrt:  [[0.15]]
grads:  [-0.11605725]
Stock Position:  -0.11605724888405514
Bond Position:  [0.29236427]


portfolio before change:  [-11.18100619]
curr_Stock_Price:  98.85989121682263
curr_Factors:  [98.85989122]
mat_Sqrt:  [[0.15]]
grads:  [0.09414356]
Stock Position:  0.09414355645079488
Bond Position:  [-20.48802794]


portfolio before change:  [-11.11979497]
curr_Stock_Price:  99.53728629042217
curr_Factors:  [99.53728629]
mat_Sqrt:  [[0.15]]
grads:  [0.11191114]
Stock Position:  0.11191113902416698
Bond Position:  [-22.25912605]


portfolio before change:  [-11.18140093]
curr_Stock_Price:  99.01166034280628
curr_Factors:  [99.01166034]
mat_Sqrt:  [[0.15]]
grads:  [0.12717413]
Stock Position:  0.1271741336457231
Bond Position:  [-23.77312306]


portfolio before change:  [-11.22362695]
curr_Stock_Price:  98.70299546185504
curr_Factors:  [98.70299546]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289899]
Stock Position:  -0.022898992646275748
Bond Position:  [-8.96342778]


portfolio before change:  [-11.21262287]
curr_Stock_Price:  98.17351480423456
curr_Factors:  [98.1735148]
mat_Sqrt:  [[0.15]]
grads:  [0.0808253]
Stock Position:  0.08082529646863479
Bond Position:  [-19.14752631]


portfolio before change:  [-11.21612377]
curr_Stock_Price:  98.15981472563642
curr_Factors:  [98.15981473]
mat_Sqrt:  [[0.15]]
grads:  [-0.00165597]
Stock Position:  -0.0016559685564685538
Bond Position:  [-11.05357421]


portfolio before change:  [-11.21852856]
curr_Stock_Price:  98.77758399090665
curr_Factors:  [98.77758399]
mat_Sqrt:  [[0.15]]
grads:  [0.08534766]
Stock Position:  0.08534765549137041
Bond Position:  [-19.64896377]


portfolio before change:  [-11.21042945]
curr_Stock_Price:  98.90125917373507
curr_Factors:  [98.90125917]
mat_Sqrt:  [[0.15]]
grads:  [0.02447305]
Stock Position:  0.024473051794889514
Bond Position:  [-13.63084509]


portfolio before change:  [-11.20142196]
curr_Stock_Price:  99.3389429027869
curr_Factors:  [99.3389429]
mat_Sqrt:  [[0.15]]
grads:  [-0.03867414]
Stock Position:  -0.03867414130759305
Bond Position:  [-7.35957364]


portfolio before change:  [-11.22445284]
curr_Stock_Price:  99.91066548778306
curr_Factors:  [99.91066549]
mat_Sqrt:  [[0.15]]
grads:  [0.07399971]
Stock Position:  0.0739997091332942
Bond Position:  [-18.61781303]


portfolio before change:  [-11.24543494]
curr_Stock_Price:  99.6585736600357
curr_Factors:  [99.65857366]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897392]
Stock Position:  -0.028973917198210835
Bond Position:  [-8.35793567]


portfolio before change:  [-11.24259674]
curr_Stock_Price:  99.52455632085024
curr_Factors:  [99.52455632]
mat_Sqrt:  [[0.15]]
grads:  [-0.07583514]
Stock Position:  -0.07583513608179288
Bond Position:  [-3.69513846]


portfolio before change:  [-11.2603575]
curr_Stock_Price:  99.75266756532041
curr_Factors:  [99.75266757]
mat_Sqrt:  [[0.15]]
grads:  [0.00633102]
Stock Position:  0.0063310160175521005
Bond Position:  [-11.89189324]


portfolio before change:  [-11.2580116]
curr_Stock_Price:  100.35801725873613
curr_Factors:  [100.35801726]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223107]
Stock Position:  -0.022231074966900004
Bond Position:  [-9.026945]


portfolio before change:  [-11.23758031]
curr_Stock_Price:  99.38821554239186
curr_Factors:  [99.38821554]
mat_Sqrt:  [[0.15]]
grads:  [-0.06090012]
Stock Position:  -0.06090012439854159
Bond Position:  [-5.18482562]


portfolio before change:  [-11.2700794]
curr_Stock_Price:  99.91121857200513
curr_Factors:  [99.91121857]
mat_Sqrt:  [[0.15]]
grads:  [-0.01515199]
Stock Position:  -0.01515198913271524
Bond Position:  [-9.7562257]


portfolio before change:  [-11.26358734]
curr_Stock_Price:  99.40226449550508
curr_Factors:  [99.4022645]
mat_Sqrt:  [[0.15]]
grads:  [0.00211122]
Stock Position:  0.0021112175138606
Bond Position:  [-11.47344714]


portfolio before change:  [-11.26554099]
curr_Stock_Price:  99.15625493084568
curr_Factors:  [99.15625493]
mat_Sqrt:  [[0.15]]
grads:  [0.05665066]
Stock Position:  0.05665066308651864
Bond Position:  [-16.88280858]


portfolio before change:  [-11.33264293]
curr_Stock_Price:  98.00902295196684
curr_Factors:  [98.00902295]
mat_Sqrt:  [[0.15]]
grads:  [0.03176064]
Stock Position:  0.03176064444090869
Bond Position:  [-14.44547266]


portfolio before change:  [-11.32604249]
curr_Stock_Price:  98.27369732646287
curr_Factors:  [98.27369733]
mat_Sqrt:  [[0.15]]
grads:  [0.03841033]
Stock Position:  0.03841033054817449
Bond Position:  [-15.10076769]


portfolio before change:  [-11.32202035]
curr_Stock_Price:  98.42755838095525
curr_Factors:  [98.42755838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02405765]
Stock Position:  -0.024057648433716303
Bond Position:  [-8.95408476]


portfolio before change:  [-11.33441917]
curr_Stock_Price:  98.89641068301431
curr_Factors:  [98.89641068]
mat_Sqrt:  [[0.15]]
grads:  [-0.04591117]
Stock Position:  -0.045911165615479387
Bond Position:  [-6.79396968]


portfolio before change:  [-11.31221114]
curr_Stock_Price:  98.39419459034207
curr_Factors:  [98.39419459]
mat_Sqrt:  [[0.15]]
grads:  [-0.01279993]
Stock Position:  -0.012799934538128907
Bond Position:  [-10.05277189]


portfolio before change:  [-11.29959745]
curr_Stock_Price:  97.31056655462878
curr_Factors:  [97.31056655]
mat_Sqrt:  [[0.15]]
grads:  [-0.13217848]
Stock Position:  -0.1321784817353406
Bond Position:  [1.5627655]


portfolio before change:  [-11.39904053]
curr_Stock_Price:  98.06438392669988
curr_Factors:  [98.06438393]
mat_Sqrt:  [[0.15]]
grads:  [-0.22479987]
Stock Position:  -0.22479986817480935
Bond Position:  [10.64582005]


portfolio before change:  [-11.41843912]
curr_Stock_Price:  98.15659664175739
curr_Factors:  [98.15659664]
mat_Sqrt:  [[0.15]]
grads:  [0.14706784]
Stock Position:  0.14706784449473254
Bond Position:  [-25.85411821]


portfolio before change:  [-11.44634878]
curr_Stock_Price:  97.98879860409335
curr_Factors:  [97.9887986]
mat_Sqrt:  [[0.15]]
grads:  [0.02585235]
Stock Position:  0.02585234795124109
Bond Position:  [-13.9795893]


portfolio before change:  [-11.45421944]
curr_Stock_Price:  97.75194976353094
curr_Factors:  [97.75194976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0258466]
Stock Position:  -0.02584659882400981
Bond Position:  [-8.92766401]


portfolio before change:  [-11.4399027]
curr_Stock_Price:  97.15485885996281
curr_Factors:  [97.15485886]
mat_Sqrt:  [[0.15]]
grads:  [-0.08356675]
Stock Position:  -0.08356674703227768
Bond Position:  [-3.32098719]


portfolio before change:  [-11.49128788]
curr_Stock_Price:  97.76479082139818
curr_Factors:  [97.76479082]
mat_Sqrt:  [[0.15]]
grads:  [-0.06445405]
Stock Position:  -0.0644540485923103
Bond Position:  [-5.1899513]


portfolio before change:  [-11.45475228]
curr_Stock_Price:  97.18787775719333
curr_Factors:  [97.18787776]
mat_Sqrt:  [[0.15]]
grads:  [-0.04862463]
Stock Position:  -0.04862462758245315
Bond Position:  [-6.72902792]


portfolio before change:  [-11.49957058]
curr_Stock_Price:  98.0922985168672
curr_Factors:  [98.09229852]
mat_Sqrt:  [[0.15]]
grads:  [-0.0501368]
Stock Position:  -0.05013680370275872
Bond Position:  [-6.58153627]


portfolio before change:  [-11.47622839]
curr_Stock_Price:  97.61031858945591
curr_Factors:  [97.61031859]
mat_Sqrt:  [[0.15]]
grads:  [0.14021305]
Stock Position:  0.14021304908537408
Bond Position:  [-25.16246879]


portfolio before change:  [-11.37569171]
curr_Stock_Price:  98.3497803406399
curr_Factors:  [98.34978034]
mat_Sqrt:  [[0.15]]
grads:  [0.05447708]
Stock Position:  0.05447707656663625
Bond Position:  [-16.73350023]


portfolio before change:  [-11.39755162]
curr_Stock_Price:  97.98691040527251
curr_Factors:  [97.98691041]
mat_Sqrt:  [[0.15]]
grads:  [0.15180173]
Stock Position:  0.15180173275349543
Bond Position:  [-26.27213441]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.39755162]
Stock Price:  98.472043396883
PL:  [-11.39755162]
Settle:  Tensor("sub_144:0", shape=(), dtype=float64)
PL:  Tensor("sub_145:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  73
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.56974312e-03]
 [-6.20678457e-03]
 [-1.93078932e-02]
 [-2.95644535e-02]
 [ 2.87459350e-05]
 [ 2.45285175e-02]
 [ 2.92063204e-03]
 [-5.49426214e-03]
 [ 9.07198220e-03]
 [ 1.79309834e-04]
 [-2.96850365e-02]
 [ 6.23922094e-04]
 [-1.24497140e-03]
 [ 1.06290302e-02]
 [-1.75112788e-03]
 [-1.37356294e-02]
 [ 4.77424660e-03]
 [ 1.96064038e-03]
 [-1.16025354e-02]
 [-2.32927533e-03]
 [ 7.02924697e-05]
 [ 1.01465933e-02]
 [ 4.77863803e-03]
 [ 6.87370950e-03]
 [-3.67595304e-03]
 [-8.64636990e-03]
 [ 1.28280002e-02]
 [-1.98210307e-02]
 [-1.11706879e-02]
 [ 2.32285655e-02]
 [-1.17337119e-02]
 [ 6.27325344e-03]
 [-1.29888954e-02]
 [ 2.28980496e-03]
 [-6.68186947e-03]
 [ 6.04007967e-04]
 [ 2.41072846e-02]
 [ 1.58227541e-03]
 [ 2.07989253e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.0047477]
curr_Stock_Price:  100.45512907629524
curr_Factors:  [100.45512908]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046495]
Stock Position:  -0.010464954109650778
Bond Position:  [10.05600602]


portfolio before change:  [9.02689065]
curr_Stock_Price:  98.45933697547375
curr_Factors:  [98.45933698]
mat_Sqrt:  [[0.15]]
grads:  [-0.04137856]
Stock Position:  -0.04137856381556506
Bond Position:  [13.10099661]


portfolio before change:  [9.01260365]
curr_Stock_Price:  98.84419158633392
curr_Factors:  [98.84419159]
mat_Sqrt:  [[0.15]]
grads:  [-0.12871929]
Stock Position:  -0.1287192881952903
Bond Position:  [21.73575763]


portfolio before change:  [9.19608998]
curr_Stock_Price:  97.43982404646692
curr_Factors:  [97.43982405]
mat_Sqrt:  [[0.15]]
grads:  [-0.19709636]
Stock Position:  -0.1970963568475145
Bond Position:  [28.40112431]


portfolio before change:  [9.22803219]
curr_Stock_Price:  97.29577343286249
curr_Factors:  [97.29577343]
mat_Sqrt:  [[0.15]]
grads:  [0.00019164]
Stock Position:  0.00019163956666601545
Bond Position:  [9.20938647]


portfolio before change:  [9.22911503]
curr_Stock_Price:  96.93884458200921
curr_Factors:  [96.93884458]
mat_Sqrt:  [[0.15]]
grads:  [0.16352345]
Stock Position:  0.16352344976030359
Bond Position:  [-6.62265925]


portfolio before change:  [9.27500292]
curr_Stock_Price:  97.2245269444177
curr_Factors:  [97.22452694]
mat_Sqrt:  [[0.15]]
grads:  [0.01947088]
Stock Position:  0.019470880298962264
Bond Position:  [7.38195579]


portfolio before change:  [9.29191073]
curr_Stock_Price:  98.04549713251674
curr_Factors:  [98.04549713]
mat_Sqrt:  [[0.15]]
grads:  [-0.03662841]
Stock Position:  -0.036628414244506705
Bond Position:  [12.88316181]


portfolio before change:  [9.30548115]
curr_Stock_Price:  97.71897663587895
curr_Factors:  [97.71897664]
mat_Sqrt:  [[0.15]]
grads:  [0.06047988]
Stock Position:  0.060479881327514425
Bond Position:  [3.39544904]


portfolio before change:  [9.28852965]
curr_Stock_Price:  97.4316751133159
curr_Factors:  [97.43167511]
mat_Sqrt:  [[0.15]]
grads:  [0.0011954]
Stock Position:  0.001195398894362788
Bond Position:  [9.17205993]


portfolio before change:  [9.28953689]
curr_Stock_Price:  97.31511308782876
curr_Factors:  [97.31511309]
mat_Sqrt:  [[0.15]]
grads:  [-0.19790024]
Stock Position:  -0.19790024356890581
Bond Position:  [28.54822147]


portfolio before change:  [9.08669106]
curr_Stock_Price:  98.35813648511758
curr_Factors:  [98.35813649]
mat_Sqrt:  [[0.15]]
grads:  [0.00415948]
Stock Position:  0.004159480627457877
Bond Position:  [8.67757229]


portfolio before change:  [9.09011405]
curr_Stock_Price:  98.92028033375702
curr_Factors:  [98.92028033]
mat_Sqrt:  [[0.15]]
grads:  [-0.00829981]
Stock Position:  -0.008299809335929425
Bond Position:  [9.91113351]


portfolio before change:  [9.09324592]
curr_Stock_Price:  98.69221407328173
curr_Factors:  [98.69221407]
mat_Sqrt:  [[0.15]]
grads:  [0.0708602]
Stock Position:  0.07086020138554325
Bond Position:  [2.09989576]


portfolio before change:  [9.08216095]
curr_Stock_Price:  98.53207510271064
curr_Factors:  [98.5320751]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167419]
Stock Position:  -0.011674185834395652
Bond Position:  [10.2324427]


portfolio before change:  [9.06801747]
curr_Stock_Price:  99.85316196493362
curr_Factors:  [99.85316196]
mat_Sqrt:  [[0.15]]
grads:  [-0.09157086]
Stock Position:  -0.09157086290433644
Bond Position:  [18.21165767]


portfolio before change:  [9.01196048]
curr_Stock_Price:  100.49019418231065
curr_Factors:  [100.49019418]
mat_Sqrt:  [[0.15]]
grads:  [0.03182831]
Stock Position:  0.03182831069112088
Bond Position:  [5.81352736]


portfolio before change:  [9.04827354]
curr_Stock_Price:  101.60826548108491
curr_Factors:  [101.60826548]
mat_Sqrt:  [[0.15]]
grads:  [0.01307094]
Stock Position:  0.013070935869390229
Bond Position:  [7.72015841]


portfolio before change:  [9.03319217]
curr_Stock_Price:  100.3806222573631
curr_Factors:  [100.38062226]
mat_Sqrt:  [[0.15]]
grads:  [-0.07735024]
Stock Position:  -0.07735023582858419
Bond Position:  [16.79765697]


portfolio before change:  [9.12086815]
curr_Stock_Price:  99.27427602288068
curr_Factors:  [99.27427602]
mat_Sqrt:  [[0.15]]
grads:  [-0.0155285]
Stock Position:  -0.015528502212991947
Bond Position:  [10.66244896]


portfolio before change:  [9.09090238]
curr_Stock_Price:  101.28983791143726
curr_Factors:  [101.28983791]
mat_Sqrt:  [[0.15]]
grads:  [0.00046862]
Stock Position:  0.00046861646492539987
Bond Position:  [9.0434363]


portfolio before change:  [9.0914831]
curr_Stock_Price:  100.11663698644283
curr_Factors:  [100.11663699]
mat_Sqrt:  [[0.15]]
grads:  [0.06764396]
Stock Position:  0.06764395509410037
Bond Position:  [2.3191978]


portfolio before change:  [9.13674073]
curr_Stock_Price:  100.78140757581846
curr_Factors:  [100.78140758]
mat_Sqrt:  [[0.15]]
grads:  [0.03185759]
Stock Position:  0.03185758689175765
Bond Position:  [5.92608828]


portfolio before change:  [9.13057703]
curr_Stock_Price:  100.56467706610898
curr_Factors:  [100.56467707]
mat_Sqrt:  [[0.15]]
grads:  [0.04582473]
Stock Position:  0.04582473001660296
Bond Position:  [4.52222785]


portfolio before change:  [9.15812275]
curr_Stock_Price:  101.15345110250655
curr_Factors:  [101.1534511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02450635]
Stock Position:  -0.024506353602660392
Bond Position:  [11.63702499]


portfolio before change:  [9.18321135]
curr_Stock_Price:  100.18905321307001
curr_Factors:  [100.18905321]
mat_Sqrt:  [[0.15]]
grads:  [-0.05764247]
Stock Position:  -0.057642466004715204
Bond Position:  [14.95835544]


portfolio before change:  [9.17828154]
curr_Stock_Price:  100.30701694892888
curr_Factors:  [100.30701695]
mat_Sqrt:  [[0.15]]
grads:  [0.08552]
Stock Position:  0.08552000162523204
Bond Position:  [0.60002529]


portfolio before change:  [9.20137312]
curr_Stock_Price:  100.57615371781797
curr_Factors:  [100.57615372]
mat_Sqrt:  [[0.15]]
grads:  [-0.1321402]
Stock Position:  -0.1321402047514942
Bond Position:  [22.49152667]


portfolio before change:  [9.04488728]
curr_Stock_Price:  101.78167223118196
curr_Factors:  [101.78167223]
mat_Sqrt:  [[0.15]]
grads:  [-0.07447125]
Stock Position:  -0.07447125247021963
Bond Position:  [16.62469589]


portfolio before change:  [9.00243103]
curr_Stock_Price:  102.37968104174043
curr_Factors:  [102.37968104]
mat_Sqrt:  [[0.15]]
grads:  [0.1548571]
Stock Position:  0.15485710331789937
Bond Position:  [-6.85178982]


portfolio before change:  [9.17964213]
curr_Stock_Price:  103.52956457834254
curr_Factors:  [103.52956458]
mat_Sqrt:  [[0.15]]
grads:  [-0.07822475]
Stock Position:  -0.07822474574103783
Bond Position:  [17.278216]


portfolio before change:  [9.17829947]
curr_Stock_Price:  103.57434038436341
curr_Factors:  [103.57434038]
mat_Sqrt:  [[0.15]]
grads:  [0.04182169]
Stock Position:  0.041821689567707404
Bond Position:  [4.84664556]


portfolio before change:  [9.19688475]
curr_Stock_Price:  104.00424670200675
curr_Factors:  [104.0042467]
mat_Sqrt:  [[0.15]]
grads:  [-0.08659264]
Stock Position:  -0.08659263602437185
Bond Position:  [18.20288663]


portfolio before change:  [9.09805292]
curr_Stock_Price:  105.17186715981155
curr_Factors:  [105.17186716]
mat_Sqrt:  [[0.15]]
grads:  [0.01526537]
Stock Position:  0.01526536639990049
Bond Position:  [7.49256583]


portfolio before change:  [9.11291302]
curr_Stock_Price:  106.08396301015529
curr_Factors:  [106.08396301]
mat_Sqrt:  [[0.15]]
grads:  [-0.0445458]
Stock Position:  -0.044545796449342104
Bond Position:  [13.83850765]


portfolio before change:  [9.18135608]
curr_Stock_Price:  104.58633263893135
curr_Factors:  [104.58633264]
mat_Sqrt:  [[0.15]]
grads:  [0.00402672]
Stock Position:  0.004026719778770348
Bond Position:  [8.76021623]


portfolio before change:  [9.18210952]
curr_Stock_Price:  104.50148439946572
curr_Factors:  [104.5014844]
mat_Sqrt:  [[0.15]]
grads:  [0.16071523]
Stock Position:  0.16071523040639393
Bond Position:  [-7.61287063]


portfolio before change:  [9.21250422]
curr_Stock_Price:  104.69652734575517
curr_Factors:  [104.69652735]
mat_Sqrt:  [[0.15]]
grads:  [0.0105485]
Stock Position:  0.010548502746182676
Bond Position:  [8.10811262]


portfolio before change:  [9.20562403]
curr_Stock_Price:  103.94819645033164
curr_Factors:  [103.94819645]
mat_Sqrt:  [[0.15]]
grads:  [0.1386595]
Stock Position:  0.13865950211107436
Bond Position:  [-5.20778114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.20562403]
Stock Price:  104.24693187629096
PL:  [4.95869215]
Settle:  Tensor("sub_146:0", shape=(), dtype=float64)
PL:  Tensor("sub_147:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  74
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.28734709e-03]
 [-2.77008331e-03]
 [ 1.47766737e-02]
 [-1.75347581e-02]
 [ 5.54923036e-03]
 [ 1.85519495e-02]
 [ 2.11287929e-02]
 [-3.04824148e-03]
 [ 1.71109514e-02]
 [-4.08216329e-03]
 [ 9.88929282e-03]
 [ 1.18372519e-02]
 [-2.64156783e-03]
 [ 1.05687484e-02]
 [ 1.61955145e-03]
 [-1.18583373e-02]
 [-7.43120850e-03]
 [ 8.23949523e-05]
 [-7.54428750e-03]
 [-2.50634066e-03]
 [ 4.98719674e-04]
 [ 1.32346701e-02]
 [ 4.76021765e-03]
 [ 5.40465292e-03]
 [-4.19427966e-04]
 [-3.43762939e-03]
 [-4.16330997e-03]
 [-1.83494473e-02]
 [-3.04069304e-02]
 [ 2.19004942e-02]
 [ 5.30402678e-03]
 [-3.09883271e-03]
 [-1.25197900e-02]
 [-8.72908964e-03]
 [-6.38451367e-03]
 [-3.26616715e-03]
 [ 1.86595346e-02]
 [ 9.00229556e-03]
 [ 2.18101391e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.16081938]
curr_Stock_Price:  99.15602149042296
curr_Factors:  [99.15602149]
mat_Sqrt:  [[0.15]]
grads:  [-0.03524898]
Stock Position:  -0.035248980582332674
Bond Position:  [-7.66567071]


portfolio before change:  [-11.15236402]
curr_Stock_Price:  98.88896029497792
curr_Factors:  [98.88896029]
mat_Sqrt:  [[0.15]]
grads:  [-0.01846722]
Stock Position:  -0.01846722206273686
Bond Position:  [-9.32615963]


portfolio before change:  [-11.1705191]
curr_Stock_Price:  99.80892754711074
curr_Factors:  [99.80892755]
mat_Sqrt:  [[0.15]]
grads:  [0.09851116]
Stock Position:  0.09851115795406533
Bond Position:  [-21.00281213]


portfolio before change:  [-11.27206202]
curr_Stock_Price:  98.80480368389928
curr_Factors:  [98.80480368]
mat_Sqrt:  [[0.15]]
grads:  [-0.11689839]
Stock Position:  -0.11689838709493054
Bond Position:  [0.27806017]


portfolio before change:  [-11.39600997]
curr_Stock_Price:  99.86540608882832
curr_Factors:  [99.86540609]
mat_Sqrt:  [[0.15]]
grads:  [0.03699487]
Stock Position:  0.03699486908536043
Bond Position:  [-15.0905176]


portfolio before change:  [-11.42131727]
curr_Stock_Price:  99.23232185807973
curr_Factors:  [99.23232186]
mat_Sqrt:  [[0.15]]
grads:  [0.12367966]
Stock Position:  0.12367966365933838
Bond Position:  [-23.69433746]


portfolio before change:  [-11.41401572]
curr_Stock_Price:  99.31530665159946
curr_Factors:  [99.31530665]
mat_Sqrt:  [[0.15]]
grads:  [0.14085862]
Stock Position:  0.14085861961813825
Bond Position:  [-25.40343272]


portfolio before change:  [-11.40873057]
curr_Stock_Price:  99.37537235602426
curr_Factors:  [99.37537236]
mat_Sqrt:  [[0.15]]
grads:  [-0.02032161]
Stock Position:  -0.02032160988697296
Bond Position:  [-9.38926302]


portfolio before change:  [-11.40159505]
curr_Stock_Price:  98.9664847823281
curr_Factors:  [98.96648478]
mat_Sqrt:  [[0.15]]
grads:  [0.11407301]
Stock Position:  0.11407300962720482
Bond Position:  [-22.69099982]


portfolio before change:  [-11.36101555]
curr_Stock_Price:  99.34708360965666
curr_Factors:  [99.34708361]
mat_Sqrt:  [[0.15]]
grads:  [-0.02721442]
Stock Position:  -0.027214421921373494
Bond Position:  [-8.6573421]


portfolio before change:  [-11.38828499]
curr_Stock_Price:  100.30933820407061
curr_Factors:  [100.3093382]
mat_Sqrt:  [[0.15]]
grads:  [0.06592862]
Stock Position:  0.06592861878457718
Bond Position:  [-18.00154111]


portfolio before change:  [-11.41137845]
curr_Stock_Price:  99.99319134173034
curr_Factors:  [99.99319134]
mat_Sqrt:  [[0.15]]
grads:  [0.07891501]
Stock Position:  0.07891501256467813
Bond Position:  [-19.3023424]


portfolio before change:  [-11.48980945]
curr_Stock_Price:  99.02990114255516
curr_Factors:  [99.02990114]
mat_Sqrt:  [[0.15]]
grads:  [-0.01761045]
Stock Position:  -0.01761045218014785
Bond Position:  [-9.74584811]


portfolio before change:  [-11.4868654]
curr_Stock_Price:  98.79354414350313
curr_Factors:  [98.79354414]
mat_Sqrt:  [[0.15]]
grads:  [0.07045832]
Stock Position:  0.07045832277103516
Bond Position:  [-18.44769282]


portfolio before change:  [-11.5448865]
curr_Stock_Price:  98.00279315938889
curr_Factors:  [98.00279316]
mat_Sqrt:  [[0.15]]
grads:  [0.01079701]
Stock Position:  0.01079700969459223
Bond Position:  [-12.6030236]


portfolio before change:  [-11.55620538]
curr_Stock_Price:  97.10037622917666
curr_Factors:  [97.10037623]
mat_Sqrt:  [[0.15]]
grads:  [-0.07905558]
Stock Position:  -0.0790555819939367
Bond Position:  [-3.87987862]


portfolio before change:  [-11.55435416]
curr_Stock_Price:  97.07082451024017
curr_Factors:  [97.07082451]
mat_Sqrt:  [[0.15]]
grads:  [-0.04954139]
Stock Position:  -0.049541389974583135
Bond Position:  [-6.74533059]


portfolio before change:  [-11.52295978]
curr_Stock_Price:  96.42010395273276
curr_Factors:  [96.42010395]
mat_Sqrt:  [[0.15]]
grads:  [0.0005493]
Stock Position:  0.0005492996821810957
Bond Position:  [-11.57592331]


portfolio before change:  [-11.52361654]
curr_Stock_Price:  97.85888921654946
curr_Factors:  [97.85888922]
mat_Sqrt:  [[0.15]]
grads:  [-0.05029525]
Stock Position:  -0.05029524998526551
Bond Position:  [-6.60177924]


portfolio before change:  [-11.48454854]
curr_Stock_Price:  97.06570750033639
curr_Factors:  [97.0657075]
mat_Sqrt:  [[0.15]]
grads:  [-0.01670894]
Stock Position:  -0.01670893770687471
Bond Position:  [-9.86268368]


portfolio before change:  [-11.49031819]
curr_Stock_Price:  97.33722317191057
curr_Factors:  [97.33722317]
mat_Sqrt:  [[0.15]]
grads:  [0.0033248]
Stock Position:  0.0033247978251166755
Bond Position:  [-11.81394478]


portfolio before change:  [-11.49417955]
curr_Stock_Price:  96.62003012865303
curr_Factors:  [96.62003013]
mat_Sqrt:  [[0.15]]
grads:  [0.08823113]
Stock Position:  0.08823113384616872
Bond Position:  [-20.01907436]


portfolio before change:  [-11.40822695]
curr_Stock_Price:  97.62256899794659
curr_Factors:  [97.622569]
mat_Sqrt:  [[0.15]]
grads:  [0.03173478]
Stock Position:  0.0317347843452919
Bond Position:  [-14.50625812]


portfolio before change:  [-11.42758571]
curr_Stock_Price:  97.06969392489849
curr_Factors:  [97.06969392]
mat_Sqrt:  [[0.15]]
grads:  [0.03603102]
Stock Position:  0.03603101947158059
Bond Position:  [-14.92510575]


portfolio before change:  [-11.44328752]
curr_Stock_Price:  96.68569009233148
curr_Factors:  [96.68569009]
mat_Sqrt:  [[0.15]]
grads:  [-0.00279619]
Stock Position:  -0.002796186442936627
Bond Position:  [-11.1729363]


portfolio before change:  [-11.44351403]
curr_Stock_Price:  96.2671939636851
curr_Factors:  [96.26719396]
mat_Sqrt:  [[0.15]]
grads:  [-0.02291753]
Stock Position:  -0.022917529279132366
Bond Position:  [-9.23730779]


portfolio before change:  [-11.45490212]
curr_Stock_Price:  96.71372366494829
curr_Factors:  [96.71372366]
mat_Sqrt:  [[0.15]]
grads:  [-0.0277554]
Stock Position:  -0.02775539978212983
Bond Position:  [-8.77057406]


portfolio before change:  [-11.43850248]
curr_Stock_Price:  96.08335880441831
curr_Factors:  [96.0833588]
mat_Sqrt:  [[0.15]]
grads:  [-0.12232965]
Stock Position:  -0.1223296489277717
Bond Position:  [0.31534107]


portfolio before change:  [-11.59188758]
curr_Stock_Price:  97.33754793555269
curr_Factors:  [97.33754794]
mat_Sqrt:  [[0.15]]
grads:  [-0.20271287]
Stock Position:  -0.20271286951839715
Bond Position:  [8.13968607]


portfolio before change:  [-11.49694598]
curr_Stock_Price:  96.87421242235614
curr_Factors:  [96.87421242]
mat_Sqrt:  [[0.15]]
grads:  [0.14600329]
Stock Position:  0.14600329458939942
Bond Position:  [-25.64090016]


portfolio before change:  [-11.25557659]
curr_Stock_Price:  98.54934386709728
curr_Factors:  [98.54934387]
mat_Sqrt:  [[0.15]]
grads:  [0.03536018]
Stock Position:  0.03536017853755921
Bond Position:  [-14.74029898]


portfolio before change:  [-11.27336877]
curr_Stock_Price:  98.09828481320612
curr_Factors:  [98.09828481]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065888]
Stock Position:  -0.020658884701370294
Bond Position:  [-9.24676761]


portfolio before change:  [-11.2473712]
curr_Stock_Price:  96.78391175985597
curr_Factors:  [96.78391176]
mat_Sqrt:  [[0.15]]
grads:  [-0.08346527]
Stock Position:  -0.08346526662622762
Bond Position:  [-3.1692762]


portfolio before change:  [-11.14919308]
curr_Stock_Price:  95.60288985910317
curr_Factors:  [95.60288986]
mat_Sqrt:  [[0.15]]
grads:  [-0.05819393]
Stock Position:  -0.05819393096370041
Bond Position:  [-5.58568511]


portfolio before change:  [-11.09051201]
curr_Stock_Price:  94.5825201432887
curr_Factors:  [94.58252014]
mat_Sqrt:  [[0.15]]
grads:  [-0.04256342]
Stock Position:  -0.0425634244565732
Bond Position:  [-7.06475606]


portfolio before change:  [-11.08135357]
curr_Stock_Price:  94.34659941328356
curr_Factors:  [94.34659941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02177445]
Stock Position:  -0.021774447641705007
Bond Position:  [-9.02700848]


portfolio before change:  [-11.09000874]
curr_Stock_Price:  94.6922672961605
curr_Factors:  [94.6922673]
mat_Sqrt:  [[0.15]]
grads:  [0.1243969]
Stock Position:  0.12439689750184109
Bond Position:  [-22.86943301]


portfolio before change:  [-10.84495913]
curr_Stock_Price:  96.68515036153092
curr_Factors:  [96.68515036]
mat_Sqrt:  [[0.15]]
grads:  [0.0600153]
Stock Position:  0.060015303754001464
Bond Position:  [-16.6475478]


portfolio before change:  [-10.83599529]
curr_Stock_Price:  96.86918526432738
curr_Factors:  [96.86918526]
mat_Sqrt:  [[0.15]]
grads:  [0.14540093]
Stock Position:  0.14540092729715837
Bond Position:  [-24.92086465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-10.83599529]
Stock Price:  97.81471797179837
PL:  [-10.83599529]
Settle:  Tensor("sub_148:0", shape=(), dtype=float64)
PL:  Tensor("sub_149:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  75
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-6.02029160e-03]
 [-3.48042300e-03]
 [ 2.00623725e-02]
 [ 9.73719823e-04]
 [ 1.37982097e-02]
 [ 2.27561619e-02]
 [ 1.86780207e-02]
 [-5.24933814e-03]
 [ 9.28225711e-03]
 [-1.37842511e-04]
 [ 1.31589701e-02]
 [-1.11709623e-03]
 [ 1.60261555e-03]
 [ 1.08007627e-02]
 [ 3.54223315e-04]
 [-1.18245722e-02]
 [ 4.76679532e-03]
 [-2.68694975e-03]
 [-1.14553831e-02]
 [-2.23634104e-03]
 [ 5.96322775e-06]
 [ 6.85942523e-04]
 [ 4.77951042e-03]
 [ 6.83928883e-03]
 [-3.96426011e-03]
 [-8.12064867e-03]
 [ 1.36917209e-02]
 [-1.99362402e-02]
 [-1.58250348e-02]
 [ 2.15817320e-02]
 [ 3.39369246e-03]
 [ 6.38206809e-03]
 [-1.29780008e-02]
 [ 3.13572486e-04]
 [-5.56518786e-03]
 [-2.79153675e-03]
 [ 2.33167361e-02]
 [ 1.84757067e-03]
 [ 2.17559377e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-19.45739816]
curr_Stock_Price:  98.62153870715599
curr_Factors:  [98.62153871]
mat_Sqrt:  [[0.15]]
grads:  [-0.04013528]
Stock Position:  -0.04013527732139026
Bond Position:  [-15.49919535]


portfolio before change:  [-19.46650471]
curr_Stock_Price:  98.80016046226623
curr_Factors:  [98.80016046]
mat_Sqrt:  [[0.15]]
grads:  [-0.02320282]
Stock Position:  -0.023202820021430804
Bond Position:  [-17.17406237]


portfolio before change:  [-19.50541521]
curr_Stock_Price:  100.38460613684481
curr_Factors:  [100.38460614]
mat_Sqrt:  [[0.15]]
grads:  [0.13374915]
Stock Position:  0.1337491500033382
Bond Position:  [-32.93177095]


portfolio before change:  [-19.49262193]
curr_Stock_Price:  100.51103692293138
curr_Factors:  [100.51103692]
mat_Sqrt:  [[0.15]]
grads:  [0.00649147]
Stock Position:  0.006491465489598484
Bond Position:  [-20.14508586]


portfolio before change:  [-19.51013211]
curr_Stock_Price:  98.20156046235523
curr_Factors:  [98.20156046]
mat_Sqrt:  [[0.15]]
grads:  [0.09198806]
Stock Position:  0.09198806482825592
Bond Position:  [-28.54350362]


portfolio before change:  [-19.50088812]
curr_Stock_Price:  98.34084107813922
curr_Factors:  [98.34084108]
mat_Sqrt:  [[0.15]]
grads:  [0.15170775]
Stock Position:  0.15170774579856097
Bond Position:  [-34.41995544]


portfolio before change:  [-19.4086342]
curr_Stock_Price:  98.97730614141643
curr_Factors:  [98.97730614]
mat_Sqrt:  [[0.15]]
grads:  [0.12452014]
Stock Position:  0.12452013767683202
Bond Position:  [-31.73330199]


portfolio before change:  [-19.52136349]
curr_Stock_Price:  98.10385402287162
curr_Factors:  [98.10385402]
mat_Sqrt:  [[0.15]]
grads:  [-0.03499559]
Stock Position:  -0.034995587607746216
Bond Position:  [-16.08816147]


portfolio before change:  [-19.51100163]
curr_Stock_Price:  97.75029506678938
curr_Factors:  [97.75029507]
mat_Sqrt:  [[0.15]]
grads:  [0.06188171]
Stock Position:  0.06188171405092679
Bond Position:  [-25.55995744]


portfolio before change:  [-19.50050173]
curr_Stock_Price:  97.97160595866272
curr_Factors:  [97.97160596]
mat_Sqrt:  [[0.15]]
grads:  [-0.00091895]
Stock Position:  -0.0009189500739833293
Bond Position:  [-19.41047071]


portfolio before change:  [-19.50345582]
curr_Stock_Price:  98.5457722753186
curr_Factors:  [98.54577228]
mat_Sqrt:  [[0.15]]
grads:  [0.08772647]
Stock Position:  0.08772646762692647
Bond Position:  [-28.14852832]


portfolio before change:  [-19.54519777]
curr_Stock_Price:  98.11006373696198
curr_Factors:  [98.11006374]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744731]
Stock Position:  -0.007447308201496648
Bond Position:  [-18.81454189]


portfolio before change:  [-19.55188038]
curr_Stock_Price:  98.69156841008106
curr_Factors:  [98.69156841]
mat_Sqrt:  [[0.15]]
grads:  [0.0106841]
Stock Position:  0.010684103675073166
Bond Position:  [-20.60631133]


portfolio before change:  [-19.55753364]
curr_Stock_Price:  98.4035420010556
curr_Factors:  [98.403542]
mat_Sqrt:  [[0.15]]
grads:  [0.07200508]
Stock Position:  0.07200508495445808
Bond Position:  [-26.64308904]


portfolio before change:  [-19.57445499]
curr_Stock_Price:  98.21479484547483
curr_Factors:  [98.21479485]
mat_Sqrt:  [[0.15]]
grads:  [0.00236149]
Stock Position:  0.0023614887656937754
Bond Position:  [-19.80638812]


portfolio before change:  [-19.57361361]
curr_Stock_Price:  99.61955866036924
curr_Factors:  [99.61955866]
mat_Sqrt:  [[0.15]]
grads:  [-0.07883048]
Stock Position:  -0.07883048129844954
Bond Position:  [-11.72055585]


portfolio before change:  [-19.63927141]
curr_Stock_Price:  100.43387109359374
curr_Factors:  [100.43387109]
mat_Sqrt:  [[0.15]]
grads:  [0.03177864]
Stock Position:  0.03177863545560378
Bond Position:  [-22.83092279]


portfolio before change:  [-19.63725466]
curr_Stock_Price:  100.58714348925561
curr_Factors:  [100.58714349]
mat_Sqrt:  [[0.15]]
grads:  [-0.017913]
Stock Position:  -0.017912998333670705
Bond Position:  [-17.83543733]


portfolio before change:  [-19.63287921]
curr_Stock_Price:  100.2184157275648
curr_Factors:  [100.21841573]
mat_Sqrt:  [[0.15]]
grads:  [-0.07636922]
Stock Position:  -0.07636922062001733
Bond Position:  [-11.97927691]


portfolio before change:  [-19.70474132]
curr_Stock_Price:  101.13978952705513
curr_Factors:  [101.13978953]
mat_Sqrt:  [[0.15]]
grads:  [-0.01490894]
Stock Position:  -0.014908940294799302
Bond Position:  [-18.19685423]


portfolio before change:  [-19.71093652]
curr_Stock_Price:  101.40274938763058
curr_Factors:  [101.40274939]
mat_Sqrt:  [[0.15]]
grads:  [3.97548516e-05]
Stock Position:  3.975485164460556e-05
Bond Position:  [-19.71496777]


portfolio before change:  [-19.71341291]
curr_Stock_Price:  101.104336323054
curr_Factors:  [101.10433632]
mat_Sqrt:  [[0.15]]
grads:  [0.00457295]
Stock Position:  0.004572950154430345
Bond Position:  [-20.175758]


portfolio before change:  [-19.71676323]
curr_Stock_Price:  100.9232286149967
curr_Factors:  [100.92322861]
mat_Sqrt:  [[0.15]]
grads:  [0.0318634]
Stock Position:  0.031863402795509636
Bond Position:  [-22.93252072]


portfolio before change:  [-19.73305145]
curr_Stock_Price:  100.50200936572358
curr_Factors:  [100.50200937]
mat_Sqrt:  [[0.15]]
grads:  [0.04559526]
Stock Position:  0.04559525885856183
Bond Position:  [-24.31546659]


portfolio before change:  [-19.76591564]
curr_Stock_Price:  99.84789399279973
curr_Factors:  [99.84789399]
mat_Sqrt:  [[0.15]]
grads:  [-0.0264284]
Stock Position:  -0.02642840074630779
Bond Position:  [-17.12709548]


portfolio before change:  [-19.76734064]
curr_Stock_Price:  99.82080111633246
curr_Factors:  [99.82080112]
mat_Sqrt:  [[0.15]]
grads:  [-0.05413766]
Stock Position:  -0.05413765781017821
Bond Position:  [-14.36327626]


portfolio before change:  [-19.78507726]
curr_Stock_Price:  100.1152561709147
curr_Factors:  [100.11525617]
mat_Sqrt:  [[0.15]]
grads:  [0.09127814]
Stock Position:  0.09127813931718183
Bond Position:  [-28.92341156]


portfolio before change:  [-19.75936613]
curr_Stock_Price:  100.43654651173011
curr_Factors:  [100.43654651]
mat_Sqrt:  [[0.15]]
grads:  [-0.13290827]
Stock Position:  -0.1329082677291528
Bond Position:  [-6.41051872]


portfolio before change:  [-19.78110335]
curr_Stock_Price:  100.5940675507247
curr_Factors:  [100.59406755]
mat_Sqrt:  [[0.15]]
grads:  [-0.10550023]
Stock Position:  -0.10550023231936152
Bond Position:  [-9.16840585]


portfolio before change:  [-19.74592744]
curr_Stock_Price:  100.2497836937271
curr_Factors:  [100.24978369]
mat_Sqrt:  [[0.15]]
grads:  [0.14387821]
Stock Position:  0.14387821345601542
Bond Position:  [-34.16968722]


portfolio before change:  [-19.55364054]
curr_Stock_Price:  101.61592784461105
curr_Factors:  [101.61592784]
mat_Sqrt:  [[0.15]]
grads:  [0.02262462]
Stock Position:  0.02262461637308764
Bond Position:  [-21.85266192]


portfolio before change:  [-19.54091835]
curr_Stock_Price:  102.29898642008193
curr_Factors:  [102.29898642]
mat_Sqrt:  [[0.15]]
grads:  [0.04254712]
Stock Position:  0.04254712060332033
Bond Position:  [-23.89344567]


portfolio before change:  [-19.47764329]
curr_Stock_Price:  103.85636403723312
curr_Factors:  [103.85636404]
mat_Sqrt:  [[0.15]]
grads:  [-0.08652001]
Stock Position:  -0.08652000535168526
Bond Position:  [-10.49199012]


portfolio before change:  [-19.4814736]
curr_Stock_Price:  103.88547552244943
curr_Factors:  [103.88547552]
mat_Sqrt:  [[0.15]]
grads:  [0.00209048]
Stock Position:  0.002090483241240764
Bond Position:  [-19.69864444]


portfolio before change:  [-19.48613954]
curr_Stock_Price:  102.83143202070603
curr_Factors:  [102.83143202]
mat_Sqrt:  [[0.15]]
grads:  [-0.03710125]
Stock Position:  -0.03710125239225756
Bond Position:  [-15.67096463]


portfolio before change:  [-19.4901143]
curr_Stock_Price:  102.8857634484014
curr_Factors:  [102.88576345]
mat_Sqrt:  [[0.15]]
grads:  [-0.01861024]
Stock Position:  -0.01861024498333131
Bond Position:  [-17.57538503]


portfolio before change:  [-19.48640694]
curr_Stock_Price:  102.56849614545483
curr_Factors:  [102.56849615]
mat_Sqrt:  [[0.15]]
grads:  [0.15544491]
Stock Position:  0.15544490718220697
Bond Position:  [-35.4301573]


portfolio before change:  [-19.58111572]
curr_Stock_Price:  101.98771331113775
curr_Factors:  [101.98771331]
mat_Sqrt:  [[0.15]]
grads:  [0.01231714]
Stock Position:  0.012317137788315302
Bond Position:  [-20.83731243]


portfolio before change:  [-19.57478681]
curr_Stock_Price:  102.7130223426755
curr_Factors:  [102.71302234]
mat_Sqrt:  [[0.15]]
grads:  [0.14503958]
Stock Position:  0.14503958455955815
Bond Position:  [-34.4722409]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.57478681]
Stock Price:  101.34943285176497
PL:  [-20.92421966]
Settle:  Tensor("sub_150:0", shape=(), dtype=float64)
PL:  Tensor("sub_151:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  76
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.01323038e-03]
 [ 1.02186841e-05]
 [ 1.07349769e-03]
 [ 3.20226009e-02]
 [ 1.84219880e-02]
 [ 2.66949636e-02]
 [ 6.73061447e-03]
 [-1.83025340e-03]
 [ 8.41984322e-03]
 [ 2.33300444e-03]
 [ 5.05652461e-03]
 [ 1.19439840e-02]
 [-9.96887617e-03]
 [ 1.02155213e-02]
 [-3.91746612e-03]
 [-9.27290569e-03]
 [-3.20266021e-03]
 [-1.20565805e-03]
 [-7.61517146e-03]
 [-2.50398783e-03]
 [ 6.17846923e-04]
 [ 1.39290372e-02]
 [ 4.75747805e-03]
 [ 5.47629326e-03]
 [ 5.00863611e-03]
 [-1.05225239e-03]
 [ 3.03091078e-03]
 [-1.82330690e-02]
 [-2.84923726e-02]
 [ 2.16918381e-02]
 [ 2.62697603e-03]
 [-8.86243779e-03]
 [-1.23056639e-02]
 [-6.98141866e-03]
 [-6.42072401e-03]
 [-3.08729974e-03]
 [ 1.87195606e-02]
 [ 1.14630047e-02]
 [ 1.83445827e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.26032115]
curr_Stock_Price:  99.60056587437587
curr_Factors:  [99.60056587]
mat_Sqrt:  [[0.15]]
grads:  [-0.0200882]
Stock Position:  -0.020088202501029905
Bond Position:  [-2.25952482]


portfolio before change:  [-4.30650878]
curr_Stock_Price:  101.88574655841744
curr_Factors:  [101.88574656]
mat_Sqrt:  [[0.15]]
grads:  [6.81245606e-05]
Stock Position:  6.812456063507699e-05
Bond Position:  [-4.31344971]


portfolio before change:  [-4.30696545]
curr_Stock_Price:  103.09747784249554
curr_Factors:  [103.09747784]
mat_Sqrt:  [[0.15]]
grads:  [0.00715665]
Stock Position:  0.007156651288073429
Bond Position:  [-5.04479815]


portfolio before change:  [-4.3192903]
curr_Stock_Price:  101.46344440209143
curr_Factors:  [101.4634444]
mat_Sqrt:  [[0.15]]
grads:  [0.21348401]
Stock Position:  0.213484006089625
Bond Position:  [-25.98011288]


portfolio before change:  [-4.43638884]
curr_Stock_Price:  100.93014531171048
curr_Factors:  [100.93014531]
mat_Sqrt:  [[0.15]]
grads:  [0.12281325]
Stock Position:  0.12281325356725509
Bond Position:  [-16.83194837]


portfolio before change:  [-4.42685961]
curr_Stock_Price:  101.02486923962388
curr_Factors:  [101.02486924]
mat_Sqrt:  [[0.15]]
grads:  [0.17796642]
Stock Position:  0.17796642399357643
Bond Position:  [-22.40589433]


portfolio before change:  [-4.15627171]
curr_Stock_Price:  102.56105124740881
curr_Factors:  [102.56105125]
mat_Sqrt:  [[0.15]]
grads:  [0.04487076]
Stock Position:  0.04487076312071483
Bond Position:  [-8.75826434]


portfolio before change:  [-4.22394486]
curr_Stock_Price:  101.07727203250572
curr_Factors:  [101.07727203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01220169]
Stock Position:  -0.012201689334158838
Bond Position:  [-2.99063139]


portfolio before change:  [-4.21268179]
curr_Stock_Price:  100.12355782638363
curr_Factors:  [100.12355783]
mat_Sqrt:  [[0.15]]
grads:  [0.05613229]
Stock Position:  0.056132288148283235
Bond Position:  [-9.83284619]


portfolio before change:  [-4.20232476]
curr_Stock_Price:  100.32996689445297
curr_Factors:  [100.32996689]
mat_Sqrt:  [[0.15]]
grads:  [0.01555336]
Stock Position:  0.0155533629527829
Bond Position:  [-5.76279315]


portfolio before change:  [-4.20947227]
curr_Stock_Price:  99.91673700458267
curr_Factors:  [99.916737]
mat_Sqrt:  [[0.15]]
grads:  [0.03371016]
Stock Position:  0.03371016403629422
Bond Position:  [-7.57768186]


portfolio before change:  [-4.20514133]
curr_Stock_Price:  100.07331314662522
curr_Factors:  [100.07331315]
mat_Sqrt:  [[0.15]]
grads:  [0.07962656]
Stock Position:  0.07962655998738562
Bond Position:  [-12.173635]


portfolio before change:  [-4.18169286]
curr_Stock_Price:  100.38690535955637
curr_Factors:  [100.38690536]
mat_Sqrt:  [[0.15]]
grads:  [-0.06645917]
Stock Position:  -0.06645917447081331
Bond Position:  [2.489938]


portfolio before change:  [-4.09376994]
curr_Stock_Price:  99.06862743559125
curr_Factors:  [99.06862744]
mat_Sqrt:  [[0.15]]
grads:  [0.06810348]
Stock Position:  0.06810347503034118
Bond Position:  [-10.84068773]


portfolio before change:  [-4.08458988]
curr_Stock_Price:  99.22332178392358
curr_Factors:  [99.22332178]
mat_Sqrt:  [[0.15]]
grads:  [-0.02611644]
Stock Position:  -0.026116440812030742
Bond Position:  [-1.49322987]


portfolio before change:  [-4.07594345]
curr_Stock_Price:  98.88510176540616
curr_Factors:  [98.88510177]
mat_Sqrt:  [[0.15]]
grads:  [-0.06181937]
Stock Position:  -0.06181937125372232
Bond Position:  [2.03707137]


portfolio before change:  [-4.05525966]
curr_Stock_Price:  98.55463684039675
curr_Factors:  [98.55463684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135107]
Stock Position:  -0.02135106806443081
Bond Position:  [-1.9510129]


portfolio before change:  [-4.03999203]
curr_Stock_Price:  97.82813800956033
curr_Factors:  [97.82813801]
mat_Sqrt:  [[0.15]]
grads:  [-0.00803772]
Stock Position:  -0.008037720364424149
Bond Position:  [-3.25367681]


portfolio before change:  [-4.03301278]
curr_Stock_Price:  96.90922239502487
curr_Factors:  [96.9092224]
mat_Sqrt:  [[0.15]]
grads:  [-0.05076781]
Stock Position:  -0.050767809762181156
Bond Position:  [0.88685619]


portfolio before change:  [-4.04163917]
curr_Stock_Price:  97.0813246316916
curr_Factors:  [97.08132463]
mat_Sqrt:  [[0.15]]
grads:  [-0.01669325]
Stock Position:  -0.016693252227748725
Bond Position:  [-2.42103613]


portfolio before change:  [-4.03682991]
curr_Stock_Price:  96.77509885351868
curr_Factors:  [96.77509885]
mat_Sqrt:  [[0.15]]
grads:  [0.00411898]
Stock Position:  0.004118979484395192
Bond Position:  [-4.43544456]


portfolio before change:  [-4.04053232]
curr_Stock_Price:  96.010846809066
curr_Factors:  [96.01084681]
mat_Sqrt:  [[0.15]]
grads:  [0.09286025]
Stock Position:  0.09286024777899254
Bond Position:  [-12.95612334]


portfolio before change:  [-3.99695573]
curr_Stock_Price:  96.4975588321422
curr_Factors:  [96.49755883]
mat_Sqrt:  [[0.15]]
grads:  [0.03171652]
Stock Position:  0.03171652032819665
Bond Position:  [-7.05752252]


portfolio before change:  [-4.03178714]
curr_Stock_Price:  95.42716519933113
curr_Factors:  [95.4271652]
mat_Sqrt:  [[0.15]]
grads:  [0.03650862]
Stock Position:  0.03650862174782157
Bond Position:  [-7.51570142]


portfolio before change:  [-4.0815724]
curr_Stock_Price:  94.08924184058972
curr_Factors:  [94.08924184]
mat_Sqrt:  [[0.15]]
grads:  [0.03339091]
Stock Position:  0.033390907431689966
Bond Position:  [-7.22329756]


portfolio before change:  [-4.07561362]
curr_Stock_Price:  94.29473936060015
curr_Factors:  [94.29473936]
mat_Sqrt:  [[0.15]]
grads:  [-0.00701502]
Stock Position:  -0.007015015944710698
Bond Position:  [-3.41413452]


portfolio before change:  [-4.08399908]
curr_Stock_Price:  95.42925769941631
curr_Factors:  [95.4292577]
mat_Sqrt:  [[0.15]]
grads:  [0.02020607]
Stock Position:  0.020206071882106595
Bond Position:  [-6.01224952]


portfolio before change:  [-4.07348726]
curr_Stock_Price:  95.98668380470018
curr_Factors:  [95.9866838]
mat_Sqrt:  [[0.15]]
grads:  [-0.12155379]
Stock Position:  -0.12155379340637977
Bond Position:  [7.59405827]


portfolio before change:  [-4.07562139]
curr_Stock_Price:  96.01205070461445
curr_Factors:  [96.0120507]
mat_Sqrt:  [[0.15]]
grads:  [-0.18994915]
Stock Position:  -0.1899491508602417
Bond Position:  [14.16178611]


portfolio before change:  [-3.89298068]
curr_Stock_Price:  95.05984652338914
curr_Factors:  [95.05984652]
mat_Sqrt:  [[0.15]]
grads:  [0.14461225]
Stock Position:  0.14461225367559347
Bond Position:  [-17.63979932]


portfolio before change:  [-3.92048328]
curr_Stock_Price:  94.88491332239428
curr_Factors:  [94.88491332]
mat_Sqrt:  [[0.15]]
grads:  [0.01751317]
Stock Position:  0.01751317356086265
Bond Position:  [-5.58221923]


portfolio before change:  [-3.91743333]
curr_Stock_Price:  95.09891045157242
curr_Factors:  [95.09891045]
mat_Sqrt:  [[0.15]]
grads:  [-0.05908292]
Stock Position:  -0.05908291863207147
Bond Position:  [1.70128786]


portfolio before change:  [-3.86549855]
curr_Stock_Price:  94.22349498516188
curr_Factors:  [94.22349499]
mat_Sqrt:  [[0.15]]
grads:  [-0.08203776]
Stock Position:  -0.08203775945300598
Bond Position:  [3.86438586]


portfolio before change:  [-3.89432702]
curr_Stock_Price:  94.58078833681891
curr_Factors:  [94.58078834]
mat_Sqrt:  [[0.15]]
grads:  [-0.04654279]
Stock Position:  -0.04654279109676206
Bond Position:  [0.50772685]


portfolio before change:  [-3.9226536]
curr_Stock_Price:  95.1907656490573
curr_Factors:  [95.19076565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04280483]
Stock Position:  -0.04280482673599482
Bond Position:  [0.15197063]


portfolio before change:  [-3.87997333]
curr_Stock_Price:  94.19411948936134
curr_Factors:  [94.19411949]
mat_Sqrt:  [[0.15]]
grads:  [-0.020582]
Stock Position:  -0.02058199829112966
Bond Position:  [-1.94127013]


portfolio before change:  [-3.89301243]
curr_Stock_Price:  94.81584843647215
curr_Factors:  [94.81584844]
mat_Sqrt:  [[0.15]]
grads:  [0.12479707]
Stock Position:  0.12479707064484825
Bond Position:  [-15.72575257]


portfolio before change:  [-3.98675871]
curr_Stock_Price:  94.08041103763414
curr_Factors:  [94.08041104]
mat_Sqrt:  [[0.15]]
grads:  [0.07642003]
Stock Position:  0.07642003141442892
Bond Position:  [-11.17638667]


portfolio before change:  [-3.97352956]
curr_Stock_Price:  94.27180434339817
curr_Factors:  [94.27180434]
mat_Sqrt:  [[0.15]]
grads:  [0.12229722]
Stock Position:  0.12229721771904539
Bond Position:  [-15.50270894]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.97352956]
Stock Price:  93.46882584980298
PL:  [-3.97352956]
Settle:  Tensor("sub_152:0", shape=(), dtype=float64)
PL:  Tensor("sub_153:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  77
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51692095e-03]
 [-6.76046647e-03]
 [-6.63487012e-03]
 [ 1.94134648e-02]
 [ 1.18144426e-02]
 [ 1.68493277e-02]
 [ 2.72870900e-02]
 [-2.98349881e-03]
 [ 1.38105683e-02]
 [ 7.69404547e-03]
 [ 2.71608216e-02]
 [ 1.01326734e-02]
 [-1.10297031e-02]
 [ 1.16972090e-02]
 [-6.48931102e-03]
 [-2.60692243e-02]
 [ 4.51376368e-03]
 [-7.39656505e-04]
 [ 2.64726332e-03]
 [-3.61831143e-03]
 [-1.43106593e-03]
 [-3.96482121e-02]
 [ 4.79839129e-03]
 [ 8.53758550e-03]
 [-5.38690580e-03]
 [-6.10673950e-03]
 [ 5.88120148e-03]
 [-1.39084600e-02]
 [ 8.78713309e-04]
 [ 2.35131615e-02]
 [ 1.67985555e-03]
 [ 6.45132826e-03]
 [-1.28069493e-02]
 [-5.99168107e-03]
 [-7.28936605e-03]
 [-7.50763634e-03]
 [ 2.19774021e-02]
 [ 8.35527710e-03]
 [ 2.31133050e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.97964052]
curr_Stock_Price:  100.32466747868554
curr_Factors:  [100.32466748]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011281]
Stock Position:  -0.01011280634578479
Bond Position:  [7.99420445]


portfolio before change:  [6.97486427]
curr_Stock_Price:  100.89578356636679
curr_Factors:  [100.89578357]
mat_Sqrt:  [[0.15]]
grads:  [-0.04506978]
Stock Position:  -0.04506977648165669
Bond Position:  [11.52221469]


portfolio before change:  [6.96552586]
curr_Stock_Price:  101.13494121932229
curr_Factors:  [101.13494122]
mat_Sqrt:  [[0.15]]
grads:  [-0.04423247]
Stock Position:  -0.044232467445133844
Bond Position:  [11.43897385]


portfolio before change:  [6.96942734]
curr_Stock_Price:  101.07906553985383
curr_Factors:  [101.07906554]
mat_Sqrt:  [[0.15]]
grads:  [0.1294231]
Stock Position:  0.12942309895736331
Bond Position:  [-6.11253856]


portfolio before change:  [6.89832717]
curr_Stock_Price:  100.53560727722433
curr_Factors:  [100.53560728]
mat_Sqrt:  [[0.15]]
grads:  [0.07876295]
Stock Position:  0.07876295085937485
Bond Position:  [-1.02015393]


portfolio before change:  [6.87826654]
curr_Stock_Price:  100.28253016956597
curr_Factors:  [100.28253017]
mat_Sqrt:  [[0.15]]
grads:  [0.11232885]
Stock Position:  0.11232885137057141
Bond Position:  [-4.38635488]


portfolio before change:  [6.84000815]
curr_Stock_Price:  99.94681889918824
curr_Factors:  [99.9468189]
mat_Sqrt:  [[0.15]]
grads:  [0.18191393]
Stock Position:  0.18191393309593595
Bond Position:  [-11.34171077]


portfolio before change:  [6.75823947]
curr_Stock_Price:  99.50512168491704
curr_Factors:  [99.50512168]
mat_Sqrt:  [[0.15]]
grads:  [-0.01988999]
Stock Position:  -0.01988999207475507
Bond Position:  [8.73739555]


portfolio before change:  [6.75462128]
curr_Stock_Price:  99.74194584051666
curr_Factors:  [99.74194584]
mat_Sqrt:  [[0.15]]
grads:  [0.09207046]
Stock Position:  0.09207045522164094
Bond Position:  [-2.42866507]


portfolio before change:  [6.85654475]
curr_Stock_Price:  100.85225937067494
curr_Factors:  [100.85225937]
mat_Sqrt:  [[0.15]]
grads:  [0.05129364]
Stock Position:  0.05129363645711228
Bond Position:  [1.68346563]


portfolio before change:  [6.91777425]
curr_Stock_Price:  102.04186212023782
curr_Factors:  [102.04186212]
mat_Sqrt:  [[0.15]]
grads:  [0.18107214]
Stock Position:  0.18107214431245616
Bond Position:  [-11.55916453]


portfolio before change:  [6.73363275]
curr_Stock_Price:  101.03289125447762
curr_Factors:  [101.03289125]
mat_Sqrt:  [[0.15]]
grads:  [0.06755116]
Stock Position:  0.06755115600944828
Bond Position:  [-0.09125585]


portfolio before change:  [6.74532339]
curr_Stock_Price:  101.20612369052049
curr_Factors:  [101.20612369]
mat_Sqrt:  [[0.15]]
grads:  [-0.07353135]
Stock Position:  -0.07353135428573894
Bond Position:  [14.18714673]


portfolio before change:  [6.72453772]
curr_Stock_Price:  101.51292042072102
curr_Factors:  [101.51292042]
mat_Sqrt:  [[0.15]]
grads:  [0.07798139]
Stock Position:  0.0779813936334725
Bond Position:  [-1.19158129]


portfolio before change:  [6.7186995]
curr_Stock_Price:  101.43996381988008
curr_Factors:  [101.43996382]
mat_Sqrt:  [[0.15]]
grads:  [-0.04326207]
Stock Position:  -0.04326207347263851
Bond Position:  [11.10720267]


portfolio before change:  [6.67291326]
curr_Stock_Price:  102.53040449851065
curr_Factors:  [102.5304045]
mat_Sqrt:  [[0.15]]
grads:  [-0.17379483]
Stock Position:  -0.17379482849293137
Bond Position:  [24.49216733]


portfolio before change:  [6.64737395]
curr_Stock_Price:  102.69497228133771
curr_Factors:  [102.69497228]
mat_Sqrt:  [[0.15]]
grads:  [0.03009176]
Stock Position:  0.030091757839634376
Bond Position:  [3.55710171]


portfolio before change:  [6.65182778]
curr_Stock_Price:  102.82820362933474
curr_Factors:  [102.82820363]
mat_Sqrt:  [[0.15]]
grads:  [-0.00493104]
Stock Position:  -0.004931043369561481
Bond Position:  [7.15887811]


portfolio before change:  [6.64804641]
curr_Stock_Price:  103.77653876559997
curr_Factors:  [103.77653877]
mat_Sqrt:  [[0.15]]
grads:  [0.01764842]
Stock Position:  0.017648422162182487
Bond Position:  [4.81655425]


portfolio before change:  [6.66538902]
curr_Stock_Price:  104.72509389576727
curr_Factors:  [104.7250939]
mat_Sqrt:  [[0.15]]
grads:  [-0.02412208]
Stock Position:  -0.024122076194023623
Bond Position:  [9.19157572]


portfolio before change:  [6.69478729]
curr_Stock_Price:  103.55399870932914
curr_Factors:  [103.55399871]
mat_Sqrt:  [[0.15]]
grads:  [-0.00954044]
Stock Position:  -0.009540439534489662
Bond Position:  [7.68273795]


portfolio before change:  [6.6899667]
curr_Stock_Price:  104.15994428376594
curr_Factors:  [104.15994428]
mat_Sqrt:  [[0.15]]
grads:  [-0.26432141]
Stock Position:  -0.26432141373932805
Bond Position:  [34.22167043]


portfolio before change:  [7.04631159]
curr_Stock_Price:  102.82797913351449
curr_Factors:  [102.82797913]
mat_Sqrt:  [[0.15]]
grads:  [0.03198928]
Stock Position:  0.031989275286715954
Bond Position:  [3.75691906]


portfolio before change:  [7.04395407]
curr_Stock_Price:  102.73960057133607
curr_Factors:  [102.73960057]
mat_Sqrt:  [[0.15]]
grads:  [0.05691724]
Stock Position:  0.056917236691000656
Bond Position:  [1.1962999]


portfolio before change:  [7.05464151]
curr_Stock_Price:  102.92474473555124
curr_Factors:  [102.92474474]
mat_Sqrt:  [[0.15]]
grads:  [-0.03591271]
Stock Position:  -0.03591270530258916
Bond Position:  [10.75094753]


portfolio before change:  [7.09619507]
curr_Stock_Price:  101.80509623493899
curr_Factors:  [101.80509623]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407116]
Stock Position:  -0.04071159665337644
Bond Position:  [11.24084308]


portfolio before change:  [7.11235478]
curr_Stock_Price:  101.44268061160993
curr_Factors:  [101.44268061]
mat_Sqrt:  [[0.15]]
grads:  [0.03920801]
Stock Position:  0.039208009896290516
Bond Position:  [3.13498915]


portfolio before change:  [7.14235269]
curr_Stock_Price:  102.19778164262054
curr_Factors:  [102.19778164]
mat_Sqrt:  [[0.15]]
grads:  [-0.09272307]
Stock Position:  -0.09272306686514761
Bond Position:  [16.61844443]


portfolio before change:  [7.09947372]
curr_Stock_Price:  102.68262759254043
curr_Factors:  [102.68262759]
mat_Sqrt:  [[0.15]]
grads:  [0.00585809]
Stock Position:  0.005858088727003358
Bond Position:  [6.49794978]


portfolio before change:  [7.09971163]
curr_Stock_Price:  102.58457782393161
curr_Factors:  [102.58457782]
mat_Sqrt:  [[0.15]]
grads:  [0.15675441]
Stock Position:  0.15675440998294865
Bond Position:  [-8.98087334]


portfolio before change:  [6.97664535]
curr_Stock_Price:  101.8066500947026
curr_Factors:  [101.80665009]
mat_Sqrt:  [[0.15]]
grads:  [0.01119904]
Stock Position:  0.0111990370325061
Bond Position:  [5.8365089]


portfolio before change:  [6.98097421]
curr_Stock_Price:  102.1280395475461
curr_Factors:  [102.12803955]
mat_Sqrt:  [[0.15]]
grads:  [0.04300886]
Stock Position:  0.04300885508138061
Bond Position:  [2.58856416]


portfolio before change:  [7.00877628]
curr_Stock_Price:  102.76694231126802
curr_Factors:  [102.76694231]
mat_Sqrt:  [[0.15]]
grads:  [-0.08537966]
Stock Position:  -0.08537966210685043
Bond Position:  [15.78298309]


portfolio before change:  [7.0838102]
curr_Stock_Price:  101.91122412393953
curr_Factors:  [101.91122412]
mat_Sqrt:  [[0.15]]
grads:  [-0.03994454]
Stock Position:  -0.039944540462053826
Bond Position:  [11.15460722]


portfolio before change:  [7.16245141]
curr_Stock_Price:  99.97737305123165
curr_Factors:  [99.97737305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04859577]
Stock Position:  -0.04859577369904532
Bond Position:  [12.0209292]


portfolio before change:  [7.20175939]
curr_Stock_Price:  99.19941913291478
curr_Factors:  [99.19941913]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005091]
Stock Position:  -0.05005090890139259
Bond Position:  [12.16678048]


portfolio before change:  [7.23650634]
curr_Stock_Price:  98.53557488125708
curr_Factors:  [98.53557488]
mat_Sqrt:  [[0.15]]
grads:  [0.14651601]
Stock Position:  0.14651601380008633
Bond Position:  [-7.20053331]


portfolio before change:  [7.16610742]
curr_Stock_Price:  98.06123217777329
curr_Factors:  [98.06123218]
mat_Sqrt:  [[0.15]]
grads:  [0.05570185]
Stock Position:  0.0557018473280953
Bond Position:  [1.70391563]


portfolio before change:  [7.19426644]
curr_Stock_Price:  98.56293947465706
curr_Factors:  [98.56293947]
mat_Sqrt:  [[0.15]]
grads:  [0.1540887]
Stock Position:  0.15408869979585202
Bond Position:  [-7.99316875]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.19426644]
Stock Price:  98.46008954845279
PL:  [7.19426644]
Settle:  Tensor("sub_154:0", shape=(), dtype=float64)
PL:  Tensor("sub_155:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  78
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.37014173e-03]
 [-8.93333922e-03]
 [-6.38464190e-03]
 [ 3.17897377e-03]
 [ 1.46372557e-02]
 [ 1.79448678e-02]
 [ 2.54162573e-02]
 [-3.09919790e-03]
 [ 3.25281449e-03]
 [-7.56373088e-04]
 [ 1.81224657e-02]
 [ 1.17718739e-02]
 [-6.56688840e-03]
 [ 1.15604388e-02]
 [-4.58572797e-03]
 [-1.14919830e-02]
 [-1.84876073e-03]
 [-3.03742498e-03]
 [-1.08624394e-02]
 [-2.32177492e-03]
 [ 3.13696368e-04]
 [ 8.62511331e-03]
 [ 4.76706189e-03]
 [ 5.53054989e-03]
 [-5.81874527e-04]
 [-4.66913749e-03]
 [-4.08399023e-03]
 [-1.96020629e-02]
 [-3.08872495e-02]
 [ 2.18690704e-02]
 [ 2.95784586e-03]
 [-6.60540698e-03]
 [-1.24698478e-02]
 [-8.81778240e-03]
 [-6.64643586e-03]
 [-6.32361406e-03]
 [ 2.05221014e-02]
 [ 9.46066300e-03]
 [ 2.00939388e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-12.62066799]
curr_Stock_Price:  99.06197502038827
curr_Factors:  [99.06197502]
mat_Sqrt:  [[0.15]]
grads:  [-0.03580094]
Stock Position:  -0.035800944880391844
Bond Position:  [-9.07415568]


portfolio before change:  [-12.65482675]
curr_Stock_Price:  99.98442042422388
curr_Factors:  [99.98442042]
mat_Sqrt:  [[0.15]]
grads:  [-0.05955559]
Stock Position:  -0.059555594814739564
Bond Position:  [-6.70019512]


portfolio before change:  [-12.72774604]
curr_Stock_Price:  101.19474685999145
curr_Factors:  [101.19474686]
mat_Sqrt:  [[0.15]]
grads:  [-0.04256428]
Stock Position:  -0.042564279312701535
Bond Position:  [-8.42046457]


portfolio before change:  [-12.70461145]
curr_Stock_Price:  100.62649557201243
curr_Factors:  [100.62649557]
mat_Sqrt:  [[0.15]]
grads:  [0.02119316]
Stock Position:  0.021193158494962734
Bond Position:  [-14.83720472]


portfolio before change:  [-12.68789685]
curr_Stock_Price:  101.50269180996054
curr_Factors:  [101.50269181]
mat_Sqrt:  [[0.15]]
grads:  [0.0975817]
Stock Position:  0.0975817048702089
Bond Position:  [-22.59270257]


portfolio before change:  [-12.90407727]
curr_Stock_Price:  99.31625587306833
curr_Factors:  [99.31625587]
mat_Sqrt:  [[0.15]]
grads:  [0.11963245]
Stock Position:  0.11963245225527072
Bond Position:  [-24.7855245]


portfolio before change:  [-12.87054648]
curr_Stock_Price:  99.62243672464078
curr_Factors:  [99.62243672]
mat_Sqrt:  [[0.15]]
grads:  [0.16944172]
Stock Position:  0.16944171526461216
Bond Position:  [-29.75074304]


portfolio before change:  [-12.92189841]
curr_Stock_Price:  99.3413203043366
curr_Factors:  [99.3413203]
mat_Sqrt:  [[0.15]]
grads:  [-0.02066132]
Stock Position:  -0.020661319337082925
Bond Position:  [-10.86937566]


portfolio before change:  [-12.95376965]
curr_Stock_Price:  100.8181130902967
curr_Factors:  [100.81811309]
mat_Sqrt:  [[0.15]]
grads:  [0.02168543]
Stock Position:  0.021685429900701703
Bond Position:  [-15.14005378]


portfolio before change:  [-12.97128308]
curr_Stock_Price:  100.09777653288482
curr_Factors:  [100.09777653]
mat_Sqrt:  [[0.15]]
grads:  [-0.00504249]
Stock Position:  -0.005042487253695358
Bond Position:  [-12.46654132]


portfolio before change:  [-12.9767895]
curr_Stock_Price:  100.88072294424816
curr_Factors:  [100.88072294]
mat_Sqrt:  [[0.15]]
grads:  [0.12081644]
Stock Position:  0.12081643824934828
Bond Position:  [-25.16483913]


portfolio before change:  [-13.06646778]
curr_Stock_Price:  100.16449193213047
curr_Factors:  [100.16449193]
mat_Sqrt:  [[0.15]]
grads:  [0.07847916]
Stock Position:  0.07847915920762255
Bond Position:  [-20.92729289]


portfolio before change:  [-13.12266751]
curr_Stock_Price:  99.48171635758028
curr_Factors:  [99.48171636]
mat_Sqrt:  [[0.15]]
grads:  [-0.04377926]
Stock Position:  -0.043779256006257886
Bond Position:  [-8.76743198]


portfolio before change:  [-13.14851845]
curr_Stock_Price:  100.04716568123159
curr_Factors:  [100.04716568]
mat_Sqrt:  [[0.15]]
grads:  [0.07706959]
Stock Position:  0.07706959171218686
Bond Position:  [-20.85911267]


portfolio before change:  [-13.1717223]
curr_Stock_Price:  99.77992282270249
curr_Factors:  [99.77992282]
mat_Sqrt:  [[0.15]]
grads:  [-0.03057152]
Stock Position:  -0.03057151977145079
Bond Position:  [-10.12129842]


portfolio before change:  [-13.16640665]
curr_Stock_Price:  99.56466060088773
curr_Factors:  [99.5646606]
mat_Sqrt:  [[0.15]]
grads:  [-0.07661322]
Stock Position:  -0.07661322023683269
Bond Position:  [-5.53843738]


portfolio before change:  [-13.12875186]
curr_Stock_Price:  99.06413151798886
curr_Factors:  [99.06413152]
mat_Sqrt:  [[0.15]]
grads:  [-0.01232507]
Stock Position:  -0.01232507156416842
Bond Position:  [-11.90777934]


portfolio before change:  [-13.1354757]
curr_Stock_Price:  99.48889834558442
curr_Factors:  [99.48889835]
mat_Sqrt:  [[0.15]]
grads:  [-0.0202495]
Stock Position:  -0.020249499865846097
Bond Position:  [-11.12087527]


portfolio before change:  [-13.14698363]
curr_Stock_Price:  99.98855154875848
curr_Factors:  [99.98855155]
mat_Sqrt:  [[0.15]]
grads:  [-0.07241626]
Stock Position:  -0.07241626286831296
Bond Position:  [-5.90618639]


portfolio before change:  [-13.09848141]
curr_Stock_Price:  99.30858636362436
curr_Factors:  [99.30858636]
mat_Sqrt:  [[0.15]]
grads:  [-0.0154785]
Stock Position:  -0.01547849949862913
Bond Position:  [-11.5613335]


portfolio before change:  [-13.09309054]
curr_Stock_Price:  98.86693365272161
curr_Factors:  [98.86693365]
mat_Sqrt:  [[0.15]]
grads:  [0.00209131]
Stock Position:  0.002091309118211911
Bond Position:  [-13.29985186]


portfolio before change:  [-13.09525995]
curr_Stock_Price:  98.62458846389517
curr_Factors:  [98.62458846]
mat_Sqrt:  [[0.15]]
grads:  [0.05750076]
Stock Position:  0.05750075537851024
Bond Position:  [-18.76624828]


portfolio before change:  [-13.10519563]
curr_Stock_Price:  98.49259441462509
curr_Factors:  [98.49259441]
mat_Sqrt:  [[0.15]]
grads:  [0.03178041]
Stock Position:  0.031780412629655246
Bond Position:  [-16.23533092]


portfolio before change:  [-13.13927796]
curr_Stock_Price:  97.48402396275233
curr_Factors:  [97.48402396]
mat_Sqrt:  [[0.15]]
grads:  [0.03687033]
Stock Position:  0.03687033262970647
Bond Position:  [-16.73354635]


portfolio before change:  [-13.16657983]
curr_Stock_Price:  96.80027532321532
curr_Factors:  [96.80027532]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387916]
Stock Position:  -0.0038791635132998624
Bond Position:  [-12.79107573]


portfolio before change:  [-13.17023281]
curr_Stock_Price:  97.32977188137662
curr_Factors:  [97.32977188]
mat_Sqrt:  [[0.15]]
grads:  [-0.03112758]
Stock Position:  -0.031127583244067444
Bond Position:  [-10.14059224]


portfolio before change:  [-13.15188387]
curr_Stock_Price:  96.69957218992536
curr_Factors:  [96.69957219]
mat_Sqrt:  [[0.15]]
grads:  [-0.0272266]
Stock Position:  -0.02722660152263673
Bond Position:  [-10.51908315]


portfolio before change:  [-13.16475188]
curr_Stock_Price:  97.12390137881266
curr_Factors:  [97.12390138]
mat_Sqrt:  [[0.15]]
grads:  [-0.13068042]
Stock Position:  -0.13068041907456202
Bond Position:  [-0.47255975]


portfolio before change:  [-13.23618647]
curr_Stock_Price:  97.67008506601617
curr_Factors:  [97.67008507]
mat_Sqrt:  [[0.15]]
grads:  [-0.205915]
Stock Position:  -0.20591499644673533
Bond Position:  [6.87554875]


portfolio before change:  [-12.98748656]
curr_Stock_Price:  96.46647963366593
curr_Factors:  [96.46647963]
mat_Sqrt:  [[0.15]]
grads:  [0.1457938]
Stock Position:  0.14579380284728746
Bond Position:  [-27.05170148]


portfolio before change:  [-12.95203378]
curr_Stock_Price:  96.73284523214205
curr_Factors:  [96.73284523]
mat_Sqrt:  [[0.15]]
grads:  [0.01971897]
Stock Position:  0.01971897239917087
Bond Position:  [-14.85950609]


portfolio before change:  [-12.96119965]
curr_Stock_Price:  96.3622219216007
curr_Factors:  [96.36222192]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403605]
Stock Position:  -0.04403604650187003
Bond Position:  [-8.71778836]


portfolio before change:  [-12.95456131]
curr_Stock_Price:  96.1867263997994
curr_Factors:  [96.1867264]
mat_Sqrt:  [[0.15]]
grads:  [-0.08313232]
Stock Position:  -0.08313231833685175
Bond Position:  [-4.95833575]


portfolio before change:  [-12.9106545]
curr_Stock_Price:  95.65111472153167
curr_Factors:  [95.65111472]
mat_Sqrt:  [[0.15]]
grads:  [-0.05878522]
Stock Position:  -0.05878521599956365
Bond Position:  [-7.28778306]


portfolio before change:  [-12.95236562]
curr_Stock_Price:  96.3451683469934
curr_Factors:  [96.34516835]
mat_Sqrt:  [[0.15]]
grads:  [-0.04430957]
Stock Position:  -0.044309572408874946
Bond Position:  [-8.68335241]


portfolio before change:  [-12.98038367]
curr_Stock_Price:  96.9529953568889
curr_Factors:  [96.95299536]
mat_Sqrt:  [[0.15]]
grads:  [-0.04215743]
Stock Position:  -0.04215742705530841
Bond Position:  [-8.89309484]


portfolio before change:  [-12.98718431]
curr_Stock_Price:  97.08794032470682
curr_Factors:  [97.08794032]
mat_Sqrt:  [[0.15]]
grads:  [0.13681401]
Stock Position:  0.13681400903280527
Bond Position:  [-26.27017465]


portfolio before change:  [-13.17179344]
curr_Stock_Price:  95.76259972430435
curr_Factors:  [95.76259972]
mat_Sqrt:  [[0.15]]
grads:  [0.06307109]
Stock Position:  0.06307108666134721
Bond Position:  [-19.21164467]


portfolio before change:  [-13.18598828]
curr_Stock_Price:  95.57561650016241
curr_Factors:  [95.5756165]
mat_Sqrt:  [[0.15]]
grads:  [0.13395959]
Stock Position:  0.133959591714851
Bond Position:  [-25.98925885]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.18598828]
Stock Price:  96.80040889579584
PL:  [-13.18598828]
Settle:  Tensor("sub_156:0", shape=(), dtype=float64)
PL:  Tensor("sub_157:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  79
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.50586887e-03]
 [-1.19191220e-02]
 [-1.07112531e-02]
 [-4.45034165e-03]
 [ 5.11959081e-03]
 [ 2.41409435e-02]
 [ 9.66075445e-03]
 [-4.68420404e-03]
 [ 6.79632018e-03]
 [ 7.34273466e-04]
 [-2.11721335e-02]
 [-5.44888704e-03]
 [ 1.03894359e-02]
 [ 5.59757533e-03]
 [ 1.31698394e-02]
 [-7.03678484e-03]
 [-1.14239474e-02]
 [ 1.35543477e-04]
 [-7.61684687e-03]
 [-2.48211478e-03]
 [ 5.38731275e-04]
 [ 9.84428133e-03]
 [ 4.75829644e-03]
 [ 5.40409868e-03]
 [-1.01740811e-03]
 [-5.09620043e-03]
 [-6.57420621e-03]
 [-2.14735979e-02]
 [-3.75164599e-02]
 [ 2.20562163e-02]
 [ 3.46997488e-03]
 [-5.40350609e-03]
 [-1.25335170e-02]
 [-8.59230332e-03]
 [-7.68557873e-03]
 [-7.15533414e-03]
 [ 2.14745205e-02]
 [ 8.53878153e-03]
 [ 2.33264314e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.88701779]
curr_Stock_Price:  100.06101224810658
curr_Factors:  [100.06101225]
mat_Sqrt:  [[0.15]]
grads:  [-0.01003913]
Stock Position:  -0.010039125825545723
Bond Position:  [3.89154288]


portfolio before change:  [2.88245867]
curr_Stock_Price:  100.56360490989458
curr_Factors:  [100.56360491]
mat_Sqrt:  [[0.15]]
grads:  [-0.07946081]
Stock Position:  -0.07946081333692498
Bond Position:  [10.87332451]


portfolio before change:  [2.99265794]
curr_Stock_Price:  99.19387291911465
curr_Factors:  [99.19387292]
mat_Sqrt:  [[0.15]]
grads:  [-0.07140835]
Stock Position:  -0.07140835388729261
Bond Position:  [10.07592912]


portfolio before change:  [2.93263258]
curr_Stock_Price:  100.05210480072871
curr_Factors:  [100.0521048]
mat_Sqrt:  [[0.15]]
grads:  [-0.02966894]
Stock Position:  -0.029668944352476807
Bond Position:  [5.90107291]


portfolio before change:  [2.93349891]
curr_Stock_Price:  100.04776857111332
curr_Factors:  [100.04776857]
mat_Sqrt:  [[0.15]]
grads:  [0.03413061]
Stock Position:  0.034130605424630714
Bond Position:  [-0.481192]


portfolio before change:  [2.85344685]
curr_Stock_Price:  97.7040682187692
curr_Factors:  [97.70406822]
mat_Sqrt:  [[0.15]]
grads:  [0.16093962]
Stock Position:  0.16093962302556006
Bond Position:  [-12.87100906]


portfolio before change:  [2.9473163]
curr_Stock_Price:  98.29732442992008
curr_Factors:  [98.29732443]
mat_Sqrt:  [[0.15]]
grads:  [0.06440503]
Stock Position:  0.06440502967207477
Bond Position:  [-3.38352579]


portfolio before change:  [2.94310512]
curr_Stock_Price:  98.23850587051578
curr_Factors:  [98.23850587]
mat_Sqrt:  [[0.15]]
grads:  [-0.03122803]
Stock Position:  -0.031228026961772418
Bond Position:  [6.01089983]


portfolio before change:  [2.97066477]
curr_Stock_Price:  97.38003860340311
curr_Factors:  [97.3800386]
mat_Sqrt:  [[0.15]]
grads:  [0.0453088]
Stock Position:  0.045308801189662386
Bond Position:  [-1.44150804]


portfolio before change:  [2.95123833]
curr_Stock_Price:  96.95525915692383
curr_Factors:  [96.95525916]
mat_Sqrt:  [[0.15]]
grads:  [0.00489516]
Stock Position:  0.004895156437297767
Bond Position:  [2.47662716]


portfolio before change:  [2.95436999]
curr_Stock_Price:  97.53176120870648
curr_Factors:  [97.53176121]
mat_Sqrt:  [[0.15]]
grads:  [-0.14114756]
Stock Position:  -0.14114755648988866
Bond Position:  [16.72073977]


portfolio before change:  [2.96195396]
curr_Stock_Price:  97.49283918718578
curr_Factors:  [97.49283919]
mat_Sqrt:  [[0.15]]
grads:  [-0.03632591]
Stock Position:  -0.03632591362092548
Bond Position:  [6.50347042]


portfolio before change:  [2.99036726]
curr_Stock_Price:  96.73304242467549
curr_Factors:  [96.73304242]
mat_Sqrt:  [[0.15]]
grads:  [0.06926291]
Stock Position:  0.0692629060546318
Bond Position:  [-3.70964437]


portfolio before change:  [2.9839176]
curr_Stock_Price:  96.64661925537496
curr_Factors:  [96.64661926]
mat_Sqrt:  [[0.15]]
grads:  [0.03731717]
Stock Position:  0.03731716887691309
Bond Position:  [-0.62266061]


portfolio before change:  [2.95991919]
curr_Stock_Price:  96.00561202307726
curr_Factors:  [96.00561202]
mat_Sqrt:  [[0.15]]
grads:  [0.08779893]
Stock Position:  0.08779892913200456
Bond Position:  [-5.46927073]


portfolio before change:  [2.91445893]
curr_Stock_Price:  95.4956222071485
curr_Factors:  [95.49562221]
mat_Sqrt:  [[0.15]]
grads:  [-0.0469119]
Stock Position:  -0.04691189890217047
Bond Position:  [7.39433991]


portfolio before change:  [2.93760516]
curr_Stock_Price:  95.02192827294296
curr_Factors:  [95.02192827]
mat_Sqrt:  [[0.15]]
grads:  [-0.07615965]
Stock Position:  -0.07615964924435027
Bond Position:  [10.17444189]


portfolio before change:  [2.84889508]
curr_Stock_Price:  96.20341964249283
curr_Factors:  [96.20341964]
mat_Sqrt:  [[0.15]]
grads:  [0.00090362]
Stock Position:  0.0009036231825017673
Bond Position:  [2.76196344]


portfolio before change:  [2.84985187]
curr_Stock_Price:  96.88016999810137
curr_Factors:  [96.88017]
mat_Sqrt:  [[0.15]]
grads:  [-0.05077898]
Stock Position:  -0.05077897911128035
Bond Position:  [7.769328]


portfolio before change:  [2.83323633]
curr_Stock_Price:  97.22650957482706
curr_Factors:  [97.22650957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01654743]
Stock Position:  -0.01654743188833029
Bond Position:  [4.44208538]


portfolio before change:  [2.83508379]
curr_Stock_Price:  97.14842091018026
curr_Factors:  [97.14842091]
mat_Sqrt:  [[0.15]]
grads:  [0.00359154]
Stock Position:  0.0035915418327864637
Bond Position:  [2.48617117]


portfolio before change:  [2.83735462]
curr_Stock_Price:  97.69415856710212
curr_Factors:  [97.69415857]
mat_Sqrt:  [[0.15]]
grads:  [0.06562854]
Stock Position:  0.06562854221164997
Bond Position:  [-3.57417059]


portfolio before change:  [2.79715384]
curr_Stock_Price:  97.08841633817646
curr_Factors:  [97.08841634]
mat_Sqrt:  [[0.15]]
grads:  [0.03172198]
Stock Position:  0.03172197624845978
Bond Position:  [-0.28268259]


portfolio before change:  [2.79646673]
curr_Stock_Price:  97.06786989226131
curr_Factors:  [97.06786989]
mat_Sqrt:  [[0.15]]
grads:  [0.03602732]
Stock Position:  0.03602732450753414
Bond Position:  [-0.70062892]


portfolio before change:  [2.7978065]
curr_Stock_Price:  97.10748845447623
curr_Factors:  [97.10748845]
mat_Sqrt:  [[0.15]]
grads:  [-0.00678272]
Stock Position:  -0.006782720754523548
Bond Position:  [3.45645948]


portfolio before change:  [2.79423159]
curr_Stock_Price:  97.6982531402199
curr_Factors:  [97.69825314]
mat_Sqrt:  [[0.15]]
grads:  [-0.03397467]
Stock Position:  -0.03397466953280118
Bond Position:  [6.11349746]


portfolio before change:  [2.7938822]
curr_Stock_Price:  97.73103129720626
curr_Factors:  [97.7310313]
mat_Sqrt:  [[0.15]]
grads:  [-0.04382804]
Stock Position:  -0.04382804139894384
Bond Position:  [7.07724189]


portfolio before change:  [2.7750417]
curr_Stock_Price:  98.181090540984
curr_Factors:  [98.18109054]
mat_Sqrt:  [[0.15]]
grads:  [-0.14315732]
Stock Position:  -0.1431573193040851
Bond Position:  [16.83038342]


portfolio before change:  [2.72566922]
curr_Stock_Price:  98.54066979406389
curr_Factors:  [98.54066979]
mat_Sqrt:  [[0.15]]
grads:  [-0.25010973]
Stock Position:  -0.2501097326296258
Bond Position:  [27.3716498]


portfolio before change:  [2.88175316]
curr_Stock_Price:  97.93028865534757
curr_Factors:  [97.93028866]
mat_Sqrt:  [[0.15]]
grads:  [0.14704144]
Stock Position:  0.14704144196537758
Bond Position:  [-11.5180577]


portfolio before change:  [2.77870225]
curr_Stock_Price:  97.23925176114501
curr_Factors:  [97.23925176]
mat_Sqrt:  [[0.15]]
grads:  [0.02313317]
Stock Position:  0.023133165880575946
Bond Position:  [0.52925051]


portfolio before change:  [2.77404234]
curr_Stock_Price:  97.03495317432977
curr_Factors:  [97.03495317]
mat_Sqrt:  [[0.15]]
grads:  [-0.03602337]
Stock Position:  -0.03602337395202144
Bond Position:  [6.26956874]


portfolio before change:  [2.76512061]
curr_Stock_Price:  97.30437453325492
curr_Factors:  [97.30437453]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355678]
Stock Position:  -0.0835567801988252
Bond Position:  [10.89556085]


portfolio before change:  [2.6974118]
curr_Stock_Price:  98.13100816803149
curr_Factors:  [98.13100817]
mat_Sqrt:  [[0.15]]
grads:  [-0.05728202]
Stock Position:  -0.05728202210698578
Bond Position:  [8.31855438]


portfolio before change:  [2.7232496]
curr_Stock_Price:  97.6980988602907
curr_Factors:  [97.69809886]
mat_Sqrt:  [[0.15]]
grads:  [-0.05123719]
Stock Position:  -0.05123719151486103
Bond Position:  [7.72902581]


portfolio before change:  [2.7260646]
curr_Stock_Price:  97.66201562910518
curr_Factors:  [97.66201563]
mat_Sqrt:  [[0.15]]
grads:  [-0.04770223]
Stock Position:  -0.04770222758642846
Bond Position:  [7.38476029]


portfolio before change:  [2.70889735]
curr_Stock_Price:  98.04125151069331
curr_Factors:  [98.04125151]
mat_Sqrt:  [[0.15]]
grads:  [0.14316347]
Stock Position:  0.1431634698981403
Bond Position:  [-11.32702841]


portfolio before change:  [2.66907982]
curr_Stock_Price:  97.77301570168467
curr_Factors:  [97.7730157]
mat_Sqrt:  [[0.15]]
grads:  [0.05692521]
Stock Position:  0.05692521021274236
Bond Position:  [-2.89666966]


portfolio before change:  [2.73636684]
curr_Stock_Price:  98.96140191467036
curr_Factors:  [98.96140191]
mat_Sqrt:  [[0.15]]
grads:  [0.15550954]
Stock Position:  0.15550954276567466
Bond Position:  [-12.65307552]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.73636684]
Stock Price:  98.25920821181369
PL:  [2.73636684]
Settle:  Tensor("sub_158:0", shape=(), dtype=float64)
PL:  Tensor("sub_159:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  80
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.31085659e-03]
 [-8.74924250e-03]
 [-6.05584366e-03]
 [ 2.58170574e-03]
 [ 1.31678422e-02]
 [ 2.88249798e-02]
 [ 2.66556631e-02]
 [-1.72752637e-03]
 [ 4.00932225e-03]
 [ 1.16014362e-02]
 [ 2.65321402e-02]
 [-6.81368712e-03]
 [-1.27035229e-02]
 [ 9.26550443e-03]
 [-1.03195016e-03]
 [-2.63920562e-02]
 [ 4.97878842e-03]
 [-1.10201482e-03]
 [ 1.48581171e-03]
 [-3.24663371e-03]
 [-1.91021832e-03]
 [-3.95335425e-02]
 [ 4.82810184e-03]
 [ 1.27843143e-02]
 [-6.13862677e-03]
 [ 1.94890163e-02]
 [-1.88166068e-02]
 [ 1.70131080e-02]
 [ 1.04181967e-01]
 [ 2.93398756e-02]
 [-4.77039486e-02]
 [ 2.70492479e-04]
 [-1.33808077e-02]
 [ 7.71611436e-03]
 [-7.46071540e-03]
 [ 5.24359711e-03]
 [ 2.46544333e-02]
 [ 3.38679222e-03]
 [ 2.04586444e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [25.81792306]
curr_Stock_Price:  101.53826864603192
curr_Factors:  [101.53826865]
mat_Sqrt:  [[0.15]]
grads:  [-0.02873904]
Stock Position:  -0.028739043903814796
Bond Position:  [28.73603582]


portfolio before change:  [25.84424459]
curr_Stock_Price:  100.74738303703707
curr_Factors:  [100.74738304]
mat_Sqrt:  [[0.15]]
grads:  [-0.05832828]
Stock Position:  -0.0583282833249914
Bond Position:  [31.72066649]


portfolio before change:  [25.81809176]
curr_Stock_Price:  101.26373898160413
curr_Factors:  [101.26373898]
mat_Sqrt:  [[0.15]]
grads:  [-0.04037229]
Stock Position:  -0.040372291051889886
Bond Position:  [29.9063409]


portfolio before change:  [25.84819175]
curr_Stock_Price:  100.61077956548235
curr_Factors:  [100.61077957]
mat_Sqrt:  [[0.15]]
grads:  [0.01721137]
Stock Position:  0.017211371626643324
Bond Position:  [24.11654224]


portfolio before change:  [25.8674416]
curr_Stock_Price:  101.55405659009493
curr_Factors:  [101.55405659]
mat_Sqrt:  [[0.15]]
grads:  [0.08778561]
Stock Position:  0.08778561437883871
Bond Position:  [16.95245635]


portfolio before change:  [25.86758717]
curr_Stock_Price:  101.53157431427039
curr_Factors:  [101.53157431]
mat_Sqrt:  [[0.15]]
grads:  [0.19216653]
Stock Position:  0.19216653192979213
Bond Position:  [6.35661665]


portfolio before change:  [25.67312986]
curr_Stock_Price:  100.51551839666661
curr_Factors:  [100.5155184]
mat_Sqrt:  [[0.15]]
grads:  [0.17770442]
Stock Position:  0.1777044209993131
Bond Position:  [7.81107786]


portfolio before change:  [25.78152775]
curr_Stock_Price:  101.12001345576216
curr_Factors:  [101.12001346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01151684]
Stock Position:  -0.011516842471951356
Bond Position:  [26.94611101]


portfolio before change:  [25.7822677]
curr_Stock_Price:  101.34824640245526
curr_Factors:  [101.3482464]
mat_Sqrt:  [[0.15]]
grads:  [0.02672881]
Stock Position:  0.0267288149777139
Bond Position:  [23.07334917]


portfolio before change:  [25.80201532]
curr_Stock_Price:  101.97914865384064
curr_Factors:  [101.97914865]
mat_Sqrt:  [[0.15]]
grads:  [0.07734291]
Stock Position:  0.07734290801570563
Bond Position:  [17.9146514]


portfolio before change:  [25.83528019]
curr_Stock_Price:  102.38028952486584
curr_Factors:  [102.38028952]
mat_Sqrt:  [[0.15]]
grads:  [0.17688093]
Stock Position:  0.17688093481839043
Bond Position:  [7.72615887]


portfolio before change:  [26.06046378]
curr_Stock_Price:  103.64790923510989
curr_Factors:  [103.64790924]
mat_Sqrt:  [[0.15]]
grads:  [-0.04542458]
Stock Position:  -0.04542458080730423
Bond Position:  [30.76862661]


portfolio before change:  [26.05287748]
curr_Stock_Price:  103.89959271093103
curr_Factors:  [103.89959271]
mat_Sqrt:  [[0.15]]
grads:  [-0.08469015]
Stock Position:  -0.08469015278464859
Bond Position:  [34.85214986]


portfolio before change:  [26.14838219]
curr_Stock_Price:  102.82334101239883
curr_Factors:  [102.82334101]
mat_Sqrt:  [[0.15]]
grads:  [0.06177003]
Stock Position:  0.061770029516694816
Bond Position:  [19.79698138]


portfolio before change:  [26.16510527]
curr_Stock_Price:  103.05400787004959
curr_Factors:  [103.05400787]
mat_Sqrt:  [[0.15]]
grads:  [-0.00687967]
Stock Position:  -0.006879667748496977
Bond Position:  [26.8740826]


portfolio before change:  [26.17109238]
curr_Stock_Price:  102.67206490647268
curr_Factors:  [102.67206491]
mat_Sqrt:  [[0.15]]
grads:  [-0.17594704]
Stock Position:  -0.1759470410239899
Bond Position:  [44.2359384]


portfolio before change:  [26.04702407]
curr_Stock_Price:  103.40863963447269
curr_Factors:  [103.40863963]
mat_Sqrt:  [[0.15]]
grads:  [0.03319192]
Stock Position:  0.033191922797586794
Bond Position:  [22.61469249]


portfolio before change:  [26.03332507]
curr_Stock_Price:  102.91074683128696
curr_Factors:  [102.91074683]
mat_Sqrt:  [[0.15]]
grads:  [-0.00734677]
Stock Position:  -0.007346765442103589
Bond Position:  [26.78938619]


portfolio before change:  [26.03220613]
curr_Stock_Price:  103.51888059357503
curr_Factors:  [103.51888059]
mat_Sqrt:  [[0.15]]
grads:  [0.00990541]
Stock Position:  0.00990541138290512
Bond Position:  [25.00680904]


portfolio before change:  [26.03992387]
curr_Stock_Price:  103.98243428122097
curr_Factors:  [103.98243428]
mat_Sqrt:  [[0.15]]
grads:  [-0.02164422]
Stock Position:  -0.021644224735777394
Bond Position:  [28.29054305]


portfolio before change:  [26.03120963]
curr_Stock_Price:  104.54844118222435
curr_Factors:  [104.54844118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01273479]
Stock Position:  -0.01273478881750504
Bond Position:  [27.36261195]


portfolio before change:  [26.03062882]
curr_Stock_Price:  104.86264771768542
curr_Factors:  [104.86264772]
mat_Sqrt:  [[0.15]]
grads:  [-0.26355695]
Stock Position:  -0.2635569502710696
Bond Position:  [53.66790845]


portfolio before change:  [25.88756932]
curr_Stock_Price:  105.43090591880058
curr_Factors:  [105.43090592]
mat_Sqrt:  [[0.15]]
grads:  [0.03218735]
Stock Position:  0.03218734559512704
Bond Position:  [22.49402832]


portfolio before change:  [25.9332808]
curr_Stock_Price:  106.76371378026845
curr_Factors:  [106.76371378]
mat_Sqrt:  [[0.15]]
grads:  [0.08522876]
Stock Position:  0.08522876200402414
Bond Position:  [16.83394165]


portfolio before change:  [26.01456236]
curr_Stock_Price:  107.69270979929689
curr_Factors:  [107.6927098]
mat_Sqrt:  [[0.15]]
grads:  [-0.04092418]
Stock Position:  -0.040924178492784534
Bond Position:  [30.42179803]


portfolio before change:  [26.02155981]
curr_Stock_Price:  107.61465100372453
curr_Factors:  [107.614651]
mat_Sqrt:  [[0.15]]
grads:  [0.12992678]
Stock Position:  0.1299267752144244
Bond Position:  [12.03953524]


portfolio before change:  [26.17657674]
curr_Stock_Price:  108.7961772624969
curr_Factors:  [108.79617726]
mat_Sqrt:  [[0.15]]
grads:  [-0.12544405]
Stock Position:  -0.12544404502609635
Bond Position:  [39.8244093]


portfolio before change:  [26.14184146]
curr_Stock_Price:  109.11276177856985
curr_Factors:  [109.11276178]
mat_Sqrt:  [[0.15]]
grads:  [0.11342072]
Stock Position:  0.11342071973874718
Bond Position:  [13.76619349]


portfolio before change:  [26.20198348]
curr_Stock_Price:  109.62784526154601
curr_Factors:  [109.62784526]
mat_Sqrt:  [[0.15]]
grads:  [0.69454645]
Stock Position:  0.6945464482703619
Bond Position:  [-49.93964707]


portfolio before change:  [26.72713226]
curr_Stock_Price:  110.39293680938779
curr_Factors:  [110.39293681]
mat_Sqrt:  [[0.15]]
grads:  [0.19559917]
Stock Position:  0.19559917034946633
Bond Position:  [5.1343654]


portfolio before change:  [26.61941841]
curr_Stock_Price:  109.83896879272022
curr_Factors:  [109.83896879]
mat_Sqrt:  [[0.15]]
grads:  [-0.31802632]
Stock Position:  -0.31802632421537436
Bond Position:  [61.55110191]


portfolio before change:  [26.79390994]
curr_Stock_Price:  109.31449281909795
curr_Factors:  [109.31449282]
mat_Sqrt:  [[0.15]]
grads:  [0.00180328]
Stock Position:  0.0018032831905286212
Bond Position:  [26.59678495]


portfolio before change:  [26.79725196]
curr_Stock_Price:  109.32404037250981
curr_Factors:  [109.32404037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08920538]
Stock Position:  -0.08920538440454184
Bond Position:  [36.54954501]


portfolio before change:  [26.85712992]
curr_Stock_Price:  108.70402196638241
curr_Factors:  [108.70402197]
mat_Sqrt:  [[0.15]]
grads:  [0.05144076]
Stock Position:  0.051440762386067755
Bond Position:  [21.26531216]


portfolio before change:  [26.82421121]
curr_Stock_Price:  108.01241011065491
curr_Factors:  [108.01241011]
mat_Sqrt:  [[0.15]]
grads:  [-0.0497381]
Stock Position:  -0.04973810264828822
Bond Position:  [32.19654355]


portfolio before change:  [26.88009229]
curr_Stock_Price:  106.96982386897675
curr_Factors:  [106.96982387]
mat_Sqrt:  [[0.15]]
grads:  [0.03495731]
Stock Position:  0.034957314033868224
Bond Position:  [23.14071457]


portfolio before change:  [26.88557025]
curr_Stock_Price:  107.04377650088148
curr_Factors:  [107.0437765]
mat_Sqrt:  [[0.15]]
grads:  [0.16436289]
Stock Position:  0.1643628888743982
Bond Position:  [9.29154591]


portfolio before change:  [26.62778067]
curr_Stock_Price:  105.46829253059553
curr_Factors:  [105.46829253]
mat_Sqrt:  [[0.15]]
grads:  [0.02257861]
Stock Position:  0.022578614770913732
Bond Position:  [24.24645272]


portfolio before change:  [26.60862797]
curr_Stock_Price:  104.48578349521692
curr_Factors:  [104.4857835]
mat_Sqrt:  [[0.15]]
grads:  [0.13639096]
Stock Position:  0.1363909624493521
Bond Position:  [12.3577114]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [26.60862797]
Stock Price:  105.08111948246312
PL:  [21.52750849]
Settle:  Tensor("sub_160:0", shape=(), dtype=float64)
PL:  Tensor("sub_161:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  81
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.66951774e-03]
 [-2.10953287e-03]
 [ 1.45112574e-02]
 [ 1.19202450e-03]
 [ 9.64239980e-03]
 [ 2.29086790e-02]
 [ 1.97487684e-02]
 [-3.11301471e-03]
 [ 8.42081442e-03]
 [-1.04301213e-03]
 [ 6.57037166e-03]
 [ 1.11555063e-02]
 [-9.09393876e-03]
 [ 1.02546622e-02]
 [-1.34036131e-03]
 [-1.08798201e-02]
 [ 3.61672337e-03]
 [-2.25701665e-03]
 [-1.18905597e-02]
 [-2.34999371e-03]
 [ 4.61669124e-05]
 [-1.99159963e-02]
 [ 4.78899849e-03]
 [ 7.25427181e-03]
 [-4.03605675e-03]
 [-4.61434328e-03]
 [ 3.67586427e-03]
 [-1.86552136e-02]
 [-1.55685920e-02]
 [ 2.20500189e-02]
 [ 1.33478692e-03]
 [ 5.80029266e-03]
 [-1.25025185e-02]
 [-5.99632158e-03]
 [-5.53246254e-03]
 [-5.80415141e-03]
 [ 2.27762471e-02]
 [ 3.30100891e-03]
 [ 2.19629704e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [17.42295385]
curr_Stock_Price:  100.99744734691414
curr_Factors:  [100.99744735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01779678]
Stock Position:  -0.017796784922564
Bond Position:  [19.2203837]


portfolio before change:  [17.46157837]
curr_Stock_Price:  98.96214555757506
curr_Factors:  [98.96214556]
mat_Sqrt:  [[0.15]]
grads:  [-0.01406355]
Stock Position:  -0.01406355246026893
Bond Position:  [18.8533377]


portfolio before change:  [17.4521204]
curr_Stock_Price:  99.80224575123945
curr_Factors:  [99.80224575]
mat_Sqrt:  [[0.15]]
grads:  [0.09674172]
Stock Position:  0.09674171590515812
Bond Position:  [7.79707989]


portfolio before change:  [17.52390981]
curr_Stock_Price:  100.53424351986952
curr_Factors:  [100.53424352]
mat_Sqrt:  [[0.15]]
grads:  [0.00794683]
Stock Position:  0.007946829969402713
Bond Position:  [16.72498127]


portfolio before change:  [17.51835384]
curr_Stock_Price:  99.57200794050553
curr_Factors:  [99.57200794]
mat_Sqrt:  [[0.15]]
grads:  [0.06428267]
Stock Position:  0.06428266533255138
Bond Position:  [11.11759978]


portfolio before change:  [17.43620049]
curr_Stock_Price:  98.27238641501314
curr_Factors:  [98.27238642]
mat_Sqrt:  [[0.15]]
grads:  [0.15272453]
Stock Position:  0.15272452645407897
Bond Position:  [2.42759681]


portfolio before change:  [17.56118459]
curr_Stock_Price:  99.08876231798456
curr_Factors:  [99.08876232]
mat_Sqrt:  [[0.15]]
grads:  [0.13165846]
Stock Position:  0.131658455857047
Bond Position:  [4.51531115]


portfolio before change:  [17.67261206]
curr_Stock_Price:  99.93081245796064
curr_Factors:  [99.93081246]
mat_Sqrt:  [[0.15]]
grads:  [-0.02075343]
Stock Position:  -0.020753431388691013
Bond Position:  [19.74651932]


portfolio before change:  [17.67112493]
curr_Stock_Price:  100.12141215753759
curr_Factors:  [100.12141216]
mat_Sqrt:  [[0.15]]
grads:  [0.05613876]
Stock Position:  0.056138762781658774
Bond Position:  [12.05043272]


portfolio before change:  [17.67036964]
curr_Stock_Price:  100.08112476760371
curr_Factors:  [100.08112477]
mat_Sqrt:  [[0.15]]
grads:  [-0.00695341]
Stock Position:  -0.006953414180166969
Bond Position:  [18.36627515]


portfolio before change:  [17.67263808]
curr_Stock_Price:  100.08507852953741
curr_Factors:  [100.08507853]
mat_Sqrt:  [[0.15]]
grads:  [0.04380248]
Stock Position:  0.04380247770575237
Bond Position:  [13.28866366]


portfolio before change:  [17.66155826]
curr_Stock_Price:  99.79420453806983
curr_Factors:  [99.79420454]
mat_Sqrt:  [[0.15]]
grads:  [0.07437004]
Stock Position:  0.0743700418713235
Bond Position:  [10.23985909]


portfolio before change:  [17.67533239]
curr_Stock_Price:  99.96220314396436
curr_Factors:  [99.96220314]
mat_Sqrt:  [[0.15]]
grads:  [-0.06062626]
Stock Position:  -0.060626258403976264
Bond Position:  [23.73566675]


portfolio before change:  [17.69661516]
curr_Stock_Price:  99.6600960346875
curr_Factors:  [99.66009603]
mat_Sqrt:  [[0.15]]
grads:  [0.06836441]
Stock Position:  0.06836441456390542
Bond Position:  [10.88341103]


portfolio before change:  [17.6166272]
curr_Stock_Price:  98.47017183322438
curr_Factors:  [98.47017183]
mat_Sqrt:  [[0.15]]
grads:  [-0.00893574]
Stock Position:  -0.008935742053618745
Bond Position:  [18.49653125]


portfolio before change:  [17.61103896]
curr_Stock_Price:  99.35431186541491
curr_Factors:  [99.35431187]
mat_Sqrt:  [[0.15]]
grads:  [-0.07253213]
Stock Position:  -0.07253213417940947
Bond Position:  [24.81741924]


portfolio before change:  [17.55466115]
curr_Stock_Price:  100.17436473022545
curr_Factors:  [100.17436473]
mat_Sqrt:  [[0.15]]
grads:  [0.02411149]
Stock Position:  0.02411148911823898
Bond Position:  [15.13930804]


portfolio before change:  [17.56945891]
curr_Stock_Price:  100.70959620870936
curr_Factors:  [100.70959621]
mat_Sqrt:  [[0.15]]
grads:  [-0.01504678]
Stock Position:  -0.01504677766459352
Bond Position:  [19.08481381]


portfolio before change:  [17.57014692]
curr_Stock_Price:  100.82242644254907
curr_Factors:  [100.82242644]
mat_Sqrt:  [[0.15]]
grads:  [-0.0792704]
Stock Position:  -0.07927039768765025
Bond Position:  [25.56238076]


portfolio before change:  [17.5041383]
curr_Stock_Price:  101.69543990411422
curr_Factors:  [101.6954399]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566662]
Stock Position:  -0.01566662475429996
Bond Position:  [19.09736259]


portfolio before change:  [17.51221662]
curr_Stock_Price:  101.33218338614262
curr_Factors:  [101.33218339]
mat_Sqrt:  [[0.15]]
grads:  [0.00030778]
Stock Position:  0.0003077794162077924
Bond Position:  [17.48102866]


portfolio before change:  [17.51454702]
curr_Stock_Price:  101.80373952190854
curr_Factors:  [101.80373952]
mat_Sqrt:  [[0.15]]
grads:  [-0.13277331]
Stock Position:  -0.13277330842030835
Bond Position:  [31.03136633]


portfolio before change:  [17.48554307]
curr_Stock_Price:  102.05140311786197
curr_Factors:  [102.05140312]
mat_Sqrt:  [[0.15]]
grads:  [0.03192666]
Stock Position:  0.03192665658061151
Bond Position:  [14.22738297]


portfolio before change:  [17.45841938]
curr_Stock_Price:  101.14613368343466
curr_Factors:  [101.14613368]
mat_Sqrt:  [[0.15]]
grads:  [0.04836181]
Stock Position:  0.04836181205372764
Bond Position:  [12.56680907]


portfolio before change:  [17.48763138]
curr_Stock_Price:  101.71768078300373
curr_Factors:  [101.71768078]
mat_Sqrt:  [[0.15]]
grads:  [-0.02690704]
Stock Position:  -0.026907044978895612
Bond Position:  [20.22455359]


portfolio before change:  [17.46806244]
curr_Stock_Price:  102.53892167035882
curr_Factors:  [102.53892167]
mat_Sqrt:  [[0.15]]
grads:  [-0.03076229]
Stock Position:  -0.03076228850787261
Bond Position:  [20.62239433]


portfolio before change:  [17.49406229]
curr_Stock_Price:  101.77753857306456
curr_Factors:  [101.77753857]
mat_Sqrt:  [[0.15]]
grads:  [0.02450576]
Stock Position:  0.024505761828108458
Bond Position:  [14.99992617]


portfolio before change:  [17.48442754]
curr_Stock_Price:  101.30785896624073
curr_Factors:  [101.30785897]
mat_Sqrt:  [[0.15]]
grads:  [-0.12436809]
Stock Position:  -0.12436809060571047
Bond Position:  [30.08389252]


portfolio before change:  [17.59821683]
curr_Stock_Price:  100.42315799075622
curr_Factors:  [100.42315799]
mat_Sqrt:  [[0.15]]
grads:  [-0.10379061]
Stock Position:  -0.10379061350817616
Bond Position:  [28.02119801]


portfolio before change:  [17.52650284]
curr_Stock_Price:  101.14785613750294
curr_Factors:  [101.14785614]
mat_Sqrt:  [[0.15]]
grads:  [0.14700013]
Stock Position:  0.14700012623778405
Bond Position:  [2.65775522]


portfolio before change:  [17.62847436]
curr_Stock_Price:  101.83927922466785
curr_Factors:  [101.83927922]
mat_Sqrt:  [[0.15]]
grads:  [0.00889858]
Stock Position:  0.008898579470976983
Bond Position:  [16.72224944]


portfolio before change:  [17.62430255]
curr_Stock_Price:  101.13554628591342
curr_Factors:  [101.13554629]
mat_Sqrt:  [[0.15]]
grads:  [0.03866862]
Stock Position:  0.038668617724639746
Bond Position:  [13.71353077]


portfolio before change:  [17.63284424]
curr_Stock_Price:  101.31210789617305
curr_Factors:  [101.3121079]
mat_Sqrt:  [[0.15]]
grads:  [-0.08335012]
Stock Position:  -0.0833501230628484
Bond Position:  [26.0772209]


portfolio before change:  [17.65328503]
curr_Stock_Price:  101.10597825134704
curr_Factors:  [101.10597825]
mat_Sqrt:  [[0.15]]
grads:  [-0.03997548]
Stock Position:  -0.039975477209425916
Bond Position:  [21.69504475]


portfolio before change:  [17.65819961]
curr_Stock_Price:  101.05088107255031
curr_Factors:  [101.05088107]
mat_Sqrt:  [[0.15]]
grads:  [-0.03688308]
Stock Position:  -0.036883083584046884
Bond Position:  [21.3852677]


portfolio before change:  [17.64317999]
curr_Stock_Price:  101.53058453811526
curr_Factors:  [101.53058454]
mat_Sqrt:  [[0.15]]
grads:  [-0.03869434]
Stock Position:  -0.038694342745833915
Bond Position:  [21.57183923]


portfolio before change:  [17.68209281]
curr_Stock_Price:  100.59462944266373
curr_Factors:  [100.59462944]
mat_Sqrt:  [[0.15]]
grads:  [0.15184165]
Stock Position:  0.15184164719586088
Bond Position:  [2.40763858]


portfolio before change:  [17.83538986]
curr_Stock_Price:  101.60223229677058
curr_Factors:  [101.6022323]
mat_Sqrt:  [[0.15]]
grads:  [0.02200673]
Stock Position:  0.022006726066584686
Bond Position:  [15.59945737]


portfolio before change:  [17.85691828]
curr_Stock_Price:  102.49188598097247
curr_Factors:  [102.49188598]
mat_Sqrt:  [[0.15]]
grads:  [0.1464198]
Stock Position:  0.1464198025322161
Bond Position:  [2.85007657]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.85691828]
Stock Price:  102.74375185936297
PL:  [15.11316642]
Settle:  Tensor("sub_162:0", shape=(), dtype=float64)
PL:  Tensor("sub_163:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  82
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-6.99082598e-03]
 [-5.20409646e-03]
 [ 2.20686661e-02]
 [-6.42953932e-03]
 [ 5.35764435e-03]
 [ 1.57886904e-02]
 [ 9.19362395e-03]
 [ 3.94202960e-04]
 [ 8.92194070e-03]
 [ 1.32902862e-02]
 [ 1.99297841e-02]
 [-1.32503090e-02]
 [-1.23858847e-02]
 [ 1.01597723e-03]
 [ 1.24067001e-04]
 [-2.85014473e-02]
 [ 4.92089917e-03]
 [-2.85550401e-03]
 [-1.39691490e-03]
 [-2.95773070e-03]
 [-1.56140921e-03]
 [-2.32939276e-02]
 [ 4.78128118e-03]
 [ 7.34706540e-03]
 [-4.58801049e-03]
 [-7.51009856e-03]
 [ 1.44695478e-02]
 [-2.32966400e-02]
 [-3.72825504e-02]
 [ 2.18861473e-02]
 [ 3.62780933e-03]
 [-2.49167906e-03]
 [-1.25134392e-02]
 [-9.49850791e-03]
 [-6.90028235e-03]
 [-4.68051070e-03]
 [ 1.92174745e-02]
 [ 9.12765372e-03]
 [ 2.06849011e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-27.22558825]
curr_Stock_Price:  98.12109581647975
curr_Factors:  [98.12109582]
mat_Sqrt:  [[0.15]]
grads:  [-0.04660551]
Stock Position:  -0.04660550650815995
Bond Position:  [-22.65260488]


portfolio before change:  [-27.25002574]
curr_Stock_Price:  98.58468339411156
curr_Factors:  [98.58468339]
mat_Sqrt:  [[0.15]]
grads:  [-0.03469398]
Stock Position:  -0.034693976400202255
Bond Position:  [-23.82973106]


portfolio before change:  [-27.3069676]
curr_Stock_Price:  100.14008181202409
curr_Factors:  [100.14008181]
mat_Sqrt:  [[0.15]]
grads:  [0.14712444]
Stock Position:  0.14712444043460166
Bond Position:  [-42.0400211]


portfolio before change:  [-27.381959]
curr_Stock_Price:  99.66608804007329
curr_Factors:  [99.66608804]
mat_Sqrt:  [[0.15]]
grads:  [-0.0428636]
Stock Position:  -0.04286359548610615
Bond Position:  [-23.10991212]


portfolio before change:  [-27.39495555]
curr_Stock_Price:  99.90189734420085
curr_Factors:  [99.90189734]
mat_Sqrt:  [[0.15]]
grads:  [0.03571763]
Stock Position:  0.03571762901286205
Bond Position:  [-30.96321446]


portfolio before change:  [-27.40384843]
curr_Stock_Price:  99.7612879154792
curr_Factors:  [99.76128792]
mat_Sqrt:  [[0.15]]
grads:  [0.10525794]
Stock Position:  0.1052579356832827
Bond Position:  [-37.90451566]


portfolio before change:  [-27.16301621]
curr_Stock_Price:  102.09432419447513
curr_Factors:  [102.09432419]
mat_Sqrt:  [[0.15]]
grads:  [0.06129083]
Stock Position:  0.061290826336168
Bond Position:  [-33.4204617]


portfolio before change:  [-27.16011244]
curr_Stock_Price:  102.20986498812692
curr_Factors:  [102.20986499]
mat_Sqrt:  [[0.15]]
grads:  [0.00262802]
Stock Position:  0.0026280197355768426
Bond Position:  [-27.42872198]


portfolio before change:  [-27.16297148]
curr_Stock_Price:  102.42666889386187
curr_Factors:  [102.42666889]
mat_Sqrt:  [[0.15]]
grads:  [0.0594796]
Stock Position:  0.05947960468486569
Bond Position:  [-33.25526925]


portfolio before change:  [-27.08369022]
curr_Stock_Price:  103.82947618039793
curr_Factors:  [103.82947618]
mat_Sqrt:  [[0.15]]
grads:  [0.08860191]
Stock Position:  0.08860190817136404
Bond Position:  [-36.28317994]


portfolio before change:  [-27.0663191]
curr_Stock_Price:  104.07672592774057
curr_Factors:  [104.07672593]
mat_Sqrt:  [[0.15]]
grads:  [0.13286523]
Stock Position:  0.1328652275514039
Bond Position:  [-40.89449698]


portfolio before change:  [-26.9938954]
curr_Stock_Price:  104.66029348134727
curr_Factors:  [104.66029348]
mat_Sqrt:  [[0.15]]
grads:  [-0.08833539]
Stock Position:  -0.08833539328034781
Bond Position:  [-17.74868721]


portfolio before change:  [-26.87740937]
curr_Stock_Price:  103.31649742466674
curr_Factors:  [103.31649742]
mat_Sqrt:  [[0.15]]
grads:  [-0.08257256]
Stock Position:  -0.08257256459567444
Bond Position:  [-18.34630121]


portfolio before change:  [-26.92536837]
curr_Stock_Price:  103.86953306356655
curr_Factors:  [103.86953306]
mat_Sqrt:  [[0.15]]
grads:  [0.00677318]
Stock Position:  0.0067731815429424545
Bond Position:  [-27.62889558]


portfolio before change:  [-26.93189273]
curr_Stock_Price:  103.41619691710653
curr_Factors:  [103.41619692]
mat_Sqrt:  [[0.15]]
grads:  [0.00082711]
Stock Position:  0.000827113339136153
Bond Position:  [-27.01742965]


portfolio before change:  [-26.93518885]
curr_Stock_Price:  103.5144579555811
curr_Factors:  [103.51445796]
mat_Sqrt:  [[0.15]]
grads:  [-0.19000965]
Stock Position:  -0.190009648668635
Bond Position:  [-7.26644306]


portfolio before change:  [-26.84499836]
curr_Stock_Price:  103.03501470632987
curr_Factors:  [103.03501471]
mat_Sqrt:  [[0.15]]
grads:  [0.03280599]
Stock Position:  0.03280599444263048
Bond Position:  [-30.22516448]


portfolio before change:  [-26.83974961]
curr_Stock_Price:  103.31018188940739
curr_Factors:  [103.31018189]
mat_Sqrt:  [[0.15]]
grads:  [-0.01903669]
Stock Position:  -0.01903669342681019
Bond Position:  [-24.87306535]


portfolio before change:  [-26.83499706]
curr_Stock_Price:  102.89719628220601
curr_Factors:  [102.89719628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00931277]
Stock Position:  -0.00931276598827346
Bond Position:  [-25.87673955]


portfolio before change:  [-26.84094785]
curr_Stock_Price:  103.18883833792123
curr_Factors:  [103.18883834]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197182]
Stock Position:  -0.01971820469665821
Bond Position:  [-24.80624921]


portfolio before change:  [-26.85658324]
curr_Stock_Price:  103.82451577199481
curr_Factors:  [103.82451577]
mat_Sqrt:  [[0.15]]
grads:  [-0.01040939]
Stock Position:  -0.010409394761888313
Bond Position:  [-25.77583287]


portfolio before change:  [-26.84031419]
curr_Stock_Price:  101.95205056811028
curr_Factors:  [101.95205057]
mat_Sqrt:  [[0.15]]
grads:  [-0.15529285]
Stock Position:  -0.15529285071674986
Bond Position:  [-11.00788962]


portfolio before change:  [-26.72506512]
curr_Stock_Price:  101.20104920923933
curr_Factors:  [101.20104921]
mat_Sqrt:  [[0.15]]
grads:  [0.03187521]
Stock Position:  0.031875207860342536
Bond Position:  [-29.9508696]


portfolio before change:  [-26.72576753]
curr_Stock_Price:  101.29647396283745
curr_Factors:  [101.29647396]
mat_Sqrt:  [[0.15]]
grads:  [0.04898044]
Stock Position:  0.04898043603180158
Bond Position:  [-31.687313]


portfolio before change:  [-26.78597164]
curr_Stock_Price:  100.14820034181108
curr_Factors:  [100.14820034]
mat_Sqrt:  [[0.15]]
grads:  [-0.03058674]
Stock Position:  -0.030586736567760505
Bond Position:  [-23.72276502]


portfolio before change:  [-26.76211657]
curr_Stock_Price:  99.27133027046293
curr_Factors:  [99.27133027]
mat_Sqrt:  [[0.15]]
grads:  [-0.05006732]
Stock Position:  -0.05006732375660305
Bond Position:  [-21.79186674]


portfolio before change:  [-26.78713391]
curr_Stock_Price:  99.71659438836551
curr_Factors:  [99.71659439]
mat_Sqrt:  [[0.15]]
grads:  [0.09646365]
Stock Position:  0.09646365231623183
Bond Position:  [-36.4061608]


portfolio before change:  [-26.89877013]
curr_Stock_Price:  98.6064854732956
curr_Factors:  [98.60648547]
mat_Sqrt:  [[0.15]]
grads:  [-0.15531093]
Stock Position:  -0.1553109335437434
Bond Position:  [-11.58410481]


portfolio before change:  [-26.88543873]
curr_Stock_Price:  98.51132476842636
curr_Factors:  [98.51132477]
mat_Sqrt:  [[0.15]]
grads:  [-0.24855034]
Stock Position:  -0.24855033590551284
Bond Position:  [-2.40041587]


portfolio before change:  [-26.92533637]
curr_Stock_Price:  98.67063884940141
curr_Factors:  [98.67063885]
mat_Sqrt:  [[0.15]]
grads:  [0.14590765]
Stock Position:  0.1459076488596743
Bond Position:  [-41.3221373]


portfolio before change:  [-27.11658036]
curr_Stock_Price:  97.39532257332955
curr_Factors:  [97.39532257]
mat_Sqrt:  [[0.15]]
grads:  [0.0241854]
Stock Position:  0.02418539550061545
Bond Position:  [-29.47212476]


portfolio before change:  [-27.09672765]
curr_Stock_Price:  98.36851120241388
curr_Factors:  [98.3685112]
mat_Sqrt:  [[0.15]]
grads:  [-0.01661119]
Stock Position:  -0.016611193724329953
Bond Position:  [-25.46270926]


portfolio before change:  [-27.07232715]
curr_Stock_Price:  96.70797158825069
curr_Factors:  [96.70797159]
mat_Sqrt:  [[0.15]]
grads:  [-0.08342293]
Stock Position:  -0.08342292776140935
Bond Position:  [-19.00466502]


portfolio before change:  [-27.02812812]
curr_Stock_Price:  96.14967472569862
curr_Factors:  [96.14967473]
mat_Sqrt:  [[0.15]]
grads:  [-0.06332339]
Stock Position:  -0.06332338604062268
Bond Position:  [-20.93960515]


portfolio before change:  [-27.06405343]
curr_Stock_Price:  96.67566829330477
curr_Factors:  [96.67566829]
mat_Sqrt:  [[0.15]]
grads:  [-0.04600188]
Stock Position:  -0.046001882339126894
Bond Position:  [-22.61679071]


portfolio before change:  [-27.01520325]
curr_Stock_Price:  95.55229141633885
curr_Factors:  [95.55229142]
mat_Sqrt:  [[0.15]]
grads:  [-0.0312034]
Stock Position:  -0.031203404641779096
Bond Position:  [-24.03364644]


portfolio before change:  [-27.01950179]
curr_Stock_Price:  95.59376587105376
curr_Factors:  [95.59376587]
mat_Sqrt:  [[0.15]]
grads:  [0.1281165]
Stock Position:  0.12811649669011385
Bond Position:  [-39.26664018]


portfolio before change:  [-26.93357959]
curr_Stock_Price:  96.30273655423751
curr_Factors:  [96.30273655]
mat_Sqrt:  [[0.15]]
grads:  [0.06085102]
Stock Position:  0.060851024814151736
Bond Position:  [-32.7936998]


portfolio before change:  [-26.95512322]
curr_Stock_Price:  96.01606649884289
curr_Factors:  [96.0160665]
mat_Sqrt:  [[0.15]]
grads:  [0.13789934]
Stock Position:  0.13789934069204407
Bond Position:  [-40.19567549]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-26.95512322]
Stock Price:  94.96727418014346
PL:  [-26.95512322]
Settle:  Tensor("sub_164:0", shape=(), dtype=float64)
PL:  Tensor("sub_165:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  83
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.53839671e-03]
 [-1.57894690e-02]
 [ 3.28744926e-03]
 [ 2.18598772e-02]
 [ 1.41053240e-02]
 [ 1.56335063e-02]
 [ 2.62231193e-02]
 [-2.13850706e-03]
 [ 3.09761306e-03]
 [ 8.66362806e-03]
 [ 2.38040499e-02]
 [ 4.24378206e-03]
 [-1.24654478e-02]
 [ 9.97702511e-03]
 [-7.18099045e-04]
 [-2.68221961e-02]
 [ 5.01058818e-03]
 [ 6.91917057e-04]
 [-9.62580418e-03]
 [-2.27944538e-03]
 [ 4.08851633e-04]
 [ 9.22156014e-03]
 [ 4.77539974e-03]
 [ 6.01177916e-03]
 [-3.45121506e-03]
 [-5.83860476e-03]
 [-4.66941211e-03]
 [-2.04009196e-02]
 [-3.02486410e-02]
 [ 2.18706298e-02]
 [ 2.78476816e-03]
 [-6.85856523e-03]
 [-1.25216353e-02]
 [-1.03099865e-02]
 [-6.98244097e-03]
 [-6.28946662e-03]
 [ 2.10792650e-02]
 [ 8.43680823e-03]
 [ 2.29004982e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.46376737]
curr_Stock_Price:  100.35585593281489
curr_Factors:  [100.35585593]
mat_Sqrt:  [[0.15]]
grads:  [-0.01025598]
Stock Position:  -0.010255978046993559
Bond Position:  [8.49301483]


portfolio before change:  [7.46509234]
curr_Stock_Price:  100.33018555442949
curr_Factors:  [100.33018555]
mat_Sqrt:  [[0.15]]
grads:  [-0.10526313]
Stock Position:  -0.10526312636082318
Bond Position:  [18.02616134]


portfolio before change:  [7.55237557]
curr_Stock_Price:  99.52240201118472
curr_Factors:  [99.52240201]
mat_Sqrt:  [[0.15]]
grads:  [0.02191633]
Stock Position:  0.0219163283918466
Bond Position:  [5.37120993]


portfolio before change:  [7.58878456]
curr_Stock_Price:  101.15303744523739
curr_Factors:  [101.15303745]
mat_Sqrt:  [[0.15]]
grads:  [0.14573251]
Stock Position:  0.14573251489973485
Bond Position:  [-7.15250198]


portfolio before change:  [7.51769718]
curr_Stock_Price:  100.67137926723682
curr_Factors:  [100.67137927]
mat_Sqrt:  [[0.15]]
grads:  [0.09403549]
Stock Position:  0.09403549315653598
Bond Position:  [-1.94898562]


portfolio before change:  [7.46963365]
curr_Stock_Price:  100.16284906571227
curr_Factors:  [100.16284907]
mat_Sqrt:  [[0.15]]
grads:  [0.10422338]
Stock Position:  0.10422337552299799
Bond Position:  [-2.96967658]


portfolio before change:  [7.51506862]
curr_Stock_Price:  100.60234929366435
curr_Factors:  [100.60234929]
mat_Sqrt:  [[0.15]]
grads:  [0.1748208]
Stock Position:  0.17482079511187817
Bond Position:  [-10.07231408]


portfolio before change:  [7.57441432]
curr_Stock_Price:  100.94901756691554
curr_Factors:  [100.94901757]
mat_Sqrt:  [[0.15]]
grads:  [-0.01425671]
Stock Position:  -0.014256713749151481
Bond Position:  [9.01361557]


portfolio before change:  [7.57687036]
curr_Stock_Price:  100.85578002560874
curr_Factors:  [100.85578003]
mat_Sqrt:  [[0.15]]
grads:  [0.02065075]
Stock Position:  0.020650753701716634
Bond Position:  [5.49412248]


portfolio before change:  [7.58080684]
curr_Stock_Price:  101.01314363527784
curr_Factors:  [101.01314364]
mat_Sqrt:  [[0.15]]
grads:  [0.05775752]
Stock Position:  0.057757520403717164
Bond Position:  [1.74653814]


portfolio before change:  [7.60120668]
curr_Stock_Price:  101.36256152502771
curr_Factors:  [101.36256153]
mat_Sqrt:  [[0.15]]
grads:  [0.15869367]
Stock Position:  0.15869366567439286
Bond Position:  [-8.48438977]


portfolio before change:  [7.74302749]
curr_Stock_Price:  102.26292145367735
curr_Factors:  [102.26292145]
mat_Sqrt:  [[0.15]]
grads:  [0.02829188]
Stock Position:  0.0282918803697876
Bond Position:  [4.84981715]


portfolio before change:  [7.77757359]
curr_Stock_Price:  103.46255316226802
curr_Factors:  [103.46255316]
mat_Sqrt:  [[0.15]]
grads:  [-0.08310299]
Stock Position:  -0.08310298545854569
Bond Position:  [16.37562064]


portfolio before change:  [7.84078392]
curr_Stock_Price:  102.72655975209814
curr_Factors:  [102.72655975]
mat_Sqrt:  [[0.15]]
grads:  [0.0665135]
Stock Position:  0.06651350076128985
Bond Position:  [1.00808081]


portfolio before change:  [7.86829604]
curr_Stock_Price:  103.13829722100733
curr_Factors:  [103.13829722]
mat_Sqrt:  [[0.15]]
grads:  [-0.00478733]
Stock Position:  -0.004787326969651311
Bond Position:  [8.36205279]


portfolio before change:  [7.87422269]
curr_Stock_Price:  102.11866184861651
curr_Factors:  [102.11866185]
mat_Sqrt:  [[0.15]]
grads:  [-0.17881464]
Stock Position:  -0.178814640741592
Bond Position:  [26.13453452]


portfolio before change:  [7.69454759]
curr_Stock_Price:  103.1417442903388
curr_Factors:  [103.14174429]
mat_Sqrt:  [[0.15]]
grads:  [0.03340392]
Stock Position:  0.03340392121937223
Bond Position:  [4.24920889]


portfolio before change:  [7.63532699]
curr_Stock_Price:  101.352978753253
curr_Factors:  [101.35297875]
mat_Sqrt:  [[0.15]]
grads:  [0.00461278]
Stock Position:  0.004612780377551536
Bond Position:  [7.16780796]


portfolio before change:  [7.63578089]
curr_Stock_Price:  101.2571292301134
curr_Factors:  [101.25712923]
mat_Sqrt:  [[0.15]]
grads:  [-0.06417203]
Stock Position:  -0.06417202785281978
Bond Position:  [14.13365621]


portfolio before change:  [7.62913218]
curr_Stock_Price:  101.3882692865185
curr_Factors:  [101.38826929]
mat_Sqrt:  [[0.15]]
grads:  [-0.0151963]
Stock Position:  -0.015196302512129427
Bond Position:  [9.16985899]


portfolio before change:  [7.64512987]
curr_Stock_Price:  100.41096661017679
curr_Factors:  [100.41096661]
mat_Sqrt:  [[0.15]]
grads:  [0.00272568]
Stock Position:  0.002725677556352435
Bond Position:  [7.37144196]


portfolio before change:  [7.64621282]
curr_Stock_Price:  100.47020265927435
curr_Factors:  [100.47020266]
mat_Sqrt:  [[0.15]]
grads:  [0.06147707]
Stock Position:  0.06147706756844921
Bond Position:  [1.46959938]


portfolio before change:  [7.64516228]
curr_Stock_Price:  100.45012603690608
curr_Factors:  [100.45012604]
mat_Sqrt:  [[0.15]]
grads:  [0.031836]
Stock Position:  0.0318359982962222
Bond Position:  [4.44723224]


portfolio before change:  [7.60613148]
curr_Stock_Price:  99.20666757018084
curr_Factors:  [99.20666757]
mat_Sqrt:  [[0.15]]
grads:  [0.04007853]
Stock Position:  0.04007852770447079
Bond Position:  [3.6300743]


portfolio before change:  [7.59763457]
curr_Stock_Price:  98.98333858859847
curr_Factors:  [98.98333859]
mat_Sqrt:  [[0.15]]
grads:  [-0.0230081]
Stock Position:  -0.023008100395418216
Bond Position:  [9.87505316]


portfolio before change:  [7.61369819]
curr_Stock_Price:  98.33881932976662
curr_Factors:  [98.33881933]
mat_Sqrt:  [[0.15]]
grads:  [-0.03892403]
Stock Position:  -0.03892403173648487
Bond Position:  [11.44144151]


portfolio before change:  [7.62394074]
curr_Stock_Price:  98.11242253007137
curr_Factors:  [98.11242253]
mat_Sqrt:  [[0.15]]
grads:  [-0.03112941]
Stock Position:  -0.031129414051160993
Bond Position:  [10.67812296]


portfolio before change:  [7.63538997]
curr_Stock_Price:  97.78750838242894
curr_Factors:  [97.78750838]
mat_Sqrt:  [[0.15]]
grads:  [-0.13600613]
Stock Position:  -0.1360061305748581
Bond Position:  [20.93509061]


portfolio before change:  [7.71410902]
curr_Stock_Price:  97.22796009651125
curr_Factors:  [97.2279601]
mat_Sqrt:  [[0.15]]
grads:  [-0.20165761]
Stock Position:  -0.20165760639658095
Bond Position:  [27.32086673]


portfolio before change:  [7.86700237]
curr_Stock_Price:  96.4867134363378
curr_Factors:  [96.48671344]
mat_Sqrt:  [[0.15]]
grads:  [0.1458042]
Stock Position:  0.14580419890737598
Bond Position:  [-6.20116559]


portfolio before change:  [7.87716075]
curr_Stock_Price:  96.56170149416273
curr_Factors:  [96.56170149]
mat_Sqrt:  [[0.15]]
grads:  [0.01856512]
Stock Position:  0.01856512109369327
Bond Position:  [6.08448107]


portfolio before change:  [7.87158734]
curr_Stock_Price:  96.22052348936737
curr_Factors:  [96.22052349]
mat_Sqrt:  [[0.15]]
grads:  [-0.04572377]
Stock Position:  -0.04572376820902532
Bond Position:  [12.27115226]


portfolio before change:  [7.84635222]
curr_Stock_Price:  96.80597649298342
curr_Factors:  [96.80597649]
mat_Sqrt:  [[0.15]]
grads:  [-0.08347757]
Stock Position:  -0.08347756835972897
Bond Position:  [15.92747974]


portfolio before change:  [7.82009476]
curr_Stock_Price:  97.1443729733515
curr_Factors:  [97.14437297]
mat_Sqrt:  [[0.15]]
grads:  [-0.06873324]
Stock Position:  -0.06873324356215586
Bond Position:  [14.49714261]


portfolio before change:  [7.84677036]
curr_Stock_Price:  96.78263616340791
curr_Factors:  [96.78263616]
mat_Sqrt:  [[0.15]]
grads:  [-0.04654961]
Stock Position:  -0.04654960644865803
Bond Position:  [12.35196399]


portfolio before change:  [7.84173935]
curr_Stock_Price:  96.92388552837102
curr_Factors:  [96.92388553]
mat_Sqrt:  [[0.15]]
grads:  [-0.04192978]
Stock Position:  -0.04192977743942048
Bond Position:  [11.9057363]


portfolio before change:  [7.81251421]
curr_Stock_Price:  97.65638297573776
curr_Factors:  [97.65638298]
mat_Sqrt:  [[0.15]]
grads:  [0.14052843]
Stock Position:  0.14052843302871026
Bond Position:  [-5.91098427]


portfolio before change:  [7.85067278]
curr_Stock_Price:  97.93317741883847
curr_Factors:  [97.93317742]
mat_Sqrt:  [[0.15]]
grads:  [0.05624539]
Stock Position:  0.0562453882158658
Bond Position:  [2.34238319]


portfolio before change:  [7.86624476]
curr_Stock_Price:  98.20482939522203
curr_Factors:  [98.2048294]
mat_Sqrt:  [[0.15]]
grads:  [0.15266999]
Stock Position:  0.152669987733917
Bond Position:  [-7.12668534]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.86624476]
Stock Price:  98.5010942231501
PL:  [7.86624476]
Settle:  Tensor("sub_166:0", shape=(), dtype=float64)
PL:  Tensor("sub_167:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  84
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.63107977e-03]
 [ 2.59261580e-03]
 [ 2.16481783e-02]
 [-3.75047137e-04]
 [ 1.64790541e-02]
 [ 2.90919611e-02]
 [ 2.10052702e-02]
 [-2.94940793e-03]
 [ 1.40592772e-02]
 [-4.08597582e-03]
 [ 1.38955763e-02]
 [ 1.05848847e-02]
 [-9.88144342e-03]
 [ 9.57821061e-03]
 [-3.87356469e-03]
 [-9.32757138e-03]
 [-2.44952668e-03]
 [-3.10952450e-03]
 [-9.44128635e-03]
 [-2.34910448e-03]
 [ 3.05181810e-04]
 [ 1.05986551e-02]
 [ 4.78042805e-03]
 [ 7.59379756e-03]
 [-3.73185739e-03]
 [-9.05380640e-03]
 [ 1.46125419e-02]
 [-2.00905743e-02]
 [-1.58377753e-02]
 [ 2.19374184e-02]
 [ 3.49104531e-03]
 [-4.58867447e-03]
 [-1.25355022e-02]
 [-7.48704148e-03]
 [-8.30664394e-03]
 [-7.36539646e-03]
 [ 2.12516248e-02]
 [ 8.35034395e-03]
 [ 2.32720479e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.89403085]
curr_Stock_Price:  99.68858512454486
curr_Factors:  [99.68858512]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754053]
Stock Position:  -0.017540531778329968
Bond Position:  [-1.14544006]


portfolio before change:  [-2.89371237]
curr_Stock_Price:  99.66226498926775
curr_Factors:  [99.66226499]
mat_Sqrt:  [[0.15]]
grads:  [0.01728411]
Stock Position:  0.01728410532520291
Bond Position:  [-4.61628546]


portfolio before change:  [-2.88644425]
curr_Stock_Price:  100.1161615739212
curr_Factors:  [100.11616157]
mat_Sqrt:  [[0.15]]
grads:  [0.14432119]
Stock Position:  0.14432118892807888
Bond Position:  [-17.33532772]


portfolio before change:  [-2.85231504]
curr_Stock_Price:  100.36765798868558
curr_Factors:  [100.36765799]
mat_Sqrt:  [[0.15]]
grads:  [-0.00250031]
Stock Position:  -0.0025003142448349015
Bond Position:  [-2.60136435]


portfolio before change:  [-2.85375138]
curr_Stock_Price:  100.81206139719583
curr_Factors:  [100.8120614]
mat_Sqrt:  [[0.15]]
grads:  [0.10986036]
Stock Position:  0.10986036086346375
Bond Position:  [-13.92900082]


portfolio before change:  [-2.76367603]
curr_Stock_Price:  101.64781852606176
curr_Factors:  [101.64781853]
mat_Sqrt:  [[0.15]]
grads:  [0.19394641]
Stock Position:  0.19394640706679916
Bond Position:  [-22.47790522]


portfolio before change:  [-2.86991231]
curr_Stock_Price:  101.11454561146826
curr_Factors:  [101.11454561]
mat_Sqrt:  [[0.15]]
grads:  [0.14003513]
Stock Position:  0.1400351348700261
Bond Position:  [-17.02950134]


portfolio before change:  [-3.08294079]
curr_Stock_Price:  99.60849743261677
curr_Factors:  [99.60849743]
mat_Sqrt:  [[0.15]]
grads:  [-0.01966272]
Stock Position:  -0.019662719543587164
Bond Position:  [-1.12436684]


portfolio before change:  [-3.08552816]
curr_Stock_Price:  99.73293665440214
curr_Factors:  [99.73293665]
mat_Sqrt:  [[0.15]]
grads:  [0.09372851]
Stock Position:  0.09372851449140876
Bond Position:  [-12.43334816]


portfolio before change:  [-3.12316933]
curr_Stock_Price:  99.34792148173582
curr_Factors:  [99.34792148]
mat_Sqrt:  [[0.15]]
grads:  [-0.02723984]
Stock Position:  -0.02723983882496372
Bond Position:  [-0.41694796]


portfolio before change:  [-3.15588083]
curr_Stock_Price:  100.54687807903176
curr_Factors:  [100.54687808]
mat_Sqrt:  [[0.15]]
grads:  [0.09263718]
Stock Position:  0.09263717511234594
Bond Position:  [-12.47025958]


portfolio before change:  [-3.24098674]
curr_Stock_Price:  99.64500437831383
curr_Factors:  [99.64500438]
mat_Sqrt:  [[0.15]]
grads:  [0.0705659]
Stock Position:  0.07056589798693952
Bond Position:  [-10.27252596]


portfolio before change:  [-3.19672871]
curr_Stock_Price:  100.29038943469267
curr_Factors:  [100.29038943]
mat_Sqrt:  [[0.15]]
grads:  [-0.06587629]
Stock Position:  -0.06587628949169234
Bond Position:  [3.41003001]


portfolio before change:  [-3.13991166]
curr_Stock_Price:  99.43437929325025
curr_Factors:  [99.43437929]
mat_Sqrt:  [[0.15]]
grads:  [0.06385474]
Stock Position:  0.06385473741568522
Bond Position:  [-9.48926784]


portfolio before change:  [-3.15672732]
curr_Stock_Price:  99.18961390907627
curr_Factors:  [99.18961391]
mat_Sqrt:  [[0.15]]
grads:  [-0.02582376]
Stock Position:  -0.02582376461453405
Bond Position:  [-0.59527808]


portfolio before change:  [-3.14611187]
curr_Stock_Price:  98.7756593384549
curr_Factors:  [98.77565934]
mat_Sqrt:  [[0.15]]
grads:  [-0.06218381]
Stock Position:  -0.0621838091873482
Bond Position:  [2.99613488]


portfolio before change:  [-3.15059268]
curr_Stock_Price:  98.85373984030298
curr_Factors:  [98.85373984]
mat_Sqrt:  [[0.15]]
grads:  [-0.01633018]
Stock Position:  -0.01633017786362923
Bond Position:  [-1.53629352]


portfolio before change:  [-3.15712294]
curr_Stock_Price:  99.24186890527646
curr_Factors:  [99.24186891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02073016]
Stock Position:  -0.020730163328946286
Bond Position:  [-1.09982279]


portfolio before change:  [-3.16169227]
curr_Stock_Price:  99.45565629961132
curr_Factors:  [99.4556563]
mat_Sqrt:  [[0.15]]
grads:  [-0.06294191]
Stock Position:  -0.06294190897713768
Bond Position:  [3.09823659]


portfolio before change:  [-3.14417923]
curr_Stock_Price:  99.18356830342178
curr_Factors:  [99.1835683]
mat_Sqrt:  [[0.15]]
grads:  [-0.0156607]
Stock Position:  -0.015660696533663063
Bond Position:  [-1.59089547]


portfolio before change:  [-3.145944]
curr_Stock_Price:  99.28355729783534
curr_Factors:  [99.2835573]
mat_Sqrt:  [[0.15]]
grads:  [0.00203455]
Stock Position:  0.002034545399425561
Bond Position:  [-3.34794091]


portfolio before change:  [-3.14523702]
curr_Stock_Price:  99.83675386943646
curr_Factors:  [99.83675387]
mat_Sqrt:  [[0.15]]
grads:  [0.0706577]
Stock Position:  0.07065770088015018
Bond Position:  [-10.19947251]


portfolio before change:  [-3.05906085]
curr_Stock_Price:  101.07442771128508
curr_Factors:  [101.07442771]
mat_Sqrt:  [[0.15]]
grads:  [0.03186952]
Stock Position:  0.03186952031670795
Bond Position:  [-6.28025437]


portfolio before change:  [-3.04002974]
curr_Stock_Price:  101.69621901163438
curr_Factors:  [101.69621901]
mat_Sqrt:  [[0.15]]
grads:  [0.05062532]
Stock Position:  0.05062531705293885
Bond Position:  [-8.18843307]


portfolio before change:  [-3.08986256]
curr_Stock_Price:  100.7320926251722
curr_Factors:  [100.73209263]
mat_Sqrt:  [[0.15]]
grads:  [-0.02487905]
Stock Position:  -0.024879049238559003
Bond Position:  [-0.58374387]


portfolio before change:  [-3.08274949]
curr_Stock_Price:  100.44325348827633
curr_Factors:  [100.44325349]
mat_Sqrt:  [[0.15]]
grads:  [-0.06035871]
Stock Position:  -0.06035870935386019
Bond Position:  [2.97987566]


portfolio before change:  [-3.04609022]
curr_Stock_Price:  99.84206829495933
curr_Factors:  [99.84206829]
mat_Sqrt:  [[0.15]]
grads:  [0.09741695]
Stock Position:  0.09741694567093308
Bond Position:  [-12.77239956]


portfolio before change:  [-3.00799327]
curr_Stock_Price:  100.2495292364913
curr_Factors:  [100.24952924]
mat_Sqrt:  [[0.15]]
grads:  [-0.13393716]
Stock Position:  -0.13393716193396296
Bond Position:  [10.41914416]


portfolio before change:  [-3.05397454]
curr_Stock_Price:  100.60255858442372
curr_Factors:  [100.60255858]
mat_Sqrt:  [[0.15]]
grads:  [-0.10558517]
Stock Position:  -0.10558516865025468
Bond Position:  [7.56816357]


portfolio before change:  [-2.83468686]
curr_Stock_Price:  98.53463937261725
curr_Factors:  [98.53463937]
mat_Sqrt:  [[0.15]]
grads:  [0.14624946]
Stock Position:  0.14624945590425825
Bond Position:  [-17.24532426]


portfolio before change:  [-3.02324529]
curr_Stock_Price:  97.26008674746018
curr_Factors:  [97.26008675]
mat_Sqrt:  [[0.15]]
grads:  [0.02327364]
Stock Position:  0.023273635385585384
Bond Position:  [-5.28684109]


portfolio before change:  [-3.01983067]
curr_Stock_Price:  97.4351996740254
curr_Factors:  [97.43519967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03059116]
Stock Position:  -0.030591163124436493
Bond Position:  [-0.03917459]


portfolio before change:  [-3.01040657]
curr_Stock_Price:  97.12697349589376
curr_Factors:  [97.1269735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08357001]
Stock Position:  -0.08357001439847354
Bond Position:  [5.106496]


portfolio before change:  [-3.15433241]
curr_Stock_Price:  98.85683065478653
curr_Factors:  [98.85683065]
mat_Sqrt:  [[0.15]]
grads:  [-0.04991361]
Stock Position:  -0.04991360987917072
Bond Position:  [1.77996887]


portfolio before change:  [-3.1366339]
curr_Stock_Price:  98.50670574515024
curr_Factors:  [98.50670575]
mat_Sqrt:  [[0.15]]
grads:  [-0.05537763]
Stock Position:  -0.05537762625982996
Bond Position:  [2.31843363]


portfolio before change:  [-3.09980142]
curr_Stock_Price:  97.84682441573572
curr_Factors:  [97.84682442]
mat_Sqrt:  [[0.15]]
grads:  [-0.04910264]
Stock Position:  -0.04910264308280768
Bond Position:  [1.70473628]


portfolio before change:  [-3.09847805]
curr_Stock_Price:  97.8242133303391
curr_Factors:  [97.82421333]
mat_Sqrt:  [[0.15]]
grads:  [0.1416775]
Stock Position:  0.14167749857192266
Bond Position:  [-16.95796789]


portfolio before change:  [-3.06591995]
curr_Stock_Price:  98.06898030138568
curr_Factors:  [98.0689803]
mat_Sqrt:  [[0.15]]
grads:  [0.05566896]
Stock Position:  0.05566895966330358
Bond Position:  [-8.52531806]


portfolio before change:  [-3.02331774]
curr_Stock_Price:  98.85340205042658
curr_Factors:  [98.85340205]
mat_Sqrt:  [[0.15]]
grads:  [0.15514699]
Stock Position:  0.15514698584922504
Bond Position:  [-18.36012511]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.02331774]
Stock Price:  99.95492339819064
PL:  [-3.02331774]
Settle:  Tensor("sub_168:0", shape=(), dtype=float64)
PL:  Tensor("sub_169:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  85
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.37510977e-03]
 [-2.03086014e-03]
 [-6.57688471e-03]
 [-6.84288826e-04]
 [ 8.01822995e-03]
 [ 1.53893765e-02]
 [ 2.48262390e-02]
 [-2.95443893e-03]
 [ 1.12573153e-02]
 [-4.08069100e-03]
 [ 4.61909078e-03]
 [ 1.14472737e-02]
 [-1.05884434e-02]
 [ 9.51783004e-03]
 [-5.98896788e-03]
 [-1.78196411e-02]
 [-2.36606741e-03]
 [-3.28937777e-03]
 [-1.16030905e-02]
 [-2.25060438e-03]
 [ 3.34218161e-04]
 [-1.77426933e-02]
 [ 4.77231080e-03]
 [ 6.99837400e-03]
 [-4.01974507e-03]
 [-2.85258732e-03]
 [-4.26494164e-03]
 [-6.26817777e-03]
 [ 3.75615896e-02]
 [ 2.60434422e-02]
 [-2.28496421e-02]
 [ 5.92717704e-03]
 [-1.30641617e-02]
 [ 6.83893780e-04]
 [-5.86892732e-03]
 [-7.86482894e-04]
 [ 2.41475767e-02]
 [-3.71367935e-04]
 [ 2.12440054e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.99714387]
curr_Stock_Price:  99.74636444130944
curr_Factors:  [99.74636444]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583407]
Stock Position:  -0.015834065129208832
Bond Position:  [-0.41775344]


portfolio before change:  [-1.99797697]
curr_Stock_Price:  99.79568121268473
curr_Factors:  [99.79568121]
mat_Sqrt:  [[0.15]]
grads:  [-0.01353907]
Stock Position:  -0.013539067572964214
Bond Position:  [-0.6468365]


portfolio before change:  [-2.01645373]
curr_Stock_Price:  101.1544083233956
curr_Factors:  [101.15440832]
mat_Sqrt:  [[0.15]]
grads:  [-0.0438459]
Stock Position:  -0.043845898091912874
Bond Position:  [2.41875215]


portfolio before change:  [-1.98021422]
curr_Stock_Price:  100.33478444921876
curr_Factors:  [100.33478445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00456193]
Stock Position:  -0.0045619255096413305
Bond Position:  [-1.52249441]


portfolio before change:  [-1.98040272]
curr_Stock_Price:  100.33438450360754
curr_Factors:  [100.3343845]
mat_Sqrt:  [[0.15]]
grads:  [0.05345487]
Stock Position:  0.053454866323121186
Bond Position:  [-7.34376383]


portfolio before change:  [-2.00727617]
curr_Stock_Price:  99.848826775073
curr_Factors:  [99.84882678]
mat_Sqrt:  [[0.15]]
grads:  [0.10259584]
Stock Position:  0.1025958431424754
Bond Position:  [-12.25135074]


portfolio before change:  [-2.03632403]
curr_Stock_Price:  99.58062550234122
curr_Factors:  [99.5806255]
mat_Sqrt:  [[0.15]]
grads:  [0.16550826]
Stock Position:  0.16550825978586622
Bond Position:  [-18.51774006]


portfolio before change:  [-2.03044004]
curr_Stock_Price:  99.63016291286368
curr_Factors:  [99.63016291]
mat_Sqrt:  [[0.15]]
grads:  [-0.01969626]
Stock Position:  -0.019696259510977376
Bond Position:  [-0.06809849]


portfolio before change:  [-2.03447193]
curr_Stock_Price:  99.83443441887603
curr_Factors:  [99.83443442]
mat_Sqrt:  [[0.15]]
grads:  [0.07504877]
Stock Position:  0.07504876838477309
Bond Position:  [-9.52692328]


portfolio before change:  [-2.04171494]
curr_Stock_Price:  99.75379269103723
curr_Factors:  [99.75379269]
mat_Sqrt:  [[0.15]]
grads:  [-0.02720461]
Stock Position:  -0.027204606637441238
Bond Position:  [0.67204775]


portfolio before change:  [-2.04434633]
curr_Stock_Price:  99.85360669594544
curr_Factors:  [99.8536067]
mat_Sqrt:  [[0.15]]
grads:  [0.03079394]
Stock Position:  0.0307939385385519
Bond Position:  [-5.11923215]


portfolio before change:  [-2.044288]
curr_Stock_Price:  99.87628234487471
curr_Factors:  [99.87628234]
mat_Sqrt:  [[0.15]]
grads:  [0.07631516]
Stock Position:  0.07631515786543834
Bond Position:  [-9.66636225]


portfolio before change:  [-1.9656055]
curr_Stock_Price:  100.92313682295604
curr_Factors:  [100.92313682]
mat_Sqrt:  [[0.15]]
grads:  [-0.07058962]
Stock Position:  -0.07058962251732057
Bond Position:  [5.15852063]


portfolio before change:  [-1.8581679]
curr_Stock_Price:  99.41026929019502
curr_Factors:  [99.41026929]
mat_Sqrt:  [[0.15]]
grads:  [0.0634522]
Stock Position:  0.06345220028201297
Bond Position:  [-8.16596822]


portfolio before change:  [-1.71865875]
curr_Stock_Price:  101.62500672103072
curr_Factors:  [101.62500672]
mat_Sqrt:  [[0.15]]
grads:  [-0.03992645]
Stock Position:  -0.03992645250488207
Bond Position:  [2.33886726]


portfolio before change:  [-1.66140259]
curr_Stock_Price:  100.19828881238624
curr_Factors:  [100.19828881]
mat_Sqrt:  [[0.15]]
grads:  [-0.11879761]
Stock Position:  -0.11879760720209741
Bond Position:  [10.24191437]


portfolio before change:  [-1.50360692]
curr_Stock_Price:  98.88079301972823
curr_Factors:  [98.88079302]
mat_Sqrt:  [[0.15]]
grads:  [-0.01577378]
Stock Position:  -0.01577378271727621
Bond Position:  [0.05611723]


portfolio before change:  [-1.52288713]
curr_Stock_Price:  100.1035323663674
curr_Factors:  [100.10353237]
mat_Sqrt:  [[0.15]]
grads:  [-0.02192919]
Stock Position:  -0.021929185153251575
Bond Position:  [0.67230177]


portfolio before change:  [-1.52894991]
curr_Stock_Price:  100.38383587426503
curr_Factors:  [100.38383587]
mat_Sqrt:  [[0.15]]
grads:  [-0.07735394]
Stock Position:  -0.07735393687493441
Bond Position:  [6.23613499]


portfolio before change:  [-1.46884935]
curr_Stock_Price:  99.61695827311239
curr_Factors:  [99.61695827]
mat_Sqrt:  [[0.15]]
grads:  [-0.01500403]
Stock Position:  -0.015004029197988242
Bond Position:  [0.02580641]


portfolio before change:  [-1.46740282]
curr_Stock_Price:  99.5207642299136
curr_Factors:  [99.52076423]
mat_Sqrt:  [[0.15]]
grads:  [0.00222812]
Stock Position:  0.002228121073799869
Bond Position:  [-1.68914713]


portfolio before change:  [-1.46273984]
curr_Stock_Price:  101.70831874355957
curr_Factors:  [101.70831874]
mat_Sqrt:  [[0.15]]
grads:  [-0.11828462]
Stock Position:  -0.11828462191298932
Bond Position:  [10.56779019]


portfolio before change:  [-1.28261678]
curr_Stock_Price:  100.19669365219205
curr_Factors:  [100.19669365]
mat_Sqrt:  [[0.15]]
grads:  [0.03181541]
Stock Position:  0.03181540534572358
Bond Position:  [-4.47041521]


portfolio before change:  [-1.26424696]
curr_Stock_Price:  100.79164639838346
curr_Factors:  [100.7916464]
mat_Sqrt:  [[0.15]]
grads:  [0.04665583]
Stock Position:  0.04665582666123071
Bond Position:  [-5.96676454]


portfolio before change:  [-1.22245178]
curr_Stock_Price:  101.70345247474879
curr_Factors:  [101.70345247]
mat_Sqrt:  [[0.15]]
grads:  [-0.0267983]
Stock Position:  -0.026798300492730597
Bond Position:  [1.5030279]


portfolio before change:  [-1.26221184]
curr_Stock_Price:  103.1941418895378
curr_Factors:  [103.19414189]
mat_Sqrt:  [[0.15]]
grads:  [-0.01901725]
Stock Position:  -0.01901724880544705
Bond Position:  [0.70025684]


portfolio before change:  [-1.26912114]
curr_Stock_Price:  103.56206279966092
curr_Factors:  [103.5620628]
mat_Sqrt:  [[0.15]]
grads:  [-0.02843294]
Stock Position:  -0.02843294428647479
Bond Position:  [1.67545322]


portfolio before change:  [-1.26622263]
curr_Stock_Price:  103.46748713066036
curr_Factors:  [103.46748713]
mat_Sqrt:  [[0.15]]
grads:  [-0.04178785]
Stock Position:  -0.04178785177941459
Bond Position:  [3.05746138]


portfolio before change:  [-1.32893682]
curr_Stock_Price:  104.97740920033281
curr_Factors:  [104.9774092]
mat_Sqrt:  [[0.15]]
grads:  [0.2504106]
Stock Position:  0.2504105970278813
Bond Position:  [-27.61639254]


portfolio before change:  [-1.24500066]
curr_Stock_Price:  105.3263897395772
curr_Factors:  [105.32638974]
mat_Sqrt:  [[0.15]]
grads:  [0.17362295]
Stock Position:  0.1736229482507166
Bond Position:  [-19.53207898]


portfolio before change:  [-1.22088176]
curr_Stock_Price:  105.47936818442648
curr_Factors:  [105.47936818]
mat_Sqrt:  [[0.15]]
grads:  [-0.15233095]
Stock Position:  -0.15233094762114469
Bond Position:  [14.84689035]


portfolio before change:  [-1.26803685]
curr_Stock_Price:  105.80110893717003
curr_Factors:  [105.80110894]
mat_Sqrt:  [[0.15]]
grads:  [0.03951451]
Stock Position:  0.03951451362539767
Bond Position:  [-5.44871622]


portfolio before change:  [-1.29934973]
curr_Stock_Price:  105.02590666650224
curr_Factors:  [105.02590667]
mat_Sqrt:  [[0.15]]
grads:  [-0.08709441]
Stock Position:  -0.0870944112026313
Bond Position:  [7.84781977]


portfolio before change:  [-1.22003794]
curr_Stock_Price:  104.12652925550825
curr_Factors:  [104.12652926]
mat_Sqrt:  [[0.15]]
grads:  [0.00455929]
Stock Position:  0.004559291865122127
Bond Position:  [-1.69478118]


portfolio before change:  [-1.22099591]
curr_Stock_Price:  103.96288299869278
curr_Factors:  [103.962883]
mat_Sqrt:  [[0.15]]
grads:  [-0.03912618]
Stock Position:  -0.039126182100345866
Bond Position:  [2.84667478]


portfolio before change:  [-1.21778615]
curr_Stock_Price:  103.88994189281635
curr_Factors:  [103.88994189]
mat_Sqrt:  [[0.15]]
grads:  [-0.00524322]
Stock Position:  -0.0052432192911868545
Bond Position:  [-0.6730684]


portfolio before change:  [-1.22278825]
curr_Stock_Price:  104.82790775859216
curr_Factors:  [104.82790776]
mat_Sqrt:  [[0.15]]
grads:  [0.16098384]
Stock Position:  0.16098384451520478
Bond Position:  [-18.09838785]


portfolio before change:  [-1.42178037]
curr_Stock_Price:  103.60586167203036
curr_Factors:  [103.60586167]
mat_Sqrt:  [[0.15]]
grads:  [-0.00247579]
Stock Position:  -0.002475786233263439
Bond Position:  [-1.1652744]


portfolio before change:  [-1.42107719]
curr_Stock_Price:  103.26300381910931
curr_Factors:  [103.26300382]
mat_Sqrt:  [[0.15]]
grads:  [0.1416267]
Stock Position:  0.14162670298635796
Bond Position:  [-16.04587596]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.42107719]
Stock Price:  103.1926261541021
PL:  [-4.61370335]
Settle:  Tensor("sub_170:0", shape=(), dtype=float64)
PL:  Tensor("sub_171:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  86
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.76321579e-03]
 [-1.66017604e-02]
 [-2.69789308e-03]
 [ 4.21330804e-02]
 [-2.06046614e-02]
 [ 3.33666149e-02]
 [ 2.96908694e-03]
 [ 4.48573681e-04]
 [ 4.87011097e-03]
 [ 1.15402985e-02]
 [ 2.68392589e-02]
 [ 4.98651707e-03]
 [-1.08858674e-02]
 [ 1.18085281e-02]
 [-6.48874506e-03]
 [-2.53149347e-02]
 [ 4.74789860e-03]
 [ 1.77566220e-03]
 [-3.80017895e-03]
 [-2.32248161e-03]
 [-3.43789333e-04]
 [ 5.04145324e-03]
 [ 4.77734917e-03]
 [ 6.12465651e-03]
 [-4.40520841e-03]
 [-7.39592602e-03]
 [ 2.83808305e-03]
 [-2.06056214e-02]
 [-3.41109291e-02]
 [ 2.20582799e-02]
 [ 4.14605241e-03]
 [-3.07509049e-03]
 [-1.25334778e-02]
 [-7.57065770e-03]
 [-8.22868076e-03]
 [-7.01263005e-03]
 [ 2.12011874e-02]
 [ 9.08811761e-03]
 [ 2.09685905e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.12668669]
curr_Stock_Price:  99.9476080742293
curr_Factors:  [99.94760807]
mat_Sqrt:  [[0.15]]
grads:  [-0.01175477]
Stock Position:  -0.011754771914416465
Bond Position:  [2.30154803]


portfolio before change:  [1.12346637]
curr_Stock_Price:  100.24604314552643
curr_Factors:  [100.24604315]
mat_Sqrt:  [[0.15]]
grads:  [-0.1106784]
Stock Position:  -0.11067840291132758
Bond Position:  [12.21853832]


portfolio before change:  [1.22143603]
curr_Stock_Price:  99.37466942162708
curr_Factors:  [99.37466942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01798595]
Stock Position:  -0.017985953850189904
Bond Position:  [3.00878425]


portfolio before change:  [1.17959446]
curr_Stock_Price:  101.72192843958123
curr_Factors:  [101.72192844]
mat_Sqrt:  [[0.15]]
grads:  [0.2808872]
Stock Position:  0.2808872025582845
Bond Position:  [-27.39279345]


portfolio before change:  [1.44190673]
curr_Stock_Price:  102.66798999139066
curr_Factors:  [102.66798999]
mat_Sqrt:  [[0.15]]
grads:  [-0.13736441]
Stock Position:  -0.13736440938271566
Bond Position:  [15.54483454]


portfolio before change:  [1.47338311]
curr_Stock_Price:  102.45299142885368
curr_Factors:  [102.45299143]
mat_Sqrt:  [[0.15]]
grads:  [0.2224441]
Stock Position:  0.2224440994953148
Bond Position:  [-21.31668031]


portfolio before change:  [1.65125138]
curr_Stock_Price:  103.264579706469
curr_Factors:  [103.26457971]
mat_Sqrt:  [[0.15]]
grads:  [0.01979391]
Stock Position:  0.01979391290619966
Bond Position:  [-0.39275872]


portfolio before change:  [1.63124117]
curr_Stock_Price:  102.25613255344153
curr_Factors:  [102.25613255]
mat_Sqrt:  [[0.15]]
grads:  [0.00299049]
Stock Position:  0.0029904912083813322
Bond Position:  [1.3254451]


portfolio before change:  [1.62925377]
curr_Stock_Price:  101.53615238824968
curr_Factors:  [101.53615239]
mat_Sqrt:  [[0.15]]
grads:  [0.03246741]
Stock Position:  0.03246740648646983
Bond Position:  [-1.66736177]


portfolio before change:  [1.64143177]
curr_Stock_Price:  101.9176563005016
curr_Factors:  [101.9176563]
mat_Sqrt:  [[0.15]]
grads:  [0.07693532]
Stock Position:  0.07693532314463086
Bond Position:  [-6.19963605]


portfolio before change:  [1.63680928]
curr_Stock_Price:  101.86764689071279
curr_Factors:  [101.86764689]
mat_Sqrt:  [[0.15]]
grads:  [0.17892839]
Stock Position:  0.178928392878152
Bond Position:  [-16.59020506]


portfolio before change:  [1.69217262]
curr_Stock_Price:  102.18865373401844
curr_Factors:  [102.18865373]
mat_Sqrt:  [[0.15]]
grads:  [0.03324345]
Stock Position:  0.03324344710516697
Bond Position:  [-1.70493049]


portfolio before change:  [1.65359206]
curr_Stock_Price:  101.03451884115857
curr_Factors:  [101.03451884]
mat_Sqrt:  [[0.15]]
grads:  [-0.07257245]
Stock Position:  -0.07257244915832524
Bond Position:  [8.98591455]


portfolio before change:  [1.67348421]
curr_Stock_Price:  100.77589680515385
curr_Factors:  [100.77589681]
mat_Sqrt:  [[0.15]]
grads:  [0.07872352]
Stock Position:  0.07872352075305292
Bond Position:  [-6.2599492]


portfolio before change:  [1.66095093]
curr_Stock_Price:  100.6266309633399
curr_Factors:  [100.62663096]
mat_Sqrt:  [[0.15]]
grads:  [-0.0432583]
Stock Position:  -0.04325830042405783
Bond Position:  [6.01388796]


portfolio before change:  [1.65132101]
curr_Stock_Price:  100.8666243725282
curr_Factors:  [100.86662437]
mat_Sqrt:  [[0.15]]
grads:  [-0.16876623]
Stock Position:  -0.16876623136844165
Bond Position:  [18.67420107]


portfolio before change:  [1.6992497]
curr_Stock_Price:  100.59646211459247
curr_Factors:  [100.59646211]
mat_Sqrt:  [[0.15]]
grads:  [0.03165266]
Stock Position:  0.031652657311316904
Bond Position:  [-1.48489565]


portfolio before change:  [1.72966079]
curr_Stock_Price:  101.56310200223112
curr_Factors:  [101.563102]
mat_Sqrt:  [[0.15]]
grads:  [0.01183775]
Stock Position:  0.011837748015213558
Bond Position:  [0.52738238]


portfolio before change:  [1.73938407]
curr_Stock_Price:  102.37891211431436
curr_Factors:  [102.37891211]
mat_Sqrt:  [[0.15]]
grads:  [-0.02533453]
Stock Position:  -0.02533452636578951
Bond Position:  [4.33310532]


portfolio before change:  [1.76027599]
curr_Stock_Price:  101.57565096465038
curr_Factors:  [101.57565096]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548321]
Stock Position:  -0.015483210718684026
Bond Position:  [3.33299319]


portfolio before change:  [1.75671449]
curr_Stock_Price:  101.83258419284766
curr_Factors:  [101.83258419]
mat_Sqrt:  [[0.15]]
grads:  [-0.00229193]
Stock Position:  -0.0022919288865018528
Bond Position:  [1.99010753]


portfolio before change:  [1.75913924]
curr_Stock_Price:  100.8831785947023
curr_Factors:  [100.88317859]
mat_Sqrt:  [[0.15]]
grads:  [0.03360969]
Stock Position:  0.033609688235729324
Bond Position:  [-1.63151295]


portfolio before change:  [1.75044789]
curr_Stock_Price:  100.6306504479979
curr_Factors:  [100.63065045]
mat_Sqrt:  [[0.15]]
grads:  [0.03184899]
Stock Position:  0.0318489944802509
Bond Position:  [-1.45453714]


portfolio before change:  [1.7187686]
curr_Stock_Price:  99.64168785843447
curr_Factors:  [99.64168786]
mat_Sqrt:  [[0.15]]
grads:  [0.04083104]
Stock Position:  0.0408310433669323
Bond Position:  [-2.34970548]


portfolio before change:  [1.7353306]
curr_Stock_Price:  100.05450445551966
curr_Factors:  [100.05450446]
mat_Sqrt:  [[0.15]]
grads:  [-0.02936806]
Stock Position:  -0.029368056085077674
Bond Position:  [4.6737369]


portfolio before change:  [1.76299914]
curr_Stock_Price:  99.1322680652893
curr_Factors:  [99.13226807]
mat_Sqrt:  [[0.15]]
grads:  [-0.04930617]
Stock Position:  -0.04930617349403006
Bond Position:  [6.65083195]


portfolio before change:  [1.7793643]
curr_Stock_Price:  98.81722131996334
curr_Factors:  [98.81722132]
mat_Sqrt:  [[0.15]]
grads:  [0.01892055]
Stock Position:  0.018920553681654042
Bond Position:  [-0.09031224]


portfolio before change:  [1.76303722]
curr_Stock_Price:  97.95488996560258
curr_Factors:  [97.95488997]
mat_Sqrt:  [[0.15]]
grads:  [-0.13737081]
Stock Position:  -0.13737080939705434
Bond Position:  [15.21917974]


portfolio before change:  [1.74316093]
curr_Stock_Price:  98.11343026045827
curr_Factors:  [98.11343026]
mat_Sqrt:  [[0.15]]
grads:  [-0.22740619]
Stock Position:  -0.227406193796648
Bond Position:  [24.05476267]


portfolio before change:  [1.72328709]
curr_Stock_Price:  98.21404702594037
curr_Factors:  [98.21404703]
mat_Sqrt:  [[0.15]]
grads:  [0.1470552]
Stock Position:  0.14705519961096208
Bond Position:  [-12.7195992]


portfolio before change:  [1.71202787]
curr_Stock_Price:  98.14829507002857
curr_Factors:  [98.14829507]
mat_Sqrt:  [[0.15]]
grads:  [0.02764035]
Stock Position:  0.027640349370651303
Bond Position:  [-1.00082529]


portfolio before change:  [1.71081253]
curr_Stock_Price:  98.10885177972294
curr_Factors:  [98.10885178]
mat_Sqrt:  [[0.15]]
grads:  [-0.0205006]
Stock Position:  -0.020500603287219095
Bond Position:  [3.72210318]


portfolio before change:  [1.69605817]
curr_Stock_Price:  98.85125230046233
curr_Factors:  [98.8512523]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355652]
Stock Position:  -0.08355651892864485
Bond Position:  [9.9557247]


portfolio before change:  [1.70201211]
curr_Stock_Price:  98.79489045852861
curr_Factors:  [98.79489046]
mat_Sqrt:  [[0.15]]
grads:  [-0.05047105]
Stock Position:  -0.05047105130797049
Bond Position:  [6.6882941]


portfolio before change:  [1.72251628]
curr_Stock_Price:  98.40520020428892
curr_Factors:  [98.4052002]
mat_Sqrt:  [[0.15]]
grads:  [-0.05485787]
Stock Position:  -0.05485787175852843
Bond Position:  [7.12081613]


portfolio before change:  [1.77084951]
curr_Stock_Price:  97.5403640107578
curr_Factors:  [97.54036401]
mat_Sqrt:  [[0.15]]
grads:  [-0.04675087]
Stock Position:  -0.046750866977350654
Bond Position:  [6.33094609]


portfolio before change:  [1.76066675]
curr_Stock_Price:  97.77510141476262
curr_Factors:  [97.77510141]
mat_Sqrt:  [[0.15]]
grads:  [0.14134125]
Stock Position:  0.14134124944652376
Bond Position:  [-12.05898825]


portfolio before change:  [1.56519983]
curr_Stock_Price:  96.40282370751716
curr_Factors:  [96.40282371]
mat_Sqrt:  [[0.15]]
grads:  [0.06058745]
Stock Position:  0.060587450764810646
Bond Position:  [-4.2756015]


portfolio before change:  [1.55404311]
curr_Stock_Price:  96.22750296780451
curr_Factors:  [96.22750297]
mat_Sqrt:  [[0.15]]
grads:  [0.1397906]
Stock Position:  0.1397906032980797
Bond Position:  [-11.89765758]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.55404311]
Stock Price:  95.49642965616705
PL:  [1.55404311]
Settle:  Tensor("sub_172:0", shape=(), dtype=float64)
PL:  Tensor("sub_173:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  87
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.29077906e-03]
 [-3.47713462e-03]
 [ 3.46964197e-04]
 [ 1.80615242e-02]
 [ 8.03788282e-03]
 [ 2.55643228e-02]
 [ 2.24127094e-02]
 [-2.96405923e-03]
 [ 7.39943453e-03]
 [ 5.05143508e-03]
 [ 1.55431222e-02]
 [ 1.19583174e-02]
 [-9.93734845e-03]
 [ 1.20876199e-02]
 [-5.56635524e-03]
 [-1.16322900e-02]
 [ 3.91330160e-03]
 [-1.88571405e-03]
 [-7.25433391e-03]
 [-2.21628685e-03]
 [ 4.11507169e-04]
 [ 9.39330877e-03]
 [ 4.77534425e-03]
 [ 6.72070119e-03]
 [-3.56986700e-03]
 [-8.68523949e-03]
 [ 1.28742838e-02]
 [-2.57307491e-02]
 [-1.60585266e-02]
 [ 2.19285413e-02]
 [ 7.98460579e-03]
 [ 6.38230819e-03]
 [-1.24478135e-02]
 [-5.32930387e-03]
 [-7.85554262e-03]
 [-7.48023264e-03]
 [ 2.24488622e-02]
 [ 8.29803081e-03]
 [ 2.43310935e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.64523379]
curr_Stock_Price:  100.88292294016432
curr_Factors:  [100.88292294]
mat_Sqrt:  [[0.15]]
grads:  [-0.01527186]
Stock Position:  -0.015271860385722905
Bond Position:  [17.18590371]


portfolio before change:  [15.63985426]
curr_Stock_Price:  101.3758497565892
curr_Factors:  [101.37584976]
mat_Sqrt:  [[0.15]]
grads:  [-0.0231809]
Stock Position:  -0.023180897440711938
Bond Position:  [17.98983743]


portfolio before change:  [15.61653916]
curr_Stock_Price:  102.4786530728043
curr_Factors:  [102.47865307]
mat_Sqrt:  [[0.15]]
grads:  [0.00231309]
Stock Position:  0.002313094648719923
Bond Position:  [15.37949633]


portfolio before change:  [15.61513058]
curr_Stock_Price:  101.03853193486347
curr_Factors:  [101.03853193]
mat_Sqrt:  [[0.15]]
grads:  [0.12041016]
Stock Position:  0.12041016124095211
Bond Position:  [3.44906466]


portfolio before change:  [15.5308915]
curr_Stock_Price:  100.33535006677222
curr_Factors:  [100.33535007]
mat_Sqrt:  [[0.15]]
grads:  [0.05358589]
Stock Position:  0.05358588544547074
Bond Position:  [10.15433292]


portfolio before change:  [15.56389819]
curr_Stock_Price:  100.92762022565827
curr_Factors:  [100.92762023]
mat_Sqrt:  [[0.15]]
grads:  [0.17042882]
Stock Position:  0.17042881865073112
Bond Position:  [-1.6370769]


portfolio before change:  [15.30490639]
curr_Stock_Price:  99.40917310888995
curr_Factors:  [99.40917311]
mat_Sqrt:  [[0.15]]
grads:  [0.14941806]
Stock Position:  0.1494180625129069
Bond Position:  [0.45138035]


portfolio before change:  [15.34417291]
curr_Stock_Price:  99.67159178366263
curr_Factors:  [99.67159178]
mat_Sqrt:  [[0.15]]
grads:  [-0.01976039]
Stock Position:  -0.019760394852533565
Bond Position:  [17.31372292]


portfolio before change:  [15.33477598]
curr_Stock_Price:  100.25666487151796
curr_Factors:  [100.25666487]
mat_Sqrt:  [[0.15]]
grads:  [0.04932956]
Stock Position:  0.049329563511087235
Bond Position:  [10.38915847]


portfolio before change:  [15.35275509]
curr_Stock_Price:  100.59480647760847
curr_Factors:  [100.59480648]
mat_Sqrt:  [[0.15]]
grads:  [0.03367623]
Stock Position:  0.033676233887510315
Bond Position:  [11.96510086]


portfolio before change:  [15.3570189]
curr_Stock_Price:  100.677003262143
curr_Factors:  [100.67700326]
mat_Sqrt:  [[0.15]]
grads:  [0.10362081]
Stock Position:  0.10362081499330068
Bond Position:  [4.92478577]


portfolio before change:  [15.29429284]
curr_Stock_Price:  100.06571974810066
curr_Factors:  [100.06571975]
mat_Sqrt:  [[0.15]]
grads:  [0.07972212]
Stock Position:  0.07972211589263113
Bond Position:  [7.31684193]


portfolio before change:  [15.31803852]
curr_Stock_Price:  100.35210229721159
curr_Factors:  [100.3521023]
mat_Sqrt:  [[0.15]]
grads:  [-0.06624899]
Stock Position:  -0.06624898965108712
Bond Position:  [21.96626391]


portfolio before change:  [15.33126454]
curr_Stock_Price:  100.19391021082177
curr_Factors:  [100.19391021]
mat_Sqrt:  [[0.15]]
grads:  [0.08058413]
Stock Position:  0.0805841323535587
Bond Position:  [7.25722522]


portfolio before change:  [15.33650738]
curr_Stock_Price:  100.24771269392105
curr_Factors:  [100.24771269]
mat_Sqrt:  [[0.15]]
grads:  [-0.03710903]
Stock Position:  -0.03710903490964693
Bond Position:  [19.05660325]


portfolio before change:  [15.36321902]
curr_Stock_Price:  99.59209279525385
curr_Factors:  [99.5920928]
mat_Sqrt:  [[0.15]]
grads:  [-0.0775486]
Stock Position:  -0.07754860028719729
Bond Position:  [23.08644642]


portfolio before change:  [15.31727637]
curr_Stock_Price:  100.22174488646617
curr_Factors:  [100.22174489]
mat_Sqrt:  [[0.15]]
grads:  [0.02608868]
Stock Position:  0.026088677332609552
Bond Position:  [12.70262361]


portfolio before change:  [15.33417907]
curr_Stock_Price:  100.80877245417885
curr_Factors:  [100.80877245]
mat_Sqrt:  [[0.15]]
grads:  [-0.01257143]
Stock Position:  -0.012571426980140112
Bond Position:  [16.60148919]


portfolio before change:  [15.32588017]
curr_Stock_Price:  101.63399445959044
curr_Factors:  [101.63399446]
mat_Sqrt:  [[0.15]]
grads:  [-0.04836223]
Stock Position:  -0.048362226041661106
Bond Position:  [20.24112638]


portfolio before change:  [15.37669671]
curr_Stock_Price:  100.635565624035
curr_Factors:  [100.63556562]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477525]
Stock Position:  -0.01477524564362076
Bond Position:  [16.86361191]


portfolio before change:  [15.38551597]
curr_Stock_Price:  100.18134777493428
curr_Factors:  [100.18134777]
mat_Sqrt:  [[0.15]]
grads:  [0.00274338]
Stock Position:  0.0027433811266827624
Bond Position:  [15.11068035]


portfolio before change:  [15.38806682]
curr_Stock_Price:  100.42261578776055
curr_Factors:  [100.42261579]
mat_Sqrt:  [[0.15]]
grads:  [0.06262206]
Stock Position:  0.06262205848731747
Bond Position:  [9.0993959]


portfolio before change:  [15.39065901]
curr_Stock_Price:  100.44584551646118
curr_Factors:  [100.44584552]
mat_Sqrt:  [[0.15]]
grads:  [0.03183563]
Stock Position:  0.031835628345586515
Bond Position:  [12.1929024]


portfolio before change:  [15.38969213]
curr_Stock_Price:  100.36759707465417
curr_Factors:  [100.36759707]
mat_Sqrt:  [[0.15]]
grads:  [0.04480467]
Stock Position:  0.04480467458065101
Bond Position:  [10.8927546]


portfolio before change:  [15.4111274]
curr_Stock_Price:  100.81562156652738
curr_Factors:  [100.81562157]
mat_Sqrt:  [[0.15]]
grads:  [-0.02379911]
Stock Position:  -0.023799113331103534
Bond Position:  [17.8104498]


portfolio before change:  [15.42768847]
curr_Stock_Price:  100.21330400806717
curr_Factors:  [100.21330401]
mat_Sqrt:  [[0.15]]
grads:  [-0.0579016]
Stock Position:  -0.0579015965684765
Bond Position:  [21.23019877]


portfolio before change:  [15.42525261]
curr_Stock_Price:  100.30120821860048
curr_Factors:  [100.30120822]
mat_Sqrt:  [[0.15]]
grads:  [0.08582856]
Stock Position:  0.08582855894242318
Bond Position:  [6.81654445]


portfolio before change:  [15.36500061]
curr_Stock_Price:  99.58927596755022
curr_Factors:  [99.58927597]
mat_Sqrt:  [[0.15]]
grads:  [-0.17153833]
Stock Position:  -0.17153832732843832
Bond Position:  [32.44837843]


portfolio before change:  [15.17000296]
curr_Stock_Price:  100.74968107821309
curr_Factors:  [100.74968108]
mat_Sqrt:  [[0.15]]
grads:  [-0.10705684]
Stock Position:  -0.10705684397945767
Bond Position:  [25.95594585]


portfolio before change:  [15.15006339]
curr_Stock_Price:  100.96624149096307
curr_Factors:  [100.96624149]
mat_Sqrt:  [[0.15]]
grads:  [0.14619028]
Stock Position:  0.14619027502986254
Bond Position:  [0.38978077]


portfolio before change:  [15.10650519]
curr_Stock_Price:  100.66795270408309
curr_Factors:  [100.6679527]
mat_Sqrt:  [[0.15]]
grads:  [0.05323071]
Stock Position:  0.053230705245789725
Bond Position:  [9.74787907]


portfolio before change:  [15.20129957]
curr_Stock_Price:  102.42588204627391
curr_Factors:  [102.42588205]
mat_Sqrt:  [[0.15]]
grads:  [0.04254872]
Stock Position:  0.04254872129293261
Bond Position:  [10.84320926]


portfolio before change:  [15.13086926]
curr_Stock_Price:  100.73873864547083
curr_Factors:  [100.73873865]
mat_Sqrt:  [[0.15]]
grads:  [-0.08298542]
Stock Position:  -0.08298542360892482
Bond Position:  [23.49071616]


portfolio before change:  [15.16788658]
curr_Stock_Price:  100.3280545282495
curr_Factors:  [100.32805453]
mat_Sqrt:  [[0.15]]
grads:  [-0.03552869]
Stock Position:  -0.035528692482637916
Bond Position:  [18.73241118]


portfolio before change:  [15.18904042]
curr_Stock_Price:  99.79856287438803
curr_Factors:  [99.79856287]
mat_Sqrt:  [[0.15]]
grads:  [-0.05237028]
Stock Position:  -0.052370284143895274
Bond Position:  [20.41551952]


portfolio before change:  [15.19218768]
curr_Stock_Price:  99.78719845928629
curr_Factors:  [99.78719846]
mat_Sqrt:  [[0.15]]
grads:  [-0.04986822]
Stock Position:  -0.049868217576264494
Bond Position:  [20.16839741]


portfolio before change:  [15.22095373]
curr_Stock_Price:  99.26091447251181
curr_Factors:  [99.26091447]
mat_Sqrt:  [[0.15]]
grads:  [0.14965908]
Stock Position:  0.1496590814493176
Bond Position:  [0.36565645]


portfolio before change:  [15.19812198]
curr_Stock_Price:  99.10805061176575
curr_Factors:  [99.10805061]
mat_Sqrt:  [[0.15]]
grads:  [0.05532021]
Stock Position:  0.05532020537416032
Bond Position:  [9.71544426]


portfolio before change:  [15.25805739]
curr_Stock_Price:  100.16952362030165
curr_Factors:  [100.16952362]
mat_Sqrt:  [[0.15]]
grads:  [0.16220729]
Stock Position:  0.1622072898220588
Bond Position:  [-0.99016956]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.25805739]
Stock Price:  99.66556835546102
PL:  [15.25805739]
Settle:  Tensor("sub_174:0", shape=(), dtype=float64)
PL:  Tensor("sub_175:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  88
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.57564739e-03]
 [-5.68951270e-03]
 [-6.28201130e-03]
 [ 1.73225133e-02]
 [-5.51211003e-03]
 [ 3.14754171e-02]
 [ 2.34931105e-02]
 [-2.14542113e-03]
 [ 2.82194641e-03]
 [-4.41695480e-03]
 [ 6.70799637e-03]
 [ 6.07250079e-03]
 [ 4.61794286e-03]
 [ 1.05038125e-02]
 [-4.17311788e-03]
 [-1.47374378e-02]
 [ 4.70185366e-03]
 [-3.42867604e-03]
 [-9.34883936e-03]
 [-2.22421604e-03]
 [ 1.87662328e-04]
 [-1.21701941e-02]
 [ 4.78060548e-03]
 [ 7.57846885e-03]
 [-4.21628074e-03]
 [-7.22011166e-03]
 [-7.12041534e-04]
 [-1.70833963e-02]
 [-1.58951104e-02]
 [ 2.15724113e-02]
 [ 9.25503629e-03]
 [ 1.06556352e-03]
 [-1.25316501e-02]
 [-1.02335228e-02]
 [-6.47384481e-03]
 [-6.49120413e-03]
 [ 2.11854211e-02]
 [ 8.82237947e-03]
 [ 2.24824636e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.46470837]
curr_Stock_Price:  100.03380620118985
curr_Factors:  [100.0338062]
mat_Sqrt:  [[0.15]]
grads:  [-0.01050432]
Stock Position:  -0.010504315919261532
Bond Position:  [3.51549508]


portfolio before change:  [2.46662054]
curr_Stock_Price:  99.89360594594929
curr_Factors:  [99.89360595]
mat_Sqrt:  [[0.15]]
grads:  [-0.03793008]
Stock Position:  -0.03793008468614331
Bond Position:  [6.25559348]


portfolio before change:  [2.41723333]
curr_Stock_Price:  101.21628195951381
curr_Factors:  [101.21628196]
mat_Sqrt:  [[0.15]]
grads:  [-0.04188008]
Stock Position:  -0.04188007531599882
Bond Position:  [6.65617884]


portfolio before change:  [2.42643752]
curr_Stock_Price:  101.01637506352434
curr_Factors:  [101.01637506]
mat_Sqrt:  [[0.15]]
grads:  [0.11548342]
Stock Position:  0.11548342202252429
Bond Position:  [-9.23927915]


portfolio before change:  [2.55132708]
curr_Stock_Price:  102.10782650226054
curr_Factors:  [102.1078265]
mat_Sqrt:  [[0.15]]
grads:  [-0.0367474]
Stock Position:  -0.036747400196326295
Bond Position:  [6.30352425]


portfolio before change:  [2.55210572]
curr_Stock_Price:  102.10808107066791
curr_Factors:  [102.10808107]
mat_Sqrt:  [[0.15]]
grads:  [0.20983611]
Stock Position:  0.20983611385273707
Bond Position:  [-18.87385721]


portfolio before change:  [2.30139207]
curr_Stock_Price:  100.92451804255612
curr_Factors:  [100.92451804]
mat_Sqrt:  [[0.15]]
grads:  [0.15662074]
Stock Position:  0.15662073695910342
Bond Position:  [-13.50548032]


portfolio before change:  [2.30309036]
curr_Stock_Price:  100.94614084478714
curr_Factors:  [100.94614084]
mat_Sqrt:  [[0.15]]
grads:  [-0.01430281]
Stock Position:  -0.014302807537635253
Bond Position:  [3.74690359]


portfolio before change:  [2.30188718]
curr_Stock_Price:  101.0630115316623
curr_Factors:  [101.06301153]
mat_Sqrt:  [[0.15]]
grads:  [0.01881298]
Stock Position:  0.01881297605306826
Bond Position:  [0.40059116]


portfolio before change:  [2.27384166]
curr_Stock_Price:  99.56959597674775
curr_Factors:  [99.56959598]
mat_Sqrt:  [[0.15]]
grads:  [-0.02944637]
Stock Position:  -0.02944636533535282
Bond Position:  [5.20580436]


portfolio before change:  [2.28083736]
curr_Stock_Price:  99.35412187193272
curr_Factors:  [99.35412187]
mat_Sqrt:  [[0.15]]
grads:  [0.04471998]
Stock Position:  0.04471997581273463
Bond Position:  [-2.16227657]


portfolio before change:  [2.27224515]
curr_Stock_Price:  99.16803261421049
curr_Factors:  [99.16803261]
mat_Sqrt:  [[0.15]]
grads:  [0.04048334]
Stock Position:  0.04048333861724564
Bond Position:  [-1.7424079]


portfolio before change:  [2.24282836]
curr_Stock_Price:  98.44677366869024
curr_Factors:  [98.44677367]
mat_Sqrt:  [[0.15]]
grads:  [0.03078629]
Stock Position:  0.030786285753855436
Bond Position:  [-0.78798214]


portfolio before change:  [2.2556114]
curr_Stock_Price:  98.86519177082027
curr_Factors:  [98.86519177]
mat_Sqrt:  [[0.15]]
grads:  [0.07002542]
Stock Position:  0.07002541686069733
Bond Position:  [-4.66746487]


portfolio before change:  [2.29781505]
curr_Stock_Price:  99.47621442938978
curr_Factors:  [99.47621443]
mat_Sqrt:  [[0.15]]
grads:  [-0.02782079]
Stock Position:  -0.02782078587386256
Bond Position:  [5.06532151]


portfolio before change:  [2.28582717]
curr_Stock_Price:  99.92987078680584
curr_Factors:  [99.92987079]
mat_Sqrt:  [[0.15]]
grads:  [-0.09824959]
Stock Position:  -0.09824958564486465
Bond Position:  [12.10389557]


portfolio before change:  [2.20751954]
curr_Stock_Price:  100.7422988419572
curr_Factors:  [100.74229884]
mat_Sqrt:  [[0.15]]
grads:  [0.03134569]
Stock Position:  0.03134569104049669
Bond Position:  [-0.95031744]


portfolio before change:  [2.19226632]
curr_Stock_Price:  100.25947598223576
curr_Factors:  [100.25947598]
mat_Sqrt:  [[0.15]]
grads:  [-0.02285784]
Stock Position:  -0.022857840277772497
Bond Position:  [4.48398141]


portfolio before change:  [2.21166575]
curr_Stock_Price:  99.43529928785668
curr_Factors:  [99.43529929]
mat_Sqrt:  [[0.15]]
grads:  [-0.0623256]
Stock Position:  -0.062325595721168955
Bond Position:  [8.40903002]


portfolio before change:  [2.15971854]
curr_Stock_Price:  100.28564669088662
curr_Factors:  [100.28564669]
mat_Sqrt:  [[0.15]]
grads:  [-0.01482811]
Stock Position:  -0.014828106941197483
Bond Position:  [3.64676483]


portfolio before change:  [2.14833888]
curr_Stock_Price:  101.08382889373696
curr_Factors:  [101.08382889]
mat_Sqrt:  [[0.15]]
grads:  [0.00125108]
Stock Position:  0.0012510821863908703
Bond Position:  [2.02187471]


portfolio before change:  [2.14907408]
curr_Stock_Price:  101.46945050005793
curr_Factors:  [101.4694505]
mat_Sqrt:  [[0.15]]
grads:  [-0.08113463]
Stock Position:  -0.08113462749100839
Bond Position:  [10.38176015]


portfolio before change:  [2.18004988]
curr_Stock_Price:  101.10366344542797
curr_Factors:  [101.10366345]
mat_Sqrt:  [[0.15]]
grads:  [0.0318707]
Stock Position:  0.0318707031956256
Bond Position:  [-1.04219497]


portfolio before change:  [2.19801325]
curr_Stock_Price:  101.67138409163637
curr_Factors:  [101.67138409]
mat_Sqrt:  [[0.15]]
grads:  [0.05052313]
Stock Position:  0.05052312569700049
Bond Position:  [-2.93874287]


portfolio before change:  [2.20799525]
curr_Stock_Price:  101.87622826284424
curr_Factors:  [101.87622826]
mat_Sqrt:  [[0.15]]
grads:  [-0.02810854]
Stock Position:  -0.028108538237789357
Bond Position:  [5.07158711]


portfolio before change:  [2.22117385]
curr_Stock_Price:  101.42993657247321
curr_Factors:  [101.42993657]
mat_Sqrt:  [[0.15]]
grads:  [-0.04813408]
Stock Position:  -0.048134077737825194
Bond Position:  [7.1034103]


portfolio before change:  [2.17835468]
curr_Stock_Price:  102.33796585138445
curr_Factors:  [102.33796585]
mat_Sqrt:  [[0.15]]
grads:  [-0.00474694]
Stock Position:  -0.004746943559345499
Bond Position:  [2.66414722]


portfolio before change:  [2.18217872]
curr_Stock_Price:  101.60254370617747
curr_Factors:  [101.60254371]
mat_Sqrt:  [[0.15]]
grads:  [-0.11388931]
Stock Position:  -0.11388930875331908
Bond Position:  [13.75362219]


portfolio before change:  [2.29343374]
curr_Stock_Price:  100.64077031705308
curr_Factors:  [100.64077032]
mat_Sqrt:  [[0.15]]
grads:  [-0.1059674]
Stock Position:  -0.10596740295548047
Bond Position:  [12.9580748]


portfolio before change:  [2.34223443]
curr_Stock_Price:  100.19553118544023
curr_Factors:  [100.19553119]
mat_Sqrt:  [[0.15]]
grads:  [0.14381608]
Stock Position:  0.14381607529862642
Bond Position:  [-12.06749362]


portfolio before change:  [2.27438164]
curr_Stock_Price:  99.73421794305072
curr_Factors:  [99.73421794]
mat_Sqrt:  [[0.15]]
grads:  [0.06170024]
Stock Position:  0.06170024192795829
Bond Position:  [-3.87924373]


portfolio before change:  [2.27585279]
curr_Stock_Price:  99.76592090325452
curr_Factors:  [99.7659209]
mat_Sqrt:  [[0.15]]
grads:  [0.00710376]
Stock Position:  0.007103756833093597
Bond Position:  [1.56713995]


portfolio before change:  [2.27261466]
curr_Stock_Price:  99.2825103984914
curr_Factors:  [99.2825104]
mat_Sqrt:  [[0.15]]
grads:  [-0.08354433]
Stock Position:  -0.08354433384401708
Bond Position:  [10.56710586]


portfolio before change:  [2.42253477]
curr_Stock_Price:  97.50382441057828
curr_Factors:  [97.50382441]
mat_Sqrt:  [[0.15]]
grads:  [-0.06822349]
Stock Position:  -0.06822348515771248
Bond Position:  [9.07458549]


portfolio before change:  [2.52059828]
curr_Stock_Price:  96.08306564599553
curr_Factors:  [96.08306565]
mat_Sqrt:  [[0.15]]
grads:  [-0.04315897]
Stock Position:  -0.04315896540392729
Bond Position:  [6.66744398]


portfolio before change:  [2.47772053]
curr_Stock_Price:  97.09586163879476
curr_Factors:  [97.09586164]
mat_Sqrt:  [[0.15]]
grads:  [-0.04327469]
Stock Position:  -0.043274694172812024
Bond Position:  [6.67951425]


portfolio before change:  [2.44982598]
curr_Stock_Price:  97.75974940519335
curr_Factors:  [97.75974941]
mat_Sqrt:  [[0.15]]
grads:  [0.14123614]
Stock Position:  0.1412361405390379
Bond Position:  [-11.35738372]


portfolio before change:  [2.38022679]
curr_Stock_Price:  97.2770158121156
curr_Factors:  [97.27701581]
mat_Sqrt:  [[0.15]]
grads:  [0.05881586]
Stock Position:  0.05881586316439018
Bond Position:  [-3.34120486]


portfolio before change:  [2.40006724]
curr_Stock_Price:  97.62144877072711
curr_Factors:  [97.62144877]
mat_Sqrt:  [[0.15]]
grads:  [0.14988309]
Stock Position:  0.14988309068423405
Bond Position:  [-12.23173722]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.40006724]
Stock Price:  96.88234314084018
PL:  [2.40006724]
Settle:  Tensor("sub_176:0", shape=(), dtype=float64)
PL:  Tensor("sub_177:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  89
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44823451e-03]
 [-1.21437242e-02]
 [ 1.20693261e-02]
 [-2.50418137e-02]
 [ 1.51335537e-02]
 [ 2.27902563e-02]
 [ 1.04975444e-02]
 [-6.09732564e-03]
 [ 9.04308646e-03]
 [-1.28120710e-04]
 [ 9.36105139e-03]
 [ 1.29923417e-03]
 [ 6.88487120e-03]
 [ 7.31608039e-03]
 [ 7.80710424e-03]
 [-9.92590817e-03]
 [-1.01607959e-02]
 [-1.35175287e-05]
 [-7.59238441e-03]
 [-2.38084158e-03]
 [ 4.28454118e-04]
 [ 8.64703738e-03]
 [ 4.76712339e-03]
 [ 5.73853727e-03]
 [-3.61698720e-03]
 [-6.22991173e-03]
 [-1.72994822e-05]
 [-2.60468513e-02]
 [-3.62570182e-02]
 [ 2.20495315e-02]
 [ 4.09076951e-03]
 [-3.39814993e-03]
 [-1.25334912e-02]
 [-7.89211371e-03]
 [-8.62094574e-03]
 [-7.51877655e-03]
 [ 2.22918390e-02]
 [ 8.91792440e-03]
 [ 2.11806870e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.97164896]
curr_Stock_Price:  100.1953085043491
curr_Factors:  [100.1953085]
mat_Sqrt:  [[0.15]]
grads:  [-0.0096549]
Stock Position:  -0.009654896707393765
Bond Position:  [5.93902431]


portfolio before change:  [4.9689663]
curr_Stock_Price:  100.55005922623549
curr_Factors:  [100.55005923]
mat_Sqrt:  [[0.15]]
grads:  [-0.08095816]
Stock Position:  -0.08095816118623952
Bond Position:  [13.1093142]


portfolio before change:  [5.03612358]
curr_Stock_Price:  99.74077067984061
curr_Factors:  [99.74077068]
mat_Sqrt:  [[0.15]]
grads:  [0.08046217]
Stock Position:  0.08046217393947395
Bond Position:  [-2.98923566]


portfolio before change:  [4.92981647]
curr_Stock_Price:  98.42420880347663
curr_Factors:  [98.4242088]
mat_Sqrt:  [[0.15]]
grads:  [-0.16694542]
Stock Position:  -0.16694542448277733
Bond Position:  [21.36128779]


portfolio before change:  [4.94254928]
curr_Stock_Price:  98.36393469247183
curr_Factors:  [98.36393469]
mat_Sqrt:  [[0.15]]
grads:  [0.10089036]
Stock Position:  0.10089035826080754
Bond Position:  [-4.98142333]


portfolio before change:  [4.93805275]
curr_Stock_Price:  98.32553836075002
curr_Factors:  [98.32553836]
mat_Sqrt:  [[0.15]]
grads:  [0.15193504]
Stock Position:  0.1519350423231172
Bond Position:  [-10.00104208]


portfolio before change:  [4.94172554]
curr_Stock_Price:  98.35794035180376
curr_Factors:  [98.35794035]
mat_Sqrt:  [[0.15]]
grads:  [0.06998363]
Stock Position:  0.06998362939095146
Bond Position:  [-1.94172011]


portfolio before change:  [4.90884592]
curr_Stock_Price:  97.89159010747215
curr_Factors:  [97.89159011]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064884]
Stock Position:  -0.040648837604969165
Bond Position:  [8.88802527]


portfolio before change:  [4.91714848]
curr_Stock_Price:  97.71467289279065
curr_Factors:  [97.71467289]
mat_Sqrt:  [[0.15]]
grads:  [0.06028724]
Stock Position:  0.06028724307205374
Bond Position:  [-0.97379976]


portfolio before change:  [4.93151873]
curr_Stock_Price:  97.95505523588874
curr_Factors:  [97.95505524]
mat_Sqrt:  [[0.15]]
grads:  [-0.00085414]
Stock Position:  -0.0008541380634746281
Bond Position:  [5.01518587]


portfolio before change:  [4.93114139]
curr_Stock_Price:  99.13083205440049
curr_Factors:  [99.13083205]
mat_Sqrt:  [[0.15]]
grads:  [0.06240701]
Stock Position:  0.06240700927191703
Bond Position:  [-1.25531736]


portfolio before change:  [4.88876786]
curr_Stock_Price:  98.45435978099137
curr_Factors:  [98.45435978]
mat_Sqrt:  [[0.15]]
grads:  [0.00866156]
Stock Position:  0.008661561101580019
Bond Position:  [4.0359994]


portfolio before change:  [4.88525829]
curr_Stock_Price:  97.99092132532587
curr_Factors:  [97.99092133]
mat_Sqrt:  [[0.15]]
grads:  [0.04589914]
Stock Position:  0.045899141313499044
Bond Position:  [0.38755914]


portfolio before change:  [4.84831468]
curr_Stock_Price:  97.18497905359466
curr_Factors:  [97.18497905]
mat_Sqrt:  [[0.15]]
grads:  [0.04877387]
Stock Position:  0.048773869255356775
Bond Position:  [0.10822722]


portfolio before change:  [4.83676927]
curr_Stock_Price:  96.94798877726416
curr_Factors:  [96.94798878]
mat_Sqrt:  [[0.15]]
grads:  [0.05204736]
Stock Position:  0.052047361598726145
Bond Position:  [-0.20911775]


portfolio before change:  [4.80629437]
curr_Stock_Price:  96.36296844701933
curr_Factors:  [96.36296845]
mat_Sqrt:  [[0.15]]
grads:  [-0.06617272]
Stock Position:  -0.06617272112891086
Bond Position:  [11.18289421]


portfolio before change:  [4.84635894]
curr_Stock_Price:  95.77863964791835
curr_Factors:  [95.77863965]
mat_Sqrt:  [[0.15]]
grads:  [-0.06773864]
Stock Position:  -0.06773863903303715
Bond Position:  [11.33427364]


portfolio before change:  [4.77612094]
curr_Stock_Price:  96.83645366135987
curr_Factors:  [96.83645366]
mat_Sqrt:  [[0.15]]
grads:  [-9.01168578e-05]
Stock Position:  -9.011685777461397e-05
Bond Position:  [4.78484753]


portfolio before change:  [4.77667691]
curr_Stock_Price:  97.30436240311602
curr_Factors:  [97.3043624]
mat_Sqrt:  [[0.15]]
grads:  [-0.0506159]
Stock Position:  -0.0506158960765377
Bond Position:  [9.70182441]


portfolio before change:  [4.74098275]
curr_Stock_Price:  98.03351994080903
curr_Factors:  [98.03351994]
mat_Sqrt:  [[0.15]]
grads:  [-0.01587228]
Stock Position:  -0.015872277178996193
Bond Position:  [6.29699796]


portfolio before change:  [4.74755911]
curr_Stock_Price:  97.66878440381916
curr_Factors:  [97.6687844]
mat_Sqrt:  [[0.15]]
grads:  [0.00285636]
Stock Position:  0.002856360789581702
Bond Position:  [4.46858183]


portfolio before change:  [4.75064437]
curr_Stock_Price:  98.55335283610833
curr_Factors:  [98.55335284]
mat_Sqrt:  [[0.15]]
grads:  [0.05764692]
Stock Position:  0.05764691584032894
Bond Position:  [-0.93065247]


portfolio before change:  [4.74214449]
curr_Stock_Price:  98.40792377776006
curr_Factors:  [98.40792378]
mat_Sqrt:  [[0.15]]
grads:  [0.03178082]
Stock Position:  0.03178082262664326
Bond Position:  [1.61465972]


portfolio before change:  [4.73473774]
curr_Stock_Price:  98.16851551896717
curr_Factors:  [98.16851552]
mat_Sqrt:  [[0.15]]
grads:  [0.03825692]
Stock Position:  0.0382569151056788
Bond Position:  [0.97911318]


portfolio before change:  [4.74491369]
curr_Stock_Price:  98.43130597298511
curr_Factors:  [98.43130597]
mat_Sqrt:  [[0.15]]
grads:  [-0.02411325]
Stock Position:  -0.024113247988051256
Bond Position:  [7.11841218]


portfolio before change:  [4.74192306]
curr_Stock_Price:  98.5922338179503
curr_Factors:  [98.59223382]
mat_Sqrt:  [[0.15]]
grads:  [-0.04153274]
Stock Position:  -0.04153274487916689
Bond Position:  [8.83672915]


portfolio before change:  [4.74315413]
curr_Stock_Price:  98.58919015393134
curr_Factors:  [98.58919015]
mat_Sqrt:  [[0.15]]
grads:  [-0.00011533]
Stock Position:  -0.00011532988106034464
Bond Position:  [4.75452441]


portfolio before change:  [4.7436718]
curr_Stock_Price:  99.25407134047914
curr_Factors:  [99.25407134]
mat_Sqrt:  [[0.15]]
grads:  [-0.17364568]
Stock Position:  -0.17364567553874996
Bond Position:  [21.97871207]


portfolio before change:  [4.74626302]
curr_Stock_Price:  99.25497143040793
curr_Factors:  [99.25497143]
mat_Sqrt:  [[0.15]]
grads:  [-0.24171345]
Stock Position:  -0.2417134544254827
Bond Position:  [28.73752503]


portfolio before change:  [4.99585169]
curr_Stock_Price:  98.23725289181824
curr_Factors:  [98.23725289]
mat_Sqrt:  [[0.15]]
grads:  [0.14699688]
Stock Position:  0.14699687638340062
Bond Position:  [-9.44471763]


portfolio before change:  [4.9767618]
curr_Stock_Price:  98.11541878618087
curr_Factors:  [98.11541879]
mat_Sqrt:  [[0.15]]
grads:  [0.0272718]
Stock Position:  0.027271796739469757
Bond Position:  [2.30097804]


portfolio before change:  [4.97294909]
curr_Stock_Price:  97.96506744110455
curr_Factors:  [97.96506744]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265433]
Stock Position:  -0.02265433287584872
Bond Position:  [7.19228233]


portfolio before change:  [4.96567712]
curr_Stock_Price:  98.32575152818565
curr_Factors:  [98.32575153]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355661]
Stock Position:  -0.08355660768658324
Bond Position:  [13.18144337]


portfolio before change:  [4.9480221]
curr_Stock_Price:  98.55676620519081
curr_Factors:  [98.55676621]
mat_Sqrt:  [[0.15]]
grads:  [-0.05261409]
Stock Position:  -0.05261409140199572
Bond Position:  [10.13349681]


portfolio before change:  [4.92973973]
curr_Stock_Price:  98.92832335463778
curr_Factors:  [98.92832335]
mat_Sqrt:  [[0.15]]
grads:  [-0.05747297]
Stock Position:  -0.05747297158556021
Bond Position:  [10.61544444]


portfolio before change:  [4.92741404]
curr_Stock_Price:  98.99187837497072
curr_Factors:  [98.99187837]
mat_Sqrt:  [[0.15]]
grads:  [-0.05012518]
Stock Position:  -0.05012517698869118
Bond Position:  [9.88939947]


portfolio before change:  [4.93250242]
curr_Stock_Price:  98.91502831985551
curr_Factors:  [98.91502832]
mat_Sqrt:  [[0.15]]
grads:  [0.14861226]
Stock Position:  0.14861225970004233
Bond Position:  [-9.76748346]


portfolio before change:  [4.64114209]
curr_Stock_Price:  96.96270406062156
curr_Factors:  [96.96270406]
mat_Sqrt:  [[0.15]]
grads:  [0.05945283]
Stock Position:  0.059452829339998715
Bond Position:  [-1.12356501]


portfolio before change:  [4.60669001]
curr_Stock_Price:  96.38558054015522
curr_Factors:  [96.38558054]
mat_Sqrt:  [[0.15]]
grads:  [0.14120458]
Stock Position:  0.14120457981267082
Bond Position:  [-9.00339539]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.60669001]
Stock Price:  96.68432335576148
PL:  [4.60669001]
Settle:  Tensor("sub_178:0", shape=(), dtype=float64)
PL:  Tensor("sub_179:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  90
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.95344871e-03]
 [-1.20739072e-02]
 [-5.99298527e-03]
 [-6.49370236e-03]
 [ 1.45299068e-02]
 [ 2.41714112e-02]
 [ 1.81346977e-02]
 [-3.33056293e-03]
 [ 1.14979977e-02]
 [-3.90275328e-05]
 [-2.89685590e-03]
 [-2.23757967e-03]
 [ 4.73299005e-03]
 [ 1.03929765e-02]
 [-1.57653823e-04]
 [-9.46590603e-03]
 [-2.02498979e-03]
 [-3.06116150e-03]
 [-7.50595069e-03]
 [-2.40993588e-03]
 [ 3.32203371e-04]
 [ 1.07882414e-02]
 [ 4.77056162e-03]
 [ 6.11741974e-03]
 [-4.00260466e-03]
 [-9.31026355e-03]
 [ 4.78765447e-03]
 [-1.23841820e-02]
 [ 1.02108902e-02]
 [ 2.20648996e-02]
 [ 7.12479025e-03]
 [ 2.61416155e-03]
 [-1.24981758e-02]
 [-4.92164747e-03]
 [-5.47097623e-03]
 [-4.02224034e-03]
 [ 2.31601594e-02]
 [-2.37897871e-04]
 [ 2.14395763e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.02160954]
curr_Stock_Price:  99.87363245339958
curr_Factors:  [99.87363245]
mat_Sqrt:  [[0.15]]
grads:  [-0.01302299]
Stock Position:  -0.013022991387064727
Bond Position:  [1.27904392]


portfolio before change:  [-0.03031358]
curr_Stock_Price:  100.55426986540226
curr_Factors:  [100.55426987]
mat_Sqrt:  [[0.15]]
grads:  [-0.08049271]
Stock Position:  -0.08049271465291791
Bond Position:  [8.06357257]


portfolio before change:  [0.07198774]
curr_Stock_Price:  99.29585397618786
curr_Factors:  [99.29585398]
mat_Sqrt:  [[0.15]]
grads:  [-0.03995324]
Stock Position:  -0.039953235114257676
Bond Position:  [4.03917834]


portfolio before change:  [0.05923726]
curr_Stock_Price:  99.62762701400638
curr_Factors:  [99.62762701]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329135]
Stock Position:  -0.04329134904335044
Bond Position:  [4.37225164]


portfolio before change:  [0.10240155]
curr_Stock_Price:  98.64318741121856
curr_Factors:  [98.64318741]
mat_Sqrt:  [[0.15]]
grads:  [0.09686605]
Stock Position:  0.09686604526694102
Bond Position:  [-9.45277391]


portfolio before change:  [0.00442411]
curr_Stock_Price:  97.64391298973432
curr_Factors:  [97.64391299]
mat_Sqrt:  [[0.15]]
grads:  [0.16114274]
Stock Position:  0.16114274101819434
Bond Position:  [-15.73018367]


portfolio before change:  [0.20976895]
curr_Stock_Price:  98.93041979091021
curr_Factors:  [98.93041979]
mat_Sqrt:  [[0.15]]
grads:  [0.12089798]
Stock Position:  0.1208979843388026
Bond Position:  [-11.75071939]


portfolio before change:  [0.21444325]
curr_Stock_Price:  98.9812331589157
curr_Factors:  [98.98123316]
mat_Sqrt:  [[0.15]]
grads:  [-0.02220375]
Stock Position:  -0.022203752850781775
Bond Position:  [2.41219809]


portfolio before change:  [0.23474871]
curr_Stock_Price:  98.08030837334618
curr_Factors:  [98.08030837]
mat_Sqrt:  [[0.15]]
grads:  [0.07665332]
Stock Position:  0.07665331782686995
Bond Position:  [-7.28343234]


portfolio before change:  [0.21261074]
curr_Stock_Price:  97.8033800080765
curr_Factors:  [97.80338001]
mat_Sqrt:  [[0.15]]
grads:  [-0.00026018]
Stock Position:  -0.00026018355205505975
Bond Position:  [0.23805757]


portfolio before change:  [0.21258796]
curr_Stock_Price:  98.00534241776394
curr_Factors:  [98.00534242]
mat_Sqrt:  [[0.15]]
grads:  [-0.01931237]
Stock Position:  -0.019312372635317036
Bond Position:  [2.10530365]


portfolio before change:  [0.21391203]
curr_Stock_Price:  97.95040923903743
curr_Factors:  [97.95040924]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149172]
Stock Position:  -0.01491719780759174
Bond Position:  [1.67505766]


portfolio before change:  [0.20686327]
curr_Stock_Price:  98.43697191975666
curr_Factors:  [98.43697192]
mat_Sqrt:  [[0.15]]
grads:  [0.03155327]
Stock Position:  0.031553267000100096
Bond Position:  [-2.89914479]


portfolio before change:  [0.19742854]
curr_Stock_Price:  98.14944822980443
curr_Factors:  [98.14944823]
mat_Sqrt:  [[0.15]]
grads:  [0.06928651]
Stock Position:  0.0692865101359446
Bond Position:  [-6.6030042]


portfolio before change:  [0.20647557]
curr_Stock_Price:  98.29193566201809
curr_Factors:  [98.29193566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00105103]
Stock Position:  -0.0010510254853324705
Bond Position:  [0.3097829]


portfolio before change:  [0.20576949]
curr_Stock_Price:  99.00058553147348
curr_Factors:  [99.00058553]
mat_Sqrt:  [[0.15]]
grads:  [-0.06310604]
Stock Position:  -0.06310604023287486
Bond Position:  [6.45330442]


portfolio before change:  [0.2070341]
curr_Stock_Price:  98.99332951931483
curr_Factors:  [98.99332952]
mat_Sqrt:  [[0.15]]
grads:  [-0.01349993]
Stock Position:  -0.01349993192746013
Bond Position:  [1.54343731]


portfolio before change:  [0.21067222]
curr_Stock_Price:  98.7381300731011
curr_Factors:  [98.73813007]
mat_Sqrt:  [[0.15]]
grads:  [-0.02040774]
Stock Position:  -0.020407743325463686
Bond Position:  [2.22569463]


portfolio before change:  [0.22044112]
curr_Stock_Price:  98.27307756915194
curr_Factors:  [98.27307757]
mat_Sqrt:  [[0.15]]
grads:  [-0.05003967]
Stock Position:  -0.05003967127284404
Bond Position:  [5.13799361]


portfolio before change:  [0.20680957]
curr_Stock_Price:  98.55832797212867
curr_Factors:  [98.55832797]
mat_Sqrt:  [[0.15]]
grads:  [-0.01606624]
Stock Position:  -0.016066239207788935
Bond Position:  [1.79027124]


portfolio before change:  [0.19178938]
curr_Stock_Price:  99.50714890040716
curr_Factors:  [99.5071489]
mat_Sqrt:  [[0.15]]
grads:  [0.00221469]
Stock Position:  0.0022146891408340026
Bond Position:  [-0.02858802]


portfolio before change:  [0.19191593]
curr_Stock_Price:  99.56590320567801
curr_Factors:  [99.56590321]
mat_Sqrt:  [[0.15]]
grads:  [0.07192161]
Stock Position:  0.07192160918183775
Bond Position:  [-6.96902405]


portfolio before change:  [0.22286195]
curr_Stock_Price:  100.00829043494325
curr_Factors:  [100.00829043]
mat_Sqrt:  [[0.15]]
grads:  [0.03180374]
Stock Position:  0.03180374410923224
Bond Position:  [-2.95777613]


portfolio before change:  [0.21051496]
curr_Stock_Price:  99.63169181164857
curr_Factors:  [99.63169181]
mat_Sqrt:  [[0.15]]
grads:  [0.0407828]
Stock Position:  0.04078279824135772
Bond Position:  [-3.85274423]


portfolio before change:  [0.24975888]
curr_Stock_Price:  100.60576771629854
curr_Factors:  [100.60576772]
mat_Sqrt:  [[0.15]]
grads:  [-0.02668403]
Stock Position:  -0.026684031071592288
Bond Position:  [2.93432631]


portfolio before change:  [0.25029763]
curr_Stock_Price:  100.59932436224562
curr_Factors:  [100.59932436]
mat_Sqrt:  [[0.15]]
grads:  [-0.06206842]
Stock Position:  -0.06206842365187164
Bond Position:  [6.49433911]


portfolio before change:  [0.18581768]
curr_Stock_Price:  101.65125681794005
curr_Factors:  [101.65125682]
mat_Sqrt:  [[0.15]]
grads:  [0.0319177]
Stock Position:  0.03191769646043833
Bond Position:  [-3.05865628]


portfolio before change:  [0.21200032]
curr_Stock_Price:  102.48355371628433
curr_Factors:  [102.48355372]
mat_Sqrt:  [[0.15]]
grads:  [-0.08256121]
Stock Position:  -0.0825612131496446
Bond Position:  [8.67316685]


portfolio before change:  [0.14844987]
curr_Stock_Price:  103.26642336297166
curr_Factors:  [103.26642336]
mat_Sqrt:  [[0.15]]
grads:  [0.0680726]
Stock Position:  0.06807260165041273
Bond Position:  [-6.88116423]


portfolio before change:  [0.00480205]
curr_Stock_Price:  101.16884492408334
curr_Factors:  [101.16884492]
mat_Sqrt:  [[0.15]]
grads:  [0.14709933]
Stock Position:  0.14709933090778113
Bond Position:  [-14.87706735]


portfolio before change:  [-0.02327647]
curr_Stock_Price:  100.9906063883304
curr_Factors:  [100.99060639]
mat_Sqrt:  [[0.15]]
grads:  [0.0474986]
Stock Position:  0.047498601651750745
Bond Position:  [-4.82018905]


portfolio before change:  [-0.05626573]
curr_Stock_Price:  100.30876104294651
curr_Factors:  [100.30876104]
mat_Sqrt:  [[0.15]]
grads:  [0.01742774]
Stock Position:  0.017427743649631493
Bond Position:  [-1.8044211]


portfolio before change:  [-0.06114092]
curr_Stock_Price:  100.04196651420243
curr_Factors:  [100.04196651]
mat_Sqrt:  [[0.15]]
grads:  [-0.08332117]
Stock Position:  -0.08332117223818447
Bond Position:  [8.274473]


portfolio before change:  [-0.10228974]
curr_Stock_Price:  100.54823861747398
curr_Factors:  [100.54823862]
mat_Sqrt:  [[0.15]]
grads:  [-0.03281098]
Stock Position:  -0.03281098310842834
Bond Position:  [3.19679682]


portfolio before change:  [-0.14944066]
curr_Stock_Price:  101.99746512416222
curr_Factors:  [101.99746512]
mat_Sqrt:  [[0.15]]
grads:  [-0.03647317]
Stock Position:  -0.036473174854767795
Bond Position:  [3.57073072]


portfolio before change:  [-0.15924868]
curr_Stock_Price:  102.27861398788932
curr_Factors:  [102.27861399]
mat_Sqrt:  [[0.15]]
grads:  [-0.02681494]
Stock Position:  -0.026814935577155058
Bond Position:  [2.58334576]


portfolio before change:  [-0.14550814]
curr_Stock_Price:  101.77823598560757
curr_Factors:  [101.77823599]
mat_Sqrt:  [[0.15]]
grads:  [0.15440106]
Stock Position:  0.15440106289571442
Bond Position:  [-15.86017595]


portfolio before change:  [0.04132566]
curr_Stock_Price:  103.001132014756
curr_Factors:  [103.00113201]
mat_Sqrt:  [[0.15]]
grads:  [-0.00158599]
Stock Position:  -0.0015859858065453934
Bond Position:  [0.204684]


portfolio before change:  [0.04127226]
curr_Stock_Price:  103.05093512644962
curr_Factors:  [103.05093513]
mat_Sqrt:  [[0.15]]
grads:  [0.14293051]
Stock Position:  0.14293050899295268
Bond Position:  [-14.68785035]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.04127226]
Stock Price:  103.4031848175137
PL:  [-3.36191255]
Settle:  Tensor("sub_180:0", shape=(), dtype=float64)
PL:  Tensor("sub_181:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  91
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45420868e-03]
 [-9.24241434e-03]
 [ 1.46125884e-02]
 [-4.61475349e-03]
 [ 1.35303256e-02]
 [ 2.18293640e-02]
 [ 2.06608406e-02]
 [-2.39774170e-03]
 [ 4.11688058e-03]
 [ 5.39219094e-03]
 [ 2.70092344e-02]
 [ 1.07842646e-02]
 [-9.94170255e-03]
 [ 1.18524116e-02]
 [-4.01460330e-03]
 [-9.35560212e-03]
 [-1.66278215e-03]
 [-1.37872933e-03]
 [-7.61178270e-03]
 [-2.44023072e-03]
 [ 5.89884262e-04]
 [ 1.36320752e-02]
 [ 4.75718542e-03]
 [ 5.47006208e-03]
 [ 6.10527094e-04]
 [-2.99129680e-03]
 [ 3.92858143e-04]
 [-1.81850714e-02]
 [-2.67789119e-02]
 [ 2.18160674e-02]
 [ 2.63083895e-03]
 [-7.28286517e-03]
 [-1.23586830e-02]
 [-7.71590781e-03]
 [-6.36942482e-03]
 [-2.81505825e-03]
 [ 1.84406234e-02]
 [ 1.24841325e-02]
 [ 1.49476739e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.55229018]
curr_Stock_Price:  100.68366910866919
curr_Factors:  [100.68366911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00969472]
Stock Position:  -0.009694724513478786
Bond Position:  [13.52839062]


portfolio before change:  [12.55360816]
curr_Stock_Price:  100.72216231171481
curr_Factors:  [100.72216231]
mat_Sqrt:  [[0.15]]
grads:  [-0.0616161]
Stock Position:  -0.06161609558734504
Bond Position:  [18.75971454]


portfolio before change:  [12.56774287]
curr_Stock_Price:  100.53082275219995
curr_Factors:  [100.53082275]
mat_Sqrt:  [[0.15]]
grads:  [0.09741726]
Stock Position:  0.09741725602056814
Bond Position:  [2.77430597]


portfolio before change:  [12.51725407]
curr_Stock_Price:  100.00898909474071
curr_Factors:  [100.00898909]
mat_Sqrt:  [[0.15]]
grads:  [-0.03076502]
Stock Position:  -0.030765023237129922
Bond Position:  [15.59403295]


portfolio before change:  [12.54528342]
curr_Stock_Price:  99.16127410872828
curr_Factors:  [99.16127411]
mat_Sqrt:  [[0.15]]
grads:  [0.09020217]
Stock Position:  0.09020217098060583
Bond Position:  [3.60072122]


portfolio before change:  [12.50925074]
curr_Stock_Price:  98.75681826800644
curr_Factors:  [98.75681827]
mat_Sqrt:  [[0.15]]
grads:  [0.14552909]
Stock Position:  0.14552909352742596
Bond Position:  [-1.8627395]


portfolio before change:  [12.58209154]
curr_Stock_Price:  99.25894227364277
curr_Factors:  [99.25894227]
mat_Sqrt:  [[0.15]]
grads:  [0.13773894]
Stock Position:  0.13773893723578828
Bond Position:  [-1.08972968]


portfolio before change:  [12.7945414]
curr_Stock_Price:  100.80234093238799
curr_Factors:  [100.80234093]
mat_Sqrt:  [[0.15]]
grads:  [-0.01598494]
Stock Position:  -0.01598494467042164
Bond Position:  [14.40586125]


portfolio before change:  [12.79944228]
curr_Stock_Price:  100.60840676460388
curr_Factors:  [100.60840676]
mat_Sqrt:  [[0.15]]
grads:  [0.02744587]
Stock Position:  0.027445870514560024
Bond Position:  [10.03815697]


portfolio before change:  [12.80123499]
curr_Stock_Price:  100.62800417568847
curr_Factors:  [100.62800418]
mat_Sqrt:  [[0.15]]
grads:  [0.03594794]
Stock Position:  0.03594793961391905
Bond Position:  [9.18386557]


portfolio before change:  [12.85025605]
curr_Stock_Price:  101.95973567368286
curr_Factors:  [101.95973567]
mat_Sqrt:  [[0.15]]
grads:  [0.18006156]
Stock Position:  0.18006156281463573
Bond Position:  [-5.5087733]


portfolio before change:  [12.731116]
curr_Stock_Price:  101.30189724470681
curr_Factors:  [101.30189724]
mat_Sqrt:  [[0.15]]
grads:  [0.0718951]
Stock Position:  0.07189509748711487
Bond Position:  [5.44800622]


portfolio before change:  [12.68717417]
curr_Stock_Price:  100.68123094193419
curr_Factors:  [100.68123094]
mat_Sqrt:  [[0.15]]
grads:  [-0.06627802]
Stock Position:  -0.06627801699313463
Bond Position:  [19.36012651]


portfolio before change:  [12.67874175]
curr_Stock_Price:  100.84497446622241
curr_Factors:  [100.84497447]
mat_Sqrt:  [[0.15]]
grads:  [0.07901608]
Stock Position:  0.07901607724747281
Bond Position:  [4.71036745]


portfolio before change:  [12.55708718]
curr_Stock_Price:  99.29790449743138
curr_Factors:  [99.2979045]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676402]
Stock Position:  -0.026764021980744044
Bond Position:  [15.21469848]


portfolio before change:  [12.56834969]
curr_Stock_Price:  98.94816032721307
curr_Factors:  [98.94816033]
mat_Sqrt:  [[0.15]]
grads:  [-0.06237068]
Stock Position:  -0.06237068083060832
Bond Position:  [18.73981382]


portfolio before change:  [12.55879884]
curr_Stock_Price:  99.13885049908865
curr_Factors:  [99.1388505]
mat_Sqrt:  [[0.15]]
grads:  [-0.01108521]
Stock Position:  -0.011085214343698337
Bond Position:  [13.65777425]


portfolio before change:  [12.57387102]
curr_Stock_Price:  97.93320373145005
curr_Factors:  [97.93320373]
mat_Sqrt:  [[0.15]]
grads:  [-0.00919153]
Stock Position:  -0.009191528872014973
Bond Position:  [13.47402689]


portfolio before change:  [12.58442721]
curr_Stock_Price:  96.96798551556967
curr_Factors:  [96.96798552]
mat_Sqrt:  [[0.15]]
grads:  [-0.05074522]
Stock Position:  -0.0507452179667692
Bond Position:  [17.50508877]


portfolio before change:  [12.55938893]
curr_Stock_Price:  97.50451993993931
curr_Factors:  [97.50451994]
mat_Sqrt:  [[0.15]]
grads:  [-0.0162682]
Stock Position:  -0.016268204821617747
Bond Position:  [14.14561243]


portfolio before change:  [12.57087707]
curr_Stock_Price:  96.90704592549145
curr_Factors:  [96.90704593]
mat_Sqrt:  [[0.15]]
grads:  [0.00393256]
Stock Position:  0.003932561745244439
Bond Position:  [12.18978413]


portfolio before change:  [12.56990109]
curr_Stock_Price:  96.27137799854745
curr_Factors:  [96.271378]
mat_Sqrt:  [[0.15]]
grads:  [0.0908805]
Stock Position:  0.09088050125543104
Bond Position:  [3.82071]


portfolio before change:  [12.57173382]
curr_Stock_Price:  96.28628890688913
curr_Factors:  [96.28628891]
mat_Sqrt:  [[0.15]]
grads:  [0.03171457]
Stock Position:  0.03171456948242689
Bond Position:  [9.51805562]


portfolio before change:  [12.54827778]
curr_Stock_Price:  95.50917405323817
curr_Factors:  [95.50917405]
mat_Sqrt:  [[0.15]]
grads:  [0.03646708]
Stock Position:  0.03646708051043892
Bond Position:  [9.06533704]


portfolio before change:  [12.56853163]
curr_Stock_Price:  96.03349932892111
curr_Factors:  [96.03349933]
mat_Sqrt:  [[0.15]]
grads:  [0.00407018]
Stock Position:  0.004070180626209174
Bond Position:  [12.17765795]


portfolio before change:  [12.56943766]
curr_Stock_Price:  95.88208634047575
curr_Factors:  [95.88208634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01994198]
Stock Position:  -0.019941978671299522
Bond Position:  [14.48151618]


portfolio before change:  [12.57087367]
curr_Stock_Price:  95.90085539168895
curr_Factors:  [95.90085539]
mat_Sqrt:  [[0.15]]
grads:  [0.00261905]
Stock Position:  0.0026190542871499935
Bond Position:  [12.31970412]


portfolio before change:  [12.57098545]
curr_Stock_Price:  95.3555127836016
curr_Factors:  [95.35551278]
mat_Sqrt:  [[0.15]]
grads:  [-0.12123381]
Stock Position:  -0.12123380901883622
Bond Position:  [24.13129747]


portfolio before change:  [12.57026247]
curr_Stock_Price:  95.38635878932321
curr_Factors:  [95.38635879]
mat_Sqrt:  [[0.15]]
grads:  [-0.17852608]
Stock Position:  -0.17852607926441402
Bond Position:  [29.59921512]


portfolio before change:  [12.50391062]
curr_Stock_Price:  95.77874953077821
curr_Factors:  [95.77874953]
mat_Sqrt:  [[0.15]]
grads:  [0.14544045]
Stock Position:  0.14544044942231618
Bond Position:  [-1.42619376]


portfolio before change:  [12.39182388]
curr_Stock_Price:  95.00930434778023
curr_Factors:  [95.00930435]
mat_Sqrt:  [[0.15]]
grads:  [0.01753893]
Stock Position:  0.017538926366613822
Bond Position:  [10.72546269]


portfolio before change:  [12.41024281]
curr_Stock_Price:  95.98303316737382
curr_Factors:  [95.98303317]
mat_Sqrt:  [[0.15]]
grads:  [-0.04855243]
Stock Position:  -0.04855243445007304
Bond Position:  [17.07045273]


portfolio before change:  [12.46702548]
curr_Stock_Price:  94.85747195636195
curr_Factors:  [94.85747196]
mat_Sqrt:  [[0.15]]
grads:  [-0.08239122]
Stock Position:  -0.08239122014073076
Bond Position:  [20.28244834]


portfolio before change:  [12.45353412]
curr_Stock_Price:  95.05199306496547
curr_Factors:  [95.05199306]
mat_Sqrt:  [[0.15]]
grads:  [-0.05143939]
Stock Position:  -0.05143938539788064
Bond Position:  [17.34295022]


portfolio before change:  [12.49288914]
curr_Stock_Price:  94.3290642141599
curr_Factors:  [94.32906421]
mat_Sqrt:  [[0.15]]
grads:  [-0.04246283]
Stock Position:  -0.042462832116071936
Bond Position:  [16.49836835]


portfolio before change:  [12.51053643]
curr_Stock_Price:  93.96204052113931
curr_Factors:  [93.96204052]
mat_Sqrt:  [[0.15]]
grads:  [-0.01876706]
Stock Position:  -0.018767055000105268
Bond Position:  [14.27392721]


portfolio before change:  [12.50793182]
curr_Stock_Price:  94.19590575085759
curr_Factors:  [94.19590575]
mat_Sqrt:  [[0.15]]
grads:  [0.12293749]
Stock Position:  0.1229374893922042
Bond Position:  [0.92772365]


portfolio before change:  [12.39997345]
curr_Stock_Price:  93.31680582651057
curr_Factors:  [93.31680583]
mat_Sqrt:  [[0.15]]
grads:  [0.08322755]
Stock Position:  0.0832275497988051
Bond Position:  [4.63344435]


portfolio before change:  [12.26932357]
curr_Stock_Price:  91.74005509543275
curr_Factors:  [91.7400551]
mat_Sqrt:  [[0.15]]
grads:  [0.09965116]
Stock Position:  0.09965115905163024
Bond Position:  [3.12732075]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [12.26932357]
Stock Price:  92.78501644207998
PL:  [12.26932357]
Settle:  Tensor("sub_182:0", shape=(), dtype=float64)
PL:  Tensor("sub_183:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  92
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44410732e-03]
 [-3.61406259e-03]
 [-1.49776668e-02]
 [-2.65995725e-02]
 [-3.83681624e-03]
 [ 2.41351401e-02]
 [ 5.06607393e-03]
 [-3.36043741e-03]
 [ 9.25599938e-03]
 [ 5.44788438e-04]
 [-6.78620336e-02]
 [-1.44618353e-02]
 [ 8.98211126e-03]
 [ 7.82023172e-03]
 [ 1.23588142e-03]
 [-9.33206299e-03]
 [-4.19565955e-03]
 [-1.11724793e-03]
 [-7.51364887e-03]
 [-2.55442899e-03]
 [ 6.88391247e-04]
 [ 1.31120248e-02]
 [ 4.75792387e-03]
 [ 5.39901136e-03]
 [-1.23646179e-03]
 [-4.55864556e-03]
 [-5.39152644e-03]
 [-2.01575310e-02]
 [-3.59944670e-02]
 [ 2.19800263e-02]
 [ 3.62250715e-03]
 [-4.80042970e-03]
 [-1.25022111e-02]
 [-8.43838160e-03]
 [-6.40394123e-03]
 [-4.34709290e-03]
 [ 1.87599105e-02]
 [ 9.30614408e-03]
 [ 2.10087483e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.45352454]
curr_Stock_Price:  100.09750778588071
curr_Factors:  [100.09750779]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962738]
Stock Position:  -0.009627382161142046
Bond Position:  [4.4172015]


portfolio before change:  [3.46672762]
curr_Stock_Price:  98.78345412665912
curr_Factors:  [98.78345413]
mat_Sqrt:  [[0.15]]
grads:  [-0.02409375]
Stock Position:  -0.02409375062774378
Bond Position:  [5.84679153]


portfolio before change:  [3.46047427]
curr_Stock_Price:  99.07333208677099
curr_Factors:  [99.07333209]
mat_Sqrt:  [[0.15]]
grads:  [-0.09985111]
Stock Position:  -0.09985111205219026
Bond Position:  [13.35305665]


portfolio before change:  [3.5394631]
curr_Stock_Price:  98.29898315544278
curr_Factors:  [98.29898316]
mat_Sqrt:  [[0.15]]
grads:  [-0.17733048]
Stock Position:  -0.17733048352989286
Bond Position:  [20.97086932]


portfolio before change:  [3.76373527]
curr_Stock_Price:  97.04905343140192
curr_Factors:  [97.04905343]
mat_Sqrt:  [[0.15]]
grads:  [-0.02557877]
Stock Position:  -0.02557877493914443
Bond Position:  [6.24613116]


portfolio before change:  [3.74746852]
curr_Stock_Price:  97.71552630620941
curr_Factors:  [97.71552631]
mat_Sqrt:  [[0.15]]
grads:  [0.16090093]
Stock Position:  0.16090093405774092
Bond Position:  [-11.97505093]


portfolio before change:  [3.77214356]
curr_Stock_Price:  97.878185460908
curr_Factors:  [97.87818546]
mat_Sqrt:  [[0.15]]
grads:  [0.03377383]
Stock Position:  0.03377382623245643
Bond Position:  [0.46642273]


portfolio before change:  [3.80676403]
curr_Stock_Price:  98.90152725545308
curr_Factors:  [98.90152726]
mat_Sqrt:  [[0.15]]
grads:  [-0.02240292]
Stock Position:  -0.02240291607204339
Bond Position:  [6.02244665]


portfolio before change:  [3.83339546]
curr_Stock_Price:  97.7463842299222
curr_Factors:  [97.74638423]
mat_Sqrt:  [[0.15]]
grads:  [0.06170666]
Stock Position:  0.06170666252577238
Bond Position:  [-2.19820769]


portfolio before change:  [3.79317925]
curr_Stock_Price:  97.09910548254976
curr_Factors:  [97.09910548]
mat_Sqrt:  [[0.15]]
grads:  [0.00363192]
Stock Position:  0.0036319229187619802
Bond Position:  [3.44052279]


portfolio before change:  [3.79086516]
curr_Stock_Price:  96.34353210996984
curr_Factors:  [96.34353211]
mat_Sqrt:  [[0.15]]
grads:  [-0.45241356]
Stock Position:  -0.4524135575314863
Bond Position:  [47.37798527]


portfolio before change:  [3.82813509]
curr_Stock_Price:  96.27424304967306
curr_Factors:  [96.27424305]
mat_Sqrt:  [[0.15]]
grads:  [-0.09641224]
Stock Position:  -0.09641223506686168
Bond Position:  [13.11015004]


portfolio before change:  [3.73766033]
curr_Stock_Price:  97.22965734292295
curr_Factors:  [97.22965734]
mat_Sqrt:  [[0.15]]
grads:  [0.05988074]
Stock Position:  0.05988074174993162
Bond Position:  [-2.08452367]


portfolio before change:  [3.74824519]
curr_Stock_Price:  97.41077456820986
curr_Factors:  [97.41077457]
mat_Sqrt:  [[0.15]]
grads:  [0.05213488]
Stock Position:  0.05213487816421419
Bond Position:  [-1.33025368]


portfolio before change:  [3.78231382]
curr_Stock_Price:  98.06743529295794
curr_Factors:  [98.06743529]
mat_Sqrt:  [[0.15]]
grads:  [0.00823921]
Stock Position:  0.008239209468211193
Bond Position:  [2.97431568]


portfolio before change:  [3.78844929]
curr_Stock_Price:  98.7669757348596
curr_Factors:  [98.76697573]
mat_Sqrt:  [[0.15]]
grads:  [-0.06221375]
Stock Position:  -0.062213753238719895
Bond Position:  [9.93311355]


portfolio before change:  [3.82627932]
curr_Stock_Price:  98.17886928679215
curr_Factors:  [98.17886929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02797106]
Stock Position:  -0.027971063662677303
Bond Position:  [6.57244672]


portfolio before change:  [3.83834394]
curr_Stock_Price:  97.77691778025994
curr_Factors:  [97.77691778]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744832]
Stock Position:  -0.007448319554383571
Bond Position:  [4.56661767]


portfolio before change:  [3.83583873]
curr_Stock_Price:  98.18990693269613
curr_Factors:  [98.18990693]
mat_Sqrt:  [[0.15]]
grads:  [-0.05009099]
Stock Position:  -0.05009099247500505
Bond Position:  [8.75426862]


portfolio before change:  [3.90802859]
curr_Stock_Price:  96.7705796256669
curr_Factors:  [96.77057963]
mat_Sqrt:  [[0.15]]
grads:  [-0.01702953]
Stock Position:  -0.01702952659701091
Bond Position:  [5.55598575]


portfolio before change:  [3.9143149]
curr_Stock_Price:  96.44222219952711
curr_Factors:  [96.4422222]
mat_Sqrt:  [[0.15]]
grads:  [0.00458927]
Stock Position:  0.0045892749773181925
Bond Position:  [3.47171503]


portfolio before change:  [3.91605871]
curr_Stock_Price:  96.72762952658292
curr_Factors:  [96.72762953]
mat_Sqrt:  [[0.15]]
grads:  [0.0874135]
Stock Position:  0.08741349840523284
Bond Position:  [-4.53924178]


portfolio before change:  [3.92351616]
curr_Stock_Price:  96.81943333955363
curr_Factors:  [96.81943334]
mat_Sqrt:  [[0.15]]
grads:  [0.03171949]
Stock Position:  0.03171949248583066
Bond Position:  [0.85245287]


portfolio before change:  [3.91172289]
curr_Stock_Price:  96.44427505193451
curr_Factors:  [96.44427505]
mat_Sqrt:  [[0.15]]
grads:  [0.03599341]
Stock Position:  0.03599340906262607
Bond Position:  [0.44036465]


portfolio before change:  [3.94121075]
curr_Stock_Price:  97.26200275062146
curr_Factors:  [97.26200275]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824308]
Stock Position:  -0.008243078590152579
Bond Position:  [4.74294908]


portfolio before change:  [3.94203089]
curr_Stock_Price:  97.23443650620419
curr_Factors:  [97.23443651]
mat_Sqrt:  [[0.15]]
grads:  [-0.03039097]
Stock Position:  -0.030390970369001055
Bond Position:  [6.89707977]


portfolio before change:  [3.95205857]
curr_Stock_Price:  96.93285039096321
curr_Factors:  [96.93285039]
mat_Sqrt:  [[0.15]]
grads:  [-0.03594351]
Stock Position:  -0.03594350958250841
Bond Position:  [7.43616541]


portfolio before change:  [3.92953587]
curr_Stock_Price:  97.58532650693225
curr_Factors:  [97.58532651]
mat_Sqrt:  [[0.15]]
grads:  [-0.13438354]
Stock Position:  -0.13438354019588938
Bond Position:  [17.04339751]


portfolio before change:  [3.82894334]
curr_Stock_Price:  98.3497287699372
curr_Factors:  [98.34972877]
mat_Sqrt:  [[0.15]]
grads:  [-0.23996311]
Stock Position:  -0.23996311319231894
Bond Position:  [27.42925044]


portfolio before change:  [4.06792538]
curr_Stock_Price:  97.36810639334443
curr_Factors:  [97.36810639]
mat_Sqrt:  [[0.15]]
grads:  [0.14653351]
Stock Position:  0.14653350897727563
Bond Position:  [-10.19976492]


portfolio before change:  [4.06987014]
curr_Stock_Price:  97.39007964626799
curr_Factors:  [97.39007965]
mat_Sqrt:  [[0.15]]
grads:  [0.02415005]
Stock Position:  0.024150047679503604
Bond Position:  [1.71789508]


portfolio before change:  [4.0688985]
curr_Stock_Price:  97.34095359308196
curr_Factors:  [97.34095359]
mat_Sqrt:  [[0.15]]
grads:  [-0.03200286]
Stock Position:  -0.03200286467059044
Bond Position:  [7.18408786]


portfolio before change:  [4.09435051]
curr_Stock_Price:  96.57371159958663
curr_Factors:  [96.5737116]
mat_Sqrt:  [[0.15]]
grads:  [-0.08334807]
Stock Position:  -0.0833480738943402
Bond Position:  [12.14358336]


portfolio before change:  [4.18995921]
curr_Stock_Price:  95.44482333728371
curr_Factors:  [95.44482334]
mat_Sqrt:  [[0.15]]
grads:  [-0.05625588]
Stock Position:  -0.05625587734744839
Bond Position:  [9.55929149]


portfolio before change:  [4.22130551]
curr_Stock_Price:  94.90885590132346
curr_Factors:  [94.9088559]
mat_Sqrt:  [[0.15]]
grads:  [-0.04269294]
Stock Position:  -0.0426929415596167
Bond Position:  [8.27324375]


portfolio before change:  [4.2070042]
curr_Stock_Price:  95.26806120411507
curr_Factors:  [95.2680612]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898062]
Stock Position:  -0.028980619351349376
Bond Position:  [6.96793162]


portfolio before change:  [4.21857317]
curr_Stock_Price:  94.89892060698142
curr_Factors:  [94.89892061]
mat_Sqrt:  [[0.15]]
grads:  [0.12506607]
Stock Position:  0.12506607003654577
Bond Position:  [-7.65006188]


portfolio before change:  [4.34674536]
curr_Stock_Price:  95.93140291641804
curr_Factors:  [95.93140292]
mat_Sqrt:  [[0.15]]
grads:  [0.06204096]
Stock Position:  0.06204096053607014
Bond Position:  [-1.60493102]


portfolio before change:  [4.36677195]
curr_Stock_Price:  96.25743297735156
curr_Factors:  [96.25743298]
mat_Sqrt:  [[0.15]]
grads:  [0.14005832]
Stock Position:  0.1400583220512949
Bond Position:  [-9.1148826]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.36677195]
Stock Price:  96.30264268296511
PL:  [4.36677195]
Settle:  Tensor("sub_184:0", shape=(), dtype=float64)
PL:  Tensor("sub_185:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  93
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44454725e-03]
 [-1.63989326e-02]
 [ 3.75632242e-03]
 [-6.41112508e-03]
 [ 8.10116145e-03]
 [ 1.75210329e-02]
 [ 2.59625430e-02]
 [-3.07622865e-03]
 [ 8.42767638e-03]
 [-6.57860492e-05]
 [-1.57926609e-02]
 [-7.58496516e-03]
 [ 1.03379389e-02]
 [ 8.40729582e-03]
 [ 2.03945168e-03]
 [-9.28429530e-03]
 [-4.01511321e-03]
 [-1.79936748e-03]
 [-7.57519869e-03]
 [-2.40030802e-03]
 [ 5.35816824e-04]
 [ 1.39511934e-02]
 [ 4.75620980e-03]
 [ 5.51924519e-03]
 [ 4.50115862e-03]
 [-1.43295037e-03]
 [ 3.33977246e-03]
 [-1.85365195e-02]
 [-2.84774510e-02]
 [ 2.18882898e-02]
 [ 3.13604876e-03]
 [-6.02841799e-03]
 [-1.24671963e-02]
 [-8.47716736e-03]
 [-6.42801875e-03]
 [-5.72855048e-03]
 [ 1.99349199e-02]
 [ 9.24229931e-03]
 [ 2.00407515e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.35054297]
curr_Stock_Price:  100.54182799388187
curr_Factors:  [100.54182799]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963032]
Stock Position:  -0.00963031501615366
Bond Position:  [11.31879244]


portfolio before change:  [10.35508602]
curr_Stock_Price:  100.21700819754291
curr_Factors:  [100.2170082]
mat_Sqrt:  [[0.15]]
grads:  [-0.10932622]
Stock Position:  -0.10932621718638065
Bond Position:  [21.31143242]


portfolio before change:  [10.43242356]
curr_Stock_Price:  99.53397492408635
curr_Factors:  [99.53397492]
mat_Sqrt:  [[0.15]]
grads:  [0.02504215]
Stock Position:  0.02504214943340404
Bond Position:  [7.93987889]


portfolio before change:  [10.43700092]
curr_Stock_Price:  99.67712602825085
curr_Factors:  [99.67712603]
mat_Sqrt:  [[0.15]]
grads:  [-0.04274083]
Stock Position:  -0.04274083384424188
Bond Position:  [14.6972844]


portfolio before change:  [10.4398896]
curr_Stock_Price:  99.65252651763656
curr_Factors:  [99.65252652]
mat_Sqrt:  [[0.15]]
grads:  [0.05400774]
Stock Position:  0.054007742989865756
Bond Position:  [5.05788156]


portfolio before change:  [10.42632922]
curr_Stock_Price:  99.38973730109475
curr_Factors:  [99.3897373]
mat_Sqrt:  [[0.15]]
grads:  [0.11680689]
Stock Position:  0.11680688606997938
Bond Position:  [-1.1830765]


portfolio before change:  [10.45788406]
curr_Stock_Price:  99.66114886656469
curr_Factors:  [99.66114887]
mat_Sqrt:  [[0.15]]
grads:  [0.17308362]
Stock Position:  0.17308361995837224
Bond Position:  [-6.79182835]


portfolio before change:  [10.54741657]
curr_Stock_Price:  100.18333310711778
curr_Factors:  [100.18333311]
mat_Sqrt:  [[0.15]]
grads:  [-0.02050819]
Stock Position:  -0.02050819097290737
Bond Position:  [12.6019955]


portfolio before change:  [10.55057271]
curr_Stock_Price:  100.10625196572178
curr_Factors:  [100.10625197]
mat_Sqrt:  [[0.15]]
grads:  [0.05618451]
Stock Position:  0.056184509208974664
Bond Position:  [4.92615208]


portfolio before change:  [10.42436225]
curr_Stock_Price:  97.84893460860114
curr_Factors:  [97.84893461]
mat_Sqrt:  [[0.15]]
grads:  [-0.00043857]
Stock Position:  -0.00043857366155263097
Bond Position:  [10.46727622]


portfolio before change:  [10.42574981]
curr_Stock_Price:  97.66866546041355
curr_Factors:  [97.66866546]
mat_Sqrt:  [[0.15]]
grads:  [-0.10528441]
Stock Position:  -0.10528440602524697
Bond Position:  [20.70873724]


portfolio before change:  [10.47910793]
curr_Stock_Price:  97.18645380620289
curr_Factors:  [97.18645381]
mat_Sqrt:  [[0.15]]
grads:  [-0.05056643]
Stock Position:  -0.050566434418054765
Bond Position:  [15.39348037]


portfolio before change:  [10.50306152]
curr_Stock_Price:  96.75080343192934
curr_Factors:  [96.75080343]
mat_Sqrt:  [[0.15]]
grads:  [0.06891959]
Stock Position:  0.06891959261234569
Bond Position:  [3.83503556]


portfolio before change:  [10.56076595]
curr_Stock_Price:  97.58111910657867
curr_Factors:  [97.58111911]
mat_Sqrt:  [[0.15]]
grads:  [0.05604864]
Stock Position:  0.0560486387945765
Bond Position:  [5.09147705]


portfolio before change:  [10.58107144]
curr_Stock_Price:  97.93204683106539
curr_Factors:  [97.93204683]
mat_Sqrt:  [[0.15]]
grads:  [0.01359634]
Stock Position:  0.013596344503183946
Bond Position:  [9.2495536]


portfolio before change:  [10.5948353]
curr_Stock_Price:  98.8593247679997
curr_Factors:  [98.85932477]
mat_Sqrt:  [[0.15]]
grads:  [-0.0618953]
Stock Position:  -0.061895302014856685
Bond Position:  [16.71376306]


portfolio before change:  [10.63521467]
curr_Stock_Price:  98.2406991143403
curr_Factors:  [98.24069911]
mat_Sqrt:  [[0.15]]
grads:  [-0.02676742]
Stock Position:  -0.026767421369292017
Bond Position:  [13.26486486]


portfolio before change:  [10.63938971]
curr_Stock_Price:  98.1466733484373
curr_Factors:  [98.14667335]
mat_Sqrt:  [[0.15]]
grads:  [-0.01199578]
Stock Position:  -0.011995783180889725
Bond Position:  [11.81673592]


portfolio before change:  [10.64832523]
curr_Stock_Price:  97.52492675639475
curr_Factors:  [97.52492676]
mat_Sqrt:  [[0.15]]
grads:  [-0.05050132]
Stock Position:  -0.050501324576757815
Bond Position:  [15.57346321]


portfolio before change:  [10.63792018]
curr_Stock_Price:  97.76951155348047
curr_Factors:  [97.76951155]
mat_Sqrt:  [[0.15]]
grads:  [-0.01600205]
Stock Position:  -0.016002053482538713
Bond Position:  [12.20243313]


portfolio before change:  [10.64916424]
curr_Stock_Price:  97.16217329676032
curr_Factors:  [97.1621733]
mat_Sqrt:  [[0.15]]
grads:  [0.00357211]
Stock Position:  0.003572112157115393
Bond Position:  [10.30209006]


portfolio before change:  [10.64626998]
curr_Stock_Price:  95.99140865096783
curr_Factors:  [95.99140865]
mat_Sqrt:  [[0.15]]
grads:  [0.09300796]
Stock Position:  0.09300795610518463
Bond Position:  [1.71830526]


portfolio before change:  [10.60839814]
curr_Stock_Price:  95.58190990401424
curr_Factors:  [95.5819099]
mat_Sqrt:  [[0.15]]
grads:  [0.03170807]
Stock Position:  0.03170806531579542
Bond Position:  [7.5776807]


portfolio before change:  [10.58651444]
curr_Stock_Price:  94.8618734190621
curr_Factors:  [94.86187342]
mat_Sqrt:  [[0.15]]
grads:  [0.03679497]
Stock Position:  0.03679496790333845
Bond Position:  [7.09607486]


portfolio before change:  [10.56703957]
curr_Stock_Price:  94.308484099065
curr_Factors:  [94.3084841]
mat_Sqrt:  [[0.15]]
grads:  [0.03000772]
Stock Position:  0.030007724125821197
Bond Position:  [7.73705659]


portfolio before change:  [10.57630085]
curr_Stock_Price:  94.58488273984429
curr_Factors:  [94.58488274]
mat_Sqrt:  [[0.15]]
grads:  [-0.009553]
Stock Position:  -0.009553002472288484
Bond Position:  [11.47987047]


portfolio before change:  [10.57020061]
curr_Stock_Price:  95.37367300458287
curr_Factors:  [95.373673]
mat_Sqrt:  [[0.15]]
grads:  [0.02226515]
Stock Position:  0.022265149739142936
Bond Position:  [8.4466915]


portfolio before change:  [10.59051778]
curr_Stock_Price:  96.23875885920094
curr_Factors:  [96.23875886]
mat_Sqrt:  [[0.15]]
grads:  [-0.1235768]
Stock Position:  -0.12357679649311146
Bond Position:  [22.4833953]


portfolio before change:  [10.62262087]
curr_Stock_Price:  96.00172008131833
curr_Factors:  [96.00172008]
mat_Sqrt:  [[0.15]]
grads:  [-0.18984967]
Stock Position:  -0.18984967334626582
Bond Position:  [28.84851607]


portfolio before change:  [10.49064842]
curr_Stock_Price:  96.71585744567547
curr_Factors:  [96.71585745]
mat_Sqrt:  [[0.15]]
grads:  [0.14592193]
Stock Position:  0.14592193233240877
Bond Position:  [-3.62231639]


portfolio before change:  [10.51838764]
curr_Stock_Price:  96.90905690360931
curr_Factors:  [96.9090569]
mat_Sqrt:  [[0.15]]
grads:  [0.02090699]
Stock Position:  0.020906991718857973
Bond Position:  [8.49231079]


portfolio before change:  [10.51476856]
curr_Stock_Price:  96.68517577864124
curr_Factors:  [96.68517578]
mat_Sqrt:  [[0.15]]
grads:  [-0.04018945]
Stock Position:  -0.040189453237949674
Bond Position:  [14.40049291]


portfolio before change:  [10.53787536]
curr_Stock_Price:  96.15502114996072
curr_Factors:  [96.15502115]
mat_Sqrt:  [[0.15]]
grads:  [-0.08311464]
Stock Position:  -0.08311464173356559
Bond Position:  [18.52976549]


portfolio before change:  [10.59746676]
curr_Stock_Price:  95.46591229759866
curr_Factors:  [95.4659123]
mat_Sqrt:  [[0.15]]
grads:  [-0.05651445]
Stock Position:  -0.05651444908883255
Bond Position:  [15.9926702]


portfolio before change:  [10.6080908]
curr_Stock_Price:  95.3132994238216
curr_Factors:  [95.31329942]
mat_Sqrt:  [[0.15]]
grads:  [-0.04285346]
Stock Position:  -0.042853458303764295
Bond Position:  [14.69259531]


portfolio before change:  [10.56139941]
curr_Stock_Price:  96.44571875346087
curr_Factors:  [96.44571875]
mat_Sqrt:  [[0.15]]
grads:  [-0.03819034]
Stock Position:  -0.038190336563917626
Bond Position:  [14.24469387]


portfolio before change:  [10.56443702]
curr_Stock_Price:  96.4128067985752
curr_Factors:  [96.4128068]
mat_Sqrt:  [[0.15]]
grads:  [0.13289947]
Stock Position:  0.13289946580500625
Bond Position:  [-2.2487735]


portfolio before change:  [10.51782976]
curr_Stock_Price:  96.06422639837774
curr_Factors:  [96.0642264]
mat_Sqrt:  [[0.15]]
grads:  [0.06161533]
Stock Position:  0.06161532873276372
Bond Position:  [4.59880087]


portfolio before change:  [10.48585629]
curr_Stock_Price:  95.53597550515559
curr_Factors:  [95.53597551]
mat_Sqrt:  [[0.15]]
grads:  [0.13360501]
Stock Position:  0.13360500987809096
Bond Position:  [-2.27822866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.48585629]
Stock Price:  95.43566596758109
PL:  [10.48585629]
Settle:  Tensor("sub_186:0", shape=(), dtype=float64)
PL:  Tensor("sub_187:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  94
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.41369563e-03]
 [ 4.75615897e-03]
 [ 1.71151368e-02]
 [-8.95513939e-03]
 [ 1.08074383e-02]
 [ 1.87243027e-02]
 [ 2.44635776e-02]
 [-3.30612317e-03]
 [ 1.66224697e-02]
 [-1.45117266e-03]
 [ 4.52272186e-03]
 [ 7.95425779e-03]
 [-6.73656347e-03]
 [ 9.59928877e-03]
 [-4.89874542e-03]
 [-1.06840387e-02]
 [-2.65967248e-03]
 [-3.15107841e-03]
 [-7.57459649e-03]
 [-2.41505045e-03]
 [ 6.71322657e-04]
 [ 1.15977430e-02]
 [ 4.76135035e-03]
 [ 5.67488086e-03]
 [-2.69853442e-03]
 [-4.48423382e-03]
 [-7.02091602e-03]
 [-1.87239850e-02]
 [-2.91951641e-02]
 [ 2.18274582e-02]
 [ 2.65377699e-03]
 [-6.85085462e-03]
 [-1.24608488e-02]
 [-9.66245639e-03]
 [-7.31322693e-03]
 [-6.94790445e-03]
 [ 2.10769773e-02]
 [ 8.55664970e-03]
 [ 2.35219852e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.22217845]
curr_Stock_Price:  100.92009090924432
curr_Factors:  [100.92009091]
mat_Sqrt:  [[0.15]]
grads:  [-0.0160913]
Stock Position:  -0.01609130420366509
Bond Position:  [17.84611433]


portfolio before change:  [16.24655666]
curr_Stock_Price:  99.54373840137202
curr_Factors:  [99.5437384]
mat_Sqrt:  [[0.15]]
grads:  [0.03170773]
Stock Position:  0.031707726487991014
Bond Position:  [13.09025103]


portfolio before change:  [16.27765613]
curr_Stock_Price:  100.47294696546737
curr_Factors:  [100.47294697]
mat_Sqrt:  [[0.15]]
grads:  [0.11410091]
Stock Position:  0.11410091203848907
Bond Position:  [4.81360125]


portfolio before change:  [16.15346233]
curr_Stock_Price:  99.37921741219567
curr_Factors:  [99.37921741]
mat_Sqrt:  [[0.15]]
grads:  [-0.05970093]
Stock Position:  -0.05970092924091908
Bond Position:  [22.08649396]


portfolio before change:  [16.09067595]
curr_Stock_Price:  100.47714611572385
curr_Factors:  [100.47714612]
mat_Sqrt:  [[0.15]]
grads:  [0.07204959]
Stock Position:  0.07204958879397744
Bond Position:  [8.85133889]


portfolio before change:  [16.00045879]
curr_Stock_Price:  99.20963511501758
curr_Factors:  [99.20963512]
mat_Sqrt:  [[0.15]]
grads:  [0.12482868]
Stock Position:  0.12482868454814343
Bond Position:  [3.61625054]


portfolio before change:  [16.04401303]
curr_Stock_Price:  99.55492576802298
curr_Factors:  [99.55492577]
mat_Sqrt:  [[0.15]]
grads:  [0.16309052]
Stock Position:  0.163090517486153
Bond Position:  [-0.19245133]


portfolio before change:  [15.96105961]
curr_Stock_Price:  99.04643905929598
curr_Factors:  [99.04643906]
mat_Sqrt:  [[0.15]]
grads:  [-0.02204082]
Stock Position:  -0.022040821165664023
Bond Position:  [18.14412446]


portfolio before change:  [15.96677709]
curr_Stock_Price:  98.8899420664276
curr_Factors:  [98.88994207]
mat_Sqrt:  [[0.15]]
grads:  [0.11081646]
Stock Position:  0.11081646470806775
Bond Position:  [5.00814331]


portfolio before change:  [15.95038938]
curr_Stock_Price:  98.73641105866311
curr_Factors:  [98.73641106]
mat_Sqrt:  [[0.15]]
grads:  [-0.00967448]
Stock Position:  -0.00967448438050857
Bond Position:  [16.90561325]


portfolio before change:  [15.94206639]
curr_Stock_Price:  99.8151585416979
curr_Factors:  [99.81515854]
mat_Sqrt:  [[0.15]]
grads:  [0.03015148]
Stock Position:  0.030151479065977465
Bond Position:  [12.93249173]


portfolio before change:  [15.93041476]
curr_Stock_Price:  99.37510423497025
curr_Factors:  [99.37510423]
mat_Sqrt:  [[0.15]]
grads:  [0.05302839]
Stock Position:  0.05302838528362174
Bond Position:  [10.66071345]


portfolio before change:  [15.93922926]
curr_Stock_Price:  99.51619516487999
curr_Factors:  [99.51619516]
mat_Sqrt:  [[0.15]]
grads:  [-0.04491042]
Stock Position:  -0.04491042316001932
Bond Position:  [20.4085437]


portfolio before change:  [15.95322485]
curr_Stock_Price:  99.26136869307392
curr_Factors:  [99.26136869]
mat_Sqrt:  [[0.15]]
grads:  [0.06399526]
Stock Position:  0.06399525844158245
Bond Position:  [9.60096791]


portfolio before change:  [15.99775368]
curr_Stock_Price:  99.93842868594058
curr_Factors:  [99.93842869]
mat_Sqrt:  [[0.15]]
grads:  [-0.0326583]
Stock Position:  -0.032658302814842013
Bond Position:  [19.26157315]


portfolio before change:  [16.02143483]
curr_Stock_Price:  99.28703829807856
curr_Factors:  [99.2870383]
mat_Sqrt:  [[0.15]]
grads:  [-0.07122692]
Stock Position:  -0.07122692444248158
Bond Position:  [23.09334521]


portfolio before change:  [16.06016566]
curr_Stock_Price:  98.78380189566784
curr_Factors:  [98.7838019]
mat_Sqrt:  [[0.15]]
grads:  [-0.01773115]
Stock Position:  -0.017731149836971567
Bond Position:  [17.81171605]


portfolio before change:  [16.06209572]
curr_Stock_Price:  98.80052643523051
curr_Factors:  [98.80052644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02100719]
Stock Position:  -0.02100718943220732
Bond Position:  [18.13761709]


portfolio before change:  [16.06136245]
curr_Stock_Price:  98.94336399709722
curr_Factors:  [98.943364]
mat_Sqrt:  [[0.15]]
grads:  [-0.05049731]
Stock Position:  -0.05049730994990902
Bond Position:  [21.05773617]


portfolio before change:  [16.12821261]
curr_Stock_Price:  97.67165697234464
curr_Factors:  [97.67165697]
mat_Sqrt:  [[0.15]]
grads:  [-0.01610034]
Stock Position:  -0.016100336320460602
Bond Position:  [17.70075914]


portfolio before change:  [16.14892292]
curr_Stock_Price:  96.52276354723598
curr_Factors:  [96.52276355]
mat_Sqrt:  [[0.15]]
grads:  [0.00447548]
Stock Position:  0.004475484381410605
Bond Position:  [15.7169368]


portfolio before change:  [16.15435372]
curr_Stock_Price:  97.29721914187051
curr_Factors:  [97.29721914]
mat_Sqrt:  [[0.15]]
grads:  [0.07731829]
Stock Position:  0.0773182868751459
Bond Position:  [8.63149942]


portfolio before change:  [16.18931339]
curr_Stock_Price:  97.73541650571978
curr_Factors:  [97.73541651]
mat_Sqrt:  [[0.15]]
grads:  [0.03174234]
Stock Position:  0.03174233569082938
Bond Position:  [13.08696299]


portfolio before change:  [16.19804709]
curr_Stock_Price:  97.95902073756025
curr_Factors:  [97.95902074]
mat_Sqrt:  [[0.15]]
grads:  [0.03783254]
Stock Position:  0.03783253909976757
Bond Position:  [12.4920086]


portfolio before change:  [16.20186251]
curr_Stock_Price:  98.01859447212902
curr_Factors:  [98.01859447]
mat_Sqrt:  [[0.15]]
grads:  [-0.01799023]
Stock Position:  -0.017990229438104858
Bond Position:  [17.96523952]


portfolio before change:  [16.21937054]
curr_Stock_Price:  97.1702320821464
curr_Factors:  [97.17023208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02989489]
Stock Position:  -0.029894892126148733
Bond Position:  [19.12426415]


portfolio before change:  [16.22016727]
curr_Stock_Price:  97.22355061579755
curr_Factors:  [97.22355062]
mat_Sqrt:  [[0.15]]
grads:  [-0.04680611]
Stock Position:  -0.046806106780151194
Bond Position:  [20.77082316]


portfolio before change:  [16.26156909]
curr_Stock_Price:  96.39448572652047
curr_Factors:  [96.39448573]
mat_Sqrt:  [[0.15]]
grads:  [-0.12482657]
Stock Position:  -0.12482656685971281
Bond Position:  [28.2941618]


portfolio before change:  [16.25210846]
curr_Stock_Price:  96.49861116034464
curr_Factors:  [96.49861116]
mat_Sqrt:  [[0.15]]
grads:  [-0.19463443]
Stock Position:  -0.19463442716423401
Bond Position:  [35.03406036]


portfolio before change:  [16.36783103]
curr_Stock_Price:  95.92654871830992
curr_Factors:  [95.92654872]
mat_Sqrt:  [[0.15]]
grads:  [0.14551639]
Stock Position:  0.14551638815017326
Bond Position:  [2.40894614]


portfolio before change:  [16.34214146]
curr_Stock_Price:  95.74793850313334
curr_Factors:  [95.7479385]
mat_Sqrt:  [[0.15]]
grads:  [0.01769185]
Stock Position:  0.017691846578221402
Bond Position:  [14.64818362]


portfolio before change:  [16.35240985]
curr_Stock_Price:  96.22483929321186
curr_Factors:  [96.22483929]
mat_Sqrt:  [[0.15]]
grads:  [-0.04567236]
Stock Position:  -0.04567236414112316
Bond Position:  [20.74722575]


portfolio before change:  [16.36165871]
curr_Stock_Price:  96.07912108500317
curr_Factors:  [96.07912109]
mat_Sqrt:  [[0.15]]
grads:  [-0.08307233]
Stock Position:  -0.08307232522937544
Bond Position:  [24.34317471]


portfolio before change:  [16.34559467]
curr_Stock_Price:  96.3091269818553
curr_Factors:  [96.30912698]
mat_Sqrt:  [[0.15]]
grads:  [-0.06441638]
Stock Position:  -0.06441637592669691
Bond Position:  [22.5494796]


portfolio before change:  [16.29016942]
curr_Stock_Price:  97.21330882973538
curr_Factors:  [97.21330883]
mat_Sqrt:  [[0.15]]
grads:  [-0.04875485]
Stock Position:  -0.04875484623174549
Bond Position:  [21.02978934]


portfolio before change:  [16.27954292]
curr_Stock_Price:  97.48518708116643
curr_Factors:  [97.48518708]
mat_Sqrt:  [[0.15]]
grads:  [-0.04631936]
Stock Position:  -0.04631936299856096
Bond Position:  [20.79499469]


portfolio before change:  [16.27431595]
curr_Stock_Price:  97.65415544636711
curr_Factors:  [97.65415545]
mat_Sqrt:  [[0.15]]
grads:  [0.14051318]
Stock Position:  0.14051318204951543
Bond Position:  [2.55261983]


portfolio before change:  [16.2873931]
curr_Stock_Price:  97.74495152189458
curr_Factors:  [97.74495152]
mat_Sqrt:  [[0.15]]
grads:  [0.05704433]
Stock Position:  0.057044331355326564
Bond Position:  [10.71159769]


portfolio before change:  [16.38027683]
curr_Stock_Price:  99.34975079452026
curr_Factors:  [99.34975079]
mat_Sqrt:  [[0.15]]
grads:  [0.15681323]
Stock Position:  0.15681323488946447
Bond Position:  [0.80092102]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.38027683]
Stock Price:  99.05589554851638
PL:  [16.38027683]
Settle:  Tensor("sub_188:0", shape=(), dtype=float64)
PL:  Tensor("sub_189:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  95
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.70705570e-03]
 [-1.64885895e-02]
 [ 1.98824851e-02]
 [-6.16071088e-03]
 [ 1.79113127e-02]
 [ 2.12296114e-02]
 [ 1.01388524e-02]
 [-1.22272998e-03]
 [ 5.60970231e-03]
 [ 1.06729014e-02]
 [ 2.62880055e-02]
 [-4.06485496e-03]
 [-1.17945391e-02]
 [ 1.07951082e-02]
 [-5.30696986e-03]
 [-2.62357850e-02]
 [ 4.17815811e-03]
 [ 5.90488961e-04]
 [-9.92872254e-03]
 [-2.37637768e-03]
 [ 6.15113524e-04]
 [ 1.32376301e-02]
 [ 4.75866321e-03]
 [ 5.39203772e-03]
 [-1.29902213e-03]
 [-5.72619764e-03]
 [ 3.09575329e-03]
 [-2.61872786e-02]
 [-3.01344637e-02]
 [ 2.18957656e-02]
 [ 2.91387281e-03]
 [-8.41038907e-03]
 [-1.24295873e-02]
 [-7.69680440e-03]
 [-6.42419460e-03]
 [-4.03240230e-03]
 [ 1.92259588e-02]
 [ 9.85211458e-03]
 [ 2.04232575e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.56209895]
curr_Stock_Price:  99.97565823300538
curr_Factors:  [99.97565823]
mat_Sqrt:  [[0.15]]
grads:  [-0.01138037]
Stock Position:  -0.011380371310727815
Bond Position:  [2.69985906]


portfolio before change:  [1.55895657]
curr_Stock_Price:  100.2814377334771
curr_Factors:  [100.28143773]
mat_Sqrt:  [[0.15]]
grads:  [-0.10992393]
Stock Position:  -0.10992392974525206
Bond Position:  [12.58228628]


portfolio before change:  [1.58805236]
curr_Stock_Price:  100.03105626925492
curr_Factors:  [100.03105627]
mat_Sqrt:  [[0.15]]
grads:  [0.1325499]
Stock Position:  0.13254990042376766
Bond Position:  [-11.67105418]


portfolio before change:  [1.55957636]
curr_Stock_Price:  99.82723094567929
curr_Factors:  [99.82723095]
mat_Sqrt:  [[0.15]]
grads:  [-0.04107141]
Stock Position:  -0.04107140588155166
Bond Position:  [5.65962108]


portfolio before change:  [1.51629759]
curr_Stock_Price:  100.89820173528172
curr_Factors:  [100.89820174]
mat_Sqrt:  [[0.15]]
grads:  [0.11940875]
Stock Position:  0.11940875124717636
Bond Position:  [-10.53183069]


portfolio before change:  [1.47925103]
curr_Stock_Price:  100.59897745397134
curr_Factors:  [100.59897745]
mat_Sqrt:  [[0.15]]
grads:  [0.14153074]
Stock Position:  0.14153074268893093
Bond Position:  [-12.75859697]


portfolio before change:  [1.65854015]
curr_Stock_Price:  101.87703229894443
curr_Factors:  [101.8770323]
mat_Sqrt:  [[0.15]]
grads:  [0.06759235]
Stock Position:  0.06759234927121542
Bond Position:  [-5.2275678]


portfolio before change:  [1.62091438]
curr_Stock_Price:  101.33004304917209
curr_Factors:  [101.33004305]
mat_Sqrt:  [[0.15]]
grads:  [-0.00815153]
Stock Position:  -0.00815153319915329
Bond Position:  [2.44690959]


portfolio before change:  [1.6182241]
curr_Stock_Price:  101.69760157471765
curr_Factors:  [101.69760157]
mat_Sqrt:  [[0.15]]
grads:  [0.03739802]
Stock Position:  0.03739801541116005
Bond Position:  [-2.18506438]


portfolio before change:  [1.61531432]
curr_Stock_Price:  101.62709982426122
curr_Factors:  [101.62709982]
mat_Sqrt:  [[0.15]]
grads:  [0.07115268]
Stock Position:  0.07115267622229035
Bond Position:  [-5.61572581]


portfolio before change:  [1.67513553]
curr_Stock_Price:  102.47771041336594
curr_Factors:  [102.47771041]
mat_Sqrt:  [[0.15]]
grads:  [0.17525337]
Stock Position:  0.17525337030178678
Bond Position:  [-16.2844286]


portfolio before change:  [1.79866553]
curr_Stock_Price:  103.1941912228314
curr_Factors:  [103.19419122]
mat_Sqrt:  [[0.15]]
grads:  [-0.02709903]
Stock Position:  -0.027099033084293154
Bond Position:  [4.59512833]


portfolio before change:  [1.82534281]
curr_Stock_Price:  102.23095172985529
curr_Factors:  [102.23095173]
mat_Sqrt:  [[0.15]]
grads:  [-0.07863026]
Stock Position:  -0.07863026083147913
Bond Position:  [9.86378921]


portfolio before change:  [1.81013574]
curr_Stock_Price:  102.44003315381524
curr_Factors:  [102.44003315]
mat_Sqrt:  [[0.15]]
grads:  [0.07196739]
Stock Position:  0.07196738776490658
Bond Position:  [-5.56220585]


portfolio before change:  [1.76893704]
curr_Stock_Price:  101.87723140418706
curr_Factors:  [101.8772314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0353798]
Stock Position:  -0.03537979907213477
Bond Position:  [5.37333302]


portfolio before change:  [1.74972199]
curr_Stock_Price:  102.43932519380304
curr_Factors:  [102.43932519]
mat_Sqrt:  [[0.15]]
grads:  [-0.17490523]
Stock Position:  -0.17490523327972723
Bond Position:  [19.66689606]


portfolio before change:  [1.75649245]
curr_Stock_Price:  102.41467215542085
curr_Factors:  [102.41467216]
mat_Sqrt:  [[0.15]]
grads:  [0.02785439]
Stock Position:  0.027854387424441105
Bond Position:  [-1.09620551]


portfolio before change:  [1.72633697]
curr_Stock_Price:  101.33698025506476
curr_Factors:  [101.33698026]
mat_Sqrt:  [[0.15]]
grads:  [0.00393659]
Stock Position:  0.003936593071688207
Bond Position:  [1.32741451]


portfolio before change:  [1.7196218]
curr_Stock_Price:  99.58899581220061
curr_Factors:  [99.58899581]
mat_Sqrt:  [[0.15]]
grads:  [-0.06619148]
Stock Position:  -0.06619148362956911
Bond Position:  [8.31156519]


portfolio before change:  [1.81855595]
curr_Stock_Price:  98.11002705422271
curr_Factors:  [98.11002705]
mat_Sqrt:  [[0.15]]
grads:  [-0.01584252]
Stock Position:  -0.015842517837626257
Bond Position:  [3.3728658]


portfolio before change:  [1.83992187]
curr_Stock_Price:  96.78799690926934
curr_Factors:  [96.78799691]
mat_Sqrt:  [[0.15]]
grads:  [0.00410076]
Stock Position:  0.004100756826199521
Bond Position:  [1.44301783]


portfolio before change:  [1.83940282]
curr_Stock_Price:  96.61743324507873
curr_Factors:  [96.61743325]
mat_Sqrt:  [[0.15]]
grads:  [0.08825087]
Stock Position:  0.08825086726556684
Bond Position:  [-6.68716946]


portfolio before change:  [1.90350028]
curr_Stock_Price:  97.3532153588577
curr_Factors:  [97.35321536]
mat_Sqrt:  [[0.15]]
grads:  [0.03172442]
Stock Position:  0.031724421376646925
Bond Position:  [-1.18497415]


portfolio before change:  [1.89304049]
curr_Stock_Price:  97.02817698411955
curr_Factors:  [97.02817698]
mat_Sqrt:  [[0.15]]
grads:  [0.03594692]
Stock Position:  0.03594691812362769
Bond Position:  [-1.59482344]


portfolio before change:  [1.90283272]
curr_Stock_Price:  97.30613105258234
curr_Factors:  [97.30613105]
mat_Sqrt:  [[0.15]]
grads:  [-0.00866015]
Stock Position:  -0.008660147516130774
Bond Position:  [2.74551817]


portfolio before change:  [1.89507263]
curr_Stock_Price:  98.24183148068691
curr_Factors:  [98.24183148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03817465]
Stock Position:  -0.03817465095072813
Bond Position:  [5.64542025]


portfolio before change:  [1.87310373]
curr_Stock_Price:  98.83580216148054
curr_Factors:  [98.83580216]
mat_Sqrt:  [[0.15]]
grads:  [0.02063836]
Stock Position:  0.020638355264038025
Bond Position:  [-0.16670467]


portfolio before change:  [1.88427055]
curr_Stock_Price:  99.37788333613011
curr_Factors:  [99.37788334]
mat_Sqrt:  [[0.15]]
grads:  [-0.17458186]
Stock Position:  -0.17458185756300673
Bond Position:  [19.23384602]


portfolio before change:  [2.27581284]
curr_Stock_Price:  97.14891228395499
curr_Factors:  [97.14891228]
mat_Sqrt:  [[0.15]]
grads:  [-0.20089642]
Stock Position:  -0.2008964248441318
Bond Position:  [21.79268199]


portfolio before change:  [2.34604941]
curr_Stock_Price:  96.81285692264603
curr_Factors:  [96.81285692]
mat_Sqrt:  [[0.15]]
grads:  [0.14597177]
Stock Position:  0.14597177033901057
Bond Position:  [-11.7858947]


portfolio before change:  [2.32654954]
curr_Stock_Price:  96.6893635385121
curr_Factors:  [96.68936354]
mat_Sqrt:  [[0.15]]
grads:  [0.01942582]
Stock Position:  0.019425818763801787
Bond Position:  [0.44827948]


portfolio before change:  [2.30062488]
curr_Stock_Price:  95.35193240211936
curr_Factors:  [95.3519324]
mat_Sqrt:  [[0.15]]
grads:  [-0.05606926]
Stock Position:  -0.0560692604596108
Bond Position:  [7.64693721]


portfolio before change:  [2.2817671]
curr_Stock_Price:  95.70531146676993
curr_Factors:  [95.70531147]
mat_Sqrt:  [[0.15]]
grads:  [-0.08286392]
Stock Position:  -0.08286391544362445
Bond Position:  [10.21228394]


portfolio before change:  [2.33804095]
curr_Stock_Price:  95.04160597898064
curr_Factors:  [95.04160598]
mat_Sqrt:  [[0.15]]
grads:  [-0.05131203]
Stock Position:  -0.05131202933713175
Bond Position:  [7.21481863]


portfolio before change:  [2.32829782]
curr_Stock_Price:  95.2490631437482
curr_Factors:  [95.24906314]
mat_Sqrt:  [[0.15]]
grads:  [-0.04282796]
Stock Position:  -0.04282796401850572
Bond Position:  [6.40762126]


portfolio before change:  [2.33977445]
curr_Stock_Price:  94.9997954498825
curr_Factors:  [94.99979545]
mat_Sqrt:  [[0.15]]
grads:  [-0.02688268]
Stock Position:  -0.026882682021715024
Bond Position:  [4.89362374]


portfolio before change:  [2.32415829]
curr_Stock_Price:  95.60345156670122
curr_Factors:  [95.60345157]
mat_Sqrt:  [[0.15]]
grads:  [0.12817306]
Stock Position:  0.12817305843395527
Bond Position:  [-9.92962849]


portfolio before change:  [2.28818088]
curr_Stock_Price:  95.33244196843384
curr_Factors:  [95.33244197]
mat_Sqrt:  [[0.15]]
grads:  [0.06568076]
Stock Position:  0.06568076389224158
Bond Position:  [-3.97332673]


portfolio before change:  [2.31977705]
curr_Stock_Price:  95.82106095818484
curr_Factors:  [95.82106096]
mat_Sqrt:  [[0.15]]
grads:  [0.13615505]
Stock Position:  0.1361550498947774
Bond Position:  [-10.72674428]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.31977705]
Stock Price:  96.81850398184581
PL:  [2.31977705]
Settle:  Tensor("sub_190:0", shape=(), dtype=float64)
PL:  Tensor("sub_191:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  96
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.00547171e-03]
 [-3.58936216e-03]
 [ 2.11242864e-02]
 [ 7.90711504e-03]
 [ 6.15750810e-03]
 [ 2.81459847e-02]
 [ 8.65180266e-03]
 [ 1.40875264e-03]
 [ 1.28307357e-02]
 [ 1.32576450e-02]
 [ 1.54821457e-02]
 [-1.71873575e-02]
 [-1.10343721e-02]
 [-2.66423932e-02]
 [ 1.30942295e-02]
 [-4.05912152e-02]
 [ 5.75484777e-03]
 [-2.19326662e-02]
 [ 3.37129076e-02]
 [-7.46419384e-03]
 [-5.36270213e-03]
 [-3.86952903e-02]
 [ 4.88748864e-03]
 [ 1.80567209e-02]
 [-7.81904036e-03]
 [ 5.21804060e-02]
 [-2.05816892e-02]
 [ 2.67744797e-02]
 [ 1.38571575e-01]
 [ 2.93891618e-02]
 [-5.40871574e-02]
 [-2.05620135e-03]
 [-1.33661838e-02]
 [ 8.59690678e-03]
 [-8.15755527e-03]
 [ 1.27160614e-02]
 [ 2.50800970e-02]
 [ 1.19900420e-02]
 [ 1.84563433e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.43040562]
curr_Stock_Price:  99.46076453962466
curr_Factors:  [99.46076454]
mat_Sqrt:  [[0.15]]
grads:  [-0.02670314]
Stock Position:  -0.026703144723547456
Bond Position:  [-3.77449043]


portfolio before change:  [-6.4128736]
curr_Stock_Price:  98.78654193688755
curr_Factors:  [98.78654194]
mat_Sqrt:  [[0.15]]
grads:  [-0.02392908]
Stock Position:  -0.023929081085380454
Bond Position:  [-4.04900243]


portfolio before change:  [-6.45023005]
curr_Stock_Price:  100.32652129618442
curr_Factors:  [100.3265213]
mat_Sqrt:  [[0.15]]
grads:  [0.14082858]
Stock Position:  0.14082857594952664
Bond Position:  [-20.57907117]


portfolio before change:  [-6.39303683]
curr_Stock_Price:  100.75090788821828
curr_Factors:  [100.75090789]
mat_Sqrt:  [[0.15]]
grads:  [0.0527141]
Stock Position:  0.05271410027983689
Bond Position:  [-11.70403029]


portfolio before change:  [-6.42349226]
curr_Stock_Price:  100.20091583909327
curr_Factors:  [100.20091584]
mat_Sqrt:  [[0.15]]
grads:  [0.04105005]
Stock Position:  0.04105005403033845
Bond Position:  [-10.53674527]


portfolio before change:  [-6.38262766]
curr_Stock_Price:  101.22848520816775
curr_Factors:  [101.22848521]
mat_Sqrt:  [[0.15]]
grads:  [0.1876399]
Stock Position:  0.18763989824135174
Bond Position:  [-25.37713032]


portfolio before change:  [-6.20315507]
curr_Stock_Price:  102.20186525967816
curr_Factors:  [102.20186526]
mat_Sqrt:  [[0.15]]
grads:  [0.05767868]
Stock Position:  0.05767868438640431
Bond Position:  [-12.0980242]


portfolio before change:  [-6.15440934]
curr_Stock_Price:  103.07321097125647
curr_Factors:  [103.07321097]
mat_Sqrt:  [[0.15]]
grads:  [0.00939168]
Stock Position:  0.00939168425772998
Bond Position:  [-7.12244039]


portfolio before change:  [-6.14986529]
curr_Stock_Price:  103.65185120736362
curr_Factors:  [103.65185121]
mat_Sqrt:  [[0.15]]
grads:  [0.08553824]
Stock Position:  0.08553823788593362
Bond Position:  [-15.016062]


portfolio before change:  [-6.14116912]
curr_Stock_Price:  103.77546024083244
curr_Factors:  [103.77546024]
mat_Sqrt:  [[0.15]]
grads:  [0.0883843]
Stock Position:  0.0883842999210772
Bond Position:  [-15.31329052]


portfolio before change:  [-6.06804271]
curr_Stock_Price:  104.62448760826557
curr_Factors:  [104.62448761]
mat_Sqrt:  [[0.15]]
grads:  [0.1032143]
Stock Position:  0.10321430494475806
Bond Position:  [-16.86678648]


portfolio before change:  [-6.00320461]
curr_Stock_Price:  105.27310493616244
curr_Factors:  [105.27310494]
mat_Sqrt:  [[0.15]]
grads:  [-0.11458238]
Stock Position:  -0.11458238321318831
Bond Position:  [6.05923865]


portfolio before change:  [-6.16688247]
curr_Stock_Price:  106.70818871782535
curr_Factors:  [106.70818872]
mat_Sqrt:  [[0.15]]
grads:  [-0.07356248]
Stock Position:  -0.07356248058080081
Bond Position:  [1.68283659]


portfolio before change:  [-6.2235596]
curr_Stock_Price:  107.4815108621561
curr_Factors:  [107.48151086]
mat_Sqrt:  [[0.15]]
grads:  [-0.17761595]
Stock Position:  -0.1776159544733153
Bond Position:  [12.86687154]


portfolio before change:  [-6.43786104]
curr_Stock_Price:  108.69711055839939
curr_Factors:  [108.69711056]
mat_Sqrt:  [[0.15]]
grads:  [0.08729486]
Stock Position:  0.08729486301837826
Bond Position:  [-15.92656042]


portfolio before change:  [-6.4925472]
curr_Stock_Price:  108.09346438500295
curr_Factors:  [108.09346439]
mat_Sqrt:  [[0.15]]
grads:  [-0.2706081]
Stock Position:  -0.2706081010934449
Bond Position:  [22.75841994]


portfolio before change:  [-6.66614888]
curr_Stock_Price:  108.7455019967944
curr_Factors:  [108.745502]
mat_Sqrt:  [[0.15]]
grads:  [0.03836565]
Stock Position:  0.03836565180144968
Bond Position:  [-10.83824094]


portfolio before change:  [-6.64070111]
curr_Stock_Price:  109.44411205825847
curr_Factors:  [109.44411206]
mat_Sqrt:  [[0.15]]
grads:  [-0.14621777]
Stock Position:  -0.1462177749480342
Bond Position:  [9.36197344]


portfolio before change:  [-6.83770446]
curr_Stock_Price:  110.7994443077295
curr_Factors:  [110.79944431]
mat_Sqrt:  [[0.15]]
grads:  [0.22475272]
Stock Position:  0.22475271728511684
Bond Position:  [-31.74018064]


portfolio before change:  [-6.85465367]
curr_Stock_Price:  110.74168553144409
curr_Factors:  [110.74168553]
mat_Sqrt:  [[0.15]]
grads:  [-0.04976129]
Stock Position:  -0.04976129223399332
Bond Position:  [-1.34400429]


portfolio before change:  [-6.90319511]
curr_Stock_Price:  111.71379522370445
curr_Factors:  [111.71379522]
mat_Sqrt:  [[0.15]]
grads:  [-0.03575135]
Stock Position:  -0.03575134751125766
Bond Position:  [-2.9092764]


portfolio before change:  [-6.85834889]
curr_Stock_Price:  110.44923026148844
curr_Factors:  [110.44923026]
mat_Sqrt:  [[0.15]]
grads:  [-0.2579686]
Stock Position:  -0.2579686017221785
Bond Position:  [21.6340846]


portfolio before change:  [-7.00478444]
curr_Stock_Price:  111.02736254331967
curr_Factors:  [111.02736254]
mat_Sqrt:  [[0.15]]
grads:  [0.03258326]
Stock Position:  0.03258325763311909
Bond Position:  [-10.6224176]


portfolio before change:  [-6.99286092]
curr_Stock_Price:  111.4340563786653
curr_Factors:  [111.43405638]
mat_Sqrt:  [[0.15]]
grads:  [0.12037814]
Stock Position:  0.12037813924531175
Bond Position:  [-20.40708527]


portfolio before change:  [-6.84416243]
curr_Stock_Price:  112.69050986768683
curr_Factors:  [112.69050987]
mat_Sqrt:  [[0.15]]
grads:  [-0.05212694]
Stock Position:  -0.05212693570537298
Bond Position:  [-0.96995147]


portfolio before change:  [-6.91833659]
curr_Stock_Price:  114.1111363977886
curr_Factors:  [114.1111364]
mat_Sqrt:  [[0.15]]
grads:  [0.34786937]
Stock Position:  0.34786937343614693
Bond Position:  [-46.61410611]


portfolio before change:  [-7.1339616]
curr_Stock_Price:  113.50804254627727
curr_Factors:  [113.50804255]
mat_Sqrt:  [[0.15]]
grads:  [-0.13721126]
Stock Position:  -0.13721126101174264
Bond Position:  [8.44062006]


portfolio before change:  [-6.92421862]
curr_Stock_Price:  111.98711900190786
curr_Factors:  [111.987119]
mat_Sqrt:  [[0.15]]
grads:  [0.17849653]
Stock Position:  0.17849653164365817
Bond Position:  [-26.91353095]


portfolio before change:  [-6.92011344]
curr_Stock_Price:  112.02896616142397
curr_Factors:  [112.02896616]
mat_Sqrt:  [[0.15]]
grads:  [0.9238105]
Stock Position:  0.9238104982495382
Bond Position:  [-110.41364849]


portfolio before change:  [-8.37531667]
curr_Stock_Price:  110.46868874976344
curr_Factors:  [110.46868875]
mat_Sqrt:  [[0.15]]
grads:  [0.19592775]
Stock Position:  0.19592774549999162
Bond Position:  [-30.0191978]


portfolio before change:  [-8.28307749]
curr_Stock_Price:  110.95862348985473
curr_Factors:  [110.95862349]
mat_Sqrt:  [[0.15]]
grads:  [-0.36058105]
Stock Position:  -0.36058104960564547
Bond Position:  [31.72649943]


portfolio before change:  [-8.20735072]
curr_Stock_Price:  110.759609386253
curr_Factors:  [110.75960939]
mat_Sqrt:  [[0.15]]
grads:  [-0.01370801]
Stock Position:  -0.01370800897129639
Bond Position:  [-6.689057]


portfolio before change:  [-8.18578702]
curr_Stock_Price:  109.12553688704624
curr_Factors:  [109.12553689]
mat_Sqrt:  [[0.15]]
grads:  [-0.08910789]
Stock Position:  -0.08910789196550632
Bond Position:  [1.53815953]


portfolio before change:  [-8.19912314]
curr_Stock_Price:  109.27735735229393
curr_Factors:  [109.27735735]
mat_Sqrt:  [[0.15]]
grads:  [0.05731271]
Stock Position:  0.05731271187696953
Bond Position:  [-14.46210484]


portfolio before change:  [-8.17736905]
curr_Stock_Price:  109.68846972954533
curr_Factors:  [109.68846973]
mat_Sqrt:  [[0.15]]
grads:  [-0.0543837]
Stock Position:  -0.054383701827781614
Bond Position:  [-2.21210402]


portfolio before change:  [-8.21928132]
curr_Stock_Price:  110.45406201418481
curr_Factors:  [110.45406201]
mat_Sqrt:  [[0.15]]
grads:  [0.08477374]
Stock Position:  0.08477374250592105
Bond Position:  [-17.58288554]


portfolio before change:  [-8.32880329]
curr_Stock_Price:  109.18805713551984
curr_Factors:  [109.18805714]
mat_Sqrt:  [[0.15]]
grads:  [0.16720065]
Stock Position:  0.16720064646466673
Bond Position:  [-26.58511703]


portfolio before change:  [-8.33886177]
curr_Stock_Price:  109.14777540709326
curr_Factors:  [109.14777541]
mat_Sqrt:  [[0.15]]
grads:  [0.07993361]
Stock Position:  0.07993361350217099
Bond Position:  [-17.06343787]


portfolio before change:  [-8.44347669]
curr_Stock_Price:  107.86568829578341
curr_Factors:  [107.8656883]
mat_Sqrt:  [[0.15]]
grads:  [0.12304229]
Stock Position:  0.12304228848783341
Bond Position:  [-21.71551783]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.44347669]
Stock Price:  106.70226713267142
PL:  [-15.14574382]
Settle:  Tensor("sub_192:0", shape=(), dtype=float64)
PL:  Tensor("sub_193:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  97
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.59184143e-03]
 [ 3.19414147e-03]
 [-1.72519934e-02]
 [-2.02370611e-02]
 [ 8.68521523e-03]
 [ 1.54171461e-02]
 [ 2.71633486e-02]
 [-3.13059418e-03]
 [ 3.19797872e-03]
 [ 5.87189051e-03]
 [ 4.23696338e-03]
 [ 6.56832741e-03]
 [-6.14791362e-03]
 [ 1.20657779e-02]
 [-6.30589796e-03]
 [-2.53857645e-02]
 [ 4.41520026e-03]
 [ 2.27090104e-03]
 [-8.65526851e-03]
 [-2.23649189e-03]
 [ 2.76842756e-04]
 [ 4.54913207e-03]
 [ 4.79174502e-03]
 [ 8.79597333e-03]
 [-5.41289672e-03]
 [-1.68104844e-03]
 [-3.02709746e-03]
 [-1.27565030e-02]
 [-6.20728657e-05]
 [ 2.48354943e-02]
 [-6.71474095e-03]
 [ 6.33283328e-03]
 [-1.25141992e-02]
 [-5.38769519e-03]
 [-5.46189478e-03]
 [-5.85908440e-03]
 [ 2.27987141e-02]
 [ 6.75915012e-03]
 [ 2.19635985e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.57287236]
curr_Stock_Price:  100.427306772788
curr_Factors:  [100.42730677]
mat_Sqrt:  [[0.15]]
grads:  [-0.01061228]
Stock Position:  -0.010612276199037712
Bond Position:  [9.63863468]


portfolio before change:  [8.58241969]
curr_Stock_Price:  99.64119644390371
curr_Factors:  [99.64119644]
mat_Sqrt:  [[0.15]]
grads:  [0.02129428]
Stock Position:  0.02129427646469076
Bond Position:  [6.4606325]


portfolio before change:  [8.5685723]
curr_Stock_Price:  98.95298264600032
curr_Factors:  [98.95298265]
mat_Sqrt:  [[0.15]]
grads:  [-0.11501329]
Stock Position:  -0.11501328918047933
Bond Position:  [19.94948031]


portfolio before change:  [8.60901085]
curr_Stock_Price:  98.62306675635512
curr_Factors:  [98.62306676]
mat_Sqrt:  [[0.15]]
grads:  [-0.13491374]
Stock Position:  -0.13491374061957792
Bond Position:  [21.9146177]


portfolio before change:  [8.47697865]
curr_Stock_Price:  99.6220139239674
curr_Factors:  [99.62201392]
mat_Sqrt:  [[0.15]]
grads:  [0.05790143]
Stock Position:  0.05790143487558318
Bond Position:  [2.7087211]


portfolio before change:  [8.49009756]
curr_Stock_Price:  99.84273901959902
curr_Factors:  [99.84273902]
mat_Sqrt:  [[0.15]]
grads:  [0.10278097]
Stock Position:  0.10278097427752443
Bond Position:  [-1.77183643]


portfolio before change:  [8.53995586]
curr_Stock_Price:  100.32998669822484
curr_Factors:  [100.3299867]
mat_Sqrt:  [[0.15]]
grads:  [0.18108899]
Stock Position:  0.18108899052310817
Bond Position:  [-9.62870015]


portfolio before change:  [8.47189868]
curr_Stock_Price:  99.96081177196551
curr_Factors:  [99.96081177]
mat_Sqrt:  [[0.15]]
grads:  [-0.02087063]
Stock Position:  -0.02087062785314726
Bond Position:  [10.55814359]


portfolio before change:  [8.45504836]
curr_Stock_Price:  100.83142157111838
curr_Factors:  [100.83142157]
mat_Sqrt:  [[0.15]]
grads:  [0.02131986]
Stock Position:  0.02131985812702908
Bond Position:  [6.30533676]


portfolio before change:  [8.45249611]
curr_Stock_Price:  100.6747382846884
curr_Factors:  [100.67473828]
mat_Sqrt:  [[0.15]]
grads:  [0.03914594]
Stock Position:  0.0391459367394396
Bond Position:  [4.51148918]


portfolio before change:  [8.41050383]
curr_Stock_Price:  99.58762027450257
curr_Factors:  [99.58762027]
mat_Sqrt:  [[0.15]]
grads:  [0.02824642]
Stock Position:  0.02824642255093851
Bond Position:  [5.59750983]


portfolio before change:  [8.40090229]
curr_Stock_Price:  99.22292722935575
curr_Factors:  [99.22292723]
mat_Sqrt:  [[0.15]]
grads:  [0.04378885]
Stock Position:  0.04378884942120117
Bond Position:  [4.05604447]


portfolio before change:  [8.40901332]
curr_Stock_Price:  99.39657862565045
curr_Factors:  [99.39657863]
mat_Sqrt:  [[0.15]]
grads:  [-0.04098609]
Stock Position:  -0.04098609077093899
Bond Position:  [12.48289052]


portfolio before change:  [8.37812469]
curr_Stock_Price:  100.18828838722433
curr_Factors:  [100.18828839]
mat_Sqrt:  [[0.15]]
grads:  [0.08043852]
Stock Position:  0.08043851921899621
Bond Position:  [0.31912713]


portfolio before change:  [8.40743376]
curr_Stock_Price:  100.55215849029848
curr_Factors:  [100.55215849]
mat_Sqrt:  [[0.15]]
grads:  [-0.04203932]
Stock Position:  -0.04203931973066266
Bond Position:  [12.6345781]


portfolio before change:  [8.39549565]
curr_Stock_Price:  100.87370339111371
curr_Factors:  [100.87370339]
mat_Sqrt:  [[0.15]]
grads:  [-0.16923843]
Stock Position:  -0.16923842988758656
Bond Position:  [25.46720283]


portfolio before change:  [8.32172553]
curr_Stock_Price:  101.32840930646391
curr_Factors:  [101.32840931]
mat_Sqrt:  [[0.15]]
grads:  [0.02943467]
Stock Position:  0.02943466841658273
Bond Position:  [5.3391574]


portfolio before change:  [8.33324071]
curr_Stock_Price:  101.69694558774131
curr_Factors:  [101.69694559]
mat_Sqrt:  [[0.15]]
grads:  [0.01513934]
Stock Position:  0.015139340290986096
Bond Position:  [6.79361605]


portfolio before change:  [8.3297027]
curr_Stock_Price:  101.40715323121222
curr_Factors:  [101.40715323]
mat_Sqrt:  [[0.15]]
grads:  [-0.05770179]
Stock Position:  -0.057701790081689616
Bond Position:  [14.18107697]


portfolio before change:  [8.34668397]
curr_Stock_Price:  101.14358223688039
curr_Factors:  [101.14358224]
mat_Sqrt:  [[0.15]]
grads:  [-0.01490995]
Stock Position:  -0.014909945929427232
Bond Position:  [9.85472931]


portfolio before change:  [8.35123882]
curr_Stock_Price:  100.92071512941304
curr_Factors:  [100.92071513]
mat_Sqrt:  [[0.15]]
grads:  [0.00184562]
Stock Position:  0.0018456183728152629
Bond Position:  [8.1649777]


portfolio before change:  [8.35226269]
curr_Stock_Price:  100.92243977247811
curr_Factors:  [100.92243977]
mat_Sqrt:  [[0.15]]
grads:  [0.03032755]
Stock Position:  0.030327547149238007
Bond Position:  [5.29153264]


portfolio before change:  [8.39446423]
curr_Stock_Price:  102.29215344125727
curr_Factors:  [102.29215344]
mat_Sqrt:  [[0.15]]
grads:  [0.03194497]
Stock Position:  0.03194496678722845
Bond Position:  [5.12674479]


portfolio before change:  [8.41898666]
curr_Stock_Price:  103.03973752375407
curr_Factors:  [103.03973752]
mat_Sqrt:  [[0.15]]
grads:  [0.05863982]
Stock Position:  0.05863982221558624
Bond Position:  [2.37675477]


portfolio before change:  [8.41425442]
curr_Stock_Price:  102.95397069448167
curr_Factors:  [102.95397069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03608598]
Stock Position:  -0.0360859781029142
Bond Position:  [12.12944915]


portfolio before change:  [8.39876498]
curr_Stock_Price:  103.42522634000277
curr_Factors:  [103.42522634]
mat_Sqrt:  [[0.15]]
grads:  [-0.01120699]
Stock Position:  -0.011206989625414117
Bond Position:  [9.55785042]


portfolio before change:  [8.40302748]
curr_Stock_Price:  103.15149530052847
curr_Factors:  [103.1514953]
mat_Sqrt:  [[0.15]]
grads:  [-0.02018065]
Stock Position:  -0.020180649717340855
Bond Position:  [10.48469168]


portfolio before change:  [8.41922631]
curr_Stock_Price:  102.41375087108607
curr_Factors:  [102.41375087]
mat_Sqrt:  [[0.15]]
grads:  [-0.08504335]
Stock Position:  -0.08504335317381437
Bond Position:  [17.1288351]


portfolio before change:  [8.40350644]
curr_Stock_Price:  102.62377455178697
curr_Factors:  [102.62377455]
mat_Sqrt:  [[0.15]]
grads:  [-0.00041382]
Stock Position:  -0.00041381910445216963
Bond Position:  [8.44597411]


portfolio before change:  [8.4040763]
curr_Stock_Price:  103.79808330548515
curr_Factors:  [103.79808331]
mat_Sqrt:  [[0.15]]
grads:  [0.16556996]
Stock Position:  0.16556996226260726
Bond Position:  [-8.78176844]


portfolio before change:  [8.22051231]
curr_Stock_Price:  102.69603440497661
curr_Factors:  [102.6960344]
mat_Sqrt:  [[0.15]]
grads:  [-0.04476494]
Stock Position:  -0.044764939685392
Bond Position:  [12.8176941]


portfolio before change:  [8.27113504]
curr_Stock_Price:  101.60097176029291
curr_Factors:  [101.60097176]
mat_Sqrt:  [[0.15]]
grads:  [0.04221889]
Stock Position:  0.04221888855853981
Bond Position:  [3.98165493]


portfolio before change:  [8.26486971]
curr_Stock_Price:  101.44078135280171
curr_Factors:  [101.44078135]
mat_Sqrt:  [[0.15]]
grads:  [-0.08342799]
Stock Position:  -0.08342799469902218
Bond Position:  [16.72787068]


portfolio before change:  [8.31882269]
curr_Stock_Price:  100.81914516481197
curr_Factors:  [100.81914516]
mat_Sqrt:  [[0.15]]
grads:  [-0.03591797]
Stock Position:  -0.03591796790642464
Bond Position:  [11.94004151]


portfolio before change:  [8.2816543]
curr_Stock_Price:  101.89551408068313
curr_Factors:  [101.89551408]
mat_Sqrt:  [[0.15]]
grads:  [-0.03641263]
Stock Position:  -0.03641263185674498
Bond Position:  [11.99193815]


portfolio before change:  [8.29728295]
curr_Stock_Price:  101.50747389105918
curr_Factors:  [101.50747389]
mat_Sqrt:  [[0.15]]
grads:  [-0.03906056]
Stock Position:  -0.03906056263418083
Bond Position:  [12.262222]


portfolio before change:  [8.32441274]
curr_Stock_Price:  100.85216042043626
curr_Factors:  [100.85216042]
mat_Sqrt:  [[0.15]]
grads:  [0.15199143]
Stock Position:  0.15199142706180274
Bond Position:  [-7.00425104]


portfolio before change:  [8.2959397]
curr_Stock_Price:  100.6705879658072
curr_Factors:  [100.67058797]
mat_Sqrt:  [[0.15]]
grads:  [0.045061]
Stock Position:  0.04506100082295437
Bond Position:  [3.75962225]


portfolio before change:  [8.37844896]
curr_Stock_Price:  102.49121510524215
curr_Factors:  [102.49121511]
mat_Sqrt:  [[0.15]]
grads:  [0.14642399]
Stock Position:  0.14642398978904386
Bond Position:  [-6.62872367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.37844896]
Stock Price:  103.70700831726607
PL:  [4.67144064]
Settle:  Tensor("sub_194:0", shape=(), dtype=float64)
PL:  Tensor("sub_195:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  98
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.53092959e-03]
 [ 4.20908146e-03]
 [ 8.78661196e-03]
 [-6.14989700e-03]
 [ 1.68203096e-02]
 [ 2.82730774e-02]
 [ 2.40987018e-02]
 [-2.54390068e-03]
 [ 2.87617114e-03]
 [ 3.21069615e-03]
 [ 4.69376410e-03]
 [ 1.13939327e-02]
 [ 7.24367696e-03]
 [ 1.07085078e-02]
 [ 5.85285413e-03]
 [-1.20045108e-02]
 [-6.64775984e-03]
 [-7.96670761e-04]
 [-7.60292216e-03]
 [-2.49243451e-03]
 [ 3.52687000e-04]
 [ 8.54327599e-03]
 [ 4.76692756e-03]
 [ 6.00872910e-03]
 [-3.40122018e-03]
 [-7.46596141e-03]
 [ 5.64504346e-03]
 [-2.50338427e-02]
 [-1.56498358e-02]
 [ 2.17156000e-02]
 [ 3.78483075e-03]
 [-2.15971386e-03]
 [-1.25334904e-02]
 [-6.23069144e-03]
 [-8.48199527e-03]
 [-7.43635191e-03]
 [ 2.27620881e-02]
 [ 7.17087513e-03]
 [ 2.32841394e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.4557055]
curr_Stock_Price:  98.87933603371589
curr_Factors:  [98.87933603]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687286]
Stock Position:  -0.036872863901272375
Bond Position:  [-11.8097412]


portfolio before change:  [-15.47488032]
curr_Stock_Price:  99.35932324059497
curr_Factors:  [99.35932324]
mat_Sqrt:  [[0.15]]
grads:  [0.02806054]
Stock Position:  0.0280605430667334
Bond Position:  [-18.26295688]


portfolio before change:  [-15.46877852]
curr_Stock_Price:  99.65813452245226
curr_Factors:  [99.65813452]
mat_Sqrt:  [[0.15]]
grads:  [0.05857741]
Stock Position:  0.05857741305998798
Bond Position:  [-21.30649423]


portfolio before change:  [-15.46115706]
curr_Stock_Price:  99.83371307219718
curr_Factors:  [99.83371307]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099931]
Stock Position:  -0.04099931335152704
Bond Position:  [-11.36804338]


portfolio before change:  [-15.50351897]
curr_Stock_Price:  100.83228633607752
curr_Factors:  [100.83228634]
mat_Sqrt:  [[0.15]]
grads:  [0.1121354]
Stock Position:  0.11213539737504007
Bond Position:  [-26.81038747]


portfolio before change:  [-15.45608096]
curr_Stock_Price:  101.28521671124655
curr_Factors:  [101.28521671]
mat_Sqrt:  [[0.15]]
grads:  [0.18848718]
Stock Position:  0.18848718284466412
Bond Position:  [-34.54704612]


portfolio before change:  [-15.53965978]
curr_Stock_Price:  100.86470973419262
curr_Factors:  [100.86470973]
mat_Sqrt:  [[0.15]]
grads:  [0.16065801]
Stock Position:  0.16065801186779666
Bond Position:  [-31.74438351]


portfolio before change:  [-15.57120589]
curr_Stock_Price:  100.69305436267754
curr_Factors:  [100.69305436]
mat_Sqrt:  [[0.15]]
grads:  [-0.01695934]
Stock Position:  -0.01695933788478896
Bond Position:  [-13.86351836]


portfolio before change:  [-15.57951617]
curr_Stock_Price:  101.08087805657719
curr_Factors:  [101.08087806]
mat_Sqrt:  [[0.15]]
grads:  [0.01917447]
Stock Position:  0.019174474271662006
Bond Position:  [-17.51768886]


portfolio before change:  [-15.59446477]
curr_Stock_Price:  100.41547487181239
curr_Factors:  [100.41547487]
mat_Sqrt:  [[0.15]]
grads:  [0.02140464]
Stock Position:  0.02140464099479971
Bond Position:  [-17.74382196]


portfolio before change:  [-15.60822164]
curr_Stock_Price:  99.87639762072789
curr_Factors:  [99.87639762]
mat_Sqrt:  [[0.15]]
grads:  [0.03129176]
Stock Position:  0.03129176064352003
Bond Position:  [-18.73352997]


portfolio before change:  [-15.59528321]
curr_Stock_Price:  100.36471384324162
curr_Factors:  [100.36471384]
mat_Sqrt:  [[0.15]]
grads:  [0.07595955]
Stock Position:  0.07595955143195844
Bond Position:  [-23.21894185]


portfolio before change:  [-15.78839099]
curr_Stock_Price:  97.86068067689705
curr_Factors:  [97.86068068]
mat_Sqrt:  [[0.15]]
grads:  [0.04829118]
Stock Position:  0.04829117975089602
Bond Position:  [-20.51419871]


portfolio before change:  [-15.77264936]
curr_Stock_Price:  98.2397576175861
curr_Factors:  [98.23975762]
mat_Sqrt:  [[0.15]]
grads:  [0.07139005]
Stock Position:  0.0713900519174859
Bond Position:  [-22.78599075]


portfolio before change:  [-15.8433331]
curr_Stock_Price:  97.28955080818608
curr_Factors:  [97.28955081]
mat_Sqrt:  [[0.15]]
grads:  [0.03901903]
Stock Position:  0.03901902754340687
Bond Position:  [-19.63947676]


portfolio before change:  [-15.82207174]
curr_Stock_Price:  97.89736832862637
curr_Factors:  [97.89736833]
mat_Sqrt:  [[0.15]]
grads:  [-0.08003007]
Stock Position:  -0.08003007223974598
Bond Position:  [-7.98733828]


portfolio before change:  [-15.77839388]
curr_Stock_Price:  97.33912401854506
curr_Factors:  [97.33912402]
mat_Sqrt:  [[0.15]]
grads:  [-0.0443184]
Stock Position:  -0.044318398931324506
Bond Position:  [-11.46447975]


portfolio before change:  [-15.79134319]
curr_Stock_Price:  97.5989744535081
curr_Factors:  [97.59897445]
mat_Sqrt:  [[0.15]]
grads:  [-0.00531114]
Stock Position:  -0.005311138404325627
Bond Position:  [-15.27298153]


portfolio before change:  [-15.7907172]
curr_Stock_Price:  97.12163212291044
curr_Factors:  [97.12163212]
mat_Sqrt:  [[0.15]]
grads:  [-0.05068615]
Stock Position:  -0.05068614770830435
Bond Position:  [-10.86799581]


portfolio before change:  [-15.7939197]
curr_Stock_Price:  97.15801115162053
curr_Factors:  [97.15801115]
mat_Sqrt:  [[0.15]]
grads:  [-0.01661623]
Stock Position:  -0.016616230092234095
Bond Position:  [-14.17951983]


portfolio before change:  [-15.8101872]
curr_Stock_Price:  98.03034794791421
curr_Factors:  [98.03034795]
mat_Sqrt:  [[0.15]]
grads:  [0.00235125]
Stock Position:  0.0023512466644196243
Bond Position:  [-16.04068072]


portfolio before change:  [-15.81024062]
curr_Stock_Price:  98.86045368657284
curr_Factors:  [98.86045369]
mat_Sqrt:  [[0.15]]
grads:  [0.05695517]
Stock Position:  0.05695517327651892
Bond Position:  [-21.44085489]


portfolio before change:  [-15.81887042]
curr_Stock_Price:  98.75599394549884
curr_Factors:  [98.75599395]
mat_Sqrt:  [[0.15]]
grads:  [0.03177952]
Stock Position:  0.03177951709609015
Bond Position:  [-18.95728822]


portfolio before change:  [-15.80807134]
curr_Stock_Price:  99.17037684655901
curr_Factors:  [99.17037685]
mat_Sqrt:  [[0.15]]
grads:  [0.04005819]
Stock Position:  0.04005819396979165
Bond Position:  [-19.78065753]


portfolio before change:  [-15.8103093]
curr_Stock_Price:  99.17623770652911
curr_Factors:  [99.17623771]
mat_Sqrt:  [[0.15]]
grads:  [-0.0226748]
Stock Position:  -0.022674801180452
Bond Position:  [-13.56150783]


portfolio before change:  [-15.8127506]
curr_Stock_Price:  99.20913807508369
curr_Factors:  [99.20913808]
mat_Sqrt:  [[0.15]]
grads:  [-0.04977308]
Stock Position:  -0.049773076056153616
Bond Position:  [-10.87480663]


portfolio before change:  [-15.80467783]
curr_Stock_Price:  99.01963385709222
curr_Factors:  [99.01963386]
mat_Sqrt:  [[0.15]]
grads:  [0.03763362]
Stock Position:  0.0376336230683312
Bond Position:  [-19.53114541]


portfolio before change:  [-15.8074123]
curr_Stock_Price:  99.01185032804932
curr_Factors:  [99.01185033]
mat_Sqrt:  [[0.15]]
grads:  [-0.16689228]
Stock Position:  -0.16689228465251238
Bond Position:  [0.71690161]


portfolio before change:  [-16.05189558]
curr_Stock_Price:  100.47730394362371
curr_Factors:  [100.47730394]
mat_Sqrt:  [[0.15]]
grads:  [-0.10433224]
Stock Position:  -0.10433223879577935
Bond Position:  [-5.56887352]


portfolio before change:  [-15.91129686]
curr_Stock_Price:  99.12302574731108
curr_Factors:  [99.12302575]
mat_Sqrt:  [[0.15]]
grads:  [0.14477067]
Stock Position:  0.14477066633415767
Bond Position:  [-30.26140335]


portfolio before change:  [-16.09858867]
curr_Stock_Price:  97.85544231423988
curr_Factors:  [97.85544231]
mat_Sqrt:  [[0.15]]
grads:  [0.02523221]
Stock Position:  0.025232205007175743
Bond Position:  [-18.56769725]


portfolio before change:  [-16.08423591]
curr_Stock_Price:  98.5162592360436
curr_Factors:  [98.51625924]
mat_Sqrt:  [[0.15]]
grads:  [-0.01439809]
Stock Position:  -0.014398092389735087
Bond Position:  [-14.66578971]


portfolio before change:  [-16.08372681]
curr_Stock_Price:  98.35356816061551
curr_Factors:  [98.35356816]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835566]
Stock Position:  -0.08355660298830861
Bond Position:  [-7.86563676]


portfolio before change:  [-16.20452407]
curr_Stock_Price:  99.78749426858406
curr_Factors:  [99.78749427]
mat_Sqrt:  [[0.15]]
grads:  [-0.04153794]
Stock Position:  -0.041537942930247075
Bond Position:  [-12.05955683]


portfolio before change:  [-16.19770898]
curr_Stock_Price:  99.58713230474228
curr_Factors:  [99.5871323]
mat_Sqrt:  [[0.15]]
grads:  [-0.05654664]
Stock Position:  -0.05654663510849648
Bond Position:  [-10.56639175]


portfolio before change:  [-16.23982338]
curr_Stock_Price:  100.30854597365135
curr_Factors:  [100.30854597]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957568]
Stock Position:  -0.04957567939208085
Bond Position:  [-11.26695906]


portfolio before change:  [-16.24922378]
curr_Stock_Price:  100.46975283758543
curr_Factors:  [100.46975284]
mat_Sqrt:  [[0.15]]
grads:  [0.15174725]
Stock Position:  0.15174725396797295
Bond Position:  [-31.49523288]


portfolio before change:  [-16.30032946]
curr_Stock_Price:  100.15891668621424
curr_Factors:  [100.15891669]
mat_Sqrt:  [[0.15]]
grads:  [0.04780583]
Stock Position:  0.04780583422548653
Bond Position:  [-21.08851003]


portfolio before change:  [-16.26256166]
curr_Stock_Price:  101.00408614637409
curr_Factors:  [101.00408615]
mat_Sqrt:  [[0.15]]
grads:  [0.1552276]
Stock Position:  0.15522759579905931
Bond Position:  [-31.94118312]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.26256166]
Stock Price:  101.60331262401107
PL:  [-17.86587428]
Settle:  Tensor("sub_196:0", shape=(), dtype=float64)
PL:  Tensor("sub_197:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  99
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.21526058e-03]
 [ 4.52576552e-03]
 [ 1.70797369e-02]
 [ 5.77094756e-04]
 [ 8.20242975e-03]
 [ 3.32805157e-02]
 [ 5.50003418e-03]
 [ 1.09769546e-03]
 [ 1.44906972e-02]
 [ 1.28218341e-02]
 [ 2.49633316e-02]
 [ 3.98187417e-03]
 [-1.11265718e-02]
 [ 1.14008890e-02]
 [-3.71098529e-03]
 [-2.63462706e-02]
 [ 4.41089265e-03]
 [ 1.80360326e-03]
 [-7.71379109e-03]
 [-2.22347391e-03]
 [ 3.47457228e-04]
 [ 8.47580604e-03]
 [ 4.76693121e-03]
 [ 5.39754624e-03]
 [-9.88811845e-04]
 [-3.88448252e-03]
 [ 2.62695913e-04]
 [-1.80095684e-02]
 [-2.64593136e-02]
 [ 2.14475367e-02]
 [ 2.60453594e-03]
 [-1.11646939e-02]
 [-1.22312072e-02]
 [-4.38137047e-03]
 [-6.72978355e-03]
 [ 1.31037232e-03]
 [ 1.73928680e-02]
 [ 1.50105498e-02]
 [ 1.35320346e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.3503752]
curr_Stock_Price:  99.7880306182747
curr_Factors:  [99.78803062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147684]
Stock Position:  -0.014768403853061884
Bond Position:  [0.12333474]


portfolio before change:  [-1.3471071]
curr_Stock_Price:  99.56778454652742
curr_Factors:  [99.56778455]
mat_Sqrt:  [[0.15]]
grads:  [0.03017177]
Stock Position:  0.030171770146420498
Bond Position:  [-4.3512434]


portfolio before change:  [-1.33766192]
curr_Stock_Price:  99.89885929785872
curr_Factors:  [99.8988593]
mat_Sqrt:  [[0.15]]
grads:  [0.11386491]
Stock Position:  0.11386491289669107
Bond Position:  [-12.71263684]


portfolio before change:  [-1.2743464]
curr_Stock_Price:  100.46887420602224
curr_Factors:  [100.46887421]
mat_Sqrt:  [[0.15]]
grads:  [0.0038473]
Stock Position:  0.0038472983708613454
Bond Position:  [-1.66088014]


portfolio before change:  [-1.26982045]
curr_Stock_Price:  101.69923781770758
curr_Factors:  [101.69923782]
mat_Sqrt:  [[0.15]]
grads:  [0.05468287]
Stock Position:  0.054682865027474194
Bond Position:  [-6.83102615]


portfolio before change:  [-1.23031563]
curr_Stock_Price:  102.43728894036484
curr_Factors:  [102.43728894]
mat_Sqrt:  [[0.15]]
grads:  [0.2218701]
Stock Position:  0.22187010470298257
Bond Position:  [-23.95808766]


portfolio before change:  [-1.15480584]
curr_Stock_Price:  102.7911209507181
curr_Factors:  [102.79112095]
mat_Sqrt:  [[0.15]]
grads:  [0.03666689]
Stock Position:  0.036666894522657104
Bond Position:  [-4.92383703]


portfolio before change:  [-1.15478367]
curr_Stock_Price:  102.80851228519785
curr_Factors:  [102.80851229]
mat_Sqrt:  [[0.15]]
grads:  [0.00731797]
Stock Position:  0.007317969725040137
Bond Position:  [-1.90713325]


portfolio before change:  [-1.14484297]
curr_Stock_Price:  104.19948548775655
curr_Factors:  [104.19948549]
mat_Sqrt:  [[0.15]]
grads:  [0.09660465]
Stock Position:  0.09660464816902022
Bond Position:  [-11.21099761]


portfolio before change:  [-1.2339086]
curr_Stock_Price:  103.29203263117547
curr_Factors:  [103.29203263]
mat_Sqrt:  [[0.15]]
grads:  [0.08547889]
Stock Position:  0.08547889399892795
Bond Position:  [-10.06319731]


portfolio before change:  [-1.2602794]
curr_Stock_Price:  102.99824286122504
curr_Factors:  [102.99824286]
mat_Sqrt:  [[0.15]]
grads:  [0.16642221]
Stock Position:  0.16642221070591737
Bond Position:  [-18.40147468]


portfolio before change:  [-1.38059516]
curr_Stock_Price:  102.28911020335688
curr_Factors:  [102.2891102]
mat_Sqrt:  [[0.15]]
grads:  [0.02654583]
Stock Position:  0.026545827813577786
Bond Position:  [-4.09594426]


portfolio before change:  [-1.40678805]
curr_Stock_Price:  101.32169390524064
curr_Factors:  [101.32169391]
mat_Sqrt:  [[0.15]]
grads:  [-0.07417715]
Stock Position:  -0.07417714531019746
Bond Position:  [6.10896596]


portfolio before change:  [-1.45555524]
curr_Stock_Price:  101.98943138772614
curr_Factors:  [101.98943139]
mat_Sqrt:  [[0.15]]
grads:  [0.07600593]
Stock Position:  0.0760059268408341
Bond Position:  [-9.2073565]


portfolio before change:  [-1.43047795]
curr_Stock_Price:  102.33451343518482
curr_Factors:  [102.33451344]
mat_Sqrt:  [[0.15]]
grads:  [-0.0247399]
Stock Position:  -0.024739901919414813
Bond Position:  [1.10126787]


portfolio before change:  [-1.43819769]
curr_Stock_Price:  102.65211379864124
curr_Factors:  [102.6521138]
mat_Sqrt:  [[0.15]]
grads:  [-0.1756418]
Stock Position:  -0.1756418038901069
Bond Position:  [16.59180476]


portfolio before change:  [-1.21295271]
curr_Stock_Price:  101.38151152581179
curr_Factors:  [101.38151153]
mat_Sqrt:  [[0.15]]
grads:  [0.02940595]
Stock Position:  0.029405950977660928
Bond Position:  [-4.19417246]


portfolio before change:  [-1.19236891]
curr_Stock_Price:  102.09932864975676
curr_Factors:  [102.09932865]
mat_Sqrt:  [[0.15]]
grads:  [0.01202402]
Stock Position:  0.012024021743706674
Bond Position:  [-2.42001346]


portfolio before change:  [-1.19917731]
curr_Stock_Price:  101.55825570655105
curr_Factors:  [101.55825571]
mat_Sqrt:  [[0.15]]
grads:  [-0.05142527]
Stock Position:  -0.05142527393235387
Bond Position:  [4.02348381]


portfolio before change:  [-1.16051754]
curr_Stock_Price:  100.81627034831428
curr_Factors:  [100.81627035]
mat_Sqrt:  [[0.15]]
grads:  [-0.01482316]
Stock Position:  -0.014823159387761284
Bond Position:  [0.3338981]


portfolio before change:  [-1.14322714]
curr_Stock_Price:  99.65264122343069
curr_Factors:  [99.65264122]
mat_Sqrt:  [[0.15]]
grads:  [0.00231638]
Stock Position:  0.0023163815216259926
Bond Position:  [-1.37406068]


portfolio before change:  [-1.14502952]
curr_Stock_Price:  98.94869310268872
curr_Factors:  [98.9486931]
mat_Sqrt:  [[0.15]]
grads:  [0.05650537]
Stock Position:  0.05650537357801811
Bond Position:  [-6.73616239]


portfolio before change:  [-1.1571637]
curr_Stock_Price:  98.74885191260495
curr_Factors:  [98.74885191]
mat_Sqrt:  [[0.15]]
grads:  [0.03177954]
Stock Position:  0.03177954137832846
Bond Position:  [-4.29535692]


portfolio before change:  [-1.23032625]
curr_Stock_Price:  96.46355757118492
curr_Factors:  [96.46355757]
mat_Sqrt:  [[0.15]]
grads:  [0.03598364]
Stock Position:  0.035983641584221564
Bond Position:  [-4.70143634]


portfolio before change:  [-1.20846882]
curr_Stock_Price:  97.0873174516854
curr_Factors:  [97.08731745]
mat_Sqrt:  [[0.15]]
grads:  [-0.00659208]
Stock Position:  -0.006592078964649957
Bond Position:  [-0.56846156]


portfolio before change:  [-1.20567518]
curr_Stock_Price:  96.652750723152
curr_Factors:  [96.65275072]
mat_Sqrt:  [[0.15]]
grads:  [-0.02589655]
Stock Position:  -0.025896550157568955
Bond Position:  [1.29729762]


portfolio before change:  [-1.18664289]
curr_Stock_Price:  95.92407770139768
curr_Factors:  [95.9240777]
mat_Sqrt:  [[0.15]]
grads:  [0.00175131]
Stock Position:  0.0017513060887826926
Bond Position:  [-1.35463531]


portfolio before change:  [-1.18752727]
curr_Stock_Price:  95.51579239772225
curr_Factors:  [95.5157924]
mat_Sqrt:  [[0.15]]
grads:  [-0.12006379]
Stock Position:  -0.12006378904222174
Bond Position:  [10.28046068]


portfolio before change:  [-1.16106656]
curr_Stock_Price:  95.30610747823765
curr_Factors:  [95.30610748]
mat_Sqrt:  [[0.15]]
grads:  [-0.17639542]
Stock Position:  -0.17639542429541757
Bond Position:  [15.6504947]


portfolio before change:  [-0.96765945]
curr_Stock_Price:  94.22075799702722
curr_Factors:  [94.220758]
mat_Sqrt:  [[0.15]]
grads:  [0.14298358]
Stock Position:  0.1429835777126935
Bond Position:  [-14.43968052]


portfolio before change:  [-0.97782116]
curr_Stock_Price:  94.16231324145859
curr_Factors:  [94.16231324]
mat_Sqrt:  [[0.15]]
grads:  [0.01736357]
Stock Position:  0.017363572900666646
Bond Position:  [-2.61281535]


portfolio before change:  [-0.98349575]
curr_Stock_Price:  93.85431416259264
curr_Factors:  [93.85431416]
mat_Sqrt:  [[0.15]]
grads:  [-0.07443129]
Stock Position:  -0.07443129295926401
Bond Position:  [6.00220221]


portfolio before change:  [-0.94395654]
curr_Stock_Price:  93.33317733977434
curr_Factors:  [93.33317734]
mat_Sqrt:  [[0.15]]
grads:  [-0.08154138]
Stock Position:  -0.08154138134855135
Bond Position:  [6.66655967]


portfolio before change:  [-0.94664049]
curr_Stock_Price:  93.37631277468195
curr_Factors:  [93.37631277]
mat_Sqrt:  [[0.15]]
grads:  [-0.02920914]
Stock Position:  -0.02920913643603315
Bond Position:  [1.78080097]


portfolio before change:  [-0.91531933]
curr_Stock_Price:  92.31162736702028
curr_Factors:  [92.31162737]
mat_Sqrt:  [[0.15]]
grads:  [-0.04486522]
Stock Position:  -0.04486522368396507
Bond Position:  [3.22626248]


portfolio before change:  [-0.83117904]
curr_Stock_Price:  90.44521559826666
curr_Factors:  [90.4452156]
mat_Sqrt:  [[0.15]]
grads:  [0.00873582]
Stock Position:  0.008735815459784864
Bond Position:  [-1.62129175]


portfolio before change:  [-0.82088527]
curr_Stock_Price:  91.6467569720361
curr_Factors:  [91.64675697]
mat_Sqrt:  [[0.15]]
grads:  [0.11595245]
Stock Position:  0.11595245346804099
Bond Position:  [-11.4475516]


portfolio before change:  [-0.84773546]
curr_Stock_Price:  91.42753643841714
curr_Factors:  [91.42753644]
mat_Sqrt:  [[0.15]]
grads:  [0.10007033]
Stock Position:  0.10007033178239234
Bond Position:  [-9.99691937]


portfolio before change:  [-0.92329449]
curr_Stock_Price:  90.68496534405853
curr_Factors:  [90.68496534]
mat_Sqrt:  [[0.15]]
grads:  [0.09021356]
Stock Position:  0.09021356390739907
Bond Position:  [-9.10430841]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.92329449]
Stock Price:  91.37523696529408
PL:  [-0.92329449]
Settle:  Tensor("sub_198:0", shape=(), dtype=float64)
PL:  Tensor("sub_199:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  100
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.22513168e-03]
 [ 2.40456654e-03]
 [-2.95793662e-03]
 [ 1.76561437e-02]
 [ 1.97770420e-02]
 [ 3.43588097e-02]
 [ 5.92077696e-03]
 [ 4.41128128e-04]
 [ 9.71789113e-03]
 [ 1.31449432e-02]
 [ 2.13823700e-02]
 [-8.87148496e-03]
 [-1.26194993e-02]
 [ 3.37524095e-03]
 [-1.03665994e-03]
 [-2.99746721e-02]
 [ 4.68819870e-03]
 [-1.27989281e-02]
 [ 1.34453054e-02]
 [-4.77773774e-03]
 [-3.35895409e-03]
 [-3.91923600e-02]
 [ 4.84689703e-03]
 [ 1.45275872e-02]
 [-6.15431474e-03]
 [ 1.73511738e-02]
 [-1.74407323e-02]
 [ 1.29666216e-02]
 [ 6.34097683e-02]
 [ 2.66232887e-02]
 [-2.06455605e-02]
 [ 6.22051235e-03]
 [-1.31904512e-02]
 [ 5.09191320e-03]
 [-7.51297836e-03]
 [ 9.69455178e-03]
 [ 2.51502668e-02]
 [ 8.90584671e-03]
 [ 1.91114819e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [30.6451493]
curr_Stock_Price:  101.84924855568158
curr_Factors:  [101.84924856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03483421]
Stock Position:  -0.034834211219143534
Bond Position:  [34.19298754]


portfolio before change:  [30.63413026]
curr_Stock_Price:  102.28828350429352
curr_Factors:  [102.2882835]
mat_Sqrt:  [[0.15]]
grads:  [0.01603044]
Stock Position:  0.016030443569149986
Bond Position:  [28.9944037]


portfolio before change:  [30.63029104]
curr_Stock_Price:  101.82268547812441
curr_Factors:  [101.82268548]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971958]
Stock Position:  -0.019719577497724412
Bond Position:  [32.63819138]


portfolio before change:  [30.65007392]
curr_Stock_Price:  101.02637790066053
curr_Factors:  [101.0263779]
mat_Sqrt:  [[0.15]]
grads:  [0.11770762]
Stock Position:  0.11770762458524683
Bond Position:  [18.75849896]


portfolio before change:  [30.67376756]
curr_Stock_Price:  101.2077483402553
curr_Factors:  [101.20774834]
mat_Sqrt:  [[0.15]]
grads:  [0.13184695]
Stock Position:  0.13184694642578515
Bond Position:  [17.32983499]


portfolio before change:  [30.86397355]
curr_Stock_Price:  102.6339445978523
curr_Factors:  [102.6339446]
mat_Sqrt:  [[0.15]]
grads:  [0.22905873]
Stock Position:  0.22905873110195635
Bond Position:  [7.35477243]


portfolio before change:  [30.8828773]
curr_Stock_Price:  102.71245873930391
curr_Factors:  [102.71245874]
mat_Sqrt:  [[0.15]]
grads:  [0.03947185]
Stock Position:  0.039471846399380645
Bond Position:  [26.82862691]


portfolio before change:  [30.86796896]
curr_Stock_Price:  102.24979665034789
curr_Factors:  [102.24979665]
mat_Sqrt:  [[0.15]]
grads:  [0.00294085]
Stock Position:  0.0029408541870622443
Bond Position:  [30.56726722]


portfolio before change:  [30.87289323]
curr_Stock_Price:  102.62489947182878
curr_Factors:  [102.62489947]
mat_Sqrt:  [[0.15]]
grads:  [0.06478594]
Stock Position:  0.06478594086354426
Bond Position:  [24.22424256]


portfolio before change:  [30.94163649]
curr_Stock_Price:  103.63924043270806
curr_Factors:  [103.63924043]
mat_Sqrt:  [[0.15]]
grads:  [0.08763295]
Stock Position:  0.0876329548874759
Bond Position:  [21.8594236]


portfolio before change:  [30.95633125]
curr_Stock_Price:  103.77574343433025
curr_Factors:  [103.77574343]
mat_Sqrt:  [[0.15]]
grads:  [0.14254913]
Stock Position:  0.1425491331133749
Bond Position:  [16.16318898]


portfolio before change:  [30.9872857]
curr_Stock_Price:  103.97871855795243
curr_Factors:  [103.97871856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05914323]
Stock Position:  -0.059143233094281884
Bond Position:  [37.13692329]


portfolio before change:  [31.00573034]
curr_Stock_Price:  103.74534882055458
curr_Factors:  [103.74534882]
mat_Sqrt:  [[0.15]]
grads:  [-0.08413]
Stock Position:  -0.08412999555447255
Bond Position:  [39.73382608]


portfolio before change:  [31.02523442]
curr_Stock_Price:  103.5725562223615
curr_Factors:  [103.57255622]
mat_Sqrt:  [[0.15]]
grads:  [0.02250161]
Stock Position:  0.02250160632343713
Bond Position:  [28.69468554]


portfolio before change:  [31.01712485]
curr_Stock_Price:  103.05274299067395
curr_Factors:  [103.05274299]
mat_Sqrt:  [[0.15]]
grads:  [-0.00691107]
Stock Position:  -0.006911066242706177
Bond Position:  [31.72932918]


portfolio before change:  [31.01395726]
curr_Stock_Price:  104.08500109540775
curr_Factors:  [104.0850011]
mat_Sqrt:  [[0.15]]
grads:  [-0.19983115]
Stock Position:  -0.19983114736583016
Bond Position:  [51.81338245]


portfolio before change:  [30.66822047]
curr_Stock_Price:  105.84755851891336
curr_Factors:  [105.84755852]
mat_Sqrt:  [[0.15]]
grads:  [0.03125466]
Stock Position:  0.031254658001746004
Bond Position:  [27.35999122]


portfolio before change:  [30.68555571]
curr_Stock_Price:  106.29277322014273
curr_Factors:  [106.29277322]
mat_Sqrt:  [[0.15]]
grads:  [-0.08532619]
Stock Position:  -0.08532618749909299
Bond Position:  [39.75511281]


portfolio before change:  [30.70081563]
curr_Stock_Price:  106.17217459358879
curr_Factors:  [106.17217459]
mat_Sqrt:  [[0.15]]
grads:  [0.08963537]
Stock Position:  0.08963536943054302
Bond Position:  [21.18403354]


portfolio before change:  [30.73926252]
curr_Stock_Price:  106.57155620659476
curr_Factors:  [106.57155621]
mat_Sqrt:  [[0.15]]
grads:  [-0.03185158]
Stock Position:  -0.031851584904349826
Bond Position:  [34.13373549]


portfolio before change:  [30.71219964]
curr_Stock_Price:  107.55517640270327
curr_Factors:  [107.5551764]
mat_Sqrt:  [[0.15]]
grads:  [-0.02239303]
Stock Position:  -0.022393027235048876
Bond Position:  [33.12068564]


portfolio before change:  [30.72981468]
curr_Stock_Price:  106.95344022946702
curr_Factors:  [106.95344023]
mat_Sqrt:  [[0.15]]
grads:  [-0.2612824]
Stock Position:  -0.26128239970276934
Bond Position:  [58.6748662]


portfolio before change:  [30.67217511]
curr_Stock_Price:  107.2021151887614
curr_Factors:  [107.20211519]
mat_Sqrt:  [[0.15]]
grads:  [0.03231265]
Stock Position:  0.03231264685605495
Bond Position:  [27.20819102]


portfolio before change:  [30.71130782]
curr_Stock_Price:  108.30791975042594
curr_Factors:  [108.30791975]
mat_Sqrt:  [[0.15]]
grads:  [0.09685058]
Stock Position:  0.09685058139730521
Bond Position:  [20.22162282]


portfolio before change:  [30.66070235]
curr_Stock_Price:  107.75930842661077
curr_Factors:  [107.75930843]
mat_Sqrt:  [[0.15]]
grads:  [-0.04102876]
Stock Position:  -0.04102876493347588
Bond Position:  [35.08193369]


portfolio before change:  [30.68845346]
curr_Stock_Price:  107.18981551142844
curr_Factors:  [107.18981551]
mat_Sqrt:  [[0.15]]
grads:  [0.11567449]
Stock Position:  0.11567449180401006
Bond Position:  [18.28932602]


portfolio before change:  [30.77661495]
curr_Stock_Price:  107.93220200462397
curr_Factors:  [107.932202]
mat_Sqrt:  [[0.15]]
grads:  [-0.11627155]
Stock Position:  -0.1162715484226507
Bond Position:  [43.3260592]


portfolio before change:  [30.77481541]
curr_Stock_Price:  107.9942604750631
curr_Factors:  [107.99426048]
mat_Sqrt:  [[0.15]]
grads:  [0.08644414]
Stock Position:  0.08644414410068027
Bond Position:  [21.43934399]


portfolio before change:  [30.67262355]
curr_Stock_Price:  106.78108468318149
curr_Factors:  [106.78108468]
mat_Sqrt:  [[0.15]]
grads:  [0.42273179]
Stock Position:  0.42273178889603064
Bond Position:  [-14.4671354]


portfolio before change:  [30.43261271]
curr_Stock_Price:  106.21760130654364
curr_Factors:  [106.21760131]
mat_Sqrt:  [[0.15]]
grads:  [0.17748859]
Stock Position:  0.17748859147138865
Bond Position:  [11.58020027]


portfolio before change:  [30.23441356]
curr_Stock_Price:  105.09275849736788
curr_Factors:  [105.0927585]
mat_Sqrt:  [[0.15]]
grads:  [-0.13763707]
Stock Position:  -0.13763707002825742
Bond Position:  [44.69907292]


portfolio before change:  [30.28431915]
curr_Stock_Price:  104.77076783542168
curr_Factors:  [104.77076784]
mat_Sqrt:  [[0.15]]
grads:  [0.04147008]
Stock Position:  0.04147008233073016
Bond Position:  [25.93946678]


portfolio before change:  [30.36923233]
curr_Stock_Price:  106.74015251148096
curr_Factors:  [106.74015251]
mat_Sqrt:  [[0.15]]
grads:  [-0.08793634]
Stock Position:  -0.08793634104654904
Bond Position:  [39.75557078]


portfolio before change:  [30.35171723]
curr_Stock_Price:  106.99584720859455
curr_Factors:  [106.99584721]
mat_Sqrt:  [[0.15]]
grads:  [0.03394609]
Stock Position:  0.03394608798459548
Bond Position:  [26.71962678]


portfolio before change:  [30.3936771]
curr_Stock_Price:  108.13352502835433
curr_Factors:  [108.13352503]
mat_Sqrt:  [[0.15]]
grads:  [-0.05008652]
Stock Position:  -0.05008652242890314
Bond Position:  [35.80970933]


portfolio before change:  [30.3504783]
curr_Stock_Price:  109.08538375279609
curr_Factors:  [109.08538375]
mat_Sqrt:  [[0.15]]
grads:  [0.06463035]
Stock Position:  0.06463034521006428
Bond Position:  [23.30025229]


portfolio before change:  [30.38287239]
curr_Stock_Price:  109.54153757165007
curr_Factors:  [109.54153757]
mat_Sqrt:  [[0.15]]
grads:  [0.16766845]
Stock Position:  0.16766844521005303
Bond Position:  [12.0162131]


portfolio before change:  [30.09718748]
curr_Stock_Price:  107.82871062317795
curr_Factors:  [107.82871062]
mat_Sqrt:  [[0.15]]
grads:  [0.05937231]
Stock Position:  0.059372311398784135
Bond Position:  [23.6951477]


portfolio before change:  [30.03668632]
curr_Stock_Price:  106.75980756597032
curr_Factors:  [106.75980757]
mat_Sqrt:  [[0.15]]
grads:  [0.12740988]
Stock Position:  0.12740987934427625
Bond Position:  [16.43443211]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [30.03668632]
Stock Price:  106.5703328666299
PL:  [23.46635345]
Settle:  Tensor("sub_200:0", shape=(), dtype=float64)
PL:  Tensor("sub_201:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  101
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.38095807e-03]
 [-9.92339933e-03]
 [-3.90421869e-03]
 [ 3.73582753e-02]
 [ 1.24751665e-02]
 [ 1.65859650e-02]
 [ 5.78746905e-03]
 [-3.12603266e-03]
 [ 1.78307140e-02]
 [-4.35613917e-03]
 [ 5.81441538e-03]
 [ 1.00035855e-02]
 [ 3.42871259e-03]
 [ 9.70540967e-03]
 [-4.21942073e-03]
 [-1.31656536e-02]
 [-3.66148528e-03]
 [-3.16466535e-03]
 [-1.02988393e-02]
 [-2.27027047e-03]
 [ 7.07183845e-05]
 [ 4.46355288e-03]
 [ 4.77764812e-03]
 [ 7.66298108e-03]
 [-4.01005235e-03]
 [-9.05884819e-03]
 [ 6.08094290e-03]
 [-1.99416697e-02]
 [-1.97702602e-02]
 [ 2.18472901e-02]
 [ 8.91875513e-03]
 [ 5.99187229e-03]
 [-1.24698578e-02]
 [-6.66427067e-03]
 [-5.44136402e-03]
 [-6.30838212e-03]
 [ 2.28445299e-02]
 [-1.36010748e-04]
 [ 2.26149636e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.00429619]
curr_Stock_Price:  100.58394413035413
curr_Factors:  [100.58394413]
mat_Sqrt:  [[0.15]]
grads:  [-0.00920639]
Stock Position:  -0.009206387114309466
Bond Position:  [11.93031092]


portfolio before change:  [11.00486675]
curr_Stock_Price:  100.68396431781126
curr_Factors:  [100.68396432]
mat_Sqrt:  [[0.15]]
grads:  [-0.066156]
Stock Position:  -0.06615599555328446
Bond Position:  [17.66571464]


portfolio before change:  [10.94176695]
curr_Stock_Price:  101.67114851105737
curr_Factors:  [101.67114851]
mat_Sqrt:  [[0.15]]
grads:  [-0.02602812]
Stock Position:  -0.026028124581815318
Bond Position:  [13.58807627]


portfolio before change:  [10.94532117]
curr_Stock_Price:  101.59985599869626
curr_Factors:  [101.599856]
mat_Sqrt:  [[0.15]]
grads:  [0.24905517]
Stock Position:  0.2490551683782146
Bond Position:  [-14.35864807]


portfolio before change:  [10.68822225]
curr_Stock_Price:  100.5747659162865
curr_Factors:  [100.57476592]
mat_Sqrt:  [[0.15]]
grads:  [0.08316778]
Stock Position:  0.08316777670984113
Bond Position:  [2.32364257]


portfolio before change:  [10.60608184]
curr_Stock_Price:  99.58362622098532
curr_Factors:  [99.58362622]
mat_Sqrt:  [[0.15]]
grads:  [0.1105731]
Stock Position:  0.11057309968077421
Bond Position:  [-0.40518839]


portfolio before change:  [10.43272337]
curr_Stock_Price:  98.0162665993507
curr_Factors:  [98.0162666]
mat_Sqrt:  [[0.15]]
grads:  [0.03858313]
Stock Position:  0.03858312698084488
Bond Position:  [6.65094931]


portfolio before change:  [10.48398762]
curr_Stock_Price:  99.32338775299398
curr_Factors:  [99.32338775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02084022]
Stock Position:  -0.020840217725102313
Bond Position:  [12.55390864]


portfolio before change:  [10.49031962]
curr_Stock_Price:  99.09485516403906
curr_Factors:  [99.09485516]
mat_Sqrt:  [[0.15]]
grads:  [0.11887143]
Stock Position:  0.11887142643212836
Bond Position:  [-1.28922716]


portfolio before change:  [10.52729858]
curr_Stock_Price:  99.40729465201686
curr_Factors:  [99.40729465]
mat_Sqrt:  [[0.15]]
grads:  [-0.02904093]
Stock Position:  -0.02904092777685172
Bond Position:  [13.41417865]


portfolio before change:  [10.51173326]
curr_Stock_Price:  100.00101532661049
curr_Factors:  [100.00101533]
mat_Sqrt:  [[0.15]]
grads:  [0.03876277]
Stock Position:  0.03876276921893625
Bond Position:  [6.63541698]


portfolio before change:  [10.49594406]
curr_Stock_Price:  99.57228751444097
curr_Factors:  [99.57228751]
mat_Sqrt:  [[0.15]]
grads:  [0.06669057]
Stock Position:  0.06669056982073258
Bond Position:  [3.85541147]


portfolio before change:  [10.42790898]
curr_Stock_Price:  98.54490031043541
curr_Factors:  [98.54490031]
mat_Sqrt:  [[0.15]]
grads:  [0.02285808]
Stock Position:  0.02285808393990201
Bond Position:  [8.17536138]


portfolio before change:  [10.44454936]
curr_Stock_Price:  99.22817687467652
curr_Factors:  [99.22817687]
mat_Sqrt:  [[0.15]]
grads:  [0.06470273]
Stock Position:  0.06470273114738617
Bond Position:  [4.02421531]


portfolio before change:  [10.46616184]
curr_Stock_Price:  99.55442933121336
curr_Factors:  [99.55442933]
mat_Sqrt:  [[0.15]]
grads:  [-0.02812947]
Stock Position:  -0.02812947151935677
Bond Position:  [13.26657533]


portfolio before change:  [10.46100347]
curr_Stock_Price:  99.79676602994738
curr_Factors:  [99.79676603]
mat_Sqrt:  [[0.15]]
grads:  [-0.08777102]
Stock Position:  -0.0877710237548607
Bond Position:  [19.22026779]


portfolio before change:  [10.58935438]
curr_Stock_Price:  98.36180238871309
curr_Factors:  [98.36180239]
mat_Sqrt:  [[0.15]]
grads:  [-0.0244099]
Stock Position:  -0.02440990188908651
Bond Position:  [12.99035632]


portfolio before change:  [10.57410758]
curr_Stock_Price:  99.05294374004357
curr_Factors:  [99.05294374]
mat_Sqrt:  [[0.15]]
grads:  [-0.02109777]
Stock Position:  -0.02109776900410173
Bond Position:  [12.66390371]


portfolio before change:  [10.56146802]
curr_Stock_Price:  99.72707410619189
curr_Factors:  [99.72707411]
mat_Sqrt:  [[0.15]]
grads:  [-0.06865893]
Stock Position:  -0.06865892885771509
Bond Position:  [17.40862211]


portfolio before change:  [10.5371619]
curr_Stock_Price:  100.11278260958942
curr_Factors:  [100.11278261]
mat_Sqrt:  [[0.15]]
grads:  [-0.01513514]
Stock Position:  -0.015135136491887522
Bond Position:  [12.05238253]


portfolio before change:  [10.52086497]
curr_Stock_Price:  101.28909034058816
curr_Factors:  [101.28909034]
mat_Sqrt:  [[0.15]]
grads:  [0.00047146]
Stock Position:  0.00047145589676349155
Bond Position:  [10.47311163]


portfolio before change:  [10.52200454]
curr_Stock_Price:  100.9292644638771
curr_Factors:  [100.92926446]
mat_Sqrt:  [[0.15]]
grads:  [0.02975702]
Stock Position:  0.029757019179569574
Bond Position:  [7.51865049]


portfolio before change:  [10.51520589]
curr_Stock_Price:  100.66920670889203
curr_Factors:  [100.66920671]
mat_Sqrt:  [[0.15]]
grads:  [0.03185099]
Stock Position:  0.03185098744925948
Bond Position:  [7.30879225]


portfolio before change:  [10.55240102]
curr_Stock_Price:  101.80830723614335
curr_Factors:  [101.80830724]
mat_Sqrt:  [[0.15]]
grads:  [0.05108654]
Stock Position:  0.05108654050959621
Bond Position:  [5.35136681]


portfolio before change:  [10.49145888]
curr_Stock_Price:  100.60229278475185
curr_Factors:  [100.60229278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02673368]
Stock Position:  -0.026733682311151776
Bond Position:  [13.18092862]


portfolio before change:  [10.48928779]
curr_Stock_Price:  100.74513906824383
curr_Factors:  [100.74513907]
mat_Sqrt:  [[0.15]]
grads:  [-0.06039232]
Stock Position:  -0.06039232126028543
Bond Position:  [16.5735206]


portfolio before change:  [10.4517525]
curr_Stock_Price:  101.40096937868665
curr_Factors:  [101.40096938]
mat_Sqrt:  [[0.15]]
grads:  [0.04053962]
Stock Position:  0.040539619320791115
Bond Position:  [6.3409958]


portfolio before change:  [10.41318111]
curr_Stock_Price:  100.4299671332889
curr_Factors:  [100.42996713]
mat_Sqrt:  [[0.15]]
grads:  [-0.13294446]
Stock Position:  -0.13294446483629604
Bond Position:  [23.76478934]


portfolio before change:  [10.46270052]
curr_Stock_Price:  100.07983125599895
curr_Factors:  [100.07983126]
mat_Sqrt:  [[0.15]]
grads:  [-0.13180173]
Stock Position:  -0.13180173437190704
Bond Position:  [23.65339586]


portfolio before change:  [10.36500193]
curr_Stock_Price:  100.84351957670485
curr_Factors:  [100.84351958]
mat_Sqrt:  [[0.15]]
grads:  [0.1456486]
Stock Position:  0.14564860056679485
Bond Position:  [-4.32271557]


portfolio before change:  [10.26489525]
curr_Stock_Price:  100.15991322072799
curr_Factors:  [100.15991322]
mat_Sqrt:  [[0.15]]
grads:  [0.05945837]
Stock Position:  0.059458367526157116
Bond Position:  [4.30955032]


portfolio before change:  [10.33358501]
curr_Stock_Price:  101.30611063172516
curr_Factors:  [101.30611063]
mat_Sqrt:  [[0.15]]
grads:  [0.03994582]
Stock Position:  0.03994581529429088
Bond Position:  [6.28682982]


portfolio before change:  [10.32480001]
curr_Stock_Price:  101.06651363467545
curr_Factors:  [101.06651363]
mat_Sqrt:  [[0.15]]
grads:  [-0.08313239]
Stock Position:  -0.08313238536461674
Bond Position:  [18.72670037]


portfolio before change:  [10.29653019]
curr_Stock_Price:  101.43473117137117
curr_Factors:  [101.43473117]
mat_Sqrt:  [[0.15]]
grads:  [-0.04442847]
Stock Position:  -0.04442847110246929
Bond Position:  [14.80312022]


portfolio before change:  [10.28814889]
curr_Stock_Price:  101.66502966879071
curr_Factors:  [101.66502967]
mat_Sqrt:  [[0.15]]
grads:  [-0.03627576]
Stock Position:  -0.036275760111078685
Bond Position:  [13.97612512]


portfolio before change:  [10.30279858]
curr_Stock_Price:  101.30934955732987
curr_Factors:  [101.30934956]
mat_Sqrt:  [[0.15]]
grads:  [-0.04205588]
Stock Position:  -0.04205588079067778
Bond Position:  [14.56345251]


portfolio before change:  [10.31104296]
curr_Stock_Price:  101.15660441464448
curr_Factors:  [101.15660441]
mat_Sqrt:  [[0.15]]
grads:  [0.15229687]
Stock Position:  0.15229686605287143
Bond Position:  [-5.09479088]


portfolio before change:  [10.51980335]
curr_Stock_Price:  102.53153278433771
curr_Factors:  [102.53153278]
mat_Sqrt:  [[0.15]]
grads:  [-0.00090674]
Stock Position:  -0.000906738319809077
Bond Position:  [10.61277262]


portfolio before change:  [10.52181227]
curr_Stock_Price:  101.77912060249413
curr_Factors:  [101.7791206]
mat_Sqrt:  [[0.15]]
grads:  [0.15076642]
Stock Position:  0.15076642373497293
Bond Position:  [-4.82306175]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.52181227]
Stock Price:  103.1440871810586
PL:  [7.37772509]
Settle:  Tensor("sub_202:0", shape=(), dtype=float64)
PL:  Tensor("sub_203:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  102
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.64568995e-03]
 [ 1.81783089e-03]
 [ 1.28365246e-03]
 [ 7.80052473e-02]
 [-4.43457942e-02]
 [ 3.18353138e-02]
 [ 6.46931767e-03]
 [ 5.77718809e-04]
 [ 9.62869009e-03]
 [ 1.22468903e-02]
 [ 2.66564920e-02]
 [ 1.13290446e-02]
 [-1.12763115e-02]
 [ 1.06712250e-02]
 [ 9.76240158e-04]
 [-2.66336354e-02]
 [ 4.41303103e-03]
 [ 2.10120223e-03]
 [-6.19644432e-03]
 [-2.61335154e-03]
 [ 1.66411110e-04]
 [ 1.01005130e-02]
 [ 4.77493631e-03]
 [ 6.03616605e-03]
 [-4.43335614e-03]
 [-7.48586324e-03]
 [-1.24026250e-03]
 [-2.05568523e-02]
 [-3.78310336e-02]
 [ 2.15906532e-02]
 [ 4.49384713e-03]
 [-1.51796340e-03]
 [-1.24711075e-02]
 [-5.38099321e-03]
 [-6.20333686e-03]
 [-7.44669931e-03]
 [ 2.27414183e-02]
 [ 7.35948095e-03]
 [ 2.31605287e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [22.30594962]
curr_Stock_Price:  101.31202004528063
curr_Factors:  [101.31202005]
mat_Sqrt:  [[0.15]]
grads:  [-0.0243046]
Stock Position:  -0.024304599640222725
Bond Position:  [24.76829771]


portfolio before change:  [22.28863089]
curr_Stock_Price:  102.1519831554118
curr_Factors:  [102.15198316]
mat_Sqrt:  [[0.15]]
grads:  [0.01211887]
Stock Position:  0.012118872622225154
Bond Position:  [21.05066401]


portfolio before change:  [22.29957788]
curr_Stock_Price:  102.83814372097935
curr_Factors:  [102.83814372]
mat_Sqrt:  [[0.15]]
grads:  [0.00855768]
Stock Position:  0.008557683096309712
Bond Position:  [21.41952163]


portfolio before change:  [22.30297905]
curr_Stock_Price:  102.92269558098216
curr_Factors:  [102.92269558]
mat_Sqrt:  [[0.15]]
grads:  [0.52003498]
Stock Position:  0.5200349819469784
Bond Position:  [-31.22042309]


portfolio before change:  [22.6402683]
curr_Stock_Price:  103.57878999247426
curr_Factors:  [103.57878999]
mat_Sqrt:  [[0.15]]
grads:  [-0.29563863]
Stock Position:  -0.29563862771263516
Bond Position:  [53.26215963]


portfolio before change:  [23.06232009]
curr_Stock_Price:  102.17371783029853
curr_Factors:  [102.17371783]
mat_Sqrt:  [[0.15]]
grads:  [0.21223543]
Stock Position:  0.21223542516191668
Bond Position:  [1.37743765]


portfolio before change:  [23.15506631]
curr_Stock_Price:  102.60990338367777
curr_Factors:  [102.60990338]
mat_Sqrt:  [[0.15]]
grads:  [0.04312878]
Stock Position:  0.04312878449023792
Bond Position:  [18.7296259]


portfolio before change:  [23.14688972]
curr_Stock_Price:  102.36603050060451
curr_Factors:  [102.3660305]
mat_Sqrt:  [[0.15]]
grads:  [0.00385146]
Stock Position:  0.003851458724080332
Bond Position:  [22.75263118]


portfolio before change:  [23.15061766]
curr_Stock_Price:  102.59547135200864
curr_Factors:  [102.59547135]
mat_Sqrt:  [[0.15]]
grads:  [0.06419127]
Stock Position:  0.06419126726576302
Bond Position:  [16.56488433]


portfolio before change:  [23.1552703]
curr_Stock_Price:  102.635693467235
curr_Factors:  [102.63569347]
mat_Sqrt:  [[0.15]]
grads:  [0.08164594]
Stock Position:  0.08164593530604193
Bond Position:  [14.77548311]


portfolio before change:  [23.13243047]
curr_Stock_Price:  102.33332838930374
curr_Factors:  [102.33332839]
mat_Sqrt:  [[0.15]]
grads:  [0.17770995]
Stock Position:  0.17770994647702373
Bond Position:  [4.94678016]


portfolio before change:  [22.98193422]
curr_Stock_Price:  101.482984065758
curr_Factors:  [101.48298407]
mat_Sqrt:  [[0.15]]
grads:  [0.07552696]
Stock Position:  0.07552696411722908
Bond Position:  [15.31723252]


portfolio before change:  [22.98516002]
curr_Stock_Price:  101.50034251151926
curr_Factors:  [101.50034251]
mat_Sqrt:  [[0.15]]
grads:  [-0.07517541]
Stock Position:  -0.07517541001660219
Bond Position:  [30.61548989]


portfolio before change:  [22.91141824]
curr_Stock_Price:  102.53218196693197
curr_Factors:  [102.53218197]
mat_Sqrt:  [[0.15]]
grads:  [0.0711415]
Stock Position:  0.07114149978448053
Bond Position:  [15.61712504]


portfolio before change:  [23.00646281]
curr_Stock_Price:  103.84073326394632
curr_Factors:  [103.84073326]
mat_Sqrt:  [[0.15]]
grads:  [0.00650827]
Stock Position:  0.006508267718406564
Bond Position:  [22.33063951]


portfolio before change:  [22.99871767]
curr_Stock_Price:  102.22177125204433
curr_Factors:  [102.22177125]
mat_Sqrt:  [[0.15]]
grads:  [-0.17755757]
Stock Position:  -0.1775575694947527
Bond Position:  [41.14896693]


portfolio before change:  [23.13699214]
curr_Stock_Price:  101.47198333370795
curr_Factors:  [101.47198333]
mat_Sqrt:  [[0.15]]
grads:  [0.02942021]
Stock Position:  0.029420206865232112
Bond Position:  [20.1516654]


portfolio before change:  [23.15255852]
curr_Stock_Price:  101.91546306501137
curr_Factors:  [101.91546307]
mat_Sqrt:  [[0.15]]
grads:  [0.01400801]
Stock Position:  0.014008014845035255
Bond Position:  [21.7249252]


portfolio before change:  [23.15452731]
curr_Stock_Price:  101.86213727411109
curr_Factors:  [101.86213727]
mat_Sqrt:  [[0.15]]
grads:  [-0.04130963]
Stock Position:  -0.041309628774467845
Bond Position:  [27.36241439]


portfolio before change:  [23.13302561]
curr_Stock_Price:  102.46544008304625
curr_Factors:  [102.46544008]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742234]
Stock Position:  -0.017422343606006217
Bond Position:  [24.91821372]


portfolio before change:  [23.15956163]
curr_Stock_Price:  101.12112929298655
curr_Factors:  [101.12112929]
mat_Sqrt:  [[0.15]]
grads:  [0.00110941]
Stock Position:  0.0011094073988714601
Bond Position:  [23.0473771]


portfolio before change:  [23.16135999]
curr_Stock_Price:  100.14516648049786
curr_Factors:  [100.14516648]
mat_Sqrt:  [[0.15]]
grads:  [0.06733675]
Stock Position:  0.06733675313277432
Bond Position:  [16.41790964]


portfolio before change:  [23.18154019]
curr_Stock_Price:  100.41437800809754
curr_Factors:  [100.41437801]
mat_Sqrt:  [[0.15]]
grads:  [0.03183291]
Stock Position:  0.031832908717244014
Bond Position:  [19.98505846]


portfolio before change:  [23.15483031]
curr_Stock_Price:  99.49683167275056
curr_Factors:  [99.49683167]
mat_Sqrt:  [[0.15]]
grads:  [0.04024111]
Stock Position:  0.040241106988822335
Bond Position:  [19.15096766]


portfolio before change:  [23.18019643]
curr_Stock_Price:  100.06769333495848
curr_Factors:  [100.06769333]
mat_Sqrt:  [[0.15]]
grads:  [-0.02955571]
Stock Position:  -0.02955570756866807
Bond Position:  [26.13776792]


portfolio before change:  [23.20801024]
curr_Stock_Price:  99.23718108801413
curr_Factors:  [99.23718109]
mat_Sqrt:  [[0.15]]
grads:  [-0.04990575]
Stock Position:  -0.04990575495610451
Bond Position:  [28.16051668]


portfolio before change:  [23.2501239]
curr_Stock_Price:  98.46385587673477
curr_Factors:  [98.46385588]
mat_Sqrt:  [[0.15]]
grads:  [-0.00826842]
Stock Position:  -0.008268416684443598
Bond Position:  [24.06426409]


portfolio before change:  [23.25765341]
curr_Stock_Price:  97.9170410311073
curr_Factors:  [97.91704103]
mat_Sqrt:  [[0.15]]
grads:  [-0.13704568]
Stock Position:  -0.13704568186496074
Bond Position:  [36.67676107]


portfolio before change:  [23.1713642]
curr_Stock_Price:  98.58013451878332
curr_Factors:  [98.58013452]
mat_Sqrt:  [[0.15]]
grads:  [-0.25220689]
Stock Position:  -0.2522068908739463
Bond Position:  [48.03395343]


portfolio before change:  [22.95685933]
curr_Stock_Price:  99.45445435045966
curr_Factors:  [99.45445435]
mat_Sqrt:  [[0.15]]
grads:  [0.14393769]
Stock Position:  0.14393768789915537
Bond Position:  [8.64161512]


portfolio before change:  [22.79970478]
curr_Stock_Price:  98.35512573664072
curr_Factors:  [98.35512574]
mat_Sqrt:  [[0.15]]
grads:  [0.02995898]
Stock Position:  0.029958980841961632
Bond Position:  [19.85308545]


portfolio before change:  [22.81557098]
curr_Stock_Price:  98.80188365696601
curr_Factors:  [98.80188366]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011976]
Stock Position:  -0.01011975601119138
Bond Position:  [23.81542194]


portfolio before change:  [22.80206284]
curr_Stock_Price:  100.43090129586072
curr_Factors:  [100.4309013]
mat_Sqrt:  [[0.15]]
grads:  [-0.08314072]
Stock Position:  -0.0831407167253127
Bond Position:  [31.15195995]


portfolio before change:  [22.77391334]
curr_Stock_Price:  100.81631697138985
curr_Factors:  [100.81631697]
mat_Sqrt:  [[0.15]]
grads:  [-0.03587329]
Stock Position:  -0.03587328805465486
Bond Position:  [26.39052612]


portfolio before change:  [22.79398028]
curr_Stock_Price:  100.34889613283475
curr_Factors:  [100.34889613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04135558]
Stock Position:  -0.04135557906701538
Bond Position:  [26.94396699]


portfolio before change:  [22.80229348]
curr_Stock_Price:  100.22932350597199
curr_Factors:  [100.22932351]
mat_Sqrt:  [[0.15]]
grads:  [-0.04964466]
Stock Position:  -0.04964466207221342
Bond Position:  [27.77814438]


portfolio before change:  [22.80035748]
curr_Stock_Price:  100.33826756914974
curr_Factors:  [100.33826757]
mat_Sqrt:  [[0.15]]
grads:  [0.15160946]
Stock Position:  0.15160945540461457
Bond Position:  [7.58812738]


portfolio before change:  [22.74702106]
curr_Stock_Price:  99.98020949916953
curr_Factors:  [99.9802095]
mat_Sqrt:  [[0.15]]
grads:  [0.04906321]
Stock Position:  0.04906320631218873
Bond Position:  [17.84167142]


portfolio before change:  [22.68361455]
curr_Stock_Price:  98.64240728856902
curr_Factors:  [98.64240729]
mat_Sqrt:  [[0.15]]
grads:  [0.15440352]
Stock Position:  0.1544035246293514
Bond Position:  [7.45287918]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [22.68361455]
Stock Price:  98.96654892477147
PL:  [22.68361455]
Settle:  Tensor("sub_204:0", shape=(), dtype=float64)
PL:  Tensor("sub_205:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  103
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44910405e-03]
 [-3.24827315e-03]
 [-4.69819567e-04]
 [ 2.67095577e-02]
 [ 7.04358079e-03]
 [ 2.80662636e-02]
 [ 2.65305923e-02]
 [-2.45848680e-03]
 [ 8.47412168e-03]
 [-3.46906392e-03]
 [ 8.06016306e-03]
 [ 7.19946240e-03]
 [-6.79891689e-03]
 [ 1.03347587e-02]
 [-4.08474404e-03]
 [-9.75169313e-03]
 [-1.63478229e-03]
 [-3.20366537e-03]
 [-7.43356708e-03]
 [-2.37789322e-03]
 [ 3.22282353e-04]
 [ 1.04846496e-02]
 [ 4.75808437e-03]
 [ 5.56024613e-03]
 [-2.95667669e-03]
 [-4.41446713e-03]
 [-7.15537013e-03]
 [-1.87441977e-02]
 [-3.08049231e-02]
 [ 2.20030871e-02]
 [ 3.26251300e-03]
 [-5.77480150e-03]
 [-1.24801309e-02]
 [-1.02495578e-02]
 [-6.96204107e-03]
 [-7.50753082e-03]
 [ 2.21262264e-02]
 [ 8.82689376e-03]
 [ 2.20625270e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.29149689]
curr_Stock_Price:  100.21591377065458
curr_Factors:  [100.21591377]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966069]
Stock Position:  -0.009660693643875212
Bond Position:  [6.25965213]


portfolio before change:  [5.28075034]
curr_Stock_Price:  101.40931230597418
curr_Factors:  [101.40931231]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165515]
Stock Position:  -0.021655154301936583
Bond Position:  [7.47678464]


portfolio before change:  [5.26409158]
curr_Stock_Price:  102.22174770678392
curr_Factors:  [102.22174771]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313213]
Stock Position:  -0.0031321304470208434
Bond Position:  [5.58426343]


portfolio before change:  [5.2676191]
curr_Stock_Price:  101.31838645957134
curr_Factors:  [101.31838646]
mat_Sqrt:  [[0.15]]
grads:  [0.17806372]
Stock Position:  0.1780637178207632
Bond Position:  [-12.77350947]


portfolio before change:  [5.08228062]
curr_Stock_Price:  100.28649911033786
curr_Factors:  [100.28649911]
mat_Sqrt:  [[0.15]]
grads:  [0.04695721]
Stock Position:  0.04695720523891725
Bond Position:  [0.3731069]


portfolio before change:  [5.12488928]
curr_Stock_Price:  101.19289939189918
curr_Factors:  [101.19289939]
mat_Sqrt:  [[0.15]]
grads:  [0.18710842]
Stock Position:  0.18710842432325786
Bond Position:  [-13.80915468]


portfolio before change:  [5.00111713]
curr_Stock_Price:  100.54062571682502
curr_Factors:  [100.54062572]
mat_Sqrt:  [[0.15]]
grads:  [0.17687062]
Stock Position:  0.17687061505147417
Bond Position:  [-12.78156518]


portfolio before change:  [5.0377755]
curr_Stock_Price:  100.75692037047345
curr_Factors:  [100.75692037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01638991]
Stock Position:  -0.016389911972804195
Bond Position:  [6.68917256]


portfolio before change:  [5.0509579]
curr_Stock_Price:  100.00363999693036
curr_Factors:  [100.00364]
mat_Sqrt:  [[0.15]]
grads:  [0.05649414]
Stock Position:  0.056494144537412236
Bond Position:  [-0.59866219]


portfolio before change:  [5.00617948]
curr_Stock_Price:  99.21234418536429
curr_Factors:  [99.21234419]
mat_Sqrt:  [[0.15]]
grads:  [-0.02312709]
Stock Position:  -0.023127092790590113
Bond Position:  [7.30067257]


portfolio before change:  [5.00644515]
curr_Stock_Price:  99.24031908544944
curr_Factors:  [99.24031909]
mat_Sqrt:  [[0.15]]
grads:  [0.05373442]
Stock Position:  0.05373442042343621
Bond Position:  [-0.32617588]


portfolio before change:  [5.00922453]
curr_Stock_Price:  99.29280228454058
curr_Factors:  [99.29280228]
mat_Sqrt:  [[0.15]]
grads:  [0.04799642]
Stock Position:  0.047996416032778336
Bond Position:  [0.24352588]


portfolio before change:  [5.02058517]
curr_Stock_Price:  99.5288656842552
curr_Factors:  [99.52886568]
mat_Sqrt:  [[0.15]]
grads:  [-0.04532611]
Stock Position:  -0.045326112577978334
Bond Position:  [9.53184174]


portfolio before change:  [5.01475239]
curr_Stock_Price:  99.68383894938988
curr_Factors:  [99.68383895]
mat_Sqrt:  [[0.15]]
grads:  [0.06889839]
Stock Position:  0.06889839153767777
Bond Position:  [-1.85330378]


portfolio before change:  [4.99164094]
curr_Stock_Price:  99.35175913053436
curr_Factors:  [99.35175913]
mat_Sqrt:  [[0.15]]
grads:  [-0.02723163]
Stock Position:  -0.02723162693375785
Bond Position:  [7.69715098]


portfolio before change:  [5.0134541]
curr_Stock_Price:  98.58607035304391
curr_Factors:  [98.58607035]
mat_Sqrt:  [[0.15]]
grads:  [-0.06501129]
Stock Position:  -0.06501128753037863
Bond Position:  [11.42266146]


portfolio before change:  [4.97821374]
curr_Stock_Price:  99.15009975656214
curr_Factors:  [99.15009976]
mat_Sqrt:  [[0.15]]
grads:  [-0.01089855]
Stock Position:  -0.010898548614346318
Bond Position:  [6.05880592]


portfolio before change:  [4.9814863]
curr_Stock_Price:  98.91932075968765
curr_Factors:  [98.91932076]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135777]
Stock Position:  -0.021357769125575004
Bond Position:  [7.09418231]


portfolio before change:  [4.98511627]
curr_Stock_Price:  98.79088298677277
curr_Factors:  [98.79088299]
mat_Sqrt:  [[0.15]]
grads:  [-0.04955711]
Stock Position:  -0.04955711386487203
Bond Position:  [9.88090731]


portfolio before change:  [5.02137996]
curr_Stock_Price:  98.08405206723475
curr_Factors:  [98.08405207]
mat_Sqrt:  [[0.15]]
grads:  [-0.01585262]
Stock Position:  -0.015852621453752404
Bond Position:  [6.57626931]


portfolio before change:  [5.0164513]
curr_Stock_Price:  98.44681499426054
curr_Factors:  [98.44681499]
mat_Sqrt:  [[0.15]]
grads:  [0.00214855]
Stock Position:  0.002148549022056726
Bond Position:  [4.80493349]


portfolio before change:  [5.01512338]
curr_Stock_Price:  97.54919537420488
curr_Factors:  [97.54919537]
mat_Sqrt:  [[0.15]]
grads:  [0.06989766]
Stock Position:  0.06989766390341745
Bond Position:  [-1.8033375]


portfolio before change:  [4.97198891]
curr_Stock_Price:  96.93531164915406
curr_Factors:  [96.93531165]
mat_Sqrt:  [[0.15]]
grads:  [0.03172056]
Stock Position:  0.031720562494776894
Bond Position:  [1.8971463]


portfolio before change:  [4.99273161]
curr_Stock_Price:  97.58175501500263
curr_Factors:  [97.58175502]
mat_Sqrt:  [[0.15]]
grads:  [0.03706831]
Stock Position:  0.037068307554565964
Bond Position:  [1.37554111]


portfolio before change:  [5.0133963]
curr_Stock_Price:  98.13459203491195
curr_Factors:  [98.13459203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971118]
Stock Position:  -0.019711177914692055
Bond Position:  [6.9477447]


portfolio before change:  [5.03446004]
curr_Stock_Price:  97.11003552823318
curr_Factors:  [97.11003553]
mat_Sqrt:  [[0.15]]
grads:  [-0.02942978]
Stock Position:  -0.029429780864280632
Bond Position:  [7.8923871]


portfolio before change:  [5.02164501]
curr_Stock_Price:  97.57900379750966
curr_Factors:  [97.5790038]
mat_Sqrt:  [[0.15]]
grads:  [-0.04770247]
Stock Position:  -0.04770246755014831
Bond Position:  [9.67640427]


portfolio before change:  [5.07855812]
curr_Stock_Price:  96.41127632667177
curr_Factors:  [96.41127633]
mat_Sqrt:  [[0.15]]
grads:  [-0.12496132]
Stock Position:  -0.12496131813845962
Bond Position:  [17.12623829]


portfolio before change:  [4.93051901]
curr_Stock_Price:  97.61308842503489
curr_Factors:  [97.61308843]
mat_Sqrt:  [[0.15]]
grads:  [-0.20536615]
Stock Position:  -0.20536615404030675
Bond Position:  [24.97694356]


portfolio before change:  [4.96218878]
curr_Stock_Price:  97.47408083052194
curr_Factors:  [97.47408083]
mat_Sqrt:  [[0.15]]
grads:  [0.14668725]
Stock Position:  0.14668724732389907
Bond Position:  [-9.33601582]


portfolio before change:  [4.89648331]
curr_Stock_Price:  97.03410803866953
curr_Factors:  [97.03410804]
mat_Sqrt:  [[0.15]]
grads:  [0.02175009]
Stock Position:  0.021750086635120878
Bond Position:  [2.78598305]


portfolio before change:  [4.8923298]
curr_Stock_Price:  96.82713069331213
curr_Factors:  [96.82713069]
mat_Sqrt:  [[0.15]]
grads:  [-0.03849868]
Stock Position:  -0.038498676655940846
Bond Position:  [8.6200462]


portfolio before change:  [4.91332827]
curr_Stock_Price:  96.30968706359803
curr_Factors:  [96.30968706]
mat_Sqrt:  [[0.15]]
grads:  [-0.08320087]
Stock Position:  -0.0832008725001159
Bond Position:  [12.92637826]


portfolio before change:  [4.86366947]
curr_Stock_Price:  96.92596304433971
curr_Factors:  [96.92596304]
mat_Sqrt:  [[0.15]]
grads:  [-0.06833039]
Stock Position:  -0.06833038520518445
Bond Position:  [11.48665786]


portfolio before change:  [4.87671383]
curr_Stock_Price:  96.75607614904969
curr_Factors:  [96.75607615]
mat_Sqrt:  [[0.15]]
grads:  [-0.04641361]
Stock Position:  -0.046413607104187016
Bond Position:  [9.36751233]


portfolio before change:  [4.81878926]
curr_Stock_Price:  98.02931433296428
curr_Factors:  [98.02931433]
mat_Sqrt:  [[0.15]]
grads:  [-0.05005021]
Stock Position:  -0.050050205464096005
Bond Position:  [9.72517659]


portfolio before change:  [4.78649743]
curr_Stock_Price:  98.69879318966866
curr_Factors:  [98.69879319]
mat_Sqrt:  [[0.15]]
grads:  [0.14750818]
Stock Position:  0.14750817620864884
Bond Position:  [-9.77238155]


portfolio before change:  [4.57336144]
curr_Stock_Price:  97.26216528855959
curr_Factors:  [97.26216529]
mat_Sqrt:  [[0.15]]
grads:  [0.05884596]
Stock Position:  0.05884595838402572
Bond Position:  [-1.15012389]


portfolio before change:  [4.56649828]
curr_Stock_Price:  97.14797924335865
curr_Factors:  [97.14797924]
mat_Sqrt:  [[0.15]]
grads:  [0.14708351]
Stock Position:  0.14708351360967606
Bond Position:  [-9.72236784]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.56649828]
Stock Price:  97.50431056435374
PL:  [4.56649828]
Settle:  Tensor("sub_206:0", shape=(), dtype=float64)
PL:  Tensor("sub_207:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  104
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.90034617e-03]
 [-3.21429455e-03]
 [-3.01624255e-02]
 [-2.67406601e-02]
 [ 1.29574850e-02]
 [ 1.63290672e-02]
 [ 1.79487733e-02]
 [-3.14344294e-03]
 [ 1.63419712e-02]
 [ 2.51559655e-03]
 [ 1.03796440e-02]
 [ 1.08178945e-02]
 [-9.96239416e-03]
 [ 1.18484544e-02]
 [-7.09114086e-03]
 [-2.79045077e-02]
 [ 1.69881401e-03]
 [-1.98409948e-03]
 [-7.55192100e-03]
 [-2.45476213e-03]
 [ 3.38990805e-04]
 [ 8.62712068e-03]
 [ 4.76767134e-03]
 [ 7.09174400e-03]
 [-4.18555962e-03]
 [-8.12953577e-03]
 [ 1.39701196e-02]
 [-2.01289976e-02]
 [-1.61818115e-02]
 [ 2.18671928e-02]
 [ 9.18456176e-03]
 [ 1.02536937e-03]
 [-1.24975820e-02]
 [-6.14981088e-03]
 [-8.71746849e-03]
 [-7.51339558e-03]
 [ 2.26090521e-02]
 [ 8.30695657e-03]
 [ 2.35705159e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.19626025]
curr_Stock_Price:  99.47584866935401
curr_Factors:  [99.47584867]
mat_Sqrt:  [[0.15]]
grads:  [-0.02600231]
Stock Position:  -0.02600230778792112
Bond Position:  [-3.60965861]


portfolio before change:  [-6.1800071]
curr_Stock_Price:  98.83342928096465
curr_Factors:  [98.83342928]
mat_Sqrt:  [[0.15]]
grads:  [-0.02142863]
Stock Position:  -0.02142863030614266
Bond Position:  [-4.06214208]


portfolio before change:  [-6.16941976]
curr_Stock_Price:  98.31565773108831
curr_Factors:  [98.31565773]
mat_Sqrt:  [[0.15]]
grads:  [-0.20108284]
Stock Position:  -0.20108283658607073
Bond Position:  [13.60017157]


portfolio before change:  [-6.15614556]
curr_Stock_Price:  98.25809898091384
curr_Factors:  [98.25809898]
mat_Sqrt:  [[0.15]]
grads:  [-0.17827107]
Stock Position:  -0.17827106764986841
Bond Position:  [11.36043065]


portfolio before change:  [-6.34493154]
curr_Stock_Price:  99.32504791939144
curr_Factors:  [99.32504792]
mat_Sqrt:  [[0.15]]
grads:  [0.08638323]
Stock Position:  0.08638323360303189
Bond Position:  [-14.92495036]


portfolio before change:  [-6.26789873]
curr_Stock_Price:  100.2384027997722
curr_Factors:  [100.2384028]
mat_Sqrt:  [[0.15]]
grads:  [0.10886045]
Stock Position:  0.10886044782198392
Bond Position:  [-17.17989615]


portfolio before change:  [-6.41418057]
curr_Stock_Price:  98.91437535179612
curr_Factors:  [98.91437535]
mat_Sqrt:  [[0.15]]
grads:  [0.11965849]
Stock Position:  0.11965848887655356
Bond Position:  [-18.25012525]


portfolio before change:  [-6.28149706]
curr_Stock_Price:  100.0422930086732
curr_Factors:  [100.04229301]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095629]
Stock Position:  -0.02095628626106369
Bond Position:  [-4.18498213]


portfolio before change:  [-6.27183314]
curr_Stock_Price:  99.55618217658898
curr_Factors:  [99.55618218]
mat_Sqrt:  [[0.15]]
grads:  [0.10894647]
Stock Position:  0.10894647489462846
Bond Position:  [-17.11812824]


portfolio before change:  [-6.18773389]
curr_Stock_Price:  100.34775569435106
curr_Factors:  [100.34775569]
mat_Sqrt:  [[0.15]]
grads:  [0.01677064]
Stock Position:  0.016770643696075605
Bond Position:  [-7.87063035]


portfolio before change:  [-6.21056409]
curr_Stock_Price:  99.04510395824366
curr_Factors:  [99.04510396]
mat_Sqrt:  [[0.15]]
grads:  [0.06919763]
Stock Position:  0.06919762660447425
Bond Position:  [-13.06425021]


portfolio before change:  [-6.09976646]
curr_Stock_Price:  100.66988162941622
curr_Factors:  [100.66988163]
mat_Sqrt:  [[0.15]]
grads:  [0.0721193]
Stock Position:  0.07211929677321198
Bond Position:  [-13.36000753]


portfolio before change:  [-6.12236066]
curr_Stock_Price:  100.37974994872637
curr_Factors:  [100.37974995]
mat_Sqrt:  [[0.15]]
grads:  [-0.06641596]
Stock Position:  -0.06641596106848488
Bond Position:  [0.5444569]


portfolio before change:  [-6.1479701]
curr_Stock_Price:  100.7663663494036
curr_Factors:  [100.76636635]
mat_Sqrt:  [[0.15]]
grads:  [0.0789897]
Stock Position:  0.07898969591689495
Bond Position:  [-14.10747474]


portfolio before change:  [-6.13923815]
curr_Stock_Price:  100.8992380611532
curr_Factors:  [100.89923806]
mat_Sqrt:  [[0.15]]
grads:  [-0.04727427]
Stock Position:  -0.04727427240834151
Bond Position:  [-1.36930008]


portfolio before change:  [-6.16428428]
curr_Stock_Price:  101.42542186333121
curr_Factors:  [101.42542186]
mat_Sqrt:  [[0.15]]
grads:  [-0.18603005]
Stock Position:  -0.18603005151277335
Bond Position:  [12.70389218]


portfolio before change:  [-5.87296282]
curr_Stock_Price:  99.86796717514355
curr_Factors:  [99.86796718]
mat_Sqrt:  [[0.15]]
grads:  [0.01132543]
Stock Position:  0.011325426705485234
Bond Position:  [-7.00401016]


portfolio before change:  [-5.8923049]
curr_Stock_Price:  98.23743040771816
curr_Factors:  [98.23743041]
mat_Sqrt:  [[0.15]]
grads:  [-0.01322733]
Stock Position:  -0.013227329843097275
Bond Position:  [-4.592886]


portfolio before change:  [-5.88678107]
curr_Stock_Price:  97.77641737452242
curr_Factors:  [97.77641737]
mat_Sqrt:  [[0.15]]
grads:  [-0.05034614]
Stock Position:  -0.050346139989930885
Bond Position:  [-0.96411588]


portfolio before change:  [-5.86835653]
curr_Stock_Price:  97.40806603481029
curr_Factors:  [97.40806603]
mat_Sqrt:  [[0.15]]
grads:  [-0.01636508]
Stock Position:  -0.016365080853528575
Bond Position:  [-4.27426565]


portfolio before change:  [-5.90399313]
curr_Stock_Price:  99.55301628728077
curr_Factors:  [99.55301629]
mat_Sqrt:  [[0.15]]
grads:  [0.00225994]
Stock Position:  0.0022599387005684543
Bond Position:  [-6.12897684]


portfolio before change:  [-5.90687223]
curr_Stock_Price:  98.61806610922012
curr_Factors:  [98.61806611]
mat_Sqrt:  [[0.15]]
grads:  [0.05751414]
Stock Position:  0.05751413787265081
Bond Position:  [-11.57880528]


portfolio before change:  [-5.84626682]
curr_Stock_Price:  99.69698079067562
curr_Factors:  [99.69698079]
mat_Sqrt:  [[0.15]]
grads:  [0.03178448]
Stock Position:  0.0317844755668111
Bond Position:  [-9.01508307]


portfolio before change:  [-5.807445]
curr_Stock_Price:  100.95384515825327
curr_Factors:  [100.95384516]
mat_Sqrt:  [[0.15]]
grads:  [0.04727829]
Stock Position:  0.047278293330357685
Bond Position:  [-10.58037051]


portfolio before change:  [-5.82925995]
curr_Stock_Price:  100.52040483244456
curr_Factors:  [100.52040483]
mat_Sqrt:  [[0.15]]
grads:  [-0.02790373]
Stock Position:  -0.027903730780427228
Bond Position:  [-3.02436564]


portfolio before change:  [-5.81031086]
curr_Stock_Price:  99.82776770396168
curr_Factors:  [99.8277677]
mat_Sqrt:  [[0.15]]
grads:  [-0.05419691]
Stock Position:  -0.0541969051400953
Bond Position:  [-0.3999548]


portfolio before change:  [-5.82146545]
curr_Stock_Price:  100.0326612282636
curr_Factors:  [100.03266123]
mat_Sqrt:  [[0.15]]
grads:  [0.09313413]
Stock Position:  0.09313413075516619
Bond Position:  [-15.1379204]


portfolio before change:  [-5.80367905]
curr_Stock_Price:  100.24395610042627
curr_Factors:  [100.2439561]
mat_Sqrt:  [[0.15]]
grads:  [-0.13419332]
Stock Position:  -0.13419331727096845
Bond Position:  [7.64838996]


portfolio before change:  [-5.88698776]
curr_Stock_Price:  100.87189212963388
curr_Factors:  [100.87189213]
mat_Sqrt:  [[0.15]]
grads:  [-0.10787874]
Stock Position:  -0.10787874338566544
Bond Position:  [4.99494521]


portfolio before change:  [-5.88654551]
curr_Stock_Price:  100.87358073133082
curr_Factors:  [100.87358073]
mat_Sqrt:  [[0.15]]
grads:  [0.14578129]
Stock Position:  0.14578128558796355
Bond Position:  [-20.59202579]


portfolio before change:  [-6.03369782]
curr_Stock_Price:  99.88183382808404
curr_Factors:  [99.88183383]
mat_Sqrt:  [[0.15]]
grads:  [0.06123041]
Stock Position:  0.06123041173914602
Bond Position:  [-12.14950363]


portfolio before change:  [-6.0431767]
curr_Stock_Price:  99.75183138545798
curr_Factors:  [99.75183139]
mat_Sqrt:  [[0.15]]
grads:  [0.0068358]
Stock Position:  0.006835795815941356
Bond Position:  [-6.72505985]


portfolio before change:  [-6.04196718]
curr_Stock_Price:  100.05175389434291
curr_Factors:  [100.05175389]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331721]
Stock Position:  -0.0833172132298703
Bond Position:  [2.29406614]


portfolio before change:  [-6.02465487]
curr_Stock_Price:  99.84740797646836
curr_Factors:  [99.84740798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04099874]
Stock Position:  -0.040998739231430104
Bond Position:  [-1.93103703]


portfolio before change:  [-6.009339]
curr_Stock_Price:  99.46795074382187
curr_Factors:  [99.46795074]
mat_Sqrt:  [[0.15]]
grads:  [-0.05811646]
Stock Position:  -0.05811645656788881
Bond Position:  [-0.22861416]


portfolio before change:  [-5.98752592]
curr_Stock_Price:  99.09212504307045
curr_Factors:  [99.09212504]
mat_Sqrt:  [[0.15]]
grads:  [-0.0500893]
Stock Position:  -0.05008930389864575
Bond Position:  [-1.02407035]


portfolio before change:  [-6.01399977]
curr_Stock_Price:  99.61810240198216
curr_Factors:  [99.6181024]
mat_Sqrt:  [[0.15]]
grads:  [0.15072701]
Stock Position:  0.1507270142503873
Bond Position:  [-21.02913891]


portfolio before change:  [-6.06938704]
curr_Stock_Price:  99.2680758389058
curr_Factors:  [99.26807584]
mat_Sqrt:  [[0.15]]
grads:  [0.05537971]
Stock Position:  0.05537971047714994
Bond Position:  [-11.56682434]


portfolio before change:  [-6.06080677]
curr_Stock_Price:  99.44912071556939
curr_Factors:  [99.44912072]
mat_Sqrt:  [[0.15]]
grads:  [0.15713677]
Stock Position:  0.15713677266295642
Bond Position:  [-21.68792064]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.06080677]
Stock Price:  100.10258249452414
PL:  [-6.16338926]
Settle:  Tensor("sub_208:0", shape=(), dtype=float64)
PL:  Tensor("sub_209:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  105
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.92503826e-03]
 [-2.19827412e-03]
 [ 1.92011769e-02]
 [-1.47157918e-03]
 [ 1.35223099e-02]
 [ 1.83532168e-02]
 [ 2.73090294e-02]
 [-2.79255569e-03]
 [ 8.49703827e-03]
 [-2.63694396e-03]
 [ 2.81393839e-03]
 [-3.46425977e-03]
 [ 1.07520213e-02]
 [ 3.69590574e-03]
 [ 1.19407422e-02]
 [-9.50906758e-03]
 [-7.94081753e-03]
 [ 1.57287807e-05]
 [-7.64211261e-03]
 [-2.60730301e-03]
 [ 8.24927485e-04]
 [ 1.38639377e-02]
 [ 4.75495265e-03]
 [ 5.59794148e-03]
 [ 6.58729253e-03]
 [-7.01885243e-04]
 [ 7.60820578e-03]
 [-1.81571114e-02]
 [-2.43409759e-02]
 [ 2.13892913e-02]
 [ 2.62815804e-03]
 [-8.29313905e-03]
 [-1.23054245e-02]
 [-7.28183278e-03]
 [-6.37618765e-03]
 [-2.61441404e-03]
 [ 1.82900581e-02]
 [ 1.16022673e-02]
 [ 1.85757537e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-9.00443101]
curr_Stock_Price:  99.29494049468616
curr_Factors:  [99.29494049]
mat_Sqrt:  [[0.15]]
grads:  [-0.03283359]
Stock Position:  -0.032833588367045
Bond Position:  [-5.7442218]


portfolio before change:  [-9.02173633]
curr_Stock_Price:  99.80013189308397
curr_Factors:  [99.80013189]
mat_Sqrt:  [[0.15]]
grads:  [-0.01465516]
Stock Position:  -0.01465516080068561
Bond Position:  [-7.55914934]


portfolio before change:  [-9.02558538]
curr_Stock_Price:  99.9982940327663
curr_Factors:  [99.99829403]
mat_Sqrt:  [[0.15]]
grads:  [0.12800785]
Stock Position:  0.12800784628777426
Bond Position:  [-21.82615163]


portfolio before change:  [-8.99414319]
curr_Stock_Price:  100.26523565656744
curr_Factors:  [100.26523566]
mat_Sqrt:  [[0.15]]
grads:  [-0.00981053]
Stock Position:  -0.00981052783687773
Bond Position:  [-8.01048831]


portfolio before change:  [-8.98434028]
curr_Stock_Price:  99.16394050075252
curr_Factors:  [99.1639405]
mat_Sqrt:  [[0.15]]
grads:  [0.09014873]
Stock Position:  0.09014873294062496
Bond Position:  [-17.92384387]


portfolio before change:  [-8.9780582]
curr_Stock_Price:  99.25848093412999
curr_Factors:  [99.25848093]
mat_Sqrt:  [[0.15]]
grads:  [0.12235478]
Stock Position:  0.12235477869320585
Bond Position:  [-21.12280767]


portfolio before change:  [-8.90478957]
curr_Stock_Price:  99.878882892083
curr_Factors:  [99.87888289]
mat_Sqrt:  [[0.15]]
grads:  [0.1820602]
Stock Position:  0.18206019618127317
Bond Position:  [-27.08875859]


portfolio before change:  [-8.80100401]
curr_Stock_Price:  100.46754463864235
curr_Factors:  [100.46754464]
mat_Sqrt:  [[0.15]]
grads:  [-0.01861704]
Stock Position:  -0.018617037911374677
Bond Position:  [-6.93059592]


portfolio before change:  [-8.79261963]
curr_Stock_Price:  99.97064753624912
curr_Factors:  [99.97064754]
mat_Sqrt:  [[0.15]]
grads:  [0.05664692]
Stock Position:  0.056646921790485937
Bond Position:  [-14.45564908]


portfolio before change:  [-8.84774145]
curr_Stock_Price:  99.02947111446841
curr_Factors:  [99.02947111]
mat_Sqrt:  [[0.15]]
grads:  [-0.01757963]
Stock Position:  -0.01757962638397726
Bond Position:  [-7.10684034]


portfolio before change:  [-8.83330049]
curr_Stock_Price:  98.15747463889355
curr_Factors:  [98.15747464]
mat_Sqrt:  [[0.15]]
grads:  [0.01875959]
Stock Position:  0.018759589246099183
Bond Position:  [-10.67469439]


portfolio before change:  [-8.84179828]
curr_Stock_Price:  97.77562308106262
curr_Factors:  [97.77562308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02309507]
Stock Position:  -0.023095065150623963
Bond Position:  [-6.5836639]


portfolio before change:  [-8.81565471]
curr_Stock_Price:  96.6079889402754
curr_Factors:  [96.60798894]
mat_Sqrt:  [[0.15]]
grads:  [0.07168014]
Stock Position:  0.0716801418333024
Bond Position:  [-15.74052906]


portfolio before change:  [-8.84795823]
curr_Stock_Price:  96.18477781012523
curr_Factors:  [96.18477781]
mat_Sqrt:  [[0.15]]
grads:  [0.02463937]
Stock Position:  0.024639371627359317
Bond Position:  [-11.21789072]


portfolio before change:  [-8.84845334]
curr_Stock_Price:  96.2215974465841
curr_Factors:  [96.22159745]
mat_Sqrt:  [[0.15]]
grads:  [0.07960495]
Stock Position:  0.07960494788151104
Bond Position:  [-16.50816859]


portfolio before change:  [-8.84922493]
curr_Stock_Price:  96.2378283686021
curr_Factors:  [96.23782837]
mat_Sqrt:  [[0.15]]
grads:  [-0.06339378]
Stock Position:  -0.06339378384523268
Bond Position:  [-2.74834484]


portfolio before change:  [-8.89131176]
curr_Stock_Price:  96.89630400859112
curr_Factors:  [96.89630401]
mat_Sqrt:  [[0.15]]
grads:  [-0.05293878]
Stock Position:  -0.05293878351710926
Bond Position:  [-3.7617393]


portfolio before change:  [-8.88135042]
curr_Stock_Price:  96.69925411170698
curr_Factors:  [96.69925411]
mat_Sqrt:  [[0.15]]
grads:  [0.00010486]
Stock Position:  0.00010485853825862191
Bond Position:  [-8.89149016]


portfolio before change:  [-8.8824889]
curr_Stock_Price:  96.4420481835497
curr_Factors:  [96.44204818]
mat_Sqrt:  [[0.15]]
grads:  [-0.05094742]
Stock Position:  -0.05094741738188442
Bond Position:  [-3.96901562]


portfolio before change:  [-8.88338127]
curr_Stock_Price:  96.44982511506663
curr_Factors:  [96.44982512]
mat_Sqrt:  [[0.15]]
grads:  [-0.01738202]
Stock Position:  -0.017382020040666885
Bond Position:  [-7.20688848]


portfolio before change:  [-8.87295129]
curr_Stock_Price:  95.79795028994882
curr_Factors:  [95.79795029]
mat_Sqrt:  [[0.15]]
grads:  [0.00549952]
Stock Position:  0.005499516568785392
Bond Position:  [-9.3997937]


portfolio before change:  [-8.87662348]
curr_Stock_Price:  95.34388354123703
curr_Factors:  [95.34388354]
mat_Sqrt:  [[0.15]]
grads:  [0.09242625]
Stock Position:  0.0924262512189703
Bond Position:  [-17.68890121]


portfolio before change:  [-8.94782157]
curr_Stock_Price:  94.59748482156978
curr_Factors:  [94.59748482]
mat_Sqrt:  [[0.15]]
grads:  [0.03169968]
Stock Position:  0.031699684306571226
Bond Position:  [-11.94653197]


portfolio before change:  [-8.97376609]
curr_Stock_Price:  93.82614870342648
curr_Factors:  [93.8261487]
mat_Sqrt:  [[0.15]]
grads:  [0.03731961]
Stock Position:  0.03731960986851083
Bond Position:  [-12.47532135]


portfolio before change:  [-8.990938]
curr_Stock_Price:  93.40780565807914
curr_Factors:  [93.40780566]
mat_Sqrt:  [[0.15]]
grads:  [0.04391528]
Stock Position:  0.04391528354090165
Bond Position:  [-13.09296827]


portfolio before change:  [-8.96535135]
curr_Stock_Price:  94.02771217854688
curr_Factors:  [94.02771218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00467923]
Stock Position:  -0.004679234951486753
Bond Position:  [-8.5253736]


portfolio before change:  [-8.96912069]
curr_Stock_Price:  94.6054988342728
curr_Factors:  [94.60549883]
mat_Sqrt:  [[0.15]]
grads:  [0.05072137]
Stock Position:  0.050721371891172706
Bond Position:  [-13.76764138]


portfolio before change:  [-8.93155909]
curr_Stock_Price:  95.37997846423882
curr_Factors:  [95.37997846]
mat_Sqrt:  [[0.15]]
grads:  [-0.12104741]
Stock Position:  -0.12104740950358381
Bond Position:  [2.61394023]


portfolio before change:  [-8.85790339]
curr_Stock_Price:  94.77419158923439
curr_Factors:  [94.77419159]
mat_Sqrt:  [[0.15]]
grads:  [-0.16227317]
Stock Position:  -0.16227317237626437
Bond Position:  [6.52140534]


portfolio before change:  [-8.69805264]
curr_Stock_Price:  93.79414340390068
curr_Factors:  [93.7941434]
mat_Sqrt:  [[0.15]]
grads:  [0.14259528]
Stock Position:  0.14259527532953273
Bond Position:  [-22.07265434]


portfolio before change:  [-8.5398458]
curr_Stock_Price:  94.92297529375224
curr_Factors:  [94.92297529]
mat_Sqrt:  [[0.15]]
grads:  [0.01752105]
Stock Position:  0.017521053571111184
Bond Position:  [-10.20299633]


portfolio before change:  [-8.53245561]
curr_Stock_Price:  95.4175599022659
curr_Factors:  [95.4175599]
mat_Sqrt:  [[0.15]]
grads:  [-0.05528759]
Stock Position:  -0.05528759368434784
Bond Position:  [-3.25704832]


portfolio before change:  [-8.46668751]
curr_Stock_Price:  94.22063221267246
curr_Factors:  [94.22063221]
mat_Sqrt:  [[0.15]]
grads:  [-0.08203616]
Stock Position:  -0.08203616337368627
Bond Position:  [-0.73718833]


portfolio before change:  [-8.51445795]
curr_Stock_Price:  94.80181836899037
curr_Factors:  [94.80181837]
mat_Sqrt:  [[0.15]]
grads:  [-0.04854555]
Stock Position:  -0.048545551887281366
Bond Position:  [-3.91225136]


portfolio before change:  [-8.49751163]
curr_Stock_Price:  94.44266339487588
curr_Factors:  [94.44266339]
mat_Sqrt:  [[0.15]]
grads:  [-0.04250792]
Stock Position:  -0.04250791769566965
Bond Position:  [-4.48295067]


portfolio before change:  [-8.47037103]
curr_Stock_Price:  93.7909964220052
curr_Factors:  [93.79099642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01742943]
Stock Position:  -0.017429426939402148
Bond Position:  [-6.83564771]


portfolio before change:  [-8.47189814]
curr_Stock_Price:  93.82958612129576
curr_Factors:  [93.82958612]
mat_Sqrt:  [[0.15]]
grads:  [0.12193372]
Stock Position:  0.12193372068577409
Bond Position:  [-19.91288868]


portfolio before change:  [-8.45650174]
curr_Stock_Price:  93.97626964880871
curr_Factors:  [93.97626965]
mat_Sqrt:  [[0.15]]
grads:  [0.07734845]
Stock Position:  0.07734844888549405
Bond Position:  [-15.72542043]


portfolio before change:  [-8.42228171]
curr_Stock_Price:  94.44409840799777
curr_Factors:  [94.44409841]
mat_Sqrt:  [[0.15]]
grads:  [0.12383836]
Stock Position:  0.12383835829531113
Bond Position:  [-20.1180838]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.42228171]
Stock Price:  95.58708976457399
PL:  [-8.42228171]
Settle:  Tensor("sub_210:0", shape=(), dtype=float64)
PL:  Tensor("sub_211:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  106
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.22454498e-03]
 [ 5.40760805e-03]
 [-1.64362056e-02]
 [-2.70414850e-02]
 [ 5.26143017e-03]
 [ 2.42780470e-02]
 [ 1.30357076e-02]
 [-3.14399952e-03]
 [ 4.18672029e-03]
 [-4.24631270e-03]
 [ 5.65478858e-03]
 [ 5.49233365e-03]
 [-7.80999595e-04]
 [ 1.08165145e-02]
 [-3.98225719e-03]
 [-1.02254613e-02]
 [-7.56207464e-03]
 [-1.19585931e-03]
 [-7.60504375e-03]
 [-2.37559198e-03]
 [ 3.62660858e-04]
 [ 8.60978527e-03]
 [ 4.76685420e-03]
 [ 5.78120178e-03]
 [-5.90968515e-04]
 [-4.74109065e-03]
 [-6.75345410e-03]
 [-1.86187418e-02]
 [-2.86568179e-02]
 [ 2.18867789e-02]
 [ 3.41786383e-03]
 [-5.37968717e-03]
 [-1.25335136e-02]
 [-8.93882805e-03]
 [-7.33743162e-03]
 [-6.33654356e-03]
 [ 2.19215967e-02]
 [ 8.81293866e-03]
 [ 2.27668548e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.93409296]
curr_Stock_Price:  99.4283159583559
curr_Factors:  [99.42831596]
mat_Sqrt:  [[0.15]]
grads:  [-0.02816363]
Stock Position:  -0.028163633206072475
Bond Position:  [-4.13383034]


portfolio before change:  [-6.93587274]
curr_Stock_Price:  99.4731615364257
curr_Factors:  [99.47316154]
mat_Sqrt:  [[0.15]]
grads:  [0.03605072]
Stock Position:  0.03605072030294511
Bond Position:  [-10.52195186]


portfolio before change:  [-6.95438463]
curr_Stock_Price:  98.99615129123903
curr_Factors:  [98.99615129]
mat_Sqrt:  [[0.15]]
grads:  [-0.1095747]
Stock Position:  -0.10957470432867998
Bond Position:  [3.89308938]


portfolio before change:  [-6.86347418]
curr_Stock_Price:  98.17092637304397
curr_Factors:  [98.17092637]
mat_Sqrt:  [[0.15]]
grads:  [-0.18027657]
Stock Position:  -0.18027656663826394
Bond Position:  [10.83444337]


portfolio before change:  [-6.76455841]
curr_Stock_Price:  97.62975017481025
curr_Factors:  [97.62975017]
mat_Sqrt:  [[0.15]]
grads:  [0.0350762]
Stock Position:  0.03507620111151639
Bond Position:  [-10.18903916]


portfolio before change:  [-6.77272032]
curr_Stock_Price:  97.43337180643363
curr_Factors:  [97.43337181]
mat_Sqrt:  [[0.15]]
grads:  [0.16185365]
Stock Position:  0.1618536468397659
Bond Position:  [-22.54266687]


portfolio before change:  [-6.59601065]
curr_Stock_Price:  98.54256946564786
curr_Factors:  [98.54256947]
mat_Sqrt:  [[0.15]]
grads:  [0.08690472]
Stock Position:  0.08690471739994772
Bond Position:  [-15.1598248]


portfolio before change:  [-6.46767419]
curr_Stock_Price:  100.04112509581297
curr_Factors:  [100.0411251]
mat_Sqrt:  [[0.15]]
grads:  [-0.02096]
Stock Position:  -0.020959996810442305
Bond Position:  [-4.37081253]


portfolio before change:  [-6.47975553]
curr_Stock_Price:  100.59145687000822
curr_Factors:  [100.59145687]
mat_Sqrt:  [[0.15]]
grads:  [0.02791147]
Stock Position:  0.02791146858799385
Bond Position:  [-9.28741081]


portfolio before change:  [-6.50562132]
curr_Stock_Price:  99.7063440962978
curr_Factors:  [99.7063441]
mat_Sqrt:  [[0.15]]
grads:  [-0.02830875]
Stock Position:  -0.028308751358455474
Bond Position:  [-3.68305922]


portfolio before change:  [-6.51392101]
curr_Stock_Price:  99.98326464324097
curr_Factors:  [99.98326464]
mat_Sqrt:  [[0.15]]
grads:  [0.03769859]
Stock Position:  0.03769859052351078
Bond Position:  [-10.28314916]


portfolio before change:  [-6.54836105]
curr_Stock_Price:  99.10380037881565
curr_Factors:  [99.10380038]
mat_Sqrt:  [[0.15]]
grads:  [0.03661556]
Stock Position:  0.0366155576427723
Bond Position:  [-10.17710196]


portfolio before change:  [-6.55771744]
curr_Stock_Price:  98.88301513835806
curr_Factors:  [98.88301514]
mat_Sqrt:  [[0.15]]
grads:  [-0.00520666]
Stock Position:  -0.005206663965887157
Bond Position:  [-6.04286681]


portfolio before change:  [-6.55528457]
curr_Stock_Price:  98.2706706181044
curr_Factors:  [98.27067062]
mat_Sqrt:  [[0.15]]
grads:  [0.0721101]
Stock Position:  0.07211009653056866
Bond Position:  [-13.64159212]


portfolio before change:  [-6.48470684]
curr_Stock_Price:  99.27306889336236
curr_Factors:  [99.27306889]
mat_Sqrt:  [[0.15]]
grads:  [-0.02654838]
Stock Position:  -0.026548381267872574
Bond Position:  [-3.84916756]


portfolio before change:  [-6.4631042]
curr_Stock_Price:  98.44123612052675
curr_Factors:  [98.44123612]
mat_Sqrt:  [[0.15]]
grads:  [-0.06816974]
Stock Position:  -0.06816974224606089
Bond Position:  [0.24760949]


portfolio before change:  [-6.36659752]
curr_Stock_Price:  97.02600814402867
curr_Factors:  [97.02600814]
mat_Sqrt:  [[0.15]]
grads:  [-0.05041383]
Stock Position:  -0.05041383092981616
Bond Position:  [-1.47514475]


portfolio before change:  [-6.40692048]
curr_Stock_Price:  97.82218952583133
curr_Factors:  [97.82218953]
mat_Sqrt:  [[0.15]]
grads:  [-0.0079724]
Stock Position:  -0.007972395432464169
Bond Position:  [-5.6270433]


portfolio before change:  [-6.40174548]
curr_Stock_Price:  97.08484254518905
curr_Factors:  [97.08484255]
mat_Sqrt:  [[0.15]]
grads:  [-0.05070029]
Stock Position:  -0.050700291657867734
Bond Position:  [-1.47951565]


portfolio before change:  [-6.47184132]
curr_Stock_Price:  98.46374744287375
curr_Factors:  [98.46374744]
mat_Sqrt:  [[0.15]]
grads:  [-0.01583728]
Stock Position:  -0.015837279895787475
Bond Position:  [-4.91244339]


portfolio before change:  [-6.46478217]
curr_Stock_Price:  97.97924227147159
curr_Factors:  [97.97924227]
mat_Sqrt:  [[0.15]]
grads:  [0.00241774]
Stock Position:  0.002417739053426214
Bond Position:  [-6.70167041]


portfolio before change:  [-6.46393924]
curr_Stock_Price:  98.6743922885093
curr_Factors:  [98.67439229]
mat_Sqrt:  [[0.15]]
grads:  [0.05739857]
Stock Position:  0.057398568449973375
Bond Position:  [-12.1277081]


portfolio before change:  [-6.45458459]
curr_Stock_Price:  98.86378211711919
curr_Factors:  [98.86378212]
mat_Sqrt:  [[0.15]]
grads:  [0.03177903]
Stock Position:  0.031779027999417925
Bond Position:  [-9.59637949]


portfolio before change:  [-6.46902764]
curr_Stock_Price:  98.4470471614226
curr_Factors:  [98.44704716]
mat_Sqrt:  [[0.15]]
grads:  [0.03854135]
Stock Position:  0.03854134520269273
Bond Position:  [-10.26330927]


portfolio before change:  [-6.53353221]
curr_Stock_Price:  96.80668996624219
curr_Factors:  [96.80668997]
mat_Sqrt:  [[0.15]]
grads:  [-0.00393979]
Stock Position:  -0.003939790098934966
Bond Position:  [-6.15213417]


portfolio before change:  [-6.5366067]
curr_Stock_Price:  97.39185498560772
curr_Factors:  [97.39185499]
mat_Sqrt:  [[0.15]]
grads:  [-0.03160727]
Stock Position:  -0.031607271018075964
Bond Position:  [-3.45831595]


portfolio before change:  [-6.53021114]
curr_Stock_Price:  97.17583259847466
curr_Factors:  [97.1758326]
mat_Sqrt:  [[0.15]]
grads:  [-0.04502303]
Stock Position:  -0.04502302731557873
Bond Position:  [-2.15506097]


portfolio before change:  [-6.49136579]
curr_Stock_Price:  96.30706058069131
curr_Factors:  [96.30706058]
mat_Sqrt:  [[0.15]]
grads:  [-0.12412495]
Stock Position:  -0.12412494511367908
Bond Position:  [5.46274282]


portfolio before change:  [-6.46819641]
curr_Stock_Price:  96.12590036472672
curr_Factors:  [96.12590036]
mat_Sqrt:  [[0.15]]
grads:  [-0.19104545]
Stock Position:  -0.1910454526834991
Bond Position:  [11.89621974]


portfolio before change:  [-6.57567244]
curr_Stock_Price:  96.69625234133153
curr_Factors:  [96.69625234]
mat_Sqrt:  [[0.15]]
grads:  [0.14591186]
Stock Position:  0.14591185929541683
Bond Position:  [-20.6848024]


portfolio before change:  [-6.5065468]
curr_Stock_Price:  97.18772299147507
curr_Factors:  [97.18772299]
mat_Sqrt:  [[0.15]]
grads:  [0.02278576]
Stock Position:  0.022785758848012337
Bond Position:  [-8.72104282]


portfolio before change:  [-6.5108142]
curr_Stock_Price:  97.04828516815823
curr_Factors:  [97.04828517]
mat_Sqrt:  [[0.15]]
grads:  [-0.03586458]
Stock Position:  -0.035864581119741556
Bond Position:  [-3.0302181]


portfolio before change:  [-6.5252433]
curr_Stock_Price:  97.44004494121363
curr_Factors:  [97.44004494]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355676]
Stock Position:  -0.08355675728387181
Bond Position:  [1.61653089]


portfolio before change:  [-6.57415451]
curr_Stock_Price:  98.02782857549177
curr_Factors:  [98.02782858]
mat_Sqrt:  [[0.15]]
grads:  [-0.05959219]
Stock Position:  -0.05959218698115319
Bond Position:  [-0.73246182]


portfolio before change:  [-6.52758504]
curr_Stock_Price:  97.2448225516288
curr_Factors:  [97.24482255]
mat_Sqrt:  [[0.15]]
grads:  [-0.04891621]
Stock Position:  -0.048916210810150657
Bond Position:  [-1.7707368]


portfolio before change:  [-6.51407047]
curr_Stock_Price:  96.96401743320902
curr_Factors:  [96.96401743]
mat_Sqrt:  [[0.15]]
grads:  [-0.04224362]
Stock Position:  -0.042243623765090596
Bond Position:  [-2.417959]


portfolio before change:  [-6.57826881]
curr_Stock_Price:  98.47657890842659
curr_Factors:  [98.47657891]
mat_Sqrt:  [[0.15]]
grads:  [0.14614398]
Stock Position:  0.14614397788753117
Bond Position:  [-20.97002778]


portfolio before change:  [-6.75166033]
curr_Stock_Price:  97.30807302351604
curr_Factors:  [97.30807302]
mat_Sqrt:  [[0.15]]
grads:  [0.05875292]
Stock Position:  0.05875292440032302
Bond Position:  [-12.46879418]


portfolio before change:  [-6.71358939]
curr_Stock_Price:  97.98258643810777
curr_Factors:  [97.98258644]
mat_Sqrt:  [[0.15]]
grads:  [0.15177903]
Stock Position:  0.15177903229871667
Bond Position:  [-21.58529154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.71358939]
Stock Price:  97.26499029448432
PL:  [-6.71358939]
Settle:  Tensor("sub_212:0", shape=(), dtype=float64)
PL:  Tensor("sub_213:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  107
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.46084753e-03]
 [-5.76183253e-03]
 [-1.98886451e-03]
 [ 3.07061248e-02]
 [ 1.79001553e-02]
 [ 2.71810697e-02]
 [ 2.72181458e-02]
 [-2.95861491e-03]
 [ 9.36639598e-03]
 [-4.44027533e-03]
 [ 4.47857181e-03]
 [ 8.87190994e-03]
 [-6.82017614e-03]
 [ 1.00731806e-02]
 [-5.44492567e-03]
 [-2.50987144e-02]
 [ 4.42028203e-03]
 [ 1.61422124e-03]
 [-1.06712768e-02]
 [-2.21539475e-03]
 [ 4.12085617e-04]
 [ 3.46697702e-03]
 [ 4.78224523e-03]
 [ 6.91567588e-03]
 [-4.61077980e-03]
 [-8.08010992e-03]
 [ 1.39558938e-02]
 [-2.61669235e-02]
 [-1.61209834e-02]
 [ 2.16362380e-02]
 [ 6.50386861e-03]
 [ 6.06586877e-03]
 [-1.26664909e-02]
 [-6.35302522e-03]
 [-5.42069481e-03]
 [-4.03729083e-03]
 [ 2.33844249e-02]
 [-1.52862798e-04]
 [ 2.12345167e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.18296167]
curr_Stock_Price:  100.53103205984144
curr_Factors:  [100.53103206]
mat_Sqrt:  [[0.15]]
grads:  [-0.00973898]
Stock Position:  -0.009738983523038782
Bond Position:  [11.16203173]


portfolio before change:  [10.17938268]
curr_Stock_Price:  101.04179694895998
curr_Factors:  [101.04179695]
mat_Sqrt:  [[0.15]]
grads:  [-0.03841222]
Stock Position:  -0.03841221688875788
Bond Position:  [14.0606221]


portfolio before change:  [10.14518365]
curr_Stock_Price:  101.97787202825883
curr_Factors:  [101.97787203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0132591]
Stock Position:  -0.013259096749766448
Bond Position:  [11.49731812]


portfolio before change:  [10.15388801]
curr_Stock_Price:  101.42978743712135
curr_Factors:  [101.42978744]
mat_Sqrt:  [[0.15]]
grads:  [0.2047075]
Stock Position:  0.2047074988652404
Bond Position:  [-10.60955009]


portfolio before change:  [10.13466889]
curr_Stock_Price:  101.34238056808013
curr_Factors:  [101.34238057]
mat_Sqrt:  [[0.15]]
grads:  [0.11933437]
Stock Position:  0.11933436839073111
Bond Position:  [-1.95896008]


portfolio before change:  [10.10215783]
curr_Stock_Price:  101.07199599344942
curr_Factors:  [101.07199599]
mat_Sqrt:  [[0.15]]
grads:  [0.18120713]
Stock Position:  0.18120713110447823
Bond Position:  [-8.2128086]


portfolio before change:  [9.93592646]
curr_Stock_Price:  100.16030609939284
curr_Factors:  [100.1603061]
mat_Sqrt:  [[0.15]]
grads:  [0.18145431]
Stock Position:  0.1814543050148567
Bond Position:  [-8.23859227]


portfolio before change:  [9.84196299]
curr_Stock_Price:  99.64814638536224
curr_Factors:  [99.64814639]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197241]
Stock Position:  -0.019724099423792225
Bond Position:  [11.80743293]


portfolio before change:  [9.83841873]
curr_Stock_Price:  99.90267145506196
curr_Factors:  [99.90267146]
mat_Sqrt:  [[0.15]]
grads:  [0.06244264]
Stock Position:  0.062442639889808346
Bond Position:  [3.60023219]


portfolio before change:  [9.81577974]
curr_Stock_Price:  99.53290740463613
curr_Factors:  [99.5329074]
mat_Sqrt:  [[0.15]]
grads:  [-0.02960184]
Stock Position:  -0.029601835555785334
Bond Position:  [12.7621365]


portfolio before change:  [9.80954138]
curr_Stock_Price:  99.79754406729822
curr_Factors:  [99.79754407]
mat_Sqrt:  [[0.15]]
grads:  [0.02985715]
Stock Position:  0.029857145406691026
Bond Position:  [6.82987159]


portfolio before change:  [9.80041856]
curr_Stock_Price:  99.4633993677687
curr_Factors:  [99.46339937]
mat_Sqrt:  [[0.15]]
grads:  [0.05914607]
Stock Position:  0.059146066261740696
Bond Position:  [3.91754975]


portfolio before change:  [9.80503587]
curr_Stock_Price:  99.53318566959773
curr_Factors:  [99.53318567]
mat_Sqrt:  [[0.15]]
grads:  [-0.04546784]
Stock Position:  -0.04546784095859605
Bond Position:  [14.33059492]


portfolio before change:  [9.80350297]
curr_Stock_Price:  99.6062996882397
curr_Factors:  [99.60629969]
mat_Sqrt:  [[0.15]]
grads:  [0.06715454]
Stock Position:  0.0671545374011272
Bond Position:  [3.11448799]


portfolio before change:  [9.84314659]
curr_Stock_Price:  100.19083637805608
curr_Factors:  [100.19083638]
mat_Sqrt:  [[0.15]]
grads:  [-0.0362995]
Stock Position:  -0.03629950447420966
Bond Position:  [13.48002431]


portfolio before change:  [9.82108536]
curr_Stock_Price:  100.845014428481
curr_Factors:  [100.84501443]
mat_Sqrt:  [[0.15]]
grads:  [-0.16732476]
Stock Position:  -0.16732476268819635
Bond Position:  [26.69495347]


portfolio before change:  [9.75445038]
curr_Stock_Price:  101.26319558369089
curr_Factors:  [101.26319558]
mat_Sqrt:  [[0.15]]
grads:  [0.02946855]
Stock Position:  0.02946854684225508
Bond Position:  [6.77037116]


portfolio before change:  [9.78338435]
curr_Stock_Price:  102.21633455566828
curr_Factors:  [102.21633456]
mat_Sqrt:  [[0.15]]
grads:  [0.01076147]
Stock Position:  0.010761474919271681
Bond Position:  [8.68338583]


portfolio before change:  [9.77251598]
curr_Stock_Price:  101.10553307476016
curr_Factors:  [101.10553307]
mat_Sqrt:  [[0.15]]
grads:  [-0.07114185]
Stock Position:  -0.07114184530847975
Bond Position:  [16.96535017]


portfolio before change:  [9.80966685]
curr_Stock_Price:  100.61313554405353
curr_Factors:  [100.61313554]
mat_Sqrt:  [[0.15]]
grads:  [-0.0147693]
Stock Position:  -0.014769298322002192
Bond Position:  [11.29565226]


portfolio before change:  [9.81702591]
curr_Stock_Price:  100.21047473983649
curr_Factors:  [100.21047474]
mat_Sqrt:  [[0.15]]
grads:  [0.00274724]
Stock Position:  0.002747237447827981
Bond Position:  [9.54172394]


portfolio before change:  [9.82041172]
curr_Stock_Price:  101.00873848367316
curr_Factors:  [101.00873848]
mat_Sqrt:  [[0.15]]
grads:  [0.02311318]
Stock Position:  0.023113180139111865
Bond Position:  [7.48577855]


portfolio before change:  [9.82843322]
curr_Stock_Price:  101.31530453914229
curr_Factors:  [101.31530454]
mat_Sqrt:  [[0.15]]
grads:  [0.03188163]
Stock Position:  0.031881634835066536
Bond Position:  [6.59833567]


portfolio before change:  [9.80776277]
curr_Stock_Price:  100.64108277878248
curr_Factors:  [100.64108278]
mat_Sqrt:  [[0.15]]
grads:  [0.04610451]
Stock Position:  0.04610450583828337
Bond Position:  [5.16775538]


portfolio before change:  [9.78680747]
curr_Stock_Price:  100.17255360338824
curr_Factors:  [100.1725536]
mat_Sqrt:  [[0.15]]
grads:  [-0.03073853]
Stock Position:  -0.03073853199802916
Bond Position:  [12.86596472]


portfolio before change:  [9.80020499]
curr_Stock_Price:  99.7890228313126
curr_Factors:  [99.78902283]
mat_Sqrt:  [[0.15]]
grads:  [-0.0538674]
Stock Position:  -0.05386739945171418
Bond Position:  [15.17558015]


portfolio before change:  [9.78875054]
curr_Stock_Price:  100.0368817094688
curr_Factors:  [100.03688171]
mat_Sqrt:  [[0.15]]
grads:  [0.09303929]
Stock Position:  0.09303929229739125
Bond Position:  [0.48138987]


portfolio before change:  [9.72890705]
curr_Stock_Price:  99.39302825305815
curr_Factors:  [99.39302825]
mat_Sqrt:  [[0.15]]
grads:  [-0.17444616]
Stock Position:  -0.17444615657811063
Bond Position:  [27.06763882]


portfolio before change:  [9.48836651]
curr_Stock_Price:  100.79130618017825
curr_Factors:  [100.79130618]
mat_Sqrt:  [[0.15]]
grads:  [-0.10747322]
Stock Position:  -0.1074732224275112
Bond Position:  [20.32073298]


portfolio before change:  [9.52178976]
curr_Stock_Price:  100.50395083337898
curr_Factors:  [100.50395083]
mat_Sqrt:  [[0.15]]
grads:  [0.14424159]
Stock Position:  0.14424158659489877
Bond Position:  [-4.97505956]


portfolio before change:  [9.61239666]
curr_Stock_Price:  101.13642320725137
curr_Factors:  [101.13642321]
mat_Sqrt:  [[0.15]]
grads:  [0.04335912]
Stock Position:  0.04335912407899374
Bond Position:  [5.22720994]


portfolio before change:  [9.62326408]
curr_Stock_Price:  101.37199007746118
curr_Factors:  [101.37199008]
mat_Sqrt:  [[0.15]]
grads:  [0.04043913]
Stock Position:  0.04043912512163818
Bond Position:  [5.52386949]


portfolio before change:  [9.65057163]
curr_Stock_Price:  102.03018988029825
curr_Factors:  [102.03018988]
mat_Sqrt:  [[0.15]]
grads:  [-0.08444327]
Stock Position:  -0.08444327233925879
Bond Position:  [18.26633474]


portfolio before change:  [9.68561618]
curr_Stock_Price:  101.64222392920738
curr_Factors:  [101.64222393]
mat_Sqrt:  [[0.15]]
grads:  [-0.0423535]
Stock Position:  -0.04235350149856021
Bond Position:  [13.99052026]


portfolio before change:  [9.69614257]
curr_Stock_Price:  101.43498092527943
curr_Factors:  [101.43498093]
mat_Sqrt:  [[0.15]]
grads:  [-0.03613797]
Stock Position:  -0.03613796537908566
Bond Position:  [13.3617964]


portfolio before change:  [9.66754128]
curr_Stock_Price:  102.27264887849755
curr_Factors:  [102.27264888]
mat_Sqrt:  [[0.15]]
grads:  [-0.02691527]
Stock Position:  -0.026915272175808948
Bond Position:  [12.42023746]


portfolio before change:  [9.65193594]
curr_Stock_Price:  102.91012948631646
curr_Factors:  [102.91012949]
mat_Sqrt:  [[0.15]]
grads:  [0.15589617]
Stock Position:  0.15589616618405602
Bond Position:  [-6.3913587]


portfolio before change:  [9.60720674]
curr_Stock_Price:  102.62833788363815
curr_Factors:  [102.62833788]
mat_Sqrt:  [[0.15]]
grads:  [-0.00101909]
Stock Position:  -0.0010190853172929496
Bond Position:  [9.71179378]


portfolio before change:  [9.60775783]
curr_Stock_Price:  103.27888418948237
curr_Factors:  [103.27888419]
mat_Sqrt:  [[0.15]]
grads:  [0.14156344]
Stock Position:  0.1415634448151022
Bond Position:  [-5.01275679]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.60775783]
Stock Price:  105.39736057297897
PL:  [4.21039726]
Settle:  Tensor("sub_214:0", shape=(), dtype=float64)
PL:  Tensor("sub_215:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  108
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.71097572e-03]
 [ 2.76484236e-03]
 [ 1.98111658e-02]
 [-1.01441574e-04]
 [ 7.33453854e-03]
 [ 3.25592989e-02]
 [ 2.24391794e-02]
 [-3.09743474e-03]
 [ 1.11277533e-02]
 [-3.07347186e-03]
 [ 1.26456515e-02]
 [-4.16974233e-04]
 [ 4.96547645e-03]
 [ 1.07185385e-02]
 [ 3.72963080e-03]
 [-1.16732035e-02]
 [-6.21498260e-03]
 [-2.29759344e-03]
 [-7.48324382e-03]
 [-2.41282227e-03]
 [ 3.19333553e-04]
 [ 9.15491476e-03]
 [ 4.76904671e-03]
 [ 5.97194309e-03]
 [-2.33785587e-03]
 [-7.60368301e-03]
 [ 8.33448124e-03]
 [-2.57558406e-02]
 [-3.41379305e-02]
 [ 2.18660928e-02]
 [ 6.19571301e-03]
 [ 6.06004758e-03]
 [-1.26833717e-02]
 [-6.04379100e-03]
 [-5.49333033e-03]
 [-3.19899360e-03]
 [ 2.32850965e-02]
 [ 6.25042292e-03]
 [ 2.36404902e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.53170682]
curr_Stock_Price:  99.9737003093598
curr_Factors:  [99.97370031]
mat_Sqrt:  [[0.15]]
grads:  [-0.0114065]
Stock Position:  -0.01140650477402614
Bond Position:  [2.67205731]


portfolio before change:  [1.53993971]
curr_Stock_Price:  99.28121282895289
curr_Factors:  [99.28121283]
mat_Sqrt:  [[0.15]]
grads:  [0.01843228]
Stock Position:  0.018432282407585272
Bond Position:  [-0.29003964]


portfolio before change:  [1.55366156]
curr_Stock_Price:  100.02762672143746
curr_Factors:  [100.02762672]
mat_Sqrt:  [[0.15]]
grads:  [0.13207444]
Stock Position:  0.1320744386263315
Bond Position:  [-11.65743108]


portfolio before change:  [1.60095516]
curr_Stock_Price:  100.39674327562764
curr_Factors:  [100.39674328]
mat_Sqrt:  [[0.15]]
grads:  [-0.00067628]
Stock Position:  -0.0006762771568799102
Bond Position:  [1.66885118]


portfolio before change:  [1.60026577]
curr_Stock_Price:  101.72461365802621
curr_Factors:  [101.72461366]
mat_Sqrt:  [[0.15]]
grads:  [0.04889692]
Stock Position:  0.04889692358407384
Bond Position:  [-3.37375489]


portfolio before change:  [1.62826009]
curr_Stock_Price:  102.3057558169751
curr_Factors:  [102.30575582]
mat_Sqrt:  [[0.15]]
grads:  [0.21706199]
Stock Position:  0.21706199241564983
Bond Position:  [-20.57843111]


portfolio before change:  [1.3455045]
curr_Stock_Price:  101.01495813210555
curr_Factors:  [101.01495813]
mat_Sqrt:  [[0.15]]
grads:  [0.14959453]
Stock Position:  0.14959452941101165
Bond Position:  [-13.76578062]


portfolio before change:  [1.17762412]
curr_Stock_Price:  99.90422528630279
curr_Factors:  [99.90422529]
mat_Sqrt:  [[0.15]]
grads:  [-0.02064956]
Stock Position:  -0.020649564929688526
Bond Position:  [3.2406029]


portfolio before change:  [1.17937345]
curr_Stock_Price:  99.83912764828433
curr_Factors:  [99.83912765]
mat_Sqrt:  [[0.15]]
grads:  [0.07418502]
Stock Position:  0.07418502193457728
Bond Position:  [-6.22719442]


portfolio before change:  [1.12564754]
curr_Stock_Price:  99.12540583678096
curr_Factors:  [99.12540584]
mat_Sqrt:  [[0.15]]
grads:  [-0.02048981]
Stock Position:  -0.02048981237609497
Bond Position:  [3.15670851]


portfolio before change:  [1.13257444]
curr_Stock_Price:  98.80659935121147
curr_Factors:  [98.80659935]
mat_Sqrt:  [[0.15]]
grads:  [0.08430434]
Stock Position:  0.08430434313129341
Bond Position:  [-7.19725102]


portfolio before change:  [1.08136381]
curr_Stock_Price:  98.20982212855739
curr_Factors:  [98.20982213]
mat_Sqrt:  [[0.15]]
grads:  [-0.00277983]
Stock Position:  -0.002779828223252896
Bond Position:  [1.35437025]


portfolio before change:  [1.08095674]
curr_Stock_Price:  98.41716462691305
curr_Factors:  [98.41716463]
mat_Sqrt:  [[0.15]]
grads:  [0.03310318]
Stock Position:  0.03310317633290001
Bond Position:  [-2.17696401]


portfolio before change:  [1.08480898]
curr_Stock_Price:  98.54175602982806
curr_Factors:  [98.54175603]
mat_Sqrt:  [[0.15]]
grads:  [0.07145692]
Stock Position:  0.07145692326595522
Bond Position:  [-5.95668172]


portfolio before change:  [1.02014779]
curr_Stock_Price:  97.64727925741335
curr_Factors:  [97.64727926]
mat_Sqrt:  [[0.15]]
grads:  [0.02486421]
Stock Position:  0.02486420532611273
Bond Position:  [-1.40777421]


portfolio before change:  [1.0045521]
curr_Stock_Price:  97.02712261796404
curr_Factors:  [97.02712262]
mat_Sqrt:  [[0.15]]
grads:  [-0.07782136]
Stock Position:  -0.07782135690863837
Bond Position:  [8.55533444]


portfolio before change:  [0.96980741]
curr_Stock_Price:  97.48733273659573
curr_Factors:  [97.48733274]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143322]
Stock Position:  -0.04143321732289683
Bond Position:  [5.00902125]


portfolio before change:  [0.93337279]
curr_Stock_Price:  98.3818032019182
curr_Factors:  [98.3818032]
mat_Sqrt:  [[0.15]]
grads:  [-0.01531729]
Stock Position:  -0.015317289570491641
Bond Position:  [2.44031536]


portfolio before change:  [0.93224819]
curr_Stock_Price:  98.47513954518018
curr_Factors:  [98.47513955]
mat_Sqrt:  [[0.15]]
grads:  [-0.04988829]
Stock Position:  -0.04988829212018165
Bond Position:  [5.84500471]


portfolio before change:  [0.97232539]
curr_Stock_Price:  97.68644673998084
curr_Factors:  [97.68644674]
mat_Sqrt:  [[0.15]]
grads:  [-0.01608548]
Stock Position:  -0.016085481825978888
Bond Position:  [2.54365896]


portfolio before change:  [0.95809156]
curr_Stock_Price:  98.59110198130223
curr_Factors:  [98.59110198]
mat_Sqrt:  [[0.15]]
grads:  [0.00212889]
Stock Position:  0.002128890353968578
Bond Position:  [0.74820191]


portfolio before change:  [0.95964436]
curr_Stock_Price:  99.27656580424878
curr_Factors:  [99.2765658]
mat_Sqrt:  [[0.15]]
grads:  [0.06103277]
Stock Position:  0.06103276503367503
Bond Position:  [-5.09947895]


portfolio before change:  [0.99370741]
curr_Stock_Price:  99.84512136385105
curr_Factors:  [99.84512136]
mat_Sqrt:  [[0.15]]
grads:  [0.03179364]
Stock Position:  0.031793644742810254
Bond Position:  [-2.18073291]


portfolio before change:  [0.96535798]
curr_Stock_Price:  98.96202619590044
curr_Factors:  [98.9620262]
mat_Sqrt:  [[0.15]]
grads:  [0.03981295]
Stock Position:  0.039812953964245744
Bond Position:  [-2.97461261]


portfolio before change:  [0.92097274]
curr_Stock_Price:  97.85652170686984
curr_Factors:  [97.85652171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01558571]
Stock Position:  -0.015585705827629576
Bond Position:  [2.4461357]


portfolio before change:  [0.8971725]
curr_Stock_Price:  99.40319700317046
curr_Factors:  [99.403197]
mat_Sqrt:  [[0.15]]
grads:  [-0.05069122]
Stock Position:  -0.050691220093247814
Bond Position:  [5.93604183]


portfolio before change:  [0.90752688]
curr_Stock_Price:  99.21357172794544
curr_Factors:  [99.21357173]
mat_Sqrt:  [[0.15]]
grads:  [0.05556321]
Stock Position:  0.05556320828799428
Bond Position:  [-4.60509747]


portfolio before change:  [0.92719927]
curr_Stock_Price:  99.57798655213253
curr_Factors:  [99.57798655]
mat_Sqrt:  [[0.15]]
grads:  [-0.1717056]
Stock Position:  -0.17170560414207264
Bond Position:  [18.02529761]


portfolio before change:  [0.96080285]
curr_Stock_Price:  99.39540499843206
curr_Factors:  [99.395405]
mat_Sqrt:  [[0.15]]
grads:  [-0.2275862]
Stock Position:  -0.22758620313259126
Bond Position:  [23.58182568]


portfolio before change:  [0.62771648]
curr_Stock_Price:  100.87191928545577
curr_Factors:  [100.87191929]
mat_Sqrt:  [[0.15]]
grads:  [0.14577395]
Stock Position:  0.14577395223753686
Bond Position:  [-14.07678187]


portfolio before change:  [0.67110876]
curr_Stock_Price:  101.18165901459895
curr_Factors:  [101.18165901]
mat_Sqrt:  [[0.15]]
grads:  [0.04130475]
Stock Position:  0.04130475340368313
Bond Position:  [-3.50817472]


portfolio before change:  [0.67831772]
curr_Stock_Price:  101.36680744377968
curr_Factors:  [101.36680744]
mat_Sqrt:  [[0.15]]
grads:  [0.04040032]
Stock Position:  0.04040031720365921
Bond Position:  [-3.41693346]


portfolio before change:  [0.70805162]
curr_Stock_Price:  102.11336205205818
curr_Factors:  [102.11336205]
mat_Sqrt:  [[0.15]]
grads:  [-0.08455581]
Stock Position:  -0.08455581144245929
Bond Position:  [9.3423298]


portfolio before change:  [0.73075654]
curr_Stock_Price:  101.8586537744406
curr_Factors:  [101.85865377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04029194]
Stock Position:  -0.04029193997850295
Bond Position:  [4.83483931]


portfolio before change:  [0.71565655]
curr_Stock_Price:  102.24841887485493
curr_Factors:  [102.24841887]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366222]
Stock Position:  -0.03662220219096284
Bond Position:  [4.46021882]


portfolio before change:  [0.70034642]
curr_Stock_Price:  102.68169940725795
curr_Factors:  [102.68169941]
mat_Sqrt:  [[0.15]]
grads:  [-0.02132662]
Stock Position:  -0.021326624025302054
Bond Position:  [2.89020042]


portfolio before change:  [0.70652757]
curr_Stock_Price:  102.40880782564783
curr_Factors:  [102.40880783]
mat_Sqrt:  [[0.15]]
grads:  [0.15523398]
Stock Position:  0.15523397697375216
Bond Position:  [-15.19079894]


portfolio before change:  [0.46900809]
curr_Stock_Price:  100.89096670627472
curr_Factors:  [100.89096671]
mat_Sqrt:  [[0.15]]
grads:  [0.04166949]
Stock Position:  0.04166948610352836
Bond Position:  [-3.73506664]


portfolio before change:  [0.41656475]
curr_Stock_Price:  99.64361682292962
curr_Factors:  [99.64361682]
mat_Sqrt:  [[0.15]]
grads:  [0.15760327]
Stock Position:  0.1576032679419295
Bond Position:  [-15.28759489]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.41656475]
Stock Price:  98.09791350072928
PL:  [0.41656475]
Settle:  Tensor("sub_216:0", shape=(), dtype=float64)
PL:  Tensor("sub_217:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  109
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.53362570e-03]
 [ 5.08152059e-03]
 [-6.22699871e-03]
 [-6.25001716e-03]
 [ 7.19582763e-03]
 [ 1.52411888e-02]
 [ 2.16806186e-02]
 [-3.11112528e-03]
 [ 7.98135200e-03]
 [-1.25163738e-03]
 [ 1.61075927e-03]
 [ 1.61995061e-03]
 [ 8.09440306e-03]
 [ 1.07904098e-02]
 [-1.93689351e-04]
 [-1.00305739e-02]
 [-2.16980256e-03]
 [-2.21539064e-03]
 [-7.47300915e-03]
 [-2.36030872e-03]
 [ 3.21085100e-04]
 [ 8.68904991e-03]
 [ 4.76372374e-03]
 [ 5.87361261e-03]
 [-3.29835690e-03]
 [-5.24615658e-03]
 [-7.46272740e-03]
 [-2.05595405e-02]
 [-3.81255372e-02]
 [ 2.17577962e-02]
 [ 7.47717087e-03]
 [ 4.34332980e-03]
 [-1.24732120e-02]
 [-6.64415604e-03]
 [-5.53472377e-03]
 [-2.80932804e-03]
 [ 2.34176648e-02]
 [-2.41844592e-04]
 [ 2.02641304e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.50324376]
curr_Stock_Price:  98.87627352094927
curr_Factors:  [98.87627352]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689084]
Stock Position:  -0.036890837969931305
Bond Position:  [-11.85561517]


portfolio before change:  [-15.5280964]
curr_Stock_Price:  99.50978043644056
curr_Factors:  [99.50978044]
mat_Sqrt:  [[0.15]]
grads:  [0.0338768]
Stock Position:  0.03387680395327042
Bond Position:  [-18.89916973]


portfolio before change:  [-15.47857062]
curr_Stock_Price:  101.04145751039937
curr_Factors:  [101.04145751]
mat_Sqrt:  [[0.15]]
grads:  [-0.04151332]
Stock Position:  -0.04151332476251134
Bond Position:  [-11.28400378]


portfolio before change:  [-15.42735232]
curr_Stock_Price:  99.77369838875397
curr_Factors:  [99.77369839]
mat_Sqrt:  [[0.15]]
grads:  [-0.04166678]
Stock Position:  -0.04166678109627761
Bond Position:  [-11.27010347]


portfolio before change:  [-15.45043959]
curr_Stock_Price:  100.29397913511481
curr_Factors:  [100.29397914]
mat_Sqrt:  [[0.15]]
grads:  [0.04797218]
Stock Position:  0.047972184183087366
Bond Position:  [-20.26176083]


portfolio before change:  [-15.47267826]
curr_Stock_Price:  99.88320367408681
curr_Factors:  [99.88320367]
mat_Sqrt:  [[0.15]]
grads:  [0.10160793]
Stock Position:  0.10160792550967028
Bond Position:  [-25.62160338]


portfolio before change:  [-15.52948477]
curr_Stock_Price:  99.35565033676465
curr_Factors:  [99.35565034]
mat_Sqrt:  [[0.15]]
grads:  [0.14453746]
Stock Position:  0.14453745739793686
Bond Position:  [-29.89009784]


portfolio before change:  [-15.53644453]
curr_Stock_Price:  99.33334973436234
curr_Factors:  [99.33334973]
mat_Sqrt:  [[0.15]]
grads:  [-0.02074084]
Stock Position:  -0.02074083519027897
Bond Position:  [-13.4761879]


portfolio before change:  [-15.55661761]
curr_Stock_Price:  100.22475279553555
curr_Factors:  [100.2247528]
mat_Sqrt:  [[0.15]]
grads:  [0.05320901]
Stock Position:  0.05320901331670239
Bond Position:  [-20.88947781]


portfolio before change:  [-15.64189331]
curr_Stock_Price:  98.67117475621018
curr_Factors:  [98.67117476]
mat_Sqrt:  [[0.15]]
grads:  [-0.00834425]
Stock Position:  -0.00834424918379724
Bond Position:  [-14.81855644]


portfolio before change:  [-15.63919185]
curr_Stock_Price:  98.12542265051786
curr_Factors:  [98.12542265]
mat_Sqrt:  [[0.15]]
grads:  [0.0107384]
Stock Position:  0.010738395112458953
Bond Position:  [-16.69290141]


portfolio before change:  [-15.63725562]
curr_Stock_Price:  98.5000577553035
curr_Factors:  [98.50005776]
mat_Sqrt:  [[0.15]]
grads:  [0.01079967]
Stock Position:  0.010799670755685133
Bond Position:  [-16.70102381]


portfolio before change:  [-15.64958337]
curr_Stock_Price:  97.55188096157912
curr_Factors:  [97.55188096]
mat_Sqrt:  [[0.15]]
grads:  [0.05396269]
Stock Position:  0.053962687052254044
Bond Position:  [-20.913745]


portfolio before change:  [-15.60530074]
curr_Stock_Price:  98.42094470170035
curr_Factors:  [98.4209447]
mat_Sqrt:  [[0.15]]
grads:  [0.07193607]
Stock Position:  0.0719360652329822
Bond Position:  [-22.68531624]


portfolio before change:  [-15.61702633]
curr_Stock_Price:  98.29736628174042
curr_Factors:  [98.29736628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00129126]
Stock Position:  -0.0012912623407974832
Bond Position:  [-15.49009864]


portfolio before change:  [-15.61922541]
curr_Stock_Price:  98.50081454931612
curr_Factors:  [98.50081455]
mat_Sqrt:  [[0.15]]
grads:  [-0.06687049]
Stock Position:  -0.06687049298646047
Bond Position:  [-9.03242739]


portfolio before change:  [-15.65001811]
curr_Stock_Price:  98.94441193092872
curr_Factors:  [98.94441193]
mat_Sqrt:  [[0.15]]
grads:  [-0.01446535]
Stock Position:  -0.014465350430933263
Bond Position:  [-14.21875252]


portfolio before change:  [-15.64321255]
curr_Stock_Price:  98.35106153785115
curr_Factors:  [98.35106154]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476927]
Stock Position:  -0.014769270934479257
Bond Position:  [-14.19063907]


portfolio before change:  [-15.64777979]
curr_Stock_Price:  98.5401906911063
curr_Factors:  [98.54019069]
mat_Sqrt:  [[0.15]]
grads:  [-0.04982006]
Stock Position:  -0.049820061011706274
Bond Position:  [-10.73850148]


portfolio before change:  [-15.64122363]
curr_Stock_Price:  98.3816490979799
curr_Factors:  [98.3816491]
mat_Sqrt:  [[0.15]]
grads:  [-0.01573539]
Stock Position:  -0.015735391467231387
Bond Position:  [-14.09314987]


portfolio before change:  [-15.64493262]
curr_Stock_Price:  98.50539749049565
curr_Factors:  [98.50539749]
mat_Sqrt:  [[0.15]]
grads:  [0.00214057]
Stock Position:  0.002140567333112537
Bond Position:  [-15.85579005]


portfolio before change:  [-15.64710426]
curr_Stock_Price:  98.41684581139475
curr_Factors:  [98.41684581]
mat_Sqrt:  [[0.15]]
grads:  [0.057927]
Stock Position:  0.05792699942200736
Bond Position:  [-21.34809683]


portfolio before change:  [-15.67554908]
curr_Stock_Price:  97.97186966176325
curr_Factors:  [97.97186966]
mat_Sqrt:  [[0.15]]
grads:  [0.03175816]
Stock Position:  0.03175815827760993
Bond Position:  [-18.78695522]


portfolio before change:  [-15.65294539]
curr_Stock_Price:  98.75756380586635
curr_Factors:  [98.75756381]
mat_Sqrt:  [[0.15]]
grads:  [0.03915742]
Stock Position:  0.039157417400941245
Bond Position:  [-19.52003654]


portfolio before change:  [-15.67376745]
curr_Stock_Price:  98.2881278017894
curr_Factors:  [98.2881278]
mat_Sqrt:  [[0.15]]
grads:  [-0.02198905]
Stock Position:  -0.02198904598166161
Bond Position:  [-13.51250529]


portfolio before change:  [-15.66533092]
curr_Stock_Price:  97.82763929276027
curr_Factors:  [97.82763929]
mat_Sqrt:  [[0.15]]
grads:  [-0.03497438]
Stock Position:  -0.03497437720316146
Bond Position:  [-12.24387016]


portfolio before change:  [-15.65309381]
curr_Stock_Price:  97.43398848259508
curr_Factors:  [97.43398848]
mat_Sqrt:  [[0.15]]
grads:  [-0.04975152]
Stock Position:  -0.0497515160094171
Bond Position:  [-10.80560517]


portfolio before change:  [-15.67858829]
curr_Stock_Price:  97.91927409200187
curr_Factors:  [97.91927409]
mat_Sqrt:  [[0.15]]
grads:  [-0.1370636]
Stock Position:  -0.13706360307137067
Bond Position:  [-2.25741977]


portfolio before change:  [-15.77451446]
curr_Stock_Price:  98.61708135301092
curr_Factors:  [98.61708135]
mat_Sqrt:  [[0.15]]
grads:  [-0.25417025]
Stock Position:  -0.25417024824062673
Bond Position:  [9.29101359]


portfolio before change:  [-15.87350028]
curr_Stock_Price:  99.01109785711243
curr_Factors:  [99.01109786]
mat_Sqrt:  [[0.15]]
grads:  [0.14505197]
Stock Position:  0.14505197433812914
Bond Position:  [-30.23525551]


portfolio before change:  [-15.88071534]
curr_Stock_Price:  98.98741381057327
curr_Factors:  [98.98741381]
mat_Sqrt:  [[0.15]]
grads:  [0.04984781]
Stock Position:  0.04984780582581276
Bond Position:  [-20.81502072]


portfolio before change:  [-15.79467679]
curr_Stock_Price:  100.7656383363557
curr_Factors:  [100.76563834]
mat_Sqrt:  [[0.15]]
grads:  [0.02895553]
Stock Position:  0.028955532030442536
Bond Position:  [-18.71239946]


portfolio before change:  [-15.78774969]
curr_Stock_Price:  101.08565664514884
curr_Factors:  [101.08565665]
mat_Sqrt:  [[0.15]]
grads:  [-0.08315475]
Stock Position:  -0.08315474662460819
Bond Position:  [-7.38199752]


portfolio before change:  [-15.81881476]
curr_Stock_Price:  101.44814065167019
curr_Factors:  [101.44814065]
mat_Sqrt:  [[0.15]]
grads:  [-0.04429437]
Stock Position:  -0.044294373583525413
Bond Position:  [-11.32523292]


portfolio before change:  [-15.8762617]
curr_Stock_Price:  102.71311387282721
curr_Factors:  [102.71311387]
mat_Sqrt:  [[0.15]]
grads:  [-0.03689816]
Stock Position:  -0.036898158447842236
Bond Position:  [-12.08633695]


portfolio before change:  [-15.88381426]
curr_Stock_Price:  102.8768531490194
curr_Factors:  [102.87685315]
mat_Sqrt:  [[0.15]]
grads:  [-0.01872885]
Stock Position:  -0.018728853584647744
Bond Position:  [-13.95704874]


portfolio before change:  [-15.88932428]
curr_Stock_Price:  103.0778947678595
curr_Factors:  [103.07789477]
mat_Sqrt:  [[0.15]]
grads:  [0.15611777]
Stock Position:  0.15611776514539596
Bond Position:  [-31.98161485]


portfolio before change:  [-15.76625248]
curr_Stock_Price:  103.8918300567373
curr_Factors:  [103.89183006]
mat_Sqrt:  [[0.15]]
grads:  [-0.0016123]
Stock Position:  -0.0016122972772637573
Bond Position:  [-15.59874796]


portfolio before change:  [-15.76968946]
curr_Stock_Price:  104.81412507184515
curr_Factors:  [104.81412507]
mat_Sqrt:  [[0.15]]
grads:  [0.1350942]
Stock Position:  0.13509420265490857
Bond Position:  [-29.92947011]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.76968946]
Stock Price:  105.26375446928589
PL:  [-21.03344392]
Settle:  Tensor("sub_218:0", shape=(), dtype=float64)
PL:  Tensor("sub_219:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  110
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.48893330e-03]
 [-9.35227623e-03]
 [ 2.29021973e-02]
 [ 1.73313162e-02]
 [ 1.20814518e-02]
 [ 3.79693146e-02]
 [ 3.69286368e-03]
 [ 2.69358794e-03]
 [ 1.37867390e-02]
 [ 1.34274537e-02]
 [ 2.70742270e-02]
 [ 6.60302386e-03]
 [-1.17478947e-02]
 [ 1.10114055e-02]
 [-3.26204235e-03]
 [-2.73861880e-02]
 [ 3.86665132e-03]
 [ 7.24831799e-04]
 [-1.67484709e-03]
 [-2.60418699e-03]
 [-9.91946072e-04]
 [-2.73590214e-02]
 [ 4.76824532e-03]
 [ 6.39211888e-03]
 [-4.58193785e-03]
 [-6.06961693e-03]
 [ 5.59143201e-03]
 [-1.95635577e-02]
 [-1.57366518e-02]
 [ 2.22043065e-02]
 [ 1.85785726e-03]
 [ 6.40100051e-03]
 [-1.27610689e-02]
 [-2.44746539e-03]
 [-5.48887228e-03]
 [-6.40002323e-03]
 [ 2.28560813e-02]
 [ 4.61939297e-03]
 [ 2.28719192e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.57532832]
curr_Stock_Price:  100.94284155529547
curr_Factors:  [100.94284156]
mat_Sqrt:  [[0.15]]
grads:  [-0.01659289]
Stock Position:  -0.016592888678745893
Bond Position:  [18.25026165]


portfolio before change:  [16.58136467]
curr_Stock_Price:  100.71654399316782
curr_Factors:  [100.71654399]
mat_Sqrt:  [[0.15]]
grads:  [-0.06234851]
Stock Position:  -0.062348508171701365
Bond Position:  [22.86089094]


portfolio before change:  [16.61521847]
curr_Stock_Price:  100.21940296267745
curr_Factors:  [100.21940296]
mat_Sqrt:  [[0.15]]
grads:  [0.15268132]
Stock Position:  0.15268131558757692
Bond Position:  [1.31358817]


portfolio before change:  [16.73710572]
curr_Stock_Price:  101.01663899127225
curr_Factors:  [101.01663899]
mat_Sqrt:  [[0.15]]
grads:  [0.11554211]
Stock Position:  0.11554210824977018
Bond Position:  [5.06543028]


portfolio before change:  [16.80350343]
curr_Stock_Price:  101.58582101735486
curr_Factors:  [101.58582102]
mat_Sqrt:  [[0.15]]
grads:  [0.08054301]
Stock Position:  0.08054301221074117
Bond Position:  [8.62147541]


portfolio before change:  [16.94203552]
curr_Stock_Price:  103.29241644815795
curr_Factors:  [103.29241645]
mat_Sqrt:  [[0.15]]
grads:  [0.25312876]
Stock Position:  0.25312876390225747
Bond Position:  [-9.20424618]


portfolio before change:  [16.89951702]
curr_Stock_Price:  103.12899015303336
curr_Factors:  [103.12899015]
mat_Sqrt:  [[0.15]]
grads:  [0.02461909]
Stock Position:  0.024619091186297536
Bond Position:  [14.36057501]


portfolio before change:  [16.92999144]
curr_Stock_Price:  104.29390880934697
curr_Factors:  [104.29390881]
mat_Sqrt:  [[0.15]]
grads:  [0.01795725]
Stock Position:  0.01795725296493526
Bond Position:  [15.05715934]


portfolio before change:  [16.92600771]
curr_Stock_Price:  103.96724418481843
curr_Factors:  [103.96724418]
mat_Sqrt:  [[0.15]]
grads:  [0.09191159]
Stock Position:  0.09191159363425307
Bond Position:  [7.37021261]


portfolio before change:  [16.93512957]
curr_Stock_Price:  104.05646608637345
curr_Factors:  [104.05646609]
mat_Sqrt:  [[0.15]]
grads:  [0.08951636]
Stock Position:  0.08951635817759335
Bond Position:  [7.62037368]


portfolio before change:  [16.76771137]
curr_Stock_Price:  102.17557178687038
curr_Factors:  [102.17557179]
mat_Sqrt:  [[0.15]]
grads:  [0.18049485]
Stock Position:  0.18049484639645955
Bond Position:  [-1.67445277]


portfolio before change:  [16.74068843]
curr_Stock_Price:  102.02701563722647
curr_Factors:  [102.02701564]
mat_Sqrt:  [[0.15]]
grads:  [0.04402016]
Stock Position:  0.044020159072642444
Bond Position:  [12.24944297]


portfolio before change:  [16.74742772]
curr_Stock_Price:  102.1453255637752
curr_Factors:  [102.14532556]
mat_Sqrt:  [[0.15]]
grads:  [-0.0783193]
Stock Position:  -0.07831929800562606
Bond Position:  [24.74737792]


portfolio before change:  [16.74004082]
curr_Stock_Price:  102.27914338612226
curr_Factors:  [102.27914339]
mat_Sqrt:  [[0.15]]
grads:  [0.07340937]
Stock Position:  0.07340936971580947
Bond Position:  [9.23179337]


portfolio before change:  [16.75411054]
curr_Stock_Price:  102.45508368933554
curr_Factors:  [102.45508369]
mat_Sqrt:  [[0.15]]
grads:  [-0.02174695]
Stock Position:  -0.021746948994652307
Bond Position:  [18.98219601]


portfolio before change:  [16.74283807]
curr_Stock_Price:  103.08254591701274
curr_Factors:  [103.08254592]
mat_Sqrt:  [[0.15]]
grads:  [-0.18257459]
Stock Position:  -0.1825745868337128
Bond Position:  [35.5630913]


portfolio before change:  [16.9284343]
curr_Stock_Price:  102.09034558058843
curr_Factors:  [102.09034558]
mat_Sqrt:  [[0.15]]
grads:  [0.02577768]
Stock Position:  0.025777675448702162
Bond Position:  [14.2967825]


portfolio before change:  [16.93999833]
curr_Stock_Price:  102.4696204385255
curr_Factors:  [102.46962044]
mat_Sqrt:  [[0.15]]
grads:  [0.00483221]
Stock Position:  0.004832211994550031
Bond Position:  [16.4448434]


portfolio before change:  [16.94383057]
curr_Stock_Price:  102.83725786015118
curr_Factors:  [102.83725786]
mat_Sqrt:  [[0.15]]
grads:  [-0.01116565]
Stock Position:  -0.011165647274374314
Bond Position:  [18.09207512]


portfolio before change:  [16.9503858]
curr_Stock_Price:  102.45272311771467
curr_Factors:  [102.45272312]
mat_Sqrt:  [[0.15]]
grads:  [-0.01736125]
Stock Position:  -0.01736124658541039
Bond Position:  [18.72909279]


portfolio before change:  [16.94821978]
curr_Stock_Price:  102.71234177778132
curr_Factors:  [102.71234178]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661297]
Stock Position:  -0.006612973810823015
Bond Position:  [17.6274538]


portfolio before change:  [16.95427084]
curr_Stock_Price:  102.13053208485995
curr_Factors:  [102.13053208]
mat_Sqrt:  [[0.15]]
grads:  [-0.18239348]
Stock Position:  -0.18239347584557805
Bond Position:  [35.58221358]


portfolio before change:  [17.39130664]
curr_Stock_Price:  99.75880391309256
curr_Factors:  [99.75880391]
mat_Sqrt:  [[0.15]]
grads:  [0.0317883]
Stock Position:  0.031788302115325844
Bond Position:  [14.22014364]


portfolio before change:  [17.40132414]
curr_Stock_Price:  100.0180146081301
curr_Factors:  [100.01801461]
mat_Sqrt:  [[0.15]]
grads:  [0.04261413]
Stock Position:  0.042614125865909624
Bond Position:  [13.13914387]


portfolio before change:  [17.49597021]
curr_Stock_Price:  102.20047342267084
curr_Factors:  [102.20047342]
mat_Sqrt:  [[0.15]]
grads:  [-0.03054625]
Stock Position:  -0.030546252346965036
Bond Position:  [20.61781166]


portfolio before change:  [17.5100882]
curr_Stock_Price:  101.82266575835122
curr_Factors:  [101.82266576]
mat_Sqrt:  [[0.15]]
grads:  [-0.04046411]
Stock Position:  -0.0404641128344066
Bond Position:  [21.63025204]


portfolio before change:  [17.52571937]
curr_Stock_Price:  101.50319205845109
curr_Factors:  [101.50319206]
mat_Sqrt:  [[0.15]]
grads:  [0.03727621]
Stock Position:  0.037276213417099635
Bond Position:  [13.74206472]


portfolio before change:  [17.51055635]
curr_Stock_Price:  101.05033258929393
curr_Factors:  [101.05033259]
mat_Sqrt:  [[0.15]]
grads:  [-0.13042372]
Stock Position:  -0.1304237181588577
Bond Position:  [30.68991645]


portfolio before change:  [17.5815831]
curr_Stock_Price:  100.53516352154551
curr_Factors:  [100.53516352]
mat_Sqrt:  [[0.15]]
grads:  [-0.10491101]
Stock Position:  -0.10491101170257497
Bond Position:  [28.12882881]


portfolio before change:  [17.49799069]
curr_Stock_Price:  101.36547418492236
curr_Factors:  [101.36547418]
mat_Sqrt:  [[0.15]]
grads:  [0.14802871]
Stock Position:  0.14802871007215457
Bond Position:  [2.4929903]


portfolio before change:  [17.56067678]
curr_Stock_Price:  101.78684139199517
curr_Factors:  [101.78684139]
mat_Sqrt:  [[0.15]]
grads:  [0.01238572]
Stock Position:  0.012385715064613665
Bond Position:  [16.29997396]


portfolio before change:  [17.56847891]
curr_Stock_Price:  102.25225771223536
curr_Factors:  [102.25225771]
mat_Sqrt:  [[0.15]]
grads:  [0.04267334]
Stock Position:  0.04267333674993888
Bond Position:  [13.20503389]


portfolio before change:  [17.58102558]
curr_Stock_Price:  102.50759130952687
curr_Factors:  [102.50759131]
mat_Sqrt:  [[0.15]]
grads:  [-0.08507379]
Stock Position:  -0.0850737923510783
Bond Position:  [26.30173512]


portfolio before change:  [17.53196412]
curr_Stock_Price:  103.1229322718493
curr_Factors:  [103.12293227]
mat_Sqrt:  [[0.15]]
grads:  [-0.01631644]
Stock Position:  -0.01631643593035463
Bond Position:  [19.21456283]


portfolio before change:  [17.54945162]
curr_Stock_Price:  102.19837147688722
curr_Factors:  [102.19837148]
mat_Sqrt:  [[0.15]]
grads:  [-0.03659248]
Stock Position:  -0.03659248185252585
Bond Position:  [21.28914368]


portfolio before change:  [17.58631805]
curr_Stock_Price:  101.26361333454419
curr_Factors:  [101.26361333]
mat_Sqrt:  [[0.15]]
grads:  [-0.04266682]
Stock Position:  -0.04266682154177662
Bond Position:  [21.90691457]


portfolio before change:  [17.59240559]
curr_Stock_Price:  101.18512130175985
curr_Factors:  [101.1851213]
mat_Sqrt:  [[0.15]]
grads:  [0.15237388]
Stock Position:  0.1523738753540277
Bond Position:  [2.17443653]


portfolio before change:  [17.60386248]
curr_Stock_Price:  101.25852668701015
curr_Factors:  [101.25852669]
mat_Sqrt:  [[0.15]]
grads:  [0.03079595]
Stock Position:  0.030795953158079196
Bond Position:  [14.48550963]


portfolio before change:  [17.61273532]
curr_Stock_Price:  101.48784375977512
curr_Factors:  [101.48784376]
mat_Sqrt:  [[0.15]]
grads:  [0.15247946]
Stock Position:  0.15247946111560368
Bond Position:  [2.13792359]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.61273532]
Stock Price:  99.92946912334763
PL:  [17.61273532]
Settle:  Tensor("sub_220:0", shape=(), dtype=float64)
PL:  Tensor("sub_221:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  111
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.85358641e-03]
 [-6.05613049e-03]
 [ 1.88572229e-02]
 [ 3.74585811e-02]
 [-1.44373774e-02]
 [ 2.82732063e-02]
 [ 1.33227069e-02]
 [ 1.26743749e-03]
 [ 8.15541205e-03]
 [ 1.21250964e-02]
 [ 2.33545784e-02]
 [-8.14403602e-03]
 [-1.27477331e-02]
 [-8.05832005e-03]
 [-9.09498189e-04]
 [-2.68430445e-02]
 [ 4.96498756e-03]
 [ 1.56673231e-03]
 [ 5.53676567e-05]
 [-2.94612859e-03]
 [-1.16012526e-03]
 [-2.68605665e-02]
 [ 4.78364199e-03]
 [ 6.89453565e-03]
 [-4.64485436e-03]
 [-7.79506626e-03]
 [ 5.48149314e-03]
 [-2.62039662e-02]
 [-3.32228476e-02]
 [ 2.20206217e-02]
 [ 4.60018058e-03]
 [-3.20307471e-03]
 [-1.25335097e-02]
 [-8.40913086e-03]
 [-7.51048466e-03]
 [-7.24658574e-03]
 [ 2.15757247e-02]
 [ 8.90615502e-03]
 [ 2.27268847e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.48521848]
curr_Stock_Price:  99.90628336387876
curr_Factors:  [99.90628336]
mat_Sqrt:  [[0.15]]
grads:  [-0.01235724]
Stock Position:  -0.012357242737011352
Bond Position:  [1.71978468]


portfolio before change:  [0.48546879]
curr_Stock_Price:  99.90342548879362
curr_Factors:  [99.90342549]
mat_Sqrt:  [[0.15]]
grads:  [-0.0403742]
Stock Position:  -0.040374203286983115
Bond Position:  [4.51899]


portfolio before change:  [0.46494128]
curr_Stock_Price:  100.42584849548331
curr_Factors:  [100.4258485]
mat_Sqrt:  [[0.15]]
grads:  [0.12571482]
Stock Position:  0.12571481904763454
Bond Position:  [-12.16007609]


portfolio before change:  [0.6113337]
curr_Stock_Price:  101.6024204123758
curr_Factors:  [101.60242041]
mat_Sqrt:  [[0.15]]
grads:  [0.24972387]
Stock Position:  0.24972387380678604
Bond Position:  [-24.76121631]


portfolio before change:  [0.81717469]
curr_Stock_Price:  102.43908983773218
curr_Factors:  [102.43908984]
mat_Sqrt:  [[0.15]]
grads:  [-0.09624918]
Stock Position:  -0.09624918264920164
Bond Position:  [10.67685336]


portfolio before change:  [0.92956319]
curr_Stock_Price:  101.28527421590648
curr_Factors:  [101.28527422]
mat_Sqrt:  [[0.15]]
grads:  [0.18848804]
Stock Position:  0.18848804167635894
Bond Position:  [-18.1614998]


portfolio before change:  [0.99568362]
curr_Stock_Price:  101.64811296054452
curr_Factors:  [101.64811296]
mat_Sqrt:  [[0.15]]
grads:  [0.08881805]
Stock Position:  0.08881804576758487
Bond Position:  [-8.03250313]


portfolio before change:  [1.11057317]
curr_Stock_Price:  102.95295676221484
curr_Factors:  [102.95295676]
mat_Sqrt:  [[0.15]]
grads:  [0.00844958]
Stock Position:  0.008449583242345413
Bond Position:  [0.2406636]


portfolio before change:  [1.10461969]
curr_Stock_Price:  102.24480659870528
curr_Factors:  [102.2448066]
mat_Sqrt:  [[0.15]]
grads:  [0.05436941]
Stock Position:  0.05436941365963344
Bond Position:  [-4.4543705]


portfolio before change:  [1.11825543]
curr_Stock_Price:  102.50584628308046
curr_Factors:  [102.50584628]
mat_Sqrt:  [[0.15]]
grads:  [0.08083398]
Stock Position:  0.08083397598842822
Bond Position:  [-7.16769969]


portfolio before change:  [1.18539656]
curr_Stock_Price:  103.3475363379156
curr_Factors:  [103.34753634]
mat_Sqrt:  [[0.15]]
grads:  [0.15569719]
Stock Position:  0.15569718932323268
Bond Position:  [-14.90552437]


portfolio before change:  [1.26417708]
curr_Stock_Price:  103.86548930785617
curr_Factors:  [103.86548931]
mat_Sqrt:  [[0.15]]
grads:  [-0.05429357]
Stock Position:  -0.05429357344117357
Bond Position:  [6.90340565]


portfolio before change:  [1.25462632]
curr_Stock_Price:  104.05729363659746
curr_Factors:  [104.05729364]
mat_Sqrt:  [[0.15]]
grads:  [-0.08498489]
Stock Position:  -0.08498488713287934
Bond Position:  [10.09792367]


portfolio before change:  [1.17724453]
curr_Stock_Price:  104.98268292117771
curr_Factors:  [104.98268292]
mat_Sqrt:  [[0.15]]
grads:  [-0.05372213]
Stock Position:  -0.053722133661294344
Bond Position:  [6.81713826]


portfolio before change:  [1.27994254]
curr_Stock_Price:  103.08689415528184
curr_Factors:  [103.08689416]
mat_Sqrt:  [[0.15]]
grads:  [-0.00606332]
Stock Position:  -0.006063321260187874
Bond Position:  [1.9049915]


portfolio before change:  [1.28150437]
curr_Stock_Price:  102.86858354639143
curr_Factors:  [102.86858355]
mat_Sqrt:  [[0.15]]
grads:  [-0.17895363]
Stock Position:  -0.17895363027758734
Bond Position:  [19.69021084]


portfolio before change:  [1.24759274]
curr_Stock_Price:  103.07183763989067
curr_Factors:  [103.07183764]
mat_Sqrt:  [[0.15]]
grads:  [0.03309992]
Stock Position:  0.03309991704391415
Bond Position:  [-2.16407653]


portfolio before change:  [1.21997629]
curr_Stock_Price:  102.24567464451223
curr_Factors:  [102.24567464]
mat_Sqrt:  [[0.15]]
grads:  [0.01044488]
Stock Position:  0.010444882045519105
Bond Position:  [0.15203228]


portfolio before change:  [1.23007167]
curr_Stock_Price:  103.21039326672658
curr_Factors:  [103.21039327]
mat_Sqrt:  [[0.15]]
grads:  [0.00036912]
Stock Position:  0.00036911771147739997
Bond Position:  [1.19197488]


portfolio before change:  [1.230199]
curr_Stock_Price:  103.15167584594249
curr_Factors:  [103.15167585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01964086]
Stock Position:  -0.01964085727566787
Bond Position:  [3.25618634]


portfolio before change:  [1.2338019]
curr_Stock_Price:  102.98896152975901
curr_Factors:  [102.98896153]
mat_Sqrt:  [[0.15]]
grads:  [-0.00773417]
Stock Position:  -0.007734168398565678
Bond Position:  [2.03033587]


portfolio before change:  [1.24086421]
curr_Stock_Price:  102.10864698589141
curr_Factors:  [102.10864699]
mat_Sqrt:  [[0.15]]
grads:  [-0.17907044]
Stock Position:  -0.1790704434450552
Bond Position:  [19.5255049]


portfolio before change:  [1.35684132]
curr_Stock_Price:  101.47461562657779
curr_Factors:  [101.47461563]
mat_Sqrt:  [[0.15]]
grads:  [0.03189095]
Stock Position:  0.03189094661898398
Bond Position:  [-1.87928023]


portfolio before change:  [1.3287968]
curr_Stock_Price:  100.60259401601354
curr_Factors:  [100.60259402]
mat_Sqrt:  [[0.15]]
grads:  [0.04596357]
Stock Position:  0.04596357102003024
Bond Position:  [-3.29525767]


portfolio before change:  [1.31029382]
curr_Stock_Price:  100.20899856529996
curr_Factors:  [100.20899857]
mat_Sqrt:  [[0.15]]
grads:  [-0.0309657]
Stock Position:  -0.030965695766503536
Bond Position:  [4.41333518]


portfolio before change:  [1.33059829]
curr_Stock_Price:  99.5711064371933
curr_Factors:  [99.57110644]
mat_Sqrt:  [[0.15]]
grads:  [-0.05196711]
Stock Position:  -0.051967108400339045
Bond Position:  [6.50502078]


portfolio before change:  [1.3606828]
curr_Stock_Price:  99.00784009039847
curr_Factors:  [99.00784009]
mat_Sqrt:  [[0.15]]
grads:  [0.03654329]
Stock Position:  0.03654328757033731
Bond Position:  [-2.25738918]


portfolio before change:  [1.37294693]
curr_Stock_Price:  99.35116774584553
curr_Factors:  [99.35116775]
mat_Sqrt:  [[0.15]]
grads:  [-0.17469311]
Stock Position:  -0.17469310793835185
Bond Position:  [18.7289112]


portfolio before change:  [1.61097564]
curr_Stock_Price:  98.00201635386716
curr_Factors:  [98.00201635]
mat_Sqrt:  [[0.15]]
grads:  [-0.22148565]
Stock Position:  -0.22148565097263073
Bond Position:  [23.31701602]


portfolio before change:  [1.71297342]
curr_Stock_Price:  97.55466018779448
curr_Factors:  [97.55466019]
mat_Sqrt:  [[0.15]]
grads:  [0.14680414]
Stock Position:  0.1468041447332084
Bond Position:  [-12.60845504]


portfolio before change:  [1.83659182]
curr_Stock_Price:  98.40746010322783
curr_Factors:  [98.4074601]
mat_Sqrt:  [[0.15]]
grads:  [0.03066787]
Stock Position:  0.03066787056298147
Bond Position:  [-1.18135543]


portfolio before change:  [1.82553956]
curr_Stock_Price:  98.05188973644448
curr_Factors:  [98.05188974]
mat_Sqrt:  [[0.15]]
grads:  [-0.02135383]
Stock Position:  -0.02135383138713904
Bond Position:  [3.91932308]


portfolio before change:  [1.83577653]
curr_Stock_Price:  97.59543671057067
curr_Factors:  [97.59543671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355673]
Stock Position:  -0.08355673103794826
Bond Position:  [9.99053218]


portfolio before change:  [1.78771759]
curr_Stock_Price:  98.185548745665
curr_Factors:  [98.18554875]
mat_Sqrt:  [[0.15]]
grads:  [-0.05606087]
Stock Position:  -0.05606087242453012
Bond Position:  [7.29208511]


portfolio before change:  [1.82873604]
curr_Stock_Price:  97.47013202285736
curr_Factors:  [97.47013202]
mat_Sqrt:  [[0.15]]
grads:  [-0.0500699]
Stock Position:  -0.05006989770116354
Bond Position:  [6.70905558]


portfolio before change:  [1.81607221]
curr_Stock_Price:  97.73980530959257
curr_Factors:  [97.73980531]
mat_Sqrt:  [[0.15]]
grads:  [-0.04831057]
Stock Position:  -0.04831057163325494
Bond Position:  [6.53793808]


portfolio before change:  [1.79756572]
curr_Stock_Price:  98.1397961907229
curr_Factors:  [98.13979619]
mat_Sqrt:  [[0.15]]
grads:  [0.14383816]
Stock Position:  0.14383816486948722
Bond Position:  [-12.31868247]


portfolio before change:  [1.63228406]
curr_Stock_Price:  97.00142150927542
curr_Factors:  [97.00142151]
mat_Sqrt:  [[0.15]]
grads:  [0.05937437]
Stock Position:  0.05937436677828686
Bond Position:  [-4.12711392]


portfolio before change:  [1.68701055]
curr_Stock_Price:  97.93182991076256
curr_Factors:  [97.93182991]
mat_Sqrt:  [[0.15]]
grads:  [0.15151256]
Stock Position:  0.1515125649066598
Bond Position:  [-13.15089219]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.68701055]
Stock Price:  98.38912620937282
PL:  [1.68701055]
Settle:  Tensor("sub_222:0", shape=(), dtype=float64)
PL:  Tensor("sub_223:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  112
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.36762392e-03]
 [-1.65768825e-02]
 [ 1.94471493e-02]
 [-7.43634294e-03]
 [ 6.92588740e-03]
 [ 1.48043423e-02]
 [ 2.72974462e-02]
 [-2.79392803e-03]
 [ 3.11610953e-03]
 [ 6.81084522e-03]
 [ 4.96236972e-03]
 [ 8.79557049e-03]
 [-4.37169518e-03]
 [ 1.03542995e-02]
 [-5.76087191e-03]
 [-2.69836204e-02]
 [ 4.18434511e-03]
 [-1.56598588e-03]
 [ 8.16063603e-03]
 [-3.70672707e-03]
 [-1.95606464e-03]
 [-3.95677993e-02]
 [ 4.82716678e-03]
 [ 1.00353129e-02]
 [-5.57270598e-03]
 [ 7.86537377e-03]
 [-8.71880722e-03]
 [ 1.62634160e-03]
 [ 5.39218269e-02]
 [ 2.57842285e-02]
 [-2.22454565e-02]
 [ 6.19649384e-03]
 [-1.30345727e-02]
 [ 1.64042983e-03]
 [-6.03187718e-03]
 [-5.17433798e-04]
 [ 2.39241285e-02]
 [-3.18945584e-04]
 [ 2.13602534e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [12.1234332]
curr_Stock_Price:  100.65604125342915
curr_Factors:  [100.65604125]
mat_Sqrt:  [[0.15]]
grads:  [-0.00911749]
Stock Position:  -0.009117492784178989
Bond Position:  [13.04116393]


portfolio before change:  [12.12860153]
curr_Stock_Price:  100.26798692139417
curr_Factors:  [100.26798692]
mat_Sqrt:  [[0.15]]
grads:  [-0.11051255]
Stock Position:  -0.11051255027890339
Bond Position:  [23.20947247]


portfolio before change:  [12.11628827]
curr_Stock_Price:  100.40566016645809
curr_Factors:  [100.40566017]
mat_Sqrt:  [[0.15]]
grads:  [0.12964766]
Stock Position:  0.12964766193503924
Bond Position:  [-0.90107082]


portfolio before change:  [11.99874169]
curr_Stock_Price:  99.49986719809048
curr_Factors:  [99.4998672]
mat_Sqrt:  [[0.15]]
grads:  [-0.04957562]
Stock Position:  -0.0495756195969919
Bond Position:  [16.93150925]


portfolio before change:  [11.99024616]
curr_Stock_Price:  99.71392610206298
curr_Factors:  [99.7139261]
mat_Sqrt:  [[0.15]]
grads:  [0.04617258]
Stock Position:  0.04617258265378385
Bond Position:  [7.38619666]


portfolio before change:  [12.00468003]
curr_Stock_Price:  100.00653561201065
curr_Factors:  [100.00653561]
mat_Sqrt:  [[0.15]]
grads:  [0.09869562]
Stock Position:  0.09869561533378297
Bond Position:  [2.13447346]


portfolio before change:  [11.99588809]
curr_Stock_Price:  99.91475072538293
curr_Factors:  [99.91475073]
mat_Sqrt:  [[0.15]]
grads:  [0.18198297]
Stock Position:  0.18198297439291145
Bond Position:  [-6.18689544]


portfolio before change:  [12.09547299]
curr_Stock_Price:  100.466221608588
curr_Factors:  [100.46622161]
mat_Sqrt:  [[0.15]]
grads:  [-0.01862619]
Stock Position:  -0.01862618684101733
Bond Position:  [13.9667756]


portfolio before change:  [12.08442196]
curr_Stock_Price:  101.15326389601793
curr_Factors:  [101.1532639]
mat_Sqrt:  [[0.15]]
grads:  [0.02077406]
Stock Position:  0.020774063562789824
Bond Position:  [9.98305763]


portfolio before change:  [12.07762934]
curr_Stock_Price:  100.76621473068172
curr_Factors:  [100.76621473]
mat_Sqrt:  [[0.15]]
grads:  [0.04540563]
Stock Position:  0.0454056347972295
Bond Position:  [7.50227539]


portfolio before change:  [12.03952071]
curr_Stock_Price:  99.90626687404415
curr_Factors:  [99.90626687]
mat_Sqrt:  [[0.15]]
grads:  [0.03308246]
Stock Position:  0.03308246483026883
Bond Position:  [8.73437515]


portfolio before change:  [12.02571842]
curr_Stock_Price:  99.45605409908006
curr_Factors:  [99.4560541]
mat_Sqrt:  [[0.15]]
grads:  [0.05863714]
Stock Position:  0.05863713661735991
Bond Position:  [6.19390019]


portfolio before change:  [12.01126165]
curr_Stock_Price:  99.19630309500387
curr_Factors:  [99.1963031]
mat_Sqrt:  [[0.15]]
grads:  [-0.02914463]
Stock Position:  -0.029144634510633028
Bond Position:  [14.90230165]


portfolio before change:  [11.99874668]
curr_Stock_Price:  99.6896313862394
curr_Factors:  [99.68963139]
mat_Sqrt:  [[0.15]]
grads:  [0.06902866]
Stock Position:  0.06902866315506073
Bond Position:  [5.1173047]


portfolio before change:  [12.13880582]
curr_Stock_Price:  101.70936390550602
curr_Factors:  [101.70936391]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840581]
Stock Position:  -0.03840581274206455
Bond Position:  [16.04503661]


portfolio before change:  [12.12848226]
curr_Stock_Price:  102.03039123917526
curr_Factors:  [102.03039124]
mat_Sqrt:  [[0.15]]
grads:  [-0.1798908]
Stock Position:  -0.17989080296715593
Bond Position:  [30.48281127]


portfolio before change:  [12.06223468]
curr_Stock_Price:  102.41983957995957
curr_Factors:  [102.41983958]
mat_Sqrt:  [[0.15]]
grads:  [0.02789563]
Stock Position:  0.027895634080138555
Bond Position:  [9.20516831]


portfolio before change:  [12.08002785]
curr_Stock_Price:  103.016436851753
curr_Factors:  [103.01643685]
mat_Sqrt:  [[0.15]]
grads:  [-0.01043991]
Stock Position:  -0.01043990587340135
Bond Position:  [13.15550976]


portfolio before change:  [12.06096704]
curr_Stock_Price:  104.99972655010926
curr_Factors:  [104.99972655]
mat_Sqrt:  [[0.15]]
grads:  [0.05440424]
Stock Position:  0.054404240185114375
Bond Position:  [6.3485367]


portfolio before change:  [12.05523543]
curr_Stock_Price:  104.87978699717574
curr_Factors:  [104.879787]
mat_Sqrt:  [[0.15]]
grads:  [-0.02471151]
Stock Position:  -0.02471151381529968
Bond Position:  [14.64697374]


portfolio before change:  [12.06290317]
curr_Stock_Price:  104.64359153752947
curr_Factors:  [104.64359154]
mat_Sqrt:  [[0.15]]
grads:  [-0.01304043]
Stock Position:  -0.013040430900915478
Bond Position:  [13.42750069]


portfolio before change:  [12.06446268]
curr_Stock_Price:  104.65271962398995
curr_Factors:  [104.65271962]
mat_Sqrt:  [[0.15]]
grads:  [-0.26378533]
Stock Position:  -0.26378532877449395
Bond Position:  [39.67031473]


portfolio before change:  [11.88739165]
curr_Stock_Price:  105.34278881771117
curr_Factors:  [105.34278882]
mat_Sqrt:  [[0.15]]
grads:  [0.03218111]
Stock Position:  0.03218111189701859
Bond Position:  [8.49734357]


portfolio before change:  [11.85581696]
curr_Stock_Price:  104.32862496620737
curr_Factors:  [104.32862497]
mat_Sqrt:  [[0.15]]
grads:  [0.06690209]
Stock Position:  0.06690208606148138
Bond Position:  [4.87601431]


portfolio before change:  [11.89388366]
curr_Stock_Price:  104.88850526015084
curr_Factors:  [104.88850526]
mat_Sqrt:  [[0.15]]
grads:  [-0.03715137]
Stock Position:  -0.03715137321658041
Bond Position:  [15.79063567]


portfolio before change:  [11.8802637]
curr_Stock_Price:  105.30824514110259
curr_Factors:  [105.30824514]
mat_Sqrt:  [[0.15]]
grads:  [0.05243583]
Stock Position:  0.05243582514586125
Bond Position:  [6.35833897]


portfolio before change:  [11.86695715]
curr_Stock_Price:  105.03931855863306
curr_Factors:  [105.03931856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05812538]
Stock Position:  -0.05812538146853837
Bond Position:  [17.97240762]


portfolio before change:  [11.88025566]
curr_Stock_Price:  104.8491810973843
curr_Factors:  [104.8491811]
mat_Sqrt:  [[0.15]]
grads:  [0.01084228]
Stock Position:  0.010842277362342057
Bond Position:  [10.74345176]


portfolio before change:  [11.89536235]
curr_Stock_Price:  106.1186259856927
curr_Factors:  [106.11862599]
mat_Sqrt:  [[0.15]]
grads:  [0.35947885]
Stock Position:  0.35947884568191196
Bond Position:  [-26.25203883]


portfolio before change:  [11.46406996]
curr_Stock_Price:  104.92798379590334
curr_Factors:  [104.9279838]
mat_Sqrt:  [[0.15]]
grads:  [0.17189486]
Stock Position:  0.17189485663664503
Bond Position:  [-6.57251077]


portfolio before change:  [11.53981142]
curr_Stock_Price:  105.37339024347163
curr_Factors:  [105.37339024]
mat_Sqrt:  [[0.15]]
grads:  [-0.14830304]
Stock Position:  -0.14830304313746723
Bond Position:  [27.16700586]


portfolio before change:  [11.64875215]
curr_Stock_Price:  104.6617080092591
curr_Factors:  [104.66170801]
mat_Sqrt:  [[0.15]]
grads:  [0.04130996]
Stock Position:  0.04130995894104121
Bond Position:  [7.32518129]


portfolio before change:  [11.64812119]
curr_Stock_Price:  104.62426744274822
curr_Factors:  [104.62426744]
mat_Sqrt:  [[0.15]]
grads:  [-0.08689715]
Stock Position:  -0.08689715125304065
Bond Position:  [20.73967198]


portfolio before change:  [11.63986026]
curr_Stock_Price:  104.74916854112368
curr_Factors:  [104.74916854]
mat_Sqrt:  [[0.15]]
grads:  [0.0109362]
Stock Position:  0.010936198865851716
Bond Position:  [10.49430252]


portfolio before change:  [11.63772452]
curr_Stock_Price:  104.43392125861739
curr_Factors:  [104.43392126]
mat_Sqrt:  [[0.15]]
grads:  [-0.04021251]
Stock Position:  -0.04021251456209202
Bond Position:  [15.8372751]


portfolio before change:  [11.6561606]
curr_Stock_Price:  104.02468805024992
curr_Factors:  [104.02468805]
mat_Sqrt:  [[0.15]]
grads:  [-0.00344956]
Stock Position:  -0.0034495586541259267
Bond Position:  [12.01499986]


portfolio before change:  [11.65735822]
curr_Stock_Price:  104.11291570170768
curr_Factors:  [104.1129157]
mat_Sqrt:  [[0.15]]
grads:  [0.15949419]
Stock Position:  0.15949419021160702
Bond Position:  [-4.94804696]


portfolio before change:  [11.51384534]
curr_Stock_Price:  103.21699382950281
curr_Factors:  [103.21699383]
mat_Sqrt:  [[0.15]]
grads:  [-0.0021263]
Stock Position:  -0.0021263038928359167
Bond Position:  [11.73331604]


portfolio before change:  [11.51548504]
curr_Stock_Price:  103.13566181659922
curr_Factors:  [103.13566182]
mat_Sqrt:  [[0.15]]
grads:  [0.14240169]
Stock Position:  0.14240168912991558
Bond Position:  [-3.17120742]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.51548504]
Stock Price:  103.88475499676538
PL:  [7.63073004]
Settle:  Tensor("sub_224:0", shape=(), dtype=float64)
PL:  Tensor("sub_225:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  113
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45935384e-03]
 [-2.20838544e-03]
 [-6.61486035e-03]
 [ 6.43454286e-03]
 [ 1.58137103e-02]
 [ 2.80818128e-02]
 [ 2.66024828e-02]
 [-2.20449229e-04]
 [ 5.23197155e-03]
 [ 1.19567693e-02]
 [ 2.49400788e-02]
 [ 1.03989914e-02]
 [-1.15250062e-02]
 [ 8.50927519e-03]
 [-4.73376739e-03]
 [-2.76595991e-02]
 [ 4.46048523e-03]
 [-1.39927188e-04]
 [ 3.97033224e-03]
 [-3.09929046e-03]
 [-1.57811833e-03]
 [-3.96131061e-02]
 [ 4.82420270e-03]
 [ 1.22451334e-02]
 [-5.57923970e-03]
 [ 3.77470405e-03]
 [-4.98257194e-03]
 [-2.13095274e-04]
 [ 3.87869183e-02]
 [ 2.58780931e-02]
 [-2.07701706e-02]
 [ 6.15076798e-03]
 [-1.30704127e-02]
 [ 2.16515159e-03]
 [-6.27679753e-03]
 [ 4.59454992e-03]
 [ 2.48289947e-02]
 [ 1.14636842e-02]
 [ 1.79939253e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.03259077]
curr_Stock_Price:  100.26365657299561
curr_Factors:  [100.26365657]
mat_Sqrt:  [[0.15]]
grads:  [-0.00972903]
Stock Position:  -0.009729025617009593
Bond Position:  [7.00805846]


portfolio before change:  [6.02084147]
curr_Stock_Price:  101.56135752999698
curr_Factors:  [101.56135753]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472257]
Stock Position:  -0.014722569618463991
Bond Position:  [7.51608563]


portfolio before change:  [6.02794013]
curr_Stock_Price:  101.14301407990129
curr_Factors:  [101.14301408]
mat_Sqrt:  [[0.15]]
grads:  [-0.04409907]
Stock Position:  -0.044099068988423126
Bond Position:  [10.48825288]


portfolio before change:  [6.04825151]
curr_Stock_Price:  100.71215986748076
curr_Factors:  [100.71215987]
mat_Sqrt:  [[0.15]]
grads:  [0.04289695]
Stock Position:  0.04289695240257079
Bond Position:  [1.72800678]


portfolio before change:  [6.05106147]
curr_Stock_Price:  100.77262894925221
curr_Factors:  [100.77262895]
mat_Sqrt:  [[0.15]]
grads:  [0.10542474]
Stock Position:  0.1054247351571275
Bond Position:  [-4.57286625]


portfolio before change:  [6.09552846]
curr_Stock_Price:  101.19984021125654
curr_Factors:  [101.19984021]
mat_Sqrt:  [[0.15]]
grads:  [0.18721209]
Stock Position:  0.1872120854120133
Bond Position:  [-12.85030467]


portfolio before change:  [5.96780737]
curr_Stock_Price:  100.5261940611427
curr_Factors:  [100.52619406]
mat_Sqrt:  [[0.15]]
grads:  [0.17734989]
Stock Position:  0.17734988564941814
Bond Position:  [-11.86050165]


portfolio before change:  [6.19155486]
curr_Stock_Price:  101.79617031921966
curr_Factors:  [101.79617032]
mat_Sqrt:  [[0.15]]
grads:  [-0.00146966]
Stock Position:  -0.0014696615237845597
Bond Position:  [6.34116077]


portfolio before change:  [6.1926136]
curr_Stock_Price:  101.61514478953534
curr_Factors:  [101.61514479]
mat_Sqrt:  [[0.15]]
grads:  [0.03487981]
Stock Position:  0.03487981033490325
Bond Position:  [2.64829662]


portfolio before change:  [6.21810688]
curr_Stock_Price:  102.33654282966803
curr_Factors:  [102.33654283]
mat_Sqrt:  [[0.15]]
grads:  [0.0797118]
Stock Position:  0.07971179538409824
Bond Position:  [-1.93932268]


portfolio before change:  [6.15331696]
curr_Stock_Price:  101.52678197298566
curr_Factors:  [101.52678197]
mat_Sqrt:  [[0.15]]
grads:  [0.16626719]
Stock Position:  0.1662671920720291
Bond Position:  [-10.727256]


portfolio before change:  [6.04639996]
curr_Stock_Price:  100.89180396273764
curr_Factors:  [100.89180396]
mat_Sqrt:  [[0.15]]
grads:  [0.06932661]
Stock Position:  0.06932660923203833
Bond Position:  [-0.94808671]


portfolio before change:  [6.10903911]
curr_Stock_Price:  101.79705050312295
curr_Factors:  [101.7970505]
mat_Sqrt:  [[0.15]]
grads:  [-0.07683337]
Stock Position:  -0.07683337490250931
Bond Position:  [13.93045006]


portfolio before change:  [6.02402389]
curr_Stock_Price:  102.92620354358927
curr_Factors:  [102.92620354]
mat_Sqrt:  [[0.15]]
grads:  [0.0567285]
Stock Position:  0.05672850125665606
Bond Position:  [0.18517462]


portfolio before change:  [5.97489898]
curr_Stock_Price:  102.05983020227526
curr_Factors:  [102.0598302]
mat_Sqrt:  [[0.15]]
grads:  [-0.03155845]
Stock Position:  -0.03155844925607559
Bond Position:  [9.19574895]


portfolio before change:  [5.94043162]
curr_Stock_Price:  103.18843118438933
curr_Factors:  [103.18843118]
mat_Sqrt:  [[0.15]]
grads:  [-0.18439733]
Stock Position:  -0.1843973272068723
Bond Position:  [24.96810253]


portfolio before change:  [6.04275074]
curr_Stock_Price:  102.65047374738438
curr_Factors:  [102.65047375]
mat_Sqrt:  [[0.15]]
grads:  [0.02973657]
Stock Position:  0.029736568190464552
Bond Position:  [2.99027793]


portfolio before change:  [6.04421477]
curr_Stock_Price:  102.68713623047441
curr_Factors:  [102.68713623]
mat_Sqrt:  [[0.15]]
grads:  [-0.00093285]
Stock Position:  -0.0009328479174466127
Bond Position:  [6.14000625]


portfolio before change:  [6.04369224]
curr_Stock_Price:  104.07007265631151
curr_Factors:  [104.07007266]
mat_Sqrt:  [[0.15]]
grads:  [0.02646888]
Stock Position:  0.026468881626535747
Bond Position:  [3.28907381]


portfolio before change:  [6.03277983]
curr_Stock_Price:  103.64226548737584
curr_Factors:  [103.64226549]
mat_Sqrt:  [[0.15]]
grads:  [-0.02066194]
Stock Position:  -0.020661936366681486
Bond Position:  [8.17422972]


portfolio before change:  [6.0293195]
curr_Stock_Price:  103.85919420214182
curr_Factors:  [103.8591942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01052079]
Stock Position:  -0.010520788856062148
Bond Position:  [7.12200016]


portfolio before change:  [6.02478232]
curr_Stock_Price:  104.37507623340275
curr_Factors:  [104.37507623]
mat_Sqrt:  [[0.15]]
grads:  [-0.26408737]
Stock Position:  -0.2640873740172879
Bond Position:  [33.58892212]


portfolio before change:  [5.84718746]
curr_Stock_Price:  105.06346104073965
curr_Factors:  [105.06346104]
mat_Sqrt:  [[0.15]]
grads:  [0.03216135]
Stock Position:  0.032161351316910794
Bond Position:  [2.46820458]


portfolio before change:  [5.88681782]
curr_Stock_Price:  106.28610279481886
curr_Factors:  [106.28610279]
mat_Sqrt:  [[0.15]]
grads:  [0.08163422]
Stock Position:  0.08163422298499956
Bond Position:  [-2.7897656]


portfolio before change:  [5.78338048]
curr_Stock_Price:  105.0232918098234
curr_Factors:  [105.02329181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719493]
Stock Position:  -0.03719493131884694
Bond Position:  [9.68971461]


portfolio before change:  [5.80400476]
curr_Stock_Price:  104.50136610000825
curr_Factors:  [104.5013661]
mat_Sqrt:  [[0.15]]
grads:  [0.02516469]
Stock Position:  0.025164693638731868
Bond Position:  [3.1742599]


portfolio before change:  [5.78675407]
curr_Stock_Price:  103.80008603410232
curr_Factors:  [103.80008603]
mat_Sqrt:  [[0.15]]
grads:  [-0.03321715]
Stock Position:  -0.03321714627289342
Bond Position:  [9.23469671]


portfolio before change:  [5.76479798]
curr_Stock_Price:  104.49582614618994
curr_Factors:  [104.49582615]
mat_Sqrt:  [[0.15]]
grads:  [-0.00142064]
Stock Position:  -0.0014206351627661768
Bond Position:  [5.91324843]


portfolio before change:  [5.76473301]
curr_Stock_Price:  105.06188972447241
curr_Factors:  [105.06188972]
mat_Sqrt:  [[0.15]]
grads:  [0.25857946]
Stock Position:  0.25857945530988435
Bond Position:  [-21.4021132]


portfolio before change:  [5.76473697]
curr_Stock_Price:  105.07225166288478
curr_Factors:  [105.07225166]
mat_Sqrt:  [[0.15]]
grads:  [0.17252062]
Stock Position:  0.17252062062202048
Bond Position:  [-12.3623931]


portfolio before change:  [5.77050027]
curr_Stock_Price:  105.11461588989977
curr_Factors:  [105.11461589]
mat_Sqrt:  [[0.15]]
grads:  [-0.1384678]
Stock Position:  -0.13846780412808404
Bond Position:  [20.32549032]


portfolio before change:  [5.86450372]
curr_Stock_Price:  104.45408254261345
curr_Factors:  [104.45408254]
mat_Sqrt:  [[0.15]]
grads:  [0.04100512]
Stock Position:  0.04100511989375096
Bond Position:  [1.58135154]


portfolio before change:  [5.89162847]
curr_Stock_Price:  105.11075831137714
curr_Factors:  [105.11075831]
mat_Sqrt:  [[0.15]]
grads:  [-0.08713608]
Stock Position:  -0.08713608499891609
Bond Position:  [15.05056844]


portfolio before change:  [5.89525541]
curr_Stock_Price:  105.09072637870125
curr_Factors:  [105.09072638]
mat_Sqrt:  [[0.15]]
grads:  [0.01443434]
Stock Position:  0.014434343965144375
Bond Position:  [4.37833972]


portfolio before change:  [5.89529698]
curr_Stock_Price:  105.05568729851186
curr_Factors:  [105.0556873]
mat_Sqrt:  [[0.15]]
grads:  [-0.04184532]
Stock Position:  -0.04184531686335474
Bond Position:  [10.2913855]


portfolio before change:  [5.83118627]
curr_Stock_Price:  106.61851958887863
curr_Factors:  [106.61851959]
mat_Sqrt:  [[0.15]]
grads:  [0.03063033]
Stock Position:  0.030630332810508837
Bond Position:  [2.56542553]


portfolio before change:  [5.87146759]
curr_Stock_Price:  107.92312927815358
curr_Factors:  [107.92312928]
mat_Sqrt:  [[0.15]]
grads:  [0.16552663]
Stock Position:  0.16552663114670976
Bond Position:  [-11.99268442]


portfolio before change:  [6.03541736]
curr_Stock_Price:  108.92265993519504
curr_Factors:  [108.92265994]
mat_Sqrt:  [[0.15]]
grads:  [0.07642456]
Stock Position:  0.07642456126888605
Bond Position:  [-2.28894914]


portfolio before change:  [6.01400706]
curr_Stock_Price:  108.64625455712508
curr_Factors:  [108.64625456]
mat_Sqrt:  [[0.15]]
grads:  [0.1199595]
Stock Position:  0.11995950209507318
Bond Position:  [-7.01914354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.01400706]
Stock Price:  109.78454232439216
PL:  [-3.77053526]
Settle:  Tensor("sub_226:0", shape=(), dtype=float64)
PL:  Tensor("sub_227:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  114
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.82141387e-03]
 [-3.47749311e-04]
 [-3.16477426e-02]
 [-2.93334979e-02]
 [-9.21143993e-03]
 [ 2.38357516e-02]
 [ 3.59980477e-03]
 [-5.19904095e-03]
 [ 1.64215123e-02]
 [-4.76477676e-04]
 [ 1.16864022e-02]
 [ 3.23549576e-03]
 [ 2.57773718e-03]
 [ 1.03748717e-02]
 [-1.08855445e-03]
 [-1.28174818e-02]
 [-7.19540047e-03]
 [-5.41447297e-04]
 [-7.62483184e-03]
 [-2.53858919e-03]
 [ 6.03758559e-04]
 [ 8.83508627e-03]
 [ 4.76696703e-03]
 [ 6.01961139e-03]
 [-4.68500169e-03]
 [-7.41776278e-03]
 [ 1.38416092e-02]
 [-1.99955110e-02]
 [-3.33110597e-02]
 [ 2.16502866e-02]
 [ 6.78884590e-03]
 [-3.35785814e-03]
 [-1.25334918e-02]
 [-6.54008025e-03]
 [-6.52019420e-03]
 [-7.50282385e-03]
 [ 2.27737404e-02]
 [ 7.07648451e-03]
 [ 2.32462716e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.0204549]
curr_Stock_Price:  99.48717441401278
curr_Factors:  [99.48717441]
mat_Sqrt:  [[0.15]]
grads:  [-0.02547609]
Stock Position:  -0.025476092466071312
Bond Position:  [-3.48591045]


portfolio before change:  [-6.01135488]
curr_Stock_Price:  99.1128710239564
curr_Factors:  [99.11287102]
mat_Sqrt:  [[0.15]]
grads:  [-0.00231833]
Stock Position:  -0.002318328737124526
Bond Position:  [-5.78157866]


portfolio before change:  [-6.01000404]
curr_Stock_Price:  98.21844023892554
curr_Factors:  [98.21844024]
mat_Sqrt:  [[0.15]]
grads:  [-0.21098495]
Stock Position:  -0.21098495077978535
Bond Position:  [14.71260874]


portfolio before change:  [-5.85800892]
curr_Stock_Price:  97.50675004365664
curr_Factors:  [97.50675004]
mat_Sqrt:  [[0.15]]
grads:  [-0.19555665]
Stock Position:  -0.1955566527714165
Bond Position:  [13.21008474]


portfolio before change:  [-5.69976896]
curr_Stock_Price:  96.70601738552509
curr_Factors:  [96.70601739]
mat_Sqrt:  [[0.15]]
grads:  [-0.0614096]
Stock Position:  -0.06140959951903323
Bond Position:  [0.23890884]


portfolio before change:  [-5.77037663]
curr_Stock_Price:  97.85628590663548
curr_Factors:  [97.85628591]
mat_Sqrt:  [[0.15]]
grads:  [0.15890501]
Stock Position:  0.1589050104174637
Bond Position:  [-21.32023076]


portfolio before change:  [-5.83618131]
curr_Stock_Price:  97.45894484735915
curr_Factors:  [97.45894485]
mat_Sqrt:  [[0.15]]
grads:  [0.0239987]
Stock Position:  0.023998698436614868
Bond Position:  [-8.17506913]


portfolio before change:  [-5.82143867]
curr_Stock_Price:  98.11583809822886
curr_Factors:  [98.1158381]
mat_Sqrt:  [[0.15]]
grads:  [-0.03466027]
Stock Position:  -0.03466027300579815
Bond Position:  [-2.42071694]


portfolio before change:  [-5.84748051]
curr_Stock_Price:  98.858453012859
curr_Factors:  [98.85845301]
mat_Sqrt:  [[0.15]]
grads:  [0.10947675]
Stock Position:  0.10947674849600338
Bond Position:  [-16.67018251]


portfolio before change:  [-5.90182768]
curr_Stock_Price:  98.38106153301335
curr_Factors:  [98.38106153]
mat_Sqrt:  [[0.15]]
grads:  [-0.00317652]
Stock Position:  -0.003176517838819609
Bond Position:  [-5.58931849]


portfolio before change:  [-5.90262899]
curr_Stock_Price:  98.41335909941756
curr_Factors:  [98.4133591]
mat_Sqrt:  [[0.15]]
grads:  [0.07790935]
Stock Position:  0.07790934794266155
Bond Position:  [-13.56994962]


portfolio before change:  [-5.8712781]
curr_Stock_Price:  98.83753460340095
curr_Factors:  [98.8375346]
mat_Sqrt:  [[0.15]]
grads:  [0.02156997]
Stock Position:  0.02156997170468657
Bond Position:  [-8.00320092]


portfolio before change:  [-5.8771164]
curr_Stock_Price:  98.61324878453642
curr_Factors:  [98.61324878]
mat_Sqrt:  [[0.15]]
grads:  [0.01718491]
Stock Position:  0.017184914540098968
Bond Position:  [-7.57177665]


portfolio before change:  [-5.88612235]
curr_Stock_Price:  98.14426638837566
curr_Factors:  [98.14426639]
mat_Sqrt:  [[0.15]]
grads:  [0.06916581]
Stock Position:  0.06916581149964124
Bond Position:  [-12.67435018]


portfolio before change:  [-5.86778992]
curr_Stock_Price:  98.43222408199176
curr_Factors:  [98.43222408]
mat_Sqrt:  [[0.15]]
grads:  [-0.00725703]
Stock Position:  -0.007257029697714605
Bond Position:  [-5.15346435]


portfolio before change:  [-5.86198331]
curr_Stock_Price:  97.54331522202132
curr_Factors:  [97.54331522]
mat_Sqrt:  [[0.15]]
grads:  [-0.08544988]
Stock Position:  -0.08544987858453107
Bond Position:  [2.47308114]


portfolio before change:  [-5.82820036]
curr_Stock_Price:  97.15157923158591
curr_Factors:  [97.15157923]
mat_Sqrt:  [[0.15]]
grads:  [-0.04796934]
Stock Position:  -0.04796933645516198
Bond Position:  [-1.16790357]


portfolio before change:  [-5.84301192]
curr_Stock_Price:  97.45730712345365
curr_Factors:  [97.45730712]
mat_Sqrt:  [[0.15]]
grads:  [-0.00360965]
Stock Position:  -0.0036096486497045792
Bond Position:  [-5.49122528]


portfolio before change:  [-5.8411153]
curr_Stock_Price:  96.74170609955328
curr_Factors:  [96.7417061]
mat_Sqrt:  [[0.15]]
grads:  [-0.05083221]
Stock Position:  -0.05083221229629398
Bond Position:  [-0.92352035]


portfolio before change:  [-5.84758294]
curr_Stock_Price:  96.86667003676695
curr_Factors:  [96.86667004]
mat_Sqrt:  [[0.15]]
grads:  [-0.01692393]
Stock Position:  -0.016923927957579184
Bond Position:  [-4.20821839]


portfolio before change:  [-5.84768433]
curr_Stock_Price:  96.84157744559036
curr_Factors:  [96.84157745]
mat_Sqrt:  [[0.15]]
grads:  [0.00402506]
Stock Position:  0.0040250570604214
Bond Position:  [-6.23747721]


portfolio before change:  [-5.84403341]
curr_Stock_Price:  97.94234485550328
curr_Factors:  [97.94234486]
mat_Sqrt:  [[0.15]]
grads:  [0.05890058]
Stock Position:  0.05890057515933453
Bond Position:  [-11.61289386]


portfolio before change:  [-5.8021186]
curr_Stock_Price:  98.67861133952898
curr_Factors:  [98.67861134]
mat_Sqrt:  [[0.15]]
grads:  [0.03177978]
Stock Position:  0.031779780189652884
Bond Position:  [-8.93810318]


portfolio before change:  [-5.78349284]
curr_Stock_Price:  99.29985838050649
curr_Factors:  [99.29985838]
mat_Sqrt:  [[0.15]]
grads:  [0.04013074]
Stock Position:  0.04013074262394816
Bond Position:  [-9.7684699]


portfolio before change:  [-5.74650628]
curr_Stock_Price:  100.25193874226365
curr_Factors:  [100.25193874]
mat_Sqrt:  [[0.15]]
grads:  [-0.03123334]
Stock Position:  -0.031233344624023194
Bond Position:  [-2.61530293]


portfolio before change:  [-5.71217803]
curr_Stock_Price:  99.14238166119354
curr_Factors:  [99.14238166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04945175]
Stock Position:  -0.04945175188315735
Bond Position:  [-0.80941357]


portfolio before change:  [-5.75819051]
curr_Stock_Price:  100.0707875325463
curr_Factors:  [100.07078753]
mat_Sqrt:  [[0.15]]
grads:  [0.09227739]
Stock Position:  0.09227739434928713
Bond Position:  [-14.99246204]


portfolio before change:  [-5.732941]
curr_Stock_Price:  100.36472393027339
curr_Factors:  [100.36472393]
mat_Sqrt:  [[0.15]]
grads:  [-0.13330341]
Stock Position:  -0.13330340682922256
Bond Position:  [7.64601862]


portfolio before change:  [-5.60918759]
curr_Stock_Price:  99.44353514047745
curr_Factors:  [99.44353514]
mat_Sqrt:  [[0.15]]
grads:  [-0.22207373]
Stock Position:  -0.22207373152287307
Bond Position:  [16.47460934]


portfolio before change:  [-5.57442516]
curr_Stock_Price:  99.29627334894886
curr_Factors:  [99.29627335]
mat_Sqrt:  [[0.15]]
grads:  [0.14433524]
Stock Position:  0.1443352436980026
Bond Position:  [-19.90637697]


portfolio before change:  [-5.64152015]
curr_Stock_Price:  98.84865886785616
curr_Factors:  [98.84865887]
mat_Sqrt:  [[0.15]]
grads:  [0.04525897]
Stock Position:  0.04525897263963723
Bond Position:  [-10.1153089]


portfolio before change:  [-5.68196347]
curr_Stock_Price:  97.98300014178601
curr_Factors:  [97.98300014]
mat_Sqrt:  [[0.15]]
grads:  [-0.02238572]
Stock Position:  -0.022385720950288537
Bond Position:  [-3.48854337]


portfolio before change:  [-5.68953954]
curr_Stock_Price:  98.30195235421489
curr_Factors:  [98.30195235]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355661]
Stock Position:  -0.08355661170630257
Bond Position:  [2.52423852]


portfolio before change:  [-5.7942009]
curr_Stock_Price:  99.55830901246867
curr_Factors:  [99.55830901]
mat_Sqrt:  [[0.15]]
grads:  [-0.04360053]
Stock Position:  -0.04360053498431208
Bond Position:  [-1.45340536]


portfolio before change:  [-5.82348696]
curr_Stock_Price:  100.22583246131543
curr_Factors:  [100.22583246]
mat_Sqrt:  [[0.15]]
grads:  [-0.04346796]
Stock Position:  -0.043467961300219876
Bond Position:  [-1.46687436]


portfolio before change:  [-5.78306872]
curr_Stock_Price:  99.29177402460948
curr_Factors:  [99.29177402]
mat_Sqrt:  [[0.15]]
grads:  [-0.05001883]
Stock Position:  -0.050018825656934426
Bond Position:  [-0.81661079]


portfolio before change:  [-5.84690091]
curr_Stock_Price:  100.56589651035266
curr_Factors:  [100.56589651]
mat_Sqrt:  [[0.15]]
grads:  [0.15182494]
Stock Position:  0.1518249361392459
Bond Position:  [-21.11531173]


portfolio before change:  [-5.89708559]
curr_Stock_Price:  100.25273911036086
curr_Factors:  [100.25273911]
mat_Sqrt:  [[0.15]]
grads:  [0.04717656]
Stock Position:  0.047176563375329536
Bond Position:  [-10.62666529]


portfolio before change:  [-5.96684484]
curr_Stock_Price:  98.80221320375861
curr_Factors:  [98.8022132]
mat_Sqrt:  [[0.15]]
grads:  [0.15497514]
Stock Position:  0.1549751442405851
Bond Position:  [-21.27873208]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.96684484]
Stock Price:  98.06506392365917
PL:  [-5.96684484]
Settle:  Tensor("sub_228:0", shape=(), dtype=float64)
PL:  Tensor("sub_229:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  115
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.22305556e-03]
 [-1.19265972e-03]
 [ 1.22000963e-02]
 [-1.61507269e-03]
 [ 5.81156484e-03]
 [ 1.69078376e-02]
 [ 1.72787391e-02]
 [-4.42253673e-03]
 [ 2.17517025e-04]
 [ 2.93042103e-03]
 [-9.12972131e-02]
 [-3.00204992e-02]
 [ 1.67369824e-02]
 [-5.71931089e-04]
 [ 2.22862386e-02]
 [-8.47969933e-04]
 [-1.39460080e-02]
 [ 6.94759593e-04]
 [-7.80955008e-03]
 [-3.04707311e-03]
 [ 1.24852239e-03]
 [-8.07838047e-03]
 [ 4.75501119e-03]
 [ 5.49701206e-03]
 [ 4.11194895e-04]
 [-3.51480910e-03]
 [-2.49549166e-03]
 [-1.85673416e-02]
 [-2.66047927e-02]
 [ 2.18051435e-02]
 [ 2.79510673e-03]
 [-6.91199098e-03]
 [-1.25335163e-02]
 [-1.02199297e-02]
 [-6.95337316e-03]
 [-5.48691703e-03]
 [ 1.87985003e-02]
 [ 1.04942498e-02]
 [ 2.02257953e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-6.93024295]
curr_Stock_Price:  99.4285639841275
curr_Factors:  [99.42856398]
mat_Sqrt:  [[0.15]]
grads:  [-0.0281537]
Stock Position:  -0.0281537037486888
Bond Position:  [-4.13096061]


portfolio before change:  [-6.92041869]
curr_Stock_Price:  99.06127075445814
curr_Factors:  [99.06127075]
mat_Sqrt:  [[0.15]]
grads:  [-0.00795106]
Stock Position:  -0.007951064796385538
Bond Position:  [-6.1327761]


portfolio before change:  [-6.93328198]
curr_Stock_Price:  100.58265844116764
curr_Factors:  [100.58265844]
mat_Sqrt:  [[0.15]]
grads:  [0.08133398]
Stock Position:  0.08133397510473558
Bond Position:  [-15.11406942]


portfolio before change:  [-6.96176376]
curr_Stock_Price:  100.25570525510001
curr_Factors:  [100.25570526]
mat_Sqrt:  [[0.15]]
grads:  [-0.01076715]
Stock Position:  -0.010767151273922936
Bond Position:  [-5.88229542]


portfolio before change:  [-6.96148266]
curr_Stock_Price:  100.16130417857876
curr_Factors:  [100.16130418]
mat_Sqrt:  [[0.15]]
grads:  [0.03874377]
Stock Position:  0.03874376562961888
Bond Position:  [-10.84210876]


portfolio before change:  [-6.98809869]
curr_Stock_Price:  99.50931074373992
curr_Factors:  [99.50931074]
mat_Sqrt:  [[0.15]]
grads:  [0.11271892]
Stock Position:  0.1127189171468108
Bond Position:  [-18.20468045]


portfolio before change:  [-7.06395241]
curr_Stock_Price:  98.8565543894894
curr_Factors:  [98.85655439]
mat_Sqrt:  [[0.15]]
grads:  [0.11519159]
Stock Position:  0.1151915941541871
Bond Position:  [-18.4513965]


portfolio before change:  [-7.13027121]
curr_Stock_Price:  98.30085211206642
curr_Factors:  [98.30085211]
mat_Sqrt:  [[0.15]]
grads:  [-0.02948358]
Stock Position:  -0.02948357822081374
Bond Position:  [-4.23201035]


portfolio before change:  [-7.08202122]
curr_Stock_Price:  96.64640495932869
curr_Factors:  [96.64640496]
mat_Sqrt:  [[0.15]]
grads:  [0.00145011]
Stock Position:  0.0014501135009087746
Bond Position:  [-7.22216948]


portfolio before change:  [-7.08374452]
curr_Stock_Price:  96.08060962667238
curr_Factors:  [96.08060963]
mat_Sqrt:  [[0.15]]
grads:  [0.01953614]
Stock Position:  0.019536140204738043
Bond Position:  [-8.96078878]


portfolio before change:  [-7.09137976]
curr_Stock_Price:  95.74712127903445
curr_Factors:  [95.74712128]
mat_Sqrt:  [[0.15]]
grads:  [-0.60864809]
Stock Position:  -0.6086480871525348
Bond Position:  [51.18492246]


portfolio before change:  [-6.220341]
curr_Stock_Price:  94.32652986419193
curr_Factors:  [94.32652986]
mat_Sqrt:  [[0.15]]
grads:  [-0.20013666]
Stock Position:  -0.20013666110664233
Bond Position:  [12.65785574]


portfolio before change:  [-6.21677245]
curr_Stock_Price:  94.31660555020567
curr_Factors:  [94.31660555]
mat_Sqrt:  [[0.15]]
grads:  [0.11157988]
Stock Position:  0.11157988260355425
Bond Position:  [-16.74060822]


portfolio before change:  [-6.16299244]
curr_Stock_Price:  94.81734738771942
curr_Factors:  [94.81734739]
mat_Sqrt:  [[0.15]]
grads:  [-0.00381287]
Stock Position:  -0.003812873925762318
Bond Position:  [-5.80146585]


portfolio before change:  [-6.16214016]
curr_Stock_Price:  94.40361555168349
curr_Factors:  [94.40361555]
mat_Sqrt:  [[0.15]]
grads:  [0.14857492]
Stock Position:  0.14857492427475885
Bond Position:  [-20.18815019]


portfolio before change:  [-6.29424894]
curr_Stock_Price:  93.53142862642925
curr_Factors:  [93.53142863]
mat_Sqrt:  [[0.15]]
grads:  [-0.00565313]
Stock Position:  -0.005653132888562366
Bond Position:  [-5.76550335]


portfolio before change:  [-6.29485446]
curr_Stock_Price:  93.5110470072796
curr_Factors:  [93.51104701]
mat_Sqrt:  [[0.15]]
grads:  [-0.09297339]
Stock Position:  -0.09297338693482238
Bond Position:  [2.3991843]


portfolio before change:  [-6.33290346]
curr_Stock_Price:  93.92351896253744
curr_Factors:  [93.92351896]
mat_Sqrt:  [[0.15]]
grads:  [0.00463173]
Stock Position:  0.004631730623279537
Bond Position:  [-6.76793189]


portfolio before change:  [-6.33553238]
curr_Stock_Price:  93.538590531842
curr_Factors:  [93.53859053]
mat_Sqrt:  [[0.15]]
grads:  [-0.05206367]
Stock Position:  -0.052063667176764285
Bond Position:  [-1.46557034]


portfolio before change:  [-6.34838876]
curr_Stock_Price:  93.78200725021127
curr_Factors:  [93.78200725]
mat_Sqrt:  [[0.15]]
grads:  [-0.02031382]
Stock Position:  -0.020313820764123552
Bond Position:  [-4.44331787]


portfolio before change:  [-6.3530205]
curr_Stock_Price:  93.98267304702924
curr_Factors:  [93.98267305]
mat_Sqrt:  [[0.15]]
grads:  [0.00832348]
Stock Position:  0.008323482616331548
Bond Position:  [-7.13528364]


portfolio before change:  [-6.36241322]
curr_Stock_Price:  92.96137546844415
curr_Factors:  [92.96137547]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385587]
Stock Position:  -0.05385586980724069
Bond Position:  [-1.35589748]


portfolio before change:  [-6.44135347]
curr_Stock_Price:  94.4239970463012
curr_Factors:  [94.42399705]
mat_Sqrt:  [[0.15]]
grads:  [0.03170007]
Stock Position:  0.031700074571751655
Bond Position:  [-9.43460122]


portfolio before change:  [-6.41937637]
curr_Stock_Price:  95.15448441323875
curr_Factors:  [95.15448441]
mat_Sqrt:  [[0.15]]
grads:  [0.03664675]
Stock Position:  0.0366467470443609
Bond Position:  [-9.90647869]


portfolio before change:  [-6.3851629]
curr_Stock_Price:  96.12187857445404
curr_Factors:  [96.12187857]
mat_Sqrt:  [[0.15]]
grads:  [0.0027413]
Stock Position:  0.0027412993005266712
Bond Position:  [-6.64866174]


portfolio before change:  [-6.38541314]
curr_Stock_Price:  96.33378667153266
curr_Factors:  [96.33378667]
mat_Sqrt:  [[0.15]]
grads:  [-0.02343206]
Stock Position:  -0.023432060699366816
Bond Position:  [-4.128114]


portfolio before change:  [-6.38785953]
curr_Stock_Price:  96.41616735139284
curr_Factors:  [96.41616735]
mat_Sqrt:  [[0.15]]
grads:  [-0.01663661]
Stock Position:  -0.016636611072522487
Bond Position:  [-4.78382125]


portfolio before change:  [-6.38593203]
curr_Stock_Price:  96.26436264838581
curr_Factors:  [96.26436265]
mat_Sqrt:  [[0.15]]
grads:  [-0.12378228]
Stock Position:  -0.12378227713718243
Bond Position:  [5.52988999]


portfolio before change:  [-6.2711475]
curr_Stock_Price:  95.3426373549761
curr_Factors:  [95.34263735]
mat_Sqrt:  [[0.15]]
grads:  [-0.17736528]
Stock Position:  -0.1773652846296198
Bond Position:  [10.63932652]


portfolio before change:  [-6.32202861]
curr_Stock_Price:  95.63700790285574
curr_Factors:  [95.6370079]
mat_Sqrt:  [[0.15]]
grads:  [0.14536762]
Stock Position:  0.14536762304831116
Bond Position:  [-20.22455313]


portfolio before change:  [-6.18865023]
curr_Stock_Price:  96.57192453848229
curr_Factors:  [96.57192454]
mat_Sqrt:  [[0.15]]
grads:  [0.01863404]
Stock Position:  0.018634044871877302
Bond Position:  [-7.98817581]


portfolio before change:  [-6.19675406]
curr_Stock_Price:  96.19061988361808
curr_Factors:  [96.19061988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04607994]
Stock Position:  -0.04607993985997328
Bond Position:  [-1.76429608]


portfolio before change:  [-6.24965137]
curr_Stock_Price:  97.33378021370409
curr_Factors:  [97.33378021]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355678]
Stock Position:  -0.08355677523215777
Bond Position:  [1.88324542]


portfolio before change:  [-6.20910244]
curr_Stock_Price:  96.85131175907391
curr_Factors:  [96.85131176]
mat_Sqrt:  [[0.15]]
grads:  [-0.06813286]
Stock Position:  -0.06813286443659367
Bond Position:  [0.38965485]


portfolio before change:  [-6.20179616]
curr_Stock_Price:  96.74479081416754
curr_Factors:  [96.74479081]
mat_Sqrt:  [[0.15]]
grads:  [-0.04635582]
Stock Position:  -0.046355821060647714
Bond Position:  [-1.71711195]


portfolio before change:  [-6.17859841]
curr_Stock_Price:  96.23973235870871
curr_Factors:  [96.23973236]
mat_Sqrt:  [[0.15]]
grads:  [-0.03657945]
Stock Position:  -0.03657944683934733
Bond Position:  [-2.65820224]


portfolio before change:  [-6.13279073]
curr_Stock_Price:  94.97836906520014
curr_Factors:  [94.97836907]
mat_Sqrt:  [[0.15]]
grads:  [0.12532334]
Stock Position:  0.12532333533732126
Bond Position:  [-18.03579673]


portfolio before change:  [-6.15679114]
curr_Stock_Price:  94.80485154425378
curr_Factors:  [94.80485154]
mat_Sqrt:  [[0.15]]
grads:  [0.06996167]
Stock Position:  0.06996166523860921
Bond Position:  [-12.78949643]


portfolio before change:  [-6.09759052]
curr_Stock_Price:  95.67389044873043
curr_Factors:  [95.67389045]
mat_Sqrt:  [[0.15]]
grads:  [0.13483864]
Stock Position:  0.13483863516930772
Bond Position:  [-18.99812733]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.09759052]
Stock Price:  97.8355993901867
PL:  [-6.09759052]
Settle:  Tensor("sub_230:0", shape=(), dtype=float64)
PL:  Tensor("sub_231:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  116
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.49819067e-03]
 [-5.34838223e-03]
 [-2.14000140e-02]
 [-6.44356695e-03]
 [ 1.35204701e-02]
 [ 1.96241591e-02]
 [ 1.87710753e-02]
 [-4.16415210e-03]
 [ 1.62404413e-02]
 [-2.92987978e-04]
 [ 1.21904731e-02]
 [ 9.24242895e-03]
 [-2.80916657e-03]
 [ 1.07063398e-02]
 [-4.16843104e-03]
 [-9.27280970e-03]
 [-2.08748891e-03]
 [-3.11937813e-03]
 [-8.25426268e-03]
 [-2.39429487e-03]
 [ 3.16033882e-04]
 [ 1.13863256e-02]
 [ 4.75844148e-03]
 [ 5.56759630e-03]
 [-9.47761288e-05]
 [-3.85941919e-03]
 [-1.69370858e-03]
 [-2.03118113e-02]
 [-3.64218037e-02]
 [ 2.16919344e-02]
 [ 6.00440237e-03]
 [-2.74590112e-03]
 [-1.24977547e-02]
 [-7.09499952e-03]
 [-6.13128048e-03]
 [-7.45451993e-03]
 [ 2.27965390e-02]
 [ 7.84581975e-03]
 [ 2.34514123e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.87844767]
curr_Stock_Price:  98.91652417846608
curr_Factors:  [98.91652418]
mat_Sqrt:  [[0.15]]
grads:  [-0.0366546]
Stock Position:  -0.036654604479035846
Bond Position:  [-11.2527016]


portfolio before change:  [-14.86702971]
curr_Stock_Price:  98.56664617571109
curr_Factors:  [98.56664618]
mat_Sqrt:  [[0.15]]
grads:  [-0.03565588]
Stock Position:  -0.03565588153030674
Bond Position:  [-11.35254905]


portfolio before change:  [-14.87401235]
curr_Stock_Price:  98.72267895117683
curr_Factors:  [98.72267895]
mat_Sqrt:  [[0.15]]
grads:  [-0.14266676]
Stock Position:  -0.14266676003229503
Bond Position:  [-0.7895676]


portfolio before change:  [-15.00750455]
curr_Stock_Price:  99.65767950899232
curr_Factors:  [99.65767951]
mat_Sqrt:  [[0.15]]
grads:  [-0.04295711]
Stock Position:  -0.042957112988078985
Bond Position:  [-10.72649835]


portfolio before change:  [-14.9918471]
curr_Stock_Price:  99.26197433047827
curr_Factors:  [99.26197433]
mat_Sqrt:  [[0.15]]
grads:  [0.09013647]
Stock Position:  0.09013646754542207
Bond Position:  [-23.93897083]


portfolio before change:  [-15.01023377]
curr_Stock_Price:  99.0911875405436
curr_Factors:  [99.09118754]
mat_Sqrt:  [[0.15]]
grads:  [0.13082773]
Stock Position:  0.1308277271134838
Bond Position:  [-27.97410862]


portfolio before change:  [-15.02757903]
curr_Stock_Price:  98.98533634176982
curr_Factors:  [98.98533634]
mat_Sqrt:  [[0.15]]
grads:  [0.1251405]
Stock Position:  0.1251405019555836
Bond Position:  [-27.4146537]


portfolio before change:  [-15.10895861]
curr_Stock_Price:  98.36241620542786
curr_Factors:  [98.36241621]
mat_Sqrt:  [[0.15]]
grads:  [-0.02776101]
Stock Position:  -0.027761013997509836
Bond Position:  [-12.3783182]


portfolio before change:  [-15.12348882]
curr_Stock_Price:  98.83008006372651
curr_Factors:  [98.83008006]
mat_Sqrt:  [[0.15]]
grads:  [0.10826961]
Stock Position:  0.10826960837494046
Bond Position:  [-25.82378289]


portfolio before change:  [-15.19106695]
curr_Stock_Price:  98.23573083299478
curr_Factors:  [98.23573083]
mat_Sqrt:  [[0.15]]
grads:  [-0.00195325]
Stock Position:  -0.001953253189598044
Bond Position:  [-14.9991877]


portfolio before change:  [-15.1941768]
curr_Stock_Price:  98.86792455331751
curr_Factors:  [98.86792455]
mat_Sqrt:  [[0.15]]
grads:  [0.08126982]
Stock Position:  0.08126982063458792
Bond Position:  [-23.2291553]


portfolio before change:  [-15.14578917]
curr_Stock_Price:  99.4990501592062
curr_Factors:  [99.49905016]
mat_Sqrt:  [[0.15]]
grads:  [0.06161619]
Stock Position:  0.06161619300281407
Bond Position:  [-21.27654184]


portfolio before change:  [-15.17643492]
curr_Stock_Price:  99.0448510692006
curr_Factors:  [99.04485107]
mat_Sqrt:  [[0.15]]
grads:  [-0.01872778]
Stock Position:  -0.018727777108194257
Bond Position:  [-13.32154502]


portfolio before change:  [-15.16906238]
curr_Stock_Price:  98.56226128340761
curr_Factors:  [98.56226128]
mat_Sqrt:  [[0.15]]
grads:  [0.0713756]
Stock Position:  0.07137559871066126
Bond Position:  [-22.20400279]


portfolio before change:  [-15.10716919]
curr_Stock_Price:  99.46829740238671
curr_Factors:  [99.4682974]
mat_Sqrt:  [[0.15]]
grads:  [-0.02778954]
Stock Position:  -0.027789540260381516
Bond Position:  [-12.34299093]


portfolio before change:  [-15.09240615]
curr_Stock_Price:  98.88152983223712
curr_Factors:  [98.88152983]
mat_Sqrt:  [[0.15]]
grads:  [-0.06181873]
Stock Position:  -0.061818731317341745
Bond Position:  [-8.97967543]


portfolio before change:  [-15.09906541]
curr_Stock_Price:  98.97109375923816
curr_Factors:  [98.97109376]
mat_Sqrt:  [[0.15]]
grads:  [-0.01391659]
Stock Position:  -0.013916592758726488
Bond Position:  [-13.72172501]


portfolio before change:  [-15.10407917]
curr_Stock_Price:  99.20810812678928
curr_Factors:  [99.20810813]
mat_Sqrt:  [[0.15]]
grads:  [-0.02079585]
Stock Position:  -0.02079585417407108
Bond Position:  [-13.04096182]


portfolio before change:  [-15.1048852]
curr_Stock_Price:  99.16847594681596
curr_Factors:  [99.16847595]
mat_Sqrt:  [[0.15]]
grads:  [-0.05502842]
Stock Position:  -0.0550284178511941
Bond Position:  [-9.64780087]


portfolio before change:  [-15.08347299]
curr_Stock_Price:  98.75744716015814
curr_Factors:  [98.75744716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01596197]
Stock Position:  -0.015961965803551078
Bond Position:  [-13.50711]


portfolio before change:  [-15.08508343]
curr_Stock_Price:  98.75255732225502
curr_Factors:  [98.75255732]
mat_Sqrt:  [[0.15]]
grads:  [0.00210689]
Stock Position:  0.002106892549288302
Bond Position:  [-15.29314446]


portfolio before change:  [-15.0899606]
curr_Stock_Price:  97.34507869593207
curr_Factors:  [97.3450787]
mat_Sqrt:  [[0.15]]
grads:  [0.07590884]
Stock Position:  0.07590883764655901
Bond Position:  [-22.47931238]


portfolio before change:  [-15.10430485]
curr_Stock_Price:  97.19313123999689
curr_Factors:  [97.19313124]
mat_Sqrt:  [[0.15]]
grads:  [0.03172294]
Stock Position:  0.03172294317559341
Bond Position:  [-18.18755703]


portfolio before change:  [-15.09348278]
curr_Stock_Price:  97.60594459171595
curr_Factors:  [97.60594459]
mat_Sqrt:  [[0.15]]
grads:  [0.03711731]
Stock Position:  0.03711730866037555
Bond Position:  [-18.71635275]


portfolio before change:  [-15.13847971]
curr_Stock_Price:  96.45668982515018
curr_Factors:  [96.45668983]
mat_Sqrt:  [[0.15]]
grads:  [-0.00063184]
Stock Position:  -0.0006318408588557613
Bond Position:  [-15.07753444]


portfolio before change:  [-15.14047474]
curr_Stock_Price:  96.6311254126266
curr_Factors:  [96.63112541]
mat_Sqrt:  [[0.15]]
grads:  [-0.02572946]
Stock Position:  -0.025729461266047818
Bond Position:  [-12.65420794]


portfolio before change:  [-15.13284535]
curr_Stock_Price:  96.27312082327462
curr_Factors:  [96.27312082]
mat_Sqrt:  [[0.15]]
grads:  [-0.01129139]
Stock Position:  -0.01129139052322614
Bond Position:  [-14.04578794]


portfolio before change:  [-15.15086491]
curr_Stock_Price:  97.71348650371007
curr_Factors:  [97.7134865]
mat_Sqrt:  [[0.15]]
grads:  [-0.13541208]
Stock Position:  -0.13541207540573197
Bond Position:  [-1.91927891]


portfolio before change:  [-15.24451935]
curr_Stock_Price:  98.40334013669185
curr_Factors:  [98.40334014]
mat_Sqrt:  [[0.15]]
grads:  [-0.24281202]
Stock Position:  -0.2428120249883109
Bond Position:  [8.64899493]


portfolio before change:  [-15.43342881]
curr_Stock_Price:  99.18579996994424
curr_Factors:  [99.18579997]
mat_Sqrt:  [[0.15]]
grads:  [0.1446129]
Stock Position:  0.14461289608370037
Bond Position:  [-29.7769746]


portfolio before change:  [-15.50877388]
curr_Stock_Price:  98.69052801404644
curr_Factors:  [98.69052801]
mat_Sqrt:  [[0.15]]
grads:  [0.04002935]
Stock Position:  0.040029349135704495
Bond Position:  [-19.45929148]


portfolio before change:  [-15.52862576]
curr_Stock_Price:  98.25536437386869
curr_Factors:  [98.25536437]
mat_Sqrt:  [[0.15]]
grads:  [-0.01830601]
Stock Position:  -0.01830600746300965
Bond Position:  [-13.72996233]


portfolio before change:  [-15.56317474]
curr_Stock_Price:  100.04890794539855
curr_Factors:  [100.04890795]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331836]
Stock Position:  -0.08331836442001217
Bond Position:  [-7.22726336]


portfolio before change:  [-15.48895293]
curr_Stock_Price:  99.14724270344229
curr_Factors:  [99.1472427]
mat_Sqrt:  [[0.15]]
grads:  [-0.0473]
Stock Position:  -0.04729999679552378
Bond Position:  [-10.79928867]


portfolio before change:  [-15.54971902]
curr_Stock_Price:  100.40339701095166
curr_Factors:  [100.40339701]
mat_Sqrt:  [[0.15]]
grads:  [-0.0408752]
Stock Position:  -0.04087520320442924
Bond Position:  [-11.44570976]


portfolio before change:  [-15.54009983]
curr_Stock_Price:  100.13306222882426
curr_Factors:  [100.13306223]
mat_Sqrt:  [[0.15]]
grads:  [-0.0496968]
Stock Position:  -0.049696799518253204
Bond Position:  [-10.56380711]


portfolio before change:  [-15.57591825]
curr_Stock_Price:  100.82722879440466
curr_Factors:  [100.82722879]
mat_Sqrt:  [[0.15]]
grads:  [0.15197693]
Stock Position:  0.15197692684269504
Bond Position:  [-30.89933062]


portfolio before change:  [-15.75944273]
curr_Stock_Price:  99.64506365710967
curr_Factors:  [99.64506366]
mat_Sqrt:  [[0.15]]
grads:  [0.05230547]
Stock Position:  0.05230546503164987
Bond Position:  [-20.97142412]


portfolio before change:  [-15.78484142]
curr_Stock_Price:  99.20960049500171
curr_Factors:  [99.2096005]
mat_Sqrt:  [[0.15]]
grads:  [0.15634275]
Stock Position:  0.15634274855331307
Bond Position:  [-31.29554305]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.78484142]
Stock Price:  98.58237741534055
PL:  [-15.78484142]
Settle:  Tensor("sub_232:0", shape=(), dtype=float64)
PL:  Tensor("sub_233:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  117
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.50821386e-03]
 [-3.39174161e-03]
 [-7.79613258e-04]
 [ 5.90592332e-02]
 [-7.29132784e-03]
 [ 2.70107330e-02]
 [ 2.72406197e-02]
 [-1.12203107e-03]
 [ 2.76136088e-03]
 [ 1.08181338e-02]
 [ 6.74532233e-03]
 [ 1.07561224e-02]
 [-8.02885444e-03]
 [ 1.17280652e-02]
 [-6.21463048e-03]
 [-2.68109727e-02]
 [ 4.37234114e-03]
 [-8.45030374e-04]
 [-1.17465494e-02]
 [-2.30855984e-03]
 [ 2.37901856e-04]
 [-3.23368171e-02]
 [ 4.80464487e-03]
 [ 8.77114608e-03]
 [-5.48391180e-03]
 [-3.99542108e-03]
 [ 1.39490257e-03]
 [-1.52199467e-02]
 [-1.51445359e-02]
 [ 2.18029008e-02]
 [ 6.73959894e-03]
 [ 6.37473027e-03]
 [-1.24500633e-02]
 [-5.30406170e-03]
 [-5.42594859e-03]
 [-7.24196073e-03]
 [ 2.26810806e-02]
 [ 8.31646995e-03]
 [ 2.35629646e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [9.67342136]
curr_Stock_Price:  100.49820641805182
curr_Factors:  [100.49820642]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005476]
Stock Position:  -0.0100547590906657
Bond Position:  [10.68390661]


portfolio before change:  [9.6658069]
curr_Stock_Price:  101.38833533388802
curr_Factors:  [101.38833533]
mat_Sqrt:  [[0.15]]
grads:  [-0.02261161]
Stock Position:  -0.022611610753133796
Bond Position:  [11.95836047]


portfolio before change:  [9.64959271]
curr_Stock_Price:  102.17152070321472
curr_Factors:  [102.1715207]
mat_Sqrt:  [[0.15]]
grads:  [-0.00519742]
Stock Position:  -0.005197421718415111
Bond Position:  [10.18062119]


portfolio before change:  [9.65035284]
curr_Stock_Price:  102.27013216736508
curr_Factors:  [102.27013217]
mat_Sqrt:  [[0.15]]
grads:  [0.39372822]
Stock Position:  0.3937282210306939
Bond Position:  [-30.61628437]


portfolio before change:  [9.60862151]
curr_Stock_Price:  102.17386257749386
curr_Factors:  [102.17386258]
mat_Sqrt:  [[0.15]]
grads:  [-0.04860885]
Stock Position:  -0.0486088522854366
Bond Position:  [14.5751757]


portfolio before change:  [9.6648067]
curr_Stock_Price:  101.0554822874496
curr_Factors:  [101.05548229]
mat_Sqrt:  [[0.15]]
grads:  [0.18007155]
Stock Position:  0.18007155353724277
Bond Position:  [-8.53241099]


portfolio before change:  [9.49001296]
curr_Stock_Price:  100.09071508730385
curr_Factors:  [100.09071509]
mat_Sqrt:  [[0.15]]
grads:  [0.18160413]
Stock Position:  0.18160413124947927
Bond Position:  [-8.6868744]


portfolio before change:  [9.72160288]
curr_Stock_Price:  101.37194063582818
curr_Factors:  [101.37194064]
mat_Sqrt:  [[0.15]]
grads:  [-0.00748021]
Stock Position:  -0.007480207151273883
Bond Position:  [10.479886]


portfolio before change:  [9.72537312]
curr_Stock_Price:  101.04304918689262
curr_Factors:  [101.04304919]
mat_Sqrt:  [[0.15]]
grads:  [0.01840907]
Stock Position:  0.01840907254594723
Bond Position:  [7.8652643]


portfolio before change:  [9.73792075]
curr_Stock_Price:  101.6712399065787
curr_Factors:  [101.67123991]
mat_Sqrt:  [[0.15]]
grads:  [0.07212089]
Stock Position:  0.07212089229120197
Bond Position:  [2.40530021]


portfolio before change:  [9.62522915]
curr_Stock_Price:  100.10453324458636
curr_Factors:  [100.10453324]
mat_Sqrt:  [[0.15]]
grads:  [0.04496882]
Stock Position:  0.04496881552214595
Bond Position:  [5.12364686]


portfolio before change:  [9.6527643]
curr_Stock_Price:  100.70260662728799
curr_Factors:  [100.70260663]
mat_Sqrt:  [[0.15]]
grads:  [0.07170748]
Stock Position:  0.0717074829080927
Bond Position:  [2.43163386]


portfolio before change:  [9.58650345]
curr_Stock_Price:  99.77432382515846
curr_Factors:  [99.77432383]
mat_Sqrt:  [[0.15]]
grads:  [-0.0535257]
Stock Position:  -0.05352569624400626
Bond Position:  [14.9269936]


portfolio before change:  [9.51144056]
curr_Stock_Price:  101.21155651045814
curr_Factors:  [101.21155651]
mat_Sqrt:  [[0.15]]
grads:  [0.0781871]
Stock Position:  0.07818710148049252
Bond Position:  [1.59800232]


portfolio before change:  [9.45714627]
curr_Stock_Price:  100.5145866239993
curr_Factors:  [100.51458662]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143087]
Stock Position:  -0.04143086987089747
Bond Position:  [13.62155303]


portfolio before change:  [9.39213657]
curr_Stock_Price:  102.12479907787638
curr_Factors:  [102.12479908]
mat_Sqrt:  [[0.15]]
grads:  [-0.17873982]
Stock Position:  -0.1787398179399724
Bond Position:  [27.64590456]


portfolio before change:  [9.46471738]
curr_Stock_Price:  101.73806456342612
curr_Factors:  [101.73806456]
mat_Sqrt:  [[0.15]]
grads:  [0.02914894]
Stock Position:  0.029148940950175818
Bond Position:  [6.49916054]


portfolio before change:  [9.44517172]
curr_Stock_Price:  101.03964815247541
curr_Factors:  [101.03964815]
mat_Sqrt:  [[0.15]]
grads:  [-0.00563354]
Stock Position:  -0.00563353582603595
Bond Position:  [10.0143822]


portfolio before change:  [9.44745895]
curr_Stock_Price:  100.85586434810781
curr_Factors:  [100.85586435]
mat_Sqrt:  [[0.15]]
grads:  [-0.07831033]
Stock Position:  -0.07831032916272286
Bond Position:  [17.34551489]


portfolio before change:  [9.39800741]
curr_Stock_Price:  101.51503495083557
curr_Factors:  [101.51503495]
mat_Sqrt:  [[0.15]]
grads:  [-0.0153904]
Stock Position:  -0.015390398913466594
Bond Position:  [10.96036429]


portfolio before change:  [9.40737112]
curr_Stock_Price:  100.99564785585041
curr_Factors:  [100.99564786]
mat_Sqrt:  [[0.15]]
grads:  [0.00158601]
Stock Position:  0.0015860123763394662
Bond Position:  [9.24719077]


portfolio before change:  [9.41163768]
curr_Stock_Price:  102.9569127240859
curr_Factors:  [102.95691272]
mat_Sqrt:  [[0.15]]
grads:  [-0.21557878]
Stock Position:  -0.21557878082400422
Bond Position:  [31.6069634]


portfolio before change:  [9.33469657]
curr_Stock_Price:  103.33214548201867
curr_Factors:  [103.33214548]
mat_Sqrt:  [[0.15]]
grads:  [0.03203097]
Stock Position:  0.032030965811670455
Bond Position:  [6.02486815]


portfolio before change:  [9.32515989]
curr_Stock_Price:  103.01089879352122
curr_Factors:  [103.01089879]
mat_Sqrt:  [[0.15]]
grads:  [0.05847431]
Stock Position:  0.05847430717704687
Bond Position:  [3.30166895]


portfolio before change:  [9.3282529]
curr_Stock_Price:  103.05673564876219
curr_Factors:  [103.05673565]
mat_Sqrt:  [[0.15]]
grads:  [-0.03655941]
Stock Position:  -0.03655941201381299
Bond Position:  [13.09594656]


portfolio before change:  [9.33744829]
curr_Stock_Price:  102.8499956531569
curr_Factors:  [102.84999565]
mat_Sqrt:  [[0.15]]
grads:  [-0.02663614]
Stock Position:  -0.026636140551949076
Bond Position:  [12.07697523]


portfolio before change:  [9.36032821]
curr_Stock_Price:  102.04769472525523
curr_Factors:  [102.04769473]
mat_Sqrt:  [[0.15]]
grads:  [0.00929935]
Stock Position:  0.00929935044754742
Bond Position:  [8.41135093]


portfolio before change:  [9.3604889]
curr_Stock_Price:  101.95190375171725
curr_Factors:  [101.95190375]
mat_Sqrt:  [[0.15]]
grads:  [-0.10146631]
Stock Position:  -0.10146631153283721
Bond Position:  [19.70517252]


portfolio before change:  [9.4238548]
curr_Stock_Price:  101.35167888219108
curr_Factors:  [101.35167888]
mat_Sqrt:  [[0.15]]
grads:  [-0.10096357]
Stock Position:  -0.10096357236815082
Bond Position:  [19.65668237]


portfolio before change:  [9.48438679]
curr_Stock_Price:  100.77647388248253
curr_Factors:  [100.77647388]
mat_Sqrt:  [[0.15]]
grads:  [0.14535267]
Stock Position:  0.14535267183525252
Bond Position:  [-5.16374295]


portfolio before change:  [9.53103108]
curr_Stock_Price:  101.10181909277557
curr_Factors:  [101.10181909]
mat_Sqrt:  [[0.15]]
grads:  [0.04493066]
Stock Position:  0.04493065959902897
Bond Position:  [4.98845966]


portfolio before change:  [9.55593311]
curr_Stock_Price:  101.64217248067796
curr_Factors:  [101.64217248]
mat_Sqrt:  [[0.15]]
grads:  [0.0424982]
Stock Position:  0.042498201790568464
Bond Position:  [5.23632355]


portfolio before change:  [9.51692984]
curr_Stock_Price:  100.70900715050576
curr_Factors:  [100.70900715]
mat_Sqrt:  [[0.15]]
grads:  [-0.08300042]
Stock Position:  -0.08300042210249244
Bond Position:  [17.87581994]


portfolio before change:  [9.51295228]
curr_Stock_Price:  100.78385234617704
curr_Factors:  [100.78385235]
mat_Sqrt:  [[0.15]]
grads:  [-0.03536041]
Stock Position:  -0.03536041130763745
Bond Position:  [13.07671075]


portfolio before change:  [9.5016]
curr_Stock_Price:  101.15112644703095
curr_Factors:  [101.15112645]
mat_Sqrt:  [[0.15]]
grads:  [-0.03617299]
Stock Position:  -0.03617299057270907
Bond Position:  [13.16053875]


portfolio before change:  [9.52204356]
curr_Stock_Price:  100.6314461551705
curr_Factors:  [100.63144616]
mat_Sqrt:  [[0.15]]
grads:  [-0.04827974]
Stock Position:  -0.048279738227820446
Bond Position:  [14.38050344]


portfolio before change:  [9.55513746]
curr_Stock_Price:  99.98321924968053
curr_Factors:  [99.98321925]
mat_Sqrt:  [[0.15]]
grads:  [0.1512072]
Stock Position:  0.15120720412173658
Bond Position:  [-5.56304558]


portfolio before change:  [9.43509766]
curr_Stock_Price:  99.19394218844604
curr_Factors:  [99.19394219]
mat_Sqrt:  [[0.15]]
grads:  [0.05544313]
Stock Position:  0.05544313300393733
Bond Position:  [3.93547473]


portfolio before change:  [9.44874015]
curr_Stock_Price:  99.43113149204241
curr_Factors:  [99.43113149]
mat_Sqrt:  [[0.15]]
grads:  [0.15708643]
Stock Position:  0.15708643092502192
Bond Position:  [-6.17054142]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [9.44874015]
Stock Price:  99.89212037949278
PL:  [9.44874015]
Settle:  Tensor("sub_234:0", shape=(), dtype=float64)
PL:  Tensor("sub_235:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  118
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.28766643e-03]
 [-1.03687086e-02]
 [ 9.73747123e-03]
 [-2.97394557e-03]
 [-1.36149970e-03]
 [ 3.24847182e-02]
 [ 4.84612898e-03]
 [ 1.16833261e-04]
 [ 4.77492333e-03]
 [ 5.69202246e-03]
 [ 1.20859747e-02]
 [ 1.08794427e-02]
 [-1.15655888e-02]
 [ 1.16755520e-02]
 [-6.37441418e-03]
 [-1.12834596e-02]
 [-1.55306176e-03]
 [-2.04987258e-03]
 [-7.44932705e-03]
 [-2.39329551e-03]
 [ 3.22566717e-04]
 [ 8.47958427e-03]
 [ 4.76703343e-03]
 [ 5.92595309e-03]
 [-3.44769831e-03]
 [-7.52568186e-03]
 [ 1.40664371e-02]
 [-2.27499140e-02]
 [-3.56614487e-02]
 [ 2.16003207e-02]
 [ 5.35859536e-03]
 [ 3.56664576e-04]
 [-1.25334735e-02]
 [-8.15576350e-03]
 [-8.58085781e-03]
 [-7.48229118e-03]
 [ 2.27938681e-02]
 [ 4.04992268e-03]
 [ 2.21394719e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.85199086]
curr_Stock_Price:  99.56244928704832
curr_Factors:  [99.56244929]
mat_Sqrt:  [[0.15]]
grads:  [-0.02191778]
Stock Position:  -0.021917776204832384
Bond Position:  [-2.66980337]


portfolio before change:  [-4.87631711]
curr_Stock_Price:  100.65710906739073
curr_Factors:  [100.65710907]
mat_Sqrt:  [[0.15]]
grads:  [-0.06912472]
Stock Position:  -0.06912472422668187
Bond Position:  [2.08157779]


portfolio before change:  [-4.87456811]
curr_Stock_Price:  100.63557130391818
curr_Factors:  [100.6355713]
mat_Sqrt:  [[0.15]]
grads:  [0.06491647]
Stock Position:  0.0649164748722535
Bond Position:  [-11.40747464]


portfolio before change:  [-4.90669279]
curr_Stock_Price:  100.16267652558253
curr_Factors:  [100.16267653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0198263]
Stock Position:  -0.019826303789091476
Bond Position:  [-2.92083714]


portfolio before change:  [-4.94306638]
curr_Stock_Price:  101.97887280200204
curr_Factors:  [101.9788728]
mat_Sqrt:  [[0.15]]
grads:  [-0.00907666]
Stock Position:  -0.009076664680243453
Bond Position:  [-4.01743834]


portfolio before change:  [-4.94641214]
curr_Stock_Price:  102.292154044452
curr_Factors:  [102.29215404]
mat_Sqrt:  [[0.15]]
grads:  [0.21656479]
Stock Position:  0.21656478800118498
Bond Position:  [-27.09929079]


portfolio before change:  [-4.81526511]
curr_Stock_Price:  102.91337528650301
curr_Factors:  [102.91337529]
mat_Sqrt:  [[0.15]]
grads:  [0.03230753]
Stock Position:  0.03230752650550511
Bond Position:  [-8.14014171]


portfolio before change:  [-4.84663698]
curr_Stock_Price:  101.97383315937302
curr_Factors:  [101.97383316]
mat_Sqrt:  [[0.15]]
grads:  [0.00077889]
Stock Position:  0.0007788884053368238
Bond Position:  [-4.92606321]


portfolio before change:  [-4.84760986]
curr_Stock_Price:  101.5153733896173
curr_Factors:  [101.51537339]
mat_Sqrt:  [[0.15]]
grads:  [0.03183282]
Stock Position:  0.03183282220429191
Bond Position:  [-8.0791307]


portfolio before change:  [-4.87593743]
curr_Stock_Price:  100.6572148730229
curr_Factors:  [100.65721487]
mat_Sqrt:  [[0.15]]
grads:  [0.03794682]
Stock Position:  0.03794681641095115
Bond Position:  [-8.69555828]


portfolio before change:  [-4.88601442]
curr_Stock_Price:  100.42030487012151
curr_Factors:  [100.42030487]
mat_Sqrt:  [[0.15]]
grads:  [0.08057316]
Stock Position:  0.08057316448950351
Bond Position:  [-12.97719616]


portfolio before change:  [-4.87015468]
curr_Stock_Price:  100.63727526295033
curr_Factors:  [100.63727526]
mat_Sqrt:  [[0.15]]
grads:  [0.07252962]
Stock Position:  0.07252961777168672
Bond Position:  [-12.16933779]


portfolio before change:  [-4.78404618]
curr_Stock_Price:  101.84546801364668
curr_Factors:  [101.84546801]
mat_Sqrt:  [[0.15]]
grads:  [-0.07710393]
Stock Position:  -0.07710392552663486
Bond Position:  [3.0686392]


portfolio before change:  [-4.77433073]
curr_Stock_Price:  101.7244385694658
curr_Factors:  [101.72443857]
mat_Sqrt:  [[0.15]]
grads:  [0.07783701]
Stock Position:  0.07783701356173153
Bond Position:  [-12.69225724]


portfolio before change:  [-4.86496868]
curr_Stock_Price:  100.58036440164092
curr_Factors:  [100.5803644]
mat_Sqrt:  [[0.15]]
grads:  [-0.04249609]
Stock Position:  -0.04249609455957897
Bond Position:  [-0.590696]


portfolio before change:  [-4.81883415]
curr_Stock_Price:  99.4930086781295
curr_Factors:  [99.49300868]
mat_Sqrt:  [[0.15]]
grads:  [-0.07522306]
Stock Position:  -0.07522306373173696
Bond Position:  [2.66533478]


portfolio before change:  [-4.79517604]
curr_Stock_Price:  99.18293189606642
curr_Factors:  [99.1829319]
mat_Sqrt:  [[0.15]]
grads:  [-0.01035375]
Stock Position:  -0.010353745076762013
Bond Position:  [-3.76826124]


portfolio before change:  [-4.78619219]
curr_Stock_Price:  98.26974410298456
curr_Factors:  [98.2697441]
mat_Sqrt:  [[0.15]]
grads:  [-0.01366582]
Stock Position:  -0.013665817205559755
Bond Position:  [-3.44325583]


portfolio before change:  [-4.79237551]
curr_Stock_Price:  98.69071321752588
curr_Factors:  [98.69071322]
mat_Sqrt:  [[0.15]]
grads:  [-0.04966218]
Stock Position:  -0.049662180336709494
Bond Position:  [0.10882049]


portfolio before change:  [-4.78351153]
curr_Stock_Price:  98.51250162832378
curr_Factors:  [98.51250163]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159553]
Stock Position:  -0.015955303392227605
Bond Position:  [-3.21171468]


portfolio before change:  [-4.79874388]
curr_Stock_Price:  99.44202736185073
curr_Factors:  [99.44202736]
mat_Sqrt:  [[0.15]]
grads:  [0.00215044]
Stock Position:  0.0021504447800852807
Bond Position:  [-5.01258847]


portfolio before change:  [-4.80045329]
curr_Stock_Price:  98.93850450650596
curr_Factors:  [98.93850451]
mat_Sqrt:  [[0.15]]
grads:  [0.05653056]
Stock Position:  0.05653056179901012
Bond Position:  [-10.39350254]


portfolio before change:  [-4.82380476]
curr_Stock_Price:  98.54841116789554
curr_Factors:  [98.54841117]
mat_Sqrt:  [[0.15]]
grads:  [0.03178022]
Stock Position:  0.031780222857957924
Bond Position:  [-7.95569523]


portfolio before change:  [-4.81410064]
curr_Stock_Price:  98.88505571264261
curr_Factors:  [98.88505571]
mat_Sqrt:  [[0.15]]
grads:  [0.03950635]
Stock Position:  0.03950635396335038
Bond Position:  [-8.72068866]


portfolio before change:  [-4.81077194]
curr_Stock_Price:  98.99690755097647
curr_Factors:  [98.99690755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02298466]
Stock Position:  -0.02298465537111222
Bond Position:  [-2.53536214]


portfolio before change:  [-4.81790109]
curr_Stock_Price:  99.2932881812493
curr_Factors:  [99.29328818]
mat_Sqrt:  [[0.15]]
grads:  [-0.05017121]
Stock Position:  -0.05017121243131808
Bond Position:  [0.16376357]


portfolio before change:  [-4.8535422]
curr_Stock_Price:  100.00408589402701
curr_Factors:  [100.00408589]
mat_Sqrt:  [[0.15]]
grads:  [0.09377625]
Stock Position:  0.09377624725744002
Bond Position:  [-14.23155008]


portfolio before change:  [-4.99834647]
curr_Stock_Price:  98.47891053137349
curr_Factors:  [98.47891053]
mat_Sqrt:  [[0.15]]
grads:  [-0.15166609]
Stock Position:  -0.15166609315426596
Bond Position:  [9.93756515]


portfolio before change:  [-5.12190247]
curr_Stock_Price:  99.30175939533511
curr_Factors:  [99.3017594]
mat_Sqrt:  [[0.15]]
grads:  [-0.23774299]
Stock Position:  -0.23774299131650353
Bond Position:  [18.48639485]


portfolio before change:  [-5.14979706]
curr_Stock_Price:  99.42881059138259
curr_Factors:  [99.42881059]
mat_Sqrt:  [[0.15]]
grads:  [0.14400214]
Stock Position:  0.14400213827579958
Bond Position:  [-19.46775839]


portfolio before change:  [-5.27729173]
curr_Stock_Price:  98.56034399158224
curr_Factors:  [98.56034399]
mat_Sqrt:  [[0.15]]
grads:  [0.03572397]
Stock Position:  0.035723969082963755
Bond Position:  [-8.79825841]


portfolio before change:  [-5.24458241]
curr_Stock_Price:  99.50674426305908
curr_Factors:  [99.50674426]
mat_Sqrt:  [[0.15]]
grads:  [0.00237776]
Stock Position:  0.0023777638394813605
Bond Position:  [-5.48118594]


portfolio before change:  [-5.24642282]
curr_Stock_Price:  99.02089869264299
curr_Factors:  [99.02089869]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355649]
Stock Position:  -0.08355649027509224
Bond Position:  [3.02741594]


portfolio before change:  [-5.19094424]
curr_Stock_Price:  98.36146294320227
curr_Factors:  [98.36146294]
mat_Sqrt:  [[0.15]]
grads:  [-0.05437176]
Stock Position:  -0.05437175663377548
Bond Position:  [0.15714129]


portfolio before change:  [-5.21875582]
curr_Stock_Price:  98.87333211187176
curr_Factors:  [98.87333211]
mat_Sqrt:  [[0.15]]
grads:  [-0.05720572]
Stock Position:  -0.05720571870586556
Bond Position:  [0.43736421]


portfolio before change:  [-5.26839705]
curr_Stock_Price:  99.74205472895545
curr_Factors:  [99.74205473]
mat_Sqrt:  [[0.15]]
grads:  [-0.04988194]
Stock Position:  -0.04988194118395018
Bond Position:  [-0.29306974]


portfolio before change:  [-5.32103707]
curr_Stock_Price:  100.79661241958024
curr_Factors:  [100.79661242]
mat_Sqrt:  [[0.15]]
grads:  [0.15195912]
Stock Position:  0.15195912037701664
Bond Position:  [-20.63800163]


portfolio before change:  [-5.23179645]
curr_Stock_Price:  101.40085736929377
curr_Factors:  [101.40085737]
mat_Sqrt:  [[0.15]]
grads:  [0.02699948]
Stock Position:  0.02699948455755984
Bond Position:  [-7.96956733]


portfolio before change:  [-5.20842558]
curr_Stock_Price:  102.30336066401364
curr_Factors:  [102.30336066]
mat_Sqrt:  [[0.15]]
grads:  [0.14759648]
Stock Position:  0.14759647935173004
Bond Position:  [-20.30804144]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.20842558]
Stock Price:  103.49018391025993
PL:  [-8.69860949]
Settle:  Tensor("sub_236:0", shape=(), dtype=float64)
PL:  Tensor("sub_237:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  119
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.52569621e-03]
 [-4.69264615e-03]
 [-2.25710485e-02]
 [-1.88263473e-02]
 [ 1.37894194e-02]
 [ 2.24391744e-02]
 [ 5.28857487e-03]
 [-8.78683556e-03]
 [ 1.38029983e-02]
 [ 5.42497581e-04]
 [-4.84050582e-02]
 [-2.08826041e-03]
 [ 6.03149960e-03]
 [ 9.34406696e-03]
 [-4.13238443e-03]
 [-1.93994025e-02]
 [-1.25888036e-03]
 [-3.03729329e-03]
 [-1.02248003e-02]
 [-2.21528009e-03]
 [ 7.74715227e-05]
 [ 1.19629132e-03]
 [ 4.78091514e-03]
 [ 8.10359177e-03]
 [-4.42695791e-03]
 [-5.03277496e-03]
 [ 3.87883150e-03]
 [-1.40229863e-02]
 [-4.78375222e-03]
 [ 2.32889779e-02]
 [-3.97216359e-03]
 [ 6.13663994e-03]
 [-1.28483331e-02]
 [-4.17015574e-03]
 [-5.69796869e-03]
 [-2.00666150e-03]
 [ 2.32343466e-02]
 [ 1.31523562e-03]
 [ 2.14548239e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.36180506]
curr_Stock_Price:  99.52960600075559
curr_Factors:  [99.529606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02350464]
Stock Position:  -0.023504641427118673
Bond Position:  [-3.02239736]


portfolio before change:  [-5.37011099]
curr_Stock_Price:  99.86690573099587
curr_Factors:  [99.86690573]
mat_Sqrt:  [[0.15]]
grads:  [-0.03128431]
Stock Position:  -0.03128430768322247
Bond Position:  [-2.24584398]


portfolio before change:  [-5.33293844]
curr_Stock_Price:  98.66971448497732
curr_Factors:  [98.66971448]
mat_Sqrt:  [[0.15]]
grads:  [-0.15047366]
Stock Position:  -0.15047365675822846
Bond Position:  [9.51425431]


portfolio before change:  [-5.33900589]
curr_Stock_Price:  98.71794093741703
curr_Factors:  [98.71794094]
mat_Sqrt:  [[0.15]]
grads:  [-0.12550898]
Stock Position:  -0.12550898212999517
Bond Position:  [7.05098239]


portfolio before change:  [-5.37931255]
curr_Stock_Price:  99.04610934192435
curr_Factors:  [99.04610934]
mat_Sqrt:  [[0.15]]
grads:  [0.09192946]
Stock Position:  0.09192946267946595
Bond Position:  [-14.48456816]


portfolio before change:  [-5.43287896]
curr_Stock_Price:  98.48311540684468
curr_Factors:  [98.48311541]
mat_Sqrt:  [[0.15]]
grads:  [0.1495945]
Stock Position:  0.14959449626086166
Bond Position:  [-20.165411]


portfolio before change:  [-5.51718028]
curr_Stock_Price:  97.93643428397914
curr_Factors:  [97.93643428]
mat_Sqrt:  [[0.15]]
grads:  [0.03525717]
Stock Position:  0.03525716579556065
Bond Position:  [-8.97014138]


portfolio before change:  [-5.54846705]
curr_Stock_Price:  97.08085136766266
curr_Factors:  [97.08085137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0585789]
Stock Position:  -0.058578903749091686
Bond Position:  [0.1384228]


portfolio before change:  [-5.62710743]
curr_Stock_Price:  98.42361611431906
curr_Factors:  [98.42361611]
mat_Sqrt:  [[0.15]]
grads:  [0.09201999]
Stock Position:  0.09201998887348885
Bond Position:  [-14.68404749]


portfolio before change:  [-5.75066447]
curr_Stock_Price:  97.1008445717367
curr_Factors:  [97.10084457]
mat_Sqrt:  [[0.15]]
grads:  [0.00361665]
Stock Position:  0.003616650538720365
Bond Position:  [-6.1018443]


portfolio before change:  [-5.75237534]
curr_Stock_Price:  96.83870010878059
curr_Factors:  [96.83870011]
mat_Sqrt:  [[0.15]]
grads:  [-0.32270039]
Stock Position:  -0.3227003877416978
Bond Position:  [25.49751074]


portfolio before change:  [-6.11480271]
curr_Stock_Price:  97.97168531516647
curr_Factors:  [97.97168532]
mat_Sqrt:  [[0.15]]
grads:  [-0.01392174]
Stock Position:  -0.013921736094950576
Bond Position:  [-4.75086677]


portfolio before change:  [-6.12007298]
curr_Stock_Price:  98.30758928575167
curr_Factors:  [98.30758929]
mat_Sqrt:  [[0.15]]
grads:  [0.04021]
Stock Position:  0.04020999730801538
Bond Position:  [-10.07302088]


portfolio before change:  [-6.07919351]
curr_Stock_Price:  99.35555429716622
curr_Factors:  [99.3555543]
mat_Sqrt:  [[0.15]]
grads:  [0.06229378]
Stock Position:  0.06229377970883605
Bond Position:  [-12.26842652]


portfolio before change:  [-6.07749704]
curr_Stock_Price:  99.40740736559032
curr_Factors:  [99.40740737]
mat_Sqrt:  [[0.15]]
grads:  [-0.02754923]
Stock Position:  -0.027549229528354285
Bond Position:  [-3.33889956]


portfolio before change:  [-6.103538]
curr_Stock_Price:  100.33750864896511
curr_Factors:  [100.33750865]
mat_Sqrt:  [[0.15]]
grads:  [-0.12932935]
Stock Position:  -0.12932934968946627
Bond Position:  [6.87304674]


portfolio before change:  [-5.96864368]
curr_Stock_Price:  99.30112257373585
curr_Factors:  [99.30112257]
mat_Sqrt:  [[0.15]]
grads:  [-0.00839254]
Stock Position:  -0.008392535716787407
Bond Position:  [-5.13525546]


portfolio before change:  [-5.97408363]
curr_Stock_Price:  99.8728211729622
curr_Factors:  [99.87282117]
mat_Sqrt:  [[0.15]]
grads:  [-0.02024862]
Stock Position:  -0.02024862191734806
Bond Position:  [-3.95179663]


portfolio before change:  [-5.97093092]
curr_Stock_Price:  99.69272435423231
curr_Factors:  [99.69272435]
mat_Sqrt:  [[0.15]]
grads:  [-0.06816534]
Stock Position:  -0.06816533564360641
Bond Position:  [0.8246571]


portfolio before change:  [-6.01990926]
curr_Stock_Price:  100.41275938423699
curr_Factors:  [100.41275938]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476853]
Stock Position:  -0.014768533934571077
Bond Position:  [-4.53696002]


portfolio before change:  [-6.03324348]
curr_Stock_Price:  101.27723714938128
curr_Factors:  [101.27723715]
mat_Sqrt:  [[0.15]]
grads:  [0.00051648]
Stock Position:  0.0005164768182400569
Bond Position:  [-6.08555083]


portfolio before change:  [-6.03410101]
curr_Stock_Price:  101.08984242130448
curr_Factors:  [101.08984242]
mat_Sqrt:  [[0.15]]
grads:  [0.00797528]
Stock Position:  0.00797527547571955
Bond Position:  [-6.84032035]


portfolio before change:  [-6.0344791]
curr_Stock_Price:  101.14965231386901
curr_Factors:  [101.14965231]
mat_Sqrt:  [[0.15]]
grads:  [0.03187277]
Stock Position:  0.03187276757196331
Bond Position:  [-9.25839846]


portfolio before change:  [-6.00098344]
curr_Stock_Price:  102.23688250279618
curr_Factors:  [102.2368825]
mat_Sqrt:  [[0.15]]
grads:  [0.05402395]
Stock Position:  0.05402394516453509
Bond Position:  [-11.52422318]


portfolio before change:  [-6.01181542]
curr_Stock_Price:  102.06304550539143
curr_Factors:  [102.06304551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02951305]
Stock Position:  -0.02951305273613421
Bond Position:  [-2.99962338]


portfolio before change:  [-6.02002817]
curr_Stock_Price:  102.32861541271534
curr_Factors:  [102.32861541]
mat_Sqrt:  [[0.15]]
grads:  [-0.03355183]
Stock Position:  -0.03355183306344138
Bond Position:  [-2.58671555]


portfolio before change:  [-6.00117342]
curr_Stock_Price:  101.75701888220574
curr_Factors:  [101.75701888]
mat_Sqrt:  [[0.15]]
grads:  [0.02585888]
Stock Position:  0.025858876666087265
Bond Position:  [-8.63249562]


portfolio before change:  [-5.99141015]
curr_Stock_Price:  102.1763102189531
curr_Factors:  [102.17631022]
mat_Sqrt:  [[0.15]]
grads:  [-0.09348658]
Stock Position:  -0.09348657557184124
Bond Position:  [3.5607032]


portfolio before change:  [-5.99985136]
curr_Stock_Price:  102.27136476422538
curr_Factors:  [102.27136476]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189168]
Stock Position:  -0.03189168146414369
Bond Position:  [-2.73824557]


portfolio before change:  [-6.00501416]
curr_Stock_Price:  102.42251692851316
curr_Factors:  [102.42251693]
mat_Sqrt:  [[0.15]]
grads:  [0.15525985]
Stock Position:  0.1552598529689396
Bond Position:  [-21.90711908]


portfolio before change:  [-6.01363542]
curr_Stock_Price:  102.3846275459004
curr_Factors:  [102.38462755]
mat_Sqrt:  [[0.15]]
grads:  [-0.02648109]
Stock Position:  -0.02648109058381749
Bond Position:  [-3.30237882]


portfolio before change:  [-6.06306014]
curr_Stock_Price:  104.23545390905494
curr_Factors:  [104.23545391]
mat_Sqrt:  [[0.15]]
grads:  [0.04091093]
Stock Position:  0.04091093291327263
Bond Position:  [-10.3274298]


portfolio before change:  [-6.11551045]
curr_Stock_Price:  102.98494955323822
curr_Factors:  [102.98494955]
mat_Sqrt:  [[0.15]]
grads:  [-0.08565555]
Stock Position:  -0.0856555539672825
Bond Position:  [2.70572245]


portfolio before change:  [-6.08750265]
curr_Stock_Price:  102.66191666459464
curr_Factors:  [102.66191666]
mat_Sqrt:  [[0.15]]
grads:  [-0.02780104]
Stock Position:  -0.027801038261580334
Bond Position:  [-3.23339478]


portfolio before change:  [-6.10637045]
curr_Stock_Price:  103.3260500070682
curr_Factors:  [103.32605001]
mat_Sqrt:  [[0.15]]
grads:  [-0.03798646]
Stock Position:  -0.037986457915276974
Bond Position:  [-2.1813798]


portfolio before change:  [-6.10485008]
curr_Stock_Price:  103.27884755496027
curr_Factors:  [103.27884755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01337774]
Stock Position:  -0.013377743349015533
Bond Position:  [-4.72321217]


portfolio before change:  [-6.09037477]
curr_Stock_Price:  102.1526672244452
curr_Factors:  [102.15266722]
mat_Sqrt:  [[0.15]]
grads:  [0.15489564]
Stock Position:  0.1548956442110885
Bond Position:  [-21.91337797]


portfolio before change:  [-6.09679567]
curr_Stock_Price:  102.12889925731277
curr_Factors:  [102.12889926]
mat_Sqrt:  [[0.15]]
grads:  [0.00876824]
Stock Position:  0.008768237484212104
Bond Position:  [-6.99228611]


portfolio before change:  [-6.08972793]
curr_Stock_Price:  103.03464881780793
curr_Factors:  [103.03464882]
mat_Sqrt:  [[0.15]]
grads:  [0.14303216]
Stock Position:  0.14303215964742838
Bond Position:  [-20.82699627]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.08972793]
Stock Price:  102.92561276946212
PL:  [-9.0153407]
Settle:  Tensor("sub_238:0", shape=(), dtype=float64)
PL:  Tensor("sub_239:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  120
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.79578576e-03]
 [ 1.83415395e-03]
 [-5.09681561e-02]
 [-2.96090608e-02]
 [ 1.27386418e-02]
 [ 2.31804803e-02]
 [ 1.55808848e-02]
 [-2.54246441e-03]
 [ 5.77224718e-03]
 [ 1.03823292e-02]
 [ 2.50726185e-02]
 [ 2.84843932e-03]
 [-1.27379152e-02]
 [ 6.09929895e-06]
 [ 4.94728695e-04]
 [-2.85897318e-02]
 [ 4.25474757e-03]
 [-1.41906876e-03]
 [-2.35568560e-03]
 [-2.60818521e-03]
 [ 4.83985669e-05]
 [-1.52795534e-02]
 [ 4.78797885e-03]
 [ 7.87537763e-03]
 [-3.89949592e-03]
 [-7.99221265e-03]
 [ 1.46312475e-02]
 [-2.35216009e-02]
 [-3.20846826e-02]
 [ 2.18089465e-02]
 [ 9.28818428e-03]
 [ 2.95799515e-03]
 [-1.25118561e-02]
 [-5.04627561e-03]
 [-5.96623744e-03]
 [-7.48989772e-03]
 [ 2.25158082e-02]
 [ 8.21017053e-03]
 [ 2.29594722e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.9633736]
curr_Stock_Price:  99.49085170941711
curr_Factors:  [99.49085171]
mat_Sqrt:  [[0.15]]
grads:  [-0.02530524]
Stock Position:  -0.025305238430153455
Bond Position:  [-3.44573388]


portfolio before change:  [-5.95722563]
curr_Stock_Price:  99.23087735812965
curr_Factors:  [99.23087736]
mat_Sqrt:  [[0.15]]
grads:  [0.01222769]
Stock Position:  0.012227692989877071
Bond Position:  [-7.17059034]


portfolio before change:  [-5.98656037]
curr_Stock_Price:  96.9051436691639
curr_Factors:  [96.90514367]
mat_Sqrt:  [[0.15]]
grads:  [-0.33978771]
Stock Position:  -0.33978770702468636
Bond Position:  [26.9406162]


portfolio before change:  [-6.16047823]
curr_Stock_Price:  97.42689782694251
curr_Factors:  [97.42689783]
mat_Sqrt:  [[0.15]]
grads:  [-0.19739374]
Stock Position:  -0.1973937383394005
Bond Position:  [13.07098135]


portfolio before change:  [-6.29308904]
curr_Stock_Price:  98.10698416555913
curr_Factors:  [98.10698417]
mat_Sqrt:  [[0.15]]
grads:  [0.08492428]
Stock Position:  0.08492427862876864
Bond Position:  [-14.6247539]


portfolio before change:  [-6.29123078]
curr_Stock_Price:  98.15039307042844
curr_Factors:  [98.15039307]
mat_Sqrt:  [[0.15]]
grads:  [0.15453654]
Stock Position:  0.15453653555924665
Bond Position:  [-21.45905249]


portfolio before change:  [-6.20469696]
curr_Stock_Price:  98.72770878789237
curr_Factors:  [98.72770879]
mat_Sqrt:  [[0.15]]
grads:  [0.10387257]
Stock Position:  0.10387256553830235
Bond Position:  [-16.45979736]


portfolio before change:  [-6.00249752]
curr_Stock_Price:  100.6941282972665
curr_Factors:  [100.6941283]
mat_Sqrt:  [[0.15]]
grads:  [-0.01694976]
Stock Position:  -0.016949762741393884
Bond Position:  [-4.29575594]


portfolio before change:  [-6.02064458]
curr_Stock_Price:  101.73308432729429
curr_Factors:  [101.73308433]
mat_Sqrt:  [[0.15]]
grads:  [0.03848165]
Stock Position:  0.03848164785523989
Bond Position:  [-9.93550131]


portfolio before change:  [-6.02936348]
curr_Stock_Price:  101.53878701529582
curr_Factors:  [101.53878702]
mat_Sqrt:  [[0.15]]
grads:  [0.06921553]
Stock Position:  0.06921552802859386
Bond Position:  [-13.05742424]


portfolio before change:  [-5.93162113]
curr_Stock_Price:  102.97451441390305
curr_Factors:  [102.97451441]
mat_Sqrt:  [[0.15]]
grads:  [0.16715079]
Stock Position:  0.16715079031558386
Bond Position:  [-23.1438926]


portfolio before change:  [-6.03013617]
curr_Stock_Price:  102.4024448655782
curr_Factors:  [102.40244487]
mat_Sqrt:  [[0.15]]
grads:  [0.0189896]
Stock Position:  0.018989595496252013
Bond Position:  [-7.97471718]


portfolio before change:  [-6.00150394]
curr_Stock_Price:  103.96272736025746
curr_Factors:  [103.96272736]
mat_Sqrt:  [[0.15]]
grads:  [-0.08491943]
Stock Position:  -0.0849194346719801
Bond Position:  [2.82695209]


portfolio before change:  [-6.00388734]
curr_Stock_Price:  103.99495544878363
curr_Factors:  [103.99495545]
mat_Sqrt:  [[0.15]]
grads:  [4.0661993e-05]
Stock Position:  4.066199302421118e-05
Bond Position:  [-6.00811598]


portfolio before change:  [-6.00465382]
curr_Stock_Price:  103.61579775623056
curr_Factors:  [103.61579776]
mat_Sqrt:  [[0.15]]
grads:  [0.00329819]
Stock Position:  0.003298191300774208
Bond Position:  [-6.34639854]


portfolio before change:  [-6.00566864]
curr_Stock_Price:  103.5486483237602
curr_Factors:  [103.54864832]
mat_Sqrt:  [[0.15]]
grads:  [-0.19059821]
Stock Position:  -0.19059821179925082
Bond Position:  [13.73051856]


portfolio before change:  [-5.80001059]
curr_Stock_Price:  102.47864020688411
curr_Factors:  [102.47864021]
mat_Sqrt:  [[0.15]]
grads:  [0.02836498]
Stock Position:  0.02836498379107944
Bond Position:  [-8.70681555]


portfolio before change:  [-5.7867937]
curr_Stock_Price:  102.98296995047806
curr_Factors:  [102.98296995]
mat_Sqrt:  [[0.15]]
grads:  [-0.00946046]
Stock Position:  -0.009460458381696039
Bond Position:  [-4.8125276]


portfolio before change:  [-5.78462774]
curr_Stock_Price:  102.69042929240383
curr_Factors:  [102.69042929]
mat_Sqrt:  [[0.15]]
grads:  [-0.01570457]
Stock Position:  -0.01570457065803077
Bond Position:  [-4.17191863]


portfolio before change:  [-5.78150331]
curr_Stock_Price:  102.45827115415342
curr_Factors:  [102.45827115]
mat_Sqrt:  [[0.15]]
grads:  [-0.0173879]
Stock Position:  -0.017387901411284858
Bond Position:  [-3.999969]


portfolio before change:  [-5.76235493]
curr_Stock_Price:  101.32826635880735
curr_Factors:  [101.32826636]
mat_Sqrt:  [[0.15]]
grads:  [0.00032266]
Stock Position:  0.0003226571126023539
Bond Position:  [-5.79504922]


portfolio before change:  [-5.76299162]
curr_Stock_Price:  101.60017242207364
curr_Factors:  [101.60017242]
mat_Sqrt:  [[0.15]]
grads:  [-0.10186369]
Stock Position:  -0.101863689532848
Bond Position:  [4.5863768]


portfolio before change:  [-5.79719828]
curr_Stock_Price:  101.94160902194139
curr_Factors:  [101.94160902]
mat_Sqrt:  [[0.15]]
grads:  [0.03191986]
Stock Position:  0.03191985902863353
Bond Position:  [-9.05116007]


portfolio before change:  [-5.79572097]
curr_Stock_Price:  102.02333804802751
curr_Factors:  [102.02333805]
mat_Sqrt:  [[0.15]]
grads:  [0.05250252]
Stock Position:  0.052502517516398374
Bond Position:  [-11.15220306]


portfolio before change:  [-5.86901528]
curr_Stock_Price:  100.65387605764883
curr_Factors:  [100.65387606]
mat_Sqrt:  [[0.15]]
grads:  [-0.02599664]
Stock Position:  -0.025996639464276917
Bond Position:  [-3.25235276]


portfolio before change:  [-5.84518241]
curr_Stock_Price:  99.72146915712644
curr_Factors:  [99.72146916]
mat_Sqrt:  [[0.15]]
grads:  [-0.05328142]
Stock Position:  -0.053281417643735084
Bond Position:  [-0.53188116]


portfolio before change:  [-5.8513789]
curr_Stock_Price:  99.83651872294952
curr_Factors:  [99.83651872]
mat_Sqrt:  [[0.15]]
grads:  [0.09754165]
Stock Position:  0.09754165013592973
Bond Position:  [-15.58959768]


portfolio before change:  [-5.96818693]
curr_Stock_Price:  98.65897860823009
curr_Factors:  [98.65897861]
mat_Sqrt:  [[0.15]]
grads:  [-0.15681067]
Stock Position:  -0.15681067240700913
Bond Position:  [9.50259385]


portfolio before change:  [-5.84158965]
curr_Stock_Price:  97.85922830741727
curr_Factors:  [97.85922831]
mat_Sqrt:  [[0.15]]
grads:  [-0.21389788]
Stock Position:  -0.2138978841522193
Bond Position:  [15.09029223]


portfolio before change:  [-6.05706421]
curr_Stock_Price:  98.87541865951567
curr_Factors:  [98.87541866]
mat_Sqrt:  [[0.15]]
grads:  [0.14539298]
Stock Position:  0.14539297642606852
Bond Position:  [-20.43285562]


portfolio before change:  [-5.94484998]
curr_Stock_Price:  99.66478619204142
curr_Factors:  [99.66478619]
mat_Sqrt:  [[0.15]]
grads:  [0.06192123]
Stock Position:  0.06192122852895184
Bond Position:  [-12.11621598]


portfolio before change:  [-5.89902576]
curr_Stock_Price:  100.42928727349961
curr_Factors:  [100.42928727]
mat_Sqrt:  [[0.15]]
grads:  [0.01971997]
Stock Position:  0.01971996768447032
Bond Position:  [-7.87948806]


portfolio before change:  [-5.91209307]
curr_Stock_Price:  99.81659250216478
curr_Factors:  [99.8165925]
mat_Sqrt:  [[0.15]]
grads:  [-0.08341237]
Stock Position:  -0.08341237382171737
Bond Position:  [2.41384585]


portfolio before change:  [-5.98339882]
curr_Stock_Price:  100.67506820108042
curr_Factors:  [100.6750682]
mat_Sqrt:  [[0.15]]
grads:  [-0.03364184]
Stock Position:  -0.03364183737990768
Bond Position:  [-2.59650455]


portfolio before change:  [-5.98078265]
curr_Stock_Price:  100.58765460847209
curr_Factors:  [100.58765461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03977492]
Stock Position:  -0.039774916245736175
Bond Position:  [-1.97991711]


portfolio before change:  [-5.94076159]
curr_Stock_Price:  99.57524345773847
curr_Factors:  [99.57524346]
mat_Sqrt:  [[0.15]]
grads:  [-0.04993265]
Stock Position:  -0.04993265149138282
Bond Position:  [-0.96870566]


portfolio before change:  [-5.9325508]
curr_Stock_Price:  99.40838105932983
curr_Factors:  [99.40838106]
mat_Sqrt:  [[0.15]]
grads:  [0.15010539]
Stock Position:  0.15010538792671474
Bond Position:  [-20.8542844]


portfolio before change:  [-5.94107978]
curr_Stock_Price:  99.36892858132929
curr_Factors:  [99.36892858]
mat_Sqrt:  [[0.15]]
grads:  [0.05473447]
Stock Position:  0.05473447017917153
Bond Position:  [-11.37998544]


portfolio before change:  [-5.83195692]
curr_Stock_Price:  101.38859638012048
curr_Factors:  [101.38859638]
mat_Sqrt:  [[0.15]]
grads:  [0.15306315]
Stock Position:  0.15306314799469434
Bond Position:  [-21.35081465]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.83195692]
Stock Price:  101.68809728096547
PL:  [-7.5200542]
Settle:  Tensor("sub_240:0", shape=(), dtype=float64)
PL:  Tensor("sub_241:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  121
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.20909370e-03]
 [ 5.10637718e-03]
 [-4.36791502e-02]
 [-2.99762420e-02]
 [-1.50917010e-02]
 [ 2.48604685e-02]
 [ 1.98924149e-03]
 [-1.03903993e-02]
 [-8.00297789e-03]
 [ 2.72854168e-03]
 [-6.80558706e-02]
 [-1.06029821e-02]
 [ 1.00143725e-02]
 [ 5.31790292e-03]
 [ 8.39367825e-03]
 [-1.22312735e-02]
 [-9.00539755e-03]
 [-6.64487579e-05]
 [-7.57938840e-03]
 [-2.46108975e-03]
 [ 8.00108614e-04]
 [ 1.30674257e-02]
 [ 4.75680771e-03]
 [ 5.42657603e-03]
 [ 1.69208833e-03]
 [-2.42036869e-03]
 [ 8.50996017e-04]
 [-1.83762065e-02]
 [-2.98616269e-02]
 [ 2.19015407e-02]
 [ 3.50390243e-03]
 [-5.44669063e-03]
 [-1.25176409e-02]
 [-1.03026157e-02]
 [-7.14635999e-03]
 [-7.35054458e-03]
 [ 2.13777368e-02]
 [ 8.98101086e-03]
 [ 2.14324541e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.31907663]
curr_Stock_Price:  99.7900469367707
curr_Factors:  [99.79004694]
mat_Sqrt:  [[0.15]]
grads:  [-0.01472729]
Stock Position:  -0.014727291329793833
Bond Position:  [0.15056046]


portfolio before change:  [-1.31489203]
curr_Stock_Price:  99.50718615671958
curr_Factors:  [99.50718616]
mat_Sqrt:  [[0.15]]
grads:  [0.03404251]
Stock Position:  0.034042514521991474
Bond Position:  [-4.70236686]


portfolio before change:  [-1.387193]
curr_Stock_Price:  97.40061061978642
curr_Factors:  [97.40061062]
mat_Sqrt:  [[0.15]]
grads:  [-0.29119433]
Stock Position:  -0.29119433494269104
Bond Position:  [26.97531304]


portfolio before change:  [-1.36049211]
curr_Stock_Price:  97.32049655556779
curr_Factors:  [97.32049656]
mat_Sqrt:  [[0.15]]
grads:  [-0.19984161]
Stock Position:  -0.19984161327764605
Bond Position:  [18.08819293]


portfolio before change:  [-1.1604302]
curr_Stock_Price:  96.33070897082969
curr_Factors:  [96.33070897]
mat_Sqrt:  [[0.15]]
grads:  [-0.10061134]
Stock Position:  -0.1006113397791077
Bond Position:  [8.5315315]


portfolio before change:  [-1.15460815]
curr_Stock_Price:  96.28344255398908
curr_Factors:  [96.28344255]
mat_Sqrt:  [[0.15]]
grads:  [0.16573646]
Stock Position:  0.16573645678289606
Bond Position:  [-17.11228477]


portfolio before change:  [-1.05405486]
curr_Stock_Price:  96.90305552251715
curr_Factors:  [96.90305552]
mat_Sqrt:  [[0.15]]
grads:  [0.01326161]
Stock Position:  0.013261609946510558
Bond Position:  [-2.33914539]


portfolio before change:  [-1.05879402]
curr_Stock_Price:  96.56774571675159
curr_Factors:  [96.56774572]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926933]
Stock Position:  -0.06926932867464618
Bond Position:  [5.6303889]


portfolio before change:  [-1.00292376]
curr_Stock_Price:  95.77134108817877
curr_Factors:  [95.77134109]
mat_Sqrt:  [[0.15]]
grads:  [-0.05335319]
Stock Position:  -0.05335318593064589
Bond Position:  [4.1067824]


portfolio before change:  [-1.02311592]
curr_Stock_Price:  96.15942538209067
curr_Factors:  [96.15942538]
mat_Sqrt:  [[0.15]]
grads:  [0.01819028]
Stock Position:  0.018190277869462684
Bond Position:  [-2.77228259]


portfolio before change:  [-1.02020326]
curr_Stock_Price:  96.33859907993536
curr_Factors:  [96.33859908]
mat_Sqrt:  [[0.15]]
grads:  [-0.4537058]
Stock Position:  -0.45370580372667485
Bond Position:  [42.68917827]


portfolio before change:  [-1.20484018]
curr_Stock_Price:  96.75731404230228
curr_Factors:  [96.75731404]
mat_Sqrt:  [[0.15]]
grads:  [-0.07068655]
Stock Position:  -0.07068654720868996
Bond Position:  [5.63460026]


portfolio before change:  [-1.21156394]
curr_Stock_Price:  96.86239952251448
curr_Factors:  [96.86239952]
mat_Sqrt:  [[0.15]]
grads:  [0.06676248]
Stock Position:  0.06676248308264061
Bond Position:  [-7.67833825]


portfolio before change:  [-1.23146443]
curr_Stock_Price:  96.57869772403504
curr_Factors:  [96.57869772]
mat_Sqrt:  [[0.15]]
grads:  [0.03545269]
Stock Position:  0.03545268613708138
Bond Position:  [-4.65543869]


portfolio before change:  [-1.22260839]
curr_Stock_Price:  96.84491195129256
curr_Factors:  [96.84491195]
mat_Sqrt:  [[0.15]]
grads:  [0.05595786]
Stock Position:  0.0559578550276724
Bond Position:  [-6.64184193]


portfolio before change:  [-1.20088612]
curr_Stock_Price:  97.24793937647479
curr_Factors:  [97.24793938]
mat_Sqrt:  [[0.15]]
grads:  [-0.08154182]
Stock Position:  -0.08154182308220657
Bond Position:  [6.72888815]


portfolio before change:  [-1.13667557]
curr_Stock_Price:  96.47079970562929
curr_Factors:  [96.47079971]
mat_Sqrt:  [[0.15]]
grads:  [-0.06003598]
Stock Position:  -0.06003598369230509
Bond Position:  [4.65504379]


portfolio before change:  [-1.17295356]
curr_Stock_Price:  97.08476330985877
curr_Factors:  [97.08476331]
mat_Sqrt:  [[0.15]]
grads:  [-0.00044299]
Stock Position:  -0.00044299171908013176
Bond Position:  [-1.12994582]


portfolio before change:  [-1.17326975]
curr_Stock_Price:  97.47966131728971
curr_Factors:  [97.47966132]
mat_Sqrt:  [[0.15]]
grads:  [-0.05052926]
Stock Position:  -0.0505292560300953
Bond Position:  [3.75230501]


portfolio before change:  [-1.16706078]
curr_Stock_Price:  97.36606568145518
curr_Factors:  [97.36606568]
mat_Sqrt:  [[0.15]]
grads:  [-0.01640727]
Stock Position:  -0.01640726501980418
Bond Position:  [0.43045006]


portfolio before change:  [-1.14319998]
curr_Stock_Price:  95.91506279761417
curr_Factors:  [95.9150628]
mat_Sqrt:  [[0.15]]
grads:  [0.00533406]
Stock Position:  0.005334057429913729
Bond Position:  [-1.65481644]


portfolio before change:  [-1.13886386]
curr_Stock_Price:  96.76675723628
curr_Factors:  [96.76675724]
mat_Sqrt:  [[0.15]]
grads:  [0.08711617]
Stock Position:  0.08711617144256874
Bond Position:  [-9.56881328]


portfolio before change:  [-1.20567308]
curr_Stock_Price:  96.01359010905605
curr_Factors:  [96.01359011]
mat_Sqrt:  [[0.15]]
grads:  [0.03171205]
Stock Position:  0.03171205140847229
Bond Position:  [-4.25046098]


portfolio before change:  [-1.204051]
curr_Stock_Price:  96.08149549957358
curr_Factors:  [96.0814955]
mat_Sqrt:  [[0.15]]
grads:  [0.03617717]
Stock Position:  0.036177173507368696
Bond Position:  [-4.68000793]


portfolio before change:  [-1.22372077]
curr_Stock_Price:  95.55396031576062
curr_Factors:  [95.55396032]
mat_Sqrt:  [[0.15]]
grads:  [0.01128059]
Stock Position:  0.01128058885816901
Bond Position:  [-2.30162571]


portfolio before change:  [-1.22586399]
curr_Stock_Price:  95.38947439228323
curr_Factors:  [95.38947439]
mat_Sqrt:  [[0.15]]
grads:  [-0.01613579]
Stock Position:  -0.01613579127450238
Bond Position:  [0.31332066]


portfolio before change:  [-1.23275747]
curr_Stock_Price:  95.81911878024037
curr_Factors:  [95.81911878]
mat_Sqrt:  [[0.15]]
grads:  [0.00567331]
Stock Position:  0.0056733067803226445
Bond Position:  [-1.77636873]


portfolio before change:  [-1.2313543]
curr_Stock_Price:  96.10558754604628
curr_Factors:  [96.10558755]
mat_Sqrt:  [[0.15]]
grads:  [-0.12250804]
Stock Position:  -0.12250804346592484
Bond Position:  [10.54235319]


portfolio before change:  [-1.33471132]
curr_Stock_Price:  96.96002039521937
curr_Factors:  [96.9600204]
mat_Sqrt:  [[0.15]]
grads:  [-0.19907751]
Stock Position:  -0.19907751276468355
Bond Position:  [17.96784837]


portfolio before change:  [-1.31808607]
curr_Stock_Price:  96.88779157917223
curr_Factors:  [96.88779158]
mat_Sqrt:  [[0.15]]
grads:  [0.14601027]
Stock Position:  0.1460102715147209
Bond Position:  [-15.46469883]


portfolio before change:  [-1.26380406]
curr_Stock_Price:  97.27280020753459
curr_Factors:  [97.27280021]
mat_Sqrt:  [[0.15]]
grads:  [0.02335935]
Stock Position:  0.023359349550048196
Bond Position:  [-3.53603341]


portfolio before change:  [-1.27036668]
curr_Stock_Price:  97.0107818070818
curr_Factors:  [97.01078181]
mat_Sqrt:  [[0.15]]
grads:  [-0.03631127]
Stock Position:  -0.036311270864874
Bond Position:  [2.2522181]


portfolio before change:  [-1.26091405]
curr_Stock_Price:  96.75821334982534
curr_Factors:  [96.75821335]
mat_Sqrt:  [[0.15]]
grads:  [-0.08345094]
Stock Position:  -0.08345093901166828
Bond Position:  [6.81364971]


portfolio before change:  [-1.29006449]
curr_Stock_Price:  97.11773240075046
curr_Factors:  [97.1177324]
mat_Sqrt:  [[0.15]]
grads:  [-0.0686841]
Stock Position:  -0.06868410487438933
Bond Position:  [5.38038003]


portfolio before change:  [-1.28103449]
curr_Stock_Price:  96.99605344691633
curr_Factors:  [96.99605345]
mat_Sqrt:  [[0.15]]
grads:  [-0.0476424]
Stock Position:  -0.047642399933799644
Bond Position:  [3.34009028]


portfolio before change:  [-1.32027326]
curr_Stock_Price:  97.82842758324824
curr_Factors:  [97.82842758]
mat_Sqrt:  [[0.15]]
grads:  [-0.04900363]
Stock Position:  -0.049003630561597164
Bond Position:  [3.47367487]


portfolio before change:  [-1.32565005]
curr_Stock_Price:  97.94701118491618
curr_Factors:  [97.94701118]
mat_Sqrt:  [[0.15]]
grads:  [0.14251825]
Stock Position:  0.1425182450734128
Bond Position:  [-15.28488619]


portfolio before change:  [-1.49741988]
curr_Stock_Price:  96.75517010538131
curr_Factors:  [96.75517011]
mat_Sqrt:  [[0.15]]
grads:  [0.05987341]
Stock Position:  0.05987340575545235
Bond Position:  [-7.29048143]


portfolio before change:  [-1.50922491]
curr_Stock_Price:  96.57322504593563
curr_Factors:  [96.57322505]
mat_Sqrt:  [[0.15]]
grads:  [0.14288303]
Stock Position:  0.14288302742747158
Bond Position:  [-15.30789968]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.50922491]
Stock Price:  95.55585867391235
PL:  [-1.50922491]
Settle:  Tensor("sub_242:0", shape=(), dtype=float64)
PL:  Tensor("sub_243:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  122
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.44350856e-03]
 [-6.95753595e-03]
 [-3.29601186e-02]
 [-2.92196705e-02]
 [ 1.01581381e-02]
 [ 2.44699712e-02]
 [ 2.47688952e-03]
 [-9.05078863e-03]
 [ 7.33499394e-03]
 [-1.27041014e-03]
 [ 1.03270871e-02]
 [ 2.98036185e-03]
 [ 6.21665175e-03]
 [ 1.07968852e-02]
 [ 3.48024977e-03]
 [-1.25594987e-02]
 [-5.94998443e-03]
 [-2.20182791e-03]
 [-7.82947073e-03]
 [-2.38898071e-03]
 [ 3.86570196e-04]
 [ 8.48295917e-03]
 [ 4.76653147e-03]
 [ 6.06966404e-03]
 [-4.78401819e-03]
 [-1.31259687e-03]
 [-5.42828248e-03]
 [ 1.09007152e-03]
 [ 3.82880231e-02]
 [ 2.68752824e-02]
 [-3.09471467e-02]
 [ 4.71749830e-03]
 [-1.31843496e-02]
 [ 4.04802383e-03]
 [-6.85505318e-03]
 [ 6.07032017e-03]
 [ 2.49155259e-02]
 [ 8.61224264e-03]
 [ 1.84811819e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.91428378]
curr_Stock_Price:  98.97863761289558
curr_Factors:  [98.97863761]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629006]
Stock Position:  -0.03629005705665756
Bond Position:  [-10.32234337]


portfolio before change:  [-13.89332282]
curr_Stock_Price:  98.36548526343738
curr_Factors:  [98.36548526]
mat_Sqrt:  [[0.15]]
grads:  [-0.04638357]
Stock Position:  -0.04638357297343646
Bond Position:  [-9.33078015]


portfolio before change:  [-13.88353097]
curr_Stock_Price:  98.12923206063276
curr_Factors:  [98.12923206]
mat_Sqrt:  [[0.15]]
grads:  [-0.21973412]
Stock Position:  -0.2197341240497527
Bond Position:  [7.67880988]


portfolio before change:  [-13.7530384]
curr_Stock_Price:  97.53973480257955
curr_Factors:  [97.5397348]
mat_Sqrt:  [[0.15]]
grads:  [-0.1947978]
Stock Position:  -0.19479780314802145
Bond Position:  [5.24748766]


portfolio before change:  [-13.83079796]
curr_Stock_Price:  97.94228318675547
curr_Factors:  [97.94228319]
mat_Sqrt:  [[0.15]]
grads:  [0.06772092]
Stock Position:  0.06772092070012269
Bond Position:  [-20.46353955]


portfolio before change:  [-13.89348176]
curr_Stock_Price:  97.0544379931223
curr_Factors:  [97.05443799]
mat_Sqrt:  [[0.15]]
grads:  [0.16313314]
Stock Position:  0.16313314118690558
Bond Position:  [-29.72627709]


portfolio before change:  [-13.89443588]
curr_Stock_Price:  97.07136827354685
curr_Factors:  [97.07136827]
mat_Sqrt:  [[0.15]]
grads:  [0.0165126]
Stock Position:  0.016512596826556147
Bond Position:  [-15.49733625]


portfolio before change:  [-13.89761122]
curr_Stock_Price:  96.99639210550767
curr_Factors:  [96.99639211]
mat_Sqrt:  [[0.15]]
grads:  [-0.06033859]
Stock Position:  -0.06033859086174073
Bond Position:  [-8.0449856]


portfolio before change:  [-13.92660658]
curr_Stock_Price:  97.46026889449635
curr_Factors:  [97.46026889]
mat_Sqrt:  [[0.15]]
grads:  [0.04889996]
Stock Position:  0.048899959628766906
Bond Position:  [-18.69240979]


portfolio before change:  [-13.86942826]
curr_Stock_Price:  98.67734601313155
curr_Factors:  [98.67734601]
mat_Sqrt:  [[0.15]]
grads:  [-0.0084694]
Stock Position:  -0.00846940094526541
Bond Position:  [-13.03369025]


portfolio before change:  [-13.87420972]
curr_Stock_Price:  99.04952731932156
curr_Factors:  [99.04952732]
mat_Sqrt:  [[0.15]]
grads:  [0.06884725]
Stock Position:  0.0688472472801881
Bond Position:  [-20.69349702]


portfolio before change:  [-13.89794827]
curr_Stock_Price:  98.74230073887094
curr_Factors:  [98.74230074]
mat_Sqrt:  [[0.15]]
grads:  [0.01986908]
Stock Position:  0.01986907899388282
Bond Position:  [-15.85986685]


portfolio before change:  [-13.91004015]
curr_Stock_Price:  98.23350650712804
curr_Factors:  [98.23350651]
mat_Sqrt:  [[0.15]]
grads:  [0.04144435]
Stock Position:  0.041444345023529595
Bond Position:  [-17.98126349]


portfolio before change:  [-13.90497081]
curr_Stock_Price:  98.41005990257007
curr_Factors:  [98.4100599]
mat_Sqrt:  [[0.15]]
grads:  [0.07197923]
Stock Position:  0.07197923472831719
Bond Position:  [-20.98845161]


portfolio before change:  [-13.95947458]
curr_Stock_Price:  97.68929588666536
curr_Factors:  [97.68929589]
mat_Sqrt:  [[0.15]]
grads:  [0.02320167]
Stock Position:  0.02320166515488204
Bond Position:  [-16.22602891]


portfolio before change:  [-13.96869997]
curr_Stock_Price:  97.37910187390587
curr_Factors:  [97.37910187]
mat_Sqrt:  [[0.15]]
grads:  [-0.08372999]
Stock Position:  -0.08372999122331115
Bond Position:  [-5.81514863]


portfolio before change:  [-13.98608768]
curr_Stock_Price:  97.57808389993401
curr_Factors:  [97.5780839]
mat_Sqrt:  [[0.15]]
grads:  [-0.03966656]
Stock Position:  -0.03966656289898142
Bond Position:  [-10.11550047]


portfolio before change:  [-14.01774925]
curr_Stock_Price:  98.34439829941417
curr_Factors:  [98.3443983]
mat_Sqrt:  [[0.15]]
grads:  [-0.01467885]
Stock Position:  -0.014678852744185195
Bond Position:  [-12.57416631]


portfolio before change:  [-14.02938819]
curr_Stock_Price:  99.03021972058511
curr_Factors:  [99.03021972]
mat_Sqrt:  [[0.15]]
grads:  [-0.05219647]
Stock Position:  -0.05219647152180491
Bond Position:  [-8.86036015]


portfolio before change:  [-14.01897974]
curr_Stock_Price:  98.80959059010632
curr_Factors:  [98.80959059]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592654]
Stock Position:  -0.015926538063009817
Bond Position:  [-12.44528504]


portfolio before change:  [-14.03744589]
curr_Stock_Price:  99.87136456293577
curr_Factors:  [99.87136456]
mat_Sqrt:  [[0.15]]
grads:  [0.00257713]
Stock Position:  0.0025771346374374032
Bond Position:  [-14.29482784]


portfolio before change:  [-14.04166041]
curr_Stock_Price:  98.92940356352264
curr_Factors:  [98.92940356]
mat_Sqrt:  [[0.15]]
grads:  [0.05655306]
Stock Position:  0.05655306112659096
Bond Position:  [-19.63642102]


portfolio before change:  [-14.01681479]
curr_Stock_Price:  99.41214178091232
curr_Factors:  [99.41214178]
mat_Sqrt:  [[0.15]]
grads:  [0.03177688]
Stock Position:  0.03177687648140483
Bond Position:  [-17.17582214]


portfolio before change:  [-14.01408143]
curr_Stock_Price:  99.56572753522146
curr_Factors:  [99.56572754]
mat_Sqrt:  [[0.15]]
grads:  [0.04046443]
Stock Position:  0.04046442690238593
Bond Position:  [-18.04295153]


portfolio before change:  [-13.90247247]
curr_Stock_Price:  102.37966744802155
curr_Factors:  [102.37966745]
mat_Sqrt:  [[0.15]]
grads:  [-0.03189345]
Stock Position:  -0.031893454581567476
Bond Position:  [-10.6372312]


portfolio before change:  [-13.9394666]
curr_Stock_Price:  103.49790291279004
curr_Factors:  [103.49790291]
mat_Sqrt:  [[0.15]]
grads:  [-0.00875065]
Stock Position:  -0.008750645770849864
Bond Position:  [-13.03379312]


portfolio before change:  [-13.94503386]
curr_Stock_Price:  103.94791906661571
curr_Factors:  [103.94791907]
mat_Sqrt:  [[0.15]]
grads:  [-0.03618855]
Stock Position:  -0.036188549839728475
Bond Position:  [-10.18330941]


portfolio before change:  [-13.97519418]
curr_Stock_Price:  104.74616386959377
curr_Factors:  [104.74616387]
mat_Sqrt:  [[0.15]]
grads:  [0.00726714]
Stock Position:  0.007267143495660391
Bond Position:  [-14.73639958]


portfolio before change:  [-13.97499505]
curr_Stock_Price:  105.02705630510948
curr_Factors:  [105.02705631]
mat_Sqrt:  [[0.15]]
grads:  [0.25525349]
Stock Position:  0.2552534875095241
Bond Position:  [-40.78351746]


portfolio before change:  [-13.57734063]
curr_Stock_Price:  106.60491009219056
curr_Factors:  [106.60491009]
mat_Sqrt:  [[0.15]]
grads:  [0.17916855]
Stock Position:  0.1791685490000359
Bond Position:  [-32.67758769]


portfolio before change:  [-13.52860473]
curr_Stock_Price:  106.89972106719827
curr_Factors:  [106.89972107]
mat_Sqrt:  [[0.15]]
grads:  [-0.20631431]
Stock Position:  -0.2063143114549435
Bond Position:  [8.52633762]


portfolio before change:  [-13.45589066]
curr_Stock_Price:  106.55244406407712
curr_Factors:  [106.55244406]
mat_Sqrt:  [[0.15]]
grads:  [0.03144999]
Stock Position:  0.03144998863843284
Bond Position:  [-16.80696381]


portfolio before change:  [-13.45469299]
curr_Stock_Price:  106.65733033909777
curr_Factors:  [106.65733034]
mat_Sqrt:  [[0.15]]
grads:  [-0.08789566]
Stock Position:  -0.0878956639996297
Bond Position:  [-4.07997611]


portfolio before change:  [-13.42523205]
curr_Stock_Price:  106.31634691450799
curr_Factors:  [106.31634691]
mat_Sqrt:  [[0.15]]
grads:  [0.02698683]
Stock Position:  0.026986825563376275
Bond Position:  [-16.29437276]


portfolio before change:  [-13.42167614]
curr_Stock_Price:  106.52359013077373
curr_Factors:  [106.52359013]
mat_Sqrt:  [[0.15]]
grads:  [-0.04570035]
Stock Position:  -0.04570035456175639
Bond Position:  [-8.5535103]


portfolio before change:  [-13.46358813]
curr_Stock_Price:  107.41729726917606
curr_Factors:  [107.41729727]
mat_Sqrt:  [[0.15]]
grads:  [0.0404688]
Stock Position:  0.04046880111303058
Bond Position:  [-17.81063736]


portfolio before change:  [-13.42770378]
curr_Stock_Price:  108.35903056639911
curr_Factors:  [108.35903057]
mat_Sqrt:  [[0.15]]
grads:  [0.16610351]
Stock Position:  0.16610350628578655
Bond Position:  [-31.42651869]


portfolio before change:  [-13.54057798]
curr_Stock_Price:  107.70314049699148
curr_Factors:  [107.7031405]
mat_Sqrt:  [[0.15]]
grads:  [0.05741495]
Stock Position:  0.057414950902799494
Bond Position:  [-19.7243485]


portfolio before change:  [-13.53611828]
curr_Stock_Price:  107.82376051442577
curr_Factors:  [107.82376051]
mat_Sqrt:  [[0.15]]
grads:  [0.12320788]
Stock Position:  0.12320787903440127
Bond Position:  [-26.82085513]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.53611828]
Stock Price:  106.75674437575398
PL:  [-20.29286266]
Settle:  Tensor("sub_244:0", shape=(), dtype=float64)
PL:  Tensor("sub_245:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  123
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.69667274e-03]
 [-1.45192692e-02]
 [ 1.73055281e-02]
 [-9.66930143e-03]
 [ 1.51051095e-02]
 [ 2.17138660e-02]
 [ 1.45773522e-02]
 [-3.93691824e-03]
 [ 1.78107588e-02]
 [-3.96487716e-03]
 [ 7.69515269e-03]
 [ 1.18826096e-02]
 [-9.96222144e-03]
 [ 1.13643778e-02]
 [-6.98969549e-03]
 [-2.79076500e-02]
 [ 4.44403367e-03]
 [-1.12197205e-03]
 [ 3.16751952e-03]
 [-3.50649721e-03]
 [-2.45779797e-03]
 [-3.92584365e-02]
 [ 4.84108074e-03]
 [ 1.41748369e-02]
 [-6.48500990e-03]
 [ 2.99354166e-02]
 [-1.91384006e-02]
 [ 1.99747483e-02]
 [ 1.15280712e-01]
 [ 3.00285409e-02]
 [-4.99383921e-02]
 [-2.24887483e-03]
 [-1.35552398e-02]
 [ 1.20586702e-02]
 [-8.95907636e-03]
 [ 1.58765758e-02]
 [ 2.55172500e-02]
 [ 1.91953048e-02]
 [ 1.54728265e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [13.31333602]
curr_Stock_Price:  100.73269725730434
curr_Factors:  [100.73269726]
mat_Sqrt:  [[0.15]]
grads:  [-0.01131115]
Stock Position:  -0.011311151607405647
Bond Position:  [14.45273883]


portfolio before change:  [13.3188291]
curr_Stock_Price:  100.40679088617803
curr_Factors:  [100.40679089]
mat_Sqrt:  [[0.15]]
grads:  [-0.09679513]
Stock Position:  -0.0967951278731359
Bond Position:  [23.03771727]


portfolio before change:  [13.36987271]
curr_Stock_Price:  99.9092068490567
curr_Factors:  [99.90920685]
mat_Sqrt:  [[0.15]]
grads:  [0.11537019]
Stock Position:  0.11537018707107288
Bond Position:  [1.84332882]


portfolio before change:  [13.30241304]
curr_Stock_Price:  99.32248597958423
curr_Factors:  [99.32248598]
mat_Sqrt:  [[0.15]]
grads:  [-0.06446201]
Stock Position:  -0.0644620095650506
Bond Position:  [19.70494008]


portfolio before change:  [13.36688941]
curr_Stock_Price:  98.36047595128377
curr_Factors:  [98.36047595]
mat_Sqrt:  [[0.15]]
grads:  [0.10070073]
Stock Position:  0.10070073008556862
Bond Position:  [3.46191767]


portfolio before change:  [13.41245439]
curr_Stock_Price:  98.8086575400566
curr_Factors:  [98.80865754]
mat_Sqrt:  [[0.15]]
grads:  [0.14475911]
Stock Position:  0.14475910699020952
Bond Position:  [-0.89099863]


portfolio before change:  [13.39005779]
curr_Stock_Price:  98.65471058658581
curr_Factors:  [98.65471059]
mat_Sqrt:  [[0.15]]
grads:  [0.09718235]
Stock Position:  0.09718234771138973
Bond Position:  [3.8025614]


portfolio before change:  [13.36738893]
curr_Stock_Price:  98.41655815065903
curr_Factors:  [98.41655815]
mat_Sqrt:  [[0.15]]
grads:  [-0.02624612]
Stock Position:  -0.026246121586315573
Bond Position:  [15.95044188]


portfolio before change:  [13.35168486]
curr_Stock_Price:  99.0908672097236
curr_Factors:  [99.09086721]
mat_Sqrt:  [[0.15]]
grads:  [0.11873839]
Stock Position:  0.11873839206313241
Bond Position:  [1.58579462]


portfolio before change:  [13.4343276]
curr_Stock_Price:  99.78520457944583
curr_Factors:  [99.78520458]
mat_Sqrt:  [[0.15]]
grads:  [-0.02643251]
Stock Position:  -0.026432514396412896
Bond Position:  [16.07190145]


portfolio before change:  [13.4257896]
curr_Stock_Price:  100.18422497341615
curr_Factors:  [100.18422497]
mat_Sqrt:  [[0.15]]
grads:  [0.05130102]
Stock Position:  0.051301017907246574
Bond Position:  [8.28623688]


portfolio before change:  [13.42280357]
curr_Stock_Price:  100.10582746927471
curr_Factors:  [100.10582747]
mat_Sqrt:  [[0.15]]
grads:  [0.0792174]
Stock Position:  0.07921739727530548
Bond Position:  [5.49268047]


portfolio before change:  [13.46013931]
curr_Stock_Price:  100.56846711540548
curr_Factors:  [100.56846712]
mat_Sqrt:  [[0.15]]
grads:  [-0.06641481]
Stock Position:  -0.06641480959689856
Bond Position:  [20.1393749]


portfolio before change:  [13.3664801]
curr_Stock_Price:  102.01658979225573
curr_Factors:  [102.01658979]
mat_Sqrt:  [[0.15]]
grads:  [0.07576252]
Stock Position:  0.07576251838976561
Bond Position:  [5.63744633]


portfolio before change:  [13.30947771]
curr_Stock_Price:  101.25490563564686
curr_Factors:  [101.25490564]
mat_Sqrt:  [[0.15]]
grads:  [-0.04659797]
Stock Position:  -0.046597969936349376
Bond Position:  [18.02775076]


portfolio before change:  [13.30446094]
curr_Stock_Price:  101.41092913913427
curr_Factors:  [101.41092914]
mat_Sqrt:  [[0.15]]
grads:  [-0.186051]
Stock Position:  -0.18605099995610694
Bond Position:  [32.17206571]


portfolio before change:  [13.26442905]
curr_Stock_Price:  101.6477118056927
curr_Factors:  [101.64771181]
mat_Sqrt:  [[0.15]]
grads:  [0.02962689]
Stock Position:  0.029626891148666363
Bond Position:  [10.25292336]


portfolio before change:  [13.30326523]
curr_Stock_Price:  102.9152929774924
curr_Factors:  [102.91529298]
mat_Sqrt:  [[0.15]]
grads:  [-0.00747981]
Stock Position:  -0.00747981365775002
Bond Position:  [14.07305245]


portfolio before change:  [13.29771917]
curr_Stock_Price:  103.89196194760972
curr_Factors:  [103.89196195]
mat_Sqrt:  [[0.15]]
grads:  [0.0211168]
Stock Position:  0.021116796787326253
Bond Position:  [11.10385373]


portfolio before change:  [13.3125629]
curr_Stock_Price:  104.52916345136846
curr_Factors:  [104.52916345]
mat_Sqrt:  [[0.15]]
grads:  [-0.02337665]
Stock Position:  -0.023376648037461506
Bond Position:  [15.75610436]


portfolio before change:  [13.28751531]
curr_Stock_Price:  105.68489894862326
curr_Factors:  [105.68489895]
mat_Sqrt:  [[0.15]]
grads:  [-0.01638532]
Stock Position:  -0.016385319793625272
Bond Position:  [15.01919618]


portfolio before change:  [13.27524215]
curr_Stock_Price:  106.54851805562522
curr_Factors:  [106.54851806]
mat_Sqrt:  [[0.15]]
grads:  [-0.26172291]
Stock Position:  -0.2617229101577516
Bond Position:  [41.16143037]


portfolio before change:  [13.2527796]
curr_Stock_Price:  106.65400385343867
curr_Factors:  [106.65400385]
mat_Sqrt:  [[0.15]]
grads:  [0.03227387]
Stock Position:  0.032273871629090185
Bond Position:  [9.81064197]


portfolio before change:  [13.29729969]
curr_Stock_Price:  107.99545054409634
curr_Factors:  [107.99545054]
mat_Sqrt:  [[0.15]]
grads:  [0.09449891]
Stock Position:  0.09449891280379862
Bond Position:  [3.09184702]


portfolio before change:  [13.40803508]
curr_Stock_Price:  109.16317708250523
curr_Factors:  [109.16317708]
mat_Sqrt:  [[0.15]]
grads:  [-0.0432334]
Stock Position:  -0.04323339935073114
Bond Position:  [18.12753031]


portfolio before change:  [13.3874999]
curr_Stock_Price:  109.69057642043259
curr_Factors:  [109.69057642]
mat_Sqrt:  [[0.15]]
grads:  [0.19956944]
Stock Position:  0.1995694437633694
Bond Position:  [-8.50338742]


portfolio before change:  [13.37937723]
curr_Stock_Price:  109.65520188612712
curr_Factors:  [109.65520189]
mat_Sqrt:  [[0.15]]
grads:  [-0.12758934]
Stock Position:  -0.12758933732000818
Bond Position:  [27.37021177]


portfolio before change:  [13.3475591]
curr_Stock_Price:  109.93139757734022
curr_Factors:  [109.93139758]
mat_Sqrt:  [[0.15]]
grads:  [0.13316499]
Stock Position:  0.1331649886781942
Bond Position:  [-1.29145422]


portfolio before change:  [13.41016824]
curr_Stock_Price:  110.40277207998089
curr_Factors:  [110.40277208]
mat_Sqrt:  [[0.15]]
grads:  [0.76853808]
Stock Position:  0.7685380831109458
Bond Position:  [-71.43856659]


portfolio before change:  [14.20714883]
curr_Stock_Price:  111.45140062558427
curr_Factors:  [111.45140063]
mat_Sqrt:  [[0.15]]
grads:  [0.20019027]
Stock Position:  0.20019027265005024
Bond Position:  [-8.10433745]


portfolio before change:  [13.9618042]
curr_Stock_Price:  110.23090413964555
curr_Factors:  [110.23090414]
mat_Sqrt:  [[0.15]]
grads:  [-0.33292261]
Stock Position:  -0.3329226142071303
Bond Position:  [50.66016497]


portfolio before change:  [13.75227831]
curr_Stock_Price:  110.87927946884491
curr_Factors:  [110.87927947]
mat_Sqrt:  [[0.15]]
grads:  [-0.0149925]
Stock Position:  -0.014992498856958485
Bond Position:  [15.41463578]


portfolio before change:  [13.74202397]
curr_Stock_Price:  111.69177156423906
curr_Factors:  [111.69177156]
mat_Sqrt:  [[0.15]]
grads:  [-0.09036827]
Stock Position:  -0.0903682651888418
Bond Position:  [23.8354156]


portfolio before change:  [13.75955684]
curr_Stock_Price:  111.5307276099055
curr_Factors:  [111.53072761]
mat_Sqrt:  [[0.15]]
grads:  [0.08039113]
Stock Position:  0.08039113449335834
Bond Position:  [4.79347512]


portfolio before change:  [13.77265785]
curr_Stock_Price:  111.68623953358559
curr_Factors:  [111.68623953]
mat_Sqrt:  [[0.15]]
grads:  [-0.05972718]
Stock Position:  -0.05972717573391567
Bond Position:  [20.4433615]


portfolio before change:  [13.76329983]
curr_Stock_Price:  111.88570645206198
curr_Factors:  [111.88570645]
mat_Sqrt:  [[0.15]]
grads:  [0.10584384]
Stock Position:  0.10584383875286721
Bond Position:  [1.92088716]


portfolio before change:  [13.70793578]
curr_Stock_Price:  111.36036481916814
curr_Factors:  [111.36036482]
mat_Sqrt:  [[0.15]]
grads:  [0.170115]
Stock Position:  0.17011499975457212
Bond Position:  [-5.23613265]


portfolio before change:  [13.85511032]
curr_Stock_Price:  112.22935987453576
curr_Factors:  [112.22935987]
mat_Sqrt:  [[0.15]]
grads:  [0.1279687]
Stock Position:  0.1279686986358349
Bond Position:  [-0.50673481]


portfolio before change:  [13.94111044]
curr_Stock_Price:  112.90189516550801
curr_Factors:  [112.90189517]
mat_Sqrt:  [[0.15]]
grads:  [0.10315218]
Stock Position:  0.10315217693929317
Bond Position:  [2.29503417]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.94111044]
Stock Price:  112.89786905973438
PL:  [1.04324138]
Settle:  Tensor("sub_246:0", shape=(), dtype=float64)
PL:  Tensor("sub_247:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  124
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.45764339e-03]
 [ 4.84722927e-03]
 [-1.72755625e-02]
 [-1.78554004e-02]
 [ 1.34751576e-02]
 [ 2.16460023e-02]
 [ 1.18034314e-02]
 [-6.67739660e-03]
 [ 5.61078712e-03]
 [-2.58418048e-05]
 [-1.74874457e-02]
 [ 4.57397573e-03]
 [ 2.29998957e-03]
 [ 1.05938074e-02]
 [-3.89031686e-03]
 [-1.18204540e-02]
 [ 4.63737502e-03]
 [-3.50395444e-04]
 [-1.06781840e-02]
 [-2.32256083e-03]
 [ 1.93998602e-04]
 [-3.03661174e-02]
 [ 4.80045912e-03]
 [ 8.70696710e-03]
 [-5.07285404e-03]
 [ 3.70661525e-05]
 [-4.96051620e-03]
 [-4.56516727e-03]
 [ 4.02116303e-02]
 [ 2.64126360e-02]
 [-2.16048519e-02]
 [ 5.92016104e-03]
 [-1.30486432e-02]
 [ 2.32782591e-03]
 [-6.07401116e-03]
 [ 8.27942482e-04]
 [ 2.42199135e-02]
 [ 2.46043871e-03]
 [ 1.95772911e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.28633138]
curr_Stock_Price:  99.72773438309194
curr_Factors:  [99.72773438]
mat_Sqrt:  [[0.15]]
grads:  [-0.01638429]
Stock Position:  -0.016384289237064763
Bond Position:  [-0.65236333]


portfolio before change:  [-2.28324255]
curr_Stock_Price:  99.53423340194507
curr_Factors:  [99.5342334]
mat_Sqrt:  [[0.15]]
grads:  [0.03231486]
Stock Position:  0.032314861812682484
Bond Position:  [-5.49967755]


portfolio before change:  [-2.3027534]
curr_Stock_Price:  98.95173544770682
curr_Factors:  [98.95173545]
mat_Sqrt:  [[0.15]]
grads:  [-0.11517042]
Stock Position:  -0.11517041696868283
Bond Position:  [9.09355924]


portfolio before change:  [-2.2822109]
curr_Stock_Price:  98.78323965379546
curr_Factors:  [98.78323965]
mat_Sqrt:  [[0.15]]
grads:  [-0.119036]
Stock Position:  -0.11903600233353819
Bond Position:  [9.47655105]


portfolio before change:  [-2.32821045]
curr_Stock_Price:  99.1796255266487
curr_Factors:  [99.17962553]
mat_Sqrt:  [[0.15]]
grads:  [0.08983438]
Stock Position:  0.08983438417520619
Bond Position:  [-11.23795103]


portfolio before change:  [-2.36020465]
curr_Stock_Price:  98.83911700505146
curr_Factors:  [98.83911701]
mat_Sqrt:  [[0.15]]
grads:  [0.14430668]
Stock Position:  0.14430668208049718
Bond Position:  [-16.62334969]


portfolio before change:  [-2.41801175]
curr_Stock_Price:  98.45293217644581
curr_Factors:  [98.45293218]
mat_Sqrt:  [[0.15]]
grads:  [0.07868954]
Stock Position:  0.07868954251286854
Bond Position:  [-10.16522794]


portfolio before change:  [-2.4760241]
curr_Stock_Price:  97.73185012353457
curr_Factors:  [97.73185012]
mat_Sqrt:  [[0.15]]
grads:  [-0.04451598]
Stock Position:  -0.04451597734837615
Bond Position:  [1.87460473]


portfolio before change:  [-2.45226817]
curr_Stock_Price:  97.20346482422015
curr_Factors:  [97.20346482]
mat_Sqrt:  [[0.15]]
grads:  [0.03740525]
Stock Position:  0.0374052474495864
Bond Position:  [-6.08818783]


portfolio before change:  [-2.43142893]
curr_Stock_Price:  97.78093218012388
curr_Factors:  [97.78093218]
mat_Sqrt:  [[0.15]]
grads:  [-0.00017228]
Stock Position:  -0.0001722786985313846
Bond Position:  [-2.41458336]


portfolio before change:  [-2.431704]
curr_Stock_Price:  97.62553423387803
curr_Factors:  [97.62553423]
mat_Sqrt:  [[0.15]]
grads:  [-0.11658297]
Stock Position:  -0.11658297161163562
Bond Position:  [8.94977088]


portfolio before change:  [-2.59107236]
curr_Stock_Price:  99.00212591758448
curr_Factors:  [99.00212592]
mat_Sqrt:  [[0.15]]
grads:  [0.03049317]
Stock Position:  0.03049317151807283
Bond Position:  [-5.60996117]


portfolio before change:  [-2.6029515]
curr_Stock_Price:  98.63555686231862
curr_Factors:  [98.63555686]
mat_Sqrt:  [[0.15]]
grads:  [0.01533326]
Stock Position:  0.015333263776758173
Bond Position:  [-4.11535651]


portfolio before change:  [-2.60168937]
curr_Stock_Price:  98.75142149533286
curr_Factors:  [98.7514215]
mat_Sqrt:  [[0.15]]
grads:  [0.07062538]
Stock Position:  0.0706253826719028
Bond Position:  [-9.5760463]


portfolio before change:  [-2.57103053]
curr_Stock_Price:  99.2024763572622
curr_Factors:  [99.20247636]
mat_Sqrt:  [[0.15]]
grads:  [-0.02593545]
Stock Position:  -0.025935445711091135
Bond Position:  [0.00182991]


portfolio before change:  [-2.58183226]
curr_Stock_Price:  99.61897041643378
curr_Factors:  [99.61897042]
mat_Sqrt:  [[0.15]]
grads:  [-0.07880303]
Stock Position:  -0.07880302690268626
Bond Position:  [5.26844414]


portfolio before change:  [-2.68578859]
curr_Stock_Price:  100.94652006098396
curr_Factors:  [100.94652006]
mat_Sqrt:  [[0.15]]
grads:  [0.03091583]
Stock Position:  0.030915833437684337
Bond Position:  [-5.8066344]


portfolio before change:  [-2.6797847]
curr_Stock_Price:  101.16420048106608
curr_Factors:  [101.16420048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00233597]
Stock Position:  -0.0023359696246891505
Bond Position:  [-2.4434682]


portfolio before change:  [-2.67994936]
curr_Stock_Price:  101.10392928892577
curr_Factors:  [101.10392929]
mat_Sqrt:  [[0.15]]
grads:  [-0.07118789]
Stock Position:  -0.0711878931776447
Bond Position:  [4.51742636]


portfolio before change:  [-2.71299007]
curr_Stock_Price:  101.57599590421079
curr_Factors:  [101.5759959]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548374]
Stock Position:  -0.015483738870591044
Bond Position:  [-1.14021388]


portfolio before change:  [-2.70533982]
curr_Stock_Price:  101.0727073881487
curr_Factors:  [101.07270739]
mat_Sqrt:  [[0.15]]
grads:  [0.00129332]
Stock Position:  0.0012933240114869167
Bond Position:  [-2.83605958]


portfolio before change:  [-2.70415548]
curr_Stock_Price:  102.26256127882542
curr_Factors:  [102.26256128]
mat_Sqrt:  [[0.15]]
grads:  [-0.20244078]
Stock Position:  -0.20244078246241745
Bond Position:  [17.99795744]


portfolio before change:  [-2.8501179]
curr_Stock_Price:  102.99468795436802
curr_Factors:  [102.99468795]
mat_Sqrt:  [[0.15]]
grads:  [0.03200306]
Stock Position:  0.03200306077294793
Bond Position:  [-6.14626315]


portfolio before change:  [-2.85275322]
curr_Stock_Price:  102.93635006777869
curr_Factors:  [102.93635007]
mat_Sqrt:  [[0.15]]
grads:  [0.05804645]
Stock Position:  0.05804644731238902
Bond Position:  [-8.82784264]


portfolio before change:  [-2.87130312]
curr_Stock_Price:  102.63579161908316
curr_Factors:  [102.63579162]
mat_Sqrt:  [[0.15]]
grads:  [-0.03381903]
Stock Position:  -0.03381902690416355
Bond Position:  [0.59973948]


portfolio before change:  [-2.90938718]
curr_Stock_Price:  103.76412210787453
curr_Factors:  [103.76412211]
mat_Sqrt:  [[0.15]]
grads:  [0.00024711]
Stock Position:  0.0002471076830317757
Bond Position:  [-2.9350281]


portfolio before change:  [-2.90974701]
curr_Stock_Price:  103.79277059829259
curr_Factors:  [103.7927706]
mat_Sqrt:  [[0.15]]
grads:  [-0.03307011]
Stock Position:  -0.033070108011630586
Bond Position:  [0.52269113]


portfolio before change:  [-2.90764306]
curr_Stock_Price:  103.7311257413284
curr_Factors:  [103.73112574]
mat_Sqrt:  [[0.15]]
grads:  [-0.03043445]
Stock Position:  -0.030434448443254644
Bond Position:  [0.24935653]


portfolio before change:  [-2.95114043]
curr_Stock_Price:  105.16136471470656
curr_Factors:  [105.16136471]
mat_Sqrt:  [[0.15]]
grads:  [0.26807754]
Stock Position:  0.26807753561641295
Bond Position:  [-31.14253992]


portfolio before change:  [-2.75867532]
curr_Stock_Price:  105.89383253725333
curr_Factors:  [105.89383254]
mat_Sqrt:  [[0.15]]
grads:  [0.17608424]
Stock Position:  0.17608423969402945
Bond Position:  [-21.40491031]


portfolio before change:  [-2.87277867]
curr_Stock_Price:  105.26102419971356
curr_Factors:  [105.2610242]
mat_Sqrt:  [[0.15]]
grads:  [-0.14403235]
Stock Position:  -0.14403234597739273
Bond Position:  [12.28821358]


portfolio before change:  [-2.94965987]
curr_Stock_Price:  105.80546659893999
curr_Factors:  [105.8054666]
mat_Sqrt:  [[0.15]]
grads:  [0.03946774]
Stock Position:  0.03946774026026382
Bond Position:  [-7.12556254]


portfolio before change:  [-2.98963183]
curr_Stock_Price:  104.81526009723957
curr_Factors:  [104.8152601]
mat_Sqrt:  [[0.15]]
grads:  [-0.08699095]
Stock Position:  -0.08699095484384786
Bond Position:  [6.12834773]


portfolio before change:  [-3.02204027]
curr_Stock_Price:  105.19661618850516
curr_Factors:  [105.19661619]
mat_Sqrt:  [[0.15]]
grads:  [0.01551884]
Stock Position:  0.015518839410652286
Bond Position:  [-4.65456966]


portfolio before change:  [-3.03279787]
curr_Stock_Price:  104.54091378900061
curr_Factors:  [104.54091379]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049341]
Stock Position:  -0.040493407703096125
Bond Position:  [1.20041998]


portfolio before change:  [-3.03902838]
curr_Stock_Price:  104.69848434607137
curr_Factors:  [104.69848435]
mat_Sqrt:  [[0.15]]
grads:  [0.00551962]
Stock Position:  0.005519616543380538
Bond Position:  [-3.61692386]


portfolio before change:  [-3.03572257]
curr_Stock_Price:  105.3793193401335
curr_Factors:  [105.37931934]
mat_Sqrt:  [[0.15]]
grads:  [0.16146609]
Stock Position:  0.1614660901343354
Bond Position:  [-20.05090925]


portfolio before change:  [-3.08783382]
curr_Stock_Price:  105.07210481981252
curr_Factors:  [105.07210482]
mat_Sqrt:  [[0.15]]
grads:  [0.01640292]
Stock Position:  0.016402924759025855
Bond Position:  [-4.81132365]


portfolio before change:  [-3.07364948]
curr_Stock_Price:  105.97351690349416
curr_Factors:  [105.9735169]
mat_Sqrt:  [[0.15]]
grads:  [0.13051527]
Stock Position:  0.13051527381888436
Bond Position:  [-16.90481205]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.07364948]
Stock Price:  106.84107830139314
PL:  [-9.91472778]
Settle:  Tensor("sub_248:0", shape=(), dtype=float64)
PL:  Tensor("sub_249:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  125
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44541985e-03]
 [-5.37550482e-03]
 [-1.44409867e-03]
 [ 6.59010832e-02]
 [ 1.84532909e-02]
 [ 1.63730123e-02]
 [ 2.72019121e-02]
 [-2.95294463e-03]
 [ 4.80391099e-03]
 [ 1.19358350e-02]
 [ 2.53472558e-02]
 [-4.05054879e-03]
 [-1.20627437e-02]
 [ 2.12924883e-03]
 [ 7.18007232e-04]
 [-2.90250743e-02]
 [ 4.85516971e-03]
 [-6.08578235e-03]
 [ 5.19216226e-03]
 [-3.03955746e-03]
 [-1.35064936e-03]
 [-3.08511678e-02]
 [ 4.78796020e-03]
 [ 7.94866156e-03]
 [-4.55395545e-03]
 [-4.18577543e-03]
 [-5.35399581e-03]
 [-1.45698996e-03]
 [ 2.16574113e-02]
 [ 2.54216458e-02]
 [-2.16485807e-02]
 [ 4.53996986e-03]
 [-1.31323628e-02]
 [ 3.66866918e-03]
 [-6.41588516e-03]
 [ 1.93347940e-03]
 [ 2.41491093e-02]
 [ 2.15918079e-03]
 [ 2.03988871e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.93631975]
curr_Stock_Price:  100.12861045340047
curr_Factors:  [100.12861045]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963613]
Stock Position:  -0.009636132360500592
Bond Position:  [4.9011723]


portfolio before change:  [3.92758854]
curr_Stock_Price:  101.09828312911344
curr_Factors:  [101.09828313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0358367]
Stock Position:  -0.03583669878303251
Bond Position:  [7.55061726]


portfolio before change:  [3.89388453]
curr_Stock_Price:  102.06511045967542
curr_Factors:  [102.06511046]
mat_Sqrt:  [[0.15]]
grads:  [-0.00962732]
Stock Position:  -0.009627324497849215
Bond Position:  [4.87649847]


portfolio before change:  [3.89027031]
curr_Stock_Price:  102.50384268244265
curr_Factors:  [102.50384268]
mat_Sqrt:  [[0.15]]
grads:  [0.43934055]
Stock Position:  0.43934055470660477
Bond Position:  [-41.14382479]


portfolio before change:  [3.19459819]
curr_Stock_Price:  100.93210335662087
curr_Factors:  [100.93210336]
mat_Sqrt:  [[0.15]]
grads:  [0.12302194]
Stock Position:  0.12302193929332467
Bond Position:  [-9.22226491]


portfolio before change:  [3.03360174]
curr_Stock_Price:  99.6327937491827
curr_Factors:  [99.63279375]
mat_Sqrt:  [[0.15]]
grads:  [0.10915342]
Stock Position:  0.10915341505142916
Bond Position:  [-7.84165795]


portfolio before change:  [3.09568817]
curr_Stock_Price:  100.21057404433044
curr_Factors:  [100.21057404]
mat_Sqrt:  [[0.15]]
grads:  [0.18134608]
Stock Position:  0.1813460804512799
Bond Position:  [-15.07710666]


portfolio before change:  [3.1123632]
curr_Stock_Price:  100.31291861333152
curr_Factors:  [100.31291861]
mat_Sqrt:  [[0.15]]
grads:  [-0.0196863]
Stock Position:  -0.019686297541458925
Bond Position:  [5.08715316]


portfolio before change:  [3.08920268]
curr_Stock_Price:  101.52170125375052
curr_Factors:  [101.52170125]
mat_Sqrt:  [[0.15]]
grads:  [0.03202607]
Stock Position:  0.032026073245391244
Bond Position:  [-0.16213876]


portfolio before change:  [3.11460425]
curr_Stock_Price:  102.31548704846121
curr_Factors:  [102.31548705]
mat_Sqrt:  [[0.15]]
grads:  [0.07957223]
Stock Position:  0.0795722330254869
Bond Position:  [-5.02686753]


portfolio before change:  [3.1590155]
curr_Stock_Price:  102.88150920067366
curr_Factors:  [102.8815092]
mat_Sqrt:  [[0.15]]
grads:  [0.16898171]
Stock Position:  0.16898170562606712
Bond Position:  [-14.2260774]


portfolio before change:  [3.20967564]
curr_Stock_Price:  103.19182986722477
curr_Factors:  [103.19182987]
mat_Sqrt:  [[0.15]]
grads:  [-0.02700366]
Stock Position:  -0.027003658570411024
Bond Position:  [5.99623258]


portfolio before change:  [3.22307722]
curr_Stock_Price:  102.72330064983986
curr_Factors:  [102.72330065]
mat_Sqrt:  [[0.15]]
grads:  [-0.08041829]
Stock Position:  -0.08041829150566444
Bond Position:  [11.48390956]


portfolio before change:  [3.14360418]
curr_Stock_Price:  103.72939786827457
curr_Factors:  [103.72939787]
mat_Sqrt:  [[0.15]]
grads:  [0.01419499]
Stock Position:  0.014194992177422445
Bond Position:  [1.67116619]


portfolio before change:  [3.14376516]
curr_Stock_Price:  103.72602118099616
curr_Factors:  [103.72602118]
mat_Sqrt:  [[0.15]]
grads:  [0.00478671]
Stock Position:  0.004786714877130643
Bond Position:  [2.64725827]


portfolio before change:  [3.14405408]
curr_Stock_Price:  103.71724559913267
curr_Factors:  [103.7172456]
mat_Sqrt:  [[0.15]]
grads:  [-0.1935005]
Stock Position:  -0.1935004952636077
Bond Position:  [23.21339247]


portfolio before change:  [3.00590848]
curr_Stock_Price:  104.44617117035546
curr_Factors:  [104.44617117]
mat_Sqrt:  [[0.15]]
grads:  [0.0323678]
Stock Position:  0.032367798087305014
Bond Position:  [-0.3747841]


portfolio before change:  [2.99290965]
curr_Stock_Price:  104.04602127635793
curr_Factors:  [104.04602128]
mat_Sqrt:  [[0.15]]
grads:  [-0.04057188]
Stock Position:  -0.040571882356493276
Bond Position:  [7.21425259]


portfolio before change:  [2.98183773]
curr_Stock_Price:  104.34114585123227
curr_Factors:  [104.34114585]
mat_Sqrt:  [[0.15]]
grads:  [0.03461442]
Stock Position:  0.034614415083935535
Bond Position:  [-0.62987]


portfolio before change:  [2.9509449]
curr_Stock_Price:  103.4509359525012
curr_Factors:  [103.45093595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02026372]
Stock Position:  -0.0202637164063434
Bond Position:  [5.04724533]


portfolio before change:  [2.95286939]
curr_Stock_Price:  103.38710054762433
curr_Factors:  [103.38710055]
mat_Sqrt:  [[0.15]]
grads:  [-0.00900433]
Stock Position:  -0.009004329062833978
Bond Position:  [3.88380086]


portfolio before change:  [2.95997257]
curr_Stock_Price:  102.65215678199652
curr_Factors:  [102.65215678]
mat_Sqrt:  [[0.15]]
grads:  [-0.20567445]
Stock Position:  -0.20567445206793186
Bond Position:  [24.07289867]


portfolio before change:  [3.10953647]
curr_Stock_Price:  101.93960062565337
curr_Factors:  [101.93960063]
mat_Sqrt:  [[0.15]]
grads:  [0.03191973]
Stock Position:  0.031919734685170016
Bond Position:  [-0.14434854]


portfolio before change:  [3.11451943]
curr_Stock_Price:  102.0962751399082
curr_Factors:  [102.09627514]
mat_Sqrt:  [[0.15]]
grads:  [0.05299108]
Stock Position:  0.052991077087844396
Bond Position:  [-2.29567216]


portfolio before change:  [3.11843915]
curr_Stock_Price:  102.17566012994592
curr_Factors:  [102.17566013]
mat_Sqrt:  [[0.15]]
grads:  [-0.0303597]
Stock Position:  -0.03035970302791593
Bond Position:  [6.22046185]


portfolio before change:  [3.10164874]
curr_Stock_Price:  102.7543224231791
curr_Factors:  [102.75432242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02790517]
Stock Position:  -0.027905169542283437
Bond Position:  [5.96902553]


portfolio before change:  [3.06977496]
curr_Stock_Price:  103.92327970578675
curr_Factors:  [103.92327971]
mat_Sqrt:  [[0.15]]
grads:  [-0.03569331]
Stock Position:  -0.03569330541832316
Bond Position:  [6.77914033]


portfolio before change:  [3.05871531]
curr_Stock_Price:  104.25687456813453
curr_Factors:  [104.25687457]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971327]
Stock Position:  -0.00971326638110788
Bond Position:  [4.0713901]


portfolio before change:  [3.06188946]
curr_Stock_Price:  103.98248678712629
curr_Factors:  [103.98248679]
mat_Sqrt:  [[0.15]]
grads:  [0.14438274]
Stock Position:  0.14438274196393444
Bond Position:  [-11.9513871]


portfolio before change:  [3.13014036]
curr_Stock_Price:  104.46554253487069
curr_Factors:  [104.46554253]
mat_Sqrt:  [[0.15]]
grads:  [0.16947764]
Stock Position:  0.16947763836026378
Bond Position:  [-14.57443308]


portfolio before change:  [3.26443474]
curr_Stock_Price:  105.26869450530826
curr_Factors:  [105.26869451]
mat_Sqrt:  [[0.15]]
grads:  [-0.14432387]
Stock Position:  -0.14432387134595326
Bond Position:  [18.45722026]


portfolio before change:  [3.06555268]
curr_Stock_Price:  106.66270751157114
curr_Factors:  [106.66270751]
mat_Sqrt:  [[0.15]]
grads:  [0.03026647]
Stock Position:  0.0302664657395038
Bond Position:  [-0.1627505]


portfolio before change:  [3.04401158]
curr_Stock_Price:  105.95166459157947
curr_Factors:  [105.95166459]
mat_Sqrt:  [[0.15]]
grads:  [-0.08754909]
Stock Position:  -0.08754908532516101
Bond Position:  [12.31998291]


portfolio before change:  [3.0352429]
curr_Stock_Price:  106.06941308536138
curr_Factors:  [106.06941309]
mat_Sqrt:  [[0.15]]
grads:  [0.02445779]
Stock Position:  0.024457794549463004
Bond Position:  [0.44101899]


portfolio before change:  [3.01913995]
curr_Stock_Price:  105.40876144339842
curr_Factors:  [105.40876144]
mat_Sqrt:  [[0.15]]
grads:  [-0.04277257]
Stock Position:  -0.042772567706498975
Bond Position:  [7.52774334]


portfolio before change:  [3.02677908]
curr_Stock_Price:  105.25216340887502
curr_Factors:  [105.25216341]
mat_Sqrt:  [[0.15]]
grads:  [0.01288986]
Stock Position:  0.012889862637450941
Bond Position:  [1.67009315]


portfolio before change:  [3.02203962]
curr_Stock_Price:  104.86827771590184
curr_Factors:  [104.86827772]
mat_Sqrt:  [[0.15]]
grads:  [0.16099406]
Stock Position:  0.1609940617515673
Bond Position:  [-13.86113036]


portfolio before change:  [3.03237877]
curr_Stock_Price:  104.9432612549951
curr_Factors:  [104.94326125]
mat_Sqrt:  [[0.15]]
grads:  [0.01439454]
Stock Position:  0.01439453859589506
Bond Position:  [1.52176895]


portfolio before change:  [3.02743582]
curr_Stock_Price:  104.58665445846454
curr_Factors:  [104.58665446]
mat_Sqrt:  [[0.15]]
grads:  [0.13599258]
Stock Position:  0.1359925803409711
Bond Position:  [-11.19557319]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.02743582]
Stock Price:  104.01868230234223
PL:  [-0.99124649]
Settle:  Tensor("sub_250:0", shape=(), dtype=float64)
PL:  Tensor("sub_251:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  126
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.32880863e-03]
 [ 3.44347549e-03]
 [ 7.62473072e-03]
 [ 3.84971660e-02]
 [ 2.10059736e-02]
 [ 2.76792681e-02]
 [ 2.33981124e-02]
 [-1.02227403e-03]
 [ 4.27922248e-03]
 [ 8.82992817e-03]
 [ 2.56869292e-02]
 [-2.87433511e-03]
 [-1.20975314e-02]
 [ 8.77818203e-03]
 [ 7.67448337e-05]
 [-2.81338071e-02]
 [ 4.97026321e-03]
 [-6.86102410e-03]
 [ 4.11774336e-03]
 [-3.82343328e-03]
 [-2.41900367e-03]
 [-3.94262539e-02]
 [ 4.83047707e-03]
 [ 1.20061997e-02]
 [-5.92459607e-03]
 [ 1.43318285e-02]
 [-1.34526790e-02]
 [ 1.19064827e-02]
 [ 8.23003436e-02]
 [ 2.80415848e-02]
 [-3.89284720e-02]
 [ 1.31256662e-04]
 [-1.34583389e-02]
 [ 9.21567091e-03]
 [-8.15783683e-03]
 [ 1.17775413e-02]
 [ 2.54745463e-02]
 [ 1.68596388e-02]
 [ 1.62818656e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.83491045]
curr_Stock_Price:  99.75681585370263
curr_Factors:  [99.75681585]
mat_Sqrt:  [[0.15]]
grads:  [-0.01552539]
Stock Position:  -0.015525390889291897
Bond Position:  [-0.28614689]


portfolio before change:  [-1.83301561]
curr_Stock_Price:  99.63246347473576
curr_Factors:  [99.63246347]
mat_Sqrt:  [[0.15]]
grads:  [0.0229565]
Stock Position:  0.02295650327314983
Bond Position:  [-4.12022858]


portfolio before change:  [-1.8094607]
curr_Stock_Price:  100.68096641980807
curr_Factors:  [100.68096642]
mat_Sqrt:  [[0.15]]
grads:  [0.05083154]
Stock Position:  0.05083153811142597
Bond Position:  [-6.92722909]


portfolio before change:  [-1.76213804]
curr_Stock_Price:  101.62897282431356
curr_Factors:  [101.62897282]
mat_Sqrt:  [[0.15]]
grads:  [0.25664777]
Stock Position:  0.25664777307707776
Bond Position:  [-27.84498759]


portfolio before change:  [-1.89634956]
curr_Stock_Price:  101.11959501589011
curr_Factors:  [101.11959502]
mat_Sqrt:  [[0.15]]
grads:  [0.14003982]
Stock Position:  0.14003982392614298
Bond Position:  [-16.05711984]


portfolio before change:  [-1.89825879]
curr_Stock_Price:  101.12029507630419
curr_Factors:  [101.12029508]
mat_Sqrt:  [[0.15]]
grads:  [0.18452845]
Stock Position:  0.18452845431373133
Bond Position:  [-20.55783054]


portfolio before change:  [-1.93523552]
curr_Stock_Price:  100.93383688172628
curr_Factors:  [100.93383688]
mat_Sqrt:  [[0.15]]
grads:  [0.15598742]
Stock Position:  0.15598741617049497
Bond Position:  [-17.67964394]


portfolio before change:  [-1.86263257]
curr_Stock_Price:  101.41344634309993
curr_Factors:  [101.41344634]
mat_Sqrt:  [[0.15]]
grads:  [-0.00681516]
Stock Position:  -0.00681516019628099
Bond Position:  [-1.17148369]


portfolio before change:  [-1.86273621]
curr_Stock_Price:  101.40716430958324
curr_Factors:  [101.40716431]
mat_Sqrt:  [[0.15]]
grads:  [0.02852815]
Stock Position:  0.028528149895805342
Bond Position:  [-4.75569499]


portfolio before change:  [-1.87303582]
curr_Stock_Price:  101.06697008967299
curr_Factors:  [101.06697009]
mat_Sqrt:  [[0.15]]
grads:  [0.05886619]
Stock Position:  0.058866187814716454
Bond Position:  [-7.82246306]


portfolio before change:  [-1.77578127]
curr_Stock_Price:  102.73571090949207
curr_Factors:  [102.73571091]
mat_Sqrt:  [[0.15]]
grads:  [0.17124619]
Stock Position:  0.17124619482545494
Bond Position:  [-19.36888084]


portfolio before change:  [-1.73334033]
curr_Stock_Price:  102.99768584487434
curr_Factors:  [102.99768584]
mat_Sqrt:  [[0.15]]
grads:  [-0.01916223]
Stock Position:  -0.01916223405024798
Bond Position:  [0.24032544]


portfolio before change:  [-1.72927616]
curr_Stock_Price:  102.78716113354407
curr_Factors:  [102.78716113]
mat_Sqrt:  [[0.15]]
grads:  [-0.08065021]
Stock Position:  -0.08065020935720568
Bond Position:  [6.56052991]


portfolio before change:  [-1.73671992]
curr_Stock_Price:  102.88962675281087
curr_Factors:  [102.88962675]
mat_Sqrt:  [[0.15]]
grads:  [0.05852121]
Stock Position:  0.058521213551761556
Bond Position:  [-7.75794573]


portfolio before change:  [-1.70836549]
curr_Stock_Price:  103.39071399175972
curr_Factors:  [103.39071399]
mat_Sqrt:  [[0.15]]
grads:  [0.00051163]
Stock Position:  0.0005116322244330385
Bond Position:  [-1.76126351]


portfolio before change:  [-1.70859519]
curr_Stock_Price:  103.37208007700528
curr_Factors:  [103.37208008]
mat_Sqrt:  [[0.15]]
grads:  [-0.18755871]
Stock Position:  -0.18755871367121033
Bond Position:  [17.67973918]


portfolio before change:  [-1.72666237]
curr_Stock_Price:  103.48019173630412
curr_Factors:  [103.48019174]
mat_Sqrt:  [[0.15]]
grads:  [0.03313509]
Stock Position:  0.03313508803820589
Bond Position:  [-5.15548763]


portfolio before change:  [-1.70199578]
curr_Stock_Price:  104.24406683675993
curr_Factors:  [104.24406684]
mat_Sqrt:  [[0.15]]
grads:  [-0.04574016]
Stock Position:  -0.045740160635809386
Bond Position:  [3.06614459]


portfolio before change:  [-1.69514987]
curr_Stock_Price:  104.10277704447766
curr_Factors:  [104.10277704]
mat_Sqrt:  [[0.15]]
grads:  [0.02745162]
Stock Position:  0.027451622424972677
Bond Position:  [-4.55294]


portfolio before change:  [-1.6688598]
curr_Stock_Price:  105.08119726513246
curr_Factors:  [105.08119727]
mat_Sqrt:  [[0.15]]
grads:  [-0.02548956]
Stock Position:  -0.025489555227660547
Bond Position:  [1.00961318]


portfolio before change:  [-1.6820694]
curr_Stock_Price:  105.60438449010375
curr_Factors:  [105.60438449]
mat_Sqrt:  [[0.15]]
grads:  [-0.01612669]
Stock Position:  -0.016126691155112498
Bond Position:  [0.0209799]


portfolio before change:  [-1.68070788]
curr_Stock_Price:  105.5201207954268
curr_Factors:  [105.5201208]
mat_Sqrt:  [[0.15]]
grads:  [-0.26284169]
Stock Position:  -0.26284169241827277
Bond Position:  [26.05437925]


portfolio before change:  [-1.71283471]
curr_Stock_Price:  105.65474109981031
curr_Factors:  [105.6547411]
mat_Sqrt:  [[0.15]]
grads:  [0.03220318]
Stock Position:  0.03220318044360949
Bond Position:  [-5.1152534]


portfolio before change:  [-1.69995809]
curr_Stock_Price:  106.07445325688496
curr_Factors:  [106.07445326]
mat_Sqrt:  [[0.15]]
grads:  [0.08004133]
Stock Position:  0.08004133139406208
Bond Position:  [-10.19029855]


portfolio before change:  [-1.64443043]
curr_Stock_Price:  106.7841056623473
curr_Factors:  [106.78410566]
mat_Sqrt:  [[0.15]]
grads:  [-0.03949731]
Stock Position:  -0.03949730715153124
Bond Position:  [2.57325419]


portfolio before change:  [-1.63643446]
curr_Stock_Price:  106.58980638568512
curr_Factors:  [106.58980639]
mat_Sqrt:  [[0.15]]
grads:  [0.09554552]
Stock Position:  0.09554552361750025
Bond Position:  [-11.82061332]


portfolio before change:  [-1.63603559]
curr_Stock_Price:  106.60944661980335
curr_Factors:  [106.60944662]
mat_Sqrt:  [[0.15]]
grads:  [-0.08968453]
Stock Position:  -0.0896845265528891
Bond Position:  [7.92518216]


portfolio before change:  [-1.73296045]
curr_Stock_Price:  107.70122433187687
curr_Factors:  [107.70122433]
mat_Sqrt:  [[0.15]]
grads:  [0.07937655]
Stock Position:  0.0793765513705091
Bond Position:  [-10.28191221]


portfolio before change:  [-1.70258869]
curr_Stock_Price:  108.10004579864173
curr_Factors:  [108.1000458]
mat_Sqrt:  [[0.15]]
grads:  [0.54866896]
Stock Position:  0.5486689572871921
Bond Position:  [-61.0137281]


portfolio before change:  [-1.54701647]
curr_Stock_Price:  108.39749184803483
curr_Factors:  [108.39749185]
mat_Sqrt:  [[0.15]]
grads:  [0.1869439]
Stock Position:  0.1869438986126614
Bond Position:  [-21.8112662]


portfolio before change:  [-1.56802551]
curr_Stock_Price:  108.29969537397824
curr_Factors:  [108.29969537]
mat_Sqrt:  [[0.15]]
grads:  [-0.25952315]
Stock Position:  -0.2595231465814587
Bond Position:  [26.53825221]


portfolio before change:  [-1.85051495]
curr_Stock_Price:  109.40097260534232
curr_Factors:  [109.40097261]
mat_Sqrt:  [[0.15]]
grads:  [0.00087504]
Stock Position:  0.000875044416566694
Bond Position:  [-1.94624566]


portfolio before change:  [-1.84990466]
curr_Stock_Price:  110.37644504341641
curr_Factors:  [110.37644504]
mat_Sqrt:  [[0.15]]
grads:  [-0.08972226]
Stock Position:  -0.08972225945073785
Bond Position:  [8.05331938]


portfolio before change:  [-1.786423]
curr_Stock_Price:  109.6801303089129
curr_Factors:  [109.68013031]
mat_Sqrt:  [[0.15]]
grads:  [0.06143781]
Stock Position:  0.061437806046428525
Bond Position:  [-8.52492958]


portfolio before change:  [-1.78693322]
curr_Stock_Price:  109.68917150730964
curr_Factors:  [109.68917151]
mat_Sqrt:  [[0.15]]
grads:  [-0.05438558]
Stock Position:  -0.05438557888647168
Bond Position:  [4.17857587]


portfolio before change:  [-1.80488898]
curr_Stock_Price:  110.0289328001432
curr_Factors:  [110.0289328]
mat_Sqrt:  [[0.15]]
grads:  [0.07851694]
Stock Position:  0.07851694212989485
Bond Position:  [-10.44402432]


portfolio before change:  [-1.71620135]
curr_Stock_Price:  111.17509578500145
curr_Factors:  [111.17509579]
mat_Sqrt:  [[0.15]]
grads:  [0.16983031]
Stock Position:  0.16983030879460437
Bond Position:  [-20.59710219]


portfolio before change:  [-1.70937871]
curr_Stock_Price:  111.23043002481185
curr_Factors:  [111.23043002]
mat_Sqrt:  [[0.15]]
grads:  [0.11239759]
Stock Position:  0.11239759199215774
Bond Position:  [-14.21141121]


portfolio before change:  [-1.67678419]
curr_Stock_Price:  111.53622891687785
curr_Factors:  [111.53622892]
mat_Sqrt:  [[0.15]]
grads:  [0.10854577]
Stock Position:  0.1085457707145258
Bond Position:  [-13.78357012]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.67678419]
Stock Price:  111.33711835021775
PL:  [-13.01390254]
Settle:  Tensor("sub_252:0", shape=(), dtype=float64)
PL:  Tensor("sub_253:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  127
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.03358982e-03]
 [-1.43155777e-02]
 [ 1.63967186e-02]
 [-6.31420940e-03]
 [ 1.82293851e-02]
 [ 1.91196493e-02]
 [ 2.60986113e-02]
 [-3.00273534e-03]
 [ 1.68484360e-02]
 [-3.07729670e-03]
 [ 3.45234786e-03]
 [ 2.56936139e-03]
 [ 6.38007103e-03]
 [ 1.03231041e-02]
 [-2.80613794e-03]
 [-9.27499214e-03]
 [-4.14305195e-03]
 [-4.29374730e-04]
 [-7.52136783e-03]
 [-2.43315407e-03]
 [ 4.76772926e-04]
 [ 9.00252883e-03]
 [ 4.76696879e-03]
 [ 5.76157666e-03]
 [-3.35825331e-03]
 [-6.12793922e-03]
 [-6.73424917e-03]
 [-1.95688250e-02]
 [-3.34941467e-02]
 [ 2.18849832e-02]
 [ 6.17175733e-03]
 [ 1.71831385e-03]
 [-1.25189839e-02]
 [-7.37958902e-03]
 [-7.73699503e-03]
 [-7.52349618e-03]
 [ 2.24369483e-02]
 [ 8.43883414e-03]
 [ 2.31749620e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.42834721]
curr_Stock_Price:  99.84742957026292
curr_Factors:  [99.84742957]
mat_Sqrt:  [[0.15]]
grads:  [-0.01355727]
Stock Position:  -0.013557265433936372
Bond Position:  [0.9253109]


portfolio before change:  [-0.43598149]
curr_Stock_Price:  100.41907545351226
curr_Factors:  [100.41907545]
mat_Sqrt:  [[0.15]]
grads:  [-0.09543718]
Stock Position:  -0.09543718456509458
Bond Position:  [9.14773234]


portfolio before change:  [-0.44170518]
curr_Stock_Price:  100.49103089442772
curr_Factors:  [100.49103089]
mat_Sqrt:  [[0.15]]
grads:  [0.10931146]
Stock Position:  0.10931145733312461
Bond Position:  [-11.42652622]


portfolio before change:  [-0.52575239]
curr_Stock_Price:  99.73521985540405
curr_Factors:  [99.73521986]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209473]
Stock Position:  -0.042094729364982854
Bond Position:  [3.6725747]


portfolio before change:  [-0.57508621]
curr_Stock_Price:  100.91809768195729
curr_Factors:  [100.91809768]
mat_Sqrt:  [[0.15]]
grads:  [0.12152923]
Stock Position:  0.12152923380391807
Bond Position:  [-12.8395853]


portfolio before change:  [-0.63400259]
curr_Stock_Price:  100.44651293863954
curr_Factors:  [100.44651294]
mat_Sqrt:  [[0.15]]
grads:  [0.12746433]
Stock Position:  0.12746432865222443
Bond Position:  [-13.43734993]


portfolio before change:  [-0.61263291]
curr_Stock_Price:  100.62734359988983
curr_Factors:  [100.6273436]
mat_Sqrt:  [[0.15]]
grads:  [0.17399074]
Stock Position:  0.17399074232004527
Bond Position:  [-18.12085912]


portfolio before change:  [-0.67795704]
curr_Stock_Price:  100.26491692611782
curr_Factors:  [100.26491693]
mat_Sqrt:  [[0.15]]
grads:  [-0.02001824]
Stock Position:  -0.02001823562374741
Bond Position:  [1.32916969]


portfolio before change:  [-0.6612307]
curr_Stock_Price:  99.43766172307075
curr_Factors:  [99.43766172]
mat_Sqrt:  [[0.15]]
grads:  [0.11232291]
Stock Position:  0.11232290674675001
Bond Position:  [-11.8303579]


portfolio before change:  [-0.69768866]
curr_Stock_Price:  99.12624641280239
curr_Factors:  [99.12624641]
mat_Sqrt:  [[0.15]]
grads:  [-0.02051531]
Stock Position:  -0.02051531130394787
Bond Position:  [1.33591715]


portfolio before change:  [-0.6779959]
curr_Stock_Price:  98.17448149394107
curr_Factors:  [98.17448149]
mat_Sqrt:  [[0.15]]
grads:  [0.02301565]
Stock Position:  0.023015652375163086
Bond Position:  [-2.93754564]


portfolio before change:  [-0.66770809]
curr_Stock_Price:  98.63742856316037
curr_Factors:  [98.63742856]
mat_Sqrt:  [[0.15]]
grads:  [0.01712908]
Stock Position:  0.017129075926450184
Bond Position:  [-2.35727609]


portfolio before change:  [-0.67593821]
curr_Stock_Price:  98.17415556422984
curr_Factors:  [98.17415556]
mat_Sqrt:  [[0.15]]
grads:  [0.04253381]
Stock Position:  0.04253380685153978
Bond Position:  [-4.85165878]


portfolio before change:  [-0.67844621]
curr_Stock_Price:  98.1294497898828
curr_Factors:  [98.12944979]
mat_Sqrt:  [[0.15]]
grads:  [0.06882069]
Stock Position:  0.06882069417844507
Bond Position:  [-7.43178306]


portfolio before change:  [-0.64072435]
curr_Stock_Price:  98.69106703985435
curr_Factors:  [98.69106704]
mat_Sqrt:  [[0.15]]
grads:  [-0.01870759]
Stock Position:  -0.018707586252147825
Bond Position:  [1.2055473]


portfolio before change:  [-0.6443262]
curr_Stock_Price:  98.89165691653555
curr_Factors:  [98.89165692]
mat_Sqrt:  [[0.15]]
grads:  [-0.06183328]
Stock Position:  -0.061833280921184425
Bond Position:  [5.4704694]


portfolio before change:  [-0.60068234]
curr_Stock_Price:  98.19688526262226
curr_Factors:  [98.19688526]
mat_Sqrt:  [[0.15]]
grads:  [-0.02762035]
Stock Position:  -0.027620346358009907
Bond Position:  [2.11154964]


portfolio before change:  [-0.57827276]
curr_Stock_Price:  97.39509880909667
curr_Factors:  [97.39509881]
mat_Sqrt:  [[0.15]]
grads:  [-0.0028625]
Stock Position:  -0.0028624981987855815
Bond Position:  [-0.29947946]


portfolio before change:  [-0.58034662]
curr_Stock_Price:  98.10651176741987
curr_Factors:  [98.10651177]
mat_Sqrt:  [[0.15]]
grads:  [-0.05014245]
Stock Position:  -0.05014245222472892
Bond Position:  [4.33895446]


portfolio before change:  [-0.55197416]
curr_Stock_Price:  97.55149203363905
curr_Factors:  [97.55149203]
mat_Sqrt:  [[0.15]]
grads:  [-0.01622103]
Stock Position:  -0.016221027156368414
Bond Position:  [1.03041124]


portfolio before change:  [-0.55004954]
curr_Stock_Price:  97.44078302497331
curr_Factors:  [97.44078302]
mat_Sqrt:  [[0.15]]
grads:  [0.00317849]
Stock Position:  0.0031784861761645247
Bond Position:  [-0.85976372]


portfolio before change:  [-0.548746]
curr_Stock_Price:  97.88471006530604
curr_Factors:  [97.88471007]
mat_Sqrt:  [[0.15]]
grads:  [0.06001686]
Stock Position:  0.06001685887243333
Bond Position:  [-6.42347883]


portfolio before change:  [-0.50210886]
curr_Stock_Price:  98.67515668129079
curr_Factors:  [98.67515668]
mat_Sqrt:  [[0.15]]
grads:  [0.03177979]
Stock Position:  0.03177979193516511
Bond Position:  [-3.63798481]


portfolio before change:  [-0.51531434]
curr_Stock_Price:  98.27393618232897
curr_Factors:  [98.27393618]
mat_Sqrt:  [[0.15]]
grads:  [0.03841051]
Stock Position:  0.03841051107109672
Bond Position:  [-4.29006646]


portfolio before change:  [-0.51427172]
curr_Stock_Price:  98.31504256344431
curr_Factors:  [98.31504256]
mat_Sqrt:  [[0.15]]
grads:  [-0.02238836]
Stock Position:  -0.02238835538917386
Bond Position:  [1.6868404]


portfolio before change:  [-0.51920935]
curr_Stock_Price:  98.54500570807664
curr_Factors:  [98.54500571]
mat_Sqrt:  [[0.15]]
grads:  [-0.04085293]
Stock Position:  -0.04085292810360742
Bond Position:  [3.50664269]


portfolio before change:  [-0.46269628]
curr_Stock_Price:  97.17240623831405
curr_Factors:  [97.17240624]
mat_Sqrt:  [[0.15]]
grads:  [-0.04489499]
Stock Position:  -0.04489499449310728
Bond Position:  [3.89985836]


portfolio before change:  [-0.45879157]
curr_Stock_Price:  97.09629082713536
curr_Factors:  [97.09629083]
mat_Sqrt:  [[0.15]]
grads:  [-0.13045883]
Stock Position:  -0.1304588333592275
Bond Position:  [12.20827726]


portfolio before change:  [-0.57986559]
curr_Stock_Price:  98.03605206802008
curr_Factors:  [98.03605207]
mat_Sqrt:  [[0.15]]
grads:  [-0.22329431]
Stock Position:  -0.22329431121401197
Bond Position:  [21.31102713]


portfolio before change:  [-0.7195907]
curr_Stock_Price:  98.673726842048
curr_Factors:  [98.67372684]
mat_Sqrt:  [[0.15]]
grads:  [0.14589989]
Stock Position:  0.14589988781775573
Bond Position:  [-15.11607637]


portfolio before change:  [-0.71410696]
curr_Stock_Price:  98.72426400977008
curr_Factors:  [98.72426401]
mat_Sqrt:  [[0.15]]
grads:  [0.04114505]
Stock Position:  0.04114504889899858
Bond Position:  [-4.77612163]


portfolio before change:  [-0.66243047]
curr_Stock_Price:  99.99473372126798
curr_Factors:  [99.99473372]
mat_Sqrt:  [[0.15]]
grads:  [0.01145543]
Stock Position:  0.01145542566503786
Bond Position:  [-1.80791271]


portfolio before change:  [-0.66603691]
curr_Stock_Price:  99.69963911507406
curr_Factors:  [99.69963912]
mat_Sqrt:  [[0.15]]
grads:  [-0.08345989]
Stock Position:  -0.08345989242468956
Bond Position:  [7.65488425]


portfolio before change:  [-0.60138247]
curr_Stock_Price:  98.93642797577346
curr_Factors:  [98.93642798]
mat_Sqrt:  [[0.15]]
grads:  [-0.04919726]
Stock Position:  -0.049197260125372094
Bond Position:  [4.26601871]


portfolio before change:  [-0.64510579]
curr_Stock_Price:  99.83600263723655
curr_Factors:  [99.83600264]
mat_Sqrt:  [[0.15]]
grads:  [-0.05157997]
Stock Position:  -0.051579966845299786
Bond Position:  [4.50443192]


portfolio before change:  [-0.59646757]
curr_Stock_Price:  98.90395219482394
curr_Factors:  [98.90395219]
mat_Sqrt:  [[0.15]]
grads:  [-0.05015664]
Stock Position:  -0.05015664121426142
Bond Position:  [4.36422247]


portfolio before change:  [-0.61250975]
curr_Stock_Price:  99.23467089587164
curr_Factors:  [99.2346709]
mat_Sqrt:  [[0.15]]
grads:  [0.14957966]
Stock Position:  0.14957965546884766
Bond Position:  [-15.45599763]


portfolio before change:  [-0.80959477]
curr_Stock_Price:  97.92999547938938
curr_Factors:  [97.92999548]
mat_Sqrt:  [[0.15]]
grads:  [0.05625889]
Stock Position:  0.056258894267553206
Bond Position:  [-6.31902803]


portfolio before change:  [-0.76893876]
curr_Stock_Price:  98.66669554800282
curr_Factors:  [98.66669555]
mat_Sqrt:  [[0.15]]
grads:  [0.15449975]
Stock Position:  0.15449974656947804
Bond Position:  [-16.01291822]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.76893876]
Stock Price:  99.6569951505377
PL:  [-0.76893876]
Settle:  Tensor("sub_254:0", shape=(), dtype=float64)
PL:  Tensor("sub_255:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  128
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.66406501e-03]
 [-1.35906738e-02]
 [-2.63168506e-03]
 [ 5.46562348e-02]
 [-1.49075241e-02]
 [ 3.60977181e-02]
 [ 4.04988977e-04]
 [ 2.06050975e-03]
 [ 1.59907260e-02]
 [ 1.46179609e-02]
 [ 8.66814429e-04]
 [-2.89535410e-02]
 [-1.00658211e-02]
 [-2.13440530e-02]
 [ 8.55558625e-03]
 [-3.86967521e-02]
 [ 4.62720936e-03]
 [-1.10105849e-02]
 [ 1.33523684e-02]
 [-5.44419759e-03]
 [-3.34751326e-03]
 [-3.92353881e-02]
 [ 4.84049471e-03]
 [ 1.28150226e-02]
 [-5.98960454e-03]
 [ 2.69727813e-02]
 [-1.92927516e-02]
 [ 1.91338309e-02]
 [ 1.21862142e-01]
 [ 3.03364541e-02]
 [-6.56984357e-02]
 [-7.38560694e-03]
 [-1.36753131e-02]
 [ 1.49602772e-02]
 [-9.62077222e-03]
 [ 2.11822226e-02]
 [ 2.64486124e-02]
 [ 2.40543487e-02]
 [ 1.43869476e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.00960702]
curr_Stock_Price:  99.68113946841498
curr_Factors:  [99.68113947]
mat_Sqrt:  [[0.15]]
grads:  [-0.01776043]
Stock Position:  -0.017760433372497525
Bond Position:  [-1.23922679]


portfolio before change:  [-3.0175498]
curr_Stock_Price:  100.11963473684267
curr_Factors:  [100.11963474]
mat_Sqrt:  [[0.15]]
grads:  [-0.09060449]
Stock Position:  -0.09060449230222345
Bond Position:  [6.05373887]


portfolio before change:  [-3.17583078]
curr_Stock_Price:  101.87493118234897
curr_Factors:  [101.87493118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01754457]
Stock Position:  -0.017544567060195956
Bond Position:  [-1.38847922]


portfolio before change:  [-3.18029925]
curr_Stock_Price:  102.11973029987784
curr_Factors:  [102.1197303]
mat_Sqrt:  [[0.15]]
grads:  [0.3643749]
Stock Position:  0.3643748983398796
Bond Position:  [-40.39016559]


portfolio before change:  [-3.06262354]
curr_Stock_Price:  102.45653943868645
curr_Factors:  [102.45653944]
mat_Sqrt:  [[0.15]]
grads:  [-0.09938349]
Stock Position:  -0.09938349378083382
Bond Position:  [7.11986531]


portfolio before change:  [-3.11088276]
curr_Stock_Price:  102.95108091948548
curr_Factors:  [102.95108092]
mat_Sqrt:  [[0.15]]
grads:  [0.24065145]
Stock Position:  0.24065145395006912
Bond Position:  [-27.88621007]


portfolio before change:  [-2.915476]
curr_Stock_Price:  103.77755733246642
curr_Factors:  [103.77755733]
mat_Sqrt:  [[0.15]]
grads:  [0.00269993]
Stock Position:  0.002699926515583919
Bond Position:  [-3.19566778]


portfolio before change:  [-2.91618196]
curr_Stock_Price:  103.66404662077753
curr_Factors:  [103.66404662]
mat_Sqrt:  [[0.15]]
grads:  [0.01373673]
Stock Position:  0.013736731684849648
Bond Position:  [-4.34018715]


portfolio before change:  [-2.90257142]
curr_Stock_Price:  104.69435670397478
curr_Factors:  [104.6943567]
mat_Sqrt:  [[0.15]]
grads:  [0.10660484]
Stock Position:  0.10660484010739142
Bond Position:  [-14.06349658]


portfolio before change:  [-2.76230995]
curr_Stock_Price:  106.02656183625379
curr_Factors:  [106.02656184]
mat_Sqrt:  [[0.15]]
grads:  [0.09745307]
Stock Position:  0.09745307264517084
Bond Position:  [-13.09492418]


portfolio before change:  [-2.7251685]
curr_Stock_Price:  106.42448071418528
curr_Factors:  [106.42448071]
mat_Sqrt:  [[0.15]]
grads:  [0.00577876]
Stock Position:  0.005778762858336071
Bond Position:  [-3.34017034]


portfolio before change:  [-2.72165614]
curr_Stock_Price:  107.10454086128703
curr_Factors:  [107.10454086]
mat_Sqrt:  [[0.15]]
grads:  [-0.19302361]
Stock Position:  -0.19302360671134533
Bond Position:  [17.95204863]


portfolio before change:  [-2.9307404]
curr_Stock_Price:  108.19937277149445
curr_Factors:  [108.19937277]
mat_Sqrt:  [[0.15]]
grads:  [-0.06710547]
Stock Position:  -0.06710547371868339
Bond Position:  [4.33002976]


portfolio before change:  [-2.82779068]
curr_Stock_Price:  106.67329116600905
curr_Factors:  [106.67329117]
mat_Sqrt:  [[0.15]]
grads:  [-0.14229369]
Stock Position:  -0.14229368696989186
Bond Position:  [12.35114522]


portfolio before change:  [-2.88529237]
curr_Stock_Price:  107.08824758007114
curr_Factors:  [107.08824758]
mat_Sqrt:  [[0.15]]
grads:  [0.05703724]
Stock Position:  0.057037241699183984
Bond Position:  [-8.99331063]


portfolio before change:  [-2.86505062]
curr_Stock_Price:  107.46284465801986
curr_Factors:  [107.46284466]
mat_Sqrt:  [[0.15]]
grads:  [-0.25797835]
Stock Position:  -0.2579783475225128
Bond Position:  [24.85803646]


portfolio before change:  [-2.57728915]
curr_Stock_Price:  106.35944188300478
curr_Factors:  [106.35944188]
mat_Sqrt:  [[0.15]]
grads:  [0.03084806]
Stock Position:  0.030848062428946457
Bond Position:  [-5.85827185]


portfolio before change:  [-2.59911187]
curr_Stock_Price:  105.67575581247112
curr_Factors:  [105.67575581]
mat_Sqrt:  [[0.15]]
grads:  [-0.0734039]
Stock Position:  -0.07340389942828053
Bond Position:  [5.15790068]


portfolio before change:  [-2.63339266]
curr_Stock_Price:  106.15155572974359
curr_Factors:  [106.15155573]
mat_Sqrt:  [[0.15]]
grads:  [0.08901579]
Stock Position:  0.08901578900558127
Bond Position:  [-12.08255715]


portfolio before change:  [-2.50542675]
curr_Stock_Price:  107.6060878234201
curr_Factors:  [107.60608782]
mat_Sqrt:  [[0.15]]
grads:  [-0.03629465]
Stock Position:  -0.03629465058343972
Bond Position:  [1.4000986]


portfolio before change:  [-2.50254212]
curr_Stock_Price:  107.53143189250268
curr_Factors:  [107.53143189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02231676]
Stock Position:  -0.022316755091408458
Bond Position:  [-0.10278949]


portfolio before change:  [-2.4837716]
curr_Stock_Price:  106.68976061830166
curr_Factors:  [106.68976062]
mat_Sqrt:  [[0.15]]
grads:  [-0.26156925]
Stock Position:  -0.26156925390090474
Bond Position:  [25.42298949]


portfolio before change:  [-2.45679507]
curr_Stock_Price:  106.59877723744235
curr_Factors:  [106.59877724]
mat_Sqrt:  [[0.15]]
grads:  [0.03226996]
Stock Position:  0.03226996471377618
Bond Position:  [-5.89673385]


portfolio before change:  [-2.45133191]
curr_Stock_Price:  106.79091547602334
curr_Factors:  [106.79091548]
mat_Sqrt:  [[0.15]]
grads:  [0.08543348]
Stock Position:  0.08543348417280466
Bond Position:  [-11.5748519]


portfolio before change:  [-2.4297832]
curr_Stock_Price:  107.06007992707787
curr_Factors:  [107.06007993]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399307]
Stock Position:  -0.039930696956016996
Bond Position:  [1.8452004]


portfolio before change:  [-2.51108131]
curr_Stock_Price:  109.10183679420996
curr_Factors:  [109.10183679]
mat_Sqrt:  [[0.15]]
grads:  [0.17981854]
Stock Position:  0.1798185421555114
Bond Position:  [-22.12961455]


portfolio before change:  [-2.34025032]
curr_Stock_Price:  110.06723986312136
curr_Factors:  [110.06723986]
mat_Sqrt:  [[0.15]]
grads:  [-0.12861834]
Stock Position:  -0.12861834379145182
Bond Position:  [11.81641578]


portfolio before change:  [-2.29140525]
curr_Stock_Price:  109.6989571029856
curr_Factors:  [109.6989571]
mat_Sqrt:  [[0.15]]
grads:  [0.12755887]
Stock Position:  0.12755887269235083
Bond Position:  [-16.28448056]


portfolio before change:  [-2.14504689]
curr_Stock_Price:  110.86229484488189
curr_Factors:  [110.86229484]
mat_Sqrt:  [[0.15]]
grads:  [0.81241428]
Stock Position:  0.8124142786595256
Bond Position:  [-92.21115819]


portfolio before change:  [-1.29349617]
curr_Stock_Price:  111.92465656434996
curr_Factors:  [111.92465656]
mat_Sqrt:  [[0.15]]
grads:  [0.20224303]
Stock Position:  0.20224302721377246
Bond Position:  [-23.92947754]


portfolio before change:  [-1.01706717]
curr_Stock_Price:  113.30626355504873
curr_Factors:  [113.30626356]
mat_Sqrt:  [[0.15]]
grads:  [-0.43798957]
Stock Position:  -0.43798957154636187
Bond Position:  [48.60989466]


portfolio before change:  [-1.40390237]
curr_Stock_Price:  114.20334387106114
curr_Factors:  [114.20334387]
mat_Sqrt:  [[0.15]]
grads:  [-0.04923738]
Stock Position:  -0.049237379615417236
Bond Position:  [4.21917102]


portfolio before change:  [-1.35996212]
curr_Stock_Price:  113.32163937409247
curr_Factors:  [113.32163937]
mat_Sqrt:  [[0.15]]
grads:  [-0.09116875]
Stock Position:  -0.09116875384382436
Bond Position:  [8.97143052]


portfolio before change:  [-1.36776013]
curr_Stock_Price:  113.41947450892367
curr_Factors:  [113.41947451]
mat_Sqrt:  [[0.15]]
grads:  [0.09973518]
Stock Position:  0.09973518104039009
Bond Position:  [-12.67967196]


portfolio before change:  [-1.37772053]
curr_Stock_Price:  113.33549871309623
curr_Factors:  [113.33549871]
mat_Sqrt:  [[0.15]]
grads:  [-0.06413848]
Stock Position:  -0.06413848146711094
Bond Position:  [5.89144625]


portfolio before change:  [-1.43814334]
curr_Stock_Price:  114.28904928678641
curr_Factors:  [114.28904929]
mat_Sqrt:  [[0.15]]
grads:  [0.14121482]
Stock Position:  0.14121481739972896
Bond Position:  [-17.57745057]


portfolio before change:  [-1.39438807]
curr_Stock_Price:  114.61445837267095
curr_Factors:  [114.61445837]
mat_Sqrt:  [[0.15]]
grads:  [0.17632408]
Stock Position:  0.17632408288135104
Bond Position:  [-21.60367733]


portfolio before change:  [-1.45121265]
curr_Stock_Price:  114.3075011753264
curr_Factors:  [114.30750118]
mat_Sqrt:  [[0.15]]
grads:  [0.16036232]
Stock Position:  0.16036232449873633
Bond Position:  [-19.78182925]


portfolio before change:  [-1.38515167]
curr_Stock_Price:  114.73487001377734
curr_Factors:  [114.73487001]
mat_Sqrt:  [[0.15]]
grads:  [0.09591298]
Stock Position:  0.09591298380429407
Bond Position:  [-12.3897154]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.38515167]
Stock Price:  114.89460390073653
PL:  [-16.27975557]
Settle:  Tensor("sub_256:0", shape=(), dtype=float64)
PL:  Tensor("sub_257:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  129
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.32801884e-03]
 [ 5.28797079e-03]
 [ 1.13205488e-03]
 [-4.48480313e-03]
 [ 1.42052095e-02]
 [ 3.13216142e-02]
 [ 1.30235328e-02]
 [ 1.31508131e-03]
 [ 1.13122891e-02]
 [ 1.19912653e-02]
 [ 2.38331806e-02]
 [-8.01992228e-03]
 [-1.25680977e-02]
 [-9.19534997e-03]
 [ 1.76401130e-03]
 [-2.80437253e-02]
 [ 4.96398978e-03]
 [ 5.20994733e-04]
 [ 3.52316747e-03]
 [-3.36115245e-03]
 [-1.50813258e-03]
 [-3.08531043e-02]
 [ 4.78734097e-03]
 [ 8.10362266e-03]
 [-5.40839640e-03]
 [-9.29466104e-04]
 [-4.53580906e-03]
 [-7.73219340e-03]
 [ 1.63508132e-03]
 [ 2.40227077e-02]
 [-1.03182054e-02]
 [ 6.26470222e-03]
 [-1.28028581e-02]
 [ 7.69936912e-04]
 [-6.48154014e-03]
 [ 1.71784115e-03]
 [ 2.46435489e-02]
 [ 6.91354113e-03]
 [ 1.90152331e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.87795026]
curr_Stock_Price:  99.10982243475557
curr_Factors:  [99.10982243]
mat_Sqrt:  [[0.15]]
grads:  [-0.03552013]
Stock Position:  -0.035520125573984554
Bond Position:  [-8.35755692]


portfolio before change:  [-11.89243622]
curr_Stock_Price:  99.4882332471927
curr_Factors:  [99.48823325]
mat_Sqrt:  [[0.15]]
grads:  [0.03525314]
Stock Position:  0.03525313856966843
Bond Position:  [-15.39970869]


portfolio before change:  [-11.84739576]
curr_Stock_Price:  100.82047042897594
curr_Factors:  [100.82047043]
mat_Sqrt:  [[0.15]]
grads:  [0.00754703]
Stock Position:  0.0075470325320696075
Bond Position:  [-12.60829113]


portfolio before change:  [-11.85484567]
curr_Stock_Price:  100.04218062930849
curr_Factors:  [100.04218063]
mat_Sqrt:  [[0.15]]
grads:  [-0.02989869]
Stock Position:  -0.029898687556618096
Bond Position:  [-8.86371577]


portfolio before change:  [-11.87494291]
curr_Stock_Price:  100.67729911053542
curr_Factors:  [100.67729911]
mat_Sqrt:  [[0.15]]
grads:  [0.0947014]
Stock Position:  0.09470139675831896
Bond Position:  [-21.40922376]


portfolio before change:  [-11.74477856]
curr_Stock_Price:  102.08003102109782
curr_Factors:  [102.08003102]
mat_Sqrt:  [[0.15]]
grads:  [0.20881076]
Stock Position:  0.20881076157247103
Bond Position:  [-33.06018758]


portfolio before change:  [-11.83476178]
curr_Stock_Price:  101.668891117132
curr_Factors:  [101.66889112]
mat_Sqrt:  [[0.15]]
grads:  [0.08682355]
Stock Position:  0.08682355210306864
Bond Position:  [-20.66201605]


portfolio before change:  [-11.72233745]
curr_Stock_Price:  102.99349997265881
curr_Factors:  [102.99349997]
mat_Sqrt:  [[0.15]]
grads:  [0.00876721]
Stock Position:  0.008767208712843502
Bond Position:  [-12.62530296]


portfolio before change:  [-11.72253572]
curr_Stock_Price:  103.15090381368461
curr_Factors:  [103.15090381]
mat_Sqrt:  [[0.15]]
grads:  [0.07541526]
Stock Position:  0.07541526058670854
Bond Position:  [-19.50168801]


portfolio before change:  [-11.78377221]
curr_Stock_Price:  102.37123889370451
curr_Factors:  [102.37123889]
mat_Sqrt:  [[0.15]]
grads:  [0.07994177]
Stock Position:  0.07994176854367388
Bond Position:  [-19.9675101]


portfolio before change:  [-11.71652847]
curr_Stock_Price:  103.24362193966148
curr_Factors:  [103.24362194]
mat_Sqrt:  [[0.15]]
grads:  [0.15888787]
Stock Position:  0.1588878705629845
Bond Position:  [-28.1206877]


portfolio before change:  [-11.62430608]
curr_Stock_Price:  103.84617069370258
curr_Factors:  [103.84617069]
mat_Sqrt:  [[0.15]]
grads:  [-0.05346615]
Stock Position:  -0.05346614851753405
Bond Position:  [-6.0720513]


portfolio before change:  [-11.65147474]
curr_Stock_Price:  104.34012061612106
curr_Factors:  [104.34012062]
mat_Sqrt:  [[0.15]]
grads:  [-0.08378732]
Stock Position:  -0.08378731787913553
Bond Position:  [-2.90909588]


portfolio before change:  [-11.71734545]
curr_Stock_Price:  105.12194597824941
curr_Factors:  [105.12194598]
mat_Sqrt:  [[0.15]]
grads:  [-0.06130233]
Stock Position:  -0.061302333148299214
Bond Position:  [-5.27312489]


portfolio before change:  [-11.66091564]
curr_Stock_Price:  104.19067651064887
curr_Factors:  [104.19067651]
mat_Sqrt:  [[0.15]]
grads:  [0.01176008]
Stock Position:  0.011760075332325957
Bond Position:  [-12.88620584]


portfolio before change:  [-11.67256354]
curr_Stock_Price:  103.33719366327242
curr_Factors:  [103.33719366]
mat_Sqrt:  [[0.15]]
grads:  [-0.18695817]
Stock Position:  -0.18695816860614942
Bond Position:  [7.64716894]


portfolio before change:  [-11.70818612]
curr_Stock_Price:  103.53284459046415
curr_Factors:  [103.53284459]
mat_Sqrt:  [[0.15]]
grads:  [0.03309327]
Stock Position:  0.03309326519554586
Bond Position:  [-15.134426]


portfolio before change:  [-11.74356685]
curr_Stock_Price:  102.52089227438708
curr_Factors:  [102.52089227]
mat_Sqrt:  [[0.15]]
grads:  [0.0034733]
Stock Position:  0.0034732982214776375
Bond Position:  [-12.09965248]


portfolio before change:  [-11.74004321]
curr_Stock_Price:  103.97086541565471
curr_Factors:  [103.97086542]
mat_Sqrt:  [[0.15]]
grads:  [0.02348778]
Stock Position:  0.023487783114666008
Bond Position:  [-14.18208835]


portfolio before change:  [-11.73588528]
curr_Stock_Price:  104.22337129296348
curr_Factors:  [104.22337129]
mat_Sqrt:  [[0.15]]
grads:  [-0.02240768]
Stock Position:  -0.02240768298196584
Bond Position:  [-9.40048101]


portfolio before change:  [-11.72564533]
curr_Stock_Price:  103.71394437112455
curr_Factors:  [103.71394437]
mat_Sqrt:  [[0.15]]
grads:  [-0.01005422]
Stock Position:  -0.010054217177745503
Bond Position:  [-10.68288281]


portfolio before change:  [-11.71681107]
curr_Stock_Price:  102.70245769706985
curr_Factors:  [102.7024577]
mat_Sqrt:  [[0.15]]
grads:  [-0.20568736]
Stock Position:  -0.20568736176803598
Bond Position:  [9.4077865]


portfolio before change:  [-11.54500983]
curr_Stock_Price:  101.87292110962335
curr_Factors:  [101.87292111]
mat_Sqrt:  [[0.15]]
grads:  [0.03191561]
Stock Position:  0.03191560643517369
Bond Position:  [-14.79634589]


portfolio before change:  [-11.53524255]
curr_Stock_Price:  102.23691042935731
curr_Factors:  [102.23691043]
mat_Sqrt:  [[0.15]]
grads:  [0.05402415]
Stock Position:  0.054024151049919526
Bond Position:  [-17.05850484]


portfolio before change:  [-11.49890981]
curr_Stock_Price:  102.94891022999118
curr_Factors:  [102.94891023]
mat_Sqrt:  [[0.15]]
grads:  [-0.03605598]
Stock Position:  -0.03605597597859392
Bond Position:  [-7.78698638]


portfolio before change:  [-11.52240254]
curr_Stock_Price:  103.5734749345464
curr_Factors:  [103.57347493]
mat_Sqrt:  [[0.15]]
grads:  [-0.00619644]
Stock Position:  -0.006196440693491066
Bond Position:  [-10.88061564]


portfolio before change:  [-11.52424868]
curr_Stock_Price:  103.65190395998037
curr_Factors:  [103.65190396]
mat_Sqrt:  [[0.15]]
grads:  [-0.03023873]
Stock Position:  -0.030238727065081072
Bond Position:  [-8.38994705]


portfolio before change:  [-11.51286764]
curr_Stock_Price:  103.24084669116846
curr_Factors:  [103.24084669]
mat_Sqrt:  [[0.15]]
grads:  [-0.05154796]
Stock Position:  -0.05154795601951783
Bond Position:  [-6.19101302]


portfolio before change:  [-11.48730557]
curr_Stock_Price:  102.72994393156007
curr_Factors:  [102.72994393]
mat_Sqrt:  [[0.15]]
grads:  [0.01090054]
Stock Position:  0.01090054215768253
Bond Position:  [-12.60711766]


portfolio before change:  [-11.4858246]
curr_Stock_Price:  103.01038522783576
curr_Factors:  [103.01038523]
mat_Sqrt:  [[0.15]]
grads:  [0.16015138]
Stock Position:  0.16015138441063115
Bond Position:  [-27.9830804]


portfolio before change:  [-11.44593919]
curr_Stock_Price:  103.28127589628727
curr_Factors:  [103.2812759]
mat_Sqrt:  [[0.15]]
grads:  [-0.06878804]
Stock Position:  -0.06878803573623284
Bond Position:  [-4.34142309]


portfolio before change:  [-11.46948781]
curr_Stock_Price:  103.615722258291
curr_Factors:  [103.61572226]
mat_Sqrt:  [[0.15]]
grads:  [0.04176468]
Stock Position:  0.041764681481130626
Bond Position:  [-15.79696544]


portfolio before change:  [-11.50781171]
curr_Stock_Price:  102.74538986762963
curr_Factors:  [102.74538987]
mat_Sqrt:  [[0.15]]
grads:  [-0.08535239]
Stock Position:  -0.08535238712406303
Bond Position:  [-2.73824741]


portfolio before change:  [-11.63081798]
curr_Stock_Price:  104.18253742635204
curr_Factors:  [104.18253743]
mat_Sqrt:  [[0.15]]
grads:  [0.00513291]
Stock Position:  0.005132912748036292
Bond Position:  [-12.16557786]


portfolio before change:  [-11.6251892]
curr_Stock_Price:  105.5754267252476
curr_Factors:  [105.57542673]
mat_Sqrt:  [[0.15]]
grads:  [-0.04321027]
Stock Position:  -0.04321026762124965
Bond Position:  [-7.06324675]


portfolio before change:  [-11.60743729]
curr_Stock_Price:  105.14416666863099
curr_Factors:  [105.14416667]
mat_Sqrt:  [[0.15]]
grads:  [0.01145227]
Stock Position:  0.011452274318821965
Bond Position:  [-12.81157713]


portfolio before change:  [-11.58791192]
curr_Stock_Price:  106.9889461996118
curr_Factors:  [106.9889462]
mat_Sqrt:  [[0.15]]
grads:  [0.16429033]
Stock Position:  0.16429032602926905
Bond Position:  [-29.16516077]


portfolio before change:  [-11.59358107]
curr_Stock_Price:  106.97663095350133
curr_Factors:  [106.97663095]
mat_Sqrt:  [[0.15]]
grads:  [0.04609027]
Stock Position:  0.046090274217583674
Bond Position:  [-16.52416332]


portfolio before change:  [-11.59815193]
curr_Stock_Price:  106.92227658145178
curr_Factors:  [106.92227658]
mat_Sqrt:  [[0.15]]
grads:  [0.12676822]
Stock Position:  0.12676822046792338
Bond Position:  [-25.15249866]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.59815193]
Stock Price:  105.66821368311494
PL:  [-17.26636561]
Settle:  Tensor("sub_258:0", shape=(), dtype=float64)
PL:  Tensor("sub_259:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  130
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.08330061e-03]
 [ 2.03066081e-03]
 [ 1.21608322e-02]
 [ 2.43998803e-02]
 [ 2.44393330e-03]
 [ 2.99774416e-02]
 [ 2.50796998e-02]
 [-3.09076110e-03]
 [ 1.53833223e-02]
 [-2.72154591e-04]
 [ 8.07852018e-04]
 [-5.14794119e-03]
 [-3.25546192e-03]
 [ 1.06172548e-02]
 [ 2.98354095e-03]
 [-1.23598552e-02]
 [-5.76128097e-03]
 [ 8.44948743e-05]
 [-7.62902891e-03]
 [-2.58814175e-03]
 [ 5.67331260e-04]
 [ 1.29812561e-02]
 [ 4.75498665e-03]
 [ 5.50537363e-03]
 [ 1.55925451e-03]
 [-2.23461389e-03]
 [ 6.44265677e-05]
 [-1.78904341e-02]
 [-2.85657825e-02]
 [ 2.18369019e-02]
 [ 2.66360554e-03]
 [-7.53886642e-03]
 [-1.23840340e-02]
 [-7.04244067e-03]
 [-6.44920213e-03]
 [-2.32103726e-03]
 [ 1.81849562e-02]
 [ 1.37047518e-02]
 [ 1.56699214e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.42141913]
curr_Stock_Price:  99.59018760945605
curr_Factors:  [99.59018761]
mat_Sqrt:  [[0.15]]
grads:  [-0.02055534]
Stock Position:  -0.020555337404644707
Bond Position:  [-2.37430922]


portfolio before change:  [-4.42358799]
curr_Stock_Price:  99.6812614200003
curr_Factors:  [99.68126142]
mat_Sqrt:  [[0.15]]
grads:  [0.01353774]
Stock Position:  0.013537738751943895
Bond Position:  [-5.77304686]


portfolio before change:  [-4.41209536]
curr_Stock_Price:  100.58350208371141
curr_Factors:  [100.58350208]
mat_Sqrt:  [[0.15]]
grads:  [0.08107221]
Stock Position:  0.08107221452444455
Bond Position:  [-12.56662262]


portfolio before change:  [-4.36098685]
curr_Stock_Price:  101.23328619027146
curr_Factors:  [101.23328619]
mat_Sqrt:  [[0.15]]
grads:  [0.16266587]
Stock Position:  0.16266586856000412
Bond Position:  [-20.82818728]


portfolio before change:  [-4.26040809]
curr_Stock_Price:  101.867607636179
curr_Factors:  [101.86760764]
mat_Sqrt:  [[0.15]]
grads:  [0.01629289]
Stock Position:  0.01629288864523766
Bond Position:  [-5.92012568]


portfolio before change:  [-4.26168129]
curr_Stock_Price:  101.83488529503114
curr_Factors:  [101.8348853]
mat_Sqrt:  [[0.15]]
grads:  [0.19984961]
Stock Position:  0.19984961059154494
Bond Position:  [-24.61334346]


portfolio before change:  [-4.47881346]
curr_Stock_Price:  100.76380337031786
curr_Factors:  [100.76380337]
mat_Sqrt:  [[0.15]]
grads:  [0.167198]
Stock Position:  0.16719799857007206
Bond Position:  [-21.32631971]


portfolio before change:  [-4.62710329]
curr_Stock_Price:  99.89283674260342
curr_Factors:  [99.89283674]
mat_Sqrt:  [[0.15]]
grads:  [-0.02060507]
Stock Position:  -0.020605074010441017
Bond Position:  [-2.568804]


portfolio before change:  [-4.60275884]
curr_Stock_Price:  98.69577369115757
curr_Factors:  [98.69577369]
mat_Sqrt:  [[0.15]]
grads:  [0.10255548]
Stock Position:  0.10255548221607957
Bond Position:  [-14.7245515]


portfolio before change:  [-4.65541682]
curr_Stock_Price:  98.20026337213326
curr_Factors:  [98.20026337]
mat_Sqrt:  [[0.15]]
grads:  [-0.00181436]
Stock Position:  -0.00181436394122675
Bond Position:  [-4.47724581]


portfolio before change:  [-4.65580192]
curr_Stock_Price:  98.10403367078564
curr_Factors:  [98.10403367]
mat_Sqrt:  [[0.15]]
grads:  [0.00538568]
Stock Position:  0.005385680118874294
Bond Position:  [-5.18415886]


portfolio before change:  [-4.65951074]
curr_Stock_Price:  97.53572010537472
curr_Factors:  [97.53572011]
mat_Sqrt:  [[0.15]]
grads:  [-0.03431961]
Stock Position:  -0.03431960794683937
Bond Position:  [-1.31212306]


portfolio before change:  [-4.71288959]
curr_Stock_Price:  99.08628653829805
curr_Factors:  [99.08628654]
mat_Sqrt:  [[0.15]]
grads:  [-0.02170308]
Stock Position:  -0.021703079439644463
Bond Position:  [-2.56241205]


portfolio before change:  [-4.70508692]
curr_Stock_Price:  98.71200789106304
curr_Factors:  [98.71200789]
mat_Sqrt:  [[0.15]]
grads:  [0.0707817]
Stock Position:  0.07078169840959188
Bond Position:  [-11.69209049]


portfolio before change:  [-4.77301428]
curr_Stock_Price:  97.77298320943095
curr_Factors:  [97.77298321]
mat_Sqrt:  [[0.15]]
grads:  [0.01989027]
Stock Position:  0.019890273013309694
Bond Position:  [-6.71774561]


portfolio before change:  [-4.77358381]
curr_Stock_Price:  97.78657001360843
curr_Factors:  [97.78657001]
mat_Sqrt:  [[0.15]]
grads:  [-0.08239903]
Stock Position:  -0.08239903435039456
Bond Position:  [3.28393514]


portfolio before change:  [-4.76131913]
curr_Stock_Price:  97.64270721133829
curr_Factors:  [97.64270721]
mat_Sqrt:  [[0.15]]
grads:  [-0.03840854]
Stock Position:  -0.03840853980835893
Bond Position:  [-1.01100532]


portfolio before change:  [-4.71415828]
curr_Stock_Price:  96.41154265868828
curr_Factors:  [96.41154266]
mat_Sqrt:  [[0.15]]
grads:  [0.0005633]
Stock Position:  0.0005632991622069321
Bond Position:  [-4.76846682]


portfolio before change:  [-4.71460939]
curr_Stock_Price:  96.66892674162226
curr_Factors:  [96.66892674]
mat_Sqrt:  [[0.15]]
grads:  [-0.05086019]
Stock Position:  -0.05086019270899747
Bond Position:  [0.20199085]


portfolio before change:  [-4.70935257]
curr_Stock_Price:  96.56606481031525
curr_Factors:  [96.56606481]
mat_Sqrt:  [[0.15]]
grads:  [-0.01725428]
Stock Position:  -0.017254278328193307
Bond Position:  [-3.04317481]


portfolio before change:  [-4.71745258]
curr_Stock_Price:  97.01346650276034
curr_Factors:  [97.0134665]
mat_Sqrt:  [[0.15]]
grads:  [0.00378221]
Stock Position:  0.0037822084019153773
Bond Position:  [-5.08437773]


portfolio before change:  [-4.72476537]
curr_Stock_Price:  95.24804152290336
curr_Factors:  [95.24804152]
mat_Sqrt:  [[0.15]]
grads:  [0.08654171]
Stock Position:  0.08654170715996573
Bond Position:  [-12.96769349]


portfolio before change:  [-4.77391658]
curr_Stock_Price:  94.69882485586766
curr_Factors:  [94.69882486]
mat_Sqrt:  [[0.15]]
grads:  [0.03169991]
Stock Position:  0.03169991099506826
Bond Position:  [-7.7758609]


portfolio before change:  [-4.76393274]
curr_Stock_Price:  95.04443745442403
curr_Factors:  [95.04443745]
mat_Sqrt:  [[0.15]]
grads:  [0.03670249]
Stock Position:  0.03670249086495551
Bond Position:  [-8.25230034]


portfolio before change:  [-4.74410197]
curr_Stock_Price:  95.61285573100011
curr_Factors:  [95.61285573]
mat_Sqrt:  [[0.15]]
grads:  [0.01039503]
Stock Position:  0.01039503007105716
Bond Position:  [-5.73800048]


portfolio before change:  [-4.74880738]
curr_Stock_Price:  95.22920021503084
curr_Factors:  [95.22920022]
mat_Sqrt:  [[0.15]]
grads:  [-0.01489743]
Stock Position:  -0.01489742595322181
Bond Position:  [-3.33013742]


portfolio before change:  [-4.76010253]
curr_Stock_Price:  95.95945103633818
curr_Factors:  [95.95945104]
mat_Sqrt:  [[0.15]]
grads:  [0.00042951]
Stock Position:  0.0004295104513178606
Bond Position:  [-4.80131812]


portfolio before change:  [-4.76082928]
curr_Stock_Price:  95.6648072854846
curr_Factors:  [95.66480729]
mat_Sqrt:  [[0.15]]
grads:  [-0.11926956]
Stock Position:  -0.11926956087945462
Bond Position:  [6.64907027]


portfolio before change:  [-4.80747537]
curr_Stock_Price:  96.06287420582409
curr_Factors:  [96.06287421]
mat_Sqrt:  [[0.15]]
grads:  [-0.19043855]
Stock Position:  -0.19043854974808538
Bond Position:  [13.48659908]


portfolio before change:  [-4.80316322]
curr_Stock_Price:  96.04908384289058
curr_Factors:  [96.04908384]
mat_Sqrt:  [[0.15]]
grads:  [0.14557935]
Stock Position:  0.14557934628704708
Bond Position:  [-18.78592606]


portfolio before change:  [-4.80327744]
curr_Stock_Price:  96.06443055177233
curr_Factors:  [96.06443055]
mat_Sqrt:  [[0.15]]
grads:  [0.01775737]
Stock Position:  0.017757370262306785
Bond Position:  [-6.5091291]


portfolio before change:  [-4.80808099]
curr_Stock_Price:  95.83974344283956
curr_Factors:  [95.83974344]
mat_Sqrt:  [[0.15]]
grads:  [-0.05025911]
Stock Position:  -0.050259109497193755
Bond Position:  [0.00873917]


portfolio before change:  [-4.77394707]
curr_Stock_Price:  95.16060647736481
curr_Factors:  [95.16060648]
mat_Sqrt:  [[0.15]]
grads:  [-0.08256023]
Stock Position:  -0.08256022649448518
Bond Position:  [3.08253415]


portfolio before change:  [-4.72939852]
curr_Stock_Price:  94.62568534740127
curr_Factors:  [94.62568535]
mat_Sqrt:  [[0.15]]
grads:  [-0.0469496]
Stock Position:  -0.046949604467427165
Bond Position:  [-0.28676002]


portfolio before change:  [-4.68669448]
curr_Stock_Price:  93.71534992253457
curr_Factors:  [93.71534992]
mat_Sqrt:  [[0.15]]
grads:  [-0.04299468]
Stock Position:  -0.042994680899062325
Bond Position:  [-0.65743292]


portfolio before change:  [-4.67927626]
curr_Stock_Price:  93.54090015871397
curr_Factors:  [93.54090016]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547358]
Stock Position:  -0.015473581743052993
Bond Position:  [-3.23186349]


portfolio before change:  [-4.68019054]
curr_Stock_Price:  93.57387729917917
curr_Factors:  [93.5738773]
mat_Sqrt:  [[0.15]]
grads:  [0.12123304]
Stock Position:  0.12123304157145595
Bond Position:  [-16.02443629]


portfolio before change:  [-4.82401911]
curr_Stock_Price:  92.40401969895173
curr_Factors:  [92.4040197]
mat_Sqrt:  [[0.15]]
grads:  [0.09136501]
Stock Position:  0.09136501174097476
Bond Position:  [-13.26651346]


portfolio before change:  [-4.83715905]
curr_Stock_Price:  92.27835320080318
curr_Factors:  [92.2783532]
mat_Sqrt:  [[0.15]]
grads:  [0.10446614]
Stock Position:  0.10446614240141247
Bond Position:  [-14.47712264]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.83715905]
Stock Price:  92.44201831627522
PL:  [-4.83715905]
Settle:  Tensor("sub_260:0", shape=(), dtype=float64)
PL:  Tensor("sub_261:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  131
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.67546895e-03]
 [-3.84547251e-03]
 [-3.97997938e-02]
 [-3.21780508e-02]
 [-7.34036589e-03]
 [ 2.50140424e-02]
 [-1.71741219e-03]
 [-1.31951085e-02]
 [-1.95795195e-02]
 [ 2.42331375e-03]
 [-2.05168559e-01]
 [-3.49527400e-02]
 [ 2.03012587e-02]
 [-2.97113177e-03]
 [ 3.47204210e-02]
 [ 2.90125524e-03]
 [-1.66003408e-02]
 [ 2.43018468e-04]
 [-7.91060290e-03]
 [-3.52354017e-03]
 [ 1.83397991e-03]
 [-2.67806209e-02]
 [ 4.76532160e-03]
 [ 5.80818434e-03]
 [ 9.00600038e-03]
 [ 1.58839891e-03]
 [ 2.09372540e-02]
 [-2.16947959e-02]
 [-1.62056102e-02]
 [ 2.14596471e-02]
 [ 2.57490777e-03]
 [-1.19841561e-02]
 [-1.22443702e-02]
 [-5.39652789e-03]
 [-6.41710417e-03]
 [-3.53072242e-03]
 [ 1.82528658e-02]
 [ 1.23678481e-02]
 [ 1.75110445e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.69539281]
curr_Stock_Price:  99.50811558716114
curr_Factors:  [99.50811559]
mat_Sqrt:  [[0.15]]
grads:  [-0.02450313]
Stock Position:  -0.024503126316809454
Bond Position:  [-3.25713288]


portfolio before change:  [-5.67733466]
curr_Stock_Price:  98.75452548548522
curr_Factors:  [98.75452549]
mat_Sqrt:  [[0.15]]
grads:  [-0.02563648]
Stock Position:  -0.025636483422476083
Bond Position:  [-3.1456159]


portfolio before change:  [-5.64977855]
curr_Stock_Price:  97.66430815919601
curr_Factors:  [97.66430816]
mat_Sqrt:  [[0.15]]
grads:  [-0.26533196]
Stock Position:  -0.2653319587871513
Bond Position:  [20.26368364]


portfolio before change:  [-5.38672959]
curr_Stock_Price:  96.68245944251936
curr_Factors:  [96.68245944]
mat_Sqrt:  [[0.15]]
grads:  [-0.21452034]
Stock Position:  -0.2145203388090417
Bond Position:  [15.35362437]


portfolio before change:  [-5.41548227]
curr_Stock_Price:  96.82543892582308
curr_Factors:  [96.82543893]
mat_Sqrt:  [[0.15]]
grads:  [-0.04893577]
Stock Position:  -0.048935772605187895
Bond Position:  [-0.67725461]


portfolio before change:  [-5.37420584]
curr_Stock_Price:  95.9802272361029
curr_Factors:  [95.98022724]
mat_Sqrt:  [[0.15]]
grads:  [0.16676028]
Stock Position:  0.1667602827693166
Bond Position:  [-21.37989568]


portfolio before change:  [-5.42753666]
curr_Stock_Price:  95.6764488730194
curr_Factors:  [95.67644887]
mat_Sqrt:  [[0.15]]
grads:  [-0.01144941]
Stock Position:  -0.011449414630914125
Bond Position:  [-4.33209733]


portfolio before change:  [-5.42716134]
curr_Stock_Price:  95.59636886865081
curr_Factors:  [95.59636887]
mat_Sqrt:  [[0.15]]
grads:  [-0.08796739]
Stock Position:  -0.08796739012185
Bond Position:  [2.98220173]


portfolio before change:  [-5.32775962]
curr_Stock_Price:  94.4706230012909
curr_Factors:  [94.470623]
mat_Sqrt:  [[0.15]]
grads:  [-0.13053013]
Stock Position:  -0.1305301303021267
Bond Position:  [7.00350311]


portfolio before change:  [-5.2385815]
curr_Stock_Price:  93.79413073159762
curr_Factors:  [93.79413073]
mat_Sqrt:  [[0.15]]
grads:  [0.01615542]
Stock Position:  0.016155424971662533
Bond Position:  [-6.75386554]


portfolio before change:  [-5.25510475]
curr_Stock_Price:  92.82362282068617
curr_Factors:  [92.82362282]
mat_Sqrt:  [[0.15]]
grads:  [-1.3677904]
Stock Position:  -1.3677903952461337
Bond Position:  [121.70815499]


portfolio before change:  [-6.45101928]
curr_Stock_Price:  93.70908670696657
curr_Factors:  [93.70908671]
mat_Sqrt:  [[0.15]]
grads:  [-0.23301827]
Stock Position:  -0.23301826686502325
Bond Position:  [15.38490969]


portfolio before change:  [-6.26678562]
curr_Stock_Price:  92.92669985698386
curr_Factors:  [92.92669986]
mat_Sqrt:  [[0.15]]
grads:  [0.13534172]
Stock Position:  0.13534172477316875
Bond Position:  [-18.84364546]


portfolio before change:  [-6.20283983]
curr_Stock_Price:  93.41658126442033
curr_Factors:  [93.41658126]
mat_Sqrt:  [[0.15]]
grads:  [-0.01980755]
Stock Position:  -0.01980754515807463
Bond Position:  [-4.35248668]


portfolio before change:  [-6.17965476]
curr_Stock_Price:  92.21859537785986
curr_Factors:  [92.21859538]
mat_Sqrt:  [[0.15]]
grads:  [0.23146947]
Stock Position:  0.23146947357148095
Bond Position:  [-27.52544449]


portfolio before change:  [-6.15820722]
curr_Stock_Price:  92.32611903767031
curr_Factors:  [92.32611904]
mat_Sqrt:  [[0.15]]
grads:  [0.0193417]
Stock Position:  0.0193417016191332
Bond Position:  [-7.94395146]


portfolio before change:  [-6.16703739]
curr_Stock_Price:  91.92092601707753
curr_Factors:  [91.92092602]
mat_Sqrt:  [[0.15]]
grads:  [-0.11066894]
Stock Position:  -0.11066893842055295
Bond Position:  [4.00575391]


portfolio before change:  [-6.15832396]
curr_Stock_Price:  91.8467165064107
curr_Factors:  [91.84671651]
mat_Sqrt:  [[0.15]]
grads:  [0.00162012]
Stock Position:  0.0016201231199892657
Bond Position:  [-6.30712694]


portfolio before change:  [-6.15921031]
curr_Stock_Price:  91.78627909007032
curr_Factors:  [91.78627909]
mat_Sqrt:  [[0.15]]
grads:  [-0.05273735]
Stock Position:  -0.05273735266561347
Bond Position:  [-1.31864494]


portfolio before change:  [-6.12197334]
curr_Stock_Price:  91.07706994236158
curr_Factors:  [91.07706994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02349027]
Stock Position:  -0.023490267813330724
Bond Position:  [-3.98254858]


portfolio before change:  [-6.13306254]
curr_Stock_Price:  91.52795235417967
curr_Factors:  [91.52795235]
mat_Sqrt:  [[0.15]]
grads:  [0.01222653]
Stock Position:  0.01222653273719786
Bond Position:  [-7.25213204]


portfolio before change:  [-6.14127172]
curr_Stock_Price:  90.93067668673102
curr_Factors:  [90.93067669]
mat_Sqrt:  [[0.15]]
grads:  [-0.17853747]
Stock Position:  -0.17853747250423008
Bond Position:  [10.09326147]


portfolio before change:  [-6.10510579]
curr_Stock_Price:  90.73517601186697
curr_Factors:  [90.73517601]
mat_Sqrt:  [[0.15]]
grads:  [0.03176881]
Stock Position:  0.031768810693585815
Bond Position:  [-8.98765442]


portfolio before change:  [-6.09593753]
curr_Stock_Price:  91.0591349476291
curr_Factors:  [91.05913495]
mat_Sqrt:  [[0.15]]
grads:  [0.03872123]
Stock Position:  0.038721228959554224
Bond Position:  [-9.62185914]


portfolio before change:  [-6.04662379]
curr_Stock_Price:  92.36375641020389
curr_Factors:  [92.36375641]
mat_Sqrt:  [[0.15]]
grads:  [0.06004]
Stock Position:  0.060040002543488014
Bond Position:  [-11.59214396]


portfolio before change:  [-6.0529692]
curr_Stock_Price:  92.28220571314422
curr_Factors:  [92.28220571]
mat_Sqrt:  [[0.15]]
grads:  [0.01058933]
Stock Position:  0.010589326076969979
Bond Position:  [-7.03017557]


portfolio before change:  [-6.05710683]
curr_Stock_Price:  91.97446196649831
curr_Factors:  [91.97446197]
mat_Sqrt:  [[0.15]]
grads:  [0.13958169]
Stock Position:  0.13958169350915314
Bond Position:  [-18.89505799]


portfolio before change:  [-6.01620573]
curr_Stock_Price:  92.28441038627317
curr_Factors:  [92.28441039]
mat_Sqrt:  [[0.15]]
grads:  [-0.14463197]
Stock Position:  -0.14463197261953958
Bond Position:  [7.33107059]


portfolio before change:  [-6.07230224]
curr_Stock_Price:  92.6786036969423
curr_Factors:  [92.6786037]
mat_Sqrt:  [[0.15]]
grads:  [-0.1080374]
Stock Position:  -0.1080374014669829
Bond Position:  [3.94045327]


portfolio before change:  [-6.10135336]
curr_Stock_Price:  92.95206183754232
curr_Factors:  [92.95206184]
mat_Sqrt:  [[0.15]]
grads:  [0.14306431]
Stock Position:  0.14306431411796075
Bond Position:  [-19.39947634]


portfolio before change:  [-6.06712731]
curr_Stock_Price:  93.20824829153888
curr_Factors:  [93.20824829]
mat_Sqrt:  [[0.15]]
grads:  [0.01716605]
Stock Position:  0.01716605182345741
Bond Position:  [-7.66714493]


portfolio before change:  [-6.06211624]
curr_Stock_Price:  93.5560001062357
curr_Factors:  [93.55600011]
mat_Sqrt:  [[0.15]]
grads:  [-0.07989437]
Stock Position:  -0.07989437400093641
Bond Position:  [1.41248182]


portfolio before change:  [-6.0567125]
curr_Stock_Price:  93.49057407956195
curr_Factors:  [93.49057408]
mat_Sqrt:  [[0.15]]
grads:  [-0.08162913]
Stock Position:  -0.08162913463048153
Bond Position:  [1.57484216]


portfolio before change:  [-6.07594767]
curr_Stock_Price:  93.7286268070479
curr_Factors:  [93.72862681]
mat_Sqrt:  [[0.15]]
grads:  [-0.03597685]
Stock Position:  -0.03597685260489355
Bond Position:  [-2.70388667]


portfolio before change:  [-6.08158529]
curr_Stock_Price:  93.87593305239977
curr_Factors:  [93.87593305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04278069]
Stock Position:  -0.042780694443001976
Bond Position:  [-2.06550768]


portfolio before change:  [-6.11162711]
curr_Stock_Price:  94.57212607670304
curr_Factors:  [94.57212608]
mat_Sqrt:  [[0.15]]
grads:  [-0.02353815]
Stock Position:  -0.023538149487917753
Bond Position:  [-3.88557427]


portfolio before change:  [-6.09250492]
curr_Stock_Price:  93.73909861033252
curr_Factors:  [93.73909861]
mat_Sqrt:  [[0.15]]
grads:  [0.12168577]
Stock Position:  0.12168577183319337
Bond Position:  [-17.49921948]


portfolio before change:  [-6.13549791]
curr_Stock_Price:  93.40376394329866
curr_Factors:  [93.40376394]
mat_Sqrt:  [[0.15]]
grads:  [0.08245232]
Stock Position:  0.08245232070125263
Bond Position:  [-13.83685501]


portfolio before change:  [-6.1168787]
curr_Stock_Price:  93.65056020594496
curr_Factors:  [93.65056021]
mat_Sqrt:  [[0.15]]
grads:  [0.1167403]
Stock Position:  0.1167402964738395
Bond Position:  [-17.04967287]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.1168787]
Stock Price:  92.7624437390365
PL:  [-6.1168787]
Settle:  Tensor("sub_262:0", shape=(), dtype=float64)
PL:  Tensor("sub_263:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  132
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44982287e-03]
 [ 2.06632252e-03]
 [ 2.16785359e-02]
 [ 1.52774929e-02]
 [-2.21961898e-02]
 [ 3.38344896e-02]
 [ 8.90444532e-03]
 [-7.83414188e-04]
 [ 6.62682089e-03]
 [ 1.22030396e-02]
 [ 2.48960035e-02]
 [-2.37940105e-03]
 [-1.20678940e-02]
 [ 9.74960525e-03]
 [-6.46389507e-03]
 [-2.77702578e-02]
 [ 4.41861182e-03]
 [ 2.09233225e-03]
 [-1.13801158e-02]
 [-2.27351154e-03]
 [ 4.07390154e-04]
 [ 9.35119101e-03]
 [ 4.77517588e-03]
 [ 6.61739175e-03]
 [-3.57078426e-03]
 [-8.67727217e-03]
 [ 1.45323446e-02]
 [-2.55267853e-02]
 [-2.37532176e-02]
 [ 2.16303483e-02]
 [ 9.33733808e-03]
 [ 2.22673602e-03]
 [-1.25267088e-02]
 [-5.64416964e-03]
 [-8.61451787e-03]
 [-7.47594692e-03]
 [ 2.26729396e-02]
 [ 7.32093472e-03]
 [ 2.35219164e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.55590449]
curr_Stock_Price:  100.23294745591649
curr_Factors:  [100.23294746]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966549]
Stock Position:  -0.009665485777596948
Bond Position:  [6.52470462]


portfolio before change:  [5.56628426]
curr_Stock_Price:  99.24343399271403
curr_Factors:  [99.24343399]
mat_Sqrt:  [[0.15]]
grads:  [0.01377548]
Stock Position:  0.013775483460296233
Bond Position:  [4.19915798]


portfolio before change:  [5.58124683]
curr_Stock_Price:  100.29150145532388
curr_Factors:  [100.29150146]
mat_Sqrt:  [[0.15]]
grads:  [0.14452357]
Stock Position:  0.14452357247968156
Bond Position:  [-8.91323925]


portfolio before change:  [5.6760327]
curr_Stock_Price:  100.95506168435357
curr_Factors:  [100.95506168]
mat_Sqrt:  [[0.15]]
grads:  [0.10184995]
Stock Position:  0.10184995251541908
Bond Position:  [-4.60623554]


portfolio before change:  [5.85593482]
curr_Stock_Price:  102.72705993018552
curr_Factors:  [102.72705993]
mat_Sqrt:  [[0.15]]
grads:  [-0.1479746]
Stock Position:  -0.1479745985323013
Bond Position:  [21.05693027]


portfolio before change:  [5.88649569]
curr_Stock_Price:  102.53832084911654
curr_Factors:  [102.53832085]
mat_Sqrt:  [[0.15]]
grads:  [0.22556326]
Stock Position:  0.22556326388116454
Bond Position:  [-17.24238264]


portfolio before change:  [5.79779394]
curr_Stock_Price:  102.15463110302068
curr_Factors:  [102.1546311]
mat_Sqrt:  [[0.15]]
grads:  [0.05936297]
Stock Position:  0.0593629687966694
Bond Position:  [-0.26640823]


portfolio before change:  [5.75992537]
curr_Stock_Price:  101.51727636260271
curr_Factors:  [101.51727636]
mat_Sqrt:  [[0.15]]
grads:  [-0.00522276]
Stock Position:  -0.005222761253175667
Bond Position:  [6.29012587]


portfolio before change:  [5.75861027]
curr_Stock_Price:  101.91963360643409
curr_Factors:  [101.91963361]
mat_Sqrt:  [[0.15]]
grads:  [0.04417881]
Stock Position:  0.044178805956458594
Bond Position:  [1.25592255]


portfolio before change:  [5.78812886]
curr_Stock_Price:  102.5842416244889
curr_Factors:  [102.58424162]
mat_Sqrt:  [[0.15]]
grads:  [0.0813536]
Stock Position:  0.0813535975899088
Bond Position:  [-2.55746825]


portfolio before change:  [5.8226789]
curr_Stock_Price:  103.012861185391
curr_Factors:  [103.01286119]
mat_Sqrt:  [[0.15]]
grads:  [0.16597336]
Stock Position:  0.16597335651961934
Bond Position:  [-11.27471144]


portfolio before change:  [5.80671809]
curr_Stock_Price:  102.92518820959558
curr_Factors:  [102.92518821]
mat_Sqrt:  [[0.15]]
grads:  [-0.01586267]
Stock Position:  -0.015862673635821667
Bond Position:  [7.43938676]


portfolio before change:  [5.81070058]
curr_Stock_Price:  102.73275514519791
curr_Factors:  [102.73275515]
mat_Sqrt:  [[0.15]]
grads:  [-0.08045263]
Stock Position:  -0.08045262676471136
Bond Position:  [14.07582058]


portfolio before change:  [5.8104699]
curr_Stock_Price:  102.75749347070855
curr_Factors:  [102.75749347]
mat_Sqrt:  [[0.15]]
grads:  [0.06499737]
Stock Position:  0.0649973683585803
Bond Position:  [-0.86849675]


portfolio before change:  [5.72533632]
curr_Stock_Price:  101.44936345152809
curr_Factors:  [101.44936345]
mat_Sqrt:  [[0.15]]
grads:  [-0.04309263]
Stock Position:  -0.04309263380097699
Bond Position:  [10.09705659]


portfolio before change:  [5.73782291]
curr_Stock_Price:  101.18889266642934
curr_Factors:  [101.18889267]
mat_Sqrt:  [[0.15]]
grads:  [-0.18513505]
Stock Position:  -0.18513505201320604
Bond Position:  [24.47143381]


portfolio before change:  [5.72314045]
curr_Stock_Price:  101.28472313835927
curr_Factors:  [101.28472314]
mat_Sqrt:  [[0.15]]
grads:  [0.02945741]
Stock Position:  0.0294574121484705
Bond Position:  [2.73955461]


portfolio before change:  [5.73396079]
curr_Stock_Price:  101.64041880359864
curr_Factors:  [101.6404188]
mat_Sqrt:  [[0.15]]
grads:  [0.01394888]
Stock Position:  0.01394888167431155
Bond Position:  [4.31619061]


portfolio before change:  [5.7247435]
curr_Stock_Price:  100.94094696378185
curr_Factors:  [100.94094696]
mat_Sqrt:  [[0.15]]
grads:  [-0.07586744]
Stock Position:  -0.07586743867774275
Bond Position:  [13.3828746]


portfolio before change:  [5.80382194]
curr_Stock_Price:  99.92067421060617
curr_Factors:  [99.92067421]
mat_Sqrt:  [[0.15]]
grads:  [-0.01515674]
Stock Position:  -0.015156743615992395
Bond Position:  [7.31829398]


portfolio before change:  [5.79641425]
curr_Stock_Price:  100.46977229492634
curr_Factors:  [100.46977229]
mat_Sqrt:  [[0.15]]
grads:  [0.00271593]
Stock Position:  0.0027159343601055826
Bond Position:  [5.52354494]


portfolio before change:  [5.79700835]
curr_Stock_Price:  100.43428547236357
curr_Factors:  [100.43428547]
mat_Sqrt:  [[0.15]]
grads:  [0.06234127]
Stock Position:  0.06234127342052319
Bond Position:  [-0.4641929]


portfolio before change:  [5.7968613]
curr_Stock_Price:  100.43285749380881
curr_Factors:  [100.43285749]
mat_Sqrt:  [[0.15]]
grads:  [0.03183451]
Stock Position:  0.03183450583553233
Bond Position:  [2.59963091]


portfolio before change:  [5.79156681]
curr_Stock_Price:  100.25633625949669
curr_Factors:  [100.25633626]
mat_Sqrt:  [[0.15]]
grads:  [0.04411595]
Stock Position:  0.0441159450140227
Bond Position:  [1.36866379]


portfolio before change:  [5.82014974]
curr_Stock_Price:  100.90036263663616
curr_Factors:  [100.90036264]
mat_Sqrt:  [[0.15]]
grads:  [-0.02380523]
Stock Position:  -0.023805228421008556
Bond Position:  [8.22210592]


portfolio before change:  [5.82078669]
curr_Stock_Price:  100.91678214290667
curr_Factors:  [100.91678214]
mat_Sqrt:  [[0.15]]
grads:  [-0.05784848]
Stock Position:  -0.057848481154054755
Bond Position:  [11.65866926]


portfolio before change:  [5.88918155]
curr_Stock_Price:  99.75966564076693
curr_Factors:  [99.75966564]
mat_Sqrt:  [[0.15]]
grads:  [0.0968823]
Stock Position:  0.096882297486408
Bond Position:  [-3.77576405]


portfolio before change:  [5.88049375]
curr_Stock_Price:  99.67486374723899
curr_Factors:  [99.67486375]
mat_Sqrt:  [[0.15]]
grads:  [-0.17017857]
Stock Position:  -0.17017856867775527
Bond Position:  [22.84301939]


portfolio before change:  [5.84280578]
curr_Stock_Price:  99.91310480218618
curr_Factors:  [99.9131048]
mat_Sqrt:  [[0.15]]
grads:  [-0.15835478]
Stock Position:  -0.15835478418893514
Bond Position:  [21.66452393]


portfolio before change:  [5.75470977]
curr_Stock_Price:  100.48652759230595
curr_Factors:  [100.48652759]
mat_Sqrt:  [[0.15]]
grads:  [0.14420232]
Stock Position:  0.1442023217476743
Bond Position:  [-8.73568081]


portfolio before change:  [5.62027402]
curr_Stock_Price:  99.56182867949786
curr_Factors:  [99.56182868]
mat_Sqrt:  [[0.15]]
grads:  [0.06224892]
Stock Position:  0.06224892054900156
Bond Position:  [-0.57734235]


portfolio before change:  [5.65824375]
curr_Stock_Price:  100.17295425112597
curr_Factors:  [100.17295425]
mat_Sqrt:  [[0.15]]
grads:  [0.01484491]
Stock Position:  0.014844906777717378
Bond Position:  [4.17118558]


portfolio before change:  [5.64995567]
curr_Stock_Price:  99.5795179059559
curr_Factors:  [99.57951791]
mat_Sqrt:  [[0.15]]
grads:  [-0.08351139]
Stock Position:  -0.08351139178031768
Bond Position:  [13.96597981]


portfolio before change:  [5.60339263]
curr_Stock_Price:  100.15798867905372
curr_Factors:  [100.15798868]
mat_Sqrt:  [[0.15]]
grads:  [-0.0376278]
Stock Position:  -0.037627797618800016
Bond Position:  [9.37211716]


portfolio before change:  [5.62856815]
curr_Stock_Price:  99.52005779517062
curr_Factors:  [99.5200578]
mat_Sqrt:  [[0.15]]
grads:  [-0.05743012]
Stock Position:  -0.05743011912809351
Bond Position:  [11.34401693]


portfolio before change:  [5.6099278]
curr_Stock_Price:  99.8693247545089
curr_Factors:  [99.86932475]
mat_Sqrt:  [[0.15]]
grads:  [-0.04983965]
Stock Position:  -0.049839646140937034
Bond Position:  [10.58737961]


portfolio before change:  [5.60770814]
curr_Stock_Price:  99.9404160920501
curr_Factors:  [99.94041609]
mat_Sqrt:  [[0.15]]
grads:  [0.15115293]
Stock Position:  0.15115293089341061
Bond Position:  [-9.49857867]


portfolio before change:  [5.61700234]
curr_Stock_Price:  100.00976040962057
curr_Factors:  [100.00976041]
mat_Sqrt:  [[0.15]]
grads:  [0.04880623]
Stock Position:  0.04880623149545759
Bond Position:  [0.73590282]


portfolio before change:  [5.58487508]
curr_Stock_Price:  99.34961406206666
curr_Factors:  [99.34961406]
mat_Sqrt:  [[0.15]]
grads:  [0.15681278]
Stock Position:  0.1568127758768805
Bond Position:  [-9.99441369]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.58487508]
Stock Price:  98.74953055180892
PL:  [5.58487508]
Settle:  Tensor("sub_264:0", shape=(), dtype=float64)
PL:  Tensor("sub_265:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  133
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.84216741e-03]
 [ 2.24114594e-04]
 [-3.82668805e-03]
 [ 4.49623281e-02]
 [ 1.25873043e-02]
 [ 3.39601924e-02]
 [ 4.33548550e-03]
 [-5.48792148e-05]
 [ 2.90825121e-03]
 [ 5.46134533e-03]
 [ 5.56977654e-03]
 [ 2.58504502e-03]
 [ 5.88442508e-03]
 [ 1.10783633e-02]
 [-6.50226649e-03]
 [-2.78971958e-02]
 [ 1.05083522e-03]
 [-3.42641334e-03]
 [-1.12239198e-02]
 [-2.23424543e-03]
 [ 4.07740024e-04]
 [ 1.05413260e-02]
 [ 4.77445061e-03]
 [ 6.53886197e-03]
 [-4.58259570e-03]
 [-9.31129655e-03]
 [ 1.29106194e-02]
 [-1.95972856e-02]
 [-1.61490875e-02]
 [ 2.19102955e-02]
 [ 8.86504780e-03]
 [ 2.07603599e-03]
 [-1.24554491e-02]
 [-6.68850269e-03]
 [-6.06942040e-03]
 [-7.48244166e-03]
 [ 2.27846213e-02]
 [ 2.04779392e-03]
 [ 2.22663760e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [18.23333523]
curr_Stock_Price:  101.04965379377695
curr_Factors:  [101.04965379]
mat_Sqrt:  [[0.15]]
grads:  [-0.01894778]
Stock Position:  -0.01894778270902853
Bond Position:  [20.14800212]


portfolio before change:  [18.21941921]
curr_Stock_Price:  101.9170209465085
curr_Factors:  [101.91702095]
mat_Sqrt:  [[0.15]]
grads:  [0.0014941]
Stock Position:  0.0014940972951197132
Bond Position:  [18.06714526]


portfolio before change:  [18.22132893]
curr_Stock_Price:  101.6835642153736
curr_Factors:  [101.68356422]
mat_Sqrt:  [[0.15]]
grads:  [-0.02551125]
Stock Position:  -0.02551125363753625
Bond Position:  [20.81540413]


portfolio before change:  [18.22075128]
curr_Stock_Price:  101.80820518679165
curr_Factors:  [101.80820519]
mat_Sqrt:  [[0.15]]
grads:  [0.29974885]
Stock Position:  0.29974885370999776
Bond Position:  [-12.29614153]


portfolio before change:  [18.14812137]
curr_Stock_Price:  101.57103064851907
curr_Factors:  [101.57103065]
mat_Sqrt:  [[0.15]]
grads:  [0.08391536]
Stock Position:  0.08391536193140574
Bond Position:  [9.62475157]


portfolio before change:  [18.23241882]
curr_Stock_Price:  102.56124611451783
curr_Factors:  [102.56124611]
mat_Sqrt:  [[0.15]]
grads:  [0.22640128]
Stock Position:  0.22640128283354416
Bond Position:  [-4.98757887]


portfolio before change:  [18.33313238]
curr_Stock_Price:  103.00884536099893
curr_Factors:  [103.00884536]
mat_Sqrt:  [[0.15]]
grads:  [0.02890324]
Stock Position:  0.028903236697044005
Bond Position:  [15.35584334]


portfolio before change:  [18.3023725]
curr_Stock_Price:  101.87819403215815
curr_Factors:  [101.87819403]
mat_Sqrt:  [[0.15]]
grads:  [-0.00036586]
Stock Position:  -0.00036586143228247787
Bond Position:  [18.3396458]


portfolio before change:  [18.30495294]
curr_Stock_Price:  101.09144812991477
curr_Factors:  [101.09144813]
mat_Sqrt:  [[0.15]]
grads:  [0.01938834]
Stock Position:  0.019388341417072165
Bond Position:  [16.34495743]


portfolio before change:  [18.2981414]
curr_Stock_Price:  100.63474145220727
curr_Factors:  [100.63474145]
mat_Sqrt:  [[0.15]]
grads:  [0.03640897]
Stock Position:  0.03640896885791241
Bond Position:  [14.63413423]


portfolio before change:  [18.27590699]
curr_Stock_Price:  99.97381120753887
curr_Factors:  [99.97381121]
mat_Sqrt:  [[0.15]]
grads:  [0.03713184]
Stock Position:  0.03713184361786567
Bond Position:  [14.56369507]


portfolio before change:  [18.22825261]
curr_Stock_Price:  98.64139792916963
curr_Factors:  [98.64139793]
mat_Sqrt:  [[0.15]]
grads:  [0.01723363]
Stock Position:  0.017233633487605395
Bond Position:  [16.52830291]


portfolio before change:  [18.22497836]
curr_Stock_Price:  98.33151465356538
curr_Factors:  [98.33151465]
mat_Sqrt:  [[0.15]]
grads:  [0.0392295]
Stock Position:  0.03922950052885768
Bond Position:  [14.36748215]


portfolio before change:  [18.2884726]
curr_Stock_Price:  99.90426468974562
curr_Factors:  [99.90426469]
mat_Sqrt:  [[0.15]]
grads:  [0.07385576]
Stock Position:  0.07385575550297403
Bond Position:  [10.90996766]


portfolio before change:  [18.40290279]
curr_Stock_Price:  101.43517247204142
curr_Factors:  [101.43517247]
mat_Sqrt:  [[0.15]]
grads:  [-0.04334844]
Stock Position:  -0.04334844328318036
Bond Position:  [22.79995961]


portfolio before change:  [18.41530866]
curr_Stock_Price:  101.21473315130883
curr_Factors:  [101.21473315]
mat_Sqrt:  [[0.15]]
grads:  [-0.18598131]
Stock Position:  -0.18598130506653565
Bond Position:  [37.23935682]


portfolio before change:  [18.68923204]
curr_Stock_Price:  99.76690931103994
curr_Factors:  [99.76690931]
mat_Sqrt:  [[0.15]]
grads:  [0.00700557]
Stock Position:  0.007005568117671829
Bond Position:  [17.99030816]


portfolio before change:  [18.69474342]
curr_Stock_Price:  100.23260382228429
curr_Factors:  [100.23260382]
mat_Sqrt:  [[0.15]]
grads:  [-0.02284276]
Stock Position:  -0.022842755621491198
Bond Position:  [20.9843323]


portfolio before change:  [18.68035767]
curr_Stock_Price:  100.97721429274942
curr_Factors:  [100.97721429]
mat_Sqrt:  [[0.15]]
grads:  [-0.07482613]
Stock Position:  -0.07482613180031975
Bond Position:  [26.23609202]


portfolio before change:  [18.67541511]
curr_Stock_Price:  101.08709949243958
curr_Factors:  [101.08709949]
mat_Sqrt:  [[0.15]]
grads:  [-0.01489497]
Stock Position:  -0.014894969565216038
Bond Position:  [20.18110438]


portfolio before change:  [18.69425446]
curr_Stock_Price:  99.99165837571388
curr_Factors:  [99.99165838]
mat_Sqrt:  [[0.15]]
grads:  [0.00271827]
Stock Position:  0.0027182668298895863
Bond Position:  [18.42245045]


portfolio before change:  [18.69623282]
curr_Stock_Price:  99.87224782567239
curr_Factors:  [99.87224783]
mat_Sqrt:  [[0.15]]
grads:  [0.07027551]
Stock Position:  0.07027550647635501
Bond Position:  [11.67766002]


portfolio before change:  [18.73315822]
curr_Stock_Price:  100.37691290221677
curr_Factors:  [100.3769129]
mat_Sqrt:  [[0.15]]
grads:  [0.03182967]
Stock Position:  0.03182967073720979
Bond Position:  [15.53819413]


portfolio before change:  [18.72861833]
curr_Stock_Price:  100.173257690355
curr_Factors:  [100.17325769]
mat_Sqrt:  [[0.15]]
grads:  [0.04359241]
Stock Position:  0.043592413118286905
Bond Position:  [14.3618243]


portfolio before change:  [18.73747122]
curr_Stock_Price:  100.33515625704706
curr_Factors:  [100.33515626]
mat_Sqrt:  [[0.15]]
grads:  [-0.03055064]
Stock Position:  -0.030550637999036304
Bond Position:  [21.80277426]


portfolio before change:  [18.73210713]
curr_Stock_Price:  100.59994968099372
curr_Factors:  [100.59994968]
mat_Sqrt:  [[0.15]]
grads:  [-0.06207531]
Stock Position:  -0.0620753103551209
Bond Position:  [24.97688023]


portfolio before change:  [18.75405698]
curr_Stock_Price:  100.29664799793363
curr_Factors:  [100.296648]
mat_Sqrt:  [[0.15]]
grads:  [0.0860708]
Stock Position:  0.08607079595037814
Bond Position:  [10.12144466]


portfolio before change:  [18.80271567]
curr_Stock_Price:  100.84728106776197
curr_Factors:  [100.84728107]
mat_Sqrt:  [[0.15]]
grads:  [-0.13064857]
Stock Position:  -0.1306485705761667
Bond Position:  [31.97826879]


portfolio before change:  [18.81157915]
curr_Stock_Price:  100.81003653066288
curr_Factors:  [100.81003653]
mat_Sqrt:  [[0.15]]
grads:  [-0.10766058]
Stock Position:  -0.1076605832722447
Bond Position:  [29.66484648]


portfolio before change:  [18.80143733]
curr_Stock_Price:  100.93868306530001
curr_Factors:  [100.93868307]
mat_Sqrt:  [[0.15]]
grads:  [0.14606864]
Stock Position:  0.14606863664511066
Bond Position:  [4.05746151]


portfolio before change:  [18.69498147]
curr_Stock_Price:  100.20640353458222
curr_Factors:  [100.20640353]
mat_Sqrt:  [[0.15]]
grads:  [0.05910032]
Stock Position:  0.0591003186503128
Bond Position:  [12.77275109]


portfolio before change:  [18.69147927]
curr_Stock_Price:  100.12012839009516
curr_Factors:  [100.12012839]
mat_Sqrt:  [[0.15]]
grads:  [0.01384024]
Stock Position:  0.013840239928349946
Bond Position:  [17.30579267]


portfolio before change:  [18.70080778]
curr_Stock_Price:  100.63783253810155
curr_Factors:  [100.63783254]
mat_Sqrt:  [[0.15]]
grads:  [-0.08303633]
Stock Position:  -0.08303632719127373
Bond Position:  [27.05740377]


portfolio before change:  [18.63936003]
curr_Stock_Price:  101.41857681802853
curr_Factors:  [101.41857682]
mat_Sqrt:  [[0.15]]
grads:  [-0.04459002]
Stock Position:  -0.04459001790779588
Bond Position:  [23.16161619]


portfolio before change:  [18.68444283]
curr_Stock_Price:  100.47245893779919
curr_Factors:  [100.47245894]
mat_Sqrt:  [[0.15]]
grads:  [-0.0404628]
Stock Position:  -0.04046280263872602
Bond Position:  [22.7498401]


portfolio before change:  [18.71697447]
curr_Stock_Price:  99.73875462832504
curr_Factors:  [99.73875463]
mat_Sqrt:  [[0.15]]
grads:  [-0.04988294]
Stock Position:  -0.049882944408230566
Bond Position:  [23.69223722]


portfolio before change:  [18.67245434]
curr_Stock_Price:  100.69061981854458
curr_Factors:  [100.69061982]
mat_Sqrt:  [[0.15]]
grads:  [0.15189748]
Stock Position:  0.15189747514229082
Bond Position:  [3.37780342]


portfolio before change:  [18.86183558]
curr_Stock_Price:  101.93461008371531
curr_Factors:  [101.93461008]
mat_Sqrt:  [[0.15]]
grads:  [0.01365196]
Stock Position:  0.013651959454734908
Bond Position:  [17.47022841]


portfolio before change:  [18.86720315]
curr_Stock_Price:  102.16781152041841
curr_Factors:  [102.16781152]
mat_Sqrt:  [[0.15]]
grads:  [0.14844251]
Stock Position:  0.14844250649411278
Bond Position:  [3.70115712]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [18.86720315]
Stock Price:  103.08453237617502
PL:  [15.78267077]
Settle:  Tensor("sub_266:0", shape=(), dtype=float64)
PL:  Tensor("sub_267:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  134
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.19332370e-03]
 [-1.25276680e-02]
 [ 9.02990696e-03]
 [ 3.18284264e-03]
 [ 2.11643751e-02]
 [ 2.89360280e-02]
 [ 8.95770841e-03]
 [ 1.42193751e-03]
 [ 1.40212816e-02]
 [ 1.42504712e-02]
 [ 8.59965816e-03]
 [-1.74953192e-02]
 [-1.15597887e-02]
 [-1.65589368e-02]
 [ 5.25621385e-03]
 [-3.39562692e-02]
 [ 4.79187275e-03]
 [-1.63424523e-02]
 [ 1.63575903e-02]
 [-4.34829104e-03]
 [-2.18592574e-03]
 [-3.96023070e-02]
 [ 4.82817163e-03]
 [ 1.21171352e-02]
 [-5.63357472e-03]
 [ 5.14793660e-03]
 [-7.57184226e-03]
 [ 3.60619603e-03]
 [ 4.28622110e-02]
 [ 2.42313342e-02]
 [-6.76632689e-03]
 [ 6.36670813e-03]
 [-1.25444336e-02]
 [-5.49283737e-03]
 [-5.49008581e-03]
 [-5.28731027e-03]
 [ 2.28045936e-02]
 [ 6.80477949e-03]
 [ 2.32058107e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.91752823]
curr_Stock_Price:  101.15815299387035
curr_Factors:  [101.15815299]
mat_Sqrt:  [[0.15]]
grads:  [-0.02128882]
Stock Position:  -0.021288824686405205
Bond Position:  [22.07106642]


portfolio before change:  [19.93372584]
curr_Stock_Price:  100.52690369889173
curr_Factors:  [100.5269037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08351779]
Stock Position:  -0.08351778681611584
Bond Position:  [28.32951035]


portfolio before change:  [19.92692185]
curr_Stock_Price:  100.65077428883791
curr_Factors:  [100.65077429]
mat_Sqrt:  [[0.15]]
grads:  [0.06019938]
Stock Position:  0.060199379718458984
Bond Position:  [13.86780767]


portfolio before change:  [19.9272]
curr_Stock_Price:  100.6265973739605
curr_Factors:  [100.62659737]
mat_Sqrt:  [[0.15]]
grads:  [0.02121895]
Stock Position:  0.021218950903433762
Bond Position:  [17.79200917]


portfolio before change:  [19.93950503]
curr_Stock_Price:  101.10168609795606
curr_Factors:  [101.1016861]
mat_Sqrt:  [[0.15]]
grads:  [0.14109583]
Stock Position:  0.1410958339810017
Bond Position:  [5.67447831]


portfolio before change:  [20.00786388]
curr_Stock_Price:  101.58114389683536
curr_Factors:  [101.5811439]
mat_Sqrt:  [[0.15]]
grads:  [0.19290685]
Stock Position:  0.19290685330011734
Bond Position:  [0.41216506]


portfolio before change:  [20.11662403]
curr_Stock_Price:  102.1446730186083
curr_Factors:  [102.14467302]
mat_Sqrt:  [[0.15]]
grads:  [0.05971806]
Stock Position:  0.059718056036894195
Bond Position:  [14.01674273]


portfolio before change:  [20.17449675]
curr_Stock_Price:  103.08443083429272
curr_Factors:  [103.08443083]
mat_Sqrt:  [[0.15]]
grads:  [0.00947958]
Stock Position:  0.009479583421037273
Bond Position:  [19.19729928]


portfolio before change:  [20.18599877]
curr_Stock_Price:  104.0446215997133
curr_Factors:  [104.0446216]
mat_Sqrt:  [[0.15]]
grads:  [0.09347521]
Stock Position:  0.0934752105416113
Bond Position:  [10.46040586]


portfolio before change:  [20.31572307]
curr_Stock_Price:  105.41842620063696
curr_Factors:  [105.4184262]
mat_Sqrt:  [[0.15]]
grads:  [0.09500314]
Stock Position:  0.09500314151987276
Bond Position:  [10.30064141]


portfolio before change:  [20.32211183]
curr_Stock_Price:  105.472120134735
curr_Factors:  [105.47212013]
mat_Sqrt:  [[0.15]]
grads:  [0.05733105]
Stock Position:  0.057331054372843734
Bond Position:  [14.27528397]


portfolio before change:  [20.31523476]
curr_Stock_Price:  105.3210399534181
curr_Factors:  [105.32103995]
mat_Sqrt:  [[0.15]]
grads:  [-0.11663546]
Stock Position:  -0.11663546153842816
Bond Position:  [32.59940287]


portfolio before change:  [20.25187203]
curr_Stock_Price:  105.89923388198395
curr_Factors:  [105.89923388]
mat_Sqrt:  [[0.15]]
grads:  [-0.07706526]
Stock Position:  -0.07706525805192789
Bond Position:  [28.41302381]


portfolio before change:  [20.2458214]
curr_Stock_Price:  106.02383570997829
curr_Factors:  [106.02383571]
mat_Sqrt:  [[0.15]]
grads:  [-0.11039291]
Stock Position:  -0.11039291198189402
Bond Position:  [31.95010137]


portfolio before change:  [20.27810524]
curr_Stock_Price:  105.76757085980559
curr_Factors:  [105.76757086]
mat_Sqrt:  [[0.15]]
grads:  [0.03504143]
Stock Position:  0.03504142565159922
Bond Position:  [16.57185877]


portfolio before change:  [20.27525014]
curr_Stock_Price:  105.62697412891362
curr_Factors:  [105.62697413]
mat_Sqrt:  [[0.15]]
grads:  [-0.22637513]
Stock Position:  -0.22637512814927913
Bond Position:  [44.18656995]


portfolio before change:  [19.98653123]
curr_Stock_Price:  106.92677495814931
curr_Factors:  [106.92677496]
mat_Sqrt:  [[0.15]]
grads:  [0.03194582]
Stock Position:  0.031945818344636785
Bond Position:  [16.5706679]


portfolio before change:  [20.00740573]
curr_Stock_Price:  107.51536634821497
curr_Factors:  [107.51536635]
mat_Sqrt:  [[0.15]]
grads:  [-0.10894968]
Stock Position:  -0.10894968220935965
Bond Position:  [31.72117072]


portfolio before change:  [20.08731744]
curr_Stock_Price:  106.81828932395341
curr_Factors:  [106.81828932]
mat_Sqrt:  [[0.15]]
grads:  [0.1090506]
Stock Position:  0.10905060211351521
Bond Position:  [8.43871867]


portfolio before change:  [19.98877052]
curr_Stock_Price:  105.90493512628618
curr_Factors:  [105.90493513]
mat_Sqrt:  [[0.15]]
grads:  [-0.02898861]
Stock Position:  -0.028988606920200846
Bond Position:  [23.05880706]


portfolio before change:  [20.01438839]
curr_Stock_Price:  105.12064988427075
curr_Factors:  [105.12064988]
mat_Sqrt:  [[0.15]]
grads:  [-0.01457284]
Stock Position:  -0.014572838284354041
Bond Position:  [21.54629462]


portfolio before change:  [20.02698257]
curr_Stock_Price:  104.44125401408925
curr_Factors:  [104.44125401]
mat_Sqrt:  [[0.15]]
grads:  [-0.26401538]
Stock Position:  -0.26401537992517893
Bond Position:  [47.60107993]


portfolio before change:  [19.7699134]
curr_Stock_Price:  105.43748264308334
curr_Factors:  [105.43748264]
mat_Sqrt:  [[0.15]]
grads:  [0.03218781]
Stock Position:  0.032187810854574006
Bond Position:  [16.37611165]


portfolio before change:  [19.79562625]
curr_Stock_Price:  106.17272088277572
curr_Factors:  [106.17272088]
mat_Sqrt:  [[0.15]]
grads:  [0.0807809]
Stock Position:  0.08078090151772423
Bond Position:  [11.21889814]


portfolio before change:  [19.74661653]
curr_Stock_Price:  105.54866045149703
curr_Factors:  [105.54866045]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755716]
Stock Position:  -0.03755716480200441
Bond Position:  [23.71072497]


portfolio before change:  [19.77874092]
curr_Stock_Price:  104.7722343532864
curr_Factors:  [104.77223435]
mat_Sqrt:  [[0.15]]
grads:  [0.03431958]
Stock Position:  0.03431957730783283
Bond Position:  [16.18300213]


portfolio before change:  [19.77687413]
curr_Stock_Price:  104.65889383169844
curr_Factors:  [104.65889383]
mat_Sqrt:  [[0.15]]
grads:  [-0.05047895]
Stock Position:  -0.05047894838584079
Bond Position:  [25.05994503]


portfolio before change:  [19.7512027]
curr_Stock_Price:  105.22951019216357
curr_Factors:  [105.22951019]
mat_Sqrt:  [[0.15]]
grads:  [0.02404131]
Stock Position:  0.024041306848888538
Bond Position:  [17.22134776]


portfolio before change:  [19.75616644]
curr_Stock_Price:  105.34643122232971
curr_Factors:  [105.34643122]
mat_Sqrt:  [[0.15]]
grads:  [0.28574807]
Stock Position:  0.2857480731788237
Bond Position:  [-10.3463733]


portfolio before change:  [19.13720438]
curr_Stock_Price:  103.18484645732961
curr_Factors:  [103.18484646]
mat_Sqrt:  [[0.15]]
grads:  [0.16154223]
Stock Position:  0.16154222807218327
Bond Position:  [2.46849438]


portfolio before change:  [19.05956266]
curr_Stock_Price:  102.70230823222235
curr_Factors:  [102.70230823]
mat_Sqrt:  [[0.15]]
grads:  [-0.04510885]
Stock Position:  -0.04510884594631106
Bond Position:  [23.69234526]


portfolio before change:  [19.07900764]
curr_Stock_Price:  102.33689763619235
curr_Factors:  [102.33689764]
mat_Sqrt:  [[0.15]]
grads:  [0.04244472]
Stock Position:  0.04244472086167127
Bond Position:  [14.73534658]


portfolio before change:  [19.0486826]
curr_Stock_Price:  101.57903954075715
curr_Factors:  [101.57903954]
mat_Sqrt:  [[0.15]]
grads:  [-0.08362956]
Stock Position:  -0.0836295576116883
Bond Position:  [27.54369274]


portfolio before change:  [18.99515599]
curr_Stock_Price:  102.26025538184204
curr_Factors:  [102.26025538]
mat_Sqrt:  [[0.15]]
grads:  [-0.03661892]
Stock Position:  -0.036618915826171515
Bond Position:  [22.73981568]


portfolio before change:  [18.99976589]
curr_Stock_Price:  102.21199496789117
curr_Factors:  [102.21199497]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660057]
Stock Position:  -0.036600572078587
Bond Position:  [22.74078338]


portfolio before change:  [19.01959031]
curr_Stock_Price:  101.74802281496927
curr_Factors:  [101.74802281]
mat_Sqrt:  [[0.15]]
grads:  [-0.03524874]
Stock Position:  -0.03524873513136312
Bond Position:  [22.60607942]


portfolio before change:  [19.05161867]
curr_Stock_Price:  100.91955561924044
curr_Factors:  [100.91955562]
mat_Sqrt:  [[0.15]]
grads:  [0.15203062]
Stock Position:  0.1520306240699814
Bond Position:  [3.70875565]


portfolio before change:  [18.99723789]
curr_Stock_Price:  100.55880984575363
curr_Factors:  [100.55880985]
mat_Sqrt:  [[0.15]]
grads:  [0.0453652]
Stock Position:  0.04536519656952231
Bond Position:  [14.43536771]


portfolio before change:  [19.02136971]
curr_Stock_Price:  101.05097750149048
curr_Factors:  [101.0509775]
mat_Sqrt:  [[0.15]]
grads:  [0.1547054]
Stock Position:  0.15470540470245606
Bond Position:  [3.38823734]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.02136971]
Stock Price:  100.87600789961435
PL:  [18.14536181]
Settle:  Tensor("sub_268:0", shape=(), dtype=float64)
PL:  Tensor("sub_269:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  135
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51693889e-03]
 [-2.53911807e-03]
 [-8.44629125e-03]
 [-9.93208111e-03]
 [ 5.75775939e-03]
 [ 1.55290542e-02]
 [ 1.60483269e-02]
 [-2.81070318e-03]
 [ 1.70450050e-02]
 [-2.95076586e-04]
 [-1.31195556e-02]
 [-4.44670707e-04]
 [ 1.65133768e-03]
 [ 8.78133456e-03]
 [ 7.45152512e-03]
 [-1.01901185e-02]
 [-1.85195575e-03]
 [-9.12281529e-04]
 [-7.54321217e-03]
 [-2.32182328e-03]
 [ 3.33201412e-04]
 [ 9.00269608e-03]
 [ 4.76702918e-03]
 [ 5.89354025e-03]
 [-1.74171032e-03]
 [-4.93676709e-03]
 [-7.49565613e-03]
 [-2.40765234e-02]
 [-3.71011933e-02]
 [ 2.18469071e-02]
 [ 9.08861591e-03]
 [ 2.95565283e-03]
 [-1.25280467e-02]
 [-6.76032523e-03]
 [-8.75696155e-03]
 [-7.47841853e-03]
 [ 2.27458971e-02]
 [ 7.18487659e-03]
 [ 2.41088323e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.82002047]
curr_Stock_Price:  100.05669614198607
curr_Factors:  [100.05669614]
mat_Sqrt:  [[0.15]]
grads:  [-0.01011293]
Stock Position:  -0.010112925955966648
Bond Position:  [3.83188643]


portfolio before change:  [2.82300214]
curr_Stock_Price:  99.8092253296372
curr_Factors:  [99.80922533]
mat_Sqrt:  [[0.15]]
grads:  [-0.01692745]
Stock Position:  -0.01692745379505792
Bond Position:  [4.51251819]


portfolio before change:  [2.8331539]
curr_Stock_Price:  99.24282800401825
curr_Factors:  [99.242828]
mat_Sqrt:  [[0.15]]
grads:  [-0.05630861]
Stock Position:  -0.05630860836218921
Bond Position:  [8.42137944]


portfolio before change:  [2.83089663]
curr_Stock_Price:  99.30161135138967
curr_Factors:  [99.30161135]
mat_Sqrt:  [[0.15]]
grads:  [-0.06621387]
Stock Position:  -0.0662138740429218
Bond Position:  [9.40604102]


portfolio before change:  [2.79707333]
curr_Stock_Price:  99.83018836440723
curr_Factors:  [99.83018836]
mat_Sqrt:  [[0.15]]
grads:  [0.03838506]
Stock Position:  0.03838506262613103
Bond Position:  [-1.0349147]


portfolio before change:  [2.8091336]
curr_Stock_Price:  100.14775055569135
curr_Factors:  [100.14775056]
mat_Sqrt:  [[0.15]]
grads:  [0.10352703]
Stock Position:  0.1035270282213023
Bond Position:  [-7.5588654]


portfolio before change:  [2.94391918]
curr_Stock_Price:  101.45881392027482
curr_Factors:  [101.45881392]
mat_Sqrt:  [[0.15]]
grads:  [0.10698885]
Stock Position:  0.10698884619097133
Bond Position:  [-7.91104226]


portfolio before change:  [2.83500366]
curr_Stock_Price:  100.45004920477243
curr_Factors:  [100.4500492]
mat_Sqrt:  [[0.15]]
grads:  [-0.01873802]
Stock Position:  -0.01873802117476978
Bond Position:  [4.71723881]


portfolio before change:  [2.86358604]
curr_Stock_Price:  98.95615129197097
curr_Factors:  [98.95615129]
mat_Sqrt:  [[0.15]]
grads:  [0.11363337]
Stock Position:  0.11363336654525713
Bond Position:  [-8.38113457]


portfolio before change:  [2.78107858]
curr_Stock_Price:  98.23928654934373
curr_Factors:  [98.23928655]
mat_Sqrt:  [[0.15]]
grads:  [-0.00196718]
Stock Position:  -0.00196717724164744
Bond Position:  [2.97433267]


portfolio before change:  [2.78243909]
curr_Stock_Price:  97.73669433885172
curr_Factors:  [97.73669434]
mat_Sqrt:  [[0.15]]
grads:  [-0.0874637]
Stock Position:  -0.08746370379761652
Bond Position:  [11.33085237]


portfolio before change:  [2.74281919]
curr_Stock_Price:  98.20587573683207
curr_Factors:  [98.20587574]
mat_Sqrt:  [[0.15]]
grads:  [-0.00296447]
Stock Position:  -0.0029644713802811327
Bond Position:  [3.0339477]


portfolio before change:  [2.74177023]
curr_Stock_Price:  98.68765515587965
curr_Factors:  [98.68765516]
mat_Sqrt:  [[0.15]]
grads:  [0.01100892]
Stock Position:  0.01100891786121428
Bond Position:  [1.65532594]


portfolio before change:  [2.73097396]
curr_Stock_Price:  97.68817413706645
curr_Factors:  [97.68817414]
mat_Sqrt:  [[0.15]]
grads:  [0.05854223]
Stock Position:  0.05854223038108527
Bond Position:  [-2.98790964]


portfolio before change:  [2.69092634]
curr_Stock_Price:  97.01047358995156
curr_Factors:  [97.01047359]
mat_Sqrt:  [[0.15]]
grads:  [0.04967683]
Stock Position:  0.0496768341099355
Bond Position:  [-2.12824686]


portfolio before change:  [2.76227279]
curr_Stock_Price:  98.45204067917415
curr_Factors:  [98.45204068]
mat_Sqrt:  [[0.15]]
grads:  [-0.06793412]
Stock Position:  -0.06793412316196996
Bond Position:  [9.45052584]


portfolio before change:  [2.72195952]
curr_Stock_Price:  99.06284788439362
curr_Factors:  [99.06284788]
mat_Sqrt:  [[0.15]]
grads:  [-0.01234637]
Stock Position:  -0.012346371672361228
Bond Position:  [3.94502626]


portfolio before change:  [2.73973391]
curr_Stock_Price:  97.66314672308249
curr_Factors:  [97.66314672]
mat_Sqrt:  [[0.15]]
grads:  [-0.00608188]
Stock Position:  -0.006081876860182769
Bond Position:  [3.33370915]


portfolio before change:  [2.73888951]
curr_Stock_Price:  97.87050700880637
curr_Factors:  [97.87050701]
mat_Sqrt:  [[0.15]]
grads:  [-0.05028808]
Stock Position:  -0.05028808112026104
Bond Position:  [7.66060951]


portfolio before change:  [2.66754002]
curr_Stock_Price:  99.30836515108379
curr_Factors:  [99.30836515]
mat_Sqrt:  [[0.15]]
grads:  [-0.01547882]
Stock Position:  -0.015478821886202082
Bond Position:  [4.20471652]


portfolio before change:  [2.66488431]
curr_Stock_Price:  99.51389335593171
curr_Factors:  [99.51389336]
mat_Sqrt:  [[0.15]]
grads:  [0.00222134]
Stock Position:  0.0022213427495075336
Bond Position:  [2.44382984]


portfolio before change:  [2.66460189]
curr_Stock_Price:  99.24922354857588
curr_Factors:  [99.24922355]
mat_Sqrt:  [[0.15]]
grads:  [0.06001797]
Stock Position:  0.06001797389353916
Bond Position:  [-3.29213542]


portfolio before change:  [2.62262868]
curr_Stock_Price:  98.55673660818191
curr_Factors:  [98.55673661]
mat_Sqrt:  [[0.15]]
grads:  [0.03178019]
Stock Position:  0.03178019455224608
Bond Position:  [-0.50952358]


portfolio before change:  [2.63092307]
curr_Stock_Price:  98.81973317683745
curr_Factors:  [98.81973318]
mat_Sqrt:  [[0.15]]
grads:  [0.03929027]
Stock Position:  0.03929026830985716
Bond Position:  [-1.25173076]


portfolio before change:  [2.58239663]
curr_Stock_Price:  97.58864062353904
curr_Factors:  [97.58864062]
mat_Sqrt:  [[0.15]]
grads:  [-0.0116114]
Stock Position:  -0.011611402133615204
Bond Position:  [3.71553758]


portfolio before change:  [2.58318565]
curr_Stock_Price:  97.56068981787041
curr_Factors:  [97.56068982]
mat_Sqrt:  [[0.15]]
grads:  [-0.03291178]
Stock Position:  -0.03291178060834576
Bond Position:  [5.79408167]


portfolio before change:  [2.58859125]
curr_Stock_Price:  97.41845226300735
curr_Factors:  [97.41845226]
mat_Sqrt:  [[0.15]]
grads:  [-0.04997104]
Stock Position:  -0.04997104087013828
Bond Position:  [7.45669271]


portfolio before change:  [2.52106238]
curr_Stock_Price:  98.78846614516662
curr_Factors:  [98.78846615]
mat_Sqrt:  [[0.15]]
grads:  [-0.16051016]
Stock Position:  -0.16051015600033355
Bond Position:  [18.37761449]


portfolio before change:  [2.4831586]
curr_Stock_Price:  99.03892459310805
curr_Factors:  [99.03892459]
mat_Sqrt:  [[0.15]]
grads:  [-0.24734129]
Stock Position:  -0.2473412884431566
Bond Position:  [26.97957381]


portfolio before change:  [2.55187849]
curr_Stock_Price:  98.77472592581461
curr_Factors:  [98.77472593]
mat_Sqrt:  [[0.15]]
grads:  [0.14564605]
Stock Position:  0.14564604714759832
Bond Position:  [-11.8342699]


portfolio before change:  [2.73073104]
curr_Stock_Price:  100.01287777793165
curr_Factors:  [100.01287778]
mat_Sqrt:  [[0.15]]
grads:  [0.06059077]
Stock Position:  0.060590772765828964
Bond Position:  [-3.32912651]


portfolio before change:  [2.7554957]
curr_Stock_Price:  100.42846620433653
curr_Factors:  [100.4284662]
mat_Sqrt:  [[0.15]]
grads:  [0.01970435]
Stock Position:  0.019704352208393235
Bond Position:  [0.77661783]


portfolio before change:  [2.73815504]
curr_Stock_Price:  99.54349749530478
curr_Factors:  [99.5434975]
mat_Sqrt:  [[0.15]]
grads:  [-0.08352031]
Stock Position:  -0.08352031145260495
Bond Position:  [11.05205896]


portfolio before change:  [2.75192595]
curr_Stock_Price:  99.3951586278626
curr_Factors:  [99.39515863]
mat_Sqrt:  [[0.15]]
grads:  [-0.04506883]
Stock Position:  -0.045068834876765655
Bond Position:  [7.23154994]


portfolio before change:  [2.75045017]
curr_Stock_Price:  99.44796186682335
curr_Factors:  [99.44796187]
mat_Sqrt:  [[0.15]]
grads:  [-0.05837974]
Stock Position:  -0.05837974367219502
Bond Position:  [8.55619669]


portfolio before change:  [2.72939267]
curr_Stock_Price:  99.8269817568885
curr_Factors:  [99.82698176]
mat_Sqrt:  [[0.15]]
grads:  [-0.04985612]
Stock Position:  -0.04985612352987677
Bond Position:  [7.70637901]


portfolio before change:  [2.70350068]
curr_Stock_Price:  100.36563884925194
curr_Factors:  [100.36563885]
mat_Sqrt:  [[0.15]]
grads:  [0.15163931]
Stock Position:  0.1516393140810153
Bond Position:  [-12.51587596]


portfolio before change:  [2.6684785]
curr_Stock_Price:  100.14499951654771
curr_Factors:  [100.14499952]
mat_Sqrt:  [[0.15]]
grads:  [0.04789918]
Stock Position:  0.047899177253739024
Bond Position:  [-2.12838459]


portfolio before change:  [2.66085835]
curr_Stock_Price:  99.99146690137367
curr_Factors:  [99.9914669]
mat_Sqrt:  [[0.15]]
grads:  [0.16072555]
Stock Position:  0.16072554848788356
Bond Position:  [-13.41032501]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.66085835]
Stock Price:  100.49179910506592
PL:  [2.16905924]
Settle:  Tensor("sub_270:0", shape=(), dtype=float64)
PL:  Tensor("sub_271:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  136
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.40059340e-03]
 [-3.93777051e-03]
 [ 1.23971124e-02]
 [-4.34606678e-03]
 [ 1.39944048e-02]
 [ 2.42312337e-02]
 [ 2.77178924e-03]
 [-8.29627986e-03]
 [ 9.50460116e-03]
 [-1.32686440e-04]
 [-7.76916670e-03]
 [-5.51420875e-03]
 [ 7.11045017e-03]
 [ 1.08500474e-02]
 [-1.87652621e-03]
 [-9.31880640e-03]
 [-4.98109729e-03]
 [-1.38360197e-03]
 [-7.46595091e-03]
 [-2.41176095e-03]
 [ 3.52672029e-04]
 [ 9.79021811e-03]
 [ 4.76707987e-03]
 [ 6.01511373e-03]
 [-2.50097507e-03]
 [-7.47214909e-03]
 [ 1.37288878e-02]
 [-1.95249086e-02]
 [-1.08878716e-02]
 [ 2.43431773e-02]
 [-9.27419852e-03]
 [ 6.43723489e-03]
 [-1.28456073e-02]
 [-2.34966670e-03]
 [-5.67221180e-03]
 [-3.52919926e-03]
 [ 2.33785409e-02]
 [ 1.50835250e-03]
 [ 2.07139285e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.16067932]
curr_Stock_Price:  100.91612900793632
curr_Factors:  [100.91612901]
mat_Sqrt:  [[0.15]]
grads:  [-0.01600396]
Stock Position:  -0.01600395599458937
Bond Position:  [17.7757366]


portfolio before change:  [16.15662195]
curr_Stock_Price:  101.30849874540448
curr_Factors:  [101.30849875]
mat_Sqrt:  [[0.15]]
grads:  [-0.0262518]
Stock Position:  -0.02625180342645649
Bond Position:  [18.81615275]


portfolio before change:  [16.19991318]
curr_Stock_Price:  99.74902262528359
curr_Factors:  [99.74902263]
mat_Sqrt:  [[0.15]]
grads:  [0.08264742]
Stock Position:  0.08264741568186985
Bond Position:  [7.95591424]


portfolio before change:  [16.22668931]
curr_Stock_Price:  100.0609691656149
curr_Factors:  [100.06096917]
mat_Sqrt:  [[0.15]]
grads:  [-0.02897378]
Stock Position:  -0.028973778534375664
Bond Position:  [19.12583367]


portfolio before change:  [16.26181465]
curr_Stock_Price:  98.93117292893095
curr_Factors:  [98.93117293]
mat_Sqrt:  [[0.15]]
grads:  [0.09329603]
Stock Position:  0.09329603210426594
Bond Position:  [7.03192877]


portfolio before change:  [16.13157795]
curr_Stock_Price:  97.52579970968812
curr_Factors:  [97.52579971]
mat_Sqrt:  [[0.15]]
grads:  [0.16154156]
Stock Position:  0.16154155809081358
Bond Position:  [0.37710831]


portfolio before change:  [16.07465808]
curr_Stock_Price:  97.17315353615469
curr_Factors:  [97.17315354]
mat_Sqrt:  [[0.15]]
grads:  [0.01847859]
Stock Position:  0.018478594953825977
Bond Position:  [14.27903474]


portfolio before change:  [16.07763799]
curr_Stock_Price:  97.23781856411864
curr_Factors:  [97.23781856]
mat_Sqrt:  [[0.15]]
grads:  [-0.05530853]
Stock Position:  -0.05530853238111352
Bond Position:  [21.45571903]


portfolio before change:  [16.0501442]
curr_Stock_Price:  97.78341108082176
curr_Factors:  [97.78341108]
mat_Sqrt:  [[0.15]]
grads:  [0.06336401]
Stock Position:  0.06336400772880546
Bond Position:  [9.85419539]


portfolio before change:  [16.06274464]
curr_Stock_Price:  97.96282808922433
curr_Factors:  [97.96282809]
mat_Sqrt:  [[0.15]]
grads:  [-0.00088458]
Stock Position:  -0.0008845762660203196
Bond Position:  [16.14940023]


portfolio before change:  [16.06484064]
curr_Stock_Price:  97.87554690634943
curr_Factors:  [97.87554691]
mat_Sqrt:  [[0.15]]
grads:  [-0.05179444]
Stock Position:  -0.051794444653069094
Bond Position:  [21.13425024]


portfolio before change:  [16.0877868]
curr_Stock_Price:  97.48353168254008
curr_Factors:  [97.48353168]
mat_Sqrt:  [[0.15]]
grads:  [-0.03676139]
Stock Position:  -0.03676139168834823
Bond Position:  [19.67141709]


portfolio before change:  [16.07460361]
curr_Stock_Price:  97.90903983272962
curr_Factors:  [97.90903983]
mat_Sqrt:  [[0.15]]
grads:  [0.047403]
Stock Position:  0.047403001129650735
Bond Position:  [11.43342128]


portfolio before change:  [16.09554668]
curr_Stock_Price:  98.32069738372357
curr_Factors:  [98.32069738]
mat_Sqrt:  [[0.15]]
grads:  [0.07233365]
Stock Position:  0.07233364961409097
Bond Position:  [8.98365181]


portfolio before change:  [16.11332637]
curr_Stock_Price:  98.55097286076202
curr_Factors:  [98.55097286]
mat_Sqrt:  [[0.15]]
grads:  [-0.01251017]
Stock Position:  -0.012510174764154818
Bond Position:  [17.34621627]


portfolio before change:  [16.11247193]
curr_Stock_Price:  98.79260463783297
curr_Factors:  [98.79260464]
mat_Sqrt:  [[0.15]]
grads:  [-0.06212538]
Stock Position:  -0.06212537596783083
Bond Position:  [22.24999963]


portfolio before change:  [16.17009242]
curr_Stock_Price:  97.90988859819797
curr_Factors:  [97.9098886]
mat_Sqrt:  [[0.15]]
grads:  [-0.03320732]
Stock Position:  -0.0332073152540907
Bond Position:  [19.42141696]


portfolio before change:  [16.17164779]
curr_Stock_Price:  97.93616174783826
curr_Factors:  [97.93616175]
mat_Sqrt:  [[0.15]]
grads:  [-0.00922401]
Stock Position:  -0.009224013153405052
Bond Position:  [17.07501223]


portfolio before change:  [16.16779692]
curr_Stock_Price:  98.58505263272059
curr_Factors:  [98.58505263]
mat_Sqrt:  [[0.15]]
grads:  [-0.04977301]
Stock Position:  -0.049773006037329925
Bond Position:  [21.07467134]


portfolio before change:  [16.17038092]
curr_Stock_Price:  98.58606709088068
curr_Factors:  [98.58606709]
mat_Sqrt:  [[0.15]]
grads:  [-0.01607841]
Stock Position:  -0.016078406333725936
Bond Position:  [17.75548777]


portfolio before change:  [16.15474061]
curr_Stock_Price:  99.69686651122461
curr_Factors:  [99.69686651]
mat_Sqrt:  [[0.15]]
grads:  [0.00235115]
Stock Position:  0.0023511468607900674
Bond Position:  [15.92033864]


portfolio before change:  [16.15817856]
curr_Stock_Price:  100.31264301744075
curr_Factors:  [100.31264302]
mat_Sqrt:  [[0.15]]
grads:  [0.06526812]
Stock Position:  0.06526812071694947
Bond Position:  [9.61096087]


portfolio before change:  [16.11093536]
curr_Stock_Price:  99.57040239594453
curr_Factors:  [99.5704024]
mat_Sqrt:  [[0.15]]
grads:  [0.03178053]
Stock Position:  0.03178053244704514
Bond Position:  [12.94653495]


portfolio before change:  [16.10225501]
curr_Stock_Price:  99.24634354995216
curr_Factors:  [99.24634355]
mat_Sqrt:  [[0.15]]
grads:  [0.04010076]
Stock Position:  0.040100758202110044
Bond Position:  [12.12240139]


portfolio before change:  [16.05097682]
curr_Stock_Price:  97.92982016150108
curr_Factors:  [97.92982016]
mat_Sqrt:  [[0.15]]
grads:  [-0.01667317]
Stock Position:  -0.016673167157052745
Bond Position:  [17.68377708]


portfolio before change:  [16.03171178]
curr_Stock_Price:  99.21785693380507
curr_Factors:  [99.21785693]
mat_Sqrt:  [[0.15]]
grads:  [-0.04981433]
Stock Position:  -0.049814327279295884
Bond Position:  [20.97418258]


portfolio before change:  [15.99017966]
curr_Stock_Price:  100.10422953889457
curr_Factors:  [100.10422954]
mat_Sqrt:  [[0.15]]
grads:  [0.09152592]
Stock Position:  0.09152591882961024
Bond Position:  [6.82804807]


portfolio before change:  [16.0670689]
curr_Stock_Price:  100.93498523578349
curr_Factors:  [100.93498524]
mat_Sqrt:  [[0.15]]
grads:  [-0.13016606]
Stock Position:  -0.13016605734256412
Bond Position:  [29.20537797]


portfolio before change:  [15.95768998]
curr_Stock_Price:  101.80333617009352
curr_Factors:  [101.80333617]
mat_Sqrt:  [[0.15]]
grads:  [-0.07258581]
Stock Position:  -0.07258581043237808
Bond Position:  [23.34716764]


portfolio before change:  [15.85354176]
curr_Stock_Price:  103.27837379400376
curr_Factors:  [103.27837379]
mat_Sqrt:  [[0.15]]
grads:  [0.16228785]
Stock Position:  0.1622878487683831
Bond Position:  [-0.90728335]


portfolio before change:  [15.8241803]
curr_Stock_Price:  103.09815057552308
curr_Factors:  [103.09815058]
mat_Sqrt:  [[0.15]]
grads:  [-0.06182799]
Stock Position:  -0.06182799014622233
Bond Position:  [22.19853174]


portfolio before change:  [15.84657736]
curr_Stock_Price:  102.78078514515978
curr_Factors:  [102.78078515]
mat_Sqrt:  [[0.15]]
grads:  [0.0429149]
Stock Position:  0.04291489926282468
Bond Position:  [11.43575032]


portfolio before change:  [15.85615238]
curr_Stock_Price:  102.9705902475902
curr_Factors:  [102.97059025]
mat_Sqrt:  [[0.15]]
grads:  [-0.08563738]
Stock Position:  -0.08563738202256205
Bond Position:  [24.67428416]


portfolio before change:  [15.84397117]
curr_Stock_Price:  103.1488499152084
curr_Factors:  [103.14884992]
mat_Sqrt:  [[0.15]]
grads:  [-0.01566444]
Stock Position:  -0.01566444467900859
Bond Position:  [17.45974062]


portfolio before change:  [15.84488098]
curr_Stock_Price:  103.23010377467513
curr_Factors:  [103.23010377]
mat_Sqrt:  [[0.15]]
grads:  [-0.03781475]
Stock Position:  -0.03781474532663475
Bond Position:  [19.74850106]


portfolio before change:  [15.87434107]
curr_Stock_Price:  102.516324596782
curr_Factors:  [102.5163246]
mat_Sqrt:  [[0.15]]
grads:  [-0.023528]
Stock Position:  -0.023527995059265564
Bond Position:  [18.28634465]


portfolio before change:  [15.86806029]
curr_Stock_Price:  102.88043193372908
curr_Factors:  [102.88043193]
mat_Sqrt:  [[0.15]]
grads:  [0.15585694]
Stock Position:  0.15585693907611592
Bond Position:  [-0.16656892]


portfolio before change:  [16.14616301]
curr_Stock_Price:  104.66491160681515
curr_Factors:  [104.66491161]
mat_Sqrt:  [[0.15]]
grads:  [0.01005568]
Stock Position:  0.010055683312676185
Bond Position:  [15.09368581]


portfolio before change:  [16.14214968]
curr_Stock_Price:  104.07816249619181
curr_Factors:  [104.0781625]
mat_Sqrt:  [[0.15]]
grads:  [0.13809286]
Stock Position:  0.13809285694725545
Bond Position:  [1.76969887]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [16.14214968]
Stock Price:  104.74179117187077
PL:  [11.4003585]
Settle:  Tensor("sub_272:0", shape=(), dtype=float64)
PL:  Tensor("sub_273:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  137
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.29529309e-03]
 [-5.42267398e-03]
 [-2.10756361e-02]
 [-1.47094689e-02]
 [ 1.44260474e-02]
 [ 2.25413084e-02]
 [ 2.00854844e-02]
 [-4.86650334e-03]
 [ 1.51788576e-02]
 [-1.21727930e-04]
 [-2.62200985e-02]
 [-7.02321534e-03]
 [ 9.14140628e-03]
 [ 1.06772335e-02]
 [-4.23208501e-03]
 [-1.08596792e-02]
 [-1.63521231e-03]
 [-2.95656833e-03]
 [-1.03892861e-02]
 [-2.23305128e-03]
 [ 2.26508016e-04]
 [ 6.77011009e-03]
 [ 4.76697624e-03]
 [ 5.78945267e-03]
 [-6.33638540e-04]
 [-4.04585559e-03]
 [-1.70003205e-03]
 [-2.04498193e-02]
 [-3.05140400e-02]
 [ 2.20567107e-02]
 [ 4.29871355e-03]
 [-5.13085227e-03]
 [-1.25335128e-02]
 [-8.13182894e-03]
 [-8.54095581e-03]
 [-7.52881872e-03]
 [ 2.14457303e-02]
 [ 7.99856947e-03]
 [ 2.33876468e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.30092451]
curr_Stock_Price:  99.14699562809021
curr_Factors:  [99.14699563]
mat_Sqrt:  [[0.15]]
grads:  [-0.03530195]
Stock Position:  -0.035301953902490586
Bond Position:  [-7.80084184]


portfolio before change:  [-11.28108435]
curr_Stock_Price:  98.55735893576585
curr_Factors:  [98.55735894]
mat_Sqrt:  [[0.15]]
grads:  [-0.03615116]
Stock Position:  -0.03615115987919123
Bond Position:  [-7.71812151]


portfolio before change:  [-11.28869811]
curr_Stock_Price:  98.74127935920347
curr_Factors:  [98.74127936]
mat_Sqrt:  [[0.15]]
grads:  [-0.14050424]
Stock Position:  -0.1405042405973011
Bond Position:  [2.58487036]


portfolio before change:  [-11.32399736]
curr_Stock_Price:  98.99481174788157
curr_Factors:  [98.99481175]
mat_Sqrt:  [[0.15]]
grads:  [-0.09806313]
Stock Position:  -0.09806312619649096
Bond Position:  [-1.61625664]


portfolio before change:  [-11.29422512]
curr_Stock_Price:  98.68914865764381
curr_Factors:  [98.68914866]
mat_Sqrt:  [[0.15]]
grads:  [0.09617365]
Stock Position:  0.09617364904555213
Bond Position:  [-20.78552067]


portfolio before change:  [-11.32104715]
curr_Stock_Price:  98.43727434394775
curr_Factors:  [98.43727434]
mat_Sqrt:  [[0.15]]
grads:  [0.15027539]
Stock Position:  0.15027538933451715
Bond Position:  [-26.11374688]


portfolio before change:  [-11.21696768]
curr_Stock_Price:  99.1515888365817
curr_Factors:  [99.15158884]
mat_Sqrt:  [[0.15]]
grads:  [0.13390323]
Stock Position:  0.13390322948472488
Bond Position:  [-24.49368564]


portfolio before change:  [-11.34811051]
curr_Stock_Price:  98.19507027382986
curr_Factors:  [98.19507027]
mat_Sqrt:  [[0.15]]
grads:  [-0.03244336]
Stock Position:  -0.03244335558571164
Bond Position:  [-8.16233293]


portfolio before change:  [-11.36429448]
curr_Stock_Price:  98.66245770985392
curr_Factors:  [98.66245771]
mat_Sqrt:  [[0.15]]
grads:  [0.10119238]
Stock Position:  0.10119238426016595
Bond Position:  [-21.34818381]


portfolio before change:  [-11.43964822]
curr_Stock_Price:  97.94417195169589
curr_Factors:  [97.94417195]
mat_Sqrt:  [[0.15]]
grads:  [-0.00081152]
Stock Position:  -0.0008115195301869038
Bond Position:  [-11.36016461]


portfolio before change:  [-11.4406294]
curr_Stock_Price:  97.40329361823132
curr_Factors:  [97.40329362]
mat_Sqrt:  [[0.15]]
grads:  [-0.17480066]
Stock Position:  -0.17480065688371293
Bond Position:  [5.58553031]


portfolio before change:  [-11.41619649]
curr_Stock_Price:  97.26751225196291
curr_Factors:  [97.26751225]
mat_Sqrt:  [[0.15]]
grads:  [-0.04682144]
Stock Position:  -0.04682143560584967
Bond Position:  [-6.86199193]


portfolio before change:  [-11.41257458]
curr_Stock_Price:  97.17183584770838
curr_Factors:  [97.17183585]
mat_Sqrt:  [[0.15]]
grads:  [0.06094271]
Stock Position:  0.06094270850708113
Bond Position:  [-17.33448945]


portfolio before change:  [-11.32702356]
curr_Stock_Price:  98.6111871789805
curr_Factors:  [98.61118718]
mat_Sqrt:  [[0.15]]
grads:  [0.07118156]
Stock Position:  0.07118155689184624
Bond Position:  [-18.34632139]


portfolio before change:  [-11.2606528]
curr_Stock_Price:  99.57582187505707
curr_Factors:  [99.57582188]
mat_Sqrt:  [[0.15]]
grads:  [-0.0282139]
Stock Position:  -0.028213900075184373
Bond Position:  [-8.45123051]


portfolio before change:  [-11.25526434]
curr_Stock_Price:  99.34739113310188
curr_Factors:  [99.34739113]
mat_Sqrt:  [[0.15]]
grads:  [-0.07239786]
Stock Position:  -0.07239786142475536
Bond Position:  [-4.06272569]


portfolio before change:  [-11.24147624]
curr_Stock_Price:  99.14992699282725
curr_Factors:  [99.14992699]
mat_Sqrt:  [[0.15]]
grads:  [-0.01090142]
Stock Position:  -0.010901415387433791
Bond Position:  [-10.1606017]


portfolio before change:  [-11.24946171]
curr_Stock_Price:  99.76593170585947
curr_Factors:  [99.76593171]
mat_Sqrt:  [[0.15]]
grads:  [-0.01971046]
Stock Position:  -0.019710455555264624
Bond Position:  [-9.28302975]


portfolio before change:  [-11.25068335]
curr_Stock_Price:  99.76903610643453
curr_Factors:  [99.76903611]
mat_Sqrt:  [[0.15]]
grads:  [-0.06926191]
Stock Position:  -0.06926190726042836
Bond Position:  [-4.34048963]


portfolio before change:  [-11.34043796]
curr_Stock_Price:  101.05707468130302
curr_Factors:  [101.05707468]
mat_Sqrt:  [[0.15]]
grads:  [-0.01488701]
Stock Position:  -0.014887008505402007
Bond Position:  [-9.83600043]


portfolio before change:  [-11.34105079]
curr_Stock_Price:  101.0156464649429
curr_Factors:  [101.01564646]
mat_Sqrt:  [[0.15]]
grads:  [0.00151005]
Stock Position:  0.0015100534388786178
Bond Position:  [-11.49358982]


portfolio before change:  [-11.34290613]
curr_Stock_Price:  100.73847275197168
curr_Factors:  [100.73847275]
mat_Sqrt:  [[0.15]]
grads:  [0.04513407]
Stock Position:  0.04513406727825356
Bond Position:  [-15.88964313]


portfolio before change:  [-11.43867802]
curr_Stock_Price:  98.6605399433373
curr_Factors:  [98.66053994]
mat_Sqrt:  [[0.15]]
grads:  [0.03177984]
Stock Position:  0.03177984163069572
Bond Position:  [-14.57409435]


portfolio before change:  [-11.44576056]
curr_Stock_Price:  98.49500530888652
curr_Factors:  [98.49500531]
mat_Sqrt:  [[0.15]]
grads:  [0.03859635]
Stock Position:  0.03859635116490733
Bond Position:  [-15.24730837]


portfolio before change:  [-11.51166772]
curr_Stock_Price:  96.8367882006355
curr_Factors:  [96.8367882]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422426]
Stock Position:  -0.004224256931658052
Bond Position:  [-11.10260424]


portfolio before change:  [-11.51286638]
curr_Stock_Price:  96.7919876938539
curr_Factors:  [96.79198769]
mat_Sqrt:  [[0.15]]
grads:  [-0.02697237]
Stock Position:  -0.02697237059797501
Bond Position:  [-8.90215702]


portfolio before change:  [-11.55780256]
curr_Stock_Price:  98.41673680318972
curr_Factors:  [98.4167368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01133355]
Stock Position:  -0.011333547032665729
Bond Position:  [-10.44239184]


portfolio before change:  [-11.55243692]
curr_Stock_Price:  97.82812915153877
curr_Factors:  [97.82812915]
mat_Sqrt:  [[0.15]]
grads:  [-0.13633213]
Stock Position:  -0.1363321284863032
Bond Position:  [1.78468015]


portfolio before change:  [-11.49544151]
curr_Stock_Price:  97.41170259675692
curr_Factors:  [97.4117026]
mat_Sqrt:  [[0.15]]
grads:  [-0.20342693]
Stock Position:  -0.20342693304920617
Bond Position:  [8.3207224]


portfolio before change:  [-11.60564314]
curr_Stock_Price:  97.95854163837433
curr_Factors:  [97.95854164]
mat_Sqrt:  [[0.15]]
grads:  [0.14704474]
Stock Position:  0.14704473813810912
Bond Position:  [-26.00993124]


portfolio before change:  [-11.56764269]
curr_Stock_Price:  98.23908139964738
curr_Factors:  [98.2390814]
mat_Sqrt:  [[0.15]]
grads:  [0.02865809]
Stock Position:  0.02865809032979869
Bond Position:  [-14.38298716]


portfolio before change:  [-11.59957516]
curr_Stock_Price:  97.18756371835667
curr_Factors:  [97.18756372]
mat_Sqrt:  [[0.15]]
grads:  [-0.03420568]
Stock Position:  -0.034205681802323744
Bond Position:  [-8.27520828]


portfolio before change:  [-11.6103623]
curr_Stock_Price:  97.47268209099887
curr_Factors:  [97.47268209]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355675]
Stock Position:  -0.08355675177140391
Bond Position:  [-3.4658616]


portfolio before change:  [-11.68654066]
curr_Stock_Price:  98.37919289018845
curr_Factors:  [98.37919289]
mat_Sqrt:  [[0.15]]
grads:  [-0.05421219]
Stock Position:  -0.054212192932372706
Bond Position:  [-6.35318887]


portfolio before change:  [-11.71115586]
curr_Stock_Price:  98.81859593420302
curr_Factors:  [98.81859593]
mat_Sqrt:  [[0.15]]
grads:  [-0.05693971]
Stock Position:  -0.05693970542139237
Bond Position:  [-6.08445411]


portfolio before change:  [-11.71113058]
curr_Stock_Price:  98.80479400818707
curr_Factors:  [98.80479401]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019212]
Stock Position:  -0.05019212479317126
Bond Position:  [-6.75190803]


portfolio before change:  [-11.67224374]
curr_Stock_Price:  98.01321793674258
curr_Factors:  [98.01321794]
mat_Sqrt:  [[0.15]]
grads:  [0.14297154]
Stock Position:  0.14297153552514566
Bond Position:  [-25.68534401]


portfolio before change:  [-11.45719672]
curr_Stock_Price:  99.53980075652568
curr_Factors:  [99.53980076]
mat_Sqrt:  [[0.15]]
grads:  [0.0533238]
Stock Position:  0.05332379649939721
Bond Position:  [-16.7650368]


portfolio before change:  [-11.48365247]
curr_Stock_Price:  99.08296917753174
curr_Factors:  [99.08296918]
mat_Sqrt:  [[0.15]]
grads:  [0.15591765]
Stock Position:  0.1559176456116628
Bond Position:  [-26.93243575]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-11.48365247]
Stock Price:  99.48480793117915
PL:  [-11.48365247]
Settle:  Tensor("sub_274:0", shape=(), dtype=float64)
PL:  Tensor("sub_275:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  138
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.33230542e-03]
 [-5.30130660e-03]
 [ 7.25966522e-03]
 [-2.68111864e-02]
 [ 6.15956143e-03]
 [ 2.40980160e-02]
 [ 3.29123751e-03]
 [-7.44712055e-03]
 [ 1.12391774e-02]
 [-4.44172321e-03]
 [ 1.32994226e-02]
 [ 2.24018434e-03]
 [ 6.27792941e-03]
 [ 1.04442376e-02]
 [-2.28047071e-03]
 [-9.52211994e-03]
 [-2.72781495e-03]
 [-4.06455647e-05]
 [-7.55834770e-03]
 [-2.48225848e-03]
 [ 6.11807242e-04]
 [ 1.33404735e-02]
 [ 4.75613537e-03]
 [ 5.65038513e-03]
 [ 8.73896192e-03]
 [ 1.42087644e-03]
 [ 1.90146145e-02]
 [-1.91530992e-02]
 [-2.02372466e-02]
 [ 2.15785071e-02]
 [ 2.60080656e-03]
 [-1.13321990e-02]
 [-1.22651639e-02]
 [-7.26866946e-03]
 [-6.37663272e-03]
 [-3.70107833e-03]
 [ 1.81512697e-02]
 [ 1.28776101e-02]
 [ 1.62486974e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.84716277]
curr_Stock_Price:  99.75602653410122
curr_Factors:  [99.75602653]
mat_Sqrt:  [[0.15]]
grads:  [-0.0155487]
Stock Position:  -0.01554870282253613
Bond Position:  [-0.29608596]


portfolio before change:  [-1.84917729]
curr_Stock_Price:  99.8832081787453
curr_Factors:  [99.88320818]
mat_Sqrt:  [[0.15]]
grads:  [-0.03534204]
Stock Position:  -0.0353420440173134
Bond Position:  [1.68089945]


portfolio before change:  [-1.83968061]
curr_Stock_Price:  99.62044581847046
curr_Factors:  [99.62044582]
mat_Sqrt:  [[0.15]]
grads:  [0.04839777]
Stock Position:  0.04839776814805399
Bond Position:  [-6.66108785]


portfolio before change:  [-1.90743695]
curr_Stock_Price:  98.23766197309078
curr_Factors:  [98.23766197]
mat_Sqrt:  [[0.15]]
grads:  [-0.17874124]
Stock Position:  -0.17874124285187837
Bond Position:  [15.65168485]


portfolio before change:  [-1.8070675]
curr_Stock_Price:  97.68707351785245
curr_Factors:  [97.68707352]
mat_Sqrt:  [[0.15]]
grads:  [0.04106374]
Stock Position:  0.04106374286861555
Bond Position:  [-5.81846437]


portfolio before change:  [-1.80568009]
curr_Stock_Price:  97.73857305951178
curr_Factors:  [97.73857306]
mat_Sqrt:  [[0.15]]
grads:  [0.16065344]
Stock Position:  0.1606534398216213
Bond Position:  [-17.50771806]


portfolio before change:  [-1.86990194]
curr_Stock_Price:  97.35244220555775
curr_Factors:  [97.35244221]
mat_Sqrt:  [[0.15]]
grads:  [0.02194158]
Stock Position:  0.021941583398874913
Bond Position:  [-4.00596867]


portfolio before change:  [-1.86695594]
curr_Stock_Price:  97.5095311426826
curr_Factors:  [97.50953114]
mat_Sqrt:  [[0.15]]
grads:  [-0.04964747]
Stock Position:  -0.04964747034192258
Bond Position:  [2.97414562]


portfolio before change:  [-1.89300794]
curr_Stock_Price:  98.0417595821817
curr_Factors:  [98.04175958]
mat_Sqrt:  [[0.15]]
grads:  [0.07492785]
Stock Position:  0.07492784961752964
Bond Position:  [-9.23906616]


portfolio before change:  [-1.78260507]
curr_Stock_Price:  99.53062955341301
curr_Factors:  [99.53062955]
mat_Sqrt:  [[0.15]]
grads:  [-0.02961149]
Stock Position:  -0.029611488099109424
Bond Position:  [1.16464498]


portfolio before change:  [-1.75647462]
curr_Stock_Price:  98.65310293752623
curr_Factors:  [98.65310294]
mat_Sqrt:  [[0.15]]
grads:  [0.08866282]
Stock Position:  0.08866281716303585
Bond Position:  [-10.50333664]


portfolio before change:  [-1.76352142]
curr_Stock_Price:  98.58843309445254
curr_Factors:  [98.58843309]
mat_Sqrt:  [[0.15]]
grads:  [0.01493456]
Stock Position:  0.014934562261569995
Bond Position:  [-3.23589652]


portfolio before change:  [-1.76955928]
curr_Stock_Price:  98.2112313078422
curr_Factors:  [98.21123131]
mat_Sqrt:  [[0.15]]
grads:  [0.04185286]
Stock Position:  0.04185286273090067
Bond Position:  [-5.87998046]


portfolio before change:  [-1.74109648]
curr_Stock_Price:  98.90886204603781
curr_Factors:  [98.90886205]
mat_Sqrt:  [[0.15]]
grads:  [0.06962825]
Stock Position:  0.06962825089757352
Bond Position:  [-8.62794754]


portfolio before change:  [-1.76285561]
curr_Stock_Price:  98.61184803193062
curr_Factors:  [98.61184803]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520314]
Stock Position:  -0.015203138080533673
Bond Position:  [-0.26364607]


portfolio before change:  [-1.76920478]
curr_Stock_Price:  99.027302857361
curr_Factors:  [99.02730286]
mat_Sqrt:  [[0.15]]
grads:  [-0.0634808]
Stock Position:  -0.06348079960810274
Bond Position:  [4.51712759]


portfolio before change:  [-1.75135682]
curr_Stock_Price:  98.75504273066689
curr_Factors:  [98.75504273]
mat_Sqrt:  [[0.15]]
grads:  [-0.01818543]
Stock Position:  -0.018185432997509812
Bond Position:  [0.0445464]


portfolio before change:  [-1.7187752]
curr_Stock_Price:  96.96371602015284
curr_Factors:  [96.96371602]
mat_Sqrt:  [[0.15]]
grads:  [-0.00027097]
Stock Position:  -0.0002709704310447783
Bond Position:  [-1.6925009]


portfolio before change:  [-1.71918817]
curr_Stock_Price:  97.70698366374188
curr_Factors:  [97.70698366]
mat_Sqrt:  [[0.15]]
grads:  [-0.05038898]
Stock Position:  -0.05038898469642352
Bond Position:  [3.20416753]


portfolio before change:  [-1.69452897]
curr_Stock_Price:  97.22555578474311
curr_Factors:  [97.22555578]
mat_Sqrt:  [[0.15]]
grads:  [-0.01654839]
Stock Position:  -0.016548389852639556
Bond Position:  [-0.08560257]


portfolio before change:  [-1.68755695]
curr_Stock_Price:  96.80359822035871
curr_Factors:  [96.80359822]
mat_Sqrt:  [[0.15]]
grads:  [0.00407871]
Stock Position:  0.004078714949122733
Bond Position:  [-2.08239123]


portfolio before change:  [-1.68894459]
curr_Stock_Price:  96.52720650189664
curr_Factors:  [96.5272065]
mat_Sqrt:  [[0.15]]
grads:  [0.08893649]
Stock Position:  0.08893648990254344
Bond Position:  [-10.27373551]


portfolio before change:  [-1.77907952]
curr_Stock_Price:  95.52817181640079
curr_Factors:  [95.52817182]
mat_Sqrt:  [[0.15]]
grads:  [0.03170757]
Stock Position:  0.03170756910356468
Bond Position:  [-4.80804563]


portfolio before change:  [-1.85553255]
curr_Stock_Price:  93.13593596536164
curr_Factors:  [93.13593597]
mat_Sqrt:  [[0.15]]
grads:  [0.03766923]
Stock Position:  0.037669234205768336
Bond Position:  [-5.36389193]


portfolio before change:  [-1.88094841]
curr_Stock_Price:  92.47902510912436
curr_Factors:  [92.47902511]
mat_Sqrt:  [[0.15]]
grads:  [0.05825975]
Stock Position:  0.05825974612007806
Bond Position:  [-7.26875293]


portfolio before change:  [-1.8858854]
curr_Stock_Price:  92.40988051015185
curr_Factors:  [92.40988051]
mat_Sqrt:  [[0.15]]
grads:  [0.00947251]
Stock Position:  0.00947250957210694
Bond Position:  [-2.76123888]


portfolio before change:  [-1.8857505]
curr_Stock_Price:  92.46056252917997
curr_Factors:  [92.46056253]
mat_Sqrt:  [[0.15]]
grads:  [0.1267641]
Stock Position:  0.1267640966396648
Bond Position:  [-13.60643018]


portfolio before change:  [-1.6278512]
curr_Stock_Price:  94.50846263316905
curr_Factors:  [94.50846263]
mat_Sqrt:  [[0.15]]
grads:  [-0.12768733]
Stock Position:  -0.12768732812489478
Bond Position:  [10.43968188]


portfolio before change:  [-1.52656067]
curr_Stock_Price:  93.72541320609321
curr_Factors:  [93.72541321]
mat_Sqrt:  [[0.15]]
grads:  [-0.13491498]
Stock Position:  -0.13491497706693
Bond Position:  [11.11840131]


portfolio before change:  [-1.65235839]
curr_Stock_Price:  94.66813740346244
curr_Factors:  [94.6681374]
mat_Sqrt:  [[0.15]]
grads:  [0.14385671]
Stock Position:  0.14385671429196553
Bond Position:  [-15.27100559]


portfolio before change:  [-1.74430944]
curr_Stock_Price:  94.0422225933852
curr_Factors:  [94.04222259]
mat_Sqrt:  [[0.15]]
grads:  [0.01733871]
Stock Position:  0.017338710406585092
Bond Position:  [-3.3748803]


portfolio before change:  [-1.74904669]
curr_Stock_Price:  93.79333621316421
curr_Factors:  [93.79333621]
mat_Sqrt:  [[0.15]]
grads:  [-0.07554799]
Stock Position:  -0.0755479935383475
Bond Position:  [5.33685167]


portfolio before change:  [-1.74429083]
curr_Stock_Price:  93.73921546525432
curr_Factors:  [93.73921547]
mat_Sqrt:  [[0.15]]
grads:  [-0.08176776]
Stock Position:  -0.08176775946888427
Bond Position:  [5.92055479]


portfolio before change:  [-1.82964546]
curr_Stock_Price:  94.7921334413272
curr_Factors:  [94.79213344]
mat_Sqrt:  [[0.15]]
grads:  [-0.0484578]
Stock Position:  -0.04845779642169027
Bond Position:  [2.76377245]


portfolio before change:  [-1.81272769]
curr_Stock_Price:  94.45013939753294
curr_Factors:  [94.4501394]
mat_Sqrt:  [[0.15]]
grads:  [-0.04251088]
Stock Position:  -0.04251088479376615
Bond Position:  [2.20243131]


portfolio before change:  [-1.82381173]
curr_Stock_Price:  94.71735016254583
curr_Factors:  [94.71735016]
mat_Sqrt:  [[0.15]]
grads:  [-0.02467386]
Stock Position:  -0.024673855503481237
Bond Position:  [0.51323048]


portfolio before change:  [-1.79351147]
curr_Stock_Price:  93.49191914790666
curr_Factors:  [93.49191915]
mat_Sqrt:  [[0.15]]
grads:  [0.12100846]
Stock Position:  0.12100846439664653
Bond Position:  [-13.10682504]


portfolio before change:  [-1.85194623]
curr_Stock_Price:  93.02256101811156
curr_Factors:  [93.02256102]
mat_Sqrt:  [[0.15]]
grads:  [0.08585073]
Stock Position:  0.08585073376023492
Bond Position:  [-9.83800135]


portfolio before change:  [-1.88003363]
curr_Stock_Price:  92.709720662087
curr_Factors:  [92.70972066]
mat_Sqrt:  [[0.15]]
grads:  [0.10832465]
Stock Position:  0.10832464965417363
Bond Position:  [-11.92278164]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.88003363]
Stock Price:  92.55075017007658
PL:  [-1.88003363]
Settle:  Tensor("sub_276:0", shape=(), dtype=float64)
PL:  Tensor("sub_277:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  139
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.07348546e-03]
 [ 4.60104611e-04]
 [ 1.68771121e-04]
 [ 7.53134211e-02]
 [-7.88296994e-02]
 [ 5.21391956e-02]
 [-5.06293085e-03]
 [ 2.34463047e-03]
 [ 1.33998784e-02]
 [ 1.35249566e-02]
 [ 9.01317917e-03]
 [-1.88828077e-02]
 [-1.19576687e-02]
 [ 2.50358098e-03]
 [-1.82125669e-03]
 [-2.60821724e-02]
 [ 4.42147845e-03]
 [-4.82968925e-04]
 [-1.15977465e-02]
 [-2.21460476e-03]
 [ 2.84387029e-04]
 [-1.22715857e-02]
 [ 4.78237049e-03]
 [ 7.19869411e-03]
 [-3.69111318e-03]
 [-5.10935571e-03]
 [ 4.64218389e-04]
 [-1.11665876e-02]
 [ 1.32223765e-02]
 [ 2.29383354e-02]
 [-9.27026135e-03]
 [ 6.35277205e-03]
 [-1.29638398e-02]
 [ 2.59720542e-04]
 [-5.90934683e-03]
 [ 7.16889969e-04]
 [ 2.41531962e-02]
 [ 4.45720416e-03]
 [ 1.87273073e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.62530314]
curr_Stock_Price:  100.81721689571319
curr_Factors:  [100.8172169]
mat_Sqrt:  [[0.15]]
grads:  [-0.01382324]
Stock Position:  -0.013823236388780767
Bond Position:  [16.01892336]


portfolio before change:  [14.61162581]
curr_Stock_Price:  101.95152578276097
curr_Factors:  [101.95152578]
mat_Sqrt:  [[0.15]]
grads:  [0.00306736]
Stock Position:  0.0030673640704950277
Bond Position:  [14.29890337]


portfolio before change:  [14.61485826]
curr_Stock_Price:  102.4226054877911
curr_Factors:  [102.42260549]
mat_Sqrt:  [[0.15]]
grads:  [0.00112514]
Stock Position:  0.001125140807205673
Bond Position:  [14.49961841]


portfolio before change:  [14.61712398]
curr_Stock_Price:  102.82535840281814
curr_Factors:  [102.8253584]
mat_Sqrt:  [[0.15]]
grads:  [0.50208947]
Stock Position:  0.5020894743046416
Bond Position:  [-37.01040617]


portfolio before change:  [15.6637963]
curr_Stock_Price:  104.91920613826356
curr_Factors:  [104.91920614]
mat_Sqrt:  [[0.15]]
grads:  [-0.52553133]
Stock Position:  -0.5255313292855341
Bond Position:  [70.80212617]


portfolio before change:  [15.21402058]
curr_Stock_Price:  105.79189727891647
curr_Factors:  [105.79189728]
mat_Sqrt:  [[0.15]]
grads:  [0.34759464]
Stock Position:  0.3475946370969132
Bond Position:  [-21.55867556]


portfolio before change:  [14.92178883]
curr_Stock_Price:  104.95892486083216
curr_Factors:  [104.95892486]
mat_Sqrt:  [[0.15]]
grads:  [-0.03375287]
Stock Position:  -0.03375287232969039
Bond Position:  [18.46445402]


portfolio before change:  [14.95826172]
curr_Stock_Price:  103.94672402388271
curr_Factors:  [103.94672402]
mat_Sqrt:  [[0.15]]
grads:  [0.01563087]
Stock Position:  0.01563086982626507
Bond Position:  [13.33348401]


portfolio before change:  [14.95825432]
curr_Stock_Price:  103.83961583738272
curr_Factors:  [103.83961584]
mat_Sqrt:  [[0.15]]
grads:  [0.08933252]
Stock Position:  0.08933252269760117
Bond Position:  [5.68199948]


portfolio before change:  [14.99275031]
curr_Stock_Price:  104.2178174097822
curr_Factors:  [104.21781741]
mat_Sqrt:  [[0.15]]
grads:  [0.09016638]
Stock Position:  0.09016637703222928
Bond Position:  [5.59580729]


portfolio before change:  [15.10195374]
curr_Stock_Price:  105.42119176686155
curr_Factors:  [105.42119177]
mat_Sqrt:  [[0.15]]
grads:  [0.06008786]
Stock Position:  0.06008786111560622
Bond Position:  [8.76741981]


portfolio before change:  [15.11000876]
curr_Stock_Price:  105.53700600042941
curr_Factors:  [105.537006]
mat_Sqrt:  [[0.15]]
grads:  [-0.12588538]
Stock Position:  -0.12588538436085805
Bond Position:  [28.39557533]


portfolio before change:  [15.14507585]
curr_Stock_Price:  105.28664004927394
curr_Factors:  [105.28664005]
mat_Sqrt:  [[0.15]]
grads:  [-0.07971779]
Stock Position:  -0.07971779164354229
Bond Position:  [23.53829428]


portfolio before change:  [15.27591451]
curr_Stock_Price:  103.68227809108461
curr_Factors:  [103.68227809]
mat_Sqrt:  [[0.15]]
grads:  [0.01669054]
Stock Position:  0.016690539871305338
Bond Position:  [13.54540131]


portfolio before change:  [15.26358356]
curr_Stock_Price:  102.84202794850682
curr_Factors:  [102.84202795]
mat_Sqrt:  [[0.15]]
grads:  [-0.01214171]
Stock Position:  -0.012141711281882009
Bond Position:  [16.51226177]


portfolio before change:  [15.26951733]
curr_Stock_Price:  102.52332416021864
curr_Factors:  [102.52332416]
mat_Sqrt:  [[0.15]]
grads:  [-0.17388115]
Stock Position:  -0.17388114932681206
Bond Position:  [33.09639077]


portfolio before change:  [15.49544865]
curr_Stock_Price:  101.24777468264878
curr_Factors:  [101.24777468]
mat_Sqrt:  [[0.15]]
grads:  [0.02947652]
Stock Position:  0.029476522992525248
Bond Position:  [12.51101629]


portfolio before change:  [15.49356514]
curr_Stock_Price:  101.13081760645169
curr_Factors:  [101.13081761]
mat_Sqrt:  [[0.15]]
grads:  [-0.00321979]
Stock Position:  -0.00321979283600777
Bond Position:  [15.81918542]


portfolio before change:  [15.49804739]
curr_Stock_Price:  100.35290135845557
curr_Factors:  [100.35290136]
mat_Sqrt:  [[0.15]]
grads:  [-0.07731831]
Stock Position:  -0.07731831032692911
Bond Position:  [23.25716416]


portfolio before change:  [15.48980456]
curr_Stock_Price:  100.49711245503204
curr_Factors:  [100.49711246]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476403]
Stock Position:  -0.0147640317162483
Bond Position:  [16.97354711]


portfolio before change:  [15.48593019]
curr_Stock_Price:  100.9032472998173
curr_Factors:  [100.9032473]
mat_Sqrt:  [[0.15]]
grads:  [0.00189591]
Stock Position:  0.0018959135264746615
Bond Position:  [15.29462636]


portfolio before change:  [15.48892107]
curr_Stock_Price:  101.47233002034416
curr_Factors:  [101.47233002]
mat_Sqrt:  [[0.15]]
grads:  [-0.08181057]
Stock Position:  -0.08181057141227115
Bond Position:  [23.79043037]


portfolio before change:  [15.50356839]
curr_Stock_Price:  101.32964278974882
curr_Factors:  [101.32964279]
mat_Sqrt:  [[0.15]]
grads:  [0.03188247]
Stock Position:  0.03188246990789297
Bond Position:  [12.2729291]


portfolio before change:  [15.49658871]
curr_Stock_Price:  101.06260298252596
curr_Factors:  [101.06260298]
mat_Sqrt:  [[0.15]]
grads:  [0.04799129]
Stock Position:  0.04799129404995664
Bond Position:  [10.64646361]


portfolio before change:  [15.48294423]
curr_Stock_Price:  100.75055947299683
curr_Factors:  [100.75055947]
mat_Sqrt:  [[0.15]]
grads:  [-0.02460742]
Stock Position:  -0.024607421230048273
Bond Position:  [17.96215569]


portfolio before change:  [15.44730489]
curr_Stock_Price:  102.29012547135395
curr_Factors:  [102.29012547]
mat_Sqrt:  [[0.15]]
grads:  [-0.03406237]
Stock Position:  -0.03406237139725943
Bond Position:  [18.93154913]


portfolio before change:  [15.45416864]
curr_Stock_Price:  102.15809815868799
curr_Factors:  [102.15809816]
mat_Sqrt:  [[0.15]]
grads:  [0.00309479]
Stock Position:  0.0030947892623585356
Bond Position:  [15.13801086]


portfolio before change:  [15.45776649]
curr_Stock_Price:  102.70917708942474
curr_Factors:  [102.70917709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07444392]
Stock Position:  -0.07444391733139215
Bond Position:  [23.10383998]


portfolio before change:  [15.40514653]
curr_Stock_Price:  103.45481380572087
curr_Factors:  [103.45481381]
mat_Sqrt:  [[0.15]]
grads:  [0.08814918]
Stock Position:  0.08814917676230434
Bond Position:  [6.28568986]


portfolio before change:  [15.29302003]
curr_Stock_Price:  102.17389129385022
curr_Factors:  [102.17389129]
mat_Sqrt:  [[0.15]]
grads:  [0.15292224]
Stock Position:  0.15292223619141332
Bond Position:  [-0.33163991]


portfolio before change:  [15.43421276]
curr_Stock_Price:  103.09745997184068
curr_Factors:  [103.09745997]
mat_Sqrt:  [[0.15]]
grads:  [-0.06180174]
Stock Position:  -0.061801742366319426
Bond Position:  [21.80581541]


portfolio before change:  [15.43124881]
curr_Stock_Price:  103.18952605158717
curr_Factors:  [103.18952605]
mat_Sqrt:  [[0.15]]
grads:  [0.04235181]
Stock Position:  0.042351813670766805
Bond Position:  [11.06098523]


portfolio before change:  [15.4527324]
curr_Stock_Price:  103.6641427543863
curr_Factors:  [103.66414275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0864256]
Stock Position:  -0.08642559833583108
Bond Position:  [24.41196796]


portfolio before change:  [15.43968482]
curr_Stock_Price:  103.85042160498158
curr_Factors:  [103.8504216]
mat_Sqrt:  [[0.15]]
grads:  [0.00173147]
Stock Position:  0.0017314702832280384
Bond Position:  [15.2598709]


portfolio before change:  [15.44203423]
curr_Stock_Price:  104.10558267680166
curr_Factors:  [104.10558268]
mat_Sqrt:  [[0.15]]
grads:  [-0.03939565]
Stock Position:  -0.03939564553004502
Bond Position:  [19.54334086]


portfolio before change:  [15.42331065]
curr_Stock_Price:  104.64286661817732
curr_Factors:  [104.64286662]
mat_Sqrt:  [[0.15]]
grads:  [0.00477927]
Stock Position:  0.0047792664573642046
Bond Position:  [14.92319451]


portfolio before change:  [15.42676798]
curr_Stock_Price:  104.97593287193494
curr_Factors:  [104.97593287]
mat_Sqrt:  [[0.15]]
grads:  [0.16102131]
Stock Position:  0.16102130820532018
Bond Position:  [-1.47659406]


portfolio before change:  [15.57957924]
curr_Stock_Price:  105.92609190830032
curr_Factors:  [105.92609191]
mat_Sqrt:  [[0.15]]
grads:  [0.02971469]
Stock Position:  0.029714694380127978
Bond Position:  [12.4320178]


portfolio before change:  [15.62517665]
curr_Stock_Price:  107.40829820692122
curr_Factors:  [107.40829821]
mat_Sqrt:  [[0.15]]
grads:  [0.12484872]
Stock Position:  0.1248487154524119
Bond Position:  [2.21538859]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.62517665]
Stock Price:  107.03000004389978
PL:  [8.59517661]
Settle:  Tensor("sub_278:0", shape=(), dtype=float64)
PL:  Tensor("sub_279:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  140
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.50956238e-03]
 [-4.95996828e-03]
 [ 4.17808298e-04]
 [ 2.87015665e-02]
 [-5.80331756e-04]
 [ 3.29444870e-02]
 [ 1.32686387e-02]
 [-7.27521711e-04]
 [ 3.86069837e-03]
 [ 7.77977476e-03]
 [ 2.44398737e-02]
 [ 1.06279647e-02]
 [-1.10839726e-02]
 [ 1.14055901e-02]
 [-7.37664994e-03]
 [-2.36619542e-02]
 [ 4.66336239e-03]
 [ 1.03961732e-03]
 [-9.41709425e-03]
 [-2.30848858e-03]
 [-4.49264151e-04]
 [-7.71742124e-03]
 [ 4.78530855e-03]
 [ 7.27336243e-03]
 [-4.00896434e-03]
 [-5.84533349e-03]
 [-1.02107290e-03]
 [-6.41984726e-03]
 [ 1.69234187e-02]
 [ 2.32405580e-02]
 [-2.78315802e-03]
 [ 5.95293061e-03]
 [-1.24491367e-02]
 [-6.45772706e-03]
 [-6.74063141e-03]
 [-7.46557958e-03]
 [ 2.27682192e-02]
 [ 6.82362871e-03]
 [ 2.42790560e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.86466415]
curr_Stock_Price:  100.05957218054391
curr_Factors:  [100.05957218]
mat_Sqrt:  [[0.15]]
grads:  [-0.01006375]
Stock Position:  -0.010063749217781994
Bond Position:  [3.87163859]


portfolio before change:  [2.85408337]
curr_Stock_Price:  101.15904002251581
curr_Factors:  [101.15904002]
mat_Sqrt:  [[0.15]]
grads:  [-0.03306646]
Stock Position:  -0.03306645518397468
Bond Position:  [6.19905423]


portfolio before change:  [2.81048656]
curr_Stock_Price:  102.50093587315901
curr_Factors:  [102.50093587]
mat_Sqrt:  [[0.15]]
grads:  [0.00278539]
Stock Position:  0.002785388651661211
Bond Position:  [2.52498161]


portfolio before change:  [2.80767589]
curr_Stock_Price:  101.37853899430239
curr_Factors:  [101.37853899]
mat_Sqrt:  [[0.15]]
grads:  [0.19134378]
Stock Position:  0.19134377670435004
Bond Position:  [-16.59047664]


portfolio before change:  [2.91610176]
curr_Stock_Price:  101.95603262033859
curr_Factors:  [101.95603262]
mat_Sqrt:  [[0.15]]
grads:  [-0.00386888]
Stock Position:  -0.0038688783763411497
Bond Position:  [3.31055725]


portfolio before change:  [2.91489078]
curr_Stock_Price:  102.3760051417472
curr_Factors:  [102.37600514]
mat_Sqrt:  [[0.15]]
grads:  [0.21962991]
Stock Position:  0.21962991320175262
Bond Position:  [-19.56994234]


portfolio before change:  [2.75340223]
curr_Stock_Price:  101.65186808988715
curr_Factors:  [101.65186809]
mat_Sqrt:  [[0.15]]
grads:  [0.08845759]
Stock Position:  0.088457591188674
Bond Position:  [-6.23847716]


portfolio before change:  [2.74316604]
curr_Stock_Price:  101.54496560661296
curr_Factors:  [101.54496561]
mat_Sqrt:  [[0.15]]
grads:  [-0.00485014]
Stock Position:  -0.00485014473805816
Bond Position:  [3.23567382]


portfolio before change:  [2.74468199]
curr_Stock_Price:  101.31580253412938
curr_Factors:  [101.31580253]
mat_Sqrt:  [[0.15]]
grads:  [0.02573799]
Stock Position:  0.025737989132017216
Bond Position:  [0.13701697]


portfolio before change:  [2.73298342]
curr_Stock_Price:  100.86061143628106
curr_Factors:  [100.86061144]
mat_Sqrt:  [[0.15]]
grads:  [0.05186517]
Stock Position:  0.05186516509801453
Bond Position:  [-2.49816884]


portfolio before change:  [2.76347191]
curr_Stock_Price:  101.45447403280886
curr_Factors:  [101.45447403]
mat_Sqrt:  [[0.15]]
grads:  [0.16293249]
Stock Position:  0.16293249106190938
Bond Position:  [-13.76675827]


portfolio before change:  [2.65030949]
curr_Stock_Price:  100.77050075038079
curr_Factors:  [100.77050075]
mat_Sqrt:  [[0.15]]
grads:  [0.0708531]
Stock Position:  0.0708530980931784
Bond Position:  [-4.48959269]


portfolio before change:  [2.685201]
curr_Stock_Price:  101.27087047813276
curr_Factors:  [101.27087048]
mat_Sqrt:  [[0.15]]
grads:  [-0.07389315]
Stock Position:  -0.07389315074344895
Bond Position:  [10.1684247]


portfolio before change:  [2.63363379]
curr_Stock_Price:  101.98593455445463
curr_Factors:  [101.98593455]
mat_Sqrt:  [[0.15]]
grads:  [0.07603727]
Stock Position:  0.07603726737003672
Bond Position:  [-5.12109798]


portfolio before change:  [2.56072781]
curr_Stock_Price:  101.03553468834973
curr_Factors:  [101.03553469]
mat_Sqrt:  [[0.15]]
grads:  [-0.04917767]
Stock Position:  -0.04917766628885846
Bond Position:  [7.52941962]


portfolio before change:  [2.57755558]
curr_Stock_Price:  100.71249098893037
curr_Factors:  [100.71249099]
mat_Sqrt:  [[0.15]]
grads:  [-0.15774636]
Stock Position:  -0.15774636121338254
Bond Position:  [18.46458456]


portfolio before change:  [2.55593051]
curr_Stock_Price:  100.86421105694181
curr_Factors:  [100.86421106]
mat_Sqrt:  [[0.15]]
grads:  [0.03108908]
Stock Position:  0.031089082580628744
Bond Position:  [-0.57984528]


portfolio before change:  [2.5727584]
curr_Stock_Price:  101.4078223536258
curr_Factors:  [101.40782235]
mat_Sqrt:  [[0.15]]
grads:  [0.00693078]
Stock Position:  0.006930782101436741
Bond Position:  [1.86992288]


portfolio before change:  [2.5721541]
curr_Stock_Price:  101.28690540642175
curr_Factors:  [101.28690541]
mat_Sqrt:  [[0.15]]
grads:  [-0.06278063]
Stock Position:  -0.0627806283619942
Bond Position:  [8.93100967]


portfolio before change:  [2.55896791]
curr_Stock_Price:  101.51472471504661
curr_Factors:  [101.51472472]
mat_Sqrt:  [[0.15]]
grads:  [-0.01538992]
Stock Position:  -0.015389923898007744
Bond Position:  [4.1212718]


portfolio before change:  [2.55264087]
curr_Stock_Price:  101.95931627568396
curr_Factors:  [101.95931628]
mat_Sqrt:  [[0.15]]
grads:  [-0.00299509]
Stock Position:  -0.0029950943392428125
Bond Position:  [2.85801864]


portfolio before change:  [2.5548441]
curr_Stock_Price:  101.3429917860359
curr_Factors:  [101.34299179]
mat_Sqrt:  [[0.15]]
grads:  [-0.05144947]
Stock Position:  -0.0514494749178468
Bond Position:  [7.76888781]


portfolio before change:  [2.53981043]
curr_Stock_Price:  101.65407046714125
curr_Factors:  [101.65407047]
mat_Sqrt:  [[0.15]]
grads:  [0.03190206]
Stock Position:  0.0319020569942387
Bond Position:  [-0.70316352]


portfolio before change:  [2.52450503]
curr_Stock_Price:  101.17706350896854
curr_Factors:  [101.17706351]
mat_Sqrt:  [[0.15]]
grads:  [0.04848908]
Stock Position:  0.04848908288087324
Bond Position:  [-2.38147799]


portfolio before change:  [2.54927546]
curr_Stock_Price:  101.69404867829968
curr_Factors:  [101.69404868]
mat_Sqrt:  [[0.15]]
grads:  [-0.02672643]
Stock Position:  -0.026726428911476176
Bond Position:  [5.26719423]


portfolio before change:  [2.54365942]
curr_Stock_Price:  101.9288155419625
curr_Factors:  [101.92881554]
mat_Sqrt:  [[0.15]]
grads:  [-0.03896889]
Stock Position:  -0.03896888992968853
Bond Position:  [6.51571222]


portfolio before change:  [2.52343974]
curr_Stock_Price:  102.46858459726079
curr_Factors:  [102.4685846]
mat_Sqrt:  [[0.15]]
grads:  [-0.00680715]
Stock Position:  -0.0068071526868636704
Bond Position:  [3.22095904]


portfolio before change:  [2.51720253]
curr_Stock_Price:  103.44400757214945
curr_Factors:  [103.44400757]
mat_Sqrt:  [[0.15]]
grads:  [-0.04279898]
Stock Position:  -0.04279898173967946
Bond Position:  [6.94450072]


portfolio before change:  [2.50769902]
curr_Stock_Price:  103.68634100127271
curr_Factors:  [103.686341]
mat_Sqrt:  [[0.15]]
grads:  [0.11282279]
Stock Position:  0.11282279111401751
Bond Position:  [-9.19048337]


portfolio before change:  [2.36008849]
curr_Stock_Price:  102.3881844188714
curr_Factors:  [102.38818442]
mat_Sqrt:  [[0.15]]
grads:  [0.15493705]
Stock Position:  0.1549370533885104
Bond Position:  [-13.5036351]


portfolio before change:  [2.33439669]
curr_Stock_Price:  102.23325865695782
curr_Factors:  [102.23325866]
mat_Sqrt:  [[0.15]]
grads:  [-0.01855439]
Stock Position:  -0.0185543868106818
Bond Position:  [4.23127212]


portfolio before change:  [2.35277158]
curr_Stock_Price:  101.27144065018516
curr_Factors:  [101.27144065]
mat_Sqrt:  [[0.15]]
grads:  [0.0396862]
Stock Position:  0.03968620408450374
Bond Position:  [-1.66630749]


portfolio before change:  [2.33072843]
curr_Stock_Price:  100.72125328039868
curr_Factors:  [100.72125328]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299424]
Stock Position:  -0.08299424436065189
Bond Position:  [10.69001273]


portfolio before change:  [2.28247537]
curr_Stock_Price:  101.31875725982857
curr_Factors:  [101.31875726]
mat_Sqrt:  [[0.15]]
grads:  [-0.04305151]
Stock Position:  -0.04305151371184585
Bond Position:  [6.64440124]


portfolio before change:  [2.33359369]
curr_Stock_Price:  100.15067471015004
curr_Factors:  [100.15067471]
mat_Sqrt:  [[0.15]]
grads:  [-0.04493754]
Stock Position:  -0.044937542756914514
Bond Position:  [6.83411892]


portfolio before change:  [2.3413568]
curr_Stock_Price:  99.99693277385902
curr_Factors:  [99.99693277]
mat_Sqrt:  [[0.15]]
grads:  [-0.04977053]
Stock Position:  -0.049770530537859174
Bond Position:  [7.31825719]


portfolio before change:  [2.31710389]
curr_Stock_Price:  100.502608450027
curr_Factors:  [100.50260845]
mat_Sqrt:  [[0.15]]
grads:  [0.15178813]
Stock Position:  0.15178812784040246
Bond Position:  [-12.93799889]


portfolio before change:  [2.31700844]
curr_Stock_Price:  100.51263495316705
curr_Factors:  [100.51263495]
mat_Sqrt:  [[0.15]]
grads:  [0.04549086]
Stock Position:  0.04549085806674854
Bond Position:  [-2.25539757]


portfolio before change:  [2.29782283]
curr_Stock_Price:  100.09708608799107
curr_Factors:  [100.09708609]
mat_Sqrt:  [[0.15]]
grads:  [0.16186037]
Stock Position:  0.16186037300064668
Bond Position:  [-13.90392886]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.29782283]
Stock Price:  99.62071085974705
PL:  [2.29782283]
Settle:  Tensor("sub_280:0", shape=(), dtype=float64)
PL:  Tensor("sub_281:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  141
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.45022362e-03]
 [-1.41613574e-02]
 [-5.58866640e-02]
 [-2.96614631e-02]
 [ 1.48866259e-02]
 [ 2.16121805e-02]
 [ 2.28676250e-02]
 [-3.19606626e-03]
 [ 3.62284084e-03]
 [ 9.20482043e-03]
 [ 1.95075400e-02]
 [ 9.62026912e-03]
 [-1.11528151e-02]
 [ 1.17228228e-02]
 [-6.08780975e-03]
 [-2.72808563e-02]
 [ 4.37885923e-03]
 [ 1.17419805e-03]
 [-4.84258086e-04]
 [-2.88533939e-03]
 [-1.87936893e-03]
 [-3.95843329e-02]
 [ 4.82928523e-03]
 [ 1.04027088e-02]
 [-5.54674357e-03]
 [-2.48275165e-03]
 [ 5.28935630e-03]
 [-1.65629581e-02]
 [-1.30944041e-02]
 [ 2.33102819e-02]
 [-1.19705751e-02]
 [ 6.39053065e-03]
 [-1.29686455e-02]
 [-3.01219901e-03]
 [-5.60409449e-03]
 [-9.12527266e-04]
 [ 2.36892699e-02]
 [-3.69003382e-04]
 [ 2.07486229e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.03268481]
curr_Stock_Price:  98.9710099733886
curr_Factors:  [98.97100997]
mat_Sqrt:  [[0.15]]
grads:  [-0.03633482]
Stock Position:  -0.03633482412430784
Bond Position:  [-10.43659057]


portfolio before change:  [-13.97429804]
curr_Stock_Price:  97.32819409208308
curr_Factors:  [97.32819409]
mat_Sqrt:  [[0.15]]
grads:  [-0.09440905]
Stock Position:  -0.09440904962654337
Bond Position:  [-4.78563573]


portfolio before change:  [-13.90339239]
curr_Stock_Price:  96.57081026614976
curr_Factors:  [96.57081027]
mat_Sqrt:  [[0.15]]
grads:  [-0.37257776]
Stock Position:  -0.3725777597854064
Bond Position:  [22.07674376]


portfolio before change:  [-14.21393419]
curr_Stock_Price:  97.41171275542683
curr_Factors:  [97.41171276]
mat_Sqrt:  [[0.15]]
grads:  [-0.19774309]
Stock Position:  -0.1977430871349414
Bond Position:  [5.04855861]


portfolio before change:  [-14.42608777]
curr_Stock_Price:  98.48777914170773
curr_Factors:  [98.48777914]
mat_Sqrt:  [[0.15]]
grads:  [0.09924417]
Stock Position:  0.09924417259856311
Bond Position:  [-24.20042592]


portfolio before change:  [-14.39273822]
curr_Stock_Price:  98.85429733632795
curr_Factors:  [98.85429734]
mat_Sqrt:  [[0.15]]
grads:  [0.1440812]
Stock Position:  0.1440812033989671
Bond Position:  [-28.63578434]


portfolio before change:  [-14.31166554]
curr_Stock_Price:  99.44182973810358
curr_Factors:  [99.44182974]
mat_Sqrt:  [[0.15]]
grads:  [0.15245083]
Stock Position:  0.15245083335246035
Bond Position:  [-29.47165535]


portfolio before change:  [-14.34357621]
curr_Stock_Price:  99.25667838075279
curr_Factors:  [99.25667838]
mat_Sqrt:  [[0.15]]
grads:  [-0.02130711]
Stock Position:  -0.02130710838682838
Bond Position:  [-12.2287034]


portfolio before change:  [-14.38787254]
curr_Stock_Price:  101.26387939421494
curr_Factors:  [101.26387939]
mat_Sqrt:  [[0.15]]
grads:  [0.02415227]
Stock Position:  0.02415227227174177
Bond Position:  [-16.83362533]


portfolio before change:  [-14.39198077]
curr_Stock_Price:  101.18091005055616
curr_Factors:  [101.18091005]
mat_Sqrt:  [[0.15]]
grads:  [0.06136547]
Stock Position:  0.061365469538404625
Bond Position:  [-20.60099483]


portfolio before change:  [-14.40626411]
curr_Stock_Price:  100.99011779154729
curr_Factors:  [100.99011779]
mat_Sqrt:  [[0.15]]
grads:  [0.13005027]
Stock Position:  0.1300502666201293
Bond Position:  [-27.54005586]


portfolio before change:  [-14.31861879]
curr_Stock_Price:  101.69052425037171
curr_Factors:  [101.69052425]
mat_Sqrt:  [[0.15]]
grads:  [0.06413513]
Stock Position:  0.06413512749164607
Bond Position:  [-20.84055353]


portfolio before change:  [-14.34287094]
curr_Stock_Price:  101.35300381441907
curr_Factors:  [101.35300381]
mat_Sqrt:  [[0.15]]
grads:  [-0.0743521]
Stock Position:  -0.07435210092807008
Bond Position:  [-6.80706217]


portfolio before change:  [-14.33701186]
curr_Stock_Price:  101.26275736647725
curr_Factors:  [101.26275737]
mat_Sqrt:  [[0.15]]
grads:  [0.07815215]
Stock Position:  0.07815215231273046
Bond Position:  [-22.2509143]


portfolio before change:  [-14.31433968]
curr_Stock_Price:  101.58845183423335
curr_Factors:  [101.58845183]
mat_Sqrt:  [[0.15]]
grads:  [-0.0405854]
Stock Position:  -0.040585398328347976
Bond Position:  [-10.19133189]


portfolio before change:  [-14.32695339]
curr_Stock_Price:  101.86785572556812
curr_Factors:  [101.86785573]
mat_Sqrt:  [[0.15]]
grads:  [-0.18187238]
Stock Position:  -0.1818723751027058
Bond Position:  [4.19999548]


portfolio before change:  [-14.45636588]
curr_Stock_Price:  102.58229914042695
curr_Factors:  [102.58229914]
mat_Sqrt:  [[0.15]]
grads:  [0.02919239]
Stock Position:  0.029192394875611056
Bond Position:  [-17.45098886]


portfolio before change:  [-14.46513638]
curr_Stock_Price:  102.35658980448599
curr_Factors:  [102.3565898]
mat_Sqrt:  [[0.15]]
grads:  [0.00782799]
Stock Position:  0.007827987019848775
Bond Position:  [-15.26638244]


portfolio before change:  [-14.46127222]
curr_Stock_Price:  103.09401842306461
curr_Factors:  [103.09401842]
mat_Sqrt:  [[0.15]]
grads:  [-0.00322839]
Stock Position:  -0.003228387237801366
Bond Position:  [-14.12844481]


portfolio before change:  [-14.46259592]
curr_Stock_Price:  102.95696320993308
curr_Factors:  [102.95696321]
mat_Sqrt:  [[0.15]]
grads:  [-0.0192356]
Stock Position:  -0.019235595964392564
Bond Position:  [-12.48215737]


portfolio before change:  [-14.49353774]
curr_Stock_Price:  104.48441573730706
curr_Factors:  [104.48441574]
mat_Sqrt:  [[0.15]]
grads:  [-0.01252913]
Stock Position:  -0.012529126207911457
Bond Position:  [-13.18443931]


portfolio before change:  [-14.49602516]
curr_Stock_Price:  104.5514004030203
curr_Factors:  [104.5514004]
mat_Sqrt:  [[0.15]]
grads:  [-0.26389555]
Stock Position:  -0.2638955528595456
Bond Position:  [13.09462445]


portfolio before change:  [-14.75591546]
curr_Stock_Price:  105.54242592020245
curr_Factors:  [105.54242592]
mat_Sqrt:  [[0.15]]
grads:  [0.03219523]
Stock Position:  0.03219523489258687
Bond Position:  [-18.15387865]


portfolio before change:  [-14.78678575]
curr_Stock_Price:  104.65406736580638
curr_Factors:  [104.65406737]
mat_Sqrt:  [[0.15]]
grads:  [0.06935139]
Stock Position:  0.06935139195988434
Bond Position:  [-22.04469099]


portfolio before change:  [-14.81042673]
curr_Stock_Price:  104.35291660368098
curr_Factors:  [104.3529166]
mat_Sqrt:  [[0.15]]
grads:  [-0.03697829]
Stock Position:  -0.036978290475551664
Bond Position:  [-10.95163427]


portfolio before change:  [-14.77164381]
curr_Stock_Price:  103.26709147367198
curr_Factors:  [103.26709147]
mat_Sqrt:  [[0.15]]
grads:  [-0.01655168]
Stock Position:  -0.016551677634314074
Bond Position:  [-13.06240021]


portfolio before change:  [-14.74512532]
curr_Stock_Price:  101.56627337114354
curr_Factors:  [101.56627337]
mat_Sqrt:  [[0.15]]
grads:  [0.03526238]
Stock Position:  0.03526237530673711
Bond Position:  [-18.32659337]


portfolio before change:  [-14.7426967]
curr_Stock_Price:  101.7001156009421
curr_Factors:  [101.7001156]
mat_Sqrt:  [[0.15]]
grads:  [-0.11041972]
Stock Position:  -0.11041972087991186
Bond Position:  [-3.51299832]


portfolio before change:  [-14.73587007]
curr_Stock_Price:  101.63431414268608
curr_Factors:  [101.63431414]
mat_Sqrt:  [[0.15]]
grads:  [-0.08729603]
Stock Position:  -0.08729602712456384
Bond Position:  [-5.86359822]


portfolio before change:  [-14.8067287]
curr_Stock_Price:  102.43762263092864
curr_Factors:  [102.43762263]
mat_Sqrt:  [[0.15]]
grads:  [0.15540188]
Stock Position:  0.15540187912585873
Bond Position:  [-30.72572775]


portfolio before change:  [-14.6344233]
curr_Stock_Price:  103.57111186367712
curr_Factors:  [103.57111186]
mat_Sqrt:  [[0.15]]
grads:  [-0.07980383]
Stock Position:  -0.07980383376044871
Bond Position:  [-6.36905151]


portfolio before change:  [-14.59018531]
curr_Stock_Price:  103.00680090942657
curr_Factors:  [103.00680091]
mat_Sqrt:  [[0.15]]
grads:  [0.04260354]
Stock Position:  0.042603537668143676
Bond Position:  [-18.97863943]


portfolio before change:  [-14.56177356]
curr_Stock_Price:  103.72937539326155
curr_Factors:  [103.72937539]
mat_Sqrt:  [[0.15]]
grads:  [-0.08645764]
Stock Position:  -0.08645763650913477
Bond Position:  [-5.59357692]


portfolio before change:  [-14.4971019]
curr_Stock_Price:  102.9732721397457
curr_Factors:  [102.97327214]
mat_Sqrt:  [[0.15]]
grads:  [-0.02008133]
Stock Position:  -0.020081326721347808
Bond Position:  [-12.42926197]


portfolio before change:  [-14.4987177]
curr_Stock_Price:  102.97636197477061
curr_Factors:  [102.97636197]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736063]
Stock Position:  -0.03736062993073424
Bond Position:  [-10.65145595]


portfolio before change:  [-14.53182271]
curr_Stock_Price:  103.82681588692694
curr_Factors:  [103.82681589]
mat_Sqrt:  [[0.15]]
grads:  [-0.00608352]
Stock Position:  -0.00608351510440547
Bond Position:  [-13.90019071]


portfolio before change:  [-14.53284709]
curr_Stock_Price:  103.70957334805
curr_Factors:  [103.70957335]
mat_Sqrt:  [[0.15]]
grads:  [0.15792847]
Stock Position:  0.1579284659331289
Bond Position:  [-30.91154092]


portfolio before change:  [-14.56107463]
curr_Stock_Price:  103.55530510085659
curr_Factors:  [103.5553051]
mat_Sqrt:  [[0.15]]
grads:  [-0.00246002]
Stock Position:  -0.0024600225440792123
Bond Position:  [-14.30632624]


portfolio before change:  [-14.56401876]
curr_Stock_Price:  104.02511244721157
curr_Factors:  [104.02511245]
mat_Sqrt:  [[0.15]]
grads:  [0.13832415]
Stock Position:  0.13832415238673784
Bond Position:  [-28.95320427]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.56401876]
Stock Price:  103.22023950166951
PL:  [-17.78425827]
Settle:  Tensor("sub_282:0", shape=(), dtype=float64)
PL:  Tensor("sub_283:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  142
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.35157878e-03]
 [-1.44710752e-03]
 [-2.30478113e-03]
 [ 7.35775008e-02]
 [-6.17481506e-02]
 [ 5.23571294e-02]
 [-8.66868433e-03]
 [ 4.02178072e-03]
 [ 2.28586076e-02]
 [ 1.50769266e-02]
 [-1.21285593e-02]
 [-3.00281807e-02]
 [-1.12470911e-02]
 [-1.65623680e-02]
 [ 1.13586934e-02]
 [-3.97495311e-02]
 [ 5.14336045e-03]
 [-1.61429752e-02]
 [ 1.42069398e-02]
 [-4.60382100e-03]
 [-3.46449395e-03]
 [-3.90277094e-02]
 [ 4.86395472e-03]
 [ 1.52645779e-02]
 [-6.41245771e-03]
 [ 2.10539336e-02]
 [-1.39347878e-02]
 [ 7.77035512e-03]
 [ 5.66618332e-02]
 [ 2.63199937e-02]
 [-2.28415687e-02]
 [ 4.58804225e-03]
 [-1.32628656e-02]
 [ 5.19931059e-03]
 [-6.60405408e-03]
 [ 1.88703916e-03]
 [ 2.37692294e-02]
 [ 2.37102235e-04]
 [ 2.30285947e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [11.61078305]
curr_Stock_Price:  100.62301526944574
curr_Factors:  [100.62301527]
mat_Sqrt:  [[0.15]]
grads:  [-0.00901053]
Stock Position:  -0.009010525178195549
Bond Position:  [12.51744926]


portfolio before change:  [11.60288992]
curr_Stock_Price:  101.6726663488413
curr_Factors:  [101.67266635]
mat_Sqrt:  [[0.15]]
grads:  [-0.00964738]
Stock Position:  -0.009647383484765827
Bond Position:  [12.58376512]


portfolio before change:  [11.61194264]
curr_Stock_Price:  100.89736266413787
curr_Factors:  [100.89736266]
mat_Sqrt:  [[0.15]]
grads:  [-0.01536521]
Stock Position:  -0.015365207556055463
Bond Position:  [13.16225156]


portfolio before change:  [11.58487508]
curr_Stock_Price:  102.7660611613969
curr_Factors:  [102.76606116]
mat_Sqrt:  [[0.15]]
grads:  [0.49051667]
Stock Position:  0.4905166721101436
Bond Position:  [-38.82359124]


portfolio before change:  [12.31048549]
curr_Stock_Price:  104.25523308516448
curr_Factors:  [104.25523309]
mat_Sqrt:  [[0.15]]
grads:  [-0.41165434]
Stock Position:  -0.4116543371080994
Bond Position:  [55.22760435]


portfolio before change:  [11.66970325]
curr_Stock_Price:  105.82860680840034
curr_Factors:  [105.82860681]
mat_Sqrt:  [[0.15]]
grads:  [0.34904753]
Stock Position:  0.3490475290695097
Bond Position:  [-25.26951046]


portfolio before change:  [11.64640384]
curr_Stock_Price:  105.77090541893325
curr_Factors:  [105.77090542]
mat_Sqrt:  [[0.15]]
grads:  [-0.05779123]
Stock Position:  -0.05779122888175176
Bond Position:  [17.75903444]


portfolio before change:  [11.64421078]
curr_Stock_Price:  105.84726780734165
curr_Factors:  [105.84726781]
mat_Sqrt:  [[0.15]]
grads:  [0.02681187]
Stock Position:  0.026811871473851764
Bond Position:  [8.80624744]


portfolio before change:  [11.6751494]
curr_Stock_Price:  106.96012448338202
curr_Factors:  [106.96012448]
mat_Sqrt:  [[0.15]]
grads:  [0.15239072]
Stock Position:  0.15239071719881173
Bond Position:  [-4.62458068]


portfolio before change:  [11.64820064]
curr_Stock_Price:  106.7870781845838
curr_Factors:  [106.78707818]
mat_Sqrt:  [[0.15]]
grads:  [0.10051284]
Stock Position:  0.1005128437735489
Bond Position:  [0.91472774]


portfolio before change:  [11.77273834]
curr_Stock_Price:  108.02496328984536
curr_Factors:  [108.02496329]
mat_Sqrt:  [[0.15]]
grads:  [-0.08085706]
Stock Position:  -0.08085706193813288
Bond Position:  [20.50731949]


portfolio before change:  [11.83619958]
curr_Stock_Price:  107.2718112125504
curr_Factors:  [107.27181121]
mat_Sqrt:  [[0.15]]
grads:  [-0.20018787]
Stock Position:  -0.20018787100695384
Bond Position:  [33.31071509]


portfolio before change:  [12.01875793]
curr_Stock_Price:  106.38067704556175
curr_Factors:  [106.38067705]
mat_Sqrt:  [[0.15]]
grads:  [-0.07498061]
Stock Position:  -0.0749806073492044
Bond Position:  [19.99524571]


portfolio before change:  [12.04798216]
curr_Stock_Price:  106.02425596658202
curr_Factors:  [106.02425597]
mat_Sqrt:  [[0.15]]
grads:  [-0.11041579]
Stock Position:  -0.11041578688467563
Bond Position:  [23.75473382]


portfolio before change:  [11.82375576]
curr_Stock_Price:  108.08189591947338
curr_Factors:  [108.08189592]
mat_Sqrt:  [[0.15]]
grads:  [0.07572462]
Stock Position:  0.07572462252842066
Bond Position:  [3.63929499]


portfolio before change:  [11.80418928]
curr_Stock_Price:  107.81749813599413
curr_Factors:  [107.81749814]
mat_Sqrt:  [[0.15]]
grads:  [-0.26499687]
Stock Position:  -0.26499687420309387
Bond Position:  [40.37548927]


portfolio before change:  [11.86936018]
curr_Stock_Price:  107.59061376734499
curr_Factors:  [107.59061377]
mat_Sqrt:  [[0.15]]
grads:  [0.03428907]
Stock Position:  0.0342890696993756
Bond Position:  [8.18017812]


portfolio before change:  [11.86544269]
curr_Stock_Price:  107.44654239413036
curr_Factors:  [107.44654239]
mat_Sqrt:  [[0.15]]
grads:  [-0.10761983]
Stock Position:  -0.1076198347908477
Bond Position:  [23.42882183]


portfolio before change:  [11.98733367]
curr_Stock_Price:  106.34114954969114
curr_Factors:  [106.34114955]
mat_Sqrt:  [[0.15]]
grads:  [0.09471293]
Stock Position:  0.09471293218548993
Bond Position:  [1.91545158]


portfolio before change:  [11.98382621]
curr_Stock_Price:  106.30158891380462
curr_Factors:  [106.30158891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03069214]
Stock Position:  -0.030692139998496105
Bond Position:  [15.24644946]


portfolio before change:  [11.94053406]
curr_Stock_Price:  107.77421595487819
curr_Factors:  [107.77421595]
mat_Sqrt:  [[0.15]]
grads:  [-0.02309663]
Stock Position:  -0.023096626342601977
Bond Position:  [14.42975486]


portfolio before change:  [11.9350721]
curr_Stock_Price:  108.08879825598531
curr_Factors:  [108.08879826]
mat_Sqrt:  [[0.15]]
grads:  [-0.26018473]
Stock Position:  -0.26018472911960905
Bond Position:  [40.0581268]


portfolio before change:  [11.75254132]
curr_Stock_Price:  108.80958754625338
curr_Factors:  [108.80958755]
mat_Sqrt:  [[0.15]]
grads:  [0.03242636]
Stock Position:  0.0324263648207904
Bond Position:  [8.22424194]


portfolio before change:  [11.75847114]
curr_Stock_Price:  108.96075240907489
curr_Factors:  [108.96075241]
mat_Sqrt:  [[0.15]]
grads:  [0.10176385]
Stock Position:  0.1017638529423435
Bond Position:  [0.67020515]


portfolio before change:  [11.74781128]
curr_Stock_Price:  108.85517815711151
curr_Factors:  [108.85517816]
mat_Sqrt:  [[0.15]]
grads:  [-0.04274972]
Stock Position:  -0.04274971804012586
Bond Position:  [16.40133945]


portfolio before change:  [11.78959933]
curr_Stock_Price:  107.92563389001178
curr_Factors:  [107.92563389]
mat_Sqrt:  [[0.15]]
grads:  [0.14035956]
Stock Position:  0.140359557577309
Bond Position:  [-3.3587949]


portfolio before change:  [11.62688427]
curr_Stock_Price:  106.76935221357179
curr_Factors:  [106.76935221]
mat_Sqrt:  [[0.15]]
grads:  [-0.09289859]
Stock Position:  -0.09289858530283406
Bond Position:  [21.54560604]


portfolio before change:  [11.66006299]
curr_Stock_Price:  106.44119484666821
curr_Factors:  [106.44119485]
mat_Sqrt:  [[0.15]]
grads:  [0.05180237]
Stock Position:  0.05180236748313356
Bond Position:  [6.1461571]


portfolio before change:  [11.65403181]
curr_Stock_Price:  106.3099362950099
curr_Factors:  [106.3099363]
mat_Sqrt:  [[0.15]]
grads:  [0.37774555]
Stock Position:  0.37774555450072317
Bond Position:  [-28.50407403]


portfolio before change:  [11.43950035]
curr_Stock_Price:  105.75144334887376
curr_Factors:  [105.75144335]
mat_Sqrt:  [[0.15]]
grads:  [0.17546662]
Stock Position:  0.1754666245045969
Bond Position:  [-7.11634845]


portfolio before change:  [11.39062215]
curr_Stock_Price:  105.4779520519404
curr_Factors:  [105.47795205]
mat_Sqrt:  [[0.15]]
grads:  [-0.15227712]
Stock Position:  -0.15227712466196403
Bond Position:  [27.45250141]


portfolio before change:  [11.21818945]
curr_Stock_Price:  106.6328496023155
curr_Factors:  [106.6328496]
mat_Sqrt:  [[0.15]]
grads:  [0.03058695]
Stock Position:  0.030586948366533626
Bond Position:  [7.95661599]


portfolio before change:  [11.25253159]
curr_Stock_Price:  107.72310209226302
curr_Factors:  [107.72310209]
mat_Sqrt:  [[0.15]]
grads:  [-0.0884191]
Stock Position:  -0.08841910411670666
Bond Position:  [20.77731177]


portfolio before change:  [11.31325091]
curr_Stock_Price:  107.06575553476563
curr_Factors:  [107.06575553]
mat_Sqrt:  [[0.15]]
grads:  [0.03466207]
Stock Position:  0.03466207058458375
Bond Position:  [7.60213013]


portfolio before change:  [11.27332332]
curr_Stock_Price:  105.88642853807333
curr_Factors:  [105.88642854]
mat_Sqrt:  [[0.15]]
grads:  [-0.04402703]
Stock Position:  -0.044027027209394234
Bond Position:  [15.93518799]


portfolio before change:  [11.30426414]
curr_Stock_Price:  105.22890503961598
curr_Factors:  [105.22890504]
mat_Sqrt:  [[0.15]]
grads:  [0.01258026]
Stock Position:  0.012580261070944388
Bond Position:  [9.98045705]


portfolio before change:  [11.28812573]
curr_Stock_Price:  103.84689444856146
curr_Factors:  [103.84689445]
mat_Sqrt:  [[0.15]]
grads:  [0.15846153]
Stock Position:  0.15846152917101688
Bond Position:  [-5.16761197]


portfolio before change:  [11.0605545]
curr_Stock_Price:  102.41484188620923
curr_Factors:  [102.41484189]
mat_Sqrt:  [[0.15]]
grads:  [0.00158068]
Stock Position:  0.0015806815684913777
Bond Position:  [10.89866924]


portfolio before change:  [11.06017089]
curr_Stock_Price:  101.3102412252732
curr_Factors:  [101.31024123]
mat_Sqrt:  [[0.15]]
grads:  [0.15352396]
Stock Position:  0.15352396495482587
Bond Position:  [-4.49337903]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.06017089]
Stock Price:  100.0937774817286
PL:  [10.96639341]
Settle:  Tensor("sub_284:0", shape=(), dtype=float64)
PL:  Tensor("sub_285:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  143
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.46985899e-03]
 [-1.07163725e-02]
 [ 2.04839430e-02]
 [-1.49212825e-03]
 [ 6.12919111e-03]
 [ 2.17143086e-02]
 [ 2.05167994e-02]
 [-3.16810676e-03]
 [ 1.28497638e-02]
 [-3.45358252e-04]
 [ 1.04322224e-02]
 [-1.44899373e-03]
 [ 4.62293286e-03]
 [ 1.08122896e-02]
 [-1.75073352e-03]
 [-1.28195105e-02]
 [-6.72028902e-03]
 [-1.17433289e-03]
 [-7.60842137e-03]
 [-2.60499882e-03]
 [ 4.47370475e-04]
 [ 1.19079633e-02]
 [ 4.75978876e-03]
 [ 5.38024899e-03]
 [-1.35186469e-03]
 [-5.17282131e-03]
 [-6.30701402e-03]
 [-2.01851178e-02]
 [-3.59995921e-02]
 [ 2.19040987e-02]
 [ 2.64082070e-03]
 [-7.02450623e-03]
 [-1.24278596e-02]
 [-1.01108204e-02]
 [-6.46797939e-03]
 [-4.91320595e-03]
 [ 1.96876368e-02]
 [ 8.86975699e-03]
 [ 2.12037143e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.1666984]
curr_Stock_Price:  100.2722960640817
curr_Factors:  [100.27229606]
mat_Sqrt:  [[0.15]]
grads:  [-0.00979906]
Stock Position:  -0.009799059963349557
Bond Position:  [7.14927264]


portfolio before change:  [6.16402676]
curr_Stock_Price:  100.63614233545442
curr_Factors:  [100.63614234]
mat_Sqrt:  [[0.15]]
grads:  [-0.07144248]
Stock Position:  -0.07144248359510114
Bond Position:  [13.35372271]


portfolio before change:  [6.20685864]
curr_Stock_Price:  100.05997873104988
curr_Factors:  [100.05997873]
mat_Sqrt:  [[0.15]]
grads:  [0.13655962]
Stock Position:  0.13655962018952653
Bond Position:  [-7.45729405]


portfolio before change:  [6.23376985]
curr_Stock_Price:  100.26387084962762
curr_Factors:  [100.26387085]
mat_Sqrt:  [[0.15]]
grads:  [-0.00994752]
Stock Position:  -0.009947521678127317
Bond Position:  [7.23114688]


portfolio before change:  [6.23946997]
curr_Stock_Price:  99.78172350784664
curr_Factors:  [99.78172351]
mat_Sqrt:  [[0.15]]
grads:  [0.04086127]
Stock Position:  0.04086127408779924
Bond Position:  [2.16226162]


portfolio before change:  [6.19997144]
curr_Stock_Price:  98.80845892880492
curr_Factors:  [98.80845893]
mat_Sqrt:  [[0.15]]
grads:  [0.14476206]
Stock Position:  0.14476205703144046
Bond Position:  [-8.10374432]


portfolio before change:  [6.26028067]
curr_Stock_Price:  99.23206619191156
curr_Factors:  [99.23206619]
mat_Sqrt:  [[0.15]]
grads:  [0.13677866]
Stock Position:  0.13677866248505133
Bond Position:  [-7.31254862]


portfolio before change:  [6.26779043]
curr_Stock_Price:  99.29365393330428
curr_Factors:  [99.29365393]
mat_Sqrt:  [[0.15]]
grads:  [-0.02112071]
Stock Position:  -0.021120711766552468
Bond Position:  [8.36494308]


portfolio before change:  [6.29021055]
curr_Stock_Price:  98.28164096985115
curr_Factors:  [98.28164097]
mat_Sqrt:  [[0.15]]
grads:  [0.08566509]
Stock Position:  0.08566509184829582
Bond Position:  [-2.12909525]


portfolio before change:  [6.29364914]
curr_Stock_Price:  98.32488775204163
curr_Factors:  [98.32488775]
mat_Sqrt:  [[0.15]]
grads:  [-0.00230239]
Stock Position:  -0.002302388345391173
Bond Position:  [6.52003121]


portfolio before change:  [6.29281616]
curr_Stock_Price:  99.04067878640693
curr_Factors:  [99.04067879]
mat_Sqrt:  [[0.15]]
grads:  [0.06954815]
Stock Position:  0.06954814936097047
Bond Position:  [-0.59527976]


portfolio before change:  [6.22473018]
curr_Stock_Price:  98.06277260626939
curr_Factors:  [98.06277261]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965996]
Stock Position:  -0.009659958206434267
Bond Position:  [7.17201247]


portfolio before change:  [6.22192141]
curr_Stock_Price:  98.44634853289402
curr_Factors:  [98.44634853]
mat_Sqrt:  [[0.15]]
grads:  [0.03081955]
Stock Position:  0.030819552386679903
Bond Position:  [3.18784902]


portfolio before change:  [6.22040348]
curr_Stock_Price:  98.38416609744426
curr_Factors:  [98.3841661]
mat_Sqrt:  [[0.15]]
grads:  [0.07208193]
Stock Position:  0.07208193046814615
Bond Position:  [-0.87131714]


portfolio before change:  [6.23095185]
curr_Stock_Price:  98.53201567293118
curr_Factors:  [98.53201567]
mat_Sqrt:  [[0.15]]
grads:  [-0.01167156]
Stock Position:  -0.01167155681154585
Bond Position:  [7.38097386]


portfolio before change:  [6.24236115]
curr_Stock_Price:  97.63353885440358
curr_Factors:  [97.63353885]
mat_Sqrt:  [[0.15]]
grads:  [-0.0854634]
Stock Position:  -0.08546340359445564
Bond Position:  [14.58645568]


portfolio before change:  [6.27146903]
curr_Stock_Price:  97.3142857060305
curr_Factors:  [97.31428571]
mat_Sqrt:  [[0.15]]
grads:  [-0.04480193]
Stock Position:  -0.04480192677903771
Bond Position:  [10.63133653]


portfolio before change:  [6.25062843]
curr_Stock_Price:  97.80912155878049
curr_Factors:  [97.80912156]
mat_Sqrt:  [[0.15]]
grads:  [-0.00782889]
Stock Position:  -0.00782888591014802
Bond Position:  [7.01636488]


portfolio before change:  [6.25763437]
curr_Stock_Price:  97.02627268052896
curr_Factors:  [97.02627268]
mat_Sqrt:  [[0.15]]
grads:  [-0.05072281]
Stock Position:  -0.05072280915502307
Bond Position:  [11.17907948]


portfolio before change:  [6.28756187]
curr_Stock_Price:  96.4638032353163
curr_Factors:  [96.46380324]
mat_Sqrt:  [[0.15]]
grads:  [-0.01736666]
Stock Position:  -0.01736665877346779
Bond Position:  [7.96281582]


portfolio before change:  [6.26918094]
curr_Stock_Price:  97.57952401937489
curr_Factors:  [97.57952402]
mat_Sqrt:  [[0.15]]
grads:  [0.00298247]
Stock Position:  0.0029824698332690217
Bond Position:  [5.97815295]


portfolio before change:  [6.26887684]
curr_Stock_Price:  97.22699312148424
curr_Factors:  [97.22699312]
mat_Sqrt:  [[0.15]]
grads:  [0.07938642]
Stock Position:  0.07938642169589366
Bond Position:  [-1.44962623]


portfolio before change:  [6.29670687]
curr_Stock_Price:  97.57983989014501
curr_Factors:  [97.57983989]
mat_Sqrt:  [[0.15]]
grads:  [0.03173193]
Stock Position:  0.031731925068522
Bond Position:  [3.2003107]


portfolio before change:  [6.26890891]
curr_Stock_Price:  96.69120730237215
curr_Factors:  [96.6912073]
mat_Sqrt:  [[0.15]]
grads:  [0.03586833]
Stock Position:  0.0358683265776971
Bond Position:  [2.80075711]


portfolio before change:  [6.29265226]
curr_Stock_Price:  97.3434047115465
curr_Factors:  [97.34340471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00901243]
Stock Position:  -0.009012431293676862
Bond Position:  [7.16995301]


portfolio before change:  [6.28975469]
curr_Stock_Price:  97.76436367511188
curr_Factors:  [97.76436368]
mat_Sqrt:  [[0.15]]
grads:  [-0.03448548]
Stock Position:  -0.03448547542296411
Bond Position:  [9.66120526]


portfolio before change:  [6.31400495]
curr_Stock_Price:  97.09618299604227
curr_Factors:  [97.096183]
mat_Sqrt:  [[0.15]]
grads:  [-0.04204676]
Stock Position:  -0.04204676010192834
Bond Position:  [10.39658486]


portfolio before change:  [6.29377415]
curr_Stock_Price:  97.60824270958707
curr_Factors:  [97.60824271]
mat_Sqrt:  [[0.15]]
grads:  [-0.13456745]
Stock Position:  -0.13456745188361544
Bond Position:  [19.42866666]


portfolio before change:  [6.19633647]
curr_Stock_Price:  98.35037173990787
curr_Factors:  [98.35037174]
mat_Sqrt:  [[0.15]]
grads:  [-0.23999728]
Stock Position:  -0.23999728066173603
Bond Position:  [29.80015824]


portfolio before change:  [6.54311123]
curr_Stock_Price:  96.92098263488239
curr_Factors:  [96.92098263]
mat_Sqrt:  [[0.15]]
grads:  [0.14602732]
Stock Position:  0.14602732496805146
Bond Position:  [-7.6100006]


portfolio before change:  [6.3099395]
curr_Stock_Price:  95.3307294857583
curr_Factors:  [95.33072949]
mat_Sqrt:  [[0.15]]
grads:  [0.01760547]
Stock Position:  0.017605471353410534
Bond Position:  [4.63159708]


portfolio before change:  [6.32454852]
curr_Stock_Price:  96.12764253783861
curr_Factors:  [96.12764254]
mat_Sqrt:  [[0.15]]
grads:  [-0.04683004]
Stock Position:  -0.046830041550272865
Bond Position:  [10.82621001]


portfolio before change:  [6.34664711]
curr_Stock_Price:  95.68465271818306
curr_Factors:  [95.68465272]
mat_Sqrt:  [[0.15]]
grads:  [-0.0828524]
Stock Position:  -0.08285239758759062
Bond Position:  [14.27435]


portfolio before change:  [6.26056306]
curr_Stock_Price:  96.7451947653798
curr_Factors:  [96.74519477]
mat_Sqrt:  [[0.15]]
grads:  [-0.06740547]
Stock Position:  -0.06740546926738196
Bond Position:  [12.78171832]


portfolio before change:  [6.31343311]
curr_Stock_Price:  95.9845408498494
curr_Factors:  [95.98454085]
mat_Sqrt:  [[0.15]]
grads:  [-0.04311986]
Stock Position:  -0.04311986259076444
Bond Position:  [10.45227333]


portfolio before change:  [6.32482472]
curr_Stock_Price:  95.75065821527534
curr_Factors:  [95.75065822]
mat_Sqrt:  [[0.15]]
grads:  [-0.03275471]
Stock Position:  -0.032754706311421806
Bond Position:  [9.46110941]


portfolio before change:  [6.31356561]
curr_Stock_Price:  96.13050663748429
curr_Factors:  [96.13050664]
mat_Sqrt:  [[0.15]]
grads:  [0.13125091]
Stock Position:  0.13125091210487186
Bond Position:  [-6.30365107]


portfolio before change:  [6.44280165]
curr_Stock_Price:  97.12115917456002
curr_Factors:  [97.12115917]
mat_Sqrt:  [[0.15]]
grads:  [0.05913171]
Stock Position:  0.05913171329056296
Bond Position:  [0.69986111]


portfolio before change:  [6.40040796]
curr_Stock_Price:  96.40274306759176
curr_Factors:  [96.40274307]
mat_Sqrt:  [[0.15]]
grads:  [0.1413581]
Stock Position:  0.1413580956490126
Bond Position:  [-7.22690021]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.40040796]
Stock Price:  96.58002387355207
PL:  [6.40040796]
Settle:  Tensor("sub_286:0", shape=(), dtype=float64)
PL:  Tensor("sub_287:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  144
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45074613e-03]
 [-1.62726278e-02]
 [ 1.08877269e-02]
 [-1.93766567e-02]
 [ 1.38670295e-02]
 [ 2.18986535e-02]
 [ 2.72248798e-02]
 [-2.86074786e-03]
 [ 6.63525923e-03]
 [ 8.91161099e-03]
 [ 2.71860503e-02]
 [ 1.04725021e-02]
 [-1.06686889e-02]
 [ 1.20114785e-02]
 [-7.14286933e-03]
 [-2.51477810e-02]
 [ 4.43295620e-03]
 [ 1.59600958e-03]
 [-1.18540852e-02]
 [-2.23237430e-03]
 [ 4.08986802e-04]
 [ 9.59207700e-03]
 [ 4.77981917e-03]
 [ 7.14663480e-03]
 [-3.98673758e-03]
 [-8.43302096e-03]
 [ 1.00484908e-02]
 [-2.20671873e-02]
 [-3.77626309e-02]
 [ 2.15567939e-02]
 [ 9.20456783e-03]
 [ 2.96246943e-03]
 [-1.24489481e-02]
 [-5.68704657e-03]
 [-5.41691027e-03]
 [-6.69815967e-03]
 [ 2.30477102e-02]
 [ 1.04769730e-03]
 [ 2.17957285e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.89551415]
curr_Stock_Price:  100.25482581281881
curr_Factors:  [100.25482581]
mat_Sqrt:  [[0.15]]
grads:  [-0.00967164]
Stock Position:  -0.009671640876172312
Bond Position:  [6.86514282]


portfolio before change:  [5.89678821]
curr_Stock_Price:  100.211826774061
curr_Factors:  [100.21182677]
mat_Sqrt:  [[0.15]]
grads:  [-0.10848419]
Stock Position:  -0.10848418531166491
Bond Position:  [16.7681866]


portfolio before change:  [5.95321353]
curr_Stock_Price:  99.71102418695051
curr_Factors:  [99.71102419]
mat_Sqrt:  [[0.15]]
grads:  [0.07258485]
Stock Position:  0.07258484629564947
Bond Position:  [-1.28429584]


portfolio before change:  [5.87828384]
curr_Stock_Price:  98.6809311946996
curr_Factors:  [98.68093119]
mat_Sqrt:  [[0.15]]
grads:  [-0.12917771]
Stock Position:  -0.1291777114736722
Bond Position:  [18.6256607]


portfolio before change:  [5.83906066]
curr_Stock_Price:  99.00259295072011
curr_Factors:  [99.00259295]
mat_Sqrt:  [[0.15]]
grads:  [0.09244686]
Stock Position:  0.09244686328514501
Bond Position:  [-3.31341851]


portfolio before change:  [5.81305032]
curr_Stock_Price:  98.72571886823239
curr_Factors:  [98.72571887]
mat_Sqrt:  [[0.15]]
grads:  [0.14599102]
Stock Position:  0.1459910236085109
Bond Position:  [-8.60001843]


portfolio before change:  [6.01836786]
curr_Stock_Price:  100.13945383313127
curr_Factors:  [100.13945383]
mat_Sqrt:  [[0.15]]
grads:  [0.1814992]
Stock Position:  0.18149919898095287
Bond Position:  [-12.15686279]


portfolio before change:  [6.06446427]
curr_Stock_Price:  100.40180267517258
curr_Factors:  [100.40180268]
mat_Sqrt:  [[0.15]]
grads:  [-0.01907165]
Stock Position:  -0.019071652374880444
Bond Position:  [7.97929254]


portfolio before change:  [6.06743052]
curr_Stock_Price:  100.29857187981904
curr_Factors:  [100.29857188]
mat_Sqrt:  [[0.15]]
grads:  [0.04423506]
Stock Position:  0.04423506150196529
Bond Position:  [1.63071703]


portfolio before change:  [6.10272268]
curr_Stock_Price:  101.09179572224325
curr_Factors:  [101.09179572]
mat_Sqrt:  [[0.15]]
grads:  [0.05941074]
Stock Position:  0.059410739956747734
Bond Position:  [0.09678429]


portfolio before change:  [6.15999097]
curr_Stock_Price:  102.05553043882016
curr_Factors:  [102.05553044]
mat_Sqrt:  [[0.15]]
grads:  [0.18124034]
Stock Position:  0.1812403355644221
Bond Position:  [-12.33658761]


portfolio before change:  [6.00625514]
curr_Stock_Price:  101.2157965102914
curr_Factors:  [101.21579651]
mat_Sqrt:  [[0.15]]
grads:  [0.06981668]
Stock Position:  0.06981668081217055
Bond Position:  [-1.06029582]


portfolio before change:  [5.98739571]
curr_Stock_Price:  100.94756708610387
curr_Factors:  [100.94756709]
mat_Sqrt:  [[0.15]]
grads:  [-0.07112459]
Stock Position:  -0.0711245928557326
Bond Position:  [13.16725032]


portfolio before change:  [6.04403914]
curr_Stock_Price:  100.17431245966279
curr_Factors:  [100.17431246]
mat_Sqrt:  [[0.15]]
grads:  [0.08007652]
Stock Position:  0.08007652304722486
Bond Position:  [-1.9775715]


portfolio before change:  [6.10342738]
curr_Stock_Price:  100.91904324687962
curr_Factors:  [100.91904325]
mat_Sqrt:  [[0.15]]
grads:  [-0.04761913]
Stock Position:  -0.04761912888511168
Bond Position:  [10.90910431]


portfolio before change:  [6.10808277]
curr_Stock_Price:  100.84991834934094
curr_Factors:  [100.84991835]
mat_Sqrt:  [[0.15]]
grads:  [-0.16765187]
Stock Position:  -0.1676518735920726
Bond Position:  [23.01576053]


portfolio before change:  [6.04913293]
curr_Stock_Price:  101.2187003153079
curr_Factors:  [101.21870032]
mat_Sqrt:  [[0.15]]
grads:  [0.02955304]
Stock Position:  0.029553041354982743
Bond Position:  [3.0578125]


portfolio before change:  [6.05839701]
curr_Stock_Price:  101.5192387876414
curr_Factors:  [101.51923879]
mat_Sqrt:  [[0.15]]
grads:  [0.01064006]
Stock Position:  0.010640063849822206
Bond Position:  [4.97822583]


portfolio before change:  [6.04997826]
curr_Stock_Price:  100.66951960673575
curr_Factors:  [100.66951961]
mat_Sqrt:  [[0.15]]
grads:  [-0.07902723]
Stock Position:  -0.07902723466162073
Bond Position:  [14.00561201]


portfolio before change:  [6.0224468]
curr_Stock_Price:  101.04005348792585
curr_Factors:  [101.04005349]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148825]
Stock Position:  -0.014882495346669192
Bond Position:  [7.52617493]


portfolio before change:  [6.03283096]
curr_Stock_Price:  100.40552782376128
curr_Factors:  [100.40552782]
mat_Sqrt:  [[0.15]]
grads:  [0.00272658]
Stock Position:  0.002726578679494118
Bond Position:  [5.75906739]


portfolio before change:  [6.03344732]
curr_Stock_Price:  100.3675425242297
curr_Factors:  [100.36754252]
mat_Sqrt:  [[0.15]]
grads:  [0.06394718]
Stock Position:  0.06394717998846627
Bond Position:  [-0.38477399]


portfolio before change:  [6.07218702]
curr_Stock_Price:  100.97410250934756
curr_Factors:  [100.97410251]
mat_Sqrt:  [[0.15]]
grads:  [0.03186546]
Stock Position:  0.03186546115521397
Bond Position:  [2.85460068]


portfolio before change:  [6.07367704]
curr_Stock_Price:  101.00966374473079
curr_Factors:  [101.00966374]
mat_Sqrt:  [[0.15]]
grads:  [0.04764423]
Stock Position:  0.047644231988947294
Bond Position:  [1.26114919]


portfolio before change:  [6.0549441]
curr_Stock_Price:  100.61317095914472
curr_Factors:  [100.61317096]
mat_Sqrt:  [[0.15]]
grads:  [-0.02657825]
Stock Position:  -0.026578250517606337
Bond Position:  [8.72906616]


portfolio before change:  [6.07077186]
curr_Stock_Price:  100.05871163667491
curr_Factors:  [100.05871164]
mat_Sqrt:  [[0.15]]
grads:  [-0.05622014]
Stock Position:  -0.05622013973042225
Bond Position:  [11.69608661]


portfolio before change:  [6.03866255]
curr_Stock_Price:  100.65585372091232
curr_Factors:  [100.65585372]
mat_Sqrt:  [[0.15]]
grads:  [0.06698994]
Stock Position:  0.06698993869998116
Bond Position:  [-0.70426692]


portfolio before change:  [6.00455151]
curr_Stock_Price:  100.14797146832443
curr_Factors:  [100.14797147]
mat_Sqrt:  [[0.15]]
grads:  [-0.14711458]
Stock Position:  -0.14711458222307305
Bond Position:  [20.73777849]


portfolio before change:  [6.2010394]
curr_Stock_Price:  98.82998176959529
curr_Factors:  [98.82998177]
mat_Sqrt:  [[0.15]]
grads:  [-0.25175087]
Stock Position:  -0.25175087295368886
Bond Position:  [31.08157358]


portfolio before change:  [5.99458624]
curr_Stock_Price:  99.66548474114161
curr_Factors:  [99.66548474]
mat_Sqrt:  [[0.15]]
grads:  [0.14371196]
Stock Position:  0.14371195905878853
Bond Position:  [-8.32853583]


portfolio before change:  [5.95639463]
curr_Stock_Price:  99.40697824306287
curr_Factors:  [99.40697824]
mat_Sqrt:  [[0.15]]
grads:  [0.06136379]
Stock Position:  0.06136378551686077
Bond Position:  [-0.14359386]


portfolio before change:  [6.01920567]
curr_Stock_Price:  100.4308556723343
curr_Factors:  [100.43085567]
mat_Sqrt:  [[0.15]]
grads:  [0.0197498]
Stock Position:  0.019749796224603246
Bond Position:  [4.03571674]


portfolio before change:  [6.02990743]
curr_Stock_Price:  100.94717792299119
curr_Factors:  [100.94717792]
mat_Sqrt:  [[0.15]]
grads:  [-0.08299299]
Stock Position:  -0.08299298739067001
Bond Position:  [14.40781529]


portfolio before change:  [6.03079573]
curr_Stock_Price:  100.95817634280202
curr_Factors:  [100.95817634]
mat_Sqrt:  [[0.15]]
grads:  [-0.03791364]
Stock Position:  -0.03791364378269205
Bond Position:  [9.85848806]


portfolio before change:  [6.01571467]
curr_Stock_Price:  101.38845526246592
curr_Factors:  [101.38845526]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611274]
Stock Position:  -0.036112735114284686
Bond Position:  [9.6771291]


portfolio before change:  [6.02965894]
curr_Stock_Price:  101.03582205254081
curr_Factors:  [101.03582205]
mat_Sqrt:  [[0.15]]
grads:  [-0.0446544]
Stock Position:  -0.04465439781430779
Bond Position:  [10.54135273]


portfolio before change:  [6.00773313]
curr_Stock_Price:  101.55634320020533
curr_Factors:  [101.5563432]
mat_Sqrt:  [[0.15]]
grads:  [0.1536514]
Stock Position:  0.1536514014910959
Bond Position:  [-9.59654133]


portfolio before change:  [6.1054101]
curr_Stock_Price:  102.19985579382907
curr_Factors:  [102.19985579]
mat_Sqrt:  [[0.15]]
grads:  [0.00698465]
Stock Position:  0.006984648672130503
Bond Position:  [5.39158001]


portfolio before change:  [6.10937152]
curr_Stock_Price:  102.67052085487515
curr_Factors:  [102.67052085]
mat_Sqrt:  [[0.15]]
grads:  [0.14530486]
Stock Position:  0.14530485670600654
Bond Position:  [-8.8091538]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.10937152]
Stock Price:  103.47121131639064
PL:  [2.6381602]
Settle:  Tensor("sub_288:0", shape=(), dtype=float64)
PL:  Tensor("sub_289:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  145
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.58011038e-03]
 [ 5.40114167e-03]
 [-2.80224934e-02]
 [-2.79897070e-02]
 [ 6.92135723e-04]
 [ 2.40932358e-02]
 [ 1.30548685e-03]
 [-1.27114379e-02]
 [-3.17353400e-03]
 [ 3.88127517e-03]
 [-6.61188312e-02]
 [-1.23047540e-02]
 [ 1.30131053e-02]
 [ 1.56056533e-03]
 [ 1.54235065e-02]
 [-3.78080246e-03]
 [-1.10871926e-02]
 [ 3.71257246e-04]
 [-7.58135898e-03]
 [-2.37091675e-03]
 [ 3.24154646e-04]
 [ 8.68137183e-03]
 [ 4.76702536e-03]
 [ 5.63193760e-03]
 [-3.60178746e-03]
 [-7.13547820e-03]
 [-4.50301874e-03]
 [-2.16611936e-02]
 [-3.32298593e-02]
 [ 2.17329288e-02]
 [ 7.69377962e-03]
 [-8.62754777e-05]
 [-1.25316704e-02]
 [-8.33801743e-03]
 [-7.63746384e-03]
 [-7.52444745e-03]
 [ 2.07498957e-02]
 [ 8.59562353e-03]
 [ 2.25939202e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.48300135]
curr_Stock_Price:  99.52179828480848
curr_Factors:  [99.52179828]
mat_Sqrt:  [[0.15]]
grads:  [-0.0238674]
Stock Position:  -0.023867402542064993
Bond Position:  [-3.10767452]


portfolio before change:  [-5.48226598]
curr_Stock_Price:  99.4747111662143
curr_Factors:  [99.47471117]
mat_Sqrt:  [[0.15]]
grads:  [0.03600761]
Stock Position:  0.03600761113262949
Bond Position:  [-9.0641127]


portfolio before change:  [-5.52146015]
curr_Stock_Price:  98.41768245298705
curr_Factors:  [98.41768245]
mat_Sqrt:  [[0.15]]
grads:  [-0.18681662]
Stock Position:  -0.186816622824872
Bond Position:  [12.86459892]


portfolio before change:  [-5.4224214]
curr_Stock_Price:  97.89615190751663
curr_Factors:  [97.89615191]
mat_Sqrt:  [[0.15]]
grads:  [-0.18659805]
Stock Position:  -0.18659804681555586
Bond Position:  [12.84480934]


portfolio before change:  [-5.31668698]
curr_Stock_Price:  97.33811437112242
curr_Factors:  [97.33811437]
mat_Sqrt:  [[0.15]]
grads:  [0.00461424]
Stock Position:  0.00461423815237017
Bond Position:  [-5.76582822]


portfolio before change:  [-5.31555004]
curr_Stock_Price:  97.7407185390439
curr_Factors:  [97.74071854]
mat_Sqrt:  [[0.15]]
grads:  [0.16062157]
Stock Position:  0.16062157227622026
Bond Position:  [-21.01481793]


portfolio before change:  [-5.4906304]
curr_Stock_Price:  96.66705615833406
curr_Factors:  [96.66705616]
mat_Sqrt:  [[0.15]]
grads:  [0.00870325]
Stock Position:  0.008703245639798303
Bond Position:  [-6.33194753]


portfolio before change:  [-5.49928123]
curr_Stock_Price:  95.76402647499152
curr_Factors:  [95.76402647]
mat_Sqrt:  [[0.15]]
grads:  [-0.08474292]
Stock Position:  -0.08474291901139026
Bond Position:  [2.61604191]


portfolio before change:  [-5.54313953]
curr_Stock_Price:  96.28543080023499
curr_Factors:  [96.2854308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02115689]
Stock Position:  -0.021156893347481772
Bond Position:  [-3.50603894]


portfolio before change:  [-5.5313905]
curr_Stock_Price:  95.70938648004984
curr_Factors:  [95.70938648]
mat_Sqrt:  [[0.15]]
grads:  [0.02587517]
Stock Position:  0.02587516783150973
Bond Position:  [-8.00788694]


portfolio before change:  [-5.51483502]
curr_Stock_Price:  96.38789553377747
curr_Factors:  [96.38789553]
mat_Sqrt:  [[0.15]]
grads:  [-0.44079221]
Stock Position:  -0.44079220813363823
Bond Position:  [36.97219829]


portfolio before change:  [-5.57914517]
curr_Stock_Price:  96.54427752783144
curr_Factors:  [96.54427753]
mat_Sqrt:  [[0.15]]
grads:  [-0.08203169]
Stock Position:  -0.08203169307191192
Bond Position:  [2.34054538]


portfolio before change:  [-5.5152346]
curr_Stock_Price:  95.76874829909987
curr_Factors:  [95.7687483]
mat_Sqrt:  [[0.15]]
grads:  [0.08675404]
Stock Position:  0.08675403508364803
Bond Position:  [-13.82355995]


portfolio before change:  [-5.52586028]
curr_Stock_Price:  95.66618682475719
curr_Factors:  [95.66618682]
mat_Sqrt:  [[0.15]]
grads:  [0.01040377]
Stock Position:  0.010403768834314459
Bond Position:  [-6.52114917]


portfolio before change:  [-5.52726438]
curr_Stock_Price:  95.60958211663572
curr_Factors:  [95.60958212]
mat_Sqrt:  [[0.15]]
grads:  [0.10282338]
Stock Position:  0.10282337650131448
Bond Position:  [-15.35816443]


portfolio before change:  [-5.64591961]
curr_Stock_Price:  94.47428241582163
curr_Factors:  [94.47428242]
mat_Sqrt:  [[0.15]]
grads:  [-0.02520535]
Stock Position:  -0.025205349721983152
Bond Position:  [-3.26466229]


portfolio before change:  [-5.66521622]
curr_Stock_Price:  95.22366669967346
curr_Factors:  [95.2236667]
mat_Sqrt:  [[0.15]]
grads:  [-0.07391462]
Stock Position:  -0.07391461711229448
Bond Position:  [1.37320465]


portfolio before change:  [-5.66643103]
curr_Stock_Price:  95.24242448375283
curr_Factors:  [95.24242448]
mat_Sqrt:  [[0.15]]
grads:  [0.00247505]
Stock Position:  0.0024750483034943686
Bond Position:  [-5.90216063]


portfolio before change:  [-5.66168427]
curr_Stock_Price:  97.45837137761913
curr_Factors:  [97.45837138]
mat_Sqrt:  [[0.15]]
grads:  [-0.05054239]
Stock Position:  -0.05054239318215273
Bond Position:  [-0.73590494]


portfolio before change:  [-5.69944303]
curr_Stock_Price:  98.20362223154697
curr_Factors:  [98.20362223]
mat_Sqrt:  [[0.15]]
grads:  [-0.01580611]
Stock Position:  -0.015806111669516
Bond Position:  [-4.14722561]


portfolio before change:  [-5.70235735]
curr_Stock_Price:  98.35520232410748
curr_Factors:  [98.35520232]
mat_Sqrt:  [[0.15]]
grads:  [0.00216103]
Stock Position:  0.002161030972869702
Bond Position:  [-5.91490599]


portfolio before change:  [-5.70290964]
curr_Stock_Price:  98.44179341992275
curr_Factors:  [98.44179342]
mat_Sqrt:  [[0.15]]
grads:  [0.05787581]
Stock Position:  0.05787581219874549
Bond Position:  [-11.40030838]


portfolio before change:  [-5.69724876]
curr_Stock_Price:  98.56422808979119
curr_Factors:  [98.56422809]
mat_Sqrt:  [[0.15]]
grads:  [0.03178017]
Stock Position:  0.0317801690819151
Bond Position:  [-8.82963659]


portfolio before change:  [-5.72207753]
curr_Stock_Price:  97.81769341049883
curr_Factors:  [97.81769341]
mat_Sqrt:  [[0.15]]
grads:  [0.03754625]
Stock Position:  0.03754625069591486
Bond Position:  [-9.39476517]


portfolio before change:  [-5.69588877]
curr_Stock_Price:  98.54647936999605
curr_Factors:  [98.54647937]
mat_Sqrt:  [[0.15]]
grads:  [-0.02401192]
Stock Position:  -0.02401191640401011
Bond Position:  [-3.32959894]


portfolio before change:  [-5.70747446]
curr_Stock_Price:  99.01164283160418
curr_Factors:  [99.01164283]
mat_Sqrt:  [[0.15]]
grads:  [-0.04756985]
Stock Position:  -0.04756985464421114
Bond Position:  [-0.997505]


portfolio before change:  [-5.66563457]
curr_Stock_Price:  98.12947520648447
curr_Factors:  [98.12947521]
mat_Sqrt:  [[0.15]]
grads:  [-0.03002012]
Stock Position:  -0.030020124923431087
Bond Position:  [-2.71977547]


portfolio before change:  [-5.66883817]
curr_Stock_Price:  98.22486476687756
curr_Factors:  [98.22486477]
mat_Sqrt:  [[0.15]]
grads:  [-0.14440796]
Stock Position:  -0.14440795727539085
Bond Position:  [8.5156139]


portfolio before change:  [-5.84441395]
curr_Stock_Price:  99.44806813253268
curr_Factors:  [99.44806813]
mat_Sqrt:  [[0.15]]
grads:  [-0.2215324]
Stock Position:  -0.22153239516793272
Bond Position:  [16.18655478]


portfolio before change:  [-5.76020016]
curr_Stock_Price:  99.077059884616
curr_Factors:  [99.07705988]
mat_Sqrt:  [[0.15]]
grads:  [0.14488619]
Stock Position:  0.14488619218801435
Bond Position:  [-20.1150981]


portfolio before change:  [-5.76937676]
curr_Stock_Price:  99.03107855515293
curr_Factors:  [99.03107856]
mat_Sqrt:  [[0.15]]
grads:  [0.05129186]
Stock Position:  0.05129186414236205
Bond Position:  [-10.84886539]


portfolio before change:  [-5.75561709]
curr_Stock_Price:  99.32578155201244
curr_Factors:  [99.32578155]
mat_Sqrt:  [[0.15]]
grads:  [-0.00057517]
Stock Position:  -0.0005751698514692375
Bond Position:  [-5.6984879]


portfolio before change:  [-5.75630371]
curr_Stock_Price:  99.28103911491385
curr_Factors:  [99.28103911]
mat_Sqrt:  [[0.15]]
grads:  [-0.08354447]
Stock Position:  -0.08354446926737866
Bond Position:  [2.53807801]


portfolio before change:  [-5.66788177]
curr_Stock_Price:  98.22645510125562
curr_Factors:  [98.2264551]
mat_Sqrt:  [[0.15]]
grads:  [-0.05558678]
Stock Position:  -0.05558678288265173
Bond Position:  [-0.20778914]


portfolio before change:  [-5.63505594]
curr_Stock_Price:  97.63545483176011
curr_Factors:  [97.63545483]
mat_Sqrt:  [[0.15]]
grads:  [-0.05091643]
Stock Position:  -0.050916425618416805
Bond Position:  [-0.66380757]


portfolio before change:  [-5.66925636]
curr_Stock_Price:  98.30552219829626
curr_Factors:  [98.3055222]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016298]
Stock Position:  -0.050162983011005836
Bond Position:  [-0.73795812]


portfolio before change:  [-5.62069789]
curr_Stock_Price:  97.33566931042753
curr_Factors:  [97.33566931]
mat_Sqrt:  [[0.15]]
grads:  [0.13833264]
Stock Position:  0.13833263821602174
Bond Position:  [-19.08539782]


portfolio before change:  [-5.57493442]
curr_Stock_Price:  97.68373828451752
curr_Factors:  [97.68373828]
mat_Sqrt:  [[0.15]]
grads:  [0.05730416]
Stock Position:  0.05730415689921102
Bond Position:  [-11.17261868]


portfolio before change:  [-5.57179002]
curr_Stock_Price:  97.76298328961768
curr_Factors:  [97.76298329]
mat_Sqrt:  [[0.15]]
grads:  [0.15062613]
Stock Position:  0.15062613470452882
Bond Position:  [-20.29745031]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.57179002]
Stock Price:  95.65622523562608
PL:  [-5.57179002]
Settle:  Tensor("sub_290:0", shape=(), dtype=float64)
PL:  Tensor("sub_291:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  146
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.64009387e-03]
 [-9.09005862e-03]
 [-2.70158563e-02]
 [-2.70677283e-02]
 [ 1.50668382e-02]
 [ 2.07126223e-02]
 [ 1.27589214e-02]
 [-8.08701845e-03]
 [ 6.15099050e-03]
 [ 5.32948478e-04]
 [-3.95593707e-02]
 [-2.66355649e-03]
 [ 7.45920301e-03]
 [ 8.97125612e-03]
 [ 3.16823607e-03]
 [-1.16993895e-02]
 [-9.73897869e-03]
 [ 4.51024551e-04]
 [-7.74712635e-03]
 [-2.75757174e-03]
 [ 8.03971401e-04]
 [ 1.31441763e-02]
 [ 4.75577763e-03]
 [ 5.57452097e-03]
 [ 5.99624719e-03]
 [-1.33839066e-03]
 [ 1.18648843e-02]
 [-1.85573561e-02]
 [-2.40227619e-02]
 [ 2.13958811e-02]
 [ 2.55913683e-03]
 [-1.45328626e-02]
 [-1.20820535e-02]
 [ 1.52980549e-03]
 [-7.28987410e-03]
 [ 1.69038450e-03]
 [ 1.66139819e-02]
 [ 1.80002047e-02]
 [ 1.20494989e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.41428265]
curr_Stock_Price:  98.81758250926048
curr_Factors:  [98.81758251]
mat_Sqrt:  [[0.15]]
grads:  [-0.03760063]
Stock Position:  -0.03760062580791211
Bond Position:  [-12.6986797]


portfolio before change:  [-16.38884709]
curr_Stock_Price:  98.09889780094585
curr_Factors:  [98.0988978]
mat_Sqrt:  [[0.15]]
grads:  [-0.06060039]
Stock Position:  -0.06060039078307386
Bond Position:  [-10.44401554]


portfolio before change:  [-16.41237954]
curr_Stock_Price:  98.46567550363845
curr_Factors:  [98.4656755]
mat_Sqrt:  [[0.15]]
grads:  [-0.18010571]
Stock Position:  -0.18010570897083017
Bond Position:  [1.32185075]


portfolio before change:  [-16.35775864]
curr_Stock_Price:  98.16332161761927
curr_Factors:  [98.16332162]
mat_Sqrt:  [[0.15]]
grads:  [-0.18045152]
Stock Position:  -0.18045152216252658
Bond Position:  [1.35596217]


portfolio before change:  [-16.40197051]
curr_Stock_Price:  98.40926784882146
curr_Factors:  [98.40926785]
mat_Sqrt:  [[0.15]]
grads:  [0.10044559]
Stock Position:  0.10044558776161386
Bond Position:  [-26.28674726]


portfolio before change:  [-16.34957931]
curr_Stock_Price:  98.96357040967395
curr_Factors:  [98.96357041]
mat_Sqrt:  [[0.15]]
grads:  [0.13808415]
Stock Position:  0.13808414838092278
Bond Position:  [-30.01487965]


portfolio before change:  [-16.41424511]
curr_Stock_Price:  98.52243569727919
curr_Factors:  [98.5224357]
mat_Sqrt:  [[0.15]]
grads:  [0.08505948]
Stock Position:  0.08505947609739493
Bond Position:  [-24.79451188]


portfolio before change:  [-16.52091797]
curr_Stock_Price:  97.30477768115213
curr_Factors:  [97.30477768]
mat_Sqrt:  [[0.15]]
grads:  [-0.05391346]
Stock Position:  -0.053913456313529784
Bond Position:  [-11.27488109]


portfolio before change:  [-16.52120307]
curr_Stock_Price:  97.28392293683878
curr_Factors:  [97.28392294]
mat_Sqrt:  [[0.15]]
grads:  [0.0410066]
Stock Position:  0.041006603323879384
Bond Position:  [-20.51048631]


portfolio before change:  [-16.5309772]
curr_Stock_Price:  97.1080937112884
curr_Factors:  [97.10809371]
mat_Sqrt:  [[0.15]]
grads:  [0.00355299]
Stock Position:  0.0035529898506738633
Bond Position:  [-16.87600127]


portfolio before change:  [-16.53324415]
curr_Stock_Price:  97.06381738689105
curr_Factors:  [97.06381739]
mat_Sqrt:  [[0.15]]
grads:  [-0.26372914]
Stock Position:  -0.26372913800769265
Bond Position:  [9.06531274]


portfolio before change:  [-16.74992365]
curr_Stock_Price:  97.88971301460124
curr_Factors:  [97.88971301]
mat_Sqrt:  [[0.15]]
grads:  [-0.01775704]
Stock Position:  -0.01775704323593278
Bond Position:  [-15.01169179]


portfolio before change:  [-16.74989553]
curr_Stock_Price:  97.78244823333615
curr_Factors:  [97.78244823]
mat_Sqrt:  [[0.15]]
grads:  [0.04972802]
Stock Position:  0.04972802004850452
Bond Position:  [-21.61242307]


portfolio before change:  [-16.75458219]
curr_Stock_Price:  97.74253230141035
curr_Factors:  [97.7425323]
mat_Sqrt:  [[0.15]]
grads:  [0.05980837]
Stock Position:  0.059808374163852686
Bond Position:  [-22.60040413]


portfolio before change:  [-16.75744732]
curr_Stock_Price:  97.74186509942768
curr_Factors:  [97.7418651]
mat_Sqrt:  [[0.15]]
grads:  [0.02112157]
Stock Position:  0.02112157378289002
Bond Position:  [-18.82190934]


portfolio before change:  [-16.77467785]
curr_Stock_Price:  97.03748385986364
curr_Factors:  [97.03748386]
mat_Sqrt:  [[0.15]]
grads:  [-0.07799593]
Stock Position:  -0.0779959299359014
Bond Position:  [-9.20614905]


portfolio before change:  [-16.69735325]
curr_Stock_Price:  96.03133604724857
curr_Factors:  [96.03133605]
mat_Sqrt:  [[0.15]]
grads:  [-0.06492652]
Stock Position:  -0.06492652462654884
Bond Position:  [-10.46237235]


portfolio before change:  [-16.62632522]
curr_Stock_Price:  94.91721651986781
curr_Factors:  [94.91721652]
mat_Sqrt:  [[0.15]]
grads:  [0.00300683]
Stock Position:  0.003006830341466147
Bond Position:  [-16.91172519]


portfolio before change:  [-16.62932984]
curr_Stock_Price:  94.62105229904454
curr_Factors:  [94.6210523]
mat_Sqrt:  [[0.15]]
grads:  [-0.05164751]
Stock Position:  -0.05164750897142784
Bond Position:  [-11.74238819]


portfolio before change:  [-16.67816798]
curr_Stock_Price:  95.53823604276452
curr_Factors:  [95.53823604]
mat_Sqrt:  [[0.15]]
grads:  [-0.01838381]
Stock Position:  -0.01838381163104422
Bond Position:  [-14.92181105]


portfolio before change:  [-16.68662575]
curr_Stock_Price:  95.89683551557373
curr_Factors:  [95.89683552]
mat_Sqrt:  [[0.15]]
grads:  [0.00535981]
Stock Position:  0.005359809336780919
Bond Position:  [-17.2006145]


portfolio before change:  [-16.69215856]
curr_Stock_Price:  95.2657314867125
curr_Factors:  [95.26573149]
mat_Sqrt:  [[0.15]]
grads:  [0.08762784]
Stock Position:  0.08762784216887788
Bond Position:  [-25.04008904]


portfolio before change:  [-16.69492424]
curr_Stock_Price:  95.26989140315017
curr_Factors:  [95.2698914]
mat_Sqrt:  [[0.15]]
grads:  [0.03170518]
Stock Position:  0.03170518416755925
Bond Position:  [-19.71547369]


portfolio before change:  [-16.73339021]
curr_Stock_Price:  94.13438684609437
curr_Factors:  [94.13438685]
mat_Sqrt:  [[0.15]]
grads:  [0.03716347]
Stock Position:  0.037163473143694836
Bond Position:  [-20.23175097]


portfolio before change:  [-16.75344017]
curr_Stock_Price:  93.66293379999276
curr_Factors:  [93.6629338]
mat_Sqrt:  [[0.15]]
grads:  [0.03997498]
Stock Position:  0.03997498129330079
Bond Position:  [-20.4976142]


portfolio before change:  [-16.72202853]
curr_Stock_Price:  94.51281544381774
curr_Factors:  [94.51281544]
mat_Sqrt:  [[0.15]]
grads:  [-0.0089226]
Stock Position:  -0.008922604401959279
Bond Position:  [-15.87872807]


portfolio before change:  [-16.71800523]
curr_Stock_Price:  93.83944014078509
curr_Factors:  [93.83944014]
mat_Sqrt:  [[0.15]]
grads:  [0.07909923]
Stock Position:  0.07909922837986477
Bond Position:  [-24.14063254]


portfolio before change:  [-16.62687011]
curr_Stock_Price:  95.02975376064627
curr_Factors:  [95.02975376]
mat_Sqrt:  [[0.15]]
grads:  [-0.12371571]
Stock Position:  -0.12371570702397759
Bond Position:  [-4.87019694]


portfolio before change:  [-16.58597653]
curr_Stock_Price:  94.69428788443442
curr_Factors:  [94.69428788]
mat_Sqrt:  [[0.15]]
grads:  [-0.16015175]
Stock Position:  -0.16015174627904283
Bond Position:  [-1.42052096]


portfolio before change:  [-16.48389101]
curr_Stock_Price:  94.05574913966295
curr_Factors:  [94.05574914]
mat_Sqrt:  [[0.15]]
grads:  [0.14263921]
Stock Position:  0.1426392072508715
Bond Position:  [-29.8999285]


portfolio before change:  [-16.68095414]
curr_Stock_Price:  92.70040364961847
curr_Factors:  [92.70040365]
mat_Sqrt:  [[0.15]]
grads:  [0.01706091]
Stock Position:  0.017060912209288046
Bond Position:  [-18.26250759]


portfolio before change:  [-16.68458706]
curr_Stock_Price:  92.62127743506035
curr_Factors:  [92.62127744]
mat_Sqrt:  [[0.15]]
grads:  [-0.09688575]
Stock Position:  -0.09688575074004369
Bond Position:  [-7.71090506]


portfolio before change:  [-16.58172742]
curr_Stock_Price:  91.54966929370482
curr_Factors:  [91.54966929]
mat_Sqrt:  [[0.15]]
grads:  [-0.08054702]
Stock Position:  -0.08054702349461683
Bond Position:  [-9.20767406]


portfolio before change:  [-16.4734414]
curr_Stock_Price:  90.19099639000855
curr_Factors:  [90.19099639]
mat_Sqrt:  [[0.15]]
grads:  [0.0101987]
Stock Position:  0.010198703268055945
Bond Position:  [-17.39327261]


portfolio before change:  [-16.48256559]
curr_Stock_Price:  89.50954683197746
curr_Factors:  [89.50954683]
mat_Sqrt:  [[0.15]]
grads:  [-0.04859916]
Stock Position:  -0.04859916064105879
Bond Position:  [-12.13247675]


portfolio before change:  [-16.51381123]
curr_Stock_Price:  90.12126484847035
curr_Factors:  [90.12126485]
mat_Sqrt:  [[0.15]]
grads:  [0.01126923]
Stock Position:  0.011269230031857013
Bond Position:  [-17.52940849]


portfolio before change:  [-16.52016661]
curr_Stock_Price:  89.75175676123277
curr_Factors:  [89.75175676]
mat_Sqrt:  [[0.15]]
grads:  [0.11075988]
Stock Position:  0.11075987912372294
Bond Position:  [-26.46106034]


portfolio before change:  [-16.58548907]
curr_Stock_Price:  89.19185527856685
curr_Factors:  [89.19185528]
mat_Sqrt:  [[0.15]]
grads:  [0.12000136]
Stock Position:  0.12000136469780487
Bond Position:  [-27.28863343]


portfolio before change:  [-16.54232043]
curr_Stock_Price:  89.58001700651282
curr_Factors:  [89.58001701]
mat_Sqrt:  [[0.15]]
grads:  [0.08032999]
Stock Position:  0.08032999234254835
Bond Position:  [-23.73828251]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.54232043]
Stock Price:  88.66631438574011
PL:  [-16.54232043]
Settle:  Tensor("sub_292:0", shape=(), dtype=float64)
PL:  Tensor("sub_293:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  147
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.14260419e-03]
 [ 1.91970383e-03]
 [-3.14691334e-02]
 [-2.66063674e-02]
 [ 7.29705998e-05]
 [ 2.42702953e-02]
 [ 9.28723936e-03]
 [-3.79930877e-03]
 [ 1.60642275e-02]
 [-1.26651254e-03]
 [ 4.39629037e-03]
 [ 3.13123783e-03]
 [ 5.28570373e-03]
 [ 1.06466919e-02]
 [-3.32138516e-03]
 [-9.27320212e-03]
 [-2.08729592e-04]
 [-2.95938273e-03]
 [-1.05937504e-02]
 [-2.40248920e-03]
 [ 3.40822889e-04]
 [ 1.14113362e-02]
 [ 4.75708140e-03]
 [ 5.40967036e-03]
 [ 2.76688324e-03]
 [-1.93482079e-03]
 [ 7.04099910e-03]
 [-1.79854392e-02]
 [-2.67196222e-02]
 [ 2.16083349e-02]
 [ 2.62147929e-03]
 [-8.52145042e-03]
 [-1.24079880e-02]
 [-6.57557477e-03]
 [-6.36098097e-03]
 [-1.72790145e-03]
 [ 1.84609417e-02]
 [ 1.21175956e-02]
 [ 1.63598500e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-0.98162448]
curr_Stock_Price:  99.81178630262242
curr_Factors:  [99.8117863]
mat_Sqrt:  [[0.15]]
grads:  [-0.01428403]
Stock Position:  -0.014284027933570333
Bond Position:  [0.44408986]


portfolio before change:  [-0.97333734]
curr_Stock_Price:  99.23550424872714
curr_Factors:  [99.23550425]
mat_Sqrt:  [[0.15]]
grads:  [0.01279803]
Stock Position:  0.012798025520170305
Bond Position:  [-2.24335586]


portfolio before change:  [-0.98647881]
curr_Stock_Price:  98.23058112293728
curr_Factors:  [98.23058112]
mat_Sqrt:  [[0.15]]
grads:  [-0.20979422]
Stock Position:  -0.20979422253152238
Bond Position:  [19.62172959]


portfolio before change:  [-0.9979632]
curr_Stock_Price:  98.29701413464066
curr_Factors:  [98.29701413]
mat_Sqrt:  [[0.15]]
grads:  [-0.17737578]
Stock Position:  -0.1773757829573536
Bond Position:  [16.43754664]


portfolio before change:  [-0.8188132]
curr_Stock_Price:  97.29859607776135
curr_Factors:  [97.29859608]
mat_Sqrt:  [[0.15]]
grads:  [0.00048647]
Stock Position:  0.00048647066514693105
Bond Position:  [-0.86614611]


portfolio before change:  [-0.81884846]
curr_Stock_Price:  97.44867686221622
curr_Factors:  [97.44867686]
mat_Sqrt:  [[0.15]]
grads:  [0.16180197]
Stock Position:  0.16180196833637403
Bond Position:  [-16.58623619]


portfolio before change:  [-0.68797468]
curr_Stock_Price:  98.27034292245544
curr_Factors:  [98.27034292]
mat_Sqrt:  [[0.15]]
grads:  [0.06191493]
Stock Position:  0.06191492909528168
Bond Position:  [-6.772376]


portfolio before change:  [-0.67773834]
curr_Stock_Price:  98.44934571223428
curr_Factors:  [98.44934571]
mat_Sqrt:  [[0.15]]
grads:  [-0.02532873]
Stock Position:  -0.02532872513888779
Bond Position:  [1.81585808]


portfolio before change:  [-0.7067536]
curr_Stock_Price:  99.6038551420074
curr_Factors:  [99.60385514]
mat_Sqrt:  [[0.15]]
grads:  [0.10709485]
Stock Position:  0.10709484969635967
Bond Position:  [-11.37381349]


portfolio before change:  [-0.80753698]
curr_Stock_Price:  98.6760647364214
curr_Factors:  [98.67606474]
mat_Sqrt:  [[0.15]]
grads:  [-0.00844342]
Stock Position:  -0.008443416929489496
Bond Position:  [0.02562617]


portfolio before change:  [-0.81498499]
curr_Stock_Price:  99.55855203596921
curr_Factors:  [99.55855204]
mat_Sqrt:  [[0.15]]
grads:  [0.0293086]
Stock Position:  0.029308602448435278
Bond Position:  [-3.73290701]


portfolio before change:  [-0.83824287]
curr_Stock_Price:  98.78092227724369
curr_Factors:  [98.78092228]
mat_Sqrt:  [[0.15]]
grads:  [0.02087492]
Stock Position:  0.02087491889891485
Bond Position:  [-2.90028661]


portfolio before change:  [-0.84676837]
curr_Stock_Price:  98.38988201824422
curr_Factors:  [98.38988202]
mat_Sqrt:  [[0.15]]
grads:  [0.03523802]
Stock Position:  0.035238024852220114
Bond Position:  [-4.31383347]


portfolio before change:  [-0.8377002]
curr_Stock_Price:  98.66252576341739
curr_Factors:  [98.66252576]
mat_Sqrt:  [[0.15]]
grads:  [0.07097795]
Stock Position:  0.07097794626432712
Bond Position:  [-7.84056365]


portfolio before change:  [-0.83068661]
curr_Stock_Price:  98.77514833588725
curr_Factors:  [98.77514834]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214257]
Stock Position:  -0.02214256774489751
Bond Position:  [1.3564488]


portfolio before change:  [-0.83297232]
curr_Stock_Price:  98.88603309667826
curr_Factors:  [98.8860331]
mat_Sqrt:  [[0.15]]
grads:  [-0.06182135]
Stock Position:  -0.061821347487074976
Bond Position:  [5.28029549]


portfolio before change:  [-0.87516625]
curr_Stock_Price:  99.5792242677406
curr_Factors:  [99.57922427]
mat_Sqrt:  [[0.15]]
grads:  [-0.00139153]
Stock Position:  -0.001391530616260601
Bond Position:  [-0.73659872]


portfolio before change:  [-0.87655291]
curr_Stock_Price:  100.5095496524997
curr_Factors:  [100.50954965]
mat_Sqrt:  [[0.15]]
grads:  [-0.01972922]
Stock Position:  -0.019729218175050422
Bond Position:  [1.10642192]


portfolio before change:  [-0.86367635]
curr_Stock_Price:  99.86389557060089
curr_Factors:  [99.86389557]
mat_Sqrt:  [[0.15]]
grads:  [-0.070625]
Stock Position:  -0.07062500262896519
Bond Position:  [6.18921154]


portfolio before change:  [-0.76924859]
curr_Stock_Price:  98.53782037147454
curr_Factors:  [98.53782037]
mat_Sqrt:  [[0.15]]
grads:  [-0.01601659]
Stock Position:  -0.016016594675520315
Bond Position:  [0.80899174]


portfolio before change:  [-0.76297507]
curr_Stock_Price:  98.1524457015167
curr_Factors:  [98.1524457]
mat_Sqrt:  [[0.15]]
grads:  [0.00227215]
Stock Position:  0.0022721525913711803
Bond Position:  [-0.9859924]


portfolio before change:  [-0.76494565]
curr_Stock_Price:  97.33941693977316
curr_Factors:  [97.33941694]
mat_Sqrt:  [[0.15]]
grads:  [0.07607557]
Stock Position:  0.07607557463371001
Bond Position:  [-8.17009773]


portfolio before change:  [-0.85179777]
curr_Stock_Price:  96.21118633916116
curr_Factors:  [96.21118634]
mat_Sqrt:  [[0.15]]
grads:  [0.03171388]
Stock Position:  0.031713875992682085
Bond Position:  [-3.9030274]


portfolio before change:  [-0.84934246]
curr_Stock_Price:  96.30399151675869
curr_Factors:  [96.30399152]
mat_Sqrt:  [[0.15]]
grads:  [0.03606447]
Stock Position:  0.03606446909282993
Bond Position:  [-4.32249479]


portfolio before change:  [-0.89411841]
curr_Stock_Price:  95.0774213319542
curr_Factors:  [95.07742133]
mat_Sqrt:  [[0.15]]
grads:  [0.01844589]
Stock Position:  0.018445888275711635
Bond Position:  [-2.6479059]


portfolio before change:  [-0.89642111]
curr_Stock_Price:  94.97053075774384
curr_Factors:  [94.97053076]
mat_Sqrt:  [[0.15]]
grads:  [-0.01289881]
Stock Position:  -0.012898805270401218
Bond Position:  [0.32858527]


portfolio before change:  [-0.89298824]
curr_Stock_Price:  94.70757692565746
curr_Factors:  [94.70757693]
mat_Sqrt:  [[0.15]]
grads:  [0.04693999]
Stock Position:  0.04693999397251003
Bond Position:  [-5.33856133]


portfolio before change:  [-0.85430128]
curr_Stock_Price:  95.54597353255073
curr_Factors:  [95.54597353]
mat_Sqrt:  [[0.15]]
grads:  [-0.11990293]
Stock Position:  -0.11990292788515933
Bond Position:  [10.6019407]


portfolio before change:  [-0.8320526]
curr_Stock_Price:  95.37147110528636
curr_Factors:  [95.37147111]
mat_Sqrt:  [[0.15]]
grads:  [-0.17813081]
Stock Position:  -0.17813081447009615
Bond Position:  [16.15654523]


portfolio before change:  [-0.72311179]
curr_Stock_Price:  94.77123183524887
curr_Factors:  [94.77123184]
mat_Sqrt:  [[0.15]]
grads:  [0.14405557]
Stock Position:  0.14405556568317637
Bond Position:  [-14.37543521]


portfolio before change:  [-0.73403052]
curr_Stock_Price:  94.70791119942164
curr_Factors:  [94.7079112]
mat_Sqrt:  [[0.15]]
grads:  [0.01747653]
Stock Position:  0.017476528623847805
Bond Position:  [-2.38919605]


portfolio before change:  [-0.72416034]
curr_Stock_Price:  95.28976883658576
curr_Factors:  [95.28976884]
mat_Sqrt:  [[0.15]]
grads:  [-0.05680967]
Stock Position:  -0.05680966949090102
Bond Position:  [4.68921993]


portfolio before change:  [-0.7325085]
curr_Stock_Price:  95.44703688355592
curr_Factors:  [95.44703688]
mat_Sqrt:  [[0.15]]
grads:  [-0.08271992]
Stock Position:  -0.08271991981609898
Bond Position:  [7.16286274]


portfolio before change:  [-0.63575472]
curr_Stock_Price:  94.28820644002641
curr_Factors:  [94.28820644]
mat_Sqrt:  [[0.15]]
grads:  [-0.04383717]
Stock Position:  -0.04383716515548314
Bond Position:  [3.49757295]


portfolio before change:  [-0.6308909]
curr_Stock_Price:  94.18722812248376
curr_Factors:  [94.18722812]
mat_Sqrt:  [[0.15]]
grads:  [-0.04240654]
Stock Position:  -0.042406539787546466
Bond Position:  [3.36326354]


portfolio before change:  [-0.58161977]
curr_Stock_Price:  93.03526692494009
curr_Factors:  [93.03526692]
mat_Sqrt:  [[0.15]]
grads:  [-0.01151934]
Stock Position:  -0.011519343009627927
Bond Position:  [0.49008538]


portfolio before change:  [-0.59549775]
curr_Stock_Price:  94.24533937118026
curr_Factors:  [94.24533937]
mat_Sqrt:  [[0.15]]
grads:  [0.12307294]
Stock Position:  0.12307294465346004
Bond Position:  [-12.19454918]


portfolio before change:  [-0.67756542]
curr_Stock_Price:  93.590904214769
curr_Factors:  [93.59090421]
mat_Sqrt:  [[0.15]]
grads:  [0.08078397]
Stock Position:  0.08078397059057575
Bond Position:  [-8.23821028]


portfolio before change:  [-0.74308838]
curr_Stock_Price:  92.79256374613765
curr_Factors:  [92.79256375]
mat_Sqrt:  [[0.15]]
grads:  [0.10906567]
Stock Position:  0.1090656666972747
Bond Position:  [-10.86357121]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-0.74308838]
Stock Price:  92.5081339276128
PL:  [-0.74308838]
Settle:  Tensor("sub_294:0", shape=(), dtype=float64)
PL:  Tensor("sub_295:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  148
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.78836621e-03]
 [ 7.68065712e-05]
 [-1.62392571e-02]
 [-2.52950693e-03]
 [ 5.02938282e-03]
 [ 1.60094855e-02]
 [ 1.92577440e-02]
 [-3.01616289e-03]
 [ 1.65374940e-02]
 [-4.06096302e-03]
 [ 1.34329499e-02]
 [ 1.10230592e-02]
 [-1.12062264e-02]
 [ 1.17309324e-02]
 [-7.20124953e-03]
 [-2.78841115e-02]
 [ 4.29770943e-03]
 [ 1.16921396e-03]
 [-5.64030654e-03]
 [-2.22733007e-03]
 [ 4.11431528e-04]
 [ 1.04524252e-02]
 [ 4.77050622e-03]
 [ 6.02388956e-03]
 [-3.40188779e-03]
 [-5.18710283e-03]
 [-6.43417832e-03]
 [-2.01164091e-02]
 [-3.66271832e-02]
 [ 2.17320827e-02]
 [ 8.45702739e-03]
 [ 6.20045926e-03]
 [-1.24534617e-02]
 [-6.59591346e-03]
 [-7.90021501e-03]
 [-7.52946680e-03]
 [ 2.19183403e-02]
 [ 8.24109052e-03]
 [ 2.33554486e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-17.60105948]
curr_Stock_Price:  98.74112788838352
curr_Factors:  [98.74112789]
mat_Sqrt:  [[0.15]]
grads:  [-0.03858911]
Stock Position:  -0.03858910806768234
Bond Position:  [-13.79072743]


portfolio before change:  [-17.61801474]
curr_Stock_Price:  99.13583275841896
curr_Factors:  [99.13583276]
mat_Sqrt:  [[0.15]]
grads:  [0.00051204]
Stock Position:  0.0005120438078915774
Bond Position:  [-17.66877663]


portfolio before change:  [-17.62028966]
curr_Stock_Price:  99.00657312482542
curr_Factors:  [99.00657312]
mat_Sqrt:  [[0.15]]
grads:  [-0.10826171]
Stock Position:  -0.1082617137088112
Bond Position:  [-6.90166838]


portfolio before change:  [-17.74964742]
curr_Stock_Price:  100.19346545202981
curr_Factors:  [100.19346545]
mat_Sqrt:  [[0.15]]
grads:  [-0.01686338]
Stock Position:  -0.01686337951009604
Bond Position:  [-16.06004699]


portfolio before change:  [-17.74792072]
curr_Stock_Price:  99.97201921276604
curr_Factors:  [99.97201921]
mat_Sqrt:  [[0.15]]
grads:  [0.03352922]
Stock Position:  0.0335292188147164
Bond Position:  [-21.09990443]


portfolio before change:  [-17.75924696]
curr_Stock_Price:  99.71288449803477
curr_Factors:  [99.7128845]
mat_Sqrt:  [[0.15]]
grads:  [0.1067299]
Stock Position:  0.10672990341425692
Bond Position:  [-28.40159349]


portfolio before change:  [-17.83596615]
curr_Stock_Price:  99.02733368224517
curr_Factors:  [99.02733368]
mat_Sqrt:  [[0.15]]
grads:  [0.12838496]
Stock Position:  0.1283849602115295
Bond Position:  [-30.54958644]


portfolio before change:  [-17.78969674]
curr_Stock_Price:  99.41747551397069
curr_Factors:  [99.41747551]
mat_Sqrt:  [[0.15]]
grads:  [-0.02010775]
Stock Position:  -0.02010775258913931
Bond Position:  [-15.79063474]


portfolio before change:  [-17.79353974]
curr_Stock_Price:  99.51042687667848
curr_Factors:  [99.51042688]
mat_Sqrt:  [[0.15]]
grads:  [0.11024996]
Stock Position:  0.11024996005212914
Bond Position:  [-28.76456033]


portfolio before change:  [-17.76971454]
curr_Stock_Price:  99.759143459898
curr_Factors:  [99.75914346]
mat_Sqrt:  [[0.15]]
grads:  [-0.02707309]
Stock Position:  -0.027073086778870697
Bond Position:  [-15.06892659]


portfolio before change:  [-17.79193546]
curr_Stock_Price:  100.51033928997634
curr_Factors:  [100.51033929]
mat_Sqrt:  [[0.15]]
grads:  [0.089553]
Stock Position:  0.08955299962013898
Bond Position:  [-26.79293784]


portfolio before change:  [-17.79073082]
curr_Stock_Price:  100.56119153720807
curr_Factors:  [100.56119154]
mat_Sqrt:  [[0.15]]
grads:  [0.07348706]
Stock Position:  0.07348706116995334
Bond Position:  [-25.18067725]


portfolio before change:  [-17.73100783]
curr_Stock_Price:  101.41672675794231
curr_Factors:  [101.41672676]
mat_Sqrt:  [[0.15]]
grads:  [-0.07470818]
Stock Position:  -0.07470817628086787
Bond Position:  [-10.15434913]


portfolio before change:  [-17.71485726]
curr_Stock_Price:  101.18355360616066
curr_Factors:  [101.18355361]
mat_Sqrt:  [[0.15]]
grads:  [0.07820622]
Stock Position:  0.07820621596951076
Bond Position:  [-25.62804011]


portfolio before change:  [-17.73686147]
curr_Stock_Price:  100.9431571307934
curr_Factors:  [100.94315713]
mat_Sqrt:  [[0.15]]
grads:  [-0.04800833]
Stock Position:  -0.04800833018580756
Bond Position:  [-12.89074905]


portfolio before change:  [-17.76614183]
curr_Stock_Price:  101.51949289838373
curr_Factors:  [101.5194929]
mat_Sqrt:  [[0.15]]
grads:  [-0.18589408]
Stock Position:  -0.18589407695614577
Bond Position:  [1.1057306]


portfolio before change:  [-17.82036076]
curr_Stock_Price:  101.81190220403585
curr_Factors:  [101.8119022]
mat_Sqrt:  [[0.15]]
grads:  [0.0286514]
Stock Position:  0.028651396194096318
Bond Position:  [-20.73741391]


portfolio before change:  [-17.83394487]
curr_Stock_Price:  101.42826394501053
curr_Factors:  [101.42826395]
mat_Sqrt:  [[0.15]]
grads:  [0.00779476]
Stock Position:  0.007794759735046689
Bond Position:  [-18.62455382]


portfolio before change:  [-17.83195628]
curr_Stock_Price:  101.98207307714574
curr_Factors:  [101.98207308]
mat_Sqrt:  [[0.15]]
grads:  [-0.03760204]
Stock Position:  -0.037602043600252134
Bond Position:  [-13.99722192]


portfolio before change:  [-17.79351521]
curr_Stock_Price:  100.91322607414543
curr_Factors:  [100.91322607]
mat_Sqrt:  [[0.15]]
grads:  [-0.01484887]
Stock Position:  -0.014848867137566673
Bond Position:  [-16.29506812]


portfolio before change:  [-17.78655281]
curr_Stock_Price:  100.30715914558311
curr_Factors:  [100.30715915]
mat_Sqrt:  [[0.15]]
grads:  [0.00274288]
Stock Position:  0.002742876854408933
Bond Position:  [-18.061683]


portfolio before change:  [-17.7898526]
curr_Stock_Price:  99.92728859523689
curr_Factors:  [99.9272886]
mat_Sqrt:  [[0.15]]
grads:  [0.06968283]
Stock Position:  0.06968283447416442
Bond Position:  [-24.75306931]


portfolio before change:  [-17.78771829]
curr_Stock_Price:  100.00232344313432
curr_Factors:  [100.00232344]
mat_Sqrt:  [[0.15]]
grads:  [0.03180337]
Stock Position:  0.031803374781661085
Bond Position:  [-20.96812966]


portfolio before change:  [-17.81106133]
curr_Stock_Price:  99.35076156772956
curr_Factors:  [99.35076157]
mat_Sqrt:  [[0.15]]
grads:  [0.04015926]
Stock Position:  0.040159263738988316
Bond Position:  [-21.80091477]


portfolio before change:  [-17.85459291]
curr_Stock_Price:  98.33464994209275
curr_Factors:  [98.33464994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02267925]
Stock Position:  -0.022679251918422825
Bond Position:  [-15.62443662]


portfolio before change:  [-17.84389189]
curr_Stock_Price:  97.77668614386664
curr_Factors:  [97.77668614]
mat_Sqrt:  [[0.15]]
grads:  [-0.03458069]
Stock Position:  -0.03458068550758315
Bond Position:  [-14.46270706]


portfolio before change:  [-17.84513471]
curr_Stock_Price:  97.76034378043131
curr_Factors:  [97.76034378]
mat_Sqrt:  [[0.15]]
grads:  [-0.04289452]
Stock Position:  -0.04289452210056515
Bond Position:  [-13.65175148]


portfolio before change:  [-17.83786873]
curr_Stock_Price:  97.55116667093118
curr_Factors:  [97.55116667]
mat_Sqrt:  [[0.15]]
grads:  [-0.13410939]
Stock Position:  -0.13410939385558904
Bond Position:  [-4.7553409]


portfolio before change:  [-18.05893403]
curr_Stock_Price:  99.19512934125217
curr_Factors:  [99.19512934]
mat_Sqrt:  [[0.15]]
grads:  [-0.24418122]
Stock Position:  -0.24418122153058536
Bond Position:  [6.16265383]


portfolio before change:  [-18.02988137]
curr_Stock_Price:  99.07930441532697
curr_Factors:  [99.07930442]
mat_Sqrt:  [[0.15]]
grads:  [0.14488055]
Stock Position:  0.1448805510162471
Bond Position:  [-32.38454559]


portfolio before change:  [-17.83664506]
curr_Stock_Price:  100.44100987468836
curr_Factors:  [100.44100987]
mat_Sqrt:  [[0.15]]
grads:  [0.05638018]
Stock Position:  0.05638018262579168
Bond Position:  [-23.49952754]


portfolio before change:  [-17.78152306]
curr_Stock_Price:  101.47079758961905
curr_Factors:  [101.47079759]
mat_Sqrt:  [[0.15]]
grads:  [0.0413364]
Stock Position:  0.04133639504877219
Bond Position:  [-21.97596004]


portfolio before change:  [-17.81761635]
curr_Stock_Price:  100.6640964865971
curr_Factors:  [100.66409649]
mat_Sqrt:  [[0.15]]
grads:  [-0.08302308]
Stock Position:  -0.08302307795294807
Bond Position:  [-9.46017322]


portfolio before change:  [-17.88656281]
curr_Stock_Price:  101.48030171854644
curr_Factors:  [101.48030172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04397276]
Stock Position:  -0.04397275640086623
Bond Position:  [-13.42419422]


portfolio before change:  [-17.8136674]
curr_Stock_Price:  99.78439837485307
curr_Factors:  [99.78439837]
mat_Sqrt:  [[0.15]]
grads:  [-0.0526681]
Stock Position:  -0.052668100090524535
Bond Position:  [-12.55821272]


portfolio before change:  [-17.76300748]
curr_Stock_Price:  98.79272038195752
curr_Factors:  [98.79272038]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019645]
Stock Position:  -0.05019644531862231
Bond Position:  [-12.80396409]


portfolio before change:  [-17.74857973]
curr_Stock_Price:  98.4734081040541
curr_Factors:  [98.4734081]
mat_Sqrt:  [[0.15]]
grads:  [0.14612227]
Stock Position:  0.1461222686916152
Bond Position:  [-32.13773753]


portfolio before change:  [-17.69861841]
curr_Stock_Price:  98.84281644062334
curr_Factors:  [98.84281644]
mat_Sqrt:  [[0.15]]
grads:  [0.0549406]
Stock Position:  0.054940603447468886
Bond Position:  [-23.1291024]


portfolio before change:  [-17.69182862]
curr_Stock_Price:  99.01902688083543
curr_Factors:  [99.01902688]
mat_Sqrt:  [[0.15]]
grads:  [0.15570299]
Stock Position:  0.1557029905092398
Bond Position:  [-33.10938723]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.69182862]
Stock Price:  98.54925177439799
PL:  [-17.69182862]
Settle:  Tensor("sub_296:0", shape=(), dtype=float64)
PL:  Tensor("sub_297:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  149
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.44837753e-03]
 [-6.79629921e-03]
 [ 2.27359527e-02]
 [ 3.11544251e-02]
 [-9.13911926e-03]
 [ 2.55548570e-02]
 [ 2.32042067e-02]
 [-3.15560304e-03]
 [ 1.50518447e-02]
 [ 5.92175527e-03]
 [ 1.22192526e-02]
 [ 1.14506413e-02]
 [-1.03813944e-02]
 [ 1.09111257e-02]
 [ 4.21641113e-04]
 [-2.72692538e-02]
 [ 3.87027358e-03]
 [-1.72071884e-03]
 [-1.13815348e-03]
 [-2.44575435e-03]
 [-4.49931315e-04]
 [-3.08500217e-02]
 [ 4.79178098e-03]
 [ 8.88588705e-03]
 [-4.69586277e-03]
 [-4.03482668e-03]
 [-1.33169737e-03]
 [-9.49619600e-03]
 [-1.19816975e-02]
 [ 2.31857154e-02]
 [-1.25326041e-02]
 [ 6.19896596e-03]
 [-1.29906926e-02]
 [ 5.38269524e-04]
 [-5.87254575e-03]
 [ 2.44206551e-04]
 [ 2.38855251e-02]
 [ 1.07392551e-03]
 [ 1.99985109e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.38496803]
curr_Stock_Price:  100.93057815125508
curr_Factors:  [100.93057815]
mat_Sqrt:  [[0.15]]
grads:  [-0.01632252]
Stock Position:  -0.01632251688075538
Bond Position:  [18.03240909]


portfolio before change:  [16.38787567]
curr_Stock_Price:  100.89054435027477
curr_Factors:  [100.89054435]
mat_Sqrt:  [[0.15]]
grads:  [-0.04530866]
Stock Position:  -0.045308661388870526
Bond Position:  [20.95909118]


portfolio before change:  [16.42029593]
curr_Stock_Price:  100.23282887962355
curr_Factors:  [100.23282888]
mat_Sqrt:  [[0.15]]
grads:  [0.15157302]
Stock Position:  0.15157301810712925
Bond Position:  [1.22770354]


portfolio before change:  [16.60361324]
curr_Stock_Price:  101.44124866061841
curr_Factors:  [101.44124866]
mat_Sqrt:  [[0.15]]
grads:  [0.20769617]
Stock Position:  0.20769616735961433
Bond Position:  [-4.46534532]


portfolio before change:  [16.76946019]
curr_Stock_Price:  102.24244377753463
curr_Factors:  [102.24244378]
mat_Sqrt:  [[0.15]]
grads:  [-0.06092746]
Stock Position:  -0.06092746170646467
Bond Position:  [22.99883277]


portfolio before change:  [16.85249195]
curr_Stock_Price:  100.92683454937753
curr_Factors:  [100.92683455]
mat_Sqrt:  [[0.15]]
grads:  [0.17036571]
Stock Position:  0.17036571365322786
Bond Position:  [-0.34198024]


portfolio before change:  [16.85688272]
curr_Stock_Price:  100.95285806602385
curr_Factors:  [100.95285807]
mat_Sqrt:  [[0.15]]
grads:  [0.15469471]
Stock Position:  0.1546947110148804
Bond Position:  [1.24000951]


portfolio before change:  [16.71072008]
curr_Stock_Price:  100.00701025436858
curr_Factors:  [100.00701025]
mat_Sqrt:  [[0.15]]
grads:  [-0.02103735]
Stock Position:  -0.02103735362690564
Bond Position:  [18.81460292]


portfolio before change:  [16.71959422]
curr_Stock_Price:  99.69698206817957
curr_Factors:  [99.69698207]
mat_Sqrt:  [[0.15]]
grads:  [0.10034563]
Stock Position:  0.10034563108987006
Bond Position:  [6.71543764]


portfolio before change:  [16.81903475]
curr_Stock_Price:  100.67959629472088
curr_Factors:  [100.67959629]
mat_Sqrt:  [[0.15]]
grads:  [0.03947837]
Stock Position:  0.03947836849971253
Bond Position:  [12.84436854]


portfolio before change:  [16.81066978]
curr_Stock_Price:  100.42703747993588
curr_Factors:  [100.42703748]
mat_Sqrt:  [[0.15]]
grads:  [0.08146168]
Stock Position:  0.08146168367863221
Bond Position:  [8.62971422]


portfolio before change:  [16.80422426]
curr_Stock_Price:  100.33467133753395
curr_Factors:  [100.33467134]
mat_Sqrt:  [[0.15]]
grads:  [0.07633761]
Stock Position:  0.07633760861142205
Bond Position:  [9.14491539]


portfolio before change:  [16.84547757]
curr_Stock_Price:  100.8601020264732
curr_Factors:  [100.86010203]
mat_Sqrt:  [[0.15]]
grads:  [-0.0692093]
Stock Position:  -0.06920929573974623
Bond Position:  [23.8259342]


portfolio before change:  [16.74508271]
curr_Stock_Price:  102.35373509845803
curr_Factors:  [102.3537351]
mat_Sqrt:  [[0.15]]
grads:  [0.07274084]
Stock Position:  0.0727408380595241
Bond Position:  [9.29978624]


portfolio before change:  [16.83518585]
curr_Stock_Price:  103.57644018852734
curr_Factors:  [103.57644019]
mat_Sqrt:  [[0.15]]
grads:  [0.00281094]
Stock Position:  0.0028109407531217807
Bond Position:  [16.54403861]


portfolio before change:  [16.83573838]
curr_Stock_Price:  103.03726022474284
curr_Factors:  [103.03726022]
mat_Sqrt:  [[0.15]]
grads:  [-0.18179503]
Stock Position:  -0.18179502550594834
Bond Position:  [35.56739973]


portfolio before change:  [17.0001161]
curr_Stock_Price:  102.1575248264416
curr_Factors:  [102.15752483]
mat_Sqrt:  [[0.15]]
grads:  [0.02580182]
Stock Position:  0.025801823857720372
Bond Position:  [14.36426564]


portfolio before change:  [17.02498269]
curr_Stock_Price:  103.05168415781372
curr_Factors:  [103.05168416]
mat_Sqrt:  [[0.15]]
grads:  [-0.01147146]
Stock Position:  -0.011471458966020767
Bond Position:  [18.20713585]


portfolio before change:  [17.02839077]
curr_Stock_Price:  102.9530003652803
curr_Factors:  [102.95300037]
mat_Sqrt:  [[0.15]]
grads:  [-0.00758769]
Stock Position:  -0.007587689857277025
Bond Position:  [17.8095662]


portfolio before change:  [17.03769881]
curr_Stock_Price:  102.01968447573618
curr_Factors:  [102.01968448]
mat_Sqrt:  [[0.15]]
grads:  [-0.01630503]
Stock Position:  -0.016305029031752103
Bond Position:  [18.70113273]


portfolio before change:  [17.04100592]
curr_Stock_Price:  101.96023513047497
curr_Factors:  [101.96023513]
mat_Sqrt:  [[0.15]]
grads:  [-0.00299954]
Stock Position:  -0.002999542100446409
Bond Position:  [17.34683994]


portfolio before change:  [17.04118827]
curr_Stock_Price:  102.62238473562105
curr_Factors:  [102.62238474]
mat_Sqrt:  [[0.15]]
grads:  [-0.20566681]
Stock Position:  -0.20566681108983823
Bond Position:  [38.14720688]


portfolio before change:  [17.11327839]
curr_Stock_Price:  102.295052306227
curr_Factors:  [102.29505231]
mat_Sqrt:  [[0.15]]
grads:  [0.03194521]
Stock Position:  0.03194520650017779
Bond Position:  [13.84544182]


portfolio before change:  [17.1421347]
curr_Stock_Price:  103.14417908516678
curr_Factors:  [103.14417909]
mat_Sqrt:  [[0.15]]
grads:  [0.05923925]
Stock Position:  0.05923924697953225
Bond Position:  [11.03195121]


portfolio before change:  [17.09359387]
curr_Stock_Price:  102.30149593928049
curr_Factors:  [102.30149594]
mat_Sqrt:  [[0.15]]
grads:  [-0.03130575]
Stock Position:  -0.03130575177701199
Bond Position:  [20.29621911]


portfolio before change:  [17.07957989]
curr_Stock_Price:  102.83019016622445
curr_Factors:  [102.83019017]
mat_Sqrt:  [[0.15]]
grads:  [-0.02689884]
Stock Position:  -0.026898844519305683
Bond Position:  [19.84559318]


portfolio before change:  [17.08853729]
curr_Stock_Price:  102.58941590850826
curr_Factors:  [102.58941591]
mat_Sqrt:  [[0.15]]
grads:  [-0.00887798]
Stock Position:  -0.008877982495375348
Bond Position:  [17.99932433]


portfolio before change:  [17.08742836]
curr_Stock_Price:  102.96776605353855
curr_Factors:  [102.96776605]
mat_Sqrt:  [[0.15]]
grads:  [-0.06330797]
Stock Position:  -0.06330797331915287
Bond Position:  [23.60610894]


portfolio before change:  [17.16940144]
curr_Stock_Price:  101.71954829212432
curr_Factors:  [101.71954829]
mat_Sqrt:  [[0.15]]
grads:  [-0.07987798]
Stock Position:  -0.07987798329298589
Bond Position:  [25.29455382]


portfolio before change:  [17.12226034]
curr_Stock_Price:  102.34929783597883
curr_Factors:  [102.34929784]
mat_Sqrt:  [[0.15]]
grads:  [0.15457144]
Stock Position:  0.15457143570506604
Bond Position:  [1.30198243]


portfolio before change:  [17.32651882]
curr_Stock_Price:  103.66969526385137
curr_Factors:  [103.66969526]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355069]
Stock Position:  -0.08355069387115256
Bond Position:  [25.98819379]


portfolio before change:  [17.3076981]
curr_Stock_Price:  103.93383968763403
curr_Factors:  [103.93383969]
mat_Sqrt:  [[0.15]]
grads:  [0.04132644]
Stock Position:  0.041326439704423734
Bond Position:  [13.01248254]


portfolio before change:  [17.31324259]
curr_Stock_Price:  104.02864174971236
curr_Factors:  [104.02864175]
mat_Sqrt:  [[0.15]]
grads:  [-0.08660462]
Stock Position:  -0.08660461733893494
Bond Position:  [26.3226033]


portfolio before change:  [17.31626499]
curr_Stock_Price:  104.0317378647873
curr_Factors:  [104.03173786]
mat_Sqrt:  [[0.15]]
grads:  [0.00358846]
Stock Position:  0.003588463494567992
Bond Position:  [16.94295089]


portfolio before change:  [17.31818427]
curr_Stock_Price:  103.97636191188926
curr_Factors:  [103.97636191]
mat_Sqrt:  [[0.15]]
grads:  [-0.0391503]
Stock Position:  -0.039150304976453894
Bond Position:  [21.38889055]


portfolio before change:  [17.30403228]
curr_Stock_Price:  104.40613557057925
curr_Factors:  [104.40613557]
mat_Sqrt:  [[0.15]]
grads:  [0.00162804]
Stock Position:  0.0016280436712434732
Bond Position:  [17.13405453]


portfolio before change:  [17.30558886]
curr_Stock_Price:  104.04661881093745
curr_Factors:  [104.04661881]
mat_Sqrt:  [[0.15]]
grads:  [0.15923683]
Stock Position:  0.15923683402144934
Bond Position:  [0.73753469]


portfolio before change:  [17.37455016]
curr_Stock_Price:  104.47911360049818
curr_Factors:  [104.4791136]
mat_Sqrt:  [[0.15]]
grads:  [0.0071595]
Stock Position:  0.007159503394392726
Bond Position:  [16.62653159]


portfolio before change:  [17.38223722]
curr_Stock_Price:  105.2624935802159
curr_Factors:  [105.26249358]
mat_Sqrt:  [[0.15]]
grads:  [0.13332341]
Stock Position:  0.13332340572836482
Bond Position:  [3.34828308]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.38223722]
Stock Price:  105.5720888491773
PL:  [11.81014837]
Settle:  Tensor("sub_298:0", shape=(), dtype=float64)
PL:  Tensor("sub_299:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  150
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.64460459e-03]
 [-2.85012999e-03]
 [-1.39238475e-03]
 [-5.16499629e-03]
 [ 1.57669391e-02]
 [ 2.88529306e-02]
 [ 1.74553360e-02]
 [-9.62694636e-04]
 [ 8.24193057e-03]
 [ 1.13999318e-02]
 [ 2.71849389e-02]
 [ 8.44911675e-03]
 [-9.94119108e-03]
 [ 1.27580365e-02]
 [-5.48376408e-03]
 [-1.92883836e-02]
 [ 4.75299487e-03]
 [-3.14220949e-03]
 [-7.48559024e-03]
 [-2.26297181e-03]
 [ 3.20586277e-04]
 [ 8.90076389e-03]
 [ 4.76384605e-03]
 [ 5.38911141e-03]
 [-1.68353204e-03]
 [-5.66286557e-03]
 [-3.89119719e-03]
 [-1.89334938e-02]
 [-2.85571845e-02]
 [ 2.18838454e-02]
 [ 3.02265896e-03]
 [-4.92847592e-03]
 [-1.25030430e-02]
 [-9.81940493e-03]
 [-6.64643447e-03]
 [-5.69247499e-03]
 [ 1.96493270e-02]
 [ 1.03037927e-02]
 [ 1.88523309e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-8.01990907]
curr_Stock_Price:  99.35836543618737
curr_Factors:  [99.35836544]
mat_Sqrt:  [[0.15]]
grads:  [-0.03096403]
Stock Position:  -0.03096403061774352
Bond Position:  [-4.9433736]


portfolio before change:  [-8.03474541]
curr_Stock_Price:  99.8175555170439
curr_Factors:  [99.81755552]
mat_Sqrt:  [[0.15]]
grads:  [-0.01900087]
Stock Position:  -0.01900086661192559
Bond Position:  [-6.13812535]


portfolio before change:  [-8.02770977]
curr_Stock_Price:  99.40689249518722
curr_Factors:  [99.4068925]
mat_Sqrt:  [[0.15]]
grads:  [-0.00928256]
Stock Position:  -0.009282564978761778
Bond Position:  [-7.10495883]


portfolio before change:  [-8.03369299]
curr_Stock_Price:  99.95577637957199
curr_Factors:  [99.95577638]
mat_Sqrt:  [[0.15]]
grads:  [-0.03443331]
Stock Position:  -0.03443330856862082
Bond Position:  [-4.5918849]


portfolio before change:  [-8.0622985]
curr_Stock_Price:  100.76985699609669
curr_Factors:  [100.769857]
mat_Sqrt:  [[0.15]]
grads:  [0.10511293]
Stock Position:  0.10511292731068342
Bond Position:  [-18.65451316]


portfolio before change:  [-7.98325267]
curr_Stock_Price:  101.54405098120212
curr_Factors:  [101.54405098]
mat_Sqrt:  [[0.15]]
grads:  [0.19235287]
Stock Position:  0.19235287086351024
Bond Position:  [-27.51554239]


portfolio before change:  [-8.02188449]
curr_Stock_Price:  101.36109469713854
curr_Factors:  [101.3610947]
mat_Sqrt:  [[0.15]]
grads:  [0.11636891]
Stock Position:  0.11636890695941443
Bond Position:  [-19.81716429]


portfolio before change:  [-8.01538501]
curr_Stock_Price:  101.43823541847327
curr_Factors:  [101.43823542]
mat_Sqrt:  [[0.15]]
grads:  [-0.00641796]
Stock Position:  -0.006417964239922654
Bond Position:  [-7.36435804]


portfolio before change:  [-8.0216139]
curr_Stock_Price:  102.26533349747801
curr_Factors:  [102.2653335]
mat_Sqrt:  [[0.15]]
grads:  [0.0549462]
Stock Position:  0.054946203773240665
Bond Position:  [-13.64070575]


portfolio before change:  [-8.04624646]
curr_Stock_Price:  101.8480641258013
curr_Factors:  [101.84806413]
mat_Sqrt:  [[0.15]]
grads:  [0.07599955]
Stock Position:  0.0759995450130642
Bond Position:  [-15.786653]


portfolio before change:  [-8.03249834]
curr_Stock_Price:  102.0549282814435
curr_Factors:  [102.05492828]
mat_Sqrt:  [[0.15]]
grads:  [0.18123293]
Stock Position:  0.18123292590372025
Bond Position:  [-26.52821159]


portfolio before change:  [-8.07793883]
curr_Stock_Price:  101.82249668552548
curr_Factors:  [101.82249669]
mat_Sqrt:  [[0.15]]
grads:  [0.05632745]
Stock Position:  0.056327445028219576
Bond Position:  [-13.81333991]


portfolio before change:  [-8.1443452]
curr_Stock_Price:  100.67421814591829
curr_Factors:  [100.67421815]
mat_Sqrt:  [[0.15]]
grads:  [-0.06627461]
Stock Position:  -0.06627460717175827
Bond Position:  [-1.47220094]


portfolio before change:  [-8.12417834]
curr_Stock_Price:  100.36714878679561
curr_Factors:  [100.36714879]
mat_Sqrt:  [[0.15]]
grads:  [0.08505358]
Stock Position:  0.08505357697654958
Bond Position:  [-16.66076335]


portfolio before change:  [-8.13964603]
curr_Stock_Price:  100.20977771956086
curr_Factors:  [100.20977772]
mat_Sqrt:  [[0.15]]
grads:  [-0.03655843]
Stock Position:  -0.03655842720284509
Bond Position:  [-4.47613417]


portfolio before change:  [-8.14451755]
curr_Stock_Price:  100.32772487619741
curr_Factors:  [100.32772488]
mat_Sqrt:  [[0.15]]
grads:  [-0.12858922]
Stock Position:  -0.1285892240157383
Bond Position:  [4.75654674]


portfolio before change:  [-8.17640406]
curr_Stock_Price:  100.58032083260281
curr_Factors:  [100.58032083]
mat_Sqrt:  [[0.15]]
grads:  [0.03168663]
Stock Position:  0.031686632491836626
Bond Position:  [-11.36345572]


portfolio before change:  [-8.22378408]
curr_Stock_Price:  99.12988265035906
curr_Factors:  [99.12988265]
mat_Sqrt:  [[0.15]]
grads:  [-0.02094806]
Stock Position:  -0.020948063272536833
Bond Position:  [-6.14720503]


portfolio before change:  [-8.21052452]
curr_Stock_Price:  98.4602257988533
curr_Factors:  [98.4602258]
mat_Sqrt:  [[0.15]]
grads:  [-0.04990393]
Stock Position:  -0.049903934910618536
Bond Position:  [-3.29697182]


portfolio before change:  [-8.26263693]
curr_Stock_Price:  99.4962215977701
curr_Factors:  [99.4962216]
mat_Sqrt:  [[0.15]]
grads:  [-0.01508648]
Stock Position:  -0.015086478739140397
Bond Position:  [-6.7615893]


portfolio before change:  [-8.24890236]
curr_Stock_Price:  98.52980525390933
curr_Factors:  [98.52980525]
mat_Sqrt:  [[0.15]]
grads:  [0.00213724]
Stock Position:  0.0021372418487458477
Bond Position:  [-8.45948439]


portfolio before change:  [-8.25128935]
curr_Stock_Price:  97.90774707628205
curr_Factors:  [97.90774708]
mat_Sqrt:  [[0.15]]
grads:  [0.05933843]
Stock Position:  0.05933842594538684
Bond Position:  [-14.06098095]


portfolio before change:  [-8.24851911]
curr_Stock_Price:  97.98405479300801
curr_Factors:  [97.98405479]
mat_Sqrt:  [[0.15]]
grads:  [0.03175897]
Stock Position:  0.03175897366235581
Bond Position:  [-11.36039212]


portfolio before change:  [-8.2806028]
curr_Stock_Price:  97.01854642995454
curr_Factors:  [97.01854643]
mat_Sqrt:  [[0.15]]
grads:  [0.03592741]
Stock Position:  0.03592740939847561
Bond Position:  [-11.76622784]


portfolio before change:  [-8.2625309]
curr_Stock_Price:  97.5624979151708
curr_Factors:  [97.56249792]
mat_Sqrt:  [[0.15]]
grads:  [-0.01122355]
Stock Position:  -0.011223546966136831
Bond Position:  [-7.16753362]


portfolio before change:  [-8.27043812]
curr_Stock_Price:  98.18718688793916
curr_Factors:  [98.18718689]
mat_Sqrt:  [[0.15]]
grads:  [-0.03775244]
Stock Position:  -0.03775243715550307
Bond Position:  [-4.56363252]


portfolio before change:  [-8.21354899]
curr_Stock_Price:  96.66517588598565
curr_Factors:  [96.66517589]
mat_Sqrt:  [[0.15]]
grads:  [-0.02594131]
Stock Position:  -0.025941314608952222
Bond Position:  [-5.70592725]


portfolio before change:  [-8.21175499]
curr_Stock_Price:  96.56852378645303
curr_Factors:  [96.56852379]
mat_Sqrt:  [[0.15]]
grads:  [-0.12622329]
Stock Position:  -0.1262232918674675
Bond Position:  [3.97744197]


portfolio before change:  [-8.14668167]
curr_Stock_Price:  96.05692161842263
curr_Factors:  [96.05692162]
mat_Sqrt:  [[0.15]]
grads:  [-0.19038123]
Stock Position:  -0.19038123001243693
Bond Position:  [10.14075322]


portfolio before change:  [-8.259884]
curr_Stock_Price:  96.65818887735227
curr_Factors:  [96.65818888]
mat_Sqrt:  [[0.15]]
grads:  [0.1458923]
Stock Position:  0.14589230241502602
Bond Position:  [-22.36156972]


portfolio before change:  [-8.24243751]
curr_Stock_Price:  96.79693411729308
curr_Factors:  [96.79693412]
mat_Sqrt:  [[0.15]]
grads:  [0.02015106]
Stock Position:  0.020151059746748776
Bond Position:  [-10.19299831]


portfolio before change:  [-8.23389754]
curr_Stock_Price:  97.28396395490773
curr_Factors:  [97.28396395]
mat_Sqrt:  [[0.15]]
grads:  [-0.03285651]
Stock Position:  -0.032856506111379635
Bond Position:  [-5.03748639]


portfolio before change:  [-8.21151771]
curr_Stock_Price:  96.58365950791907
curr_Factors:  [96.58365951]
mat_Sqrt:  [[0.15]]
grads:  [-0.08335362]
Stock Position:  -0.08335362014393653
Bond Position:  [-0.16092005]


portfolio before change:  [-8.201378]
curr_Stock_Price:  96.46177126715556
curr_Factors:  [96.46177127]
mat_Sqrt:  [[0.15]]
grads:  [-0.0654627]
Stock Position:  -0.06546269953491411
Bond Position:  [-1.88673005]


portfolio before change:  [-8.1939806]
curr_Stock_Price:  96.34516653008181
curr_Factors:  [96.34516653]
mat_Sqrt:  [[0.15]]
grads:  [-0.04430956]
Stock Position:  -0.044309563105461865
Bond Position:  [-3.92496836]


portfolio before change:  [-8.197564]
curr_Stock_Price:  96.41496530745394
curr_Factors:  [96.41496531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03794983]
Stock Position:  -0.0379498332519037
Bond Position:  [-4.53863215]


portfolio before change:  [-8.18567648]
curr_Stock_Price:  96.08677188572658
curr_Factors:  [96.08677189]
mat_Sqrt:  [[0.15]]
grads:  [0.13099551]
Stock Position:  0.13099551343079383
Bond Position:  [-20.7726125]


portfolio before change:  [-8.33754201]
curr_Stock_Price:  94.94727645494123
curr_Factors:  [94.94727645]
mat_Sqrt:  [[0.15]]
grads:  [0.06869195]
Stock Position:  0.06869195127676843
Bond Position:  [-14.8596557]


portfolio before change:  [-8.35980401]
curr_Stock_Price:  94.65023403690476
curr_Factors:  [94.65023404]
mat_Sqrt:  [[0.15]]
grads:  [0.12568221]
Stock Position:  0.12568220580486372
Bond Position:  [-20.2556542]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-8.35980401]
Stock Price:  96.1842062203543
PL:  [-8.35980401]
Settle:  Tensor("sub_300:0", shape=(), dtype=float64)
PL:  Tensor("sub_301:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  151
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51972455e-03]
 [ 3.75530630e-03]
 [-8.71615325e-03]
 [ 7.50044690e-04]
 [-1.41530976e-03]
 [ 3.29848229e-02]
 [ 9.02100774e-03]
 [ 1.23217550e-03]
 [ 1.06467278e-02]
 [ 1.30198474e-02]
 [ 1.82005888e-02]
 [-1.08892902e-02]
 [-1.25832945e-02]
 [-7.34473612e-04]
 [ 2.30555493e-03]
 [-3.07547929e-02]
 [ 4.80300469e-03]
 [-1.04377884e-02]
 [ 1.08080314e-02]
 [-4.96920403e-03]
 [-2.94335348e-03]
 [-3.93551708e-02]
 [ 4.83661639e-03]
 [ 1.21781731e-02]
 [-5.68181309e-03]
 [ 8.72768941e-03]
 [-1.15813185e-02]
 [ 2.78013585e-03]
 [ 6.25774683e-02]
 [ 2.64620295e-02]
 [-2.93393194e-02]
 [ 5.84722818e-03]
 [-1.31251163e-02]
 [ 4.28292889e-03]
 [-6.81576235e-03]
 [ 6.04557075e-03]
 [ 2.50711852e-02]
 [ 1.09188586e-02]
 [ 1.78222660e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.04284179]
curr_Stock_Price:  100.32873903543384
curr_Factors:  [100.32873904]
mat_Sqrt:  [[0.15]]
grads:  [-0.0101315]
Stock Position:  -0.01013149697096934
Bond Position:  [8.05932211]


portfolio before change:  [7.05391955]
curr_Stock_Price:  99.33478120722903
curr_Factors:  [99.33478121]
mat_Sqrt:  [[0.15]]
grads:  [0.02503538]
Stock Position:  0.025035375366484893
Bond Position:  [4.56703602]


portfolio before change:  [7.05204236]
curr_Stock_Price:  99.23699518311903
curr_Factors:  [99.23699518]
mat_Sqrt:  [[0.15]]
grads:  [-0.05810769]
Stock Position:  -0.05810768830342908
Bond Position:  [12.81847474]


portfolio before change:  [6.9809948]
curr_Stock_Price:  100.48725942598499
curr_Factors:  [100.48725943]
mat_Sqrt:  [[0.15]]
grads:  [0.0050003]
Stock Position:  0.005000297932085777
Bond Position:  [6.47852857]


portfolio before change:  [6.98927105]
curr_Stock_Price:  101.9804461276437
curr_Factors:  [101.98044613]
mat_Sqrt:  [[0.15]]
grads:  [-0.0094354]
Stock Position:  -0.009435398417522526
Bond Position:  [7.95149719]


portfolio before change:  [6.98646338]
curr_Stock_Price:  102.38336147741225
curr_Factors:  [102.38336148]
mat_Sqrt:  [[0.15]]
grads:  [0.21989882]
Stock Position:  0.21989881951971585
Bond Position:  [-15.52751695]


portfolio before change:  [6.92943262]
curr_Stock_Price:  102.13283855303183
curr_Factors:  [102.13283855]
mat_Sqrt:  [[0.15]]
grads:  [0.06014005]
Stock Position:  0.06014005162832158
Bond Position:  [0.78715844]


portfolio before change:  [6.97704837]
curr_Stock_Price:  102.92295005489125
curr_Factors:  [102.92295005]
mat_Sqrt:  [[0.15]]
grads:  [0.0082145]
Stock Position:  0.0082145033256989
Bond Position:  [6.13158745]


portfolio before change:  [6.9778837]
curr_Stock_Price:  102.93132994379172
curr_Factors:  [102.93132994]
mat_Sqrt:  [[0.15]]
grads:  [0.07097819]
Stock Position:  0.07097818530001104
Bond Position:  [-0.32799531]


portfolio before change:  [7.01854759]
curr_Stock_Price:  103.50481445179219
curr_Factors:  [103.50481445]
mat_Sqrt:  [[0.15]]
grads:  [0.08679898]
Stock Position:  0.08679898241733718
Bond Position:  [-1.96556498]


portfolio before change:  [7.08642827]
curr_Stock_Price:  104.28968994096097
curr_Factors:  [104.28968994]
mat_Sqrt:  [[0.15]]
grads:  [0.12133726]
Stock Position:  0.12133725891375509
Bond Position:  [-5.56779684]


portfolio before change:  [7.08610901]
curr_Stock_Price:  104.29279499856352
curr_Factors:  [104.292795]
mat_Sqrt:  [[0.15]]
grads:  [-0.07259527]
Stock Position:  -0.07259526815349543
Bond Position:  [14.65727243]


portfolio before change:  [7.08624263]
curr_Stock_Price:  104.31619398134458
curr_Factors:  [104.31619398]
mat_Sqrt:  [[0.15]]
grads:  [-0.08388863]
Stock Position:  -0.08388863000360877
Bond Position:  [15.83718523]


portfolio before change:  [7.10756154]
curr_Stock_Price:  104.08566057924989
curr_Factors:  [104.08566058]
mat_Sqrt:  [[0.15]]
grads:  [-0.00489649]
Stock Position:  -0.004896490744295256
Bond Position:  [7.61721601]


portfolio before change:  [7.10682162]
curr_Stock_Price:  104.43124071289454
curr_Factors:  [104.43124071]
mat_Sqrt:  [[0.15]]
grads:  [0.01537037]
Stock Position:  0.015370366203474156
Bond Position:  [5.5016752]


portfolio before change:  [7.10683125]
curr_Stock_Price:  104.38712238512517
curr_Factors:  [104.38712239]
mat_Sqrt:  [[0.15]]
grads:  [-0.20503195]
Stock Position:  -0.20503195278477848
Bond Position:  [28.5095268]


portfolio before change:  [7.008521]
curr_Stock_Price:  104.883992094554
curr_Factors:  [104.88399209]
mat_Sqrt:  [[0.15]]
grads:  [0.03202003]
Stock Position:  0.03202003126785742
Bond Position:  [3.65013229]


portfolio before change:  [7.02800156]
curr_Stock_Price:  105.47812852677397
curr_Factors:  [105.47812853]
mat_Sqrt:  [[0.15]]
grads:  [-0.06958526]
Stock Position:  -0.0695852560619199
Bond Position:  [14.36772415]


portfolio before change:  [7.02221669]
curr_Stock_Price:  105.58707332563972
curr_Factors:  [105.58707333]
mat_Sqrt:  [[0.15]]
grads:  [0.07205354]
Stock Position:  0.07205354266438459
Bond Position:  [-0.585706]


portfolio before change:  [7.11449392]
curr_Stock_Price:  106.86876531394374
curr_Factors:  [106.86876531]
mat_Sqrt:  [[0.15]]
grads:  [-0.03312803]
Stock Position:  -0.03312802688340448
Bond Position:  [10.65484525]


portfolio before change:  [7.12166085]
curr_Stock_Price:  106.6926305897398
curr_Factors:  [106.69263059]
mat_Sqrt:  [[0.15]]
grads:  [-0.01962236]
Stock Position:  -0.019622356558457572
Bond Position:  [9.21522169]


portfolio before change:  [7.1372727]
curr_Stock_Price:  105.95572284012734
curr_Factors:  [105.95572284]
mat_Sqrt:  [[0.15]]
grads:  [-0.26236781]
Stock Position:  -0.26236780566349727
Bond Position:  [34.93664319]


portfolio before change:  [7.06881399]
curr_Stock_Price:  106.23329524454242
curr_Factors:  [106.23329524]
mat_Sqrt:  [[0.15]]
grads:  [0.03224411]
Stock Position:  0.03224410929661375
Bond Position:  [3.643416]


portfolio before change:  [7.06905965]
curr_Stock_Price:  106.22678875911004
curr_Factors:  [106.22678876]
mat_Sqrt:  [[0.15]]
grads:  [0.08118782]
Stock Position:  0.08118782074085835
Bond Position:  [-1.55526184]


portfolio before change:  [7.03043525]
curr_Stock_Price:  105.75344220018695
curr_Factors:  [105.7534422]
mat_Sqrt:  [[0.15]]
grads:  [-0.03787875]
Stock Position:  -0.037878753925952746
Bond Position:  [11.03624386]


portfolio before change:  [7.04223556]
curr_Stock_Price:  105.47833572796564
curr_Factors:  [105.47833573]
mat_Sqrt:  [[0.15]]
grads:  [0.0581846]
Stock Position:  0.058184596059747545
Bond Position:  [0.9050212]


portfolio before change:  [7.07204722]
curr_Stock_Price:  105.98875477269607
curr_Factors:  [105.98875477]
mat_Sqrt:  [[0.15]]
grads:  [-0.07720879]
Stock Position:  -0.07720878999358494
Bond Position:  [15.25531073]


portfolio before change:  [7.14482654]
curr_Stock_Price:  105.07082442412086
curr_Factors:  [105.07082442]
mat_Sqrt:  [[0.15]]
grads:  [0.01853424]
Stock Position:  0.018534238995699948
Bond Position:  [5.19741877]


portfolio before change:  [7.17609757]
curr_Stock_Price:  106.72297256261677
curr_Factors:  [106.72297256]
mat_Sqrt:  [[0.15]]
grads:  [0.41718312]
Stock Position:  0.4171831219737512
Bond Position:  [-37.34692531]


portfolio before change:  [6.85719688]
curr_Stock_Price:  105.96974929901305
curr_Factors:  [105.9697493]
mat_Sqrt:  [[0.15]]
grads:  [0.17641353]
Stock Position:  0.17641352975972138
Bond Position:  [-11.83730064]


portfolio before change:  [6.97002406]
curr_Stock_Price:  106.61769811295366
curr_Factors:  [106.61769811]
mat_Sqrt:  [[0.15]]
grads:  [-0.19559546]
Stock Position:  -0.19559546268634875
Bond Position:  [27.82396205]


portfolio before change:  [7.12351083]
curr_Stock_Price:  105.85076541807464
curr_Factors:  [105.85076542]
mat_Sqrt:  [[0.15]]
grads:  [0.03898152]
Stock Position:  0.038981521200740915
Bond Position:  [2.99728697]


portfolio before change:  [7.12398437]
curr_Stock_Price:  105.85330147010662
curr_Factors:  [105.85330147]
mat_Sqrt:  [[0.15]]
grads:  [-0.08750078]
Stock Position:  -0.08750077554056884
Bond Position:  [16.38623035]


portfolio before change:  [7.07213646]
curr_Stock_Price:  106.46925397225883
curr_Factors:  [106.46925397]
mat_Sqrt:  [[0.15]]
grads:  [0.02855286]
Stock Position:  0.0285528592357754
Bond Position:  [4.03213484]


portfolio before change:  [7.0713441]
curr_Stock_Price:  106.42385029376648
curr_Factors:  [106.42385029]
mat_Sqrt:  [[0.15]]
grads:  [-0.04543842]
Stock Position:  -0.04543841567639917
Bond Position:  [11.90707525]


portfolio before change:  [7.02830061]
curr_Stock_Price:  107.40390136324065
curr_Factors:  [107.40390136]
mat_Sqrt:  [[0.15]]
grads:  [0.04030381]
Stock Position:  0.040303805020650875
Bond Position:  [2.69951471]


portfolio before change:  [7.09873697]
curr_Stock_Price:  109.14316391883612
curr_Factors:  [109.14316392]
mat_Sqrt:  [[0.15]]
grads:  [0.16714123]
Stock Position:  0.16714123443419934
Bond Position:  [-11.14358618]


portfolio before change:  [7.0215424]
curr_Stock_Price:  108.68964607009296
curr_Factors:  [108.68964607]
mat_Sqrt:  [[0.15]]
grads:  [0.07279239]
Stock Position:  0.07279239055743617
Bond Position:  [-0.89023676]


portfolio before change:  [7.03936506]
curr_Stock_Price:  108.93601719118692
curr_Factors:  [108.93601719]
mat_Sqrt:  [[0.15]]
grads:  [0.11881511]
Stock Position:  0.11881510686604954
Bond Position:  [-5.90387947]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.03936506]
Stock Price:  109.01725571562883
PL:  [-1.97789066]
Settle:  Tensor("sub_302:0", shape=(), dtype=float64)
PL:  Tensor("sub_303:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  152
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.14121101e-03]
 [-1.11726895e-04]
 [-1.21136123e-02]
 [-1.30965812e-02]
 [ 1.09733974e-02]
 [ 2.43629314e-02]
 [ 5.43852862e-03]
 [-5.71576017e-03]
 [ 1.18629399e-02]
 [ 5.56427862e-04]
 [-5.32370659e-02]
 [-3.05512567e-03]
 [ 7.06307432e-03]
 [ 8.02542833e-03]
 [ 1.12128451e-03]
 [-1.15716420e-02]
 [-6.60810426e-03]
 [-2.35261407e-03]
 [-7.59063073e-03]
 [-2.36549139e-03]
 [ 3.15067418e-04]
 [ 8.46195454e-03]
 [ 4.76706325e-03]
 [ 5.95912264e-03]
 [-3.39894100e-03]
 [-7.01120251e-03]
 [ 4.96146850e-03]
 [-2.00917071e-02]
 [-1.56068025e-02]
 [ 2.28640044e-02]
 [-2.88261684e-03]
 [ 6.44567744e-03]
 [-1.28112024e-02]
 [-4.30121087e-03]
 [-5.52639584e-03]
 [-6.07048267e-03]
 [ 2.30347453e-02]
 [ 4.79675550e-03]
 [ 2.28938129e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.94319269]
curr_Stock_Price:  100.83769599833067
curr_Factors:  [100.837696]
mat_Sqrt:  [[0.15]]
grads:  [-0.01427474]
Stock Position:  -0.014274740047772343
Bond Position:  [16.38262458]


portfolio before change:  [14.96967985]
curr_Stock_Price:  99.12563609036691
curr_Factors:  [99.12563609]
mat_Sqrt:  [[0.15]]
grads:  [-0.00074485]
Stock Position:  -0.0007448459689774126
Bond Position:  [15.04351318]


portfolio before change:  [14.97153216]
curr_Stock_Price:  99.16356220376812
curr_Factors:  [99.1635622]
mat_Sqrt:  [[0.15]]
grads:  [-0.08075742]
Stock Position:  -0.08075741516087077
Bond Position:  [22.97972512]


portfolio before change:  [14.97970329]
curr_Stock_Price:  99.09795232115458
curr_Factors:  [99.09795232]
mat_Sqrt:  [[0.15]]
grads:  [-0.08731054]
Stock Position:  -0.08731054147787691
Bond Position:  [23.63199917]


portfolio before change:  [15.07901645]
curr_Stock_Price:  97.99431721715476
curr_Factors:  [97.99431722]
mat_Sqrt:  [[0.15]]
grads:  [0.07315598]
Stock Position:  0.07315598281044436
Bond Position:  [7.91014587]


portfolio before change:  [15.02670819]
curr_Stock_Price:  97.26577672557144
curr_Factors:  [97.26577673]
mat_Sqrt:  [[0.15]]
grads:  [0.16241954]
Stock Position:  0.1624195423894339
Bond Position:  [-0.77115476]


portfolio before change:  [15.14191572]
curr_Stock_Price:  97.97569088073624
curr_Factors:  [97.97569088]
mat_Sqrt:  [[0.15]]
grads:  [0.03625686]
Stock Position:  0.03625685746334797
Bond Position:  [11.58962506]


portfolio before change:  [15.143982]
curr_Stock_Price:  97.99272183725326
curr_Factors:  [97.99272184]
mat_Sqrt:  [[0.15]]
grads:  [-0.03810507]
Stock Position:  -0.03810506776982497
Bond Position:  [18.87800131]


portfolio before change:  [15.14093322]
curr_Stock_Price:  98.13466301961623
curr_Factors:  [98.13466302]
mat_Sqrt:  [[0.15]]
grads:  [0.07908627]
Stock Position:  0.07908626608116731
Bond Position:  [7.37982915]


portfolio before change:  [15.05925857]
curr_Stock_Price:  97.09026948908559
curr_Factors:  [97.09026949]
mat_Sqrt:  [[0.15]]
grads:  [0.00370952]
Stock Position:  0.003709519083036298
Bond Position:  [14.69910036]


portfolio before change:  [15.05970671]
curr_Stock_Price:  96.71572849946014
curr_Factors:  [96.7157285]
mat_Sqrt:  [[0.15]]
grads:  [-0.35491377]
Stock Position:  -0.3549137724463189
Bond Position:  [49.38545076]


portfolio before change:  [14.66901891]
curr_Stock_Price:  97.83391943500739
curr_Factors:  [97.83391944]
mat_Sqrt:  [[0.15]]
grads:  [-0.0203675]
Stock Position:  -0.0203675044864007
Bond Position:  [16.6616517]


portfolio before change:  [14.66922148]
curr_Stock_Price:  97.9262364938602
curr_Factors:  [97.92623649]
mat_Sqrt:  [[0.15]]
grads:  [0.04708716]
Stock Position:  0.0470871621430099
Bond Position:  [10.0581529]


portfolio before change:  [14.6490818]
curr_Stock_Price:  97.47182337840648
curr_Factors:  [97.47182338]
mat_Sqrt:  [[0.15]]
grads:  [0.05350286]
Stock Position:  0.05350285550004329
Bond Position:  [9.43406092]


portfolio before change:  [14.68316109]
curr_Stock_Price:  98.08674300100415
curr_Factors:  [98.086743]
mat_Sqrt:  [[0.15]]
grads:  [0.00747523]
Stock Position:  0.007475230043572402
Bond Position:  [13.94994012]


portfolio before change:  [14.67668364]
curr_Stock_Price:  96.98693681001748
curr_Factors:  [96.98693681]
mat_Sqrt:  [[0.15]]
grads:  [-0.07714428]
Stock Position:  -0.07714427995066174
Bond Position:  [22.15867104]


portfolio before change:  [14.65123676]
curr_Stock_Price:  97.35270445058546
curr_Factors:  [97.35270445]
mat_Sqrt:  [[0.15]]
grads:  [-0.04405403]
Stock Position:  -0.04405402843225516
Bond Position:  [18.94001557]


portfolio before change:  [14.60740106]
curr_Stock_Price:  98.40149279619344
curr_Factors:  [98.4014928]
mat_Sqrt:  [[0.15]]
grads:  [-0.01568409]
Stock Position:  -0.01568409381495151
Bond Position:  [16.15073931]


portfolio before change:  [14.62615058]
curr_Stock_Price:  97.33477212320032
curr_Factors:  [97.33477212]
mat_Sqrt:  [[0.15]]
grads:  [-0.0506042]
Stock Position:  -0.05060420489730299
Bond Position:  [19.55169933]


portfolio before change:  [14.57379678]
curr_Stock_Price:  98.41764474850413
curr_Factors:  [98.41764475]
mat_Sqrt:  [[0.15]]
grads:  [-0.01576994]
Stock Position:  -0.015769942631066628
Bond Position:  [16.1258374]


portfolio before change:  [14.56978533]
curr_Stock_Price:  98.79984712849229
curr_Factors:  [98.79984713]
mat_Sqrt:  [[0.15]]
grads:  [0.00210045]
Stock Position:  0.002100449455397212
Bond Position:  [14.36226125]


portfolio before change:  [14.57197183]
curr_Stock_Price:  98.98604583822618
curr_Factors:  [98.98604584]
mat_Sqrt:  [[0.15]]
grads:  [0.05641303]
Stock Position:  0.0564130302423407
Bond Position:  [8.98786903]


portfolio before change:  [14.53554582]
curr_Stock_Price:  98.32042727796043
curr_Factors:  [98.32042728]
mat_Sqrt:  [[0.15]]
grads:  [0.03178042]
Stock Position:  0.03178042166161256
Bond Position:  [11.41088118]


portfolio before change:  [14.55668065]
curr_Stock_Price:  98.94056943067413
curr_Factors:  [98.94056943]
mat_Sqrt:  [[0.15]]
grads:  [0.03972748]
Stock Position:  0.039727484262625665
Bond Position:  [10.62602073]


portfolio before change:  [14.56772085]
curr_Stock_Price:  99.18503163684016
curr_Factors:  [99.18503164]
mat_Sqrt:  [[0.15]]
grads:  [-0.02265961]
Stock Position:  -0.02265960665752964
Bond Position:  [16.81521466]


portfolio before change:  [14.57505604]
curr_Stock_Price:  98.95408510781151
curr_Factors:  [98.95408511]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674135]
Stock Position:  -0.04674135004595474
Bond Position:  [19.20030357]


portfolio before change:  [14.57669643]
curr_Stock_Price:  98.97034062795336
curr_Factors:  [98.97034063]
mat_Sqrt:  [[0.15]]
grads:  [0.03307646]
Stock Position:  0.03307645664843778
Bond Position:  [11.30310825]


portfolio before change:  [14.62037503]
curr_Stock_Price:  100.24815651884114
curr_Factors:  [100.24815652]
mat_Sqrt:  [[0.15]]
grads:  [-0.13394471]
Stock Position:  -0.13394471407711808
Bond Position:  [28.04808569]


portfolio before change:  [14.50471022]
curr_Stock_Price:  101.13785969983158
curr_Factors:  [101.1378597]
mat_Sqrt:  [[0.15]]
grads:  [-0.10404535]
Stock Position:  -0.10404535027252401
Bond Position:  [25.02763426]


portfolio before change:  [14.40552831]
curr_Stock_Price:  102.12118630907774
curr_Factors:  [102.12118631]
mat_Sqrt:  [[0.15]]
grads:  [0.1524267]
Stock Position:  0.15242669575033838
Bond Position:  [-1.16046669]


portfolio before change:  [14.42439605]
curr_Stock_Price:  102.24592047414427
curr_Factors:  [102.24592047]
mat_Sqrt:  [[0.15]]
grads:  [-0.01921745]
Stock Position:  -0.019217445612048873
Bond Position:  [16.38930147]


portfolio before change:  [14.42844218]
curr_Stock_Price:  102.1419868217557
curr_Factors:  [102.14198682]
mat_Sqrt:  [[0.15]]
grads:  [0.04297118]
Stock Position:  0.04297118292463392
Bond Position:  [10.03928018]


portfolio before change:  [14.45751502]
curr_Stock_Price:  102.7893473526651
curr_Factors:  [102.78934735]
mat_Sqrt:  [[0.15]]
grads:  [-0.08540802]
Stock Position:  -0.08540801606655483
Bond Position:  [23.23654925]


portfolio before change:  [14.47470242]
curr_Stock_Price:  102.62211890112673
curr_Factors:  [102.6221189]
mat_Sqrt:  [[0.15]]
grads:  [-0.02867474]
Stock Position:  -0.028674739115194383
Bond Position:  [17.41736491]


portfolio before change:  [14.47695132]
curr_Stock_Price:  102.6196220860858
curr_Factors:  [102.61962209]
mat_Sqrt:  [[0.15]]
grads:  [-0.03684264]
Stock Position:  -0.03684263892723043
Bond Position:  [18.25772901]


portfolio before change:  [14.52355513]
curr_Stock_Price:  101.41662871867203
curr_Factors:  [101.41662872]
mat_Sqrt:  [[0.15]]
grads:  [-0.04046988]
Stock Position:  -0.04046988445002714
Bond Position:  [18.62787438]


portfolio before change:  [14.52121093]
curr_Stock_Price:  101.53209320533666
curr_Factors:  [101.53209321]
mat_Sqrt:  [[0.15]]
grads:  [0.15356497]
Stock Position:  0.1535649685446424
Bond Position:  [-1.07056177]


portfolio before change:  [14.4725783]
curr_Stock_Price:  101.21627378770701
curr_Factors:  [101.21627379]
mat_Sqrt:  [[0.15]]
grads:  [0.03197837]
Stock Position:  0.03197836999518019
Bond Position:  [11.23584685]


portfolio before change:  [14.48187359]
curr_Stock_Price:  101.46302571534713
curr_Factors:  [101.46302572]
mat_Sqrt:  [[0.15]]
grads:  [0.15262542]
Stock Position:  0.15262541929553458
Bond Position:  [-1.00396325]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [14.48187359]
Stock Price:  100.87040274564899
PL:  [13.61147085]
Settle:  Tensor("sub_304:0", shape=(), dtype=float64)
PL:  Tensor("sub_305:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  153
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44528992e-03]
 [-1.36422936e-03]
 [-3.29413257e-02]
 [-3.06278014e-02]
 [ 2.70329745e-03]
 [ 2.42217904e-02]
 [ 1.76091511e-03]
 [-6.54320616e-03]
 [ 1.12310017e-02]
 [-2.31286231e-03]
 [ 1.31089851e-02]
 [ 3.07618821e-03]
 [ 9.06594880e-03]
 [ 8.24937337e-03]
 [ 3.86624450e-03]
 [-1.05110206e-02]
 [-1.45717745e-03]
 [-3.01096024e-03]
 [-8.30028787e-03]
 [-2.35400013e-03]
 [ 3.33184836e-04]
 [ 9.98609739e-03]
 [ 4.78289997e-03]
 [ 7.76191352e-03]
 [-5.38829265e-03]
 [-3.55810594e-03]
 [-1.15801764e-02]
 [ 5.06911663e-03]
 [ 5.00217454e-02]
 [ 2.60575824e-02]
 [-2.50428132e-02]
 [ 5.56419285e-03]
 [-1.32075083e-02]
 [ 7.42901168e-03]
 [-7.78394355e-03]
 [ 6.00041875e-03]
 [ 2.47989148e-02]
 [ 8.19070664e-03]
 [ 1.80408512e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.88852378]
curr_Stock_Price:  100.12553133771426
curr_Factors:  [100.12553134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00963527]
Stock Position:  -0.009635266104380182
Bond Position:  [4.85325992]


portfolio before change:  [3.89956363]
curr_Stock_Price:  99.04272197879999
curr_Factors:  [99.04272198]
mat_Sqrt:  [[0.15]]
grads:  [-0.00909486]
Stock Position:  -0.009094862397356488
Bond Position:  [4.80034356]


portfolio before change:  [3.90846016]
curr_Stock_Price:  98.13050950058799
curr_Factors:  [98.1305095]
mat_Sqrt:  [[0.15]]
grads:  [-0.21960884]
Stock Position:  -0.2196088379636083
Bond Position:  [25.45878732]


portfolio before change:  [4.13099261]
curr_Stock_Price:  97.13168855841373
curr_Factors:  [97.13168856]
mat_Sqrt:  [[0.15]]
grads:  [-0.20418534]
Stock Position:  -0.2041853429944257
Bond Position:  [23.96385975]


portfolio before change:  [4.06562938]
curr_Stock_Price:  97.46647702603109
curr_Factors:  [97.46647703]
mat_Sqrt:  [[0.15]]
grads:  [0.01802198]
Stock Position:  0.018021982982462915
Bond Position:  [2.30909019]


portfolio before change:  [4.06732317]
curr_Stock_Price:  97.54444452915907
curr_Factors:  [97.54444453]
mat_Sqrt:  [[0.15]]
grads:  [0.1614786]
Stock Position:  0.1614786026609244
Bond Position:  [-11.68401743]


portfolio before change:  [3.94956627]
curr_Stock_Price:  96.82424818978878
curr_Factors:  [96.82424819]
mat_Sqrt:  [[0.15]]
grads:  [0.01173943]
Stock Position:  0.011739434097182526
Bond Position:  [2.81290439]


portfolio before change:  [3.96100645]
curr_Stock_Price:  97.76880349841181
curr_Factors:  [97.7688035]
mat_Sqrt:  [[0.15]]
grads:  [-0.04362137]
Stock Position:  -0.04362137437472974
Bond Position:  [8.22581603]


portfolio before change:  [3.95018114]
curr_Stock_Price:  98.04054188502225
curr_Factors:  [98.04054189]
mat_Sqrt:  [[0.15]]
grads:  [0.07487334]
Stock Position:  0.07487334472454078
Bond Position:  [-3.39044215]


portfolio before change:  [4.01846907]
curr_Stock_Price:  98.95824844418809
curr_Factors:  [98.95824844]
mat_Sqrt:  [[0.15]]
grads:  [-0.01541908]
Stock Position:  -0.015419082084950395
Bond Position:  [5.54431443]


portfolio before change:  [4.02311339]
curr_Stock_Price:  98.70199184836504
curr_Factors:  [98.70199185]
mat_Sqrt:  [[0.15]]
grads:  [0.08739323]
Stock Position:  0.08739323368311197
Bond Position:  [-4.60277284]


portfolio before change:  [4.02820448]
curr_Stock_Price:  98.76683056338464
curr_Factors:  [98.76683056]
mat_Sqrt:  [[0.15]]
grads:  [0.02050792]
Stock Position:  0.020507921396305907
Bond Position:  [2.00270208]


portfolio before change:  [3.99630651]
curr_Stock_Price:  97.1992256831415
curr_Factors:  [97.19922568]
mat_Sqrt:  [[0.15]]
grads:  [0.06043966]
Stock Position:  0.06043965865328793
Bond Position:  [-1.87838151]


portfolio before change:  [4.01642136]
curr_Stock_Price:  97.5359195304513
curr_Factors:  [97.53591953]
mat_Sqrt:  [[0.15]]
grads:  [0.05499582]
Stock Position:  0.054995822479160565
Bond Position:  [-1.34764675]


portfolio before change:  [4.02111137]
curr_Stock_Price:  97.62426208089029
curr_Factors:  [97.62426208]
mat_Sqrt:  [[0.15]]
grads:  [0.02577496]
Stock Position:  0.025774963311203533
Bond Position:  [1.50484959]


portfolio before change:  [4.04010687]
curr_Stock_Price:  98.35393868502678
curr_Factors:  [98.35393869]
mat_Sqrt:  [[0.15]]
grads:  [-0.07007347]
Stock Position:  -0.07007347033595983
Bond Position:  [10.93210868]


portfolio before change:  [3.98068363]
curr_Stock_Price:  99.22145449258034
curr_Factors:  [99.22145449]
mat_Sqrt:  [[0.15]]
grads:  [-0.00971452]
Stock Position:  -0.009714516346176967
Bond Position:  [4.94457207]


portfolio before change:  [3.97782279]
curr_Stock_Price:  99.57957259079727
curr_Factors:  [99.57957259]
mat_Sqrt:  [[0.15]]
grads:  [-0.02007307]
Stock Position:  -0.020073068276705432
Bond Position:  [5.97669035]


portfolio before change:  [3.98656175]
curr_Stock_Price:  99.18143581143184
curr_Factors:  [99.18143581]
mat_Sqrt:  [[0.15]]
grads:  [-0.05533525]
Stock Position:  -0.055335252436907935
Bond Position:  [9.47479154]


portfolio before change:  [3.98932931]
curr_Stock_Price:  99.15282587900974
curr_Factors:  [99.15282588]
mat_Sqrt:  [[0.15]]
grads:  [-0.01569333]
Stock Position:  -0.01569333417189724
Bond Position:  [5.54536775]


portfolio before change:  [3.98435793]
curr_Stock_Price:  99.51378134000174
curr_Factors:  [99.51378134]
mat_Sqrt:  [[0.15]]
grads:  [0.00222123]
Stock Position:  0.00222123224241611
Bond Position:  [3.76331471]


portfolio before change:  [3.98638818]
curr_Stock_Price:  100.216004107934
curr_Factors:  [100.21600411]
mat_Sqrt:  [[0.15]]
grads:  [0.06657398]
Stock Position:  0.06657398257532629
Bond Position:  [-2.68539033]


portfolio before change:  [4.06422676]
curr_Stock_Price:  101.39025080687098
curr_Factors:  [101.39025081]
mat_Sqrt:  [[0.15]]
grads:  [0.031886]
Stock Position:  0.03188599977423105
Bond Position:  [0.83129725]


portfolio before change:  [4.08091651]
curr_Stock_Price:  101.91041095116678
curr_Factors:  [101.91041095]
mat_Sqrt:  [[0.15]]
grads:  [0.05174609]
Stock Position:  0.051746090126379
Bond Position:  [-1.1925488]


portfolio before change:  [4.13333593]
curr_Stock_Price:  102.92630420805814
curr_Factors:  [102.92630421]
mat_Sqrt:  [[0.15]]
grads:  [-0.03592195]
Stock Position:  -0.03592195099300247
Bond Position:  [7.83064959]


portfolio before change:  [4.13197373]
curr_Stock_Price:  102.99147602482255
curr_Factors:  [102.99147602]
mat_Sqrt:  [[0.15]]
grads:  [-0.02372071]
Stock Position:  -0.023720706256658536
Bond Position:  [6.57500428]


portfolio before change:  [4.06170707]
curr_Stock_Price:  105.98837595179202
curr_Factors:  [105.98837595]
mat_Sqrt:  [[0.15]]
grads:  [-0.07720118]
Stock Position:  -0.07720117579690396
Bond Position:  [12.24413432]


portfolio before change:  [4.09182293]
curr_Stock_Price:  105.61810642460546
curr_Factors:  [105.61810642]
mat_Sqrt:  [[0.15]]
grads:  [0.03379411]
Stock Position:  0.03379411084896441
Bond Position:  [0.52255293]


portfolio before change:  [4.09960045]
curr_Stock_Price:  105.84631793266725
curr_Factors:  [105.84631793]
mat_Sqrt:  [[0.15]]
grads:  [0.3334783]
Stock Position:  0.3334783027347702
Bond Position:  [-31.19785]


portfolio before change:  [3.92956323]
curr_Stock_Price:  105.34812286222069
curr_Factors:  [105.34812286]
mat_Sqrt:  [[0.15]]
grads:  [0.17371722]
Stock Position:  0.17371721598839507
Bond Position:  [-14.37121938]


portfolio before change:  [4.01739459]
curr_Stock_Price:  105.86406409071546
curr_Factors:  [105.86406409]
mat_Sqrt:  [[0.15]]
grads:  [-0.16695209]
Stock Position:  -0.16695208813239887
Bond Position:  [21.69162115]


portfolio before change:  [3.99297726]
curr_Stock_Price:  106.02655951828976
curr_Factors:  [106.02655952]
mat_Sqrt:  [[0.15]]
grads:  [0.03709462]
Stock Position:  0.03709461898763438
Bond Position:  [0.05996244]


portfolio before change:  [4.02804383]
curr_Stock_Price:  106.97168492077508
curr_Factors:  [106.97168492]
mat_Sqrt:  [[0.15]]
grads:  [-0.08805006]
Stock Position:  -0.0880500552175881
Bond Position:  [13.44690659]


portfolio before change:  [3.89364758]
curr_Stock_Price:  108.51713783690451
curr_Factors:  [108.51713784]
mat_Sqrt:  [[0.15]]
grads:  [0.04952674]
Stock Position:  0.04952674452512452
Bond Position:  [-1.48085298]


portfolio before change:  [3.90556311]
curr_Stock_Price:  108.7614634660449
curr_Factors:  [108.76146347]
mat_Sqrt:  [[0.15]]
grads:  [-0.05189296]
Stock Position:  -0.05189295698589821
Bond Position:  [9.54951706]


portfolio before change:  [3.978473]
curr_Stock_Price:  107.37946231943596
curr_Factors:  [107.37946232]
mat_Sqrt:  [[0.15]]
grads:  [0.04000279]
Stock Position:  0.040002791655171246
Bond Position:  [-0.31700525]


portfolio before change:  [3.99412005]
curr_Stock_Price:  107.7716017198843
curr_Factors:  [107.77160172]
mat_Sqrt:  [[0.15]]
grads:  [0.1653261]
Stock Position:  0.16532609840315585
Bond Position:  [-13.82333838]


portfolio before change:  [3.95126783]
curr_Stock_Price:  107.52285577960448
curr_Factors:  [107.52285578]
mat_Sqrt:  [[0.15]]
grads:  [0.05460471]
Stock Position:  0.05460471096309388
Bond Position:  [-1.91998664]


portfolio before change:  [4.00804537]
curr_Stock_Price:  108.56704325535242
curr_Factors:  [108.56704326]
mat_Sqrt:  [[0.15]]
grads:  [0.12027234]
Stock Position:  0.12027234103694322
Bond Position:  [-9.04956708]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.00804537]
Stock Price:  107.54316709630379
PL:  [-3.53512173]
Settle:  Tensor("sub_306:0", shape=(), dtype=float64)
PL:  Tensor("sub_307:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  154
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.39249756e-03]
 [-8.39086176e-04]
 [ 7.37564182e-04]
 [ 5.03128951e-02]
 [ 8.42526674e-03]
 [ 3.40955971e-02]
 [ 3.92516212e-03]
 [ 3.14600665e-03]
 [ 1.92769991e-02]
 [ 1.36006456e-02]
 [ 1.52796915e-02]
 [-1.09891720e-02]
 [-1.20069029e-02]
 [-1.25585121e-02]
 [ 4.26382191e-03]
 [-2.88332178e-02]
 [ 4.81823665e-03]
 [ 1.88516814e-03]
 [-1.03281208e-02]
 [-2.23191070e-03]
 [ 3.78023478e-04]
 [ 8.10186670e-03]
 [ 4.76647979e-03]
 [ 6.02623242e-03]
 [-3.34953571e-03]
 [-9.26582871e-03]
 [ 3.34580259e-03]
 [-1.63993871e-02]
 [-1.55305639e-02]
 [ 2.30724967e-02]
 [ 2.29989541e-03]
 [ 3.71724789e-03]
 [-1.25334872e-02]
 [-7.24944562e-03]
 [-5.66676483e-03]
 [-5.20638484e-03]
 [ 2.32410943e-02]
 [ 2.82296376e-04]
 [ 2.16497936e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.88565996]
curr_Stock_Price:  100.57630133860786
curr_Factors:  [100.57630134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00928332]
Stock Position:  -0.009283317073717321
Bond Position:  [11.81934165]


portfolio before change:  [10.87613427]
curr_Stock_Price:  101.76156704612649
curr_Factors:  [101.76156705]
mat_Sqrt:  [[0.15]]
grads:  [-0.00559391]
Stock Position:  -0.0055939078408565645
Bond Position:  [11.4453791]


portfolio before change:  [10.87286647]
curr_Stock_Price:  102.60150961870144
curr_Factors:  [102.60150962]
mat_Sqrt:  [[0.15]]
grads:  [0.00491709]
Stock Position:  0.004917094546651602
Bond Position:  [10.36836515]


portfolio before change:  [10.87106412]
curr_Stock_Price:  101.97136631219257
curr_Factors:  [101.97136631]
mat_Sqrt:  [[0.15]]
grads:  [0.3354193]
Stock Position:  0.33541930038767703
Bond Position:  [-23.33210022]


portfolio before change:  [10.77468488]
curr_Stock_Price:  101.69272239761477
curr_Factors:  [101.6927224]
mat_Sqrt:  [[0.15]]
grads:  [0.05616844]
Stock Position:  0.05616844495952179
Bond Position:  [5.0627628]


portfolio before change:  [10.82548845]
curr_Stock_Price:  102.58594076265565
curr_Factors:  [102.58594076]
mat_Sqrt:  [[0.15]]
grads:  [0.22730398]
Stock Position:  0.22730398048173256
Bond Position:  [-12.49270422]


portfolio before change:  [10.93749211]
curr_Stock_Price:  103.085559558001
curr_Factors:  [103.08555956]
mat_Sqrt:  [[0.15]]
grads:  [0.02616775]
Stock Position:  0.026167747483307018
Bond Position:  [8.23997522]


portfolio before change:  [10.98192059]
curr_Stock_Price:  104.74402925232992
curr_Factors:  [104.74402925]
mat_Sqrt:  [[0.15]]
grads:  [0.02097338]
Stock Position:  0.020973377670763228
Bond Position:  [8.7850845]


portfolio before change:  [11.00471564]
curr_Stock_Price:  105.77852387507009
curr_Factors:  [105.77852388]
mat_Sqrt:  [[0.15]]
grads:  [0.12851333]
Stock Position:  0.12851332750556124
Bond Position:  [-2.58923444]


portfolio before change:  [10.81991706]
curr_Stock_Price:  104.3430704140031
curr_Factors:  [104.34307041]
mat_Sqrt:  [[0.15]]
grads:  [0.09067097]
Stock Position:  0.09067097044134068
Bond Position:  [1.35902961]


portfolio before change:  [10.8478641]
curr_Stock_Price:  104.64942144156235
curr_Factors:  [104.64942144]
mat_Sqrt:  [[0.15]]
grads:  [0.10186461]
Stock Position:  0.1018646100178313
Bond Position:  [0.18779159]


portfolio before change:  [10.81314363]
curr_Stock_Price:  104.30834185423701
curr_Factors:  [104.30834185]
mat_Sqrt:  [[0.15]]
grads:  [-0.07326115]
Stock Position:  -0.0732611469668619
Bond Position:  [18.4548924]


portfolio before change:  [10.74933281]
curr_Stock_Price:  105.21083697416174
curr_Factors:  [105.21083697]
mat_Sqrt:  [[0.15]]
grads:  [-0.08004602]
Stock Position:  -0.08004601924288537
Bond Position:  [19.17104149]


portfolio before change:  [10.72587223]
curr_Stock_Price:  105.53386499004559
curr_Factors:  [105.53386499]
mat_Sqrt:  [[0.15]]
grads:  [-0.08372341]
Stock Position:  -0.08372341414106342
Bond Position:  [19.56152772]


portfolio before change:  [10.74780203]
curr_Stock_Price:  105.30114095249382
curr_Factors:  [105.30114095]
mat_Sqrt:  [[0.15]]
grads:  [0.02842548]
Stock Position:  0.02842547941033324
Bond Position:  [7.75456661]


portfolio before change:  [10.70163638]
curr_Stock_Price:  103.64294439257438
curr_Factors:  [103.64294439]
mat_Sqrt:  [[0.15]]
grads:  [-0.19222145]
Stock Position:  -0.19222145227374007
Bond Position:  [30.62403367]


portfolio before change:  [10.83880367]
curr_Stock_Price:  102.94927024750248
curr_Factors:  [102.94927025]
mat_Sqrt:  [[0.15]]
grads:  [0.03212158]
Stock Position:  0.03212157764181867
Bond Position:  [7.5319107]


portfolio before change:  [10.81082505]
curr_Stock_Price:  102.04893541704087
curr_Factors:  [102.04893542]
mat_Sqrt:  [[0.15]]
grads:  [0.01256779]
Stock Position:  0.012567787594180488
Bond Position:  [9.5282957]


portfolio before change:  [10.80080564]
curr_Stock_Price:  101.15693129958602
curr_Factors:  [101.1569313]
mat_Sqrt:  [[0.15]]
grads:  [-0.06885414]
Stock Position:  -0.06885413841241075
Bond Position:  [17.76587899]


portfolio before change:  [10.81187662]
curr_Stock_Price:  101.02839719857171
curr_Factors:  [101.0283972]
mat_Sqrt:  [[0.15]]
grads:  [-0.0148794]
Stock Position:  -0.01487940468886839
Bond Position:  [12.31511902]


portfolio before change:  [10.8312867]
curr_Stock_Price:  99.82736850985658
curr_Factors:  [99.82736851]
mat_Sqrt:  [[0.15]]
grads:  [0.00252016]
Stock Position:  0.0025201565215265103
Bond Position:  [10.5797061]


portfolio before change:  [10.83456484]
curr_Stock_Price:  100.60335182726186
curr_Factors:  [100.60335183]
mat_Sqrt:  [[0.15]]
grads:  [0.05401244]
Stock Position:  0.05401244468107115
Bond Position:  [5.40073187]


portfolio before change:  [10.7632498]
curr_Stock_Price:  99.27050760862454
curr_Factors:  [99.27050761]
mat_Sqrt:  [[0.15]]
grads:  [0.03177653]
Stock Position:  0.031776531943043175
Bond Position:  [7.60877734]


portfolio before change:  [10.76763696]
curr_Stock_Price:  99.3786378089024
curr_Factors:  [99.37863781]
mat_Sqrt:  [[0.15]]
grads:  [0.04017488]
Stock Position:  0.04017488282935875
Bond Position:  [6.77511183]


portfolio before change:  [10.7683641]
curr_Stock_Price:  99.37565586147021
curr_Factors:  [99.37565586]
mat_Sqrt:  [[0.15]]
grads:  [-0.02233024]
Stock Position:  -0.022330238098957077
Bond Position:  [12.98744616]


portfolio before change:  [10.74326347]
curr_Stock_Price:  100.57242620907297
curr_Factors:  [100.57242621]
mat_Sqrt:  [[0.15]]
grads:  [-0.06177219]
Stock Position:  -0.06177219137127399
Bond Position:  [16.95584263]


portfolio before change:  [10.6685483]
curr_Stock_Price:  101.81626706570033
curr_Factors:  [101.81626707]
mat_Sqrt:  [[0.15]]
grads:  [0.02230535]
Stock Position:  0.02230535061445166
Bond Position:  [8.39750077]


portfolio before change:  [10.66769128]
curr_Stock_Price:  101.73078193608781
curr_Factors:  [101.73078194]
mat_Sqrt:  [[0.15]]
grads:  [-0.10932925]
Stock Position:  -0.10932924759556968
Bond Position:  [21.78984113]


portfolio before change:  [10.73138356]
curr_Stock_Price:  101.17312349530306
curr_Factors:  [101.1731235]
mat_Sqrt:  [[0.15]]
grads:  [-0.10353709]
Stock Position:  -0.10353709285375953
Bond Position:  [21.20655464]


portfolio before change:  [10.62056868]
curr_Stock_Price:  102.26901933679066
curr_Factors:  [102.26901934]
mat_Sqrt:  [[0.15]]
grads:  [0.15381664]
Stock Position:  0.15381664480495913
Bond Position:  [-5.11010875]


portfolio before change:  [10.53819638]
curr_Stock_Price:  101.73764971556476
curr_Factors:  [101.73764972]
mat_Sqrt:  [[0.15]]
grads:  [0.01533264]
Stock Position:  0.015332636054073891
Bond Position:  [8.97829002]


portfolio before change:  [10.52217493]
curr_Stock_Price:  100.6195245581052
curr_Factors:  [100.61952456]
mat_Sqrt:  [[0.15]]
grads:  [0.02478165]
Stock Position:  0.024781652573623553
Bond Position:  [8.02865683]


portfolio before change:  [10.47024348]
curr_Stock_Price:  98.48346475575549
curr_Factors:  [98.48346476]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355658]
Stock Position:  -0.08355658104856162
Bond Position:  [18.69918509]


portfolio before change:  [10.42667761]
curr_Stock_Price:  99.03283400992358
curr_Factors:  [99.03283401]
mat_Sqrt:  [[0.15]]
grads:  [-0.04832964]
Stock Position:  -0.04832963747209885
Bond Position:  [15.21289858]


portfolio before change:  [10.33730157]
curr_Stock_Price:  100.921483977067
curr_Factors:  [100.92148398]
mat_Sqrt:  [[0.15]]
grads:  [-0.03777843]
Stock Position:  -0.03777843219747043
Bond Position:  [14.14995701]


portfolio before change:  [10.30655889]
curr_Stock_Price:  101.7820686463888
curr_Factors:  [101.78206865]
mat_Sqrt:  [[0.15]]
grads:  [-0.03470923]
Stock Position:  -0.03470923225414496
Bond Position:  [13.83933635]


portfolio before change:  [10.29424366]
curr_Stock_Price:  102.18672334500259
curr_Factors:  [102.18672335]
mat_Sqrt:  [[0.15]]
grads:  [0.15494063]
Stock Position:  0.1549406284943286
Bond Position:  [-5.53863148]


portfolio before change:  [10.32703894]
curr_Stock_Price:  102.40285549244022
curr_Factors:  [102.40285549]
mat_Sqrt:  [[0.15]]
grads:  [0.00188198]
Stock Position:  0.0018819758378175316
Bond Position:  [10.13431924]


portfolio before change:  [10.3291029]
curr_Stock_Price:  102.82639725493001
curr_Factors:  [102.82639725]
mat_Sqrt:  [[0.15]]
grads:  [0.14433196]
Stock Position:  0.14433195741792898
Bond Position:  [-4.51203229]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [10.3291029]
Stock Price:  102.73767506849629
PL:  [7.59142783]
Settle:  Tensor("sub_308:0", shape=(), dtype=float64)
PL:  Tensor("sub_309:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  155
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.55891405e-03]
 [-1.37946791e-02]
 [-4.22431030e-03]
 [ 1.71202914e-02]
 [ 5.09883304e-03]
 [ 1.94751960e-02]
 [ 1.44952844e-02]
 [-6.91749896e-05]
 [ 9.59330102e-03]
 [ 1.27315136e-02]
 [ 2.53025277e-02]
 [ 1.08872041e-02]
 [-1.09465730e-02]
 [ 1.17925550e-02]
 [-7.11374501e-03]
 [-2.76025932e-02]
 [ 4.43460016e-03]
 [ 7.35631117e-04]
 [-1.78873165e-03]
 [-3.42138136e-03]
 [-1.73116637e-03]
 [-3.85469128e-02]
 [ 4.81287580e-03]
 [ 8.05743483e-03]
 [-4.21443849e-03]
 [-8.69468454e-03]
 [ 1.43789564e-02]
 [-2.58280443e-02]
 [-1.59276559e-02]
 [ 2.17456312e-02]
 [ 7.08989128e-03]
 [ 2.28660587e-03]
 [-1.24968498e-02]
 [-5.93349365e-03]
 [-5.88468271e-03]
 [-4.99421248e-03]
 [ 2.28647167e-02]
 [ 2.70054146e-03]
 [ 2.25984810e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.5659809]
curr_Stock_Price:  100.04033038704894
curr_Factors:  [100.04033039]
mat_Sqrt:  [[0.15]]
grads:  [-0.01039276]
Stock Position:  -0.010392760328679215
Bond Position:  [3.60567608]


portfolio before change:  [2.56216894]
curr_Stock_Price:  100.4504906786131
curr_Factors:  [100.45049068]
mat_Sqrt:  [[0.15]]
grads:  [-0.09196453]
Stock Position:  -0.09196452708065808
Bond Position:  [11.80005081]


portfolio before change:  [2.45610085]
curr_Stock_Price:  101.61988925678111
curr_Factors:  [101.61988926]
mat_Sqrt:  [[0.15]]
grads:  [-0.02816207]
Stock Position:  -0.028162068696943945
Bond Position:  [5.31792715]


portfolio before change:  [2.47393259]
curr_Stock_Price:  101.01031208941528
curr_Factors:  [101.01031209]
mat_Sqrt:  [[0.15]]
grads:  [0.11413528]
Stock Position:  0.11413527625473048
Bond Position:  [-9.05490729]


portfolio before change:  [2.36254394]
curr_Stock_Price:  100.04429422127544
curr_Factors:  [100.04429422]
mat_Sqrt:  [[0.15]]
grads:  [0.03399222]
Stock Position:  0.033992220245181
Bond Position:  [-1.03818375]


portfolio before change:  [2.37698466]
curr_Stock_Price:  100.47293663369877
curr_Factors:  [100.47293663]
mat_Sqrt:  [[0.15]]
grads:  [0.12983464]
Stock Position:  0.12983464013113574
Bond Position:  [-10.66788291]


portfolio before change:  [2.51765628]
curr_Stock_Price:  101.56667541476797
curr_Factors:  [101.56667541]
mat_Sqrt:  [[0.15]]
grads:  [0.09663523]
Stock Position:  0.09663522956929713
Bond Position:  [-7.29726272]


portfolio before change:  [2.54616335]
curr_Stock_Price:  101.8711118770166
curr_Factors:  [101.87111188]
mat_Sqrt:  [[0.15]]
grads:  [-0.00046117]
Stock Position:  -0.00046116659725521555
Bond Position:  [2.5931429]


portfolio before change:  [2.54615785]
curr_Stock_Price:  102.58595208287704
curr_Factors:  [102.58595208]
mat_Sqrt:  [[0.15]]
grads:  [0.06395534]
Stock Position:  0.06395534014325108
Bond Position:  [-4.01476161]


portfolio before change:  [2.58460629]
curr_Stock_Price:  103.19497573892909
curr_Factors:  [103.19497574]
mat_Sqrt:  [[0.15]]
grads:  [0.08487676]
Stock Position:  0.08487675759925853
Bond Position:  [-6.17424865]


portfolio before change:  [2.55885796]
curr_Stock_Price:  102.90070790058779
curr_Factors:  [102.9007079]
mat_Sqrt:  [[0.15]]
grads:  [0.16868352]
Stock Position:  0.16868351798445977
Bond Position:  [-14.79879545]


portfolio before change:  [2.32878772]
curr_Stock_Price:  101.54775846448138
curr_Factors:  [101.54775846]
mat_Sqrt:  [[0.15]]
grads:  [0.07258136]
Stock Position:  0.07258136038546749
Bond Position:  [-5.04168673]


portfolio before change:  [2.29616258]
curr_Stock_Price:  101.1069443059516
curr_Factors:  [101.10694431]
mat_Sqrt:  [[0.15]]
grads:  [-0.07297715]
Stock Position:  -0.07297715304521182
Bond Position:  [9.67465953]


portfolio before change:  [2.31132946]
curr_Stock_Price:  100.91568630387377
curr_Factors:  [100.9156863]
mat_Sqrt:  [[0.15]]
grads:  [0.07861703]
Stock Position:  0.07861703329156228
Bond Position:  [-5.62236241]


portfolio before change:  [2.31001389]
curr_Stock_Price:  100.90789247127212
curr_Factors:  [100.90789247]
mat_Sqrt:  [[0.15]]
grads:  [-0.04742497]
Stock Position:  -0.04742496674786253
Bond Position:  [7.09556733]


portfolio before change:  [2.27371829]
curr_Stock_Price:  101.69192243313842
curr_Factors:  [101.69192243]
mat_Sqrt:  [[0.15]]
grads:  [-0.18401729]
Stock Position:  -0.18401728794210356
Bond Position:  [20.98679007]


portfolio before change:  [2.29940382]
curr_Stock_Price:  101.56659719119207
curr_Factors:  [101.56659719]
mat_Sqrt:  [[0.15]]
grads:  [0.029564]
Stock Position:  0.029564001046817348
Bond Position:  [-0.70331117]


portfolio before change:  [2.32593257]
curr_Stock_Price:  102.46690404901143
curr_Factors:  [102.46690405]
mat_Sqrt:  [[0.15]]
grads:  [0.00490421]
Stock Position:  0.00490420744900682
Bond Position:  [1.82341362]


portfolio before change:  [2.32785636]
curr_Stock_Price:  102.8126976934106
curr_Factors:  [102.81269769]
mat_Sqrt:  [[0.15]]
grads:  [-0.01192488]
Stock Position:  -0.011924877694146272
Bond Position:  [3.5538852]


portfolio before change:  [2.30996743]
curr_Stock_Price:  104.3500874578879
curr_Factors:  [104.35008746]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280921]
Stock Position:  -0.02280920909178706
Bond Position:  [4.6901104]


portfolio before change:  [2.31450553]
curr_Stock_Price:  104.1768331790891
curr_Factors:  [104.17683318]
mat_Sqrt:  [[0.15]]
grads:  [-0.01154111]
Stock Position:  -0.011541109152031877
Bond Position:  [3.51682173]


portfolio before change:  [2.31781992]
curr_Stock_Price:  103.92774476430853
curr_Factors:  [103.92774476]
mat_Sqrt:  [[0.15]]
grads:  [-0.25697942]
Stock Position:  -0.25697941861079965
Bond Position:  [29.02511134]


portfolio before change:  [2.30389689]
curr_Stock_Price:  103.99604358053216
curr_Factors:  [103.99604358]
mat_Sqrt:  [[0.15]]
grads:  [0.03208584]
Stock Position:  0.03208583863979872
Bond Position:  [-1.03290338]


portfolio before change:  [2.24598439]
curr_Stock_Price:  102.19514391563912
curr_Factors:  [102.19514392]
mat_Sqrt:  [[0.15]]
grads:  [0.05371623]
Stock Position:  0.05371623219462155
Bond Position:  [-3.24355369]


portfolio before change:  [2.22836023]
curr_Stock_Price:  101.87459466104745
curr_Factors:  [101.87459466]
mat_Sqrt:  [[0.15]]
grads:  [-0.02809626]
Stock Position:  -0.028096256623004655
Bond Position:  [5.09065498]


portfolio before change:  [2.25613877]
curr_Stock_Price:  100.90855236643164
curr_Factors:  [100.90855237]
mat_Sqrt:  [[0.15]]
grads:  [-0.05796456]
Stock Position:  -0.05796456359448731
Bond Position:  [8.10525897]


portfolio before change:  [2.31495334]
curr_Stock_Price:  99.91136810362667
curr_Factors:  [99.9113681]
mat_Sqrt:  [[0.15]]
grads:  [0.09585971]
Stock Position:  0.09585970926623093
Bond Position:  [-7.26252136]


portfolio before change:  [2.27897346]
curr_Stock_Price:  99.54549998807101
curr_Factors:  [99.54549999]
mat_Sqrt:  [[0.15]]
grads:  [-0.17218696]
Stock Position:  -0.17218696200880657
Bond Position:  [19.41941068]


portfolio before change:  [2.08907498]
curr_Stock_Price:  100.66246063423463
curr_Factors:  [100.66246063]
mat_Sqrt:  [[0.15]]
grads:  [-0.10618437]
Stock Position:  -0.10618437252863318
Bond Position:  [12.7778552]


portfolio before change:  [2.08765314]
curr_Stock_Price:  100.69089392136013
curr_Factors:  [100.69089392]
mat_Sqrt:  [[0.15]]
grads:  [0.14497087]
Stock Position:  0.14497087455988136
Bond Position:  [-12.50959382]


portfolio before change:  [2.13122269]
curr_Stock_Price:  101.00222096325695
curr_Factors:  [101.00222096]
mat_Sqrt:  [[0.15]]
grads:  [0.04726594]
Stock Position:  0.047265941873240555
Bond Position:  [-2.64274241]


portfolio before change:  [2.09268821]
curr_Stock_Price:  100.19394082041069
curr_Factors:  [100.19394082]
mat_Sqrt:  [[0.15]]
grads:  [0.01524404]
Stock Position:  0.01524403913506769
Bond Position:  [0.56532785]


portfolio before change:  [2.09077533]
curr_Stock_Price:  100.0638213748932
curr_Factors:  [100.06382137]
mat_Sqrt:  [[0.15]]
grads:  [-0.08331233]
Stock Position:  -0.08331233191790083
Bond Position:  [10.42732563]


portfolio before change:  [2.09725277]
curr_Stock_Price:  100.00171848991968
curr_Factors:  [100.00171849]
mat_Sqrt:  [[0.15]]
grads:  [-0.03955662]
Stock Position:  -0.03955662435380595
Bond Position:  [6.05298318]


portfolio before change:  [2.07123017]
curr_Stock_Price:  100.67870405592654
curr_Factors:  [100.67870406]
mat_Sqrt:  [[0.15]]
grads:  [-0.03923122]
Stock Position:  -0.039231218070038335
Bond Position:  [6.02097837]


portfolio before change:  [2.02519464]
curr_Stock_Price:  101.87133087362098
curr_Factors:  [101.87133087]
mat_Sqrt:  [[0.15]]
grads:  [-0.03329475]
Stock Position:  -0.03329474988109742
Bond Position:  [5.41697512]


portfolio before change:  [2.04800919]
curr_Stock_Price:  101.20643954960836
curr_Factors:  [101.20643955]
mat_Sqrt:  [[0.15]]
grads:  [0.15243144]
Stock Position:  0.15243144486931334
Bond Position:  [-13.37903462]


portfolio before change:  [2.1309436]
curr_Stock_Price:  101.76148832586361
curr_Factors:  [101.76148833]
mat_Sqrt:  [[0.15]]
grads:  [0.01800361]
Stock Position:  0.01800360971265272
Bond Position:  [0.29886948]


portfolio before change:  [2.13163478]
curr_Stock_Price:  101.7978046861231
curr_Factors:  [101.79780469]
mat_Sqrt:  [[0.15]]
grads:  [0.15065654]
Stock Position:  0.15065654018439442
Bond Position:  [-13.20487027]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [2.13163478]
Stock Price:  101.73760320193969
PL:  [0.39403158]
Settle:  Tensor("sub_310:0", shape=(), dtype=float64)
PL:  Tensor("sub_311:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  156
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.34920740e-03]
 [ 3.21219745e-03]
 [ 1.51034018e-03]
 [ 9.46574624e-04]
 [ 1.36633030e-02]
 [ 1.52782147e-02]
 [ 2.72949518e-02]
 [-2.69555886e-03]
 [ 1.67658813e-02]
 [-3.95473196e-03]
 [ 4.66259269e-03]
 [ 1.16533585e-02]
 [-4.94514164e-03]
 [ 1.17734467e-02]
 [-6.39468332e-03]
 [-2.57881761e-02]
 [ 1.56731154e-03]
 [-3.08056569e-03]
 [-8.68791626e-03]
 [-2.37979673e-03]
 [ 4.35849118e-04]
 [ 1.01904452e-02]
 [ 4.75883814e-03]
 [ 5.79219216e-03]
 [-2.44848174e-03]
 [-5.06922594e-03]
 [-4.91935930e-03]
 [-2.33282822e-02]
 [-3.79522380e-02]
 [ 2.20545628e-02]
 [ 3.91066139e-03]
 [-5.27632631e-03]
 [-1.25351678e-02]
 [-9.97299449e-03]
 [-7.59392905e-03]
 [-7.25377692e-03]
 [ 2.19673218e-02]
 [ 8.21265778e-03]
 [ 2.34091881e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.25633405]
curr_Stock_Price:  99.40755652032227
curr_Factors:  [99.40755652]
mat_Sqrt:  [[0.15]]
grads:  [-0.02899472]
Stock Position:  -0.02899471601624838
Bond Position:  [-4.37404018]


portfolio before change:  [-7.25391906]
curr_Stock_Price:  99.30540763888867
curr_Factors:  [99.30540764]
mat_Sqrt:  [[0.15]]
grads:  [0.02141465]
Stock Position:  0.02141464969720556
Bond Position:  [-9.38050958]


portfolio before change:  [-7.25138415]
curr_Stock_Price:  99.47853870121446
curr_Factors:  [99.4785387]
mat_Sqrt:  [[0.15]]
grads:  [0.01006893]
Stock Position:  0.010068934531467875
Bond Position:  [-8.25302705]


portfolio before change:  [-7.24204875]
curr_Stock_Price:  100.50815128747543
curr_Factors:  [100.50815129]
mat_Sqrt:  [[0.15]]
grads:  [0.0063105]
Stock Position:  0.006310497493496418
Bond Position:  [-7.87630518]


portfolio before change:  [-7.25181332]
curr_Stock_Price:  99.1168235000766
curr_Factors:  [99.1168235]
mat_Sqrt:  [[0.15]]
grads:  [0.09108869]
Stock Position:  0.09108868642836711
Bond Position:  [-16.28023457]


portfolio before change:  [-7.16324544]
curr_Stock_Price:  100.11149179924861
curr_Factors:  [100.1114918]
mat_Sqrt:  [[0.15]]
grads:  [0.10185476]
Stock Position:  0.10185476472134437
Bond Position:  [-17.36007789]


portfolio before change:  [-7.18466789]
curr_Stock_Price:  99.92247461377676
curr_Factors:  [99.92247461]
mat_Sqrt:  [[0.15]]
grads:  [0.18196635]
Stock Position:  0.1819663452179658
Bond Position:  [-25.3671954]


portfolio before change:  [-7.07203059]
curr_Stock_Price:  100.5589022005279
curr_Factors:  [100.5589022]
mat_Sqrt:  [[0.15]]
grads:  [-0.01797039]
Stock Position:  -0.0179703923847108
Bond Position:  [-5.26494766]


portfolio before change:  [-7.05288678]
curr_Stock_Price:  99.45698077018011
curr_Factors:  [99.45698077]
mat_Sqrt:  [[0.15]]
grads:  [0.11177254]
Stock Position:  0.11177254228157572
Bond Position:  [-18.16944637]


portfolio before change:  [-7.01816414]
curr_Stock_Price:  99.78795623608106
curr_Factors:  [99.78795624]
mat_Sqrt:  [[0.15]]
grads:  [-0.02636488]
Stock Position:  -0.026364879725411256
Bond Position:  [-4.38726667]


portfolio before change:  [-7.02090103]
curr_Stock_Price:  99.87096258400855
curr_Factors:  [99.87096258]
mat_Sqrt:  [[0.15]]
grads:  [0.03108395]
Stock Position:  0.031083951281928708
Bond Position:  [-10.12528517]


portfolio before change:  [-7.02008102]
curr_Stock_Price:  99.93806316215996
curr_Factors:  [99.93806316]
mat_Sqrt:  [[0.15]]
grads:  [0.07768906]
Stock Position:  0.0776890568164342
Bond Position:  [-14.78417489]


portfolio before change:  [-7.07516488]
curr_Stock_Price:  99.25282229006211
curr_Factors:  [99.25282229]
mat_Sqrt:  [[0.15]]
grads:  [-0.03296761]
Stock Position:  -0.032967610935158424
Bond Position:  [-3.80303645]


portfolio before change:  [-7.13120514]
curr_Stock_Price:  100.93825992338753
curr_Factors:  [100.93825992]
mat_Sqrt:  [[0.15]]
grads:  [0.07848964]
Stock Position:  0.07848964491177807
Bond Position:  [-15.05381332]


portfolio before change:  [-7.09096157]
curr_Stock_Price:  101.47496017039629
curr_Factors:  [101.47496017]
mat_Sqrt:  [[0.15]]
grads:  [-0.04263122]
Stock Position:  -0.042631222141131624
Bond Position:  [-2.76496]


portfolio before change:  [-7.06738947]
curr_Stock_Price:  100.91392205459664
curr_Factors:  [100.91392205]
mat_Sqrt:  [[0.15]]
grads:  [-0.17192117]
Stock Position:  -0.17192117370429122
Bond Position:  [10.28185045]


portfolio before change:  [-6.8826706]
curr_Stock_Price:  99.84695886560418
curr_Factors:  [99.84695887]
mat_Sqrt:  [[0.15]]
grads:  [0.01044874]
Stock Position:  0.0104487436102662
Bond Position:  [-7.92594587]


portfolio before change:  [-6.88894711]
curr_Stock_Price:  99.34108841704574
curr_Factors:  [99.34108842]
mat_Sqrt:  [[0.15]]
grads:  [-0.0205371]
Stock Position:  -0.020537104582285907
Bond Position:  [-4.84876879]


portfolio before change:  [-6.88849916]
curr_Stock_Price:  99.28976269953604
curr_Factors:  [99.2897627]
mat_Sqrt:  [[0.15]]
grads:  [-0.05791944]
Stock Position:  -0.05791944172904196
Bond Position:  [-1.13769154]


portfolio before change:  [-6.86604948]
curr_Stock_Price:  98.89970532143911
curr_Factors:  [98.89970532]
mat_Sqrt:  [[0.15]]
grads:  [-0.01586531]
Stock Position:  -0.01586531153219328
Bond Position:  [-5.29697484]


portfolio before change:  [-6.84662908]
curr_Stock_Price:  97.63388970891775
curr_Factors:  [97.63388971]
mat_Sqrt:  [[0.15]]
grads:  [0.00290566]
Stock Position:  0.0029056607856681625
Bond Position:  [-7.13032005]


portfolio before change:  [-6.847573]
curr_Stock_Price:  97.6157958117274
curr_Factors:  [97.61579581]
mat_Sqrt:  [[0.15]]
grads:  [0.0679363]
Stock Position:  0.06793630138907154
Bond Position:  [-13.47922913]


portfolio before change:  [-6.85851664]
curr_Stock_Price:  97.47951188479922
curr_Factors:  [97.47951188]
mat_Sqrt:  [[0.15]]
grads:  [0.03172559]
Stock Position:  0.031725587586381096
Bond Position:  [-9.95111143]


portfolio before change:  [-6.82727234]
curr_Stock_Price:  98.503551839468
curr_Factors:  [98.50355184]
mat_Sqrt:  [[0.15]]
grads:  [0.03861461]
Stock Position:  0.03861461440833557
Bond Position:  [-10.63094901]


portfolio before change:  [-6.85166656]
curr_Stock_Price:  97.90623201077717
curr_Factors:  [97.90623201]
mat_Sqrt:  [[0.15]]
grads:  [-0.01632321]
Stock Position:  -0.016323211596954604
Bond Position:  [-5.25352242]


portfolio before change:  [-6.8485485]
curr_Stock_Price:  97.67497883511481
curr_Factors:  [97.67497884]
mat_Sqrt:  [[0.15]]
grads:  [-0.03379484]
Stock Position:  -0.033794839613763894
Bond Position:  [-3.54763826]


portfolio before change:  [-6.86238428]
curr_Stock_Price:  98.0712613195684
curr_Factors:  [98.07126132]
mat_Sqrt:  [[0.15]]
grads:  [-0.03279573]
Stock Position:  -0.032795728668844434
Bond Position:  [-3.64606581]


portfolio before change:  [-6.88063528]
curr_Stock_Price:  98.613868958724
curr_Factors:  [98.61386896]
mat_Sqrt:  [[0.15]]
grads:  [-0.15552188]
Stock Position:  -0.15552188112873955
Bond Position:  [8.45597912]


portfolio before change:  [-6.90616377]
curr_Stock_Price:  98.78481305755335
curr_Factors:  [98.78481306]
mat_Sqrt:  [[0.15]]
grads:  [-0.25301492]
Stock Position:  -0.2530149200752646
Bond Position:  [18.08786781]


portfolio before change:  [-6.66378826]
curr_Stock_Price:  97.83580032268567
curr_Factors:  [97.83580032]
mat_Sqrt:  [[0.15]]
grads:  [0.14703042]
Stock Position:  0.14703041835540084
Bond Position:  [-21.04862691]


portfolio before change:  [-6.68275388]
curr_Stock_Price:  97.72470511132069
curr_Factors:  [97.72470511]
mat_Sqrt:  [[0.15]]
grads:  [0.02607108]
Stock Position:  0.026071075937786042
Bond Position:  [-9.23054209]


portfolio before change:  [-6.70003447]
curr_Stock_Price:  97.10613858975644
curr_Factors:  [97.10613859]
mat_Sqrt:  [[0.15]]
grads:  [-0.03517551]
Stock Position:  -0.03517550874310632
Bond Position:  [-3.28427664]


portfolio before change:  [-6.70184705]
curr_Stock_Price:  97.14599643129759
curr_Factors:  [97.14599643]
mat_Sqrt:  [[0.15]]
grads:  [-0.08356779]
Stock Position:  -0.08356778545514935
Bond Position:  [1.41642874]


portfolio before change:  [-6.74162159]
curr_Stock_Price:  97.62407072861618
curr_Factors:  [97.62407073]
mat_Sqrt:  [[0.15]]
grads:  [-0.06648663]
Stock Position:  -0.06648662995614467
Bond Position:  [-0.25092613]


portfolio before change:  [-6.73864133]
curr_Stock_Price:  97.57877393052478
curr_Factors:  [97.57877393]
mat_Sqrt:  [[0.15]]
grads:  [-0.05062619]
Stock Position:  -0.05062619364383782
Bond Position:  [-1.79859942]


portfolio before change:  [-6.74732893]
curr_Stock_Price:  97.74593560091373
curr_Factors:  [97.7459356]
mat_Sqrt:  [[0.15]]
grads:  [-0.04835851]
Stock Position:  -0.04835851277669668
Bond Position:  [-2.02048085]


portfolio before change:  [-6.78523267]
curr_Stock_Price:  98.52451968503368
curr_Factors:  [98.52451969]
mat_Sqrt:  [[0.15]]
grads:  [0.14644881]
Stock Position:  0.14644881208589833
Bond Position:  [-21.21403154]


portfolio before change:  [-6.7606665]
curr_Stock_Price:  98.71037362213077
curr_Factors:  [98.71037362]
mat_Sqrt:  [[0.15]]
grads:  [0.05475105]
Stock Position:  0.05475105189436519
Bond Position:  [-12.16516329]


portfolio before change:  [-6.73944507]
curr_Stock_Price:  99.12574773268486
curr_Factors:  [99.12574773]
mat_Sqrt:  [[0.15]]
grads:  [0.15606125]
Stock Position:  0.156061253764831
Bond Position:  [-22.20913354]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-6.73944507]
Stock Price:  99.5325426438067
PL:  [-6.73944507]
Settle:  Tensor("sub_312:0", shape=(), dtype=float64)
PL:  Tensor("sub_313:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  157
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.54252874e-03]
 [-4.84096816e-03]
 [-1.86708536e-02]
 [-1.61009142e-02]
 [ 5.68054159e-03]
 [ 1.47747893e-02]
 [ 2.71544717e-02]
 [-3.14264469e-03]
 [ 8.48156338e-03]
 [-3.14700041e-03]
 [ 1.13554889e-02]
 [ 2.31833444e-03]
 [-4.19119811e-04]
 [ 1.03893595e-02]
 [-4.23489422e-03]
 [-1.08471660e-02]
 [-5.49984154e-03]
 [-1.18915212e-03]
 [-7.59127005e-03]
 [-2.47131225e-03]
 [ 3.18372933e-04]
 [ 8.65014529e-03]
 [ 4.76717418e-03]
 [ 5.63096935e-03]
 [-1.97411351e-03]
 [-6.07404803e-03]
 [ 4.11582566e-03]
 [-2.16635570e-02]
 [-3.58178046e-02]
 [ 2.19827034e-02]
 [ 3.88688700e-03]
 [-2.52443396e-03]
 [-1.25335102e-02]
 [-9.63255444e-03]
 [-6.95185153e-03]
 [-6.17173094e-03]
 [ 1.99336743e-02]
 [ 9.12957967e-03]
 [ 1.97632015e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.58375907]
curr_Stock_Price:  99.70857347529144
curr_Factors:  [99.70857348]
mat_Sqrt:  [[0.15]]
grads:  [-0.01695019]
Stock Position:  -0.016950191569584085
Bond Position:  [-0.89367965]


portfolio before change:  [-2.56559009]
curr_Stock_Price:  98.63007819919277
curr_Factors:  [98.6300782]
mat_Sqrt:  [[0.15]]
grads:  [-0.03227312]
Stock Position:  -0.03227312109323567
Bond Position:  [0.61751037]


portfolio before change:  [-2.57351092]
curr_Stock_Price:  98.87790150583655
curr_Factors:  [98.87790151]
mat_Sqrt:  [[0.15]]
grads:  [-0.12447236]
Stock Position:  -0.1244723571983015
Bond Position:  [9.73405455]


portfolio before change:  [-2.57519827]
curr_Stock_Price:  98.90123342357109
curr_Factors:  [98.90123342]
mat_Sqrt:  [[0.15]]
grads:  [-0.10733943]
Stock Position:  -0.10733942803277052
Bond Position:  [8.04080356]


portfolio before change:  [-2.67500221]
curr_Stock_Price:  99.84039533077188
curr_Factors:  [99.84039533]
mat_Sqrt:  [[0.15]]
grads:  [0.03787028]
Stock Position:  0.03787027723745301
Bond Position:  [-6.45598566]


portfolio before change:  [-2.66994469]
curr_Stock_Price:  99.99525462073927
curr_Factors:  [99.99525462]
mat_Sqrt:  [[0.15]]
grads:  [0.0984986]
Stock Position:  0.09849859561373282
Bond Position:  [-12.51933684]


portfolio before change:  [-2.63583159]
curr_Stock_Price:  100.35747418044937
curr_Factors:  [100.35747418]
mat_Sqrt:  [[0.15]]
grads:  [0.18102981]
Stock Position:  0.18102981124352446
Bond Position:  [-20.8035262]


portfolio before change:  [-2.69518615]
curr_Stock_Price:  100.04396803369485
curr_Factors:  [100.04396803]
mat_Sqrt:  [[0.15]]
grads:  [-0.02095096]
Stock Position:  -0.020950964577173728
Bond Position:  [-0.59916852]


portfolio before change:  [-2.69407169]
curr_Stock_Price:  99.987198983674
curr_Factors:  [99.98719898]
mat_Sqrt:  [[0.15]]
grads:  [0.05654376]
Stock Position:  0.05654375588976645
Bond Position:  [-8.34772346]


portfolio before change:  [-2.74293054]
curr_Stock_Price:  99.1415650351495
curr_Factors:  [99.14156504]
mat_Sqrt:  [[0.15]]
grads:  [-0.02098]
Stock Position:  -0.020980002701373717
Bond Position:  [-0.66294023]


portfolio before change:  [-2.73926656]
curr_Stock_Price:  98.96297364858519
curr_Factors:  [98.96297365]
mat_Sqrt:  [[0.15]]
grads:  [0.07570326]
Stock Position:  0.07570325928847546
Bond Position:  [-10.23108622]


portfolio before change:  [-2.76805648]
curr_Stock_Price:  98.59956848036653
curr_Factors:  [98.59956848]
mat_Sqrt:  [[0.15]]
grads:  [0.01545556]
Stock Position:  0.015455562951059605
Bond Position:  [-4.29196832]


portfolio before change:  [-2.76466141]
curr_Stock_Price:  98.85394974973143
curr_Factors:  [98.85394975]
mat_Sqrt:  [[0.15]]
grads:  [-0.00279413]
Stock Position:  -0.0027941320766414895
Bond Position:  [-2.48845041]


portfolio before change:  [-2.76733653]
curr_Stock_Price:  99.7000241928653
curr_Factors:  [99.70002419]
mat_Sqrt:  [[0.15]]
grads:  [0.0692624]
Stock Position:  0.06926239686049135
Bond Position:  [-9.67279917]


portfolio before change:  [-2.77681958]
curr_Stock_Price:  99.58056720505216
curr_Factors:  [99.58056721]
mat_Sqrt:  [[0.15]]
grads:  [-0.02823263]
Stock Position:  -0.028232628159199857
Bond Position:  [0.03460155]


portfolio before change:  [-2.73928306]
curr_Stock_Price:  98.25117667315098
curr_Factors:  [98.25117667]
mat_Sqrt:  [[0.15]]
grads:  [-0.07231444]
Stock Position:  -0.07231444027353094
Bond Position:  [4.36569578]


portfolio before change:  [-2.70121068]
curr_Stock_Price:  97.73223965249007
curr_Factors:  [97.73223965]
mat_Sqrt:  [[0.15]]
grads:  [-0.03666561]
Stock Position:  -0.03666561026975749
Bond Position:  [0.88220153]


portfolio before change:  [-2.70424917]
curr_Stock_Price:  97.81811781271956
curr_Factors:  [97.81811781]
mat_Sqrt:  [[0.15]]
grads:  [-0.00792768]
Stock Position:  -0.007927680780108234
Bond Position:  [-1.92877836]


portfolio before change:  [-2.70057059]
curr_Stock_Price:  97.32368600158664
curr_Factors:  [97.323686]
mat_Sqrt:  [[0.15]]
grads:  [-0.05060847]
Stock Position:  -0.05060846701594279
Bond Position:  [2.22483197]


portfolio before change:  [-2.6990033]
curr_Stock_Price:  97.29821265173997
curr_Factors:  [97.29821265]
mat_Sqrt:  [[0.15]]
grads:  [-0.01647542]
Stock Position:  -0.016475415005677046
Bond Position:  [-1.09597486]


portfolio before change:  [-2.7212156]
curr_Stock_Price:  98.63810581765759
curr_Factors:  [98.63810582]
mat_Sqrt:  [[0.15]]
grads:  [0.00212249]
Stock Position:  0.0021224862226139466
Bond Position:  [-2.93057362]


portfolio before change:  [-2.72178326]
curr_Stock_Price:  98.54325460979982
curr_Factors:  [98.54325461]
mat_Sqrt:  [[0.15]]
grads:  [0.05766764]
Stock Position:  0.05766763526776538
Bond Position:  [-8.40453973]


portfolio before change:  [-2.73440116]
curr_Stock_Price:  98.34266960598296
curr_Factors:  [98.34266961]
mat_Sqrt:  [[0.15]]
grads:  [0.03178116]
Stock Position:  0.03178116117954064
Bond Position:  [-5.85984539]


portfolio before change:  [-2.75191931]
curr_Stock_Price:  97.81450684697656
curr_Factors:  [97.81450685]
mat_Sqrt:  [[0.15]]
grads:  [0.0375398]
Stock Position:  0.037539795637268066
Bond Position:  [-6.42385591]


portfolio before change:  [-2.75728098]
curr_Stock_Price:  97.69307219859193
curr_Factors:  [97.6930722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01316076]
Stock Position:  -0.013160756755239483
Bond Position:  [-1.47156622]


portfolio before change:  [-2.76834854]
curr_Stock_Price:  98.52004625130546
curr_Factors:  [98.52004625]
mat_Sqrt:  [[0.15]]
grads:  [-0.04049365]
Stock Position:  -0.040493653564200684
Bond Position:  [1.22108808]


portfolio before change:  [-2.78396065]
curr_Stock_Price:  98.90936053275684
curr_Factors:  [98.90936053]
mat_Sqrt:  [[0.15]]
grads:  [0.02743884]
Stock Position:  0.02743883771037951
Bond Position:  [-5.49791854]


portfolio before change:  [-2.80341457]
curr_Stock_Price:  98.2254162631279
curr_Factors:  [98.22541626]
mat_Sqrt:  [[0.15]]
grads:  [-0.14442371]
Stock Position:  -0.1444237136283047
Bond Position:  [11.38266482]


portfolio before change:  [-2.81674444]
curr_Stock_Price:  98.32756566120936
curr_Factors:  [98.32756566]
mat_Sqrt:  [[0.15]]
grads:  [-0.23878536]
Stock Position:  -0.23878536403737713
Bond Position:  [20.66243912]


portfolio before change:  [-2.83492445]
curr_Stock_Price:  98.41451812108608
curr_Factors:  [98.41451812]
mat_Sqrt:  [[0.15]]
grads:  [0.14655136]
Stock Position:  0.14655135625673357
Bond Position:  [-17.25770556]


portfolio before change:  [-2.9345548]
curr_Stock_Price:  97.7494065437124
curr_Factors:  [97.74940654]
mat_Sqrt:  [[0.15]]
grads:  [0.02591258]
Stock Position:  0.02591258001531607
Bond Position:  [-5.46749412]


portfolio before change:  [-2.91957344]
curr_Stock_Price:  98.35393295187231
curr_Factors:  [98.35393295]
mat_Sqrt:  [[0.15]]
grads:  [-0.01682956]
Stock Position:  -0.016829559714976332
Bond Position:  [-1.26432005]


portfolio before change:  [-2.9066338]
curr_Stock_Price:  97.57567755106103
curr_Factors:  [97.57567755]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355673]
Stock Position:  -0.08355673437530256
Bond Position:  [5.24647117]


portfolio before change:  [-2.79771913]
curr_Stock_Price:  96.2800450841213
curr_Factors:  [96.28004508]
mat_Sqrt:  [[0.15]]
grads:  [-0.06421703]
Stock Position:  -0.06421702960913914
Bond Position:  [3.38509938]


portfolio before change:  [-2.82701333]
curr_Stock_Price:  96.74280970376071
curr_Factors:  [96.7428097]
mat_Sqrt:  [[0.15]]
grads:  [-0.04634568]
Stock Position:  -0.046345676874992546
Bond Position:  [1.65659766]


portfolio before change:  [-2.83054677]
curr_Stock_Price:  96.82351885392644
curr_Factors:  [96.82351885]
mat_Sqrt:  [[0.15]]
grads:  [-0.04114487]
Stock Position:  -0.041144872957031814
Bond Position:  [1.15324462]


portfolio before change:  [-2.8134454]
curr_Stock_Price:  96.41138489939404
curr_Factors:  [96.4113849]
mat_Sqrt:  [[0.15]]
grads:  [0.13289116]
Stock Position:  0.13289116231291023
Bond Position:  [-15.6256664]


portfolio before change:  [-2.8303696]
curr_Stock_Price:  96.29872978446907
curr_Factors:  [96.29872978]
mat_Sqrt:  [[0.15]]
grads:  [0.06086386]
Stock Position:  0.06086386447636215
Bond Position:  [-8.69148244]


portfolio before change:  [-2.89047062]
curr_Stock_Price:  95.32911478511174
curr_Factors:  [95.32911479]
mat_Sqrt:  [[0.15]]
grads:  [0.13175468]
Stock Position:  0.13175467655386408
Bond Position:  [-15.45052731]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.89047062]
Stock Price:  94.55107714480106
PL:  [-2.89047062]
Settle:  Tensor("sub_314:0", shape=(), dtype=float64)
PL:  Tensor("sub_315:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  158
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44624113e-03]
 [ 4.64253951e-03]
 [ 6.43212240e-03]
 [-3.47022644e-03]
 [ 5.41936372e-03]
 [ 1.94719626e-02]
 [ 1.69181556e-02]
 [-2.93174661e-03]
 [ 2.90996457e-03]
 [-5.11153683e-04]
 [ 5.57662381e-03]
 [ 4.41661690e-03]
 [-3.58469513e-03]
 [ 9.44238940e-03]
 [-3.83584892e-03]
 [-9.72263418e-03]
 [ 2.90772723e-03]
 [-3.26811728e-03]
 [-1.18153535e-02]
 [-2.24209294e-03]
 [ 4.07966555e-04]
 [-2.27655195e-02]
 [ 4.79840027e-03]
 [ 9.03034108e-03]
 [-4.73672431e-03]
 [-2.54993021e-03]
 [-3.32548216e-03]
 [-2.02276874e-03]
 [ 3.39242270e-02]
 [ 2.61098746e-02]
 [-3.08399830e-02]
 [ 5.86729189e-03]
 [-1.31317251e-02]
 [ 3.63032412e-03]
 [-6.54601065e-03]
 [ 1.38244306e-03]
 [ 2.41663684e-02]
 [ 2.16390015e-03]
 [ 2.05472769e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.2384159]
curr_Stock_Price:  100.1480721126718
curr_Factors:  [100.14807211]
mat_Sqrt:  [[0.15]]
grads:  [-0.00964161]
Stock Position:  -0.009641607562856511
Bond Position:  [5.20400431]


portfolio before change:  [4.24644522]
curr_Stock_Price:  99.38276644084748
curr_Factors:  [99.38276644]
mat_Sqrt:  [[0.15]]
grads:  [0.03095026]
Stock Position:  0.03095026337380525
Bond Position:  [1.17052242]


portfolio before change:  [4.2533156]
curr_Stock_Price:  99.60002007874088
curr_Factors:  [99.60002008]
mat_Sqrt:  [[0.15]]
grads:  [0.04288082]
Stock Position:  0.042880815970249626
Bond Position:  [-0.01761453]


portfolio before change:  [4.27596631]
curr_Stock_Price:  100.12829617718076
curr_Factors:  [100.12829618]
mat_Sqrt:  [[0.15]]
grads:  [-0.02313484]
Stock Position:  -0.023134842954113354
Bond Position:  [6.59241871]


portfolio before change:  [4.27749262]
curr_Stock_Price:  100.09794330647492
curr_Factors:  [100.09794331]
mat_Sqrt:  [[0.15]]
grads:  [0.03612909]
Stock Position:  0.036129091495625404
Bond Position:  [0.66104487]


portfolio before change:  [4.29111474]
curr_Stock_Price:  100.4726963326613
curr_Factors:  [100.47269633]
mat_Sqrt:  [[0.15]]
grads:  [0.12981308]
Stock Position:  0.1298130841638025
Bond Position:  [-8.75155584]


portfolio before change:  [4.41018954]
curr_Stock_Price:  101.39840280851806
curr_Factors:  [101.39840281]
mat_Sqrt:  [[0.15]]
grads:  [0.1127877]
Stock Position:  0.11278770419639463
Bond Position:  [-7.02630352]


portfolio before change:  [4.2891869]
curr_Stock_Price:  100.33335496602477
curr_Factors:  [100.33335497]
mat_Sqrt:  [[0.15]]
grads:  [-0.01954498]
Stock Position:  -0.019544977431360345
Bond Position:  [6.25020006]


portfolio before change:  [4.27514027]
curr_Stock_Price:  101.09201266344192
curr_Factors:  [101.09201266]
mat_Sqrt:  [[0.15]]
grads:  [0.01939976]
Stock Position:  0.01939976377622537
Bond Position:  [2.31397911]


portfolio before change:  [4.25641795]
curr_Stock_Price:  100.11202210105564
curr_Factors:  [100.1120221]
mat_Sqrt:  [[0.15]]
grads:  [-0.00340769]
Stock Position:  -0.003407691222107803
Bond Position:  [4.59756881]


portfolio before change:  [4.25746107]
curr_Stock_Price:  99.97457263108097
curr_Factors:  [99.97457263]
mat_Sqrt:  [[0.15]]
grads:  [0.03717749]
Stock Position:  0.0371774920413565
Bond Position:  [0.54065719]


portfolio before change:  [4.22072783]
curr_Stock_Price:  98.98470419801296
curr_Factors:  [98.9847042]
mat_Sqrt:  [[0.15]]
grads:  [0.02944411]
Stock Position:  0.029444112660209888
Bond Position:  [1.30621105]


portfolio before change:  [4.22483756]
curr_Stock_Price:  99.11873594246168
curr_Factors:  [99.11873594]
mat_Sqrt:  [[0.15]]
grads:  [-0.02389797]
Stock Position:  -0.02389796751226564
Bond Position:  [6.5935739]


portfolio before change:  [4.22108041]
curr_Stock_Price:  99.310442674139
curr_Factors:  [99.31044267]
mat_Sqrt:  [[0.15]]
grads:  [0.06294926]
Stock Position:  0.06294926265572379
Bond Position:  [-2.03043873]


portfolio before change:  [4.2113976]
curr_Stock_Price:  99.16065543548764
curr_Factors:  [99.16065544]
mat_Sqrt:  [[0.15]]
grads:  [-0.02557233]
Stock Position:  -0.02557232616065259
Bond Position:  [6.74716622]


portfolio before change:  [4.21321413]
curr_Stock_Price:  99.12260319682078
curr_Factors:  [99.1226032]
mat_Sqrt:  [[0.15]]
grads:  [-0.06481756]
Stock Position:  -0.06481756122209414
Bond Position:  [10.63809953]


portfolio before change:  [4.15371301]
curr_Stock_Price:  100.06109833373073
curr_Factors:  [100.06109833]
mat_Sqrt:  [[0.15]]
grads:  [0.01938485]
Stock Position:  0.019384848220395705
Bond Position:  [2.2140438]


portfolio before change:  [4.15443517]
curr_Stock_Price:  100.08407446575843
curr_Factors:  [100.08407447]
mat_Sqrt:  [[0.15]]
grads:  [-0.02178745]
Stock Position:  -0.0217874485000422
Bond Position:  [6.33501179]


portfolio before change:  [4.13875983]
curr_Stock_Price:  100.83988864504272
curr_Factors:  [100.83988865]
mat_Sqrt:  [[0.15]]
grads:  [-0.07876902]
Stock Position:  -0.07876902325315965
Bond Position:  [12.08181937]


portfolio before change:  [4.10988528]
curr_Stock_Price:  101.22563508673991
curr_Factors:  [101.22563509]
mat_Sqrt:  [[0.15]]
grads:  [-0.01494729]
Stock Position:  -0.014947286241979085
Bond Position:  [5.62293383]


portfolio before change:  [4.12223296]
curr_Stock_Price:  100.44657959138665
curr_Factors:  [100.44657959]
mat_Sqrt:  [[0.15]]
grads:  [0.00271978]
Stock Position:  0.0027197770338716334
Bond Position:  [3.84904066]


portfolio before change:  [4.12674557]
curr_Stock_Price:  101.92885034596318
curr_Factors:  [101.92885035]
mat_Sqrt:  [[0.15]]
grads:  [-0.15177013]
Stock Position:  -0.15177013007450277
Bond Position:  [19.59650044]


portfolio before change:  [3.99262455]
curr_Stock_Price:  102.82870286665047
curr_Factors:  [102.82870287]
mat_Sqrt:  [[0.15]]
grads:  [0.03198934]
Stock Position:  0.031989335133658245
Bond Position:  [0.70320271]


portfolio before change:  [4.00817195]
curr_Stock_Price:  103.31197333548464
curr_Factors:  [103.31197334]
mat_Sqrt:  [[0.15]]
grads:  [0.06020227]
Stock Position:  0.06020227383902959
Bond Position:  [-2.21144376]


portfolio before change:  [3.94924383]
curr_Stock_Price:  102.33772976633297
curr_Factors:  [102.33772977]
mat_Sqrt:  [[0.15]]
grads:  [-0.03157816]
Stock Position:  -0.03157816204670579
Bond Position:  [7.18088124]


portfolio before change:  [3.9212124]
curr_Stock_Price:  103.25384059248833
curr_Factors:  [103.25384059]
mat_Sqrt:  [[0.15]]
grads:  [-0.01699953]
Stock Position:  -0.016999534754080562
Bond Position:  [5.67647965]


portfolio before change:  [3.92197941]
curr_Stock_Price:  103.25046338036171
curr_Factors:  [103.25046338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02216988]
Stock Position:  -0.02216988108478011
Bond Position:  [6.21102991]


portfolio before change:  [3.90285338]
curr_Stock_Price:  104.14818873289845
curr_Factors:  [104.14818873]
mat_Sqrt:  [[0.15]]
grads:  [-0.01348512]
Stock Position:  -0.013485124920838375
Bond Position:  [5.30730471]


portfolio before change:  [3.89540314]
curr_Stock_Price:  104.74986562566627
curr_Factors:  [104.74986563]
mat_Sqrt:  [[0.15]]
grads:  [0.22616151]
Stock Position:  0.22616151304381535
Bond Position:  [-19.79498496]


portfolio before change:  [4.04640843]
curr_Stock_Price:  105.42849485526632
curr_Factors:  [105.42849486]
mat_Sqrt:  [[0.15]]
grads:  [0.17406583]
Stock Position:  0.17406583068502246
Bond Position:  [-14.30509011]


portfolio before change:  [4.29743845]
curr_Stock_Price:  106.88092388625984
curr_Factors:  [106.88092389]
mat_Sqrt:  [[0.15]]
grads:  [-0.20559989]
Stock Position:  -0.20559988684261216
Bond Position:  [26.2721443]


portfolio before change:  [4.51508524]
curr_Stock_Price:  105.83830378818689
curr_Factors:  [105.83830379]
mat_Sqrt:  [[0.15]]
grads:  [0.03911528]
Stock Position:  0.039115279256245694
Bond Position:  [0.37519044]


portfolio before change:  [4.5192277]
curr_Stock_Price:  105.9430083843434
curr_Factors:  [105.94300838]
mat_Sqrt:  [[0.15]]
grads:  [-0.08754483]
Stock Position:  -0.08754483394008193
Bond Position:  [13.79399077]


portfolio before change:  [4.51207109]
curr_Stock_Price:  106.04445308328982
curr_Factors:  [106.04445308]
mat_Sqrt:  [[0.15]]
grads:  [0.02420216]
Stock Position:  0.02420216080513423
Bond Position:  [1.94556619]


portfolio before change:  [4.50492374]
curr_Stock_Price:  105.73908520246279
curr_Factors:  [105.7390852]
mat_Sqrt:  [[0.15]]
grads:  [-0.04364007]
Stock Position:  -0.043640071001596996
Bond Position:  [9.11938493]


portfolio before change:  [4.53935648]
curr_Stock_Price:  104.97619136308332
curr_Factors:  [104.97619136]
mat_Sqrt:  [[0.15]]
grads:  [0.00921629]
Stock Position:  0.009216287042467271
Bond Position:  [3.57186576]


portfolio before change:  [4.54165569]
curr_Stock_Price:  105.1772157093687
curr_Factors:  [105.17721571]
mat_Sqrt:  [[0.15]]
grads:  [0.16110912]
Stock Position:  0.1611091228139773
Bond Position:  [-12.40335328]


portfolio before change:  [4.50273816]
curr_Stock_Price:  104.94527965727238
curr_Factors:  [104.94527966]
mat_Sqrt:  [[0.15]]
grads:  [0.014426]
Stock Position:  0.014426001022529252
Bond Position:  [2.98879744]


portfolio before change:  [4.49432478]
curr_Stock_Price:  104.33617088021822
curr_Factors:  [104.33617088]
mat_Sqrt:  [[0.15]]
grads:  [0.13698185]
Stock Position:  0.13698184596116378
Bond Position:  [-9.79783651]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.49432478]
Stock Price:  103.75764339901578
PL:  [0.73668138]
Settle:  Tensor("sub_316:0", shape=(), dtype=float64)
PL:  Tensor("sub_317:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  159
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.38353503e-03]
 [-1.52468149e-02]
 [-2.29327304e-03]
 [ 4.88503851e-02]
 [ 3.74215201e-03]
 [ 2.82167159e-02]
 [ 1.71314306e-02]
 [-1.18648818e-03]
 [ 4.46345164e-03]
 [ 9.32886840e-03]
 [ 1.29286140e-02]
 [ 1.18014651e-02]
 [-6.57252459e-03]
 [ 1.01209615e-02]
 [-3.15267072e-04]
 [-1.19320649e-02]
 [-5.68787595e-03]
 [-2.79100795e-03]
 [-7.53196756e-03]
 [-2.37940861e-03]
 [ 3.16477853e-04]
 [ 8.44301041e-03]
 [ 4.76848751e-03]
 [ 6.01000133e-03]
 [-9.78368022e-04]
 [-4.48462087e-03]
 [-5.63280904e-03]
 [-2.05100651e-02]
 [-3.44059425e-02]
 [ 2.18279349e-02]
 [ 6.70474770e-03]
 [-1.23645777e-03]
 [-1.25334844e-02]
 [-8.20740889e-03]
 [-8.65343484e-03]
 [-7.51360659e-03]
 [ 2.23830234e-02]
 [ 8.24753319e-03]
 [ 2.26181585e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.0539733]
curr_Stock_Price:  99.54943715986172
curr_Factors:  [99.54943716]
mat_Sqrt:  [[0.15]]
grads:  [-0.0225569]
Stock Position:  -0.02255690018253329
Bond Position:  [-2.80844658]


portfolio before change:  [-5.06831659]
curr_Stock_Price:  100.1697446677133
curr_Factors:  [100.16974467]
mat_Sqrt:  [[0.15]]
grads:  [-0.10164543]
Stock Position:  -0.10164543240454185
Bond Position:  [5.11348042]


portfolio before change:  [-5.14159872]
curr_Stock_Price:  100.89699181470041
curr_Factors:  [100.89699181]
mat_Sqrt:  [[0.15]]
grads:  [-0.01528849]
Stock Position:  -0.015288486955563696
Bond Position:  [-3.59903637]


portfolio before change:  [-5.15771041]
curr_Stock_Price:  101.92140848438734
curr_Factors:  [101.92140848]
mat_Sqrt:  [[0.15]]
grads:  [0.32566923]
Stock Position:  0.32566923368306244
Bond Position:  [-38.3503774]


portfolio before change:  [-5.19238753]
curr_Stock_Price:  101.82964966378204
curr_Factors:  [101.82964966]
mat_Sqrt:  [[0.15]]
grads:  [0.02494768]
Stock Position:  0.024947680086284844
Bond Position:  [-7.73280105]


portfolio before change:  [-5.20756418]
curr_Stock_Price:  101.26005812266438
curr_Factors:  [101.26005812]
mat_Sqrt:  [[0.15]]
grads:  [0.18811144]
Stock Position:  0.18811143949943457
Bond Position:  [-24.25573947]


portfolio before change:  [-5.18735848]
curr_Stock_Price:  101.38359049324279
curr_Factors:  [101.38359049]
mat_Sqrt:  [[0.15]]
grads:  [0.11420954]
Stock Position:  0.11420953720881531
Bond Position:  [-16.76633143]


portfolio before change:  [-5.19384786]
curr_Stock_Price:  101.34512209850506
curr_Factors:  [101.3451221]
mat_Sqrt:  [[0.15]]
grads:  [-0.00790992]
Stock Position:  -0.00790992122571019
Bond Position:  [-4.39221593]


portfolio before change:  [-5.19520578]
curr_Stock_Price:  101.44738063584039
curr_Factors:  [101.44738064]
mat_Sqrt:  [[0.15]]
grads:  [0.02975634]
Stock Position:  0.02975634423669832
Bond Position:  [-8.21390896]


portfolio before change:  [-5.20303991]
curr_Stock_Price:  101.21861160604193
curr_Factors:  [101.21861161]
mat_Sqrt:  [[0.15]]
grads:  [0.06219246]
Stock Position:  0.062192456030675004
Bond Position:  [-11.49807396]


portfolio before change:  [-5.25100377]
curr_Stock_Price:  100.47050622294901
curr_Factors:  [100.47050622]
mat_Sqrt:  [[0.15]]
grads:  [0.08619076]
Stock Position:  0.08619075986668381
Bond Position:  [-13.91063305]


portfolio before change:  [-5.28046949]
curr_Stock_Price:  100.14881536820529
curr_Factors:  [100.14881537]
mat_Sqrt:  [[0.15]]
grads:  [0.07867643]
Stock Position:  0.07867643428177591
Bond Position:  [-13.15982118]


portfolio before change:  [-5.33450943]
curr_Stock_Price:  99.48286165859207
curr_Factors:  [99.48286166]
mat_Sqrt:  [[0.15]]
grads:  [-0.04381683]
Stock Position:  -0.04381683059155146
Bond Position:  [-0.97548574]


portfolio before change:  [-5.31777686]
curr_Stock_Price:  99.09820324439583
curr_Factors:  [99.09820324]
mat_Sqrt:  [[0.15]]
grads:  [0.06747308]
Stock Position:  0.0674730763811684
Bond Position:  [-12.0042375]


portfolio before change:  [-5.37207618]
curr_Stock_Price:  98.3156882655497
curr_Factors:  [98.31568827]
mat_Sqrt:  [[0.15]]
grads:  [-0.00210178]
Stock Position:  -0.0021017804770838656
Bond Position:  [-5.16543819]


portfolio before change:  [-5.37188923]
curr_Stock_Price:  97.91951556574304
curr_Factors:  [97.91951557]
mat_Sqrt:  [[0.15]]
grads:  [-0.0795471]
Stock Position:  -0.07954709908971935
Bond Position:  [2.41732418]


portfolio before change:  [-5.35156742]
curr_Stock_Price:  97.66784546472344
curr_Factors:  [97.66784546]
mat_Sqrt:  [[0.15]]
grads:  [-0.03791917]
Stock Position:  -0.037919173006670095
Bond Position:  [-1.64808349]


portfolio before change:  [-5.38554161]
curr_Stock_Price:  98.55837570594241
curr_Factors:  [98.55837571]
mat_Sqrt:  [[0.15]]
grads:  [-0.01860672]
Stock Position:  -0.01860671966364718
Bond Position:  [-3.55169355]


portfolio before change:  [-5.37544708]
curr_Stock_Price:  97.99199296522517
curr_Factors:  [97.99199297]
mat_Sqrt:  [[0.15]]
grads:  [-0.05021312]
Stock Position:  -0.05021311709936644
Bond Position:  [-0.45496366]


portfolio before change:  [-5.37882237]
curr_Stock_Price:  98.05807957913389
curr_Factors:  [98.05807958]
mat_Sqrt:  [[0.15]]
grads:  [-0.01586272]
Stock Position:  -0.01586272409787441
Bond Position:  [-3.82335411]


portfolio before change:  [-5.38997203]
curr_Stock_Price:  98.73083350809264
curr_Factors:  [98.73083351]
mat_Sqrt:  [[0.15]]
grads:  [0.00210985]
Stock Position:  0.0021098523536405974
Bond Position:  [-5.59827951]


portfolio before change:  [-5.39002561]
curr_Stock_Price:  99.03713163585415
curr_Factors:  [99.03713164]
mat_Sqrt:  [[0.15]]
grads:  [0.05628674]
Stock Position:  0.05628673606627002
Bond Position:  [-10.9645025]


portfolio before change:  [-5.34930739]
curr_Stock_Price:  99.78488986105872
curr_Factors:  [99.78488986]
mat_Sqrt:  [[0.15]]
grads:  [0.03178992]
Stock Position:  0.031789916707755723
Bond Position:  [-8.52146073]


portfolio before change:  [-5.36942674]
curr_Stock_Price:  99.18551439294653
curr_Factors:  [99.18551439]
mat_Sqrt:  [[0.15]]
grads:  [0.04006668]
Stock Position:  0.04006667555464906
Bond Position:  [-9.34346056]


portfolio before change:  [-5.45495768]
curr_Stock_Price:  97.0799506729999
curr_Factors:  [97.07995067]
mat_Sqrt:  [[0.15]]
grads:  [-0.00652245]
Stock Position:  -0.006522453478562133
Bond Position:  [-4.82175822]


portfolio before change:  [-5.45615147]
curr_Stock_Price:  97.17056603980907
curr_Factors:  [97.17056604]
mat_Sqrt:  [[0.15]]
grads:  [-0.02989747]
Stock Position:  -0.029897472464387332
Bond Position:  [-2.55099715]


portfolio before change:  [-5.47908853]
curr_Stock_Price:  97.92709028740857
curr_Factors:  [97.92709029]
mat_Sqrt:  [[0.15]]
grads:  [-0.03755206]
Stock Position:  -0.037552060254794
Bond Position:  [-1.80172453]


portfolio before change:  [-5.47747689]
curr_Stock_Price:  97.87817510644662
curr_Factors:  [97.87817511]
mat_Sqrt:  [[0.15]]
grads:  [-0.13673377]
Stock Position:  -0.13673376728177034
Bond Position:  [7.90577472]


portfolio before change:  [-5.51371656]
curr_Stock_Price:  98.15044105795725
curr_Factors:  [98.15044106]
mat_Sqrt:  [[0.15]]
grads:  [-0.22937295]
Stock Position:  -0.2293729501760646
Bond Position:  [16.99933967]


portfolio before change:  [-5.66632869]
curr_Stock_Price:  98.8250505902853
curr_Factors:  [98.82505059]
mat_Sqrt:  [[0.15]]
grads:  [0.14551957]
Stock Position:  0.14551956633135438
Bond Position:  [-20.04730719]


portfolio before change:  [-5.66786626]
curr_Stock_Price:  98.83170606163291
curr_Factors:  [98.83170606]
mat_Sqrt:  [[0.15]]
grads:  [0.04469832]
Stock Position:  0.04469831801881719
Bond Position:  [-10.08547728]


portfolio before change:  [-5.66538038]
curr_Stock_Price:  98.91552674621697
curr_Factors:  [98.91552675]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824305]
Stock Position:  -0.00824305180890663
Bond Position:  [-4.85001456]


portfolio before change:  [-5.66331409]
curr_Stock_Price:  98.59130529550887
curr_Factors:  [98.5913053]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355656]
Stock Position:  -0.08355656283411839
Bond Position:  [2.5746365]


portfolio before change:  [-5.64059076]
curr_Stock_Price:  98.32320570011137
curr_Factors:  [98.3232057]
mat_Sqrt:  [[0.15]]
grads:  [-0.05471606]
Stock Position:  -0.05471605926016236
Bond Position:  [-0.26073241]


portfolio before change:  [-5.67617156]
curr_Stock_Price:  98.9728907892578
curr_Factors:  [98.97289079]
mat_Sqrt:  [[0.15]]
grads:  [-0.05768957]
Stock Position:  -0.05768956562205943
Bond Position:  [0.03353152]


portfolio before change:  [-5.68281917]
curr_Stock_Price:  99.08819408667028
curr_Factors:  [99.08819409]
mat_Sqrt:  [[0.15]]
grads:  [-0.05009071]
Stock Position:  -0.05009071058432998
Bond Position:  [-0.71942112]


portfolio before change:  [-5.68429624]
curr_Stock_Price:  99.11588670596744
curr_Factors:  [99.11588671]
mat_Sqrt:  [[0.15]]
grads:  [0.14922016]
Stock Position:  0.14922015604249936
Bond Position:  [-20.47438432]


portfolio before change:  [-5.81897961]
curr_Stock_Price:  98.23045735037589
curr_Factors:  [98.23045735]
mat_Sqrt:  [[0.15]]
grads:  [0.05498355]
Stock Position:  0.0549835546124271
Bond Position:  [-11.22003933]


portfolio before change:  [-5.84439323]
curr_Stock_Price:  97.79376255629703
curr_Factors:  [97.79376256]
mat_Sqrt:  [[0.15]]
grads:  [0.15078772]
Stock Position:  0.15078772320063857
Bond Position:  [-20.59049203]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.84439323]
Stock Price:  99.13646811664077
PL:  [-5.84439323]
Settle:  Tensor("sub_318:0", shape=(), dtype=float64)
PL:  Tensor("sub_319:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  160
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.38099230e-03]
 [-9.58812921e-03]
 [-5.41451624e-03]
 [-6.43892619e-03]
 [ 1.33558890e-02]
 [ 1.61469750e-02]
 [ 2.72797414e-02]
 [-2.72678682e-03]
 [ 2.74443444e-03]
 [ 1.18326812e-02]
 [ 2.72361270e-02]
 [ 9.67282131e-03]
 [-1.17909272e-02]
 [ 1.12413881e-02]
 [-7.13201170e-03]
 [-2.20145447e-02]
 [ 3.44546319e-03]
 [ 1.01108296e-03]
 [-1.09255874e-02]
 [-2.23148219e-03]
 [ 1.49606494e-04]
 [-3.08462066e-02]
 [ 4.80066280e-03]
 [ 8.06863954e-03]
 [-4.61778785e-03]
 [-2.33335947e-03]
 [-2.32027724e-03]
 [-7.90362415e-03]
 [-5.79315865e-03]
 [ 2.38453674e-02]
 [-1.34479240e-02]
 [ 6.15827197e-03]
 [-1.30452709e-02]
 [ 6.09024510e-04]
 [-5.71637933e-03]
 [-1.96545150e-03]
 [ 2.41402121e-02]
 [-3.65115039e-04]
 [ 2.08020907e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.04861611]
curr_Stock_Price:  99.5497822810727
curr_Factors:  [99.54978228]
mat_Sqrt:  [[0.15]]
grads:  [-0.02253995]
Stock Position:  -0.022539948669689128
Bond Position:  [-2.80476913]


portfolio before change:  [-5.07498687]
curr_Stock_Price:  100.70418343999864
curr_Factors:  [100.70418344]
mat_Sqrt:  [[0.15]]
grads:  [-0.06392086]
Stock Position:  -0.0639208613859003
Bond Position:  [1.36211128]


portfolio before change:  [-5.11918573]
curr_Stock_Price:  101.39830946942372
curr_Factors:  [101.39830947]
mat_Sqrt:  [[0.15]]
grads:  [-0.03609677]
Stock Position:  -0.036096774910956725
Bond Position:  [-1.45903378]


portfolio before change:  [-5.05663741]
curr_Stock_Price:  99.66046130250879
curr_Factors:  [99.6604613]
mat_Sqrt:  [[0.15]]
grads:  [-0.04292617]
Stock Position:  -0.04292617460203288
Bond Position:  [-0.77859504]


portfolio before change:  [-5.03779736]
curr_Stock_Price:  99.21929974306556
curr_Factors:  [99.21929974]
mat_Sqrt:  [[0.15]]
grads:  [0.08903926]
Stock Position:  0.08903926014849828
Bond Position:  [-13.8722104]


portfolio before change:  [-4.99826679]
curr_Stock_Price:  99.68274361846679
curr_Factors:  [99.68274362]
mat_Sqrt:  [[0.15]]
grads:  [0.1076465]
Stock Position:  0.10764649989544967
Bond Position:  [-15.72876524]


portfolio before change:  [-4.96935674]
curr_Stock_Price:  99.96957386345213
curr_Factors:  [99.96957386]
mat_Sqrt:  [[0.15]]
grads:  [0.18186494]
Stock Position:  0.18186494270892625
Bond Position:  [-23.15031756]


portfolio before change:  [-4.87037845]
curr_Stock_Price:  100.52972721297222
curr_Factors:  [100.52972721]
mat_Sqrt:  [[0.15]]
grads:  [-0.01817858]
Stock Position:  -0.018178578771887152
Bond Position:  [-3.04289089]


portfolio before change:  [-4.87976385]
curr_Stock_Price:  101.02509083492643
curr_Factors:  [101.02509083]
mat_Sqrt:  [[0.15]]
grads:  [0.01829623]
Stock Position:  0.018296229603018528
Bond Position:  [-6.7281421]


portfolio before change:  [-4.8588938]
curr_Stock_Price:  102.21173495527111
curr_Factors:  [102.21173496]
mat_Sqrt:  [[0.15]]
grads:  [0.07888454]
Stock Position:  0.07888454128447467
Bond Position:  [-12.92181963]


portfolio before change:  [-4.87069109]
curr_Stock_Price:  102.08266082025287
curr_Factors:  [102.08266082]
mat_Sqrt:  [[0.15]]
grads:  [0.18157418]
Stock Position:  0.1815741800524623
Bond Position:  [-23.40626652]


portfolio before change:  [-4.94589419]
curr_Stock_Price:  101.68460235616357
curr_Factors:  [101.68460236]
mat_Sqrt:  [[0.15]]
grads:  [0.06448548]
Stock Position:  0.06448547542229806
Bond Position:  [-11.50307412]


portfolio before change:  [-4.91252813]
curr_Stock_Price:  102.2243212892061
curr_Factors:  [102.22432129]
mat_Sqrt:  [[0.15]]
grads:  [-0.07860618]
Stock Position:  -0.0786061815032163
Bond Position:  [3.12293542]


portfolio before change:  [-4.90299998]
curr_Stock_Price:  102.1080739365111
curr_Factors:  [102.10807394]
mat_Sqrt:  [[0.15]]
grads:  [0.07494259]
Stock Position:  0.07494258753461212
Bond Position:  [-12.55524325]


portfolio before change:  [-4.97245258]
curr_Stock_Price:  101.2022725499475
curr_Factors:  [101.20227255]
mat_Sqrt:  [[0.15]]
grads:  [-0.04754674]
Stock Position:  -0.047546744642998094
Bond Position:  [-0.16061397]


portfolio before change:  [-4.94231381]
curr_Stock_Price:  100.5679736347668
curr_Factors:  [100.56797363]
mat_Sqrt:  [[0.15]]
grads:  [-0.14676363]
Stock Position:  -0.14676363163134504
Bond Position:  [9.81740722]


portfolio before change:  [-4.87930366]
curr_Stock_Price:  100.14700488718655
curr_Factors:  [100.14700489]
mat_Sqrt:  [[0.15]]
grads:  [0.02296975]
Stock Position:  0.022969754613846555
Bond Position:  [-7.17965579]


portfolio before change:  [-4.85134389]
curr_Stock_Price:  101.40332156089491
curr_Factors:  [101.40332156]
mat_Sqrt:  [[0.15]]
grads:  [0.00674055]
Stock Position:  0.006740553063989509
Bond Position:  [-5.53485836]


portfolio before change:  [-4.85444107]
curr_Stock_Price:  101.04648441159367
curr_Factors:  [101.04648441]
mat_Sqrt:  [[0.15]]
grads:  [-0.07283725]
Stock Position:  -0.07283724943137197
Bond Position:  [2.50550692]


portfolio before change:  [-4.85202568]
curr_Stock_Price:  101.01762305836722
curr_Factors:  [101.01762306]
mat_Sqrt:  [[0.15]]
grads:  [-0.01487655]
Stock Position:  -0.014876547932360476
Bond Position:  [-3.34923217]


portfolio before change:  [-4.85442297]
curr_Stock_Price:  101.15062496075996
curr_Factors:  [101.15062496]
mat_Sqrt:  [[0.15]]
grads:  [0.00099738]
Stock Position:  0.0009973766284611554
Bond Position:  [-4.95530824]


portfolio before change:  [-4.85367336]
curr_Stock_Price:  102.52328580214748
curr_Factors:  [102.5232858]
mat_Sqrt:  [[0.15]]
grads:  [-0.20564138]
Stock Position:  -0.20564137740717495
Bond Position:  [16.22935635]


portfolio before change:  [-4.95196126]
curr_Stock_Price:  103.0111092826013
curr_Factors:  [103.01110928]
mat_Sqrt:  [[0.15]]
grads:  [0.03200442]
Stock Position:  0.032004418685463366
Bond Position:  [-8.24877193]


portfolio before change:  [-4.97878264]
curr_Stock_Price:  102.20527605523134
curr_Factors:  [102.20527606]
mat_Sqrt:  [[0.15]]
grads:  [0.05379093]
Stock Position:  0.053790930237316875
Bond Position:  [-10.47649951]


portfolio before change:  [-4.97864062]
curr_Stock_Price:  102.23226327865366
curr_Factors:  [102.23226328]
mat_Sqrt:  [[0.15]]
grads:  [-0.03078525]
Stock Position:  -0.030785252307672113
Bond Position:  [-1.8313946]


portfolio before change:  [-5.01163416]
curr_Stock_Price:  103.29655887687919
curr_Factors:  [103.29655888]
mat_Sqrt:  [[0.15]]
grads:  [-0.01555573]
Stock Position:  -0.015555729806809016
Bond Position:  [-3.4047808]


portfolio before change:  [-5.00615637]
curr_Stock_Price:  102.91705754621397
curr_Factors:  [102.91705755]
mat_Sqrt:  [[0.15]]
grads:  [-0.01546851]
Stock Position:  -0.015468514901951428
Bond Position:  [-3.41418233]


portfolio before change:  [-5.01118119]
curr_Stock_Price:  103.2143079447414
curr_Factors:  [103.21430794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05269083]
Stock Position:  -0.052690827662859034
Bond Position:  [0.42726612]


portfolio before change:  [-4.95736374]
curr_Stock_Price:  102.19393983913382
curr_Factors:  [102.19393984]
mat_Sqrt:  [[0.15]]
grads:  [-0.03862106]
Stock Position:  -0.03862105766663862
Bond Position:  [-1.01052569]


portfolio before change:  [-4.9832946]
curr_Stock_Price:  102.86208675891432
curr_Factors:  [102.86208676]
mat_Sqrt:  [[0.15]]
grads:  [0.15896912]
Stock Position:  0.15896911608593992
Bond Position:  [-21.33518961]


portfolio before change:  [-4.83205392]
curr_Stock_Price:  103.83024808790789
curr_Factors:  [103.83024809]
mat_Sqrt:  [[0.15]]
grads:  [-0.08965283]
Stock Position:  -0.08965282639097619
Bond Position:  [4.47662129]


portfolio before change:  [-4.89047757]
curr_Stock_Price:  104.4881555906707
curr_Factors:  [104.48815559]
mat_Sqrt:  [[0.15]]
grads:  [0.04105515]
Stock Position:  0.04105514649056426
Bond Position:  [-9.18025411]


portfolio before change:  [-4.88007516]
curr_Stock_Price:  104.76948498973834
curr_Factors:  [104.76948499]
mat_Sqrt:  [[0.15]]
grads:  [-0.08696847]
Stock Position:  -0.08696847298733544
Bond Position:  [4.23156697]


portfolio before change:  [-4.81939091]
curr_Stock_Price:  104.0777945017459
curr_Factors:  [104.0777945]
mat_Sqrt:  [[0.15]]
grads:  [0.00406016]
Stock Position:  0.004060163397603881
Bond Position:  [-5.24196376]


portfolio before change:  [-4.82281995]
curr_Stock_Price:  103.39463095715793
curr_Factors:  [103.39463096]
mat_Sqrt:  [[0.15]]
grads:  [-0.0381092]
Stock Position:  -0.03810919553798221
Bond Position:  [-0.88253374]


portfolio before change:  [-4.8193044]
curr_Stock_Price:  103.29948649857364
curr_Factors:  [103.2994865]
mat_Sqrt:  [[0.15]]
grads:  [-0.01310301]
Stock Position:  -0.0131030100174318
Bond Position:  [-3.46577019]


portfolio before change:  [-4.8372227]
curr_Stock_Price:  104.63391712050057
curr_Factors:  [104.63391712]
mat_Sqrt:  [[0.15]]
grads:  [0.16093475]
Stock Position:  0.16093474740602767
Bond Position:  [-21.67645573]


portfolio before change:  [-5.02689817]
curr_Stock_Price:  103.4721683537248
curr_Factors:  [103.47216835]
mat_Sqrt:  [[0.15]]
grads:  [-0.0024341]
Stock Position:  -0.0024341002591784433
Bond Position:  [-4.77503654]


portfolio before change:  [-5.02864201]
curr_Stock_Price:  103.94335631716648
curr_Factors:  [103.94335632]
mat_Sqrt:  [[0.15]]
grads:  [0.1386806]
Stock Position:  0.13868060483857625
Bond Position:  [-19.44356953]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.02864201]
Stock Price:  103.38944326714635
PL:  [-8.41808528]
Settle:  Tensor("sub_320:0", shape=(), dtype=float64)
PL:  Tensor("sub_321:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  161
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.63974957e-03]
 [-1.65078940e-02]
 [-1.46780980e-02]
 [-2.67703640e-02]
 [ 1.35016162e-02]
 [ 1.72372075e-02]
 [ 2.08769509e-02]
 [-3.37705091e-03]
 [ 1.18427452e-02]
 [ 1.58035129e-03]
 [-6.79003679e-03]
 [ 1.88609600e-03]
 [-6.99956089e-03]
 [ 1.24260396e-02]
 [-6.03707447e-03]
 [-2.63046150e-02]
 [ 4.26138003e-03]
 [ 9.93758795e-04]
 [-1.11724277e-03]
 [-2.31668382e-03]
 [-6.34377616e-04]
 [-3.84649043e-02]
 [ 4.83585470e-03]
 [ 1.27127015e-02]
 [-5.80973257e-03]
 [ 1.49072973e-02]
 [-1.65917964e-02]
 [ 1.17934253e-02]
 [ 8.54608038e-02]
 [ 2.79380339e-02]
 [-4.22840515e-02]
 [ 2.71902399e-03]
 [-1.31943569e-02]
 [ 3.83418433e-03]
 [-7.11049135e-03]
 [ 8.06565783e-03]
 [ 2.50528284e-02]
 [ 8.69914436e-03]
 [ 1.88600178e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-16.41152681]
curr_Stock_Price:  98.81776004598206
curr_Factors:  [98.81776005]
mat_Sqrt:  [[0.15]]
grads:  [-0.03759833]
Stock Position:  -0.037598330434555176
Bond Position:  [-12.69614402]


portfolio before change:  [-16.46809201]
curr_Stock_Price:  100.28000805893247
curr_Factors:  [100.28000806]
mat_Sqrt:  [[0.15]]
grads:  [-0.11005263]
Stock Position:  -0.11005262676289726
Bond Position:  [-5.43201371]


portfolio before change:  [-16.33771776]
curr_Stock_Price:  99.08918422310452
curr_Factors:  [99.08918422]
mat_Sqrt:  [[0.15]]
grads:  [-0.09785399]
Stock Position:  -0.09785398686896311
Bond Position:  [-6.64144603]


portfolio before change:  [-16.25638071]
curr_Stock_Price:  98.2494914492317
curr_Factors:  [98.24949145]
mat_Sqrt:  [[0.15]]
grads:  [-0.17846909]
Stock Position:  -0.17846909311340434
Bond Position:  [1.27811693]


portfolio before change:  [-16.42065035]
curr_Stock_Price:  99.17082418426234
curr_Factors:  [99.17082418]
mat_Sqrt:  [[0.15]]
grads:  [0.09001077]
Stock Position:  0.09001077477420782
Bond Position:  [-25.34709307]


portfolio before change:  [-16.39968519]
curr_Stock_Price:  99.43894489942508
curr_Factors:  [99.4389449]
mat_Sqrt:  [[0.15]]
grads:  [0.11491472]
Stock Position:  0.11491471644786026
Bond Position:  [-27.82668334]


portfolio before change:  [-16.41948741]
curr_Stock_Price:  99.29689460897202
curr_Factors:  [99.29689461]
mat_Sqrt:  [[0.15]]
grads:  [0.13917967]
Stock Position:  0.13917967239892134
Bond Position:  [-30.23959667]


portfolio before change:  [-16.48446387]
curr_Stock_Price:  98.85720200473509
curr_Factors:  [98.857202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02251367]
Stock Position:  -0.022513672732876636
Bond Position:  [-14.25882517]


portfolio before change:  [-16.46991161]
curr_Stock_Price:  98.13165521379388
curr_Factors:  [98.13165521]
mat_Sqrt:  [[0.15]]
grads:  [0.07895163]
Stock Position:  0.0789516347952182
Bond Position:  [-24.21756621]


portfolio before change:  [-16.59325849]
curr_Stock_Price:  96.60769061044338
curr_Factors:  [96.60769061]
mat_Sqrt:  [[0.15]]
grads:  [0.01053568]
Stock Position:  0.010535675260487817
Bond Position:  [-17.61108575]


portfolio before change:  [-16.58182748]
curr_Stock_Price:  97.90163035466625
curr_Factors:  [97.90163035]
mat_Sqrt:  [[0.15]]
grads:  [-0.04526691]
Stock Position:  -0.04526691194053208
Bond Position:  [-12.150123]


portfolio before change:  [-16.61215193]
curr_Stock_Price:  98.53798005410448
curr_Factors:  [98.53798005]
mat_Sqrt:  [[0.15]]
grads:  [0.01257397]
Stock Position:  0.012573973323637758
Bond Position:  [-17.85116586]


portfolio before change:  [-16.60141143]
curr_Stock_Price:  99.56963752926512
curr_Factors:  [99.56963753]
mat_Sqrt:  [[0.15]]
grads:  [-0.04666374]
Stock Position:  -0.04666373923868617
Bond Position:  [-11.95511983]


portfolio before change:  [-16.63610144]
curr_Stock_Price:  100.28101481039882
curr_Factors:  [100.28101481]
mat_Sqrt:  [[0.15]]
grads:  [0.08284026]
Stock Position:  0.08284026393779574
Bond Position:  [-24.94340717]


portfolio before change:  [-16.52935676]
curr_Stock_Price:  101.6072153650261
curr_Factors:  [101.60721537]
mat_Sqrt:  [[0.15]]
grads:  [-0.04024716]
Stock Position:  -0.040247163106395756
Bond Position:  [-12.43995459]


portfolio before change:  [-16.56288709]
curr_Stock_Price:  102.40168734104333
curr_Factors:  [102.40168734]
mat_Sqrt:  [[0.15]]
grads:  [-0.1753641]
Stock Position:  -0.17536409989057114
Bond Position:  [1.39469264]


portfolio before change:  [-16.57717894]
curr_Stock_Price:  102.48417968894434
curr_Factors:  [102.48417969]
mat_Sqrt:  [[0.15]]
grads:  [0.0284092]
Stock Position:  0.02840920022957195
Bond Position:  [-19.48867252]


portfolio before change:  [-16.58195051]
curr_Stock_Price:  102.40197630957526
curr_Factors:  [102.40197631]
mat_Sqrt:  [[0.15]]
grads:  [0.00662506]
Stock Position:  0.00662505863156367
Bond Position:  [-17.26036961]


portfolio before change:  [-16.58042775]
curr_Stock_Price:  102.95750993627921
curr_Factors:  [102.95750994]
mat_Sqrt:  [[0.15]]
grads:  [-0.00744829]
Stock Position:  -0.007448285124456774
Bond Position:  [-15.81357086]


portfolio before change:  [-16.57192406]
curr_Stock_Price:  101.55040713403304
curr_Factors:  [101.55040713]
mat_Sqrt:  [[0.15]]
grads:  [-0.01544456]
Stock Position:  -0.015444558795821581
Bond Position:  [-15.00352283]


portfolio before change:  [-16.58405261]
curr_Stock_Price:  102.21426460682487
curr_Factors:  [102.21426461]
mat_Sqrt:  [[0.15]]
grads:  [-0.00422918]
Stock Position:  -0.00422918410758621
Bond Position:  [-16.15176966]


portfolio before change:  [-16.59326411]
curr_Stock_Price:  103.91492426862217
curr_Factors:  [103.91492427]
mat_Sqrt:  [[0.15]]
grads:  [-0.2564327]
Stock Position:  -0.25643269510336875
Bond Position:  [10.05391998]


portfolio before change:  [-17.16810662]
curr_Stock_Price:  106.16151504732612
curr_Factors:  [106.16151505]
mat_Sqrt:  [[0.15]]
grads:  [0.03223903]
Stock Position:  0.03223903132566283
Bond Position:  [-20.59065103]


portfolio before change:  [-17.15331139]
curr_Stock_Price:  106.70027857840284
curr_Factors:  [106.70027858]
mat_Sqrt:  [[0.15]]
grads:  [0.08475134]
Stock Position:  0.08475134352908913
Bond Position:  [-26.19630336]


portfolio before change:  [-17.19080805]
curr_Stock_Price:  106.29648660216984
curr_Factors:  [106.2964866]
mat_Sqrt:  [[0.15]]
grads:  [-0.03873155]
Stock Position:  -0.03873155049896723
Bond Position:  [-13.07378031]


portfolio before change:  [-17.20823237]
curr_Stock_Price:  106.7041644652699
curr_Factors:  [106.70416447]
mat_Sqrt:  [[0.15]]
grads:  [0.09938198]
Stock Position:  0.09938198217632778
Bond Position:  [-27.81270374]


portfolio before change:  [-17.11764781]
curr_Stock_Price:  107.65062742615518
curr_Factors:  [107.65062743]
mat_Sqrt:  [[0.15]]
grads:  [-0.11061198]
Stock Position:  -0.11061197631912555
Bond Position:  [-5.21019916]


portfolio before change:  [-17.12011629]
curr_Stock_Price:  107.6670556693736
curr_Factors:  [107.66705567]
mat_Sqrt:  [[0.15]]
grads:  [0.07862284]
Stock Position:  0.07862283500681524
Bond Position:  [-25.58520544]


portfolio before change:  [-17.07192227]
curr_Stock_Price:  108.32071266859995
curr_Factors:  [108.32071267]
mat_Sqrt:  [[0.15]]
grads:  [0.56973869]
Stock Position:  0.5697386919704494
Bond Position:  [-78.78642342]


portfolio before change:  [-17.12870414]
curr_Stock_Price:  108.23833639027833
curr_Factors:  [108.23833639]
mat_Sqrt:  [[0.15]]
grads:  [0.18625356]
Stock Position:  0.18625355948431777
Bond Position:  [-37.28847957]


portfolio before change:  [-17.01231025]
curr_Stock_Price:  108.8882849853765
curr_Factors:  [108.88828499]
mat_Sqrt:  [[0.15]]
grads:  [-0.28189368]
Stock Position:  -0.28189367683933286
Bond Position:  [13.68260877]


portfolio before change:  [-16.70204394]
curr_Stock_Price:  107.79370249348828
curr_Factors:  [107.79370249]
mat_Sqrt:  [[0.15]]
grads:  [0.01812683]
Stock Position:  0.018126826628860455
Bond Position:  [-18.65600169]


portfolio before change:  [-16.72251259]
curr_Stock_Price:  106.7931682810396
curr_Factors:  [106.79316828]
mat_Sqrt:  [[0.15]]
grads:  [-0.08796238]
Stock Position:  -0.08796237906129496
Bond Position:  [-7.32873144]


portfolio before change:  [-16.66924249]
curr_Stock_Price:  106.17715208186368
curr_Factors:  [106.17715208]
mat_Sqrt:  [[0.15]]
grads:  [0.02556123]
Stock Position:  0.025561228876399743
Bond Position:  [-19.38326098]


portfolio before change:  [-16.6462355]
curr_Stock_Price:  107.17202030108493
curr_Factors:  [107.1720203]
mat_Sqrt:  [[0.15]]
grads:  [-0.04740328]
Stock Position:  -0.04740327569276812
Bond Position:  [-11.56593067]


portfolio before change:  [-16.70340435]
curr_Stock_Price:  108.34753015095218
curr_Factors:  [108.34753015]
mat_Sqrt:  [[0.15]]
grads:  [0.05377105]
Stock Position:  0.05377105222104585
Bond Position:  [-22.52936505]


portfolio before change:  [-16.66841094]
curr_Stock_Price:  109.05069192875553
curr_Factors:  [109.05069193]
mat_Sqrt:  [[0.15]]
grads:  [0.16701886]
Stock Position:  0.16701885628672217
Bond Position:  [-34.88193279]


portfolio before change:  [-16.89163044]
curr_Stock_Price:  107.74030708098202
curr_Factors:  [107.74030708]
mat_Sqrt:  [[0.15]]
grads:  [0.0579943]
Stock Position:  0.057994295731725924
Bond Position:  [-23.13995367]


portfolio before change:  [-16.92676942]
curr_Stock_Price:  107.18428157387896
curr_Factors:  [107.18428157]
mat_Sqrt:  [[0.15]]
grads:  [0.12573345]
Stock Position:  0.12573345190887572
Bond Position:  [-30.40341913]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-16.92676942]
Stock Price:  108.96870501719332
PL:  [-25.89547444]
Settle:  Tensor("sub_322:0", shape=(), dtype=float64)
PL:  Tensor("sub_323:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  162
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.80018180e-03]
 [ 5.13539051e-03]
 [ 2.29623416e-02]
 [ 6.98266839e-04]
 [-4.32473544e-04]
 [ 3.18743020e-02]
 [ 1.31335541e-02]
 [ 1.36051083e-03]
 [ 1.17994854e-02]
 [ 1.23409363e-02]
 [ 2.70739423e-02]
 [ 9.74929654e-03]
 [-1.13499222e-02]
 [ 9.48321951e-03]
 [-7.41993222e-03]
 [-2.77197197e-02]
 [ 4.05915367e-03]
 [-4.27961261e-03]
 [ 2.14466605e-04]
 [-2.63816061e-03]
 [ 4.05030872e-04]
 [ 9.85383557e-03]
 [ 4.76648876e-03]
 [ 5.99505481e-03]
 [-3.42850364e-03]
 [-6.51180660e-03]
 [-7.13302530e-03]
 [-2.15774743e-02]
 [-3.30232271e-02]
 [ 2.20387363e-02]
 [ 4.36715934e-03]
 [-6.60470913e-03]
 [-1.24846102e-02]
 [-8.53363386e-03]
 [-7.60725317e-03]
 [-6.71438985e-03]
 [ 1.98968991e-02]
 [ 9.37192892e-03]
 [ 1.85364054e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [0.83198081]
curr_Stock_Price:  99.92862251080105
curr_Factors:  [99.92862251]
mat_Sqrt:  [[0.15]]
grads:  [-0.01200121]
Stock Position:  -0.012001212010178057
Bond Position:  [2.03124539]


portfolio before change:  [0.83846578]
curr_Stock_Price:  99.40942068089626
curr_Factors:  [99.40942068]
mat_Sqrt:  [[0.15]]
grads:  [0.03423594]
Stock Position:  0.03423593670285682
Bond Position:  [-2.56490885]


portfolio before change:  [0.86570936]
curr_Stock_Price:  100.21454571075034
curr_Factors:  [100.21454571]
mat_Sqrt:  [[0.15]]
grads:  [0.15308228]
Stock Position:  0.1530822774060003
Bond Position:  [-14.47536153]


portfolio before change:  [0.90480487]
curr_Stock_Price:  100.4817552482928
curr_Factors:  [100.48175525]
mat_Sqrt:  [[0.15]]
grads:  [0.00465511]
Stock Position:  0.0046551122624628625
Bond Position:  [0.43705102]


portfolio before change:  [0.9117023]
curr_Stock_Price:  101.95170946749745
curr_Factors:  [101.95170947]
mat_Sqrt:  [[0.15]]
grads:  [-0.00288316]
Stock Position:  -0.0028831569627612206
Bond Position:  [1.20564509]


portfolio before change:  [0.91119243]
curr_Stock_Price:  102.18082837307779
curr_Factors:  [102.18082837]
mat_Sqrt:  [[0.15]]
grads:  [0.21249535]
Stock Position:  0.21249534667237333
Bond Position:  [-20.80175811]


portfolio before change:  [0.79818405]
curr_Stock_Price:  101.66124995055488
curr_Factors:  [101.66124995]
mat_Sqrt:  [[0.15]]
grads:  [0.08755703]
Stock Position:  0.08755702709944009
Bond Position:  [-8.10297276]


portfolio before change:  [0.91720383]
curr_Stock_Price:  103.03215889523659
curr_Factors:  [103.0321589]
mat_Sqrt:  [[0.15]]
grads:  [0.00907007]
Stock Position:  0.009070072209302067
Bond Position:  [-0.01730529]


portfolio before change:  [0.91973652]
curr_Stock_Price:  103.31163367827995
curr_Factors:  [103.31163368]
mat_Sqrt:  [[0.15]]
grads:  [0.07866324]
Stock Position:  0.07866323590534788
Bond Position:  [-7.20709089]


portfolio before change:  [0.87574686]
curr_Stock_Price:  102.76387176019026
curr_Factors:  [102.76387176]
mat_Sqrt:  [[0.15]]
grads:  [0.08227291]
Stock Position:  0.0822729089017234
Bond Position:  [-7.5789358]


portfolio before change:  [0.82640713]
curr_Stock_Price:  102.17567929098273
curr_Factors:  [102.17567929]
mat_Sqrt:  [[0.15]]
grads:  [0.18049295]
Stock Position:  0.18049294861095105
Bond Position:  [-17.61558251]


portfolio before change:  [0.73401368]
curr_Stock_Price:  101.67598467143203
curr_Factors:  [101.67598467]
mat_Sqrt:  [[0.15]]
grads:  [0.06499531]
Stock Position:  0.06499531026678917
Bond Position:  [-5.87444849]


portfolio before change:  [0.72757144]
curr_Stock_Price:  101.58816454914574
curr_Factors:  [101.58816455]
mat_Sqrt:  [[0.15]]
grads:  [-0.07566615]
Stock Position:  -0.07566614790945952
Bond Position:  [8.41435652]


portfolio before change:  [0.637403]
curr_Stock_Price:  102.79372734049194
curr_Factors:  [102.79372734]
mat_Sqrt:  [[0.15]]
grads:  [0.06322146]
Stock Position:  0.06322146340690055
Bond Position:  [-5.86136687]


portfolio before change:  [0.52879682]
curr_Stock_Price:  101.08744810392601
curr_Factors:  [101.0874481]
mat_Sqrt:  [[0.15]]
grads:  [-0.04946621]
Stock Position:  -0.04946621479027497
Bond Position:  [5.52921024]


portfolio before change:  [0.50275514]
curr_Stock_Price:  101.6278749116965
curr_Factors:  [101.62787491]
mat_Sqrt:  [[0.15]]
grads:  [-0.18479813]
Stock Position:  -0.18479813134686937
Bond Position:  [19.28339652]


portfolio before change:  [0.37813476]
curr_Stock_Price:  102.31527880706163
curr_Factors:  [102.31527881]
mat_Sqrt:  [[0.15]]
grads:  [0.02706102]
Stock Position:  0.027061024466224146
Bond Position:  [-2.3906215]


portfolio before change:  [0.41353772]
curr_Stock_Price:  103.63458588278712
curr_Factors:  [103.63458588]
mat_Sqrt:  [[0.15]]
grads:  [-0.02853075]
Stock Position:  -0.02853075070461905
Bond Position:  [3.37031025]


portfolio before change:  [0.42508265]
curr_Stock_Price:  103.24470429712692
curr_Factors:  [103.2447043]
mat_Sqrt:  [[0.15]]
grads:  [0.00142978]
Stock Position:  0.001429777367773453
Bond Position:  [0.27746571]


portfolio before change:  [0.42405238]
curr_Stock_Price:  102.49986576828783
curr_Factors:  [102.49986577]
mat_Sqrt:  [[0.15]]
grads:  [-0.01758774]
Stock Position:  -0.01758773737294577
Bond Position:  [2.2267931]


portfolio before change:  [0.45836588]
curr_Stock_Price:  100.56470296178715
curr_Factors:  [100.56470296]
mat_Sqrt:  [[0.15]]
grads:  [0.00270021]
Stock Position:  0.002700205810714324
Bond Position:  [0.18682049]


portfolio before change:  [0.45524999]
curr_Stock_Price:  99.40210935007552
curr_Factors:  [99.40210935]
mat_Sqrt:  [[0.15]]
grads:  [0.06569224]
Stock Position:  0.06569223715369751
Bond Position:  [-6.07469695]


portfolio before change:  [0.4544108]
curr_Stock_Price:  99.40089444415212
curr_Factors:  [99.40089444]
mat_Sqrt:  [[0.15]]
grads:  [0.03177659]
Stock Position:  0.031776591704425594
Bond Position:  [-2.70421084]


portfolio before change:  [0.44157759]
curr_Stock_Price:  99.00767524720358
curr_Factors:  [99.00767525]
mat_Sqrt:  [[0.15]]
grads:  [0.03996703]
Stock Position:  0.039967032074327065
Bond Position:  [-3.51546535]


portfolio before change:  [0.44366774]
curr_Stock_Price:  99.07096781519188
curr_Factors:  [99.07096782]
mat_Sqrt:  [[0.15]]
grads:  [-0.02285669]
Stock Position:  -0.02285669092944974
Bond Position:  [2.70810223]


portfolio before change:  [0.45196442]
curr_Stock_Price:  98.72279215046582
curr_Factors:  [98.72279215]
mat_Sqrt:  [[0.15]]
grads:  [-0.04341204]
Stock Position:  -0.043412043984521455
Bond Position:  [4.73772261]


portfolio before change:  [0.51677351]
curr_Stock_Price:  97.24355209012946
curr_Factors:  [97.24355209]
mat_Sqrt:  [[0.15]]
grads:  [-0.0475535]
Stock Position:  -0.04755350200198293
Bond Position:  [5.14104495]


portfolio before change:  [0.4716803]
curr_Stock_Price:  98.20532942876353
curr_Factors:  [98.20532943]
mat_Sqrt:  [[0.15]]
grads:  [-0.14384983]
Stock Position:  -0.1438498289446441
Bond Position:  [14.59850014]


portfolio before change:  [0.50635425]
curr_Stock_Price:  97.97697303320555
curr_Factors:  [97.97697303]
mat_Sqrt:  [[0.15]]
grads:  [-0.22015485]
Stock Position:  -0.22015484715316933
Bond Position:  [22.07645977]


portfolio before change:  [0.58376145]
curr_Stock_Price:  97.6379049928044
curr_Factors:  [97.63790499]
mat_Sqrt:  [[0.15]]
grads:  [0.14692491]
Stock Position:  0.1469249089385024
Bond Position:  [-13.76167885]


portfolio before change:  [0.67634938]
curr_Stock_Price:  98.27978554930432
curr_Factors:  [98.27978555]
mat_Sqrt:  [[0.15]]
grads:  [0.0291144]
Stock Position:  0.029114395596099095
Bond Position:  [-2.18500718]


portfolio before change:  [0.6202589]
curr_Stock_Price:  96.362612522566
curr_Factors:  [96.36261252]
mat_Sqrt:  [[0.15]]
grads:  [-0.04403139]
Stock Position:  -0.04403139418696727
Bond Position:  [4.86323908]


portfolio before change:  [0.62083881]
curr_Stock_Price:  96.36324909185993
curr_Factors:  [96.36324909]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323073]
Stock Position:  -0.08323073489607888
Bond Position:  [8.64122285]


portfolio before change:  [0.47333318]
curr_Stock_Price:  98.14847731338638
curr_Factors:  [98.14847731]
mat_Sqrt:  [[0.15]]
grads:  [-0.05689089]
Stock Position:  -0.056890892378836405
Bond Position:  [6.05708764]


portfolio before change:  [0.50551438]
curr_Stock_Price:  97.59612150999571
curr_Factors:  [97.59612151]
mat_Sqrt:  [[0.15]]
grads:  [-0.05071502]
Stock Position:  -0.050715021134832027
Bond Position:  [5.45510374]


portfolio before change:  [0.52191795]
curr_Stock_Price:  97.28612181078398
curr_Factors:  [97.28612181]
mat_Sqrt:  [[0.15]]
grads:  [-0.0447626]
Stock Position:  -0.044762599024106654
Bond Position:  [4.87669761]


portfolio before change:  [0.56356233]
curr_Stock_Price:  96.36940205475013
curr_Factors:  [96.36940205]
mat_Sqrt:  [[0.15]]
grads:  [0.13264599]
Stock Position:  0.1326459942846228
Bond Position:  [-12.21945282]


portfolio before change:  [0.4940568]
curr_Stock_Price:  95.8569251441707
curr_Factors:  [95.85692514]
mat_Sqrt:  [[0.15]]
grads:  [0.06247953]
Stock Position:  0.06247952614526956
Bond Position:  [-5.49503846]


portfolio before change:  [0.40326481]
curr_Stock_Price:  94.41477167268104
curr_Factors:  [94.41477167]
mat_Sqrt:  [[0.15]]
grads:  [0.12357604]
Stock Position:  0.12357603572563332
Bond Position:  [-11.26413839]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [0.40326481]
Stock Price:  94.73575892366375
PL:  [0.40326481]
Settle:  Tensor("sub_324:0", shape=(), dtype=float64)
PL:  Tensor("sub_325:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  163
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.26396790e-03]
 [-9.83801519e-03]
 [ 2.21386558e-02]
 [-6.48067749e-03]
 [ 5.05691541e-03]
 [ 2.26839097e-02]
 [ 1.70019116e-04]
 [-1.11114067e-02]
 [ 9.67882059e-04]
 [ 1.44577965e-03]
 [-8.34268088e-02]
 [-2.27743408e-02]
 [ 1.50611136e-02]
 [-1.01140070e-04]
 [ 1.48448169e-02]
 [-7.92499970e-03]
 [-1.19923444e-02]
 [ 8.67699895e-04]
 [-7.79015900e-03]
 [-2.91757399e-03]
 [ 9.77917411e-04]
 [ 3.62363767e-04]
 [ 4.75699651e-03]
 [ 5.76693149e-03]
 [ 8.36618600e-03]
 [ 2.27634152e-03]
 [ 2.61715636e-02]
 [-2.25508997e-02]
 [-9.13992819e-03]
 [ 2.15654317e-02]
 [ 2.50425823e-03]
 [-1.75243971e-02]
 [-1.19960299e-02]
 [ 1.54777133e-03]
 [-7.28370321e-03]
 [ 1.78755873e-03]
 [ 1.65290431e-02]
 [ 1.78349806e-02]
 [ 1.09199119e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-1.59757795]
curr_Stock_Price:  99.77210530489022
curr_Factors:  [99.7721053]
mat_Sqrt:  [[0.15]]
grads:  [-0.01509312]
Stock Position:  -0.015093119327509607
Bond Position:  [-0.09170566]


portfolio before change:  [-1.61142993]
curr_Stock_Price:  100.68911357575777
curr_Factors:  [100.68911358]
mat_Sqrt:  [[0.15]]
grads:  [-0.06558677]
Stock Position:  -0.06558676795446679
Bond Position:  [4.9924436]


portfolio before change:  [-1.57505775]
curr_Stock_Price:  100.14406331007585
curr_Factors:  [100.14406331]
mat_Sqrt:  [[0.15]]
grads:  [0.14759104]
Stock Position:  0.14759103865004897
Bond Position:  [-16.35542407]


portfolio before change:  [-1.65217137]
curr_Stock_Price:  99.6354344655026
curr_Factors:  [99.63543447]
mat_Sqrt:  [[0.15]]
grads:  [-0.04320452]
Stock Position:  -0.04320451659263261
Bond Position:  [2.65252941]


portfolio before change:  [-1.5646212]
curr_Stock_Price:  97.61669699451484
curr_Factors:  [97.61669699]
mat_Sqrt:  [[0.15]]
grads:  [0.03371277]
Stock Position:  0.03371276942847204
Bond Position:  [-4.8555504]


portfolio before change:  [-1.53972201]
curr_Stock_Price:  98.37327021247039
curr_Factors:  [98.37327021]
mat_Sqrt:  [[0.15]]
grads:  [0.15122606]
Stock Position:  0.15122606471275446
Bond Position:  [-16.41632453]


portfolio before change:  [-1.85906508]
curr_Stock_Price:  96.27514706637486
curr_Factors:  [96.27514707]
mat_Sqrt:  [[0.15]]
grads:  [0.00113346]
Stock Position:  0.001133460770052069
Bond Position:  [-1.96818918]


portfolio before change:  [-1.85926181]
curr_Stock_Price:  96.31865469379423
curr_Factors:  [96.31865469]
mat_Sqrt:  [[0.15]]
grads:  [-0.07407604]
Stock Position:  -0.07407604437558785
Bond Position:  [5.27564313]


portfolio before change:  [-1.88879763]
curr_Stock_Price:  96.72628060410932
curr_Factors:  [96.7262806]
mat_Sqrt:  [[0.15]]
grads:  [0.00645255]
Stock Position:  0.006452547063211268
Bond Position:  [-2.5129285]


portfolio before change:  [-1.88953796]
curr_Stock_Price:  96.66022874833507
curr_Factors:  [96.66022875]
mat_Sqrt:  [[0.15]]
grads:  [0.00963853]
Stock Position:  0.009638531021006955
Bond Position:  [-2.82120058]


portfolio before change:  [-1.89676108]
curr_Stock_Price:  95.94741820170873
curr_Factors:  [95.9474182]
mat_Sqrt:  [[0.15]]
grads:  [-0.55617873]
Stock Position:  -0.5561787256396317
Bond Position:  [51.4671517]


portfolio before change:  [-1.49333963]
curr_Stock_Price:  95.23364106046064
curr_Factors:  [95.23364106]
mat_Sqrt:  [[0.15]]
grads:  [-0.15182894]
Stock Position:  -0.15182893854841134
Bond Position:  [12.96588301]


portfolio before change:  [-1.45170839]
curr_Stock_Price:  94.97011817151501
curr_Factors:  [94.97011817]
mat_Sqrt:  [[0.15]]
grads:  [0.10040742]
Stock Position:  0.10040742404098191
Bond Position:  [-10.98741331]


portfolio before change:  [-1.44082224]
curr_Stock_Price:  95.09221731196303
curr_Factors:  [95.09221731]
mat_Sqrt:  [[0.15]]
grads:  [-0.00067427]
Stock Position:  -0.0006742671328092166
Bond Position:  [-1.37670468]


portfolio before change:  [-1.44141175]
curr_Stock_Price:  95.7112734368541
curr_Factors:  [95.71127344]
mat_Sqrt:  [[0.15]]
grads:  [0.09896545]
Stock Position:  0.0989654459165641
Bond Position:  [-10.9135206]


portfolio before change:  [-1.43772873]
curr_Stock_Price:  95.76227396891414
curr_Factors:  [95.76227397]
mat_Sqrt:  [[0.15]]
grads:  [-0.05283333]
Stock Position:  -0.05283333136330639
Bond Position:  [3.62171122]


portfolio before change:  [-1.38017092]
curr_Stock_Price:  94.68142086486303
curr_Factors:  [94.68142086]
mat_Sqrt:  [[0.15]]
grads:  [-0.07994896]
Stock Position:  -0.07994896238975131
Bond Position:  [6.18951043]


portfolio before change:  [-1.26243407]
curr_Stock_Price:  93.21844859717976
curr_Factors:  [93.2184486]
mat_Sqrt:  [[0.15]]
grads:  [0.00578467]
Stock Position:  0.00578466596755661
Bond Position:  [-1.80167166]


portfolio before change:  [-1.25886227]
curr_Stock_Price:  93.87484241268609
curr_Factors:  [93.87484241]
mat_Sqrt:  [[0.15]]
grads:  [-0.05193439]
Stock Position:  -0.05193439334602686
Bond Position:  [3.61647072]


portfolio before change:  [-1.29438812]
curr_Stock_Price:  94.56759970075939
curr_Factors:  [94.5675997]
mat_Sqrt:  [[0.15]]
grads:  [-0.01945049]
Stock Position:  -0.019450493268944612
Bond Position:  [0.54499835]


portfolio before change:  [-1.30487668]
curr_Stock_Price:  95.11034659663619
curr_Factors:  [95.1103466]
mat_Sqrt:  [[0.15]]
grads:  [0.00651945]
Stock Position:  0.006519449407518397
Bond Position:  [-1.92494377]


portfolio before change:  [-1.31315235]
curr_Stock_Price:  93.8778757737537
curr_Factors:  [93.87787577]
mat_Sqrt:  [[0.15]]
grads:  [0.00241576]
Stock Position:  0.002415758445710375
Bond Position:  [-1.53993862]


portfolio before change:  [-1.31405887]
curr_Stock_Price:  93.58230667402583
curr_Factors:  [93.58230667]
mat_Sqrt:  [[0.15]]
grads:  [0.03171331]
Stock Position:  0.0317133100848803
Bond Position:  [-4.28186358]


portfolio before change:  [-1.37739415]
curr_Stock_Price:  91.60206515001583
curr_Factors:  [91.60206515]
mat_Sqrt:  [[0.15]]
grads:  [0.03844621]
Stock Position:  0.03844620996654239
Bond Position:  [-4.89914638]


portfolio before change:  [-1.33810438]
curr_Stock_Price:  92.63993599433054
curr_Factors:  [92.63993599]
mat_Sqrt:  [[0.15]]
grads:  [0.05577457]
Stock Position:  0.05577457330501493
Bond Position:  [-6.50505729]


portfolio before change:  [-1.38811273]
curr_Stock_Price:  91.7579003502657
curr_Factors:  [91.75790035]
mat_Sqrt:  [[0.15]]
grads:  [0.01517561]
Stock Position:  0.015175610109330167
Bond Position:  [-2.78059485]


portfolio before change:  [-1.40525711]
curr_Stock_Price:  90.65107253110376
curr_Factors:  [90.65107253]
mat_Sqrt:  [[0.15]]
grads:  [0.17447709]
Stock Position:  0.17447709085378693
Bond Position:  [-17.22179253]


portfolio before change:  [-1.32138426]
curr_Stock_Price:  91.14412127581336
curr_Factors:  [91.14412128]
mat_Sqrt:  [[0.15]]
grads:  [-0.15033933]
Stock Position:  -0.15033933153589893
Bond Position:  [12.38116201]


portfolio before change:  [-1.27719354]
curr_Stock_Price:  90.86047642943079
curr_Factors:  [90.86047643]
mat_Sqrt:  [[0.15]]
grads:  [-0.06093285]
Stock Position:  -0.060932854619238364
Bond Position:  [4.25919466]


portfolio before change:  [-1.32695875]
curr_Stock_Price:  91.68593658461116
curr_Factors:  [91.68593658]
mat_Sqrt:  [[0.15]]
grads:  [0.14376954]
Stock Position:  0.14376954491549643
Bond Position:  [-14.50860413]


portfolio before change:  [-1.436987]
curr_Stock_Price:  90.93324198139761
curr_Factors:  [90.93324198]
mat_Sqrt:  [[0.15]]
grads:  [0.01669505]
Stock Position:  0.016695054857186472
Bond Position:  [-2.95512247]


portfolio before change:  [-1.42811256]
curr_Stock_Price:  91.48693017776999
curr_Factors:  [91.48693018]
mat_Sqrt:  [[0.15]]
grads:  [-0.11682931]
Stock Position:  -0.11682931404865432
Bond Position:  [9.26024274]


portfolio before change:  [-1.31411075]
curr_Stock_Price:  90.52104069109038
curr_Factors:  [90.52104069]
mat_Sqrt:  [[0.15]]
grads:  [-0.07997353]
Stock Position:  -0.07997353298974051
Bond Position:  [5.92517668]


portfolio before change:  [-1.28620042]
curr_Stock_Price:  90.18130779563647
curr_Factors:  [90.1813078]
mat_Sqrt:  [[0.15]]
grads:  [0.01031848]
Stock Position:  0.010318475539158925
Bond Position:  [-2.21673404]


portfolio before change:  [-1.29309052]
curr_Stock_Price:  89.54041918029894
curr_Factors:  [89.54041918]
mat_Sqrt:  [[0.15]]
grads:  [-0.04855802]
Stock Position:  -0.048558021422928484
Bond Position:  [3.05481507]


portfolio before change:  [-1.31689089]
curr_Stock_Price:  90.0384262891729
curr_Factors:  [90.03842629]
mat_Sqrt:  [[0.15]]
grads:  [0.01191706]
Stock Position:  0.011917058176677068
Bond Position:  [-2.38988405]


portfolio before change:  [-1.32306859]
curr_Stock_Price:  89.54510406147413
curr_Factors:  [89.54510406]
mat_Sqrt:  [[0.15]]
grads:  [0.11019362]
Stock Position:  0.11019362087170095
Bond Position:  [-11.19036784]


portfolio before change:  [-1.3497782]
curr_Stock_Price:  89.31541081938656
curr_Factors:  [89.31541082]
mat_Sqrt:  [[0.15]]
grads:  [0.11889987]
Stock Position:  0.11889987062289657
Bond Position:  [-11.96936899]


portfolio before change:  [-1.4199137]
curr_Stock_Price:  88.73812480454461
curr_Factors:  [88.7381248]
mat_Sqrt:  [[0.15]]
grads:  [0.07279941]
Stock Position:  0.07279941236400864
Bond Position:  [-7.87999704]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-1.4199137]
Stock Price:  87.83800312589074
PL:  [-1.4199137]
Settle:  Tensor("sub_326:0", shape=(), dtype=float64)
PL:  Tensor("sub_327:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  164
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.06228742e-03]
 [-4.85497952e-03]
 [-3.54369386e-03]
 [-1.36970588e-02]
 [ 1.40567954e-02]
 [ 2.00401887e-02]
 [ 2.72359998e-02]
 [-3.09212538e-03]
 [ 3.72463085e-03]
 [ 6.41796173e-03]
 [ 6.47977456e-03]
 [ 1.19611119e-02]
 [-8.43244286e-03]
 [ 1.08406297e-02]
 [-5.16812016e-03]
 [-2.79267979e-02]
 [ 4.12955068e-03]
 [-7.17750201e-04]
 [-5.45636600e-03]
 [-2.86379911e-03]
 [-1.88214775e-03]
 [-3.96515777e-02]
 [ 4.81026314e-03]
 [ 8.79242209e-03]
 [-5.52291159e-03]
 [ 4.71347208e-03]
 [-7.30548290e-03]
 [ 4.75590488e-03]
 [ 4.62310633e-02]
 [ 2.71976310e-02]
 [-2.57308653e-02]
 [ 6.32905762e-03]
 [-1.30672100e-02]
 [ 3.15968916e-03]
 [-6.49487760e-03]
 [ 1.42507425e-03]
 [ 2.40996817e-02]
 [-2.65319506e-04]
 [ 2.03997016e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [24.50551761]
curr_Stock_Price:  101.4537207697539
curr_Factors:  [101.45372077]
mat_Sqrt:  [[0.15]]
grads:  [-0.02708192]
Stock Position:  -0.027081916108482325
Bond Position:  [27.25307877]


portfolio before change:  [24.51648925]
curr_Stock_Price:  101.17439075634572
curr_Factors:  [101.17439076]
mat_Sqrt:  [[0.15]]
grads:  [-0.03236653]
Stock Position:  -0.03236653012606442
Bond Position:  [27.79115322]


portfolio before change:  [24.5788898]
curr_Stock_Price:  99.35379303190112
curr_Factors:  [99.35379303]
mat_Sqrt:  [[0.15]]
grads:  [-0.02362463]
Stock Position:  -0.023624625706774642
Bond Position:  [26.92608597]


portfolio before change:  [24.5891688]
curr_Stock_Price:  99.06117325032834
curr_Factors:  [99.06117325]
mat_Sqrt:  [[0.15]]
grads:  [-0.09131373]
Stock Position:  -0.09131372558130907
Bond Position:  [33.63481359]


portfolio before change:  [24.60843863]
curr_Stock_Price:  98.89619021126612
curr_Factors:  [98.89619021]
mat_Sqrt:  [[0.15]]
grads:  [0.09371197]
Stock Position:  0.09371196915251838
Bond Position:  [15.3406819]


portfolio before change:  [24.62349809]
curr_Stock_Price:  99.036425807124
curr_Factors:  [99.03642581]
mat_Sqrt:  [[0.15]]
grads:  [0.13360126]
Stock Position:  0.13360125769184222
Bond Position:  [11.39210704]


portfolio before change:  [24.76768781]
curr_Stock_Price:  100.10502068975829
curr_Factors:  [100.10502069]
mat_Sqrt:  [[0.15]]
grads:  [0.18157333]
Stock Position:  0.18157333194817
Bond Position:  [6.59128566]


portfolio before change:  [24.77667445]
curr_Stock_Price:  100.14997595720303
curr_Factors:  [100.14997596]
mat_Sqrt:  [[0.15]]
grads:  [-0.02061417]
Stock Position:  -0.020614169215038274
Bond Position:  [26.841183]


portfolio before change:  [24.76861721]
curr_Stock_Price:  100.70360463056704
curr_Factors:  [100.70360463]
mat_Sqrt:  [[0.15]]
grads:  [0.02483087]
Stock Position:  0.024830872365910805
Bond Position:  [22.26805886]


portfolio before change:  [24.77200513]
curr_Stock_Price:  100.7279385656686
curr_Factors:  [100.72793857]
mat_Sqrt:  [[0.15]]
grads:  [0.04278641]
Stock Position:  0.04278641152952841
Bond Position:  [20.4622181]


portfolio before change:  [24.71660422]
curr_Stock_Price:  99.37332976892714
curr_Factors:  [99.37332977]
mat_Sqrt:  [[0.15]]
grads:  [0.0431985]
Stock Position:  0.04319849704323487
Bond Position:  [20.42382572]


portfolio before change:  [24.74900361]
curr_Stock_Price:  100.06423931351456
curr_Factors:  [100.06423931]
mat_Sqrt:  [[0.15]]
grads:  [0.07974075]
Stock Position:  0.0797407457941926
Bond Position:  [16.76980654]


portfolio before change:  [24.73365882]
curr_Stock_Price:  99.8455162337503
curr_Factors:  [99.84551623]
mat_Sqrt:  [[0.15]]
grads:  [-0.05621629]
Stock Position:  -0.05621628574442162
Bond Position:  [30.34660289]


portfolio before change:  [24.73811139]
curr_Stock_Price:  99.83379362628817
curr_Factors:  [99.83379363]
mat_Sqrt:  [[0.15]]
grads:  [0.07227086]
Stock Position:  0.07227086478188084
Bond Position:  [17.52303679]


portfolio before change:  [24.75656365]
curr_Stock_Price:  100.05880469711633
curr_Factors:  [100.0588047]
mat_Sqrt:  [[0.15]]
grads:  [-0.03445413]
Stock Position:  -0.03445413441501375
Bond Position:  [28.20400316]


portfolio before change:  [24.71654587]
curr_Stock_Price:  101.32261529722858
curr_Factors:  [101.3226153]
mat_Sqrt:  [[0.15]]
grads:  [-0.18617865]
Stock Position:  -0.18617865280366477
Bond Position:  [43.58065388]


portfolio before change:  [24.61067579]
curr_Stock_Price:  101.92052489290866
curr_Factors:  [101.92052489]
mat_Sqrt:  [[0.15]]
grads:  [0.02753034]
Stock Position:  0.02753033783638257
Bond Position:  [21.80476931]


portfolio before change:  [24.59003307]
curr_Stock_Price:  101.0716981371263
curr_Factors:  [101.07169814]
mat_Sqrt:  [[0.15]]
grads:  [-0.004785]
Stock Position:  -0.00478500133989423
Bond Position:  [25.07366128]


portfolio before change:  [24.58862151]
curr_Stock_Price:  102.02174140732245
curr_Factors:  [102.02174141]
mat_Sqrt:  [[0.15]]
grads:  [-0.03637577]
Stock Position:  -0.0363757733029116
Bond Position:  [28.29974125]


portfolio before change:  [24.56064954]
curr_Stock_Price:  102.88796796349246
curr_Factors:  [102.88796796]
mat_Sqrt:  [[0.15]]
grads:  [-0.01909199]
Stock Position:  -0.019091994066655762
Bond Position:  [26.52498601]


portfolio before change:  [24.53337589]
curr_Stock_Price:  104.49018295079857
curr_Factors:  [104.49018295]
mat_Sqrt:  [[0.15]]
grads:  [-0.01254765]
Stock Position:  -0.012547651657883402
Bond Position:  [25.84448231]


portfolio before change:  [24.54100917]
curr_Stock_Price:  104.13931928382954
curr_Factors:  [104.13931928]
mat_Sqrt:  [[0.15]]
grads:  [-0.26434385]
Stock Position:  -0.26434385145376477
Bond Position:  [52.06959792]


portfolio before change:  [24.64195447]
curr_Stock_Price:  103.782071745801
curr_Factors:  [103.78207175]
mat_Sqrt:  [[0.15]]
grads:  [0.03206842]
Stock Position:  0.03206842091613272
Bond Position:  [21.31382731]


portfolio before change:  [24.62068109]
curr_Stock_Price:  103.03561249071645
curr_Factors:  [103.03561249]
mat_Sqrt:  [[0.15]]
grads:  [0.05861615]
Stock Position:  0.058616147282720306
Bond Position:  [18.58113045]


portfolio before change:  [24.67140117]
curr_Stock_Price:  103.86127730966908
curr_Factors:  [103.86127731]
mat_Sqrt:  [[0.15]]
grads:  [-0.03681941]
Stock Position:  -0.036819410567291766
Bond Position:  [28.49551218]


portfolio before change:  [24.64457776]
curr_Stock_Price:  104.68653681742508
curr_Factors:  [104.68653682]
mat_Sqrt:  [[0.15]]
grads:  [0.03142315]
Stock Position:  0.031423147172355226
Bond Position:  [21.35499731]


portfolio before change:  [24.64360257]
curr_Stock_Price:  104.57054790310664
curr_Factors:  [104.5705479]
mat_Sqrt:  [[0.15]]
grads:  [-0.04870322]
Stock Position:  -0.04870321935647618
Bond Position:  [29.7365249]


portfolio before change:  [24.60094853]
curr_Stock_Price:  105.52266836384725
curr_Factors:  [105.52266836]
mat_Sqrt:  [[0.15]]
grads:  [0.03170603]
Stock Position:  0.03170603252744662
Bond Position:  [21.25524338]


portfolio before change:  [24.60547562]
curr_Stock_Price:  105.58164826389606
curr_Factors:  [105.58164826]
mat_Sqrt:  [[0.15]]
grads:  [0.30820709]
Stock Position:  0.3082070887062647
Bond Position:  [-7.93553681]


portfolio before change:  [25.07255919]
curr_Stock_Price:  107.10035302712744
curr_Factors:  [107.10035303]
mat_Sqrt:  [[0.15]]
grads:  [0.18131754]
Stock Position:  0.18131753998450856
Bond Position:  [5.65338665]


portfolio before change:  [24.87098801]
curr_Stock_Price:  105.984752721224
curr_Factors:  [105.98475272]
mat_Sqrt:  [[0.15]]
grads:  [-0.1715391]
Stock Position:  -0.1715391019163479
Bond Position:  [43.05151731]


portfolio before change:  [25.00006971]
curr_Stock_Price:  105.26363476553121
curr_Factors:  [105.26363477]
mat_Sqrt:  [[0.15]]
grads:  [0.04219372]
Stock Position:  0.04219371747936
Bond Position:  [20.55860564]


portfolio before change:  [24.99435497]
curr_Stock_Price:  105.06728495934293
curr_Factors:  [105.06728496]
mat_Sqrt:  [[0.15]]
grads:  [-0.08711473]
Stock Position:  -0.08711473362005759
Bond Position:  [34.14726351]


portfolio before change:  [24.94018559]
curr_Stock_Price:  105.7381020437107
curr_Factors:  [105.73810204]
mat_Sqrt:  [[0.15]]
grads:  [0.02106459]
Stock Position:  0.021064594425842798
Bond Position:  [22.71285536]


portfolio before change:  [24.94031137]
curr_Stock_Price:  105.609283873206
curr_Factors:  [105.60928387]
mat_Sqrt:  [[0.15]]
grads:  [-0.04329918]
Stock Position:  -0.043299183984697814
Bond Position:  [29.51310719]


portfolio before change:  [24.97048866]
curr_Stock_Price:  104.99754207673044
curr_Factors:  [104.99754208]
mat_Sqrt:  [[0.15]]
grads:  [0.0095005]
Stock Position:  0.009500495033043059
Bond Position:  [23.97296003]


portfolio before change:  [24.96855574]
curr_Stock_Price:  104.47865022293323
curr_Factors:  [104.47865022]
mat_Sqrt:  [[0.15]]
grads:  [0.16066454]
Stock Position:  0.16066454476975955
Bond Position:  [8.18254096]


portfolio before change:  [24.87068883]
curr_Stock_Price:  103.8631454510141
curr_Factors:  [103.86314545]
mat_Sqrt:  [[0.15]]
grads:  [-0.0017688]
Stock Position:  -0.0017687967057591347
Bond Position:  [25.05440162]


portfolio before change:  [24.87254351]
curr_Stock_Price:  104.585279499413
curr_Factors:  [104.5852795]
mat_Sqrt:  [[0.15]]
grads:  [0.13599801]
Stock Position:  0.1359980106359564
Bond Position:  [10.64915356]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [24.87254351]
Stock Price:  104.15645165013578
PL:  [20.71609186]
Settle:  Tensor("sub_328:0", shape=(), dtype=float64)
PL:  Tensor("sub_329:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  165
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.54953609e-03]
 [-6.22109205e-03]
 [ 1.38565084e-02]
 [-2.68124853e-02]
 [ 1.43690760e-02]
 [ 1.97566082e-02]
 [ 2.71866337e-02]
 [-2.51701428e-03]
 [ 1.05992971e-02]
 [ 1.33482516e-02]
 [ 1.46329749e-02]
 [-1.48634958e-02]
 [-1.24253935e-02]
 [-2.85385645e-03]
 [ 1.00295879e-03]
 [-2.92638098e-02]
 [ 4.73118733e-03]
 [-9.59355200e-03]
 [ 8.09267585e-03]
 [-3.95549352e-03]
 [-2.06250180e-03]
 [-3.93812082e-02]
 [ 4.81736102e-03]
 [ 9.36666159e-03]
 [-5.57432390e-03]
 [ 1.67110065e-02]
 [-1.49219956e-02]
 [ 8.56320757e-03]
 [ 6.05620461e-02]
 [ 2.77219905e-02]
 [-3.67078700e-02]
 [ 4.18753299e-03]
 [-1.31240499e-02]
 [ 2.03340018e-03]
 [-6.58794156e-03]
 [ 2.86201524e-03]
 [ 2.43757376e-02]
 [ 3.58988407e-03]
 [ 1.90974227e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [7.71488191]
curr_Stock_Price:  100.37203325114115
curr_Factors:  [100.37203325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01033024]
Stock Position:  -0.010330240598646703
Bond Position:  [8.75174916]


portfolio before change:  [7.72077113]
curr_Stock_Price:  99.907843842603
curr_Factors:  [99.90784384]
mat_Sqrt:  [[0.15]]
grads:  [-0.04147395]
Stock Position:  -0.04147394702269458
Bond Position:  [11.86434375]


portfolio before change:  [7.72731746]
curr_Stock_Price:  99.78576259332733
curr_Factors:  [99.78576259]
mat_Sqrt:  [[0.15]]
grads:  [0.09237672]
Stock Position:  0.09237672282989248
Bond Position:  [-1.49056427]


portfolio before change:  [7.58408789]
curr_Stock_Price:  98.23728557650529
curr_Factors:  [98.23728558]
mat_Sqrt:  [[0.15]]
grads:  [-0.1787499]
Stock Position:  -0.17874990225750895
Bond Position:  [25.14399309]


portfolio before change:  [7.5007506]
curr_Stock_Price:  98.72109279190713
curr_Factors:  [98.72109279]
mat_Sqrt:  [[0.15]]
grads:  [0.09579384]
Stock Position:  0.09579384010555579
Bond Position:  [-1.95612198]


portfolio before change:  [7.53428878]
curr_Stock_Price:  99.07375334153734
curr_Factors:  [99.07375334]
mat_Sqrt:  [[0.15]]
grads:  [0.13171072]
Stock Position:  0.13171072115026022
Bond Position:  [-5.51478672]


portfolio before change:  [7.68956206]
curr_Stock_Price:  100.25788376436034
curr_Factors:  [100.25788376]
mat_Sqrt:  [[0.15]]
grads:  [0.18124422]
Stock Position:  0.18124422480928823
Bond Position:  [-10.48160037]


portfolio before change:  [7.77076759]
curr_Stock_Price:  100.71315797125877
curr_Factors:  [100.71315797]
mat_Sqrt:  [[0.15]]
grads:  [-0.0167801]
Stock Position:  -0.016780095185180574
Bond Position:  [9.46074397]


portfolio before change:  [7.7349917]
curr_Stock_Price:  102.91568218112985
curr_Factors:  [102.91568218]
mat_Sqrt:  [[0.15]]
grads:  [0.07066198]
Stock Position:  0.07066198054835776
Bond Position:  [0.46276576]


portfolio before change:  [7.80639817]
curr_Stock_Price:  103.9253994489124
curr_Factors:  [103.92539945]
mat_Sqrt:  [[0.15]]
grads:  [0.08898834]
Stock Position:  0.0889883440047709
Bond Position:  [-1.44175103]


portfolio before change:  [7.87773522]
curr_Stock_Price:  104.72906968032301
curr_Factors:  [104.72906968]
mat_Sqrt:  [[0.15]]
grads:  [0.09755317]
Stock Position:  0.0975531661048789
Bond Position:  [-2.33891711]


portfolio before change:  [7.89522877]
curr_Stock_Price:  104.91139004865613
curr_Factors:  [104.91139005]
mat_Sqrt:  [[0.15]]
grads:  [-0.09908997]
Stock Position:  -0.09908997207051455
Bond Position:  [18.29089548]


portfolio before change:  [7.93185875]
curr_Stock_Price:  104.56480125039072
curr_Factors:  [104.56480125]
mat_Sqrt:  [[0.15]]
grads:  [-0.08283596]
Stock Position:  -0.08283595666187747
Bond Position:  [16.59358409]


portfolio before change:  [7.95212048]
curr_Stock_Price:  104.34524190319466
curr_Factors:  [104.3452419]
mat_Sqrt:  [[0.15]]
grads:  [-0.01902571]
Stock Position:  -0.01902570964826393
Bond Position:  [9.93736276]


portfolio before change:  [7.96273555]
curr_Stock_Price:  103.85260219761356
curr_Factors:  [103.8526022]
mat_Sqrt:  [[0.15]]
grads:  [0.00668639]
Stock Position:  0.006686391905085463
Bond Position:  [7.26833635]


portfolio before change:  [7.9633573]
curr_Stock_Price:  103.80970188263879
curr_Factors:  [103.80970188]
mat_Sqrt:  [[0.15]]
grads:  [-0.19509207]
Stock Position:  -0.19509206512855912
Bond Position:  [28.21580642]


portfolio before change:  [7.63970473]
curr_Stock_Price:  105.48675507217807
curr_Factors:  [105.48675507]
mat_Sqrt:  [[0.15]]
grads:  [0.03154125]
Stock Position:  0.031541248843301756
Bond Position:  [4.31252073]


portfolio before change:  [7.6307844]
curr_Stock_Price:  105.18684855442407
curr_Factors:  [105.18684855]
mat_Sqrt:  [[0.15]]
grads:  [-0.06395701]
Stock Position:  -0.06395701333094359
Bond Position:  [14.35822107]


portfolio before change:  [7.64551137]
curr_Stock_Price:  104.98464901805829
curr_Factors:  [104.98464902]
mat_Sqrt:  [[0.15]]
grads:  [0.05395117]
Stock Position:  0.053951172364033094
Bond Position:  [1.98146647]


portfolio before change:  [7.66235854]
curr_Stock_Price:  105.29232490965822
curr_Factors:  [105.29232491]
mat_Sqrt:  [[0.15]]
grads:  [-0.02636996]
Stock Position:  -0.026369956822325232
Bond Position:  [10.4389126]


portfolio before change:  [7.67494539]
curr_Stock_Price:  104.86449336708922
curr_Factors:  [104.86449337]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375001]
Stock Position:  -0.013750012018078185
Bond Position:  [9.11683343]


portfolio before change:  [7.66327458]
curr_Stock_Price:  105.79616378897364
curr_Factors:  [105.79616379]
mat_Sqrt:  [[0.15]]
grads:  [-0.26254139]
Stock Position:  -0.2625413882301231
Bond Position:  [35.43914629]


portfolio before change:  [8.02934105]
curr_Stock_Price:  104.41871886672881
curr_Factors:  [104.41871887]
mat_Sqrt:  [[0.15]]
grads:  [0.03211574]
Stock Position:  0.032115740101597574
Bond Position:  [4.67585662]


portfolio before change:  [8.00692801]
curr_Stock_Price:  103.7026349767955
curr_Factors:  [103.70263498]
mat_Sqrt:  [[0.15]]
grads:  [0.06244441]
Stock Position:  0.06244441057997873
Bond Position:  [1.53127809]


portfolio before change:  [8.08325459]
curr_Stock_Price:  104.92188197898463
curr_Factors:  [104.92188198]
mat_Sqrt:  [[0.15]]
grads:  [-0.03716216]
Stock Position:  -0.037162159356115755
Bond Position:  [11.98237829]


portfolio before change:  [8.00519876]
curr_Stock_Price:  107.06260045393633
curr_Factors:  [107.06260045]
mat_Sqrt:  [[0.15]]
grads:  [0.11140671]
Stock Position:  0.11140671030663521
Bond Position:  [-3.92229335]


portfolio before change:  [8.00851725]
curr_Stock_Price:  107.09678876894264
curr_Factors:  [107.09678877]
mat_Sqrt:  [[0.15]]
grads:  [-0.09947997]
Stock Position:  -0.09947997061300184
Bond Position:  [18.66250265]


portfolio before change:  [8.05203547]
curr_Stock_Price:  106.68278316751861
curr_Factors:  [106.68278317]
mat_Sqrt:  [[0.15]]
grads:  [0.05708805]
Stock Position:  0.057088050485196606
Bond Position:  [1.96172336]


portfolio before change:  [8.04654166]
curr_Stock_Price:  106.58225352914141
curr_Factors:  [106.58225353]
mat_Sqrt:  [[0.15]]
grads:  [0.40374697]
Stock Position:  0.40374697407909216
Bond Position:  [-34.98572069]


portfolio before change:  [8.57674078]
curr_Stock_Price:  107.90628228547318
curr_Factors:  [107.90628229]
mat_Sqrt:  [[0.15]]
grads:  [0.18481327]
Stock Position:  0.18481326994285055
Bond Position:  [-11.3657721]


portfolio before change:  [8.57604178]
curr_Stock_Price:  107.91018791316995
curr_Factors:  [107.91018791]
mat_Sqrt:  [[0.15]]
grads:  [-0.24471913]
Stock Position:  -0.2447191332775534
Bond Position:  [34.98372944]


portfolio before change:  [8.83212842]
curr_Stock_Price:  106.8816071170151
curr_Factors:  [106.88160712]
mat_Sqrt:  [[0.15]]
grads:  [0.02791689]
Stock Position:  0.027916886604283615
Bond Position:  [5.84832672]


portfolio before change:  [8.80374831]
curr_Stock_Price:  105.83882616385644
curr_Factors:  [105.83882616]
mat_Sqrt:  [[0.15]]
grads:  [-0.08749367]
Stock Position:  -0.08749366617969885
Bond Position:  [18.06397524]


portfolio before change:  [8.878964]
curr_Stock_Price:  105.00496525381374
curr_Factors:  [105.00496525]
mat_Sqrt:  [[0.15]]
grads:  [0.013556]
Stock Position:  0.013556001190571123
Bond Position:  [7.45551656]


portfolio before change:  [8.89129065]
curr_Stock_Price:  105.84552686863867
curr_Factors:  [105.84552687]
mat_Sqrt:  [[0.15]]
grads:  [-0.04391961]
Stock Position:  -0.04391961037352969
Bond Position:  [13.53998495]


portfolio before change:  [8.89861949]
curr_Stock_Price:  105.71719614315515
curr_Factors:  [105.71719614]
mat_Sqrt:  [[0.15]]
grads:  [0.0190801]
Stock Position:  0.019080101574946013
Bond Position:  [6.88152465]


portfolio before change:  [8.90425499]
curr_Stock_Price:  105.96747060556923
curr_Factors:  [105.96747061]
mat_Sqrt:  [[0.15]]
grads:  [0.16250492]
Stock Position:  0.16250491749430543
Bond Position:  [-8.31598007]


portfolio before change:  [8.83621162]
curr_Stock_Price:  105.55515191561523
curr_Factors:  [105.55515192]
mat_Sqrt:  [[0.15]]
grads:  [0.02393256]
Stock Position:  0.023932560443394695
Bond Position:  [6.31000656]


portfolio before change:  [8.86639888]
curr_Stock_Price:  106.78353970368907
curr_Factors:  [106.7835397]
mat_Sqrt:  [[0.15]]
grads:  [0.12731615]
Stock Position:  0.12731615109229577
Bond Position:  [-4.72887039]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.86639888]
Stock Price:  106.58418865047345
PL:  [2.28221023]
Settle:  Tensor("sub_330:0", shape=(), dtype=float64)
PL:  Tensor("sub_331:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  166
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.71139059e-03]
 [-5.74869381e-03]
 [-3.98998057e-03]
 [ 1.74821356e-02]
 [ 6.69138726e-03]
 [ 1.66762807e-02]
 [ 2.72841354e-02]
 [-2.27204747e-03]
 [ 4.00919889e-03]
 [ 1.17067991e-02]
 [ 1.62857310e-02]
 [ 1.02482082e-02]
 [-1.18491561e-02]
 [ 1.17259408e-02]
 [-7.24774699e-03]
 [-2.75034995e-02]
 [ 4.48396724e-03]
 [ 2.31009890e-03]
 [-3.09792743e-03]
 [-2.21493447e-03]
 [ 3.70806648e-04]
 [ 4.80888078e-03]
 [ 4.76724277e-03]
 [ 5.98005218e-03]
 [-4.11997856e-03]
 [-9.25263448e-03]
 [ 1.33296476e-02]
 [-1.99456441e-02]
 [-1.98466945e-02]
 [ 2.15399462e-02]
 [ 4.77170525e-03]
 [-2.35272019e-03]
 [-1.25334711e-02]
 [-7.01684286e-03]
 [-7.57736994e-03]
 [-7.52020110e-03]
 [ 2.11244129e-02]
 [ 8.56674006e-03]
 [ 2.26494113e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.17542997]
curr_Stock_Price:  99.67045681060603
curr_Factors:  [99.67045681]
mat_Sqrt:  [[0.15]]
grads:  [-0.01807594]
Stock Position:  -0.01807593726378141
Bond Position:  [-1.37379305]


portfolio before change:  [-3.20042469]
curr_Stock_Price:  101.04371800230437
curr_Factors:  [101.043718]
mat_Sqrt:  [[0.15]]
grads:  [-0.03832463]
Stock Position:  -0.03832462541670252
Bond Position:  [0.67203795]


portfolio before change:  [-3.19691761]
curr_Stock_Price:  100.95440012532525
curr_Factors:  [100.95440013]
mat_Sqrt:  [[0.15]]
grads:  [-0.02659987]
Stock Position:  -0.02659987044194305
Bond Position:  [-0.51154364]


portfolio before change:  [-3.19875738]
curr_Stock_Price:  101.0211608257966
curr_Factors:  [101.02116083]
mat_Sqrt:  [[0.15]]
grads:  [0.11654757]
Stock Position:  0.11654757058014108
Bond Position:  [-14.97252825]


portfolio before change:  [-3.28910196]
curr_Stock_Price:  100.26204678799157
curr_Factors:  [100.26204679]
mat_Sqrt:  [[0.15]]
grads:  [0.04460925]
Stock Position:  0.04460924838215194
Bond Position:  [-7.76171651]


portfolio before change:  [-3.32126628]
curr_Stock_Price:  99.56277369359655
curr_Factors:  [99.56277369]
mat_Sqrt:  [[0.15]]
grads:  [0.1111752]
Stock Position:  0.11117520464114578
Bond Position:  [-14.39017802]


portfolio before change:  [-3.27935172]
curr_Stock_Price:  99.95596789154412
curr_Factors:  [99.95596789]
mat_Sqrt:  [[0.15]]
grads:  [0.18189424]
Stock Position:  0.1818942357379849
Bond Position:  [-21.46076611]


portfolio before change:  [-3.11151086]
curr_Stock_Price:  100.89345568527695
curr_Factors:  [100.89345569]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514698]
Stock Position:  -0.015146983127179053
Bond Position:  [-1.58327939]


portfolio before change:  [-3.11859708]
curr_Stock_Price:  101.34821947372035
curr_Factors:  [101.34821947]
mat_Sqrt:  [[0.15]]
grads:  [0.02672799]
Stock Position:  0.026727992582360506
Bond Position:  [-5.82743154]


portfolio before change:  [-3.09962961]
curr_Stock_Price:  102.0851226717702
curr_Factors:  [102.08512267]
mat_Sqrt:  [[0.15]]
grads:  [0.07804533]
Stock Position:  0.07804532716361132
Bond Position:  [-11.06689641]


portfolio before change:  [-3.20633268]
curr_Stock_Price:  100.73565540167195
curr_Factors:  [100.7356554]
mat_Sqrt:  [[0.15]]
grads:  [0.10857154]
Stock Position:  0.10857153985247314
Bond Position:  [-14.1433579]


portfolio before change:  [-3.18247468]
curr_Stock_Price:  100.97168438015366
curr_Factors:  [100.97168438]
mat_Sqrt:  [[0.15]]
grads:  [0.06832139]
Stock Position:  0.06832138797664347
Bond Position:  [-10.0810003]


portfolio before change:  [-3.09084998]
curr_Stock_Price:  102.33121330611911
curr_Factors:  [102.33121331]
mat_Sqrt:  [[0.15]]
grads:  [-0.07899437]
Stock Position:  -0.07899437409856518
Bond Position:  [4.99274017]


portfolio before change:  [-3.00341828]
curr_Stock_Price:  101.23230516654188
curr_Factors:  [101.23230517]
mat_Sqrt:  [[0.15]]
grads:  [0.07817294]
Stock Position:  0.07817293866528362
Bond Position:  [-10.91704507]


portfolio before change:  [-3.01043386]
curr_Stock_Price:  101.16001846600899
curr_Factors:  [101.16001847]
mat_Sqrt:  [[0.15]]
grads:  [-0.04831831]
Stock Position:  -0.048318313250416196
Bond Position:  [1.8774476]


portfolio before change:  [-3.03851808]
curr_Stock_Price:  101.74610918727392
curr_Factors:  [101.74610919]
mat_Sqrt:  [[0.15]]
grads:  [-0.18335666]
Stock Position:  -0.1833566633208877
Bond Position:  [15.617309]


portfolio before change:  [-2.93019042]
curr_Stock_Price:  101.1659537005682
curr_Factors:  [101.1659537]
mat_Sqrt:  [[0.15]]
grads:  [0.02989311]
Stock Position:  0.029893114922256242
Bond Position:  [-5.9543559]


portfolio before change:  [-2.91284157]
curr_Stock_Price:  101.77121649308128
curr_Factors:  [101.77121649]
mat_Sqrt:  [[0.15]]
grads:  [0.01540066]
Stock Position:  0.015400659301994189
Bond Position:  [-4.48018541]


portfolio before change:  [-2.90171034]
curr_Stock_Price:  102.5303585806539
curr_Factors:  [102.53035858]
mat_Sqrt:  [[0.15]]
grads:  [-0.02065285]
Stock Position:  -0.02065284950966658
Bond Position:  [-0.78416628]


portfolio before change:  [-2.85896551]
curr_Stock_Price:  100.45592990599067
curr_Factors:  [100.45592991]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476623]
Stock Position:  -0.014766229772882436
Bond Position:  [-1.37561016]


portfolio before change:  [-2.84930742]
curr_Stock_Price:  99.79021833326031
curr_Factors:  [99.79021833]
mat_Sqrt:  [[0.15]]
grads:  [0.00247204]
Stock Position:  0.002472044317815816
Bond Position:  [-3.09599326]


portfolio before change:  [-2.84694675]
curr_Stock_Price:  100.90172557001644
curr_Factors:  [100.90172557]
mat_Sqrt:  [[0.15]]
grads:  [0.03205921]
Stock Position:  0.03205920521007429
Bond Position:  [-6.08177587]


portfolio before change:  [-2.88851076]
curr_Stock_Price:  99.6289633881169
curr_Factors:  [99.62896339]
mat_Sqrt:  [[0.15]]
grads:  [0.03178162]
Stock Position:  0.031781618477508
Bond Position:  [-6.05488047]


portfolio before change:  [-2.91003268]
curr_Stock_Price:  98.97559783925209
curr_Factors:  [98.97559784]
mat_Sqrt:  [[0.15]]
grads:  [0.03986701]
Stock Position:  0.03986701450391818
Bond Position:  [-6.85589428]


portfolio before change:  [-2.87320505]
curr_Stock_Price:  99.92085733405065
curr_Factors:  [99.92085733]
mat_Sqrt:  [[0.15]]
grads:  [-0.02746652]
Stock Position:  -0.027466523757210135
Bond Position:  [-0.12872645]


portfolio before change:  [-2.8908981]
curr_Stock_Price:  100.56443922407806
curr_Factors:  [100.56443922]
mat_Sqrt:  [[0.15]]
grads:  [-0.06168423]
Stock Position:  -0.061684229838563885
Bond Position:  [3.31234188]


portfolio before change:  [-2.8694026]
curr_Stock_Price:  100.22267556518725
curr_Factors:  [100.22267557]
mat_Sqrt:  [[0.15]]
grads:  [0.08886432]
Stock Position:  0.08886431748204265
Bond Position:  [-11.77562226]


portfolio before change:  [-2.85288179]
curr_Stock_Price:  100.4251511553824
curr_Factors:  [100.42515116]
mat_Sqrt:  [[0.15]]
grads:  [-0.13297096]
Stock Position:  -0.1329709604194026
Bond Position:  [10.50074701]


portfolio before change:  [-2.80522615]
curr_Stock_Price:  100.07663171804747
curr_Factors:  [100.07663172]
mat_Sqrt:  [[0.15]]
grads:  [-0.1323113]
Stock Position:  -0.13231129652400989
Bond Position:  [10.43604274]


portfolio before change:  [-2.78980623]
curr_Stock_Price:  99.96994895491483
curr_Factors:  [99.96994895]
mat_Sqrt:  [[0.15]]
grads:  [0.14359964]
Stock Position:  0.14359964128398828
Bond Position:  [-17.14545504]


portfolio before change:  [-3.01135721]
curr_Stock_Price:  98.44203664243068
curr_Factors:  [98.44203664]
mat_Sqrt:  [[0.15]]
grads:  [0.03181137]
Stock Position:  0.03181136835448433
Bond Position:  [-6.1429331]


portfolio before change:  [-3.01249664]
curr_Stock_Price:  98.4303577455135
curr_Factors:  [98.43035775]
mat_Sqrt:  [[0.15]]
grads:  [-0.0156848]
Stock Position:  -0.015684801245788325
Bond Position:  [-1.46863604]


portfolio before change:  [-3.02344902]
curr_Stock_Price:  99.11693228572422
curr_Factors:  [99.11693229]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355647]
Stock Position:  -0.08355647405486158
Bond Position:  [5.25841236]


portfolio before change:  [-3.03016189]
curr_Stock_Price:  99.20513863888343
curr_Factors:  [99.20513864]
mat_Sqrt:  [[0.15]]
grads:  [-0.04677895]
Stock Position:  -0.04677895238617748
Bond Position:  [1.61055057]


portfolio before change:  [-3.06182998]
curr_Stock_Price:  99.88641551619648
curr_Factors:  [99.88641552]
mat_Sqrt:  [[0.15]]
grads:  [-0.0505158]
Stock Position:  -0.050515799572787005
Bond Position:  [1.98401217]


portfolio before change:  [-2.96971038]
curr_Stock_Price:  98.06774525389778
curr_Factors:  [98.06774525]
mat_Sqrt:  [[0.15]]
grads:  [-0.05013467]
Stock Position:  -0.050134673981720154
Bond Position:  [1.94688406]


portfolio before change:  [-2.95104748]
curr_Stock_Price:  97.70034443160105
curr_Factors:  [97.70034443]
mat_Sqrt:  [[0.15]]
grads:  [0.14082942]
Stock Position:  0.14082941907072846
Bond Position:  [-16.71013023]


portfolio before change:  [-2.94908627]
curr_Stock_Price:  97.7291033606365
curr_Factors:  [97.72910336]
mat_Sqrt:  [[0.15]]
grads:  [0.0571116]
Stock Position:  0.05711160041827583
Bond Position:  [-8.53055177]


portfolio before change:  [-2.94419329]
curr_Stock_Price:  97.83344933504536
curr_Factors:  [97.83344934]
mat_Sqrt:  [[0.15]]
grads:  [0.15099608]
Stock Position:  0.1509960753670561
Bond Position:  [-17.71666018]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.94419329]
Stock Price:  97.52753523128834
PL:  [-2.94419329]
Settle:  Tensor("sub_332:0", shape=(), dtype=float64)
PL:  Tensor("sub_333:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  167
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44660054e-03]
 [-1.58255310e-02]
 [ 2.01961033e-02]
 [ 1.50107130e-02]
 [-7.66954583e-03]
 [ 2.90219291e-02]
 [ 2.39089781e-02]
 [ 1.75320363e-03]
 [ 1.58441668e-02]
 [ 1.27800652e-02]
 [ 2.53884121e-02]
 [-8.17283127e-03]
 [-1.20975034e-02]
 [ 1.09944396e-02]
 [-5.42977232e-03]
 [-2.76436636e-02]
 [ 4.42938202e-03]
 [ 3.22720341e-04]
 [-1.87107143e-03]
 [-3.11062569e-03]
 [-9.81349228e-04]
 [-3.08536529e-02]
 [ 4.79389129e-03]
 [ 9.09335980e-03]
 [-5.57915494e-03]
 [ 7.97828858e-03]
 [-7.31200315e-03]
 [ 1.31250716e-03]
 [ 3.14215182e-02]
 [ 2.59025482e-02]
 [-2.32445265e-02]
 [ 6.36363089e-03]
 [-1.31552370e-02]
 [ 2.74636462e-03]
 [-6.65679499e-03]
 [ 2.60008687e-03]
 [ 2.46495371e-02]
 [ 9.43571443e-03]
 [ 1.82338296e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.37061944]
curr_Stock_Price:  100.15658893855566
curr_Factors:  [100.15658894]
mat_Sqrt:  [[0.15]]
grads:  [-0.009644]
Stock Position:  -0.009644003625005997
Bond Position:  [5.33652995]


portfolio before change:  [4.37093072]
curr_Stock_Price:  100.19348544332382
curr_Factors:  [100.19348544]
mat_Sqrt:  [[0.15]]
grads:  [-0.10550354]
Stock Position:  -0.10550354009721243
Bond Position:  [14.94169813]


portfolio before change:  [4.35311748]
curr_Stock_Price:  100.38002963046
curr_Factors:  [100.38002963]
mat_Sqrt:  [[0.15]]
grads:  [0.13464069]
Stock Position:  0.1346406889000032
Bond Position:  [-9.16211887]


portfolio before change:  [4.42831792]
curr_Stock_Price:  100.94706314524838
curr_Factors:  [100.94706315]
mat_Sqrt:  [[0.15]]
grads:  [0.10007142]
Stock Position:  0.10007141999174163
Bond Position:  [-5.67359803]


portfolio before change:  [4.55178101]
curr_Stock_Price:  102.18790022442023
curr_Factors:  [102.18790022]
mat_Sqrt:  [[0.15]]
grads:  [-0.05113031]
Stock Position:  -0.051130305534628114
Bond Position:  [9.77667957]


portfolio before change:  [4.58206624]
curr_Stock_Price:  101.6194883417661
curr_Factors:  [101.61948834]
mat_Sqrt:  [[0.15]]
grads:  [0.19347953]
Stock Position:  0.19347952731806542
Bond Position:  [-15.07922433]


portfolio before change:  [4.43782579]
curr_Stock_Price:  100.88372352374931
curr_Factors:  [100.88372352]
mat_Sqrt:  [[0.15]]
grads:  [0.15939319]
Stock Position:  0.1593931870840464
Bond Position:  [-11.64235243]


portfolio before change:  [4.83208043]
curr_Stock_Price:  103.36632661596967
curr_Factors:  [103.36632662]
mat_Sqrt:  [[0.15]]
grads:  [0.01168802]
Stock Position:  0.011688024225454416
Bond Position:  [3.6239323]


portfolio before change:  [4.84749037]
curr_Stock_Price:  104.6460056882768
curr_Factors:  [104.64600569]
mat_Sqrt:  [[0.15]]
grads:  [0.10562778]
Stock Position:  0.10562777896188774
Bond Position:  [-6.20603479]


portfolio before change:  [4.69895638]
curr_Stock_Price:  103.2471484286784
curr_Factors:  [103.24714843]
mat_Sqrt:  [[0.15]]
grads:  [0.08520043]
Stock Position:  0.08520043451533953
Bond Position:  [-4.09774553]


portfolio before change:  [4.66578639]
curr_Stock_Price:  102.86384364519822
curr_Factors:  [102.86384365]
mat_Sqrt:  [[0.15]]
grads:  [0.16925608]
Stock Position:  0.16925608099254763
Bond Position:  [-12.74454466]


portfolio before change:  [4.83448646]
curr_Stock_Price:  103.86997136118025
curr_Factors:  [103.86997136]
mat_Sqrt:  [[0.15]]
grads:  [-0.05448554]
Stock Position:  -0.05448554179873502
Bond Position:  [10.49389813]


portfolio before change:  [4.89479858]
curr_Stock_Price:  102.78710967785669
curr_Factors:  [102.78710968]
mat_Sqrt:  [[0.15]]
grads:  [-0.08065002]
Stock Position:  -0.08065002248902407
Bond Position:  [13.18458129]


portfolio before change:  [4.93639646]
curr_Stock_Price:  102.29176321944409
curr_Factors:  [102.29176322]
mat_Sqrt:  [[0.15]]
grads:  [0.07329626]
Stock Position:  0.07329626387859901
Bond Position:  [-2.56120761]


portfolio before change:  [4.90236381]
curr_Stock_Price:  101.83181512550784
curr_Factors:  [101.83181513]
mat_Sqrt:  [[0.15]]
grads:  [-0.03619848]
Stock Position:  -0.0361984821477777
Bond Position:  [8.58852096]


portfolio before change:  [4.90931431]
curr_Stock_Price:  101.66946417136359
curr_Factors:  [101.66946417]
mat_Sqrt:  [[0.15]]
grads:  [-0.18429109]
Stock Position:  -0.18429109066224836
Bond Position:  [23.64609074]


portfolio before change:  [4.99466091]
curr_Stock_Price:  101.22239610502561
curr_Factors:  [101.22239611]
mat_Sqrt:  [[0.15]]
grads:  [0.02952921]
Stock Position:  0.029529213467649897
Bond Position:  [2.00564317]


portfolio before change:  [5.0347279]
curr_Stock_Price:  102.57076491190273
curr_Factors:  [102.57076491]
mat_Sqrt:  [[0.15]]
grads:  [0.00215147]
Stock Position:  0.0021514689387811007
Bond Position:  [4.81405009]


portfolio before change:  [5.035812]
curr_Stock_Price:  102.79494042607419
curr_Factors:  [102.79494043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01247381]
Stock Position:  -0.012473809534725601
Bond Position:  [6.31805651]


portfolio before change:  [5.02557954]
curr_Stock_Price:  103.6785731413861
curr_Factors:  [103.67857314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0207375]
Stock Position:  -0.020737504587496982
Bond Position:  [7.17561443]


portfolio before change:  [5.04683206]
curr_Stock_Price:  102.69699376335328
curr_Factors:  [102.69699376]
mat_Sqrt:  [[0.15]]
grads:  [-0.00654233]
Stock Position:  -0.006542328189834382
Bond Position:  [5.7187095]


portfolio before change:  [5.04741795]
curr_Stock_Price:  102.71670989542754
curr_Factors:  [102.7167099]
mat_Sqrt:  [[0.15]]
grads:  [-0.20569102]
Stock Position:  -0.20569101958631508
Bond Position:  [26.17532274]


portfolio before change:  [5.10242608]
curr_Stock_Price:  102.46518694768828
curr_Factors:  [102.46518695]
mat_Sqrt:  [[0.15]]
grads:  [0.03195928]
Stock Position:  0.03195927527437605
Bond Position:  [1.82771297]


portfolio before change:  [5.13205669]
curr_Stock_Price:  103.38517433169008
curr_Factors:  [103.38517433]
mat_Sqrt:  [[0.15]]
grads:  [0.0606224]
Stock Position:  0.06062239863683573
Bond Position:  [-1.13540056]


portfolio before change:  [5.23111537]
curr_Stock_Price:  105.02154334034694
curr_Factors:  [105.02154334]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719437]
Stock Position:  -0.037194366277212676
Bond Position:  [9.13732512]


portfolio before change:  [5.22076552]
curr_Stock_Price:  105.33051743396764
curr_Factors:  [105.33051743]
mat_Sqrt:  [[0.15]]
grads:  [0.05318859]
Stock Position:  0.05318859055028258
Bond Position:  [-0.38161625]


portfolio before change:  [5.18041113]
curr_Stock_Price:  104.57271053575151
curr_Factors:  [104.57271054]
mat_Sqrt:  [[0.15]]
grads:  [-0.04874669]
Stock Position:  -0.048746687681825905
Bond Position:  [10.27798439]


portfolio before change:  [5.17115775]
curr_Stock_Price:  104.78889364988024
curr_Factors:  [104.78889365]
mat_Sqrt:  [[0.15]]
grads:  [0.00875005]
Stock Position:  0.008750047742789499
Bond Position:  [4.25424992]


portfolio before change:  [5.16997813]
curr_Stock_Price:  104.59330293143013
curr_Factors:  [104.59330293]
mat_Sqrt:  [[0.15]]
grads:  [0.20947679]
Stock Position:  0.20947678825267088
Bond Position:  [-16.73989104]


portfolio before change:  [5.27608777]
curr_Stock_Price:  105.1098386935617
curr_Factors:  [105.10983869]
mat_Sqrt:  [[0.15]]
grads:  [0.17268365]
Stock Position:  0.17268365491792398
Bond Position:  [-12.87466334]


portfolio before change:  [5.350251]
curr_Stock_Price:  105.54863336808755
curr_Factors:  [105.54863337]
mat_Sqrt:  [[0.15]]
grads:  [-0.15496351]
Stock Position:  -0.15496351003288522
Bond Position:  [21.70643771]


portfolio before change:  [5.37280186]
curr_Stock_Price:  105.42062014637469
curr_Factors:  [105.42062015]
mat_Sqrt:  [[0.15]]
grads:  [0.04242421]
Stock Position:  0.042424205938738385
Bond Position:  [0.90041576]


portfolio before change:  [5.40861596]
curr_Stock_Price:  106.26215724681681
curr_Factors:  [106.26215725]
mat_Sqrt:  [[0.15]]
grads:  [-0.08770158]
Stock Position:  -0.08770157980751736
Bond Position:  [14.72797502]


portfolio before change:  [5.48001329]
curr_Stock_Price:  105.46905614755089
curr_Factors:  [105.46905615]
mat_Sqrt:  [[0.15]]
grads:  [0.0183091]
Stock Position:  0.018309097465763723
Bond Position:  [3.54897006]


portfolio before change:  [5.49054992]
curr_Stock_Price:  106.02031140721387
curr_Factors:  [106.02031141]
mat_Sqrt:  [[0.15]]
grads:  [-0.04437863]
Stock Position:  -0.04437863325331177
Bond Position:  [10.19558644]


portfolio before change:  [5.51109788]
curr_Stock_Price:  105.58601621766114
curr_Factors:  [105.58601622]
mat_Sqrt:  [[0.15]]
grads:  [0.01733391]
Stock Position:  0.017333912494584353
Bond Position:  [3.68087911]


portfolio before change:  [5.53639917]
curr_Stock_Price:  107.01911181372112
curr_Factors:  [107.01911181]
mat_Sqrt:  [[0.15]]
grads:  [0.16433025]
Stock Position:  0.16433024743648644
Bond Position:  [-12.05007795]


portfolio before change:  [5.70517435]
curr_Stock_Price:  108.05532722268266
curr_Factors:  [108.05532722]
mat_Sqrt:  [[0.15]]
grads:  [0.06290476]
Stock Position:  0.06290476289083895
Bond Position:  [-1.09202039]


portfolio before change:  [5.71673601]
curr_Stock_Price:  108.2412936243657
curr_Factors:  [108.24129362]
mat_Sqrt:  [[0.15]]
grads:  [0.12155886]
Stock Position:  0.12155886414149868
Bond Position:  [-7.44095269]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.71673601]
Stock Price:  107.91152178925296
PL:  [-2.19478578]
Settle:  Tensor("sub_334:0", shape=(), dtype=float64)
PL:  Tensor("sub_335:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  168
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.32063567e-03]
 [-6.36636177e-03]
 [-3.75070582e-02]
 [-1.73529337e-02]
 [ 1.43030885e-02]
 [ 2.37732710e-02]
 [ 1.39872221e-03]
 [-1.07798442e-02]
 [-5.63149318e-03]
 [ 3.40492757e-03]
 [-5.32002569e-02]
 [-9.29959708e-03]
 [ 8.65094967e-03]
 [ 6.76389058e-03]
 [ 5.32721881e-03]
 [-1.26070025e-02]
 [-5.99528977e-03]
 [-8.55662520e-04]
 [-7.52944060e-03]
 [-2.32238232e-03]
 [ 3.10521903e-04]
 [ 8.66166334e-03]
 [ 4.76223874e-03]
 [ 5.36904751e-03]
 [-1.96436902e-03]
 [-6.25595381e-03]
 [-5.42086920e-03]
 [-2.02075997e-02]
 [-3.57753253e-02]
 [ 2.18979991e-02]
 [ 5.69648848e-03]
 [ 8.88867361e-04]
 [-1.25306248e-02]
 [-9.69672590e-03]
 [-7.61955768e-03]
 [-7.13124913e-03]
 [ 2.14076313e-02]
 [ 8.21180280e-03]
 [ 2.28801467e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.747769]
curr_Stock_Price:  99.11820898049666
curr_Factors:  [99.11820898]
mat_Sqrt:  [[0.15]]
grads:  [-0.0354709]
Stock Position:  -0.03547090444073608
Bond Position:  [-8.23195649]


portfolio before change:  [-11.72471968]
curr_Stock_Price:  98.43938816985069
curr_Factors:  [98.43938817]
mat_Sqrt:  [[0.15]]
grads:  [-0.04244241]
Stock Position:  -0.04244241180155946
Bond Position:  [-7.54671463]


portfolio before change:  [-11.69938136]
curr_Stock_Price:  97.82015584828443
curr_Factors:  [97.82015585]
mat_Sqrt:  [[0.15]]
grads:  [-0.25004705]
Stock Position:  -0.2500470548506168
Bond Position:  [12.76026051]


portfolio before change:  [-11.94705214]
curr_Stock_Price:  98.81703184834686
curr_Factors:  [98.81703185]
mat_Sqrt:  [[0.15]]
grads:  [-0.11568622]
Stock Position:  -0.11568622450113343
Bond Position:  [-0.51528281]


portfolio before change:  [-11.94029806]
curr_Stock_Price:  98.75809236567972
curr_Factors:  [98.75809237]
mat_Sqrt:  [[0.15]]
grads:  [0.09535392]
Stock Position:  0.0953539230685496
Bond Position:  [-21.35726961]


portfolio before change:  [-12.02628463]
curr_Stock_Price:  97.88432921175944
curr_Factors:  [97.88432921]
mat_Sqrt:  [[0.15]]
grads:  [0.15848847]
Stock Position:  0.15848847356132073
Bond Position:  [-27.53982256]


portfolio before change:  [-12.21755086]
curr_Stock_Price:  96.69923654043909
curr_Factors:  [96.69923654]
mat_Sqrt:  [[0.15]]
grads:  [0.00932481]
Stock Position:  0.0093248147091547
Bond Position:  [-13.11925332]


portfolio before change:  [-12.22166801]
curr_Stock_Price:  96.43358612683178
curr_Factors:  [96.43358613]
mat_Sqrt:  [[0.15]]
grads:  [-0.07186563]
Stock Position:  -0.07186562819703257
Bond Position:  [-5.29140776]


portfolio before change:  [-12.19287874]
curr_Stock_Price:  96.02378338139046
curr_Factors:  [96.02378338]
mat_Sqrt:  [[0.15]]
grads:  [-0.03754329]
Stock Position:  -0.03754328788755802
Bond Position:  [-8.5878302]


portfolio before change:  [-12.18913076]
curr_Stock_Price:  95.89535743785426
curr_Factors:  [95.89535744]
mat_Sqrt:  [[0.15]]
grads:  [0.02269952]
Stock Position:  0.022699517148019727
Bond Position:  [-14.36590907]


portfolio before change:  [-12.17228332]
curr_Stock_Price:  96.71666526371038
curr_Factors:  [96.71666526]
mat_Sqrt:  [[0.15]]
grads:  [-0.35466838]
Stock Position:  -0.35466837964925846
Bond Position:  [22.13005964]


portfolio before change:  [-12.24838571]
curr_Stock_Price:  96.93903868821882
curr_Factors:  [96.93903869]
mat_Sqrt:  [[0.15]]
grads:  [-0.06199731]
Stock Position:  -0.061997313881438296
Bond Position:  [-6.2384257]


portfolio before change:  [-12.2746356]
curr_Stock_Price:  97.3498636065594
curr_Factors:  [97.34986361]
mat_Sqrt:  [[0.15]]
grads:  [0.057673]
Stock Position:  0.05767299780437357
Bond Position:  [-17.88909407]


portfolio before change:  [-12.30064441]
curr_Stock_Price:  96.93766842956917
curr_Factors:  [96.93766843]
mat_Sqrt:  [[0.15]]
grads:  [0.0450926]
Stock Position:  0.04509260387671913
Bond Position:  [-16.67181629]


portfolio before change:  [-12.28286778]
curr_Stock_Price:  97.37811177320947
curr_Factors:  [97.37811177]
mat_Sqrt:  [[0.15]]
grads:  [0.03551479]
Stock Position:  0.035514792087697686
Bond Position:  [-15.74123117]


portfolio before change:  [-12.28372651]
curr_Stock_Price:  97.40933936962438
curr_Factors:  [97.40933937]
mat_Sqrt:  [[0.15]]
grads:  [-0.08404668]
Stock Position:  -0.08404668342475587
Bond Position:  [-4.09679461]


portfolio before change:  [-12.29711706]
curr_Stock_Price:  97.56256865264132
curr_Factors:  [97.56256865]
mat_Sqrt:  [[0.15]]
grads:  [-0.0399686]
Stock Position:  -0.03996859847912728
Bond Position:  [-8.39767793]


portfolio before change:  [-12.30093068]
curr_Stock_Price:  97.63171911155251
curr_Factors:  [97.63171911]
mat_Sqrt:  [[0.15]]
grads:  [-0.00570442]
Stock Position:  -0.005704416799278903
Bond Position:  [-11.74399866]


portfolio before change:  [-12.30460966]
curr_Stock_Price:  98.01929415877498
curr_Factors:  [98.01929416]
mat_Sqrt:  [[0.15]]
grads:  [-0.05019627]
Stock Position:  -0.05019627064810537
Bond Position:  [-7.38440664]


portfolio before change:  [-12.37011096]
curr_Stock_Price:  99.30580783398455
curr_Factors:  [99.30580783]
mat_Sqrt:  [[0.15]]
grads:  [-0.01548255]
Stock Position:  -0.015482548832471783
Bond Position:  [-10.83260394]


portfolio before change:  [-12.36707512]
curr_Stock_Price:  99.02226256331973
curr_Factors:  [99.02226256]
mat_Sqrt:  [[0.15]]
grads:  [0.00207015]
Stock Position:  0.002070146021244203
Bond Position:  [-12.57206566]


portfolio before change:  [-12.36971581]
curr_Stock_Price:  98.50583018910137
curr_Factors:  [98.50583019]
mat_Sqrt:  [[0.15]]
grads:  [0.05774442]
Stock Position:  0.05774442227424684
Bond Position:  [-18.05787807]


portfolio before change:  [-12.41134951]
curr_Stock_Price:  97.82392319484366
curr_Factors:  [97.82392319]
mat_Sqrt:  [[0.15]]
grads:  [0.03174826]
Stock Position:  0.03174825823714999
Bond Position:  [-15.51708869]


portfolio before change:  [-12.44095494]
curr_Stock_Price:  96.95251563445156
curr_Factors:  [96.95251563]
mat_Sqrt:  [[0.15]]
grads:  [0.03579365]
Stock Position:  0.03579365005098967
Bond Position:  [-15.91123936]


portfolio before change:  [-12.41659348]
curr_Stock_Price:  97.6886934610173
curr_Factors:  [97.68869346]
mat_Sqrt:  [[0.15]]
grads:  [-0.01309579]
Stock Position:  -0.013095793478618892
Bond Position:  [-11.13728253]


portfolio before change:  [-12.42997626]
curr_Stock_Price:  98.60429508903223
curr_Factors:  [98.60429509]
mat_Sqrt:  [[0.15]]
grads:  [-0.04170636]
Stock Position:  -0.04170635873832861
Bond Position:  [-8.31755015]


portfolio before change:  [-12.40455847]
curr_Stock_Price:  97.96991823064855
curr_Factors:  [97.96991823]
mat_Sqrt:  [[0.15]]
grads:  [-0.03613913]
Stock Position:  -0.0361391280163144
Bond Position:  [-8.86401105]


portfolio before change:  [-12.39327082]
curr_Stock_Price:  97.62691837084213
curr_Factors:  [97.62691837]
mat_Sqrt:  [[0.15]]
grads:  [-0.13471733]
Stock Position:  -0.1347173315313281
Bond Position:  [0.75876711]


portfolio before change:  [-12.48684736]
curr_Stock_Price:  98.32223643121328
curr_Factors:  [98.32223643]
mat_Sqrt:  [[0.15]]
grads:  [-0.23850217]
Stock Position:  -0.2385021683809621
Bond Position:  [10.96321922]


portfolio before change:  [-12.56107366]
curr_Stock_Price:  98.63920121552057
curr_Factors:  [98.63920122]
mat_Sqrt:  [[0.15]]
grads:  [0.14598666]
Stock Position:  0.1459866609631001
Bond Position:  [-26.96108129]


portfolio before change:  [-12.56601243]
curr_Stock_Price:  98.62845766128129
curr_Factors:  [98.62845766]
mat_Sqrt:  [[0.15]]
grads:  [0.03797659]
Stock Position:  0.03797658986768315
Bond Position:  [-16.31158491]


portfolio before change:  [-12.52720674]
curr_Stock_Price:  99.70398244735118
curr_Factors:  [99.70398245]
mat_Sqrt:  [[0.15]]
grads:  [0.00592578]
Stock Position:  0.00592578240668949
Bond Position:  [-13.11803084]


portfolio before change:  [-12.5309041]
curr_Stock_Price:  99.35676935503666
curr_Factors:  [99.35676936]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835375]
Stock Position:  -0.08353749872556958
Bond Position:  [-4.23088811]


portfolio before change:  [-12.39733966]
curr_Stock_Price:  97.75158195856964
curr_Factors:  [97.75158196]
mat_Sqrt:  [[0.15]]
grads:  [-0.06464484]
Stock Position:  -0.06464483931659096
Bond Position:  [-6.07820435]


portfolio before change:  [-12.38908538]
curr_Stock_Price:  97.61214158287228
curr_Factors:  [97.61214158]
mat_Sqrt:  [[0.15]]
grads:  [-0.05079705]
Stock Position:  -0.05079705118873957
Bond Position:  [-7.43067643]


portfolio before change:  [-12.39150477]
curr_Stock_Price:  97.64148377085579
curr_Factors:  [97.64148377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04754166]
Stock Position:  -0.04754166086783476
Bond Position:  [-7.74946646]


portfolio before change:  [-12.40838268]
curr_Stock_Price:  97.97612016714012
curr_Factors:  [97.97612017]
mat_Sqrt:  [[0.15]]
grads:  [0.14271754]
Stock Position:  0.14271754232539657
Bond Position:  [-26.39129376]


portfolio before change:  [-12.30745934]
curr_Stock_Price:  98.70639099245231
curr_Factors:  [98.70639099]
mat_Sqrt:  [[0.15]]
grads:  [0.05474535]
Stock Position:  0.05474535197307398
Bond Position:  [-17.71117546]


portfolio before change:  [-12.33900642]
curr_Stock_Price:  98.1705821217424
curr_Factors:  [98.17058212]
mat_Sqrt:  [[0.15]]
grads:  [0.15253431]
Stock Position:  0.15253431151935595
Bond Position:  [-27.31338858]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.33900642]
Stock Price:  98.7046113878252
PL:  [-12.33900642]
Settle:  Tensor("sub_336:0", shape=(), dtype=float64)
PL:  Tensor("sub_337:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  169
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.42691122e-03]
 [-7.07583554e-03]
 [ 8.28834950e-03]
 [-6.52135578e-03]
 [ 1.43704163e-02]
 [ 1.81293017e-02]
 [ 2.73110312e-02]
 [-2.32926068e-03]
 [ 2.77648735e-03]
 [ 2.70731792e-03]
 [ 1.23421120e-02]
 [ 1.19554284e-02]
 [-9.83890060e-03]
 [ 7.26866724e-03]
 [ 2.59864972e-03]
 [-2.97562866e-02]
 [ 4.91622605e-03]
 [-7.19590526e-03]
 [ 1.07432971e-03]
 [-3.10685755e-03]
 [-1.39114819e-03]
 [-3.76167177e-02]
 [ 4.80113834e-03]
 [ 8.96762592e-03]
 [-5.50955610e-03]
 [ 2.74085985e-04]
 [-3.35317891e-03]
 [-2.06294712e-03]
 [ 2.18140034e-02]
 [ 2.54033849e-02]
 [-1.33668448e-02]
 [ 6.55221871e-03]
 [-1.27793826e-02]
 [-2.21608624e-03]
 [-6.02916844e-03]
 [-8.29922577e-04]
 [ 2.33643544e-02]
 [-1.43360700e-04]
 [ 2.23159440e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [10.53185706]
curr_Stock_Price:  100.55350862344112
curr_Factors:  [100.55350862]
mat_Sqrt:  [[0.15]]
grads:  [-0.00951274]
Stock Position:  -0.009512741439941522
Bond Position:  [11.48839659]


portfolio before change:  [10.53921607]
curr_Stock_Price:  99.93088381246558
curr_Factors:  [99.93088381]
mat_Sqrt:  [[0.15]]
grads:  [-0.04717224]
Stock Position:  -0.04717223696331495
Bond Position:  [15.2531794]


portfolio before change:  [10.50641238]
curr_Stock_Price:  100.66670766380781
curr_Factors:  [100.66670766]
mat_Sqrt:  [[0.15]]
grads:  [0.05525566]
Stock Position:  0.05525566331993456
Bond Position:  [4.94400667]


portfolio before change:  [10.4486994]
curr_Stock_Price:  99.61105081594384
curr_Factors:  [99.61105082]
mat_Sqrt:  [[0.15]]
grads:  [-0.04347571]
Stock Position:  -0.04347570521924834
Bond Position:  [14.77936008]


portfolio before change:  [10.48927116]
curr_Stock_Price:  98.72034127163192
curr_Factors:  [98.72034127]
mat_Sqrt:  [[0.15]]
grads:  [0.09580278]
Stock Position:  0.09580277552126543
Bond Position:  [1.03158847]


portfolio before change:  [10.54377906]
curr_Stock_Price:  99.28795474391171
curr_Factors:  [99.28795474]
mat_Sqrt:  [[0.15]]
grads:  [0.12086201]
Stock Position:  0.12086201161689857
Bond Position:  [-1.45636288]


portfolio before change:  [10.61426859]
curr_Stock_Price:  99.8726842394691
curr_Factors:  [99.87268424]
mat_Sqrt:  [[0.15]]
grads:  [0.18207354]
Stock Position:  0.1820735415940358
Bond Position:  [-7.56990474]


portfolio before change:  [10.79191124]
curr_Stock_Price:  100.8535458314388
curr_Factors:  [100.85354583]
mat_Sqrt:  [[0.15]]
grads:  [-0.0155284]
Stock Position:  -0.015528404527294487
Bond Position:  [12.35800589]


portfolio before change:  [10.79190204]
curr_Stock_Price:  100.95362326143187
curr_Factors:  [100.95362326]
mat_Sqrt:  [[0.15]]
grads:  [0.01850992]
Stock Position:  0.018509915642847437
Bond Position:  [8.92325899]


portfolio before change:  [10.78214869]
curr_Stock_Price:  100.36643390032911
curr_Factors:  [100.3664339]
mat_Sqrt:  [[0.15]]
grads:  [0.01804879]
Stock Position:  0.01804878615574641
Bond Position:  [8.97065639]


portfolio before change:  [10.78447593]
curr_Stock_Price:  100.43324379570258
curr_Factors:  [100.4332438]
mat_Sqrt:  [[0.15]]
grads:  [0.08228075]
Stock Position:  0.08228074653903159
Bond Position:  [2.52075366]


portfolio before change:  [10.75467683]
curr_Stock_Price:  100.06725027075125
curr_Factors:  [100.06725027]
mat_Sqrt:  [[0.15]]
grads:  [0.07970286]
Stock Position:  0.0797028556790518
Bond Position:  [2.77903122]


portfolio before change:  [10.76906601]
curr_Stock_Price:  100.24342693383883
curr_Factors:  [100.24342693]
mat_Sqrt:  [[0.15]]
grads:  [-0.06559267]
Stock Position:  -0.06559267063430362
Bond Position:  [17.3443001]


portfolio before change:  [10.58501418]
curr_Stock_Price:  103.08246372768475
curr_Factors:  [103.08246373]
mat_Sqrt:  [[0.15]]
grads:  [0.04845778]
Stock Position:  0.04845778158185135
Bond Position:  [5.58986667]


portfolio before change:  [10.65738082]
curr_Stock_Price:  104.56143911495738
curr_Factors:  [104.56143911]
mat_Sqrt:  [[0.15]]
grads:  [0.01732433]
Stock Position:  0.01732433149846636
Bond Position:  [8.84592379]


portfolio before change:  [10.64876745]
curr_Stock_Price:  104.00042584211991
curr_Factors:  [104.00042584]
mat_Sqrt:  [[0.15]]
grads:  [-0.19837524]
Stock Position:  -0.19837524389070657
Bond Position:  [31.27987729]


portfolio before change:  [10.66590938]
curr_Stock_Price:  103.93372547302003
curr_Factors:  [103.93372547]
mat_Sqrt:  [[0.15]]
grads:  [0.03277484]
Stock Position:  0.03277484032866895
Bond Position:  [7.25949812]


portfolio before change:  [10.68077511]
curr_Stock_Price:  104.35960814017959
curr_Factors:  [104.35960814]
mat_Sqrt:  [[0.15]]
grads:  [-0.0479727]
Stock Position:  -0.04797270170567097
Bond Position:  [15.68718746]


portfolio before change:  [10.72732518]
curr_Stock_Price:  103.43014103003166
curr_Factors:  [103.43014103]
mat_Sqrt:  [[0.15]]
grads:  [0.0071622]
Stock Position:  0.007162198081829679
Bond Position:  [9.98653802]


portfolio before change:  [10.73026645]
curr_Stock_Price:  103.66650349520515
curr_Factors:  [103.6665035]
mat_Sqrt:  [[0.15]]
grads:  [-0.02071238]
Stock Position:  -0.02071238366705665
Bond Position:  [12.87744684]


portfolio before change:  [10.73592241]
curr_Stock_Price:  103.4711526316591
curr_Factors:  [103.47115263]
mat_Sqrt:  [[0.15]]
grads:  [-0.00927432]
Stock Position:  -0.009274321266194582
Bond Position:  [11.69554713]


portfolio before change:  [10.73449853]
curr_Stock_Price:  103.78232619951572
curr_Factors:  [103.7823262]
mat_Sqrt:  [[0.15]]
grads:  [-0.25077812]
Stock Position:  -0.25077811799541827
Bond Position:  [36.76083497]


portfolio before change:  [10.92288391]
curr_Stock_Price:  103.04944727627428
curr_Factors:  [103.04944728]
mat_Sqrt:  [[0.15]]
grads:  [0.03200759]
Stock Position:  0.032007588930932286
Bond Position:  [7.62451957]


portfolio before change:  [10.92990816]
curr_Stock_Price:  103.23912494738184
curr_Factors:  [103.23912495]
mat_Sqrt:  [[0.15]]
grads:  [0.05978417]
Stock Position:  0.05978417277608387
Bond Position:  [4.75784248]


portfolio before change:  [10.95122633]
curr_Stock_Price:  103.58576179817446
curr_Factors:  [103.5857618]
mat_Sqrt:  [[0.15]]
grads:  [-0.03673037]
Stock Position:  -0.036730373991648316
Bond Position:  [14.7559701]


portfolio before change:  [10.94480249]
curr_Stock_Price:  103.81087394749606
curr_Factors:  [103.81087395]
mat_Sqrt:  [[0.15]]
grads:  [0.00182724]
Stock Position:  0.0018272398981283508
Bond Position:  [10.75511512]


portfolio before change:  [10.94513974]
curr_Stock_Price:  103.25964982424543
curr_Factors:  [103.25964982]
mat_Sqrt:  [[0.15]]
grads:  [-0.02235453]
Stock Position:  -0.022354526097187237
Bond Position:  [13.25346028]


portfolio before change:  [10.9271062]
curr_Stock_Price:  104.14047048529895
curr_Factors:  [104.14047049]
mat_Sqrt:  [[0.15]]
grads:  [-0.01375298]
Stock Position:  -0.013752980783165645
Bond Position:  [12.35934809]


portfolio before change:  [10.93068924]
curr_Stock_Price:  103.99228276832625
curr_Factors:  [103.99228277]
mat_Sqrt:  [[0.15]]
grads:  [0.14542669]
Stock Position:  0.14542668957340923
Bond Position:  [-4.19256419]


portfolio before change:  [10.99596574]
curr_Stock_Price:  104.44474859929002
curr_Factors:  [104.4447486]
mat_Sqrt:  [[0.15]]
grads:  [0.1693559]
Stock Position:  0.16935589914164575
Bond Position:  [-6.69236857]


portfolio before change:  [10.88865131]
curr_Stock_Price:  103.81602629029983
curr_Factors:  [103.81602629]
mat_Sqrt:  [[0.15]]
grads:  [-0.0891123]
Stock Position:  -0.08911229841095138
Bond Position:  [20.13993603]


portfolio before change:  [11.06933251]
curr_Stock_Price:  101.8167113354152
curr_Factors:  [101.81671134]
mat_Sqrt:  [[0.15]]
grads:  [0.04368146]
Stock Position:  0.04368145808258512
Bond Position:  [6.6218301]


portfolio before change:  [11.10499525]
curr_Stock_Price:  102.61418842582634
curr_Factors:  [102.61418843]
mat_Sqrt:  [[0.15]]
grads:  [-0.08519588]
Stock Position:  -0.08519588412802422
Bond Position:  [19.84730176]


portfolio before change:  [11.05890941]
curr_Stock_Price:  103.18425009046803
curr_Factors:  [103.18425009]
mat_Sqrt:  [[0.15]]
grads:  [-0.01477391]
Stock Position:  -0.014773908288579843
Bond Position:  [12.58334406]


portfolio before change:  [11.04212714]
curr_Stock_Price:  104.42666275719519
curr_Factors:  [104.42666276]
mat_Sqrt:  [[0.15]]
grads:  [-0.04019446]
Stock Position:  -0.04019445623645123
Bond Position:  [15.23950007]


portfolio before change:  [11.06647986]
curr_Stock_Price:  103.8681862708552
curr_Factors:  [103.86818627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00553282]
Stock Position:  -0.005532817180208156
Bond Position:  [11.64116354]


portfolio before change:  [11.07379631]
curr_Stock_Price:  102.80883138513191
curr_Factors:  [102.80883139]
mat_Sqrt:  [[0.15]]
grads:  [0.15576236]
Stock Position:  0.15576236285000652
Bond Position:  [-4.93995019]


portfolio before change:  [11.03656256]
curr_Stock_Price:  102.57375392982397
curr_Factors:  [102.57375393]
mat_Sqrt:  [[0.15]]
grads:  [-0.00095574]
Stock Position:  -0.0009557380001977297
Bond Position:  [11.13459619]


portfolio before change:  [11.03839304]
curr_Stock_Price:  102.1148668058614
curr_Factors:  [102.11486681]
mat_Sqrt:  [[0.15]]
grads:  [0.14877296]
Stock Position:  0.14877295982176122
Bond Position:  [-4.15353793]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [11.03839304]
Stock Price:  102.12378776899212
PL:  [8.91460527]
Settle:  Tensor("sub_338:0", shape=(), dtype=float64)
PL:  Tensor("sub_339:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  170
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.88651104e-03]
 [-8.83298767e-03]
 [-4.43010803e-02]
 [-3.15326265e-02]
 [-1.93416823e-02]
 [ 2.47310397e-02]
 [ 4.45033796e-03]
 [-8.17836571e-03]
 [-3.46114287e-03]
 [ 2.03675420e-03]
 [-8.89822058e-02]
 [-1.82549605e-02]
 [ 1.05153380e-02]
 [ 8.46390237e-03]
 [ 9.85972362e-04]
 [-1.14445013e-02]
 [-5.80333669e-03]
 [-9.92383276e-04]
 [-7.55562588e-03]
 [-2.38306339e-03]
 [ 4.11082488e-04]
 [ 1.32485675e-02]
 [ 4.75752880e-03]
 [ 5.39852228e-03]
 [ 1.11541718e-03]
 [-7.27183706e-04]
 [ 1.27649409e-02]
 [-1.84432955e-02]
 [-1.95960620e-02]
 [ 2.14841781e-02]
 [ 2.60416422e-03]
 [-1.27961459e-02]
 [-1.22517536e-02]
 [-2.42724261e-03]
 [-6.60637524e-03]
 [-3.77644102e-03]
 [ 1.90216043e-02]
 [ 9.70896312e-03]
 [ 2.09710929e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-18.38661399]
curr_Stock_Price:  98.69052084037598
curr_Factors:  [98.69052084]
mat_Sqrt:  [[0.15]]
grads:  [-0.03924341]
Stock Position:  -0.03924340690012654
Bond Position:  [-14.51366172]


portfolio before change:  [-18.36647215]
curr_Stock_Price:  98.13103433638666
curr_Factors:  [98.13103434]
mat_Sqrt:  [[0.15]]
grads:  [-0.05888658]
Stock Position:  -0.05888658449554246
Bond Position:  [-12.58787071]


portfolio before change:  [-18.32254412]
curr_Stock_Price:  97.3583351999304
curr_Factors:  [97.3583352]
mat_Sqrt:  [[0.15]]
grads:  [-0.29534054]
Stock Position:  -0.2953405352178148
Bond Position:  [10.4313187]


portfolio before change:  [-18.17686421]
curr_Stock_Price:  96.86948961130636
curr_Factors:  [96.86948961]
mat_Sqrt:  [[0.15]]
grads:  [-0.21021751]
Stock Position:  -0.2102175099334639
Bond Position:  [2.18679869]


portfolio before change:  [-18.00630704]
curr_Stock_Price:  96.05945336526045
curr_Factors:  [96.05945337]
mat_Sqrt:  [[0.15]]
grads:  [-0.12894455]
Stock Position:  -0.12894454888725612
Bond Position:  [-5.61996416]


portfolio before change:  [-18.06884269]
curr_Stock_Price:  96.53898592368151
curr_Factors:  [96.53898592]
mat_Sqrt:  [[0.15]]
grads:  [0.1648736]
Stock Position:  0.16487359818995773
Bond Position:  [-33.98557266]


portfolio before change:  [-17.8788692]
curr_Stock_Price:  97.71699109910932
curr_Factors:  [97.7169911]
mat_Sqrt:  [[0.15]]
grads:  [0.02966892]
Stock Position:  0.02966891970218601
Bond Position:  [-20.77802676]


portfolio before change:  [-17.89456374]
curr_Stock_Price:  97.27554853619775
curr_Factors:  [97.27554854]
mat_Sqrt:  [[0.15]]
grads:  [-0.05452244]
Stock Position:  -0.054522438068492475
Bond Position:  [-12.59086367]


portfolio before change:  [-17.84048482]
curr_Stock_Price:  96.25481510940115
curr_Factors:  [96.25481511]
mat_Sqrt:  [[0.15]]
grads:  [-0.02307429]
Stock Position:  -0.02307428581149154
Bond Position:  [-15.6194737]


portfolio before change:  [-17.84646825]
curr_Stock_Price:  96.42950626490824
curr_Factors:  [96.42950626]
mat_Sqrt:  [[0.15]]
grads:  [0.01357836]
Stock Position:  0.013578361308710235
Bond Position:  [-19.15582293]


portfolio before change:  [-17.85732857]
curr_Stock_Price:  95.80603678242903
curr_Factors:  [95.80603678]
mat_Sqrt:  [[0.15]]
grads:  [-0.59321471]
Stock Position:  -0.5932147055256365
Bond Position:  [38.97622133]


portfolio before change:  [-17.84851933]
curr_Stock_Price:  95.79940021314725
curr_Factors:  [95.79940021]
mat_Sqrt:  [[0.15]]
grads:  [-0.12169974]
Stock Position:  -0.1216997368637826
Bond Position:  [-6.18975753]


portfolio before change:  [-17.95763256]
curr_Stock_Price:  96.689619569067
curr_Factors:  [96.68961957]
mat_Sqrt:  [[0.15]]
grads:  [0.07010225]
Stock Position:  0.07010225316033104
Bond Position:  [-24.73579275]


portfolio before change:  [-17.89709283]
curr_Stock_Price:  97.59732067976631
curr_Factors:  [97.59732068]
mat_Sqrt:  [[0.15]]
grads:  [0.05642602]
Stock Position:  0.05642601579783225
Bond Position:  [-23.40412079]


portfolio before change:  [-17.87111598]
curr_Stock_Price:  98.10954088710109
curr_Factors:  [98.10954089]
mat_Sqrt:  [[0.15]]
grads:  [0.00657315]
Stock Position:  0.006573149078724824
Bond Position:  [-18.51600462]


portfolio before change:  [-17.88114035]
curr_Stock_Price:  96.93662985603251
curr_Factors:  [96.93662986]
mat_Sqrt:  [[0.15]]
grads:  [-0.07629668]
Stock Position:  -0.07629667525861508
Bond Position:  [-10.48519778]


portfolio before change:  [-17.93522358]
curr_Stock_Price:  97.62830482824803
curr_Factors:  [97.62830483]
mat_Sqrt:  [[0.15]]
grads:  [-0.03868891]
Stock Position:  -0.03868891124234781
Bond Position:  [-14.15809076]


portfolio before change:  [-17.94006164]
curr_Stock_Price:  97.70760893883502
curr_Factors:  [97.70760894]
mat_Sqrt:  [[0.15]]
grads:  [-0.00661589]
Stock Position:  -0.006615888509457281
Bond Position:  [-17.293639]


portfolio before change:  [-17.9424139]
curr_Stock_Price:  97.7363900919944
curr_Factors:  [97.73639009]
mat_Sqrt:  [[0.15]]
grads:  [-0.05037084]
Stock Position:  -0.05037083919082814
Bond Position:  [-13.01934991]


portfolio before change:  [-17.95708998]
curr_Stock_Price:  97.99544010749261
curr_Factors:  [97.99544011]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588709]
Stock Position:  -0.015887089275654954
Bond Position:  [-16.40022768]


portfolio before change:  [-17.95525282]
curr_Stock_Price:  97.75075570581555
curr_Factors:  [97.75075571]
mat_Sqrt:  [[0.15]]
grads:  [0.00274055]
Stock Position:  0.002740549922656479
Bond Position:  [-18.22314364]


portfolio before change:  [-17.96066308]
curr_Stock_Price:  96.60783760087241
curr_Factors:  [96.6078376]
mat_Sqrt:  [[0.15]]
grads:  [0.08832378]
Stock Position:  0.08832378346149856
Bond Position:  [-26.4934328]


portfolio before change:  [-17.97047873]
curr_Stock_Price:  96.53420205667564
curr_Factors:  [96.53420206]
mat_Sqrt:  [[0.15]]
grads:  [0.03171686]
Stock Position:  0.031716858688138255
Bond Position:  [-21.03224038]


portfolio before change:  [-17.97575597]
curr_Stock_Price:  96.45071187003781
curr_Factors:  [96.45071187]
mat_Sqrt:  [[0.15]]
grads:  [0.03599015]
Stock Position:  0.035990148519695994
Bond Position:  [-21.44703142]


portfolio before change:  [-18.00150919]
curr_Stock_Price:  95.8096428477662
curr_Factors:  [95.80964285]
mat_Sqrt:  [[0.15]]
grads:  [0.00743611]
Stock Position:  0.007436114513128863
Bond Position:  [-18.71396066]


portfolio before change:  [-18.01695585]
curr_Stock_Price:  94.04699303091276
curr_Factors:  [94.04699303]
mat_Sqrt:  [[0.15]]
grads:  [-0.00484789]
Stock Position:  -0.004847891371193026
Bond Position:  [-17.56102624]


portfolio before change:  [-18.01735966]
curr_Stock_Price:  93.67746028012428
curr_Factors:  [93.67746028]
mat_Sqrt:  [[0.15]]
grads:  [0.08509961]
Stock Position:  0.08509960573863214
Bond Position:  [-25.98927459]


portfolio before change:  [-17.89703542]
curr_Stock_Price:  95.12955976345832
curr_Factors:  [95.12955976]
mat_Sqrt:  [[0.15]]
grads:  [-0.1229553]
Stock Position:  -0.12295530346851154
Bond Position:  [-6.20035154]


portfolio before change:  [-17.70372167]
curr_Stock_Price:  93.5510280060961
curr_Factors:  [93.55102801]
mat_Sqrt:  [[0.15]]
grads:  [-0.13064041]
Stock Position:  -0.130640413080077
Bond Position:  [-5.48217672]


portfolio before change:  [-17.58780057]
curr_Stock_Price:  92.65845263753445
curr_Factors:  [92.65845264]
mat_Sqrt:  [[0.15]]
grads:  [0.14322785]
Stock Position:  0.1432278542178095
Bond Position:  [-30.85907191]


portfolio before change:  [-17.37797787]
curr_Stock_Price:  94.1503434871261
curr_Factors:  [94.15034349]
mat_Sqrt:  [[0.15]]
grads:  [0.01736109]
Stock Position:  0.017361094789747452
Bond Position:  [-19.0125309]


portfolio before change:  [-17.39580487]
curr_Stock_Price:  93.26040624676519
curr_Factors:  [93.26040625]
mat_Sqrt:  [[0.15]]
grads:  [-0.08530764]
Stock Position:  -0.08530763956887162
Bond Position:  [-9.43997974]


portfolio before change:  [-17.4241516]
curr_Stock_Price:  93.5788614150258
curr_Factors:  [93.57886142]
mat_Sqrt:  [[0.15]]
grads:  [-0.08167836]
Stock Position:  -0.08167835739996379
Bond Position:  [-9.78078391]


portfolio before change:  [-17.33861251]
curr_Stock_Price:  92.51662462831652
curr_Factors:  [92.51662463]
mat_Sqrt:  [[0.15]]
grads:  [-0.01618162]
Stock Position:  -0.01618161742024837
Bond Position:  [-15.84154389]


portfolio before change:  [-17.34726618]
curr_Stock_Price:  92.92902761681162
curr_Factors:  [92.92902762]
mat_Sqrt:  [[0.15]]
grads:  [-0.0440425]
Stock Position:  -0.04404250157402418
Bond Position:  [-13.25443933]


portfolio before change:  [-17.43051479]
curr_Stock_Price:  94.78159495055698
curr_Factors:  [94.78159495]
mat_Sqrt:  [[0.15]]
grads:  [-0.02517627]
Stock Position:  -0.025176273485935218
Bond Position:  [-15.04426743]


portfolio before change:  [-17.44721329]
curr_Stock_Price:  95.37015900354696
curr_Factors:  [95.370159]
mat_Sqrt:  [[0.15]]
grads:  [0.1268107]
Stock Position:  0.12681069534951497
Bond Position:  [-29.54116947]


portfolio before change:  [-17.4354099]
curr_Stock_Price:  95.4923589498693
curr_Factors:  [95.49235895]
mat_Sqrt:  [[0.15]]
grads:  [0.06472642]
Stock Position:  0.0647264207913958
Bond Position:  [-23.61628851]


portfolio before change:  [-17.39065816]
curr_Stock_Price:  96.22936806581183
curr_Factors:  [96.22936807]
mat_Sqrt:  [[0.15]]
grads:  [0.13980729]
Stock Position:  0.13980728627682582
Bond Position:  [-30.84422497]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-17.39065816]
Stock Price:  95.85864844103686
PL:  [-17.39065816]
Settle:  Tensor("sub_340:0", shape=(), dtype=float64)
PL:  Tensor("sub_341:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  171
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.34618911e-03]
 [-1.45895127e-02]
 [-3.26083956e-03]
 [-6.31424427e-03]
 [ 1.07443050e-02]
 [ 1.73641258e-02]
 [ 2.20972738e-02]
 [-3.36587488e-03]
 [ 1.44554312e-02]
 [ 5.70930690e-04]
 [-4.75125806e-02]
 [-2.29719651e-03]
 [ 7.14975531e-03]
 [ 7.41212088e-03]
 [ 2.10816951e-03]
 [-1.23543688e-02]
 [-3.93502025e-03]
 [-2.17103580e-03]
 [-7.58143291e-03]
 [-2.38063455e-03]
 [ 4.05620220e-04]
 [ 8.74281589e-03]
 [ 4.76703650e-03]
 [ 6.01350602e-03]
 [-3.33912292e-03]
 [-5.85562088e-03]
 [-2.56378508e-03]
 [-1.91302211e-02]
 [-2.84005078e-02]
 [ 2.17908172e-02]
 [ 2.65142908e-03]
 [-9.87408847e-03]
 [-1.24189466e-02]
 [-9.67455697e-03]
 [-7.07864625e-03]
 [-6.16791395e-03]
 [ 2.13981300e-02]
 [ 8.65396841e-03]
 [ 2.25262325e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.90531698]
curr_Stock_Price:  100.89967803749904
curr_Factors:  [100.89967804]
mat_Sqrt:  [[0.15]]
grads:  [-0.01564126]
Stock Position:  -0.015641260739571203
Bond Position:  [17.48351515]


portfolio before change:  [15.91527819]
curr_Stock_Price:  100.40255452420992
curr_Factors:  [100.40255452]
mat_Sqrt:  [[0.15]]
grads:  [-0.09726342]
Stock Position:  -0.09726341782006781
Bond Position:  [25.68077381]


portfolio before change:  [16.01981557]
curr_Stock_Price:  99.3607745535497
curr_Factors:  [99.36077455]
mat_Sqrt:  [[0.15]]
grads:  [-0.02173893]
Stock Position:  -0.02173893042359814
Bond Position:  [18.17981254]


portfolio before change:  [16.0139486]
curr_Stock_Price:  99.73519895563797
curr_Factors:  [99.73519896]
mat_Sqrt:  [[0.15]]
grads:  [-0.04209496]
Stock Position:  -0.042094961806762386
Bond Position:  [20.212298]


portfolio before change:  [16.02576808]
curr_Stock_Price:  99.51444134665805
curr_Factors:  [99.51444135]
mat_Sqrt:  [[0.15]]
grads:  [0.0716287]
Stock Position:  0.07162870027742399
Bond Position:  [8.89767799]


portfolio before change:  [16.01989652]
curr_Stock_Price:  99.41694071666734
curr_Factors:  [99.41694072]
mat_Sqrt:  [[0.15]]
grads:  [0.11576084]
Stock Position:  0.11576083874576744
Bond Position:  [4.51130808]


portfolio before change:  [16.01689168]
curr_Stock_Price:  99.38611178138446
curr_Factors:  [99.38611178]
mat_Sqrt:  [[0.15]]
grads:  [0.14731516]
Stock Position:  0.14731515886064814
Bond Position:  [1.37581084]


portfolio before change:  [15.94353988]
curr_Stock_Price:  98.88701994154398
curr_Factors:  [98.88701994]
mat_Sqrt:  [[0.15]]
grads:  [-0.02243917]
Stock Position:  -0.02243916587594073
Bond Position:  [18.16248212]


portfolio before change:  [15.95373212]
curr_Stock_Price:  98.53398568009085
curr_Factors:  [98.53398568]
mat_Sqrt:  [[0.15]]
grads:  [0.09636954]
Stock Position:  0.09636954145239007
Bond Position:  [6.45805711]


portfolio before change:  [15.81434816]
curr_Stock_Price:  97.07925976213613
curr_Factors:  [97.07925976]
mat_Sqrt:  [[0.15]]
grads:  [0.0038062]
Stock Position:  0.0038062045983042886
Bond Position:  [15.44484464]


portfolio before change:  [15.81544972]
curr_Stock_Price:  96.8614131105146
curr_Factors:  [96.86141311]
mat_Sqrt:  [[0.15]]
grads:  [-0.31675054]
Stock Position:  -0.31675053747383963
Bond Position:  [46.49635438]


portfolio before change:  [15.4790127]
curr_Stock_Price:  97.94191460522796
curr_Factors:  [97.94191461]
mat_Sqrt:  [[0.15]]
grads:  [-0.01531464]
Stock Position:  -0.015314643401832934
Bond Position:  [16.97895819]


portfolio before change:  [15.48185716]
curr_Stock_Price:  97.8947727065435
curr_Factors:  [97.89477271]
mat_Sqrt:  [[0.15]]
grads:  [0.04766504]
Stock Position:  0.04766503540727516
Bond Position:  [10.81569935]


portfolio before change:  [15.45142713]
curr_Stock_Price:  97.22799294899552
curr_Factors:  [97.22799295]
mat_Sqrt:  [[0.15]]
grads:  [0.04941414]
Stock Position:  0.049414139217731363
Bond Position:  [10.64698955]


portfolio before change:  [15.48697619]
curr_Stock_Price:  97.92046899875474
curr_Factors:  [97.920469]
mat_Sqrt:  [[0.15]]
grads:  [0.01405446]
Stock Position:  0.014054463387418113
Bond Position:  [14.11075655]


portfolio before change:  [15.47997265]
curr_Stock_Price:  97.29664565565683
curr_Factors:  [97.29664566]
mat_Sqrt:  [[0.15]]
grads:  [-0.08236246]
Stock Position:  -0.08236245855099678
Bond Position:  [23.49356359]


portfolio before change:  [15.40289587]
curr_Stock_Price:  98.2681277168326
curr_Factors:  [98.26812772]
mat_Sqrt:  [[0.15]]
grads:  [-0.02623347]
Stock Position:  -0.026233468302991413
Bond Position:  [17.98080969]


portfolio before change:  [15.40353963]
curr_Stock_Price:  98.32927043276355
curr_Factors:  [98.32927043]
mat_Sqrt:  [[0.15]]
grads:  [-0.01447357]
Stock Position:  -0.014473572032938134
Bond Position:  [16.82671541]


portfolio before change:  [15.41825968]
curr_Stock_Price:  97.45757262183845
curr_Factors:  [97.45757262]
mat_Sqrt:  [[0.15]]
grads:  [-0.05054289]
Stock Position:  -0.05054288606171511
Bond Position:  [20.34404667]


portfolio before change:  [15.39151347]
curr_Stock_Price:  98.03706817106911
curr_Factors:  [98.03706817]
mat_Sqrt:  [[0.15]]
grads:  [-0.0158709]
Stock Position:  -0.015870897006736877
Bond Position:  [16.94744968]


portfolio before change:  [15.397767]
curr_Stock_Price:  97.7765304447805
curr_Factors:  [97.77653044]
mat_Sqrt:  [[0.15]]
grads:  [0.00270413]
Stock Position:  0.0027041348018568517
Bond Position:  [15.13336608]


portfolio before change:  [15.40091789]
curr_Stock_Price:  98.2421495573367
curr_Factors:  [98.24214956]
mat_Sqrt:  [[0.15]]
grads:  [0.05828544]
Stock Position:  0.058285439235965825
Bond Position:  [9.67483105]


portfolio before change:  [15.41962657]
curr_Stock_Price:  98.54238329344942
curr_Factors:  [98.54238329]
mat_Sqrt:  [[0.15]]
grads:  [0.03178024]
Stock Position:  0.031780243352162584
Bond Position:  [12.28792565]


portfolio before change:  [15.44292676]
curr_Stock_Price:  99.22721446467816
curr_Factors:  [99.22721446]
mat_Sqrt:  [[0.15]]
grads:  [0.04009004]
Stock Position:  0.04009004015336933
Bond Position:  [11.46490375]


portfolio before change:  [15.45192166]
curr_Stock_Price:  99.41583235462409
curr_Factors:  [99.41583235]
mat_Sqrt:  [[0.15]]
grads:  [-0.02226082]
Stock Position:  -0.0222608194630818
Bond Position:  [17.66499956]


portfolio before change:  [15.47777828]
curr_Stock_Price:  98.35350129028485
curr_Factors:  [98.35350129]
mat_Sqrt:  [[0.15]]
grads:  [-0.03903747]
Stock Position:  -0.039037472535657154
Bond Position:  [19.31725039]


portfolio before change:  [15.48118017]
curr_Stock_Price:  98.32821584286275
curr_Factors:  [98.32821584]
mat_Sqrt:  [[0.15]]
grads:  [-0.0170919]
Stock Position:  -0.017091900530271792
Bond Position:  [17.16179625]


portfolio before change:  [15.51060884]
curr_Stock_Price:  96.73194438526691
curr_Factors:  [96.73194439]
mat_Sqrt:  [[0.15]]
grads:  [-0.12753481]
Stock Position:  -0.12753480750510474
Bond Position:  [27.84729875]


portfolio before change:  [15.61401273]
curr_Stock_Price:  95.94845033398234
curr_Factors:  [95.94845033]
mat_Sqrt:  [[0.15]]
grads:  [-0.18933672]
Stock Position:  -0.18933671862096177
Bond Position:  [33.78057748]


portfolio before change:  [15.71239837]
curr_Stock_Price:  95.45112051062435
curr_Factors:  [95.45112051]
mat_Sqrt:  [[0.15]]
grads:  [0.14527211]
Stock Position:  0.14527211472836393
Bond Position:  [1.84601224]


portfolio before change:  [15.74476511]
curr_Stock_Price:  95.67233278287473
curr_Factors:  [95.67233278]
mat_Sqrt:  [[0.15]]
grads:  [0.01767619]
Stock Position:  0.017676193845868316
Bond Position:  [14.05364241]


portfolio before change:  [15.72637696]
curr_Stock_Price:  94.53266656595355
curr_Factors:  [94.53266657]
mat_Sqrt:  [[0.15]]
grads:  [-0.06582726]
Stock Position:  -0.06582725646447081
Bond Position:  [21.94920305]


portfolio before change:  [15.66030439]
curr_Stock_Price:  95.57807543944334
curr_Factors:  [95.57807544]
mat_Sqrt:  [[0.15]]
grads:  [-0.08279298]
Stock Position:  -0.08279297764025742
Bond Position:  [23.57349785]


portfolio before change:  [15.60175096]
curr_Stock_Price:  96.3208957068891
curr_Factors:  [96.32089571]
mat_Sqrt:  [[0.15]]
grads:  [-0.06449705]
Stock Position:  -0.06449704645305997
Bond Position:  [21.81416424]


portfolio before change:  [15.56661835]
curr_Stock_Price:  96.9078923352175
curr_Factors:  [96.90789234]
mat_Sqrt:  [[0.15]]
grads:  [-0.04719097]
Stock Position:  -0.047190974974567056
Bond Position:  [20.13979627]


portfolio before change:  [15.5732712]
curr_Stock_Price:  96.82026496320375
curr_Factors:  [96.82026496]
mat_Sqrt:  [[0.15]]
grads:  [-0.04111943]
Stock Position:  -0.04111942632917874
Bond Position:  [19.55446495]


portfolio before change:  [15.52856798]
curr_Stock_Price:  97.96686851558884
curr_Factors:  [97.96686852]
mat_Sqrt:  [[0.15]]
grads:  [0.1426542]
Stock Position:  0.14265420006504903
Bond Position:  [1.55318272]


portfolio before change:  [15.4752999]
curr_Stock_Price:  97.59210042206327
curr_Factors:  [97.59210042]
mat_Sqrt:  [[0.15]]
grads:  [0.05769312]
Stock Position:  0.05769312272544107
Bond Position:  [9.84490687]


portfolio before change:  [15.4814304]
curr_Stock_Price:  97.67702924758326
curr_Factors:  [97.67702925]
mat_Sqrt:  [[0.15]]
grads:  [0.15017488]
Stock Position:  0.150174883395276
Bond Position:  [0.81279392]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.4814304]
Stock Price:  96.4854665869122
PL:  [15.4814304]
Settle:  Tensor("sub_342:0", shape=(), dtype=float64)
PL:  Tensor("sub_343:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  172
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-6.17912795e-03]
 [-9.02680995e-03]
 [-2.10702366e-02]
 [-6.25156242e-03]
 [ 2.02612163e-02]
 [ 2.48734594e-02]
 [ 1.38464461e-02]
 [-1.57574917e-04]
 [ 8.71379153e-03]
 [ 1.24842468e-02]
 [ 1.87517287e-02]
 [-1.12173240e-02]
 [-1.22094544e-02]
 [-1.43982560e-02]
 [ 6.04819938e-03]
 [-3.97116803e-02]
 [ 4.61286106e-03]
 [-1.05533504e-02]
 [ 1.02608827e-02]
 [-3.89400791e-03]
 [-2.88857869e-03]
 [-3.92227942e-02]
 [ 4.83628939e-03]
 [ 1.26518880e-02]
 [-6.18000452e-03]
 [ 2.48122897e-02]
 [-1.87484081e-02]
 [ 1.36636831e-02]
 [ 9.11962515e-02]
 [ 2.86409340e-02]
 [-4.43099347e-02]
 [ 3.77665165e-03]
 [-1.32341535e-02]
 [ 5.41529294e-03]
 [-7.32055629e-03]
 [ 4.62442197e-03]
 [ 2.47252501e-02]
 [ 5.78442273e-03]
 [ 1.96006666e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-20.72872968]
curr_Stock_Price:  98.53963689783191
curr_Factors:  [98.5396369]
mat_Sqrt:  [[0.15]]
grads:  [-0.04119419]
Stock Position:  -0.041194186313826604
Bond Position:  [-16.66946952]


portfolio before change:  [-20.71298332]
curr_Stock_Price:  98.10680454024002
curr_Factors:  [98.10680454]
mat_Sqrt:  [[0.15]]
grads:  [-0.06017873]
Stock Position:  -0.060178733024066774
Bond Position:  [-14.80904012]


portfolio before change:  [-20.75303555]
curr_Stock_Price:  98.7415966418956
curr_Factors:  [98.74159664]
mat_Sqrt:  [[0.15]]
grads:  [-0.14046824]
Stock Position:  -0.14046824394531993
Bond Position:  [-6.88297687]


portfolio before change:  [-20.89874338]
curr_Stock_Price:  99.77277211926427
curr_Factors:  [99.77277212]
mat_Sqrt:  [[0.15]]
grads:  [-0.04167708]
Stock Position:  -0.04167708282531976
Bond Position:  [-16.7405053]


portfolio before change:  [-20.95386683]
curr_Stock_Price:  101.04519204415733
curr_Factors:  [101.04519204]
mat_Sqrt:  [[0.15]]
grads:  [0.13507478]
Stock Position:  0.13507477564216974
Bond Position:  [-34.60252347]


portfolio before change:  [-20.981819]
curr_Stock_Price:  100.87027717516976
curr_Factors:  [100.87027718]
mat_Sqrt:  [[0.15]]
grads:  [0.16582306]
Stock Position:  0.16582306288758422
Bond Position:  [-37.70843732]


portfolio before change:  [-20.86358149]
curr_Stock_Price:  101.61173835963973
curr_Factors:  [101.61173836]
mat_Sqrt:  [[0.15]]
grads:  [0.09230964]
Stock Position:  0.09230964093140447
Bond Position:  [-30.24332457]


portfolio before change:  [-20.84746202]
curr_Stock_Price:  101.82731837793618
curr_Factors:  [101.82731838]
mat_Sqrt:  [[0.15]]
grads:  [-0.0010505]
Stock Position:  -0.0010504994445553184
Bond Position:  [-20.74049248]


portfolio before change:  [-20.85063249]
curr_Stock_Price:  102.37728458760158
curr_Factors:  [102.37728459]
mat_Sqrt:  [[0.15]]
grads:  [0.05809194]
Stock Position:  0.05809194355136153
Bond Position:  [-26.79792792]


portfolio before change:  [-20.82191672]
curr_Stock_Price:  102.92926679628313
curr_Factors:  [102.9292668]
mat_Sqrt:  [[0.15]]
grads:  [0.08322831]
Stock Position:  0.08322831180234745
Bond Position:  [-29.38854583]


portfolio before change:  [-20.7180141]
curr_Stock_Price:  104.22181272620385
curr_Factors:  [104.22181273]
mat_Sqrt:  [[0.15]]
grads:  [0.12501152]
Stock Position:  0.12501152477256577
Bond Position:  [-33.74694182]


portfolio before change:  [-20.70697613]
curr_Stock_Price:  104.3438542741743
curr_Factors:  [104.34385427]
mat_Sqrt:  [[0.15]]
grads:  [-0.07478216]
Stock Position:  -0.07478215986774811
Bond Position:  [-12.90391734]


portfolio before change:  [-20.7501027]
curr_Stock_Price:  104.89897965229783
curr_Factors:  [104.89897965]
mat_Sqrt:  [[0.15]]
grads:  [-0.08139636]
Stock Position:  -0.0813963626153863
Bond Position:  [-12.21170731]


portfolio before change:  [-20.82164776]
curr_Stock_Price:  105.75919622542389
curr_Factors:  [105.75919623]
mat_Sqrt:  [[0.15]]
grads:  [-0.09598837]
Stock Position:  -0.09598837335376585
Bond Position:  [-10.66999454]


portfolio before change:  [-20.86061509]
curr_Stock_Price:  106.15125930695739
curr_Factors:  [106.15125931]
mat_Sqrt:  [[0.15]]
grads:  [0.04032133]
Stock Position:  0.04032132919452716
Bond Position:  [-25.14077496]


portfolio before change:  [-20.79707332]
curr_Stock_Price:  107.80508782222013
curr_Factors:  [107.80508782]
mat_Sqrt:  [[0.15]]
grads:  [-0.26474454]
Stock Position:  -0.2647445350615624
Bond Position:  [7.74373454]


portfolio before change:  [-20.47406895]
curr_Stock_Price:  106.58868373737099
curr_Factors:  [106.58868374]
mat_Sqrt:  [[0.15]]
grads:  [0.03075241]
Stock Position:  0.030752407082535356
Bond Position:  [-23.75192755]


portfolio before change:  [-20.50996423]
curr_Stock_Price:  105.51799993499684
curr_Factors:  [105.51799993]
mat_Sqrt:  [[0.15]]
grads:  [-0.07035567]
Stock Position:  -0.07035566935773901
Bond Position:  [-13.08617472]


portfolio before change:  [-20.50791937]
curr_Stock_Price:  105.46568382134177
curr_Factors:  [105.46568382]
mat_Sqrt:  [[0.15]]
grads:  [0.06840588]
Stock Position:  0.06840588480974207
Bond Position:  [-27.72239279]


portfolio before change:  [-20.52996785]
curr_Stock_Price:  105.19402648587837
curr_Factors:  [105.19402649]
mat_Sqrt:  [[0.15]]
grads:  [-0.02596005]
Stock Position:  -0.02596005271316322
Bond Position:  [-17.79912538]


portfolio before change:  [-20.56814556]
curr_Stock_Price:  106.57894989338435
curr_Factors:  [106.57894989]
mat_Sqrt:  [[0.15]]
grads:  [-0.01925719]
Stock Position:  -0.01925719129169405
Bond Position:  [-18.51573434]


portfolio before change:  [-20.57408027]
curr_Stock_Price:  106.76693670711485
curr_Factors:  [106.76693671]
mat_Sqrt:  [[0.15]]
grads:  [-0.26148529]
Stock Position:  -0.26148529486829475
Bond Position:  [7.34390365]


portfolio before change:  [-20.42556493]
curr_Stock_Price:  106.20247933756022
curr_Factors:  [106.20247934]
mat_Sqrt:  [[0.15]]
grads:  [0.03224193]
Stock Position:  0.03224192927640552
Bond Position:  [-23.84973775]


portfolio before change:  [-20.41423317]
curr_Stock_Price:  106.64640940343605
curr_Factors:  [106.6464094]
mat_Sqrt:  [[0.15]]
grads:  [0.08434592]
Stock Position:  0.08434591974856505
Bond Position:  [-29.40942266]


portfolio before change:  [-20.31484246]
curr_Stock_Price:  107.86836678066635
curr_Factors:  [107.86836678]
mat_Sqrt:  [[0.15]]
grads:  [-0.04120003]
Stock Position:  -0.041200030101218435
Bond Position:  [-15.8706625]


portfolio before change:  [-20.34995674]
curr_Stock_Price:  108.67250043513027
curr_Factors:  [108.67250044]
mat_Sqrt:  [[0.15]]
grads:  [0.16541526]
Stock Position:  0.16541526470115442
Bond Position:  [-38.32604717]


portfolio before change:  [-20.35440737]
curr_Stock_Price:  108.67455845170032
curr_Factors:  [108.67455845]
mat_Sqrt:  [[0.15]]
grads:  [-0.12498939]
Stock Position:  -0.12498938760332096
Bond Position:  [-6.77124086]


portfolio before change:  [-20.29430636]
curr_Stock_Price:  108.18693729990417
curr_Factors:  [108.1869373]
mat_Sqrt:  [[0.15]]
grads:  [0.09109122]
Stock Position:  0.0910912204364262
Bond Position:  [-30.14918652]


portfolio before change:  [-20.24941151]
curr_Stock_Price:  108.72116804893163
curr_Factors:  [108.72116805]
mat_Sqrt:  [[0.15]]
grads:  [0.60797501]
Stock Position:  0.6079750099898625
Bond Position:  [-86.34916475]


portfolio before change:  [-19.89693426]
curr_Stock_Price:  109.31867875796097
curr_Factors:  [109.31867876]
mat_Sqrt:  [[0.15]]
grads:  [0.19093956]
Stock Position:  0.1909395603223145
Bond Position:  [-40.77019471]


portfolio before change:  [-19.91635919]
curr_Stock_Price:  109.24363754163517
curr_Factors:  [109.24363754]
mat_Sqrt:  [[0.15]]
grads:  [-0.29539956]
Stock Position:  -0.29539956440182835
Bond Position:  [12.35416376]


portfolio before change:  [-19.29245792]
curr_Stock_Price:  107.13680675723917
curr_Factors:  [107.13680676]
mat_Sqrt:  [[0.15]]
grads:  [0.02517768]
Stock Position:  0.025177677692644524
Bond Position:  [-21.98991391]


portfolio before change:  [-19.29025795]
curr_Stock_Price:  107.333365020572
curr_Factors:  [107.33336502]
mat_Sqrt:  [[0.15]]
grads:  [-0.08822769]
Stock Position:  -0.08822768975633417
Bond Position:  [-9.82048312]


portfolio before change:  [-19.28027893]
curr_Stock_Price:  107.20634521474243
curr_Factors:  [107.20634521]
mat_Sqrt:  [[0.15]]
grads:  [0.03610195]
Stock Position:  0.03610195292928403
Bond Position:  [-23.15063735]


portfolio before change:  [-19.26579857]
curr_Stock_Price:  107.68760348012347
curr_Factors:  [107.68760348]
mat_Sqrt:  [[0.15]]
grads:  [-0.04880371]
Stock Position:  -0.04880370862728984
Bond Position:  [-14.01024415]


portfolio before change:  [-19.21616379]
curr_Stock_Price:  106.63468817995779
curr_Factors:  [106.63468818]
mat_Sqrt:  [[0.15]]
grads:  [0.03082948]
Stock Position:  0.030829479800657117
Bond Position:  [-22.50365576]


portfolio before change:  [-19.19536685]
curr_Stock_Price:  107.40051592082635
curr_Factors:  [107.40051592]
mat_Sqrt:  [[0.15]]
grads:  [0.164835]
Stock Position:  0.16483500058419204
Bond Position:  [-36.89873096]


portfolio before change:  [-19.34945058]
curr_Stock_Price:  106.49372368847058
curr_Factors:  [106.49372369]
mat_Sqrt:  [[0.15]]
grads:  [0.03856282]
Stock Position:  0.03856281818563256
Bond Position:  [-23.45614869]


portfolio before change:  [-19.37396504]
curr_Stock_Price:  105.93405873666829
curr_Factors:  [105.93405874]
mat_Sqrt:  [[0.15]]
grads:  [0.13067111]
Stock Position:  0.13067111081286997
Bond Position:  [-33.21648617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-19.37396504]
Stock Price:  105.50584049213724
PL:  [-24.87980553]
Settle:  Tensor("sub_344:0", shape=(), dtype=float64)
PL:  Tensor("sub_345:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  173
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.49131090e-03]
 [-7.41705452e-03]
 [-6.50743762e-03]
 [-1.09556507e-02]
 [ 1.34501598e-02]
 [ 1.92143766e-02]
 [ 1.03263579e-02]
 [-6.70720978e-03]
 [ 5.19907050e-03]
 [ 1.49269064e-03]
 [-8.08947175e-02]
 [-1.24706523e-02]
 [ 9.80586590e-03]
 [ 3.32748225e-03]
 [ 8.00629689e-03]
 [-7.29808215e-03]
 [-1.28135840e-02]
 [ 8.26046349e-04]
 [-7.84688067e-03]
 [-3.22905842e-03]
 [ 1.63132465e-03]
 [-1.21863780e-02]
 [ 4.76361822e-03]
 [ 5.68963260e-03]
 [ 8.03851726e-03]
 [ 1.74856268e-03]
 [ 1.72554411e-02]
 [-2.17494651e-02]
 [-1.22893945e-02]
 [ 2.14786566e-02]
 [ 2.55102013e-03]
 [-1.37378768e-02]
 [-1.21946634e-02]
 [-3.31056659e-03]
 [-6.50681975e-03]
 [-5.80808963e-04]
 [ 1.75431869e-02]
 [ 1.52039087e-02]
 [ 1.40412189e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-14.75714246]
curr_Stock_Price:  98.92433891138553
curr_Factors:  [98.92433891]
mat_Sqrt:  [[0.15]]
grads:  [-0.03660874]
Stock Position:  -0.03660873934907598
Bond Position:  [-11.13564712]


portfolio before change:  [-14.7359726]
curr_Stock_Price:  98.30804067305827
curr_Factors:  [98.30804067]
mat_Sqrt:  [[0.15]]
grads:  [-0.04944703]
Stock Position:  -0.04944703015156471
Bond Position:  [-9.87493195]


portfolio before change:  [-14.78550166]
curr_Stock_Price:  99.28473455760982
curr_Factors:  [99.28473456]
mat_Sqrt:  [[0.15]]
grads:  [-0.04338292]
Stock Position:  -0.04338291746995375
Bond Position:  [-10.47824021]


portfolio before change:  [-14.78439722]
curr_Stock_Price:  99.22908366360765
curr_Factors:  [99.22908366]
mat_Sqrt:  [[0.15]]
grads:  [-0.07303767]
Stock Position:  -0.0730376712346335
Bond Position:  [-7.53693603]


portfolio before change:  [-14.78233443]
curr_Stock_Price:  99.18794096222688
curr_Factors:  [99.18794096]
mat_Sqrt:  [[0.15]]
grads:  [0.08966773]
Stock Position:  0.08966773179444419
Bond Position:  [-23.67629212]


portfolio before change:  [-14.78913318]
curr_Stock_Price:  99.14512697107925
curr_Factors:  [99.14512697]
mat_Sqrt:  [[0.15]]
grads:  [0.12809584]
Stock Position:  0.12809584390548515
Bond Position:  [-27.48921189]


portfolio before change:  [-14.89499997]
curr_Stock_Price:  98.34548803713032
curr_Factors:  [98.34548804]
mat_Sqrt:  [[0.15]]
grads:  [0.06884239]
Stock Position:  0.06884238623531816
Bond Position:  [-21.66533805]


portfolio before change:  [-14.9405178]
curr_Stock_Price:  97.72364016808241
curr_Factors:  [97.72364017]
mat_Sqrt:  [[0.15]]
grads:  [-0.04471473]
Stock Position:  -0.04471473187581519
Bond Position:  [-10.57083143]


portfolio before change:  [-14.91590456]
curr_Stock_Price:  97.14363716947246
curr_Factors:  [97.14363717]
mat_Sqrt:  [[0.15]]
grads:  [0.03466047]
Stock Position:  0.034660469968980506
Bond Position:  [-18.28294868]


portfolio before change:  [-14.93558002]
curr_Stock_Price:  96.64191422185506
curr_Factors:  [96.64191422]
mat_Sqrt:  [[0.15]]
grads:  [0.00995127]
Stock Position:  0.009951270919863921
Bond Position:  [-15.8972899]


portfolio before change:  [-14.94383717]
curr_Stock_Price:  96.01185836067758
curr_Factors:  [96.01185836]
mat_Sqrt:  [[0.15]]
grads:  [-0.53929812]
Stock Position:  -0.5392981168327609
Bond Position:  [36.83517724]


portfolio before change:  [-15.21516499]
curr_Stock_Price:  96.52350952128852
curr_Factors:  [96.52350952]
mat_Sqrt:  [[0.15]]
grads:  [-0.08313768]
Stock Position:  -0.08313768217477996
Bond Position:  [-7.19042413]


portfolio before change:  [-15.25021703]
curr_Stock_Price:  96.93431216629725
curr_Factors:  [96.93431217]
mat_Sqrt:  [[0.15]]
grads:  [0.06537244]
Stock Position:  0.06537243932396827
Bond Position:  [-21.58704947]


portfolio before change:  [-15.30776371]
curr_Stock_Price:  96.0953020998292
curr_Factors:  [96.0953021]
mat_Sqrt:  [[0.15]]
grads:  [0.02218322]
Stock Position:  0.0221832150273834
Bond Position:  [-17.43946646]


portfolio before change:  [-15.29180494]
curr_Stock_Price:  96.91298527356685
curr_Factors:  [96.91298527]
mat_Sqrt:  [[0.15]]
grads:  [0.05337531]
Stock Position:  0.05337531257032655
Bond Position:  [-20.46456582]


portfolio before change:  [-15.36582838]
curr_Stock_Price:  95.57406650245026
curr_Factors:  [95.5740665]
mat_Sqrt:  [[0.15]]
grads:  [-0.04865388]
Stock Position:  -0.0486538810046516
Bond Position:  [-10.71577912]


portfolio before change:  [-15.29980068]
curr_Stock_Price:  94.18944398105295
curr_Factors:  [94.18944398]
mat_Sqrt:  [[0.15]]
grads:  [-0.08542389]
Stock Position:  -0.08542389312199981
Bond Position:  [-7.25377168]


portfolio before change:  [-15.23226791]
curr_Stock_Price:  93.3882683586682
curr_Factors:  [93.38826836]
mat_Sqrt:  [[0.15]]
grads:  [0.00550698]
Stock Position:  0.005506975662026044
Bond Position:  [-15.74655483]


portfolio before change:  [-15.23697338]
curr_Stock_Price:  92.89125753385024
curr_Factors:  [92.89125753]
mat_Sqrt:  [[0.15]]
grads:  [-0.05231254]
Stock Position:  -0.05231253780375703
Bond Position:  [-10.37759596]


portfolio before change:  [-15.2271153]
curr_Stock_Price:  92.67801307914958
curr_Factors:  [92.67801308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02152706]
Stock Position:  -0.021527056102281044
Bond Position:  [-13.23203052]


portfolio before change:  [-15.22230349]
curr_Stock_Price:  92.377650322509
curr_Factors:  [92.37765032]
mat_Sqrt:  [[0.15]]
grads:  [0.0108755]
Stock Position:  0.010875497661130707
Bond Position:  [-16.22695641]


portfolio before change:  [-15.22283468]
curr_Stock_Price:  92.5153270031028
curr_Factors:  [92.515327]
mat_Sqrt:  [[0.15]]
grads:  [-0.08124252]
Stock Position:  -0.08124252017612117
Bond Position:  [-7.70665636]


portfolio before change:  [-15.13454874]
curr_Stock_Price:  91.41677260881771
curr_Factors:  [91.41677261]
mat_Sqrt:  [[0.15]]
grads:  [0.03175745]
Stock Position:  0.031757454831797746
Bond Position:  [-18.03771277]


portfolio before change:  [-15.09861126]
curr_Stock_Price:  92.61939858844984
curr_Factors:  [92.61939859]
mat_Sqrt:  [[0.15]]
grads:  [0.03793088]
Stock Position:  0.03793088402489201
Bond Position:  [-18.61174693]


portfolio before change:  [-15.09479392]
curr_Stock_Price:  92.78137610156232
curr_Factors:  [92.7813761]
mat_Sqrt:  [[0.15]]
grads:  [0.05359012]
Stock Position:  0.05359011506279092
Bond Position:  [-20.06695854]


portfolio before change:  [-15.1305946]
curr_Stock_Price:  92.16013924848109
curr_Factors:  [92.16013925]
mat_Sqrt:  [[0.15]]
grads:  [0.01165708]
Stock Position:  0.01165708451967894
Bond Position:  [-16.20491314]


portfolio before change:  [-15.12443088]
curr_Stock_Price:  92.86267072757857
curr_Factors:  [92.86267073]
mat_Sqrt:  [[0.15]]
grads:  [0.11503627]
Stock Position:  0.11503627378482614
Bond Position:  [-25.80700649]


portfolio before change:  [-15.19968086]
curr_Stock_Price:  92.23657338758106
curr_Factors:  [92.23657339]
mat_Sqrt:  [[0.15]]
grads:  [-0.14499643]
Stock Position:  -0.1449964339030639
Bond Position:  [-1.82570664]


portfolio before change:  [-15.11788713]
curr_Stock_Price:  91.67089083252453
curr_Factors:  [91.67089083]
mat_Sqrt:  [[0.15]]
grads:  [-0.0819293]
Stock Position:  -0.08192929634186086
Bond Position:  [-7.60735555]


portfolio before change:  [-15.20516279]
curr_Stock_Price:  92.72453933585639
curr_Factors:  [92.72453934]
mat_Sqrt:  [[0.15]]
grads:  [0.14319104]
Stock Position:  0.143191043977388
Bond Position:  [-28.48248638]


portfolio before change:  [-15.24960493]
curr_Stock_Price:  92.43903540593828
curr_Factors:  [92.43903541]
mat_Sqrt:  [[0.15]]
grads:  [0.0170068]
Stock Position:  0.01700680086493495
Bond Position:  [-16.8216972]


portfolio before change:  [-15.24356923]
curr_Stock_Price:  92.91758193938374
curr_Factors:  [92.91758194]
mat_Sqrt:  [[0.15]]
grads:  [-0.09158585]
Stock Position:  -0.09158584515244929
Bond Position:  [-6.73363396]


portfolio before change:  [-15.24245303]
curr_Stock_Price:  92.89620352858036
curr_Factors:  [92.89620353]
mat_Sqrt:  [[0.15]]
grads:  [-0.08129776]
Stock Position:  -0.08129775567942021
Bond Position:  [-7.69020017]


portfolio before change:  [-15.25223378]
curr_Stock_Price:  93.00468644077155
curr_Factors:  [93.00468644]
mat_Sqrt:  [[0.15]]
grads:  [-0.02207044]
Stock Position:  -0.02207044391251944
Bond Position:  [-13.19957906]


portfolio before change:  [-15.26320656]
curr_Stock_Price:  93.42709439412052
curr_Factors:  [93.42709439]
mat_Sqrt:  [[0.15]]
grads:  [-0.0433788]
Stock Position:  -0.043378798327941066
Bond Position:  [-11.21045147]


portfolio before change:  [-15.20519224]
curr_Stock_Price:  92.0573996731674
curr_Factors:  [92.05739967]
mat_Sqrt:  [[0.15]]
grads:  [-0.00387206]
Stock Position:  -0.00387205975206242
Bond Position:  [-14.84874049]


portfolio before change:  [-15.20687451]
curr_Stock_Price:  92.0124770001309
curr_Factors:  [92.012477]
mat_Sqrt:  [[0.15]]
grads:  [0.11695458]
Stock Position:  0.11695457917982824
Bond Position:  [-25.96815503]


portfolio before change:  [-15.29544325]
curr_Stock_Price:  91.28294150439889
curr_Factors:  [91.2829415]
mat_Sqrt:  [[0.15]]
grads:  [0.10135939]
Stock Position:  0.10135939143950032
Bond Position:  [-24.54782665]


portfolio before change:  [-15.32065652]
curr_Stock_Price:  91.06446541292283
curr_Factors:  [91.06446541]
mat_Sqrt:  [[0.15]]
grads:  [0.09360813]
Stock Position:  0.09360812631546352
Bond Position:  [-23.8450305]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-15.32065652]
Stock Price:  90.25940841280082
PL:  [-15.32065652]
Settle:  Tensor("sub_346:0", shape=(), dtype=float64)
PL:  Tensor("sub_347:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  174
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.92539613e-03]
 [-1.10711578e-02]
 [ 1.50013438e-02]
 [-9.30822246e-04]
 [ 2.05913372e-02]
 [ 2.57606835e-02]
 [ 2.71384066e-02]
 [-3.22362878e-03]
 [ 1.22113184e-02]
 [-2.68959067e-03]
 [ 4.76430402e-03]
 [ 5.40645010e-03]
 [ 8.39893176e-03]
 [ 7.87694560e-03]
 [ 1.10067663e-02]
 [-7.33128724e-03]
 [-1.00756433e-02]
 [-8.22898648e-05]
 [-7.59634702e-03]
 [-2.64514930e-03]
 [ 9.40486555e-04]
 [ 1.06582590e-02]
 [ 4.75725429e-03]
 [ 5.41044932e-03]
 [ 2.58307152e-03]
 [ 5.49229006e-04]
 [ 1.85822441e-02]
 [-2.13182291e-02]
 [-1.72400108e-02]
 [ 2.14036513e-02]
 [ 2.59948816e-03]
 [-7.80125355e-03]
 [-1.23650441e-02]
 [-7.50335439e-03]
 [-6.38462015e-03]
 [-5.48070701e-03]
 [ 2.03528905e-02]
 [ 8.68420095e-03]
 [ 2.29201147e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [23.78275353]
curr_Stock_Price:  101.40715881059819
curr_Factors:  [101.40715881]
mat_Sqrt:  [[0.15]]
grads:  [-0.02616931]
Stock Position:  -0.026169307535461626
Bond Position:  [26.43650865]


portfolio before change:  [23.80679521]
curr_Stock_Price:  100.61474535027988
curr_Factors:  [100.61474535]
mat_Sqrt:  [[0.15]]
grads:  [-0.07380772]
Stock Position:  -0.07380771893790779
Bond Position:  [31.23294005]


portfolio before change:  [23.81751022]
curr_Stock_Price:  100.52246981212015
curr_Factors:  [100.52246981]
mat_Sqrt:  [[0.15]]
grads:  [0.10000896]
Stock Position:  0.10000895846442535
Bond Position:  [13.76436271]


portfolio before change:  [23.79783967]
curr_Stock_Price:  100.30857703165032
curr_Factors:  [100.30857703]
mat_Sqrt:  [[0.15]]
grads:  [-0.00620548]
Stock Position:  -0.006205481638881852
Bond Position:  [24.42030271]


portfolio before change:  [23.79567508]
curr_Stock_Price:  101.14933757530281
curr_Factors:  [101.14933758]
mat_Sqrt:  [[0.15]]
grads:  [0.13727558]
Stock Position:  0.13727558165201356
Bond Position:  [9.91034093]


portfolio before change:  [23.76871493]
curr_Stock_Price:  100.94391855723143
curr_Factors:  [100.94391856]
mat_Sqrt:  [[0.15]]
grads:  [0.17173789]
Stock Position:  0.17173788982732965
Bond Position:  [6.43281937]


portfolio before change:  [23.67734762]
curr_Stock_Price:  100.4072200549153
curr_Factors:  [100.40722005]
mat_Sqrt:  [[0.15]]
grads:  [0.18092271]
Stock Position:  0.1809227106735578
Bond Position:  [5.51140119]


portfolio before change:  [23.46328273]
curr_Stock_Price:  99.22022781433249
curr_Factors:  [99.22022781]
mat_Sqrt:  [[0.15]]
grads:  [-0.02149086]
Stock Position:  -0.021490858511412234
Bond Position:  [25.59561061]


portfolio before change:  [23.45402523]
curr_Stock_Price:  99.79987677895109
curr_Factors:  [99.79987678]
mat_Sqrt:  [[0.15]]
grads:  [0.08140879]
Stock Position:  0.08140878964424043
Bond Position:  [15.32943805]


portfolio before change:  [23.39416564]
curr_Stock_Price:  99.0410411597497
curr_Factors:  [99.04104116]
mat_Sqrt:  [[0.15]]
grads:  [-0.0179306]
Stock Position:  -0.01793060445421217
Bond Position:  [25.17003137]


portfolio before change:  [23.38876514]
curr_Stock_Price:  99.51770939933718
curr_Factors:  [99.5177094]
mat_Sqrt:  [[0.15]]
grads:  [0.03176203]
Stock Position:  0.03176202679972123
Bond Position:  [20.22788099]


portfolio before change:  [23.37784519]
curr_Stock_Price:  99.09429192554211
curr_Factors:  [99.09429193]
mat_Sqrt:  [[0.15]]
grads:  [0.036043]
Stock Position:  0.03604300066352299
Bond Position:  [19.80618956]


portfolio before change:  [23.32074384]
curr_Stock_Price:  97.44134200471747
curr_Factors:  [97.441342]
mat_Sqrt:  [[0.15]]
grads:  [0.05599288]
Stock Position:  0.05599287836988561
Bond Position:  [17.86472263]


portfolio before change:  [23.32230424]
curr_Stock_Price:  97.42932557954767
curr_Factors:  [97.42932558]
mat_Sqrt:  [[0.15]]
grads:  [0.05251297]
Stock Position:  0.05251297064179242
Bond Position:  [18.20600092]


portfolio before change:  [23.26977741]
curr_Stock_Price:  96.3857221162153
curr_Factors:  [96.38572212]
mat_Sqrt:  [[0.15]]
grads:  [0.07337844]
Stock Position:  0.07337844220410823
Bond Position:  [16.19714327]


portfolio before change:  [23.21297563]
curr_Stock_Price:  95.58403503257092
curr_Factors:  [95.58403503]
mat_Sqrt:  [[0.15]]
grads:  [-0.04887525]
Stock Position:  -0.04887524829454123
Bond Position:  [27.88466908]


portfolio before change:  [23.20445686]
curr_Stock_Price:  95.8296516767536
curr_Factors:  [95.82965168]
mat_Sqrt:  [[0.15]]
grads:  [-0.06717096]
Stock Position:  -0.06717095519752535
Bond Position:  [29.6414261]


portfolio before change:  [23.11886352]
curr_Stock_Price:  97.1590767115106
curr_Factors:  [97.15907671]
mat_Sqrt:  [[0.15]]
grads:  [-0.0005486]
Stock Position:  -0.0005485990986546052
Bond Position:  [23.1721649]


portfolio before change:  [23.12171821]
curr_Stock_Price:  97.23564860655641
curr_Factors:  [97.23564861]
mat_Sqrt:  [[0.15]]
grads:  [-0.05064231]
Stock Position:  -0.0506423134624671
Bond Position:  [28.04595641]


portfolio before change:  [23.17664709]
curr_Stock_Price:  96.22023468114071
curr_Factors:  [96.22023468]
mat_Sqrt:  [[0.15]]
grads:  [-0.01763433]
Stock Position:  -0.017634328644320095
Bond Position:  [24.87342633]


portfolio before change:  [23.19667157]
curr_Stock_Price:  95.2610198872292
curr_Factors:  [95.26101989]
mat_Sqrt:  [[0.15]]
grads:  [0.00626991]
Stock Position:  0.006269910366871059
Bond Position:  [22.59939351]


portfolio before change:  [23.19783382]
curr_Stock_Price:  94.9958093157815
curr_Factors:  [94.99580932]
mat_Sqrt:  [[0.15]]
grads:  [0.07105506]
Stock Position:  0.07105505984478759
Bond Position:  [16.44790091]


portfolio before change:  [23.29511788]
curr_Stock_Price:  96.33600861910833
curr_Factors:  [96.33600862]
mat_Sqrt:  [[0.15]]
grads:  [0.03171503]
Stock Position:  0.03171502858937333
Bond Position:  [20.23981861]


portfolio before change:  [23.29630745]
curr_Stock_Price:  96.29373965634034
curr_Factors:  [96.29373966]
mat_Sqrt:  [[0.15]]
grads:  [0.03606966]
Stock Position:  0.036069662129276266
Bond Position:  [19.8230248]


portfolio before change:  [23.25785289]
curr_Stock_Price:  95.15891916022323
curr_Factors:  [95.15891916]
mat_Sqrt:  [[0.15]]
grads:  [0.01722048]
Stock Position:  0.017220476795705177
Bond Position:  [21.61917094]


portfolio before change:  [23.2246555]
curr_Stock_Price:  93.07419380980961
curr_Factors:  [93.07419381]
mat_Sqrt:  [[0.15]]
grads:  [0.00366153]
Stock Position:  0.0036615267090328585
Bond Position:  [22.88386185]


portfolio before change:  [23.22566959]
curr_Stock_Price:  92.56987864397097
curr_Factors:  [92.56987864]
mat_Sqrt:  [[0.15]]
grads:  [0.12388163]
Stock Position:  0.12388162745880255
Bond Position:  [11.75796237]


portfolio before change:  [23.2325949]
curr_Stock_Price:  92.61391637194137
curr_Factors:  [92.61391637]
mat_Sqrt:  [[0.15]]
grads:  [-0.14212153]
Stock Position:  -0.14212152719551768
Bond Position:  [36.39502613]


portfolio before change:  [23.19012262]
curr_Stock_Price:  92.94477360330661
curr_Factors:  [92.9447736]
mat_Sqrt:  [[0.15]]
grads:  [-0.11493341]
Stock Position:  -0.11493340541997257
Bond Position:  [33.87258197]


portfolio before change:  [23.11648994]
curr_Stock_Price:  93.62227046611567
curr_Factors:  [93.62227047]
mat_Sqrt:  [[0.15]]
grads:  [0.14269101]
Stock Position:  0.14269100842442864
Bond Position:  [9.75743376]


portfolio before change:  [23.17157526]
curr_Stock_Price:  93.99976842142003
curr_Factors:  [93.99976842]
mat_Sqrt:  [[0.15]]
grads:  [0.01732992]
Stock Position:  0.017329921074393028
Bond Position:  [21.54256669]


portfolio before change:  [23.20360973]
curr_Stock_Price:  95.69287940103105
curr_Factors:  [95.6928794]
mat_Sqrt:  [[0.15]]
grads:  [-0.05200836]
Stock Position:  -0.0520083570185259
Bond Position:  [28.18043916]


portfolio before change:  [23.24662474]
curr_Stock_Price:  94.9335352660463
curr_Factors:  [94.93353527]
mat_Sqrt:  [[0.15]]
grads:  [-0.08243363]
Stock Position:  -0.0824336276586265
Bond Position:  [31.07234044]


portfolio before change:  [23.25027111]
curr_Stock_Price:  94.93642151094002
curr_Factors:  [94.93642151]
mat_Sqrt:  [[0.15]]
grads:  [-0.05002236]
Stock Position:  -0.05002236257966041
Bond Position:  [27.9992152]


portfolio before change:  [23.27138474]
curr_Stock_Price:  94.58430873651596
curr_Factors:  [94.58430874]
mat_Sqrt:  [[0.15]]
grads:  [-0.04256413]
Stock Position:  -0.04256413431875535
Bond Position:  [27.29728396]


portfolio before change:  [23.20456077]
curr_Stock_Price:  96.2344384781077
curr_Factors:  [96.23443848]
mat_Sqrt:  [[0.15]]
grads:  [-0.03653805]
Stock Position:  -0.03653804673681381
Bond Position:  [26.72077918]


portfolio before change:  [23.18394941]
curr_Stock_Price:  96.88996515609871
curr_Factors:  [96.88996516]
mat_Sqrt:  [[0.15]]
grads:  [0.13568594]
Stock Position:  0.13568593667631437
Bond Position:  [10.03734373]


portfolio before change:  [23.27403113]
curr_Stock_Price:  97.5446164626129
curr_Factors:  [97.54461646]
mat_Sqrt:  [[0.15]]
grads:  [0.05789467]
Stock Position:  0.057894673012905545
Bond Position:  [17.62671746]


portfolio before change:  [23.31636856]
curr_Stock_Price:  98.23783995388531
curr_Factors:  [98.23783995]
mat_Sqrt:  [[0.15]]
grads:  [0.15280076]
Stock Position:  0.1528007644990411
Bond Position:  [8.30555151]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [23.31636856]
Stock Price:  97.98133225523803
PL:  [23.31636856]
Settle:  Tensor("sub_348:0", shape=(), dtype=float64)
PL:  Tensor("sub_349:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  175
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.74503569e-03]
 [-2.28367095e-03]
 [ 4.48492175e-03]
 [-1.08189843e-02]
 [ 1.44193218e-02]
 [ 1.71060482e-02]
 [ 1.19369445e-02]
 [-3.49621584e-03]
 [ 1.07311063e-02]
 [ 2.26378091e-04]
 [-4.42667537e-02]
 [-9.18597836e-03]
 [ 1.07052488e-02]
 [ 8.56986438e-03]
 [ 1.72379980e-04]
 [-1.18442185e-02]
 [-5.77799508e-03]
 [-2.14600861e-04]
 [-7.56010330e-03]
 [-2.38856098e-03]
 [ 3.05619067e-04]
 [ 8.45939141e-03]
 [ 4.76702172e-03]
 [ 5.76142484e-03]
 [-3.64286531e-03]
 [-5.17852319e-03]
 [-1.61658989e-03]
 [-1.98843998e-02]
 [-2.83835900e-02]
 [ 2.19070269e-02]
 [ 4.32541995e-03]
 [-3.02529708e-03]
 [-1.25334840e-02]
 [-7.88354265e-03]
 [-8.37935671e-03]
 [-7.51174786e-03]
 [ 2.19872633e-02]
 [ 8.80304195e-03]
 [ 2.02076571e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [1.26763798]
curr_Stock_Price:  99.95668844783245
curr_Factors:  [99.95668845]
mat_Sqrt:  [[0.15]]
grads:  [-0.01163357]
Stock Position:  -0.01163357126860661
Bond Position:  [2.43049124]


portfolio before change:  [1.24940184]
curr_Stock_Price:  101.5503498009708
curr_Factors:  [101.5503498]
mat_Sqrt:  [[0.15]]
grads:  [-0.01522447]
Stock Position:  -0.015224473010282687
Bond Position:  [2.7954524]


portfolio before change:  [1.2619601]
curr_Stock_Price:  100.74842950427131
curr_Factors:  [100.7484295]
mat_Sqrt:  [[0.15]]
grads:  [0.02989948]
Stock Position:  0.02989947835724276
Bond Position:  [-1.75036538]


portfolio before change:  [1.21656393]
curr_Stock_Price:  99.23745443941449
curr_Factors:  [99.23745444]
mat_Sqrt:  [[0.15]]
grads:  [-0.07212656]
Stock Position:  -0.07212656184849237
Bond Position:  [8.37422032]


portfolio before change:  [1.25688619]
curr_Stock_Price:  98.6929196977282
curr_Factors:  [98.6929197]
mat_Sqrt:  [[0.15]]
grads:  [0.09612881]
Stock Position:  0.09612881218363133
Bond Position:  [-8.23034695]


portfolio before change:  [1.32993681]
curr_Stock_Price:  99.46354693702146
curr_Factors:  [99.46354694]
mat_Sqrt:  [[0.15]]
grads:  [0.11404032]
Stock Position:  0.11404032123931976
Bond Position:  [-10.01291803]


portfolio before change:  [1.21454184]
curr_Stock_Price:  98.46264408378914
curr_Factors:  [98.46264408]
mat_Sqrt:  [[0.15]]
grads:  [0.07957963]
Stock Position:  0.07957962986404636
Bond Position:  [-6.62107893]


portfolio before change:  [1.21981176]
curr_Stock_Price:  98.53926683921303
curr_Factors:  [98.53926684]
mat_Sqrt:  [[0.15]]
grads:  [-0.02330811]
Stock Position:  -0.02330810562889703
Bond Position:  [3.5165754]


portfolio before change:  [1.23361109]
curr_Stock_Price:  97.96608726015155
curr_Factors:  [97.96608726]
mat_Sqrt:  [[0.15]]
grads:  [0.07154071]
Stock Position:  0.07154070874888716
Bond Position:  [-5.77495222]


portfolio before change:  [1.18912236]
curr_Stock_Price:  97.35431221267456
curr_Factors:  [97.35431221]
mat_Sqrt:  [[0.15]]
grads:  [0.00150919]
Stock Position:  0.0015091872730572827
Bond Position:  [1.04219647]


portfolio before change:  [1.18863343]
curr_Stock_Price:  96.94401739898983
curr_Factors:  [96.9440174]
mat_Sqrt:  [[0.15]]
grads:  [-0.29511169]
Stock Position:  -0.2951116914214155
Bond Position:  [29.79794638]


portfolio before change:  [1.18898939]
curr_Stock_Price:  96.95543345441835
curr_Factors:  [96.95543345]
mat_Sqrt:  [[0.15]]
grads:  [-0.06123986]
Stock Position:  -0.06123985573666416
Bond Position:  [7.12652615]


portfolio before change:  [1.21016982]
curr_Stock_Price:  96.62412048006097
curr_Factors:  [96.62412048]
mat_Sqrt:  [[0.15]]
grads:  [0.07136833]
Stock Position:  0.07136832537075581
Bond Position:  [-5.68573185]


portfolio before change:  [1.28107917]
curr_Stock_Price:  97.62764846559398
curr_Factors:  [97.62764847]
mat_Sqrt:  [[0.15]]
grads:  [0.05713243]
Stock Position:  0.057132429230557155
Bond Position:  [-4.29662554]


portfolio before change:  [1.31565282]
curr_Stock_Price:  98.24219896702232
curr_Factors:  [98.24219897]
mat_Sqrt:  [[0.15]]
grads:  [0.0011492]
Stock Position:  0.0011491998697728094
Bond Position:  [1.2027529]


portfolio before change:  [1.31546321]
curr_Stock_Price:  97.946370794124
curr_Factors:  [97.94637079]
mat_Sqrt:  [[0.15]]
grads:  [-0.07896146]
Stock Position:  -0.0789614569991281
Bond Position:  [9.04945136]


portfolio before change:  [1.34102415]
curr_Stock_Price:  97.63698330481608
curr_Factors:  [97.6369833]
mat_Sqrt:  [[0.15]]
grads:  [-0.03851997]
Stock Position:  -0.03851996719295161
Bond Position:  [5.10199755]


portfolio before change:  [1.35518753]
curr_Stock_Price:  97.28585133758834
curr_Factors:  [97.28585134]
mat_Sqrt:  [[0.15]]
grads:  [-0.00143067]
Stock Position:  -0.0014306724056862923
Bond Position:  [1.49437172]


portfolio before change:  [1.35479897]
curr_Stock_Price:  97.68801627777566
curr_Factors:  [97.68801628]
mat_Sqrt:  [[0.15]]
grads:  [-0.05040069]
Stock Position:  -0.05040068869546837
Bond Position:  [6.27834227]


portfolio before change:  [1.29884812]
curr_Stock_Price:  98.8137090708097
curr_Factors:  [98.81370907]
mat_Sqrt:  [[0.15]]
grads:  [-0.01592374]
Stock Position:  -0.015923739849199734
Bond Position:  [2.87233192]


portfolio before change:  [1.29206614]
curr_Stock_Price:  99.26216200225991
curr_Factors:  [99.262162]
mat_Sqrt:  [[0.15]]
grads:  [0.00203746]
Stock Position:  0.002037460444108298
Bond Position:  [1.08982341]


portfolio before change:  [1.29165388]
curr_Stock_Price:  98.99295770752332
curr_Factors:  [98.99295771]
mat_Sqrt:  [[0.15]]
grads:  [0.05639594]
Stock Position:  0.05639594273703538
Bond Position:  [-4.29114729]


portfolio before change:  [1.26734177]
curr_Stock_Price:  98.57137258284176
curr_Factors:  [98.57137258]
mat_Sqrt:  [[0.15]]
grads:  [0.03178014]
Stock Position:  0.03178014479131248
Bond Position:  [-1.86527073]


portfolio before change:  [1.25761346]
curr_Stock_Price:  98.27259700815051
curr_Factors:  [98.27259701]
mat_Sqrt:  [[0.15]]
grads:  [0.0384095]
Stock Position:  0.03840949894759304
Bond Position:  [-2.51698775]


portfolio before change:  [1.26476364]
curr_Stock_Price:  98.46694522811453
curr_Factors:  [98.46694523]
mat_Sqrt:  [[0.15]]
grads:  [-0.02428577]
Stock Position:  -0.02428576874559763
Bond Position:  [3.6561091]


portfolio before change:  [1.28216393]
curr_Stock_Price:  97.76928340920423
curr_Factors:  [97.76928341]
mat_Sqrt:  [[0.15]]
grads:  [-0.03452349]
Stock Position:  -0.03452348795994489
Bond Position:  [4.65750061]


portfolio before change:  [1.26009858]
curr_Stock_Price:  98.42528829954728
curr_Factors:  [98.4252883]
mat_Sqrt:  [[0.15]]
grads:  [-0.01077727]
Stock Position:  -0.010777265912597062
Bond Position:  [2.32085408]


portfolio before change:  [1.27188644]
curr_Stock_Price:  97.3584374825716
curr_Factors:  [97.35843748]
mat_Sqrt:  [[0.15]]
grads:  [-0.13256267]
Stock Position:  -0.1325626650698827
Bond Position:  [14.17798038]


portfolio before change:  [1.46212311]
curr_Stock_Price:  95.93673772172987
curr_Factors:  [95.93673772]
mat_Sqrt:  [[0.15]]
grads:  [-0.18922393]
Stock Position:  -0.18922393340794616
Bond Position:  [19.61564998]


portfolio before change:  [1.27114331]
curr_Stock_Price:  96.95897577719846
curr_Factors:  [96.95897578]
mat_Sqrt:  [[0.15]]
grads:  [0.14604685]
Stock Position:  0.14604684571740711
Bond Position:  [-12.88940927]


portfolio before change:  [1.45880695]
curr_Stock_Price:  98.25496347685291
curr_Factors:  [98.25496348]
mat_Sqrt:  [[0.15]]
grads:  [0.02883613]
Stock Position:  0.02883613299939769
Bond Position:  [-1.37448625]


portfolio before change:  [1.45506089]
curr_Stock_Price:  98.13101337560767
curr_Factors:  [98.13101338]
mat_Sqrt:  [[0.15]]
grads:  [-0.02016865]
Stock Position:  -0.0201686472115655
Bond Position:  [3.43423068]


portfolio before change:  [1.44586383]
curr_Stock_Price:  98.60830670642888
curr_Factors:  [98.60830671]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355656]
Stock Position:  -0.08355655996255233
Bond Position:  [9.68523472]


portfolio before change:  [1.45085059]
curr_Stock_Price:  98.56311537193766
curr_Factors:  [98.56311537]
mat_Sqrt:  [[0.15]]
grads:  [-0.05255695]
Stock Position:  -0.052556950985967466
Bond Position:  [6.63102742]


portfolio before change:  [1.44966869]
curr_Stock_Price:  98.60137543290801
curr_Factors:  [98.60137543]
mat_Sqrt:  [[0.15]]
grads:  [-0.05586238]
Stock Position:  -0.05586237808649269
Bond Position:  [6.95777601]


portfolio before change:  [1.42140923]
curr_Stock_Price:  99.12282195863128
curr_Factors:  [99.12282196]
mat_Sqrt:  [[0.15]]
grads:  [-0.05007832]
Stock Position:  -0.05007831906257184
Bond Position:  [6.38531353]


portfolio before change:  [1.45107419]
curr_Stock_Price:  98.54638986406793
curr_Factors:  [98.54638986]
mat_Sqrt:  [[0.15]]
grads:  [0.14658176]
Stock Position:  0.1465817553182935
Bond Position:  [-12.99402862]


portfolio before change:  [1.27270743]
curr_Stock_Price:  97.34062998119425
curr_Factors:  [97.34062998]
mat_Sqrt:  [[0.15]]
grads:  [0.05868695]
Stock Position:  0.05868694633643211
Bond Position:  [-4.43991689]


portfolio before change:  [1.1735432]
curr_Stock_Price:  95.66037192405878
curr_Factors:  [95.66037192]
mat_Sqrt:  [[0.15]]
grads:  [0.13471771]
Stock Position:  0.13471771430676294
Bond Position:  [-11.71360346]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [1.1735432]
Stock Price:  93.50752266761029
PL:  [1.1735432]
Settle:  Tensor("sub_350:0", shape=(), dtype=float64)
PL:  Tensor("sub_351:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  176
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.53398428e-03]
 [-1.34431272e-02]
 [-4.25134546e-03]
 [-8.97515093e-03]
 [ 1.37198102e-02]
 [ 2.23618271e-02]
 [ 1.36821342e-02]
 [-3.27745558e-03]
 [ 1.24980930e-02]
 [-2.00909503e-03]
 [ 1.03541531e-02]
 [-8.60006772e-04]
 [ 6.98770126e-03]
 [ 9.92785620e-03]
 [ 2.42736628e-04]
 [-1.05874456e-02]
 [-1.63778604e-03]
 [-1.69253491e-03]
 [-7.53432789e-03]
 [-2.39561962e-03]
 [ 4.26294902e-04]
 [ 1.12909473e-02]
 [ 4.76137274e-03]
 [ 5.94410534e-03]
 [-3.33534579e-03]
 [-7.45468071e-03]
 [ 7.15815020e-03]
 [-2.56148335e-02]
 [-3.68680466e-02]
 [ 2.20578183e-02]
 [ 7.01576561e-03]
 [-8.92022522e-04]
 [-1.25334907e-02]
 [-1.03329891e-02]
 [-8.02656798e-03]
 [-7.53174020e-03]
 [ 2.26632352e-02]
 [ 6.71940247e-03]
 [ 2.38823795e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [2.71685936]
curr_Stock_Price:  100.05005028995697
curr_Factors:  [100.05005029]
mat_Sqrt:  [[0.15]]
grads:  [-0.01022656]
Stock Position:  -0.010226561889099074
Bond Position:  [3.74002739]


portfolio before change:  [2.71665909]
curr_Stock_Price:  100.11535108031558
curr_Factors:  [100.11535108]
mat_Sqrt:  [[0.15]]
grads:  [-0.08962085]
Stock Position:  -0.08962084782106243
Bond Position:  [11.68908173]


portfolio before change:  [2.78793716]
curr_Stock_Price:  99.33632649477362
curr_Factors:  [99.33632649]
mat_Sqrt:  [[0.15]]
grads:  [-0.0283423]
Stock Position:  -0.028342303074645518
Bond Position:  [5.60335743]


portfolio before change:  [2.78746705]
curr_Stock_Price:  99.377627740309
curr_Factors:  [99.37762774]
mat_Sqrt:  [[0.15]]
grads:  [-0.05983434]
Stock Position:  -0.059834339507381575
Bond Position:  [8.73366177]


portfolio before change:  [2.80605966]
curr_Stock_Price:  99.08513958390704
curr_Factors:  [99.08513958]
mat_Sqrt:  [[0.15]]
grads:  [0.0914654]
Stock Position:  0.09146540143075522
Bond Position:  [-6.2568024]


portfolio before change:  [2.75338845]
curr_Stock_Price:  98.51783141737236
curr_Factors:  [98.51783142]
mat_Sqrt:  [[0.15]]
grads:  [0.14907885]
Stock Position:  0.14907884741636582
Bond Position:  [-11.93353631]


portfolio before change:  [2.76259455]
curr_Stock_Price:  98.58959133175254
curr_Factors:  [98.58959133]
mat_Sqrt:  [[0.15]]
grads:  [0.09121423]
Stock Position:  0.09121422806237067
Bond Position:  [-6.23017892]


portfolio before change:  [2.81046334]
curr_Stock_Price:  99.12292494270802
curr_Factors:  [99.12292494]
mat_Sqrt:  [[0.15]]
grads:  [-0.0218497]
Stock Position:  -0.0218497038925435
Bond Position:  [4.9762699]


portfolio before change:  [2.79652119]
curr_Stock_Price:  99.78948870950687
curr_Factors:  [99.78948871]
mat_Sqrt:  [[0.15]]
grads:  [0.08332062]
Stock Position:  0.08332061992702573
Bond Position:  [-5.51800087]


portfolio before change:  [2.72100961]
curr_Stock_Price:  98.89149021324192
curr_Factors:  [98.89149021]
mat_Sqrt:  [[0.15]]
grads:  [-0.01339397]
Stock Position:  -0.01339396684122111
Bond Position:  [4.04555895]


portfolio before change:  [2.7194291]
curr_Stock_Price:  99.047249356737
curr_Factors:  [99.04724936]
mat_Sqrt:  [[0.15]]
grads:  [0.06902769]
Stock Position:  0.06902768721648785
Bond Position:  [-4.11757345]


portfolio before change:  [2.65675123]
curr_Stock_Price:  98.14669568244352
curr_Factors:  [98.14669568]
mat_Sqrt:  [[0.15]]
grads:  [-0.00573338]
Stock Position:  -0.005733378482254137
Bond Position:  [3.21946339]


portfolio before change:  [2.65826081]
curr_Stock_Price:  97.9535956891506
curr_Factors:  [97.95359569]
mat_Sqrt:  [[0.15]]
grads:  [0.04658468]
Stock Position:  0.046584675035179685
Bond Position:  [-1.90487562]


portfolio before change:  [2.66094488]
curr_Stock_Price:  98.01632439810082
curr_Factors:  [98.0163244]
mat_Sqrt:  [[0.15]]
grads:  [0.06618571]
Stock Position:  0.06618570800467355
Bond Position:  [-3.82633495]


portfolio before change:  [2.67471447]
curr_Stock_Price:  98.23159609208108
curr_Factors:  [98.23159609]
mat_Sqrt:  [[0.15]]
grads:  [0.00161824]
Stock Position:  0.0016182441897605027
Bond Position:  [2.51575176]


portfolio before change:  [2.67518913]
curr_Stock_Price:  98.33057502926223
curr_Factors:  [98.33057503]
mat_Sqrt:  [[0.15]]
grads:  [-0.07058297]
Stock Position:  -0.07058297038606973
Bond Position:  [9.61565319]


portfolio before change:  [2.61863185]
curr_Stock_Price:  99.14889296673886
curr_Factors:  [99.14889297]
mat_Sqrt:  [[0.15]]
grads:  [-0.01091857]
Stock Position:  -0.010918573607379783
Bond Position:  [3.70119633]


portfolio before change:  [2.63061041]
curr_Stock_Price:  98.09418753169004
curr_Factors:  [98.09418753]
mat_Sqrt:  [[0.15]]
grads:  [-0.01128357]
Stock Position:  -0.011283566049346445
Bond Position:  [3.73746265]


portfolio before change:  [2.63251848]
curr_Stock_Price:  97.96649217384854
curr_Factors:  [97.96649217]
mat_Sqrt:  [[0.15]]
grads:  [-0.05022885]
Stock Position:  -0.05022885259599451
Bond Position:  [7.55326297]


portfolio before change:  [2.64179369]
curr_Stock_Price:  97.80063140310189
curr_Factors:  [97.8006314]
mat_Sqrt:  [[0.15]]
grads:  [-0.0159708]
Stock Position:  -0.015970797438100117
Bond Position:  [4.20374776]


portfolio before change:  [2.64426217]
curr_Stock_Price:  97.67897307299812
curr_Factors:  [97.67897307]
mat_Sqrt:  [[0.15]]
grads:  [0.00284197]
Stock Position:  0.002841966012608637
Bond Position:  [2.36666185]


portfolio before change:  [2.64367047]
curr_Stock_Price:  97.36666995100995
curr_Factors:  [97.36666995]
mat_Sqrt:  [[0.15]]
grads:  [0.07527298]
Stock Position:  0.07527298178850858
Bond Position:  [-4.68540911]


portfolio before change:  [2.67100928]
curr_Stock_Price:  97.73764669179255
curr_Factors:  [97.73764669]
mat_Sqrt:  [[0.15]]
grads:  [0.03174248]
Stock Position:  0.03174248492678488
Bond Position:  [-0.4314265]


portfolio before change:  [2.70834131]
curr_Stock_Price:  98.91543594625116
curr_Factors:  [98.91543595]
mat_Sqrt:  [[0.15]]
grads:  [0.03962737]
Stock Position:  0.03962736891943917
Bond Position:  [-1.21141717]


portfolio before change:  [2.72859678]
curr_Stock_Price:  99.4304059337787
curr_Factors:  [99.43040593]
mat_Sqrt:  [[0.15]]
grads:  [-0.02223564]
Stock Position:  -0.0222356386196256
Bond Position:  [4.93949535]


portfolio before change:  [2.73448772]
curr_Stock_Price:  99.1932428235713
curr_Factors:  [99.19324282]
mat_Sqrt:  [[0.15]]
grads:  [-0.04969787]
Stock Position:  -0.04969787142352934
Bond Position:  [7.66418075]


portfolio before change:  [2.73865119]
curr_Stock_Price:  99.12874539725495
curr_Factors:  [99.1287454]
mat_Sqrt:  [[0.15]]
grads:  [0.047721]
Stock Position:  0.04772100130544173
Bond Position:  [-1.9918718]


portfolio before change:  [2.76286801]
curr_Stock_Price:  99.64142981971189
curr_Factors:  [99.64142982]
mat_Sqrt:  [[0.15]]
grads:  [-0.17076556]
Stock Position:  -0.170765556561699
Bond Position:  [19.77819223]


portfolio before change:  [2.9672035]
curr_Stock_Price:  98.45932335828005
curr_Factors:  [98.45932336]
mat_Sqrt:  [[0.15]]
grads:  [-0.24578698]
Stock Position:  -0.24578697731680024
Bond Position:  [27.16722298]


portfolio before change:  [3.07812981]
curr_Stock_Price:  98.02182991510603
curr_Factors:  [98.02182992]
mat_Sqrt:  [[0.15]]
grads:  [0.14705212]
Stock Position:  0.1470521217510816
Bond Position:  [-11.33618826]


portfolio before change:  [3.20502629]
curr_Stock_Price:  98.89440213297434
curr_Factors:  [98.89440213]
mat_Sqrt:  [[0.15]]
grads:  [0.04677177]
Stock Position:  0.04677177073466626
Bond Position:  [-1.42044001]


portfolio before change:  [3.21151657]
curr_Stock_Price:  99.03696348795523
curr_Factors:  [99.03696349]
mat_Sqrt:  [[0.15]]
grads:  [-0.00594682]
Stock Position:  -0.005946816813145216
Bond Position:  [3.80047125]


portfolio before change:  [3.21611925]
curr_Stock_Price:  98.34287948076934
curr_Factors:  [98.34287948]
mat_Sqrt:  [[0.15]]
grads:  [-0.0835566]
Stock Position:  -0.08355660479364409
Bond Position:  [11.43331637]


portfolio before change:  [3.31074482]
curr_Stock_Price:  97.22751200900834
curr_Factors:  [97.22751201]
mat_Sqrt:  [[0.15]]
grads:  [-0.06888659]
Stock Position:  -0.06888659398654565
Bond Position:  [10.00841697]


portfolio before change:  [3.24899614]
curr_Stock_Price:  98.1420558759071
curr_Factors:  [98.14205588]
mat_Sqrt:  [[0.15]]
grads:  [-0.05351045]
Stock Position:  -0.05351045320375969
Bond Position:  [8.50062203]


portfolio before change:  [3.22262736]
curr_Stock_Price:  98.65469271653406
curr_Factors:  [98.65469272]
mat_Sqrt:  [[0.15]]
grads:  [-0.0502116]
Stock Position:  -0.050211601309850966
Bond Position:  [8.17623746]


portfolio before change:  [3.16165318]
curr_Stock_Price:  99.88939289611258
curr_Factors:  [99.8893929]
mat_Sqrt:  [[0.15]]
grads:  [0.15108823]
Stock Position:  0.1510882348822671
Bond Position:  [-11.93045888]


portfolio before change:  [3.29290258]
curr_Stock_Price:  100.76795768849725
curr_Factors:  [100.76795769]
mat_Sqrt:  [[0.15]]
grads:  [0.04479602]
Stock Position:  0.04479601644611384
Bond Position:  [-1.22110051]


portfolio before change:  [3.25173311]
curr_Stock_Price:  99.85232218728994
curr_Factors:  [99.85232219]
mat_Sqrt:  [[0.15]]
grads:  [0.15921586]
Stock Position:  0.1592158634258855
Bond Position:  [-12.64634058]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.25173311]
Stock Price:  99.4877555997659
PL:  [3.25173311]
Settle:  Tensor("sub_352:0", shape=(), dtype=float64)
PL:  Tensor("sub_353:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  177
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.21209146e-03]
 [-2.74443425e-03]
 [-5.05375077e-03]
 [ 2.54471878e-02]
 [ 1.86858903e-02]
 [ 2.82317748e-02]
 [ 2.58426842e-02]
 [-2.98624663e-03]
 [ 1.66934875e-02]
 [-2.48227618e-03]
 [ 5.12226063e-03]
 [ 1.09368603e-02]
 [-7.26065460e-03]
 [ 1.00649156e-02]
 [-4.36564397e-03]
 [-1.92494292e-02]
 [ 2.86249421e-03]
 [-2.96086505e-03]
 [-1.15670423e-02]
 [-2.28283457e-03]
 [ 3.06848777e-04]
 [ 8.68661202e-03]
 [ 4.76663322e-03]
 [ 6.36295730e-03]
 [-3.61854123e-03]
 [-8.85141951e-03]
 [ 9.79734573e-03]
 [-1.97503914e-02]
 [-1.56383947e-02]
 [ 2.20215432e-02]
 [ 6.85049275e-03]
 [ 1.68110519e-03]
 [-1.24644470e-02]
 [-5.60445457e-03]
 [-5.89663543e-03]
 [-5.41706232e-03]
 [ 2.28372935e-02]
 [ 1.94100461e-03]
 [ 2.30632936e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [15.27589068]
curr_Stock_Price:  100.85912909177748
curr_Factors:  [100.85912909]
mat_Sqrt:  [[0.15]]
grads:  [-0.01474728]
Stock Position:  -0.014747276383738076
Bond Position:  [16.76328813]


portfolio before change:  [15.26878611]
curr_Stock_Price:  101.48298016206947
curr_Factors:  [101.48298016]
mat_Sqrt:  [[0.15]]
grads:  [-0.01829623]
Stock Position:  -0.01829622833689765
Bond Position:  [17.12554189]


portfolio before change:  [15.27984053]
curr_Stock_Price:  100.99579856122485
curr_Factors:  [100.99579856]
mat_Sqrt:  [[0.15]]
grads:  [-0.03369167]
Stock Position:  -0.03369167181187649
Bond Position:  [18.68255783]


portfolio before change:  [15.27300947]
curr_Stock_Price:  101.26786939732543
curr_Factors:  [101.2678694]
mat_Sqrt:  [[0.15]]
grads:  [0.16964792]
Stock Position:  0.16964791890175046
Bond Position:  [-1.90687382]


portfolio before change:  [15.27585005]
curr_Stock_Price:  101.2860184790572
curr_Factors:  [101.28601848]
mat_Sqrt:  [[0.15]]
grads:  [0.1245726]
Stock Position:  0.12457260182497067
Bond Position:  [2.6583872]


portfolio before change:  [15.27378579]
curr_Stock_Price:  101.26678008724726
curr_Factors:  [101.26678009]
mat_Sqrt:  [[0.15]]
grads:  [0.18821183]
Stock Position:  0.18821183199365704
Bond Position:  [-3.78582041]


portfolio before change:  [15.1626326]
curr_Stock_Price:  100.67871961259303
curr_Factors:  [100.67871961]
mat_Sqrt:  [[0.15]]
grads:  [0.17228456]
Stock Position:  0.1722845616246184
Bond Position:  [-2.18275648]


portfolio before change:  [14.99623667]
curr_Stock_Price:  99.71448310524961
curr_Factors:  [99.71448311]
mat_Sqrt:  [[0.15]]
grads:  [-0.01990831]
Stock Position:  -0.019908310887211518
Bond Position:  [16.9813836]


portfolio before change:  [15.00314864]
curr_Stock_Price:  99.47392202256641
curr_Factors:  [99.47392202]
mat_Sqrt:  [[0.15]]
grads:  [0.11128992]
Stock Position:  0.11128991685723902
Bond Position:  [3.93270413]


portfolio before change:  [15.0616167]
curr_Stock_Price:  99.99487160075456
curr_Factors:  [99.9948716]
mat_Sqrt:  [[0.15]]
grads:  [-0.01654851]
Stock Position:  -0.016548507866359603
Bond Position:  [16.71638262]


portfolio before change:  [15.06487842]
curr_Stock_Price:  99.92404692619681
curr_Factors:  [99.92404693]
mat_Sqrt:  [[0.15]]
grads:  [0.0341484]
Stock Position:  0.0341484042259842
Bond Position:  [11.65263167]


portfolio before change:  [15.08965197]
curr_Stock_Price:  100.60685711968823
curr_Factors:  [100.60685712]
mat_Sqrt:  [[0.15]]
grads:  [0.0729124]
Stock Position:  0.07291240200273878
Bond Position:  [7.75416436]


portfolio before change:  [15.01886353]
curr_Stock_Price:  99.62269305234074
curr_Factors:  [99.62269305]
mat_Sqrt:  [[0.15]]
grads:  [-0.04840436]
Stock Position:  -0.04840436397976538
Bond Position:  [19.84103663]


portfolio before change:  [15.02225592]
curr_Stock_Price:  99.60384970296147
curr_Factors:  [99.6038497]
mat_Sqrt:  [[0.15]]
grads:  [0.06709944]
Stock Position:  0.06709943735376328
Bond Position:  [8.33889364]


portfolio before change:  [15.02763477]
curr_Stock_Price:  99.66847663077915
curr_Factors:  [99.66847663]
mat_Sqrt:  [[0.15]]
grads:  [-0.02910429]
Stock Position:  -0.02910429314143768
Bond Position:  [17.92841533]


portfolio before change:  [15.01078892]
curr_Stock_Price:  100.3242919357283
curr_Factors:  [100.32429194]
mat_Sqrt:  [[0.15]]
grads:  [-0.12832953]
Stock Position:  -0.12832952794164615
Bond Position:  [27.88535795]


portfolio before change:  [15.04897766]
curr_Stock_Price:  100.0538720867534
curr_Factors:  [100.05387209]
mat_Sqrt:  [[0.15]]
grads:  [0.01908329]
Stock Position:  0.019083294753896
Bond Position:  [13.13962013]


portfolio before change:  [15.04484443]
curr_Stock_Price:  99.75121018263903
curr_Factors:  [99.75121018]
mat_Sqrt:  [[0.15]]
grads:  [-0.0197391]
Stock Position:  -0.019739100312441783
Bond Position:  [17.01384358]


portfolio before change:  [15.03643792]
curr_Stock_Price:  100.28484020189094
curr_Factors:  [100.2848402]
mat_Sqrt:  [[0.15]]
grads:  [-0.07711362]
Stock Position:  -0.07711361527353322
Bond Position:  [22.7697645]


portfolio before change:  [15.05783447]
curr_Stock_Price:  100.04428409911144
curr_Factors:  [100.0442841]
mat_Sqrt:  [[0.15]]
grads:  [-0.0152189]
Stock Position:  -0.015218897128048458
Bond Position:  [16.58039814]


portfolio before change:  [15.07272591]
curr_Stock_Price:  99.20199135433579
curr_Factors:  [99.20199135]
mat_Sqrt:  [[0.15]]
grads:  [0.00204566]
Stock Position:  0.0020456585139442683
Bond Position:  [14.86979252]


portfolio before change:  [15.07299482]
curr_Stock_Price:  98.42476701150835
curr_Factors:  [98.42476701]
mat_Sqrt:  [[0.15]]
grads:  [0.05791075]
Stock Position:  0.05791074679249139
Bond Position:  [9.37314306]


portfolio before change:  [15.11760717]
curr_Stock_Price:  99.17489789071577
curr_Factors:  [99.17489789]
mat_Sqrt:  [[0.15]]
grads:  [0.03177755]
Stock Position:  0.031777554772047294
Bond Position:  [11.96607142]


portfolio before change:  [15.14491485]
curr_Stock_Price:  99.9871638605795
curr_Factors:  [99.98716386]
mat_Sqrt:  [[0.15]]
grads:  [0.04241972]
Stock Position:  0.042419715315548605
Bond Position:  [10.90348783]


portfolio before change:  [15.19138354]
curr_Stock_Price:  101.05048220179357
curr_Factors:  [101.0504822]
mat_Sqrt:  [[0.15]]
grads:  [-0.02412361]
Stock Position:  -0.024123608168596166
Bond Position:  [17.62908577]


portfolio before change:  [15.19876663]
curr_Stock_Price:  100.83578282943948
curr_Factors:  [100.83578283]
mat_Sqrt:  [[0.15]]
grads:  [-0.05900946]
Stock Position:  -0.05900946340891664
Bond Position:  [21.14903207]


portfolio before change:  [15.21015582]
curr_Stock_Price:  100.68757959357322
curr_Factors:  [100.68757959]
mat_Sqrt:  [[0.15]]
grads:  [0.06531564]
Stock Position:  0.06531563818742513
Bond Position:  [8.6336823]


portfolio before change:  [15.20954817]
curr_Stock_Price:  100.66175225586342
curr_Factors:  [100.66175226]
mat_Sqrt:  [[0.15]]
grads:  [-0.13166928]
Stock Position:  -0.13166927585135557
Bond Position:  [28.46360819]


portfolio before change:  [15.15234167]
curr_Stock_Price:  101.12324691750204
curr_Factors:  [101.12324692]
mat_Sqrt:  [[0.15]]
grads:  [-0.10425596]
Stock Position:  -0.10425596444290633
Bond Position:  [25.69504331]


portfolio before change:  [15.15727763]
curr_Stock_Price:  101.1067118515805
curr_Factors:  [101.10671185]
mat_Sqrt:  [[0.15]]
grads:  [0.14681029]
Stock Position:  0.14681028823308123
Bond Position:  [0.31377213]


portfolio before change:  [15.1534471]
curr_Stock_Price:  101.08035297317149
curr_Factors:  [101.08035297]
mat_Sqrt:  [[0.15]]
grads:  [0.04566995]
Stock Position:  0.045669951645200685
Bond Position:  [10.53711227]


portfolio before change:  [15.10458847]
curr_Stock_Price:  99.98169072677538
curr_Factors:  [99.98169073]
mat_Sqrt:  [[0.15]]
grads:  [0.01120737]
Stock Position:  0.011207367915907304
Bond Position:  [13.98405688]


portfolio before change:  [15.11235754]
curr_Stock_Price:  100.51892238195076
curr_Factors:  [100.51892238]
mat_Sqrt:  [[0.15]]
grads:  [-0.08309631]
Stock Position:  -0.08309631318303921
Bond Position:  [23.4651094]


portfolio before change:  [15.08207034]
curr_Stock_Price:  100.91870579349248
curr_Factors:  [100.91870579]
mat_Sqrt:  [[0.15]]
grads:  [-0.03736303]
Stock Position:  -0.03736303047370913
Bond Position:  [18.85269902]


portfolio before change:  [15.09389285]
curr_Stock_Price:  100.66535978089186
curr_Factors:  [100.66535978]
mat_Sqrt:  [[0.15]]
grads:  [-0.0393109]
Stock Position:  -0.039310902880821945
Bond Position:  [19.05113903]


portfolio before change:  [15.05585981]
curr_Stock_Price:  101.69343532154322
curr_Factors:  [101.69343532]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611375]
Stock Position:  -0.036113748806623
Bond Position:  [18.72839099]


portfolio before change:  [15.07823314]
curr_Stock_Price:  101.13873983788612
curr_Factors:  [101.13873984]
mat_Sqrt:  [[0.15]]
grads:  [0.15224862]
Stock Position:  0.15224862310945175
Bond Position:  [-0.32000074]


portfolio before change:  [15.20367537]
curr_Stock_Price:  101.96293275319194
curr_Factors:  [101.96293275]
mat_Sqrt:  [[0.15]]
grads:  [0.01294003]
Stock Position:  0.01294003073207011
Bond Position:  [13.88427189]


portfolio before change:  [15.1947143]
curr_Stock_Price:  101.13629517545762
curr_Factors:  [101.13629518]
mat_Sqrt:  [[0.15]]
grads:  [0.15375529]
Stock Position:  0.1537552907716909
Bond Position:  [-0.35552617]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [15.1947143]
Stock Price:  100.78979527406844
PL:  [14.40491903]
Settle:  Tensor("sub_354:0", shape=(), dtype=float64)
PL:  Tensor("sub_355:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  178
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.53150725e-03]
 [-2.00721762e-03]
 [-2.26928320e-02]
 [-2.74445858e-02]
 [-1.84652312e-03]
 [ 2.49247729e-02]
 [-2.09319450e-03]
 [-1.22796708e-02]
 [-4.26858818e-03]
 [ 2.08500395e-03]
 [-8.64048910e-02]
 [-2.43573990e-02]
 [ 1.45515322e-02]
 [-1.68945300e-04]
 [ 1.85528966e-02]
 [-9.78337981e-03]
 [-9.93266443e-03]
 [ 3.63504471e-04]
 [-7.70073950e-03]
 [-2.74566087e-03]
 [ 9.96638098e-04]
 [ 1.39674424e-02]
 [ 4.75653356e-03]
 [ 5.44577060e-03]
 [ 2.51671239e-04]
 [-5.08186885e-03]
 [-5.82571846e-03]
 [-1.98732458e-02]
 [-3.07179873e-02]
 [ 2.18247347e-02]
 [ 6.39419670e-03]
 [-1.09020751e-03]
 [-1.24858063e-02]
 [-6.24449660e-03]
 [-7.45415324e-03]
 [-7.43500949e-03]
 [ 2.32384069e-02]
 [-1.84597779e-04]
 [ 2.12600968e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-15.46589105]
curr_Stock_Price:  98.87867985960472
curr_Factors:  [98.87867986]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687672]
Stock Position:  -0.03687671502596165
Bond Position:  [-11.81957015]


portfolio before change:  [-15.47085444]
curr_Stock_Price:  98.9732070873662
curr_Factors:  [98.97320709]
mat_Sqrt:  [[0.15]]
grads:  [-0.01338145]
Stock Position:  -0.013381450769496945
Bond Position:  [-14.14644935]


portfolio before change:  [-15.46848798]
curr_Stock_Price:  98.66420636568432
curr_Factors:  [98.66420637]
mat_Sqrt:  [[0.15]]
grads:  [-0.15128555]
Stock Position:  -0.15128554672068725
Bond Position:  [-0.54201958]


portfolio before change:  [-15.37625794]
curr_Stock_Price:  98.05411638689795
curr_Factors:  [98.05411639]
mat_Sqrt:  [[0.15]]
grads:  [-0.18296391]
Stock Position:  -0.18296390518158454
Bond Position:  [2.56410611]


portfolio before change:  [-15.2152892]
curr_Stock_Price:  97.1760841449806
curr_Factors:  [97.17608414]
mat_Sqrt:  [[0.15]]
grads:  [-0.01231015]
Stock Position:  -0.012310154136161457
Bond Position:  [-14.01903663]


portfolio before change:  [-15.20449021]
curr_Stock_Price:  96.15648040155678
curr_Factors:  [96.1564804]
mat_Sqrt:  [[0.15]]
grads:  [0.16616515]
Stock Position:  0.16616515264119985
Bond Position:  [-31.18234646]


portfolio before change:  [-15.30763933]
curr_Stock_Price:  95.55917660438502
curr_Factors:  [95.5591766]
mat_Sqrt:  [[0.15]]
grads:  [-0.01395463]
Stock Position:  -0.013954629980425341
Bond Position:  [-13.97414637]


portfolio before change:  [-15.31433334]
curr_Stock_Price:  95.91369243824037
curr_Factors:  [95.91369244]
mat_Sqrt:  [[0.15]]
grads:  [-0.08186447]
Stock Position:  -0.08186447176853531
Bond Position:  [-7.46240957]


portfolio before change:  [-15.33615563]
curr_Stock_Price:  96.16886332398511
curr_Factors:  [96.16886332]
mat_Sqrt:  [[0.15]]
grads:  [-0.02845725]
Stock Position:  -0.028457254515983015
Bond Position:  [-12.59945381]


portfolio before change:  [-15.34461179]
curr_Stock_Price:  96.41066907137258
curr_Factors:  [96.41066907]
mat_Sqrt:  [[0.15]]
grads:  [0.01390003]
Stock Position:  0.013900026300022503
Bond Position:  [-16.68472262]


portfolio before change:  [-15.3541902]
curr_Stock_Price:  95.87162785144974
curr_Factors:  [95.87162785]
mat_Sqrt:  [[0.15]]
grads:  [-0.57603261]
Stock Position:  -0.5760326067369222
Bond Position:  [39.87099351]


portfolio before change:  [-14.86754936]
curr_Stock_Price:  95.03546572818624
curr_Factors:  [95.03546573]
mat_Sqrt:  [[0.15]]
grads:  [-0.16238266]
Stock Position:  -0.1623826600863834
Bond Position:  [0.56456237]


portfolio before change:  [-14.88913512]
curr_Stock_Price:  95.168831743772
curr_Factors:  [95.16883174]
mat_Sqrt:  [[0.15]]
grads:  [0.09701021]
Stock Position:  0.09701021474544726
Bond Position:  [-24.12148392]


portfolio before change:  [-14.9034233]
curr_Stock_Price:  95.05262943183777
curr_Factors:  [95.05262943]
mat_Sqrt:  [[0.15]]
grads:  [-0.0011263]
Stock Position:  -0.0011263019991973717
Bond Position:  [-14.79636533]


portfolio before change:  [-14.90528089]
curr_Stock_Price:  95.05966413735959
curr_Factors:  [95.05966414]
mat_Sqrt:  [[0.15]]
grads:  [0.12368598]
Stock Position:  0.12368597703396253
Bond Position:  [-26.66282832]


portfolio before change:  [-14.75270583]
curr_Stock_Price:  96.32017988372806
curr_Factors:  [96.32017988]
mat_Sqrt:  [[0.15]]
grads:  [-0.06522253]
Stock Position:  -0.06522253206599014
Bond Position:  [-8.4704598]


portfolio before change:  [-14.72735776]
curr_Stock_Price:  95.91530546912341
curr_Factors:  [95.91530547]
mat_Sqrt:  [[0.15]]
grads:  [-0.06621776]
Stock Position:  -0.0662177628919288
Bond Position:  [-8.37606081]


portfolio before change:  [-14.68594116]
curr_Stock_Price:  95.27403222152708
curr_Factors:  [95.27403222]
mat_Sqrt:  [[0.15]]
grads:  [0.00242336]
Stock Position:  0.0024233631386894505
Bond Position:  [-14.91682474]


portfolio before change:  [-14.687439]
curr_Stock_Price:  95.42542570487618
curr_Factors:  [95.4254257]
mat_Sqrt:  [[0.15]]
grads:  [-0.05133826]
Stock Position:  -0.05133826332124991
Bond Position:  [-9.78846336]


portfolio before change:  [-14.69816362]
curr_Stock_Price:  95.6104920938219
curr_Factors:  [95.61049209]
mat_Sqrt:  [[0.15]]
grads:  [-0.01830441]
Stock Position:  -0.018304405781958775
Bond Position:  [-12.94807037]


portfolio before change:  [-14.68924798]
curr_Stock_Price:  95.03498878456293
curr_Factors:  [95.03498878]
mat_Sqrt:  [[0.15]]
grads:  [0.00664425]
Stock Position:  0.006644253983405967
Bond Position:  [-15.32068458]


portfolio before change:  [-14.68490321]
curr_Stock_Price:  95.97715308786493
curr_Factors:  [95.97715309]
mat_Sqrt:  [[0.15]]
grads:  [0.09311628]
Stock Position:  0.09311628248848822
Bond Position:  [-23.62193891]


portfolio before change:  [-14.7028938]
curr_Stock_Price:  95.81565972221259
curr_Factors:  [95.81565972]
mat_Sqrt:  [[0.15]]
grads:  [0.03171022]
Stock Position:  0.031710223738691944
Bond Position:  [-17.7412298]


portfolio before change:  [-14.70469253]
curr_Stock_Price:  95.82887507626718
curr_Factors:  [95.82887508]
mat_Sqrt:  [[0.15]]
grads:  [0.03630514]
Stock Position:  0.036305137312157114
Bond Position:  [-18.183773]


portfolio before change:  [-14.69304478]
curr_Stock_Price:  96.21231560435943
curr_Factors:  [96.2123156]
mat_Sqrt:  [[0.15]]
grads:  [0.00167781]
Stock Position:  0.0016778082613920962
Bond Position:  [-14.8544706]


portfolio before change:  [-14.69242933]
curr_Stock_Price:  97.68588747381574
curr_Factors:  [97.68588747]
mat_Sqrt:  [[0.15]]
grads:  [-0.03387913]
Stock Position:  -0.03387912567968664
Bond Position:  [-11.38291687]


portfolio before change:  [-14.70069001]
curr_Stock_Price:  97.88771461025625
curr_Factors:  [97.88771461]
mat_Sqrt:  [[0.15]]
grads:  [-0.03883812]
Stock Position:  -0.038838123098842846
Bond Position:  [-10.8989149]


portfolio before change:  [-14.68113648]
curr_Stock_Price:  97.34917196384609
curr_Factors:  [97.34917196]
mat_Sqrt:  [[0.15]]
grads:  [-0.13248831]
Stock Position:  -0.13248830557794916
Bond Position:  [-1.78350963]


portfolio before change:  [-14.70835109]
curr_Stock_Price:  97.55290057530583
curr_Factors:  [97.55290058]
mat_Sqrt:  [[0.15]]
grads:  [-0.20478658]
Stock Position:  -0.20478658226704885
Bond Position:  [5.26917401]


portfolio before change:  [-14.96995004]
curr_Stock_Price:  98.83353935130044
curr_Factors:  [98.83353935]
mat_Sqrt:  [[0.15]]
grads:  [0.14549823]
Stock Position:  0.14549823155578484
Bond Position:  [-29.35005523]


portfolio before change:  [-14.98299424]
curr_Stock_Price:  98.76910411079204
curr_Factors:  [98.76910411]
mat_Sqrt:  [[0.15]]
grads:  [0.04262798]
Stock Position:  0.04262797800849005
Bond Position:  [-19.19332144]


portfolio before change:  [-14.97695382]
curr_Stock_Price:  98.96708986392427
curr_Factors:  [98.96708986]
mat_Sqrt:  [[0.15]]
grads:  [-0.00726805]
Stock Position:  -0.007268050061698381
Bond Position:  [-14.25765606]


portfolio before change:  [-14.98789368]
curr_Stock_Price:  100.22706180221313
curr_Factors:  [100.2270618]
mat_Sqrt:  [[0.15]]
grads:  [-0.08323871]
Stock Position:  -0.08323870859062187
Bond Position:  [-6.64512249]


portfolio before change:  [-14.9512841]
curr_Stock_Price:  99.77726785004032
curr_Factors:  [99.77726785]
mat_Sqrt:  [[0.15]]
grads:  [-0.04162998]
Stock Position:  -0.04162997733938569
Bond Position:  [-10.7975587]


portfolio before change:  [-14.9587977]
curr_Stock_Price:  99.92532987687831
curr_Factors:  [99.92532988]
mat_Sqrt:  [[0.15]]
grads:  [-0.04969435]
Stock Position:  -0.049694354935568875
Bond Position:  [-9.99307289]


portfolio before change:  [-14.98050725]
curr_Stock_Price:  100.337053492155
curr_Factors:  [100.33705349]
mat_Sqrt:  [[0.15]]
grads:  [-0.04956673]
Stock Position:  -0.0495667299229941
Bond Position:  [-10.00712762]


portfolio before change:  [-15.07276802]
curr_Stock_Price:  102.17315995136666
curr_Factors:  [102.17315995]
mat_Sqrt:  [[0.15]]
grads:  [0.15492271]
Stock Position:  0.15492271278546255
Bond Position:  [-30.90171113]


portfolio before change:  [-14.97787135]
curr_Stock_Price:  102.81063665826335
curr_Factors:  [102.81063666]
mat_Sqrt:  [[0.15]]
grads:  [-0.00123065]
Stock Position:  -0.001230651857920714
Bond Position:  [-14.85134725]


portfolio before change:  [-14.98025953]
curr_Stock_Price:  103.24264130943962
curr_Factors:  [103.24264131]
mat_Sqrt:  [[0.15]]
grads:  [0.14173398]
Stock Position:  0.14173397886468822
Bond Position:  [-29.61324987]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-14.98025953]
Stock Price:  102.21818839468396
PL:  [-17.19844793]
Settle:  Tensor("sub_356:0", shape=(), dtype=float64)
PL:  Tensor("sub_357:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  179
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.29112071e-03]
 [ 1.53042787e-03]
 [ 1.97328416e-02]
 [-5.41751916e-03]
 [ 1.29498393e-02]
 [ 2.26711324e-02]
 [ 6.61134828e-03]
 [-4.82423020e-03]
 [ 1.29976311e-02]
 [-3.31972805e-03]
 [-9.98220943e-03]
 [-1.23705976e-03]
 [ 7.38526530e-03]
 [ 1.07850111e-02]
 [-3.65412168e-03]
 [-9.51706273e-03]
 [-5.33317726e-03]
 [-2.50678177e-03]
 [-7.52848705e-03]
 [-2.28029238e-03]
 [ 4.11040565e-04]
 [ 8.60763168e-03]
 [ 4.76664274e-03]
 [ 6.05227780e-03]
 [-3.47355078e-03]
 [-4.88914703e-03]
 [-5.84145072e-03]
 [-2.04668108e-02]
 [-3.62633328e-02]
 [ 2.19967149e-02]
 [ 3.81752835e-03]
 [-3.23906646e-03]
 [-1.25338558e-02]
 [-9.90546384e-03]
 [-8.07799262e-03]
 [-7.48573618e-03]
 [ 2.27116433e-02]
 [ 8.31333831e-03]
 [ 2.40618491e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.85926857]
curr_Stock_Price:  99.56198044157887
curr_Factors:  [99.56198044]
mat_Sqrt:  [[0.15]]
grads:  [-0.0219408]
Stock Position:  -0.0219408047517461
Bond Position:  [-2.6747986]


portfolio before change:  [-4.85197786]
curr_Stock_Price:  99.21445059794476
curr_Factors:  [99.2144506]
mat_Sqrt:  [[0.15]]
grads:  [0.01020285]
Stock Position:  0.01020285244019048
Bond Position:  [-5.86424826]


portfolio before change:  [-4.84445265]
curr_Stock_Price:  100.02386032683667
curr_Factors:  [100.02386033]
mat_Sqrt:  [[0.15]]
grads:  [0.13155228]
Stock Position:  0.1315522774429767
Bond Position:  [-18.00281927]


portfolio before change:  [-4.85860232]
curr_Stock_Price:  99.93340823905318
curr_Factors:  [99.93340824]
mat_Sqrt:  [[0.15]]
grads:  [-0.03611679]
Stock Position:  -0.03611679440662114
Bond Position:  [-1.24932796]


portfolio before change:  [-4.83681528]
curr_Stock_Price:  99.32584562158847
curr_Factors:  [99.32584562]
mat_Sqrt:  [[0.15]]
grads:  [0.08633226]
Stock Position:  0.08633226168628268
Bond Position:  [-13.41184018]


portfolio before change:  [-4.92023475]
curr_Stock_Price:  98.37900509100653
curr_Factors:  [98.37900509]
mat_Sqrt:  [[0.15]]
grads:  [0.15114088]
Stock Position:  0.15114088258941816
Bond Position:  [-19.78932441]


portfolio before change:  [-4.96834704]
curr_Stock_Price:  98.07704530814826
curr_Factors:  [98.07704531]
mat_Sqrt:  [[0.15]]
grads:  [0.04407566]
Stock Position:  0.044075655232978676
Bond Position:  [-9.29115707]


portfolio before change:  [-4.96386254]
curr_Stock_Price:  98.20514249529346
curr_Factors:  [98.2051425]
mat_Sqrt:  [[0.15]]
grads:  [-0.03216153]
Stock Position:  -0.03216153468337926
Bond Position:  [-1.80543444]


portfolio before change:  [-4.96725685]
curr_Stock_Price:  98.30366438787617
curr_Factors:  [98.30366439]
mat_Sqrt:  [[0.15]]
grads:  [0.08665087]
Stock Position:  0.08665087393160407
Bond Position:  [-13.48535528]


portfolio before change:  [-4.89304853]
curr_Stock_Price:  99.17952498922867
curr_Factors:  [99.17952499]
mat_Sqrt:  [[0.15]]
grads:  [-0.02213152]
Stock Position:  -0.022131520357961103
Bond Position:  [-2.69805486]


portfolio before change:  [-4.86322205]
curr_Stock_Price:  97.816592741683
curr_Factors:  [97.81659274]
mat_Sqrt:  [[0.15]]
grads:  [-0.06654806]
Stock Position:  -0.06654806287585464
Bond Position:  [1.64628272]


portfolio before change:  [-4.88140865]
curr_Stock_Price:  98.09297047541727
curr_Factors:  [98.09297048]
mat_Sqrt:  [[0.15]]
grads:  [-0.00824707]
Stock Position:  -0.008247065041465999
Bond Position:  [-4.07242955]


portfolio before change:  [-4.87957818]
curr_Stock_Price:  97.80928641531898
curr_Factors:  [97.80928642]
mat_Sqrt:  [[0.15]]
grads:  [0.0492351]
Stock Position:  0.04923510202585002
Bond Position:  [-9.69522837]


portfolio before change:  [-4.85022829]
curr_Stock_Price:  98.43001963967929
curr_Factors:  [98.43001964]
mat_Sqrt:  [[0.15]]
grads:  [0.07190007]
Stock Position:  0.07190007371048772
Bond Position:  [-11.92735396]


portfolio before change:  [-4.80921888]
curr_Stock_Price:  99.02112378044596
curr_Factors:  [99.02112378]
mat_Sqrt:  [[0.15]]
grads:  [-0.02436081]
Stock Position:  -0.024360811213091457
Bond Position:  [-2.39698397]


portfolio before change:  [-4.80066762]
curr_Stock_Price:  98.65779849734929
curr_Factors:  [98.6577985]
mat_Sqrt:  [[0.15]]
grads:  [-0.06344708]
Stock Position:  -0.06344708484368534
Bond Position:  [1.45888209]


portfolio before change:  [-4.74538253]
curr_Stock_Price:  97.78931543484981
curr_Factors:  [97.78931543]
mat_Sqrt:  [[0.15]]
grads:  [-0.03555452]
Stock Position:  -0.03555451505405868
Bond Position:  [-1.26853084]


portfolio before change:  [-4.76926832]
curr_Stock_Price:  98.45666299257846
curr_Factors:  [98.45666299]
mat_Sqrt:  [[0.15]]
grads:  [-0.01671188]
Stock Position:  -0.01671187843655542
Bond Position:  [-3.12387254]


portfolio before change:  [-4.76252174]
curr_Stock_Price:  98.0295961990982
curr_Factors:  [98.0295962]
mat_Sqrt:  [[0.15]]
grads:  [-0.05018991]
Stock Position:  -0.05018991367986959
Bond Position:  [0.15757523]


portfolio before change:  [-4.83359107]
curr_Stock_Price:  99.44599678095449
curr_Factors:  [99.44599678]
mat_Sqrt:  [[0.15]]
grads:  [-0.01520195]
Stock Position:  -0.015201949201568025
Bond Position:  [-3.32181808]


portfolio before change:  [-4.84482792]
curr_Stock_Price:  100.15785254734932
curr_Factors:  [100.15785255]
mat_Sqrt:  [[0.15]]
grads:  [0.00274027]
Stock Position:  0.0027402704303485597
Bond Position:  [-5.11928752]


portfolio before change:  [-4.84951377]
curr_Stock_Price:  98.68138971754841
curr_Factors:  [98.68138972]
mat_Sqrt:  [[0.15]]
grads:  [0.05738421]
Stock Position:  0.057384211203583085
Bond Position:  [-10.51226748]


portfolio before change:  [-4.8232779]
curr_Stock_Price:  99.1614868067967
curr_Factors:  [99.16148681]
mat_Sqrt:  [[0.15]]
grads:  [0.03177762]
Stock Position:  0.03177761827758952
Bond Position:  [-7.97439377]


portfolio before change:  [-4.8121921]
curr_Stock_Price:  99.5417121775664
curr_Factors:  [99.54171218]
mat_Sqrt:  [[0.15]]
grads:  [0.04034852]
Stock Position:  0.040348518686808485
Bond Position:  [-8.82855274]


portfolio before change:  [-4.86069961]
curr_Stock_Price:  98.36685207811043
curr_Factors:  [98.36685208]
mat_Sqrt:  [[0.15]]
grads:  [-0.02315701]
Stock Position:  -0.023157005205586084
Bond Position:  [-2.5828179]


portfolio before change:  [-4.8414027]
curr_Stock_Price:  97.51960196518361
curr_Factors:  [97.51960197]
mat_Sqrt:  [[0.15]]
grads:  [-0.03259431]
Stock Position:  -0.032594313548052714
Bond Position:  [-1.66281822]


portfolio before change:  [-4.8535016]
curr_Stock_Price:  97.88442132669331
curr_Factors:  [97.88442133]
mat_Sqrt:  [[0.15]]
grads:  [-0.038943]
Stock Position:  -0.038943004822354
Bond Position:  [-1.04158811]


portfolio before change:  [-4.8519893]
curr_Stock_Price:  97.84224395868657
curr_Factors:  [97.84224396]
mat_Sqrt:  [[0.15]]
grads:  [-0.13644541]
Stock Position:  -0.13644540545647038
Bond Position:  [8.49813535]


portfolio before change:  [-4.9247733]
curr_Stock_Price:  98.38345922722094
curr_Factors:  [98.38345923]
mat_Sqrt:  [[0.15]]
grads:  [-0.24175555]
Stock Position:  -0.24175555206222596
Bond Position:  [18.8599742]


portfolio before change:  [-4.92093915]
curr_Stock_Price:  98.37735178078928
curr_Factors:  [98.37735178]
mat_Sqrt:  [[0.15]]
grads:  [0.14664477]
Stock Position:  0.14664476629944284
Bond Position:  [-19.34746291]


portfolio before change:  [-5.03985675]
curr_Stock_Price:  97.58292168942252
curr_Factors:  [97.58292169]
mat_Sqrt:  [[0.15]]
grads:  [0.02545019]
Stock Position:  0.02545018898687426
Bond Position:  [-7.52336055]


portfolio before change:  [-5.02926958]
curr_Stock_Price:  98.03587085779147
curr_Factors:  [98.03587086]
mat_Sqrt:  [[0.15]]
grads:  [-0.02159378]
Stock Position:  -0.021593776385761113
Bond Position:  [-2.91230491]


portfolio before change:  [-5.01202987]
curr_Stock_Price:  97.22064658651979
curr_Factors:  [97.22064659]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355904]
Stock Position:  -0.08355903859449924
Bond Position:  [3.11163389]


portfolio before change:  [-5.04795505]
curr_Stock_Price:  97.65523936746177
curr_Factors:  [97.65523937]
mat_Sqrt:  [[0.15]]
grads:  [-0.06603643]
Stock Position:  -0.06603642563065576
Bond Position:  [1.4008479]


portfolio before change:  [-5.08434891]
curr_Stock_Price:  98.20900909598262
curr_Factors:  [98.2090091]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385328]
Stock Position:  -0.05385328411934897
Bond Position:  [0.20452876]


portfolio before change:  [-5.16281434]
curr_Stock_Price:  99.66650606184723
curr_Factors:  [99.66650606]
mat_Sqrt:  [[0.15]]
grads:  [-0.04990491]
Stock Position:  -0.04990490783426844
Bond Position:  [-0.18896654]


portfolio before change:  [-5.18728127]
curr_Stock_Price:  100.15630384461369
curr_Factors:  [100.15630384]
mat_Sqrt:  [[0.15]]
grads:  [0.15141096]
Stock Position:  0.1514109555190662
Bond Position:  [-20.35204294]


portfolio before change:  [-5.33774625]
curr_Stock_Price:  99.17935465503204
curr_Factors:  [99.17935466]
mat_Sqrt:  [[0.15]]
grads:  [0.05542226]
Stock Position:  0.05542225539316124
Bond Position:  [-10.83448977]


portfolio before change:  [-5.29570721]
curr_Stock_Price:  99.96231513637595
curr_Factors:  [99.96231514]
mat_Sqrt:  [[0.15]]
grads:  [0.16041233]
Stock Position:  0.16041232758011809
Bond Position:  [-21.33089485]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.29570721]
Stock Price:  99.25476588951082
PL:  [-5.29570721]
Settle:  Tensor("sub_358:0", shape=(), dtype=float64)
PL:  Tensor("sub_359:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  180
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.05294366e-03]
 [-2.11543368e-03]
 [-3.54959474e-03]
 [ 9.33288428e-02]
 [-5.84798238e-02]
 [ 3.40757804e-02]
 [ 5.51841910e-03]
 [ 1.85607135e-04]
 [ 4.45970582e-03]
 [ 1.16727379e-02]
 [ 2.53209125e-02]
 [-2.57108469e-04]
 [-1.25982172e-02]
 [ 9.13176760e-03]
 [-2.91772197e-03]
 [-2.69770960e-02]
 [ 4.82832030e-03]
 [ 2.30538702e-03]
 [-6.89728927e-03]
 [-2.30617222e-03]
 [-3.61813803e-04]
 [-3.07911816e-02]
 [ 4.77951986e-03]
 [ 7.11060353e-03]
 [-4.17409446e-03]
 [-9.13324761e-03]
 [ 8.88975166e-03]
 [-1.95895684e-02]
 [-3.11747506e-03]
 [ 2.39779849e-02]
 [-9.73361980e-03]
 [ 6.23283648e-03]
 [-1.29354923e-02]
 [-5.29031138e-03]
 [-5.74265677e-03]
 [-2.43485918e-03]
 [ 2.34862737e-02]
 [ 4.50497180e-04]
 [ 2.08777543e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.22267483]
curr_Stock_Price:  101.1133890989319
curr_Factors:  [101.1133891]
mat_Sqrt:  [[0.15]]
grads:  [-0.02035296]
Stock Position:  -0.020352957731679194
Bond Position:  [21.28063136]


portfolio before change:  [19.21594098]
curr_Stock_Price:  101.57494829696745
curr_Factors:  [101.5749483]
mat_Sqrt:  [[0.15]]
grads:  [-0.01410289]
Stock Position:  -0.014102891206717797
Bond Position:  [20.64844142]


portfolio before change:  [19.2163646]
curr_Stock_Price:  101.72793774971394
curr_Factors:  [101.72793775]
mat_Sqrt:  [[0.15]]
grads:  [-0.02366396]
Stock Position:  -0.023663964912602555
Bond Position:  [21.62365095]


portfolio before change:  [19.17706128]
curr_Stock_Price:  103.50306070309732
curr_Factors:  [103.5030607]
mat_Sqrt:  [[0.15]]
grads:  [0.62219229]
Stock Position:  0.6221922853402329
Bond Position:  [-45.2217446]


portfolio before change:  [19.56035926]
curr_Stock_Price:  104.12819068930781
curr_Factors:  [104.12819069]
mat_Sqrt:  [[0.15]]
grads:  [-0.38986549]
Stock Position:  -0.3898654921366878
Bond Position:  [60.15634757]


portfolio before change:  [20.17055832]
curr_Stock_Price:  102.58232666329316
curr_Factors:  [102.58232666]
mat_Sqrt:  [[0.15]]
grads:  [0.22717187]
Stock Position:  0.22717186930619981
Bond Position:  [-3.13326059]


portfolio before change:  [20.21681798]
curr_Stock_Price:  102.78768369986622
curr_Factors:  [102.7876837]
mat_Sqrt:  [[0.15]]
grads:  [0.03678946]
Stock Position:  0.03678946065771
Bond Position:  [16.43531453]


portfolio before change:  [20.19108447]
curr_Stock_Price:  102.0323573001657
curr_Factors:  [102.0323573]
mat_Sqrt:  [[0.15]]
grads:  [0.00123738]
Stock Position:  0.0012373809013973447
Bond Position:  [20.06483158]


portfolio before change:  [20.19172781]
curr_Stock_Price:  100.5252040758792
curr_Factors:  [100.52520408]
mat_Sqrt:  [[0.15]]
grads:  [0.02973137]
Stock Position:  0.02973137213559353
Bond Position:  [17.20297555]


portfolio before change:  [20.23923827]
curr_Stock_Price:  102.05086390548018
curr_Factors:  [102.05086391]
mat_Sqrt:  [[0.15]]
grads:  [0.07781825]
Stock Position:  0.07781825250988149
Bond Position:  [12.29781838]


portfolio before change:  [20.30629488]
curr_Stock_Price:  102.89281655732631
curr_Factors:  [102.89281656]
mat_Sqrt:  [[0.15]]
grads:  [0.16880608]
Stock Position:  0.16880608362936095
Bond Position:  [2.93736148]


portfolio before change:  [20.2763038]
curr_Stock_Price:  102.7129754716937
curr_Factors:  [102.71297547]
mat_Sqrt:  [[0.15]]
grads:  [-0.00171406]
Stock Position:  -0.0017140564621049663
Bond Position:  [20.45235964]


portfolio before change:  [20.27715793]
curr_Stock_Price:  103.70628084371764
curr_Factors:  [103.70628084]
mat_Sqrt:  [[0.15]]
grads:  [-0.08398811]
Stock Position:  -0.08398811499349755
Bond Position:  [28.98725297]


portfolio before change:  [20.35341019]
curr_Stock_Price:  102.841531936534
curr_Factors:  [102.84153194]
mat_Sqrt:  [[0.15]]
grads:  [0.06087845]
Stock Position:  0.060878450658559784
Bond Position:  [14.09257706]


portfolio before change:  [20.33727507]
curr_Stock_Price:  102.54755600994285
curr_Factors:  [102.54755601]
mat_Sqrt:  [[0.15]]
grads:  [-0.01945148]
Stock Position:  -0.019451479814706542
Bond Position:  [22.33197679]


portfolio before change:  [20.33274212]
curr_Stock_Price:  102.92411480075262
curr_Factors:  [102.9241148]
mat_Sqrt:  [[0.15]]
grads:  [-0.17984731]
Stock Position:  -0.17984730664519502
Bond Position:  [38.84336695]


portfolio before change:  [20.33155904]
curr_Stock_Price:  102.95769218621659
curr_Factors:  [102.95769219]
mat_Sqrt:  [[0.15]]
grads:  [0.0321888]
Stock Position:  0.032188802001621976
Bond Position:  [17.01747427]


portfolio before change:  [20.29520775]
curr_Stock_Price:  101.76228858299332
curr_Factors:  [101.76228858]
mat_Sqrt:  [[0.15]]
grads:  [0.01536925]
Stock Position:  0.01536924683133857
Bond Position:  [18.73119802]


portfolio before change:  [20.29676094]
curr_Stock_Price:  101.71099414734371
curr_Factors:  [101.71099415]
mat_Sqrt:  [[0.15]]
grads:  [-0.04598193]
Stock Position:  -0.04598192846987723
Bond Position:  [24.9736286]


portfolio before change:  [20.30937144]
curr_Stock_Price:  101.50463918101742
curr_Factors:  [101.50463918]
mat_Sqrt:  [[0.15]]
grads:  [-0.01537448]
Stock Position:  -0.015374481499853803
Bond Position:  [21.86995263]


portfolio before change:  [20.30674417]
curr_Stock_Price:  101.85334548203261
curr_Factors:  [101.85334548]
mat_Sqrt:  [[0.15]]
grads:  [-0.00241209]
Stock Position:  -0.002412092017655447
Bond Position:  [20.55242381]


portfolio before change:  [20.30826578]
curr_Stock_Price:  102.28765760612167
curr_Factors:  [102.28765761]
mat_Sqrt:  [[0.15]]
grads:  [-0.20527454]
Stock Position:  -0.20527454419993704
Bond Position:  [41.30531808]


portfolio before change:  [20.59319244]
curr_Stock_Price:  100.92478443167792
curr_Factors:  [100.92478443]
mat_Sqrt:  [[0.15]]
grads:  [0.03186347]
Stock Position:  0.031863465743911856
Bond Position:  [17.37737903]


portfolio before change:  [20.59690181]
curr_Stock_Price:  100.9730234605168
curr_Factors:  [100.97302346]
mat_Sqrt:  [[0.15]]
grads:  [0.04740402]
Stock Position:  0.047404023533274366
Bond Position:  [15.81037423]


portfolio before change:  [20.55020333]
curr_Stock_Price:  99.94621384660302
curr_Factors:  [99.94621385]
mat_Sqrt:  [[0.15]]
grads:  [-0.0278273]
Stock Position:  -0.02782729642339496
Bond Position:  [23.33143625]


portfolio before change:  [20.53179272]
curr_Stock_Price:  100.71262744137553
curr_Factors:  [100.71262744]
mat_Sqrt:  [[0.15]]
grads:  [-0.06088832]
Stock Position:  -0.06088831743125793
Bond Position:  [26.66401515]


portfolio before change:  [20.52892816]
curr_Stock_Price:  100.81441662455131
curr_Factors:  [100.81441662]
mat_Sqrt:  [[0.15]]
grads:  [0.05926501]
Stock Position:  0.05926501103506134
Bond Position:  [14.55416064]


portfolio before change:  [20.54538146]
curr_Stock_Price:  101.06133997263464
curr_Factors:  [101.06133997]
mat_Sqrt:  [[0.15]]
grads:  [-0.13059712]
Stock Position:  -0.13059712268141227
Bond Position:  [33.74370167]


portfolio before change:  [20.37488242]
curr_Stock_Price:  102.39917392051768
curr_Factors:  [102.39917392]
mat_Sqrt:  [[0.15]]
grads:  [-0.02078317]
Stock Position:  -0.02078316707039831
Bond Position:  [22.50306156]


portfolio before change:  [20.36576984]
curr_Stock_Price:  102.97298643950151
curr_Factors:  [102.97298644]
mat_Sqrt:  [[0.15]]
grads:  [0.15985323]
Stock Position:  0.1598532329654343
Bond Position:  [3.90520505]


portfolio before change:  [20.39914774]
curr_Stock_Price:  103.17873593796436
curr_Factors:  [103.17873594]
mat_Sqrt:  [[0.15]]
grads:  [-0.0648908]
Stock Position:  -0.06489079868705334
Bond Position:  [27.09449832]


portfolio before change:  [20.3641717]
curr_Stock_Price:  103.76993012721469
curr_Factors:  [103.76993013]
mat_Sqrt:  [[0.15]]
grads:  [0.04155224]
Stock Position:  0.041552243166767075
Bond Position:  [16.05229833]


portfolio before change:  [20.3522851]
curr_Stock_Price:  103.43557371439023
curr_Factors:  [103.43557371]
mat_Sqrt:  [[0.15]]
grads:  [-0.08623662]
Stock Position:  -0.08623661552293664
Bond Position:  [29.27221891]


portfolio before change:  [20.45199616]
curr_Stock_Price:  102.32175684197666
curr_Factors:  [102.32175684]
mat_Sqrt:  [[0.15]]
grads:  [-0.03526874]
Stock Position:  -0.03526874251149563
Bond Position:  [24.06075585]


portfolio before change:  [20.41371273]
curr_Stock_Price:  103.49251627856455
curr_Factors:  [103.49251628]
mat_Sqrt:  [[0.15]]
grads:  [-0.03828438]
Stock Position:  -0.038284378466061635
Bond Position:  [24.37585939]


portfolio before change:  [20.43315022]
curr_Stock_Price:  103.0643960196176
curr_Factors:  [103.06439602]
mat_Sqrt:  [[0.15]]
grads:  [-0.01623239]
Stock Position:  -0.016232394530375366
Bond Position:  [22.10613216]


portfolio before change:  [20.43109986]
curr_Stock_Price:  103.36095099533294
curr_Factors:  [103.360951]
mat_Sqrt:  [[0.15]]
grads:  [0.15657516]
Stock Position:  0.1565751578148038
Bond Position:  [4.24734265]


portfolio before change:  [20.56495949]
curr_Stock_Price:  104.21248251176996
curr_Factors:  [104.21248251]
mat_Sqrt:  [[0.15]]
grads:  [0.00300331]
Stock Position:  0.0030033145306258063
Bond Position:  [20.25197663]


portfolio before change:  [20.56633541]
curr_Stock_Price:  103.82766144613272
curr_Factors:  [103.82766145]
mat_Sqrt:  [[0.15]]
grads:  [0.13918503]
Stock Position:  0.13918502842641434
Bond Position:  [6.1150794]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [20.56633541]
Stock Price:  103.43270708128438
PL:  [17.13362833]
Settle:  Tensor("sub_360:0", shape=(), dtype=float64)
PL:  Tensor("sub_361:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  181
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.18636613e-03]
 [-1.52633961e-02]
 [ 2.21801577e-02]
 [-6.89683761e-04]
 [ 1.65915061e-02]
 [ 1.48520996e-02]
 [ 2.17196719e-02]
 [-2.96352804e-03]
 [ 1.18013170e-02]
 [ 8.25512411e-03]
 [ 2.45123670e-02]
 [ 1.00418309e-02]
 [-1.15014950e-02]
 [ 1.17113134e-02]
 [-2.16099906e-03]
 [-3.05671276e-02]
 [ 4.90648209e-03]
 [-7.62211821e-03]
 [ 5.64947822e-03]
 [-3.87637666e-03]
 [-2.65973688e-03]
 [-3.93761740e-02]
 [ 4.83653201e-03]
 [ 1.19385140e-02]
 [-5.89296107e-03]
 [ 1.52785310e-02]
 [-1.47038297e-02]
 [ 9.50547201e-03]
 [ 6.87436913e-02]
 [ 2.65166407e-02]
 [-2.45213989e-02]
 [ 6.29494401e-03]
 [-1.30164928e-02]
 [ 2.82360400e-03]
 [-6.27610807e-03]
 [ 1.51737851e-03]
 [ 2.43033357e-02]
 [ 4.83348739e-03]
 [ 1.86421348e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [19.88079334]
curr_Stock_Price:  101.15578645617316
curr_Factors:  [101.15578646]
mat_Sqrt:  [[0.15]]
grads:  [-0.02124244]
Stock Position:  -0.021242440843671752
Bond Position:  [22.02958915]


portfolio before change:  [19.9044787]
curr_Stock_Price:  100.17042488401042
curr_Factors:  [100.17042488]
mat_Sqrt:  [[0.15]]
grads:  [-0.10175597]
Stock Position:  -0.10175597419018452
Bond Position:  [30.09741787]


portfolio before change:  [19.91068332]
curr_Stock_Price:  100.14642422624445
curr_Factors:  [100.14642423]
mat_Sqrt:  [[0.15]]
grads:  [0.14786772]
Stock Position:  0.14786771824570927
Bond Position:  [5.10226008]


portfolio before change:  [19.93908874]
curr_Stock_Price:  100.33421094769461
curr_Factors:  [100.33421095]
mat_Sqrt:  [[0.15]]
grads:  [-0.00459789]
Stock Position:  -0.0045978917372422
Bond Position:  [20.40041457]


portfolio before change:  [19.9394112]
curr_Stock_Price:  100.81872600877674
curr_Factors:  [100.81872601]
mat_Sqrt:  [[0.15]]
grads:  [0.11061004]
Stock Position:  0.11061004098713362
Bond Position:  [8.78784778]


portfolio before change:  [19.84698707]
curr_Stock_Price:  99.97320889471315
curr_Factors:  [99.97320889]
mat_Sqrt:  [[0.15]]
grads:  [0.099014]
Stock Position:  0.0990139974656449
Bond Position:  [9.94824001]


portfolio before change:  [19.95632626]
curr_Stock_Price:  101.06492917979037
curr_Factors:  [101.06492918]
mat_Sqrt:  [[0.15]]
grads:  [0.14479781]
Stock Position:  0.14479781235880332
Bond Position:  [5.32234561]


portfolio before change:  [19.84662472]
curr_Stock_Price:  100.30271547422134
curr_Factors:  [100.30271547]
mat_Sqrt:  [[0.15]]
grads:  [-0.01975685]
Stock Position:  -0.01975685361200885
Bond Position:  [21.82829079]


portfolio before change:  [19.85899451]
curr_Stock_Price:  99.81472859777726
curr_Factors:  [99.8147286]
mat_Sqrt:  [[0.15]]
grads:  [0.07867545]
Stock Position:  0.07867544663582435
Bond Position:  [12.00602616]


portfolio before change:  [19.94642414]
curr_Stock_Price:  100.90692173074909
curr_Factors:  [100.90692173]
mat_Sqrt:  [[0.15]]
grads:  [0.05503416]
Stock Position:  0.055034160757929246
Bond Position:  [14.39309639]


portfolio before change:  [19.9789342]
curr_Stock_Price:  101.46495342555474
curr_Factors:  [101.46495343]
mat_Sqrt:  [[0.15]]
grads:  [0.16341578]
Stock Position:  0.16341578019294642
Bond Position:  [3.39795967]


portfolio before change:  [19.91687682]
curr_Stock_Price:  101.0826026298167
curr_Factors:  [101.08260263]
mat_Sqrt:  [[0.15]]
grads:  [0.06694554]
Stock Position:  0.06694553924580314
Bond Position:  [13.14984747]


portfolio before change:  [19.9644719]
curr_Stock_Price:  101.76900015778237
curr_Factors:  [101.76900016]
mat_Sqrt:  [[0.15]]
grads:  [-0.07667663]
Stock Position:  -0.07667663329484017
Bond Position:  [27.76777621]


portfolio before change:  [19.99814093]
curr_Stock_Price:  101.37516654492286
curr_Factors:  [101.37516654]
mat_Sqrt:  [[0.15]]
grads:  [0.07807542]
Stock Position:  0.0780754229855085
Bond Position:  [12.08323192]


portfolio before change:  [20.10705343]
curr_Stock_Price:  102.75078511861487
curr_Factors:  [102.75078512]
mat_Sqrt:  [[0.15]]
grads:  [-0.01440666]
Stock Position:  -0.014406660431340932
Bond Position:  [21.5873491]


portfolio before change:  [20.08722491]
curr_Stock_Price:  104.31444431658208
curr_Factors:  [104.31444432]
mat_Sqrt:  [[0.15]]
grads:  [-0.20378085]
Stock Position:  -0.20378085097374402
Bond Position:  [41.34451114]


portfolio before change:  [20.15331109]
curr_Stock_Price:  104.01550651117783
curr_Factors:  [104.01550651]
mat_Sqrt:  [[0.15]]
grads:  [0.03270988]
Stock Position:  0.03270988059294306
Bond Position:  [16.7509763]


portfolio before change:  [20.1714707]
curr_Stock_Price:  104.50666090565093
curr_Factors:  [104.50666091]
mat_Sqrt:  [[0.15]]
grads:  [-0.05081412]
Stock Position:  -0.05081412142861649
Bond Position:  [25.48188486]


portfolio before change:  [20.17791107]
curr_Stock_Price:  104.44260521661175
curr_Factors:  [104.44260522]
mat_Sqrt:  [[0.15]]
grads:  [0.03766319]
Stock Position:  0.0376631881487398
Bond Position:  [16.24426958]


portfolio before change:  [20.20718102]
curr_Stock_Price:  105.1658390129626
curr_Factors:  [105.16583901]
mat_Sqrt:  [[0.15]]
grads:  [-0.02584251]
Stock Position:  -0.025842511042292265
Bond Position:  [22.92493037]


portfolio before change:  [20.1858022]
curr_Stock_Price:  106.10400700063414
curr_Factors:  [106.104007]
mat_Sqrt:  [[0.15]]
grads:  [-0.01773158]
Stock Position:  -0.017731579172057886
Bond Position:  [22.0671938]


portfolio before change:  [20.1934723]
curr_Stock_Price:  105.82701381475248
curr_Factors:  [105.82701381]
mat_Sqrt:  [[0.15]]
grads:  [-0.26250783]
Stock Position:  -0.26250782682062107
Bond Position:  [47.97389171]


portfolio before change:  [20.09490496]
curr_Stock_Price:  106.2253426954111
curr_Factors:  [106.2253427]
mat_Sqrt:  [[0.15]]
grads:  [0.03224355]
Stock Position:  0.0322435467067207
Bond Position:  [16.66982316]


portfolio before change:  [20.09019039]
curr_Stock_Price:  106.01449671390375
curr_Factors:  [106.01449671]
mat_Sqrt:  [[0.15]]
grads:  [0.07959009]
Stock Position:  0.0795900935880706
Bond Position:  [11.65248668]


portfolio before change:  [20.14221158]
curr_Stock_Price:  106.64980858772125
curr_Factors:  [106.64980859]
mat_Sqrt:  [[0.15]]
grads:  [-0.03928641]
Stock Position:  -0.039286407113543954
Bond Position:  [24.33209938]


portfolio before change:  [20.14021959]
curr_Stock_Price:  106.77793662317808
curr_Factors:  [106.77793662]
mat_Sqrt:  [[0.15]]
grads:  [0.10185687]
Stock Position:  0.10185687356692806
Bond Position:  [9.2641528]


portfolio before change:  [20.16648448]
curr_Stock_Price:  107.02442762772982
curr_Factors:  [107.02442763]
mat_Sqrt:  [[0.15]]
grads:  [-0.09802553]
Stock Position:  -0.09802553144305115
Bond Position:  [30.65761088]


portfolio before change:  [20.17566217]
curr_Stock_Price:  106.96989848462202
curr_Factors:  [106.96989848]
mat_Sqrt:  [[0.15]]
grads:  [0.06336981]
Stock Position:  0.06336981338624939
Bond Position:  [13.39699967]


portfolio before change:  [20.18897202]
curr_Stock_Price:  107.15350515561123
curr_Factors:  [107.15350516]
mat_Sqrt:  [[0.15]]
grads:  [0.45829128]
Stock Position:  0.45829127522124574
Bond Position:  [-28.9185445]


portfolio before change:  [19.68131926]
curr_Stock_Price:  106.05368558276008
curr_Factors:  [106.05368558]
mat_Sqrt:  [[0.15]]
grads:  [0.1767776]
Stock Position:  0.17677760461945372
Bond Position:  [0.93340277]


portfolio before change:  [19.63174715]
curr_Stock_Price:  105.77260475593313
curr_Factors:  [105.77260476]
mat_Sqrt:  [[0.15]]
grads:  [-0.16347599]
Stock Position:  -0.16347599243432395
Bond Position:  [36.92302869]


portfolio before change:  [19.74488933]
curr_Stock_Price:  105.1087365375658
curr_Factors:  [105.10873654]
mat_Sqrt:  [[0.15]]
grads:  [0.04196629]
Stock Position:  0.04196629341138414
Bond Position:  [15.33386526]


portfolio before change:  [19.71617565]
curr_Stock_Price:  104.37885217815061
curr_Factors:  [104.37885218]
mat_Sqrt:  [[0.15]]
grads:  [-0.08677662]
Stock Position:  -0.08677661869580978
Bond Position:  [28.7738195]


portfolio before change:  [19.62080547]
curr_Stock_Price:  105.5193336786613
curr_Factors:  [105.51933368]
mat_Sqrt:  [[0.15]]
grads:  [0.01882403]
Stock Position:  0.018824026651127618
Bond Position:  [17.63450672]


portfolio before change:  [19.61424928]
curr_Stock_Price:  105.05393710961268
curr_Factors:  [105.05393711]
mat_Sqrt:  [[0.15]]
grads:  [-0.04184072]
Stock Position:  -0.04184072047997202
Bond Position:  [24.0097817]


portfolio before change:  [19.61767608]
curr_Stock_Price:  105.0437702314064
curr_Factors:  [105.04377023]
mat_Sqrt:  [[0.15]]
grads:  [0.01011586]
Stock Position:  0.010115856709735905
Bond Position:  [18.55506836]


portfolio before change:  [19.62657519]
curr_Stock_Price:  105.69419287469478
curr_Factors:  [105.69419287]
mat_Sqrt:  [[0.15]]
grads:  [0.16202224]
Stock Position:  0.16202223829188528
Bond Position:  [2.50176549]


portfolio before change:  [19.6905351]
curr_Stock_Price:  106.0870226878241
curr_Factors:  [106.08702269]
mat_Sqrt:  [[0.15]]
grads:  [0.03222325]
Stock Position:  0.03222324924101986
Bond Position:  [16.27206653]


portfolio before change:  [19.73977783]
curr_Stock_Price:  107.55207028199763
curr_Factors:  [107.55207028]
mat_Sqrt:  [[0.15]]
grads:  [0.1242809]
Stock Position:  0.12428089870365483
Bond Position:  [6.37310988]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [19.73977783]
Stock Price:  107.3387539988039
PL:  [12.40102383]
Settle:  Tensor("sub_362:0", shape=(), dtype=float64)
PL:  Tensor("sub_363:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  182
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.57008839e-03]
 [-1.47631141e-03]
 [-2.42958068e-02]
 [-2.72485350e-02]
 [ 1.23229614e-02]
 [ 1.98324170e-02]
 [ 2.64876750e-02]
 [-3.13482345e-03]
 [ 3.15211084e-03]
 [ 4.15188278e-03]
 [ 1.75321353e-02]
 [ 1.03604381e-02]
 [-1.03622464e-02]
 [ 1.27854121e-02]
 [-7.39283608e-03]
 [-2.77934031e-02]
 [ 4.65917301e-03]
 [-3.39291119e-03]
 [-1.16098840e-02]
 [-2.26322114e-03]
 [ 4.07563562e-04]
 [ 9.87265679e-03]
 [ 4.77142347e-03]
 [ 6.60956045e-03]
 [-4.24899696e-03]
 [-9.11389992e-03]
 [ 8.21933654e-03]
 [-1.94691908e-02]
 [-1.62173059e-02]
 [ 2.18690174e-02]
 [ 2.63560039e-03]
 [ 6.47382097e-03]
 [-1.27135338e-02]
 [-5.05563117e-03]
 [-5.44865020e-03]
 [-6.20629419e-03]
 [ 2.31973367e-02]
 [ 1.03750249e-03]
 [ 2.19049993e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.17819138]
curr_Stock_Price:  100.40188060643848
curr_Factors:  [100.40188061]
mat_Sqrt:  [[0.15]]
grads:  [-0.01046726]
Stock Position:  -0.010467255938258499
Bond Position:  [9.22912356]


portfolio before change:  [8.18586633]
curr_Stock_Price:  99.77886728734393
curr_Factors:  [99.77886729]
mat_Sqrt:  [[0.15]]
grads:  [-0.00984208]
Stock Position:  -0.009842076087935425
Bond Position:  [9.16789753]


portfolio before change:  [8.19869652]
curr_Stock_Price:  98.59170576621128
curr_Factors:  [98.59170577]
mat_Sqrt:  [[0.15]]
grads:  [-0.16197205]
Stock Position:  -0.1619720452973362
Bond Position:  [24.16779675]


portfolio before change:  [8.27959029]
curr_Stock_Price:  98.11092769701862
curr_Factors:  [98.1109277]
mat_Sqrt:  [[0.15]]
grads:  [-0.1816569]
Stock Position:  -0.18165690028910128
Bond Position:  [26.1021173]


portfolio before change:  [8.05117535]
curr_Stock_Price:  99.38628750784709
curr_Factors:  [99.38628751]
mat_Sqrt:  [[0.15]]
grads:  [0.08215308]
Stock Position:  0.08215307616640787
Bond Position:  [-0.1137139]


portfolio before change:  [8.02466571]
curr_Stock_Price:  99.06377467542596
curr_Factors:  [99.06377468]
mat_Sqrt:  [[0.15]]
grads:  [0.13221611]
Stock Position:  0.1322161130336594
Bond Position:  [-5.07316152]


portfolio before change:  [8.11040951]
curr_Stock_Price:  99.71708370314808
curr_Factors:  [99.7170837]
mat_Sqrt:  [[0.15]]
grads:  [0.1765845]
Stock Position:  0.1765845002972349
Bond Position:  [-9.49808189]


portfolio before change:  [8.15353523]
curr_Stock_Price:  99.96802901690472
curr_Factors:  [99.96802902]
mat_Sqrt:  [[0.15]]
grads:  [-0.02089882]
Stock Position:  -0.020898823017538367
Bond Position:  [10.24274937]


portfolio before change:  [8.13653912]
curr_Stock_Price:  100.84255357065808
curr_Factors:  [100.84255357]
mat_Sqrt:  [[0.15]]
grads:  [0.02101407]
Stock Position:  0.021014072299872084
Bond Position:  [6.01742641]


portfolio before change:  [8.13024354]
curr_Stock_Price:  100.50716876013581
curr_Factors:  [100.50716876]
mat_Sqrt:  [[0.15]]
grads:  [0.02767922]
Stock Position:  0.027679218547705782
Bond Position:  [5.34828365]


portfolio before change:  [8.13996126]
curr_Stock_Price:  100.83409792871504
curr_Factors:  [100.83409793]
mat_Sqrt:  [[0.15]]
grads:  [0.1168809]
Stock Position:  0.1168809019617889
Bond Position:  [-3.64561905]


portfolio before change:  [8.18050144]
curr_Stock_Price:  101.18484732464304
curr_Factors:  [101.18484732]
mat_Sqrt:  [[0.15]]
grads:  [0.06906959]
Stock Position:  0.06906958725990028
Bond Position:  [1.1917058]


portfolio before change:  [8.15781775]
curr_Stock_Price:  100.85427254282736
curr_Factors:  [100.85427254]
mat_Sqrt:  [[0.15]]
grads:  [-0.06908164]
Stock Position:  -0.06908164255730138
Bond Position:  [15.12499655]


portfolio before change:  [8.18314809]
curr_Stock_Price:  100.5149696579551
curr_Factors:  [100.51496966]
mat_Sqrt:  [[0.15]]
grads:  [0.08523608]
Stock Position:  0.08523608083155959
Bond Position:  [-0.38435399]


portfolio before change:  [8.23460322]
curr_Stock_Price:  101.11921111200604
curr_Factors:  [101.11921111]
mat_Sqrt:  [[0.15]]
grads:  [-0.04928557]
Stock Position:  -0.049285573847864035
Bond Position:  [13.21832156]


portfolio before change:  [8.2325891]
curr_Stock_Price:  101.1936043031826
curr_Factors:  [101.1936043]
mat_Sqrt:  [[0.15]]
grads:  [-0.18528935]
Stock Position:  -0.1852893539547992
Bond Position:  [26.98268666]


portfolio before change:  [8.29453662]
curr_Stock_Price:  100.87747994914831
curr_Factors:  [100.87747995]
mat_Sqrt:  [[0.15]]
grads:  [0.03106115]
Stock Position:  0.031061153385890546
Bond Position:  [5.16116574]


portfolio before change:  [8.27408531]
curr_Stock_Price:  100.19828757630248
curr_Factors:  [100.19828758]
mat_Sqrt:  [[0.15]]
grads:  [-0.02261941]
Stock Position:  -0.022619407937317277
Bond Position:  [10.54051125]


portfolio before change:  [8.27031646]
curr_Stock_Price:  100.4231608047281
curr_Factors:  [100.4231608]
mat_Sqrt:  [[0.15]]
grads:  [-0.07739923]
Stock Position:  -0.07739922646445227
Bond Position:  [16.04299142]


portfolio before change:  [8.29487714]
curr_Stock_Price:  100.13174722134652
curr_Factors:  [100.13174722]
mat_Sqrt:  [[0.15]]
grads:  [-0.01508814]
Stock Position:  -0.01508814092955142
Bond Position:  [9.80567906]


portfolio before change:  [8.29835068]
curr_Stock_Price:  99.98277283345548
curr_Factors:  [99.98277283]
mat_Sqrt:  [[0.15]]
grads:  [0.00271709]
Stock Position:  0.0027170904112475153
Bond Position:  [8.02668844]


portfolio before change:  [8.30017862]
curr_Stock_Price:  100.286238093359
curr_Factors:  [100.28623809]
mat_Sqrt:  [[0.15]]
grads:  [0.06581771]
Stock Position:  0.06581771195823495
Bond Position:  [1.69956788]


portfolio before change:  [8.28820703]
curr_Stock_Price:  100.10112012693006
curr_Factors:  [100.10112013]
mat_Sqrt:  [[0.15]]
grads:  [0.03180949]
Stock Position:  0.03180948981255666
Bond Position:  [5.10404147]


portfolio before change:  [8.29351889]
curr_Stock_Price:  100.24805133900149
curr_Factors:  [100.24805134]
mat_Sqrt:  [[0.15]]
grads:  [0.04406374]
Stock Position:  0.04406373636168693
Bond Position:  [3.87621518]


portfolio before change:  [8.30470014]
curr_Stock_Price:  100.49080631969713
curr_Factors:  [100.49080632]
mat_Sqrt:  [[0.15]]
grads:  [-0.02832665]
Stock Position:  -0.028326646405463115
Bond Position:  [11.15126767]


portfolio before change:  [8.29957119]
curr_Stock_Price:  100.72108214214641
curr_Factors:  [100.72108214]
mat_Sqrt:  [[0.15]]
grads:  [-0.06075933]
Stock Position:  -0.060759332830577474
Bond Position:  [14.41931694]


portfolio before change:  [8.28719646]
curr_Stock_Price:  100.95441683944634
curr_Factors:  [100.95441684]
mat_Sqrt:  [[0.15]]
grads:  [0.05479558]
Stock Position:  0.054795576963686914
Bond Position:  [2.75534094]


portfolio before change:  [8.29017577]
curr_Stock_Price:  101.00250234801676
curr_Factors:  [101.00250235]
mat_Sqrt:  [[0.15]]
grads:  [-0.12979461]
Stock Position:  -0.1297946052111306
Bond Position:  [21.39975569]


portfolio before change:  [8.31193082]
curr_Stock_Price:  100.8555015333091
curr_Factors:  [100.85550153]
mat_Sqrt:  [[0.15]]
grads:  [-0.10811537]
Stock Position:  -0.10811537248233158
Bond Position:  [19.21596093]


portfolio before change:  [8.31208038]
curr_Stock_Price:  100.87633656760038
curr_Factors:  [100.87633657]
mat_Sqrt:  [[0.15]]
grads:  [0.14579345]
Stock Position:  0.1457934493986459
Bond Position:  [-6.3950287]


portfolio before change:  [8.43140813]
curr_Stock_Price:  101.70029119563388
curr_Factors:  [101.7002912]
mat_Sqrt:  [[0.15]]
grads:  [0.01757067]
Stock Position:  0.017570669284659255
Bond Position:  [6.64446595]


portfolio before change:  [8.43292972]
curr_Stock_Price:  101.73961644097572
curr_Factors:  [101.73961644]
mat_Sqrt:  [[0.15]]
grads:  [0.04315881]
Stock Position:  0.04315880644111997
Bond Position:  [4.0419693]


portfolio before change:  [8.45597919]
curr_Stock_Price:  102.26197106356324
curr_Factors:  [102.26197106]
mat_Sqrt:  [[0.15]]
grads:  [-0.08475689]
Stock Position:  -0.08475689221897872
Bond Position:  [17.12338605]


portfolio before change:  [8.44701223]
curr_Stock_Price:  102.39302263255068
curr_Factors:  [102.39302263]
mat_Sqrt:  [[0.15]]
grads:  [-0.03370421]
Stock Position:  -0.033704207808228005
Bond Position:  [11.89808794]


portfolio before change:  [8.47027911]
curr_Stock_Price:  101.74682652784963
curr_Factors:  [101.74682653]
mat_Sqrt:  [[0.15]]
grads:  [-0.03632433]
Stock Position:  -0.0363243346710565
Bond Position:  [12.16616489]


portfolio before change:  [8.48601881]
curr_Stock_Price:  101.35538542271394
curr_Factors:  [101.35538542]
mat_Sqrt:  [[0.15]]
grads:  [-0.04137529]
Stock Position:  -0.04137529461602493
Bond Position:  [12.67962775]


portfolio before change:  [8.46234472]
curr_Stock_Price:  101.96587412135543
curr_Factors:  [101.96587412]
mat_Sqrt:  [[0.15]]
grads:  [0.15464891]
Stock Position:  0.15464891164968222
Bond Position:  [-7.30656674]


portfolio before change:  [8.4980345]
curr_Stock_Price:  102.20255966284908
curr_Factors:  [102.20255966]
mat_Sqrt:  [[0.15]]
grads:  [0.00691668]
Stock Position:  0.006916683255973087
Bond Position:  [7.79113177]


portfolio before change:  [8.50143791]
curr_Stock_Price:  102.5538061811558
curr_Factors:  [102.55380618]
mat_Sqrt:  [[0.15]]
grads:  [0.14603333]
Stock Position:  0.1460333288989093
Bond Position:  [-6.4748358]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [8.50143791]
Stock Price:  102.09672804054584
PL:  [6.40470987]
Settle:  Tensor("sub_364:0", shape=(), dtype=float64)
PL:  Tensor("sub_365:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  183
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.74033420e-03]
 [-6.05115653e-03]
 [-2.40087873e-02]
 [-2.72057108e-02]
 [ 1.51470992e-02]
 [ 2.22082436e-02]
 [ 1.83264297e-02]
 [-3.01346689e-03]
 [ 3.01360849e-03]
 [ 2.52394166e-03]
 [ 4.50750309e-03]
 [ 1.08691331e-02]
 [-1.12856291e-02]
 [ 1.17515331e-02]
 [-7.33686765e-03]
 [-2.64204720e-02]
 [ 4.11789160e-03]
 [ 2.82762663e-04]
 [-2.02190609e-03]
 [-2.43795209e-03]
 [-7.99218372e-04]
 [-3.45853865e-02]
 [ 4.81680330e-03]
 [ 1.03472832e-02]
 [-5.59174559e-03]
 [ 2.82346472e-03]
 [-7.00298496e-03]
 [ 2.39457365e-03]
 [ 6.36831014e-02]
 [ 2.67626857e-02]
 [-3.16172801e-02]
 [ 4.77609753e-03]
 [-1.31359685e-02]
 [ 2.43226428e-03]
 [-6.13755771e-03]
 [ 1.33281023e-03]
 [ 2.37694909e-02]
 [ 1.64420702e-03]
 [ 1.97353813e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-5.83986674]
curr_Stock_Price:  99.49880827749473
curr_Factors:  [99.49880828]
mat_Sqrt:  [[0.15]]
grads:  [-0.02493556]
Stock Position:  -0.024935561366266967
Bond Position:  [-3.3588081]


portfolio before change:  [-5.81485194]
curr_Stock_Price:  98.47879209521818
curr_Factors:  [98.4787921]
mat_Sqrt:  [[0.15]]
grads:  [-0.04034104]
Stock Position:  -0.04034104355753626
Bond Position:  [-1.84211469]


portfolio before change:  [-5.82016096]
curr_Stock_Price:  98.60468731058593
curr_Factors:  [98.60468731]
mat_Sqrt:  [[0.15]]
grads:  [-0.16005858]
Stock Position:  -0.16005858173302537
Bond Position:  [9.96236544]


portfolio before change:  [-5.74187138]
curr_Stock_Price:  98.12333724619299
curr_Factors:  [98.12333725]
mat_Sqrt:  [[0.15]]
grads:  [-0.18137141]
Stock Position:  -0.1813714053506812
Bond Position:  [12.0548962]


portfolio before change:  [-5.78430065]
curr_Stock_Price:  98.36558178300179
curr_Factors:  [98.36558178]
mat_Sqrt:  [[0.15]]
grads:  [0.10098066]
Stock Position:  0.10098066127993494
Bond Position:  [-15.71732215]


portfolio before change:  [-5.76393024]
curr_Stock_Price:  98.58676473111196
curr_Factors:  [98.58676473]
mat_Sqrt:  [[0.15]]
grads:  [0.14805496]
Stock Position:  0.1480549571986594
Bond Position:  [-20.36018947]


portfolio before change:  [-5.71314593]
curr_Stock_Price:  98.94696541409124
curr_Factors:  [98.94696541]
mat_Sqrt:  [[0.15]]
grads:  [0.1221762]
Stock Position:  0.12217619822382203
Bond Position:  [-17.80210999]


portfolio before change:  [-5.55555321]
curr_Stock_Price:  100.25506078621922
curr_Factors:  [100.25506079]
mat_Sqrt:  [[0.15]]
grads:  [-0.02008978]
Stock Position:  -0.02008977927832807
Bond Position:  [-3.54145117]


portfolio before change:  [-5.57349616]
curr_Stock_Price:  101.12616233428331
curr_Factors:  [101.12616233]
mat_Sqrt:  [[0.15]]
grads:  [0.02009072]
Stock Position:  0.02009072327918021
Bond Position:  [-7.6051939]


portfolio before change:  [-5.59006928]
curr_Stock_Price:  100.34856870553531
curr_Factors:  [100.34856871]
mat_Sqrt:  [[0.15]]
grads:  [0.01682628]
Stock Position:  0.0168262777390878
Bond Position:  [-7.27856217]


portfolio before change:  [-5.60005663]
curr_Stock_Price:  99.80908673468872
curr_Factors:  [99.80908673]
mat_Sqrt:  [[0.15]]
grads:  [0.03005002]
Stock Position:  0.03005002062135255
Bond Position:  [-8.59932175]


portfolio before change:  [-5.57608041]
curr_Stock_Price:  100.64273695720759
curr_Factors:  [100.64273696]
mat_Sqrt:  [[0.15]]
grads:  [0.07246089]
Stock Position:  0.07246088739526331
Bond Position:  [-12.86874244]


portfolio before change:  [-5.51474074]
curr_Stock_Price:  101.51145896474188
curr_Factors:  [101.51145896]
mat_Sqrt:  [[0.15]]
grads:  [-0.07523753]
Stock Position:  -0.07523752728213091
Bond Position:  [2.12273043]


portfolio before change:  [-5.47466669]
curr_Stock_Price:  100.98235215234868
curr_Factors:  [100.98235215]
mat_Sqrt:  [[0.15]]
grads:  [0.07834355]
Stock Position:  0.07834355397340352
Bond Position:  [-13.38598305]


portfolio before change:  [-5.47381499]
curr_Stock_Price:  101.01458268151927
curr_Factors:  [101.01458268]
mat_Sqrt:  [[0.15]]
grads:  [-0.04891245]
Stock Position:  -0.048912451028070986
Bond Position:  [-0.53294416]


portfolio before change:  [-5.53862953]
curr_Stock_Price:  102.33833403462233
curr_Factors:  [102.33833403]
mat_Sqrt:  [[0.15]]
grads:  [-0.17613648]
Stock Position:  -0.1761364796856858
Bond Position:  [12.48688436]


portfolio before change:  [-5.54164867]
curr_Stock_Price:  102.3643371358385
curr_Factors:  [102.36433714]
mat_Sqrt:  [[0.15]]
grads:  [0.02745261]
Stock Position:  0.02745261063859996
Bond Position:  [-8.35181696]


portfolio before change:  [-5.53674981]
curr_Stock_Price:  102.5808156035698
curr_Factors:  [102.5808156]
mat_Sqrt:  [[0.15]]
grads:  [0.00188508]
Stock Position:  0.0018850844197604362
Bond Position:  [-5.73012331]


portfolio before change:  [-5.5371238]
curr_Stock_Price:  102.76241165909282
curr_Factors:  [102.76241166]
mat_Sqrt:  [[0.15]]
grads:  [-0.01347937]
Stock Position:  -0.013479373937882016
Bond Position:  [-4.15195083]


portfolio before change:  [-5.52728599]
curr_Stock_Price:  101.99406460828325
curr_Factors:  [101.99406461]
mat_Sqrt:  [[0.15]]
grads:  [-0.01625301]
Stock Position:  -0.01625301394209288
Bond Position:  [-3.86957504]


portfolio before change:  [-5.53503851]
curr_Stock_Price:  102.44129226008162
curr_Factors:  [102.44129226]
mat_Sqrt:  [[0.15]]
grads:  [-0.00532812]
Stock Position:  -0.00532812247977079
Bond Position:  [-4.98921876]


portfolio before change:  [-5.54028244]
curr_Stock_Price:  103.30843439444862
curr_Factors:  [103.30843439]
mat_Sqrt:  [[0.15]]
grads:  [-0.23056924]
Stock Position:  -0.23056924338183207
Bond Position:  [18.27946511]


portfolio before change:  [-5.7818767]
curr_Stock_Price:  104.36616146064088
curr_Factors:  [104.36616146]
mat_Sqrt:  [[0.15]]
grads:  [0.03211202]
Stock Position:  0.032112022015109654
Bond Position:  [-9.13328517]


portfolio before change:  [-5.77534977]
curr_Stock_Price:  104.60497093695557
curr_Factors:  [104.60497094]
mat_Sqrt:  [[0.15]]
grads:  [0.06898189]
Stock Position:  0.06898188825378153
Bond Position:  [-12.99119819]


portfolio before change:  [-5.73032065]
curr_Stock_Price:  105.28128077370151
curr_Factors:  [105.28128077]
mat_Sqrt:  [[0.15]]
grads:  [-0.0372783]
Stock Position:  -0.03727830395283341
Bond Position:  [-1.80561306]


portfolio before change:  [-5.69447791]
curr_Stock_Price:  104.3137354365645
curr_Factors:  [104.31373544]
mat_Sqrt:  [[0.15]]
grads:  [0.0188231]
Stock Position:  0.018823098136876982
Bond Position:  [-7.65798559]


portfolio before change:  [-5.69248978]
curr_Stock_Price:  104.47021554758403
curr_Factors:  [104.47021555]
mat_Sqrt:  [[0.15]]
grads:  [-0.04668657]
Stock Position:  -0.04668656642038869
Bond Position:  [-0.81513412]


portfolio before change:  [-5.71717414]
curr_Stock_Price:  104.9967581094236
curr_Factors:  [104.99675811]
mat_Sqrt:  [[0.15]]
grads:  [0.01596382]
Stock Position:  0.015963824359879246
Bond Position:  [-7.39332395]


portfolio before change:  [-5.68930903]
curr_Stock_Price:  106.80016910075888
curr_Factors:  [106.8001691]
mat_Sqrt:  [[0.15]]
grads:  [0.42455401]
Stock Position:  0.42455400903726054
Bond Position:  [-51.03174899]


portfolio before change:  [-5.85205912]
curr_Stock_Price:  106.43185147323307
curr_Factors:  [106.43185147]
mat_Sqrt:  [[0.15]]
grads:  [0.1784179]
Stock Position:  0.17841790470641544
Bond Position:  [-24.84140706]


portfolio before change:  [-5.75071594]
curr_Stock_Price:  107.01726664956512
curr_Factors:  [107.01726665]
mat_Sqrt:  [[0.15]]
grads:  [-0.21078187]
Stock Position:  -0.21078186738201915
Bond Position:  [16.80658336]


portfolio before change:  [-5.64296717]
curr_Stock_Price:  106.51604790395753
curr_Factors:  [106.5160479]
mat_Sqrt:  [[0.15]]
grads:  [0.03184065]
Stock Position:  0.0318406501850618
Bond Position:  [-9.03450739]


portfolio before change:  [-5.66050847]
curr_Stock_Price:  106.00060861138198
curr_Factors:  [106.00060861]
mat_Sqrt:  [[0.15]]
grads:  [-0.08757312]
Stock Position:  -0.08757312355227628
Bond Position:  [3.62229592]


portfolio before change:  [-5.59560094]
curr_Stock_Price:  105.26459839737198
curr_Factors:  [105.2645984]
mat_Sqrt:  [[0.15]]
grads:  [0.0162151]
Stock Position:  0.016215095226280223
Bond Position:  [-7.30247643]


portfolio before change:  [-5.60563272]
curr_Stock_Price:  104.70222681454294
curr_Factors:  [104.70222681]
mat_Sqrt:  [[0.15]]
grads:  [-0.04091705]
Stock Position:  -0.04091705140827972
Bond Position:  [-1.32152632]


portfolio before change:  [-5.61599065]
curr_Stock_Price:  104.95133406905119
curr_Factors:  [104.95133407]
mat_Sqrt:  [[0.15]]
grads:  [0.0088854]
Stock Position:  0.008885401541177465
Bond Position:  [-6.5485254]


portfolio before change:  [-5.62661867]
curr_Stock_Price:  103.84734358154974
curr_Factors:  [103.84734358]
mat_Sqrt:  [[0.15]]
grads:  [0.15846327]
Stock Position:  0.1584632726487787
Bond Position:  [-22.08260859]


portfolio before change:  [-5.49061748]
curr_Stock_Price:  104.72301457935379
curr_Factors:  [104.72301458]
mat_Sqrt:  [[0.15]]
grads:  [0.01096138]
Stock Position:  0.010961380126084693
Bond Position:  [-6.63852625]


portfolio before change:  [-5.48066524]
curr_Stock_Price:  105.70665890450529
curr_Factors:  [105.7066589]
mat_Sqrt:  [[0.15]]
grads:  [0.13156921]
Stock Position:  0.13156920895395938
Bond Position:  [-19.38840674]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-5.48066524]
Stock Price:  105.60979650357638
PL:  [-11.09046175]
Settle:  Tensor("sub_366:0", shape=(), dtype=float64)
PL:  Tensor("sub_367:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  184
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.96734927e-03]
 [-6.98046946e-03]
 [ 1.23233179e-02]
 [-1.75499861e-02]
 [ 1.44120115e-02]
 [ 2.30908980e-02]
 [ 1.74807872e-03]
 [-7.39162738e-03]
 [ 1.03823141e-02]
 [-2.20740987e-04]
 [ 1.00576803e-02]
 [ 1.12122148e-02]
 [-7.59057278e-03]
 [ 1.22958699e-02]
 [-4.44665965e-03]
 [-1.17093718e-02]
 [ 4.74313817e-03]
 [-2.50063162e-03]
 [-1.16801433e-02]
 [-2.28409340e-03]
 [ 4.06338429e-04]
 [ 9.95158598e-03]
 [ 4.77411536e-03]
 [ 6.99038025e-03]
 [-3.57078306e-03]
 [-8.93098002e-03]
 [ 7.61907039e-03]
 [-2.39770685e-02]
 [-2.15062590e-02]
 [ 2.17691846e-02]
 [ 3.85087343e-03]
 [-5.57906318e-03]
 [-1.25351571e-02]
 [-9.22847912e-03]
 [-7.93544702e-03]
 [-7.49300058e-03]
 [ 2.24578952e-02]
 [ 8.22747964e-03]
 [ 2.36019380e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [14.12712212]
curr_Stock_Price:  100.78512304255696
curr_Factors:  [100.78512304]
mat_Sqrt:  [[0.15]]
grads:  [-0.01311566]
Stock Position:  -0.013115661823535716
Bond Position:  [15.44898571]


portfolio before change:  [14.12802387]
curr_Stock_Price:  100.8636162439503
curr_Factors:  [100.86361624]
mat_Sqrt:  [[0.15]]
grads:  [-0.04653646]
Stock Position:  -0.04653646304235718
Bond Position:  [18.82185982]


portfolio before change:  [14.18233245]
curr_Stock_Price:  99.74716486550905
curr_Factors:  [99.74716487]
mat_Sqrt:  [[0.15]]
grads:  [0.08215545]
Stock Position:  0.08215545239457527
Bond Position:  [5.98755899]


portfolio before change:  [14.10557669]
curr_Stock_Price:  98.80377956043047
curr_Factors:  [98.80377956]
mat_Sqrt:  [[0.15]]
grads:  [-0.11699991]
Stock Position:  -0.11699990716898932
Bond Position:  [25.66560973]


portfolio before change:  [14.17051219]
curr_Stock_Price:  98.27619710282605
curr_Factors:  [98.2761971]
mat_Sqrt:  [[0.15]]
grads:  [0.09608008]
Stock Position:  0.09608007668145484
Bond Position:  [4.72812764]


portfolio before change:  [14.16287912]
curr_Stock_Price:  98.1906005446814
curr_Factors:  [98.19060054]
mat_Sqrt:  [[0.15]]
grads:  [0.15393932]
Stock Position:  0.15393932011532035
Bond Position:  [-0.95251517]


portfolio before change:  [13.95174267]
curr_Stock_Price:  96.81981767981678
curr_Factors:  [96.81981768]
mat_Sqrt:  [[0.15]]
grads:  [0.01165386]
Stock Position:  0.011653858110201622
Bond Position:  [12.82341825]


portfolio before change:  [13.96159045]
curr_Stock_Price:  97.5272877557906
curr_Factors:  [97.52728776]
mat_Sqrt:  [[0.15]]
grads:  [-0.04927752]
Stock Position:  -0.049277515851992484
Bond Position:  [18.76749292]


portfolio before change:  [13.94487352]
curr_Stock_Price:  97.91413800327697
curr_Factors:  [97.914138]
mat_Sqrt:  [[0.15]]
grads:  [0.06921543]
Stock Position:  0.06921542724126303
Bond Position:  [7.16770462]


portfolio before change:  [13.95951552]
curr_Stock_Price:  98.11273511918276
curr_Factors:  [98.11273512]
mat_Sqrt:  [[0.15]]
grads:  [-0.00147161]
Stock Position:  -0.0014716065808682093
Bond Position:  [14.10389887]


portfolio before change:  [13.95986666]
curr_Stock_Price:  99.07220148235218
curr_Factors:  [99.07220148]
mat_Sqrt:  [[0.15]]
grads:  [0.0670512]
Stock Position:  0.06705120174343343
Bond Position:  [7.31695649]


portfolio before change:  [14.01018671]
curr_Stock_Price:  99.8090320836389
curr_Factors:  [99.80903208]
mat_Sqrt:  [[0.15]]
grads:  [0.0747481]
Stock Position:  0.07474809854960891
Bond Position:  [6.54965135]


portfolio before change:  [14.00208817]
curr_Stock_Price:  99.68973404657082
curr_Factors:  [99.68973405]
mat_Sqrt:  [[0.15]]
grads:  [-0.05060382]
Stock Position:  -0.05060381855977489
Bond Position:  [19.04676938]


portfolio before change:  [13.95561881]
curr_Stock_Price:  100.6550832933421
curr_Factors:  [100.65508329]
mat_Sqrt:  [[0.15]]
grads:  [0.08197247]
Stock Position:  0.08197246601409618
Bond Position:  [5.70467341]


portfolio before change:  [13.87882025]
curr_Stock_Price:  99.7095013699286
curr_Factors:  [99.70950137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0296444]
Stock Position:  -0.029644397641471403
Bond Position:  [16.83464836]


portfolio before change:  [13.88407882]
curr_Stock_Price:  99.60310327351732
curr_Factors:  [99.60310327]
mat_Sqrt:  [[0.15]]
grads:  [-0.07806248]
Stock Position:  -0.07806247898540904
Bond Position:  [21.65934398]


portfolio before change:  [13.82353304]
curr_Stock_Price:  100.41339483954022
curr_Factors:  [100.41339484]
mat_Sqrt:  [[0.15]]
grads:  [0.03162092]
Stock Position:  0.03162092113471483
Bond Position:  [10.648369]


portfolio before change:  [13.83203628]
curr_Stock_Price:  100.64021026003839
curr_Factors:  [100.64021026]
mat_Sqrt:  [[0.15]]
grads:  [-0.01667088]
Stock Position:  -0.016670877489501044
Bond Position:  [15.5097969]


portfolio before change:  [13.83605558]
curr_Stock_Price:  100.51541478155008
curr_Factors:  [100.51541478]
mat_Sqrt:  [[0.15]]
grads:  [-0.07786762]
Stock Position:  -0.07786762173011816
Bond Position:  [21.66295188]


portfolio before change:  [13.92289491]
curr_Stock_Price:  99.43497487054542
curr_Factors:  [99.43497487]
mat_Sqrt:  [[0.15]]
grads:  [-0.01522729]
Stock Position:  -0.015227289365504175
Bond Position:  [15.43702004]


portfolio before change:  [13.91663007]
curr_Stock_Price:  99.97312576400167
curr_Factors:  [99.97312576]
mat_Sqrt:  [[0.15]]
grads:  [0.00270892]
Stock Position:  0.00270892285714724
Bond Position:  [13.64581059]


portfolio before change:  [13.91683663]
curr_Stock_Price:  99.41966775134415
curr_Factors:  [99.41966775]
mat_Sqrt:  [[0.15]]
grads:  [0.06634391]
Stock Position:  0.06634390650590945
Bond Position:  [7.32094749]


portfolio before change:  [13.97954355]
curr_Stock_Price:  100.35105309007345
curr_Factors:  [100.35105309]
mat_Sqrt:  [[0.15]]
grads:  [0.03182744]
Stock Position:  0.03182743576273314
Bond Position:  [10.78562685]


portfolio before change:  [13.99445158]
curr_Stock_Price:  100.77709264952597
curr_Factors:  [100.77709265]
mat_Sqrt:  [[0.15]]
grads:  [0.04660254]
Stock Position:  0.04660253500406715
Bond Position:  [9.2979836]


portfolio before change:  [14.00135344]
curr_Stock_Price:  100.90025184949118
curr_Factors:  [100.90025185]
mat_Sqrt:  [[0.15]]
grads:  [-0.02380522]
Stock Position:  -0.02380522042638033
Bond Position:  [16.40330617]


portfolio before change:  [14.01610715]
curr_Stock_Price:  100.36662191428158
curr_Factors:  [100.36662191]
mat_Sqrt:  [[0.15]]
grads:  [-0.05953987]
Stock Position:  -0.05953986679741998
Bond Position:  [19.99192245]


portfolio before change:  [13.97614567]
curr_Stock_Price:  101.07976811801628
curr_Factors:  [101.07976812]
mat_Sqrt:  [[0.15]]
grads:  [0.0507938]
Stock Position:  0.05079380256819
Bond Position:  [8.84191989]


portfolio before change:  [13.92383479]
curr_Stock_Price:  100.02813994099276
curr_Factors:  [100.02813994]
mat_Sqrt:  [[0.15]]
grads:  [-0.15984712]
Stock Position:  -0.15984712355274971
Bond Position:  [29.91304523]


portfolio before change:  [13.93092735]
curr_Stock_Price:  100.00716240668991
curr_Factors:  [100.00716241]
mat_Sqrt:  [[0.15]]
grads:  [-0.14337506]
Stock Position:  -0.1433750602102654
Bond Position:  [28.26946028]


portfolio before change:  [14.08160322]
curr_Stock_Price:  98.9808892771047
curr_Factors:  [98.98088928]
mat_Sqrt:  [[0.15]]
grads:  [0.1451279]
Stock Position:  0.14512789746443575
Bond Position:  [-0.28328513]


portfolio before change:  [13.93525934]
curr_Stock_Price:  97.97275455806245
curr_Factors:  [97.97275456]
mat_Sqrt:  [[0.15]]
grads:  [0.02567249]
Stock Position:  0.025672489564359944
Bond Position:  [11.42005482]


portfolio before change:  [13.91008858]
curr_Stock_Price:  96.93668988344614
curr_Factors:  [96.93668988]
mat_Sqrt:  [[0.15]]
grads:  [-0.03719375]
Stock Position:  -0.037193754501946646
Bond Position:  [17.51552802]


portfolio before change:  [13.91112612]
curr_Stock_Price:  96.96766386009536
curr_Factors:  [96.96766386]
mat_Sqrt:  [[0.15]]
grads:  [-0.08356771]
Stock Position:  -0.08356771379177458
Bond Position:  [22.0144921]


portfolio before change:  [13.83248987]
curr_Stock_Price:  97.94158341919919
curr_Factors:  [97.94158342]
mat_Sqrt:  [[0.15]]
grads:  [-0.06152319]
Stock Position:  -0.06152319412830276
Bond Position:  [19.85816892]


portfolio before change:  [13.72229249]
curr_Stock_Price:  99.77308463800719
curr_Factors:  [99.77308464]
mat_Sqrt:  [[0.15]]
grads:  [-0.05290298]
Stock Position:  -0.052902980114871295
Bond Position:  [19.000586]


portfolio before change:  [13.7387339]
curr_Stock_Price:  99.50719804479323
curr_Factors:  [99.50719804]
mat_Sqrt:  [[0.15]]
grads:  [-0.04995334]
Stock Position:  -0.049953337166785086
Bond Position:  [18.70945052]


portfolio before change:  [13.75238147]
curr_Stock_Price:  99.28081197712469
curr_Factors:  [99.28081198]
mat_Sqrt:  [[0.15]]
grads:  [0.1497193]
Stock Position:  0.14971930109218307
Bond Position:  [-1.11187231]


portfolio before change:  [13.67717374]
curr_Stock_Price:  98.77941546482587
curr_Factors:  [98.77941546]
mat_Sqrt:  [[0.15]]
grads:  [0.05484986]
Stock Position:  0.054849864262305925
Bond Position:  [8.25913621]


portfolio before change:  [13.72140573]
curr_Stock_Price:  99.5670113957639
curr_Factors:  [99.5670114]
mat_Sqrt:  [[0.15]]
grads:  [0.15734625]
Stock Position:  0.15734625364374125
Bond Position:  [-1.9450905]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [13.72140573]
Stock Price:  99.04910398393464
PL:  [13.72140573]
Settle:  Tensor("sub_368:0", shape=(), dtype=float64)
PL:  Tensor("sub_369:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  185
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.58569125e-03]
 [-1.46045111e-02]
 [-3.30877407e-03]
 [ 1.91688997e-02]
 [-2.96790918e-04]
 [ 2.81210932e-02]
 [ 2.21645365e-02]
 [-2.58324920e-03]
 [ 2.77008943e-03]
 [ 9.58052074e-03]
 [ 2.55731889e-02]
 [-8.27497250e-03]
 [-1.27018366e-02]
 [-4.96408475e-03]
 [ 2.25591948e-03]
 [-3.39418398e-02]
 [ 4.72237482e-03]
 [-1.10009265e-02]
 [ 1.04561954e-02]
 [-3.76234613e-03]
 [-2.74157474e-03]
 [-3.93868644e-02]
 [ 4.84256575e-03]
 [ 1.27579232e-02]
 [-5.87299337e-03]
 [ 1.08776877e-02]
 [-1.27222445e-02]
 [ 8.79601877e-03]
 [ 5.22196189e-02]
 [ 2.56216793e-02]
 [-1.40431176e-02]
 [ 6.39196473e-03]
 [-1.26160537e-02]
 [-3.36784780e-03]
 [-5.53106774e-03]
 [-3.79039543e-03]
 [ 2.30304840e-02]
 [ 6.57778485e-03]
 [ 2.38001684e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [8.51088827]
curr_Stock_Price:  100.42331362927091
curr_Factors:  [100.42331363]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057127]
Stock Position:  -0.01057127496903633
Bond Position:  [9.57249073]


portfolio before change:  [8.51498402]
curr_Stock_Price:  100.14906902149373
curr_Factors:  [100.14906902]
mat_Sqrt:  [[0.15]]
grads:  [-0.09736341]
Stock Position:  -0.09736340760525568
Bond Position:  [18.26583865]


portfolio before change:  [8.35978855]
curr_Stock_Price:  101.76650260706276
curr_Factors:  [101.76650261]
mat_Sqrt:  [[0.15]]
grads:  [-0.02205849]
Stock Position:  -0.022058493831287752
Bond Position:  [10.60460432]


portfolio before change:  [8.37643978]
curr_Stock_Price:  101.07173303797903
curr_Factors:  [101.07173304]
mat_Sqrt:  [[0.15]]
grads:  [0.12779266]
Stock Position:  0.1277926645876923
Bond Position:  [-4.5397863]


portfolio before change:  [8.48781983]
curr_Stock_Price:  101.9477423105699
curr_Factors:  [101.94774231]
mat_Sqrt:  [[0.15]]
grads:  [-0.00197861]
Stock Position:  -0.001978606122611954
Bond Position:  [8.68953425]


portfolio before change:  [8.4903512]
curr_Stock_Price:  101.21737416369865
curr_Factors:  [101.21737416]
mat_Sqrt:  [[0.15]]
grads:  [0.18747395]
Stock Position:  0.18747395486960164
Bond Position:  [-10.48527024]


portfolio before change:  [8.45466868]
curr_Stock_Price:  101.03403256150555
curr_Factors:  [101.03403256]
mat_Sqrt:  [[0.15]]
grads:  [0.14776358]
Stock Position:  0.14776357638914828
Bond Position:  [-6.47448131]


portfolio before change:  [8.39912769]
curr_Stock_Price:  100.66363253207707
curr_Factors:  [100.66363253]
mat_Sqrt:  [[0.15]]
grads:  [-0.01722166]
Stock Position:  -0.017221661353878922
Bond Position:  [10.13272268]


portfolio before change:  [8.39515456]
curr_Stock_Price:  100.9678885433086
curr_Factors:  [100.96788854]
mat_Sqrt:  [[0.15]]
grads:  [0.01846726]
Stock Position:  0.018467262850227584
Bond Position:  [6.53055403]


portfolio before change:  [8.40201355]
curr_Stock_Price:  101.29509559962125
curr_Factors:  [101.2950956]
mat_Sqrt:  [[0.15]]
grads:  [0.06387014]
Stock Position:  0.06387013825757627
Bond Position:  [1.93228179]


portfolio before change:  [8.4973856]
curr_Stock_Price:  102.784531770585
curr_Factors:  [102.78453177]
mat_Sqrt:  [[0.15]]
grads:  [0.17048793]
Stock Position:  0.1704879259064302
Bond Position:  [-9.02613604]


portfolio before change:  [8.68402211]
curr_Stock_Price:  103.88586989900128
curr_Factors:  [103.8858699]
mat_Sqrt:  [[0.15]]
grads:  [-0.05516648]
Stock Position:  -0.05516648331648327
Bond Position:  [14.41504022]


portfolio before change:  [8.68523784]
curr_Stock_Price:  103.8964970813472
curr_Factors:  [103.89649708]
mat_Sqrt:  [[0.15]]
grads:  [-0.08467891]
Stock Position:  -0.08467891059353756
Bond Position:  [17.48308003]


portfolio before change:  [8.62753802]
curr_Stock_Price:  104.60370198314845
curr_Factors:  [104.60370198]
mat_Sqrt:  [[0.15]]
grads:  [-0.0330939]
Stock Position:  -0.03309389834577611
Bond Position:  [12.0892823]


portfolio before change:  [8.63548638]
curr_Stock_Price:  104.40919168229395
curr_Factors:  [104.40919168]
mat_Sqrt:  [[0.15]]
grads:  [0.01503946]
Stock Position:  0.015039463213120687
Bond Position:  [7.06522818]


portfolio before change:  [8.65460034]
curr_Stock_Price:  105.62138596860714
curr_Factors:  [105.62138597]
mat_Sqrt:  [[0.15]]
grads:  [-0.22627893]
Stock Position:  -0.22627893190163617
Bond Position:  [32.55449474]


portfolio before change:  [8.39298871]
curr_Stock_Price:  106.79551737919257
curr_Factors:  [106.79551738]
mat_Sqrt:  [[0.15]]
grads:  [0.0314825]
Stock Position:  0.03148249879258651
Bond Position:  [5.03079896]


portfolio before change:  [8.35825979]
curr_Stock_Price:  105.67242344804825
curr_Factors:  [105.67242345]
mat_Sqrt:  [[0.15]]
grads:  [-0.07333951]
Stock Position:  -0.07333950998300301
Bond Position:  [16.10822355]


portfolio before change:  [8.3722577]
curr_Stock_Price:  105.50901557212104
curr_Factors:  [105.50901557]
mat_Sqrt:  [[0.15]]
grads:  [0.06970797]
Stock Position:  0.06970796938451244
Bond Position:  [1.01743847]


portfolio before change:  [8.33530605]
curr_Stock_Price:  104.97709878956276
curr_Factors:  [104.97709879]
mat_Sqrt:  [[0.15]]
grads:  [-0.02508231]
Stock Position:  -0.02508230754109912
Bond Position:  [10.96837392]


portfolio before change:  [8.30415154]
curr_Stock_Price:  106.27385493471884
curr_Factors:  [106.27385493]
mat_Sqrt:  [[0.15]]
grads:  [-0.01827716]
Stock Position:  -0.01827716490602756
Bond Position:  [10.24653632]


portfolio before change:  [8.3147968]
curr_Stock_Price:  105.76150224020286
curr_Factors:  [105.76150224]
mat_Sqrt:  [[0.15]]
grads:  [-0.2625791]
Stock Position:  -0.26257909615427655
Bond Position:  [36.08555646]


portfolio before change:  [8.04820927]
curr_Stock_Price:  106.79394734090125
curr_Factors:  [106.79394734]
mat_Sqrt:  [[0.15]]
grads:  [0.03228377]
Stock Position:  0.03228377169890977
Bond Position:  [4.60049786]


portfolio before change:  [8.0470536]
curr_Stock_Price:  106.74033629131257
curr_Factors:  [106.74033629]
mat_Sqrt:  [[0.15]]
grads:  [0.08505282]
Stock Position:  0.08505282112582271
Bond Position:  [-1.03151313]


portfolio before change:  [8.03201535]
curr_Stock_Price:  106.56504164407536
curr_Factors:  [106.56504164]
mat_Sqrt:  [[0.15]]
grads:  [-0.03915329]
Stock Position:  -0.03915328916079079
Bond Position:  [12.20438724]


portfolio before change:  [8.05944668]
curr_Stock_Price:  105.90339397694036
curr_Factors:  [105.90339398]
mat_Sqrt:  [[0.15]]
grads:  [0.07251792]
Stock Position:  0.07251791796011584
Bond Position:  [0.37955304]


portfolio before change:  [8.09312667]
curr_Stock_Price:  106.36717649156785
curr_Factors:  [106.36717649]
mat_Sqrt:  [[0.15]]
grads:  [-0.08481496]
Stock Position:  -0.08481496316142327
Bond Position:  [17.11465482]


portfolio before change:  [8.06248124]
curr_Stock_Price:  106.75372255225592
curr_Factors:  [106.75372255]
mat_Sqrt:  [[0.15]]
grads:  [0.05864013]
Stock Position:  0.05864012510023997
Bond Position:  [1.8024296]


portfolio before change:  [8.01849503]
curr_Stock_Price:  105.99977592085928
curr_Factors:  [105.99977592]
mat_Sqrt:  [[0.15]]
grads:  [0.34813079]
Stock Position:  0.3481307926932505
Bond Position:  [-28.88329098]


portfolio before change:  [7.56404227]
curr_Stock_Price:  104.70473928316444
curr_Factors:  [104.70473928]
mat_Sqrt:  [[0.15]]
grads:  [0.1708112]
Stock Position:  0.17081119534818118
Bond Position:  [-10.32069941]


portfolio before change:  [7.43121202]
curr_Stock_Price:  103.934648764295
curr_Factors:  [103.93464876]
mat_Sqrt:  [[0.15]]
grads:  [-0.09362078]
Stock Position:  -0.09362078376710455
Bond Position:  [17.16165529]


portfolio before change:  [7.52087293]
curr_Stock_Price:  102.99986094975539
curr_Factors:  [102.99986095]
mat_Sqrt:  [[0.15]]
grads:  [0.0426131]
Stock Position:  0.04261309822652885
Bond Position:  [3.13172973]


portfolio before change:  [7.4701863]
curr_Stock_Price:  101.80121275844999
curr_Factors:  [101.80121276]
mat_Sqrt:  [[0.15]]
grads:  [-0.08410702]
Stock Position:  -0.08410702471760487
Bond Position:  [16.03238342]


portfolio before change:  [7.38153918]
curr_Stock_Price:  102.87902160529778
curr_Factors:  [102.87902161]
mat_Sqrt:  [[0.15]]
grads:  [-0.02245232]
Stock Position:  -0.022452318676263138
Bond Position:  [9.69141176]


portfolio before change:  [7.38739722]
curr_Stock_Price:  102.6720702121554
curr_Factors:  [102.67207021]
mat_Sqrt:  [[0.15]]
grads:  [-0.03687378]
Stock Position:  -0.036873784923235675
Bond Position:  [11.17330506]


portfolio before change:  [7.39936048]
curr_Stock_Price:  102.38551136891806
curr_Factors:  [102.38551137]
mat_Sqrt:  [[0.15]]
grads:  [-0.0252693]
Stock Position:  -0.025269302879060845
Bond Position:  [9.98657098]


portfolio before change:  [7.42237557]
curr_Stock_Price:  101.52412286497203
curr_Factors:  [101.52412286]
mat_Sqrt:  [[0.15]]
grads:  [0.15353656]
Stock Position:  0.15353656029112794
Bond Position:  [-8.16528904]


portfolio before change:  [7.31300144]
curr_Stock_Price:  100.81840557332178
curr_Factors:  [100.81840557]
mat_Sqrt:  [[0.15]]
grads:  [0.0438519]
Stock Position:  0.04385189900789631
Bond Position:  [2.8919229]


portfolio before change:  [7.26862815]
curr_Stock_Price:  99.79827191079724
curr_Factors:  [99.79827191]
mat_Sqrt:  [[0.15]]
grads:  [0.15866779]
Stock Position:  0.15866778906696427
Bond Position:  [-8.566143]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [7.26862815]
Stock Price:  99.52709242894353
PL:  [7.26862815]
Settle:  Tensor("sub_370:0", shape=(), dtype=float64)
PL:  Tensor("sub_371:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  186
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.51322823e-03]
 [ 2.98763328e-03]
 [-1.87795021e-02]
 [-1.28531940e-02]
 [ 1.17164726e-02]
 [ 1.51447731e-02]
 [ 2.63277285e-02]
 [-2.40773286e-03]
 [ 6.20428164e-03]
 [ 1.24181628e-02]
 [ 2.11682306e-02]
 [ 6.29004778e-03]
 [-1.14681462e-02]
 [ 1.09009036e-02]
 [-6.89003658e-03]
 [-2.74178311e-02]
 [ 4.41062973e-03]
 [-5.59172050e-04]
 [-4.05599568e-03]
 [-2.38254896e-03]
 [-1.35778214e-03]
 [-3.35358350e-02]
 [ 4.80883136e-03]
 [ 1.01001490e-02]
 [-5.48789653e-03]
 [-7.01175670e-03]
 [-3.67536882e-04]
 [-1.07084547e-02]
 [ 7.75574575e-03]
 [ 2.26948377e-02]
 [-9.83867455e-03]
 [ 6.38521020e-03]
 [-1.29590100e-02]
 [-3.68404103e-03]
 [-5.49994422e-03]
 [-4.76863990e-03]
 [ 2.32519705e-02]
 [ 1.96805124e-03]
 [ 2.12534010e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-2.48109374]
curr_Stock_Price:  99.71518738867296
curr_Factors:  [99.71518739]
mat_Sqrt:  [[0.15]]
grads:  [-0.01675485]
Stock Position:  -0.016754854842918946
Bond Position:  [-0.81038025]


portfolio before change:  [-2.47412575]
curr_Stock_Price:  99.2932622816808
curr_Factors:  [99.29326228]
mat_Sqrt:  [[0.15]]
grads:  [0.01991756]
Stock Position:  0.019917555231339017
Bond Position:  [-4.45180478]


portfolio before change:  [-2.48306974]
curr_Stock_Price:  98.8721522046056
curr_Factors:  [98.8721522]
mat_Sqrt:  [[0.15]]
grads:  [-0.12519668]
Stock Position:  -0.1251966806606214
Bond Position:  [9.89539553]


portfolio before change:  [-2.51196852]
curr_Stock_Price:  99.11285971497048
curr_Factors:  [99.11285971]
mat_Sqrt:  [[0.15]]
grads:  [-0.08568796]
Stock Position:  -0.08568795992247509
Bond Position:  [5.98081023]


portfolio before change:  [-2.53946158]
curr_Stock_Price:  99.44243589570004
curr_Factors:  [99.4424359]
mat_Sqrt:  [[0.15]]
grads:  [0.07810982]
Stock Position:  0.07810981764124961
Bond Position:  [-10.30689212]


portfolio before change:  [-2.50433949]
curr_Stock_Price:  99.9085812600974
curr_Factors:  [99.90858126]
mat_Sqrt:  [[0.15]]
grads:  [0.10096515]
Stock Position:  0.10096515367551456
Bond Position:  [-12.59162476]


portfolio before change:  [-2.43798739]
curr_Stock_Price:  100.58134953986409
curr_Factors:  [100.58134954]
mat_Sqrt:  [[0.15]]
grads:  [0.17551819]
Stock Position:  0.17551819011506165
Bond Position:  [-20.09184382]


portfolio before change:  [-2.40302225]
curr_Stock_Price:  100.79487030559238
curr_Factors:  [100.79487031]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605155]
Stock Position:  -0.01605155237963967
Bond Position:  [-0.78510811]


portfolio before change:  [-2.41969403]
curr_Stock_Price:  101.82739534503935
curr_Factors:  [101.82739535]
mat_Sqrt:  [[0.15]]
grads:  [0.04136188]
Stock Position:  0.041361877579299565
Bond Position:  [-6.63146629]


portfolio before change:  [-2.37788476]
curr_Stock_Price:  102.8582540705662
curr_Factors:  [102.85825407]
mat_Sqrt:  [[0.15]]
grads:  [0.08278775]
Stock Position:  0.0827877521882467
Bond Position:  [-10.89328841]


portfolio before change:  [-2.29944048]
curr_Stock_Price:  103.82223750785693
curr_Factors:  [103.82223751]
mat_Sqrt:  [[0.15]]
grads:  [0.14112154]
Stock Position:  0.14112153722047047
Bond Position:  [-16.95099424]


portfolio before change:  [-2.55048754]
curr_Stock_Price:  102.05831080954329
curr_Factors:  [102.05831081]
mat_Sqrt:  [[0.15]]
grads:  [0.04193365]
Stock Position:  0.04193365183997568
Bond Position:  [-6.83016521]


portfolio before change:  [-2.56514163]
curr_Stock_Price:  101.72921303046054
curr_Factors:  [101.72921303]
mat_Sqrt:  [[0.15]]
grads:  [-0.07645431]
Stock Position:  -0.07645430810685255
Bond Position:  [5.21249496]


portfolio before change:  [-2.61281876]
curr_Stock_Price:  102.3613386912544
curr_Factors:  [102.36133869]
mat_Sqrt:  [[0.15]]
grads:  [0.07267269]
Stock Position:  0.07267269050898985
Bond Position:  [-10.05169265]


portfolio before change:  [-2.69180427]
curr_Stock_Price:  101.29176268967124
curr_Factors:  [101.29176269]
mat_Sqrt:  [[0.15]]
grads:  [-0.04593358]
Stock Position:  -0.0459335771849988
Bond Position:  [1.96088873]


portfolio before change:  [-2.71458068]
curr_Stock_Price:  101.79295465167965
curr_Factors:  [101.79295465]
mat_Sqrt:  [[0.15]]
grads:  [-0.18278554]
Stock Position:  -0.18278554095579302
Bond Position:  [15.8916996]


portfolio before change:  [-2.65199982]
curr_Stock_Price:  101.46144991641256
curr_Factors:  [101.46144992]
mat_Sqrt:  [[0.15]]
grads:  [0.0294042]
Stock Position:  0.02940419817306419
Bond Position:  [-5.6353924]


portfolio before change:  [-2.6137249]
curr_Stock_Price:  102.78709027718726
curr_Factors:  [102.78709028]
mat_Sqrt:  [[0.15]]
grads:  [-0.00372781]
Stock Position:  -0.003727813667903773
Bond Position:  [-2.23055378]


portfolio before change:  [-2.61227646]
curr_Stock_Price:  102.32374308036826
curr_Factors:  [102.32374308]
mat_Sqrt:  [[0.15]]
grads:  [-0.02703997]
Stock Position:  -0.027039971171752438
Bond Position:  [0.1545546]


portfolio before change:  [-2.59842342]
curr_Stock_Price:  101.81214036251902
curr_Factors:  [101.81214036]
mat_Sqrt:  [[0.15]]
grads:  [-0.01588366]
Stock Position:  -0.01588365973009313
Bond Position:  [-0.98127402]


portfolio before change:  [-2.62379735]
curr_Stock_Price:  103.40190406651993
curr_Factors:  [103.40190407]
mat_Sqrt:  [[0.15]]
grads:  [-0.00905188]
Stock Position:  -0.009051880943670862
Bond Position:  [-1.68781563]


portfolio before change:  [-2.62167705]
curr_Stock_Price:  103.14435669789889
curr_Factors:  [103.1443567]
mat_Sqrt:  [[0.15]]
grads:  [-0.22357223]
Stock Position:  -0.22357223359815118
Bond Position:  [20.43853716]


portfolio before change:  [-2.73615634]
curr_Stock_Price:  103.66783075552001
curr_Factors:  [103.66783076]
mat_Sqrt:  [[0.15]]
grads:  [0.03205888]
Stock Position:  0.032058875712811685
Bond Position:  [-6.05963044]


portfolio before change:  [-2.7138883]
curr_Stock_Price:  104.38605735968768
curr_Factors:  [104.38605736]
mat_Sqrt:  [[0.15]]
grads:  [0.06733433]
Stock Position:  0.06733432691357716
Bond Position:  [-9.74265322]


portfolio before change:  [-2.79908014]
curr_Stock_Price:  103.13893815782623
curr_Factors:  [103.13893816]
mat_Sqrt:  [[0.15]]
grads:  [-0.03658598]
Stock Position:  -0.03658597686991384
Bond Position:  [0.97435866]


portfolio before change:  [-2.73867981]
curr_Stock_Price:  101.49135243426609
curr_Factors:  [101.49135243]
mat_Sqrt:  [[0.15]]
grads:  [-0.04674504]
Stock Position:  -0.04674504467676537
Bond Position:  [2.005538]


portfolio before change:  [-2.77396385]
curr_Stock_Price:  102.2515345425521
curr_Factors:  [102.25153454]
mat_Sqrt:  [[0.15]]
grads:  [-0.00245025]
Stock Position:  -0.002450245880379579
Bond Position:  [-2.52342245]


portfolio before change:  [-2.77557441]
curr_Stock_Price:  102.7800994521426
curr_Factors:  [102.78009945]
mat_Sqrt:  [[0.15]]
grads:  [-0.0713897]
Stock Position:  -0.07138969781684909
Bond Position:  [4.56186583]


portfolio before change:  [-2.79875811]
curr_Stock_Price:  103.11283615816974
curr_Factors:  [103.11283616]
mat_Sqrt:  [[0.15]]
grads:  [0.05170497]
Stock Position:  0.05170497169831409
Bond Position:  [-8.13020439]


portfolio before change:  [-2.85724963]
curr_Stock_Price:  102.00123743177113
curr_Factors:  [102.00123743]
mat_Sqrt:  [[0.15]]
grads:  [0.15129892]
Stock Position:  0.15129891780251126
Bond Position:  [-18.28992647]


portfolio before change:  [-2.67859374]
curr_Stock_Price:  103.19716319680191
curr_Factors:  [103.1971632]
mat_Sqrt:  [[0.15]]
grads:  [-0.06559116]
Stock Position:  -0.06559116366701859
Bond Position:  [4.09022828]


portfolio before change:  [-2.66728514]
curr_Stock_Price:  103.03254814498582
curr_Factors:  [103.03254814]
mat_Sqrt:  [[0.15]]
grads:  [0.04256807]
Stock Position:  0.04256806801695219
Bond Position:  [-7.05318166]


portfolio before change:  [-2.64407176]
curr_Stock_Price:  103.59858462793004
curr_Factors:  [103.59858463]
mat_Sqrt:  [[0.15]]
grads:  [-0.0863934]
Stock Position:  -0.08639340030347968
Bond Position:  [6.30616223]


portfolio before change:  [-2.57387866]
curr_Stock_Price:  102.7952271959844
curr_Factors:  [102.7952272]
mat_Sqrt:  [[0.15]]
grads:  [-0.02456027]
Stock Position:  -0.024560273517184206
Bond Position:  [-0.04919977]


portfolio before change:  [-2.56227864]
curr_Stock_Price:  102.32266837980332
curr_Factors:  [102.32266838]
mat_Sqrt:  [[0.15]]
grads:  [-0.03666629]
Stock Position:  -0.03666629480127743
Bond Position:  [1.18951448]


portfolio before change:  [-2.54906069]
curr_Stock_Price:  101.96623066111223
curr_Factors:  [101.96623066]
mat_Sqrt:  [[0.15]]
grads:  [-0.03179093]
Stock Position:  -0.031790932636394584
Bond Position:  [0.69254088]


portfolio before change:  [-2.55772891]
curr_Stock_Price:  102.24161698714202
curr_Factors:  [102.24161699]
mat_Sqrt:  [[0.15]]
grads:  [0.15501314]
Stock Position:  0.15501313678669032
Bond Position:  [-18.40652266]


portfolio before change:  [-2.60434154]
curr_Stock_Price:  101.95575944466397
curr_Factors:  [101.95575944]
mat_Sqrt:  [[0.15]]
grads:  [0.01312034]
Stock Position:  0.013120341573949309
Bond Position:  [-3.94203593]


portfolio before change:  [-2.58785616]
curr_Stock_Price:  103.24979327505756
curr_Factors:  [103.24979328]
mat_Sqrt:  [[0.15]]
grads:  [0.14168934]
Stock Position:  0.14168934002099157
Bond Position:  [-17.21725122]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-2.58785616]
Stock Price:  103.23761466279856
PL:  [-5.82547082]
Settle:  Tensor("sub_372:0", shape=(), dtype=float64)
PL:  Tensor("sub_373:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  187
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.41615763e-03]
 [-1.53050444e-03]
 [-1.41567201e-02]
 [-2.50954092e-02]
 [-8.07786656e-03]
 [ 2.46204329e-02]
 [ 8.22172614e-04]
 [-1.22714912e-02]
 [-1.07656807e-02]
 [ 3.37978720e-03]
 [-7.42801456e-02]
 [-3.06186792e-02]
 [ 1.57528610e-02]
 [-3.50076777e-03]
 [ 2.33169085e-02]
 [-4.36310575e-03]
 [-1.10054313e-02]
 [ 3.82049151e-04]
 [-7.69410126e-03]
 [-2.54569546e-03]
 [ 6.30474389e-04]
 [ 9.02993909e-03]
 [ 4.75494147e-03]
 [ 5.54686341e-03]
 [ 5.68112479e-03]
 [ 5.18777475e-05]
 [ 1.39356339e-02]
 [-2.07979471e-02]
 [-1.81575320e-02]
 [ 2.13766963e-02]
 [ 2.58532423e-03]
 [-1.06159169e-02]
 [-1.23314321e-02]
 [-7.87442947e-03]
 [-6.52646217e-03]
 [-5.57429411e-03]
 [ 1.91937439e-02]
 [ 9.20085629e-03]
 [ 2.06848970e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [16.23373453]
curr_Stock_Price:  100.92083537625665
curr_Factors:  [100.92083538]
mat_Sqrt:  [[0.15]]
grads:  [-0.01610772]
Stock Position:  -0.016107717500006287
Bond Position:  [17.85933884]


portfolio before change:  [16.25433498]
curr_Stock_Price:  99.78051931867898
curr_Factors:  [99.78051932]
mat_Sqrt:  [[0.15]]
grads:  [-0.01020336]
Stock Position:  -0.010203362935902011
Bond Position:  [17.27243183]


portfolio before change:  [16.2632666]
curr_Stock_Price:  99.11677372819321
curr_Factors:  [99.11677373]
mat_Sqrt:  [[0.15]]
grads:  [-0.09437813]
Stock Position:  -0.09437813388320909
Bond Position:  [25.61772275]


portfolio before change:  [16.33213578]
curr_Stock_Price:  98.42099008191303
curr_Factors:  [98.42099008]
mat_Sqrt:  [[0.15]]
grads:  [-0.16730273]
Stock Position:  -0.1673027279586195
Bond Position:  [32.79823591]


portfolio before change:  [16.611051]
curr_Stock_Price:  96.77836785126556
curr_Factors:  [96.77836785]
mat_Sqrt:  [[0.15]]
grads:  [-0.05385244]
Stock Position:  -0.053852443711709795
Bond Position:  [21.82280261]


portfolio before change:  [16.61490995]
curr_Stock_Price:  96.75736723779094
curr_Factors:  [96.75736724]
mat_Sqrt:  [[0.15]]
grads:  [0.16413622]
Stock Position:  0.16413621966339606
Bond Position:  [0.73352147]


portfolio before change:  [16.57279763]
curr_Stock_Price:  96.50023922754818
curr_Factors:  [96.50023923]
mat_Sqrt:  [[0.15]]
grads:  [0.00548115]
Stock Position:  0.00548115075966227
Bond Position:  [16.04386527]


portfolio before change:  [16.57160383]
curr_Stock_Price:  95.9165277588811
curr_Factors:  [95.91652776]
mat_Sqrt:  [[0.15]]
grads:  [-0.08180994]
Stock Position:  -0.08180994152863481
Bond Position:  [24.41852935]


portfolio before change:  [16.61059329]
curr_Stock_Price:  95.47725399914181
curr_Factors:  [95.477254]
mat_Sqrt:  [[0.15]]
grads:  [-0.0717712]
Stock Position:  -0.07177120469568452
Bond Position:  [23.46311084]


portfolio before change:  [16.58281414]
curr_Stock_Price:  95.90517249637381
curr_Factors:  [95.9051725]
mat_Sqrt:  [[0.15]]
grads:  [0.02253191]
Stock Position:  0.022531914648876116
Bond Position:  [14.42188698]


portfolio before change:  [16.59081378]
curr_Stock_Price:  96.18019512714763
curr_Factors:  [96.18019513]
mat_Sqrt:  [[0.15]]
grads:  [-0.49520097]
Stock Position:  -0.4952009707663009
Bond Position:  [64.21933977]


portfolio before change:  [17.55386078]
curr_Stock_Price:  94.25164662953387
curr_Factors:  [94.25164663]
mat_Sqrt:  [[0.15]]
grads:  [-0.20412453]
Stock Position:  -0.20412452779708168
Bond Position:  [36.79293365]


portfolio before change:  [17.46686512]
curr_Stock_Price:  94.70036814097512
curr_Factors:  [94.70036814]
mat_Sqrt:  [[0.15]]
grads:  [0.10501907]
Stock Position:  0.10501907336524674
Bond Position:  [7.52152021]


portfolio before change:  [17.30050859]
curr_Stock_Price:  93.10735487943924
curr_Factors:  [93.10735488]
mat_Sqrt:  [[0.15]]
grads:  [-0.02333845]
Stock Position:  -0.023338451768294306
Bond Position:  [19.4734901]


portfolio before change:  [17.27691719]
curr_Stock_Price:  94.22249913775939
curr_Factors:  [94.22249914]
mat_Sqrt:  [[0.15]]
grads:  [0.15544606]
Stock Position:  0.15544605694544925
Bond Position:  [2.63040122]


portfolio before change:  [17.34548426]
curr_Stock_Price:  94.6614826249163
curr_Factors:  [94.66148262]
mat_Sqrt:  [[0.15]]
grads:  [-0.02908737]
Stock Position:  -0.02908737164379115
Bond Position:  [20.09893799]


portfolio before change:  [17.33021962]
curr_Stock_Price:  95.27264711135452
curr_Factors:  [95.27264711]
mat_Sqrt:  [[0.15]]
grads:  [-0.07336954]
Stock Position:  -0.07336954198780081
Bond Position:  [24.3203301]


portfolio before change:  [17.3387054]
curr_Stock_Price:  95.19842633758601
curr_Factors:  [95.19842634]
mat_Sqrt:  [[0.15]]
grads:  [0.00254699]
Stock Position:  0.0025469943393664632
Bond Position:  [17.09623554]


portfolio before change:  [17.34171391]
curr_Stock_Price:  95.54053647402378
curr_Factors:  [95.54053647]
mat_Sqrt:  [[0.15]]
grads:  [-0.05129401]
Stock Position:  -0.05129400837150956
Bond Position:  [22.24237099]


portfolio before change:  [17.27868293]
curr_Stock_Price:  96.8235606312114
curr_Factors:  [96.82356063]
mat_Sqrt:  [[0.15]]
grads:  [-0.0169713]
Stock Position:  -0.016971303075671178
Bond Position:  [18.92190492]


portfolio before change:  [17.28288201]
curr_Stock_Price:  96.71551377982033
curr_Factors:  [96.71551378]
mat_Sqrt:  [[0.15]]
grads:  [0.00420316]
Stock Position:  0.004203162593272894
Bond Position:  [16.87637098]


portfolio before change:  [17.27702036]
curr_Stock_Price:  94.81900551323709
curr_Factors:  [94.81900551]
mat_Sqrt:  [[0.15]]
grads:  [0.06019959]
Stock Position:  0.06019959390238826
Bond Position:  [11.56895473]


portfolio before change:  [17.2671241]
curr_Stock_Price:  94.63059125450125
curr_Factors:  [94.63059125]
mat_Sqrt:  [[0.15]]
grads:  [0.03169961]
Stock Position:  0.03169960983280498
Bond Position:  [14.26737128]


portfolio before change:  [17.26471688]
curr_Stock_Price:  94.498388957291
curr_Factors:  [94.49838896]
mat_Sqrt:  [[0.15]]
grads:  [0.03697909]
Stock Position:  0.03697908941695534
Bond Position:  [13.7702525]


portfolio before change:  [17.24057395]
curr_Stock_Price:  93.79895821039237
curr_Factors:  [93.79895821]
mat_Sqrt:  [[0.15]]
grads:  [0.03787417]
Stock Position:  0.037874165264123884
Bond Position:  [13.68801671]


portfolio before change:  [17.22919138]
curr_Stock_Price:  93.45324277464137
curr_Factors:  [93.45324277]
mat_Sqrt:  [[0.15]]
grads:  [0.00034585]
Stock Position:  0.00034585165023431436
Bond Position:  [17.19687042]


portfolio before change:  [17.2313458]
curr_Stock_Price:  93.4667749751207
curr_Factors:  [93.46677498]
mat_Sqrt:  [[0.15]]
grads:  [0.09290423]
Stock Position:  0.09290422619460202
Bond Position:  [8.5478874]


portfolio before change:  [17.19547582]
curr_Stock_Price:  93.06917694041209
curr_Factors:  [93.06917694]
mat_Sqrt:  [[0.15]]
grads:  [-0.13865298]
Stock Position:  -0.13865298076369126
Bond Position:  [30.09979462]


portfolio before change:  [17.18375218]
curr_Stock_Price:  93.1808683295414
curr_Factors:  [93.18086833]
mat_Sqrt:  [[0.15]]
grads:  [-0.12105021]
Stock Position:  -0.1210502132425916
Bond Position:  [28.46331616]


portfolio before change:  [17.09482509]
curr_Stock_Price:  93.94489200820351
curr_Factors:  [93.94489201]
mat_Sqrt:  [[0.15]]
grads:  [0.14251131]
Stock Position:  0.14251130847223026
Bond Position:  [3.70661561]


portfolio before change:  [17.03811001]
curr_Stock_Price:  93.54367165621052
curr_Factors:  [93.54367166]
mat_Sqrt:  [[0.15]]
grads:  [0.01723549]
Stock Position:  0.017235494877954297
Bond Position:  [15.42583853]


portfolio before change:  [17.04992768]
curr_Stock_Price:  94.11744830435
curr_Factors:  [94.1174483]
mat_Sqrt:  [[0.15]]
grads:  [-0.07077278]
Stock Position:  -0.0707727795889722
Bond Position:  [23.71088111]


portfolio before change:  [17.02357973]
curr_Stock_Price:  94.5316188137774
curr_Factors:  [94.53161881]
mat_Sqrt:  [[0.15]]
grads:  [-0.08220955]
Stock Position:  -0.08220954749155363
Bond Position:  [24.79498134]


portfolio before change:  [16.97681369]
curr_Stock_Price:  95.13818596161555
curr_Factors:  [95.13818596]
mat_Sqrt:  [[0.15]]
grads:  [-0.0524962]
Stock Position:  -0.05249619649946676
Bond Position:  [21.97120659]


portfolio before change:  [16.92439828]
curr_Stock_Price:  96.18896646868208
curr_Factors:  [96.18896647]
mat_Sqrt:  [[0.15]]
grads:  [-0.04350975]
Stock Position:  -0.043509747801517146
Bond Position:  [21.10955595]


portfolio before change:  [16.92158743]
curr_Stock_Price:  96.31421911024097
curr_Factors:  [96.31421911]
mat_Sqrt:  [[0.15]]
grads:  [-0.03716196]
Stock Position:  -0.037161960761222176
Bond Position:  [20.50081266]


portfolio before change:  [16.9519304]
curr_Stock_Price:  95.56667485513708
curr_Factors:  [95.56667486]
mat_Sqrt:  [[0.15]]
grads:  [0.12795829]
Stock Position:  0.12795829276151088
Bond Position:  [4.72338184]


portfolio before change:  [17.02721909]
curr_Stock_Price:  96.15044498960977
curr_Factors:  [96.15044499]
mat_Sqrt:  [[0.15]]
grads:  [0.06133904]
Stock Position:  0.06133904193525483
Bond Position:  [11.12944291]


portfolio before change:  [17.02036752]
curr_Stock_Price:  96.01606346865987
curr_Factors:  [96.01606347]
mat_Sqrt:  [[0.15]]
grads:  [0.13789931]
Stock Position:  0.1378993135875815
Bond Position:  [3.77981828]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [17.02036752]
Stock Price:  95.89737602795307
PL:  [17.02036752]
Settle:  Tensor("sub_374:0", shape=(), dtype=float64)
PL:  Tensor("sub_375:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  188
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-3.32160904e-03]
 [-1.45943075e-02]
 [ 1.74563150e-02]
 [-1.09392859e-02]
 [ 1.48708586e-02]
 [ 1.54641193e-02]
 [ 2.41222183e-02]
 [-2.71434480e-03]
 [ 7.25812977e-03]
 [ 8.18693678e-03]
 [ 2.22463126e-02]
 [ 1.16170694e-02]
 [-6.36622669e-03]
 [ 1.17225241e-02]
 [-7.18979073e-03]
 [-2.56646980e-02]
 [ 2.46701520e-03]
 [-3.24879928e-03]
 [-1.12623985e-02]
 [-2.32979535e-03]
 [ 3.42905325e-04]
 [ 8.78889374e-03]
 [ 4.77768272e-03]
 [ 6.34079435e-03]
 [-3.42029261e-03]
 [-8.95754347e-03]
 [ 7.35673860e-03]
 [-2.43979179e-02]
 [-3.78338581e-02]
 [ 2.20109947e-02]
 [ 3.91976126e-03]
 [-6.24333965e-03]
 [-1.24838856e-02]
 [-9.72703973e-03]
 [-6.92674170e-03]
 [-4.63848199e-03]
 [ 1.93453824e-02]
 [ 1.06760826e-02]
 [ 1.81510077e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-4.92350344]
curr_Stock_Price:  99.55784229814427
curr_Factors:  [99.5578423]
mat_Sqrt:  [[0.15]]
grads:  [-0.02214406]
Stock Position:  -0.022144060272868856
Bond Position:  [-2.71888858]


portfolio before change:  [-4.93692893]
curr_Stock_Price:  100.14877278385563
curr_Factors:  [100.14877278]
mat_Sqrt:  [[0.15]]
grads:  [-0.09729538]
Stock Position:  -0.09729538335634898
Bond Position:  [4.80708431]


portfolio before change:  [-4.91369168]
curr_Stock_Price:  99.91611710912414
curr_Factors:  [99.91611711]
mat_Sqrt:  [[0.15]]
grads:  [0.11637543]
Stock Position:  0.11637543322243273
Bond Position:  [-16.54147309]


portfolio before change:  [-4.99559666]
curr_Stock_Price:  99.23008600466576
curr_Factors:  [99.230086]
mat_Sqrt:  [[0.15]]
grads:  [-0.07292857]
Stock Position:  -0.07292857234496876
Bond Position:  [2.24111185]


portfolio before change:  [-4.92981977]
curr_Stock_Price:  98.33199167310676
curr_Factors:  [98.33199167]
mat_Sqrt:  [[0.15]]
grads:  [0.09913906]
Stock Position:  0.0991390573843988
Bond Position:  [-14.67836073]


portfolio before change:  [-4.7829015]
curr_Stock_Price:  99.83244140716255
curr_Factors:  [99.83244141]
mat_Sqrt:  [[0.15]]
grads:  [0.10309413]
Stock Position:  0.10309412888546059
Bond Position:  [-15.07504009]


portfolio before change:  [-4.8158901]
curr_Stock_Price:  99.53073558411072
curr_Factors:  [99.53073558]
mat_Sqrt:  [[0.15]]
grads:  [0.16081479]
Stock Position:  0.16081478847828481
Bond Position:  [-20.82190429]


portfolio before change:  [-4.65597105]
curr_Stock_Price:  100.54135127663467
curr_Factors:  [100.54135128]
mat_Sqrt:  [[0.15]]
grads:  [-0.01809563]
Stock Position:  -0.018095631973244125
Bond Position:  [-2.83661176]


portfolio before change:  [-4.6513143]
curr_Stock_Price:  100.26441395678484
curr_Factors:  [100.26441396]
mat_Sqrt:  [[0.15]]
grads:  [0.04838753]
Stock Position:  0.048387531806572105
Bond Position:  [-9.50286181]


portfolio before change:  [-4.6217343]
curr_Stock_Price:  100.9002786685743
curr_Factors:  [100.90027867]
mat_Sqrt:  [[0.15]]
grads:  [0.05457958]
Stock Position:  0.054579578565302225
Bond Position:  [-10.12882899]


portfolio before change:  [-4.60629091]
curr_Stock_Price:  101.20642937868122
curr_Factors:  [101.20642938]
mat_Sqrt:  [[0.15]]
grads:  [0.14830875]
Stock Position:  0.1483087506302952
Bond Position:  [-19.61609001]


portfolio before change:  [-4.79846631]
curr_Stock_Price:  99.9271842984035
curr_Factors:  [99.9271843]
mat_Sqrt:  [[0.15]]
grads:  [0.07744713]
Stock Position:  0.07744712962673704
Bond Position:  [-12.53753991]


portfolio before change:  [-4.83769176]
curr_Stock_Price:  99.44094091280888
curr_Factors:  [99.44094091]
mat_Sqrt:  [[0.15]]
grads:  [-0.04244151]
Stock Position:  -0.04244151124599118
Bond Position:  [-0.61726795]


portfolio before change:  [-4.9152134]
curr_Stock_Price:  101.26567503544203
curr_Factors:  [101.26567504]
mat_Sqrt:  [[0.15]]
grads:  [0.07815016]
Stock Position:  0.0781501607424699
Bond Position:  [-12.82914218]


portfolio before change:  [-4.9424936]
curr_Stock_Price:  100.93712216537057
curr_Factors:  [100.93712217]
mat_Sqrt:  [[0.15]]
grads:  [-0.04793194]
Stock Position:  -0.04793193822290813
Bond Position:  [-0.10438169]


portfolio before change:  [-4.9408031]
curr_Stock_Price:  100.90158114698987
curr_Factors:  [100.90158115]
mat_Sqrt:  [[0.15]]
grads:  [-0.17109799]
Stock Position:  -0.17109798639005655
Bond Position:  [12.32325426]


portfolio before change:  [-4.78341128]
curr_Stock_Price:  99.99069193588493
curr_Factors:  [99.99069194]
mat_Sqrt:  [[0.15]]
grads:  [0.01644677]
Stock Position:  0.0164467679969002
Bond Position:  [-6.427935]


portfolio before change:  [-4.78296977]
curr_Stock_Price:  100.06639437302168
curr_Factors:  [100.06639437]
mat_Sqrt:  [[0.15]]
grads:  [-0.02165866]
Stock Position:  -0.021658661884090664
Bond Position:  [-2.61566556]


portfolio before change:  [-4.7849523]
curr_Stock_Price:  100.1428330547685
curr_Factors:  [100.14283305]
mat_Sqrt:  [[0.15]]
grads:  [-0.07508266]
Stock Position:  -0.07508265662748717
Bond Position:  [2.73403764]


portfolio before change:  [-4.71921835]
curr_Stock_Price:  99.27189723989765
curr_Factors:  [99.27189724]
mat_Sqrt:  [[0.15]]
grads:  [-0.01553197]
Stock Position:  -0.015531968969761268
Bond Position:  [-3.17733033]


portfolio before change:  [-4.70189539]
curr_Stock_Price:  98.13101461593507
curr_Factors:  [98.13101462]
mat_Sqrt:  [[0.15]]
grads:  [0.00228604]
Stock Position:  0.002286035499110992
Bond Position:  [-4.92622637]


portfolio before change:  [-4.70259941]
curr_Stock_Price:  98.09243352031042
curr_Factors:  [98.09243352]
mat_Sqrt:  [[0.15]]
grads:  [0.05859262]
Stock Position:  0.05859262492090021
Bond Position:  [-10.45009257]


portfolio before change:  [-4.55266438]
curr_Stock_Price:  100.67366917100708
curr_Factors:  [100.67366917]
mat_Sqrt:  [[0.15]]
grads:  [0.03185122]
Stock Position:  0.03185121811344971
Bond Position:  [-7.75924337]


portfolio before change:  [-4.57624718]
curr_Stock_Price:  99.96371714257899
curr_Factors:  [99.96371714]
mat_Sqrt:  [[0.15]]
grads:  [0.04227196]
Stock Position:  0.04227196235289644
Bond Position:  [-8.80190967]


portfolio before change:  [-4.61374652]
curr_Stock_Price:  99.10264906818445
curr_Factors:  [99.10264907]
mat_Sqrt:  [[0.15]]
grads:  [-0.02280195]
Stock Position:  -0.022801950727084574
Bond Position:  [-2.3540128]


portfolio before change:  [-4.64323974]
curr_Stock_Price:  100.38319489310027
curr_Factors:  [100.38319489]
mat_Sqrt:  [[0.15]]
grads:  [-0.05971696]
Stock Position:  -0.059716956469943905
Bond Position:  [1.35133914]


portfolio before change:  [-4.56901407]
curr_Stock_Price:  99.14306579228817
curr_Factors:  [99.14306579]
mat_Sqrt:  [[0.15]]
grads:  [0.04904492]
Stock Position:  0.049044923972003315
Bond Position:  [-9.4314782]


portfolio before change:  [-4.58390626]
curr_Stock_Price:  98.86346144552358
curr_Factors:  [98.86346145]
mat_Sqrt:  [[0.15]]
grads:  [-0.16265279]
Stock Position:  -0.16265278601562974
Bond Position:  [11.49651118]


portfolio before change:  [-4.57426366]
curr_Stock_Price:  98.81301385302208
curr_Factors:  [98.81301385]
mat_Sqrt:  [[0.15]]
grads:  [-0.25222572]
Stock Position:  -0.2522257203676153
Bond Position:  [20.34891994]


portfolio before change:  [-4.24317219]
curr_Stock_Price:  97.51041990506187
curr_Factors:  [97.51041991]
mat_Sqrt:  [[0.15]]
grads:  [0.14673996]
Stock Position:  0.14673996484131546
Bond Position:  [-18.55184778]


portfolio before change:  [-4.22001838]
curr_Stock_Price:  97.68401225746757
curr_Factors:  [97.68401226]
mat_Sqrt:  [[0.15]]
grads:  [0.02613174]
Stock Position:  0.02613174172895815
Bond Position:  [-6.77267176]


portfolio before change:  [-4.25010991]
curr_Stock_Price:  96.56487923394882
curr_Factors:  [96.56487923]
mat_Sqrt:  [[0.15]]
grads:  [-0.04162226]
Stock Position:  -0.04162226436065034
Bond Position:  [-0.23086098]


portfolio before change:  [-4.24138584]
curr_Stock_Price:  96.35458469415316
curr_Factors:  [96.35458469]
mat_Sqrt:  [[0.15]]
grads:  [-0.0832259]
Stock Position:  -0.08322590424116351
Bond Position:  [3.7778116]


portfolio before change:  [-4.24235792]
curr_Stock_Price:  96.37193915197797
curr_Factors:  [96.37193915]
mat_Sqrt:  [[0.15]]
grads:  [-0.06484693]
Stock Position:  -0.0648469315570859
Bond Position:  [2.00706662]


portfolio before change:  [-4.26403685]
curr_Stock_Price:  96.71011750940129
curr_Factors:  [96.71011751]
mat_Sqrt:  [[0.15]]
grads:  [-0.04617828]
Stock Position:  -0.046178277981971036
Bond Position:  [0.20186984]


portfolio before change:  [-4.20889071]
curr_Stock_Price:  95.5164630083788
curr_Factors:  [95.51646301]
mat_Sqrt:  [[0.15]]
grads:  [-0.03092321]
Stock Position:  -0.030923213251954584
Bond Position:  [-1.25521475]


portfolio before change:  [-4.2159535]
curr_Stock_Price:  95.73978646827818
curr_Factors:  [95.73978647]
mat_Sqrt:  [[0.15]]
grads:  [0.12896922]
Stock Position:  0.12896921599044978
Bond Position:  [-16.5634387]


portfolio before change:  [-4.35613854]
curr_Stock_Price:  94.66887595522854
curr_Factors:  [94.66887596]
mat_Sqrt:  [[0.15]]
grads:  [0.07117388]
Stock Position:  0.07117388368425556
Bond Position:  [-11.09409011]


portfolio before change:  [-4.39605501]
curr_Stock_Price:  94.12753104360988
curr_Factors:  [94.12753104]
mat_Sqrt:  [[0.15]]
grads:  [0.12100672]
Stock Position:  0.12100671803240676
Bond Position:  [-15.78611862]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-4.39605501]
Stock Price:  93.6822677684455
PL:  [-4.39605501]
Settle:  Tensor("sub_376:0", shape=(), dtype=float64)
PL:  Tensor("sub_377:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  189
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44936617e-03]
 [-1.21608519e-02]
 [-4.31773989e-03]
 [ 1.38442071e-02]
 [ 1.97940377e-02]
 [ 1.61341482e-02]
 [ 2.69446024e-02]
 [-3.08830087e-03]
 [ 8.49268729e-03]
 [ 3.82386630e-03]
 [ 1.05490520e-02]
 [ 1.03682579e-02]
 [-1.14271320e-02]
 [ 1.17249555e-02]
 [-5.85664876e-03]
 [-2.71090833e-02]
 [ 4.61153150e-03]
 [ 1.25944129e-03]
 [-4.51424549e-03]
 [-2.72331443e-03]
 [-8.61281214e-04]
 [-3.43021399e-02]
 [ 4.80605760e-03]
 [ 1.01669071e-02]
 [-5.57329515e-03]
 [ 3.77053542e-03]
 [-9.84744383e-03]
 [-2.18605764e-03]
 [ 3.31434087e-02]
 [ 2.56406730e-02]
 [-2.33883531e-02]
 [ 6.12462089e-03]
 [-1.29756481e-02]
 [-1.62258597e-03]
 [-6.15255886e-03]
 [ 1.75155015e-03]
 [ 2.41829446e-02]
 [ 7.63828578e-03]
 [ 1.86701444e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.38791496]
curr_Stock_Price:  100.22212522239818
curr_Factors:  [100.22212522]
mat_Sqrt:  [[0.15]]
grads:  [-0.00966244]
Stock Position:  -0.009662441128750197
Bond Position:  [6.35630535]


portfolio before change:  [5.38555089]
curr_Stock_Price:  100.54902625989837
curr_Factors:  [100.54902626]
mat_Sqrt:  [[0.15]]
grads:  [-0.08107235]
Stock Position:  -0.08107234589350455
Bond Position:  [13.53729632]


portfolio before change:  [5.30163876]
curr_Stock_Price:  101.60492750661668
curr_Factors:  [101.60492751]
mat_Sqrt:  [[0.15]]
grads:  [-0.02878493]
Stock Position:  -0.028784932590814237
Bond Position:  [8.22632975]


portfolio before change:  [5.32259865]
curr_Stock_Price:  100.91249836016927
curr_Factors:  [100.91249836]
mat_Sqrt:  [[0.15]]
grads:  [0.09229471]
Stock Position:  0.09229471424506516
Bond Position:  [-3.99109155]


portfolio before change:  [5.33164955]
curr_Stock_Price:  101.0159692562813
curr_Factors:  [101.01596926]
mat_Sqrt:  [[0.15]]
grads:  [0.13196025]
Stock Position:  0.13196025121360233
Bond Position:  [-7.99844313]


portfolio before change:  [5.22537788]
curr_Stock_Price:  100.21821542900115
curr_Factors:  [100.21821543]
mat_Sqrt:  [[0.15]]
grads:  [0.10756099]
Stock Position:  0.10756098776935184
Bond Position:  [-5.55419236]


portfolio before change:  [5.2504229]
curr_Stock_Price:  100.45751536613854
curr_Factors:  [100.45751537]
mat_Sqrt:  [[0.15]]
grads:  [0.17963068]
Stock Position:  0.17963068280431208
Bond Position:  [-12.79482918]


portfolio before change:  [5.14663568]
curr_Stock_Price:  99.88863836268624
curr_Factors:  [99.88863836]
mat_Sqrt:  [[0.15]]
grads:  [-0.02058867]
Stock Position:  -0.020588672459303604
Bond Position:  [7.20321014]


portfolio before change:  [5.14575428]
curr_Stock_Price:  99.97518412322144
curr_Factors:  [99.97518412]
mat_Sqrt:  [[0.15]]
grads:  [0.05661792]
Stock Position:  0.05661791529771708
Bond Position:  [-0.51463223]


portfolio before change:  [5.17400049]
curr_Stock_Price:  100.47521217952618
curr_Factors:  [100.47521218]
mat_Sqrt:  [[0.15]]
grads:  [0.02549244]
Stock Position:  0.025492442013008248
Bond Position:  [2.61264197]


portfolio before change:  [5.17094818]
curr_Stock_Price:  100.34266632219655
curr_Factors:  [100.34266632]
mat_Sqrt:  [[0.15]]
grads:  [0.07032701]
Stock Position:  0.07032701306390601
Bond Position:  [-1.88585183]


portfolio before change:  [5.21047668]
curr_Stock_Price:  100.90808563293507
curr_Factors:  [100.90808563]
mat_Sqrt:  [[0.15]]
grads:  [0.06912172]
Stock Position:  0.06912171945447804
Bond Position:  [-1.76446371]


portfolio before change:  [5.26363155]
curr_Stock_Price:  101.68028052078311
curr_Factors:  [101.68028052]
mat_Sqrt:  [[0.15]]
grads:  [-0.07618088]
Stock Position:  -0.07618087973579313
Bond Position:  [13.00972477]


portfolio before change:  [5.29865193]
curr_Stock_Price:  101.24192819767859
curr_Factors:  [101.2419282]
mat_Sqrt:  [[0.15]]
grads:  [0.07816637]
Stock Position:  0.07816637008507363
Bond Position:  [-2.6150621]


portfolio before change:  [5.33209402]
curr_Stock_Price:  101.67394256376355
curr_Factors:  [101.67394256]
mat_Sqrt:  [[0.15]]
grads:  [-0.03904433]
Stock Position:  -0.03904432505184591
Bond Position:  [9.30188448]


portfolio before change:  [5.32201821]
curr_Stock_Price:  101.9617851867166
curr_Factors:  [101.96178519]
mat_Sqrt:  [[0.15]]
grads:  [-0.18072722]
Stock Position:  -0.18072722227555835
Bond Position:  [23.74928842]


portfolio before change:  [5.17772266]
curr_Stock_Price:  102.77662865679486
curr_Factors:  [102.77662866]
mat_Sqrt:  [[0.15]]
grads:  [0.03074354]
Stock Position:  0.030743543342983907
Bond Position:  [2.01800492]


portfolio before change:  [5.16440225]
curr_Stock_Price:  102.33514828153986
curr_Factors:  [102.33514828]
mat_Sqrt:  [[0.15]]
grads:  [0.00839628]
Stock Position:  0.008396275249781024
Bond Position:  [4.30516818]


portfolio before change:  [5.16401491]
curr_Stock_Price:  102.22491764296772
curr_Factors:  [102.22491764]
mat_Sqrt:  [[0.15]]
grads:  [-0.03009497]
Stock Position:  -0.030094969906665978
Bond Position:  [8.24047073]


portfolio before change:  [5.1532144]
curr_Stock_Price:  102.61802736115668
curr_Factors:  [102.61802736]
mat_Sqrt:  [[0.15]]
grads:  [-0.01815543]
Stock Position:  -0.018155429513712417
Bond Position:  [7.01628877]


portfolio before change:  [5.15574834]
curr_Stock_Price:  102.5267685814565
curr_Factors:  [102.52676858]
mat_Sqrt:  [[0.15]]
grads:  [-0.00574187]
Stock Position:  -0.005741874761153869
Bond Position:  [5.7444442]


portfolio before change:  [5.15223246]
curr_Stock_Price:  103.26415408986821
curr_Factors:  [103.26415409]
mat_Sqrt:  [[0.15]]
grads:  [-0.22868093]
Stock Position:  -0.22868093235060505
Bond Position:  [28.7667755]


portfolio before change:  [5.11423468]
curr_Stock_Price:  103.4460400694456
curr_Factors:  [103.44604007]
mat_Sqrt:  [[0.15]]
grads:  [0.03204038]
Stock Position:  0.03204038398317951
Bond Position:  [1.79978383]


portfolio before change:  [5.14647289]
curr_Stock_Price:  104.44519222684025
curr_Factors:  [104.44519223]
mat_Sqrt:  [[0.15]]
grads:  [0.06777938]
Stock Position:  0.06777938072063025
Bond Position:  [-1.93275756]


portfolio before change:  [5.17710256]
curr_Stock_Price:  104.9006593660087
curr_Factors:  [104.90065937]
mat_Sqrt:  [[0.15]]
grads:  [-0.0371553]
Stock Position:  -0.03715530098079149
Bond Position:  [9.07471813]


portfolio before change:  [5.19310338]
curr_Stock_Price:  104.5005438445651
curr_Factors:  [104.50054384]
mat_Sqrt:  [[0.15]]
grads:  [0.0251369]
Stock Position:  0.025136902811134534
Bond Position:  [2.56628337]


portfolio before change:  [5.2163772]
curr_Stock_Price:  105.41366414624271
curr_Factors:  [105.41366415]
mat_Sqrt:  [[0.15]]
grads:  [-0.06564963]
Stock Position:  -0.0656496255115714
Bond Position:  [12.13674478]


portfolio before change:  [5.30303166]
curr_Stock_Price:  104.11682101149104
curr_Factors:  [104.11682101]
mat_Sqrt:  [[0.15]]
grads:  [-0.01457372]
Stock Position:  -0.014573717630324338
Bond Position:  [6.82040081]


portfolio before change:  [5.29537031]
curr_Stock_Price:  104.70101974451799
curr_Factors:  [104.70101974]
mat_Sqrt:  [[0.15]]
grads:  [0.22095606]
Stock Position:  0.2209560578865928
Bond Position:  [-17.83895427]


portfolio before change:  [5.29956729]
curr_Stock_Price:  104.73010692540406
curr_Factors:  [104.73010693]
mat_Sqrt:  [[0.15]]
grads:  [0.17093782]
Stock Position:  0.17093781982964484
Bond Position:  [-12.60276886]


portfolio before change:  [5.44222141]
curr_Stock_Price:  105.5738614477149
curr_Factors:  [105.57386145]
mat_Sqrt:  [[0.15]]
grads:  [-0.15592235]
Stock Position:  -0.15592235386519607
Bond Position:  [21.90354639]


portfolio before change:  [5.63806997]
curr_Stock_Price:  104.33535752227552
curr_Factors:  [104.33535752]
mat_Sqrt:  [[0.15]]
grads:  [0.04083081]
Stock Position:  0.04083080591062518
Bond Position:  [1.37797323]


portfolio before change:  [5.61738059]
curr_Stock_Price:  103.82442884612085
curr_Factors:  [103.82442885]
mat_Sqrt:  [[0.15]]
grads:  [-0.08650432]
Stock Position:  -0.08650432079246795
Bond Position:  [14.59864229]


portfolio before change:  [5.66097806]
curr_Stock_Price:  103.34153367719068
curr_Factors:  [103.34153368]
mat_Sqrt:  [[0.15]]
grads:  [-0.01081724]
Stock Position:  -0.01081723980978547
Bond Position:  [6.77884821]


portfolio before change:  [5.6466946]
curr_Stock_Price:  104.74030724758315
curr_Factors:  [104.74030725]
mat_Sqrt:  [[0.15]]
grads:  [-0.04101706]
Stock Position:  -0.041017059053005935
Bond Position:  [9.94283397]


portfolio before change:  [5.63067994]
curr_Stock_Price:  105.16104893544306
curr_Factors:  [105.16104894]
mat_Sqrt:  [[0.15]]
grads:  [0.011677]
Stock Position:  0.011677001005073635
Bond Position:  [4.40271427]


portfolio before change:  [5.63214968]
curr_Stock_Price:  105.23978194499296
curr_Factors:  [105.23978194]
mat_Sqrt:  [[0.15]]
grads:  [0.16121963]
Stock Position:  0.16121963097947226
Bond Position:  [-11.33456913]


portfolio before change:  [5.96071898]
curr_Stock_Price:  107.28659353625785
curr_Factors:  [107.28659354]
mat_Sqrt:  [[0.15]]
grads:  [0.05092191]
Stock Position:  0.050921905220486945
Bond Position:  [0.49748123]


portfolio before change:  [5.97189214]
curr_Stock_Price:  107.50478981597718
curr_Factors:  [107.50478982]
mat_Sqrt:  [[0.15]]
grads:  [0.12446763]
Stock Position:  0.12446762926646533
Bond Position:  [-7.40897418]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [5.97189214]
Stock Price:  108.40260729769841
PL:  [-2.43071516]
Settle:  Tensor("sub_378:0", shape=(), dtype=float64)
PL:  Tensor("sub_379:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  190
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.49519282e-03]
 [ 2.03314946e-03]
 [ 6.21087047e-03]
 [ 1.42174372e-02]
 [ 7.46968163e-03]
 [ 2.56397883e-02]
 [ 2.06373926e-02]
 [-5.64769941e-04]
 [ 7.25778799e-03]
 [ 1.24923111e-02]
 [ 2.14562896e-02]
 [-4.78962079e-03]
 [-1.17200355e-02]
 [ 6.20066207e-03]
 [-9.45208539e-04]
 [-2.96957455e-02]
 [ 4.86885660e-03]
 [-2.92911427e-03]
 [-1.76820935e-03]
 [-2.52806541e-03]
 [-7.76636271e-04]
 [-3.08502635e-02]
 [ 4.79763293e-03]
 [ 8.39732238e-03]
 [-5.45358661e-03]
 [-6.45892247e-03]
 [-8.70826794e-04]
 [-1.48795119e-02]
 [-8.82720764e-03]
 [ 2.22330816e-02]
 [-4.97388073e-03]
 [ 6.29134664e-03]
 [-1.25714786e-02]
 [-6.11282988e-03]
 [-5.52044028e-03]
 [-6.28515479e-03]
 [ 2.31858974e-02]
 [ 4.18414346e-03]
 [ 2.30754877e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.49010729]
curr_Stock_Price:  100.29313073413081
curr_Factors:  [100.29313073]
mat_Sqrt:  [[0.15]]
grads:  [-0.00996795]
Stock Position:  -0.009967952145025329
Bond Position:  [7.48982441]


portfolio before change:  [6.50152478]
curr_Stock_Price:  99.24163985662886
curr_Factors:  [99.24163986]
mat_Sqrt:  [[0.15]]
grads:  [0.01355433]
Stock Position:  0.013554329717500486
Bond Position:  [5.15637088]


portfolio before change:  [6.52209024]
curr_Stock_Price:  100.71134513841787
curr_Factors:  [100.71134514]
mat_Sqrt:  [[0.15]]
grads:  [0.0414058]
Stock Position:  0.04140580315941391
Bond Position:  [2.35205611]


portfolio before change:  [6.53115957]
curr_Stock_Price:  100.9232793153788
curr_Factors:  [100.92327932]
mat_Sqrt:  [[0.15]]
grads:  [0.09478291]
Stock Position:  0.09478291487794162
Bond Position:  [-3.03464302]


portfolio before change:  [6.47240859]
curr_Stock_Price:  100.30743382931078
curr_Factors:  [100.30743383]
mat_Sqrt:  [[0.15]]
grads:  [0.04979788]
Stock Position:  0.04979787750849687
Bond Position:  [1.47731128]


portfolio before change:  [6.50378915]
curr_Stock_Price:  100.93388401589046
curr_Factors:  [100.93388402]
mat_Sqrt:  [[0.15]]
grads:  [0.17093192]
Stock Position:  0.1709319221256114
Bond Position:  [-10.74903365]


portfolio before change:  [6.53769354]
curr_Stock_Price:  101.14009535404347
curr_Factors:  [101.14009535]
mat_Sqrt:  [[0.15]]
grads:  [0.13758262]
Stock Position:  0.13758261703083624
Bond Position:  [-7.37742547]


portfolio before change:  [6.60356736]
curr_Stock_Price:  101.62559315563986
curr_Factors:  [101.62559316]
mat_Sqrt:  [[0.15]]
grads:  [-0.00376513]
Stock Position:  -0.0037651329432348774
Bond Position:  [6.98620123]


portfolio before change:  [6.60281499]
curr_Stock_Price:  102.05737065027115
curr_Factors:  [102.05737065]
mat_Sqrt:  [[0.15]]
grads:  [0.04838525]
Stock Position:  0.04838525327564832
Bond Position:  [1.66474326]


portfolio before change:  [6.64562931]
curr_Stock_Price:  102.93793260826888
curr_Factors:  [102.93793261]
mat_Sqrt:  [[0.15]]
grads:  [0.08328207]
Stock Position:  0.08328207409277893
Bond Position:  [-1.92725522]


portfolio before change:  [6.71382638]
curr_Stock_Price:  103.75969396835065
curr_Factors:  [103.75969397]
mat_Sqrt:  [[0.15]]
grads:  [0.14304193]
Stock Position:  0.14304193036639812
Bond Position:  [-8.12816054]


portfolio before change:  [6.64903162]
curr_Stock_Price:  103.31381995639777
curr_Factors:  [103.31381996]
mat_Sqrt:  [[0.15]]
grads:  [-0.03193081]
Stock Position:  -0.03193080525706736
Bond Position:  [9.94792508]


portfolio before change:  [6.68921915]
curr_Stock_Price:  102.0941838539784
curr_Factors:  [102.09418385]
mat_Sqrt:  [[0.15]]
grads:  [-0.07813357]
Stock Position:  -0.07813357007542181
Bond Position:  [14.66620222]


portfolio before change:  [6.60333064]
curr_Stock_Price:  103.21690092463747
curr_Factors:  [103.21690092]
mat_Sqrt:  [[0.15]]
grads:  [0.04133775]
Stock Position:  0.04133774713272796
Bond Position:  [2.33657649]


portfolio before change:  [6.5978521]
curr_Stock_Price:  103.07730361371492
curr_Factors:  [103.07730361]
mat_Sqrt:  [[0.15]]
grads:  [-0.00630139]
Stock Position:  -0.006301390256848496
Bond Position:  [7.24738241]


portfolio before change:  [6.59308886]
curr_Stock_Price:  103.97697978382126
curr_Factors:  [103.97697978]
mat_Sqrt:  [[0.15]]
grads:  [-0.19797164]
Stock Position:  -0.1979716364945956
Bond Position:  [27.17758171]


portfolio before change:  [6.52634149]
curr_Stock_Price:  104.33129714035748
curr_Factors:  [104.33129714]
mat_Sqrt:  [[0.15]]
grads:  [0.03245904]
Stock Position:  0.03245904401421639
Bond Position:  [3.13984732]


portfolio before change:  [6.49413384]
curr_Stock_Price:  103.32694989563946
curr_Factors:  [103.3269499]
mat_Sqrt:  [[0.15]]
grads:  [-0.01952743]
Stock Position:  -0.01952742848202115
Bond Position:  [8.51184347]


portfolio before change:  [6.50515349]
curr_Stock_Price:  102.8171235010819
curr_Factors:  [102.8171235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01178806]
Stock Position:  -0.011788062343843683
Bond Position:  [7.71716815]


portfolio before change:  [6.51244853]
curr_Stock_Price:  102.28011118357546
curr_Factors:  [102.28011118]
mat_Sqrt:  [[0.15]]
grads:  [-0.01685377]
Stock Position:  -0.0168537693702876
Bond Position:  [8.23625393]


portfolio before change:  [6.51128579]
curr_Stock_Price:  102.41019096326008
curr_Factors:  [102.41019096]
mat_Sqrt:  [[0.15]]
grads:  [-0.00517758]
Stock Position:  -0.0051775751433049
Bond Position:  [7.04152225]


portfolio before change:  [6.51103486]
curr_Stock_Price:  102.62866766090929
curr_Factors:  [102.62866766]
mat_Sqrt:  [[0.15]]
grads:  [-0.20566842]
Stock Position:  -0.20566842359890034
Bond Position:  [27.61851115]


portfolio before change:  [6.48606985]
curr_Stock_Price:  102.76683927896963
curr_Factors:  [102.76683928]
mat_Sqrt:  [[0.15]]
grads:  [0.03198422]
Stock Position:  0.03198421950971065
Bond Position:  [3.1991527]


portfolio before change:  [6.48038749]
curr_Stock_Price:  102.5766743702548
curr_Factors:  [102.57667437]
mat_Sqrt:  [[0.15]]
grads:  [0.05598215]
Stock Position:  0.05598214918079162
Bond Position:  [0.7379248]


portfolio before change:  [6.50416303]
curr_Stock_Price:  102.99972518451123
curr_Factors:  [102.99972518]
mat_Sqrt:  [[0.15]]
grads:  [-0.03635724]
Stock Position:  -0.036357244090584204
Bond Position:  [10.24894918]


portfolio before change:  [6.55435986]
curr_Stock_Price:  101.65430891471544
curr_Factors:  [101.65430891]
mat_Sqrt:  [[0.15]]
grads:  [-0.04305948]
Stock Position:  -0.04305948312555803
Bond Position:  [10.93154186]


portfolio before change:  [6.52339858]
curr_Stock_Price:  102.40507985204304
curr_Factors:  [102.40507985]
mat_Sqrt:  [[0.15]]
grads:  [-0.00580551]
Stock Position:  -0.00580551195864723
Bond Position:  [7.11791249]


portfolio before change:  [6.52654875]
curr_Stock_Price:  102.0157285712689
curr_Factors:  [102.01572857]
mat_Sqrt:  [[0.15]]
grads:  [-0.09919675]
Stock Position:  -0.09919674589128609
Bond Position:  [16.64617706]


portfolio before change:  [6.53403694]
curr_Stock_Price:  101.96121790566636
curr_Factors:  [101.96121791]
mat_Sqrt:  [[0.15]]
grads:  [-0.05884805]
Stock Position:  -0.05884805096398253
Bond Position:  [12.53425588]


portfolio before change:  [6.56827374]
curr_Stock_Price:  101.40606063967826
curr_Factors:  [101.40606064]
mat_Sqrt:  [[0.15]]
grads:  [0.14822054]
Stock Position:  0.14822054421344646
Bond Position:  [-8.46218776]


portfolio before change:  [6.72958127]
curr_Stock_Price:  102.501491591725
curr_Factors:  [102.50149159]
mat_Sqrt:  [[0.15]]
grads:  [-0.0331592]
Stock Position:  -0.03315920484100776
Bond Position:  [10.12844923]


portfolio before change:  [6.76206073]
curr_Stock_Price:  101.56017456048629
curr_Factors:  [101.56017456]
mat_Sqrt:  [[0.15]]
grads:  [0.04194231]
Stock Position:  0.04194231092520702
Bond Position:  [2.50239231]


portfolio before change:  [6.7666836]
curr_Stock_Price:  101.66293587525857
curr_Factors:  [101.66293588]
mat_Sqrt:  [[0.15]]
grads:  [-0.08380986]
Stock Position:  -0.08380985720156406
Bond Position:  [15.28703974]


portfolio before change:  [6.81060668]
curr_Stock_Price:  101.16165733496769
curr_Factors:  [101.16165733]
mat_Sqrt:  [[0.15]]
grads:  [-0.0407522]
Stock Position:  -0.04075219922140245
Bond Position:  [10.93316669]


portfolio before change:  [6.75528279]
curr_Stock_Price:  102.55276318253225
curr_Factors:  [102.55276318]
mat_Sqrt:  [[0.15]]
grads:  [-0.03680294]
Stock Position:  -0.03680293517994627
Bond Position:  [10.52952548]


portfolio before change:  [6.80197485]
curr_Stock_Price:  101.31982376697087
curr_Factors:  [101.31982377]
mat_Sqrt:  [[0.15]]
grads:  [-0.04190103]
Stock Position:  -0.04190103190899362
Bond Position:  [11.04738002]


portfolio before change:  [6.77870487]
curr_Stock_Price:  101.9081382676295
curr_Factors:  [101.90813827]
mat_Sqrt:  [[0.15]]
grads:  [0.15457265]
Stock Position:  0.15457264911729132
Bond Position:  [-8.97350602]


portfolio before change:  [6.69355973]
curr_Stock_Price:  101.36455317505278
curr_Factors:  [101.36455318]
mat_Sqrt:  [[0.15]]
grads:  [0.02789429]
Stock Position:  0.02789428974841932
Bond Position:  [3.86606751]


portfolio before change:  [6.68747229]
curr_Stock_Price:  101.12899520683783
curr_Factors:  [101.12899521]
mat_Sqrt:  [[0.15]]
grads:  [0.15383658]
Stock Position:  0.15383658461805716
Bond Position:  [-8.86986693]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.68747229]
Stock Price:  100.67407075589533
PL:  [6.01340154]
Settle:  Tensor("sub_380:0", shape=(), dtype=float64)
PL:  Tensor("sub_381:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  191
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.39333680e-03]
 [-6.33736452e-03]
 [-5.47613476e-03]
 [-9.74631533e-03]
 [ 1.40186171e-02]
 [ 2.18547546e-02]
 [ 1.75967436e-02]
 [-4.66067781e-03]
 [ 1.76386877e-02]
 [-4.23641242e-03]
 [ 4.53214378e-03]
 [ 1.03941933e-02]
 [-8.17027338e-03]
 [ 1.26496993e-02]
 [-6.79476024e-03]
 [-2.75901512e-02]
 [ 3.99050124e-03]
 [ 2.31514043e-03]
 [-1.17799551e-02]
 [-2.22315296e-03]
 [-9.96490096e-06]
 [-2.64223764e-02]
 [ 4.78447696e-03]
 [ 7.12246693e-03]
 [-3.97791210e-03]
 [-6.74921031e-03]
 [-7.42965160e-03]
 [-1.95388538e-02]
 [-2.94458751e-02]
 [ 2.19015771e-02]
 [ 3.56236758e-03]
 [-5.42175096e-03]
 [-1.25246078e-02]
 [-9.56906889e-03]
 [-6.52339393e-03]
 [-6.21557685e-03]
 [ 1.99703415e-02]
 [ 8.25484446e-03]
 [ 2.41755796e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-13.02964719]
curr_Stock_Price:  99.03562773360967
curr_Factors:  [99.03562773]
mat_Sqrt:  [[0.15]]
grads:  [-0.03595558]
Stock Position:  -0.03595557866565936
Bond Position:  [-9.46876389]


portfolio before change:  [-13.00952306]
curr_Stock_Price:  98.44301312721456
curr_Factors:  [98.44301313]
mat_Sqrt:  [[0.15]]
grads:  [-0.0422491]
Stock Position:  -0.04224909678993731
Bond Position:  [-8.85039467]


portfolio before change:  [-13.04713316]
curr_Stock_Price:  99.30702522871485
curr_Factors:  [99.30702523]
mat_Sqrt:  [[0.15]]
grads:  [-0.03650757]
Stock Position:  -0.03650756505390667
Bond Position:  [-9.42167547]


portfolio before change:  [-13.04865203]
curr_Stock_Price:  99.31636816847838
curr_Factors:  [99.31636817]
mat_Sqrt:  [[0.15]]
grads:  [-0.06497544]
Stock Position:  -0.06497543552209127
Bond Position:  [-6.59552775]


portfolio before change:  [-13.02356619]
curr_Stock_Price:  98.91759697379807
curr_Factors:  [98.91759697]
mat_Sqrt:  [[0.15]]
grads:  [0.09345745]
Stock Position:  0.0934574473138927
Bond Position:  [-22.2681523]


portfolio before change:  [-13.0424409]
curr_Stock_Price:  98.74542214991061
curr_Factors:  [98.74542215]
mat_Sqrt:  [[0.15]]
grads:  [0.14569836]
Stock Position:  0.145698363989052
Bond Position:  [-27.42948736]


portfolio before change:  [-13.02567971]
curr_Stock_Price:  98.88399675805233
curr_Factors:  [98.88399676]
mat_Sqrt:  [[0.15]]
grads:  [0.11731162]
Stock Position:  0.11731162409510647
Bond Position:  [-24.62592196]


portfolio before change:  [-13.10382414]
curr_Stock_Price:  98.24411135615922
curr_Factors:  [98.24411136]
mat_Sqrt:  [[0.15]]
grads:  [-0.03107119]
Stock Position:  -0.03107118539233738
Bond Position:  [-10.05126314]


portfolio before change:  [-13.13032186]
curr_Stock_Price:  99.05647951059728
curr_Factors:  [99.05647951]
mat_Sqrt:  [[0.15]]
grads:  [0.11759125]
Stock Position:  0.11759125107491673
Bond Position:  [-24.77849722]


portfolio before change:  [-13.05638802]
curr_Stock_Price:  99.71155676930906
curr_Factors:  [99.71155677]
mat_Sqrt:  [[0.15]]
grads:  [-0.02824275]
Stock Position:  -0.028242749490707954
Bond Position:  [-10.2402595]


portfolio before change:  [-13.05281835]
curr_Stock_Price:  99.53983928615098
curr_Factors:  [99.53983929]
mat_Sqrt:  [[0.15]]
grads:  [0.03021429]
Stock Position:  0.03021429188143465
Bond Position:  [-16.06034411]


portfolio before change:  [-13.05271006]
curr_Stock_Price:  99.60987121989363
curr_Factors:  [99.60987122]
mat_Sqrt:  [[0.15]]
grads:  [0.06929462]
Stock Position:  0.06929462185222769
Bond Position:  [-19.95513842]


portfolio before change:  [-13.04208029]
curr_Stock_Price:  99.79926991940748
curr_Factors:  [99.79926992]
mat_Sqrt:  [[0.15]]
grads:  [-0.05446849]
Stock Position:  -0.05446848917081383
Bond Position:  [-7.60616484]


portfolio before change:  [-13.08393085]
curr_Stock_Price:  100.55015783901737
curr_Factors:  [100.55015784]
mat_Sqrt:  [[0.15]]
grads:  [0.08433133]
Stock Position:  0.08433132835544066
Bond Position:  [-21.56345923]


portfolio before change:  [-13.06675753]
curr_Stock_Price:  100.7857633539586
curr_Factors:  [100.78576335]
mat_Sqrt:  [[0.15]]
grads:  [-0.0452984]
Stock Position:  -0.04529840163054681
Bond Position:  [-8.50132354]


portfolio before change:  [-13.10917601]
curr_Stock_Price:  101.69872602874801
curr_Factors:  [101.69872603]
mat_Sqrt:  [[0.15]]
grads:  [-0.18393434]
Stock Position:  -0.1839343410514065
Bond Position:  [5.59671215]


portfolio before change:  [-13.16579368]
curr_Stock_Price:  102.0103443227837
curr_Factors:  [102.01034432]
mat_Sqrt:  [[0.15]]
grads:  [0.02660334]
Stock Position:  0.026603341611271848
Bond Position:  [-15.87960972]


portfolio before change:  [-13.17388623]
curr_Stock_Price:  101.78076903132614
curr_Factors:  [101.78076903]
mat_Sqrt:  [[0.15]]
grads:  [0.01543427]
Stock Position:  0.015434269500164535
Bond Position:  [-14.74479805]


portfolio before change:  [-13.19389443]
curr_Stock_Price:  100.60384364842524
curr_Factors:  [100.60384365]
mat_Sqrt:  [[0.15]]
grads:  [-0.07853303]
Stock Position:  -0.07853303410395529
Bond Position:  [-5.29316934]


portfolio before change:  [-13.17035403]
curr_Stock_Price:  100.29566657020482
curr_Factors:  [100.29566657]
mat_Sqrt:  [[0.15]]
grads:  [-0.01482102]
Stock Position:  -0.014821019738312473
Bond Position:  [-11.68386998]


portfolio before change:  [-13.18863706]
curr_Stock_Price:  101.4307066349049
curr_Factors:  [101.43070663]
mat_Sqrt:  [[0.15]]
grads:  [-6.64326731e-05]
Stock Position:  -6.643267307097651e-05
Bond Position:  [-13.18189875]


portfolio before change:  [-13.19032866]
curr_Stock_Price:  102.08940786143059
curr_Factors:  [102.08940786]
mat_Sqrt:  [[0.15]]
grads:  [-0.17614918]
Stock Position:  -0.17614917568963362
Bond Position:  [4.79263638]


portfolio before change:  [-13.09727189]
curr_Stock_Price:  101.56452517722511
curr_Factors:  [101.56452518]
mat_Sqrt:  [[0.15]]
grads:  [0.03189651]
Stock Position:  0.031896513082633214
Bond Position:  [-16.3368261]


portfolio before change:  [-13.11779617]
curr_Stock_Price:  100.98508738519905
curr_Factors:  [100.98508739]
mat_Sqrt:  [[0.15]]
grads:  [0.04748311]
Stock Position:  0.04748311289569184
Bond Position:  [-17.91288247]


portfolio before change:  [-13.17372916]
curr_Stock_Price:  99.85429076066954
curr_Factors:  [99.85429076]
mat_Sqrt:  [[0.15]]
grads:  [-0.02651941]
Stock Position:  -0.026519414011424193
Bond Position:  [-10.52565188]


portfolio before change:  [-13.14795414]
curr_Stock_Price:  98.83274460560315
curr_Factors:  [98.83274461]
mat_Sqrt:  [[0.15]]
grads:  [-0.04499474]
Stock Position:  -0.044994735388354676
Bond Position:  [-8.70100095]


portfolio before change:  [-13.08680735]
curr_Stock_Price:  97.44959409068113
curr_Factors:  [97.44959409]
mat_Sqrt:  [[0.15]]
grads:  [-0.04953101]
Stock Position:  -0.049531010697797896
Bond Position:  [-8.26003046]


portfolio before change:  [-13.06910727]
curr_Stock_Price:  97.07139382981507
curr_Factors:  [97.07139383]
mat_Sqrt:  [[0.15]]
grads:  [-0.13025903]
Stock Position:  -0.1302590250024304
Bond Position:  [-0.42468216]


portfolio before change:  [-13.01715978]
curr_Stock_Price:  96.6721848044148
curr_Factors:  [96.6721848]
mat_Sqrt:  [[0.15]]
grads:  [-0.19630583]
Stock Position:  -0.1963058340202228
Bond Position:  [5.96015408]


portfolio before change:  [-13.05883235]
curr_Stock_Price:  96.88826410824976
curr_Factors:  [96.88826411]
mat_Sqrt:  [[0.15]]
grads:  [0.14601051]
Stock Position:  0.14601051429857936
Bond Position:  [-27.20553762]


portfolio before change:  [-12.9976458]
curr_Stock_Price:  97.33061206980634
curr_Factors:  [97.33061207]
mat_Sqrt:  [[0.15]]
grads:  [0.02374912]
Stock Position:  0.02374911720115809
Bond Position:  [-15.30916191]


portfolio before change:  [-13.00682373]
curr_Stock_Price:  97.02474110708046
curr_Factors:  [97.02474111]
mat_Sqrt:  [[0.15]]
grads:  [-0.03614501]
Stock Position:  -0.03614500640271231
Bond Position:  [-9.49986384]


portfolio before change:  [-13.00138879]
curr_Stock_Price:  96.84152084985095
curr_Factors:  [96.84152085]
mat_Sqrt:  [[0.15]]
grads:  [-0.08349739]
Stock Position:  -0.08349738537737135
Bond Position:  [-4.915375]


portfolio before change:  [-12.94996599]
curr_Stock_Price:  96.21830059720342
curr_Factors:  [96.2183006]
mat_Sqrt:  [[0.15]]
grads:  [-0.06379379]
Stock Position:  -0.06379379257663365
Bond Position:  [-6.81183568]


portfolio before change:  [-12.94869134]
curr_Stock_Price:  96.18497171673138
curr_Factors:  [96.18497172]
mat_Sqrt:  [[0.15]]
grads:  [-0.04348929]
Stock Position:  -0.04348929285600041
Bond Position:  [-8.76567494]


portfolio before change:  [-12.97918261]
curr_Stock_Price:  96.86089637398857
curr_Factors:  [96.86089637]
mat_Sqrt:  [[0.15]]
grads:  [-0.04143718]
Stock Position:  -0.041437178975933894
Bond Position:  [-8.96554031]


portfolio before change:  [-12.96341142]
curr_Stock_Price:  96.45324439068962
curr_Factors:  [96.45324439]
mat_Sqrt:  [[0.15]]
grads:  [0.13313561]
Stock Position:  0.13313560999226826
Bond Position:  [-25.80477295]


portfolio before change:  [-12.73155572]
curr_Stock_Price:  98.21897410059897
curr_Factors:  [98.2189741]
mat_Sqrt:  [[0.15]]
grads:  [0.0550323]
Stock Position:  0.05503229638376114
Bond Position:  [-18.13677141]


portfolio before change:  [-12.61615088]
curr_Stock_Price:  100.35721071787583
curr_Factors:  [100.35721072]
mat_Sqrt:  [[0.15]]
grads:  [0.16117053]
Stock Position:  0.16117053083061708
Bond Position:  [-28.79077581]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-12.61615088]
Stock Price:  101.33810573529281
PL:  [-13.95425662]
Settle:  Tensor("sub_382:0", shape=(), dtype=float64)
PL:  Tensor("sub_383:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  192
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-6.22249121e-03]
 [-4.71374552e-03]
 [-5.59474001e-03]
 [ 3.76523118e-02]
 [ 1.78689481e-02]
 [ 2.31532321e-02]
 [ 9.39877076e-03]
 [-8.94414919e-04]
 [ 3.26567981e-03]
 [ 6.59106709e-03]
 [ 5.59580237e-03]
 [ 1.17303943e-02]
 [-4.34286978e-03]
 [ 1.29585258e-02]
 [-7.36834625e-03]
 [-1.94118706e-02]
 [-2.65533418e-03]
 [-8.15772037e-04]
 [-7.47208179e-03]
 [-2.40759344e-03]
 [ 4.67814161e-04]
 [ 1.19575423e-02]
 [ 4.75841909e-03]
 [ 5.73696450e-03]
 [-1.70531931e-03]
 [-5.92581284e-03]
 [ 5.46379161e-03]
 [-2.17331638e-02]
 [-3.02803737e-02]
 [ 2.19230882e-02]
 [ 3.77621322e-03]
 [-2.27194803e-03]
 [-1.25246778e-02]
 [-5.22046583e-03]
 [-6.00793599e-03]
 [-6.61917198e-03]
 [ 2.28632201e-02]
 [ 7.59688987e-03]
 [ 2.42242666e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [35.91104804]
curr_Stock_Price:  102.18848865568468
curr_Factors:  [102.18848866]
mat_Sqrt:  [[0.15]]
grads:  [-0.04148327]
Stock Position:  -0.04148327472912078
Bond Position:  [40.15016119]


portfolio before change:  [35.95727858]
curr_Stock_Price:  101.19504101941209
curr_Factors:  [101.19504102]
mat_Sqrt:  [[0.15]]
grads:  [-0.03142497]
Stock Position:  -0.031424970150315965
Bond Position:  [39.13732973]


portfolio before change:  [35.95697173]
curr_Stock_Price:  101.36049290195056
curr_Factors:  [101.3604929]
mat_Sqrt:  [[0.15]]
grads:  [-0.03729827]
Stock Position:  -0.037298266762892406
Bond Position:  [39.73754244]


portfolio before change:  [35.95273103]
curr_Stock_Price:  101.6073733220002
curr_Factors:  [101.60737332]
mat_Sqrt:  [[0.15]]
grads:  [0.25101541]
Stock Position:  0.25101541174370257
Bond Position:  [10.44771438]


portfolio before change:  [35.88808172]
curr_Stock_Price:  101.34461911169669
curr_Factors:  [101.34461911]
mat_Sqrt:  [[0.15]]
grads:  [0.11912632]
Stock Position:  0.11912632049507016
Bond Position:  [23.81527014]


portfolio before change:  [35.81864582]
curr_Stock_Price:  100.73675180956766
curr_Factors:  [100.73675181]
mat_Sqrt:  [[0.15]]
grads:  [0.15435488]
Stock Position:  0.1543548806389529
Bond Position:  [20.26943651]


portfolio before change:  [36.02344824]
curr_Stock_Price:  102.0471644416654
curr_Factors:  [102.04716444]
mat_Sqrt:  [[0.15]]
grads:  [0.06265847]
Stock Position:  0.06265847174795751
Bond Position:  [29.62932887]


portfolio before change:  [35.99077764]
curr_Stock_Price:  101.46664441968257
curr_Factors:  [101.46664442]
mat_Sqrt:  [[0.15]]
grads:  [-0.00596277]
Stock Position:  -0.00596276612403639
Bond Position:  [36.59579951]


portfolio before change:  [35.99702634]
curr_Stock_Price:  101.18591288159215
curr_Factors:  [101.18591288]
mat_Sqrt:  [[0.15]]
grads:  [0.0217712]
Stock Position:  0.021771198750251942
Bond Position:  [33.79408772]


portfolio before change:  [35.99164737]
curr_Stock_Price:  100.74480313147014
curr_Factors:  [100.74480313]
mat_Sqrt:  [[0.15]]
grads:  [0.04394045]
Stock Position:  0.043940447288646295
Bond Position:  [31.56487566]


portfolio before change:  [35.93859916]
curr_Stock_Price:  99.4477277693226
curr_Factors:  [99.44772777]
mat_Sqrt:  [[0.15]]
grads:  [0.03730535]
Stock Position:  0.0373053491297568
Bond Position:  [32.22866695]


portfolio before change:  [35.96178166]
curr_Stock_Price:  99.96115722154795
curr_Factors:  [99.96115722]
mat_Sqrt:  [[0.15]]
grads:  [0.07820263]
Stock Position:  0.07820262891472662
Bond Position:  [28.14455637]


portfolio before change:  [35.90526417]
curr_Stock_Price:  99.19346204865326
curr_Factors:  [99.19346205]
mat_Sqrt:  [[0.15]]
grads:  [-0.02895247]
Stock Position:  -0.02895246522711365
Bond Position:  [38.77715943]


portfolio before change:  [35.87315026]
curr_Stock_Price:  100.47008403638263
curr_Factors:  [100.47008404]
mat_Sqrt:  [[0.15]]
grads:  [0.08639017]
Stock Position:  0.08639017223480717
Bond Position:  [27.1935224]


portfolio before change:  [35.92502123]
curr_Stock_Price:  101.03116141219388
curr_Factors:  [101.03116141]
mat_Sqrt:  [[0.15]]
grads:  [-0.04912231]
Stock Position:  -0.049122308366080246
Bond Position:  [40.8879051]


portfolio before change:  [35.96415239]
curr_Stock_Price:  100.33860743331795
curr_Factors:  [100.33860743]
mat_Sqrt:  [[0.15]]
grads:  [-0.12941247]
Stock Position:  -0.1294124708461748
Bond Position:  [48.9492195]


portfolio before change:  [36.17124571]
curr_Stock_Price:  98.78563284852545
curr_Factors:  [98.78563285]
mat_Sqrt:  [[0.15]]
grads:  [-0.01770223]
Stock Position:  -0.017702227889796612
Bond Position:  [37.91997149]


portfolio before change:  [36.19680481]
curr_Stock_Price:  97.60957703186938
curr_Factors:  [97.60957703]
mat_Sqrt:  [[0.15]]
grads:  [-0.00543848]
Stock Position:  -0.0054384802441648965
Bond Position:  [36.72765256]


portfolio before change:  [36.19630287]
curr_Stock_Price:  98.5460849829021
curr_Factors:  [98.54608498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04981388]
Stock Position:  -0.04981387858313902
Bond Position:  [41.10526558]


portfolio before change:  [36.24253438]
curr_Stock_Price:  97.72115371701047
curr_Factors:  [97.72115372]
mat_Sqrt:  [[0.15]]
grads:  [-0.01605062]
Stock Position:  -0.01605062295520789
Bond Position:  [37.81101977]


portfolio before change:  [36.25108265]
curr_Stock_Price:  97.4830566426138
curr_Factors:  [97.48305664]
mat_Sqrt:  [[0.15]]
grads:  [0.00311876]
Stock Position:  0.003118761074967206
Bond Position:  [35.94705629]


portfolio before change:  [36.25474271]
curr_Stock_Price:  97.2157696895025
curr_Factors:  [97.21576969]
mat_Sqrt:  [[0.15]]
grads:  [0.07971695]
Stock Position:  0.07971694833490933
Bond Position:  [28.50499822]


portfolio before change:  [36.25521313]
curr_Stock_Price:  97.1769707317157
curr_Factors:  [97.17697073]
mat_Sqrt:  [[0.15]]
grads:  [0.03172279]
Stock Position:  0.03172279395104486
Bond Position:  [33.17248811]


portfolio before change:  [36.29065032]
curr_Stock_Price:  98.16333949863316
curr_Factors:  [98.1633395]
mat_Sqrt:  [[0.15]]
grads:  [0.03824643]
Stock Position:  0.038246429981318684
Bond Position:  [32.53625303]


portfolio before change:  [36.272112]
curr_Stock_Price:  97.57228813528849
curr_Factors:  [97.57228814]
mat_Sqrt:  [[0.15]]
grads:  [-0.0113688]
Stock Position:  -0.01136879540061106
Bond Position:  [37.38139138]


portfolio before change:  [36.26721498]
curr_Stock_Price:  98.41406477572363
curr_Factors:  [98.41406478]
mat_Sqrt:  [[0.15]]
grads:  [-0.03950542]
Stock Position:  -0.039505418909733185
Bond Position:  [40.15510384]


portfolio before change:  [36.24882777]
curr_Stock_Price:  99.00656361691148
curr_Factors:  [99.00656362]
mat_Sqrt:  [[0.15]]
grads:  [0.03642528]
Stock Position:  0.036425277405201614
Bond Position:  [32.64248622]


portfolio before change:  [36.22504645]
curr_Stock_Price:  98.24165855202627
curr_Factors:  [98.24165855]
mat_Sqrt:  [[0.15]]
grads:  [-0.14488776]
Stock Position:  -0.1448877589157442
Bond Position:  [50.45906019]


portfolio before change:  [36.37504363]
curr_Stock_Price:  97.24992948041248
curr_Factors:  [97.24992948]
mat_Sqrt:  [[0.15]]
grads:  [-0.20186916]
Stock Position:  -0.20186915797787552
Bond Position:  [56.00680501]


portfolio before change:  [36.41100896]
curr_Stock_Price:  97.10645019080961
curr_Factors:  [97.10645019]
mat_Sqrt:  [[0.15]]
grads:  [0.14615392]
Stock Position:  0.14615392128582028
Bond Position:  [22.21852049]


portfolio before change:  [36.53391103]
curr_Stock_Price:  97.92835474076618
curr_Factors:  [97.92835474]
mat_Sqrt:  [[0.15]]
grads:  [0.02517475]
Stock Position:  0.02517475479712364
Bond Position:  [34.06858871]


portfolio before change:  [36.55171268]
curr_Stock_Price:  98.4663070782222
curr_Factors:  [98.46630708]
mat_Sqrt:  [[0.15]]
grads:  [-0.01514632]
Stock Position:  -0.015146320196390709
Bond Position:  [38.0431149]


portfolio before change:  [36.53920299]
curr_Stock_Price:  99.60621309837803
curr_Factors:  [99.6062131]
mat_Sqrt:  [[0.15]]
grads:  [-0.08349785]
Stock Position:  -0.08349785176819458
Bond Position:  [44.85610781]


portfolio before change:  [36.47962966]
curr_Stock_Price:  100.38684032142429
curr_Factors:  [100.38684032]
mat_Sqrt:  [[0.15]]
grads:  [-0.03480311]
Stock Position:  -0.03480310553516965
Bond Position:  [39.97340345]


portfolio before change:  [36.47925788]
curr_Stock_Price:  100.54110144829599
curr_Factors:  [100.54110145]
mat_Sqrt:  [[0.15]]
grads:  [-0.04005291]
Stock Position:  -0.040052906601178884
Bond Position:  [40.50622122]


portfolio before change:  [36.46208926]
curr_Stock_Price:  101.09617263452898
curr_Factors:  [101.09617263]
mat_Sqrt:  [[0.15]]
grads:  [-0.04412781]
Stock Position:  -0.0441278131981706
Bond Position:  [40.92324228]


portfolio before change:  [36.46250219]
curr_Stock_Price:  101.20274472345372
curr_Factors:  [101.20274472]
mat_Sqrt:  [[0.15]]
grads:  [0.15242147]
Stock Position:  0.15242146706286802
Bond Position:  [21.03703137]


portfolio before change:  [36.25385472]
curr_Stock_Price:  99.81660623954762
curr_Factors:  [99.81660624]
mat_Sqrt:  [[0.15]]
grads:  [0.05064593]
Stock Position:  0.050645932482327696
Bond Position:  [31.19854962]


portfolio before change:  [36.28258511]
curr_Stock_Price:  100.30687906381102
curr_Factors:  [100.30687906]
mat_Sqrt:  [[0.15]]
grads:  [0.16149511]
Stock Position:  0.1614951106171145
Bond Position:  [20.08351458]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [36.28258511]
Stock Price:  100.28871849188839
PL:  [35.99386662]
Settle:  Tensor("sub_384:0", shape=(), dtype=float64)
PL:  Tensor("sub_385:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  193
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-5.31957156e-03]
 [ 8.65578359e-04]
 [-3.78586731e-02]
 [-2.26352558e-02]
 [ 1.49235793e-02]
 [ 2.42689156e-02]
 [-4.70348587e-04]
 [-1.26188974e-02]
 [-4.31894587e-03]
 [ 1.86900187e-03]
 [-6.13821847e-02]
 [-6.24233839e-03]
 [ 1.07210948e-02]
 [ 1.73117383e-03]
 [ 1.83125403e-02]
 [-6.33168524e-03]
 [-1.28901599e-02]
 [ 7.08058571e-04]
 [-7.80538343e-03]
 [-3.17127301e-03]
 [ 1.19041778e-03]
 [ 9.05425503e-04]
 [ 4.75501350e-03]
 [ 5.42603215e-03]
 [ 1.60492898e-03]
 [-1.19506217e-03]
 [ 9.54731328e-03]
 [-1.96066008e-02]
 [-2.11872839e-02]
 [ 2.17391345e-02]
 [ 2.61733194e-03]
 [-1.02865744e-02]
 [-1.24094238e-02]
 [-9.40575687e-03]
 [-7.16727493e-03]
 [-6.75197307e-03]
 [ 2.14274018e-02]
 [ 8.93167869e-03]
 [ 1.98955784e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-11.72900649]
curr_Stock_Price:  99.11941770042274
curr_Factors:  [99.1194177]
mat_Sqrt:  [[0.15]]
grads:  [-0.03546381]
Stock Position:  -0.035463810391961045
Bond Position:  [-8.21385426]


portfolio before change:  [-11.73212832]
curr_Stock_Price:  99.17849279238398
curr_Factors:  [99.17849279]
mat_Sqrt:  [[0.15]]
grads:  [0.00577052]
Stock Position:  0.005770522391074376
Bond Position:  [-12.30444003]


portfolio before change:  [-11.7416427]
curr_Stock_Price:  97.7962549852101
curr_Factors:  [97.79625499]
mat_Sqrt:  [[0.15]]
grads:  [-0.25239115]
Stock Position:  -0.2523911537476121
Bond Position:  [12.94126693]


portfolio before change:  [-11.93093517]
curr_Stock_Price:  98.5526611728332
curr_Factors:  [98.55266117]
mat_Sqrt:  [[0.15]]
grads:  [-0.15090171]
Stock Position:  -0.15090170505023145
Bond Position:  [2.94082944]


portfolio before change:  [-11.91834735]
curr_Stock_Price:  98.47168001001613
curr_Factors:  [98.47168001]
mat_Sqrt:  [[0.15]]
grads:  [0.09949053]
Stock Position:  0.09949052876230952
Bond Position:  [-21.71534686]


portfolio before change:  [-12.02257006]
curr_Stock_Price:  97.45140077839494
curr_Factors:  [97.45140078]
mat_Sqrt:  [[0.15]]
grads:  [0.16179277]
Stock Position:  0.16179277085852875
Bond Position:  [-27.78950221]


portfolio before change:  [-12.25025226]
curr_Stock_Price:  96.06562627031775
curr_Factors:  [96.06562627]
mat_Sqrt:  [[0.15]]
grads:  [-0.00313566]
Stock Position:  -0.0031356572460853466
Bond Position:  [-11.94902338]


portfolio before change:  [-12.25090085]
curr_Stock_Price:  95.79610430010327
curr_Factors:  [95.7961043]
mat_Sqrt:  [[0.15]]
grads:  [-0.08412598]
Stock Position:  -0.08412598296764759
Bond Position:  [-4.19195941]


portfolio before change:  [-12.28233264]
curr_Stock_Price:  96.1635027958151
curr_Factors:  [96.1635028]
mat_Sqrt:  [[0.15]]
grads:  [-0.02879297]
Stock Position:  -0.028792972444808707
Bond Position:  [-9.51349955]


portfolio before change:  [-12.29306665]
curr_Stock_Price:  96.49499848092249
curr_Factors:  [96.49499848]
mat_Sqrt:  [[0.15]]
grads:  [0.01246001]
Stock Position:  0.01246001249229083
Bond Position:  [-13.49539554]


portfolio before change:  [-12.29458619]
curr_Stock_Price:  96.50844026047024
curr_Factors:  [96.50844026]
mat_Sqrt:  [[0.15]]
grads:  [-0.40921456]
Stock Position:  -0.4092145645090163
Bond Position:  [27.19807316]


portfolio before change:  [-12.64775218]
curr_Stock_Price:  97.37978256159599
curr_Factors:  [97.37978256]
mat_Sqrt:  [[0.15]]
grads:  [-0.04161559]
Stock Position:  -0.041615589285387444
Bond Position:  [-8.59523515]


portfolio before change:  [-12.61715189]
curr_Stock_Price:  96.61865527632389
curr_Factors:  [96.61865528]
mat_Sqrt:  [[0.15]]
grads:  [0.07147397]
Stock Position:  0.07147396565798478
Bond Position:  [-19.52287034]


portfolio before change:  [-12.68470764]
curr_Stock_Price:  95.70762098272085
curr_Factors:  [95.70762098]
mat_Sqrt:  [[0.15]]
grads:  [0.01154116]
Stock Position:  0.011541158861283665
Bond Position:  [-13.7892845]


portfolio before change:  [-12.69342212]
curr_Stock_Price:  95.1019011899684
curr_Factors:  [95.10190119]
mat_Sqrt:  [[0.15]]
grads:  [0.1220836]
Stock Position:  0.12208360215359579
Bond Position:  [-24.30380478]


portfolio before change:  [-12.67423588]
curr_Stock_Price:  95.28394364088773
curr_Factors:  [95.28394364]
mat_Sqrt:  [[0.15]]
grads:  [-0.04221123]
Stock Position:  -0.042211234915240196
Bond Position:  [-8.65218295]


portfolio before change:  [-12.62718089]
curr_Stock_Price:  94.14356994215235
curr_Factors:  [94.14356994]
mat_Sqrt:  [[0.15]]
grads:  [-0.0859344]
Stock Position:  -0.08593439919180562
Bond Position:  [-4.53700977]


portfolio before change:  [-12.60417879]
curr_Stock_Price:  93.86929958872567
curr_Factors:  [93.86929959]
mat_Sqrt:  [[0.15]]
grads:  [0.00472039]
Stock Position:  0.00472039047268402
Bond Position:  [-13.04727854]


portfolio before change:  [-12.60702982]
curr_Stock_Price:  93.61084251739925
curr_Factors:  [93.61084252]
mat_Sqrt:  [[0.15]]
grads:  [-0.05203589]
Stock Position:  -0.05203588951518536
Bond Position:  [-7.73590637]


portfolio before change:  [-12.57769739]
curr_Stock_Price:  93.02856201815473
curr_Factors:  [93.02856202]
mat_Sqrt:  [[0.15]]
grads:  [-0.02114182]
Stock Position:  -0.02114182004605656
Bond Position:  [-10.61090427]


portfolio before change:  [-12.6043461]
curr_Stock_Price:  94.22629551055016
curr_Factors:  [94.22629551]
mat_Sqrt:  [[0.15]]
grads:  [0.00793612]
Stock Position:  0.007936118510728453
Bond Position:  [-13.35213715]


portfolio before change:  [-12.60831236]
curr_Stock_Price:  93.93684169342158
curr_Factors:  [93.93684169]
mat_Sqrt:  [[0.15]]
grads:  [0.00603617]
Stock Position:  0.006036170017774574
Bond Position:  [-13.17533111]


portfolio before change:  [-12.60706015]
curr_Stock_Price:  94.41715167846695
curr_Factors:  [94.41715168]
mat_Sqrt:  [[0.15]]
grads:  [0.03170009]
Stock Position:  0.031700089970581394
Bond Position:  [-15.60009235]


portfolio before change:  [-12.55602353]
curr_Stock_Price:  96.08865346508072
curr_Factors:  [96.08865347]
mat_Sqrt:  [[0.15]]
grads:  [0.03617355]
Stock Position:  0.03617354767027743
Bond Position:  [-16.03189101]


portfolio before change:  [-12.57597148]
curr_Stock_Price:  95.59260473667558
curr_Factors:  [95.59260474]
mat_Sqrt:  [[0.15]]
grads:  [0.01069953]
Stock Position:  0.010699526539906645
Bond Position:  [-13.59876709]


portfolio before change:  [-12.59039344]
curr_Stock_Price:  94.40357973903359
curr_Factors:  [94.40357974]
mat_Sqrt:  [[0.15]]
grads:  [-0.00796708]
Stock Position:  -0.007967081143786282
Bond Position:  [-11.83827246]


portfolio before change:  [-12.59070171]
curr_Stock_Price:  94.25652482412409
curr_Factors:  [94.25652482]
mat_Sqrt:  [[0.15]]
grads:  [0.06364876]
Stock Position:  0.06364875521371736
Bond Position:  [-18.59001219]


portfolio before change:  [-12.60224756]
curr_Stock_Price:  94.11163667205689
curr_Factors:  [94.11163667]
mat_Sqrt:  [[0.15]]
grads:  [-0.13071067]
Stock Position:  -0.1307106720443894
Bond Position:  [-0.30085229]


portfolio before change:  [-12.58537918]
curr_Stock_Price:  93.98229764531716
curr_Factors:  [93.98229765]
mat_Sqrt:  [[0.15]]
grads:  [-0.14124856]
Stock Position:  -0.14124855927397906
Bond Position:  [0.68948496]


portfolio before change:  [-12.76058541]
curr_Stock_Price:  95.22331858279074
curr_Factors:  [95.22331858]
mat_Sqrt:  [[0.15]]
grads:  [0.14492756]
Stock Position:  0.14492756310475297
Bond Position:  [-26.56106892]


portfolio before change:  [-12.85795758]
curr_Stock_Price:  94.57436105039689
curr_Factors:  [94.57436105]
mat_Sqrt:  [[0.15]]
grads:  [0.01744888]
Stock Position:  0.017448879595027278
Bond Position:  [-14.50817422]


portfolio before change:  [-12.8645273]
curr_Stock_Price:  94.30178881022344
curr_Factors:  [94.30178881]
mat_Sqrt:  [[0.15]]
grads:  [-0.06857716]
Stock Position:  -0.06857716268364009
Bond Position:  [-6.39757819]


portfolio before change:  [-12.94504234]
curr_Stock_Price:  95.46420638449045
curr_Factors:  [95.46420638]
mat_Sqrt:  [[0.15]]
grads:  [-0.08272949]
Stock Position:  -0.0827294923146027
Bond Position:  [-5.04733702]


portfolio before change:  [-12.99491894]
curr_Stock_Price:  96.05946734821288
curr_Factors:  [96.05946735]
mat_Sqrt:  [[0.15]]
grads:  [-0.06270505]
Stock Position:  -0.06270504576988772
Bond Position:  [-6.97150564]


portfolio before change:  [-13.0562266]
curr_Stock_Price:  97.02328402420015
curr_Factors:  [97.02328402]
mat_Sqrt:  [[0.15]]
grads:  [-0.04778183]
Stock Position:  -0.04778183286520611
Bond Position:  [-8.42027626]


portfolio before change:  [-13.07136894]
curr_Stock_Price:  97.31816054686588
curr_Factors:  [97.31816055]
mat_Sqrt:  [[0.15]]
grads:  [-0.04501315]
Stock Position:  -0.04501315377945674
Bond Position:  [-8.69077161]


portfolio before change:  [-13.10293874]
curr_Stock_Price:  97.99537109386995
curr_Factors:  [97.99537109]
mat_Sqrt:  [[0.15]]
grads:  [0.14284935]
Stock Position:  0.14284934551816644
Bond Position:  [-27.10151336]


portfolio before change:  [-13.26030597]
curr_Stock_Price:  96.91745692166369
curr_Factors:  [96.91745692]
mat_Sqrt:  [[0.15]]
grads:  [0.05954452]
Stock Position:  0.05954452459772365
Bond Position:  [-19.03120987]


portfolio before change:  [-13.35138733]
curr_Stock_Price:  95.42777660677486
curr_Factors:  [95.42777661]
mat_Sqrt:  [[0.15]]
grads:  [0.13263719]
Stock Position:  0.13263718946599906
Bond Position:  [-26.00865941]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-13.35138733]
Stock Price:  95.49170116929523
PL:  [-13.35138733]
Settle:  Tensor("sub_386:0", shape=(), dtype=float64)
PL:  Tensor("sub_387:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  194
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.45070821e-03]
 [-1.14098804e-02]
 [-4.08403406e-03]
 [ 5.84828768e-02]
 [ 1.77163775e-02]
 [ 2.86147933e-02]
 [ 7.89708862e-03]
 [ 8.23546848e-04]
 [ 6.13919761e-03]
 [ 9.97491249e-03]
 [ 2.05461763e-02]
 [ 1.03420745e-02]
 [-1.16930185e-02]
 [ 1.16838710e-02]
 [-6.43082188e-03]
 [-2.62034327e-02]
 [-2.04410116e-03]
 [-3.05036787e-03]
 [-7.57027236e-03]
 [-2.36263780e-03]
 [ 3.08251946e-04]
 [ 8.44005891e-03]
 [ 4.76645248e-03]
 [ 6.03138178e-03]
 [-3.43362650e-03]
 [-5.92089052e-03]
 [-5.46794278e-03]
 [-1.96319830e-02]
 [-3.34201181e-02]
 [ 2.20525094e-02]
 [ 3.91105112e-03]
 [-1.98214668e-03]
 [-1.25334854e-02]
 [-9.69282874e-03]
 [-7.10963310e-03]
 [-7.52544381e-03]
 [ 2.26373061e-02]
 [ 7.98026321e-03]
 [ 2.42127370e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [5.88156607]
curr_Stock_Price:  100.25392724917086
curr_Factors:  [100.25392725]
mat_Sqrt:  [[0.15]]
grads:  [-0.00967139]
Stock Position:  -0.009671388080779181
Bond Position:  [6.85116071]


portfolio before change:  [5.87913048]
curr_Stock_Price:  100.59431710465604
curr_Factors:  [100.5943171]
mat_Sqrt:  [[0.15]]
grads:  [-0.07606587]
Stock Position:  -0.07606586924024798
Bond Position:  [13.53092465]


portfolio before change:  [5.80110219]
curr_Stock_Price:  101.64235299917698
curr_Factors:  [101.642353]
mat_Sqrt:  [[0.15]]
grads:  [-0.02722689]
Stock Position:  -0.027226893740416824
Bond Position:  [8.56850773]


portfolio before change:  [5.78561688]
curr_Stock_Price:  102.25044443136207
curr_Factors:  [102.25044443]
mat_Sqrt:  [[0.15]]
grads:  [0.38988585]
Stock Position:  0.3898858454165947
Bond Position:  [-34.08038409]


portfolio before change:  [5.43245506]
curr_Stock_Price:  101.35556325166112
curr_Factors:  [101.35556325]
mat_Sqrt:  [[0.15]]
grads:  [0.11810918]
Stock Position:  0.11810918360634758
Bond Position:  [-6.53856777]


portfolio before change:  [5.44134487]
curr_Stock_Price:  101.43775146590356
curr_Factors:  [101.43775147]
mat_Sqrt:  [[0.15]]
grads:  [0.19076529]
Stock Position:  0.19076528834296785
Bond Position:  [-13.90945704]


portfolio before change:  [5.61228975]
curr_Stock_Price:  102.34296684944486
curr_Factors:  [102.34296685]
mat_Sqrt:  [[0.15]]
grads:  [0.05264726]
Stock Position:  0.052647257454597404
Bond Position:  [0.22421323]


portfolio before change:  [5.62454535]
curr_Stock_Price:  102.57522148949185
curr_Factors:  [102.57522149]
mat_Sqrt:  [[0.15]]
grads:  [0.00549031]
Stock Position:  0.0054903123210618115
Bond Position:  [5.06137535]


portfolio before change:  [5.62099426]
curr_Stock_Price:  101.8131878197096
curr_Factors:  [101.81318782]
mat_Sqrt:  [[0.15]]
grads:  [0.04092798]
Stock Position:  0.040927984087971825
Bond Position:  [1.45398573]


portfolio before change:  [5.60487744]
curr_Stock_Price:  101.41496198706096
curr_Factors:  [101.41496199]
mat_Sqrt:  [[0.15]]
grads:  [0.06649942]
Stock Position:  0.06649941659934902
Bond Position:  [-1.13915837]


portfolio before change:  [5.58193827]
curr_Stock_Price:  101.07215054686395
curr_Factors:  [101.07215055]
mat_Sqrt:  [[0.15]]
grads:  [0.13697451]
Stock Position:  0.13697450850242665
Bond Position:  [-8.26236987]


portfolio before change:  [5.5603327]
curr_Stock_Price:  100.92195681790808
curr_Factors:  [100.92195682]
mat_Sqrt:  [[0.15]]
grads:  [0.06894716]
Stock Position:  0.0689471634065325
Bond Position:  [-1.39794995]


portfolio before change:  [5.63756019]
curr_Stock_Price:  102.04458813850508
curr_Factors:  [102.04458814]
mat_Sqrt:  [[0.15]]
grads:  [-0.07795346]
Stock Position:  -0.07795345662949982
Bond Position:  [13.59228857]


portfolio before change:  [5.67054977]
curr_Stock_Price:  101.64318919064917
curr_Factors:  [101.64318919]
mat_Sqrt:  [[0.15]]
grads:  [0.07789247]
Stock Position:  0.0778924735362638
Bond Position:  [-2.24668965]


portfolio before change:  [5.65612409]
curr_Stock_Price:  101.46159497613311
curr_Factors:  [101.46159498]
mat_Sqrt:  [[0.15]]
grads:  [-0.04287215]
Stock Position:  -0.04287214585095884
Bond Position:  [10.00600039]


portfolio before change:  [5.67907554]
curr_Stock_Price:  100.95542451066036
curr_Factors:  [100.95542451]
mat_Sqrt:  [[0.15]]
grads:  [-0.17468955]
Stock Position:  -0.17468955156026553
Bond Position:  [23.31493337]


portfolio before change:  [6.02608888]
curr_Stock_Price:  98.98565131140072
curr_Factors:  [98.98565131]
mat_Sqrt:  [[0.15]]
grads:  [-0.01362734]
Stock Position:  -0.01362734107279983
Bond Position:  [7.37500011]


portfolio before change:  [6.03048594]
curr_Stock_Price:  98.73064001006361
curr_Factors:  [98.73064001]
mat_Sqrt:  [[0.15]]
grads:  [-0.02033579]
Stock Position:  -0.020335785778999402
Bond Position:  [8.03825109]


portfolio before change:  [6.02719484]
curr_Stock_Price:  98.94189042428039
curr_Factors:  [98.94189042]
mat_Sqrt:  [[0.15]]
grads:  [-0.05046848]
Stock Position:  -0.05046848239309172
Bond Position:  [11.0206419]


portfolio before change:  [6.05867063]
curr_Stock_Price:  98.34551572651523
curr_Factors:  [98.34551573]
mat_Sqrt:  [[0.15]]
grads:  [-0.01575092]
Stock Position:  -0.01575091867155126
Bond Position:  [7.60770285]


portfolio before change:  [6.04721281]
curr_Stock_Price:  99.13333326174647
curr_Factors:  [99.13333326]
mat_Sqrt:  [[0.15]]
grads:  [0.00205501]
Stock Position:  0.0020550129725926294
Bond Position:  [5.84349252]


portfolio before change:  [6.04776195]
curr_Stock_Price:  99.04509082771493
curr_Factors:  [99.04509083]
mat_Sqrt:  [[0.15]]
grads:  [0.05626706]
Stock Position:  0.05626705937284589
Bond Position:  [0.47478594]


portfolio before change:  [6.06675745]
curr_Stock_Price:  99.38163144948417
curr_Factors:  [99.38163145]
mat_Sqrt:  [[0.15]]
grads:  [0.03177635]
Stock Position:  0.03177634984031024
Bond Position:  [2.90877196]


portfolio before change:  [6.06897285]
curr_Stock_Price:  99.43990674657651
curr_Factors:  [99.43990675]
mat_Sqrt:  [[0.15]]
grads:  [0.04020921]
Stock Position:  0.04020921188643998
Bond Position:  [2.07057257]


portfolio before change:  [6.05360217]
curr_Stock_Price:  99.05120187260424
curr_Factors:  [99.05120187]
mat_Sqrt:  [[0.15]]
grads:  [-0.02289084]
Stock Position:  -0.022890843356989
Bond Position:  [8.32096771]


portfolio before change:  [6.06932418]
curr_Stock_Price:  98.40981767171539
curr_Factors:  [98.40981767]
mat_Sqrt:  [[0.15]]
grads:  [-0.0394726]
Stock Position:  -0.03947260347801569
Bond Position:  [9.95381589]


portfolio before change:  [6.08830794]
curr_Stock_Price:  97.96040579290029
curr_Factors:  [97.96040579]
mat_Sqrt:  [[0.15]]
grads:  [-0.03645295]
Stock Position:  -0.03645295186458262
Bond Position:  [9.6592539]


portfolio before change:  [6.11910246]
curr_Stock_Price:  97.14875594924376
curr_Factors:  [97.14875595]
mat_Sqrt:  [[0.15]]
grads:  [-0.13087989]
Stock Position:  -0.1308798869386121
Bond Position:  [18.83392065]


portfolio before change:  [6.00654314]
curr_Stock_Price:  98.02676483960231
curr_Factors:  [98.02676484]
mat_Sqrt:  [[0.15]]
grads:  [-0.22280079]
Stock Position:  -0.22280078724338695
Bond Position:  [27.84698352]


portfolio before change:  [6.07871332]
curr_Stock_Price:  97.71846659779317
curr_Factors:  [97.7184666]
mat_Sqrt:  [[0.15]]
grads:  [0.14701673]
Stock Position:  0.14701672945663533
Bond Position:  [-8.28753605]


portfolio before change:  [6.07134572]
curr_Stock_Price:  97.6753994492766
curr_Factors:  [97.67539945]
mat_Sqrt:  [[0.15]]
grads:  [0.02607367]
Stock Position:  0.026073674164860616
Bond Position:  [3.52458918]


portfolio before change:  [6.09577123]
curr_Stock_Price:  98.59528921085224
curr_Factors:  [98.59528921]
mat_Sqrt:  [[0.15]]
grads:  [-0.01321431]
Stock Position:  -0.013214311202092493
Bond Position:  [7.39864006]


portfolio before change:  [6.09728236]
curr_Stock_Price:  98.55092509180328
curr_Factors:  [98.55092509]
mat_Sqrt:  [[0.15]]
grads:  [-0.08355657]
Stock Position:  -0.08355656965440071
Bond Position:  [14.3318596]


portfolio before change:  [6.16571403]
curr_Stock_Price:  97.75338068471285
curr_Factors:  [97.75338068]
mat_Sqrt:  [[0.15]]
grads:  [-0.06461886]
Stock Position:  -0.06461885825613904
Bond Position:  [12.48242588]


portfolio before change:  [6.21930194]
curr_Stock_Price:  96.94823622017255
curr_Factors:  [96.94823622]
mat_Sqrt:  [[0.15]]
grads:  [-0.04739755]
Stock Position:  -0.047397554000967346
Bond Position:  [10.81441121]


portfolio before change:  [6.15406071]
curr_Stock_Price:  98.35322687437616
curr_Factors:  [98.35322687]
mat_Sqrt:  [[0.15]]
grads:  [-0.05016963]
Stock Position:  -0.05016962538221653
Bond Position:  [11.08840526]


portfolio before change:  [6.08521752]
curr_Stock_Price:  99.75306443607798
curr_Factors:  [99.75306444]
mat_Sqrt:  [[0.15]]
grads:  [0.15091537]
Stock Position:  0.15091537413907924
Bond Position:  [-8.96905352]


portfolio before change:  [6.05381538]
curr_Stock_Price:  99.55241597115311
curr_Factors:  [99.55241597]
mat_Sqrt:  [[0.15]]
grads:  [0.05320175]
Stock Position:  0.053201754735810694
Bond Position:  [0.75745216]


portfolio before change:  [6.09503638]
curr_Stock_Price:  100.32544144522822
curr_Factors:  [100.32544145]
mat_Sqrt:  [[0.15]]
grads:  [0.16141825]
Stock Position:  0.16141824640347327
Bond Position:  [-10.09932045]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.09503638]
Stock Price:  99.91829667621826
PL:  [6.09503638]
Settle:  Tensor("sub_388:0", shape=(), dtype=float64)
PL:  Tensor("sub_389:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  195
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.47268307e-03]
 [ 1.82419956e-03]
 [-2.86466816e-02]
 [-1.78473181e-02]
 [ 8.25887325e-03]
 [ 2.27340554e-02]
 [ 4.81793352e-03]
 [-1.05307224e-02]
 [ 4.29257611e-03]
 [ 1.19328895e-03]
 [-4.52329358e-02]
 [-1.24839576e-02]
 [ 1.09338683e-02]
 [ 6.91061477e-03]
 [ 9.63211873e-03]
 [-1.06094163e-02]
 [-6.70000566e-03]
 [-1.58607225e-03]
 [-7.44439123e-03]
 [-2.36811856e-03]
 [ 4.05888797e-04]
 [ 1.20257769e-02]
 [ 4.75779530e-03]
 [ 5.42496317e-03]
 [ 2.78638933e-04]
 [-3.24339087e-03]
 [-9.67686485e-04]
 [-1.81506943e-02]
 [-2.73582195e-02]
 [ 2.17795054e-02]
 [ 2.66229168e-03]
 [-6.71425257e-03]
 [-1.23195893e-02]
 [-6.25129083e-03]
 [-6.45668277e-03]
 [-2.19046152e-03]
 [ 1.76544185e-02]
 [ 1.40019735e-02]
 [ 1.48976536e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [3.062163]
curr_Stock_Price:  100.07229546556084
curr_Factors:  [100.07229547]
mat_Sqrt:  [[0.15]]
grads:  [-0.00981789]
Stock Position:  -0.009817887151763812
Bond Position:  [4.04466151]


portfolio before change:  [3.06645573]
curr_Stock_Price:  99.68655921254182
curr_Factors:  [99.68655921]
mat_Sqrt:  [[0.15]]
grads:  [0.01216133]
Stock Position:  0.012161330374091558
Bond Position:  [1.85413455]


portfolio before change:  [3.05089437]
curr_Stock_Price:  98.38792327414221
curr_Factors:  [98.38792327]
mat_Sqrt:  [[0.15]]
grads:  [-0.19097788]
Stock Position:  -0.19097787706655905
Bond Position:  [21.84081109]


portfolio before change:  [2.97802416]
curr_Stock_Price:  98.78378320389852
curr_Factors:  [98.7837832]
mat_Sqrt:  [[0.15]]
grads:  [-0.11898212]
Stock Position:  -0.11898212089404644
Bond Position:  [14.73152819]


portfolio before change:  [3.09441228]
curr_Stock_Price:  97.8210623641823
curr_Factors:  [97.82106236]
mat_Sqrt:  [[0.15]]
grads:  [0.05505916]
Stock Position:  0.05505915503072303
Bond Position:  [-2.29153276]


portfolio before change:  [3.1232907]
curr_Stock_Price:  98.35076320610102
curr_Factors:  [98.35076321]
mat_Sqrt:  [[0.15]]
grads:  [0.15156037]
Stock Position:  0.15156036901935452
Bond Position:  [-11.78278726]


portfolio before change:  [3.04034819]
curr_Stock_Price:  97.81322444458334
curr_Factors:  [97.81322444]
mat_Sqrt:  [[0.15]]
grads:  [0.03211956]
Stock Position:  0.032119556832778694
Bond Position:  [-0.10136923]


portfolio before change:  [2.99879581]
curr_Stock_Price:  96.51994067843444
curr_Factors:  [96.51994068]
mat_Sqrt:  [[0.15]]
grads:  [-0.07020482]
Stock Position:  -0.07020481624237775
Bond Position:  [9.77496051]


portfolio before change:  [2.96232255]
curr_Stock_Price:  97.05687257997597
curr_Factors:  [97.05687258]
mat_Sqrt:  [[0.15]]
grads:  [0.02861717]
Stock Position:  0.02861717405865021
Bond Position:  [0.18482914]


portfolio before change:  [2.95381577]
curr_Stock_Price:  96.75880369155752
curr_Factors:  [96.75880369]
mat_Sqrt:  [[0.15]]
grads:  [0.00795526]
Stock Position:  0.00795525966769846
Bond Position:  [2.18407436]


portfolio before change:  [2.95536661]
curr_Stock_Price:  96.91942866273857
curr_Factors:  [96.91942866]
mat_Sqrt:  [[0.15]]
grads:  [-0.30155291]
Stock Position:  -0.3015529051669272
Bond Position:  [32.18170189]


portfolio before change:  [3.07928242]
curr_Stock_Price:  96.52184389646752
curr_Factors:  [96.5218439]
mat_Sqrt:  [[0.15]]
grads:  [-0.08322638]
Stock Position:  -0.08322638413554329
Bond Position:  [11.11244647]


portfolio before change:  [3.0787218]
curr_Stock_Price:  96.54527101061167
curr_Factors:  [96.54527101]
mat_Sqrt:  [[0.15]]
grads:  [0.07289246]
Stock Position:  0.07289245530281217
Bond Position:  [-3.95870005]


portfolio before change:  [3.11161978]
curr_Stock_Price:  97.00338215508245
curr_Factors:  [97.00338216]
mat_Sqrt:  [[0.15]]
grads:  [0.04607077]
Stock Position:  0.046070765100430316
Bond Position:  [-1.35740025]


portfolio before change:  [3.094123]
curr_Stock_Price:  96.62728466059268
curr_Factors:  [96.62728466]
mat_Sqrt:  [[0.15]]
grads:  [0.06421412]
Stock Position:  0.06421412487513327
Bond Position:  [-3.11071353]


portfolio before change:  [3.09238045]
curr_Stock_Price:  96.60620394685833
curr_Factors:  [96.60620395]
mat_Sqrt:  [[0.15]]
grads:  [-0.07072944]
Stock Position:  -0.07072944192793837
Bond Position:  [9.92528335]


portfolio before change:  [3.04304766]
curr_Stock_Price:  97.32123193463113
curr_Factors:  [97.32123193]
mat_Sqrt:  [[0.15]]
grads:  [-0.0446667]
Stock Position:  -0.04466670442997472
Bond Position:  [7.39006636]


portfolio before change:  [3.01178235]
curr_Stock_Price:  98.04188344841049
curr_Factors:  [98.04188345]
mat_Sqrt:  [[0.15]]
grads:  [-0.01057381]
Stock Position:  -0.010573814987631172
Bond Position:  [4.04845909]


portfolio before change:  [3.00509611]
curr_Stock_Price:  98.72208507416698
curr_Factors:  [98.72208507]
mat_Sqrt:  [[0.15]]
grads:  [-0.04962927]
Stock Position:  -0.04962927489710376
Bond Position:  [7.90460161]


portfolio before change:  [3.02943505]
curr_Stock_Price:  98.25158054354709
curr_Factors:  [98.25158054]
mat_Sqrt:  [[0.15]]
grads:  [-0.01578746]
Stock Position:  -0.015787457093298717
Bond Position:  [4.58057766]


portfolio before change:  [3.0375275]
curr_Stock_Price:  97.77526311379623
curr_Factors:  [97.77526311]
mat_Sqrt:  [[0.15]]
grads:  [0.00270593]
Stock Position:  0.0027059253150778814
Bond Position:  [2.77295494]


portfolio before change:  [3.03631839]
curr_Stock_Price:  97.20032308901601
curr_Factors:  [97.20032309]
mat_Sqrt:  [[0.15]]
grads:  [0.08017185]
Stock Position:  0.08017184599467325
Bond Position:  [-4.75641094]


portfolio before change:  [2.99774506]
curr_Stock_Price:  96.72660639656347
curr_Factors:  [96.7266064]
mat_Sqrt:  [[0.15]]
grads:  [0.03171864]
Stock Position:  0.03171863533094297
Bond Position:  [-0.07029089]


portfolio before change:  [2.97794752]
curr_Stock_Price:  96.10272233215531
curr_Factors:  [96.10272233]
mat_Sqrt:  [[0.15]]
grads:  [0.03616642]
Stock Position:  0.03616642114528641
Bond Position:  [-0.497744]


portfolio before change:  [2.98116093]
curr_Stock_Price:  96.19329335253545
curr_Factors:  [96.19329335]
mat_Sqrt:  [[0.15]]
grads:  [0.00185759]
Stock Position:  0.0018575928845335154
Bond Position:  [2.80247296]


portfolio before change:  [2.98133722]
curr_Stock_Price:  96.09959980216841
curr_Factors:  [96.0995998]
mat_Sqrt:  [[0.15]]
grads:  [-0.02162261]
Stock Position:  -0.02162260578472219
Bond Position:  [5.05926098]


portfolio before change:  [2.98101847]
curr_Stock_Price:  96.14359085185174
curr_Factors:  [96.14359085]
mat_Sqrt:  [[0.15]]
grads:  [-0.00645124]
Stock Position:  -0.006451243236134078
Bond Position:  [3.60126416]


portfolio before change:  [2.98635868]
curr_Stock_Price:  95.38559363540645
curr_Factors:  [95.38559364]
mat_Sqrt:  [[0.15]]
grads:  [-0.12100463]
Stock Position:  -0.12100462854852992
Bond Position:  [14.528457]


portfolio before change:  [2.97025021]
curr_Stock_Price:  95.53372542792005
curr_Factors:  [95.53372543]
mat_Sqrt:  [[0.15]]
grads:  [-0.18238813]
Stock Position:  -0.18238812999758613
Bond Position:  [20.39446775]


portfolio before change:  [3.00396462]
curr_Stock_Price:  95.36285390552241
curr_Factors:  [95.36285391]
mat_Sqrt:  [[0.15]]
grads:  [0.1451967]
Stock Position:  0.1451967026942288
Bond Position:  [-10.84240733]


portfolio before change:  [3.09833286]
curr_Stock_Price:  96.02212247594102
curr_Factors:  [96.02212248]
mat_Sqrt:  [[0.15]]
grads:  [0.01774861]
Stock Position:  0.017748611176550595
Bond Position:  [1.39407354]


portfolio before change:  [3.10346211]
curr_Stock_Price:  96.30129856529483
curr_Factors:  [96.30129857]
mat_Sqrt:  [[0.15]]
grads:  [-0.04476168]
Stock Position:  -0.04476168382396015
Bond Position:  [7.41407039]


portfolio before change:  [3.18994151]
curr_Stock_Price:  94.39000806193599
curr_Factors:  [94.39000806]
mat_Sqrt:  [[0.15]]
grads:  [-0.0821306]
Stock Position:  -0.08213059535920669
Bond Position:  [10.94224907]


portfolio before change:  [3.21643139]
curr_Stock_Price:  94.08412926737688
curr_Factors:  [94.08412927]
mat_Sqrt:  [[0.15]]
grads:  [-0.04167527]
Stock Position:  -0.041675272178846236
Bond Position:  [7.13741308]


portfolio before change:  [3.23425229]
curr_Stock_Price:  93.67792498544226
curr_Factors:  [93.67792499]
mat_Sqrt:  [[0.15]]
grads:  [-0.04304455]
Stock Position:  -0.04304455182674559
Bond Position:  [7.26657659]


portfolio before change:  [3.24585024]
curr_Stock_Price:  93.4295876534052
curr_Factors:  [93.42958765]
mat_Sqrt:  [[0.15]]
grads:  [-0.01460308]
Stock Position:  -0.014603076818522505
Bond Position:  [4.61020969]


portfolio before change:  [3.26316881]
curr_Stock_Price:  92.28309924244186
curr_Factors:  [92.28309924]
mat_Sqrt:  [[0.15]]
grads:  [0.11769612]
Stock Position:  0.11769612321998961
Bond Position:  [-7.59819421]


portfolio before change:  [3.25029122]
curr_Stock_Price:  92.1817555904109
curr_Factors:  [92.18175559]
mat_Sqrt:  [[0.15]]
grads:  [0.09334649]
Stock Position:  0.09334648984384449
Bond Position:  [-5.35455209]


portfolio before change:  [3.20491066]
curr_Stock_Price:  91.70277451147696
curr_Factors:  [91.70277451]
mat_Sqrt:  [[0.15]]
grads:  [0.09931769]
Stock Position:  0.0993176906830321
Bond Position:  [-5.90279713]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [3.20491066]
Stock Price:  92.1351431504758
PL:  [3.20491066]
Settle:  Tensor("sub_390:0", shape=(), dtype=float64)
PL:  Tensor("sub_391:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  196
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-4.26402839e-03]
 [-5.24015198e-03]
 [-1.44523225e-02]
 [-9.80220794e-03]
 [ 1.06528514e-02]
 [ 2.31331291e-02]
 [ 2.64272445e-02]
 [-2.08920778e-03]
 [ 3.34524141e-03]
 [ 4.78639631e-03]
 [ 1.69400110e-02]
 [ 1.17975930e-02]
 [-5.97061772e-03]
 [ 1.00441329e-02]
 [-5.37303346e-03]
 [-2.23712601e-02]
 [ 4.70759721e-03]
 [-4.11933830e-04]
 [-3.74993384e-03]
 [-2.97581455e-03]
 [-1.32399910e-03]
 [-3.96412220e-02]
 [ 4.81041642e-03]
 [ 1.01390433e-02]
 [-5.54110054e-03]
 [ 2.45280428e-03]
 [-5.83679550e-03]
 [ 3.24480413e-03]
 [ 3.86576675e-02]
 [ 2.50805775e-02]
 [-1.43238782e-02]
 [ 6.32918150e-03]
 [-1.30432572e-02]
 [ 3.65739243e-03]
 [-6.75592324e-03]
 [ 3.65784903e-03]
 [ 2.46601856e-02]
 [ 8.69436555e-03]
 [ 1.81538015e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-7.03615401]
curr_Stock_Price:  99.42174097393878
curr_Factors:  [99.42174097]
mat_Sqrt:  [[0.15]]
grads:  [-0.02842686]
Stock Position:  -0.028426855963711233
Bond Position:  [-4.2099065]


portfolio before change:  [-7.01275724]
curr_Stock_Price:  98.58017607998616
curr_Factors:  [98.58017608]
mat_Sqrt:  [[0.15]]
grads:  [-0.03493435]
Stock Position:  -0.03493434653288933
Bond Position:  [-3.56892321]


portfolio before change:  [-7.03140262]
curr_Stock_Price:  99.10113147932634
curr_Factors:  [99.10113148]
mat_Sqrt:  [[0.15]]
grads:  [-0.09634882]
Stock Position:  -0.09634881647620967
Bond Position:  [2.51687411]


portfolio before change:  [-7.05139801]
curr_Stock_Price:  99.31192818474963
curr_Factors:  [99.31192818]
mat_Sqrt:  [[0.15]]
grads:  [-0.06534805]
Stock Position:  -0.06534805292654125
Bond Position:  [-0.56155687]


portfolio before change:  [-7.12703829]
curr_Stock_Price:  100.4683525555015
curr_Factors:  [100.46835256]
mat_Sqrt:  [[0.15]]
grads:  [0.07101901]
Stock Position:  0.07101900916338512
Bond Position:  [-14.26220114]


portfolio before change:  [-7.10986198]
curr_Stock_Price:  100.73531198292935
curr_Factors:  [100.73531198]
mat_Sqrt:  [[0.15]]
grads:  [0.15422086]
Stock Position:  0.15422086052066605
Bond Position:  [-22.64534848]


portfolio before change:  [-7.13951796]
curr_Stock_Price:  100.56137223491415
curr_Factors:  [100.56137223]
mat_Sqrt:  [[0.15]]
grads:  [0.17618163]
Stock Position:  0.17618162992400938
Bond Position:  [-24.85658443]


portfolio before change:  [-7.07071543]
curr_Stock_Price:  100.9695294159172
curr_Factors:  [100.96952942]
mat_Sqrt:  [[0.15]]
grads:  [-0.01392805]
Stock Position:  -0.01392805189475865
Bond Position:  [-5.66440659]


portfolio before change:  [-7.06900216]
curr_Stock_Price:  100.79568134468745
curr_Factors:  [100.79568134]
mat_Sqrt:  [[0.15]]
grads:  [0.02230161]
Stock Position:  0.02230160939848442
Bond Position:  [-9.31690808]


portfolio before change:  [-7.07522253]
curr_Stock_Price:  100.56898541847522
curr_Factors:  [100.56898542]
mat_Sqrt:  [[0.15]]
grads:  [0.03190931]
Stock Position:  0.03190930873042442
Bond Position:  [-10.28430934]


portfolio before change:  [-7.06954089]
curr_Stock_Price:  100.78733123134525
curr_Factors:  [100.78733123]
mat_Sqrt:  [[0.15]]
grads:  [0.11293341]
Stock Position:  0.11293340655736726
Bond Position:  [-18.45179754]


portfolio before change:  [-7.1628751]
curr_Stock_Price:  99.981302266361
curr_Factors:  [99.98130227]
mat_Sqrt:  [[0.15]]
grads:  [0.07865062]
Stock Position:  0.07865062000893007
Bond Position:  [-15.02646651]


portfolio before change:  [-7.21380521]
curr_Stock_Price:  99.35763674504426
curr_Factors:  [99.35763675]
mat_Sqrt:  [[0.15]]
grads:  [-0.03980412]
Stock Position:  -0.03980411816435699
Bond Position:  [-3.25896209]


portfolio before change:  [-7.22376768]
curr_Stock_Price:  99.59768910669183
curr_Factors:  [99.59768911]
mat_Sqrt:  [[0.15]]
grads:  [0.06696089]
Stock Position:  0.06696088584928468
Bond Position:  [-13.89291717]


portfolio before change:  [-7.18813449]
curr_Stock_Price:  100.15577482659509
curr_Factors:  [100.15577483]
mat_Sqrt:  [[0.15]]
grads:  [-0.03582022]
Stock Position:  -0.035820223079478755
Bond Position:  [-3.60053229]


portfolio before change:  [-7.20447569]
curr_Stock_Price:  100.59940993814293
curr_Factors:  [100.59940994]
mat_Sqrt:  [[0.15]]
grads:  [-0.14914173]
Stock Position:  -0.1491417342067255
Bond Position:  [7.79909477]


portfolio before change:  [-7.22209835]
curr_Stock_Price:  100.72410746657974
curr_Factors:  [100.72410747]
mat_Sqrt:  [[0.15]]
grads:  [0.03138398]
Stock Position:  0.031383981385882415
Bond Position:  [-10.38322186]


portfolio before change:  [-7.21007078]
curr_Stock_Price:  101.14870471076684
curr_Factors:  [101.14870471]
mat_Sqrt:  [[0.15]]
grads:  [-0.00274623]
Stock Position:  -0.0027462255306265684
Bond Position:  [-6.93229362]


portfolio before change:  [-7.21434555]
curr_Stock_Price:  102.38974789710602
curr_Factors:  [102.3897479]
mat_Sqrt:  [[0.15]]
grads:  [-0.02499956]
Stock Position:  -0.02499955893644148
Bond Position:  [-4.65464702]


portfolio before change:  [-7.2363524]
curr_Stock_Price:  103.24676234789162
curr_Factors:  [103.24676235]
mat_Sqrt:  [[0.15]]
grads:  [-0.01983876]
Stock Position:  -0.019838763694348477
Bond Position:  [-5.18806428]


portfolio before change:  [-7.2386878]
curr_Stock_Price:  103.33179005778781
curr_Factors:  [103.33179006]
mat_Sqrt:  [[0.15]]
grads:  [-0.00882666]
Stock Position:  -0.008826660642218194
Bond Position:  [-6.32661315]


portfolio before change:  [-7.2471666]
curr_Stock_Price:  104.20277978863982
curr_Factors:  [104.20277979]
mat_Sqrt:  [[0.15]]
grads:  [-0.26427481]
Stock Position:  -0.26427481345670917
Bond Position:  [20.29100359]


portfolio before change:  [-7.13667975]
curr_Stock_Price:  103.79430228619015
curr_Factors:  [103.79430229]
mat_Sqrt:  [[0.15]]
grads:  [0.03206944]
Stock Position:  0.03206944281724241
Bond Position:  [-10.4653052]


portfolio before change:  [-7.11790586]
curr_Stock_Price:  104.42051022268384
curr_Factors:  [104.42051022]
mat_Sqrt:  [[0.15]]
grads:  [0.06759362]
Stock Position:  0.06759362195521072
Bond Position:  [-14.17606635]


portfolio before change:  [-7.13211561]
curr_Stock_Price:  104.23650428783728
curr_Factors:  [104.23650429]
mat_Sqrt:  [[0.15]]
grads:  [-0.03694067]
Stock Position:  -0.03694067025624255
Bond Position:  [-3.28154927]


portfolio before change:  [-7.13267798]
curr_Stock_Price:  104.24062316844133
curr_Factors:  [104.24062317]
mat_Sqrt:  [[0.15]]
grads:  [0.01635203]
Stock Position:  0.01635202852517007
Bond Position:  [-8.83722362]


portfolio before change:  [-7.13635338]
curr_Stock_Price:  104.08341444818183
curr_Factors:  [104.08341445]
mat_Sqrt:  [[0.15]]
grads:  [-0.03891197]
Stock Position:  -0.03891196999306166
Bond Position:  [-3.08626268]


portfolio before change:  [-7.17863464]
curr_Stock_Price:  105.16008698114402
curr_Factors:  [105.16008698]
mat_Sqrt:  [[0.15]]
grads:  [0.02163203]
Stock Position:  0.021632027564510437
Bond Position:  [-9.45346054]


portfolio before change:  [-7.18213582]
curr_Stock_Price:  105.05286528773317
curr_Factors:  [105.05286529]
mat_Sqrt:  [[0.15]]
grads:  [0.25771778]
Stock Position:  0.2577177831984455
Bond Position:  [-34.25612738]


portfolio before change:  [-7.43787391]
curr_Stock_Price:  104.07716307554217
curr_Factors:  [104.07716308]
mat_Sqrt:  [[0.15]]
grads:  [0.16720385]
Stock Position:  0.16720384984521705
Bond Position:  [-24.83997626]


portfolio before change:  [-7.45657373]
curr_Stock_Price:  103.98389594130329
curr_Factors:  [103.98389594]
mat_Sqrt:  [[0.15]]
grads:  [-0.09549252]
Stock Position:  -0.09549252163342874
Bond Position:  [2.4731107]


portfolio before change:  [-7.39130978]
curr_Stock_Price:  103.30368775535057
curr_Factors:  [103.30368776]
mat_Sqrt:  [[0.15]]
grads:  [0.04219454]
Stock Position:  0.04219454335712052
Bond Position:  [-11.75016171]


portfolio before change:  [-7.33208336]
curr_Stock_Price:  104.74215036649954
curr_Factors:  [104.74215037]
mat_Sqrt:  [[0.15]]
grads:  [-0.08695505]
Stock Position:  -0.08695504793797953
Bond Position:  [1.77577534]


portfolio before change:  [-7.44663529]
curr_Stock_Price:  106.0620726942919
curr_Factors:  [106.06207269]
mat_Sqrt:  [[0.15]]
grads:  [0.02438262]
Stock Position:  0.02438261620418311
Bond Position:  [-10.0327061]


portfolio before change:  [-7.44277213]
curr_Stock_Price:  106.2719486179695
curr_Factors:  [106.27194862]
mat_Sqrt:  [[0.15]]
grads:  [-0.04503949]
Stock Position:  -0.04503948825846825
Bond Position:  [-2.65633795]


portfolio before change:  [-7.43606992]
curr_Stock_Price:  106.11576854886168
curr_Factors:  [106.11576855]
mat_Sqrt:  [[0.15]]
grads:  [0.02438566]
Stock Position:  0.024385660180481657
Bond Position:  [-10.02377299]


portfolio before change:  [-7.41398626]
curr_Stock_Price:  107.07275342969403
curr_Factors:  [107.07275343]
mat_Sqrt:  [[0.15]]
grads:  [0.16440124]
Stock Position:  0.16440123716629262
Bond Position:  [-25.0168794]


portfolio before change:  [-7.30770293]
curr_Stock_Price:  107.73826325572338
curr_Factors:  [107.73826326]
mat_Sqrt:  [[0.15]]
grads:  [0.05796244]
Stock Position:  0.05796243701705018
Bond Position:  [-13.55247523]


portfolio before change:  [-7.27241019]
curr_Stock_Price:  108.37638188914833
curr_Factors:  [108.37638189]
mat_Sqrt:  [[0.15]]
grads:  [0.12102534]
Stock Position:  0.1210253434333685
Bond Position:  [-20.38869902]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-7.27241019]
Stock Price:  106.89328583887354
PL:  [-14.16569602]
Settle:  Tensor("sub_392:0", shape=(), dtype=float64)
PL:  Tensor("sub_393:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  197
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-2.82468483e-03]
 [ 3.42055686e-03]
 [ 9.29941617e-03]
 [ 5.94377996e-02]
 [-8.35128538e-03]
 [ 3.66378273e-02]
 [ 5.37134984e-03]
 [ 2.63716645e-03]
 [ 1.59265939e-02]
 [ 1.39716571e-02]
 [ 1.75684299e-02]
 [-1.41929265e-02]
 [-1.23182963e-02]
 [-1.27193102e-02]
 [ 5.25935374e-03]
 [-3.46060731e-02]
 [ 4.67623634e-03]
 [-1.11024744e-02]
 [ 1.29015765e-02]
 [-4.46250057e-03]
 [-3.13465183e-03]
 [-3.91337262e-02]
 [ 4.82662111e-03]
 [ 1.12582018e-02]
 [-5.58018034e-03]
 [ 9.26159938e-03]
 [-9.43739712e-03]
 [ 2.22284358e-03]
 [ 4.09307823e-02]
 [ 2.67492792e-02]
 [-2.44866242e-02]
 [ 5.83114971e-03]
 [-1.31814698e-02]
 [ 4.63641491e-03]
 [-6.58438856e-03]
 [ 4.01133752e-03]
 [ 2.45949105e-02]
 [ 5.58963046e-03]
 [ 1.93330225e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [-3.57239889]
curr_Stock_Price:  99.64488325134678
curr_Factors:  [99.64488325]
mat_Sqrt:  [[0.15]]
grads:  [-0.01883123]
Stock Position:  -0.018831232210466432
Bond Position:  [-1.69596295]


portfolio before change:  [-3.56643036]
curr_Stock_Price:  99.31667657561951
curr_Factors:  [99.31667658]
mat_Sqrt:  [[0.15]]
grads:  [0.02280371]
Stock Position:  0.02280371240875708
Bond Position:  [-5.83121929]


portfolio before change:  [-3.53686898]
curr_Stock_Price:  100.64498351518546
curr_Factors:  [100.64498352]
mat_Sqrt:  [[0.15]]
grads:  [0.06199611]
Stock Position:  0.061996107826583075
Bond Position:  [-9.77646623]


portfolio before change:  [-3.43653652]
curr_Stock_Price:  102.28306360424202
curr_Factors:  [102.2830636]
mat_Sqrt:  [[0.15]]
grads:  [0.396252]
Stock Position:  0.39625199713697806
Bond Position:  [-43.96640475]


portfolio before change:  [-3.46971501]
curr_Stock_Price:  102.21320314358111
curr_Factors:  [102.21320314]
mat_Sqrt:  [[0.15]]
grads:  [-0.05567524]
Stock Position:  -0.055675235897022744
Bond Position:  [2.22102918]


portfolio before change:  [-3.51600308]
curr_Stock_Price:  103.04958423120391
curr_Factors:  [103.04958423]
mat_Sqrt:  [[0.15]]
grads:  [0.24425218]
Stock Position:  0.24425218182157954
Bond Position:  [-28.68608886]


portfolio before change:  [-3.57684286]
curr_Stock_Price:  102.81517981757207
curr_Factors:  [102.81517982]
mat_Sqrt:  [[0.15]]
grads:  [0.035809]
Stock Position:  0.03580899893949605
Bond Position:  [-7.25855152]


portfolio before change:  [-3.52680856]
curr_Stock_Price:  104.23777393261416
curr_Factors:  [104.23777393]
mat_Sqrt:  [[0.15]]
grads:  [0.01758111]
Stock Position:  0.017581109665487468
Bond Position:  [-5.35942429]


portfolio before change:  [-3.51982327]
curr_Stock_Price:  104.67319902490432
curr_Factors:  [104.67319902]
mat_Sqrt:  [[0.15]]
grads:  [0.10617729]
Stock Position:  0.10617729280873905
Bond Position:  [-14.63374018]


portfolio before change:  [-3.49151575]
curr_Stock_Price:  104.9570342094584
curr_Factors:  [104.95703421]
mat_Sqrt:  [[0.15]]
grads:  [0.09314438]
Stock Position:  0.09314438085210629
Bond Position:  [-13.26767372]


portfolio before change:  [-3.5480819]
curr_Stock_Price:  104.36754528875186
curr_Factors:  [104.36754529]
mat_Sqrt:  [[0.15]]
grads:  [0.11712287]
Stock Position:  0.11712286609670236
Bond Position:  [-15.77190793]


portfolio before change:  [-3.49858164]
curr_Stock_Price:  104.80701425027638
curr_Factors:  [104.80701425]
mat_Sqrt:  [[0.15]]
grads:  [-0.09461951]
Stock Position:  -0.09461950973209193
Bond Position:  [6.41820666]


portfolio before change:  [-3.49062491]
curr_Stock_Price:  104.73140184227032
curr_Factors:  [104.73140184]
mat_Sqrt:  [[0.15]]
grads:  [-0.08212198]
Stock Position:  -0.0821219751608812
Bond Position:  [5.11012467]


portfolio before change:  [-3.55750331]
curr_Stock_Price:  105.55355949244355
curr_Factors:  [105.55355949]
mat_Sqrt:  [[0.15]]
grads:  [-0.0847954]
Stock Position:  -0.08479540164523693
Bond Position:  [5.39295316]


portfolio before change:  [-3.57510532]
curr_Stock_Price:  105.7690920257267
curr_Factors:  [105.76909203]
mat_Sqrt:  [[0.15]]
grads:  [0.03506236]
Stock Position:  0.03506235828430126
Bond Position:  [-7.28361912]


portfolio before change:  [-3.57217528]
curr_Stock_Price:  105.87862692118414
curr_Factors:  [105.87862692]
mat_Sqrt:  [[0.15]]
grads:  [-0.23070715]
Stock Position:  -0.23070715389615093
Bond Position:  [20.8547814]


portfolio before change:  [-3.58556357]
curr_Stock_Price:  105.94795856289758
curr_Factors:  [105.94795856]
mat_Sqrt:  [[0.15]]
grads:  [0.03117491]
Stock Position:  0.031174908949019108
Bond Position:  [-6.88848153]


portfolio before change:  [-3.59392222]
curr_Stock_Price:  105.70745967697196
curr_Factors:  [105.70745968]
mat_Sqrt:  [[0.15]]
grads:  [-0.0740165]
Stock Position:  -0.07401649576808805
Bond Position:  [4.23017352]


portfolio before change:  [-3.61886131]
curr_Stock_Price:  106.05154380170121
curr_Factors:  [106.0515438]
mat_Sqrt:  [[0.15]]
grads:  [0.08601051]
Stock Position:  0.0860105102791241
Bond Position:  [-12.74040871]


portfolio before change:  [-3.61781547]
curr_Stock_Price:  106.08222018493997
curr_Factors:  [106.08222018]
mat_Sqrt:  [[0.15]]
grads:  [-0.02975]
Stock Position:  -0.029750003813934583
Bond Position:  [-0.46186902]


portfolio before change:  [-3.6478444]
curr_Stock_Price:  107.08965501387385
curr_Factors:  [107.08965501]
mat_Sqrt:  [[0.15]]
grads:  [-0.02089768]
Stock Position:  -0.020897678881406794
Bond Position:  [-1.40991918]


portfolio before change:  [-3.65316864]
curr_Stock_Price:  107.33599735030339
curr_Factors:  [107.33599735]
mat_Sqrt:  [[0.15]]
grads:  [-0.26089151]
Stock Position:  -0.26089150767031805
Bond Position:  [24.34988154]


portfolio before change:  [-3.11669767]
curr_Stock_Price:  105.29136569103055
curr_Factors:  [105.29136569]
mat_Sqrt:  [[0.15]]
grads:  [0.03217747]
Stock Position:  0.03217747405324529
Bond Position:  [-6.50470786]


portfolio before change:  [-3.11363328]
curr_Stock_Price:  105.41187030719075
curr_Factors:  [105.41187031]
mat_Sqrt:  [[0.15]]
grads:  [0.07505468]
Stock Position:  0.07505467836769933
Bond Position:  [-11.0252873]


portfolio before change:  [-3.14271973]
curr_Stock_Price:  105.04269670282032
curr_Factors:  [105.0426967]
mat_Sqrt:  [[0.15]]
grads:  [-0.0372012]
Stock Position:  -0.03720120227329795
Bond Position:  [0.76499488]


portfolio before change:  [-3.16274817]
curr_Stock_Price:  105.58364874451959
curr_Factors:  [105.58364874]
mat_Sqrt:  [[0.15]]
grads:  [0.061744]
Stock Position:  0.061743995892416435
Bond Position:  [-9.68190454]


portfolio before change:  [-3.18285144]
curr_Stock_Price:  105.27766007305723
curr_Factors:  [105.27766007]
mat_Sqrt:  [[0.15]]
grads:  [-0.06291598]
Stock Position:  -0.06291598079565973
Bond Position:  [3.44079579]


portfolio before change:  [-3.16267254]
curr_Stock_Price:  104.9637688444195
curr_Factors:  [104.96376884]
mat_Sqrt:  [[0.15]]
grads:  [0.01481896]
Stock Position:  0.01481895722374523
Bond Position:  [-4.71812614]


portfolio before change:  [-3.15959009]
curr_Stock_Price:  105.21157670686813
curr_Factors:  [105.21157671]
mat_Sqrt:  [[0.15]]
grads:  [0.27287188]
Stock Position:  0.2728718817407868
Bond Position:  [-31.86887101]


portfolio before change:  [-2.83621793]
curr_Stock_Price:  106.41124600237389
curr_Factors:  [106.411246]
mat_Sqrt:  [[0.15]]
grads:  [0.17832853]
Stock Position:  0.17832852817486222
Bond Position:  [-21.81237881]


portfolio before change:  [-2.95392035]
curr_Stock_Price:  105.76650506136603
curr_Factors:  [105.76650506]
mat_Sqrt:  [[0.15]]
grads:  [-0.16324416]
Stock Position:  -0.16324416129215982
Bond Position:  [14.31184406]


portfolio before change:  [-2.96751649]
curr_Stock_Price:  105.86075180233242
curr_Factors:  [105.8607518]
mat_Sqrt:  [[0.15]]
grads:  [0.03887433]
Stock Position:  0.03887433142284772
Bond Position:  [-7.08278244]


portfolio before change:  [-2.93895502]
curr_Stock_Price:  106.61824076904102
curr_Factors:  [106.61824077]
mat_Sqrt:  [[0.15]]
grads:  [-0.08787647]
Stock Position:  -0.08787646565902232
Bond Position:  [6.43027916]


portfolio before change:  [-2.9452787]
curr_Stock_Price:  106.69934910088985
curr_Factors:  [106.6993491]
mat_Sqrt:  [[0.15]]
grads:  [0.03090943]
Stock Position:  0.030909432729448634
Bond Position:  [-6.24329505]


portfolio before change:  [-2.9727291]
curr_Stock_Price:  105.83650757987637
curr_Factors:  [105.83650758]
mat_Sqrt:  [[0.15]]
grads:  [-0.04389592]
Stock Position:  -0.04389592372518536
Bond Position:  [1.67306217]


portfolio before change:  [-2.99299045]
curr_Stock_Price:  106.30284914371474
curr_Factors:  [106.30284914]
mat_Sqrt:  [[0.15]]
grads:  [0.02674225]
Stock Position:  0.026742250124433566
Bond Position:  [-5.83576783]


portfolio before change:  [-2.98056599]
curr_Stock_Price:  106.79472906751835
curr_Factors:  [106.79472907]
mat_Sqrt:  [[0.15]]
grads:  [0.16396607]
Stock Position:  0.1639660700490022
Bond Position:  [-20.49127801]


portfolio before change:  [-3.0461422]
curr_Stock_Price:  106.41041391284679
curr_Factors:  [106.41041391]
mat_Sqrt:  [[0.15]]
grads:  [0.0372642]
Stock Position:  0.0372642030716109
Bond Position:  [-7.01144147]


portfolio before change:  [-3.04793423]
curr_Stock_Price:  106.38584480443362
curr_Factors:  [106.3858448]
mat_Sqrt:  [[0.15]]
grads:  [0.12888682]
Stock Position:  0.12888681649844275
Bond Position:  [-16.75966709]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [-3.04793423]
Stock Price:  106.30247020745497
PL:  [-9.35040444]
Settle:  Tensor("sub_394:0", shape=(), dtype=float64)
PL:  Tensor("sub_395:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  198
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.44803488e-03]
 [-1.53655646e-02]
 [-4.70075810e-03]
 [-3.30077709e-03]
 [ 5.42402558e-03]
 [ 1.50173447e-02]
 [ 2.00230594e-02]
 [-3.35448445e-03]
 [ 1.52597794e-02]
 [-4.11878991e-03]
 [ 4.17073199e-03]
 [ 1.06046491e-02]
 [-1.12854887e-02]
 [ 1.14876506e-02]
 [-3.64143084e-03]
 [-2.99496804e-02]
 [ 4.87704517e-03]
 [-1.02956947e-02]
 [ 9.04808798e-03]
 [-3.87227690e-03]
 [-2.22515882e-03]
 [-3.94541869e-02]
 [ 4.81996377e-03]
 [ 9.92767976e-03]
 [-5.50823906e-03]
 [ 7.66924348e-05]
 [-9.28741758e-03]
 [ 2.46085106e-03]
 [ 3.75779046e-02]
 [ 2.53322731e-02]
 [-2.45348931e-02]
 [ 4.84366792e-03]
 [-1.31679386e-02]
 [ 1.59670472e-03]
 [-5.85070318e-03]
 [-1.56215787e-03]
 [ 2.36439756e-02]
 [-2.30672656e-04]
 [ 2.22529633e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [4.898221]
curr_Stock_Price:  100.19057812328633
curr_Factors:  [100.19057812]
mat_Sqrt:  [[0.15]]
grads:  [-0.00965357]
Stock Position:  -0.00965356589622438
Bond Position:  [5.86541735]


portfolio before change:  [4.89735971]
curr_Stock_Price:  100.35575108585357
curr_Factors:  [100.35575109]
mat_Sqrt:  [[0.15]]
grads:  [-0.1024371]
Stock Position:  -0.10243709746055407
Bond Position:  [15.17751157]


portfolio before change:  [4.83509963]
curr_Stock_Price:  100.98206124793187
curr_Factors:  [100.98206125]
mat_Sqrt:  [[0.15]]
grads:  [-0.03133839]
Stock Position:  -0.0313383873190386
Bond Position:  [7.99971457]


portfolio before change:  [4.8624874]
curr_Stock_Price:  100.14003494893767
curr_Factors:  [100.14003495]
mat_Sqrt:  [[0.15]]
grads:  [-0.02200518]
Stock Position:  -0.02200518057683943
Bond Position:  [7.06608695]


portfolio before change:  [4.86427978]
curr_Stock_Price:  100.0987235890484
curr_Factors:  [100.09872359]
mat_Sqrt:  [[0.15]]
grads:  [0.03616017]
Stock Position:  0.036160170560482915
Bond Position:  [1.24469286]


portfolio before change:  [4.86281415]
curr_Stock_Price:  100.05388912486818
curr_Factors:  [100.05388912]
mat_Sqrt:  [[0.15]]
grads:  [0.10011563]
Stock Position:  0.10011563113211826
Bond Position:  [-5.1541441]


portfolio before change:  [4.77066937]
curr_Stock_Price:  99.13994119038622
curr_Factors:  [99.13994119]
mat_Sqrt:  [[0.15]]
grads:  [0.13348706]
Stock Position:  0.13348706240133454
Bond Position:  [-8.46323015]


portfolio before change:  [4.73990635]
curr_Stock_Price:  98.9174099084202
curr_Factors:  [98.91740991]
mat_Sqrt:  [[0.15]]
grads:  [-0.02236323]
Stock Position:  -0.02236322967254608
Bond Position:  [6.95201911]


portfolio before change:  [4.7235101]
curr_Stock_Price:  99.68944987883268
curr_Factors:  [99.68944988]
mat_Sqrt:  [[0.15]]
grads:  [0.10173186]
Stock Position:  0.10173186245522328
Bond Position:  [-5.4180833]


portfolio before change:  [4.68882212]
curr_Stock_Price:  99.3551329581799
curr_Factors:  [99.35513296]
mat_Sqrt:  [[0.15]]
grads:  [-0.0274586]
Stock Position:  -0.027458599428258863
Bond Position:  [7.41697491]


portfolio before change:  [4.68143222]
curr_Stock_Price:  99.65802800188476
curr_Factors:  [99.658028]
mat_Sqrt:  [[0.15]]
grads:  [0.02780488]
Stock Position:  0.027804879957219038
Bond Position:  [1.91045272]


portfolio before change:  [4.71294666]
curr_Stock_Price:  100.78285268465683
curr_Factors:  [100.78285268]
mat_Sqrt:  [[0.15]]
grads:  [0.07069766]
Stock Position:  0.07069766041168929
Bond Position:  [-2.41216523]


portfolio before change:  [4.76414404]
curr_Stock_Price:  101.51129151514112
curr_Factors:  [101.51129152]
mat_Sqrt:  [[0.15]]
grads:  [-0.07523659]
Stock Position:  -0.07523659159598128
Bond Position:  [12.40150762]


portfolio before change:  [4.73457621]
curr_Stock_Price:  101.92489498213835
curr_Factors:  [101.92489498]
mat_Sqrt:  [[0.15]]
grads:  [0.07658434]
Stock Position:  0.0765843373474061
Bond Position:  [-3.07127433]


portfolio before change:  [4.76699322]
curr_Stock_Price:  102.35319331008333
curr_Factors:  [102.35319331]
mat_Sqrt:  [[0.15]]
grads:  [-0.02427621]
Stock Position:  -0.024276205574031075
Bond Position:  [7.25174038]


portfolio before change:  [4.72609299]
curr_Stock_Price:  104.0753224142353
curr_Factors:  [104.07532241]
mat_Sqrt:  [[0.15]]
grads:  [-0.19966454]
Stock Position:  -0.19966453567971898
Bond Position:  [25.50624391]


portfolio before change:  [4.69189466]
curr_Stock_Price:  104.26257053468088
curr_Factors:  [104.26257053]
mat_Sqrt:  [[0.15]]
grads:  [0.03251363]
Stock Position:  0.03251363444547831
Bond Position:  [1.30193955]


portfolio before change:  [4.72998562]
curr_Stock_Price:  105.42910309043997
curr_Factors:  [105.42910309]
mat_Sqrt:  [[0.15]]
grads:  [-0.06863796]
Stock Position:  -0.06863796451470607
Bond Position:  [11.96642466]


portfolio before change:  [4.74743902]
curr_Stock_Price:  105.19661517920802
curr_Factors:  [105.19661518]
mat_Sqrt:  [[0.15]]
grads:  [0.06032059]
Stock Position:  0.06032058656592958
Bond Position:  [-1.59808252]


portfolio before change:  [4.74498744]
curr_Stock_Price:  105.15928464261837
curr_Factors:  [105.15928464]
mat_Sqrt:  [[0.15]]
grads:  [-0.02581518]
Stock Position:  -0.025815179339160523
Bond Position:  [7.45969324]


portfolio before change:  [4.74481532]
curr_Stock_Price:  105.20207499962757
curr_Factors:  [105.202075]
mat_Sqrt:  [[0.15]]
grads:  [-0.01483439]
Stock Position:  -0.014834392135832465
Bond Position:  [6.30542416]


portfolio before change:  [4.74342482]
curr_Stock_Price:  105.34894486646455
curr_Factors:  [105.34894487]
mat_Sqrt:  [[0.15]]
grads:  [-0.26302791]
Stock Position:  -0.2630279128606702
Bond Position:  [32.45313791]


portfolio before change:  [4.92764241]
curr_Stock_Price:  104.66399591820876
curr_Factors:  [104.66399592]
mat_Sqrt:  [[0.15]]
grads:  [0.03213309]
Stock Position:  0.03213309181962906
Bond Position:  [1.56446462]


portfolio before change:  [4.91399783]
curr_Stock_Price:  104.23328260610359
curr_Factors:  [104.23328261]
mat_Sqrt:  [[0.15]]
grads:  [0.06618453]
Stock Position:  0.06618453172542206
Bond Position:  [-1.98463317]


portfolio before change:  [4.86909566]
curr_Stock_Price:  103.55859201184352
curr_Factors:  [103.55859201]
mat_Sqrt:  [[0.15]]
grads:  [-0.03672159]
Stock Position:  -0.03672159370656475
Bond Position:  [8.6719322]


portfolio before change:  [4.8623453]
curr_Stock_Price:  103.77193833817839
curr_Factors:  [103.77193834]
mat_Sqrt:  [[0.15]]
grads:  [0.00051128]
Stock Position:  0.0005112828984616773
Bond Position:  [4.80928848]


portfolio before change:  [4.86369091]
curr_Stock_Price:  105.22791493893897
curr_Factors:  [105.22791494]
mat_Sqrt:  [[0.15]]
grads:  [-0.06191612]
Stock Position:  -0.061916117189815364
Bond Position:  [11.37899483]


portfolio before change:  [4.8786374]
curr_Stock_Price:  105.0094899685555
curr_Factors:  [105.00948997]
mat_Sqrt:  [[0.15]]
grads:  [0.01640567]
Stock Position:  0.0164056737645335
Bond Position:  [3.15588597]


portfolio before change:  [4.87852235]
curr_Stock_Price:  104.97842982626537
curr_Factors:  [104.97842983]
mat_Sqrt:  [[0.15]]
grads:  [0.25051936]
Stock Position:  0.2505193640804828
Bond Position:  [-21.42060713]


portfolio before change:  [4.72186107]
curr_Stock_Price:  104.36377260116873
curr_Factors:  [104.3637726]
mat_Sqrt:  [[0.15]]
grads:  [0.16888182]
Stock Position:  0.16888182078837502
Bond Position:  [-12.90328287]


portfolio before change:  [4.95857394]
curr_Stock_Price:  105.77497172025159
curr_Factors:  [105.77497172]
mat_Sqrt:  [[0.15]]
grads:  [-0.16356595]
Stock Position:  -0.16356595366687052
Bond Position:  [22.25975806]


portfolio before change:  [4.84700631]
curr_Stock_Price:  106.47407972675103
curr_Factors:  [106.47407973]
mat_Sqrt:  [[0.15]]
grads:  [0.03229112]
Stock Position:  0.03229111949179095
Bond Position:  [1.40883908]


portfolio before change:  [4.84590657]
curr_Stock_Price:  106.43456867283909
curr_Factors:  [106.43456867]
mat_Sqrt:  [[0.15]]
grads:  [-0.08778626]
Stock Position:  -0.08778625746645746
Bond Position:  [14.18939902]


portfolio before change:  [4.9981339]
curr_Stock_Price:  104.72070649950025
curr_Factors:  [104.7207065]
mat_Sqrt:  [[0.15]]
grads:  [0.0106447]
Stock Position:  0.010644698158015857
Bond Position:  [3.88341359]


portfolio before change:  [4.98982993]
curr_Stock_Price:  103.89499680880547
curr_Factors:  [103.89499681]
mat_Sqrt:  [[0.15]]
grads:  [-0.03900469]
Stock Position:  -0.03900468787271585
Bond Position:  [9.04222185]


portfolio before change:  [5.00630984]
curr_Stock_Price:  103.50146550008068
curr_Factors:  [103.5014655]
mat_Sqrt:  [[0.15]]
grads:  [-0.01041439]
Stock Position:  -0.010414385781934172
Bond Position:  [6.08421403]


portfolio before change:  [5.00571321]
curr_Stock_Price:  103.63178573303212
curr_Factors:  [103.63178573]
mat_Sqrt:  [[0.15]]
grads:  [0.1576265]
Stock Position:  0.1576265041969165
Bond Position:  [-11.3294029]


portfolio before change:  [4.90182493]
curr_Stock_Price:  102.98169187326654
curr_Factors:  [102.98169187]
mat_Sqrt:  [[0.15]]
grads:  [-0.00153782]
Stock Position:  -0.001537817705468021
Bond Position:  [5.060192]


portfolio before change:  [4.90368706]
curr_Stock_Price:  102.18213785386781
curr_Factors:  [102.18213785]
mat_Sqrt:  [[0.15]]
grads:  [0.14835309]
Stock Position:  0.14835308898377259
Bond Position:  [-10.25534873]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [4.90368706]
Stock Price:  102.27887538374942
PL:  [2.62481167]
Settle:  Tensor("sub_396:0", shape=(), dtype=float64)
PL:  Tensor("sub_397:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


Test sample:  199
output_Z_Vals[:, i, :]:  [[ 2.32839458e+00]
 [-1.51401837e-03]
 [-1.43308059e-02]
 [-6.82364143e-04]
 [ 2.50789914e-02]
 [ 1.41307326e-02]
 [ 2.86364917e-02]
 [ 9.16088980e-03]
 [-8.37857112e-04]
 [ 7.58503007e-03]
 [ 1.20895439e-02]
 [ 2.53929643e-02]
 [ 1.07175494e-02]
 [-9.76138940e-03]
 [ 1.20625750e-02]
 [-5.01238714e-03]
 [-2.68909203e-02]
 [ 3.83868921e-03]
 [ 1.83334465e-03]
 [-1.17693668e-02]
 [-2.21502372e-03]
 [ 4.07120657e-04]
 [ 9.66018832e-03]
 [ 4.76710395e-03]
 [ 6.90480114e-03]
 [-3.57012270e-03]
 [-7.99082270e-03]
 [ 8.60462335e-03]
 [-1.86570368e-02]
 [-3.16875787e-02]
 [ 2.15533442e-02]
 [ 6.13777876e-03]
 [ 1.48363060e-03]
 [-1.24784064e-02]
 [-6.09734443e-03]
 [-8.77847951e-03]
 [-7.51088065e-03]
 [ 2.27777842e-02]
 [ 7.05159399e-03]
 [ 2.37616260e-02]]
curr_Factors:  [100.]
curr_Stock_Price:  100.0
current_Sample[0, :]:  [2.32839458]
mat_Sqrt:  [[0.15]]
grads:  [15.52263054]
init_Out:  [2.13372548]
Stock Position:  15.522630536918234
Bond position:  [-1550.12932821]

------------------------ GOING THRU TIME ------------------------
portfolio before change:  [6.73043214]
curr_Stock_Price:  100.30861295912248
curr_Factors:  [100.30861296]
mat_Sqrt:  [[0.15]]
grads:  [-0.01009346]
Stock Position:  -0.010093455776706492
Bond Position:  [7.74289269]


portfolio before change:  [6.73029439]
curr_Stock_Price:  100.41815704527598
curr_Factors:  [100.41815705]
mat_Sqrt:  [[0.15]]
grads:  [-0.09553871]
Stock Position:  -0.09553870595242284
Bond Position:  [16.32411517]


portfolio before change:  [6.82727562]
curr_Stock_Price:  99.42441750488173
curr_Factors:  [99.4244175]
mat_Sqrt:  [[0.15]]
grads:  [-0.00454909]
Stock Position:  -0.00454909428540597
Bond Position:  [7.27956667]


portfolio before change:  [6.8198593]
curr_Stock_Price:  101.25474199678678
curr_Factors:  [101.254742]
mat_Sqrt:  [[0.15]]
grads:  [0.16719328]
Stock Position:  0.16719327593112193
Bond Position:  [-10.10925271]


portfolio before change:  [6.72131302]
curr_Stock_Price:  100.67288514232227
curr_Factors:  [100.67288514]
mat_Sqrt:  [[0.15]]
grads:  [0.09420488]
Stock Position:  0.0942048840665079
Bond Position:  [-2.76256446]


portfolio before change:  [6.79393426]
curr_Stock_Price:  101.44743719890921
curr_Factors:  [101.4474372]
mat_Sqrt:  [[0.15]]
grads:  [0.19090994]
Stock Position:  0.19090994469793995
Bond Position:  [-12.57339037]


portfolio before change:  [6.91729625]
curr_Stock_Price:  102.10184921774099
curr_Factors:  [102.10184922]
mat_Sqrt:  [[0.15]]
grads:  [0.0610726]
Stock Position:  0.06107259865408731
Bond Position:  [0.68167099]


portfolio before change:  [6.88003288]
curr_Stock_Price:  101.49030523003893
curr_Factors:  [101.49030523]
mat_Sqrt:  [[0.15]]
grads:  [-0.00558571]
Stock Position:  -0.005585714081391812
Bond Position:  [7.44692871]


portfolio before change:  [6.87742622]
curr_Stock_Price:  102.12363340252162
curr_Factors:  [102.1236334]
mat_Sqrt:  [[0.15]]
grads:  [0.05056687]
Stock Position:  0.05056686716010829
Bond Position:  [1.71335401]


portfolio before change:  [6.8951595]
curr_Stock_Price:  102.47008755014319
curr_Factors:  [102.47008755]
mat_Sqrt:  [[0.15]]
grads:  [0.08059696]
Stock Position:  0.08059695922516205
Bond Position:  [-1.36361797]


portfolio before change:  [6.9265671]
curr_Stock_Price:  102.86188972030233
curr_Factors:  [102.86188972]
mat_Sqrt:  [[0.15]]
grads:  [0.16928643]
Stock Position:  0.16928642868583893
Bond Position:  [-10.48655486]


portfolio before change:  [6.70602798]
curr_Stock_Price:  101.56687615993856
curr_Factors:  [101.56687616]
mat_Sqrt:  [[0.15]]
grads:  [0.07145033]
Stock Position:  0.07145032953506017
Bond Position:  [-0.55095879]


portfolio before change:  [6.60528467]
curr_Stock_Price:  100.15786328709858
curr_Factors:  [100.15786329]
mat_Sqrt:  [[0.15]]
grads:  [-0.06507593]
Stock Position:  -0.06507592933472892
Bond Position:  [13.12315071]


portfolio before change:  [6.57065235]
curr_Stock_Price:  100.71525546686088
curr_Factors:  [100.71525547]
mat_Sqrt:  [[0.15]]
grads:  [0.08041717]
Stock Position:  0.08041716674215121
Bond Position:  [-1.52858314]


portfolio before change:  [6.67257075]
curr_Stock_Price:  101.98500275354772
curr_Factors:  [101.98500275]
mat_Sqrt:  [[0.15]]
grads:  [-0.03341591]
Stock Position:  -0.03341591429253245
Bond Position:  [10.08049286]


portfolio before change:  [6.67062032]
curr_Stock_Price:  102.08108183264105
curr_Factors:  [102.08108183]
mat_Sqrt:  [[0.15]]
grads:  [-0.1792728]
Stock Position:  -0.17927280222801292
Bond Position:  [24.97098191]


portfolio before change:  [6.66884308]
curr_Stock_Price:  102.10840779357173
curr_Factors:  [102.10840779]
mat_Sqrt:  [[0.15]]
grads:  [0.02559126]
Stock Position:  0.025591261403590283
Bond Position:  [4.05576013]


portfolio before change:  [6.65575544]
curr_Stock_Price:  101.57718550200431
curr_Factors:  [101.5771855]
mat_Sqrt:  [[0.15]]
grads:  [0.0122223]
Stock Position:  0.012222297684666903
Bond Position:  [5.41424884]


portfolio before change:  [6.64442113]
curr_Stock_Price:  100.5944629086192
curr_Factors:  [100.59446291]
mat_Sqrt:  [[0.15]]
grads:  [-0.07846245]
Stock Position:  -0.07846244561217358
Bond Position:  [14.53730871]


portfolio before change:  [6.65798275]
curr_Stock_Price:  100.44478190882246
curr_Factors:  [100.44478191]
mat_Sqrt:  [[0.15]]
grads:  [-0.01476682]
Stock Position:  -0.014766824780469492
Bond Position:  [8.14123324]


portfolio before change:  [6.65847131]
curr_Stock_Price:  100.48061608471383
curr_Factors:  [100.48061608]
mat_Sqrt:  [[0.15]]
grads:  [0.00271414]
Stock Position:  0.002714137711152183
Bond Position:  [6.38575308]


portfolio before change:  [6.65891146]
curr_Stock_Price:  100.34867073094274
curr_Factors:  [100.34867073]
mat_Sqrt:  [[0.15]]
grads:  [0.06440126]
Stock Position:  0.06440125547712316
Bond Position:  [0.19633108]


portfolio before change:  [6.60937199]
curr_Stock_Price:  99.57905823472493
curr_Factors:  [99.57905823]
mat_Sqrt:  [[0.15]]
grads:  [0.03178069]
Stock Position:  0.03178069297206783
Bond Position:  [3.44468052]


portfolio before change:  [6.64292525]
curr_Stock_Price:  100.62128379194078
curr_Factors:  [100.62128379]
mat_Sqrt:  [[0.15]]
grads:  [0.04603201]
Stock Position:  0.04603200762292407
Bond Position:  [2.01112555]


portfolio before change:  [6.65320981]
curr_Stock_Price:  100.839244048702
curr_Factors:  [100.83924405]
mat_Sqrt:  [[0.15]]
grads:  [-0.02380082]
Stock Position:  -0.02380081797800137
Bond Position:  [9.0532663]


portfolio before change:  [6.6458078]
curr_Stock_Price:  101.19779200571598
curr_Factors:  [101.19779201]
mat_Sqrt:  [[0.15]]
grads:  [-0.05327215]
Stock Position:  -0.05327215134346069
Bond Position:  [12.03683189]


portfolio before change:  [6.66456379]
curr_Stock_Price:  100.87395887370938
curr_Factors:  [100.87395887]
mat_Sqrt:  [[0.15]]
grads:  [0.05736416]
Stock Position:  0.057364155687997395
Bond Position:  [0.87801431]


portfolio before change:  [6.68954425]
curr_Stock_Price:  101.30751714771941
curr_Factors:  [101.30751715]
mat_Sqrt:  [[0.15]]
grads:  [-0.12438025]
Stock Position:  -0.12438024543163893
Bond Position:  [19.2901981]


portfolio before change:  [6.91252559]
curr_Stock_Price:  99.53416550459376
curr_Factors:  [99.5341655]
mat_Sqrt:  [[0.15]]
grads:  [-0.21125052]
Stock Position:  -0.21125052460791077
Bond Position:  [27.93917027]


portfolio before change:  [6.87710504]
curr_Stock_Price:  99.71836939828833
curr_Factors:  [99.7183694]
mat_Sqrt:  [[0.15]]
grads:  [0.14368896]
Stock Position:  0.14368896104469284
Bond Position:  [-7.45132386]


portfolio before change:  [6.73234739]
curr_Stock_Price:  98.71741449013034
curr_Factors:  [98.71741449]
mat_Sqrt:  [[0.15]]
grads:  [0.04091853]
Stock Position:  0.04091852505475362
Bond Position:  [2.69297639]


portfolio before change:  [6.78158389]
curr_Stock_Price:  99.91246867609281
curr_Factors:  [99.91246868]
mat_Sqrt:  [[0.15]]
grads:  [0.00989087]
Stock Position:  0.009890870688812016
Bond Position:  [5.79336258]


portfolio before change:  [6.78648181]
curr_Stock_Price:  100.33444472801064
curr_Factors:  [100.33444473]
mat_Sqrt:  [[0.15]]
grads:  [-0.08318938]
Stock Position:  -0.0831893756714623
Bond Position:  [15.13324163]


portfolio before change:  [6.82565668]
curr_Stock_Price:  99.8862734321363
curr_Factors:  [99.88627343]
mat_Sqrt:  [[0.15]]
grads:  [-0.04064896]
Stock Position:  -0.04064896289155078
Bond Position:  [10.8859301]


portfolio before change:  [6.85717297]
curr_Stock_Price:  99.1444227544401
curr_Factors:  [99.14442275]
mat_Sqrt:  [[0.15]]
grads:  [-0.0585232]
Stock Position:  -0.0585231967485591
Bond Position:  [12.65942152]


portfolio before change:  [6.85907414]
curr_Stock_Price:  99.13897789707866
curr_Factors:  [99.1389779]
mat_Sqrt:  [[0.15]]
grads:  [-0.05007254]
Stock Position:  -0.050072537689029195
Bond Position:  [11.82321435]


portfolio before change:  [6.78678171]
curr_Stock_Price:  100.61224904910634
curr_Factors:  [100.61224905]
mat_Sqrt:  [[0.15]]
grads:  [0.15185189]
Stock Position:  0.15185189474865532
Bond Position:  [-8.49137894]


portfolio before change:  [6.73488488]
curr_Stock_Price:  100.27747979414424
curr_Factors:  [100.27747979]
mat_Sqrt:  [[0.15]]
grads:  [0.04701063]
Stock Position:  0.04701062659359058
Bond Position:  [2.02077772]


portfolio before change:  [6.75453308]
curr_Stock_Price:  100.69005859184074
curr_Factors:  [100.69005859]
mat_Sqrt:  [[0.15]]
grads:  [0.15841084]
Stock Position:  0.15841083991191493
Bond Position:  [-9.19586367]



------------------------ END OF SAMPLE ITER ------------------------
Portfolio Value:  [6.75453308]
Stock Price:  101.54994612937557
PL:  [5.20458695]
Settle:  Tensor("sub_398:0", shape=(), dtype=float64)
PL:  Tensor("sub_399:0", shape=(1,), dtype=float64)
------------------------ END OF SAMPLE ITER ------------------------


FINAL AVERAGE P&L:  -0.4226937808419541
FINAL STD P&L:  11.27390882927434
